This machine has 1 visible gpus.
This machine has 1 physical gpus.
training model: results/WBA/W0/deepLOB_L1/seq2seq
Epoch 1/50
1454/1454 - 60s - loss: 12.6807 - accuracy10: 0.4246 - accuracy20: 0.4367 - accuracy30: 0.4387 - accuracy50: 0.4262 - val_loss: 12.8729 - val_accuracy10: 0.2974 - val_accuracy20: 0.3583 - val_accuracy30: 0.3935 - val_accuracy50: 0.4000 - 60s/epoch - 41ms/step
Epoch 2/50
1454/1454 - 32s - loss: 12.5949 - accuracy10: 0.4271 - accuracy20: 0.4436 - accuracy30: 0.4452 - accuracy50: 0.4298 - val_loss: 12.8779 - val_accuracy10: 0.2900 - val_accuracy20: 0.3496 - val_accuracy30: 0.3845 - val_accuracy50: 0.3927 - 32s/epoch - 22ms/step
Epoch 3/50
1454/1454 - 31s - loss: 12.5453 - accuracy10: 0.4268 - accuracy20: 0.4456 - accuracy30: 0.4479 - accuracy50: 0.4313 - val_loss: 12.6369 - val_accuracy10: 0.3553 - val_accuracy20: 0.3920 - val_accuracy30: 0.4126 - val_accuracy50: 0.4111 - 31s/epoch - 21ms/step
Epoch 4/50
1454/1454 - 34s - loss: 12.4625 - accuracy10: 0.4368 - accuracy20: 0.4529 - accuracy30: 0.4547 - accuracy50: 0.4367 - val_loss: 12.5699 - val_accuracy10: 0.3975 - val_accuracy20: 0.4132 - val_accuracy30: 0.4214 - val_accuracy50: 0.4162 - 34s/epoch - 23ms/step
Epoch 5/50
1454/1454 - 32s - loss: 12.3870 - accuracy10: 0.4478 - accuracy20: 0.4606 - accuracy30: 0.4608 - accuracy50: 0.4426 - val_loss: 12.7401 - val_accuracy10: 0.4052 - val_accuracy20: 0.4112 - val_accuracy30: 0.4140 - val_accuracy50: 0.4082 - 32s/epoch - 22ms/step
Epoch 6/50
1454/1454 - 33s - loss: 12.3226 - accuracy10: 0.4578 - accuracy20: 0.4663 - accuracy30: 0.4649 - accuracy50: 0.4472 - val_loss: 12.7719 - val_accuracy10: 0.3998 - val_accuracy20: 0.4044 - val_accuracy30: 0.4094 - val_accuracy50: 0.4041 - 33s/epoch - 23ms/step
Epoch 7/50
1454/1454 - 33s - loss: 12.2700 - accuracy10: 0.4644 - accuracy20: 0.4714 - accuracy30: 0.4697 - accuracy50: 0.4510 - val_loss: 12.7994 - val_accuracy10: 0.3995 - val_accuracy20: 0.4008 - val_accuracy30: 0.4049 - val_accuracy50: 0.4020 - 33s/epoch - 23ms/step
Epoch 8/50
1454/1454 - 31s - loss: 12.2319 - accuracy10: 0.4689 - accuracy20: 0.4748 - accuracy30: 0.4727 - accuracy50: 0.4540 - val_loss: 12.6116 - val_accuracy10: 0.4254 - val_accuracy20: 0.4203 - val_accuracy30: 0.4186 - val_accuracy50: 0.4117 - 31s/epoch - 21ms/step
Epoch 9/50
1454/1454 - 33s - loss: 12.1960 - accuracy10: 0.4729 - accuracy20: 0.4780 - accuracy30: 0.4758 - accuracy50: 0.4568 - val_loss: 12.3870 - val_accuracy10: 0.4965 - val_accuracy20: 0.4656 - val_accuracy30: 0.4467 - val_accuracy50: 0.4289 - 33s/epoch - 23ms/step
Epoch 10/50
1454/1454 - 32s - loss: 12.1636 - accuracy10: 0.4776 - accuracy20: 0.4813 - accuracy30: 0.4784 - accuracy50: 0.4588 - val_loss: 12.3764 - val_accuracy10: 0.4785 - val_accuracy20: 0.4548 - val_accuracy30: 0.4441 - val_accuracy50: 0.4276 - 32s/epoch - 22ms/step
Epoch 11/50
1454/1454 - 33s - loss: 12.1418 - accuracy10: 0.4791 - accuracy20: 0.4832 - accuracy30: 0.4807 - accuracy50: 0.4604 - val_loss: 12.3354 - val_accuracy10: 0.4978 - val_accuracy20: 0.4665 - val_accuracy30: 0.4495 - val_accuracy50: 0.4313 - 33s/epoch - 23ms/step
Epoch 12/50
1454/1454 - 35s - loss: 12.1104 - accuracy10: 0.4824 - accuracy20: 0.4858 - accuracy30: 0.4827 - accuracy50: 0.4620 - val_loss: 12.3467 - val_accuracy10: 0.4957 - val_accuracy20: 0.4661 - val_accuracy30: 0.4496 - val_accuracy50: 0.4303 - 35s/epoch - 24ms/step
Epoch 13/50
1454/1454 - 32s - loss: 12.0838 - accuracy10: 0.4847 - accuracy20: 0.4881 - accuracy30: 0.4848 - accuracy50: 0.4642 - val_loss: 12.4105 - val_accuracy10: 0.5073 - val_accuracy20: 0.4690 - val_accuracy30: 0.4488 - val_accuracy50: 0.4298 - 32s/epoch - 22ms/step
Epoch 14/50
1454/1454 - 30s - loss: 12.0612 - accuracy10: 0.4867 - accuracy20: 0.4899 - accuracy30: 0.4864 - accuracy50: 0.4658 - val_loss: 12.4033 - val_accuracy10: 0.5199 - val_accuracy20: 0.4767 - val_accuracy30: 0.4524 - val_accuracy50: 0.4304 - 30s/epoch - 21ms/step
Epoch 15/50
1454/1454 - 30s - loss: 12.0391 - accuracy10: 0.4889 - accuracy20: 0.4920 - accuracy30: 0.4885 - accuracy50: 0.4679 - val_loss: 12.4731 - val_accuracy10: 0.5124 - val_accuracy20: 0.4722 - val_accuracy30: 0.4486 - val_accuracy50: 0.4287 - 30s/epoch - 21ms/step
Epoch 16/50
1454/1454 - 31s - loss: 12.0201 - accuracy10: 0.4905 - accuracy20: 0.4941 - accuracy30: 0.4909 - accuracy50: 0.4690 - val_loss: 12.5119 - val_accuracy10: 0.5162 - val_accuracy20: 0.4707 - val_accuracy30: 0.4459 - val_accuracy50: 0.4254 - 31s/epoch - 21ms/step
Epoch 17/50
1454/1454 - 31s - loss: 11.9973 - accuracy10: 0.4925 - accuracy20: 0.4959 - accuracy30: 0.4919 - accuracy50: 0.4703 - val_loss: 12.4821 - val_accuracy10: 0.5185 - val_accuracy20: 0.4717 - val_accuracy30: 0.4473 - val_accuracy50: 0.4248 - 31s/epoch - 21ms/step
Epoch 18/50
1454/1454 - 30s - loss: 11.9771 - accuracy10: 0.4945 - accuracy20: 0.4971 - accuracy30: 0.4935 - accuracy50: 0.4721 - val_loss: 12.4246 - val_accuracy10: 0.5125 - val_accuracy20: 0.4716 - val_accuracy30: 0.4493 - val_accuracy50: 0.4281 - 30s/epoch - 21ms/step
Epoch 19/50
1454/1454 - 34s - loss: 11.9540 - accuracy10: 0.4975 - accuracy20: 0.4996 - accuracy30: 0.4956 - accuracy50: 0.4734 - val_loss: 12.4195 - val_accuracy10: 0.5266 - val_accuracy20: 0.4779 - val_accuracy30: 0.4495 - val_accuracy50: 0.4263 - 34s/epoch - 23ms/step
Epoch 20/50
1454/1454 - 33s - loss: 11.9412 - accuracy10: 0.4980 - accuracy20: 0.5000 - accuracy30: 0.4963 - accuracy50: 0.4736 - val_loss: 12.3502 - val_accuracy10: 0.5204 - val_accuracy20: 0.4779 - val_accuracy30: 0.4542 - val_accuracy50: 0.4320 - 33s/epoch - 23ms/step
Epoch 21/50
1454/1454 - 33s - loss: 11.9238 - accuracy10: 0.4999 - accuracy20: 0.5021 - accuracy30: 0.4978 - accuracy50: 0.4750 - val_loss: 12.4419 - val_accuracy10: 0.5265 - val_accuracy20: 0.4776 - val_accuracy30: 0.4488 - val_accuracy50: 0.4272 - 33s/epoch - 22ms/step
testing model: results/WBA/W0/deepLOB_L1/seq2seq
Evaluating performance on  test set...
5633/5633 - 44s - 44s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9773536
{'0': {'precision': 0.2743177444134973, 'recall': 0.6501781660829069, 'f1-score': 0.38584358451299167, 'support': 230403}, '1': {'precision': 0.8096057245517515, 'recall': 0.4868655830224309, 'f1-score': 0.6080646147730225, 'support': 980211}, '2': {'precision': 0.326132950241609, 'recall': 0.43200415188997493, 'f1-score': 0.3716762790697674, 'support': 231220}, 'accuracy': 0.5041648345093818, 'macro avg': {'precision': 0.47001880640228594, 'recall': 0.5230159669984376, 'f1-score': 0.45519482611859385, 'support': 1441834}, 'weighted avg': {'precision': 0.6465352661190988, 'recall': 0.5041648345093818, 'f1-score': 0.5346455505698559, 'support': 1441834}}
[[149803  47866  32734]
 [329322 477231 173658]
 [ 66968  64364  99888]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0016954
{'0': {'precision': 0.32350480934533715, 'recall': 0.6356950298825539, 'f1-score': 0.42879573376382657, 'support': 297498}, '1': {'precision': 0.7432569214719786, 'recall': 0.45328634611291124, 'f1-score': 0.5631358652615743, 'support': 845620}, '2': {'precision': 0.3748144374269828, 'recall': 0.42853412605953484, 'f1-score': 0.39987817163742007, 'support': 298716}, 'accuracy': 0.4857951747565947, 'macro avg': {'precision': 0.48052538941476625, 'recall': 0.505838500685, 'f1-score': 0.4639365902209403, 'support': 1441834}, 'weighted avg': {'precision': 0.5803150856452215, 'recall': 0.4857951747565947, 'f1-score': 0.5015936865857005, 'support': 1441834}}
[[189118  57341  51039]
 [299832 383308 162480]
 [ 95641  75065 128010]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0220907
{'0': {'precision': 0.34726273909421607, 'recall': 0.631721680518865, 'f1-score': 0.448165255191465, 'support': 341823}, '1': {'precision': 0.6944843224716891, 'recall': 0.4068756332907276, 'f1-score': 0.5131269700477572, 'support': 754985}, '2': {'precision': 0.3957589220703916, 'recall': 0.4332224238173355, 'f1-score': 0.4136441436642208, 'support': 345026}, 'accuracy': 0.46648573968986723, 'macro avg': {'precision': 0.47916866121209895, 'recall': 0.49060657920897605, 'f1-score': 0.4583121229678144, 'support': 1441834}, 'weighted avg': {'precision': 0.5406827383131132, 'recall': 0.46648573968986723, 'f1-score': 0.4739202583783637, 'support': 1441834}}
[[215937  59004  66882]
 [286468 307185 161332]
 [119421  76132 149473]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.047971
{'0': {'precision': 0.33836107873893556, 'recall': 0.6274616018327296, 'f1-score': 0.4396429877536497, 'support': 354444}, '1': {'precision': 0.659962791715685, 'recall': 0.3357720419869908, 'f1-score': 0.44509250195816497, 'support': 718413}, '2': {'precision': 0.3865902376395458, 'recall': 0.43904091582944194, 'f1-score': 0.4111495339555719, 'support': 368977}, 'accuracy': 0.4339050126436192, 'macro avg': {'precision': 0.46163803603138875, 'recall': 0.46742485321638744, 'f1-score': 0.43196167455579554, 'support': 1441834}, 'weighted avg': {'precision': 0.5109456493541631, 'recall': 0.4339050126436192, 'f1-score': 0.43506657517505537, 'support': 1441834}}
[[222400  52580  79464]
 [299612 241223 177578]
 [135274  71707 161996]]
Evaluating performance on  train set...
1454/1454 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0247922
{'0': {'precision': 0.3802575695300726, 'recall': 0.4537619842817605, 'f1-score': 0.41377070477427735, 'support': 85633}, '1': {'precision': 0.6653819145200932, 'recall': 0.41508241115475175, 'f1-score': 0.5112400712448536, 'support': 200883}, '2': {'precision': 0.34643447469794525, 'recall': 0.5853305133268676, 'f1-score': 0.4352571120727108, 'support': 85579}, 'accuracy': 0.4631397895698679, 'macro avg': {'precision': 0.464024652916037, 'recall': 0.48472496958779326, 'f1-score': 0.4534226293639472, 'support': 372095}, 'weighted avg': {'precision': 0.5264086523502978, 'recall': 0.4631397895698679, 'f1-score': 0.47133321970971426, 'support': 372095}}
[[38857 22484 24292]
 [47291 83383 70209]
 [16038 19449 50092]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0390803
{'0': {'precision': 0.43344052042887193, 'recall': 0.4362623935530206, 'f1-score': 0.4348468790093155, 'support': 107213}, '1': {'precision': 0.5594176436671151, 'recall': 0.36968145909010086, 'f1-score': 0.4451760423358111, 'support': 157468}, '2': {'precision': 0.39468786690315005, 'recall': 0.5883683691138958, 'f1-score': 0.4724487736321569, 'support': 107414}, 'accuracy': 0.4519947862776979, 'macro avg': {'precision': 0.462515343666379, 'recall': 0.46477074058567247, 'f1-score': 0.45082389832576114, 'support': 372095}, 'weighted avg': {'precision': 0.47556628969819237, 'recall': 0.4519947862776979, 'f1-score': 0.45007278260843536, 'support': 372095}}
[[46773 24332 36108]
 [38438 58213 60817]
 [22700 21515 63199]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0461957
{'0': {'precision': 0.4590413865658601, 'recall': 0.4269803622371127, 'f1-score': 0.44243080439620874, 'support': 120584}, '1': {'precision': 0.49174258007640315, 'recall': 0.3211727584697943, 'f1-score': 0.3885627774784983, 'support': 130257}, '2': {'precision': 0.4185510528543161, 'recall': 0.6035842116548732, 'f1-score': 0.4943197168638893, 'support': 121254}, 'accuracy': 0.4474905602063989, 'macro avg': {'precision': 0.45644500649885983, 'recall': 0.4505791107872601, 'f1-score': 0.44177109957953214, 'support': 372095}, 'weighted avg': {'precision': 0.45729437152734365, 'recall': 0.4474905602063989, 'f1-score': 0.4404825132612457, 'support': 372095}}
[[51487 22911 46186]
 [32937 41835 55485]
 [27738 20329 73187]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0617732
{'0': {'precision': 0.44303500117453604, 'recall': 0.4122437744891681, 'f1-score': 0.42708512431698, 'support': 123524}, '1': {'precision': 0.4557401699120367, 'recall': 0.24730129978214574, 'f1-score': 0.3206215884568188, 'support': 122559}, '2': {'precision': 0.40979590980377756, 'recall': 0.6200044440212044, 'f1-score': 0.4934457135819467, 'support': 126012}, 'accuracy': 0.4282750372888644, 'macro avg': {'precision': 0.43619036029678343, 'recall': 0.426516506097506, 'f1-score': 0.41371747545191523, 'support': 372095}, 'weighted avg': {'precision': 0.4359631738011161, 'recall': 0.4282750372888644, 'f1-score': 0.41449201256587204, 'support': 372095}}
[[50922 18974 53628]
 [33355 30309 58895]
 [30662 17222 78128]]
Evaluating performance on  val set...
557/557 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.99221706
{'0': {'precision': 0.3984580052493438, 'recall': 0.31321727917472597, 'f1-score': 0.350732799075879, 'support': 31020}, '1': {'precision': 0.65305498670416, 'recall': 0.5339564407902135, 'f1-score': 0.5875308497693572, 'support': 80029}, '2': {'precision': 0.3528606468541441, 'recall': 0.5917352209680505, 'f1-score': 0.44209397891727714, 'support': 31362}, 'accuracy': 0.4985991250675861, 'macro avg': {'precision': 0.4681245462692159, 'recall': 0.47963631364433, 'f1-score': 0.4601192092541711, 'support': 142411}, 'weighted avg': {'precision': 0.5314892842576875, 'recall': 0.4985991250675861, 'f1-score': 0.5039230759585236, 'support': 142411}}
[[ 9716 13062  8242]
 [11504 42732 25793]
 [ 3164  9640 18558]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0239037
{'0': {'precision': 0.4514780758416293, 'recall': 0.3052380096077273, 'f1-score': 0.36422714384244004, 'support': 38927}, '1': {'precision': 0.5429901229304341, 'recall': 0.48158943736312215, 'f1-score': 0.510449979542589, 'support': 63469}, '2': {'precision': 0.4036889015233859, 'recall': 0.6032987629638885, 'f1-score': 0.4837100264486655, 'support': 40015}, 'accuracy': 0.46758326252887766, 'macro avg': {'precision': 0.4660523667651497, 'recall': 0.46337540331157934, 'f1-score': 0.4527957166112315, 'support': 142411}, 'weighted avg': {'precision': 0.47883477094478033, 'recall': 0.46758326252887766, 'f1-score': 0.4629675831802782, 'support': 142411}}
[[11882 14445 12600]
 [ 9843 30566 23060]
 [ 4593 11281 24141]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0415757
{'0': {'precision': 0.4761819676231998, 'recall': 0.30251776511453676, 'f1-score': 0.36998472858531173, 'support': 44047}, '1': {'precision': 0.4691801189464741, 'recall': 0.4193689246658566, 'f1-score': 0.4428783382789318, 'support': 52672}, '2': {'precision': 0.4257290491180139, 'recall': 0.6275059091307013, 'f1-score': 0.5072894550601557, 'support': 45692}, 'accuracy': 0.45000737302596006, 'macro avg': {'precision': 0.4570303785625626, 'recall': 0.4497975329703649, 'f1-score': 0.44005084064146643, 'support': 142411}, 'weighted avg': {'precision': 0.4574046531893467, 'recall': 0.45000737302596006, 'f1-score': 0.4409987638204475, 'support': 142411}}
[[13325 13855 16867]
 [ 8774 22089 21809]
 [ 5884 11136 28672]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0586289
{'0': {'precision': 0.45871997816593885, 'recall': 0.29355514802200683, 'f1-score': 0.358006283614676, 'support': 45804}, '1': {'precision': 0.426461521966387, 'recall': 0.33115477478977606, 'f1-score': 0.37281344096729974, 'support': 48044}, '2': {'precision': 0.42177274646400675, 'recall': 0.6582583448304264, 'f1-score': 0.5141248844035221, 'support': 48563}, 'accuracy': 0.4306057818567386, 'macro avg': {'precision': 0.4356514155321108, 'recall': 0.4276560892140698, 'f1-score': 0.41498153632849927, 'support': 142411}, 'weighted avg': {'precision': 0.43523798813151593, 'recall': 0.4306057818567386, 'f1-score': 0.41623902320612743, 'support': 142411}}
[[13446 11734 20624]
 [ 8933 15910 23201]
 [ 6933  9663 31967]]
training model: results/WBA/W0/deepOF_L1/seq2seq
Epoch 1/50
1454/1454 - 36s - loss: 12.9409 - accuracy10: 0.4124 - accuracy20: 0.4157 - accuracy30: 0.4126 - accuracy50: 0.4031 - val_loss: 13.0277 - val_accuracy10: 0.2755 - val_accuracy20: 0.3384 - val_accuracy30: 0.3745 - val_accuracy50: 0.3831 - 36s/epoch - 25ms/step
Epoch 2/50
1454/1454 - 31s - loss: 12.8985 - accuracy10: 0.4052 - accuracy20: 0.4137 - accuracy30: 0.4134 - accuracy50: 0.4023 - val_loss: 12.9336 - val_accuracy10: 0.2991 - val_accuracy20: 0.3456 - val_accuracy30: 0.3808 - val_accuracy50: 0.3911 - 31s/epoch - 21ms/step
Epoch 3/50
1454/1454 - 32s - loss: 12.8762 - accuracy10: 0.4117 - accuracy20: 0.4153 - accuracy30: 0.4127 - accuracy50: 0.4003 - val_loss: 12.9103 - val_accuracy10: 0.2966 - val_accuracy20: 0.3483 - val_accuracy30: 0.3833 - val_accuracy50: 0.3925 - 32s/epoch - 22ms/step
Epoch 4/50
1454/1454 - 30s - loss: 12.8492 - accuracy10: 0.4178 - accuracy20: 0.4198 - accuracy30: 0.4160 - accuracy50: 0.4039 - val_loss: 12.8581 - val_accuracy10: 0.3208 - val_accuracy20: 0.3564 - val_accuracy30: 0.3853 - val_accuracy50: 0.3948 - 30s/epoch - 21ms/step
Epoch 5/50
1454/1454 - 30s - loss: 12.8253 - accuracy10: 0.4270 - accuracy20: 0.4247 - accuracy30: 0.4189 - accuracy50: 0.4050 - val_loss: 12.8466 - val_accuracy10: 0.3304 - val_accuracy20: 0.3603 - val_accuracy30: 0.3873 - val_accuracy50: 0.3963 - 30s/epoch - 21ms/step
Epoch 6/50
1454/1454 - 30s - loss: 12.7985 - accuracy10: 0.4330 - accuracy20: 0.4277 - accuracy30: 0.4211 - accuracy50: 0.4069 - val_loss: 12.8420 - val_accuracy10: 0.3310 - val_accuracy20: 0.3619 - val_accuracy30: 0.3882 - val_accuracy50: 0.3967 - 30s/epoch - 21ms/step
Epoch 7/50
1454/1454 - 31s - loss: 12.7762 - accuracy10: 0.4358 - accuracy20: 0.4298 - accuracy30: 0.4231 - accuracy50: 0.4088 - val_loss: 12.8090 - val_accuracy10: 0.3437 - val_accuracy20: 0.3707 - val_accuracy30: 0.3934 - val_accuracy50: 0.3984 - 31s/epoch - 21ms/step
Epoch 8/50
1454/1454 - 30s - loss: 12.7594 - accuracy10: 0.4379 - accuracy20: 0.4311 - accuracy30: 0.4239 - accuracy50: 0.4099 - val_loss: 12.7982 - val_accuracy10: 0.3487 - val_accuracy20: 0.3740 - val_accuracy30: 0.3947 - val_accuracy50: 0.3993 - 30s/epoch - 21ms/step
Epoch 9/50
1454/1454 - 31s - loss: 12.7359 - accuracy10: 0.4398 - accuracy20: 0.4335 - accuracy30: 0.4258 - accuracy50: 0.4116 - val_loss: 12.7926 - val_accuracy10: 0.3525 - val_accuracy20: 0.3782 - val_accuracy30: 0.3983 - val_accuracy50: 0.4003 - 31s/epoch - 21ms/step
Epoch 10/50
1454/1454 - 32s - loss: 12.7142 - accuracy10: 0.4417 - accuracy20: 0.4359 - accuracy30: 0.4294 - accuracy50: 0.4142 - val_loss: 12.7965 - val_accuracy10: 0.3455 - val_accuracy20: 0.3785 - val_accuracy30: 0.3986 - val_accuracy50: 0.4009 - 32s/epoch - 22ms/step
Epoch 11/50
1454/1454 - 34s - loss: 12.6934 - accuracy10: 0.4412 - accuracy20: 0.4372 - accuracy30: 0.4316 - accuracy50: 0.4165 - val_loss: 12.7768 - val_accuracy10: 0.3511 - val_accuracy20: 0.3830 - val_accuracy30: 0.4034 - val_accuracy50: 0.4042 - 34s/epoch - 23ms/step
Epoch 12/50
1454/1454 - 35s - loss: 12.6744 - accuracy10: 0.4419 - accuracy20: 0.4386 - accuracy30: 0.4324 - accuracy50: 0.4176 - val_loss: 12.7515 - val_accuracy10: 0.3560 - val_accuracy20: 0.3886 - val_accuracy30: 0.4073 - val_accuracy50: 0.4065 - 35s/epoch - 24ms/step
Epoch 13/50
1454/1454 - 34s - loss: 12.6512 - accuracy10: 0.4431 - accuracy20: 0.4410 - accuracy30: 0.4356 - accuracy50: 0.4205 - val_loss: 12.7119 - val_accuracy10: 0.3668 - val_accuracy20: 0.3967 - val_accuracy30: 0.4137 - val_accuracy50: 0.4105 - 34s/epoch - 24ms/step
Epoch 14/50
1454/1454 - 33s - loss: 12.6330 - accuracy10: 0.4439 - accuracy20: 0.4424 - accuracy30: 0.4375 - accuracy50: 0.4221 - val_loss: 12.6997 - val_accuracy10: 0.3688 - val_accuracy20: 0.3974 - val_accuracy30: 0.4136 - val_accuracy50: 0.4107 - 33s/epoch - 23ms/step
Epoch 15/50
1454/1454 - 31s - loss: 12.6087 - accuracy10: 0.4469 - accuracy20: 0.4446 - accuracy30: 0.4403 - accuracy50: 0.4248 - val_loss: 12.7076 - val_accuracy10: 0.3720 - val_accuracy20: 0.3985 - val_accuracy30: 0.4143 - val_accuracy50: 0.4104 - 31s/epoch - 21ms/step
Epoch 16/50
1454/1454 - 30s - loss: 12.5891 - accuracy10: 0.4470 - accuracy20: 0.4454 - accuracy30: 0.4424 - accuracy50: 0.4272 - val_loss: 12.6575 - val_accuracy10: 0.3878 - val_accuracy20: 0.4080 - val_accuracy30: 0.4198 - val_accuracy50: 0.4144 - 30s/epoch - 21ms/step
Epoch 17/50
1454/1454 - 32s - loss: 12.5723 - accuracy10: 0.4479 - accuracy20: 0.4472 - accuracy30: 0.4445 - accuracy50: 0.4290 - val_loss: 12.6751 - val_accuracy10: 0.3817 - val_accuracy20: 0.4019 - val_accuracy30: 0.4162 - val_accuracy50: 0.4134 - 32s/epoch - 22ms/step
Epoch 18/50
1454/1454 - 32s - loss: 12.5517 - accuracy10: 0.4503 - accuracy20: 0.4488 - accuracy30: 0.4461 - accuracy50: 0.4316 - val_loss: 12.6550 - val_accuracy10: 0.3849 - val_accuracy20: 0.4032 - val_accuracy30: 0.4173 - val_accuracy50: 0.4127 - 32s/epoch - 22ms/step
Epoch 19/50
1454/1454 - 31s - loss: 12.5295 - accuracy10: 0.4518 - accuracy20: 0.4511 - accuracy30: 0.4490 - accuracy50: 0.4332 - val_loss: 12.6428 - val_accuracy10: 0.3890 - val_accuracy20: 0.4073 - val_accuracy30: 0.4195 - val_accuracy50: 0.4147 - 31s/epoch - 21ms/step
Epoch 20/50
1454/1454 - 30s - loss: 12.5086 - accuracy10: 0.4541 - accuracy20: 0.4534 - accuracy30: 0.4520 - accuracy50: 0.4359 - val_loss: 12.6308 - val_accuracy10: 0.3920 - val_accuracy20: 0.4087 - val_accuracy30: 0.4204 - val_accuracy50: 0.4152 - 30s/epoch - 21ms/step
Epoch 21/50
1454/1454 - 33s - loss: 12.4883 - accuracy10: 0.4559 - accuracy20: 0.4547 - accuracy30: 0.4533 - accuracy50: 0.4368 - val_loss: 12.6313 - val_accuracy10: 0.3975 - val_accuracy20: 0.4100 - val_accuracy30: 0.4216 - val_accuracy50: 0.4158 - 33s/epoch - 22ms/step
Epoch 22/50
1454/1454 - 30s - loss: 12.4717 - accuracy10: 0.4563 - accuracy20: 0.4559 - accuracy30: 0.4547 - accuracy50: 0.4381 - val_loss: 12.6200 - val_accuracy10: 0.3937 - val_accuracy20: 0.4085 - val_accuracy30: 0.4213 - val_accuracy50: 0.4165 - 30s/epoch - 21ms/step
Epoch 23/50
1454/1454 - 34s - loss: 12.4581 - accuracy10: 0.4576 - accuracy20: 0.4572 - accuracy30: 0.4565 - accuracy50: 0.4401 - val_loss: 12.6087 - val_accuracy10: 0.4079 - val_accuracy20: 0.4177 - val_accuracy30: 0.4245 - val_accuracy50: 0.4174 - 34s/epoch - 23ms/step
Epoch 24/50
1454/1454 - 29s - loss: 12.4418 - accuracy10: 0.4577 - accuracy20: 0.4582 - accuracy30: 0.4575 - accuracy50: 0.4421 - val_loss: 12.6099 - val_accuracy10: 0.4023 - val_accuracy20: 0.4139 - val_accuracy30: 0.4246 - val_accuracy50: 0.4180 - 29s/epoch - 20ms/step
Epoch 25/50
1454/1454 - 31s - loss: 12.4255 - accuracy10: 0.4597 - accuracy20: 0.4596 - accuracy30: 0.4591 - accuracy50: 0.4430 - val_loss: 12.6247 - val_accuracy10: 0.4030 - val_accuracy20: 0.4107 - val_accuracy30: 0.4212 - val_accuracy50: 0.4150 - 31s/epoch - 21ms/step
Epoch 26/50
1454/1454 - 32s - loss: 12.4063 - accuracy10: 0.4610 - accuracy20: 0.4617 - accuracy30: 0.4609 - accuracy50: 0.4449 - val_loss: 12.5922 - val_accuracy10: 0.4119 - val_accuracy20: 0.4171 - val_accuracy30: 0.4259 - val_accuracy50: 0.4183 - 32s/epoch - 22ms/step
Epoch 27/50
1454/1454 - 30s - loss: 12.3916 - accuracy10: 0.4619 - accuracy20: 0.4624 - accuracy30: 0.4616 - accuracy50: 0.4461 - val_loss: 12.5949 - val_accuracy10: 0.4124 - val_accuracy20: 0.4167 - val_accuracy30: 0.4253 - val_accuracy50: 0.4180 - 30s/epoch - 21ms/step
Epoch 28/50
1454/1454 - 30s - loss: 12.3722 - accuracy10: 0.4636 - accuracy20: 0.4646 - accuracy30: 0.4651 - accuracy50: 0.4491 - val_loss: 12.5963 - val_accuracy10: 0.4070 - val_accuracy20: 0.4155 - val_accuracy30: 0.4251 - val_accuracy50: 0.4167 - 30s/epoch - 21ms/step
Epoch 29/50
1454/1454 - 30s - loss: 12.3598 - accuracy10: 0.4639 - accuracy20: 0.4654 - accuracy30: 0.4653 - accuracy50: 0.4488 - val_loss: 12.5854 - val_accuracy10: 0.4105 - val_accuracy20: 0.4165 - val_accuracy30: 0.4262 - val_accuracy50: 0.4194 - 30s/epoch - 21ms/step
Epoch 30/50
1454/1454 - 33s - loss: 12.3447 - accuracy10: 0.4653 - accuracy20: 0.4673 - accuracy30: 0.4676 - accuracy50: 0.4509 - val_loss: 12.5854 - val_accuracy10: 0.4164 - val_accuracy20: 0.4185 - val_accuracy30: 0.4259 - val_accuracy50: 0.4191 - 33s/epoch - 23ms/step
Epoch 31/50
1454/1454 - 32s - loss: 12.3290 - accuracy10: 0.4670 - accuracy20: 0.4673 - accuracy30: 0.4677 - accuracy50: 0.4511 - val_loss: 12.5929 - val_accuracy10: 0.4140 - val_accuracy20: 0.4164 - val_accuracy30: 0.4247 - val_accuracy50: 0.4173 - 32s/epoch - 22ms/step
Epoch 32/50
1454/1454 - 31s - loss: 12.3223 - accuracy10: 0.4657 - accuracy20: 0.4680 - accuracy30: 0.4684 - accuracy50: 0.4523 - val_loss: 12.5806 - val_accuracy10: 0.4209 - val_accuracy20: 0.4198 - val_accuracy30: 0.4266 - val_accuracy50: 0.4191 - 31s/epoch - 21ms/step
Epoch 33/50
1454/1454 - 28s - loss: 12.3040 - accuracy10: 0.4673 - accuracy20: 0.4697 - accuracy30: 0.4700 - accuracy50: 0.4538 - val_loss: 12.5819 - val_accuracy10: 0.4197 - val_accuracy20: 0.4209 - val_accuracy30: 0.4281 - val_accuracy50: 0.4198 - 28s/epoch - 19ms/step
Epoch 34/50
1454/1454 - 31s - loss: 12.2882 - accuracy10: 0.4678 - accuracy20: 0.4702 - accuracy30: 0.4718 - accuracy50: 0.4555 - val_loss: 12.5840 - val_accuracy10: 0.4188 - val_accuracy20: 0.4186 - val_accuracy30: 0.4259 - val_accuracy50: 0.4179 - 31s/epoch - 21ms/step
Epoch 35/50
1454/1454 - 30s - loss: 12.2666 - accuracy10: 0.4690 - accuracy20: 0.4731 - accuracy30: 0.4741 - accuracy50: 0.4575 - val_loss: 12.5921 - val_accuracy10: 0.4162 - val_accuracy20: 0.4173 - val_accuracy30: 0.4252 - val_accuracy50: 0.4179 - 30s/epoch - 21ms/step
Epoch 36/50
1454/1454 - 33s - loss: 12.2542 - accuracy10: 0.4702 - accuracy20: 0.4731 - accuracy30: 0.4747 - accuracy50: 0.4588 - val_loss: 12.5685 - val_accuracy10: 0.4203 - val_accuracy20: 0.4207 - val_accuracy30: 0.4278 - val_accuracy50: 0.4193 - 33s/epoch - 23ms/step
Epoch 37/50
1454/1454 - 31s - loss: 12.2354 - accuracy10: 0.4712 - accuracy20: 0.4752 - accuracy30: 0.4766 - accuracy50: 0.4607 - val_loss: 12.5830 - val_accuracy10: 0.4129 - val_accuracy20: 0.4164 - val_accuracy30: 0.4256 - val_accuracy50: 0.4186 - 31s/epoch - 21ms/step
Epoch 38/50
1454/1454 - 31s - loss: 12.2283 - accuracy10: 0.4704 - accuracy20: 0.4755 - accuracy30: 0.4776 - accuracy50: 0.4614 - val_loss: 12.5772 - val_accuracy10: 0.4201 - val_accuracy20: 0.4219 - val_accuracy30: 0.4279 - val_accuracy50: 0.4196 - 31s/epoch - 22ms/step
Epoch 39/50
1454/1454 - 30s - loss: 12.2111 - accuracy10: 0.4718 - accuracy20: 0.4761 - accuracy30: 0.4791 - accuracy50: 0.4627 - val_loss: 12.5721 - val_accuracy10: 0.4257 - val_accuracy20: 0.4246 - val_accuracy30: 0.4295 - val_accuracy50: 0.4215 - 30s/epoch - 21ms/step
Epoch 40/50
1454/1454 - 32s - loss: 12.2027 - accuracy10: 0.4724 - accuracy20: 0.4772 - accuracy30: 0.4794 - accuracy50: 0.4632 - val_loss: 12.6018 - val_accuracy10: 0.4258 - val_accuracy20: 0.4232 - val_accuracy30: 0.4268 - val_accuracy50: 0.4185 - 32s/epoch - 22ms/step
Epoch 41/50
1454/1454 - 30s - loss: 12.1892 - accuracy10: 0.4738 - accuracy20: 0.4788 - accuracy30: 0.4814 - accuracy50: 0.4649 - val_loss: 12.6001 - val_accuracy10: 0.4232 - val_accuracy20: 0.4209 - val_accuracy30: 0.4261 - val_accuracy50: 0.4167 - 30s/epoch - 21ms/step
Epoch 42/50
1454/1454 - 31s - loss: 12.1730 - accuracy10: 0.4746 - accuracy20: 0.4797 - accuracy30: 0.4823 - accuracy50: 0.4669 - val_loss: 12.6010 - val_accuracy10: 0.4126 - val_accuracy20: 0.4159 - val_accuracy30: 0.4243 - val_accuracy50: 0.4172 - 31s/epoch - 22ms/step
Epoch 43/50
1454/1454 - 34s - loss: 12.1538 - accuracy10: 0.4755 - accuracy20: 0.4809 - accuracy30: 0.4832 - accuracy50: 0.4669 - val_loss: 12.5928 - val_accuracy10: 0.4264 - val_accuracy20: 0.4250 - val_accuracy30: 0.4285 - val_accuracy50: 0.4195 - 34s/epoch - 23ms/step
Epoch 44/50
1454/1454 - 33s - loss: 12.1433 - accuracy10: 0.4759 - accuracy20: 0.4820 - accuracy30: 0.4853 - accuracy50: 0.4690 - val_loss: 12.6157 - val_accuracy10: 0.4199 - val_accuracy20: 0.4179 - val_accuracy30: 0.4234 - val_accuracy50: 0.4172 - 33s/epoch - 23ms/step
Epoch 45/50
1454/1454 - 30s - loss: 12.1274 - accuracy10: 0.4766 - accuracy20: 0.4832 - accuracy30: 0.4867 - accuracy50: 0.4707 - val_loss: 12.6069 - val_accuracy10: 0.4305 - val_accuracy20: 0.4266 - val_accuracy30: 0.4298 - val_accuracy50: 0.4203 - 30s/epoch - 21ms/step
Epoch 46/50
1454/1454 - 32s - loss: 12.1123 - accuracy10: 0.4763 - accuracy20: 0.4841 - accuracy30: 0.4879 - accuracy50: 0.4718 - val_loss: 12.6137 - val_accuracy10: 0.4275 - val_accuracy20: 0.4222 - val_accuracy30: 0.4265 - val_accuracy50: 0.4181 - 32s/epoch - 22ms/step
testing model: results/WBA/W0/deepOF_L1/seq2seq
Evaluating performance on  test set...
5633/5633 - 59s - 59s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0302578
{'0': {'precision': 0.2578989375781342, 'recall': 0.5497565125302731, 'f1-score': 0.3510943199583116, 'support': 230402}, '1': {'precision': 0.8061852017797043, 'recall': 0.3946623682680242, 'f1-score': 0.5299106546626349, 'support': 980210}, '2': {'precision': 0.25979967376898766, 'recall': 0.529035494794933, 'f1-score': 0.34847140299323837, 'support': 231217}, 'accuracy': 0.4409947365464282, 'macro avg': {'precision': 0.4412946043756087, 'recall': 0.4911514585310768, 'f1-score': 0.4098254592047283, 'support': 1441829}, 'weighted avg': {'precision': 0.6309495292591599, 'recall': 0.4409947365464282, 'f1-score': 0.4722398208801347, 'support': 1441829}}
[[126665  46624  57113]
 [301961 386852 291397]
 [ 62516  46379 122322]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0462067
{'0': {'precision': 0.3071225903363098, 'recall': 0.5443132008497593, 'f1-score': 0.3926799458743762, 'support': 297496}, '1': {'precision': 0.7475801337034611, 'recall': 0.34012717311224083, 'f1-score': 0.4675381252992032, 'support': 845619}, '2': {'precision': 0.3059309798148515, 'recall': 0.5426461431335659, 'f1-score': 0.39127207597769137, 'support': 298714}, 'accuracy': 0.4242146606844501, 'macro avg': {'precision': 0.4535445679515408, 'recall': 0.475695505698522, 'f1-score': 0.4171633823837569, 'support': 1441829}, 'weighted avg': {'precision': 0.5651998773233798, 'recall': 0.4242146606844501, 'f1-score': 0.43629187792646035, 'support': 1441829}}
[[161931  47433  88132]
 [278384 287618 279617]
 [ 86937  49681 162096]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0544254
{'0': {'precision': 0.3369714214697901, 'recall': 0.5314623735814944, 'f1-score': 0.41243819046191993, 'support': 341821}, '1': {'precision': 0.6936102310441294, 'recall': 0.3172314681748644, 'f1-score': 0.4353500495779737, 'support': 754985}, '2': {'precision': 0.33458673593868854, 'recall': 0.5405552673300041, 'f1-score': 0.4133332003603568, 'support': 345023}, 'accuracy': 0.42146051993683026, 'macro avg': {'precision': 0.45505612948420265, 'recall': 0.463083036362121, 'f1-score': 0.4203738134667501, 'support': 1441829}, 'weighted avg': {'precision': 0.5231475770960712, 'recall': 0.42146051993683026, 'f1-score': 0.4246497002560233, 'support': 1441829}}
[[181665  50592 109564]
 [254132 239505 261348]
 [103314  55205 186504]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.068765
{'0': {'precision': 0.3359980275053422, 'recall': 0.5190383758132501, 'f1-score': 0.4079261883960921, 'support': 354442}, '1': {'precision': 0.6491143633358454, 'recall': 0.2853539677038138, 'f1-score': 0.3964336787429501, 'support': 718413}, '2': {'precision': 0.3396256748276953, 'recall': 0.5324684124084624, 'f1-score': 0.4147257653397787, 'support': 368974}, 'accuracy': 0.4060384414517949, 'macro avg': {'precision': 0.441579355222961, 'recall': 0.44562025197517546, 'f1-score': 0.4063618774929403, 'support': 1441829}, 'weighted avg': {'precision': 0.4929412945058792, 'recall': 0.4060384414517949, 'f1-score': 0.40393993119484084, 'support': 1441829}}
[[183969  50671 119802]
 [251199 205002 262212]
 [112362  60145 196467]]
Evaluating performance on  train set...
1454/1454 - 12s - 12s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0455992
{'0': {'precision': 0.3333333333333333, 'recall': 0.49973127701834325, 'f1-score': 0.3999139809075014, 'support': 85590}, '1': {'precision': 0.6694818776309868, 'recall': 0.3773071585952382, 'f1-score': 0.4826193172419936, 'support': 201059}, '2': {'precision': 0.32877268825116507, 'recall': 0.5020013108000562, 'f1-score': 0.39732663912407135, 'support': 85444}, 'accuracy': 0.434101152131322, 'macro avg': {'precision': 0.4438626330718283, 'recall': 0.45967991547121256, 'f1-score': 0.4266199790911888, 'support': 372093}, 'weighted avg': {'precision': 0.5139226225958057, 'recall': 0.434101152131322, 'f1-score': 0.4440093532653079, 'support': 372093}}
[[42772 18646 24172]
 [61799 75861 63399]
 [23745 18806 42893]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0554259
{'0': {'precision': 0.3883909424635627, 'recall': 0.4988422684069987, 'f1-score': 0.4367415835959309, 'support': 107106}, '1': {'precision': 0.571618997276582, 'recall': 0.3153523814353909, 'f1-score': 0.40646500302332045, 'support': 157741}, '2': {'precision': 0.38175655062540254, 'recall': 0.5250638718460362, 'f1-score': 0.4420865865099647, 'support': 107246}, 'accuracy': 0.4286132767883298, 'macro avg': {'precision': 0.4472554967885158, 'recall': 0.44641950722947527, 'f1-score': 0.4284310577097387, 'support': 372093}, 'weighted avg': {'precision': 0.464154433330591, 'recall': 0.4286132767883298, 'f1-score': 0.4254470203722592, 'support': 372093}}
[[53429 18554 35123]
 [51926 49744 56071]
 [32210 18725 56311]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0569345
{'0': {'precision': 0.42199041724895187, 'recall': 0.4910680948864532, 'f1-score': 0.45391621129326043, 'support': 120523}, '1': {'precision': 0.4973915772132369, 'recall': 0.29156543399118606, 'f1-score': 0.367630147179621, 'support': 130475}, '2': {'precision': 0.4129494457961611, 'recall': 0.5297906602254429, 'f1-score': 0.46412952653796485, 'support': 121095}, 'accuracy': 0.4337141521071345, 'macro avg': {'precision': 0.44411048008611664, 'recall': 0.43747472970102735, 'f1-score': 0.42855862833694874, 'support': 372093}, 'weighted avg': {'precision': 0.4454876340959885, 'recall': 0.4337141521071345, 'f1-score': 0.4269837164447424, 'support': 372093}}
[[59185 18891 42447]
 [43677 38042 48756]
 [37390 19550 64155]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0670292
{'0': {'precision': 0.4181714422595941, 'recall': 0.48060308180633043, 'f1-score': 0.4472189152940822, 'support': 123499}, '1': {'precision': 0.45087508504755425, 'recall': 0.25401045532022476, 'f1-score': 0.3249520073449629, 'support': 122617}, '2': {'precision': 0.4130757339657431, 'recall': 0.5281678401612993, 'f1-score': 0.46358524876852436, 'support': 125977}, 'accuracy': 0.42203696387731027, 'macro avg': {'precision': 0.42737408709096386, 'recall': 0.42092712576261815, 'f1-score': 0.4119187238025231, 'support': 372093}, 'weighted avg': {'precision': 0.4272231592335679, 'recall': 0.42203696387731027, 'f1-score': 0.41246894724876193, 'support': 372093}}
[[59354 18298 45847]
 [42778 31146 48693]
 [39805 19635 66537]]
Evaluating performance on  val set...
557/557 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0562683
{'0': {'precision': 0.3221447522675387, 'recall': 0.5066636475383322, 'f1-score': 0.39386433645564844, 'support': 30914}, '1': {'precision': 0.6881321213673025, 'recall': 0.3355222911646837, 'f1-score': 0.45109689981032947, 'support': 80099}, '2': {'precision': 0.31393649285635983, 'recall': 0.5472815874128102, 'f1-score': 0.39899687685037905, 'support': 31397}, 'accuracy': 0.41935959553402147, 'macro avg': {'precision': 0.4414044554970669, 'recall': 0.46315584203860866, 'f1-score': 0.41465270437211904, 'support': 142410}, 'weighted avg': {'precision': 0.5261859541268828, 'recall': 0.41935959553402147, 'f1-score': 0.4271865572471656, 'support': 142410}}
[[15663  6233  9018]
 [24691 26875 28533]
 [ 8267  5947 17183]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0625814
{'0': {'precision': 0.3776504076060647, 'recall': 0.5013753566929741, 'f1-score': 0.4308055929844713, 'support': 38899}, '1': {'precision': 0.5885674427873916, 'recall': 0.2792090128417238, 'f1-score': 0.37874577865173337, 'support': 63465}, '2': {'precision': 0.37187603033300365, 'recall': 0.5633022024671628, 'f1-score': 0.4479971401902568, 'support': 40046}, 'accuracy': 0.41978091426163894, 'macro avg': {'precision': 0.44603129357548665, 'recall': 0.4479621906672869, 'f1-score': 0.41918283727548716, 'support': 142410}, 'weighted avg': {'precision': 0.47002179251938475, 'recall': 0.41978091426163894, 'f1-score': 0.41243944301449503, 'support': 142410}}
[[19503  6293 13103]
 [20746 17720 24999]
 [11394  6094 22558]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0629072
{'0': {'precision': 0.40937088807948285, 'recall': 0.4880083657277956, 'f1-score': 0.4452441199651554, 'support': 43989}, '1': {'precision': 0.513382816014395, 'recall': 0.2599066271919836, 'f1-score': 0.3451013002721499, 'support': 52692}, '2': {'precision': 0.406635595228691, 'recall': 0.5628375866517965, 'f1-score': 0.4721529204578808, 'support': 45729}, 'accuracy': 0.4276385085317042, 'macro avg': {'precision': 0.4431297664408563, 'recall': 0.43691752652385857, 'f1-score': 0.4208327802317287, 'support': 142410}, 'weighted avg': {'precision': 0.44697719592284024, 'recall': 0.4276385085317042, 'f1-score': 0.41683169866375797, 'support': 142410}}
[[21467  6578 15944]
 [17384 13695 21613]
 [13588  6403 25738]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0712577
{'0': {'precision': 0.4081304504095492, 'recall': 0.4709567571107376, 'f1-score': 0.43729857915965703, 'support': 45811}, '1': {'precision': 0.45887196377109923, 'recall': 0.23174484364604125, 'f1-score': 0.30796010278230596, 'support': 48096}, '2': {'precision': 0.41405519714360145, 'recall': 0.5570789435705008, 'f1-score': 0.4750351617440225, 'support': 48503}, 'accuracy': 0.419500035109894, 'macro avg': {'precision': 0.42701920377475, 'recall': 0.4199268481090932, 'f1-score': 0.40676461456199514, 'support': 142410}, 'weighted avg': {'precision': 0.42728522758445864, 'recall': 0.419500035109894, 'f1-score': 0.40646980382958464, 'support': 142410}}
[[21575  6624 17612]
 [16325 11146 20625]
 [14963  6520 27020]]
training model: results/WBA/W0/deepLOB_L2/seq2seq
Epoch 1/50
1454/1454 - 75s - loss: 12.6635 - accuracy10: 0.4329 - accuracy20: 0.4396 - accuracy30: 0.4386 - accuracy50: 0.4260 - val_loss: 12.6883 - val_accuracy10: 0.4191 - val_accuracy20: 0.4323 - val_accuracy30: 0.4317 - val_accuracy50: 0.4173 - 75s/epoch - 52ms/step
Epoch 2/50
1454/1454 - 69s - loss: 12.4251 - accuracy10: 0.4484 - accuracy20: 0.4629 - accuracy30: 0.4613 - accuracy50: 0.4434 - val_loss: 12.7366 - val_accuracy10: 0.4458 - val_accuracy20: 0.4573 - val_accuracy30: 0.4504 - val_accuracy50: 0.4334 - 69s/epoch - 48ms/step
Epoch 3/50
1454/1454 - 69s - loss: 12.2342 - accuracy10: 0.4727 - accuracy20: 0.4806 - accuracy30: 0.4765 - accuracy50: 0.4553 - val_loss: 12.6897 - val_accuracy10: 0.5553 - val_accuracy20: 0.4975 - val_accuracy30: 0.4528 - val_accuracy50: 0.4210 - 69s/epoch - 48ms/step
Epoch 4/50
1454/1454 - 68s - loss: 12.1084 - accuracy10: 0.4891 - accuracy20: 0.4915 - accuracy30: 0.4849 - accuracy50: 0.4620 - val_loss: 13.0667 - val_accuracy10: 0.5599 - val_accuracy20: 0.4939 - val_accuracy30: 0.4441 - val_accuracy50: 0.4123 - 68s/epoch - 47ms/step
Epoch 5/50
1454/1454 - 68s - loss: 12.0222 - accuracy10: 0.4995 - accuracy20: 0.4990 - accuracy30: 0.4914 - accuracy50: 0.4666 - val_loss: 12.9998 - val_accuracy10: 0.5525 - val_accuracy20: 0.4970 - val_accuracy30: 0.4539 - val_accuracy50: 0.4240 - 68s/epoch - 47ms/step
Epoch 6/50
1454/1454 - 70s - loss: 11.9508 - accuracy10: 0.5082 - accuracy20: 0.5047 - accuracy30: 0.4957 - accuracy50: 0.4702 - val_loss: 12.8752 - val_accuracy10: 0.5559 - val_accuracy20: 0.4998 - val_accuracy30: 0.4563 - val_accuracy50: 0.4264 - 70s/epoch - 48ms/step
Epoch 7/50
1454/1454 - 70s - loss: 11.8890 - accuracy10: 0.5132 - accuracy20: 0.5091 - accuracy30: 0.4994 - accuracy50: 0.4729 - val_loss: 12.7741 - val_accuracy10: 0.5500 - val_accuracy20: 0.5011 - val_accuracy30: 0.4618 - val_accuracy50: 0.4334 - 70s/epoch - 48ms/step
Epoch 8/50
1454/1454 - 69s - loss: 11.8365 - accuracy10: 0.5172 - accuracy20: 0.5129 - accuracy30: 0.5028 - accuracy50: 0.4758 - val_loss: 12.7466 - val_accuracy10: 0.5392 - val_accuracy20: 0.4992 - val_accuracy30: 0.4661 - val_accuracy50: 0.4393 - 69s/epoch - 47ms/step
Epoch 9/50
1454/1454 - 69s - loss: 11.7840 - accuracy10: 0.5214 - accuracy20: 0.5170 - accuracy30: 0.5062 - accuracy50: 0.4788 - val_loss: 12.7389 - val_accuracy10: 0.5383 - val_accuracy20: 0.5008 - val_accuracy30: 0.4691 - val_accuracy50: 0.4422 - 69s/epoch - 47ms/step
Epoch 10/50
1454/1454 - 69s - loss: 11.7355 - accuracy10: 0.5246 - accuracy20: 0.5197 - accuracy30: 0.5098 - accuracy50: 0.4822 - val_loss: 12.7289 - val_accuracy10: 0.5178 - val_accuracy20: 0.4928 - val_accuracy30: 0.4688 - val_accuracy50: 0.4439 - 69s/epoch - 47ms/step
Epoch 11/50
1454/1454 - 68s - loss: 11.6957 - accuracy10: 0.5263 - accuracy20: 0.5222 - accuracy30: 0.5125 - accuracy50: 0.4841 - val_loss: 12.7478 - val_accuracy10: 0.5122 - val_accuracy20: 0.4918 - val_accuracy30: 0.4702 - val_accuracy50: 0.4468 - 68s/epoch - 47ms/step
testing model: results/WBA/W0/deepLOB_L2/seq2seq
Evaluating performance on  test set...
5633/5633 - 95s - 95s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1057967
{'0': {'precision': 0.2498542046385355, 'recall': 0.6526824737525119, 'f1-score': 0.36137137529227153, 'support': 230403}, '1': {'precision': 0.8182198733713568, 'recall': 0.1276215019011213, 'f1-score': 0.22080330138849297, 'support': 980211}, '2': {'precision': 0.2358257832114398, 'recall': 0.7007611798287345, 'f1-score': 0.35289313347018114, 'support': 231220}, 'accuracy': 0.30343715018511147, 'macro avg': {'precision': 0.4346332870737774, 'recall': 0.4936883851607892, 'f1-score': 0.3116892700503152, 'support': 1441834}, 'weighted avg': {'precision': 0.6340001111103585, 'recall': 0.30343715018511147, 'f1-score': 0.2644484900201803, 'support': 1441834}}
[[150380  15287  64736]
 [394806 125096 460309]
 [ 56685  12505 162030]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0781515
{'0': {'precision': 0.3088736306047256, 'recall': 0.6134562249157978, 'f1-score': 0.41087350750426904, 'support': 297498}, '1': {'precision': 0.7481464674029693, 'recall': 0.14427047610037605, 'f1-score': 0.24189466107920493, 'support': 845620}, '2': {'precision': 0.2938607712704098, 'recall': 0.6767230412833595, 'f1-score': 0.4097788408911232, 'support': 298716}, 'accuracy': 0.35139135295741397, 'macro avg': {'precision': 0.45029362309270154, 'recall': 0.4781499140998444, 'f1-score': 0.3541823364915324, 'support': 1441834}, 'weighted avg': {'precision': 0.5633920529504474, 'recall': 0.35139135295741397, 'f1-score': 0.31154245653309265, 'support': 1441834}}
[[182502  21948  93048]
 [330914 121998 392708]
 [ 77447  19121 202148]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0676051
{'0': {'precision': 0.3452914798206278, 'recall': 0.5802769269475723, 'f1-score': 0.4329548790696202, 'support': 341823}, '1': {'precision': 0.6893646657081236, 'recall': 0.16257276634635126, 'f1-score': 0.2630989471969373, 'support': 754985}, '2': {'precision': 0.32954950981956604, 'recall': 0.6584170468312533, 'f1-score': 0.43924769230174293, 'support': 345026}, 'accuracy': 0.3802538988538209, 'macro avg': {'precision': 0.4547352184494391, 'recall': 0.4670889133750589, 'f1-score': 0.3784338395227668, 'support': 1441834}, 'weighted avg': {'precision': 0.5216909164448749, 'recall': 0.3802538988538209, 'f1-score': 0.3455193653095957, 'support': 1441834}}
[[198352  28447 115024]
 [285102 122740 347143]
 [ 90994  26861 227171]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0697765
{'0': {'precision': 0.3491657543560951, 'recall': 0.5461962961709043, 'f1-score': 0.42600206624072917, 'support': 354444}, '1': {'precision': 0.6427159232834598, 'recall': 0.17692886960564466, 'f1-score': 0.27747385884869785, 'support': 718413}, '2': {'precision': 0.340122155292671, 'recall': 0.6356846090677739, 'f1-score': 0.4431418744349801, 'support': 368977}, 'accuracy': 0.38510466530821164, 'macro avg': {'precision': 0.4440012776440753, 'recall': 0.4529365916147743, 'f1-score': 0.3822059331748024, 'support': 1441834}, 'weighted avg': {'precision': 0.4931167067250848, 'recall': 0.38510466530821164, 'f1-score': 0.3563821238277737, 'support': 1441834}}
[[193596  34002 126846]
 [263090 127108 328215]
 [ 97767  36657 234553]]
Evaluating performance on  train set...
1454/1454 - 25s - 25s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0610464
{'0': {'precision': 0.3623705894781323, 'recall': 0.4005698737636192, 'f1-score': 0.3805139411957203, 'support': 85633}, '1': {'precision': 0.6235872129981791, 'recall': 0.28811298118805473, 'f1-score': 0.3941286227936369, 'support': 200883}, '2': {'precision': 0.30666984433057815, 'recall': 0.6615875389990535, 'f1-score': 0.41908061036043537, 'support': 85579}, 'accuracy': 0.399889813085368, 'macro avg': {'precision': 0.4308758822689632, 'recall': 0.45009013131690917, 'f1-score': 0.39790772478326425, 'support': 372095}, 'weighted avg': {'precision': 0.49058291405544463, 'recall': 0.399889813085368, 'f1-score': 0.39673414051009276, 'support': 372095}}
[[34302 19612 31719]
 [46721 57877 96285]
 [13637 15324 56618]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.06237
{'0': {'precision': 0.423494466231858, 'recall': 0.3736766996539599, 'f1-score': 0.39702894744665884, 'support': 107213}, '1': {'precision': 0.5033396111848673, 'recall': 0.3105900881448929, 'f1-score': 0.3841420071867575, 'support': 157468}, '2': {'precision': 0.36975605427917063, 'recall': 0.6207477609994972, 'f1-score': 0.4634515067369614, 'support': 107414}, 'accuracy': 0.4183017777718056, 'macro avg': {'precision': 0.4321967105652986, 'recall': 0.43500484959945007, 'f1-score': 0.41487415379012593, 'support': 372095}, 'weighted avg': {'precision': 0.4417715124269816, 'recall': 0.4183017777718056, 'f1-score': 0.4107497232559613, 'support': 372095}}
[[40063 25947 41203]
 [36113 48908 72447]
 [18425 22312 66677]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0675004
{'0': {'precision': 0.4559918681789001, 'recall': 0.35342168115172823, 'f1-score': 0.39820784511595747, 'support': 120584}, '1': {'precision': 0.4225004543324183, 'recall': 0.33911421267187175, 'f1-score': 0.3762425150975699, 'support': 130257}, '2': {'precision': 0.40713785140677594, 'recall': 0.5845332937470105, 'f1-score': 0.4799688494616374, 'support': 121254}, 'accuracy': 0.42372512396027895, 'macro avg': {'precision': 0.4285433913060315, 'recall': 0.4256897291902035, 'f1-score': 0.41813973655838826, 'support': 372095}, 'weighted avg': {'precision': 0.42834775567244787, 'recall': 0.42372512396027895, 'f1-score': 0.41716190477471654, 'support': 372095}}
[[42617 31562 46405]
 [29281 44172 56804]
 [21562 28815 70877]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0759906
{'0': {'precision': 0.44636821111437175, 'recall': 0.3324778990317671, 'f1-score': 0.38109599083194534, 'support': 123524}, '1': {'precision': 0.3879831211684256, 'recall': 0.35785213652200165, 'f1-score': 0.3723089983022071, 'support': 122559}, '2': {'precision': 0.40881308853197007, 'recall': 0.541940450115862, 'f1-score': 0.46605632312947226, 'support': 126012}, 'accuracy': 0.41177118746556657, 'macro avg': {'precision': 0.41438814027158916, 'recall': 0.41075682855654355, 'f1-score': 0.40648710408787486, 'support': 372095}, 'weighted avg': {'precision': 0.41441934228910177, 'recall': 0.41177118746556657, 'f1-score': 0.4069740498653206, 'support': 372095}}
[[41069 34974 47481]
 [27426 43858 51275]
 [23512 34209 68291]]
Evaluating performance on  val set...
557/557 - 9s - 9s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0462545
{'0': {'precision': 0.3533426286049754, 'recall': 0.3104448742746615, 'f1-score': 0.33050760201805257, 'support': 31020}, '1': {'precision': 0.6524974399817954, 'recall': 0.35829511801971786, 'f1-score': 0.46258086372949164, 'support': 80029}, '2': {'precision': 0.3000758299163062, 'recall': 0.681365984312225, 'f1-score': 0.41665529276424823, 'support': 31362}, 'accuracy': 0.4190195982051948, 'macro avg': {'precision': 0.43530529950102564, 'recall': 0.4500353255355347, 'f1-score': 0.40324791950393085, 'support': 142411}, 'weighted avg': {'precision': 0.5097245587873452, 'recall': 0.4190195982051948, 'f1-score': 0.42369882277127346, 'support': 142411}}
[[ 9630  8855 12535]
 [14047 28674 37308]
 [ 3577  6416 21369]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0553693
{'0': {'precision': 0.4146430129416897, 'recall': 0.2930099930639402, 'f1-score': 0.3433732219462633, 'support': 38927}, '1': {'precision': 0.5393958062883671, 'recall': 0.38625155587767257, 'f1-score': 0.45015516259938665, 'support': 63469}, '2': {'precision': 0.3702306562616984, 'recall': 0.6426090216168937, 'f1-score': 0.4697951018096448, 'support': 40015}, 'accuracy': 0.43279662385630324, 'macro avg': {'precision': 0.4414231584972517, 'recall': 0.4406235235195021, 'f1-score': 0.4211078287850983, 'support': 142411}, 'weighted avg': {'precision': 0.4577630990893217, 'recall': 0.43279662385630324, 'f1-score': 0.42648558344956217, 'support': 142411}}
[[11406 11483 16038]
 [11252 24515 27702]
 [ 4850  9451 25714]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0661083
{'0': {'precision': 0.4469868104641842, 'recall': 0.2785206711013236, 'f1-score': 0.34319443861636806, 'support': 44047}, '1': {'precision': 0.45515241294414654, 'recall': 0.4141669198055893, 'f1-score': 0.43369350205266344, 'support': 52672}, '2': {'precision': 0.41071961334208484, 'recall': 0.6025781318392717, 'f1-score': 0.4884855581576893, 'support': 45692}, 'accuracy': 0.4326632071960733, 'macro avg': {'precision': 0.4376196122501385, 'recall': 0.43175524091539486, 'f1-score': 0.42179116627557356, 'support': 142411}, 'weighted avg': {'precision': 0.4383707473996851, 'recall': 0.4326632071960733, 'f1-score': 0.4232824128837954, 'support': 142411}}
[[12268 13733 18046]
 [ 9400 21815 21457]
 [ 5778 12381 27533]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0761026
{'0': {'precision': 0.4394050679397723, 'recall': 0.2612217273600559, 'f1-score': 0.3276556124544733, 'support': 45804}, '1': {'precision': 0.40200082064909437, 'recall': 0.42823245358421447, 'f1-score': 0.41470223637664655, 'support': 48044}, '2': {'precision': 0.4199712508984094, 'recall': 0.5534872227827771, 'f1-score': 0.47757295784657755, 'support': 48563}, 'accuracy': 0.41722900618631986, 'macro avg': {'precision': 0.4204590464957587, 'recall': 0.4143138012423491, 'f1-score': 0.40664360222589907, 'support': 142411}, 'weighted avg': {'precision': 0.4201592644989353, 'recall': 0.41722900618631986, 'f1-score': 0.4081445075819118, 'support': 142411}}
[[11965 15390 18449]
 [ 8796 20574 18674]
 [ 6469 15215 26879]]
training model: results/WBA/W0/deepOF_L2/seq2seq
Epoch 1/50
1454/1454 - 46s - loss: 12.5099 - accuracy10: 0.4620 - accuracy20: 0.4598 - accuracy30: 0.4513 - accuracy50: 0.4319 - val_loss: 12.1587 - val_accuracy10: 0.4409 - val_accuracy20: 0.4515 - val_accuracy30: 0.4533 - val_accuracy50: 0.4353 - 46s/epoch - 32ms/step
Epoch 2/50
1454/1454 - 44s - loss: 12.0191 - accuracy10: 0.5042 - accuracy20: 0.5008 - accuracy30: 0.4905 - accuracy50: 0.4644 - val_loss: 11.8853 - val_accuracy10: 0.5002 - val_accuracy20: 0.4969 - val_accuracy30: 0.4862 - val_accuracy50: 0.4594 - 44s/epoch - 30ms/step
Epoch 3/50
1454/1454 - 41s - loss: 11.8732 - accuracy10: 0.5175 - accuracy20: 0.5124 - accuracy30: 0.5009 - accuracy50: 0.4742 - val_loss: 11.8343 - val_accuracy10: 0.5026 - val_accuracy20: 0.5009 - val_accuracy30: 0.4900 - val_accuracy50: 0.4633 - 41s/epoch - 29ms/step
Epoch 4/50
1454/1454 - 41s - loss: 11.7999 - accuracy10: 0.5223 - accuracy20: 0.5165 - accuracy30: 0.5053 - accuracy50: 0.4779 - val_loss: 11.7932 - val_accuracy10: 0.5115 - val_accuracy20: 0.5054 - val_accuracy30: 0.4932 - val_accuracy50: 0.4654 - 41s/epoch - 28ms/step
Epoch 5/50
1454/1454 - 40s - loss: 11.7483 - accuracy10: 0.5251 - accuracy20: 0.5193 - accuracy30: 0.5084 - accuracy50: 0.4808 - val_loss: 11.7289 - val_accuracy10: 0.5220 - val_accuracy20: 0.5127 - val_accuracy30: 0.4984 - val_accuracy50: 0.4691 - 40s/epoch - 28ms/step
Epoch 6/50
1454/1454 - 43s - loss: 11.7024 - accuracy10: 0.5273 - accuracy20: 0.5220 - accuracy30: 0.5112 - accuracy50: 0.4833 - val_loss: 11.7144 - val_accuracy10: 0.5186 - val_accuracy20: 0.5113 - val_accuracy30: 0.4985 - val_accuracy50: 0.4698 - 43s/epoch - 30ms/step
Epoch 7/50
1454/1454 - 41s - loss: 11.6675 - accuracy10: 0.5291 - accuracy20: 0.5236 - accuracy30: 0.5133 - accuracy50: 0.4861 - val_loss: 11.7480 - val_accuracy10: 0.5217 - val_accuracy20: 0.5101 - val_accuracy30: 0.4969 - val_accuracy50: 0.4682 - 41s/epoch - 29ms/step
Epoch 8/50
1454/1454 - 41s - loss: 11.6375 - accuracy10: 0.5304 - accuracy20: 0.5257 - accuracy30: 0.5148 - accuracy50: 0.4878 - val_loss: 11.7100 - val_accuracy10: 0.5230 - val_accuracy20: 0.5126 - val_accuracy30: 0.4991 - val_accuracy50: 0.4701 - 41s/epoch - 28ms/step
Epoch 9/50
1454/1454 - 41s - loss: 11.6084 - accuracy10: 0.5325 - accuracy20: 0.5278 - accuracy30: 0.5176 - accuracy50: 0.4894 - val_loss: 11.7377 - val_accuracy10: 0.5260 - val_accuracy20: 0.5135 - val_accuracy30: 0.4994 - val_accuracy50: 0.4704 - 41s/epoch - 28ms/step
Epoch 10/50
1454/1454 - 41s - loss: 11.5795 - accuracy10: 0.5341 - accuracy20: 0.5290 - accuracy30: 0.5190 - accuracy50: 0.4912 - val_loss: 11.7338 - val_accuracy10: 0.5233 - val_accuracy20: 0.5099 - val_accuracy30: 0.4971 - val_accuracy50: 0.4698 - 41s/epoch - 28ms/step
Epoch 11/50
1454/1454 - 41s - loss: 11.5554 - accuracy10: 0.5362 - accuracy20: 0.5309 - accuracy30: 0.5206 - accuracy50: 0.4930 - val_loss: 11.7659 - val_accuracy10: 0.5197 - val_accuracy20: 0.5101 - val_accuracy30: 0.4986 - val_accuracy50: 0.4711 - 41s/epoch - 28ms/step
Epoch 12/50
1454/1454 - 41s - loss: 11.5297 - accuracy10: 0.5377 - accuracy20: 0.5327 - accuracy30: 0.5233 - accuracy50: 0.4949 - val_loss: 11.7469 - val_accuracy10: 0.5279 - val_accuracy20: 0.5154 - val_accuracy30: 0.5005 - val_accuracy50: 0.4716 - 41s/epoch - 28ms/step
Epoch 13/50
1454/1454 - 41s - loss: 11.5063 - accuracy10: 0.5387 - accuracy20: 0.5338 - accuracy30: 0.5245 - accuracy50: 0.4966 - val_loss: 11.7662 - val_accuracy10: 0.5277 - val_accuracy20: 0.5140 - val_accuracy30: 0.4982 - val_accuracy50: 0.4708 - 41s/epoch - 28ms/step
Epoch 14/50
1454/1454 - 41s - loss: 11.4800 - accuracy10: 0.5399 - accuracy20: 0.5353 - accuracy30: 0.5263 - accuracy50: 0.4980 - val_loss: 11.7485 - val_accuracy10: 0.5139 - val_accuracy20: 0.5080 - val_accuracy30: 0.4966 - val_accuracy50: 0.4708 - 41s/epoch - 28ms/step
Epoch 15/50
1454/1454 - 41s - loss: 11.4600 - accuracy10: 0.5402 - accuracy20: 0.5369 - accuracy30: 0.5276 - accuracy50: 0.4990 - val_loss: 11.7704 - val_accuracy10: 0.5192 - val_accuracy20: 0.5091 - val_accuracy30: 0.4973 - val_accuracy50: 0.4687 - 41s/epoch - 28ms/step
Epoch 16/50
1454/1454 - 42s - loss: 11.4366 - accuracy10: 0.5420 - accuracy20: 0.5383 - accuracy30: 0.5295 - accuracy50: 0.5017 - val_loss: 11.7704 - val_accuracy10: 0.5172 - val_accuracy20: 0.5070 - val_accuracy30: 0.4944 - val_accuracy50: 0.4677 - 42s/epoch - 29ms/step
Epoch 17/50
1454/1454 - 42s - loss: 11.4140 - accuracy10: 0.5430 - accuracy20: 0.5396 - accuracy30: 0.5307 - accuracy50: 0.5028 - val_loss: 11.8415 - val_accuracy10: 0.4996 - val_accuracy20: 0.4950 - val_accuracy30: 0.4863 - val_accuracy50: 0.4633 - 42s/epoch - 29ms/step
Epoch 18/50
1454/1454 - 41s - loss: 11.3909 - accuracy10: 0.5434 - accuracy20: 0.5411 - accuracy30: 0.5332 - accuracy50: 0.5058 - val_loss: 11.7640 - val_accuracy10: 0.5118 - val_accuracy20: 0.5064 - val_accuracy30: 0.4952 - val_accuracy50: 0.4701 - 41s/epoch - 28ms/step
testing model: results/WBA/W0/deepOF_L2/seq2seq
Evaluating performance on  test set...
5633/5633 - 57s - 57s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.83033276
{'0': {'precision': 0.410809245206511, 'recall': 0.4617017213392245, 'f1-score': 0.43477123595321926, 'support': 230402}, '1': {'precision': 0.8201572524114406, 'recall': 0.6475469542240948, 'f1-score': 0.7237021306919406, 'support': 980210}, '2': {'precision': 0.34394782978660976, 'recall': 0.6083635718826903, 'f1-score': 0.43944728563261304, 'support': 231217}, 'accuracy': 0.611565587874845, 'macro avg': {'precision': 0.5249714424681872, 'recall': 0.5725374158153366, 'f1-score': 0.5326402174259243, 'support': 1441829}, 'weighted avg': {'precision': 0.6783773925063648, 'recall': 0.611565587874845, 'f1-score': 0.6319472772941566, 'support': 1441829}}
[[106377  79524  44501]
 [121674 634732 223804]
 [ 30894  59659 140664]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.86673135
{'0': {'precision': 0.4714181256704241, 'recall': 0.42692674859493907, 'f1-score': 0.44807069842921776, 'support': 297496}, '1': {'precision': 0.7404099058802102, 'recall': 0.6538050824307401, 'f1-score': 0.6944176667229783, 'support': 845619}, '2': {'precision': 0.40325391940841243, 'recall': 0.5746834765026079, 'f1-score': 0.47394314868804666, 'support': 298714}, 'accuracy': 0.5906005497184479, 'macro avg': {'precision': 0.5383606503196822, 'recall': 0.5518051025094289, 'f1-score': 0.5388105046134143, 'support': 1441829}, 'weighted avg': {'precision': 0.6150571823684573, 'recall': 0.5906005497184479, 'f1-score': 0.5979110332319005, 'support': 1441829}}
[[127009 107967  62520]
 [101233 552870 191516]
 [ 41177  85871 171666]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.90348876
{'0': {'precision': 0.49944105471172845, 'recall': 0.4051799041018545, 'f1-score': 0.4473994918668, 'support': 341821}, '1': {'precision': 0.6790633779968384, 'recall': 0.6514685722232892, 'f1-score': 0.6649798214008071, 'support': 754985}, '2': {'precision': 0.4329556399585658, 'recall': 0.5524095495082937, 'f1-score': 0.48544201192248476, 'support': 345023}, 'accuracy': 0.5693754252411347, 'macro avg': {'precision': 0.5371533575557108, 'recall': 0.5363526752778125, 'f1-score': 0.5326071083966973, 'support': 1441829}, 'weighted avg': {'precision': 0.577587050173762, 'recall': 0.5693754252411347, 'f1-score': 0.5704344908093965, 'support': 1441829}}
[[138499 127668  75654]
 [ 89168 491849 173968]
 [ 49641 104788 190594]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.94483906
{'0': {'precision': 0.473843491784387, 'recall': 0.3816675224719418, 'f1-score': 0.4227898145905443, 'support': 354442}, '1': {'precision': 0.6364122765174731, 'recall': 0.6258475278147806, 'f1-score': 0.6310856902238754, 'support': 718413}, '2': {'precision': 0.42897727904252314, 'recall': 0.5230043309284665, 'f1-score': 0.4713472875090221, 'support': 368974}, 'accuracy': 0.5395029507660062, 'macro avg': {'precision': 0.5130776824481278, 'recall': 0.5101731270717297, 'f1-score': 0.5084075974411473, 'support': 1441829}, 'weighted avg': {'precision': 0.5433642618384185, 'recall': 0.5395029507660062, 'f1-score': 0.5390025623671467, 'support': 1441829}}
[[135279 136499  82664]
 [ 94586 449617 174210]
 [ 55628 120371 192975]]
Evaluating performance on  train set...
1454/1454 - 15s - 15s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.96612656
{'0': {'precision': 0.41558151345860844, 'recall': 0.4780231335436383, 'f1-score': 0.4446207346229081, 'support': 85590}, '1': {'precision': 0.7089020930357047, 'recall': 0.4610636678785829, 'f1-score': 0.5587325887664017, 'support': 201059}, '2': {'precision': 0.3716859374562558, 'recall': 0.6215181873507795, 'f1-score': 0.46518044849334267, 'support': 85444}, 'accuracy': 0.501810031363127, 'macro avg': {'precision': 0.4987231813168563, 'recall': 0.5202016629243335, 'f1-score': 0.48951125729421746, 'support': 372093}, 'weighted avg': {'precision': 0.5639963689201366, 'recall': 0.501810031363127, 'f1-score': 0.5110017723585873, 'support': 372093}}
[[40914 21017 23659]
 [42246 92701 66112]
 [15290 17049 53105]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9869727
{'0': {'precision': 0.47375735214961684, 'recall': 0.4519728119806547, 'f1-score': 0.46260876213047153, 'support': 107106}, '1': {'precision': 0.5949664931739196, 'recall': 0.4536487026201178, 'f1-score': 0.5147851734618636, 'support': 157741}, '2': {'precision': 0.4275585078656491, 'recall': 0.5965630419782556, 'f1-score': 0.49811588109808314, 'support': 107246}, 'accuracy': 0.4943575933973496, 'macro avg': {'precision': 0.4987607843963951, 'recall': 0.5007281855263427, 'f1-score': 0.4918366055634727, 'support': 372093}, 'weighted avg': {'precision': 0.5118258185282806, 'recall': 0.4943575933973496, 'f1-score': 0.4949618453129705, 'support': 372093}}
[[48409 26118 32579]
 [33102 71559 53080]
 [20670 22597 63979]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0042135
{'0': {'precision': 0.5003033750474023, 'recall': 0.4378583340939074, 'f1-score': 0.4670026504072955, 'support': 120523}, '1': {'precision': 0.5152051075720463, 'recall': 0.4465453151944817, 'f1-score': 0.47842438475624277, 'support': 130475}, '2': {'precision': 0.4558771804124383, 'recall': 0.5779677113010446, 'f1-score': 0.5097133868130989, 'support': 121095}, 'accuracy': 0.4865020304063769, 'macro avg': {'precision': 0.49046188767729565, 'recall': 0.4874571201964779, 'f1-score': 0.4850468073255458, 'support': 372093}, 'weighted avg': {'precision': 0.49107050453339623, 'recall': 0.4865020304063769, 'f1-score': 0.48490760270212413, 'support': 372093}}
[[52772 28878 38873]
 [27548 58263 44664]
 [25160 25946 69989]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0320722
{'0': {'precision': 0.4772340897331658, 'recall': 0.41823820435793, 'f1-score': 0.4457927510777583, 'support': 123499}, '1': {'precision': 0.4671164348983432, 'recall': 0.41503217335279774, 'f1-score': 0.4395367115502543, 'support': 122617}, '2': {'precision': 0.44882387874719204, 'recall': 0.5519261452487358, 'f1-score': 0.49506395673797493, 'support': 125977}, 'accuracy': 0.46244352890272056, 'macro avg': {'precision': 0.46439146779290036, 'recall': 0.4617321743198212, 'f1-score': 0.4601311397886625, 'support': 372093}, 'weighted avg': {'precision': 0.46428133428691587, 'recall': 0.46244352890272056, 'f1-score': 0.4604125957851652, 'support': 372093}}
[[51652 29882 41965]
 [28306 50890 43421]
 [28274 28173 69530]]
Evaluating performance on  val set...
557/557 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.938696
{'0': {'precision': 0.4097488590867094, 'recall': 0.47341010545383966, 'f1-score': 0.43928501748435406, 'support': 30914}, '1': {'precision': 0.7309033738728157, 'recall': 0.5049501242212762, 'f1-score': 0.5972710357659706, 'support': 80099}, '2': {'precision': 0.38163018926707687, 'recall': 0.6242316144854604, 'f1-score': 0.47367467040469824, 'support': 31397}, 'accuracy': 0.5244013763078436, 'macro avg': {'precision': 0.5074274740755339, 'recall': 0.5341972813868587, 'f1-score': 0.503410241218341, 'support': 142410}, 'weighted avg': {'precision': 0.5841840364164286, 'recall': 0.5244013763078436, 'f1-score': 0.5357266578963985, 'support': 142410}}
[[14635  8533  7746]
 [15642 40446 24011]
 [ 5440  6358 19599]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9653154
{'0': {'precision': 0.4678384746634889, 'recall': 0.4440731124193424, 'f1-score': 0.4556461185407929, 'support': 38899}, '1': {'precision': 0.6189415796913424, 'recall': 0.5036476798235248, 'f1-score': 0.5553740834694374, 'support': 63465}, '2': {'precision': 0.44079191739098134, 'recall': 0.5926684313040004, 'f1-score': 0.5055703482799021, 'support': 40046}, 'accuracy': 0.5124078365283337, 'macro avg': {'precision': 0.5091906572486042, 'recall': 0.5134630745156225, 'f1-score': 0.5055301834300442, 'support': 142410}, 'weighted avg': {'precision': 0.5275720055114482, 'recall': 0.5124078365283337, 'f1-score': 0.5141286759337343, 'support': 142410}}
[[17274 10779 10846]
 [12237 31964 19264]
 [ 7412  8900 23734]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9901944
{'0': {'precision': 0.4927817733214342, 'recall': 0.4267885153106458, 'f1-score': 0.45741713060533334, 'support': 43989}, '1': {'precision': 0.5351258651313775, 'recall': 0.49743794124345253, 'f1-score': 0.5155941105308194, 'support': 52692}, '2': {'precision': 0.4698812600531348, 'recall': 0.5685451245380393, 'f1-score': 0.5145260241440729, 'support': 45729}, 'accuracy': 0.4984481426866091, 'macro avg': {'precision': 0.4992629661686488, 'recall': 0.49759052703071255, 'f1-score': 0.4958457550934085, 'support': 142410}, 'weighted avg': {'precision': 0.5010956369153073, 'recall': 0.4984481426866091, 'f1-score': 0.4972808622173461, 'support': 142410}}
[[18774 12120 13095]
 [10244 26211 16237]
 [ 9080 10650 25999]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0235835
{'0': {'precision': 0.471288748051417, 'recall': 0.40256706904455264, 'f1-score': 0.43422570695297974, 'support': 45811}, '1': {'precision': 0.47438438185191434, 'recall': 0.4678351630073187, 'f1-score': 0.4710870111380957, 'support': 48096}, '2': {'precision': 0.4678317546152882, 'recall': 0.5386677112755912, 'f1-score': 0.5007570675610925, 'support': 48503}, 'accuracy': 0.4709641176883646, 'macro avg': {'precision': 0.47116829483953987, 'recall': 0.46968998110915416, 'f1-score': 0.4686899285507226, 'support': 142410}, 'weighted avg': {'precision': 0.47115682649138724, 'recall': 0.4709641176883646, 'f1-score': 0.4693345607530123, 'support': 142410}}
[[18442 12905 14464]
 [10339 22501 15256]
 [10350 12026 26127]]
training model: results/WBA/W0/deepVOL_L2/seq2seq
Epoch 1/50
1454/1454 - 45s - loss: 12.6678 - accuracy10: 0.4393 - accuracy20: 0.4439 - accuracy30: 0.4408 - accuracy50: 0.4254 - val_loss: 12.4142 - val_accuracy10: 0.4932 - val_accuracy20: 0.4857 - val_accuracy30: 0.4696 - val_accuracy50: 0.4388 - 45s/epoch - 31ms/step
Epoch 2/50
1454/1454 - 40s - loss: 12.2922 - accuracy10: 0.4725 - accuracy20: 0.4795 - accuracy30: 0.4751 - accuracy50: 0.4534 - val_loss: 12.0046 - val_accuracy10: 0.5380 - val_accuracy20: 0.5185 - val_accuracy30: 0.4939 - val_accuracy50: 0.4591 - 40s/epoch - 28ms/step
Epoch 3/50
1454/1454 - 41s - loss: 12.0717 - accuracy10: 0.4978 - accuracy20: 0.4990 - accuracy30: 0.4911 - accuracy50: 0.4668 - val_loss: 11.9993 - val_accuracy10: 0.5647 - val_accuracy20: 0.5273 - val_accuracy30: 0.4909 - val_accuracy50: 0.4530 - 41s/epoch - 28ms/step
Epoch 4/50
1454/1454 - 41s - loss: 11.9781 - accuracy10: 0.5076 - accuracy20: 0.5065 - accuracy30: 0.4970 - accuracy50: 0.4719 - val_loss: 11.8901 - val_accuracy10: 0.5682 - val_accuracy20: 0.5325 - val_accuracy30: 0.4960 - val_accuracy50: 0.4567 - 41s/epoch - 28ms/step
Epoch 5/50
1454/1454 - 40s - loss: 11.9162 - accuracy10: 0.5131 - accuracy20: 0.5110 - accuracy30: 0.5006 - accuracy50: 0.4740 - val_loss: 11.8627 - val_accuracy10: 0.5762 - val_accuracy20: 0.5374 - val_accuracy30: 0.4977 - val_accuracy50: 0.4579 - 40s/epoch - 27ms/step
Epoch 6/50
1454/1454 - 39s - loss: 11.8752 - accuracy10: 0.5155 - accuracy20: 0.5139 - accuracy30: 0.5027 - accuracy50: 0.4760 - val_loss: 11.8569 - val_accuracy10: 0.5747 - val_accuracy20: 0.5374 - val_accuracy30: 0.4981 - val_accuracy50: 0.4571 - 39s/epoch - 27ms/step
Epoch 7/50
1454/1454 - 40s - loss: 11.8392 - accuracy10: 0.5184 - accuracy20: 0.5158 - accuracy30: 0.5042 - accuracy50: 0.4777 - val_loss: 11.8260 - val_accuracy10: 0.5773 - val_accuracy20: 0.5398 - val_accuracy30: 0.5012 - val_accuracy50: 0.4602 - 40s/epoch - 27ms/step
Epoch 8/50
1454/1454 - 39s - loss: 11.8041 - accuracy10: 0.5202 - accuracy20: 0.5179 - accuracy30: 0.5067 - accuracy50: 0.4792 - val_loss: 11.8546 - val_accuracy10: 0.5763 - val_accuracy20: 0.5371 - val_accuracy30: 0.4967 - val_accuracy50: 0.4545 - 39s/epoch - 27ms/step
Epoch 9/50
1454/1454 - 39s - loss: 11.7730 - accuracy10: 0.5232 - accuracy20: 0.5198 - accuracy30: 0.5085 - accuracy50: 0.4806 - val_loss: 11.7882 - val_accuracy10: 0.5755 - val_accuracy20: 0.5416 - val_accuracy30: 0.5038 - val_accuracy50: 0.4626 - 39s/epoch - 27ms/step
Epoch 10/50
1454/1454 - 39s - loss: 11.7436 - accuracy10: 0.5243 - accuracy20: 0.5209 - accuracy30: 0.5101 - accuracy50: 0.4824 - val_loss: 11.8212 - val_accuracy10: 0.5706 - val_accuracy20: 0.5362 - val_accuracy30: 0.5005 - val_accuracy50: 0.4593 - 39s/epoch - 27ms/step
Epoch 11/50
1454/1454 - 39s - loss: 11.7170 - accuracy10: 0.5267 - accuracy20: 0.5232 - accuracy30: 0.5119 - accuracy50: 0.4841 - val_loss: 11.7820 - val_accuracy10: 0.5685 - val_accuracy20: 0.5366 - val_accuracy30: 0.5020 - val_accuracy50: 0.4596 - 39s/epoch - 27ms/step
Epoch 12/50
1454/1454 - 39s - loss: 11.6882 - accuracy10: 0.5275 - accuracy20: 0.5246 - accuracy30: 0.5134 - accuracy50: 0.4854 - val_loss: 11.7536 - val_accuracy10: 0.5687 - val_accuracy20: 0.5395 - val_accuracy30: 0.5053 - val_accuracy50: 0.4636 - 39s/epoch - 27ms/step
Epoch 13/50
1454/1454 - 39s - loss: 11.6691 - accuracy10: 0.5284 - accuracy20: 0.5251 - accuracy30: 0.5136 - accuracy50: 0.4859 - val_loss: 11.7593 - val_accuracy10: 0.5675 - val_accuracy20: 0.5379 - val_accuracy30: 0.5057 - val_accuracy50: 0.4637 - 39s/epoch - 27ms/step
Epoch 14/50
1454/1454 - 42s - loss: 11.6482 - accuracy10: 0.5296 - accuracy20: 0.5267 - accuracy30: 0.5159 - accuracy50: 0.4871 - val_loss: 11.7534 - val_accuracy10: 0.5695 - val_accuracy20: 0.5394 - val_accuracy30: 0.5069 - val_accuracy50: 0.4645 - 42s/epoch - 29ms/step
Epoch 15/50
1454/1454 - 40s - loss: 11.6315 - accuracy10: 0.5304 - accuracy20: 0.5272 - accuracy30: 0.5163 - accuracy50: 0.4883 - val_loss: 11.7241 - val_accuracy10: 0.5729 - val_accuracy20: 0.5437 - val_accuracy30: 0.5095 - val_accuracy50: 0.4673 - 40s/epoch - 28ms/step
Epoch 16/50
1454/1454 - 40s - loss: 11.6115 - accuracy10: 0.5319 - accuracy20: 0.5289 - accuracy30: 0.5179 - accuracy50: 0.4893 - val_loss: 11.7567 - val_accuracy10: 0.5687 - val_accuracy20: 0.5395 - val_accuracy30: 0.5062 - val_accuracy50: 0.4626 - 40s/epoch - 28ms/step
Epoch 17/50
1454/1454 - 39s - loss: 11.5931 - accuracy10: 0.5332 - accuracy20: 0.5299 - accuracy30: 0.5190 - accuracy50: 0.4905 - val_loss: 11.7412 - val_accuracy10: 0.5730 - val_accuracy20: 0.5417 - val_accuracy30: 0.5080 - val_accuracy50: 0.4657 - 39s/epoch - 27ms/step
Epoch 18/50
1454/1454 - 39s - loss: 11.5740 - accuracy10: 0.5344 - accuracy20: 0.5311 - accuracy30: 0.5203 - accuracy50: 0.4919 - val_loss: 11.7778 - val_accuracy10: 0.5708 - val_accuracy20: 0.5386 - val_accuracy30: 0.5062 - val_accuracy50: 0.4642 - 39s/epoch - 27ms/step
Epoch 19/50
1454/1454 - 39s - loss: 11.5571 - accuracy10: 0.5346 - accuracy20: 0.5317 - accuracy30: 0.5210 - accuracy50: 0.4932 - val_loss: 11.7884 - val_accuracy10: 0.5649 - val_accuracy20: 0.5366 - val_accuracy30: 0.5054 - val_accuracy50: 0.4634 - 39s/epoch - 27ms/step
Epoch 20/50
1454/1454 - 40s - loss: 11.5404 - accuracy10: 0.5351 - accuracy20: 0.5322 - accuracy30: 0.5226 - accuracy50: 0.4942 - val_loss: 11.7570 - val_accuracy10: 0.5653 - val_accuracy20: 0.5392 - val_accuracy30: 0.5080 - val_accuracy50: 0.4665 - 40s/epoch - 27ms/step
Epoch 21/50
1454/1454 - 39s - loss: 11.5220 - accuracy10: 0.5367 - accuracy20: 0.5334 - accuracy30: 0.5236 - accuracy50: 0.4949 - val_loss: 11.7625 - val_accuracy10: 0.5655 - val_accuracy20: 0.5384 - val_accuracy30: 0.5077 - val_accuracy50: 0.4656 - 39s/epoch - 27ms/step
Epoch 22/50
1454/1454 - 39s - loss: 11.5068 - accuracy10: 0.5368 - accuracy20: 0.5345 - accuracy30: 0.5241 - accuracy50: 0.4956 - val_loss: 11.7953 - val_accuracy10: 0.5598 - val_accuracy20: 0.5359 - val_accuracy30: 0.5052 - val_accuracy50: 0.4639 - 39s/epoch - 27ms/step
Epoch 23/50
1454/1454 - 40s - loss: 11.4891 - accuracy10: 0.5378 - accuracy20: 0.5354 - accuracy30: 0.5258 - accuracy50: 0.4968 - val_loss: 11.8326 - val_accuracy10: 0.5617 - val_accuracy20: 0.5372 - val_accuracy30: 0.5066 - val_accuracy50: 0.4648 - 40s/epoch - 28ms/step
Epoch 24/50
1454/1454 - 41s - loss: 11.4771 - accuracy10: 0.5376 - accuracy20: 0.5362 - accuracy30: 0.5261 - accuracy50: 0.4971 - val_loss: 11.7907 - val_accuracy10: 0.5575 - val_accuracy20: 0.5337 - val_accuracy30: 0.5059 - val_accuracy50: 0.4651 - 41s/epoch - 28ms/step
Epoch 25/50
1454/1454 - 40s - loss: 11.4574 - accuracy10: 0.5393 - accuracy20: 0.5367 - accuracy30: 0.5280 - accuracy50: 0.4995 - val_loss: 11.8323 - val_accuracy10: 0.5572 - val_accuracy20: 0.5342 - val_accuracy30: 0.5062 - val_accuracy50: 0.4662 - 40s/epoch - 28ms/step
testing model: results/WBA/W0/deepVOL_L2/seq2seq
Evaluating performance on  test set...
5633/5633 - 48s - 48s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.76238865
{'0': {'precision': 0.4151228787922441, 'recall': 0.500288624714088, 'f1-score': 0.4537440338532697, 'support': 230403}, '1': {'precision': 0.8187058607226675, 'recall': 0.7722827023977491, 'f1-score': 0.7948169952242734, 'support': 980211}, '2': {'precision': 0.43671409248033666, 'recall': 0.45241328604791975, 'f1-score': 0.4444250900686561, 'support': 231220}, 'accuracy': 0.6775225164616732, 'macro avg': {'precision': 0.5568476106650827, 'recall': 0.5749948710532523, 'f1-score': 0.5643287063820664, 'support': 1441834}, 'weighted avg': {'precision': 0.6929556936169485, 'recall': 0.6775225164616732, 'f1-score': 0.6841233579339576, 'support': 1441834}}
[[115268  82472  32663]
 [120949 757000 102262]
 [ 41455  85158 104607]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.81946665
{'0': {'precision': 0.47380500706195133, 'recall': 0.460066958433334, 'f1-score': 0.4668349335743643, 'support': 297498}, '1': {'precision': 0.736021665467618, 'recall': 0.8009129396182683, 'f1-score': 0.7670974077383885, 'support': 845620}, '2': {'precision': 0.5027320995927625, 'recall': 0.39177680472421966, 'f1-score': 0.4403729793190644, 'support': 298716}, 'accuracy': 0.6458212249121604, 'macro avg': {'precision': 0.5708529240407773, 'recall': 0.550918900925274, 'f1-score': 0.558101773543939, 'support': 1441834}, 'weighted avg': {'precision': 0.633585284162806, 'recall': 0.6458212249121604, 'f1-score': 0.6374532878892549, 'support': 1441834}}
[[136869 119081  41548]
 [ 94142 677268  74210]
 [ 57861 123825 117030]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8718015
{'0': {'precision': 0.4989688776266663, 'recall': 0.4331949576242675, 'f1-score': 0.4637613982119899, 'support': 341823}, '1': {'precision': 0.6689055203735688, 'recall': 0.817185771902753, 'f1-score': 0.7356480410556765, 'support': 754985}, '2': {'precision': 0.5320420432555236, 'recall': 0.34344658083738616, 'f1-score': 0.41743094219452603, 'support': 345026}, 'accuracy': 0.6127869088951987, 'macro avg': {'precision': 0.5666388137519195, 'recall': 0.5312757701214689, 'f1-score': 0.5389467938207307, 'support': 1441834}, 'weighted avg': {'precision': 0.5958667994876657, 'recall': 0.6127869088951987, 'f1-score': 0.5950422010848998, 'support': 1441834}}
[[148076 148740  45007]
 [ 78804 616963  59218]
 [ 69884 156644 118498]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.92502975
{'0': {'precision': 0.4754733860146116, 'recall': 0.4048735484307817, 'f1-score': 0.4373425735875622, 'support': 354444}, '1': {'precision': 0.6206669052078263, 'recall': 0.8040333345860946, 'f1-score': 0.7005500069736276, 'support': 718413}, '2': {'precision': 0.5165216228350895, 'recall': 0.2930805985196909, 'f1-score': 0.37396751732115596, 'support': 368977}, 'accuracy': 0.575151508426074, 'macro avg': {'precision': 0.5375539713525092, 'recall': 0.5006624938455224, 'f1-score': 0.5039533659607819, 'support': 1441834}, 'weighted avg': {'precision': 0.5583225676689938, 'recall': 0.575151508426074, 'f1-score': 0.55227099371441, 'support': 1441834}}
[[143505 166544  44395]
 [ 83958 577628  56827]
 [ 74352 186485 108140]]
Evaluating performance on  train set...
1454/1454 - 13s - 13s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9320294
{'0': {'precision': 0.4074047265752235, 'recall': 0.5258253243492579, 'f1-score': 0.459101637973664, 'support': 85633}, '1': {'precision': 0.6991552419830577, 'recall': 0.5899852152745628, 'f1-score': 0.6399477320403133, 'support': 200883}, '2': {'precision': 0.4291890717505839, 'recall': 0.4616669977447738, 'f1-score': 0.4448360111239965, 'support': 85579}, 'accuracy': 0.5457074134293661, 'macro avg': {'precision': 0.5119163467696217, 'recall': 0.5258258457895315, 'f1-score': 0.5146284603793245, 'support': 372095}, 'weighted avg': {'precision': 0.5699223665930526, 'recall': 0.5457074134293661, 'f1-score': 0.5534540690308485, 'support': 372095}}
[[ 45028  24770  15835]
 [ 45654 118518  36711]
 [ 19842  26228  39509]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9726186
{'0': {'precision': 0.46303188028627196, 'recall': 0.4978500741514555, 'f1-score': 0.47981014706411135, 'support': 107213}, '1': {'precision': 0.5803705140061454, 'recall': 0.6177318566311886, 'f1-score': 0.5984686516567048, 'support': 157468}, '2': {'precision': 0.4888415625175139, 'recall': 0.40601783752583465, 'f1-score': 0.4435968244765523, 'support': 107414}, 'accuracy': 0.5220736639836601, 'macro avg': {'precision': 0.5107479856033104, 'recall': 0.5071999227694929, 'f1-score': 0.5072918743991228, 'support': 372095}, 'weighted avg': {'precision': 0.5201393425789328, 'recall': 0.5220736639836601, 'f1-score': 0.5195717659215711, 'support': 372095}}
[[53376 33984 19853]
 [34445 97273 25750]
 [27454 36348 43612]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0022278
{'0': {'precision': 0.48928899316535757, 'recall': 0.47732700855834936, 'f1-score': 0.4832339853916548, 'support': 120584}, '1': {'precision': 0.4913372305014173, 'recall': 0.6413935527457257, 'f1-score': 0.5564261809220932, 'support': 130257}, '2': {'precision': 0.5192783786024804, 'recall': 0.3615385884177017, 'f1-score': 0.4262841862161177, 'support': 121254}, 'accuracy': 0.4970289845335197, 'macro avg': {'precision': 0.4999682007564184, 'recall': 0.49341971657392564, 'f1-score': 0.48864811750995524, 'support': 372095}, 'weighted avg': {'precision': 0.4997785998316015, 'recall': 0.4970289845335197, 'f1-score': 0.49029778593715456, 'support': 372095}}
[[57558 41568 21458]
 [27586 83546 19125]
 [32492 44924 43838]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0371417
{'0': {'precision': 0.47087669039895524, 'recall': 0.4524302969463424, 'f1-score': 0.46146922698991366, 'support': 123524}, '1': {'precision': 0.4388611440045307, 'recall': 0.625951582503121, 'f1-score': 0.5159702185185933, 'support': 122559}, '2': {'precision': 0.5031105682989199, 'recall': 0.31382725454718596, 'f1-score': 0.3865405762040906, 'support': 126012}, 'accuracy': 0.4626452921968852, 'macro avg': {'precision': 0.4709494675674686, 'recall': 0.46406971133221636, 'f1-score': 0.45466000723753247, 'support': 372095}, 'weighted avg': {'precision': 0.4712477302446293, 'recall': 0.4626452921968852, 'f1-score': 0.4540455257252912, 'support': 372095}}
[[55886 46483 21155]
 [27941 76716 17902]
 [34858 51608 39546]]
Evaluating performance on  val set...
557/557 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8993591
{'0': {'precision': 0.40424681488883335, 'recall': 0.5216634429400386, 'f1-score': 0.45551020408163256, 'support': 31020}, '1': {'precision': 0.7245335117209183, 'recall': 0.6360819203038899, 'f1-score': 0.6774326626211009, 'support': 80029}, '2': {'precision': 0.455918062387149, 'recall': 0.46696639244946114, 'f1-score': 0.461376094764035, 'support': 31362}, 'accuracy': 0.5739163407321064, 'macro avg': {'precision': 0.5282327963323002, 'recall': 0.5415705852311299, 'f1-score': 0.5314396538222562, 'support': 142411}, 'weighted avg': {'precision': 0.5956136174870674, 'recall': 0.5739163407321064, 'f1-score': 0.5815131006137587, 'support': 142411}}
[[16182  9703  5135]
 [16782 50905 12342]
 [ 7066  9651 14645]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.94726753
{'0': {'precision': 0.45894129623345775, 'recall': 0.4864233051609423, 'f1-score': 0.47228284591881275, 'support': 38927}, '1': {'precision': 0.6049165558368013, 'recall': 0.6664670941719579, 'f1-score': 0.6342019250952052, 'support': 63469}, '2': {'precision': 0.5179978223275475, 'recall': 0.4042234162189179, 'f1-score': 0.4540924467652054, 'support': 40015}, 'accuracy': 0.5435675614945474, 'macro avg': {'precision': 0.5272852247992689, 'recall': 0.5190379385172728, 'f1-score': 0.5201924059264078, 'support': 142411}, 'weighted avg': {'precision': 0.5405926479086768, 'recall': 0.5435675614945474, 'f1-score': 0.5393349220513788, 'support': 142411}}
[[18935 13616  6376]
 [12494 42300  8675]
 [ 9829 14011 16175]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.98725784
{'0': {'precision': 0.4831651036819624, 'recall': 0.45969078484346265, 'f1-score': 0.4711357237592201, 'support': 44047}, '1': {'precision': 0.5106040040719375, 'recall': 0.6856394289185905, 'f1-score': 0.5853160453808752, 'support': 52672}, '2': {'precision': 0.5463460505104782, 'recall': 0.3560360675829467, 'f1-score': 0.4311231250331266, 'support': 45692}, 'accuracy': 0.5100027385524994, 'macro avg': {'precision': 0.5133717194214594, 'recall': 0.5004554271149999, 'f1-score': 0.4958582980577406, 'support': 142411}, 'weighted avg': {'precision': 0.5135849840551732, 'recall': 0.5100027385524994, 'f1-score': 0.5005284689787829, 'support': 142411}}
[[20248 16825  6974]
 [10024 36114  6534]
 [11635 17789 16268]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0294522
{'0': {'precision': 0.4640468426439435, 'recall': 0.42563968212383196, 'f1-score': 0.4440142569206418, 'support': 45804}, '1': {'precision': 0.44498352882799685, 'recall': 0.6719673632503539, 'f1-score': 0.535411915916912, 'support': 48044}, '2': {'precision': 0.5321937731173915, 'recall': 0.3051706031340733, 'f1-score': 0.38790734197094623, 'support': 48563}, 'accuracy': 0.4676605037532213, 'macro avg': {'precision': 0.4804080481964439, 'recall': 0.46759254950275303, 'f1-score': 0.45577783826949997, 'support': 142411}, 'weighted avg': {'precision': 0.48085412252828325, 'recall': 0.4676605037532213, 'f1-score': 0.4557155231017285, 'support': 142411}}
[[19496 19190  7118]
 [ 9851 32284  5909]
 [12666 21077 14820]]
training model: results/WBA/W0/deepVOL_L3/seq2seq
Epoch 1/50
1454/1454 - 65s - loss: 12.7944 - accuracy10: 0.4201 - accuracy20: 0.4261 - accuracy30: 0.4245 - accuracy50: 0.4138 - val_loss: 12.3507 - val_accuracy10: 0.4396 - val_accuracy20: 0.4546 - val_accuracy30: 0.4569 - val_accuracy50: 0.4388 - 65s/epoch - 44ms/step
Epoch 2/50
1454/1454 - 58s - loss: 12.2746 - accuracy10: 0.4636 - accuracy20: 0.4757 - accuracy30: 0.4750 - accuracy50: 0.4537 - val_loss: 12.0384 - val_accuracy10: 0.5340 - val_accuracy20: 0.5141 - val_accuracy30: 0.4917 - val_accuracy50: 0.4580 - 58s/epoch - 40ms/step
Epoch 3/50
1454/1454 - 60s - loss: 12.0244 - accuracy10: 0.4996 - accuracy20: 0.5011 - accuracy30: 0.4929 - accuracy50: 0.4674 - val_loss: 11.9128 - val_accuracy10: 0.5033 - val_accuracy20: 0.4997 - val_accuracy30: 0.4899 - val_accuracy50: 0.4624 - 60s/epoch - 41ms/step
Epoch 4/50
1454/1454 - 59s - loss: 11.9058 - accuracy10: 0.5110 - accuracy20: 0.5107 - accuracy30: 0.5005 - accuracy50: 0.4731 - val_loss: 11.9047 - val_accuracy10: 0.5409 - val_accuracy20: 0.5159 - val_accuracy30: 0.4892 - val_accuracy50: 0.4542 - 59s/epoch - 40ms/step
Epoch 5/50
1454/1454 - 58s - loss: 11.8424 - accuracy10: 0.5156 - accuracy20: 0.5149 - accuracy30: 0.5048 - accuracy50: 0.4772 - val_loss: 11.7530 - val_accuracy10: 0.5507 - val_accuracy20: 0.5272 - val_accuracy30: 0.5012 - val_accuracy50: 0.4671 - 58s/epoch - 40ms/step
Epoch 6/50
1454/1454 - 57s - loss: 11.7873 - accuracy10: 0.5192 - accuracy20: 0.5185 - accuracy30: 0.5076 - accuracy50: 0.4799 - val_loss: 11.7198 - val_accuracy10: 0.5489 - val_accuracy20: 0.5278 - val_accuracy30: 0.5031 - val_accuracy50: 0.4679 - 57s/epoch - 39ms/step
Epoch 7/50
1454/1454 - 58s - loss: 11.7475 - accuracy10: 0.5229 - accuracy20: 0.5214 - accuracy30: 0.5098 - accuracy50: 0.4815 - val_loss: 11.7123 - val_accuracy10: 0.5498 - val_accuracy20: 0.5275 - val_accuracy30: 0.5019 - val_accuracy50: 0.4667 - 58s/epoch - 40ms/step
Epoch 8/50
1454/1454 - 57s - loss: 11.7122 - accuracy10: 0.5246 - accuracy20: 0.5226 - accuracy30: 0.5119 - accuracy50: 0.4833 - val_loss: 11.7420 - val_accuracy10: 0.5565 - val_accuracy20: 0.5286 - val_accuracy30: 0.5018 - val_accuracy50: 0.4662 - 57s/epoch - 39ms/step
Epoch 9/50
1454/1454 - 57s - loss: 11.6785 - accuracy10: 0.5275 - accuracy20: 0.5253 - accuracy30: 0.5133 - accuracy50: 0.4850 - val_loss: 11.6704 - val_accuracy10: 0.5544 - val_accuracy20: 0.5319 - val_accuracy30: 0.5074 - val_accuracy50: 0.4718 - 57s/epoch - 39ms/step
Epoch 10/50
1454/1454 - 60s - loss: 11.6476 - accuracy10: 0.5292 - accuracy20: 0.5272 - accuracy30: 0.5156 - accuracy50: 0.4871 - val_loss: 11.6329 - val_accuracy10: 0.5495 - val_accuracy20: 0.5317 - val_accuracy30: 0.5085 - val_accuracy50: 0.4716 - 60s/epoch - 41ms/step
Epoch 11/50
1454/1454 - 60s - loss: 11.6208 - accuracy10: 0.5305 - accuracy20: 0.5285 - accuracy30: 0.5170 - accuracy50: 0.4886 - val_loss: 11.6384 - val_accuracy10: 0.5736 - val_accuracy20: 0.5417 - val_accuracy30: 0.5088 - val_accuracy50: 0.4700 - 60s/epoch - 41ms/step
Epoch 12/50
1454/1454 - 61s - loss: 11.6039 - accuracy10: 0.5316 - accuracy20: 0.5288 - accuracy30: 0.5173 - accuracy50: 0.4886 - val_loss: 11.6784 - val_accuracy10: 0.5652 - val_accuracy20: 0.5371 - val_accuracy30: 0.5068 - val_accuracy50: 0.4687 - 61s/epoch - 42ms/step
Epoch 13/50
1454/1454 - 58s - loss: 11.5781 - accuracy10: 0.5342 - accuracy20: 0.5306 - accuracy30: 0.5195 - accuracy50: 0.4908 - val_loss: 11.7319 - val_accuracy10: 0.5601 - val_accuracy20: 0.5304 - val_accuracy30: 0.5022 - val_accuracy50: 0.4655 - 58s/epoch - 40ms/step
Epoch 14/50
1454/1454 - 58s - loss: 11.5613 - accuracy10: 0.5344 - accuracy20: 0.5319 - accuracy30: 0.5207 - accuracy50: 0.4919 - val_loss: 11.7108 - val_accuracy10: 0.5421 - val_accuracy20: 0.5268 - val_accuracy30: 0.5053 - val_accuracy50: 0.4714 - 58s/epoch - 40ms/step
Epoch 15/50
1454/1454 - 57s - loss: 11.5451 - accuracy10: 0.5356 - accuracy20: 0.5324 - accuracy30: 0.5209 - accuracy50: 0.4923 - val_loss: 11.7652 - val_accuracy10: 0.5321 - val_accuracy20: 0.5179 - val_accuracy30: 0.4996 - val_accuracy50: 0.4673 - 57s/epoch - 39ms/step
Epoch 16/50
1454/1454 - 57s - loss: 11.5268 - accuracy10: 0.5364 - accuracy20: 0.5328 - accuracy30: 0.5220 - accuracy50: 0.4935 - val_loss: 11.7107 - val_accuracy10: 0.5538 - val_accuracy20: 0.5306 - val_accuracy30: 0.5063 - val_accuracy50: 0.4717 - 57s/epoch - 39ms/step
Epoch 17/50
1454/1454 - 59s - loss: 11.5056 - accuracy10: 0.5374 - accuracy20: 0.5340 - accuracy30: 0.5230 - accuracy50: 0.4943 - val_loss: 11.7141 - val_accuracy10: 0.5561 - val_accuracy20: 0.5309 - val_accuracy30: 0.5059 - val_accuracy50: 0.4707 - 59s/epoch - 40ms/step
Epoch 18/50
1454/1454 - 58s - loss: 11.4929 - accuracy10: 0.5377 - accuracy20: 0.5352 - accuracy30: 0.5244 - accuracy50: 0.4954 - val_loss: 11.7004 - val_accuracy10: 0.5530 - val_accuracy20: 0.5295 - val_accuracy30: 0.5058 - val_accuracy50: 0.4702 - 58s/epoch - 40ms/step
Epoch 19/50
1454/1454 - 58s - loss: 11.4774 - accuracy10: 0.5383 - accuracy20: 0.5354 - accuracy30: 0.5248 - accuracy50: 0.4964 - val_loss: 11.7107 - val_accuracy10: 0.5441 - val_accuracy20: 0.5244 - val_accuracy30: 0.5030 - val_accuracy50: 0.4688 - 58s/epoch - 40ms/step
Epoch 20/50
1454/1454 - 57s - loss: 11.4543 - accuracy10: 0.5394 - accuracy20: 0.5367 - accuracy30: 0.5262 - accuracy50: 0.4969 - val_loss: 11.7506 - val_accuracy10: 0.5534 - val_accuracy20: 0.5298 - val_accuracy30: 0.5058 - val_accuracy50: 0.4690 - 57s/epoch - 39ms/step
testing model: results/WBA/W0/deepVOL_L3/seq2seq
Evaluating performance on  test set...
5633/5633 - 90s - 90s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.76773906
{'0': {'precision': 0.3908262941814921, 'recall': 0.5751314001987822, 'f1-score': 0.4653961040215362, 'support': 230403}, '1': {'precision': 0.8306809039796058, 'recall': 0.7489611930492517, 'f1-score': 0.7877072433787269, 'support': 980211}, '2': {'precision': 0.4507732982643598, 'recall': 0.4269440359830464, 'f1-score': 0.4385351952502904, 'support': 231220}, 'accuracy': 0.6695430958071457, 'macro avg': {'precision': 0.5574268321418192, 'recall': 0.5836788764103601, 'f1-score': 0.5638795142168512, 'support': 1441834}, 'weighted avg': {'precision': 0.6994688100389761, 'recall': 0.6695430958071457, 'f1-score': 0.6802073408867814, 'support': 1441834}}
[[132512  68941  28950]
 [154742 734140  91329]
 [ 51802  80700  98718]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8180098
{'0': {'precision': 0.4523308658926942, 'recall': 0.5182286939744133, 'f1-score': 0.48304265615184455, 'support': 297498}, '1': {'precision': 0.7467330372949436, 'recall': 0.7791395662354249, 'f1-score': 0.7625921763396604, 'support': 845620}, '2': {'precision': 0.5133598869565615, 'recall': 0.3758084602096975, 'f1-score': 0.4339447963153734, 'support': 298716}, 'accuracy': 0.6417437791035584, 'macro avg': {'precision': 0.5708079300480664, 'recall': 0.5577255734731786, 'f1-score': 0.5598598762689595, 'support': 1441834}, 'weighted avg': {'precision': 0.6376384042343372, 'recall': 0.6417437791035584, 'f1-score': 0.6368234304728201, 'support': 1441834}}
[[154172 104608  38718]
 [119065 658856  67699]
 [ 67602 118854 112260]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8651751
{'0': {'precision': 0.48036864956334113, 'recall': 0.4800145104337625, 'f1-score': 0.4801915147045482, 'support': 341823}, '1': {'precision': 0.6802489244250867, 'recall': 0.7960250865911244, 'f1-score': 0.7335971573410739, 'support': 754985}, '2': {'precision': 0.5389423476118866, 'recall': 0.3386208575585608, 'f1-score': 0.4159178936576197, 'support': 345026}, 'accuracy': 0.6116515493461799, 'macro avg': {'precision': 0.5665199738667714, 'recall': 0.5382201515278159, 'f1-score': 0.5432355219010806, 'support': 1441834}, 'weighted avg': {'precision': 0.5990480939788511, 'recall': 0.6116515493461799, 'f1-score': 0.5975014052540842, 'support': 1441834}}
[[164080 133126  44617]
 [ 98666 600987  55332]
 [ 78825 149368 116833]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9184901
{'0': {'precision': 0.4607413381961004, 'recall': 0.4448149778244236, 'f1-score': 0.4526381065578006, 'support': 354444}, '1': {'precision': 0.632555903729473, 'recall': 0.7803004678367457, 'f1-score': 0.6987032476143944, 'support': 718413}, '2': {'precision': 0.5168415084968913, 'recall': 0.2989617239014898, 'f1-score': 0.37880660979931596, 'support': 368977}, 'accuracy': 0.5746500637382667, 'macro avg': {'precision': 0.5367129168074882, 'recall': 0.508025723187553, 'f1-score': 0.510049321323837, 'support': 1441834}, 'weighted avg': {'precision': 0.5607067225646211, 'recall': 0.5746500637382667, 'f1-score': 0.5563492633223348, 'support': 1441834}}
[[157662 149805  46977]
 [101691 560578  56144]
 [ 82839 175828 110310]]
Evaluating performance on  train set...
1454/1454 - 25s - 25s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.97951716
{'0': {'precision': 0.3831184127538963, 'recall': 0.588768348650637, 'f1-score': 0.46418575532149964, 'support': 85633}, '1': {'precision': 0.730130049744585, 'recall': 0.4888069174594167, 'f1-score': 0.5855801055550586, 'support': 200883}, '2': {'precision': 0.40498448244960333, 'recall': 0.5016651281272275, 'f1-score': 0.44817003152598284, 'support': 85579}, 'accuracy': 0.5147690777892743, 'macro avg': {'precision': 0.5060776483160282, 'recall': 0.5264134647457605, 'f1-score': 0.4993119641341804, 'support': 372095}, 'weighted avg': {'precision': 0.5754886812393353, 'recall': 0.5147690777892743, 'f1-score': 0.5260394529827729, 'support': 372095}}
[[50418 17004 18211]
 [57824 98193 44866]
 [23357 19290 42932]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.98557943
{'0': {'precision': 0.4425044157991657, 'recall': 0.5491218415677204, 'f1-score': 0.4900814957254285, 'support': 107213}, '1': {'precision': 0.6131922809352409, 'recall': 0.5149681205070237, 'f1-score': 0.5598042193626774, 'support': 157468}, '2': {'precision': 0.4641686796621913, 'recall': 0.4615413260841231, 'f1-score': 0.4628512743908132, 'support': 107414}, 'accuracy': 0.5093860438866419, 'macro avg': {'precision': 0.5066217921321993, 'recall': 0.5085437627196224, 'f1-score': 0.5042456631596397, 'support': 372095}, 'weighted avg': {'precision': 0.52099222666959, 'recall': 0.5093860438866419, 'f1-score': 0.5117270186463867, 'support': 372095}}
[[58873 24146 24194]
 [43341 81091 33036]
 [30831 27007 49576]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9967001
{'0': {'precision': 0.47076812645336885, 'recall': 0.5221339481191535, 'f1-score': 0.4951223827779416, 'support': 120584}, '1': {'precision': 0.5278349258598881, 'recall': 0.5318101906231527, 'f1-score': 0.5298151016271823, 'support': 130257}, '2': {'precision': 0.4898521229321483, 'recall': 0.4327362396292081, 'f1-score': 0.4595262074703332, 'support': 121254}, 'accuracy': 0.4963893629315094, 'macro avg': {'precision': 0.4961517250818018, 'recall': 0.49556012612383804, 'f1-score': 0.49482123062515243, 'support': 372095}, 'weighted avg': {'precision': 0.4969640199733917, 'recall': 0.4963893629315094, 'f1-score': 0.49566738026083385, 'support': 372095}}
[[62961 29266 28357]
 [34697 69272 26288]
 [36083 32700 52471]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0270488
{'0': {'precision': 0.45648170152091255, 'recall': 0.49761989572876525, 'f1-score': 0.47616391664730034, 'support': 123524}, '1': {'precision': 0.4752694724814321, 'recall': 0.5090691014123809, 'f1-score': 0.49158899123048916, 'support': 122559}, '2': {'precision': 0.4737104856636901, 'recall': 0.399096911405263, 'f1-score': 0.4332144579973813, 'support': 126012}, 'accuracy': 0.46802563861379487, 'macro avg': {'precision': 0.46848721988867825, 'recall': 0.468595302848803, 'f1-score': 0.4669891219583903, 'support': 372095}, 'weighted avg': {'precision': 0.4685045558149773, 'recall': 0.46802563861379487, 'f1-score': 0.4666994909830142, 'support': 372095}}
[[61468 32101 29955]
 [34250 62391 25918]
 [38938 36783 50291]]
Evaluating performance on  val set...
557/557 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.93254715
{'0': {'precision': 0.38225152349764696, 'recall': 0.568214055448098, 'f1-score': 0.45704061920628536, 'support': 31020}, '1': {'precision': 0.7429419300436214, 'recall': 0.5724799760086968, 'f1-score': 0.6466661020776875, 'support': 80029}, '2': {'precision': 0.4288684202927843, 'recall': 0.473598622536828, 'f1-score': 0.4501250094704144, 'support': 31362}, 'accuracy': 0.5497749471599807, 'macro avg': {'precision': 0.5180206246113509, 'recall': 0.5380975513312076, 'f1-score': 0.5179439102514624, 'support': 142411}, 'weighted avg': {'precision': 0.5952104358201283, 'recall': 0.5497749471599807, 'f1-score': 0.5620792076311898, 'support': 142411}}
[[17626  7619  5775]
 [20209 45815 14005]
 [ 8276  8233 14853]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.95621127
{'0': {'precision': 0.44172944503205475, 'recall': 0.5257019549413003, 'f1-score': 0.48007131630187444, 'support': 38927}, '1': {'precision': 0.6254317471230499, 'recall': 0.6019789188422695, 'f1-score': 0.6134812697699065, 'support': 63469}, '2': {'precision': 0.4892127446778111, 'recall': 0.4278395601649381, 'f1-score': 0.4564724703372883, 'support': 40015}, 'accuracy': 0.532199057657063, 'macro avg': {'precision': 0.5187913122776386, 'recall': 0.5185068113161693, 'f1-score': 0.516675018803023, 'support': 142411}, 'weighted avg': {'precision': 0.5369429162297733, 'recall': 0.532199057657063, 'f1-score': 0.5328979133722526, 'support': 142411}}
[[20464 10944  7519]
 [14906 38207 10356]
 [10957 11938 17120]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9810871
{'0': {'precision': 0.4683677863910422, 'recall': 0.49381342656707605, 'f1-score': 0.4807541414788865, 'support': 44047}, '1': {'precision': 0.5344601031503564, 'recall': 0.6177665552855407, 'f1-score': 0.5731017841731687, 'support': 52672}, '2': {'precision': 0.5153466898458207, 'recall': 0.39575855729668213, 'f1-score': 0.4477042868991471, 'support': 45692}, 'accuracy': 0.5081981026746529, 'macro avg': {'precision': 0.5060581931290731, 'recall': 0.502446179716433, 'f1-score': 0.5005200708504008, 'support': 142411}, 'weighted avg': {'precision': 0.507885622548378, 'recall': 0.5081981026746529, 'f1-score': 0.5043058410002421, 'support': 142411}}
[[21751 13536  8760]
 [11887 32539  8246]
 [12802 14807 18083]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0184851
{'0': {'precision': 0.45339374288720447, 'recall': 0.4609859400925683, 'f1-score': 0.45715832205683354, 'support': 45804}, '1': {'precision': 0.46986964007542836, 'recall': 0.5964324369328116, 'f1-score': 0.5256399673481367, 'support': 48044}, '2': {'precision': 0.5025964710945345, 'recall': 0.3607273026789943, 'f1-score': 0.42000527464096477, 'support': 48563}, 'accuracy': 0.4724915912394408, 'macro avg': {'precision': 0.4752866180190558, 'recall': 0.47271522656812476, 'f1-score': 0.4676011880153117, 'support': 142411}, 'weighted avg': {'precision': 0.47573050124465993, 'recall': 0.4724915912394408, 'f1-score': 0.4675919874669391, 'support': 142411}}
[[21115 15199  9490]
 [11542 28655  7847]
 [13914 17131 17518]]
training model: results/WBA/W1/deepLOB_L1/seq2seq
Epoch 1/50
2222/2222 - 56s - loss: 12.1044 - accuracy10: 0.4510 - accuracy20: 0.4703 - accuracy30: 0.4760 - accuracy50: 0.4682 - val_loss: 14.3802 - val_accuracy10: 0.4458 - val_accuracy20: 0.4127 - val_accuracy30: 0.3888 - val_accuracy50: 0.3540 - 56s/epoch - 25ms/step
Epoch 2/50
2222/2222 - 49s - loss: 11.9939 - accuracy10: 0.4504 - accuracy20: 0.4751 - accuracy30: 0.4823 - accuracy50: 0.4739 - val_loss: 12.9533 - val_accuracy10: 0.6085 - val_accuracy20: 0.5460 - val_accuracy30: 0.4923 - val_accuracy50: 0.4084 - 49s/epoch - 22ms/step
Epoch 3/50
2222/2222 - 55s - loss: 11.7063 - accuracy10: 0.4868 - accuracy20: 0.5021 - accuracy30: 0.5033 - accuracy50: 0.4883 - val_loss: 12.0758 - val_accuracy10: 0.5758 - val_accuracy20: 0.5506 - val_accuracy30: 0.5201 - val_accuracy50: 0.4640 - 55s/epoch - 25ms/step
Epoch 4/50
2222/2222 - 48s - loss: 11.4587 - accuracy10: 0.5220 - accuracy20: 0.5276 - accuracy30: 0.5212 - accuracy50: 0.5004 - val_loss: 11.9973 - val_accuracy10: 0.5843 - val_accuracy20: 0.5572 - val_accuracy30: 0.5266 - val_accuracy50: 0.4680 - 48s/epoch - 22ms/step
Epoch 5/50
2222/2222 - 52s - loss: 11.3093 - accuracy10: 0.5399 - accuracy20: 0.5408 - accuracy30: 0.5319 - accuracy50: 0.5091 - val_loss: 12.0688 - val_accuracy10: 0.6024 - val_accuracy20: 0.5655 - val_accuracy30: 0.5284 - val_accuracy50: 0.4643 - 52s/epoch - 23ms/step
Epoch 6/50
2222/2222 - 49s - loss: 11.2039 - accuracy10: 0.5490 - accuracy20: 0.5488 - accuracy30: 0.5384 - accuracy50: 0.5135 - val_loss: 11.8385 - val_accuracy10: 0.5977 - val_accuracy20: 0.5685 - val_accuracy30: 0.5353 - val_accuracy50: 0.4747 - 49s/epoch - 22ms/step
Epoch 7/50
2222/2222 - 51s - loss: 11.1060 - accuracy10: 0.5567 - accuracy20: 0.5555 - accuracy30: 0.5442 - accuracy50: 0.5187 - val_loss: 11.8535 - val_accuracy10: 0.6010 - val_accuracy20: 0.5708 - val_accuracy30: 0.5358 - val_accuracy50: 0.4719 - 51s/epoch - 23ms/step
Epoch 8/50
2222/2222 - 51s - loss: 11.0425 - accuracy10: 0.5611 - accuracy20: 0.5596 - accuracy30: 0.5473 - accuracy50: 0.5210 - val_loss: 11.9136 - val_accuracy10: 0.6019 - val_accuracy20: 0.5704 - val_accuracy30: 0.5341 - val_accuracy50: 0.4681 - 51s/epoch - 23ms/step
Epoch 9/50
2222/2222 - 48s - loss: 10.9908 - accuracy10: 0.5645 - accuracy20: 0.5630 - accuracy30: 0.5511 - accuracy50: 0.5238 - val_loss: 12.0196 - val_accuracy10: 0.6117 - val_accuracy20: 0.5743 - val_accuracy30: 0.5322 - val_accuracy50: 0.4604 - 48s/epoch - 22ms/step
Epoch 10/50
2222/2222 - 46s - loss: 10.9518 - accuracy10: 0.5668 - accuracy20: 0.5650 - accuracy30: 0.5529 - accuracy50: 0.5252 - val_loss: 12.0661 - val_accuracy10: 0.6160 - val_accuracy20: 0.5761 - val_accuracy30: 0.5328 - val_accuracy50: 0.4595 - 46s/epoch - 21ms/step
Epoch 11/50
2222/2222 - 55s - loss: 10.9149 - accuracy10: 0.5704 - accuracy20: 0.5678 - accuracy30: 0.5552 - accuracy50: 0.5263 - val_loss: 12.2703 - val_accuracy10: 0.6228 - val_accuracy20: 0.5764 - val_accuracy30: 0.5278 - val_accuracy50: 0.4477 - 55s/epoch - 25ms/step
Epoch 12/50
2222/2222 - 54s - loss: 10.8821 - accuracy10: 0.5721 - accuracy20: 0.5693 - accuracy30: 0.5565 - accuracy50: 0.5281 - val_loss: 12.0538 - val_accuracy10: 0.6179 - val_accuracy20: 0.5777 - val_accuracy30: 0.5339 - val_accuracy50: 0.4575 - 54s/epoch - 24ms/step
Epoch 13/50
2222/2222 - 52s - loss: 10.8556 - accuracy10: 0.5739 - accuracy20: 0.5707 - accuracy30: 0.5582 - accuracy50: 0.5297 - val_loss: 12.1088 - val_accuracy10: 0.6237 - val_accuracy20: 0.5782 - val_accuracy30: 0.5309 - val_accuracy50: 0.4529 - 52s/epoch - 24ms/step
Epoch 14/50
2222/2222 - 51s - loss: 10.8301 - accuracy10: 0.5753 - accuracy20: 0.5723 - accuracy30: 0.5596 - accuracy50: 0.5305 - val_loss: 12.0553 - val_accuracy10: 0.6204 - val_accuracy20: 0.5776 - val_accuracy30: 0.5326 - val_accuracy50: 0.4557 - 51s/epoch - 23ms/step
Epoch 15/50
2222/2222 - 49s - loss: 10.8102 - accuracy10: 0.5770 - accuracy20: 0.5732 - accuracy30: 0.5606 - accuracy50: 0.5316 - val_loss: 11.9690 - val_accuracy10: 0.6175 - val_accuracy20: 0.5793 - val_accuracy30: 0.5357 - val_accuracy50: 0.4616 - 49s/epoch - 22ms/step
Epoch 16/50
2222/2222 - 52s - loss: 10.7914 - accuracy10: 0.5776 - accuracy20: 0.5740 - accuracy30: 0.5611 - accuracy50: 0.5323 - val_loss: 12.0379 - val_accuracy10: 0.6162 - val_accuracy20: 0.5777 - val_accuracy30: 0.5349 - val_accuracy50: 0.4601 - 52s/epoch - 24ms/step
testing model: results/WBA/W1/deepLOB_L1/seq2seq
Evaluating performance on  test set...
5696/5696 - 61s - 61s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9438556
{'0': {'precision': 0.4068976470246124, 'recall': 0.5364333129852934, 'f1-score': 0.4627717356738536, 'support': 339099}, '1': {'precision': 0.6930508321050074, 'recall': 0.5336145855524108, 'f1-score': 0.602971319182898, 'support': 788616}, '2': {'precision': 0.4133930030858541, 'recall': 0.5053419676726943, 'f1-score': 0.4547662606748246, 'support': 330309}, 'accuracy': 0.5278651105880288, 'macro avg': {'precision': 0.5044471607384914, 'recall': 0.5251299554034662, 'f1-score': 0.5068364385105254, 'support': 1458024}, 'weighted avg': {'precision': 0.5631436723099257, 'recall': 0.5278651105880288, 'f1-score': 0.5367892788055951, 'support': 1458024}}
[[181904  97067  60128]
 [191068 420817 176731]
 [ 74079  89311 166919]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.991465
{'0': {'precision': 0.4673881650910894, 'recall': 0.4759353087746274, 'f1-score': 0.4716230155042228, 'support': 431836}, '1': {'precision': 0.5577896623487485, 'recall': 0.5719277867626614, 'f1-score': 0.5647702570534545, 'support': 607811}, '2': {'precision': 0.4765664154057215, 'recall': 0.4500223482648425, 'f1-score': 0.4629141767604933, 'support': 418377}, 'accuracy': 0.5085163207190005, 'macro avg': {'precision': 0.5005814142818531, 'recall': 0.4992951479340437, 'f1-score': 0.4997691497727235, 'support': 1458024}, 'weighted avg': {'precision': 0.5077077985687001, 'recall': 0.5085163207190005, 'f1-score': 0.5079546123820484, 'support': 1458024}}
[[205526 142183  84127]
 [137519 347624 122668]
 [ 96688 133410 188279]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0266166
{'0': {'precision': 0.49147262301013894, 'recall': 0.4225680901784077, 'f1-score': 0.4544231885599323, 'support': 485349}, '1': {'precision': 0.46239589551835897, 'recall': 0.6003007952449518, 'f1-score': 0.5224004670576241, 'support': 499343}, '2': {'precision': 0.5019722056597716, 'recall': 0.41620046817033285, 'f1-score': 0.4550801237257244, 'support': 473332}, 'accuracy': 0.4813706770258926, 'macro avg': {'precision': 0.4852802413960899, 'recall': 0.47968978453123073, 'f1-score': 0.47730125978109356, 'support': 1458024}, 'weighted avg': {'precision': 0.48492302445674623, 'recall': 0.4813706770258926, 'f1-score': 0.4779172645235431, 'support': 1458024}}
[[205093 179733 100523]
 [104657 299756  94930]
 [107553 168778 197001]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0761603
{'0': {'precision': 0.5057781513570238, 'recall': 0.3543111693032969, 'f1-score': 0.4167075300453369, 'support': 546847}, '1': {'precision': 0.3417671276815438, 'recall': 0.6266007524106949, 'f1-score': 0.4422937682197784, 'support': 372403}, '2': {'precision': 0.5136138550745333, 'recall': 0.37385991157702486, 'f1-score': 0.43273308498433855, 'support': 538774}, 'accuracy': 0.4310820672362046, 'macro avg': {'precision': 0.4537197113710336, 'recall': 0.4515906110970056, 'f1-score': 0.43057812774981796, 'support': 1458024}, 'weighted avg': {'precision': 0.46678254921664586, 'recall': 0.4310820672362046, 'f1-score': 0.4291644883612372, 'support': 1458024}}
[[193754 231151 121942]
 [ 70249 233348  68806]
 [119078 218270 201426]]
Evaluating performance on  train set...
2222/2222 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.85595727
{'0': {'precision': 0.39717110683878054, 'recall': 0.5423315644396107, 'f1-score': 0.4585371267310878, 'support': 106658}, '1': {'precision': 0.7790311760759806, 'recall': 0.6178576528997825, 'f1-score': 0.6891462856625278, 'support': 357113}, '2': {'precision': 0.3880528662101339, 'recall': 0.5172249351442088, 'f1-score': 0.4434232635723251, 'support': 104848}, 'accuracy': 0.5851352135612774, 'macro avg': {'precision': 0.5214183830416317, 'recall': 0.5591380508278673, 'f1-score': 0.5303688919886468, 'support': 568619}, 'weighted avg': {'precision': 0.6353115235537898, 'recall': 0.5851352135612774, 'f1-score': 0.6005810440975728, 'support': 568619}}
[[ 57844  32025  16789]
 [ 67738 220645  68730]
 [ 20058  30560  54230]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.90650773
{'0': {'precision': 0.4600619673582374, 'recall': 0.4784108011748031, 'f1-score': 0.4690570078830402, 'support': 136874}, '1': {'precision': 0.6689690264421837, 'recall': 0.6552252476747866, 'f1-score': 0.6620258138929576, 'support': 296962}, '2': {'precision': 0.45112793058888684, 'recall': 0.4532767485513752, 'f1-score': 0.4521997868308858, 'support': 134783}, 'accuracy': 0.5647947043626752, 'macro avg': {'precision': 0.5267196414631027, 'recall': 0.5289709324669883, 'f1-score': 0.5277608695356278, 'support': 568619}, 'weighted avg': {'precision': 0.5670462605348697, 'recall': 0.5647947043626752, 'f1-score': 0.5658394505120142, 'support': 568619}}
[[ 65482  48316  23076]
 [ 51130 194577  51255]
 [ 25721  47968  61094]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9504746
{'0': {'precision': 0.49220173892258506, 'recall': 0.420851615540355, 'f1-score': 0.4537388663758526, 'support': 156573}, '1': {'precision': 0.583577381919731, 'recall': 0.6834424790448003, 'f1-score': 0.6295743025055237, 'support': 257454}, '2': {'precision': 0.47685240782995075, 'recall': 0.4109656385841441, 'f1-score': 0.4414642281394186, 'support': 154592}, 'accuracy': 0.5370573266106128, 'macro avg': {'precision': 0.5175438428907556, 'recall': 0.5050865777230997, 'f1-score': 0.508259132340265, 'support': 568619}, 'weighted avg': {'precision': 0.5294008845718066, 'recall': 0.5370573266106128, 'f1-score': 0.5300148534587351, 'support': 568619}}
[[ 65894  62832  27847]
 [ 39646 175955  41853]
 [ 28336  62724  63532]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0157301
{'0': {'precision': 0.5188365468526172, 'recall': 0.3453432554469335, 'f1-score': 0.41467458891806, 'support': 182488}, '1': {'precision': 0.46408643828415447, 'recall': 0.7114589199370838, 'f1-score': 0.5617451233675883, 'support': 205988}, '2': {'precision': 0.49376175142920214, 'recall': 0.36006950034139545, 'f1-score': 0.4164489101473468, 'support': 180143}, 'accuracy': 0.4826377592025592, 'macro avg': {'precision': 0.49222824552199124, 'recall': 0.4722905585751376, 'f1-score': 0.4642895408109984, 'support': 568619}, 'weighted avg': {'precision': 0.49105887105254586, 'recall': 0.4826377592025592, 'f1-score': 0.4685145007032744, 'support': 568619}}
[[ 63021  84800  34667]
 [ 27600 146552  31836]
 [ 30845  84434  64864]]
Evaluating performance on  val set...
641/641 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8425559
{'0': {'precision': 0.39235258390768174, 'recall': 0.48778726198292843, 'f1-score': 0.4348958714455063, 'support': 30460}, '1': {'precision': 0.767984908861579, 'recall': 0.6613892413580958, 'f1-score': 0.7107123857925698, 'support': 104028}, '2': {'precision': 0.3891285828134876, 'recall': 0.4823052556285977, 'f1-score': 0.43073553568169376, 'support': 29359}, 'accuracy': 0.5970264942293725, 'macro avg': {'precision': 0.5164886918609161, 'recall': 0.5438272529898739, 'f1-score': 0.5254479309732566, 'support': 163847}, 'weighted avg': {'precision': 0.63026738278822, 'recall': 0.5970264942293725, 'f1-score': 0.6092688966263552, 'support': 163847}}
[[14858 10897  4705]
 [17701 68803 17524]
 [ 5310  9889 14160]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.90235233
{'0': {'precision': 0.4559960921598958, 'recall': 0.4265262089097601, 'f1-score': 0.4407691097004355, 'support': 39395}, '1': {'precision': 0.6564622523609255, 'recall': 0.6990256433993705, 'f1-score': 0.6770756858239696, 'support': 86416}, '2': {'precision': 0.4519568884187655, 'recall': 0.4156325586286676, 'f1-score': 0.43303430801890025, 'support': 38036}, 'accuracy': 0.5677186643637052, 'macro avg': {'precision': 0.5214717443131957, 'recall': 0.513728136979266, 'f1-score': 0.5169597011811018, 'support': 163847}, 'weighted avg': {'precision': 0.5607880538463139, 'recall': 0.5677186643637052, 'f1-score': 0.5636060744634915, 'support': 163847}}
[[16803 16240  6352]
 [13191 60407 12818]
 [ 6855 15372 15809]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9511772
{'0': {'precision': 0.4903214504685995, 'recall': 0.36967575777587003, 'f1-score': 0.42153614457831323, 'support': 45429}, '1': {'precision': 0.5717657920412937, 'recall': 0.731520382276748, 'f1-score': 0.6418518649377569, 'support': 74501}, '2': {'precision': 0.477522681525132, 'recall': 0.372725823712913, 'f1-score': 0.4186659164151619, 'support': 43917}, 'accuracy': 0.5350235280475077, 'macro avg': {'precision': 0.5132033080116751, 'recall': 0.491307321255177, 'f1-score': 0.49401797531041064, 'support': 163847}, 'weighted avg': {'precision': 0.5239235387327547, 'recall': 0.5350235280475077, 'f1-score': 0.5209440658234857, 'support': 163847}}
[[16794 20913  7722]
 [ 9814 54499 10188]
 [ 7643 19905 16369]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0202425
{'0': {'precision': 0.51818747339816, 'recall': 0.2986789960369881, 'f1-score': 0.37894005961715727, 'support': 52990}, '1': {'precision': 0.455014430377201, 'recall': 0.7631769805528851, 'f1-score': 0.5701181866290351, 'support': 59289}, '2': {'precision': 0.4970910486990934, 'recall': 0.326403971455166, 'f1-score': 0.394058223788175, 'support': 51568}, 'accuracy': 0.4754862768314342, 'macro avg': {'precision': 0.4900976508248181, 'recall': 0.462753316015013, 'f1-score': 0.4477054900114558, 'support': 163847}, 'weighted avg': {'precision': 0.48868820288023107, 'recall': 0.4754862768314342, 'f1-score': 0.4528771683977775, 'support': 163847}}
[[15827 27672  9491]
 [ 6503 45248  7538]
 [ 8213 26523 16832]]
training model: results/WBA/W1/deepOF_L1/seq2seq
Epoch 1/50
2222/2222 - 51s - loss: 12.6494 - accuracy10: 0.4275 - accuracy20: 0.4407 - accuracy30: 0.4428 - accuracy50: 0.4355 - val_loss: 14.7435 - val_accuracy10: 0.6300 - val_accuracy20: 0.5328 - val_accuracy30: 0.4630 - val_accuracy50: 0.3720 - 51s/epoch - 23ms/step
Epoch 2/50
2222/2222 - 49s - loss: 12.6381 - accuracy10: 0.4243 - accuracy20: 0.4373 - accuracy30: 0.4393 - accuracy50: 0.4301 - val_loss: 14.3919 - val_accuracy10: 0.6320 - val_accuracy20: 0.5365 - val_accuracy30: 0.4669 - val_accuracy50: 0.3751 - 49s/epoch - 22ms/step
Epoch 3/50
2222/2222 - 49s - loss: 12.5932 - accuracy10: 0.4361 - accuracy20: 0.4434 - accuracy30: 0.4431 - accuracy50: 0.4328 - val_loss: 14.2782 - val_accuracy10: 0.6303 - val_accuracy20: 0.5361 - val_accuracy30: 0.4676 - val_accuracy50: 0.3767 - 49s/epoch - 22ms/step
Epoch 4/50
2222/2222 - 50s - loss: 12.5415 - accuracy10: 0.4458 - accuracy20: 0.4490 - accuracy30: 0.4465 - accuracy50: 0.4350 - val_loss: 14.2796 - val_accuracy10: 0.6299 - val_accuracy20: 0.5361 - val_accuracy30: 0.4679 - val_accuracy50: 0.3775 - 50s/epoch - 23ms/step
Epoch 5/50
2222/2222 - 50s - loss: 12.4877 - accuracy10: 0.4512 - accuracy20: 0.4549 - accuracy30: 0.4520 - accuracy50: 0.4397 - val_loss: 14.2902 - val_accuracy10: 0.6274 - val_accuracy20: 0.5353 - val_accuracy30: 0.4686 - val_accuracy50: 0.3793 - 50s/epoch - 23ms/step
Epoch 6/50
2222/2222 - 48s - loss: 12.4291 - accuracy10: 0.4573 - accuracy20: 0.4600 - accuracy30: 0.4565 - accuracy50: 0.4441 - val_loss: 14.3083 - val_accuracy10: 0.6268 - val_accuracy20: 0.5347 - val_accuracy30: 0.4685 - val_accuracy50: 0.3806 - 48s/epoch - 21ms/step
Epoch 7/50
2222/2222 - 45s - loss: 12.3769 - accuracy10: 0.4607 - accuracy20: 0.4641 - accuracy30: 0.4602 - accuracy50: 0.4481 - val_loss: 14.1577 - val_accuracy10: 0.6254 - val_accuracy20: 0.5350 - val_accuracy30: 0.4701 - val_accuracy50: 0.3824 - 45s/epoch - 20ms/step
Epoch 8/50
2222/2222 - 45s - loss: 12.3265 - accuracy10: 0.4639 - accuracy20: 0.4671 - accuracy30: 0.4641 - accuracy50: 0.4518 - val_loss: 14.1698 - val_accuracy10: 0.6227 - val_accuracy20: 0.5341 - val_accuracy30: 0.4700 - val_accuracy50: 0.3828 - 45s/epoch - 20ms/step
Epoch 9/50
2222/2222 - 48s - loss: 12.2890 - accuracy10: 0.4650 - accuracy20: 0.4697 - accuracy30: 0.4657 - accuracy50: 0.4544 - val_loss: 14.1169 - val_accuracy10: 0.6235 - val_accuracy20: 0.5345 - val_accuracy30: 0.4709 - val_accuracy50: 0.3848 - 48s/epoch - 22ms/step
Epoch 10/50
2222/2222 - 46s - loss: 12.2504 - accuracy10: 0.4672 - accuracy20: 0.4721 - accuracy30: 0.4689 - accuracy50: 0.4571 - val_loss: 14.0819 - val_accuracy10: 0.6216 - val_accuracy20: 0.5343 - val_accuracy30: 0.4711 - val_accuracy50: 0.3859 - 46s/epoch - 21ms/step
Epoch 11/50
2222/2222 - 49s - loss: 12.2246 - accuracy10: 0.4687 - accuracy20: 0.4734 - accuracy30: 0.4704 - accuracy50: 0.4582 - val_loss: 13.8993 - val_accuracy10: 0.6179 - val_accuracy20: 0.5327 - val_accuracy30: 0.4710 - val_accuracy50: 0.3881 - 49s/epoch - 22ms/step
Epoch 12/50
2222/2222 - 48s - loss: 12.1906 - accuracy10: 0.4708 - accuracy20: 0.4757 - accuracy30: 0.4724 - accuracy50: 0.4608 - val_loss: 13.8172 - val_accuracy10: 0.6153 - val_accuracy20: 0.5318 - val_accuracy30: 0.4719 - val_accuracy50: 0.3905 - 48s/epoch - 22ms/step
Epoch 13/50
2222/2222 - 47s - loss: 12.1618 - accuracy10: 0.4736 - accuracy20: 0.4778 - accuracy30: 0.4747 - accuracy50: 0.4625 - val_loss: 13.8021 - val_accuracy10: 0.6129 - val_accuracy20: 0.5299 - val_accuracy30: 0.4715 - val_accuracy50: 0.3915 - 47s/epoch - 21ms/step
Epoch 14/50
2222/2222 - 45s - loss: 12.1385 - accuracy10: 0.4742 - accuracy20: 0.4786 - accuracy30: 0.4760 - accuracy50: 0.4649 - val_loss: 13.8495 - val_accuracy10: 0.6139 - val_accuracy20: 0.5310 - val_accuracy30: 0.4719 - val_accuracy50: 0.3922 - 45s/epoch - 20ms/step
Epoch 15/50
2222/2222 - 47s - loss: 12.1144 - accuracy10: 0.4759 - accuracy20: 0.4807 - accuracy30: 0.4782 - accuracy50: 0.4670 - val_loss: 13.7626 - val_accuracy10: 0.6101 - val_accuracy20: 0.5286 - val_accuracy30: 0.4721 - val_accuracy50: 0.3945 - 47s/epoch - 21ms/step
Epoch 16/50
2222/2222 - 47s - loss: 12.0898 - accuracy10: 0.4781 - accuracy20: 0.4835 - accuracy30: 0.4808 - accuracy50: 0.4689 - val_loss: 13.8726 - val_accuracy10: 0.6140 - val_accuracy20: 0.5308 - val_accuracy30: 0.4727 - val_accuracy50: 0.3941 - 47s/epoch - 21ms/step
Epoch 17/50
2222/2222 - 48s - loss: 12.0646 - accuracy10: 0.4803 - accuracy20: 0.4843 - accuracy30: 0.4815 - accuracy50: 0.4706 - val_loss: 13.7434 - val_accuracy10: 0.6110 - val_accuracy20: 0.5293 - val_accuracy30: 0.4729 - val_accuracy50: 0.3962 - 48s/epoch - 22ms/step
Epoch 18/50
2222/2222 - 46s - loss: 12.0452 - accuracy10: 0.4802 - accuracy20: 0.4846 - accuracy30: 0.4830 - accuracy50: 0.4724 - val_loss: 13.7114 - val_accuracy10: 0.6098 - val_accuracy20: 0.5288 - val_accuracy30: 0.4733 - val_accuracy50: 0.3978 - 46s/epoch - 21ms/step
Epoch 19/50
2222/2222 - 47s - loss: 12.0255 - accuracy10: 0.4818 - accuracy20: 0.4864 - accuracy30: 0.4847 - accuracy50: 0.4740 - val_loss: 13.7114 - val_accuracy10: 0.6097 - val_accuracy20: 0.5283 - val_accuracy30: 0.4734 - val_accuracy50: 0.3982 - 47s/epoch - 21ms/step
Epoch 20/50
2222/2222 - 48s - loss: 12.0068 - accuracy10: 0.4842 - accuracy20: 0.4880 - accuracy30: 0.4856 - accuracy50: 0.4742 - val_loss: 13.6070 - val_accuracy10: 0.6090 - val_accuracy20: 0.5284 - val_accuracy30: 0.4740 - val_accuracy50: 0.4011 - 48s/epoch - 21ms/step
Epoch 21/50
2222/2222 - 47s - loss: 11.9887 - accuracy10: 0.4855 - accuracy20: 0.4897 - accuracy30: 0.4874 - accuracy50: 0.4755 - val_loss: 13.7133 - val_accuracy10: 0.6107 - val_accuracy20: 0.5279 - val_accuracy30: 0.4732 - val_accuracy50: 0.3994 - 47s/epoch - 21ms/step
Epoch 22/50
2222/2222 - 49s - loss: 11.9688 - accuracy10: 0.4865 - accuracy20: 0.4906 - accuracy30: 0.4883 - accuracy50: 0.4772 - val_loss: 13.6834 - val_accuracy10: 0.6113 - val_accuracy20: 0.5280 - val_accuracy30: 0.4731 - val_accuracy50: 0.4004 - 49s/epoch - 22ms/step
Epoch 23/50
2222/2222 - 48s - loss: 11.9491 - accuracy10: 0.4883 - accuracy20: 0.4921 - accuracy30: 0.4906 - accuracy50: 0.4790 - val_loss: 13.5836 - val_accuracy10: 0.6061 - val_accuracy20: 0.5261 - val_accuracy30: 0.4734 - val_accuracy50: 0.4034 - 48s/epoch - 22ms/step
Epoch 24/50
2222/2222 - 47s - loss: 11.9298 - accuracy10: 0.4887 - accuracy20: 0.4930 - accuracy30: 0.4913 - accuracy50: 0.4796 - val_loss: 13.6329 - val_accuracy10: 0.6066 - val_accuracy20: 0.5248 - val_accuracy30: 0.4722 - val_accuracy50: 0.4022 - 47s/epoch - 21ms/step
Epoch 25/50
2222/2222 - 47s - loss: 11.9091 - accuracy10: 0.4897 - accuracy20: 0.4944 - accuracy30: 0.4930 - accuracy50: 0.4816 - val_loss: 13.5774 - val_accuracy10: 0.6073 - val_accuracy20: 0.5253 - val_accuracy30: 0.4735 - val_accuracy50: 0.4039 - 47s/epoch - 21ms/step
Epoch 26/50
2222/2222 - 46s - loss: 11.8916 - accuracy10: 0.4906 - accuracy20: 0.4952 - accuracy30: 0.4943 - accuracy50: 0.4829 - val_loss: 13.5983 - val_accuracy10: 0.6008 - val_accuracy20: 0.5216 - val_accuracy30: 0.4715 - val_accuracy50: 0.4044 - 46s/epoch - 21ms/step
Epoch 27/50
2222/2222 - 47s - loss: 11.8767 - accuracy10: 0.4923 - accuracy20: 0.4965 - accuracy30: 0.4952 - accuracy50: 0.4839 - val_loss: 13.5202 - val_accuracy10: 0.5922 - val_accuracy20: 0.5162 - val_accuracy30: 0.4695 - val_accuracy50: 0.4067 - 47s/epoch - 21ms/step
Epoch 28/50
2222/2222 - 49s - loss: 11.8591 - accuracy10: 0.4930 - accuracy20: 0.4972 - accuracy30: 0.4962 - accuracy50: 0.4851 - val_loss: 13.4661 - val_accuracy10: 0.6005 - val_accuracy20: 0.5221 - val_accuracy30: 0.4732 - val_accuracy50: 0.4088 - 49s/epoch - 22ms/step
Epoch 29/50
2222/2222 - 51s - loss: 11.8427 - accuracy10: 0.4941 - accuracy20: 0.4988 - accuracy30: 0.4977 - accuracy50: 0.4864 - val_loss: 13.4585 - val_accuracy10: 0.5947 - val_accuracy20: 0.5173 - val_accuracy30: 0.4701 - val_accuracy50: 0.4093 - 51s/epoch - 23ms/step
Epoch 30/50
2222/2222 - 47s - loss: 11.8279 - accuracy10: 0.4946 - accuracy20: 0.4991 - accuracy30: 0.4990 - accuracy50: 0.4872 - val_loss: 13.4792 - val_accuracy10: 0.5928 - val_accuracy20: 0.5163 - val_accuracy30: 0.4701 - val_accuracy50: 0.4082 - 47s/epoch - 21ms/step
Epoch 31/50
2222/2222 - 47s - loss: 11.8100 - accuracy10: 0.4967 - accuracy20: 0.5014 - accuracy30: 0.5000 - accuracy50: 0.4883 - val_loss: 13.5355 - val_accuracy10: 0.5995 - val_accuracy20: 0.5205 - val_accuracy30: 0.4718 - val_accuracy50: 0.4069 - 47s/epoch - 21ms/step
Epoch 32/50
2222/2222 - 50s - loss: 11.7928 - accuracy10: 0.4971 - accuracy20: 0.5023 - accuracy30: 0.5018 - accuracy50: 0.4906 - val_loss: 13.4897 - val_accuracy10: 0.5923 - val_accuracy20: 0.5170 - val_accuracy30: 0.4706 - val_accuracy50: 0.4083 - 50s/epoch - 22ms/step
Epoch 33/50
2222/2222 - 45s - loss: 11.7763 - accuracy10: 0.4981 - accuracy20: 0.5033 - accuracy30: 0.5027 - accuracy50: 0.4915 - val_loss: 13.4391 - val_accuracy10: 0.5934 - val_accuracy20: 0.5168 - val_accuracy30: 0.4689 - val_accuracy50: 0.4063 - 45s/epoch - 20ms/step
Epoch 34/50
2222/2222 - 45s - loss: 11.7605 - accuracy10: 0.4985 - accuracy20: 0.5043 - accuracy30: 0.5034 - accuracy50: 0.4926 - val_loss: 13.3665 - val_accuracy10: 0.5916 - val_accuracy20: 0.5167 - val_accuracy30: 0.4715 - val_accuracy50: 0.4111 - 45s/epoch - 20ms/step
Epoch 35/50
2222/2222 - 48s - loss: 11.7470 - accuracy10: 0.4986 - accuracy20: 0.5040 - accuracy30: 0.5039 - accuracy50: 0.4938 - val_loss: 13.4325 - val_accuracy10: 0.5928 - val_accuracy20: 0.5166 - val_accuracy30: 0.4711 - val_accuracy50: 0.4103 - 48s/epoch - 22ms/step
Epoch 36/50
2222/2222 - 47s - loss: 11.7281 - accuracy10: 0.4995 - accuracy20: 0.5054 - accuracy30: 0.5049 - accuracy50: 0.4948 - val_loss: 13.4623 - val_accuracy10: 0.5915 - val_accuracy20: 0.5159 - val_accuracy30: 0.4709 - val_accuracy50: 0.4112 - 47s/epoch - 21ms/step
Epoch 37/50
2222/2222 - 44s - loss: 11.7170 - accuracy10: 0.5001 - accuracy20: 0.5067 - accuracy30: 0.5059 - accuracy50: 0.4951 - val_loss: 13.4749 - val_accuracy10: 0.5895 - val_accuracy20: 0.5156 - val_accuracy30: 0.4703 - val_accuracy50: 0.4104 - 44s/epoch - 20ms/step
Epoch 38/50
2222/2222 - 50s - loss: 11.6985 - accuracy10: 0.5013 - accuracy20: 0.5076 - accuracy30: 0.5077 - accuracy50: 0.4967 - val_loss: 13.4353 - val_accuracy10: 0.5839 - val_accuracy20: 0.5115 - val_accuracy30: 0.4678 - val_accuracy50: 0.4107 - 50s/epoch - 23ms/step
Epoch 39/50
2222/2222 - 50s - loss: 11.6828 - accuracy10: 0.5011 - accuracy20: 0.5074 - accuracy30: 0.5084 - accuracy50: 0.4977 - val_loss: 13.4532 - val_accuracy10: 0.5881 - val_accuracy20: 0.5141 - val_accuracy30: 0.4692 - val_accuracy50: 0.4102 - 50s/epoch - 22ms/step
Epoch 40/50
2222/2222 - 49s - loss: 11.6754 - accuracy10: 0.5012 - accuracy20: 0.5080 - accuracy30: 0.5088 - accuracy50: 0.4986 - val_loss: 13.4784 - val_accuracy10: 0.5927 - val_accuracy20: 0.5163 - val_accuracy30: 0.4701 - val_accuracy50: 0.4091 - 49s/epoch - 22ms/step
Epoch 41/50
2222/2222 - 47s - loss: 11.6628 - accuracy10: 0.5029 - accuracy20: 0.5099 - accuracy30: 0.5099 - accuracy50: 0.4998 - val_loss: 13.3688 - val_accuracy10: 0.5797 - val_accuracy20: 0.5105 - val_accuracy30: 0.4699 - val_accuracy50: 0.4144 - 47s/epoch - 21ms/step
Epoch 42/50
2222/2222 - 47s - loss: 11.6412 - accuracy10: 0.5029 - accuracy20: 0.5101 - accuracy30: 0.5102 - accuracy50: 0.5008 - val_loss: 13.3869 - val_accuracy10: 0.5852 - val_accuracy20: 0.5107 - val_accuracy30: 0.4673 - val_accuracy50: 0.4111 - 47s/epoch - 21ms/step
Epoch 43/50
2222/2222 - 49s - loss: 11.6298 - accuracy10: 0.5033 - accuracy20: 0.5109 - accuracy30: 0.5123 - accuracy50: 0.5018 - val_loss: 13.3856 - val_accuracy10: 0.5862 - val_accuracy20: 0.5129 - val_accuracy30: 0.4701 - val_accuracy50: 0.4124 - 49s/epoch - 22ms/step
Epoch 44/50
2222/2222 - 47s - loss: 11.6102 - accuracy10: 0.5048 - accuracy20: 0.5122 - accuracy30: 0.5129 - accuracy50: 0.5032 - val_loss: 13.4039 - val_accuracy10: 0.5861 - val_accuracy20: 0.5134 - val_accuracy30: 0.4704 - val_accuracy50: 0.4138 - 47s/epoch - 21ms/step
testing model: results/WBA/W1/deepOF_L1/seq2seq
Evaluating performance on  test set...
5696/5696 - 50s - 50s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0142487
{'0': {'precision': 0.38958882182278987, 'recall': 0.17225993665548012, 'f1-score': 0.2388918539239683, 'support': 339098}, '1': {'precision': 0.5738098750342444, 'recall': 0.7250800453960424, 'f1-score': 0.6406364137473615, 'support': 788615}, '2': {'precision': 0.3471857136896566, 'recall': 0.32749329409698885, 'f1-score': 0.33705211434589494, 'support': 330306}, 'accuracy': 0.5064371589121952, 'macro avg': {'precision': 0.43686147018223026, 'recall': 0.4082777587161705, 'f1-score': 0.4055267940057416, 'support': 1458019}, 'weighted avg': {'precision': 0.47962433222651474, 'recall': 0.5064371589121952, 'f1-score': 0.4784255698934105, 'support': 1458019}}
[[ 58413 227169  53516]
 [ 66924 571809 149882]
 [ 24598 197535 108173]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.101015
{'0': {'precision': 0.43223835636780195, 'recall': 0.18873456003927436, 'f1-score': 0.26274355568737184, 'support': 431834}, '1': {'precision': 0.4511945272062861, 'recall': 0.6732059801484342, 'f1-score': 0.5402823138885202, 'support': 607811}, '2': {'precision': 0.3919133972281597, 'recall': 0.33964347688909924, 'f1-score': 0.3639110876638552, 'support': 418374}, 'accuracy': 0.43400120300215567, 'macro avg': {'precision': 0.4251154269340826, 'recall': 0.4005280056922693, 'f1-score': 0.3889789857465824, 'support': 1458019}, 'weighted avg': {'precision': 0.4285695802396591, 'recall': 0.43400120300215567, 'f1-score': 0.40747210530443956, 'support': 1458019}}
[[ 81502 263132  87200]
 [ 65352 409182 133277]
 [ 41704 234572 142098]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1385045
{'0': {'precision': 0.4506639797447424, 'recall': 0.17970029690098013, 'f1-score': 0.2569449252220947, 'support': 485347}, '1': {'precision': 0.3730327324088745, 'recall': 0.6643048966341774, 'f1-score': 0.47777592137025926, 'support': 499343}, '2': {'precision': 0.41731335010446424, 'recall': 0.3308396485319936, 'f1-score': 0.36907905823513953, 'support': 473329}, 'accuracy': 0.394733539137693, 'macro avg': {'precision': 0.4136700207526937, 'recall': 0.39161494735571706, 'f1-score': 0.36793330160916454, 'support': 1458019}, 'weighted avg': {'precision': 0.4132498993277949, 'recall': 0.394733539137693, 'f1-score': 0.3689782726301493, 'support': 1458019}}
[[ 87217 291616 106514]
 [ 55489 331716 112138]
 [ 50824 265909 156596]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1789917
{'0': {'precision': 0.4628878412454775, 'recall': 0.16213399068107176, 'f1-score': 0.2401511406651002, 'support': 546844}, '1': {'precision': 0.2782801677939371, 'recall': 0.6713963099115743, 'f1-score': 0.39347352949045, 'support': 372403}, '2': {'precision': 0.4469517248875664, 'recall': 0.3052794131840556, 'f1-score': 0.36277456060928553, 'support': 538772}, 'accuracy': 0.3451038703885203, 'macro avg': {'precision': 0.39603991130899363, 'recall': 0.37960323792556716, 'f1-score': 0.3321330769216119, 'support': 1458019}, 'weighted avg': {'precision': 0.4098471163312216, 'recall': 0.3451038703885203, 'f1-score': 0.3246245136293039, 'support': 1458019}}
[[ 88662 335155 123027]
 [ 41881 250030  80492]
 [ 60998 313298 164476]]
Evaluating performance on  train set...
2222/2222 - 22s - 22s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9117883
{'0': {'precision': 0.40390109162457194, 'recall': 0.2002513811895583, 'f1-score': 0.26775277798680613, 'support': 106611}, '1': {'precision': 0.6768594859832467, 'recall': 0.7771819526627219, 'f1-score': 0.7235598147527451, 'support': 356928}, '2': {'precision': 0.33611819125837816, 'recall': 0.3388403011067863, 'f1-score': 0.33747375704353844, 'support': 105079}, 'accuracy': 0.588008117928029, 'macro avg': {'precision': 0.47229292295539893, 'recall': 0.4387578783196888, 'f1-score': 0.44292878326102986, 'support': 568618}, 'weighted avg': {'precision': 0.5627140985889554, 'recall': 0.588008117928029, 'f1-score': 0.5667522904487673, 'support': 568618}}
[[ 21349  69102  16160]
 [ 25365 277398  54165]
 [  6143  63331  35605]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9888106
{'0': {'precision': 0.4555896951075396, 'recall': 0.21130249859321676, 'f1-score': 0.2887040568741201, 'support': 136837}, '1': {'precision': 0.5780868070747216, 'recall': 0.7436663959206096, 'f1-score': 0.6505053006450396, 'support': 296711}, '2': {'precision': 0.3828003499222395, 'recall': 0.3498852446879396, 'f1-score': 0.3656034596133464, 'support': 135070}, 'accuracy': 0.5220147796939245, 'macro avg': {'precision': 0.4721589507015002, 'recall': 0.43495137973392195, 'f1-score': 0.4349376057108354, 'support': 568618}, 'weighted avg': {'precision': 0.502219565661613, 'recall': 0.5220147796939245, 'f1-score': 0.4957625938330285, 'support': 568618}}
[[ 28914  82804  25119]
 [ 24979 220654  51078]
 [  9572  78239  47259]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0341393
{'0': {'precision': 0.48415395070117995, 'recall': 0.20020181119158012, 'f1-score': 0.28326932634527624, 'support': 156582}, '1': {'precision': 0.5062396084116998, 'recall': 0.7398114491204199, 'f1-score': 0.6011340482997173, 'support': 257225}, '2': {'precision': 0.40878365177978354, 'recall': 0.3378958859512567, 'f1-score': 0.36997482105977875, 'support': 154811}, 'accuracy': 0.48179269738207375, 'macro avg': {'precision': 0.46639240363088774, 'recall': 0.4259697154210855, 'f1-score': 0.4181260652349241, 'support': 568618}, 'weighted avg': {'precision': 0.47362461810577866, 'recall': 0.48179269738207375, 'f1-score': 0.45066768068329927, 'support': 568618}}
[[ 31348  94855  30379]
 [ 21651 190298  45276]
 [ 11749  90752  52310]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0916066
{'0': {'precision': 0.5080913219206942, 'recall': 0.1784827404739586, 'f1-score': 0.26416824204266093, 'support': 182421}, '1': {'precision': 0.4060260560516685, 'recall': 0.7464647886640227, 'f1-score': 0.5259636647221495, 'support': 205999}, '2': {'precision': 0.4365616182490164, 'recall': 0.30480915437463235, 'f1-score': 0.3589782133438776, 'support': 180198}, 'accuracy': 0.4242848450101826, 'macro avg': {'precision': 0.450226332073793, 'recall': 0.40991889450420455, 'f1-score': 0.3830367067028961, 'support': 568618}, 'weighted avg': {'precision': 0.4484469697440441, 'recall': 0.4242848450101826, 'f1-score': 0.38905729318963234, 'support': 568618}}
[[ 32559 114156  35706]
 [ 17045 153771  35183]
 [ 14477 110795  54926]]
Evaluating performance on  val set...
641/641 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.91229266
{'0': {'precision': 0.41135258793251356, 'recall': 0.18837780324111966, 'f1-score': 0.2584151078975142, 'support': 30545}, '1': {'precision': 0.6763551055685887, 'recall': 0.7899305889365302, 'f1-score': 0.7287441852214827, 'support': 104018}, '2': {'precision': 0.3204454939555211, 'recall': 0.31048731345832054, 'f1-score': 0.3153878173997502, 'support': 29283}, 'accuracy': 0.5920986780269277, 'macro avg': {'precision': 0.4693843958188744, 'recall': 0.42959856854532347, 'f1-score': 0.4341823701729157, 'support': 163846}, 'weighted avg': {'precision': 0.5633428681135433, 'recall': 0.5920986780269277, 'f1-score': 0.5671868924844955, 'support': 163846}}
[[ 5754 20698  4093]
 [ 6663 82167 15188]
 [ 1571 18620  9092]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9997706
{'0': {'precision': 0.44905268022181144, 'recall': 0.19693975781527082, 'f1-score': 0.27379988025217483, 'support': 39474}, '1': {'precision': 0.5725943346182409, 'recall': 0.7498118668596238, 'f1-score': 0.6493285142092309, 'support': 86375}, '2': {'precision': 0.3619039071381559, 'recall': 0.3183672395189094, 'f1-score': 0.3387424219089089, 'support': 37997}, 'accuracy': 0.5165582315100765, 'macro avg': {'precision': 0.4611836406594028, 'recall': 0.42170628806460136, 'f1-score': 0.4206236054567715, 'support': 163846}, 'weighted avg': {'precision': 0.4939699712611529, 'recall': 0.5165582315100765, 'f1-score': 0.4868286237880051, 'support': 163846}}
[[ 7774 25167  6533]
 [ 6814 64765 14796]
 [ 2724 23176 12097]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.049333
{'0': {'precision': 0.4705915588451325, 'recall': 0.18322810568229317, 'f1-score': 0.26375957945405026, 'support': 45457}, '1': {'precision': 0.49636842954753324, 'recall': 0.7431931690027388, 'f1-score': 0.5952066062385084, 'support': 74484}, '2': {'precision': 0.3867725631768953, 'recall': 0.30502220703792277, 'f1-score': 0.3410671081115497, 'support': 43905}, 'accuracy': 0.4704234464069919, 'macro avg': {'precision': 0.4512441838565204, 'recall': 0.4104811605743182, 'f1-score': 0.40001109793470285, 'support': 163846}, 'weighted avg': {'precision': 0.459849102102726, 'recall': 0.4704234464069919, 'f1-score': 0.43515032069107223, 'support': 163846}}
[[ 8329 29054  8074]
 [ 5969 55356 13159]
 [ 3401 27112 13392]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1073197
{'0': {'precision': 0.4909111826967326, 'recall': 0.16095509326493276, 'f1-score': 0.2424259640650522, 'support': 53021}, '1': {'precision': 0.39532053616635726, 'recall': 0.7504510733015193, 'f1-score': 0.5178496625552712, 'support': 59303}, '2': {'precision': 0.4180315773941272, 'recall': 0.2749310973952874, 'f1-score': 0.3317058320746543, 'support': 51522}, 'accuracy': 0.41015954005590616, 'macro avg': {'precision': 0.43475443208573905, 'recall': 0.3954457546539132, 'f1-score': 0.36399381956499255, 'support': 163846}, 'weighted avg': {'precision': 0.43339549640843955, 'recall': 0.41015954005590616, 'f1-score': 0.3701881856094059, 'support': 163846}}
[[ 8534 34904  9583]
 [ 4662 44504 10137]
 [ 4188 33169 14165]]
training model: results/WBA/W1/deepLOB_L2/seq2seq
Epoch 1/50
2222/2222 - 108s - loss: 12.2074 - accuracy10: 0.4419 - accuracy20: 0.4616 - accuracy30: 0.4677 - accuracy50: 0.4629 - val_loss: 13.1342 - val_accuracy10: 0.5994 - val_accuracy20: 0.5268 - val_accuracy30: 0.4709 - val_accuracy50: 0.3903 - 108s/epoch - 49ms/step
Epoch 2/50
2222/2222 - 100s - loss: 11.7875 - accuracy10: 0.4831 - accuracy20: 0.4975 - accuracy30: 0.4986 - accuracy50: 0.4866 - val_loss: 12.5571 - val_accuracy10: 0.5658 - val_accuracy20: 0.5354 - val_accuracy30: 0.5063 - val_accuracy50: 0.4581 - 100s/epoch - 45ms/step
Epoch 3/50
2222/2222 - 101s - loss: 11.3134 - accuracy10: 0.5485 - accuracy20: 0.5478 - accuracy30: 0.5377 - accuracy50: 0.5123 - val_loss: 11.9323 - val_accuracy10: 0.5717 - val_accuracy20: 0.5538 - val_accuracy30: 0.5324 - val_accuracy50: 0.4884 - 101s/epoch - 46ms/step
Epoch 4/50
2222/2222 - 104s - loss: 11.0418 - accuracy10: 0.5737 - accuracy20: 0.5670 - accuracy30: 0.5539 - accuracy50: 0.5231 - val_loss: 11.5383 - val_accuracy10: 0.6050 - val_accuracy20: 0.5800 - val_accuracy30: 0.5533 - val_accuracy50: 0.5006 - 104s/epoch - 47ms/step
Epoch 5/50
2222/2222 - 100s - loss: 10.8533 - accuracy10: 0.5838 - accuracy20: 0.5759 - accuracy30: 0.5616 - accuracy50: 0.5295 - val_loss: 11.3137 - val_accuracy10: 0.5979 - val_accuracy20: 0.5810 - val_accuracy30: 0.5583 - val_accuracy50: 0.5076 - 100s/epoch - 45ms/step
Epoch 6/50
2222/2222 - 100s - loss: 10.7394 - accuracy10: 0.5900 - accuracy20: 0.5802 - accuracy30: 0.5653 - accuracy50: 0.5328 - val_loss: 11.2684 - val_accuracy10: 0.5947 - val_accuracy20: 0.5797 - val_accuracy30: 0.5595 - val_accuracy50: 0.5123 - 100s/epoch - 45ms/step
Epoch 7/50
2222/2222 - 102s - loss: 10.6542 - accuracy10: 0.5945 - accuracy20: 0.5849 - accuracy30: 0.5694 - accuracy50: 0.5365 - val_loss: 11.1943 - val_accuracy10: 0.5984 - val_accuracy20: 0.5842 - val_accuracy30: 0.5627 - val_accuracy50: 0.5147 - 102s/epoch - 46ms/step
Epoch 8/50
2222/2222 - 101s - loss: 10.5928 - accuracy10: 0.5974 - accuracy20: 0.5889 - accuracy30: 0.5730 - accuracy50: 0.5388 - val_loss: 11.1503 - val_accuracy10: 0.5998 - val_accuracy20: 0.5854 - val_accuracy30: 0.5639 - val_accuracy50: 0.5146 - 101s/epoch - 46ms/step
Epoch 9/50
2222/2222 - 101s - loss: 10.5472 - accuracy10: 0.5993 - accuracy20: 0.5906 - accuracy30: 0.5749 - accuracy50: 0.5408 - val_loss: 11.1900 - val_accuracy10: 0.5813 - val_accuracy20: 0.5764 - val_accuracy30: 0.5612 - val_accuracy50: 0.5200 - 101s/epoch - 45ms/step
Epoch 10/50
2222/2222 - 101s - loss: 10.5064 - accuracy10: 0.6008 - accuracy20: 0.5932 - accuracy30: 0.5772 - accuracy50: 0.5429 - val_loss: 11.1070 - val_accuracy10: 0.5952 - val_accuracy20: 0.5863 - val_accuracy30: 0.5682 - val_accuracy50: 0.5207 - 101s/epoch - 45ms/step
Epoch 11/50
2222/2222 - 102s - loss: 10.4770 - accuracy10: 0.6020 - accuracy20: 0.5941 - accuracy30: 0.5782 - accuracy50: 0.5435 - val_loss: 11.1912 - val_accuracy10: 0.5994 - val_accuracy20: 0.5878 - val_accuracy30: 0.5668 - val_accuracy50: 0.5168 - 102s/epoch - 46ms/step
Epoch 12/50
2222/2222 - 104s - loss: 10.4485 - accuracy10: 0.6027 - accuracy20: 0.5956 - accuracy30: 0.5796 - accuracy50: 0.5453 - val_loss: 11.1620 - val_accuracy10: 0.5971 - val_accuracy20: 0.5859 - val_accuracy30: 0.5664 - val_accuracy50: 0.5191 - 104s/epoch - 47ms/step
Epoch 13/50
2222/2222 - 103s - loss: 10.4242 - accuracy10: 0.6042 - accuracy20: 0.5966 - accuracy30: 0.5811 - accuracy50: 0.5464 - val_loss: 11.0937 - val_accuracy10: 0.5958 - val_accuracy20: 0.5856 - val_accuracy30: 0.5659 - val_accuracy50: 0.5210 - 103s/epoch - 46ms/step
Epoch 14/50
2222/2222 - 101s - loss: 10.4019 - accuracy10: 0.6053 - accuracy20: 0.5979 - accuracy30: 0.5817 - accuracy50: 0.5473 - val_loss: 11.0793 - val_accuracy10: 0.5951 - val_accuracy20: 0.5861 - val_accuracy30: 0.5664 - val_accuracy50: 0.5204 - 101s/epoch - 45ms/step
Epoch 15/50
2222/2222 - 103s - loss: 10.3791 - accuracy10: 0.6053 - accuracy20: 0.5987 - accuracy30: 0.5835 - accuracy50: 0.5484 - val_loss: 11.1837 - val_accuracy10: 0.6032 - val_accuracy20: 0.5896 - val_accuracy30: 0.5678 - val_accuracy50: 0.5178 - 103s/epoch - 46ms/step
Epoch 16/50
2222/2222 - 101s - loss: 10.3590 - accuracy10: 0.6062 - accuracy20: 0.5999 - accuracy30: 0.5842 - accuracy50: 0.5495 - val_loss: 11.1171 - val_accuracy10: 0.6094 - val_accuracy20: 0.5928 - val_accuracy30: 0.5685 - val_accuracy50: 0.5176 - 101s/epoch - 46ms/step
Epoch 17/50
2222/2222 - 101s - loss: 10.3445 - accuracy10: 0.6064 - accuracy20: 0.6003 - accuracy30: 0.5853 - accuracy50: 0.5500 - val_loss: 11.1257 - val_accuracy10: 0.5957 - val_accuracy20: 0.5848 - val_accuracy30: 0.5655 - val_accuracy50: 0.5196 - 101s/epoch - 46ms/step
Epoch 18/50
2222/2222 - 100s - loss: 10.3257 - accuracy10: 0.6071 - accuracy20: 0.6013 - accuracy30: 0.5862 - accuracy50: 0.5515 - val_loss: 11.1345 - val_accuracy10: 0.5961 - val_accuracy20: 0.5857 - val_accuracy30: 0.5659 - val_accuracy50: 0.5196 - 100s/epoch - 45ms/step
Epoch 19/50
2222/2222 - 103s - loss: 10.3115 - accuracy10: 0.6075 - accuracy20: 0.6022 - accuracy30: 0.5870 - accuracy50: 0.5525 - val_loss: 11.1233 - val_accuracy10: 0.5963 - val_accuracy20: 0.5853 - val_accuracy30: 0.5652 - val_accuracy50: 0.5192 - 103s/epoch - 47ms/step
Epoch 20/50
2222/2222 - 100s - loss: 10.2917 - accuracy10: 0.6081 - accuracy20: 0.6031 - accuracy30: 0.5880 - accuracy50: 0.5535 - val_loss: 11.1943 - val_accuracy10: 0.6072 - val_accuracy20: 0.5912 - val_accuracy30: 0.5672 - val_accuracy50: 0.5162 - 100s/epoch - 45ms/step
Epoch 21/50
2222/2222 - 101s - loss: 10.2774 - accuracy10: 0.6085 - accuracy20: 0.6036 - accuracy30: 0.5887 - accuracy50: 0.5546 - val_loss: 11.2012 - val_accuracy10: 0.5956 - val_accuracy20: 0.5847 - val_accuracy30: 0.5639 - val_accuracy50: 0.5168 - 101s/epoch - 45ms/step
Epoch 22/50
2222/2222 - 103s - loss: 10.2598 - accuracy10: 0.6090 - accuracy20: 0.6045 - accuracy30: 0.5896 - accuracy50: 0.5557 - val_loss: 11.1836 - val_accuracy10: 0.5996 - val_accuracy20: 0.5861 - val_accuracy30: 0.5644 - val_accuracy50: 0.5155 - 103s/epoch - 46ms/step
Epoch 23/50
2222/2222 - 102s - loss: 10.2463 - accuracy10: 0.6090 - accuracy20: 0.6048 - accuracy30: 0.5899 - accuracy50: 0.5562 - val_loss: 11.2242 - val_accuracy10: 0.6076 - val_accuracy20: 0.5921 - val_accuracy30: 0.5681 - val_accuracy50: 0.5153 - 102s/epoch - 46ms/step
Epoch 24/50
2222/2222 - 102s - loss: 10.2304 - accuracy10: 0.6100 - accuracy20: 0.6063 - accuracy30: 0.5921 - accuracy50: 0.5573 - val_loss: 11.2012 - val_accuracy10: 0.6003 - val_accuracy20: 0.5879 - val_accuracy30: 0.5663 - val_accuracy50: 0.5181 - 102s/epoch - 46ms/step
testing model: results/WBA/W1/deepLOB_L2/seq2seq
Evaluating performance on  test set...
5696/5696 - 88s - 88s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9983471
{'0': {'precision': 0.3922682862969904, 'recall': 0.6715708391944535, 'f1-score': 0.49525522403802347, 'support': 339099}, '1': {'precision': 0.7730587337909992, 'recall': 0.44979812735222213, 'f1-score': 0.5687016720295383, 'support': 788616}, '2': {'precision': 0.42561689319924517, 'recall': 0.5394221774156925, 'f1-score': 0.4758091112894374, 'support': 330309}, 'accuracy': 0.5216807130746819, 'macro avg': {'precision': 0.5303146377624116, 'recall': 0.553597047987456, 'f1-score': 0.5132553357856663, 'support': 1458024}, 'weighted avg': {'precision': 0.6057851999679671, 'recall': 0.5216807130746819, 'f1-score': 0.5305755054417616, 'support': 1458024}}
[[227729  52250  59120]
 [252564 354718 181334]
 [100251  51882 178176]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9878635
{'0': {'precision': 0.4577178774326121, 'recall': 0.6138186719032225, 'f1-score': 0.5243979401471492, 'support': 431836}, '1': {'precision': 0.6450666717715399, 'recall': 0.49895608996875673, 'f1-score': 0.5626810148893733, 'support': 607811}, '2': {'precision': 0.4891517338389089, 'recall': 0.47792541176976744, 'f1-score': 0.48347341238369723, 'support': 418377}, 'accuracy': 0.52694125748273, 'macro avg': {'precision': 0.5306454276810203, 'recall': 0.5302333912139156, 'f1-score': 0.5235174558067399, 'support': 1458024}, 'weighted avg': {'precision': 0.544838432771643, 'recall': 0.52694125748273, 'f1-score': 0.5286139151860074, 'support': 1458024}}
[[265069  83852  82915]
 [178633 303271 125907]
 [135408  83016 199953]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9957411
{'0': {'precision': 0.48247243402985907, 'recall': 0.5704946337583883, 'f1-score': 0.5228044503396287, 'support': 485349}, '1': {'precision': 0.5462825564140613, 'recall': 0.5345023360695954, 'f1-score': 0.5403282458665598, 'support': 499343}, '2': {'precision': 0.5164213139579272, 'recall': 0.43156177904726495, 'f1-score': 0.4701934087940291, 'support': 473332}, 'accuracy': 0.5130649426895579, 'macro avg': {'precision': 0.5150587681339492, 'recall': 0.5121862496250829, 'f1-score': 0.5111087016667393, 'support': 1458024}, 'weighted avg': {'precision': 0.5153472215339105, 'recall': 0.5130649426895579, 'f1-score': 0.5117263714554283, 'support': 1458024}}
[[276889 111927  96533]
 [137695 266900  94748]
 [159312 109748 204272]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0230813
{'0': {'precision': 0.4963308943290501, 'recall': 0.5137853915263318, 'f1-score': 0.5049073387694588, 'support': 546847}, '1': {'precision': 0.4128658163024867, 'recall': 0.5646060853430289, 'f1-score': 0.47695806277823466, 'support': 372403}, '2': {'precision': 0.5310133429498738, 'recall': 0.37716185265064756, 'f1-score': 0.44105581649751263, 'support': 538774}, 'accuracy': 0.47628022583990387, 'macro avg': {'precision': 0.4800700178604702, 'recall': 0.4851844431733361, 'f1-score': 0.4743070726817354, 'support': 1458024}, 'weighted avg': {'precision': 0.4878285350543807, 'recall': 0.47628022583990387, 'f1-score': 0.47417400770803225, 'support': 1458024}}
[[280962 151549 114336]
 [ 97009 210261  65133]
 [188107 147462 203205]]
Evaluating performance on  train set...
2222/2222 - 37s - 37s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.85804355
{'0': {'precision': 0.40428295240241485, 'recall': 0.6391550563483283, 'f1-score': 0.4952848009299622, 'support': 106658}, '1': {'precision': 0.8312112744966879, 'recall': 0.6089361070585501, 'f1-score': 0.7029204984403535, 'support': 357113}, '2': {'precision': 0.4155513802572626, 'recall': 0.5484510911033115, 'f1-score': 0.4728402979920075, 'support': 104848}, 'accuracy': 0.6034515202622495, 'macro avg': {'precision': 0.5503485357187884, 'recall': 0.5988474181700633, 'f1-score': 0.5570151991207745, 'support': 568619}, 'weighted avg': {'precision': 0.6744869484204467, 'recall': 0.6034515202622495, 'f1-score': 0.6215488645665794, 'support': 568619}}
[[ 68171  21530  16957]
 [ 75735 217459  63919]
 [ 24716  22628  57504]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8765185
{'0': {'precision': 0.4707381698982223, 'recall': 0.5801978461943101, 'f1-score': 0.5197676511494723, 'support': 136874}, '1': {'precision': 0.7309974654473618, 'recall': 0.6516827068783211, 'f1-score': 0.689065217739624, 'support': 296962}, '2': {'precision': 0.4826708685649186, 'recall': 0.48408182040761816, 'f1-score': 0.48337531486146096, 'support': 134783}, 'accuracy': 0.5947479771164875, 'macro avg': {'precision': 0.5614688346368343, 'recall': 0.5719874578267498, 'f1-score': 0.5640693945835191, 'support': 568619}, 'weighted avg': {'precision': 0.6094873953888529, 'recall': 0.5947479771164875, 'f1-score': 0.5995572390947178, 'support': 568619}}
[[ 79414  34657  22803]
 [ 56309 193525  47128]
 [ 32978  36559  65246]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.90537333
{'0': {'precision': 0.499961035146298, 'recall': 0.5326716611420871, 'f1-score': 0.5157982621602399, 'support': 156573}, '1': {'precision': 0.6478158925696982, 'recall': 0.6846737669641956, 'f1-score': 0.6657350686235262, 'support': 257454}, '2': {'precision': 0.5128835774865074, 'recall': 0.43030040364313804, 'f1-score': 0.4679765874523377, 'support': 154592}, 'accuracy': 0.5736618016633281, 'macro avg': {'precision': 0.5535535017341678, 'recall': 0.5492152772498069, 'f1-score': 0.5498366394120345, 'support': 568619}, 'weighted avg': {'precision': 0.5704186634150363, 'recall': 0.5736618016633281, 'f1-score': 0.5706838397345997, 'support': 568619}}
[[ 83402  46745  26426]
 [ 44429 176272  36753]
 [ 38986  49085  66521]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9606514
{'0': {'precision': 0.5184733569076941, 'recall': 0.4660032440489238, 'f1-score': 0.49084003832523343, 'support': 182488}, '1': {'precision': 0.5237932410098592, 'recall': 0.7139056644076354, 'f1-score': 0.6042486748572132, 'support': 205988}, '2': {'precision': 0.5275380106098654, 'recall': 0.36267853871646416, 'f1-score': 0.4298430869436495, 'support': 180143}, 'accuracy': 0.5230743256908404, 'macro avg': {'precision': 0.5232682028424729, 'recall': 0.514195815724341, 'f1-score': 0.508310600042032, 'support': 568619}, 'weighted avg': {'precision': 0.5232722929233866, 'recall': 0.5230743256908404, 'f1-score': 0.5125991501544491, 'support': 568619}}
[[ 85040  65564  31884]
 [ 32303 147056  26629]
 [ 46677  68132  65334]]
Evaluating performance on  val set...
641/641 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8805648
{'0': {'precision': 0.3941489700235484, 'recall': 0.6099474720945502, 'f1-score': 0.47885871876490066, 'support': 30460}, '1': {'precision': 0.8287926999237384, 'recall': 0.6059234052370516, 'f1-score': 0.7000477560222566, 'support': 104028}, '2': {'precision': 0.3925619834710744, 'recall': 0.543615245750877, 'f1-score': 0.45590230664857534, 'support': 29359}, 'accuracy': 0.5955067837677833, 'macro avg': {'precision': 0.5385012178061204, 'recall': 0.5864953743608262, 'f1-score': 0.5449362604785776, 'support': 163847}, 'weighted avg': {'precision': 0.669823993648411, 'recall': 0.5955067837677833, 'f1-score': 0.6151802618171691, 'support': 163847}}
[[18579  6557  5324]
 [21623 63033 19372]
 [ 6935  6464 15960]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8984414
{'0': {'precision': 0.46062092885542677, 'recall': 0.5528620383297372, 'f1-score': 0.5025438687571384, 'support': 39395}, '1': {'precision': 0.7312153105037177, 'recall': 0.6463965006480281, 'f1-score': 0.6861947815832146, 'support': 86416}, '2': {'precision': 0.46125314281446816, 'recall': 0.48714375854453673, 'f1-score': 0.473845052233176, 'support': 38036}, 'accuracy': 0.5869378139361722, 'macro avg': {'precision': 0.5510297940578709, 'recall': 0.5621340991741007, 'f1-score': 0.5541945675245097, 'support': 163847}, 'weighted avg': {'precision': 0.6034842768243539, 'recall': 0.5869378139361722, 'f1-score': 0.5927425852272158, 'support': 163847}}
[[21780 10346  7269]
 [16184 55859 14373]
 [ 9320 10187 18529]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.92241734
{'0': {'precision': 0.49361494167392644, 'recall': 0.5113693895969534, 'f1-score': 0.5023353371102365, 'support': 45429}, '1': {'precision': 0.6500898587933248, 'recall': 0.6797492651105355, 'f1-score': 0.6645888150340221, 'support': 74501}, '2': {'precision': 0.490870280835305, 'recall': 0.43461529703759366, 'f1-score': 0.46103307931063636, 'support': 43917}, 'accuracy': 0.5673585723266218, 'macro avg': {'precision': 0.5448583604341853, 'recall': 0.5419113172483608, 'f1-score': 0.5426524104849649, 'support': 163847}, 'weighted avg': {'precision': 0.5640281962972186, 'recall': 0.5673585723266218, 'f1-score': 0.5650412462999984, 'support': 163847}}
[[23231 13688  8510]
 [12572 50642 11287]
 [11260 13570 19087]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9670787
{'0': {'precision': 0.5162009735594965, 'recall': 0.45427439139460274, 'f1-score': 0.4832618973530209, 'support': 52990}, '1': {'precision': 0.528818913430441, 'recall': 0.7115316500531296, 'f1-score': 0.6067178185426748, 'support': 59289}, '2': {'precision': 0.5108974358974359, 'recall': 0.3709277071051815, 'f1-score': 0.4298040625561747, 'support': 51568}, 'accuracy': 0.5211325199729016, 'macro avg': {'precision': 0.5186391076291245, 'recall': 0.5122445828509713, 'f1-score': 0.5065945928172901, 'support': 163847}, 'weighted avg': {'precision': 0.5190976528203392, 'recall': 0.5211325199729016, 'f1-score': 0.5111102222329981, 'support': 163847}}
[[24072 18811 10107]
 [ 8898 42186  8205]
 [13663 18777 19128]]
training model: results/WBA/W1/deepOF_L2/seq2seq
Epoch 1/50
2222/2222 - 65s - loss: 11.4492 - accuracy10: 0.5362 - accuracy20: 0.5379 - accuracy30: 0.5276 - accuracy50: 0.5023 - val_loss: 12.0737 - val_accuracy10: 0.6370 - val_accuracy20: 0.5875 - val_accuracy30: 0.5448 - val_accuracy50: 0.4763 - 65s/epoch - 29ms/step
Epoch 2/50
2222/2222 - 60s - loss: 10.8545 - accuracy10: 0.5881 - accuracy20: 0.5804 - accuracy30: 0.5633 - accuracy50: 0.5300 - val_loss: 11.8267 - val_accuracy10: 0.6453 - val_accuracy20: 0.5955 - val_accuracy30: 0.5512 - val_accuracy50: 0.4803 - 60s/epoch - 27ms/step
Epoch 3/50
2222/2222 - 59s - loss: 10.7391 - accuracy10: 0.5945 - accuracy20: 0.5853 - accuracy30: 0.5681 - accuracy50: 0.5343 - val_loss: 11.7469 - val_accuracy10: 0.6466 - val_accuracy20: 0.5974 - val_accuracy30: 0.5545 - val_accuracy50: 0.4829 - 59s/epoch - 27ms/step
Epoch 4/50
2222/2222 - 61s - loss: 10.6731 - accuracy10: 0.5969 - accuracy20: 0.5878 - accuracy30: 0.5704 - accuracy50: 0.5369 - val_loss: 11.7299 - val_accuracy10: 0.6493 - val_accuracy20: 0.5998 - val_accuracy30: 0.5554 - val_accuracy50: 0.4830 - 61s/epoch - 27ms/step
Epoch 5/50
2222/2222 - 60s - loss: 10.6224 - accuracy10: 0.5994 - accuracy20: 0.5901 - accuracy30: 0.5728 - accuracy50: 0.5388 - val_loss: 11.6693 - val_accuracy10: 0.6491 - val_accuracy20: 0.6011 - val_accuracy30: 0.5573 - val_accuracy50: 0.4847 - 60s/epoch - 27ms/step
Epoch 6/50
2222/2222 - 63s - loss: 10.5859 - accuracy10: 0.6003 - accuracy20: 0.5914 - accuracy30: 0.5740 - accuracy50: 0.5405 - val_loss: 11.6397 - val_accuracy10: 0.6488 - val_accuracy20: 0.6003 - val_accuracy30: 0.5561 - val_accuracy50: 0.4842 - 63s/epoch - 29ms/step
Epoch 7/50
2222/2222 - 60s - loss: 10.5499 - accuracy10: 0.6009 - accuracy20: 0.5928 - accuracy30: 0.5757 - accuracy50: 0.5424 - val_loss: 11.6375 - val_accuracy10: 0.6473 - val_accuracy20: 0.6013 - val_accuracy30: 0.5577 - val_accuracy50: 0.4852 - 60s/epoch - 27ms/step
Epoch 8/50
2222/2222 - 60s - loss: 10.5215 - accuracy10: 0.6023 - accuracy20: 0.5942 - accuracy30: 0.5770 - accuracy50: 0.5433 - val_loss: 11.6131 - val_accuracy10: 0.6459 - val_accuracy20: 0.6004 - val_accuracy30: 0.5578 - val_accuracy50: 0.4868 - 60s/epoch - 27ms/step
Epoch 9/50
2222/2222 - 60s - loss: 10.4944 - accuracy10: 0.6027 - accuracy20: 0.5952 - accuracy30: 0.5779 - accuracy50: 0.5443 - val_loss: 11.5672 - val_accuracy10: 0.6443 - val_accuracy20: 0.6006 - val_accuracy30: 0.5594 - val_accuracy50: 0.4894 - 60s/epoch - 27ms/step
Epoch 10/50
2222/2222 - 60s - loss: 10.4689 - accuracy10: 0.6032 - accuracy20: 0.5958 - accuracy30: 0.5794 - accuracy50: 0.5461 - val_loss: 11.5369 - val_accuracy10: 0.6424 - val_accuracy20: 0.6018 - val_accuracy30: 0.5620 - val_accuracy50: 0.4922 - 60s/epoch - 27ms/step
Epoch 11/50
2222/2222 - 61s - loss: 10.4442 - accuracy10: 0.6047 - accuracy20: 0.5972 - accuracy30: 0.5806 - accuracy50: 0.5471 - val_loss: 11.5451 - val_accuracy10: 0.6436 - val_accuracy20: 0.6016 - val_accuracy30: 0.5619 - val_accuracy50: 0.4914 - 61s/epoch - 27ms/step
Epoch 12/50
2222/2222 - 63s - loss: 10.4201 - accuracy10: 0.6047 - accuracy20: 0.5983 - accuracy30: 0.5817 - accuracy50: 0.5482 - val_loss: 11.4792 - val_accuracy10: 0.6424 - val_accuracy20: 0.6028 - val_accuracy30: 0.5639 - val_accuracy50: 0.4955 - 63s/epoch - 28ms/step
Epoch 13/50
2222/2222 - 62s - loss: 10.3999 - accuracy10: 0.6058 - accuracy20: 0.5991 - accuracy30: 0.5829 - accuracy50: 0.5497 - val_loss: 11.5573 - val_accuracy10: 0.6426 - val_accuracy20: 0.6013 - val_accuracy30: 0.5622 - val_accuracy50: 0.4951 - 62s/epoch - 28ms/step
Epoch 14/50
2222/2222 - 60s - loss: 10.3742 - accuracy10: 0.6058 - accuracy20: 0.6000 - accuracy30: 0.5839 - accuracy50: 0.5503 - val_loss: 11.4844 - val_accuracy10: 0.6394 - val_accuracy20: 0.6017 - val_accuracy30: 0.5640 - val_accuracy50: 0.4966 - 60s/epoch - 27ms/step
Epoch 15/50
2222/2222 - 59s - loss: 10.3571 - accuracy10: 0.6067 - accuracy20: 0.6006 - accuracy30: 0.5846 - accuracy50: 0.5513 - val_loss: 11.4027 - val_accuracy10: 0.6331 - val_accuracy20: 0.5992 - val_accuracy30: 0.5642 - val_accuracy50: 0.4991 - 59s/epoch - 27ms/step
Epoch 16/50
2222/2222 - 60s - loss: 10.3362 - accuracy10: 0.6075 - accuracy20: 0.6018 - accuracy30: 0.5855 - accuracy50: 0.5520 - val_loss: 11.4919 - val_accuracy10: 0.6368 - val_accuracy20: 0.5998 - val_accuracy30: 0.5637 - val_accuracy50: 0.4971 - 60s/epoch - 27ms/step
Epoch 17/50
2222/2222 - 60s - loss: 10.3173 - accuracy10: 0.6080 - accuracy20: 0.6026 - accuracy30: 0.5865 - accuracy50: 0.5537 - val_loss: 11.4619 - val_accuracy10: 0.6318 - val_accuracy20: 0.5980 - val_accuracy30: 0.5637 - val_accuracy50: 0.5005 - 60s/epoch - 27ms/step
Epoch 18/50
2222/2222 - 62s - loss: 10.2964 - accuracy10: 0.6083 - accuracy20: 0.6034 - accuracy30: 0.5874 - accuracy50: 0.5542 - val_loss: 11.3808 - val_accuracy10: 0.6296 - val_accuracy20: 0.5963 - val_accuracy30: 0.5630 - val_accuracy50: 0.5012 - 62s/epoch - 28ms/step
Epoch 19/50
2222/2222 - 62s - loss: 10.2809 - accuracy10: 0.6094 - accuracy20: 0.6037 - accuracy30: 0.5885 - accuracy50: 0.5547 - val_loss: 11.5363 - val_accuracy10: 0.6330 - val_accuracy20: 0.5977 - val_accuracy30: 0.5630 - val_accuracy50: 0.5002 - 62s/epoch - 28ms/step
Epoch 20/50
2222/2222 - 60s - loss: 10.2605 - accuracy10: 0.6090 - accuracy20: 0.6048 - accuracy30: 0.5891 - accuracy50: 0.5554 - val_loss: 11.4544 - val_accuracy10: 0.6321 - val_accuracy20: 0.6000 - val_accuracy30: 0.5662 - val_accuracy50: 0.5044 - 60s/epoch - 27ms/step
Epoch 21/50
2222/2222 - 60s - loss: 10.2436 - accuracy10: 0.6093 - accuracy20: 0.6053 - accuracy30: 0.5898 - accuracy50: 0.5569 - val_loss: 11.4365 - val_accuracy10: 0.6218 - val_accuracy20: 0.5934 - val_accuracy30: 0.5631 - val_accuracy50: 0.5044 - 60s/epoch - 27ms/step
Epoch 22/50
2222/2222 - 59s - loss: 10.2231 - accuracy10: 0.6099 - accuracy20: 0.6059 - accuracy30: 0.5905 - accuracy50: 0.5582 - val_loss: 11.3894 - val_accuracy10: 0.6227 - val_accuracy20: 0.5938 - val_accuracy30: 0.5630 - val_accuracy50: 0.5046 - 59s/epoch - 26ms/step
Epoch 23/50
2222/2222 - 60s - loss: 10.2075 - accuracy10: 0.6106 - accuracy20: 0.6062 - accuracy30: 0.5911 - accuracy50: 0.5589 - val_loss: 11.4042 - val_accuracy10: 0.6269 - val_accuracy20: 0.5957 - val_accuracy30: 0.5643 - val_accuracy50: 0.5056 - 60s/epoch - 27ms/step
Epoch 24/50
2222/2222 - 59s - loss: 10.1928 - accuracy10: 0.6109 - accuracy20: 0.6070 - accuracy30: 0.5919 - accuracy50: 0.5592 - val_loss: 11.4169 - val_accuracy10: 0.6168 - val_accuracy20: 0.5900 - val_accuracy30: 0.5599 - val_accuracy50: 0.5034 - 59s/epoch - 27ms/step
Epoch 25/50
2222/2222 - 64s - loss: 10.1795 - accuracy10: 0.6116 - accuracy20: 0.6074 - accuracy30: 0.5928 - accuracy50: 0.5605 - val_loss: 11.4154 - val_accuracy10: 0.6231 - val_accuracy20: 0.5931 - val_accuracy30: 0.5625 - val_accuracy50: 0.5063 - 64s/epoch - 29ms/step
Epoch 26/50
2222/2222 - 64s - loss: 10.1596 - accuracy10: 0.6116 - accuracy20: 0.6081 - accuracy30: 0.5937 - accuracy50: 0.5614 - val_loss: 11.5025 - val_accuracy10: 0.6238 - val_accuracy20: 0.5938 - val_accuracy30: 0.5625 - val_accuracy50: 0.5046 - 64s/epoch - 29ms/step
Epoch 27/50
2222/2222 - 61s - loss: 10.1420 - accuracy10: 0.6124 - accuracy20: 0.6087 - accuracy30: 0.5942 - accuracy50: 0.5626 - val_loss: 11.4897 - val_accuracy10: 0.6238 - val_accuracy20: 0.5932 - val_accuracy30: 0.5619 - val_accuracy50: 0.5064 - 61s/epoch - 28ms/step
Epoch 28/50
2222/2222 - 61s - loss: 10.1271 - accuracy10: 0.6127 - accuracy20: 0.6094 - accuracy30: 0.5951 - accuracy50: 0.5637 - val_loss: 11.5037 - val_accuracy10: 0.6244 - val_accuracy20: 0.5949 - val_accuracy30: 0.5628 - val_accuracy50: 0.5047 - 61s/epoch - 27ms/step
testing model: results/WBA/W1/deepOF_L2/seq2seq
Evaluating performance on  test set...
5696/5696 - 59s - 59s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9085313
{'0': {'precision': 0.42231179813369824, 'recall': 0.5051519029896961, 'f1-score': 0.4600322540361186, 'support': 339098}, '1': {'precision': 0.6941342010377276, 'recall': 0.6705819696556622, 'f1-score': 0.6821548534897761, 'support': 788615}, '2': {'precision': 0.4665751152137176, 'recall': 0.4104133742650754, 'f1-score': 0.4366959650674153, 'support': 330306}, 'accuracy': 0.5731674278593077, 'macro avg': {'precision': 0.5276737047950478, 'recall': 0.5287157489701446, 'f1-score': 0.5262943575311033, 'support': 1458019}, 'weighted avg': {'precision': 0.5793630186442635, 'recall': 0.5731674278593077, 'f1-score': 0.5748874771189794, 'support': 1458019}}
[[171296 122789  45013]
 [149812 528831 109972]
 [ 84507 110237 135562]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9624674
{'0': {'precision': 0.48005597979266024, 'recall': 0.45594835052358085, 'f1-score': 0.46769170837381324, 'support': 431834}, '1': {'precision': 0.5623764198569625, 'recall': 0.70378127411317, 'f1-score': 0.6251827796537837, 'support': 607811}, '2': {'precision': 0.52632550107753, 'recall': 0.36134415618561383, 'f1-score': 0.4285031993820906, 'support': 418374}, 'accuracy': 0.5321172083491368, 'macro avg': {'precision': 0.5229193002423842, 'recall': 0.5070245936074549, 'f1-score': 0.5071258958032292, 'support': 1458019}, 'weighted avg': {'precision': 0.5276501700562711, 'recall': 0.5321172083491368, 'f1-score': 0.5221007059690758, 'support': 1458019}}
[[196894 173850  61090]
 [105081 427766  74964]
 [108173 159024 151177]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.001342
{'0': {'precision': 0.5009690978142727, 'recall': 0.4074013025732105, 'f1-score': 0.4493661680552336, 'support': 485347}, '1': {'precision': 0.4670570673134116, 'recall': 0.7312148162685769, 'f1-score': 0.570019295857323, 'support': 499343}, '2': {'precision': 0.5461054620490764, 'recall': 0.32485226977430076, 'f1-score': 0.40737590907284504, 'support': 473329}, 'accuracy': 0.4915025112841465, 'macro avg': {'precision': 0.5047105423922535, 'recall': 0.48782279620536273, 'f1-score': 0.4755871243284672, 'support': 1458019}, 'weighted avg': {'precision': 0.5040078888728967, 'recall': 0.4915025112841465, 'f1-score': 0.4770558535135189, 'support': 1458019}}
[[197731 216406  71210]
 [ 77627 365127  56589]
 [119339 200228 153762]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0556128
{'0': {'precision': 0.5098231002034794, 'recall': 0.34409264799467487, 'f1-score': 0.4108751499853154, 'support': 546844}, '1': {'precision': 0.3459805788804769, 'recall': 0.7624267258856668, 'f1-score': 0.47597095190837646, 'support': 372403}, '2': {'precision': 0.5532694465255491, 'recall': 0.2755061510249233, 'f1-score': 0.3678417563028229, 'support': 538772}, 'accuracy': 0.4255980203275815, 'macro avg': {'precision': 0.46969104186983507, 'recall': 0.4606751749684217, 'f1-score': 0.41822928606550497, 'support': 1458019}, 'weighted avg': {'precision': 0.4840293543280032, 'recall': 0.4255980203275815, 'f1-score': 0.4115998897469028, 'support': 1458019}}
[[188165 276665  82014]
 [ 50635 283930  37838]
 [130279 260058 148435]]
Evaluating performance on  train set...
2222/2222 - 23s - 23s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.77497977
{'0': {'precision': 0.44410541348337407, 'recall': 0.5338004521109454, 'f1-score': 0.48483944895507636, 'support': 106611}, '1': {'precision': 0.7868993514930673, 'recall': 0.7635433476779631, 'f1-score': 0.7750454311479932, 'support': 356928}, '2': {'precision': 0.4742354553276468, 'recall': 0.42487081148469247, 'f1-score': 0.4481979720911555, 'support': 105079}, 'accuracy': 0.6578827965347562, 'macro avg': {'precision': 0.5684134067680294, 'recall': 0.5740715370912003, 'f1-score': 0.5693609507314084, 'support': 568618}, 'weighted avg': {'precision': 0.6648490223260033, 'recall': 0.6578827965347562, 'f1-score': 0.6602338104856109, 'support': 568618}}
[[ 56909  36931  12771]
 [ 47673 272530  36725]
 [ 23561  36873  44645]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.83260316
{'0': {'precision': 0.5074633820537116, 'recall': 0.4775170458282482, 'f1-score': 0.49203498507147997, 'support': 136837}, '1': {'precision': 0.6818673634412068, 'recall': 0.7985986363835517, 'f1-score': 0.7356310063224037, 'support': 296711}, '2': {'precision': 0.5395560368164591, 'recall': 0.36890501221588806, 'f1-score': 0.4382024448157594, 'support': 135070}, 'accuracy': 0.6192610856497683, 'macro avg': {'precision': 0.5762955941037925, 'recall': 0.548340231475896, 'f1-score': 0.5552894787365477, 'support': 568618}, 'weighted avg': {'precision': 0.6060925752911213, 'recall': 0.6192610856497683, 'f1-score': 0.6063585869431102, 'support': 568618}}
[[ 65342  54723  16772]
 [ 34008 236953  25750]
 [ 29412  55830  49828]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.88575476
{'0': {'precision': 0.5339496719488015, 'recall': 0.42306906285524515, 'f1-score': 0.4720860294746444, 'support': 156582}, '1': {'precision': 0.5971661625985182, 'recall': 0.8259500437360288, 'f1-score': 0.6931681557984786, 'support': 257225}, '2': {'precision': 0.5621761658031088, 'recall': 0.32239311160059686, 'f1-score': 0.4097852547918437, 'support': 154811}, 'accuracy': 0.5779099500895153, 'macro avg': {'precision': 0.5644306667834761, 'recall': 0.5238040727306236, 'f1-score': 0.5250131466883222, 'support': 568618}, 'weighted avg': {'precision': 0.5702317339789387, 'recall': 0.5779099500895153, 'f1-score': 0.5551347629199964, 'support': 568618}}
[[ 66245  70792  19545]
 [ 25445 212455  19325]
 [ 32376  72525  49910]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9685971
{'0': {'precision': 0.5517479142246432, 'recall': 0.35092450978779854, 'f1-score': 0.4289969676154735, 'support': 182421}, '1': {'precision': 0.4766995643667103, 'recall': 0.8562954189098005, 'f1-score': 0.6124488963344241, 'support': 205999}, '2': {'precision': 0.5681823687589331, 'recall': 0.2603136549795225, 'f1-score': 0.35704608077455885, 'support': 180198}, 'accuracy': 0.5052952949080051, 'macro avg': {'precision': 0.5322099491167622, 'recall': 0.4891778612257072, 'f1-score': 0.4661639815748188, 'support': 568618}, 'weighted avg': {'precision': 0.5297675527443272, 'recall': 0.5052952949080051, 'f1-score': 0.47265634518919786, 'support': 568618}}
[[ 64016  95625  22780]
 [ 16733 176396  12870]
 [ 35275  98015  46908]]
Evaluating performance on  val set...
641/641 - 6s - 6s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.81619126
{'0': {'precision': 0.41718036986630375, 'recall': 0.5118022589621869, 'f1-score': 0.4596724396483284, 'support': 30545}, '1': {'precision': 0.7860451437394309, 'recall': 0.7194620161895057, 'f1-score': 0.7512812147069897, 'support': 104018}, '2': {'precision': 0.4077199512289033, 'recall': 0.4339377795990848, 'f1-score': 0.4204205197770021, 'support': 29283}, 'accuracy': 0.629719370628517, 'macro avg': {'precision': 0.536981821611546, 'recall': 0.5550673515835924, 'f1-score': 0.54379139137744, 'support': 163846}, 'weighted avg': {'precision': 0.6496642059671298, 'recall': 0.629719370628517, 'f1-score': 0.6377857142748666, 'support': 163846}}
[[15633 10628  4284]
 [15006 74837 14175]
 [ 6834  9742 12707]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8710781
{'0': {'precision': 0.48067115867353677, 'recall': 0.46083497998682676, 'f1-score': 0.47054410946856523, 'support': 39474}, '1': {'precision': 0.6838404284479305, 'recall': 0.7509696092619392, 'f1-score': 0.7158346622229335, 'support': 86375}, '2': {'precision': 0.47397823225350755, 'recall': 0.38853067347422166, 'f1-score': 0.4270218674071503, 'support': 37997}, 'accuracy': 0.5970179314722361, 'macro avg': {'precision': 0.5461632731249916, 'recall': 0.5334450875743292, 'f1-score': 0.5378002130328831, 'support': 163846}, 'weighted avg': {'precision': 0.5862241447188562, 'recall': 0.5970179314722361, 'f1-score': 0.589761282073029, 'support': 163846}}
[[18191 15488  5795]
 [10921 64865 10589]
 [ 8733 14501 14763]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9155034
{'0': {'precision': 0.5103061945940066, 'recall': 0.4128297071958114, 'f1-score': 0.45642154418649905, 'support': 45457}, '1': {'precision': 0.6019791321629678, 'recall': 0.7807851350625638, 'f1-score': 0.679821382647932, 'support': 74484}, '2': {'precision': 0.5067292542016807, 'recall': 0.3516000455528983, 'f1-score': 0.4151460958194947, 'support': 43905}, 'accuracy': 0.563693956520147, 'macro avg': {'precision': 0.5396715269862183, 'recall': 0.5150716292704245, 'f1-score': 0.5171296742179753, 'support': 163846}, 'weighted avg': {'precision': 0.5510219979334928, 'recall': 0.563693956520147, 'f1-score': 0.546918199627633, 'support': 163846}}
[[18766 19758  6933]
 [ 8234 58156  8094]
 [ 9774 18694 15437]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9830526
{'0': {'precision': 0.5282336182336183, 'recall': 0.3496916316176609, 'f1-score': 0.42080775297602163, 'support': 53021}, '1': {'precision': 0.4834534960356294, 'recall': 0.8163836568133147, 'f1-score': 0.6072815077299383, 'support': 59303}, '2': {'precision': 0.5278981960564956, 'recall': 0.2930786848336633, 'f1-score': 0.37690637246337017, 'support': 51522}, 'accuracy': 0.5008056345592813, 'macro avg': {'precision': 0.5131951034419143, 'recall': 0.48638465775487966, 'f1-score': 0.46833187772311, 'support': 163846}, 'weighted avg': {'precision': 0.5119202678429035, 'recall': 0.5008056345592813, 'f1-score': 0.47449576581367825, 'support': 163846}}
[[18541 26336  8144]
 [ 5529 48414  5360]
 [11030 25392 15100]]
training model: results/WBA/W1/deepVOL_L2/seq2seq
Epoch 1/50
2222/2222 - 66s - loss: 11.7727 - accuracy10: 0.5045 - accuracy20: 0.5129 - accuracy30: 0.5074 - accuracy50: 0.4872 - val_loss: 12.7426 - val_accuracy10: 0.6311 - val_accuracy20: 0.5785 - val_accuracy30: 0.5319 - val_accuracy50: 0.4606 - 66s/epoch - 30ms/step
Epoch 2/50
2222/2222 - 58s - loss: 11.1683 - accuracy10: 0.5611 - accuracy20: 0.5599 - accuracy30: 0.5462 - accuracy50: 0.5155 - val_loss: 12.6275 - val_accuracy10: 0.6323 - val_accuracy20: 0.5796 - val_accuracy30: 0.5320 - val_accuracy50: 0.4598 - 58s/epoch - 26ms/step
Epoch 3/50
2222/2222 - 57s - loss: 10.9366 - accuracy10: 0.5795 - accuracy20: 0.5738 - accuracy30: 0.5582 - accuracy50: 0.5251 - val_loss: 12.3438 - val_accuracy10: 0.6399 - val_accuracy20: 0.5871 - val_accuracy30: 0.5388 - val_accuracy50: 0.4655 - 57s/epoch - 26ms/step
Epoch 4/50
2222/2222 - 57s - loss: 10.8184 - accuracy10: 0.5870 - accuracy20: 0.5808 - accuracy30: 0.5637 - accuracy50: 0.5297 - val_loss: 12.2060 - val_accuracy10: 0.6429 - val_accuracy20: 0.5917 - val_accuracy30: 0.5452 - val_accuracy50: 0.4726 - 57s/epoch - 26ms/step
Epoch 5/50
2222/2222 - 57s - loss: 10.7434 - accuracy10: 0.5907 - accuracy20: 0.5837 - accuracy30: 0.5667 - accuracy50: 0.5324 - val_loss: 12.1116 - val_accuracy10: 0.6407 - val_accuracy20: 0.5922 - val_accuracy30: 0.5468 - val_accuracy50: 0.4749 - 57s/epoch - 26ms/step
Epoch 6/50
2222/2222 - 57s - loss: 10.6900 - accuracy10: 0.5938 - accuracy20: 0.5868 - accuracy30: 0.5700 - accuracy50: 0.5357 - val_loss: 12.0480 - val_accuracy10: 0.6408 - val_accuracy20: 0.5942 - val_accuracy30: 0.5488 - val_accuracy50: 0.4782 - 57s/epoch - 26ms/step
Epoch 7/50
2222/2222 - 59s - loss: 10.6513 - accuracy10: 0.5959 - accuracy20: 0.5888 - accuracy30: 0.5718 - accuracy50: 0.5374 - val_loss: 12.0121 - val_accuracy10: 0.6371 - val_accuracy20: 0.5939 - val_accuracy30: 0.5512 - val_accuracy50: 0.4822 - 59s/epoch - 26ms/step
Epoch 8/50
2222/2222 - 59s - loss: 10.6191 - accuracy10: 0.5980 - accuracy20: 0.5899 - accuracy30: 0.5734 - accuracy50: 0.5389 - val_loss: 11.9319 - val_accuracy10: 0.6409 - val_accuracy20: 0.5958 - val_accuracy30: 0.5531 - val_accuracy50: 0.4838 - 59s/epoch - 27ms/step
Epoch 9/50
2222/2222 - 57s - loss: 10.5871 - accuracy10: 0.5992 - accuracy20: 0.5909 - accuracy30: 0.5747 - accuracy50: 0.5402 - val_loss: 11.9857 - val_accuracy10: 0.6352 - val_accuracy20: 0.5917 - val_accuracy30: 0.5502 - val_accuracy50: 0.4827 - 57s/epoch - 26ms/step
Epoch 10/50
2222/2222 - 58s - loss: 10.5612 - accuracy10: 0.6008 - accuracy20: 0.5923 - accuracy30: 0.5757 - accuracy50: 0.5411 - val_loss: 11.8509 - val_accuracy10: 0.6412 - val_accuracy20: 0.5977 - val_accuracy30: 0.5550 - val_accuracy50: 0.4865 - 58s/epoch - 26ms/step
Epoch 11/50
2222/2222 - 58s - loss: 10.5325 - accuracy10: 0.6022 - accuracy20: 0.5933 - accuracy30: 0.5770 - accuracy50: 0.5423 - val_loss: 11.8822 - val_accuracy10: 0.6411 - val_accuracy20: 0.5971 - val_accuracy30: 0.5552 - val_accuracy50: 0.4869 - 58s/epoch - 26ms/step
Epoch 12/50
2222/2222 - 57s - loss: 10.5108 - accuracy10: 0.6034 - accuracy20: 0.5949 - accuracy30: 0.5783 - accuracy50: 0.5434 - val_loss: 11.8600 - val_accuracy10: 0.6366 - val_accuracy20: 0.5954 - val_accuracy30: 0.5549 - val_accuracy50: 0.4885 - 57s/epoch - 26ms/step
Epoch 13/50
2222/2222 - 56s - loss: 10.4843 - accuracy10: 0.6043 - accuracy20: 0.5958 - accuracy30: 0.5792 - accuracy50: 0.5445 - val_loss: 11.7907 - val_accuracy10: 0.6410 - val_accuracy20: 0.5980 - val_accuracy30: 0.5567 - val_accuracy50: 0.4893 - 56s/epoch - 25ms/step
Epoch 14/50
2222/2222 - 61s - loss: 10.4642 - accuracy10: 0.6056 - accuracy20: 0.5967 - accuracy30: 0.5798 - accuracy50: 0.5451 - val_loss: 11.8277 - val_accuracy10: 0.6444 - val_accuracy20: 0.5993 - val_accuracy30: 0.5573 - val_accuracy50: 0.4870 - 61s/epoch - 27ms/step
Epoch 15/50
2222/2222 - 60s - loss: 10.4471 - accuracy10: 0.6064 - accuracy20: 0.5977 - accuracy30: 0.5808 - accuracy50: 0.5459 - val_loss: 11.7720 - val_accuracy10: 0.6442 - val_accuracy20: 0.5989 - val_accuracy30: 0.5561 - val_accuracy50: 0.4861 - 60s/epoch - 27ms/step
Epoch 16/50
2222/2222 - 59s - loss: 10.4262 - accuracy10: 0.6067 - accuracy20: 0.5988 - accuracy30: 0.5818 - accuracy50: 0.5469 - val_loss: 11.7839 - val_accuracy10: 0.6436 - val_accuracy20: 0.6000 - val_accuracy30: 0.5576 - val_accuracy50: 0.4888 - 59s/epoch - 26ms/step
Epoch 17/50
2222/2222 - 57s - loss: 10.4076 - accuracy10: 0.6083 - accuracy20: 0.5996 - accuracy30: 0.5825 - accuracy50: 0.5480 - val_loss: 11.7698 - val_accuracy10: 0.6418 - val_accuracy20: 0.5987 - val_accuracy30: 0.5562 - val_accuracy50: 0.4881 - 57s/epoch - 26ms/step
Epoch 18/50
2222/2222 - 57s - loss: 10.3891 - accuracy10: 0.6074 - accuracy20: 0.5997 - accuracy30: 0.5835 - accuracy50: 0.5490 - val_loss: 11.8303 - val_accuracy10: 0.6436 - val_accuracy20: 0.5999 - val_accuracy30: 0.5570 - val_accuracy50: 0.4872 - 57s/epoch - 26ms/step
Epoch 19/50
2222/2222 - 57s - loss: 10.3707 - accuracy10: 0.6090 - accuracy20: 0.6012 - accuracy30: 0.5843 - accuracy50: 0.5500 - val_loss: 11.7854 - val_accuracy10: 0.6445 - val_accuracy20: 0.6011 - val_accuracy30: 0.5576 - val_accuracy50: 0.4880 - 57s/epoch - 26ms/step
Epoch 20/50
2222/2222 - 59s - loss: 10.3584 - accuracy10: 0.6087 - accuracy20: 0.6008 - accuracy30: 0.5844 - accuracy50: 0.5502 - val_loss: 11.7560 - val_accuracy10: 0.6434 - val_accuracy20: 0.6014 - val_accuracy30: 0.5602 - val_accuracy50: 0.4905 - 59s/epoch - 26ms/step
Epoch 21/50
2222/2222 - 61s - loss: 10.3422 - accuracy10: 0.6101 - accuracy20: 0.6023 - accuracy30: 0.5859 - accuracy50: 0.5517 - val_loss: 11.8069 - val_accuracy10: 0.6421 - val_accuracy20: 0.6002 - val_accuracy30: 0.5583 - val_accuracy50: 0.4888 - 61s/epoch - 27ms/step
Epoch 22/50
2222/2222 - 59s - loss: 10.3243 - accuracy10: 0.6104 - accuracy20: 0.6032 - accuracy30: 0.5866 - accuracy50: 0.5524 - val_loss: 11.7552 - val_accuracy10: 0.6397 - val_accuracy20: 0.5989 - val_accuracy30: 0.5583 - val_accuracy50: 0.4893 - 59s/epoch - 26ms/step
Epoch 23/50
2222/2222 - 57s - loss: 10.3106 - accuracy10: 0.6112 - accuracy20: 0.6033 - accuracy30: 0.5870 - accuracy50: 0.5530 - val_loss: 11.8318 - val_accuracy10: 0.6368 - val_accuracy20: 0.5977 - val_accuracy30: 0.5580 - val_accuracy50: 0.4889 - 57s/epoch - 26ms/step
Epoch 24/50
2222/2222 - 58s - loss: 10.2952 - accuracy10: 0.6113 - accuracy20: 0.6043 - accuracy30: 0.5878 - accuracy50: 0.5534 - val_loss: 11.7478 - val_accuracy10: 0.6364 - val_accuracy20: 0.5982 - val_accuracy30: 0.5586 - val_accuracy50: 0.4911 - 58s/epoch - 26ms/step
Epoch 25/50
2222/2222 - 57s - loss: 10.2848 - accuracy10: 0.6118 - accuracy20: 0.6043 - accuracy30: 0.5886 - accuracy50: 0.5540 - val_loss: 11.8329 - val_accuracy10: 0.6390 - val_accuracy20: 0.5995 - val_accuracy30: 0.5594 - val_accuracy50: 0.4905 - 57s/epoch - 26ms/step
Epoch 26/50
2222/2222 - 57s - loss: 10.2703 - accuracy10: 0.6123 - accuracy20: 0.6046 - accuracy30: 0.5885 - accuracy50: 0.5547 - val_loss: 11.8140 - val_accuracy10: 0.6347 - val_accuracy20: 0.5968 - val_accuracy30: 0.5582 - val_accuracy50: 0.4910 - 57s/epoch - 26ms/step
Epoch 27/50
2222/2222 - 61s - loss: 10.2579 - accuracy10: 0.6123 - accuracy20: 0.6057 - accuracy30: 0.5899 - accuracy50: 0.5560 - val_loss: 11.8583 - val_accuracy10: 0.6359 - val_accuracy20: 0.5977 - val_accuracy30: 0.5578 - val_accuracy50: 0.4902 - 61s/epoch - 27ms/step
Epoch 28/50
2222/2222 - 60s - loss: 10.2418 - accuracy10: 0.6126 - accuracy20: 0.6060 - accuracy30: 0.5905 - accuracy50: 0.5565 - val_loss: 11.8627 - val_accuracy10: 0.6369 - val_accuracy20: 0.5971 - val_accuracy30: 0.5569 - val_accuracy50: 0.4887 - 60s/epoch - 27ms/step
Epoch 29/50
2222/2222 - 60s - loss: 10.2265 - accuracy10: 0.6135 - accuracy20: 0.6065 - accuracy30: 0.5907 - accuracy50: 0.5571 - val_loss: 11.8368 - val_accuracy10: 0.6361 - val_accuracy20: 0.5983 - val_accuracy30: 0.5600 - val_accuracy50: 0.4920 - 60s/epoch - 27ms/step
Epoch 30/50
2222/2222 - 57s - loss: 10.2171 - accuracy10: 0.6135 - accuracy20: 0.6076 - accuracy30: 0.5922 - accuracy50: 0.5581 - val_loss: 11.9008 - val_accuracy10: 0.6340 - val_accuracy20: 0.5960 - val_accuracy30: 0.5565 - val_accuracy50: 0.4877 - 57s/epoch - 26ms/step
Epoch 31/50
2222/2222 - 57s - loss: 10.2067 - accuracy10: 0.6138 - accuracy20: 0.6076 - accuracy30: 0.5923 - accuracy50: 0.5585 - val_loss: 11.8714 - val_accuracy10: 0.6375 - val_accuracy20: 0.5989 - val_accuracy30: 0.5587 - val_accuracy50: 0.4902 - 57s/epoch - 26ms/step
Epoch 32/50
2222/2222 - 58s - loss: 10.1938 - accuracy10: 0.6140 - accuracy20: 0.6083 - accuracy30: 0.5925 - accuracy50: 0.5589 - val_loss: 11.8225 - val_accuracy10: 0.6362 - val_accuracy20: 0.5989 - val_accuracy30: 0.5597 - val_accuracy50: 0.4913 - 58s/epoch - 26ms/step
Epoch 33/50
2222/2222 - 59s - loss: 10.1833 - accuracy10: 0.6142 - accuracy20: 0.6086 - accuracy30: 0.5931 - accuracy50: 0.5597 - val_loss: 11.9724 - val_accuracy10: 0.6348 - val_accuracy20: 0.5961 - val_accuracy30: 0.5569 - val_accuracy50: 0.4885 - 59s/epoch - 27ms/step
Epoch 34/50
2222/2222 - 61s - loss: 10.1701 - accuracy10: 0.6151 - accuracy20: 0.6092 - accuracy30: 0.5940 - accuracy50: 0.5601 - val_loss: 11.9388 - val_accuracy10: 0.6377 - val_accuracy20: 0.5979 - val_accuracy30: 0.5578 - val_accuracy50: 0.4885 - 61s/epoch - 27ms/step
testing model: results/WBA/W1/deepVOL_L2/seq2seq
Evaluating performance on  test set...
5696/5696 - 50s - 50s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9225486
{'0': {'precision': 0.4121714745123562, 'recall': 0.507987342929351, 'f1-score': 0.4550907695498311, 'support': 339099}, '1': {'precision': 0.6957416860990315, 'recall': 0.6719214421213874, 'f1-score': 0.6836241285175381, 'support': 788616}, '2': {'precision': 0.4582268026429187, 'recall': 0.3863261370413764, 'f1-score': 0.4192158531116692, 'support': 330309}, 'accuracy': 0.5690941987237521, 'macro avg': {'precision': 0.522046654418102, 'recall': 0.5220783073640383, 'f1-score': 0.5193102503930128, 'support': 1458024}, 'weighted avg': {'precision': 0.5759825608594366, 'recall': 0.5690941987237521, 'f1-score': 0.5705725830466627, 'support': 1458024}}
[[172258 122112  44729]
 [152584 529888 106144]
 [ 93086 109616 127607]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9858202
{'0': {'precision': 0.47782442430792255, 'recall': 0.4259209514723182, 'f1-score': 0.45038224015749956, 'support': 431836}, '1': {'precision': 0.5606332246149414, 'recall': 0.7171916928124038, 'f1-score': 0.6293217262001436, 'support': 607811}, '2': {'precision': 0.5082117529233434, 'recall': 0.35901352129777686, 'f1-score': 0.4207785368012786, 'support': 418377}, 'accuracy': 0.5281449413727072, 'macro avg': {'precision': 0.515556467282069, 'recall': 0.5007087218608329, 'f1-score': 0.5001608343863072, 'support': 1458024}, 'weighted avg': {'precision': 0.5210647681620315, 'recall': 0.5281449413727072, 'f1-score': 0.516482578253443, 'support': 1458024}}
[[183928 178657  69251]
 [ 95796 435917  76098]
 [105204 162970 150203]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0289338
{'0': {'precision': 0.49961202743378175, 'recall': 0.3621682541841026, 'f1-score': 0.4199298118201864, 'support': 485349}, '1': {'precision': 0.4636390616676249, 'recall': 0.7477205047432326, 'f1-score': 0.5723691673743948, 'support': 499343}, '2': {'precision': 0.5235332043842682, 'recall': 0.3328065712861163, 'f1-score': 0.4069302761725904, 'support': 473332}, 'accuracy': 0.4846799503986217, 'macro avg': {'precision': 0.495594764495225, 'recall': 0.48089844340448384, 'f1-score': 0.46640975178905725, 'support': 1458024}, 'weighted avg': {'precision': 0.4950577881920118, 'recall': 0.4846799503986217, 'f1-score': 0.46791697040835584, 'support': 1458024}}
[[175778 224675  84896]
 [ 67504 373369  58470]
 [108547 207257 157528]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0876725
{'0': {'precision': 0.5098685354846667, 'recall': 0.29482469502438524, 'f1-score': 0.37361277509866125, 'support': 546847}, '1': {'precision': 0.3439027823841986, 'recall': 0.7740539147106763, 'f1-score': 0.4762246975685711, 'support': 372403}, '2': {'precision': 0.5248917214235134, 'recall': 0.2957919275985849, 'f1-score': 0.37836438984839543, 'support': 538774}, 'accuracy': 0.4175850328938344, 'macro avg': {'precision': 0.4595543464307929, 'recall': 0.4548901791112155, 'f1-score': 0.4094006208385426, 'support': 1458024}, 'weighted avg': {'precision': 0.47302960665300314, 'recall': 0.4175850328938344, 'f1-score': 0.40157735884264295, 'support': 1458024}}
[[161224 282620 103003]
 [ 42896 288260  41247]
 [112087 267322 159365]]
Evaluating performance on  train set...
2222/2222 - 21s - 21s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7757876
{'0': {'precision': 0.44143913273071783, 'recall': 0.5329651784207466, 'f1-score': 0.48290362315762647, 'support': 106658}, '1': {'precision': 0.7792523587589832, 'recall': 0.7861041183042903, 'f1-score': 0.7826632430307542, 'support': 357113}, '2': {'precision': 0.4712666783928437, 'recall': 0.3577559896230734, 'f1-score': 0.406740330293534, 'support': 104848}, 'accuracy': 0.6596385277312224, 'macro avg': {'precision': 0.5639860566275149, 'recall': 0.5589417621160367, 'f1-score': 0.5574357321606382, 'support': 568619}, 'weighted avg': {'precision': 0.6590977988924439, 'recall': 0.6596385277312224, 'f1-score': 0.6571195536867468, 'support': 568619}}
[[ 56845  38753  11060]
 [ 45361 280728  31024]
 [ 26566  40772  37510]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.84411895
{'0': {'precision': 0.5117924917832428, 'recall': 0.45278869617312273, 'f1-score': 0.48048595174595304, 'support': 136874}, '1': {'precision': 0.6711983845822956, 'recall': 0.8249405647860669, 'f1-score': 0.7401702558369654, 'support': 296962}, '2': {'precision': 0.5295970536211868, 'recall': 0.3243287358197992, 'f1-score': 0.4022914989071667, 'support': 134783}, 'accuracy': 0.6166958895147717, 'macro avg': {'precision': 0.5708626433289085, 'recall': 0.534019332259663, 'f1-score': 0.5409825688300284, 'support': 568619}, 'weighted avg': {'precision': 0.5992627398678055, 'recall': 0.6166958895147717, 'f1-score': 0.5975715351937538, 'support': 568619}}
[[ 61975  58579  16320]
 [ 29478 244976  22508]
 [ 29641  61428  43714]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9019842
{'0': {'precision': 0.5403158034411075, 'recall': 0.3901055737579276, 'f1-score': 0.45308547648895847, 'support': 156573}, '1': {'precision': 0.5863029444392467, 'recall': 0.8519308303619287, 'f1-score': 0.6945874350208772, 'support': 257454}, '2': {'precision': 0.547797592017575, 'recall': 0.28872127923825297, 'f1-score': 0.3781404746876999, 'support': 154592}, 'accuracy': 0.5716428751061783, 'macro avg': {'precision': 0.5581387799659764, 'recall': 0.5102525611193698, 'f1-score': 0.5086044620658452, 'support': 568619}, 'weighted avg': {'precision': 0.563171525916347, 'recall': 0.5716428751061783, 'f1-score': 0.542054975421313, 'support': 568619}}
[[ 61080  75614  19879]
 [ 21155 219333  16966]
 [ 30810  79148  44634]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.99069357
{'0': {'precision': 0.5570550853549828, 'recall': 0.318470255578449, 'f1-score': 0.4052549186415031, 'support': 182488}, '1': {'precision': 0.46735963175634476, 'recall': 0.8744150144668621, 'f1-score': 0.6091429441057855, 'support': 205988}, '2': {'precision': 0.5513797168316581, 'recall': 0.24147482833082606, 'f1-score': 0.33586065257338743, 'support': 180143}, 'accuracy': 0.49547412239126726, 'macro avg': {'precision': 0.5252648113143286, 'recall': 0.4781200327920457, 'f1-score': 0.45008617177355864, 'support': 568619}, 'weighted avg': {'precision': 0.5227639958771892, 'recall': 0.49547412239126726, 'f1-score': 0.45713077104360017, 'support': 568619}}
[[ 58117 100549  23822]
 [ 14298 180119  11571]
 [ 31914 104729  43500]]
Evaluating performance on  val set...
641/641 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.82433337
{'0': {'precision': 0.40543254629176056, 'recall': 0.5434340118187787, 'f1-score': 0.4643979351363483, 'support': 30460}, '1': {'precision': 0.7807866411829796, 'recall': 0.7461260429884262, 'f1-score': 0.7630629479251664, 'support': 104028}, '2': {'precision': 0.43093735439874625, 'recall': 0.34653768861337236, 'f1-score': 0.3841564718320495, 'support': 29359}, 'accuracy': 0.6368441289739818, 'macro avg': {'precision': 0.5390521806244954, 'recall': 0.5453659144735258, 'f1-score': 0.5372057849645214, 'support': 163847}, 'weighted avg': {'precision': 0.6483184791715614, 'recall': 0.6368441289739818, 'f1-score': 0.6396450548836995, 'support': 163847}}
[[16553 10610  3297]
 [16272 77618 10138]
 [ 8003 11182 10174]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8875775
{'0': {'precision': 0.47399984218417107, 'recall': 0.45744383805051403, 'f1-score': 0.465574702250239, 'support': 39395}, '1': {'precision': 0.6724670193863471, 'recall': 0.7839404739862988, 'f1-score': 0.7239376566198433, 'support': 86416}, '2': {'precision': 0.4873440427312951, 'recall': 0.32143232726890314, 'f1-score': 0.3873706889723239, 'support': 38036}, 'accuracy': 0.5980701508114278, 'macro avg': {'precision': 0.5446036347672711, 'recall': 0.520938879768572, 'f1-score': 0.5256276826141354, 'support': 163847}, 'weighted avg': {'precision': 0.5817729451223613, 'recall': 0.5980701508114278, 'f1-score': 0.5836856546373131, 'support': 163847}}
[[18021 16290  5084]
 [10894 67745  7777]
 [ 9104 16706 12226]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9359743
{'0': {'precision': 0.5061200371422944, 'recall': 0.3959365163221731, 'f1-score': 0.4442989823140006, 'support': 45429}, '1': {'precision': 0.5888176092083426, 'recall': 0.8143514852149636, 'f1-score': 0.6834593157521207, 'support': 74501}, '2': {'precision': 0.5120889557199952, 'recall': 0.2946694901746476, 'f1-score': 0.37408221078799786, 'support': 43917}, 'accuracy': 0.5590459391993751, 'macro avg': {'precision': 0.5356755340235441, 'recall': 0.5016524972372615, 'f1-score': 0.5006135029513731, 'support': 163847}, 'weighted avg': {'precision': 0.5453223955234032, 'recall': 0.5590459391993751, 'f1-score': 0.5342241811053482, 'support': 163847}}
[[17987 21057  6385]
 [ 7886 60670  5945]
 [ 9666 21310 12941]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0088596
{'0': {'precision': 0.5293363453202271, 'recall': 0.3272315531232308, 'f1-score': 0.40444091990483744, 'support': 52990}, '1': {'precision': 0.47135736268715894, 'recall': 0.8421292313919951, 'f1-score': 0.6044124322852041, 'support': 59289}, '2': {'precision': 0.5276000476890673, 'recall': 0.2574464784362395, 'f1-score': 0.3460400620349012, 'support': 51568}, 'accuracy': 0.4915866631674672, 'macro avg': {'precision': 0.5094312518988179, 'recall': 0.4756024209838218, 'f1-score': 0.4516311380749809, 'support': 163847}, 'weighted avg': {'precision': 0.5078098401197924, 'recall': 0.4915866631674672, 'f1-score': 0.4584211304603111, 'support': 163847}}
[[17340 27903  7747]
 [ 5220 49929  4140]
 [10198 28094 13276]]
training model: results/WBA/W1/deepVOL_L3/seq2seq
Epoch 1/50
2222/2222 - 92s - loss: 12.0570 - accuracy10: 0.4872 - accuracy20: 0.4922 - accuracy30: 0.4885 - accuracy50: 0.4723 - val_loss: 12.7643 - val_accuracy10: 0.5916 - val_accuracy20: 0.5551 - val_accuracy30: 0.5187 - val_accuracy50: 0.4567 - 92s/epoch - 41ms/step
Epoch 2/50
2222/2222 - 87s - loss: 11.2921 - accuracy10: 0.5521 - accuracy20: 0.5510 - accuracy30: 0.5391 - accuracy50: 0.5103 - val_loss: 12.4588 - val_accuracy10: 0.6250 - val_accuracy20: 0.5742 - val_accuracy30: 0.5282 - val_accuracy50: 0.4571 - 87s/epoch - 39ms/step
Epoch 3/50
2222/2222 - 86s - loss: 11.0494 - accuracy10: 0.5704 - accuracy20: 0.5650 - accuracy30: 0.5508 - accuracy50: 0.5201 - val_loss: 12.3164 - val_accuracy10: 0.6379 - val_accuracy20: 0.5858 - val_accuracy30: 0.5384 - val_accuracy50: 0.4635 - 86s/epoch - 39ms/step
Epoch 4/50
2222/2222 - 85s - loss: 10.8508 - accuracy10: 0.5802 - accuracy20: 0.5747 - accuracy30: 0.5600 - accuracy50: 0.5283 - val_loss: 12.0944 - val_accuracy10: 0.6395 - val_accuracy20: 0.5899 - val_accuracy30: 0.5444 - val_accuracy50: 0.4713 - 85s/epoch - 38ms/step
Epoch 5/50
2222/2222 - 84s - loss: 10.7498 - accuracy10: 0.5867 - accuracy20: 0.5816 - accuracy30: 0.5660 - accuracy50: 0.5331 - val_loss: 12.0196 - val_accuracy10: 0.6421 - val_accuracy20: 0.5906 - val_accuracy30: 0.5428 - val_accuracy50: 0.4687 - 84s/epoch - 38ms/step
Epoch 6/50
2222/2222 - 85s - loss: 10.6727 - accuracy10: 0.5916 - accuracy20: 0.5867 - accuracy30: 0.5705 - accuracy50: 0.5362 - val_loss: 11.8768 - val_accuracy10: 0.6472 - val_accuracy20: 0.5951 - val_accuracy30: 0.5472 - val_accuracy50: 0.4746 - 85s/epoch - 38ms/step
Epoch 7/50
2222/2222 - 88s - loss: 10.6259 - accuracy10: 0.5947 - accuracy20: 0.5893 - accuracy30: 0.5726 - accuracy50: 0.5388 - val_loss: 11.7333 - val_accuracy10: 0.6412 - val_accuracy20: 0.5934 - val_accuracy30: 0.5473 - val_accuracy50: 0.4752 - 88s/epoch - 40ms/step
Epoch 8/50
2222/2222 - 85s - loss: 10.5805 - accuracy10: 0.5975 - accuracy20: 0.5913 - accuracy30: 0.5751 - accuracy50: 0.5409 - val_loss: 11.6346 - val_accuracy10: 0.6389 - val_accuracy20: 0.5954 - val_accuracy30: 0.5522 - val_accuracy50: 0.4819 - 85s/epoch - 38ms/step
Epoch 9/50
2222/2222 - 84s - loss: 10.5468 - accuracy10: 0.5996 - accuracy20: 0.5932 - accuracy30: 0.5767 - accuracy50: 0.5423 - val_loss: 11.5462 - val_accuracy10: 0.6397 - val_accuracy20: 0.5987 - val_accuracy30: 0.5563 - val_accuracy50: 0.4860 - 84s/epoch - 38ms/step
Epoch 10/50
2222/2222 - 85s - loss: 10.5136 - accuracy10: 0.6014 - accuracy20: 0.5948 - accuracy30: 0.5779 - accuracy50: 0.5427 - val_loss: 11.6206 - val_accuracy10: 0.6367 - val_accuracy20: 0.5968 - val_accuracy30: 0.5550 - val_accuracy50: 0.4851 - 85s/epoch - 38ms/step
Epoch 11/50
2222/2222 - 85s - loss: 10.4857 - accuracy10: 0.6023 - accuracy20: 0.5957 - accuracy30: 0.5793 - accuracy50: 0.5445 - val_loss: 11.5715 - val_accuracy10: 0.6388 - val_accuracy20: 0.5987 - val_accuracy30: 0.5567 - val_accuracy50: 0.4856 - 85s/epoch - 38ms/step
Epoch 12/50
2222/2222 - 87s - loss: 10.4619 - accuracy10: 0.6030 - accuracy20: 0.5963 - accuracy30: 0.5801 - accuracy50: 0.5457 - val_loss: 11.6203 - val_accuracy10: 0.6436 - val_accuracy20: 0.6009 - val_accuracy30: 0.5565 - val_accuracy50: 0.4842 - 87s/epoch - 39ms/step
Epoch 13/50
2222/2222 - 87s - loss: 10.4400 - accuracy10: 0.6042 - accuracy20: 0.5974 - accuracy30: 0.5810 - accuracy50: 0.5465 - val_loss: 11.5920 - val_accuracy10: 0.6373 - val_accuracy20: 0.5998 - val_accuracy30: 0.5583 - val_accuracy50: 0.4886 - 87s/epoch - 39ms/step
Epoch 14/50
2222/2222 - 88s - loss: 10.4167 - accuracy10: 0.6045 - accuracy20: 0.5985 - accuracy30: 0.5821 - accuracy50: 0.5478 - val_loss: 11.5568 - val_accuracy10: 0.6390 - val_accuracy20: 0.6010 - val_accuracy30: 0.5592 - val_accuracy50: 0.4884 - 88s/epoch - 40ms/step
Epoch 15/50
2222/2222 - 86s - loss: 10.3953 - accuracy10: 0.6060 - accuracy20: 0.5995 - accuracy30: 0.5835 - accuracy50: 0.5488 - val_loss: 11.5267 - val_accuracy10: 0.6381 - val_accuracy20: 0.6016 - val_accuracy30: 0.5616 - val_accuracy50: 0.4912 - 86s/epoch - 39ms/step
Epoch 16/50
2222/2222 - 87s - loss: 10.3766 - accuracy10: 0.6067 - accuracy20: 0.6003 - accuracy30: 0.5840 - accuracy50: 0.5494 - val_loss: 11.5919 - val_accuracy10: 0.6460 - val_accuracy20: 0.6026 - val_accuracy30: 0.5585 - val_accuracy50: 0.4864 - 87s/epoch - 39ms/step
Epoch 17/50
2222/2222 - 87s - loss: 10.3601 - accuracy10: 0.6075 - accuracy20: 0.6008 - accuracy30: 0.5851 - accuracy50: 0.5508 - val_loss: 11.5465 - val_accuracy10: 0.6378 - val_accuracy20: 0.6012 - val_accuracy30: 0.5607 - val_accuracy50: 0.4917 - 87s/epoch - 39ms/step
Epoch 18/50
2222/2222 - 87s - loss: 10.3445 - accuracy10: 0.6079 - accuracy20: 0.6013 - accuracy30: 0.5855 - accuracy50: 0.5514 - val_loss: 11.4652 - val_accuracy10: 0.6383 - val_accuracy20: 0.6024 - val_accuracy30: 0.5635 - val_accuracy50: 0.4929 - 87s/epoch - 39ms/step
Epoch 19/50
2222/2222 - 85s - loss: 10.3230 - accuracy10: 0.6090 - accuracy20: 0.6024 - accuracy30: 0.5868 - accuracy50: 0.5526 - val_loss: 11.4487 - val_accuracy10: 0.6318 - val_accuracy20: 0.5998 - val_accuracy30: 0.5633 - val_accuracy50: 0.4967 - 85s/epoch - 38ms/step
Epoch 20/50
2222/2222 - 84s - loss: 10.3115 - accuracy10: 0.6090 - accuracy20: 0.6032 - accuracy30: 0.5873 - accuracy50: 0.5526 - val_loss: 11.5689 - val_accuracy10: 0.6316 - val_accuracy20: 0.5983 - val_accuracy30: 0.5610 - val_accuracy50: 0.4939 - 84s/epoch - 38ms/step
Epoch 21/50
2222/2222 - 87s - loss: 10.2939 - accuracy10: 0.6093 - accuracy20: 0.6039 - accuracy30: 0.5881 - accuracy50: 0.5540 - val_loss: 11.5622 - val_accuracy10: 0.6343 - val_accuracy20: 0.5990 - val_accuracy30: 0.5602 - val_accuracy50: 0.4910 - 87s/epoch - 39ms/step
Epoch 22/50
2222/2222 - 84s - loss: 10.2865 - accuracy10: 0.6103 - accuracy20: 0.6034 - accuracy30: 0.5880 - accuracy50: 0.5539 - val_loss: 11.7228 - val_accuracy10: 0.6390 - val_accuracy20: 0.5992 - val_accuracy30: 0.5566 - val_accuracy50: 0.4867 - 84s/epoch - 38ms/step
Epoch 23/50
2222/2222 - 84s - loss: 10.2676 - accuracy10: 0.6117 - accuracy20: 0.6053 - accuracy30: 0.5893 - accuracy50: 0.5555 - val_loss: 11.5729 - val_accuracy10: 0.6366 - val_accuracy20: 0.5999 - val_accuracy30: 0.5606 - val_accuracy50: 0.4927 - 84s/epoch - 38ms/step
Epoch 24/50
2222/2222 - 88s - loss: 10.2479 - accuracy10: 0.6117 - accuracy20: 0.6059 - accuracy30: 0.5906 - accuracy50: 0.5565 - val_loss: 11.6686 - val_accuracy10: 0.6292 - val_accuracy20: 0.5952 - val_accuracy30: 0.5576 - val_accuracy50: 0.4906 - 88s/epoch - 40ms/step
Epoch 25/50
2222/2222 - 87s - loss: 10.2396 - accuracy10: 0.6124 - accuracy20: 0.6062 - accuracy30: 0.5906 - accuracy50: 0.5568 - val_loss: 11.7494 - val_accuracy10: 0.6328 - val_accuracy20: 0.5961 - val_accuracy30: 0.5561 - val_accuracy50: 0.4862 - 87s/epoch - 39ms/step
Epoch 26/50
2222/2222 - 88s - loss: 10.2267 - accuracy10: 0.6121 - accuracy20: 0.6062 - accuracy30: 0.5913 - accuracy50: 0.5578 - val_loss: 11.7451 - val_accuracy10: 0.6407 - val_accuracy20: 0.5990 - val_accuracy30: 0.5567 - val_accuracy50: 0.4862 - 88s/epoch - 40ms/step
Epoch 27/50
2222/2222 - 85s - loss: 10.2117 - accuracy10: 0.6128 - accuracy20: 0.6069 - accuracy30: 0.5918 - accuracy50: 0.5584 - val_loss: 11.6361 - val_accuracy10: 0.6327 - val_accuracy20: 0.5987 - val_accuracy30: 0.5606 - val_accuracy50: 0.4933 - 85s/epoch - 38ms/step
Epoch 28/50
2222/2222 - 85s - loss: 10.1981 - accuracy10: 0.6134 - accuracy20: 0.6077 - accuracy30: 0.5923 - accuracy50: 0.5588 - val_loss: 11.8078 - val_accuracy10: 0.6391 - val_accuracy20: 0.5988 - val_accuracy30: 0.5572 - val_accuracy50: 0.4864 - 85s/epoch - 38ms/step
Epoch 29/50
2222/2222 - 84s - loss: 10.1872 - accuracy10: 0.6140 - accuracy20: 0.6083 - accuracy30: 0.5930 - accuracy50: 0.5599 - val_loss: 11.8013 - val_accuracy10: 0.6407 - val_accuracy20: 0.5981 - val_accuracy30: 0.5561 - val_accuracy50: 0.4859 - 84s/epoch - 38ms/step
testing model: results/WBA/W1/deepVOL_L3/seq2seq
Evaluating performance on  test set...
5696/5696 - 93s - 93s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9078962
{'0': {'precision': 0.3932561333552659, 'recall': 0.5851624451856242, 'f1-score': 0.47038910671869294, 'support': 339099}, '1': {'precision': 0.7033123471147291, 'recall': 0.6671878328616209, 'f1-score': 0.6847739935421149, 'support': 788616}, '2': {'precision': 0.4999099042062561, 'recall': 0.31076961269599074, 'f1-score': 0.38327552151980976, 'support': 330309}, 'accuracy': 0.5673658321125029, 'macro avg': {'precision': 0.5321594615587503, 'recall': 0.5210399635810786, 'f1-score': 0.5128128739268726, 'support': 1458024}, 'weighted avg': {'precision': 0.585121281985297, 'recall': 0.5673658321125029, 'f1-score': 0.5666103971046412, 'support': 1458024}}
[[198428 108771  31900]
 [191674 526155  70787]
 [114475 113184 102650]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9632848
{'0': {'precision': 0.4624554575102414, 'recall': 0.48204874072564585, 'f1-score': 0.472048872521452, 'support': 431836}, '1': {'precision': 0.5665054922293208, 'recall': 0.7199606456612335, 'f1-score': 0.6340806772028, 'support': 607811}, '2': {'precision': 0.5338200877517127, 'recall': 0.30040131269166326, 'f1-score': 0.3844549061353841, 'support': 418377}, 'accuracy': 0.529104459185857, 'macro avg': {'precision': 0.5209270124970916, 'recall': 0.5008035663595142, 'f1-score': 0.4968614852865454, 'support': 1458024}, 'weighted avg': {'precision': 0.5263090535821678, 'recall': 0.529104459185857, 'f1-score': 0.5144606657158514, 'support': 1458024}}
[[208166 168055  55615]
 [116070 437600  54141]
 [125896 166800 125681]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0054255
{'0': {'precision': 0.4866356733980932, 'recall': 0.4121467232857181, 'f1-score': 0.4463044647179961, 'support': 485349}, '1': {'precision': 0.4706129418903806, 'recall': 0.7517057413441262, 'f1-score': 0.5788383262435627, 'support': 499343}, '2': {'precision': 0.5390442352960048, 'recall': 0.2839909408195516, 'f1-score': 0.37199790231948676, 'support': 473332}, 'accuracy': 0.48683423592478586, 'macro avg': {'precision': 0.49876428352815955, 'recall': 0.48261446848313194, 'f1-score': 0.46571356442701517, 'support': 1458024}, 'weighted avg': {'precision': 0.4981621027305367, 'recall': 0.48683423592478586, 'f1-score': 0.4675717293326731, 'support': 1458024}}
[[200035 213351  71963]
 [ 80998 375359  42986]
 [130024 208886 134422]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0632194
{'0': {'precision': 0.5023929515228241, 'recall': 0.34034748293398337, 'f1-score': 0.4057908449706207, 'support': 546847}, '1': {'precision': 0.3514819646380709, 'recall': 0.7763149061634842, 'f1-score': 0.48388268394862943, 'support': 372403}, '2': {'precision': 0.5305918396607279, 'recall': 0.26101296647573935, 'f1-score': 0.34990022542584587, 'support': 538774}, 'accuracy': 0.42238467953888276, 'macro avg': {'precision': 0.4614889186072076, 'recall': 0.4592251185244023, 'f1-score': 0.4131912514483653, 'support': 1458024}, 'weighted avg': {'precision': 0.47426798479303656, 'recall': 0.42238467953888276, 'f1-score': 0.4050838761253279, 'support': 1458024}}
[[186118 268831  91898]
 [ 50788 289102  32513]
 [133557 264590 140627]]
Evaluating performance on  train set...
2222/2222 - 35s - 35s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.77628136
{'0': {'precision': 0.421485803292105, 'recall': 0.5987455230737497, 'f1-score': 0.49471670049424415, 'support': 106658}, '1': {'precision': 0.7849192597066145, 'recall': 0.7788375108159042, 'f1-score': 0.7818665587194764, 'support': 357113}, '2': {'precision': 0.507305725075288, 'recall': 0.30365862963528156, 'f1-score': 0.3799125334860716, 'support': 104848}, 'accuracy': 0.6574384605509137, 'macro avg': {'precision': 0.5712369293580025, 'recall': 0.5604138878416451, 'f1-score': 0.5521652642332641, 'support': 568619}, 'weighted avg': {'precision': 0.6655593553184669, 'recall': 0.6574384605509137, 'f1-score': 0.6538882371785872, 'support': 568619}}
[[ 63861  34151   8646]
 [ 56705 278133  22275]
 [ 30948  42062  31838]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8387346
{'0': {'precision': 0.4955401603652198, 'recall': 0.49802738284845915, 'f1-score': 0.4967806584437116, 'support': 136874}, '1': {'precision': 0.6757862573487159, 'recall': 0.8237181861652333, 'f1-score': 0.7424551925090679, 'support': 296962}, '2': {'precision': 0.5502532928064843, 'recall': 0.28206079401704964, 'f1-score': 0.3729478646019826, 'support': 134783}, 'accuracy': 0.6169280308959074, 'macro avg': {'precision': 0.5738599035068067, 'recall': 0.5346021210102474, 'f1-score': 0.5373945718515873, 'support': 568619}, 'weighted avg': {'precision': 0.60264288043304, 'recall': 0.6169280308959074, 'f1-score': 0.5957317056875543, 'support': 568619}}
[[ 68167  54437  14270]
 [ 35546 244613  16803]
 [ 33848  62918  38017]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8937322
{'0': {'precision': 0.5268180348425461, 'recall': 0.4266380538151533, 'f1-score': 0.471465070649182, 'support': 156573}, '1': {'precision': 0.5910104001875753, 'recall': 0.8517832311791621, 'f1-score': 0.6978305661848354, 'support': 257454}, '2': {'precision': 0.5573202956096596, 'recall': 0.2551296315462637, 'f1-score': 0.3500250708862669, 'support': 154592}, 'accuracy': 0.5725028534044765, 'macro avg': {'precision': 0.5583829102132604, 'recall': 0.5111836388468597, 'f1-score': 0.5064402359067615, 'support': 568619}, 'weighted avg': {'precision': 0.5641751873894162, 'recall': 0.5725028534044765, 'f1-score': 0.5409405011998452, 'support': 568619}}
[[ 66800  71525  18248]
 [ 25079 219295  13080]
 [ 34920  80231  39441]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9772581
{'0': {'precision': 0.5441862065406251, 'recall': 0.34668580947788347, 'f1-score': 0.4235437461924176, 'support': 182488}, '1': {'precision': 0.47290096213025845, 'recall': 0.8728469619589491, 'f1-score': 0.6134435145158703, 'support': 205988}, '2': {'precision': 0.5513767443149536, 'recall': 0.22087452745874112, 'f1-score': 0.31540272526218166, 'support': 180143}, 'accuracy': 0.4974350136031332, 'macro avg': {'precision': 0.5228213043286124, 'recall': 0.48013576629852456, 'f1-score': 0.4507966619901565, 'support': 568619}, 'weighted avg': {'precision': 0.5206404230206904, 'recall': 0.4974350136031332, 'f1-score': 0.45807693193537713, 'support': 568619}}
[[ 63266  96041  23181]
 [ 16999 179796   9193]
 [ 35993 104361  39789]]
Evaluating performance on  val set...
641/641 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.81814444
{'0': {'precision': 0.3854918498094234, 'recall': 0.6242284963887065, 'f1-score': 0.4766369196831445, 'support': 30460}, '1': {'precision': 0.7924824461350104, 'recall': 0.727996308686123, 'f1-score': 0.7588718930212284, 'support': 104028}, '2': {'precision': 0.46645569620253163, 'recall': 0.30123641813413266, 'f1-score': 0.3660671785426023, 'support': 29359}, 'accuracy': 0.6322361715502878, 'macro avg': {'precision': 0.5481433307156551, 'recall': 0.5511537410696541, 'f1-score': 0.5338586637489917, 'support': 163847}, 'weighted avg': {'precision': 0.6584015480084349, 'recall': 0.6322361715502878, 'f1-score': 0.6360180665840277, 'support': 163847}}
[[19014  8908  2538]
 [20718 75732  7578]
 [ 9592 10923  8844]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8713779
{'0': {'precision': 0.4603865496944137, 'recall': 0.5181875872572661, 'f1-score': 0.48758001337537016, 'support': 39395}, '1': {'precision': 0.6852548015364917, 'recall': 0.7741390483243844, 'f1-score': 0.7269901815356361, 'support': 86416}, '2': {'precision': 0.5095288149536127, 'recall': 0.2931170470080976, 'f1-score': 0.3721481382579235, 'support': 38036}, 'accuracy': 0.6009325773434973, 'macro avg': {'precision': 0.5517233887281727, 'recall': 0.528481227529916, 'f1-score': 0.5289061110563099, 'support': 163847}, 'weighted avg': {'precision': 0.5903943621815748, 'recall': 0.6009325773434973, 'f1-score': 0.5870527061300153, 'support': 163847}}
[[20414 14436  4545]
 [13331 66898  6187]
 [10596 16291 11149]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.91714555
{'0': {'precision': 0.49437261421007267, 'recall': 0.441876334499989, 'f1-score': 0.46665271869260994, 'support': 45429}, '1': {'precision': 0.6011135434471867, 'recall': 0.8071837961906552, 'f1-score': 0.689071971216097, 'support': 74501}, '2': {'precision': 0.5178225076505323, 'recall': 0.27356149099437577, 'f1-score': 0.3579963646115796, 'support': 43917}, 'accuracy': 0.5628665767453783, 'macro avg': {'precision': 0.5377695551025973, 'recall': 0.5075405405616733, 'f1-score': 0.5045736848400955, 'support': 163847}, 'weighted avg': {'precision': 0.5491929950490194, 'recall': 0.5628665767453783, 'f1-score': 0.5386625548817113, 'support': 163847}}
[[20074 19154  6201]
 [ 9379 60136  4986]
 [11152 20751 12014]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.98638594
{'0': {'precision': 0.5156627159556291, 'recall': 0.3588035478392149, 'f1-score': 0.42316466542771614, 'support': 52990}, '1': {'precision': 0.48357050200431095, 'recall': 0.8362428106394103, 'f1-score': 0.6127872053788824, 'support': 59289}, '2': {'precision': 0.5233361966703481, 'recall': 0.2480995966490847, 'f1-score': 0.3366177728079984, 'support': 51568}, 'accuracy': 0.4967256037644876, 'macro avg': {'precision': 0.5075231382100961, 'recall': 0.48104865170923666, 'f1-score': 0.45752321453819905, 'support': 163847}, 'weighted avg': {'precision': 0.5064650546041056, 'recall': 0.4967256037644876, 'f1-score': 0.46454156346400055, 'support': 163847}}
[[19013 25934  8043]
 [ 6099 49580  3610]
 [11759 27015 12794]]
training model: results/WBA/W2/deepLOB_L1/seq2seq
Epoch 1/50
1542/1542 - 42s - loss: 12.1328 - accuracy10: 0.4535 - accuracy20: 0.4680 - accuracy30: 0.4693 - accuracy50: 0.4613 - val_loss: 15.0233 - val_accuracy10: 0.6248 - val_accuracy20: 0.5285 - val_accuracy30: 0.4628 - val_accuracy50: 0.3716 - 42s/epoch - 27ms/step
Epoch 2/50
1542/1542 - 35s - loss: 11.9918 - accuracy10: 0.4570 - accuracy20: 0.4743 - accuracy30: 0.4796 - accuracy50: 0.4702 - val_loss: 14.9967 - val_accuracy10: 0.5109 - val_accuracy20: 0.4478 - val_accuracy30: 0.4068 - val_accuracy50: 0.3534 - 35s/epoch - 23ms/step
Epoch 3/50
1542/1542 - 36s - loss: 11.9146 - accuracy10: 0.4680 - accuracy20: 0.4853 - accuracy30: 0.4884 - accuracy50: 0.4749 - val_loss: 14.4827 - val_accuracy10: 0.5530 - val_accuracy20: 0.4929 - val_accuracy30: 0.4513 - val_accuracy50: 0.3900 - 36s/epoch - 23ms/step
Epoch 4/50
1542/1542 - 36s - loss: 11.8007 - accuracy10: 0.4938 - accuracy20: 0.5041 - accuracy30: 0.5025 - accuracy50: 0.4839 - val_loss: 13.3844 - val_accuracy10: 0.5510 - val_accuracy20: 0.5000 - val_accuracy30: 0.4608 - val_accuracy50: 0.4015 - 36s/epoch - 23ms/step
Epoch 5/50
1542/1542 - 35s - loss: 11.5904 - accuracy10: 0.5188 - accuracy20: 0.5218 - accuracy30: 0.5159 - accuracy50: 0.4945 - val_loss: 13.2522 - val_accuracy10: 0.5423 - val_accuracy20: 0.5109 - val_accuracy30: 0.4826 - val_accuracy50: 0.4310 - 35s/epoch - 23ms/step
Epoch 6/50
1542/1542 - 37s - loss: 11.4744 - accuracy10: 0.5284 - accuracy20: 0.5309 - accuracy30: 0.5238 - accuracy50: 0.5005 - val_loss: 12.9672 - val_accuracy10: 0.5329 - val_accuracy20: 0.5133 - val_accuracy30: 0.4942 - val_accuracy50: 0.4548 - 37s/epoch - 24ms/step
Epoch 7/50
1542/1542 - 34s - loss: 11.3853 - accuracy10: 0.5440 - accuracy20: 0.5401 - accuracy30: 0.5282 - accuracy50: 0.5026 - val_loss: 12.6154 - val_accuracy10: 0.5445 - val_accuracy20: 0.5253 - val_accuracy30: 0.5059 - val_accuracy50: 0.4624 - 34s/epoch - 22ms/step
Epoch 8/50
1542/1542 - 38s - loss: 11.3012 - accuracy10: 0.5496 - accuracy20: 0.5454 - accuracy30: 0.5326 - accuracy50: 0.5063 - val_loss: 12.4121 - val_accuracy10: 0.5456 - val_accuracy20: 0.5312 - val_accuracy30: 0.5154 - val_accuracy50: 0.4764 - 38s/epoch - 25ms/step
Epoch 9/50
1542/1542 - 36s - loss: 11.2130 - accuracy10: 0.5586 - accuracy20: 0.5520 - accuracy30: 0.5382 - accuracy50: 0.5109 - val_loss: 12.7398 - val_accuracy10: 0.5548 - val_accuracy20: 0.5335 - val_accuracy30: 0.5129 - val_accuracy50: 0.4715 - 36s/epoch - 24ms/step
Epoch 10/50
1542/1542 - 35s - loss: 11.1435 - accuracy10: 0.5659 - accuracy20: 0.5571 - accuracy30: 0.5417 - accuracy50: 0.5133 - val_loss: 12.9673 - val_accuracy10: 0.5819 - val_accuracy20: 0.5520 - val_accuracy30: 0.5256 - val_accuracy50: 0.4742 - 35s/epoch - 23ms/step
Epoch 11/50
1542/1542 - 33s - loss: 11.0738 - accuracy10: 0.5716 - accuracy20: 0.5622 - accuracy30: 0.5463 - accuracy50: 0.5170 - val_loss: 12.9651 - val_accuracy10: 0.5852 - val_accuracy20: 0.5553 - val_accuracy30: 0.5283 - val_accuracy50: 0.4769 - 33s/epoch - 21ms/step
Epoch 12/50
1542/1542 - 36s - loss: 11.0194 - accuracy10: 0.5755 - accuracy20: 0.5660 - accuracy30: 0.5496 - accuracy50: 0.5198 - val_loss: 13.0482 - val_accuracy10: 0.6033 - val_accuracy20: 0.5680 - val_accuracy30: 0.5365 - val_accuracy50: 0.4799 - 36s/epoch - 23ms/step
Epoch 13/50
1542/1542 - 31s - loss: 10.9823 - accuracy10: 0.5780 - accuracy20: 0.5678 - accuracy30: 0.5516 - accuracy50: 0.5213 - val_loss: 13.1105 - val_accuracy10: 0.5950 - val_accuracy20: 0.5623 - val_accuracy30: 0.5323 - val_accuracy50: 0.4773 - 31s/epoch - 20ms/step
Epoch 14/50
1542/1542 - 33s - loss: 10.9345 - accuracy10: 0.5821 - accuracy20: 0.5716 - accuracy30: 0.5553 - accuracy50: 0.5245 - val_loss: 13.2359 - val_accuracy10: 0.5921 - val_accuracy20: 0.5603 - val_accuracy30: 0.5311 - val_accuracy50: 0.4756 - 33s/epoch - 21ms/step
Epoch 15/50
1542/1542 - 32s - loss: 10.9020 - accuracy10: 0.5846 - accuracy20: 0.5740 - accuracy30: 0.5570 - accuracy50: 0.5254 - val_loss: 13.1961 - val_accuracy10: 0.6033 - val_accuracy20: 0.5697 - val_accuracy30: 0.5377 - val_accuracy50: 0.4783 - 32s/epoch - 21ms/step
Epoch 16/50
1542/1542 - 31s - loss: 10.8710 - accuracy10: 0.5873 - accuracy20: 0.5762 - accuracy30: 0.5590 - accuracy50: 0.5271 - val_loss: 13.1815 - val_accuracy10: 0.5887 - val_accuracy20: 0.5599 - val_accuracy30: 0.5318 - val_accuracy50: 0.4793 - 31s/epoch - 20ms/step
Epoch 17/50
1542/1542 - 36s - loss: 10.8345 - accuracy10: 0.5891 - accuracy20: 0.5786 - accuracy30: 0.5614 - accuracy50: 0.5292 - val_loss: 13.1356 - val_accuracy10: 0.5723 - val_accuracy20: 0.5487 - val_accuracy30: 0.5227 - val_accuracy50: 0.4731 - 36s/epoch - 24ms/step
Epoch 18/50
1542/1542 - 36s - loss: 10.8081 - accuracy10: 0.5907 - accuracy20: 0.5803 - accuracy30: 0.5630 - accuracy50: 0.5296 - val_loss: 13.4979 - val_accuracy10: 0.5348 - val_accuracy20: 0.5178 - val_accuracy30: 0.4970 - val_accuracy50: 0.4572 - 36s/epoch - 23ms/step
testing model: results/WBA/W2/deepLOB_L1/seq2seq
Evaluating performance on  test set...
4353/4353 - 44s - 44s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.88135237
{'0': {'precision': 0.3206681188048514, 'recall': 0.675463897702144, 'f1-score': 0.43488158960347606, 'support': 187218}, '1': {'precision': 0.8183417753118432, 'recall': 0.5491527438723719, 'f1-score': 0.657252552070154, 'support': 740213}, '2': {'precision': 0.38154057069125413, 'recall': 0.4557549355924584, 'f1-score': 0.4153587279910257, 'support': 186857}, 'accuracy': 0.5547129646913544, 'macro avg': {'precision': 0.5068501549359828, 'recall': 0.5601238590556581, 'f1-score': 0.502497623221552, 'support': 1114288}, 'weighted avg': {'precision': 0.6614767374439712, 'recall': 0.5547129646913544, 'f1-score': 0.5793270955122083, 'support': 1114288}}
[[126459  37204  23555]
 [219236 406490 114487]
 [ 48666  53030  85161]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9169948
{'0': {'precision': 0.3872560350545718, 'recall': 0.6410932580203728, 'f1-score': 0.4828461202298775, 'support': 240419}, '1': {'precision': 0.7258382923700298, 'recall': 0.5658573774337321, 'f1-score': 0.6359407438810745, 'support': 630924}, '2': {'precision': 0.446098111996863, 'recall': 0.4120768075078722, 'f1-score': 0.42841309306276504, 'support': 242945}, 'accuracy': 0.5485619516677914, 'macro avg': {'precision': 0.5197308131404882, 'recall': 0.539675814320659, 'f1-score': 0.5157333190579056, 'support': 1114288}, 'weighted avg': {'precision': 0.5917947723444313, 'recall': 0.5485619516677914, 'f1-score': 0.5576623621237089, 'support': 1114288}}
[[154131  56965  29323]
 [178929 357013  94982]
 [ 64948  77885 100112]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.95026106
{'0': {'precision': 0.42798208210827704, 'recall': 0.6006286477592272, 'f1-score': 0.49981648407456286, 'support': 277739}, '1': {'precision': 0.6498345197079243, 'recall': 0.5858645301314098, 'f1-score': 0.6161937173964067, 'support': 555666}, '2': {'precision': 0.47423773395841534, 'recall': 0.377427612208642, 'f1-score': 0.4203303946854549, 'support': 280883}, 'accuracy': 0.5370030010194851, 'macro avg': {'precision': 0.5173514452582055, 'recall': 0.5213069300330929, 'f1-score': 0.5121135320521415, 'support': 1114288}, 'weighted avg': {'precision': 0.5502738799647271, 'recall': 0.5370030010194851, 'f1-score': 0.5378143629758297, 'support': 1114288}}
[[166818  76403  34518]
 [147108 325545  83013]
 [ 75852  99018 106013]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0218328
{'0': {'precision': 0.4743502608018892, 'recall': 0.5333039668698346, 'f1-score': 0.5021025443537409, 'support': 333714}, '1': {'precision': 0.526144251197848, 'recall': 0.6093020241612178, 'f1-score': 0.5646779847056327, 'support': 447494}, '2': {'precision': 0.4947255951249106, 'recall': 0.32807133421400264, 'f1-score': 0.394520884254763, 'support': 333080}, 'accuracy': 0.5024769179960656, 'macro avg': {'precision': 0.4984067023748826, 'recall': 0.490225775081685, 'f1-score': 0.4871004711047122, 'support': 1114288}, 'weighted avg': {'precision': 0.5012410792389191, 'recall': 0.5024769179960656, 'f1-score': 0.4950745899640875, 'support': 1114288}}
[[177971 112262  43481]
 [106712 272659  68123]
 [ 90506 133300 109274]]
Evaluating performance on  train set...
1542/1542 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.92240155
{'0': {'precision': 0.35159009082550674, 'recall': 0.5466533066132264, 'f1-score': 0.4279416609579191, 'support': 74850}, '1': {'precision': 0.7298886875011442, 'recall': 0.6443556403190484, 'f1-score': 0.6844603729853853, 'support': 247486}, '2': {'precision': 0.3882114502026733, 'recall': 0.32089107951320145, 'f1-score': 0.3513556534196424, 'support': 72227}, 'accuracy': 0.5666091346629055, 'macro avg': {'precision': 0.489896742843108, 'recall': 0.5039666754818254, 'f1-score': 0.48791922912098235, 'support': 394563}, 'weighted avg': {'precision': 0.5955781419620843, 'recall': 0.5666091346629055, 'f1-score': 0.5748211514280401, 'support': 394563}}
[[ 40917  26630   7303]
 [ 58795 159469  29222]
 [ 16665  32385  23177]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9906388
{'0': {'precision': 0.4109142655058015, 'recall': 0.512955001734341, 'f1-score': 0.45629946844071273, 'support': 95137}, '1': {'precision': 0.6276369257541677, 'recall': 0.6555753222017036, 'f1-score': 0.6413019833350674, 'support': 206858}, '2': {'precision': 0.45184565162802376, 'recall': 0.2915802437127301, 'f1-score': 0.3544381922877422, 'support': 92568}, 'accuracy': 0.5357902286833788, 'macro avg': {'precision': 0.496798947629331, 'recall': 0.48670352254959165, 'f1-score': 0.4840132146878408, 'support': 394563}, 'weighted avg': {'precision': 0.5341385734216942, 'recall': 0.5357902286833788, 'f1-score': 0.5293933865604762, 'support': 394563}}
[[ 48801  37082   9254]
 [ 47757 135611  23490]
 [ 22204  43373  26991]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0365192
{'0': {'precision': 0.44246147011584597, 'recall': 0.4768793046296637, 'f1-score': 0.4590261282660333, 'support': 108604}, '1': {'precision': 0.5505956343103725, 'recall': 0.6676816878670637, 'f1-score': 0.6035122147583465, 'support': 179635}, '2': {'precision': 0.47943897044037803, 'recall': 0.26909258492908467, 'f1-score': 0.34471084337349395, 'support': 106324}, 'accuracy': 0.5077541482602271, 'macro avg': {'precision': 0.4908320249555322, 'recall': 0.47121785914193737, 'f1-score': 0.4690830621326246, 'support': 394563}, 'weighted avg': {'precision': 0.5016567730955712, 'recall': 0.5077541482602271, 'f1-score': 0.49400229125174744, 'support': 394563}}
[[ 51791  45839  10974]
 [ 39605 119939  20091]
 [ 25656  52057  28611]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1103573
{'0': {'precision': 0.47460939219224507, 'recall': 0.4240870228647386, 'f1-score': 0.447928089588941, 'support': 127139}, '1': {'precision': 0.4387935785203856, 'recall': 0.68069287851502, 'f1-score': 0.5336083561527201, 'support': 142709}, '2': {'precision': 0.5019806633543709, 'recall': 0.23979473198893478, 'f1-score': 0.32455193145622957, 'support': 124715}, 'accuracy': 0.458646654653376, 'macro avg': {'precision': 0.47179454468900045, 'recall': 0.44819154445623116, 'f1-score': 0.43536279239929687, 'support': 394563}, 'weighted avg': {'precision': 0.47030683247348565, 'recall': 0.458646654653376, 'f1-score': 0.4399204649498573, 'support': 394563}}
[[53918 59646 13575]
 [29473 97141 16095]
 [30214 64595 29906]]
Evaluating performance on  val set...
482/482 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.91464734
{'0': {'precision': 0.32168018077894456, 'recall': 0.6555600704320736, 'f1-score': 0.4315841098577734, 'support': 22149}, '1': {'precision': 0.7793990201800464, 'recall': 0.5563930659192202, 'f1-score': 0.6492809995285244, 'support': 79203}, '2': {'precision': 0.4007211871850585, 'recall': 0.39475362054831953, 'f1-score': 0.39771501984445623, 'support': 21958}, 'accuracy': 0.5454221068850864, 'macro avg': {'precision': 0.5006001293813498, 'recall': 0.5355689189665378, 'f1-score': 0.49286004307691805, 'support': 123310}, 'weighted avg': {'precision': 0.6297516077171564, 'recall': 0.5454221068850864, 'f1-score': 0.5653814440081268, 'support': 123310}}
[[14520  5169  2460]
 [24632 44068 10503]
 [ 5986  7304  8668]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.96486694
{'0': {'precision': 0.38492717183977804, 'recall': 0.6174251642735459, 'f1-score': 0.47421193874417544, 'support': 28763}, '1': {'precision': 0.6797121575558641, 'recall': 0.5695116054158608, 'f1-score': 0.6197511983753073, 'support': 66176}, '2': {'precision': 0.46481336585814886, 'recall': 0.35596207394875046, 'f1-score': 0.4031697872170545, 'support': 28371}, 'accuracy': 0.5315546184413268, 'macro avg': {'precision': 0.509817565084597, 'recall': 0.5142996145460524, 'f1-score': 0.49904430811217915, 'support': 123310}, 'weighted avg': {'precision': 0.561507679708101, 'recall': 0.5315546184413268, 'f1-score': 0.5359722920356671, 'support': 123310}}
[[17759  7710  3294]
 [20154 37688  8334]
 [ 8223 10049 10099]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0005926
{'0': {'precision': 0.41914336625822207, 'recall': 0.5753759739083167, 'f1-score': 0.4849880999350905, 'support': 33114}, '1': {'precision': 0.6009917237442922, 'recall': 0.5865640722107133, 'f1-score': 0.5936902569885557, 'support': 57443}, '2': {'precision': 0.4942402129514893, 'recall': 0.32879430891826705, 'f1-score': 0.3948883429283855, 'support': 32753}, 'accuracy': 0.5150920444408401, 'macro avg': {'precision': 0.5047917676513346, 'recall': 0.49691145167909895, 'f1-score': 0.49118889995067727, 'support': 123310}, 'weighted avg': {'precision': 0.5238028603691369, 'recall': 0.5150920444408401, 'f1-score': 0.5116942929963313, 'support': 123310}}
[[19053 10048  4013]
 [16742 33694  7007]
 [ 9662 12322 10769]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.067225
{'0': {'precision': 0.4530601130097352, 'recall': 0.5139260708401977, 'f1-score': 0.48157751914611346, 'support': 38848}, '1': {'precision': 0.482863008455409, 'recall': 0.6077873160476525, 'f1-score': 0.5381706773186481, 'support': 45664}, '2': {'precision': 0.5102687801516196, 'recall': 0.2862518686530234, 'f1-score': 0.36675858197249145, 'support': 38798}, 'accuracy': 0.47704971210769603, 'macro avg': {'precision': 0.4820639672055879, 'recall': 0.46932175184695785, 'f1-score': 0.46216892614575106, 'support': 123310}, 'weighted avg': {'precision': 0.48209669792095144, 'recall': 0.47704971210769603, 'f1-score': 0.46640863463008425, 'support': 123310}}
[[19965 13738  5145]
 [12396 27754  5514]
 [11706 15986 11106]]
training model: results/WBA/W2/deepOF_L1/seq2seq
Epoch 1/50
1542/1542 - 37s - loss: 12.6551 - accuracy10: 0.4268 - accuracy20: 0.4382 - accuracy30: 0.4395 - accuracy50: 0.4318 - val_loss: 14.6855 - val_accuracy10: 0.6339 - val_accuracy20: 0.5451 - val_accuracy30: 0.4787 - val_accuracy50: 0.3869 - 37s/epoch - 24ms/step
Epoch 2/50
1542/1542 - 33s - loss: 12.5715 - accuracy10: 0.4311 - accuracy20: 0.4435 - accuracy30: 0.4446 - accuracy50: 0.4344 - val_loss: 14.1176 - val_accuracy10: 0.6418 - val_accuracy20: 0.5527 - val_accuracy30: 0.4866 - val_accuracy50: 0.3949 - 33s/epoch - 21ms/step
Epoch 3/50
1542/1542 - 30s - loss: 12.5199 - accuracy10: 0.4420 - accuracy20: 0.4514 - accuracy30: 0.4507 - accuracy50: 0.4369 - val_loss: 13.4430 - val_accuracy10: 0.6379 - val_accuracy20: 0.5546 - val_accuracy30: 0.4910 - val_accuracy50: 0.4012 - 30s/epoch - 19ms/step
Epoch 4/50
1542/1542 - 31s - loss: 12.4673 - accuracy10: 0.4533 - accuracy20: 0.4587 - accuracy30: 0.4566 - accuracy50: 0.4403 - val_loss: 13.4444 - val_accuracy10: 0.6380 - val_accuracy20: 0.5553 - val_accuracy30: 0.4925 - val_accuracy50: 0.4038 - 31s/epoch - 20ms/step
Epoch 5/50
1542/1542 - 34s - loss: 12.4269 - accuracy10: 0.4611 - accuracy20: 0.4622 - accuracy30: 0.4590 - accuracy50: 0.4427 - val_loss: 13.3136 - val_accuracy10: 0.6378 - val_accuracy20: 0.5576 - val_accuracy30: 0.4956 - val_accuracy50: 0.4059 - 34s/epoch - 22ms/step
Epoch 6/50
1542/1542 - 32s - loss: 12.3891 - accuracy10: 0.4675 - accuracy20: 0.4676 - accuracy30: 0.4633 - accuracy50: 0.4457 - val_loss: 13.2553 - val_accuracy10: 0.6393 - val_accuracy20: 0.5581 - val_accuracy30: 0.4960 - val_accuracy50: 0.4072 - 32s/epoch - 21ms/step
Epoch 7/50
1542/1542 - 34s - loss: 12.3485 - accuracy10: 0.4726 - accuracy20: 0.4713 - accuracy30: 0.4666 - accuracy50: 0.4495 - val_loss: 13.1825 - val_accuracy10: 0.6364 - val_accuracy20: 0.5579 - val_accuracy30: 0.4977 - val_accuracy50: 0.4098 - 34s/epoch - 22ms/step
Epoch 8/50
1542/1542 - 33s - loss: 12.3045 - accuracy10: 0.4765 - accuracy20: 0.4749 - accuracy30: 0.4701 - accuracy50: 0.4525 - val_loss: 13.2107 - val_accuracy10: 0.6350 - val_accuracy20: 0.5565 - val_accuracy30: 0.4979 - val_accuracy50: 0.4112 - 33s/epoch - 21ms/step
Epoch 9/50
1542/1542 - 33s - loss: 12.2722 - accuracy10: 0.4793 - accuracy20: 0.4764 - accuracy30: 0.4719 - accuracy50: 0.4552 - val_loss: 13.2120 - val_accuracy10: 0.6388 - val_accuracy20: 0.5580 - val_accuracy30: 0.4988 - val_accuracy50: 0.4132 - 33s/epoch - 21ms/step
Epoch 10/50
1542/1542 - 31s - loss: 12.2271 - accuracy10: 0.4838 - accuracy20: 0.4808 - accuracy30: 0.4749 - accuracy50: 0.4580 - val_loss: 13.1852 - val_accuracy10: 0.6403 - val_accuracy20: 0.5589 - val_accuracy30: 0.4995 - val_accuracy50: 0.4134 - 31s/epoch - 20ms/step
Epoch 11/50
1542/1542 - 30s - loss: 12.1927 - accuracy10: 0.4857 - accuracy20: 0.4832 - accuracy30: 0.4773 - accuracy50: 0.4609 - val_loss: 13.2479 - val_accuracy10: 0.6417 - val_accuracy20: 0.5607 - val_accuracy30: 0.5009 - val_accuracy50: 0.4143 - 30s/epoch - 20ms/step
Epoch 12/50
1542/1542 - 33s - loss: 12.1515 - accuracy10: 0.4844 - accuracy20: 0.4828 - accuracy30: 0.4782 - accuracy50: 0.4627 - val_loss: 13.1882 - val_accuracy10: 0.6408 - val_accuracy20: 0.5611 - val_accuracy30: 0.5014 - val_accuracy50: 0.4154 - 33s/epoch - 21ms/step
Epoch 13/50
1542/1542 - 32s - loss: 12.1220 - accuracy10: 0.4875 - accuracy20: 0.4856 - accuracy30: 0.4806 - accuracy50: 0.4647 - val_loss: 13.2492 - val_accuracy10: 0.6424 - val_accuracy20: 0.5624 - val_accuracy30: 0.5027 - val_accuracy50: 0.4158 - 32s/epoch - 20ms/step
Epoch 14/50
1542/1542 - 33s - loss: 12.1060 - accuracy10: 0.4876 - accuracy20: 0.4867 - accuracy30: 0.4822 - accuracy50: 0.4667 - val_loss: 13.2383 - val_accuracy10: 0.6412 - val_accuracy20: 0.5622 - val_accuracy30: 0.5028 - val_accuracy50: 0.4161 - 33s/epoch - 22ms/step
Epoch 15/50
1542/1542 - 31s - loss: 12.0736 - accuracy10: 0.4893 - accuracy20: 0.4884 - accuracy30: 0.4840 - accuracy50: 0.4689 - val_loss: 13.1978 - val_accuracy10: 0.6410 - val_accuracy20: 0.5625 - val_accuracy30: 0.5036 - val_accuracy50: 0.4183 - 31s/epoch - 20ms/step
Epoch 16/50
1542/1542 - 31s - loss: 12.0458 - accuracy10: 0.4917 - accuracy20: 0.4908 - accuracy30: 0.4857 - accuracy50: 0.4697 - val_loss: 13.2094 - val_accuracy10: 0.6414 - val_accuracy20: 0.5632 - val_accuracy30: 0.5042 - val_accuracy50: 0.4178 - 31s/epoch - 20ms/step
Epoch 17/50
1542/1542 - 31s - loss: 12.0158 - accuracy10: 0.4959 - accuracy20: 0.4936 - accuracy30: 0.4884 - accuracy50: 0.4728 - val_loss: 13.1600 - val_accuracy10: 0.6394 - val_accuracy20: 0.5625 - val_accuracy30: 0.5040 - val_accuracy50: 0.4183 - 31s/epoch - 20ms/step
Epoch 18/50
1542/1542 - 30s - loss: 11.9899 - accuracy10: 0.4976 - accuracy20: 0.4954 - accuracy30: 0.4901 - accuracy50: 0.4743 - val_loss: 13.1658 - val_accuracy10: 0.6417 - val_accuracy20: 0.5651 - val_accuracy30: 0.5068 - val_accuracy50: 0.4195 - 30s/epoch - 19ms/step
Epoch 19/50
1542/1542 - 35s - loss: 11.9665 - accuracy10: 0.5002 - accuracy20: 0.4980 - accuracy30: 0.4922 - accuracy50: 0.4764 - val_loss: 13.1650 - val_accuracy10: 0.6403 - val_accuracy20: 0.5625 - val_accuracy30: 0.5051 - val_accuracy50: 0.4196 - 35s/epoch - 22ms/step
Epoch 20/50
1542/1542 - 33s - loss: 11.9378 - accuracy10: 0.5028 - accuracy20: 0.5003 - accuracy30: 0.4944 - accuracy50: 0.4786 - val_loss: 13.1952 - val_accuracy10: 0.6405 - val_accuracy20: 0.5637 - val_accuracy30: 0.5062 - val_accuracy50: 0.4220 - 33s/epoch - 22ms/step
Epoch 21/50
1542/1542 - 33s - loss: 11.9405 - accuracy10: 0.5013 - accuracy20: 0.4991 - accuracy30: 0.4936 - accuracy50: 0.4783 - val_loss: 13.2717 - val_accuracy10: 0.6396 - val_accuracy20: 0.5625 - val_accuracy30: 0.5057 - val_accuracy50: 0.4218 - 33s/epoch - 22ms/step
Epoch 22/50
1542/1542 - 35s - loss: 11.9101 - accuracy10: 0.5049 - accuracy20: 0.5021 - accuracy30: 0.4956 - accuracy50: 0.4803 - val_loss: 13.2711 - val_accuracy10: 0.6399 - val_accuracy20: 0.5628 - val_accuracy30: 0.5054 - val_accuracy50: 0.4221 - 35s/epoch - 22ms/step
Epoch 23/50
1542/1542 - 34s - loss: 11.8803 - accuracy10: 0.5066 - accuracy20: 0.5043 - accuracy30: 0.4984 - accuracy50: 0.4822 - val_loss: 13.2230 - val_accuracy10: 0.6401 - val_accuracy20: 0.5629 - val_accuracy30: 0.5061 - val_accuracy50: 0.4231 - 34s/epoch - 22ms/step
Epoch 24/50
1542/1542 - 34s - loss: 11.8687 - accuracy10: 0.5062 - accuracy20: 0.5046 - accuracy30: 0.4992 - accuracy50: 0.4841 - val_loss: 13.1852 - val_accuracy10: 0.6392 - val_accuracy20: 0.5632 - val_accuracy30: 0.5072 - val_accuracy50: 0.4245 - 34s/epoch - 22ms/step
Epoch 25/50
1542/1542 - 34s - loss: 11.8405 - accuracy10: 0.5083 - accuracy20: 0.5070 - accuracy30: 0.5006 - accuracy50: 0.4850 - val_loss: 13.2366 - val_accuracy10: 0.6380 - val_accuracy20: 0.5627 - val_accuracy30: 0.5065 - val_accuracy50: 0.4244 - 34s/epoch - 22ms/step
Epoch 26/50
1542/1542 - 34s - loss: 11.8314 - accuracy10: 0.5091 - accuracy20: 0.5074 - accuracy30: 0.5022 - accuracy50: 0.4864 - val_loss: 13.2744 - val_accuracy10: 0.6403 - val_accuracy20: 0.5629 - val_accuracy30: 0.5068 - val_accuracy50: 0.4235 - 34s/epoch - 22ms/step
Epoch 27/50
1542/1542 - 33s - loss: 11.7998 - accuracy10: 0.5109 - accuracy20: 0.5093 - accuracy30: 0.5036 - accuracy50: 0.4877 - val_loss: 13.2329 - val_accuracy10: 0.6394 - val_accuracy20: 0.5632 - val_accuracy30: 0.5063 - val_accuracy50: 0.4237 - 33s/epoch - 21ms/step
testing model: results/WBA/W2/deepOF_L1/seq2seq
Evaluating performance on  test set...
4353/4353 - 40s - 40s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8416077
{'0': {'precision': 0.4446584445570761, 'recall': 0.21087294423049188, 'f1-score': 0.2860776371185716, 'support': 187217}, '1': {'precision': 0.7080477492561764, 'recall': 0.8735065089460857, 'f1-score': 0.7821221616802719, 'support': 740212}, '2': {'precision': 0.39723624578180233, 'recall': 0.2387639547454162, 'f1-score': 0.29825681480119665, 'support': 186854}, 'accuracy': 0.655733776787405, 'macro avg': {'precision': 0.5166474798650184, 'recall': 0.44104780264066457, 'f1-score': 0.45548553786668, 'support': 1114283}, 'weighted avg': {'precision': 0.6116742713084269, 'recall': 0.655733776787405, 'f1-score': 0.6176395811503611, 'support': 1114283}}
[[ 39479 133154  14584]
 [ 40519 646580  53113]
 [  8787 133453  44614]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9190356
{'0': {'precision': 0.5258323897105079, 'recall': 0.19122112321040854, 'f1-score': 0.28045399225858403, 'support': 240418}, '1': {'precision': 0.6093972920306042, 'recall': 0.8807889393792904, 'f1-score': 0.7203802896506666, 'support': 630923}, '2': {'precision': 0.47092289892390804, 'recall': 0.22282684756032303, 'f1-score': 0.3025133069755096, 'support': 242942}, 'accuracy': 0.5885551516087026, 'macro avg': {'precision': 0.5353841935550068, 'recall': 0.4316123033833406, 'f1-score': 0.43444919629492, 'support': 1114283}, 'weighted avg': {'precision': 0.56117637086774, 'recall': 0.5885551516087026, 'f1-score': 0.5343560560659509, 'support': 1114283}}
[[ 45973 177172  17273]
 [ 31667 555710  43546]
 [  9789 179019  54134]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.97690374
{'0': {'precision': 0.5666748406081412, 'recall': 0.1664092288747988, 'f1-score': 0.25726905596205923, 'support': 277737}, '1': {'precision': 0.534934139317434, 'recall': 0.8912026289173712, 'f1-score': 0.6685680109733444, 'support': 555666}, '2': {'precision': 0.5106233817219881, 'recall': 0.194485189404728, 'f1-score': 0.28168338657405617, 'support': 280880}, 'accuracy': 0.5349233543004784, 'macro avg': {'precision': 0.5374107872158544, 'recall': 0.417365682398966, 'f1-score': 0.4025068178364866, 'support': 1114283}, 'weighted avg': {'precision': 0.5367174937803204, 'recall': 0.5349233543004784, 'f1-score': 0.4685280829036876, 'support': 1114283}}
[[ 46218 213820  17699]
 [ 25800 495211  34655]
 [  9542 216711  54627]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0640695
{'0': {'precision': 0.6108771882319493, 'recall': 0.13520559521026987, 'f1-score': 0.22140710298718025, 'support': 333714}, '1': {'precision': 0.42638944464334605, 'recall': 0.9048744896568215, 'f1-score': 0.579643031221348, 'support': 447493}, '2': {'precision': 0.5530067649456821, 'recall': 0.15069233448222027, 'f1-score': 0.23684520972635772, 'support': 333076}, 'accuracy': 0.4489317345773022, 'macro avg': {'precision': 0.5300911326069925, 'recall': 0.3969241397831038, 'f1-score': 0.345965114644962, 'support': 1114283}, 'weighted avg': {'precision': 0.5194890732304717, 'recall': 0.4489317345773022, 'f1-score': 0.3698883533280279, 'support': 1114283}}
[[ 45120 271590  17004]
 [ 19002 404925  23566]
 [  9739 273145  50192]]
Evaluating performance on  train set...
1542/1542 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.87431544
{'0': {'precision': 0.4507850658130743, 'recall': 0.21826149694038424, 'f1-score': 0.2941171175226178, 'support': 74846}, '1': {'precision': 0.6702299798198553, 'recall': 0.8806400892470989, 'f1-score': 0.7611616227782874, 'support': 247403}, '2': {'precision': 0.43743045321945206, 'recall': 0.2011394908246097, 'f1-score': 0.27556742828994735, 'support': 72313}, 'accuracy': 0.6304560499997466, 'macro avg': {'precision': 0.519481832950794, 'recall': 0.43334702567069766, 'f1-score': 0.4436153895302842, 'support': 394562}, 'weighted avg': {'precision': 0.5859364943833295, 'recall': 0.6304560499997466, 'f1-score': 0.5835692899474493, 'support': 394562}}
[[ 16336  54221   4289]
 [ 15113 217873  14417]
 [  4790  52978  14545]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.96058714
{'0': {'precision': 0.5245824316075689, 'recall': 0.1985466306824745, 'f1-score': 0.28806496583351743, 'support': 95227}, '1': {'precision': 0.5658598757488624, 'recall': 0.8887373861916573, 'f1-score': 0.691464008742709, 'support': 206817}, '2': {'precision': 0.5088739834985457, 'recall': 0.18532609870511685, 'f1-score': 0.2717015814661046, 'support': 92518}, 'accuracy': 0.5572229459501928, 'macro avg': {'precision': 0.5331054302849924, 'recall': 0.42420337185974955, 'f1-score': 0.4170768520141103, 'support': 394562}, 'weighted avg': {'precision': 0.5425354097524975, 'recall': 0.5572229459501928, 'f1-score': 0.495677133914696, 'support': 394562}}
[[ 18907  71249   5071]
 [ 11534 183806  11477]
 [  5601  69771  17146]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0212426
{'0': {'precision': 0.5591165134894752, 'recall': 0.17350384102304614, 'f1-score': 0.26482710198350007, 'support': 108695}, '1': {'precision': 0.4902323350093517, 'recall': 0.8994529491721818, 'f1-score': 0.6345910466533035, 'support': 179508}, '2': {'precision': 0.5469504447268106, 'recall': 0.16188568903430833, 'f1-score': 0.24982769753117767, 'support': 106359}, 'accuracy': 0.5006462862617282, 'macro avg': {'precision': 0.5320997644085459, 'recall': 0.4116141597431788, 'f1-score': 0.38308194872266044, 'support': 394562}, 'weighted avg': {'precision': 0.5244977919244531, 'recall': 0.5006462862617282, 'f1-score': 0.42900982744019, 'support': 394562}}
[[ 18859  84492   5344]
 [  9131 161459   8918]
 [  5740  83401  17218]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1077689
{'0': {'precision': 0.5812939661151293, 'recall': 0.13846516933485425, 'f1-score': 0.2236552854619617, 'support': 127115}, '1': {'precision': 0.3860951397665711, 'recall': 0.9123591724563408, 'f1-score': 0.5425796485727568, 'support': 142639}, '2': {'precision': 0.5866059292458029, 'recall': 0.12794051663354913, 'f1-score': 0.21006518493182222, 'support': 124808}, 'accuracy': 0.41490817666171603, 'macro avg': {'precision': 0.5179983450425011, 'recall': 0.3929216194749148, 'f1-score': 0.3254333729888469, 'support': 394562}, 'weighted avg': {'precision': 0.5124074795879958, 'recall': 0.41490817666171603, 'f1-score': 0.33465152676952564, 'support': 394562}}
[[ 17601 104200   5314]
 [  6562 130138   5939]
 [  6116 102724  15968]]
Evaluating performance on  val set...
482/482 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8625392
{'0': {'precision': 0.4532878909382518, 'recall': 0.20442113828488767, 'f1-score': 0.2817708820138954, 'support': 22121}, '1': {'precision': 0.6853767636163002, 'recall': 0.877666889564592, 'f1-score': 0.7696937844043041, 'support': 79259}, '2': {'precision': 0.4030582073160429, 'recall': 0.2175657804733458, 'f1-score': 0.28259195640585205, 'support': 21929}, 'accuracy': 0.6394991444257921, 'macro avg': {'precision': 0.5139076206235317, 'recall': 0.4332179361076085, 'f1-score': 0.44468554094135054, 'support': 123309}, 'weighted avg': {'precision': 0.5935343062642865, 'recall': 0.6394991444257921, 'f1-score': 0.5955378143619204, 'support': 123309}}
[[ 4522 16076  1523]
 [ 4153 69563  5543]
 [ 1301 15857  4771]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.95167905
{'0': {'precision': 0.5286402295317143, 'recall': 0.17949342425718462, 'f1-score': 0.2679930391418405, 'support': 28742}, '1': {'precision': 0.5767110883644023, 'recall': 0.8852411959329818, 'f1-score': 0.6984200771188309, 'support': 66191}, '2': {'precision': 0.46526615333110144, 'recall': 0.19590499013250634, 'f1-score': 0.27571669477234395, 'support': 28376}, 'accuracy': 0.5621081997258919, 'macro avg': {'precision': 0.5235391570757394, 'recall': 0.4202132034408909, 'f1-score': 0.4140432703443384, 'support': 123309}, 'weighted avg': {'precision': 0.5398604602587972, 'recall': 0.5621081997258919, 'f1-score': 0.5008192117886557, 'support': 123309}}
[[ 5159 21703  1880]
 [ 3087 58595  4509]
 [ 1513 21304  5559]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0128723
{'0': {'precision': 0.5665555555555556, 'recall': 0.1540297245045916, 'f1-score': 0.2422097662929888, 'support': 33104}, '1': {'precision': 0.49931261496756707, 'recall': 0.8979073087503047, 'f1-score': 0.6417550146831915, 'support': 57438}, '2': {'precision': 0.5014974135583992, 'recall': 0.1686452833643605, 'f1-score': 0.25240944594162523, 'support': 32767}, 'accuracy': 0.5044157360776585, 'macro avg': {'precision': 0.5224551946938406, 'recall': 0.406860772206419, 'f1-score': 0.3787914089726019, 'support': 123309}, 'weighted avg': {'precision': 0.5179454771321339, 'recall': 0.5044157360776585, 'f1-score': 0.4310304758931261, 'support': 123309}}
[[ 5099 26040  1965]
 [ 2336 51574  3528]
 [ 1565 25676  5526]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0988954
{'0': {'precision': 0.5875156054931335, 'recall': 0.1211668683539741, 'f1-score': 0.20090076629170314, 'support': 38839}, '1': {'precision': 0.3949215874992923, 'recall': 0.9153799046410919, 'f1-score': 0.5517864205669084, 'support': 45722}, '2': {'precision': 0.53921253084433, 'recall': 0.12970992051202643, 'f1-score': 0.20911606232707147, 'support': 38748}, 'accuracy': 0.4183392939688101, 'macro avg': {'precision': 0.507216574612252, 'recall': 0.3887522311690308, 'f1-score': 0.32060108306189433, 'support': 123309}, 'weighted avg': {'precision': 0.5009247546452128, 'recall': 0.4183392939688101, 'f1-score': 0.3335879195047646, 'support': 123309}}
[[ 4706 32061  2072]
 [ 1646 41853  2223]
 [ 1658 32064  5026]]
training model: results/WBA/W2/deepLOB_L2/seq2seq
Epoch 1/50
1542/1542 - 78s - loss: 12.2896 - accuracy10: 0.4491 - accuracy20: 0.4595 - accuracy30: 0.4607 - accuracy50: 0.4522 - val_loss: 14.0939 - val_accuracy10: 0.5617 - val_accuracy20: 0.4937 - val_accuracy30: 0.4445 - val_accuracy50: 0.3703 - 78s/epoch - 51ms/step
Epoch 2/50
1542/1542 - 73s - loss: 11.9231 - accuracy10: 0.4547 - accuracy20: 0.4774 - accuracy30: 0.4844 - accuracy50: 0.4793 - val_loss: 13.9029 - val_accuracy10: 0.3846 - val_accuracy20: 0.3990 - val_accuracy30: 0.4033 - val_accuracy50: 0.3999 - 73s/epoch - 47ms/step
Epoch 3/50
1542/1542 - 73s - loss: 11.4742 - accuracy10: 0.5267 - accuracy20: 0.5330 - accuracy30: 0.5264 - accuracy50: 0.5059 - val_loss: 12.8688 - val_accuracy10: 0.4823 - val_accuracy20: 0.4856 - val_accuracy30: 0.4763 - val_accuracy50: 0.4546 - 73s/epoch - 47ms/step
Epoch 4/50
1542/1542 - 71s - loss: 11.0883 - accuracy10: 0.5741 - accuracy20: 0.5689 - accuracy30: 0.5524 - accuracy50: 0.5213 - val_loss: 12.4755 - val_accuracy10: 0.5373 - val_accuracy20: 0.5286 - val_accuracy30: 0.5118 - val_accuracy50: 0.4795 - 71s/epoch - 46ms/step
Epoch 5/50
1542/1542 - 70s - loss: 10.8390 - accuracy10: 0.5963 - accuracy20: 0.5863 - accuracy30: 0.5663 - accuracy50: 0.5301 - val_loss: 12.2789 - val_accuracy10: 0.5326 - val_accuracy20: 0.5236 - val_accuracy30: 0.5081 - val_accuracy50: 0.4758 - 70s/epoch - 46ms/step
Epoch 6/50
1542/1542 - 73s - loss: 10.6958 - accuracy10: 0.6072 - accuracy20: 0.5956 - accuracy30: 0.5739 - accuracy50: 0.5356 - val_loss: 12.1797 - val_accuracy10: 0.5388 - val_accuracy20: 0.5321 - val_accuracy30: 0.5174 - val_accuracy50: 0.4840 - 73s/epoch - 48ms/step
Epoch 7/50
1542/1542 - 70s - loss: 10.6021 - accuracy10: 0.6118 - accuracy20: 0.5998 - accuracy30: 0.5776 - accuracy50: 0.5391 - val_loss: 11.8152 - val_accuracy10: 0.5393 - val_accuracy20: 0.5359 - val_accuracy30: 0.5226 - val_accuracy50: 0.4908 - 70s/epoch - 46ms/step
Epoch 8/50
1542/1542 - 71s - loss: 10.5374 - accuracy10: 0.6153 - accuracy20: 0.6032 - accuracy30: 0.5809 - accuracy50: 0.5416 - val_loss: 12.0537 - val_accuracy10: 0.5420 - val_accuracy20: 0.5392 - val_accuracy30: 0.5269 - val_accuracy50: 0.4933 - 71s/epoch - 46ms/step
Epoch 9/50
1542/1542 - 72s - loss: 10.4810 - accuracy10: 0.6178 - accuracy20: 0.6058 - accuracy30: 0.5837 - accuracy50: 0.5440 - val_loss: 12.1057 - val_accuracy10: 0.5521 - val_accuracy20: 0.5465 - val_accuracy30: 0.5320 - val_accuracy50: 0.4950 - 72s/epoch - 46ms/step
Epoch 10/50
1542/1542 - 71s - loss: 10.4348 - accuracy10: 0.6188 - accuracy20: 0.6074 - accuracy30: 0.5860 - accuracy50: 0.5460 - val_loss: 12.0431 - val_accuracy10: 0.5332 - val_accuracy20: 0.5362 - val_accuracy30: 0.5273 - val_accuracy50: 0.4968 - 71s/epoch - 46ms/step
Epoch 11/50
1542/1542 - 72s - loss: 10.3952 - accuracy10: 0.6205 - accuracy20: 0.6087 - accuracy30: 0.5871 - accuracy50: 0.5472 - val_loss: 11.8931 - val_accuracy10: 0.5448 - val_accuracy20: 0.5434 - val_accuracy30: 0.5318 - val_accuracy50: 0.4985 - 72s/epoch - 47ms/step
Epoch 12/50
1542/1542 - 72s - loss: 10.3542 - accuracy10: 0.6221 - accuracy20: 0.6109 - accuracy30: 0.5889 - accuracy50: 0.5490 - val_loss: 11.9043 - val_accuracy10: 0.5427 - val_accuracy20: 0.5409 - val_accuracy30: 0.5299 - val_accuracy50: 0.4967 - 72s/epoch - 46ms/step
Epoch 13/50
1542/1542 - 71s - loss: 10.3292 - accuracy10: 0.6229 - accuracy20: 0.6113 - accuracy30: 0.5900 - accuracy50: 0.5501 - val_loss: 11.7108 - val_accuracy10: 0.5518 - val_accuracy20: 0.5510 - val_accuracy30: 0.5399 - val_accuracy50: 0.5044 - 71s/epoch - 46ms/step
Epoch 14/50
1542/1542 - 71s - loss: 10.2936 - accuracy10: 0.6244 - accuracy20: 0.6131 - accuracy30: 0.5920 - accuracy50: 0.5518 - val_loss: 11.7656 - val_accuracy10: 0.5479 - val_accuracy20: 0.5480 - val_accuracy30: 0.5381 - val_accuracy50: 0.5047 - 71s/epoch - 46ms/step
Epoch 15/50
1542/1542 - 70s - loss: 10.2672 - accuracy10: 0.6249 - accuracy20: 0.6135 - accuracy30: 0.5927 - accuracy50: 0.5533 - val_loss: 11.8251 - val_accuracy10: 0.5426 - val_accuracy20: 0.5444 - val_accuracy30: 0.5341 - val_accuracy50: 0.5003 - 70s/epoch - 46ms/step
Epoch 16/50
1542/1542 - 70s - loss: 10.2431 - accuracy10: 0.6267 - accuracy20: 0.6148 - accuracy30: 0.5941 - accuracy50: 0.5545 - val_loss: 11.7903 - val_accuracy10: 0.5528 - val_accuracy20: 0.5528 - val_accuracy30: 0.5434 - val_accuracy50: 0.5064 - 70s/epoch - 45ms/step
Epoch 17/50
1542/1542 - 72s - loss: 10.2179 - accuracy10: 0.6273 - accuracy20: 0.6151 - accuracy30: 0.5955 - accuracy50: 0.5563 - val_loss: 11.6411 - val_accuracy10: 0.5630 - val_accuracy20: 0.5628 - val_accuracy30: 0.5512 - val_accuracy50: 0.5116 - 72s/epoch - 47ms/step
Epoch 18/50
1542/1542 - 71s - loss: 10.1909 - accuracy10: 0.6278 - accuracy20: 0.6160 - accuracy30: 0.5962 - accuracy50: 0.5570 - val_loss: 11.8085 - val_accuracy10: 0.5541 - val_accuracy20: 0.5524 - val_accuracy30: 0.5430 - val_accuracy50: 0.5064 - 71s/epoch - 46ms/step
Epoch 19/50
1542/1542 - 71s - loss: 10.1688 - accuracy10: 0.6290 - accuracy20: 0.6171 - accuracy30: 0.5970 - accuracy50: 0.5585 - val_loss: 11.6881 - val_accuracy10: 0.5639 - val_accuracy20: 0.5617 - val_accuracy30: 0.5504 - val_accuracy50: 0.5112 - 71s/epoch - 46ms/step
Epoch 20/50
1542/1542 - 70s - loss: 10.1426 - accuracy10: 0.6297 - accuracy20: 0.6185 - accuracy30: 0.5988 - accuracy50: 0.5596 - val_loss: 11.7254 - val_accuracy10: 0.5584 - val_accuracy20: 0.5566 - val_accuracy30: 0.5460 - val_accuracy50: 0.5091 - 70s/epoch - 45ms/step
Epoch 21/50
1542/1542 - 70s - loss: 10.1275 - accuracy10: 0.6314 - accuracy20: 0.6193 - accuracy30: 0.5993 - accuracy50: 0.5608 - val_loss: 11.6775 - val_accuracy10: 0.5558 - val_accuracy20: 0.5560 - val_accuracy30: 0.5462 - val_accuracy50: 0.5110 - 70s/epoch - 46ms/step
Epoch 22/50
1542/1542 - 72s - loss: 10.1019 - accuracy10: 0.6315 - accuracy20: 0.6199 - accuracy30: 0.6005 - accuracy50: 0.5621 - val_loss: 11.7659 - val_accuracy10: 0.5514 - val_accuracy20: 0.5531 - val_accuracy30: 0.5439 - val_accuracy50: 0.5086 - 72s/epoch - 47ms/step
Epoch 23/50
1542/1542 - 71s - loss: 10.0866 - accuracy10: 0.6321 - accuracy20: 0.6204 - accuracy30: 0.6013 - accuracy50: 0.5623 - val_loss: 11.8034 - val_accuracy10: 0.5512 - val_accuracy20: 0.5523 - val_accuracy30: 0.5435 - val_accuracy50: 0.5087 - 71s/epoch - 46ms/step
Epoch 24/50
1542/1542 - 72s - loss: 10.0608 - accuracy10: 0.6337 - accuracy20: 0.6224 - accuracy30: 0.6027 - accuracy50: 0.5642 - val_loss: 11.6218 - val_accuracy10: 0.5583 - val_accuracy20: 0.5578 - val_accuracy30: 0.5476 - val_accuracy50: 0.5104 - 72s/epoch - 46ms/step
Epoch 25/50
1542/1542 - 70s - loss: 10.0436 - accuracy10: 0.6336 - accuracy20: 0.6220 - accuracy30: 0.6028 - accuracy50: 0.5648 - val_loss: 11.7341 - val_accuracy10: 0.5543 - val_accuracy20: 0.5555 - val_accuracy30: 0.5465 - val_accuracy50: 0.5112 - 70s/epoch - 46ms/step
Epoch 26/50
1542/1542 - 70s - loss: 10.0239 - accuracy10: 0.6344 - accuracy20: 0.6235 - accuracy30: 0.6043 - accuracy50: 0.5663 - val_loss: 11.7503 - val_accuracy10: 0.5548 - val_accuracy20: 0.5549 - val_accuracy30: 0.5455 - val_accuracy50: 0.5116 - 70s/epoch - 45ms/step
Epoch 27/50
1542/1542 - 72s - loss: 10.0031 - accuracy10: 0.6342 - accuracy20: 0.6241 - accuracy30: 0.6048 - accuracy50: 0.5671 - val_loss: 11.8344 - val_accuracy10: 0.5495 - val_accuracy20: 0.5520 - val_accuracy30: 0.5458 - val_accuracy50: 0.5123 - 72s/epoch - 47ms/step
Epoch 28/50
1542/1542 - 72s - loss: 9.9834 - accuracy10: 0.6343 - accuracy20: 0.6242 - accuracy30: 0.6058 - accuracy50: 0.5688 - val_loss: 12.0124 - val_accuracy10: 0.5466 - val_accuracy20: 0.5482 - val_accuracy30: 0.5401 - val_accuracy50: 0.5068 - 72s/epoch - 47ms/step
Epoch 29/50
1542/1542 - 70s - loss: 9.9616 - accuracy10: 0.6357 - accuracy20: 0.6256 - accuracy30: 0.6069 - accuracy50: 0.5699 - val_loss: 11.9064 - val_accuracy10: 0.5447 - val_accuracy20: 0.5475 - val_accuracy30: 0.5412 - val_accuracy50: 0.5066 - 70s/epoch - 45ms/step
Epoch 30/50
1542/1542 - 70s - loss: 9.9422 - accuracy10: 0.6357 - accuracy20: 0.6262 - accuracy30: 0.6071 - accuracy50: 0.5704 - val_loss: 11.6990 - val_accuracy10: 0.5549 - val_accuracy20: 0.5554 - val_accuracy30: 0.5467 - val_accuracy50: 0.5137 - 70s/epoch - 45ms/step
Epoch 31/50
1542/1542 - 70s - loss: 9.9277 - accuracy10: 0.6357 - accuracy20: 0.6263 - accuracy30: 0.6075 - accuracy50: 0.5710 - val_loss: 11.9451 - val_accuracy10: 0.5439 - val_accuracy20: 0.5464 - val_accuracy30: 0.5384 - val_accuracy50: 0.5060 - 70s/epoch - 46ms/step
Epoch 32/50
1542/1542 - 70s - loss: 9.8960 - accuracy10: 0.6365 - accuracy20: 0.6273 - accuracy30: 0.6094 - accuracy50: 0.5731 - val_loss: 11.8419 - val_accuracy10: 0.5692 - val_accuracy20: 0.5651 - val_accuracy30: 0.5525 - val_accuracy50: 0.5133 - 70s/epoch - 46ms/step
Epoch 33/50
1542/1542 - 74s - loss: 9.8692 - accuracy10: 0.6358 - accuracy20: 0.6277 - accuracy30: 0.6102 - accuracy50: 0.5741 - val_loss: 11.9065 - val_accuracy10: 0.5504 - val_accuracy20: 0.5509 - val_accuracy30: 0.5414 - val_accuracy50: 0.5076 - 74s/epoch - 48ms/step
Epoch 34/50
1542/1542 - 73s - loss: 9.8533 - accuracy10: 0.6373 - accuracy20: 0.6298 - accuracy30: 0.6119 - accuracy50: 0.5758 - val_loss: 11.8932 - val_accuracy10: 0.5565 - val_accuracy20: 0.5556 - val_accuracy30: 0.5457 - val_accuracy50: 0.5104 - 73s/epoch - 47ms/step
testing model: results/WBA/W2/deepLOB_L2/seq2seq
Evaluating performance on  test set...
4353/4353 - 69s - 69s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8385579
{'0': {'precision': 0.33979576774955383, 'recall': 0.6762864681814783, 'f1-score': 0.4523241752451177, 'support': 187218}, '1': {'precision': 0.8533102586892088, 'recall': 0.5888521276983787, 'f1-score': 0.6968335412971346, 'support': 740213}, '2': {'precision': 0.42810795826168313, 'recall': 0.5289392423082893, 'f1-score': 0.47321197728643793, 'support': 186857}, 'accuracy': 0.5934955774449694, 'macro avg': {'precision': 0.5404046615668153, 'recall': 0.5980259460627154, 'f1-score': 0.5407898979428968, 'support': 1114288}, 'weighted avg': {'precision': 0.6957287517397249, 'recall': 0.5934955774449694, 'f1-score': 0.6182525917761191, 'support': 1114288}}
[[126613  32050  28555]
 [200861 435876 103476]
 [ 45141  42880  98836]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.85516685
{'0': {'precision': 0.418663064060931, 'recall': 0.6225797461931045, 'f1-score': 0.5006539139509448, 'support': 240419}, '1': {'precision': 0.7677694882980467, 'recall': 0.6237375658557924, 'f1-score': 0.6882993087815527, 'support': 630924}, '2': {'precision': 0.49028889662373826, 'recall': 0.4928317108810636, 'f1-score': 0.4915570152930309, 'support': 242945}, 'accuracy': 0.5949467283144034, 'macro avg': {'precision': 0.5589071496609053, 'recall': 0.5797163409766535, 'f1-score': 0.5601700793418428, 'support': 1114288}, 'weighted avg': {'precision': 0.6319479235383275, 'recall': 0.5949467283144034, 'f1-score': 0.6049177461412399, 'support': 1114288}}
[[149680  52847  37892]
 [150811 393531  86582]
 [ 57028  66186 119731]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8830625
{'0': {'precision': 0.46837461560638094, 'recall': 0.5615523927140229, 'f1-score': 0.510748594716823, 'support': 277739}, '1': {'precision': 0.6917626685731856, 'recall': 0.6599486022178791, 'f1-score': 0.6754812452280717, 'support': 555666}, '2': {'precision': 0.5135179250353326, 'recall': 0.459223235297259, 'f1-score': 0.4848553192449086, 'support': 280883}, 'accuracy': 0.5848254670246831, 'macro avg': {'precision': 0.5578850697382997, 'recall': 0.560241410076387, 'f1-score': 0.5570283863966011, 'support': 1114288}, 'weighted avg': {'precision': 0.5911517917243906, 'recall': 0.5848254670246831, 'f1-score': 0.5863693965962345, 'support': 1114288}}
[[155965  75510  46264]
 [113022 366711  75933]
 [ 64005  87890 128988]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.96218985
{'0': {'precision': 0.5143802758804367, 'recall': 0.4745710398724656, 'f1-score': 0.4936744175897481, 'support': 333714}, '1': {'precision': 0.5636572201447428, 'recall': 0.6928718597344322, 'f1-score': 0.6216206733742794, 'support': 447494}, '2': {'precision': 0.5243677873924205, 'recall': 0.40352768103758857, 'f1-score': 0.4560792124899474, 'support': 333080}, 'accuracy': 0.541003762043565, 'macro avg': {'precision': 0.5341350944725334, 'recall': 0.5236568602148287, 'f1-score': 0.5237914344846583, 'support': 1114288}, 'weighted avg': {'precision': 0.5371551574469823, 'recall': 0.541003762043565, 'f1-score': 0.5338193091002027, 'support': 1114288}}
[[158371 115840  59503]
 [ 75026 310056  62412]
 [ 74490 124183 134407]]
Evaluating performance on  train set...
1542/1542 - 26s - 26s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8669351
{'0': {'precision': 0.3557913216043964, 'recall': 0.6227655310621243, 'f1-score': 0.4528598839045005, 'support': 74850}, '1': {'precision': 0.8061012800033193, 'recall': 0.6280193627114261, 'f1-score': 0.7060036611567619, 'support': 247486}, '2': {'precision': 0.4592145442207645, 'recall': 0.4497348636936326, 'f1-score': 0.45442527087428214, 'support': 72227}, 'accuracy': 0.5943867012365579, 'macro avg': {'precision': 0.5403690486094933, 'recall': 0.5668399191557277, 'f1-score': 0.5377629386451815, 'support': 394563}, 'weighted avg': {'precision': 0.6571762955229551, 'recall': 0.5943867012365579, 'f1-score': 0.6119285346946648, 'support': 394563}}
[[ 46614  16340  11896]
 [ 65703 155426  26357]
 [ 18698  21046  32483]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.90216404
{'0': {'precision': 0.4280528681948879, 'recall': 0.5664567938867108, 'f1-score': 0.48762413192480825, 'support': 95137}, '1': {'precision': 0.7091108045595511, 'recall': 0.661009001343917, 'f1-score': 0.6842155302689124, 'support': 206858}, '2': {'precision': 0.5136143672780495, 'recall': 0.4207933627171377, 'f1-score': 0.4625935976533042, 'support': 92568}, 'accuracy': 0.5818538484348507, 'macro avg': {'precision': 0.5502593466774962, 'recall': 0.5494197193159218, 'f1-score': 0.5448110866156749, 'support': 394563}, 'weighted avg': {'precision': 0.5954769283516984, 'recall': 0.5818538484348507, 'f1-score': 0.5848189448753893, 'support': 394563}}
[[ 53891  25600  15646]
 [ 48882 136735  21241]
 [ 23125  30491  38952]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.93770206
{'0': {'precision': 0.46887024910551545, 'recall': 0.5116109903870943, 'f1-score': 0.48930905120031, 'support': 108604}, '1': {'precision': 0.6284667899303086, 'recall': 0.6887577587886548, 'f1-score': 0.6572324788912705, 'support': 179635}, '2': {'precision': 0.5320680380346251, 'recall': 0.39628870245664194, 'f1-score': 0.4542489825620569, 'support': 106324}, 'accuracy': 0.5611854127224296, 'macro avg': {'precision': 0.5431350256901496, 'recall': 0.5322191505441304, 'f1-score': 0.5335968375512125, 'support': 394563}, 'weighted avg': {'precision': 0.5585607834971344, 'recall': 0.5611854127224296, 'f1-score': 0.5563127950773894, 'support': 394563}}
[[ 55563  34501  18540]
 [ 37394 123725  18516]
 [ 25547  38642  42135]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0110071
{'0': {'precision': 0.5033810517228976, 'recall': 0.4403054924138148, 'f1-score': 0.4697353018917796, 'support': 127139}, '1': {'precision': 0.5068363253634125, 'recall': 0.7153648333321655, 'f1-score': 0.5933113069656207, 'support': 142709}, '2': {'precision': 0.5427371812866925, 'recall': 0.35654893156396583, 'f1-score': 0.4303688433359465, 'support': 124715}, 'accuracy': 0.5133172649234723, 'macro avg': {'precision': 0.5176515194576675, 'recall': 0.504073085769982, 'f1-score': 0.49780515073111564, 'support': 394563}, 'weighted avg': {'precision': 0.5170706230828905, 'recall': 0.5133172649234723, 'f1-score': 0.5019882506712954, 'support': 394563}}
[[ 55980  48335  22824]
 [ 25980 102089  14640]
 [ 29248  51000  44467]]
Evaluating performance on  val set...
482/482 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.91033125
{'0': {'precision': 0.32616757945577646, 'recall': 0.682965370897106, 'f1-score': 0.44149021553548246, 'support': 22149}, '1': {'precision': 0.829399761290571, 'recall': 0.5439692940923955, 'f1-score': 0.657023690611442, 'support': 79203}, '2': {'precision': 0.43008084527335305, 'recall': 0.4893888332270699, 'f1-score': 0.4578220858895706, 'support': 21958}, 'accuracy': 0.559216608547563, 'macro avg': {'precision': 0.5285493953399002, 'recall': 0.5721078327388571, 'f1-score': 0.518778664012165, 'support': 123310}, 'weighted avg': {'precision': 0.667901631752294, 'recall': 0.559216608547563, 'f1-score': 0.5828373328469437, 'support': 123310}}
[[15127  3670  3352]
 [25231 43084 10888]
 [ 6020  5192 10746]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9290236
{'0': {'precision': 0.39842948288939456, 'recall': 0.6209366199631471, 'f1-score': 0.4853986329478591, 'support': 28763}, '1': {'precision': 0.7357463600489863, 'recall': 0.5719445116054158, 'f1-score': 0.643586495379148, 'support': 66176}, '2': {'precision': 0.4827114381864576, 'recall': 0.46008247858728984, 'f1-score': 0.47112538800259873, 'support': 28371}, 'accuracy': 0.5576352282864325, 'macro avg': {'precision': 0.5389624270416128, 'recall': 0.5509878700519509, 'f1-score': 0.5333701721098686, 'support': 123310}, 'weighted avg': {'precision': 0.5988466835758444, 'recall': 0.5576352282864325, 'f1-score': 0.567008346287499, 'support': 123310}}
[[17860  6047  4856]
 [19195 37849  9132]
 [ 7771  7547 13053]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9510497
{'0': {'precision': 0.43972883270955443, 'recall': 0.564142054720058, 'f1-score': 0.49422596134767244, 'support': 33114}, '1': {'precision': 0.656870046786976, 'recall': 0.5988022909666975, 'f1-score': 0.6264935159551216, 'support': 57443}, '2': {'precision': 0.501651324573115, 'recall': 0.4359295331725338, 'f1-score': 0.4664869721473495, 'support': 32753}, 'accuracy': 0.5462330711215635, 'macro avg': {'precision': 0.5327500680232151, 'recall': 0.532957959619763, 'f1-score': 0.5290688164833811, 'support': 123310}, 'weighted avg': {'precision': 0.557329920506623, 'recall': 0.5462330711215635, 'f1-score': 0.5484738733259185, 'support': 123310}}
[[18681  8342  6091]
 [14953 34397  8093]
 [ 8849  9626 14278]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0056809
{'0': {'precision': 0.4718308109048436, 'recall': 0.48872528830313017, 'f1-score': 0.48012947766383857, 'support': 38848}, '1': {'precision': 0.5368551289742052, 'recall': 0.6271461107217939, 'f1-score': 0.5784987071751778, 'support': 45664}, '2': {'precision': 0.5184512396138191, 'recall': 0.39723697097788546, 'f1-score': 0.44982123312659616, 'support': 38798}, 'accuracy': 0.5111994161057497, 'macro avg': {'precision': 0.5090457264976226, 'recall': 0.5043694566676032, 'f1-score': 0.5028164726552041, 'support': 123310}, 'weighted avg': {'precision': 0.5105790864167256, 'recall': 0.5111994161057497, 'f1-score': 0.5070213211870715, 'support': 123310}}
[[18986 11891  7971]
 [10682 28638  6344]
 [10571 12815 15412]]
training model: results/WBA/W2/deepOF_L2/seq2seq
Epoch 1/50
1542/1542 - 50s - loss: 11.5943 - accuracy10: 0.5408 - accuracy20: 0.5357 - accuracy30: 0.5213 - accuracy50: 0.4916 - val_loss: 13.0392 - val_accuracy10: 0.6852 - val_accuracy20: 0.6216 - val_accuracy30: 0.5670 - val_accuracy50: 0.4817 - 50s/epoch - 32ms/step
Epoch 2/50
1542/1542 - 43s - loss: 10.8657 - accuracy10: 0.6012 - accuracy20: 0.5883 - accuracy30: 0.5672 - accuracy50: 0.5281 - val_loss: 12.7463 - val_accuracy10: 0.6881 - val_accuracy20: 0.6283 - val_accuracy30: 0.5746 - val_accuracy50: 0.4894 - 43s/epoch - 28ms/step
Epoch 3/50
1542/1542 - 44s - loss: 10.7125 - accuracy10: 0.6086 - accuracy20: 0.5943 - accuracy30: 0.5737 - accuracy50: 0.5340 - val_loss: 12.5794 - val_accuracy10: 0.6900 - val_accuracy20: 0.6299 - val_accuracy30: 0.5760 - val_accuracy50: 0.4913 - 44s/epoch - 28ms/step
Epoch 4/50
1542/1542 - 44s - loss: 10.6349 - accuracy10: 0.6129 - accuracy20: 0.5979 - accuracy30: 0.5766 - accuracy50: 0.5367 - val_loss: 12.6700 - val_accuracy10: 0.6896 - val_accuracy20: 0.6304 - val_accuracy30: 0.5759 - val_accuracy50: 0.4902 - 44s/epoch - 28ms/step
Epoch 5/50
1542/1542 - 42s - loss: 10.5760 - accuracy10: 0.6150 - accuracy20: 0.5999 - accuracy30: 0.5789 - accuracy50: 0.5395 - val_loss: 12.6393 - val_accuracy10: 0.6897 - val_accuracy20: 0.6314 - val_accuracy30: 0.5775 - val_accuracy50: 0.4929 - 42s/epoch - 27ms/step
Epoch 6/50
1542/1542 - 44s - loss: 10.5273 - accuracy10: 0.6174 - accuracy20: 0.6028 - accuracy30: 0.5818 - accuracy50: 0.5417 - val_loss: 12.6410 - val_accuracy10: 0.6911 - val_accuracy20: 0.6335 - val_accuracy30: 0.5797 - val_accuracy50: 0.4944 - 44s/epoch - 28ms/step
Epoch 7/50
1542/1542 - 42s - loss: 10.4814 - accuracy10: 0.6197 - accuracy20: 0.6044 - accuracy30: 0.5834 - accuracy50: 0.5438 - val_loss: 12.5913 - val_accuracy10: 0.6903 - val_accuracy20: 0.6337 - val_accuracy30: 0.5814 - val_accuracy50: 0.4961 - 42s/epoch - 27ms/step
Epoch 8/50
1542/1542 - 41s - loss: 10.4430 - accuracy10: 0.6220 - accuracy20: 0.6064 - accuracy30: 0.5854 - accuracy50: 0.5458 - val_loss: 12.6893 - val_accuracy10: 0.6927 - val_accuracy20: 0.6340 - val_accuracy30: 0.5815 - val_accuracy50: 0.4960 - 41s/epoch - 27ms/step
Epoch 9/50
1542/1542 - 41s - loss: 10.4197 - accuracy10: 0.6224 - accuracy20: 0.6073 - accuracy30: 0.5866 - accuracy50: 0.5469 - val_loss: 12.5116 - val_accuracy10: 0.6898 - val_accuracy20: 0.6348 - val_accuracy30: 0.5828 - val_accuracy50: 0.4982 - 41s/epoch - 27ms/step
Epoch 10/50
1542/1542 - 42s - loss: 10.3893 - accuracy10: 0.6236 - accuracy20: 0.6084 - accuracy30: 0.5882 - accuracy50: 0.5487 - val_loss: 12.5573 - val_accuracy10: 0.6873 - val_accuracy20: 0.6331 - val_accuracy30: 0.5820 - val_accuracy50: 0.4995 - 42s/epoch - 27ms/step
Epoch 11/50
1542/1542 - 44s - loss: 10.3604 - accuracy10: 0.6248 - accuracy20: 0.6105 - accuracy30: 0.5896 - accuracy50: 0.5503 - val_loss: 12.4967 - val_accuracy10: 0.6875 - val_accuracy20: 0.6328 - val_accuracy30: 0.5836 - val_accuracy50: 0.5015 - 44s/epoch - 29ms/step
Epoch 12/50
1542/1542 - 44s - loss: 10.3371 - accuracy10: 0.6251 - accuracy20: 0.6107 - accuracy30: 0.5902 - accuracy50: 0.5511 - val_loss: 12.4868 - val_accuracy10: 0.6882 - val_accuracy20: 0.6332 - val_accuracy30: 0.5831 - val_accuracy50: 0.5003 - 44s/epoch - 29ms/step
Epoch 13/50
1542/1542 - 44s - loss: 10.3062 - accuracy10: 0.6264 - accuracy20: 0.6128 - accuracy30: 0.5923 - accuracy50: 0.5528 - val_loss: 12.6600 - val_accuracy10: 0.6872 - val_accuracy20: 0.6331 - val_accuracy30: 0.5828 - val_accuracy50: 0.5002 - 44s/epoch - 28ms/step
Epoch 14/50
1542/1542 - 43s - loss: 10.2836 - accuracy10: 0.6265 - accuracy20: 0.6131 - accuracy30: 0.5926 - accuracy50: 0.5537 - val_loss: 12.7018 - val_accuracy10: 0.6896 - val_accuracy20: 0.6349 - val_accuracy30: 0.5834 - val_accuracy50: 0.4999 - 43s/epoch - 28ms/step
Epoch 15/50
1542/1542 - 42s - loss: 10.2572 - accuracy10: 0.6272 - accuracy20: 0.6139 - accuracy30: 0.5941 - accuracy50: 0.5556 - val_loss: 12.5435 - val_accuracy10: 0.6807 - val_accuracy20: 0.6311 - val_accuracy30: 0.5835 - val_accuracy50: 0.5036 - 42s/epoch - 27ms/step
Epoch 16/50
1542/1542 - 42s - loss: 10.2352 - accuracy10: 0.6282 - accuracy20: 0.6151 - accuracy30: 0.5949 - accuracy50: 0.5571 - val_loss: 12.6941 - val_accuracy10: 0.6809 - val_accuracy20: 0.6295 - val_accuracy30: 0.5807 - val_accuracy50: 0.5004 - 42s/epoch - 27ms/step
Epoch 17/50
1542/1542 - 42s - loss: 10.2119 - accuracy10: 0.6279 - accuracy20: 0.6156 - accuracy30: 0.5961 - accuracy50: 0.5580 - val_loss: 12.7217 - val_accuracy10: 0.6867 - val_accuracy20: 0.6327 - val_accuracy30: 0.5836 - val_accuracy50: 0.5009 - 42s/epoch - 27ms/step
Epoch 18/50
1542/1542 - 44s - loss: 10.1916 - accuracy10: 0.6292 - accuracy20: 0.6167 - accuracy30: 0.5967 - accuracy50: 0.5591 - val_loss: 12.5590 - val_accuracy10: 0.6782 - val_accuracy20: 0.6294 - val_accuracy30: 0.5822 - val_accuracy50: 0.5037 - 44s/epoch - 28ms/step
Epoch 19/50
1542/1542 - 41s - loss: 10.1668 - accuracy10: 0.6295 - accuracy20: 0.6174 - accuracy30: 0.5982 - accuracy50: 0.5606 - val_loss: 12.6830 - val_accuracy10: 0.6828 - val_accuracy20: 0.6319 - val_accuracy30: 0.5827 - val_accuracy50: 0.5018 - 41s/epoch - 27ms/step
Epoch 20/50
1542/1542 - 43s - loss: 10.1470 - accuracy10: 0.6293 - accuracy20: 0.6181 - accuracy30: 0.5986 - accuracy50: 0.5613 - val_loss: 12.8064 - val_accuracy10: 0.6861 - val_accuracy20: 0.6329 - val_accuracy30: 0.5828 - val_accuracy50: 0.4996 - 43s/epoch - 28ms/step
Epoch 21/50
1542/1542 - 44s - loss: 10.1230 - accuracy10: 0.6309 - accuracy20: 0.6192 - accuracy30: 0.6000 - accuracy50: 0.5625 - val_loss: 12.7527 - val_accuracy10: 0.6848 - val_accuracy20: 0.6322 - val_accuracy30: 0.5822 - val_accuracy50: 0.5006 - 44s/epoch - 29ms/step
Epoch 22/50
1542/1542 - 44s - loss: 10.1060 - accuracy10: 0.6309 - accuracy20: 0.6198 - accuracy30: 0.6006 - accuracy50: 0.5630 - val_loss: 13.0791 - val_accuracy10: 0.6844 - val_accuracy20: 0.6315 - val_accuracy30: 0.5808 - val_accuracy50: 0.4980 - 44s/epoch - 29ms/step
testing model: results/WBA/W2/deepOF_L2/seq2seq
Evaluating performance on  test set...
4353/4353 - 45s - 45s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7223751
{'0': {'precision': 0.5307097217643799, 'recall': 0.40416735659689024, 'f1-score': 0.458874327610569, 'support': 187217}, '1': {'precision': 0.7982963593658995, 'recall': 0.8499173209837182, 'f1-score': 0.8232984729982352, 'support': 740212}, '2': {'precision': 0.4684009606325798, 'recall': 0.46031661082984576, 'f1-score': 0.46432359919348526, 'support': 186854}, 'accuracy': 0.7096922415580244, 'macro avg': {'precision': 0.5991356805876198, 'recall': 0.5714670961368181, 'f1-score': 0.5821654666007632, 'support': 1114283}, 'weighted avg': {'precision': 0.6980174873318117, 'recall': 0.7096922415580244, 'f1-score': 0.701873048490318, 'support': 1114283}}
[[ 75667  76962  34588]
 [ 48064 629119  63029]
 [ 18846  81996  86012]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8070755
{'0': {'precision': 0.6018327399670301, 'recall': 0.36140804765034235, 'f1-score': 0.45161541819996254, 'support': 240418}, '1': {'precision': 0.7022218771399696, 'recall': 0.8744252468209275, 'f1-score': 0.7789194283354454, 'support': 630923}, '2': {'precision': 0.5302522969386814, 'recall': 0.40218653011829986, 'f1-score': 0.4574248201699871, 'support': 242942}, 'accuracy': 0.6607764813786084, 'macro avg': {'precision': 0.611435638015227, 'recall': 0.5460066081965232, 'f1-score': 0.5626532222351317, 'support': 1114283}, 'weighted avg': {'precision': 0.6430681528759316, 'recall': 0.6607764813786084, 'f1-score': 0.6382062355417966, 'support': 1114283}}
[[ 86889 112009  41520]
 [ 34189 551695  45039]
 [ 23296 121938  97708]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8810968
{'0': {'precision': 0.6268965025999003, 'recall': 0.3168825183536943, 'f1-score': 0.42097257531802534, 'support': 277737}, '1': {'precision': 0.6241704999861066, 'recall': 0.8893507970615442, 'f1-score': 0.7335298588103975, 'support': 555666}, '2': {'precision': 0.5482978408024112, 'recall': 0.3555717744232412, 'f1-score': 0.4313879632249244, 'support': 280880}, 'accuracy': 0.61211110642449, 'macro avg': {'precision': 0.5997882811294727, 'recall': 0.5206016966128265, 'f1-score': 0.5286301324511158, 'support': 1114283}, 'weighted avg': {'precision': 0.605724556968427, 'recall': 0.61211110642449, 'f1-score': 0.5794627700390811, 'support': 1114283}}
[[ 88010 142507  47220]
 [ 26426 494182  35058]
 [ 25954 155053  99873]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0108835
{'0': {'precision': 0.6356172244579652, 'recall': 0.2588893483641681, 'f1-score': 0.36792245926108885, 'support': 333714}, '1': {'precision': 0.5028304254816969, 'recall': 0.8997861419061304, 'f1-score': 0.6451368949958983, 'support': 447493}, '2': {'precision': 0.5490182829664916, 'recall': 0.29273799373116044, 'f1-score': 0.38186471577702363, 'support': 333076}, 'accuracy': 0.5263896155644482, 'macro avg': {'precision': 0.5624886443020513, 'recall': 0.483804494667153, 'f1-score': 0.46497469001133696, 'support': 1114283}, 'weighted avg': {'precision': 0.5564046796461882, 'recall': 0.5263896155644482, 'f1-score': 0.48341856798892424, 'support': 1114283}}
[[ 86395 192426  54893]
 [ 19645 402648  25200]
 [ 29883 205689  97504]]
Evaluating performance on  train set...
1542/1542 - 16s - 16s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7960288
{'0': {'precision': 0.5107010674247707, 'recall': 0.3816236004596104, 'f1-score': 0.43682661059070926, 'support': 74846}, '1': {'precision': 0.7699750452025522, 'recall': 0.8330941823664224, 'f1-score': 0.8002919895085684, 'support': 247403}, '2': {'precision': 0.472099677232942, 'recall': 0.4631947229405501, 'f1-score': 0.4676048079742011, 'support': 72313}, 'accuracy': 0.6796599773926532, 'macro avg': {'precision': 0.5842585966200883, 'recall': 0.559304168588861, 'f1-score': 0.5682411360244929, 'support': 394562}, 'weighted avg': {'precision': 0.6661995127773763, 'recall': 0.6796599773926532, 'f1-score': 0.6703718808595328, 'support': 394562}}
[[ 28563  31570  14713]
 [ 18552 206110  22741]
 [  8814  30004  33495]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.88613904
{'0': {'precision': 0.5764131069765795, 'recall': 0.341930334884014, 'f1-score': 0.4292362044873316, 'support': 95227}, '1': {'precision': 0.6660357061198175, 'recall': 0.8591701842691848, 'f1-score': 0.750374784103242, 'support': 206817}, '2': {'precision': 0.5309326075977779, 'recall': 0.4090771525540976, 'f1-score': 0.46210668978400754, 'support': 92518}, 'accuracy': 0.62879598136668, 'macro avg': {'precision': 0.5911271402313917, 'recall': 0.5367258905690987, 'f1-score': 0.5472392261248604, 'support': 394562}, 'weighted avg': {'precision': 0.6127260622167676, 'recall': 0.62879598136668, 'f1-score': 0.6052745183115256, 'support': 394562}}
[[ 32561  45233  17433]
 [ 13122 177691  16004]
 [ 10806  43865  37847]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9558311
{'0': {'precision': 0.5980049512159604, 'recall': 0.30224021344128066, 'f1-score': 0.4015376059548618, 'support': 108695}, '1': {'precision': 0.583758931992248, 'recall': 0.8742563005548499, 'f1-score': 0.7000680279695323, 'support': 179508}, '2': {'precision': 0.551060192967834, 'recall': 0.3667672693425098, 'f1-score': 0.44041140741075263, 'support': 106359}, 'accuracy': 0.5798759130377482, 'macro avg': {'precision': 0.5776080253920142, 'recall': 0.5144212611128801, 'f1-score': 0.5140056804450489, 'support': 394562}, 'weighted avg': {'precision': 0.5788691196829627, 'recall': 0.5798759130377482, 'f1-score': 0.5478344557378023, 'support': 394562}}
[[ 32852  56449  19394]
 [ 10186 156936  12386]
 [ 11898  55452  39009]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0689336
{'0': {'precision': 0.599024024024024, 'recall': 0.2510797309522873, 'f1-score': 0.3538457274314698, 'support': 127115}, '1': {'precision': 0.46489243098252625, 'recall': 0.8857885991909646, 'f1-score': 0.6097611590230154, 'support': 142639}, '2': {'precision': 0.5564508006848625, 'recall': 0.3098759694891353, 'f1-score': 0.3980731919448719, 'support': 124808}, 'accuracy': 0.4991332160725057, 'macro avg': {'precision': 0.5401224185638043, 'recall': 0.4822480998774625, 'f1-score': 0.4538933594664523, 'support': 394562}, 'weighted avg': {'precision': 0.537067030805315, 'recall': 0.4991332160725057, 'f1-score': 0.4603523414433999, 'support': 394562}}
[[ 31916  73142  22057]
 [  7520 126348   8771]
 [ 13844  72289  38675]]
Evaluating performance on  val set...
482/482 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7832866
{'0': {'precision': 0.521134593993326, 'recall': 0.3812214637674608, 'f1-score': 0.4403310445656998, 'support': 22121}, '1': {'precision': 0.7740373422731294, 'recall': 0.8389709685966262, 'f1-score': 0.8051971640824136, 'support': 79259}, '2': {'precision': 0.46830670625382914, 'recall': 0.4531442382233572, 'f1-score': 0.4606007230926115, 'support': 21929}, 'accuracy': 0.6882384902967342, 'macro avg': {'precision': 0.5878262141734282, 'recall': 0.5577788901958148, 'f1-score': 0.5687096439135749, 'support': 123309}, 'weighted avg': {'precision': 0.6742974302475289, 'recall': 0.6882384902967342, 'f1-score': 0.6784597906198553, 'support': 123309}}
[[ 8433  9850  3838]
 [ 5319 66496  7444]
 [ 2430  9562  9937]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8770268
{'0': {'precision': 0.5899121459728451, 'recall': 0.33407556885394196, 'f1-score': 0.4265754459228326, 'support': 28742}, '1': {'precision': 0.6695461337317893, 'recall': 0.8665226390294754, 'f1-score': 0.7554048269730994, 'support': 66191}, '2': {'precision': 0.5264882066641707, 'recall': 0.3964617987031294, 'f1-score': 0.45231585718880674, 'support': 28376}, 'accuracy': 0.6342440535565125, 'macro avg': {'precision': 0.5953154954562684, 'recall': 0.5323533355288489, 'f1-score': 0.5447653766949129, 'support': 123309}, 'weighted avg': {'precision': 0.6180636643691448, 'recall': 0.6342440535565125, 'f1-score': 0.6090110789356824, 'support': 123309}}
[[ 9602 14281  4859]
 [ 3576 57356  5259]
 [ 3099 14027 11250]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9470384
{'0': {'precision': 0.6137843012125079, 'recall': 0.2905389076848719, 'f1-score': 0.39439045393037275, 'support': 33104}, '1': {'precision': 0.5871341915169476, 'recall': 0.8830216929558828, 'f1-score': 0.705302387673652, 'support': 57438}, '2': {'precision': 0.5452834627146553, 'recall': 0.35370952482680745, 'f1-score': 0.4290844470771167, 'support': 32767}, 'accuracy': 0.5833069767819056, 'macro avg': {'precision': 0.5820673184813704, 'recall': 0.5090900418225207, 'f1-score': 0.5095924295603805, 'support': 123309}, 'weighted avg': {'precision': 0.5831677527387329, 'recall': 0.5833069767819056, 'f1-score': 0.5484341792366021, 'support': 123309}}
[[ 9618 17956  5530]
 [ 2584 50719  4135]
 [ 3468 17709 11590]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0602521
{'0': {'precision': 0.6121099947117927, 'recall': 0.23842014469991504, 'f1-score': 0.34317267960049663, 'support': 38839}, '1': {'precision': 0.46815403283042195, 'recall': 0.8944709330300512, 'f1-score': 0.6146227832882477, 'support': 45722}, '2': {'precision': 0.5495845939586035, 'recall': 0.2953442758335914, 'f1-score': 0.3842137953030837, 'support': 38748}, 'accuracy': 0.4995661306149592, 'macro avg': {'precision': 0.5432828738336061, 'recall': 0.4760784511878526, 'f1-score': 0.44733641939727603, 'support': 123309}, 'weighted avg': {'precision': 0.5390845973967174, 'recall': 0.4995661306149592, 'f1-score': 0.4567207806479076, 'support': 123309}}
[[ 9260 23123  6456]
 [ 1902 40897  2923]
 [ 3966 23338 11444]]
training model: results/WBA/W2/deepVOL_L2/seq2seq
Epoch 1/50
1542/1542 - 46s - loss: 11.8303 - accuracy10: 0.5136 - accuracy20: 0.5146 - accuracy30: 0.5045 - accuracy50: 0.4821 - val_loss: 12.3347 - val_accuracy10: 0.6105 - val_accuracy20: 0.5872 - val_accuracy30: 0.5535 - val_accuracy50: 0.4921 - 46s/epoch - 30ms/step
Epoch 2/50
1542/1542 - 40s - loss: 11.3044 - accuracy10: 0.5678 - accuracy20: 0.5609 - accuracy30: 0.5425 - accuracy50: 0.5066 - val_loss: 12.1445 - val_accuracy10: 0.6374 - val_accuracy20: 0.6059 - val_accuracy30: 0.5681 - val_accuracy50: 0.5003 - 40s/epoch - 26ms/step
Epoch 3/50
1542/1542 - 40s - loss: 11.0552 - accuracy10: 0.5865 - accuracy20: 0.5746 - accuracy30: 0.5541 - accuracy50: 0.5165 - val_loss: 12.1381 - val_accuracy10: 0.6509 - val_accuracy20: 0.6132 - val_accuracy30: 0.5712 - val_accuracy50: 0.5005 - 40s/epoch - 26ms/step
Epoch 4/50
1542/1542 - 40s - loss: 10.8882 - accuracy10: 0.5998 - accuracy20: 0.5866 - accuracy30: 0.5644 - accuracy50: 0.5252 - val_loss: 11.8512 - val_accuracy10: 0.6566 - val_accuracy20: 0.6178 - val_accuracy30: 0.5764 - val_accuracy50: 0.5048 - 40s/epoch - 26ms/step
Epoch 5/50
1542/1542 - 43s - loss: 10.7807 - accuracy10: 0.6067 - accuracy20: 0.5920 - accuracy30: 0.5695 - accuracy50: 0.5294 - val_loss: 11.7724 - val_accuracy10: 0.6629 - val_accuracy20: 0.6221 - val_accuracy30: 0.5804 - val_accuracy50: 0.5085 - 43s/epoch - 28ms/step
Epoch 6/50
1542/1542 - 40s - loss: 10.7164 - accuracy10: 0.6101 - accuracy20: 0.5964 - accuracy30: 0.5737 - accuracy50: 0.5328 - val_loss: 11.8079 - val_accuracy10: 0.6642 - val_accuracy20: 0.6226 - val_accuracy30: 0.5795 - val_accuracy50: 0.5063 - 40s/epoch - 26ms/step
Epoch 7/50
1542/1542 - 40s - loss: 10.6611 - accuracy10: 0.6132 - accuracy20: 0.5985 - accuracy30: 0.5755 - accuracy50: 0.5345 - val_loss: 11.8763 - val_accuracy10: 0.6728 - val_accuracy20: 0.6271 - val_accuracy30: 0.5818 - val_accuracy50: 0.5058 - 40s/epoch - 26ms/step
Epoch 8/50
1542/1542 - 40s - loss: 10.6262 - accuracy10: 0.6154 - accuracy20: 0.6007 - accuracy30: 0.5779 - accuracy50: 0.5356 - val_loss: 11.8751 - val_accuracy10: 0.6699 - val_accuracy20: 0.6267 - val_accuracy30: 0.5819 - val_accuracy50: 0.5075 - 40s/epoch - 26ms/step
Epoch 9/50
1542/1542 - 40s - loss: 10.5925 - accuracy10: 0.6166 - accuracy20: 0.6020 - accuracy30: 0.5790 - accuracy50: 0.5377 - val_loss: 11.8202 - val_accuracy10: 0.6728 - val_accuracy20: 0.6276 - val_accuracy30: 0.5814 - val_accuracy50: 0.5057 - 40s/epoch - 26ms/step
Epoch 10/50
1542/1542 - 41s - loss: 10.5646 - accuracy10: 0.6189 - accuracy20: 0.6029 - accuracy30: 0.5801 - accuracy50: 0.5385 - val_loss: 11.8587 - val_accuracy10: 0.6690 - val_accuracy20: 0.6261 - val_accuracy30: 0.5817 - val_accuracy50: 0.5067 - 41s/epoch - 26ms/step
Epoch 11/50
1542/1542 - 40s - loss: 10.5371 - accuracy10: 0.6199 - accuracy20: 0.6046 - accuracy30: 0.5817 - accuracy50: 0.5402 - val_loss: 11.8231 - val_accuracy10: 0.6724 - val_accuracy20: 0.6286 - val_accuracy30: 0.5834 - val_accuracy50: 0.5081 - 40s/epoch - 26ms/step
Epoch 12/50
1542/1542 - 40s - loss: 10.5066 - accuracy10: 0.6206 - accuracy20: 0.6053 - accuracy30: 0.5824 - accuracy50: 0.5409 - val_loss: 11.7753 - val_accuracy10: 0.6653 - val_accuracy20: 0.6256 - val_accuracy30: 0.5823 - val_accuracy50: 0.5086 - 40s/epoch - 26ms/step
Epoch 13/50
1542/1542 - 40s - loss: 10.4854 - accuracy10: 0.6213 - accuracy20: 0.6067 - accuracy30: 0.5836 - accuracy50: 0.5418 - val_loss: 11.7726 - val_accuracy10: 0.6650 - val_accuracy20: 0.6243 - val_accuracy30: 0.5803 - val_accuracy50: 0.5068 - 40s/epoch - 26ms/step
Epoch 14/50
1542/1542 - 41s - loss: 10.4594 - accuracy10: 0.6223 - accuracy20: 0.6076 - accuracy30: 0.5843 - accuracy50: 0.5428 - val_loss: 11.7465 - val_accuracy10: 0.6702 - val_accuracy20: 0.6285 - val_accuracy30: 0.5847 - val_accuracy50: 0.5092 - 41s/epoch - 27ms/step
Epoch 15/50
1542/1542 - 42s - loss: 10.4379 - accuracy10: 0.6225 - accuracy20: 0.6079 - accuracy30: 0.5852 - accuracy50: 0.5442 - val_loss: 11.7084 - val_accuracy10: 0.6686 - val_accuracy20: 0.6274 - val_accuracy30: 0.5837 - val_accuracy50: 0.5096 - 42s/epoch - 27ms/step
Epoch 16/50
1542/1542 - 42s - loss: 10.4197 - accuracy10: 0.6224 - accuracy20: 0.6081 - accuracy30: 0.5860 - accuracy50: 0.5443 - val_loss: 11.6700 - val_accuracy10: 0.6689 - val_accuracy20: 0.6276 - val_accuracy30: 0.5842 - val_accuracy50: 0.5092 - 42s/epoch - 28ms/step
Epoch 17/50
1542/1542 - 41s - loss: 10.4000 - accuracy10: 0.6237 - accuracy20: 0.6094 - accuracy30: 0.5871 - accuracy50: 0.5464 - val_loss: 11.6878 - val_accuracy10: 0.6674 - val_accuracy20: 0.6280 - val_accuracy30: 0.5837 - val_accuracy50: 0.5091 - 41s/epoch - 27ms/step
Epoch 18/50
1542/1542 - 40s - loss: 10.3784 - accuracy10: 0.6244 - accuracy20: 0.6100 - accuracy30: 0.5878 - accuracy50: 0.5467 - val_loss: 11.7143 - val_accuracy10: 0.6652 - val_accuracy20: 0.6249 - val_accuracy30: 0.5816 - val_accuracy50: 0.5088 - 40s/epoch - 26ms/step
Epoch 19/50
1542/1542 - 40s - loss: 10.3634 - accuracy10: 0.6245 - accuracy20: 0.6101 - accuracy30: 0.5881 - accuracy50: 0.5479 - val_loss: 11.7403 - val_accuracy10: 0.6665 - val_accuracy20: 0.6262 - val_accuracy30: 0.5829 - val_accuracy50: 0.5079 - 40s/epoch - 26ms/step
Epoch 20/50
1542/1542 - 40s - loss: 10.3388 - accuracy10: 0.6250 - accuracy20: 0.6112 - accuracy30: 0.5891 - accuracy50: 0.5488 - val_loss: 11.6775 - val_accuracy10: 0.6674 - val_accuracy20: 0.6284 - val_accuracy30: 0.5863 - val_accuracy50: 0.5118 - 40s/epoch - 26ms/step
Epoch 21/50
1542/1542 - 40s - loss: 10.3194 - accuracy10: 0.6259 - accuracy20: 0.6112 - accuracy30: 0.5893 - accuracy50: 0.5493 - val_loss: 11.6236 - val_accuracy10: 0.6669 - val_accuracy20: 0.6273 - val_accuracy30: 0.5849 - val_accuracy50: 0.5114 - 40s/epoch - 26ms/step
Epoch 22/50
1542/1542 - 40s - loss: 10.3009 - accuracy10: 0.6264 - accuracy20: 0.6117 - accuracy30: 0.5902 - accuracy50: 0.5505 - val_loss: 11.7297 - val_accuracy10: 0.6702 - val_accuracy20: 0.6294 - val_accuracy30: 0.5856 - val_accuracy50: 0.5106 - 40s/epoch - 26ms/step
Epoch 23/50
1542/1542 - 40s - loss: 10.2836 - accuracy10: 0.6277 - accuracy20: 0.6131 - accuracy30: 0.5916 - accuracy50: 0.5522 - val_loss: 11.6633 - val_accuracy10: 0.6651 - val_accuracy20: 0.6285 - val_accuracy30: 0.5869 - val_accuracy50: 0.5125 - 40s/epoch - 26ms/step
Epoch 24/50
1542/1542 - 41s - loss: 10.2712 - accuracy10: 0.6283 - accuracy20: 0.6138 - accuracy30: 0.5917 - accuracy50: 0.5519 - val_loss: 11.6130 - val_accuracy10: 0.6568 - val_accuracy20: 0.6218 - val_accuracy30: 0.5824 - val_accuracy50: 0.5128 - 41s/epoch - 27ms/step
Epoch 25/50
1542/1542 - 45s - loss: 10.2454 - accuracy10: 0.6287 - accuracy20: 0.6142 - accuracy30: 0.5929 - accuracy50: 0.5542 - val_loss: 11.6700 - val_accuracy10: 0.6593 - val_accuracy20: 0.6226 - val_accuracy30: 0.5829 - val_accuracy50: 0.5114 - 45s/epoch - 29ms/step
Epoch 26/50
1542/1542 - 44s - loss: 10.2291 - accuracy10: 0.6291 - accuracy20: 0.6146 - accuracy30: 0.5937 - accuracy50: 0.5545 - val_loss: 11.6953 - val_accuracy10: 0.6543 - val_accuracy20: 0.6191 - val_accuracy30: 0.5808 - val_accuracy50: 0.5121 - 44s/epoch - 28ms/step
Epoch 27/50
1542/1542 - 41s - loss: 10.2132 - accuracy10: 0.6296 - accuracy20: 0.6155 - accuracy30: 0.5944 - accuracy50: 0.5558 - val_loss: 11.6104 - val_accuracy10: 0.6510 - val_accuracy20: 0.6184 - val_accuracy30: 0.5810 - val_accuracy50: 0.5127 - 41s/epoch - 27ms/step
Epoch 28/50
1542/1542 - 41s - loss: 10.1973 - accuracy10: 0.6296 - accuracy20: 0.6158 - accuracy30: 0.5945 - accuracy50: 0.5565 - val_loss: 11.6256 - val_accuracy10: 0.6555 - val_accuracy20: 0.6199 - val_accuracy30: 0.5813 - val_accuracy50: 0.5124 - 41s/epoch - 27ms/step
Epoch 29/50
1542/1542 - 41s - loss: 10.1794 - accuracy10: 0.6308 - accuracy20: 0.6169 - accuracy30: 0.5956 - accuracy50: 0.5572 - val_loss: 11.6088 - val_accuracy10: 0.6576 - val_accuracy20: 0.6233 - val_accuracy30: 0.5836 - val_accuracy50: 0.5134 - 41s/epoch - 27ms/step
Epoch 30/50
1542/1542 - 41s - loss: 10.1688 - accuracy10: 0.6303 - accuracy20: 0.6169 - accuracy30: 0.5956 - accuracy50: 0.5580 - val_loss: 11.7385 - val_accuracy10: 0.6595 - val_accuracy20: 0.6211 - val_accuracy30: 0.5806 - val_accuracy50: 0.5111 - 41s/epoch - 27ms/step
Epoch 31/50
1542/1542 - 40s - loss: 10.1478 - accuracy10: 0.6306 - accuracy20: 0.6171 - accuracy30: 0.5963 - accuracy50: 0.5590 - val_loss: 11.6420 - val_accuracy10: 0.6498 - val_accuracy20: 0.6162 - val_accuracy30: 0.5785 - val_accuracy50: 0.5138 - 40s/epoch - 26ms/step
Epoch 32/50
1542/1542 - 40s - loss: 10.1267 - accuracy10: 0.6319 - accuracy20: 0.6182 - accuracy30: 0.5979 - accuracy50: 0.5603 - val_loss: 11.5634 - val_accuracy10: 0.6500 - val_accuracy20: 0.6175 - val_accuracy30: 0.5805 - val_accuracy50: 0.5154 - 40s/epoch - 26ms/step
Epoch 33/50
1542/1542 - 41s - loss: 10.1189 - accuracy10: 0.6325 - accuracy20: 0.6192 - accuracy30: 0.5990 - accuracy50: 0.5606 - val_loss: 11.5488 - val_accuracy10: 0.6470 - val_accuracy20: 0.6164 - val_accuracy30: 0.5805 - val_accuracy50: 0.5162 - 41s/epoch - 26ms/step
Epoch 34/50
1542/1542 - 42s - loss: 10.1011 - accuracy10: 0.6320 - accuracy20: 0.6186 - accuracy30: 0.5983 - accuracy50: 0.5612 - val_loss: 11.6112 - val_accuracy10: 0.6425 - val_accuracy20: 0.6115 - val_accuracy30: 0.5761 - val_accuracy50: 0.5141 - 42s/epoch - 27ms/step
Epoch 35/50
1542/1542 - 41s - loss: 10.0811 - accuracy10: 0.6330 - accuracy20: 0.6194 - accuracy30: 0.5995 - accuracy50: 0.5627 - val_loss: 11.6286 - val_accuracy10: 0.6490 - val_accuracy20: 0.6130 - val_accuracy30: 0.5768 - val_accuracy50: 0.5133 - 41s/epoch - 27ms/step
Epoch 36/50
1542/1542 - 40s - loss: 10.0723 - accuracy10: 0.6326 - accuracy20: 0.6198 - accuracy30: 0.6005 - accuracy50: 0.5637 - val_loss: 11.6542 - val_accuracy10: 0.6423 - val_accuracy20: 0.6091 - val_accuracy30: 0.5741 - val_accuracy50: 0.5142 - 40s/epoch - 26ms/step
Epoch 37/50
1542/1542 - 40s - loss: 10.0587 - accuracy10: 0.6332 - accuracy20: 0.6199 - accuracy30: 0.6007 - accuracy50: 0.5644 - val_loss: 11.7272 - val_accuracy10: 0.6383 - val_accuracy20: 0.6063 - val_accuracy30: 0.5714 - val_accuracy50: 0.5118 - 40s/epoch - 26ms/step
Epoch 38/50
1542/1542 - 40s - loss: 10.0338 - accuracy10: 0.6343 - accuracy20: 0.6218 - accuracy30: 0.6015 - accuracy50: 0.5646 - val_loss: 11.7670 - val_accuracy10: 0.6503 - val_accuracy20: 0.6134 - val_accuracy30: 0.5743 - val_accuracy50: 0.5083 - 40s/epoch - 26ms/step
Epoch 39/50
1542/1542 - 40s - loss: 10.0222 - accuracy10: 0.6337 - accuracy20: 0.6212 - accuracy30: 0.6021 - accuracy50: 0.5660 - val_loss: 11.7273 - val_accuracy10: 0.6411 - val_accuracy20: 0.6088 - val_accuracy30: 0.5735 - val_accuracy50: 0.5125 - 40s/epoch - 26ms/step
Epoch 40/50
1542/1542 - 40s - loss: 10.0210 - accuracy10: 0.6345 - accuracy20: 0.6223 - accuracy30: 0.6023 - accuracy50: 0.5658 - val_loss: 11.7702 - val_accuracy10: 0.6530 - val_accuracy20: 0.6163 - val_accuracy30: 0.5774 - val_accuracy50: 0.5118 - 40s/epoch - 26ms/step
Epoch 41/50
1542/1542 - 40s - loss: 9.9916 - accuracy10: 0.6355 - accuracy20: 0.6235 - accuracy30: 0.6035 - accuracy50: 0.5671 - val_loss: 11.7245 - val_accuracy10: 0.6488 - val_accuracy20: 0.6150 - val_accuracy30: 0.5783 - val_accuracy50: 0.5133 - 40s/epoch - 26ms/step
Epoch 42/50
1542/1542 - 40s - loss: 9.9849 - accuracy10: 0.6359 - accuracy20: 0.6232 - accuracy30: 0.6042 - accuracy50: 0.5682 - val_loss: 11.7825 - val_accuracy10: 0.6442 - val_accuracy20: 0.6100 - val_accuracy30: 0.5746 - val_accuracy50: 0.5132 - 40s/epoch - 26ms/step
Epoch 43/50
1542/1542 - 43s - loss: 9.9764 - accuracy10: 0.6356 - accuracy20: 0.6236 - accuracy30: 0.6040 - accuracy50: 0.5683 - val_loss: 11.8275 - val_accuracy10: 0.6465 - val_accuracy20: 0.6112 - val_accuracy30: 0.5745 - val_accuracy50: 0.5108 - 43s/epoch - 28ms/step
testing model: results/WBA/W2/deepVOL_L2/seq2seq
Evaluating performance on  test set...
4353/4353 - 41s - 41s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7780639
{'0': {'precision': 0.4534301990404628, 'recall': 0.49572690660086105, 'f1-score': 0.4736361316662414, 'support': 187218}, '1': {'precision': 0.8371979017796549, 'recall': 0.7082974765371589, 'f1-score': 0.767372286597905, 'support': 740213}, '2': {'precision': 0.4013043432229559, 'recall': 0.6085616273406936, 'f1-score': 0.48366502345720497, 'support': 186857}, 'accuracy': 0.6558573726002613, 'macro avg': {'precision': 0.5639774813476912, 'recall': 0.6041953368262378, 'f1-score': 0.5748911472404504, 'support': 1114288}, 'weighted avg': {'precision': 0.6996230697410301, 'recall': 0.6558573726002613, 'f1-score': 0.6704445771343929, 'support': 1114288}}
[[ 92809  53102  41307]
 [ 87582 524291 128340]
 [ 24291  48852 113714]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8261579
{'0': {'precision': 0.5248418351546255, 'recall': 0.4440871977672314, 'f1-score': 0.48109930020772973, 'support': 240419}, '1': {'precision': 0.7440804031074472, 'recall': 0.7344545460309007, 'f1-score': 0.739236140468985, 'support': 630924}, '2': {'precision': 0.46667638554802343, 'recall': 0.5534133240033753, 'f1-score': 0.5063572886615798, 'support': 242945}, 'accuracy': 0.6323329336760335, 'macro avg': {'precision': 0.5785328746033653, 'recall': 0.5773183559338357, 'f1-score': 0.5755642431127649, 'support': 1114288}, 'weighted avg': {'precision': 0.6362958480241798, 'recall': 0.6323329336760335, 'f1-score': 0.632766579950411, 'support': 1114288}}
[[106767  81571  52081]
 [ 65970 463385 101569]
 [ 30690  77806 134449]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8785349
{'0': {'precision': 0.5564214288274357, 'recall': 0.391277422328157, 'f1-score': 0.4594606021401724, 'support': 277739}, '1': {'precision': 0.6638655595624302, 'recall': 0.7523764275661998, 'f1-score': 0.7053551619387946, 'support': 555666}, '2': {'precision': 0.4931853542163676, 'recall': 0.5078413431927172, 'f1-score': 0.5004060598512926, 'support': 280883}, 'accuracy': 0.6007306908088393, 'macro avg': {'precision': 0.5711574475354112, 'recall': 0.5504983976956913, 'f1-score': 0.5550739413100865, 'support': 1114288}, 'weighted avg': {'precision': 0.5940608111092253, 'recall': 0.6007306908088393, 'f1-score': 0.592403009725405, 'support': 1114288}}
[[108673 108178  60888]
 [ 51898 418070  85698]
 [ 34736 103503 142644]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9808052
{'0': {'precision': 0.5826519239469881, 'recall': 0.31644162366577366, 'f1-score': 0.41013601162041025, 'support': 333714}, '1': {'precision': 0.534045269590011, 'recall': 0.7693064041082115, 'f1-score': 0.6304429637375345, 'support': 447494}, '2': {'precision': 0.5099455999778101, 'recall': 0.44156959289059683, 'f1-score': 0.4733008419965277, 'support': 333080}, 'accuracy': 0.5357133882802292, 'macro avg': {'precision': 0.5422142645049365, 'recall': 0.5091058735548607, 'f1-score': 0.5046266057848241, 'support': 1114288}, 'weighted avg': {'precision': 0.5413984880556612, 'recall': 0.5357133882802292, 'f1-score': 0.517491543522735, 'support': 1114288}}
[[105601 153494  74619]
 [ 36512 344260  66722]
 [ 39129 146873 147078]]
Evaluating performance on  train set...
1542/1542 - 15s - 15s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8164223
{'0': {'precision': 0.45412976859783316, 'recall': 0.5028857715430862, 'f1-score': 0.47726581122888884, 'support': 74850}, '1': {'precision': 0.8089958302002871, 'recall': 0.7173011806728461, 'f1-score': 0.7603941566132173, 'support': 247486}, '2': {'precision': 0.43704603109212725, 'recall': 0.5581569219267033, 'f1-score': 0.49023220181310767, 'support': 72227}, 'accuracy': 0.6474935561621338, 'macro avg': {'precision': 0.5667238766300825, 'recall': 0.5927812913808785, 'f1-score': 0.5759640565517379, 'support': 394563}, 'weighted avg': {'precision': 0.673588955122977, 'recall': 0.6474935561621338, 'f1-score': 0.6572290241467555, 'support': 394563}}
[[ 37641  21524  15685]
 [ 33721 177522  36243]
 [ 11524  20389  40314]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8698162
{'0': {'precision': 0.5180903369211998, 'recall': 0.45079201572469174, 'f1-score': 0.48210391420670423, 'support': 95137}, '1': {'precision': 0.7059601554104323, 'recall': 0.7431184677411558, 'f1-score': 0.7240628915412949, 'support': 206858}, '2': {'precision': 0.4988940641017461, 'recall': 0.5068166104917466, 'f1-score': 0.5028241321286561, 'support': 92568}, 'accuracy': 0.6171942123311106, 'macro avg': {'precision': 0.5743148521444593, 'recall': 0.5669090313191981, 'f1-score': 0.569663645958885, 'support': 394563}, 'weighted avg': {'precision': 0.6120814469104651, 'recall': 0.6171942123311106, 'f1-score': 0.6138171748674301, 'support': 394563}}
[[ 42887  32862  19388]
 [ 25403 153720  27735]
 [ 14489  31164  46915]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9212248
{'0': {'precision': 0.5448628544862855, 'recall': 0.39928547751464033, 'f1-score': 0.4608509439877571, 'support': 108604}, '1': {'precision': 0.6207597104736916, 'recall': 0.7586272162997189, 'f1-score': 0.6828036456010782, 'support': 179635}, '2': {'precision': 0.5200901042485201, 'recall': 0.46687483540875063, 'f1-score': 0.4920478368827719, 'support': 106324}, 'accuracy': 0.5810985824823919, 'macro avg': {'precision': 0.561904223069499, 'recall': 0.5415958430743699, 'f1-score': 0.5452341421572023, 'support': 394563}, 'weighted avg': {'precision': 0.5727412765101891, 'recall': 0.5810985824823919, 'f1-score': 0.5703073603128522, 'support': 394563}}
[[ 43364  42622  22618]
 [ 20172 136276  23187]
 [ 16051  40633  49640]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0132743
{'0': {'precision': 0.5639861651534803, 'recall': 0.328333556186536, 'f1-score': 0.41504312594765236, 'support': 127139}, '1': {'precision': 0.4933403035624126, 'recall': 0.7737003272393472, 'f1-score': 0.6025024691829596, 'support': 142709}, '2': {'precision': 0.5307118195538465, 'recall': 0.4116585815659704, 'f1-score': 0.4636649763155162, 'support': 124715}, 'accuracy': 0.5157554053471816, 'macro avg': {'precision': 0.5293460960899131, 'recall': 0.5045641549972845, 'f1-score': 0.49373685714870935, 'support': 394563}, 'weighted avg': {'precision': 0.5279168675425588, 'recall': 0.5157554053471816, 'f1-score': 0.49821364493294906, 'support': 394563}}
[[ 41744  57894  27501]
 [ 14398 110414  17897]
 [ 17874  55501  51340]]
Evaluating performance on  val set...
482/482 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.81834966
{'0': {'precision': 0.45044970019986674, 'recall': 0.48841934173100365, 'f1-score': 0.4686667388714394, 'support': 22149}, '1': {'precision': 0.8118283447529752, 'recall': 0.7105791447293663, 'f1-score': 0.7578369061725735, 'support': 79203}, '2': {'precision': 0.42153558677299874, 'recall': 0.5753256216413153, 'f1-score': 0.4865676815529493, 'support': 21958}, 'accuracy': 0.6465898953856135, 'macro avg': {'precision': 0.5612712105752803, 'recall': 0.5914413693672285, 'f1-score': 0.5710237755323208, 'support': 123310}, 'weighted avg': {'precision': 0.6774173158183298, 'recall': 0.6465898953856135, 'f1-score': 0.6575907001085841, 'support': 123310}}
[[10818  6706  4625]
 [10212 56280 12711]
 [ 2986  6339 12633]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.87453264
{'0': {'precision': 0.5185620695447674, 'recall': 0.4293015332197615, 'f1-score': 0.4697289586305278, 'support': 28763}, '1': {'precision': 0.7097567005511685, 'recall': 0.7375030222437138, 'f1-score': 0.7233638903504547, 'support': 66176}, '2': {'precision': 0.48124288270701154, 'recall': 0.5213422156427338, 'f1-score': 0.5004906439278584, 'support': 28371}, 'accuracy': 0.615878679750223, 'macro avg': {'precision': 0.569853884267649, 'recall': 0.5627155903687363, 'f1-score': 0.5645278309696136, 'support': 123310}, 'weighted avg': {'precision': 0.6125829376958145, 'recall': 0.615878679750223, 'f1-score': 0.6129232252355756, 'support': 123310}}
[[12348 10293  6122]
 [ 7549 48805  9822]
 [ 3915  9665 14791]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9253197
{'0': {'precision': 0.5492248401506525, 'recall': 0.3787219906987981, 'f1-score': 0.4483091442053335, 'support': 33114}, '1': {'precision': 0.6255626731301939, 'recall': 0.7548178194035827, 'f1-score': 0.6841386927537375, 'support': 57443}, '2': {'precision': 0.5046207162110127, 'recall': 0.48013922388788816, 'f1-score': 0.49207566062236957, 'support': 32753}, 'accuracy': 0.5808612440191387, 'macro avg': {'precision': 0.5598027431639531, 'recall': 0.5378930113300896, 'f1-score': 0.5415078325271468, 'support': 123310}, 'weighted avg': {'precision': 0.572938693596835, 'recall': 0.5808612440191387, 'f1-score': 0.569793545060683, 'support': 123310}}
[[12541 13362  7211]
 [ 5857 43359  8227]
 [ 4436 12591 15726]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0163658
{'0': {'precision': 0.5638758231420508, 'recall': 0.30858731466227346, 'f1-score': 0.39888201237772014, 'support': 38848}, '1': {'precision': 0.4993639396166676, 'recall': 0.7736729152067274, 'f1-score': 0.6069649177060784, 'support': 45664}, '2': {'precision': 0.518688901667625, 'recall': 0.418475179132945, 'f1-score': 0.4632239657631954, 'support': 38798}, 'accuracy': 0.5153921012083367, 'macro avg': {'precision': 0.5273095548087811, 'recall': 0.500245136333982, 'f1-score': 0.4896902986156646, 'support': 123310}, 'weighted avg': {'precision': 0.5257683474412328, 'recall': 0.5153921012083367, 'f1-score': 0.49618342261503934, 'support': 123310}}
[[11988 17972  8888]
 [ 4157 35329  6178]
 [ 5115 17447 16236]]
training model: results/WBA/W2/deepVOL_L3/seq2seq
Epoch 1/50
1542/1542 - 68s - loss: 12.5012 - accuracy10: 0.4692 - accuracy20: 0.4659 - accuracy30: 0.4580 - accuracy50: 0.4416 - val_loss: 13.4912 - val_accuracy10: 0.6101 - val_accuracy20: 0.5573 - val_accuracy30: 0.5173 - val_accuracy50: 0.4560 - 68s/epoch - 44ms/step
Epoch 2/50
1542/1542 - 60s - loss: 12.1798 - accuracy10: 0.5006 - accuracy20: 0.4984 - accuracy30: 0.4878 - accuracy50: 0.4636 - val_loss: 12.6372 - val_accuracy10: 0.5776 - val_accuracy20: 0.5579 - val_accuracy30: 0.5335 - val_accuracy50: 0.4857 - 60s/epoch - 39ms/step
Epoch 3/50
1542/1542 - 59s - loss: 11.3347 - accuracy10: 0.5686 - accuracy20: 0.5608 - accuracy30: 0.5426 - accuracy50: 0.5056 - val_loss: 12.1034 - val_accuracy10: 0.5972 - val_accuracy20: 0.5807 - val_accuracy30: 0.5557 - val_accuracy50: 0.5046 - 59s/epoch - 38ms/step
Epoch 4/50
1542/1542 - 62s - loss: 11.0618 - accuracy10: 0.5855 - accuracy20: 0.5768 - accuracy30: 0.5566 - accuracy50: 0.5175 - val_loss: 11.7245 - val_accuracy10: 0.6256 - val_accuracy20: 0.6037 - val_accuracy30: 0.5739 - val_accuracy50: 0.5153 - 62s/epoch - 40ms/step
Epoch 5/50
1542/1542 - 63s - loss: 10.9430 - accuracy10: 0.5901 - accuracy20: 0.5799 - accuracy30: 0.5605 - accuracy50: 0.5223 - val_loss: 11.5687 - val_accuracy10: 0.6288 - val_accuracy20: 0.6075 - val_accuracy30: 0.5772 - val_accuracy50: 0.5162 - 63s/epoch - 41ms/step
Epoch 6/50
1542/1542 - 61s - loss: 10.8026 - accuracy10: 0.6000 - accuracy20: 0.5878 - accuracy30: 0.5671 - accuracy50: 0.5289 - val_loss: 11.4952 - val_accuracy10: 0.6314 - val_accuracy20: 0.6089 - val_accuracy30: 0.5780 - val_accuracy50: 0.5172 - 61s/epoch - 40ms/step
Epoch 7/50
1542/1542 - 63s - loss: 10.6920 - accuracy10: 0.6067 - accuracy20: 0.5942 - accuracy30: 0.5731 - accuracy50: 0.5342 - val_loss: 11.3256 - val_accuracy10: 0.6453 - val_accuracy20: 0.6169 - val_accuracy30: 0.5809 - val_accuracy50: 0.5155 - 63s/epoch - 41ms/step
Epoch 8/50
1542/1542 - 59s - loss: 10.6291 - accuracy10: 0.6091 - accuracy20: 0.5964 - accuracy30: 0.5760 - accuracy50: 0.5360 - val_loss: 11.2759 - val_accuracy10: 0.6451 - val_accuracy20: 0.6185 - val_accuracy30: 0.5846 - val_accuracy50: 0.5219 - 59s/epoch - 38ms/step
Epoch 9/50
1542/1542 - 59s - loss: 10.5865 - accuracy10: 0.6113 - accuracy20: 0.5983 - accuracy30: 0.5770 - accuracy50: 0.5375 - val_loss: 11.1163 - val_accuracy10: 0.6475 - val_accuracy20: 0.6213 - val_accuracy30: 0.5875 - val_accuracy50: 0.5226 - 59s/epoch - 38ms/step
Epoch 10/50
1542/1542 - 60s - loss: 10.5347 - accuracy10: 0.6137 - accuracy20: 0.6002 - accuracy30: 0.5796 - accuracy50: 0.5398 - val_loss: 11.0981 - val_accuracy10: 0.6414 - val_accuracy20: 0.6163 - val_accuracy30: 0.5834 - val_accuracy50: 0.5203 - 60s/epoch - 39ms/step
Epoch 11/50
1542/1542 - 63s - loss: 10.5052 - accuracy10: 0.6154 - accuracy20: 0.6024 - accuracy30: 0.5812 - accuracy50: 0.5416 - val_loss: 11.0537 - val_accuracy10: 0.6420 - val_accuracy20: 0.6176 - val_accuracy30: 0.5852 - val_accuracy50: 0.5251 - 63s/epoch - 41ms/step
Epoch 12/50
1542/1542 - 62s - loss: 10.4705 - accuracy10: 0.6168 - accuracy20: 0.6043 - accuracy30: 0.5835 - accuracy50: 0.5429 - val_loss: 11.0683 - val_accuracy10: 0.6363 - val_accuracy20: 0.6138 - val_accuracy30: 0.5830 - val_accuracy50: 0.5236 - 62s/epoch - 40ms/step
Epoch 13/50
1542/1542 - 61s - loss: 10.4355 - accuracy10: 0.6201 - accuracy20: 0.6064 - accuracy30: 0.5845 - accuracy50: 0.5444 - val_loss: 11.0622 - val_accuracy10: 0.6343 - val_accuracy20: 0.6121 - val_accuracy30: 0.5825 - val_accuracy50: 0.5232 - 61s/epoch - 40ms/step
Epoch 14/50
1542/1542 - 61s - loss: 10.4176 - accuracy10: 0.6206 - accuracy20: 0.6064 - accuracy30: 0.5854 - accuracy50: 0.5453 - val_loss: 10.9358 - val_accuracy10: 0.6396 - val_accuracy20: 0.6178 - val_accuracy30: 0.5870 - val_accuracy50: 0.5266 - 61s/epoch - 40ms/step
Epoch 15/50
1542/1542 - 59s - loss: 10.3805 - accuracy10: 0.6229 - accuracy20: 0.6089 - accuracy30: 0.5872 - accuracy50: 0.5471 - val_loss: 10.8560 - val_accuracy10: 0.6334 - val_accuracy20: 0.6157 - val_accuracy30: 0.5871 - val_accuracy50: 0.5289 - 59s/epoch - 38ms/step
Epoch 16/50
1542/1542 - 61s - loss: 10.3558 - accuracy10: 0.6238 - accuracy20: 0.6101 - accuracy30: 0.5887 - accuracy50: 0.5480 - val_loss: 10.8436 - val_accuracy10: 0.6350 - val_accuracy20: 0.6149 - val_accuracy30: 0.5865 - val_accuracy50: 0.5326 - 61s/epoch - 39ms/step
Epoch 17/50
1542/1542 - 61s - loss: 10.3317 - accuracy10: 0.6256 - accuracy20: 0.6121 - accuracy30: 0.5902 - accuracy50: 0.5494 - val_loss: 10.8013 - val_accuracy10: 0.6384 - val_accuracy20: 0.6193 - val_accuracy30: 0.5902 - val_accuracy50: 0.5330 - 61s/epoch - 40ms/step
Epoch 18/50
1542/1542 - 61s - loss: 10.3160 - accuracy10: 0.6252 - accuracy20: 0.6116 - accuracy30: 0.5904 - accuracy50: 0.5504 - val_loss: 10.8667 - val_accuracy10: 0.6431 - val_accuracy20: 0.6203 - val_accuracy30: 0.5891 - val_accuracy50: 0.5297 - 61s/epoch - 39ms/step
Epoch 19/50
1542/1542 - 60s - loss: 10.2996 - accuracy10: 0.6267 - accuracy20: 0.6127 - accuracy30: 0.5912 - accuracy50: 0.5506 - val_loss: 10.8508 - val_accuracy10: 0.6360 - val_accuracy20: 0.6168 - val_accuracy30: 0.5878 - val_accuracy50: 0.5301 - 60s/epoch - 39ms/step
Epoch 20/50
1542/1542 - 59s - loss: 10.2835 - accuracy10: 0.6269 - accuracy20: 0.6133 - accuracy30: 0.5924 - accuracy50: 0.5514 - val_loss: 10.7752 - val_accuracy10: 0.6385 - val_accuracy20: 0.6191 - val_accuracy30: 0.5907 - val_accuracy50: 0.5347 - 59s/epoch - 38ms/step
Epoch 21/50
1542/1542 - 60s - loss: 10.2707 - accuracy10: 0.6275 - accuracy20: 0.6137 - accuracy30: 0.5930 - accuracy50: 0.5529 - val_loss: 10.7705 - val_accuracy10: 0.6343 - val_accuracy20: 0.6172 - val_accuracy30: 0.5894 - val_accuracy50: 0.5359 - 60s/epoch - 39ms/step
Epoch 22/50
1542/1542 - 59s - loss: 10.2427 - accuracy10: 0.6281 - accuracy20: 0.6146 - accuracy30: 0.5941 - accuracy50: 0.5542 - val_loss: 10.7297 - val_accuracy10: 0.6425 - val_accuracy20: 0.6212 - val_accuracy30: 0.5921 - val_accuracy50: 0.5355 - 59s/epoch - 38ms/step
Epoch 23/50
1542/1542 - 60s - loss: 10.2255 - accuracy10: 0.6294 - accuracy20: 0.6155 - accuracy30: 0.5941 - accuracy50: 0.5540 - val_loss: 10.7917 - val_accuracy10: 0.6423 - val_accuracy20: 0.6208 - val_accuracy30: 0.5911 - val_accuracy50: 0.5348 - 60s/epoch - 39ms/step
Epoch 24/50
1542/1542 - 62s - loss: 10.2099 - accuracy10: 0.6304 - accuracy20: 0.6163 - accuracy30: 0.5951 - accuracy50: 0.5553 - val_loss: 10.7609 - val_accuracy10: 0.6450 - val_accuracy20: 0.6235 - val_accuracy30: 0.5934 - val_accuracy50: 0.5362 - 62s/epoch - 40ms/step
Epoch 25/50
1542/1542 - 60s - loss: 10.1983 - accuracy10: 0.6299 - accuracy20: 0.6170 - accuracy30: 0.5957 - accuracy50: 0.5564 - val_loss: 10.7600 - val_accuracy10: 0.6356 - val_accuracy20: 0.6164 - val_accuracy30: 0.5893 - val_accuracy50: 0.5363 - 60s/epoch - 39ms/step
Epoch 26/50
1542/1542 - 59s - loss: 10.1791 - accuracy10: 0.6300 - accuracy20: 0.6175 - accuracy30: 0.5967 - accuracy50: 0.5569 - val_loss: 10.8484 - val_accuracy10: 0.6301 - val_accuracy20: 0.6128 - val_accuracy30: 0.5865 - val_accuracy50: 0.5331 - 59s/epoch - 38ms/step
Epoch 27/50
1542/1542 - 60s - loss: 10.1610 - accuracy10: 0.6306 - accuracy20: 0.6177 - accuracy30: 0.5966 - accuracy50: 0.5574 - val_loss: 10.8688 - val_accuracy10: 0.6279 - val_accuracy20: 0.6107 - val_accuracy30: 0.5856 - val_accuracy50: 0.5336 - 60s/epoch - 39ms/step
Epoch 28/50
1542/1542 - 59s - loss: 10.1434 - accuracy10: 0.6305 - accuracy20: 0.6181 - accuracy30: 0.5972 - accuracy50: 0.5581 - val_loss: 10.7955 - val_accuracy10: 0.6247 - val_accuracy20: 0.6102 - val_accuracy30: 0.5860 - val_accuracy50: 0.5361 - 59s/epoch - 38ms/step
Epoch 29/50
1542/1542 - 60s - loss: 10.1308 - accuracy10: 0.6319 - accuracy20: 0.6189 - accuracy30: 0.5981 - accuracy50: 0.5588 - val_loss: 10.9028 - val_accuracy10: 0.6184 - val_accuracy20: 0.6050 - val_accuracy30: 0.5806 - val_accuracy50: 0.5317 - 60s/epoch - 39ms/step
Epoch 30/50
1542/1542 - 62s - loss: 10.1064 - accuracy10: 0.6323 - accuracy20: 0.6199 - accuracy30: 0.5995 - accuracy50: 0.5606 - val_loss: 10.8291 - val_accuracy10: 0.6267 - val_accuracy20: 0.6121 - val_accuracy30: 0.5861 - val_accuracy50: 0.5348 - 62s/epoch - 40ms/step
Epoch 31/50
1542/1542 - 61s - loss: 10.0951 - accuracy10: 0.6318 - accuracy20: 0.6200 - accuracy30: 0.5994 - accuracy50: 0.5609 - val_loss: 10.8790 - val_accuracy10: 0.6329 - val_accuracy20: 0.6150 - val_accuracy30: 0.5883 - val_accuracy50: 0.5340 - 61s/epoch - 40ms/step
Epoch 32/50
1542/1542 - 59s - loss: 10.0826 - accuracy10: 0.6333 - accuracy20: 0.6207 - accuracy30: 0.5999 - accuracy50: 0.5621 - val_loss: 10.8685 - val_accuracy10: 0.6272 - val_accuracy20: 0.6127 - val_accuracy30: 0.5873 - val_accuracy50: 0.5347 - 59s/epoch - 38ms/step
testing model: results/WBA/W2/deepVOL_L3/seq2seq
Evaluating performance on  test set...
4353/4353 - 70s - 70s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7679818
{'0': {'precision': 0.48008320112066816, 'recall': 0.483265497975622, 'f1-score': 0.4816690933967211, 'support': 187218}, '1': {'precision': 0.8495694167487331, 'recall': 0.7027693380148687, 'f1-score': 0.7692281530355883, 'support': 740213}, '2': {'precision': 0.3927915284511355, 'recall': 0.6590494335240318, 'f1-score': 0.4922208654674375, 'support': 186857}, 'accuracy': 0.6585577516764068, 'macro avg': {'precision': 0.5741480487735123, 'recall': 0.6150280898381743, 'f1-score': 0.581039370633249, 'support': 1114288}, 'weighted avg': {'precision': 0.7108919687361194, 'recall': 0.6585577516764068, 'f1-score': 0.674461824437783, 'support': 1114288}}
[[ 90476  49539  47203]
 [ 76845 520199 143169]
 [ 21138  42571 123148]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.80277693
{'0': {'precision': 0.549713423514989, 'recall': 0.43642973309097866, 'f1-score': 0.4865648178848254, 'support': 240419}, '1': {'precision': 0.7578866793700428, 'recall': 0.7375690257463656, 'f1-score': 0.747589832071419, 'support': 630924}, '2': {'precision': 0.46350725911752916, 'recall': 0.5903023318034947, 'f1-score': 0.5192767616126761, 'support': 242945}, 'accuracy': 0.6404870195138062, 'macro avg': {'precision': 0.5903691206675203, 'recall': 0.5881003635469463, 'f1-score': 0.5844771371896402, 'support': 1114288}, 'weighted avg': {'precision': 0.6487884801139591, 'recall': 0.6404870195138062, 'f1-score': 0.641492582717279, 'support': 1114288}}
[[104926  77143  58350]
 [ 57931 465350 107643]
 [ 28017  71517 143411]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8501616
{'0': {'precision': 0.5734466062244734, 'recall': 0.3978483396282121, 'f1-score': 0.46977446166273407, 'support': 277739}, '1': {'precision': 0.6791209854249968, 'recall': 0.7580417013097797, 'f1-score': 0.7164144072740508, 'support': 555666}, '2': {'precision': 0.49483502954967035, 'recall': 0.5309043267125458, 'f1-score': 0.512235504259412, 'support': 280883}, 'accuracy': 0.6110072081903422, 'macro avg': {'precision': 0.5824675403997136, 'recall': 0.5622647892168459, 'f1-score': 0.5661414577320656, 'support': 1114288}, 'weighted avg': {'precision': 0.6063276963032406, 'recall': 0.6110072081903422, 'f1-score': 0.6034706129680883, 'support': 1114288}}
[[110498 101336  65905]
 [ 48118 421218  86330]
 [ 34075  97686 149122]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.94002044
{'0': {'precision': 0.5880053693484265, 'recall': 0.3425987522249591, 'f1-score': 0.43294436628918626, 'support': 333714}, '1': {'precision': 0.5508326586337731, 'recall': 0.7753735245612232, 'f1-score': 0.644094508652279, 'support': 447494}, '2': {'precision': 0.5168396328908295, 'recall': 0.4499009247027741, 'f1-score': 0.48105280560366337, 'support': 333080}, 'accuracy': 0.54847400313025, 'macro avg': {'precision': 0.551892553624343, 'recall': 0.5226244004963189, 'f1-score': 0.5193638935150429, 'support': 1114288}, 'weighted avg': {'precision': 0.5518042718692833, 'recall': 0.54847400313025, 'f1-score': 0.5321219404652483, 'support': 1114288}}
[[114330 143169  76215]
 [ 36646 346975  63873]
 [ 43461 139766 149853]]
Evaluating performance on  train set...
1542/1542 - 26s - 26s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8165407
{'0': {'precision': 0.45713030532301757, 'recall': 0.5004676018704075, 'f1-score': 0.47781831169162475, 'support': 74850}, '1': {'precision': 0.8343942639353988, 'recall': 0.6705268176785758, 'f1-score': 0.7435389633665496, 'support': 247486}, '2': {'precision': 0.41609882621884203, 'recall': 0.6552258850568347, 'f1-score': 0.5089749518718878, 'support': 72227}, 'accuracy': 0.6354650588119007, 'macro avg': {'precision': 0.5692077984924194, 'recall': 0.6087401015352727, 'f1-score': 0.5767774089766874, 'support': 394563}, 'weighted avg': {'precision': 0.6862545957909189, 'recall': 0.6354650588119007, 'f1-score': 0.6501925379893777, 'support': 394563}}
[[ 37460  18020  19370]
 [ 34500 165946  47040]
 [  9986  14916  47325]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.84513587
{'0': {'precision': 0.5201181683899557, 'recall': 0.46264860149048215, 'f1-score': 0.4897030518129527, 'support': 95137}, '1': {'precision': 0.7370298924523212, 'recall': 0.7000212706300941, 'f1-score': 0.718049036890479, 'support': 206858}, '2': {'precision': 0.4829157376153419, 'recall': 0.5919432201192637, 'f1-score': 0.531899919916519, 'support': 92568}, 'accuracy': 0.6174299161350659, 'macro avg': {'precision': 0.5800212661525396, 'recall': 0.5848710307466134, 'f1-score': 0.579884002873317, 'support': 394563}, 'weighted avg': {'precision': 0.6251107064742372, 'recall': 0.6174299161350659, 'f1-score': 0.6193180270330769, 'support': 394563}}
[[ 44015  27399  23723]
 [ 27104 144805  34949]
 [ 13506  24267  54795]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.88540107
{'0': {'precision': 0.5391204632761883, 'recall': 0.4328938160657066, 'f1-score': 0.4802026464564959, 'support': 108604}, '1': {'precision': 0.6558246130340489, 'recall': 0.7120772677930247, 'f1-score': 0.6827942926993311, 'support': 179635}, '2': {'precision': 0.5109290833815607, 'recall': 0.5397182197810466, 'f1-score': 0.5249292212276858, 'support': 106324}, 'accuracy': 0.5887855678307393, 'macro avg': {'precision': 0.568624719897266, 'recall': 0.5615631012132593, 'f1-score': 0.5626420534611709, 'support': 394563}, 'weighted avg': {'precision': 0.5846562323823562, 'recall': 0.5887855678307393, 'f1-score': 0.5844903234784258, 'support': 394563}}
[[ 47014  34902  26688]
 [ 23479 127914  28242]
 [ 16712  32227  57385]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.954815
{'0': {'precision': 0.5500830537006276, 'recall': 0.3881027851406728, 'f1-score': 0.45510975834716844, 'support': 127139}, '1': {'precision': 0.5292667359817173, 'recall': 0.7205361960352886, 'f1-score': 0.6102655560534257, 'support': 142709}, '2': {'precision': 0.5293995297522156, 'recall': 0.4693982279597482, 'f1-score': 0.4975966340126225, 'support': 124715}, 'accuracy': 0.5340363896259913, 'macro avg': {'precision': 0.5362497731448536, 'recall': 0.5260124030452366, 'f1-score': 0.5209906494710722, 'support': 394563}, 'weighted avg': {'precision': 0.536016297378889, 'recall': 0.5340363896259913, 'f1-score': 0.5246572816412416, 'support': 394563}}
[[ 49343  46961  30835]
 [ 18678 102827  21204]
 [ 21680  44494  58541]]
Evaluating performance on  val set...
482/482 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.80405545
{'0': {'precision': 0.4613237639553429, 'recall': 0.5223712131473204, 'f1-score': 0.4899532067162125, 'support': 22149}, '1': {'precision': 0.8362277835962046, 'recall': 0.6754289610242036, 'f1-score': 0.7472760797899088, 'support': 79203}, '2': {'precision': 0.4102811104299851, 'recall': 0.6400856179979961, 'f1-score': 0.5000444721159832, 'support': 21958}, 'accuracy': 0.6416430135431027, 'macro avg': {'precision': 0.5692775526605108, 'recall': 0.61262859738984, 'f1-score': 0.579091252874035, 'support': 123310}, 'weighted avg': {'precision': 0.6930383733260782, 'recall': 0.6416430135431026, 'f1-score': 0.6570307147991266, 'support': 123310}}
[[11570  5615  4964]
 [10469 53496 15238]
 [ 3041  4862 14055]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.83839345
{'0': {'precision': 0.5220698976636416, 'recall': 0.4700135590863262, 'f1-score': 0.49467598521716855, 'support': 28763}, '1': {'precision': 0.7382914445692232, 'recall': 0.7053463491295938, 'f1-score': 0.7214429786938075, 'support': 66176}, '2': {'precision': 0.47724613944782407, 'recall': 0.575164780938282, 'f1-score': 0.5216501766219651, 'support': 28371}, 'accuracy': 0.6205011758981429, 'macro avg': {'precision': 0.5792024938935629, 'recall': 0.5835082297180674, 'f1-score': 0.579256380177647, 'support': 123310}, 'weighted avg': {'precision': 0.6277951611757884, 'recall': 0.6205011758981429, 'f1-score': 0.6225797833248284, 'support': 123310}}
[[13519  8738  6506]
 [ 8131 46677 11368]
 [ 4245  7808 16318]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.87965006
{'0': {'precision': 0.5430846668169184, 'recall': 0.436612912967325, 'f1-score': 0.48406321146377396, 'support': 33114}, '1': {'precision': 0.6582634835302912, 'recall': 0.7204881360653169, 'f1-score': 0.6879716745902458, 'support': 57443}, '2': {'precision': 0.5059293213071122, 'recall': 0.5223338320153879, 'f1-score': 0.5140007210671794, 'support': 32753}, 'accuracy': 0.5916227394371908, 'macro avg': {'precision': 0.5690924905514406, 'recall': 0.55981162701601, 'f1-score': 0.5620118690403997, 'support': 123310}, 'weighted avg': {'precision': 0.5868707971955056, 'recall': 0.5916227394371908, 'f1-score': 0.587004230841069, 'support': 123310}}
[[14458 11127  7529]
 [ 6878 41387  9178]
 [ 5286 10359 17108]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.95385957
{'0': {'precision': 0.5503131982856515, 'recall': 0.38671231466227346, 'f1-score': 0.4542307285288826, 'support': 38848}, '1': {'precision': 0.5343560140964105, 'recall': 0.7338384723195515, 'f1-score': 0.6184083044982699, 'support': 45664}, '2': {'precision': 0.5252552552552553, 'recall': 0.4508222073302748, 'f1-score': 0.48520069904851737, 'support': 38798}, 'accuracy': 0.5354310274916876, 'macro avg': {'precision': 0.536641489212439, 'recall': 0.5237909981040333, 'f1-score': 0.51927991069189, 'support': 123310}, 'weighted avg': {'precision': 0.5365197757529225, 'recall': 0.5354310274916876, 'f1-score': 0.5247730831253216, 'support': 123310}}
[[15023 14811  9014]
 [ 5359 33510  6795]
 [ 6917 14390 17491]]
training model: results/WBA/W3/deepLOB_L1/seq2seq
Epoch 1/50
2155/2155 - 56s - loss: 11.4755 - accuracy10: 0.4784 - accuracy20: 0.5008 - accuracy30: 0.5055 - accuracy50: 0.4964 - val_loss: 11.2093 - val_accuracy10: 0.6161 - val_accuracy20: 0.5874 - val_accuracy30: 0.5563 - val_accuracy50: 0.4916 - 56s/epoch - 26ms/step
Epoch 2/50
2155/2155 - 49s - loss: 10.8596 - accuracy10: 0.5469 - accuracy20: 0.5524 - accuracy30: 0.5449 - accuracy50: 0.5235 - val_loss: 10.7118 - val_accuracy10: 0.6214 - val_accuracy20: 0.5981 - val_accuracy30: 0.5708 - val_accuracy50: 0.5185 - 49s/epoch - 23ms/step
Epoch 3/50
2155/2155 - 52s - loss: 10.6323 - accuracy10: 0.5712 - accuracy20: 0.5711 - accuracy30: 0.5588 - accuracy50: 0.5333 - val_loss: 10.6721 - val_accuracy10: 0.6356 - val_accuracy20: 0.6033 - val_accuracy30: 0.5719 - val_accuracy50: 0.5190 - 52s/epoch - 24ms/step
Epoch 4/50
2155/2155 - 49s - loss: 10.4964 - accuracy10: 0.5836 - accuracy20: 0.5795 - accuracy30: 0.5645 - accuracy50: 0.5378 - val_loss: 10.6411 - val_accuracy10: 0.6215 - val_accuracy20: 0.5913 - val_accuracy30: 0.5615 - val_accuracy50: 0.5141 - 49s/epoch - 23ms/step
Epoch 5/50
2155/2155 - 53s - loss: 10.4053 - accuracy10: 0.5905 - accuracy20: 0.5851 - accuracy30: 0.5699 - accuracy50: 0.5412 - val_loss: 10.6673 - val_accuracy10: 0.6427 - val_accuracy20: 0.6076 - val_accuracy30: 0.5718 - val_accuracy50: 0.5152 - 53s/epoch - 24ms/step
Epoch 6/50
2155/2155 - 51s - loss: 10.3397 - accuracy10: 0.5967 - accuracy20: 0.5907 - accuracy30: 0.5744 - accuracy50: 0.5442 - val_loss: 10.6269 - val_accuracy10: 0.6401 - val_accuracy20: 0.6060 - val_accuracy30: 0.5683 - val_accuracy50: 0.5115 - 51s/epoch - 24ms/step
Epoch 7/50
2155/2155 - 52s - loss: 10.2852 - accuracy10: 0.6007 - accuracy20: 0.5945 - accuracy30: 0.5774 - accuracy50: 0.5464 - val_loss: 10.6059 - val_accuracy10: 0.6563 - val_accuracy20: 0.6192 - val_accuracy30: 0.5781 - val_accuracy50: 0.5168 - 52s/epoch - 24ms/step
Epoch 8/50
2155/2155 - 51s - loss: 10.2424 - accuracy10: 0.6031 - accuracy20: 0.5972 - accuracy30: 0.5795 - accuracy50: 0.5482 - val_loss: 10.8499 - val_accuracy10: 0.6539 - val_accuracy20: 0.6134 - val_accuracy30: 0.5677 - val_accuracy50: 0.5068 - 51s/epoch - 23ms/step
Epoch 9/50
2155/2155 - 50s - loss: 10.2061 - accuracy10: 0.6055 - accuracy20: 0.5994 - accuracy30: 0.5816 - accuracy50: 0.5495 - val_loss: 10.9944 - val_accuracy10: 0.6229 - val_accuracy20: 0.5826 - val_accuracy30: 0.5399 - val_accuracy50: 0.4909 - 50s/epoch - 23ms/step
Epoch 10/50
2155/2155 - 51s - loss: 10.1790 - accuracy10: 0.6066 - accuracy20: 0.6006 - accuracy30: 0.5827 - accuracy50: 0.5505 - val_loss: 10.7548 - val_accuracy10: 0.6329 - val_accuracy20: 0.6014 - val_accuracy30: 0.5622 - val_accuracy50: 0.5069 - 51s/epoch - 24ms/step
Epoch 11/50
2155/2155 - 50s - loss: 10.1511 - accuracy10: 0.6082 - accuracy20: 0.6023 - accuracy30: 0.5844 - accuracy50: 0.5518 - val_loss: 10.7517 - val_accuracy10: 0.6270 - val_accuracy20: 0.5971 - val_accuracy30: 0.5587 - val_accuracy50: 0.5056 - 50s/epoch - 23ms/step
Epoch 12/50
2155/2155 - 48s - loss: 10.1278 - accuracy10: 0.6087 - accuracy20: 0.6036 - accuracy30: 0.5852 - accuracy50: 0.5527 - val_loss: 10.8847 - val_accuracy10: 0.6130 - val_accuracy20: 0.5821 - val_accuracy30: 0.5473 - val_accuracy50: 0.4990 - 48s/epoch - 22ms/step
Epoch 13/50
2155/2155 - 45s - loss: 10.1069 - accuracy10: 0.6099 - accuracy20: 0.6044 - accuracy30: 0.5864 - accuracy50: 0.5539 - val_loss: 10.5914 - val_accuracy10: 0.6483 - val_accuracy20: 0.6165 - val_accuracy30: 0.5794 - val_accuracy50: 0.5200 - 45s/epoch - 21ms/step
Epoch 14/50
2155/2155 - 50s - loss: 10.0840 - accuracy10: 0.6107 - accuracy20: 0.6055 - accuracy30: 0.5875 - accuracy50: 0.5545 - val_loss: 10.6659 - val_accuracy10: 0.6270 - val_accuracy20: 0.6005 - val_accuracy30: 0.5687 - val_accuracy50: 0.5154 - 50s/epoch - 23ms/step
Epoch 15/50
2155/2155 - 50s - loss: 10.0663 - accuracy10: 0.6117 - accuracy20: 0.6066 - accuracy30: 0.5887 - accuracy50: 0.5551 - val_loss: 10.6346 - val_accuracy10: 0.6194 - val_accuracy20: 0.5966 - val_accuracy30: 0.5665 - val_accuracy50: 0.5156 - 50s/epoch - 23ms/step
Epoch 16/50
2155/2155 - 48s - loss: 10.0483 - accuracy10: 0.6119 - accuracy20: 0.6070 - accuracy30: 0.5895 - accuracy50: 0.5558 - val_loss: 10.6782 - val_accuracy10: 0.6202 - val_accuracy20: 0.5981 - val_accuracy30: 0.5678 - val_accuracy50: 0.5149 - 48s/epoch - 22ms/step
Epoch 17/50
2155/2155 - 54s - loss: 10.0297 - accuracy10: 0.6131 - accuracy20: 0.6080 - accuracy30: 0.5902 - accuracy50: 0.5567 - val_loss: 10.5531 - val_accuracy10: 0.6299 - val_accuracy20: 0.6070 - val_accuracy30: 0.5772 - val_accuracy50: 0.5232 - 54s/epoch - 25ms/step
Epoch 18/50
2155/2155 - 54s - loss: 10.0161 - accuracy10: 0.6133 - accuracy20: 0.6085 - accuracy30: 0.5910 - accuracy50: 0.5574 - val_loss: 10.5344 - val_accuracy10: 0.6215 - val_accuracy20: 0.6014 - val_accuracy30: 0.5729 - val_accuracy50: 0.5216 - 54s/epoch - 25ms/step
Epoch 19/50
2155/2155 - 53s - loss: 9.9978 - accuracy10: 0.6141 - accuracy20: 0.6100 - accuracy30: 0.5922 - accuracy50: 0.5577 - val_loss: 10.5287 - val_accuracy10: 0.5971 - val_accuracy20: 0.5841 - val_accuracy30: 0.5601 - val_accuracy50: 0.5149 - 53s/epoch - 25ms/step
Epoch 20/50
2155/2155 - 52s - loss: 9.9846 - accuracy10: 0.6150 - accuracy20: 0.6098 - accuracy30: 0.5921 - accuracy50: 0.5583 - val_loss: 10.5739 - val_accuracy10: 0.6096 - val_accuracy20: 0.5923 - val_accuracy30: 0.5642 - val_accuracy50: 0.5151 - 52s/epoch - 24ms/step
Epoch 21/50
2155/2155 - 52s - loss: 9.9739 - accuracy10: 0.6151 - accuracy20: 0.6107 - accuracy30: 0.5935 - accuracy50: 0.5591 - val_loss: 10.4922 - val_accuracy10: 0.5947 - val_accuracy20: 0.5828 - val_accuracy30: 0.5590 - val_accuracy50: 0.5156 - 52s/epoch - 24ms/step
Epoch 22/50
2155/2155 - 51s - loss: 9.9627 - accuracy10: 0.6150 - accuracy20: 0.6105 - accuracy30: 0.5936 - accuracy50: 0.5597 - val_loss: 10.5192 - val_accuracy10: 0.6170 - val_accuracy20: 0.5933 - val_accuracy30: 0.5591 - val_accuracy50: 0.5088 - 51s/epoch - 24ms/step
Epoch 23/50
2155/2155 - 53s - loss: 9.9488 - accuracy10: 0.6156 - accuracy20: 0.6112 - accuracy30: 0.5947 - accuracy50: 0.5610 - val_loss: 10.4735 - val_accuracy10: 0.5848 - val_accuracy20: 0.5651 - val_accuracy30: 0.5366 - val_accuracy50: 0.4983 - 53s/epoch - 25ms/step
Epoch 24/50
2155/2155 - 53s - loss: 9.9350 - accuracy10: 0.6164 - accuracy20: 0.6118 - accuracy30: 0.5948 - accuracy50: 0.5610 - val_loss: 10.6678 - val_accuracy10: 0.5758 - val_accuracy20: 0.5622 - val_accuracy30: 0.5379 - val_accuracy50: 0.5002 - 53s/epoch - 25ms/step
Epoch 25/50
2155/2155 - 50s - loss: 9.9228 - accuracy10: 0.6175 - accuracy20: 0.6130 - accuracy30: 0.5961 - accuracy50: 0.5620 - val_loss: 10.5079 - val_accuracy10: 0.5891 - val_accuracy20: 0.5705 - val_accuracy30: 0.5436 - val_accuracy50: 0.5025 - 50s/epoch - 23ms/step
Epoch 26/50
2155/2155 - 50s - loss: 9.9139 - accuracy10: 0.6174 - accuracy20: 0.6131 - accuracy30: 0.5963 - accuracy50: 0.5622 - val_loss: 10.4700 - val_accuracy10: 0.6204 - val_accuracy20: 0.5967 - val_accuracy30: 0.5641 - val_accuracy50: 0.5112 - 50s/epoch - 23ms/step
Epoch 27/50
2155/2155 - 51s - loss: 9.9038 - accuracy10: 0.6179 - accuracy20: 0.6137 - accuracy30: 0.5966 - accuracy50: 0.5626 - val_loss: 10.5825 - val_accuracy10: 0.5924 - val_accuracy20: 0.5672 - val_accuracy30: 0.5339 - val_accuracy50: 0.4915 - 51s/epoch - 24ms/step
Epoch 28/50
2155/2155 - 50s - loss: 9.8930 - accuracy10: 0.6177 - accuracy20: 0.6139 - accuracy30: 0.5967 - accuracy50: 0.5626 - val_loss: 10.4446 - val_accuracy10: 0.6091 - val_accuracy20: 0.5890 - val_accuracy30: 0.5586 - val_accuracy50: 0.5096 - 50s/epoch - 23ms/step
Epoch 29/50
2155/2155 - 51s - loss: 9.8765 - accuracy10: 0.6188 - accuracy20: 0.6154 - accuracy30: 0.5982 - accuracy50: 0.5636 - val_loss: 10.4717 - val_accuracy10: 0.6228 - val_accuracy20: 0.5943 - val_accuracy30: 0.5555 - val_accuracy50: 0.5018 - 51s/epoch - 24ms/step
Epoch 30/50
2155/2155 - 50s - loss: 9.8662 - accuracy10: 0.6189 - accuracy20: 0.6153 - accuracy30: 0.5984 - accuracy50: 0.5644 - val_loss: 10.4343 - val_accuracy10: 0.6103 - val_accuracy20: 0.5943 - val_accuracy30: 0.5673 - val_accuracy50: 0.5173 - 50s/epoch - 23ms/step
Epoch 31/50
2155/2155 - 50s - loss: 9.8628 - accuracy10: 0.6192 - accuracy20: 0.6154 - accuracy30: 0.5981 - accuracy50: 0.5642 - val_loss: 10.3709 - val_accuracy10: 0.6291 - val_accuracy20: 0.6043 - val_accuracy30: 0.5703 - val_accuracy50: 0.5160 - 50s/epoch - 23ms/step
Epoch 32/50
2155/2155 - 49s - loss: 9.8452 - accuracy10: 0.6195 - accuracy20: 0.6158 - accuracy30: 0.5993 - accuracy50: 0.5650 - val_loss: 10.5926 - val_accuracy10: 0.5434 - val_accuracy20: 0.5370 - val_accuracy30: 0.5187 - val_accuracy50: 0.4890 - 49s/epoch - 23ms/step
Epoch 33/50
2155/2155 - 49s - loss: 9.8372 - accuracy10: 0.6198 - accuracy20: 0.6159 - accuracy30: 0.5996 - accuracy50: 0.5654 - val_loss: 10.7394 - val_accuracy10: 0.5569 - val_accuracy20: 0.5324 - val_accuracy30: 0.5058 - val_accuracy50: 0.4779 - 49s/epoch - 23ms/step
Epoch 34/50
2155/2155 - 47s - loss: 9.8285 - accuracy10: 0.6204 - accuracy20: 0.6165 - accuracy30: 0.6002 - accuracy50: 0.5664 - val_loss: 10.5683 - val_accuracy10: 0.5791 - val_accuracy20: 0.5635 - val_accuracy30: 0.5385 - val_accuracy50: 0.4994 - 47s/epoch - 22ms/step
Epoch 35/50
2155/2155 - 48s - loss: 9.8151 - accuracy10: 0.6207 - accuracy20: 0.6167 - accuracy30: 0.6004 - accuracy50: 0.5668 - val_loss: 10.4854 - val_accuracy10: 0.5976 - val_accuracy20: 0.5775 - val_accuracy30: 0.5485 - val_accuracy50: 0.5037 - 48s/epoch - 22ms/step
Epoch 36/50
2155/2155 - 45s - loss: 9.8046 - accuracy10: 0.6210 - accuracy20: 0.6177 - accuracy30: 0.6013 - accuracy50: 0.5672 - val_loss: 10.6425 - val_accuracy10: 0.5424 - val_accuracy20: 0.5367 - val_accuracy30: 0.5212 - val_accuracy50: 0.4927 - 45s/epoch - 21ms/step
Epoch 37/50
2155/2155 - 49s - loss: 9.7953 - accuracy10: 0.6217 - accuracy20: 0.6177 - accuracy30: 0.6014 - accuracy50: 0.5676 - val_loss: 10.7853 - val_accuracy10: 0.5284 - val_accuracy20: 0.5173 - val_accuracy30: 0.5014 - val_accuracy50: 0.4779 - 49s/epoch - 23ms/step
Epoch 38/50
2155/2155 - 48s - loss: 9.7844 - accuracy10: 0.6217 - accuracy20: 0.6184 - accuracy30: 0.6024 - accuracy50: 0.5683 - val_loss: 10.8224 - val_accuracy10: 0.5327 - val_accuracy20: 0.5244 - val_accuracy30: 0.5072 - val_accuracy50: 0.4799 - 48s/epoch - 22ms/step
Epoch 39/50
2155/2155 - 49s - loss: 9.7767 - accuracy10: 0.6216 - accuracy20: 0.6179 - accuracy30: 0.6019 - accuracy50: 0.5685 - val_loss: 10.8659 - val_accuracy10: 0.5573 - val_accuracy20: 0.5285 - val_accuracy30: 0.5013 - val_accuracy50: 0.4716 - 49s/epoch - 23ms/step
Epoch 40/50
2155/2155 - 52s - loss: 9.7635 - accuracy10: 0.6222 - accuracy20: 0.6193 - accuracy30: 0.6033 - accuracy50: 0.5700 - val_loss: 11.1180 - val_accuracy10: 0.4920 - val_accuracy20: 0.4895 - val_accuracy30: 0.4816 - val_accuracy50: 0.4686 - 52s/epoch - 24ms/step
Epoch 41/50
2155/2155 - 49s - loss: 9.7544 - accuracy10: 0.6227 - accuracy20: 0.6194 - accuracy30: 0.6038 - accuracy50: 0.5696 - val_loss: 10.9274 - val_accuracy10: 0.5221 - val_accuracy20: 0.5090 - val_accuracy30: 0.4930 - val_accuracy50: 0.4706 - 49s/epoch - 23ms/step
testing model: results/WBA/W3/deepLOB_L1/seq2seq
Evaluating performance on  test set...
6315/6315 - 57s - 57s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.80107445
{'0': {'precision': 0.3797515012824254, 'recall': 0.5483699268130405, 'f1-score': 0.4487436593134363, 'support': 225450}, '1': {'precision': 0.8780078894219427, 'recall': 0.5970134018637717, 'f1-score': 0.7107456414681531, 'support': 1165808}, '2': {'precision': 0.31390662009715364, 'recall': 0.6944631945431292, 'f1-score': 0.4323742956519816, 'support': 225184}, 'accuracy': 0.6038045287118251, 'macro avg': {'precision': 0.5238886702671739, 'recall': 0.6132821744066471, 'f1-score': 0.5306211988111903, 'support': 1616442}, 'weighted avg': {'precision': 0.7299305176772792, 'recall': 0.6038045287118251, 'f1-score': 0.635423965829281, 'support': 1616442}}
[[123630  58041  43779]
 [171786 696003 298019]
 [ 30139  38663 156382]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.83656025
{'0': {'precision': 0.43685033915100097, 'recall': 0.505431765397667, 'f1-score': 0.46864529648988146, 'support': 304413}, '1': {'precision': 0.7931506144906669, 'recall': 0.6124919464599666, 'f1-score': 0.691211801920344, 'support': 1007321}, '2': {'precision': 0.3923336465450418, 'recall': 0.6262224818514774, 'f1-score': 0.482424371134177, 'support': 304708}, 'accuracy': 0.5949183453535605, 'macro avg': {'precision': 0.5407782000622365, 'recall': 0.5813820645697036, 'f1-score': 0.5474271565148009, 'support': 1616442}, 'weighted avg': {'precision': 0.6504949717977963, 'recall': 0.5949183453535605, 'f1-score': 0.6099398861463201, 'support': 1616442}}
[[153860  89801  60752]
 [155553 616976 234792]
 [ 42790  71103 190815]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8850125
{'0': {'precision': 0.45302019429690754, 'recall': 0.48943382777512245, 'f1-score': 0.4705235535346238, 'support': 361957}, '1': {'precision': 0.7216870631262308, 'recall': 0.5982989840999304, 'f1-score': 0.6542260618797373, 'support': 891820}, '2': {'precision': 0.4312731073332414, 'recall': 0.5779962224091103, 'f1-score': 0.49396968582982204, 'support': 362665}, 'accuracy': 0.5693665470211736, 'macro avg': {'precision': 0.5353267882521265, 'recall': 0.5552430114280544, 'f1-score': 0.5395731004147276, 'support': 1616442}, 'weighted avg': {'precision': 0.5963693399301496, 'recall': 0.5693665470211736, 'f1-score': 0.577135892586181, 'support': 1616442}}
[[177154 109674  75129]
 [156946 533575 201299]
 [ 56951  96095 209619]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.95352924
{'0': {'precision': 0.4683061760011542, 'recall': 0.46301208041724246, 'f1-score': 0.4656440810178336, 'support': 448660}, '1': {'precision': 0.6006485549740053, 'recall': 0.5713304528085117, 'f1-score': 0.5856227946290283, 'support': 720702}, '2': {'precision': 0.46732398990417173, 'recall': 0.509396528585488, 'f1-score': 0.48745411543112765, 'support': 447080}, 'accuracy': 0.5241357252533652, 'macro avg': {'precision': 0.512092906959777, 'recall': 0.514579687270414, 'f1-score': 0.5129069970259965, 'support': 1616442}, 'weighted avg': {'precision': 0.5270402978875273, 'recall': 0.5241357252533652, 'f1-score': 0.5251697114100845, 'support': 1616442}}
[[207735 140808 100117]
 [149471 411759 159472]
 [ 86382 132957 227741]]
Evaluating performance on  train set...
2155/2155 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8278363
{'0': {'precision': 0.35551734477209174, 'recall': 0.6520943701176259, 'f1-score': 0.4601591179999763, 'support': 89096}, '1': {'precision': 0.8272047488326653, 'recall': 0.6020135062800417, 'f1-score': 0.6968682767307405, 'support': 369902}, '2': {'precision': 0.405669500576032, 'recall': 0.5212819986384708, 'f1-score': 0.45626596046533624, 'support': 92543}, 'accuracy': 0.5965576448532385, 'macro avg': {'precision': 0.5294638647269296, 'recall': 0.5917966250120461, 'f1-score': 0.5377644517320177, 'support': 551541}, 'weighted avg': {'precision': 0.6802789583083082, 'recall': 0.5965576448532385, 'f1-score': 0.6182596159776406, 'support': 551541}}
[[ 58099  19431  11566]
 [ 88106 222686  59110]
 [ 17216  27086  48241]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.87265843
{'0': {'precision': 0.417819170663959, 'recall': 0.6062350769647604, 'f1-score': 0.4946937873093081, 'support': 118106}, '1': {'precision': 0.7260991873704621, 'recall': 0.6113339246461764, 'f1-score': 0.663792546945797, 'support': 311172}, '2': {'precision': 0.47976071615927435, 'recall': 0.46376254467827555, 'f1-score': 0.47162599969224245, 'support': 122263}, 'accuracy': 0.577529141079267, 'macro avg': {'precision': 0.5412263580645651, 'recall': 0.5604438487630709, 'f1-score': 0.5433707779824491, 'support': 551541}, 'weighted avg': {'precision': 0.605477510724788, 'recall': 0.577529141079267, 'f1-score': 0.5849834707891949, 'support': 551541}}
[[ 71600  30419  16087]
 [ 75544 190230  45398]
 [ 24222  41340  56701]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9130709
{'0': {'precision': 0.4505669737774628, 'recall': 0.5701628768153677, 'f1-score': 0.5033585758616727, 'support': 138264}, '1': {'precision': 0.6440246863071276, 'recall': 0.6166356860150999, 'f1-score': 0.6300326606128114, 'support': 270599}, '2': {'precision': 0.5136356672284357, 'recall': 0.42294537349836697, 'f1-score': 0.4638996940391445, 'support': 142678}, 'accuracy': 0.5548798729378233, 'macro avg': {'precision': 0.5360757757710087, 'recall': 0.5365813121096116, 'f1-score': 0.5324303101712095, 'support': 551541}, 'weighted avg': {'precision': 0.5617971064367078, 'recall': 0.5548798729378233, 'f1-score': 0.5553002562061959, 'support': 551541}}
[[ 78833  39949  19482]
 [ 66079 166861  37659]
 [ 30052  52281  60345]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.97926795
{'0': {'precision': 0.48492405606084543, 'recall': 0.5168160963084565, 'f1-score': 0.5003624084882181, 'support': 166299}, '1': {'precision': 0.5168226515749486, 'recall': 0.6217687838558478, 'f1-score': 0.564459175678459, 'support': 213774}, '2': {'precision': 0.5405303871177063, 'recall': 0.3692117479646348, 'f1-score': 0.4387400810838906, 'support': 171468}, 'accuracy': 0.5116065714062962, 'macro avg': {'precision': 0.5140923649178334, 'recall': 0.5025988760429797, 'f1-score': 0.5011872217501893, 'support': 551541}, 'weighted avg': {'precision': 0.5145751549475822, 'recall': 0.5116065714062962, 'f1-score': 0.5060482325229886, 'support': 551541}}
[[ 85946  55532  24821]
 [ 51863 132918  28993]
 [ 39427  68733  63308]]
Evaluating performance on  val set...
746/746 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7730416
{'0': {'precision': 0.3731375985977213, 'recall': 0.5723728433788932, 'f1-score': 0.4517640817048368, 'support': 26778}, '1': {'precision': 0.8602480563113, 'recall': 0.647497795494793, 'f1-score': 0.738862878479181, 'support': 137219}, '2': {'precision': 0.3432697488953551, 'recall': 0.595208730425683, 'f1-score': 0.43542213473315833, 'support': 26757}, 'accuracy': 0.6296172033089739, 'macro avg': {'precision': 0.5255518012681254, 'recall': 0.605026456433123, 'f1-score': 0.542016364972392, 'support': 190754}, 'weighted avg': {'precision': 0.7193512341834145, 'recall': 0.6296172033089739, 'f1-score': 0.6559964874182559, 'support': 190754}}
[[15327  7384  4067]
 [21968 88849 26402]
 [ 3781  7050 15926]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.82827455
{'0': {'precision': 0.4243641822677499, 'recall': 0.5333222351700794, 'f1-score': 0.4726450121714328, 'support': 36042}, '1': {'precision': 0.7705927250085364, 'recall': 0.6484876144113993, 'f1-score': 0.7042868878415031, 'support': 118323}, '2': {'precision': 0.4193182808822247, 'recall': 0.5287312099810382, 'f1-score': 0.46771115675859637, 'support': 36389}, 'accuracy': 0.6038824873921386, 'macro avg': {'precision': 0.5380917293861703, 'recall': 0.5701803531875057, 'f1-score': 0.5482143522571774, 'support': 190754}, 'weighted avg': {'precision': 0.6381640740508853, 'recall': 0.6038824873921386, 'f1-score': 0.6153891936318059, 'support': 190754}}
[[19222 11158  5662]
 [20610 76731 20982]
 [ 5464 11685 19240]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8847014
{'0': {'precision': 0.4426081368729668, 'recall': 0.5133454443823365, 'f1-score': 0.4753596307718852, 'support': 42936}, '1': {'precision': 0.6920851654709558, 'recall': 0.6301759561690022, 'f1-score': 0.6596812441405173, 'support': 104401}, '2': {'precision': 0.45369765110907745, 'recall': 0.4795817306584978, 'f1-score': 0.4662807492918006, 'support': 43417}, 'accuracy': 0.5696027344118603, 'macro avg': {'precision': 0.529463651151, 'recall': 0.5410343770699455, 'f1-score': 0.5337738747347344, 'support': 190754}, 'weighted avg': {'precision': 0.5816727158712991, 'recall': 0.5696027344118603, 'f1-score': 0.5741737209617513, 'support': 190754}}
[[22041 13972  6923]
 [20461 65791 18149]
 [ 7296 15299 20822]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9624584
{'0': {'precision': 0.4626359065580019, 'recall': 0.47801053993736053, 'f1-score': 0.4701975759588245, 'support': 53321}, '1': {'precision': 0.5636535573232464, 'recall': 0.6058837598660608, 'f1-score': 0.5840062246044783, 'support': 83620}, '2': {'precision': 0.4903879762320867, 'recall': 0.41714827272220467, 'f1-score': 0.4508128407755877, 'support': 53813}, 'accuracy': 0.5168961070278998, 'macro avg': {'precision': 0.505559146704445, 'recall': 0.5003475241752087, 'f1-score': 0.5016722137796301, 'support': 190754}, 'weighted avg': {'precision': 0.5147476215540768, 'recall': 0.5168961070278998, 'f1-score': 0.5146188119241728, 'support': 190754}}
[[25488 18743  9090]
 [18718 50664 14238]
 [10887 20478 22448]]
training model: results/WBA/W3/deepOF_L1/seq2seq
Epoch 1/50
2155/2155 - 50s - loss: 12.4998 - accuracy10: 0.4160 - accuracy20: 0.4364 - accuracy30: 0.4444 - accuracy50: 0.4453 - val_loss: 12.1514 - val_accuracy10: 0.6623 - val_accuracy20: 0.6009 - val_accuracy30: 0.5460 - val_accuracy50: 0.4498 - 50s/epoch - 23ms/step
Epoch 2/50
2155/2155 - 46s - loss: 12.4551 - accuracy10: 0.3934 - accuracy20: 0.4205 - accuracy30: 0.4332 - accuracy50: 0.4395 - val_loss: 12.0399 - val_accuracy10: 0.6499 - val_accuracy20: 0.5959 - val_accuracy30: 0.5473 - val_accuracy50: 0.4562 - 46s/epoch - 21ms/step
Epoch 3/50
2155/2155 - 48s - loss: 12.4043 - accuracy10: 0.4062 - accuracy20: 0.4298 - accuracy30: 0.4411 - accuracy50: 0.4424 - val_loss: 11.9251 - val_accuracy10: 0.6797 - val_accuracy20: 0.6136 - val_accuracy30: 0.5578 - val_accuracy50: 0.4616 - 48s/epoch - 22ms/step
Epoch 4/50
2155/2155 - 45s - loss: 12.3366 - accuracy10: 0.4259 - accuracy20: 0.4432 - accuracy30: 0.4506 - accuracy50: 0.4488 - val_loss: 11.8814 - val_accuracy10: 0.6782 - val_accuracy20: 0.6131 - val_accuracy30: 0.5593 - val_accuracy50: 0.4648 - 45s/epoch - 21ms/step
Epoch 5/50
2155/2155 - 46s - loss: 12.2794 - accuracy10: 0.4371 - accuracy20: 0.4508 - accuracy30: 0.4565 - accuracy50: 0.4532 - val_loss: 11.8522 - val_accuracy10: 0.6830 - val_accuracy20: 0.6158 - val_accuracy30: 0.5614 - val_accuracy50: 0.4670 - 46s/epoch - 22ms/step
Epoch 6/50
2155/2155 - 45s - loss: 12.2354 - accuracy10: 0.4434 - accuracy20: 0.4547 - accuracy30: 0.4587 - accuracy50: 0.4554 - val_loss: 11.8103 - val_accuracy10: 0.6793 - val_accuracy20: 0.6146 - val_accuracy30: 0.5622 - val_accuracy50: 0.4702 - 45s/epoch - 21ms/step
Epoch 7/50
2155/2155 - 44s - loss: 12.1930 - accuracy10: 0.4478 - accuracy20: 0.4582 - accuracy30: 0.4626 - accuracy50: 0.4587 - val_loss: 11.7664 - val_accuracy10: 0.6741 - val_accuracy20: 0.6101 - val_accuracy30: 0.5607 - val_accuracy50: 0.4724 - 44s/epoch - 21ms/step
Epoch 8/50
2155/2155 - 47s - loss: 12.1523 - accuracy10: 0.4520 - accuracy20: 0.4619 - accuracy30: 0.4649 - accuracy50: 0.4608 - val_loss: 11.7921 - val_accuracy10: 0.6778 - val_accuracy20: 0.6107 - val_accuracy30: 0.5598 - val_accuracy50: 0.4720 - 47s/epoch - 22ms/step
Epoch 9/50
2155/2155 - 48s - loss: 12.1120 - accuracy10: 0.4571 - accuracy20: 0.4660 - accuracy30: 0.4682 - accuracy50: 0.4634 - val_loss: 11.7622 - val_accuracy10: 0.6760 - val_accuracy20: 0.6091 - val_accuracy30: 0.5595 - val_accuracy50: 0.4741 - 48s/epoch - 22ms/step
Epoch 10/50
2155/2155 - 43s - loss: 12.0757 - accuracy10: 0.4602 - accuracy20: 0.4693 - accuracy30: 0.4711 - accuracy50: 0.4657 - val_loss: 11.7723 - val_accuracy10: 0.6775 - val_accuracy20: 0.6109 - val_accuracy30: 0.5602 - val_accuracy50: 0.4745 - 43s/epoch - 20ms/step
Epoch 11/50
2155/2155 - 49s - loss: 12.0344 - accuracy10: 0.4647 - accuracy20: 0.4736 - accuracy30: 0.4744 - accuracy50: 0.4684 - val_loss: 11.7845 - val_accuracy10: 0.6783 - val_accuracy20: 0.6107 - val_accuracy30: 0.5596 - val_accuracy50: 0.4751 - 49s/epoch - 23ms/step
Epoch 12/50
2155/2155 - 45s - loss: 11.9990 - accuracy10: 0.4662 - accuracy20: 0.4749 - accuracy30: 0.4759 - accuracy50: 0.4695 - val_loss: 11.7828 - val_accuracy10: 0.6722 - val_accuracy20: 0.6071 - val_accuracy30: 0.5585 - val_accuracy50: 0.4761 - 45s/epoch - 21ms/step
Epoch 13/50
2155/2155 - 51s - loss: 11.9730 - accuracy10: 0.4686 - accuracy20: 0.4769 - accuracy30: 0.4774 - accuracy50: 0.4710 - val_loss: 11.7724 - val_accuracy10: 0.6704 - val_accuracy20: 0.6064 - val_accuracy30: 0.5579 - val_accuracy50: 0.4763 - 51s/epoch - 24ms/step
Epoch 14/50
2155/2155 - 49s - loss: 11.9461 - accuracy10: 0.4705 - accuracy20: 0.4789 - accuracy30: 0.4787 - accuracy50: 0.4717 - val_loss: 11.8075 - val_accuracy10: 0.6692 - val_accuracy20: 0.6042 - val_accuracy30: 0.5569 - val_accuracy50: 0.4772 - 49s/epoch - 23ms/step
Epoch 15/50
2155/2155 - 46s - loss: 11.9227 - accuracy10: 0.4718 - accuracy20: 0.4809 - accuracy30: 0.4806 - accuracy50: 0.4737 - val_loss: 11.7884 - val_accuracy10: 0.6704 - val_accuracy20: 0.6062 - val_accuracy30: 0.5575 - val_accuracy50: 0.4770 - 46s/epoch - 21ms/step
Epoch 16/50
2155/2155 - 45s - loss: 11.8978 - accuracy10: 0.4726 - accuracy20: 0.4819 - accuracy30: 0.4815 - accuracy50: 0.4747 - val_loss: 11.7669 - val_accuracy10: 0.6711 - val_accuracy20: 0.6070 - val_accuracy30: 0.5588 - val_accuracy50: 0.4787 - 45s/epoch - 21ms/step
Epoch 17/50
2155/2155 - 47s - loss: 11.8701 - accuracy10: 0.4748 - accuracy20: 0.4839 - accuracy30: 0.4832 - accuracy50: 0.4761 - val_loss: 11.7925 - val_accuracy10: 0.6678 - val_accuracy20: 0.6038 - val_accuracy30: 0.5569 - val_accuracy50: 0.4785 - 47s/epoch - 22ms/step
Epoch 18/50
2155/2155 - 48s - loss: 11.8500 - accuracy10: 0.4757 - accuracy20: 0.4846 - accuracy30: 0.4838 - accuracy50: 0.4776 - val_loss: 11.8029 - val_accuracy10: 0.6686 - val_accuracy20: 0.6049 - val_accuracy30: 0.5578 - val_accuracy50: 0.4796 - 48s/epoch - 22ms/step
Epoch 19/50
2155/2155 - 50s - loss: 11.8203 - accuracy10: 0.4775 - accuracy20: 0.4861 - accuracy30: 0.4853 - accuracy50: 0.4785 - val_loss: 11.7997 - val_accuracy10: 0.6635 - val_accuracy20: 0.6018 - val_accuracy30: 0.5558 - val_accuracy50: 0.4789 - 50s/epoch - 23ms/step
testing model: results/WBA/W3/deepOF_L1/seq2seq
Evaluating performance on  test set...
6315/6315 - 60s - 60s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.83156854
{'0': {'precision': 0.3308609579837268, 'recall': 0.27740198448429576, 'f1-score': 0.30178227185979234, 'support': 225449}, '1': {'precision': 0.755149460370982, 'recall': 0.8391105903464295, 'f1-score': 0.794919134060394, 'support': 1165807}, '2': {'precision': 0.373000780368061, 'recall': 0.21863203986109014, 'f1-score': 0.27567747661484276, 'support': 225182}, 'accuracy': 0.6743302248524224, 'macro avg': {'precision': 0.48633706624092327, 'recall': 0.44504820489727187, 'f1-score': 0.4574596275116763, 'support': 1616438}, 'weighted avg': {'precision': 0.6427365978701486, 'recall': 0.6743302248524224, 'f1-score': 0.653805718418614, 'support': 1616438}}
[[ 62540 152978   9931]
 [114740 978241  72826]
 [ 11742 164208  49232]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.89838237
{'0': {'precision': 0.3941197476490894, 'recall': 0.2827952997756323, 'f1-score': 0.3293033966609097, 'support': 304411}, '1': {'precision': 0.659417785793519, 'recall': 0.8297414627511984, 'f1-score': 0.7348391767813552, 'support': 1007321}, '2': {'precision': 0.4544312138905491, 'recall': 0.19463351558551523, 'f1-score': 0.27253844103563324, 'support': 304706}, 'accuracy': 0.6070186422244466, 'macro avg': {'precision': 0.5026562491110524, 'recall': 0.4357234260374487, 'f1-score': 0.4455603381592994, 'support': 1616438}, 'weighted avg': {'precision': 0.570815389989999, 'recall': 0.6070186422244466, 'f1-score': 0.5713220110451, 'support': 1616438}}
[[ 86086 206212  12113]
 [112418 835816  59087]
 [ 19922 225478  59306]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.94912887
{'0': {'precision': 0.43550185440041056, 'recall': 0.2579105137378956, 'f1-score': 0.3239645329770436, 'support': 361955}, '1': {'precision': 0.5834118543221039, 'recall': 0.840766073871409, 'f1-score': 0.6888365343937338, 'support': 891820}, '2': {'precision': 0.5010696193866374, 'recall': 0.16146394862448057, 'f1-score': 0.2442281665057442, 'support': 362663}, 'accuracy': 0.5578444703725104, 'macro avg': {'precision': 0.5066611093697172, 'recall': 0.42004684541126175, 'f1-score': 0.4190097446255072, 'support': 1616438}, 'weighted avg': {'precision': 0.5318173941757465, 'recall': 0.5578444703725104, 'f1-score': 0.5073818483518688, 'support': 1616438}}
[[ 93352 256292  12311]
 [ 96012 749812  45996]
 [ 24991 279115  58557]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0245669
{'0': {'precision': 0.4863624387416346, 'recall': 0.20571794105978272, 'f1-score': 0.2891383210009586, 'support': 448658}, '1': {'precision': 0.46808184108589823, 'recall': 0.8633276999370059, 'f1-score': 0.6070378899891266, 'support': 720702}, '2': {'precision': 0.5470028436797422, 'recall': 0.11918054567659335, 'f1-score': 0.19571817141639747, 'support': 447078}, 'accuracy': 0.474983884318483, 'macro avg': {'precision': 0.5004823745024249, 'recall': 0.396075395557794, 'f1-score': 0.3639647941354942, 'support': 1616438}, 'weighted avg': {'precision': 0.4949839433506791, 'recall': 0.474983884318483, 'f1-score': 0.4050380718933183, 'support': 1616438}}
[[ 92297 343116  13245]
 [ 67619 622202  30881]
 [ 29854 363941  53283]]
Evaluating performance on  train set...
2155/2155 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8682718
{'0': {'precision': 0.3625855154517575, 'recall': 0.27610985112164016, 'f1-score': 0.3134935304990758, 'support': 89066}, '1': {'precision': 0.7044778087773511, 'recall': 0.8378531134560363, 'f1-score': 0.7653985496057799, 'support': 369782}, '2': {'precision': 0.4115102672676775, 'recall': 0.19500933188050878, 'f1-score': 0.26461912325518416, 'support': 92693}, 'accuracy': 0.6391020794464962, 'macro avg': {'precision': 0.49285786383226204, 'recall': 0.4363240988193951, 'f1-score': 0.44783706778668003, 'support': 551541}, 'weighted avg': {'precision': 0.6000304162489742, 'recall': 0.6391020794464962, 'f1-score': 0.6082604224339586, 'support': 551541}}
[[ 24592  61061   3413]
 [ 37522 309823  22437]
 [  5710  68907  18076]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.93982434
{'0': {'precision': 0.42171926388993497, 'recall': 0.28420963580220804, 'f1-score': 0.33957153037141113, 'support': 118205}, '1': {'precision': 0.5997068133222533, 'recall': 0.8258923979014504, 'f1-score': 0.6948563020982652, 'support': 311072}, '2': {'precision': 0.4934342156704919, 'recall': 0.17548910554210562, 'f1-score': 0.2589006135857662, 'support': 122264}, 'accuracy': 0.5656206882171951, 'macro avg': {'precision': 0.5049534309608933, 'recall': 0.428530379748588, 'f1-score': 0.43110948201848087, 'support': 551541}, 'weighted avg': {'precision': 0.5380027311960974, 'recall': 0.5656206882171951, 'f1-score': 0.5220711007401341, 'support': 551541}}
[[ 33595  80248   4362]
 [ 36495 256912  17665]
 [  9572  91236  21456]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9896754
{'0': {'precision': 0.46224139471366765, 'recall': 0.261936790337745, 'f1-score': 0.3343873919205255, 'support': 138270}, '1': {'precision': 0.5221116804600667, 'recall': 0.8371717574736594, 'f1-score': 0.6431287852557371, 'support': 270684}, '2': {'precision': 0.5408283117148401, 'recall': 0.14854790408662782, 'f1-score': 0.23307712199657774, 'support': 142587}, 'accuracy': 0.5149354263780934, 'macro avg': {'precision': 0.5083937956295248, 'recall': 0.4158854839660107, 'f1-score': 0.4035310997242801, 'support': 551541}, 'weighted avg': {'precision': 0.5119410565002337, 'recall': 0.5149354263780934, 'f1-score': 0.45971955735501263, 'support': 551541}}
[[ 36218  97523   4529]
 [ 30621 226609  13454]
 [ 11514 109892  21181]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0603029
{'0': {'precision': 0.5117417950627183, 'recall': 0.21485039587829674, 'f1-score': 0.3026399915317032, 'support': 166339}, '1': {'precision': 0.40968591926692965, 'recall': 0.8605978655013171, 'f1-score': 0.5551119078661452, 'support': 213727}, '2': {'precision': 0.5867639872953824, 'recall': 0.11204548768041989, 'f1-score': 0.18816074899984822, 'support': 171475}, 'accuracy': 0.43312101910828027, 'macro avg': {'precision': 0.5027305672083434, 'recall': 0.395831249686678, 'f1-score': 0.34863754946589887, 'support': 551541}, 'weighted avg': {'precision': 0.49551876585344745, 'recall': 0.43312101910828027, 'f1-score': 0.36488330100327726, 'support': 551541}}
[[ 35738 125774   4827]
 [ 21090 183933   8704]
 [ 13008 139254  19213]]
Evaluating performance on  val set...
746/746 - 7s - 7s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8279512
{'0': {'precision': 0.35217887893164646, 'recall': 0.29890757242459265, 'f1-score': 0.323363920540486, 'support': 26821}, '1': {'precision': 0.7566489010844041, 'recall': 0.8368118119943683, 'f1-score': 0.794713961584426, 'support': 137081}, '2': {'precision': 0.3729630759841318, 'recall': 0.22758928903951436, 'f1-score': 0.2826810990840966, 'support': 26851}, 'accuracy': 0.6754231912473199, 'macro avg': {'precision': 0.49393028533339417, 'recall': 0.45443622448615845, 'f1-score': 0.46691966040300287, 'support': 190753}, 'weighted avg': {'precision': 0.6457691846242356, 'recall': 0.6754231912473199, 'f1-score': 0.656363981024037, 'support': 190753}}
[[  8017  17715   1089]
 [ 13185 114711   9185]
 [  1562  19178   6111]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8946917
{'0': {'precision': 0.4178452739778963, 'recall': 0.299396389411895, 'f1-score': 0.3488402103429364, 'support': 36116}, '1': {'precision': 0.659224678967584, 'recall': 0.8292098894962179, 'f1-score': 0.734510787080237, 'support': 118186}, '2': {'precision': 0.4555322560749969, 'recall': 0.20262818578365477, 'f1-score': 0.28048988892053545, 'support': 36451}, 'accuracy': 0.6091647313541596, 'macro avg': {'precision': 0.5108674030068258, 'recall': 0.44374482156392253, 'f1-score': 0.4546136287812363, 'support': 190753}, 'weighted avg': {'precision': 0.574599791823134, 'recall': 0.6091647313541596, 'f1-score': 0.5747314163323922, 'support': 190753}}
[[10813 23920  1383]
 [12740 98001  7445]
 [ 2325 26740  7386]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.94728327
{'0': {'precision': 0.46121336598467494, 'recall': 0.2716529021751774, 'f1-score': 0.34191763172920664, 'support': 42985}, '1': {'precision': 0.581752580054652, 'recall': 0.840692781766076, 'f1-score': 0.6876541032124027, 'support': 104333}, '2': {'precision': 0.5008524858487349, 'recall': 0.1690802348336595, 'f1-score': 0.2528142104719612, 'support': 43435}, 'accuracy': 0.5595351056077755, 'macro avg': {'precision': 0.5146061439626873, 'recall': 0.42714197292497097, 'f1-score': 0.42746198180452355, 'support': 190753}, 'weighted avg': {'precision': 0.5361686379482004, 'recall': 0.5595351056077755, 'f1-score': 0.510730264699319, 'support': 190753}}
[[11677 29829  1479]
 [10781 87712  5840]
 [ 2860 33231  7344]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.025193
{'0': {'precision': 0.509086085687757, 'recall': 0.21595363580096405, 'f1-score': 0.30326336028656464, 'support': 53317}, '1': {'precision': 0.46255633884202013, 'recall': 0.8613804564856108, 'f1-score': 0.6018972985843363, 'support': 83639}, '2': {'precision': 0.5506380229365208, 'recall': 0.12673569158131495, 'f1-score': 0.2060472355278865, 'support': 53797}, 'accuracy': 0.4737907136453948, 'macro avg': {'precision': 0.5074268158220994, 'recall': 0.4013565946226299, 'f1-score': 0.37040263146626246, 'support': 190753}, 'weighted avg': {'precision': 0.5004029618141674, 'recall': 0.4737907136453948, 'f1-score': 0.4067873316088752, 'support': 190753}}
[[11514 40106  1697]
 [ 7727 72045  3867]
 [ 3376 43603  6818]]
training model: results/WBA/W3/deepLOB_L2/seq2seq
Epoch 1/50
2155/2155 - 108s - loss: 11.5639 - accuracy10: 0.4739 - accuracy20: 0.4932 - accuracy30: 0.4968 - accuracy50: 0.4894 - val_loss: 10.9659 - val_accuracy10: 0.5602 - val_accuracy20: 0.5540 - val_accuracy30: 0.5364 - val_accuracy50: 0.4974 - 108s/epoch - 50ms/step
Epoch 2/50
2155/2155 - 100s - loss: 10.5790 - accuracy10: 0.5789 - accuracy20: 0.5796 - accuracy30: 0.5657 - accuracy50: 0.5372 - val_loss: 10.1882 - val_accuracy10: 0.5865 - val_accuracy20: 0.5837 - val_accuracy30: 0.5656 - val_accuracy50: 0.5301 - 100s/epoch - 46ms/step
Epoch 3/50
2155/2155 - 100s - loss: 10.2750 - accuracy10: 0.6055 - accuracy20: 0.6001 - accuracy30: 0.5822 - accuracy50: 0.5481 - val_loss: 10.0966 - val_accuracy10: 0.6282 - val_accuracy20: 0.6178 - val_accuracy30: 0.5935 - val_accuracy50: 0.5433 - 100s/epoch - 46ms/step
Epoch 4/50
2155/2155 - 100s - loss: 10.1458 - accuracy10: 0.6127 - accuracy20: 0.6063 - accuracy30: 0.5877 - accuracy50: 0.5527 - val_loss: 10.2838 - val_accuracy10: 0.5967 - val_accuracy20: 0.5888 - val_accuracy30: 0.5670 - val_accuracy50: 0.5258 - 100s/epoch - 46ms/step
Epoch 5/50
2155/2155 - 100s - loss: 10.0631 - accuracy10: 0.6170 - accuracy20: 0.6105 - accuracy30: 0.5917 - accuracy50: 0.5561 - val_loss: 10.3845 - val_accuracy10: 0.5713 - val_accuracy20: 0.5659 - val_accuracy30: 0.5477 - val_accuracy50: 0.5143 - 100s/epoch - 46ms/step
Epoch 6/50
2155/2155 - 99s - loss: 10.0105 - accuracy10: 0.6193 - accuracy20: 0.6117 - accuracy30: 0.5931 - accuracy50: 0.5574 - val_loss: 10.2079 - val_accuracy10: 0.6121 - val_accuracy20: 0.5980 - val_accuracy30: 0.5729 - val_accuracy50: 0.5286 - 99s/epoch - 46ms/step
Epoch 7/50
2155/2155 - 100s - loss: 9.9677 - accuracy10: 0.6212 - accuracy20: 0.6131 - accuracy30: 0.5943 - accuracy50: 0.5585 - val_loss: 10.1849 - val_accuracy10: 0.5961 - val_accuracy20: 0.5834 - val_accuracy30: 0.5601 - val_accuracy50: 0.5210 - 100s/epoch - 46ms/step
Epoch 8/50
2155/2155 - 100s - loss: 9.9297 - accuracy10: 0.6228 - accuracy20: 0.6150 - accuracy30: 0.5958 - accuracy50: 0.5600 - val_loss: 10.3086 - val_accuracy10: 0.5761 - val_accuracy20: 0.5599 - val_accuracy30: 0.5382 - val_accuracy50: 0.5066 - 100s/epoch - 46ms/step
Epoch 9/50
2155/2155 - 100s - loss: 9.9022 - accuracy10: 0.6241 - accuracy20: 0.6154 - accuracy30: 0.5969 - accuracy50: 0.5611 - val_loss: 10.2935 - val_accuracy10: 0.5696 - val_accuracy20: 0.5561 - val_accuracy30: 0.5365 - val_accuracy50: 0.5059 - 100s/epoch - 46ms/step
Epoch 10/50
2155/2155 - 100s - loss: 9.8741 - accuracy10: 0.6251 - accuracy20: 0.6167 - accuracy30: 0.5987 - accuracy50: 0.5626 - val_loss: 10.1772 - val_accuracy10: 0.5745 - val_accuracy20: 0.5626 - val_accuracy30: 0.5451 - val_accuracy50: 0.5146 - 100s/epoch - 46ms/step
Epoch 11/50
2155/2155 - 99s - loss: 9.8517 - accuracy10: 0.6261 - accuracy20: 0.6177 - accuracy30: 0.5996 - accuracy50: 0.5634 - val_loss: 10.1426 - val_accuracy10: 0.5828 - val_accuracy20: 0.5721 - val_accuracy30: 0.5533 - val_accuracy50: 0.5195 - 99s/epoch - 46ms/step
Epoch 12/50
2155/2155 - 100s - loss: 9.8328 - accuracy10: 0.6265 - accuracy20: 0.6184 - accuracy30: 0.6002 - accuracy50: 0.5642 - val_loss: 10.1411 - val_accuracy10: 0.5868 - val_accuracy20: 0.5762 - val_accuracy30: 0.5584 - val_accuracy50: 0.5249 - 100s/epoch - 46ms/step
Epoch 13/50
2155/2155 - 100s - loss: 9.8104 - accuracy10: 0.6276 - accuracy20: 0.6192 - accuracy30: 0.6011 - accuracy50: 0.5651 - val_loss: 10.1345 - val_accuracy10: 0.5847 - val_accuracy20: 0.5743 - val_accuracy30: 0.5571 - val_accuracy50: 0.5239 - 100s/epoch - 46ms/step
testing model: results/WBA/W3/deepLOB_L2/seq2seq
Evaluating performance on  test set...
6315/6315 - 101s - 101s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8361971
{'0': {'precision': 0.370508233880438, 'recall': 0.6017697937458416, 'f1-score': 0.45863561069605485, 'support': 225450}, '1': {'precision': 0.8935390926405236, 'recall': 0.5650089894733953, 'f1-score': 0.6922742225351818, 'support': 1165808}, '2': {'precision': 0.3144767101929448, 'recall': 0.716560679266733, 'f1-score': 0.4371163400534211, 'support': 225184}, 'accuracy': 0.5912485570159647, 'macro avg': {'precision': 0.5261746789046354, 'recall': 0.6277798208286566, 'f1-score': 0.5293420577615525, 'support': 1616442}, 'weighted avg': {'precision': 0.7399221421798593, 'recall': 0.5912485570159647, 'f1-score': 0.6241423021520787, 'support': 1616442}}
[[135669  51890  37891]
 [193265 658692 313851]
 [ 37236  26590 161358]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8530738
{'0': {'precision': 0.4388388902575177, 'recall': 0.5500619224540345, 'f1-score': 0.4881957027839045, 'support': 304413}, '1': {'precision': 0.8197204949376288, 'recall': 0.5811821653673457, 'f1-score': 0.6801428046972661, 'support': 1007321}, '2': {'precision': 0.387929362282378, 'recall': 0.6628936555653281, 'f1-score': 0.4894371529683436, 'support': 304708}, 'accuracy': 0.5907245666717396, 'macro avg': {'precision': 0.5488295824925081, 'recall': 0.5980459144622361, 'f1-score': 0.5525918868165047, 'support': 1616442}, 'weighted avg': {'precision': 0.6665968292727904, 'recall': 0.5907245666717396, 'f1-score': 0.6080457354168535, 'support': 1616442}}
[[167446  79823  57144]
 [160332 585437 261552]
 [ 53788  48931 201989]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8868897
{'0': {'precision': 0.4701664330719277, 'recall': 0.5106601060346947, 'f1-score': 0.48957737376305804, 'support': 361957}, '1': {'precision': 0.7528340403353071, 'recall': 0.5830660895696441, 'f1-score': 0.6571628973858316, 'support': 891820}, '2': {'precision': 0.42610321798119044, 'recall': 0.6257648242868763, 'f1-score': 0.5069845163336931, 'support': 362665}, 'accuracy': 0.5764326836347979, 'macro avg': {'precision': 0.5497012304628085, 'recall': 0.5731636732970716, 'f1-score': 0.5512415958275275, 'support': 1616442}, 'weighted avg': {'precision': 0.6162331893234634, 'recall': 0.5764326836347979, 'f1-score': 0.58594277569993, 'support': 1616442}}
[[184837 102107  75013]
 [141185 519990 230645]
 [ 67109  68613 226943]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9438929
{'0': {'precision': 0.5008186179947569, 'recall': 0.45134623099897475, 'f1-score': 0.4747971864009379, 'support': 448660}, '1': {'precision': 0.6331725604110695, 'recall': 0.5797874849799224, 'f1-score': 0.6053052246097641, 'support': 720702}, '2': {'precision': 0.4606431048690156, 'recall': 0.5689160776594793, 'f1-score': 0.5090863602019524, 'support': 447080}, 'accuracy': 0.5411304581296452, 'macro avg': {'precision': 0.5315447610916141, 'recall': 0.5333499312127922, 'f1-score': 0.5297295904042182, 'support': 1616442}, 'weighted avg': {'precision': 0.5487176967115095, 'recall': 0.5411304581296452, 'f1-score': 0.5424689048889103, 'support': 1616442}}
[[202501 138612 107547]
 [112581 417854 190267]
 [ 89258 103471 254351]]
Evaluating performance on  train set...
2155/2155 - 36s - 36s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.88689566
{'0': {'precision': 0.3240179802333935, 'recall': 0.74918065906438, 'f1-score': 0.4523822433073535, 'support': 89096}, '1': {'precision': 0.8606199412968069, 'recall': 0.5231628917929614, 'f1-score': 0.6507443313459838, 'support': 369902}, '2': {'precision': 0.4024710591081979, 'recall': 0.5248262969646542, 'f1-score': 0.45557639996248, 'support': 92543}, 'accuracy': 0.5599529318763247, 'macro avg': {'precision': 0.5290363268794661, 'recall': 0.5990566159406652, 'f1-score': 0.5195676582052724, 'support': 551541}, 'weighted avg': {'precision': 0.6970644480020449, 'recall': 0.5599529318763247, 'f1-score': 0.5859536911761444, 'support': 551541}}
[[ 66749  13464   8883]
 [113158 193519  63225]
 [ 26097  17877  48569]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9030057
{'0': {'precision': 0.3874669264832866, 'recall': 0.7104719489272349, 'f1-score': 0.501456663150755, 'support': 118106}, '1': {'precision': 0.7762162669105062, 'recall': 0.5319630300926819, 'f1-score': 0.6312871000158268, 'support': 311172}, '2': {'precision': 0.47397780205877277, 'recall': 0.47188438039308706, 'f1-score': 0.4729287746018214, 'support': 122263}, 'accuracy': 0.5568706587542902, 'macro avg': {'precision': 0.5458869984841885, 'recall': 0.5714397864710012, 'f1-score': 0.5352241792561344, 'support': 551541}, 'weighted avg': {'precision': 0.6259713875113958, 'recall': 0.5568706587542902, 'f1-score': 0.5683813187294334, 'support': 551541}}
[[ 83911  20926  13269]
 [ 94880 165532  50760]
 [ 37772  26797  57694]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9277214
{'0': {'precision': 0.4191366337337724, 'recall': 0.6820792107851646, 'f1-score': 0.5192158935438672, 'support': 138264}, '1': {'precision': 0.7051917223989678, 'recall': 0.5291667744522337, 'f1-score': 0.6046282827301843, 'support': 270599}, '2': {'precision': 0.506454277477244, 'recall': 0.4383226566113907, 'f1-score': 0.4699318460185902, 'support': 142678}, 'accuracy': 0.5439994488170417, 'macro avg': {'precision': 0.5435942112033281, 'recall': 0.5498562139495963, 'f1-score': 0.5312586740975472, 'support': 551541}, 'weighted avg': {'precision': 0.5820701739633187, 'recall': 0.5439994488170417, 'f1-score': 0.5483719449863107, 'support': 551541}}
[[ 94307  26889  17068]
 [ 83530 143192  43877]
 [ 47166  32973  62539]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.97302526
{'0': {'precision': 0.45261908652316374, 'recall': 0.6329683281318589, 'f1-score': 0.5278129473676294, 'support': 166299}, '1': {'precision': 0.5816073770321184, 'recall': 0.5228138127181041, 'f1-score': 0.5506456651015672, 'support': 213774}, '2': {'precision': 0.5325631825888105, 'recall': 0.393875242027667, 'f1-score': 0.452838411843786, 'support': 171468}, 'accuracy': 0.5159416978973458, 'macro avg': {'precision': 0.5222632153813641, 'recall': 0.51655246095921, 'f1-score': 0.5104323414376609, 'support': 551541}, 'weighted avg': {'precision': 0.5274679138622838, 'recall': 0.5159416978973458, 'f1-score': 0.5133540181921963, 'support': 551541}}
[[105262  37197  23840]
 [ 66572 111764  35438]
 [ 60728  43203  67537]]
Evaluating performance on  val set...
746/746 - 11s - 11s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.79291046
{'0': {'precision': 0.3818161154676668, 'recall': 0.627305997460602, 'f1-score': 0.47470080397891856, 'support': 26778}, '1': {'precision': 0.8824289931792731, 'recall': 0.6316982342095483, 'f1-score': 0.7363038280052157, 'support': 137219}, '2': {'precision': 0.34057985946547426, 'recall': 0.6177075157902605, 'f1-score': 0.43907233748638524, 'support': 26757}, 'accuracy': 0.6291191796764419, 'macro avg': {'precision': 0.5349416560374715, 'recall': 0.6255705824868035, 'f1-score': 0.5500256564901732, 'support': 190754}, 'weighted avg': {'precision': 0.7361480821098251, 'recall': 0.6291191796764419, 'f1-score': 0.6578874971854763, 'support': 190754}}
[[16798  6737  3243]
 [21780 86681 28758]
 [ 5417  4812 16528]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8247801
{'0': {'precision': 0.44983818770226536, 'recall': 0.5746351478830254, 'f1-score': 0.5046355518194998, 'support': 36042}, '1': {'precision': 0.8010910573014098, 'recall': 0.6478368533590257, 'f1-score': 0.7163590486425868, 'support': 118323}, '2': {'precision': 0.4175539509647942, 'recall': 0.5625601143202617, 'f1-score': 0.4793303283966517, 'support': 36389}, 'accuracy': 0.6177380290845801, 'macro avg': {'precision': 0.5561610653228232, 'recall': 0.5950107051874376, 'f1-score': 0.5667749762862461, 'support': 190754}, 'weighted avg': {'precision': 0.6615585301272721, 'recall': 0.6177380290845801, 'f1-score': 0.6311384169728602, 'support': 190754}}
[[20711 10568  4763]
 [17877 76654 23792]
 [ 7453  8465 20471]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8691184
{'0': {'precision': 0.4794785127957508, 'recall': 0.5319312465064282, 'f1-score': 0.5043447537236804, 'support': 42936}, '1': {'precision': 0.7250407410584098, 'recall': 0.6477524161645961, 'f1-score': 0.6842209102912385, 'support': 104401}, '2': {'precision': 0.45274729683644604, 'recall': 0.519819425570629, 'f1-score': 0.48397057877468735, 'support': 43417}, 'accuracy': 0.5925642450485966, 'macro avg': {'precision': 0.5524221835635356, 'recall': 0.5665010294138845, 'f1-score': 0.5575120809298687, 'support': 190754}, 'weighted avg': {'precision': 0.6077922204482494, 'recall': 0.5925642450485966, 'f1-score': 0.5981549231987594, 'support': 190754}}
[[22839 13919  6178]
 [15673 67626 21102]
 [ 9121 11727 22569]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9399454
{'0': {'precision': 0.5052121658081923, 'recall': 0.46355094615629866, 'f1-score': 0.48348574502420655, 'support': 53321}, '1': {'precision': 0.5948390825035562, 'recall': 0.6401100215259508, 'f1-score': 0.6166447777700975, 'support': 83620}, '2': {'precision': 0.48854299270917717, 'recall': 0.4706855220857414, 'f1-score': 0.4794480356618934, 'support': 53813}, 'accuracy': 0.5429610912484142, 'macro avg': {'precision': 0.5295314136736419, 'recall': 0.5247821632559969, 'f1-score': 0.5265261861520658, 'support': 190754}, 'weighted avg': {'precision': 0.5397990398034377, 'recall': 0.5429610912484142, 'f1-score': 0.5407190248731074, 'support': 190754}}
[[24717 19591  9013]
 [12590 53526 17504]
 [11617 16867 25329]]
training model: results/WBA/W3/deepOF_L2/seq2seq
Epoch 1/50
2155/2155 - 66s - loss: 11.1291 - accuracy10: 0.5456 - accuracy20: 0.5516 - accuracy30: 0.5431 - accuracy50: 0.5172 - val_loss: 10.1708 - val_accuracy10: 0.6431 - val_accuracy20: 0.6281 - val_accuracy30: 0.6006 - val_accuracy50: 0.5440 - 66s/epoch - 31ms/step
Epoch 2/50
2155/2155 - 61s - loss: 10.4176 - accuracy10: 0.6031 - accuracy20: 0.5961 - accuracy30: 0.5790 - accuracy50: 0.5460 - val_loss: 10.1701 - val_accuracy10: 0.6283 - val_accuracy20: 0.6140 - val_accuracy30: 0.5895 - val_accuracy50: 0.5408 - 61s/epoch - 28ms/step
Epoch 3/50
2155/2155 - 62s - loss: 10.2717 - accuracy10: 0.6104 - accuracy20: 0.6026 - accuracy30: 0.5844 - accuracy50: 0.5503 - val_loss: 10.0236 - val_accuracy10: 0.6402 - val_accuracy20: 0.6232 - val_accuracy30: 0.5971 - val_accuracy50: 0.5480 - 62s/epoch - 29ms/step
Epoch 4/50
2155/2155 - 60s - loss: 10.1953 - accuracy10: 0.6132 - accuracy20: 0.6058 - accuracy30: 0.5869 - accuracy50: 0.5531 - val_loss: 10.5558 - val_accuracy10: 0.5913 - val_accuracy20: 0.5805 - val_accuracy30: 0.5629 - val_accuracy50: 0.5246 - 60s/epoch - 28ms/step
Epoch 5/50
2155/2155 - 60s - loss: 10.1363 - accuracy10: 0.6153 - accuracy20: 0.6087 - accuracy30: 0.5895 - accuracy50: 0.5551 - val_loss: 10.2350 - val_accuracy10: 0.6159 - val_accuracy20: 0.6036 - val_accuracy30: 0.5814 - val_accuracy50: 0.5372 - 60s/epoch - 28ms/step
Epoch 6/50
2155/2155 - 59s - loss: 10.0910 - accuracy10: 0.6178 - accuracy20: 0.6107 - accuracy30: 0.5912 - accuracy50: 0.5567 - val_loss: 10.0317 - val_accuracy10: 0.6343 - val_accuracy20: 0.6189 - val_accuracy30: 0.5937 - val_accuracy50: 0.5460 - 59s/epoch - 28ms/step
Epoch 7/50
2155/2155 - 64s - loss: 10.0484 - accuracy10: 0.6184 - accuracy20: 0.6119 - accuracy30: 0.5927 - accuracy50: 0.5580 - val_loss: 10.2288 - val_accuracy10: 0.6160 - val_accuracy20: 0.6036 - val_accuracy30: 0.5824 - val_accuracy50: 0.5380 - 64s/epoch - 30ms/step
Epoch 8/50
2155/2155 - 59s - loss: 10.0153 - accuracy10: 0.6205 - accuracy20: 0.6133 - accuracy30: 0.5939 - accuracy50: 0.5589 - val_loss: 10.1931 - val_accuracy10: 0.6196 - val_accuracy20: 0.6056 - val_accuracy30: 0.5835 - val_accuracy50: 0.5377 - 59s/epoch - 28ms/step
Epoch 9/50
2155/2155 - 61s - loss: 9.9844 - accuracy10: 0.6209 - accuracy20: 0.6149 - accuracy30: 0.5950 - accuracy50: 0.5609 - val_loss: 10.1845 - val_accuracy10: 0.6109 - val_accuracy20: 0.6000 - val_accuracy30: 0.5788 - val_accuracy50: 0.5358 - 61s/epoch - 28ms/step
Epoch 10/50
2155/2155 - 62s - loss: 9.9576 - accuracy10: 0.6222 - accuracy20: 0.6152 - accuracy30: 0.5962 - accuracy50: 0.5615 - val_loss: 9.9772 - val_accuracy10: 0.6346 - val_accuracy20: 0.6206 - val_accuracy30: 0.5961 - val_accuracy50: 0.5479 - 62s/epoch - 29ms/step
Epoch 11/50
2155/2155 - 63s - loss: 9.9264 - accuracy10: 0.6224 - accuracy20: 0.6162 - accuracy30: 0.5973 - accuracy50: 0.5628 - val_loss: 9.7900 - val_accuracy10: 0.6514 - val_accuracy20: 0.6354 - val_accuracy30: 0.6085 - val_accuracy50: 0.5574 - 63s/epoch - 29ms/step
Epoch 12/50
2155/2155 - 61s - loss: 9.9031 - accuracy10: 0.6232 - accuracy20: 0.6176 - accuracy30: 0.5985 - accuracy50: 0.5637 - val_loss: 9.7761 - val_accuracy10: 0.6448 - val_accuracy20: 0.6303 - val_accuracy30: 0.6049 - val_accuracy50: 0.5554 - 61s/epoch - 28ms/step
Epoch 13/50
2155/2155 - 60s - loss: 9.8798 - accuracy10: 0.6233 - accuracy20: 0.6181 - accuracy30: 0.5989 - accuracy50: 0.5648 - val_loss: 9.7898 - val_accuracy10: 0.6417 - val_accuracy20: 0.6276 - val_accuracy30: 0.6018 - val_accuracy50: 0.5533 - 60s/epoch - 28ms/step
Epoch 14/50
2155/2155 - 62s - loss: 9.8575 - accuracy10: 0.6240 - accuracy20: 0.6191 - accuracy30: 0.6002 - accuracy50: 0.5655 - val_loss: 9.7368 - val_accuracy10: 0.6508 - val_accuracy20: 0.6350 - val_accuracy30: 0.6079 - val_accuracy50: 0.5572 - 62s/epoch - 29ms/step
Epoch 15/50
2155/2155 - 59s - loss: 9.8351 - accuracy10: 0.6243 - accuracy20: 0.6196 - accuracy30: 0.6012 - accuracy50: 0.5670 - val_loss: 9.7550 - val_accuracy10: 0.6519 - val_accuracy20: 0.6359 - val_accuracy30: 0.6087 - val_accuracy50: 0.5568 - 59s/epoch - 27ms/step
Epoch 16/50
2155/2155 - 61s - loss: 9.8144 - accuracy10: 0.6253 - accuracy20: 0.6201 - accuracy30: 0.6018 - accuracy50: 0.5676 - val_loss: 9.7445 - val_accuracy10: 0.6550 - val_accuracy20: 0.6380 - val_accuracy30: 0.6098 - val_accuracy50: 0.5572 - 61s/epoch - 28ms/step
Epoch 17/50
2155/2155 - 59s - loss: 9.7942 - accuracy10: 0.6258 - accuracy20: 0.6210 - accuracy30: 0.6025 - accuracy50: 0.5685 - val_loss: 9.7511 - val_accuracy10: 0.6547 - val_accuracy20: 0.6374 - val_accuracy30: 0.6100 - val_accuracy50: 0.5574 - 59s/epoch - 27ms/step
Epoch 18/50
2155/2155 - 60s - loss: 9.7757 - accuracy10: 0.6265 - accuracy20: 0.6218 - accuracy30: 0.6035 - accuracy50: 0.5690 - val_loss: 9.7009 - val_accuracy10: 0.6700 - val_accuracy20: 0.6498 - val_accuracy30: 0.6182 - val_accuracy50: 0.5608 - 60s/epoch - 28ms/step
Epoch 19/50
2155/2155 - 60s - loss: 9.7562 - accuracy10: 0.6271 - accuracy20: 0.6228 - accuracy30: 0.6046 - accuracy50: 0.5702 - val_loss: 9.7557 - val_accuracy10: 0.6558 - val_accuracy20: 0.6388 - val_accuracy30: 0.6099 - val_accuracy50: 0.5563 - 60s/epoch - 28ms/step
Epoch 20/50
2155/2155 - 61s - loss: 9.7417 - accuracy10: 0.6276 - accuracy20: 0.6235 - accuracy30: 0.6052 - accuracy50: 0.5714 - val_loss: 9.7453 - val_accuracy10: 0.6482 - val_accuracy20: 0.6330 - val_accuracy30: 0.6065 - val_accuracy50: 0.5561 - 61s/epoch - 28ms/step
Epoch 21/50
2155/2155 - 60s - loss: 9.7216 - accuracy10: 0.6273 - accuracy20: 0.6238 - accuracy30: 0.6055 - accuracy50: 0.5709 - val_loss: 9.8370 - val_accuracy10: 0.6449 - val_accuracy20: 0.6297 - val_accuracy30: 0.6021 - val_accuracy50: 0.5523 - 60s/epoch - 28ms/step
Epoch 22/50
2155/2155 - 59s - loss: 9.7022 - accuracy10: 0.6277 - accuracy20: 0.6243 - accuracy30: 0.6060 - accuracy50: 0.5720 - val_loss: 9.7794 - val_accuracy10: 0.6511 - val_accuracy20: 0.6351 - val_accuracy30: 0.6075 - val_accuracy50: 0.5560 - 59s/epoch - 27ms/step
Epoch 23/50
2155/2155 - 59s - loss: 9.6839 - accuracy10: 0.6284 - accuracy20: 0.6251 - accuracy30: 0.6073 - accuracy50: 0.5732 - val_loss: 9.7167 - val_accuracy10: 0.6532 - val_accuracy20: 0.6369 - val_accuracy30: 0.6081 - val_accuracy50: 0.5563 - 59s/epoch - 27ms/step
Epoch 24/50
2155/2155 - 61s - loss: 9.6646 - accuracy10: 0.6288 - accuracy20: 0.6263 - accuracy30: 0.6080 - accuracy50: 0.5740 - val_loss: 9.8157 - val_accuracy10: 0.6487 - val_accuracy20: 0.6329 - val_accuracy30: 0.6056 - val_accuracy50: 0.5528 - 61s/epoch - 29ms/step
Epoch 25/50
2155/2155 - 61s - loss: 9.6509 - accuracy10: 0.6297 - accuracy20: 0.6264 - accuracy30: 0.6086 - accuracy50: 0.5745 - val_loss: 9.7910 - val_accuracy10: 0.6470 - val_accuracy20: 0.6304 - val_accuracy30: 0.6028 - val_accuracy50: 0.5525 - 61s/epoch - 28ms/step
Epoch 26/50
2155/2155 - 60s - loss: 9.6324 - accuracy10: 0.6302 - accuracy20: 0.6275 - accuracy30: 0.6095 - accuracy50: 0.5755 - val_loss: 9.8085 - val_accuracy10: 0.6591 - val_accuracy20: 0.6384 - val_accuracy30: 0.6086 - val_accuracy50: 0.5544 - 60s/epoch - 28ms/step
Epoch 27/50
2155/2155 - 59s - loss: 9.6182 - accuracy10: 0.6313 - accuracy20: 0.6278 - accuracy30: 0.6098 - accuracy50: 0.5763 - val_loss: 9.8333 - val_accuracy10: 0.6492 - val_accuracy20: 0.6310 - val_accuracy30: 0.6031 - val_accuracy50: 0.5527 - 59s/epoch - 27ms/step
Epoch 28/50
2155/2155 - 59s - loss: 9.6010 - accuracy10: 0.6305 - accuracy20: 0.6280 - accuracy30: 0.6105 - accuracy50: 0.5774 - val_loss: 9.8771 - val_accuracy10: 0.6609 - val_accuracy20: 0.6397 - val_accuracy30: 0.6090 - val_accuracy50: 0.5544 - 59s/epoch - 27ms/step
testing model: results/WBA/W3/deepOF_L2/seq2seq
Evaluating performance on  test set...
6315/6315 - 58s - 58s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7256232
{'0': {'precision': 0.37890377703017336, 'recall': 0.6424468505072101, 'f1-score': 0.4766737918108563, 'support': 225449}, '1': {'precision': 0.8723865343675177, 'recall': 0.7047633098789079, 'f1-score': 0.7796672252767587, 'support': 1165807}, '2': {'precision': 0.42390765284309534, 'recall': 0.5503992326207245, 'f1-score': 0.4789424160044207, 'support': 225182}, 'accuracy': 0.6745677842267999, 'macro avg': {'precision': 0.5583993214135955, 'recall': 0.6325364643356142, 'f1-score': 0.5784278110306785, 'support': 1616438}, 'weighted avg': {'precision': 0.7410826639695318, 'recall': 0.6745677842267999, 'f1-score': 0.6955146746790755, 'support': 1616438}}
[[144839  57093  23517]
 [199271 821618 144918]
 [ 38148  63094 123940]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.76932025
{'0': {'precision': 0.4511704163408176, 'recall': 0.5894037994684818, 'f1-score': 0.511105413835833, 'support': 304411}, '1': {'precision': 0.7897318709439948, 'recall': 0.715662633857529, 'f1-score': 0.7508750550082935, 'support': 1007321}, '2': {'precision': 0.49189807626301424, 'recall': 0.4938498093243979, 'f1-score': 0.4928720106252487, 'support': 304706}, 'accuracy': 0.6500725669651419, 'macro avg': {'precision': 0.5776001211826088, 'recall': 0.5996387475501362, 'f1-score': 0.5849508264897917, 'support': 1616438}, 'weighted avg': {'precision': 0.6698302259695073, 'recall': 0.6500725669651419, 'f1-score': 0.6570863715693185, 'support': 1616438}}
[[179421  92287  32703]
 [163686 720902 122733]
 [ 54572  99655 150479]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8230578
{'0': {'precision': 0.481795658443582, 'recall': 0.5501512618971972, 'f1-score': 0.5137095411492616, 'support': 361955}, '1': {'precision': 0.716907110551487, 'recall': 0.7118387118476822, 'f1-score': 0.7143639212641398, 'support': 891820}, '2': {'precision': 0.5172960974765046, 'recall': 0.45304042596018895, 'f1-score': 0.4830407568670455, 'support': 362663}, 'accuracy': 0.6175696191255093, 'macro avg': {'precision': 0.5719996221571912, 'recall': 0.5716767999016895, 'f1-score': 0.5703714064268156, 'support': 1616438}, 'weighted avg': {'precision': 0.619476034022397, 'recall': 0.6175696191255093, 'f1-score': 0.6175336011873882, 'support': 1616438}}
[[199130 121652  41173]
 [144847 634832 112141]
 [ 69331 129031 164301]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.911165
{'0': {'precision': 0.5052644037195443, 'recall': 0.48528054776689594, 'f1-score': 0.4950708925146463, 'support': 448658}, '1': {'precision': 0.588053558960981, 'recall': 0.7093805761604658, 'f1-score': 0.6430442381260537, 'support': 720702}, '2': {'precision': 0.5396769662921348, 'recall': 0.3816045522257861, 'f1-score': 0.44707981855488554, 'support': 447078}, 'accuracy': 0.5565224277083315, 'macro avg': {'precision': 0.5443316429908868, 'recall': 0.5254218920510493, 'f1-score': 0.5283983163985285, 'support': 1616438}, 'weighted avg': {'precision': 0.5516945231615783, 'recall': 0.5565224277083315, 'f1-score': 0.5477725320238949, 'support': 1616438}}
[[217725 174953  55980]
 [119909 511252  89541]
 [ 93279 183192 170607]]
Evaluating performance on  train set...
2155/2155 - 21s - 21s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.81540924
{'0': {'precision': 0.37982357791579907, 'recall': 0.7188826263669639, 'f1-score': 0.49703655114326634, 'support': 89066}, '1': {'precision': 0.8611790569945076, 'recall': 0.620768452764061, 'f1-score': 0.7214733143286387, 'support': 369782}, '2': {'precision': 0.4517763881253436, 'recall': 0.5673999115359304, 'f1-score': 0.5030295204893143, 'support': 92693}, 'accuracy': 0.6276432758398741, 'macro avg': {'precision': 0.5642596743452167, 'recall': 0.6356836635556516, 'f1-score': 0.5738464619870731, 'support': 551541}, 'weighted avg': {'precision': 0.7146420476241911, 'recall': 0.6276432758398741, 'f1-score': 0.6485179124052696, 'support': 551541}}
[[ 64028  15172   9866]
 [ 86277 229549  53956]
 [ 18268  21831  52594]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.83084387
{'0': {'precision': 0.4509135076537128, 'recall': 0.6721035489192505, 'f1-score': 0.539725673756938, 'support': 118205}, '1': {'precision': 0.7746858591487391, 'recall': 0.6346022785721633, 'f1-score': 0.6976818980233047, 'support': 311072}, '2': {'precision': 0.5205674935700656, 'recall': 0.513184584178499, 'f1-score': 0.5168496750331557, 'support': 122264}, 'accuracy': 0.6157239443667832, 'macro avg': {'precision': 0.5820556201241724, 'recall': 0.6066301372233043, 'f1-score': 0.5847524156044662, 'support': 551541}, 'weighted avg': {'precision': 0.6489634946144968, 'recall': 0.6157239443667832, 'f1-score': 0.6237427232365282, 'support': 551541}}
[[ 79446  24770  13989]
 [ 69868 197407  43797]
 [ 26875  32645  62744]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8644625
{'0': {'precision': 0.48093395365015873, 'recall': 0.6399652853113473, 'f1-score': 0.5491680682177855, 'support': 138270}, '1': {'precision': 0.6998461191243153, 'recall': 0.6300667937521243, 'f1-score': 0.6631258274540757, 'support': 270684}, '2': {'precision': 0.5470473299207131, 'recall': 0.4751765588728285, 'f1-score': 0.5085853903866147, 'support': 142587}, 'accuracy': 0.5925053622486814, 'macro avg': {'precision': 0.5759424675650623, 'recall': 0.5817362126454334, 'f1-score': 0.5736264286861587, 'support': 551541}, 'weighted avg': {'precision': 0.6054630975968393, 'recall': 0.5925053622486814, 'f1-score': 0.5946043636467796, 'support': 551541}}
[[ 88488  32636  17146]
 [ 61181 170549  38954]
 [ 34323  40510  67754]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9234452
{'0': {'precision': 0.5065799040279192, 'recall': 0.5864229074360192, 'f1-score': 0.5435851711503364, 'support': 166339}, '1': {'precision': 0.5692907487486806, 'recall': 0.6258264047125539, 'f1-score': 0.5962213520133547, 'support': 213727}, '2': {'precision': 0.5709045173461901, 'recall': 0.4129523254118676, 'f1-score': 0.47924929274334366, 'support': 171475}, 'accuracy': 0.5477598220259238, 'macro avg': {'precision': 0.5489250567075966, 'recall': 0.5417338791868136, 'f1-score': 0.5396852719690116, 'support': 551541}, 'weighted avg': {'precision': 0.5508795368356065, 'recall': 0.5477598220259238, 'f1-score': 0.5439800253451672, 'support': 551541}}
[[ 97545  46102  22692]
 [ 49441 133756  30530]
 [ 45570  55094  70811]]
Evaluating performance on  val set...
746/746 - 7s - 7s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7385415
{'0': {'precision': 0.38284439580790436, 'recall': 0.6782744864099027, 'f1-score': 0.4894335409408252, 'support': 26821}, '1': {'precision': 0.8793100241770504, 'recall': 0.6898184285203639, 'f1-score': 0.7731225037915797, 'support': 137081}, '2': {'precision': 0.4163888499789887, 'recall': 0.5535361811478158, 'f1-score': 0.47526620407380177, 'support': 26851}, 'accuracy': 0.6690117586617248, 'macro avg': {'precision': 0.5595144233213145, 'recall': 0.6405430320260274, 'f1-score': 0.5792740829354023, 'support': 190753}, 'weighted avg': {'precision': 0.7443417612040905, 'recall': 0.6690117586617248, 'f1-score': 0.6913069560605236, 'support': 190753}}
[[18192  5865  2764]
 [24452 94561 18068]
 [ 4874  7114 14863]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7749404
{'0': {'precision': 0.45571828471743275, 'recall': 0.6220511684571934, 'f1-score': 0.5260495937434144, 'support': 36116}, '1': {'precision': 0.796612122608896, 'recall': 0.701910547780617, 'f1-score': 0.7462689252525615, 'support': 118186}, '2': {'precision': 0.4872317050296096, 'recall': 0.4988340511920112, 'f1-score': 0.49296461976413175, 'support': 36451}, 'accuracy': 0.6479845664288373, 'macro avg': {'precision': 0.5798540374519795, 'recall': 0.6075985891432739, 'f1-score': 0.5884277129200358, 'support': 190753}, 'weighted avg': {'precision': 0.672949860676079, 'recall': 0.6479845664288373, 'f1-score': 0.6561700192529542, 'support': 190753}}
[[22466  9774  3876]
 [19970 82956 15260]
 [ 6862 11406 18183]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.82608175
{'0': {'precision': 0.4899185236085207, 'recall': 0.5805280911946028, 'f1-score': 0.5313884156729131, 'support': 42985}, '1': {'precision': 0.7216297160253432, 'recall': 0.6997594241515148, 'f1-score': 0.7105263157894736, 'support': 104333}, '2': {'precision': 0.5144771909850699, 'recall': 0.457764475653275, 'f1-score': 0.4844667527594357, 'support': 43435}, 'accuracy': 0.6177884489365829, 'macro avg': {'precision': 0.5753418102063113, 'recall': 0.5793506636664643, 'f1-score': 0.5754604947406075, 'support': 190753}, 'weighted avg': {'precision': 0.6222458241276463, 'recall': 0.6177884489365829, 'f1-score': 0.6186843014739972, 'support': 190753}}
[[24954 13165  4866]
 [17427 73008 13898]
 [ 8554 14998 19883]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9101425
{'0': {'precision': 0.5171526911002685, 'recall': 0.5128945739632762, 'f1-score': 0.5150148312067423, 'support': 53317}, '1': {'precision': 0.589431098855757, 'recall': 0.7002714044883368, 'f1-score': 0.6400883031157449, 'support': 83639}, '2': {'precision': 0.5476784044873793, 'recall': 0.3920292953138651, 'f1-score': 0.45696332809706947, 'support': 53797}, 'accuracy': 0.5609662757597521, 'macro avg': {'precision': 0.5514207314811349, 'recall': 0.5350650912551594, 'f1-score': 0.5373554874731856, 'support': 190753}, 'weighted avg': {'precision': 0.5574534231954267, 'recall': 0.5609662757597521, 'f1-score': 0.553483549414089, 'support': 190753}}
[[27346 19351  6620]
 [14271 58570 10798]
 [11261 21446 21090]]
training model: results/WBA/W3/deepVOL_L2/seq2seq
Epoch 1/50
2155/2155 - 65s - loss: 11.2158 - accuracy10: 0.5392 - accuracy20: 0.5463 - accuracy30: 0.5371 - accuracy50: 0.5116 - val_loss: 10.5145 - val_accuracy10: 0.6524 - val_accuracy20: 0.6355 - val_accuracy30: 0.6058 - val_accuracy50: 0.5443 - 65s/epoch - 30ms/step
Epoch 2/50
2155/2155 - 56s - loss: 10.6299 - accuracy10: 0.5828 - accuracy20: 0.5832 - accuracy30: 0.5691 - accuracy50: 0.5370 - val_loss: 10.1572 - val_accuracy10: 0.6253 - val_accuracy20: 0.6196 - val_accuracy30: 0.5986 - val_accuracy50: 0.5498 - 56s/epoch - 26ms/step
Epoch 3/50
2155/2155 - 57s - loss: 10.3806 - accuracy10: 0.6003 - accuracy20: 0.5968 - accuracy30: 0.5795 - accuracy50: 0.5461 - val_loss: 10.0132 - val_accuracy10: 0.6362 - val_accuracy20: 0.6279 - val_accuracy30: 0.6040 - val_accuracy50: 0.5535 - 57s/epoch - 27ms/step
Epoch 4/50
2155/2155 - 57s - loss: 10.2684 - accuracy10: 0.6082 - accuracy20: 0.6032 - accuracy30: 0.5840 - accuracy50: 0.5495 - val_loss: 9.9856 - val_accuracy10: 0.6621 - val_accuracy20: 0.6460 - val_accuracy30: 0.6161 - val_accuracy50: 0.5563 - 57s/epoch - 26ms/step
Epoch 5/50
2155/2155 - 57s - loss: 10.2122 - accuracy10: 0.6112 - accuracy20: 0.6054 - accuracy30: 0.5865 - accuracy50: 0.5516 - val_loss: 9.9529 - val_accuracy10: 0.6615 - val_accuracy20: 0.6444 - val_accuracy30: 0.6147 - val_accuracy50: 0.5553 - 57s/epoch - 26ms/step
Epoch 6/50
2155/2155 - 57s - loss: 10.1652 - accuracy10: 0.6139 - accuracy20: 0.6083 - accuracy30: 0.5891 - accuracy50: 0.5536 - val_loss: 9.9435 - val_accuracy10: 0.6585 - val_accuracy20: 0.6421 - val_accuracy30: 0.6126 - val_accuracy50: 0.5552 - 57s/epoch - 26ms/step
Epoch 7/50
2155/2155 - 57s - loss: 10.1276 - accuracy10: 0.6157 - accuracy20: 0.6093 - accuracy30: 0.5900 - accuracy50: 0.5542 - val_loss: 9.9293 - val_accuracy10: 0.6502 - val_accuracy20: 0.6349 - val_accuracy30: 0.6077 - val_accuracy50: 0.5533 - 57s/epoch - 26ms/step
Epoch 8/50
2155/2155 - 57s - loss: 10.1006 - accuracy10: 0.6175 - accuracy20: 0.6110 - accuracy30: 0.5915 - accuracy50: 0.5556 - val_loss: 9.9029 - val_accuracy10: 0.6623 - val_accuracy20: 0.6444 - val_accuracy30: 0.6145 - val_accuracy50: 0.5557 - 57s/epoch - 26ms/step
Epoch 9/50
2155/2155 - 57s - loss: 10.0743 - accuracy10: 0.6191 - accuracy20: 0.6128 - accuracy30: 0.5930 - accuracy50: 0.5568 - val_loss: 9.8619 - val_accuracy10: 0.6616 - val_accuracy20: 0.6445 - val_accuracy30: 0.6160 - val_accuracy50: 0.5582 - 57s/epoch - 26ms/step
Epoch 10/50
2155/2155 - 56s - loss: 10.0442 - accuracy10: 0.6204 - accuracy20: 0.6137 - accuracy30: 0.5934 - accuracy50: 0.5569 - val_loss: 9.8247 - val_accuracy10: 0.6639 - val_accuracy20: 0.6453 - val_accuracy30: 0.6157 - val_accuracy50: 0.5579 - 56s/epoch - 26ms/step
Epoch 11/50
2155/2155 - 56s - loss: 10.0221 - accuracy10: 0.6213 - accuracy20: 0.6142 - accuracy30: 0.5944 - accuracy50: 0.5583 - val_loss: 9.8322 - val_accuracy10: 0.6578 - val_accuracy20: 0.6401 - val_accuracy30: 0.6113 - val_accuracy50: 0.5562 - 56s/epoch - 26ms/step
Epoch 12/50
2155/2155 - 58s - loss: 10.0004 - accuracy10: 0.6234 - accuracy20: 0.6153 - accuracy30: 0.5953 - accuracy50: 0.5589 - val_loss: 9.8173 - val_accuracy10: 0.6581 - val_accuracy20: 0.6402 - val_accuracy30: 0.6120 - val_accuracy50: 0.5565 - 58s/epoch - 27ms/step
Epoch 13/50
2155/2155 - 57s - loss: 9.9819 - accuracy10: 0.6239 - accuracy20: 0.6162 - accuracy30: 0.5960 - accuracy50: 0.5594 - val_loss: 9.8024 - val_accuracy10: 0.6498 - val_accuracy20: 0.6339 - val_accuracy30: 0.6075 - val_accuracy50: 0.5550 - 57s/epoch - 26ms/step
Epoch 14/50
2155/2155 - 57s - loss: 9.9653 - accuracy10: 0.6249 - accuracy20: 0.6168 - accuracy30: 0.5963 - accuracy50: 0.5600 - val_loss: 9.8048 - val_accuracy10: 0.6418 - val_accuracy20: 0.6283 - val_accuracy30: 0.6035 - val_accuracy50: 0.5541 - 57s/epoch - 26ms/step
Epoch 15/50
2155/2155 - 57s - loss: 9.9421 - accuracy10: 0.6255 - accuracy20: 0.6175 - accuracy30: 0.5980 - accuracy50: 0.5613 - val_loss: 9.7929 - val_accuracy10: 0.6464 - val_accuracy20: 0.6315 - val_accuracy30: 0.6060 - val_accuracy50: 0.5556 - 57s/epoch - 26ms/step
Epoch 16/50
2155/2155 - 57s - loss: 9.9286 - accuracy10: 0.6262 - accuracy20: 0.6183 - accuracy30: 0.5982 - accuracy50: 0.5615 - val_loss: 9.7888 - val_accuracy10: 0.6465 - val_accuracy20: 0.6324 - val_accuracy30: 0.6077 - val_accuracy50: 0.5568 - 57s/epoch - 26ms/step
Epoch 17/50
2155/2155 - 57s - loss: 9.9142 - accuracy10: 0.6263 - accuracy20: 0.6184 - accuracy30: 0.5988 - accuracy50: 0.5618 - val_loss: 9.7883 - val_accuracy10: 0.6472 - val_accuracy20: 0.6328 - val_accuracy30: 0.6067 - val_accuracy50: 0.5552 - 57s/epoch - 26ms/step
Epoch 18/50
2155/2155 - 57s - loss: 9.8965 - accuracy10: 0.6267 - accuracy20: 0.6189 - accuracy30: 0.5992 - accuracy50: 0.5632 - val_loss: 9.8044 - val_accuracy10: 0.6515 - val_accuracy20: 0.6356 - val_accuracy30: 0.6100 - val_accuracy50: 0.5567 - 57s/epoch - 27ms/step
Epoch 19/50
2155/2155 - 57s - loss: 9.8791 - accuracy10: 0.6277 - accuracy20: 0.6201 - accuracy30: 0.6004 - accuracy50: 0.5634 - val_loss: 9.8187 - val_accuracy10: 0.6425 - val_accuracy20: 0.6285 - val_accuracy30: 0.6042 - val_accuracy50: 0.5542 - 57s/epoch - 26ms/step
Epoch 20/50
2155/2155 - 57s - loss: 9.8637 - accuracy10: 0.6280 - accuracy20: 0.6208 - accuracy30: 0.6010 - accuracy50: 0.5642 - val_loss: 9.8197 - val_accuracy10: 0.6420 - val_accuracy20: 0.6272 - val_accuracy30: 0.6024 - val_accuracy50: 0.5526 - 57s/epoch - 27ms/step
Epoch 21/50
2155/2155 - 58s - loss: 9.8489 - accuracy10: 0.6286 - accuracy20: 0.6214 - accuracy30: 0.6023 - accuracy50: 0.5653 - val_loss: 9.8040 - val_accuracy10: 0.6515 - val_accuracy20: 0.6353 - val_accuracy30: 0.6085 - val_accuracy50: 0.5559 - 58s/epoch - 27ms/step
Epoch 22/50
2155/2155 - 57s - loss: 9.8360 - accuracy10: 0.6290 - accuracy20: 0.6218 - accuracy30: 0.6022 - accuracy50: 0.5653 - val_loss: 9.8109 - val_accuracy10: 0.6446 - val_accuracy20: 0.6310 - val_accuracy30: 0.6065 - val_accuracy50: 0.5555 - 57s/epoch - 27ms/step
Epoch 23/50
2155/2155 - 57s - loss: 9.8218 - accuracy10: 0.6287 - accuracy20: 0.6222 - accuracy30: 0.6029 - accuracy50: 0.5660 - val_loss: 9.7859 - val_accuracy10: 0.6450 - val_accuracy20: 0.6312 - val_accuracy30: 0.6065 - val_accuracy50: 0.5563 - 57s/epoch - 26ms/step
Epoch 24/50
2155/2155 - 57s - loss: 9.8111 - accuracy10: 0.6292 - accuracy20: 0.6226 - accuracy30: 0.6033 - accuracy50: 0.5672 - val_loss: 9.8154 - val_accuracy10: 0.6408 - val_accuracy20: 0.6263 - val_accuracy30: 0.6015 - val_accuracy50: 0.5528 - 57s/epoch - 26ms/step
Epoch 25/50
2155/2155 - 59s - loss: 9.7976 - accuracy10: 0.6300 - accuracy20: 0.6233 - accuracy30: 0.6045 - accuracy50: 0.5673 - val_loss: 9.8051 - val_accuracy10: 0.6324 - val_accuracy20: 0.6201 - val_accuracy30: 0.5973 - val_accuracy50: 0.5524 - 59s/epoch - 28ms/step
Epoch 26/50
2155/2155 - 58s - loss: 9.7826 - accuracy10: 0.6308 - accuracy20: 0.6240 - accuracy30: 0.6046 - accuracy50: 0.5680 - val_loss: 9.8308 - val_accuracy10: 0.6318 - val_accuracy20: 0.6199 - val_accuracy30: 0.5977 - val_accuracy50: 0.5528 - 58s/epoch - 27ms/step
Epoch 27/50
2155/2155 - 57s - loss: 9.7681 - accuracy10: 0.6308 - accuracy20: 0.6244 - accuracy30: 0.6056 - accuracy50: 0.5688 - val_loss: 9.8520 - val_accuracy10: 0.6416 - val_accuracy20: 0.6255 - val_accuracy30: 0.6010 - val_accuracy50: 0.5518 - 57s/epoch - 26ms/step
Epoch 28/50
2155/2155 - 57s - loss: 9.7602 - accuracy10: 0.6311 - accuracy20: 0.6245 - accuracy30: 0.6057 - accuracy50: 0.5690 - val_loss: 9.8223 - val_accuracy10: 0.6394 - val_accuracy20: 0.6255 - val_accuracy30: 0.6030 - val_accuracy50: 0.5546 - 57s/epoch - 27ms/step
Epoch 29/50
2155/2155 - 58s - loss: 9.7442 - accuracy10: 0.6320 - accuracy20: 0.6255 - accuracy30: 0.6067 - accuracy50: 0.5698 - val_loss: 9.8386 - val_accuracy10: 0.6396 - val_accuracy20: 0.6254 - val_accuracy30: 0.6018 - val_accuracy50: 0.5544 - 58s/epoch - 27ms/step
Epoch 30/50
2155/2155 - 59s - loss: 9.7345 - accuracy10: 0.6316 - accuracy20: 0.6260 - accuracy30: 0.6075 - accuracy50: 0.5703 - val_loss: 9.8545 - val_accuracy10: 0.6355 - val_accuracy20: 0.6225 - val_accuracy30: 0.5995 - val_accuracy50: 0.5530 - 59s/epoch - 27ms/step
Epoch 31/50
2155/2155 - 57s - loss: 9.7203 - accuracy10: 0.6320 - accuracy20: 0.6265 - accuracy30: 0.6074 - accuracy50: 0.5710 - val_loss: 9.8941 - val_accuracy10: 0.6368 - val_accuracy20: 0.6224 - val_accuracy30: 0.5985 - val_accuracy50: 0.5505 - 57s/epoch - 27ms/step
Epoch 32/50
2155/2155 - 59s - loss: 9.7105 - accuracy10: 0.6327 - accuracy20: 0.6268 - accuracy30: 0.6084 - accuracy50: 0.5714 - val_loss: 9.9330 - val_accuracy10: 0.6399 - val_accuracy20: 0.6249 - val_accuracy30: 0.6013 - val_accuracy50: 0.5522 - 59s/epoch - 28ms/step
Epoch 33/50
2155/2155 - 57s - loss: 9.7040 - accuracy10: 0.6331 - accuracy20: 0.6274 - accuracy30: 0.6086 - accuracy50: 0.5717 - val_loss: 9.9191 - val_accuracy10: 0.6343 - val_accuracy20: 0.6210 - val_accuracy30: 0.5979 - val_accuracy50: 0.5507 - 57s/epoch - 26ms/step
testing model: results/WBA/W3/deepVOL_L2/seq2seq
Evaluating performance on  test set...
6315/6315 - 55s - 55s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.736737
{'0': {'precision': 0.3720990384706653, 'recall': 0.6955289421157684, 'f1-score': 0.4848236563594708, 'support': 225450}, '1': {'precision': 0.888131455030698, 'recall': 0.6602425099158695, 'f1-score': 0.7574166890941447, 'support': 1165808}, '2': {'precision': 0.4161730534381367, 'recall': 0.6068592795225238, 'f1-score': 0.49374486265795914, 'support': 225184}, 'accuracy': 0.6577272800385043, 'macro avg': {'precision': 0.5588011823131667, 'recall': 0.6542102438513873, 'f1-score': 0.5786617360371915, 'support': 1616442}, 'weighted avg': {'precision': 0.7504110858385596, 'recall': 0.6577272800385043, 'f1-score': 0.6826656149484357, 'support': 1616442}}
[[156807  42650  25993]
 [230379 769716 165713]
 [ 34226  54303 136655]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.78097546
{'0': {'precision': 0.44054456985018386, 'recall': 0.6329098954381055, 'f1-score': 0.5194910946964539, 'support': 304413}, '1': {'precision': 0.8046346474618253, 'recall': 0.6694807315642184, 'f1-score': 0.7308619122888109, 'support': 1007321}, '2': {'precision': 0.48734251460479083, 'recall': 0.5453614608083804, 'f1-score': 0.5147221895268951, 'support': 304708}, 'accuracy': 0.6391964574045961, 'macro avg': {'precision': 0.5775072439722666, 'recall': 0.6159173626035681, 'f1-score': 0.5883583988373866, 'support': 1616442}, 'weighted avg': {'precision': 0.6762568869145283, 'recall': 0.6391964574045961, 'f1-score': 0.6503124540718875, 'support': 1616442}}
[[192666  73449  38298]
 [196429 674382 136510]
 [ 48241  90291 166176]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8300535
{'0': {'precision': 0.4727043470318414, 'recall': 0.5862243305143982, 'f1-score': 0.5233795160068967, 'support': 361957}, '1': {'precision': 0.7285939101156492, 'recall': 0.6696900719876209, 'f1-score': 0.6979013052572538, 'support': 891820}, '2': {'precision': 0.5182367805980319, 'recall': 0.4970537548426234, 'f1-score': 0.5074242863536692, 'support': 362665}, 'accuracy': 0.6122675604816009, 'macro avg': {'precision': 0.5731783459151741, 'recall': 0.5843227191148808, 'f1-score': 0.5762350358726066, 'support': 1616442}, 'weighted avg': {'precision': 0.6240988605180562, 'recall': 0.6122675604816009, 'f1-score': 0.6160865965746287, 'support': 1616442}}
[[212188 101142  48627]
 [175627 597243 118950]
 [ 61066 121335 180264]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.91948074
{'0': {'precision': 0.5037488068985946, 'recall': 0.5117037400258547, 'f1-score': 0.5076951144675228, 'support': 448660}, '1': {'precision': 0.5975089218719676, 'recall': 0.670686358578164, 'f1-score': 0.6319863970571412, 'support': 720702}, '2': {'precision': 0.5379836806641458, 'recall': 0.4232463988547911, 'f1-score': 0.4737672287527698, 'support': 447080}, 'accuracy': 0.558121479149886, 'macro avg': {'precision': 0.5464138031449026, 'recall': 0.5352121658196033, 'f1-score': 0.5378162467591445, 'support': 1616442}, 'weighted avg': {'precision': 0.5550211876859303, 'recall': 0.558121479149886, 'f1-score': 0.5537273858385657, 'support': 1616442}}
[[229581 152702  66377]
 [141209 483365  96128]
 [ 84955 172900 189225]]
Evaluating performance on  train set...
2155/2155 - 19s - 19s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.81523395
{'0': {'precision': 0.3866788074173424, 'recall': 0.7054188740235252, 'f1-score': 0.4995350389851928, 'support': 89096}, '1': {'precision': 0.869086895865636, 'recall': 0.6046006780174208, 'f1-score': 0.7131098013019085, 'support': 369902}, '2': {'precision': 0.43293942523847134, 'recall': 0.615994726775661, 'f1-score': 0.5084940793434872, 'support': 92543}, 'accuracy': 0.6227986677327706, 'macro avg': {'precision': 0.5629017095071499, 'recall': 0.6420047596055357, 'f1-score': 0.5737129732101961, 'support': 551541}, 'weighted avg': {'precision': 0.717977501600044, 'recall': 0.6227986677327706, 'f1-score': 0.644276460207469, 'support': 551541}}
[[ 62850  14590  11656]
 [ 83249 223643  63010]
 [ 16439  19098  57006]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.84125197
{'0': {'precision': 0.4564088003962836, 'recall': 0.6397050107530523, 'f1-score': 0.5327311700582419, 'support': 118106}, '1': {'precision': 0.7781660547617995, 'recall': 0.6218811461185454, 'f1-score': 0.6913006900074842, 'support': 311172}, '2': {'precision': 0.5038375835602872, 'recall': 0.5659111914479442, 'f1-score': 0.5330734353150557, 'support': 122263}, 'accuracy': 0.6132907617022125, 'macro avg': {'precision': 0.5794708129061235, 'recall': 0.6091657827731807, 'f1-score': 0.5857017651269273, 'support': 551541}, 'weighted avg': {'precision': 0.648453695828186, 'recall': 0.6132907617022125, 'f1-score': 0.6222698281792871, 'support': 551541}}
[[ 75553  24732  17821]
 [ 67345 193512  50315]
 [ 22640  30433  69190]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8757568
{'0': {'precision': 0.48664786863493115, 'recall': 0.5941676792223572, 'f1-score': 0.5350597246284309, 'support': 138264}, '1': {'precision': 0.6979443422928331, 'recall': 0.6242188625974228, 'f1-score': 0.659026089806365, 'support': 270599}, '2': {'precision': 0.5314751908125702, 'recall': 0.5241592957568791, 'f1-score': 0.5277918925022584, 'support': 142678}, 'accuracy': 0.59080104652238, 'macro avg': {'precision': 0.5720224672467782, 'recall': 0.580848612525553, 'f1-score': 0.5739592356456847, 'support': 551541}, 'weighted avg': {'precision': 0.6019112618351027, 'recall': 0.59080104652238, 'f1-score': 0.5940004283996568, 'support': 551541}}
[[ 82152  33249  22863]
 [ 58621 168913  43065]
 [ 28039  39853  74786]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.94069546
{'0': {'precision': 0.5144883958546198, 'recall': 0.529882921725326, 'f1-score': 0.5220721975033623, 'support': 166299}, '1': {'precision': 0.5632747868678623, 'recall': 0.6261753066322377, 'f1-score': 0.5930618935802578, 'support': 213774}, '2': {'precision': 0.5518300378628523, 'recall': 0.45898943243054097, 'f1-score': 0.501146175594101, 'support': 171468}, 'accuracy': 0.5451652732979053, 'macro avg': {'precision': 0.5431977401951115, 'recall': 0.5383492202627016, 'f1-score': 0.5387600888925737, 'support': 551541}, 'weighted avg': {'precision': 0.5450068135685024, 'recall': 0.5451652732979053, 'f1-score': 0.5430817111467814, 'support': 551541}}
[[ 88119  48142  30038]
 [ 46034 133860  33880]
 [ 37122  55644  78702]]
Evaluating performance on  val set...
746/746 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7626837
{'0': {'precision': 0.369661438111508, 'recall': 0.7111061318993204, 'f1-score': 0.48644782219951466, 'support': 26778}, '1': {'precision': 0.891999878309722, 'recall': 0.6410263884738994, 'f1-score': 0.7459695543399907, 'support': 137219}, '2': {'precision': 0.39440328812975317, 'recall': 0.5989086967896251, 'f1-score': 0.47560396509764347, 'support': 26757}, 'accuracy': 0.644956331190958, 'macro avg': {'precision': 0.5520215348503278, 'recall': 0.6503470723876149, 'f1-score': 0.569340447212383, 'support': 190754}, 'weighted avg': {'precision': 0.7488764276084356, 'recall': 0.644956331190958, 'f1-score': 0.6716138657850187, 'support': 190754}}
[[19042  4546  3190]
 [27842 87961 21416]
 [ 4628  6104 16025]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.79908776
{'0': {'precision': 0.44086874409820587, 'recall': 0.6476888075023584, 'f1-score': 0.5246314275440489, 'support': 36042}, '1': {'precision': 0.8097343278578613, 'recall': 0.6532457763917412, 'f1-score': 0.723120605859322, 'support': 118323}, '2': {'precision': 0.4686171720034004, 'recall': 0.5453571134133942, 'f1-score': 0.5040832137368709, 'support': 36389}, 'accuracy': 0.6316145401931283, 'macro avg': {'precision': 0.5730734146531559, 'recall': 0.6154305657691647, 'f1-score': 0.5839450823800806, 'support': 190754}, 'weighted avg': {'precision': 0.674966168059097, 'recall': 0.6316145401931283, 'f1-score': 0.6438326295821118, 'support': 190754}}
[[23344  7886  4812]
 [23338 77294 17691]
 [ 6268 10276 19845]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.844056
{'0': {'precision': 0.47562823355506284, 'recall': 0.5995202161356438, 'f1-score': 0.5304360369271348, 'support': 42936}, '1': {'precision': 0.7324822330128308, 'recall': 0.6545339604026781, 'f1-score': 0.691317807498533, 'support': 104401}, '2': {'precision': 0.5006114020718455, 'recall': 0.4997581592463781, 'f1-score': 0.5001844167819273, 'support': 43417}, 'accuracy': 0.6069230527275968, 'macro avg': {'precision': 0.5695739562132464, 'recall': 0.5846041119282334, 'f1-score': 0.5739794204025316, 'support': 190754}, 'weighted avg': {'precision': 0.6218925772903636, 'recall': 0.6069230527275968, 'f1-score': 0.6116022674522094, 'support': 190754}}
[[25741 10962  6233]
 [20655 68334 15412]
 [ 7724 13995 21698]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9231497
{'0': {'precision': 0.5101422285516057, 'recall': 0.5240149284522045, 'f1-score': 0.5169855308440956, 'support': 53321}, '1': {'precision': 0.596399018308972, 'recall': 0.6567806744797895, 'f1-score': 0.6251351689754475, 'support': 83620}, '2': {'precision': 0.5303095883545572, 'recall': 0.43259063794993774, 'f1-score': 0.47649165899089135, 'support': 53813}, 'accuracy': 0.5564234563888568, 'macro avg': {'precision': 0.5456169450717117, 'recall': 0.5377954136273105, 'f1-score': 0.5395374529368114, 'support': 190754}, 'weighted avg': {'precision': 0.5536435910005567, 'recall': 0.5564234563888568, 'f1-score': 0.5529710200842015, 'support': 190754}}
[[27941 16929  8451]
 [16533 54920 12167]
 [10297 20237 23279]]
training model: results/WBA/W3/deepVOL_L3/seq2seq
Epoch 1/50
2155/2155 - 91s - loss: 11.5080 - accuracy10: 0.4953 - accuracy20: 0.5094 - accuracy30: 0.5089 - accuracy50: 0.4964 - val_loss: 10.7330 - val_accuracy10: 0.6737 - val_accuracy20: 0.6464 - val_accuracy30: 0.6120 - val_accuracy50: 0.5412 - 91s/epoch - 42ms/step
Epoch 2/50
2155/2155 - 86s - loss: 10.7006 - accuracy10: 0.5753 - accuracy20: 0.5743 - accuracy30: 0.5622 - accuracy50: 0.5340 - val_loss: 10.4662 - val_accuracy10: 0.6567 - val_accuracy20: 0.6366 - val_accuracy30: 0.6086 - val_accuracy50: 0.5502 - 86s/epoch - 40ms/step
Epoch 3/50
2155/2155 - 83s - loss: 10.4423 - accuracy10: 0.5964 - accuracy20: 0.5908 - accuracy30: 0.5752 - accuracy50: 0.5432 - val_loss: 9.9952 - val_accuracy10: 0.6608 - val_accuracy20: 0.6443 - val_accuracy30: 0.6175 - val_accuracy50: 0.5585 - 83s/epoch - 38ms/step
Epoch 4/50
2155/2155 - 83s - loss: 10.2973 - accuracy10: 0.6057 - accuracy20: 0.5999 - accuracy30: 0.5834 - accuracy50: 0.5492 - val_loss: 9.9495 - val_accuracy10: 0.6586 - val_accuracy20: 0.6426 - val_accuracy30: 0.6153 - val_accuracy50: 0.5572 - 83s/epoch - 39ms/step
Epoch 5/50
2155/2155 - 83s - loss: 10.1927 - accuracy10: 0.6125 - accuracy20: 0.6054 - accuracy30: 0.5876 - accuracy50: 0.5525 - val_loss: 9.8861 - val_accuracy10: 0.6564 - val_accuracy20: 0.6412 - val_accuracy30: 0.6147 - val_accuracy50: 0.5577 - 83s/epoch - 38ms/step
Epoch 6/50
2155/2155 - 84s - loss: 10.1316 - accuracy10: 0.6155 - accuracy20: 0.6078 - accuracy30: 0.5897 - accuracy50: 0.5541 - val_loss: 9.7069 - val_accuracy10: 0.6532 - val_accuracy20: 0.6399 - val_accuracy30: 0.6151 - val_accuracy50: 0.5609 - 84s/epoch - 39ms/step
Epoch 7/50
2155/2155 - 86s - loss: 10.0717 - accuracy10: 0.6181 - accuracy20: 0.6104 - accuracy30: 0.5921 - accuracy50: 0.5567 - val_loss: 9.7047 - val_accuracy10: 0.6450 - val_accuracy20: 0.6331 - val_accuracy30: 0.6102 - val_accuracy50: 0.5601 - 86s/epoch - 40ms/step
Epoch 8/50
2155/2155 - 85s - loss: 10.0324 - accuracy10: 0.6200 - accuracy20: 0.6123 - accuracy30: 0.5938 - accuracy50: 0.5577 - val_loss: 9.7059 - val_accuracy10: 0.6269 - val_accuracy20: 0.6218 - val_accuracy30: 0.6038 - val_accuracy50: 0.5592 - 85s/epoch - 39ms/step
Epoch 9/50
2155/2155 - 86s - loss: 9.9969 - accuracy10: 0.6218 - accuracy20: 0.6137 - accuracy30: 0.5953 - accuracy50: 0.5595 - val_loss: 9.6982 - val_accuracy10: 0.6314 - val_accuracy20: 0.6232 - val_accuracy30: 0.6028 - val_accuracy50: 0.5576 - 86s/epoch - 40ms/step
Epoch 10/50
2155/2155 - 84s - loss: 9.9706 - accuracy10: 0.6232 - accuracy20: 0.6151 - accuracy30: 0.5963 - accuracy50: 0.5603 - val_loss: 9.6567 - val_accuracy10: 0.6300 - val_accuracy20: 0.6222 - val_accuracy30: 0.6020 - val_accuracy50: 0.5569 - 84s/epoch - 39ms/step
Epoch 11/50
2155/2155 - 86s - loss: 9.9526 - accuracy10: 0.6243 - accuracy20: 0.6159 - accuracy30: 0.5970 - accuracy50: 0.5610 - val_loss: 9.6231 - val_accuracy10: 0.6226 - val_accuracy20: 0.6153 - val_accuracy30: 0.5959 - val_accuracy50: 0.5547 - 86s/epoch - 40ms/step
Epoch 12/50
2155/2155 - 85s - loss: 9.9298 - accuracy10: 0.6254 - accuracy20: 0.6168 - accuracy30: 0.5978 - accuracy50: 0.5616 - val_loss: 9.7350 - val_accuracy10: 0.6042 - val_accuracy20: 0.6004 - val_accuracy30: 0.5837 - val_accuracy50: 0.5480 - 85s/epoch - 40ms/step
Epoch 13/50
2155/2155 - 86s - loss: 9.9113 - accuracy10: 0.6264 - accuracy20: 0.6177 - accuracy30: 0.5987 - accuracy50: 0.5626 - val_loss: 9.7149 - val_accuracy10: 0.6142 - val_accuracy20: 0.6076 - val_accuracy30: 0.5891 - val_accuracy50: 0.5505 - 86s/epoch - 40ms/step
Epoch 14/50
2155/2155 - 85s - loss: 9.8907 - accuracy10: 0.6272 - accuracy20: 0.6181 - accuracy30: 0.5993 - accuracy50: 0.5633 - val_loss: 9.7234 - val_accuracy10: 0.6093 - val_accuracy20: 0.6057 - val_accuracy30: 0.5889 - val_accuracy50: 0.5508 - 85s/epoch - 39ms/step
Epoch 15/50
2155/2155 - 88s - loss: 9.8783 - accuracy10: 0.6278 - accuracy20: 0.6196 - accuracy30: 0.6000 - accuracy50: 0.5635 - val_loss: 9.7233 - val_accuracy10: 0.6174 - val_accuracy20: 0.6127 - val_accuracy30: 0.5949 - val_accuracy50: 0.5537 - 88s/epoch - 41ms/step
Epoch 16/50
2155/2155 - 87s - loss: 9.8621 - accuracy10: 0.6280 - accuracy20: 0.6193 - accuracy30: 0.6003 - accuracy50: 0.5646 - val_loss: 9.6259 - val_accuracy10: 0.6292 - val_accuracy20: 0.6203 - val_accuracy30: 0.5992 - val_accuracy50: 0.5553 - 87s/epoch - 40ms/step
Epoch 17/50
2155/2155 - 85s - loss: 9.8452 - accuracy10: 0.6285 - accuracy20: 0.6204 - accuracy30: 0.6011 - accuracy50: 0.5650 - val_loss: 9.7271 - val_accuracy10: 0.6218 - val_accuracy20: 0.6141 - val_accuracy30: 0.5940 - val_accuracy50: 0.5528 - 85s/epoch - 39ms/step
Epoch 18/50
2155/2155 - 85s - loss: 9.8295 - accuracy10: 0.6281 - accuracy20: 0.6203 - accuracy30: 0.6019 - accuracy50: 0.5656 - val_loss: 9.7422 - val_accuracy10: 0.6195 - val_accuracy20: 0.6113 - val_accuracy30: 0.5909 - val_accuracy50: 0.5507 - 85s/epoch - 40ms/step
Epoch 19/50
2155/2155 - 83s - loss: 9.8153 - accuracy10: 0.6295 - accuracy20: 0.6215 - accuracy30: 0.6023 - accuracy50: 0.5665 - val_loss: 9.6889 - val_accuracy10: 0.6194 - val_accuracy20: 0.6124 - val_accuracy30: 0.5932 - val_accuracy50: 0.5526 - 83s/epoch - 39ms/step
Epoch 20/50
2155/2155 - 89s - loss: 9.8020 - accuracy10: 0.6301 - accuracy20: 0.6222 - accuracy30: 0.6033 - accuracy50: 0.5669 - val_loss: 9.7228 - val_accuracy10: 0.6154 - val_accuracy20: 0.6092 - val_accuracy30: 0.5896 - val_accuracy50: 0.5515 - 89s/epoch - 41ms/step
Epoch 21/50
2155/2155 - 83s - loss: 9.7866 - accuracy10: 0.6307 - accuracy20: 0.6230 - accuracy30: 0.6038 - accuracy50: 0.5674 - val_loss: 9.7655 - val_accuracy10: 0.6162 - val_accuracy20: 0.6095 - val_accuracy30: 0.5894 - val_accuracy50: 0.5497 - 83s/epoch - 39ms/step
testing model: results/WBA/W3/deepVOL_L3/seq2seq
Evaluating performance on  test set...
6315/6315 - 98s - 98s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7729903
{'0': {'precision': 0.3363116491802484, 'recall': 0.8000487913062764, 'f1-score': 0.47355701385324467, 'support': 225450}, '1': {'precision': 0.9054981580128023, 'recall': 0.614585763693507, 'f1-score': 0.7322046750427808, 'support': 1165808}, '2': {'precision': 0.4322742127565292, 'recall': 0.5545020960636635, 'f1-score': 0.48581822426270327, 'support': 225184}, 'accuracy': 0.6320826853051331, 'macro avg': {'precision': 0.55802800664986, 'recall': 0.6563788836878156, 'f1-score': 0.5638599710529095, 'support': 1616442}, 'weighted avg': {'precision': 0.760187927701484, 'recall': 0.6320826853051331, 'f1-score': 0.6618066021470989, 'support': 1616442}}
[[180371  27856  17223]
 [302551 716489 146768]
 [ 53399  46920 124865]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7960392
{'0': {'precision': 0.4066462638562037, 'recall': 0.736791792728957, 'f1-score': 0.524057473909747, 'support': 304413}, '1': {'precision': 0.8316383820847503, 'recall': 0.6220142337943912, 'f1-score': 0.7117118703268805, 'support': 1007321}, '2': {'precision': 0.4968985777121392, 'recall': 0.5079256205941426, 'f1-score': 0.502351593208456, 'support': 304708}, 'accuracy': 0.6221231569088158, 'macro avg': {'precision': 0.5783944078843644, 'recall': 0.622243882372497, 'f1-score': 0.5793736458150279, 'support': 1616442}, 'weighted avg': {'precision': 0.6885023945287005, 'recall': 0.6221231569088158, 'f1-score': 0.6369067185820423, 'support': 1616442}}
[[224289  52270  27854]
 [251906 626568 128847]
 [ 75363  74576 154769]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8360422
{'0': {'precision': 0.4406341599017548, 'recall': 0.6919192058725208, 'f1-score': 0.538399773843933, 'support': 361957}, '1': {'precision': 0.7634782584683104, 'recall': 0.6200309479491377, 'f1-score': 0.6843180314823718, 'support': 891820}, '2': {'precision': 0.5254702617901293, 'recall': 0.46917127376504486, 'f1-score': 0.4957274419715823, 'support': 362665}, 'accuracy': 0.6022814304503348, 'macro avg': {'precision': 0.5765275600533982, 'recall': 0.5937071425289011, 'f1-score': 0.572815082432629, 'support': 1616442}, 'weighted avg': {'precision': 0.6377868624886543, 'recall': 0.6022814304503348, 'f1-score': 0.6093315235068509, 'support': 1616442}}
[[250445  74804  36708]
 [221915 552956 116949]
 [ 96014  96499 170152]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9078445
{'0': {'precision': 0.475169458725369, 'recall': 0.6184192930058396, 'f1-score': 0.5374121858106603, 'support': 448660}, '1': {'precision': 0.6385259943660356, 'recall': 0.618018265524447, 'f1-score': 0.6281047793171477, 'support': 720702}, '2': {'precision': 0.5442025978523386, 'recall': 0.4077368703587725, 'f1-score': 0.46618818002452533, 'support': 447080}, 'accuracy': 0.5599693648148217, 'macro avg': {'precision': 0.5526326836479144, 'recall': 0.5480581429630197, 'f1-score': 0.5439017150507778, 'support': 1616442}, 'weighted avg': {'precision': 0.5670964921668319, 'recall': 0.5599693648148217, 'f1-score': 0.558148782000593, 'support': 1616442}}
[[277460 116986  54214]
 [176831 445407  98464]
 [129627 135162 182291]]
Evaluating performance on  train set...
2155/2155 - 34s - 34s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8685128
{'0': {'precision': 0.3381268797649857, 'recall': 0.813874921433061, 'f1-score': 0.4777648566468238, 'support': 89096}, '1': {'precision': 0.8859946006452888, 'recall': 0.545641818643857, 'f1-score': 0.6753610046393969, 'support': 369902}, '2': {'precision': 0.455083683348432, 'recall': 0.5373934279199939, 'f1-score': 0.49282543205961626, 'support': 92543}, 'accuracy': 0.5875882300681182, 'macro avg': {'precision': 0.5597350545862355, 'recall': 0.6323033893323039, 'f1-score': 0.548650431115279, 'support': 551541}, 'weighted avg': {'precision': 0.7251894900932999, 'recall': 0.5875882300681182, 'f1-score': 0.6128136765263519, 'support': 551541}}
[[ 72513   9048   7535]
 [116054 201834  52014]
 [ 25888  16923  49732]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8702584
{'0': {'precision': 0.4080884369913867, 'recall': 0.7557787072629671, 'f1-score': 0.5299995843699344, 'support': 118106}, '1': {'precision': 0.8050686613821592, 'recall': 0.5561682927769851, 'f1-score': 0.6578629262173566, 'support': 311172}, '2': {'precision': 0.51711204080074, 'recall': 0.4984091671233325, 'f1-score': 0.5075883783693733, 'support': 122263}, 'accuracy': 0.5861087389695417, 'macro avg': {'precision': 0.5767563797247619, 'recall': 0.6034520557210948, 'f1-score': 0.5651502963188881, 'support': 551541}, 'weighted avg': {'precision': 0.6562271669437718, 'recall': 0.5861087389695417, 'f1-score': 0.597170348701325, 'support': 551541}}
[[ 89262  16468  12376]
 [ 93580 173064  44528]
 [ 35890  25436  60937]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.89291155
{'0': {'precision': 0.4398686787236494, 'recall': 0.718053867962738, 'f1-score': 0.545544962496909, 'support': 138264}, '1': {'precision': 0.7317420069937273, 'recall': 0.551369369435955, 'f1-score': 0.6288777987591043, 'support': 270599}, '2': {'precision': 0.5416031097770998, 'recall': 0.46287444455347004, 'f1-score': 0.4991534903407201, 'support': 142678}, 'accuracy': 0.5702622289186117, 'macro avg': {'precision': 0.5710712651648255, 'recall': 0.577432560650721, 'f1-score': 0.5578587505322444, 'support': 551541}, 'weighted avg': {'precision': 0.6093862593031513, 'recall': 0.5702622289186117, 'f1-score': 0.5744290158953201, 'support': 551541}}
[[ 99281  22948  16035]
 [ 81538 149200  39861]
 [ 44887  31749  66042]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9380496
{'0': {'precision': 0.47135111465993534, 'recall': 0.6602384861003373, 'f1-score': 0.5500300571085062, 'support': 166299}, '1': {'precision': 0.6029690182633006, 'recall': 0.5437845575233659, 'f1-score': 0.5718495197569885, 'support': 213774}, '2': {'precision': 0.5593002090470475, 'recall': 0.4103681153334733, 'f1-score': 0.47339686554963883, 'support': 171468}, 'accuracy': 0.5374197022524164, 'macro avg': {'precision': 0.5445401139900944, 'recall': 0.5381303863190589, 'f1-score': 0.5317588141383779, 'support': 551541}, 'weighted avg': {'precision': 0.5497078298293882, 'recall': 0.5374197022524164, 'f1-score': 0.5346627384830563, 'support': 551541}}
[[109797  34010  22492]
 [ 64575 116247  32952]
 [ 58569  42534  70365]]
Evaluating performance on  val set...
746/746 - 11s - 11s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7993615
{'0': {'precision': 0.3344186405369956, 'recall': 0.809321084472328, 'f1-score': 0.4732756079185002, 'support': 26778}, '1': {'precision': 0.9075663454573392, 'recall': 0.6026279159591602, 'f1-score': 0.724310546438754, 'support': 137219}, '2': {'precision': 0.41742500358834506, 'recall': 0.5434465747281085, 'f1-score': 0.4721717106117677, 'support': 26757}, 'accuracy': 0.6233421055390712, 'macro avg': {'precision': 0.5531366631942266, 'recall': 0.6517985250531989, 'f1-score': 0.556585954989674, 'support': 190754}, 'weighted avg': {'precision': 0.7583560477611145, 'recall': 0.6233421055390712, 'f1-score': 0.6537028925289119, 'support': 190754}}
[[21672  3008  2098]
 [36331 82692 18196]
 [ 6802  5414 14541]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.81706405
{'0': {'precision': 0.4051680129725834, 'recall': 0.7487098385217247, 'f1-score': 0.5257979034332255, 'support': 36042}, '1': {'precision': 0.8322225675380135, 'recall': 0.6110477252943215, 'f1-score': 0.7046881091617935, 'support': 118323}, '2': {'precision': 0.48651911468812875, 'recall': 0.498364890488884, 'f1-score': 0.49237076455256296, 'support': 36389}, 'accuracy': 0.6155624521635195, 'macro avg': {'precision': 0.5746365650662418, 'recall': 0.6193741514349768, 'f1-score': 0.5742855923825273, 'support': 190754}, 'weighted avg': {'precision': 0.6855849966278272, 'recall': 0.6155624521635195, 'f1-score': 0.6303852025498519, 'support': 190754}}
[[26985  5700  3357]
 [30239 72301 15783]
 [ 9378  8876 18135]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8529564
{'0': {'precision': 0.44037231795603854, 'recall': 0.7041177566610769, 'f1-score': 0.5418552340326382, 'support': 42936}, '1': {'precision': 0.7598609966682192, 'recall': 0.6094769207191502, 'f1-score': 0.6764111831614754, 'support': 104401}, '2': {'precision': 0.5173078928161818, 'recall': 0.4571020567980284, 'f1-score': 0.48534500678641734, 'support': 43417}, 'accuracy': 0.5960975916625602, 'macro avg': {'precision': 0.5725137358134799, 'recall': 0.5902322447260852, 'f1-score': 0.567870474660177, 'support': 190754}, 'weighted avg': {'precision': 0.6327418064067825, 'recall': 0.59609759166256, 'f1-score': 0.6026365078651689, 'support': 190754}}
[[30232  8328  4376]
 [26629 63630 14142]
 [11790 11781 19846]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.91446394
{'0': {'precision': 0.4762429534183868, 'recall': 0.6321711895875921, 'f1-score': 0.5432393231265109, 'support': 53321}, '1': {'precision': 0.6283500161446561, 'recall': 0.6050705572829467, 'f1-score': 0.6164905996027829, 'support': 83620}, '2': {'precision': 0.5465997516031734, 'recall': 0.4007395982383439, 'f1-score': 0.4624407608346021, 'support': 53813}, 'accuracy': 0.5550027784476341, 'macro avg': {'precision': 0.5503975737220722, 'recall': 0.5459937817029609, 'f1-score': 0.5407235611879654, 'support': 190754}, 'weighted avg': {'precision': 0.562769594882726, 'recall': 0.5550027784476341, 'f1-score': 0.5525563424620498, 'support': 190754}}
[[33708 13341  6272]
 [21408 50596 11616]
 [15663 16585 21565]]
training model: results/WBA/W4/deepLOB_L1/seq2seq
Epoch 1/50
2108/2108 - 57s - loss: 11.4552 - accuracy10: 0.4940 - accuracy20: 0.5145 - accuracy30: 0.5201 - accuracy50: 0.5103 - val_loss: 13.3237 - val_accuracy10: 0.6145 - val_accuracy20: 0.5423 - val_accuracy30: 0.4905 - val_accuracy50: 0.4073 - 57s/epoch - 27ms/step
Epoch 2/50
2108/2108 - 48s - loss: 11.4063 - accuracy10: 0.4871 - accuracy20: 0.5084 - accuracy30: 0.5147 - accuracy50: 0.5057 - val_loss: 12.6486 - val_accuracy10: 0.5812 - val_accuracy20: 0.5524 - val_accuracy30: 0.5237 - val_accuracy50: 0.4642 - 48s/epoch - 23ms/step
Epoch 3/50
2108/2108 - 49s - loss: 10.8777 - accuracy10: 0.5376 - accuracy20: 0.5514 - accuracy30: 0.5490 - accuracy50: 0.5305 - val_loss: 12.0496 - val_accuracy10: 0.6042 - val_accuracy20: 0.5870 - val_accuracy30: 0.5651 - val_accuracy50: 0.5173 - 49s/epoch - 23ms/step
Epoch 4/50
2108/2108 - 48s - loss: 10.4802 - accuracy10: 0.5854 - accuracy20: 0.5907 - accuracy30: 0.5798 - accuracy50: 0.5527 - val_loss: 12.6229 - val_accuracy10: 0.6490 - val_accuracy20: 0.6106 - val_accuracy30: 0.5730 - val_accuracy50: 0.5052 - 48s/epoch - 23ms/step
Epoch 5/50
2108/2108 - 51s - loss: 10.2875 - accuracy10: 0.6048 - accuracy20: 0.6060 - accuracy30: 0.5915 - accuracy50: 0.5604 - val_loss: 12.5476 - val_accuracy10: 0.6607 - val_accuracy20: 0.6184 - val_accuracy30: 0.5778 - val_accuracy50: 0.5050 - 51s/epoch - 24ms/step
Epoch 6/50
2108/2108 - 52s - loss: 10.1654 - accuracy10: 0.6147 - accuracy20: 0.6139 - accuracy30: 0.5977 - accuracy50: 0.5646 - val_loss: 12.6032 - val_accuracy10: 0.6581 - val_accuracy20: 0.6178 - val_accuracy30: 0.5784 - val_accuracy50: 0.5070 - 52s/epoch - 25ms/step
Epoch 7/50
2108/2108 - 53s - loss: 10.0874 - accuracy10: 0.6195 - accuracy20: 0.6175 - accuracy30: 0.6012 - accuracy50: 0.5666 - val_loss: 12.6630 - val_accuracy10: 0.6595 - val_accuracy20: 0.6204 - val_accuracy30: 0.5801 - val_accuracy50: 0.5054 - 53s/epoch - 25ms/step
Epoch 8/50
2108/2108 - 52s - loss: 10.0255 - accuracy10: 0.6231 - accuracy20: 0.6208 - accuracy30: 0.6042 - accuracy50: 0.5692 - val_loss: 12.7604 - val_accuracy10: 0.6575 - val_accuracy20: 0.6182 - val_accuracy30: 0.5800 - val_accuracy50: 0.5068 - 52s/epoch - 25ms/step
Epoch 9/50
2108/2108 - 49s - loss: 9.9824 - accuracy10: 0.6248 - accuracy20: 0.6225 - accuracy30: 0.6053 - accuracy50: 0.5701 - val_loss: 12.6461 - val_accuracy10: 0.6626 - val_accuracy20: 0.6237 - val_accuracy30: 0.5839 - val_accuracy50: 0.5100 - 49s/epoch - 23ms/step
Epoch 10/50
2108/2108 - 52s - loss: 9.9453 - accuracy10: 0.6280 - accuracy20: 0.6247 - accuracy30: 0.6070 - accuracy50: 0.5712 - val_loss: 12.8489 - val_accuracy10: 0.6634 - val_accuracy20: 0.6220 - val_accuracy30: 0.5810 - val_accuracy50: 0.5055 - 52s/epoch - 25ms/step
Epoch 11/50
2108/2108 - 51s - loss: 9.9177 - accuracy10: 0.6304 - accuracy20: 0.6263 - accuracy30: 0.6080 - accuracy50: 0.5718 - val_loss: 12.6611 - val_accuracy10: 0.6582 - val_accuracy20: 0.6214 - val_accuracy30: 0.5842 - val_accuracy50: 0.5121 - 51s/epoch - 24ms/step
Epoch 12/50
2108/2108 - 50s - loss: 9.8905 - accuracy10: 0.6316 - accuracy20: 0.6270 - accuracy30: 0.6091 - accuracy50: 0.5732 - val_loss: 12.7496 - val_accuracy10: 0.6601 - val_accuracy20: 0.6205 - val_accuracy30: 0.5837 - val_accuracy50: 0.5112 - 50s/epoch - 24ms/step
Epoch 13/50
2108/2108 - 51s - loss: 9.8667 - accuracy10: 0.6323 - accuracy20: 0.6279 - accuracy30: 0.6097 - accuracy50: 0.5731 - val_loss: 12.6519 - val_accuracy10: 0.6551 - val_accuracy20: 0.6197 - val_accuracy30: 0.5852 - val_accuracy50: 0.5161 - 51s/epoch - 24ms/step
testing model: results/WBA/W4/deepLOB_L1/seq2seq
Evaluating performance on  test set...
4676/4676 - 44s - 44s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.81020576
{'0': {'precision': 0.3312352239333613, 'recall': 0.6424416113134777, 'f1-score': 0.4371045572499052, 'support': 186680}, '1': {'precision': 0.8249266112251546, 'recall': 0.5735850573186816, 'f1-score': 0.6766701890674354, 'support': 821111}, '2': {'precision': 0.36492982555827036, 'recall': 0.5091808581486063, 'f1-score': 0.42515275286142684, 'support': 189198}, 'accuracy': 0.5741439562101239, 'macro avg': {'precision': 0.5070305535722621, 'recall': 0.5750691755935885, 'f1-score': 0.5129758330595892, 'support': 1196989}, 'weighted avg': {'precision': 0.6752236648871055, 'recall': 0.5741439562101239, 'f1-score': 0.5995527652289531, 'support': 1196989}}
[[119931  48143  18606]
 [201091 470977 149043]
 [ 41050  51812  96336]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8663314
{'0': {'precision': 0.4056698770525085, 'recall': 0.6006805829445433, 'f1-score': 0.4842806316830339, 'support': 249492}, '1': {'precision': 0.7343311557049685, 'recall': 0.5812840459653779, 'f1-score': 0.6489055230202075, 'support': 695567}, '2': {'precision': 0.4346665992692191, 'recall': 0.47785892906759814, 'f1-score': 0.45524055859964374, 'support': 251930}, 'accuracy': 0.5635590636171259, 'macro avg': {'precision': 0.5248892106755654, 'recall': 0.5532745193258398, 'f1-score': 0.5294755711009618, 'support': 1196989}, 'weighted avg': {'precision': 0.6027569712835428, 'recall': 0.5635590636171259, 'f1-score': 0.573831643581076, 'support': 1196989}}
[[149865  71552  28075]
 [162743 404322 128502]
 [ 56818  74725 120387]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9162753
{'0': {'precision': 0.4439604331975123, 'recall': 0.5646511310751606, 'f1-score': 0.49708484343695825, 'support': 293305}, '1': {'precision': 0.6579939011512226, 'recall': 0.5834679055524798, 'f1-score': 0.6184939742775968, 'support': 608719}, '2': {'precision': 0.4665822116653471, 'recall': 0.4495143491600698, 'f1-score': 0.4578892841109231, 'support': 294965}, 'accuracy': 0.5458479568316835, 'macro avg': {'precision': 0.5228455153380274, 'recall': 0.5325444619292368, 'f1-score': 0.5244893672751593, 'support': 1196989}, 'weighted avg': {'precision': 0.5583799236565553, 'recall': 0.5458479568316835, 'f1-score': 0.549167800389427, 'support': 1196989}}
[[165615  91088  36602]
 [138569 355168 114982]
 [ 68856  93518 132591]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.991276
{'0': {'precision': 0.47969606277731863, 'recall': 0.5067226819531517, 'f1-score': 0.4928391248674166, 'support': 353951}, '1': {'precision': 0.5356739447304557, 'recall': 0.5884323376931834, 'f1-score': 0.560815069655984, 'support': 488396}, '2': {'precision': 0.4943928429367965, 'recall': 0.39953530602692294, 'f1-score': 0.4419312581872622, 'support': 354642}, 'accuracy': 0.5083045875943722, 'macro avg': {'precision': 0.5032542834815236, 'recall': 0.4982301085577527, 'f1-score': 0.4985284842368876, 'support': 1196989}, 'weighted avg': {'precision': 0.5068905224955799, 'recall': 0.5083045875943722, 'f1-score': 0.5054917990989876, 'support': 1196989}}
[[179355 123877  50719]
 [106821 287388  94187]
 [ 87717 125233 141692]]
Evaluating performance on  train set...
2108/2108 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.78115374
{'0': {'precision': 0.3518073364661774, 'recall': 0.6406683619558529, 'f1-score': 0.45420120681281234, 'support': 86121}, '1': {'precision': 0.8457050392617333, 'recall': 0.5983921981360159, 'f1-score': 0.7008714985570582, 'support': 367707}, '2': {'precision': 0.3868740757685929, 'recall': 0.553312066930744, 'f1-score': 0.45536109241273204, 'support': 85581}, 'accuracy': 0.5979896516372548, 'macro avg': {'precision': 0.5281288171655012, 'recall': 0.5974575423408709, 'f1-score': 0.5368112659275343, 'support': 539409}, 'weighted avg': {'precision': 0.6940535526362551, 'recall': 0.5979896516372548, 'f1-score': 0.6225366575300383, 'support': 539409}}
[[ 55175  20551  10395]
 [ 83023 220033  64651]
 [ 18635  19593  47353]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.83349746
{'0': {'precision': 0.4230709304282251, 'recall': 0.5969205606654825, 'f1-score': 0.4951800857116805, 'support': 113722}, '1': {'precision': 0.7659095078201641, 'recall': 0.6142551483498735, 'f1-score': 0.6817503349987133, 'support': 312673}, '2': {'precision': 0.45280590355242833, 'recall': 0.5136266303289858, 'f1-score': 0.48130244436337105, 'support': 113014}, 'accuracy': 0.5895174162833768, 'macro avg': {'precision': 0.5472621139336058, 'recall': 0.5749341131147806, 'f1-score': 0.5527442883579216, 'support': 539409}, 'weighted avg': {'precision': 0.6280301260692478, 'recall': 0.5895174162833768, 'f1-score': 0.600419545557524, 'support': 539409}}
[[ 67883  29758  16081]
 [ 66546 192061  54066]
 [ 26024  28943  58047]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8832879
{'0': {'precision': 0.4583911448216323, 'recall': 0.5613069348797873, 'f1-score': 0.5046555124458159, 'support': 132432}, '1': {'precision': 0.6962667338594966, 'recall': 0.6224277742254258, 'f1-score': 0.6572799852677698, 'support': 275248}, '2': {'precision': 0.4814233226106444, 'recall': 0.4794388479378117, 'f1-score': 0.4804290360002282, 'support': 131729}, 'accuracy': 0.5725024981044069, 'macro avg': {'precision': 0.5453604004305911, 'recall': 0.5543911856810083, 'f1-score': 0.5474548445712712, 'support': 539409}, 'weighted avg': {'precision': 0.5853982690621675, 'recall': 0.5725024981044069, 'f1-score': 0.5766199241994134, 'support': 539409}}
[[ 74335  37596  20501]
 [ 56397 171322  47529]
 [ 31433  37140  63156]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.95947474
{'0': {'precision': 0.49113225745019384, 'recall': 0.5024352842840892, 'f1-score': 0.49671947809878847, 'support': 159119}, '1': {'precision': 0.5767749104323351, 'recall': 0.6340667088817932, 'f1-score': 0.6040654093647317, 'support': 222669}, '2': {'precision': 0.5088022694002624, 'recall': 0.42558415439567066, 'f1-score': 0.46348743531102526, 'support': 157621}, 'accuracy': 0.5343162609448489, 'macro avg': {'precision': 0.5255698124275971, 'recall': 0.5206953825205177, 'f1-score': 0.5214241075915151, 'support': 539409}, 'weighted avg': {'precision': 0.5316490616756742, 'recall': 0.5343162609448489, 'f1-score': 0.5313213170610719, 'support': 539409}}
[[ 79947  52035  27137]
 [ 43859 141187  37623]
 [ 38975  51565  67081]]
Evaluating performance on  val set...
798/798 - 7s - 7s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.78913
{'0': {'precision': 0.3738763693550405, 'recall': 0.5826602796190051, 'f1-score': 0.4554826208593231, 'support': 35906}, '1': {'precision': 0.808469755628906, 'recall': 0.6385910603863464, 'f1-score': 0.7135588951389473, 'support': 133093}, '2': {'precision': 0.4029321023452179, 'recall': 0.49355003693811444, 'f1-score': 0.44366116240757053, 'support': 35194}, 'accuracy': 0.6037572296797638, 'macro avg': {'precision': 0.5284260757763881, 'recall': 0.5716004589811553, 'f1-score': 0.5375675594686137, 'support': 204193}, 'weighted avg': {'precision': 0.6621522898136453, 'recall': 0.6037572296797638, 'f1-score': 0.621659233984881, 'support': 204193}}
[[20921 10841  4144]
 [26506 84992 21595]
 [ 8530  9294 17370]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.85046196
{'0': {'precision': 0.4414954835559586, 'recall': 0.5437597989733898, 'f1-score': 0.4873203922738603, 'support': 46561}, '1': {'precision': 0.7199299701979915, 'recall': 0.655966303714657, 'f1-score': 0.6864613422365607, 'support': 111585}, '2': {'precision': 0.4752302107313618, 'recall': 0.46624101461550155, 'f1-score': 0.47069269811341435, 'support': 46047}, 'accuracy': 0.5875960488361501, 'macro avg': {'precision': 0.5455518881617706, 'recall': 0.5553223724345161, 'f1-score': 0.5481581442079452, 'support': 204193}, 'weighted avg': {'precision': 0.6012585272165984, 'recall': 0.5875960488361501, 'f1-score': 0.592394941688296, 'support': 204193}}
[[25318 15035  6208]
 [20890 73196 17499]
 [11138 13440 21469]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9039317
{'0': {'precision': 0.4741444474986256, 'recall': 0.5148298761378899, 'f1-score': 0.4936502826071403, 'support': 53608}, '1': {'precision': 0.6460553730266848, 'recall': 0.6637679071299193, 'f1-score': 0.6547918781725889, 'support': 97168}, '2': {'precision': 0.5065326197646957, 'recall': 0.43765093509556885, 'f1-score': 0.4695791905192327, 'support': 53417}, 'accuracy': 0.5655139990107398, 'macro avg': {'precision': 0.5422441467633353, 'recall': 0.5387495727877927, 'f1-score': 0.5393404504329874, 'support': 204193}, 'weighted avg': {'precision': 0.5644233493691458, 'recall': 0.5655139990107398, 'f1-score': 0.5640346788981186, 'support': 204193}}
[[27599 18255  7754]
 [17650 64497 15021]
 [12959 17080 23378]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9882287
{'0': {'precision': 0.5005804226842842, 'recall': 0.46217255618951547, 'f1-score': 0.4806103717301514, 'support': 63446}, '1': {'precision': 0.5207555524247517, 'recall': 0.6721566997454149, 'f1-score': 0.5868484171491106, 'support': 76988}, '2': {'precision': 0.5310094282501514, 'recall': 0.3851377844696435, 'f1-score': 0.4464605510758797, 'support': 63759}, 'accuracy': 0.5172900148389024, 'macro avg': {'precision': 0.5174484677863957, 'recall': 0.5064890134681913, 'f1-score': 0.5046397799850473, 'support': 204193}, 'weighted avg': {'precision': 0.5176885794493703, 'recall': 0.5172900148389024, 'f1-score': 0.5100026438727768, 'support': 204193}}
[[29323 24181  9942]
 [13494 51748 11746]
 [15761 23442 24556]]
training model: results/WBA/W4/deepOF_L1/seq2seq
Epoch 1/50
2108/2108 - 50s - loss: 12.4951 - accuracy10: 0.4162 - accuracy20: 0.4379 - accuracy30: 0.4455 - accuracy50: 0.4447 - val_loss: 13.0703 - val_accuracy10: 0.4238 - val_accuracy20: 0.4344 - val_accuracy30: 0.4353 - val_accuracy50: 0.4148 - 50s/epoch - 24ms/step
Epoch 2/50
2108/2108 - 48s - loss: 12.4844 - accuracy10: 0.3791 - accuracy20: 0.4121 - accuracy30: 0.4287 - accuracy50: 0.4337 - val_loss: 13.0071 - val_accuracy10: 0.4633 - val_accuracy20: 0.4694 - val_accuracy30: 0.4655 - val_accuracy50: 0.4285 - 48s/epoch - 23ms/step
Epoch 3/50
2108/2108 - 49s - loss: 12.4095 - accuracy10: 0.3872 - accuracy20: 0.4195 - accuracy30: 0.4357 - accuracy50: 0.4399 - val_loss: 12.9498 - val_accuracy10: 0.4623 - val_accuracy20: 0.4701 - val_accuracy30: 0.4681 - val_accuracy50: 0.4335 - 49s/epoch - 23ms/step
Epoch 4/50
2108/2108 - 47s - loss: 12.3426 - accuracy10: 0.4034 - accuracy20: 0.4315 - accuracy30: 0.4454 - accuracy50: 0.4465 - val_loss: 12.9144 - val_accuracy10: 0.4878 - val_accuracy20: 0.4823 - val_accuracy30: 0.4728 - val_accuracy50: 0.4340 - 47s/epoch - 22ms/step
Epoch 5/50
2108/2108 - 49s - loss: 12.2874 - accuracy10: 0.4178 - accuracy20: 0.4398 - accuracy30: 0.4512 - accuracy50: 0.4513 - val_loss: 12.9070 - val_accuracy10: 0.5117 - val_accuracy20: 0.4940 - val_accuracy30: 0.4784 - val_accuracy50: 0.4377 - 49s/epoch - 23ms/step
Epoch 6/50
2108/2108 - 47s - loss: 12.2342 - accuracy10: 0.4309 - accuracy20: 0.4482 - accuracy30: 0.4571 - accuracy50: 0.4556 - val_loss: 12.9178 - val_accuracy10: 0.5152 - val_accuracy20: 0.4915 - val_accuracy30: 0.4762 - val_accuracy50: 0.4378 - 47s/epoch - 22ms/step
Epoch 7/50
2108/2108 - 48s - loss: 12.1778 - accuracy10: 0.4420 - accuracy20: 0.4564 - accuracy30: 0.4634 - accuracy50: 0.4606 - val_loss: 12.9337 - val_accuracy10: 0.5322 - val_accuracy20: 0.5010 - val_accuracy30: 0.4803 - val_accuracy50: 0.4371 - 48s/epoch - 23ms/step
Epoch 8/50
2108/2108 - 48s - loss: 12.1270 - accuracy10: 0.4477 - accuracy20: 0.4604 - accuracy30: 0.4672 - accuracy50: 0.4646 - val_loss: 12.9758 - val_accuracy10: 0.5454 - val_accuracy20: 0.5074 - val_accuracy30: 0.4837 - val_accuracy50: 0.4360 - 48s/epoch - 23ms/step
Epoch 9/50
2108/2108 - 49s - loss: 12.0696 - accuracy10: 0.4554 - accuracy20: 0.4656 - accuracy30: 0.4712 - accuracy50: 0.4677 - val_loss: 13.0543 - val_accuracy10: 0.5560 - val_accuracy20: 0.5133 - val_accuracy30: 0.4865 - val_accuracy50: 0.4376 - 49s/epoch - 23ms/step
Epoch 10/50
2108/2108 - 48s - loss: 11.9961 - accuracy10: 0.4622 - accuracy20: 0.4723 - accuracy30: 0.4772 - accuracy50: 0.4730 - val_loss: 13.0502 - val_accuracy10: 0.5511 - val_accuracy20: 0.5083 - val_accuracy30: 0.4832 - val_accuracy50: 0.4384 - 48s/epoch - 23ms/step
Epoch 11/50
2108/2108 - 48s - loss: 11.9345 - accuracy10: 0.4672 - accuracy20: 0.4775 - accuracy30: 0.4818 - accuracy50: 0.4767 - val_loss: 13.1255 - val_accuracy10: 0.5501 - val_accuracy20: 0.5058 - val_accuracy30: 0.4815 - val_accuracy50: 0.4380 - 48s/epoch - 23ms/step
Epoch 12/50
2108/2108 - 47s - loss: 11.8718 - accuracy10: 0.4724 - accuracy20: 0.4825 - accuracy30: 0.4858 - accuracy50: 0.4797 - val_loss: 13.3124 - val_accuracy10: 0.5562 - val_accuracy20: 0.5090 - val_accuracy30: 0.4814 - val_accuracy50: 0.4353 - 47s/epoch - 22ms/step
Epoch 13/50
2108/2108 - 47s - loss: 11.8136 - accuracy10: 0.4772 - accuracy20: 0.4877 - accuracy30: 0.4904 - accuracy50: 0.4839 - val_loss: 13.4880 - val_accuracy10: 0.5623 - val_accuracy20: 0.5127 - val_accuracy30: 0.4823 - val_accuracy50: 0.4344 - 47s/epoch - 22ms/step
Epoch 14/50
2108/2108 - 46s - loss: 11.7653 - accuracy10: 0.4817 - accuracy20: 0.4920 - accuracy30: 0.4942 - accuracy50: 0.4870 - val_loss: 13.5389 - val_accuracy10: 0.5693 - val_accuracy20: 0.5154 - val_accuracy30: 0.4826 - val_accuracy50: 0.4322 - 46s/epoch - 22ms/step
Epoch 15/50
2108/2108 - 47s - loss: 11.7368 - accuracy10: 0.4863 - accuracy20: 0.4957 - accuracy30: 0.4968 - accuracy50: 0.4889 - val_loss: 13.4867 - val_accuracy10: 0.5663 - val_accuracy20: 0.5141 - val_accuracy30: 0.4834 - val_accuracy50: 0.4346 - 47s/epoch - 22ms/step
testing model: results/WBA/W4/deepOF_L1/seq2seq
Evaluating performance on  test set...
4676/4676 - 45s - 45s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9801841
{'0': {'precision': 0.30287676174802697, 'recall': 0.4002571244911078, 'f1-score': 0.34482360786467336, 'support': 186680}, '1': {'precision': 0.7410859278925637, 'recall': 0.5541122483278692, 'f1-score': 0.6341034094211154, 'support': 821108}, '2': {'precision': 0.27182990970419724, 'recall': 0.4832370492132539, 'f1-score': 0.34793810509651096, 'support': 189197}, 'accuracy': 0.5189146062816159, 'macro avg': {'precision': 0.43859753311492927, 'recall': 0.4792021406774103, 'f1-score': 0.44228837412743327, 'support': 1196985}, 'weighted avg': {'precision': 0.598572263971089, 'recall': 0.5189146062816159, 'f1-score': 0.543756103116643, 'support': 1196985}}
[[ 74720  82052  29908]
 [151118 454986 215004]
 [ 20863  76907  91427]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0007495
{'0': {'precision': 0.367270179578893, 'recall': 0.39921599749888775, 'f1-score': 0.3825773653248931, 'support': 249489}, '1': {'precision': 0.6395453099239291, 'recall': 0.5404037281814692, 'f1-score': 0.5858094861093361, 'support': 695567}, '2': {'precision': 0.3436640300070403, 'recall': 0.46114976838712496, 'f1-score': 0.39383168667571783, 'support': 251929}, 'accuracy': 0.4942952501493335, 'macro avg': {'precision': 0.45015983983662083, 'recall': 0.4669231646891607, 'f1-score': 0.45407284603664905, 'support': 1196985}, 'weighted avg': {'precision': 0.5205206563461193, 'recall': 0.4942952501493335, 'f1-score': 0.5030440766715387, 'support': 1196985}}
[[ 99600 108298  41591]
 [139394 375887 180286]
 [ 32196 103556 116177]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0183724
{'0': {'precision': 0.4122326781571351, 'recall': 0.36711648744297687, 'f1-score': 0.38836870428346776, 'support': 293302}, '1': {'precision': 0.5618736910203588, 'recall': 0.5650111135022893, 'f1-score': 0.5634380347253565, 'support': 608719}, '2': {'precision': 0.38922033584107024, 'recall': 0.427092797765151, 'f1-score': 0.40727802931967305, 'support': 294964}, 'accuracy': 0.4825340334256486, 'macro avg': {'precision': 0.454442235006188, 'recall': 0.4530734662368057, 'f1-score': 0.45302825610949915, 'support': 1196985}, 'weighted avg': {'precision': 0.4826608916854357, 'recall': 0.4825340334256486, 'f1-score': 0.4820587654849325, 'support': 1196985}}
[[107676 136961  48665]
 [115763 343933 149023]
 [ 37763 131224 125977]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0454435
{'0': {'precision': 0.4689252579104064, 'recall': 0.3061542764635583, 'f1-score': 0.37044836480427734, 'support': 353949}, '1': {'precision': 0.44913528633301253, 'recall': 0.6115058272385523, 'f1-score': 0.5178921339118191, 'support': 488396}, '2': {'precision': 0.4422221262257549, 'recall': 0.3752565982404692, 'f1-score': 0.4059965496043943, 'support': 354640}, 'accuracy': 0.45121785151860716, 'macro avg': {'precision': 0.4534275568230579, 'recall': 0.43097223398085993, 'f1-score': 0.43144568277349693, 'support': 1196985}, 'weighted avg': {'precision': 0.4529389743904311, 'recall': 0.45121785151860716, 'f1-score': 0.4411407755818229, 'support': 1196985}}
[[108363 187391  58195]
 [ 80078 298657 109661]
 [ 42647 178912 133081]]
Evaluating performance on  train set...
2108/2108 - 20s - 20s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9763147
{'0': {'precision': 0.32098951218947513, 'recall': 0.3219435736677116, 'f1-score': 0.3214658350529806, 'support': 86130}, '1': {'precision': 0.7340169409913667, 'recall': 0.5886499171953564, 'f1-score': 0.6533451849347836, 'support': 367733}, '2': {'precision': 0.27280776649906713, 'recall': 0.5042434302814925, 'f1-score': 0.35406038767293635, 'support': 85544}, 'accuracy': 0.5326775514592877, 'macro avg': {'precision': 0.442604739893303, 'recall': 0.4716123070481868, 'f1-score': 0.4429571358869002, 'support': 539407}, 'weighted avg': {'precision': 0.5949239554248534, 'recall': 0.5326775514592877, 'f1-score': 0.5528889670839081, 'support': 539407}}
[[ 27729  43766  14635]
 [ 50922 216466 100345]
 [  7735  34674  43135]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.99796337
{'0': {'precision': 0.3905115759632318, 'recall': 0.31980512342476236, 'f1-score': 0.3516392134869487, 'support': 113713}, '1': {'precision': 0.63764572628322, 'recall': 0.5905141398862157, 'f1-score': 0.6131755775128221, 'support': 312697}, '2': {'precision': 0.3448713776093019, 'recall': 0.4782516349991593, 'f1-score': 0.4007549240626483, 'support': 112997}, 'accuracy': 0.5099284955515965, 'macro avg': {'precision': 0.4576762266185846, 'recall': 0.46285696610337906, 'f1-score': 0.45518990502080636, 'support': 539407}, 'weighted avg': {'precision': 0.5242156285788084, 'recall': 0.5099284955515965, 'f1-score': 0.5135421260737725, 'support': 539407}}
[[ 36366  57436  19911]
 [ 45298 184652  82747]
 [ 11460  47496  54041]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0163813
{'0': {'precision': 0.4327460003882564, 'recall': 0.28614360035337555, 'f1-score': 0.34449656376131776, 'support': 132437}, '1': {'precision': 0.5631666694178042, 'recall': 0.6193128185765527, 'f1-score': 0.5899067863867664, 'support': 275444}, '2': {'precision': 0.389583095527459, 'recall': 0.44113711357450236, 'f1-score': 0.4137603982072117, 'support': 131526}, 'accuracy': 0.4940666324315406, 'macro avg': {'precision': 0.4618319217778399, 'recall': 0.4488645108348102, 'f1-score': 0.449387916118432, 'support': 539407}, 'weighted avg': {'precision': 0.48881970083236176, 'recall': 0.4940666324315406, 'f1-score': 0.48670229792897735, 'support': 539407}}
[[ 37896  71644  22897]
 [ 36845 170586  68013]
 [ 12830  60675  58021]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0448083
{'0': {'precision': 0.48486776695168027, 'recall': 0.2298483639265762, 'f1-score': 0.31186105403170106, 'support': 159131}, '1': {'precision': 0.45309767042930876, 'recall': 0.6642864520880769, 'f1-score': 0.5387344206408752, 'support': 222669}, '2': {'precision': 0.4414290596798941, 'recall': 0.38516055758944717, 'f1-score': 0.4113796234802998, 'support': 157607}, 'accuracy': 0.45456584731010163, 'macro avg': {'precision': 0.459798165686961, 'recall': 0.4264317912013668, 'f1-score': 0.4206583660509587, 'support': 539407}, 'weighted avg': {'precision': 0.45906079752131634, 'recall': 0.45456584731010163, 'f1-score': 0.4345930334917071, 'support': 539407}}
[[ 36576  95505  27050]
 [ 24990 147916  49763]
 [ 13869  83034  60704]]
Evaluating performance on  val set...
798/798 - 7s - 7s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9877962
{'0': {'precision': 0.327112036740361, 'recall': 0.3408547103667019, 'f1-score': 0.33384200343352316, 'support': 35942}, '1': {'precision': 0.7018841394825647, 'recall': 0.562921475021614, 'f1-score': 0.6247689772419116, 'support': 133015}, '2': {'precision': 0.28730790363130815, 'recall': 0.4897264161652855, 'f1-score': 0.3621520089824444, 'support': 35236}, 'accuracy': 0.5112026367211413, 'macro avg': {'precision': 0.43876802661807796, 'recall': 0.4645008671845338, 'f1-score': 0.44025432988595975, 'support': 204193}, 'weighted avg': {'precision': 0.5643766482207919, 'recall': 0.5112026367211412, 'f1-score': 0.5282423147891747, 'support': 204193}}
[[12251 17465  6226]
 [21559 74877 36579]
 [ 3642 14338 17256]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0074722
{'0': {'precision': 0.39579795726993944, 'recall': 0.33543827995790104, 'f1-score': 0.36312693282488895, 'support': 46557}, '1': {'precision': 0.6023474624596085, 'recall': 0.5681769283178542, 'f1-score': 0.5847634337171538, 'support': 111548}, '2': {'precision': 0.36356609987230326, 'recall': 0.46949314355146676, 'f1-score': 0.4097950835195637, 'support': 46088}, 'accuracy': 0.49283765848976213, 'macro avg': {'precision': 0.45390383986728366, 'recall': 0.45770278394240727, 'f1-score': 0.45256181668720213, 'support': 204193}, 'weighted avg': {'precision': 0.5013582965624467, 'recall': 0.4928376584897621, 'f1-score': 0.49473746859617657, 'support': 204193}}
[[15617 22642  8298]
 [18589 63379 29580]
 [ 5251 19199 21638]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0243471
{'0': {'precision': 0.44129098085546276, 'recall': 0.3062403339109695, 'f1-score': 0.3615663843361567, 'support': 53667}, '1': {'precision': 0.5269826585401248, 'recall': 0.5984385782410316, 'f1-score': 0.5604421573497567, 'support': 97091}, '2': {'precision': 0.4096906198186757, 'recall': 0.4346776457378123, 'f1-score': 0.42181441763749783, 'support': 53435}, 'accuracy': 0.478787225810875, 'macro avg': {'precision': 0.45932141973808777, 'recall': 0.44645218596327113, 'f1-score': 0.44794098644113706, 'support': 204193}, 'weighted avg': {'precision': 0.4737667532182803, 'recall': 0.478787225810875, 'f1-score': 0.47189534437455466, 'support': 204193}}
[[16435 27823  9409]
 [14930 58103 24058]
 [ 5878 24330 23227]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0534155
{'0': {'precision': 0.49027641878669276, 'recall': 0.25246417886946937, 'f1-score': 0.3332986883405742, 'support': 63510}, '1': {'precision': 0.41436724127787256, 'recall': 0.6404390750844375, 'f1-score': 0.5031766849187841, 'support': 76980}, '2': {'precision': 0.45821748238430776, 'recall': 0.3777059165188453, 'f1-score': 0.41408448280312876, 'support': 63703}, 'accuracy': 0.43780149172596516, 'macro avg': {'precision': 0.4542870474829577, 'recall': 0.4235363901575841, 'f1-score': 0.4168532853541624, 'support': 204193}, 'weighted avg': {'precision': 0.4516573725399061, 'recall': 0.43780149172596516, 'f1-score': 0.4225451641807779, 'support': 204193}}
[[16034 36489 10987]
 [10217 49301 17462]
 [ 6453 33189 24061]]
training model: results/WBA/W4/deepLOB_L2/seq2seq
Epoch 1/50
2108/2108 - 108s - loss: 11.1121 - accuracy10: 0.5313 - accuracy20: 0.5414 - accuracy30: 0.5392 - accuracy50: 0.5237 - val_loss: 11.8392 - val_accuracy10: 0.4790 - val_accuracy20: 0.5017 - val_accuracy30: 0.5081 - val_accuracy50: 0.5003 - 108s/epoch - 51ms/step
Epoch 2/50
2108/2108 - 99s - loss: 10.2417 - accuracy10: 0.6102 - accuracy20: 0.6081 - accuracy30: 0.5938 - accuracy50: 0.5622 - val_loss: 11.4004 - val_accuracy10: 0.5349 - val_accuracy20: 0.5513 - val_accuracy30: 0.5503 - val_accuracy50: 0.5311 - 99s/epoch - 47ms/step
Epoch 3/50
2108/2108 - 102s - loss: 10.0098 - accuracy10: 0.6259 - accuracy20: 0.6213 - accuracy30: 0.6046 - accuracy50: 0.5697 - val_loss: 11.4215 - val_accuracy10: 0.5275 - val_accuracy20: 0.5447 - val_accuracy30: 0.5439 - val_accuracy50: 0.5270 - 102s/epoch - 48ms/step
Epoch 4/50
2108/2108 - 100s - loss: 9.9024 - accuracy10: 0.6320 - accuracy20: 0.6271 - accuracy30: 0.6098 - accuracy50: 0.5730 - val_loss: 11.3754 - val_accuracy10: 0.5378 - val_accuracy20: 0.5514 - val_accuracy30: 0.5472 - val_accuracy50: 0.5269 - 100s/epoch - 47ms/step
Epoch 5/50
2108/2108 - 98s - loss: 9.8299 - accuracy10: 0.6346 - accuracy20: 0.6299 - accuracy30: 0.6125 - accuracy50: 0.5754 - val_loss: 11.3397 - val_accuracy10: 0.5497 - val_accuracy20: 0.5608 - val_accuracy30: 0.5542 - val_accuracy50: 0.5312 - 98s/epoch - 47ms/step
Epoch 6/50
2108/2108 - 99s - loss: 9.7721 - accuracy10: 0.6377 - accuracy20: 0.6323 - accuracy30: 0.6147 - accuracy50: 0.5770 - val_loss: 11.1484 - val_accuracy10: 0.5790 - val_accuracy20: 0.5826 - val_accuracy30: 0.5699 - val_accuracy50: 0.5374 - 99s/epoch - 47ms/step
Epoch 7/50
2108/2108 - 102s - loss: 9.7284 - accuracy10: 0.6390 - accuracy20: 0.6337 - accuracy30: 0.6159 - accuracy50: 0.5779 - val_loss: 11.1156 - val_accuracy10: 0.5664 - val_accuracy20: 0.5719 - val_accuracy30: 0.5619 - val_accuracy50: 0.5339 - 102s/epoch - 49ms/step
Epoch 8/50
2108/2108 - 101s - loss: 9.6922 - accuracy10: 0.6402 - accuracy20: 0.6355 - accuracy30: 0.6174 - accuracy50: 0.5797 - val_loss: 11.2857 - val_accuracy10: 0.5525 - val_accuracy20: 0.5621 - val_accuracy30: 0.5553 - val_accuracy50: 0.5296 - 101s/epoch - 48ms/step
Epoch 9/50
2108/2108 - 99s - loss: 9.6571 - accuracy10: 0.6421 - accuracy20: 0.6369 - accuracy30: 0.6187 - accuracy50: 0.5807 - val_loss: 11.2724 - val_accuracy10: 0.5712 - val_accuracy20: 0.5741 - val_accuracy30: 0.5625 - val_accuracy50: 0.5316 - 99s/epoch - 47ms/step
Epoch 10/50
2108/2108 - 99s - loss: 9.6277 - accuracy10: 0.6438 - accuracy20: 0.6382 - accuracy30: 0.6197 - accuracy50: 0.5818 - val_loss: 11.4536 - val_accuracy10: 0.5610 - val_accuracy20: 0.5666 - val_accuracy30: 0.5572 - val_accuracy50: 0.5290 - 99s/epoch - 47ms/step
Epoch 11/50
2108/2108 - 101s - loss: 9.5992 - accuracy10: 0.6451 - accuracy20: 0.6393 - accuracy30: 0.6207 - accuracy50: 0.5827 - val_loss: 11.4150 - val_accuracy10: 0.5718 - val_accuracy20: 0.5744 - val_accuracy30: 0.5625 - val_accuracy50: 0.5312 - 101s/epoch - 48ms/step
Epoch 12/50
2108/2108 - 99s - loss: 9.5716 - accuracy10: 0.6449 - accuracy20: 0.6395 - accuracy30: 0.6214 - accuracy50: 0.5834 - val_loss: 11.4260 - val_accuracy10: 0.5871 - val_accuracy20: 0.5854 - val_accuracy30: 0.5705 - val_accuracy50: 0.5347 - 99s/epoch - 47ms/step
Epoch 13/50
2108/2108 - 98s - loss: 9.5489 - accuracy10: 0.6465 - accuracy20: 0.6409 - accuracy30: 0.6224 - accuracy50: 0.5846 - val_loss: 11.4279 - val_accuracy10: 0.5821 - val_accuracy20: 0.5807 - val_accuracy30: 0.5665 - val_accuracy50: 0.5319 - 98s/epoch - 47ms/step
Epoch 14/50
2108/2108 - 99s - loss: 9.5267 - accuracy10: 0.6474 - accuracy20: 0.6420 - accuracy30: 0.6234 - accuracy50: 0.5853 - val_loss: 11.3324 - val_accuracy10: 0.5702 - val_accuracy20: 0.5737 - val_accuracy30: 0.5625 - val_accuracy50: 0.5317 - 99s/epoch - 47ms/step
Epoch 15/50
2108/2108 - 100s - loss: 9.5048 - accuracy10: 0.6479 - accuracy20: 0.6422 - accuracy30: 0.6237 - accuracy50: 0.5857 - val_loss: 11.5927 - val_accuracy10: 0.5712 - val_accuracy20: 0.5727 - val_accuracy30: 0.5603 - val_accuracy50: 0.5295 - 100s/epoch - 48ms/step
Epoch 16/50
2108/2108 - 98s - loss: 9.4861 - accuracy10: 0.6483 - accuracy20: 0.6430 - accuracy30: 0.6248 - accuracy50: 0.5871 - val_loss: 11.5849 - val_accuracy10: 0.5868 - val_accuracy20: 0.5853 - val_accuracy30: 0.5712 - val_accuracy50: 0.5344 - 98s/epoch - 47ms/step
Epoch 17/50
2108/2108 - 98s - loss: 9.4677 - accuracy10: 0.6490 - accuracy20: 0.6439 - accuracy30: 0.6254 - accuracy50: 0.5879 - val_loss: 11.7442 - val_accuracy10: 0.5742 - val_accuracy20: 0.5751 - val_accuracy30: 0.5619 - val_accuracy50: 0.5286 - 98s/epoch - 47ms/step
testing model: results/WBA/W4/deepLOB_L2/seq2seq
Evaluating performance on  test set...
4676/4676 - 72s - 72s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7809995
{'0': {'precision': 0.3433054689368098, 'recall': 0.7537015213199058, 'f1-score': 0.4717378403478832, 'support': 186680}, '1': {'precision': 0.8441324484660736, 'recall': 0.671674109834115, 'f1-score': 0.7480927006165617, 'support': 821111}, '2': {'precision': 0.5071043642696444, 'recall': 0.35859787101343565, 'f1-score': 0.42011337847418956, 'support': 189198}, 'accuracy': 0.6349816080181188, 'macro avg': {'precision': 0.564847427224176, 'recall': 0.5946578340558188, 'f1-score': 0.5466479731462115, 'support': 1196989}, 'weighted avg': {'precision': 0.7127532795578222, 'recall': 0.6349816080181188, 'f1-score': 0.6531520143565798, 'support': 1196989}}
[[140701  33382  12597]
 [216244 551519  53348]
 [ 52897  68455  67846]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8254754
{'0': {'precision': 0.41777465278920906, 'recall': 0.7120749362705017, 'f1-score': 0.5265955081824353, 'support': 249492}, '1': {'precision': 0.7574137455235219, 'recall': 0.6865808757459742, 'f1-score': 0.7202600134983805, 'support': 695567}, '2': {'precision': 0.5781412639405205, 'recall': 0.3240900250069464, 'f1-score': 0.4153476364283807, 'support': 251930}, 'accuracy': 0.6156013129611049, 'macro avg': {'precision': 0.5844432207510838, 'recall': 0.5742486123411408, 'f1-score': 0.5540677193697322, 'support': 1196989}, 'weighted avg': {'precision': 0.6488903148072206, 'recall': 0.6156013129611049, 'f1-score': 0.615719103000848, 'support': 1196989}}
[[177657  55013  16822]
 [175249 477563  42755]
 [ 72340  97942  81648]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.87033933
{'0': {'precision': 0.45234727737583635, 'recall': 0.6804248137604201, 'f1-score': 0.5434249561264376, 'support': 293305}, '1': {'precision': 0.682911516258439, 'recall': 0.6879611117773554, 'f1-score': 0.6854270139507783, 'support': 608719}, '2': {'precision': 0.6011418391465664, 'recall': 0.29057345786788263, 'f1-score': 0.3917749610323123, 'support': 294965}, 'accuracy': 0.5881891980628059, 'macro avg': {'precision': 0.5788002109269473, 'recall': 0.5529864611352194, 'f1-score': 0.5402089770365094, 'support': 1196989}, 'weighted avg': {'precision': 0.6062651670482414, 'recall': 0.5881891980628059, 'f1-score': 0.5782689771106206, 'support': 1196989}}
[[199572  73698  20035]
 [153111 418775  36833]
 [ 88509 120747  85709]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9449877
{'0': {'precision': 0.4813632393499615, 'recall': 0.6321609488319004, 'f1-score': 0.5465512924638336, 'support': 353951}, '1': {'precision': 0.562714286684183, 'recall': 0.6788159608186799, 'f1-score': 0.615336500983704, 'support': 488396}, '2': {'precision': 0.6043247477113944, 'recall': 0.2436626231523621, 'f1-score': 0.3472960997361509, 'support': 354642}, 'accuracy': 0.5360934812266446, 'macro avg': {'precision': 0.5494674245818463, 'recall': 0.5182131776009808, 'f1-score': 0.5030612977278962, 'support': 1196989}, 'weighted avg': {'precision': 0.5509869713660116, 'recall': 0.5360934812266446, 'f1-score': 0.5155820526804603, 'support': 1196989}}
[[223754 103980  26217]
 [126504 331531  30361]
 [114576 153653  86413]]
Evaluating performance on  train set...
2108/2108 - 36s - 36s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.85464585
{'0': {'precision': 0.3355172188394065, 'recall': 0.7748168274869079, 'f1-score': 0.46826338060785533, 'support': 86121}, '1': {'precision': 0.9019229764785766, 'recall': 0.5635329215924636, 'f1-score': 0.6936589366563173, 'support': 367707}, '2': {'precision': 0.42448095324065716, 'recall': 0.5494677556934366, 'f1-score': 0.47895457855684176, 'support': 85581}, 'accuracy': 0.5950345656079153, 'macro avg': {'precision': 0.5539737161862134, 'recall': 0.6292725015909361, 'f1-score': 0.5469589652736714, 'support': 539409}, 'weighted avg': {'precision': 0.7357422193084749, 'recall': 0.5950345656079153, 'f1-score': 0.6236083732564467, 'support': 539409}}
[[ 66728   8939  10454]
 [107190 207215  53302]
 [ 24963  13594  47024]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8592277
{'0': {'precision': 0.4070665993845667, 'recall': 0.7235363430119063, 'f1-score': 0.5210095739830809, 'support': 113722}, '1': {'precision': 0.8312538192829325, 'recall': 0.5829700677704822, 'f1-score': 0.6853173670705228, 'support': 312673}, '2': {'precision': 0.4905206241048198, 'recall': 0.5121312403772984, 'f1-score': 0.5010930404706351, 'support': 113014}, 'accuracy': 0.5977634781770419, 'macro avg': {'precision': 0.5762803475907731, 'recall': 0.6062125503865623, 'f1-score': 0.5691399938414129, 'support': 539409}, 'weighted avg': {'precision': 0.6704351448797594, 'recall': 0.5977634781770419, 'f1-score': 0.612079176955323, 'support': 539409}}
[[ 82282  15454  15986]
 [ 86265 182279  44129]
 [ 33587  21549  57878]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.88173157
{'0': {'precision': 0.4408688928623206, 'recall': 0.6888742902017639, 'f1-score': 0.5376500609968117, 'support': 132432}, '1': {'precision': 0.7653384532445546, 'recall': 0.5879788408998431, 'f1-score': 0.665036674816626, 'support': 275248}, '2': {'precision': 0.5195303139228373, 'recall': 0.47728290657334377, 'f1-score': 0.4975113354909673, 'support': 131729}, 'accuracy': 0.5857169605994709, 'macro avg': {'precision': 0.5752458866765708, 'recall': 0.5847120125583168, 'f1-score': 0.5667326904348017, 'support': 539409}, 'weighted avg': {'precision': 0.6256481380936201, 'recall': 0.5857169605994709, 'f1-score': 0.5928502458445188, 'support': 539409}}
[[ 91229  21259  19944]
 [ 75207 161840  38201]
 [ 40494  28363  62872]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.92578804
{'0': {'precision': 0.47386002071417244, 'recall': 0.6383272896385724, 'f1-score': 0.5439331664279116, 'support': 159119}, '1': {'precision': 0.6467030986972341, 'recall': 0.5883261702347431, 'f1-score': 0.6161349644199249, 'support': 222669}, '2': {'precision': 0.5407040344833216, 'recall': 0.4202041606131163, 'f1-score': 0.4728986309194438, 'support': 157621}, 'accuracy': 0.5539488588436604, 'macro avg': {'precision': 0.5537557179649094, 'recall': 0.5489525401621439, 'f1-score': 0.5443222539224267, 'support': 539409}, 'weighted avg': {'precision': 0.5647424784145767, 'recall': 0.5539488588436604, 'f1-score': 0.5529811571653732, 'support': 539409}}
[[101570  31705  25844]
 [ 61250 131002  30417]
 [ 51526  39862  66233]]
Evaluating performance on  val set...
798/798 - 13s - 13s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.925565
{'0': {'precision': 0.33532282282282283, 'recall': 0.746365509942628, 'f1-score': 0.4627458429022845, 'support': 35906}, '1': {'precision': 0.889558078870646, 'recall': 0.5226946571194578, 'f1-score': 0.6584759840414204, 'support': 133093}, '2': {'precision': 0.4198484881373592, 'recall': 0.5495823151673581, 'f1-score': 0.47603460369417816, 'support': 35194}, 'accuracy': 0.5666599736523779, 'macro avg': {'precision': 0.5482431299436094, 'recall': 0.606214160743148, 'f1-score': 0.5324188102126276, 'support': 204193}, 'weighted avg': {'precision': 0.7111419214121609, 'recall': 0.5666599736523779, 'f1-score': 0.592613156286881, 'support': 204193}}
[[26799  3831  5276]
 [42075 69567 21451]
 [11046  4806 19342]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9232999
{'0': {'precision': 0.40343479922575237, 'recall': 0.7027984794141019, 'f1-score': 0.5126104392505796, 'support': 46561}, '1': {'precision': 0.8105627262816458, 'recall': 0.5397141192812654, 'f1-score': 0.647974005293624, 'support': 111585}, '2': {'precision': 0.48994526781870734, 'recall': 0.5190566160661932, 'f1-score': 0.5040809870294211, 'support': 46047}, 'accuracy': 0.5722429270347171, 'macro avg': {'precision': 0.5679809311087018, 'recall': 0.5871897382538536, 'f1-score': 0.5548884771912083, 'support': 204193}, 'weighted avg': {'precision': 0.6454260393164101, 'recall': 0.5722429270347171, 'f1-score': 0.5846588827843218, 'support': 204193}}
[[32723  6229  7609]
 [34088 60224 17273]
 [14300  7846 23901]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9381465
{'0': {'precision': 0.435685148084675, 'recall': 0.6734069541859424, 'f1-score': 0.529069511819794, 'support': 53608}, '1': {'precision': 0.7372269931774562, 'recall': 0.541577474065536, 'f1-score': 0.6244356240618455, 'support': 97168}, '2': {'precision': 0.5205589142010649, 'recall': 0.48681131474998596, 'f1-score': 0.5031198305133934, 'support': 53417}, 'accuracy': 0.5618605926745774, 'macro avg': {'precision': 0.5644903518210654, 'recall': 0.5672652476671548, 'f1-score': 0.5522083221316776, 'support': 204193}, 'weighted avg': {'precision': 0.6013809357395631, 'recall': 0.5618605926745774, 'f1-score': 0.5676623150402357, 'support': 204193}}
[[36100  8323  9185]
 [29779 52624 14765]
 [16979 10434 26004]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.96391314
{'0': {'precision': 0.46565223986837345, 'recall': 0.6289600605239101, 'f1-score': 0.5351240085019076, 'support': 63446}, '1': {'precision': 0.6114712555617763, 'recall': 0.5390840130929495, 'f1-score': 0.5730005108309978, 'support': 76988}, '2': {'precision': 0.5421358302714235, 'recall': 0.4304333505857997, 'f1-score': 0.47986990846381833, 'support': 63759}, 'accuracy': 0.5330838961178884, 'macro avg': {'precision': 0.539753108567191, 'recall': 0.5328258080675531, 'f1-score': 0.5293314759322412, 'support': 204193}, 'weighted avg': {'precision': 0.5445130804491561, 'recall': 0.5330838961178884, 'f1-score': 0.5321517714368929, 'support': 204193}}
[[39905 11933 11608]
 [23915 41503 11570]
 [21877 14438 27444]]
training model: results/WBA/W4/deepOF_L2/seq2seq
Epoch 1/50
2108/2108 - 66s - loss: 10.9085 - accuracy10: 0.5719 - accuracy20: 0.5782 - accuracy30: 0.5670 - accuracy50: 0.5374 - val_loss: 11.6657 - val_accuracy10: 0.6493 - val_accuracy20: 0.6215 - val_accuracy30: 0.5881 - val_accuracy50: 0.5267 - 66s/epoch - 31ms/step
Epoch 2/50
2108/2108 - 58s - loss: 10.1425 - accuracy10: 0.6172 - accuracy20: 0.6156 - accuracy30: 0.5991 - accuracy50: 0.5644 - val_loss: 11.6956 - val_accuracy10: 0.6352 - val_accuracy20: 0.6182 - val_accuracy30: 0.5897 - val_accuracy50: 0.5329 - 58s/epoch - 28ms/step
Epoch 3/50
2108/2108 - 61s - loss: 9.9958 - accuracy10: 0.6233 - accuracy20: 0.6216 - accuracy30: 0.6046 - accuracy50: 0.5696 - val_loss: 11.5325 - val_accuracy10: 0.6232 - val_accuracy20: 0.6117 - val_accuracy30: 0.5870 - val_accuracy50: 0.5341 - 61s/epoch - 29ms/step
Epoch 4/50
2108/2108 - 61s - loss: 9.9080 - accuracy10: 0.6277 - accuracy20: 0.6257 - accuracy30: 0.6083 - accuracy50: 0.5722 - val_loss: 11.4539 - val_accuracy10: 0.6292 - val_accuracy20: 0.6160 - val_accuracy30: 0.5914 - val_accuracy50: 0.5369 - 61s/epoch - 29ms/step
Epoch 5/50
2108/2108 - 61s - loss: 9.8456 - accuracy10: 0.6299 - accuracy20: 0.6276 - accuracy30: 0.6100 - accuracy50: 0.5751 - val_loss: 11.3755 - val_accuracy10: 0.6303 - val_accuracy20: 0.6175 - val_accuracy30: 0.5921 - val_accuracy50: 0.5394 - 61s/epoch - 29ms/step
Epoch 6/50
2108/2108 - 59s - loss: 9.7987 - accuracy10: 0.6328 - accuracy20: 0.6305 - accuracy30: 0.6128 - accuracy50: 0.5772 - val_loss: 11.4942 - val_accuracy10: 0.6248 - val_accuracy20: 0.6138 - val_accuracy30: 0.5897 - val_accuracy50: 0.5372 - 59s/epoch - 28ms/step
Epoch 7/50
2108/2108 - 58s - loss: 9.7581 - accuracy10: 0.6341 - accuracy20: 0.6324 - accuracy30: 0.6142 - accuracy50: 0.5780 - val_loss: 11.3899 - val_accuracy10: 0.6247 - val_accuracy20: 0.6158 - val_accuracy30: 0.5924 - val_accuracy50: 0.5415 - 58s/epoch - 28ms/step
Epoch 8/50
2108/2108 - 60s - loss: 9.7237 - accuracy10: 0.6352 - accuracy20: 0.6333 - accuracy30: 0.6150 - accuracy50: 0.5792 - val_loss: 11.2859 - val_accuracy10: 0.6334 - val_accuracy20: 0.6209 - val_accuracy30: 0.5954 - val_accuracy50: 0.5415 - 60s/epoch - 29ms/step
Epoch 9/50
2108/2108 - 58s - loss: 9.6944 - accuracy10: 0.6368 - accuracy20: 0.6359 - accuracy30: 0.6171 - accuracy50: 0.5805 - val_loss: 11.3313 - val_accuracy10: 0.6235 - val_accuracy20: 0.6141 - val_accuracy30: 0.5914 - val_accuracy50: 0.5417 - 58s/epoch - 28ms/step
Epoch 10/50
2108/2108 - 60s - loss: 9.6664 - accuracy10: 0.6371 - accuracy20: 0.6360 - accuracy30: 0.6177 - accuracy50: 0.5816 - val_loss: 11.2709 - val_accuracy10: 0.6130 - val_accuracy20: 0.6089 - val_accuracy30: 0.5892 - val_accuracy50: 0.5429 - 60s/epoch - 28ms/step
Epoch 11/50
2108/2108 - 64s - loss: 9.6398 - accuracy10: 0.6379 - accuracy20: 0.6371 - accuracy30: 0.6184 - accuracy50: 0.5823 - val_loss: 11.3176 - val_accuracy10: 0.6280 - val_accuracy20: 0.6178 - val_accuracy30: 0.5934 - val_accuracy50: 0.5427 - 64s/epoch - 30ms/step
Epoch 12/50
2108/2108 - 60s - loss: 9.6154 - accuracy10: 0.6386 - accuracy20: 0.6383 - accuracy30: 0.6193 - accuracy50: 0.5832 - val_loss: 11.3122 - val_accuracy10: 0.6232 - val_accuracy20: 0.6142 - val_accuracy30: 0.5907 - val_accuracy50: 0.5421 - 60s/epoch - 29ms/step
Epoch 13/50
2108/2108 - 59s - loss: 9.5915 - accuracy10: 0.6401 - accuracy20: 0.6391 - accuracy30: 0.6201 - accuracy50: 0.5835 - val_loss: 11.2404 - val_accuracy10: 0.6273 - val_accuracy20: 0.6172 - val_accuracy30: 0.5946 - val_accuracy50: 0.5449 - 59s/epoch - 28ms/step
Epoch 14/50
2108/2108 - 59s - loss: 9.5700 - accuracy10: 0.6409 - accuracy20: 0.6399 - accuracy30: 0.6210 - accuracy50: 0.5852 - val_loss: 11.2304 - val_accuracy10: 0.6198 - val_accuracy20: 0.6122 - val_accuracy30: 0.5911 - val_accuracy50: 0.5441 - 59s/epoch - 28ms/step
Epoch 15/50
2108/2108 - 59s - loss: 9.5485 - accuracy10: 0.6413 - accuracy20: 0.6411 - accuracy30: 0.6221 - accuracy50: 0.5858 - val_loss: 11.1861 - val_accuracy10: 0.6184 - val_accuracy20: 0.6110 - val_accuracy30: 0.5895 - val_accuracy50: 0.5436 - 59s/epoch - 28ms/step
Epoch 16/50
2108/2108 - 58s - loss: 9.5292 - accuracy10: 0.6414 - accuracy20: 0.6413 - accuracy30: 0.6223 - accuracy50: 0.5865 - val_loss: 11.2080 - val_accuracy10: 0.6229 - val_accuracy20: 0.6139 - val_accuracy30: 0.5908 - val_accuracy50: 0.5427 - 58s/epoch - 28ms/step
Epoch 17/50
2108/2108 - 61s - loss: 9.5116 - accuracy10: 0.6430 - accuracy20: 0.6423 - accuracy30: 0.6237 - accuracy50: 0.5870 - val_loss: 11.0807 - val_accuracy10: 0.6374 - val_accuracy20: 0.6245 - val_accuracy30: 0.5989 - val_accuracy50: 0.5469 - 61s/epoch - 29ms/step
Epoch 18/50
2108/2108 - 60s - loss: 9.4934 - accuracy10: 0.6432 - accuracy20: 0.6429 - accuracy30: 0.6240 - accuracy50: 0.5879 - val_loss: 11.1400 - val_accuracy10: 0.6402 - val_accuracy20: 0.6260 - val_accuracy30: 0.5991 - val_accuracy50: 0.5460 - 60s/epoch - 29ms/step
Epoch 19/50
2108/2108 - 61s - loss: 9.4739 - accuracy10: 0.6433 - accuracy20: 0.6433 - accuracy30: 0.6247 - accuracy50: 0.5893 - val_loss: 11.2326 - val_accuracy10: 0.6303 - val_accuracy20: 0.6190 - val_accuracy30: 0.5939 - val_accuracy50: 0.5443 - 61s/epoch - 29ms/step
Epoch 20/50
2108/2108 - 59s - loss: 9.4529 - accuracy10: 0.6439 - accuracy20: 0.6439 - accuracy30: 0.6251 - accuracy50: 0.5894 - val_loss: 11.2154 - val_accuracy10: 0.6323 - val_accuracy20: 0.6213 - val_accuracy30: 0.5968 - val_accuracy50: 0.5455 - 59s/epoch - 28ms/step
Epoch 21/50
2108/2108 - 61s - loss: 9.4395 - accuracy10: 0.6449 - accuracy20: 0.6450 - accuracy30: 0.6262 - accuracy50: 0.5903 - val_loss: 11.2602 - val_accuracy10: 0.6386 - val_accuracy20: 0.6254 - val_accuracy30: 0.5986 - val_accuracy50: 0.5457 - 61s/epoch - 29ms/step
Epoch 22/50
2108/2108 - 59s - loss: 9.4219 - accuracy10: 0.6452 - accuracy20: 0.6452 - accuracy30: 0.6267 - accuracy50: 0.5911 - val_loss: 11.2166 - val_accuracy10: 0.6342 - val_accuracy20: 0.6213 - val_accuracy30: 0.5955 - val_accuracy50: 0.5450 - 59s/epoch - 28ms/step
Epoch 23/50
2108/2108 - 59s - loss: 9.4026 - accuracy10: 0.6458 - accuracy20: 0.6456 - accuracy30: 0.6274 - accuracy50: 0.5920 - val_loss: 11.1866 - val_accuracy10: 0.6234 - val_accuracy20: 0.6142 - val_accuracy30: 0.5906 - val_accuracy50: 0.5442 - 59s/epoch - 28ms/step
Epoch 24/50
2108/2108 - 62s - loss: 9.3805 - accuracy10: 0.6470 - accuracy20: 0.6469 - accuracy30: 0.6283 - accuracy50: 0.5929 - val_loss: 11.2420 - val_accuracy10: 0.6251 - val_accuracy20: 0.6137 - val_accuracy30: 0.5896 - val_accuracy50: 0.5427 - 62s/epoch - 29ms/step
Epoch 25/50
2108/2108 - 59s - loss: 9.3706 - accuracy10: 0.6466 - accuracy20: 0.6470 - accuracy30: 0.6289 - accuracy50: 0.5937 - val_loss: 11.2593 - val_accuracy10: 0.6259 - val_accuracy20: 0.6147 - val_accuracy30: 0.5902 - val_accuracy50: 0.5426 - 59s/epoch - 28ms/step
Epoch 26/50
2108/2108 - 58s - loss: 9.3512 - accuracy10: 0.6474 - accuracy20: 0.6478 - accuracy30: 0.6296 - accuracy50: 0.5937 - val_loss: 11.2560 - val_accuracy10: 0.6283 - val_accuracy20: 0.6160 - val_accuracy30: 0.5905 - val_accuracy50: 0.5425 - 58s/epoch - 28ms/step
Epoch 27/50
2108/2108 - 58s - loss: 9.3324 - accuracy10: 0.6476 - accuracy20: 0.6485 - accuracy30: 0.6307 - accuracy50: 0.5954 - val_loss: 11.1737 - val_accuracy10: 0.6282 - val_accuracy20: 0.6159 - val_accuracy30: 0.5915 - val_accuracy50: 0.5437 - 58s/epoch - 28ms/step
testing model: results/WBA/W4/deepOF_L2/seq2seq
Evaluating performance on  test set...
4676/4676 - 45s - 45s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.87567085
{'0': {'precision': 0.39031711124913965, 'recall': 0.6227448039425755, 'f1-score': 0.4798679118724524, 'support': 186680}, '1': {'precision': 0.862179676096235, 'recall': 0.6056913341484921, 'f1-score': 0.7115267685590145, 'support': 821108}, '2': {'precision': 0.35669341176908614, 'recall': 0.6076364847222736, 'f1-score': 0.44951407529633486, 'support': 189197}, 'accuracy': 0.6086584209493018, 'macro avg': {'precision': 0.5363967330381536, 'recall': 0.612024207604447, 'f1-score': 0.5469695852426006, 'support': 1196985}, 'weighted avg': {'precision': 0.7086908785277113, 'recall': 0.6086584209493018, 'f1-score': 0.6339835320995213, 'support': 1196985}}
[[116254  40173  30253]
 [146684 497338 177086]
 [ 34907  39327 114963]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.89293724
{'0': {'precision': 0.4646183874874385, 'recall': 0.5781858117993178, 'f1-score': 0.5152180241123936, 'support': 249489}, '1': {'precision': 0.7776493102623395, 'recall': 0.6169211592844399, 'f1-score': 0.688023050078926, 'support': 695567}, '2': {'precision': 0.42203824814988544, 'recall': 0.5607135343688102, 'f1-score': 0.48159171414057733, 'support': 251929}, 'accuracy': 0.5970175064850437, 'macro avg': {'precision': 0.5547686486332212, 'recall': 0.5852735018175227, 'f1-score': 0.5616109294439656, 'support': 1196985}, 'weighted avg': {'precision': 0.6375585729856689, 'recall': 0.5970175064850437, 'f1-score': 0.6085575654195724, 'support': 1196985}}
[[144251  61112  44126]
 [117134 429110 149323]
 [ 49087  61582 141260]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9242716
{'0': {'precision': 0.4945563747594299, 'recall': 0.5440774355442514, 'f1-score': 0.5181363468853343, 'support': 293302}, '1': {'precision': 0.7045481563860181, 'recall': 0.6036332034978372, 'f1-score': 0.650198319131448, 'support': 608719}, '2': {'precision': 0.4471517982674951, 'recall': 0.5348042472979754, 'f1-score': 0.4870659577490012, 'support': 294964}, 'accuracy': 0.5720790151923374, 'macro avg': {'precision': 0.5487521098043143, 'recall': 0.560838295446688, 'f1-score': 0.5518002079219279, 'support': 1196985}, 'weighted avg': {'precision': 0.5896647878302606, 'recall': 0.5720790151923374, 'f1-score': 0.5776391689110679, 'support': 1196985}}
[[159579  75787  57936]
 [104176 367443 137100]
 [ 58916  78300 157748]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9721727
{'0': {'precision': 0.5211981312536786, 'recall': 0.4803488638193638, 'f1-score': 0.4999404549243777, 'support': 353949}, '1': {'precision': 0.578792874743204, 'recall': 0.5958996388176807, 'f1-score': 0.5872216959384681, 'support': 488396}, '2': {'precision': 0.4717377006408549, 'recall': 0.4894371757274983, 'f1-score': 0.4804244754257625, 'support': 354640}, 'accuracy': 0.5301887659410937, 'macro avg': {'precision': 0.5239095688792459, 'recall': 0.5218952261215143, 'f1-score': 0.5225288754295361, 'support': 1196985}, 'weighted avg': {'precision': 0.5300440192378876, 'recall': 0.5301887659410937, 'f1-score': 0.529770955738447, 'support': 1196985}}
[[170019 104044  79886]
 [ 82875 291035 114486]
 [ 73314 107752 173574]]
Evaluating performance on  train set...
2108/2108 - 21s - 21s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7513865
{'0': {'precision': 0.43385529394239447, 'recall': 0.5748519679554163, 'f1-score': 0.4944994032489226, 'support': 86130}, '1': {'precision': 0.8664554217671192, 'recall': 0.7064147084977416, 'f1-score': 0.7782929339383381, 'support': 367733}, '2': {'precision': 0.4167171411265899, 'recall': 0.6112409987842514, 'f1-score': 0.4955738792531514, 'support': 85544}, 'accuracy': 0.6703138817256729, 'macro avg': {'precision': 0.5723426189453679, 'recall': 0.6308358917458031, 'f1-score': 0.5894554054801374, 'support': 539407}, 'weighted avg': {'precision': 0.7260563159181833, 'recall': 0.6703138817256729, 'f1-score': 0.6881419799976792, 'support': 539407}}
[[ 49512  21650  14968]
 [ 49741 259772  58220]
 [ 14868  18388  52288]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7758351
{'0': {'precision': 0.5095113221890989, 'recall': 0.5245574384635002, 'f1-score': 0.5169249168053245, 'support': 113713}, '1': {'precision': 0.7869969588508339, 'recall': 0.7390317144072377, 'f1-score': 0.762260528815706, 'support': 312697}, '2': {'precision': 0.48690334662035634, 'recall': 0.5545545456959035, 'f1-score': 0.5185316971046033, 'support': 112997}, 'accuracy': 0.6551731809190463, 'macro avg': {'precision': 0.5944705425534297, 'recall': 0.6060478995222138, 'f1-score': 0.5992390475752113, 'support': 539407}, 'weighted avg': {'precision': 0.6656351632068708, 'recall': 0.6551731809190463, 'f1-score': 0.6594838217181044, 'support': 539407}}
[[ 59649  32720  21344]
 [ 36914 231093  44690]
 [ 20508  29826  62663]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.81926787
{'0': {'precision': 0.5365240133935265, 'recall': 0.4863746536088857, 'f1-score': 0.5102200043565219, 'support': 132437}, '1': {'precision': 0.7190937535076889, 'recall': 0.7442710678032558, 'f1-score': 0.7314658217550469, 'support': 275444}, '2': {'precision': 0.5100736624932035, 'recall': 0.5206803217614768, 'f1-score': 0.5153224198324222, 'support': 131526}, 'accuracy': 0.6264323599804971, 'macro avg': {'precision': 0.5885638097981397, 'recall': 0.5837753477245394, 'f1-score': 0.5856694153146637, 'support': 539407}, 'weighted avg': {'precision': 0.6233023285497804, 'recall': 0.6264323599804971, 'f1-score': 0.6244416092400377, 'support': 539407}}
[[ 64414  41090  26933]
 [ 31594 205005  38845]
 [ 24050  38993  68483]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8993547
{'0': {'precision': 0.5563199267978206, 'recall': 0.4202700919368319, 'f1-score': 0.4788183829372892, 'support': 159131}, '1': {'precision': 0.5973712675414876, 'recall': 0.7539891049045894, 'f1-score': 0.6666044624263228, 'support': 222669}, '2': {'precision': 0.5297949965253649, 'recall': 0.4643702373625537, 'f1-score': 0.4949298565347201, 'support': 157607}, 'accuracy': 0.5709158390603014, 'macro avg': {'precision': 0.5611620636215577, 'recall': 0.546209811401325, 'f1-score': 0.5467842339661106, 'support': 539407}, 'weighted avg': {'precision': 0.5655158517795146, 'recall': 0.5709158390603014, 'f1-score': 0.5610446416862745, 'support': 539407}}
[[ 66878  57314  34939]
 [ 24762 167890  30017]
 [ 28575  55844  73188]]
Evaluating performance on  val set...
798/798 - 7s - 7s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.81402534
{'0': {'precision': 0.4290062822477926, 'recall': 0.5528907684602972, 'f1-score': 0.4831333649392801, 'support': 35942}, '1': {'precision': 0.8551612965501264, 'recall': 0.6660376649250085, 'f1-score': 0.748843047507956, 'support': 133015}, '2': {'precision': 0.402292073552714, 'recall': 0.6196503575888296, 'f1-score': 0.4878561054630768, 'support': 35236}, 'accuracy': 0.638116879618792, 'macro avg': {'precision': 0.562153217450211, 'recall': 0.6128595969913784, 'f1-score': 0.5732775059701043, 'support': 204193}, 'weighted avg': {'precision': 0.7020014748834126, 'recall': 0.638116879618792, 'f1-score': 0.6570364072177565, 'support': 204193}}
[[19872  8248  7822]
 [19804 88593 24618]
 [ 6645  6757 21834]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8351218
{'0': {'precision': 0.49978773084270856, 'recall': 0.5057241660759929, 'f1-score': 0.5027384244184185, 'support': 46557}, '1': {'precision': 0.7687031740219123, 'recall': 0.6962832144009754, 'f1-score': 0.7307031944568576, 'support': 111548}, '2': {'precision': 0.47152237527656843, 'recall': 0.5733813574032286, 'f1-score': 0.5174871734617945, 'support': 46088}, 'accuracy': 0.6250948857208621, 'macro avg': {'precision': 0.5800044267137298, 'recall': 0.5917962459600656, 'f1-score': 0.5836429307790235, 'support': 204193}, 'weighted avg': {'precision': 0.6403130483042354, 'recall': 0.6250948857208621, 'f1-score': 0.6306015466320053, 'support': 204193}}
[[23545 12365 10647]
 [14908 77669 18971]
 [ 8657 11005 26426]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.87147176
{'0': {'precision': 0.5274052721727869, 'recall': 0.4704753386624928, 'f1-score': 0.49731635496991367, 'support': 53667}, '1': {'precision': 0.6953843315327135, 'recall': 0.6987362371383548, 'f1-score': 0.697056254816337, 'support': 97091}, '2': {'precision': 0.49681756296800544, 'recall': 0.546327313558529, 'f1-score': 0.5203975221712197, 'support': 53435}, 'accuracy': 0.598859902151396, 'macro avg': {'precision': 0.5732023888911686, 'recall': 0.5718462964531256, 'f1-score': 0.5715900439858235, 'support': 204193}, 'weighted avg': {'precision': 0.5992725771781354, 'recall': 0.598859902151396, 'f1-score': 0.5983300468466718, 'support': 204193}}
[[25249 15327 13091]
 [12774 67841 16476]
 [ 9851 14391 29193]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9396107
{'0': {'precision': 0.5439728495412075, 'recall': 0.4088490001574555, 'f1-score': 0.4668296717126317, 'support': 63510}, '1': {'precision': 0.5668654752081222, 'recall': 0.7049883086515978, 'f1-score': 0.6284268485441503, 'support': 76980}, '2': {'precision': 0.5188893646454333, 'recall': 0.4946077892720908, 'f1-score': 0.5064577054450472, 'support': 63703}, 'accuracy': 0.5472469673299281, 'macro avg': {'precision': 0.5432425631315877, 'recall': 0.536148366027048, 'f1-score': 0.5339047419006098, 'support': 204193}, 'weighted avg': {'precision': 0.5447778775564852, 'recall': 0.5472469673299281, 'f1-score': 0.5401141393748257, 'support': 204193}}
[[25966 21029 16515]
 [10011 54270 12699]
 [11757 20438 31508]]
training model: results/WBA/W4/deepVOL_L2/seq2seq
Epoch 1/50
2108/2108 - 66s - loss: 10.9500 - accuracy10: 0.5543 - accuracy20: 0.5624 - accuracy30: 0.5546 - accuracy50: 0.5316 - val_loss: 12.2213 - val_accuracy10: 0.6601 - val_accuracy20: 0.6256 - val_accuracy30: 0.5805 - val_accuracy50: 0.5003 - 66s/epoch - 31ms/step
Epoch 2/50
2108/2108 - 56s - loss: 10.4217 - accuracy10: 0.5941 - accuracy20: 0.5987 - accuracy30: 0.5874 - accuracy50: 0.5559 - val_loss: 11.5532 - val_accuracy10: 0.6215 - val_accuracy20: 0.6153 - val_accuracy30: 0.5919 - val_accuracy50: 0.5376 - 56s/epoch - 27ms/step
Epoch 3/50
2108/2108 - 56s - loss: 10.1413 - accuracy10: 0.6197 - accuracy20: 0.6176 - accuracy30: 0.6012 - accuracy50: 0.5659 - val_loss: 11.4716 - val_accuracy10: 0.6428 - val_accuracy20: 0.6292 - val_accuracy30: 0.6010 - val_accuracy50: 0.5400 - 56s/epoch - 26ms/step
Epoch 4/50
2108/2108 - 56s - loss: 10.0222 - accuracy10: 0.6251 - accuracy20: 0.6220 - accuracy30: 0.6046 - accuracy50: 0.5688 - val_loss: 11.4524 - val_accuracy10: 0.6306 - val_accuracy20: 0.6230 - val_accuracy30: 0.5985 - val_accuracy50: 0.5416 - 56s/epoch - 27ms/step
Epoch 5/50
2108/2108 - 56s - loss: 9.9541 - accuracy10: 0.6288 - accuracy20: 0.6252 - accuracy30: 0.6072 - accuracy50: 0.5708 - val_loss: 11.2735 - val_accuracy10: 0.6370 - val_accuracy20: 0.6287 - val_accuracy30: 0.6042 - val_accuracy50: 0.5474 - 56s/epoch - 27ms/step
Epoch 6/50
2108/2108 - 56s - loss: 9.9036 - accuracy10: 0.6326 - accuracy20: 0.6281 - accuracy30: 0.6094 - accuracy50: 0.5722 - val_loss: 11.2415 - val_accuracy10: 0.6283 - val_accuracy20: 0.6223 - val_accuracy30: 0.6009 - val_accuracy50: 0.5479 - 56s/epoch - 26ms/step
Epoch 7/50
2108/2108 - 58s - loss: 9.8528 - accuracy10: 0.6352 - accuracy20: 0.6304 - accuracy30: 0.6113 - accuracy50: 0.5743 - val_loss: 11.1240 - val_accuracy10: 0.6186 - val_accuracy20: 0.6167 - val_accuracy30: 0.5981 - val_accuracy50: 0.5498 - 58s/epoch - 27ms/step
Epoch 8/50
2108/2108 - 61s - loss: 9.8210 - accuracy10: 0.6363 - accuracy20: 0.6311 - accuracy30: 0.6123 - accuracy50: 0.5750 - val_loss: 11.1310 - val_accuracy10: 0.6159 - val_accuracy20: 0.6167 - val_accuracy30: 0.5993 - val_accuracy50: 0.5493 - 61s/epoch - 29ms/step
Epoch 9/50
2108/2108 - 59s - loss: 9.7849 - accuracy10: 0.6386 - accuracy20: 0.6328 - accuracy30: 0.6141 - accuracy50: 0.5769 - val_loss: 11.0802 - val_accuracy10: 0.6148 - val_accuracy20: 0.6160 - val_accuracy30: 0.5989 - val_accuracy50: 0.5498 - 59s/epoch - 28ms/step
Epoch 10/50
2108/2108 - 60s - loss: 9.7563 - accuracy10: 0.6407 - accuracy20: 0.6350 - accuracy30: 0.6157 - accuracy50: 0.5778 - val_loss: 11.0563 - val_accuracy10: 0.6225 - val_accuracy20: 0.6222 - val_accuracy30: 0.6026 - val_accuracy50: 0.5516 - 60s/epoch - 29ms/step
Epoch 11/50
2108/2108 - 58s - loss: 9.7324 - accuracy10: 0.6411 - accuracy20: 0.6355 - accuracy30: 0.6166 - accuracy50: 0.5785 - val_loss: 11.0152 - val_accuracy10: 0.6092 - val_accuracy20: 0.6117 - val_accuracy30: 0.5955 - val_accuracy50: 0.5496 - 58s/epoch - 28ms/step
Epoch 12/50
2108/2108 - 56s - loss: 9.7126 - accuracy10: 0.6420 - accuracy20: 0.6363 - accuracy30: 0.6173 - accuracy50: 0.5791 - val_loss: 11.0416 - val_accuracy10: 0.6204 - val_accuracy20: 0.6193 - val_accuracy30: 0.6005 - val_accuracy50: 0.5492 - 56s/epoch - 27ms/step
Epoch 13/50
2108/2108 - 57s - loss: 9.6907 - accuracy10: 0.6429 - accuracy20: 0.6370 - accuracy30: 0.6179 - accuracy50: 0.5798 - val_loss: 11.0771 - val_accuracy10: 0.6131 - val_accuracy20: 0.6147 - val_accuracy30: 0.5983 - val_accuracy50: 0.5506 - 57s/epoch - 27ms/step
Epoch 14/50
2108/2108 - 59s - loss: 9.6731 - accuracy10: 0.6440 - accuracy20: 0.6382 - accuracy30: 0.6186 - accuracy50: 0.5806 - val_loss: 11.0899 - val_accuracy10: 0.6221 - val_accuracy20: 0.6211 - val_accuracy30: 0.6025 - val_accuracy50: 0.5504 - 59s/epoch - 28ms/step
Epoch 15/50
2108/2108 - 58s - loss: 9.6536 - accuracy10: 0.6441 - accuracy20: 0.6384 - accuracy30: 0.6195 - accuracy50: 0.5811 - val_loss: 11.0674 - val_accuracy10: 0.6150 - val_accuracy20: 0.6156 - val_accuracy30: 0.5982 - val_accuracy50: 0.5495 - 58s/epoch - 28ms/step
Epoch 16/50
2108/2108 - 58s - loss: 9.6377 - accuracy10: 0.6441 - accuracy20: 0.6387 - accuracy30: 0.6202 - accuracy50: 0.5819 - val_loss: 11.1495 - val_accuracy10: 0.6272 - val_accuracy20: 0.6239 - val_accuracy30: 0.6033 - val_accuracy50: 0.5508 - 58s/epoch - 28ms/step
Epoch 17/50
2108/2108 - 58s - loss: 9.6167 - accuracy10: 0.6455 - accuracy20: 0.6399 - accuracy30: 0.6214 - accuracy50: 0.5830 - val_loss: 11.2232 - val_accuracy10: 0.6298 - val_accuracy20: 0.6223 - val_accuracy30: 0.5995 - val_accuracy50: 0.5458 - 58s/epoch - 27ms/step
Epoch 18/50
2108/2108 - 58s - loss: 9.6040 - accuracy10: 0.6454 - accuracy20: 0.6403 - accuracy30: 0.6214 - accuracy50: 0.5826 - val_loss: 11.1630 - val_accuracy10: 0.6068 - val_accuracy20: 0.6097 - val_accuracy30: 0.5937 - val_accuracy50: 0.5460 - 58s/epoch - 27ms/step
Epoch 19/50
2108/2108 - 58s - loss: 9.5857 - accuracy10: 0.6458 - accuracy20: 0.6404 - accuracy30: 0.6220 - accuracy50: 0.5834 - val_loss: 11.1078 - val_accuracy10: 0.6103 - val_accuracy20: 0.6129 - val_accuracy30: 0.5967 - val_accuracy50: 0.5488 - 58s/epoch - 27ms/step
Epoch 20/50
2108/2108 - 57s - loss: 9.5722 - accuracy10: 0.6459 - accuracy20: 0.6405 - accuracy30: 0.6222 - accuracy50: 0.5841 - val_loss: 11.1257 - val_accuracy10: 0.6233 - val_accuracy20: 0.6222 - val_accuracy30: 0.6020 - val_accuracy50: 0.5501 - 57s/epoch - 27ms/step
Epoch 21/50
2108/2108 - 57s - loss: 9.5584 - accuracy10: 0.6463 - accuracy20: 0.6414 - accuracy30: 0.6229 - accuracy50: 0.5844 - val_loss: 11.1666 - val_accuracy10: 0.6131 - val_accuracy20: 0.6147 - val_accuracy30: 0.5971 - val_accuracy50: 0.5475 - 57s/epoch - 27ms/step
testing model: results/WBA/W4/deepVOL_L2/seq2seq
Evaluating performance on  test set...
4676/4676 - 42s - 42s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.81009704
{'0': {'precision': 0.3823847454271311, 'recall': 0.6724608956503106, 'f1-score': 0.4875382300111656, 'support': 186680}, '1': {'precision': 0.8698510240450879, 'recall': 0.603363004514615, 'f1-score': 0.7125046560425006, 'support': 821111}, '2': {'precision': 0.36849424515024787, 'recall': 0.5826224378693221, 'f1-score': 0.4514546307160834, 'support': 189198}, 'accuracy': 0.610861085607303, 'macro avg': {'precision': 0.5402433382074889, 'recall': 0.6194821126780826, 'f1-score': 0.5504991722565832, 'support': 1196989}, 'weighted avg': {'precision': 0.7145815063254212, 'recall': 0.610861085607303, 'f1-score': 0.6361573586962116, 'support': 1196989}}
[[125535  37270  23875]
 [160650 495428 165033]
 [ 42110  36857 110231]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.83912736
{'0': {'precision': 0.4618949255828886, 'recall': 0.6112500601221682, 'f1-score': 0.5261792298217225, 'support': 249492}, '1': {'precision': 0.7801166980871844, 'recall': 0.6383454074158205, 'f1-score': 0.702146232233334, 'support': 695567}, '2': {'precision': 0.4446486283099623, 'recall': 0.5253641884650498, 'f1-score': 0.4816482044862371, 'support': 251930}, 'accuracy': 0.6089187118678617, 'macro avg': {'precision': 0.5622200839933451, 'recall': 0.5916532186676795, 'f1-score': 0.5699912221804312, 'support': 1196989}, 'weighted avg': {'precision': 0.6431828939464469, 'recall': 0.6089187118678617, 'f1-score': 0.6190607339572396, 'support': 1196989}}
[[152502  62434  34556]
 [120804 444012 130751]
 [ 56860  62715 132355]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8761949
{'0': {'precision': 0.49952071831584055, 'recall': 0.5614360478000716, 'f1-score': 0.5286717552350454, 'support': 293305}, '1': {'precision': 0.6986480038727967, 'recall': 0.6591005045020774, 'f1-score': 0.6782982989583095, 'support': 608719}, '2': {'precision': 0.4813404443352544, 'recall': 0.47824318139440275, 'f1-score': 0.47978681432303005, 'support': 294965}, 'accuracy': 0.5906019186475397, 'macro avg': {'precision': 0.5598363888412973, 'recall': 0.5662599112321839, 'f1-score': 0.5622522895054617, 'support': 1196989}, 'weighted avg': {'precision': 0.5963052481839188, 'recall': 0.5906019186475397, 'f1-score': 0.592716766068536, 'support': 1196989}}
[[164672  85547  43086]
 [ 98596 401207 108916]
 [ 66392  87508 141065]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9546046
{'0': {'precision': 0.5278209311945581, 'recall': 0.48666905871151656, 'f1-score': 0.5064103506363313, 'support': 353951}, '1': {'precision': 0.5661135871902152, 'recall': 0.6793094128535041, 'f1-score': 0.6175673462094023, 'support': 488396}, '2': {'precision': 0.5102149819735612, 'recall': 0.40942133193473984, 'f1-score': 0.45429458218089436, 'support': 354642}, 'accuracy': 0.5423834304241727, 'macro avg': {'precision': 0.5347165001194448, 'recall': 0.5251332678332535, 'f1-score': 0.5260907596755426, 'support': 1196989}, 'weighted avg': {'precision': 0.5382288555564546, 'recall': 0.5423834304241727, 'f1-score': 0.5363239017661517, 'support': 1196989}}
[[172257 125160  56534]
 [ 73774 331772  82850]
 [ 80324 129120 145198]]
Evaluating performance on  train set...
2108/2108 - 20s - 20s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.77559525
{'0': {'precision': 0.3904263809851341, 'recall': 0.6986565413778288, 'f1-score': 0.5009241066968596, 'support': 86121}, '1': {'precision': 0.8899798230757657, 'recall': 0.6273717933028199, 'f1-score': 0.7359510235853722, 'support': 367707}, '2': {'precision': 0.3996716657017551, 'recall': 0.5888573398301025, 'f1-score': 0.4761612305831664, 'support': 85581}, 'accuracy': 0.632642391951191, 'macro avg': {'precision': 0.5600259565875517, 'recall': 0.638295224836917, 'f1-score': 0.571012120288466, 'support': 539409}, 'weighted avg': {'precision': 0.7324312756794256, 'recall': 0.632642391951191, 'f1-score': 0.6572096170009856, 'support': 539409}}
[[ 60169  14257  11695]
 [ 73017 230689  64001]
 [ 20925  14261  50395]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.79762435
{'0': {'precision': 0.4673875243112353, 'recall': 0.6381790682541637, 'f1-score': 0.5395910780669145, 'support': 113722}, '1': {'precision': 0.8097065646336221, 'recall': 0.6686858155325212, 'f1-score': 0.7324703533079927, 'support': 312673}, '2': {'precision': 0.47500675063932524, 'recall': 0.5292264675172987, 'f1-score': 0.5006529163597401, 'support': 113014}, 'accuracy': 0.6330354146853315, 'macro avg': {'precision': 0.5840336131947276, 'recall': 0.6120304504346611, 'f1-score': 0.5909047825782158, 'support': 539409}, 'weighted avg': {'precision': 0.6674119965372537, 'recall': 0.6330354146853315, 'f1-score': 0.6432370762246743, 'support': 539409}}
[[ 72575  24310  16837]
 [ 54326 209080  49267]
 [ 28377  24827  59810]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.83297133
{'0': {'precision': 0.5029407777081948, 'recall': 0.5882339615802827, 'f1-score': 0.542253839755258, 'support': 132432}, '1': {'precision': 0.7344815379169167, 'recall': 0.6934836947044121, 'f1-score': 0.7133940784703587, 'support': 275248}, '2': {'precision': 0.5087536306304861, 'recall': 0.4813518663316354, 'f1-score': 0.49467356833864484, 'support': 131729}, 'accuracy': 0.6158388161858627, 'macro avg': {'precision': 0.5820586487518659, 'recall': 0.5876898408721101, 'f1-score': 0.5834404955214204, 'support': 539409}, 'weighted avg': {'precision': 0.6225102555413989, 'recall': 0.6158388161858627, 'f1-score': 0.6179631936081137, 'support': 539409}}
[[ 77901  33893  20638]
 [ 43780 190880  40588]
 [ 33210  35111  63408]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9117932
{'0': {'precision': 0.531909904511288, 'recall': 0.513213381180123, 'f1-score': 0.5223944089942266, 'support': 159119}, '1': {'precision': 0.6046399702896381, 'recall': 0.7165478804862824, 'f1-score': 0.6558544856643717, 'support': 222669}, '2': {'precision': 0.5343355026966771, 'recall': 0.41358702203386605, 'f1-score': 0.46627065727783473, 'support': 157621}, 'accuracy': 0.5680383530864335, 'macro avg': {'precision': 0.5569617924992011, 'recall': 0.5477827612334237, 'f1-score': 0.548173183978811, 'support': 539409}, 'weighted avg': {'precision': 0.5626417911286389, 'recall': 0.5680383530864335, 'f1-score': 0.5610870150552585, 'support': 539409}}
[[ 81662  51155  26302]
 [ 32606 159553  30510]
 [ 39258  53173  65190]]
Evaluating performance on  val set...
798/798 - 7s - 7s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.82245946
{'0': {'precision': 0.387316480159596, 'recall': 0.6921127388180248, 'f1-score': 0.4966822560658752, 'support': 35906}, '1': {'precision': 0.879013221327009, 'recall': 0.595944189401396, 'f1-score': 0.7103158611178277, 'support': 133093}, '2': {'precision': 0.4050564279689947, 'recall': 0.5731374666136273, 'f1-score': 0.474656438253012, 'support': 35194}, 'accuracy': 0.6089239102221917, 'macro avg': {'precision': 0.5571287098185332, 'recall': 0.6203981316110161, 'f1-score': 0.560551518478905, 'support': 204193}, 'weighted avg': {'precision': 0.7108620184268161, 'recall': 0.6089239102221917, 'f1-score': 0.6321323486991859, 'support': 204193}}
[[24851  5675  5380]
 [29530 79316 24247]
 [ 9781  5242 20171]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8412234
{'0': {'precision': 0.46150515687093135, 'recall': 0.6410085694035781, 'f1-score': 0.5366441311852704, 'support': 46561}, '1': {'precision': 0.7917172414561086, 'recall': 0.6371555316574808, 'f1-score': 0.7060768871718988, 'support': 111585}, '2': {'precision': 0.48313589831258424, 'recall': 0.5216843659738962, 'f1-score': 0.501670704201821, 'support': 46047}, 'accuracy': 0.6119945345824783, 'macro avg': {'precision': 0.5787860988798746, 'recall': 0.5999494890116517, 'f1-score': 0.5814639075196634, 'support': 204193}, 'weighted avg': {'precision': 0.6468334796322444, 'recall': 0.6119945345824783, 'f1-score': 0.6213469989841716, 'support': 204193}}
[[29846  9418  7297]
 [22086 71097 18402]
 [12739  9286 24022]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8747032
{'0': {'precision': 0.494051307473045, 'recall': 0.5949112072824951, 'f1-score': 0.5398104265402843, 'support': 53608}, '1': {'precision': 0.7100944033113096, 'recall': 0.6603202700477524, 'f1-score': 0.6843034262098386, 'support': 97168}, '2': {'precision': 0.5172469767064362, 'recall': 0.4772263511616152, 'f1-score': 0.4964313882045939, 'support': 53417}, 'accuracy': 0.5952505717629889, 'macro avg': {'precision': 0.5737975624969303, 'recall': 0.5774859428306209, 'f1-score': 0.573515080318239, 'support': 204193}, 'weighted avg': {'precision': 0.6029263355095229, 'recall': 0.5952505717629889, 'f1-score': 0.5972213941107382, 'support': 204193}}
[[31892 12936  8780]
 [17994 64162 15012]
 [14666 13259 25492]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.94654703
{'0': {'precision': 0.519318997534409, 'recall': 0.5245247927371308, 'f1-score': 0.5219089141208205, 'support': 63446}, '1': {'precision': 0.572962728995578, 'recall': 0.6833012937081103, 'f1-score': 0.6232864539519674, 'support': 76988}, '2': {'precision': 0.5438433028966603, 'recall': 0.41195752756473597, 'f1-score': 0.4688013136288998, 'support': 63759}, 'accuracy': 0.5492401796339738, 'macro avg': {'precision': 0.5453750098088824, 'recall': 0.539927871336659, 'f1-score': 0.5379988939005625, 'support': 204193}, 'weighted avg': {'precision': 0.5472022686716382, 'recall': 0.5492401796339738, 'f1-score': 0.5435490611227057, 'support': 204193}}
[[33279 19138 11029]
 [13380 52606 11002]
 [17423 20070 26266]]
training model: results/WBA/W4/deepVOL_L3/seq2seq
Epoch 1/50
2108/2108 - 92s - loss: 11.1864 - accuracy10: 0.5339 - accuracy20: 0.5436 - accuracy30: 0.5394 - accuracy50: 0.5200 - val_loss: 11.9607 - val_accuracy10: 0.5566 - val_accuracy20: 0.5668 - val_accuracy30: 0.5581 - val_accuracy50: 0.5197 - 92s/epoch - 44ms/step
Epoch 2/50
2108/2108 - 85s - loss: 10.3491 - accuracy10: 0.5979 - accuracy20: 0.6010 - accuracy30: 0.5892 - accuracy50: 0.5582 - val_loss: 11.6921 - val_accuracy10: 0.6079 - val_accuracy20: 0.6013 - val_accuracy30: 0.5808 - val_accuracy50: 0.5297 - 85s/epoch - 40ms/step
Epoch 3/50
2108/2108 - 83s - loss: 10.0369 - accuracy10: 0.6226 - accuracy20: 0.6204 - accuracy30: 0.6051 - accuracy50: 0.5690 - val_loss: 11.2195 - val_accuracy10: 0.5928 - val_accuracy20: 0.5951 - val_accuracy30: 0.5808 - val_accuracy50: 0.5386 - 83s/epoch - 40ms/step
Epoch 4/50
2108/2108 - 82s - loss: 9.9221 - accuracy10: 0.6291 - accuracy20: 0.6260 - accuracy30: 0.6093 - accuracy50: 0.5729 - val_loss: 10.9953 - val_accuracy10: 0.5735 - val_accuracy20: 0.5803 - val_accuracy30: 0.5691 - val_accuracy50: 0.5378 - 82s/epoch - 39ms/step
Epoch 5/50
2108/2108 - 84s - loss: 9.8535 - accuracy10: 0.6329 - accuracy20: 0.6294 - accuracy30: 0.6120 - accuracy50: 0.5748 - val_loss: 10.7385 - val_accuracy10: 0.5842 - val_accuracy20: 0.5912 - val_accuracy30: 0.5797 - val_accuracy50: 0.5466 - 84s/epoch - 40ms/step
Epoch 6/50
2108/2108 - 84s - loss: 9.8071 - accuracy10: 0.6356 - accuracy20: 0.6317 - accuracy30: 0.6136 - accuracy50: 0.5762 - val_loss: 10.6303 - val_accuracy10: 0.5788 - val_accuracy20: 0.5882 - val_accuracy30: 0.5775 - val_accuracy50: 0.5455 - 84s/epoch - 40ms/step
Epoch 7/50
2108/2108 - 86s - loss: 9.7704 - accuracy10: 0.6373 - accuracy20: 0.6327 - accuracy30: 0.6152 - accuracy50: 0.5778 - val_loss: 10.6194 - val_accuracy10: 0.5665 - val_accuracy20: 0.5783 - val_accuracy30: 0.5716 - val_accuracy50: 0.5448 - 86s/epoch - 41ms/step
Epoch 8/50
2108/2108 - 83s - loss: 9.7367 - accuracy10: 0.6388 - accuracy20: 0.6343 - accuracy30: 0.6162 - accuracy50: 0.5784 - val_loss: 10.6646 - val_accuracy10: 0.5433 - val_accuracy20: 0.5600 - val_accuracy30: 0.5574 - val_accuracy50: 0.5395 - 83s/epoch - 39ms/step
Epoch 9/50
2108/2108 - 83s - loss: 9.7124 - accuracy10: 0.6409 - accuracy20: 0.6357 - accuracy30: 0.6172 - accuracy50: 0.5792 - val_loss: 10.6172 - val_accuracy10: 0.5629 - val_accuracy20: 0.5748 - val_accuracy30: 0.5688 - val_accuracy50: 0.5446 - 83s/epoch - 39ms/step
Epoch 10/50
2108/2108 - 84s - loss: 9.6912 - accuracy10: 0.6416 - accuracy20: 0.6364 - accuracy30: 0.6171 - accuracy50: 0.5796 - val_loss: 10.8798 - val_accuracy10: 0.5104 - val_accuracy20: 0.5330 - val_accuracy30: 0.5353 - val_accuracy50: 0.5260 - 84s/epoch - 40ms/step
Epoch 11/50
2108/2108 - 87s - loss: 9.6677 - accuracy10: 0.6424 - accuracy20: 0.6372 - accuracy30: 0.6188 - accuracy50: 0.5803 - val_loss: 10.7797 - val_accuracy10: 0.5254 - val_accuracy20: 0.5463 - val_accuracy30: 0.5464 - val_accuracy50: 0.5336 - 87s/epoch - 41ms/step
Epoch 12/50
2108/2108 - 85s - loss: 9.6517 - accuracy10: 0.6430 - accuracy20: 0.6384 - accuracy30: 0.6196 - accuracy50: 0.5811 - val_loss: 10.9344 - val_accuracy10: 0.5071 - val_accuracy20: 0.5303 - val_accuracy30: 0.5325 - val_accuracy50: 0.5239 - 85s/epoch - 40ms/step
Epoch 13/50
2108/2108 - 83s - loss: 9.6310 - accuracy10: 0.6443 - accuracy20: 0.6389 - accuracy30: 0.6200 - accuracy50: 0.5820 - val_loss: 11.0648 - val_accuracy10: 0.5010 - val_accuracy20: 0.5222 - val_accuracy30: 0.5252 - val_accuracy50: 0.5190 - 83s/epoch - 40ms/step
Epoch 14/50
2108/2108 - 84s - loss: 9.6171 - accuracy10: 0.6447 - accuracy20: 0.6393 - accuracy30: 0.6203 - accuracy50: 0.5821 - val_loss: 10.9476 - val_accuracy10: 0.5210 - val_accuracy20: 0.5421 - val_accuracy30: 0.5438 - val_accuracy50: 0.5306 - 84s/epoch - 40ms/step
Epoch 15/50
2108/2108 - 83s - loss: 9.6001 - accuracy10: 0.6456 - accuracy20: 0.6397 - accuracy30: 0.6210 - accuracy50: 0.5827 - val_loss: 10.8996 - val_accuracy10: 0.5364 - val_accuracy20: 0.5517 - val_accuracy30: 0.5492 - val_accuracy50: 0.5302 - 83s/epoch - 39ms/step
Epoch 16/50
2108/2108 - 88s - loss: 9.5835 - accuracy10: 0.6463 - accuracy20: 0.6404 - accuracy30: 0.6214 - accuracy50: 0.5833 - val_loss: 10.8673 - val_accuracy10: 0.5299 - val_accuracy20: 0.5487 - val_accuracy30: 0.5463 - val_accuracy50: 0.5298 - 88s/epoch - 42ms/step
Epoch 17/50
2108/2108 - 85s - loss: 9.5724 - accuracy10: 0.6463 - accuracy20: 0.6407 - accuracy30: 0.6220 - accuracy50: 0.5839 - val_loss: 11.0912 - val_accuracy10: 0.5044 - val_accuracy20: 0.5266 - val_accuracy30: 0.5299 - val_accuracy50: 0.5218 - 85s/epoch - 40ms/step
Epoch 18/50
2108/2108 - 83s - loss: 9.5590 - accuracy10: 0.6471 - accuracy20: 0.6416 - accuracy30: 0.6227 - accuracy50: 0.5842 - val_loss: 10.8827 - val_accuracy10: 0.5359 - val_accuracy20: 0.5544 - val_accuracy30: 0.5524 - val_accuracy50: 0.5336 - 83s/epoch - 39ms/step
Epoch 19/50
2108/2108 - 83s - loss: 9.5431 - accuracy10: 0.6480 - accuracy20: 0.6418 - accuracy30: 0.6234 - accuracy50: 0.5851 - val_loss: 10.8363 - val_accuracy10: 0.5374 - val_accuracy20: 0.5583 - val_accuracy30: 0.5557 - val_accuracy50: 0.5362 - 83s/epoch - 39ms/step
testing model: results/WBA/W4/deepVOL_L3/seq2seq
Evaluating performance on  test set...
4676/4676 - 73s - 73s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.95952386
{'0': {'precision': 0.3279948228863805, 'recall': 0.7547728733661881, 'f1-score': 0.4572755463170757, 'support': 186680}, '1': {'precision': 0.9035724437586291, 'recall': 0.4335857149642375, 'f1-score': 0.5859831935262735, 'support': 821111}, '2': {'precision': 0.33099440263531427, 'recall': 0.6532310066702608, 'f1-score': 0.43936237530839617, 'support': 189198}, 'accuracy': 0.5183949058846823, 'macro avg': {'precision': 0.5208538897601079, 'recall': 0.6138631983335622, 'f1-score': 0.49420703838391505, 'support': 1196989}, 'weighted avg': {'precision': 0.7233039112250134, 'recall': 0.5183949058846823, 'f1-score': 0.5427350858609574, 'support': 1196989}}
[[140901  19114  26665]
 [241954 356022 223135]
 [ 46728  18880 123590]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9540718
{'0': {'precision': 0.4002020927830422, 'recall': 0.7143555705192952, 'f1-score': 0.5130045824026527, 'support': 249492}, '1': {'precision': 0.8273469680739457, 'recall': 0.43083556292923614, 'f1-score': 0.5666117402595439, 'support': 695567}, '2': {'precision': 0.4002752691706232, 'recall': 0.6187512404239273, 'f1-score': 0.4860929857632213, 'support': 251930}, 'accuracy': 0.5294810562168909, 'macro avg': {'precision': 0.5426081100092037, 'recall': 0.5879807912908196, 'f1-score': 0.5219031028084726, 'support': 1196989}, 'weighted avg': {'precision': 0.6484302008097586, 'recall': 0.5294810562168909, 'f1-score': 0.5384914761232067, 'support': 1196989}}
[[178226  31417  39849]
 [202186 299675 193706]
 [ 64928  31120 155882]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9640405
{'0': {'precision': 0.43633273030771785, 'recall': 0.6808816760709842, 'f1-score': 0.5318423375859025, 'support': 293305}, '1': {'precision': 0.7564986737400531, 'recall': 0.4146445239921869, 'f1-score': 0.5356783578320055, 'support': 608719}, '2': {'precision': 0.432737913285279, 'recall': 0.5951248453206313, 'f1-score': 0.501104026879165, 'support': 294965}, 'accuracy': 0.5243565312630275, 'macro avg': {'precision': 0.5418564391110167, 'recall': 0.5635503484612674, 'f1-score': 0.5228749074323576, 'support': 1196989}, 'weighted avg': {'precision': 0.5982646676247392, 'recall': 0.5243565312630275, 'f1-score': 0.5262185036079584, 'support': 1196989}}
[[199706  40847  52752]
 [178958 252402 177359]
 [ 79028  40396 175541]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9782076
{'0': {'precision': 0.4734489835746347, 'recall': 0.6237162771118037, 'f1-score': 0.5382923576212874, 'support': 353951}, '1': {'precision': 0.6335615761925141, 'recall': 0.39405932890523265, 'f1-score': 0.48590068243272244, 'support': 488396}, '2': {'precision': 0.4608903609039463, 'recall': 0.5548327609251019, 'f1-score': 0.5035172793223895, 'support': 354642}, 'accuracy': 0.5096028451389277, 'macro avg': {'precision': 0.5226336402236984, 'recall': 0.5242027889807127, 'f1-score': 0.5092367731254664, 'support': 1196989}, 'weighted avg': {'precision': 0.5350573481653064, 'recall': 0.5096028451389277, 'f1-score': 0.5066123773428788, 'support': 1196989}}
[[220765  56123  77063]
 [142841 192457 153098]
 [102685  55190 196767]]
Evaluating performance on  train set...
2108/2108 - 35s - 35s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.86964685
{'0': {'precision': 0.3554569866170923, 'recall': 0.7593037702767037, 'f1-score': 0.48422915579054154, 'support': 86121}, '1': {'precision': 0.9207338930289596, 'recall': 0.5308955227939637, 'f1-score': 0.6734687188969981, 'support': 367707}, '2': {'precision': 0.3793464088744483, 'recall': 0.6357369042193944, 'f1-score': 0.47516200590382696, 'support': 85581}, 'accuracy': 0.5839965591971954, 'macro avg': {'precision': 0.5518457628401667, 'recall': 0.6419787324300206, 'f1-score': 0.5442866268637889, 'support': 539409}, 'weighted avg': {'precision': 0.7445879727003709, 'recall': 0.5839965591971954, 'f1-score': 0.6117923523199486, 'support': 539409}}
[[ 65392   8136  12593]
 [ 96070 195214  76423]
 [ 22504   8670  54407]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.864684
{'0': {'precision': 0.42815985621398744, 'recall': 0.7122192715569546, 'f1-score': 0.534811087780463, 'support': 113722}, '1': {'precision': 0.8554288312150382, 'recall': 0.5536391053912554, 'f1-score': 0.6722157825554279, 'support': 312673}, '2': {'precision': 0.44994759087066777, 'recall': 0.5887412179022068, 'f1-score': 0.5100713330190234, 'support': 113014}, 'accuracy': 0.5944264926984903, 'macro avg': {'precision': 0.5778454260998979, 'recall': 0.6181998649501389, 'f1-score': 0.5723660677849715, 'support': 539409}, 'weighted avg': {'precision': 0.6803947860445865, 'recall': 0.5944264926984903, 'f1-score': 0.6092755470029885, 'support': 539409}}
[[ 80995  14076  18651]
 [ 76877 173108  62688]
 [ 31298  15180  66536]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.88093174
{'0': {'precision': 0.4625938281901585, 'recall': 0.6701099432161411, 'f1-score': 0.5473429713327085, 'support': 132432}, '1': {'precision': 0.7921414054320379, 'recall': 0.5607452188571761, 'f1-score': 0.6566544421092042, 'support': 275248}, '2': {'precision': 0.48068096251432313, 'recall': 0.5572956600293025, 'f1-score': 0.5161607852236214, 'support': 131729}, 'accuracy': 0.5867532799786432, 'macro avg': {'precision': 0.5784720653788399, 'recall': 0.5960502740342065, 'f1-score': 0.5733860662218447, 'support': 539409}, 'weighted avg': {'precision': 0.6351714300804879, 'recall': 0.5867532799786432, 'f1-score': 0.5955071019169683, 'support': 539409}}
[[ 88744  19564  24124]
 [ 65715 154344  55189]
 [ 37381  20936  73412]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9140794
{'0': {'precision': 0.4967595995569037, 'recall': 0.6031146500417927, 'f1-score': 0.5447949929748371, 'support': 159119}, '1': {'precision': 0.6750993335042297, 'recall': 0.5677081228190722, 'f1-score': 0.6167638814686875, 'support': 222669}, '2': {'precision': 0.5058531215599937, 'recall': 0.5101985141573775, 'f1-score': 0.5080165257931244, 'support': 157621}, 'accuracy': 0.5613476972019377, 'macro avg': {'precision': 0.5592373515403757, 'recall': 0.5603404290060808, 'f1-score': 0.5565251334122163, 'support': 539409}, 'weighted avg': {'precision': 0.5730357837695628, 'recall': 0.5613476972019377, 'f1-score': 0.5637568227855901, 'support': 539409}}
[[ 95967  29728  33424]
 [ 51125 126411  45133]
 [ 46094  31109  80418]]
Evaluating performance on  val set...
798/798 - 13s - 13s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9134072
{'0': {'precision': 0.3601788796911743, 'recall': 0.7379825098869269, 'f1-score': 0.48409225850650833, 'support': 35906}, '1': {'precision': 0.9108548391520171, 'recall': 0.49908710450587185, 'f1-score': 0.6448434367703949, 'support': 133093}, '2': {'precision': 0.3824222676695899, 'recall': 0.6269534579757913, 'f1-score': 0.4750678206950006, 'support': 35194}, 'accuracy': 0.5631338978319531, 'macro avg': {'precision': 0.5511519955042604, 'recall': 0.6213410241228634, 'f1-score': 0.5346678386573013, 'support': 204193}, 'weighted avg': {'precision': 0.7229432705813338, 'recall': 0.5631338978319531, 'f1-score': 0.5873144576237026, 'support': 204193}}
[[26498  3355  6053]
 [37088 66425 29580]
 [ 9983  3146 22065]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.90303683
{'0': {'precision': 0.42854873722666387, 'recall': 0.6953458903374068, 'f1-score': 0.5302803233176916, 'support': 46561}, '1': {'precision': 0.8386619043470686, 'recall': 0.5176502218040059, 'f1-score': 0.6401675726896414, 'support': 111585}, '2': {'precision': 0.4574291880677921, 'recall': 0.5937628944339479, 'f1-score': 0.5167551834281502, 'support': 46047}, 'accuracy': 0.5753331407051172, 'macro avg': {'precision': 0.5748799432138415, 'recall': 0.6022530021917868, 'f1-score': 0.5624010264784944, 'support': 204193}, 'weighted avg': {'precision': 0.6591753300727056, 'recall': 0.5753331407051172, 'f1-score': 0.5872802038457964, 'support': 204193}}
[[32376  5629  8556]
 [29949 57762 23874]
 [13223  5483 27341]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.91529274
{'0': {'precision': 0.4612000887600997, 'recall': 0.6590993881510222, 'f1-score': 0.5426704244388301, 'support': 53608}, '1': {'precision': 0.7697168587346409, 'recall': 0.5189774411328832, 'f1-score': 0.6199541439486609, 'support': 97168}, '2': {'precision': 0.4897288414133114, 'recall': 0.5690323305314787, 'f1-score': 0.5264105850161062, 'support': 53417}, 'accuracy': 0.568858873712615, 'macro avg': {'precision': 0.573548596302684, 'recall': 0.5823697199384613, 'f1-score': 0.563011717801199, 'support': 204193}, 'weighted avg': {'precision': 0.6154751025233669, 'recall': 0.568858873712615, 'f1-score': 0.575193344494305, 'support': 204193}}
[[35333  7507 10768]
 [25837 50428 20903]
 [15441  7580 30396]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.93791276
{'0': {'precision': 0.49091971181930294, 'recall': 0.5960659458437096, 'f1-score': 0.5384073291050036, 'support': 63446}, '1': {'precision': 0.6430185633575464, 'recall': 0.5174182989556814, 'f1-score': 0.5734212382501547, 'support': 76988}, '2': {'precision': 0.513755980861244, 'recall': 0.5254317037594692, 'f1-score': 0.5195282514131522, 'support': 63759}, 'accuracy': 0.544357544088191, 'macro avg': {'precision': 0.5492314186793644, 'recall': 0.5463053161862867, 'f1-score': 0.5437856062561034, 'support': 204193}, 'weighted avg': {'precision': 0.5553969664757867, 'recall': 0.544357544088191, 'f1-score': 0.5457138465797071, 'support': 204193}}
[[37818 11016 14612]
 [20058 39835 17095]
 [19159 11099 33501]]
training model: results/WBA/W5/deepLOB_L1/seq2seq
Epoch 1/50
1664/1664 - 44s - loss: 11.8840 - accuracy10: 0.4455 - accuracy20: 0.4654 - accuracy30: 0.4733 - accuracy50: 0.4739 - val_loss: 14.8633 - val_accuracy10: 0.5258 - val_accuracy20: 0.4847 - val_accuracy30: 0.4534 - val_accuracy50: 0.4027 - 44s/epoch - 27ms/step
Epoch 2/50
1664/1664 - 36s - loss: 11.8497 - accuracy10: 0.4169 - accuracy20: 0.4500 - accuracy30: 0.4675 - accuracy50: 0.4727 - val_loss: 14.3825 - val_accuracy10: 0.4619 - val_accuracy20: 0.4638 - val_accuracy30: 0.4638 - val_accuracy50: 0.4441 - 36s/epoch - 22ms/step
Epoch 3/50
1664/1664 - 41s - loss: 11.5300 - accuracy10: 0.4557 - accuracy20: 0.4811 - accuracy30: 0.4927 - accuracy50: 0.4907 - val_loss: 13.5247 - val_accuracy10: 0.5094 - val_accuracy20: 0.5058 - val_accuracy30: 0.4985 - val_accuracy50: 0.4715 - 41s/epoch - 25ms/step
Epoch 4/50
1664/1664 - 40s - loss: 11.2431 - accuracy10: 0.5046 - accuracy20: 0.5189 - accuracy30: 0.5229 - accuracy50: 0.5132 - val_loss: 13.4552 - val_accuracy10: 0.4933 - val_accuracy20: 0.4901 - val_accuracy30: 0.4839 - val_accuracy50: 0.4629 - 40s/epoch - 24ms/step
Epoch 5/50
1664/1664 - 38s - loss: 11.0537 - accuracy10: 0.5305 - accuracy20: 0.5381 - accuracy30: 0.5364 - accuracy50: 0.5213 - val_loss: 12.9192 - val_accuracy10: 0.4843 - val_accuracy20: 0.4985 - val_accuracy30: 0.5012 - val_accuracy50: 0.4881 - 38s/epoch - 23ms/step
Epoch 6/50
1664/1664 - 43s - loss: 10.8812 - accuracy10: 0.5443 - accuracy20: 0.5483 - accuracy30: 0.5438 - accuracy50: 0.5272 - val_loss: 12.8885 - val_accuracy10: 0.4845 - val_accuracy20: 0.4984 - val_accuracy30: 0.5002 - val_accuracy50: 0.4879 - 43s/epoch - 26ms/step
Epoch 7/50
1664/1664 - 35s - loss: 10.7433 - accuracy10: 0.5567 - accuracy20: 0.5584 - accuracy30: 0.5521 - accuracy50: 0.5330 - val_loss: 13.2418 - val_accuracy10: 0.5396 - val_accuracy20: 0.5226 - val_accuracy30: 0.5065 - val_accuracy50: 0.4757 - 35s/epoch - 21ms/step
Epoch 8/50
1664/1664 - 40s - loss: 10.6429 - accuracy10: 0.5665 - accuracy20: 0.5665 - accuracy30: 0.5591 - accuracy50: 0.5371 - val_loss: 13.2956 - val_accuracy10: 0.5454 - val_accuracy20: 0.5247 - val_accuracy30: 0.5080 - val_accuracy50: 0.4765 - 40s/epoch - 24ms/step
Epoch 9/50
1664/1664 - 37s - loss: 10.5695 - accuracy10: 0.5742 - accuracy20: 0.5727 - accuracy30: 0.5641 - accuracy50: 0.5404 - val_loss: 13.1595 - val_accuracy10: 0.5494 - val_accuracy20: 0.5266 - val_accuracy30: 0.5100 - val_accuracy50: 0.4790 - 37s/epoch - 22ms/step
Epoch 10/50
1664/1664 - 41s - loss: 10.5069 - accuracy10: 0.5810 - accuracy20: 0.5787 - accuracy30: 0.5685 - accuracy50: 0.5432 - val_loss: 13.2923 - val_accuracy10: 0.5644 - val_accuracy20: 0.5373 - val_accuracy30: 0.5146 - val_accuracy50: 0.4747 - 41s/epoch - 25ms/step
Epoch 11/50
1664/1664 - 41s - loss: 10.4643 - accuracy10: 0.5831 - accuracy20: 0.5807 - accuracy30: 0.5713 - accuracy50: 0.5458 - val_loss: 13.5127 - val_accuracy10: 0.5664 - val_accuracy20: 0.5367 - val_accuracy30: 0.5123 - val_accuracy50: 0.4683 - 41s/epoch - 25ms/step
Epoch 12/50
1664/1664 - 39s - loss: 10.4185 - accuracy10: 0.5858 - accuracy20: 0.5834 - accuracy30: 0.5732 - accuracy50: 0.5474 - val_loss: 13.2175 - val_accuracy10: 0.5579 - val_accuracy20: 0.5382 - val_accuracy30: 0.5191 - val_accuracy50: 0.4791 - 39s/epoch - 23ms/step
Epoch 13/50
1664/1664 - 39s - loss: 10.3885 - accuracy10: 0.5875 - accuracy20: 0.5848 - accuracy30: 0.5749 - accuracy50: 0.5487 - val_loss: 12.9923 - val_accuracy10: 0.5523 - val_accuracy20: 0.5354 - val_accuracy30: 0.5193 - val_accuracy50: 0.4847 - 39s/epoch - 23ms/step
Epoch 14/50
1664/1664 - 40s - loss: 10.3609 - accuracy10: 0.5879 - accuracy20: 0.5866 - accuracy30: 0.5765 - accuracy50: 0.5498 - val_loss: 13.2225 - val_accuracy10: 0.4974 - val_accuracy20: 0.4958 - val_accuracy30: 0.4899 - val_accuracy50: 0.4706 - 40s/epoch - 24ms/step
Epoch 15/50
1664/1664 - 37s - loss: 10.3256 - accuracy10: 0.5898 - accuracy20: 0.5880 - accuracy30: 0.5778 - accuracy50: 0.5514 - val_loss: 13.0192 - val_accuracy10: 0.4950 - val_accuracy20: 0.4964 - val_accuracy30: 0.4925 - val_accuracy50: 0.4749 - 37s/epoch - 22ms/step
Epoch 16/50
1664/1664 - 41s - loss: 10.3042 - accuracy10: 0.5910 - accuracy20: 0.5892 - accuracy30: 0.5791 - accuracy50: 0.5526 - val_loss: 13.0622 - val_accuracy10: 0.4838 - val_accuracy20: 0.4890 - val_accuracy30: 0.4871 - val_accuracy50: 0.4721 - 41s/epoch - 25ms/step
testing model: results/WBA/W5/deepLOB_L1/seq2seq
Evaluating performance on  test set...
7459/7459 - 77s - 77s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0410138
{'0': {'precision': 0.3652148921433519, 'recall': 0.4917236489490825, 'f1-score': 0.4191311063832838, 'support': 416065}, '1': {'precision': 0.6920769968275249, 'recall': 0.3353337909584729, 'f1-score': 0.45177022811185213, 'support': 1059091}, '2': {'precision': 0.3282238643663888, 'recall': 0.6320321588592359, 'f1-score': 0.4320681829992898, 'support': 434095}, 'accuracy': 0.43687288889726916, 'macro avg': {'precision': 0.46183858444575515, 'recall': 0.48636319958893043, 'f1-score': 0.43432317249814195, 'support': 1909251}, 'weighted avg': {'precision': 0.5381199177838909, 'recall': 0.43687288889726916, 'f1-score': 0.4401779568729556, 'support': 1909251}}
[[204589  89445 122031]
 [264436 355149 439506]
 [ 91163  68570 274362]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0666639
{'0': {'precision': 0.42661156096792363, 'recall': 0.443642952120146, 'f1-score': 0.43496059938787096, 'support': 530954}, '1': {'precision': 0.5689857481094218, 'recall': 0.3317649092606818, 'f1-score': 0.4191382011161413, 'support': 821419}, '2': {'precision': 0.3901799928485696, 'recall': 0.6152783913173083, 'f1-score': 0.4775320830871121, 'support': 556878}, 'accuracy': 0.44557106425504034, 'macro avg': {'precision': 0.4619257673086383, 'recall': 0.463562084232712, 'f1-score': 0.44387696119704145, 'support': 1909251}, 'weighted avg': {'precision': 0.4772392278574068, 'recall': 0.44557106425504034, 'f1-score': 0.44057028828341177, 'support': 1909251}}
[[235554 113782 181618]
 [195008 272518 353893]
 [121589  92654 342635]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.075979
{'0': {'precision': 0.45771912193912206, 'recall': 0.407303592838039, 'f1-score': 0.43104219043427866, 'support': 607208}, '1': {'precision': 0.4762973498440701, 'recall': 0.3292953015593308, 'f1-score': 0.38938408679766917, 'support': 665093}, '2': {'precision': 0.4239469278474803, 'recall': 0.6050883114844179, 'f1-score': 0.4985744334601941, 'support': 636950}, 'accuracy': 0.4461126378878419, 'macro avg': {'precision': 0.45265446654355745, 'recall': 0.4472290686272626, 'f1-score': 0.4396669035640473, 'support': 1909251}, 'weighted avg': {'precision': 0.45292407419805214, 'recall': 0.4461126378878419, 'f1-score': 0.43906007235413796, 'support': 1909251}}
[[247318 129706 230184]
 [152574 219012 293507]
 [140435 111104 385411]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0941364
{'0': {'precision': 0.48089182335773406, 'recall': 0.3589490856210663, 'f1-score': 0.4110675687060708, 'support': 700038}, '1': {'precision': 0.34821753687931295, 'recall': 0.32778295636471555, 'f1-score': 0.3376913917580158, 'support': 478466}, '2': {'precision': 0.45627647281216827, 'recall': 0.5846469434701751, 'f1-score': 0.5125461509161201, 'support': 730747}, 'accuracy': 0.43752235824414915, 'macro avg': {'precision': 0.4284619443497384, 'recall': 0.42379299515198565, 'f1-score': 0.4204350371267356, 'support': 1909251}, 'weighted avg': {'precision': 0.4382218293552143, 'recall': 0.43752235824414915, 'f1-score': 0.43151912988614555, 'support': 1909251}}
[[251278 153986 294774]
 [107298 156833 214335]
 [163949 139569 427229]]
Evaluating performance on  train set...
1664/1664 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9730227
{'0': {'precision': 0.3147089669638175, 'recall': 0.5397841403087993, 'f1-score': 0.3976039308783747, 'support': 66710}, '1': {'precision': 0.8449002386150175, 'recall': 0.3990791587731709, 'f1-score': 0.5421023486107038, 'support': 291907}, '2': {'precision': 0.2759236226276027, 'recall': 0.7115196151219078, 'f1-score': 0.3976432513173727, 'support': 67346}, 'accuracy': 0.4705126971121905, 'macro avg': {'precision': 0.4785109427354792, 'recall': 0.5501276380679593, 'f1-score': 0.4457831769354837, 'support': 425963}, 'weighted avg': {'precision': 0.6719101927374648, 'recall': 0.4705126971121905, 'f1-score': 0.49663306650582534, 'support': 425963}}
[[ 36009  12303  18398]
 [ 68065 116494 107348]
 [ 10346   9082  47918]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.98362696
{'0': {'precision': 0.3875817683055497, 'recall': 0.4991055456171735, 'f1-score': 0.4363301626265726, 'support': 88322}, '1': {'precision': 0.7677026054191493, 'recall': 0.40306069110823395, 'f1-score': 0.5285965892911759, 'support': 248702}, '2': {'precision': 0.33872823460113516, 'recall': 0.6918337287354254, 'f1-score': 0.4547880203405865, 'support': 88939}, 'accuracy': 0.48326967365710166, 'macro avg': {'precision': 0.498004202775278, 'recall': 0.5313333218202776, 'f1-score': 0.473238257419445, 'support': 425963}, 'weighted avg': {'precision': 0.5993180646451132, 'recall': 0.48326967365710166, 'f1-score': 0.4940545852913742, 'support': 425963}}
[[ 44082  17225  27015]
 [ 55353 100242  93107]
 [ 14301  13107  61531]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9941718
{'0': {'precision': 0.4285459840233683, 'recall': 0.46416135348644294, 'f1-score': 0.44564321501004805, 'support': 103673}, '1': {'precision': 0.6999755352647321, 'recall': 0.406476419179953, 'f1-score': 0.5142989678766091, 'support': 218207}, '2': {'precision': 0.37519589647038687, 'recall': 0.6739525186629901, 'f1-score': 0.48203708030400905, 'support': 104083}, 'accuracy': 0.48587318616875175, 'macro avg': {'precision': 0.5012391385861624, 'recall': 0.5148634304431287, 'f1-score': 0.48065975439688874, 'support': 425963}, 'weighted avg': {'precision': 0.5545545597093958, 'recall': 0.48587318616875175, 'f1-score': 0.4897060762142959, 'support': 425963}}
[[48121 21195 34357]
 [47054 88696 82457]
 [17114 16822 70147]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0217056
{'0': {'precision': 0.46906930908892747, 'recall': 0.4135470800669427, 'f1-score': 0.4395618425084261, 'support': 124883}, '1': {'precision': 0.5839719361050958, 'recall': 0.41475125140463787, 'f1-score': 0.48502546914665917, 'support': 176202}, '2': {'precision': 0.41609907770070104, 'recall': 0.6354842326110284, 'f1-score': 0.5029071885981172, 'support': 124878}, 'accuracy': 0.47910968793064185, 'macro avg': {'precision': 0.48971344096490804, 'recall': 0.48792752136086964, 'f1-score': 0.4758315000844009, 'support': 425963}, 'weighted avg': {'precision': 0.5010703423481634, 'recall': 0.47910968793064185, 'f1-score': 0.4769388495956576, 'support': 425963}}
[[51645 28257 44981]
 [36742 73080 66380]
 [21714 23806 79358]]
Evaluating performance on  val set...
517/517 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.97981524
{'0': {'precision': 0.3619762522178245, 'recall': 0.528284598836746, 'f1-score': 0.4295965142459141, 'support': 25102}, '1': {'precision': 0.8214374781784628, 'recall': 0.40324673734727356, 'f1-score': 0.5409426835276728, 'support': 81682}, '2': {'precision': 0.32077990007755713, 'recall': 0.7004174543163201, 'f1-score': 0.4400321642852725, 'support': 25392}, 'accuracy': 0.4840818302868902, 'macro avg': {'precision': 0.5013978768246148, 'recall': 0.5439829301667799, 'f1-score': 0.4701904540196198, 'support': 132176}, 'weighted avg': {'precision': 0.6379995399960233, 'recall': 0.4840818302868902, 'f1-score': 0.5004108816429605, 'support': 132176}}
[[13261  4036  7805]
 [18891 32938 29853]
 [ 4483  3124 17785]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9938028
{'0': {'precision': 0.43298339165694605, 'recall': 0.4809650151169248, 'f1-score': 0.45571470330312774, 'support': 32414}, '1': {'precision': 0.7326805449820177, 'recall': 0.41609517562168286, 'f1-score': 0.5307647690859474, 'support': 67076}, '2': {'precision': 0.3853849200199735, 'recall': 0.6847580003671296, 'f1-score': 0.493196566882981, 'support': 32686}, 'accuracy': 0.49844147197675825, 'macro avg': {'precision': 0.5170162855529791, 'recall': 0.527272730368579, 'f1-score': 0.49322534642401866, 'support': 132176}, 'weighted avg': {'precision': 0.5733014721897691, 'recall': 0.49844147197675825, 'f1-score': 0.5030696724761962, 'support': 132176}}
[[15590  5697 11127]
 [14598 27910 24568]
 [ 5818  4486 22382]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0047721
{'0': {'precision': 0.4697416974169742, 'recall': 0.44425653002603954, 'f1-score': 0.45664381010195776, 'support': 37251}, '1': {'precision': 0.6594245924646442, 'recall': 0.42578812540299393, 'f1-score': 0.5174564515275057, 'support': 57383}, '2': {'precision': 0.41914048151734734, 'recall': 0.6686910660060732, 'f1-score': 0.5152920891662219, 'support': 37542}, 'accuracy': 0.49998486865996855, 'macro avg': {'precision': 0.5161022571329886, 'recall': 0.5129119071450355, 'f1-score': 0.4964641169318951, 'support': 132176}, 'weighted avg': {'precision': 0.537718506514062, 'recall': 0.49998486865996855, 'f1-score': 0.49970295469365994, 'support': 132176}}
[[16549  6923 13779]
 [11939 24433 21011]
 [ 6742  5696 25104]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0367278
{'0': {'precision': 0.4992530974488152, 'recall': 0.3923983608821769, 'f1-score': 0.4394230397401359, 'support': 43438}, '1': {'precision': 0.5378123809005281, 'recall': 0.441395951561732, 'f1-score': 0.48485740931625193, 'support': 44758}, '2': {'precision': 0.45260273078742597, 'recall': 0.6308549340609367, 'f1-score': 0.5270656623702282, 'support': 43980}, 'accuracy': 0.48833373683573417, 'macro avg': {'precision': 0.4965560697122564, 'recall': 0.48821641550161515, 'f1-score': 0.4837820371422053, 'support': 132176}, 'weighted avg': {'precision': 0.49678784871200865, 'recall': 0.48833373683573417, 'f1-score': 0.48397026508179597, 'support': 132176}}
[[17045  8985 17408]
 [ 8854 19756 16148]
 [ 8242  7993 27745]]
training model: results/WBA/W5/deepOF_L1/seq2seq
Epoch 1/50
1664/1664 - 40s - loss: 12.5837 - accuracy10: 0.4079 - accuracy20: 0.4238 - accuracy30: 0.4296 - accuracy50: 0.4330 - val_loss: 14.3600 - val_accuracy10: 0.5442 - val_accuracy20: 0.4849 - val_accuracy30: 0.4380 - val_accuracy50: 0.3697 - 40s/epoch - 24ms/step
Epoch 2/50
1664/1664 - 32s - loss: 12.5065 - accuracy10: 0.3742 - accuracy20: 0.3982 - accuracy30: 0.4118 - accuracy50: 0.4225 - val_loss: 13.9853 - val_accuracy10: 0.5226 - val_accuracy20: 0.4746 - val_accuracy30: 0.4377 - val_accuracy50: 0.3803 - 32s/epoch - 20ms/step
Epoch 3/50
1664/1664 - 38s - loss: 12.4298 - accuracy10: 0.3770 - accuracy20: 0.4004 - accuracy30: 0.4138 - accuracy50: 0.4234 - val_loss: 13.9351 - val_accuracy10: 0.5232 - val_accuracy20: 0.4761 - val_accuracy30: 0.4405 - val_accuracy50: 0.3826 - 38s/epoch - 23ms/step
Epoch 4/50
1664/1664 - 39s - loss: 12.3608 - accuracy10: 0.3916 - accuracy20: 0.4125 - accuracy30: 0.4253 - accuracy50: 0.4313 - val_loss: 13.8943 - val_accuracy10: 0.5235 - val_accuracy20: 0.4790 - val_accuracy30: 0.4451 - val_accuracy50: 0.3875 - 39s/epoch - 24ms/step
Epoch 5/50
1664/1664 - 37s - loss: 12.3005 - accuracy10: 0.4081 - accuracy20: 0.4257 - accuracy30: 0.4356 - accuracy50: 0.4387 - val_loss: 13.9517 - val_accuracy10: 0.5452 - val_accuracy20: 0.4913 - val_accuracy30: 0.4513 - val_accuracy50: 0.3896 - 37s/epoch - 22ms/step
Epoch 6/50
1664/1664 - 36s - loss: 12.2445 - accuracy10: 0.4216 - accuracy20: 0.4365 - accuracy30: 0.4455 - accuracy50: 0.4471 - val_loss: 14.0168 - val_accuracy10: 0.5605 - val_accuracy20: 0.4991 - val_accuracy30: 0.4551 - val_accuracy50: 0.3878 - 36s/epoch - 21ms/step
Epoch 7/50
1664/1664 - 37s - loss: 12.1912 - accuracy10: 0.4376 - accuracy20: 0.4493 - accuracy30: 0.4558 - accuracy50: 0.4541 - val_loss: 14.1232 - val_accuracy10: 0.5688 - val_accuracy20: 0.5038 - val_accuracy30: 0.4567 - val_accuracy50: 0.3872 - 37s/epoch - 22ms/step
Epoch 8/50
1664/1664 - 40s - loss: 12.1280 - accuracy10: 0.4502 - accuracy20: 0.4601 - accuracy30: 0.4644 - accuracy50: 0.4606 - val_loss: 14.2827 - val_accuracy10: 0.5818 - val_accuracy20: 0.5106 - val_accuracy30: 0.4592 - val_accuracy50: 0.3857 - 40s/epoch - 24ms/step
Epoch 9/50
1664/1664 - 36s - loss: 12.0742 - accuracy10: 0.4593 - accuracy20: 0.4678 - accuracy30: 0.4715 - accuracy50: 0.4657 - val_loss: 14.4705 - val_accuracy10: 0.5888 - val_accuracy20: 0.5135 - val_accuracy30: 0.4602 - val_accuracy50: 0.3839 - 36s/epoch - 21ms/step
Epoch 10/50
1664/1664 - 38s - loss: 12.0043 - accuracy10: 0.4651 - accuracy20: 0.4744 - accuracy30: 0.4774 - accuracy50: 0.4706 - val_loss: 14.4887 - val_accuracy10: 0.5875 - val_accuracy20: 0.5131 - val_accuracy30: 0.4608 - val_accuracy50: 0.3864 - 38s/epoch - 23ms/step
Epoch 11/50
1664/1664 - 36s - loss: 11.9483 - accuracy10: 0.4718 - accuracy20: 0.4813 - accuracy30: 0.4833 - accuracy50: 0.4758 - val_loss: 14.4696 - val_accuracy10: 0.5847 - val_accuracy20: 0.5114 - val_accuracy30: 0.4604 - val_accuracy50: 0.3871 - 36s/epoch - 21ms/step
Epoch 12/50
1664/1664 - 36s - loss: 11.9081 - accuracy10: 0.4734 - accuracy20: 0.4838 - accuracy30: 0.4860 - accuracy50: 0.4781 - val_loss: 14.5037 - val_accuracy10: 0.5874 - val_accuracy20: 0.5148 - val_accuracy30: 0.4626 - val_accuracy50: 0.3892 - 36s/epoch - 21ms/step
Epoch 13/50
1664/1664 - 36s - loss: 11.8638 - accuracy10: 0.4771 - accuracy20: 0.4872 - accuracy30: 0.4884 - accuracy50: 0.4806 - val_loss: 14.5383 - val_accuracy10: 0.5903 - val_accuracy20: 0.5162 - val_accuracy30: 0.4638 - val_accuracy50: 0.3888 - 36s/epoch - 22ms/step
Epoch 14/50
1664/1664 - 37s - loss: 11.8200 - accuracy10: 0.4803 - accuracy20: 0.4903 - accuracy30: 0.4918 - accuracy50: 0.4829 - val_loss: 14.5729 - val_accuracy10: 0.5888 - val_accuracy20: 0.5147 - val_accuracy30: 0.4628 - val_accuracy50: 0.3899 - 37s/epoch - 22ms/step
testing model: results/WBA/W5/deepOF_L1/seq2seq
Evaluating performance on  test set...
7458/7458 - 68s - 68s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0139679
{'0': {'precision': 0.3972860492923151, 'recall': 0.2060356099061683, 'f1-score': 0.271348035414141, 'support': 416064}, '1': {'precision': 0.5834751089778761, 'recall': 0.6376058691895873, 'f1-score': 0.6093406754540512, 'support': 1059090}, '2': {'precision': 0.3240444894586544, 'recall': 0.40021239737198566, 'f1-score': 0.3581232690763632, 'support': 434092}, 'accuracy': 0.48958332242152136, 'macro avg': {'precision': 0.4349352159096152, 'recall': 0.4146179588225804, 'f1-score': 0.4129373266481851, 'support': 1909246}, 'weighted avg': {'precision': 0.48391574291538275, 'recall': 0.48958332242152136, 'f1-score': 0.47856756598839384, 'support': 1909246}}
[[ 85724 247887  82453]
 [103863 675282 279945]
 [ 26187 234176 173729]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0581793
{'0': {'precision': 0.45914959702795427, 'recall': 0.170390167096084, 'f1-score': 0.24854530569185204, 'support': 530952}, '1': {'precision': 0.44923322250118747, 'recall': 0.6447720347350134, 'f1-score': 0.5295276545094705, 'support': 821419}, '2': {'precision': 0.38761556493202065, 'recall': 0.3711712682379349, 'f1-score': 0.37921522761151244, 'support': 556875}, 'accuracy': 0.4330468677163655, 'macro avg': {'precision': 0.43199946148705415, 'recall': 0.3954444900230108, 'f1-score': 0.38576272927094496, 'support': 1909246}, 'weighted avg': {'precision': 0.43401872726532276, 'recall': 0.4330468677163655, 'f1-score': 0.4075457973793717, 'support': 1909246}}
[[ 90469 331467 109016]
 [ 74253 529628 217538]
 [ 32314 317865 206696]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0886214
{'0': {'precision': 0.491727477167378, 'recall': 0.14116131922280084, 'f1-score': 0.21935259328639906, 'support': 607206}, '1': {'precision': 0.3617389326987891, 'recall': 0.6697108524672489, 'f1-score': 0.4697475194089082, 'support': 665093}, '2': {'precision': 0.4256102016663887, 'recall': 0.3365099450974728, 'f1-score': 0.3758516716920155, 'support': 636947}, 'accuracy': 0.39045413739245755, 'macro avg': {'precision': 0.4263588705108519, 'recall': 0.3824607055958409, 'f1-score': 0.3549839281291076, 'support': 1909246}, 'weighted avg': {'precision': 0.42438797702712583, 'recall': 0.39045413739245755, 'f1-score': 0.3587885439668353, 'support': 1909246}}
[[ 85714 398286 123206]
 [ 53614 445420 166059]
 [ 34984 387624 214339]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1290034
{'0': {'precision': 0.5128530646073698, 'recall': 0.11137554157851656, 'f1-score': 0.18300759450885673, 'support': 700037}, '1': {'precision': 0.2582037306517961, 'recall': 0.7023773943757642, 'f1-score': 0.3775973914709324, 'support': 478465}, '2': {'precision': 0.4623264673738912, 'recall': 0.28829795386619667, 'f1-score': 0.3551383908929538, 'support': 730744}, 'accuracy': 0.32719827617813524, 'macro avg': {'precision': 0.411127754211019, 'recall': 0.36735029660682583, 'f1-score': 0.3052477922909143, 'support': 1909246}, 'weighted avg': {'precision': 0.429698352569301, 'recall': 0.32719827617813524, 'f1-score': 0.2976538757509597, 'support': 1909246}}
[[ 77967 485111 136959]
 [ 34355 336063 108047]
 [ 39704 480368 210672]]
Evaluating performance on  train set...
1664/1664 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9602344
{'0': {'precision': 0.34062435107634803, 'recall': 0.2944546664871576, 'f1-score': 0.3158612611022409, 'support': 66849}, '1': {'precision': 0.7251704713904537, 'recall': 0.6373569858777304, 'f1-score': 0.6784339844712279, 'support': 291667}, '2': {'precision': 0.2639928459646769, 'recall': 0.43770479650085253, 'f1-score': 0.3293467953366431, 'support': 67445}, 'accuracy': 0.5519308105671646, 'macro avg': {'precision': 0.4432625561438262, 'recall': 0.45650548295524684, 'f1-score': 0.441214013636704, 'support': 425961}, 'weighted avg': {'precision': 0.5917999314966156, 'recall': 0.5519308105671645, 'f1-score': 0.5662598430458967, 'support': 425961}}
[[ 19684  36790  10375]
 [ 33842 185896  71929]
 [  4262  33662  29521]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.98594385
{'0': {'precision': 0.4237586000598265, 'recall': 0.25625197847420067, 'f1-score': 0.3193743835423419, 'support': 88452}, '1': {'precision': 0.6197261762219357, 'recall': 0.6519536233283834, 'f1-score': 0.635431538980498, 'support': 248487}, '2': {'precision': 0.32966577828999494, 'recall': 0.41129159084271305, 'f1-score': 0.3659826274701878, 'support': 89022}, 'accuracy': 0.5194888733945127, 'macro avg': {'precision': 0.4577168515239191, 'recall': 0.4398323975484324, 'f1-score': 0.4402628499976759, 'support': 425961}, 'weighted avg': {'precision': 0.51841295554824, 'recall': 0.5194888733945127, 'f1-score': 0.513488993739768, 'support': 425961}}
[[ 22666  52048  13738]
 [ 25773 162002  60712]
 [  5049  47359  36614]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0086486
{'0': {'precision': 0.4779416352933835, 'recall': 0.2216028546629376, 'f1-score': 0.30280627540901517, 'support': 103690}, '1': {'precision': 0.5433819382905019, 'recall': 0.6799301695816131, 'f1-score': 0.6040351780578798, 'support': 218243}, '2': {'precision': 0.37339453042997006, 'recall': 0.3761583419848502, 'f1-score': 0.37477134073343354, 'support': 104028}, 'accuracy': 0.4941743492948885, 'macro avg': {'precision': 0.46490603467128516, 'recall': 0.42589712207646696, 'f1-score': 0.42720426473344286, 'support': 425961}, 'weighted avg': {'precision': 0.4859378176252611, 'recall': 0.4941743492948885, 'f1-score': 0.4747175095745016, 'support': 425961}}
[[ 22978  65066  15646]
 [ 19832 148390  50021]
 [  5267  59630  39131]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0454254
{'0': {'precision': 0.527405803581935, 'recall': 0.17941922932195384, 'f1-score': 0.2677515323129861, 'support': 124903}, '1': {'precision': 0.43673527344007035, 'recall': 0.7157590033203735, 'f1-score': 0.5424707269019985, 'support': 176185}, '2': {'precision': 0.4284387107671843, 'recall': 0.32499419410120683, 'f1-score': 0.369615111386364, 'support': 124873}, 'accuracy': 0.4439350081345475, 'macro avg': {'precision': 0.46419326259639654, 'recall': 0.4067241422478447, 'f1-score': 0.39327912353378286, 'support': 425961}, 'weighted avg': {'precision': 0.4608900776490426, 'recall': 0.4439350081345475, 'f1-score': 0.41124216175628037, 'support': 425961}}
[[ 22410  84428  18065]
 [ 14004 126106  36075]
 [  6077  78213  40583]]
Evaluating performance on  val set...
517/517 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.987491
{'0': {'precision': 0.36233539775118756, 'recall': 0.24018494160787596, 'f1-score': 0.2888782358581017, 'support': 25089}, '1': {'precision': 0.6519414778690042, 'recall': 0.6465057054703952, 'f1-score': 0.6492122136090637, 'support': 81676}, '2': {'precision': 0.3004139048887088, 'recall': 0.408461235733963, 'f1-score': 0.34620323887990123, 'support': 25410}, 'accuracy': 0.5236164176281445, 'macro avg': {'precision': 0.43823026016963357, 'recall': 0.43171729427074473, 'f1-score': 0.4280978961156889, 'support': 132175}, 'weighted avg': {'precision': 0.5293899925389101, 'recall': 0.5236164176281445, 'f1-score': 0.522562868304264, 'support': 132175}}
[[ 6026 14754  4309]
 [ 9011 52804 19861]
 [ 1594 13437 10379]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0227319
{'0': {'precision': 0.4368747956848643, 'recall': 0.20643845773603559, 'f1-score': 0.28038520445628684, 'support': 32368}, '1': {'precision': 0.5348529857532586, 'recall': 0.6580148572451445, 'f1-score': 0.5900757793636673, 'support': 67038}, '2': {'precision': 0.3632320883592501, 'recall': 0.3813665354450853, 'f1-score': 0.3720784827463007, 'support': 32769}, 'accuracy': 0.47884244372990353, 'macro avg': {'precision': 0.444986623265791, 'recall': 0.4152732834754218, 'f1-score': 0.4141798221887516, 'support': 132175}, 'weighted avg': {'precision': 0.46831087686097145, 'recall': 0.47884244372990353, 'f1-score': 0.4601902643914216, 'support': 132175}}
[[ 6682 20074  5612]
 [ 6630 44112 16296]
 [ 1983 18289 12497]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0475812
{'0': {'precision': 0.47875, 'recall': 0.1750409979299406, 'f1-score': 0.25635372167647696, 'support': 37197}, '1': {'precision': 0.4550263320041387, 'recall': 0.6818221409284906, 'f1-score': 0.5458018992902065, 'support': 57405}, '2': {'precision': 0.4020210086614657, 'recall': 0.3483618555877891, 'f1-score': 0.3732728750481243, 'support': 37573}, 'accuracy': 0.4444108189899754, 'macro avg': {'precision': 0.4452657802218682, 'recall': 0.4017416648154068, 'f1-score': 0.3918094986716026, 'support': 132175}, 'weighted avg': {'precision': 0.44663503459152515, 'recall': 0.4444108189899754, 'f1-score': 0.4153003907557208, 'support': 132175}}
[[ 6511 24411  6275]
 [ 5071 39140 13194]
 [ 2018 22466 13089]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0847815
{'0': {'precision': 0.5126890756302521, 'recall': 0.1406278812465425, 'f1-score': 0.22071485420736559, 'support': 43384}, '1': {'precision': 0.3519028322248161, 'recall': 0.7134373674458062, 'f1-score': 0.47132480365768226, 'support': 44793}, '2': {'precision': 0.4446933441944133, 'recall': 0.2977862630119551, 'f1-score': 0.3567062795224677, 'support': 43998}, 'accuracy': 0.3870626063930395, 'macro avg': {'precision': 0.4364284173498272, 'recall': 0.3839505039014346, 'f1-score': 0.3495819791291718, 'support': 132175}, 'weighted avg': {'precision': 0.4355657588716084, 'recall': 0.38706260639303947, 'f1-score': 0.35091286590959286, 'support': 132175}}
[[ 6101 30227  7056]
 [ 3531 31957  9305]
 [ 2268 28628 13102]]
training model: results/WBA/W5/deepLOB_L2/seq2seq
Epoch 1/50
1664/1664 - 84s - loss: 11.9742 - accuracy10: 0.4421 - accuracy20: 0.4605 - accuracy30: 0.4678 - accuracy50: 0.4672 - val_loss: 14.4710 - val_accuracy10: 0.5567 - val_accuracy20: 0.5103 - val_accuracy30: 0.4736 - val_accuracy50: 0.4159 - 84s/epoch - 50ms/step
Epoch 2/50
1664/1664 - 76s - loss: 11.4588 - accuracy10: 0.4732 - accuracy20: 0.4921 - accuracy30: 0.4988 - accuracy50: 0.4935 - val_loss: 13.3896 - val_accuracy10: 0.5386 - val_accuracy20: 0.5242 - val_accuracy30: 0.5085 - val_accuracy50: 0.4715 - 76s/epoch - 46ms/step
Epoch 3/50
1664/1664 - 79s - loss: 10.9110 - accuracy10: 0.5438 - accuracy20: 0.5512 - accuracy30: 0.5470 - accuracy50: 0.5267 - val_loss: 12.6222 - val_accuracy10: 0.5201 - val_accuracy20: 0.5262 - val_accuracy30: 0.5214 - val_accuracy50: 0.4990 - 79s/epoch - 47ms/step
Epoch 4/50
1664/1664 - 77s - loss: 10.5692 - accuracy10: 0.5785 - accuracy20: 0.5802 - accuracy30: 0.5717 - accuracy50: 0.5451 - val_loss: 12.3947 - val_accuracy10: 0.5560 - val_accuracy20: 0.5523 - val_accuracy30: 0.5414 - val_accuracy50: 0.5104 - 77s/epoch - 47ms/step
Epoch 5/50
1664/1664 - 76s - loss: 10.3649 - accuracy10: 0.5930 - accuracy20: 0.5932 - accuracy30: 0.5824 - accuracy50: 0.5532 - val_loss: 12.1456 - val_accuracy10: 0.5451 - val_accuracy20: 0.5485 - val_accuracy30: 0.5417 - val_accuracy50: 0.5166 - 76s/epoch - 46ms/step
Epoch 6/50
1664/1664 - 77s - loss: 10.2341 - accuracy10: 0.6011 - accuracy20: 0.6012 - accuracy30: 0.5894 - accuracy50: 0.5584 - val_loss: 12.0960 - val_accuracy10: 0.5470 - val_accuracy20: 0.5523 - val_accuracy30: 0.5458 - val_accuracy50: 0.5195 - 77s/epoch - 46ms/step
Epoch 7/50
1664/1664 - 76s - loss: 10.1433 - accuracy10: 0.6067 - accuracy20: 0.6056 - accuracy30: 0.5934 - accuracy50: 0.5612 - val_loss: 11.9236 - val_accuracy10: 0.5495 - val_accuracy20: 0.5554 - val_accuracy30: 0.5476 - val_accuracy50: 0.5225 - 76s/epoch - 46ms/step
Epoch 8/50
1664/1664 - 78s - loss: 10.0823 - accuracy10: 0.6078 - accuracy20: 0.6073 - accuracy30: 0.5953 - accuracy50: 0.5639 - val_loss: 11.8666 - val_accuracy10: 0.5512 - val_accuracy20: 0.5561 - val_accuracy30: 0.5494 - val_accuracy50: 0.5242 - 78s/epoch - 47ms/step
Epoch 9/50
1664/1664 - 76s - loss: 10.0349 - accuracy10: 0.6107 - accuracy20: 0.6096 - accuracy30: 0.5971 - accuracy50: 0.5653 - val_loss: 11.8625 - val_accuracy10: 0.5489 - val_accuracy20: 0.5557 - val_accuracy30: 0.5500 - val_accuracy50: 0.5245 - 76s/epoch - 46ms/step
Epoch 10/50
1664/1664 - 76s - loss: 9.9865 - accuracy10: 0.6117 - accuracy20: 0.6108 - accuracy30: 0.5991 - accuracy50: 0.5671 - val_loss: 11.8696 - val_accuracy10: 0.5655 - val_accuracy20: 0.5669 - val_accuracy30: 0.5577 - val_accuracy50: 0.5271 - 76s/epoch - 46ms/step
Epoch 11/50
1664/1664 - 76s - loss: 9.9484 - accuracy10: 0.6136 - accuracy20: 0.6129 - accuracy30: 0.6003 - accuracy50: 0.5687 - val_loss: 11.7615 - val_accuracy10: 0.5643 - val_accuracy20: 0.5686 - val_accuracy30: 0.5598 - val_accuracy50: 0.5305 - 76s/epoch - 46ms/step
Epoch 12/50
1664/1664 - 76s - loss: 9.9117 - accuracy10: 0.6152 - accuracy20: 0.6143 - accuracy30: 0.6021 - accuracy50: 0.5704 - val_loss: 11.7929 - val_accuracy10: 0.5552 - val_accuracy20: 0.5629 - val_accuracy30: 0.5551 - val_accuracy50: 0.5285 - 76s/epoch - 46ms/step
Epoch 13/50
1664/1664 - 78s - loss: 9.8795 - accuracy10: 0.6163 - accuracy20: 0.6155 - accuracy30: 0.6025 - accuracy50: 0.5711 - val_loss: 11.8360 - val_accuracy10: 0.5596 - val_accuracy20: 0.5645 - val_accuracy30: 0.5558 - val_accuracy50: 0.5276 - 78s/epoch - 47ms/step
Epoch 14/50
1664/1664 - 77s - loss: 9.8471 - accuracy10: 0.6171 - accuracy20: 0.6166 - accuracy30: 0.6038 - accuracy50: 0.5722 - val_loss: 11.8750 - val_accuracy10: 0.5675 - val_accuracy20: 0.5692 - val_accuracy30: 0.5582 - val_accuracy50: 0.5272 - 77s/epoch - 46ms/step
Epoch 15/50
1664/1664 - 79s - loss: 9.8233 - accuracy10: 0.6181 - accuracy20: 0.6175 - accuracy30: 0.6048 - accuracy50: 0.5733 - val_loss: 11.9272 - val_accuracy10: 0.5549 - val_accuracy20: 0.5602 - val_accuracy30: 0.5518 - val_accuracy50: 0.5258 - 79s/epoch - 47ms/step
Epoch 16/50
1664/1664 - 78s - loss: 9.7950 - accuracy10: 0.6190 - accuracy20: 0.6181 - accuracy30: 0.6063 - accuracy50: 0.5744 - val_loss: 11.9933 - val_accuracy10: 0.5587 - val_accuracy20: 0.5632 - val_accuracy30: 0.5549 - val_accuracy50: 0.5272 - 78s/epoch - 47ms/step
Epoch 17/50
1664/1664 - 78s - loss: 9.7722 - accuracy10: 0.6209 - accuracy20: 0.6198 - accuracy30: 0.6073 - accuracy50: 0.5756 - val_loss: 11.9676 - val_accuracy10: 0.5606 - val_accuracy20: 0.5637 - val_accuracy30: 0.5548 - val_accuracy50: 0.5262 - 78s/epoch - 47ms/step
Epoch 18/50
1664/1664 - 78s - loss: 9.7499 - accuracy10: 0.6211 - accuracy20: 0.6205 - accuracy30: 0.6078 - accuracy50: 0.5760 - val_loss: 11.9196 - val_accuracy10: 0.5543 - val_accuracy20: 0.5599 - val_accuracy30: 0.5526 - val_accuracy50: 0.5251 - 78s/epoch - 47ms/step
Epoch 19/50
1664/1664 - 76s - loss: 9.7258 - accuracy10: 0.6220 - accuracy20: 0.6213 - accuracy30: 0.6089 - accuracy50: 0.5769 - val_loss: 12.0415 - val_accuracy10: 0.5517 - val_accuracy20: 0.5581 - val_accuracy30: 0.5516 - val_accuracy50: 0.5256 - 76s/epoch - 46ms/step
Epoch 20/50
1664/1664 - 75s - loss: 9.7030 - accuracy10: 0.6227 - accuracy20: 0.6218 - accuracy30: 0.6098 - accuracy50: 0.5778 - val_loss: 11.9234 - val_accuracy10: 0.5518 - val_accuracy20: 0.5593 - val_accuracy30: 0.5518 - val_accuracy50: 0.5256 - 75s/epoch - 45ms/step
Epoch 21/50
1664/1664 - 77s - loss: 9.6795 - accuracy10: 0.6227 - accuracy20: 0.6229 - accuracy30: 0.6113 - accuracy50: 0.5795 - val_loss: 11.9950 - val_accuracy10: 0.5446 - val_accuracy20: 0.5534 - val_accuracy30: 0.5474 - val_accuracy50: 0.5232 - 77s/epoch - 46ms/step
testing model: results/WBA/W5/deepLOB_L2/seq2seq
Evaluating performance on  test set...
7459/7459 - 122s - 122s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9719416
{'0': {'precision': 0.46453104702520137, 'recall': 0.4297357384062586, 'f1-score': 0.44645646189284177, 'support': 416065}, '1': {'precision': 0.7177906248220083, 'recall': 0.5711577192139297, 'f1-score': 0.6361335705087792, 'support': 1059091}, '2': {'precision': 0.39297110538940605, 'recall': 0.6170423524804478, 'f1-score': 0.4801516523110844, 'support': 434095}, 'accuracy': 0.5507714805439411, 'macro avg': {'precision': 0.5250975924122052, 'recall': 0.539311936700212, 'f1-score': 0.5209138949042351, 'support': 1909251}, 'weighted avg': {'precision': 0.5887478873694031, 'recall': 0.5507714805439411, 'f1-score': 0.5593343560648333, 'support': 1909251}}
[[178798 130585 106682]
 [147105 604908 307078]
 [ 58997 107243 267855]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0288701
{'0': {'precision': 0.5228743654822335, 'recall': 0.37248424533952096, 'f1-score': 0.43504906543597954, 'support': 530954}, '1': {'precision': 0.5873838355392847, 'recall': 0.5840308052285131, 'f1-score': 0.5857025215654986, 'support': 821419}, '2': {'precision': 0.4538185952027283, 'recall': 0.5820915891811133, 'f1-score': 0.5100133028204968, 'support': 556878}, 'accuracy': 0.5246350532224416, 'macro avg': {'precision': 0.5213589320747488, 'recall': 0.5128688799163824, 'f1-score': 0.5102549632739918, 'support': 1909251}, 'weighted avg': {'precision': 0.530486599359855, 'recall': 0.5246350532224416, 'f1-score': 0.5217299396985404, 'support': 1909251}}
[[197772 181698 151484]
 [103042 479734 238643]
 [ 77426 155298 324154]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0576636
{'0': {'precision': 0.5446172678526285, 'recall': 0.33704924836299915, 'f1-score': 0.41639970986568575, 'support': 607208}, '1': {'precision': 0.4896860919606004, 'recall': 0.5918600857323713, 'f1-score': 0.5359468848347707, 'support': 665093}, '2': {'precision': 0.4830455043859649, 'recall': 0.5533087369495251, 'f1-score': 0.5157952508140938, 'support': 636950}, 'accuracy': 0.4979601948617547, 'macro avg': {'precision': 0.5057829547330647, 'recall': 0.49407269034829854, 'f1-score': 0.48938061517151676, 'support': 1909251}, 'weighted avg': {'precision': 0.5049407269956914, 'recall': 0.4979601948617547, 'f1-score': 0.4912039022158807, 'support': 1909251}}
[[204659 216705 185844]
 [ 80125 393642 191326]
 [ 91001 193519 352430]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1041788
{'0': {'precision': 0.5500971898405655, 'recall': 0.29187986937851945, 'f1-score': 0.38139351698031504, 'support': 700038}, '1': {'precision': 0.357767789572723, 'recall': 0.5849234846363169, 'f1-score': 0.44397733996868466, 'support': 478466}, '2': {'precision': 0.5020071285157838, 'recall': 0.5190510532373037, 'f1-score': 0.5103868387624605, 'support': 730747}, 'accuracy': 0.4522653124183253, 'macro avg': {'precision': 0.4699573693096908, 'recall': 0.46528480241737996, 'f1-score': 0.44525256523715334, 'support': 1909251}, 'weighted avg': {'precision': 0.48349266960123927, 'recall': 0.4522653124183253, 'f1-score': 0.44644819777518735, 'support': 1909251}}
[[204327 259997 235714]
 [ 58052 279866 140548]
 [109059 242393 379295]]
Evaluating performance on  train set...
1664/1664 - 27s - 27s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.84810776
{'0': {'precision': 0.40351785315551225, 'recall': 0.5959676210463198, 'f1-score': 0.4812147473916095, 'support': 66710}, '1': {'precision': 0.8805756238944654, 'recall': 0.566197453298482, 'f1-score': 0.6892299608631377, 'support': 291907}, '2': {'precision': 0.3403914272424774, 'recall': 0.7063225729813204, 'f1-score': 0.4593922478523934, 'support': 67346}, 'accuracy': 0.5930139472207681, 'macro avg': {'precision': 0.541494968097485, 'recall': 0.622829215775374, 'f1-score': 0.5432789853690468, 'support': 425963}, 'weighted avg': {'precision': 0.7204589734020039, 'recall': 0.5930139472207681, 'f1-score': 0.6203147135033735, 'support': 425963}}
[[ 39757  13102  13851]
 [ 48304 165277  78326]
 [ 10465   9313  47568]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8557819
{'0': {'precision': 0.48323914063615775, 'recall': 0.536332963474559, 'f1-score': 0.5084036319144826, 'support': 88322}, '1': {'precision': 0.8025659223071294, 'recall': 0.5865654478050035, 'f1-score': 0.6777723831448955, 'support': 248702}, '2': {'precision': 0.41119244715057807, 'recall': 0.6757890239377551, 'f1-score': 0.5112862544606969, 'support': 88939}, 'accuracy': 0.5947793587705974, 'macro avg': {'precision': 0.5656658366979551, 'recall': 0.5995624784057726, 'f1-score': 0.5658207565066916, 'support': 425963}, 'weighted avg': {'precision': 0.6546377090170266, 'recall': 0.5947793587705974, 'f1-score': 0.6078928474922297, 'support': 425963}}
[[ 47370  20706  20246]
 [ 37002 145880  65820]
 [ 13654  15181  60104]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8750985
{'0': {'precision': 0.5201605509260202, 'recall': 0.4925101038843286, 'f1-score': 0.5059578368469293, 'support': 103673}, '1': {'precision': 0.7318477646518968, 'recall': 0.5993345768009276, 'f1-score': 0.658995626146373, 'support': 218207}, '2': {'precision': 0.44977331258718745, 'recall': 0.6443223196871727, 'f1-score': 0.529750737597112, 'support': 104083}, 'accuracy': 0.5843277467761284, 'macro avg': {'precision': 0.5672605427217016, 'recall': 0.5787223334574763, 'f1-score': 0.5649014001968048, 'support': 425963}, 'weighted avg': {'precision': 0.6114020834475341, 'recall': 0.5843277467761284, 'f1-score': 0.5901678583240176, 'support': 425963}}
[[ 51060  26979  25634]
 [ 31021 130779  56407]
 [ 16081  20939  67063]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.93069565
{'0': {'precision': 0.5498395908284903, 'recall': 0.42955406260259604, 'f1-score': 0.48231031351429116, 'support': 124883}, '1': {'precision': 0.6123044802487051, 'recall': 0.6058444285535919, 'f1-score': 0.609057325022465, 'support': 176202}, '2': {'precision': 0.48345742160369215, 'recall': 0.5964221079773859, 'f1-score': 0.534031225912847, 'support': 124878}, 'accuracy': 0.5513976566039773, 'macro avg': {'precision': 0.5485338308936292, 'recall': 0.5439401997111913, 'f1-score': 0.541799621483201, 'support': 425963}, 'weighted avg': {'precision': 0.5562175295629962, 'recall': 0.5513976566039773, 'f1-score': 0.549902759384637, 'support': 425963}}
[[ 53644  37054  34185]
 [ 24059 106751  45392]
 [ 19860  30538  74480]]
Evaluating performance on  val set...
517/517 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9102313
{'0': {'precision': 0.41393071436657985, 'recall': 0.5826228985738188, 'f1-score': 0.4839990733692954, 'support': 25102}, '1': {'precision': 0.851220681663803, 'recall': 0.5216204304497931, 'f1-score': 0.646854314689986, 'support': 81682}, '2': {'precision': 0.3713400299209233, 'recall': 0.68427063642092, 'f1-score': 0.4814219611537503, 'support': 25392}, 'accuracy': 0.5644519428640601, 'macro avg': {'precision': 0.5454971419837688, 'recall': 0.596171321814844, 'f1-score': 0.5374251164043439, 'support': 132176}, 'weighted avg': {'precision': 0.6759847669126372, 'recall': 0.5644519428640601, 'f1-score': 0.5841451194607153, 'support': 132176}}
[[14625  4178  6299]
 [15959 42607 23116]
 [ 4748  3269 17375]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.91014254
{'0': {'precision': 0.48656160458452724, 'recall': 0.5238785709878447, 'f1-score': 0.5045310039516296, 'support': 32414}, '1': {'precision': 0.76065867266217, 'recall': 0.54474029459121, 'f1-score': 0.634842588088123, 'support': 67076}, '2': {'precision': 0.4385255889520715, 'recall': 0.6606192253564217, 'f1-score': 0.5271342430974294, 'support': 32686}, 'accuracy': 0.5682801718920227, 'macro avg': {'precision': 0.5619152887329228, 'recall': 0.5764126969784922, 'f1-score': 0.5555026117123941, 'support': 132176}, 'weighted avg': {'precision': 0.613780083971205, 'recall': 0.5682801718920227, 'f1-score': 0.5762504484215715, 'support': 132176}}
[[16981  6404  9029]
 [11919 36539 18618]
 [ 6000  5093 21593]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9210897
{'0': {'precision': 0.5182435543278084, 'recall': 0.4834769536388285, 'f1-score': 0.500256933738872, 'support': 37251}, '1': {'precision': 0.6857313585727091, 'recall': 0.55995678162522, 'f1-score': 0.6164944695465315, 'support': 57383}, '2': {'precision': 0.4719969940276075, 'recall': 0.6357413030738905, 'f1-score': 0.5417669224134017, 'support': 37542}, 'accuracy': 0.5599276721946496, 'macro avg': {'precision': 0.5586573023093749, 'recall': 0.5597250127793131, 'f1-score': 0.5528394418996018, 'support': 132176}, 'weighted avg': {'precision': 0.5778214225050493, 'recall': 0.5599276721946496, 'f1-score': 0.562510493477933, 'support': 132176}}
[[18010  8069 11172]
 [ 9724 32132 15527]
 [ 7018  6657 23867]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.96214426
{'0': {'precision': 0.5398519991810231, 'recall': 0.42490446153137806, 'f1-score': 0.4755304211163642, 'support': 43438}, '1': {'precision': 0.5616832142936117, 'recall': 0.5675186558827472, 'f1-score': 0.5645858570142586, 'support': 44758}, '2': {'precision': 0.49723296186794025, 'recall': 0.596543883583447, 'f1-score': 0.5423798891920947, 'support': 43980}, 'accuracy': 0.5303080740830408, 'macro avg': {'precision': 0.5329227251141917, 'recall': 0.5296556669991908, 'f1-score': 0.5274987224409058, 'support': 132176}, 'weighted avg': {'precision': 0.5330635978447734, 'recall': 0.5303080740830408, 'f1-score': 0.5279301215603827, 'support': 132176}}
[[18457 10506 14475]
 [ 7304 25401 12053]
 [ 8428  9316 26236]]
training model: results/WBA/W5/deepOF_L2/seq2seq
Epoch 1/50
1664/1664 - 53s - loss: 11.2908 - accuracy10: 0.5265 - accuracy20: 0.5352 - accuracy30: 0.5304 - accuracy50: 0.5105 - val_loss: 12.5211 - val_accuracy10: 0.6154 - val_accuracy20: 0.5905 - val_accuracy30: 0.5600 - val_accuracy50: 0.5021 - 53s/epoch - 32ms/step
Epoch 2/50
1664/1664 - 45s - loss: 10.4425 - accuracy10: 0.5924 - accuracy20: 0.5934 - accuracy30: 0.5806 - accuracy50: 0.5504 - val_loss: 12.1157 - val_accuracy10: 0.6237 - val_accuracy20: 0.5969 - val_accuracy30: 0.5647 - val_accuracy50: 0.5083 - 45s/epoch - 27ms/step
Epoch 3/50
1664/1664 - 45s - loss: 10.2921 - accuracy10: 0.6026 - accuracy20: 0.6008 - accuracy30: 0.5859 - accuracy50: 0.5541 - val_loss: 12.1201 - val_accuracy10: 0.6219 - val_accuracy20: 0.5973 - val_accuracy30: 0.5676 - val_accuracy50: 0.5113 - 45s/epoch - 27ms/step
Epoch 4/50
1664/1664 - 45s - loss: 10.2104 - accuracy10: 0.6057 - accuracy20: 0.6039 - accuracy30: 0.5891 - accuracy50: 0.5568 - val_loss: 11.9328 - val_accuracy10: 0.6209 - val_accuracy20: 0.5963 - val_accuracy30: 0.5668 - val_accuracy50: 0.5141 - 45s/epoch - 27ms/step
Epoch 5/50
1664/1664 - 48s - loss: 10.1477 - accuracy10: 0.6080 - accuracy20: 0.6065 - accuracy30: 0.5916 - accuracy50: 0.5598 - val_loss: 11.9214 - val_accuracy10: 0.6156 - val_accuracy20: 0.5941 - val_accuracy30: 0.5676 - val_accuracy50: 0.5180 - 48s/epoch - 29ms/step
Epoch 6/50
1664/1664 - 47s - loss: 10.1032 - accuracy10: 0.6096 - accuracy20: 0.6083 - accuracy30: 0.5932 - accuracy50: 0.5612 - val_loss: 11.9391 - val_accuracy10: 0.6082 - val_accuracy20: 0.5892 - val_accuracy30: 0.5642 - val_accuracy50: 0.5180 - 47s/epoch - 28ms/step
Epoch 7/50
1664/1664 - 45s - loss: 10.0619 - accuracy10: 0.6110 - accuracy20: 0.6096 - accuracy30: 0.5950 - accuracy50: 0.5629 - val_loss: 11.8572 - val_accuracy10: 0.6119 - val_accuracy20: 0.5922 - val_accuracy30: 0.5669 - val_accuracy50: 0.5193 - 45s/epoch - 27ms/step
Epoch 8/50
1664/1664 - 45s - loss: 10.0267 - accuracy10: 0.6125 - accuracy20: 0.6114 - accuracy30: 0.5962 - accuracy50: 0.5642 - val_loss: 11.8689 - val_accuracy10: 0.6073 - val_accuracy20: 0.5894 - val_accuracy30: 0.5654 - val_accuracy50: 0.5204 - 45s/epoch - 27ms/step
Epoch 9/50
1664/1664 - 45s - loss: 9.9946 - accuracy10: 0.6137 - accuracy20: 0.6123 - accuracy30: 0.5968 - accuracy50: 0.5657 - val_loss: 11.8844 - val_accuracy10: 0.6078 - val_accuracy20: 0.5912 - val_accuracy30: 0.5667 - val_accuracy50: 0.5210 - 45s/epoch - 27ms/step
Epoch 10/50
1664/1664 - 46s - loss: 9.9643 - accuracy10: 0.6139 - accuracy20: 0.6133 - accuracy30: 0.5986 - accuracy50: 0.5672 - val_loss: 11.8074 - val_accuracy10: 0.6002 - val_accuracy20: 0.5866 - val_accuracy30: 0.5640 - val_accuracy50: 0.5218 - 46s/epoch - 28ms/step
Epoch 11/50
1664/1664 - 47s - loss: 9.9319 - accuracy10: 0.6153 - accuracy20: 0.6146 - accuracy30: 0.6001 - accuracy50: 0.5682 - val_loss: 11.8029 - val_accuracy10: 0.5973 - val_accuracy20: 0.5844 - val_accuracy30: 0.5626 - val_accuracy50: 0.5213 - 47s/epoch - 28ms/step
Epoch 12/50
1664/1664 - 45s - loss: 9.8965 - accuracy10: 0.6158 - accuracy20: 0.6157 - accuracy30: 0.6010 - accuracy50: 0.5696 - val_loss: 11.9102 - val_accuracy10: 0.5886 - val_accuracy20: 0.5777 - val_accuracy30: 0.5587 - val_accuracy50: 0.5202 - 45s/epoch - 27ms/step
Epoch 13/50
1664/1664 - 47s - loss: 9.8695 - accuracy10: 0.6170 - accuracy20: 0.6168 - accuracy30: 0.6019 - accuracy50: 0.5706 - val_loss: 11.7662 - val_accuracy10: 0.5877 - val_accuracy20: 0.5777 - val_accuracy30: 0.5587 - val_accuracy50: 0.5222 - 47s/epoch - 28ms/step
Epoch 14/50
1664/1664 - 47s - loss: 9.8427 - accuracy10: 0.6173 - accuracy20: 0.6174 - accuracy30: 0.6024 - accuracy50: 0.5715 - val_loss: 11.8352 - val_accuracy10: 0.5878 - val_accuracy20: 0.5773 - val_accuracy30: 0.5579 - val_accuracy50: 0.5209 - 47s/epoch - 28ms/step
Epoch 15/50
1664/1664 - 45s - loss: 9.8210 - accuracy10: 0.6178 - accuracy20: 0.6183 - accuracy30: 0.6031 - accuracy50: 0.5723 - val_loss: 11.8530 - val_accuracy10: 0.5849 - val_accuracy20: 0.5751 - val_accuracy30: 0.5561 - val_accuracy50: 0.5205 - 45s/epoch - 27ms/step
Epoch 16/50
1664/1664 - 45s - loss: 9.7964 - accuracy10: 0.6191 - accuracy20: 0.6189 - accuracy30: 0.6041 - accuracy50: 0.5735 - val_loss: 12.0096 - val_accuracy10: 0.5847 - val_accuracy20: 0.5734 - val_accuracy30: 0.5556 - val_accuracy50: 0.5211 - 45s/epoch - 27ms/step
Epoch 17/50
1664/1664 - 45s - loss: 9.7697 - accuracy10: 0.6193 - accuracy20: 0.6202 - accuracy30: 0.6052 - accuracy50: 0.5748 - val_loss: 11.9212 - val_accuracy10: 0.5888 - val_accuracy20: 0.5773 - val_accuracy30: 0.5581 - val_accuracy50: 0.5211 - 45s/epoch - 27ms/step
Epoch 18/50
1664/1664 - 45s - loss: 9.7438 - accuracy10: 0.6200 - accuracy20: 0.6209 - accuracy30: 0.6065 - accuracy50: 0.5758 - val_loss: 11.9821 - val_accuracy10: 0.5811 - val_accuracy20: 0.5726 - val_accuracy30: 0.5555 - val_accuracy50: 0.5200 - 45s/epoch - 27ms/step
Epoch 19/50
1664/1664 - 45s - loss: 9.7214 - accuracy10: 0.6209 - accuracy20: 0.6215 - accuracy30: 0.6069 - accuracy50: 0.5768 - val_loss: 12.0332 - val_accuracy10: 0.5842 - val_accuracy20: 0.5729 - val_accuracy30: 0.5547 - val_accuracy50: 0.5196 - 45s/epoch - 27ms/step
Epoch 20/50
1664/1664 - 45s - loss: 9.6993 - accuracy10: 0.6208 - accuracy20: 0.6222 - accuracy30: 0.6074 - accuracy50: 0.5773 - val_loss: 11.9709 - val_accuracy10: 0.5821 - val_accuracy20: 0.5722 - val_accuracy30: 0.5548 - val_accuracy50: 0.5200 - 45s/epoch - 27ms/step
Epoch 21/50
1664/1664 - 45s - loss: 9.6736 - accuracy10: 0.6216 - accuracy20: 0.6237 - accuracy30: 0.6091 - accuracy50: 0.5791 - val_loss: 12.0203 - val_accuracy10: 0.5808 - val_accuracy20: 0.5707 - val_accuracy30: 0.5524 - val_accuracy50: 0.5181 - 45s/epoch - 27ms/step
Epoch 22/50
1664/1664 - 47s - loss: 9.6524 - accuracy10: 0.6216 - accuracy20: 0.6236 - accuracy30: 0.6096 - accuracy50: 0.5797 - val_loss: 12.0123 - val_accuracy10: 0.5821 - val_accuracy20: 0.5721 - val_accuracy30: 0.5531 - val_accuracy50: 0.5186 - 47s/epoch - 28ms/step
Epoch 23/50
1664/1664 - 45s - loss: 9.6227 - accuracy10: 0.6207 - accuracy20: 0.6244 - accuracy30: 0.6103 - accuracy50: 0.5812 - val_loss: 12.0529 - val_accuracy10: 0.5723 - val_accuracy20: 0.5642 - val_accuracy30: 0.5479 - val_accuracy50: 0.5157 - 45s/epoch - 27ms/step
testing model: results/WBA/W5/deepOF_L2/seq2seq
Evaluating performance on  test set...
7458/7458 - 68s - 68s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0199058
{'0': {'precision': 0.42501228687006165, 'recall': 0.5403976311336718, 'f1-score': 0.47580955766894795, 'support': 416064}, '1': {'precision': 0.7572246868776958, 'recall': 0.46495293129006976, 'f1-score': 0.5761418513567664, 'support': 1059090}, '2': {'precision': 0.3833346348440448, 'recall': 0.6445730398164444, 'f1-score': 0.480757517312951, 'support': 434092}, 'accuracy': 0.522232860511427, 'macro avg': {'precision': 0.5218572028639341, 'recall': 0.549974534080062, 'f1-score': 0.5109029754462219, 'support': 1909246}, 'weighted avg': {'precision': 0.5998199834166604, 'recall': 0.522232860511427, 'f1-score': 0.5325905060745574, 'support': 1909246}}
[[224840  77154 114070]
 [230616 492427 336047]
 [ 73564  80724 279804]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0166208
{'0': {'precision': 0.4811642225132216, 'recall': 0.5010396420015368, 'f1-score': 0.4909008373960636, 'support': 530952}, '1': {'precision': 0.6358005265077152, 'recall': 0.4648504599966643, 'f1-score': 0.5370497475351271, 'support': 821419}, '2': {'precision': 0.4474590533751609, 'recall': 0.6072996632996633, 'f1-score': 0.5152680478655814, 'support': 556875}, 'accuracy': 0.5164630435260831, 'macro avg': {'precision': 0.5214746007986992, 'recall': 0.5243965884326215, 'f1-score': 0.5144062109322575, 'support': 1909246}, 'weighted avg': {'precision': 0.5378628523006327, 'recall': 0.5164630435260831, 'f1-score': 0.5178628328370556, 'support': 1909246}}
[[266028 106428 158496]
 [180467 381837 259115]
 [106389 112296 338190]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0174946
{'0': {'precision': 0.5041247616310963, 'recall': 0.4767344196203595, 'f1-score': 0.49004715507850294, 'support': 607206}, '1': {'precision': 0.5418069472156058, 'recall': 0.44666836066535054, 'f1-score': 0.48965921349861, 'support': 665093}, '2': {'precision': 0.4759998728907814, 'recall': 0.5879311779473018, 'f1-score': 0.5260776358599452, 'support': 636947}, 'accuracy': 0.5033573463032003, 'macro avg': {'precision': 0.5073105272458278, 'recall': 0.5037779860776707, 'f1-score': 0.5019280014790194, 'support': 1909246}, 'weighted avg': {'precision': 0.5078686973777109, 'recall': 0.5033573463032003, 'f1-score': 0.5019322078234617, 'support': 1909246}}
[[289476 122143 195587]
 [151360 297076 216657]
 [133379 129087 374481]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0270181
{'0': {'precision': 0.5202388695485136, 'recall': 0.44103668806077395, 'f1-score': 0.47737493419013083, 'support': 700037}, '1': {'precision': 0.4000728544653716, 'recall': 0.426948679631739, 'f1-score': 0.41307407347493413, 'support': 478465}, '2': {'precision': 0.49837240755759293, 'recall': 0.5491362228085349, 'f1-score': 0.5225242704540143, 'support': 730744}, 'accuracy': 0.4788801443082767, 'macro avg': {'precision': 0.472894710523826, 'recall': 0.4723738635003493, 'f1-score': 0.4709910927063598, 'support': 1909246}, 'weighted avg': {'precision': 0.48175560531339207, 'recall': 0.4788801443082767, 'f1-score': 0.4785413083801088, 'support': 1909246}}
[[308742 148267 243028]
 [113314 204280 160871]
 [171406 158060 401278]]
Evaluating performance on  train set...
1664/1664 - 17s - 17s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.82488775
{'0': {'precision': 0.42405494444134234, 'recall': 0.5680264476656345, 'f1-score': 0.4855940764990984, 'support': 66849}, '1': {'precision': 0.8656556479604911, 'recall': 0.6370278433967504, 'f1-score': 0.7339493029851748, 'support': 291667}, '2': {'precision': 0.36698663995204506, 'recall': 0.6626436355548966, 'f1-score': 0.4723663767135594, 'support': 67445}, 'accuracy': 0.630254882489242, 'macro avg': {'precision': 0.5522324107846263, 'recall': 0.6225659755390939, 'f1-score': 0.5639699187326109, 'support': 425961}, 'weighted avg': {'precision': 0.7173948995006997, 'recall': 0.630254882489242, 'f1-score': 0.6535551847495692, 'support': 425961}}
[[ 37972  15043  13834]
 [ 42612 185800  63255]
 [  8961  13792  44692]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.835104
{'0': {'precision': 0.4974482714441289, 'recall': 0.5267489711934157, 'f1-score': 0.5116794974576365, 'support': 88452}, '1': {'precision': 0.7877426233259173, 'recall': 0.6511849714471984, 'f1-score': 0.712983974373097, 'support': 248487}, '2': {'precision': 0.43932444360380807, 'recall': 0.626193525196019, 'f1-score': 0.5163725626418415, 'support': 89022}, 'accuracy': 0.6201224994776517, 'macro avg': {'precision': 0.574838446124618, 'recall': 0.6013758226122111, 'f1-score': 0.5803453448241918, 'support': 425961}, 'weighted avg': {'precision': 0.6546459332348772, 'recall': 0.6201224994776517, 'f1-score': 0.6300925249510463, 'support': 425961}}
[[ 46592  22755  19105]
 [ 34638 161811  52038]
 [ 12432  20845  55745]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8627651
{'0': {'precision': 0.5284588079907545, 'recall': 0.4939145529945028, 'f1-score': 0.5106030847150079, 'support': 103690}, '1': {'precision': 0.719461198026493, 'recall': 0.6487951503599199, 'f1-score': 0.6823033369473558, 'support': 218243}, '2': {'precision': 0.4717185160539012, 'recall': 0.5996558618833391, 'f1-score': 0.528048419181445, 'support': 104028}, 'accuracy': 0.5990924051732436, 'macro avg': {'precision': 0.5732128406903829, 'recall': 0.5807885217459207, 'f1-score': 0.5736516136146029, 'support': 425961}, 'weighted avg': {'precision': 0.6124626381981273, 'recall': 0.5990924051732436, 'f1-score': 0.602834958998848, 'support': 425961}}
[[ 51214  28882  23594]
 [ 30381 141595  46267]
 [ 15317  26330  62381]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.91595125
{'0': {'precision': 0.554514731105315, 'recall': 0.4374434561219506, 'f1-score': 0.48907069585921703, 'support': 124903}, '1': {'precision': 0.598179762636092, 'recall': 0.6576836847631751, 'f1-score': 0.6265220494409239, 'support': 176185}, '2': {'precision': 0.5014096936066469, 'recall': 0.5369215122564526, 'f1-score': 0.5185583355891566, 'support': 124873}, 'accuracy': 0.5577012919023103, 'macro avg': {'precision': 0.5513680624493512, 'recall': 0.5440162177138594, 'f1-score': 0.5447170269630992, 'support': 425961}, 'weighted avg': {'precision': 0.557007302567676, 'recall': 0.5577012919023103, 'f1-score': 0.5545674825762869, 'support': 425961}}
[[ 54638  40138  30127]
 [ 23768 115874  36543]
 [ 20127  37699  67047]]
Evaluating performance on  val set...
517/517 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9050303
{'0': {'precision': 0.43837116686579053, 'recall': 0.5264857108693053, 'f1-score': 0.4784049546368229, 'support': 25089}, '1': {'precision': 0.8255622979444358, 'recall': 0.5846637935256379, 'f1-score': 0.6845375898623127, 'support': 81676}, '2': {'precision': 0.3776018099547511, 'recall': 0.6568280204643842, 'f1-score': 0.47952880333285447, 'support': 25410}, 'accuracy': 0.5874938528466048, 'macro avg': {'precision': 0.5471784249216591, 'recall': 0.5893258416197759, 'f1-score': 0.54749044927733, 'support': 132175}, 'weighted avg': {'precision': 0.6659487985122435, 'recall': 0.5874938528466048, 'f1-score': 0.6059982673664864, 'support': 132175}}
[[13209  5154  6726]
 [13139 47753 20784]
 [ 3784  4936 16690]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.90746385
{'0': {'precision': 0.4964779794390151, 'recall': 0.4834095402867029, 'f1-score': 0.48985661511489575, 'support': 32368}, '1': {'precision': 0.7341212837530685, 'recall': 0.6022405203019183, 'f1-score': 0.6616734817631298, 'support': 67038}, '2': {'precision': 0.44525227750525576, 'recall': 0.6204644633647655, 'f1-score': 0.5184552420537274, 'support': 32769}, 'accuracy': 0.5776584074144127, 'macro avg': {'precision': 0.5586171802324466, 'recall': 0.5687048413177956, 'f1-score': 0.5566617796439176, 'support': 132175}, 'weighted avg': {'precision': 0.6043086343127669, 'recall': 0.5776584074144127, 'f1-score': 0.5840908312111537, 'support': 132175}}
[[15647  7518  9203]
 [10536 40373 16129]
 [ 5333  7104 20332]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9231028
{'0': {'precision': 0.5213075579792286, 'recall': 0.45745624647148964, 'f1-score': 0.4872991780978837, 'support': 37197}, '1': {'precision': 0.6614452518358035, 'recall': 0.6009755247800714, 'f1-score': 0.629762143808985, 'support': 57405}, '2': {'precision': 0.47478734406990736, 'recall': 0.5986745801506401, 'f1-score': 0.5295821071218364, 'support': 37573}, 'accuracy': 0.5599319084547002, 'macro avg': {'precision': 0.5525133846283131, 'recall': 0.5523687838007337, 'f1-score': 0.5488811430095684, 'support': 132175}, 'weighted avg': {'precision': 0.568946675199745, 'recall': 0.5599319084547002, 'f1-score': 0.5611919947338795, 'support': 132175}}
[[17016  9074 11107]
 [ 9130 34499 13776]
 [ 6495  8584 22494]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9587706
{'0': {'precision': 0.5337469280105497, 'recall': 0.4104969574036511, 'f1-score': 0.4640781758957655, 'support': 43384}, '1': {'precision': 0.5379526256719239, 'recall': 0.6099390529770277, 'f1-score': 0.5716886377903327, 'support': 44793}, '2': {'precision': 0.49991670484361334, 'recall': 0.5456384381108232, 'f1-score': 0.5217778743751359, 'support': 43998}, 'accuracy': 0.5230716852657462, 'macro avg': {'precision': 0.5238720861753623, 'recall': 0.522024816163834, 'f1-score': 0.519181562687078, 'support': 132175}, 'weighted avg': {'precision': 0.5239109049838583, 'recall': 0.5230716852657462, 'f1-score': 0.5197533546613315, 'support': 132175}}
[[17809 11928 13647]
 [ 7104 27321 10368]
 [ 8453 11538 24007]]
training model: results/WBA/W5/deepVOL_L2/seq2seq
Epoch 1/50
1664/1664 - 51s - loss: 11.4066 - accuracy10: 0.5119 - accuracy20: 0.5253 - accuracy30: 0.5232 - accuracy50: 0.5065 - val_loss: 12.6995 - val_accuracy10: 0.5693 - val_accuracy20: 0.5587 - val_accuracy30: 0.5375 - val_accuracy50: 0.4885 - 51s/epoch - 31ms/step
Epoch 2/50
1664/1664 - 44s - loss: 10.8785 - accuracy10: 0.5542 - accuracy20: 0.5618 - accuracy30: 0.5560 - accuracy50: 0.5314 - val_loss: 12.6543 - val_accuracy10: 0.5941 - val_accuracy20: 0.5758 - val_accuracy30: 0.5511 - val_accuracy50: 0.4969 - 44s/epoch - 26ms/step
Epoch 3/50
1664/1664 - 46s - loss: 10.5699 - accuracy10: 0.5835 - accuracy20: 0.5855 - accuracy30: 0.5747 - accuracy50: 0.5453 - val_loss: 12.1773 - val_accuracy10: 0.5889 - val_accuracy20: 0.5807 - val_accuracy30: 0.5603 - val_accuracy50: 0.5116 - 46s/epoch - 28ms/step
Epoch 4/50
1664/1664 - 44s - loss: 10.4290 - accuracy10: 0.5910 - accuracy20: 0.5928 - accuracy30: 0.5812 - accuracy50: 0.5507 - val_loss: 12.2348 - val_accuracy10: 0.5895 - val_accuracy20: 0.5806 - val_accuracy30: 0.5603 - val_accuracy50: 0.5113 - 44s/epoch - 27ms/step
Epoch 5/50
1664/1664 - 43s - loss: 10.3426 - accuracy10: 0.5967 - accuracy20: 0.5975 - accuracy30: 0.5849 - accuracy50: 0.5534 - val_loss: 12.2680 - val_accuracy10: 0.5941 - val_accuracy20: 0.5837 - val_accuracy30: 0.5624 - val_accuracy50: 0.5107 - 43s/epoch - 26ms/step
Epoch 6/50
1664/1664 - 44s - loss: 10.2745 - accuracy10: 0.6003 - accuracy20: 0.6000 - accuracy30: 0.5877 - accuracy50: 0.5557 - val_loss: 12.1666 - val_accuracy10: 0.5815 - val_accuracy20: 0.5789 - val_accuracy30: 0.5627 - val_accuracy50: 0.5172 - 44s/epoch - 26ms/step
Epoch 7/50
1664/1664 - 43s - loss: 10.2164 - accuracy10: 0.6037 - accuracy20: 0.6034 - accuracy30: 0.5902 - accuracy50: 0.5577 - val_loss: 12.2111 - val_accuracy10: 0.5798 - val_accuracy20: 0.5748 - val_accuracy30: 0.5593 - val_accuracy50: 0.5170 - 43s/epoch - 26ms/step
Epoch 8/50
1664/1664 - 43s - loss: 10.1730 - accuracy10: 0.6059 - accuracy20: 0.6058 - accuracy30: 0.5930 - accuracy50: 0.5597 - val_loss: 12.0401 - val_accuracy10: 0.5810 - val_accuracy20: 0.5775 - val_accuracy30: 0.5621 - val_accuracy50: 0.5185 - 43s/epoch - 26ms/step
Epoch 9/50
1664/1664 - 43s - loss: 10.1377 - accuracy10: 0.6071 - accuracy20: 0.6071 - accuracy30: 0.5937 - accuracy50: 0.5611 - val_loss: 12.0872 - val_accuracy10: 0.5759 - val_accuracy20: 0.5734 - val_accuracy30: 0.5589 - val_accuracy50: 0.5186 - 43s/epoch - 26ms/step
Epoch 10/50
1664/1664 - 43s - loss: 10.1120 - accuracy10: 0.6088 - accuracy20: 0.6081 - accuracy30: 0.5947 - accuracy50: 0.5616 - val_loss: 12.0513 - val_accuracy10: 0.5827 - val_accuracy20: 0.5789 - val_accuracy30: 0.5631 - val_accuracy50: 0.5208 - 43s/epoch - 26ms/step
Epoch 11/50
1664/1664 - 44s - loss: 10.0804 - accuracy10: 0.6104 - accuracy20: 0.6095 - accuracy30: 0.5957 - accuracy50: 0.5621 - val_loss: 11.8914 - val_accuracy10: 0.5941 - val_accuracy20: 0.5858 - val_accuracy30: 0.5673 - val_accuracy50: 0.5212 - 44s/epoch - 26ms/step
Epoch 12/50
1664/1664 - 45s - loss: 10.0559 - accuracy10: 0.6115 - accuracy20: 0.6105 - accuracy30: 0.5967 - accuracy50: 0.5636 - val_loss: 11.8440 - val_accuracy10: 0.5820 - val_accuracy20: 0.5801 - val_accuracy30: 0.5664 - val_accuracy50: 0.5243 - 45s/epoch - 27ms/step
Epoch 13/50
1664/1664 - 44s - loss: 10.0328 - accuracy10: 0.6137 - accuracy20: 0.6123 - accuracy30: 0.5989 - accuracy50: 0.5649 - val_loss: 11.8536 - val_accuracy10: 0.5873 - val_accuracy20: 0.5831 - val_accuracy30: 0.5665 - val_accuracy50: 0.5231 - 44s/epoch - 26ms/step
Epoch 14/50
1664/1664 - 43s - loss: 10.0073 - accuracy10: 0.6144 - accuracy20: 0.6130 - accuracy30: 0.5991 - accuracy50: 0.5652 - val_loss: 11.8990 - val_accuracy10: 0.5822 - val_accuracy20: 0.5796 - val_accuracy30: 0.5654 - val_accuracy50: 0.5229 - 43s/epoch - 26ms/step
Epoch 15/50
1664/1664 - 43s - loss: 9.9887 - accuracy10: 0.6158 - accuracy20: 0.6138 - accuracy30: 0.6001 - accuracy50: 0.5665 - val_loss: 11.8885 - val_accuracy10: 0.5798 - val_accuracy20: 0.5797 - val_accuracy30: 0.5659 - val_accuracy50: 0.5229 - 43s/epoch - 26ms/step
Epoch 16/50
1664/1664 - 43s - loss: 9.9657 - accuracy10: 0.6164 - accuracy20: 0.6142 - accuracy30: 0.6005 - accuracy50: 0.5673 - val_loss: 11.8698 - val_accuracy10: 0.5879 - val_accuracy20: 0.5843 - val_accuracy30: 0.5682 - val_accuracy50: 0.5244 - 43s/epoch - 26ms/step
Epoch 17/50
1664/1664 - 43s - loss: 9.9507 - accuracy10: 0.6171 - accuracy20: 0.6153 - accuracy30: 0.6012 - accuracy50: 0.5673 - val_loss: 11.8931 - val_accuracy10: 0.5920 - val_accuracy20: 0.5843 - val_accuracy30: 0.5673 - val_accuracy50: 0.5230 - 43s/epoch - 26ms/step
Epoch 18/50
1664/1664 - 43s - loss: 9.9315 - accuracy10: 0.6172 - accuracy20: 0.6155 - accuracy30: 0.6020 - accuracy50: 0.5686 - val_loss: 11.9191 - val_accuracy10: 0.5904 - val_accuracy20: 0.5852 - val_accuracy30: 0.5691 - val_accuracy50: 0.5240 - 43s/epoch - 26ms/step
Epoch 19/50
1664/1664 - 43s - loss: 9.9111 - accuracy10: 0.6185 - accuracy20: 0.6156 - accuracy30: 0.6026 - accuracy50: 0.5693 - val_loss: 12.0239 - val_accuracy10: 0.5941 - val_accuracy20: 0.5871 - val_accuracy30: 0.5697 - val_accuracy50: 0.5234 - 43s/epoch - 26ms/step
Epoch 20/50
1664/1664 - 44s - loss: 9.8941 - accuracy10: 0.6182 - accuracy20: 0.6163 - accuracy30: 0.6029 - accuracy50: 0.5695 - val_loss: 12.0704 - val_accuracy10: 0.5825 - val_accuracy20: 0.5775 - val_accuracy30: 0.5635 - val_accuracy50: 0.5229 - 44s/epoch - 26ms/step
Epoch 21/50
1664/1664 - 43s - loss: 9.8734 - accuracy10: 0.6198 - accuracy20: 0.6177 - accuracy30: 0.6041 - accuracy50: 0.5713 - val_loss: 11.9571 - val_accuracy10: 0.5885 - val_accuracy20: 0.5825 - val_accuracy30: 0.5666 - val_accuracy50: 0.5237 - 43s/epoch - 26ms/step
Epoch 22/50
1664/1664 - 43s - loss: 9.8575 - accuracy10: 0.6206 - accuracy20: 0.6183 - accuracy30: 0.6047 - accuracy50: 0.5713 - val_loss: 12.0058 - val_accuracy10: 0.5882 - val_accuracy20: 0.5814 - val_accuracy30: 0.5645 - val_accuracy50: 0.5219 - 43s/epoch - 26ms/step
testing model: results/WBA/W5/deepVOL_L2/seq2seq
Evaluating performance on  test set...
7459/7459 - 69s - 69s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0203788
{'0': {'precision': 0.4281301338399371, 'recall': 0.5286457644839148, 'f1-score': 0.47310803355083225, 'support': 416065}, '1': {'precision': 0.7609169376530571, 'recall': 0.4474044251155, 'f1-score': 0.563488514795911, 'support': 1059091}, '2': {'precision': 0.3778666059333987, 'recall': 0.672679943330377, 'f1-score': 0.4839067573804369, 'support': 434095}, 'accuracy': 0.5163281307696055, 'macro avg': {'precision': 0.5223045591421309, 'recall': 0.5495767109765972, 'f1-score': 0.5068344352423934, 'support': 1909251}, 'weighted avg': {'precision': 0.6013039924319463, 'recall': 0.5163281307696055, 'f1-score': 0.5256987229275271, 'support': 1909251}}
[[219951  79222 116892]
 [221370 473842 363879]
 [ 72427  69661 292007]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0252627
{'0': {'precision': 0.4933178652432818, 'recall': 0.463714370736448, 'f1-score': 0.4780582614757011, 'support': 530954}, '1': {'precision': 0.6308575893216202, 'recall': 0.46789519112657485, 'f1-score': 0.5372914409534126, 'support': 821419}, '2': {'precision': 0.44247672699668383, 'recall': 0.6363907354932319, 'f1-score': 0.5220068257173706, 'support': 556878}, 'accuracy': 0.5158782161172104, 'macro avg': {'precision': 0.5222173938538619, 'recall': 0.5226667657854183, 'f1-score': 0.5124521760488281, 'support': 1909251}, 'weighted avg': {'precision': 0.5376627058264297, 'recall': 0.5158782161172104, 'f1-score': 0.5163608458981657, 'support': 1909251}}
[[246211 115955 168788]
 [159333 384338 277748]
 [ 93548 108938 354392]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.026611
{'0': {'precision': 0.5216893804618905, 'recall': 0.41822406819409497, 'f1-score': 0.4642620133639247, 'support': 607208}, '1': {'precision': 0.527892314212776, 'recall': 0.48315949799501723, 'f1-score': 0.5045363302866088, 'support': 665093}, '2': {'precision': 0.4747823308570972, 'recall': 0.6065578145851322, 'f1-score': 0.5326407869385842, 'support': 636950}, 'accuracy': 0.5036750013486965, 'macro avg': {'precision': 0.5081213418439212, 'recall': 0.5026471269247481, 'f1-score': 0.5004797101963726, 'support': 1909251}, 'weighted avg': {'precision': 0.5082014119189407, 'recall': 0.5036750013486965, 'f1-score': 0.5011036994981407, 'support': 1909251}}
[[253949 145123 208136]
 [124495 321346 219252]
 [108338 142265 386347]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0420398
{'0': {'precision': 0.5365364509280304, 'recall': 0.3584719686645582, 'f1-score': 0.429790991043452, 'support': 700038}, '1': {'precision': 0.381940753267271, 'recall': 0.48809110783211346, 'f1-score': 0.42854036437904447, 'support': 478466}, '2': {'precision': 0.4974093389085854, 'recall': 0.5650355047643029, 'f1-score': 0.5290701697286854, 'support': 730747}, 'accuracy': 0.4700152049154354, 'macro avg': {'precision': 0.4719621810346289, 'recall': 0.4705328604203249, 'f1-score': 0.4624671750503939, 'support': 1909251}, 'weighted avg': {'precision': 0.48281862922526514, 'recall': 0.4700152049154354, 'f1-score': 0.4674757059652124, 'support': 1909251}}
[[250944 188583 260511]
 [ 88243 233535 156688]
 [128524 189325 412898]]
Evaluating performance on  train set...
1664/1664 - 16s - 16s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.820404
{'0': {'precision': 0.4099624261943102, 'recall': 0.5724479088592415, 'f1-score': 0.477768047041161, 'support': 66710}, '1': {'precision': 0.87207391114753, 'recall': 0.623441712600246, 'f1-score': 0.727090033760163, 'support': 291907}, '2': {'precision': 0.3693547087730605, 'recall': 0.6807828230332907, 'f1-score': 0.4788903047901564, 'support': 67346}, 'accuracy': 0.6245213786173917, 'macro avg': {'precision': 0.5504636820383002, 'recall': 0.6255574814975927, 'f1-score': 0.5612494618638268, 'support': 425963}, 'weighted avg': {'precision': 0.7202213216870832, 'recall': 0.6245213786173917, 'f1-score': 0.6488026503929722, 'support': 425963}}
[[ 38188  13865  14657]
 [ 46295 181987  63625]
 [  8667  12831  45848]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8361162
{'0': {'precision': 0.4904940900399791, 'recall': 0.5111863408890197, 'f1-score': 0.5006264899927926, 'support': 88322}, '1': {'precision': 0.788609715242881, 'recall': 0.6530948685575508, 'f1-score': 0.7144833471529712, 'support': 248702}, '2': {'precision': 0.4415240328253224, 'recall': 0.6351881626732929, 'f1-score': 0.5209392823056956, 'support': 88939}, 'accuracy': 0.6199317781121835, 'macro avg': {'precision': 0.5735426127027274, 'recall': 0.5998231240399545, 'f1-score': 0.5786830398171531, 'support': 425963}, 'weighted avg': {'precision': 0.6543266395820702, 'recall': 0.6199317781121835, 'f1-score': 0.629729786581858, 'support': 425963}}
[[ 45149  22254  20919]
 [ 35738 162426  50538]
 [ 11161  21285  56493]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.86363393
{'0': {'precision': 0.5281658355075575, 'recall': 0.46277237081978917, 'f1-score': 0.4933113978715747, 'support': 103673}, '1': {'precision': 0.7119981411739649, 'recall': 0.67406636817334, 'f1-score': 0.6925132242124914, 'support': 218207}, '2': {'precision': 0.4794778441623102, 'recall': 0.592162024538109, 'f1-score': 0.5298954979430591, 'support': 104083}, 'accuracy': 0.6026274582534163, 'macro avg': {'precision': 0.5732139402812775, 'recall': 0.576333587843746, 'f1-score': 0.5719067066757084, 'support': 425963}, 'weighted avg': {'precision': 0.6104403610399686, 'recall': 0.6026274582534163, 'f1-score': 0.6042952528263776, 'support': 425963}}
[[ 47977  29958  25738]
 [ 29949 147086  41172]
 [ 12911  29538  61634]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.92286444
{'0': {'precision': 0.5569488691565557, 'recall': 0.3947695042559836, 'f1-score': 0.46204094638731774, 'support': 124883}, '1': {'precision': 0.5850925765703409, 'recall': 0.69082643783839, 'f1-score': 0.633578488780625, 'support': 176202}, '2': {'precision': 0.5072835604052519, 'recall': 0.5256570412722817, 'f1-score': 0.5163068912493758, 'support': 124878}, 'accuracy': 0.5556069423870148, 'macro avg': {'precision': 0.5497750020440495, 'recall': 0.5370843277888852, 'f1-score': 0.5373087754724395, 'support': 425963}, 'weighted avg': {'precision': 0.5540304774358628, 'recall': 0.5556069423870148, 'f1-score': 0.5489073660229894, 'support': 425963}}
[[ 49300  42944  32639]
 [ 23358 121725  31119]
 [ 15860  43375  65643]]
Evaluating performance on  val set...
517/517 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9070293
{'0': {'precision': 0.4262212258044144, 'recall': 0.5377260776033782, 'f1-score': 0.4755244755244756, 'support': 25102}, '1': {'precision': 0.835121492283476, 'recall': 0.5650939007370045, 'f1-score': 0.6740706665790455, 'support': 81682}, '2': {'precision': 0.3811566009373066, 'recall': 0.6790327662255828, 'f1-score': 0.4882482867984369, 'support': 25392}, 'accuracy': 0.5817848928701126, 'macro avg': {'precision': 0.547499773008399, 'recall': 0.5939509148553218, 'f1-score': 0.545947809633986, 'support': 132176}, 'weighted avg': {'precision': 0.6702557752832691, 'recall': 0.5817848928701126, 'f1-score': 0.6006662031723679, 'support': 132176}}
[[13498  4972  6632]
 [14162 46158 21362]
 [ 4009  4141 17242]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.91491765
{'0': {'precision': 0.49774091525204933, 'recall': 0.47581292034306166, 'f1-score': 0.4865299684542587, 'support': 32414}, '1': {'precision': 0.7397267819764239, 'recall': 0.6006172103285825, 'f1-score': 0.6629531504550018, 'support': 67076}, '2': {'precision': 0.4488315356959425, 'recall': 0.6416508596952823, 'f1-score': 0.528194021205329, 'support': 32686}, 'accuracy': 0.5801582738167292, 'macro avg': {'precision': 0.5620997443081386, 'recall': 0.5726936634556422, 'f1-score': 0.5592257133715298, 'support': 132176}, 'weighted avg': {'precision': 0.608447791055775, 'recall': 0.5801582738167292, 'f1-score': 0.5863634676076854, 'support': 132176}}
[[15423  7515  9476]
 [10510 40287 16279]
 [ 5053  6660 20973]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.92801696
{'0': {'precision': 0.5284298554637342, 'recall': 0.4308609164854635, 'f1-score': 0.4746835443037975, 'support': 37251}, '1': {'precision': 0.6589822935931006, 'recall': 0.6271718104665145, 'f1-score': 0.6426836672738313, 'support': 57383}, '2': {'precision': 0.4832591650773469, 'recall': 0.6074529859890256, 'f1-score': 0.5382854175518104, 'support': 37542}, 'accuracy': 0.5662450066577897, 'macro avg': {'precision': 0.5568904380447273, 'recall': 0.5551619043136679, 'f1-score': 0.551884209709813, 'support': 132176}, 'weighted avg': {'precision': 0.5722781524215154, 'recall': 0.5662450066577897, 'f1-score': 0.5656841236969276, 'support': 132176}}
[[16050  9665 11536]
 [ 8545 35989 12849]
 [ 5778  8959 22805]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.96743095
{'0': {'precision': 0.545980729290797, 'recall': 0.3691698512822874, 'f1-score': 0.44049499375077256, 'support': 43438}, '1': {'precision': 0.528377617551443, 'recall': 0.6500067027123643, 'f1-score': 0.5829150762880815, 'support': 44758}, '2': {'precision': 0.5080847855227882, 'recall': 0.551568894952251, 'f1-score': 0.5289346299768872, 'support': 43980}, 'accuracy': 0.524959145381915, 'macro avg': {'precision': 0.5274810441216761, 'recall': 0.5235818163156343, 'f1-score': 0.5174482333385804, 'support': 132176}, 'weighted avg': {'precision': 0.5274104617524615, 'recall': 0.524959145381915, 'f1-score': 0.5181491310784976, 'support': 132176}}
[[16036 13156 14246]
 [ 6425 29093  9240]
 [ 6910 12812 24258]]
training model: results/WBA/W5/deepVOL_L3/seq2seq
Epoch 1/50
1664/1664 - 73s - loss: 11.9932 - accuracy10: 0.4867 - accuracy20: 0.4941 - accuracy30: 0.4919 - accuracy50: 0.4776 - val_loss: 12.6854 - val_accuracy10: 0.5584 - val_accuracy20: 0.5489 - val_accuracy30: 0.5284 - val_accuracy50: 0.4835 - 73s/epoch - 44ms/step
Epoch 2/50
1664/1664 - 67s - loss: 10.9726 - accuracy10: 0.5421 - accuracy20: 0.5514 - accuracy30: 0.5478 - accuracy50: 0.5267 - val_loss: 12.5661 - val_accuracy10: 0.5967 - val_accuracy20: 0.5800 - val_accuracy30: 0.5543 - val_accuracy50: 0.4995 - 67s/epoch - 40ms/step
Epoch 3/50
1664/1664 - 65s - loss: 10.5767 - accuracy10: 0.5810 - accuracy20: 0.5830 - accuracy30: 0.5731 - accuracy50: 0.5451 - val_loss: 12.2384 - val_accuracy10: 0.5785 - val_accuracy20: 0.5732 - val_accuracy30: 0.5553 - val_accuracy50: 0.5091 - 65s/epoch - 39ms/step
Epoch 4/50
1664/1664 - 66s - loss: 10.3918 - accuracy10: 0.5916 - accuracy20: 0.5938 - accuracy30: 0.5829 - accuracy50: 0.5528 - val_loss: 12.0893 - val_accuracy10: 0.5748 - val_accuracy20: 0.5727 - val_accuracy30: 0.5571 - val_accuracy50: 0.5154 - 66s/epoch - 40ms/step
Epoch 5/50
1664/1664 - 65s - loss: 10.2689 - accuracy10: 0.5989 - accuracy20: 0.5994 - accuracy30: 0.5872 - accuracy50: 0.5564 - val_loss: 12.0390 - val_accuracy10: 0.5838 - val_accuracy20: 0.5823 - val_accuracy30: 0.5646 - val_accuracy50: 0.5180 - 65s/epoch - 39ms/step
Epoch 6/50
1664/1664 - 65s - loss: 10.1904 - accuracy10: 0.6047 - accuracy20: 0.6034 - accuracy30: 0.5899 - accuracy50: 0.5588 - val_loss: 11.8727 - val_accuracy10: 0.5669 - val_accuracy20: 0.5706 - val_accuracy30: 0.5595 - val_accuracy50: 0.5223 - 65s/epoch - 39ms/step
Epoch 7/50
1664/1664 - 64s - loss: 10.1277 - accuracy10: 0.6072 - accuracy20: 0.6055 - accuracy30: 0.5923 - accuracy50: 0.5607 - val_loss: 11.9503 - val_accuracy10: 0.5856 - val_accuracy20: 0.5817 - val_accuracy30: 0.5645 - val_accuracy50: 0.5194 - 64s/epoch - 39ms/step
Epoch 8/50
1664/1664 - 68s - loss: 10.0760 - accuracy10: 0.6108 - accuracy20: 0.6087 - accuracy30: 0.5953 - accuracy50: 0.5625 - val_loss: 11.9024 - val_accuracy10: 0.5912 - val_accuracy20: 0.5841 - val_accuracy30: 0.5659 - val_accuracy50: 0.5197 - 68s/epoch - 41ms/step
Epoch 9/50
1664/1664 - 64s - loss: 10.0413 - accuracy10: 0.6122 - accuracy20: 0.6103 - accuracy30: 0.5964 - accuracy50: 0.5640 - val_loss: 11.7759 - val_accuracy10: 0.5835 - val_accuracy20: 0.5816 - val_accuracy30: 0.5675 - val_accuracy50: 0.5257 - 64s/epoch - 38ms/step
Epoch 10/50
1664/1664 - 65s - loss: 10.0089 - accuracy10: 0.6140 - accuracy20: 0.6114 - accuracy30: 0.5981 - accuracy50: 0.5654 - val_loss: 11.7398 - val_accuracy10: 0.5949 - val_accuracy20: 0.5881 - val_accuracy30: 0.5696 - val_accuracy50: 0.5259 - 65s/epoch - 39ms/step
Epoch 11/50
1664/1664 - 64s - loss: 9.9775 - accuracy10: 0.6150 - accuracy20: 0.6124 - accuracy30: 0.5989 - accuracy50: 0.5665 - val_loss: 11.8229 - val_accuracy10: 0.5832 - val_accuracy20: 0.5798 - val_accuracy30: 0.5647 - val_accuracy50: 0.5238 - 64s/epoch - 39ms/step
Epoch 12/50
1664/1664 - 64s - loss: 9.9527 - accuracy10: 0.6166 - accuracy20: 0.6137 - accuracy30: 0.6000 - accuracy50: 0.5673 - val_loss: 11.7596 - val_accuracy10: 0.5788 - val_accuracy20: 0.5773 - val_accuracy30: 0.5635 - val_accuracy50: 0.5264 - 64s/epoch - 39ms/step
Epoch 13/50
1664/1664 - 65s - loss: 9.9300 - accuracy10: 0.6169 - accuracy20: 0.6146 - accuracy30: 0.6014 - accuracy50: 0.5683 - val_loss: 11.5861 - val_accuracy10: 0.5725 - val_accuracy20: 0.5770 - val_accuracy30: 0.5658 - val_accuracy50: 0.5302 - 65s/epoch - 39ms/step
Epoch 14/50
1664/1664 - 67s - loss: 9.9029 - accuracy10: 0.6177 - accuracy20: 0.6156 - accuracy30: 0.6022 - accuracy50: 0.5688 - val_loss: 11.6340 - val_accuracy10: 0.5731 - val_accuracy20: 0.5764 - val_accuracy30: 0.5653 - val_accuracy50: 0.5300 - 67s/epoch - 40ms/step
Epoch 15/50
1664/1664 - 63s - loss: 9.8862 - accuracy10: 0.6180 - accuracy20: 0.6164 - accuracy30: 0.6030 - accuracy50: 0.5699 - val_loss: 11.6093 - val_accuracy10: 0.5719 - val_accuracy20: 0.5760 - val_accuracy30: 0.5663 - val_accuracy50: 0.5305 - 63s/epoch - 38ms/step
Epoch 16/50
1664/1664 - 65s - loss: 9.8643 - accuracy10: 0.6187 - accuracy20: 0.6167 - accuracy30: 0.6037 - accuracy50: 0.5706 - val_loss: 11.6357 - val_accuracy10: 0.5738 - val_accuracy20: 0.5767 - val_accuracy30: 0.5660 - val_accuracy50: 0.5294 - 65s/epoch - 39ms/step
Epoch 17/50
1664/1664 - 64s - loss: 9.8495 - accuracy10: 0.6200 - accuracy20: 0.6179 - accuracy30: 0.6042 - accuracy50: 0.5703 - val_loss: 11.6619 - val_accuracy10: 0.5707 - val_accuracy20: 0.5759 - val_accuracy30: 0.5652 - val_accuracy50: 0.5284 - 64s/epoch - 38ms/step
Epoch 18/50
1664/1664 - 65s - loss: 9.8306 - accuracy10: 0.6204 - accuracy20: 0.6184 - accuracy30: 0.6045 - accuracy50: 0.5713 - val_loss: 11.6549 - val_accuracy10: 0.5598 - val_accuracy20: 0.5685 - val_accuracy30: 0.5604 - val_accuracy50: 0.5299 - 65s/epoch - 39ms/step
Epoch 19/50
1664/1664 - 67s - loss: 9.8128 - accuracy10: 0.6209 - accuracy20: 0.6193 - accuracy30: 0.6063 - accuracy50: 0.5728 - val_loss: 11.6154 - val_accuracy10: 0.5763 - val_accuracy20: 0.5793 - val_accuracy30: 0.5674 - val_accuracy50: 0.5317 - 67s/epoch - 40ms/step
Epoch 20/50
1664/1664 - 66s - loss: 9.7952 - accuracy10: 0.6217 - accuracy20: 0.6195 - accuracy30: 0.6066 - accuracy50: 0.5734 - val_loss: 11.5974 - val_accuracy10: 0.5738 - val_accuracy20: 0.5774 - val_accuracy30: 0.5669 - val_accuracy50: 0.5332 - 66s/epoch - 40ms/step
Epoch 21/50
1664/1664 - 64s - loss: 9.7820 - accuracy10: 0.6213 - accuracy20: 0.6198 - accuracy30: 0.6070 - accuracy50: 0.5744 - val_loss: 11.6788 - val_accuracy10: 0.5698 - val_accuracy20: 0.5739 - val_accuracy30: 0.5636 - val_accuracy50: 0.5298 - 64s/epoch - 38ms/step
Epoch 22/50
1664/1664 - 64s - loss: 9.7678 - accuracy10: 0.6228 - accuracy20: 0.6203 - accuracy30: 0.6079 - accuracy50: 0.5748 - val_loss: 11.6438 - val_accuracy10: 0.5674 - val_accuracy20: 0.5716 - val_accuracy30: 0.5626 - val_accuracy50: 0.5293 - 64s/epoch - 38ms/step
Epoch 23/50
1664/1664 - 63s - loss: 9.7500 - accuracy10: 0.6225 - accuracy20: 0.6206 - accuracy30: 0.6081 - accuracy50: 0.5758 - val_loss: 11.7034 - val_accuracy10: 0.5720 - val_accuracy20: 0.5754 - val_accuracy30: 0.5662 - val_accuracy50: 0.5314 - 63s/epoch - 38ms/step
testing model: results/WBA/W5/deepVOL_L3/seq2seq
Evaluating performance on  test set...
7459/7459 - 123s - 123s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0748014
{'0': {'precision': 0.41785701974174794, 'recall': 0.5535409130784853, 'f1-score': 0.476222871038179, 'support': 416065}, '1': {'precision': 0.7940533000513912, 'recall': 0.35743198648652474, 'f1-score': 0.49296339559299035, 'support': 1059091}, '2': {'precision': 0.35995615811670517, 'recall': 0.7308238979946786, 'f1-score': 0.4823420837375061, 'support': 434095}, 'accuracy': 0.48506403820136795, 'macro avg': {'precision': 0.5239554926366148, 'recall': 0.5472655991865629, 'f1-score': 0.48384278345622517, 'support': 1909251}, 'weighted avg': {'precision': 0.6133743300285031, 'recall': 0.48506403820136795, 'f1-score': 0.48690038726207735, 'support': 1909251}}
[[230309  58712 127044]
 [243480 378553 437058]
 [ 77378  39470 317247]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0482635
{'0': {'precision': 0.4784683367473237, 'recall': 0.4979998267269858, 'f1-score': 0.48803874556794036, 'support': 530954}, '1': {'precision': 0.6734228217799741, 'recall': 0.368283421737262, 'f1-score': 0.4761619940832919, 'support': 821419}, '2': {'precision': 0.4266913378069061, 'recall': 0.6952707774413786, 'f1-score': 0.528834287954293, 'support': 556878}, 'accuracy': 0.49973052259760503, 'macro avg': {'precision': 0.5261941654447347, 'recall': 0.5205180086352087, 'f1-score': 0.4976783425351751, 'support': 1909251}, 'weighted avg': {'precision': 0.547241822541016, 'recall': 0.49973052259760503, 'f1-score': 0.4948279790030722, 'support': 1909251}}
[[264415  83812 182727]
 [181409 302515 337495]
 [106804  62893 387181]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0327507
{'0': {'precision': 0.5047902720628876, 'recall': 0.46024261867432575, 'f1-score': 0.4814882454795275, 'support': 607208}, '1': {'precision': 0.5745124181464221, 'recall': 0.36606008483024177, 'f1-score': 0.4471873542063868, 'support': 665093}, '2': {'precision': 0.4587317326533985, 'recall': 0.6711217520998508, 'f1-score': 0.5449641892804965, 'support': 636950}, 'accuracy': 0.49778578091618125, 'macro avg': {'precision': 0.512678140954236, 'recall': 0.4991414852014728, 'f1-score': 0.4912132629888036, 'support': 1909251}, 'weighted avg': {'precision': 0.5137124748682087, 'recall': 0.49778578091618125, 'f1-score': 0.4907158010625809, 'support': 1909251}}
[[279463 100089 227656]
 [144902 243464 276727]
 [129257  80222 427471]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0218012
{'0': {'precision': 0.5214465999606602, 'recall': 0.4052008605247144, 'f1-score': 0.4560323532556227, 'support': 700038}, '1': {'precision': 0.42572455627948774, 'recall': 0.3564328499830709, 'f1-score': 0.38800941009446493, 'support': 478466}, '2': {'precision': 0.4838838083430602, 'recall': 0.6387901695114725, 'f1-score': 0.5506500124747189, 'support': 730747}, 'accuracy': 0.482383405848681, 'macro avg': {'precision': 0.477018321527736, 'recall': 0.4668079600064193, 'f1-score': 0.46489725860826886, 'support': 1909251}, 'weighted avg': {'precision': 0.483081481577513, 'recall': 0.482383405848681, 'f1-score': 0.4751995057666495, 'support': 1909251}}
[[283656 124092 292290]
 [102327 170541 205598]
 [157996 105957 466794]]
Evaluating performance on  train set...
1664/1664 - 28s - 28s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.81553465
{'0': {'precision': 0.443965570932101, 'recall': 0.5342827162344476, 'f1-score': 0.4849548611819771, 'support': 66710}, '1': {'precision': 0.8789620399634697, 'recall': 0.6297450900458023, 'f1-score': 0.7337700180421836, 'support': 291907}, '2': {'precision': 0.3579730630360112, 'recall': 0.7257743592789475, 'f1-score': 0.4794616625876098, 'support': 67346}, 'accuracy': 0.629977251545322, 'macro avg': {'precision': 0.5603002246438605, 'recall': 0.6299340551863991, 'f1-score': 0.5660621806039235, 'support': 425963}, 'weighted avg': {'precision': 0.7284674240244344, 'recall': 0.629977251545322, 'f1-score': 0.654596217452489, 'support': 425963}}
[[ 35642  15492  15576]
 [ 35993 183827  72087]
 [  8646   9822  48878]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8257942
{'0': {'precision': 0.5235075089983865, 'recall': 0.47755938497769523, 'f1-score': 0.4994789569665821, 'support': 88322}, '1': {'precision': 0.7997735522652063, 'recall': 0.6617678989312511, 'f1-score': 0.7242551524899392, 'support': 248702}, '2': {'precision': 0.4316003610160022, 'recall': 0.6774755731456391, 'f1-score': 0.5272834671508894, 'support': 88939}, 'accuracy': 0.6268525670069935, 'macro avg': {'precision': 0.5849604740931983, 'recall': 0.6056009523515286, 'f1-score': 0.5836725255358036, 'support': 425963}, 'weighted avg': {'precision': 0.6656179450178046, 'recall': 0.6268525670069935, 'f1-score': 0.6365218332500435, 'support': 425963}}
[[ 42179  24186  21957]
 [ 26724 164583  57395]
 [ 11667  17018  60254]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.85179645
{'0': {'precision': 0.5583118195083623, 'recall': 0.4317999864960019, 'f1-score': 0.48697335929596314, 'support': 103673}, '1': {'precision': 0.726523066087569, 'recall': 0.6807389313816697, 'f1-score': 0.7028862237763892, 'support': 218207}, '2': {'precision': 0.46819410441107795, 'recall': 0.6357234130453581, 'f1-score': 0.5392467268926567, 'support': 104083}, 'accuracy': 0.6091514990738632, 'macro avg': {'precision': 0.5843429966690031, 'recall': 0.5827541103076767, 'f1-score': 0.5763687699883363, 'support': 425963}, 'weighted avg': {'precision': 0.622460934201043, 'recall': 0.6091514990738632, 'f1-score': 0.610351369450007, 'support': 425963}}
[[ 44766  32008  26899]
 [ 21406 148542  48259]
 [ 14009  23906  66168]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9084052
{'0': {'precision': 0.579264878073614, 'recall': 0.36445312812792774, 'f1-score': 0.4474109753999656, 'support': 124883}, '1': {'precision': 0.6047133462587753, 'recall': 0.6956561219509426, 'f1-score': 0.6470046423490972, 'support': 176202}, '2': {'precision': 0.4973253161932407, 'recall': 0.5762263969634364, 'f1-score': 0.5338764245014246, 'support': 124878}, 'accuracy': 0.5635419038742802, 'macro avg': {'precision': 0.5604345135085433, 'recall': 0.5454452156807689, 'f1-score': 0.5427640140834957, 'support': 425963}, 'weighted avg': {'precision': 0.5657698617991126, 'recall': 0.5635419038742802, 'f1-score': 0.5553227791403441, 'support': 425963}}
[[ 45514  44413  34956]
 [ 15850 122576  37776]
 [ 17208  35712  71958]]
Evaluating performance on  val set...
517/517 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.92500496
{'0': {'precision': 0.4414304167516486, 'recall': 0.5173292964704007, 'f1-score': 0.4763756419662509, 'support': 25102}, '1': {'precision': 0.851976466969161, 'recall': 0.5425063049386646, 'f1-score': 0.6629018504944125, 'support': 81682}, '2': {'precision': 0.3636739841563867, 'recall': 0.7268037177063642, 'f1-score': 0.48477764059996314, 'support': 25392}, 'accuracy': 0.5731297663721099, 'macro avg': {'precision': 0.5523602892923988, 'recall': 0.5955464397051432, 'f1-score': 0.5413517110202088, 'support': 132176}, 'weighted avg': {'precision': 0.6802016848896462, 'recall': 0.5731297663721099, 'f1-score': 0.5932590195408826, 'support': 132176}}
[[12986  4766  7350]
 [12428 44313 24941]
 [ 4004  2933 18455]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9172104
{'0': {'precision': 0.508757014113246, 'recall': 0.4615289689640279, 'f1-score': 0.4839935942024297, 'support': 32414}, '1': {'precision': 0.7623076319095478, 'recall': 0.5789701234420657, 'f1-score': 0.6581087951194712, 'support': 67076}, '2': {'precision': 0.43448395623902597, 'recall': 0.688918803157315, 'f1-score': 0.5328884313655887, 'support': 32686}, 'accuracy': 0.5773589759109067, 'macro avg': {'precision': 0.5685162007539399, 'recall': 0.5764726318544695, 'f1-score': 0.5583302735624965, 'support': 132176}, 'weighted avg': {'precision': 0.6190604887956996, 'recall': 0.5773589759109067, 'f1-score': 0.5844439623799089, 'support': 132176}}
[[14960  7195 10259]
 [ 9191 38835 19050]
 [ 5254  4914 22518]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.92355067
{'0': {'precision': 0.5375995080118897, 'recall': 0.4224047676572441, 'f1-score': 0.4730907997594708, 'support': 37251}, '1': {'precision': 0.686322442165514, 'recall': 0.6017984420472963, 'f1-score': 0.6412872914326038, 'support': 57383}, '2': {'precision': 0.4681599513224696, 'recall': 0.6558254754674764, 'f1-score': 0.5463259849333761, 'support': 37542}, 'accuracy': 0.5665854618084978, 'macro avg': {'precision': 0.5640273004999578, 'recall': 0.5600095617240056, 'f1-score': 0.5535680253751503, 'support': 132176}, 'weighted avg': {'precision': 0.58244326401376, 'recall': 0.5665854618084978, 'f1-score': 0.5669127841097171, 'support': 132176}}
[[15735  9119 12397]
 [ 7277 34533 15573]
 [ 6257  6664 24621]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9522042
{'0': {'precision': 0.5509409022922537, 'recall': 0.36463465168746256, 'f1-score': 0.4388324767617438, 'support': 43438}, '1': {'precision': 0.5588916876574307, 'recall': 0.6196657580767684, 'f1-score': 0.5877117701280952, 'support': 44758}, '2': {'precision': 0.4947399724917289, 'recall': 0.6052296498408367, 'f1-score': 0.5444355811908121, 'support': 43980}, 'accuracy': 0.531049509744583, 'macro avg': {'precision': 0.5348575208138044, 'recall': 0.5298433532016892, 'f1-score': 0.5236599426935503, 'support': 132176}, 'weighted avg': {'precision': 0.5349330367096026, 'recall': 0.531049509744583, 'f1-score': 0.5243848005215911, 'support': 132176}}
[[15839 12154 15445]
 [ 5284 27735 11739]
 [ 7626  9736 26618]]
training model: results/WBA/W6/deepLOB_L1/seq2seq
Epoch 1/50
1489/1489 - 40s - loss: 12.3123 - accuracy10: 0.4516 - accuracy20: 0.4635 - accuracy30: 0.4653 - accuracy50: 0.4511 - val_loss: 12.8274 - val_accuracy10: 0.5726 - val_accuracy20: 0.4908 - val_accuracy30: 0.4288 - val_accuracy50: 0.3724 - 40s/epoch - 27ms/step
Epoch 2/50
1489/1489 - 36s - loss: 12.2356 - accuracy10: 0.4361 - accuracy20: 0.4603 - accuracy30: 0.4669 - accuracy50: 0.4519 - val_loss: 12.3609 - val_accuracy10: 0.5112 - val_accuracy20: 0.4918 - val_accuracy30: 0.4645 - val_accuracy50: 0.4221 - 36s/epoch - 24ms/step
Epoch 3/50
1489/1489 - 35s - loss: 12.0382 - accuracy10: 0.4545 - accuracy20: 0.4774 - accuracy30: 0.4833 - accuracy50: 0.4666 - val_loss: 12.5449 - val_accuracy10: 0.5625 - val_accuracy20: 0.5147 - val_accuracy30: 0.4684 - val_accuracy50: 0.4142 - 35s/epoch - 23ms/step
Epoch 4/50
1489/1489 - 33s - loss: 11.7646 - accuracy10: 0.4969 - accuracy20: 0.5065 - accuracy30: 0.5052 - accuracy50: 0.4830 - val_loss: 12.4749 - val_accuracy10: 0.5915 - val_accuracy20: 0.5370 - val_accuracy30: 0.4884 - val_accuracy50: 0.4327 - 33s/epoch - 22ms/step
Epoch 5/50
1489/1489 - 35s - loss: 11.6080 - accuracy10: 0.5165 - accuracy20: 0.5206 - accuracy30: 0.5161 - accuracy50: 0.4907 - val_loss: 12.4256 - val_accuracy10: 0.5953 - val_accuracy20: 0.5445 - val_accuracy30: 0.4971 - val_accuracy50: 0.4396 - 35s/epoch - 23ms/step
Epoch 6/50
1489/1489 - 36s - loss: 11.5055 - accuracy10: 0.5275 - accuracy20: 0.5297 - accuracy30: 0.5226 - accuracy50: 0.4955 - val_loss: 12.3349 - val_accuracy10: 0.6008 - val_accuracy20: 0.5504 - val_accuracy30: 0.5010 - val_accuracy50: 0.4425 - 36s/epoch - 24ms/step
Epoch 7/50
1489/1489 - 36s - loss: 11.4391 - accuracy10: 0.5328 - accuracy20: 0.5338 - accuracy30: 0.5251 - accuracy50: 0.4973 - val_loss: 12.3057 - val_accuracy10: 0.6119 - val_accuracy20: 0.5539 - val_accuracy30: 0.5028 - val_accuracy50: 0.4431 - 36s/epoch - 24ms/step
Epoch 8/50
1489/1489 - 36s - loss: 11.3820 - accuracy10: 0.5385 - accuracy20: 0.5379 - accuracy30: 0.5289 - accuracy50: 0.5003 - val_loss: 12.3098 - val_accuracy10: 0.6130 - val_accuracy20: 0.5558 - val_accuracy30: 0.5056 - val_accuracy50: 0.4458 - 36s/epoch - 24ms/step
Epoch 9/50
1489/1489 - 32s - loss: 11.3363 - accuracy10: 0.5419 - accuracy20: 0.5418 - accuracy30: 0.5324 - accuracy50: 0.5026 - val_loss: 12.3442 - val_accuracy10: 0.6151 - val_accuracy20: 0.5566 - val_accuracy30: 0.5044 - val_accuracy50: 0.4433 - 32s/epoch - 22ms/step
Epoch 10/50
1489/1489 - 33s - loss: 11.3017 - accuracy10: 0.5438 - accuracy20: 0.5437 - accuracy30: 0.5338 - accuracy50: 0.5032 - val_loss: 12.5004 - val_accuracy10: 0.6156 - val_accuracy20: 0.5545 - val_accuracy30: 0.5008 - val_accuracy50: 0.4394 - 33s/epoch - 22ms/step
Epoch 11/50
1489/1489 - 33s - loss: 11.2661 - accuracy10: 0.5461 - accuracy20: 0.5457 - accuracy30: 0.5356 - accuracy50: 0.5051 - val_loss: 12.4812 - val_accuracy10: 0.6119 - val_accuracy20: 0.5530 - val_accuracy30: 0.4997 - val_accuracy50: 0.4370 - 33s/epoch - 22ms/step
Epoch 12/50
1489/1489 - 31s - loss: 11.2425 - accuracy10: 0.5486 - accuracy20: 0.5474 - accuracy30: 0.5371 - accuracy50: 0.5062 - val_loss: 12.4998 - val_accuracy10: 0.6141 - val_accuracy20: 0.5561 - val_accuracy30: 0.5034 - val_accuracy50: 0.4402 - 31s/epoch - 21ms/step
Epoch 13/50
1489/1489 - 32s - loss: 11.2186 - accuracy10: 0.5502 - accuracy20: 0.5483 - accuracy30: 0.5378 - accuracy50: 0.5070 - val_loss: 12.5617 - val_accuracy10: 0.6176 - val_accuracy20: 0.5555 - val_accuracy30: 0.4987 - val_accuracy50: 0.4349 - 32s/epoch - 22ms/step
Epoch 14/50
1489/1489 - 32s - loss: 11.1977 - accuracy10: 0.5509 - accuracy20: 0.5497 - accuracy30: 0.5387 - accuracy50: 0.5077 - val_loss: 12.7256 - val_accuracy10: 0.6186 - val_accuracy20: 0.5577 - val_accuracy30: 0.5024 - val_accuracy50: 0.4377 - 32s/epoch - 21ms/step
Epoch 15/50
1489/1489 - 33s - loss: 11.1771 - accuracy10: 0.5519 - accuracy20: 0.5505 - accuracy30: 0.5407 - accuracy50: 0.5088 - val_loss: 12.6352 - val_accuracy10: 0.6202 - val_accuracy20: 0.5571 - val_accuracy30: 0.5009 - val_accuracy50: 0.4383 - 33s/epoch - 22ms/step
Epoch 16/50
1489/1489 - 32s - loss: 11.1554 - accuracy10: 0.5538 - accuracy20: 0.5525 - accuracy30: 0.5416 - accuracy50: 0.5098 - val_loss: 12.7358 - val_accuracy10: 0.6197 - val_accuracy20: 0.5559 - val_accuracy30: 0.5012 - val_accuracy50: 0.4381 - 32s/epoch - 21ms/step
Epoch 17/50
1489/1489 - 36s - loss: 11.1349 - accuracy10: 0.5544 - accuracy20: 0.5531 - accuracy30: 0.5423 - accuracy50: 0.5111 - val_loss: 13.0143 - val_accuracy10: 0.6190 - val_accuracy20: 0.5531 - val_accuracy30: 0.4972 - val_accuracy50: 0.4354 - 36s/epoch - 24ms/step
testing model: results/WBA/W6/deepLOB_L1/seq2seq
Evaluating performance on  test set...
5183/5183 - 52s - 52s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.94393134
{'0': {'precision': 0.440459348860173, 'recall': 0.30431973235371296, 'f1-score': 0.3599469279919927, 'support': 304880}, '1': {'precision': 0.5769934301272162, 'recall': 0.8462498184929914, 'f1-score': 0.6861519785745394, 'support': 709339}, '2': {'precision': 0.49304447579741295, 'recall': 0.11960808774842381, 'f1-score': 0.1925140297585337, 'support': 312621}, 'accuracy': 0.5505192788881854, 'macro avg': {'precision': 0.5034990849282673, 'recall': 0.4233925461983761, 'f1-score': 0.41287097877502194, 'support': 1326840}, 'weighted avg': {'precision': 0.5258412816027268, 'recall': 0.5505192788881854, 'f1-score': 0.4948892905199017, 'support': 1326840}}
[[ 92781 200573  11526]
 [ 82140 600278  26921]
 [ 35725 239504  37392]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0493585
{'0': {'precision': 0.4998429672496615, 'recall': 0.2553572602811789, 'f1-score': 0.33802566798743755, 'support': 380185}, '1': {'precision': 0.45964694389119026, 'recall': 0.864799784850865, 'f1-score': 0.600254535812101, 'support': 561471}, '2': {'precision': 0.5466899274630429, 'recall': 0.10820283293179364, 'f1-score': 0.1806506422551206, 'support': 385184}, 'accuracy': 0.47053224201863075, 'macro avg': {'precision': 0.5020599462012982, 'recall': 0.4094532926879458, 'f1-score': 0.3729769486848864, 'support': 1326840}, 'weighted avg': {'precision': 0.4964332103021222, 'recall': 0.47053224201863075, 'f1-score': 0.40330525161071157, 'support': 1326840}}
[[ 97083 268751  14351]
 [ 55703 485560  20208]
 [ 41441 302065  41678]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1094406
{'0': {'precision': 0.5202722989514528, 'recall': 0.21104566054970664, 'f1-score': 0.30028309730782626, 'support': 426955}, '1': {'precision': 0.3817420255013033, 'recall': 0.8792067641986984, 'f1-score': 0.5323454429572976, 'support': 467402}, '2': {'precision': 0.5717007543354848, 'recall': 0.10199013602846817, 'f1-score': 0.17309967682880167, 'support': 432483}, 'accuracy': 0.4108701878146574, 'macro avg': {'precision': 0.4912383595960803, 'recall': 0.3974141869256243, 'f1-score': 0.33524273903130847, 'support': 1326840}, 'weighted avg': {'precision': 0.48823573523518377, 'recall': 0.4108701878146574, 'f1-score': 0.3405756248486181, 'support': 1326840}}
[[ 90107 320355  16493]
 [ 39907 410943  16552]
 [ 43178 345196  44109]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1538864
{'0': {'precision': 0.5015474131361127, 'recall': 0.165810759887476, 'f1-score': 0.24922735961984616, 'support': 456436}, '1': {'precision': 0.32743015671618697, 'recall': 0.8811970438885065, 'f1-score': 0.47745158479620264, 'support': 408239}, '2': {'precision': 0.5535725840893502, 'recall': 0.09255136152672747, 'f1-score': 0.1585884464086431, 'support': 462165}, 'accuracy': 0.3604014048415785, 'macro avg': {'precision': 0.4608500513138833, 'recall': 0.37985305510090334, 'f1-score': 0.2950891302748973, 'support': 1326840}, 'weighted avg': {'precision': 0.4660968377012365, 'recall': 0.3604014048415785, 'f1-score': 0.28787549815766156, 'support': 1326840}}
[[ 75682 362542  18212]
 [ 32217 359739  16283]
 [ 42998 376393  42774]]
Evaluating performance on  train set...
1489/1489 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8811987
{'0': {'precision': 0.43345108695652174, 'recall': 0.3975723436604272, 'f1-score': 0.4147371979043434, 'support': 80242}, '1': {'precision': 0.6711623953177176, 'recall': 0.747173433672476, 'f1-score': 0.7071311338421388, 'support': 220851}, '2': {'precision': 0.4342899811700539, 'recall': 0.33453372346012455, 'f1-score': 0.377940075435449, 'support': 79974}, 'accuracy': 0.586957149267714, 'macro avg': {'precision': 0.5129678211480977, 'recall': 0.4930931669310093, 'f1-score': 0.4999361357273104, 'support': 381067}, 'weighted avg': {'precision': 0.5713949915420972, 'recall': 0.586957149267714, 'f1-score': 0.5764743204404609, 'support': 381067}}
[[ 31902  39039   9301]
 [ 30288 165014  25549]
 [ 11410  41810  26754]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9807599
{'0': {'precision': 0.4963106967702028, 'recall': 0.33096316084108385, 'f1-score': 0.3971128918218242, 'support': 101821}, '1': {'precision': 0.5493525740099885, 'recall': 0.7778502874759499, 'f1-score': 0.6439317907149493, 'support': 177754}, '2': {'precision': 0.48906130548642623, 'recall': 0.2962499507350333, 'f1-score': 0.36898589319572195, 'support': 101492}, 'accuracy': 0.5301744837522011, 'macro avg': {'precision': 0.5115748587555392, 'recall': 0.46835446635068906, 'f1-score': 0.4700101919108319, 'support': 381067}, 'weighted avg': {'precision': 0.5191220413020248, 'recall': 0.5301744837522011, 'f1-score': 0.5047537560511807, 'support': 381067}}
[[ 33699  55524  12598]
 [ 20674 138266  18814]
 [ 13526  57899  30067]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0465896
{'0': {'precision': 0.5266192643462205, 'recall': 0.2797167904059739, 'f1-score': 0.36536689515675913, 'support': 116239}, '1': {'precision': 0.462227187735183, 'recall': 0.7996080878849496, 'f1-score': 0.5858143370920204, 'support': 149013}, '2': {'precision': 0.5130629752388379, 'recall': 0.2726589819971506, 'f1-score': 0.3560832868185585, 'support': 115815}, 'accuracy': 0.4808708179926365, 'macro avg': {'precision': 0.5006364757734137, 'recall': 0.45066128676269135, 'f1-score': 0.43575483968911266, 'support': 381067}, 'weighted avg': {'precision': 0.4973192248911849, 'recall': 0.4808708179926365, 'f1-score': 0.4487494855290831, 'support': 381067}}
[[ 32514  68850  14875]
 [ 14766 119152  15095]
 [ 14461  69776  31578]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.117313
{'0': {'precision': 0.5224203133441383, 'recall': 0.22585718289682663, 'f1-score': 0.3153706502005718, 'support': 128444}, '1': {'precision': 0.3820227268430108, 'recall': 0.8059675296182536, 'f1-score': 0.5183509068985864, 'support': 125345}, '2': {'precision': 0.5061873895109016, 'recall': 0.24296422005374063, 'f1-score': 0.3283325370281892, 'support': 127278}, 'accuracy': 0.4223876641115604, 'macro avg': {'precision': 0.47021014323268356, 'recall': 0.42492964418960694, 'f1-score': 0.38735136470911585, 'support': 381067}, 'weighted avg': {'precision': 0.47081723682575566, 'recall': 0.4223876641115604, 'f1-score': 0.38646660788638065, 'support': 381067}}
[[ 29010  82149  17285]
 [ 11438 101024  12883]
 [ 15082  81272  30924]]
Evaluating performance on  val set...
519/519 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.84066975
{'0': {'precision': 0.40912555809648266, 'recall': 0.43801492305300793, 'f1-score': 0.4230776449390965, 'support': 25732}, '1': {'precision': 0.7030500649903635, 'recall': 0.7688056757054809, 'f1-score': 0.734459044218782, 'support': 81611}, '2': {'precision': 0.45811141048937903, 'recall': 0.2877326931402259, 'f1-score': 0.3534616128408432, 'support': 25409}, 'accuracy': 0.6126084729420272, 'macro avg': {'precision': 0.5234290111920751, 'recall': 0.4981844306329049, 'f1-score': 0.5036661006662406, 'support': 132752}, 'weighted avg': {'precision': 0.599195421116005, 'recall': 0.6126084729420272, 'f1-score': 0.6011787177442512, 'support': 132752}}
[[11271 12375  2086]
 [12306 62743  6562]
 [ 3972 14126  7311]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9378512
{'0': {'precision': 0.46887999066982855, 'recall': 0.3663618966617053, 'f1-score': 0.41132937725939567, 'support': 32921}, '1': {'precision': 0.5867353664967481, 'recall': 0.7948771376266949, 'f1-score': 0.6751278339959421, 'support': 67189}, '2': {'precision': 0.5119650109340831, 'recall': 0.251026285154096, 'f1-score': 0.3368758607930602, 'support': 32642}, 'accuracy': 0.5548842955285043, 'macro avg': {'precision': 0.5225267893668866, 'recall': 0.470755106480832, 'f1-score': 0.47444435734946605, 'support': 132752}, 'weighted avg': {'precision': 0.539123497945807, 'recall': 0.5548842955285043, 'f1-score': 0.5265370036995073, 'support': 132752}}
[[12061 18054  2806]
 [ 8777 53407  5005]
 [ 4885 19563  8194]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.005983
{'0': {'precision': 0.49923735276671466, 'recall': 0.31040569020021075, 'f1-score': 0.3828010785874403, 'support': 37960}, '1': {'precision': 0.49847587154387774, 'recall': 0.8139009130579555, 'f1-score': 0.6182827549940424, 'support': 57061}, '2': {'precision': 0.5380427981479164, 'recall': 0.22790278550793777, 'f1-score': 0.3201831958743694, 'support': 37731}, 'accuracy': 0.5033747137519585, 'macro avg': {'precision': 0.5119186741528363, 'recall': 0.45073646292203473, 'f1-score': 0.4404223431519507, 'support': 132752}, 'weighted avg': {'precision': 0.5099393940137154, 'recall': 0.5033747137519585, 'f1-score': 0.4662211747426036, 'support': 132752}}
[[11783 22839  3338]
 [ 6574 46442  4045]
 [ 5245 23887  8599]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0778592
{'0': {'precision': 0.5042382803353159, 'recall': 0.25390274961090414, 'f1-score': 0.33774055427469063, 'support': 42406}, '1': {'precision': 0.4144601253308504, 'recall': 0.820040984454886, 'f1-score': 0.550626137958832, 'support': 48311}, '2': {'precision': 0.5350999241082722, 'recall': 0.20128464374925656, 'f1-score': 0.29253029543450826, 'support': 42035}, 'accuracy': 0.4432701578883934, 'macro avg': {'precision': 0.4845994432581462, 'recall': 0.4250761259383489, 'f1-score': 0.39363232922267694, 'support': 132752}, 'weighted avg': {'precision': 0.48133841253351617, 'recall': 0.4432701578883934, 'f1-score': 0.4008981880807161, 'support': 132752}}
[[10767 27773  3866]
 [ 5209 39617  3485]
 [ 5377 28197  8461]]
training model: results/WBA/W6/deepOF_L1/seq2seq
Epoch 1/50
1489/1489 - 41s - loss: 12.8679 - accuracy10: 0.4070 - accuracy20: 0.4152 - accuracy30: 0.4185 - accuracy50: 0.4127 - val_loss: 12.9266 - val_accuracy10: 0.5905 - val_accuracy20: 0.5053 - val_accuracy30: 0.4365 - val_accuracy50: 0.3699 - 41s/epoch - 27ms/step
Epoch 2/50
1489/1489 - 33s - loss: 12.8310 - accuracy10: 0.3966 - accuracy20: 0.4091 - accuracy30: 0.4127 - accuracy50: 0.4063 - val_loss: 12.6610 - val_accuracy10: 0.5745 - val_accuracy20: 0.5045 - val_accuracy30: 0.4432 - val_accuracy50: 0.3776 - 33s/epoch - 22ms/step
Epoch 3/50
1489/1489 - 31s - loss: 12.7671 - accuracy10: 0.4101 - accuracy20: 0.4183 - accuracy30: 0.4189 - accuracy50: 0.4100 - val_loss: 12.5844 - val_accuracy10: 0.5659 - val_accuracy20: 0.5039 - val_accuracy30: 0.4471 - val_accuracy50: 0.3823 - 31s/epoch - 21ms/step
Epoch 4/50
1489/1489 - 31s - loss: 12.7243 - accuracy10: 0.4158 - accuracy20: 0.4216 - accuracy30: 0.4220 - accuracy50: 0.4128 - val_loss: 12.5455 - val_accuracy10: 0.5661 - val_accuracy20: 0.5052 - val_accuracy30: 0.4501 - val_accuracy50: 0.3871 - 31s/epoch - 21ms/step
Epoch 5/50
1489/1489 - 33s - loss: 12.6901 - accuracy10: 0.4247 - accuracy20: 0.4270 - accuracy30: 0.4256 - accuracy50: 0.4158 - val_loss: 12.5301 - val_accuracy10: 0.5706 - val_accuracy20: 0.5068 - val_accuracy30: 0.4508 - val_accuracy50: 0.3903 - 33s/epoch - 22ms/step
Epoch 6/50
1489/1489 - 28s - loss: 12.6637 - accuracy10: 0.4304 - accuracy20: 0.4303 - accuracy30: 0.4285 - accuracy50: 0.4188 - val_loss: 12.5263 - val_accuracy10: 0.5745 - val_accuracy20: 0.5090 - val_accuracy30: 0.4521 - val_accuracy50: 0.3893 - 28s/epoch - 19ms/step
Epoch 7/50
1489/1489 - 29s - loss: 12.6339 - accuracy10: 0.4330 - accuracy20: 0.4320 - accuracy30: 0.4305 - accuracy50: 0.4211 - val_loss: 12.5211 - val_accuracy10: 0.5778 - val_accuracy20: 0.5115 - val_accuracy30: 0.4533 - val_accuracy50: 0.3892 - 29s/epoch - 20ms/step
Epoch 8/50
1489/1489 - 31s - loss: 12.6032 - accuracy10: 0.4394 - accuracy20: 0.4377 - accuracy30: 0.4352 - accuracy50: 0.4242 - val_loss: 12.5203 - val_accuracy10: 0.5869 - val_accuracy20: 0.5147 - val_accuracy30: 0.4549 - val_accuracy50: 0.3904 - 31s/epoch - 21ms/step
Epoch 9/50
1489/1489 - 37s - loss: 12.5708 - accuracy10: 0.4416 - accuracy20: 0.4415 - accuracy30: 0.4395 - accuracy50: 0.4275 - val_loss: 12.5111 - val_accuracy10: 0.5874 - val_accuracy20: 0.5157 - val_accuracy30: 0.4568 - val_accuracy50: 0.3925 - 37s/epoch - 25ms/step
Epoch 10/50
1489/1489 - 30s - loss: 12.5324 - accuracy10: 0.4435 - accuracy20: 0.4453 - accuracy30: 0.4440 - accuracy50: 0.4314 - val_loss: 12.5490 - val_accuracy10: 0.5927 - val_accuracy20: 0.5175 - val_accuracy30: 0.4566 - val_accuracy50: 0.3923 - 30s/epoch - 20ms/step
Epoch 11/50
1489/1489 - 31s - loss: 12.5015 - accuracy10: 0.4445 - accuracy20: 0.4467 - accuracy30: 0.4460 - accuracy50: 0.4345 - val_loss: 12.5586 - val_accuracy10: 0.5958 - val_accuracy20: 0.5189 - val_accuracy30: 0.4579 - val_accuracy50: 0.3941 - 31s/epoch - 21ms/step
Epoch 12/50
1489/1489 - 32s - loss: 12.4693 - accuracy10: 0.4469 - accuracy20: 0.4494 - accuracy30: 0.4495 - accuracy50: 0.4375 - val_loss: 12.6225 - val_accuracy10: 0.5987 - val_accuracy20: 0.5210 - val_accuracy30: 0.4599 - val_accuracy50: 0.3938 - 32s/epoch - 22ms/step
Epoch 13/50
1489/1489 - 32s - loss: 12.4328 - accuracy10: 0.4499 - accuracy20: 0.4527 - accuracy30: 0.4535 - accuracy50: 0.4407 - val_loss: 12.6995 - val_accuracy10: 0.5992 - val_accuracy20: 0.5204 - val_accuracy30: 0.4588 - val_accuracy50: 0.3936 - 32s/epoch - 22ms/step
Epoch 14/50
1489/1489 - 32s - loss: 12.4068 - accuracy10: 0.4517 - accuracy20: 0.4549 - accuracy30: 0.4557 - accuracy50: 0.4426 - val_loss: 12.6539 - val_accuracy10: 0.5996 - val_accuracy20: 0.5221 - val_accuracy30: 0.4610 - val_accuracy50: 0.3950 - 32s/epoch - 22ms/step
Epoch 15/50
1489/1489 - 33s - loss: 12.3741 - accuracy10: 0.4536 - accuracy20: 0.4571 - accuracy30: 0.4582 - accuracy50: 0.4454 - val_loss: 12.7321 - val_accuracy10: 0.6002 - val_accuracy20: 0.5203 - val_accuracy30: 0.4602 - val_accuracy50: 0.3948 - 33s/epoch - 22ms/step
Epoch 16/50
1489/1489 - 31s - loss: 12.3450 - accuracy10: 0.4557 - accuracy20: 0.4596 - accuracy30: 0.4615 - accuracy50: 0.4482 - val_loss: 12.7455 - val_accuracy10: 0.6001 - val_accuracy20: 0.5222 - val_accuracy30: 0.4614 - val_accuracy50: 0.3972 - 31s/epoch - 21ms/step
Epoch 17/50
1489/1489 - 30s - loss: 12.3191 - accuracy10: 0.4575 - accuracy20: 0.4622 - accuracy30: 0.4643 - accuracy50: 0.4512 - val_loss: 12.7776 - val_accuracy10: 0.5998 - val_accuracy20: 0.5219 - val_accuracy30: 0.4618 - val_accuracy50: 0.3964 - 30s/epoch - 20ms/step
Epoch 18/50
1489/1489 - 30s - loss: 12.2922 - accuracy10: 0.4594 - accuracy20: 0.4648 - accuracy30: 0.4667 - accuracy50: 0.4530 - val_loss: 12.7672 - val_accuracy10: 0.6008 - val_accuracy20: 0.5222 - val_accuracy30: 0.4635 - val_accuracy50: 0.3978 - 30s/epoch - 20ms/step
Epoch 19/50
1489/1489 - 31s - loss: 12.2676 - accuracy10: 0.4619 - accuracy20: 0.4677 - accuracy30: 0.4684 - accuracy50: 0.4548 - val_loss: 12.7985 - val_accuracy10: 0.5993 - val_accuracy20: 0.5220 - val_accuracy30: 0.4635 - val_accuracy50: 0.3986 - 31s/epoch - 21ms/step
testing model: results/WBA/W6/deepOF_L1/seq2seq
Evaluating performance on  test set...
5183/5183 - 49s - 49s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9867936
{'0': {'precision': 0.40830278137662984, 'recall': 0.2429176356366666, 'f1-score': 0.30460944922696, 'support': 304877}, '1': {'precision': 0.5720241276324288, 'recall': 0.8103090487186645, 'f1-score': 0.6706289549231373, 'support': 709338}, '2': {'precision': 0.42997432925398393, 'recall': 0.1934169278996865, 'f1-score': 0.2668125768069066, 'support': 312620}, 'accuracy': 0.5345871943384068, 'macro avg': {'precision': 0.47010041275434755, 'recall': 0.4155478707516725, 'f1-score': 0.41401699365233463, 'support': 1326835}, 'weighted avg': {'precision': 0.500935800258265, 'recall': 0.5345871943384068, 'f1-score': 0.4913813431516439, 'support': 1326835}}
[[ 74060 207624  23193]
 [ 77587 574783  56968]
 [ 29738 222416  60466]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0407226
{'0': {'precision': 0.4778673170486404, 'recall': 0.19996212340405384, 'f1-score': 0.2819451552845709, 'support': 380182}, '1': {'precision': 0.4505460536923381, 'recall': 0.8410817299557769, 'f1-score': 0.5867728444087703, 'support': 561471}, '2': {'precision': 0.4926416482707873, 'recall': 0.15295626483065147, 'f1-score': 0.23343516108198917, 'support': 385182}, 'accuracy': 0.45761605625416873, 'macro avg': {'precision': 0.4736850063372553, 'recall': 0.39800003939682743, 'f1-score': 0.3673843869251101, 'support': 1326835}, 'weighted avg': {'precision': 0.4705949051744303, 'recall': 0.45761605625416873, 'f1-score': 0.39685524648152803, 'support': 1326835}}
[[ 76022 280639  23521]
 [ 52073 472243  37155]
 [ 30991 295275  58916]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0757014
{'0': {'precision': 0.5207506371148352, 'recall': 0.15793849879728586, 'f1-score': 0.24236891242737327, 'support': 426951}, '1': {'precision': 0.3710070849742158, 'recall': 0.8727519351650186, 'f1-score': 0.520675060245885, 'support': 467402}, '2': {'precision': 0.5298001737619461, 'recall': 0.11985007468518921, 'f1-score': 0.1954793076593811, 'support': 432482}, 'accuracy': 0.39732973579985453, 'macro avg': {'precision': 0.4738526319503323, 'recall': 0.38351350288249786, 'f1-score': 0.3195077601108798, 'support': 1326835}, 'weighted avg': {'precision': 0.4709504177586877, 'recall': 0.39732973579985453, 'f1-score': 0.3251236935820739, 'support': 1326835}}
[[ 67432 338581  20938]
 [ 34412 407926  25064]
 [ 27646 353003  51833]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1009358
{'0': {'precision': 0.5353664583953188, 'recall': 0.11826708410653919, 'f1-score': 0.19373617125127632, 'support': 456433}, '1': {'precision': 0.3181611315898684, 'recall': 0.8939074755412284, 'f1-score': 0.46929127985257446, 'support': 408238}, '2': {'precision': 0.5454016224356784, 'recall': 0.09324828415887002, 'f1-score': 0.15926649309565563, 'support': 462164}, 'accuracy': 0.3482000399446804, 'macro avg': {'precision': 0.46630973747362187, 'recall': 0.3684742812688792, 'f1-score': 0.2740979813998355, 'support': 1326835}, 'weighted avg': {'precision': 0.47203260252714024, 'recall': 0.3482000399446804, 'f1-score': 0.26651192866652573, 'support': 1326835}}
[[ 53981 385321  17131]
 [ 24521 364927  18790]
 [ 22328 396740  43096]]
Evaluating performance on  train set...
1489/1489 - 15s - 15s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9619837
{'0': {'precision': 0.4011041719689109, 'recall': 0.2548639100363238, 'f1-score': 0.31168277970897634, 'support': 80388}, '1': {'precision': 0.6173421075121784, 'recall': 0.8182695575341534, 'f1-score': 0.703744982658509, 'support': 220695}, '2': {'precision': 0.4051680414297536, 'recall': 0.1897676977319897, 'f1-score': 0.25847432371448276, 'support': 79982}, 'accuracy': 0.5674989831131172, 'macro avg': {'precision': 0.474538106970281, 'recall': 0.4209670551008224, 'f1-score': 0.4246340286939894, 'support': 381065}, 'weighted avg': {'precision': 0.527192024676293, 'recall': 0.5674989831131172, 'f1-score': 0.527578884448576, 'support': 381065}}
[[ 20488  54258   5642]
 [ 23466 180588  16641]
 [  7125  57679  15178]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0169306
{'0': {'precision': 0.46879892641467236, 'recall': 0.20561517785320488, 'f1-score': 0.28585456330805736, 'support': 101938}, '1': {'precision': 0.49521014307194305, 'recall': 0.8488098587586518, 'f1-score': 0.6254955298644861, 'support': 177710}, '2': {'precision': 0.4723018297483702, 'recall': 0.1478746166816214, 'f1-score': 0.22523090786213112, 'support': 101417}, 'accuracy': 0.4902024588980883, 'macro avg': {'precision': 0.47877029974499524, 'recall': 0.400766551097826, 'f1-score': 0.37886033367822486, 'support': 381065}, 'weighted avg': {'precision': 0.48204808668800425, 'recall': 0.4902024588980883, 'f1-score': 0.42811199157458263, 'support': 381065}}
[[ 20960  75084   5894]
 [ 16006 150842  10862]
 [  7744  78676  14997]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0554537
{'0': {'precision': 0.5121003066141042, 'recall': 0.160700325592983, 'f1-score': 0.24463320059373184, 'support': 116403}, '1': {'precision': 0.4110723626852659, 'recall': 0.8799476369495166, 'f1-score': 0.5603664610346583, 'support': 148960}, '2': {'precision': 0.5150169451910717, 'recall': 0.1142676876804204, 'f1-score': 0.18703712873037992, 'support': 115702}, 'accuracy': 0.4277590437326965, 'macro avg': {'precision': 0.4793965381634806, 'recall': 0.38497188340763994, 'f1-score': 0.33067893011959, 'support': 381065}, 'weighted avg': {'precision': 0.47349360799049023, 'recall': 0.4277590437326965, 'f1-score': 0.3505669540702958, 'support': 381065}}
[[ 18706  92458   5239]
 [ 10672 131077   7211]
 [  7150  95331  13221]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0907694
{'0': {'precision': 0.5294820017559263, 'recall': 0.11737823866467365, 'f1-score': 0.1921579373323222, 'support': 128448}, '1': {'precision': 0.3401830810929514, 'recall': 0.9016137262405919, 'f1-score': 0.49398377180050024, 'support': 125424}, '2': {'precision': 0.5329961822599039, 'recall': 0.08451722972176141, 'f1-score': 0.1458992141800464, 'support': 127193}, 'accuracy': 0.3645336097516172, 'macro avg': {'precision': 0.4675537550362605, 'recall': 0.36783639820900893, 'f1-score': 0.27734697443762296, 'support': 381065}, 'weighted avg': {'precision': 0.4683489964565927, 'recall': 0.3645336097516172, 'f1-score': 0.2760607300013665, 'support': 381065}}
[[ 15077 108970   4401]
 [  7322 113084   5018]
 [  6076 110367  10750]]
Evaluating performance on  val set...
519/519 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.950008
{'0': {'precision': 0.36892331873807116, 'recall': 0.2565684169431973, 'f1-score': 0.30265490801077616, 'support': 25615}, '1': {'precision': 0.652304825421734, 'recall': 0.8140437198599789, 'f1-score': 0.7242543367708072, 'support': 81702}, '2': {'precision': 0.3764352315635355, 'recall': 0.1920657387748683, 'f1-score': 0.25435422144698133, 'support': 25434}, 'accuracy': 0.5873100767602504, 'macro avg': {'precision': 0.46588779190778024, 'recall': 0.4208926251926815, 'f1-score': 0.42708782207618823, 'support': 132751}, 'weighted avg': {'precision': 0.544770535330575, 'recall': 0.5873100767602504, 'f1-score': 0.5528755230456045, 'support': 132751}}
[[ 6572 17245  1798]
 [ 8899 66509  6294]
 [ 2343 18206  4885]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0016705
{'0': {'precision': 0.43627513769693865, 'recall': 0.20711462450592885, 'f1-score': 0.28088405079993406, 'support': 32890}, '1': {'precision': 0.5339231370775507, 'recall': 0.8437030089180699, 'f1-score': 0.6539837510963393, 'support': 67167}, '2': {'precision': 0.4469090909090909, 'recall': 0.15036398115862237, 'f1-score': 0.22501945347187255, 'support': 32694}, 'accuracy': 0.5152277572297007, 'macro avg': {'precision': 0.47236912189452673, 'recall': 0.40039387152754036, 'f1-score': 0.38662908512271527, 'support': 132751}, 'weighted avg': {'precision': 0.4883002798104871, 'recall': 0.5152277572297007, 'f1-score': 0.45590006141201994, 'support': 132751}}
[[ 6812 24219  1859]
 [ 6273 56669  4225]
 [ 2529 25249  4916]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.039668
{'0': {'precision': 0.48250705993096954, 'recall': 0.16217570132883358, 'f1-score': 0.2427579130160233, 'support': 37928}, '1': {'precision': 0.4496828467317468, 'recall': 0.8763808521830615, 'f1-score': 0.5943808532778356, 'support': 57030}, '2': {'precision': 0.498758184691804, 'recall': 0.11689995501812504, 'f1-score': 0.18940644359177725, 'support': 37793}, 'accuracy': 0.4561095584967345, 'macro avg': {'precision': 0.4769826971181734, 'recall': 0.3851521695100067, 'f1-score': 0.3421817366285454, 'support': 132751}, 'weighted avg': {'precision': 0.4730322829374594, 'recall': 0.4561095584967345, 'f1-score': 0.378626902320666, 'support': 132751}}
[[ 6151 30118  1659]
 [ 4269 49980  2781]
 [ 2328 31047  4418]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0762044
{'0': {'precision': 0.5036738802214393, 'recall': 0.11779383724488594, 'f1-score': 0.19093406593406595, 'support': 42481}, '1': {'precision': 0.3739433460994376, 'recall': 0.9006149243809207, 'f1-score': 0.5284638076894945, 'support': 48136}, '2': {'precision': 0.5302149912841372, 'recall': 0.08662837613328903, 'f1-score': 0.14892488473621934, 'support': 42134}, 'accuracy': 0.39175599430512764, 'macro avg': {'precision': 0.469277405868338, 'recall': 0.3683457125863652, 'f1-score': 0.28944091945325995, 'support': 132751}, 'weighted avg': {'precision': 0.46505702748977656, 'recall': 0.39175599430512764, 'f1-score': 0.2999902448596427, 'support': 132751}}
[[ 5004 36059  1418]
 [ 2968 43352  1816]
 [ 1963 36521  3650]]
training model: results/WBA/W6/deepLOB_L2/seq2seq
Epoch 1/50
1489/1489 - 76s - loss: 12.2528 - accuracy10: 0.4596 - accuracy20: 0.4666 - accuracy30: 0.4674 - accuracy50: 0.4535 - val_loss: 13.3938 - val_accuracy10: 0.6007 - val_accuracy20: 0.5082 - val_accuracy30: 0.4398 - val_accuracy50: 0.3770 - 76s/epoch - 51ms/step
Epoch 2/50
1489/1489 - 70s - loss: 11.8351 - accuracy10: 0.4855 - accuracy20: 0.4960 - accuracy30: 0.4943 - accuracy50: 0.4740 - val_loss: 12.6161 - val_accuracy10: 0.6056 - val_accuracy20: 0.5319 - val_accuracy30: 0.4753 - val_accuracy50: 0.4175 - 70s/epoch - 47ms/step
Epoch 3/50
1489/1489 - 70s - loss: 11.5848 - accuracy10: 0.5163 - accuracy20: 0.5186 - accuracy30: 0.5110 - accuracy50: 0.4868 - val_loss: 12.7176 - val_accuracy10: 0.6236 - val_accuracy20: 0.5454 - val_accuracy30: 0.4847 - val_accuracy50: 0.4229 - 70s/epoch - 47ms/step
Epoch 4/50
1489/1489 - 72s - loss: 11.4091 - accuracy10: 0.5363 - accuracy20: 0.5329 - accuracy30: 0.5233 - accuracy50: 0.4961 - val_loss: 13.1395 - val_accuracy10: 0.6316 - val_accuracy20: 0.5443 - val_accuracy30: 0.4778 - val_accuracy50: 0.4133 - 72s/epoch - 48ms/step
Epoch 5/50
1489/1489 - 70s - loss: 11.2633 - accuracy10: 0.5491 - accuracy20: 0.5437 - accuracy30: 0.5321 - accuracy50: 0.5024 - val_loss: 12.3725 - val_accuracy10: 0.6402 - val_accuracy20: 0.5709 - val_accuracy30: 0.5149 - val_accuracy50: 0.4528 - 70s/epoch - 47ms/step
Epoch 6/50
1489/1489 - 72s - loss: 11.1198 - accuracy10: 0.5599 - accuracy20: 0.5546 - accuracy30: 0.5416 - accuracy50: 0.5090 - val_loss: 12.2362 - val_accuracy10: 0.6461 - val_accuracy20: 0.5779 - val_accuracy30: 0.5238 - val_accuracy50: 0.4611 - 72s/epoch - 48ms/step
Epoch 7/50
1489/1489 - 71s - loss: 11.0247 - accuracy10: 0.5669 - accuracy20: 0.5611 - accuracy30: 0.5476 - accuracy50: 0.5142 - val_loss: 12.1552 - val_accuracy10: 0.6449 - val_accuracy20: 0.5803 - val_accuracy30: 0.5271 - val_accuracy50: 0.4663 - 71s/epoch - 48ms/step
Epoch 8/50
1489/1489 - 71s - loss: 10.9508 - accuracy10: 0.5697 - accuracy20: 0.5638 - accuracy30: 0.5505 - accuracy50: 0.5168 - val_loss: 11.7348 - val_accuracy10: 0.6468 - val_accuracy20: 0.5901 - val_accuracy30: 0.5416 - val_accuracy50: 0.4814 - 71s/epoch - 47ms/step
Epoch 9/50
1489/1489 - 71s - loss: 10.8965 - accuracy10: 0.5729 - accuracy20: 0.5673 - accuracy30: 0.5534 - accuracy50: 0.5197 - val_loss: 11.5948 - val_accuracy10: 0.6425 - val_accuracy20: 0.5910 - val_accuracy30: 0.5468 - val_accuracy50: 0.4870 - 71s/epoch - 48ms/step
Epoch 10/50
1489/1489 - 73s - loss: 10.8575 - accuracy10: 0.5743 - accuracy20: 0.5685 - accuracy30: 0.5550 - accuracy50: 0.5209 - val_loss: 11.6144 - val_accuracy10: 0.6340 - val_accuracy20: 0.5900 - val_accuracy30: 0.5479 - val_accuracy50: 0.4912 - 73s/epoch - 49ms/step
Epoch 11/50
1489/1489 - 72s - loss: 10.8202 - accuracy10: 0.5767 - accuracy20: 0.5709 - accuracy30: 0.5570 - accuracy50: 0.5225 - val_loss: 11.7055 - val_accuracy10: 0.6401 - val_accuracy20: 0.5915 - val_accuracy30: 0.5460 - val_accuracy50: 0.4857 - 72s/epoch - 48ms/step
Epoch 12/50
1489/1489 - 71s - loss: 10.7805 - accuracy10: 0.5777 - accuracy20: 0.5726 - accuracy30: 0.5594 - accuracy50: 0.5247 - val_loss: 11.6118 - val_accuracy10: 0.6162 - val_accuracy20: 0.5827 - val_accuracy30: 0.5474 - val_accuracy50: 0.4937 - 71s/epoch - 48ms/step
Epoch 13/50
1489/1489 - 69s - loss: 10.7575 - accuracy10: 0.5788 - accuracy20: 0.5736 - accuracy30: 0.5605 - accuracy50: 0.5261 - val_loss: 11.5076 - val_accuracy10: 0.6203 - val_accuracy20: 0.5856 - val_accuracy30: 0.5491 - val_accuracy50: 0.4941 - 69s/epoch - 47ms/step
Epoch 14/50
1489/1489 - 70s - loss: 10.7294 - accuracy10: 0.5805 - accuracy20: 0.5755 - accuracy30: 0.5625 - accuracy50: 0.5281 - val_loss: 11.6962 - val_accuracy10: 0.6241 - val_accuracy20: 0.5857 - val_accuracy30: 0.5452 - val_accuracy50: 0.4885 - 70s/epoch - 47ms/step
Epoch 15/50
1489/1489 - 71s - loss: 10.7026 - accuracy10: 0.5808 - accuracy20: 0.5762 - accuracy30: 0.5632 - accuracy50: 0.5296 - val_loss: 11.7655 - val_accuracy10: 0.6089 - val_accuracy20: 0.5770 - val_accuracy30: 0.5433 - val_accuracy50: 0.4908 - 71s/epoch - 48ms/step
Epoch 16/50
1489/1489 - 69s - loss: 10.6807 - accuracy10: 0.5819 - accuracy20: 0.5777 - accuracy30: 0.5652 - accuracy50: 0.5300 - val_loss: 12.0163 - val_accuracy10: 0.6034 - val_accuracy20: 0.5701 - val_accuracy30: 0.5372 - val_accuracy50: 0.4865 - 69s/epoch - 47ms/step
Epoch 17/50
1489/1489 - 69s - loss: 10.6537 - accuracy10: 0.5832 - accuracy20: 0.5789 - accuracy30: 0.5659 - accuracy50: 0.5315 - val_loss: 11.9552 - val_accuracy10: 0.6032 - val_accuracy20: 0.5714 - val_accuracy30: 0.5390 - val_accuracy50: 0.4879 - 69s/epoch - 46ms/step
Epoch 18/50
1489/1489 - 69s - loss: 10.6291 - accuracy10: 0.5842 - accuracy20: 0.5801 - accuracy30: 0.5678 - accuracy50: 0.5337 - val_loss: 12.3925 - val_accuracy10: 0.5809 - val_accuracy20: 0.5557 - val_accuracy30: 0.5292 - val_accuracy50: 0.4837 - 69s/epoch - 47ms/step
Epoch 19/50
1489/1489 - 69s - loss: 10.6119 - accuracy10: 0.5849 - accuracy20: 0.5817 - accuracy30: 0.5689 - accuracy50: 0.5340 - val_loss: 12.1855 - val_accuracy10: 0.5987 - val_accuracy20: 0.5676 - val_accuracy30: 0.5369 - val_accuracy50: 0.4879 - 69s/epoch - 46ms/step
Epoch 20/50
1489/1489 - 69s - loss: 10.5840 - accuracy10: 0.5853 - accuracy20: 0.5825 - accuracy30: 0.5705 - accuracy50: 0.5357 - val_loss: 12.3013 - val_accuracy10: 0.5759 - val_accuracy20: 0.5531 - val_accuracy30: 0.5278 - val_accuracy50: 0.4829 - 69s/epoch - 47ms/step
Epoch 21/50
1489/1489 - 69s - loss: 10.5629 - accuracy10: 0.5865 - accuracy20: 0.5838 - accuracy30: 0.5715 - accuracy50: 0.5367 - val_loss: 12.4936 - val_accuracy10: 0.5895 - val_accuracy20: 0.5599 - val_accuracy30: 0.5305 - val_accuracy50: 0.4834 - 69s/epoch - 47ms/step
Epoch 22/50
1489/1489 - 69s - loss: 10.5428 - accuracy10: 0.5874 - accuracy20: 0.5844 - accuracy30: 0.5729 - accuracy50: 0.5385 - val_loss: 12.6799 - val_accuracy10: 0.5796 - val_accuracy20: 0.5512 - val_accuracy30: 0.5246 - val_accuracy50: 0.4814 - 69s/epoch - 47ms/step
Epoch 23/50
1489/1489 - 69s - loss: 10.5253 - accuracy10: 0.5875 - accuracy20: 0.5854 - accuracy30: 0.5741 - accuracy50: 0.5395 - val_loss: 12.5236 - val_accuracy10: 0.5824 - val_accuracy20: 0.5556 - val_accuracy30: 0.5288 - val_accuracy50: 0.4827 - 69s/epoch - 46ms/step
testing model: results/WBA/W6/deepLOB_L2/seq2seq
Evaluating performance on  test set...
5183/5183 - 84s - 84s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.89995986
{'0': {'precision': 0.4216681496656762, 'recall': 0.5859912096562582, 'f1-score': 0.4904312688811386, 'support': 304880}, '1': {'precision': 0.6976650480563612, 'recall': 0.7151996436118696, 'f1-score': 0.7063235378063162, 'support': 709339}, '2': {'precision': 0.48251525724221794, 'recall': 0.27161962887969776, 'f1-score': 0.34757870909511396, 'support': 312621}, 'accuracy': 0.5809969551716861, 'macro avg': {'precision': 0.5339494849880851, 'recall': 0.5242701607159418, 'f1-score': 0.5147778385941896, 'support': 1326840}, 'weighted avg': {'precision': 0.5835546224319752, 'recall': 0.5809969551716861, 'f1-score': 0.5721910108652887, 'support': 1326840}}
[[178657  90523  35700]
 [146652 507319  55368]
 [ 98382 129325  84914]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9724644
{'0': {'precision': 0.47991777432228805, 'recall': 0.5244236358614884, 'f1-score': 0.5011846003215075, 'support': 380185}, '1': {'precision': 0.5827972796573686, 'recall': 0.7498481666907106, 'f1-score': 0.6558525718914541, 'support': 561471}, '2': {'precision': 0.5260094502854663, 'recall': 0.2580844479521475, 'f1-score': 0.34627194242850146, 'support': 385184}, 'accuracy': 0.5424964577492388, 'macro avg': {'precision': 0.529574834755041, 'recall': 0.5107854168347822, 'f1-score': 0.501103038213821, 'support': 1326840}, 'weighted avg': {'precision': 0.5368331784811873, 'recall': 0.5424964577492388, 'f1-score': 0.5216631082406914, 'support': 1326840}}
[[199378 132971  47836]
 [ 98710 421018  41743]
 [117354 168420  99410]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0216253
{'0': {'precision': 0.5015054415835577, 'recall': 0.464634446253118, 'f1-score': 0.4823663862276905, 'support': 426955}, '1': {'precision': 0.4952775168230344, 'recall': 0.7749025464161471, 'f1-score': 0.6043108691063835, 'support': 467402}, '2': {'precision': 0.5407478523496645, 'recall': 0.25004913487929004, 'f1-score': 0.34196774861692825, 'support': 432483}, 'accuracy': 0.5039876699526695, 'macro avg': {'precision': 0.5125102702520855, 'recall': 0.4965287091828518, 'f1-score': 0.47621500131700073, 'support': 1326840}, 'weighted avg': {'precision': 0.5121025980202344, 'recall': 0.5039876699526695, 'f1-score': 0.47956052508139674, 'support': 1326840}}
[[198378 170405  58172]
 [ 71539 362191  33672]
 [125648 198693 108142]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0801282
{'0': {'precision': 0.4891368142337615, 'recall': 0.3998742430483135, 'f1-score': 0.4400242533242846, 'support': 456436}, '1': {'precision': 0.41771657453965577, 'recall': 0.7622814086846186, 'f1-score': 0.5396917340501637, 'support': 408239}, '2': {'precision': 0.5211989670025345, 'recall': 0.23537264829660404, 'f1-score': 0.3242944320725974, 'support': 462165}, 'accuracy': 0.45407961773838595, 'macro avg': {'precision': 0.4760174519253173, 'recall': 0.4658427666765121, 'f1-score': 0.43467013981568187, 'support': 1326840}, 'weighted avg': {'precision': 0.4783302946849824, 'recall': 0.45407961773838595, 'f1-score': 0.4303786892964185, 'support': 1326840}}
[[182517 208475  65444]
 [ 62558 311193  34488]
 [128066 225318 108781]]
Evaluating performance on  train set...
1489/1489 - 24s - 24s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.83261836
{'0': {'precision': 0.44133998885891235, 'recall': 0.5035517559382867, 'f1-score': 0.47039785791204636, 'support': 80242}, '1': {'precision': 0.7419485288931313, 'recall': 0.7144409579309127, 'f1-score': 0.7279349686515314, 'support': 220851}, '2': {'precision': 0.45347490598690976, 'recall': 0.43576662415284967, 'f1-score': 0.4444444444444445, 'support': 79974}, 'accuracy': 0.6115486253073606, 'macro avg': {'precision': 0.5455878079129844, 'recall': 0.5512531126740164, 'f1-score': 0.5475924236693407, 'support': 381067}, 'weighted avg': {'precision': 0.6181072621664718, 'recall': 0.6115486253073606, 'f1-score': 0.6142091303530293, 'support': 381067}}
[[ 40406  27699  12137]
 [ 33202 157785  29864]
 [ 17945  27179  34850]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.91374326
{'0': {'precision': 0.5034538298379139, 'recall': 0.4359218628770097, 'f1-score': 0.4672604008758633, 'support': 101821}, '1': {'precision': 0.626636111853112, 'recall': 0.752253113853978, 'f1-score': 0.6837227495966928, 'support': 177754}, '2': {'precision': 0.5090986833004263, 'recall': 0.3988688763646396, 'f1-score': 0.44729267605478185, 'support': 101492}, 'accuracy': 0.573610414966397, 'macro avg': {'precision': 0.5463962083304841, 'recall': 0.5290146176985424, 'f1-score': 0.532758608842446, 'support': 381067}, 'weighted avg': {'precision': 0.5624173476049912, 'recall': 0.573610414966397, 'f1-score': 0.5629141415749559, 'support': 381067}}
[[ 44386  40613  16822]
 [ 21825 133716  22213]
 [ 21952  39058  40482]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.97394615
{'0': {'precision': 0.5301850639113246, 'recall': 0.3761044055781622, 'f1-score': 0.4400469055899183, 'support': 116239}, '1': {'precision': 0.5350917536678471, 'recall': 0.7807708052317583, 'f1-score': 0.6349964387367204, 'support': 149013}, '2': {'precision': 0.532157331329531, 'recall': 0.373008677632431, 'f1-score': 0.438592038336193, 'support': 115815}, 'accuracy': 0.5334048868046827, 'macro avg': {'precision': 0.5324780496362344, 'recall': 0.5099612961474506, 'f1-score': 0.5045451275542773, 'support': 381067}, 'weighted avg': {'precision': 0.5327032003852997, 'recall': 0.5334048868046827, 'f1-score': 0.5158380901632721, 'support': 381067}}
[[ 43718  52033  20488]
 [ 15177 116345  17491]
 [ 23563  49052  43200]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0537783
{'0': {'precision': 0.5243260969371024, 'recall': 0.3112017688642521, 'f1-score': 0.39058232647218327, 'support': 128444}, '1': {'precision': 0.44207701524418974, 'recall': 0.785926841916311, 'f1-score': 0.5658617282815982, 'support': 125345}, '2': {'precision': 0.5229714731745393, 'recall': 0.33690032841496564, 'f1-score': 0.40980355615446, 'support': 127278}, 'accuracy': 0.47593730236415116, 'macro avg': {'precision': 0.4964581951186105, 'recall': 0.47800964639850957, 'f1-score': 0.45541587030274716, 'support': 381067}, 'weighted avg': {'precision': 0.496819320049968, 'recall': 0.47593730236415116, 'f1-score': 0.4546572431962814, 'support': 381067}}
[[39972 64288 24184]
 [11904 98512 14929]
 [24359 60039 42880]]
Evaluating performance on  val set...
519/519 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8089441
{'0': {'precision': 0.40374470411370783, 'recall': 0.5740323332815171, 'f1-score': 0.474060047820017, 'support': 25732}, '1': {'precision': 0.7759357787099455, 'recall': 0.7094386786095012, 'f1-score': 0.7411987607855186, 'support': 81611}, '2': {'precision': 0.44890951276102087, 'recall': 0.3807312369632807, 'f1-score': 0.41201899529376684, 'support': 25409}, 'accuracy': 0.6202769073158974, 'macro avg': {'precision': 0.542863331861558, 'recall': 0.554734082951433, 'f1-score': 0.5424259346331008, 'support': 132752}, 'weighted avg': {'precision': 0.641198591149633, 'recall': 0.6202769073158974, 'f1-score': 0.6264122263196861, 'support': 132752}}
[[14771  7633  3328]
 [15165 57898  8548]
 [ 6649  9086  9674]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.88599277
{'0': {'precision': 0.46789902603856093, 'recall': 0.5005315755900489, 'f1-score': 0.48366550236285183, 'support': 32921}, '1': {'precision': 0.6662663143566339, 'recall': 0.7430680617362961, 'f1-score': 0.7025745305123028, 'support': 67189}, '2': {'precision': 0.5007743020220344, 'recall': 0.34673120519576006, 'f1-score': 0.409753271907753, 'support': 32642}, 'accuracy': 0.5854676389056286, 'macro avg': {'precision': 0.5449798808057431, 'recall': 0.5301102808407018, 'f1-score': 0.5319977682609692, 'support': 132752}, 'weighted avg': {'precision': 0.5763811166545633, 'recall': 0.5854676389056286, 'f1-score': 0.5762865978327365, 'support': 132752}}
[[16478 11850  4593]
 [10573 49926  6690]
 [ 8166 13158 11318]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9459342
{'0': {'precision': 0.5007622416000975, 'recall': 0.4326659641728135, 'f1-score': 0.4642301930523757, 'support': 37960}, '1': {'precision': 0.5754304436931351, 'recall': 0.772541665936454, 'f1-score': 0.6595744680851064, 'support': 57061}, '2': {'precision': 0.5246070158906926, 'recall': 0.3246137128621028, 'f1-score': 0.40106093847211766, 'support': 37731}, 'accuracy': 0.5480444739062311, 'macro avg': {'precision': 0.5335999003946418, 'recall': 0.5099404476571234, 'f1-score': 0.5082885332032, 'support': 132752}, 'weighted avg': {'precision': 0.5396341942515774, 'recall': 0.5480444739062311, 'f1-score': 0.5302412552817577, 'support': 132752}}
[[16424 15912  5624]
 [ 7504 44082  5475]
 [ 8870 16613 12248]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0231134
{'0': {'precision': 0.5058710362213082, 'recall': 0.35964250341932746, 'f1-score': 0.42040411279874307, 'support': 42406}, '1': {'precision': 0.4802955665024631, 'recall': 0.7830514789592432, 'f1-score': 0.5953964194373401, 'support': 48311}, '2': {'precision': 0.5200922818791947, 'recall': 0.2949684786487451, 'f1-score': 0.37644022770398483, 'support': 42035}, 'accuracy': 0.4932505724960829, 'macro avg': {'precision': 0.5020862948676553, 'recall': 0.4792208203424386, 'f1-score': 0.46408025331335606, 'support': 132752}, 'weighted avg': {'precision': 0.5010666908528176, 'recall': 0.4932505724960829, 'f1-score': 0.4701663116059859, 'support': 132752}}
[[15251 20432  6723]
 [ 5763 37830  4718]
 [ 9134 20502 12399]]
training model: results/WBA/W6/deepOF_L2/seq2seq
Epoch 1/50
1489/1489 - 49s - loss: 11.9499 - accuracy10: 0.4975 - accuracy20: 0.4991 - accuracy30: 0.4916 - accuracy50: 0.4683 - val_loss: 12.6563 - val_accuracy10: 0.6195 - val_accuracy20: 0.5729 - val_accuracy30: 0.5262 - val_accuracy50: 0.4676 - 49s/epoch - 33ms/step
Epoch 2/50
1489/1489 - 41s - loss: 11.2344 - accuracy10: 0.5573 - accuracy20: 0.5506 - accuracy30: 0.5380 - accuracy50: 0.5052 - val_loss: 12.1357 - val_accuracy10: 0.6393 - val_accuracy20: 0.5886 - val_accuracy30: 0.5412 - val_accuracy50: 0.4805 - 41s/epoch - 28ms/step
Epoch 3/50
1489/1489 - 41s - loss: 11.0924 - accuracy10: 0.5667 - accuracy20: 0.5589 - accuracy30: 0.5448 - accuracy50: 0.5115 - val_loss: 11.9017 - val_accuracy10: 0.6465 - val_accuracy20: 0.5941 - val_accuracy30: 0.5462 - val_accuracy50: 0.4832 - 41s/epoch - 27ms/step
Epoch 4/50
1489/1489 - 43s - loss: 11.0070 - accuracy10: 0.5731 - accuracy20: 0.5637 - accuracy30: 0.5492 - accuracy50: 0.5150 - val_loss: 11.8771 - val_accuracy10: 0.6480 - val_accuracy20: 0.5965 - val_accuracy30: 0.5481 - val_accuracy50: 0.4852 - 43s/epoch - 29ms/step
Epoch 5/50
1489/1489 - 43s - loss: 10.9496 - accuracy10: 0.5756 - accuracy20: 0.5660 - accuracy30: 0.5519 - accuracy50: 0.5181 - val_loss: 11.8584 - val_accuracy10: 0.6476 - val_accuracy20: 0.5969 - val_accuracy30: 0.5498 - val_accuracy50: 0.4867 - 43s/epoch - 29ms/step
Epoch 6/50
1489/1489 - 41s - loss: 10.9038 - accuracy10: 0.5777 - accuracy20: 0.5683 - accuracy30: 0.5541 - accuracy50: 0.5197 - val_loss: 11.7911 - val_accuracy10: 0.6479 - val_accuracy20: 0.5977 - val_accuracy30: 0.5497 - val_accuracy50: 0.4863 - 41s/epoch - 28ms/step
Epoch 7/50
1489/1489 - 41s - loss: 10.8633 - accuracy10: 0.5789 - accuracy20: 0.5700 - accuracy30: 0.5555 - accuracy50: 0.5214 - val_loss: 11.7334 - val_accuracy10: 0.6478 - val_accuracy20: 0.5994 - val_accuracy30: 0.5520 - val_accuracy50: 0.4895 - 41s/epoch - 28ms/step
Epoch 8/50
1489/1489 - 43s - loss: 10.8279 - accuracy10: 0.5801 - accuracy20: 0.5714 - accuracy30: 0.5575 - accuracy50: 0.5232 - val_loss: 11.6932 - val_accuracy10: 0.6470 - val_accuracy20: 0.5989 - val_accuracy30: 0.5518 - val_accuracy50: 0.4901 - 43s/epoch - 29ms/step
Epoch 9/50
1489/1489 - 43s - loss: 10.7974 - accuracy10: 0.5815 - accuracy20: 0.5724 - accuracy30: 0.5590 - accuracy50: 0.5243 - val_loss: 11.7274 - val_accuracy10: 0.6459 - val_accuracy20: 0.5990 - val_accuracy30: 0.5524 - val_accuracy50: 0.4899 - 43s/epoch - 29ms/step
Epoch 10/50
1489/1489 - 43s - loss: 10.7706 - accuracy10: 0.5825 - accuracy20: 0.5742 - accuracy30: 0.5604 - accuracy50: 0.5262 - val_loss: 11.6852 - val_accuracy10: 0.6448 - val_accuracy20: 0.5982 - val_accuracy30: 0.5528 - val_accuracy50: 0.4913 - 43s/epoch - 29ms/step
Epoch 11/50
1489/1489 - 42s - loss: 10.7454 - accuracy10: 0.5833 - accuracy20: 0.5752 - accuracy30: 0.5616 - accuracy50: 0.5270 - val_loss: 11.6381 - val_accuracy10: 0.6430 - val_accuracy20: 0.5991 - val_accuracy30: 0.5544 - val_accuracy50: 0.4934 - 42s/epoch - 28ms/step
Epoch 12/50
1489/1489 - 43s - loss: 10.7186 - accuracy10: 0.5840 - accuracy20: 0.5763 - accuracy30: 0.5629 - accuracy50: 0.5281 - val_loss: 11.6693 - val_accuracy10: 0.6421 - val_accuracy20: 0.5997 - val_accuracy30: 0.5541 - val_accuracy50: 0.4941 - 43s/epoch - 29ms/step
Epoch 13/50
1489/1489 - 41s - loss: 10.6978 - accuracy10: 0.5843 - accuracy20: 0.5770 - accuracy30: 0.5639 - accuracy50: 0.5294 - val_loss: 11.5741 - val_accuracy10: 0.6408 - val_accuracy20: 0.5985 - val_accuracy30: 0.5551 - val_accuracy50: 0.4955 - 41s/epoch - 27ms/step
Epoch 14/50
1489/1489 - 41s - loss: 10.6758 - accuracy10: 0.5852 - accuracy20: 0.5779 - accuracy30: 0.5653 - accuracy50: 0.5308 - val_loss: 11.6311 - val_accuracy10: 0.6368 - val_accuracy20: 0.5968 - val_accuracy30: 0.5544 - val_accuracy50: 0.4944 - 41s/epoch - 28ms/step
Epoch 15/50
1489/1489 - 41s - loss: 10.6517 - accuracy10: 0.5863 - accuracy20: 0.5789 - accuracy30: 0.5665 - accuracy50: 0.5327 - val_loss: 11.7347 - val_accuracy10: 0.6355 - val_accuracy20: 0.5955 - val_accuracy30: 0.5527 - val_accuracy50: 0.4938 - 41s/epoch - 28ms/step
Epoch 16/50
1489/1489 - 42s - loss: 10.6333 - accuracy10: 0.5866 - accuracy20: 0.5800 - accuracy30: 0.5678 - accuracy50: 0.5338 - val_loss: 11.6660 - val_accuracy10: 0.6348 - val_accuracy20: 0.5954 - val_accuracy30: 0.5537 - val_accuracy50: 0.4952 - 42s/epoch - 28ms/step
Epoch 17/50
1489/1489 - 41s - loss: 10.6109 - accuracy10: 0.5871 - accuracy20: 0.5814 - accuracy30: 0.5695 - accuracy50: 0.5353 - val_loss: 11.6586 - val_accuracy10: 0.6297 - val_accuracy20: 0.5933 - val_accuracy30: 0.5539 - val_accuracy50: 0.4974 - 41s/epoch - 27ms/step
Epoch 18/50
1489/1489 - 43s - loss: 10.5898 - accuracy10: 0.5881 - accuracy20: 0.5819 - accuracy30: 0.5701 - accuracy50: 0.5362 - val_loss: 11.6484 - val_accuracy10: 0.6311 - val_accuracy20: 0.5934 - val_accuracy30: 0.5541 - val_accuracy50: 0.4966 - 43s/epoch - 29ms/step
Epoch 19/50
1489/1489 - 41s - loss: 10.5706 - accuracy10: 0.5882 - accuracy20: 0.5830 - accuracy30: 0.5711 - accuracy50: 0.5374 - val_loss: 11.8170 - val_accuracy10: 0.6325 - val_accuracy20: 0.5929 - val_accuracy30: 0.5521 - val_accuracy50: 0.4940 - 41s/epoch - 28ms/step
Epoch 20/50
1489/1489 - 41s - loss: 10.5508 - accuracy10: 0.5886 - accuracy20: 0.5836 - accuracy30: 0.5721 - accuracy50: 0.5383 - val_loss: 11.8078 - val_accuracy10: 0.6279 - val_accuracy20: 0.5901 - val_accuracy30: 0.5502 - val_accuracy50: 0.4943 - 41s/epoch - 27ms/step
Epoch 21/50
1489/1489 - 42s - loss: 10.5280 - accuracy10: 0.5896 - accuracy20: 0.5849 - accuracy30: 0.5738 - accuracy50: 0.5399 - val_loss: 11.7780 - val_accuracy10: 0.6300 - val_accuracy20: 0.5917 - val_accuracy30: 0.5522 - val_accuracy50: 0.4948 - 42s/epoch - 28ms/step
Epoch 22/50
1489/1489 - 42s - loss: 10.5090 - accuracy10: 0.5899 - accuracy20: 0.5863 - accuracy30: 0.5752 - accuracy50: 0.5411 - val_loss: 11.8647 - val_accuracy10: 0.6243 - val_accuracy20: 0.5896 - val_accuracy30: 0.5513 - val_accuracy50: 0.4950 - 42s/epoch - 28ms/step
Epoch 23/50
1489/1489 - 41s - loss: 10.4915 - accuracy10: 0.5899 - accuracy20: 0.5856 - accuracy30: 0.5751 - accuracy50: 0.5421 - val_loss: 11.8398 - val_accuracy10: 0.6221 - val_accuracy20: 0.5871 - val_accuracy30: 0.5496 - val_accuracy50: 0.4952 - 41s/epoch - 28ms/step
testing model: results/WBA/W6/deepOF_L2/seq2seq
Evaluating performance on  test set...
5183/5183 - 48s - 48s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8909564
{'0': {'precision': 0.46209415533823245, 'recall': 0.48634039301095194, 'f1-score': 0.47390735292472563, 'support': 304877}, '1': {'precision': 0.7279889370366033, 'recall': 0.6835175896399178, 'f1-score': 0.7050526995428053, 'support': 709338}, '2': {'precision': 0.4458325366592637, 'recall': 0.48481543087454415, 'f1-score': 0.4645075278703597, 'support': 312620}, 'accuracy': 0.5913938055598473, 'macro avg': {'precision': 0.5453052096780332, 'recall': 0.5515578045084712, 'f1-score': 0.5478225267792968, 'support': 1326835}, 'weighted avg': {'precision': 0.6004124582386984, 'recall': 0.5913938055598473, 'f1-score': 0.5952650232988712, 'support': 1326835}}
[[148274  84832  71771]
 [107872 484845 116621]
 [ 64728  96329 151563]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9534507
{'0': {'precision': 0.5217480064196585, 'recall': 0.4369565103029602, 'f1-score': 0.4756026161679638, 'support': 380182}, '1': {'precision': 0.6070052149197288, 'recall': 0.7181172313440943, 'f1-score': 0.6579028309098579, 'support': 561471}, '2': {'precision': 0.49349487201836195, 'recall': 0.44097595422423685, 'f1-score': 0.46575958495801867, 'support': 385182}, 'accuracy': 0.5571009206118319, 'macro avg': {'precision': 0.5407493644525831, 'recall': 0.5320165652904304, 'f1-score': 0.5330883440119468, 'support': 1326835}, 'weighted avg': {'precision': 0.5496240055444801, 'recall': 0.5571009206118319, 'f1-score': 0.5498883603817031, 'support': 1326835}}
[[166123 125596  88463]
 [ 72398 403202  85871]
 [ 79876 135450 169856]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9987378
{'0': {'precision': 0.5424760744457447, 'recall': 0.39630074645568225, 'f1-score': 0.4580080556969152, 'support': 426951}, '1': {'precision': 0.515065841762063, 'recall': 0.7390105305497195, 'f1-score': 0.6070429032754113, 'support': 467402}, '2': {'precision': 0.5135881640512682, 'recall': 0.40887713245869195, 'f1-score': 0.4552896603839653, 'support': 432482}, 'accuracy': 0.5211258370483142, 'macro avg': {'precision': 0.5237100267530254, 'recall': 0.5147294698213646, 'f1-score': 0.5067802064520973, 'support': 1326835}, 'weighted avg': {'precision': 0.5234042992513595, 'recall': 0.5211258370483142, 'f1-score': 0.5096222570001285, 'support': 1326835}}
[[169201 158451  99299]
 [ 53811 345415  68176]
 [ 88893 166757 176832]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.063702
{'0': {'precision': 0.5247233251807917, 'recall': 0.3483030368093455, 'f1-score': 0.41868776385754125, 'support': 456433}, '1': {'precision': 0.42908123615923527, 'recall': 0.7195239051729628, 'f1-score': 0.5375810982695985, 'support': 408238}, '2': {'precision': 0.49777476495033746, 'recall': 0.36543304973991914, 'f1-score': 0.42145899827064304, 'support': 462164}, 'accuracy': 0.4684862850316731, 'macro avg': {'precision': 0.4838597754301215, 'recall': 0.4777533305740758, 'f1-score': 0.4592426201325943, 'support': 1326835}, 'weighted avg': {'precision': 0.4859096147131527, 'recall': 0.4684862850316731, 'f1-score': 0.4562339107672973, 'support': 1326835}}
[[158977 192065 105391]
 [ 49492 293737  65009]
 [ 94504 198770 168890]]
Evaluating performance on  train set...
1489/1489 - 16s - 16s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8328402
{'0': {'precision': 0.46844409773773876, 'recall': 0.4631412648654028, 'f1-score': 0.46577758873056185, 'support': 80388}, '1': {'precision': 0.746939255081659, 'recall': 0.7201341217517389, 'f1-score': 0.7332918079682561, 'support': 220695}, '2': {'precision': 0.4515831193982795, 'recall': 0.5014378235102899, 'f1-score': 0.4752064646847637, 'support': 79982}, 'accuracy': 0.6200175823022319, 'macro avg': {'precision': 0.5556554907392258, 'recall': 0.5615710700424772, 'f1-score': 0.5580919537945271, 'support': 381065}, 'weighted avg': {'precision': 0.6261964863865778, 'recall': 0.6200175823022319, 'f1-score': 0.6226883282926625, 'support': 381065}}
[[ 37231  27250  15907]
 [ 28966 158930  32799]
 [ 13281  26595  40106]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9071643
{'0': {'precision': 0.5277468636179684, 'recall': 0.40936647766289314, 'f1-score': 0.4610794983702558, 'support': 101938}, '1': {'precision': 0.6317635577598522, 'recall': 0.7540599853694221, 'f1-score': 0.6875155520097685, 'support': 177710}, '2': {'precision': 0.5079771255646292, 'recall': 0.450200656694637, 'f1-score': 0.47734698038149703, 'support': 101417}, 'accuracy': 0.5809822471231942, 'macro avg': {'precision': 0.55582918231415, 'recall': 0.5378757065756508, 'f1-score': 0.5419806769205072, 'support': 381065}, 'weighted avg': {'precision': 0.5709936041787617, 'recall': 0.5809822471231942, 'f1-score': 0.5710075954545114, 'support': 381065}}
[[ 41730  39574  20634]
 [ 20116 134004  23590]
 [ 17226  38533  45658]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9610094
{'0': {'precision': 0.5527836304176416, 'recall': 0.3673874384680807, 'f1-score': 0.4414087094743144, 'support': 116403}, '1': {'precision': 0.5416155042089389, 'recall': 0.7787795381310418, 'f1-score': 0.6388982973837041, 'support': 148960}, '2': {'precision': 0.5319667094900296, 'recall': 0.411565919344523, 'f1-score': 0.46408435948288884, 'support': 115702}, 'accuracy': 0.5416162596932282, 'macro avg': {'precision': 0.54212194803887, 'recall': 0.5192442986478819, 'f1-score': 0.5147971221136358, 'support': 381065}, 'weighted avg': {'precision': 0.5420973604500117, 'recall': 0.5416162596932282, 'f1-score': 0.5254932280532308, 'support': 381065}}
[[ 42765  49859  23779]
 [ 14836 116007  18117]
 [ 19762  48321  47619]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0366942
{'0': {'precision': 0.5416211608641219, 'recall': 0.31659504235176883, 'f1-score': 0.39960693755220367, 'support': 128448}, '1': {'precision': 0.4467700282061614, 'recall': 0.7779292639367267, 'f1-score': 0.5675768434278801, 'support': 125424}, '2': {'precision': 0.521400600518318, 'recall': 0.3590606401295669, 'f1-score': 0.42526445172824795, 'support': 127193}, 'accuracy': 0.4826132024720192, 'macro avg': {'precision': 0.5032639298628672, 'recall': 0.48452831547268743, 'f1-score': 0.4641494109027772, 'support': 381065}, 'weighted avg': {'precision': 0.5036525145844691, 'recall': 0.4826132024720192, 'f1-score': 0.46345671036037134, 'support': 381065}}
[[40666 61252 26530]
 [12462 97571 15391]
 [21954 59569 45670]]
Evaluating performance on  val set...
519/519 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8025434
{'0': {'precision': 0.44949827592886754, 'recall': 0.45293773179777475, 'f1-score': 0.451211449461362, 'support': 25615}, '1': {'precision': 0.7688105039213464, 'recall': 0.7474970012973978, 'f1-score': 0.7580039593146289, 'support': 81702}, '2': {'precision': 0.44842380831182055, 'recall': 0.4849020995517811, 'f1-score': 0.46595009161833884, 'support': 25434}, 'accuracy': 0.6403492252412412, 'macro avg': {'precision': 0.5555775293873448, 'recall': 0.5617789442156512, 'f1-score': 0.5583885001314433, 'support': 132751}, 'weighted avg': {'precision': 0.6458140825297183, 'recall': 0.6403492252412412, 'f1-score': 0.6428516198906029, 'support': 132751}}
[[11602  9327  4686]
 [10146 61072 10484]
 [ 4063  9038 12333]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.88453215
{'0': {'precision': 0.5134901621961278, 'recall': 0.3975372453633323, 'f1-score': 0.4481346288965435, 'support': 32890}, '1': {'precision': 0.6584708740919792, 'recall': 0.7787008501198506, 'f1-score': 0.7135568015934733, 'support': 67167}, '2': {'precision': 0.5045410489284561, 'recall': 0.42989539365021107, 'f1-score': 0.46423675909563844, 'support': 32694}, 'accuracy': 0.5983608409729494, 'macro avg': {'precision': 0.558834028405521, 'recall': 0.5353778297111312, 'f1-score': 0.5419760631952184, 'support': 132751}, 'weighted avg': {'precision': 0.5846409419773376, 'recall': 0.5983608409729494, 'f1-score': 0.5863938820717655, 'support': 132751}}
[[13075 13765  6050]
 [ 7112 52303  7752]
 [ 5276 13363 14055]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.94723153
{'0': {'precision': 0.5396658014276444, 'recall': 0.35082261126344655, 'f1-score': 0.4252205036431037, 'support': 37928}, '1': {'precision': 0.567725170338688, 'recall': 0.8006487813431528, 'f1-score': 0.6643629326776179, 'support': 57030}, '2': {'precision': 0.5316080529150251, 'recall': 0.3891725981001773, 'f1-score': 0.44937366330583567, 'support': 37793}, 'accuracy': 0.5549864031156074, 'macro avg': {'precision': 0.5463330082271192, 'recall': 0.5135479969022588, 'f1-score': 0.512985699875519, 'support': 132751}, 'weighted avg': {'precision': 0.5494261747540932, 'recall': 0.5549864031156074, 'f1-score': 0.534832582580151, 'support': 132751}}
[[13306 17637  6985]
 [ 5395 45661  5974]
 [ 5955 17130 14708]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0278484
{'0': {'precision': 0.5388893570405325, 'recall': 0.30107577505237637, 'f1-score': 0.3863172997055048, 'support': 42481}, '1': {'precision': 0.4719207978736375, 'recall': 0.8040967259431611, 'f1-score': 0.5947723466047913, 'support': 48136}, '2': {'precision': 0.526500981517834, 'recall': 0.33737599088622017, 'f1-score': 0.41123631261481497, 'support': 42134}, 'accuracy': 0.4949943879895443, 'macro avg': {'precision': 0.5124370454773347, 'recall': 0.48084949729391924, 'f1-score': 0.46410865297503695, 'support': 132751}, 'weighted avg': {'precision': 0.5106743501605011, 'recall': 0.4949943879895443, 'f1-score': 0.46981294062319984, 'support': 132751}}
[[12790 21929  7762]
 [ 4408 38706  5022]
 [ 6536 21383 14215]]
training model: results/WBA/W6/deepVOL_L2/seq2seq
Epoch 1/50
1489/1489 - 49s - loss: 12.2607 - accuracy10: 0.4571 - accuracy20: 0.4682 - accuracy30: 0.4673 - accuracy50: 0.4532 - val_loss: 11.8823 - val_accuracy10: 0.5639 - val_accuracy20: 0.5499 - val_accuracy30: 0.5244 - val_accuracy50: 0.4768 - 49s/epoch - 33ms/step
Epoch 2/50
1489/1489 - 41s - loss: 11.6264 - accuracy10: 0.5141 - accuracy20: 0.5217 - accuracy30: 0.5155 - accuracy50: 0.4890 - val_loss: 11.9075 - val_accuracy10: 0.5973 - val_accuracy20: 0.5657 - val_accuracy30: 0.5300 - val_accuracy50: 0.4772 - 41s/epoch - 28ms/step
Epoch 3/50
1489/1489 - 41s - loss: 11.4377 - accuracy10: 0.5363 - accuracy20: 0.5372 - accuracy30: 0.5272 - accuracy50: 0.4973 - val_loss: 11.9437 - val_accuracy10: 0.6192 - val_accuracy20: 0.5788 - val_accuracy30: 0.5356 - val_accuracy50: 0.4782 - 41s/epoch - 28ms/step
Epoch 4/50
1489/1489 - 41s - loss: 11.3408 - accuracy10: 0.5447 - accuracy20: 0.5446 - accuracy30: 0.5328 - accuracy50: 0.5012 - val_loss: 11.8545 - val_accuracy10: 0.6191 - val_accuracy20: 0.5822 - val_accuracy30: 0.5407 - val_accuracy50: 0.4840 - 41s/epoch - 28ms/step
Epoch 5/50
1489/1489 - 40s - loss: 11.2553 - accuracy10: 0.5522 - accuracy20: 0.5497 - accuracy30: 0.5370 - accuracy50: 0.5052 - val_loss: 11.8142 - val_accuracy10: 0.6274 - val_accuracy20: 0.5888 - val_accuracy30: 0.5447 - val_accuracy50: 0.4853 - 40s/epoch - 27ms/step
Epoch 6/50
1489/1489 - 40s - loss: 11.1957 - accuracy10: 0.5562 - accuracy20: 0.5537 - accuracy30: 0.5406 - accuracy50: 0.5078 - val_loss: 11.7223 - val_accuracy10: 0.6211 - val_accuracy20: 0.5871 - val_accuracy30: 0.5474 - val_accuracy50: 0.4906 - 40s/epoch - 27ms/step
Epoch 7/50
1489/1489 - 40s - loss: 11.1373 - accuracy10: 0.5597 - accuracy20: 0.5574 - accuracy30: 0.5442 - accuracy50: 0.5109 - val_loss: 11.5994 - val_accuracy10: 0.6281 - val_accuracy20: 0.5913 - val_accuracy30: 0.5489 - val_accuracy50: 0.4908 - 40s/epoch - 27ms/step
Epoch 8/50
1489/1489 - 40s - loss: 11.0918 - accuracy10: 0.5628 - accuracy20: 0.5593 - accuracy30: 0.5461 - accuracy50: 0.5123 - val_loss: 11.6605 - val_accuracy10: 0.6215 - val_accuracy20: 0.5865 - val_accuracy30: 0.5458 - val_accuracy50: 0.4890 - 40s/epoch - 27ms/step
Epoch 9/50
1489/1489 - 40s - loss: 11.0559 - accuracy10: 0.5649 - accuracy20: 0.5613 - accuracy30: 0.5477 - accuracy50: 0.5136 - val_loss: 11.5992 - val_accuracy10: 0.6325 - val_accuracy20: 0.5929 - val_accuracy30: 0.5492 - val_accuracy50: 0.4904 - 40s/epoch - 27ms/step
Epoch 10/50
1489/1489 - 40s - loss: 11.0190 - accuracy10: 0.5685 - accuracy20: 0.5639 - accuracy30: 0.5496 - accuracy50: 0.5158 - val_loss: 11.5150 - val_accuracy10: 0.6297 - val_accuracy20: 0.5926 - val_accuracy30: 0.5501 - val_accuracy50: 0.4901 - 40s/epoch - 27ms/step
Epoch 11/50
1489/1489 - 40s - loss: 10.9904 - accuracy10: 0.5696 - accuracy20: 0.5653 - accuracy30: 0.5515 - accuracy50: 0.5167 - val_loss: 11.5169 - val_accuracy10: 0.6273 - val_accuracy20: 0.5921 - val_accuracy30: 0.5500 - val_accuracy50: 0.4914 - 40s/epoch - 27ms/step
Epoch 12/50
1489/1489 - 41s - loss: 10.9660 - accuracy10: 0.5715 - accuracy20: 0.5665 - accuracy30: 0.5526 - accuracy50: 0.5178 - val_loss: 11.4602 - val_accuracy10: 0.6332 - val_accuracy20: 0.5960 - val_accuracy30: 0.5534 - val_accuracy50: 0.4935 - 41s/epoch - 27ms/step
Epoch 13/50
1489/1489 - 40s - loss: 10.9450 - accuracy10: 0.5718 - accuracy20: 0.5673 - accuracy30: 0.5540 - accuracy50: 0.5188 - val_loss: 11.4257 - val_accuracy10: 0.6266 - val_accuracy20: 0.5924 - val_accuracy30: 0.5526 - val_accuracy50: 0.4950 - 40s/epoch - 27ms/step
Epoch 14/50
1489/1489 - 39s - loss: 10.9217 - accuracy10: 0.5734 - accuracy20: 0.5686 - accuracy30: 0.5554 - accuracy50: 0.5203 - val_loss: 11.4789 - val_accuracy10: 0.6297 - val_accuracy20: 0.5941 - val_accuracy30: 0.5532 - val_accuracy50: 0.4960 - 39s/epoch - 26ms/step
Epoch 15/50
1489/1489 - 39s - loss: 10.9028 - accuracy10: 0.5741 - accuracy20: 0.5694 - accuracy30: 0.5561 - accuracy50: 0.5207 - val_loss: 11.4670 - val_accuracy10: 0.6293 - val_accuracy20: 0.5951 - val_accuracy30: 0.5543 - val_accuracy50: 0.4954 - 39s/epoch - 26ms/step
Epoch 16/50
1489/1489 - 40s - loss: 10.8824 - accuracy10: 0.5748 - accuracy20: 0.5705 - accuracy30: 0.5573 - accuracy50: 0.5222 - val_loss: 11.5695 - val_accuracy10: 0.6313 - val_accuracy20: 0.5930 - val_accuracy30: 0.5514 - val_accuracy50: 0.4921 - 40s/epoch - 27ms/step
Epoch 17/50
1489/1489 - 39s - loss: 10.8642 - accuracy10: 0.5758 - accuracy20: 0.5709 - accuracy30: 0.5578 - accuracy50: 0.5228 - val_loss: 11.6250 - val_accuracy10: 0.6311 - val_accuracy20: 0.5941 - val_accuracy30: 0.5519 - val_accuracy50: 0.4927 - 39s/epoch - 26ms/step
Epoch 18/50
1489/1489 - 40s - loss: 10.8517 - accuracy10: 0.5766 - accuracy20: 0.5720 - accuracy30: 0.5588 - accuracy50: 0.5237 - val_loss: 11.5876 - val_accuracy10: 0.6317 - val_accuracy20: 0.5963 - val_accuracy30: 0.5550 - val_accuracy50: 0.4955 - 40s/epoch - 27ms/step
Epoch 19/50
1489/1489 - 39s - loss: 10.8377 - accuracy10: 0.5767 - accuracy20: 0.5724 - accuracy30: 0.5595 - accuracy50: 0.5242 - val_loss: 11.6002 - val_accuracy10: 0.6277 - val_accuracy20: 0.5936 - val_accuracy30: 0.5536 - val_accuracy50: 0.4964 - 39s/epoch - 26ms/step
Epoch 20/50
1489/1489 - 40s - loss: 10.8152 - accuracy10: 0.5776 - accuracy20: 0.5731 - accuracy30: 0.5603 - accuracy50: 0.5248 - val_loss: 11.5882 - val_accuracy10: 0.6290 - val_accuracy20: 0.5954 - val_accuracy30: 0.5552 - val_accuracy50: 0.4964 - 40s/epoch - 27ms/step
Epoch 21/50
1489/1489 - 41s - loss: 10.7983 - accuracy10: 0.5789 - accuracy20: 0.5744 - accuracy30: 0.5611 - accuracy50: 0.5255 - val_loss: 11.5202 - val_accuracy10: 0.6288 - val_accuracy20: 0.5936 - val_accuracy30: 0.5532 - val_accuracy50: 0.4947 - 41s/epoch - 28ms/step
Epoch 22/50
1489/1489 - 40s - loss: 10.7852 - accuracy10: 0.5793 - accuracy20: 0.5753 - accuracy30: 0.5617 - accuracy50: 0.5264 - val_loss: 11.4832 - val_accuracy10: 0.6237 - val_accuracy20: 0.5919 - val_accuracy30: 0.5540 - val_accuracy50: 0.4961 - 40s/epoch - 27ms/step
Epoch 23/50
1489/1489 - 40s - loss: 10.7685 - accuracy10: 0.5797 - accuracy20: 0.5753 - accuracy30: 0.5624 - accuracy50: 0.5269 - val_loss: 11.5435 - val_accuracy10: 0.6241 - val_accuracy20: 0.5921 - val_accuracy30: 0.5538 - val_accuracy50: 0.4968 - 40s/epoch - 27ms/step
testing model: results/WBA/W6/deepVOL_L2/seq2seq
Evaluating performance on  test set...
5183/5183 - 46s - 46s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.90181994
{'0': {'precision': 0.48094543447405774, 'recall': 0.4001147992652847, 'f1-score': 0.43682231612117733, 'support': 304880}, '1': {'precision': 0.7123451220237534, 'recall': 0.6922543381937268, 'f1-score': 0.7021560451628402, 'support': 709339}, '2': {'precision': 0.42858333745802585, 'recall': 0.5262570332767152, 'f1-score': 0.4724245069548937, 'support': 312621}, 'accuracy': 0.5860156461969793, 'macro avg': {'precision': 0.5406246313186124, 'recall': 0.5395420569119089, 'f1-score': 0.5371342894129705, 'support': 1326840}, 'weighted avg': {'precision': 0.5923163095121668, 'recall': 0.5860156461969793, 'f1-score': 0.5870601402185149, 'support': 1326840}}
[[121987  91843  91050]
 [ 89998 491043 128298]
 [ 41655 106447 164519]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.96116847
{'0': {'precision': 0.5468410032411524, 'recall': 0.3510291042518774, 'f1-score': 0.42758324602632986, 'support': 380185}, '1': {'precision': 0.588398244340607, 'recall': 0.7392046962354244, 'f1-score': 0.6552361887426026, 'support': 561471}, '2': {'precision': 0.48472106302081264, 'recall': 0.474944442136745, 'f1-score': 0.47978295277072225, 'support': 385184}, 'accuracy': 0.5512639052184137, 'macro avg': {'precision': 0.5399867702008573, 'recall': 0.5217260808746823, 'f1-score': 0.5208674625132182, 'support': 1326840}, 'weighted avg': {'precision': 0.5463930054897433, 'recall': 0.5512639052184137, 'f1-score': 0.5390714565434083, 'support': 1326840}}
[[133456 139099 107630]
 [ 59585 415042  86844]
 [ 51008 151235 182941]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0090821
{'0': {'precision': 0.5680459859267207, 'recall': 0.308760876438969, 'f1-score': 0.4000661582395839, 'support': 426955}, '1': {'precision': 0.49622742674574793, 'recall': 0.7682722795366729, 'f1-score': 0.6029859468064206, 'support': 467402}, '2': {'precision': 0.5095641630178511, 'recall': 0.43727036669649444, 'f1-score': 0.4706573354172682, 'support': 432483}, 'accuracy': 0.5125192185945555, 'macro avg': {'precision': 0.5246125252301066, 'recall': 0.504767840890712, 'f1-score': 0.4912364801544243, 'support': 1326840}, 'weighted avg': {'precision': 0.5236845464046972, 'recall': 0.5125192185945555, 'f1-score': 0.49455727932053795, 'support': 1326840}}
[[131827 177853 117275]
 [ 43572 359092  64738]
 [ 56672 186699 189112]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0732268
{'0': {'precision': 0.5464937917513796, 'recall': 0.2638288829101999, 'f1-score': 0.355860328492822, 'support': 456436}, '1': {'precision': 0.41638345326542475, 'recall': 0.7595844591036133, 'f1-score': 0.5379031124942105, 'support': 408239}, '2': {'precision': 0.5048388300563079, 'recall': 0.39516406478205834, 'f1-score': 0.4433189388367402, 'support': 462165}, 'accuracy': 0.4621084682403304, 'macro avg': {'precision': 0.48923869169103745, 'recall': 0.47285913559862386, 'f1-score': 0.44569412660792423, 'support': 1326840}, 'weighted avg': {'precision': 0.4919524907316858, 'recall': 0.4621084682403304, 'f1-score': 0.44233441183937455, 'support': 1326840}}
[[120421 216193 119822]
 [ 38839 310092  59308]
 [ 61092 218442 182631]]
Evaluating performance on  train set...
1489/1489 - 14s - 14s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8682511
{'0': {'precision': 0.4535801214325835, 'recall': 0.4226714189576531, 'f1-score': 0.4375806368374877, 'support': 80242}, '1': {'precision': 0.7476455129886519, 'recall': 0.6840358431702822, 'f1-score': 0.7144275877723971, 'support': 220851}, '2': {'precision': 0.4162157494819249, 'recall': 0.5424638007352389, 'f1-score': 0.4710270023777727, 'support': 79974}, 'accuracy': 0.5992883141284866, 'macro avg': {'precision': 0.5391471279677201, 'recall': 0.549723687621058, 'f1-score': 0.5410117423292192, 'support': 381067}, 'weighted avg': {'precision': 0.6161669040932897, 'recall': 0.5992883141284866, 'f1-score': 0.6050492594121123, 'support': 381067}}
[[ 33916  25779  20547]
 [ 29479 151070  40302]
 [ 11379  25212  43383]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.92487746
{'0': {'precision': 0.5196576216636146, 'recall': 0.3678907101678436, 'f1-score': 0.4307984244271298, 'support': 101821}, '1': {'precision': 0.6288448691510065, 'recall': 0.730802119783521, 'f1-score': 0.6760007077288149, 'support': 177754}, '2': {'precision': 0.47773144938433143, 'recall': 0.482047846135656, 'f1-score': 0.4798799417364309, 'support': 101492}, 'accuracy': 0.567579979373706, 'macro avg': {'precision': 0.5420779800663175, 'recall': 0.5269135586956736, 'f1-score': 0.5288930246307918, 'support': 381067}, 'weighted avg': {'precision': 0.5594230668816598, 'recall': 0.567579979373706, 'f1-score': 0.5582486314006103, 'support': 381067}}
[[ 37459  38902  25460]
 [ 19826 129903  28025]
 [ 14799  37769  48924]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.97162783
{'0': {'precision': 0.549165336042967, 'recall': 0.32546735605089516, 'f1-score': 0.40870960249339655, 'support': 116239}, '1': {'precision': 0.5369798163057036, 'recall': 0.7627186889734453, 'f1-score': 0.6302454605192018, 'support': 149013}, '2': {'precision': 0.5060335651256951, 'recall': 0.43920908345205717, 'f1-score': 0.4702592263885807, 'support': 115815}, 'accuracy': 0.5310194795141012, 'macro avg': {'precision': 0.5307262391581219, 'recall': 0.5091317094921326, 'f1-score': 0.503071429800393, 'support': 381067}, 'weighted avg': {'precision': 0.5312915581997197, 'recall': 0.5310194795141012, 'f1-score': 0.5140456523308794, 'support': 381067}}
[[ 37832  49797  28610]
 [ 14314 113655  21044]
 [ 16744  48204  50867]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0412467
{'0': {'precision': 0.544601153255131, 'recall': 0.27868176014449875, 'f1-score': 0.36869563426052293, 'support': 128444}, '1': {'precision': 0.44356239146613746, 'recall': 0.770289999601101, 'f1-score': 0.5629542386864868, 'support': 125345}, '2': {'precision': 0.5046587348719104, 'recall': 0.38724681406056033, 'f1-score': 0.4382246247955046, 'support': 127278}, 'accuracy': 0.47664846339357647, 'macro avg': {'precision': 0.49760742653105955, 'recall': 0.4787395246020533, 'f1-score': 0.45662483258083814, 'support': 381067}, 'weighted avg': {'precision': 0.49802536809551096, 'recall': 0.47664846339357647, 'f1-score': 0.45581641782111426, 'support': 381067}}
[[35795 61497 31152]
 [11567 96552 17226]
 [18365 59625 49288]]
Evaluating performance on  val set...
519/519 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.82370734
{'0': {'precision': 0.4435235318617243, 'recall': 0.41384268614954145, 'f1-score': 0.4281693538659483, 'support': 25732}, '1': {'precision': 0.774869109947644, 'recall': 0.7163250052076313, 'f1-score': 0.7444478402607987, 'support': 81611}, '2': {'precision': 0.42096885605309786, 'recall': 0.5516549254201267, 'f1-score': 0.47753210915408983, 'support': 25409}, 'accuracy': 0.6261751235386285, 'macro avg': {'precision': 0.546453832620822, 'recall': 0.5606075389257664, 'f1-score': 0.5500497677602789, 'support': 132752}, 'weighted avg': {'precision': 0.6429054787668452, 'recall': 0.6261751235386285, 'f1-score': 0.6320537533649128, 'support': 132752}}
[[10649  8915  6168]
 [10039 58460 13112]
 [ 3322  8070 14017]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.88849455
{'0': {'precision': 0.514595532422468, 'recall': 0.3603778743051548, 'f1-score': 0.42389595540946123, 'support': 32921}, '1': {'precision': 0.6621549721641858, 'recall': 0.7594249058625668, 'f1-score': 0.7074621485219899, 'support': 67189}, '2': {'precision': 0.48385317727801946, 'recall': 0.4837938851786043, 'f1-score': 0.4838235294117647, 'support': 32642}, 'accuracy': 0.5926916355309148, 'macro avg': {'precision': 0.5535345606215578, 'recall': 0.5345322217821086, 'f1-score': 0.538393877781072, 'support': 132752}, 'weighted avg': {'precision': 0.5817197884802388, 'recall': 0.5926916355309148, 'f1-score': 0.5821510839169102, 'support': 132752}}
[[11864 13473  7584]
 [ 6902 51025  9262]
 [ 4289 12561 15792]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.94432336
{'0': {'precision': 0.547766040151827, 'recall': 0.31554267650158063, 'f1-score': 0.40042121450181356, 'support': 37960}, '1': {'precision': 0.5700999708576714, 'recall': 0.7885245614342545, 'f1-score': 0.6617543240381221, 'support': 57061}, '2': {'precision': 0.5142356548401227, 'recall': 0.4356099758819008, 'f1-score': 0.471668603733517, 'support': 37731}, 'accuracy': 0.5529709533566349, 'macro avg': {'precision': 0.5440338886165405, 'recall': 0.5132257379392453, 'f1-score': 0.5112813807578175, 'support': 132752}, 'weighted avg': {'precision': 0.5478358052160842, 'recall': 0.5529709533566349, 'f1-score': 0.5330004886848971, 'support': 132752}}
[[11978 17469  8513]
 [ 5054 44994  7013]
 [ 4835 16460 16436]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0227687
{'0': {'precision': 0.547844221349241, 'recall': 0.26637739942460975, 'f1-score': 0.358460928203094, 'support': 42406}, '1': {'precision': 0.47460804993277333, 'recall': 0.7964231748463083, 'f1-score': 0.5947750811562839, 'support': 48311}, '2': {'precision': 0.5158704609837754, 'recall': 0.38122992744141787, 'f1-score': 0.4384464903760653, 'support': 42035}, 'accuracy': 0.49563848378932146, 'macro avg': {'precision': 0.5127742440885966, 'recall': 0.4813435005707787, 'f1-score': 0.46389416657848104, 'support': 132752}, 'weighted avg': {'precision': 0.5110679038981796, 'recall': 0.49563848378932146, 'f1-score': 0.46978705624080647, 'support': 132752}}
[[11296 21854  9256]
 [ 4052 38476  5783]
 [ 5271 20739 16025]]
training model: results/WBA/W6/deepVOL_L3/seq2seq
Epoch 1/50
1489/1489 - 68s - loss: 12.8306 - accuracy10: 0.4378 - accuracy20: 0.4312 - accuracy30: 0.4247 - accuracy50: 0.4111 - val_loss: 13.1717 - val_accuracy10: 0.5750 - val_accuracy20: 0.4999 - val_accuracy30: 0.4416 - val_accuracy50: 0.3848 - 68s/epoch - 46ms/step
Epoch 2/50
1489/1489 - 61s - loss: 12.5694 - accuracy10: 0.4469 - accuracy20: 0.4509 - accuracy30: 0.4474 - accuracy50: 0.4315 - val_loss: 12.1090 - val_accuracy10: 0.5705 - val_accuracy20: 0.5473 - val_accuracy30: 0.5185 - val_accuracy50: 0.4735 - 61s/epoch - 41ms/step
Epoch 3/50
1489/1489 - 60s - loss: 11.6768 - accuracy10: 0.5167 - accuracy20: 0.5210 - accuracy30: 0.5148 - accuracy50: 0.4885 - val_loss: 12.0601 - val_accuracy10: 0.6137 - val_accuracy20: 0.5753 - val_accuracy30: 0.5346 - val_accuracy50: 0.4805 - 60s/epoch - 41ms/step
Epoch 4/50
1489/1489 - 59s - loss: 11.4231 - accuracy10: 0.5386 - accuracy20: 0.5391 - accuracy30: 0.5296 - accuracy50: 0.4992 - val_loss: 11.6148 - val_accuracy10: 0.6119 - val_accuracy20: 0.5824 - val_accuracy30: 0.5458 - val_accuracy50: 0.4919 - 59s/epoch - 40ms/step
Epoch 5/50
1489/1489 - 59s - loss: 11.2896 - accuracy10: 0.5489 - accuracy20: 0.5474 - accuracy30: 0.5366 - accuracy50: 0.5060 - val_loss: 11.3567 - val_accuracy10: 0.6083 - val_accuracy20: 0.5822 - val_accuracy30: 0.5511 - val_accuracy50: 0.4993 - 59s/epoch - 39ms/step
Epoch 6/50
1489/1489 - 58s - loss: 11.1968 - accuracy10: 0.5561 - accuracy20: 0.5532 - accuracy30: 0.5413 - accuracy50: 0.5091 - val_loss: 11.3818 - val_accuracy10: 0.6128 - val_accuracy20: 0.5845 - val_accuracy30: 0.5512 - val_accuracy50: 0.4972 - 58s/epoch - 39ms/step
Epoch 7/50
1489/1489 - 58s - loss: 11.1268 - accuracy10: 0.5594 - accuracy20: 0.5558 - accuracy30: 0.5440 - accuracy50: 0.5113 - val_loss: 11.3209 - val_accuracy10: 0.6305 - val_accuracy20: 0.5933 - val_accuracy30: 0.5528 - val_accuracy50: 0.4961 - 58s/epoch - 39ms/step
Epoch 8/50
1489/1489 - 59s - loss: 11.0648 - accuracy10: 0.5631 - accuracy20: 0.5595 - accuracy30: 0.5470 - accuracy50: 0.5142 - val_loss: 11.3122 - val_accuracy10: 0.6244 - val_accuracy20: 0.5918 - val_accuracy30: 0.5541 - val_accuracy50: 0.4985 - 59s/epoch - 39ms/step
Epoch 9/50
1489/1489 - 60s - loss: 11.0303 - accuracy10: 0.5646 - accuracy20: 0.5613 - accuracy30: 0.5487 - accuracy50: 0.5153 - val_loss: 11.3306 - val_accuracy10: 0.6349 - val_accuracy20: 0.5971 - val_accuracy30: 0.5545 - val_accuracy50: 0.4959 - 60s/epoch - 40ms/step
Epoch 10/50
1489/1489 - 59s - loss: 10.9902 - accuracy10: 0.5666 - accuracy20: 0.5636 - accuracy30: 0.5509 - accuracy50: 0.5172 - val_loss: 11.1070 - val_accuracy10: 0.6226 - val_accuracy20: 0.5947 - val_accuracy30: 0.5605 - val_accuracy50: 0.5065 - 59s/epoch - 40ms/step
Epoch 11/50
1489/1489 - 58s - loss: 10.9607 - accuracy10: 0.5681 - accuracy20: 0.5645 - accuracy30: 0.5528 - accuracy50: 0.5184 - val_loss: 11.2118 - val_accuracy10: 0.6316 - val_accuracy20: 0.5968 - val_accuracy30: 0.5587 - val_accuracy50: 0.5020 - 58s/epoch - 39ms/step
Epoch 12/50
1489/1489 - 59s - loss: 10.9300 - accuracy10: 0.5706 - accuracy20: 0.5668 - accuracy30: 0.5541 - accuracy50: 0.5195 - val_loss: 11.0709 - val_accuracy10: 0.6221 - val_accuracy20: 0.5962 - val_accuracy30: 0.5620 - val_accuracy50: 0.5081 - 59s/epoch - 39ms/step
Epoch 13/50
1489/1489 - 58s - loss: 10.9015 - accuracy10: 0.5712 - accuracy20: 0.5682 - accuracy30: 0.5551 - accuracy50: 0.5207 - val_loss: 11.0611 - val_accuracy10: 0.6211 - val_accuracy20: 0.5955 - val_accuracy30: 0.5622 - val_accuracy50: 0.5095 - 58s/epoch - 39ms/step
Epoch 14/50
1489/1489 - 58s - loss: 10.8744 - accuracy10: 0.5736 - accuracy20: 0.5702 - accuracy30: 0.5569 - accuracy50: 0.5221 - val_loss: 11.0252 - val_accuracy10: 0.6164 - val_accuracy20: 0.5935 - val_accuracy30: 0.5626 - val_accuracy50: 0.5110 - 58s/epoch - 39ms/step
Epoch 15/50
1489/1489 - 60s - loss: 10.8555 - accuracy10: 0.5750 - accuracy20: 0.5708 - accuracy30: 0.5574 - accuracy50: 0.5223 - val_loss: 10.9717 - val_accuracy10: 0.6109 - val_accuracy20: 0.5911 - val_accuracy30: 0.5621 - val_accuracy50: 0.5105 - 60s/epoch - 40ms/step
Epoch 16/50
1489/1489 - 60s - loss: 10.8399 - accuracy10: 0.5750 - accuracy20: 0.5713 - accuracy30: 0.5586 - accuracy50: 0.5233 - val_loss: 11.0694 - val_accuracy10: 0.6126 - val_accuracy20: 0.5900 - val_accuracy30: 0.5587 - val_accuracy50: 0.5076 - 60s/epoch - 40ms/step
Epoch 17/50
1489/1489 - 58s - loss: 10.8180 - accuracy10: 0.5765 - accuracy20: 0.5727 - accuracy30: 0.5599 - accuracy50: 0.5241 - val_loss: 10.9724 - val_accuracy10: 0.6104 - val_accuracy20: 0.5899 - val_accuracy30: 0.5611 - val_accuracy50: 0.5118 - 58s/epoch - 39ms/step
Epoch 18/50
1489/1489 - 60s - loss: 10.8008 - accuracy10: 0.5773 - accuracy20: 0.5736 - accuracy30: 0.5608 - accuracy50: 0.5256 - val_loss: 10.9466 - val_accuracy10: 0.6095 - val_accuracy20: 0.5913 - val_accuracy30: 0.5636 - val_accuracy50: 0.5140 - 60s/epoch - 40ms/step
Epoch 19/50
1489/1489 - 58s - loss: 10.7824 - accuracy10: 0.5781 - accuracy20: 0.5751 - accuracy30: 0.5626 - accuracy50: 0.5263 - val_loss: 10.9577 - val_accuracy10: 0.6056 - val_accuracy20: 0.5898 - val_accuracy30: 0.5631 - val_accuracy50: 0.5143 - 58s/epoch - 39ms/step
Epoch 20/50
1489/1489 - 57s - loss: 10.7738 - accuracy10: 0.5779 - accuracy20: 0.5745 - accuracy30: 0.5614 - accuracy50: 0.5265 - val_loss: 11.0679 - val_accuracy10: 0.6213 - val_accuracy20: 0.5966 - val_accuracy30: 0.5643 - val_accuracy50: 0.5114 - 57s/epoch - 38ms/step
Epoch 21/50
1489/1489 - 58s - loss: 10.7553 - accuracy10: 0.5788 - accuracy20: 0.5758 - accuracy30: 0.5633 - accuracy50: 0.5281 - val_loss: 10.9797 - val_accuracy10: 0.6126 - val_accuracy20: 0.5927 - val_accuracy30: 0.5635 - val_accuracy50: 0.5144 - 58s/epoch - 39ms/step
Epoch 22/50
1489/1489 - 59s - loss: 10.7378 - accuracy10: 0.5791 - accuracy20: 0.5767 - accuracy30: 0.5640 - accuracy50: 0.5290 - val_loss: 10.9447 - val_accuracy10: 0.6069 - val_accuracy20: 0.5899 - val_accuracy30: 0.5633 - val_accuracy50: 0.5150 - 59s/epoch - 40ms/step
Epoch 23/50
1489/1489 - 57s - loss: 10.7291 - accuracy10: 0.5796 - accuracy20: 0.5775 - accuracy30: 0.5652 - accuracy50: 0.5295 - val_loss: 10.9400 - val_accuracy10: 0.6090 - val_accuracy20: 0.5897 - val_accuracy30: 0.5626 - val_accuracy50: 0.5140 - 57s/epoch - 38ms/step
Epoch 24/50
1489/1489 - 57s - loss: 10.7178 - accuracy10: 0.5802 - accuracy20: 0.5781 - accuracy30: 0.5655 - accuracy50: 0.5298 - val_loss: 10.9579 - val_accuracy10: 0.6072 - val_accuracy20: 0.5904 - val_accuracy30: 0.5634 - val_accuracy50: 0.5145 - 57s/epoch - 38ms/step
Epoch 25/50
1489/1489 - 58s - loss: 10.7011 - accuracy10: 0.5814 - accuracy20: 0.5788 - accuracy30: 0.5665 - accuracy50: 0.5306 - val_loss: 10.9658 - val_accuracy10: 0.5987 - val_accuracy20: 0.5849 - val_accuracy30: 0.5613 - val_accuracy50: 0.5149 - 58s/epoch - 39ms/step
Epoch 26/50
1489/1489 - 58s - loss: 10.6926 - accuracy10: 0.5820 - accuracy20: 0.5794 - accuracy30: 0.5670 - accuracy50: 0.5314 - val_loss: 10.9662 - val_accuracy10: 0.6059 - val_accuracy20: 0.5888 - val_accuracy30: 0.5622 - val_accuracy50: 0.5141 - 58s/epoch - 39ms/step
Epoch 27/50
1489/1489 - 59s - loss: 10.6774 - accuracy10: 0.5823 - accuracy20: 0.5795 - accuracy30: 0.5677 - accuracy50: 0.5325 - val_loss: 10.9557 - val_accuracy10: 0.6018 - val_accuracy20: 0.5872 - val_accuracy30: 0.5628 - val_accuracy50: 0.5157 - 59s/epoch - 40ms/step
Epoch 28/50
1489/1489 - 60s - loss: 10.6666 - accuracy10: 0.5823 - accuracy20: 0.5808 - accuracy30: 0.5686 - accuracy50: 0.5329 - val_loss: 10.9589 - val_accuracy10: 0.5942 - val_accuracy20: 0.5840 - val_accuracy30: 0.5611 - val_accuracy50: 0.5162 - 60s/epoch - 40ms/step
Epoch 29/50
1489/1489 - 61s - loss: 10.6529 - accuracy10: 0.5835 - accuracy20: 0.5815 - accuracy30: 0.5694 - accuracy50: 0.5339 - val_loss: 10.9776 - val_accuracy10: 0.5997 - val_accuracy20: 0.5851 - val_accuracy30: 0.5616 - val_accuracy50: 0.5156 - 61s/epoch - 41ms/step
Epoch 30/50
1489/1489 - 59s - loss: 10.6346 - accuracy10: 0.5842 - accuracy20: 0.5824 - accuracy30: 0.5703 - accuracy50: 0.5347 - val_loss: 11.0072 - val_accuracy10: 0.5971 - val_accuracy20: 0.5834 - val_accuracy30: 0.5606 - val_accuracy50: 0.5145 - 59s/epoch - 39ms/step
Epoch 31/50
1489/1489 - 58s - loss: 10.6205 - accuracy10: 0.5853 - accuracy20: 0.5827 - accuracy30: 0.5709 - accuracy50: 0.5359 - val_loss: 10.9948 - val_accuracy10: 0.5960 - val_accuracy20: 0.5830 - val_accuracy30: 0.5606 - val_accuracy50: 0.5149 - 58s/epoch - 39ms/step
Epoch 32/50
1489/1489 - 59s - loss: 10.6132 - accuracy10: 0.5849 - accuracy20: 0.5836 - accuracy30: 0.5713 - accuracy50: 0.5354 - val_loss: 11.0017 - val_accuracy10: 0.5946 - val_accuracy20: 0.5816 - val_accuracy30: 0.5604 - val_accuracy50: 0.5144 - 59s/epoch - 40ms/step
Epoch 33/50
1489/1489 - 57s - loss: 10.6004 - accuracy10: 0.5855 - accuracy20: 0.5844 - accuracy30: 0.5722 - accuracy50: 0.5365 - val_loss: 10.9931 - val_accuracy10: 0.5973 - val_accuracy20: 0.5831 - val_accuracy30: 0.5605 - val_accuracy50: 0.5144 - 57s/epoch - 39ms/step
testing model: results/WBA/W6/deepVOL_L3/seq2seq
Evaluating performance on  test set...
5183/5183 - 81s - 81s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9038435
{'0': {'precision': 0.4304368230280705, 'recall': 0.5986683285226975, 'f1-score': 0.5008018723616753, 'support': 304880}, '1': {'precision': 0.7752439781943582, 'recall': 0.5647581762739677, 'f1-score': 0.6534696587351948, 'support': 709339}, '2': {'precision': 0.4368249001435032, 'recall': 0.5394327316463066, 'f1-score': 0.4827366085805274, 'support': 312621}, 'accuracy': 0.5665830092550722, 'macro avg': {'precision': 0.5475019004553107, 'recall': 0.5676197454809906, 'f1-score': 0.5456693798924658, 'support': 1326840}, 'weighted avg': {'precision': 0.6162785294089478, 'recall': 0.5665830092550722, 'f1-score': 0.5781628458700709, 'support': 1326840}}
[[182522  53972  68386]
 [159704 400605 149030]
 [ 81813  62170 168638]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9228058
{'0': {'precision': 0.4917046511627907, 'recall': 0.5561318831621448, 'f1-score': 0.5219375821571616, 'support': 380185}, '1': {'precision': 0.6547365068645583, 'recall': 0.6078087737389821, 'f1-score': 0.6304005083592024, 'support': 561471}, '2': {'precision': 0.49565775321342237, 'recall': 0.48334042950901385, 'f1-score': 0.48942160579182853, 'support': 385184}, 'accuracy': 0.5568681981248681, 'macro avg': {'precision': 0.5473663037469237, 'recall': 0.5490936954700469, 'f1-score': 0.5472532321027309, 'support': 1326840}, 'weighted avg': {'precision': 0.5618414654832797, 'recall': 0.5568681981248682, 'f1-score': 0.5583957487765593, 'support': 1326840}}
[[211433  86515  82237]
 [113004 341267 107200]
 [105563  93446 186175]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9500177
{'0': {'precision': 0.5157754337187568, 'recall': 0.5144429740839198, 'f1-score': 0.5151083422157651, 'support': 426955}, '1': {'precision': 0.5585674136307237, 'recall': 0.6395222955828174, 'f1-score': 0.5963097952612648, 'support': 467402}, '2': {'precision': 0.5228020686412788, 'recall': 0.4422462848250683, 'f1-score': 0.4791620476321107, 'support': 432483}, 'accuracy': 0.5349718127279853, 'macro avg': {'precision': 0.5323816386635865, 'recall': 0.5320705181639352, 'f1-score': 0.5301933950363802, 'support': 1326840}, 'weighted avg': {'precision': 0.5331399668546362, 'recall': 0.5349718127279853, 'f1-score': 0.5319962565354646, 'support': 1326840}}
[[219644 115432  91879]
 [ 85787 298914  82701]
 [120421 120798 191264]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0076439
{'0': {'precision': 0.5051005871337111, 'recall': 0.4544207731204375, 'f1-score': 0.47842228180953206, 'support': 456436}, '1': {'precision': 0.4656693441393632, 'recall': 0.6327935351595512, 'f1-score': 0.5365179944568537, 'support': 408239}, '2': {'precision': 0.5142910894759704, 'recall': 0.40221565890969674, 'f1-score': 0.4514007775487061, 'support': 462165}, 'accuracy': 0.4911179946338669, 'macro avg': {'precision': 0.49502034024968156, 'recall': 0.49647665572989513, 'f1-score': 0.4887803512716973, 'support': 1326840}, 'weighted avg': {'precision': 0.49616971175027424, 'recall': 0.4911179946338669, 'f1-score': 0.4868849013557662, 'support': 1326840}}
[[207414 148625 100397]
 [ 74746 258331  75162]
 [128479 147796 185890]]
Evaluating performance on  train set...
1489/1489 - 25s - 25s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8648788
{'0': {'precision': 0.4242096609896885, 'recall': 0.5916477655093343, 'f1-score': 0.49412976956223065, 'support': 80242}, '1': {'precision': 0.7932038317939494, 'recall': 0.6070020058772657, 'f1-score': 0.6877221962868532, 'support': 220851}, '2': {'precision': 0.43414614662592615, 'recall': 0.5436516867982094, 'f1-score': 0.4827670441927604, 'support': 79974}, 'accuracy': 0.5904735912582302, 'macro avg': {'precision': 0.5505198798031881, 'recall': 0.5807671527282698, 'f1-score': 0.5548730033472814, 'support': 381067}, 'weighted avg': {'precision': 0.6401490945238553, 'recall': 0.5904735912582302, 'f1-score': 0.6039434202742093, 'support': 381067}}
[[ 47475  18076  14691]
 [ 44817 134057  41977]
 [ 19622  16874  43478]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8968544
{'0': {'precision': 0.48721286506207606, 'recall': 0.5403502224492001, 'f1-score': 0.5124076238550479, 'support': 101821}, '1': {'precision': 0.6815088435454176, 'recall': 0.6518221812167377, 'f1-score': 0.6663350250887813, 'support': 177754}, '2': {'precision': 0.5014674411494956, 'recall': 0.4848559492373783, 'f1-score': 0.49302181122321187, 'support': 101492}, 'accuracy': 0.5775677243109479, 'macro avg': {'precision': 0.5567297165856631, 'recall': 0.559009450967772, 'f1-score': 0.5572548200556803, 'support': 381067}, 'weighted avg': {'precision': 0.5816414374537875, 'recall': 0.5775677243109479, 'f1-score': 0.5790460532736822, 'support': 381067}}
[[ 55019  28127  18675]
 [ 31644 115864  30246]
 [ 26263  26020  49209]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.929764
{'0': {'precision': 0.5146540880503144, 'recall': 0.49278641419833275, 'f1-score': 0.5034829194116173, 'support': 116239}, '1': {'precision': 0.5881419470573354, 'recall': 0.6864635971358204, 'f1-score': 0.6335105608833922, 'support': 149013}, '2': {'precision': 0.5320472021952568, 'recall': 0.4402970254284851, 'f1-score': 0.48184335106634285, 'support': 115815}, 'accuracy': 0.5525694956529954, 'macro avg': {'precision': 0.5449477457676356, 'recall': 0.5398490122542127, 'f1-score': 0.5396122771204508, 'support': 381067}, 'weighted avg': {'precision': 0.5486770547435985, 'recall': 0.5525694956529954, 'f1-score': 0.5477523584622976, 'support': 381067}}
[[ 57281  37337  21621]
 [ 23492 102292  23229]
 [ 30527  34295  50993]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9935063
{'0': {'precision': 0.5146344885646135, 'recall': 0.42833452710909037, 'f1-score': 0.46753544735690405, 'support': 128444}, '1': {'precision': 0.4851125959196866, 'recall': 0.6944991822569707, 'f1-score': 0.5712223417937479, 'support': 125345}, '2': {'precision': 0.5278994879374967, 'recall': 0.39284086802118195, 'f1-score': 0.4504646542909011, 'support': 127278}, 'accuracy': 0.5040294751316697, 'macro avg': {'precision': 0.509215524140599, 'recall': 0.505224859129081, 'f1-score': 0.49640748114718436, 'support': 381067}, 'weighted avg': {'precision': 0.5093543697314515, 'recall': 0.5040294751316697, 'f1-score': 0.495939631879131, 'support': 381067}}
[[55017 48182 25245]
 [18823 87052 19470]
 [33065 44213 50000]]
Evaluating performance on  val set...
519/519 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8297864
{'0': {'precision': 0.41200398472522, 'recall': 0.5786180631120783, 'f1-score': 0.48129949894941004, 'support': 25732}, '1': {'precision': 0.8128442079716233, 'recall': 0.6402078151229613, 'f1-score': 0.7162705892836335, 'support': 81611}, '2': {'precision': 0.4238928748144483, 'recall': 0.5394545239875634, 'f1-score': 0.47474240193956185, 'support': 25409}, 'accuracy': 0.6089851753645896, 'macro avg': {'precision': 0.5495803558370972, 'recall': 0.5860934674075343, 'f1-score': 0.5574374967242018, 'support': 132752}, 'weighted avg': {'precision': 0.6607012267075586, 'recall': 0.6089851753645896, 'f1-score': 0.624495958327371, 'support': 132752}}
[[14889  6273  4570]
 [15304 52248 14059]
 [ 5945  5757 13707]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8732327
{'0': {'precision': 0.47667964543119873, 'recall': 0.5243461620242399, 'f1-score': 0.4993780194983655, 'support': 32921}, '1': {'precision': 0.7046371747096933, 'recall': 0.6782509041658605, 'f1-score': 0.6911923071089472, 'support': 67189}, '2': {'precision': 0.48948722776627124, 'recall': 0.477850621898168, 'f1-score': 0.48359893346561666, 'support': 32642}, 'accuracy': 0.5908084247318308, 'macro avg': {'precision': 0.5569346826357211, 'recall': 0.5601492293627561, 'f1-score': 0.5580564200243098, 'support': 132752}, 'weighted avg': {'precision': 0.5952036867810406, 'recall': 0.5908084247318308, 'f1-score': 0.5925799994609001, 'support': 132752}}
[[17262  9970  5689]
 [11039 45571 10579]
 [ 7912  9132 15598]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9154861
{'0': {'precision': 0.5080526672694394, 'recall': 0.4736828240252898, 'f1-score': 0.4902661140800524, 'support': 37960}, '1': {'precision': 0.6118144096567333, 'recall': 0.7106079458824767, 'f1-score': 0.6575209184666276, 'support': 57061}, '2': {'precision': 0.522309795721409, 'recall': 0.4303092947443746, 'f1-score': 0.47186700767263423, 'support': 37731}, 'accuracy': 0.5631930215740629, 'macro avg': {'precision': 0.5473922908825273, 'recall': 0.5382000215507138, 'f1-score': 0.5398846800731048, 'support': 132752}, 'weighted avg': {'precision': 0.5567049248322833, 'recall': 0.5631930215740629, 'f1-score': 0.5569280830842412, 'support': 132752}}
[[17981 13376  6603]
 [ 8267 40548  8246]
 [ 9144 12351 16236]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9857065
{'0': {'precision': 0.5153638333877624, 'recall': 0.40935245012498234, 'f1-score': 0.45628145986936347, 'support': 42406}, '1': {'precision': 0.5088039745744137, 'recall': 0.7207468278445902, 'f1-score': 0.5965086598256043, 'support': 48311}, '2': {'precision': 0.5260821309655938, 'recall': 0.38339479005590577, 'f1-score': 0.4435453907443339, 'support': 42035}, 'accuracy': 0.5144555260937689, 'macro avg': {'precision': 0.51674997964259, 'recall': 0.5044980226751595, 'f1-score': 0.4987785034797672, 'support': 132752}, 'weighted avg': {'precision': 0.5163704494805704, 'recall': 0.5144555260937689, 'f1-score': 0.5032800406170383, 'support': 132752}}
[[17359 17418  7629]
 [ 6602 34820  6889]
 [ 9722 16197 16116]]
training model: results/WBA/W7/deepLOB_L1/seq2seq
Epoch 1/50
1230/1230 - 35s - loss: 12.6645 - accuracy10: 0.4242 - accuracy20: 0.4390 - accuracy30: 0.4375 - accuracy50: 0.4181 - val_loss: 14.0423 - val_accuracy10: 0.3502 - val_accuracy20: 0.3541 - val_accuracy30: 0.3539 - val_accuracy50: 0.3525 - 35s/epoch - 29ms/step
Epoch 2/50
1230/1230 - 30s - loss: 12.5582 - accuracy10: 0.4268 - accuracy20: 0.4474 - accuracy30: 0.4451 - accuracy50: 0.4220 - val_loss: 12.9821 - val_accuracy10: 0.3886 - val_accuracy20: 0.4139 - val_accuracy30: 0.4171 - val_accuracy50: 0.4013 - 30s/epoch - 24ms/step
Epoch 3/50
1230/1230 - 29s - loss: 12.4391 - accuracy10: 0.4438 - accuracy20: 0.4595 - accuracy30: 0.4562 - accuracy50: 0.4296 - val_loss: 12.7668 - val_accuracy10: 0.4076 - val_accuracy20: 0.4332 - val_accuracy30: 0.4366 - val_accuracy50: 0.4172 - 29s/epoch - 24ms/step
Epoch 4/50
1230/1230 - 29s - loss: 12.3255 - accuracy10: 0.4596 - accuracy20: 0.4705 - accuracy30: 0.4659 - accuracy50: 0.4378 - val_loss: 12.8468 - val_accuracy10: 0.4413 - val_accuracy20: 0.4452 - val_accuracy30: 0.4376 - val_accuracy50: 0.4161 - 29s/epoch - 24ms/step
Epoch 5/50
1230/1230 - 28s - loss: 12.2434 - accuracy10: 0.4713 - accuracy20: 0.4787 - accuracy30: 0.4723 - accuracy50: 0.4423 - val_loss: 12.9894 - val_accuracy10: 0.4883 - val_accuracy20: 0.4567 - val_accuracy30: 0.4341 - val_accuracy50: 0.4114 - 28s/epoch - 23ms/step
Epoch 6/50
1230/1230 - 26s - loss: 12.1810 - accuracy10: 0.4789 - accuracy20: 0.4852 - accuracy30: 0.4775 - accuracy50: 0.4467 - val_loss: 13.0016 - val_accuracy10: 0.5039 - val_accuracy20: 0.4620 - val_accuracy30: 0.4330 - val_accuracy50: 0.4083 - 26s/epoch - 21ms/step
Epoch 7/50
1230/1230 - 29s - loss: 12.1252 - accuracy10: 0.4862 - accuracy20: 0.4901 - accuracy30: 0.4809 - accuracy50: 0.4496 - val_loss: 13.0039 - val_accuracy10: 0.5059 - val_accuracy20: 0.4616 - val_accuracy30: 0.4323 - val_accuracy50: 0.4093 - 29s/epoch - 24ms/step
Epoch 8/50
1230/1230 - 27s - loss: 12.0759 - accuracy10: 0.4916 - accuracy20: 0.4936 - accuracy30: 0.4844 - accuracy50: 0.4525 - val_loss: 13.0633 - val_accuracy10: 0.5041 - val_accuracy20: 0.4583 - val_accuracy30: 0.4290 - val_accuracy50: 0.4064 - 27s/epoch - 22ms/step
Epoch 9/50
1230/1230 - 29s - loss: 12.0329 - accuracy10: 0.4968 - accuracy20: 0.4976 - accuracy30: 0.4876 - accuracy50: 0.4550 - val_loss: 12.9497 - val_accuracy10: 0.5118 - val_accuracy20: 0.4637 - val_accuracy30: 0.4345 - val_accuracy50: 0.4097 - 29s/epoch - 23ms/step
Epoch 10/50
1230/1230 - 30s - loss: 11.9939 - accuracy10: 0.5008 - accuracy20: 0.5003 - accuracy30: 0.4901 - accuracy50: 0.4566 - val_loss: 13.0786 - val_accuracy10: 0.5194 - val_accuracy20: 0.4583 - val_accuracy30: 0.4232 - val_accuracy50: 0.4010 - 30s/epoch - 24ms/step
Epoch 11/50
1230/1230 - 28s - loss: 11.9626 - accuracy10: 0.5030 - accuracy20: 0.5020 - accuracy30: 0.4915 - accuracy50: 0.4582 - val_loss: 13.0301 - val_accuracy10: 0.5178 - val_accuracy20: 0.4631 - val_accuracy30: 0.4296 - val_accuracy50: 0.4070 - 28s/epoch - 23ms/step
Epoch 12/50
1230/1230 - 29s - loss: 11.9348 - accuracy10: 0.5056 - accuracy20: 0.5038 - accuracy30: 0.4933 - accuracy50: 0.4596 - val_loss: 12.9342 - val_accuracy10: 0.5084 - val_accuracy20: 0.4669 - val_accuracy30: 0.4377 - val_accuracy50: 0.4120 - 29s/epoch - 23ms/step
Epoch 13/50
1230/1230 - 27s - loss: 11.9072 - accuracy10: 0.5085 - accuracy20: 0.5065 - accuracy30: 0.4946 - accuracy50: 0.4604 - val_loss: 12.9233 - val_accuracy10: 0.5137 - val_accuracy20: 0.4651 - val_accuracy30: 0.4325 - val_accuracy50: 0.4069 - 27s/epoch - 22ms/step
testing model: results/WBA/W7/deepLOB_L1/seq2seq
Evaluating performance on  test set...
4192/4192 - 33s - 33s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0534395
{'0': {'precision': 0.2965738758029979, 'recall': 0.7153447822931462, 'f1-score': 0.4193075657272308, 'support': 224591}, '1': {'precision': 0.7065852606856818, 'recall': 0.24463170332349218, 'f1-score': 0.3634358141307182, 'support': 629669}, '2': {'precision': 0.3382467424735505, 'recall': 0.4843345972863082, 'f1-score': 0.3983182984606945, 'support': 218890}, 'accuracy': 0.3920355961421982, 'macro avg': {'precision': 0.44713529298741, 'recall': 0.48143702763431556, 'f1-score': 0.39368722610621454, 'support': 1073150}, 'weighted avg': {'precision': 0.5456473813643937, 'recall': 0.3920355961421982, 'f1-score': 0.3822437343262182, 'support': 1073150}}
[[160660  22116  41815]
 [310035 154037 165597]
 [ 71025  41849 106016]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0479095
{'0': {'precision': 0.36310294212678745, 'recall': 0.6843988167739691, 'f1-score': 0.47447600320882066, 'support': 287350}, '1': {'precision': 0.592157257326845, 'recall': 0.2562187577919996, 'f1-score': 0.3576758281374745, 'support': 505326}, '2': {'precision': 0.4044399415763518, 'recall': 0.4511790754223208, 'f1-score': 0.42653292009417537, 'support': 280474}, 'accuracy': 0.42182360341052044, 'macro avg': {'precision': 0.4532333803433281, 'recall': 0.46393221666276313, 'f1-score': 0.41956158381349024, 'support': 1073150}, 'weighted avg': {'precision': 0.48176394428529407, 'recall': 0.42182360341052044, 'f1-score': 0.4069468101215541, 'support': 1073150}}
[[196662  32901  57787]
 [247296 129474 128556]
 [ 97657  56273 126544]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0525546
{'0': {'precision': 0.3906427515946269, 'recall': 0.6585188778144607, 'f1-score': 0.49038321493197107, 'support': 319555}, '1': {'precision': 0.5156955929696729, 'recall': 0.26020662369779524, 'f1-score': 0.3458874229766, 'support': 439543}, '2': {'precision': 0.42788885903979734, 'recall': 0.42602498949218603, 'f1-score': 0.42695489009726584, 'support': 314052}, 'accuracy': 0.4273391417788753, 'macro avg': {'precision': 0.4447424012013657, 'recall': 0.4482501636681473, 'f1-score': 0.4210751760019457, 'support': 1073150}, 'weighted avg': {'precision': 0.4527620411551567, 'recall': 0.4273391417788753, 'f1-score': 0.41263834594401183, 'support': 1073150}}
[[210433  41305  67817]
 [214098 114372 111073]
 [114153  66105 133794]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0674866
{'0': {'precision': 0.3829299572631996, 'recall': 0.6316240660394522, 'f1-score': 0.476796249503895, 'support': 324291}, '1': {'precision': 0.4694647894785638, 'recall': 0.25131936878277744, 'f1-score': 0.3273812089380384, 'support': 423119}, '2': {'precision': 0.4115397816763382, 'recall': 0.3938509240498557, 'f1-score': 0.4025011019970854, 'support': 325740}, 'accuracy': 0.40950566090481294, 'macro avg': {'precision': 0.4213115094727005, 'recall': 0.42559811962402844, 'f1-score': 0.4022261868130063, 'support': 1073150}, 'weighted avg': {'precision': 0.425732823476188, 'recall': 0.40950566090481294, 'f1-score': 0.39533397125942515, 'support': 1073150}}
[[204830  47709  71752]
 [205087 106338 111694]
 [124985  72462 128293]]
Evaluating performance on  train set...
1230/1230 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0535372
{'0': {'precision': 0.33468763443430044, 'recall': 0.723151005021882, 'f1-score': 0.4575928505201589, 'support': 77461}, '1': {'precision': 0.6280064208921803, 'recall': 0.2894283671629729, 'f1-score': 0.39624151020477644, 'support': 160855}, '2': {'precision': 0.3974184227026143, 'recall': 0.380883332680174, 'f1-score': 0.3889752329622391, 'support': 76551}, 'accuracy': 0.41836394414149464, 'macro avg': {'precision': 0.4533708260096983, 'recall': 0.4644875682883429, 'f1-score': 0.41426986456239145, 'support': 314867}, 'weighted avg': {'precision': 0.49978558997873657, 'recall': 0.41836394414149464, 'f1-score': 0.4095680747001868, 'support': 314867}}
[[56016 10186 11259]
 [81349 46556 32950]
 [30003 17391 29157]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0610797
{'0': {'precision': 0.40087370833983416, 'recall': 0.6888714733542319, 'f1-score': 0.5068165782825409, 'support': 96976}, '1': {'precision': 0.4987132057262345, 'recall': 0.3047798484538194, 'f1-score': 0.3783423751391862, 'support': 122075}, '2': {'precision': 0.45935042177757857, 'recall': 0.3529264423478333, 'f1-score': 0.39916663223811183, 'support': 95816}, 'accuracy': 0.4377276754947327, 'macro avg': {'precision': 0.4529791119478824, 'recall': 0.44885925471862825, 'f1-score': 0.4281085285532797, 'support': 314867}, 'weighted avg': {'precision': 0.45660124224524734, 'recall': 0.4377276754947327, 'f1-score': 0.4242481427878144, 'support': 314867}}
[[66804 14653 15519]
 [60587 37206 24282]
 [39255 22745 33816]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0688385
{'0': {'precision': 0.42538435072343045, 'recall': 0.6639752020953853, 'f1-score': 0.5185517665107962, 'support': 106138}, '1': {'precision': 0.42721686619345267, 'recall': 0.3109607395197748, 'f1-score': 0.35993417198962374, 'support': 103743}, '2': {'precision': 0.47760768667046655, 'recall': 0.33521612405463586, 'f1-score': 0.3939397331422942, 'support': 104986}, 'accuracy': 0.4380452699076118, 'macro avg': {'precision': 0.44340296786244987, 'recall': 0.4367173552232653, 'f1-score': 0.42414189054757134, 'support': 314867}, 'weighted avg': {'precision': 0.4434009412208215, 'recall': 0.4380452699076118, 'f1-score': 0.42474077951109296, 'support': 314867}}
[[70473 17688 17977]
 [50967 32260 20516]
 [44229 25564 35193]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0831952
{'0': {'precision': 0.4105902302937476, 'recall': 0.6365152500212002, 'f1-score': 0.4991797827532698, 'support': 106131}, '1': {'precision': 0.396877278883217, 'recall': 0.29338095146416127, 'f1-score': 0.3373700698495633, 'support': 103882}, '2': {'precision': 0.4467952030022027, 'recall': 0.31338813969901, 'f1-score': 0.36838565022421527, 'support': 104854}, 'accuracy': 0.4157025029615679, 'macro avg': {'precision': 0.4180875707263891, 'recall': 0.4144281137281238, 'f1-score': 0.4016451676090161, 'support': 314867}, 'weighted avg': {'precision': 0.41812264045404895, 'recall': 0.4157025029615679, 'f1-score': 0.40223915522461695, 'support': 314867}}
[[67554 19761 18816]
 [51535 30477 21870]
 [45440 26554 32860]]
Evaluating performance on  val set...
400/400 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0591781
{'0': {'precision': 0.3298476564573491, 'recall': 0.7406436233611442, 'f1-score': 0.45642513496639603, 'support': 25170}, '1': {'precision': 0.6274211925560198, 'recall': 0.257496346809547, 'f1-score': 0.36513834974927134, 'support': 51325}, '2': {'precision': 0.3972997080765488, 'recall': 0.38054368932038835, 'f1-score': 0.38874122267624067, 'support': 25750}, 'accuracy': 0.4074233458848843, 'macro avg': {'precision': 0.4515228523633059, 'recall': 0.45956121983035986, 'f1-score': 0.40343490246396935, 'support': 102245}, 'weighted avg': {'precision': 0.4962113130611797, 'recall': 0.4074233458848843, 'f1-score': 0.39355501913930985, 'support': 102245}}
[[18642  2771  3757]
 [27001 13216 11108]
 [10874  5077  9799]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0594962
{'0': {'precision': 0.3952186010243323, 'recall': 0.7136091645067358, 'f1-score': 0.5087022970414471, 'support': 31251}, '1': {'precision': 0.5066983372921615, 'recall': 0.271731376745134, 'f1-score': 0.35375277768564883, 'support': 39252}, '2': {'precision': 0.45655684754521964, 'recall': 0.35624724339991176, 'f1-score': 0.40021235179614223, 'support': 31742}, 'accuracy': 0.43302850995158687, 'macro avg': {'precision': 0.45282459528723784, 'recall': 0.44719592821726056, 'f1-score': 0.4208891421744127, 'support': 102245}, 'weighted avg': {'precision': 0.4570583118077529, 'recall': 0.43302850995158687, 'f1-score': 0.4155362118956672, 'support': 102245}}
[[22301  3874  5076]
 [20202 10666  8384]
 [13924  6510 11308]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0645115
{'0': {'precision': 0.41874755102767786, 'recall': 0.69121538190157, 'f1-score': 0.5215394853593612, 'support': 34014}, '1': {'precision': 0.443095742178311, 'recall': 0.2776123802505527, 'f1-score': 0.34135556361000363, 'support': 33925}, '2': {'precision': 0.4717034293994526, 'recall': 0.34160205211916284, 'f1-score': 0.396246830092984, 'support': 34306}, 'accuracy': 0.43667661010318354, 'macro avg': {'precision': 0.4445155742018138, 'recall': 0.4368099380904285, 'f1-score': 0.41971395968744957, 'support': 102245}, 'weighted avg': {'precision': 0.44459445550425214, 'recall': 0.43667661010318354, 'f1-score': 0.41971514796471804, 'support': 102245}}
[[23511  4649  5854]
 [17236  9418  7271]
 [15399  7188 11719]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0768083
{'0': {'precision': 0.4071969017821924, 'recall': 0.6632885514018692, 'f1-score': 0.5046103939387206, 'support': 34240}, '1': {'precision': 0.4101463324562618, 'recall': 0.26228782287822877, 'f1-score': 0.31996110771003633, 'support': 33875}, '2': {'precision': 0.4440503063527894, 'recall': 0.32276589510694403, 'f1-score': 0.3738165529878855, 'support': 34130}, 'accuracy': 0.4167636559244951, 'macro avg': {'precision': 0.4204645135304146, 'recall': 0.4161140897956807, 'f1-score': 0.39946268487888076, 'support': 102245}, 'weighted avg': {'precision': 0.42047597324855823, 'recall': 0.4167636559244951, 'f1-score': 0.3997740854380733, 'support': 102245}}
[[22711  5282  6247]
 [17445  8885  7545]
 [15618  7496 11016]]
training model: results/WBA/W7/deepOF_L1/seq2seq
Epoch 1/50
1230/1230 - 30s - loss: 13.0075 - accuracy10: 0.3809 - accuracy20: 0.3921 - accuracy30: 0.3958 - accuracy50: 0.3905 - val_loss: 13.0383 - val_accuracy10: 0.4694 - val_accuracy20: 0.4119 - val_accuracy30: 0.3800 - val_accuracy50: 0.3668 - 30s/epoch - 25ms/step
Epoch 2/50
1230/1230 - 26s - loss: 12.9158 - accuracy10: 0.3810 - accuracy20: 0.3939 - accuracy30: 0.3988 - accuracy50: 0.3946 - val_loss: 13.0547 - val_accuracy10: 0.4723 - val_accuracy20: 0.4090 - val_accuracy30: 0.3784 - val_accuracy50: 0.3684 - 26s/epoch - 21ms/step
Epoch 3/50
1230/1230 - 26s - loss: 12.8862 - accuracy10: 0.3811 - accuracy20: 0.3935 - accuracy30: 0.3984 - accuracy50: 0.3945 - val_loss: 12.9823 - val_accuracy10: 0.4427 - val_accuracy20: 0.4024 - val_accuracy30: 0.3929 - val_accuracy50: 0.3869 - 26s/epoch - 21ms/step
Epoch 4/50
1230/1230 - 26s - loss: 12.8577 - accuracy10: 0.3854 - accuracy20: 0.3964 - accuracy30: 0.4022 - accuracy50: 0.3978 - val_loss: 12.9648 - val_accuracy10: 0.4144 - val_accuracy20: 0.3954 - val_accuracy30: 0.3944 - val_accuracy50: 0.3898 - 26s/epoch - 21ms/step
Epoch 5/50
1230/1230 - 24s - loss: 12.8406 - accuracy10: 0.3907 - accuracy20: 0.3991 - accuracy30: 0.4036 - accuracy50: 0.3994 - val_loss: 12.9390 - val_accuracy10: 0.4040 - val_accuracy20: 0.3952 - val_accuracy30: 0.3982 - val_accuracy50: 0.3937 - 24s/epoch - 19ms/step
Epoch 6/50
1230/1230 - 25s - loss: 12.8234 - accuracy10: 0.3950 - accuracy20: 0.4027 - accuracy30: 0.4057 - accuracy50: 0.4005 - val_loss: 12.9245 - val_accuracy10: 0.4060 - val_accuracy20: 0.3988 - val_accuracy30: 0.4008 - val_accuracy50: 0.3958 - 25s/epoch - 20ms/step
Epoch 7/50
1230/1230 - 27s - loss: 12.8096 - accuracy10: 0.3977 - accuracy20: 0.4045 - accuracy30: 0.4088 - accuracy50: 0.4024 - val_loss: 12.9175 - val_accuracy10: 0.4077 - val_accuracy20: 0.3991 - val_accuracy30: 0.4025 - val_accuracy50: 0.3969 - 27s/epoch - 22ms/step
Epoch 8/50
1230/1230 - 27s - loss: 12.7936 - accuracy10: 0.4015 - accuracy20: 0.4062 - accuracy30: 0.4093 - accuracy50: 0.4034 - val_loss: 12.9217 - val_accuracy10: 0.4212 - val_accuracy20: 0.4025 - val_accuracy30: 0.4022 - val_accuracy50: 0.3950 - 27s/epoch - 22ms/step
Epoch 9/50
1230/1230 - 26s - loss: 12.7823 - accuracy10: 0.4024 - accuracy20: 0.4078 - accuracy30: 0.4107 - accuracy50: 0.4054 - val_loss: 12.9194 - val_accuracy10: 0.4166 - val_accuracy20: 0.4029 - val_accuracy30: 0.4027 - val_accuracy50: 0.3974 - 26s/epoch - 21ms/step
Epoch 10/50
1230/1230 - 25s - loss: 12.7689 - accuracy10: 0.4070 - accuracy20: 0.4109 - accuracy30: 0.4127 - accuracy50: 0.4063 - val_loss: 12.9150 - val_accuracy10: 0.4226 - val_accuracy20: 0.4041 - val_accuracy30: 0.4022 - val_accuracy50: 0.3957 - 25s/epoch - 20ms/step
Epoch 11/50
1230/1230 - 27s - loss: 12.7550 - accuracy10: 0.4075 - accuracy20: 0.4118 - accuracy30: 0.4142 - accuracy50: 0.4070 - val_loss: 12.9126 - val_accuracy10: 0.4228 - val_accuracy20: 0.4038 - val_accuracy30: 0.4022 - val_accuracy50: 0.3955 - 27s/epoch - 22ms/step
Epoch 12/50
1230/1230 - 27s - loss: 12.7449 - accuracy10: 0.4121 - accuracy20: 0.4149 - accuracy30: 0.4165 - accuracy50: 0.4095 - val_loss: 12.9114 - val_accuracy10: 0.4271 - val_accuracy20: 0.4068 - val_accuracy30: 0.4034 - val_accuracy50: 0.3954 - 27s/epoch - 22ms/step
Epoch 13/50
1230/1230 - 27s - loss: 12.7302 - accuracy10: 0.4138 - accuracy20: 0.4158 - accuracy30: 0.4184 - accuracy50: 0.4107 - val_loss: 12.9112 - val_accuracy10: 0.4296 - val_accuracy20: 0.4074 - val_accuracy30: 0.4005 - val_accuracy50: 0.3949 - 27s/epoch - 22ms/step
Epoch 14/50
1230/1230 - 25s - loss: 12.7191 - accuracy10: 0.4156 - accuracy20: 0.4193 - accuracy30: 0.4203 - accuracy50: 0.4118 - val_loss: 12.9112 - val_accuracy10: 0.4337 - val_accuracy20: 0.4092 - val_accuracy30: 0.4023 - val_accuracy50: 0.3944 - 25s/epoch - 20ms/step
Epoch 15/50
1230/1230 - 27s - loss: 12.7051 - accuracy10: 0.4183 - accuracy20: 0.4211 - accuracy30: 0.4222 - accuracy50: 0.4135 - val_loss: 12.8989 - val_accuracy10: 0.4410 - val_accuracy20: 0.4126 - val_accuracy30: 0.4059 - val_accuracy50: 0.3953 - 27s/epoch - 22ms/step
Epoch 16/50
1230/1230 - 26s - loss: 12.6911 - accuracy10: 0.4210 - accuracy20: 0.4227 - accuracy30: 0.4246 - accuracy50: 0.4154 - val_loss: 12.9117 - val_accuracy10: 0.4378 - val_accuracy20: 0.4100 - val_accuracy30: 0.4037 - val_accuracy50: 0.3955 - 26s/epoch - 21ms/step
Epoch 17/50
1230/1230 - 26s - loss: 12.6781 - accuracy10: 0.4238 - accuracy20: 0.4253 - accuracy30: 0.4259 - accuracy50: 0.4161 - val_loss: 12.9073 - val_accuracy10: 0.4395 - val_accuracy20: 0.4128 - val_accuracy30: 0.4058 - val_accuracy50: 0.3958 - 26s/epoch - 21ms/step
Epoch 18/50
1230/1230 - 26s - loss: 12.6669 - accuracy10: 0.4248 - accuracy20: 0.4277 - accuracy30: 0.4282 - accuracy50: 0.4180 - val_loss: 12.9040 - val_accuracy10: 0.4435 - val_accuracy20: 0.4150 - val_accuracy30: 0.4061 - val_accuracy50: 0.3969 - 26s/epoch - 21ms/step
Epoch 19/50
1230/1230 - 26s - loss: 12.6494 - accuracy10: 0.4283 - accuracy20: 0.4301 - accuracy30: 0.4304 - accuracy50: 0.4195 - val_loss: 12.9081 - val_accuracy10: 0.4514 - val_accuracy20: 0.4186 - val_accuracy30: 0.4078 - val_accuracy50: 0.3983 - 26s/epoch - 21ms/step
Epoch 20/50
1230/1230 - 25s - loss: 12.6368 - accuracy10: 0.4310 - accuracy20: 0.4329 - accuracy30: 0.4325 - accuracy50: 0.4216 - val_loss: 12.9110 - val_accuracy10: 0.4661 - val_accuracy20: 0.4215 - val_accuracy30: 0.4081 - val_accuracy50: 0.3979 - 25s/epoch - 21ms/step
Epoch 21/50
1230/1230 - 26s - loss: 12.6202 - accuracy10: 0.4327 - accuracy20: 0.4342 - accuracy30: 0.4343 - accuracy50: 0.4228 - val_loss: 12.9234 - val_accuracy10: 0.4627 - val_accuracy20: 0.4213 - val_accuracy30: 0.4075 - val_accuracy50: 0.3977 - 26s/epoch - 21ms/step
Epoch 22/50
1230/1230 - 25s - loss: 12.6043 - accuracy10: 0.4351 - accuracy20: 0.4367 - accuracy30: 0.4361 - accuracy50: 0.4238 - val_loss: 12.9508 - val_accuracy10: 0.4608 - val_accuracy20: 0.4210 - val_accuracy30: 0.4069 - val_accuracy50: 0.3957 - 25s/epoch - 21ms/step
Epoch 23/50
1230/1230 - 27s - loss: 12.5903 - accuracy10: 0.4372 - accuracy20: 0.4395 - accuracy30: 0.4385 - accuracy50: 0.4260 - val_loss: 12.9780 - val_accuracy10: 0.4659 - val_accuracy20: 0.4233 - val_accuracy30: 0.4086 - val_accuracy50: 0.3972 - 27s/epoch - 22ms/step
Epoch 24/50
1230/1230 - 26s - loss: 12.5785 - accuracy10: 0.4381 - accuracy20: 0.4415 - accuracy30: 0.4402 - accuracy50: 0.4268 - val_loss: 12.9535 - val_accuracy10: 0.4750 - val_accuracy20: 0.4258 - val_accuracy30: 0.4082 - val_accuracy50: 0.3976 - 26s/epoch - 21ms/step
Epoch 25/50
1230/1230 - 24s - loss: 12.5595 - accuracy10: 0.4394 - accuracy20: 0.4434 - accuracy30: 0.4431 - accuracy50: 0.4302 - val_loss: 13.0077 - val_accuracy10: 0.4747 - val_accuracy20: 0.4258 - val_accuracy30: 0.4065 - val_accuracy50: 0.3965 - 24s/epoch - 19ms/step
testing model: results/WBA/W7/deepOF_L1/seq2seq
Evaluating performance on  test set...
4192/4192 - 38s - 38s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0187217
{'0': {'precision': 0.32692951233610174, 'recall': 0.3827970203349229, 'f1-score': 0.3526644064181213, 'support': 224589}, '1': {'precision': 0.6350955057428752, 'recall': 0.49905188130888023, 'f1-score': 0.5589143184920694, 'support': 629668}, '2': {'precision': 0.30645549954025175, 'recall': 0.44156372208618105, 'f1-score': 0.36180789776109074, 'support': 218888}, 'accuracy': 0.4629961468394299, 'macro avg': {'precision': 0.42282683920640957, 'recall': 0.44113754124332805, 'f1-score': 0.42446220755709385, 'support': 1073145}, 'weighted avg': {'precision': 0.5035699001901179, 'recall': 0.4629961468394299, 'f1-score': 0.47554656136350015, 'support': 1073145}}
[[ 85972  95034  43583]
 [140277 314237 175154]
 [ 36719  85516  96653]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0429862
{'0': {'precision': 0.37906591115521493, 'recall': 0.4081197994062927, 'f1-score': 0.3930566867431517, 'support': 287347}, '1': {'precision': 0.5129731702610907, 'recall': 0.4366674912185227, 'f1-score': 0.4717546676472663, 'support': 505325}, '2': {'precision': 0.3693696664138818, 'recall': 0.4393577991464419, 'f1-score': 0.4013353091566383, 'support': 280473}, 'accuracy': 0.42972664458204624, 'macro avg': {'precision': 0.42046958261006245, 'recall': 0.4280483632570858, 'f1-score': 0.4220488878490188, 'support': 1073145}, 'weighted avg': {'precision': 0.43958629829426954, 'recall': 0.42972664458204624, 'f1-score': 0.43227784256510454, 'support': 1073145}}
[[117272 108833  61242]
 [135519 220659 149147]
 [ 56580 100665 123228]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0563077
{'0': {'precision': 0.4013414967279119, 'recall': 0.422989059683557, 'f1-score': 0.41188103726727, 'support': 319552}, '1': {'precision': 0.4465442654395935, 'recall': 0.3982895832480173, 'f1-score': 0.42103883422760846, 'support': 439542}, '2': {'precision': 0.3999965147990346, 'recall': 0.43854023709524886, 'f1-score': 0.41838253610464726, 'support': 314051}, 'accuracy': 0.4174235541329457, 'macro avg': {'precision': 0.4159607589888467, 'recall': 0.4199396266756077, 'f1-score': 0.4171008025331752, 'support': 1073145}, 'weighted avg': {'precision': 0.41946218167293253, 'recall': 0.4174235541329457, 'f1-score': 0.4175345497030716, 'support': 1073145}}
[[135167 111432  72953]
 [130841 175065 133636]
 [ 70780 105547 137724]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0661886
{'0': {'precision': 0.39173390794058316, 'recall': 0.4215745831650164, 'f1-score': 0.4061068112719652, 'support': 324289}, '1': {'precision': 0.4232564609454207, 'recall': 0.3739462134586887, 'f1-score': 0.39707631691218914, 'support': 423117}, '2': {'precision': 0.4009276967430708, 'recall': 0.43119491371926605, 'f1-score': 0.4155108428281728, 'support': 325739}, 'accuracy': 0.4057159097792004, 'macro avg': {'precision': 0.4053060218763582, 'recall': 0.4089052367809904, 'f1-score': 0.40623132367077575, 'support': 1073145}, 'weighted avg': {'precision': 0.4069531966951143, 'recall': 0.4057159097792004, 'f1-score': 0.4054007595763063, 'support': 1073145}}
[[136712 109470  78107]
 [133128 158223 131766]
 [ 79152 106130 140457]]
Evaluating performance on  train set...
1230/1230 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0321852
{'0': {'precision': 0.3744953102677185, 'recall': 0.38755753259108794, 'f1-score': 0.3809144727281917, 'support': 77782}, '1': {'precision': 0.5628193933494611, 'recall': 0.48916978737698597, 'f1-score': 0.5234164913868847, 'support': 160754}, '2': {'precision': 0.35198723772899193, 'recall': 0.4364805911097719, 'f1-score': 0.3897066994180776, 'support': 76331}, 'accuracy': 0.45129530881292734, 'macro avg': {'precision': 0.4297673137820572, 'recall': 0.43773597035928197, 'f1-score': 0.4313458878443847, 'support': 314867}, 'weighted avg': {'precision': 0.4651868910518874, 'recall': 0.45129530881292734, 'f1-score': 0.4557997066934063, 'support': 314867}}
[[30145 31589 16048]
 [36829 78636 45289]
 [13521 29493 33317]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0565588
{'0': {'precision': 0.42762006403415154, 'recall': 0.41291891669071273, 'f1-score': 0.4201409277745156, 'support': 97036}, '1': {'precision': 0.42871224797468566, 'recall': 0.4239467885549521, 'f1-score': 0.4263162013336024, 'support': 122079}, '2': {'precision': 0.4138981532181791, 'recall': 0.43418414236778347, 'f1-score': 0.42379852902949583, 'support': 95752}, 'accuracy': 0.4236614189483179, 'macro avg': {'precision': 0.4234101550756721, 'recall': 0.4236832825378161, 'f1-score': 0.423418552712538, 'support': 314867}, 'weighted avg': {'precision': 0.423870647038485, 'recall': 0.4236614189483179, 'f1-score': 0.4236474681747056, 'support': 314867}}
[[40068 35061 21907]
 [33360 51755 36964]
 [20272 33906 41574]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.068822
{'0': {'precision': 0.4478932418037638, 'recall': 0.42807047312010404, 'f1-score': 0.4377575661176743, 'support': 106083}, '1': {'precision': 0.36368267367712476, 'recall': 0.3842420398081673, 'f1-score': 0.37367978315730443, 'support': 104049}, '2': {'precision': 0.4380866844362035, 'recall': 0.43312168806989065, 'f1-score': 0.4355900385533145, 'support': 104735}, 'accuracy': 0.41526739861592354, 'macro avg': {'precision': 0.41655419997236404, 'recall': 0.41514473366605403, 'f1-score': 0.4156757959427644, 'support': 314867}, 'weighted avg': {'precision': 0.4168035588935189, 'recall': 0.41526739861592354, 'f1-score': 0.41586182842939085, 'support': 314867}}
[[45411 35362 25310]
 [31194 39980 32875]
 [24783 34589 45363]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0750966
{'0': {'precision': 0.43425721043796733, 'recall': 0.4290439305704755, 'f1-score': 0.4316348295966252, 'support': 106122}, '1': {'precision': 0.3562469117032194, 'recall': 0.3605362363440529, 'f1-score': 0.35837874008221005, 'support': 103984}, '2': {'precision': 0.42806562133170456, 'recall': 0.42815551588854633, 'f1-score': 0.42811056389111596, 'support': 104761}, 'accuracy': 0.4061238554691346, 'macro avg': {'precision': 0.40618991449096375, 'recall': 0.4059118942676916, 'f1-score': 0.40604137785665045, 'support': 314867}, 'weighted avg': {'precision': 0.40643447903075347, 'recall': 0.4061238554691346, 'f1-score': 0.40626962202758243, 'support': 314867}}
[[45531 34296 26295]
 [32860 37490 33634]
 [26457 33450 44854]]
Evaluating performance on  val set...
400/400 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0420018
{'0': {'precision': 0.35237032905744564, 'recall': 0.37692399475002986, 'f1-score': 0.3642338291248703, 'support': 25143}, '1': {'precision': 0.5519466220382278, 'recall': 0.4879686952458825, 'f1-score': 0.5179896257413875, 'support': 51366}, '2': {'precision': 0.3530629968601777, 'recall': 0.4107087348461299, 'f1-score': 0.3797104573050257, 'support': 25736}, 'accuracy': 0.4412147293266174, 'macro avg': {'precision': 0.41912664931861704, 'recall': 0.4252004749473475, 'f1-score': 0.4206446373904278, 'support': 102245}, 'weighted avg': {'precision': 0.452808124194831, 'recall': 0.4412147293266174, 'f1-score': 0.4453735107899737, 'support': 102245}}
[[ 9477 10133  5533]
 [12466 25065 13835]
 [ 4952 10214 10570]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0664309
{'0': {'precision': 0.4049107142857143, 'recall': 0.40641403149404687, 'f1-score': 0.40566098012906526, 'support': 31244}, '1': {'precision': 0.42264266878312295, 'recall': 0.4204467310190255, 'f1-score': 0.42154184009601386, 'support': 39263}, '2': {'precision': 0.4089737950103689, 'recall': 0.4101077572625874, 'f1-score': 0.40953999118998174, 'support': 31738}, 'accuracy': 0.412949288473764, 'macro avg': {'precision': 0.41217572602640207, 'recall': 0.41232283992521995, 'f1-score': 0.4122476038050203, 'support': 102245}, 'weighted avg': {'precision': 0.4129811704006426, 'recall': 0.412949288473764, 'f1-score': 0.4129634619906103, 'support': 102245}}
[[12698 11127  7419]
 [11364 16508 11391]
 [ 7298 11424 13016]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0763742
{'0': {'precision': 0.4244995009687078, 'recall': 0.4249485747869527, 'f1-score': 0.4247239191729324, 'support': 34030}, '1': {'precision': 0.3613007393139393, 'recall': 0.37666479638543543, 'f1-score': 0.3688228320272966, 'support': 33863}, '2': {'precision': 0.43274729285801194, 'recall': 0.41415346995808106, 'f1-score': 0.42324626643660385, 'support': 34352}, 'accuracy': 0.4053303340016627, 'macro avg': {'precision': 0.4061825110468864, 'recall': 0.4052556137101564, 'f1-score': 0.40559767254561097, 'support': 102245}, 'weighted avg': {'precision': 0.4063394782885371, 'recall': 0.4053303340016627, 'f1-score': 0.4057133187444417, 'support': 102245}}
[[14461 11128  8441]
 [10900 12755 10208]
 [ 8705 11420 14227]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0806723
{'0': {'precision': 0.4134549988664702, 'recall': 0.4263090229079009, 'f1-score': 0.4197836344803775, 'support': 34224}, '1': {'precision': 0.35344238933586675, 'recall': 0.3516259562276634, 'f1-score': 0.35253183298785906, 'support': 33857}, '2': {'precision': 0.42276251728075975, 'recall': 0.4117492096944152, 'f1-score': 0.4171831904860761, 'support': 34164}, 'accuracy': 0.39671377573475475, 'macro avg': {'precision': 0.39655330182769893, 'recall': 0.3965613962766598, 'f1-score': 0.3964995526514376, 'support': 102245}, 'weighted avg': {'precision': 0.3966926646518695, 'recall': 0.39671377573475475, 'f1-score': 0.3966452334656236, 'support': 102245}}
[[14590 10899  8735]
 [11480 11905 10472]
 [ 9218 10879 14067]]
training model: results/WBA/W7/deepLOB_L2/seq2seq
Epoch 1/50
1230/1230 - 64s - loss: 12.6495 - accuracy10: 0.4338 - accuracy20: 0.4425 - accuracy30: 0.4371 - accuracy50: 0.4174 - val_loss: 13.3337 - val_accuracy10: 0.4302 - val_accuracy20: 0.4160 - val_accuracy30: 0.4027 - val_accuracy50: 0.3856 - 64s/epoch - 52ms/step
Epoch 2/50
1230/1230 - 57s - loss: 12.2395 - accuracy10: 0.4688 - accuracy20: 0.4771 - accuracy30: 0.4705 - accuracy50: 0.4409 - val_loss: 12.9148 - val_accuracy10: 0.4759 - val_accuracy20: 0.4579 - val_accuracy30: 0.4434 - val_accuracy50: 0.4202 - 57s/epoch - 46ms/step
Epoch 3/50
1230/1230 - 57s - loss: 12.0629 - accuracy10: 0.4939 - accuracy20: 0.4927 - accuracy30: 0.4822 - accuracy50: 0.4498 - val_loss: 12.7789 - val_accuracy10: 0.4422 - val_accuracy20: 0.4433 - val_accuracy30: 0.4379 - val_accuracy50: 0.4184 - 57s/epoch - 46ms/step
Epoch 4/50
1230/1230 - 58s - loss: 11.9562 - accuracy10: 0.5069 - accuracy20: 0.5021 - accuracy30: 0.4895 - accuracy50: 0.4559 - val_loss: 12.6882 - val_accuracy10: 0.4320 - val_accuracy20: 0.4444 - val_accuracy30: 0.4420 - val_accuracy50: 0.4208 - 58s/epoch - 48ms/step
Epoch 5/50
1230/1230 - 57s - loss: 11.8576 - accuracy10: 0.5169 - accuracy20: 0.5099 - accuracy30: 0.4961 - accuracy50: 0.4617 - val_loss: 12.8064 - val_accuracy10: 0.4134 - val_accuracy20: 0.4326 - val_accuracy30: 0.4344 - val_accuracy50: 0.4162 - 57s/epoch - 46ms/step
Epoch 6/50
1230/1230 - 57s - loss: 11.7747 - accuracy10: 0.5225 - accuracy20: 0.5160 - accuracy30: 0.5017 - accuracy50: 0.4654 - val_loss: 12.5821 - val_accuracy10: 0.4136 - val_accuracy20: 0.4354 - val_accuracy30: 0.4367 - val_accuracy50: 0.4165 - 57s/epoch - 46ms/step
Epoch 7/50
1230/1230 - 56s - loss: 11.7020 - accuracy10: 0.5282 - accuracy20: 0.5208 - accuracy30: 0.5061 - accuracy50: 0.4689 - val_loss: 12.6638 - val_accuracy10: 0.4233 - val_accuracy20: 0.4404 - val_accuracy30: 0.4402 - val_accuracy50: 0.4195 - 56s/epoch - 46ms/step
Epoch 8/50
1230/1230 - 57s - loss: 11.6449 - accuracy10: 0.5329 - accuracy20: 0.5243 - accuracy30: 0.5103 - accuracy50: 0.4728 - val_loss: 12.7033 - val_accuracy10: 0.4236 - val_accuracy20: 0.4410 - val_accuracy30: 0.4405 - val_accuracy50: 0.4208 - 57s/epoch - 46ms/step
Epoch 9/50
1230/1230 - 56s - loss: 11.6035 - accuracy10: 0.5341 - accuracy20: 0.5273 - accuracy30: 0.5130 - accuracy50: 0.4741 - val_loss: 13.0105 - val_accuracy10: 0.3778 - val_accuracy20: 0.4109 - val_accuracy30: 0.4187 - val_accuracy50: 0.4026 - 56s/epoch - 46ms/step
Epoch 10/50
1230/1230 - 57s - loss: 11.5696 - accuracy10: 0.5355 - accuracy20: 0.5291 - accuracy30: 0.5148 - accuracy50: 0.4759 - val_loss: 13.0127 - val_accuracy10: 0.3947 - val_accuracy20: 0.4232 - val_accuracy30: 0.4285 - val_accuracy50: 0.4122 - 57s/epoch - 46ms/step
Epoch 11/50
1230/1230 - 59s - loss: 11.5328 - accuracy10: 0.5375 - accuracy20: 0.5306 - accuracy30: 0.5162 - accuracy50: 0.4784 - val_loss: 13.0106 - val_accuracy10: 0.4007 - val_accuracy20: 0.4267 - val_accuracy30: 0.4293 - val_accuracy50: 0.4119 - 59s/epoch - 48ms/step
Epoch 12/50
1230/1230 - 58s - loss: 11.5031 - accuracy10: 0.5401 - accuracy20: 0.5331 - accuracy30: 0.5189 - accuracy50: 0.4802 - val_loss: 13.0114 - val_accuracy10: 0.3987 - val_accuracy20: 0.4245 - val_accuracy30: 0.4290 - val_accuracy50: 0.4113 - 58s/epoch - 47ms/step
Epoch 13/50
1230/1230 - 56s - loss: 11.4766 - accuracy10: 0.5414 - accuracy20: 0.5348 - accuracy30: 0.5203 - accuracy50: 0.4814 - val_loss: 13.0600 - val_accuracy10: 0.3984 - val_accuracy20: 0.4247 - val_accuracy30: 0.4293 - val_accuracy50: 0.4114 - 56s/epoch - 46ms/step
Epoch 14/50
1230/1230 - 56s - loss: 11.4511 - accuracy10: 0.5425 - accuracy20: 0.5365 - accuracy30: 0.5227 - accuracy50: 0.4841 - val_loss: 13.1800 - val_accuracy10: 0.4039 - val_accuracy20: 0.4275 - val_accuracy30: 0.4295 - val_accuracy50: 0.4103 - 56s/epoch - 46ms/step
Epoch 15/50
1230/1230 - 57s - loss: 11.4271 - accuracy10: 0.5434 - accuracy20: 0.5378 - accuracy30: 0.5241 - accuracy50: 0.4856 - val_loss: 13.2028 - val_accuracy10: 0.3773 - val_accuracy20: 0.4108 - val_accuracy30: 0.4186 - val_accuracy50: 0.4034 - 57s/epoch - 46ms/step
Epoch 16/50
1230/1230 - 57s - loss: 11.3998 - accuracy10: 0.5454 - accuracy20: 0.5399 - accuracy30: 0.5267 - accuracy50: 0.4871 - val_loss: 13.3988 - val_accuracy10: 0.3926 - val_accuracy20: 0.4194 - val_accuracy30: 0.4229 - val_accuracy50: 0.4059 - 57s/epoch - 46ms/step
testing model: results/WBA/W7/deepLOB_L2/seq2seq
Evaluating performance on  test set...
4192/4192 - 69s - 69s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0408628
{'0': {'precision': 0.2741848234410218, 'recall': 0.8937001037441393, 'f1-score': 0.4196286799332247, 'support': 224591}, '1': {'precision': 0.7708182783414008, 'recall': 0.3032291569062476, 'f1-score': 0.43524069607874427, 'support': 629669}, '2': {'precision': 0.4921571356681692, 'recall': 0.20999588834574442, 'f1-score': 0.2943830514878941, 'support': 218890}, 'accuracy': 0.407787354982994, 'macro avg': {'precision': 0.5123867458168639, 'recall': 0.4689750496653771, 'f1-score': 0.3830841424999544, 'support': 1073150}, 'weighted avg': {'precision': 0.6100434176143127, 'recall': 0.407787354982994, 'f1-score': 0.4032427012573031, 'support': 1073150}}
[[200717  14800   9074]
 [400378 190934  38357]
 [130955  41969  45966]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0442498
{'0': {'precision': 0.33618223377757545, 'recall': 0.878820254045589, 'f1-score': 0.4863261747280016, 'support': 287350}, '1': {'precision': 0.668135757912271, 'recall': 0.304801257010326, 'f1-score': 0.4186265210218332, 'support': 505326}, '2': {'precision': 0.5546552949538024, 'recall': 0.18085811875610575, 'f1-score': 0.2727724915239199, 'support': 280474}, 'accuracy': 0.4261091180170526, 'macro avg': {'precision': 0.5196577622145496, 'recall': 0.45482654327067357, 'f1-score': 0.39257506242458495, 'support': 1073150}, 'weighted avg': {'precision': 0.5495920645535437, 'recall': 0.4261091180170526, 'f1-score': 0.398634192291525, 'support': 1073150}}
[[252529  23132  11689]
 [322262 154024  29040]
 [176376  53372  50726]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0491034
{'0': {'precision': 0.3621924735864277, 'recall': 0.8669055405172819, 'f1-score': 0.5109220883652648, 'support': 319555}, '1': {'precision': 0.6007007574027208, 'recall': 0.29916754447232696, 'f1-score': 0.39941438137198176, 'support': 439543}, '2': {'precision': 0.5701580696043226, 'recall': 0.16228841083642198, 'f1-score': 0.25266022709527736, 'support': 314052}, 'accuracy': 0.42816754414573915, 'macro avg': {'precision': 0.5110171001978236, 'recall': 0.4427871652753436, 'f1-score': 0.38766556561084126, 'support': 1073150}, 'weighted avg': {'precision': 0.5207412859184193, 'recall': 0.42816754414573915, 'f1-score': 0.38967148396652207, 'support': 1073150}}
[[277024  29039  13492]
 [283114 131497  24932]
 [204715  58370  50967]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.069854
{'0': {'precision': 0.35696573125881825, 'recall': 0.8527248674801335, 'f1-score': 0.5032585294122999, 'support': 324291}, '1': {'precision': 0.5554003790739764, 'recall': 0.27632651807174813, 'f1-score': 0.3690438614211403, 'support': 423119}, '2': {'precision': 0.5276584134779346, 'recall': 0.14249401363050285, 'f1-score': 0.2243912343548317, 'support': 325740}, 'accuracy': 0.40988305455900853, 'macro avg': {'precision': 0.4800081746035764, 'recall': 0.42384846639412815, 'f1-score': 0.365564541729424, 'support': 1073150}, 'weighted avg': {'precision': 0.48701549508955666, 'recall': 0.40988305455900853, 'f1-score': 0.3656943409971006, 'support': 1073150}}
[[276531  33054  14706]
 [279356 116919  26844]
 [218784  60540  46416]]
Evaluating performance on  train set...
1230/1230 - 20s - 20s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0300143
{'0': {'precision': 0.32809805241240064, 'recall': 0.8055537625385678, 'f1-score': 0.46628182854153827, 'support': 77461}, '1': {'precision': 0.7237920525490428, 'recall': 0.3041497000404091, 'f1-score': 0.42831441590902125, 'support': 160855}, '2': {'precision': 0.4608943929653699, 'recall': 0.34371856670716255, 'f1-score': 0.3937743190661479, 'support': 76551}, 'accuracy': 0.43712107016613366, 'macro avg': {'precision': 0.5042614993089377, 'recall': 0.4844740097620465, 'f1-score': 0.4294568545055692, 'support': 314867}, 'weighted avg': {'precision': 0.5625305304353434, 'recall': 0.43712107016613366, 'f1-score': 0.4292574007137439, 'support': 314867}}
[[62399  6488  8574]
 [89728 48924 22203]
 [38057 12182 26312]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0285848
{'0': {'precision': 0.39034487687344305, 'recall': 0.788514684045537, 'f1-score': 0.5221871670900599, 'support': 96976}, '1': {'precision': 0.6032873570541204, 'recall': 0.310284661069015, 'f1-score': 0.40979979552204093, 'support': 122075}, '2': {'precision': 0.5185191777164724, 'recall': 0.30405151540452535, 'f1-score': 0.3833264254840429, 'support': 95816}, 'accuracy': 0.4556781117106588, 'macro avg': {'precision': 0.5040504705480119, 'recall': 0.4676169535063592, 'f1-score': 0.43843779603204786, 'support': 314867}, 'weighted avg': {'precision': 0.5119076385398986, 'recall': 0.4556781117106588, 'f1-score': 0.4363580100113948, 'support': 314867}}
[[76467  9277 11232]
 [68377 37878 15820]
 [51052 15631 29133]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0351965
{'0': {'precision': 0.41233069498647557, 'recall': 0.7784393902278166, 'f1-score': 0.5391039945712459, 'support': 106138}, '1': {'precision': 0.5334573433668724, 'recall': 0.304078347454768, 'f1-score': 0.3873574086125812, 'support': 103743}, '2': {'precision': 0.5322108610037215, 'recall': 0.28060884308383977, 'f1-score': 0.3674691281027816, 'support': 104986}, 'accuracy': 0.4561545033299774, 'macro avg': {'precision': 0.4926662997856899, 'recall': 0.45437552692214145, 'f1-score': 0.43131017709553626, 'support': 314867}, 'weighted avg': {'precision': 0.49221134615796736, 'recall': 0.4561545033299774, 'f1-score': 0.43187807328331174, 'support': 314867}}
[[82622 10889 12627]
 [58930 31546 13267]
 [58826 16700 29460]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0621479
{'0': {'precision': 0.3969573338576484, 'recall': 0.7609181106368544, 'f1-score': 0.521734917030342, 'support': 106131}, '1': {'precision': 0.48789667114283697, 'recall': 0.2658112088716043, 'f1-score': 0.34413439848452754, 'support': 103882}, '2': {'precision': 0.48817274899235835, 'recall': 0.255278768573445, 'f1-score': 0.33524751855214957, 'support': 104854}, 'accuracy': 0.429187561732414, 'macro avg': {'precision': 0.45767558466428127, 'recall': 0.4273360293606346, 'f1-score': 0.4003722780223397, 'support': 314867}, 'weighted avg': {'precision': 0.4573360378005666, 'recall': 0.429187561732414, 'f1-score': 0.40103809345845715, 'support': 314867}}
[[80757 12167 13207]
 [61412 27613 14857]
 [61271 16816 26767]]
Evaluating performance on  val set...
400/400 - 7s - 7s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0510086
{'0': {'precision': 0.311088840417379, 'recall': 0.8386174016686532, 'f1-score': 0.4538281266797102, 'support': 25170}, '1': {'precision': 0.7189745180131286, 'recall': 0.2710180224062348, 'f1-score': 0.3936495358840842, 'support': 51325}, '2': {'precision': 0.4922238468695999, 'recall': 0.2876116504854369, 'f1-score': 0.36307481125600555, 'support': 25750}, 'accuracy': 0.4149249352046555, 'macro avg': {'precision': 0.5074290684333692, 'recall': 0.46574902485344166, 'f1-score': 0.40351749127326664, 'support': 102245}, 'weighted avg': {'precision': 0.5614576488554106, 'recall': 0.4149249352046555, 'f1-score': 0.40076378079731106, 'support': 102245}}
[[21108  1682  2380]
 [32155 13910  5260]
 [14589  3755  7406]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0451043
{'0': {'precision': 0.37080952585527915, 'recall': 0.8285814853924675, 'f1-score': 0.5123365188658713, 'support': 31251}, '1': {'precision': 0.6062369357663409, 'recall': 0.2733873433200856, 'f1-score': 0.3768370410689516, 'support': 39252}, '2': {'precision': 0.5441446339971454, 'recall': 0.25222103207107305, 'f1-score': 0.3446776450328275, 'support': 31742}, 'accuracy': 0.4365103428040491, 'macro avg': {'precision': 0.5070636985395884, 'recall': 0.4513966202612087, 'f1-score': 0.41128373498921683, 'support': 102245}, 'weighted avg': {'precision': 0.515002392953603, 'recall': 0.4365103428040491, 'f1-score': 0.4082683152794546, 'support': 102245}}
[[25894  2365  2992]
 [24806 10731  3715]
 [19131  4605  8006]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0479488
{'0': {'precision': 0.39248472276728147, 'recall': 0.8232786499676604, 'f1-score': 0.5315578671627342, 'support': 34014}, '1': {'precision': 0.5412246865959498, 'recall': 0.2647015475313191, 'f1-score': 0.3555238830492706, 'support': 33925}, '2': {'precision': 0.5478504019573576, 'recall': 0.2284440039643211, 'f1-score': 0.32243730842813356, 'support': 34306}, 'accuracy': 0.43835884395324953, 'macro avg': {'precision': 0.4938532704401963, 'recall': 0.4388080671544336, 'f1-score': 0.40317301954671275, 'support': 102245}, 'weighted avg': {'precision': 0.49396624522004035, 'recall': 0.43835884395324953, 'f1-score': 0.4029839241924329, 'support': 102245}}
[[28003  2760  3251]
 [21728  8980  3217]
 [21617  4852  7837]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0681683
{'0': {'precision': 0.38305749730610894, 'recall': 0.8098130841121496, 'f1-score': 0.5200982874720989, 'support': 34240}, '1': {'precision': 0.5001274372371607, 'recall': 0.23170479704797048, 'f1-score': 0.31668986665052756, 'support': 33875}, '2': {'precision': 0.5060360042357924, 'recall': 0.21002050981541165, 'f1-score': 0.2968423232218656, 'support': 34130}, 'accuracy': 0.41806445302948797, 'macro avg': {'precision': 0.46307364625968733, 'recall': 0.4171794636585105, 'f1-score': 0.37787682578149734, 'support': 102245}, 'weighted avg': {'precision': 0.4628951486012772, 'recall': 0.41806445302948797, 'f1-score': 0.37818243520361444, 'support': 102245}}
[[27728  3057  3455]
 [22484  7849  3542]
 [22174  4788  7168]]
training model: results/WBA/W7/deepOF_L2/seq2seq
Epoch 1/50
1230/1230 - 42s - loss: 12.5279 - accuracy10: 0.4516 - accuracy20: 0.4504 - accuracy30: 0.4398 - accuracy50: 0.4185 - val_loss: 12.5513 - val_accuracy10: 0.5554 - val_accuracy20: 0.4840 - val_accuracy30: 0.4386 - val_accuracy50: 0.4050 - 42s/epoch - 34ms/step
Epoch 2/50
1230/1230 - 35s - loss: 11.9042 - accuracy10: 0.5154 - accuracy20: 0.5103 - accuracy30: 0.4953 - accuracy50: 0.4584 - val_loss: 12.2983 - val_accuracy10: 0.5577 - val_accuracy20: 0.5016 - val_accuracy30: 0.4668 - val_accuracy50: 0.4324 - 35s/epoch - 29ms/step
Epoch 3/50
1230/1230 - 35s - loss: 11.7564 - accuracy10: 0.5253 - accuracy20: 0.5194 - accuracy30: 0.5035 - accuracy50: 0.4662 - val_loss: 12.1872 - val_accuracy10: 0.5649 - val_accuracy20: 0.5094 - val_accuracy30: 0.4753 - val_accuracy50: 0.4389 - 35s/epoch - 29ms/step
Epoch 4/50
1230/1230 - 35s - loss: 11.6804 - accuracy10: 0.5326 - accuracy20: 0.5246 - accuracy30: 0.5085 - accuracy50: 0.4706 - val_loss: 12.0958 - val_accuracy10: 0.5611 - val_accuracy20: 0.5139 - val_accuracy30: 0.4831 - val_accuracy50: 0.4465 - 35s/epoch - 29ms/step
Epoch 5/50
1230/1230 - 35s - loss: 11.6183 - accuracy10: 0.5365 - accuracy20: 0.5284 - accuracy30: 0.5125 - accuracy50: 0.4743 - val_loss: 12.0322 - val_accuracy10: 0.5653 - val_accuracy20: 0.5158 - val_accuracy30: 0.4856 - val_accuracy50: 0.4488 - 35s/epoch - 29ms/step
Epoch 6/50
1230/1230 - 37s - loss: 11.5715 - accuracy10: 0.5399 - accuracy20: 0.5314 - accuracy30: 0.5154 - accuracy50: 0.4772 - val_loss: 11.9835 - val_accuracy10: 0.5659 - val_accuracy20: 0.5195 - val_accuracy30: 0.4904 - val_accuracy50: 0.4532 - 37s/epoch - 30ms/step
Epoch 7/50
1230/1230 - 35s - loss: 11.5358 - accuracy10: 0.5430 - accuracy20: 0.5335 - accuracy30: 0.5178 - accuracy50: 0.4796 - val_loss: 11.9660 - val_accuracy10: 0.5657 - val_accuracy20: 0.5194 - val_accuracy30: 0.4914 - val_accuracy50: 0.4533 - 35s/epoch - 29ms/step
Epoch 8/50
1230/1230 - 35s - loss: 11.5043 - accuracy10: 0.5446 - accuracy20: 0.5352 - accuracy30: 0.5193 - accuracy50: 0.4809 - val_loss: 11.9610 - val_accuracy10: 0.5670 - val_accuracy20: 0.5204 - val_accuracy30: 0.4916 - val_accuracy50: 0.4547 - 35s/epoch - 28ms/step
Epoch 9/50
1230/1230 - 36s - loss: 11.4759 - accuracy10: 0.5465 - accuracy20: 0.5368 - accuracy30: 0.5208 - accuracy50: 0.4836 - val_loss: 11.9427 - val_accuracy10: 0.5658 - val_accuracy20: 0.5219 - val_accuracy30: 0.4934 - val_accuracy50: 0.4553 - 36s/epoch - 29ms/step
Epoch 10/50
1230/1230 - 35s - loss: 11.4446 - accuracy10: 0.5482 - accuracy20: 0.5395 - accuracy30: 0.5242 - accuracy50: 0.4852 - val_loss: 11.9188 - val_accuracy10: 0.5656 - val_accuracy20: 0.5217 - val_accuracy30: 0.4939 - val_accuracy50: 0.4564 - 35s/epoch - 29ms/step
Epoch 11/50
1230/1230 - 35s - loss: 11.4224 - accuracy10: 0.5497 - accuracy20: 0.5406 - accuracy30: 0.5254 - accuracy50: 0.4869 - val_loss: 11.9257 - val_accuracy10: 0.5649 - val_accuracy20: 0.5216 - val_accuracy30: 0.4939 - val_accuracy50: 0.4575 - 35s/epoch - 28ms/step
Epoch 12/50
1230/1230 - 36s - loss: 11.3970 - accuracy10: 0.5502 - accuracy20: 0.5410 - accuracy30: 0.5262 - accuracy50: 0.4878 - val_loss: 11.8956 - val_accuracy10: 0.5630 - val_accuracy20: 0.5219 - val_accuracy30: 0.4953 - val_accuracy50: 0.4584 - 36s/epoch - 29ms/step
Epoch 13/50
1230/1230 - 36s - loss: 11.3723 - accuracy10: 0.5525 - accuracy20: 0.5437 - accuracy30: 0.5291 - accuracy50: 0.4901 - val_loss: 11.9073 - val_accuracy10: 0.5640 - val_accuracy20: 0.5220 - val_accuracy30: 0.4955 - val_accuracy50: 0.4585 - 36s/epoch - 29ms/step
Epoch 14/50
1230/1230 - 36s - loss: 11.3490 - accuracy10: 0.5529 - accuracy20: 0.5446 - accuracy30: 0.5307 - accuracy50: 0.4916 - val_loss: 11.9043 - val_accuracy10: 0.5610 - val_accuracy20: 0.5229 - val_accuracy30: 0.4966 - val_accuracy50: 0.4603 - 36s/epoch - 29ms/step
Epoch 15/50
1230/1230 - 35s - loss: 11.3285 - accuracy10: 0.5540 - accuracy20: 0.5464 - accuracy30: 0.5319 - accuracy50: 0.4933 - val_loss: 11.9287 - val_accuracy10: 0.5619 - val_accuracy20: 0.5228 - val_accuracy30: 0.4960 - val_accuracy50: 0.4585 - 35s/epoch - 29ms/step
Epoch 16/50
1230/1230 - 35s - loss: 11.3102 - accuracy10: 0.5543 - accuracy20: 0.5473 - accuracy30: 0.5331 - accuracy50: 0.4937 - val_loss: 11.8979 - val_accuracy10: 0.5633 - val_accuracy20: 0.5229 - val_accuracy30: 0.4967 - val_accuracy50: 0.4602 - 35s/epoch - 29ms/step
Epoch 17/50
1230/1230 - 34s - loss: 11.2906 - accuracy10: 0.5556 - accuracy20: 0.5477 - accuracy30: 0.5342 - accuracy50: 0.4953 - val_loss: 11.8659 - val_accuracy10: 0.5588 - val_accuracy20: 0.5232 - val_accuracy30: 0.4990 - val_accuracy50: 0.4622 - 34s/epoch - 28ms/step
Epoch 18/50
1230/1230 - 36s - loss: 11.2633 - accuracy10: 0.5575 - accuracy20: 0.5498 - accuracy30: 0.5361 - accuracy50: 0.4964 - val_loss: 11.9615 - val_accuracy10: 0.5575 - val_accuracy20: 0.5203 - val_accuracy30: 0.4952 - val_accuracy50: 0.4580 - 36s/epoch - 29ms/step
Epoch 19/50
1230/1230 - 36s - loss: 11.2500 - accuracy10: 0.5576 - accuracy20: 0.5509 - accuracy30: 0.5379 - accuracy50: 0.4991 - val_loss: 11.9386 - val_accuracy10: 0.5527 - val_accuracy20: 0.5195 - val_accuracy30: 0.4958 - val_accuracy50: 0.4595 - 36s/epoch - 29ms/step
Epoch 20/50
1230/1230 - 36s - loss: 11.2245 - accuracy10: 0.5579 - accuracy20: 0.5520 - accuracy30: 0.5388 - accuracy50: 0.5001 - val_loss: 11.9299 - val_accuracy10: 0.5584 - val_accuracy20: 0.5215 - val_accuracy30: 0.4961 - val_accuracy50: 0.4591 - 36s/epoch - 29ms/step
Epoch 21/50
1230/1230 - 36s - loss: 11.2046 - accuracy10: 0.5597 - accuracy20: 0.5536 - accuracy30: 0.5403 - accuracy50: 0.5022 - val_loss: 11.9630 - val_accuracy10: 0.5539 - val_accuracy20: 0.5186 - val_accuracy30: 0.4940 - val_accuracy50: 0.4568 - 36s/epoch - 29ms/step
Epoch 22/50
1230/1230 - 35s - loss: 11.1838 - accuracy10: 0.5601 - accuracy20: 0.5541 - accuracy30: 0.5418 - accuracy50: 0.5031 - val_loss: 11.9433 - val_accuracy10: 0.5599 - val_accuracy20: 0.5206 - val_accuracy30: 0.4944 - val_accuracy50: 0.4572 - 35s/epoch - 28ms/step
Epoch 23/50
1230/1230 - 34s - loss: 11.1599 - accuracy10: 0.5613 - accuracy20: 0.5562 - accuracy30: 0.5435 - accuracy50: 0.5049 - val_loss: 11.9240 - val_accuracy10: 0.5598 - val_accuracy20: 0.5223 - val_accuracy30: 0.4960 - val_accuracy50: 0.4592 - 34s/epoch - 28ms/step
Epoch 24/50
1230/1230 - 34s - loss: 11.1390 - accuracy10: 0.5613 - accuracy20: 0.5574 - accuracy30: 0.5456 - accuracy50: 0.5065 - val_loss: 12.0363 - val_accuracy10: 0.5551 - val_accuracy20: 0.5170 - val_accuracy30: 0.4922 - val_accuracy50: 0.4562 - 34s/epoch - 28ms/step
Epoch 25/50
1230/1230 - 34s - loss: 11.1173 - accuracy10: 0.5622 - accuracy20: 0.5591 - accuracy30: 0.5465 - accuracy50: 0.5083 - val_loss: 12.0005 - val_accuracy10: 0.5505 - val_accuracy20: 0.5160 - val_accuracy30: 0.4933 - val_accuracy50: 0.4564 - 34s/epoch - 28ms/step
Epoch 26/50
1230/1230 - 34s - loss: 11.0958 - accuracy10: 0.5633 - accuracy20: 0.5600 - accuracy30: 0.5482 - accuracy50: 0.5101 - val_loss: 12.0444 - val_accuracy10: 0.5492 - val_accuracy20: 0.5141 - val_accuracy30: 0.4897 - val_accuracy50: 0.4554 - 34s/epoch - 28ms/step
Epoch 27/50
1230/1230 - 35s - loss: 11.0772 - accuracy10: 0.5645 - accuracy20: 0.5615 - accuracy30: 0.5501 - accuracy50: 0.5118 - val_loss: 12.0281 - val_accuracy10: 0.5443 - val_accuracy20: 0.5136 - val_accuracy30: 0.4913 - val_accuracy50: 0.4538 - 35s/epoch - 29ms/step
testing model: results/WBA/W7/deepOF_L2/seq2seq
Evaluating performance on  test set...
4192/4192 - 43s - 43s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.84357536
{'0': {'precision': 0.45344601158565107, 'recall': 0.44891334838304636, 'f1-score': 0.4511682959190751, 'support': 224589}, '1': {'precision': 0.7291689991504271, 'recall': 0.7033404905442233, 'f1-score': 0.7160218975741938, 'support': 629668}, '2': {'precision': 0.438561106158883, 'recall': 0.4877471583640949, 'f1-score': 0.4618482669118045, 'support': 218888}, 'accuracy': 0.6061193967264442, 'macro avg': {'precision': 0.5403920389649871, 'recall': 0.5466669990971215, 'f1-score': 0.5430128201350245, 'support': 1073145}, 'weighted avg': {'precision': 0.6121904635980846, 'recall': 0.6061193967264442, 'f1-score': 0.6087495688482989, 'support': 1073145}}
[[100821  87783  35985]
 [ 86107 442871 100690]
 [ 35416  76710 106762]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9109679
{'0': {'precision': 0.503723306049603, 'recall': 0.42727086066672004, 'f1-score': 0.46235797861723804, 'support': 287347}, '1': {'precision': 0.6207631510409746, 'recall': 0.693361697917182, 'f1-score': 0.6550570788634332, 'support': 505325}, '2': {'precision': 0.49103918305426303, 'recall': 0.4639270090169107, 'f1-score': 0.4770982290177098, 'support': 280473}, 'accuracy': 0.5621486378821129, 'macro avg': {'precision': 0.5385085467149469, 'recall': 0.5281865225336043, 'f1-score': 0.5315044288327937, 'support': 1073145}, 'weighted avg': {'precision': 0.5555202259825037, 'recall': 0.5621486378821129, 'f1-score': 0.5569490311613771, 'support': 1073145}}
[[122775 113451  51121]
 [ 71205 350373  83747]
 [ 49755 100599 130119]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.955264
{'0': {'precision': 0.5110310688213879, 'recall': 0.41513118365712, 'f1-score': 0.4581161279628136, 'support': 319552}, '1': {'precision': 0.5552870171315646, 'recall': 0.662284832848738, 'f1-score': 0.604084546353469, 'support': 439542}, '2': {'precision': 0.5004994418003408, 'recall': 0.4610907145654687, 'f1-score': 0.47998753675166644, 'support': 314051}, 'accuracy': 0.5298109761495418, 'macro avg': {'precision': 0.5222725092510978, 'recall': 0.5128355770237755, 'f1-score': 0.5140627370226497, 'support': 1073145}, 'weighted avg': {'precision': 0.526075522305833, 'recall': 0.5298109761495418, 'f1-score': 0.5243028859105405, 'support': 1073145}}
[[132656 123142  63754]
 [ 67677 291102  80763]
 [ 59252 109993 144806]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0051742
{'0': {'precision': 0.47159550871792266, 'recall': 0.40059638162256506, 'f1-score': 0.43320617050934046, 'support': 324289}, '1': {'precision': 0.5099097115172869, 'recall': 0.5800830503146883, 'f1-score': 0.5427375138618162, 'support': 423117}, '2': {'precision': 0.46877963658434807, 'recall': 0.45524177332158566, 'f1-score': 0.4619115331482032, 'support': 325739}, 'accuracy': 0.4879508360939109, 'macro avg': {'precision': 0.48342828560651924, 'recall': 0.47864040175294637, 'f1-score': 0.47928507250645325, 'support': 1073145}, 'weighted avg': {'precision': 0.4858472185734782, 'recall': 0.4879508360939109, 'f1-score': 0.4851050560521981, 'support': 1073145}}
[[129909 122310  72070]
 [ 81702 245443  95972]
 [ 63856 113593 148290]]
Evaluating performance on  train set...
1230/1230 - 13s - 13s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.888329
{'0': {'precision': 0.4902854274808152, 'recall': 0.4772312360186161, 'f1-score': 0.4836702650935221, 'support': 77782}, '1': {'precision': 0.6703454618612404, 'recall': 0.6529106585217164, 'f1-score': 0.6615132024693771, 'support': 160754}, '2': {'precision': 0.46756596393930955, 'recall': 0.5058626246217133, 'f1-score': 0.48596096001610933, 'support': 76331}, 'accuracy': 0.5738645205753541, 'macro avg': {'precision': 0.5427322844271217, 'recall': 0.545334839720682, 'f1-score': 0.5437148091930029, 'support': 314867}, 'weighted avg': {'precision': 0.5767065875109365, 'recall': 0.5738645205753541, 'f1-score': 0.5750225331592583, 'support': 314867}}
[[ 37120  27043  13619]
 [ 25445 104958  30351]
 [ 13146  24572  38613]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.94392276
{'0': {'precision': 0.5355819706751946, 'recall': 0.4573663382662105, 'f1-score': 0.4933935886960051, 'support': 97036}, '1': {'precision': 0.5486382686458378, 'recall': 0.6412486996125459, 'f1-score': 0.5913394897361811, 'support': 122079}, '2': {'precision': 0.520701777956917, 'recall': 0.48570264850864736, 'f1-score': 0.502593641256187, 'support': 95752}, 'accuracy': 0.537277644211683, 'macro avg': {'precision': 0.5349740057593165, 'recall': 0.5281058954624679, 'f1-score': 0.5291089065627911, 'support': 314867}, 'weighted avg': {'precision': 0.5361189961075125, 'recall': 0.537277644211683, 'f1-score': 0.5341665534265936, 'support': 314867}}
[[44381 33580 19075]
 [20062 78283 23734]
 [18422 30823 46507]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.97995603
{'0': {'precision': 0.5401865085282344, 'recall': 0.44393540906648565, 'f1-score': 0.48735408560311283, 'support': 106083}, '1': {'precision': 0.4819147884163364, 'recall': 0.6088765869926669, 'f1-score': 0.5380068786888029, 'support': 104049}, '2': {'precision': 0.5263704858404781, 'recall': 0.4836014703776197, 'f1-score': 0.5040804140127388, 'support': 104735}, 'accuracy': 0.5116350713158254, 'macro avg': {'precision': 0.5161572609283497, 'recall': 0.5121378221455908, 'f1-score': 0.5098137927682181, 'support': 314867}, 'weighted avg': {'precision': 0.5163347382819874, 'recall': 0.5116350713158254, 'f1-score': 0.5096562146727046, 'support': 314867}}
[[47094 35661 23328]
 [18449 63353 22247]
 [21638 32447 50650]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0246464
{'0': {'precision': 0.49805226604932773, 'recall': 0.4216750532406099, 'f1-score': 0.4566923508700312, 'support': 106122}, '1': {'precision': 0.444825595778016, 'recall': 0.5187721187875057, 'f1-score': 0.47896152787519863, 'support': 103984}, '2': {'precision': 0.48536371434905395, 'recall': 0.48067506037552143, 'f1-score': 0.48300800920819154, 'support': 104761}, 'accuracy': 0.4733712964521528, 'macro avg': {'precision': 0.4760805253921325, 'recall': 0.4737074108012123, 'f1-score': 0.4728872959844737, 'support': 314867}, 'weighted avg': {'precision': 0.47625262541958746, 'recall': 0.4733712964521528, 'f1-score': 0.47280230454847116, 'support': 314867}}
[[44749 35385 25988]
 [22635 53944 27405]
 [22464 31941 50356]]
Evaluating performance on  val set...
400/400 - 4s - 4s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9097095
{'0': {'precision': 0.46503990529652117, 'recall': 0.48434952074135945, 'f1-score': 0.47449834404831487, 'support': 25143}, '1': {'precision': 0.6713018060340328, 'recall': 0.625939337304832, 'f1-score': 0.647827444817199, 'support': 51366}, '2': {'precision': 0.45389340624223273, 'recall': 0.49669723344731115, 'f1-score': 0.4743316202526949, 'support': 25736}, 'accuracy': 0.5585896620861656, 'macro avg': {'precision': 0.5300783725242622, 'recall': 0.5356620304978342, 'f1-score': 0.5322191363727362, 'support': 102245}, 'weighted avg': {'precision': 0.5658563999282572, 'recall': 0.5585896620861656, 'f1-score': 0.5615337177730977, 'support': 102245}}
[[12178  7856  5109]
 [ 8943 32152 10271]
 [ 5066  7887 12783]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.96153456
{'0': {'precision': 0.5054362977418455, 'recall': 0.4642171296889003, 'f1-score': 0.4839506172839506, 'support': 31244}, '1': {'precision': 0.554069145223582, 'recall': 0.6065506965845707, 'f1-score': 0.5791233509635845, 'support': 39263}, '2': {'precision': 0.49628684529067296, 'recall': 0.4779759279097612, 'f1-score': 0.48695931305673706, 'support': 31738}, 'accuracy': 0.523145386082449, 'macro avg': {'precision': 0.5185974294187002, 'recall': 0.5162479180610774, 'f1-score': 0.5166777604347574, 'support': 102245}, 'weighted avg': {'precision': 0.5212716556447269, 'recall': 0.523145386082449, 'f1-score': 0.5214317364477256, 'support': 102245}}
[[14504  9601  7139]
 [ 7190 23815  8258]
 [ 7002  9566 15170]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.99362177
{'0': {'precision': 0.5093138879681803, 'recall': 0.45154275639141933, 'f1-score': 0.47869158878504675, 'support': 34030}, '1': {'precision': 0.49071163919764915, 'recall': 0.5671086436523639, 'f1-score': 0.5261514014082577, 'support': 33863}, '2': {'precision': 0.49650880388585306, 'recall': 0.4761003726129483, 'f1-score': 0.4860904713784699, 'support': 34352}, 'accuracy': 0.4980683652012323, 'macro avg': {'precision': 0.4988447770172275, 'recall': 0.49825059088557716, 'f1-score': 0.4969778205239248, 'support': 102245}, 'weighted avg': {'precision': 0.49885070445297075, 'recall': 0.4980683652012323, 'f1-score': 0.4968958828797121, 'support': 102245}}
[[15366 10035  8629]
 [ 6703 19204  7956]
 [ 8101  9896 16355]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0354204
{'0': {'precision': 0.47230582058013704, 'recall': 0.4310425432445068, 'f1-score': 0.45073176693452294, 'support': 34224}, '1': {'precision': 0.4535190698196933, 'recall': 0.47694716011459964, 'f1-score': 0.4649381685213711, 'support': 33857}, '2': {'precision': 0.45970908063832794, 'recall': 0.4764079147640791, 'f1-score': 0.46790955741781537, 'support': 34164}, 'accuracy': 0.46140153552740965, 'macro avg': {'precision': 0.46184465701271943, 'recall': 0.46146587270772854, 'f1-score': 0.4611931642912365, 'support': 102245}, 'weighted avg': {'precision': 0.46187579423294833, 'recall': 0.46140153552740965, 'f1-score': 0.46117578055472075, 'support': 102245}}
[[14752  9968  9504]
 [ 8084 16148  9625]
 [ 8398  9490 16276]]
training model: results/WBA/W7/deepVOL_L2/seq2seq
Epoch 1/50
1230/1230 - 41s - loss: 12.6804 - accuracy10: 0.4333 - accuracy20: 0.4413 - accuracy30: 0.4349 - accuracy50: 0.4147 - val_loss: 13.3778 - val_accuracy10: 0.4942 - val_accuracy20: 0.4482 - val_accuracy30: 0.4245 - val_accuracy50: 0.4028 - 41s/epoch - 33ms/step
Epoch 2/50
1230/1230 - 33s - loss: 12.2648 - accuracy10: 0.4733 - accuracy20: 0.4827 - accuracy30: 0.4755 - accuracy50: 0.4438 - val_loss: 12.9514 - val_accuracy10: 0.5079 - val_accuracy20: 0.4832 - val_accuracy30: 0.4629 - val_accuracy50: 0.4303 - 33s/epoch - 27ms/step
Epoch 3/50
1230/1230 - 33s - loss: 12.0878 - accuracy10: 0.4959 - accuracy20: 0.4977 - accuracy30: 0.4864 - accuracy50: 0.4515 - val_loss: 12.7417 - val_accuracy10: 0.5200 - val_accuracy20: 0.4929 - val_accuracy30: 0.4693 - val_accuracy50: 0.4359 - 33s/epoch - 27ms/step
Epoch 4/50
1230/1230 - 33s - loss: 11.9736 - accuracy10: 0.5070 - accuracy20: 0.5065 - accuracy30: 0.4935 - accuracy50: 0.4569 - val_loss: 12.7810 - val_accuracy10: 0.5207 - val_accuracy20: 0.4953 - val_accuracy30: 0.4712 - val_accuracy50: 0.4372 - 33s/epoch - 26ms/step
Epoch 5/50
1230/1230 - 32s - loss: 11.8865 - accuracy10: 0.5149 - accuracy20: 0.5124 - accuracy30: 0.4976 - accuracy50: 0.4609 - val_loss: 12.7500 - val_accuracy10: 0.5247 - val_accuracy20: 0.4981 - val_accuracy30: 0.4723 - val_accuracy50: 0.4376 - 32s/epoch - 26ms/step
Epoch 6/50
1230/1230 - 32s - loss: 11.8113 - accuracy10: 0.5214 - accuracy20: 0.5166 - accuracy30: 0.5027 - accuracy50: 0.4650 - val_loss: 12.5310 - val_accuracy10: 0.5218 - val_accuracy20: 0.5006 - val_accuracy30: 0.4774 - val_accuracy50: 0.4431 - 32s/epoch - 26ms/step
Epoch 7/50
1230/1230 - 32s - loss: 11.7580 - accuracy10: 0.5245 - accuracy20: 0.5191 - accuracy30: 0.5043 - accuracy50: 0.4666 - val_loss: 12.4784 - val_accuracy10: 0.5213 - val_accuracy20: 0.5013 - val_accuracy30: 0.4772 - val_accuracy50: 0.4432 - 32s/epoch - 26ms/step
Epoch 8/50
1230/1230 - 32s - loss: 11.7121 - accuracy10: 0.5281 - accuracy20: 0.5223 - accuracy30: 0.5073 - accuracy50: 0.4693 - val_loss: 12.5357 - val_accuracy10: 0.5216 - val_accuracy20: 0.4990 - val_accuracy30: 0.4750 - val_accuracy50: 0.4400 - 32s/epoch - 26ms/step
Epoch 9/50
1230/1230 - 33s - loss: 11.6738 - accuracy10: 0.5314 - accuracy20: 0.5246 - accuracy30: 0.5092 - accuracy50: 0.4710 - val_loss: 12.4767 - val_accuracy10: 0.5250 - val_accuracy20: 0.5008 - val_accuracy30: 0.4774 - val_accuracy50: 0.4419 - 33s/epoch - 27ms/step
Epoch 10/50
1230/1230 - 35s - loss: 11.6431 - accuracy10: 0.5328 - accuracy20: 0.5263 - accuracy30: 0.5111 - accuracy50: 0.4730 - val_loss: 12.5555 - val_accuracy10: 0.5291 - val_accuracy20: 0.5019 - val_accuracy30: 0.4756 - val_accuracy50: 0.4395 - 35s/epoch - 28ms/step
Epoch 11/50
1230/1230 - 34s - loss: 11.6186 - accuracy10: 0.5347 - accuracy20: 0.5276 - accuracy30: 0.5136 - accuracy50: 0.4744 - val_loss: 12.4018 - val_accuracy10: 0.5341 - val_accuracy20: 0.5064 - val_accuracy30: 0.4797 - val_accuracy50: 0.4433 - 34s/epoch - 27ms/step
Epoch 12/50
1230/1230 - 33s - loss: 11.5898 - accuracy10: 0.5376 - accuracy20: 0.5300 - accuracy30: 0.5151 - accuracy50: 0.4763 - val_loss: 12.4857 - val_accuracy10: 0.5302 - val_accuracy20: 0.5045 - val_accuracy30: 0.4789 - val_accuracy50: 0.4437 - 33s/epoch - 27ms/step
Epoch 13/50
1230/1230 - 32s - loss: 11.5636 - accuracy10: 0.5388 - accuracy20: 0.5317 - accuracy30: 0.5165 - accuracy50: 0.4771 - val_loss: 12.3842 - val_accuracy10: 0.5292 - val_accuracy20: 0.5045 - val_accuracy30: 0.4789 - val_accuracy50: 0.4441 - 32s/epoch - 26ms/step
Epoch 14/50
1230/1230 - 32s - loss: 11.5436 - accuracy10: 0.5396 - accuracy20: 0.5319 - accuracy30: 0.5175 - accuracy50: 0.4781 - val_loss: 12.4187 - val_accuracy10: 0.5298 - val_accuracy20: 0.5037 - val_accuracy30: 0.4781 - val_accuracy50: 0.4419 - 32s/epoch - 26ms/step
Epoch 15/50
1230/1230 - 33s - loss: 11.5217 - accuracy10: 0.5408 - accuracy20: 0.5337 - accuracy30: 0.5191 - accuracy50: 0.4794 - val_loss: 12.4313 - val_accuracy10: 0.5287 - val_accuracy20: 0.5026 - val_accuracy30: 0.4790 - val_accuracy50: 0.4425 - 33s/epoch - 26ms/step
Epoch 16/50
1230/1230 - 32s - loss: 11.5055 - accuracy10: 0.5426 - accuracy20: 0.5354 - accuracy30: 0.5205 - accuracy50: 0.4806 - val_loss: 12.4081 - val_accuracy10: 0.5260 - val_accuracy20: 0.5033 - val_accuracy30: 0.4792 - val_accuracy50: 0.4447 - 32s/epoch - 26ms/step
Epoch 17/50
1230/1230 - 32s - loss: 11.4895 - accuracy10: 0.5431 - accuracy20: 0.5360 - accuracy30: 0.5211 - accuracy50: 0.4818 - val_loss: 12.4151 - val_accuracy10: 0.5322 - val_accuracy20: 0.5048 - val_accuracy30: 0.4789 - val_accuracy50: 0.4432 - 32s/epoch - 26ms/step
Epoch 18/50
1230/1230 - 32s - loss: 11.4706 - accuracy10: 0.5451 - accuracy20: 0.5376 - accuracy30: 0.5229 - accuracy50: 0.4825 - val_loss: 12.3851 - val_accuracy10: 0.5319 - val_accuracy20: 0.5063 - val_accuracy30: 0.4802 - val_accuracy50: 0.4435 - 32s/epoch - 26ms/step
Epoch 19/50
1230/1230 - 32s - loss: 11.4537 - accuracy10: 0.5455 - accuracy20: 0.5385 - accuracy30: 0.5235 - accuracy50: 0.4846 - val_loss: 12.3886 - val_accuracy10: 0.5296 - val_accuracy20: 0.5056 - val_accuracy30: 0.4808 - val_accuracy50: 0.4443 - 32s/epoch - 26ms/step
Epoch 20/50
1230/1230 - 32s - loss: 11.4351 - accuracy10: 0.5479 - accuracy20: 0.5400 - accuracy30: 0.5249 - accuracy50: 0.4852 - val_loss: 12.4341 - val_accuracy10: 0.5311 - val_accuracy20: 0.5043 - val_accuracy30: 0.4794 - val_accuracy50: 0.4441 - 32s/epoch - 26ms/step
Epoch 21/50
1230/1230 - 34s - loss: 11.4155 - accuracy10: 0.5481 - accuracy20: 0.5420 - accuracy30: 0.5271 - accuracy50: 0.4866 - val_loss: 12.4186 - val_accuracy10: 0.5369 - val_accuracy20: 0.5076 - val_accuracy30: 0.4804 - val_accuracy50: 0.4445 - 34s/epoch - 27ms/step
Epoch 22/50
1230/1230 - 35s - loss: 11.4029 - accuracy10: 0.5483 - accuracy20: 0.5421 - accuracy30: 0.5272 - accuracy50: 0.4872 - val_loss: 12.4446 - val_accuracy10: 0.5332 - val_accuracy20: 0.5059 - val_accuracy30: 0.4806 - val_accuracy50: 0.4438 - 35s/epoch - 28ms/step
Epoch 23/50
1230/1230 - 33s - loss: 11.3862 - accuracy10: 0.5497 - accuracy20: 0.5435 - accuracy30: 0.5291 - accuracy50: 0.4886 - val_loss: 12.4150 - val_accuracy10: 0.5310 - val_accuracy20: 0.5052 - val_accuracy30: 0.4815 - val_accuracy50: 0.4450 - 33s/epoch - 27ms/step
testing model: results/WBA/W7/deepVOL_L2/seq2seq
Evaluating performance on  test set...
4192/4192 - 36s - 36s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8741638
{'0': {'precision': 0.406516880200345, 'recall': 0.5109955430092924, 'f1-score': 0.4528076322143837, 'support': 224591}, '1': {'precision': 0.7358934169278997, 'recall': 0.6651018233389289, 'f1-score': 0.6987090881031728, 'support': 629669}, '2': {'precision': 0.4303759791829206, 'recall': 0.4359815432408973, 'f1-score': 0.4331606264652283, 'support': 218890}, 'accuracy': 0.5861165727065182, 'macro avg': {'precision': 0.5242620921037218, 'recall': 0.5373596365297062, 'f1-score': 0.5282257822609283, 'support': 1073150}, 'weighted avg': {'precision': 0.6046445535740567, 'recall': 0.5861165727065182, 'f1-score': 0.5930825152592566, 'support': 1073150}}
[[114765  67712  42114]
 [126680 418794  84195]
 [ 40868  82590  95432]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9428348
{'0': {'precision': 0.467838661314504, 'recall': 0.4713032886723508, 'f1-score': 0.4695645842434833, 'support': 287350}, '1': {'precision': 0.6162054803743352, 'recall': 0.6882586686614186, 'f1-score': 0.6502421149064259, 'support': 505326}, '2': {'precision': 0.4892318638316504, 'recall': 0.38245256244785614, 'f1-score': 0.4293021059287779, 'support': 280474}, 'accuracy': 0.5502418114895401, 'macro avg': {'precision': 0.5244253351734965, 'recall': 0.5140048399272085, 'f1-score': 0.5163696016928957, 'support': 1073150}, 'weighted avg': {'precision': 0.5432930230449446, 'recall': 0.5502418114895401, 'f1-score': 0.544119376692762, 'support': 1073150}}
[[135429  98457  53464]
 [ 99005 347795  58526]
 [ 55044 118162 107268]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9860469
{'0': {'precision': 0.4865186332611838, 'recall': 0.44032482671214657, 'f1-score': 0.46227058210914157, 'support': 319555}, '1': {'precision': 0.5415925628683219, 'recall': 0.6893546251447527, 'f1-score': 0.6066049653355435, 'support': 439543}, '2': {'precision': 0.5030092706027005, 'recall': 0.35953281622151745, 'f1-score': 0.4193380065920802, 'support': 314052}, 'accuracy': 0.518679588128407, 'macro avg': {'precision': 0.5103734889107354, 'recall': 0.4964040893594723, 'f1-score': 0.4960711846789218, 'support': 1073150}, 'weighted avg': {'precision': 0.5139018302790176, 'recall': 0.518679588128407, 'f1-score': 0.5088233534833188, 'support': 1073150}}
[[140708 116993  61854]
 [ 86835 303001  49707]
 [ 61671 139469 112912]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0397106
{'0': {'precision': 0.455962334043032, 'recall': 0.4061383140451015, 'f1-score': 0.42961056583586943, 'support': 324291}, '1': {'precision': 0.4882259971286894, 'recall': 0.6373549757869535, 'f1-score': 0.5529113872144995, 'support': 423119}, '2': {'precision': 0.4645588831305458, 'recall': 0.33077607908147605, 'f1-score': 0.3864157195781048, 'support': 325740}, 'accuracy': 0.47442668778828684, 'macro avg': {'precision': 0.4695824047674224, 'recall': 0.4580897896378437, 'f1-score': 0.45631255754282457, 'support': 1073150}, 'weighted avg': {'precision': 0.4712925383582787, 'recall': 0.47442668778828684, 'f1-score': 0.46511411242385836, 'support': 1073150}}
[[131707 128699  63885]
 [ 93140 269677  60302]
 [ 64008 153985 107747]]
Evaluating performance on  train set...
1230/1230 - 11s - 11s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.95184416
{'0': {'precision': 0.42936496829685766, 'recall': 0.5149042744090575, 'f1-score': 0.4682602110898482, 'support': 77461}, '1': {'precision': 0.674828486123461, 'recall': 0.5803176774113332, 'f1-score': 0.6240148137254247, 'support': 160855}, '2': {'precision': 0.43617822516049587, 'recall': 0.4766103643322752, 'f1-score': 0.45549882020999016, 'support': 76551}, 'accuracy': 0.5390117097060029, 'macro avg': {'precision': 0.5134572265269383, 'recall': 0.523944105384222, 'f1-score': 0.515924615008421, 'support': 314867}, 'weighted avg': {'precision': 0.5564205053527151, 'recall': 0.5390117097060029, 'f1-score': 0.5447274476490992, 'support': 314867}}
[[39885 20385 17191]
 [37537 93347 29971]
 [15471 24595 36485]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0012522
{'0': {'precision': 0.4893104391557772, 'recall': 0.4795722653027553, 'f1-score': 0.48439241336930144, 'support': 96976}, '1': {'precision': 0.5399555845469404, 'recall': 0.6034896579971329, 'f1-score': 0.5699575264782565, 'support': 122075}, '2': {'precision': 0.4922885035139479, 'recall': 0.42840444184687315, 'f1-score': 0.4581301130592975, 'support': 95816}, 'accuracy': 0.5120447681084395, 'macro avg': {'precision': 0.5071848424055552, 'recall': 0.5038221217155872, 'f1-score': 0.5041600176356185, 'support': 314867}, 'weighted avg': {'precision': 0.5098519768150706, 'recall': 0.5120447681084395, 'f1-score': 0.5095745144350604, 'support': 314867}}
[[46507 28757 21712]
 [27782 73671 20622]
 [20757 34011 41048]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0304904
{'0': {'precision': 0.5055612803161484, 'recall': 0.44837852606983364, 'f1-score': 0.47525602808194894, 'support': 106138}, '1': {'precision': 0.46164502292779414, 'recall': 0.6006863113655861, 'f1-score': 0.5220665851247425, 'support': 103743}, '2': {'precision': 0.5007522304507551, 'recall': 0.40897833996913874, 'f1-score': 0.4502361965280945, 'support': 104986}, 'accuracy': 0.4854240044209142, 'macro avg': {'precision': 0.48931951123156586, 'recall': 0.4860143924681861, 'f1-score': 0.48251960324492865, 'support': 314867}, 'weighted avg': {'precision': 0.4894881853287149, 'recall': 0.4854240044209142, 'f1-score': 0.48233690852917765, 'support': 314867}}
[[47590 33650 24898]
 [23516 62317 17910]
 [23027 39022 42937]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0709409
{'0': {'precision': 0.47369328591443044, 'recall': 0.41414855226088515, 'f1-score': 0.441924180956259, 'support': 106131}, '1': {'precision': 0.4197401194370255, 'recall': 0.5385726112319748, 'f1-score': 0.47178864462377834, 'support': 103882}, '2': {'precision': 0.45919918905220475, 'recall': 0.3888263680927766, 'f1-score': 0.42109285836014443, 'support': 104854}, 'accuracy': 0.44676641248527155, 'macro avg': {'precision': 0.45087753146788684, 'recall': 0.44718251052854546, 'f1-score': 0.4449352279800605, 'support': 314867}, 'weighted avg': {'precision': 0.4510661866236264, 'recall': 0.44676641248527155, 'f1-score': 0.44484011916260086, 'support': 314867}}
[[43954 36441 25736]
 [25655 55948 22279]
 [23181 40903 40770]]
Evaluating performance on  val set...
400/400 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.96372104
{'0': {'precision': 0.4243908898305085, 'recall': 0.5093365117203019, 'f1-score': 0.46299974719202575, 'support': 25170}, '1': {'precision': 0.6689914782568532, 'recall': 0.5644033122260107, 'f1-score': 0.612263014393507, 'support': 51325}, '2': {'precision': 0.4290089086859688, 'recall': 0.4787572815533981, 'f1-score': 0.4525199133722424, 'support': 25750}, 'accuracy': 0.5292777152917013, 'macro avg': {'precision': 0.5074637589244435, 'recall': 0.5174990351665703, 'f1-score': 0.5092608916525917, 'support': 102245}, 'weighted avg': {'precision': 0.5483386543814425, 'recall': 0.5292777152917013, 'f1-score': 0.5352876973925892, 'support': 102245}}
[[12820  6240  6110]
 [12059 28968 10298]
 [ 5329  8093 12328]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.007053
{'0': {'precision': 0.4822594196342015, 'recall': 0.477552718313014, 'f1-score': 0.4798945286750165, 'support': 31251}, '1': {'precision': 0.5371091916251995, 'recall': 0.5829766636094976, 'f1-score': 0.5591037920250195, 'support': 39252}, '2': {'precision': 0.4798396933263635, 'recall': 0.4337785898809149, 'f1-score': 0.4556480301801877, 'support': 31742}, 'accuracy': 0.504435424715145, 'macro avg': {'precision': 0.49973610152858816, 'recall': 0.4981026572678089, 'f1-score': 0.4982154502934079, 'support': 102245}, 'weighted avg': {'precision': 0.5025651196462046, 'recall': 0.504435424715145, 'f1-score': 0.5027757419352391, 'support': 102245}}
[[14924  8751  7576]
 [ 9019 22883  7350]
 [ 7003 10970 13769]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.033111
{'0': {'precision': 0.49494455316373126, 'recall': 0.4461398247780326, 'f1-score': 0.4692766799641278, 'support': 34014}, '1': {'precision': 0.46410720236111774, 'recall': 0.574767870302137, 'f1-score': 0.5135437653906426, 'support': 33925}, '2': {'precision': 0.4840553244733015, 'recall': 0.4172447968285431, 'f1-score': 0.4481738340873867, 'support': 34306}, 'accuracy': 0.47912367352926793, 'macro avg': {'precision': 0.48103569333271684, 'recall': 0.4793841639695709, 'f1-score': 0.47699809314738567, 'support': 102245}, 'weighted avg': {'precision': 0.48105905259712606, 'recall': 0.47912367352926793, 'f1-score': 0.47688396288698015, 'support': 102245}}
[[15175 10207  8632]
 [ 7801 19499  6625]
 [ 7684 12308 14314]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0694976
{'0': {'precision': 0.4672847856930742, 'recall': 0.41360981308411215, 'f1-score': 0.4388120284443894, 'support': 34240}, '1': {'precision': 0.4221447422580567, 'recall': 0.5146863468634686, 'f1-score': 0.4638448440991806, 'support': 33875}, '2': {'precision': 0.448085648072592, 'recall': 0.4022267799589804, 'f1-score': 0.42391958867942015, 'support': 34130}, 'accuracy': 0.4432979607804783, 'macro avg': {'precision': 0.44583839200790765, 'recall': 0.4435076466355204, 'f1-score': 0.44219215374099674, 'support': 102245}, 'weighted avg': {'precision': 0.4459205572383989, 'recall': 0.4432979607804783, 'f1-score': 0.44213451522738756, 'support': 102245}}
[[14162 11178  8900]
 [ 8431 17435  8009]
 [ 7714 12688 13728]]
training model: results/WBA/W7/deepVOL_L3/seq2seq
Epoch 1/50
1230/1230 - 56s - loss: 12.9461 - accuracy10: 0.4104 - accuracy20: 0.4101 - accuracy30: 0.4058 - accuracy50: 0.3914 - val_loss: 13.0677 - val_accuracy10: 0.4895 - val_accuracy20: 0.4236 - val_accuracy30: 0.3916 - val_accuracy50: 0.3765 - 56s/epoch - 46ms/step
Epoch 2/50
1230/1230 - 49s - loss: 12.6195 - accuracy10: 0.4164 - accuracy20: 0.4357 - accuracy30: 0.4369 - accuracy50: 0.4170 - val_loss: 12.5215 - val_accuracy10: 0.4358 - val_accuracy20: 0.4596 - val_accuracy30: 0.4590 - val_accuracy50: 0.4313 - 49s/epoch - 39ms/step
Epoch 3/50
1230/1230 - 49s - loss: 12.2357 - accuracy10: 0.4669 - accuracy20: 0.4806 - accuracy30: 0.4766 - accuracy50: 0.4449 - val_loss: 12.3776 - val_accuracy10: 0.4521 - val_accuracy20: 0.4716 - val_accuracy30: 0.4698 - val_accuracy50: 0.4391 - 49s/epoch - 40ms/step
Epoch 4/50
1230/1230 - 49s - loss: 12.0034 - accuracy10: 0.4964 - accuracy20: 0.5004 - accuracy30: 0.4912 - accuracy50: 0.4557 - val_loss: 12.2106 - val_accuracy10: 0.4790 - val_accuracy20: 0.4888 - val_accuracy30: 0.4791 - val_accuracy50: 0.4450 - 49s/epoch - 40ms/step
Epoch 5/50
1230/1230 - 48s - loss: 11.8507 - accuracy10: 0.5103 - accuracy20: 0.5114 - accuracy30: 0.4993 - accuracy50: 0.4615 - val_loss: 12.1372 - val_accuracy10: 0.4973 - val_accuracy20: 0.4965 - val_accuracy30: 0.4820 - val_accuracy50: 0.4466 - 48s/epoch - 39ms/step
Epoch 6/50
1230/1230 - 47s - loss: 11.7655 - accuracy10: 0.5185 - accuracy20: 0.5172 - accuracy30: 0.5043 - accuracy50: 0.4657 - val_loss: 12.0933 - val_accuracy10: 0.5009 - val_accuracy20: 0.4995 - val_accuracy30: 0.4837 - val_accuracy50: 0.4493 - 47s/epoch - 38ms/step
Epoch 7/50
1230/1230 - 47s - loss: 11.7089 - accuracy10: 0.5218 - accuracy20: 0.5207 - accuracy30: 0.5075 - accuracy50: 0.4693 - val_loss: 12.0385 - val_accuracy10: 0.5049 - val_accuracy20: 0.5020 - val_accuracy30: 0.4869 - val_accuracy50: 0.4506 - 47s/epoch - 39ms/step
Epoch 8/50
1230/1230 - 47s - loss: 11.6588 - accuracy10: 0.5271 - accuracy20: 0.5245 - accuracy30: 0.5106 - accuracy50: 0.4718 - val_loss: 12.0037 - val_accuracy10: 0.5008 - val_accuracy20: 0.5021 - val_accuracy30: 0.4878 - val_accuracy50: 0.4517 - 47s/epoch - 39ms/step
Epoch 9/50
1230/1230 - 52s - loss: 11.6243 - accuracy10: 0.5297 - accuracy20: 0.5260 - accuracy30: 0.5119 - accuracy50: 0.4728 - val_loss: 11.9684 - val_accuracy10: 0.5155 - val_accuracy20: 0.5084 - val_accuracy30: 0.4898 - val_accuracy50: 0.4526 - 52s/epoch - 42ms/step
Epoch 10/50
1230/1230 - 48s - loss: 11.5981 - accuracy10: 0.5327 - accuracy20: 0.5280 - accuracy30: 0.5146 - accuracy50: 0.4751 - val_loss: 11.9232 - val_accuracy10: 0.5125 - val_accuracy20: 0.5087 - val_accuracy30: 0.4926 - val_accuracy50: 0.4556 - 48s/epoch - 39ms/step
Epoch 11/50
1230/1230 - 47s - loss: 11.5674 - accuracy10: 0.5344 - accuracy20: 0.5293 - accuracy30: 0.5157 - accuracy50: 0.4757 - val_loss: 11.9261 - val_accuracy10: 0.5095 - val_accuracy20: 0.5095 - val_accuracy30: 0.4941 - val_accuracy50: 0.4562 - 47s/epoch - 39ms/step
Epoch 12/50
1230/1230 - 49s - loss: 11.5389 - accuracy10: 0.5366 - accuracy20: 0.5317 - accuracy30: 0.5177 - accuracy50: 0.4781 - val_loss: 11.9616 - val_accuracy10: 0.5097 - val_accuracy20: 0.5091 - val_accuracy30: 0.4939 - val_accuracy50: 0.4565 - 49s/epoch - 40ms/step
Epoch 13/50
1230/1230 - 47s - loss: 11.5152 - accuracy10: 0.5384 - accuracy20: 0.5329 - accuracy30: 0.5187 - accuracy50: 0.4793 - val_loss: 11.9245 - val_accuracy10: 0.5085 - val_accuracy20: 0.5093 - val_accuracy30: 0.4938 - val_accuracy50: 0.4558 - 47s/epoch - 39ms/step
Epoch 14/50
1230/1230 - 47s - loss: 11.4940 - accuracy10: 0.5404 - accuracy20: 0.5346 - accuracy30: 0.5210 - accuracy50: 0.4812 - val_loss: 11.9323 - val_accuracy10: 0.5098 - val_accuracy20: 0.5109 - val_accuracy30: 0.4960 - val_accuracy50: 0.4587 - 47s/epoch - 38ms/step
Epoch 15/50
1230/1230 - 47s - loss: 11.4714 - accuracy10: 0.5416 - accuracy20: 0.5355 - accuracy30: 0.5216 - accuracy50: 0.4818 - val_loss: 11.9411 - val_accuracy10: 0.5057 - val_accuracy20: 0.5100 - val_accuracy30: 0.4962 - val_accuracy50: 0.4586 - 47s/epoch - 38ms/step
Epoch 16/50
1230/1230 - 47s - loss: 11.4522 - accuracy10: 0.5439 - accuracy20: 0.5372 - accuracy30: 0.5228 - accuracy50: 0.4829 - val_loss: 11.9197 - val_accuracy10: 0.5087 - val_accuracy20: 0.5097 - val_accuracy30: 0.4959 - val_accuracy50: 0.4577 - 47s/epoch - 38ms/step
Epoch 17/50
1230/1230 - 48s - loss: 11.4359 - accuracy10: 0.5440 - accuracy20: 0.5371 - accuracy30: 0.5233 - accuracy50: 0.4835 - val_loss: 11.9210 - val_accuracy10: 0.5060 - val_accuracy20: 0.5085 - val_accuracy30: 0.4949 - val_accuracy50: 0.4579 - 48s/epoch - 39ms/step
Epoch 18/50
1230/1230 - 49s - loss: 11.4194 - accuracy10: 0.5442 - accuracy20: 0.5383 - accuracy30: 0.5253 - accuracy50: 0.4854 - val_loss: 11.9130 - val_accuracy10: 0.5039 - val_accuracy20: 0.5080 - val_accuracy30: 0.4947 - val_accuracy50: 0.4574 - 49s/epoch - 40ms/step
Epoch 19/50
1230/1230 - 48s - loss: 11.3983 - accuracy10: 0.5459 - accuracy20: 0.5398 - accuracy30: 0.5265 - accuracy50: 0.4863 - val_loss: 11.8894 - val_accuracy10: 0.5110 - val_accuracy20: 0.5119 - val_accuracy30: 0.4971 - val_accuracy50: 0.4583 - 48s/epoch - 39ms/step
Epoch 20/50
1230/1230 - 50s - loss: 11.3872 - accuracy10: 0.5461 - accuracy20: 0.5399 - accuracy30: 0.5267 - accuracy50: 0.4868 - val_loss: 11.9021 - val_accuracy10: 0.5095 - val_accuracy20: 0.5104 - val_accuracy30: 0.4950 - val_accuracy50: 0.4557 - 50s/epoch - 41ms/step
Epoch 21/50
1230/1230 - 48s - loss: 11.3684 - accuracy10: 0.5472 - accuracy20: 0.5415 - accuracy30: 0.5287 - accuracy50: 0.4880 - val_loss: 11.9361 - val_accuracy10: 0.5043 - val_accuracy20: 0.5085 - val_accuracy30: 0.4949 - val_accuracy50: 0.4562 - 48s/epoch - 39ms/step
Epoch 22/50
1230/1230 - 47s - loss: 11.3545 - accuracy10: 0.5496 - accuracy20: 0.5434 - accuracy30: 0.5302 - accuracy50: 0.4905 - val_loss: 11.9204 - val_accuracy10: 0.5055 - val_accuracy20: 0.5075 - val_accuracy30: 0.4939 - val_accuracy50: 0.4556 - 47s/epoch - 38ms/step
Epoch 23/50
1230/1230 - 47s - loss: 11.3363 - accuracy10: 0.5496 - accuracy20: 0.5441 - accuracy30: 0.5307 - accuracy50: 0.4905 - val_loss: 11.9245 - val_accuracy10: 0.5098 - val_accuracy20: 0.5081 - val_accuracy30: 0.4935 - val_accuracy50: 0.4561 - 47s/epoch - 38ms/step
Epoch 24/50
1230/1230 - 47s - loss: 11.3193 - accuracy10: 0.5502 - accuracy20: 0.5441 - accuracy30: 0.5311 - accuracy50: 0.4919 - val_loss: 11.9421 - val_accuracy10: 0.5036 - val_accuracy20: 0.5056 - val_accuracy30: 0.4929 - val_accuracy50: 0.4559 - 47s/epoch - 39ms/step
Epoch 25/50
1230/1230 - 48s - loss: 11.3011 - accuracy10: 0.5513 - accuracy20: 0.5457 - accuracy30: 0.5334 - accuracy50: 0.4932 - val_loss: 11.9388 - val_accuracy10: 0.5087 - val_accuracy20: 0.5085 - val_accuracy30: 0.4948 - val_accuracy50: 0.4567 - 48s/epoch - 39ms/step
Epoch 26/50
1230/1230 - 48s - loss: 11.2829 - accuracy10: 0.5517 - accuracy20: 0.5469 - accuracy30: 0.5342 - accuracy50: 0.4936 - val_loss: 11.9409 - val_accuracy10: 0.5127 - val_accuracy20: 0.5097 - val_accuracy30: 0.4936 - val_accuracy50: 0.4557 - 48s/epoch - 39ms/step
Epoch 27/50
1230/1230 - 47s - loss: 11.2737 - accuracy10: 0.5528 - accuracy20: 0.5474 - accuracy30: 0.5354 - accuracy50: 0.4945 - val_loss: 11.9483 - val_accuracy10: 0.5123 - val_accuracy20: 0.5099 - val_accuracy30: 0.4932 - val_accuracy50: 0.4552 - 47s/epoch - 38ms/step
Epoch 28/50
1230/1230 - 48s - loss: 11.2574 - accuracy10: 0.5533 - accuracy20: 0.5485 - accuracy30: 0.5368 - accuracy50: 0.4959 - val_loss: 11.9511 - val_accuracy10: 0.5087 - val_accuracy20: 0.5076 - val_accuracy30: 0.4934 - val_accuracy50: 0.4554 - 48s/epoch - 39ms/step
Epoch 29/50
1230/1230 - 49s - loss: 11.2410 - accuracy10: 0.5543 - accuracy20: 0.5498 - accuracy30: 0.5374 - accuracy50: 0.4977 - val_loss: 11.9813 - val_accuracy10: 0.5014 - val_accuracy20: 0.5048 - val_accuracy30: 0.4917 - val_accuracy50: 0.4547 - 49s/epoch - 40ms/step
testing model: results/WBA/W7/deepVOL_L3/seq2seq
Evaluating performance on  test set...
4192/4192 - 66s - 66s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.90298945
{'0': {'precision': 0.3881173036138506, 'recall': 0.6103138594155598, 'f1-score': 0.47449113818886735, 'support': 224591}, '1': {'precision': 0.7833624039220759, 'recall': 0.5577660643925618, 'f1-score': 0.6515900234043875, 'support': 629669}, '2': {'precision': 0.42338034287144716, 'recall': 0.5254237288135594, 'f1-score': 0.46891467921889685, 'support': 218890}, 'accuracy': 0.5621665191259376, 'macro avg': {'precision': 0.5316200168024579, 'recall': 0.5645012175405603, 'f1-score': 0.5316652802707172, 'support': 1073150}, 'weighted avg': {'precision': 0.6272193058773509, 'recall': 0.5621665191259376, 'f1-score': 0.5772661899997369, 'support': 1073150}}
[[137071  43979  43541]
 [165365 351208 113096]
 [ 50733  53147 115010]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9294837
{'0': {'precision': 0.4521388873294785, 'recall': 0.5605672524795545, 'f1-score': 0.5005484687932134, 'support': 287350}, '1': {'precision': 0.6678098178928216, 'recall': 0.5803382370984276, 'f1-score': 0.6210089754707172, 'support': 505326}, '2': {'precision': 0.48462122821355663, 'recall': 0.4799197073525532, 'f1-score': 0.48225900932774657, 'support': 280474}, 'accuracy': 0.5487993290779482, 'macro avg': {'precision': 0.5348566444786189, 'recall': 0.5402750656435118, 'f1-score': 0.5346054845305591, 'support': 1073150}, 'weighted avg': {'precision': 0.562183690698041, 'recall': 0.5487993290779482, 'f1-score': 0.5524909820888374, 'support': 1073150}}
[[161079  67505  58766]
 [127684 293260  84382]
 [ 67497  78372 134605]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9594603
{'0': {'precision': 0.47082192667287526, 'recall': 0.523665722645554, 'f1-score': 0.49583985208362963, 'support': 319555}, '1': {'precision': 0.589118004052077, 'recall': 0.5808282693615869, 'f1-score': 0.5849437679645229, 'support': 439543}, '2': {'precision': 0.5008035277858853, 'recall': 0.45347267331524715, 'f1-score': 0.47596432623746077, 'support': 314052}, 'accuracy': 0.5265368308251409, 'macro avg': {'precision': 0.5202478195036125, 'recall': 0.5193222217741295, 'f1-score': 0.5189159820952044, 'support': 1073150}, 'weighted avg': {'precision': 0.5280478452604255, 'recall': 0.5265368308251409, 'f1-score': 0.5265187449271226, 'support': 1073150}}
[[167340  82977  69238]
 [111525 255299  72719]
 [ 76556  95082 142414]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0153565
{'0': {'precision': 0.44337904510097587, 'recall': 0.4902202034592388, 'f1-score': 0.4656245515067907, 'support': 324291}, '1': {'precision': 0.5253172742514632, 'recall': 0.5279791264396069, 'f1-score': 0.5266448368777272, 'support': 423119}, '2': {'precision': 0.4666201233168358, 'recall': 0.4144716645177135, 'f1-score': 0.43900265983390674, 'support': 325740}, 'accuracy': 0.4821152681358617, 'macro avg': {'precision': 0.4784388142230916, 'recall': 0.47755699813885305, 'f1-score': 0.4770906827394749, 'support': 1073150}, 'weighted avg': {'precision': 0.4827399642622853, 'recall': 0.4821152681358617, 'f1-score': 0.4816027718230001, 'support': 1073150}}
[[158974  93195  72122]
 [117517 223398  82204]
 [ 82060 108670 135010]]
Evaluating performance on  train set...
1230/1230 - 20s - 20s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9618829
{'0': {'precision': 0.4211270047680971, 'recall': 0.6271155807438582, 'f1-score': 0.503882039925108, 'support': 77461}, '1': {'precision': 0.74122441781862, 'recall': 0.47035528892480805, 'f1-score': 0.5755111665551025, 'support': 160855}, '2': {'precision': 0.43567587537457414, 'recall': 0.5545845253491136, 'f1-score': 0.4879910342251214, 'support': 76551}, 'accuracy': 0.5293981268281528, 'macro avg': {'precision': 0.5326757659870971, 'recall': 0.5506851316725934, 'f1-score': 0.522461413568444, 'support': 314867}, 'weighted avg': {'precision': 0.5881911936797274, 'recall': 0.5293981268281528, 'f1-score': 0.536611512326878, 'support': 314867}}
[[48577 11872 17012]
 [47218 75659 37978]
 [19555 14542 42454]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.96339923
{'0': {'precision': 0.48506834730045334, 'recall': 0.5825461969971952, 'f1-score': 0.5293571964017991, 'support': 96976}, '1': {'precision': 0.6114915938676326, 'recall': 0.4936964980544747, 'f1-score': 0.5463165241984463, 'support': 122075}, '2': {'precision': 0.49485196907175194, 'recall': 0.5156550054270685, 'f1-score': 0.5050393539813964, 'support': 95816}, 'accuracy': 0.5277434599370527, 'macro avg': {'precision': 0.5304706367466127, 'recall': 0.5306325668262462, 'f1-score': 0.5269043581938806, 'support': 314867}, 'weighted avg': {'precision': 0.537060284621059, 'recall': 0.5277434599370527, 'f1-score': 0.5285323133604591, 'support': 314867}}
[[56493 17563 22920]
 [34291 60268 27516]
 [25680 20728 49408]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9814868
{'0': {'precision': 0.5032747686869737, 'recall': 0.5473251804254838, 'f1-score': 0.5243764837565331, 'support': 106138}, '1': {'precision': 0.5273796019387439, 'recall': 0.4929489218549685, 'f1-score': 0.5095833354092659, 'support': 103743}, '2': {'precision': 0.5074119977749368, 'recall': 0.49524698531232736, 'f1-score': 0.501255694005929, 'support': 104986}, 'accuracy': 0.5120447681084395, 'macro avg': {'precision': 0.5126887894668849, 'recall': 0.5118403625309266, 'f1-score': 0.511738504390576, 'support': 314867}, 'weighted avg': {'precision': 0.5125963516063247, 'recall': 0.5120447681084395, 'f1-score': 0.5117932507668979, 'support': 314867}}
[[58092 21310 26736]
 [28864 51140 23739]
 [28472 24520 51994]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0324028
{'0': {'precision': 0.4714602829162133, 'recall': 0.510303304406818, 'f1-score': 0.49011339058668096, 'support': 106131}, '1': {'precision': 0.4673932333260259, 'recall': 0.4309986330644385, 'f1-score': 0.4484587454613747, 'support': 103882}, '2': {'precision': 0.46939030125049186, 'recall': 0.4664581227230244, 'f1-score': 0.4679196184699574, 'support': 104854}, 'accuracy': 0.4695379318887022, 'macro avg': {'precision': 0.4694146058309103, 'recall': 0.46925335339809365, 'f1-score': 0.4688305848393377, 'support': 314867}, 'weighted avg': {'precision': 0.4694291424565735, 'recall': 0.4695379318887022, 'f1-score': 0.46897978933143986, 'support': 314867}}
[[54159 24169 27803]
 [31623 44773 27486]
 [29093 26851 48910]]
Evaluating performance on  val set...
400/400 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.98332167
{'0': {'precision': 0.4081692156810772, 'recall': 0.6117997616209774, 'f1-score': 0.4896576943256435, 'support': 25170}, '1': {'precision': 0.7361088292314264, 'recall': 0.4364734534827082, 'f1-score': 0.5480075344308813, 'support': 51325}, '2': {'precision': 0.42549508581487455, 'recall': 0.5632233009708738, 'f1-score': 0.4847664410462104, 'support': 25750}, 'accuracy': 0.511555577289843, 'macro avg': {'precision': 0.5232577102424594, 'recall': 0.5371655053581864, 'f1-score': 0.5074772232675785, 'support': 102245}, 'weighted avg': {'precision': 0.5771519710374952, 'recall': 0.511555577289843, 'f1-score': 0.517716335544832, 'support': 102245}}
[[15399  3526  6245]
 [15586 22402 13337]
 [ 6742  4505 14503]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9784607
{'0': {'precision': 0.4692402378021633, 'recall': 0.5733256535790855, 'f1-score': 0.5160872195178156, 'support': 31251}, '1': {'precision': 0.6124180088601944, 'recall': 0.4543207989401814, 'f1-score': 0.5216539175966418, 'support': 39252}, '2': {'precision': 0.479895830352288, 'recall': 0.528290592905299, 'f1-score': 0.5029316937842093, 'support': 31742}, 'accuracy': 0.5136583696024255, 'macro avg': {'precision': 0.5205180256715486, 'recall': 0.5186456818081886, 'f1-score': 0.5135576102995555, 'support': 102245}, 'weighted avg': {'precision': 0.5275144193102653, 'recall': 0.5136583696024255, 'f1-score': 0.5141401446990368, 'support': 102245}}
[[17917  5051  8283]
 [11528 17833  9891]
 [ 8738  6235 16769]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9938299
{'0': {'precision': 0.4833790628957366, 'recall': 0.5386605515376022, 'f1-score': 0.5095247365054645, 'support': 34014}, '1': {'precision': 0.5345184250201606, 'recall': 0.44937361827560796, 'f1-score': 0.4882618582455241, 'support': 33925}, '2': {'precision': 0.4836683417085427, 'recall': 0.5050137002273655, 'f1-score': 0.49411060091834696, 'support': 34306}, 'accuracy': 0.49774561103232434, 'macro avg': {'precision': 0.5005219432081466, 'recall': 0.49768262334685853, 'f1-score': 0.4972990652231118, 'support': 102245}, 'weighted avg': {'precision': 0.500444218737325, 'recall': 0.49774561103232434, 'f1-score': 0.4972978258455777, 'support': 102245}}
[[18322  6040  9652]
 [ 9837 15245  8843]
 [ 9745  7236 17325]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0388277
{'0': {'precision': 0.4558217005076142, 'recall': 0.5035338785046729, 'f1-score': 0.47849134103019536, 'support': 34240}, '1': {'precision': 0.4765402167712493, 'recall': 0.39456826568265685, 'f1-score': 0.43169743068003813, 'support': 33875}, '2': {'precision': 0.4490693646386056, 'recall': 0.47858189276296514, 'f1-score': 0.46335616924102524, 'support': 34130}, 'accuracy': 0.45910313462761015, 'macro avg': {'precision': 0.46047709397248965, 'recall': 0.4588946789834316, 'f1-score': 0.4578483136504196, 'support': 102245}, 'weighted avg': {'precision': 0.4604320238996762, 'recall': 0.45910313462761015, 'f1-score': 0.4579357429444606, 'support': 102245}}
[[17241  6907 10092]
 [10562 13366  9947]
 [10021  7775 16334]]
training model: results/WBA/W8/deepLOB_L1/seq2seq
Epoch 1/50
1532/1532 - 40s - loss: 12.3836 - accuracy10: 0.4618 - accuracy20: 0.4649 - accuracy30: 0.4564 - accuracy50: 0.4316 - val_loss: 15.3701 - val_accuracy10: 0.4777 - val_accuracy20: 0.3740 - val_accuracy30: 0.3416 - val_accuracy50: 0.3380 - 40s/epoch - 26ms/step
Epoch 2/50
1532/1532 - 34s - loss: 12.5013 - accuracy10: 0.4380 - accuracy20: 0.4511 - accuracy30: 0.4462 - accuracy50: 0.4245 - val_loss: 14.3232 - val_accuracy10: 0.4887 - val_accuracy20: 0.3836 - val_accuracy30: 0.3500 - val_accuracy50: 0.3433 - 34s/epoch - 22ms/step
Epoch 3/50
1532/1532 - 35s - loss: 12.3878 - accuracy10: 0.4479 - accuracy20: 0.4607 - accuracy30: 0.4538 - accuracy50: 0.4303 - val_loss: 13.7137 - val_accuracy10: 0.4980 - val_accuracy20: 0.4122 - val_accuracy30: 0.3803 - val_accuracy50: 0.3664 - 35s/epoch - 23ms/step
Epoch 4/50
1532/1532 - 36s - loss: 12.1606 - accuracy10: 0.4836 - accuracy20: 0.4887 - accuracy30: 0.4769 - accuracy50: 0.4467 - val_loss: 13.5771 - val_accuracy10: 0.4951 - val_accuracy20: 0.4230 - val_accuracy30: 0.3950 - val_accuracy50: 0.3796 - 36s/epoch - 23ms/step
Epoch 5/50
1532/1532 - 37s - loss: 12.0164 - accuracy10: 0.5031 - accuracy20: 0.5023 - accuracy30: 0.4885 - accuracy50: 0.4552 - val_loss: 13.7242 - val_accuracy10: 0.4990 - val_accuracy20: 0.4224 - val_accuracy30: 0.3932 - val_accuracy50: 0.3780 - 37s/epoch - 24ms/step
Epoch 6/50
1532/1532 - 33s - loss: 11.9089 - accuracy10: 0.5148 - accuracy20: 0.5106 - accuracy30: 0.4952 - accuracy50: 0.4603 - val_loss: 13.6326 - val_accuracy10: 0.5004 - val_accuracy20: 0.4352 - val_accuracy30: 0.4065 - val_accuracy50: 0.3872 - 33s/epoch - 22ms/step
Epoch 7/50
1532/1532 - 33s - loss: 11.8433 - accuracy10: 0.5209 - accuracy20: 0.5146 - accuracy30: 0.4989 - accuracy50: 0.4632 - val_loss: 13.5727 - val_accuracy10: 0.5084 - val_accuracy20: 0.4347 - val_accuracy30: 0.4033 - val_accuracy50: 0.3832 - 33s/epoch - 22ms/step
Epoch 8/50
1532/1532 - 35s - loss: 11.7825 - accuracy10: 0.5269 - accuracy20: 0.5193 - accuracy30: 0.5022 - accuracy50: 0.4657 - val_loss: 13.4394 - val_accuracy10: 0.5064 - val_accuracy20: 0.4431 - val_accuracy30: 0.4121 - val_accuracy50: 0.3892 - 35s/epoch - 23ms/step
Epoch 9/50
1532/1532 - 34s - loss: 11.7312 - accuracy10: 0.5311 - accuracy20: 0.5221 - accuracy30: 0.5044 - accuracy50: 0.4678 - val_loss: 13.5014 - val_accuracy10: 0.5081 - val_accuracy20: 0.4438 - val_accuracy30: 0.4124 - val_accuracy50: 0.3894 - 34s/epoch - 22ms/step
Epoch 10/50
1532/1532 - 35s - loss: 11.6979 - accuracy10: 0.5335 - accuracy20: 0.5237 - accuracy30: 0.5063 - accuracy50: 0.4695 - val_loss: 13.5567 - val_accuracy10: 0.5100 - val_accuracy20: 0.4387 - val_accuracy30: 0.4057 - val_accuracy50: 0.3833 - 35s/epoch - 23ms/step
Epoch 11/50
1532/1532 - 33s - loss: 11.6634 - accuracy10: 0.5362 - accuracy20: 0.5255 - accuracy30: 0.5077 - accuracy50: 0.4711 - val_loss: 13.5656 - val_accuracy10: 0.5142 - val_accuracy20: 0.4396 - val_accuracy30: 0.4054 - val_accuracy50: 0.3829 - 33s/epoch - 22ms/step
Epoch 12/50
1532/1532 - 34s - loss: 11.6344 - accuracy10: 0.5383 - accuracy20: 0.5264 - accuracy30: 0.5087 - accuracy50: 0.4718 - val_loss: 13.4440 - val_accuracy10: 0.5137 - val_accuracy20: 0.4370 - val_accuracy30: 0.4008 - val_accuracy50: 0.3777 - 34s/epoch - 22ms/step
Epoch 13/50
1532/1532 - 35s - loss: 11.6029 - accuracy10: 0.5402 - accuracy20: 0.5281 - accuracy30: 0.5104 - accuracy50: 0.4733 - val_loss: 13.4729 - val_accuracy10: 0.5159 - val_accuracy20: 0.4329 - val_accuracy30: 0.3956 - val_accuracy50: 0.3727 - 35s/epoch - 23ms/step
Epoch 14/50
1532/1532 - 36s - loss: 11.5842 - accuracy10: 0.5417 - accuracy20: 0.5296 - accuracy30: 0.5111 - accuracy50: 0.4740 - val_loss: 13.4592 - val_accuracy10: 0.5166 - val_accuracy20: 0.4346 - val_accuracy30: 0.3982 - val_accuracy50: 0.3745 - 36s/epoch - 23ms/step
Epoch 15/50
1532/1532 - 32s - loss: 11.5588 - accuracy10: 0.5437 - accuracy20: 0.5309 - accuracy30: 0.5127 - accuracy50: 0.4750 - val_loss: 13.4046 - val_accuracy10: 0.5159 - val_accuracy20: 0.4405 - val_accuracy30: 0.4038 - val_accuracy50: 0.3786 - 32s/epoch - 21ms/step
Epoch 16/50
1532/1532 - 35s - loss: 11.5388 - accuracy10: 0.5450 - accuracy20: 0.5314 - accuracy30: 0.5131 - accuracy50: 0.4756 - val_loss: 13.3768 - val_accuracy10: 0.5137 - val_accuracy20: 0.4394 - val_accuracy30: 0.4037 - val_accuracy50: 0.3772 - 35s/epoch - 23ms/step
Epoch 17/50
1532/1532 - 35s - loss: 11.5185 - accuracy10: 0.5459 - accuracy20: 0.5330 - accuracy30: 0.5143 - accuracy50: 0.4768 - val_loss: 13.3317 - val_accuracy10: 0.5144 - val_accuracy20: 0.4374 - val_accuracy30: 0.3982 - val_accuracy50: 0.3738 - 35s/epoch - 23ms/step
Epoch 18/50
1532/1532 - 32s - loss: 11.5062 - accuracy10: 0.5464 - accuracy20: 0.5334 - accuracy30: 0.5150 - accuracy50: 0.4773 - val_loss: 13.4510 - val_accuracy10: 0.5146 - val_accuracy20: 0.4390 - val_accuracy30: 0.4015 - val_accuracy50: 0.3758 - 32s/epoch - 21ms/step
Epoch 19/50
1532/1532 - 33s - loss: 11.4930 - accuracy10: 0.5474 - accuracy20: 0.5340 - accuracy30: 0.5157 - accuracy50: 0.4780 - val_loss: 13.1946 - val_accuracy10: 0.5103 - val_accuracy20: 0.4401 - val_accuracy30: 0.4061 - val_accuracy50: 0.3805 - 33s/epoch - 21ms/step
Epoch 20/50
1532/1532 - 35s - loss: 11.4792 - accuracy10: 0.5482 - accuracy20: 0.5355 - accuracy30: 0.5163 - accuracy50: 0.4786 - val_loss: 13.4246 - val_accuracy10: 0.5147 - val_accuracy20: 0.4386 - val_accuracy30: 0.4030 - val_accuracy50: 0.3787 - 35s/epoch - 23ms/step
Epoch 21/50
1532/1532 - 31s - loss: 11.4650 - accuracy10: 0.5498 - accuracy20: 0.5356 - accuracy30: 0.5169 - accuracy50: 0.4793 - val_loss: 13.2297 - val_accuracy10: 0.5124 - val_accuracy20: 0.4438 - val_accuracy30: 0.4085 - val_accuracy50: 0.3826 - 31s/epoch - 20ms/step
Epoch 22/50
1532/1532 - 32s - loss: 11.4493 - accuracy10: 0.5496 - accuracy20: 0.5366 - accuracy30: 0.5180 - accuracy50: 0.4800 - val_loss: 13.3655 - val_accuracy10: 0.5102 - val_accuracy20: 0.4382 - val_accuracy30: 0.4036 - val_accuracy50: 0.3795 - 32s/epoch - 21ms/step
Epoch 23/50
1532/1532 - 34s - loss: 11.4363 - accuracy10: 0.5510 - accuracy20: 0.5376 - accuracy30: 0.5188 - accuracy50: 0.4801 - val_loss: 13.3478 - val_accuracy10: 0.5079 - val_accuracy20: 0.4392 - val_accuracy30: 0.4058 - val_accuracy50: 0.3803 - 34s/epoch - 22ms/step
Epoch 24/50
1532/1532 - 35s - loss: 11.4270 - accuracy10: 0.5513 - accuracy20: 0.5381 - accuracy30: 0.5198 - accuracy50: 0.4818 - val_loss: 13.3504 - val_accuracy10: 0.5050 - val_accuracy20: 0.4420 - val_accuracy30: 0.4083 - val_accuracy50: 0.3828 - 35s/epoch - 23ms/step
Epoch 25/50
1532/1532 - 33s - loss: 11.4142 - accuracy10: 0.5514 - accuracy20: 0.5385 - accuracy30: 0.5204 - accuracy50: 0.4819 - val_loss: 13.2578 - val_accuracy10: 0.5021 - val_accuracy20: 0.4407 - val_accuracy30: 0.4085 - val_accuracy50: 0.3822 - 33s/epoch - 22ms/step
Epoch 26/50
1532/1532 - 35s - loss: 11.4030 - accuracy10: 0.5521 - accuracy20: 0.5399 - accuracy30: 0.5209 - accuracy50: 0.4822 - val_loss: 13.3277 - val_accuracy10: 0.5060 - val_accuracy20: 0.4408 - val_accuracy30: 0.4061 - val_accuracy50: 0.3803 - 35s/epoch - 23ms/step
Epoch 27/50
1532/1532 - 35s - loss: 11.3930 - accuracy10: 0.5532 - accuracy20: 0.5401 - accuracy30: 0.5214 - accuracy50: 0.4828 - val_loss: 13.1066 - val_accuracy10: 0.5016 - val_accuracy20: 0.4459 - val_accuracy30: 0.4151 - val_accuracy50: 0.3895 - 35s/epoch - 23ms/step
Epoch 28/50
1532/1532 - 33s - loss: 11.3829 - accuracy10: 0.5535 - accuracy20: 0.5408 - accuracy30: 0.5221 - accuracy50: 0.4839 - val_loss: 13.0534 - val_accuracy10: 0.4970 - val_accuracy20: 0.4518 - val_accuracy30: 0.4216 - val_accuracy50: 0.3928 - 33s/epoch - 22ms/step
Epoch 29/50
1532/1532 - 34s - loss: 11.3701 - accuracy10: 0.5538 - accuracy20: 0.5416 - accuracy30: 0.5231 - accuracy50: 0.4850 - val_loss: 13.1607 - val_accuracy10: 0.5000 - val_accuracy20: 0.4467 - val_accuracy30: 0.4172 - val_accuracy50: 0.3911 - 34s/epoch - 22ms/step
Epoch 30/50
1532/1532 - 35s - loss: 11.3602 - accuracy10: 0.5542 - accuracy20: 0.5417 - accuracy30: 0.5240 - accuracy50: 0.4849 - val_loss: 13.1131 - val_accuracy10: 0.5009 - val_accuracy20: 0.4476 - val_accuracy30: 0.4174 - val_accuracy50: 0.3899 - 35s/epoch - 23ms/step
Epoch 31/50
1532/1532 - 35s - loss: 11.3546 - accuracy10: 0.5545 - accuracy20: 0.5423 - accuracy30: 0.5237 - accuracy50: 0.4847 - val_loss: 13.1989 - val_accuracy10: 0.4980 - val_accuracy20: 0.4463 - val_accuracy30: 0.4168 - val_accuracy50: 0.3905 - 35s/epoch - 23ms/step
Epoch 32/50
1532/1532 - 35s - loss: 11.3403 - accuracy10: 0.5558 - accuracy20: 0.5432 - accuracy30: 0.5249 - accuracy50: 0.4862 - val_loss: 13.0571 - val_accuracy10: 0.4917 - val_accuracy20: 0.4453 - val_accuracy30: 0.4195 - val_accuracy50: 0.3935 - 35s/epoch - 23ms/step
Epoch 33/50
1532/1532 - 32s - loss: 11.3322 - accuracy10: 0.5562 - accuracy20: 0.5438 - accuracy30: 0.5255 - accuracy50: 0.4865 - val_loss: 13.0556 - val_accuracy10: 0.4883 - val_accuracy20: 0.4510 - val_accuracy30: 0.4256 - val_accuracy50: 0.3986 - 32s/epoch - 21ms/step
Epoch 34/50
1532/1532 - 35s - loss: 11.3362 - accuracy10: 0.5558 - accuracy20: 0.5431 - accuracy30: 0.5251 - accuracy50: 0.4868 - val_loss: 13.0339 - val_accuracy10: 0.4942 - val_accuracy20: 0.4487 - val_accuracy30: 0.4211 - val_accuracy50: 0.3928 - 35s/epoch - 23ms/step
Epoch 35/50
1532/1532 - 34s - loss: 11.3150 - accuracy10: 0.5573 - accuracy20: 0.5446 - accuracy30: 0.5269 - accuracy50: 0.4880 - val_loss: 13.0808 - val_accuracy10: 0.4860 - val_accuracy20: 0.4504 - val_accuracy30: 0.4258 - val_accuracy50: 0.3992 - 34s/epoch - 22ms/step
Epoch 36/50
1532/1532 - 33s - loss: 11.3058 - accuracy10: 0.5569 - accuracy20: 0.5450 - accuracy30: 0.5273 - accuracy50: 0.4880 - val_loss: 12.9877 - val_accuracy10: 0.4948 - val_accuracy20: 0.4506 - val_accuracy30: 0.4244 - val_accuracy50: 0.3975 - 33s/epoch - 22ms/step
Epoch 37/50
1532/1532 - 32s - loss: 11.2911 - accuracy10: 0.5574 - accuracy20: 0.5467 - accuracy30: 0.5278 - accuracy50: 0.4891 - val_loss: 13.0500 - val_accuracy10: 0.4888 - val_accuracy20: 0.4499 - val_accuracy30: 0.4238 - val_accuracy50: 0.3974 - 32s/epoch - 21ms/step
Epoch 38/50
1532/1532 - 32s - loss: 11.2811 - accuracy10: 0.5585 - accuracy20: 0.5468 - accuracy30: 0.5284 - accuracy50: 0.4905 - val_loss: 13.0324 - val_accuracy10: 0.4896 - val_accuracy20: 0.4539 - val_accuracy30: 0.4294 - val_accuracy50: 0.4012 - 32s/epoch - 21ms/step
Epoch 39/50
1532/1532 - 32s - loss: 11.2759 - accuracy10: 0.5590 - accuracy20: 0.5476 - accuracy30: 0.5289 - accuracy50: 0.4903 - val_loss: 13.0313 - val_accuracy10: 0.4891 - val_accuracy20: 0.4532 - val_accuracy30: 0.4285 - val_accuracy50: 0.4000 - 32s/epoch - 21ms/step
Epoch 40/50
1532/1532 - 32s - loss: 11.2655 - accuracy10: 0.5598 - accuracy20: 0.5476 - accuracy30: 0.5293 - accuracy50: 0.4910 - val_loss: 12.9148 - val_accuracy10: 0.4809 - val_accuracy20: 0.4535 - val_accuracy30: 0.4297 - val_accuracy50: 0.4019 - 32s/epoch - 21ms/step
Epoch 41/50
1532/1532 - 33s - loss: 11.2568 - accuracy10: 0.5601 - accuracy20: 0.5486 - accuracy30: 0.5302 - accuracy50: 0.4917 - val_loss: 12.9854 - val_accuracy10: 0.4855 - val_accuracy20: 0.4525 - val_accuracy30: 0.4282 - val_accuracy50: 0.3995 - 33s/epoch - 21ms/step
Epoch 42/50
1532/1532 - 37s - loss: 11.2510 - accuracy10: 0.5601 - accuracy20: 0.5486 - accuracy30: 0.5306 - accuracy50: 0.4922 - val_loss: 12.9548 - val_accuracy10: 0.4951 - val_accuracy20: 0.4549 - val_accuracy30: 0.4280 - val_accuracy50: 0.3988 - 37s/epoch - 24ms/step
Epoch 43/50
1532/1532 - 33s - loss: 11.2379 - accuracy10: 0.5608 - accuracy20: 0.5501 - accuracy30: 0.5314 - accuracy50: 0.4929 - val_loss: 12.9834 - val_accuracy10: 0.4883 - val_accuracy20: 0.4550 - val_accuracy30: 0.4318 - val_accuracy50: 0.4028 - 33s/epoch - 22ms/step
Epoch 44/50
1532/1532 - 33s - loss: 11.2307 - accuracy10: 0.5609 - accuracy20: 0.5501 - accuracy30: 0.5322 - accuracy50: 0.4935 - val_loss: 12.9630 - val_accuracy10: 0.4873 - val_accuracy20: 0.4544 - val_accuracy30: 0.4308 - val_accuracy50: 0.4028 - 33s/epoch - 22ms/step
Epoch 45/50
1532/1532 - 34s - loss: 11.2250 - accuracy10: 0.5614 - accuracy20: 0.5506 - accuracy30: 0.5329 - accuracy50: 0.4935 - val_loss: 12.8672 - val_accuracy10: 0.4858 - val_accuracy20: 0.4572 - val_accuracy30: 0.4350 - val_accuracy50: 0.4066 - 34s/epoch - 22ms/step
Epoch 46/50
1532/1532 - 36s - loss: 11.2075 - accuracy10: 0.5621 - accuracy20: 0.5519 - accuracy30: 0.5340 - accuracy50: 0.4953 - val_loss: 13.1532 - val_accuracy10: 0.4893 - val_accuracy20: 0.4485 - val_accuracy30: 0.4248 - val_accuracy50: 0.3963 - 36s/epoch - 23ms/step
Epoch 47/50
1532/1532 - 35s - loss: 11.2004 - accuracy10: 0.5617 - accuracy20: 0.5517 - accuracy30: 0.5339 - accuracy50: 0.4951 - val_loss: 13.1159 - val_accuracy10: 0.4904 - val_accuracy20: 0.4482 - val_accuracy30: 0.4233 - val_accuracy50: 0.3975 - 35s/epoch - 23ms/step
Epoch 48/50
1532/1532 - 36s - loss: 11.1938 - accuracy10: 0.5624 - accuracy20: 0.5528 - accuracy30: 0.5354 - accuracy50: 0.4967 - val_loss: 12.9694 - val_accuracy10: 0.4787 - val_accuracy20: 0.4512 - val_accuracy30: 0.4282 - val_accuracy50: 0.4007 - 36s/epoch - 24ms/step
Epoch 49/50
1532/1532 - 34s - loss: 11.1892 - accuracy10: 0.5636 - accuracy20: 0.5537 - accuracy30: 0.5351 - accuracy50: 0.4967 - val_loss: 13.0789 - val_accuracy10: 0.4855 - val_accuracy20: 0.4511 - val_accuracy30: 0.4289 - val_accuracy50: 0.4008 - 34s/epoch - 22ms/step
Epoch 50/50
1532/1532 - 36s - loss: 11.1778 - accuracy10: 0.5633 - accuracy20: 0.5533 - accuracy30: 0.5359 - accuracy50: 0.4982 - val_loss: 12.9949 - val_accuracy10: 0.4851 - val_accuracy20: 0.4523 - val_accuracy30: 0.4282 - val_accuracy50: 0.4006 - 36s/epoch - 23ms/step
testing model: results/WBA/W8/deepLOB_L1/seq2seq
Evaluating performance on  test set...
3755/3755 - 37s - 37s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1300604
{'0': {'precision': 0.5519803622371127, 'recall': 0.03629906590985441, 'f1-score': 0.06811855248075978, 'support': 229207}, '1': {'precision': 0.5525327989405898, 'recall': 0.9226035211171142, 'f1-score': 0.6911479283695512, 'support': 511031}, '2': {'precision': 0.4001185536455246, 'recall': 0.1680434536607446, 'f1-score': 0.23668356125083678, 'support': 220925}, 'accuracy': 0.5378109644253888, 'macro avg': {'precision': 0.5015439049410757, 'recall': 0.37564868022923775, 'f1-score': 0.33198334736704926, 'support': 961163}, 'weighted avg': {'precision': 0.517368378856477, 'recall': 0.5378109644253888, 'f1-score': 0.4381156804937547, 'support': 961163}}
[[  8320 201383  19504]
 [  3396 471479  36156]
 [  3357 180443  37125]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.3391609
{'0': {'precision': 0.5851846456406148, 'recall': 0.027943375882577996, 'f1-score': 0.0533397070100485, 'support': 287510}, '1': {'precision': 0.43368721021220935, 'recall': 0.9296764098391438, 'f1-score': 0.5914618266960272, 'support': 399425}, '2': {'precision': 0.44333581860444715, 'recall': 0.14744665023265313, 'f1-score': 0.2212942489984457, 'support': 274228}, 'accuracy': 0.43676670866439926, 'macro avg': {'precision': 0.4874025581524237, 'recall': 0.3683554786514583, 'f1-score': 0.2886985942348405, 'support': 961163}, 'weighted avg': {'precision': 0.481757044613042, 'recall': 0.43676670866439926, 'f1-score': 0.32488289562214256, 'support': 961163}}
[[  8034 254788  24688]
 [  2007 371336  26082]
 [  3688 230106  40434]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.387502
{'0': {'precision': 0.562914979757085, 'recall': 0.02274913774485101, 'f1-score': 0.04373097149183504, 'support': 305594}, '1': {'precision': 0.39347738913186564, 'recall': 0.925918997287438, 'f1-score': 0.5522649498669655, 'support': 363494}, '2': {'precision': 0.43808453718566076, 'recall': 0.14016605323975007, 'f1-score': 0.21238052007003436, 'support': 292075}, 'accuracy': 0.39999146866868573, 'macro avg': {'precision': 0.4648256353582038, 'recall': 0.36294472942401307, 'f1-score': 0.2694588138096116, 'support': 961163}, 'weighted avg': {'precision': 0.46090377137643346, 'recall': 0.39999146866868573, 'f1-score': 0.28729774095390054, 'support': 961163}}
[[  6952 271142  27500]
 [  1917 336566  25011]
 [  3481 247655  40939]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.39279
{'0': {'precision': 0.5191609153650563, 'recall': 0.018386361224299458, 'f1-score': 0.03551494180755337, 'support': 310937}, '1': {'precision': 0.38022734407579384, 'recall': 0.9125909515187638, 'f1-score': 0.5367993861256457, 'support': 355684}, '2': {'precision': 0.4018057988742264, 'recall': 0.13159753108215466, 'f1-score': 0.1982614210926091, 'support': 294542}, 'accuracy': 0.38398481839188564, 'macro avg': {'precision': 0.43373135277169217, 'recall': 0.3541916146084059, 'f1-score': 0.2568585830086027, 'support': 961163}, 'weighted avg': {'precision': 0.43178503937743296, 'recall': 0.38398481839188564, 'f1-score': 0.27089076234414833, 'support': 961163}}
[[  5717 276283  28937]
 [  2321 324594  28769]
 [  2974 252807  38761]]
Evaluating performance on  train set...
1532/1532 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0075023
{'0': {'precision': 0.42844986079739455, 'recall': 0.39774123705307507, 'f1-score': 0.41252484586711446, 'support': 102534}, '1': {'precision': 0.6246495591901984, 'recall': 0.5576263605188609, 'f1-score': 0.5892381879462754, 'support': 187796}, '2': {'precision': 0.3918438345574024, 'recall': 0.4976387075237357, 'f1-score': 0.4384496606848587, 'support': 101851}, 'accuracy': 0.5002460598550159, 'macro avg': {'precision': 0.48164775151499845, 'recall': 0.4843354350318905, 'f1-score': 0.48007089816608284, 'support': 392181}, 'weighted avg': {'precision': 0.5128934166575855, 'recall': 0.5002460598550159, 'f1-score': 0.5038768672631029, 'support': 392181}}
[[ 40782  32581  29171]
 [ 33582 104720  49494]
 [ 20821  30345  50685]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0470392
{'0': {'precision': 0.4732292767862695, 'recall': 0.3665291312794002, 'f1-score': 0.41310051569709577, 'support': 124574}, '1': {'precision': 0.5005813849483909, 'recall': 0.5829305891175736, 'f1-score': 0.538626630094798, 'support': 144012}, '2': {'precision': 0.44509031814488403, 'recall': 0.46092479469234193, 'f1-score': 0.4528691864047029, 'support': 123595}, 'accuracy': 0.47574206807570996, 'macro avg': {'precision': 0.4729669932931815, 'recall': 0.47012817169643856, 'f1-score': 0.4681987773988656, 'support': 392181}, 'weighted avg': {'precision': 0.47440525728344146, 'recall': 0.47574206807570996, 'f1-score': 0.4717277200816749, 'support': 392181}}
[[45660 43729 35185]
 [24224 83949 35839]
 [26602 40025 56968]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0699462
{'0': {'precision': 0.46714830254853984, 'recall': 0.33919666956402394, 'f1-score': 0.3930207390065596, 'support': 131154}, '1': {'precision': 0.4438781743607645, 'recall': 0.5828081673808924, 'f1-score': 0.5039432489200649, 'support': 130911}, '2': {'precision': 0.4495422380362212, 'recall': 0.43209136462848535, 'f1-score': 0.4406440918406935, 'support': 130116}, 'accuracy': 0.451334970332576, 'macro avg': {'precision': 0.4535229049818419, 'recall': 0.4513654005244672, 'f1-score': 0.4458693599224393, 'support': 392181}, 'weighted avg': {'precision': 0.45353941675021014, 'recall': 0.451334970332576, 'f1-score': 0.44584720656274685, 'support': 392181}}
[[44487 50178 36489]
 [22261 76296 32354]
 [28483 45411 56222]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1028787
{'0': {'precision': 0.4380568910691223, 'recall': 0.3062954362640198, 'f1-score': 0.36051429311492106, 'support': 131778}, '1': {'precision': 0.4011326175131946, 'recall': 0.5635389444710758, 'f1-score': 0.4686649026977151, 'support': 129338}, '2': {'precision': 0.4313359304359583, 'recall': 0.38944798382481977, 'f1-score': 0.4093231008572506, 'support': 131065}, 'accuracy': 0.4189213653899602, 'macro avg': {'precision': 0.4235084796727584, 'recall': 0.4197607881866385, 'f1-score': 0.4128340988899623, 'support': 392181}, 'weighted avg': {'precision': 0.4236334631147792, 'recall': 0.4189213653899602, 'f1-score': 0.41249312413673966, 'support': 392181}}
[[40363 56669 34746]
 [23903 72887 32548]
 [27875 52147 51043]]
Evaluating performance on  val set...
467/467 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0249364
{'0': {'precision': 0.4062602640740984, 'recall': 0.40587366694011484, 'f1-score': 0.40606687349189935, 'support': 30475}, '1': {'precision': 0.6013986013986014, 'recall': 0.5450403384662819, 'f1-score': 0.5718342004295046, 'support': 58381}, '2': {'precision': 0.383545674077775, 'recall': 0.45264847512038525, 'f1-score': 0.4152417585719867, 'support': 30527}, 'accuracy': 0.4858899508305203, 'macro avg': {'precision': 0.4637348465168249, 'recall': 0.46785416017559395, 'f1-score': 0.46438094416446357, 'support': 119383}, 'weighted avg': {'precision': 0.49587907900188577, 'recall': 0.4858899508305203, 'f1-score': 0.4894769405096838, 'support': 119383}}
[[12369 10654  7452]
 [11804 31820 14757]
 [ 6273 10436 13818]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0609095
{'0': {'precision': 0.45589223434550286, 'recall': 0.3772006459640484, 'f1-score': 0.41282994813548524, 'support': 37773}, '1': {'precision': 0.4724840201931013, 'recall': 0.5574427610571371, 'f1-score': 0.5114592640305858, 'support': 44157}, '2': {'precision': 0.44070712957566677, 'recall': 0.42399807759058017, 'f1-score': 0.4321911656642082, 'support': 37453}, 'accuracy': 0.4585493747015907, 'macro avg': {'precision': 0.4563611280380903, 'recall': 0.4528804948705886, 'f1-score': 0.4521601259434264, 'support': 119383}, 'weighted avg': {'precision': 0.45726525863478806, 'recall': 0.4585493747015907, 'f1-score': 0.45538467018203466, 'support': 119383}}
[[14248 14108  9417]
 [ 8806 24615 10736]
 [ 8199 13374 15880]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0778204
{'0': {'precision': 0.4529283329052145, 'recall': 0.3542352025313277, 'f1-score': 0.3975480870851828, 'support': 39821}, '1': {'precision': 0.4170132035337179, 'recall': 0.545456824163429, 'f1-score': 0.47266448011468537, 'support': 39895}, '2': {'precision': 0.4461116041712891, 'recall': 0.40550079411097384, 'f1-score': 0.42483789601574157, 'support': 39667}, 'accuracy': 0.4351708367187958, 'macro avg': {'precision': 0.4386843802034072, 'recall': 0.43506427360191013, 'f1-score': 0.43168348773853654, 'support': 119383}, 'weighted avg': {'precision': 0.4386613663776145, 'recall': 0.4351708367187958, 'f1-score': 0.43171772054020136, 'support': 119383}}
[[14106 15688 10027]
 [ 8190 21761  9944]
 [ 8848 14734 16085]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1015737
{'0': {'precision': 0.42613860086625543, 'recall': 0.3261262618653006, 'f1-score': 0.3694841958519446, 'support': 39822}, '1': {'precision': 0.38211035530925064, 'recall': 0.5223869251235271, 'f1-score': 0.44137104198334365, 'support': 39465}, '2': {'precision': 0.42538765234307946, 'recall': 0.37083499600957703, 'f1-score': 0.39624250499666896, 'support': 40096}, 'accuracy': 0.4060209577578047, 'macro avg': {'precision': 0.4112122028395285, 'recall': 0.4064493943328016, 'f1-score': 0.40236591427731905, 'support': 119383}, 'weighted avg': {'precision': 0.41133176285001816, 'recall': 0.4060209577578047, 'f1-score': 0.40223522025275993, 'support': 119383}}
[[12987 16986  9849]
 [ 8613 20616 10236]
 [ 8876 16351 14869]]
training model: results/WBA/W8/deepOF_L1/seq2seq
Epoch 1/50
1532/1532 - 40s - loss: 12.7388 - accuracy10: 0.4377 - accuracy20: 0.4380 - accuracy30: 0.4317 - accuracy50: 0.4160 - val_loss: 15.2813 - val_accuracy10: 0.4934 - val_accuracy20: 0.3777 - val_accuracy30: 0.3395 - val_accuracy50: 0.3328 - 40s/epoch - 26ms/step
Epoch 2/50
1532/1532 - 32s - loss: 12.7414 - accuracy10: 0.4301 - accuracy20: 0.4332 - accuracy30: 0.4288 - accuracy50: 0.4150 - val_loss: 14.7944 - val_accuracy10: 0.4925 - val_accuracy20: 0.3768 - val_accuracy30: 0.3398 - val_accuracy50: 0.3337 - 32s/epoch - 21ms/step
Epoch 3/50
1532/1532 - 30s - loss: 12.7228 - accuracy10: 0.4294 - accuracy20: 0.4325 - accuracy30: 0.4280 - accuracy50: 0.4158 - val_loss: 13.5423 - val_accuracy10: 0.5014 - val_accuracy20: 0.3876 - val_accuracy30: 0.3482 - val_accuracy50: 0.3384 - 30s/epoch - 20ms/step
Epoch 4/50
1532/1532 - 29s - loss: 12.7403 - accuracy10: 0.4307 - accuracy20: 0.4301 - accuracy30: 0.4241 - accuracy50: 0.4112 - val_loss: 13.1925 - val_accuracy10: 0.5076 - val_accuracy20: 0.4015 - val_accuracy30: 0.3597 - val_accuracy50: 0.3444 - 29s/epoch - 19ms/step
Epoch 5/50
1532/1532 - 32s - loss: 12.7086 - accuracy10: 0.4376 - accuracy20: 0.4342 - accuracy30: 0.4272 - accuracy50: 0.4142 - val_loss: 13.2955 - val_accuracy10: 0.5057 - val_accuracy20: 0.3974 - val_accuracy30: 0.3562 - val_accuracy50: 0.3423 - 32s/epoch - 21ms/step
Epoch 6/50
1532/1532 - 30s - loss: 12.6833 - accuracy10: 0.4495 - accuracy20: 0.4384 - accuracy30: 0.4287 - accuracy50: 0.4144 - val_loss: 13.3754 - val_accuracy10: 0.5076 - val_accuracy20: 0.3959 - val_accuracy30: 0.3544 - val_accuracy50: 0.3417 - 30s/epoch - 20ms/step
Epoch 7/50
1532/1532 - 34s - loss: 12.6584 - accuracy10: 0.4577 - accuracy20: 0.4427 - accuracy30: 0.4318 - accuracy50: 0.4168 - val_loss: 13.6824 - val_accuracy10: 0.5041 - val_accuracy20: 0.3912 - val_accuracy30: 0.3520 - val_accuracy50: 0.3413 - 34s/epoch - 22ms/step
Epoch 8/50
1532/1532 - 31s - loss: 12.6299 - accuracy10: 0.4567 - accuracy20: 0.4455 - accuracy30: 0.4371 - accuracy50: 0.4215 - val_loss: 13.6028 - val_accuracy10: 0.5058 - val_accuracy20: 0.3934 - val_accuracy30: 0.3538 - val_accuracy50: 0.3421 - 31s/epoch - 20ms/step
Epoch 9/50
1532/1532 - 34s - loss: 12.6132 - accuracy10: 0.4614 - accuracy20: 0.4474 - accuracy30: 0.4371 - accuracy50: 0.4214 - val_loss: 13.6308 - val_accuracy10: 0.5062 - val_accuracy20: 0.3947 - val_accuracy30: 0.3554 - val_accuracy50: 0.3437 - 34s/epoch - 22ms/step
Epoch 10/50
1532/1532 - 30s - loss: 12.6023 - accuracy10: 0.4659 - accuracy20: 0.4487 - accuracy30: 0.4379 - accuracy50: 0.4221 - val_loss: 13.7233 - val_accuracy10: 0.5048 - val_accuracy20: 0.3932 - val_accuracy30: 0.3546 - val_accuracy50: 0.3436 - 30s/epoch - 20ms/step
Epoch 11/50
1532/1532 - 32s - loss: 12.5800 - accuracy10: 0.4679 - accuracy20: 0.4507 - accuracy30: 0.4398 - accuracy50: 0.4227 - val_loss: 14.1501 - val_accuracy10: 0.5028 - val_accuracy20: 0.3903 - val_accuracy30: 0.3521 - val_accuracy50: 0.3423 - 32s/epoch - 21ms/step
Epoch 12/50
1532/1532 - 30s - loss: 12.5652 - accuracy10: 0.4701 - accuracy20: 0.4530 - accuracy30: 0.4410 - accuracy50: 0.4243 - val_loss: 13.8953 - val_accuracy10: 0.5053 - val_accuracy20: 0.3948 - val_accuracy30: 0.3566 - val_accuracy50: 0.3453 - 30s/epoch - 20ms/step
Epoch 13/50
1532/1532 - 32s - loss: 12.5395 - accuracy10: 0.4736 - accuracy20: 0.4555 - accuracy30: 0.4445 - accuracy50: 0.4264 - val_loss: 14.0245 - val_accuracy10: 0.5045 - val_accuracy20: 0.3925 - val_accuracy30: 0.3544 - val_accuracy50: 0.3443 - 32s/epoch - 21ms/step
Epoch 14/50
1532/1532 - 31s - loss: 12.5235 - accuracy10: 0.4743 - accuracy20: 0.4568 - accuracy30: 0.4455 - accuracy50: 0.4269 - val_loss: 14.4098 - val_accuracy10: 0.5022 - val_accuracy20: 0.3896 - val_accuracy30: 0.3519 - val_accuracy50: 0.3428 - 31s/epoch - 20ms/step
testing model: results/WBA/W8/deepOF_L1/seq2seq
Evaluating performance on  test set...
3755/3755 - 36s - 36s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.99111
{'0': {'precision': 0.4240193581253184, 'recall': 0.14525797753985498, 'f1-score': 0.21638730559003788, 'support': 229206}, '1': {'precision': 0.5481589129684463, 'recall': 0.8857305554087929, 'f1-score': 0.6772085424203524, 'support': 511029}, '2': {'precision': 0.5086550796970283, 'recall': 0.13101397319428035, 'f1-score': 0.2083606285948759, 'support': 220923}, 'accuracy': 0.5356788374023834, 'macro avg': {'precision': 0.4936111169302643, 'recall': 0.3873341687143094, 'f1-score': 0.3673188255350887, 'support': 961158}, 'weighted avg': {'precision': 0.5094755371184867, 'recall': 0.5356788374023834, 'f1-score': 0.4595520488209705, 'support': 961158}}
[[ 33294 189252   6660]
 [ 37096 452634  21299]
 [  8130 183849  28944]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0592979
{'0': {'precision': 0.49862430396331475, 'recall': 0.10589581543534289, 'f1-score': 0.17469138104650728, 'support': 287509}, '1': {'precision': 0.42657558416450225, 'recall': 0.9103584161192116, 'f1-score': 0.58093619142413, 'support': 399424}, '2': {'precision': 0.5722254844392249, 'recall': 0.0995022335673261, 'f1-score': 0.16952617043947202, 'support': 274225}, 'accuracy': 0.43837849760393194, 'macro avg': {'precision': 0.4991417908556806, 'recall': 0.37191882170729357, 'f1-score': 0.30838458097003646, 'support': 961158}, 'weighted avg': {'precision': 0.4896822734741398, 'recall': 0.43837849760393194, 'f1-score': 0.3420389943021399, 'support': 961158}}
[[ 30446 250078   6985]
 [ 22392 363619  13413]
 [  8222 238717  27286]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0804645
{'0': {'precision': 0.5250545674081643, 'recall': 0.07399408361475432, 'f1-score': 0.1297087690516208, 'support': 305592}, '1': {'precision': 0.3859458869587161, 'recall': 0.9340511810373762, 'f1-score': 0.5462030488864293, 'support': 363494}, '2': {'precision': 0.5937255719422586, 'recall': 0.07801500999753486, 'f1-score': 0.13790891208957484, 'support': 292072}, 'accuracy': 0.40047526005089695, 'macro avg': {'precision': 0.5015753421030463, 'recall': 0.3620200915498885, 'f1-score': 0.271273576675875, 'support': 961158}, 'weighted avg': {'precision': 0.49331338327921803, 'recall': 0.40047526005089695, 'f1-score': 0.2897118111442374, 'support': 961158}}
[[ 22612 277009   5971]
 [ 14351 339522   9621]
 [  6103 263183  22786]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0878842
{'0': {'precision': 0.5288844251013651, 'recall': 0.04572659880682458, 'f1-score': 0.08417550278552356, 'support': 310935}, '1': {'precision': 0.37411191622851586, 'recall': 0.9522271235903881, 'f1-score': 0.5371771518386554, 'support': 355683}, '2': {'precision': 0.5646002417544466, 'recall': 0.055503496978339104, 'f1-score': 0.1010711139275723, 'support': 294540}, 'accuracy': 0.3841792920622832, 'macro avg': {'precision': 0.4891988610281091, 'recall': 0.35115240645851725, 'f1-score': 0.24080792285058375, 'support': 961158}, 'weighted avg': {'precision': 0.48255467116244666, 'recall': 0.3841792920622832, 'f1-score': 0.256989357371288, 'support': 961158}}
[[ 14218 292152   4565]
 [  8950 338691   8042]
 [  3715 274477  16348]]
Evaluating performance on  train set...
1532/1532 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0244138
{'0': {'precision': 0.4721244968463757, 'recall': 0.14532682926829268, 'f1-score': 0.22224377289240663, 'support': 102500}, '1': {'precision': 0.4946121798546979, 'recall': 0.8958251238085095, 'f1-score': 0.6373333282819577, 'support': 187790}, '2': {'precision': 0.5138970157987127, 'recall': 0.1034371074120603, 'f1-score': 0.17221151018007128, 'support': 101888}, 'accuracy': 0.49381148356103605, 'macro avg': {'precision': 0.4935445641665955, 'recall': 0.3815296868296209, 'f1-score': 0.34392953711814517, 'support': 392178}, 'weighted avg': {'precision': 0.49374498653001053, 'recall': 0.49381148356103605, 'f1-score': 0.4080063103712284, 'support': 392178}}
[[ 14896  84828   2776]
 [ 12370 168227   7193]
 [  4285  87064  10539]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0880187
{'0': {'precision': 0.5425986842105263, 'recall': 0.10602518057865516, 'f1-score': 0.17738824177818402, 'support': 124461}, '1': {'precision': 0.3776249084541359, 'recall': 0.9195087256704715, 'f1-score': 0.5353795310202168, 'support': 144115}, '2': {'precision': 0.5809574405288944, 'recall': 0.0796265432598178, 'f1-score': 0.1400567797755847, 'support': 123602}, 'accuracy': 0.39663877117023394, 'macro avg': {'precision': 0.5003936777311856, 'recall': 0.3683868165029815, 'f1-score': 0.2842748508579952, 'support': 392178}, 'weighted avg': {'precision': 0.49406465962304497, 'recall': 0.39663877117023394, 'f1-score': 0.2971748470509691, 'support': 392178}}
[[ 13196 108550   2715]
 [  7216 132515   4384]
 [  3908 109852   9842]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1062082
{'0': {'precision': 0.5731359257937924, 'recall': 0.07351449468795046, 'f1-score': 0.13031398925203636, 'support': 131117}, '1': {'precision': 0.34026879759496886, 'recall': 0.9403042057359274, 'f1-score': 0.4997078348942524, 'support': 130964}, '2': {'precision': 0.5876449598572703, 'recall': 0.06076235424337225, 'f1-score': 0.11013660840549218, 'support': 130097}, 'accuracy': 0.3587401639051655, 'macro avg': {'precision': 0.5003498944153438, 'recall': 0.3581936848890834, 'f1-score': 0.2467194775172603, 'support': 392178}, 'weighted avg': {'precision': 0.5001853044614524, 'recall': 0.3587401639051655, 'f1-score': 0.24697601232496325, 'support': 392178}}
[[  9639 119258   2220]
 [  4491 123146   3327]
 [  2688 119504   7905]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.110356
{'0': {'precision': 0.5774607153186156, 'recall': 0.045466966237551615, 'f1-score': 0.08429674141728294, 'support': 131744}, '1': {'precision': 0.333161281997516, 'recall': 0.9572249513393271, 'f1-score': 0.49428656895004486, 'support': 129468}, '2': {'precision': 0.5581797821439479, 'recall': 0.04186582777209352, 'f1-score': 0.07788960785288625, 'support': 130966}, 'accuracy': 0.345259040537715, 'macro avg': {'precision': 0.48960059315335985, 'recall': 0.3481859151163241, 'f1-score': 0.21882430607340467, 'support': 392178}, 'weighted avg': {'precision': 0.49037243977187506, 'recall': 0.345259040537715, 'f1-score': 0.21750524963706283, 'support': 392178}}
[[  5990 124110   1644]
 [  2842 123930   2696]
 [  1541 123942   5483]]
Evaluating performance on  val set...
467/467 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0144985
{'0': {'precision': 0.4765055511943479, 'recall': 0.1393891677328347, 'f1-score': 0.21568527918781724, 'support': 30483}, '1': {'precision': 0.5066116334174119, 'recall': 0.908863406523714, 'f1-score': 0.6505812705131745, 'support': 58341}, '2': {'precision': 0.5501551189245087, 'recall': 0.10445367976700809, 'f1-score': 0.17557272902285417, 'support': 30559}, 'accuracy': 0.5064791469472203, 'macro avg': {'precision': 0.5110907678454228, 'recall': 0.38423541800785227, 'f1-score': 0.3472797595746153, 'support': 119383}, 'weighted avg': {'precision': 0.5100704313133075, 'recall': 0.5064791469472203, 'f1-score': 0.41794579877118804, 'support': 119383}}
[[ 4249 25537   697]
 [ 3404 53024  1913]
 [ 1264 26103  3192]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0838296
{'0': {'precision': 0.5448997384481256, 'recall': 0.09941939075797343, 'f1-score': 0.16815766462635365, 'support': 37719}, '1': {'precision': 0.38218051748966414, 'recall': 0.9302367653377355, 'f1-score': 0.5417764197660943, 'support': 44221}, '2': {'precision': 0.6087135224003288, 'recall': 0.07910690916860294, 'f1-score': 0.14001749036847952, 'support': 37443}, 'accuracy': 0.400794082909627, 'macro avg': {'precision': 0.5119312594460396, 'recall': 0.3695876884214373, 'f1-score': 0.2833171915869758, 'support': 119383}, 'weighted avg': {'precision': 0.504640847672372, 'recall': 0.400794082909627, 'f1-score': 0.297725043786677, 'support': 119383}}
[[ 3750 33225   744]
 [ 1925 41136  1160]
 [ 1207 33274  2962]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1039239
{'0': {'precision': 0.5645229982964225, 'recall': 0.0665695703487934, 'f1-score': 0.11909521777218714, 'support': 39823}, '1': {'precision': 0.3417639312322984, 'recall': 0.9488630672142643, 'f1-score': 0.5025265587076752, 'support': 39932}, '2': {'precision': 0.6215650353310652, 'recall': 0.05993237105077218, 'f1-score': 0.10932357476581739, 'support': 39628}, 'accuracy': 0.3594816682442224, 'macro avg': {'precision': 0.5092839882865954, 'recall': 0.3584550028712766, 'f1-score': 0.24364845041522654, 'support': 119383}, 'weighted avg': {'precision': 0.5089476381329505, 'recall': 0.3594816682442224, 'f1-score': 0.24410421936520696, 'support': 119383}}
[[ 2651 36574   598]
 [ 1194 37890   848]
 [  851 36402  2375]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1082425
{'0': {'precision': 0.5444404462036704, 'recall': 0.03798453504719823, 'f1-score': 0.07101452676538922, 'support': 39832}, '1': {'precision': 0.3334533701055738, 'recall': 0.9626014198782962, 'f1-score': 0.4953227132177385, 'support': 39440}, '2': {'precision': 0.5967272727272728, 'recall': 0.04091147066889382, 'f1-score': 0.07657310842024219, 'support': 40111}, 'accuracy': 0.3444292738497106, 'macro avg': {'precision': 0.49154036301217235, 'recall': 0.34716580853146267, 'f1-score': 0.21430344946778998, 'support': 119383}, 'weighted avg': {'precision': 0.49230527299960686, 'recall': 0.3444292738497106, 'f1-score': 0.2130588307486906, 'support': 119383}}
[[ 1513 37903   416]
 [  782 37965   693]
 [  484 37986  1641]]
training model: results/WBA/W8/deepLOB_L2/seq2seq
Epoch 1/50
1532/1532 - 79s - loss: 12.3927 - accuracy10: 0.4670 - accuracy20: 0.4609 - accuracy30: 0.4500 - accuracy50: 0.4255 - val_loss: 12.9825 - val_accuracy10: 0.4447 - val_accuracy20: 0.4489 - val_accuracy30: 0.4421 - val_accuracy50: 0.4260 - 79s/epoch - 51ms/step
Epoch 2/50
1532/1532 - 70s - loss: 12.1880 - accuracy10: 0.4801 - accuracy20: 0.4828 - accuracy30: 0.4728 - accuracy50: 0.4435 - val_loss: 13.3664 - val_accuracy10: 0.4699 - val_accuracy20: 0.4300 - val_accuracy30: 0.4134 - val_accuracy50: 0.3974 - 70s/epoch - 46ms/step
Epoch 3/50
1532/1532 - 70s - loss: 11.9018 - accuracy10: 0.5120 - accuracy20: 0.5054 - accuracy30: 0.4906 - accuracy50: 0.4574 - val_loss: 13.2794 - val_accuracy10: 0.5000 - val_accuracy20: 0.4321 - val_accuracy30: 0.4089 - val_accuracy50: 0.3957 - 70s/epoch - 46ms/step
Epoch 4/50
1532/1532 - 70s - loss: 11.7665 - accuracy10: 0.5256 - accuracy20: 0.5151 - accuracy30: 0.4984 - accuracy50: 0.4632 - val_loss: 13.1562 - val_accuracy10: 0.5007 - val_accuracy20: 0.4464 - val_accuracy30: 0.4257 - val_accuracy50: 0.4082 - 70s/epoch - 45ms/step
Epoch 5/50
1532/1532 - 70s - loss: 11.6583 - accuracy10: 0.5376 - accuracy20: 0.5232 - accuracy30: 0.5043 - accuracy50: 0.4681 - val_loss: 13.1356 - val_accuracy10: 0.5112 - val_accuracy20: 0.4522 - val_accuracy30: 0.4276 - val_accuracy50: 0.4082 - 70s/epoch - 45ms/step
Epoch 6/50
1532/1532 - 72s - loss: 11.5762 - accuracy10: 0.5460 - accuracy20: 0.5296 - accuracy30: 0.5106 - accuracy50: 0.4729 - val_loss: 13.0677 - val_accuracy10: 0.5119 - val_accuracy20: 0.4486 - val_accuracy30: 0.4241 - val_accuracy50: 0.4057 - 72s/epoch - 47ms/step
Epoch 7/50
1532/1532 - 71s - loss: 11.5109 - accuracy10: 0.5509 - accuracy20: 0.5339 - accuracy30: 0.5141 - accuracy50: 0.4760 - val_loss: 13.0514 - val_accuracy10: 0.5222 - val_accuracy20: 0.4503 - val_accuracy30: 0.4220 - val_accuracy50: 0.4023 - 71s/epoch - 46ms/step
Epoch 8/50
1532/1532 - 70s - loss: 11.4620 - accuracy10: 0.5550 - accuracy20: 0.5370 - accuracy30: 0.5174 - accuracy50: 0.4787 - val_loss: 13.0559 - val_accuracy10: 0.5273 - val_accuracy20: 0.4564 - val_accuracy30: 0.4262 - val_accuracy50: 0.4052 - 70s/epoch - 46ms/step
Epoch 9/50
1532/1532 - 71s - loss: 11.4122 - accuracy10: 0.5583 - accuracy20: 0.5399 - accuracy30: 0.5205 - accuracy50: 0.4816 - val_loss: 12.9940 - val_accuracy10: 0.5292 - val_accuracy20: 0.4603 - val_accuracy30: 0.4297 - val_accuracy50: 0.4051 - 71s/epoch - 46ms/step
Epoch 10/50
1532/1532 - 70s - loss: 11.3671 - accuracy10: 0.5608 - accuracy20: 0.5426 - accuracy30: 0.5231 - accuracy50: 0.4837 - val_loss: 12.9703 - val_accuracy10: 0.5330 - val_accuracy20: 0.4657 - val_accuracy30: 0.4337 - val_accuracy50: 0.4067 - 70s/epoch - 46ms/step
Epoch 11/50
1532/1532 - 70s - loss: 11.3229 - accuracy10: 0.5629 - accuracy20: 0.5456 - accuracy30: 0.5259 - accuracy50: 0.4868 - val_loss: 12.8599 - val_accuracy10: 0.5242 - val_accuracy20: 0.4683 - val_accuracy30: 0.4396 - val_accuracy50: 0.4134 - 70s/epoch - 46ms/step
Epoch 12/50
1532/1532 - 71s - loss: 11.2880 - accuracy10: 0.5645 - accuracy20: 0.5473 - accuracy30: 0.5283 - accuracy50: 0.4883 - val_loss: 12.8480 - val_accuracy10: 0.5284 - val_accuracy20: 0.4716 - val_accuracy30: 0.4432 - val_accuracy50: 0.4163 - 71s/epoch - 46ms/step
Epoch 13/50
1532/1532 - 70s - loss: 11.2548 - accuracy10: 0.5661 - accuracy20: 0.5494 - accuracy30: 0.5305 - accuracy50: 0.4903 - val_loss: 12.9429 - val_accuracy10: 0.5232 - val_accuracy20: 0.4702 - val_accuracy30: 0.4414 - val_accuracy50: 0.4136 - 70s/epoch - 46ms/step
Epoch 14/50
1532/1532 - 70s - loss: 11.2253 - accuracy10: 0.5679 - accuracy20: 0.5519 - accuracy30: 0.5320 - accuracy50: 0.4922 - val_loss: 13.0536 - val_accuracy10: 0.5279 - val_accuracy20: 0.4673 - val_accuracy30: 0.4370 - val_accuracy50: 0.4087 - 70s/epoch - 45ms/step
Epoch 15/50
1532/1532 - 70s - loss: 11.1922 - accuracy10: 0.5696 - accuracy20: 0.5534 - accuracy30: 0.5337 - accuracy50: 0.4929 - val_loss: 12.7971 - val_accuracy10: 0.5183 - val_accuracy20: 0.4737 - val_accuracy30: 0.4483 - val_accuracy50: 0.4207 - 70s/epoch - 46ms/step
Epoch 16/50
1532/1532 - 70s - loss: 11.1705 - accuracy10: 0.5703 - accuracy20: 0.5545 - accuracy30: 0.5352 - accuracy50: 0.4944 - val_loss: 12.6512 - val_accuracy10: 0.5200 - val_accuracy20: 0.4819 - val_accuracy30: 0.4570 - val_accuracy50: 0.4276 - 70s/epoch - 46ms/step
Epoch 17/50
1532/1532 - 71s - loss: 11.1463 - accuracy10: 0.5713 - accuracy20: 0.5559 - accuracy30: 0.5367 - accuracy50: 0.4954 - val_loss: 12.7589 - val_accuracy10: 0.5149 - val_accuracy20: 0.4782 - val_accuracy30: 0.4540 - val_accuracy50: 0.4256 - 71s/epoch - 46ms/step
Epoch 18/50
1532/1532 - 70s - loss: 11.1194 - accuracy10: 0.5723 - accuracy20: 0.5575 - accuracy30: 0.5390 - accuracy50: 0.4977 - val_loss: 12.6999 - val_accuracy10: 0.5151 - val_accuracy20: 0.4771 - val_accuracy30: 0.4525 - val_accuracy50: 0.4239 - 70s/epoch - 46ms/step
Epoch 19/50
1532/1532 - 69s - loss: 11.0984 - accuracy10: 0.5735 - accuracy20: 0.5590 - accuracy30: 0.5401 - accuracy50: 0.4990 - val_loss: 12.7596 - val_accuracy10: 0.5059 - val_accuracy20: 0.4726 - val_accuracy30: 0.4499 - val_accuracy50: 0.4230 - 69s/epoch - 45ms/step
Epoch 20/50
1532/1532 - 69s - loss: 11.0785 - accuracy10: 0.5738 - accuracy20: 0.5593 - accuracy30: 0.5406 - accuracy50: 0.4994 - val_loss: 12.8634 - val_accuracy10: 0.5092 - val_accuracy20: 0.4708 - val_accuracy30: 0.4476 - val_accuracy50: 0.4184 - 69s/epoch - 45ms/step
Epoch 21/50
1532/1532 - 70s - loss: 11.0573 - accuracy10: 0.5747 - accuracy20: 0.5607 - accuracy30: 0.5426 - accuracy50: 0.5013 - val_loss: 12.8577 - val_accuracy10: 0.5111 - val_accuracy20: 0.4726 - val_accuracy30: 0.4475 - val_accuracy50: 0.4197 - 70s/epoch - 46ms/step
Epoch 22/50
1532/1532 - 70s - loss: 11.0386 - accuracy10: 0.5753 - accuracy20: 0.5616 - accuracy30: 0.5429 - accuracy50: 0.5017 - val_loss: 12.8335 - val_accuracy10: 0.5008 - val_accuracy20: 0.4728 - val_accuracy30: 0.4522 - val_accuracy50: 0.4248 - 70s/epoch - 45ms/step
Epoch 23/50
1532/1532 - 70s - loss: 11.0181 - accuracy10: 0.5764 - accuracy20: 0.5635 - accuracy30: 0.5446 - accuracy50: 0.5028 - val_loss: 12.9332 - val_accuracy10: 0.5006 - val_accuracy20: 0.4691 - val_accuracy30: 0.4482 - val_accuracy50: 0.4205 - 70s/epoch - 45ms/step
Epoch 24/50
1532/1532 - 70s - loss: 10.9972 - accuracy10: 0.5776 - accuracy20: 0.5645 - accuracy30: 0.5458 - accuracy50: 0.5044 - val_loss: 12.7650 - val_accuracy10: 0.4933 - val_accuracy20: 0.4747 - val_accuracy30: 0.4563 - val_accuracy50: 0.4282 - 70s/epoch - 46ms/step
Epoch 25/50
1532/1532 - 70s - loss: 10.9817 - accuracy10: 0.5782 - accuracy20: 0.5655 - accuracy30: 0.5469 - accuracy50: 0.5055 - val_loss: 13.0355 - val_accuracy10: 0.5040 - val_accuracy20: 0.4695 - val_accuracy30: 0.4450 - val_accuracy50: 0.4181 - 70s/epoch - 46ms/step
Epoch 26/50
1532/1532 - 70s - loss: 10.9621 - accuracy10: 0.5786 - accuracy20: 0.5667 - accuracy30: 0.5485 - accuracy50: 0.5068 - val_loss: 12.9853 - val_accuracy10: 0.4960 - val_accuracy20: 0.4662 - val_accuracy30: 0.4443 - val_accuracy50: 0.4178 - 70s/epoch - 46ms/step
testing model: results/WBA/W8/deepLOB_L2/seq2seq
Evaluating performance on  test set...
3755/3755 - 60s - 60s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9055235
{'0': {'precision': 0.4906718906887424, 'recall': 0.3048816135632856, 'f1-score': 0.3760824054291142, 'support': 229207}, '1': {'precision': 0.6242200926276543, 'recall': 0.8387005876355837, 'f1-score': 0.715737723259948, 'support': 511031}, '2': {'precision': 0.5023160061760165, 'recall': 0.3004096412809777, 'f1-score': 0.37597047435341835, 'support': 220925}, 'accuracy': 0.5876745151446737, 'macro avg': {'precision': 0.5390693298308045, 'recall': 0.4813306141599491, 'f1-score': 0.4892635343474936, 'support': 961163}, 'weighted avg': {'precision': 0.5643531990610686, 'recall': 0.5876745151446737, 'f1-score': 0.5566445664293929, 'support': 961163}}
[[ 69881 131733  27593]
 [ 44266 428602  38163]
 [ 28272 126285  66368]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0067719
{'0': {'precision': 0.542402156970131, 'recall': 0.26868630656325, 'f1-score': 0.3593591544709396, 'support': 287510}, '1': {'precision': 0.4984925324727267, 'recall': 0.8581135382111785, 'f1-score': 0.6306372941356134, 'support': 399425}, '2': {'precision': 0.5437925040407429, 'recall': 0.26009743716907097, 'f1-score': 0.3518865690492165, 'support': 274228}, 'accuracy': 0.5111807258498299, 'macro avg': {'precision': 0.5282290644945334, 'recall': 0.4622990939811665, 'f1-score': 0.4472943392185898, 'support': 961163}, 'weighted avg': {'precision': 0.5245515638153841, 'recall': 0.5111807258498299, 'f1-score': 0.4699606640801673, 'support': 961163}}
[[ 77250 176260  34000]
 [ 30835 342752  25838]
 [ 34337 168565  71326]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0437015
{'0': {'precision': 0.5367622746107793, 'recall': 0.24966785997107274, 'f1-score': 0.3408116818578764, 'support': 305594}, '1': {'precision': 0.44981257565400923, 'recall': 0.8454499936725228, 'f1-score': 0.5872076415181766, 'support': 363494}, '2': {'precision': 0.5289924969258749, 'recall': 0.24597449285286313, 'f1-score': 0.3358043964981327, 'support': 292075}, 'accuracy': 0.47385927256875265, 'macro avg': {'precision': 0.5051891157302212, 'recall': 0.4470307821654862, 'f1-score': 0.4212745732913952, 'support': 961163}, 'weighted avg': {'precision': 0.5015184588480932, 'recall': 0.47385927256875265, 'f1-score': 0.432472461652057, 'support': 961163}}
[[ 76297 191877  37420]
 [ 29630 307316  26548]
 [ 36216 184016  71843]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0738599
{'0': {'precision': 0.4963544044604934, 'recall': 0.23076057207730183, 'f1-score': 0.31505065917298763, 'support': 310937}, '1': {'precision': 0.4207792362964545, 'recall': 0.7920907322229844, 'f1-score': 0.5495978003134885, 'support': 355684}, '2': {'precision': 0.47489323504610614, 'recall': 0.2370935214672271, 'f1-score': 0.31628147121564154, 'support': 294542}, 'accuracy': 0.4404247770669491, 'macro avg': {'precision': 0.46400895860101804, 'recall': 0.41998160858917116, 'f1-score': 0.39364331023403915, 'support': 961163}, 'weighted avg': {'precision': 0.46181073821979285, 'recall': 0.4404247770669491, 'f1-score': 0.4022233772136168, 'support': 961163}}
[[ 71752 198881  40304]
 [ 37036 281734  36914]
 [ 35770 188938  69834]]
Evaluating performance on  train set...
1532/1532 - 24s - 24s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.95307803
{'0': {'precision': 0.46510385158298045, 'recall': 0.44988979265414397, 'f1-score': 0.4573703362186065, 'support': 102534}, '1': {'precision': 0.6490086828633651, 'recall': 0.6109555049095827, 'f1-score': 0.6294074567791519, 'support': 187796}, '2': {'precision': 0.43569732222757623, 'recall': 0.4971477943270071, 'f1-score': 0.46439855640697586, 'support': 101851}, 'accuracy': 0.5392892567462473, 'macro avg': {'precision': 0.516603285557974, 'recall': 0.5193310306302446, 'f1-score': 0.5170587831349115, 'support': 392181}, 'weighted avg': {'precision': 0.5455297449173181, 'recall': 0.5392892567462473, 'f1-score': 0.5415756249684281, 'support': 392181}}
[[ 46129  30817  25588]
 [ 33068 114735  39993]
 [ 19983  31233  50635]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9981805
{'0': {'precision': 0.5134531100339593, 'recall': 0.4260118483792766, 'f1-score': 0.4656631554009292, 'support': 124574}, '1': {'precision': 0.5205666708089971, 'recall': 0.6399327833791628, 'f1-score': 0.5741108750770917, 'support': 144012}, '2': {'precision': 0.4893637957562529, 'recall': 0.4426149925158785, 'f1-score': 0.4648169154102038, 'support': 123595}, 'accuracy': 0.5097977719471366, 'macro avg': {'precision': 0.5077945255330697, 'recall': 0.5028532080914393, 'f1-score': 0.501530315296075, 'support': 392181}, 'weighted avg': {'precision': 0.5084735707808635, 'recall': 0.5097977719471366, 'f1-score': 0.5052193347526821, 'support': 392181}}
[[53070 41912 29592]
 [24363 92158 27491]
 [25926 42964 54705]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0236622
{'0': {'precision': 0.5096598107161487, 'recall': 0.41716607957058116, 'f1-score': 0.45879768223860196, 'support': 131154}, '1': {'precision': 0.4657211067442934, 'recall': 0.6318262025345464, 'f1-score': 0.5362043090566686, 'support': 130911}, '2': {'precision': 0.49438107939231724, 'recall': 0.4074133849795567, 'f1-score': 0.446703715719444, 'support': 130116}, 'accuracy': 0.4855844622763469, 'macro avg': {'precision': 0.4899206656175865, 'recall': 0.4854685556948947, 'f1-score': 0.48056856900490486, 'support': 392181}, 'weighted avg': {'precision': 0.4899238544087518, 'recall': 0.4855844622763469, 'f1-score': 0.480623727803719, 'support': 392181}}
[[54713 46978 29463]
 [23445 82713 24753]
 [29194 47911 53011]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0623639
{'0': {'precision': 0.4708926966139094, 'recall': 0.39352547466193144, 'f1-score': 0.42874682209958453, 'support': 131778}, '1': {'precision': 0.42312421062043837, 'recall': 0.5853886715427794, 'f1-score': 0.4912026884999157, 'support': 129338}, '2': {'precision': 0.47056712828271074, 'recall': 0.3702208827680922, 'f1-score': 0.4144059509524684, 'support': 131065}, 'accuracy': 0.44901206330750343, 'macro avg': {'precision': 0.4548613451723528, 'recall': 0.4497116763242677, 'f1-score': 0.4447851538506562, 'support': 392181}, 'weighted avg': {'precision': 0.4550302477580186, 'recall': 0.44901206330750343, 'f1-score': 0.44455159227353297, 'support': 392181}}
[[51858 51339 28581]
 [27613 75713 26012]
 [30656 51886 48523]]
Evaluating performance on  val set...
467/467 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.98438305
{'0': {'precision': 0.44849411513707643, 'recall': 0.41388022969647253, 'f1-score': 0.430492508276733, 'support': 30475}, '1': {'precision': 0.6028596391007762, 'recall': 0.6146006406193796, 'f1-score': 0.6086735256448316, 'support': 58381}, '2': {'precision': 0.42328775754520825, 'recall': 0.44013496249222, 'f1-score': 0.4315469977035122, 'support': 30527}, 'accuracy': 0.5187505758776375, 'macro avg': {'precision': 0.49154717059435366, 'recall': 0.489538610936024, 'f1-score': 0.4902376772083589, 'support': 119383}, 'weighted avg': {'precision': 0.5175369367810106, 'recall': 0.5187505758776375, 'f1-score': 0.5178967146855036, 'support': 119383}}
[[12613 11519  6343]
 [10537 35881 11963]
 [ 4973 12118 13436]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0373834
{'0': {'precision': 0.503922173123694, 'recall': 0.3894580785216954, 'f1-score': 0.4393572857868172, 'support': 37773}, '1': {'precision': 0.4707973248429103, 'recall': 0.6329007858323709, 'f1-score': 0.5399447439092717, 'support': 44157}, '2': {'precision': 0.4787051153135035, 'recall': 0.3940405307986009, 'f1-score': 0.43226619021118307, 'support': 37453}, 'accuracy': 0.48093949724835194, 'macro avg': {'precision': 0.4844748710933693, 'recall': 0.4721331317175557, 'f1-score': 0.4705227399690906, 'support': 119383}, 'weighted avg': {'precision': 0.4837589305204789, 'recall': 0.48093949724835194, 'f1-score': 0.47433762290113834, 'support': 119383}}
[[14711 15324  7738]
 [ 7877 27947  8333]
 [ 6605 16090 14758]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0597647
{'0': {'precision': 0.4993378798914123, 'recall': 0.37876999573089576, 'f1-score': 0.430776700415554, 'support': 39821}, '1': {'precision': 0.42081669937072874, 'recall': 0.6235618498558717, 'f1-score': 0.5025098221409742, 'support': 39895}, '2': {'precision': 0.48355011476664117, 'recall': 0.3664507020949404, 'f1-score': 0.41693437356585594, 'support': 39667}, 'accuracy': 0.45648040340752033, 'macro avg': {'precision': 0.46790156467626076, 'recall': 0.456260849227236, 'f1-score': 0.4500736320407947, 'support': 119383}, 'weighted avg': {'precision': 0.46785219284989915, 'recall': 0.45648040340752033, 'f1-score': 0.4501488833234108, 'support': 119383}}
[[15083 16716  8022]
 [ 7515 24877  7503]
 [ 7608 17523 14536]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0858048
{'0': {'precision': 0.4638130286009426, 'recall': 0.36080558485259406, 'f1-score': 0.40587570621468927, 'support': 39822}, '1': {'precision': 0.3928237235653402, 'recall': 0.5850500443430888, 'f1-score': 0.4700433623093992, 'support': 39465}, '2': {'precision': 0.4585189685432699, 'recall': 0.338811851556265, 'f1-score': 0.3896793069818141, 'support': 40096}, 'accuracy': 0.4275483108985366, 'macro avg': {'precision': 0.4383852402365176, 'recall': 0.4282224935839826, 'f1-score': 0.4218661251686342, 'support': 119383}, 'weighted avg': {'precision': 0.4385676958877213, 'recall': 0.4275483108985366, 'f1-score': 0.42164818407281285, 'support': 119383}}
[[14368 17320  8134]
 [ 8467 23089  7909]
 [ 8143 18368 13585]]
training model: results/WBA/W8/deepOF_L2/seq2seq
Epoch 1/50
1532/1532 - 49s - loss: 12.1923 - accuracy10: 0.4915 - accuracy20: 0.4831 - accuracy30: 0.4687 - accuracy50: 0.4406 - val_loss: 13.3250 - val_accuracy10: 0.5493 - val_accuracy20: 0.4600 - val_accuracy30: 0.4156 - val_accuracy50: 0.3856 - 49s/epoch - 32ms/step
Epoch 2/50
1532/1532 - 42s - loss: 11.6338 - accuracy10: 0.5436 - accuracy20: 0.5277 - accuracy30: 0.5084 - accuracy50: 0.4713 - val_loss: 12.8182 - val_accuracy10: 0.5551 - val_accuracy20: 0.4825 - val_accuracy30: 0.4473 - val_accuracy50: 0.4142 - 42s/epoch - 27ms/step
Epoch 3/50
1532/1532 - 43s - loss: 11.4784 - accuracy10: 0.5531 - accuracy20: 0.5371 - accuracy30: 0.5175 - accuracy50: 0.4787 - val_loss: 13.0022 - val_accuracy10: 0.5580 - val_accuracy20: 0.4827 - val_accuracy30: 0.4475 - val_accuracy50: 0.4136 - 43s/epoch - 28ms/step
Epoch 4/50
1532/1532 - 41s - loss: 11.3931 - accuracy10: 0.5592 - accuracy20: 0.5425 - accuracy30: 0.5229 - accuracy50: 0.4828 - val_loss: 12.9729 - val_accuracy10: 0.5589 - val_accuracy20: 0.4862 - val_accuracy30: 0.4510 - val_accuracy50: 0.4166 - 41s/epoch - 27ms/step
Epoch 5/50
1532/1532 - 41s - loss: 11.3318 - accuracy10: 0.5629 - accuracy20: 0.5457 - accuracy30: 0.5258 - accuracy50: 0.4853 - val_loss: 13.0420 - val_accuracy10: 0.5596 - val_accuracy20: 0.4860 - val_accuracy30: 0.4510 - val_accuracy50: 0.4161 - 41s/epoch - 27ms/step
Epoch 6/50
1532/1532 - 41s - loss: 11.2842 - accuracy10: 0.5651 - accuracy20: 0.5484 - accuracy30: 0.5285 - accuracy50: 0.4879 - val_loss: 12.9854 - val_accuracy10: 0.5621 - val_accuracy20: 0.4893 - val_accuracy30: 0.4546 - val_accuracy50: 0.4190 - 41s/epoch - 27ms/step
Epoch 7/50
1532/1532 - 41s - loss: 11.2495 - accuracy10: 0.5676 - accuracy20: 0.5506 - accuracy30: 0.5312 - accuracy50: 0.4906 - val_loss: 12.8350 - val_accuracy10: 0.5624 - val_accuracy20: 0.4934 - val_accuracy30: 0.4579 - val_accuracy50: 0.4227 - 41s/epoch - 27ms/step
Epoch 8/50
1532/1532 - 42s - loss: 11.2140 - accuracy10: 0.5695 - accuracy20: 0.5530 - accuracy30: 0.5333 - accuracy50: 0.4919 - val_loss: 12.8131 - val_accuracy10: 0.5627 - val_accuracy20: 0.4948 - val_accuracy30: 0.4596 - val_accuracy50: 0.4226 - 42s/epoch - 28ms/step
Epoch 9/50
1532/1532 - 41s - loss: 11.1859 - accuracy10: 0.5714 - accuracy20: 0.5546 - accuracy30: 0.5341 - accuracy50: 0.4934 - val_loss: 12.8962 - val_accuracy10: 0.5636 - val_accuracy20: 0.4963 - val_accuracy30: 0.4607 - val_accuracy50: 0.4230 - 41s/epoch - 27ms/step
Epoch 10/50
1532/1532 - 41s - loss: 11.1591 - accuracy10: 0.5719 - accuracy20: 0.5556 - accuracy30: 0.5361 - accuracy50: 0.4944 - val_loss: 12.8411 - val_accuracy10: 0.5611 - val_accuracy20: 0.4954 - val_accuracy30: 0.4614 - val_accuracy50: 0.4233 - 41s/epoch - 27ms/step
Epoch 11/50
1532/1532 - 41s - loss: 11.1333 - accuracy10: 0.5743 - accuracy20: 0.5579 - accuracy30: 0.5376 - accuracy50: 0.4969 - val_loss: 12.7738 - val_accuracy10: 0.5624 - val_accuracy20: 0.4981 - val_accuracy30: 0.4643 - val_accuracy50: 0.4272 - 41s/epoch - 27ms/step
Epoch 12/50
1532/1532 - 40s - loss: 11.1115 - accuracy10: 0.5754 - accuracy20: 0.5590 - accuracy30: 0.5388 - accuracy50: 0.4981 - val_loss: 12.7607 - val_accuracy10: 0.5614 - val_accuracy20: 0.4978 - val_accuracy30: 0.4647 - val_accuracy50: 0.4257 - 40s/epoch - 26ms/step
Epoch 13/50
1532/1532 - 41s - loss: 11.0934 - accuracy10: 0.5760 - accuracy20: 0.5602 - accuracy30: 0.5397 - accuracy50: 0.4989 - val_loss: 12.7614 - val_accuracy10: 0.5613 - val_accuracy20: 0.4987 - val_accuracy30: 0.4656 - val_accuracy50: 0.4278 - 41s/epoch - 27ms/step
Epoch 14/50
1532/1532 - 41s - loss: 11.0716 - accuracy10: 0.5763 - accuracy20: 0.5615 - accuracy30: 0.5416 - accuracy50: 0.5000 - val_loss: 12.7940 - val_accuracy10: 0.5594 - val_accuracy20: 0.4987 - val_accuracy30: 0.4648 - val_accuracy50: 0.4266 - 41s/epoch - 27ms/step
Epoch 15/50
1532/1532 - 45s - loss: 11.0509 - accuracy10: 0.5789 - accuracy20: 0.5634 - accuracy30: 0.5433 - accuracy50: 0.5019 - val_loss: 12.8404 - val_accuracy10: 0.5600 - val_accuracy20: 0.5002 - val_accuracy30: 0.4655 - val_accuracy50: 0.4267 - 45s/epoch - 29ms/step
Epoch 16/50
1532/1532 - 42s - loss: 11.0326 - accuracy10: 0.5789 - accuracy20: 0.5641 - accuracy30: 0.5442 - accuracy50: 0.5021 - val_loss: 12.8767 - val_accuracy10: 0.5602 - val_accuracy20: 0.4970 - val_accuracy30: 0.4622 - val_accuracy50: 0.4254 - 42s/epoch - 28ms/step
Epoch 17/50
1532/1532 - 43s - loss: 11.0116 - accuracy10: 0.5802 - accuracy20: 0.5652 - accuracy30: 0.5455 - accuracy50: 0.5041 - val_loss: 12.7177 - val_accuracy10: 0.5580 - val_accuracy20: 0.5010 - val_accuracy30: 0.4682 - val_accuracy50: 0.4306 - 43s/epoch - 28ms/step
Epoch 18/50
1532/1532 - 43s - loss: 10.9942 - accuracy10: 0.5804 - accuracy20: 0.5665 - accuracy30: 0.5466 - accuracy50: 0.5056 - val_loss: 12.6267 - val_accuracy10: 0.5563 - val_accuracy20: 0.5043 - val_accuracy30: 0.4726 - val_accuracy50: 0.4356 - 43s/epoch - 28ms/step
Epoch 19/50
1532/1532 - 42s - loss: 10.9763 - accuracy10: 0.5816 - accuracy20: 0.5675 - accuracy30: 0.5478 - accuracy50: 0.5072 - val_loss: 12.8340 - val_accuracy10: 0.5580 - val_accuracy20: 0.5022 - val_accuracy30: 0.4703 - val_accuracy50: 0.4309 - 42s/epoch - 28ms/step
Epoch 20/50
1532/1532 - 42s - loss: 10.9586 - accuracy10: 0.5826 - accuracy20: 0.5687 - accuracy30: 0.5497 - accuracy50: 0.5083 - val_loss: 12.8300 - val_accuracy10: 0.5589 - val_accuracy20: 0.5017 - val_accuracy30: 0.4685 - val_accuracy50: 0.4308 - 42s/epoch - 27ms/step
Epoch 21/50
1532/1532 - 42s - loss: 10.9423 - accuracy10: 0.5826 - accuracy20: 0.5695 - accuracy30: 0.5503 - accuracy50: 0.5090 - val_loss: 12.8626 - val_accuracy10: 0.5574 - val_accuracy20: 0.5036 - val_accuracy30: 0.4719 - val_accuracy50: 0.4338 - 42s/epoch - 27ms/step
Epoch 22/50
1532/1532 - 42s - loss: 10.9297 - accuracy10: 0.5828 - accuracy20: 0.5705 - accuracy30: 0.5517 - accuracy50: 0.5099 - val_loss: 12.7568 - val_accuracy10: 0.5586 - val_accuracy20: 0.5054 - val_accuracy30: 0.4725 - val_accuracy50: 0.4333 - 42s/epoch - 28ms/step
Epoch 23/50
1532/1532 - 42s - loss: 10.9089 - accuracy10: 0.5841 - accuracy20: 0.5710 - accuracy30: 0.5520 - accuracy50: 0.5112 - val_loss: 12.7277 - val_accuracy10: 0.5547 - val_accuracy20: 0.5059 - val_accuracy30: 0.4751 - val_accuracy50: 0.4360 - 42s/epoch - 28ms/step
Epoch 24/50
1532/1532 - 41s - loss: 10.8941 - accuracy10: 0.5858 - accuracy20: 0.5732 - accuracy30: 0.5545 - accuracy50: 0.5131 - val_loss: 12.9223 - val_accuracy10: 0.5551 - val_accuracy20: 0.5004 - val_accuracy30: 0.4693 - val_accuracy50: 0.4315 - 41s/epoch - 27ms/step
Epoch 25/50
1532/1532 - 42s - loss: 10.8719 - accuracy10: 0.5857 - accuracy20: 0.5736 - accuracy30: 0.5559 - accuracy50: 0.5147 - val_loss: 12.8879 - val_accuracy10: 0.5541 - val_accuracy20: 0.5006 - val_accuracy30: 0.4687 - val_accuracy50: 0.4321 - 42s/epoch - 27ms/step
Epoch 26/50
1532/1532 - 42s - loss: 10.8535 - accuracy10: 0.5854 - accuracy20: 0.5746 - accuracy30: 0.5567 - accuracy50: 0.5163 - val_loss: 12.6992 - val_accuracy10: 0.5527 - val_accuracy20: 0.5045 - val_accuracy30: 0.4741 - val_accuracy50: 0.4370 - 42s/epoch - 27ms/step
Epoch 27/50
1532/1532 - 41s - loss: 10.8396 - accuracy10: 0.5873 - accuracy20: 0.5762 - accuracy30: 0.5579 - accuracy50: 0.5164 - val_loss: 12.8314 - val_accuracy10: 0.5534 - val_accuracy20: 0.5039 - val_accuracy30: 0.4725 - val_accuracy50: 0.4366 - 41s/epoch - 27ms/step
Epoch 28/50
1532/1532 - 41s - loss: 10.8217 - accuracy10: 0.5870 - accuracy20: 0.5764 - accuracy30: 0.5587 - accuracy50: 0.5175 - val_loss: 12.7961 - val_accuracy10: 0.5537 - val_accuracy20: 0.5038 - val_accuracy30: 0.4732 - val_accuracy50: 0.4370 - 41s/epoch - 27ms/step
testing model: results/WBA/W8/deepOF_L2/seq2seq
Evaluating performance on  test set...
3755/3755 - 40s - 40s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.89131624
{'0': {'precision': 0.4945047701232082, 'recall': 0.3600211163756621, 'f1-score': 0.41668055282040406, 'support': 229206}, '1': {'precision': 0.6740468167015812, 'recall': 0.7448559670781894, 'f1-score': 0.7076845563341395, 'support': 511029}, '2': {'precision': 0.44771379909658365, 'recall': 0.46524354639399246, 'f1-score': 0.4563103778945872, 'support': 220923}, 'accuracy': 0.5888157826288706, 'macro avg': {'precision': 0.5387551286404576, 'recall': 0.5233735432826147, 'f1-score': 0.526891829016377, 'support': 961158}, 'weighted avg': {'precision': 0.5792088362900448, 'recall': 0.5888157826288706, 'f1-score': 0.5805106668666737, 'support': 961158}}
[[ 82519  95566  51121]
 [ 54717 380643  75669]
 [ 29636  88504 102783]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9699727
{'0': {'precision': 0.5445078345631775, 'recall': 0.33262610909571527, 'f1-score': 0.41297574604710013, 'support': 287509}, '1': {'precision': 0.5548917238598021, 'recall': 0.761293763018747, 'f1-score': 0.6419089296099623, 'support': 399424}, '2': {'precision': 0.4918599413124292, 'recall': 0.42604066004193636, 'f1-score': 0.4565904712029608, 'support': 274225}, 'accuracy': 0.5374173653031031, 'macro avg': {'precision': 0.5304198332451363, 'recall': 0.5066535107187996, 'f1-score': 0.503825048953341, 'support': 961158}, 'weighted avg': {'precision': 0.5338022128773866, 'recall': 0.5374173653031031, 'f1-score': 0.5205560355700283, 'support': 961158}}
[[ 95633 126128  65748]
 [ 40395 304079  54950]
 [ 39604 117790 116831]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0032463
{'0': {'precision': 0.5374348153398943, 'recall': 0.32004764522631485, 'f1-score': 0.4011854586473875, 'support': 305592}, '1': {'precision': 0.5035479573047501, 'recall': 0.7402928246408469, 'f1-score': 0.5993901230222991, 'support': 363494}, '2': {'precision': 0.48668820955703623, 'recall': 0.407889150620395, 'f1-score': 0.4438181631911783, 'support': 292072}, 'accuracy': 0.5056702436019884, 'macro avg': {'precision': 0.5092236607338935, 'recall': 0.48940987349585224, 'f1-score': 0.48146458162028827, 'support': 961158}, 'weighted avg': {'precision': 0.5091987373809764, 'recall': 0.5056702436019884, 'f1-score': 0.48909819053310055, 'support': 961158}}
[[ 97804 136447  71341]
 [ 40093 269092  54309]
 [ 44086 128853 119133]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0459133
{'0': {'precision': 0.5000271132030454, 'recall': 0.2965603743547687, 'f1-score': 0.3723087048069333, 'support': 310935}, '1': {'precision': 0.45939847317707233, 'recall': 0.6737038317827954, 'f1-score': 0.5462852036216116, 'support': 355683}, '2': {'precision': 0.4444971388257427, 'recall': 0.3850376858830719, 'f1-score': 0.4126364430213943, 'support': 294540}, 'accuracy': 0.4632380940490533, 'macro avg': {'precision': 0.4679742417352868, 'recall': 0.451767297340212, 'f1-score': 0.44374345048331304, 'support': 961158}, 'weighted avg': {'precision': 0.4679754471674416, 'recall': 0.4632380940490533, 'f1-score': 0.4490480286658499, 'support': 961158}}
[[ 92211 145380  73344]
 [ 47671 239625  68387]
 [ 44530 136601 113409]]
Evaluating performance on  train set...
1532/1532 - 15s - 15s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.91212475
{'0': {'precision': 0.5059238898630397, 'recall': 0.4166048780487805, 'f1-score': 0.45694046141334593, 'support': 102500}, '1': {'precision': 0.6489094679799756, 'recall': 0.7447893924064114, 'f1-score': 0.6935513863440831, 'support': 187790}, '2': {'precision': 0.48309246831531816, 'recall': 0.4373331501256281, 'f1-score': 0.4590753380553767, 'support': 101888}, 'accuracy': 0.5791375344868912, 'macro avg': {'precision': 0.5459752753861111, 'recall': 0.5329091401936067, 'f1-score': 0.5365223952709353, 'support': 392178}, 'weighted avg': {'precision': 0.5684593044858006, 'recall': 0.5791375344868912, 'f1-score': 0.5707935686861821, 'support': 392178}}
[[ 42702  37156  22642]
 [ 22890 139864  25036]
 [ 18812  38517  44559]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.99266976
{'0': {'precision': 0.5437346104321503, 'recall': 0.3867797944737709, 'f1-score': 0.4520200004694946, 'support': 124461}, '1': {'precision': 0.5245171301011908, 'recall': 0.7646671061305208, 'f1-score': 0.6222244807502829, 'support': 144115}, '2': {'precision': 0.5235071515617985, 'recall': 0.3962071811135742, 'f1-score': 0.4510472120397149, 'support': 123602}, 'accuracy': 0.5286145576753413, 'macro avg': {'precision': 0.5305862973650465, 'recall': 0.5158846939059553, 'f1-score': 0.5084305644198308, 'support': 392178}, 'weighted avg': {'precision': 0.5302976467340605, 'recall': 0.5286145576753413, 'f1-score': 0.5142590349899628, 'support': 392178}}
[[ 48139  49457  26865]
 [ 16206 110200  17709]
 [ 24189  50441  48972]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0276932
{'0': {'precision': 0.5340303223116923, 'recall': 0.37126383306512506, 'f1-score': 0.43801485573916527, 'support': 131117}, '1': {'precision': 0.4712449713755222, 'recall': 0.7441816071592193, 'f1-score': 0.5770679140268814, 'support': 130964}, '2': {'precision': 0.5176099694293478, 'recall': 0.374820326371861, 'f1-score': 0.4347919127973072, 'support': 130097}, 'accuracy': 0.49697586300098423, 'macro avg': {'precision': 0.5076284210388541, 'recall': 0.49675525553206845, 'f1-score': 0.4832915608544513, 'support': 392178}, 'weighted avg': {'precision': 0.5076166546685839, 'recall': 0.49697586300098423, 'f1-score': 0.483381116767794, 'support': 392178}}
[[48679 54502 27936]
 [15994 97461 17509]
 [26481 54853 48763]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0703238
{'0': {'precision': 0.4908879835282779, 'recall': 0.3402204274957493, 'f1-score': 0.401897315424206, 'support': 131744}, '1': {'precision': 0.42444025763484206, 'recall': 0.6733941977940495, 'f1-score': 0.5206898096304591, 'support': 129468}, '2': {'precision': 0.4778186313021799, 'recall': 0.3482888688667288, 'f1-score': 0.4028989219578764, 'support': 130966}, 'accuracy': 0.45290403847232635, 'macro avg': {'precision': 0.4643822908217666, 'recall': 0.45396783138550917, 'f1-score': 0.4418286823375139, 'support': 392178}, 'weighted avg': {'precision': 0.464587438980612, 'recall': 0.45290403847232635, 'f1-score': 0.44144824138431554, 'support': 392178}}
[[44822 59202 27720]
 [20156 87183 22129]
 [26330 59022 45614]]
Evaluating performance on  val set...
467/467 - 4s - 4s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9475661
{'0': {'precision': 0.4845393944261505, 'recall': 0.39582718236394054, 'f1-score': 0.4357136408774939, 'support': 30483}, '1': {'precision': 0.6287399463806971, 'recall': 0.7034675442656108, 'f1-score': 0.6640078954180688, 'support': 58341}, '2': {'precision': 0.4605902896665069, 'recall': 0.4401976504466769, 'f1-score': 0.45016313896093035, 'support': 30559}, 'accuracy': 0.5575249407369558, 'macro avg': {'precision': 0.5246232101577848, 'recall': 0.513164125692076, 'f1-score': 0.5166282250854978, 'support': 119383}, 'weighted avg': {'precision': 0.5488780666762217, 'recall': 0.5575249407369558, 'f1-score': 0.5509769305928086, 'support': 119383}}
[[12066 11939  6478]
 [ 8024 41041  9276]
 [ 4812 12295 13452]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0287311
{'0': {'precision': 0.5256891517840215, 'recall': 0.36756011559161167, 'f1-score': 0.43262809711040384, 'support': 37719}, '1': {'precision': 0.49745943027723966, 'recall': 0.7084643042898171, 'f1-score': 0.5845017210981446, 'support': 44221}, '2': {'precision': 0.5017314864144912, 'recall': 0.40242501936276476, 'f1-score': 0.446624675805854, 'support': 37443}, 'accuracy': 0.5047703609391622, 'macro avg': {'precision': 0.5082933561585841, 'recall': 0.49281647974806453, 'f1-score': 0.4879181646714675, 'support': 119383}, 'weighted avg': {'precision': 0.5077184743912375, 'recall': 0.5047703609391622, 'f1-score': 0.4932738961140779, 'support': 119383}}
[[13864 15716  8139]
 [ 6067 31329  6825]
 [ 6442 15933 15068]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0607183
{'0': {'precision': 0.5177455316349282, 'recall': 0.35569896793310396, 'f1-score': 0.42169033372034176, 'support': 39823}, '1': {'precision': 0.4427879361247492, 'recall': 0.6798056696383853, 'f1-score': 0.5362755459852429, 'support': 39932}, '2': {'precision': 0.49405866458312986, 'recall': 0.3829615423437973, 'f1-score': 0.4314734522709503, 'support': 39628}, 'accuracy': 0.47315781979008736, 'macro avg': {'precision': 0.4848640441142691, 'recall': 0.47282205997176224, 'f1-score': 0.46314644399217825, 'support': 119383}, 'weighted avg': {'precision': 0.48481060897892914, 'recall': 0.47315781979008736, 'f1-score': 0.4632649475102913, 'support': 119383}}
[[14165 16982  8676]
 [ 5921 27146  6865]
 [ 7273 17179 15176]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0930463
{'0': {'precision': 0.4773858472192166, 'recall': 0.3322956416951195, 'f1-score': 0.39184108469759316, 'support': 39832}, '1': {'precision': 0.4026415282890025, 'recall': 0.6129563894523327, 'f1-score': 0.4860224565494919, 'support': 39440}, '2': {'precision': 0.45913461538461536, 'recall': 0.36189573932337765, 'f1-score': 0.4047569255649895, 'support': 40111}, 'accuracy': 0.4349614266687887, 'macro avg': {'precision': 0.4463873302976115, 'recall': 0.4357159234902766, 'f1-score': 0.4275401556040248, 'support': 119383}, 'weighted avg': {'precision': 0.4465607624188235, 'recall': 0.4349614266687887, 'f1-score': 0.42729488129234294, 'support': 119383}}
[[13236 17818  8778]
 [ 6943 24175  8322]
 [ 7547 18048 14516]]
training model: results/WBA/W8/deepVOL_L2/seq2seq
Epoch 1/50
1532/1532 - 47s - loss: 12.4527 - accuracy10: 0.4581 - accuracy20: 0.4595 - accuracy30: 0.4504 - accuracy50: 0.4253 - val_loss: 13.0787 - val_accuracy10: 0.4923 - val_accuracy20: 0.4645 - val_accuracy30: 0.4436 - val_accuracy50: 0.4139 - 47s/epoch - 31ms/step
Epoch 2/50
1532/1532 - 40s - loss: 12.0145 - accuracy10: 0.4988 - accuracy20: 0.5011 - accuracy30: 0.4875 - accuracy50: 0.4528 - val_loss: 13.1361 - val_accuracy10: 0.5163 - val_accuracy20: 0.4809 - val_accuracy30: 0.4546 - val_accuracy50: 0.4210 - 40s/epoch - 26ms/step
Epoch 3/50
1532/1532 - 41s - loss: 11.7900 - accuracy10: 0.5248 - accuracy20: 0.5211 - accuracy30: 0.5047 - accuracy50: 0.4648 - val_loss: 13.2129 - val_accuracy10: 0.5210 - val_accuracy20: 0.4853 - val_accuracy30: 0.4598 - val_accuracy50: 0.4256 - 41s/epoch - 27ms/step
Epoch 4/50
1532/1532 - 40s - loss: 11.6602 - accuracy10: 0.5389 - accuracy20: 0.5301 - accuracy30: 0.5118 - accuracy50: 0.4711 - val_loss: 12.8916 - val_accuracy10: 0.5310 - val_accuracy20: 0.4974 - val_accuracy30: 0.4706 - val_accuracy50: 0.4346 - 40s/epoch - 26ms/step
Epoch 5/50
1532/1532 - 41s - loss: 11.5720 - accuracy10: 0.5468 - accuracy20: 0.5355 - accuracy30: 0.5163 - accuracy50: 0.4749 - val_loss: 12.7444 - val_accuracy10: 0.5354 - val_accuracy20: 0.5007 - val_accuracy30: 0.4739 - val_accuracy50: 0.4354 - 41s/epoch - 27ms/step
Epoch 6/50
1532/1532 - 40s - loss: 11.5037 - accuracy10: 0.5519 - accuracy20: 0.5392 - accuracy30: 0.5189 - accuracy50: 0.4777 - val_loss: 12.6874 - val_accuracy10: 0.5359 - val_accuracy20: 0.5049 - val_accuracy30: 0.4773 - val_accuracy50: 0.4389 - 40s/epoch - 26ms/step
Epoch 7/50
1532/1532 - 40s - loss: 11.4491 - accuracy10: 0.5552 - accuracy20: 0.5418 - accuracy30: 0.5224 - accuracy50: 0.4796 - val_loss: 12.6318 - val_accuracy10: 0.5376 - val_accuracy20: 0.5040 - val_accuracy30: 0.4755 - val_accuracy50: 0.4370 - 40s/epoch - 26ms/step
Epoch 8/50
1532/1532 - 39s - loss: 11.4010 - accuracy10: 0.5583 - accuracy20: 0.5433 - accuracy30: 0.5239 - accuracy50: 0.4816 - val_loss: 12.6325 - val_accuracy10: 0.5371 - val_accuracy20: 0.5034 - val_accuracy30: 0.4738 - val_accuracy50: 0.4358 - 39s/epoch - 26ms/step
Epoch 9/50
1532/1532 - 40s - loss: 11.3610 - accuracy10: 0.5607 - accuracy20: 0.5459 - accuracy30: 0.5266 - accuracy50: 0.4841 - val_loss: 12.6481 - val_accuracy10: 0.5412 - val_accuracy20: 0.5044 - val_accuracy30: 0.4766 - val_accuracy50: 0.4359 - 40s/epoch - 26ms/step
Epoch 10/50
1532/1532 - 39s - loss: 11.3326 - accuracy10: 0.5627 - accuracy20: 0.5464 - accuracy30: 0.5265 - accuracy50: 0.4848 - val_loss: 12.6180 - val_accuracy10: 0.5416 - val_accuracy20: 0.5068 - val_accuracy30: 0.4789 - val_accuracy50: 0.4398 - 39s/epoch - 26ms/step
Epoch 11/50
1532/1532 - 39s - loss: 11.3034 - accuracy10: 0.5645 - accuracy20: 0.5479 - accuracy30: 0.5289 - accuracy50: 0.4868 - val_loss: 12.7337 - val_accuracy10: 0.5370 - val_accuracy20: 0.5045 - val_accuracy30: 0.4759 - val_accuracy50: 0.4364 - 39s/epoch - 26ms/step
Epoch 12/50
1532/1532 - 40s - loss: 11.2786 - accuracy10: 0.5663 - accuracy20: 0.5496 - accuracy30: 0.5305 - accuracy50: 0.4876 - val_loss: 12.7322 - val_accuracy10: 0.5366 - val_accuracy20: 0.5042 - val_accuracy30: 0.4755 - val_accuracy50: 0.4354 - 40s/epoch - 26ms/step
Epoch 13/50
1532/1532 - 40s - loss: 11.2589 - accuracy10: 0.5673 - accuracy20: 0.5508 - accuracy30: 0.5319 - accuracy50: 0.4886 - val_loss: 12.7082 - val_accuracy10: 0.5374 - val_accuracy20: 0.5044 - val_accuracy30: 0.4753 - val_accuracy50: 0.4352 - 40s/epoch - 26ms/step
Epoch 14/50
1532/1532 - 41s - loss: 11.2383 - accuracy10: 0.5682 - accuracy20: 0.5520 - accuracy30: 0.5325 - accuracy50: 0.4895 - val_loss: 12.5957 - val_accuracy10: 0.5408 - val_accuracy20: 0.5072 - val_accuracy30: 0.4779 - val_accuracy50: 0.4377 - 41s/epoch - 27ms/step
Epoch 15/50
1532/1532 - 41s - loss: 11.2193 - accuracy10: 0.5691 - accuracy20: 0.5522 - accuracy30: 0.5331 - accuracy50: 0.4904 - val_loss: 12.5568 - val_accuracy10: 0.5383 - val_accuracy20: 0.5054 - val_accuracy30: 0.4766 - val_accuracy50: 0.4377 - 41s/epoch - 27ms/step
Epoch 16/50
1532/1532 - 41s - loss: 11.2023 - accuracy10: 0.5703 - accuracy20: 0.5532 - accuracy30: 0.5342 - accuracy50: 0.4912 - val_loss: 12.6368 - val_accuracy10: 0.5379 - val_accuracy20: 0.5064 - val_accuracy30: 0.4795 - val_accuracy50: 0.4400 - 41s/epoch - 26ms/step
Epoch 17/50
1532/1532 - 40s - loss: 11.1837 - accuracy10: 0.5715 - accuracy20: 0.5553 - accuracy30: 0.5360 - accuracy50: 0.4927 - val_loss: 12.5518 - val_accuracy10: 0.5379 - val_accuracy20: 0.5083 - val_accuracy30: 0.4803 - val_accuracy50: 0.4398 - 40s/epoch - 26ms/step
Epoch 18/50
1532/1532 - 40s - loss: 11.1640 - accuracy10: 0.5726 - accuracy20: 0.5564 - accuracy30: 0.5364 - accuracy50: 0.4937 - val_loss: 12.5363 - val_accuracy10: 0.5399 - val_accuracy20: 0.5103 - val_accuracy30: 0.4819 - val_accuracy50: 0.4411 - 40s/epoch - 26ms/step
Epoch 19/50
1532/1532 - 40s - loss: 11.1513 - accuracy10: 0.5725 - accuracy20: 0.5572 - accuracy30: 0.5377 - accuracy50: 0.4946 - val_loss: 12.4663 - val_accuracy10: 0.5372 - val_accuracy20: 0.5099 - val_accuracy30: 0.4840 - val_accuracy50: 0.4421 - 40s/epoch - 26ms/step
Epoch 20/50
1532/1532 - 40s - loss: 11.1302 - accuracy10: 0.5735 - accuracy20: 0.5580 - accuracy30: 0.5387 - accuracy50: 0.4960 - val_loss: 12.5098 - val_accuracy10: 0.5383 - val_accuracy20: 0.5084 - val_accuracy30: 0.4811 - val_accuracy50: 0.4403 - 40s/epoch - 26ms/step
Epoch 21/50
1532/1532 - 40s - loss: 11.1154 - accuracy10: 0.5743 - accuracy20: 0.5596 - accuracy30: 0.5396 - accuracy50: 0.4971 - val_loss: 12.3856 - val_accuracy10: 0.5371 - val_accuracy20: 0.5108 - val_accuracy30: 0.4842 - val_accuracy50: 0.4425 - 40s/epoch - 26ms/step
Epoch 22/50
1532/1532 - 40s - loss: 11.0968 - accuracy10: 0.5750 - accuracy20: 0.5604 - accuracy30: 0.5412 - accuracy50: 0.4977 - val_loss: 12.4468 - val_accuracy10: 0.5354 - val_accuracy20: 0.5105 - val_accuracy30: 0.4842 - val_accuracy50: 0.4435 - 40s/epoch - 26ms/step
Epoch 23/50
1532/1532 - 41s - loss: 11.0819 - accuracy10: 0.5758 - accuracy20: 0.5613 - accuracy30: 0.5419 - accuracy50: 0.4986 - val_loss: 12.3590 - val_accuracy10: 0.5405 - val_accuracy20: 0.5125 - val_accuracy30: 0.4861 - val_accuracy50: 0.4451 - 41s/epoch - 27ms/step
Epoch 24/50
1532/1532 - 42s - loss: 11.0706 - accuracy10: 0.5770 - accuracy20: 0.5623 - accuracy30: 0.5431 - accuracy50: 0.4997 - val_loss: 12.4236 - val_accuracy10: 0.5393 - val_accuracy20: 0.5111 - val_accuracy30: 0.4845 - val_accuracy50: 0.4438 - 42s/epoch - 28ms/step
Epoch 25/50
1532/1532 - 42s - loss: 11.0546 - accuracy10: 0.5767 - accuracy20: 0.5630 - accuracy30: 0.5438 - accuracy50: 0.5007 - val_loss: 12.4070 - val_accuracy10: 0.5358 - val_accuracy20: 0.5123 - val_accuracy30: 0.4864 - val_accuracy50: 0.4457 - 42s/epoch - 27ms/step
Epoch 26/50
1532/1532 - 41s - loss: 11.0456 - accuracy10: 0.5777 - accuracy20: 0.5638 - accuracy30: 0.5444 - accuracy50: 0.5008 - val_loss: 12.4024 - val_accuracy10: 0.5336 - val_accuracy20: 0.5114 - val_accuracy30: 0.4877 - val_accuracy50: 0.4471 - 41s/epoch - 27ms/step
Epoch 27/50
1532/1532 - 40s - loss: 11.0285 - accuracy10: 0.5778 - accuracy20: 0.5643 - accuracy30: 0.5455 - accuracy50: 0.5021 - val_loss: 12.4080 - val_accuracy10: 0.5332 - val_accuracy20: 0.5108 - val_accuracy30: 0.4874 - val_accuracy50: 0.4472 - 40s/epoch - 26ms/step
Epoch 28/50
1532/1532 - 40s - loss: 11.0125 - accuracy10: 0.5792 - accuracy20: 0.5663 - accuracy30: 0.5469 - accuracy50: 0.5035 - val_loss: 12.4694 - val_accuracy10: 0.5355 - val_accuracy20: 0.5121 - val_accuracy30: 0.4870 - val_accuracy50: 0.4468 - 40s/epoch - 26ms/step
Epoch 29/50
1532/1532 - 40s - loss: 11.0018 - accuracy10: 0.5793 - accuracy20: 0.5666 - accuracy30: 0.5478 - accuracy50: 0.5047 - val_loss: 12.5109 - val_accuracy10: 0.5364 - val_accuracy20: 0.5112 - val_accuracy30: 0.4855 - val_accuracy50: 0.4457 - 40s/epoch - 26ms/step
Epoch 30/50
1532/1532 - 40s - loss: 10.9909 - accuracy10: 0.5799 - accuracy20: 0.5670 - accuracy30: 0.5485 - accuracy50: 0.5052 - val_loss: 12.5454 - val_accuracy10: 0.5356 - val_accuracy20: 0.5101 - val_accuracy30: 0.4850 - val_accuracy50: 0.4456 - 40s/epoch - 26ms/step
Epoch 31/50
1532/1532 - 39s - loss: 10.9765 - accuracy10: 0.5811 - accuracy20: 0.5681 - accuracy30: 0.5493 - accuracy50: 0.5062 - val_loss: 12.4787 - val_accuracy10: 0.5324 - val_accuracy20: 0.5110 - val_accuracy30: 0.4862 - val_accuracy50: 0.4464 - 39s/epoch - 26ms/step
Epoch 32/50
1532/1532 - 39s - loss: 10.9627 - accuracy10: 0.5812 - accuracy20: 0.5687 - accuracy30: 0.5502 - accuracy50: 0.5070 - val_loss: 12.4505 - val_accuracy10: 0.5367 - val_accuracy20: 0.5119 - val_accuracy30: 0.4874 - val_accuracy50: 0.4472 - 39s/epoch - 26ms/step
Epoch 33/50
1532/1532 - 43s - loss: 10.9494 - accuracy10: 0.5811 - accuracy20: 0.5702 - accuracy30: 0.5512 - accuracy50: 0.5080 - val_loss: 12.4836 - val_accuracy10: 0.5388 - val_accuracy20: 0.5122 - val_accuracy30: 0.4871 - val_accuracy50: 0.4484 - 43s/epoch - 28ms/step
testing model: results/WBA/W8/deepVOL_L2/seq2seq
Evaluating performance on  test set...
3755/3755 - 33s - 33s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.89643663
{'0': {'precision': 0.4582630455464859, 'recall': 0.5001592447002055, 'f1-score': 0.4782954258619143, 'support': 229207}, '1': {'precision': 0.7044270754987555, 'recall': 0.6872792452904031, 'f1-score': 0.6957475173876956, 'support': 511031}, '2': {'precision': 0.4664375500211854, 'recall': 0.44845988457621366, 'f1-score': 0.45727208741504843, 'support': 220925}, 'accuracy': 0.5877639900828475, 'macro avg': {'precision': 0.5430425570221423, 'recall': 0.5452994581889407, 'f1-score': 0.5437716768882195, 'support': 961163}, 'weighted avg': {'precision': 0.5910224243319898, 'recall': 0.5877639900828475, 'f1-score': 0.5890780701565217, 'support': 961163}}
[[114640  72679  41888]
 [ 88364 351221  71446]
 [ 47158  74691  99076]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9611771
{'0': {'precision': 0.5204873783298918, 'recall': 0.44097596605335465, 'f1-score': 0.4774439417133152, 'support': 287510}, '1': {'precision': 0.5806978363710588, 'recall': 0.7265043500031295, 'f1-score': 0.645469398014327, 'support': 399425}, '2': {'precision': 0.5156569875790653, 'recall': 0.4096591157722771, 'f1-score': 0.4565868567689388, 'support': 274228}, 'accuracy': 0.5506963959286822, 'macro avg': {'precision': 0.5389474007600052, 'recall': 0.5257131439429205, 'f1-score': 0.5265000654988604, 'support': 961163}, 'weighted avg': {'precision': 0.5441305416729204, 'recall': 0.5506963959286822, 'f1-score': 0.5413186135357898, 'support': 961163}}
[[126785 104207  56518]
 [ 60241 290184  49000]
 [ 56563 105325 112340]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.99335665
{'0': {'precision': 0.5237747631806579, 'recall': 0.40619907458916077, 'f1-score': 0.45755442885867575, 'support': 305594}, '1': {'precision': 0.5240596283276335, 'recall': 0.72468046240103, 'f1-score': 0.6082543142513749, 'support': 363494}, '2': {'precision': 0.5127188844398499, 'recall': 0.3888658734913978, 'f1-score': 0.4422853760543306, 'support': 292075}, 'accuracy': 0.5213756667703605, 'macro avg': {'precision': 0.5201844253160471, 'recall': 0.5065818034938628, 'f1-score': 0.5026980397214604, 'support': 961163}, 'weighted avg': {'precision': 0.5205228704096225, 'recall': 0.5213756667703605, 'f1-score': 0.5099064186284699, 'support': 961163}}
[[124132 118748  62714]
 [ 54848 263417  45229]
 [ 58015 120482 113578]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0440786
{'0': {'precision': 0.4913376746121897, 'recall': 0.3644757619710745, 'f1-score': 0.41850400025111206, 'support': 310937}, '1': {'precision': 0.47161189023726224, 'recall': 0.6696646461465795, 'f1-score': 0.5534536101038994, 'support': 355684}, '2': {'precision': 0.4678074657582854, 'recall': 0.35808136021348397, 'f1-score': 0.4056554063669475, 'support': 294542}, 'accuracy': 0.47545317495575673, 'macro avg': {'precision': 0.4769190102025791, 'recall': 0.464073922777046, 'f1-score': 0.45920433890731965, 'support': 961163}, 'weighted avg': {'precision': 0.4768273567307707, 'recall': 0.47545317495575673, 'f1-score': 0.46450552807838924, 'support': 961163}}
[[113329 133603  64005]
 [ 61514 238189  55981]
 [ 55811 133261 105470]]
Evaluating performance on  train set...
1532/1532 - 14s - 14s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9167578
{'0': {'precision': 0.4694331352332808, 'recall': 0.572385745216221, 'f1-score': 0.5158225483948935, 'support': 102534}, '1': {'precision': 0.6872720703632197, 'recall': 0.6482672687384183, 'f1-score': 0.6672000964557975, 'support': 187796}, '2': {'precision': 0.4748283752860412, 'recall': 0.4196816918832412, 'f1-score': 0.44555513282223136, 'support': 101851}, 'accuracy': 0.5690637741247027, 'macro avg': {'precision': 0.5438445269608472, 'recall': 0.5467782352792935, 'f1-score': 0.5428592592243074, 'support': 392181}, 'weighted avg': {'precision': 0.5751465462763341, 'recall': 0.5690637741247027, 'f1-score': 0.5700610032719893, 'support': 392181}}
[[ 58689  25045  18800]
 [ 37577 121742  28477]
 [ 28755  30351  42745]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.965159
{'0': {'precision': 0.5234055098765028, 'recall': 0.5130444555043588, 'f1-score': 0.5181731946392522, 'support': 124574}, '1': {'precision': 0.5582513057735757, 'recall': 0.6879912785045691, 'f1-score': 0.6163680080126162, 'support': 144012}, '2': {'precision': 0.5238681527561776, 'recall': 0.3924592418787168, 'f1-score': 0.44874113614602174, 'support': 123595}, 'accuracy': 0.539284157060133, 'macro avg': {'precision': 0.535174989468752, 'recall': 0.5311649919625482, 'f1-score': 0.5277607795992966, 'support': 392181}, 'weighted avg': {'precision': 0.5363469657487727, 'recall': 0.539284157060133, 'f1-score': 0.5323497513670234, 'support': 392181}}
[[63912 36533 24129]
 [24976 99079 19957]
 [33220 41869 48506]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9961294
{'0': {'precision': 0.5240158538223835, 'recall': 0.4758070665019748, 'f1-score': 0.4987492107639805, 'support': 131154}, '1': {'precision': 0.49750026533496444, 'recall': 0.6803248008188769, 'f1-score': 0.5747233246216887, 'support': 130911}, '2': {'precision': 0.519963007844888, 'recall': 0.37593378216360784, 'f1-score': 0.43637093536732235, 'support': 130116}, 'accuracy': 0.5109401016367443, 'macro avg': {'precision': 0.513826375667412, 'recall': 0.5106885498281533, 'f1-score': 0.503281156917664, 'support': 392181}, 'weighted avg': {'precision': 0.5138202494670365, 'recall': 0.5109401016367443, 'f1-score': 0.5034139842683443, 'support': 392181}}
[[62404 42582 26168]
 [22858 89062 18991]
 [33826 47375 48915]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0482104
{'0': {'precision': 0.4877008401325523, 'recall': 0.42774211173336973, 'f1-score': 0.4557579187806998, 'support': 131778}, '1': {'precision': 0.44260330190503017, 'recall': 0.6195549645115898, 'f1-score': 0.5163393849573915, 'support': 129338}, '2': {'precision': 0.4835961781973063, 'recall': 0.35258078052874525, 'f1-score': 0.40782448305989705, 'support': 131065}, 'accuracy': 0.46588182497367286, 'macro avg': {'precision': 0.4713001067449629, 'recall': 0.46662595225790165, 'f1-score': 0.4599739289326628, 'support': 392181}, 'weighted avg': {'precision': 0.4714562925491297, 'recall': 0.46588182497367286, 'f1-score': 0.45971805432937235, 'support': 392181}}
[[56367 48533 26878]
 [26738 80132 22468]
 [32472 52382 46211]]
Evaluating performance on  val set...
467/467 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9662271
{'0': {'precision': 0.44387511283385545, 'recall': 0.5486136177194422, 'f1-score': 0.4907177763754567, 'support': 30475}, '1': {'precision': 0.6585089294150996, 'recall': 0.5968551412274541, 'f1-score': 0.6261680563542266, 'support': 58381}, '2': {'precision': 0.4488229984028887, 'recall': 0.4234611982834868, 'f1-score': 0.43577339918083907, 'support': 30527}, 'accuracy': 0.5402025414003668, 'macro avg': {'precision': 0.5170690135506145, 'recall': 0.5229766524101277, 'f1-score': 0.5175530773035074, 'support': 119383}, 'weighted avg': {'precision': 0.5501011328584443, 'recall': 0.5402025414003668, 'f1-score': 0.5429064112130841, 'support': 119383}}
[[16719  8235  5521]
 [13182 34845 10354]
 [ 7765  9835 12927]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0145441
{'0': {'precision': 0.5049305366385182, 'recall': 0.49072088528843355, 'f1-score': 0.4977243129304674, 'support': 37773}, '1': {'precision': 0.5261107223241475, 'recall': 0.6299340987838847, 'f1-score': 0.5733602671393824, 'support': 44157}, '2': {'precision': 0.49919468492047514, 'recall': 0.3972178463674472, 'f1-score': 0.4424057690878002, 'support': 37453}, 'accuracy': 0.5128787180754378, 'macro avg': {'precision': 0.510078647961047, 'recall': 0.5059576101465885, 'f1-score': 0.5044967830525501, 'support': 119383}, 'weighted avg': {'precision': 0.5109651362458698, 'recall': 0.5128787180754378, 'f1-score': 0.5083456862203298, 'support': 119383}}
[[18536 11711  7526]
 [ 8942 27816  7399]
 [ 9232 13344 14877]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0382856
{'0': {'precision': 0.5043634424895473, 'recall': 0.45136988021395746, 'f1-score': 0.4763974661401045, 'support': 39821}, '1': {'precision': 0.4651994086051691, 'recall': 0.6230605339014914, 'f1-score': 0.5326804388822218, 'support': 39895}, '2': {'precision': 0.49915877676244513, 'recall': 0.38145057604557947, 'f1-score': 0.43243783938268077, 'support': 39667}, 'accuracy': 0.48551301274050745, 'macro avg': {'precision': 0.48957387595238727, 'recall': 0.48529366338700947, 'f1-score': 0.48050524813500245, 'support': 119383}, 'weighted avg': {'precision': 0.4895464031521691, 'recall': 0.48551301274050745, 'f1-score': 0.48059959444111927, 'support': 119383}}
[[17974 13595  8252]
 [ 8108 24857  6930]
 [ 9555 14981 15131]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0760525
{'0': {'precision': 0.4687201459051038, 'recall': 0.4065843001356034, 'f1-score': 0.4354467827607073, 'support': 39822}, '1': {'precision': 0.4168884453315591, 'recall': 0.5715697453439756, 'f1-score': 0.48212625436824724, 'support': 39465}, '2': {'precision': 0.46674476116100483, 'recall': 0.3577414205905826, 'f1-score': 0.405037555768905, 'support': 40096}, 'accuracy': 0.4447199349991205, 'macro avg': {'precision': 0.45078445079922264, 'recall': 0.4452984886900539, 'f1-score': 0.44087019763261986, 'support': 119383}, 'weighted avg': {'precision': 0.45092244363732414, 'recall': 0.4447199349991205, 'f1-score': 0.440664585810792, 'support': 119383}}
[[16191 15181  8450]
 [ 8970 22557  7938]
 [ 9382 16370 14344]]
training model: results/WBA/W8/deepVOL_L3/seq2seq
Epoch 1/50
1532/1532 - 68s - loss: 12.8152 - accuracy10: 0.4360 - accuracy20: 0.4206 - accuracy30: 0.4114 - accuracy50: 0.3959 - val_loss: 14.8352 - val_accuracy10: 0.4803 - val_accuracy20: 0.3720 - val_accuracy30: 0.3381 - val_accuracy50: 0.3335 - 68s/epoch - 44ms/step
Epoch 2/50
1532/1532 - 59s - loss: 12.5915 - accuracy10: 0.4233 - accuracy20: 0.4328 - accuracy30: 0.4299 - accuracy50: 0.4138 - val_loss: 14.3790 - val_accuracy10: 0.4887 - val_accuracy20: 0.3701 - val_accuracy30: 0.3349 - val_accuracy50: 0.3312 - 59s/epoch - 38ms/step
Epoch 3/50
1532/1532 - 58s - loss: 12.3548 - accuracy10: 0.4435 - accuracy20: 0.4544 - accuracy30: 0.4492 - accuracy50: 0.4292 - val_loss: 13.3344 - val_accuracy10: 0.4954 - val_accuracy20: 0.3807 - val_accuracy30: 0.3456 - val_accuracy50: 0.3398 - 58s/epoch - 38ms/step
Epoch 4/50
1532/1532 - 59s - loss: 12.0236 - accuracy10: 0.4901 - accuracy20: 0.4943 - accuracy30: 0.4833 - accuracy50: 0.4516 - val_loss: 12.5506 - val_accuracy10: 0.5098 - val_accuracy20: 0.4840 - val_accuracy30: 0.4611 - val_accuracy50: 0.4300 - 59s/epoch - 39ms/step
Epoch 5/50
1532/1532 - 59s - loss: 11.7942 - accuracy10: 0.5187 - accuracy20: 0.5173 - accuracy30: 0.5026 - accuracy50: 0.4643 - val_loss: 12.6022 - val_accuracy10: 0.5203 - val_accuracy20: 0.4909 - val_accuracy30: 0.4664 - val_accuracy50: 0.4314 - 59s/epoch - 39ms/step
Epoch 6/50
1532/1532 - 60s - loss: 11.6334 - accuracy10: 0.5352 - accuracy20: 0.5290 - accuracy30: 0.5115 - accuracy50: 0.4719 - val_loss: 12.6271 - val_accuracy10: 0.5169 - val_accuracy20: 0.4895 - val_accuracy30: 0.4665 - val_accuracy50: 0.4313 - 60s/epoch - 39ms/step
Epoch 7/50
1532/1532 - 59s - loss: 11.5398 - accuracy10: 0.5423 - accuracy20: 0.5341 - accuracy30: 0.5165 - accuracy50: 0.4760 - val_loss: 12.5215 - val_accuracy10: 0.5331 - val_accuracy20: 0.4919 - val_accuracy30: 0.4647 - val_accuracy50: 0.4313 - 59s/epoch - 38ms/step
Epoch 8/50
1532/1532 - 58s - loss: 11.4593 - accuracy10: 0.5464 - accuracy20: 0.5383 - accuracy30: 0.5201 - accuracy50: 0.4791 - val_loss: 12.4097 - val_accuracy10: 0.5331 - val_accuracy20: 0.4968 - val_accuracy30: 0.4703 - val_accuracy50: 0.4355 - 58s/epoch - 38ms/step
Epoch 9/50
1532/1532 - 59s - loss: 11.4249 - accuracy10: 0.5499 - accuracy20: 0.5408 - accuracy30: 0.5221 - accuracy50: 0.4812 - val_loss: 12.4974 - val_accuracy10: 0.5358 - val_accuracy20: 0.4969 - val_accuracy30: 0.4693 - val_accuracy50: 0.4332 - 59s/epoch - 38ms/step
Epoch 10/50
1532/1532 - 59s - loss: 11.3691 - accuracy10: 0.5535 - accuracy20: 0.5436 - accuracy30: 0.5250 - accuracy50: 0.4838 - val_loss: 12.5561 - val_accuracy10: 0.5326 - val_accuracy20: 0.4959 - val_accuracy30: 0.4687 - val_accuracy50: 0.4330 - 59s/epoch - 38ms/step
Epoch 11/50
1532/1532 - 60s - loss: 11.3442 - accuracy10: 0.5561 - accuracy20: 0.5458 - accuracy30: 0.5262 - accuracy50: 0.4850 - val_loss: 12.4562 - val_accuracy10: 0.5364 - val_accuracy20: 0.5002 - val_accuracy30: 0.4727 - val_accuracy50: 0.4358 - 60s/epoch - 39ms/step
Epoch 12/50
1532/1532 - 58s - loss: 11.3138 - accuracy10: 0.5578 - accuracy20: 0.5468 - accuracy30: 0.5278 - accuracy50: 0.4864 - val_loss: 12.3654 - val_accuracy10: 0.5349 - val_accuracy20: 0.5009 - val_accuracy30: 0.4747 - val_accuracy50: 0.4377 - 58s/epoch - 38ms/step
Epoch 13/50
1532/1532 - 58s - loss: 11.2821 - accuracy10: 0.5599 - accuracy20: 0.5490 - accuracy30: 0.5301 - accuracy50: 0.4879 - val_loss: 12.3944 - val_accuracy10: 0.5370 - val_accuracy20: 0.4960 - val_accuracy30: 0.4678 - val_accuracy50: 0.4347 - 58s/epoch - 38ms/step
Epoch 14/50
1532/1532 - 58s - loss: 11.2599 - accuracy10: 0.5609 - accuracy20: 0.5498 - accuracy30: 0.5307 - accuracy50: 0.4892 - val_loss: 12.3194 - val_accuracy10: 0.5390 - val_accuracy20: 0.4979 - val_accuracy30: 0.4709 - val_accuracy50: 0.4356 - 58s/epoch - 38ms/step
Epoch 15/50
1532/1532 - 59s - loss: 11.2475 - accuracy10: 0.5618 - accuracy20: 0.5511 - accuracy30: 0.5320 - accuracy50: 0.4904 - val_loss: 12.2861 - val_accuracy10: 0.5367 - val_accuracy20: 0.5017 - val_accuracy30: 0.4758 - val_accuracy50: 0.4401 - 59s/epoch - 38ms/step
Epoch 16/50
1532/1532 - 59s - loss: 11.2232 - accuracy10: 0.5636 - accuracy20: 0.5520 - accuracy30: 0.5324 - accuracy50: 0.4902 - val_loss: 12.2979 - val_accuracy10: 0.5401 - val_accuracy20: 0.4977 - val_accuracy30: 0.4706 - val_accuracy50: 0.4382 - 59s/epoch - 38ms/step
Epoch 17/50
1532/1532 - 59s - loss: 11.2101 - accuracy10: 0.5652 - accuracy20: 0.5531 - accuracy30: 0.5338 - accuracy50: 0.4914 - val_loss: 12.1907 - val_accuracy10: 0.5395 - val_accuracy20: 0.5072 - val_accuracy30: 0.4814 - val_accuracy50: 0.4450 - 59s/epoch - 39ms/step
Epoch 18/50
1532/1532 - 58s - loss: 11.1893 - accuracy10: 0.5664 - accuracy20: 0.5546 - accuracy30: 0.5353 - accuracy50: 0.4926 - val_loss: 12.2829 - val_accuracy10: 0.5388 - val_accuracy20: 0.5044 - val_accuracy30: 0.4777 - val_accuracy50: 0.4426 - 58s/epoch - 38ms/step
Epoch 19/50
1532/1532 - 58s - loss: 11.1751 - accuracy10: 0.5669 - accuracy20: 0.5546 - accuracy30: 0.5359 - accuracy50: 0.4934 - val_loss: 12.1970 - val_accuracy10: 0.5391 - val_accuracy20: 0.5068 - val_accuracy30: 0.4825 - val_accuracy50: 0.4473 - 58s/epoch - 38ms/step
Epoch 20/50
1532/1532 - 58s - loss: 11.1605 - accuracy10: 0.5675 - accuracy20: 0.5555 - accuracy30: 0.5370 - accuracy50: 0.4945 - val_loss: 12.2321 - val_accuracy10: 0.5389 - val_accuracy20: 0.5044 - val_accuracy30: 0.4814 - val_accuracy50: 0.4474 - 58s/epoch - 38ms/step
Epoch 21/50
1532/1532 - 59s - loss: 11.1574 - accuracy10: 0.5672 - accuracy20: 0.5552 - accuracy30: 0.5360 - accuracy50: 0.4942 - val_loss: 12.0704 - val_accuracy10: 0.5381 - val_accuracy20: 0.5100 - val_accuracy30: 0.4878 - val_accuracy50: 0.4517 - 59s/epoch - 38ms/step
Epoch 22/50
1532/1532 - 60s - loss: 11.1385 - accuracy10: 0.5689 - accuracy20: 0.5569 - accuracy30: 0.5383 - accuracy50: 0.4962 - val_loss: 12.0823 - val_accuracy10: 0.5379 - val_accuracy20: 0.5104 - val_accuracy30: 0.4869 - val_accuracy50: 0.4512 - 60s/epoch - 39ms/step
Epoch 23/50
1532/1532 - 58s - loss: 11.1232 - accuracy10: 0.5702 - accuracy20: 0.5575 - accuracy30: 0.5389 - accuracy50: 0.4967 - val_loss: 12.1231 - val_accuracy10: 0.5384 - val_accuracy20: 0.5122 - val_accuracy30: 0.4884 - val_accuracy50: 0.4519 - 58s/epoch - 38ms/step
Epoch 24/50
1532/1532 - 60s - loss: 11.1098 - accuracy10: 0.5701 - accuracy20: 0.5583 - accuracy30: 0.5396 - accuracy50: 0.4964 - val_loss: 12.0736 - val_accuracy10: 0.5351 - val_accuracy20: 0.5151 - val_accuracy30: 0.4914 - val_accuracy50: 0.4543 - 60s/epoch - 39ms/step
Epoch 25/50
1532/1532 - 59s - loss: 11.0939 - accuracy10: 0.5712 - accuracy20: 0.5595 - accuracy30: 0.5408 - accuracy50: 0.4983 - val_loss: 12.0973 - val_accuracy10: 0.5393 - val_accuracy20: 0.5123 - val_accuracy30: 0.4878 - val_accuracy50: 0.4496 - 59s/epoch - 38ms/step
Epoch 26/50
1532/1532 - 60s - loss: 11.0843 - accuracy10: 0.5724 - accuracy20: 0.5601 - accuracy30: 0.5413 - accuracy50: 0.4990 - val_loss: 12.0966 - val_accuracy10: 0.5318 - val_accuracy20: 0.5145 - val_accuracy30: 0.4923 - val_accuracy50: 0.4534 - 60s/epoch - 39ms/step
Epoch 27/50
1532/1532 - 60s - loss: 11.0706 - accuracy10: 0.5728 - accuracy20: 0.5610 - accuracy30: 0.5419 - accuracy50: 0.4998 - val_loss: 12.0292 - val_accuracy10: 0.5357 - val_accuracy20: 0.5109 - val_accuracy30: 0.4885 - val_accuracy50: 0.4511 - 60s/epoch - 39ms/step
Epoch 28/50
1532/1532 - 58s - loss: 11.0566 - accuracy10: 0.5738 - accuracy20: 0.5614 - accuracy30: 0.5427 - accuracy50: 0.5008 - val_loss: 12.0868 - val_accuracy10: 0.5330 - val_accuracy20: 0.5131 - val_accuracy30: 0.4904 - val_accuracy50: 0.4527 - 58s/epoch - 38ms/step
Epoch 29/50
1532/1532 - 58s - loss: 11.0492 - accuracy10: 0.5741 - accuracy20: 0.5626 - accuracy30: 0.5436 - accuracy50: 0.5015 - val_loss: 12.1578 - val_accuracy10: 0.5352 - val_accuracy20: 0.5129 - val_accuracy30: 0.4894 - val_accuracy50: 0.4516 - 58s/epoch - 38ms/step
Epoch 30/50
1532/1532 - 61s - loss: 11.0372 - accuracy10: 0.5752 - accuracy20: 0.5634 - accuracy30: 0.5450 - accuracy50: 0.5028 - val_loss: 12.0756 - val_accuracy10: 0.5378 - val_accuracy20: 0.5132 - val_accuracy30: 0.4889 - val_accuracy50: 0.4511 - 61s/epoch - 40ms/step
Epoch 31/50
1532/1532 - 58s - loss: 11.0243 - accuracy10: 0.5753 - accuracy20: 0.5639 - accuracy30: 0.5454 - accuracy50: 0.5034 - val_loss: 12.1544 - val_accuracy10: 0.5308 - val_accuracy20: 0.5094 - val_accuracy30: 0.4875 - val_accuracy50: 0.4491 - 58s/epoch - 38ms/step
Epoch 32/50
1532/1532 - 59s - loss: 11.0120 - accuracy10: 0.5765 - accuracy20: 0.5647 - accuracy30: 0.5463 - accuracy50: 0.5046 - val_loss: 12.1668 - val_accuracy10: 0.5332 - val_accuracy20: 0.5087 - val_accuracy30: 0.4858 - val_accuracy50: 0.4484 - 59s/epoch - 39ms/step
Epoch 33/50
1532/1532 - 58s - loss: 11.0030 - accuracy10: 0.5756 - accuracy20: 0.5645 - accuracy30: 0.5465 - accuracy50: 0.5046 - val_loss: 12.1796 - val_accuracy10: 0.5298 - val_accuracy20: 0.5073 - val_accuracy30: 0.4866 - val_accuracy50: 0.4507 - 58s/epoch - 38ms/step
Epoch 34/50
1532/1532 - 58s - loss: 10.9920 - accuracy10: 0.5773 - accuracy20: 0.5654 - accuracy30: 0.5472 - accuracy50: 0.5057 - val_loss: 12.2048 - val_accuracy10: 0.5305 - val_accuracy20: 0.5067 - val_accuracy30: 0.4842 - val_accuracy50: 0.4480 - 58s/epoch - 38ms/step
Epoch 35/50
1532/1532 - 59s - loss: 10.9772 - accuracy10: 0.5780 - accuracy20: 0.5667 - accuracy30: 0.5485 - accuracy50: 0.5066 - val_loss: 12.2994 - val_accuracy10: 0.5230 - val_accuracy20: 0.5028 - val_accuracy30: 0.4793 - val_accuracy50: 0.4419 - 59s/epoch - 38ms/step
Epoch 36/50
1532/1532 - 59s - loss: 10.9658 - accuracy10: 0.5783 - accuracy20: 0.5678 - accuracy30: 0.5497 - accuracy50: 0.5074 - val_loss: 12.1376 - val_accuracy10: 0.5344 - val_accuracy20: 0.5128 - val_accuracy30: 0.4899 - val_accuracy50: 0.4533 - 59s/epoch - 39ms/step
Epoch 37/50
1532/1532 - 61s - loss: 10.9591 - accuracy10: 0.5785 - accuracy20: 0.5678 - accuracy30: 0.5501 - accuracy50: 0.5082 - val_loss: 12.1612 - val_accuracy10: 0.5307 - val_accuracy20: 0.5093 - val_accuracy30: 0.4875 - val_accuracy50: 0.4510 - 61s/epoch - 40ms/step
testing model: results/WBA/W8/deepVOL_L3/seq2seq
Evaluating performance on  test set...
3755/3755 - 58s - 58s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8832627
{'0': {'precision': 0.4366736459873787, 'recall': 0.5204640346935303, 'f1-score': 0.4749012231411539, 'support': 229207}, '1': {'precision': 0.706489335436387, 'recall': 0.6775264122920136, 'f1-score': 0.6917048242354501, 'support': 511031}, '2': {'precision': 0.47168686266385035, 'recall': 0.4225144279732941, 'f1-score': 0.4457486408209752, 'support': 220925}, 'accuracy': 0.5814570473478484, 'macro avg': {'precision': 0.5382832813625387, 'recall': 0.5401682916529461, 'f1-score': 0.5374515627325264, 'support': 961163}, 'weighted avg': {'precision': 0.5881770605893407, 'recall': 0.5814570473478484, 'f1-score': 0.5834705571893161, 'support': 961163}}
[[119294  73959  35954]
 [ 96198 346237  68596]
 [ 57696  69885  93344]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9378808
{'0': {'precision': 0.49139386333175317, 'recall': 0.5011547424437411, 'f1-score': 0.49622630787748545, 'support': 287510}, '1': {'precision': 0.5944100260910665, 'recall': 0.7021293108843963, 'f1-score': 0.6437948932204207, 'support': 399425}, '2': {'precision': 0.5265253679900883, 'recall': 0.3765808013769564, 'f1-score': 0.439105282963511, 'support': 274228}, 'accuracy': 0.5491305845106397, 'macro avg': {'precision': 0.5374430858043027, 'recall': 0.5266216182350313, 'f1-score': 0.5263754946871391, 'support': 961163}, 'weighted avg': {'precision': 0.5442270176142054, 'recall': 0.5491305845106397, 'f1-score': 0.5412534237574065, 'support': 961163}}
[[144087  98271  45152]
 [ 71265 280448  47712]
 [ 77869  93090 103269]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.970159
{'0': {'precision': 0.4916479542546803, 'recall': 0.4929317983991832, 'f1-score': 0.49228903929174844, 'support': 305594}, '1': {'precision': 0.5453996446822014, 'recall': 0.6832492420782736, 'f1-score': 0.6065913506687948, 'support': 363494}, '2': {'precision': 0.5252552606768169, 'recall': 0.3585996747410768, 'f1-score': 0.42621556567015073, 'support': 292075}, 'accuracy': 0.5240859250720221, 'macro avg': {'precision': 0.5207676198712329, 'recall': 0.5115935717395113, 'f1-score': 0.5083653185435647, 'support': 961163}, 'weighted avg': {'precision': 0.5221883214801217, 'recall': 0.5240859250720221, 'f1-score': 0.5154378647913358, 'support': 961163}}
[[150637 105426  49531]
 [ 70002 248357  45135]
 [ 85753 101584 104738]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0223556
{'0': {'precision': 0.45895541886836533, 'recall': 0.4801808726526595, 'f1-score': 0.46932828713061137, 'support': 310937}, '1': {'precision': 0.49576109746320324, 'recall': 0.5963102079373827, 'f1-score': 0.5414067774761425, 'support': 355684}, '2': {'precision': 0.47980271412295755, 'recall': 0.33886508545470595, 'f1-score': 0.39720235193457565, 'support': 294542}, 'accuracy': 0.4798499318013698, 'macro avg': {'precision': 0.47817307681817534, 'recall': 0.47178538868158265, 'f1-score': 0.46931247218044314, 'support': 961163}, 'weighted avg': {'precision': 0.4789640906797068, 'recall': 0.4798499318013698, 'f1-score': 0.47389884233878016, 'support': 961163}}
[[149306 109308  52323]
 [ 87696 212098  55890]
 [ 88315 106417  99810]]
Evaluating performance on  train set...
1532/1532 - 24s - 24s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.89912707
{'0': {'precision': 0.4521320711014144, 'recall': 0.5901652134901594, 'f1-score': 0.5120086643454569, 'support': 102534}, '1': {'precision': 0.6986966159302498, 'recall': 0.6294170269867303, 'f1-score': 0.6622498746396766, 'support': 187796}, '2': {'precision': 0.48208458096423645, 'recall': 0.4220577117554074, 'f1-score': 0.4500785258088158, 'support': 101851}, 'accuracy': 0.5653027556153919, 'macro avg': {'precision': 0.5443044226653002, 'recall': 0.5472133174107657, 'f1-score': 0.5414456882646498, 'support': 392181}, 'weighted avg': {'precision': 0.5779783725354825, 'recall': 0.5653027556153919, 'f1-score': 0.56786820825074, 'support': 392181}}
[[ 60512  24490  17532]
 [ 40944 118202  28650]
 [ 32381  26483  42987]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.93627816
{'0': {'precision': 0.4960073944861041, 'recall': 0.5729205131086743, 'f1-score': 0.5316968692380757, 'support': 124574}, '1': {'precision': 0.5842546630565584, 'recall': 0.6473002249812516, 'f1-score': 0.614163734830217, 'support': 144012}, '2': {'precision': 0.533480583290135, 'recall': 0.3830252032849225, 'f1-score': 0.4459033687651001, 'support': 123595}, 'accuracy': 0.5403882391038831, 'macro avg': {'precision': 0.5379142136109325, 'recall': 0.5344153137916162, 'f1-score': 0.5305879909444643, 'support': 392181}, 'weighted avg': {'precision': 0.5402220923210387, 'recall': 0.5403882391038831, 'f1-score': 0.5349417244368183, 'support': 392181}}
[[71371 32286 20917]
 [30312 93219 20481]
 [42208 34047 47340]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9663161
{'0': {'precision': 0.49242333132892363, 'recall': 0.5619424493343703, 'f1-score': 0.5248910349542774, 'support': 131154}, '1': {'precision': 0.5315395229647152, 'recall': 0.6179389050576346, 'f1-score': 0.571492152977206, 'support': 130911}, '2': {'precision': 0.5309950066983316, 'recall': 0.36859417750315104, 'f1-score': 0.435135662343436, 'support': 130116}, 'accuracy': 0.5164860102860669, 'macro avg': {'precision': 0.5183192869973234, 'recall': 0.5161585106317187, 'f1-score': 0.5105062834249731, 'support': 392181}, 'weighted avg': {'precision': 0.5182775462847705, 'recall': 0.5164860102860669, 'f1-score': 0.5106679820752938, 'support': 392181}}
[[73701 35050 22403]
 [30058 80895 19958]
 [45911 36245 47960]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.019628
{'0': {'precision': 0.4590055828723622, 'recall': 0.5440437705838608, 'f1-score': 0.4979199222141195, 'support': 131778}, '1': {'precision': 0.47832931568849313, 'recall': 0.5262258578298721, 'f1-score': 0.501135748655325, 'support': 129338}, '2': {'precision': 0.494119530416222, 'recall': 0.3532522031053294, 'f1-score': 0.4119769537072053, 'support': 131065}, 'accuracy': 0.4744059503137582, 'macro avg': {'precision': 0.4771514763256925, 'recall': 0.4745072771730207, 'f1-score': 0.4703442081922166, 'support': 392181}, 'weighted avg': {'precision': 0.47711329969140426, 'recall': 0.4744059503137582, 'f1-score': 0.4702587489112158, 'support': 392181}}
[[71693 36568 23517]
 [37393 68061 23884]
 [47106 37660 46299]]
Evaluating performance on  val set...
467/467 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9472407
{'0': {'precision': 0.429274045820682, 'recall': 0.5613453650533224, 'f1-score': 0.4865057020163239, 'support': 30475}, '1': {'precision': 0.6667587077432843, 'recall': 0.5790582552542779, 'f1-score': 0.6198216037329373, 'support': 58381}, '2': {'precision': 0.4505376344086022, 'recall': 0.425492187244079, 'f1-score': 0.43765688966760447, 'support': 30527}, 'accuracy': 0.5352688406221991, 'macro avg': {'precision': 0.5155234626575228, 'recall': 0.5219652691838932, 'f1-score': 0.5146613984722886, 'support': 119383}, 'weighted avg': {'precision': 0.5508466785785024, 'recall': 0.5352688406221991, 'f1-score': 0.5392092524677973, 'support': 119383}}
[[17107  8070  5298]
 [14032 33806 10543]
 [ 8712  8826 12989]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9852837
{'0': {'precision': 0.4798742870445815, 'recall': 0.5457072512111826, 'f1-score': 0.5106778317312457, 'support': 37773}, '1': {'precision': 0.5439983226753329, 'recall': 0.5875852073283964, 'f1-score': 0.5649523145930408, 'support': 44157}, '2': {'precision': 0.5065952041206975, 'recall': 0.3886471043708114, 'f1-score': 0.43985132807542376, 'support': 37453}, 'accuracy': 0.5119238082474054, 'macro avg': {'precision': 0.5101559379468706, 'recall': 0.5073131876367968, 'f1-score': 0.50516049146657, 'support': 119383}, 'weighted avg': {'precision': 0.5119752021547636, 'recall': 0.5119238082474054, 'f1-score': 0.5085329140989764, 'support': 119383}}
[[20613 10577  6583]
 [10617 25946  7594]
 [11725 11172 14556]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0099001
{'0': {'precision': 0.47517698918028406, 'recall': 0.5359985937068381, 'f1-score': 0.5037585999362748, 'support': 39821}, '1': {'precision': 0.49161481089191933, 'recall': 0.5584409073818775, 'f1-score': 0.5229014352270194, 'support': 39895}, '2': {'precision': 0.5068789240745188, 'recall': 0.37245065167519603, 'f1-score': 0.42938936844246817, 'support': 39667}, 'accuracy': 0.4891567476106313, 'macro avg': {'precision': 0.49122357471557404, 'recall': 0.4889633842546372, 'f1-score': 0.4853498012019208, 'support': 119383}, 'weighted avg': {'precision': 0.49120362235783277, 'recall': 0.4891567476106313, 'f1-score': 0.48544526477347466, 'support': 119383}}
[[21344 11320  7157]
 [10400 22279  7216]
 [13174 11719 14774]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0507258
{'0': {'precision': 0.44064710117308264, 'recall': 0.5225754608005625, 'f1-score': 0.4781270103850749, 'support': 39822}, '1': {'precision': 0.4473045629728315, 'recall': 0.47642214620549855, 'f1-score': 0.46140443441023815, 'support': 39465}, '2': {'precision': 0.47472031338180126, 'recall': 0.3566440542697526, 'f1-score': 0.4072971702815477, 'support': 40096}, 'accuracy': 0.45158858463935403, 'macro avg': {'precision': 0.45422399250923845, 'recall': 0.4518805537586046, 'f1-score': 0.4489428716922869, 'support': 119383}, 'weighted avg': {'precision': 0.4542917260078403, 'recall': 0.45158858463935403, 'f1-score': 0.44881002446883933, 'support': 119383}}
[[20810 11453  7559]
 [12399 18802  8264]
 [14017 11779 14300]]
training model: results/WBA/W9/deepLOB_L1/seq2seq
Epoch 1/50
1200/1200 - 34s - loss: 12.1359 - accuracy10: 0.4741 - accuracy20: 0.4814 - accuracy30: 0.4785 - accuracy50: 0.4649 - val_loss: 14.3359 - val_accuracy10: 0.2939 - val_accuracy20: 0.3242 - val_accuracy30: 0.3437 - val_accuracy50: 0.3645 - 34s/epoch - 28ms/step
Epoch 2/50
1200/1200 - 27s - loss: 12.0818 - accuracy10: 0.4645 - accuracy20: 0.4820 - accuracy30: 0.4830 - accuracy50: 0.4679 - val_loss: 13.1319 - val_accuracy10: 0.3859 - val_accuracy20: 0.4026 - val_accuracy30: 0.4089 - val_accuracy50: 0.4076 - 27s/epoch - 23ms/step
Epoch 3/50
1200/1200 - 26s - loss: 12.1405 - accuracy10: 0.4564 - accuracy20: 0.4737 - accuracy30: 0.4759 - accuracy50: 0.4627 - val_loss: 13.2045 - val_accuracy10: 0.4100 - val_accuracy20: 0.3915 - val_accuracy30: 0.3823 - val_accuracy50: 0.3736 - 26s/epoch - 22ms/step
Epoch 4/50
1200/1200 - 27s - loss: 12.1055 - accuracy10: 0.4579 - accuracy20: 0.4745 - accuracy30: 0.4758 - accuracy50: 0.4630 - val_loss: 12.7719 - val_accuracy10: 0.3792 - val_accuracy20: 0.3872 - val_accuracy30: 0.3941 - val_accuracy50: 0.4043 - 27s/epoch - 22ms/step
Epoch 5/50
1200/1200 - 27s - loss: 12.0021 - accuracy10: 0.4718 - accuracy20: 0.4852 - accuracy30: 0.4851 - accuracy50: 0.4709 - val_loss: 13.2257 - val_accuracy10: 0.4524 - val_accuracy20: 0.4224 - val_accuracy30: 0.4013 - val_accuracy50: 0.3741 - 27s/epoch - 23ms/step
Epoch 6/50
1200/1200 - 29s - loss: 11.9273 - accuracy10: 0.4820 - accuracy20: 0.4948 - accuracy30: 0.4927 - accuracy50: 0.4764 - val_loss: 13.1236 - val_accuracy10: 0.4941 - val_accuracy20: 0.4425 - val_accuracy30: 0.4094 - val_accuracy50: 0.3733 - 29s/epoch - 24ms/step
Epoch 7/50
1200/1200 - 30s - loss: 11.7883 - accuracy10: 0.4973 - accuracy20: 0.5071 - accuracy30: 0.5031 - accuracy50: 0.4834 - val_loss: 13.1379 - val_accuracy10: 0.4810 - val_accuracy20: 0.4460 - val_accuracy30: 0.4196 - val_accuracy50: 0.3861 - 30s/epoch - 25ms/step
Epoch 8/50
1200/1200 - 27s - loss: 11.7431 - accuracy10: 0.5023 - accuracy20: 0.5101 - accuracy30: 0.5055 - accuracy50: 0.4840 - val_loss: 12.9995 - val_accuracy10: 0.4992 - val_accuracy20: 0.4560 - val_accuracy30: 0.4259 - val_accuracy50: 0.3928 - 27s/epoch - 22ms/step
Epoch 9/50
1200/1200 - 29s - loss: 11.6296 - accuracy10: 0.5176 - accuracy20: 0.5204 - accuracy30: 0.5125 - accuracy50: 0.4885 - val_loss: 12.8286 - val_accuracy10: 0.4914 - val_accuracy20: 0.4615 - val_accuracy30: 0.4432 - val_accuracy50: 0.4210 - 29s/epoch - 24ms/step
Epoch 10/50
1200/1200 - 27s - loss: 11.5600 - accuracy10: 0.5232 - accuracy20: 0.5254 - accuracy30: 0.5170 - accuracy50: 0.4925 - val_loss: 13.2421 - val_accuracy10: 0.5293 - val_accuracy20: 0.4713 - val_accuracy30: 0.4363 - val_accuracy50: 0.3998 - 27s/epoch - 23ms/step
Epoch 11/50
1200/1200 - 29s - loss: 11.4957 - accuracy10: 0.5289 - accuracy20: 0.5304 - accuracy30: 0.5209 - accuracy50: 0.4957 - val_loss: 13.0503 - val_accuracy10: 0.5201 - val_accuracy20: 0.4670 - val_accuracy30: 0.4338 - val_accuracy50: 0.3988 - 29s/epoch - 24ms/step
Epoch 12/50
1200/1200 - 27s - loss: 11.4373 - accuracy10: 0.5350 - accuracy20: 0.5353 - accuracy30: 0.5245 - accuracy50: 0.4975 - val_loss: 13.1216 - val_accuracy10: 0.5338 - val_accuracy20: 0.4699 - val_accuracy30: 0.4293 - val_accuracy50: 0.3862 - 27s/epoch - 23ms/step
Epoch 13/50
1200/1200 - 27s - loss: 11.3904 - accuracy10: 0.5379 - accuracy20: 0.5377 - accuracy30: 0.5274 - accuracy50: 0.5001 - val_loss: 13.1892 - val_accuracy10: 0.5070 - val_accuracy20: 0.4642 - val_accuracy30: 0.4336 - val_accuracy50: 0.3989 - 27s/epoch - 22ms/step
Epoch 14/50
1200/1200 - 27s - loss: 11.3383 - accuracy10: 0.5424 - accuracy20: 0.5411 - accuracy30: 0.5301 - accuracy50: 0.5021 - val_loss: 13.4420 - val_accuracy10: 0.4848 - val_accuracy20: 0.4580 - val_accuracy30: 0.4369 - val_accuracy50: 0.4114 - 27s/epoch - 22ms/step
testing model: results/WBA/W9/deepLOB_L1/seq2seq
Evaluating performance on  test set...
2451/2451 - 24s - 24s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0710541
{'0': {'precision': 0.34904630530139136, 'recall': 0.2648135041937087, 'f1-score': 0.30115076375094185, 'support': 132818}, '1': {'precision': 0.5973749067170029, 'recall': 0.25944547336311147, 'f1-score': 0.3617706092237112, 'support': 367160}, '2': {'precision': 0.2581786584003879, 'recall': 0.7441800208851864, 'f1-score': 0.3833585788621109, 'support': 127363}, 'accuracy': 0.3589929559840661, 'macro avg': {'precision': 0.40153329013959405, 'recall': 0.42281299948066886, 'f1-score': 0.34875998394558794, 'support': 627341}, 'weighted avg': {'precision': 0.4759360720845339, 'recall': 0.3589929559840661, 'f1-score': 0.35331922782356867, 'support': 627341}}
[[ 35172  39452  58194]
 [ 57763  95258 214139]
 [  7831  24751  94781]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0922682
{'0': {'precision': 0.4083055698934822, 'recall': 0.2573449819887496, 'f1-score': 0.3157073609659817, 'support': 169061}, '1': {'precision': 0.4838579807725679, 'recall': 0.23493230786859942, 'f1-score': 0.31629217561754724, 'support': 296711}, '2': {'precision': 0.31544033913692093, 'recall': 0.7354938137885362, 'f1-score': 0.44152037006074796, 'support': 161569}, 'accuracy': 0.36988974098616223, 'macro avg': {'precision': 0.4025346299343237, 'recall': 0.4092570345486284, 'f1-score': 0.3578399688814256, 'support': 627341}, 'weighted avg': {'precision': 0.4201222515964755, 'recall': 0.36988974098616223, 'f1-score': 0.3483865625589159, 'support': 627341}}
[[ 43507  44085  81469]
 [ 50585  69707 176419]
 [ 12463  30273 118833]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1029218
{'0': {'precision': 0.4359797951353444, 'recall': 0.25651872255819735, 'f1-score': 0.32299557977911936, 'support': 193136}, '1': {'precision': 0.4083909790492461, 'recall': 0.2140869509591473, 'f1-score': 0.2809133474103899, 'support': 250118}, '2': {'precision': 0.3489079636580342, 'recall': 0.7251353979368451, 'f1-score': 0.4711271893060396, 'support': 184087}, 'accuracy': 0.37711228821326837, 'macro avg': {'precision': 0.39775957928087485, 'recall': 0.39858035715139656, 'f1-score': 0.358345372165183, 'support': 627341}, 'weighted avg': {'precision': 0.39942989365754156, 'recall': 0.37711228821326837, 'f1-score': 0.34968533831136944, 'support': 627341}}
[[ 49543  44837  98756]
 [ 46227  53547 150344]
 [ 17866  32733 133488]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1172838
{'0': {'precision': 0.4514324614715845, 'recall': 0.2541077834359029, 'f1-score': 0.3251763538183408, 'support': 216601}, '1': {'precision': 0.3275046569321762, 'recall': 0.18879931907144307, 'f1-score': 0.23952035659352733, 'support': 202077}, '2': {'precision': 0.37905765893167065, 'recall': 0.7065219995878522, 'f1-score': 0.49340013521021164, 'support': 208663}, 'accuracy': 0.3835505729738691, 'macro avg': {'precision': 0.38599825911181046, 'recall': 0.3831430340317327, 'f1-score': 0.3526989485406933, 'support': 627341}, 'weighted avg': {'precision': 0.38744030667810525, 'recall': 0.3835505729738691, 'f1-score': 0.3535388742743182, 'support': 627341}}
[[ 55040  43419 118142]
 [ 40567  38152 123358]
 [ 26316  34922 147425]]
Evaluating performance on  train set...
1200/1200 - 11s - 11s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0440924
{'0': {'precision': 0.314440458940067, 'recall': 0.40912392402911496, 'f1-score': 0.35558719434799835, 'support': 64709}, '1': {'precision': 0.5879621751707709, 'recall': 0.2715748579641149, 'f1-score': 0.3715389519120731, 'support': 178124}, '2': {'precision': 0.3047630560928433, 'recall': 0.6669415957297811, 'f1-score': 0.4183558421147679, 'support': 64259}, 'accuracy': 0.38328904693056154, 'macro avg': {'precision': 0.40238856340122703, 'recall': 0.4492134592410036, 'f1-score': 0.38182732945827974, 'support': 307092}, 'weighted avg': {'precision': 0.47106753470992796, 'recall': 0.38328904693056154, 'f1-score': 0.3779741057660363, 'support': 307092}}
[[26474 19243 18992]
 [50975 48374 78775]
 [ 6745 14657 42857]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.057253
{'0': {'precision': 0.376601929667794, 'recall': 0.41008239829537757, 'f1-score': 0.3926297169811321, 'support': 81191}, '1': {'precision': 0.47592625493706525, 'recall': 0.23976370634040883, 'f1-score': 0.31888065783328906, 'support': 145243}, '2': {'precision': 0.36388751443179945, 'recall': 0.6564754891021349, 'f1-score': 0.4682318609895212, 'support': 80658}, 'accuracy': 0.39424341891029396, 'macro avg': {'precision': 0.40547189967888625, 'recall': 0.43544053124597376, 'f1-score': 0.3932474119346474, 'support': 307092}, 'weighted avg': {'precision': 0.42023915783062443, 'recall': 0.39424341891029396, 'f1-score': 0.3776061511885308, 'support': 307092}}
[[33295 21406 26490]
 [44347 34824 66072]
 [10767 16941 52950]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0651523
{'0': {'precision': 0.4070984251149437, 'recall': 0.4258171214692954, 'f1-score': 0.41624743408387493, 'support': 91908}, '1': {'precision': 0.39959786837545364, 'recall': 0.19753535353535354, 'f1-score': 0.26437887997231296, 'support': 123750}, '2': {'precision': 0.3965310046466912, 'recall': 0.6495833059912067, 'f1-score': 0.49245081212844816, 'support': 91434}, 'accuracy': 0.400450028004637, 'macro avg': {'precision': 0.4010757660456962, 'recall': 0.4243119269986186, 'f1-score': 0.391025708728212, 'support': 307092}, 'weighted avg': {'precision': 0.4009295395053997, 'recall': 0.400450028004637, 'f1-score': 0.3777373006281734, 'support': 307092}}
[[39136 20215 32557]
 [41472 24445 57833]
 [15526 16514 59394]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.077886
{'0': {'precision': 0.4325882319750985, 'recall': 0.44609193173002326, 'f1-score': 0.43923631832482724, 'support': 103120}, '1': {'precision': 0.3197597928956415, 'recall': 0.1488899208568408, 'f1-score': 0.20317524522196379, 'support': 101209}, '2': {'precision': 0.4217813275010252, 'recall': 0.6305479598688244, 'f1-score': 0.5054565310659542, 'support': 102763}, 'accuracy': 0.40986740129993615, 'macro avg': {'precision': 0.39137645079058836, 'recall': 0.40850993748522946, 'f1-score': 0.38262269820424843, 'support': 307092}, 'weighted avg': {'precision': 0.39178676721775557, 'recall': 0.40986740129993615, 'f1-score': 0.3835965835686263, 'support': 307092}}
[[46001 17149 39970]
 [37280 15069 48860]
 [23058 14908 64797]]
Evaluating performance on  val set...
441/441 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0465733
{'0': {'precision': 0.31088560885608857, 'recall': 0.48960813592154645, 'f1-score': 0.3802955973857029, 'support': 24779}, '1': {'precision': 0.5589888574754698, 'recall': 0.2613238792741522, 'f1-score': 0.3561498686106638, 'support': 64311}, '2': {'precision': 0.3180662160614045, 'recall': 0.5871256978514634, 'f1-score': 0.4126083015054467, 'support': 23644}, 'accuracy': 0.37983217130590596, 'macro avg': {'precision': 0.39598022746432093, 'recall': 0.4460192376823873, 'f1-score': 0.38301792250060446, 'support': 112734}, 'weighted avg': {'precision': 0.4539262735954176, 'recall': 0.37983217130590596, 'f1-score': 0.3732982905657168, 'support': 112734}}
[[12132  6985  5662]
 [23404 16806 24101]
 [ 3488  6274 13882]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.060555
{'0': {'precision': 0.3659049762685326, 'recall': 0.4858052361463003, 'f1-score': 0.41741557354172487, 'support': 30786}, '1': {'precision': 0.4459742592038312, 'recall': 0.22657289488690363, 'f1-score': 0.3004865260026721, 'support': 52610}, '2': {'precision': 0.3751218647522822, 'recall': 0.5770672847501533, 'f1-score': 0.4546797368067679, 'support': 29338}, 'accuracy': 0.3885784235456916, 'macro avg': {'precision': 0.39566703340821535, 'recall': 0.4298151385944524, 'f1-score': 0.390860612117055, 'support': 112734}, 'weighted avg': {'precision': 0.40566982138679597, 'recall': 0.3885784235456916, 'f1-score': 0.3725455150929895, 'support': 112734}}
[[14956  7746  8084]
 [20572 11920 20118]
 [ 5346  7062 16930]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0683206
{'0': {'precision': 0.394151404988911, 'recall': 0.49763293112406903, 'f1-score': 0.43988823536916777, 'support': 34642}, '1': {'precision': 0.3767583827302486, 'recall': 0.18823763426601248, 'f1-score': 0.2510463950952072, 'support': 45246}, '2': {'precision': 0.40475523269599706, 'recall': 0.5716677829872739, 'f1-score': 0.4739452528490478, 'support': 32846}, 'accuracy': 0.3950272322458176, 'macro avg': {'precision': 0.3918883401383855, 'recall': 0.4191794494591185, 'f1-score': 0.38829329443780763, 'support': 112734}, 'weighted avg': {'precision': 0.39026019772004367, 'recall': 0.3950272322458176, 'f1-score': 0.37401901127624565, 'support': 112734}}
[[17239  7384 10019]
 [19134  8517 17595]
 [ 7364  6705 18777]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0795708
{'0': {'precision': 0.41753763645193304, 'recall': 0.5146389069616135, 'f1-score': 0.46103093744900103, 'support': 38425}, '1': {'precision': 0.3060644873865345, 'recall': 0.14545069602498278, 'f1-score': 0.1971906786502341, 'support': 37786}, '2': {'precision': 0.42738737978741353, 'recall': 0.5548558442625195, 'f1-score': 0.4828506415373069, 'support': 36523}, 'accuracy': 0.4039242819380134, 'macro avg': {'precision': 0.3836631678752937, 'recall': 0.4049818157497053, 'f1-score': 0.38035741921218064, 'support': 112734}, 'weighted avg': {'precision': 0.38336531723374334, 'recall': 0.4039242819380134, 'f1-score': 0.3796664248214618, 'support': 112734}}
[[19775  6490 12160]
 [17299  5496 14991]
 [10287  5971 20265]]
training model: results/WBA/W9/deepOF_L1/seq2seq
Epoch 1/50
1200/1200 - 31s - loss: 12.8096 - accuracy10: 0.4178 - accuracy20: 0.4269 - accuracy30: 0.4262 - accuracy50: 0.4188 - val_loss: 12.8673 - val_accuracy10: 0.3607 - val_accuracy20: 0.3737 - val_accuracy30: 0.3807 - val_accuracy50: 0.3958 - 31s/epoch - 26ms/step
Epoch 2/50
1200/1200 - 24s - loss: 12.7741 - accuracy10: 0.4058 - accuracy20: 0.4160 - accuracy30: 0.4177 - accuracy50: 0.4126 - val_loss: 12.8293 - val_accuracy10: 0.3153 - val_accuracy20: 0.3471 - val_accuracy30: 0.3687 - val_accuracy50: 0.3974 - 24s/epoch - 20ms/step
Epoch 3/50
1200/1200 - 26s - loss: 12.7449 - accuracy10: 0.4145 - accuracy20: 0.4215 - accuracy30: 0.4204 - accuracy50: 0.4101 - val_loss: 12.7956 - val_accuracy10: 0.3002 - val_accuracy20: 0.3418 - val_accuracy30: 0.3700 - val_accuracy50: 0.3993 - 26s/epoch - 21ms/step
Epoch 4/50
1200/1200 - 24s - loss: 12.7142 - accuracy10: 0.4160 - accuracy20: 0.4222 - accuracy30: 0.4202 - accuracy50: 0.4105 - val_loss: 12.7942 - val_accuracy10: 0.2909 - val_accuracy20: 0.3388 - val_accuracy30: 0.3694 - val_accuracy50: 0.3994 - 24s/epoch - 20ms/step
Epoch 5/50
1200/1200 - 27s - loss: 12.6891 - accuracy10: 0.4165 - accuracy20: 0.4226 - accuracy30: 0.4213 - accuracy50: 0.4113 - val_loss: 12.7838 - val_accuracy10: 0.2924 - val_accuracy20: 0.3388 - val_accuracy30: 0.3688 - val_accuracy50: 0.3992 - 27s/epoch - 22ms/step
Epoch 6/50
1200/1200 - 26s - loss: 12.6690 - accuracy10: 0.4207 - accuracy20: 0.4249 - accuracy30: 0.4233 - accuracy50: 0.4130 - val_loss: 12.7637 - val_accuracy10: 0.2999 - val_accuracy20: 0.3429 - val_accuracy30: 0.3705 - val_accuracy50: 0.3998 - 26s/epoch - 22ms/step
Epoch 7/50
1200/1200 - 24s - loss: 12.6528 - accuracy10: 0.4245 - accuracy20: 0.4274 - accuracy30: 0.4253 - accuracy50: 0.4143 - val_loss: 12.7582 - val_accuracy10: 0.3053 - val_accuracy20: 0.3454 - val_accuracy30: 0.3721 - val_accuracy50: 0.4008 - 24s/epoch - 20ms/step
Epoch 8/50
1200/1200 - 24s - loss: 12.6325 - accuracy10: 0.4270 - accuracy20: 0.4285 - accuracy30: 0.4266 - accuracy50: 0.4155 - val_loss: 12.7605 - val_accuracy10: 0.3036 - val_accuracy20: 0.3463 - val_accuracy30: 0.3730 - val_accuracy50: 0.4015 - 24s/epoch - 20ms/step
Epoch 9/50
1200/1200 - 26s - loss: 12.6135 - accuracy10: 0.4311 - accuracy20: 0.4320 - accuracy30: 0.4291 - accuracy50: 0.4181 - val_loss: 12.7533 - val_accuracy10: 0.3153 - val_accuracy20: 0.3509 - val_accuracy30: 0.3748 - val_accuracy50: 0.4010 - 26s/epoch - 22ms/step
Epoch 10/50
1200/1200 - 26s - loss: 12.5953 - accuracy10: 0.4330 - accuracy20: 0.4333 - accuracy30: 0.4302 - accuracy50: 0.4192 - val_loss: 12.7318 - val_accuracy10: 0.3323 - val_accuracy20: 0.3595 - val_accuracy30: 0.3797 - val_accuracy50: 0.4042 - 26s/epoch - 22ms/step
Epoch 11/50
1200/1200 - 24s - loss: 12.5753 - accuracy10: 0.4361 - accuracy20: 0.4351 - accuracy30: 0.4312 - accuracy50: 0.4206 - val_loss: 12.7280 - val_accuracy10: 0.3342 - val_accuracy20: 0.3621 - val_accuracy30: 0.3807 - val_accuracy50: 0.4038 - 24s/epoch - 20ms/step
Epoch 12/50
1200/1200 - 27s - loss: 12.5546 - accuracy10: 0.4385 - accuracy20: 0.4386 - accuracy30: 0.4344 - accuracy50: 0.4237 - val_loss: 12.7185 - val_accuracy10: 0.3533 - val_accuracy20: 0.3733 - val_accuracy30: 0.3866 - val_accuracy50: 0.4053 - 27s/epoch - 22ms/step
Epoch 13/50
1200/1200 - 24s - loss: 12.5307 - accuracy10: 0.4419 - accuracy20: 0.4422 - accuracy30: 0.4380 - accuracy50: 0.4270 - val_loss: 12.7095 - val_accuracy10: 0.3615 - val_accuracy20: 0.3772 - val_accuracy30: 0.3887 - val_accuracy50: 0.4069 - 24s/epoch - 20ms/step
Epoch 14/50
1200/1200 - 24s - loss: 12.5096 - accuracy10: 0.4455 - accuracy20: 0.4446 - accuracy30: 0.4401 - accuracy50: 0.4289 - val_loss: 12.6992 - val_accuracy10: 0.3778 - val_accuracy20: 0.3870 - val_accuracy30: 0.3944 - val_accuracy50: 0.4087 - 24s/epoch - 20ms/step
Epoch 15/50
1200/1200 - 26s - loss: 12.4866 - accuracy10: 0.4475 - accuracy20: 0.4469 - accuracy30: 0.4426 - accuracy50: 0.4316 - val_loss: 12.6969 - val_accuracy10: 0.3891 - val_accuracy20: 0.3941 - val_accuracy30: 0.3995 - val_accuracy50: 0.4105 - 26s/epoch - 22ms/step
Epoch 16/50
1200/1200 - 27s - loss: 12.4613 - accuracy10: 0.4480 - accuracy20: 0.4485 - accuracy30: 0.4453 - accuracy50: 0.4344 - val_loss: 12.6837 - val_accuracy10: 0.3951 - val_accuracy20: 0.4015 - val_accuracy30: 0.4046 - val_accuracy50: 0.4127 - 27s/epoch - 23ms/step
Epoch 17/50
1200/1200 - 26s - loss: 12.4441 - accuracy10: 0.4476 - accuracy20: 0.4487 - accuracy30: 0.4459 - accuracy50: 0.4355 - val_loss: 12.6733 - val_accuracy10: 0.3977 - val_accuracy20: 0.4025 - val_accuracy30: 0.4063 - val_accuracy50: 0.4141 - 26s/epoch - 22ms/step
Epoch 18/50
1200/1200 - 27s - loss: 12.4148 - accuracy10: 0.4506 - accuracy20: 0.4524 - accuracy30: 0.4499 - accuracy50: 0.4385 - val_loss: 12.6635 - val_accuracy10: 0.3995 - val_accuracy20: 0.4064 - val_accuracy30: 0.4091 - val_accuracy50: 0.4164 - 27s/epoch - 22ms/step
Epoch 19/50
1200/1200 - 26s - loss: 12.3928 - accuracy10: 0.4506 - accuracy20: 0.4544 - accuracy30: 0.4534 - accuracy50: 0.4424 - val_loss: 12.6636 - val_accuracy10: 0.3903 - val_accuracy20: 0.4019 - val_accuracy30: 0.4080 - val_accuracy50: 0.4166 - 26s/epoch - 22ms/step
Epoch 20/50
1200/1200 - 27s - loss: 12.3638 - accuracy10: 0.4501 - accuracy20: 0.4558 - accuracy30: 0.4543 - accuracy50: 0.4444 - val_loss: 12.6558 - val_accuracy10: 0.3836 - val_accuracy20: 0.3980 - val_accuracy30: 0.4071 - val_accuracy50: 0.4167 - 27s/epoch - 22ms/step
Epoch 21/50
1200/1200 - 24s - loss: 12.3350 - accuracy10: 0.4513 - accuracy20: 0.4580 - accuracy30: 0.4567 - accuracy50: 0.4470 - val_loss: 12.6184 - val_accuracy10: 0.3948 - val_accuracy20: 0.4063 - val_accuracy30: 0.4141 - val_accuracy50: 0.4203 - 24s/epoch - 20ms/step
Epoch 22/50
1200/1200 - 23s - loss: 12.3132 - accuracy10: 0.4521 - accuracy20: 0.4598 - accuracy30: 0.4592 - accuracy50: 0.4485 - val_loss: 12.6209 - val_accuracy10: 0.3972 - val_accuracy20: 0.4068 - val_accuracy30: 0.4139 - val_accuracy50: 0.4208 - 23s/epoch - 19ms/step
Epoch 23/50
1200/1200 - 26s - loss: 12.2782 - accuracy10: 0.4546 - accuracy20: 0.4630 - accuracy30: 0.4631 - accuracy50: 0.4531 - val_loss: 12.6103 - val_accuracy10: 0.4103 - val_accuracy20: 0.4170 - val_accuracy30: 0.4212 - val_accuracy50: 0.4244 - 26s/epoch - 22ms/step
Epoch 24/50
1200/1200 - 26s - loss: 12.2602 - accuracy10: 0.4557 - accuracy20: 0.4640 - accuracy30: 0.4643 - accuracy50: 0.4540 - val_loss: 12.6059 - val_accuracy10: 0.4169 - val_accuracy20: 0.4194 - val_accuracy30: 0.4227 - val_accuracy50: 0.4254 - 26s/epoch - 22ms/step
Epoch 25/50
1200/1200 - 25s - loss: 12.2243 - accuracy10: 0.4584 - accuracy20: 0.4666 - accuracy30: 0.4678 - accuracy50: 0.4578 - val_loss: 12.6089 - val_accuracy10: 0.4177 - val_accuracy20: 0.4192 - val_accuracy30: 0.4210 - val_accuracy50: 0.4250 - 25s/epoch - 21ms/step
Epoch 26/50
1200/1200 - 23s - loss: 12.1997 - accuracy10: 0.4614 - accuracy20: 0.4696 - accuracy30: 0.4699 - accuracy50: 0.4597 - val_loss: 12.5664 - val_accuracy10: 0.4133 - val_accuracy20: 0.4182 - val_accuracy30: 0.4247 - val_accuracy50: 0.4295 - 23s/epoch - 19ms/step
Epoch 27/50
1200/1200 - 25s - loss: 12.1749 - accuracy10: 0.4635 - accuracy20: 0.4714 - accuracy30: 0.4725 - accuracy50: 0.4629 - val_loss: 12.5819 - val_accuracy10: 0.4189 - val_accuracy20: 0.4233 - val_accuracy30: 0.4260 - val_accuracy50: 0.4297 - 25s/epoch - 21ms/step
Epoch 28/50
1200/1200 - 24s - loss: 12.1535 - accuracy10: 0.4651 - accuracy20: 0.4739 - accuracy30: 0.4748 - accuracy50: 0.4640 - val_loss: 12.5818 - val_accuracy10: 0.4309 - val_accuracy20: 0.4315 - val_accuracy30: 0.4318 - val_accuracy50: 0.4315 - 24s/epoch - 20ms/step
Epoch 29/50
1200/1200 - 26s - loss: 12.1268 - accuracy10: 0.4669 - accuracy20: 0.4764 - accuracy30: 0.4774 - accuracy50: 0.4673 - val_loss: 12.5952 - val_accuracy10: 0.4208 - val_accuracy20: 0.4238 - val_accuracy30: 0.4281 - val_accuracy50: 0.4291 - 26s/epoch - 22ms/step
Epoch 30/50
1200/1200 - 24s - loss: 12.0958 - accuracy10: 0.4680 - accuracy20: 0.4778 - accuracy30: 0.4794 - accuracy50: 0.4700 - val_loss: 12.5943 - val_accuracy10: 0.4210 - val_accuracy20: 0.4258 - val_accuracy30: 0.4293 - val_accuracy50: 0.4302 - 24s/epoch - 20ms/step
Epoch 31/50
1200/1200 - 25s - loss: 12.0750 - accuracy10: 0.4702 - accuracy20: 0.4803 - accuracy30: 0.4823 - accuracy50: 0.4716 - val_loss: 12.5811 - val_accuracy10: 0.4361 - val_accuracy20: 0.4345 - val_accuracy30: 0.4364 - val_accuracy50: 0.4342 - 25s/epoch - 21ms/step
Epoch 32/50
1200/1200 - 25s - loss: 12.0518 - accuracy10: 0.4715 - accuracy20: 0.4826 - accuracy30: 0.4841 - accuracy50: 0.4738 - val_loss: 12.6077 - val_accuracy10: 0.4167 - val_accuracy20: 0.4218 - val_accuracy30: 0.4274 - val_accuracy50: 0.4307 - 25s/epoch - 21ms/step
Epoch 33/50
1200/1200 - 24s - loss: 12.0301 - accuracy10: 0.4723 - accuracy20: 0.4840 - accuracy30: 0.4869 - accuracy50: 0.4757 - val_loss: 12.6051 - val_accuracy10: 0.4205 - val_accuracy20: 0.4242 - val_accuracy30: 0.4278 - val_accuracy50: 0.4303 - 24s/epoch - 20ms/step
Epoch 34/50
1200/1200 - 25s - loss: 12.0027 - accuracy10: 0.4746 - accuracy20: 0.4855 - accuracy30: 0.4881 - accuracy50: 0.4780 - val_loss: 12.6074 - val_accuracy10: 0.4267 - val_accuracy20: 0.4277 - val_accuracy30: 0.4321 - val_accuracy50: 0.4317 - 25s/epoch - 21ms/step
Epoch 35/50
1200/1200 - 27s - loss: 11.9753 - accuracy10: 0.4770 - accuracy20: 0.4886 - accuracy30: 0.4901 - accuracy50: 0.4798 - val_loss: 12.6133 - val_accuracy10: 0.4308 - val_accuracy20: 0.4299 - val_accuracy30: 0.4318 - val_accuracy50: 0.4329 - 27s/epoch - 22ms/step
Epoch 36/50
1200/1200 - 26s - loss: 11.9536 - accuracy10: 0.4780 - accuracy20: 0.4902 - accuracy30: 0.4929 - accuracy50: 0.4824 - val_loss: 12.6364 - val_accuracy10: 0.4330 - val_accuracy20: 0.4308 - val_accuracy30: 0.4330 - val_accuracy50: 0.4325 - 26s/epoch - 22ms/step
testing model: results/WBA/W9/deepOF_L1/seq2seq
Evaluating performance on  test set...
2451/2451 - 23s - 23s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0591922
{'0': {'precision': 0.29517464163133456, 'recall': 0.49533948711771, 'f1-score': 0.36991535072799503, 'support': 132818}, '1': {'precision': 0.6695464642605029, 'recall': 0.28157828079932673, 'f1-score': 0.39643536413276886, 'support': 367159}, '2': {'precision': 0.2850709677935395, 'recall': 0.5596733668341709, 'f1-score': 0.3777394456323877, 'support': 127360}, 'accuracy': 0.3832931901035648, 'macro avg': {'precision': 0.41659735789512564, 'recall': 0.44553037825040254, 'f1-score': 0.3813633868310505, 'support': 627337}, 'weighted avg': {'precision': 0.5122305145110169, 'recall': 0.3832931901035648, 'f1-score': 0.3870250355205497, 'support': 627337}}
[[ 65790  27311  39717]
 [124729 103384 139046]
 [ 32366  23714  71280]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0676138
{'0': {'precision': 0.3521046690779663, 'recall': 0.5055719862770613, 'f1-score': 0.4151080848749168, 'support': 169060}, '1': {'precision': 0.5664572748267899, 'recall': 0.2066630716861582, 'f1-score': 0.30283978664559463, 'support': 296710}, '2': {'precision': 0.3360811461201921, 'recall': 0.5748265425489116, 'f1-score': 0.4241667199503092, 'support': 161567}, 'accuracy': 0.38203389884543715, 'macro avg': {'precision': 0.41821436334164935, 'recall': 0.42902053350404373, 'f1-score': 0.38070486382360685, 'support': 627337}, 'weighted avg': {'precision': 0.44935971559684645, 'recall': 0.38203389884543715, 'f1-score': 0.3643418296175412, 'support': 627337}}
[[ 85472  24785  58803]
 [110726  61319 124665]
 [ 46548  22146  92873]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0720494
{'0': {'precision': 0.38734357464370617, 'recall': 0.4985813105790738, 'f1-score': 0.43597887430756316, 'support': 193136}, '1': {'precision': 0.49496853942612346, 'recall': 0.17738427462237824, 'f1-score': 0.26117131807131044, 'support': 250118}, '2': {'precision': 0.3672258734002075, 'recall': 0.5767235431843245, 'f1-score': 0.44872702527352, 'support': 184083}, 'accuracy': 0.3934504102260826, 'macro avg': {'precision': 0.41651266249001234, 'recall': 0.4175630427952588, 'f1-score': 0.3819590725507979, 'support': 627337}, 'weighted avg': {'precision': 0.4243501821663641, 'recall': 0.3934504102260826, 'f1-score': 0.37002421440956124, 'support': 627337}}
[[ 96294  23719  73123]
 [ 95939  44367 109812]
 [ 56368  21550 106165]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0778569
{'0': {'precision': 0.41662052289195983, 'recall': 0.4828371060152077, 'f1-score': 0.447291436783084, 'support': 216601}, '1': {'precision': 0.40120016036625583, 'recall': 0.1535157390499661, 'f1-score': 0.22206156048675735, 'support': 202077}, '2': {'precision': 0.3976794977708061, 'recall': 0.5698340354358068, 'f1-score': 0.46844060624923667, 'support': 208659}, 'accuracy': 0.4056926341025637, 'macro avg': {'precision': 0.40516672700967393, 'recall': 0.40206229350032685, 'f1-score': 0.3792645345063594, 'support': 627337}, 'weighted avg': {'precision': 0.405353347579709, 'recall': 0.4056926341025637, 'f1-score': 0.3817751143587812, 'support': 627337}}
[[104583  23694  88324]
 [ 79293  31022  91762]
 [ 67151  22607 118901]]
Evaluating performance on  train set...
1200/1200 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0336356
{'0': {'precision': 0.3127303529751016, 'recall': 0.535944280573873, 'f1-score': 0.3949830415879447, 'support': 64753}, '1': {'precision': 0.6983566844857505, 'recall': 0.33657958844595126, 'f1-score': 0.4542359014760413, 'support': 178154}, '2': {'precision': 0.31310428646579713, 'recall': 0.5378694629251648, 'f1-score': 0.39580359446212054, 'support': 64181}, 'accuracy': 0.42068722971916844, 'macro avg': {'precision': 0.4413971079755497, 'recall': 0.4701311106483297, 'f1-score': 0.4150075125087022, 'support': 307088}, 'weighted avg': {'precision': 0.5365257239740155, 'recall': 0.42068722971916844, 'f1-score': 0.4295294839905181, 'support': 307088}}
[[34704 13378 16671]
 [59129 59963 59062]
 [17138 12522 34521]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0410705
{'0': {'precision': 0.3683357842526358, 'recall': 0.545259999016087, 'f1-score': 0.43966658567667144, 'support': 81308}, '1': {'precision': 0.6095225044156161, 'recall': 0.2757354713836023, 'f1-score': 0.37970169073533944, 'support': 145179}, '2': {'precision': 0.36677709026922983, 'recall': 0.5508368382526272, 'f1-score': 0.4403471361269527, 'support': 80601}, 'accuracy': 0.4193032616057938, 'macro avg': {'precision': 0.44821179297916053, 'recall': 0.4572774362174388, 'f1-score': 0.41990513751298786, 'support': 307088}, 'weighted avg': {'precision': 0.48195017020319336, 'recall': 0.4193032616057938, 'f1-score': 0.4114961901032706, 'support': 307088}}
[[44334 13197 23777]
 [52274 40031 52874]
 [23755 12448 44398]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0474212
{'0': {'precision': 0.40064620355411956, 'recall': 0.5393004316578052, 'f1-score': 0.45974667587395895, 'support': 91971}, '1': {'precision': 0.5397335299383854, 'recall': 0.24842647878675253, 'f1-score': 0.34024588621952706, 'support': 123767}, '2': {'precision': 0.3986352229637194, 'recall': 0.5512424740010947, 'f1-score': 0.46267991602004854, 'support': 91350}, 'accuracy': 0.42562066899390405, 'macro avg': {'precision': 0.4463383188187415, 'recall': 0.44632312814855074, 'f1-score': 0.42089082603784483, 'support': 307088}, 'weighted avg': {'precision': 0.4561049582031726, 'recall': 0.42562066899390405, 'f1-score': 0.4124563136787094, 'support': 307088}}
[[49600 13592 28779]
 [45834 30747 47186]
 [28366 12628 50356]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0575775
{'0': {'precision': 0.42974268818922806, 'recall': 0.5212359703025956, 'f1-score': 0.47108806293087596, 'support': 103174}, '1': {'precision': 0.4418139055727253, 'recall': 0.22470021847227578, 'f1-score': 0.29789520589237506, 'support': 101157}, '2': {'precision': 0.42836453360510646, 'recall': 0.5440213318800665, 'f1-score': 0.4793147501907759, 'support': 102757}, 'accuracy': 0.43117933621632887, 'macro avg': {'precision': 0.43330704245568663, 'recall': 0.4299858402183127, 'f1-score': 0.4160993396713423, 'support': 307088}, 'weighted avg': {'precision': 0.4332578796205502, 'recall': 0.43117933621632887, 'f1-score': 0.4167898808570792, 'support': 307088}}
[[53778 14976 34420]
 [38248 22730 40179]
 [33114 13741 55902]]
Evaluating performance on  val set...
441/441 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0397981
{'0': {'precision': 0.31687388987566606, 'recall': 0.5412840325255877, 'f1-score': 0.39973709369024857, 'support': 24719}, '1': {'precision': 0.6924686192468619, 'recall': 0.31926445650990215, 'f1-score': 0.43703348772826495, 'support': 64279}, '2': {'precision': 0.3128471117852861, 'recall': 0.5387175598247388, 'f1-score': 0.39582720673590366, 'support': 23736}, 'accuracy': 0.41415189738676883, 'macro avg': {'precision': 0.44072987363593796, 'recall': 0.4664220162867429, 'f1-score': 0.41086592938480576, 'support': 112734}, 'weighted avg': {'precision': 0.5301837520689514, 'recall': 0.41415189738676883, 'f1-score': 0.4201796384027694, 'support': 112734}}
[[13380  4663  6676]
 [22347 20522 21410]
 [ 6498  4451 12787]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0445006
{'0': {'precision': 0.3713330528925986, 'recall': 0.5449701065765532, 'f1-score': 0.4416996958245, 'support': 30776}, '1': {'precision': 0.60733729793115, 'recall': 0.2761654478976234, 'f1-score': 0.3796832046079329, 'support': 52512}, '2': {'precision': 0.3640733365378013, 'recall': 0.5401752360252666, 'f1-score': 0.434976413481917, 'support': 29446}, 'accuracy': 0.41850728262990755, 'macro avg': {'precision': 0.4475812291205166, 'recall': 0.4537702634998144, 'f1-score': 0.41878643797144993, 'support': 112734}, 'weighted avg': {'precision': 0.4793686526910716, 'recall': 0.41850728262990755, 'f1-score': 0.411056023475217, 'support': 112734}}
[[16772  4741  9263]
 [19490 14502 18520]
 [ 8905  4635 15906]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.050791
{'0': {'precision': 0.40178262374524054, 'recall': 0.5364994078054135, 'f1-score': 0.45946982348065957, 'support': 34617}, '1': {'precision': 0.5421882243857209, 'recall': 0.2592206755918078, 'f1-score': 0.3507482829979306, 'support': 45116}, '2': {'precision': 0.3923898531375167, 'recall': 0.534347444016848, 'f1-score': 0.45249611885913704, 'support': 33001}, 'accuracy': 0.4249028686997711, 'macro avg': {'precision': 0.44545356708949274, 'recall': 0.44335584247135645, 'f1-score': 0.4209047417792424, 'support': 112734}, 'weighted avg': {'precision': 0.4552231852055844, 'recall': 0.4249028686997711, 'f1-score': 0.4139181687302412, 'support': 112734}}
[[18572  5030 11015]
 [17130 11695 16291]
 [10522  4845 17634]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0591581
{'0': {'precision': 0.42933077169388406, 'recall': 0.5236000104136835, 'f1-score': 0.4718025710800412, 'support': 38411}, '1': {'precision': 0.4570757545472716, 'recall': 0.24260025461489498, 'f1-score': 0.3169658326980387, 'support': 37704}, '2': {'precision': 0.41576389040259826, 'recall': 0.5208771402823671, 'f1-score': 0.462422420480993, 'support': 36619}, 'accuracy': 0.42873489807866305, 'macro avg': {'precision': 0.434056805547918, 'recall': 0.42902580177031524, 'f1-score': 0.4170636080863576, 'support': 112734}, 'weighted avg': {'precision': 0.43420322550106316, 'recall': 0.42873489807866305, 'f1-score': 0.4169703454982152, 'support': 112734}}
[[20112  5493 12806]
 [14560  9147 13997]
 [12173  5372 19074]]
training model: results/WBA/W9/deepLOB_L2/seq2seq
Epoch 1/50
1200/1200 - 66s - loss: 12.3024 - accuracy10: 0.4618 - accuracy20: 0.4684 - accuracy30: 0.4659 - accuracy50: 0.4523 - val_loss: 13.7914 - val_accuracy10: 0.4875 - val_accuracy20: 0.4170 - val_accuracy30: 0.3775 - val_accuracy50: 0.3411 - 66s/epoch - 55ms/step
Epoch 2/50
1200/1200 - 58s - loss: 12.0825 - accuracy10: 0.4673 - accuracy20: 0.4811 - accuracy30: 0.4818 - accuracy50: 0.4671 - val_loss: 13.6620 - val_accuracy10: 0.4471 - val_accuracy20: 0.4175 - val_accuracy30: 0.3981 - val_accuracy50: 0.3762 - 58s/epoch - 49ms/step
Epoch 3/50
1200/1200 - 57s - loss: 11.8546 - accuracy10: 0.4857 - accuracy20: 0.5011 - accuracy30: 0.5003 - accuracy50: 0.4825 - val_loss: 14.2532 - val_accuracy10: 0.5174 - val_accuracy20: 0.4510 - val_accuracy30: 0.4085 - val_accuracy50: 0.3625 - 57s/epoch - 48ms/step
Epoch 4/50
1200/1200 - 56s - loss: 11.5752 - accuracy10: 0.5220 - accuracy20: 0.5279 - accuracy30: 0.5202 - accuracy50: 0.4953 - val_loss: 11.8927 - val_accuracy10: 0.4784 - val_accuracy20: 0.4942 - val_accuracy30: 0.4951 - val_accuracy50: 0.4815 - 56s/epoch - 47ms/step
Epoch 5/50
1200/1200 - 57s - loss: 11.3395 - accuracy10: 0.5485 - accuracy20: 0.5466 - accuracy30: 0.5340 - accuracy50: 0.5037 - val_loss: 11.4800 - val_accuracy10: 0.5248 - val_accuracy20: 0.5296 - val_accuracy30: 0.5225 - val_accuracy50: 0.4995 - 57s/epoch - 47ms/step
Epoch 6/50
1200/1200 - 57s - loss: 11.1523 - accuracy10: 0.5627 - accuracy20: 0.5579 - accuracy30: 0.5431 - accuracy50: 0.5102 - val_loss: 11.2896 - val_accuracy10: 0.5796 - val_accuracy20: 0.5658 - val_accuracy30: 0.5477 - val_accuracy50: 0.5112 - 57s/epoch - 47ms/step
Epoch 7/50
1200/1200 - 57s - loss: 11.0023 - accuracy10: 0.5743 - accuracy20: 0.5687 - accuracy30: 0.5525 - accuracy50: 0.5171 - val_loss: 11.2514 - val_accuracy10: 0.5761 - val_accuracy20: 0.5630 - val_accuracy30: 0.5445 - val_accuracy50: 0.5104 - 57s/epoch - 47ms/step
Epoch 8/50
1200/1200 - 57s - loss: 10.9088 - accuracy10: 0.5813 - accuracy20: 0.5736 - accuracy30: 0.5567 - accuracy50: 0.5206 - val_loss: 11.2129 - val_accuracy10: 0.5804 - val_accuracy20: 0.5652 - val_accuracy30: 0.5463 - val_accuracy50: 0.5107 - 57s/epoch - 47ms/step
Epoch 9/50
1200/1200 - 57s - loss: 10.8379 - accuracy10: 0.5833 - accuracy20: 0.5774 - accuracy30: 0.5600 - accuracy50: 0.5234 - val_loss: 11.2067 - val_accuracy10: 0.5857 - val_accuracy20: 0.5674 - val_accuracy30: 0.5457 - val_accuracy50: 0.5076 - 57s/epoch - 47ms/step
Epoch 10/50
1200/1200 - 57s - loss: 10.7842 - accuracy10: 0.5865 - accuracy20: 0.5804 - accuracy30: 0.5631 - accuracy50: 0.5259 - val_loss: 11.1534 - val_accuracy10: 0.5851 - val_accuracy20: 0.5697 - val_accuracy30: 0.5477 - val_accuracy50: 0.5097 - 57s/epoch - 48ms/step
Epoch 11/50
1200/1200 - 57s - loss: 10.7402 - accuracy10: 0.5890 - accuracy20: 0.5820 - accuracy30: 0.5648 - accuracy50: 0.5278 - val_loss: 11.1938 - val_accuracy10: 0.5909 - val_accuracy20: 0.5716 - val_accuracy30: 0.5485 - val_accuracy50: 0.5088 - 57s/epoch - 47ms/step
Epoch 12/50
1200/1200 - 57s - loss: 10.7061 - accuracy10: 0.5901 - accuracy20: 0.5839 - accuracy30: 0.5672 - accuracy50: 0.5303 - val_loss: 11.1931 - val_accuracy10: 0.5880 - val_accuracy20: 0.5699 - val_accuracy30: 0.5477 - val_accuracy50: 0.5088 - 57s/epoch - 47ms/step
Epoch 13/50
1200/1200 - 57s - loss: 10.6725 - accuracy10: 0.5905 - accuracy20: 0.5861 - accuracy30: 0.5696 - accuracy50: 0.5317 - val_loss: 11.2603 - val_accuracy10: 0.5905 - val_accuracy20: 0.5693 - val_accuracy30: 0.5452 - val_accuracy50: 0.5061 - 57s/epoch - 48ms/step
Epoch 14/50
1200/1200 - 57s - loss: 10.6455 - accuracy10: 0.5924 - accuracy20: 0.5871 - accuracy30: 0.5709 - accuracy50: 0.5333 - val_loss: 11.2022 - val_accuracy10: 0.5780 - val_accuracy20: 0.5635 - val_accuracy30: 0.5416 - val_accuracy50: 0.5058 - 57s/epoch - 47ms/step
Epoch 15/50
1200/1200 - 57s - loss: 10.6185 - accuracy10: 0.5927 - accuracy20: 0.5878 - accuracy30: 0.5721 - accuracy50: 0.5349 - val_loss: 11.1946 - val_accuracy10: 0.5878 - val_accuracy20: 0.5680 - val_accuracy30: 0.5447 - val_accuracy50: 0.5071 - 57s/epoch - 47ms/step
Epoch 16/50
1200/1200 - 57s - loss: 10.5892 - accuracy10: 0.5944 - accuracy20: 0.5898 - accuracy30: 0.5735 - accuracy50: 0.5362 - val_loss: 11.1830 - val_accuracy10: 0.5860 - val_accuracy20: 0.5686 - val_accuracy30: 0.5452 - val_accuracy50: 0.5064 - 57s/epoch - 47ms/step
Epoch 17/50
1200/1200 - 58s - loss: 10.5673 - accuracy10: 0.5952 - accuracy20: 0.5902 - accuracy30: 0.5744 - accuracy50: 0.5372 - val_loss: 11.2290 - val_accuracy10: 0.5809 - val_accuracy20: 0.5642 - val_accuracy30: 0.5431 - val_accuracy50: 0.5067 - 58s/epoch - 48ms/step
Epoch 18/50
1200/1200 - 57s - loss: 10.5441 - accuracy10: 0.5959 - accuracy20: 0.5914 - accuracy30: 0.5761 - accuracy50: 0.5381 - val_loss: 11.3089 - val_accuracy10: 0.5837 - val_accuracy20: 0.5646 - val_accuracy30: 0.5419 - val_accuracy50: 0.5027 - 57s/epoch - 47ms/step
Epoch 19/50
1200/1200 - 57s - loss: 10.5186 - accuracy10: 0.5963 - accuracy20: 0.5927 - accuracy30: 0.5781 - accuracy50: 0.5406 - val_loss: 11.3424 - val_accuracy10: 0.5748 - val_accuracy20: 0.5605 - val_accuracy30: 0.5384 - val_accuracy50: 0.5015 - 57s/epoch - 47ms/step
Epoch 20/50
1200/1200 - 56s - loss: 10.4960 - accuracy10: 0.5976 - accuracy20: 0.5939 - accuracy30: 0.5787 - accuracy50: 0.5419 - val_loss: 11.3628 - val_accuracy10: 0.5696 - val_accuracy20: 0.5555 - val_accuracy30: 0.5358 - val_accuracy50: 0.4998 - 56s/epoch - 47ms/step
testing model: results/WBA/W9/deepLOB_L2/seq2seq
Evaluating performance on  test set...
2451/2451 - 39s - 39s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9703632
{'0': {'precision': 0.34559345633124544, 'recall': 0.6559427186074177, 'f1-score': 0.45268362132348167, 'support': 132818}, '1': {'precision': 0.7168235311665647, 'recall': 0.5235646584595272, 'f1-score': 0.6051387306164335, 'support': 367160}, '2': {'precision': 0.4045929135770186, 'recall': 0.3401537338159434, 'f1-score': 0.36958552471623984, 'support': 127363}, 'accuracy': 0.5143550317929164, 'macro avg': {'precision': 0.48900330035827627, 'recall': 0.5065537036276294, 'f1-score': 0.4758026255520517, 'support': 627341}, 'weighted avg': {'precision': 0.5748390853427866, 'recall': 0.5143550317929164, 'f1-score': 0.5250394773090016, 'support': 627341}}
[[ 87121  32364  13333]
 [124506 192232  50422]
 [ 40464  43576  43323]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0026604
{'0': {'precision': 0.3942520972679806, 'recall': 0.6802219317287843, 'f1-score': 0.49918176885512755, 'support': 169061}, '1': {'precision': 0.6231460155525097, 'recall': 0.44589516398111295, 'f1-score': 0.5198261771547119, 'support': 296711}, '2': {'precision': 0.4453822391944154, 'recall': 0.33999715291918625, 'f1-score': 0.38561921743159194, 'support': 161569}, 'accuracy': 0.4817698827272568, 'macro avg': {'precision': 0.48759345067163523, 'recall': 0.48870474954302784, 'f1-score': 0.46820905448047717, 'support': 627341}, 'weighted avg': {'precision': 0.5156795016446004, 'recall': 0.4817698827272568, 'f1-score': 0.4796983223085584, 'support': 627341}}
[[114999  33475  20587]
 [116590 132302  47819]
 [ 60100  46536  54933]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0224396
{'0': {'precision': 0.4136670517726912, 'recall': 0.7118973158810372, 'f1-score': 0.5232725418258766, 'support': 193136}, '1': {'precision': 0.5601217751161177, 'recall': 0.35823491312100686, 'f1-score': 0.43698745382054943, 'support': 250118}, '2': {'precision': 0.4605105260818679, 'recall': 0.3377098871729128, 'f1-score': 0.3896641960606108, 'support': 184087}, 'accuracy': 0.4610921333054909, 'macro avg': {'precision': 0.4780997843235589, 'recall': 0.4692807053916523, 'f1-score': 0.44997473056901227, 'support': 627341}, 'weighted avg': {'precision': 0.4858036364186247, 'recall': 0.4610921333054909, 'f1-score': 0.4496650250389825, 'support': 627341}}
[[137493  28938  26705]
 [114392  89601  46125]
 [ 80491  41428  62168]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0428869
{'0': {'precision': 0.42686679851952763, 'recall': 0.7204260368142344, 'f1-score': 0.5360897347808162, 'support': 216601}, '1': {'precision': 0.4665545237645686, 'recall': 0.2690162660767925, 'f1-score': 0.34126084841256143, 'support': 202077}, '2': {'precision': 0.46414114990637734, 'recall': 0.3231190963419485, 'f1-score': 0.3809994716424574, 'support': 208663}, 'accuracy': 0.44286918916506335, 'macro avg': {'precision': 0.4525208240634912, 'recall': 0.4375204664109918, 'f1-score': 0.41945001827861167, 'support': 627341}, 'weighted avg': {'precision': 0.45204888360208456, 'recall': 0.44286918916506335, 'f1-score': 0.4217467595123782, 'support': 627341}}
[[156045  26099  34457]
 [104331  54362  43384]
 [105183  36057  67423]]
Evaluating performance on  train set...
1200/1200 - 19s - 19s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8950691
{'0': {'precision': 0.4031598250811116, 'recall': 0.6183374801032314, 'f1-score': 0.48808514531426306, 'support': 64709}, '1': {'precision': 0.784744442816719, 'recall': 0.5713940850194247, 'f1-score': 0.6612869167470705, 'support': 178124}, '2': {'precision': 0.42508541376089265, 'recall': 0.5169703854712958, 'f1-score': 0.46654682321217905, 'support': 64259}, 'accuracy': 0.5698976202571217, 'macro avg': {'precision': 0.5376632272195744, 'recall': 0.568900650197984, 'f1-score': 0.5386396284245042, 'support': 307092}, 'weighted avg': {'precision': 0.6290800537178438, 'recall': 0.5698976202571217, 'f1-score': 0.5840412799408231, 'support': 307092}}
[[ 40012  13379  11318]
 [ 42734 101779  33611]
 [ 16500  14539  33220]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.917055
{'0': {'precision': 0.458849544977745, 'recall': 0.5980342648815755, 'f1-score': 0.5192770440083417, 'support': 81191}, '1': {'precision': 0.6950384405327059, 'recall': 0.5695283077325586, 'f1-score': 0.62605484034542, 'support': 145243}, '2': {'precision': 0.4793090033796105, 'recall': 0.4888169803367304, 'f1-score': 0.48401630288001174, 'support': 80658}, 'accuracy': 0.5558659945553776, 'macro avg': {'precision': 0.5443989962966872, 'recall': 0.5521265176502882, 'f1-score': 0.5431160624112579, 'support': 307092}, 'weighted avg': {'precision': 0.5759317312700185, 'recall': 0.5558659945553776, 'f1-score': 0.5605176709717841, 'support': 307092}}
[[48555 17493 15143]
 [34835 82720 27688]
 [22429 18802 39427]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.94280255
{'0': {'precision': 0.47751555196288614, 'recall': 0.5913195804500152, 'f1-score': 0.5283589344740425, 'support': 91908}, '1': {'precision': 0.6246648793565683, 'recall': 0.5479030303030303, 'f1-score': 0.5837713577249422, 'support': 123750}, '2': {'precision': 0.49968726766347643, 'recall': 0.46308812914233216, 'f1-score': 0.48069205487849875, 'support': 91434}, 'accuracy': 0.5356440415250153, 'macro avg': {'precision': 0.533955899660977, 'recall': 0.5341035799651259, 'f1-score': 0.5309407823591611, 'support': 307092}, 'weighted avg': {'precision': 0.5434142986522689, 'recall': 0.5356440415250153, 'f1-score': 0.5364962806385791, 'support': 307092}}
[[54347 19558 18003]
 [31555 67803 24392]
 [27910 21182 42342]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9831624
{'0': {'precision': 0.4844940867279895, 'recall': 0.5720713731574865, 'f1-score': 0.5246531483457845, 'support': 103120}, '1': {'precision': 0.5228030465237207, 'recall': 0.5066347854439822, 'f1-score': 0.5145919473325037, 'support': 101209}, '2': {'precision': 0.5026417429773188, 'recall': 0.42677812052976266, 'f1-score': 0.46161375884136074, 'support': 102763}, 'accuracy': 0.5018854284709469, 'macro avg': {'precision': 0.5033129587430096, 'recall': 0.5018280930437439, 'f1-score': 0.5002862848398829, 'support': 307092}, 'weighted avg': {'precision': 0.5031924543543554, 'recall': 0.5018854284709469, 'f1-score': 0.5002422197739029, 'support': 307092}}
[[58992 22530 21598]
 [28135 51276 21798]
 [34633 24273 43857]]
Evaluating performance on  val set...
441/441 - 7s - 7s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8686506
{'0': {'precision': 0.4089950110451984, 'recall': 0.6649985875136204, 'f1-score': 0.5064855228376468, 'support': 24779}, '1': {'precision': 0.7866434331563804, 'recall': 0.6036914369236989, 'f1-score': 0.6831302511767035, 'support': 64311}, '2': {'precision': 0.4618249534450652, 'recall': 0.4510235154796143, 'f1-score': 0.4563603295174923, 'support': 23644}, 'accuracy': 0.585147337981443, 'macro avg': {'precision': 0.552487799215548, 'recall': 0.5732378466389778, 'f1-score': 0.5486587011772809, 'support': 112734}, 'weighted avg': {'precision': 0.6355110473119384, 'recall': 0.585147337981443, 'f1-score': 0.5967425797446254, 'support': 112734}}
[[16478  5084  3217]
 [16277 38824  9210]
 [ 7534  5446 10664]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8955768
{'0': {'precision': 0.46104596622889304, 'recall': 0.6385694796335997, 'f1-score': 0.5354778961130935, 'support': 30786}, '1': {'precision': 0.6990636663247266, 'recall': 0.6088006082493822, 'f1-score': 0.6508173570260193, 'support': 52610}, '2': {'precision': 0.5097005396053879, 'recall': 0.42177380871225034, 'f1-score': 0.46158724237620075, 'support': 29338}, 'accuracy': 0.5682580233115121, 'macro avg': {'precision': 0.5566033907196691, 'recall': 0.5563812988650775, 'f1-score': 0.5492941651717711, 'support': 112734}, 'weighted avg': {'precision': 0.5847844929888893, 'recall': 0.5682580233115121, 'f1-score': 0.570074424572086, 'support': 112734}}
[[19659  6697  4430]
 [13108 32029  7473]
 [ 9873  7091 12374]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9239383
{'0': {'precision': 0.4800998872953084, 'recall': 0.6271289186536574, 'f1-score': 0.543852402588462, 'support': 34642}, '1': {'precision': 0.6316433360781084, 'recall': 0.5933784201918402, 'f1-score': 0.6119132545498057, 'support': 45246}, '2': {'precision': 0.5217391304347826, 'recall': 0.3967606405650612, 'f1-score': 0.4507470946319867, 'support': 32846}, 'accuracy': 0.5464633562190644, 'macro avg': {'precision': 0.5444941179360665, 'recall': 0.5390893264701863, 'f1-score': 0.5355042505900848, 'support': 112734}, 'weighted avg': {'precision': 0.5530540755950736, 'recall': 0.5464633562190644, 'f1-score': 0.5440417364425306, 'support': 112734}}
[[21725  7643  5274]
 [11726 26848  6672]
 [11800  8014 13032]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9702185
{'0': {'precision': 0.48526522593320237, 'recall': 0.604242029928432, 'f1-score': 0.5382573518331769, 'support': 38425}, '1': {'precision': 0.536081684747926, 'recall': 0.555787857936802, 'f1-score': 0.545756941827679, 'support': 37786}, '2': {'precision': 0.5159257962898145, 'recall': 0.3632231744380254, 'f1-score': 0.426312745035028, 'support': 36523}, 'accuracy': 0.5099171501055583, 'macro avg': {'precision': 0.5124242356569809, 'recall': 0.5077510207677531, 'f1-score': 0.5034423462319613, 'support': 112734}, 'weighted avg': {'precision': 0.5122310634259525, 'recall': 0.5099171501055583, 'f1-score': 0.5045037959710897, 'support': 112734}}
[[23218  8927  6280]
 [10618 21001  6167]
 [14010  9247 13266]]
training model: results/WBA/W9/deepOF_L2/seq2seq
Epoch 1/50
1200/1200 - 41s - loss: 11.9518 - accuracy10: 0.5025 - accuracy20: 0.5013 - accuracy30: 0.4900 - accuracy50: 0.4685 - val_loss: 11.5254 - val_accuracy10: 0.5812 - val_accuracy20: 0.5574 - val_accuracy30: 0.5309 - val_accuracy50: 0.4872 - 41s/epoch - 34ms/step
Epoch 2/50
1200/1200 - 33s - loss: 11.1698 - accuracy10: 0.5657 - accuracy20: 0.5597 - accuracy30: 0.5438 - accuracy50: 0.5105 - val_loss: 11.3152 - val_accuracy10: 0.5595 - val_accuracy20: 0.5489 - val_accuracy30: 0.5299 - val_accuracy50: 0.4967 - 33s/epoch - 28ms/step
Epoch 3/50
1200/1200 - 33s - loss: 11.0059 - accuracy10: 0.5743 - accuracy20: 0.5676 - accuracy30: 0.5515 - accuracy50: 0.5175 - val_loss: 11.2024 - val_accuracy10: 0.5705 - val_accuracy20: 0.5604 - val_accuracy30: 0.5408 - val_accuracy50: 0.5067 - 33s/epoch - 28ms/step
Epoch 4/50
1200/1200 - 33s - loss: 10.9179 - accuracy10: 0.5796 - accuracy20: 0.5722 - accuracy30: 0.5558 - accuracy50: 0.5212 - val_loss: 11.1819 - val_accuracy10: 0.5760 - val_accuracy20: 0.5651 - val_accuracy30: 0.5446 - val_accuracy50: 0.5081 - 33s/epoch - 28ms/step
Epoch 5/50
1200/1200 - 33s - loss: 10.8596 - accuracy10: 0.5817 - accuracy20: 0.5754 - accuracy30: 0.5590 - accuracy50: 0.5244 - val_loss: 11.1896 - val_accuracy10: 0.5740 - val_accuracy20: 0.5618 - val_accuracy30: 0.5423 - val_accuracy50: 0.5067 - 33s/epoch - 27ms/step
Epoch 6/50
1200/1200 - 33s - loss: 10.8113 - accuracy10: 0.5844 - accuracy20: 0.5779 - accuracy30: 0.5611 - accuracy50: 0.5259 - val_loss: 11.1303 - val_accuracy10: 0.5801 - val_accuracy20: 0.5679 - val_accuracy30: 0.5472 - val_accuracy50: 0.5111 - 33s/epoch - 28ms/step
Epoch 7/50
1200/1200 - 33s - loss: 10.7729 - accuracy10: 0.5858 - accuracy20: 0.5797 - accuracy30: 0.5629 - accuracy50: 0.5279 - val_loss: 11.1187 - val_accuracy10: 0.5844 - val_accuracy20: 0.5705 - val_accuracy30: 0.5497 - val_accuracy50: 0.5129 - 33s/epoch - 27ms/step
Epoch 8/50
1200/1200 - 33s - loss: 10.7337 - accuracy10: 0.5879 - accuracy20: 0.5820 - accuracy30: 0.5663 - accuracy50: 0.5309 - val_loss: 11.1078 - val_accuracy10: 0.5811 - val_accuracy20: 0.5689 - val_accuracy30: 0.5478 - val_accuracy50: 0.5108 - 33s/epoch - 28ms/step
Epoch 9/50
1200/1200 - 33s - loss: 10.6973 - accuracy10: 0.5889 - accuracy20: 0.5835 - accuracy30: 0.5670 - accuracy50: 0.5321 - val_loss: 11.1020 - val_accuracy10: 0.5843 - val_accuracy20: 0.5716 - val_accuracy30: 0.5503 - val_accuracy50: 0.5123 - 33s/epoch - 28ms/step
Epoch 10/50
1200/1200 - 33s - loss: 10.6668 - accuracy10: 0.5902 - accuracy20: 0.5846 - accuracy30: 0.5694 - accuracy50: 0.5342 - val_loss: 11.1213 - val_accuracy10: 0.5838 - val_accuracy20: 0.5699 - val_accuracy30: 0.5490 - val_accuracy50: 0.5131 - 33s/epoch - 27ms/step
Epoch 11/50
1200/1200 - 33s - loss: 10.6382 - accuracy10: 0.5911 - accuracy20: 0.5859 - accuracy30: 0.5698 - accuracy50: 0.5354 - val_loss: 11.0794 - val_accuracy10: 0.5803 - val_accuracy20: 0.5684 - val_accuracy30: 0.5489 - val_accuracy50: 0.5140 - 33s/epoch - 28ms/step
Epoch 12/50
1200/1200 - 33s - loss: 10.6082 - accuracy10: 0.5921 - accuracy20: 0.5867 - accuracy30: 0.5720 - accuracy50: 0.5375 - val_loss: 11.0297 - val_accuracy10: 0.5857 - val_accuracy20: 0.5724 - val_accuracy30: 0.5519 - val_accuracy50: 0.5155 - 33s/epoch - 27ms/step
Epoch 13/50
1200/1200 - 34s - loss: 10.5817 - accuracy10: 0.5926 - accuracy20: 0.5879 - accuracy30: 0.5726 - accuracy50: 0.5397 - val_loss: 11.0339 - val_accuracy10: 0.5808 - val_accuracy20: 0.5699 - val_accuracy30: 0.5498 - val_accuracy50: 0.5161 - 34s/epoch - 28ms/step
Epoch 14/50
1200/1200 - 33s - loss: 10.5492 - accuracy10: 0.5940 - accuracy20: 0.5893 - accuracy30: 0.5747 - accuracy50: 0.5412 - val_loss: 11.0744 - val_accuracy10: 0.5796 - val_accuracy20: 0.5674 - val_accuracy30: 0.5472 - val_accuracy50: 0.5116 - 33s/epoch - 28ms/step
Epoch 15/50
1200/1200 - 34s - loss: 10.5210 - accuracy10: 0.5948 - accuracy20: 0.5912 - accuracy30: 0.5772 - accuracy50: 0.5436 - val_loss: 11.1148 - val_accuracy10: 0.5713 - val_accuracy20: 0.5617 - val_accuracy30: 0.5432 - val_accuracy50: 0.5111 - 34s/epoch - 28ms/step
Epoch 16/50
1200/1200 - 34s - loss: 10.4937 - accuracy10: 0.5960 - accuracy20: 0.5919 - accuracy30: 0.5783 - accuracy50: 0.5454 - val_loss: 11.1090 - val_accuracy10: 0.5687 - val_accuracy20: 0.5595 - val_accuracy30: 0.5424 - val_accuracy50: 0.5107 - 34s/epoch - 28ms/step
Epoch 17/50
1200/1200 - 33s - loss: 10.4673 - accuracy10: 0.5968 - accuracy20: 0.5930 - accuracy30: 0.5790 - accuracy50: 0.5461 - val_loss: 11.0758 - val_accuracy10: 0.5773 - val_accuracy20: 0.5668 - val_accuracy30: 0.5471 - val_accuracy50: 0.5132 - 33s/epoch - 28ms/step
Epoch 18/50
1200/1200 - 33s - loss: 10.4343 - accuracy10: 0.5977 - accuracy20: 0.5945 - accuracy30: 0.5812 - accuracy50: 0.5487 - val_loss: 11.0497 - val_accuracy10: 0.5731 - val_accuracy20: 0.5654 - val_accuracy30: 0.5478 - val_accuracy50: 0.5161 - 33s/epoch - 28ms/step
Epoch 19/50
1200/1200 - 33s - loss: 10.4138 - accuracy10: 0.5983 - accuracy20: 0.5960 - accuracy30: 0.5828 - accuracy50: 0.5502 - val_loss: 11.0797 - val_accuracy10: 0.5685 - val_accuracy20: 0.5603 - val_accuracy30: 0.5418 - val_accuracy50: 0.5110 - 33s/epoch - 28ms/step
Epoch 20/50
1200/1200 - 33s - loss: 10.3862 - accuracy10: 0.6000 - accuracy20: 0.5972 - accuracy30: 0.5838 - accuracy50: 0.5520 - val_loss: 11.1206 - val_accuracy10: 0.5735 - val_accuracy20: 0.5619 - val_accuracy30: 0.5421 - val_accuracy50: 0.5093 - 33s/epoch - 27ms/step
Epoch 21/50
1200/1200 - 33s - loss: 10.3567 - accuracy10: 0.5999 - accuracy20: 0.5988 - accuracy30: 0.5855 - accuracy50: 0.5536 - val_loss: 11.1013 - val_accuracy10: 0.5785 - val_accuracy20: 0.5678 - val_accuracy30: 0.5475 - val_accuracy50: 0.5128 - 33s/epoch - 27ms/step
Epoch 22/50
1200/1200 - 33s - loss: 10.3359 - accuracy10: 0.6003 - accuracy20: 0.5991 - accuracy30: 0.5869 - accuracy50: 0.5564 - val_loss: 11.1493 - val_accuracy10: 0.5840 - val_accuracy20: 0.5690 - val_accuracy30: 0.5473 - val_accuracy50: 0.5100 - 33s/epoch - 28ms/step
testing model: results/WBA/W9/deepOF_L2/seq2seq
Evaluating performance on  test set...
2451/2451 - 24s - 24s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.91036993
{'0': {'precision': 0.4190713957759412, 'recall': 0.549767350810884, 'f1-score': 0.4756039575585068, 'support': 132818}, '1': {'precision': 0.7659855586849595, 'recall': 0.5636985611138499, 'f1-score': 0.6494549357031236, 'support': 367159}, '2': {'precision': 0.40605248769819574, 'recall': 0.5831265703517587, 'f1-score': 0.4787404112679688, 'support': 127360}, 'accuracy': 0.5646932988170632, 'macro avg': {'precision': 0.5303698140530322, 'recall': 0.5655308274254975, 'f1-score': 0.5345997681765331, 'support': 627337}, 'weighted avg': {'precision': 0.6194653929524677, 'recall': 0.5646932988170632, 'f1-score': 0.577989772565491, 'support': 627337}}
[[ 73019  32888  26911]
 [ 78470 206967  81722]
 [ 22751  30342  74267]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9372114
{'0': {'precision': 0.4816293458254855, 'recall': 0.5309061871524903, 'f1-score': 0.5050686939566762, 'support': 169060}, '1': {'precision': 0.6642245449513203, 'recall': 0.55000505544134, 'f1-score': 0.6017426317943649, 'support': 296710}, '2': {'precision': 0.4549802347254368, 'recall': 0.5499514133455471, 'f1-score': 0.49797819306785035, 'support': 161567}, 'accuracy': 0.5448443181256645, 'macro avg': {'precision': 0.5336113751674142, 'recall': 0.5436208853131258, 'f1-score': 0.5349298396062973, 'support': 627337}, 'weighted avg': {'precision': 0.5611276132631225, 'recall': 0.5448443181256645, 'f1-score': 0.5489662054038181, 'support': 627337}}
[[ 89755  41626  37679]
 [ 64759 163192  68759]
 [ 31843  40870  88854]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9607405
{'0': {'precision': 0.5091293966059404, 'recall': 0.5155641620412559, 'f1-score': 0.5123265751338391, 'support': 193136}, '1': {'precision': 0.5850436058718743, 'recall': 0.5291702316506609, 'f1-score': 0.5557060054707788, 'support': 250118}, '2': {'precision': 0.4718263602703268, 'recall': 0.5267949783521564, 'f1-score': 0.4977978091023891, 'support': 184083}, 'accuracy': 0.5242843957872723, 'macro avg': {'precision': 0.5219997875827138, 'recall': 0.5238431240146911, 'f1-score': 0.521943463235669, 'support': 627337}, 'weighted avg': {'precision': 0.5284502008234633, 'recall': 0.5242843957872723, 'f1-score': 0.5253586097813209, 'support': 627337}}
[[ 99574  46597  46965]
 [ 56173 132355  61590]
 [ 39830  47279  96974]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.99820393
{'0': {'precision': 0.5183329548932305, 'recall': 0.4847946223701645, 'f1-score': 0.5010031322536244, 'support': 216601}, '1': {'precision': 0.474082938366297, 'recall': 0.49795869891180095, 'f1-score': 0.4857275946043139, 'support': 202077}, '2': {'precision': 0.47653378635933685, 'recall': 0.48529898063347376, 'f1-score': 0.48087644483279357, 'support': 208659}, 'accuracy': 0.48920277299123116, 'macro avg': {'precision': 0.4896498932062881, 'recall': 0.48935076730514643, 'f1-score': 0.48920239056357734, 'support': 627337}, 'weighted avg': {'precision': 0.4901763448147131, 'recall': 0.48920277299123116, 'f1-score': 0.4893882437772507, 'support': 627337}}
[[105007  54253  57341]
 [ 47557 100626  53894]
 [ 50022  57375 101262]]
Evaluating performance on  train set...
1200/1200 - 11s - 11s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.88533694
{'0': {'precision': 0.42184168823321516, 'recall': 0.571417540500054, 'f1-score': 0.4853672294150827, 'support': 64753}, '1': {'precision': 0.7994549347868406, 'recall': 0.576299156909191, 'f1-score': 0.6697784257891115, 'support': 178154}, '2': {'precision': 0.4248927982407916, 'recall': 0.6021096586217105, 'f1-score': 0.49821118925295405, 'support': 64181}, 'accuracy': 0.5806641744385974, 'macro avg': {'precision': 0.5487298070869491, 'recall': 0.5832754520103185, 'f1-score': 0.5511189481523827, 'support': 307088}, 'weighted avg': {'precision': 0.6415478754431057, 'recall': 0.5806641744385974, 'f1-score': 0.5950358926815508, 'support': 307088}}
[[ 37001  12542  15210]
 [ 38388 102670  37096]
 [ 12324  13213  38644]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9009447
{'0': {'precision': 0.48346171764119567, 'recall': 0.5488266837211591, 'f1-score': 0.5140747311487308, 'support': 81308}, '1': {'precision': 0.7071252080076648, 'recall': 0.5795466286446387, 'f1-score': 0.6370109590596785, 'support': 145179}, '2': {'precision': 0.4805795346603898, 'recall': 0.5712087939355591, 'f1-score': 0.52198954660378, 'support': 80601}, 'accuracy': 0.5692244568332204, 'macro avg': {'precision': 0.55705548676975, 'recall': 0.566527368767119, 'f1-score': 0.5576917456040631, 'support': 307088}, 'weighted avg': {'precision': 0.5884444425847873, 'recall': 0.5692244568332204, 'f1-score': 0.5742714847580411, 'support': 307088}}
[[44624 16966 19718]
 [30998 84138 30043]
 [16679 17882 46040]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.923947
{'0': {'precision': 0.509273764020302, 'recall': 0.5302214828587272, 'f1-score': 0.5195365561326407, 'support': 91971}, '1': {'precision': 0.631750949072416, 'recall': 0.5700954212350626, 'f1-score': 0.599341700112548, 'support': 123767}, '2': {'precision': 0.5008730907412239, 'recall': 0.546360153256705, 'f1-score': 0.5226287461517518, 'support': 91350}, 'accuracy': 0.5510928463502318, 'macro avg': {'precision': 0.5472992679446472, 'recall': 0.548892352450165, 'f1-score': 0.5471690007989801, 'support': 307088}, 'weighted avg': {'precision': 0.5561373088618498, 'recall': 0.5510928463502318, 'f1-score': 0.5526206063501906, 'support': 307088}}
[[48765 20052 23154]
 [26626 70559 26582]
 [20363 21077 49910]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.965602
{'0': {'precision': 0.5187192918341658, 'recall': 0.49526043383022855, 'f1-score': 0.5067184974365585, 'support': 103174}, '1': {'precision': 0.5214591671274991, 'recall': 0.5499866544084937, 'f1-score': 0.5353431353681536, 'support': 101157}, '2': {'precision': 0.5055992305351903, 'recall': 0.5013283766556049, 'f1-score': 0.5034547462447349, 'support': 102757}, 'accuracy': 0.5153180847183869, 'macro avg': {'precision': 0.515259229832285, 'recall': 0.5155251549647758, 'f1-score': 0.5151721263498157, 'support': 307088}, 'weighted avg': {'precision': 0.5152316251918643, 'recall': 0.5153180847183869, 'f1-score': 0.5150555513690734, 'support': 307088}}
[[51098 24781 27295]
 [22443 55635 23079]
 [24967 26275 51515]]
Evaluating performance on  val set...
441/441 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8812085
{'0': {'precision': 0.42563914597269314, 'recall': 0.5637363971034427, 'f1-score': 0.4850499495283512, 'support': 24719}, '1': {'precision': 0.7961885487815161, 'recall': 0.587563589974953, 'f1-score': 0.6761491294812693, 'support': 64279}, '2': {'precision': 0.4382198470468995, 'recall': 0.6011122345803842, 'f1-score': 0.5069011457500666, 'support': 23736}, 'accuracy': 0.5851916901733284, 'macro avg': {'precision': 0.5533491806003695, 'recall': 0.5841374072195933, 'f1-score': 0.5560334082532291, 'support': 112734}, 'weighted avg': {'precision': 0.6395689327614675, 'recall': 0.5851916901733284, 'f1-score': 0.5986121772654337, 'support': 112734}}
[[13935  5105  5679]
 [13899 37768 12612]
 [ 4905  4563 14268]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8964827
{'0': {'precision': 0.48139777468706535, 'recall': 0.5398362360280738, 'f1-score': 0.5089449822325696, 'support': 30776}, '1': {'precision': 0.7057973631930649, 'recall': 0.5953686776355881, 'f1-score': 0.6458970333030328, 'support': 52512}, '2': {'precision': 0.48941814537522843, 'recall': 0.5638796440942743, 'f1-score': 0.5240169159881335, 'support': 29446}, 'accuracy': 0.5719836074298792, 'macro avg': {'precision': 0.5588710944184528, 'recall': 0.5663615192526454, 'f1-score': 0.5596196438412453, 'support': 112734}, 'weighted avg': {'precision': 0.5880190160775127, 'recall': 0.5719836074298792, 'f1-score': 0.5766746313817038, 'support': 112734}}
[[16614  6818  7344]
 [11270 31264  9978]
 [ 6628  6214 16604]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9202898
{'0': {'precision': 0.5033301617507137, 'recall': 0.5195713088944738, 'f1-score': 0.511321800685136, 'support': 34617}, '1': {'precision': 0.6325815372878123, 'recall': 0.5881062150899903, 'f1-score': 0.6095336549506087, 'support': 45116}, '2': {'precision': 0.5043359196713829, 'recall': 0.5357413411714796, 'f1-score': 0.5195644827130199, 'support': 33001}, 'accuracy': 0.5517323966150407, 'macro avg': {'precision': 0.5467492062366363, 'recall': 0.5478062883853146, 'f1-score': 0.546806646116255, 'support': 112734}, 'weighted avg': {'precision': 0.5553508128042711, 'recall': 0.5517323966150407, 'f1-score': 0.5530389646875068, 'support': 112734}}
[[17986  8042  8589]
 [ 9796 26533  8787]
 [ 7952  7369 17680]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9631859
{'0': {'precision': 0.5099109921913395, 'recall': 0.48621488636067794, 'f1-score': 0.4977810946599677, 'support': 38411}, '1': {'precision': 0.5309460763691257, 'recall': 0.5690377678760874, 'f1-score': 0.5493323774531768, 'support': 37704}, '2': {'precision': 0.5039076724838231, 'recall': 0.4912477129359076, 'f1-score': 0.49749716529771293, 'support': 36619}, 'accuracy': 0.5155498784749942, 'macro avg': {'precision': 0.5149215803480961, 'recall': 0.5155001223908909, 'f1-score': 0.5148702124702859, 'support': 112734}, 'weighted avg': {'precision': 0.5149961594831034, 'recall': 0.5155498784749942, 'f1-score': 0.5149302453786395, 'support': 112734}}
[[18676  9758  9977]
 [ 8516 21455  7733]
 [ 9434  9196 17989]]
training model: results/WBA/W9/deepVOL_L2/seq2seq
Epoch 1/50
1200/1200 - 40s - loss: 12.0216 - accuracy10: 0.4911 - accuracy20: 0.4948 - accuracy30: 0.4882 - accuracy50: 0.4700 - val_loss: 11.5776 - val_accuracy10: 0.5333 - val_accuracy20: 0.5314 - val_accuracy30: 0.5187 - val_accuracy50: 0.4900 - 40s/epoch - 33ms/step
Epoch 2/50
1200/1200 - 34s - loss: 11.4738 - accuracy10: 0.5412 - accuracy20: 0.5423 - accuracy30: 0.5301 - accuracy50: 0.5015 - val_loss: 11.4923 - val_accuracy10: 0.5595 - val_accuracy20: 0.5498 - val_accuracy30: 0.5300 - val_accuracy50: 0.4914 - 34s/epoch - 28ms/step
Epoch 3/50
1200/1200 - 33s - loss: 11.2760 - accuracy10: 0.5590 - accuracy20: 0.5564 - accuracy30: 0.5413 - accuracy50: 0.5092 - val_loss: 11.3318 - val_accuracy10: 0.5721 - val_accuracy20: 0.5622 - val_accuracy30: 0.5398 - val_accuracy50: 0.4977 - 33s/epoch - 28ms/step
Epoch 4/50
1200/1200 - 33s - loss: 11.1750 - accuracy10: 0.5661 - accuracy20: 0.5626 - accuracy30: 0.5466 - accuracy50: 0.5138 - val_loss: 11.3237 - val_accuracy10: 0.5690 - val_accuracy20: 0.5596 - val_accuracy30: 0.5388 - val_accuracy50: 0.4969 - 33s/epoch - 27ms/step
Epoch 5/50
1200/1200 - 33s - loss: 11.0833 - accuracy10: 0.5715 - accuracy20: 0.5674 - accuracy30: 0.5517 - accuracy50: 0.5173 - val_loss: 11.2172 - val_accuracy10: 0.5760 - val_accuracy20: 0.5657 - val_accuracy30: 0.5449 - val_accuracy50: 0.5040 - 33s/epoch - 27ms/step
Epoch 6/50
1200/1200 - 33s - loss: 11.0252 - accuracy10: 0.5744 - accuracy20: 0.5709 - accuracy30: 0.5545 - accuracy50: 0.5192 - val_loss: 11.1921 - val_accuracy10: 0.5833 - val_accuracy20: 0.5706 - val_accuracy30: 0.5482 - val_accuracy50: 0.5052 - 33s/epoch - 27ms/step
Epoch 7/50
1200/1200 - 33s - loss: 10.9659 - accuracy10: 0.5784 - accuracy20: 0.5741 - accuracy30: 0.5577 - accuracy50: 0.5213 - val_loss: 11.1834 - val_accuracy10: 0.5796 - val_accuracy20: 0.5694 - val_accuracy30: 0.5487 - val_accuracy50: 0.5073 - 33s/epoch - 27ms/step
Epoch 8/50
1200/1200 - 33s - loss: 10.9066 - accuracy10: 0.5807 - accuracy20: 0.5767 - accuracy30: 0.5600 - accuracy50: 0.5231 - val_loss: 11.1353 - val_accuracy10: 0.5824 - val_accuracy20: 0.5710 - val_accuracy30: 0.5495 - val_accuracy50: 0.5065 - 33s/epoch - 28ms/step
Epoch 9/50
1200/1200 - 33s - loss: 10.8676 - accuracy10: 0.5832 - accuracy20: 0.5781 - accuracy30: 0.5616 - accuracy50: 0.5249 - val_loss: 11.1608 - val_accuracy10: 0.5793 - val_accuracy20: 0.5708 - val_accuracy30: 0.5510 - val_accuracy50: 0.5087 - 33s/epoch - 27ms/step
Epoch 10/50
1200/1200 - 33s - loss: 10.8284 - accuracy10: 0.5844 - accuracy20: 0.5799 - accuracy30: 0.5639 - accuracy50: 0.5271 - val_loss: 11.1536 - val_accuracy10: 0.5898 - val_accuracy20: 0.5743 - val_accuracy30: 0.5507 - val_accuracy50: 0.5055 - 33s/epoch - 27ms/step
Epoch 11/50
1200/1200 - 33s - loss: 10.7957 - accuracy10: 0.5863 - accuracy20: 0.5822 - accuracy30: 0.5656 - accuracy50: 0.5277 - val_loss: 11.2063 - val_accuracy10: 0.5965 - val_accuracy20: 0.5763 - val_accuracy30: 0.5503 - val_accuracy50: 0.5042 - 33s/epoch - 27ms/step
Epoch 12/50
1200/1200 - 32s - loss: 10.7613 - accuracy10: 0.5881 - accuracy20: 0.5831 - accuracy30: 0.5670 - accuracy50: 0.5301 - val_loss: 11.1809 - val_accuracy10: 0.5928 - val_accuracy20: 0.5760 - val_accuracy30: 0.5516 - val_accuracy50: 0.5057 - 32s/epoch - 27ms/step
Epoch 13/50
1200/1200 - 33s - loss: 10.7336 - accuracy10: 0.5894 - accuracy20: 0.5850 - accuracy30: 0.5692 - accuracy50: 0.5319 - val_loss: 11.1936 - val_accuracy10: 0.5906 - val_accuracy20: 0.5753 - val_accuracy30: 0.5507 - val_accuracy50: 0.5047 - 33s/epoch - 27ms/step
Epoch 14/50
1200/1200 - 33s - loss: 10.7084 - accuracy10: 0.5897 - accuracy20: 0.5854 - accuracy30: 0.5697 - accuracy50: 0.5332 - val_loss: 11.2539 - val_accuracy10: 0.5927 - val_accuracy20: 0.5737 - val_accuracy30: 0.5481 - val_accuracy50: 0.5028 - 33s/epoch - 28ms/step
Epoch 15/50
1200/1200 - 32s - loss: 10.6802 - accuracy10: 0.5909 - accuracy20: 0.5869 - accuracy30: 0.5714 - accuracy50: 0.5348 - val_loss: 11.2230 - val_accuracy10: 0.5962 - val_accuracy20: 0.5773 - val_accuracy30: 0.5521 - val_accuracy50: 0.5048 - 32s/epoch - 27ms/step
Epoch 16/50
1200/1200 - 33s - loss: 10.6535 - accuracy10: 0.5923 - accuracy20: 0.5880 - accuracy30: 0.5724 - accuracy50: 0.5357 - val_loss: 11.2105 - val_accuracy10: 0.5931 - val_accuracy20: 0.5744 - val_accuracy30: 0.5502 - val_accuracy50: 0.5046 - 33s/epoch - 27ms/step
Epoch 17/50
1200/1200 - 32s - loss: 10.6292 - accuracy10: 0.5937 - accuracy20: 0.5896 - accuracy30: 0.5739 - accuracy50: 0.5371 - val_loss: 11.2626 - val_accuracy10: 0.5912 - val_accuracy20: 0.5741 - val_accuracy30: 0.5496 - val_accuracy50: 0.5020 - 32s/epoch - 27ms/step
Epoch 18/50
1200/1200 - 32s - loss: 10.6030 - accuracy10: 0.5935 - accuracy20: 0.5902 - accuracy30: 0.5753 - accuracy50: 0.5389 - val_loss: 11.2047 - val_accuracy10: 0.5934 - val_accuracy20: 0.5764 - val_accuracy30: 0.5510 - val_accuracy50: 0.5057 - 32s/epoch - 27ms/step
testing model: results/WBA/W9/deepVOL_L2/seq2seq
Evaluating performance on  test set...
2451/2451 - 22s - 22s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.95294106
{'0': {'precision': 0.40121677713897536, 'recall': 0.6047674261018838, 'f1-score': 0.48239890216474135, 'support': 132818}, '1': {'precision': 0.7730225433665081, 'recall': 0.5250599193811962, 'f1-score': 0.6253580430332853, 'support': 367160}, '2': {'precision': 0.3949728276156936, 'recall': 0.5512432967188273, 'f1-score': 0.460203790677019, 'support': 127363}, 'accuracy': 0.5472510165922521, 'macro avg': {'precision': 0.5230707160403923, 'recall': 0.560356880733969, 'f1-score': 0.5226535786250152, 'support': 627341}, 'weighted avg': {'precision': 0.6175535971219945, 'recall': 0.5472510165922521, 'f1-score': 0.5615616576308815, 'support': 627341}}
[[ 80324  30454  22040]
 [ 88873 192781  85506]
 [ 31004  26151  70208]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9582973
{'0': {'precision': 0.4699856281112155, 'recall': 0.5590171594868124, 'f1-score': 0.5106497941363995, 'support': 169061}, '1': {'precision': 0.661271340824453, 'recall': 0.5529690506924246, 'f1-score': 0.6022902682869975, 'support': 296711}, '2': {'precision': 0.45946401104761475, 'recall': 0.5065823270553138, 'f1-score': 0.481874085609069, 'support': 161569}, 'accuracy': 0.5426522417632516, 'macro avg': {'precision': 0.5302403266610944, 'recall': 0.5395228457448503, 'f1-score': 0.531604716010822, 'support': 627341}, 'weighted avg': {'precision': 0.5577474800506049, 'recall': 0.5426522417632516, 'f1-score': 0.5465815669276659, 'support': 627341}}
[[ 94508  44234  30319]
 [ 66668 164072  65971]
 [ 39911  39810  81848]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.97191906
{'0': {'precision': 0.5012235287249517, 'recall': 0.5334479330627123, 'f1-score': 0.516833923183233, 'support': 193136}, '1': {'precision': 0.5740255732459506, 'recall': 0.5652012250217897, 'f1-score': 0.5695792228303898, 'support': 250118}, '2': {'precision': 0.48763353559524825, 'recall': 0.4649269095590672, 'f1-score': 0.47600958837826257, 'support': 184087}, 'accuracy': 0.5260010106146418, 'macro avg': {'precision': 0.5209608791887169, 'recall': 0.5211920225478563, 'f1-score': 0.5208075781306284, 'support': 627341}, 'weighted avg': {'precision': 0.5262615235415434, 'recall': 0.5260010106146418, 'f1-score': 0.5258837374563397, 'support': 627341}}
[[103028  54282  35826]
 [ 54649 141367  54102]
 [ 47876  50624  85587]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0077349
{'0': {'precision': 0.5109620318715722, 'recall': 0.5010872525980952, 'f1-score': 0.5059764670781509, 'support': 216601}, '1': {'precision': 0.45997469178802103, 'recall': 0.5522350391187517, 'f1-score': 0.5019002172319343, 'support': 202077}, '2': {'precision': 0.4973217964565307, 'recall': 0.4106957151004251, 'f1-score': 0.44987663394403904, 'support': 208663}, 'accuracy': 0.48749723037391146, 'macro avg': {'precision': 0.4894195067053746, 'recall': 0.48800600227242397, 'f1-score': 0.48591777275137477, 'support': 627341}, 'weighted avg': {'precision': 0.49000121285213527, 'recall': 0.48749723037391146, 'f1-score': 0.48600379540287847, 'support': 627341}}
[[108536  66051  42014]
 [ 45877 111594  44606]
 [ 58002  64964  85697]]
Evaluating performance on  train set...
1200/1200 - 10s - 10s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.91145897
{'0': {'precision': 0.4187326047476278, 'recall': 0.6021728044012424, 'f1-score': 0.4939720852401657, 'support': 64709}, '1': {'precision': 0.7863922613460897, 'recall': 0.5832734499562103, 'f1-score': 0.6697717895822589, 'support': 178124}, '2': {'precision': 0.42188014990417366, 'recall': 0.5378234955414806, 'f1-score': 0.47284817140746216, 'support': 64259}, 'accuracy': 0.5777454313365376, 'macro avg': {'precision': 0.5423350053326303, 'recall': 0.5744232499663111, 'f1-score': 0.5455306820766289, 'support': 307092}, 'weighted avg': {'precision': 0.6326465679122786, 'recall': 0.5777454313365376, 'f1-score': 0.5915218258952637, 'support': 307092}}
[[ 38966  14043  11700]
 [ 38570 103895  35659]
 [ 15521  14178  34560]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9198774
{'0': {'precision': 0.48365886675691355, 'recall': 0.5544703230653644, 'f1-score': 0.5166495475385754, 'support': 81191}, '1': {'precision': 0.6794767463969275, 'recall': 0.6151139813966938, 'f1-score': 0.6456954121014137, 'support': 145243}, '2': {'precision': 0.48536877945934154, 'recall': 0.4966277368642912, 'f1-score': 0.4909337140826168, 'support': 80658}, 'accuracy': 0.567960090135855, 'macro avg': {'precision': 0.5495014642043942, 'recall': 0.5554040137754498, 'f1-score': 0.5510928912408687, 'support': 307092}, 'weighted avg': {'precision': 0.5767224907891481, 'recall': 0.567960090135855, 'f1-score': 0.5709291146123175, 'support': 307092}}
[[45018 21083 15090]
 [28520 89341 27382]
 [19540 21061 40057]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9398002
{'0': {'precision': 0.5094512580604375, 'recall': 0.5260804282543413, 'f1-score': 0.517632322713258, 'support': 91908}, '1': {'precision': 0.5940354833513588, 'recall': 0.6258181818181818, 'f1-score': 0.6095127911506723, 'support': 123750}, '2': {'precision': 0.5141358952733673, 'recall': 0.4600367478180983, 'f1-score': 0.4855841659595837, 'support': 91434}, 'accuracy': 0.5466081825641828, 'macro avg': {'precision': 0.5392075455617212, 'recall': 0.5373117859635405, 'f1-score': 0.537576426607838, 'support': 307092}, 'weighted avg': {'precision': 0.5449312868422962, 'recall': 0.5466081825641828, 'f1-score': 0.545115672343058, 'support': 307092}}
[[48351 26537 17020]
 [23575 77445 22730]
 [22982 26389 42063]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9824611
{'0': {'precision': 0.5159398112726346, 'recall': 0.4904480217222653, 'f1-score': 0.5028710631633896, 'support': 103120}, '1': {'precision': 0.48294312818356, 'recall': 0.6126629054728334, 'f1-score': 0.5401236046567337, 'support': 101209}, '2': {'precision': 0.523111821799115, 'recall': 0.4106633710576764, 'f1-score': 0.4601168800017445, 'support': 102763}, 'accuracy': 0.5040281088403475, 'macro avg': {'precision': 0.5073315870851032, 'recall': 0.504591432750925, 'f1-score': 0.5010371826072894, 'support': 307092}, 'weighted avg': {'precision': 0.5074650089950453, 'recall': 0.5040281088403475, 'f1-score': 0.5008415226600867, 'support': 307092}}
[[50575 33164 19381]
 [20111 62007 19091]
 [27339 33223 42201]]
Evaluating performance on  val set...
441/441 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8981082
{'0': {'precision': 0.4129339760602286, 'recall': 0.6153597804592599, 'f1-score': 0.4942225103314156, 'support': 24779}, '1': {'precision': 0.7883937092825428, 'recall': 0.5908631493834647, 'f1-score': 0.6754837390786516, 'support': 64311}, '2': {'precision': 0.4438247011952191, 'recall': 0.5182710201319574, 'f1-score': 0.47816755765403673, 'support': 23644}, 'accuracy': 0.581022584136108, 'macro avg': {'precision': 0.5483841288459969, 'recall': 0.5748313166582273, 'f1-score': 0.5492912690213679, 'support': 112734}, 'weighted avg': {'precision': 0.633600067996574, 'recall': 0.581022584136108, 'f1-score': 0.5942587689655414, 'support': 112734}}
[[15248  5447  4084]
 [15040 37999 11272]
 [ 6638  4752 12254]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.90537834
{'0': {'precision': 0.4740750779238379, 'recall': 0.5681478594166179, 'f1-score': 0.5168658855513364, 'support': 30786}, '1': {'precision': 0.6850478967097043, 'recall': 0.6252803649496294, 'f1-score': 0.653801053363808, 'support': 52610}, '2': {'precision': 0.5011682662928214, 'recall': 0.4752198513872793, 'f1-score': 0.487849257308816, 'support': 29338}, 'accuracy': 0.5706264303581883, 'macro avg': {'precision': 0.5534304136421212, 'recall': 0.5562160252511755, 'f1-score': 0.5528387320746535, 'support': 112734}, 'weighted avg': {'precision': 0.5795813134578709, 'recall': 0.5706264303581883, 'f1-score': 0.5732186215425642, 'support': 112734}}
[[17491  7977  5318]
 [11155 32896  8559]
 [ 8249  7147 13942]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9273168
{'0': {'precision': 0.49958735990203124, 'recall': 0.5417123722648808, 'f1-score': 0.519797797936431, 'support': 34642}, '1': {'precision': 0.6044412727730669, 'recall': 0.6364761525880741, 'f1-score': 0.6200452147701583, 'support': 45246}, '2': {'precision': 0.5213063537617612, 'recall': 0.4368872922121415, 'f1-score': 0.4753780663541649, 'support': 32846}, 'accuracy': 0.5492043216775773, 'macro avg': {'precision': 0.5417783288122865, 'recall': 0.5383586056883655, 'f1-score': 0.5384070263535847, 'support': 112734}, 'weighted avg': {'precision': 0.5479986840285553, 'recall': 0.5492043216775773, 'f1-score': 0.5470902218591847, 'support': 112734}}
[[18766  9882  5994]
 [ 9265 28798  7183]
 [ 9532  8964 14350]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.97328556
{'0': {'precision': 0.5029356232056488, 'recall': 0.5060507482108002, 'f1-score': 0.5044883769198838, 'support': 38425}, '1': {'precision': 0.5006060606060606, 'recall': 0.6230085216746943, 'f1-score': 0.555140253033215, 'support': 37786}, '2': {'precision': 0.524033128743622, 'recall': 0.38805684089477865, 'f1-score': 0.44590916956378107, 'support': 36523}, 'accuracy': 0.5070253871946352, 'macro avg': {'precision': 0.5091916041851104, 'recall': 0.5057053702600911, 'f1-score': 0.5018459331722933, 'support': 112734}, 'weighted avg': {'precision': 0.5089898689733441, 'recall': 0.5070253871946352, 'f1-score': 0.5024875910039347, 'support': 112734}}
[[19445 12231  6749]
 [ 8121 23541  6124]
 [11097 11253 14173]]
training model: results/WBA/W9/deepVOL_L3/seq2seq
Epoch 1/50
1200/1200 - 56s - loss: 12.7128 - accuracy10: 0.4437 - accuracy20: 0.4442 - accuracy30: 0.4394 - accuracy50: 0.4253 - val_loss: 12.6480 - val_accuracy10: 0.3294 - val_accuracy20: 0.3583 - val_accuracy30: 0.3826 - val_accuracy50: 0.4038 - 56s/epoch - 46ms/step
Epoch 2/50
1200/1200 - 47s - loss: 12.3140 - accuracy10: 0.4000 - accuracy20: 0.4291 - accuracy30: 0.4423 - accuracy50: 0.4400 - val_loss: 12.1754 - val_accuracy10: 0.3450 - val_accuracy20: 0.3991 - val_accuracy30: 0.4266 - val_accuracy50: 0.4374 - 47s/epoch - 39ms/step
Epoch 3/50
1200/1200 - 49s - loss: 11.8462 - accuracy10: 0.4739 - accuracy20: 0.4941 - accuracy30: 0.4964 - accuracy50: 0.4784 - val_loss: 11.4732 - val_accuracy10: 0.5353 - val_accuracy20: 0.5348 - val_accuracy30: 0.5247 - val_accuracy50: 0.4947 - 49s/epoch - 41ms/step
Epoch 4/50
1200/1200 - 47s - loss: 11.4906 - accuracy10: 0.5288 - accuracy20: 0.5335 - accuracy30: 0.5248 - accuracy50: 0.4981 - val_loss: 11.4426 - val_accuracy10: 0.5588 - val_accuracy20: 0.5483 - val_accuracy30: 0.5314 - val_accuracy50: 0.4956 - 47s/epoch - 39ms/step
Epoch 5/50
1200/1200 - 47s - loss: 11.3284 - accuracy10: 0.5464 - accuracy20: 0.5461 - accuracy30: 0.5341 - accuracy50: 0.5045 - val_loss: 11.2743 - val_accuracy10: 0.5808 - val_accuracy20: 0.5645 - val_accuracy30: 0.5430 - val_accuracy50: 0.5007 - 47s/epoch - 39ms/step
Epoch 6/50
1200/1200 - 48s - loss: 11.1971 - accuracy10: 0.5589 - accuracy20: 0.5568 - accuracy30: 0.5435 - accuracy50: 0.5112 - val_loss: 11.1731 - val_accuracy10: 0.5826 - val_accuracy20: 0.5685 - val_accuracy30: 0.5476 - val_accuracy50: 0.5066 - 48s/epoch - 40ms/step
Epoch 7/50
1200/1200 - 48s - loss: 11.0981 - accuracy10: 0.5671 - accuracy20: 0.5635 - accuracy30: 0.5486 - accuracy50: 0.5155 - val_loss: 11.0874 - val_accuracy10: 0.5913 - val_accuracy20: 0.5748 - val_accuracy30: 0.5520 - val_accuracy50: 0.5099 - 48s/epoch - 40ms/step
Epoch 8/50
1200/1200 - 47s - loss: 11.0219 - accuracy10: 0.5720 - accuracy20: 0.5682 - accuracy30: 0.5535 - accuracy50: 0.5191 - val_loss: 11.0895 - val_accuracy10: 0.5837 - val_accuracy20: 0.5688 - val_accuracy30: 0.5481 - val_accuracy50: 0.5092 - 47s/epoch - 40ms/step
Epoch 9/50
1200/1200 - 47s - loss: 10.9569 - accuracy10: 0.5742 - accuracy20: 0.5713 - accuracy30: 0.5566 - accuracy50: 0.5216 - val_loss: 11.0812 - val_accuracy10: 0.5900 - val_accuracy20: 0.5715 - val_accuracy30: 0.5490 - val_accuracy50: 0.5079 - 47s/epoch - 40ms/step
Epoch 10/50
1200/1200 - 48s - loss: 10.8956 - accuracy10: 0.5782 - accuracy20: 0.5748 - accuracy30: 0.5595 - accuracy50: 0.5250 - val_loss: 11.0242 - val_accuracy10: 0.5923 - val_accuracy20: 0.5746 - val_accuracy30: 0.5521 - val_accuracy50: 0.5114 - 48s/epoch - 40ms/step
Epoch 11/50
1200/1200 - 49s - loss: 10.8554 - accuracy10: 0.5812 - accuracy20: 0.5776 - accuracy30: 0.5616 - accuracy50: 0.5262 - val_loss: 10.9490 - val_accuracy10: 0.5924 - val_accuracy20: 0.5764 - val_accuracy30: 0.5561 - val_accuracy50: 0.5162 - 49s/epoch - 41ms/step
Epoch 12/50
1200/1200 - 47s - loss: 10.8156 - accuracy10: 0.5829 - accuracy20: 0.5787 - accuracy30: 0.5635 - accuracy50: 0.5273 - val_loss: 10.9688 - val_accuracy10: 0.5857 - val_accuracy20: 0.5740 - val_accuracy30: 0.5551 - val_accuracy50: 0.5188 - 47s/epoch - 39ms/step
Epoch 13/50
1200/1200 - 47s - loss: 10.7826 - accuracy10: 0.5849 - accuracy20: 0.5810 - accuracy30: 0.5646 - accuracy50: 0.5286 - val_loss: 10.9284 - val_accuracy10: 0.6002 - val_accuracy20: 0.5852 - val_accuracy30: 0.5624 - val_accuracy50: 0.5186 - 47s/epoch - 39ms/step
Epoch 14/50
1200/1200 - 48s - loss: 10.7477 - accuracy10: 0.5872 - accuracy20: 0.5830 - accuracy30: 0.5669 - accuracy50: 0.5302 - val_loss: 10.8783 - val_accuracy10: 0.5989 - val_accuracy20: 0.5839 - val_accuracy30: 0.5624 - val_accuracy50: 0.5218 - 48s/epoch - 40ms/step
Epoch 15/50
1200/1200 - 47s - loss: 10.7221 - accuracy10: 0.5889 - accuracy20: 0.5840 - accuracy30: 0.5680 - accuracy50: 0.5317 - val_loss: 10.9429 - val_accuracy10: 0.6097 - val_accuracy20: 0.5889 - val_accuracy30: 0.5646 - val_accuracy50: 0.5196 - 47s/epoch - 39ms/step
Epoch 16/50
1200/1200 - 47s - loss: 10.6945 - accuracy10: 0.5909 - accuracy20: 0.5868 - accuracy30: 0.5705 - accuracy50: 0.5343 - val_loss: 10.8631 - val_accuracy10: 0.5948 - val_accuracy20: 0.5823 - val_accuracy30: 0.5617 - val_accuracy50: 0.5225 - 47s/epoch - 39ms/step
Epoch 17/50
1200/1200 - 47s - loss: 10.6666 - accuracy10: 0.5914 - accuracy20: 0.5875 - accuracy30: 0.5718 - accuracy50: 0.5348 - val_loss: 10.8834 - val_accuracy10: 0.6124 - val_accuracy20: 0.5937 - val_accuracy30: 0.5681 - val_accuracy50: 0.5243 - 47s/epoch - 39ms/step
Epoch 18/50
1200/1200 - 47s - loss: 10.6454 - accuracy10: 0.5929 - accuracy20: 0.5891 - accuracy30: 0.5728 - accuracy50: 0.5357 - val_loss: 10.8662 - val_accuracy10: 0.6052 - val_accuracy20: 0.5885 - val_accuracy30: 0.5654 - val_accuracy50: 0.5223 - 47s/epoch - 39ms/step
Epoch 19/50
1200/1200 - 50s - loss: 10.6204 - accuracy10: 0.5929 - accuracy20: 0.5899 - accuracy30: 0.5745 - accuracy50: 0.5374 - val_loss: 10.8446 - val_accuracy10: 0.6002 - val_accuracy20: 0.5870 - val_accuracy30: 0.5643 - val_accuracy50: 0.5226 - 50s/epoch - 41ms/step
Epoch 20/50
1200/1200 - 47s - loss: 10.6010 - accuracy10: 0.5943 - accuracy20: 0.5913 - accuracy30: 0.5752 - accuracy50: 0.5384 - val_loss: 10.8297 - val_accuracy10: 0.6034 - val_accuracy20: 0.5882 - val_accuracy30: 0.5657 - val_accuracy50: 0.5225 - 47s/epoch - 39ms/step
Epoch 21/50
1200/1200 - 47s - loss: 10.5827 - accuracy10: 0.5956 - accuracy20: 0.5922 - accuracy30: 0.5766 - accuracy50: 0.5392 - val_loss: 10.8624 - val_accuracy10: 0.5873 - val_accuracy20: 0.5788 - val_accuracy30: 0.5598 - val_accuracy50: 0.5209 - 47s/epoch - 39ms/step
Epoch 22/50
1200/1200 - 47s - loss: 10.5688 - accuracy10: 0.5955 - accuracy20: 0.5921 - accuracy30: 0.5770 - accuracy50: 0.5405 - val_loss: 10.8278 - val_accuracy10: 0.6005 - val_accuracy20: 0.5861 - val_accuracy30: 0.5638 - val_accuracy50: 0.5228 - 47s/epoch - 40ms/step
Epoch 23/50
1200/1200 - 47s - loss: 10.5500 - accuracy10: 0.5961 - accuracy20: 0.5931 - accuracy30: 0.5778 - accuracy50: 0.5413 - val_loss: 10.8082 - val_accuracy10: 0.5823 - val_accuracy20: 0.5777 - val_accuracy30: 0.5605 - val_accuracy50: 0.5223 - 47s/epoch - 40ms/step
Epoch 24/50
1200/1200 - 47s - loss: 10.5285 - accuracy10: 0.5968 - accuracy20: 0.5936 - accuracy30: 0.5788 - accuracy50: 0.5420 - val_loss: 10.8470 - val_accuracy10: 0.5934 - val_accuracy20: 0.5828 - val_accuracy30: 0.5626 - val_accuracy50: 0.5219 - 47s/epoch - 39ms/step
Epoch 25/50
1200/1200 - 46s - loss: 10.5103 - accuracy10: 0.5975 - accuracy20: 0.5948 - accuracy30: 0.5798 - accuracy50: 0.5430 - val_loss: 10.8601 - val_accuracy10: 0.5988 - val_accuracy20: 0.5858 - val_accuracy30: 0.5632 - val_accuracy50: 0.5212 - 46s/epoch - 39ms/step
Epoch 26/50
1200/1200 - 48s - loss: 10.4884 - accuracy10: 0.5986 - accuracy20: 0.5959 - accuracy30: 0.5811 - accuracy50: 0.5443 - val_loss: 10.8565 - val_accuracy10: 0.5936 - val_accuracy20: 0.5818 - val_accuracy30: 0.5604 - val_accuracy50: 0.5193 - 48s/epoch - 40ms/step
Epoch 27/50
1200/1200 - 49s - loss: 10.4772 - accuracy10: 0.5993 - accuracy20: 0.5971 - accuracy30: 0.5823 - accuracy50: 0.5458 - val_loss: 10.8790 - val_accuracy10: 0.5904 - val_accuracy20: 0.5809 - val_accuracy30: 0.5610 - val_accuracy50: 0.5197 - 49s/epoch - 41ms/step
Epoch 28/50
1200/1200 - 47s - loss: 10.4559 - accuracy10: 0.6003 - accuracy20: 0.5976 - accuracy30: 0.5831 - accuracy50: 0.5463 - val_loss: 10.8888 - val_accuracy10: 0.5913 - val_accuracy20: 0.5809 - val_accuracy30: 0.5613 - val_accuracy50: 0.5216 - 47s/epoch - 39ms/step
Epoch 29/50
1200/1200 - 47s - loss: 10.4379 - accuracy10: 0.6011 - accuracy20: 0.5985 - accuracy30: 0.5842 - accuracy50: 0.5474 - val_loss: 10.9418 - val_accuracy10: 0.5785 - val_accuracy20: 0.5687 - val_accuracy30: 0.5505 - val_accuracy50: 0.5131 - 47s/epoch - 39ms/step
Epoch 30/50
1200/1200 - 48s - loss: 10.4281 - accuracy10: 0.6010 - accuracy20: 0.5994 - accuracy30: 0.5848 - accuracy50: 0.5484 - val_loss: 10.8786 - val_accuracy10: 0.5926 - val_accuracy20: 0.5818 - val_accuracy30: 0.5615 - val_accuracy50: 0.5188 - 48s/epoch - 40ms/step
Epoch 31/50
1200/1200 - 47s - loss: 10.4034 - accuracy10: 0.6015 - accuracy20: 0.5999 - accuracy30: 0.5855 - accuracy50: 0.5494 - val_loss: 10.9277 - val_accuracy10: 0.5907 - val_accuracy20: 0.5791 - val_accuracy30: 0.5572 - val_accuracy50: 0.5156 - 47s/epoch - 39ms/step
Epoch 32/50
1200/1200 - 47s - loss: 10.3939 - accuracy10: 0.6028 - accuracy20: 0.6003 - accuracy30: 0.5866 - accuracy50: 0.5506 - val_loss: 10.9003 - val_accuracy10: 0.5935 - val_accuracy20: 0.5811 - val_accuracy30: 0.5599 - val_accuracy50: 0.5181 - 47s/epoch - 39ms/step
Epoch 33/50
1200/1200 - 48s - loss: 10.3724 - accuracy10: 0.6032 - accuracy20: 0.6020 - accuracy30: 0.5873 - accuracy50: 0.5514 - val_loss: 10.8996 - val_accuracy10: 0.5937 - val_accuracy20: 0.5813 - val_accuracy30: 0.5604 - val_accuracy50: 0.5187 - 48s/epoch - 40ms/step
testing model: results/WBA/W9/deepVOL_L3/seq2seq
Evaluating performance on  test set...
2451/2451 - 39s - 39s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9642584
{'0': {'precision': 0.4120522947731177, 'recall': 0.5977578340285202, 'f1-score': 0.48782930613373476, 'support': 132818}, '1': {'precision': 0.8084565133015661, 'recall': 0.47087373352217016, 'f1-score': 0.5951253599354225, 'support': 367160}, '2': {'precision': 0.3794091940385025, 'recall': 0.6578048569835824, 'f1-score': 0.4812453328738009, 'support': 127363}, 'accuracy': 0.535687927299507, 'macro avg': {'precision': 0.5333060007043954, 'recall': 0.5754788081780909, 'f1-score': 0.5213999996476527, 'support': 627341}, 'weighted avg': {'precision': 0.6374261339388064, 'recall': 0.535687927299507, 'f1-score': 0.5492891254784336, 'support': 627341}}
[[ 79393  21485  31940]
 [ 89177 172886 105097]
 [ 24107  19476  83780]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9643732
{'0': {'precision': 0.4739076337553978, 'recall': 0.5744967792690212, 'f1-score': 0.5193766944915321, 'support': 169061}, '1': {'precision': 0.7037106818452263, 'recall': 0.47834424743268705, 'f1-score': 0.5695436788597088, 'support': 296711}, '2': {'precision': 0.44243525381952625, 'recall': 0.6043795530083123, 'f1-score': 0.5108808534125778, 'support': 161569}, 'accuracy': 0.5367160762647428, 'macro avg': {'precision': 0.5400178564733834, 'recall': 0.5524068599033402, 'f1-score': 0.5332670755879395, 'support': 627341}, 'weighted avg': {'precision': 0.5744910983271734, 'recall': 0.5367160762647428, 'f1-score': 0.5409159076970782, 'support': 627341}}
[[ 97125  30004  41932]
 [ 73654 141930  81127]
 [ 34166  29754  97649]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9720091
{'0': {'precision': 0.502986453059084, 'recall': 0.5611589760583215, 'f1-score': 0.5304826863823361, 'support': 193136}, '1': {'precision': 0.6203199580382901, 'recall': 0.4728328229075876, 'f1-score': 0.5366269783650356, 'support': 250118}, '2': {'precision': 0.4697628583569149, 'recall': 0.5645156909504745, 'f1-score': 0.5127990032197974, 'support': 184087}, 'accuracy': 0.5269287357274592, 'macro avg': {'precision': 0.5310230898180963, 'recall': 0.5328358299721279, 'f1-score': 0.5266362226557231, 'support': 627341}, 'weighted avg': {'precision': 0.5400176525509885, 'recall': 0.5269287357274592, 'f1-score': 0.5277432860239769, 'support': 627341}}
[[108380  35224  49532]
 [ 64088 118264  67766]
 [ 43005  37162 103920]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0003412
{'0': {'precision': 0.5128904102855151, 'recall': 0.5298682831565874, 'f1-score': 0.5212411324970706, 'support': 216601}, '1': {'precision': 0.5043849623389439, 'recall': 0.4476907317507683, 'f1-score': 0.4743498322147651, 'support': 202077}, '2': {'precision': 0.48145686798360443, 'recall': 0.5173221893675448, 'f1-score': 0.49874558181440154, 'support': 208663}, 'accuracy': 0.4992245046952136, 'macro avg': {'precision': 0.49957741353602114, 'recall': 0.49829373475830013, 'f1-score': 0.4981121821754124, 'support': 627341}, 'weighted avg': {'precision': 0.49969539729888923, 'recall': 0.4992245046952136, 'f1-score': 0.49865430590795046, 'support': 627341}}
[[114770  42403  59428]
 [ 54776  90468  56833]
 [ 54225  46492 107946]]
Evaluating performance on  train set...
1200/1200 - 19s - 19s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9137297
{'0': {'precision': 0.424890475417816, 'recall': 0.6070098440711493, 'f1-score': 0.49987909948203674, 'support': 64709}, '1': {'precision': 0.8318875639764224, 'recall': 0.5173867642765714, 'f1-score': 0.6379838494740522, 'support': 178124}, '2': {'precision': 0.4034988061310945, 'recall': 0.6521887984562473, 'f1-score': 0.49855165563307824, 'support': 64259}, 'accuracy': 0.5644790486238651, 'macro avg': {'precision': 0.5534256151751109, 'recall': 0.5921951356013226, 'f1-score': 0.5454715348630558, 'support': 307092}, 'weighted avg': {'precision': 0.6564866815245128, 'recall': 0.5644790486238651, 'f1-score': 0.5797068718541191, 'support': 307092}}
[[39279  9378 16052]
 [40062 92159 45903]
 [13104  9246 41909]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.913471
{'0': {'precision': 0.4844154784488913, 'recall': 0.5849786306364005, 'f1-score': 0.5299687006589041, 'support': 81191}, '1': {'precision': 0.737173674414165, 'recall': 0.5317295842140413, 'f1-score': 0.6178202297526479, 'support': 145243}, '2': {'precision': 0.4671800232065285, 'recall': 0.604007042078901, 'f1-score': 0.5268548007721464, 'support': 80658}, 'accuracy': 0.5647916585257838, 'macro avg': {'precision': 0.5629230586898616, 'recall': 0.573571752309781, 'f1-score': 0.5582145770612329, 'support': 307092}, 'weighted avg': {'precision': 0.5994337182846596, 'recall': 0.5647916585257838, 'f1-score': 0.5707013107662873, 'support': 307092}}
[[47495 13667 20029]
 [32479 77230 35534]
 [18072 13868 48718]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9270626
{'0': {'precision': 0.5080848913592724, 'recall': 0.5688949819384602, 'f1-score': 0.5367731603153746, 'support': 91908}, '1': {'precision': 0.6565878208354303, 'recall': 0.5271272727272728, 'f1-score': 0.5847781264007171, 'support': 123750}, '2': {'precision': 0.49407634927599825, 'recall': 0.5664851149463, 'f1-score': 0.5278089143416146, 'support': 91434}, 'accuracy': 0.5513461763901372, 'macro avg': {'precision': 0.552916353823567, 'recall': 0.554169123204011, 'f1-score': 0.549786733685902, 'support': 307092}, 'weighted avg': {'precision': 0.5637567437221879, 'recall': 0.5513461763901372, 'f1-score': 0.5534488721108508, 'support': 307092}}
[[52286 16726 22896]
 [28376 65232 30142]
 [22246 17392 51796]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.96342874
{'0': {'precision': 0.5161965354803596, 'recall': 0.5334464701318852, 'f1-score': 0.5246797592590826, 'support': 103120}, '1': {'precision': 0.5421910526147244, 'recall': 0.5018624825855408, 'f1-score': 0.5212478834214171, 'support': 101209}, '2': {'precision': 0.5019888623707239, 'recall': 0.5219290989947744, 'f1-score': 0.5117648181367123, 'support': 102763}, 'accuracy': 0.5191831763771118, 'macro avg': {'precision': 0.5201254834886027, 'recall': 0.5190793505707334, 'f1-score': 0.519230820272404, 'support': 307092}, 'weighted avg': {'precision': 0.5200092560099939, 'recall': 0.5191831763771118, 'f1-score': 0.5192269476709839, 'support': 307092}}
[[55009 20991 27120]
 [24326 50793 26090]
 [27231 21897 53635]]
Evaluating performance on  val set...
441/441 - 7s - 7s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8860217
{'0': {'precision': 0.4268259422898598, 'recall': 0.6315831954477582, 'f1-score': 0.5093986491984702, 'support': 24779}, '1': {'precision': 0.8388254720367578, 'recall': 0.5450389513458039, 'f1-score': 0.6607476106995418, 'support': 64311}, '2': {'precision': 0.4322511011930807, 'recall': 0.626712908137371, 'f1-score': 0.511627104013811, 'support': 23644}, 'accuracy': 0.5811911224652723, 'macro avg': {'precision': 0.5659675051732328, 'recall': 0.6011116849769778, 'f1-score': 0.560591121303941, 'support': 112734}, 'weighted avg': {'precision': 0.6629958130889134, 'recall': 0.5811911224652723, 'f1-score': 0.5962055809914459, 'support': 112734}}
[[15650  3561  5568]
 [15364 35052 13895]
 [ 5652  3174 14818]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.89068073
{'0': {'precision': 0.48121664334939634, 'recall': 0.6033261872279607, 'f1-score': 0.5353972097313502, 'support': 30786}, '1': {'precision': 0.7471542258486955, 'recall': 0.5639232085154914, 'f1-score': 0.642734894603436, 'support': 52610}, '2': {'precision': 0.490850470547229, 'recall': 0.5760106346717567, 'f1-score': 0.5300316783238717, 'support': 29338}, 'accuracy': 0.5778292263203647, 'macro avg': {'precision': 0.573073779915107, 'recall': 0.5810866768050696, 'f1-score': 0.569387927552886, 'support': 112734}, 'weighted avg': {'precision': 0.6078298517658293, 'recall': 0.5778292263203647, 'f1-score': 0.5840925602084719, 'support': 112734}}
[[18574  5177  7035]
 [12448 29668 10494]
 [ 7576  4863 16899]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.90983784
{'0': {'precision': 0.5018353174603175, 'recall': 0.5840886784827666, 'f1-score': 0.5398468557402417, 'support': 34642}, '1': {'precision': 0.6692474368459994, 'recall': 0.5597621889227777, 'f1-score': 0.609628114093152, 'support': 45246}, '2': {'precision': 0.5089962395140295, 'recall': 0.535712111063752, 'f1-score': 0.5220125786163522, 'support': 32846}, 'accuracy': 0.5602302765802686, 'macro avg': {'precision': 0.5600263312734488, 'recall': 0.5598543261564322, 'f1-score': 0.5571625161499153, 'support': 112734}, 'weighted avg': {'precision': 0.571112877020883, 'recall': 0.5602302765802686, 'f1-score': 0.5626575264254343, 'support': 112734}}
[[20234  6360  8048]
 [10993 25327  8926]
 [ 9093  6157 17596]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9534173
{'0': {'precision': 0.5047751930525151, 'recall': 0.5460767729342876, 'f1-score': 0.5246143460759557, 'support': 38425}, '1': {'precision': 0.5584494749383503, 'recall': 0.5333986132430001, 'f1-score': 0.5456366663508264, 'support': 37786}, '2': {'precision': 0.5084963220619262, 'recall': 0.488322426963831, 'f1-score': 0.4982052320627959, 'support': 36523}, 'accuracy': 0.5231163624106303, 'macro avg': {'precision': 0.5239069966842638, 'recall': 0.5225992710470395, 'f1-score': 0.5228187481631926, 'support': 112734}, 'weighted avg': {'precision': 0.5239712049934458, 'recall': 0.5231163624106303, 'f1-score': 0.5231046801615344, 'support': 112734}}
[[20983  8048  9394]
 [ 9786 20155  7845]
 [10800  7888 17835]]
training model: results/WBA/W10/deepLOB_L1/seq2seq
Epoch 1/50
1230/1230 - 35s - loss: 12.2839 - accuracy10: 0.4346 - accuracy20: 0.4499 - accuracy30: 0.4546 - accuracy50: 0.4508 - val_loss: 12.6461 - val_accuracy10: 0.3816 - val_accuracy20: 0.3984 - val_accuracy30: 0.4046 - val_accuracy50: 0.3972 - 35s/epoch - 28ms/step
Epoch 2/50
1230/1230 - 29s - loss: 12.1636 - accuracy10: 0.4315 - accuracy20: 0.4555 - accuracy30: 0.4625 - accuracy50: 0.4564 - val_loss: 12.0592 - val_accuracy10: 0.4422 - val_accuracy20: 0.4456 - val_accuracy30: 0.4420 - val_accuracy50: 0.4256 - 29s/epoch - 23ms/step
Epoch 3/50
1230/1230 - 30s - loss: 12.0864 - accuracy10: 0.4230 - accuracy20: 0.4523 - accuracy30: 0.4632 - accuracy50: 0.4579 - val_loss: 12.0184 - val_accuracy10: 0.4121 - val_accuracy20: 0.4368 - val_accuracy30: 0.4485 - val_accuracy50: 0.4394 - 30s/epoch - 24ms/step
Epoch 4/50
1230/1230 - 26s - loss: 11.9157 - accuracy10: 0.4441 - accuracy20: 0.4691 - accuracy30: 0.4758 - accuracy50: 0.4684 - val_loss: 11.7993 - val_accuracy10: 0.5025 - val_accuracy20: 0.4999 - val_accuracy30: 0.4927 - val_accuracy50: 0.4682 - 26s/epoch - 21ms/step
Epoch 5/50
1230/1230 - 28s - loss: 11.7143 - accuracy10: 0.4705 - accuracy20: 0.4895 - accuracy30: 0.4920 - accuracy50: 0.4806 - val_loss: 11.6211 - val_accuracy10: 0.5048 - val_accuracy20: 0.5025 - val_accuracy30: 0.4947 - val_accuracy50: 0.4732 - 28s/epoch - 22ms/step
Epoch 6/50
1230/1230 - 27s - loss: 11.5739 - accuracy10: 0.4883 - accuracy20: 0.5037 - accuracy30: 0.5037 - accuracy50: 0.4903 - val_loss: 11.5960 - val_accuracy10: 0.5533 - val_accuracy20: 0.5357 - val_accuracy30: 0.5171 - val_accuracy50: 0.4809 - 27s/epoch - 22ms/step
Epoch 7/50
1230/1230 - 27s - loss: 11.4796 - accuracy10: 0.5020 - accuracy20: 0.5141 - accuracy30: 0.5117 - accuracy50: 0.4962 - val_loss: 11.8479 - val_accuracy10: 0.5716 - val_accuracy20: 0.5451 - val_accuracy30: 0.5194 - val_accuracy50: 0.4754 - 27s/epoch - 22ms/step
Epoch 8/50
1230/1230 - 28s - loss: 11.4011 - accuracy10: 0.5116 - accuracy20: 0.5212 - accuracy30: 0.5171 - accuracy50: 0.5000 - val_loss: 11.9898 - val_accuracy10: 0.5850 - val_accuracy20: 0.5532 - val_accuracy30: 0.5246 - val_accuracy50: 0.4755 - 28s/epoch - 23ms/step
Epoch 9/50
1230/1230 - 29s - loss: 11.3508 - accuracy10: 0.5188 - accuracy20: 0.5264 - accuracy30: 0.5216 - accuracy50: 0.5029 - val_loss: 11.7430 - val_accuracy10: 0.5968 - val_accuracy20: 0.5648 - val_accuracy30: 0.5351 - val_accuracy50: 0.4844 - 29s/epoch - 23ms/step
Epoch 10/50
1230/1230 - 28s - loss: 11.3047 - accuracy10: 0.5219 - accuracy20: 0.5298 - accuracy30: 0.5241 - accuracy50: 0.5052 - val_loss: 11.9311 - val_accuracy10: 0.5752 - val_accuracy20: 0.5484 - val_accuracy30: 0.5232 - val_accuracy50: 0.4769 - 28s/epoch - 23ms/step
Epoch 11/50
1230/1230 - 29s - loss: 11.2524 - accuracy10: 0.5271 - accuracy20: 0.5339 - accuracy30: 0.5278 - accuracy50: 0.5082 - val_loss: 11.9213 - val_accuracy10: 0.5856 - val_accuracy20: 0.5584 - val_accuracy30: 0.5332 - val_accuracy50: 0.4854 - 29s/epoch - 23ms/step
Epoch 12/50
1230/1230 - 31s - loss: 11.2123 - accuracy10: 0.5311 - accuracy20: 0.5371 - accuracy30: 0.5306 - accuracy50: 0.5099 - val_loss: 11.8503 - val_accuracy10: 0.5914 - val_accuracy20: 0.5645 - val_accuracy30: 0.5377 - val_accuracy50: 0.4879 - 31s/epoch - 25ms/step
Epoch 13/50
1230/1230 - 29s - loss: 11.1753 - accuracy10: 0.5342 - accuracy20: 0.5400 - accuracy30: 0.5326 - accuracy50: 0.5118 - val_loss: 11.8249 - val_accuracy10: 0.5929 - val_accuracy20: 0.5678 - val_accuracy30: 0.5413 - val_accuracy50: 0.4906 - 29s/epoch - 24ms/step
Epoch 14/50
1230/1230 - 28s - loss: 11.1414 - accuracy10: 0.5374 - accuracy20: 0.5428 - accuracy30: 0.5348 - accuracy50: 0.5125 - val_loss: 11.7970 - val_accuracy10: 0.6010 - val_accuracy20: 0.5713 - val_accuracy30: 0.5440 - val_accuracy50: 0.4918 - 28s/epoch - 23ms/step
Epoch 15/50
1230/1230 - 27s - loss: 11.1089 - accuracy10: 0.5409 - accuracy20: 0.5459 - accuracy30: 0.5372 - accuracy50: 0.5150 - val_loss: 11.7321 - val_accuracy10: 0.5944 - val_accuracy20: 0.5689 - val_accuracy30: 0.5428 - val_accuracy50: 0.4946 - 27s/epoch - 22ms/step
Epoch 16/50
1230/1230 - 29s - loss: 11.0814 - accuracy10: 0.5423 - accuracy20: 0.5475 - accuracy30: 0.5395 - accuracy50: 0.5158 - val_loss: 11.8892 - val_accuracy10: 0.5970 - val_accuracy20: 0.5732 - val_accuracy30: 0.5479 - val_accuracy50: 0.4965 - 29s/epoch - 24ms/step
testing model: results/WBA/W10/deepLOB_L1/seq2seq
Evaluating performance on  test set...
6546/6546 - 60s - 60s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9063357
{'0': {'precision': 0.33804208054566803, 'recall': 0.17617692479530686, 'f1-score': 0.23163365641241748, 'support': 308877}, '1': {'precision': 0.7115115756934323, 'recall': 0.63161862544432, 'f1-score': 0.6691889781743011, 'support': 1061172}, '2': {'precision': 0.3300091659028414, 'recall': 0.618281433991888, 'f1-score': 0.43032914245385573, 'support': 305720}, 'accuracy': 0.5452386337257701, 'macro avg': {'precision': 0.45985427404731394, 'recall': 0.4753589947438383, 'f1-score': 0.44371725901352477, 'support': 1675769}, 'weighted avg': {'precision': 0.5730742051644778, 'recall': 0.5452386337257701, 'f1-score': 0.5449624266052604, 'support': 1675769}}
[[ 54417 174507  79953]
 [ 87115 670256 303801]
 [ 19445  97254 189021]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.97474176
{'0': {'precision': 0.4014004914004914, 'recall': 0.16486782418269982, 'f1-score': 0.23373381071095167, 'support': 396366}, '1': {'precision': 0.611777531944912, 'recall': 0.645603586836985, 'f1-score': 0.6282355652875418, 'support': 886575}, '2': {'precision': 0.3910550180645474, 'recall': 0.5747680918875436, 'f1-score': 0.4654391559695816, 'support': 392828}, 'accuracy': 0.5152911887020227, 'macro avg': {'precision': 0.46807768046998355, 'recall': 0.4617465009690762, 'f1-score': 0.442469510656025, 'support': 1675769}, 'weighted avg': {'precision': 0.5102764958623578, 'recall': 0.5152911887020227, 'f1-score': 0.4967627487274668, 'support': 1675769}}
[[ 65348 222193 108825]
 [ 71435 572376 242764]
 [ 26017 141026 225785]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0177329
{'0': {'precision': 0.4343025440265674, 'recall': 0.1574014895444173, 'f1-score': 0.2310610151840741, 'support': 455307}, '1': {'precision': 0.5390180427300917, 'recall': 0.6568497052446087, 'f1-score': 0.5921287585327152, 'support': 770639}, '2': {'precision': 0.42270546189895586, 'recall': 0.5371890721461553, 'f1-score': 0.4731202164714912, 'support': 449823}, 'accuracy': 0.4890292158406081, 'macro avg': {'precision': 0.4653420162185384, 'recall': 0.45048008897839376, 'f1-score': 0.43210333006276014, 'support': 1675769}, 'weighted avg': {'precision': 0.4793452754122755, 'recall': 0.4890292158406081, 'f1-score': 0.46208132930085466, 'support': 1675769}}
[[ 71666 256018 127623]
 [ 62057 506194 202388]
 [ 31291 176892 241640]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0792953
{'0': {'precision': 0.46315074503958115, 'recall': 0.14492091256183115, 'f1-score': 0.22076420693439078, 'support': 531690}, '1': {'precision': 0.43772295260425387, 'recall': 0.6727071208187348, 'f1-score': 0.5303518955587881, 'support': 621642}, '2': {'precision': 0.45257218766808294, 'recall': 0.47995069261939716, 'f1-score': 0.465859529075811, 'support': 522437}, 'accuracy': 0.4451568205403012, 'macro avg': {'precision': 0.4511486284373059, 'recall': 0.43252624199998774, 'f1-score': 0.40565854385633, 'support': 1675769}, 'weighted avg': {'precision': 0.45042010404874344, 'recall': 0.4451568205403012, 'f1-score': 0.4120194305036564, 'support': 1675769}}
[[ 77053 304797 149840]
 [ 50001 418183 153458]
 [ 39313 232380 250744]]
Evaluating performance on  train set...
1230/1230 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9365354
{'0': {'precision': 0.3468089511226545, 'recall': 0.5909120061570036, 'f1-score': 0.4370886060936703, 'support': 62368}, '1': {'precision': 0.7292074692610635, 'recall': 0.5404496148404339, 'f1-score': 0.6207973803884271, 'support': 190830}, '2': {'precision': 0.37284370294165886, 'recall': 0.40614240239069704, 'f1-score': 0.3887813561561842, 'support': 61572}, 'accuracy': 0.5241763827556629, 'macro avg': {'precision': 0.48295337444179226, 'recall': 0.5125013411293782, 'f1-score': 0.4822224475460939, 'support': 314770}, 'weighted avg': {'precision': 0.583731532548306, 'recall': 0.5241763827556629, 'f1-score': 0.5390130951031615, 'support': 314770}}
[[ 36854  17709   7805]
 [ 53437 103134  34259]
 [ 15975  20590  25007]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.97621787
{'0': {'precision': 0.4106492973255445, 'recall': 0.5555541528323087, 'f1-score': 0.47223578522640086, 'support': 79211}, '1': {'precision': 0.6268396841547126, 'recall': 0.5561397040126125, 'f1-score': 0.5893770253245573, 'support': 157304}, '2': {'precision': 0.4383946154072245, 'recall': 0.3812024790748195, 'f1-score': 0.40780309088796385, 'support': 78255}, 'accuracy': 0.5125011913460622, 'macro avg': {'precision': 0.49196119896249385, 'recall': 0.4976321119732468, 'f1-score': 0.4898053004796406, 'support': 314770}, 'weighted avg': {'precision': 0.5255866245049369, 'recall': 0.5125011913460622, 'f1-score': 0.5147576428905557, 'support': 314770}}
[[44006 24804 10401]
 [42007 87483 27814]
 [21149 27275 29831]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0073488
{'0': {'precision': 0.4407107424119279, 'recall': 0.5230392265560903, 'f1-score': 0.4783585229951784, 'support': 90194}, '1': {'precision': 0.5502305535436403, 'recall': 0.5663878820984874, 'f1-score': 0.5581923205633722, 'support': 135469}, '2': {'precision': 0.46943468072642064, 'recall': 0.3597136027472589, 'f1-score': 0.40731445417982426, 'support': 89107}, 'accuracy': 0.4954601772722941, 'macro avg': {'precision': 0.4867919922273296, 'recall': 0.4830469038006122, 'f1-score': 0.48128843257945836, 'support': 314770}, 'weighted avg': {'precision': 0.4959766294583156, 'recall': 0.4954601772722941, 'f1-score': 0.4926053727039686, 'support': 314770}}
[[47175 30442 12577]
 [35091 76728 23650]
 [24777 32277 32053]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0624546
{'0': {'precision': 0.4681135791765227, 'recall': 0.4743406100192899, 'f1-score': 0.4712065228218129, 'support': 104718}, '1': {'precision': 0.43750044335988764, 'recall': 0.5757737011623022, 'f1-score': 0.49720256042308253, 'support': 107115}, '2': {'precision': 0.49472595656670115, 'recall': 0.32532519890807, 'f1-score': 0.3925287322639442, 'support': 102937}, 'accuracy': 0.4601264415287353, 'macro avg': {'precision': 0.4667799930343705, 'recall': 0.45847983669655407, 'f1-score': 0.45364593850294654, 'support': 314770}, 'weighted avg': {'precision': 0.46639890575915105, 'recall': 0.4601264415287353, 'f1-score': 0.45432343307693457, 'support': 314770}}
[[49672 39295 15751]
 [26990 61674 18451]
 [29449 40000 33488]]
Evaluating performance on  val set...
444/444 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.89052564
{'0': {'precision': 0.31339809755110304, 'recall': 0.6356406177843912, 'f1-score': 0.4198112408289137, 'support': 19489}, '1': {'precision': 0.77601448503568, 'recall': 0.5821813823411905, 'f1-score': 0.6652666179693207, 'support': 75090}, '2': {'precision': 0.3782722513089005, 'recall': 0.3525324847520552, 'f1-score': 0.36494907623466105, 'support': 18855}, 'accuracy': 0.553193927746531, 'macro avg': {'precision': 0.4892282779652279, 'recall': 0.5234514949592123, 'f1-score': 0.4833423116776318, 'support': 113434}, 'weighted avg': {'precision': 0.6304200372280973, 'recall': 0.553193927746531, 'f1-score': 0.573176353194241, 'support': 113434}}
[[12388  5395  1706]
 [22155 43716  9219]
 [ 4985  7223  6647]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.93258035
{'0': {'precision': 0.3713321411480241, 'recall': 0.5918506623845845, 'f1-score': 0.45634779378762785, 'support': 24910}, '1': {'precision': 0.6838931338689762, 'recall': 0.5947308631985185, 'f1-score': 0.6362032227993074, 'support': 64261}, '2': {'precision': 0.43864858807709545, 'recall': 0.3226723818159337, 'f1-score': 0.37182683859324167, 'support': 24263}, 'accuracy': 0.5359063420138582, 'macro avg': {'precision': 0.4979579543646986, 'recall': 0.503084635799679, 'f1-score': 0.4881259517267256, 'support': 113434}, 'weighted avg': {'precision': 0.5627983761840906, 'recall': 0.5359063420138582, 'f1-score': 0.5401582720202402, 'support': 113434}}
[[14743  7961  2206]
 [18230 38218  7813]
 [ 6730  9704  7829]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9654543
{'0': {'precision': 0.4034386852085967, 'recall': 0.558272978552185, 'f1-score': 0.4683917746693869, 'support': 28581}, '1': {'precision': 0.6137646470420121, 'recall': 0.6041175850065051, 'f1-score': 0.6089029079761125, 'support': 56878}, '2': {'precision': 0.4730167597765363, 'recall': 0.3026630920464701, 'f1-score': 0.36913351498637603, 'support': 27975}, 'accuracy': 0.5182220498263307, 'macro avg': {'precision': 0.496740030675715, 'recall': 0.4883512185350534, 'f1-score': 0.48214273254395845, 'support': 113434}, 'weighted avg': {'precision': 0.5260594752115861, 'recall': 0.5182220498263307, 'f1-score': 0.5143677820885708, 'support': 113434}}
[[15956 10034  2591]
 [15675 34361  6842]
 [ 7919 11589  8467]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0223206
{'0': {'precision': 0.44098583250070456, 'recall': 0.5096071291115256, 'f1-score': 0.4728196676280731, 'support': 33777}, '1': {'precision': 0.5055148680843554, 'recall': 0.6128714777808683, 'f1-score': 0.5540404626513481, 'support': 46739}, '2': {'precision': 0.49983085250338294, 'recall': 0.2693055471170788, 'f1-score': 0.3500217159553047, 'support': 32918}, 'accuracy': 0.48242149620043373, 'macro avg': {'precision': 0.4821105176961476, 'recall': 0.4639280513364909, 'f1-score': 0.4589606154115753, 'support': 113434}, 'weighted avg': {'precision': 0.48465072100496626, 'recall': 0.48242149620043373, 'f1-score': 0.47065026308824076, 'support': 113434}}
[[17213 13366  3198]
 [12421 28645  5673]
 [ 9399 14654  8865]]
training model: results/WBA/W10/deepOF_L1/seq2seq
Epoch 1/50
1230/1230 - 31s - loss: 12.7928 - accuracy10: 0.4096 - accuracy20: 0.4186 - accuracy30: 0.4199 - accuracy50: 0.4154 - val_loss: 12.2584 - val_accuracy10: 0.5100 - val_accuracy20: 0.4808 - val_accuracy30: 0.4576 - val_accuracy50: 0.4219 - 31s/epoch - 25ms/step
Epoch 2/50
1230/1230 - 26s - loss: 12.7122 - accuracy10: 0.4108 - accuracy20: 0.4191 - accuracy30: 0.4202 - accuracy50: 0.4152 - val_loss: 12.2621 - val_accuracy10: 0.4026 - val_accuracy20: 0.4023 - val_accuracy30: 0.4003 - val_accuracy50: 0.3988 - 26s/epoch - 21ms/step
Epoch 3/50
1230/1230 - 28s - loss: 12.6558 - accuracy10: 0.4135 - accuracy20: 0.4231 - accuracy30: 0.4244 - accuracy50: 0.4190 - val_loss: 12.2500 - val_accuracy10: 0.3393 - val_accuracy20: 0.3613 - val_accuracy30: 0.3763 - val_accuracy50: 0.3911 - 28s/epoch - 23ms/step
Epoch 4/50
1230/1230 - 26s - loss: 12.6054 - accuracy10: 0.4279 - accuracy20: 0.4335 - accuracy30: 0.4326 - accuracy50: 0.4223 - val_loss: 12.1875 - val_accuracy10: 0.4418 - val_accuracy20: 0.4410 - val_accuracy30: 0.4382 - val_accuracy50: 0.4200 - 26s/epoch - 21ms/step
Epoch 5/50
1230/1230 - 26s - loss: 12.5800 - accuracy10: 0.4341 - accuracy20: 0.4381 - accuracy30: 0.4362 - accuracy50: 0.4244 - val_loss: 12.1857 - val_accuracy10: 0.4013 - val_accuracy20: 0.4095 - val_accuracy30: 0.4133 - val_accuracy50: 0.4079 - 26s/epoch - 21ms/step
Epoch 6/50
1230/1230 - 26s - loss: 12.5462 - accuracy10: 0.4383 - accuracy20: 0.4411 - accuracy30: 0.4382 - accuracy50: 0.4263 - val_loss: 12.1358 - val_accuracy10: 0.4663 - val_accuracy20: 0.4532 - val_accuracy30: 0.4441 - val_accuracy50: 0.4222 - 26s/epoch - 21ms/step
Epoch 7/50
1230/1230 - 26s - loss: 12.5165 - accuracy10: 0.4437 - accuracy20: 0.4458 - accuracy30: 0.4424 - accuracy50: 0.4293 - val_loss: 12.0986 - val_accuracy10: 0.4869 - val_accuracy20: 0.4641 - val_accuracy30: 0.4496 - val_accuracy50: 0.4269 - 26s/epoch - 22ms/step
Epoch 8/50
1230/1230 - 26s - loss: 12.4941 - accuracy10: 0.4456 - accuracy20: 0.4469 - accuracy30: 0.4445 - accuracy50: 0.4320 - val_loss: 12.0961 - val_accuracy10: 0.4654 - val_accuracy20: 0.4500 - val_accuracy30: 0.4405 - val_accuracy50: 0.4218 - 26s/epoch - 21ms/step
Epoch 9/50
1230/1230 - 27s - loss: 12.4687 - accuracy10: 0.4493 - accuracy20: 0.4506 - accuracy30: 0.4476 - accuracy50: 0.4344 - val_loss: 12.0594 - val_accuracy10: 0.5095 - val_accuracy20: 0.4819 - val_accuracy30: 0.4636 - val_accuracy50: 0.4311 - 27s/epoch - 22ms/step
Epoch 10/50
1230/1230 - 26s - loss: 12.4410 - accuracy10: 0.4530 - accuracy20: 0.4533 - accuracy30: 0.4496 - accuracy50: 0.4373 - val_loss: 12.0231 - val_accuracy10: 0.5351 - val_accuracy20: 0.4995 - val_accuracy30: 0.4752 - val_accuracy50: 0.4370 - 26s/epoch - 21ms/step
Epoch 11/50
1230/1230 - 27s - loss: 12.4102 - accuracy10: 0.4529 - accuracy20: 0.4543 - accuracy30: 0.4523 - accuracy50: 0.4399 - val_loss: 12.0002 - val_accuracy10: 0.5630 - val_accuracy20: 0.5221 - val_accuracy30: 0.4937 - val_accuracy50: 0.4471 - 27s/epoch - 22ms/step
Epoch 12/50
1230/1230 - 24s - loss: 12.3888 - accuracy10: 0.4542 - accuracy20: 0.4570 - accuracy30: 0.4543 - accuracy50: 0.4420 - val_loss: 12.0033 - val_accuracy10: 0.5208 - val_accuracy20: 0.4923 - val_accuracy30: 0.4736 - val_accuracy50: 0.4384 - 24s/epoch - 20ms/step
Epoch 13/50
1230/1230 - 27s - loss: 12.3607 - accuracy10: 0.4543 - accuracy20: 0.4580 - accuracy30: 0.4562 - accuracy50: 0.4444 - val_loss: 12.0067 - val_accuracy10: 0.5227 - val_accuracy20: 0.4918 - val_accuracy30: 0.4709 - val_accuracy50: 0.4368 - 27s/epoch - 22ms/step
Epoch 14/50
1230/1230 - 26s - loss: 12.3359 - accuracy10: 0.4557 - accuracy20: 0.4597 - accuracy30: 0.4580 - accuracy50: 0.4471 - val_loss: 11.9845 - val_accuracy10: 0.5344 - val_accuracy20: 0.5012 - val_accuracy30: 0.4800 - val_accuracy50: 0.4420 - 26s/epoch - 21ms/step
Epoch 15/50
1230/1230 - 25s - loss: 12.3066 - accuracy10: 0.4573 - accuracy20: 0.4622 - accuracy30: 0.4608 - accuracy50: 0.4491 - val_loss: 11.9790 - val_accuracy10: 0.5306 - val_accuracy20: 0.4996 - val_accuracy30: 0.4792 - val_accuracy50: 0.4429 - 25s/epoch - 21ms/step
Epoch 16/50
1230/1230 - 23s - loss: 12.2808 - accuracy10: 0.4584 - accuracy20: 0.4635 - accuracy30: 0.4627 - accuracy50: 0.4518 - val_loss: 11.9796 - val_accuracy10: 0.5351 - val_accuracy20: 0.5017 - val_accuracy30: 0.4806 - val_accuracy50: 0.4423 - 23s/epoch - 19ms/step
Epoch 17/50
1230/1230 - 27s - loss: 12.2572 - accuracy10: 0.4586 - accuracy20: 0.4644 - accuracy30: 0.4645 - accuracy50: 0.4554 - val_loss: 11.9601 - val_accuracy10: 0.5421 - val_accuracy20: 0.5068 - val_accuracy30: 0.4848 - val_accuracy50: 0.4468 - 27s/epoch - 22ms/step
Epoch 18/50
1230/1230 - 26s - loss: 12.2274 - accuracy10: 0.4604 - accuracy20: 0.4667 - accuracy30: 0.4672 - accuracy50: 0.4579 - val_loss: 11.9495 - val_accuracy10: 0.5554 - val_accuracy20: 0.5155 - val_accuracy30: 0.4896 - val_accuracy50: 0.4456 - 26s/epoch - 21ms/step
Epoch 19/50
1230/1230 - 26s - loss: 12.2056 - accuracy10: 0.4612 - accuracy20: 0.4677 - accuracy30: 0.4675 - accuracy50: 0.4593 - val_loss: 11.9351 - val_accuracy10: 0.5510 - val_accuracy20: 0.5134 - val_accuracy30: 0.4895 - val_accuracy50: 0.4488 - 26s/epoch - 22ms/step
Epoch 20/50
1230/1230 - 26s - loss: 12.1736 - accuracy10: 0.4605 - accuracy20: 0.4687 - accuracy30: 0.4698 - accuracy50: 0.4618 - val_loss: 11.9153 - val_accuracy10: 0.5440 - val_accuracy20: 0.5096 - val_accuracy30: 0.4878 - val_accuracy50: 0.4487 - 26s/epoch - 21ms/step
Epoch 21/50
1230/1230 - 24s - loss: 12.1480 - accuracy10: 0.4624 - accuracy20: 0.4710 - accuracy30: 0.4722 - accuracy50: 0.4639 - val_loss: 11.8911 - val_accuracy10: 0.5574 - val_accuracy20: 0.5217 - val_accuracy30: 0.4969 - val_accuracy50: 0.4537 - 24s/epoch - 19ms/step
Epoch 22/50
1230/1230 - 27s - loss: 12.1276 - accuracy10: 0.4637 - accuracy20: 0.4732 - accuracy30: 0.4741 - accuracy50: 0.4657 - val_loss: 11.8846 - val_accuracy10: 0.5577 - val_accuracy20: 0.5209 - val_accuracy30: 0.4970 - val_accuracy50: 0.4538 - 27s/epoch - 22ms/step
Epoch 23/50
1230/1230 - 27s - loss: 12.0985 - accuracy10: 0.4668 - accuracy20: 0.4761 - accuracy30: 0.4770 - accuracy50: 0.4693 - val_loss: 11.9014 - val_accuracy10: 0.5759 - val_accuracy20: 0.5340 - val_accuracy30: 0.5053 - val_accuracy50: 0.4584 - 27s/epoch - 22ms/step
Epoch 24/50
1230/1230 - 25s - loss: 12.0728 - accuracy10: 0.4673 - accuracy20: 0.4770 - accuracy30: 0.4781 - accuracy50: 0.4704 - val_loss: 11.9082 - val_accuracy10: 0.5764 - val_accuracy20: 0.5362 - val_accuracy30: 0.5086 - val_accuracy50: 0.4585 - 25s/epoch - 21ms/step
Epoch 25/50
1230/1230 - 25s - loss: 12.0504 - accuracy10: 0.4681 - accuracy20: 0.4787 - accuracy30: 0.4805 - accuracy50: 0.4722 - val_loss: 11.8914 - val_accuracy10: 0.5659 - val_accuracy20: 0.5292 - val_accuracy30: 0.5030 - val_accuracy50: 0.4573 - 25s/epoch - 20ms/step
Epoch 26/50
1230/1230 - 26s - loss: 12.0324 - accuracy10: 0.4702 - accuracy20: 0.4805 - accuracy30: 0.4822 - accuracy50: 0.4745 - val_loss: 11.9912 - val_accuracy10: 0.5949 - val_accuracy20: 0.5504 - val_accuracy30: 0.5170 - val_accuracy50: 0.4619 - 26s/epoch - 21ms/step
Epoch 27/50
1230/1230 - 26s - loss: 12.0084 - accuracy10: 0.4690 - accuracy20: 0.4808 - accuracy30: 0.4834 - accuracy50: 0.4758 - val_loss: 12.0016 - val_accuracy10: 0.5995 - val_accuracy20: 0.5529 - val_accuracy30: 0.5178 - val_accuracy50: 0.4609 - 26s/epoch - 21ms/step
Epoch 28/50
1230/1230 - 27s - loss: 11.9865 - accuracy10: 0.4744 - accuracy20: 0.4849 - accuracy30: 0.4858 - accuracy50: 0.4773 - val_loss: 12.0714 - val_accuracy10: 0.6024 - val_accuracy20: 0.5531 - val_accuracy30: 0.5167 - val_accuracy50: 0.4594 - 27s/epoch - 22ms/step
Epoch 29/50
1230/1230 - 27s - loss: 11.9532 - accuracy10: 0.4746 - accuracy20: 0.4868 - accuracy30: 0.4889 - accuracy50: 0.4807 - val_loss: 12.1412 - val_accuracy10: 0.6101 - val_accuracy20: 0.5583 - val_accuracy30: 0.5205 - val_accuracy50: 0.4601 - 27s/epoch - 22ms/step
Epoch 30/50
1230/1230 - 27s - loss: 11.9371 - accuracy10: 0.4747 - accuracy20: 0.4874 - accuracy30: 0.4902 - accuracy50: 0.4818 - val_loss: 12.0126 - val_accuracy10: 0.6026 - val_accuracy20: 0.5561 - val_accuracy30: 0.5210 - val_accuracy50: 0.4646 - 27s/epoch - 22ms/step
Epoch 31/50
1230/1230 - 26s - loss: 11.9155 - accuracy10: 0.4768 - accuracy20: 0.4886 - accuracy30: 0.4907 - accuracy50: 0.4827 - val_loss: 12.0761 - val_accuracy10: 0.6055 - val_accuracy20: 0.5574 - val_accuracy30: 0.5204 - val_accuracy50: 0.4626 - 26s/epoch - 21ms/step
Epoch 32/50
1230/1230 - 27s - loss: 11.8888 - accuracy10: 0.4789 - accuracy20: 0.4906 - accuracy30: 0.4932 - accuracy50: 0.4855 - val_loss: 12.1559 - val_accuracy10: 0.6070 - val_accuracy20: 0.5571 - val_accuracy30: 0.5202 - val_accuracy50: 0.4622 - 27s/epoch - 22ms/step
testing model: results/WBA/W10/deepOF_L1/seq2seq
Evaluating performance on  test set...
6546/6546 - 65s - 65s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9648628
{'0': {'precision': 0.30908712194851, 'recall': 0.3603172804532578, 'f1-score': 0.3327418547115234, 'support': 308875}, '1': {'precision': 0.6816592069569946, 'recall': 0.6237326500629965, 'f1-score': 0.6514106876164091, 'support': 1061171}, '2': {'precision': 0.2974731650710763, 'recall': 0.335403868924957, 'f1-score': 0.31530185203976524, 'support': 305718}, 'accuracy': 0.5225789550318541, 'macro avg': {'precision': 0.4294064979921936, 'recall': 0.4398179331470704, 'f1-score': 0.43315146478923255, 'support': 1675764}, 'weighted avg': {'precision': 0.5428981456677707, 'recall': 0.5225789550318541, 'f1-score': 0.5313559801765089, 'support': 1675764}}
[[111293 155721  41861]
 [198984 661887 200300]
 [ 49793 153386 102539]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.00577
{'0': {'precision': 0.36434995698532285, 'recall': 0.3526077040296293, 'f1-score': 0.3583826738499963, 'support': 396364}, '1': {'precision': 0.5764597244229666, 'recall': 0.6097758226884359, 'f1-score': 0.5926499227960704, 'support': 886575}, '2': {'precision': 0.3583897731120894, 'recall': 0.32329663336091136, 'f1-score': 0.33993990778722805, 'support': 392825}, 'accuracy': 0.48179337901995745, 'macro avg': {'precision': 0.4330664848401263, 'recall': 0.4285600533596588, 'f1-score': 0.4303241681444316, 'support': 1675764}, 'weighted avg': {'precision': 0.47517099612688807, 'recall': 0.48179337901995745, 'f1-score': 0.4780001776606515, 'support': 1675764}}
[[139761 198365  58238]
 [176840 540612 169123]
 [ 66989 198837 126999]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0328494
{'0': {'precision': 0.39916178263979296, 'recall': 0.3407540000658899, 'f1-score': 0.3676525823265051, 'support': 455305}, '1': {'precision': 0.5033630151790434, 'recall': 0.6104440600592496, 'f1-score': 0.5517561694494014, 'support': 770639}, '2': {'precision': 0.39410900301840546, 'recall': 0.3088457605264328, 'f1-score': 0.34630647967653966, 'support': 449820}, 'accuracy': 0.4562122112660255, 'macro avg': {'precision': 0.43221126694574724, 'recall': 0.42001460688385744, 'f1-score': 0.42190507715081543, 'support': 1675764}, 'weighted avg': {'precision': 0.44572483824519016, 'recall': 0.4562122112660255, 'f1-score': 0.44658702678455175, 'support': 1675764}}
[[155147 231427  68731]
 [155359 470432 144848]
 [ 78176 232719 138925]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0694017
{'0': {'precision': 0.4369403655661624, 'recall': 0.3109461017478328, 'f1-score': 0.363330289574632, 'support': 531687}, '1': {'precision': 0.40412497767360533, 'recall': 0.6223903790284441, 'f1-score': 0.49005306425657785, 'support': 621642}, '2': {'precision': 0.4329406920486463, 'recall': 0.2817613674428398, 'f1-score': 0.3413617179166087, 'support': 522435}, 'accuracy': 0.41738096772576566, 'macro avg': {'precision': 0.4246686784294713, 'recall': 0.4050326160730389, 'f1-score': 0.3982483572492728, 'support': 1675764}, 'weighted avg': {'precision': 0.4235202223989691, 'recall': 0.41738096772576566, 'f1-score': 0.40349050805687336, 'support': 1675764}}
[[165326 285541  80820]
 [122755 386904 111983]
 [ 90291 284942 147202]]
Evaluating performance on  train set...
1230/1230 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.95574003
{'0': {'precision': 0.3476686960554068, 'recall': 0.3723426410983483, 'f1-score': 0.35958289498112506, 'support': 62421}, '1': {'precision': 0.6603333884502501, 'recall': 0.6699888329077954, 'f1-score': 0.6651260711952888, 'support': 190739}, '2': {'precision': 0.3568184743238523, 'recall': 0.31500779119594857, 'f1-score': 0.33461210203712166, 'support': 61608}, 'accuracy': 0.5414845219336146, 'macro avg': {'precision': 0.45494018627650307, 'recall': 0.45244642173403077, 'f1-score': 0.45310702273784526, 'support': 314768}, 'weighted avg': {'precision': 0.5389240025105179, 'recall': 0.5414845219336146, 'f1-score': 0.539844545708706, 'support': 314768}}
[[ 23242  32217   6962]
 [ 34926 127793  28020]
 [  8683  33518  19407]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9981085
{'0': {'precision': 0.41013772700893175, 'recall': 0.36554134181111697, 'f1-score': 0.386557536704622, 'support': 79266}, '1': {'precision': 0.5532230534862576, 'recall': 0.6611025683386497, 'f1-score': 0.6023708549841509, 'support': 157378}, '2': {'precision': 0.41939915081885326, 'recall': 0.3009190517638626, 'f1-score': 0.35041512021344784, 'support': 78124}, 'accuracy': 0.49727735983327404, 'macro avg': {'precision': 0.46091997710468086, 'recall': 0.44252098730454303, 'f1-score': 0.4464478373007403, 'support': 314768}, 'weighted avg': {'precision': 0.4839763064835762, 'recall': 0.49727735983327404, 'f1-score': 0.4854896970838194, 'support': 314768}}
[[ 28975  40962   9329]
 [ 30119 104043  23216]
 [ 11553  43062  23509]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0281115
{'0': {'precision': 0.44563636363636366, 'recall': 0.3529118578738675, 'f1-score': 0.39389069511577024, 'support': 90286}, '1': {'precision': 0.4796345093186255, 'recall': 0.6638097136402897, 'f1-score': 0.5568895095886762, 'support': 135459}, '2': {'precision': 0.4533641610208983, 'recall': 0.2841400536939892, 'f1-score': 0.3493374396652326, 'support': 89023}, 'accuracy': 0.4672552483098663, 'macro avg': {'precision': 0.45954501132529585, 'recall': 0.4336205417360488, 'f1-score': 0.4333725481232264, 'support': 314768}, 'weighted avg': {'precision': 0.4624528968371241, 'recall': 0.4672552483098663, 'f1-score': 0.45143590920904575, 'support': 314768}}
[[31863 47475 10948]
 [25989 89919 19551]
 [13648 50080 25295]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0707477
{'0': {'precision': 0.4827132038195588, 'recall': 0.3217397112567868, 'f1-score': 0.3861208130546808, 'support': 104799}, '1': {'precision': 0.3769692206941716, 'recall': 0.6727565121454083, 'f1-score': 0.4831900184333963, 'support': 106954}, '2': {'precision': 0.48608489693201584, 'recall': 0.2550016987817308, 'f1-score': 0.3345154943746537, 'support': 103015}, 'accuracy': 0.4191690387841204, 'macro avg': {'precision': 0.44858910714858213, 'recall': 0.41649930739464197, 'f1-score': 0.40127544195424364, 'support': 314768}, 'weighted avg': {'precision': 0.4478862614200363, 'recall': 0.4191690387841204, 'f1-score': 0.40221462782699613, 'support': 314768}}
[[33718 58196 12885]
 [20112 71954 14888]
 [16021 60725 26269]]
Evaluating performance on  val set...
444/444 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.93474805
{'0': {'precision': 0.31431677268701186, 'recall': 0.39970305140282614, 'f1-score': 0.35190443993689435, 'support': 19532}, '1': {'precision': 0.7243877763561163, 'recall': 0.6486850169202484, 'f1-score': 0.6844495051731895, 'support': 75058}, '2': {'precision': 0.31646398503274087, 'recall': 0.35909139157201997, 'f1-score': 0.3364327979712595, 'support': 18842}, 'accuracy': 0.5577085831158756, 'macro avg': {'precision': 0.45172284469195634, 'recall': 0.4691598199650315, 'f1-score': 0.45759558102711445, 'support': 113432}, 'weighted avg': {'precision': 0.5860175905198445, 'recall': 0.5577085831158756, 'f1-score': 0.5693796746906619, 'support': 113432}}
[[ 7807  9232  2493]
 [14248 48689 12121]
 [ 2783  9293  6766]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.97086084
{'0': {'precision': 0.3724296381390006, 'recall': 0.3905396723417925, 'f1-score': 0.381269723044356, 'support': 24904}, '1': {'precision': 0.6299561490626289, 'recall': 0.6417819840293885, 'f1-score': 0.6358140825956882, 'support': 64243}, '2': {'precision': 0.3784982623010792, 'recall': 0.3408276714021001, 'f1-score': 0.3586765757372219, 'support': 24285}, 'accuracy': 0.5221895056068834, 'macro avg': {'precision': 0.46029468316756955, 'recall': 0.45771644259109373, 'f1-score': 0.458586793792422, 'support': 113432}, 'weighted avg': {'precision': 0.5195808139892256, 'recall': 0.5221895056068834, 'f1-score': 0.5205956514270211, 'support': 113432}}
[[ 9726 11888  3290]
 [12712 41230 10301]
 [ 3677 12331  8277]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9988036
{'0': {'precision': 0.40736961451247167, 'recall': 0.37638801592289967, 'f1-score': 0.3912664706522923, 'support': 28638}, '1': {'precision': 0.5614558929364387, 'recall': 0.6451028343215046, 'f1-score': 0.6003798732664188, 'support': 56839}, '2': {'precision': 0.41347795984306485, 'recall': 0.32044357002325163, 'f1-score': 0.3610640870616687, 'support': 27955}, 'accuracy': 0.4972494534170252, 'macro avg': {'precision': 0.4607678224306584, 'recall': 0.447311473422552, 'f1-score': 0.45090347699345995, 'support': 113432}, 'weighted avg': {'precision': 0.48608522186363007, 'recall': 0.4972494534170252, 'f1-score': 0.4886066309060871, 'support': 113432}}
[[10779 14002  3857]
 [11322 36667  8850]
 [ 4359 14638  8958]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0404588
{'0': {'precision': 0.4463087248322148, 'recall': 0.3420336979012711, 'f1-score': 0.3872749179998662, 'support': 33830}, '1': {'precision': 0.4593395019935304, 'recall': 0.6539713820580927, 'f1-score': 0.5396424184040512, 'support': 46684}, '2': {'precision': 0.4440378309015731, 'recall': 0.28382647791481863, 'f1-score': 0.3462999684945977, 'support': 32918}, 'accuracy': 0.4535228154312716, 'macro avg': {'precision': 0.44989535257577273, 'recall': 0.4266105192913942, 'f1-score': 0.42440576829950505, 'support': 113432}, 'weighted avg': {'precision': 0.45101264889764603, 'recall': 0.4535228154312716, 'f1-score': 0.4380922446894648, 'support': 113432}}
[[11571 17587  4672]
 [ 9128 30530  7026]
 [ 5227 18348  9343]]
training model: results/WBA/W10/deepLOB_L2/seq2seq
Epoch 1/50
1230/1230 - 63s - loss: 12.3138 - accuracy10: 0.4368 - accuracy20: 0.4529 - accuracy30: 0.4566 - accuracy50: 0.4512 - val_loss: 12.7799 - val_accuracy10: 0.3964 - val_accuracy20: 0.3829 - val_accuracy30: 0.3745 - val_accuracy50: 0.3577 - 63s/epoch - 51ms/step
Epoch 2/50
1230/1230 - 57s - loss: 12.1592 - accuracy10: 0.4160 - accuracy20: 0.4463 - accuracy30: 0.4575 - accuracy50: 0.4549 - val_loss: 12.3157 - val_accuracy10: 0.5528 - val_accuracy20: 0.5137 - val_accuracy30: 0.4821 - val_accuracy50: 0.4245 - 57s/epoch - 46ms/step
Epoch 3/50
1230/1230 - 58s - loss: 11.8208 - accuracy10: 0.4634 - accuracy20: 0.4856 - accuracy30: 0.4903 - accuracy50: 0.4787 - val_loss: 11.8183 - val_accuracy10: 0.5161 - val_accuracy20: 0.4963 - val_accuracy30: 0.4808 - val_accuracy50: 0.4510 - 58s/epoch - 47ms/step
Epoch 4/50
1230/1230 - 57s - loss: 11.4320 - accuracy10: 0.5204 - accuracy20: 0.5281 - accuracy30: 0.5223 - accuracy50: 0.5000 - val_loss: 11.7966 - val_accuracy10: 0.5153 - val_accuracy20: 0.5071 - val_accuracy30: 0.4948 - val_accuracy50: 0.4647 - 57s/epoch - 46ms/step
Epoch 5/50
1230/1230 - 58s - loss: 11.1696 - accuracy10: 0.5506 - accuracy20: 0.5507 - accuracy30: 0.5393 - accuracy50: 0.5121 - val_loss: 11.4352 - val_accuracy10: 0.5494 - val_accuracy20: 0.5352 - val_accuracy30: 0.5159 - val_accuracy50: 0.4780 - 58s/epoch - 47ms/step
Epoch 6/50
1230/1230 - 57s - loss: 11.0201 - accuracy10: 0.5628 - accuracy20: 0.5605 - accuracy30: 0.5477 - accuracy50: 0.5182 - val_loss: 11.0815 - val_accuracy10: 0.5739 - val_accuracy20: 0.5576 - val_accuracy30: 0.5381 - val_accuracy50: 0.4998 - 57s/epoch - 47ms/step
Epoch 7/50
1230/1230 - 57s - loss: 10.9162 - accuracy10: 0.5709 - accuracy20: 0.5677 - accuracy30: 0.5539 - accuracy50: 0.5223 - val_loss: 10.8919 - val_accuracy10: 0.5809 - val_accuracy20: 0.5653 - val_accuracy30: 0.5461 - val_accuracy50: 0.5080 - 57s/epoch - 47ms/step
Epoch 8/50
1230/1230 - 57s - loss: 10.8487 - accuracy10: 0.5765 - accuracy20: 0.5718 - accuracy30: 0.5570 - accuracy50: 0.5249 - val_loss: 10.7363 - val_accuracy10: 0.5872 - val_accuracy20: 0.5751 - val_accuracy30: 0.5554 - val_accuracy50: 0.5173 - 57s/epoch - 47ms/step
Epoch 9/50
1230/1230 - 57s - loss: 10.7875 - accuracy10: 0.5785 - accuracy20: 0.5738 - accuracy30: 0.5595 - accuracy50: 0.5270 - val_loss: 10.7777 - val_accuracy10: 0.5788 - val_accuracy20: 0.5657 - val_accuracy30: 0.5483 - val_accuracy50: 0.5131 - 57s/epoch - 46ms/step
Epoch 10/50
1230/1230 - 57s - loss: 10.7447 - accuracy10: 0.5790 - accuracy20: 0.5752 - accuracy30: 0.5609 - accuracy50: 0.5292 - val_loss: 10.7541 - val_accuracy10: 0.5802 - val_accuracy20: 0.5690 - val_accuracy30: 0.5519 - val_accuracy50: 0.5174 - 57s/epoch - 47ms/step
Epoch 11/50
1230/1230 - 57s - loss: 10.7028 - accuracy10: 0.5810 - accuracy20: 0.5769 - accuracy30: 0.5629 - accuracy50: 0.5305 - val_loss: 10.6602 - val_accuracy10: 0.5910 - val_accuracy20: 0.5768 - val_accuracy30: 0.5584 - val_accuracy50: 0.5202 - 57s/epoch - 46ms/step
Epoch 12/50
1230/1230 - 59s - loss: 10.6637 - accuracy10: 0.5829 - accuracy20: 0.5787 - accuracy30: 0.5651 - accuracy50: 0.5329 - val_loss: 10.7086 - val_accuracy10: 0.5765 - val_accuracy20: 0.5661 - val_accuracy30: 0.5496 - val_accuracy50: 0.5174 - 59s/epoch - 48ms/step
Epoch 13/50
1230/1230 - 57s - loss: 10.6356 - accuracy10: 0.5842 - accuracy20: 0.5805 - accuracy30: 0.5669 - accuracy50: 0.5348 - val_loss: 10.7070 - val_accuracy10: 0.5794 - val_accuracy20: 0.5683 - val_accuracy30: 0.5502 - val_accuracy50: 0.5179 - 57s/epoch - 46ms/step
Epoch 14/50
1230/1230 - 57s - loss: 10.6006 - accuracy10: 0.5864 - accuracy20: 0.5829 - accuracy30: 0.5689 - accuracy50: 0.5360 - val_loss: 10.7465 - val_accuracy10: 0.5780 - val_accuracy20: 0.5663 - val_accuracy30: 0.5485 - val_accuracy50: 0.5161 - 57s/epoch - 46ms/step
Epoch 15/50
1230/1230 - 57s - loss: 10.5758 - accuracy10: 0.5860 - accuracy20: 0.5834 - accuracy30: 0.5697 - accuracy50: 0.5371 - val_loss: 10.7064 - val_accuracy10: 0.5901 - val_accuracy20: 0.5765 - val_accuracy30: 0.5582 - val_accuracy50: 0.5215 - 57s/epoch - 46ms/step
Epoch 16/50
1230/1230 - 57s - loss: 10.5458 - accuracy10: 0.5882 - accuracy20: 0.5849 - accuracy30: 0.5715 - accuracy50: 0.5389 - val_loss: 10.7085 - val_accuracy10: 0.5920 - val_accuracy20: 0.5753 - val_accuracy30: 0.5558 - val_accuracy50: 0.5191 - 57s/epoch - 46ms/step
Epoch 17/50
1230/1230 - 57s - loss: 10.5242 - accuracy10: 0.5884 - accuracy20: 0.5860 - accuracy30: 0.5729 - accuracy50: 0.5407 - val_loss: 10.7309 - val_accuracy10: 0.5827 - val_accuracy20: 0.5699 - val_accuracy30: 0.5523 - val_accuracy50: 0.5180 - 57s/epoch - 46ms/step
Epoch 18/50
1230/1230 - 58s - loss: 10.4982 - accuracy10: 0.5895 - accuracy20: 0.5873 - accuracy30: 0.5743 - accuracy50: 0.5417 - val_loss: 10.7159 - val_accuracy10: 0.5889 - val_accuracy20: 0.5734 - val_accuracy30: 0.5543 - val_accuracy50: 0.5186 - 58s/epoch - 47ms/step
Epoch 19/50
1230/1230 - 58s - loss: 10.4708 - accuracy10: 0.5908 - accuracy20: 0.5883 - accuracy30: 0.5752 - accuracy50: 0.5427 - val_loss: 10.7675 - val_accuracy10: 0.5883 - val_accuracy20: 0.5737 - val_accuracy30: 0.5569 - val_accuracy50: 0.5205 - 58s/epoch - 47ms/step
Epoch 20/50
1230/1230 - 57s - loss: 10.4535 - accuracy10: 0.5922 - accuracy20: 0.5889 - accuracy30: 0.5761 - accuracy50: 0.5438 - val_loss: 10.8036 - val_accuracy10: 0.5786 - val_accuracy20: 0.5633 - val_accuracy30: 0.5461 - val_accuracy50: 0.5126 - 57s/epoch - 46ms/step
Epoch 21/50
1230/1230 - 57s - loss: 10.4290 - accuracy10: 0.5927 - accuracy20: 0.5901 - accuracy30: 0.5774 - accuracy50: 0.5455 - val_loss: 10.8744 - val_accuracy10: 0.5924 - val_accuracy20: 0.5733 - val_accuracy30: 0.5533 - val_accuracy50: 0.5146 - 57s/epoch - 46ms/step
testing model: results/WBA/W10/deepLOB_L2/seq2seq
Evaluating performance on  test set...
6546/6546 - 103s - 103s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9157896
{'0': {'precision': 0.40301361404626984, 'recall': 0.26202663196029485, 'f1-score': 0.31757566720750874, 'support': 308877}, '1': {'precision': 0.749868896571853, 'recall': 0.5955905357472682, 'f1-score': 0.6638844800836967, 'support': 1061172}, '2': {'precision': 0.32533092021686405, 'recall': 0.672648174800471, 'f1-score': 0.4385527728639047, 'support': 305720}, 'accuracy': 0.5481662448702656, 'macro avg': {'precision': 0.492737810278329, 'recall': 0.510088447502678, 'f1-score': 0.47333764005170337, 'support': 1675769}, 'weighted avg': {'precision': 0.6084858245422942, 'recall': 0.5481662448702656, 'f1-score': 0.5589444574875077, 'support': 1675769}}
[[ 80934 138175  89768]
 [ 92457 632024 336691]
 [ 27431  72647 205642]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.96631277
{'0': {'precision': 0.46559191876555883, 'recall': 0.2448948698929777, 'f1-score': 0.3209660592974445, 'support': 396366}, '1': {'precision': 0.6584791776587823, 'recall': 0.5954487775991879, 'f1-score': 0.6253798230868468, 'support': 886575}, '2': {'precision': 0.3818833339593585, 'recall': 0.6470312706833525, 'f1-score': 0.4802934232045828, 'support': 392828}, 'accuracy': 0.5246248140405987, 'macro avg': {'precision': 0.5019848101279, 'recall': 0.4957916393918394, 'f1-score': 0.4755464351962913, 'support': 1675769}, 'weighted avg': {'precision': 0.5480173279961923, 'recall': 0.5246248140405987, 'f1-score': 0.5193668426634709, 'support': 1675769}}
[[ 97068 171489 127809]
 [ 75071 527910 283594]
 [ 36344 102312 254172]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.99620783
{'0': {'precision': 0.492999627714971, 'recall': 0.2297702429349867, 'f1-score': 0.3134514838729008, 'support': 455307}, '1': {'precision': 0.5893045508854775, 'recall': 0.5900960112322371, 'f1-score': 0.589700015496206, 'support': 770639}, '2': {'precision': 0.40830794401438375, 'recall': 0.6280359163493197, 'f1-score': 0.4948783190200707, 'support': 449823}, 'accuracy': 0.502379504573721, 'macro avg': {'precision': 0.49687070753827745, 'recall': 0.48263405683884786, 'f1-score': 0.4660099394630592, 'support': 1675769}, 'weighted avg': {'precision': 0.5145539484178523, 'recall': 0.502379504573721, 'f1-score': 0.48919041652296036, 'support': 1675769}}
[[104616 192706 157985]
 [ 64486 454751 251402]
 [ 43101 124217 282505]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0359169
{'0': {'precision': 0.5102543494704992, 'recall': 0.20299234516353515, 'f1-score': 0.29044011786709006, 'support': 531690}, '1': {'precision': 0.4885774651654141, 'recall': 0.5877466451751973, 'f1-score': 0.533593484156552, 'support': 621642}, '2': {'precision': 0.4349098096252385, 'recall': 0.5964010971657827, 'f1-score': 0.5030116251475139, 'support': 522437}, 'accuracy': 0.46836944710159933, 'macro avg': {'precision': 0.47791387475371727, 'recall': 0.4623800291681717, 'f1-score': 0.44234840905705197, 'support': 1675769}, 'weighted avg': {'precision': 0.47872372855775996, 'recall': 0.46836944710159933, 'f1-score': 0.4469113054090343, 'support': 1675769}}
[[107929 223999 199762]
 [ 51189 365368 205085]
 [ 52402 158453 311582]]
Evaluating performance on  train set...
1230/1230 - 21s - 21s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.90191984
{'0': {'precision': 0.38208564959981295, 'recall': 0.576369291944587, 'f1-score': 0.45953633452434983, 'support': 62368}, '1': {'precision': 0.8047065694305096, 'recall': 0.5631976104386103, 'f1-score': 0.6626324031715106, 'support': 190830}, '2': {'precision': 0.39619653165922575, 'recall': 0.5606606899239914, 'f1-score': 0.46429460064692707, 'support': 61572}, 'accuracy': 0.5653111795914477, 'macro avg': {'precision': 0.527662916896516, 'recall': 0.5667425307690629, 'f1-score': 0.5288211127809291, 'support': 314770}, 'weighted avg': {'precision': 0.641060727788503, 'recall': 0.5653111795914477, 'f1-score': 0.58359453175292, 'support': 314770}}
[[ 35947  13338  13083]
 [ 43828 107475  39527]
 [ 14306  12745  34521]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9178827
{'0': {'precision': 0.44815270152828707, 'recall': 0.5338273724608956, 'f1-score': 0.4872526142943566, 'support': 79211}, '1': {'precision': 0.7093390760078084, 'recall': 0.5821212429435997, 'f1-score': 0.639464238327351, 'support': 157304}, '2': {'precision': 0.45773290701239544, 'recall': 0.5341767299214107, 'f1-score': 0.4930091579735698, 'support': 78255}, 'accuracy': 0.5580487339962512, 'macro avg': {'precision': 0.5384082281828303, 'recall': 0.550041781775302, 'f1-score': 0.5399086701984258, 'support': 314770}, 'weighted avg': {'precision': 0.5810604132901624, 'recall': 0.5580487339962512, 'f1-score': 0.5647503924577869, 'support': 314770}}
[[42285 19445 17481]
 [33693 91570 32041]
 [18376 18077 41802]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.93976873
{'0': {'precision': 0.4785557657580187, 'recall': 0.4936137658824312, 'f1-score': 0.4859681486251951, 'support': 90194}, '1': {'precision': 0.6325437513845374, 'recall': 0.5901793030139737, 'f1-score': 0.6106276134649532, 'support': 135469}, '2': {'precision': 0.483952507813975, 'recall': 0.5178156598247051, 'f1-score': 0.500311739288367, 'support': 89107}, 'accuracy': 0.5420243352288973, 'macro avg': {'precision': 0.5316840083188438, 'recall': 0.5338695762403701, 'f1-score': 0.5323025004595051, 'support': 314770}, 'weighted avg': {'precision': 0.5463560196552102, 'recall': 0.5420243352288973, 'f1-score': 0.5436788814637771, 'support': 314770}}
[[44521 24341 21332]
 [27649 79951 27869]
 [20862 22104 46141]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9826207
{'0': {'precision': 0.5027182957949629, 'recall': 0.43268588017341814, 'f1-score': 0.4650804729840697, 'support': 104718}, '1': {'precision': 0.5131040557312728, 'recall': 0.5982262054800915, 'f1-score': 0.5524051724137932, 'support': 107115}, '2': {'precision': 0.5016189664678462, 'recall': 0.486112865150529, 'f1-score': 0.4937442030272532, 'support': 102937}, 'accuracy': 0.5064904533468882, 'macro avg': {'precision': 0.505813772664694, 'recall': 0.5056749836013462, 'f1-score': 0.503743282808372, 'support': 314770}, 'weighted avg': {'precision': 0.5058930234139623, 'recall': 0.5064904533468882, 'f1-score': 0.5041704229757145, 'support': 314770}}
[[45310 31963 27445]
 [20765 64079 22271]
 [24055 28843 50039]]
Evaluating performance on  val set...
444/444 - 7s - 7s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8514078
{'0': {'precision': 0.34904454981686023, 'recall': 0.6307660731694802, 'f1-score': 0.4494041090882504, 'support': 19489}, '1': {'precision': 0.8327134795078176, 'recall': 0.599334132374484, 'f1-score': 0.6970070081697449, 'support': 75090}, '2': {'precision': 0.4012825817128672, 'recall': 0.5143993635640414, 'f1-score': 0.45085415456130157, 'support': 18855}, 'accuracy': 0.5906165699878343, 'macro avg': {'precision': 0.5276802036791817, 'recall': 0.5814998563693352, 'f1-score': 0.532421757273099, 'support': 113434}, 'weighted avg': {'precision': 0.6779022822594543, 'recall': 0.5906165699878343, 'f1-score': 0.6135510341673607, 'support': 113434}}
[[12293  4182  3014]
 [18629 45004 11457]
 [ 4297  4859  9699]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.88077784
{'0': {'precision': 0.41107945021790143, 'recall': 0.590726615816941, 'f1-score': 0.48479557210160446, 'support': 24910}, '1': {'precision': 0.7490192307692307, 'recall': 0.606106347551392, 'f1-score': 0.6700269221837074, 'support': 64261}, '2': {'precision': 0.4549496840627194, 'recall': 0.48073197873305035, 'f1-score': 0.46748562153063067, 'support': 24263}, 'accuracy': 0.5759119840612162, 'macro avg': {'precision': 0.5383494550166171, 'recall': 0.5591883140337944, 'f1-score': 0.5407693719386475, 'support': 113434}, 'weighted avg': {'precision': 0.6119078766313735, 'recall': 0.5759119840612162, 'f1-score': 0.5860276582214846, 'support': 113434}}
[[14715  6196  3999]
 [15337 38949  9975]
 [ 5744  6855 11664]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.91040105
{'0': {'precision': 0.44353514265831595, 'recall': 0.5575032364158007, 'f1-score': 0.494031562955384, 'support': 28581}, '1': {'precision': 0.6804828417330147, 'recall': 0.6055768486936953, 'f1-score': 0.6408484115540258, 'support': 56878}, '2': {'precision': 0.476163914918935, 'recall': 0.4577301161751564, 'f1-score': 0.46676508648185616, 'support': 27975}, 'accuracy': 0.5570023097131371, 'macro avg': {'precision': 0.5333939664367552, 'recall': 0.5402700670948841, 'f1-score': 0.5338816869970887, 'support': 113434}, 'weighted avg': {'precision': 0.5703921796310184, 'recall': 0.5570023097131371, 'f1-score': 0.5609239323970558, 'support': 113434}}
[[15934  7855  4792]
 [13139 34444  9295]
 [ 6852  8318 12805]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9628318
{'0': {'precision': 0.47419246487152217, 'recall': 0.5015543121058709, 'f1-score': 0.4874897486439434, 'support': 33777}, '1': {'precision': 0.5685859867480313, 'recall': 0.6040351740516485, 'f1-score': 0.5857747530915429, 'support': 46739}, '2': {'precision': 0.49552664409196223, 'recall': 0.42232213378698585, 'f1-score': 0.4560051170190084, 'support': 32918}, 'accuracy': 0.5207874182343918, 'macro avg': {'precision': 0.512768365237172, 'recall': 0.5093038733148351, 'f1-score': 0.5097565395848316, 'support': 113434}, 'weighted avg': {'precision': 0.5192771602059422, 'recall': 0.5207874182343918, 'f1-score': 0.5188501143107341, 'support': 113434}}
[[16941 10695  6141]
 [10495 28232  8012]
 [ 8290 10726 13902]]
training model: results/WBA/W10/deepOF_L2/seq2seq
Epoch 1/50
1230/1230 - 42s - loss: 12.0447 - accuracy10: 0.4790 - accuracy20: 0.4857 - accuracy30: 0.4807 - accuracy50: 0.4646 - val_loss: 11.0725 - val_accuracy10: 0.6359 - val_accuracy20: 0.6076 - val_accuracy30: 0.5763 - val_accuracy50: 0.5129 - 42s/epoch - 34ms/step
Epoch 2/50
1230/1230 - 34s - loss: 11.2131 - accuracy10: 0.5545 - accuracy20: 0.5527 - accuracy30: 0.5412 - accuracy50: 0.5111 - val_loss: 10.7123 - val_accuracy10: 0.6326 - val_accuracy20: 0.6115 - val_accuracy30: 0.5852 - val_accuracy50: 0.5270 - 34s/epoch - 28ms/step
Epoch 3/50
1230/1230 - 34s - loss: 11.0196 - accuracy10: 0.5680 - accuracy20: 0.5642 - accuracy30: 0.5507 - accuracy50: 0.5193 - val_loss: 10.8243 - val_accuracy10: 0.6141 - val_accuracy20: 0.5975 - val_accuracy30: 0.5756 - val_accuracy50: 0.5251 - 34s/epoch - 28ms/step
Epoch 4/50
1230/1230 - 34s - loss: 10.9171 - accuracy10: 0.5742 - accuracy20: 0.5695 - accuracy30: 0.5549 - accuracy50: 0.5240 - val_loss: 10.6300 - val_accuracy10: 0.6378 - val_accuracy20: 0.6162 - val_accuracy30: 0.5916 - val_accuracy50: 0.5350 - 34s/epoch - 28ms/step
Epoch 5/50
1230/1230 - 34s - loss: 10.8488 - accuracy10: 0.5787 - accuracy20: 0.5733 - accuracy30: 0.5589 - accuracy50: 0.5272 - val_loss: 10.7125 - val_accuracy10: 0.6295 - val_accuracy20: 0.6083 - val_accuracy30: 0.5847 - val_accuracy50: 0.5302 - 34s/epoch - 28ms/step
Epoch 6/50
1230/1230 - 34s - loss: 10.8006 - accuracy10: 0.5807 - accuracy20: 0.5756 - accuracy30: 0.5614 - accuracy50: 0.5292 - val_loss: 10.8087 - val_accuracy10: 0.6282 - val_accuracy20: 0.6060 - val_accuracy30: 0.5808 - val_accuracy50: 0.5280 - 34s/epoch - 28ms/step
Epoch 7/50
1230/1230 - 34s - loss: 10.7516 - accuracy10: 0.5826 - accuracy20: 0.5780 - accuracy30: 0.5634 - accuracy50: 0.5309 - val_loss: 10.5850 - val_accuracy10: 0.6467 - val_accuracy20: 0.6238 - val_accuracy30: 0.5976 - val_accuracy50: 0.5381 - 34s/epoch - 28ms/step
Epoch 8/50
1230/1230 - 36s - loss: 10.7153 - accuracy10: 0.5848 - accuracy20: 0.5799 - accuracy30: 0.5657 - accuracy50: 0.5332 - val_loss: 10.6581 - val_accuracy10: 0.6436 - val_accuracy20: 0.6178 - val_accuracy30: 0.5912 - val_accuracy50: 0.5340 - 36s/epoch - 29ms/step
Epoch 9/50
1230/1230 - 34s - loss: 10.6804 - accuracy10: 0.5859 - accuracy20: 0.5812 - accuracy30: 0.5672 - accuracy50: 0.5349 - val_loss: 10.6029 - val_accuracy10: 0.6459 - val_accuracy20: 0.6214 - val_accuracy30: 0.5960 - val_accuracy50: 0.5384 - 34s/epoch - 27ms/step
Epoch 10/50
1230/1230 - 34s - loss: 10.6455 - accuracy10: 0.5876 - accuracy20: 0.5835 - accuracy30: 0.5694 - accuracy50: 0.5367 - val_loss: 10.6036 - val_accuracy10: 0.6395 - val_accuracy20: 0.6151 - val_accuracy30: 0.5928 - val_accuracy50: 0.5377 - 34s/epoch - 27ms/step
Epoch 11/50
1230/1230 - 36s - loss: 10.6089 - accuracy10: 0.5881 - accuracy20: 0.5844 - accuracy30: 0.5706 - accuracy50: 0.5385 - val_loss: 10.6260 - val_accuracy10: 0.6401 - val_accuracy20: 0.6172 - val_accuracy30: 0.5924 - val_accuracy50: 0.5379 - 36s/epoch - 29ms/step
Epoch 12/50
1230/1230 - 36s - loss: 10.5826 - accuracy10: 0.5894 - accuracy20: 0.5860 - accuracy30: 0.5728 - accuracy50: 0.5400 - val_loss: 10.6277 - val_accuracy10: 0.6392 - val_accuracy20: 0.6155 - val_accuracy30: 0.5906 - val_accuracy50: 0.5369 - 36s/epoch - 29ms/step
Epoch 13/50
1230/1230 - 34s - loss: 10.5515 - accuracy10: 0.5905 - accuracy20: 0.5873 - accuracy30: 0.5745 - accuracy50: 0.5420 - val_loss: 10.6882 - val_accuracy10: 0.6322 - val_accuracy20: 0.6091 - val_accuracy30: 0.5863 - val_accuracy50: 0.5345 - 34s/epoch - 28ms/step
Epoch 14/50
1230/1230 - 34s - loss: 10.5328 - accuracy10: 0.5919 - accuracy20: 0.5876 - accuracy30: 0.5742 - accuracy50: 0.5420 - val_loss: 10.6505 - val_accuracy10: 0.6370 - val_accuracy20: 0.6123 - val_accuracy30: 0.5885 - val_accuracy50: 0.5362 - 34s/epoch - 28ms/step
Epoch 15/50
1230/1230 - 34s - loss: 10.5018 - accuracy10: 0.5929 - accuracy20: 0.5894 - accuracy30: 0.5766 - accuracy50: 0.5440 - val_loss: 10.7162 - val_accuracy10: 0.6339 - val_accuracy20: 0.6094 - val_accuracy30: 0.5864 - val_accuracy50: 0.5353 - 34s/epoch - 28ms/step
Epoch 16/50
1230/1230 - 33s - loss: 10.4756 - accuracy10: 0.5937 - accuracy20: 0.5910 - accuracy30: 0.5781 - accuracy50: 0.5461 - val_loss: 10.6773 - val_accuracy10: 0.6347 - val_accuracy20: 0.6101 - val_accuracy30: 0.5874 - val_accuracy50: 0.5371 - 33s/epoch - 27ms/step
Epoch 17/50
1230/1230 - 34s - loss: 10.4466 - accuracy10: 0.5926 - accuracy20: 0.5914 - accuracy30: 0.5786 - accuracy50: 0.5473 - val_loss: 10.7067 - val_accuracy10: 0.6335 - val_accuracy20: 0.6093 - val_accuracy30: 0.5858 - val_accuracy50: 0.5360 - 34s/epoch - 28ms/step
testing model: results/WBA/W10/deepOF_L2/seq2seq
Evaluating performance on  test set...
6546/6546 - 60s - 60s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.91178507
{'0': {'precision': 0.4147090548733508, 'recall': 0.5053630109267503, 'f1-score': 0.45557000243699913, 'support': 308875}, '1': {'precision': 0.7893166459463401, 'recall': 0.5354773170393838, 'f1-score': 0.6380783301779374, 'support': 1061171}, '2': {'precision': 0.33454652136022023, 'recall': 0.6341072491642625, 'f1-score': 0.43800660428408594, 'support': 305718}, 'accuracy': 0.5479202322045348, 'macro avg': {'precision': 0.5128574073933038, 'recall': 0.5583158590434655, 'f1-score': 0.5105516456330075, 'support': 1675764}, 'weighted avg': {'precision': 0.637303395488108, 'recall': 0.5479202322045348, 'f1-score': 0.5679385088022552, 'support': 1675764}}
[[156094  83283  69498]
 [176829 568233 316109]
 [ 43471  68389 193858]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.944861
{'0': {'precision': 0.4745629390852375, 'recall': 0.4657688387441846, 'f1-score': 0.4701247671518227, 'support': 396364}, '1': {'precision': 0.6959644708046108, 'recall': 0.5505975241801314, 'f1-score': 0.6148050655868813, 'support': 886575}, '2': {'precision': 0.39756214230802084, 'recall': 0.5924088334500095, 'f1-score': 0.475810565594091, 'support': 392825}, 'accuracy': 0.5403344385008868, 'macro avg': {'precision': 0.5226965173992897, 'recall': 0.5362583987914419, 'f1-score': 0.520246799444265, 'support': 1675764}, 'weighted avg': {'precision': 0.5736468345443195, 'recall': 0.5403344385008868, 'f1-score': 0.5480017589944367, 'support': 1675764}}
[[184614 113719  98031]
 [143823 488146 254606]
 [ 60582  99530 232713]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.969106
{'0': {'precision': 0.5020664651957777, 'recall': 0.43676656307310485, 'f1-score': 0.4671455686687213, 'support': 455305}, '1': {'precision': 0.6222199363087355, 'recall': 0.5651362051492334, 'f1-score': 0.592305882448942, 'support': 770639}, '2': {'precision': 0.42914902938913785, 'recall': 0.5530967942732649, 'f1-score': 0.48330254342154594, 'support': 449820}, 'accuracy': 0.527026478668834, 'macro avg': {'precision': 0.5178118102978837, 'recall': 0.5183331874985343, 'f1-score': 0.5142513315130698, 'support': 1675764}, 'weighted avg': {'precision': 0.5377488344616623, 'recall': 0.527026478668834, 'f1-score': 0.5290404115192606, 'support': 1675764}}
[[198862 138180 118263]
 [122442 435516 212681]
 [ 74783 126243 248794]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0123764
{'0': {'precision': 0.517163834906072, 'recall': 0.3901487153155898, 'f1-score': 0.44476582131922227, 'support': 531687}, '1': {'precision': 0.5131020350480497, 'recall': 0.5840515923956232, 'f1-score': 0.5462827686756813, 'support': 621642}, '2': {'precision': 0.4608779686064413, 'recall': 0.5002440494989807, 'f1-score': 0.4797548219632232, 'support': 522435}, 'accuracy': 0.49640223802397, 'macro avg': {'precision': 0.4970479461868543, 'recall': 0.4914814524033979, 'f1-score': 0.49026780398604225, 'support': 1675764}, 'weighted avg': {'precision': 0.498109426321338, 'recall': 0.49640223802397, 'f1-score': 0.49333272975024983, 'support': 1675764}}
[[207437 178828 145422]
 [ 98279 363071 160292]
 [ 95389 165701 261345]]
Evaluating performance on  train set...
1230/1230 - 12s - 12s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.85194194
{'0': {'precision': 0.4314169608953434, 'recall': 0.518735681901924, 'f1-score': 0.47106404026884696, 'support': 62421}, '1': {'precision': 0.778791865200506, 'recall': 0.6486822306922024, 'f1-score': 0.7078075123279521, 'support': 190739}, '2': {'precision': 0.415004948045522, 'recall': 0.544555901830931, 'f1-score': 0.4710350443670673, 'support': 61608}, 'accuracy': 0.6025326589742286, 'macro avg': {'precision': 0.5417379247137905, 'recall': 0.5706579381416859, 'f1-score': 0.5499688656546221, 'support': 314768}, 'weighted avg': {'precision': 0.638702423790589, 'recall': 0.6025326589742286, 'f1-score': 0.6145170810403512, 'support': 314768}}
[[ 32380  17401  12640]
 [ 32359 123729  34651]
 [ 10316  17743  33549]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8958985
{'0': {'precision': 0.49909077635753063, 'recall': 0.47436479701259054, 'f1-score': 0.4864137641085347, 'support': 79266}, '1': {'precision': 0.6756310315690498, 'recall': 0.6757297716326297, 'f1-score': 0.675680397993513, 'support': 157378}, '2': {'precision': 0.4783854293655825, 'recall': 0.5022912293277354, 'f1-score': 0.49004695539237725, 'support': 78124}, 'accuracy': 0.5819746607024856, 'macro avg': {'precision': 0.5510357457640543, 'recall': 0.5507952659909852, 'f1-score': 0.5507137058314749, 'support': 314768}, 'weighted avg': {'precision': 0.5822185649392146, 'recall': 0.5819746607024856, 'f1-score': 0.5819452150292415, 'support': 314768}}
[[ 37601  25528  16137]
 [ 24383 106345  26650]
 [ 13355  25528  39241]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.93393475
{'0': {'precision': 0.5301734135592758, 'recall': 0.43038787851937177, 'f1-score': 0.4750976592349874, 'support': 90286}, '1': {'precision': 0.593217580711791, 'recall': 0.6996655814674551, 'f1-score': 0.642059446185113, 'support': 135459}, '2': {'precision': 0.5061376347770747, 'recall': 0.46455410399559666, 'f1-score': 0.48445516950542367, 'support': 89023}, 'accuracy': 0.5559332587810705, 'macro avg': {'precision': 0.5431762096827139, 'recall': 0.5315358546608079, 'f1-score': 0.5338707583085079, 'support': 314768}, 'weighted avg': {'precision': 0.5505063657773687, 'recall': 0.5559332587810705, 'f1-score': 0.5495954173783886, 'support': 314768}}
[[38858 32906 18522]
 [18852 94776 21831]
 [15583 32084 41356]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0042382
{'0': {'precision': 0.5476379967028594, 'recall': 0.36769434822851366, 'f1-score': 0.4399787626382284, 'support': 104799}, '1': {'precision': 0.4729776752193103, 'recall': 0.7244048843428016, 'f1-score': 0.5722938510800958, 'support': 106954}, '2': {'precision': 0.5249829393882995, 'recall': 0.4107265932145804, 'f1-score': 0.46087903708948313, 'support': 103015}, 'accuracy': 0.5029831494942306, 'macro avg': {'precision': 0.5151995371034898, 'recall': 0.500941941928632, 'f1-score': 0.4910505502692691, 'support': 314768}, 'weighted avg': {'precision': 0.5148550239953069, 'recall': 0.5029831494942306, 'f1-score': 0.49177776934096656, 'support': 314768}}
[[38534 44278 21987]
 [13179 77478 16297]
 [18651 42053 42311]]
Evaluating performance on  val set...
444/444 - 4s - 4s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7803456
{'0': {'precision': 0.4271363228316163, 'recall': 0.5115707556829818, 'f1-score': 0.4655562026790915, 'support': 19532}, '1': {'precision': 0.8129405802220755, 'recall': 0.7052279570465506, 'f1-score': 0.7552632142169207, 'support': 75058}, '2': {'precision': 0.41847869694295114, 'recall': 0.553603651417047, 'f1-score': 0.4766496070188266, 'support': 18842}, 'accuracy': 0.6466958177586571, 'macro avg': {'precision': 0.5528518666655476, 'recall': 0.5901341213821932, 'f1-score': 0.5658230079716129, 'support': 113432}, 'weighted avg': {'precision': 0.6809850512699659, 'recall': 0.6466958177586571, 'f1-score': 0.6590981555369769, 'support': 113432}}
[[ 9992  6169  3371]
 [11001 52933 11124]
 [ 2400  6011 10431]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8303204
{'0': {'precision': 0.49475569199283703, 'recall': 0.46594924510118857, 'f1-score': 0.4799205922494727, 'support': 24904}, '1': {'precision': 0.7232577173124141, 'recall': 0.7290444095076506, 'f1-score': 0.726139534883721, 'support': 64243}, '2': {'precision': 0.48356528289917133, 'recall': 0.5022030059707638, 'f1-score': 0.4927079545913627, 'support': 24285}, 'accuracy': 0.6227166937019536, 'macro avg': {'precision': 0.567192897401474, 'recall': 0.565732220193201, 'f1-score': 0.5662560272415188, 'support': 113432}, 'weighted avg': {'precision': 0.6217736104617516, 'recall': 0.6227166937019536, 'f1-score': 0.62210608334656, 'support': 113432}}
[[11604  9068  4232]
 [ 8614 46836  8793]
 [ 3236  8853 12196]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.87349004
{'0': {'precision': 0.5343056605451554, 'recall': 0.41958237307074514, 'f1-score': 0.4700451816065874, 'support': 28638}, '1': {'precision': 0.6493101307041059, 'recall': 0.7542708351659951, 'f1-score': 0.6978659678023212, 'support': 56839}, '2': {'precision': 0.51577299727083, 'recall': 0.45970309425862993, 'f1-score': 0.48612661005087854, 'support': 27955}, 'accuracy': 0.5971771634106777, 'macro avg': {'precision': 0.5664629295066971, 'recall': 0.5445187674984567, 'f1-score': 0.5513459198199291, 'support': 113432}, 'weighted avg': {'precision': 0.5873652775626709, 'recall': 0.5971771634106777, 'f1-score': 0.5881658353792396, 'support': 113432}}
[[12016 11834  4788]
 [ 6690 42872  7277]
 [ 3783 11321 12851]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.956148
{'0': {'precision': 0.5577375906564943, 'recall': 0.3500738989062962, 'f1-score': 0.43015400261513875, 'support': 33830}, '1': {'precision': 0.534486320573739, 'recall': 0.7758546825464827, 'f1-score': 0.6329401485364788, 'support': 46684}, '2': {'precision': 0.5346676489849378, 'recall': 0.396834558600158, 'f1-score': 0.45555361813426326, 'support': 32918}, 'accuracy': 0.5388779180478172, 'macro avg': {'precision': 0.5422971867383903, 'recall': 0.507587713350979, 'f1-score': 0.5062159230952936, 'support': 113432}, 'weighted avg': {'precision': 0.5414734091866477, 'recall': 0.5388779180478172, 'f1-score': 0.5209835126286304, 'support': 113432}}
[[11843 16283  5704]
 [ 4799 36220  5665]
 [ 4592 15263 13063]]
training model: results/WBA/W10/deepVOL_L2/seq2seq
Epoch 1/50
1230/1230 - 41s - loss: 12.1205 - accuracy10: 0.4726 - accuracy20: 0.4808 - accuracy30: 0.4766 - accuracy50: 0.4643 - val_loss: 11.3235 - val_accuracy10: 0.5688 - val_accuracy20: 0.5570 - val_accuracy30: 0.5352 - val_accuracy50: 0.4883 - 41s/epoch - 33ms/step
Epoch 2/50
1230/1230 - 34s - loss: 11.5209 - accuracy10: 0.5186 - accuracy20: 0.5261 - accuracy30: 0.5196 - accuracy50: 0.4956 - val_loss: 10.9746 - val_accuracy10: 0.5847 - val_accuracy20: 0.5808 - val_accuracy30: 0.5640 - val_accuracy50: 0.5157 - 34s/epoch - 28ms/step
Epoch 3/50
1230/1230 - 33s - loss: 11.2607 - accuracy10: 0.5427 - accuracy20: 0.5473 - accuracy30: 0.5372 - accuracy50: 0.5091 - val_loss: 10.8935 - val_accuracy10: 0.6062 - val_accuracy20: 0.5955 - val_accuracy30: 0.5724 - val_accuracy50: 0.5202 - 33s/epoch - 27ms/step
Epoch 4/50
1230/1230 - 33s - loss: 11.1367 - accuracy10: 0.5542 - accuracy20: 0.5567 - accuracy30: 0.5442 - accuracy50: 0.5140 - val_loss: 10.7643 - val_accuracy10: 0.6062 - val_accuracy20: 0.5970 - val_accuracy30: 0.5759 - val_accuracy50: 0.5242 - 33s/epoch - 26ms/step
Epoch 5/50
1230/1230 - 33s - loss: 11.0535 - accuracy10: 0.5619 - accuracy20: 0.5621 - accuracy30: 0.5491 - accuracy50: 0.5176 - val_loss: 10.7001 - val_accuracy10: 0.6211 - val_accuracy20: 0.6072 - val_accuracy30: 0.5810 - val_accuracy50: 0.5247 - 33s/epoch - 27ms/step
Epoch 6/50
1230/1230 - 32s - loss: 10.9969 - accuracy10: 0.5654 - accuracy20: 0.5649 - accuracy30: 0.5511 - accuracy50: 0.5188 - val_loss: 10.6543 - val_accuracy10: 0.6128 - val_accuracy20: 0.6032 - val_accuracy30: 0.5798 - val_accuracy50: 0.5255 - 32s/epoch - 26ms/step
Epoch 7/50
1230/1230 - 33s - loss: 10.9568 - accuracy10: 0.5679 - accuracy20: 0.5680 - accuracy30: 0.5540 - accuracy50: 0.5204 - val_loss: 10.6510 - val_accuracy10: 0.6217 - val_accuracy20: 0.6097 - val_accuracy30: 0.5838 - val_accuracy50: 0.5274 - 33s/epoch - 27ms/step
Epoch 8/50
1230/1230 - 33s - loss: 10.9086 - accuracy10: 0.5707 - accuracy20: 0.5698 - accuracy30: 0.5557 - accuracy50: 0.5229 - val_loss: 10.5451 - val_accuracy10: 0.6255 - val_accuracy20: 0.6128 - val_accuracy30: 0.5884 - val_accuracy50: 0.5313 - 33s/epoch - 26ms/step
Epoch 9/50
1230/1230 - 33s - loss: 10.8672 - accuracy10: 0.5744 - accuracy20: 0.5730 - accuracy30: 0.5580 - accuracy50: 0.5247 - val_loss: 10.5491 - val_accuracy10: 0.6383 - val_accuracy20: 0.6191 - val_accuracy30: 0.5910 - val_accuracy50: 0.5286 - 33s/epoch - 27ms/step
Epoch 10/50
1230/1230 - 32s - loss: 10.8341 - accuracy10: 0.5758 - accuracy20: 0.5747 - accuracy30: 0.5601 - accuracy50: 0.5263 - val_loss: 10.5529 - val_accuracy10: 0.6384 - val_accuracy20: 0.6190 - val_accuracy30: 0.5909 - val_accuracy50: 0.5305 - 32s/epoch - 26ms/step
Epoch 11/50
1230/1230 - 32s - loss: 10.8134 - accuracy10: 0.5768 - accuracy20: 0.5752 - accuracy30: 0.5611 - accuracy50: 0.5274 - val_loss: 10.5190 - val_accuracy10: 0.6388 - val_accuracy20: 0.6203 - val_accuracy30: 0.5924 - val_accuracy50: 0.5320 - 32s/epoch - 26ms/step
Epoch 12/50
1230/1230 - 34s - loss: 10.7837 - accuracy10: 0.5779 - accuracy20: 0.5766 - accuracy30: 0.5627 - accuracy50: 0.5290 - val_loss: 10.5252 - val_accuracy10: 0.6371 - val_accuracy20: 0.6192 - val_accuracy30: 0.5934 - val_accuracy50: 0.5339 - 34s/epoch - 27ms/step
Epoch 13/50
1230/1230 - 34s - loss: 10.7543 - accuracy10: 0.5792 - accuracy20: 0.5785 - accuracy30: 0.5638 - accuracy50: 0.5302 - val_loss: 10.4964 - val_accuracy10: 0.6421 - val_accuracy20: 0.6216 - val_accuracy30: 0.5930 - val_accuracy50: 0.5321 - 34s/epoch - 28ms/step
Epoch 14/50
1230/1230 - 33s - loss: 10.7309 - accuracy10: 0.5801 - accuracy20: 0.5792 - accuracy30: 0.5658 - accuracy50: 0.5320 - val_loss: 10.4988 - val_accuracy10: 0.6465 - val_accuracy20: 0.6240 - val_accuracy30: 0.5947 - val_accuracy50: 0.5337 - 33s/epoch - 27ms/step
Epoch 15/50
1230/1230 - 33s - loss: 10.7166 - accuracy10: 0.5815 - accuracy20: 0.5794 - accuracy30: 0.5653 - accuracy50: 0.5322 - val_loss: 10.5262 - val_accuracy10: 0.6424 - val_accuracy20: 0.6219 - val_accuracy30: 0.5941 - val_accuracy50: 0.5333 - 33s/epoch - 27ms/step
Epoch 16/50
1230/1230 - 34s - loss: 10.6955 - accuracy10: 0.5818 - accuracy20: 0.5806 - accuracy30: 0.5661 - accuracy50: 0.5330 - val_loss: 10.4535 - val_accuracy10: 0.6412 - val_accuracy20: 0.6208 - val_accuracy30: 0.5937 - val_accuracy50: 0.5345 - 34s/epoch - 27ms/step
Epoch 17/50
1230/1230 - 33s - loss: 10.6718 - accuracy10: 0.5832 - accuracy20: 0.5818 - accuracy30: 0.5680 - accuracy50: 0.5350 - val_loss: 10.4690 - val_accuracy10: 0.6460 - val_accuracy20: 0.6220 - val_accuracy30: 0.5929 - val_accuracy50: 0.5325 - 33s/epoch - 27ms/step
Epoch 18/50
1230/1230 - 32s - loss: 10.6500 - accuracy10: 0.5847 - accuracy20: 0.5830 - accuracy30: 0.5689 - accuracy50: 0.5360 - val_loss: 10.4718 - val_accuracy10: 0.6361 - val_accuracy20: 0.6175 - val_accuracy30: 0.5914 - val_accuracy50: 0.5342 - 32s/epoch - 26ms/step
Epoch 19/50
1230/1230 - 32s - loss: 10.6338 - accuracy10: 0.5847 - accuracy20: 0.5835 - accuracy30: 0.5695 - accuracy50: 0.5368 - val_loss: 10.4869 - val_accuracy10: 0.6433 - val_accuracy20: 0.6215 - val_accuracy30: 0.5939 - val_accuracy50: 0.5348 - 32s/epoch - 26ms/step
Epoch 20/50
1230/1230 - 33s - loss: 10.6149 - accuracy10: 0.5853 - accuracy20: 0.5840 - accuracy30: 0.5702 - accuracy50: 0.5371 - val_loss: 10.4531 - val_accuracy10: 0.6414 - val_accuracy20: 0.6203 - val_accuracy30: 0.5927 - val_accuracy50: 0.5350 - 33s/epoch - 26ms/step
Epoch 21/50
1230/1230 - 33s - loss: 10.6001 - accuracy10: 0.5853 - accuracy20: 0.5844 - accuracy30: 0.5710 - accuracy50: 0.5379 - val_loss: 10.4818 - val_accuracy10: 0.6426 - val_accuracy20: 0.6199 - val_accuracy30: 0.5908 - val_accuracy50: 0.5327 - 33s/epoch - 27ms/step
Epoch 22/50
1230/1230 - 32s - loss: 10.5760 - accuracy10: 0.5869 - accuracy20: 0.5860 - accuracy30: 0.5724 - accuracy50: 0.5394 - val_loss: 10.4806 - val_accuracy10: 0.6422 - val_accuracy20: 0.6202 - val_accuracy30: 0.5906 - val_accuracy50: 0.5337 - 32s/epoch - 26ms/step
Epoch 23/50
1230/1230 - 32s - loss: 10.5565 - accuracy10: 0.5870 - accuracy20: 0.5864 - accuracy30: 0.5731 - accuracy50: 0.5394 - val_loss: 10.4659 - val_accuracy10: 0.6369 - val_accuracy20: 0.6161 - val_accuracy30: 0.5897 - val_accuracy50: 0.5356 - 32s/epoch - 26ms/step
Epoch 24/50
1230/1230 - 32s - loss: 10.5350 - accuracy10: 0.5890 - accuracy20: 0.5885 - accuracy30: 0.5744 - accuracy50: 0.5416 - val_loss: 10.4811 - val_accuracy10: 0.6385 - val_accuracy20: 0.6173 - val_accuracy30: 0.5907 - val_accuracy50: 0.5335 - 32s/epoch - 26ms/step
Epoch 25/50
1230/1230 - 32s - loss: 10.5266 - accuracy10: 0.5889 - accuracy20: 0.5881 - accuracy30: 0.5753 - accuracy50: 0.5420 - val_loss: 10.5028 - val_accuracy10: 0.6386 - val_accuracy20: 0.6160 - val_accuracy30: 0.5895 - val_accuracy50: 0.5339 - 32s/epoch - 26ms/step
Epoch 26/50
1230/1230 - 32s - loss: 10.4995 - accuracy10: 0.5902 - accuracy20: 0.5900 - accuracy30: 0.5764 - accuracy50: 0.5445 - val_loss: 10.4766 - val_accuracy10: 0.6408 - val_accuracy20: 0.6179 - val_accuracy30: 0.5908 - val_accuracy50: 0.5357 - 32s/epoch - 26ms/step
Epoch 27/50
1230/1230 - 33s - loss: 10.4815 - accuracy10: 0.5908 - accuracy20: 0.5905 - accuracy30: 0.5773 - accuracy50: 0.5444 - val_loss: 10.4998 - val_accuracy10: 0.6352 - val_accuracy20: 0.6140 - val_accuracy30: 0.5888 - val_accuracy50: 0.5347 - 33s/epoch - 27ms/step
Epoch 28/50
1230/1230 - 32s - loss: 10.4605 - accuracy10: 0.5913 - accuracy20: 0.5913 - accuracy30: 0.5786 - accuracy50: 0.5463 - val_loss: 10.5441 - val_accuracy10: 0.6346 - val_accuracy20: 0.6129 - val_accuracy30: 0.5872 - val_accuracy50: 0.5342 - 32s/epoch - 26ms/step
Epoch 29/50
1230/1230 - 32s - loss: 10.4493 - accuracy10: 0.5909 - accuracy20: 0.5905 - accuracy30: 0.5785 - accuracy50: 0.5464 - val_loss: 10.5319 - val_accuracy10: 0.6308 - val_accuracy20: 0.6100 - val_accuracy30: 0.5846 - val_accuracy50: 0.5331 - 32s/epoch - 26ms/step
Epoch 30/50
1230/1230 - 32s - loss: 10.4285 - accuracy10: 0.5925 - accuracy20: 0.5920 - accuracy30: 0.5796 - accuracy50: 0.5488 - val_loss: 10.4813 - val_accuracy10: 0.6368 - val_accuracy20: 0.6155 - val_accuracy30: 0.5890 - val_accuracy50: 0.5363 - 32s/epoch - 26ms/step
testing model: results/WBA/W10/deepVOL_L2/seq2seq
Evaluating performance on  test set...
6546/6546 - 57s - 57s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.89987904
{'0': {'precision': 0.3973741869813502, 'recall': 0.5219909543280983, 'f1-score': 0.45123688460128347, 'support': 308877}, '1': {'precision': 0.7853179699099913, 'recall': 0.6344880942957409, 'f1-score': 0.7018914973054933, 'support': 1061172}, '2': {'precision': 0.39356187919072766, 'recall': 0.5312377338741332, 'f1-score': 0.4521518345961161, 'support': 305720}, 'accuracy': 0.5949161250745181, 'macro avg': {'precision': 0.5254180120273564, 'recall': 0.5625722608326574, 'f1-score': 0.5350934055009643, 'support': 1675769}, 'weighted avg': {'precision': 0.6423420681631853, 'recall': 0.5949161250745181, 'f1-score': 0.6101295334001167, 'support': 1675769}}
[[161231  97296  50350]
 [187964 673301 199907]
 [ 56546  86764 162410]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9303937
{'0': {'precision': 0.46167572808384777, 'recall': 0.4745336381021581, 'f1-score': 0.4680163877522329, 'support': 396366}, '1': {'precision': 0.6839896180426467, 'recall': 0.6661263852465951, 'f1-score': 0.6749398284338937, 'support': 886575}, '2': {'precision': 0.4591930222278197, 'recall': 0.4733547506796868, 'f1-score': 0.4661663560094313, 'support': 392828}, 'accuracy': 0.5756205061676162, 'macro avg': {'precision': 0.5349527894514381, 'recall': 0.5380049246761467, 'f1-score': 0.5363741907318527, 'support': 1675769}, 'weighted avg': {'precision': 0.5787101526460698, 'recall': 0.5756205061676162, 'f1-score': 0.577056717984432, 'support': 1675769}}
[[188089 143288  64989]
 [141997 590571 154007]
 [ 77319 129562 185947]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.95643276
{'0': {'precision': 0.4931628222183178, 'recall': 0.4315352059160083, 'f1-score': 0.46029539062710473, 'support': 455307}, '1': {'precision': 0.6037840637287304, 'recall': 0.6898444018535268, 'f1-score': 0.6439515940987971, 'support': 770639}, '2': {'precision': 0.4869720341566783, 'recall': 0.4296534414647539, 'f1-score': 0.4565206094248258, 'support': 449823}, 'accuracy': 0.5498192173264931, 'macro avg': {'precision': 0.5279729733679088, 'recall': 0.5170110164114297, 'f1-score': 0.5202558647169092, 'support': 1675769}, 'weighted avg': {'precision': 0.5423726381763001, 'recall': 0.5498192173264931, 'f1-score': 0.5437404535101565, 'support': 1675769}}
[[196481 182822  76004]
 [111413 531621 127605]
 [ 90516 166039 193268]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0043502
{'0': {'precision': 0.5155412900332775, 'recall': 0.36975681318061276, 'f1-score': 0.4306456859530201, 'support': 531690}, '1': {'precision': 0.4905090571409235, 'recall': 0.7112003371715553, 'f1-score': 0.5805899637223199, 'support': 621642}, '2': {'precision': 0.5066739252652653, 'recall': 0.38123639788146707, 'f1-score': 0.43509470975408887, 'support': 522437}, 'accuracy': 0.4999973146656848, 'macro avg': {'precision': 0.5042414241464889, 'recall': 0.48739784941121167, 'f1-score': 0.4821101198098096, 'support': 1675769}, 'weighted avg': {'precision': 0.503490866158045, 'recall': 0.4999973146656848, 'f1-score': 0.4876559274413291, 'support': 1675769}}
[[196596 240765  94329]
 [ 79934 442112  99596]
 [104809 218456 199172]]
Evaluating performance on  train set...
1230/1230 - 12s - 12s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.90102255
{'0': {'precision': 0.4061587470135386, 'recall': 0.5642316572601334, 'f1-score': 0.47232046386459875, 'support': 62368}, '1': {'precision': 0.7906701569296263, 'recall': 0.6267934811088404, 'f1-score': 0.6992587136225987, 'support': 190830}, '2': {'precision': 0.41770438901250473, 'recall': 0.5213571103748457, 'f1-score': 0.4638102049514893, 'support': 61572}, 'accuracy': 0.593773231248213, 'macro avg': {'precision': 0.5381777643185565, 'recall': 0.5707940829146065, 'f1-score': 0.545129794146229, 'support': 314770}, 'weighted avg': {'precision': 0.641528066273466, 'recall': 0.593773231248213, 'f1-score': 0.6082375860157604, 'support': 314770}}
[[ 35190  16149  11029]
 [ 37498 119611  33721]
 [ 13953  15518  32101]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.91923857
{'0': {'precision': 0.47129361294297517, 'recall': 0.5214806024415801, 'f1-score': 0.49511857458782066, 'support': 79211}, '1': {'precision': 0.6854445597761106, 'recall': 0.6632825611554697, 'f1-score': 0.6741814798301898, 'support': 157304}, '2': {'precision': 0.4871171868742157, 'recall': 0.46627052584499395, 'f1-score': 0.4764659410685488, 'support': 78255}, 'accuracy': 0.5786193093369763, 'macro avg': {'precision': 0.5479517865311004, 'recall': 0.5503445631473479, 'f1-score': 0.5485886651621864, 'support': 314770}, 'weighted avg': {'precision': 0.5822478789741369, 'recall': 0.5786193093369763, 'f1-score': 0.5799667158026601, 'support': 314770}}
[[ 41307  24568  13336]
 [ 27885 104337  25082]
 [ 18454  23313  36488]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.943764
{'0': {'precision': 0.5005214005978726, 'recall': 0.47894538439364037, 'f1-score': 0.48949575070821527, 'support': 90194}, '1': {'precision': 0.600706485589373, 'recall': 0.6866515586591766, 'f1-score': 0.6408101405345826, 'support': 135469}, '2': {'precision': 0.517395025335199, 'recall': 0.42742994377546095, 'f1-score': 0.4681293018682399, 'support': 89107}, 'accuracy': 0.5537535343266512, 'macro avg': {'precision': 0.5395409705074815, 'recall': 0.5310089622760926, 'f1-score': 0.5328117310370126, 'support': 314770}, 'weighted avg': {'precision': 0.5484152003824216, 'recall': 0.5537535343266512, 'f1-score': 0.5485690706516803, 'support': 314770}}
[[43198 31907 15089]
 [22012 93020 20437]
 [21096 29924 38087]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9930015
{'0': {'precision': 0.5209205271804958, 'recall': 0.4148092973509807, 'f1-score': 0.46184843571409584, 'support': 104718}, '1': {'precision': 0.47851483394086675, 'recall': 0.7059048685991691, 'f1-score': 0.5703821884276076, 'support': 107115}, '2': {'precision': 0.5356495427099377, 'recall': 0.3817772035322576, 'f1-score': 0.4458095108449043, 'support': 102937}, 'accuracy': 0.5030657305334053, 'macro avg': {'precision': 0.5116949679437667, 'recall': 0.5008304564941358, 'f1-score': 0.4926800449955359, 'support': 314770}, 'weighted avg': {'precision': 0.5113067610661625, 'recall': 0.5030657305334053, 'f1-score': 0.49353695149592963, 'support': 314770}}
[[43438 42858 18422]
 [15856 75613 15646]
 [24093 39545 39299]]
Evaluating performance on  val set...
444/444 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.81427306
{'0': {'precision': 0.4106825150471287, 'recall': 0.5566729950228334, 'f1-score': 0.47266152572648457, 'support': 19489}, '1': {'precision': 0.8248049123704746, 'recall': 0.6869090424823545, 'f1-score': 0.7495676688997719, 'support': 75090}, '2': {'precision': 0.4152608145092112, 'recall': 0.5391673296207903, 'f1-score': 0.46917112793058885, 'support': 18855}, 'accuracy': 0.6399756686707689, 'macro avg': {'precision': 0.5502494139756048, 'recall': 0.5942497890419927, 'f1-score': 0.5638001075189484, 'support': 113434}, 'weighted avg': {'precision': 0.6855804702578028, 'recall': 0.6399756686707689, 'f1-score': 0.6553851433406085, 'support': 113434}}
[[10849  5679  2961]
 [12156 51580 11354]
 [ 3412  5277 10166]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.84691566
{'0': {'precision': 0.47923044940847415, 'recall': 0.5089923725411482, 'f1-score': 0.4936632468316234, 'support': 24910}, '1': {'precision': 0.7328508946322068, 'recall': 0.7170445526835872, 'f1-score': 0.7248615655675812, 'support': 64261}, '2': {'precision': 0.475479213343291, 'recall': 0.4723241149074723, 'f1-score': 0.4738964126951308, 'support': 24263}, 'accuracy': 0.6190119364564416, 'macro avg': {'precision': 0.5625201857946572, 'recall': 0.5661203467107359, 'f1-score': 0.5641404083647784, 'support': 113434}, 'weighted avg': {'precision': 0.6221054885490559, 'recall': 0.6190119364564416, 'f1-score': 0.620410363777492, 'support': 113434}}
[[12679  8566  3665]
 [ 9206 46078  8977]
 [ 4572  8231 11460]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8840014
{'0': {'precision': 0.5119033703487239, 'recall': 0.4596760085371401, 'f1-score': 0.48438594550750286, 'support': 28581}, '1': {'precision': 0.6556299661249785, 'recall': 0.738405007208411, 'f1-score': 0.6945599775089509, 'support': 56878}, '2': {'precision': 0.5041754533951919, 'recall': 0.4273100983020554, 'f1-score': 0.462571345651543, 'support': 27975}, 'accuracy': 0.5914540613925278, 'macro avg': {'precision': 0.5572362632896314, 'recall': 0.5417970380158689, 'f1-score': 0.5471724228893323, 'support': 113434}, 'weighted avg': {'precision': 0.5820648108144286, 'recall': 0.5914540613925278, 'f1-score': 0.5843913685835461, 'support': 113434}}
[[13138 11269  4174]
 [ 7297 41999  7582]
 [ 5230 10791 11954]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9544059
{'0': {'precision': 0.5348022644890644, 'recall': 0.3887556621369571, 'f1-score': 0.45023144179667407, 'support': 33777}, '1': {'precision': 0.5376064586168408, 'recall': 0.7522625644536682, 'f1-score': 0.6270733012306046, 'support': 46739}, '2': {'precision': 0.522572402044293, 'recall': 0.3727443951637402, 'f1-score': 0.4351218128302422, 'support': 32918}, 'accuracy': 0.5338875469435972, 'macro avg': {'precision': 0.531660375050066, 'recall': 0.5045875405847885, 'f1-score': 0.5041421852858403, 'support': 113434}, 'weighted avg': {'precision': 0.5324086489715049, 'recall': 0.5338875469435972, 'f1-score': 0.5187120816556712, 'support': 113434}}
[[13131 15525  5121]
 [ 5490 35160  6089]
 [ 5932 14716 12270]]
training model: results/WBA/W10/deepVOL_L3/seq2seq
Epoch 1/50
1230/1230 - 58s - loss: 12.5766 - accuracy10: 0.4364 - accuracy20: 0.4439 - accuracy30: 0.4437 - accuracy50: 0.4333 - val_loss: 11.5672 - val_accuracy10: 0.4996 - val_accuracy20: 0.5078 - val_accuracy30: 0.5027 - val_accuracy50: 0.4748 - 58s/epoch - 47ms/step
Epoch 2/50
1230/1230 - 48s - loss: 11.8454 - accuracy10: 0.4759 - accuracy20: 0.4934 - accuracy30: 0.4953 - accuracy50: 0.4814 - val_loss: 11.2782 - val_accuracy10: 0.5093 - val_accuracy20: 0.5184 - val_accuracy30: 0.5159 - val_accuracy50: 0.4952 - 48s/epoch - 39ms/step
Epoch 3/50
1230/1230 - 49s - loss: 11.4279 - accuracy10: 0.5211 - accuracy20: 0.5282 - accuracy30: 0.5227 - accuracy50: 0.5006 - val_loss: 11.1450 - val_accuracy10: 0.5578 - val_accuracy20: 0.5602 - val_accuracy30: 0.5477 - val_accuracy50: 0.5118 - 49s/epoch - 40ms/step
Epoch 4/50
1230/1230 - 49s - loss: 11.2018 - accuracy10: 0.5444 - accuracy20: 0.5465 - accuracy30: 0.5374 - accuracy50: 0.5109 - val_loss: 10.8747 - val_accuracy10: 0.5892 - val_accuracy20: 0.5813 - val_accuracy30: 0.5628 - val_accuracy50: 0.5148 - 49s/epoch - 40ms/step
Epoch 5/50
1230/1230 - 48s - loss: 11.1009 - accuracy10: 0.5523 - accuracy20: 0.5537 - accuracy30: 0.5434 - accuracy50: 0.5151 - val_loss: 10.7950 - val_accuracy10: 0.5976 - val_accuracy20: 0.5914 - val_accuracy30: 0.5704 - val_accuracy50: 0.5198 - 48s/epoch - 39ms/step
Epoch 6/50
1230/1230 - 48s - loss: 11.0116 - accuracy10: 0.5587 - accuracy20: 0.5600 - accuracy30: 0.5486 - accuracy50: 0.5189 - val_loss: 10.6914 - val_accuracy10: 0.6083 - val_accuracy20: 0.5982 - val_accuracy30: 0.5762 - val_accuracy50: 0.5239 - 48s/epoch - 39ms/step
Epoch 7/50
1230/1230 - 48s - loss: 10.9510 - accuracy10: 0.5634 - accuracy20: 0.5638 - accuracy30: 0.5521 - accuracy50: 0.5215 - val_loss: 10.6568 - val_accuracy10: 0.6089 - val_accuracy20: 0.5996 - val_accuracy30: 0.5779 - val_accuracy50: 0.5251 - 48s/epoch - 39ms/step
Epoch 8/50
1230/1230 - 48s - loss: 10.9046 - accuracy10: 0.5656 - accuracy20: 0.5657 - accuracy30: 0.5543 - accuracy50: 0.5232 - val_loss: 10.6841 - val_accuracy10: 0.6016 - val_accuracy20: 0.5928 - val_accuracy30: 0.5719 - val_accuracy50: 0.5219 - 48s/epoch - 39ms/step
Epoch 9/50
1230/1230 - 50s - loss: 10.8379 - accuracy10: 0.5708 - accuracy20: 0.5705 - accuracy30: 0.5586 - accuracy50: 0.5259 - val_loss: 10.5754 - val_accuracy10: 0.5977 - val_accuracy20: 0.5918 - val_accuracy30: 0.5731 - val_accuracy50: 0.5278 - 50s/epoch - 41ms/step
Epoch 10/50
1230/1230 - 48s - loss: 10.8037 - accuracy10: 0.5723 - accuracy20: 0.5728 - accuracy30: 0.5595 - accuracy50: 0.5268 - val_loss: 10.4864 - val_accuracy10: 0.6023 - val_accuracy20: 0.5953 - val_accuracy30: 0.5762 - val_accuracy50: 0.5307 - 48s/epoch - 39ms/step
Epoch 11/50
1230/1230 - 48s - loss: 10.7688 - accuracy10: 0.5745 - accuracy20: 0.5747 - accuracy30: 0.5619 - accuracy50: 0.5291 - val_loss: 10.4488 - val_accuracy10: 0.5932 - val_accuracy20: 0.5894 - val_accuracy30: 0.5739 - val_accuracy50: 0.5332 - 48s/epoch - 39ms/step
Epoch 12/50
1230/1230 - 48s - loss: 10.7367 - accuracy10: 0.5764 - accuracy20: 0.5759 - accuracy30: 0.5627 - accuracy50: 0.5304 - val_loss: 10.3796 - val_accuracy10: 0.6028 - val_accuracy20: 0.5964 - val_accuracy30: 0.5788 - val_accuracy50: 0.5362 - 48s/epoch - 39ms/step
Epoch 13/50
1230/1230 - 47s - loss: 10.7068 - accuracy10: 0.5764 - accuracy20: 0.5769 - accuracy30: 0.5639 - accuracy50: 0.5313 - val_loss: 10.3340 - val_accuracy10: 0.5996 - val_accuracy20: 0.5945 - val_accuracy30: 0.5779 - val_accuracy50: 0.5375 - 47s/epoch - 38ms/step
Epoch 14/50
1230/1230 - 48s - loss: 10.6835 - accuracy10: 0.5782 - accuracy20: 0.5786 - accuracy30: 0.5657 - accuracy50: 0.5336 - val_loss: 10.2976 - val_accuracy10: 0.6040 - val_accuracy20: 0.5980 - val_accuracy30: 0.5815 - val_accuracy50: 0.5381 - 48s/epoch - 39ms/step
Epoch 15/50
1230/1230 - 48s - loss: 10.6529 - accuracy10: 0.5789 - accuracy20: 0.5790 - accuracy30: 0.5668 - accuracy50: 0.5347 - val_loss: 10.3081 - val_accuracy10: 0.6129 - val_accuracy20: 0.6031 - val_accuracy30: 0.5847 - val_accuracy50: 0.5393 - 48s/epoch - 39ms/step
Epoch 16/50
1230/1230 - 48s - loss: 10.6295 - accuracy10: 0.5807 - accuracy20: 0.5809 - accuracy30: 0.5676 - accuracy50: 0.5354 - val_loss: 10.2332 - val_accuracy10: 0.6085 - val_accuracy20: 0.6018 - val_accuracy30: 0.5845 - val_accuracy50: 0.5404 - 48s/epoch - 39ms/step
Epoch 17/50
1230/1230 - 49s - loss: 10.6080 - accuracy10: 0.5827 - accuracy20: 0.5823 - accuracy30: 0.5691 - accuracy50: 0.5368 - val_loss: 10.2121 - val_accuracy10: 0.6282 - val_accuracy20: 0.6142 - val_accuracy30: 0.5928 - val_accuracy50: 0.5424 - 49s/epoch - 40ms/step
Epoch 18/50
1230/1230 - 48s - loss: 10.5842 - accuracy10: 0.5833 - accuracy20: 0.5834 - accuracy30: 0.5712 - accuracy50: 0.5383 - val_loss: 10.2607 - val_accuracy10: 0.6218 - val_accuracy20: 0.6099 - val_accuracy30: 0.5889 - val_accuracy50: 0.5405 - 48s/epoch - 39ms/step
Epoch 19/50
1230/1230 - 48s - loss: 10.5745 - accuracy10: 0.5838 - accuracy20: 0.5837 - accuracy30: 0.5710 - accuracy50: 0.5383 - val_loss: 10.2074 - val_accuracy10: 0.6254 - val_accuracy20: 0.6137 - val_accuracy30: 0.5932 - val_accuracy50: 0.5427 - 48s/epoch - 39ms/step
Epoch 20/50
1230/1230 - 48s - loss: 10.5479 - accuracy10: 0.5842 - accuracy20: 0.5844 - accuracy30: 0.5713 - accuracy50: 0.5395 - val_loss: 10.2045 - val_accuracy10: 0.6229 - val_accuracy20: 0.6113 - val_accuracy30: 0.5911 - val_accuracy50: 0.5414 - 48s/epoch - 39ms/step
Epoch 21/50
1230/1230 - 48s - loss: 10.5370 - accuracy10: 0.5849 - accuracy20: 0.5846 - accuracy30: 0.5727 - accuracy50: 0.5405 - val_loss: 10.2354 - val_accuracy10: 0.6268 - val_accuracy20: 0.6131 - val_accuracy30: 0.5906 - val_accuracy50: 0.5407 - 48s/epoch - 39ms/step
Epoch 22/50
1230/1230 - 48s - loss: 10.5270 - accuracy10: 0.5842 - accuracy20: 0.5855 - accuracy30: 0.5731 - accuracy50: 0.5412 - val_loss: 10.2388 - val_accuracy10: 0.6315 - val_accuracy20: 0.6149 - val_accuracy30: 0.5917 - val_accuracy50: 0.5404 - 48s/epoch - 39ms/step
Epoch 23/50
1230/1230 - 48s - loss: 10.5031 - accuracy10: 0.5855 - accuracy20: 0.5862 - accuracy30: 0.5744 - accuracy50: 0.5418 - val_loss: 10.2174 - val_accuracy10: 0.6278 - val_accuracy20: 0.6132 - val_accuracy30: 0.5909 - val_accuracy50: 0.5406 - 48s/epoch - 39ms/step
Epoch 24/50
1230/1230 - 48s - loss: 10.4949 - accuracy10: 0.5869 - accuracy20: 0.5866 - accuracy30: 0.5741 - accuracy50: 0.5426 - val_loss: 10.2948 - val_accuracy10: 0.6270 - val_accuracy20: 0.6125 - val_accuracy30: 0.5887 - val_accuracy50: 0.5370 - 48s/epoch - 39ms/step
Epoch 25/50
1230/1230 - 50s - loss: 10.4833 - accuracy10: 0.5873 - accuracy20: 0.5869 - accuracy30: 0.5747 - accuracy50: 0.5429 - val_loss: 10.2613 - val_accuracy10: 0.6261 - val_accuracy20: 0.6102 - val_accuracy30: 0.5876 - val_accuracy50: 0.5372 - 50s/epoch - 40ms/step
Epoch 26/50
1230/1230 - 48s - loss: 10.4562 - accuracy10: 0.5889 - accuracy20: 0.5891 - accuracy30: 0.5775 - accuracy50: 0.5450 - val_loss: 10.2537 - val_accuracy10: 0.6260 - val_accuracy20: 0.6116 - val_accuracy30: 0.5887 - val_accuracy50: 0.5384 - 48s/epoch - 39ms/step
Epoch 27/50
1230/1230 - 49s - loss: 10.4506 - accuracy10: 0.5888 - accuracy20: 0.5883 - accuracy30: 0.5767 - accuracy50: 0.5458 - val_loss: 10.2650 - val_accuracy10: 0.6286 - val_accuracy20: 0.6118 - val_accuracy30: 0.5892 - val_accuracy50: 0.5392 - 49s/epoch - 40ms/step
Epoch 28/50
1230/1230 - 49s - loss: 10.4237 - accuracy10: 0.5901 - accuracy20: 0.5903 - accuracy30: 0.5788 - accuracy50: 0.5466 - val_loss: 10.2989 - val_accuracy10: 0.6193 - val_accuracy20: 0.6045 - val_accuracy30: 0.5839 - val_accuracy50: 0.5382 - 49s/epoch - 40ms/step
Epoch 29/50
1230/1230 - 48s - loss: 10.4065 - accuracy10: 0.5914 - accuracy20: 0.5915 - accuracy30: 0.5793 - accuracy50: 0.5476 - val_loss: 10.2849 - val_accuracy10: 0.6266 - val_accuracy20: 0.6115 - val_accuracy30: 0.5887 - val_accuracy50: 0.5388 - 48s/epoch - 39ms/step
Epoch 30/50
1230/1230 - 47s - loss: 10.3999 - accuracy10: 0.5904 - accuracy20: 0.5909 - accuracy30: 0.5799 - accuracy50: 0.5488 - val_loss: 10.3275 - val_accuracy10: 0.6239 - val_accuracy20: 0.6075 - val_accuracy30: 0.5852 - val_accuracy50: 0.5367 - 47s/epoch - 39ms/step
testing model: results/WBA/W10/deepVOL_L3/seq2seq
Evaluating performance on  test set...
6546/6546 - 104s - 104s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.88504934
{'0': {'precision': 0.4164764079147641, 'recall': 0.5244352930130765, 'f1-score': 0.46426232515215227, 'support': 308877}, '1': {'precision': 0.8143282295499407, 'recall': 0.5804252279555058, 'f1-score': 0.6777637233643954, 'support': 1061172}, '2': {'precision': 0.3692563784503203, 'recall': 0.640700641109512, 'f1-score': 0.4685007259219927, 'support': 305720}, 'accuracy': 0.5811015718753599, 'macro avg': {'precision': 0.533353671971675, 'recall': 0.581853720692698, 'f1-score': 0.5368422581461801, 'support': 1675769}, 'weighted avg': {'precision': 0.659799387311312, 'recall': 0.5811015718753599, 'f1-score': 0.6002342100760518, 'support': 1675769}}
[[161986  82103  64788]
 [175446 615931 269795]
 [ 51512  58333 195875]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9121109
{'0': {'precision': 0.47773680870942437, 'recall': 0.4824808384170186, 'f1-score': 0.4800971044399926, 'support': 396366}, '1': {'precision': 0.7191209935202301, 'recall': 0.60773764204946, 'f1-score': 0.6587542715318828, 'support': 886575}, '2': {'precision': 0.434423768367122, 'recall': 0.5819315323754926, 'f1-score': 0.497473450557103, 'support': 392828}, 'accuracy': 0.572061543088576, 'macro avg': {'precision': 0.5437605235322588, 'recall': 0.5573833376139904, 'f1-score': 0.5454416088429929, 'support': 1675769}, 'weighted avg': {'precision': 0.595289173407097, 'recall': 0.572061543088576, 'f1-score': 0.5786899852051726, 'support': 1675769}}
[[191239 119650  85477]
 [135634 538805 212136]
 [ 73429  90800 228599]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9355136
{'0': {'precision': 0.5064458530713186, 'recall': 0.44167561667182803, 'f1-score': 0.47184836881030146, 'support': 455307}, '1': {'precision': 0.6416485383867704, 'recall': 0.6296138658957048, 'f1-score': 0.6355742377641431, 'support': 770639}, '2': {'precision': 0.4649794165437018, 'recall': 0.540112444228063, 'f1-score': 0.49973774335873633, 'support': 449823}, 'accuracy': 0.5545263100105086, 'macro avg': {'precision': 0.5376912693339303, 'recall': 0.5371339755985319, 'f1-score': 0.5357201166443937, 'support': 1675769}, 'weighted avg': {'precision': 0.5574910182048497, 'recall': 0.5545263100105086, 'f1-score': 0.5546275717029556, 'support': 1675769}}
[[201098 152032 102177]
 [108059 485205 177375]
 [ 87920 118948 242955]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9759919
{'0': {'precision': 0.5218071164767086, 'recall': 0.3954070981210856, 'f1-score': 0.44989760171883597, 'support': 531690}, '1': {'precision': 0.5279446245491225, 'recall': 0.6512558675250385, 'f1-score': 0.5831528001843742, 'support': 621642}, '2': {'precision': 0.49072692600314205, 'recall': 0.4753204692623225, 'f1-score': 0.4829008470818846, 'support': 522437}, 'accuracy': 0.5152303211242122, 'macro avg': {'precision': 0.5134928890096577, 'recall': 0.5073278116361489, 'f1-score': 0.5053170829950315, 'support': 1675769}, 'weighted avg': {'precision': 0.5143943354327299, 'recall': 0.5152303211242122, 'f1-score': 0.5096189264254328, 'support': 1675769}}
[[210234 199021 122435]
 [ 81519 404848 135275]
 [111143 162969 248325]]
Evaluating performance on  train set...
1230/1230 - 21s - 21s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8963131
{'0': {'precision': 0.42219145711250883, 'recall': 0.5671979220112878, 'f1-score': 0.4840685016797006, 'support': 62368}, '1': {'precision': 0.8251515698162338, 'recall': 0.551307446418278, 'f1-score': 0.6609891024694576, 'support': 190830}, '2': {'precision': 0.3777371910090644, 'recall': 0.6348502566101475, 'f1-score': 0.473651047535958, 'support': 61572}, 'accuracy': 0.5707977253232519, 'macro avg': {'precision': 0.541693405979269, 'recall': 0.5844518750132378, 'f1-score': 0.5395695505617054, 'support': 314770}, 'weighted avg': {'precision': 0.6577912291197857, 'recall': 0.5707977253232519, 'f1-score': 0.589289249407155, 'support': 314770}}
[[ 35375  12900  14093]
 [ 35324 105206  50300]
 [ 13090   9393  39089]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9080043
{'0': {'precision': 0.4857186018406619, 'recall': 0.5276918609789044, 'f1-score': 0.5058360108188568, 'support': 79211}, '1': {'precision': 0.7251787951348694, 'recall': 0.5814283171438743, 'f1-score': 0.6453959763747856, 'support': 157304}, '2': {'precision': 0.4456682782283219, 'recall': 0.5842693757587375, 'f1-score': 0.5056428915049738, 'support': 78255}, 'accuracy': 0.5686120024144613, 'macro avg': {'precision': 0.5521885584012843, 'recall': 0.564463184627172, 'f1-score': 0.5522916262328721, 'support': 314770}, 'weighted avg': {'precision': 0.5954301632082266, 'recall': 0.5686120024144613, 'f1-score': 0.5755320691150791, 'support': 314770}}
[[41799 19518 17894]
 [26867 91461 38976]
 [17390 15143 45722]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.92821467
{'0': {'precision': 0.5125698650639602, 'recall': 0.48601902565580857, 'f1-score': 0.4989414737417196, 'support': 90194}, '1': {'precision': 0.6424893346896612, 'recall': 0.6014364910053223, 'f1-score': 0.6212854866136449, 'support': 135469}, '2': {'precision': 0.4771123151266657, 'recall': 0.5484754284175205, 'f1-score': 0.5103110544945756, 'support': 89107}, 'accuracy': 0.5533723035867458, 'macro avg': {'precision': 0.5440571716267623, 'recall': 0.5453103150262172, 'f1-score': 0.5435126716166466, 'support': 314770}, 'weighted avg': {'precision': 0.5584463613261885, 'recall': 0.5533723035867458, 'f1-score': 0.5548137942039352, 'support': 314770}}
[[43836 25248 21110]
 [21541 81476 32452]
 [20145 20089 48873]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9677871
{'0': {'precision': 0.5251661482306218, 'recall': 0.43691628946312955, 'f1-score': 0.476993729116603, 'support': 104718}, '1': {'precision': 0.516745588947755, 'recall': 0.6173738505344722, 'f1-score': 0.5625954425770666, 'support': 107115}, '2': {'precision': 0.5026335590669676, 'recall': 0.48670546062154524, 'f1-score': 0.4945412907428978, 'support': 102937}, 'accuracy': 0.5146074911840391, 'macro avg': {'precision': 0.5148484320817815, 'recall': 0.5136652002063824, 'f1-score': 0.5113768208121892, 'support': 314770}, 'weighted avg': {'precision': 0.5149319920584219, 'recall': 0.5146074911840391, 'f1-score': 0.511862112026167, 'support': 314770}}
[[45753 33989 24976]
 [16386 66130 24599]
 [24982 27855 50100]]
Evaluating performance on  val set...
444/444 - 7s - 7s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.81002045
{'0': {'precision': 0.4235095833496649, 'recall': 0.5544153112011904, 'f1-score': 0.48020087996089067, 'support': 19489}, '1': {'precision': 0.848813209494324, 'recall': 0.6353043015048608, 'f1-score': 0.7267007890808275, 'support': 75090}, '2': {'precision': 0.38305116806961126, 'recall': 0.6443914081145584, 'f1-score': 0.48048404318424487, 'support': 18855}, 'accuracy': 0.6229172911120122, 'macro avg': {'precision': 0.5517913203045334, 'recall': 0.6113703402735365, 'f1-score': 0.562461904075321, 'support': 113434}, 'weighted avg': {'precision': 0.6983231830384447, 'recall': 0.6229172911120122, 'f1-score': 0.6434236986783157, 'support': 113434}}
[[10805  4941  3743]
 [11559 47705 15826]
 [ 3149  3556 12150]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.83931655
{'0': {'precision': 0.48909657320872274, 'recall': 0.5105178643115215, 'f1-score': 0.49957769440788824, 'support': 24910}, '1': {'precision': 0.7626106908543362, 'recall': 0.6620345154915112, 'f1-score': 0.7087723974776545, 'support': 64261}, '2': {'precision': 0.4461718330331469, 'recall': 0.5819560647900095, 'f1-score': 0.5050974780897872, 'support': 24263}, 'accuracy': 0.6116331963961422, 'macro avg': {'precision': 0.5659596990320686, 'recall': 0.5848361481976807, 'f1-score': 0.5711491899917767, 'support': 113434}, 'weighted avg': {'precision': 0.634862461241806, 'recall': 0.6116331963961422, 'f1-score': 0.619268327951977, 'support': 113434}}
[[12717  7414  4779]
 [ 8970 42543 12748]
 [ 4314  5829 14120]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.87390053
{'0': {'precision': 0.5195598543290129, 'recall': 0.4642244847975928, 'f1-score': 0.49033593259174396, 'support': 28581}, '1': {'precision': 0.687719547244793, 'recall': 0.6815288863884102, 'f1-score': 0.6846102221751262, 'support': 56878}, '2': {'precision': 0.47746662015159685, 'recall': 0.5381590705987489, 'f1-score': 0.5059993950189897, 'support': 27975}, 'accuracy': 0.5914187985965407, 'macro avg': {'precision': 0.561582007241801, 'recall': 0.561304147261584, 'f1-score': 0.5603151832619533, 'support': 113434}, 'weighted avg': {'precision': 0.5934973755973321, 'recall': 0.5914187985965407, 'f1-score': 0.5916117264835737, 'support': 113434}}
[[13268  9701  5612]
 [ 7250 38764 10864]
 [ 5019  7901 15055]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9370689
{'0': {'precision': 0.5373192806488265, 'recall': 0.4060159279983421, 'f1-score': 0.46252951096121414, 'support': 33777}, '1': {'precision': 0.5662952012735957, 'recall': 0.6925693746122082, 'f1-score': 0.6230991337824832, 'support': 46739}, '2': {'precision': 0.5008130081300813, 'recall': 0.4678291512242542, 'f1-score': 0.48375950241879756, 'support': 32918}, 'accuracy': 0.542024437117619, 'macro avg': {'precision': 0.5348091633508346, 'recall': 0.5221381512782682, 'f1-score': 0.5231293823874983, 'support': 113434}, 'weighted avg': {'precision': 0.538664486454044, 'recall': 0.542024437117619, 'f1-score': 0.5348509706632789, 'support': 113434}}
[[13714 13462  6601]
 [ 5620 32370  8749]
 [ 6189 11329 15400]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :       256            32
 Used       :        21 (peak)  17.55 (ave)

============================================
