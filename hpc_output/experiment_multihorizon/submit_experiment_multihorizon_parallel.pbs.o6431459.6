This machine has 1 visible gpus.
This machine has 1 physical gpus.
training model: results/AAL/W0/deepLOB_L1/seq2seq
Epoch 1/50
2262/2262 - 84s - loss: 11.9350 - accuracy10: 0.4661 - accuracy20: 0.4829 - accuracy30: 0.4874 - accuracy50: 0.4809 - val_loss: 13.3485 - val_accuracy10: 0.4039 - val_accuracy20: 0.4130 - val_accuracy30: 0.4137 - val_accuracy50: 0.3971 - 84s/epoch - 37ms/step
Epoch 2/50
2262/2262 - 57s - loss: 11.9477 - accuracy10: 0.4498 - accuracy20: 0.4758 - accuracy30: 0.4866 - accuracy50: 0.4821 - val_loss: 12.7665 - val_accuracy10: 0.5868 - val_accuracy20: 0.5375 - val_accuracy30: 0.4978 - val_accuracy50: 0.4282 - 57s/epoch - 25ms/step
Epoch 3/50
2262/2262 - 60s - loss: 11.7091 - accuracy10: 0.4922 - accuracy20: 0.5101 - accuracy30: 0.5145 - accuracy50: 0.5011 - val_loss: 11.8752 - val_accuracy10: 0.5641 - val_accuracy20: 0.5421 - val_accuracy30: 0.5208 - val_accuracy50: 0.4738 - 60s/epoch - 26ms/step
Epoch 4/50
2262/2262 - 63s - loss: 11.4443 - accuracy10: 0.5186 - accuracy20: 0.5301 - accuracy30: 0.5285 - accuracy50: 0.5102 - val_loss: 11.5250 - val_accuracy10: 0.5684 - val_accuracy20: 0.5521 - val_accuracy30: 0.5334 - val_accuracy50: 0.4894 - 63s/epoch - 28ms/step
Epoch 5/50
2262/2262 - 56s - loss: 11.3050 - accuracy10: 0.5305 - accuracy20: 0.5398 - accuracy30: 0.5349 - accuracy50: 0.5147 - val_loss: 11.3969 - val_accuracy10: 0.5848 - val_accuracy20: 0.5665 - val_accuracy30: 0.5451 - val_accuracy50: 0.4983 - 56s/epoch - 25ms/step
Epoch 6/50
2262/2262 - 58s - loss: 11.1833 - accuracy10: 0.5406 - accuracy20: 0.5465 - accuracy30: 0.5397 - accuracy50: 0.5182 - val_loss: 11.4509 - val_accuracy10: 0.5879 - val_accuracy20: 0.5689 - val_accuracy30: 0.5465 - val_accuracy50: 0.4984 - 58s/epoch - 26ms/step
Epoch 7/50
2262/2262 - 55s - loss: 11.0895 - accuracy10: 0.5479 - accuracy20: 0.5525 - accuracy30: 0.5445 - accuracy50: 0.5215 - val_loss: 11.3706 - val_accuracy10: 0.5842 - val_accuracy20: 0.5685 - val_accuracy30: 0.5479 - val_accuracy50: 0.5023 - 55s/epoch - 24ms/step
Epoch 8/50
2262/2262 - 56s - loss: 11.0101 - accuracy10: 0.5534 - accuracy20: 0.5577 - accuracy30: 0.5487 - accuracy50: 0.5247 - val_loss: 11.3590 - val_accuracy10: 0.5940 - val_accuracy20: 0.5761 - val_accuracy30: 0.5523 - val_accuracy50: 0.5029 - 56s/epoch - 25ms/step
Epoch 9/50
2262/2262 - 56s - loss: 10.9438 - accuracy10: 0.5579 - accuracy20: 0.5621 - accuracy30: 0.5522 - accuracy50: 0.5273 - val_loss: 11.3863 - val_accuracy10: 0.5938 - val_accuracy20: 0.5764 - val_accuracy30: 0.5521 - val_accuracy50: 0.5040 - 56s/epoch - 25ms/step
Epoch 10/50
2262/2262 - 60s - loss: 10.8953 - accuracy10: 0.5599 - accuracy20: 0.5649 - accuracy30: 0.5543 - accuracy50: 0.5288 - val_loss: 11.2487 - val_accuracy10: 0.5912 - val_accuracy20: 0.5780 - val_accuracy30: 0.5560 - val_accuracy50: 0.5114 - 60s/epoch - 27ms/step
Epoch 11/50
2262/2262 - 51s - loss: 10.8517 - accuracy10: 0.5641 - accuracy20: 0.5690 - accuracy30: 0.5574 - accuracy50: 0.5312 - val_loss: 11.3658 - val_accuracy10: 0.5907 - val_accuracy20: 0.5777 - val_accuracy30: 0.5546 - val_accuracy50: 0.5088 - 51s/epoch - 22ms/step
Epoch 12/50
2262/2262 - 55s - loss: 10.7951 - accuracy10: 0.5687 - accuracy20: 0.5736 - accuracy30: 0.5606 - accuracy50: 0.5334 - val_loss: 11.3696 - val_accuracy10: 0.5854 - val_accuracy20: 0.5749 - val_accuracy30: 0.5539 - val_accuracy50: 0.5104 - 55s/epoch - 24ms/step
Epoch 13/50
2262/2262 - 53s - loss: 10.7517 - accuracy10: 0.5723 - accuracy20: 0.5768 - accuracy30: 0.5637 - accuracy50: 0.5359 - val_loss: 11.3612 - val_accuracy10: 0.5781 - val_accuracy20: 0.5713 - val_accuracy30: 0.5511 - val_accuracy50: 0.5094 - 53s/epoch - 23ms/step
Epoch 14/50
2262/2262 - 54s - loss: 10.7072 - accuracy10: 0.5765 - accuracy20: 0.5796 - accuracy30: 0.5664 - accuracy50: 0.5383 - val_loss: 11.3244 - val_accuracy10: 0.5816 - val_accuracy20: 0.5734 - val_accuracy30: 0.5541 - val_accuracy50: 0.5116 - 54s/epoch - 24ms/step
Epoch 15/50
2262/2262 - 55s - loss: 10.6656 - accuracy10: 0.5792 - accuracy20: 0.5819 - accuracy30: 0.5686 - accuracy50: 0.5398 - val_loss: 11.3663 - val_accuracy10: 0.5839 - val_accuracy20: 0.5753 - val_accuracy30: 0.5548 - val_accuracy50: 0.5117 - 55s/epoch - 24ms/step
Epoch 16/50
2262/2262 - 58s - loss: 10.6255 - accuracy10: 0.5826 - accuracy20: 0.5858 - accuracy30: 0.5718 - accuracy50: 0.5424 - val_loss: 11.5381 - val_accuracy10: 0.5825 - val_accuracy20: 0.5738 - val_accuracy30: 0.5526 - val_accuracy50: 0.5087 - 58s/epoch - 26ms/step
Epoch 17/50
2262/2262 - 60s - loss: 10.5926 - accuracy10: 0.5846 - accuracy20: 0.5873 - accuracy30: 0.5736 - accuracy50: 0.5435 - val_loss: 11.4608 - val_accuracy10: 0.5811 - val_accuracy20: 0.5747 - val_accuracy30: 0.5545 - val_accuracy50: 0.5114 - 60s/epoch - 26ms/step
Epoch 18/50
2262/2262 - 58s - loss: 10.5629 - accuracy10: 0.5875 - accuracy20: 0.5897 - accuracy30: 0.5753 - accuracy50: 0.5447 - val_loss: 11.4124 - val_accuracy10: 0.5767 - val_accuracy20: 0.5717 - val_accuracy30: 0.5537 - val_accuracy50: 0.5125 - 58s/epoch - 26ms/step
Epoch 19/50
2262/2262 - 55s - loss: 10.5349 - accuracy10: 0.5891 - accuracy20: 0.5914 - accuracy30: 0.5769 - accuracy50: 0.5460 - val_loss: 11.5339 - val_accuracy10: 0.5629 - val_accuracy20: 0.5607 - val_accuracy30: 0.5447 - val_accuracy50: 0.5068 - 55s/epoch - 25ms/step
Epoch 20/50
2262/2262 - 56s - loss: 10.5048 - accuracy10: 0.5915 - accuracy20: 0.5931 - accuracy30: 0.5780 - accuracy50: 0.5468 - val_loss: 11.4406 - val_accuracy10: 0.5632 - val_accuracy20: 0.5617 - val_accuracy30: 0.5468 - val_accuracy50: 0.5101 - 56s/epoch - 25ms/step
testing model: results/AAL/W0/deepLOB_L1/seq2seq
Evaluating performance on  test set...
6677/6677 - 67s - 67s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.71475303
{'0': {'precision': 0.32428957483592663, 'recall': 0.542239211459877, 'f1-score': 0.40585500706877825, 'support': 178152}, '1': {'precision': 0.9040650406504065, 'recall': 0.6840032528399166, 'f1-score': 0.7787869465293844, 'support': 1345286}, '2': {'precision': 0.3017104701506189, 'recall': 0.6389415005811201, 'f1-score': 0.40987601480090574, 'support': 185848}, 'accuracy': 0.6643282633801482, 'macro avg': {'precision': 0.5100216952123174, 'recall': 0.6217279882936378, 'f1-score': 0.5315059894663562, 'support': 1709286}, 'weighted avg': {'precision': 0.7781443047384377, 'recall': 0.6643282633801482, 'f1-score': 0.6998066414671185, 'support': 1709286}}
[[ 96601  56106  25445]
 [175721 920180 249385]
 [ 25563  41539 118746]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.743569
{'0': {'precision': 0.41583634874389575, 'recall': 0.48985648854961833, 'f1-score': 0.4498216729099841, 'support': 245625}, '1': {'precision': 0.8422892353180439, 'recall': 0.7100029753343955, 'f1-score': 0.7705093912912037, 'support': 1213309}, '2': {'precision': 0.37716742995113134, 'recall': 0.5983814788777402, 'f1-score': 0.46269336673157907, 'support': 250352}, 'accuracy': 0.6620191120736962, 'macro avg': {'precision': 0.5450976713376904, 'recall': 0.5994136475872514, 'f1-score': 0.5610081436442557, 'support': 1709286}, 'weighted avg': {'precision': 0.7128833521118441, 'recall': 0.6620191120736962, 'f1-score': 0.6793419224135915, 'support': 1709286}}
[[120321  90604  34700]
 [139175 861453 212681]
 [ 29851  70695 149806]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7866667
{'0': {'precision': 0.4687122310333073, 'recall': 0.4579901485788114, 'f1-score': 0.4632891617727391, 'support': 297216}, '1': {'precision': 0.7891768634879627, 'recall': 0.7187159829634611, 'f1-score': 0.7523001737272905, 'support': 1115250}, '2': {'precision': 0.41467733814823177, 'recall': 0.5632875143184422, 'f1-score': 0.47769112859332613, 'support': 296820}, 'accuracy': 0.646389779124149, 'macro avg': {'precision': 0.5575221442231673, 'recall': 0.5799978819535715, 'f1-score': 0.5644268213644519, 'support': 1709286}, 'weighted avg': {'precision': 0.6684210828222451, 'recall': 0.646389779124149, 'f1-score': 0.654359774223786, 'support': 1709286}}
[[136122 117717  43377]
 [121081 801548 192621]
 [ 33214  96411 167195]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.85996014
{'0': {'precision': 0.5276032887268224, 'recall': 0.4036578689715435, 'f1-score': 0.45738237320283076, 'support': 379948}, '1': {'precision': 0.6879499514252819, 'recall': 0.7339113117642766, 'f1-score': 0.7101877860377268, 'support': 959090}, '2': {'precision': 0.45809372075967936, 'recall': 0.48925044834813425, 'f1-score': 0.47315973555463264, 'support': 370248}, 'accuracy': 0.6075051220217097, 'macro avg': {'precision': 0.5578823203039279, 'recall': 0.5422732096946515, 'f1-score': 0.54690996493173, 'support': 1709286}, 'weighted avg': {'precision': 0.602518254511815, 'recall': 0.6075051220217097, 'f1-score': 0.6026504443458989, 'support': 1709286}}
[[153369 170028  56551]
 [ 97468 703887 157735]
 [ 39853 149251 181144]]
Evaluating performance on  train set...
2262/2262 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.86807406
{'0': {'precision': 0.37654402723919417, 'recall': 0.38315400458106363, 'f1-score': 0.3798202598790284, 'support': 103906}, '1': {'precision': 0.7276490415888759, 'recall': 0.7013902837568605, 'f1-score': 0.7142784088631756, 'support': 368414}, '2': {'precision': 0.3864337537293192, 'recall': 0.42805103602377176, 'f1-score': 0.4061791471600957, 'support': 106513}, 'accuracy': 0.5939657897873826, 'macro avg': {'precision': 0.4968756075191298, 'recall': 0.5041984414538986, 'f1-score': 0.5000926053007666, 'support': 578833}, 'weighted avg': {'precision': 0.6018342010790865, 'recall': 0.5939657897873826, 'f1-score': 0.597545629132015, 'support': 578833}}
[[ 39812  50443  13651]
 [ 51272 258402  58740]
 [ 14646  46274  45593]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9469158
{'0': {'precision': 0.44871351434445916, 'recall': 0.3442904533726502, 'f1-score': 0.3896267498706889, 'support': 135650}, '1': {'precision': 0.618274274522164, 'recall': 0.7193654535631845, 'f1-score': 0.6649999167633978, 'support': 305415}, '2': {'precision': 0.44961850601763836, 'recall': 0.3896695894547355, 'f1-score': 0.41750302332725436, 'support': 137768}, 'accuracy': 0.5529954235504887, 'macro avg': {'precision': 0.5055354316280872, 'recall': 0.48444183213019004, 'f1-score': 0.49070989665378034, 'support': 578833}, 'weighted avg': {'precision': 0.5383958207480406, 'recall': 0.5529954235504887, 'f1-score': 0.5415592661717651, 'support': 578833}}
[[ 46703  70188  18759]
 [ 38754 219705  46956]
 [ 18625  65459  53684]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.99893826
{'0': {'precision': 0.4797721449051715, 'recall': 0.3218295324570764, 'f1-score': 0.3852408233197439, 'support': 156499}, '1': {'precision': 0.5407198577946855, 'recall': 0.7226015349873471, 'f1-score': 0.6185678505453657, 'support': 264367}, '2': {'precision': 0.474569101375226, 'recall': 0.36219590167566645, 'f1-score': 0.410836932599478, 'support': 157967}, 'accuracy': 0.5158880022389878, 'macro avg': {'precision': 0.498353701358361, 'recall': 0.4688756563733633, 'f1-score': 0.47154853548819586, 'support': 578833}, 'weighted avg': {'precision': 0.5061884944155954, 'recall': 0.5158880022389878, 'f1-score': 0.4987922393605496, 'support': 578833}}
[[ 50366  83064  23069]
 [ 33057 191032  40278]
 [ 21556  79196  57215]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0735096
{'0': {'precision': 0.5075380203026529, 'recall': 0.2914657535730926, 'f1-score': 0.3702859896066352, 'support': 184574}, '1': {'precision': 0.42727305878689786, 'recall': 0.7278830944791961, 'f1-score': 0.5384637139109931, 'support': 209263}, '2': {'precision': 0.4969573513485638, 'recall': 0.31254189279768213, 'f1-score': 0.38374338791140966, 'support': 184996}, 'accuracy': 0.45597780361520507, 'macro avg': {'precision': 0.47725614347937145, 'recall': 0.44396358028332367, 'f1-score': 0.430831030476346, 'support': 578833}, 'weighted avg': {'precision': 0.4751385750818343, 'recall': 0.45597780361520507, 'f1-score': 0.4353875646341352, 'support': 578833}}
[[ 53797 102610  28167]
 [ 26584 152319  30360]
 [ 25615 101562  57819]]
Evaluating performance on  val set...
827/827 - 7s - 7s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8285018
{'0': {'precision': 0.3525848815455573, 'recall': 0.5582602575006599, 'f1-score': 0.43220108078652203, 'support': 34097}, '1': {'precision': 0.8068167071429896, 'recall': 0.6128612065566383, 'f1-score': 0.6965899178090962, 'support': 142024}, '2': {'precision': 0.38293590904517555, 'recall': 0.5369184324126062, 'f1-score': 0.44703892503934783, 'support': 35443}, 'accuracy': 0.5913387910986746, 'macro avg': {'precision': 0.5141124992445741, 'recall': 0.5693466321566348, 'f1-score': 0.5252766412116553, 'support': 211564}, 'weighted avg': {'precision': 0.6625977016204221, 'recall': 0.5913387910986746, 'f1-score': 0.6121724270606849, 'support': 211564}}
[[19035 10515  4547]
 [28865 87041 26118]
 [ 6087 10326 19030]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8747158
{'0': {'precision': 0.4345882176134656, 'recall': 0.5059376708583926, 'f1-score': 0.46755661549966154, 'support': 45725}, '1': {'precision': 0.7041238920095557, 'recall': 0.6404009898913636, 'f1-score': 0.6707523877305358, 'support': 119205}, '2': {'precision': 0.4569968947210257, 'recall': 0.48914954754042117, 'f1-score': 0.47252690343763265, 'support': 46634}, 'accuracy': 0.5780000378136166, 'macro avg': {'precision': 0.5319030014480156, 'recall': 0.5451627360967258, 'f1-score': 0.53694530222261, 'support': 211564}, 'weighted avg': {'precision': 0.5913965891446329, 'recall': 0.5780000378136166, 'f1-score': 0.5831421425103094, 'support': 211564}}
[[23134 16145  6446]
 [22208 76339 20658]
 [ 7890 15933 22811]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9182679
{'0': {'precision': 0.4744872296428771, 'recall': 0.475639134250873, 'f1-score': 0.47506248367963594, 'support': 53549}, '1': {'precision': 0.6273615514396426, 'recall': 0.6504493248113797, 'f1-score': 0.6386968605929625, 'support': 104045}, '2': {'precision': 0.48971226330207357, 'recall': 0.45378914211599036, 'f1-score': 0.47106682951693096, 'support': 53970}, 'accuracy': 0.5560350532226654, 'macro avg': {'precision': 0.5305203481281978, 'recall': 0.5266258670594144, 'f1-score': 0.5282753912631765, 'support': 211564}, 'weighted avg': {'precision': 0.5535531571065821, 'recall': 0.5560350532226654, 'f1-score': 0.5545168960124802, 'support': 211564}}
[[25470 19993  8086]
 [18935 67676 17434]
 [ 9274 20205 24491]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9877896
{'0': {'precision': 0.5134526665436427, 'recall': 0.4338687041946047, 'f1-score': 0.4703177822853279, 'support': 64130}, '1': {'precision': 0.5068489382770381, 'recall': 0.662024118893932, 'f1-score': 0.5741362925881881, 'support': 83503}, '2': {'precision': 0.5172856373949406, 'recall': 0.3908588947458979, 'f1-score': 0.44527205823391575, 'support': 63931}, 'accuracy': 0.5109234085194079, 'macro avg': {'precision': 0.5125290807385405, 'recall': 0.49558390594481155, 'f1-score': 0.4965753777024773, 'support': 211564}, 'weighted avg': {'precision': 0.5120044737416918, 'recall': 0.5109234085194079, 'f1-score': 0.503725918270131, 'support': 211564}}
[[27824 26218 10088]
 [14992 55281 13230]
 [11374 27569 24988]]
training model: results/AAL/W0/deepOF_L1/seq2seq
Epoch 1/50
2262/2262 - 58s - loss: 12.4444 - accuracy10: 0.4380 - accuracy20: 0.4532 - accuracy30: 0.4567 - accuracy50: 0.4506 - val_loss: 12.6543 - val_accuracy10: 0.6091 - val_accuracy20: 0.5373 - val_accuracy30: 0.4850 - val_accuracy50: 0.4027 - 58s/epoch - 26ms/step
Epoch 2/50
2262/2262 - 51s - loss: 12.4901 - accuracy10: 0.4187 - accuracy20: 0.4407 - accuracy30: 0.4485 - accuracy50: 0.4462 - val_loss: 12.5301 - val_accuracy10: 0.5952 - val_accuracy20: 0.5365 - val_accuracy30: 0.4887 - val_accuracy50: 0.4033 - 51s/epoch - 22ms/step
Epoch 3/50
2262/2262 - 54s - loss: 12.5267 - accuracy10: 0.4097 - accuracy20: 0.4384 - accuracy30: 0.4482 - accuracy50: 0.4441 - val_loss: 12.4421 - val_accuracy10: 0.6136 - val_accuracy20: 0.5528 - val_accuracy30: 0.4994 - val_accuracy50: 0.4129 - 54s/epoch - 24ms/step
Epoch 4/50
2262/2262 - 55s - loss: 12.4492 - accuracy10: 0.4329 - accuracy20: 0.4541 - accuracy30: 0.4602 - accuracy50: 0.4518 - val_loss: 12.4015 - val_accuracy10: 0.6052 - val_accuracy20: 0.5468 - val_accuracy30: 0.4985 - val_accuracy50: 0.4165 - 55s/epoch - 24ms/step
Epoch 5/50
2262/2262 - 54s - loss: 12.4143 - accuracy10: 0.4403 - accuracy20: 0.4576 - accuracy30: 0.4620 - accuracy50: 0.4539 - val_loss: 12.3454 - val_accuracy10: 0.6088 - val_accuracy20: 0.5524 - val_accuracy30: 0.5051 - val_accuracy50: 0.4255 - 54s/epoch - 24ms/step
Epoch 6/50
2262/2262 - 55s - loss: 12.3670 - accuracy10: 0.4472 - accuracy20: 0.4613 - accuracy30: 0.4647 - accuracy50: 0.4580 - val_loss: 12.3282 - val_accuracy10: 0.6123 - val_accuracy20: 0.5545 - val_accuracy30: 0.5082 - val_accuracy50: 0.4306 - 55s/epoch - 24ms/step
Epoch 7/50
2262/2262 - 51s - loss: 12.3194 - accuracy10: 0.4521 - accuracy20: 0.4653 - accuracy30: 0.4680 - accuracy50: 0.4607 - val_loss: 12.3247 - val_accuracy10: 0.6176 - val_accuracy20: 0.5571 - val_accuracy30: 0.5093 - val_accuracy50: 0.4313 - 51s/epoch - 23ms/step
Epoch 8/50
2262/2262 - 54s - loss: 12.2508 - accuracy10: 0.4573 - accuracy20: 0.4708 - accuracy30: 0.4735 - accuracy50: 0.4653 - val_loss: 12.2871 - val_accuracy10: 0.6122 - val_accuracy20: 0.5553 - val_accuracy30: 0.5108 - val_accuracy50: 0.4374 - 54s/epoch - 24ms/step
Epoch 9/50
2262/2262 - 56s - loss: 12.1882 - accuracy10: 0.4587 - accuracy20: 0.4738 - accuracy30: 0.4774 - accuracy50: 0.4697 - val_loss: 12.2704 - val_accuracy10: 0.6259 - val_accuracy20: 0.5644 - val_accuracy30: 0.5161 - val_accuracy50: 0.4370 - 56s/epoch - 25ms/step
Epoch 10/50
2262/2262 - 55s - loss: 12.1129 - accuracy10: 0.4677 - accuracy20: 0.4817 - accuracy30: 0.4834 - accuracy50: 0.4738 - val_loss: 12.1697 - val_accuracy10: 0.6150 - val_accuracy20: 0.5605 - val_accuracy30: 0.5179 - val_accuracy50: 0.4461 - 55s/epoch - 25ms/step
Epoch 11/50
2262/2262 - 55s - loss: 12.0375 - accuracy10: 0.4718 - accuracy20: 0.4857 - accuracy30: 0.4876 - accuracy50: 0.4784 - val_loss: 12.1776 - val_accuracy10: 0.6231 - val_accuracy20: 0.5658 - val_accuracy30: 0.5220 - val_accuracy50: 0.4478 - 55s/epoch - 24ms/step
Epoch 12/50
2262/2262 - 54s - loss: 11.9940 - accuracy10: 0.4780 - accuracy20: 0.4890 - accuracy30: 0.4897 - accuracy50: 0.4798 - val_loss: 12.0815 - val_accuracy10: 0.6194 - val_accuracy20: 0.5650 - val_accuracy30: 0.5247 - val_accuracy50: 0.4546 - 54s/epoch - 24ms/step
Epoch 13/50
2262/2262 - 57s - loss: 11.9479 - accuracy10: 0.4836 - accuracy20: 0.4931 - accuracy30: 0.4928 - accuracy50: 0.4822 - val_loss: 12.0678 - val_accuracy10: 0.6110 - val_accuracy20: 0.5618 - val_accuracy30: 0.5243 - val_accuracy50: 0.4585 - 57s/epoch - 25ms/step
Epoch 14/50
2262/2262 - 57s - loss: 11.9051 - accuracy10: 0.4871 - accuracy20: 0.4959 - accuracy30: 0.4951 - accuracy50: 0.4841 - val_loss: 12.0315 - val_accuracy10: 0.6112 - val_accuracy20: 0.5624 - val_accuracy30: 0.5265 - val_accuracy50: 0.4612 - 57s/epoch - 25ms/step
Epoch 15/50
2262/2262 - 52s - loss: 11.8671 - accuracy10: 0.4887 - accuracy20: 0.4978 - accuracy30: 0.4966 - accuracy50: 0.4860 - val_loss: 11.9820 - val_accuracy10: 0.6090 - val_accuracy20: 0.5619 - val_accuracy30: 0.5268 - val_accuracy50: 0.4637 - 52s/epoch - 23ms/step
Epoch 16/50
2262/2262 - 56s - loss: 11.8297 - accuracy10: 0.4913 - accuracy20: 0.5008 - accuracy30: 0.4998 - accuracy50: 0.4889 - val_loss: 12.0167 - val_accuracy10: 0.6083 - val_accuracy20: 0.5623 - val_accuracy30: 0.5271 - val_accuracy50: 0.4635 - 56s/epoch - 25ms/step
Epoch 17/50
2262/2262 - 54s - loss: 11.7979 - accuracy10: 0.4942 - accuracy20: 0.5041 - accuracy30: 0.5022 - accuracy50: 0.4902 - val_loss: 12.0097 - val_accuracy10: 0.6116 - val_accuracy20: 0.5648 - val_accuracy30: 0.5295 - val_accuracy50: 0.4664 - 54s/epoch - 24ms/step
Epoch 18/50
2262/2262 - 54s - loss: 11.7615 - accuracy10: 0.4967 - accuracy20: 0.5065 - accuracy30: 0.5046 - accuracy50: 0.4930 - val_loss: 11.9961 - val_accuracy10: 0.6067 - val_accuracy20: 0.5624 - val_accuracy30: 0.5292 - val_accuracy50: 0.4680 - 54s/epoch - 24ms/step
Epoch 19/50
2262/2262 - 53s - loss: 11.7403 - accuracy10: 0.4976 - accuracy20: 0.5078 - accuracy30: 0.5059 - accuracy50: 0.4942 - val_loss: 12.0328 - val_accuracy10: 0.6094 - val_accuracy20: 0.5641 - val_accuracy30: 0.5292 - val_accuracy50: 0.4670 - 53s/epoch - 23ms/step
Epoch 20/50
2262/2262 - 51s - loss: 11.7151 - accuracy10: 0.4994 - accuracy20: 0.5092 - accuracy30: 0.5073 - accuracy50: 0.4962 - val_loss: 12.0271 - val_accuracy10: 0.6128 - val_accuracy20: 0.5661 - val_accuracy30: 0.5312 - val_accuracy50: 0.4697 - 51s/epoch - 23ms/step
Epoch 21/50
2262/2262 - 51s - loss: 11.6878 - accuracy10: 0.5016 - accuracy20: 0.5114 - accuracy30: 0.5090 - accuracy50: 0.4972 - val_loss: 12.0120 - val_accuracy10: 0.6098 - val_accuracy20: 0.5657 - val_accuracy30: 0.5323 - val_accuracy50: 0.4716 - 51s/epoch - 23ms/step
Epoch 22/50
2262/2262 - 53s - loss: 11.6687 - accuracy10: 0.5016 - accuracy20: 0.5128 - accuracy30: 0.5106 - accuracy50: 0.4985 - val_loss: 12.0312 - val_accuracy10: 0.6109 - val_accuracy20: 0.5666 - val_accuracy30: 0.5312 - val_accuracy50: 0.4711 - 53s/epoch - 23ms/step
Epoch 23/50
2262/2262 - 53s - loss: 11.6428 - accuracy10: 0.5042 - accuracy20: 0.5144 - accuracy30: 0.5125 - accuracy50: 0.4999 - val_loss: 11.9842 - val_accuracy10: 0.6053 - val_accuracy20: 0.5631 - val_accuracy30: 0.5303 - val_accuracy50: 0.4729 - 53s/epoch - 23ms/step
Epoch 24/50
2262/2262 - 53s - loss: 11.6160 - accuracy10: 0.5052 - accuracy20: 0.5160 - accuracy30: 0.5142 - accuracy50: 0.5015 - val_loss: 12.0258 - val_accuracy10: 0.6093 - val_accuracy20: 0.5657 - val_accuracy30: 0.5323 - val_accuracy50: 0.4727 - 53s/epoch - 23ms/step
Epoch 25/50
2262/2262 - 53s - loss: 11.5940 - accuracy10: 0.5076 - accuracy20: 0.5179 - accuracy30: 0.5163 - accuracy50: 0.5030 - val_loss: 12.0243 - val_accuracy10: 0.6072 - val_accuracy20: 0.5649 - val_accuracy30: 0.5318 - val_accuracy50: 0.4738 - 53s/epoch - 23ms/step
testing model: results/AAL/W0/deepOF_L1/seq2seq
Evaluating performance on  test set...
6677/6677 - 59s - 59s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7936927
{'0': {'precision': 0.27137509811423455, 'recall': 0.38620263822621387, 'f1-score': 0.31876316075991296, 'support': 178150}, '1': {'precision': 0.8524899294384817, 'recall': 0.7500631836846346, 'f1-score': 0.7980032677826054, 'support': 1345284}, '2': {'precision': 0.28172523538967004, 'recall': 0.4124790822558341, 'f1-score': 0.3347883716309021, 'support': 185847}, 'accuracy': 0.675434875833757, 'macro avg': {'precision': 0.46853008764746207, 'recall': 0.5162483013888942, 'f1-score': 0.48385160005780686, 'support': 1709281}, 'weighted avg': {'precision': 0.729864969999218, 'recall': 0.675434875833757, 'f1-score': 0.6976899056898903, 'support': 1709281}}
[[  68802   89143   20205]
 [ 160997 1009048  175239]
 [  23732   85457   76658]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.83095706
{'0': {'precision': 0.3415170906244346, 'recall': 0.376552684398448, 'f1-score': 0.3581801705509213, 'support': 245623}, '1': {'precision': 0.7866631994301673, 'recall': 0.745494136690766, 'f1-score': 0.7655255617681547, 'support': 1213308}, '2': {'precision': 0.3470685850288759, 'recall': 0.40016377072099063, 'f1-score': 0.37172981768055224, 'support': 250350}, 'accuracy': 0.6418985526662966, 'macro avg': {'precision': 0.49174962502782593, 'recall': 0.5074035306034016, 'f1-score': 0.4984785166665427, 'support': 1709281}, 'weighted avg': {'precision': 0.6583106146892419, 'recall': 0.6418985526662966, 'f1-score': 0.6493128608961027, 'support': 1709281}}
[[ 92490 123704  29429]
 [149755 904514 159039]
 [ 28576 121593 100181]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8688433
{'0': {'precision': 0.3932074046089913, 'recall': 0.35019211746418405, 'f1-score': 0.37045526539648416, 'support': 297214}, '1': {'precision': 0.7266243196829704, 'recall': 0.7622046735751389, 'f1-score': 0.7439893431732767, 'support': 1115249}, '2': {'precision': 0.39238211719483695, 'recall': 0.36317204482207954, 'f1-score': 0.3772124435735032, 'support': 296818}, 'accuracy': 0.6212705810220789, 'macro avg': {'precision': 0.5040712804955995, 'recall': 0.49185627862046744, 'f1-score': 0.497219017381088, 'support': 1709281}, 'weighted avg': {'precision': 0.6106075400809503, 'recall': 0.6212705810220789, 'f1-score': 0.6153472163505032, 'support': 1709281}}
[[104082 160580  32552]
 [130827 850048 134374]
 [ 29791 159231 107796]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9305661
{'0': {'precision': 0.4619655225865403, 'recall': 0.2980660409637159, 'f1-score': 0.3623434630422402, 'support': 379946}, '1': {'precision': 0.62401683819118, 'recall': 0.7895004639814824, 'f1-score': 0.697071882356082, 'support': 959090}, '2': {'precision': 0.44137086512726215, 'recall': 0.29886426555389, 'f1-score': 0.35640021386653964, 'support': 370245}, 'accuracy': 0.5739863720476621, 'macro avg': {'precision': 0.5091177419683275, 'recall': 0.4621435901663628, 'f1-score': 0.47193851975495393, 'support': 1709281}, 'weighted avg': {'precision': 0.5484327139566213, 'recall': 0.5739863720476621, 'f1-score': 0.5488746544546852, 'support': 1709281}}
[[113249 228884  37813]
 [ 99651 757202 102237]
 [ 32246 227346 110653]]
Evaluating performance on  train set...
2262/2262 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.878825
{'0': {'precision': 0.37297700292481506, 'recall': 0.31241173249301063, 'f1-score': 0.34001840311179893, 'support': 104087}, '1': {'precision': 0.7088660805902888, 'recall': 0.7373574144486692, 'f1-score': 0.7228311006803789, 'support': 368200}, '2': {'precision': 0.37481016502986736, 'recall': 0.38220828953296293, 'f1-score': 0.37847307740565367, 'support': 106544}, 'accuracy': 0.5955710734221215, 'macro avg': {'precision': 0.48555108284832377, 'recall': 0.4773258121582143, 'f1-score': 0.4804408603992772, 'support': 578831}, 'weighted avg': {'precision': 0.5869767210113517, 'recall': 0.5955710734221215, 'f1-score': 0.5906075216329486, 'support': 578831}}
[[ 32518  57022  14547]
 [ 43327 271495  53378]
 [ 11340  54482  40722]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.93655205
{'0': {'precision': 0.4417743730206283, 'recall': 0.30408814063616213, 'f1-score': 0.3602228164381649, 'support': 135783}, '1': {'precision': 0.6093604573859859, 'recall': 0.7357521271472146, 'f1-score': 0.6666181818181819, 'support': 305221}, '2': {'precision': 0.43643335216282375, 'recall': 0.36997105066496405, 'f1-score': 0.4004633538177606, 'support': 137827}, 'accuracy': 0.5473946626908373, 'macro avg': {'precision': 0.49585606085647926, 'recall': 0.4699371061494469, 'f1-score': 0.47576811735803587, 'support': 578831}, 'weighted avg': {'precision': 0.5288717388740642, 'recall': 0.5473946626908373, 'f1-score': 0.5313686817461247, 'support': 578831}}
[[ 41290  73041  21452]
 [ 36260 224567  44394]
 [ 15914  70921  50992]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.98210156
{'0': {'precision': 0.48007316240069636, 'recall': 0.2783243049877351, 'f1-score': 0.35236412307269277, 'support': 156544}, '1': {'precision': 0.5292247934498256, 'recall': 0.7543804578443571, 'f1-score': 0.6220554825289754, 'support': 264413}, '2': {'precision': 0.4709538716177317, 'recall': 0.3316252201122414, 'f1-score': 0.38919573895525605, 'support': 157874}, 'accuracy': 0.5103268484238059, 'macro avg': {'precision': 0.49341727582275124, 'recall': 0.45477666098144454, 'f1-score': 0.4545384481856414, 'support': 578831}, 'weighted avg': {'precision': 0.5000386295362224, 'recall': 0.5103268484238059, 'f1-score': 0.4856062195633056, 'support': 578831}}
[[ 43570  89529  23445]
 [ 29577 199468  35368]
 [ 17610  87909  52355]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0471776
{'0': {'precision': 0.5182175022877233, 'recall': 0.23309178743961353, 'f1-score': 0.3215513119359273, 'support': 184644}, '1': {'precision': 0.41490759482754247, 'recall': 0.7819398632821837, 'f1-score': 0.5421455938697318, 'support': 209190}, '2': {'precision': 0.5030776958153186, 'recall': 0.2761179911025584, 'f1-score': 0.3565440750486853, 'support': 184997}, 'accuracy': 0.44519730283968895, 'macro avg': {'precision': 0.47873426431019483, 'recall': 0.43038321394145185, 'f1-score': 0.4067469936181148, 'support': 578831}, 'weighted avg': {'precision': 0.4760424661898456, 'recall': 0.44519730283968895, 'f1-score': 0.4124581120819171, 'support': 578831}}
[[ 43039 115954  25651]
 [ 20811 163574  24805]
 [ 19202 114714  51081]]
Evaluating performance on  val set...
827/827 - 7s - 7s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8611775
{'0': {'precision': 0.3501884911362433, 'recall': 0.32988964545668, 'f1-score': 0.3397361302120328, 'support': 34072}, '1': {'precision': 0.7410401087211743, 'recall': 0.7329875358055276, 'f1-score': 0.736991826769982, 'support': 142087}, '2': {'precision': 0.3477802897954989, 'recall': 0.38234712611213106, 'f1-score': 0.3642454492862812, 'support': 35405}, 'accuracy': 0.6093900663628973, 'macro avg': {'precision': 0.4796696298843055, 'recall': 0.4817414357914462, 'f1-score': 0.48032446875609863, 'support': 211564}, 'weighted avg': {'precision': 0.6122825686698551, 'recall': 0.6093900663628973, 'f1-score': 0.6106358229700308, 'support': 211564}}
[[ 11240  18530   4302]
 [ 16854 104148  21085]
 [  4003  17865  13537]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.91944265
{'0': {'precision': 0.4238579423916547, 'recall': 0.31616795261305763, 'f1-score': 0.3621773204136308, 'support': 45751}, '1': {'precision': 0.6412692813627578, 'recall': 0.7319409495051166, 'f1-score': 0.6836116366428121, 'support': 119220}, '2': {'precision': 0.413031914893617, 'recall': 0.36664305797008134, 'f1-score': 0.3884574716041522, 'support': 46593}, 'accuracy': 0.5615794747688643, 'macro avg': {'precision': 0.4927197128826765, 'recall': 0.47158398669608514, 'f1-score': 0.47808214288686507, 'support': 211564}, 'weighted avg': {'precision': 0.5439887904230724, 'recall': 0.5615794747688643, 'f1-score': 0.549098867866236, 'support': 211564}}
[[14465 24696  6590]
 [14271 87262 17687]
 [ 5391 24119 17083]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.96644187
{'0': {'precision': 0.46806585851275556, 'recall': 0.289924913145803, 'f1-score': 0.3580622837370242, 'support': 53538}, '1': {'precision': 0.5619063381497899, 'recall': 0.7500648371387131, 'f1-score': 0.6424930576982412, 'support': 104107}, '2': {'precision': 0.4527565045392301, 'recall': 0.33112631910829204, 'f1-score': 0.3825051149936263, 'support': 53919}, 'accuracy': 0.5268523945472765, 'macro avg': {'precision': 0.4942429004005919, 'recall': 0.4570386897976027, 'f1-score': 0.4610201521429638, 'support': 211564}, 'weighted avg': {'precision': 0.510341414640803, 'recall': 0.5268523945472765, 'f1-score': 0.504255244747901, 'support': 211564}}
[[15522 30632  7384]
 [11824 78087 14196]
 [ 5816 30249 17854]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0358086
{'0': {'precision': 0.5125192288809609, 'recall': 0.2439476553980371, 'f1-score': 0.33055740265771616, 'support': 64190}, '1': {'precision': 0.44632643627407015, 'recall': 0.7749838272995184, 'f1-score': 0.5664339032025042, 'support': 83474}, '2': {'precision': 0.4884945938453008, 'recall': 0.27574334898278563, 'f1-score': 0.3525057517255177, 'support': 63900}, 'accuracy': 0.46307500330869145, 'macro avg': {'precision': 0.48244675300011064, 'recall': 0.43155827722678036, 'f1-score': 0.416499019195246, 'support': 211564}, 'weighted avg': {'precision': 0.47914610609614744, 'recall': 0.46307500330869145, 'f1-score': 0.430253260704965, 'support': 211564}}
[[15659 40347  8184]
 [ 8517 64691 10266]
 [ 6377 39903 17620]]
training model: results/AAL/W0/deepLOB_L2/seq2seq
Epoch 1/50
2262/2262 - 115s - loss: 11.8992 - accuracy10: 0.4757 - accuracy20: 0.4879 - accuracy30: 0.4896 - accuracy50: 0.4809 - val_loss: 14.1718 - val_accuracy10: 0.4639 - val_accuracy20: 0.4406 - val_accuracy30: 0.4209 - val_accuracy50: 0.3896 - 115s/epoch - 51ms/step
Epoch 2/50
2262/2262 - 109s - loss: 11.5819 - accuracy10: 0.4950 - accuracy20: 0.5123 - accuracy30: 0.5156 - accuracy50: 0.5035 - val_loss: 13.5659 - val_accuracy10: 0.4425 - val_accuracy20: 0.4204 - val_accuracy30: 0.4004 - val_accuracy50: 0.3701 - 109s/epoch - 48ms/step
Epoch 3/50
2262/2262 - 108s - loss: 11.1188 - accuracy10: 0.5497 - accuracy20: 0.5556 - accuracy30: 0.5502 - accuracy50: 0.5276 - val_loss: 13.5321 - val_accuracy10: 0.4458 - val_accuracy20: 0.4308 - val_accuracy30: 0.4173 - val_accuracy50: 0.3934 - 108s/epoch - 48ms/step
Epoch 4/50
2262/2262 - 108s - loss: 10.7221 - accuracy10: 0.5888 - accuracy20: 0.5859 - accuracy30: 0.5725 - accuracy50: 0.5420 - val_loss: 12.5280 - val_accuracy10: 0.5156 - val_accuracy20: 0.4941 - val_accuracy30: 0.4741 - val_accuracy50: 0.4421 - 108s/epoch - 48ms/step
Epoch 5/50
2262/2262 - 108s - loss: 10.5083 - accuracy10: 0.6053 - accuracy20: 0.5995 - accuracy30: 0.5833 - accuracy50: 0.5493 - val_loss: 12.1422 - val_accuracy10: 0.5353 - val_accuracy20: 0.5138 - val_accuracy30: 0.4922 - val_accuracy50: 0.4604 - 108s/epoch - 48ms/step
Epoch 6/50
2262/2262 - 108s - loss: 10.3795 - accuracy10: 0.6136 - accuracy20: 0.6060 - accuracy30: 0.5889 - accuracy50: 0.5532 - val_loss: 12.9975 - val_accuracy10: 0.5056 - val_accuracy20: 0.4861 - val_accuracy30: 0.4653 - val_accuracy50: 0.4353 - 108s/epoch - 48ms/step
Epoch 7/50
2262/2262 - 109s - loss: 10.3040 - accuracy10: 0.6172 - accuracy20: 0.6095 - accuracy30: 0.5920 - accuracy50: 0.5551 - val_loss: 12.5879 - val_accuracy10: 0.5095 - val_accuracy20: 0.4941 - val_accuracy30: 0.4750 - val_accuracy50: 0.4464 - 109s/epoch - 48ms/step
Epoch 8/50
2262/2262 - 108s - loss: 10.2483 - accuracy10: 0.6203 - accuracy20: 0.6123 - accuracy30: 0.5942 - accuracy50: 0.5572 - val_loss: 12.3728 - val_accuracy10: 0.5327 - val_accuracy20: 0.5083 - val_accuracy30: 0.4830 - val_accuracy50: 0.4483 - 108s/epoch - 48ms/step
Epoch 9/50
2262/2262 - 108s - loss: 10.1954 - accuracy10: 0.6230 - accuracy20: 0.6152 - accuracy30: 0.5969 - accuracy50: 0.5592 - val_loss: 12.3413 - val_accuracy10: 0.5211 - val_accuracy20: 0.5023 - val_accuracy30: 0.4823 - val_accuracy50: 0.4511 - 108s/epoch - 48ms/step
Epoch 10/50
2262/2262 - 109s - loss: 10.1586 - accuracy10: 0.6245 - accuracy20: 0.6163 - accuracy30: 0.5981 - accuracy50: 0.5605 - val_loss: 11.9107 - val_accuracy10: 0.5431 - val_accuracy20: 0.5263 - val_accuracy30: 0.5051 - val_accuracy50: 0.4710 - 109s/epoch - 48ms/step
Epoch 11/50
2262/2262 - 108s - loss: 10.1222 - accuracy10: 0.6258 - accuracy20: 0.6183 - accuracy30: 0.6005 - accuracy50: 0.5621 - val_loss: 11.9827 - val_accuracy10: 0.5499 - val_accuracy20: 0.5313 - val_accuracy30: 0.5098 - val_accuracy50: 0.4726 - 108s/epoch - 48ms/step
Epoch 12/50
2262/2262 - 108s - loss: 10.0920 - accuracy10: 0.6272 - accuracy20: 0.6193 - accuracy30: 0.6010 - accuracy50: 0.5632 - val_loss: 11.9960 - val_accuracy10: 0.5550 - val_accuracy20: 0.5333 - val_accuracy30: 0.5101 - val_accuracy50: 0.4716 - 108s/epoch - 48ms/step
Epoch 13/50
2262/2262 - 108s - loss: 10.0673 - accuracy10: 0.6283 - accuracy20: 0.6209 - accuracy30: 0.6020 - accuracy50: 0.5641 - val_loss: 12.0827 - val_accuracy10: 0.5201 - val_accuracy20: 0.5122 - val_accuracy30: 0.4969 - val_accuracy50: 0.4676 - 108s/epoch - 48ms/step
Epoch 14/50
2262/2262 - 108s - loss: 10.0424 - accuracy10: 0.6291 - accuracy20: 0.6217 - accuracy30: 0.6036 - accuracy50: 0.5656 - val_loss: 12.1938 - val_accuracy10: 0.5109 - val_accuracy20: 0.5013 - val_accuracy30: 0.4866 - val_accuracy50: 0.4593 - 108s/epoch - 48ms/step
Epoch 15/50
2262/2262 - 108s - loss: 10.0216 - accuracy10: 0.6295 - accuracy20: 0.6226 - accuracy30: 0.6043 - accuracy50: 0.5664 - val_loss: 12.4797 - val_accuracy10: 0.5104 - val_accuracy20: 0.4997 - val_accuracy30: 0.4845 - val_accuracy50: 0.4558 - 108s/epoch - 48ms/step
Epoch 16/50
2262/2262 - 109s - loss: 10.0011 - accuracy10: 0.6297 - accuracy20: 0.6230 - accuracy30: 0.6046 - accuracy50: 0.5669 - val_loss: 12.4038 - val_accuracy10: 0.5370 - val_accuracy20: 0.5204 - val_accuracy30: 0.5002 - val_accuracy50: 0.4631 - 109s/epoch - 48ms/step
Epoch 17/50
2262/2262 - 107s - loss: 9.9817 - accuracy10: 0.6305 - accuracy20: 0.6236 - accuracy30: 0.6059 - accuracy50: 0.5680 - val_loss: 12.3713 - val_accuracy10: 0.5236 - val_accuracy20: 0.5110 - val_accuracy30: 0.4947 - val_accuracy50: 0.4620 - 107s/epoch - 47ms/step
Epoch 18/50
2262/2262 - 108s - loss: 9.9611 - accuracy10: 0.6314 - accuracy20: 0.6247 - accuracy30: 0.6066 - accuracy50: 0.5687 - val_loss: 12.5521 - val_accuracy10: 0.5064 - val_accuracy20: 0.5002 - val_accuracy30: 0.4863 - val_accuracy50: 0.4592 - 108s/epoch - 48ms/step
Epoch 19/50
2262/2262 - 108s - loss: 9.9413 - accuracy10: 0.6323 - accuracy20: 0.6254 - accuracy30: 0.6076 - accuracy50: 0.5698 - val_loss: 12.8161 - val_accuracy10: 0.5005 - val_accuracy20: 0.4919 - val_accuracy30: 0.4787 - val_accuracy50: 0.4532 - 108s/epoch - 48ms/step
Epoch 20/50
2262/2262 - 108s - loss: 9.9222 - accuracy10: 0.6322 - accuracy20: 0.6260 - accuracy30: 0.6084 - accuracy50: 0.5706 - val_loss: 12.2921 - val_accuracy10: 0.5230 - val_accuracy20: 0.5138 - val_accuracy30: 0.4992 - val_accuracy50: 0.4699 - 108s/epoch - 48ms/step
testing model: results/AAL/W0/deepLOB_L2/seq2seq
Evaluating performance on  test set...
6677/6677 - 107s - 107s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.98349667
{'0': {'precision': 0.23722036345391292, 'recall': 0.5201625578157978, 'f1-score': 0.32584085950424846, 'support': 178152}, '1': {'precision': 0.8923347023231025, 'recall': 0.5289358545320475, 'f1-score': 0.6641772968916481, 'support': 1345286}, '2': {'precision': 0.22654157553432333, 'recall': 0.6353471654255091, 'f1-score': 0.3339933358602002, 'support': 185848}, 'accuracy': 0.5395913849408467, 'macro avg': {'precision': 0.4520322137704463, 'recall': 0.5614818592577847, 'f1-score': 0.4413371640853656, 'support': 1709286}, 'weighted avg': {'precision': 0.7516641236571185, 'recall': 0.5395913849408467, 'f1-score': 0.5930134648686791, 'support': 1709286}}
[[ 92668  50412  35072]
 [265646 711570 368070]
 [ 32327  35443 118078]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0143713
{'0': {'precision': 0.301560379115035, 'recall': 0.5182737913486005, 'f1-score': 0.3812742787143999, 'support': 245625}, '1': {'precision': 0.8360746780252128, 'recall': 0.5409858494414861, 'f1-score': 0.6569131288950183, 'support': 1213309}, '2': {'precision': 0.2952508425153565, 'recall': 0.592110308685371, 'f1-score': 0.3940246139124425, 'support': 250352}, 'accuracy': 0.5452101052720258, 'macro avg': {'precision': 0.4776286332185348, 'recall': 0.5504566498251525, 'f1-score': 0.47740400717395354, 'support': 1709286}, 'weighted avg': {'precision': 0.6800525708194112, 'recall': 0.5452101052720258, 'f1-score': 0.5787995434104755, 'support': 1709286}}
[[127301  73970  44354]
 [247448 656383 309478]
 [ 47392  54724 148236]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0299026
{'0': {'precision': 0.3429099019705821, 'recall': 0.5079639050387597, 'f1-score': 0.40942817006828547, 'support': 297216}, '1': {'precision': 0.7863925064116196, 'recall': 0.5504317417619368, 'f1-score': 0.6475875906710609, 'support': 1115250}, '2': {'precision': 0.33696017166397757, 'recall': 0.554443770635402, 'f1-score': 0.4191712853533295, 'support': 296820}, 'accuracy': 0.5437439960310914, 'macro avg': {'precision': 0.48875419334872644, 'recall': 0.5376131391453661, 'f1-score': 0.4920623486975586, 'support': 1709286}, 'weighted avg': {'precision': 0.6312337843713394, 'recall': 0.5437439960310914, 'f1-score': 0.5665108614997674, 'support': 1709286}}
[[150975  93987  52254]
 [229809 613869 271572]
 [ 59492  72758 164570]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0412673
{'0': {'precision': 0.3997556225559499, 'recall': 0.4770336993483319, 'f1-score': 0.4349891101524579, 'support': 379948}, '1': {'precision': 0.697456714333214, 'recall': 0.5664598734216809, 'f1-score': 0.6251698030486011, 'support': 959090}, '2': {'precision': 0.38833931596692217, 'recall': 0.5002403794213608, 'f1-score': 0.43724385729664395, 'support': 370248}, 'accuracy': 0.5322380221917221, 'macro avg': {'precision': 0.49518388428536203, 'recall': 0.5145779840637912, 'f1-score': 0.4991342568325677, 'support': 1709286}, 'weighted avg': {'precision': 0.5643244983501013, 'recall': 0.5322380221917221, 'f1-score': 0.542188968087527, 'support': 1709286}}
[[181248 129917  68783]
 [192864 543286 222940]
 [ 79285 105750 185213]]
Evaluating performance on  train set...
2262/2262 - 38s - 38s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9366827
{'0': {'precision': 0.32019269765759445, 'recall': 0.5622678189902411, 'f1-score': 0.40802743323276336, 'support': 103906}, '1': {'precision': 0.8063206966728194, 'recall': 0.5549219085051057, 'f1-score': 0.6574067225972006, 'support': 368414}, '2': {'precision': 0.3930879480195767, 'recall': 0.5270905898810474, 'f1-score': 0.4503320820098181, 'support': 106513}, 'accuracy': 0.5511192347360984, 'macro avg': {'precision': 0.5065337807833301, 'recall': 0.5480934391254647, 'f1-score': 0.5052554126132606, 'support': 578833}, 'weighted avg': {'precision': 0.6430157786343198, 'recall': 0.5511192347360984, 'f1-score': 0.5745362821876436, 'support': 578833}}
[[ 58423  24600  20883]
 [ 98175 204441  65798]
 [ 25864  24507  56142]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9637689
{'0': {'precision': 0.37971017459115375, 'recall': 0.5470401769259122, 'f1-score': 0.4482689879726227, 'support': 135650}, '1': {'precision': 0.71116652904393, 'recall': 0.5611675916376079, 'f1-score': 0.6273251685541312, 'support': 305415}, '2': {'precision': 0.45908937700129204, 'recall': 0.47455141977817783, 'f1-score': 0.46669236479926907, 'support': 137768}, 'accuracy': 0.5372413113972424, 'macro avg': {'precision': 0.5166553602121252, 'recall': 0.5275863961138993, 'f1-score': 0.5140955071086744, 'support': 578833}, 'weighted avg': {'precision': 0.573492589299428, 'recall': 0.5372413113972424, 'f1-score': 0.5471310002817945, 'support': 578833}}
[[ 74206  34546  26898]
 [ 83894 171389  50132]
 [ 37328  35062  65378]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.990667
{'0': {'precision': 0.407045557147624, 'recall': 0.5300417255062333, 'f1-score': 0.4604717905447602, 'support': 156499}, '1': {'precision': 0.6341006355114538, 'recall': 0.5593398570926024, 'f1-score': 0.5943786238983852, 'support': 264367}, '2': {'precision': 0.486073022340973, 'recall': 0.43647090848088527, 'f1-score': 0.4599384952003575, 'support': 157967}, 'accuracy': 0.5178868516480574, 'macro avg': {'precision': 0.5090730716666837, 'recall': 0.5086174970265737, 'f1-score': 0.5049296365478343, 'support': 578833}, 'weighted avg': {'precision': 0.5323141605202865, 'recall': 0.5178868516480574, 'f1-score': 0.5214847333927466, 'support': 578833}}
[[ 82951  42291  31257]
 [ 74854 147871  41642]
 [ 45983  43036  68948]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0354459
{'0': {'precision': 0.43671631023910545, 'recall': 0.4985371720827419, 'f1-score': 0.46558354162661025, 'support': 184574}, '1': {'precision': 0.5129002066152188, 'recall': 0.5551674209009715, 'f1-score': 0.533197482163797, 'support': 209263}, '2': {'precision': 0.506309003481073, 'recall': 0.3876029751994638, 'f1-score': 0.43907427308270497, 'support': 184996}, 'accuracy': 0.4835557060499315, 'macro avg': {'precision': 0.4853085067784657, 'recall': 0.4804358560610591, 'f1-score': 0.47928509895770405, 'support': 578833}, 'weighted avg': {'precision': 0.4865006877475502, 'recall': 0.4835557060499315, 'f1-score': 0.4815553113686343, 'support': 578833}}
[[ 92017  54718  37839]
 [ 61008 116176  32079]
 [ 57677  55614  71705]]
Evaluating performance on  val set...
827/827 - 14s - 14s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9416932
{'0': {'precision': 0.2837083228415268, 'recall': 0.5617503006129572, 'f1-score': 0.3770101367975593, 'support': 34097}, '1': {'precision': 0.8083313442439212, 'recall': 0.5484284346307666, 'f1-score': 0.65348619658281, 'support': 142024}, '2': {'precision': 0.3753459699739998, 'recall': 0.5050644697119319, 'f1-score': 0.43064894448788116, 'support': 35443}, 'accuracy': 0.5433107712087123, 'macro avg': {'precision': 0.4891285456864826, 'recall': 0.5384144016518851, 'f1-score': 0.4870484259560835, 'support': 211564}, 'weighted avg': {'precision': 0.6512423698389833, 'recall': 0.5433107712087123, 'f1-score': 0.5715959650854936, 'support': 211564}}
[[19154  9589  5354]
 [39697 77890 24437]
 [ 8662  8880 17901]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9773015
{'0': {'precision': 0.3462056703107419, 'recall': 0.5450628758884637, 'f1-score': 0.42345005691761384, 'support': 45725}, '1': {'precision': 0.711714267012851, 'recall': 0.5472924793423095, 'f1-score': 0.6187669238539202, 'support': 119205}, '2': {'precision': 0.44530255275626707, 'recall': 0.4574773770210576, 'f1-score': 0.45130787049279164, 'support': 46634}, 'accuracy': 0.5270131024181808, 'macro avg': {'precision': 0.5010741633599534, 'recall': 0.5166109107506103, 'f1-score': 0.49784161708810853, 'support': 211564}, 'weighted avg': {'precision': 0.5739936507130766, 'recall': 0.5270131024181809, 'f1-score': 0.5396412255540891, 'support': 211564}}
[[24923 13576  7226]
 [34616 65240 19349]
 [12450 12850 21334]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0103078
{'0': {'precision': 0.375389823280113, 'recall': 0.5260042204336215, 'f1-score': 0.43811390308205594, 'support': 53549}, '1': {'precision': 0.6327172719761875, 'recall': 0.5373155846028161, 'f1-score': 0.5811270153116912, 'support': 104045}, '2': {'precision': 0.4756398812612874, 'recall': 0.42455067630164905, 'f1-score': 0.44864552636989313, 'support': 53970}, 'accuracy': 0.5056862226087614, 'macro avg': {'precision': 0.4945823255058626, 'recall': 0.49595682711269556, 'f1-score': 0.4892954815878801, 'support': 211564}, 'weighted avg': {'precision': 0.5275146178048292, 'recall': 0.5056862226087614, 'f1-score': 0.5111328995596087, 'support': 211564}}
[[28167 16593  8789]
 [31669 55905 16471]
 [15198 15859 22913]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0604854
{'0': {'precision': 0.4096612620055768, 'recall': 0.49483860907531574, 'f1-score': 0.44823933217509215, 'support': 64130}, '1': {'precision': 0.508602890571232, 'recall': 0.5221489048297666, 'f1-score': 0.5152868876676713, 'support': 83503}, '2': {'precision': 0.5004651355094785, 'recall': 0.3786738827798721, 'f1-score': 0.43113335232939165, 'support': 63931}, 'accuracy': 0.47051483239114406, 'macro avg': {'precision': 0.47290976269542906, 'recall': 0.4652204655616515, 'f1-score': 0.464886524057385, 'support': 211564}, 'weighted avg': {'precision': 0.4761522777128608, 'recall': 0.47051483239114406, 'f1-score': 0.46953345418441955, 'support': 211564}}
[[31734 21389 11007]
 [26745 43601 13157]
 [18985 20737 24209]]
training model: results/AAL/W0/deepOF_L2/seq2seq
Epoch 1/50
2262/2262 - 72s - loss: 11.1604 - accuracy10: 0.5650 - accuracy20: 0.5627 - accuracy30: 0.5498 - accuracy50: 0.5209 - val_loss: 11.8163 - val_accuracy10: 0.6827 - val_accuracy20: 0.6405 - val_accuracy30: 0.5970 - val_accuracy50: 0.5193 - 72s/epoch - 32ms/step
Epoch 2/50
2262/2262 - 68s - loss: 10.5291 - accuracy10: 0.6078 - accuracy20: 0.6003 - accuracy30: 0.5828 - accuracy50: 0.5465 - val_loss: 11.7612 - val_accuracy10: 0.6816 - val_accuracy20: 0.6450 - val_accuracy30: 0.6031 - val_accuracy50: 0.5239 - 68s/epoch - 30ms/step
Epoch 3/50
2262/2262 - 66s - loss: 10.3974 - accuracy10: 0.6133 - accuracy20: 0.6048 - accuracy30: 0.5869 - accuracy50: 0.5496 - val_loss: 11.7743 - val_accuracy10: 0.6787 - val_accuracy20: 0.6443 - val_accuracy30: 0.6033 - val_accuracy50: 0.5264 - 66s/epoch - 29ms/step
Epoch 4/50
2262/2262 - 67s - loss: 10.3241 - accuracy10: 0.6172 - accuracy20: 0.6085 - accuracy30: 0.5902 - accuracy50: 0.5522 - val_loss: 11.7496 - val_accuracy10: 0.6786 - val_accuracy20: 0.6445 - val_accuracy30: 0.6036 - val_accuracy50: 0.5258 - 67s/epoch - 30ms/step
Epoch 5/50
2262/2262 - 67s - loss: 10.2736 - accuracy10: 0.6200 - accuracy20: 0.6110 - accuracy30: 0.5921 - accuracy50: 0.5542 - val_loss: 11.7361 - val_accuracy10: 0.6832 - val_accuracy20: 0.6487 - val_accuracy30: 0.6059 - val_accuracy50: 0.5243 - 67s/epoch - 29ms/step
Epoch 6/50
2262/2262 - 68s - loss: 10.2328 - accuracy10: 0.6213 - accuracy20: 0.6126 - accuracy30: 0.5941 - accuracy50: 0.5561 - val_loss: 11.6722 - val_accuracy10: 0.6753 - val_accuracy20: 0.6453 - val_accuracy30: 0.6057 - val_accuracy50: 0.5277 - 68s/epoch - 30ms/step
Epoch 7/50
2262/2262 - 66s - loss: 10.1947 - accuracy10: 0.6226 - accuracy20: 0.6144 - accuracy30: 0.5956 - accuracy50: 0.5576 - val_loss: 11.7127 - val_accuracy10: 0.6789 - val_accuracy20: 0.6467 - val_accuracy30: 0.6067 - val_accuracy50: 0.5286 - 66s/epoch - 29ms/step
Epoch 8/50
2262/2262 - 66s - loss: 10.1635 - accuracy10: 0.6238 - accuracy20: 0.6153 - accuracy30: 0.5965 - accuracy50: 0.5591 - val_loss: 11.7039 - val_accuracy10: 0.6805 - val_accuracy20: 0.6478 - val_accuracy30: 0.6064 - val_accuracy50: 0.5271 - 66s/epoch - 29ms/step
Epoch 9/50
2262/2262 - 68s - loss: 10.1354 - accuracy10: 0.6243 - accuracy20: 0.6165 - accuracy30: 0.5977 - accuracy50: 0.5600 - val_loss: 11.7194 - val_accuracy10: 0.6778 - val_accuracy20: 0.6465 - val_accuracy30: 0.6063 - val_accuracy50: 0.5293 - 68s/epoch - 30ms/step
Epoch 10/50
2262/2262 - 68s - loss: 10.1116 - accuracy10: 0.6256 - accuracy20: 0.6176 - accuracy30: 0.5988 - accuracy50: 0.5610 - val_loss: 11.7741 - val_accuracy10: 0.6770 - val_accuracy20: 0.6467 - val_accuracy30: 0.6069 - val_accuracy50: 0.5301 - 68s/epoch - 30ms/step
Epoch 11/50
2262/2262 - 66s - loss: 10.0862 - accuracy10: 0.6260 - accuracy20: 0.6189 - accuracy30: 0.6001 - accuracy50: 0.5627 - val_loss: 11.7368 - val_accuracy10: 0.6718 - val_accuracy20: 0.6447 - val_accuracy30: 0.6070 - val_accuracy50: 0.5318 - 66s/epoch - 29ms/step
Epoch 12/50
2262/2262 - 67s - loss: 10.0657 - accuracy10: 0.6274 - accuracy20: 0.6200 - accuracy30: 0.6011 - accuracy50: 0.5633 - val_loss: 11.6811 - val_accuracy10: 0.6752 - val_accuracy20: 0.6469 - val_accuracy30: 0.6077 - val_accuracy50: 0.5310 - 67s/epoch - 29ms/step
Epoch 13/50
2262/2262 - 66s - loss: 10.0466 - accuracy10: 0.6282 - accuracy20: 0.6206 - accuracy30: 0.6019 - accuracy50: 0.5644 - val_loss: 11.7174 - val_accuracy10: 0.6727 - val_accuracy20: 0.6457 - val_accuracy30: 0.6061 - val_accuracy50: 0.5298 - 66s/epoch - 29ms/step
Epoch 14/50
2262/2262 - 66s - loss: 10.0266 - accuracy10: 0.6283 - accuracy20: 0.6215 - accuracy30: 0.6027 - accuracy50: 0.5651 - val_loss: 11.7531 - val_accuracy10: 0.6788 - val_accuracy20: 0.6490 - val_accuracy30: 0.6093 - val_accuracy50: 0.5313 - 66s/epoch - 29ms/step
Epoch 15/50
2262/2262 - 66s - loss: 10.0088 - accuracy10: 0.6290 - accuracy20: 0.6222 - accuracy30: 0.6035 - accuracy50: 0.5664 - val_loss: 11.6963 - val_accuracy10: 0.6775 - val_accuracy20: 0.6486 - val_accuracy30: 0.6094 - val_accuracy50: 0.5324 - 66s/epoch - 29ms/step
Epoch 16/50
2262/2262 - 65s - loss: 9.9919 - accuracy10: 0.6294 - accuracy20: 0.6231 - accuracy30: 0.6044 - accuracy50: 0.5673 - val_loss: 11.6468 - val_accuracy10: 0.6734 - val_accuracy20: 0.6461 - val_accuracy30: 0.6079 - val_accuracy50: 0.5323 - 65s/epoch - 29ms/step
Epoch 17/50
2262/2262 - 66s - loss: 9.9738 - accuracy10: 0.6296 - accuracy20: 0.6236 - accuracy30: 0.6049 - accuracy50: 0.5682 - val_loss: 11.7232 - val_accuracy10: 0.6727 - val_accuracy20: 0.6458 - val_accuracy30: 0.6075 - val_accuracy50: 0.5332 - 66s/epoch - 29ms/step
Epoch 18/50
2262/2262 - 66s - loss: 9.9560 - accuracy10: 0.6309 - accuracy20: 0.6244 - accuracy30: 0.6059 - accuracy50: 0.5690 - val_loss: 11.7422 - val_accuracy10: 0.6688 - val_accuracy20: 0.6432 - val_accuracy30: 0.6063 - val_accuracy50: 0.5334 - 66s/epoch - 29ms/step
Epoch 19/50
2262/2262 - 68s - loss: 9.9414 - accuracy10: 0.6311 - accuracy20: 0.6250 - accuracy30: 0.6062 - accuracy50: 0.5694 - val_loss: 11.7394 - val_accuracy10: 0.6738 - val_accuracy20: 0.6451 - val_accuracy30: 0.6068 - val_accuracy50: 0.5321 - 68s/epoch - 30ms/step
Epoch 20/50
2262/2262 - 66s - loss: 9.9254 - accuracy10: 0.6313 - accuracy20: 0.6260 - accuracy30: 0.6075 - accuracy50: 0.5711 - val_loss: 11.7072 - val_accuracy10: 0.6757 - val_accuracy20: 0.6467 - val_accuracy30: 0.6076 - val_accuracy50: 0.5328 - 66s/epoch - 29ms/step
Epoch 21/50
2262/2262 - 66s - loss: 9.9099 - accuracy10: 0.6322 - accuracy20: 0.6268 - accuracy30: 0.6079 - accuracy50: 0.5714 - val_loss: 11.6924 - val_accuracy10: 0.6732 - val_accuracy20: 0.6446 - val_accuracy30: 0.6076 - val_accuracy50: 0.5343 - 66s/epoch - 29ms/step
Epoch 22/50
2262/2262 - 67s - loss: 9.8920 - accuracy10: 0.6323 - accuracy20: 0.6269 - accuracy30: 0.6087 - accuracy50: 0.5721 - val_loss: 11.6857 - val_accuracy10: 0.6727 - val_accuracy20: 0.6442 - val_accuracy30: 0.6071 - val_accuracy50: 0.5349 - 67s/epoch - 29ms/step
Epoch 23/50
2262/2262 - 65s - loss: 9.8816 - accuracy10: 0.6329 - accuracy20: 0.6276 - accuracy30: 0.6090 - accuracy50: 0.5727 - val_loss: 11.7075 - val_accuracy10: 0.6729 - val_accuracy20: 0.6449 - val_accuracy30: 0.6077 - val_accuracy50: 0.5354 - 65s/epoch - 29ms/step
Epoch 24/50
2262/2262 - 67s - loss: 9.8643 - accuracy10: 0.6327 - accuracy20: 0.6284 - accuracy30: 0.6101 - accuracy50: 0.5736 - val_loss: 11.7694 - val_accuracy10: 0.6722 - val_accuracy20: 0.6440 - val_accuracy30: 0.6070 - val_accuracy50: 0.5349 - 67s/epoch - 30ms/step
Epoch 25/50
2262/2262 - 67s - loss: 9.8504 - accuracy10: 0.6329 - accuracy20: 0.6284 - accuracy30: 0.6102 - accuracy50: 0.5739 - val_loss: 11.7264 - val_accuracy10: 0.6628 - val_accuracy20: 0.6368 - val_accuracy30: 0.6025 - val_accuracy50: 0.5337 - 67s/epoch - 30ms/step
Epoch 26/50
2262/2262 - 67s - loss: 9.8363 - accuracy10: 0.6335 - accuracy20: 0.6293 - accuracy30: 0.6109 - accuracy50: 0.5751 - val_loss: 11.7929 - val_accuracy10: 0.6659 - val_accuracy20: 0.6403 - val_accuracy30: 0.6036 - val_accuracy50: 0.5344 - 67s/epoch - 30ms/step
testing model: results/AAL/W0/deepOF_L2/seq2seq
Evaluating performance on  test set...
6677/6677 - 65s - 65s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.60763687
{'0': {'precision': 0.35065725141266135, 'recall': 0.5273814201515576, 'f1-score': 0.42123456568718, 'support': 178150}, '1': {'precision': 0.9018706177172895, 'recall': 0.7945311175930139, 'f1-score': 0.8448049243337362, 'support': 1345284}, '2': {'precision': 0.39289241422922433, 'recall': 0.5415745209769326, 'f1-score': 0.4554051363726856, 'support': 185847}, 'accuracy': 0.739183902471273, 'macro avg': {'precision': 0.5484734277863917, 'recall': 0.621162352907168, 'f1-score': 0.5738148754645339, 'support': 1709281}, 'weighted avg': {'precision': 0.7890800739794163, 'recall': 0.739183902471273, 'f1-score': 0.7583195297227382, 'support': 1709281}}
[[  93953   59182   25015]
 [ 145902 1068870  130512]
 [  28079   57118  100650]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.64891917
{'0': {'precision': 0.4483082285013388, 'recall': 0.4880772566087052, 'f1-score': 0.46734823160213246, 'support': 245623}, '1': {'precision': 0.8352953209153114, 'recall': 0.8279282754255308, 'f1-score': 0.8315954824569572, 'support': 1213308}, '2': {'precision': 0.48923773938193277, 'recall': 0.46756940283602955, 'f1-score': 0.4781582150764279, 'support': 250350}, 'accuracy': 0.7263118235094171, 'macro avg': {'precision': 0.5909470962661943, 'recall': 0.5945249782900885, 'f1-score': 0.5923673097118392, 'support': 1709281}, 'weighted avg': {'precision': 0.7290000738863684, 'recall': 0.7263118235094171, 'f1-score': 0.7274870752463054, 'support': 1709281}}
[[ 119883   99634   26106]
 [ 112676 1004532   96100]
 [  34853   98441  117056]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.70316774
{'0': {'precision': 0.5106542056074767, 'recall': 0.4412174392861709, 'f1-score': 0.47340319919713225, 'support': 297214}, '1': {'precision': 0.7733288520366436, 'recall': 0.8520742901361041, 'f1-score': 0.8107940923013917, 'support': 1115249}, '2': {'precision': 0.5428175437027765, 'recall': 0.4090452735346239, 'f1-score': 0.4665314089854136, 'support': 296818}, 'accuracy': 0.7037011468564852, 'macro avg': {'precision': 0.6089335337822989, 'recall': 0.5674456676522996, 'f1-score': 0.5835762334946458, 'support': 1709281}, 'weighted avg': {'precision': 0.687625864709902, 'recall': 0.7037011468564852, 'f1-score': 0.6923462431533749, 'support': 1709281}}
[[131136 139099  26979]
 [ 89695 950275  75279]
 [ 35969 139437 121412]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.81176084
{'0': {'precision': 0.5751571867232051, 'recall': 0.3727003310996826, 'f1-score': 0.45230695520242753, 'support': 379946}, '1': {'precision': 0.6661057347428763, 'recall': 0.8761982712779822, 'f1-score': 0.7568426081909108, 'support': 959090}, '2': {'precision': 0.5894354942775181, 'recall': 0.3207686801982471, 'f1-score': 0.4154506227579054, 'support': 370245}, 'accuracy': 0.6439678437892892, 'macro avg': {'precision': 0.6102328052478665, 'recall': 0.523222427525304, 'f1-score': 0.5415333953837479, 'support': 1709281}, 'weighted avg': {'precision': 0.6292818829554998, 'recall': 0.6439678437892892, 'f1-score': 0.6152007255180177, 'support': 1709281}}
[[141606 208107  30233]
 [ 66247 840353  52490]
 [ 38351 213131 118763]]
Evaluating performance on  train set...
2262/2262 - 24s - 24s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8228545
{'0': {'precision': 0.4452789237513673, 'recall': 0.49669987606521465, 'f1-score': 0.4695859106061019, 'support': 104087}, '1': {'precision': 0.8198520822830725, 'recall': 0.7243644758283542, 'f1-score': 0.7691560108202262, 'support': 368200}, '2': {'precision': 0.42629977876106195, 'recall': 0.5497916353806878, 'f1-score': 0.4802338164884895, 'support': 106544}, 'accuracy': 0.6512920006012117, 'macro avg': {'precision': 0.5638102615985007, 'recall': 0.5902853290914188, 'f1-score': 0.5729919126382725, 'support': 578831}, 'weighted avg': {'precision': 0.6800550897610087, 'recall': 0.6512920006012117, 'f1-score': 0.6621052839347137, 'support': 578831}}
[[ 51700  29749  22638]
 [ 45296 266711  56193]
 [ 19111  28856  58577]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8629782
{'0': {'precision': 0.5285612250230824, 'recall': 0.44690425163680286, 'f1-score': 0.4843149539684503, 'support': 135783}, '1': {'precision': 0.7150908843249133, 'recall': 0.7739998230790148, 'f1-score': 0.7433801247982177, 'support': 305221}, '2': {'precision': 0.5071898847822834, 'recall': 0.4918557321860013, 'f1-score': 0.49940512805401366, 'support': 137827}, 'accuracy': 0.6300871929803346, 'macro avg': {'precision': 0.5836139980434264, 'recall': 0.5709199356339397, 'f1-score': 0.5757000689402273, 'support': 578831}, 'weighted avg': {'precision': 0.6218306273709103, 'recall': 0.6300871929803346, 'f1-score': 0.6245147081791326, 'support': 578831}}
[[ 60682  47752  27349]
 [ 30460 236241  38520]
 [ 23664  46372  67791]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.912558
{'0': {'precision': 0.5620971629559535, 'recall': 0.4022191843826656, 'f1-score': 0.4689047594224053, 'support': 156544}, '1': {'precision': 0.6276114772022103, 'recall': 0.8032509748007851, 'f1-score': 0.7046512823830544, 'support': 264413}, '2': {'precision': 0.5389749460682383, 'recall': 0.43836223824062226, 'f1-score': 0.4834897669040824, 'support': 157874}, 'accuracy': 0.5952704675457949, 'macro avg': {'precision': 0.5762278620754674, 'recall': 0.547944132474691, 'f1-score': 0.5523486029031807, 'support': 578831}, 'weighted avg': {'precision': 0.5857179426029737, 'recall': 0.5952704675457949, 'f1-score': 0.5805729991102526, 'support': 578831}}
[[ 62965  63799  29780]
 [ 22606 212390  29417]
 [ 26447  62221  69206]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.010999
{'0': {'precision': 0.5780593386532674, 'recall': 0.34641797188102513, 'f1-score': 0.4332180821342581, 'support': 184644}, '1': {'precision': 0.49594155844155846, 'recall': 0.8265834886944883, 'f1-score': 0.6199309486847625, 'support': 209190}, '2': {'precision': 0.5573534579407975, 'recall': 0.3600923258214998, 'f1-score': 0.4375162140950154, 'support': 184997}, 'accuracy': 0.5243205702528027, 'macro avg': {'precision': 0.5437847850118744, 'recall': 0.5110312621323377, 'f1-score': 0.49688841497134534, 'support': 578831}, 'weighted avg': {'precision': 0.5417642123441163, 'recall': 0.5243205702528027, 'f1-score': 0.5020699682150731, 'support': 578831}}
[[ 63964  87991  32689]
 [ 16060 172913  20217]
 [ 30629  87752  66616]]
Evaluating performance on  val set...
827/827 - 9s - 9s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.78652203
{'0': {'precision': 0.4256642740209042, 'recall': 0.49603780230100963, 'f1-score': 0.4581644686013256, 'support': 34072}, '1': {'precision': 0.82425242792983, 'recall': 0.7556145178658146, 'f1-score': 0.7884424730669527, 'support': 142087}, '2': {'precision': 0.4305355254302471, 'recall': 0.5059172433272137, 'f1-score': 0.4651923801114155, 'support': 35405}, 'accuracy': 0.6720235956968105, 'macro avg': {'precision': 0.5601507424603271, 'recall': 0.5858565211646792, 'f1-score': 0.5705997739265646, 'support': 211564}, 'weighted avg': {'precision': 0.6941724402524243, 'recall': 0.6720235956968105, 'f1-score': 0.6811562537231909, 'support': 211564}}
[[ 16901  11542   5629]
 [ 16661 107363  18063]
 [  6143  11350  17912]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8480179
{'0': {'precision': 0.5191054763162528, 'recall': 0.4510502502677537, 'f1-score': 0.482690868263473, 'support': 45751}, '1': {'precision': 0.7214314854267713, 'recall': 0.8009813789632612, 'f1-score': 0.759128091388233, 'support': 119220}, '2': {'precision': 0.519203954873875, 'recall': 0.43955100551585, 'f1-score': 0.47606871382412425, 'support': 46593}, 'accuracy': 0.6457100451872719, 'macro avg': {'precision': 0.5865803055389663, 'recall': 0.563860878248955, 'f1-score': 0.5726292244919434, 'support': 211564}, 'weighted avg': {'precision': 0.6331413955538892, 'recall': 0.6457100451872719, 'f1-score': 0.6370096545368527, 'support': 211564}}
[[20636 18488  6627]
 [11389 95493 12338]
 [ 7728 18385 20480]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.90684396
{'0': {'precision': 0.5603764803226974, 'recall': 0.4047965930740782, 'f1-score': 0.4700472823493688, 'support': 53538}, '1': {'precision': 0.635541457657126, 'recall': 0.8275524220273373, 'f1-score': 0.7189475397113495, 'support': 104107}, '2': {'precision': 0.5552906509509777, 'recall': 0.384447040931768, 'f1-score': 0.45433922563534934, 'support': 53919}, 'accuracy': 0.6076411865912915, 'macro avg': {'precision': 0.5837361963102671, 'recall': 0.5389320186777278, 'f1-score': 0.5477780158986892, 'support': 211564}, 'weighted avg': {'precision': 0.5960677012367546, 'recall': 0.6076411865912915, 'f1-score': 0.5885234710356316, 'support': 211564}}
[[21672 24661  7205]
 [ 8557 86154  9396]
 [ 8445 24745 20729]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0157877
{'0': {'precision': 0.5837453401369537, 'recall': 0.3439632341486213, 'f1-score': 0.4328663993804711, 'support': 64190}, '1': {'precision': 0.5071564817072296, 'recall': 0.8472698085631454, 'f1-score': 0.6345097968850929, 'support': 83474}, '2': {'precision': 0.5752034298713798, 'recall': 0.30863849765258217, 'f1-score': 0.40172324238442975, 'support': 63900}, 'accuracy': 0.531876878864079, 'macro avg': {'precision': 0.555368417238521, 'recall': 0.4999571801214496, 'f1-score': 0.48969981288333125, 'support': 211564}, 'weighted avg': {'precision': 0.5509467239520973, 'recall': 0.531876878864079, 'f1-score': 0.503019796136317, 'support': 211564}}
[[22079 34070  8041]
 [ 6225 70725  6524]
 [ 9519 34659 19722]]
training model: results/AAL/W0/deepVOL_L2/seq2seq
Epoch 1/50
2262/2262 - 74s - loss: 11.4772 - accuracy10: 0.5360 - accuracy20: 0.5391 - accuracy30: 0.5300 - accuracy50: 0.5070 - val_loss: 11.7376 - val_accuracy10: 0.6356 - val_accuracy20: 0.6132 - val_accuracy30: 0.5780 - val_accuracy50: 0.5022 - 74s/epoch - 33ms/step
Epoch 2/50
2262/2262 - 65s - loss: 11.1505 - accuracy10: 0.5646 - accuracy20: 0.5656 - accuracy30: 0.5549 - accuracy50: 0.5243 - val_loss: 11.2980 - val_accuracy10: 0.6205 - val_accuracy20: 0.6015 - val_accuracy30: 0.5768 - val_accuracy50: 0.5184 - 65s/epoch - 29ms/step
Epoch 3/50
2262/2262 - 66s - loss: 10.9343 - accuracy10: 0.5844 - accuracy20: 0.5793 - accuracy30: 0.5649 - accuracy50: 0.5322 - val_loss: 11.1728 - val_accuracy10: 0.6688 - val_accuracy20: 0.6344 - val_accuracy30: 0.5966 - val_accuracy50: 0.5225 - 66s/epoch - 29ms/step
Epoch 4/50
2262/2262 - 65s - loss: 10.7068 - accuracy10: 0.6025 - accuracy20: 0.5940 - accuracy30: 0.5766 - accuracy50: 0.5418 - val_loss: 11.1777 - val_accuracy10: 0.6740 - val_accuracy20: 0.6418 - val_accuracy30: 0.6026 - val_accuracy50: 0.5264 - 65s/epoch - 29ms/step
Epoch 5/50
2262/2262 - 65s - loss: 10.5935 - accuracy10: 0.6084 - accuracy20: 0.5996 - accuracy30: 0.5818 - accuracy50: 0.5453 - val_loss: 11.1597 - val_accuracy10: 0.6807 - val_accuracy20: 0.6440 - val_accuracy30: 0.6040 - val_accuracy50: 0.5273 - 65s/epoch - 29ms/step
Epoch 6/50
2262/2262 - 64s - loss: 10.5050 - accuracy10: 0.6110 - accuracy20: 0.6026 - accuracy30: 0.5846 - accuracy50: 0.5480 - val_loss: 11.0832 - val_accuracy10: 0.6889 - val_accuracy20: 0.6494 - val_accuracy30: 0.6073 - val_accuracy50: 0.5282 - 64s/epoch - 28ms/step
Epoch 7/50
2262/2262 - 65s - loss: 10.4211 - accuracy10: 0.6160 - accuracy20: 0.6067 - accuracy30: 0.5878 - accuracy50: 0.5502 - val_loss: 11.0568 - val_accuracy10: 0.6834 - val_accuracy20: 0.6478 - val_accuracy30: 0.6072 - val_accuracy50: 0.5309 - 65s/epoch - 29ms/step
Epoch 8/50
2262/2262 - 64s - loss: 10.3723 - accuracy10: 0.6174 - accuracy20: 0.6089 - accuracy30: 0.5897 - accuracy50: 0.5520 - val_loss: 11.0449 - val_accuracy10: 0.6834 - val_accuracy20: 0.6478 - val_accuracy30: 0.6068 - val_accuracy50: 0.5289 - 64s/epoch - 28ms/step
Epoch 9/50
2262/2262 - 64s - loss: 10.3315 - accuracy10: 0.6192 - accuracy20: 0.6107 - accuracy30: 0.5914 - accuracy50: 0.5534 - val_loss: 11.0637 - val_accuracy10: 0.6828 - val_accuracy20: 0.6483 - val_accuracy30: 0.6086 - val_accuracy50: 0.5307 - 64s/epoch - 28ms/step
Epoch 10/50
2262/2262 - 64s - loss: 10.2906 - accuracy10: 0.6209 - accuracy20: 0.6123 - accuracy30: 0.5931 - accuracy50: 0.5549 - val_loss: 11.0233 - val_accuracy10: 0.6814 - val_accuracy20: 0.6489 - val_accuracy30: 0.6092 - val_accuracy50: 0.5319 - 64s/epoch - 28ms/step
Epoch 11/50
2262/2262 - 64s - loss: 10.2621 - accuracy10: 0.6216 - accuracy20: 0.6134 - accuracy30: 0.5938 - accuracy50: 0.5554 - val_loss: 10.9865 - val_accuracy10: 0.6795 - val_accuracy20: 0.6490 - val_accuracy30: 0.6101 - val_accuracy50: 0.5333 - 64s/epoch - 28ms/step
Epoch 12/50
2262/2262 - 65s - loss: 10.2309 - accuracy10: 0.6233 - accuracy20: 0.6146 - accuracy30: 0.5946 - accuracy50: 0.5565 - val_loss: 11.0409 - val_accuracy10: 0.6810 - val_accuracy20: 0.6496 - val_accuracy30: 0.6099 - val_accuracy50: 0.5328 - 65s/epoch - 29ms/step
Epoch 13/50
2262/2262 - 65s - loss: 10.1997 - accuracy10: 0.6236 - accuracy20: 0.6158 - accuracy30: 0.5961 - accuracy50: 0.5580 - val_loss: 10.9586 - val_accuracy10: 0.6802 - val_accuracy20: 0.6498 - val_accuracy30: 0.6108 - val_accuracy50: 0.5333 - 65s/epoch - 29ms/step
Epoch 14/50
2262/2262 - 64s - loss: 10.1784 - accuracy10: 0.6250 - accuracy20: 0.6168 - accuracy30: 0.5967 - accuracy50: 0.5586 - val_loss: 11.0498 - val_accuracy10: 0.6819 - val_accuracy20: 0.6499 - val_accuracy30: 0.6095 - val_accuracy50: 0.5311 - 64s/epoch - 28ms/step
Epoch 15/50
2262/2262 - 65s - loss: 10.1574 - accuracy10: 0.6258 - accuracy20: 0.6179 - accuracy30: 0.5979 - accuracy50: 0.5598 - val_loss: 11.0692 - val_accuracy10: 0.6736 - val_accuracy20: 0.6472 - val_accuracy30: 0.6089 - val_accuracy50: 0.5327 - 65s/epoch - 29ms/step
Epoch 16/50
2262/2262 - 65s - loss: 10.1339 - accuracy10: 0.6266 - accuracy20: 0.6183 - accuracy30: 0.5989 - accuracy50: 0.5611 - val_loss: 11.0767 - val_accuracy10: 0.6729 - val_accuracy20: 0.6459 - val_accuracy30: 0.6088 - val_accuracy50: 0.5323 - 65s/epoch - 29ms/step
Epoch 17/50
2262/2262 - 65s - loss: 10.1265 - accuracy10: 0.6260 - accuracy20: 0.6183 - accuracy30: 0.5988 - accuracy50: 0.5608 - val_loss: 11.0738 - val_accuracy10: 0.6821 - val_accuracy20: 0.6515 - val_accuracy30: 0.6109 - val_accuracy50: 0.5317 - 65s/epoch - 29ms/step
Epoch 18/50
2262/2262 - 65s - loss: 10.1029 - accuracy10: 0.6279 - accuracy20: 0.6195 - accuracy30: 0.6000 - accuracy50: 0.5619 - val_loss: 11.0463 - val_accuracy10: 0.6767 - val_accuracy20: 0.6481 - val_accuracy30: 0.6103 - val_accuracy50: 0.5343 - 65s/epoch - 29ms/step
Epoch 19/50
2262/2262 - 64s - loss: 10.0877 - accuracy10: 0.6278 - accuracy20: 0.6199 - accuracy30: 0.6005 - accuracy50: 0.5630 - val_loss: 10.9880 - val_accuracy10: 0.6778 - val_accuracy20: 0.6507 - val_accuracy30: 0.6117 - val_accuracy50: 0.5335 - 64s/epoch - 28ms/step
Epoch 20/50
2262/2262 - 64s - loss: 10.0718 - accuracy10: 0.6284 - accuracy20: 0.6203 - accuracy30: 0.6010 - accuracy50: 0.5631 - val_loss: 11.0182 - val_accuracy10: 0.6740 - val_accuracy20: 0.6486 - val_accuracy30: 0.6110 - val_accuracy50: 0.5350 - 64s/epoch - 28ms/step
Epoch 21/50
2262/2262 - 64s - loss: 10.0608 - accuracy10: 0.6290 - accuracy20: 0.6211 - accuracy30: 0.6017 - accuracy50: 0.5641 - val_loss: 11.0600 - val_accuracy10: 0.6746 - val_accuracy20: 0.6480 - val_accuracy30: 0.6097 - val_accuracy50: 0.5334 - 64s/epoch - 28ms/step
Epoch 22/50
2262/2262 - 65s - loss: 10.0419 - accuracy10: 0.6295 - accuracy20: 0.6219 - accuracy30: 0.6027 - accuracy50: 0.5649 - val_loss: 10.9768 - val_accuracy10: 0.6777 - val_accuracy20: 0.6507 - val_accuracy30: 0.6121 - val_accuracy50: 0.5340 - 65s/epoch - 29ms/step
Epoch 23/50
2262/2262 - 65s - loss: 10.0248 - accuracy10: 0.6303 - accuracy20: 0.6226 - accuracy30: 0.6032 - accuracy50: 0.5661 - val_loss: 11.0558 - val_accuracy10: 0.6780 - val_accuracy20: 0.6501 - val_accuracy30: 0.6116 - val_accuracy50: 0.5334 - 65s/epoch - 29ms/step
testing model: results/AAL/W0/deepVOL_L2/seq2seq
Evaluating performance on  test set...
6677/6677 - 60s - 60s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5526004
{'0': {'precision': 0.42889494356179897, 'recall': 0.4762618438187615, 'f1-score': 0.4513390375526293, 'support': 178152}, '1': {'precision': 0.8944828902672656, 'recall': 0.8673196628820935, 'f1-score': 0.8806918771386701, 'support': 1345286}, '2': {'precision': 0.4424420121144204, 'recall': 0.49285975636003615, 'f1-score': 0.4662919918345322, 'support': 185848}, 'accuracy': 0.78584683897253, 'macro avg': {'precision': 0.588606615314495, 'recall': 0.6121470876869637, 'f1-score': 0.5994409688419439, 'support': 1709286}, 'weighted avg': {'precision': 0.7968068331273707, 'recall': 0.78584683897253, 'f1-score': 0.7908851057955855, 'support': 1709286}}
[[  84847   72980   20325]
 [  83389 1166793   95104]
 [  29591   64660   91597]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.61216736
{'0': {'precision': 0.5233604477649435, 'recall': 0.4240854961832061, 'f1-score': 0.46852187523894767, 'support': 245625}, '1': {'precision': 0.8241266714648282, 'recall': 0.8965613870827629, 'f1-score': 0.8588194100958487, 'support': 1213309}, '2': {'precision': 0.5453881441700866, 'recall': 0.4145722822266249, 'f1-score': 0.47106693444985304, 'support': 250352}, 'accuracy': 0.7580714988597578, 'macro avg': {'precision': 0.6309584211332862, 'recall': 0.5784063884975313, 'f1-score': 0.5994694065948831, 'support': 1709286}, 'weighted avg': {'precision': 0.7400807882822728, 'recall': 0.7580714988597578, 'f1-score': 0.7459410270855434, 'support': 1709286}}
[[ 104166  118683   22776]
 [  61765 1087806   63738]
 [  33102  113461  103789]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6780679
{'0': {'precision': 0.586350048063211, 'recall': 0.3735195951765719, 'f1-score': 0.4563395334497996, 'support': 297216}, '1': {'precision': 0.759801609560354, 'recall': 0.9157937682134051, 'f1-score': 0.8305365225325152, 'support': 1115250}, '2': {'precision': 0.5936016934685376, 'recall': 0.3514453203961997, 'f1-score': 0.4414987493492807, 'support': 296820}, 'accuracy': 0.7235015088171318, 'macro avg': {'precision': 0.6465844503640342, 'recall': 0.5469195612620589, 'f1-score': 0.5761249351105318, 'support': 1709286}, 'weighted avg': {'precision': 0.7007804519563559, 'recall': 0.7235015088171318, 'f1-score': 0.6979130036225984, 'support': 1709286}}
[[ 111016  162520   23680]
 [  46173 1021339   47738]
 [  32145  160359  104316]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.79644716
{'0': {'precision': 0.6493464820046184, 'recall': 0.2982566035352206, 'f1-score': 0.40876159901887404, 'support': 379948}, '1': {'precision': 0.6517551324675666, 'recall': 0.9334765246222982, 'f1-score': 0.7675825968268313, 'support': 959090}, '2': {'precision': 0.6280910174288693, 'recall': 0.27331140208724963, 'f1-score': 0.3808830171635049, 'support': 370248}, 'accuracy': 0.6492787046755195, 'macro avg': {'precision': 0.6430642106336847, 'recall': 0.5016815100815895, 'f1-score': 0.5190757376697367, 'support': 1709286}, 'weighted avg': {'precision': 0.6460938486385621, 'recall': 0.6492787046755195, 'f1-score': 0.6040593090643825, 'support': 1709286}}
[[113322 240302  26324]
 [ 30207 895288  33595]
 [ 30988 238067 101193]]
Evaluating performance on  train set...
2262/2262 - 21s - 21s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.80470216
{'0': {'precision': 0.4640563456799705, 'recall': 0.4603584008623179, 'f1-score': 0.46219997680980174, 'support': 103906}, '1': {'precision': 0.8055387602758043, 'recall': 0.7521836846591063, 'f1-score': 0.7779474640173154, 'support': 368414}, '2': {'precision': 0.43252392916511695, 'recall': 0.5349769511702797, 'f1-score': 0.4783258343966154, 'support': 106513}, 'accuracy': 0.6598293462881349, 'macro avg': {'precision': 0.5673730117069639, 'recall': 0.5825063455639014, 'f1-score': 0.5728244250745775, 'support': 578833}, 'weighted avg': {'precision': 0.6755997269499793, 'recall': 0.6598293462881349, 'f1-score': 0.6661334225898682, 'support': 578833}}
[[ 47834  34519  21553]
 [ 38091 277115  53208]
 [ 17153  32378  56982]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.85431755
{'0': {'precision': 0.5381200743993404, 'recall': 0.41376336159233323, 'f1-score': 0.46781856371274255, 'support': 135650}, '1': {'precision': 0.6950412002884871, 'recall': 0.8014701308056251, 'f1-score': 0.7444711578672043, 'support': 305415}, '2': {'precision': 0.511201562742646, 'recall': 0.45398786365484, 'f1-score': 0.4808989800743511, 'support': 137768}, 'accuracy': 0.6279064946193462, 'macro avg': {'precision': 0.5814542791434912, 'recall': 0.5564071186842662, 'f1-score': 0.564396233884766, 'support': 578833}, 'weighted avg': {'precision': 0.61451094387208, 'recall': 0.6279064946193462, 'f1-score': 0.6169045951673954, 'support': 578833}}
[[ 56127  54169  25354]
 [ 26184 244781  34450]
 [ 21991  53232  62545]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9073094
{'0': {'precision': 0.5696474084570798, 'recall': 0.36988734752298735, 'f1-score': 0.4485312918897559, 'support': 156499}, '1': {'precision': 0.6063808975358681, 'recall': 0.8324488306029119, 'f1-score': 0.7016550453216513, 'support': 264367}, '2': {'precision': 0.5435176354266015, 'recall': 0.39322769945621555, 'f1-score': 0.45631652794816613, 'support': 157967}, 'accuracy': 0.5875200619176861, 'macro avg': {'precision': 0.5731819804731831, 'recall': 0.531854625860705, 'f1-score': 0.5355009550531911, 'support': 578833}, 'weighted avg': {'precision': 0.5792935075063503, 'recall': 0.5875200619176861, 'f1-score': 0.5662636563333324, 'support': 578833}}
[[ 57887  71282  27330]
 [ 19455 220072  24840]
 [ 24277  71573  62117]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0046123
{'0': {'precision': 0.5874708155127172, 'recall': 0.30809323089925994, 'f1-score': 0.4042051092503874, 'support': 184574}, '1': {'precision': 0.4772287982620086, 'recall': 0.8565776080816963, 'f1-score': 0.6129577734501229, 'support': 209263}, '2': {'precision': 0.5610125059899088, 'recall': 0.3227529243875543, 'f1-score': 0.4097658059535043, 'support': 184996}, 'accuracy': 0.5110696867663039, 'macro avg': {'precision': 0.5419040399215449, 'recall': 0.4958079211228368, 'f1-score': 0.4756428962180049, 'support': 578833}, 'weighted avg': {'precision': 0.539159373897577, 'recall': 0.5110696867663039, 'f1-score': 0.48145176833119147, 'support': 578833}}
[[ 56866  97590  30118]
 [ 13410 179250  16603]
 [ 26522  98766  59708]]
Evaluating performance on  val set...
827/827 - 8s - 8s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7631398
{'0': {'precision': 0.44592704185946413, 'recall': 0.4861424758776432, 'f1-score': 0.46516718348791203, 'support': 34097}, '1': {'precision': 0.8255419487335514, 'recall': 0.7641947839801724, 'f1-score': 0.7936846877810847, 'support': 142024}, '2': {'precision': 0.4356041190997624, 'recall': 0.5275230652032842, 'f1-score': 0.4771773112996874, 'support': 35443}, 'accuracy': 0.6797328467981321, 'macro avg': {'precision': 0.5690243698975926, 'recall': 0.5926201083536999, 'f1-score': 0.5786763941895613, 'support': 211564}, 'weighted avg': {'precision': 0.6990350951318226, 'recall': 0.6797328467981321, 'f1-score': 0.6877147104290093, 'support': 211564}}
[[ 16576  11874   5647]
 [ 14912 108534  18578]
 [  5684  11062  18697]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8158772
{'0': {'precision': 0.5312216470085926, 'recall': 0.4353635866593767, 'f1-score': 0.478539405521701, 'support': 45725}, '1': {'precision': 0.7187237677821937, 'recall': 0.8116354179774339, 'f1-score': 0.7623591521550707, 'support': 119205}, '2': {'precision': 0.524179860671311, 'recall': 0.44371059741819274, 'f1-score': 0.48060016955254387, 'support': 46634}, 'accuracy': 0.6492125314325689, 'macro avg': {'precision': 0.5913750918206991, 'recall': 0.5635698673516678, 'f1-score': 0.5738329090764386, 'support': 211564}, 'weighted avg': {'precision': 0.6353168789136632, 'recall': 0.6492125314325689, 'f1-score': 0.6389108986266016, 'support': 211564}}
[[19907 19005  6813]
 [10484 96751 11970]
 [ 7083 18859 20692]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.87141955
{'0': {'precision': 0.5736901517028716, 'recall': 0.38912024500924386, 'f1-score': 0.46371425392233223, 'support': 53549}, '1': {'precision': 0.6319751610068148, 'recall': 0.8431640155701859, 'f1-score': 0.7224521224249462, 'support': 104045}, '2': {'precision': 0.5629306321886409, 'recall': 0.37997035390031497, 'f1-score': 0.45369970906757817, 'support': 53970}, 'accuracy': 0.6100801648673687, 'macro avg': {'precision': 0.5895319816327758, 'recall': 0.5374182048265815, 'f1-score': 0.5466220284716189, 'support': 211564}, 'weighted avg': {'precision': 0.599609365391617, 'recall': 0.6100801648673687, 'f1-score': 0.5884041659231612, 'support': 211564}}
[[20837 25262  7450]
 [ 7846 87727  8472]
 [ 7638 25825 20507]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.97515655
{'0': {'precision': 0.6036654545454545, 'recall': 0.32357710899734915, 'f1-score': 0.42131871478605143, 'support': 64130}, '1': {'precision': 0.5047737014975227, 'recall': 0.8686873525502078, 'f1-score': 0.6385190597120686, 'support': 83503}, '2': {'precision': 0.5822308496341646, 'recall': 0.3049537782922213, 'f1-score': 0.40026279050669294, 'support': 63931}, 'accuracy': 0.533101094704203, 'macro avg': {'precision': 0.5635566685590473, 'recall': 0.4990727466132594, 'f1-score': 0.4867001883349376, 'support': 211564}, 'weighted avg': {'precision': 0.5581563235905418, 'recall': 0.533101094704203, 'f1-score': 0.5006836072405974, 'support': 211564}}
[[20751 35026  8353]
 [ 5329 72538  5636]
 [ 8295 36140 19496]]
training model: results/AAL/W0/deepVOL_L3/seq2seq
Epoch 1/50
2262/2262 - 100s - loss: 11.7954 - accuracy10: 0.5082 - accuracy20: 0.5104 - accuracy30: 0.5053 - accuracy50: 0.4880 - val_loss: 11.4055 - val_accuracy10: 0.6584 - val_accuracy20: 0.6233 - val_accuracy30: 0.5821 - val_accuracy50: 0.5051 - 100s/epoch - 44ms/step
Epoch 2/50
2262/2262 - 95s - loss: 11.1186 - accuracy10: 0.5626 - accuracy20: 0.5651 - accuracy30: 0.5557 - accuracy50: 0.5269 - val_loss: 11.3718 - val_accuracy10: 0.6440 - val_accuracy20: 0.6087 - val_accuracy30: 0.5726 - val_accuracy50: 0.5054 - 95s/epoch - 42ms/step
Epoch 3/50
2262/2262 - 95s - loss: 10.9219 - accuracy10: 0.5872 - accuracy20: 0.5804 - accuracy30: 0.5647 - accuracy50: 0.5321 - val_loss: 10.9796 - val_accuracy10: 0.6441 - val_accuracy20: 0.6246 - val_accuracy30: 0.5941 - val_accuracy50: 0.5276 - 95s/epoch - 42ms/step
Epoch 4/50
2262/2262 - 97s - loss: 10.7387 - accuracy10: 0.5949 - accuracy20: 0.5881 - accuracy30: 0.5720 - accuracy50: 0.5382 - val_loss: 10.8956 - val_accuracy10: 0.6584 - val_accuracy20: 0.6346 - val_accuracy30: 0.6004 - val_accuracy50: 0.5294 - 97s/epoch - 43ms/step
Epoch 5/50
2262/2262 - 96s - loss: 10.5962 - accuracy10: 0.6029 - accuracy20: 0.5960 - accuracy30: 0.5787 - accuracy50: 0.5436 - val_loss: 10.8134 - val_accuracy10: 0.6692 - val_accuracy20: 0.6393 - val_accuracy30: 0.6030 - val_accuracy50: 0.5297 - 96s/epoch - 42ms/step
Epoch 6/50
2262/2262 - 95s - loss: 10.4860 - accuracy10: 0.6069 - accuracy20: 0.6004 - accuracy30: 0.5828 - accuracy50: 0.5466 - val_loss: 10.6235 - val_accuracy10: 0.6634 - val_accuracy20: 0.6364 - val_accuracy30: 0.6029 - val_accuracy50: 0.5358 - 95s/epoch - 42ms/step
Epoch 7/50
2262/2262 - 95s - loss: 10.3950 - accuracy10: 0.6108 - accuracy20: 0.6042 - accuracy30: 0.5867 - accuracy50: 0.5494 - val_loss: 10.6290 - val_accuracy10: 0.6697 - val_accuracy20: 0.6417 - val_accuracy30: 0.6068 - val_accuracy50: 0.5380 - 95s/epoch - 42ms/step
Epoch 8/50
2262/2262 - 97s - loss: 10.3518 - accuracy10: 0.6129 - accuracy20: 0.6063 - accuracy30: 0.5884 - accuracy50: 0.5513 - val_loss: 10.5403 - val_accuracy10: 0.6688 - val_accuracy20: 0.6418 - val_accuracy30: 0.6072 - val_accuracy50: 0.5388 - 97s/epoch - 43ms/step
Epoch 9/50
2262/2262 - 96s - loss: 10.2895 - accuracy10: 0.6168 - accuracy20: 0.6096 - accuracy30: 0.5911 - accuracy50: 0.5539 - val_loss: 10.5026 - val_accuracy10: 0.6700 - val_accuracy20: 0.6441 - val_accuracy30: 0.6095 - val_accuracy50: 0.5411 - 96s/epoch - 42ms/step
Epoch 10/50
2262/2262 - 96s - loss: 10.2468 - accuracy10: 0.6188 - accuracy20: 0.6119 - accuracy30: 0.5933 - accuracy50: 0.5551 - val_loss: 10.3639 - val_accuracy10: 0.6492 - val_accuracy20: 0.6350 - val_accuracy30: 0.6084 - val_accuracy50: 0.5467 - 96s/epoch - 42ms/step
Epoch 11/50
2262/2262 - 96s - loss: 10.2097 - accuracy10: 0.6208 - accuracy20: 0.6134 - accuracy30: 0.5955 - accuracy50: 0.5572 - val_loss: 10.4624 - val_accuracy10: 0.6629 - val_accuracy20: 0.6420 - val_accuracy30: 0.6102 - val_accuracy50: 0.5439 - 96s/epoch - 43ms/step
Epoch 12/50
2262/2262 - 95s - loss: 10.1826 - accuracy10: 0.6213 - accuracy20: 0.6141 - accuracy30: 0.5958 - accuracy50: 0.5574 - val_loss: 10.4008 - val_accuracy10: 0.6595 - val_accuracy20: 0.6432 - val_accuracy30: 0.6128 - val_accuracy50: 0.5456 - 95s/epoch - 42ms/step
Epoch 13/50
2262/2262 - 93s - loss: 10.1529 - accuracy10: 0.6227 - accuracy20: 0.6157 - accuracy30: 0.5972 - accuracy50: 0.5590 - val_loss: 10.3303 - val_accuracy10: 0.6586 - val_accuracy20: 0.6432 - val_accuracy30: 0.6134 - val_accuracy50: 0.5469 - 93s/epoch - 41ms/step
Epoch 14/50
2262/2262 - 95s - loss: 10.1284 - accuracy10: 0.6239 - accuracy20: 0.6167 - accuracy30: 0.5981 - accuracy50: 0.5597 - val_loss: 10.3702 - val_accuracy10: 0.6577 - val_accuracy20: 0.6432 - val_accuracy30: 0.6135 - val_accuracy50: 0.5475 - 95s/epoch - 42ms/step
Epoch 15/50
2262/2262 - 94s - loss: 10.1044 - accuracy10: 0.6244 - accuracy20: 0.6180 - accuracy30: 0.5999 - accuracy50: 0.5609 - val_loss: 10.3774 - val_accuracy10: 0.6589 - val_accuracy20: 0.6454 - val_accuracy30: 0.6160 - val_accuracy50: 0.5492 - 94s/epoch - 41ms/step
Epoch 16/50
2262/2262 - 94s - loss: 10.0859 - accuracy10: 0.6249 - accuracy20: 0.6189 - accuracy30: 0.6004 - accuracy50: 0.5613 - val_loss: 10.3586 - val_accuracy10: 0.6675 - val_accuracy20: 0.6497 - val_accuracy30: 0.6168 - val_accuracy50: 0.5462 - 94s/epoch - 42ms/step
Epoch 17/50
2262/2262 - 94s - loss: 10.0701 - accuracy10: 0.6262 - accuracy20: 0.6200 - accuracy30: 0.6008 - accuracy50: 0.5623 - val_loss: 10.3974 - val_accuracy10: 0.6621 - val_accuracy20: 0.6457 - val_accuracy30: 0.6136 - val_accuracy50: 0.5435 - 94s/epoch - 42ms/step
Epoch 18/50
2262/2262 - 94s - loss: 10.0520 - accuracy10: 0.6270 - accuracy20: 0.6206 - accuracy30: 0.6022 - accuracy50: 0.5632 - val_loss: 10.2987 - val_accuracy10: 0.6545 - val_accuracy20: 0.6440 - val_accuracy30: 0.6152 - val_accuracy50: 0.5488 - 94s/epoch - 42ms/step
Epoch 19/50
2262/2262 - 96s - loss: 10.0372 - accuracy10: 0.6272 - accuracy20: 0.6212 - accuracy30: 0.6029 - accuracy50: 0.5644 - val_loss: 10.2897 - val_accuracy10: 0.6438 - val_accuracy20: 0.6386 - val_accuracy30: 0.6139 - val_accuracy50: 0.5500 - 96s/epoch - 42ms/step
Epoch 20/50
2262/2262 - 95s - loss: 10.0154 - accuracy10: 0.6280 - accuracy20: 0.6217 - accuracy30: 0.6037 - accuracy50: 0.5652 - val_loss: 10.2853 - val_accuracy10: 0.6431 - val_accuracy20: 0.6394 - val_accuracy30: 0.6148 - val_accuracy50: 0.5517 - 95s/epoch - 42ms/step
Epoch 21/50
2262/2262 - 94s - loss: 10.0069 - accuracy10: 0.6281 - accuracy20: 0.6223 - accuracy30: 0.6041 - accuracy50: 0.5659 - val_loss: 10.2778 - val_accuracy10: 0.6411 - val_accuracy20: 0.6380 - val_accuracy30: 0.6147 - val_accuracy50: 0.5516 - 94s/epoch - 42ms/step
Epoch 22/50
2262/2262 - 94s - loss: 9.9916 - accuracy10: 0.6296 - accuracy20: 0.6233 - accuracy30: 0.6046 - accuracy50: 0.5661 - val_loss: 10.3444 - val_accuracy10: 0.6534 - val_accuracy20: 0.6430 - val_accuracy30: 0.6155 - val_accuracy50: 0.5498 - 94s/epoch - 41ms/step
Epoch 23/50
2262/2262 - 96s - loss: 9.9783 - accuracy10: 0.6294 - accuracy20: 0.6234 - accuracy30: 0.6052 - accuracy50: 0.5671 - val_loss: 10.2961 - val_accuracy10: 0.6424 - val_accuracy20: 0.6380 - val_accuracy30: 0.6144 - val_accuracy50: 0.5521 - 96s/epoch - 42ms/step
Epoch 24/50
2262/2262 - 95s - loss: 9.9686 - accuracy10: 0.6300 - accuracy20: 0.6237 - accuracy30: 0.6057 - accuracy50: 0.5675 - val_loss: 10.3597 - val_accuracy10: 0.6495 - val_accuracy20: 0.6415 - val_accuracy30: 0.6153 - val_accuracy50: 0.5495 - 95s/epoch - 42ms/step
Epoch 25/50
2262/2262 - 94s - loss: 9.9517 - accuracy10: 0.6310 - accuracy20: 0.6247 - accuracy30: 0.6059 - accuracy50: 0.5675 - val_loss: 10.2919 - val_accuracy10: 0.6408 - val_accuracy20: 0.6371 - val_accuracy30: 0.6144 - val_accuracy50: 0.5536 - 94s/epoch - 42ms/step
Epoch 26/50
2262/2262 - 94s - loss: 9.9370 - accuracy10: 0.6315 - accuracy20: 0.6254 - accuracy30: 0.6069 - accuracy50: 0.5688 - val_loss: 10.3064 - val_accuracy10: 0.6339 - val_accuracy20: 0.6334 - val_accuracy30: 0.6126 - val_accuracy50: 0.5538 - 94s/epoch - 42ms/step
Epoch 27/50
2262/2262 - 95s - loss: 9.9264 - accuracy10: 0.6313 - accuracy20: 0.6257 - accuracy30: 0.6074 - accuracy50: 0.5695 - val_loss: 10.3361 - val_accuracy10: 0.6487 - val_accuracy20: 0.6410 - val_accuracy30: 0.6160 - val_accuracy50: 0.5529 - 95s/epoch - 42ms/step
Epoch 28/50
2262/2262 - 95s - loss: 9.9140 - accuracy10: 0.6322 - accuracy20: 0.6261 - accuracy30: 0.6081 - accuracy50: 0.5700 - val_loss: 10.3126 - val_accuracy10: 0.6421 - val_accuracy20: 0.6373 - val_accuracy30: 0.6138 - val_accuracy50: 0.5523 - 95s/epoch - 42ms/step
Epoch 29/50
2262/2262 - 96s - loss: 9.9037 - accuracy10: 0.6323 - accuracy20: 0.6268 - accuracy30: 0.6090 - accuracy50: 0.5709 - val_loss: 10.3473 - val_accuracy10: 0.6448 - val_accuracy20: 0.6379 - val_accuracy30: 0.6141 - val_accuracy50: 0.5533 - 96s/epoch - 43ms/step
Epoch 30/50
2262/2262 - 95s - loss: 9.8854 - accuracy10: 0.6328 - accuracy20: 0.6268 - accuracy30: 0.6091 - accuracy50: 0.5712 - val_loss: 10.3363 - val_accuracy10: 0.6444 - val_accuracy20: 0.6378 - val_accuracy30: 0.6143 - val_accuracy50: 0.5528 - 95s/epoch - 42ms/step
Epoch 31/50
2262/2262 - 95s - loss: 9.8784 - accuracy10: 0.6330 - accuracy20: 0.6271 - accuracy30: 0.6094 - accuracy50: 0.5718 - val_loss: 10.2751 - val_accuracy10: 0.6279 - val_accuracy20: 0.6270 - val_accuracy30: 0.6086 - val_accuracy50: 0.5536 - 95s/epoch - 42ms/step
Epoch 32/50
2262/2262 - 94s - loss: 9.8712 - accuracy10: 0.6331 - accuracy20: 0.6275 - accuracy30: 0.6097 - accuracy50: 0.5719 - val_loss: 10.2870 - val_accuracy10: 0.6341 - val_accuracy20: 0.6328 - val_accuracy30: 0.6113 - val_accuracy50: 0.5551 - 94s/epoch - 41ms/step
Epoch 33/50
2262/2262 - 95s - loss: 9.8521 - accuracy10: 0.6341 - accuracy20: 0.6281 - accuracy30: 0.6107 - accuracy50: 0.5734 - val_loss: 10.3011 - val_accuracy10: 0.6336 - val_accuracy20: 0.6310 - val_accuracy30: 0.6095 - val_accuracy50: 0.5540 - 95s/epoch - 42ms/step
Epoch 34/50
2262/2262 - 95s - loss: 9.8434 - accuracy10: 0.6335 - accuracy20: 0.6281 - accuracy30: 0.6111 - accuracy50: 0.5735 - val_loss: 10.3676 - val_accuracy10: 0.6434 - val_accuracy20: 0.6348 - val_accuracy30: 0.6111 - val_accuracy50: 0.5525 - 95s/epoch - 42ms/step
Epoch 35/50
2262/2262 - 96s - loss: 9.8292 - accuracy10: 0.6339 - accuracy20: 0.6287 - accuracy30: 0.6115 - accuracy50: 0.5748 - val_loss: 10.4131 - val_accuracy10: 0.6445 - val_accuracy20: 0.6353 - val_accuracy30: 0.6106 - val_accuracy50: 0.5515 - 96s/epoch - 43ms/step
Epoch 36/50
2262/2262 - 95s - loss: 9.8224 - accuracy10: 0.6346 - accuracy20: 0.6294 - accuracy30: 0.6121 - accuracy50: 0.5747 - val_loss: 10.3505 - val_accuracy10: 0.6328 - val_accuracy20: 0.6292 - val_accuracy30: 0.6085 - val_accuracy50: 0.5521 - 95s/epoch - 42ms/step
Epoch 37/50
2262/2262 - 97s - loss: 9.8107 - accuracy10: 0.6346 - accuracy20: 0.6293 - accuracy30: 0.6122 - accuracy50: 0.5751 - val_loss: 10.3659 - val_accuracy10: 0.6345 - val_accuracy20: 0.6305 - val_accuracy30: 0.6086 - val_accuracy50: 0.5536 - 97s/epoch - 43ms/step
Epoch 38/50
2262/2262 - 96s - loss: 9.8048 - accuracy10: 0.6350 - accuracy20: 0.6299 - accuracy30: 0.6129 - accuracy50: 0.5755 - val_loss: 10.4005 - val_accuracy10: 0.6459 - val_accuracy20: 0.6350 - val_accuracy30: 0.6115 - val_accuracy50: 0.5522 - 96s/epoch - 42ms/step
Epoch 39/50
2262/2262 - 94s - loss: 9.7916 - accuracy10: 0.6360 - accuracy20: 0.6306 - accuracy30: 0.6135 - accuracy50: 0.5767 - val_loss: 10.4156 - val_accuracy10: 0.6412 - val_accuracy20: 0.6313 - val_accuracy30: 0.6089 - val_accuracy50: 0.5524 - 94s/epoch - 42ms/step
Epoch 40/50
2262/2262 - 94s - loss: 9.7793 - accuracy10: 0.6354 - accuracy20: 0.6309 - accuracy30: 0.6141 - accuracy50: 0.5769 - val_loss: 10.3664 - val_accuracy10: 0.6303 - val_accuracy20: 0.6264 - val_accuracy30: 0.6070 - val_accuracy50: 0.5530 - 94s/epoch - 42ms/step
Epoch 41/50
2262/2262 - 94s - loss: 9.7654 - accuracy10: 0.6359 - accuracy20: 0.6316 - accuracy30: 0.6146 - accuracy50: 0.5777 - val_loss: 10.3379 - val_accuracy10: 0.6238 - val_accuracy20: 0.6225 - val_accuracy30: 0.6041 - val_accuracy50: 0.5531 - 94s/epoch - 42ms/step
testing model: results/AAL/W0/deepVOL_L3/seq2seq
Evaluating performance on  test set...
6677/6677 - 111s - 111s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.56865454
{'0': {'precision': 0.36880943351421086, 'recall': 0.5840911132066999, 'f1-score': 0.45213178505089124, 'support': 178152}, '1': {'precision': 0.9126464636997639, 'recall': 0.8106960155684367, 'f1-score': 0.8586556191178022, 'support': 1345286}, '2': {'precision': 0.4209109275987886, 'recall': 0.525746846885627, 'f1-score': 0.46752395420888315, 'support': 185848}, 'accuracy': 0.7560958201260644, 'macro avg': {'precision': 0.5674556082709211, 'recall': 0.6401779918869213, 'f1-score': 0.5927704527925256, 'support': 1709286}, 'weighted avg': {'precision': 0.8024988813086891, 'recall': 0.7560958201260644, 'f1-score': 0.7737581404356618, 'support': 1709286}}
[[ 104057   54192   19903]
 [ 140143 1090618  114525]
 [  37943   50196   97709]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6138152
{'0': {'precision': 0.45892478757255134, 'recall': 0.5272875318066158, 'f1-score': 0.49073675874651174, 'support': 245625}, '1': {'precision': 0.8493507574496421, 'recall': 0.8410141192392045, 'f1-score': 0.8451618807897764, 'support': 1213309}, '2': {'precision': 0.511729412598816, 'recall': 0.4612825142199783, 'f1-score': 0.48519822529956474, 'support': 250352}, 'accuracy': 0.7403137918405697, 'macro avg': {'precision': 0.6066683192070031, 'recall': 0.6098613884219329, 'f1-score': 0.6070322882786177, 'support': 1709286}, 'weighted avg': {'precision': 0.7437964161766459, 'recall': 0.7403137918405697, 'f1-score': 0.7415084888581966, 'support': 1709286}}
[[ 129515   92075   24035]
 [ 106745 1020410   86154]
 [  45954   88915  115483]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.667534
{'0': {'precision': 0.5170679016912537, 'recall': 0.47029769595176574, 'f1-score': 0.4925750773502858, 'support': 297216}, '1': {'precision': 0.7886578048102549, 'recall': 0.8650096390943735, 'f1-score': 0.8250710934927539, 'support': 1115250}, '2': {'precision': 0.5584237996792346, 'recall': 0.4058722458055387, 'f1-score': 0.4700812012002638, 'support': 296820}, 'accuracy': 0.7166460147687397, 'macro avg': {'precision': 0.6213831687269145, 'recall': 0.5803931936172259, 'f1-score': 0.5959091240144344, 'support': 1709286}, 'weighted avg': {'precision': 0.7014524324802842, 'recall': 0.7166460147687397, 'f1-score': 0.7056111343261448, 'support': 1709286}}
[[139780 130805  26631]
 [ 81916 964702  68632]
 [ 48636 127713 120471]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.77662224
{'0': {'precision': 0.5738192808706346, 'recall': 0.3917562403276238, 'f1-score': 0.4656234114601663, 'support': 379948}, '1': {'precision': 0.6821961299943478, 'recall': 0.887187855154365, 'f1-score': 0.7713040620927993, 'support': 959090}, '2': {'precision': 0.595812520976881, 'recall': 0.3260355221365139, 'f1-score': 0.4214491701172379, 'support': 370248}, 'accuracy': 0.6555099614692919, 'macro avg': {'precision': 0.6172759772806211, 'recall': 0.5349932058728343, 'f1-score': 0.5527922145567344, 'support': 1709286}, 'weighted avg': {'precision': 0.6393940912820694, 'recall': 0.6555099614692919, 'f1-score': 0.6275739748571142, 'support': 1709286}}
[[148847 199940  31161]
 [ 57468 850893  50729]
 [ 53082 196452 120714]]
Evaluating performance on  train set...
2262/2262 - 37s - 37s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8330491
{'0': {'precision': 0.3916463249254136, 'recall': 0.653167285816026, 'f1-score': 0.48967694222478764, 'support': 103906}, '1': {'precision': 0.8675117275615258, 'recall': 0.6033592643059167, 'f1-score': 0.7117160384728679, 'support': 368414}, '2': {'precision': 0.4197977362534325, 'recall': 0.5884727685822387, 'f1-score': 0.4900263072514981, 'support': 106513}, 'accuracy': 0.6095609614517487, 'macro avg': {'precision': 0.559651929580124, 'recall': 0.6149997729013937, 'f1-score': 0.5638064293163846, 'support': 578833}, 'weighted avg': {'precision': 0.6997040336627557, 'recall': 0.6095609614517487, 'f1-score': 0.6310640495981237, 'support': 578833}}
[[ 67868  17008  19030]
 [ 78528 222286  67600]
 [ 26893  16940  62680]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.83435994
{'0': {'precision': 0.4698125344605771, 'recall': 0.6030224843346849, 'f1-score': 0.5281474164035613, 'support': 135650}, '1': {'precision': 0.7730222235874122, 'recall': 0.6591981402354173, 'f1-score': 0.7115871621729086, 'support': 305415}, '2': {'precision': 0.4989707299153711, 'recall': 0.5225451483653679, 'f1-score': 0.510485915368115, 'support': 137768}, 'accuracy': 0.6135085594636104, 'macro avg': {'precision': 0.5806018293211201, 'recall': 0.5949219243118233, 'f1-score': 0.5834068313148616, 'support': 578833}, 'weighted avg': {'precision': 0.6367378021562482, 'recall': 0.6135085594636104, 'f1-score': 0.6207338105440022, 'support': 578833}}
[[ 81800  29212  24638]
 [ 56437 201329  47649]
 [ 35875  29903  71990]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.86149997
{'0': {'precision': 0.505770785001192, 'recall': 0.5558246378571109, 'f1-score': 0.5296177006021566, 'support': 156499}, '1': {'precision': 0.6875483690064492, 'recall': 0.6956314517318727, 'f1-score': 0.6915662922446892, 'support': 264367}, '2': {'precision': 0.5318107784259279, 'recall': 0.46920559357334124, 'f1-score': 0.49855047118094564, 'support': 157967}, 'accuracy': 0.5960389265988636, 'macro avg': {'precision': 0.5750433108111896, 'recall': 0.5735538943874415, 'f1-score': 0.5732448213425972, 'support': 578833}, 'weighted avg': {'precision': 0.5958994649348569, 'recall': 0.5960389265988636, 'f1-score': 0.5951050973068728, 'support': 578833}}
[[ 86986  41332  28181]
 [ 43394 183902  37071]
 [ 41607  42241  74119]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.93165267
{'0': {'precision': 0.5288447486716041, 'recall': 0.49015570990497037, 'f1-score': 0.5087657636125911, 'support': 184574}, '1': {'precision': 0.5508997000999667, 'recall': 0.7268317858388726, 'f1-score': 0.6267536133345696, 'support': 209263}, '2': {'precision': 0.5548568390673654, 'recall': 0.3949166468464183, 'f1-score': 0.4614199187787764, 'support': 184996}, 'accuracy': 0.5452816269977696, 'macro avg': {'precision': 0.5448670959463121, 'recall': 0.5373013808634204, 'f1-score': 0.5323130985753123, 'support': 578833}, 'weighted avg': {'precision': 0.5451316880403128, 'recall': 0.5452816269977696, 'f1-score': 0.5362895908399503, 'support': 578833}}
[[ 90470  61588  32516]
 [ 31068 152099  26096]
 [ 49533  62405  73058]]
Evaluating performance on  val set...
827/827 - 13s - 13s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7994803
{'0': {'precision': 0.3771261807318379, 'recall': 0.6404962313400006, 'f1-score': 0.4747299089189836, 'support': 34097}, '1': {'precision': 0.8715004763875388, 'recall': 0.6376035036331887, 'f1-score': 0.7364260707271552, 'support': 142024}, '2': {'precision': 0.4129010211465788, 'recall': 0.5795502638038541, 'f1-score': 0.4822340388069163, 'support': 35443}, 'accuracy': 0.6283441417254353, 'macro avg': {'precision': 0.5538425594219851, 'recall': 0.6192166662590145, 'f1-score': 0.5644633394843517, 'support': 211564}, 'weighted avg': {'precision': 0.7149954904207496, 'recall': 0.6283441417254353, 'f1-score': 0.6516650423077537, 'support': 211564}}
[[21839  6748  5510]
 [27772 90555 23697]
 [ 8298  6604 20541]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.813195
{'0': {'precision': 0.4627765562731895, 'recall': 0.5891962821213778, 'f1-score': 0.5183902406172732, 'support': 45725}, '1': {'precision': 0.7784580046888199, 'recall': 0.688024831173189, 'f1-score': 0.7304530597340599, 'support': 119205}, '2': {'precision': 0.49896855660436334, 'recall': 0.5134880130376979, 'f1-score': 0.5061241743725231, 'support': 46634}, 'accuracy': 0.6281928872587018, 'macro avg': {'precision': 0.5800677058554575, 'recall': 0.596903042110755, 'f1-score': 0.5849891582412854, 'support': 211564}, 'weighted avg': {'precision': 0.6486237930517964, 'recall': 0.6281928872587018, 'f1-score': 0.6351725505544974, 'support': 211564}}
[[26941 11525  7259]
 [20403 82016 16786]
 [10872 11816 23946]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.84716696
{'0': {'precision': 0.5053582685438117, 'recall': 0.5389456385740163, 'f1-score': 0.5216118275391525, 'support': 53549}, '1': {'precision': 0.6952649588458337, 'recall': 0.7225623528281032, 'f1-score': 0.7086508778131261, 'support': 104045}, '2': {'precision': 0.5353365280835816, 'recall': 0.45951454511765794, 'f1-score': 0.49453617292813273, 'support': 53970}, 'accuracy': 0.6089835699835511, 'macro avg': {'precision': 0.5786532518244091, 'recall': 0.5736741788399258, 'f1-score': 0.5749329594268038, 'support': 211564}, 'weighted avg': {'precision': 0.6063998836571356, 'recall': 0.6089835699835511, 'f1-score': 0.6066887069061471, 'support': 211564}}
[[28860 16249  8440]
 [15780 75179 13086]
 [12468 16702 24800]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.926937
{'0': {'precision': 0.5355746677091477, 'recall': 0.4699828473413379, 'f1-score': 0.5006395030148, 'support': 64130}, '1': {'precision': 0.5623434118481667, 'recall': 0.749937128007377, 'f1-score': 0.6427317794131231, 'support': 83503}, '2': {'precision': 0.5582644722165312, 'recall': 0.3836010699034897, 'f1-score': 0.454737622844428, 'support': 63931}, 'accuracy': 0.5543759807906827, 'macro avg': {'precision': 0.5520608505912818, 'recall': 0.5345070150840682, 'f1-score': 0.532702968424117, 'support': 211564}, 'weighted avg': {'precision': 0.5529965936218835, 'recall': 0.5543759807906827, 'f1-score': 0.5428516858763318, 'support': 211564}}
[[30140 24054  9936]
 [11412 62622  9469]
 [14724 24683 24524]]
training model: results/AAL/W1/deepLOB_L1/seq2seq
Epoch 1/50
2257/2257 - 62s - loss: 11.0988 - accuracy10: 0.4846 - accuracy20: 0.5058 - accuracy30: 0.5143 - accuracy50: 0.5184 - val_loss: 12.8450 - val_accuracy10: 0.6952 - val_accuracy20: 0.6501 - val_accuracy30: 0.6133 - val_accuracy50: 0.5514 - 62s/epoch - 27ms/step
Epoch 2/50
2257/2257 - 56s - loss: 10.8629 - accuracy10: 0.5020 - accuracy20: 0.5219 - accuracy30: 0.5323 - accuracy50: 0.5354 - val_loss: 12.0087 - val_accuracy10: 0.6845 - val_accuracy20: 0.6500 - val_accuracy30: 0.6222 - val_accuracy50: 0.5683 - 56s/epoch - 25ms/step
Epoch 3/50
2257/2257 - 52s - loss: 10.4624 - accuracy10: 0.5532 - accuracy20: 0.5571 - accuracy30: 0.5542 - accuracy50: 0.5478 - val_loss: 11.2688 - val_accuracy10: 0.6855 - val_accuracy20: 0.6572 - val_accuracy30: 0.6310 - val_accuracy50: 0.5839 - 52s/epoch - 23ms/step
Epoch 4/50
2257/2257 - 58s - loss: 10.1756 - accuracy10: 0.5830 - accuracy20: 0.5802 - accuracy30: 0.5710 - accuracy50: 0.5583 - val_loss: 11.4722 - val_accuracy10: 0.6914 - val_accuracy20: 0.6657 - val_accuracy30: 0.6391 - val_accuracy50: 0.5885 - 58s/epoch - 26ms/step
Epoch 5/50
2257/2257 - 56s - loss: 9.9975 - accuracy10: 0.5996 - accuracy20: 0.5940 - accuracy30: 0.5825 - accuracy50: 0.5668 - val_loss: 11.4977 - val_accuracy10: 0.7078 - val_accuracy20: 0.6773 - val_accuracy30: 0.6485 - val_accuracy50: 0.5939 - 56s/epoch - 25ms/step
Epoch 6/50
2257/2257 - 55s - loss: 9.8474 - accuracy10: 0.6136 - accuracy20: 0.6053 - accuracy30: 0.5903 - accuracy50: 0.5722 - val_loss: 11.2414 - val_accuracy10: 0.7093 - val_accuracy20: 0.6795 - val_accuracy30: 0.6503 - val_accuracy50: 0.5978 - 55s/epoch - 24ms/step
Epoch 7/50
2257/2257 - 55s - loss: 9.7429 - accuracy10: 0.6222 - accuracy20: 0.6124 - accuracy30: 0.5968 - accuracy50: 0.5770 - val_loss: 11.3148 - val_accuracy10: 0.7156 - val_accuracy20: 0.6847 - val_accuracy30: 0.6543 - val_accuracy50: 0.5998 - 55s/epoch - 24ms/step
Epoch 8/50
2257/2257 - 53s - loss: 9.6536 - accuracy10: 0.6289 - accuracy20: 0.6186 - accuracy30: 0.6018 - accuracy50: 0.5818 - val_loss: 11.2894 - val_accuracy10: 0.7163 - val_accuracy20: 0.6852 - val_accuracy30: 0.6548 - val_accuracy50: 0.5995 - 53s/epoch - 23ms/step
Epoch 9/50
2257/2257 - 56s - loss: 9.5958 - accuracy10: 0.6322 - accuracy20: 0.6220 - accuracy30: 0.6044 - accuracy50: 0.5834 - val_loss: 11.2312 - val_accuracy10: 0.7218 - val_accuracy20: 0.6904 - val_accuracy30: 0.6606 - val_accuracy50: 0.6051 - 56s/epoch - 25ms/step
Epoch 10/50
2257/2257 - 55s - loss: 9.5431 - accuracy10: 0.6358 - accuracy20: 0.6250 - accuracy30: 0.6075 - accuracy50: 0.5855 - val_loss: 11.2615 - val_accuracy10: 0.7290 - val_accuracy20: 0.6952 - val_accuracy30: 0.6625 - val_accuracy50: 0.6055 - 55s/epoch - 24ms/step
Epoch 11/50
2257/2257 - 57s - loss: 9.4957 - accuracy10: 0.6376 - accuracy20: 0.6273 - accuracy30: 0.6096 - accuracy50: 0.5880 - val_loss: 11.2966 - val_accuracy10: 0.7150 - val_accuracy20: 0.6846 - val_accuracy30: 0.6545 - val_accuracy50: 0.6013 - 57s/epoch - 25ms/step
Epoch 12/50
2257/2257 - 56s - loss: 9.4579 - accuracy10: 0.6391 - accuracy20: 0.6291 - accuracy30: 0.6113 - accuracy50: 0.5893 - val_loss: 11.0572 - val_accuracy10: 0.7093 - val_accuracy20: 0.6816 - val_accuracy30: 0.6526 - val_accuracy50: 0.6008 - 56s/epoch - 25ms/step
Epoch 13/50
2257/2257 - 54s - loss: 9.4171 - accuracy10: 0.6418 - accuracy20: 0.6314 - accuracy30: 0.6136 - accuracy50: 0.5914 - val_loss: 11.1403 - val_accuracy10: 0.7149 - val_accuracy20: 0.6868 - val_accuracy30: 0.6562 - val_accuracy50: 0.6029 - 54s/epoch - 24ms/step
Epoch 14/50
2257/2257 - 54s - loss: 9.3814 - accuracy10: 0.6447 - accuracy20: 0.6333 - accuracy30: 0.6152 - accuracy50: 0.5924 - val_loss: 10.9691 - val_accuracy10: 0.6991 - val_accuracy20: 0.6746 - val_accuracy30: 0.6469 - val_accuracy50: 0.5977 - 54s/epoch - 24ms/step
Epoch 15/50
2257/2257 - 57s - loss: 9.3531 - accuracy10: 0.6449 - accuracy20: 0.6346 - accuracy30: 0.6165 - accuracy50: 0.5935 - val_loss: 11.1335 - val_accuracy10: 0.7119 - val_accuracy20: 0.6824 - val_accuracy30: 0.6505 - val_accuracy50: 0.5976 - 57s/epoch - 25ms/step
Epoch 16/50
2257/2257 - 56s - loss: 9.3245 - accuracy10: 0.6479 - accuracy20: 0.6368 - accuracy30: 0.6179 - accuracy50: 0.5947 - val_loss: 11.2196 - val_accuracy10: 0.7066 - val_accuracy20: 0.6792 - val_accuracy30: 0.6490 - val_accuracy50: 0.5966 - 56s/epoch - 25ms/step
Epoch 17/50
2257/2257 - 54s - loss: 9.2969 - accuracy10: 0.6489 - accuracy20: 0.6377 - accuracy30: 0.6189 - accuracy50: 0.5956 - val_loss: 11.2624 - val_accuracy10: 0.6906 - val_accuracy20: 0.6657 - val_accuracy30: 0.6379 - val_accuracy50: 0.5917 - 54s/epoch - 24ms/step
Epoch 18/50
2257/2257 - 52s - loss: 9.2777 - accuracy10: 0.6501 - accuracy20: 0.6387 - accuracy30: 0.6195 - accuracy50: 0.5959 - val_loss: 11.4220 - val_accuracy10: 0.6957 - val_accuracy20: 0.6692 - val_accuracy30: 0.6416 - val_accuracy50: 0.5910 - 52s/epoch - 23ms/step
Epoch 19/50
2257/2257 - 56s - loss: 9.2486 - accuracy10: 0.6508 - accuracy20: 0.6403 - accuracy30: 0.6213 - accuracy50: 0.5976 - val_loss: 11.3357 - val_accuracy10: 0.6938 - val_accuracy20: 0.6709 - val_accuracy30: 0.6451 - val_accuracy50: 0.5955 - 56s/epoch - 25ms/step
Epoch 20/50
2257/2257 - 53s - loss: 9.2281 - accuracy10: 0.6524 - accuracy20: 0.6416 - accuracy30: 0.6222 - accuracy50: 0.5975 - val_loss: 11.5833 - val_accuracy10: 0.6730 - val_accuracy20: 0.6560 - val_accuracy30: 0.6334 - val_accuracy50: 0.5875 - 53s/epoch - 24ms/step
Epoch 21/50
2257/2257 - 51s - loss: 9.2129 - accuracy10: 0.6524 - accuracy20: 0.6420 - accuracy30: 0.6227 - accuracy50: 0.5977 - val_loss: 11.6797 - val_accuracy10: 0.6670 - val_accuracy20: 0.6465 - val_accuracy30: 0.6237 - val_accuracy50: 0.5799 - 51s/epoch - 23ms/step
Epoch 22/50
2257/2257 - 56s - loss: 9.1836 - accuracy10: 0.6541 - accuracy20: 0.6436 - accuracy30: 0.6241 - accuracy50: 0.5989 - val_loss: 11.6693 - val_accuracy10: 0.6565 - val_accuracy20: 0.6380 - val_accuracy30: 0.6163 - val_accuracy50: 0.5752 - 56s/epoch - 25ms/step
Epoch 23/50
2257/2257 - 54s - loss: 9.1702 - accuracy10: 0.6549 - accuracy20: 0.6439 - accuracy30: 0.6248 - accuracy50: 0.6000 - val_loss: 11.8515 - val_accuracy10: 0.6747 - val_accuracy20: 0.6477 - val_accuracy30: 0.6251 - val_accuracy50: 0.5828 - 54s/epoch - 24ms/step
Epoch 24/50
2257/2257 - 52s - loss: 9.1549 - accuracy10: 0.6549 - accuracy20: 0.6443 - accuracy30: 0.6248 - accuracy50: 0.6003 - val_loss: 11.6364 - val_accuracy10: 0.6583 - val_accuracy20: 0.6311 - val_accuracy30: 0.6058 - val_accuracy50: 0.5648 - 52s/epoch - 23ms/step
testing model: results/AAL/W1/deepLOB_L1/seq2seq
Evaluating performance on  test set...
7177/7177 - 58s - 58s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.75834525
{'0': {'precision': 0.32077625044382857, 'recall': 0.6703945878486794, 'f1-score': 0.43392451411987976, 'support': 207533}, '1': {'precision': 0.9075771607854997, 'recall': 0.6410662503258518, 'f1-score': 0.7513893555761997, 'support': 1423193}, '2': {'precision': 0.3169367884810546, 'recall': 0.6113983611403206, 'f1-score': 0.4174669743818812, 'support': 206363}, 'accuracy': 0.6410467865193249, 'macro avg': {'precision': 0.5150967332367943, 'recall': 0.640953066438284, 'f1-score': 0.5342602813593201, 'support': 1837089}, 'weighted avg': {'precision': 0.7749396715425724, 'recall': 0.6410467865193249, 'f1-score': 0.678015852554649, 'support': 1837089}}
[[139129  45055  23349]
 [262259 912361 248573]
 [ 32338  47855 126170]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7879674
{'0': {'precision': 0.39085354645974096, 'recall': 0.6217480598445058, 'f1-score': 0.4799763948264422, 'support': 283869}, '1': {'precision': 0.8416898347220548, 'recall': 0.6474890236121981, 'f1-score': 0.7319267611388173, 'support': 1272732}, '2': {'precision': 0.3904730740463725, 'recall': 0.5658245629046519, 'f1-score': 0.46207215810497637, 'support': 280488}, 'accuracy': 0.6310429162658967, 'macro avg': {'precision': 0.5410054850760561, 'recall': 0.6116872154537852, 'f1-score': 0.5579917713567454, 'support': 1837089}, 'weighted avg': {'precision': 0.7031340363469432, 'recall': 0.6310429162658967, 'f1-score': 0.651793530560177, 'support': 1837089}}
[[176495  75459  31915]
 [232826 824080 215826]
 [ 42242  79539 158707]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.83667916
{'0': {'precision': 0.4253075384156983, 'recall': 0.5842086645364424, 'f1-score': 0.4922523250414757, 'support': 342061}, '1': {'precision': 0.7805905395728908, 'recall': 0.6400403392572983, 'f1-score': 0.7033627682099537, 'support': 1158177}, '2': {'precision': 0.42876847809688473, 'recall': 0.5315376828330627, 'f1-score': 0.47465404803562905, 'support': 336851}, 'accuracy': 0.6097494459985335, 'macro avg': {'precision': 0.5448888520284912, 'recall': 0.5852622288756012, 'f1-score': 0.5567563804290194, 'support': 1837089}, 'weighted avg': {'precision': 0.6499272609352829, 'recall': 0.6097494459985335, 'f1-score': 0.6221182501707655, 'support': 1837089}}
[[199835 102071  40155]
 [218512 741280 198385]
 [ 51513 106289 179049]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.91378766
{'0': {'precision': 0.46874502942579926, 'recall': 0.5142988357941629, 'f1-score': 0.4904664612581599, 'support': 435490}, '1': {'precision': 0.6650759015608827, 'recall': 0.6399623770561585, 'f1-score': 0.6522775030579282, 'support': 974937}, '2': {'precision': 0.47226192794084826, 'recall': 0.46616525493247585, 'f1-score': 0.46919378733121336, 'support': 426662}, 'accuracy': 0.5698090838277297, 'macro avg': {'precision': 0.5353609529758434, 'recall': 0.5401421559275991, 'f1-score': 0.5373125838824339, 'support': 1837089}, 'weighted avg': {'precision': 0.5737539639090984, 'recall': 0.5698090838277297, 'f1-score': 0.571398484723611, 'support': 1837089}}
[[223972 155262  56256]
 [185011 623923 166003]
 [ 68829 158938 198895]]
Evaluating performance on  train set...
2257/2257 - 19s - 19s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7717411
{'0': {'precision': 0.30719121215991824, 'recall': 0.5714794903020762, 'f1-score': 0.39958878077653975, 'support': 67334}, '1': {'precision': 0.8741451322826447, 'recall': 0.6670918050623825, 'f1-score': 0.7567104577514829, 'support': 442993}, '2': {'precision': 0.3049883147916357, 'recall': 0.5181418034737093, 'f1-score': 0.38396650045455805, 'support': 67248}, 'accuracy': 0.6386027788598884, 'macro avg': {'precision': 0.4954415530780662, 'recall': 0.5855710329460561, 'f1-score': 0.5134219129941936, 'support': 577575}, 'weighted avg': {'precision': 0.7417814861411409, 'recall': 0.6386027788598884, 'f1-score': 0.671677835775576, 'support': 577575}}
[[ 38480  21301   7553]
 [ 75626 295517  71850]
 [ 11158  21246  34844]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8097489
{'0': {'precision': 0.37142749387139357, 'recall': 0.539969734850977, 'f1-score': 0.44011458244886464, 'support': 91194}, '1': {'precision': 0.8074559344458196, 'recall': 0.6684610201315859, 'f1-score': 0.7314135337722999, 'support': 396243}, '2': {'precision': 0.3778448438007626, 'recall': 0.49030375646231333, 'f1-score': 0.42679040482076636, 'support': 90138}, 'accuracy': 0.6203696489633381, 'macro avg': {'precision': 0.5189094240393253, 'recall': 0.5662448371482921, 'f1-score': 0.5327728403473103, 'support': 577575}, 'weighted avg': {'precision': 0.671564557398149, 'recall': 0.6203696489633381, 'f1-score': 0.6378796443823114, 'support': 577575}}
[[ 49242  31503  10449]
 [ 69048 264873  62322]
 [ 14285  31658  44195]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8530009
{'0': {'precision': 0.40249656829100894, 'recall': 0.5196658512945954, 'f1-score': 0.45363748806439785, 'support': 108335}, '1': {'precision': 0.7521686542059607, 'recall': 0.6583707600307684, 'f1-score': 0.7021510261148772, 'support': 362709}, '2': {'precision': 0.41571220627989186, 'recall': 0.4691498249335874, 'f1-score': 0.44081744253735294, 'support': 106531}, 'accuracy': 0.5974531446132537, 'macro avg': {'precision': 0.5234591429256205, 'recall': 0.5490621454196504, 'f1-score': 0.5322019855722093, 'support': 577575}, 'weighted avg': {'precision': 0.6245232968383317, 'recall': 0.5974531446132537, 'f1-score': 0.6073359074951379, 'support': 577575}}
[[ 56298  39195  12842]
 [ 66508 238797  57404]
 [ 17066  39486  49979]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9137506
{'0': {'precision': 0.4450355719680374, 'recall': 0.4749404404070091, 'f1-score': 0.45950196027745466, 'support': 134739}, '1': {'precision': 0.6544592103241665, 'recall': 0.6571514886614902, 'f1-score': 0.655802586339611, 'support': 311152}, '2': {'precision': 0.46065925010300784, 'recall': 0.4245086722760548, 'f1-score': 0.44184575985835894, 'support': 131684}, 'accuracy': 0.5616032549885296, 'macro avg': {'precision': 0.5200513441317373, 'recall': 0.5188668671148514, 'f1-score': 0.5190501021584749, 'support': 577575}, 'weighted avg': {'precision': 0.561418677804183, 'recall': 0.5616032549885296, 'f1-score': 0.5612277851564814, 'support': 577575}}
[[ 63993  53772  16974]
 [ 58203 204474  48475]
 [ 21597  54186  55901]]
Evaluating performance on  val set...
638/638 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.70134157
{'0': {'precision': 0.36169168473148183, 'recall': 0.49780454852510697, 'f1-score': 0.41897045933717103, 'support': 17764}, '1': {'precision': 0.8710888044854405, 'recall': 0.7559645267618899, 'f1-score': 0.809453781512605, 'support': 127420}, '2': {'precision': 0.3190218735644369, 'recall': 0.49757495590828926, 'f1-score': 0.38877764140990034, 'support': 18144}, 'accuracy': 0.6991820141065831, 'macro avg': {'precision': 0.5172674542604531, 'recall': 0.5837813437317619, 'f1-score': 0.5390672940865588, 'support': 163328}, 'weighted avg': {'precision': 0.7543566285576142, 'recall': 0.6991820141065831, 'f1-score': 0.7202511119082023, 'support': 163328}}
[[ 8843  6910  2011]
 [13835 96325 17260]
 [ 1771  7345  9028]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7515025
{'0': {'precision': 0.4341689163131508, 'recall': 0.46415172129457843, 'f1-score': 0.4486599581548271, 'support': 24255}, '1': {'precision': 0.807392978147878, 'recall': 0.7623829698205973, 'f1-score': 0.7842426905435519, 'support': 114714}, '2': {'precision': 0.3897314213005949, 'recall': 0.46524898394843794, 'f1-score': 0.4241550956248362, 'support': 24359}, 'accuracy': 0.6737791438087775, 'macro avg': {'precision': 0.5437644385872079, 'recall': 0.5639278916878713, 'f1-score': 0.5523525814410717, 'support': 163328}, 'weighted avg': {'precision': 0.6896766803725776, 'recall': 0.6737791438087775, 'f1-score': 0.6807029857855588, 'support': 163328}}
[[11258 10285  2712]
 [12224 87456 15034]
 [ 2448 10578 11333]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.80324847
{'0': {'precision': 0.46269415009435333, 'recall': 0.4411154165513424, 'f1-score': 0.4516471838469713, 'support': 28904}, '1': {'precision': 0.7551763839867122, 'recall': 0.7584618446868809, 'f1-score': 0.756815548672357, 'support': 105503}, '2': {'precision': 0.42774236833277424, 'recall': 0.4408907022578749, 'f1-score': 0.4342170233777733, 'support': 28921}, 'accuracy': 0.6460680348746082, 'macro avg': {'precision': 0.5485376341379467, 'recall': 0.5468226544986995, 'f1-score': 0.5475599186323672, 'support': 163328}, 'weighted avg': {'precision': 0.6454363170346141, 'recall': 0.6460680348746082, 'f1-score': 0.6456866646662001, 'support': 163328}}
[[12750 12833  3321]
 [11745 80020 13738]
 [ 3061 13109 12751]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8804081
{'0': {'precision': 0.49291189751128844, 'recall': 0.390559130241846, 'f1-score': 0.43580657640232107, 'support': 36056}, '1': {'precision': 0.661883467930321, 'recall': 0.7590840996817968, 'f1-score': 0.7071593015911823, 'support': 91451}, '2': {'precision': 0.4703126045920075, 'recall': 0.3922838558387538, 'f1-score': 0.4277690680223443, 'support': 35821}, 'accuracy': 0.5972827684169278, 'macro avg': {'precision': 0.5417026566778723, 'recall': 0.5139756952541322, 'f1-score': 0.5235783153386159, 'support': 163328}, 'weighted avg': {'precision': 0.5825663952993553, 'recall': 0.5972827684169278, 'f1-score': 0.585980254421812, 'support': 163328}}
[[14082 17781  4193]
 [10399 69419 11633]
 [ 4088 17681 14052]]
training model: results/AAL/W1/deepOF_L1/seq2seq
Epoch 1/50
2257/2257 - 55s - loss: 12.2878 - accuracy10: 0.4181 - accuracy20: 0.4351 - accuracy30: 0.4429 - accuracy50: 0.4507 - val_loss: 13.6586 - val_accuracy10: 0.7197 - val_accuracy20: 0.6664 - val_accuracy30: 0.6227 - val_accuracy50: 0.5506 - 55s/epoch - 25ms/step
Epoch 2/50
2257/2257 - 49s - loss: 12.3234 - accuracy10: 0.3630 - accuracy20: 0.3875 - accuracy30: 0.4043 - accuracy50: 0.4240 - val_loss: 12.6134 - val_accuracy10: 0.7045 - val_accuracy20: 0.6604 - val_accuracy30: 0.6252 - val_accuracy50: 0.5596 - 49s/epoch - 22ms/step
Epoch 3/50
2257/2257 - 53s - loss: 12.2152 - accuracy10: 0.3912 - accuracy20: 0.4088 - accuracy30: 0.4227 - accuracy50: 0.4387 - val_loss: 12.5924 - val_accuracy10: 0.7267 - val_accuracy20: 0.6775 - val_accuracy30: 0.6381 - val_accuracy50: 0.5678 - 53s/epoch - 23ms/step
Epoch 4/50
2257/2257 - 47s - loss: 12.0832 - accuracy10: 0.4249 - accuracy20: 0.4339 - accuracy30: 0.4434 - accuracy50: 0.4556 - val_loss: 12.3411 - val_accuracy10: 0.7342 - val_accuracy20: 0.6866 - val_accuracy30: 0.6477 - val_accuracy50: 0.5769 - 47s/epoch - 21ms/step
Epoch 5/50
2257/2257 - 49s - loss: 11.9535 - accuracy10: 0.4576 - accuracy20: 0.4606 - accuracy30: 0.4655 - accuracy50: 0.4711 - val_loss: 12.1477 - val_accuracy10: 0.7264 - val_accuracy20: 0.6830 - val_accuracy30: 0.6469 - val_accuracy50: 0.5801 - 49s/epoch - 22ms/step
Epoch 6/50
2257/2257 - 52s - loss: 11.8432 - accuracy10: 0.4735 - accuracy20: 0.4749 - accuracy30: 0.4759 - accuracy50: 0.4788 - val_loss: 11.9859 - val_accuracy10: 0.7122 - val_accuracy20: 0.6732 - val_accuracy30: 0.6415 - val_accuracy50: 0.5800 - 52s/epoch - 23ms/step
Epoch 7/50
2257/2257 - 50s - loss: 11.7341 - accuracy10: 0.4840 - accuracy20: 0.4851 - accuracy30: 0.4855 - accuracy50: 0.4869 - val_loss: 11.9215 - val_accuracy10: 0.7182 - val_accuracy20: 0.6765 - val_accuracy30: 0.6433 - val_accuracy50: 0.5823 - 50s/epoch - 22ms/step
Epoch 8/50
2257/2257 - 52s - loss: 11.6294 - accuracy10: 0.4943 - accuracy20: 0.4947 - accuracy30: 0.4940 - accuracy50: 0.4936 - val_loss: 11.8593 - val_accuracy10: 0.7130 - val_accuracy20: 0.6730 - val_accuracy30: 0.6424 - val_accuracy50: 0.5837 - 52s/epoch - 23ms/step
Epoch 9/50
2257/2257 - 48s - loss: 11.5421 - accuracy10: 0.5047 - accuracy20: 0.5024 - accuracy30: 0.4995 - accuracy50: 0.4980 - val_loss: 11.8177 - val_accuracy10: 0.7138 - val_accuracy20: 0.6722 - val_accuracy30: 0.6409 - val_accuracy50: 0.5835 - 48s/epoch - 21ms/step
Epoch 10/50
2257/2257 - 47s - loss: 11.4700 - accuracy10: 0.5087 - accuracy20: 0.5052 - accuracy30: 0.5017 - accuracy50: 0.5002 - val_loss: 11.7688 - val_accuracy10: 0.7154 - val_accuracy20: 0.6737 - val_accuracy30: 0.6410 - val_accuracy50: 0.5837 - 47s/epoch - 21ms/step
Epoch 11/50
2257/2257 - 53s - loss: 11.4179 - accuracy10: 0.5132 - accuracy20: 0.5074 - accuracy30: 0.5035 - accuracy50: 0.5021 - val_loss: 11.7183 - val_accuracy10: 0.7175 - val_accuracy20: 0.6749 - val_accuracy30: 0.6437 - val_accuracy50: 0.5872 - 53s/epoch - 24ms/step
Epoch 12/50
2257/2257 - 51s - loss: 11.3640 - accuracy10: 0.5169 - accuracy20: 0.5100 - accuracy30: 0.5062 - accuracy50: 0.5048 - val_loss: 11.7264 - val_accuracy10: 0.7224 - val_accuracy20: 0.6791 - val_accuracy30: 0.6465 - val_accuracy50: 0.5890 - 51s/epoch - 22ms/step
Epoch 13/50
2257/2257 - 51s - loss: 11.3189 - accuracy10: 0.5193 - accuracy20: 0.5123 - accuracy30: 0.5084 - accuracy50: 0.5065 - val_loss: 11.7131 - val_accuracy10: 0.7163 - val_accuracy20: 0.6733 - val_accuracy30: 0.6423 - val_accuracy50: 0.5873 - 51s/epoch - 22ms/step
Epoch 14/50
2257/2257 - 52s - loss: 11.2688 - accuracy10: 0.5224 - accuracy20: 0.5147 - accuracy30: 0.5107 - accuracy50: 0.5086 - val_loss: 11.7215 - val_accuracy10: 0.7208 - val_accuracy20: 0.6763 - val_accuracy30: 0.6441 - val_accuracy50: 0.5882 - 52s/epoch - 23ms/step
Epoch 15/50
2257/2257 - 53s - loss: 11.2249 - accuracy10: 0.5233 - accuracy20: 0.5154 - accuracy30: 0.5114 - accuracy50: 0.5095 - val_loss: 11.6946 - val_accuracy10: 0.7238 - val_accuracy20: 0.6776 - val_accuracy30: 0.6440 - val_accuracy50: 0.5878 - 53s/epoch - 23ms/step
Epoch 16/50
2257/2257 - 48s - loss: 11.1850 - accuracy10: 0.5263 - accuracy20: 0.5181 - accuracy30: 0.5137 - accuracy50: 0.5117 - val_loss: 11.6595 - val_accuracy10: 0.7214 - val_accuracy20: 0.6770 - val_accuracy30: 0.6446 - val_accuracy50: 0.5891 - 48s/epoch - 21ms/step
Epoch 17/50
2257/2257 - 53s - loss: 11.1417 - accuracy10: 0.5295 - accuracy20: 0.5216 - accuracy30: 0.5169 - accuracy50: 0.5146 - val_loss: 11.6236 - val_accuracy10: 0.7131 - val_accuracy20: 0.6703 - val_accuracy30: 0.6389 - val_accuracy50: 0.5866 - 53s/epoch - 23ms/step
Epoch 18/50
2257/2257 - 50s - loss: 11.0999 - accuracy10: 0.5323 - accuracy20: 0.5248 - accuracy30: 0.5198 - accuracy50: 0.5168 - val_loss: 11.5700 - val_accuracy10: 0.7140 - val_accuracy20: 0.6703 - val_accuracy30: 0.6393 - val_accuracy50: 0.5871 - 50s/epoch - 22ms/step
Epoch 19/50
2257/2257 - 54s - loss: 11.0748 - accuracy10: 0.5340 - accuracy20: 0.5265 - accuracy30: 0.5213 - accuracy50: 0.5183 - val_loss: 11.5763 - val_accuracy10: 0.7133 - val_accuracy20: 0.6677 - val_accuracy30: 0.6365 - val_accuracy50: 0.5853 - 54s/epoch - 24ms/step
Epoch 20/50
2257/2257 - 53s - loss: 11.0361 - accuracy10: 0.5356 - accuracy20: 0.5284 - accuracy30: 0.5225 - accuracy50: 0.5191 - val_loss: 11.5568 - val_accuracy10: 0.7120 - val_accuracy20: 0.6682 - val_accuracy30: 0.6370 - val_accuracy50: 0.5859 - 53s/epoch - 23ms/step
Epoch 21/50
2257/2257 - 52s - loss: 11.0064 - accuracy10: 0.5368 - accuracy20: 0.5300 - accuracy30: 0.5245 - accuracy50: 0.5211 - val_loss: 11.5905 - val_accuracy10: 0.7143 - val_accuracy20: 0.6699 - val_accuracy30: 0.6373 - val_accuracy50: 0.5856 - 52s/epoch - 23ms/step
Epoch 22/50
2257/2257 - 53s - loss: 10.9808 - accuracy10: 0.5369 - accuracy20: 0.5312 - accuracy30: 0.5259 - accuracy50: 0.5218 - val_loss: 11.5733 - val_accuracy10: 0.7137 - val_accuracy20: 0.6699 - val_accuracy30: 0.6382 - val_accuracy50: 0.5867 - 53s/epoch - 23ms/step
Epoch 23/50
2257/2257 - 53s - loss: 10.9284 - accuracy10: 0.5415 - accuracy20: 0.5348 - accuracy30: 0.5293 - accuracy50: 0.5253 - val_loss: 11.5656 - val_accuracy10: 0.7086 - val_accuracy20: 0.6649 - val_accuracy30: 0.6339 - val_accuracy50: 0.5835 - 53s/epoch - 24ms/step
Epoch 24/50
2257/2257 - 54s - loss: 10.9059 - accuracy10: 0.5417 - accuracy20: 0.5357 - accuracy30: 0.5299 - accuracy50: 0.5258 - val_loss: 11.5239 - val_accuracy10: 0.7026 - val_accuracy20: 0.6616 - val_accuracy30: 0.6316 - val_accuracy50: 0.5845 - 54s/epoch - 24ms/step
Epoch 25/50
2257/2257 - 50s - loss: 10.8759 - accuracy10: 0.5426 - accuracy20: 0.5372 - accuracy30: 0.5310 - accuracy50: 0.5269 - val_loss: 11.5974 - val_accuracy10: 0.7097 - val_accuracy20: 0.6662 - val_accuracy30: 0.6338 - val_accuracy50: 0.5845 - 50s/epoch - 22ms/step
Epoch 26/50
2257/2257 - 50s - loss: 10.8475 - accuracy10: 0.5434 - accuracy20: 0.5382 - accuracy30: 0.5329 - accuracy50: 0.5285 - val_loss: 11.5953 - val_accuracy10: 0.7040 - val_accuracy20: 0.6624 - val_accuracy30: 0.6305 - val_accuracy50: 0.5834 - 50s/epoch - 22ms/step
Epoch 27/50
2257/2257 - 53s - loss: 10.8194 - accuracy10: 0.5466 - accuracy20: 0.5413 - accuracy30: 0.5347 - accuracy50: 0.5300 - val_loss: 11.5686 - val_accuracy10: 0.7059 - val_accuracy20: 0.6638 - val_accuracy30: 0.6319 - val_accuracy50: 0.5836 - 53s/epoch - 24ms/step
Epoch 28/50
2257/2257 - 51s - loss: 10.7915 - accuracy10: 0.5473 - accuracy20: 0.5421 - accuracy30: 0.5361 - accuracy50: 0.5318 - val_loss: 11.5877 - val_accuracy10: 0.7009 - val_accuracy20: 0.6589 - val_accuracy30: 0.6280 - val_accuracy50: 0.5811 - 51s/epoch - 23ms/step
Epoch 29/50
2257/2257 - 53s - loss: 10.7638 - accuracy10: 0.5481 - accuracy20: 0.5430 - accuracy30: 0.5378 - accuracy50: 0.5335 - val_loss: 11.5698 - val_accuracy10: 0.6993 - val_accuracy20: 0.6572 - val_accuracy30: 0.6263 - val_accuracy50: 0.5798 - 53s/epoch - 24ms/step
Epoch 30/50
2257/2257 - 49s - loss: 10.7305 - accuracy10: 0.5497 - accuracy20: 0.5451 - accuracy30: 0.5392 - accuracy50: 0.5349 - val_loss: 11.5847 - val_accuracy10: 0.6996 - val_accuracy20: 0.6589 - val_accuracy30: 0.6272 - val_accuracy50: 0.5802 - 49s/epoch - 22ms/step
Epoch 31/50
2257/2257 - 53s - loss: 10.7097 - accuracy10: 0.5500 - accuracy20: 0.5459 - accuracy30: 0.5400 - accuracy50: 0.5357 - val_loss: 11.5967 - val_accuracy10: 0.7019 - val_accuracy20: 0.6598 - val_accuracy30: 0.6285 - val_accuracy50: 0.5815 - 53s/epoch - 23ms/step
Epoch 32/50
2257/2257 - 52s - loss: 10.6758 - accuracy10: 0.5539 - accuracy20: 0.5490 - accuracy30: 0.5422 - accuracy50: 0.5373 - val_loss: 11.6527 - val_accuracy10: 0.7060 - val_accuracy20: 0.6625 - val_accuracy30: 0.6298 - val_accuracy50: 0.5816 - 52s/epoch - 23ms/step
Epoch 33/50
2257/2257 - 53s - loss: 10.6640 - accuracy10: 0.5534 - accuracy20: 0.5484 - accuracy30: 0.5424 - accuracy50: 0.5378 - val_loss: 11.6279 - val_accuracy10: 0.6951 - val_accuracy20: 0.6544 - val_accuracy30: 0.6241 - val_accuracy50: 0.5794 - 53s/epoch - 24ms/step
Epoch 34/50
2257/2257 - 51s - loss: 10.6354 - accuracy10: 0.5530 - accuracy20: 0.5497 - accuracy30: 0.5440 - accuracy50: 0.5396 - val_loss: 11.6510 - val_accuracy10: 0.7022 - val_accuracy20: 0.6596 - val_accuracy30: 0.6291 - val_accuracy50: 0.5821 - 51s/epoch - 22ms/step
testing model: results/AAL/W1/deepOF_L1/seq2seq
Evaluating performance on  test set...
7177/7177 - 66s - 66s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7353821
{'0': {'precision': 0.3144089346086052, 'recall': 0.419438153519973, 'f1-score': 0.35940757990528216, 'support': 207530}, '1': {'precision': 0.8464015937322231, 'recall': 0.7725955265315759, 'f1-score': 0.807816242267511, 'support': 1423191}, '2': {'precision': 0.32562351850929966, 'recall': 0.41205545567761664, 'f1-score': 0.3637759838460584, 'support': 206363}, 'accuracy': 0.6922002477839881, 'macro avg': {'precision': 0.49547801561670934, 'recall': 0.5346963785763885, 'f1-score': 0.5103332686729506, 'support': 1837084}, 'weighted avg': {'precision': 0.7278039887859318, 'recall': 0.6922002477839881, 'f1-score': 0.7072809757534814, 'support': 1837084}}
[[  87046  100820   19664]
 [ 167198 1099551  156442]
 [  22612   98718   85033]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.79852337
{'0': {'precision': 0.37480688287184116, 'recall': 0.4093727322046318, 'f1-score': 0.3913279935882649, 'support': 283866}, '1': {'precision': 0.7780272785734501, 'recall': 0.7538183638176488, 'f1-score': 0.7657315253046858, 'support': 1272731}, '2': {'precision': 0.3839168452927767, 'recall': 0.4022895891788211, 'f1-score': 0.3928885422451719, 'support': 280487}, 'accuracy': 0.6469230584992303, 'macro avg': {'precision': 0.5122503355793561, 'recall': 0.521826895067034, 'f1-score': 0.5166493537127076, 'support': 1837084}, 'weighted avg': {'precision': 0.6555487125711175, 'recall': 0.6469230584992303, 'f1-score': 0.6509528637281724, 'support': 1837084}}
[[116207 138470  29189]
 [161439 959408 151884]
 [ 32399 135251 112837]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8538074
{'0': {'precision': 0.41192727090836334, 'recall': 0.3852095258698817, 'f1-score': 0.3981206471983443, 'support': 342058}, '1': {'precision': 0.715045003039744, 'recall': 0.7494594949299588, 'f1-score': 0.7318478947292982, 'support': 1158176}, '2': {'precision': 0.419497253490013, 'recall': 0.37770817871456136, 'f1-score': 0.397507435826939, 'support': 336850}, 'accuracy': 0.6134727644462638, 'macro avg': {'precision': 0.5154898424793735, 'recall': 0.5041257331714672, 'f1-score': 0.5091586592515273, 'support': 1837084}, 'weighted avg': {'precision': 0.6044136412439727, 'recall': 0.6134727644462638, 'f1-score': 0.6084040791948955, 'support': 1837084}}
[[131764 175025  35269]
 [149376 868006 140794]
 [ 38732 170887 127231]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9390807
{'0': {'precision': 0.46130827755480686, 'recall': 0.3288617111417792, 'f1-score': 0.38398479236293487, 'support': 435487}, '1': {'precision': 0.603951456611857, 'recall': 0.758838776249132, 'f1-score': 0.6725932916133119, 'support': 974937}, '2': {'precision': 0.4636681871220961, 'recall': 0.32783012234566167, 'f1-score': 0.384092793866466, 'support': 426660}, 'accuracy': 0.5568101404181844, 'macro avg': {'precision': 0.5096426404295866, 'recall': 0.4718435365788576, 'f1-score': 0.48022362594757095, 'support': 1837084}, 'weighted avg': {'precision': 0.537556828016475, 'recall': 0.5568101404181844, 'f1-score': 0.5371738595776956, 'support': 1837084}}
[[143215 245957  46315]
 [119640 739820 115477]
 [ 47599 239189 139872]]
Evaluating performance on  train set...
2257/2257 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.73172843
{'0': {'precision': 0.31530372524890926, 'recall': 0.41831782358965225, 'f1-score': 0.3595782275606473, 'support': 67377}, '1': {'precision': 0.8420049206520354, 'recall': 0.7759773621891648, 'f1-score': 0.8076438959894225, 'support': 442799}, '2': {'precision': 0.3390298097568283, 'recall': 0.4029644796581501, 'f1-score': 0.36824264775670146, 'support': 67398}, 'accuracy': 0.6907270756647633, 'macro avg': {'precision': 0.4987794852192577, 'recall': 0.532419888478989, 'f1-score': 0.5118215904355905, 'support': 577574}, 'weighted avg': {'precision': 0.7218695562367542, 'recall': 0.6907270756647633, 'f1-score': 0.7041003052631875, 'support': 577574}}
[[ 28185  32394   6798]
 [ 53046 343602  46151]
 [  8159  32080  27159]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7873579
{'0': {'precision': 0.3811458060354386, 'recall': 0.41477459690687724, 'f1-score': 0.39724976888814184, 'support': 91170}, '1': {'precision': 0.778678532873974, 'recall': 0.7611307313452805, 'f1-score': 0.7698046439664055, 'support': 396133}, '2': {'precision': 0.39952168857098974, 'recall': 0.4034296728739019, 'f1-score': 0.4014661705939094, 'support': 90271}, 'accuracy': 0.6505521370421798, 'macro avg': {'precision': 0.5197820091601341, 'recall': 0.5264450003753532, 'f1-score': 0.5228401944828188, 'support': 577574}, 'weighted avg': {'precision': 0.6566683208527543, 'recall': 0.6505521370421798, 'f1-score': 0.6534280233243858, 'support': 577574}}
[[ 37815  43048  10307]
 [ 50195 301509  44429]
 [ 11204  42649  36418]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8357945
{'0': {'precision': 0.4209397734282441, 'recall': 0.3971858572233668, 'f1-score': 0.40871797309502306, 'support': 108239}, '1': {'precision': 0.722684994368852, 'recall': 0.7588508199568313, 'f1-score': 0.7403264845094665, 'support': 362763}, '2': {'precision': 0.4343461058333157, 'recall': 0.3852512855158954, 'f1-score': 0.4083282777551244, 'support': 106572}, 'accuracy': 0.6221384619113741, 'macro avg': {'precision': 0.5259902912101372, 'recall': 0.5137626542320312, 'f1-score': 0.5191242451198713, 'support': 577574}, 'weighted avg': {'precision': 0.6129337711517412, 'recall': 0.6221384619113741, 'f1-score': 0.6169229265979058, 'support': 577574}}
[[ 42991  52970  12278]
 [ 46289 275283  41191]
 [ 12851  52664  41057]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9099399
{'0': {'precision': 0.47043509848240234, 'recall': 0.34622782328434465, 'f1-score': 0.3988860417263787, 'support': 134657}, '1': {'precision': 0.6236676438580139, 'recall': 0.7699826747710595, 'f1-score': 0.6891445783305835, 'support': 311107}, '2': {'precision': 0.47665720098330083, 'recall': 0.3412867005538275, 'f1-score': 0.3977699769216485, 'support': 131810}, 'accuracy': 0.5733533711697548, 'macro avg': {'precision': 0.5235866477745723, 'recall': 0.4858323995364106, 'f1-score': 0.4952668656595369, 'support': 577574}, 'weighted avg': {'precision': 0.5543929165711907, 'recall': 0.5733533711697548, 'f1-score': 0.5549774759762114, 'support': 577574}}
[[ 46622  72745  15290]
 [ 37459 239547  34101]
 [ 15023  71802  44985]]
Evaluating performance on  val set...
638/638 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7192433
{'0': {'precision': 0.32156341170413594, 'recall': 0.4212093964257615, 'f1-score': 0.3647024475694613, 'support': 17794}, '1': {'precision': 0.8541472147745864, 'recall': 0.7825861744207949, 'f1-score': 0.816802303435904, 'support': 127416}, '2': {'precision': 0.32777730045536557, 'recall': 0.42115140475796214, 'f1-score': 0.3686435559850223, 'support': 18117}, 'accuracy': 0.7031231823274781, 'macro avg': {'precision': 0.5011626423113626, 'recall': 0.5416489918681728, 'f1-score': 0.5167161023301292, 'support': 163327}, 'weighted avg': {'precision': 0.7377363339676353, 'recall': 0.7031231823274781, 'f1-score': 0.7178354647450867, 'support': 163327}}
[[ 7495  8312  1987]
 [14041 99714 13661]
 [ 1772  8715  7630]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.77399355
{'0': {'precision': 0.38467389237497623, 'recall': 0.4167181642153833, 'f1-score': 0.4000553709856035, 'support': 24273}, '1': {'precision': 0.7944685859134528, 'recall': 0.765013555569116, 'f1-score': 0.7794629018576827, 'support': 114713}, '2': {'precision': 0.38280897185006774, 'recall': 0.4178957314818619, 'f1-score': 0.39958360340188165, 'support': 24341}, 'accuracy': 0.6615195283082406, 'macro avg': {'precision': 0.5206504833794989, 'recall': 0.5332091504221204, 'f1-score': 0.5263672920817226, 'support': 163327}, 'weighted avg': {'precision': 0.6722159683904695, 'recall': 0.6615195283082406, 'f1-score': 0.6664625957198694, 'support': 163327}}
[[10115 11198  2960]
 [13516 87757 13440]
 [ 2664 11505 10172]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8256495
{'0': {'precision': 0.41977632598826264, 'recall': 0.39313491651975524, 'f1-score': 0.4060190639391668, 'support': 28929}, '1': {'precision': 0.7401927839512424, 'recall': 0.7617797822647123, 'f1-score': 0.750831154277176, 'support': 105541}, '2': {'precision': 0.413398515299656, 'recall': 0.3956059188411824, 'f1-score': 0.4043065590026916, 'support': 28857}, 'accuracy': 0.6317877631989812, 'macro avg': {'precision': 0.5244558750797204, 'recall': 0.5168402058752167, 'f1-score': 0.5203855924063447, 'support': 163327}, 'weighted avg': {'precision': 0.6257008143265639, 'recall': 0.6317877631989812, 'f1-score': 0.6285321516185581, 'support': 163327}}
[[11373 14045  3511]
 [12454 80399 12688]
 [ 3266 14175 11416]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.90034467
{'0': {'precision': 0.4646636432350718, 'recall': 0.3408744351104827, 'f1-score': 0.3932575285067728, 'support': 36069}, '1': {'precision': 0.645212347441035, 'recall': 0.7708611153619133, 'f1-score': 0.7024622985437377, 'support': 91486}, '2': {'precision': 0.45590422637402506, 'recall': 0.35130828581013085, 'f1-score': 0.3968296572303709, 'support': 35772}, 'accuracy': 0.5840124412987442, 'macro avg': {'precision': 0.5219267390167106, 'recall': 0.4876812787608423, 'f1-score': 0.49751649476029375, 'support': 163327}, 'weighted avg': {'precision': 0.5638777161870845, 'recall': 0.5840124412987442, 'f1-score': 0.5672378855836941, 'support': 163327}}
[[12295 19492  4282]
 [10247 70523 10716]
 [ 3918 19287 12567]]
training model: results/AAL/W1/deepLOB_L2/seq2seq
Epoch 1/50
2257/2257 - 109s - loss: 11.3276 - accuracy10: 0.4398 - accuracy20: 0.4652 - accuracy30: 0.4802 - accuracy50: 0.4941 - val_loss: 11.9729 - val_accuracy10: 0.5271 - val_accuracy20: 0.5210 - val_accuracy30: 0.5162 - val_accuracy50: 0.5065 - 109s/epoch - 48ms/step
Epoch 2/50
2257/2257 - 104s - loss: 10.9877 - accuracy10: 0.4685 - accuracy20: 0.4921 - accuracy30: 0.5049 - accuracy50: 0.5163 - val_loss: 11.9309 - val_accuracy10: 0.5944 - val_accuracy20: 0.5792 - val_accuracy30: 0.5641 - val_accuracy50: 0.5343 - 104s/epoch - 46ms/step
Epoch 3/50
2257/2257 - 104s - loss: 10.3825 - accuracy10: 0.5658 - accuracy20: 0.5681 - accuracy30: 0.5634 - accuracy50: 0.5558 - val_loss: 10.8914 - val_accuracy10: 0.6547 - val_accuracy20: 0.6373 - val_accuracy30: 0.6182 - val_accuracy50: 0.5808 - 104s/epoch - 46ms/step
Epoch 4/50
2257/2257 - 105s - loss: 9.9015 - accuracy10: 0.6226 - accuracy20: 0.6127 - accuracy30: 0.5982 - accuracy50: 0.5791 - val_loss: 10.6530 - val_accuracy10: 0.6844 - val_accuracy20: 0.6612 - val_accuracy30: 0.6358 - val_accuracy50: 0.5939 - 105s/epoch - 46ms/step
Epoch 5/50
2257/2257 - 105s - loss: 9.6424 - accuracy10: 0.6399 - accuracy20: 0.6298 - accuracy30: 0.6127 - accuracy50: 0.5898 - val_loss: 10.0418 - val_accuracy10: 0.6878 - val_accuracy20: 0.6680 - val_accuracy30: 0.6421 - val_accuracy50: 0.6013 - 105s/epoch - 46ms/step
Epoch 6/50
2257/2257 - 105s - loss: 9.4712 - accuracy10: 0.6496 - accuracy20: 0.6387 - accuracy30: 0.6197 - accuracy50: 0.5956 - val_loss: 10.1040 - val_accuracy10: 0.6693 - val_accuracy20: 0.6491 - val_accuracy30: 0.6241 - val_accuracy50: 0.5859 - 105s/epoch - 47ms/step
Epoch 7/50
2257/2257 - 104s - loss: 9.3619 - accuracy10: 0.6543 - accuracy20: 0.6427 - accuracy30: 0.6232 - accuracy50: 0.5984 - val_loss: 10.0494 - val_accuracy10: 0.6862 - val_accuracy20: 0.6620 - val_accuracy30: 0.6339 - val_accuracy50: 0.5932 - 104s/epoch - 46ms/step
Epoch 8/50
2257/2257 - 104s - loss: 9.2718 - accuracy10: 0.6564 - accuracy20: 0.6450 - accuracy30: 0.6254 - accuracy50: 0.6001 - val_loss: 9.9380 - val_accuracy10: 0.6839 - val_accuracy20: 0.6627 - val_accuracy30: 0.6378 - val_accuracy50: 0.5972 - 104s/epoch - 46ms/step
Epoch 9/50
2257/2257 - 106s - loss: 9.2050 - accuracy10: 0.6592 - accuracy20: 0.6479 - accuracy30: 0.6280 - accuracy50: 0.6020 - val_loss: 10.0205 - val_accuracy10: 0.6512 - val_accuracy20: 0.6363 - val_accuracy30: 0.6156 - val_accuracy50: 0.5828 - 106s/epoch - 47ms/step
Epoch 10/50
2257/2257 - 105s - loss: 9.1564 - accuracy10: 0.6608 - accuracy20: 0.6490 - accuracy30: 0.6301 - accuracy50: 0.6036 - val_loss: 9.8966 - val_accuracy10: 0.7079 - val_accuracy20: 0.6848 - val_accuracy30: 0.6553 - val_accuracy50: 0.6091 - 105s/epoch - 47ms/step
Epoch 11/50
2257/2257 - 104s - loss: 9.1199 - accuracy10: 0.6620 - accuracy20: 0.6506 - accuracy30: 0.6317 - accuracy50: 0.6048 - val_loss: 9.6291 - val_accuracy10: 0.6851 - val_accuracy20: 0.6689 - val_accuracy30: 0.6449 - val_accuracy50: 0.6048 - 104s/epoch - 46ms/step
Epoch 12/50
2257/2257 - 105s - loss: 9.0827 - accuracy10: 0.6620 - accuracy20: 0.6518 - accuracy30: 0.6322 - accuracy50: 0.6048 - val_loss: 9.7818 - val_accuracy10: 0.6522 - val_accuracy20: 0.6399 - val_accuracy30: 0.6185 - val_accuracy50: 0.5842 - 105s/epoch - 47ms/step
Epoch 13/50
2257/2257 - 104s - loss: 9.0446 - accuracy10: 0.6643 - accuracy20: 0.6537 - accuracy30: 0.6342 - accuracy50: 0.6066 - val_loss: 9.6104 - val_accuracy10: 0.6747 - val_accuracy20: 0.6600 - val_accuracy30: 0.6381 - val_accuracy50: 0.6003 - 104s/epoch - 46ms/step
Epoch 14/50
2257/2257 - 105s - loss: 9.0159 - accuracy10: 0.6650 - accuracy20: 0.6542 - accuracy30: 0.6349 - accuracy50: 0.6071 - val_loss: 9.7376 - val_accuracy10: 0.6681 - val_accuracy20: 0.6510 - val_accuracy30: 0.6281 - val_accuracy50: 0.5899 - 105s/epoch - 46ms/step
Epoch 15/50
2257/2257 - 106s - loss: 8.9895 - accuracy10: 0.6663 - accuracy20: 0.6552 - accuracy30: 0.6360 - accuracy50: 0.6077 - val_loss: 9.5778 - val_accuracy10: 0.6902 - val_accuracy20: 0.6733 - val_accuracy30: 0.6495 - val_accuracy50: 0.6070 - 106s/epoch - 47ms/step
Epoch 16/50
2257/2257 - 105s - loss: 8.9580 - accuracy10: 0.6668 - accuracy20: 0.6562 - accuracy30: 0.6375 - accuracy50: 0.6087 - val_loss: 9.8171 - val_accuracy10: 0.6577 - val_accuracy20: 0.6420 - val_accuracy30: 0.6208 - val_accuracy50: 0.5846 - 105s/epoch - 46ms/step
Epoch 17/50
2257/2257 - 105s - loss: 8.9340 - accuracy10: 0.6684 - accuracy20: 0.6577 - accuracy30: 0.6385 - accuracy50: 0.6091 - val_loss: 9.7789 - val_accuracy10: 0.6509 - val_accuracy20: 0.6367 - val_accuracy30: 0.6163 - val_accuracy50: 0.5810 - 105s/epoch - 47ms/step
Epoch 18/50
2257/2257 - 104s - loss: 8.9051 - accuracy10: 0.6692 - accuracy20: 0.6581 - accuracy30: 0.6391 - accuracy50: 0.6100 - val_loss: 9.7969 - val_accuracy10: 0.6497 - val_accuracy20: 0.6348 - val_accuracy30: 0.6145 - val_accuracy50: 0.5793 - 104s/epoch - 46ms/step
Epoch 19/50
2257/2257 - 105s - loss: 8.8837 - accuracy10: 0.6696 - accuracy20: 0.6579 - accuracy30: 0.6394 - accuracy50: 0.6103 - val_loss: 9.8644 - val_accuracy10: 0.6512 - val_accuracy20: 0.6355 - val_accuracy30: 0.6160 - val_accuracy50: 0.5804 - 105s/epoch - 47ms/step
Epoch 20/50
2257/2257 - 105s - loss: 8.8594 - accuracy10: 0.6709 - accuracy20: 0.6585 - accuracy30: 0.6402 - accuracy50: 0.6113 - val_loss: 9.6535 - val_accuracy10: 0.6913 - val_accuracy20: 0.6711 - val_accuracy30: 0.6464 - val_accuracy50: 0.6036 - 105s/epoch - 46ms/step
Epoch 21/50
2257/2257 - 105s - loss: 8.8344 - accuracy10: 0.6700 - accuracy20: 0.6590 - accuracy30: 0.6406 - accuracy50: 0.6117 - val_loss: 9.7320 - val_accuracy10: 0.6724 - val_accuracy20: 0.6559 - val_accuracy30: 0.6340 - val_accuracy50: 0.5950 - 105s/epoch - 47ms/step
Epoch 22/50
2257/2257 - 107s - loss: 8.8261 - accuracy10: 0.6702 - accuracy20: 0.6588 - accuracy30: 0.6412 - accuracy50: 0.6121 - val_loss: 9.8325 - val_accuracy10: 0.6537 - val_accuracy20: 0.6387 - val_accuracy30: 0.6194 - val_accuracy50: 0.5834 - 107s/epoch - 47ms/step
Epoch 23/50
2257/2257 - 104s - loss: 8.7971 - accuracy10: 0.6707 - accuracy20: 0.6594 - accuracy30: 0.6411 - accuracy50: 0.6121 - val_loss: 9.7651 - val_accuracy10: 0.6870 - val_accuracy20: 0.6689 - val_accuracy30: 0.6471 - val_accuracy50: 0.6043 - 104s/epoch - 46ms/step
Epoch 24/50
2257/2257 - 104s - loss: 8.7846 - accuracy10: 0.6714 - accuracy20: 0.6600 - accuracy30: 0.6421 - accuracy50: 0.6127 - val_loss: 9.8080 - val_accuracy10: 0.6736 - val_accuracy20: 0.6580 - val_accuracy30: 0.6375 - val_accuracy50: 0.5965 - 104s/epoch - 46ms/step
Epoch 25/50
2257/2257 - 105s - loss: 8.7614 - accuracy10: 0.6719 - accuracy20: 0.6608 - accuracy30: 0.6429 - accuracy50: 0.6136 - val_loss: 9.8613 - val_accuracy10: 0.6741 - val_accuracy20: 0.6538 - val_accuracy30: 0.6322 - val_accuracy50: 0.5927 - 105s/epoch - 46ms/step
testing model: results/AAL/W1/deepLOB_L2/seq2seq
Evaluating performance on  test set...
7177/7177 - 117s - 117s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7814251
{'0': {'precision': 0.3253985358321206, 'recall': 0.7057046349255299, 'f1-score': 0.4454166400554729, 'support': 207533}, '1': {'precision': 0.9300521923630196, 'recall': 0.5987508370263204, 'f1-score': 0.728503957606568, 'support': 1423193}, '2': {'precision': 0.30891418035677115, 'recall': 0.7047290454199638, 'f1-score': 0.42954126245493923, 'support': 206363}, 'accuracy': 0.6227379294089725, 'macro avg': {'precision': 0.5214549695173037, 'recall': 0.6697281724572713, 'f1-score': 0.5344872867056601, 'support': 1837089}, 'weighted avg': {'precision': 0.7919720607676137, 'recall': 0.6227379294089725, 'f1-score': 0.6629411030399647, 'support': 1837089}}
[[146457  34183  26893]
 [272600 852138 298455]
 [ 31028  29905 145430]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.79597247
{'0': {'precision': 0.3961439556124194, 'recall': 0.6609809454360991, 'f1-score': 0.49538821013445283, 'support': 283869}, '1': {'precision': 0.8738968332625419, 'recall': 0.5965097129639233, 'f1-score': 0.7090392116483873, 'support': 1272732}, '2': {'precision': 0.37762738177540056, 'recall': 0.6660177975528365, 'f1-score': 0.48197713569200523, 'support': 280488}, 'accuracy': 0.6170844199709432, 'macro avg': {'precision': 0.5492227235501206, 'recall': 0.6411694853176196, 'f1-score': 0.5621348524916151, 'support': 1837089}, 'weighted avg': {'precision': 0.7243031785542572, 'recall': 0.6170844199709432, 'f1-score': 0.6413576329607936, 'support': 1837089}}
[[187632  57404  38833]
 [244484 759197 269051]
 [ 41530  52148 186810]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8313963
{'0': {'precision': 0.4309329253029948, 'recall': 0.6240962869195845, 'f1-score': 0.5098316434791851, 'support': 342061}, '1': {'precision': 0.8186812654894672, 'recall': 0.5841352401230555, 'f1-score': 0.6818006142465907, 'support': 1158177}, '2': {'precision': 0.41420401953688196, 'recall': 0.6336718608524243, 'f1-score': 0.5009551927752692, 'support': 336851}, 'accuracy': 0.6006589773277179, 'macro avg': {'precision': 0.5546060701097814, 'recall': 0.6139677959650215, 'f1-score': 0.5641958168336817, 'support': 1837089}, 'weighted avg': {'precision': 0.6723181062909204, 'recall': 0.6006589773277179, 'f1-score': 0.6166204084004364, 'support': 1837089}}
[[213479  77921  50661]
 [230426 676532 251219]
 [ 51483  71915 213453]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.89698404
{'0': {'precision': 0.46988713609746097, 'recall': 0.5682495579691841, 'f1-score': 0.5144084760877292, 'support': 435490}, '1': {'precision': 0.7087618185166994, 'recall': 0.5683721101978897, 'f1-score': 0.6308507531758731, 'support': 974937}, '2': {'precision': 0.45744807638101975, 'recall': 0.5667554176373804, 'f1-score': 0.5062688754547119, 'support': 426662}, 'accuracy': 0.5679675834975878, 'macro avg': {'precision': 0.5453656769983933, 'recall': 0.5677923619348181, 'f1-score': 0.5505093682394381, 'support': 1837089}, 'weighted avg': {'precision': 0.593768174064064, 'recall': 0.5679675834975878, 'f1-score': 0.5743135901089875, 'support': 1837089}}
[[247467 115783  72240]
 [206250 554127 214560]
 [ 72935 111914 241813]]
Evaluating performance on  train set...
2257/2257 - 38s - 38s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.80662477
{'0': {'precision': 0.31250458917688523, 'recall': 0.695280244750052, 'f1-score': 0.4311997163159761, 'support': 67334}, '1': {'precision': 0.9233068006289921, 'recall': 0.5991042747853803, 'f1-score': 0.7266855320855871, 'support': 442993}, '2': {'precision': 0.30660195835293114, 'recall': 0.639766238401142, 'f1-score': 0.4145396733632028, 'support': 67248}, 'accuracy': 0.6150508591957754, 'macro avg': {'precision': 0.5141377827196029, 'recall': 0.6447169193121914, 'f1-score': 0.5241416405882553, 'support': 577575}, 'weighted avg': {'precision': 0.7802952032792164, 'recall': 0.6150508591957754, 'f1-score': 0.6558939870457327, 'support': 577575}}
[[ 46816  11696   8822]
 [ 89117 265399  88477]
 [ 13876  10349  43023]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.82172984
{'0': {'precision': 0.38034374151849676, 'recall': 0.6607781213676338, 'f1-score': 0.4827923261506167, 'support': 91194}, '1': {'precision': 0.872411824293213, 'recall': 0.5977089816097697, 'f1-score': 0.7093952836377032, 'support': 396243}, '2': {'precision': 0.3744641659951106, 'recall': 0.613459362311123, 'f1-score': 0.4650532999726667, 'support': 90138}, 'accuracy': 0.6101250919793966, 'macro avg': {'precision': 0.5424065772689401, 'recall': 0.6239821550961756, 'f1-score': 0.5524136365869955, 'support': 577575}, 'weighted avg': {'precision': 0.7170074824082079, 'recall': 0.6101250919793966, 'f1-score': 0.6354839685207462, 'support': 577575}}
[[ 60259  18189  12746]
 [ 79780 236838  79625]
 [ 18394  16448  55296]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.85056055
{'0': {'precision': 0.4131331631887104, 'recall': 0.6350394609313703, 'f1-score': 0.5005966673943099, 'support': 108335}, '1': {'precision': 0.8254504898360477, 'recall': 0.5856320080284746, 'f1-score': 0.6851622475969291, 'support': 362709}, '2': {'precision': 0.4096370650342508, 'recall': 0.5910861627132008, 'f1-score': 0.4839116234390009, 'support': 106531}, 'accuracy': 0.5959052936848028, 'macro avg': {'precision': 0.5494069060196697, 'recall': 0.6039192105576819, 'f1-score': 0.5565568461434133, 'support': 577575}, 'weighted avg': {'precision': 0.6714178230137312, 'recall': 0.5959052936848028, 'f1-score': 0.6134237852787557, 'support': 577575}}
[[ 68797  23514  16024]
 [ 75569 212414  74726]
 [ 22159  21403  62969]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8973485
{'0': {'precision': 0.4498545613818353, 'recall': 0.5945643058060398, 'f1-score': 0.5121842843031638, 'support': 134739}, '1': {'precision': 0.7346294326679693, 'recall': 0.572716871496889, 'f1-score': 0.6436468578322131, 'support': 311152}, '2': {'precision': 0.4531063797245713, 'recall': 0.5399365146866741, 'f1-score': 0.4927253008457986, 'support': 131684}, 'accuracy': 0.5703397827122019, 'macro avg': {'precision': 0.545863457924792, 'recall': 0.5690725639965343, 'f1-score': 0.5495188143270585, 'support': 577575}, 'weighted avg': {'precision': 0.604010269639755, 'recall': 0.5703397827122019, 'f1-score': 0.5785694393066024, 'support': 577575}}
[[ 80111  33166  21462]
 [ 68594 178202  64356]
 [ 29377  31206  71101]]
Evaluating performance on  val set...
638/638 - 10s - 10s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6904058
{'0': {'precision': 0.35319278948976474, 'recall': 0.6507543346093222, 'f1-score': 0.45787618330890795, 'support': 17764}, '1': {'precision': 0.9178332008883998, 'recall': 0.7070240150682782, 'f1-score': 0.7987534024311314, 'support': 127420}, '2': {'precision': 0.3373813339908766, 'recall': 0.6032848324514991, 'f1-score': 0.4327508500039535, 'support': 18144}, 'accuracy': 0.6893796532131662, 'macro avg': {'precision': 0.5361357747896804, 'recall': 0.6536877273763665, 'f1-score': 0.5631268119146643, 'support': 163328}, 'weighted avg': {'precision': 0.7919393496132111, 'recall': 0.6893796532131662, 'f1-score': 0.7210196811357876, 'support': 163328}}
[[11560  4061  2143]
 [17976 90089 19355]
 [ 3194  4004 10946]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.72057307
{'0': {'precision': 0.4263648392107231, 'recall': 0.6111317254174397, 'f1-score': 0.5022957930228222, 'support': 24255}, '1': {'precision': 0.8671811535337124, 'recall': 0.7072371288595987, 'f1-score': 0.7790848417919047, 'support': 114714}, '2': {'precision': 0.39976004113580527, 'recall': 0.5744899215895563, 'f1-score': 0.4714562452623599, 'support': 24359}, 'accuracy': 0.6731668789184952, 'macro avg': {'precision': 0.5644353446267469, 'recall': 0.6309529252888649, 'f1-score': 0.5842789600256956, 'support': 163328}, 'weighted avg': {'precision': 0.7320058585395611, 'recall': 0.6731668789184952, 'f1-score': 0.6921001033468294, 'support': 163328}}
[[14823  6340  3092]
 [15664 81130 17920]
 [ 4279  6086 13994]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7641837
{'0': {'precision': 0.4540232999187212, 'recall': 0.5797813451425409, 'f1-score': 0.5092533503509892, 'support': 28904}, '1': {'precision': 0.8203286684341824, 'recall': 0.6950513255547236, 'f1-score': 0.7525116217020533, 'support': 105503}, '2': {'precision': 0.42795797661166174, 'recall': 0.5479063656166799, 'f1-score': 0.4805604415600169, 'support': 28921}, 'accuracy': 0.6485966888714734, 'macro avg': {'precision': 0.5674366483215217, 'recall': 0.6075796787713147, 'f1-score': 0.5807751378710198, 'support': 163328}, 'weighted avg': {'precision': 0.6860256515003438, 'recall': 0.6485966888714734, 'f1-score': 0.6613071916225876, 'support': 163328}}
[[16758  8264  3882]
 [14874 73330 17299]
 [ 5278  7797 15846]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.83858
{'0': {'precision': 0.47985274598682726, 'recall': 0.5314233414688263, 'f1-score': 0.5043231079000356, 'support': 36056}, '1': {'precision': 0.7315825375170532, 'recall': 0.6802003258575631, 'f1-score': 0.7049563970784058, 'support': 91451}, '2': {'precision': 0.46063228126873257, 'recall': 0.4933977275899612, 'f1-score': 0.47645235206901204, 'support': 35821}, 'accuracy': 0.6063871473354232, 'macro avg': {'precision': 0.5573558549242043, 'recall': 0.5683404649721169, 'f1-score': 0.5619106190158178, 'support': 163328}, 'weighted avg': {'precision': 0.6165864652423365, 'recall': 0.6063871473354232, 'f1-score': 0.6105495760134518, 'support': 163328}}
[[19161 11731  5164]
 [13715 62205 15531]
 [ 7055 11092 17674]]
training model: results/AAL/W1/deepOF_L2/seq2seq
Epoch 1/50
2257/2257 - 71s - loss: 10.5589 - accuracy10: 0.5656 - accuracy20: 0.5694 - accuracy30: 0.5636 - accuracy50: 0.5513 - val_loss: 11.1335 - val_accuracy10: 0.7833 - val_accuracy20: 0.7467 - val_accuracy30: 0.7077 - val_accuracy50: 0.6368 - 71s/epoch - 32ms/step
Epoch 2/50
2257/2257 - 65s - loss: 9.6497 - accuracy10: 0.6377 - accuracy20: 0.6278 - accuracy30: 0.6130 - accuracy50: 0.5904 - val_loss: 11.1803 - val_accuracy10: 0.7870 - val_accuracy20: 0.7498 - val_accuracy30: 0.7101 - val_accuracy50: 0.6390 - 65s/epoch - 29ms/step
Epoch 3/50
2257/2257 - 64s - loss: 9.4843 - accuracy10: 0.6456 - accuracy20: 0.6333 - accuracy30: 0.6162 - accuracy50: 0.5930 - val_loss: 11.0573 - val_accuracy10: 0.7927 - val_accuracy20: 0.7547 - val_accuracy30: 0.7152 - val_accuracy50: 0.6433 - 64s/epoch - 28ms/step
Epoch 4/50
2257/2257 - 64s - loss: 9.3894 - accuracy10: 0.6484 - accuracy20: 0.6363 - accuracy30: 0.6188 - accuracy50: 0.5945 - val_loss: 11.0214 - val_accuracy10: 0.7959 - val_accuracy20: 0.7582 - val_accuracy30: 0.7181 - val_accuracy50: 0.6460 - 64s/epoch - 29ms/step
Epoch 5/50
2257/2257 - 65s - loss: 9.3263 - accuracy10: 0.6508 - accuracy20: 0.6388 - accuracy30: 0.6205 - accuracy50: 0.5958 - val_loss: 11.0831 - val_accuracy10: 0.7982 - val_accuracy20: 0.7593 - val_accuracy30: 0.7194 - val_accuracy50: 0.6465 - 65s/epoch - 29ms/step
Epoch 6/50
2257/2257 - 63s - loss: 9.2815 - accuracy10: 0.6519 - accuracy20: 0.6406 - accuracy30: 0.6220 - accuracy50: 0.5966 - val_loss: 10.8819 - val_accuracy10: 0.7892 - val_accuracy20: 0.7544 - val_accuracy30: 0.7163 - val_accuracy50: 0.6453 - 63s/epoch - 28ms/step
Epoch 7/50
2257/2257 - 64s - loss: 9.2402 - accuracy10: 0.6540 - accuracy20: 0.6429 - accuracy30: 0.6238 - accuracy50: 0.5976 - val_loss: 10.9897 - val_accuracy10: 0.7908 - val_accuracy20: 0.7555 - val_accuracy30: 0.7164 - val_accuracy50: 0.6456 - 64s/epoch - 28ms/step
Epoch 8/50
2257/2257 - 64s - loss: 9.2088 - accuracy10: 0.6540 - accuracy20: 0.6431 - accuracy30: 0.6247 - accuracy50: 0.5989 - val_loss: 10.9600 - val_accuracy10: 0.7869 - val_accuracy20: 0.7526 - val_accuracy30: 0.7146 - val_accuracy50: 0.6451 - 64s/epoch - 28ms/step
Epoch 9/50
2257/2257 - 65s - loss: 9.1795 - accuracy10: 0.6549 - accuracy20: 0.6446 - accuracy30: 0.6256 - accuracy50: 0.5992 - val_loss: 10.8876 - val_accuracy10: 0.7873 - val_accuracy20: 0.7533 - val_accuracy30: 0.7152 - val_accuracy50: 0.6455 - 65s/epoch - 29ms/step
Epoch 10/50
2257/2257 - 65s - loss: 9.1478 - accuracy10: 0.6563 - accuracy20: 0.6462 - accuracy30: 0.6271 - accuracy50: 0.6002 - val_loss: 10.8680 - val_accuracy10: 0.7886 - val_accuracy20: 0.7544 - val_accuracy30: 0.7155 - val_accuracy50: 0.6453 - 65s/epoch - 29ms/step
Epoch 11/50
2257/2257 - 63s - loss: 9.1251 - accuracy10: 0.6567 - accuracy20: 0.6468 - accuracy30: 0.6271 - accuracy50: 0.6006 - val_loss: 10.9475 - val_accuracy10: 0.7920 - val_accuracy20: 0.7565 - val_accuracy30: 0.7173 - val_accuracy50: 0.6463 - 63s/epoch - 28ms/step
Epoch 12/50
2257/2257 - 64s - loss: 9.0947 - accuracy10: 0.6573 - accuracy20: 0.6482 - accuracy30: 0.6287 - accuracy50: 0.6017 - val_loss: 10.8497 - val_accuracy10: 0.7886 - val_accuracy20: 0.7545 - val_accuracy30: 0.7159 - val_accuracy50: 0.6462 - 64s/epoch - 28ms/step
Epoch 13/50
2257/2257 - 65s - loss: 9.0719 - accuracy10: 0.6581 - accuracy20: 0.6492 - accuracy30: 0.6293 - accuracy50: 0.6026 - val_loss: 10.8609 - val_accuracy10: 0.7870 - val_accuracy20: 0.7534 - val_accuracy30: 0.7147 - val_accuracy50: 0.6455 - 65s/epoch - 29ms/step
Epoch 14/50
2257/2257 - 64s - loss: 9.0510 - accuracy10: 0.6590 - accuracy20: 0.6500 - accuracy30: 0.6299 - accuracy50: 0.6028 - val_loss: 10.9258 - val_accuracy10: 0.7854 - val_accuracy20: 0.7519 - val_accuracy30: 0.7143 - val_accuracy50: 0.6456 - 64s/epoch - 28ms/step
Epoch 15/50
2257/2257 - 66s - loss: 9.0249 - accuracy10: 0.6589 - accuracy20: 0.6504 - accuracy30: 0.6310 - accuracy50: 0.6037 - val_loss: 10.8712 - val_accuracy10: 0.7847 - val_accuracy20: 0.7519 - val_accuracy30: 0.7142 - val_accuracy50: 0.6452 - 66s/epoch - 29ms/step
Epoch 16/50
2257/2257 - 66s - loss: 9.0016 - accuracy10: 0.6602 - accuracy20: 0.6516 - accuracy30: 0.6320 - accuracy50: 0.6041 - val_loss: 11.0172 - val_accuracy10: 0.7818 - val_accuracy20: 0.7495 - val_accuracy30: 0.7114 - val_accuracy50: 0.6440 - 66s/epoch - 29ms/step
Epoch 17/50
2257/2257 - 64s - loss: 8.9823 - accuracy10: 0.6607 - accuracy20: 0.6524 - accuracy30: 0.6324 - accuracy50: 0.6050 - val_loss: 11.1184 - val_accuracy10: 0.7876 - val_accuracy20: 0.7533 - val_accuracy30: 0.7150 - val_accuracy50: 0.6454 - 64s/epoch - 28ms/step
Epoch 18/50
2257/2257 - 65s - loss: 8.9592 - accuracy10: 0.6608 - accuracy20: 0.6525 - accuracy30: 0.6329 - accuracy50: 0.6052 - val_loss: 10.9628 - val_accuracy10: 0.7809 - val_accuracy20: 0.7481 - val_accuracy30: 0.7113 - val_accuracy50: 0.6440 - 65s/epoch - 29ms/step
Epoch 19/50
2257/2257 - 65s - loss: 8.9344 - accuracy10: 0.6625 - accuracy20: 0.6541 - accuracy30: 0.6342 - accuracy50: 0.6066 - val_loss: 11.0909 - val_accuracy10: 0.7827 - val_accuracy20: 0.7499 - val_accuracy30: 0.7128 - val_accuracy50: 0.6447 - 65s/epoch - 29ms/step
Epoch 20/50
2257/2257 - 65s - loss: 8.9168 - accuracy10: 0.6620 - accuracy20: 0.6540 - accuracy30: 0.6347 - accuracy50: 0.6073 - val_loss: 11.0350 - val_accuracy10: 0.7817 - val_accuracy20: 0.7487 - val_accuracy30: 0.7121 - val_accuracy50: 0.6439 - 65s/epoch - 29ms/step
Epoch 21/50
2257/2257 - 66s - loss: 8.8945 - accuracy10: 0.6627 - accuracy20: 0.6544 - accuracy30: 0.6354 - accuracy50: 0.6077 - val_loss: 11.1239 - val_accuracy10: 0.7808 - val_accuracy20: 0.7468 - val_accuracy30: 0.7100 - val_accuracy50: 0.6430 - 66s/epoch - 29ms/step
Epoch 22/50
2257/2257 - 65s - loss: 8.8746 - accuracy10: 0.6632 - accuracy20: 0.6549 - accuracy30: 0.6357 - accuracy50: 0.6076 - val_loss: 11.0752 - val_accuracy10: 0.7805 - val_accuracy20: 0.7476 - val_accuracy30: 0.7117 - val_accuracy50: 0.6441 - 65s/epoch - 29ms/step
testing model: results/AAL/W1/deepOF_L2/seq2seq
Evaluating performance on  test set...
7177/7177 - 70s - 70s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5491996
{'0': {'precision': 0.4474815888607153, 'recall': 0.4447453380234183, 'f1-score': 0.44610926772211096, 'support': 207530}, '1': {'precision': 0.8771968191976883, 'recall': 0.873691584615136, 'f1-score': 0.8754406932106403, 'support': 1423191}, '2': {'precision': 0.4733052376956577, 'recall': 0.48925921797996735, 'f1-score': 0.4811500135817119, 'support': 206363}, 'accuracy': 0.7820507935401974, 'macro avg': {'precision': 0.5993278819180204, 'recall': 0.6025653802061738, 'f1-score': 0.6008999915048211, 'support': 1837084}, 'weighted avg': {'precision': 0.7832832691448134, 'recall': 0.7820507935401974, 'f1-score': 0.7826489873050319, 'support': 1837084}}
[[  92298   90499   24733]
 [  92140 1243430   87621]
 [  21823   83575  100965]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.638255
{'0': {'precision': 0.5266690345823319, 'recall': 0.4022144251160759, 'f1-score': 0.4561043277479611, 'support': 283866}, '1': {'precision': 0.8052294736781773, 'recall': 0.8830805566926554, 'f1-score': 0.8423600868199207, 'support': 1272731}, '2': {'precision': 0.5499875287284648, 'recall': 0.440237871986937, 'f1-score': 0.4890307582331194, 'support': 280487}, 'accuracy': 0.7411637137986069, 'macro avg': {'precision': 0.6272953456629914, 'recall': 0.5751776179318894, 'f1-score': 0.5958317242670005, 'support': 1837084}, 'weighted avg': {'precision': 0.7232158667786065, 'recall': 0.7411637137986069, 'f1-score': 0.7287293760347595, 'support': 1837084}}
[[ 114175  141257   28434]
 [  76206 1123924   72601]
 [  26406  130600  123481]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.72535753
{'0': {'precision': 0.5580436842917282, 'recall': 0.37009805354647457, 'f1-score': 0.44504168475672023, 'support': 342058}, '1': {'precision': 0.7402915638391057, 'recall': 0.8793205868538115, 'f1-score': 0.8038388846112711, 'support': 1158176}, '2': {'precision': 0.5757768265229551, 'recall': 0.40090544752857354, 'f1-score': 0.4726860975088993, 'support': 336850}, 'accuracy': 0.6967825096729382, 'macro avg': {'precision': 0.6247040248845964, 'recall': 0.5501080293096199, 'f1-score': 0.5738555556256302, 'support': 1837084}, 'weighted avg': {'precision': 0.6761920809373101, 'recall': 0.6967825096729382, 'f1-score': 0.6763116354907726, 'support': 1837084}}
[[ 126595  186092   29371]
 [  69640 1018408   70128]
 [  30620  171185  135045]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.869248
{'0': {'precision': 0.5792836561717879, 'recall': 0.31623446853752235, 'f1-score': 0.4091250731556604, 'support': 435487}, '1': {'precision': 0.6247086878165105, 'recall': 0.8757129947883812, 'f1-score': 0.7292156894565165, 'support': 974937}, '2': {'precision': 0.6006583923537097, 'recall': 0.32758168096376505, 'f1-score': 0.4239521466661004, 'support': 426660}, 'accuracy': 0.615784036004886, 'macro avg': {'precision': 0.6015502454473359, 'recall': 0.5065097147632228, 'f1-score': 0.5207643030927591, 'support': 1837084}, 'weighted avg': {'precision': 0.6083548848232756, 'recall': 0.615784036004886, 'f1-score': 0.582440122640862, 'support': 1837084}}
[[137716 265057  32714]
 [ 60964 853765  60208]
 [ 39055 247839 139766]]
Evaluating performance on  train set...
2257/2257 - 24s - 24s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.57530797
{'0': {'precision': 0.426056338028169, 'recall': 0.48488356560844204, 'f1-score': 0.4535704616922468, 'support': 67377}, '1': {'precision': 0.8787732786369966, 'recall': 0.8650042118432969, 'f1-score': 0.8718343841759043, 'support': 442799}, '2': {'precision': 0.47726538834130366, 'recall': 0.46051811626457756, 'f1-score': 0.4687422129259765, 'support': 67398}, 'accuracy': 0.7734610629979881, 'macro avg': {'precision': 0.5940316683354897, 'recall': 0.6034686312387721, 'f1-score': 0.5980490195980425, 'support': 577574}, 'weighted avg': {'precision': 0.7791089272334534, 'recall': 0.7734610629979881, 'f1-score': 0.7760042836812767, 'support': 577574}}
[[ 32670  26221   8486]
 [ 34267 383023  25509]
 [  9743  26617  31038]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6496501
{'0': {'precision': 0.5041848797933638, 'recall': 0.44533289459251946, 'f1-score': 0.47293503710002444, 'support': 91170}, '1': {'precision': 0.8115043670361014, 'recall': 0.8790885889335147, 'f1-score': 0.8439455830123223, 'support': 396133}, '2': {'precision': 0.5549748240628957, 'recall': 0.41757596570327127, 'f1-score': 0.4765697597238816, 'support': 90271}, 'accuracy': 0.738488920900179, 'macro avg': {'precision': 0.6235546902974537, 'recall': 0.5806658164097684, 'f1-score': 0.5978167932787427, 'support': 577574}, 'weighted avg': {'precision': 0.7229001431173401, 'recall': 0.738488920900179, 'f1-score': 0.7279631904273116, 'support': 577574}}
[[ 40601  40121  10448]
 [ 28118 348236  19779]
 [ 11809  40767  37695]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7209002
{'0': {'precision': 0.5377716453949638, 'recall': 0.41769602453829024, 'f1-score': 0.47018875773490715, 'support': 108239}, '1': {'precision': 0.7535328718905766, 'recall': 0.8793013620462947, 'f1-score': 0.81157347981676, 'support': 362763}, '2': {'precision': 0.5799153761771116, 'recall': 0.38195773749202416, 'f1-score': 0.46056628857522697, 'support': 106572}, 'accuracy': 0.7010270545419288, 'macro avg': {'precision': 0.6237399644875506, 'recall': 0.5596517080255364, 'f1-score': 0.5807761753756314, 'support': 577574}, 'weighted avg': {'precision': 0.6810632954417856, 'recall': 0.7010270545419288, 'f1-score': 0.6828303589034046, 'support': 577574}}
[[ 45211  51954  11074]
 [ 25372 318978  18413]
 [ 13488  52378  40706]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8377489
{'0': {'precision': 0.5636100902294993, 'recall': 0.36785313797277525, 'f1-score': 0.44516140628370116, 'support': 134657}, '1': {'precision': 0.6513483712132014, 'recall': 0.8810152134153202, 'f1-score': 0.7489708448158314, 'support': 311107}, '2': {'precision': 0.6036757980924176, 'recall': 0.31547682269933996, 'f1-score': 0.41439412435909573, 'support': 131810}, 'accuracy': 0.6323120500576549, 'macro avg': {'precision': 0.6062114198450393, 'recall': 0.5214483913624784, 'f1-score': 0.5361754584862094, 'support': 577574}, 'weighted avg': {'precision': 0.620013346496935, 'recall': 0.6323120500576549, 'f1-score': 0.6017851593663074, 'support': 577574}}
[[ 49534  72938  12185]
 [ 21902 274090  15115]
 [ 16451  73776  41583]]
Evaluating performance on  val set...
638/638 - 6s - 6s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5509263
{'0': {'precision': 0.4522593751715807, 'recall': 0.4629088456783185, 'f1-score': 0.4575221484711306, 'support': 17794}, '1': {'precision': 0.8870656600538236, 'recall': 0.8769777735920136, 'f1-score': 0.8819928724500066, 'support': 127416}, '2': {'precision': 0.4606988039901812, 'recall': 0.4868907655792902, 'f1-score': 0.47343280377844565, 'support': 18117}, 'accuracy': 0.7885958843302088, 'macro avg': {'precision': 0.6000079464051952, 'recall': 0.6089257949498741, 'f1-score': 0.6043159415665277, 'support': 163327}, 'weighted avg': {'precision': 0.7924001646703314, 'recall': 0.7885958843302088, 'f1-score': 0.7904286189793447, 'support': 163327}}
[[  8237   7166   2391]
 [  7740 111741   7935]
 [  2236   7060   8821]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.62395865
{'0': {'precision': 0.5333646616541353, 'recall': 0.42083796811271784, 'f1-score': 0.47046632124352333, 'support': 24273}, '1': {'precision': 0.824029625565766, 'recall': 0.8903611622048068, 'f1-score': 0.8559121763177743, 'support': 114713}, '2': {'precision': 0.5357919715246193, 'recall': 0.4452569738301631, 'f1-score': 0.48634701249747586, 'support': 24341}, 'accuracy': 0.7542476136829795, 'macro avg': {'precision': 0.6310620862481736, 'recall': 0.5854853680492292, 'f1-score': 0.6042418366862577, 'support': 163327}, 'weighted avg': {'precision': 0.737875447713711, 'recall': 0.7542476136829795, 'f1-score': 0.7435516180955135, 'support': 163327}}
[[ 10215  11117   2941]
 [  6128 102136   6449]
 [  2809  10694  10838]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6969342
{'0': {'precision': 0.5601494396014944, 'recall': 0.38871029071174257, 'f1-score': 0.45894212717329197, 'support': 28929}, '1': {'precision': 0.7680583167660703, 'recall': 0.8895026577349087, 'f1-score': 0.82433156254116, 'support': 105541}, '2': {'precision': 0.5607667792417829, 'recall': 0.4085317254045812, 'f1-score': 0.4726944667201284, 'support': 28857}, 'accuracy': 0.71582163390009, 'macro avg': {'precision': 0.6296581785364492, 'recall': 0.5622482246170776, 'f1-score': 0.5853227188115269, 'support': 163327}, 'weighted avg': {'precision': 0.6946080739658451, 'recall': 0.71582163390009, 'f1-score': 0.697484546127067, 'support': 163327}}
[[11245 14578  3106]
 [ 5534 93879  6128]
 [ 3296 13772 11789]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8184063
{'0': {'precision': 0.573201345142803, 'recall': 0.33552357980537306, 'f1-score': 0.42328005316358297, 'support': 36069}, '1': {'precision': 0.668817381285491, 'recall': 0.8883107797914435, 'f1-score': 0.7630941426130068, 'support': 91486}, '2': {'precision': 0.5820131375579598, 'recall': 0.33685564128368556, 'f1-score': 0.4267299383809051, 'support': 35772}, 'accuracy': 0.6454535992211943, 'macro avg': {'precision': 0.6080106213287512, 'recall': 0.5202300002935006, 'f1-score': 0.5377013780524983, 'support': 163327}, 'weighted avg': {'precision': 0.6286896852263466, 'recall': 0.6454535992211943, 'f1-score': 0.6143791432182834, 'support': 163327}}
[[12102 20677  3290]
 [ 4854 81268  5364]
 [ 4157 19565 12050]]
training model: results/AAL/W1/deepVOL_L2/seq2seq
Epoch 1/50
2257/2257 - 69s - loss: 10.8784 - accuracy10: 0.5287 - accuracy20: 0.5419 - accuracy30: 0.5425 - accuracy50: 0.5365 - val_loss: 10.7012 - val_accuracy10: 0.7075 - val_accuracy20: 0.6959 - val_accuracy30: 0.6765 - val_accuracy50: 0.6239 - 69s/epoch - 31ms/step
Epoch 2/50
2257/2257 - 63s - loss: 10.3561 - accuracy10: 0.5849 - accuracy20: 0.5876 - accuracy30: 0.5806 - accuracy50: 0.5661 - val_loss: 10.5495 - val_accuracy10: 0.7271 - val_accuracy20: 0.7105 - val_accuracy30: 0.6842 - val_accuracy50: 0.6287 - 63s/epoch - 28ms/step
Epoch 3/50
2257/2257 - 63s - loss: 10.1912 - accuracy10: 0.6088 - accuracy20: 0.6026 - accuracy30: 0.5908 - accuracy50: 0.5733 - val_loss: 10.1625 - val_accuracy10: 0.7061 - val_accuracy20: 0.6947 - val_accuracy30: 0.6735 - val_accuracy50: 0.6262 - 63s/epoch - 28ms/step
Epoch 4/50
2257/2257 - 62s - loss: 9.9695 - accuracy10: 0.6256 - accuracy20: 0.6143 - accuracy30: 0.5974 - accuracy50: 0.5750 - val_loss: 10.0900 - val_accuracy10: 0.7420 - val_accuracy20: 0.7199 - val_accuracy30: 0.6909 - val_accuracy50: 0.6333 - 62s/epoch - 28ms/step
Epoch 5/50
2257/2257 - 62s - loss: 9.7552 - accuracy10: 0.6298 - accuracy20: 0.6212 - accuracy30: 0.6038 - accuracy50: 0.5803 - val_loss: 10.1330 - val_accuracy10: 0.7376 - val_accuracy20: 0.7182 - val_accuracy30: 0.6905 - val_accuracy50: 0.6335 - 62s/epoch - 27ms/step
Epoch 6/50
2257/2257 - 62s - loss: 9.6129 - accuracy10: 0.6396 - accuracy20: 0.6316 - accuracy30: 0.6130 - accuracy50: 0.5869 - val_loss: 9.9434 - val_accuracy10: 0.7410 - val_accuracy20: 0.7215 - val_accuracy30: 0.6919 - val_accuracy50: 0.6341 - 62s/epoch - 28ms/step
Epoch 7/50
2257/2257 - 63s - loss: 9.5105 - accuracy10: 0.6448 - accuracy20: 0.6367 - accuracy30: 0.6178 - accuracy50: 0.5902 - val_loss: 9.9618 - val_accuracy10: 0.7551 - val_accuracy20: 0.7328 - val_accuracy30: 0.7019 - val_accuracy50: 0.6406 - 63s/epoch - 28ms/step
Epoch 8/50
2257/2257 - 62s - loss: 9.4400 - accuracy10: 0.6505 - accuracy20: 0.6416 - accuracy30: 0.6219 - accuracy50: 0.5934 - val_loss: 9.9449 - val_accuracy10: 0.7523 - val_accuracy20: 0.7309 - val_accuracy30: 0.7016 - val_accuracy50: 0.6421 - 62s/epoch - 28ms/step
Epoch 9/50
2257/2257 - 62s - loss: 9.3827 - accuracy10: 0.6527 - accuracy20: 0.6428 - accuracy30: 0.6229 - accuracy50: 0.5950 - val_loss: 9.8768 - val_accuracy10: 0.7554 - val_accuracy20: 0.7335 - val_accuracy30: 0.7034 - val_accuracy50: 0.6431 - 62s/epoch - 28ms/step
Epoch 10/50
2257/2257 - 63s - loss: 9.3388 - accuracy10: 0.6564 - accuracy20: 0.6457 - accuracy30: 0.6251 - accuracy50: 0.5964 - val_loss: 9.9274 - val_accuracy10: 0.7617 - val_accuracy20: 0.7388 - val_accuracy30: 0.7073 - val_accuracy50: 0.6446 - 63s/epoch - 28ms/step
Epoch 11/50
2257/2257 - 63s - loss: 9.3047 - accuracy10: 0.6574 - accuracy20: 0.6463 - accuracy30: 0.6262 - accuracy50: 0.5977 - val_loss: 9.8110 - val_accuracy10: 0.7448 - val_accuracy20: 0.7289 - val_accuracy30: 0.7015 - val_accuracy50: 0.6450 - 63s/epoch - 28ms/step
Epoch 12/50
2257/2257 - 62s - loss: 9.2730 - accuracy10: 0.6599 - accuracy20: 0.6479 - accuracy30: 0.6268 - accuracy50: 0.5979 - val_loss: 9.8604 - val_accuracy10: 0.7591 - val_accuracy20: 0.7371 - val_accuracy30: 0.7066 - val_accuracy50: 0.6467 - 62s/epoch - 28ms/step
Epoch 13/50
2257/2257 - 63s - loss: 9.2379 - accuracy10: 0.6621 - accuracy20: 0.6499 - accuracy30: 0.6289 - accuracy50: 0.5992 - val_loss: 9.7398 - val_accuracy10: 0.7397 - val_accuracy20: 0.7227 - val_accuracy30: 0.6958 - val_accuracy50: 0.6408 - 63s/epoch - 28ms/step
Epoch 14/50
2257/2257 - 63s - loss: 9.2137 - accuracy10: 0.6628 - accuracy20: 0.6510 - accuracy30: 0.6296 - accuracy50: 0.6000 - val_loss: 9.7300 - val_accuracy10: 0.7383 - val_accuracy20: 0.7214 - val_accuracy30: 0.6952 - val_accuracy50: 0.6405 - 63s/epoch - 28ms/step
Epoch 15/50
2257/2257 - 62s - loss: 9.1875 - accuracy10: 0.6646 - accuracy20: 0.6522 - accuracy30: 0.6305 - accuracy50: 0.6006 - val_loss: 9.6895 - val_accuracy10: 0.7328 - val_accuracy20: 0.7190 - val_accuracy30: 0.6947 - val_accuracy50: 0.6415 - 62s/epoch - 28ms/step
Epoch 16/50
2257/2257 - 62s - loss: 9.1649 - accuracy10: 0.6643 - accuracy20: 0.6517 - accuracy30: 0.6305 - accuracy50: 0.6017 - val_loss: 9.7797 - val_accuracy10: 0.7420 - val_accuracy20: 0.7249 - val_accuracy30: 0.6999 - val_accuracy50: 0.6443 - 62s/epoch - 28ms/step
Epoch 17/50
2257/2257 - 63s - loss: 9.1379 - accuracy10: 0.6654 - accuracy20: 0.6531 - accuracy30: 0.6321 - accuracy50: 0.6031 - val_loss: 9.7100 - val_accuracy10: 0.7343 - val_accuracy20: 0.7187 - val_accuracy30: 0.6949 - val_accuracy50: 0.6421 - 63s/epoch - 28ms/step
Epoch 18/50
2257/2257 - 62s - loss: 9.1183 - accuracy10: 0.6651 - accuracy20: 0.6533 - accuracy30: 0.6324 - accuracy50: 0.6026 - val_loss: 9.7474 - val_accuracy10: 0.7498 - val_accuracy20: 0.7300 - val_accuracy30: 0.7028 - val_accuracy50: 0.6455 - 62s/epoch - 28ms/step
Epoch 19/50
2257/2257 - 63s - loss: 9.0992 - accuracy10: 0.6658 - accuracy20: 0.6537 - accuracy30: 0.6328 - accuracy50: 0.6039 - val_loss: 9.7000 - val_accuracy10: 0.7484 - val_accuracy20: 0.7280 - val_accuracy30: 0.7015 - val_accuracy50: 0.6457 - 63s/epoch - 28ms/step
Epoch 20/50
2257/2257 - 63s - loss: 9.0779 - accuracy10: 0.6682 - accuracy20: 0.6551 - accuracy30: 0.6339 - accuracy50: 0.6043 - val_loss: 9.7114 - val_accuracy10: 0.7455 - val_accuracy20: 0.7270 - val_accuracy30: 0.7012 - val_accuracy50: 0.6445 - 63s/epoch - 28ms/step
Epoch 21/50
2257/2257 - 63s - loss: 9.0625 - accuracy10: 0.6676 - accuracy20: 0.6553 - accuracy30: 0.6344 - accuracy50: 0.6052 - val_loss: 9.7338 - val_accuracy10: 0.7458 - val_accuracy20: 0.7264 - val_accuracy30: 0.7016 - val_accuracy50: 0.6451 - 63s/epoch - 28ms/step
Epoch 22/50
2257/2257 - 62s - loss: 9.0420 - accuracy10: 0.6685 - accuracy20: 0.6560 - accuracy30: 0.6355 - accuracy50: 0.6061 - val_loss: 9.7532 - val_accuracy10: 0.7464 - val_accuracy20: 0.7261 - val_accuracy30: 0.7016 - val_accuracy50: 0.6466 - 62s/epoch - 27ms/step
Epoch 23/50
2257/2257 - 64s - loss: 9.0235 - accuracy10: 0.6688 - accuracy20: 0.6562 - accuracy30: 0.6356 - accuracy50: 0.6059 - val_loss: 9.7468 - val_accuracy10: 0.7379 - val_accuracy20: 0.7193 - val_accuracy30: 0.6960 - val_accuracy50: 0.6430 - 64s/epoch - 28ms/step
Epoch 24/50
2257/2257 - 64s - loss: 9.0073 - accuracy10: 0.6686 - accuracy20: 0.6565 - accuracy30: 0.6359 - accuracy50: 0.6063 - val_loss: 9.7511 - val_accuracy10: 0.7323 - val_accuracy20: 0.7152 - val_accuracy30: 0.6919 - val_accuracy50: 0.6403 - 64s/epoch - 28ms/step
Epoch 25/50
2257/2257 - 63s - loss: 8.9927 - accuracy10: 0.6702 - accuracy20: 0.6575 - accuracy30: 0.6360 - accuracy50: 0.6069 - val_loss: 9.8394 - val_accuracy10: 0.7131 - val_accuracy20: 0.7005 - val_accuracy30: 0.6815 - val_accuracy50: 0.6351 - 63s/epoch - 28ms/step
testing model: results/AAL/W1/deepVOL_L2/seq2seq
Evaluating performance on  test set...
7177/7177 - 66s - 66s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.60599047
{'0': {'precision': 0.39734372114109173, 'recall': 0.5701406523299909, 'f1-score': 0.4683110437387942, 'support': 207533}, '1': {'precision': 0.9056752045608351, 'recall': 0.7757809376521666, 'f1-score': 0.8357108362966966, 'support': 1423193}, '2': {'precision': 0.4046354327684251, 'recall': 0.627903257851456, 'f1-score': 0.4921305298979096, 'support': 206363}, 'accuracy': 0.7359387596354885, 'macro avg': {'precision': 0.5692181194901174, 'recall': 0.6579416159445378, 'f1-score': 0.5987174699778001, 'support': 1837089}, 'weighted avg': {'precision': 0.7919672523740077, 'recall': 0.7359387596354885, 'f1-score': 0.7556113724610892, 'support': 1837089}}
[[ 118323   58844   30366]
 [ 158820 1104086  160287]
 [  20642   56145  129576]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.65412384
{'0': {'precision': 0.48145706279874734, 'recall': 0.514497884587609, 'f1-score': 0.4974294087895657, 'support': 283869}, '1': {'precision': 0.8354619834710744, 'recall': 0.7942826926642844, 'f1-score': 0.8143520927752169, 'support': 1272732}, '2': {'precision': 0.48424502454137436, 'recall': 0.5589151764068339, 'f1-score': 0.5189076290864195, 'support': 280488}, 'accuracy': 0.7151139656271417, 'macro avg': {'precision': 0.600388023603732, 'recall': 0.6225652512195757, 'f1-score': 0.6102297102170674, 'support': 1837089}, 'weighted avg': {'precision': 0.727136711694581, 'recall': 0.7151139656271417, 'f1-score': 0.7202721913053011, 'support': 1837089}}
[[ 146050  102710   35109]
 [ 129962 1010909  131861]
 [  27338   96381  156769]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7199708
{'0': {'precision': 0.5227731746485257, 'recall': 0.4653731352010314, 'f1-score': 0.49240601085120733, 'support': 342061}, '1': {'precision': 0.768964961431985, 'recall': 0.7991153338393009, 'f1-score': 0.7837502884495282, 'support': 1158177}, '2': {'precision': 0.5183101417029891, 'recall': 0.506226788698861, 'f1-score': 0.5121972098779152, 'support': 336851}, 'accuracy': 0.6832690196283359, 'macro avg': {'precision': 0.6033494259278332, 'recall': 0.5902384192463977, 'f1-score': 0.5961178363928835, 'support': 1837089}, 'weighted avg': {'precision': 0.6771643271352967, 'recall': 0.6832690196283359, 'f1-score': 0.6797104509623484, 'support': 1837089}}
[[159186 144328  38547]
 [112732 925517 119928]
 [ 32585 133743 170523]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8426524
{'0': {'precision': 0.5579757790510492, 'recall': 0.3955773955773956, 'f1-score': 0.462947660067909, 'support': 435490}, '1': {'precision': 0.6489846639838801, 'recall': 0.8024385165400431, 'f1-score': 0.7175995230232985, 'support': 974937}, '2': {'precision': 0.5518899917927436, 'recall': 0.4176537868382935, 'f1-score': 0.475479189430416, 'support': 426662}, 'accuracy': 0.6166244531429887, 'macro avg': {'precision': 0.5862834782758909, 'recall': 0.5385565663185774, 'f1-score': 0.5520087908405412, 'support': 1837089}, 'weighted avg': {'precision': 0.6048604727629794, 'recall': 0.6166244531429887, 'f1-score': 0.6010009882926193, 'support': 1837089}}
[[172270 218371  44849]
 [ 92771 782327  99839]
 [ 43700 204765 178197]]
Evaluating performance on  train set...
2257/2257 - 22s - 22s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6675304
{'0': {'precision': 0.3672023156003593, 'recall': 0.6010188017940417, 'f1-score': 0.4558782942723735, 'support': 67334}, '1': {'precision': 0.9133960922907787, 'recall': 0.716433442514893, 'f1-score': 0.8030134352149381, 'support': 442993}, '2': {'precision': 0.36896054178933935, 'recall': 0.6578336902212705, 'f1-score': 0.4727620533591241, 'support': 67248}, 'accuracy': 0.6961554776435961, 'macro avg': {'precision': 0.5498529832268259, 'recall': 0.6584286448434017, 'f1-score': 0.5772179276154786, 'support': 577575}, 'weighted avg': {'precision': 0.7863310121543574, 'recall': 0.6961554776435961, 'f1-score': 0.7240925288265618, 'support': 577575}}
[[ 40469  15750  11115]
 [ 61072 317375  64546]
 [  8668  14342  44238]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6945985
{'0': {'precision': 0.4499378219932492, 'recall': 0.5554532096409851, 'f1-score': 0.4971586168991137, 'support': 91194}, '1': {'precision': 0.85028660367387, 'recall': 0.7389909727111899, 'f1-score': 0.7907418234157552, 'support': 396243}, '2': {'precision': 0.445882421217573, 'recall': 0.5966518005724556, 'f1-score': 0.5103651158928614, 'support': 90138}, 'accuracy': 0.687798121456088, 'macro avg': {'precision': 0.5820356156282307, 'recall': 0.6303653276415435, 'f1-score': 0.5994218520692435, 'support': 577575}, 'weighted avg': {'precision': 0.7239625920825992, 'recall': 0.687798121456088, 'f1-score': 0.7006312358768603, 'support': 577575}}
[[ 50654  26769  13771]
 [ 50358 292820  53065]
 [ 11568  24789  53781]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.73956066
{'0': {'precision': 0.4921091523276681, 'recall': 0.5163705173766557, 'f1-score': 0.5039480025764489, 'support': 108335}, '1': {'precision': 0.7927321787075137, 'recall': 0.7468108042535476, 'f1-score': 0.7690866217967738, 'support': 362709}, '2': {'precision': 0.48207461477401986, 'recall': 0.5529845772592016, 'f1-score': 0.5151006417991361, 'support': 106531}, 'accuracy': 0.6678370774358309, 'macro avg': {'precision': 0.5889719819364005, 'recall': 0.6053886329631349, 'f1-score': 0.5960450887241197, 'support': 577575}, 'weighted avg': {'precision': 0.679045373519859, 'recall': 0.6678370774358309, 'f1-score': 0.672508389102557, 'support': 577575}}
[[ 55941  36994  15400]
 [ 43943 270875  47891]
 [ 13792  33829  58910]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.82729536
{'0': {'precision': 0.5341325398599955, 'recall': 0.46096527360303996, 'f1-score': 0.4948589958609041, 'support': 134739}, '1': {'precision': 0.6883693859166793, 'recall': 0.7564116573250372, 'f1-score': 0.7207882889780418, 'support': 311152}, '2': {'precision': 0.5216400720358504, 'recall': 0.47292002065550864, 'f1-score': 0.49608673312913976, 'support': 131684}, 'accuracy': 0.6228541747824958, 'macro avg': {'precision': 0.5813806659375084, 'recall': 0.5634323171945286, 'f1-score': 0.5705780059893618, 'support': 577575}, 'weighted avg': {'precision': 0.6143750105196926, 'recall': 0.6228541747824958, 'f1-score': 0.6168518535268591, 'support': 577575}}
[[ 62110  55074  17555]
 [ 36239 235359  39554]
 [ 17933  51475  62276]]
Evaluating performance on  val set...
638/638 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.61757284
{'0': {'precision': 0.3977842970740369, 'recall': 0.5801058320198154, 'f1-score': 0.4719487062056332, 'support': 17764}, '1': {'precision': 0.9151871367469372, 'recall': 0.7674226965939412, 'f1-score': 0.8348166835277697, 'support': 127420}, '2': {'precision': 0.3794930498773508, 'recall': 0.6394951499118166, 'f1-score': 0.47632340565282544, 'support': 18144}, 'accuracy': 0.7328382151253918, 'macro avg': {'precision': 0.5641548278994416, 'recall': 0.6623412261751911, 'f1-score': 0.5943629317954094, 'support': 163328}, 'weighted avg': {'precision': 0.7994030852915152, 'recall': 0.7328382151253918, 'f1-score': 0.755525387590065, 'support': 163328}}
[[10305  4496  2963]
 [13626 97785 16009]
 [ 1975  4566 11603]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.65145934
{'0': {'precision': 0.4862072880009082, 'recall': 0.5297464440321583, 'f1-score': 0.5070439209186693, 'support': 24255}, '1': {'precision': 0.8542288087596753, 'recall': 0.7888923758216085, 'f1-score': 0.8202615860124901, 'support': 114714}, '2': {'precision': 0.45234327056619617, 'recall': 0.5749415000615788, 'f1-score': 0.5063268257411424, 'support': 24359}, 'accuracy': 0.7184989713949843, 'macro avg': {'precision': 0.5975931224422598, 'recall': 0.6311934399717819, 'f1-score': 0.6112107775574339, 'support': 163328}, 'weighted avg': {'precision': 0.7396379742985979, 'recall': 0.7184989713949843, 'f1-score': 0.7269265100163328, 'support': 163328}}
[[12849  7823  3583]
 [10844 90497 13373]
 [ 2734  7620 14005]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.70244205
{'0': {'precision': 0.5274011193329077, 'recall': 0.48578051480763906, 'f1-score': 0.5057359482774146, 'support': 28904}, '1': {'precision': 0.7987682013458541, 'recall': 0.7965650265869217, 'f1-score': 0.797665092660703, 'support': 105503}, '2': {'precision': 0.48664782650112726, 'recall': 0.5299263510943605, 'f1-score': 0.5073658423544212, 'support': 28921}, 'accuracy': 0.694351244122257, 'macro avg': {'precision': 0.6042723823932964, 'recall': 0.6040906308296404, 'f1-score': 0.6035889610975129, 'support': 163328}, 'weighted avg': {'precision': 0.6954764969266084, 'recall': 0.694351244122257, 'f1-score': 0.6945984745219727, 'support': 163328}}
[[14041 10937  3926]
 [ 9222 84040 12241]
 [ 3360 10235 15326]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.80226004
{'0': {'precision': 0.5585559142941003, 'recall': 0.4222320834257821, 'f1-score': 0.48091988880465, 'support': 36056}, '1': {'precision': 0.6971826966976107, 'recall': 0.801511191785765, 'f1-score': 0.7457156373514017, 'support': 91451}, '2': {'precision': 0.5207201965347815, 'recall': 0.4497082716842076, 'f1-score': 0.48261605524514284, 'support': 35821}, 'accuracy': 0.640625, 'macro avg': {'precision': 0.5921529358421642, 'recall': 0.5578171822985849, 'f1-score': 0.5697505271337314, 'support': 163328}, 'weighted avg': {'precision': 0.6278780429660173, 'recall': 0.640625, 'f1-score': 0.6295569527398839, 'support': 163328}}
[[15224 16559  4273]
 [ 7598 73299 10554]
 [ 4434 15278 16109]]
training model: results/AAL/W1/deepVOL_L3/seq2seq
Epoch 1/50
2257/2257 - 99s - loss: 11.3734 - accuracy10: 0.4654 - accuracy20: 0.4806 - accuracy30: 0.4899 - accuracy50: 0.4974 - val_loss: 10.7080 - val_accuracy10: 0.7199 - val_accuracy20: 0.6945 - val_accuracy30: 0.6708 - val_accuracy50: 0.6221 - 99s/epoch - 44ms/step
Epoch 2/50
2257/2257 - 92s - loss: 10.1875 - accuracy10: 0.5987 - accuracy20: 0.5980 - accuracy30: 0.5904 - accuracy50: 0.5745 - val_loss: 10.5890 - val_accuracy10: 0.7392 - val_accuracy20: 0.7190 - val_accuracy30: 0.6924 - val_accuracy50: 0.6349 - 92s/epoch - 41ms/step
Epoch 3/50
2257/2257 - 91s - loss: 9.8899 - accuracy10: 0.6265 - accuracy20: 0.6178 - accuracy30: 0.6036 - accuracy50: 0.5829 - val_loss: 10.5774 - val_accuracy10: 0.7792 - val_accuracy20: 0.7464 - val_accuracy30: 0.7120 - val_accuracy50: 0.6449 - 91s/epoch - 40ms/step
Epoch 4/50
2257/2257 - 92s - loss: 9.6837 - accuracy10: 0.6374 - accuracy20: 0.6263 - accuracy30: 0.6112 - accuracy50: 0.5894 - val_loss: 10.2260 - val_accuracy10: 0.7621 - val_accuracy20: 0.7349 - val_accuracy30: 0.7046 - val_accuracy50: 0.6436 - 92s/epoch - 41ms/step
Epoch 5/50
2257/2257 - 92s - loss: 9.5081 - accuracy10: 0.6461 - accuracy20: 0.6335 - accuracy30: 0.6158 - accuracy50: 0.5914 - val_loss: 10.2640 - val_accuracy10: 0.7693 - val_accuracy20: 0.7396 - val_accuracy30: 0.7069 - val_accuracy50: 0.6439 - 92s/epoch - 41ms/step
Epoch 6/50
2257/2257 - 93s - loss: 9.3947 - accuracy10: 0.6501 - accuracy20: 0.6373 - accuracy30: 0.6196 - accuracy50: 0.5948 - val_loss: 10.1017 - val_accuracy10: 0.7625 - val_accuracy20: 0.7356 - val_accuracy30: 0.7046 - val_accuracy50: 0.6426 - 93s/epoch - 41ms/step
Epoch 7/50
2257/2257 - 92s - loss: 9.3135 - accuracy10: 0.6533 - accuracy20: 0.6406 - accuracy30: 0.6228 - accuracy50: 0.5967 - val_loss: 10.1629 - val_accuracy10: 0.7660 - val_accuracy20: 0.7390 - val_accuracy30: 0.7073 - val_accuracy50: 0.6436 - 92s/epoch - 41ms/step
Epoch 8/50
2257/2257 - 93s - loss: 9.2530 - accuracy10: 0.6563 - accuracy20: 0.6437 - accuracy30: 0.6250 - accuracy50: 0.5986 - val_loss: 9.9965 - val_accuracy10: 0.7573 - val_accuracy20: 0.7334 - val_accuracy30: 0.7036 - val_accuracy50: 0.6426 - 93s/epoch - 41ms/step
Epoch 9/50
2257/2257 - 93s - loss: 9.2073 - accuracy10: 0.6580 - accuracy20: 0.6461 - accuracy30: 0.6279 - accuracy50: 0.6004 - val_loss: 9.9142 - val_accuracy10: 0.7470 - val_accuracy20: 0.7254 - val_accuracy30: 0.6974 - val_accuracy50: 0.6395 - 93s/epoch - 41ms/step
Epoch 10/50
2257/2257 - 94s - loss: 9.1704 - accuracy10: 0.6613 - accuracy20: 0.6483 - accuracy30: 0.6291 - accuracy50: 0.6012 - val_loss: 9.7799 - val_accuracy10: 0.7590 - val_accuracy20: 0.7364 - val_accuracy30: 0.7064 - val_accuracy50: 0.6459 - 94s/epoch - 41ms/step
Epoch 11/50
2257/2257 - 92s - loss: 9.1229 - accuracy10: 0.6621 - accuracy20: 0.6500 - accuracy30: 0.6310 - accuracy50: 0.6025 - val_loss: 9.7221 - val_accuracy10: 0.7591 - val_accuracy20: 0.7354 - val_accuracy30: 0.7058 - val_accuracy50: 0.6450 - 92s/epoch - 41ms/step
Epoch 12/50
2257/2257 - 94s - loss: 9.0941 - accuracy10: 0.6640 - accuracy20: 0.6516 - accuracy30: 0.6323 - accuracy50: 0.6039 - val_loss: 9.7179 - val_accuracy10: 0.7537 - val_accuracy20: 0.7329 - val_accuracy30: 0.7037 - val_accuracy50: 0.6453 - 94s/epoch - 41ms/step
Epoch 13/50
2257/2257 - 94s - loss: 9.0674 - accuracy10: 0.6650 - accuracy20: 0.6523 - accuracy30: 0.6334 - accuracy50: 0.6040 - val_loss: 9.6568 - val_accuracy10: 0.7529 - val_accuracy20: 0.7335 - val_accuracy30: 0.7053 - val_accuracy50: 0.6470 - 94s/epoch - 41ms/step
Epoch 14/50
2257/2257 - 94s - loss: 9.0384 - accuracy10: 0.6662 - accuracy20: 0.6541 - accuracy30: 0.6347 - accuracy50: 0.6056 - val_loss: 9.7211 - val_accuracy10: 0.7574 - val_accuracy20: 0.7359 - val_accuracy30: 0.7068 - val_accuracy50: 0.6466 - 94s/epoch - 42ms/step
Epoch 15/50
2257/2257 - 94s - loss: 9.0074 - accuracy10: 0.6665 - accuracy20: 0.6545 - accuracy30: 0.6359 - accuracy50: 0.6063 - val_loss: 9.7245 - val_accuracy10: 0.7470 - val_accuracy20: 0.7296 - val_accuracy30: 0.7034 - val_accuracy50: 0.6464 - 94s/epoch - 41ms/step
Epoch 16/50
2257/2257 - 93s - loss: 8.9913 - accuracy10: 0.6676 - accuracy20: 0.6549 - accuracy30: 0.6359 - accuracy50: 0.6065 - val_loss: 9.7146 - val_accuracy10: 0.7470 - val_accuracy20: 0.7287 - val_accuracy30: 0.7022 - val_accuracy50: 0.6447 - 93s/epoch - 41ms/step
Epoch 17/50
2257/2257 - 94s - loss: 8.9642 - accuracy10: 0.6685 - accuracy20: 0.6555 - accuracy30: 0.6363 - accuracy50: 0.6074 - val_loss: 9.7319 - val_accuracy10: 0.7440 - val_accuracy20: 0.7274 - val_accuracy30: 0.7017 - val_accuracy50: 0.6450 - 94s/epoch - 42ms/step
Epoch 18/50
2257/2257 - 94s - loss: 8.9454 - accuracy10: 0.6700 - accuracy20: 0.6568 - accuracy30: 0.6379 - accuracy50: 0.6083 - val_loss: 9.7555 - val_accuracy10: 0.7459 - val_accuracy20: 0.7264 - val_accuracy30: 0.7012 - val_accuracy50: 0.6442 - 94s/epoch - 42ms/step
Epoch 19/50
2257/2257 - 94s - loss: 8.9286 - accuracy10: 0.6692 - accuracy20: 0.6565 - accuracy30: 0.6378 - accuracy50: 0.6090 - val_loss: 9.7365 - val_accuracy10: 0.7424 - val_accuracy20: 0.7256 - val_accuracy30: 0.6998 - val_accuracy50: 0.6448 - 94s/epoch - 42ms/step
Epoch 20/50
2257/2257 - 94s - loss: 8.9093 - accuracy10: 0.6710 - accuracy20: 0.6576 - accuracy30: 0.6390 - accuracy50: 0.6090 - val_loss: 9.6268 - val_accuracy10: 0.7438 - val_accuracy20: 0.7258 - val_accuracy30: 0.7004 - val_accuracy50: 0.6457 - 94s/epoch - 42ms/step
Epoch 21/50
2257/2257 - 94s - loss: 8.8852 - accuracy10: 0.6715 - accuracy20: 0.6589 - accuracy30: 0.6393 - accuracy50: 0.6096 - val_loss: 9.7254 - val_accuracy10: 0.7466 - val_accuracy20: 0.7275 - val_accuracy30: 0.7014 - val_accuracy50: 0.6460 - 94s/epoch - 42ms/step
Epoch 22/50
2257/2257 - 94s - loss: 8.8733 - accuracy10: 0.6710 - accuracy20: 0.6581 - accuracy30: 0.6397 - accuracy50: 0.6104 - val_loss: 9.7041 - val_accuracy10: 0.7470 - val_accuracy20: 0.7280 - val_accuracy30: 0.7014 - val_accuracy50: 0.6455 - 94s/epoch - 42ms/step
Epoch 23/50
2257/2257 - 93s - loss: 8.8530 - accuracy10: 0.6715 - accuracy20: 0.6592 - accuracy30: 0.6405 - accuracy50: 0.6112 - val_loss: 9.6968 - val_accuracy10: 0.7417 - val_accuracy20: 0.7237 - val_accuracy30: 0.6987 - val_accuracy50: 0.6439 - 93s/epoch - 41ms/step
Epoch 24/50
2257/2257 - 94s - loss: 8.8421 - accuracy10: 0.6712 - accuracy20: 0.6591 - accuracy30: 0.6407 - accuracy50: 0.6116 - val_loss: 9.8055 - val_accuracy10: 0.7369 - val_accuracy20: 0.7204 - val_accuracy30: 0.6965 - val_accuracy50: 0.6436 - 94s/epoch - 42ms/step
Epoch 25/50
2257/2257 - 92s - loss: 8.8275 - accuracy10: 0.6720 - accuracy20: 0.6591 - accuracy30: 0.6404 - accuracy50: 0.6113 - val_loss: 9.7476 - val_accuracy10: 0.7379 - val_accuracy20: 0.7204 - val_accuracy30: 0.6959 - val_accuracy50: 0.6419 - 92s/epoch - 41ms/step
Epoch 26/50
2257/2257 - 94s - loss: 8.8125 - accuracy10: 0.6716 - accuracy20: 0.6597 - accuracy30: 0.6410 - accuracy50: 0.6120 - val_loss: 9.7175 - val_accuracy10: 0.7440 - val_accuracy20: 0.7237 - val_accuracy30: 0.6978 - val_accuracy50: 0.6424 - 94s/epoch - 42ms/step
Epoch 27/50
2257/2257 - 92s - loss: 8.7903 - accuracy10: 0.6722 - accuracy20: 0.6602 - accuracy30: 0.6420 - accuracy50: 0.6126 - val_loss: 9.6889 - val_accuracy10: 0.7383 - val_accuracy20: 0.7204 - val_accuracy30: 0.6955 - val_accuracy50: 0.6424 - 92s/epoch - 41ms/step
Epoch 28/50
2257/2257 - 94s - loss: 8.7805 - accuracy10: 0.6723 - accuracy20: 0.6598 - accuracy30: 0.6414 - accuracy50: 0.6126 - val_loss: 9.6321 - val_accuracy10: 0.7367 - val_accuracy20: 0.7192 - val_accuracy30: 0.6948 - val_accuracy50: 0.6424 - 94s/epoch - 42ms/step
Epoch 29/50
2257/2257 - 93s - loss: 8.7661 - accuracy10: 0.6725 - accuracy20: 0.6600 - accuracy30: 0.6418 - accuracy50: 0.6130 - val_loss: 9.8147 - val_accuracy10: 0.7454 - val_accuracy20: 0.7250 - val_accuracy30: 0.6992 - val_accuracy50: 0.6445 - 93s/epoch - 41ms/step
Epoch 30/50
2257/2257 - 93s - loss: 8.7442 - accuracy10: 0.6734 - accuracy20: 0.6608 - accuracy30: 0.6423 - accuracy50: 0.6134 - val_loss: 9.7708 - val_accuracy10: 0.7430 - val_accuracy20: 0.7226 - val_accuracy30: 0.6967 - val_accuracy50: 0.6424 - 93s/epoch - 41ms/step
testing model: results/AAL/W1/deepVOL_L3/seq2seq
Evaluating performance on  test set...
7177/7177 - 130s - 130s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6282891
{'0': {'precision': 0.3607121332529748, 'recall': 0.6517614066196701, 'f1-score': 0.46440373618714587, 'support': 207533}, '1': {'precision': 0.9057909806310066, 'recall': 0.7617751071007235, 'f1-score': 0.8275642283174802, 'support': 1423193}, '2': {'precision': 0.4321693879859723, 'recall': 0.5553660297630874, 'f1-score': 0.4860832186413828, 'support': 206363}, 'accuracy': 0.7261607902502274, 'macro avg': {'precision': 0.5662241672899846, 'recall': 0.6563008478278269, 'f1-score': 0.5926837277153363, 'support': 1837089}, 'weighted avg': {'precision': 0.7910116633764195, 'recall': 0.7261607902502274, 'f1-score': 0.7481794886488671, 'support': 1837089}}
[[ 135262   50679   21592]
 [ 210049 1084153  128991]
 [  29675   62081  114607]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6770465
{'0': {'precision': 0.43963350552074243, 'recall': 0.5909310280446263, 'f1-score': 0.5041762469380701, 'support': 283869}, '1': {'precision': 0.8370177903773046, 'recall': 0.7755277623254542, 'f1-score': 0.8051003990676865, 'support': 1272732}, '2': {'precision': 0.5099838940263125, 'recall': 0.5023601722711845, 'f1-score': 0.5061433269334732, 'support': 280488}, 'accuracy': 0.7052962594626607, 'macro avg': {'precision': 0.59554506330812, 'recall': 0.622939654213755, 'f1-score': 0.6051399909797432, 'support': 1837089}, 'weighted avg': {'precision': 0.7256817783073153, 'recall': 0.7052962594626607, 'f1-score': 0.7129563007743195, 'support': 1837089}}
[[167747  89874  26248]
 [176552 987039 109141]
 [ 37262 102320 140906]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7393241
{'0': {'precision': 0.4793011167721682, 'recall': 0.5445403012912902, 'f1-score': 0.5098421883147366, 'support': 342061}, '1': {'precision': 0.7712727222999053, 'recall': 0.7791434297175648, 'f1-score': 0.775188098135319, 'support': 1158177}, '2': {'precision': 0.5466131366416134, 'recall': 0.45188228623337917, 'f1-score': 0.49475398326735187, 'support': 336851}, 'accuracy': 0.6754539382686413, 'macro avg': {'precision': 0.5990623252378956, 'recall': 0.5918553390807447, 'f1-score': 0.5932614232391358, 'support': 1837089}, 'weighted avg': {'precision': 0.675714529176434, 'recall': 0.6754539382686413, 'f1-score': 0.6743606481388692, 'support': 1837089}}
[[186266 126835  28960]
 [158495 902386  97296]
 [ 43859 140775 152217]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8514345
{'0': {'precision': 0.5173362120570769, 'recall': 0.474286435968679, 'f1-score': 0.4948768540181925, 'support': 435490}, '1': {'precision': 0.6552651363076281, 'recall': 0.7751023912314334, 'f1-score': 0.710163736611762, 'support': 974937}, '2': {'precision': 0.5729389566445655, 'recall': 0.3821737112749671, 'f1-score': 0.45850550359009257, 'support': 426662}, 'accuracy': 0.6125353752594458, 'macro avg': {'precision': 0.5818467683364235, 'recall': 0.5438541794916931, 'f1-score': 0.5545153647400157, 'support': 1837089}, 'weighted avg': {'precision': 0.6034483110535036, 'recall': 0.6125353752594458, 'f1-score': 0.6006816758525038, 'support': 1837089}}
[[206547 191147  37796]
 [135515 755676  83746]
 [ 57189 206414 163059]]
Evaluating performance on  train set...
2257/2257 - 42s - 42s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.66775304
{'0': {'precision': 0.3520558060613678, 'recall': 0.6655775685389254, 'f1-score': 0.4605203666406346, 'support': 67334}, '1': {'precision': 0.9121570014938617, 'recall': 0.7332869819613402, 'f1-score': 0.8129998485828733, 'support': 442993}, '2': {'precision': 0.40941871209626884, 'recall': 0.5732215084463479, 'f1-score': 0.4776674246132304, 'support': 67248}, 'accuracy': 0.7067566982642947, 'macro avg': {'precision': 0.5578771732171661, 'recall': 0.6573620196488711, 'f1-score': 0.5837292132789128, 'support': 577575}, 'weighted avg': {'precision': 0.7883254672711877, 'recall': 0.7067566982642947, 'f1-score': 0.7328643020578173, 'support': 577575}}
[[ 44816  14498   8020]
 [ 70567 324841  47585]
 [ 11915  16785  38548]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6976376
{'0': {'precision': 0.4314839572192513, 'recall': 0.6087352238085839, 'f1-score': 0.5050079599727088, 'support': 91194}, '1': {'precision': 0.8498369497052553, 'recall': 0.7523994114722531, 'f1-score': 0.7981554236301209, 'support': 396243}, '2': {'precision': 0.48654020610150145, 'recall': 0.5295546828196765, 'f1-score': 0.507136975749688, 'support': 90138}, 'accuracy': 0.6949383196987404, 'macro avg': {'precision': 0.589287037675336, 'recall': 0.6302297727001712, 'f1-score': 0.6034334531175058, 'support': 577575}, 'weighted avg': {'precision': 0.7270855759932285, 'recall': 0.6949383196987404, 'f1-score': 0.7064528557284276, 'support': 577575}}
[[ 55513  25013  10668]
 [ 58404 298133  39706]
 [ 14739  27666  47733]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.74217355
{'0': {'precision': 0.47245310719774886, 'recall': 0.5703235334841003, 'f1-score': 0.5167954765967413, 'support': 108335}, '1': {'precision': 0.7922893255602135, 'recall': 0.760240302832298, 'f1-score': 0.7759340186226865, 'support': 362709}, '2': {'precision': 0.523516367797005, 'recall': 0.4853329077920981, 'f1-score': 0.5037020439179316, 'support': 106531}, 'accuracy': 0.6739124788988443, 'macro avg': {'precision': 0.5960862668516558, 'recall': 0.6052989147028321, 'f1-score': 0.5988105130457865, 'support': 577575}, 'weighted avg': {'precision': 0.6827241458350349, 'recall': 0.6739124788988443, 'f1-score': 0.677115824539402, 'support': 577575}}
[[ 61786  34465  12084]
 [ 51989 275746  34974]
 [ 17002  37826  51703]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8254432
{'0': {'precision': 0.5136219025854729, 'recall': 0.5104312782490593, 'f1-score': 0.5120216199314327, 'support': 134739}, '1': {'precision': 0.6916446184318381, 'recall': 0.7620134210932278, 'f1-score': 0.72512581025474, 'support': 311152}, '2': {'precision': 0.5534680361675127, 'recall': 0.4239315330640017, 'f1-score': 0.4801159330546812, 'support': 131684}, 'accuracy': 0.6262424793316885, 'macro avg': {'precision': 0.5862448523949412, 'recall': 0.5654587441354296, 'f1-score': 0.5724211210802846, 'support': 577575}, 'weighted avg': {'precision': 0.6186112500046749, 'recall': 0.6262424793316885, 'f1-score': 0.6195510776759674, 'support': 577575}}
[[ 68775  50751  15213]
 [ 44224 237102  29826]
 [ 20903  54956  55825]]
Evaluating performance on  val set...
638/638 - 11s - 11s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6135366
{'0': {'precision': 0.3863480995351381, 'recall': 0.6362868723260527, 'f1-score': 0.4807741386643981, 'support': 17764}, '1': {'precision': 0.913111542405156, 'recall': 0.7827735049442788, 'f1-score': 0.8429339282997821, 'support': 127420}, '2': {'precision': 0.41690821256038646, 'recall': 0.5707671957671958, 'f1-score': 0.4818537130094919, 'support': 18144}, 'accuracy': 0.7432895768025078, 'macro avg': {'precision': 0.5721226181668936, 'recall': 0.6632758576791757, 'f1-score': 0.6018539266578907, 'support': 163328}, 'weighted avg': {'precision': 0.8006964083445756, 'recall': 0.7432895768025078, 'f1-score': 0.7634322756173885, 'support': 163328}}
[[11303  4221  2240]
 [15435 99741 12244]
 [ 2518  5270 10356]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6508847
{'0': {'precision': 0.4729483897048915, 'recall': 0.5788084930942073, 'f1-score': 0.5205509927881495, 'support': 24255}, '1': {'precision': 0.8536866680929038, 'recall': 0.8000679951880328, 'f1-score': 0.8260081089716186, 'support': 114714}, '2': {'precision': 0.48524966519992346, 'recall': 0.5206289256537625, 'f1-score': 0.5023171069830078, 'support': 24359}, 'accuracy': 0.725533894984326, 'macro avg': {'precision': 0.6039615743325729, 'recall': 0.6331684713120009, 'f1-score': 0.6162920695809254, 'support': 163328}, 'weighted avg': {'precision': 0.7421959016856047, 'recall': 0.725533894984326, 'f1-score': 0.7323704505758101, 'support': 163328}}
[[14039  7321  2895]
 [12377 91779 10558]
 [ 3268  8409 12682]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7011187
{'0': {'precision': 0.5106495568196852, 'recall': 0.5341821201217825, 'f1-score': 0.5221508285424417, 'support': 28904}, '1': {'precision': 0.7987672736483634, 'recall': 0.8070197056007886, 'f1-score': 0.8028722842486421, 'support': 105503}, '2': {'precision': 0.519529038831654, 'recall': 0.4760208844784067, 'f1-score': 0.4968242511728618, 'support': 28921}, 'accuracy': 0.7001249020376176, 'macro avg': {'precision': 0.6096486230999009, 'recall': 0.6057409034003259, 'f1-score': 0.6072824546546486, 'support': 163328}, 'weighted avg': {'precision': 0.698333768821572, 'recall': 0.7001249020376176, 'f1-score': 0.6990003938176281, 'support': 163328}}
[[15440 10213  3251]
 [10879 85143  9481]
 [ 3917 11237 13767]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7989151
{'0': {'precision': 0.5405544478034348, 'recall': 0.46616374528511206, 'f1-score': 0.5006105733432614, 'support': 36056}, '1': {'precision': 0.7023890005046514, 'recall': 0.8066286864003674, 'f1-score': 0.7509085171574865, 'support': 91451}, '2': {'precision': 0.5466539267208115, 'recall': 0.415259205493984, 'f1-score': 0.47198248508693996, 'support': 35821}, 'accuracy': 0.6456333268025078, 'macro avg': {'precision': 0.5965324583429659, 'recall': 0.5626838790598212, 'f1-score': 0.574500525195896, 'support': 163328}, 'weighted avg': {'precision': 0.632506967355369, 'recall': 0.6456333268025078, 'f1-score': 0.634479294630028, 'support': 163328}}
[[16808 15229  4019]
 [ 9367 73767  8317]
 [ 4919 16027 14875]]
training model: results/AAL/W2/deepLOB_L1/seq2seq
Epoch 1/50
2076/2076 - 59s - loss: 11.5139 - accuracy10: 0.4533 - accuracy20: 0.4756 - accuracy30: 0.4842 - accuracy50: 0.4871 - val_loss: 13.5958 - val_accuracy10: 0.6173 - val_accuracy20: 0.5661 - val_accuracy30: 0.5267 - val_accuracy50: 0.4628 - 59s/epoch - 29ms/step
Epoch 2/50
2076/2076 - 53s - loss: 11.3035 - accuracy10: 0.4737 - accuracy20: 0.4958 - accuracy30: 0.5046 - accuracy50: 0.5045 - val_loss: 13.8382 - val_accuracy10: 0.4199 - val_accuracy20: 0.4034 - val_accuracy30: 0.3984 - val_accuracy50: 0.3937 - 53s/epoch - 26ms/step
Epoch 3/50
2076/2076 - 52s - loss: 11.1462 - accuracy10: 0.4841 - accuracy20: 0.5023 - accuracy30: 0.5081 - accuracy50: 0.5062 - val_loss: 12.9097 - val_accuracy10: 0.3941 - val_accuracy20: 0.4092 - val_accuracy30: 0.4211 - val_accuracy50: 0.4328 - 52s/epoch - 25ms/step
Epoch 4/50
2076/2076 - 54s - loss: 10.8165 - accuracy10: 0.5210 - accuracy20: 0.5295 - accuracy30: 0.5281 - accuracy50: 0.5197 - val_loss: 12.2186 - val_accuracy10: 0.4042 - val_accuracy20: 0.4257 - val_accuracy30: 0.4371 - val_accuracy50: 0.4463 - 54s/epoch - 26ms/step
Epoch 5/50
2076/2076 - 52s - loss: 10.5910 - accuracy10: 0.5468 - accuracy20: 0.5500 - accuracy30: 0.5444 - accuracy50: 0.5311 - val_loss: 12.5102 - val_accuracy10: 0.4118 - val_accuracy20: 0.4341 - val_accuracy30: 0.4440 - val_accuracy50: 0.4498 - 52s/epoch - 25ms/step
Epoch 6/50
2076/2076 - 54s - loss: 10.4242 - accuracy10: 0.5692 - accuracy20: 0.5682 - accuracy30: 0.5574 - accuracy50: 0.5394 - val_loss: 12.2850 - val_accuracy10: 0.4246 - val_accuracy20: 0.4415 - val_accuracy30: 0.4478 - val_accuracy50: 0.4519 - 54s/epoch - 26ms/step
Epoch 7/50
2076/2076 - 51s - loss: 10.2819 - accuracy10: 0.5837 - accuracy20: 0.5805 - accuracy30: 0.5675 - accuracy50: 0.5460 - val_loss: 11.9843 - val_accuracy10: 0.4472 - val_accuracy20: 0.4592 - val_accuracy30: 0.4617 - val_accuracy50: 0.4602 - 51s/epoch - 24ms/step
Epoch 8/50
2076/2076 - 54s - loss: 10.1672 - accuracy10: 0.5949 - accuracy20: 0.5899 - accuracy30: 0.5745 - accuracy50: 0.5509 - val_loss: 11.5713 - val_accuracy10: 0.4810 - val_accuracy20: 0.4867 - val_accuracy30: 0.4853 - val_accuracy50: 0.4764 - 54s/epoch - 26ms/step
Epoch 9/50
2076/2076 - 54s - loss: 10.0726 - accuracy10: 0.6031 - accuracy20: 0.5975 - accuracy30: 0.5811 - accuracy50: 0.5552 - val_loss: 11.5841 - val_accuracy10: 0.4491 - val_accuracy20: 0.4586 - val_accuracy30: 0.4617 - val_accuracy50: 0.4603 - 54s/epoch - 26ms/step
Epoch 10/50
2076/2076 - 54s - loss: 9.9852 - accuracy10: 0.6108 - accuracy20: 0.6042 - accuracy30: 0.5863 - accuracy50: 0.5592 - val_loss: 11.5313 - val_accuracy10: 0.4532 - val_accuracy20: 0.4651 - val_accuracy30: 0.4674 - val_accuracy50: 0.4652 - 54s/epoch - 26ms/step
Epoch 11/50
2076/2076 - 54s - loss: 9.9235 - accuracy10: 0.6150 - accuracy20: 0.6083 - accuracy30: 0.5901 - accuracy50: 0.5616 - val_loss: 11.5093 - val_accuracy10: 0.4609 - val_accuracy20: 0.4695 - val_accuracy30: 0.4695 - val_accuracy50: 0.4642 - 54s/epoch - 26ms/step
Epoch 12/50
2076/2076 - 54s - loss: 9.8570 - accuracy10: 0.6201 - accuracy20: 0.6123 - accuracy30: 0.5938 - accuracy50: 0.5645 - val_loss: 11.5524 - val_accuracy10: 0.4876 - val_accuracy20: 0.4925 - val_accuracy30: 0.4884 - val_accuracy50: 0.4756 - 54s/epoch - 26ms/step
Epoch 13/50
2076/2076 - 52s - loss: 9.8134 - accuracy10: 0.6239 - accuracy20: 0.6148 - accuracy30: 0.5959 - accuracy50: 0.5665 - val_loss: 11.5694 - val_accuracy10: 0.4802 - val_accuracy20: 0.4847 - val_accuracy30: 0.4815 - val_accuracy50: 0.4723 - 52s/epoch - 25ms/step
Epoch 14/50
2076/2076 - 54s - loss: 9.7810 - accuracy10: 0.6254 - accuracy20: 0.6158 - accuracy30: 0.5975 - accuracy50: 0.5681 - val_loss: 11.5854 - val_accuracy10: 0.4693 - val_accuracy20: 0.4777 - val_accuracy30: 0.4764 - val_accuracy50: 0.4695 - 54s/epoch - 26ms/step
Epoch 15/50
2076/2076 - 54s - loss: 9.7458 - accuracy10: 0.6276 - accuracy20: 0.6184 - accuracy30: 0.5995 - accuracy50: 0.5700 - val_loss: 11.5257 - val_accuracy10: 0.4765 - val_accuracy20: 0.4843 - val_accuracy30: 0.4821 - val_accuracy50: 0.4734 - 54s/epoch - 26ms/step
Epoch 16/50
2076/2076 - 49s - loss: 9.6966 - accuracy10: 0.6316 - accuracy20: 0.6208 - accuracy30: 0.6014 - accuracy50: 0.5716 - val_loss: 11.6639 - val_accuracy10: 0.4823 - val_accuracy20: 0.4887 - val_accuracy30: 0.4856 - val_accuracy50: 0.4748 - 49s/epoch - 24ms/step
Epoch 17/50
2076/2076 - 54s - loss: 9.6639 - accuracy10: 0.6324 - accuracy20: 0.6220 - accuracy30: 0.6031 - accuracy50: 0.5730 - val_loss: 11.9388 - val_accuracy10: 0.4783 - val_accuracy20: 0.4843 - val_accuracy30: 0.4813 - val_accuracy50: 0.4725 - 54s/epoch - 26ms/step
Epoch 18/50
2076/2076 - 56s - loss: 9.6340 - accuracy10: 0.6347 - accuracy20: 0.6238 - accuracy30: 0.6046 - accuracy50: 0.5741 - val_loss: 11.7215 - val_accuracy10: 0.4828 - val_accuracy20: 0.4886 - val_accuracy30: 0.4846 - val_accuracy50: 0.4737 - 56s/epoch - 27ms/step
Epoch 19/50
2076/2076 - 56s - loss: 9.6110 - accuracy10: 0.6353 - accuracy20: 0.6251 - accuracy30: 0.6062 - accuracy50: 0.5756 - val_loss: 12.0842 - val_accuracy10: 0.4798 - val_accuracy20: 0.4858 - val_accuracy30: 0.4817 - val_accuracy50: 0.4719 - 56s/epoch - 27ms/step
Epoch 20/50
2076/2076 - 53s - loss: 9.5825 - accuracy10: 0.6382 - accuracy20: 0.6270 - accuracy30: 0.6074 - accuracy50: 0.5770 - val_loss: 12.0175 - val_accuracy10: 0.4760 - val_accuracy20: 0.4822 - val_accuracy30: 0.4797 - val_accuracy50: 0.4712 - 53s/epoch - 25ms/step
Epoch 21/50
2076/2076 - 57s - loss: 9.5599 - accuracy10: 0.6395 - accuracy20: 0.6282 - accuracy30: 0.6084 - accuracy50: 0.5773 - val_loss: 12.0811 - val_accuracy10: 0.4704 - val_accuracy20: 0.4780 - val_accuracy30: 0.4764 - val_accuracy50: 0.4707 - 57s/epoch - 28ms/step
testing model: results/AAL/W2/deepLOB_L1/seq2seq
Evaluating performance on  test set...
4856/4856 - 49s - 49s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0459744
{'0': {'precision': 0.3018991277725511, 'recall': 0.7686717443201195, 'f1-score': 0.4335281954758094, 'support': 246308}, '1': {'precision': 0.8390168857050523, 'recall': 0.32709550582442215, 'f1-score': 0.4706898830994693, 'support': 761964}, '2': {'precision': 0.34798992215713526, 'recall': 0.47269991859627586, 'f1-score': 0.40086960921800224, 'support': 234633}, 'accuracy': 0.44209010342705196, 'macro avg': {'precision': 0.4963019785449128, 'recall': 0.5228223895802725, 'f1-score': 0.43502922926442694, 'support': 1242905}, 'weighted avg': {'precision': 0.6398805637343652, 'recall': 0.44209010342705196, 'f1-score': 0.45014498121490154, 'support': 1242905}}
[[189330  25380  31598]
 [336519 249235 176210]
 [101281  22441 110911]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0405697
{'0': {'precision': 0.358661594083036, 'recall': 0.7401544853414477, 'f1-score': 0.4831836602160259, 'support': 307602}, '1': {'precision': 0.7563168648320681, 'recall': 0.32463500271414275, 'f1-score': 0.4542791123990801, 'support': 637402}, '2': {'precision': 0.4069297844419135, 'recall': 0.4569605338686342, 'f1-score': 0.43049643595792725, 'support': 297901}, 'accuracy': 0.4591863416753493, 'macro avg': {'precision': 0.5073027477856725, 'recall': 0.5072500073080749, 'f1-score': 0.4559864028576777, 'support': 1242905}, 'weighted avg': {'precision': 0.5741610948993289, 'recall': 0.4591863416753493, 'f1-score': 0.4557323317707072, 'support': 1242905}}
[[227673  36499  43430]
 [275511 206923 154968]
 [131601  30171 136129]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0436379
{'0': {'precision': 0.3899361069217244, 'recall': 0.7240714093251773, 'f1-score': 0.5068935036215854, 'support': 348862}, '1': {'precision': 0.6888217875334156, 'recall': 0.3188728730820361, 'f1-score': 0.4359387640262665, 'support': 555146}, '2': {'precision': 0.4380902242741332, 'recall': 0.43707675193347834, 'f1-score': 0.43758290128653937, 'support': 338897}, 'accuracy': 0.46483520462143124, 'macro avg': {'precision': 0.5056160395764244, 'recall': 0.49334034478023064, 'f1-score': 0.4601383896447971, 'support': 1242905}, 'weighted avg': {'precision': 0.5365639473095555, 'recall': 0.46483520462143124, 'f1-score': 0.4563028349325682, 'support': 1242905}}
[[252601  44297  51964]
 [240100 177021 138025]
 [155100  35673 148124]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0534222
{'0': {'precision': 0.42606140479623783, 'recall': 0.6946494078059587, 'f1-score': 0.5281706916764362, 'support': 405357}, '1': {'precision': 0.5743583666697994, 'recall': 0.31580780257209873, 'f1-score': 0.40753481750798404, 'support': 445084}, '2': {'precision': 0.4719895637220748, 'recall': 0.40562956092788127, 'f1-score': 0.436300700651868, 'support': 392464}, 'accuracy': 0.4677244037154891, 'macro avg': {'precision': 0.4908031117293707, 'recall': 0.4720289237686462, 'f1-score': 0.4573354032787627, 'support': 1242905}, 'weighted avg': {'precision': 0.4936689483681134, 'recall': 0.4677244037154891, 'f1-score': 0.45596182488785825, 'support': 1242905}}
[[281581  57605  66171]
 [192604 140561 111919]
 [186708  46561 159195]]
Evaluating performance on  train set...
2076/2076 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8562666
{'0': {'precision': 0.2733246907842706, 'recall': 0.46055668516788484, 'f1-score': 0.34305684184673324, 'support': 72788}, '1': {'precision': 0.8440155651551733, 'recall': 0.5744412123926761, 'f1-score': 0.6836124049746342, 'support': 384001}, '2': {'precision': 0.3153695864539238, 'recall': 0.622988166869916, 'f1-score': 0.4187561084362853, 'support': 74621}, 'accuracy': 0.5656592837921756, 'macro avg': {'precision': 0.4775699474644559, 'recall': 0.5526620214768256, 'f1-score': 0.48180845175255094, 'support': 531410}, 'weighted avg': {'precision': 0.6916143326974191, 'recall': 0.5656592837921756, 'f1-score': 0.5997746901537957, 'support': 531410}}
[[ 33523  27045  12220]
 [ 74715 220586  88700]
 [ 14411  13722  46488]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8944596
{'0': {'precision': 0.3372816511050231, 'recall': 0.4384454850331731, 'f1-score': 0.3812670982420976, 'support': 96313}, '1': {'precision': 0.7732773889708511, 'recall': 0.5587121830711993, 'f1-score': 0.6487130337651951, 'support': 336787}, '2': {'precision': 0.36983029618350605, 'recall': 0.6127047095921067, 'f1-score': 0.46124924382231547, 'support': 98310}, 'accuracy': 0.5469035208219643, 'macro avg': {'precision': 0.4934631120864601, 'recall': 0.536620792565493, 'f1-score': 0.49707645860986943, 'support': 531410}, 'weighted avg': {'precision': 0.6196202481699716, 'recall': 0.5469035208219643, 'f1-score': 0.5655605044990529, 'support': 531410}}
[[ 42228  36082  18003]
 [ 63986 188167  84634]
 [ 18987  19088  60235]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.92742866
{'0': {'precision': 0.37196129703054803, 'recall': 0.423840005658509, 'f1-score': 0.3962096510911923, 'support': 113104}, '1': {'precision': 0.7113083043092262, 'recall': 0.5497456637483423, 'f1-score': 0.6201775114898684, 'support': 303142}, '2': {'precision': 0.40324411714008906, 'recall': 0.5890990240005557, 'f1-score': 0.47876728521172734, 'support': 115164}, 'accuracy': 0.5314766376244331, 'macro avg': {'precision': 0.49550457282662114, 'recall': 0.520894897802469, 'f1-score': 0.49838481593092937, 'support': 531410}, 'weighted avg': {'precision': 0.5723206902967046, 'recall': 0.5314766376244331, 'f1-score': 0.5418631625283741, 'support': 531410}}
[[ 47938  42977  22189]
 [ 58280 166651  78211]
 [ 22661  24660  67843]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9767032
{'0': {'precision': 0.41621442103753575, 'recall': 0.3985962426721988, 'f1-score': 0.4072148580290219, 'support': 138343}, '1': {'precision': 0.6046657674192336, 'recall': 0.5418309641471524, 'f1-score': 0.571526506316203, 'support': 252337}, '2': {'precision': 0.4439262071200407, 'recall': 0.5451147587579052, 'f1-score': 0.48934419432413295, 'support': 140730}, 'accuracy': 0.5054120170866186, 'macro avg': {'precision': 0.48826879852560334, 'recall': 0.4951806551924188, 'f1-score': 0.489361852889786, 'support': 531410}, 'weighted avg': {'precision': 0.5130382050222357, 'recall': 0.5054120170866186, 'f1-score': 0.5069871052405034, 'support': 531410}}
[[ 55143  54140  29060]
 [ 48579 136724  67034]
 [ 28765  35251  76714]]
Evaluating performance on  val set...
588/588 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9825988
{'0': {'precision': 0.2233777777777778, 'recall': 0.7458817709621568, 'f1-score': 0.3437952459670524, 'support': 20215}, '1': {'precision': 0.9006962864721485, 'recall': 0.39508776395087764, 'f1-score': 0.5492490538141243, 'support': 110011}, '2': {'precision': 0.31154135555941426, 'recall': 0.5359988050189205, 'f1-score': 0.3940480983930597, 'support': 20084}, 'accuracy': 0.4610937396048167, 'macro avg': {'precision': 0.47853847326978016, 'recall': 0.558989446643985, 'f1-score': 0.42903079939141214, 'support': 150310}, 'weighted avg': {'precision': 0.7308833579530343, 'recall': 0.4610937396048167, 'f1-score': 0.5008803177732407, 'support': 150310}}
[[15078  2780  2357]
 [45115 43464 21432]
 [ 7307  2012 10765]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9848167
{'0': {'precision': 0.28477742157422453, 'recall': 0.7220160332541568, 'f1-score': 0.4084529220949642, 'support': 26944}, '1': {'precision': 0.8327160769265093, 'recall': 0.386408812324002, 'f1-score': 0.5278685278685279, 'support': 96592}, '2': {'precision': 0.36871553463349027, 'recall': 0.5119518936281467, 'f1-score': 0.4286853586451704, 'support': 26774}, 'accuracy': 0.468930876189209, 'macro avg': {'precision': 0.4954030110447414, 'recall': 0.5401255797354351, 'f1-score': 0.4550022695362208, 'support': 150310}, 'weighted avg': {'precision': 0.6518444805645557, 'recall': 0.468930876189209, 'f1-score': 0.48879551705920665, 'support': 150310}}
[[19454  4336  3154]
 [38954 37324 20314]
 [ 9905  3162 13707]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.99857825
{'0': {'precision': 0.32275673340054734, 'recall': 0.702564584900928, 'f1-score': 0.4423149043680793, 'support': 31896}, '1': {'precision': 0.7688071244434028, 'recall': 0.3781469015123571, 'f1-score': 0.5069462687951044, 'support': 86752}, '2': {'precision': 0.4003402250719707, 'recall': 0.48313435664203147, 'f1-score': 0.43785779711472406, 'support': 31662}, 'accuracy': 0.46910385203911914, 'macro avg': {'precision': 0.49730136097197364, 'recall': 0.5212819476851055, 'f1-score': 0.46237299009263594, 'support': 150310}, 'weighted avg': {'precision': 0.5965389969695075, 'recall': 0.46910385203911914, 'f1-score': 0.47867828136839563, 'support': 150310}}
[[22409  5600  3887]
 [34921 32805 19026]
 [12100  4265 15297]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0227875
{'0': {'precision': 0.3714504227626156, 'recall': 0.6658288905813659, 'f1-score': 0.4768675509332072, 'support': 39390}, '1': {'precision': 0.6494616304905144, 'recall': 0.3700560648850183, 'f1-score': 0.4714723763271238, 'support': 71881}, '2': {'precision': 0.4386001135601094, 'recall': 0.43530828146212763, 'f1-score': 0.4369479976859291, 'support': 39039}, 'accuracy': 0.464513339099195, 'macro avg': {'precision': 0.4865040556044131, 'recall': 0.4903977456428372, 'f1-score': 0.4617626416487534, 'support': 150310}, 'weighted avg': {'precision': 0.5218408186227211, 'recall': 0.464513339099195, 'f1-score': 0.4639194437874394, 'support': 150310}}
[[26227  7964  5199]
 [28728 26600 16553]
 [15652  6393 16994]]
training model: results/AAL/W2/deepOF_L1/seq2seq
Epoch 1/50
2076/2076 - 56s - loss: 12.4813 - accuracy10: 0.4274 - accuracy20: 0.4392 - accuracy30: 0.4425 - accuracy50: 0.4426 - val_loss: 13.6914 - val_accuracy10: 0.6676 - val_accuracy20: 0.6022 - val_accuracy30: 0.5507 - val_accuracy50: 0.4716 - 56s/epoch - 27ms/step
Epoch 2/50
2076/2076 - 53s - loss: 12.5200 - accuracy10: 0.3506 - accuracy20: 0.3794 - accuracy30: 0.3971 - accuracy50: 0.4145 - val_loss: 12.6540 - val_accuracy10: 0.5811 - val_accuracy20: 0.5502 - val_accuracy30: 0.5226 - val_accuracy50: 0.4700 - 53s/epoch - 26ms/step
Epoch 3/50
2076/2076 - 52s - loss: 12.3897 - accuracy10: 0.3896 - accuracy20: 0.4092 - accuracy30: 0.4218 - accuracy50: 0.4330 - val_loss: 12.6163 - val_accuracy10: 0.6363 - val_accuracy20: 0.5917 - val_accuracy30: 0.5536 - val_accuracy50: 0.4888 - 52s/epoch - 25ms/step
Epoch 4/50
2076/2076 - 54s - loss: 12.2727 - accuracy10: 0.4250 - accuracy20: 0.4391 - accuracy30: 0.4471 - accuracy50: 0.4509 - val_loss: 12.6071 - val_accuracy10: 0.6319 - val_accuracy20: 0.5910 - val_accuracy30: 0.5553 - val_accuracy50: 0.4904 - 54s/epoch - 26ms/step
Epoch 5/50
2076/2076 - 56s - loss: 12.1405 - accuracy10: 0.4391 - accuracy20: 0.4523 - accuracy30: 0.4590 - accuracy50: 0.4610 - val_loss: 12.5032 - val_accuracy10: 0.6058 - val_accuracy20: 0.5742 - val_accuracy30: 0.5479 - val_accuracy50: 0.4914 - 56s/epoch - 27ms/step
Epoch 6/50
2076/2076 - 51s - loss: 12.0332 - accuracy10: 0.4461 - accuracy20: 0.4575 - accuracy30: 0.4632 - accuracy50: 0.4647 - val_loss: 12.5533 - val_accuracy10: 0.6320 - val_accuracy20: 0.5900 - val_accuracy30: 0.5555 - val_accuracy50: 0.4946 - 51s/epoch - 25ms/step
Epoch 7/50
2076/2076 - 52s - loss: 11.9269 - accuracy10: 0.4601 - accuracy20: 0.4690 - accuracy30: 0.4726 - accuracy50: 0.4716 - val_loss: 12.4878 - val_accuracy10: 0.6377 - val_accuracy20: 0.5948 - val_accuracy30: 0.5611 - val_accuracy50: 0.4994 - 52s/epoch - 25ms/step
Epoch 8/50
2076/2076 - 55s - loss: 11.8249 - accuracy10: 0.4738 - accuracy20: 0.4799 - accuracy30: 0.4816 - accuracy50: 0.4792 - val_loss: 12.3830 - val_accuracy10: 0.6448 - val_accuracy20: 0.6004 - val_accuracy30: 0.5654 - val_accuracy50: 0.5028 - 55s/epoch - 26ms/step
Epoch 9/50
2076/2076 - 55s - loss: 11.7778 - accuracy10: 0.4807 - accuracy20: 0.4838 - accuracy30: 0.4834 - accuracy50: 0.4804 - val_loss: 12.4714 - val_accuracy10: 0.6478 - val_accuracy20: 0.6017 - val_accuracy30: 0.5661 - val_accuracy50: 0.5031 - 55s/epoch - 26ms/step
Epoch 10/50
2076/2076 - 52s - loss: 11.7018 - accuracy10: 0.4889 - accuracy20: 0.4909 - accuracy30: 0.4896 - accuracy50: 0.4849 - val_loss: 12.4729 - val_accuracy10: 0.6352 - val_accuracy20: 0.5861 - val_accuracy30: 0.5528 - val_accuracy50: 0.4966 - 52s/epoch - 25ms/step
Epoch 11/50
2076/2076 - 56s - loss: 11.6540 - accuracy10: 0.4927 - accuracy20: 0.4940 - accuracy30: 0.4913 - accuracy50: 0.4865 - val_loss: 12.3948 - val_accuracy10: 0.6207 - val_accuracy20: 0.5764 - val_accuracy30: 0.5462 - val_accuracy50: 0.4955 - 56s/epoch - 27ms/step
Epoch 12/50
2076/2076 - 50s - loss: 11.6018 - accuracy10: 0.4987 - accuracy20: 0.4988 - accuracy30: 0.4958 - accuracy50: 0.4893 - val_loss: 12.3310 - val_accuracy10: 0.6212 - val_accuracy20: 0.5797 - val_accuracy30: 0.5500 - val_accuracy50: 0.4976 - 50s/epoch - 24ms/step
Epoch 13/50
2076/2076 - 49s - loss: 11.5518 - accuracy10: 0.5027 - accuracy20: 0.5027 - accuracy30: 0.4991 - accuracy50: 0.4925 - val_loss: 12.4238 - val_accuracy10: 0.6309 - val_accuracy20: 0.5870 - val_accuracy30: 0.5554 - val_accuracy50: 0.4998 - 49s/epoch - 24ms/step
Epoch 14/50
2076/2076 - 50s - loss: 11.5033 - accuracy10: 0.5066 - accuracy20: 0.5062 - accuracy30: 0.5015 - accuracy50: 0.4942 - val_loss: 12.3828 - val_accuracy10: 0.6293 - val_accuracy20: 0.5857 - val_accuracy30: 0.5540 - val_accuracy50: 0.4994 - 50s/epoch - 24ms/step
Epoch 15/50
2076/2076 - 48s - loss: 11.4616 - accuracy10: 0.5088 - accuracy20: 0.5088 - accuracy30: 0.5044 - accuracy50: 0.4964 - val_loss: 12.4154 - val_accuracy10: 0.6164 - val_accuracy20: 0.5739 - val_accuracy30: 0.5438 - val_accuracy50: 0.4931 - 48s/epoch - 23ms/step
Epoch 16/50
2076/2076 - 48s - loss: 11.4227 - accuracy10: 0.5106 - accuracy20: 0.5106 - accuracy30: 0.5068 - accuracy50: 0.4988 - val_loss: 12.3580 - val_accuracy10: 0.6260 - val_accuracy20: 0.5806 - val_accuracy30: 0.5498 - val_accuracy50: 0.4979 - 48s/epoch - 23ms/step
Epoch 17/50
2076/2076 - 50s - loss: 11.3949 - accuracy10: 0.5128 - accuracy20: 0.5124 - accuracy30: 0.5088 - accuracy50: 0.5001 - val_loss: 12.5290 - val_accuracy10: 0.6328 - val_accuracy20: 0.5843 - val_accuracy30: 0.5524 - val_accuracy50: 0.4995 - 50s/epoch - 24ms/step
Epoch 18/50
2076/2076 - 50s - loss: 11.3671 - accuracy10: 0.5152 - accuracy20: 0.5148 - accuracy30: 0.5110 - accuracy50: 0.5018 - val_loss: 12.4492 - val_accuracy10: 0.6325 - val_accuracy20: 0.5831 - val_accuracy30: 0.5518 - val_accuracy50: 0.4983 - 50s/epoch - 24ms/step
Epoch 19/50
2076/2076 - 49s - loss: 11.3312 - accuracy10: 0.5185 - accuracy20: 0.5177 - accuracy30: 0.5134 - accuracy50: 0.5040 - val_loss: 12.4492 - val_accuracy10: 0.6262 - val_accuracy20: 0.5778 - val_accuracy30: 0.5485 - val_accuracy50: 0.4984 - 49s/epoch - 24ms/step
Epoch 20/50
2076/2076 - 51s - loss: 11.3010 - accuracy10: 0.5208 - accuracy20: 0.5196 - accuracy30: 0.5148 - accuracy50: 0.5051 - val_loss: 12.4230 - val_accuracy10: 0.6266 - val_accuracy20: 0.5778 - val_accuracy30: 0.5485 - val_accuracy50: 0.4986 - 51s/epoch - 24ms/step
Epoch 21/50
2076/2076 - 50s - loss: 11.2695 - accuracy10: 0.5237 - accuracy20: 0.5225 - accuracy30: 0.5174 - accuracy50: 0.5073 - val_loss: 12.4399 - val_accuracy10: 0.6222 - val_accuracy20: 0.5745 - val_accuracy30: 0.5457 - val_accuracy50: 0.4966 - 50s/epoch - 24ms/step
Epoch 22/50
2076/2076 - 49s - loss: 11.2372 - accuracy10: 0.5250 - accuracy20: 0.5236 - accuracy30: 0.5196 - accuracy50: 0.5100 - val_loss: 12.4624 - val_accuracy10: 0.6218 - val_accuracy20: 0.5742 - val_accuracy30: 0.5461 - val_accuracy50: 0.4979 - 49s/epoch - 23ms/step
testing model: results/AAL/W2/deepOF_L1/seq2seq
Evaluating performance on  test set...
4856/4856 - 47s - 47s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9562101
{'0': {'precision': 0.33650571796746553, 'recall': 0.33821075495828345, 'f1-score': 0.33735608211267204, 'support': 246305}, '1': {'precision': 0.6626941659177832, 'recall': 0.6997163904284066, 'f1-score': 0.6807022561209938, 'support': 761963}, '2': {'precision': 0.3367065654871709, 'recall': 0.2738288042551741, 'f1-score': 0.30202986028844886, 'support': 234632}, 'accuracy': 0.5476788156730228, 'macro avg': {'precision': 0.4453021497908065, 'recall': 0.4372519832139547, 'f1-score': 0.4400293995073716, 'support': 1242900}, 'weighted avg': {'precision': 0.5365142895507075, 'recall': 0.5476788156730228, 'f1-score': 0.5411765171491527, 'support': 1242900}}
[[ 83303 136301  26701]
 [128939 533158  99866]
 [ 35311 135072  64249]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0153325
{'0': {'precision': 0.37825652262184306, 'recall': 0.3210185988901134, 'f1-score': 0.3472950064362738, 'support': 307599}, '1': {'precision': 0.5607947388726082, 'recall': 0.6887160692937895, 'f1-score': 0.6182072947472187, 'support': 637402}, '2': {'precision': 0.3985350340870841, 'recall': 0.2662915954736337, 'f1-score': 0.3192607677262007, 'support': 297899}, 'accuracy': 0.496469547027114, 'macro avg': {'precision': 0.44586209852717845, 'recall': 0.42534208788584554, 'f1-score': 0.42825435630323105, 'support': 1242900}, 'weighted avg': {'precision': 0.47672878298201204, 'recall': 0.496469547027114, 'f1-score': 0.47950891159073583, 'support': 1242900}}
[[ 98745 172853  36001]
 [114693 438989  83720]
 [ 47615 170956  79328]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0515585
{'0': {'precision': 0.40832625523812593, 'recall': 0.29076503687736305, 'f1-score': 0.33966092841189527, 'support': 348859}, '1': {'precision': 0.4883122857168132, 'recall': 0.6960367182687077, 'f1-score': 0.5739579797793749, 'support': 555146}, '2': {'precision': 0.42779801161531644, 'recall': 0.2564806208412635, 'f1-score': 0.32069363095512615, 'support': 338895}, 'accuracy': 0.46243301955105, 'macro avg': {'precision': 0.4414788508567518, 'recall': 0.4144274586624448, 'f1-score': 0.41143751304879883, 'support': 1242900}, 'weighted avg': {'precision': 0.44936158048840297, 'recall': 0.46243301955105, 'f1-score': 0.43913888207416824, 'support': 1242900}}
[[101436 204780  42643]
 [ 95127 386402  73617]
 [ 51856 200119  86920]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1003146
{'0': {'precision': 0.4443905745460023, 'recall': 0.23290391655729778, 'f1-score': 0.3056286641998569, 'support': 405356}, '1': {'precision': 0.38708469233290155, 'recall': 0.7244761089504654, 'f1-score': 0.5045762884258788, 'support': 445083}, '2': {'precision': 0.46430832662199195, 'recall': 0.2335697050152754, 'f1-score': 0.31079459151567757, 'support': 392461}, 'accuracy': 0.4091463512752434, 'macro avg': {'precision': 0.4319278645002986, 'recall': 0.3969832435076796, 'f1-score': 0.37366651471380435, 'support': 1242900}, 'weighted avg': {'precision': 0.4301585904156953, 'recall': 0.4091463512752434, 'f1-score': 0.3785030953155418, 'support': 1242900}}
[[ 94409 261883  49064]
 [ 65935 322452  56696]
 [ 52102 248692  91667]]
Evaluating performance on  train set...
2076/2076 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.87277174
{'0': {'precision': 0.3006372050201095, 'recall': 0.3413570652398179, 'f1-score': 0.31970576300008374, 'support': 72701}, '1': {'precision': 0.7844034462812434, 'recall': 0.6707285643998657, 'f1-score': 0.7231258656570434, 'support': 384139}, '2': {'precision': 0.2734234832879261, 'recall': 0.4414375754324795, 'f1-score': 0.33768631835947516, 'support': 74570}, 'accuracy': 0.5934927833499558, 'macro avg': {'precision': 0.4528213781964263, 'recall': 0.48450773502405436, 'f1-score': 0.46017264900553406, 'support': 531410}, 'weighted avg': {'precision': 0.6465173219208863, 'recall': 0.5934927833499558, 'f1-score': 0.6138481480280125, 'support': 531410}}
[[ 24817  36103  11781]
 [ 50793 257653  75693]
 [  6938  34714  32918]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9136554
{'0': {'precision': 0.36208421500464627, 'recall': 0.3361396069138266, 'f1-score': 0.3486298859495936, 'support': 96213}, '1': {'precision': 0.7046198261484813, 'recall': 0.6619829486947413, 'f1-score': 0.6826362697471599, 'support': 336983}, '2': {'precision': 0.33718196957744684, 'recall': 0.43085507157839004, 'f1-score': 0.37830613330472523, 'support': 98214}, 'accuracy': 0.5602717299260458, 'macro avg': {'precision': 0.4679620035768582, 'recall': 0.47632587572898594, 'f1-score': 0.4698574296671596, 'support': 531410}, 'weighted avg': {'precision': 0.5746939301355171, 'recall': 0.5602717299260458, 'f1-score': 0.5659180366975889, 'support': 531410}}
[[ 32341  47675  16197]
 [ 46920 223077  66986]
 [ 10058  45840  42316]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9479948
{'0': {'precision': 0.40421977405750203, 'recall': 0.30646861353953536, 'f1-score': 0.3486216346928906, 'support': 112899}, '1': {'precision': 0.6383997786031241, 'recall': 0.6692348267563379, 'f1-score': 0.6534537453867708, 'support': 303330}, '2': {'precision': 0.3749061267914137, 'recall': 0.4160842500065115, 'f1-score': 0.39442334360713216, 'support': 115181}, 'accuracy': 0.5372951205284056, 'macro avg': {'precision': 0.47250855981734663, 'recall': 0.46392923010079495, 'f1-score': 0.4654995745622645, 'support': 531410}, 'weighted avg': {'precision': 0.5315366208858798, 'recall': 0.5372951205284056, 'f1-score': 0.5325478136718822, 'support': 531410}}
[[ 34600  58951  19348]
 [ 39772 202999  60559]
 [ 11225  56031  47925]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0005885
{'0': {'precision': 0.4617339579355158, 'recall': 0.24308237506328198, 'f1-score': 0.3184925827833396, 'support': 138270}, '1': {'precision': 0.5300143260048391, 'recall': 0.7018682001988206, 'f1-score': 0.6039540186011321, 'support': 252489}, '2': {'precision': 0.4235956864638661, 'recall': 0.3742312532438447, 'f1-score': 0.3973862919999547, 'support': 140651}, 'accuracy': 0.49577727178637965, 'macro avg': {'precision': 0.47178132346807367, 'recall': 0.4397272761686491, 'f1-score': 0.43994429779480876, 'support': 531410}, 'weighted avg': {'precision': 0.48408177945316955, 'recall': 0.49577727178637965, 'f1-score': 0.47500516546568416, 'support': 531410}}
[[ 33611  80981  23678]
 [ 27329 177214  47946]
 [ 11853  76162  52636]]
Evaluating performance on  val set...
588/588 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.85698223
{'0': {'precision': 0.29293122584101955, 'recall': 0.3775278682055835, 'f1-score': 0.3298924638493201, 'support': 20274}, '1': {'precision': 0.7868094158254901, 'recall': 0.7136421550782672, 'f1-score': 0.7484418398220882, 'support': 109880}, '2': {'precision': 0.297442799461642, 'recall': 0.3618277435999206, 'f1-score': 0.32649132624510346, 'support': 20156}, 'accuracy': 0.6211296653582596, 'macro avg': {'precision': 0.4590611470427172, 'recall': 0.48433258896125714, 'f1-score': 0.4682752099721706, 'support': 150310}, 'weighted avg': {'precision': 0.65457230623082, 'recall': 0.6211296653582596, 'f1-score': 0.6354054177601521, 'support': 150310}}
[[ 7654 10459  2161]
 [16400 78415 15065]
 [ 2075 10788  7293]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9050691
{'0': {'precision': 0.3521660585880769, 'recall': 0.36826314034892765, 'f1-score': 0.3600347649742884, 'support': 26997}, '1': {'precision': 0.7037067767429318, 'recall': 0.7030869506647461, 'f1-score': 0.7033967271577485, 'support': 96503}, '2': {'precision': 0.3624566462725537, 'recall': 0.34692279000372994, 'f1-score': 0.35451963941987, 'support': 26810}, 'accuracy': 0.5794225267779921, 'macro avg': {'precision': 0.4727764938678541, 'recall': 0.4727576270058012, 'f1-score': 0.47265037718396896, 'support': 150310}, 'weighted avg': {'precision': 0.5796999856715629, 'recall': 0.5794225267779921, 'f1-score': 0.5794985326575861, 'support': 150310}}
[[ 9942 14000  3055]
 [15348 67850 13305]
 [ 2941 14568  9301]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.94599694
{'0': {'precision': 0.3946305273982665, 'recall': 0.33631725562615417, 'f1-score': 0.36314784460178784, 'support': 31949}, '1': {'precision': 0.6357882564298473, 'recall': 0.7106602499740332, 'f1-score': 0.6711425488550533, 'support': 86649}, '2': {'precision': 0.39498265278889777, 'recall': 0.32669021190716446, 'f1-score': 0.3576051500664469, 'support': 31712}, 'accuracy': 0.550083161466303, 'macro avg': {'precision': 0.4751338122056705, 'recall': 0.4578892391691172, 'f1-score': 0.46396518117442936, 'support': 150310}, 'weighted avg': {'precision': 0.5337246838964712, 'recall': 0.550083161466303, 'f1-score': 0.5395277474674419, 'support': 150310}}
[[10745 17414  3790]
 [12992 61578 12079]
 [ 3491 17861 10360]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0072994
{'0': {'precision': 0.4470170332962424, 'recall': 0.2647990873367981, 'f1-score': 0.3325850567575743, 'support': 39445}, '1': {'precision': 0.5241347366761274, 'recall': 0.7405834435702847, 'f1-score': 0.6138371603178542, 'support': 71815}, '2': {'precision': 0.4396984924623116, 'recall': 0.28681177976952626, 'f1-score': 0.3471684076749016, 'support': 39050}, 'accuracy': 0.4978378018761227, 'macro avg': {'precision': 0.4702834208115605, 'recall': 0.430731436892203, 'f1-score': 0.4311968749167767, 'support': 150310}, 'weighted avg': {'precision': 0.48196094154360747, 'recall': 0.4978378018761227, 'f1-score': 0.47075017997295004, 'support': 150310}}
[[10445 24268  4732]
 [ 9090 53185  9540]
 [ 3831 24019 11200]]
training model: results/AAL/W2/deepLOB_L2/seq2seq
Epoch 1/50
2076/2076 - 104s - loss: 11.6659 - accuracy10: 0.4255 - accuracy20: 0.4502 - accuracy30: 0.4639 - accuracy50: 0.4727 - val_loss: 12.8461 - val_accuracy10: 0.5304 - val_accuracy20: 0.4946 - val_accuracy30: 0.4684 - val_accuracy50: 0.4293 - 104s/epoch - 50ms/step
Epoch 2/50
2076/2076 - 98s - loss: 11.4005 - accuracy10: 0.4425 - accuracy20: 0.4696 - accuracy30: 0.4845 - accuracy50: 0.4917 - val_loss: 13.0190 - val_accuracy10: 0.4416 - val_accuracy20: 0.4459 - val_accuracy30: 0.4512 - val_accuracy50: 0.4486 - 98s/epoch - 47ms/step
Epoch 3/50
2076/2076 - 98s - loss: 10.7834 - accuracy10: 0.5371 - accuracy20: 0.5453 - accuracy30: 0.5428 - accuracy50: 0.5306 - val_loss: 11.1570 - val_accuracy10: 0.5287 - val_accuracy20: 0.5308 - val_accuracy30: 0.5246 - val_accuracy50: 0.5060 - 98s/epoch - 47ms/step
Epoch 4/50
2076/2076 - 98s - loss: 10.2540 - accuracy10: 0.6001 - accuracy20: 0.5923 - accuracy30: 0.5778 - accuracy50: 0.5522 - val_loss: 11.0202 - val_accuracy10: 0.5547 - val_accuracy20: 0.5476 - val_accuracy30: 0.5348 - val_accuracy50: 0.5075 - 98s/epoch - 47ms/step
Epoch 5/50
2076/2076 - 97s - loss: 9.9389 - accuracy10: 0.6251 - accuracy20: 0.6131 - accuracy30: 0.5946 - accuracy50: 0.5643 - val_loss: 10.7185 - val_accuracy10: 0.5960 - val_accuracy20: 0.5785 - val_accuracy30: 0.5558 - val_accuracy50: 0.5204 - 97s/epoch - 47ms/step
Epoch 6/50
2076/2076 - 97s - loss: 9.7807 - accuracy10: 0.6361 - accuracy20: 0.6221 - accuracy30: 0.6023 - accuracy50: 0.5707 - val_loss: 10.8569 - val_accuracy10: 0.5415 - val_accuracy20: 0.5380 - val_accuracy30: 0.5258 - val_accuracy50: 0.5060 - 97s/epoch - 47ms/step
Epoch 7/50
2076/2076 - 98s - loss: 9.6408 - accuracy10: 0.6432 - accuracy20: 0.6281 - accuracy30: 0.6080 - accuracy50: 0.5756 - val_loss: 11.1480 - val_accuracy10: 0.5341 - val_accuracy20: 0.5324 - val_accuracy30: 0.5210 - val_accuracy50: 0.5012 - 98s/epoch - 47ms/step
Epoch 8/50
2076/2076 - 98s - loss: 9.5294 - accuracy10: 0.6487 - accuracy20: 0.6336 - accuracy30: 0.6127 - accuracy50: 0.5795 - val_loss: 11.3177 - val_accuracy10: 0.5076 - val_accuracy20: 0.5098 - val_accuracy30: 0.5018 - val_accuracy50: 0.4886 - 98s/epoch - 47ms/step
Epoch 9/50
2076/2076 - 97s - loss: 9.4516 - accuracy10: 0.6519 - accuracy20: 0.6363 - accuracy30: 0.6150 - accuracy50: 0.5815 - val_loss: 11.3157 - val_accuracy10: 0.4965 - val_accuracy20: 0.5018 - val_accuracy30: 0.4960 - val_accuracy50: 0.4864 - 97s/epoch - 47ms/step
Epoch 10/50
2076/2076 - 97s - loss: 9.3925 - accuracy10: 0.6544 - accuracy20: 0.6390 - accuracy30: 0.6176 - accuracy50: 0.5833 - val_loss: 10.8014 - val_accuracy10: 0.5241 - val_accuracy20: 0.5232 - val_accuracy30: 0.5127 - val_accuracy50: 0.4976 - 97s/epoch - 47ms/step
Epoch 11/50
2076/2076 - 97s - loss: 9.3485 - accuracy10: 0.6559 - accuracy20: 0.6414 - accuracy30: 0.6192 - accuracy50: 0.5848 - val_loss: 10.5924 - val_accuracy10: 0.5855 - val_accuracy20: 0.5748 - val_accuracy30: 0.5557 - val_accuracy50: 0.5264 - 97s/epoch - 47ms/step
Epoch 12/50
2076/2076 - 97s - loss: 9.3065 - accuracy10: 0.6569 - accuracy20: 0.6428 - accuracy30: 0.6205 - accuracy50: 0.5863 - val_loss: 10.5257 - val_accuracy10: 0.6004 - val_accuracy20: 0.5901 - val_accuracy30: 0.5682 - val_accuracy50: 0.5348 - 97s/epoch - 47ms/step
Epoch 13/50
2076/2076 - 98s - loss: 9.2715 - accuracy10: 0.6575 - accuracy20: 0.6445 - accuracy30: 0.6221 - accuracy50: 0.5874 - val_loss: 10.4090 - val_accuracy10: 0.5969 - val_accuracy20: 0.5889 - val_accuracy30: 0.5697 - val_accuracy50: 0.5381 - 98s/epoch - 47ms/step
Epoch 14/50
2076/2076 - 97s - loss: 9.2425 - accuracy10: 0.6591 - accuracy20: 0.6452 - accuracy30: 0.6229 - accuracy50: 0.5881 - val_loss: 10.5914 - val_accuracy10: 0.6168 - val_accuracy20: 0.6008 - val_accuracy30: 0.5788 - val_accuracy50: 0.5425 - 97s/epoch - 47ms/step
Epoch 15/50
2076/2076 - 97s - loss: 9.2139 - accuracy10: 0.6599 - accuracy20: 0.6466 - accuracy30: 0.6241 - accuracy50: 0.5891 - val_loss: 10.5693 - val_accuracy10: 0.5995 - val_accuracy20: 0.5862 - val_accuracy30: 0.5647 - val_accuracy50: 0.5341 - 97s/epoch - 47ms/step
Epoch 16/50
2076/2076 - 97s - loss: 9.1938 - accuracy10: 0.6617 - accuracy20: 0.6478 - accuracy30: 0.6247 - accuracy50: 0.5894 - val_loss: 10.6947 - val_accuracy10: 0.5753 - val_accuracy20: 0.5658 - val_accuracy30: 0.5468 - val_accuracy50: 0.5223 - 97s/epoch - 47ms/step
Epoch 17/50
2076/2076 - 97s - loss: 9.1696 - accuracy10: 0.6620 - accuracy20: 0.6491 - accuracy30: 0.6258 - accuracy50: 0.5907 - val_loss: 10.6017 - val_accuracy10: 0.5760 - val_accuracy20: 0.5714 - val_accuracy30: 0.5558 - val_accuracy50: 0.5301 - 97s/epoch - 47ms/step
Epoch 18/50
2076/2076 - 98s - loss: 9.1461 - accuracy10: 0.6623 - accuracy20: 0.6491 - accuracy30: 0.6265 - accuracy50: 0.5913 - val_loss: 10.6863 - val_accuracy10: 0.5584 - val_accuracy20: 0.5552 - val_accuracy30: 0.5419 - val_accuracy50: 0.5221 - 98s/epoch - 47ms/step
Epoch 19/50
2076/2076 - 97s - loss: 9.1171 - accuracy10: 0.6639 - accuracy20: 0.6511 - accuracy30: 0.6279 - accuracy50: 0.5925 - val_loss: 10.7804 - val_accuracy10: 0.5519 - val_accuracy20: 0.5475 - val_accuracy30: 0.5331 - val_accuracy50: 0.5144 - 97s/epoch - 47ms/step
Epoch 20/50
2076/2076 - 99s - loss: 9.0927 - accuracy10: 0.6645 - accuracy20: 0.6518 - accuracy30: 0.6286 - accuracy50: 0.5932 - val_loss: 10.6783 - val_accuracy10: 0.5519 - val_accuracy20: 0.5455 - val_accuracy30: 0.5315 - val_accuracy50: 0.5139 - 99s/epoch - 48ms/step
Epoch 21/50
2076/2076 - 99s - loss: 9.0730 - accuracy10: 0.6648 - accuracy20: 0.6527 - accuracy30: 0.6297 - accuracy50: 0.5940 - val_loss: 10.6651 - val_accuracy10: 0.5569 - val_accuracy20: 0.5492 - val_accuracy30: 0.5340 - val_accuracy50: 0.5150 - 99s/epoch - 48ms/step
Epoch 22/50
2076/2076 - 98s - loss: 9.0517 - accuracy10: 0.6656 - accuracy20: 0.6532 - accuracy30: 0.6303 - accuracy50: 0.5943 - val_loss: 10.8486 - val_accuracy10: 0.5144 - val_accuracy20: 0.5187 - val_accuracy30: 0.5127 - val_accuracy50: 0.5033 - 98s/epoch - 47ms/step
Epoch 23/50
2076/2076 - 98s - loss: 9.0262 - accuracy10: 0.6664 - accuracy20: 0.6546 - accuracy30: 0.6311 - accuracy50: 0.5958 - val_loss: 10.9208 - val_accuracy10: 0.5373 - val_accuracy20: 0.5337 - val_accuracy30: 0.5228 - val_accuracy50: 0.5089 - 98s/epoch - 47ms/step
testing model: results/AAL/W2/deepLOB_L2/seq2seq
Evaluating performance on  test set...
4856/4856 - 78s - 78s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.99556625
{'0': {'precision': 0.3655856085615646, 'recall': 0.6285463728340127, 'f1-score': 0.4622877294403253, 'support': 246308}, '1': {'precision': 0.8511818859239556, 'recall': 0.4737218556257251, 'f1-score': 0.6086834082048377, 'support': 761964}, '2': {'precision': 0.3749971545137001, 'recall': 0.6318804260270294, 'f1-score': 0.4706696550454289, 'support': 234633}, 'accuracy': 0.5342604623844944, 'macro avg': {'precision': 0.5305882163330734, 'recall': 0.5780495514955891, 'f1-score': 0.5138802642301973, 'support': 1242905}, 'weighted avg': {'precision': 0.6650575240704284, 'recall': 0.5342604623844944, 'f1-score': 0.5536180510052278, 'support': 1242905}}
[[154816  34648  56844]
 [210746 360959 190259]
 [ 57912  28461 148260]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9920721
{'0': {'precision': 0.41978216994141876, 'recall': 0.6105812055838389, 'f1-score': 0.4975159433918531, 'support': 307602}, '1': {'precision': 0.7724610718927598, 'recall': 0.47553349377629817, 'f1-score': 0.5886742177060998, 'support': 637402}, '2': {'precision': 0.4407544492460965, 'recall': 0.5964028318132534, 'f1-score': 0.506899399859915, 'support': 297901}, 'accuracy': 0.5379260683640342, 'macro avg': {'precision': 0.5443325636934251, 'recall': 0.5608391770577968, 'f1-score': 0.5310298536526227, 'support': 1242905}, 'weighted avg': {'precision': 0.605674012390143, 'recall': 0.5379260683640342, 'f1-score': 0.5465139017472718, 'support': 1242905}}
[[187816  49303  70483]
 [179346 303106 154950]
 [ 80251  39981 177669]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9933956
{'0': {'precision': 0.44425853876731175, 'recall': 0.6035595736996291, 'f1-score': 0.511799693249297, 'support': 348862}, '1': {'precision': 0.7070212725008179, 'recall': 0.46321147950268937, 'f1-score': 0.5597183451142997, 'support': 555146}, '2': {'precision': 0.47121952423255353, 'recall': 0.5634661858912885, 'f1-score': 0.5132307626149486, 'support': 338897}, 'accuracy': 0.52994074366102, 'macro avg': {'precision': 0.5408331118335611, 'recall': 0.5434124130312022, 'f1-score': 0.5282496003261817, 'support': 1242905}, 'weighted avg': {'precision': 0.5689733622433095, 'recall': 0.52994074366102, 'f1-score': 0.5335928576689912, 'support': 1242905}}
[[210559  59244  79059]
 [162772 257150 135224]
 [100625  47315 190957]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0091718
{'0': {'precision': 0.47180036961027555, 'recall': 0.569974121576783, 'f1-score': 0.5162614433413552, 'support': 405357}, '1': {'precision': 0.591080585438787, 'recall': 0.4547725822541363, 'f1-score': 0.5140439451041742, 'support': 445084}, '2': {'precision': 0.49754111930197004, 'recall': 0.5207305638224143, 'f1-score': 0.5088717910410598, 'support': 392464}, 'accuracy': 0.5131711595013295, 'macro avg': {'precision': 0.5201406914503443, 'recall': 0.5151590892177779, 'f1-score': 0.513059059828863, 'support': 1242905}, 'weighted avg': {'precision': 0.5226425765117028, 'recall': 0.5131711595013295, 'f1-score': 0.5131339754449508, 'support': 1242905}}
[[231043  78687  95627]
 [131911 202412 110761]
 [126751  61345 204368]]
Evaluating performance on  train set...
2076/2076 - 34s - 34s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7304452
{'0': {'precision': 0.38320630056505994, 'recall': 0.539457053360444, 'f1-score': 0.4481013380502696, 'support': 72788}, '1': {'precision': 0.8851100276277157, 'recall': 0.6916310113775745, 'f1-score': 0.7764997909546211, 'support': 384001}, '2': {'precision': 0.3862990952964727, 'recall': 0.6671982417818041, 'f1-score': 0.48929991204060874, 'support': 74621}, 'accuracy': 0.667356654936866, 'macro avg': {'precision': 0.5515384744964161, 'recall': 0.6327621021732742, 'f1-score': 0.5713003470151664, 'support': 531410}, 'weighted avg': {'precision': 0.7463201308118367, 'recall': 0.667356654936866, 'f1-score': 0.6911897502055866, 'support': 531410}}
[[ 39266  20347  13175]
 [ 52494 265587  65920]
 [ 10707  14127  49787]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.76864225
{'0': {'precision': 0.450543740827507, 'recall': 0.5131809828372078, 'f1-score': 0.47982680956818885, 'support': 96313}, '1': {'precision': 0.8159346529312658, 'recall': 0.6916597137062891, 'f1-score': 0.7486750294884279, 'support': 336787}, '2': {'precision': 0.4499177776472661, 'recall': 0.6233953819550402, 'f1-score': 0.5226371489728218, 'support': 98310}, 'accuracy': 0.6466833518375642, 'macro avg': {'precision': 0.5721320571353462, 'recall': 0.6094120261661791, 'f1-score': 0.5837129960098127, 'support': 531410}, 'weighted avg': {'precision': 0.6819984945476837, 'recall': 0.6466833518375641, 'f1-score': 0.6581322044782338, 'support': 531410}}
[[ 49426  30405  16482]
 [ 45397 232942  58448]
 [ 14880  22144  61286]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.81312567
{'0': {'precision': 0.4777910751031021, 'recall': 0.4906457773376715, 'f1-score': 0.4841331117421516, 'support': 113104}, '1': {'precision': 0.7532940601070159, 'recall': 0.6808228486979699, 'f1-score': 0.7152273357360688, 'support': 303142}, '2': {'precision': 0.4797395335669038, 'recall': 0.5885519780486957, 'f1-score': 0.5286041279162719, 'support': 115164}, 'accuracy': 0.620349635874372, 'macro avg': {'precision': 0.5702748895923406, 'recall': 0.586673534694779, 'f1-score': 0.5759881917981641, 'support': 531410}, 'weighted avg': {'precision': 0.6353735785384566, 'recall': 0.620349635874372, 'f1-score': 0.6255979418293545, 'support': 531410}}
[[ 55494  38629  18981]
 [ 42232 206386  54524]
 [ 18421  28963  67780]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.88999194
{'0': {'precision': 0.50988005794953, 'recall': 0.437571832329789, 'f1-score': 0.4709667129581004, 'support': 138343}, '1': {'precision': 0.6403909286442021, 'recall': 0.6725529747916477, 'f1-score': 0.6560780288665055, 'support': 252337}, '2': {'precision': 0.5105636664048322, 'recall': 0.5357635187948554, 'f1-score': 0.522860134671262, 'support': 140730}, 'accuracy': 0.575154776914247, 'macro avg': {'precision': 0.5536115509995213, 'recall': 0.5486294419720973, 'f1-score': 0.5499682921652893, 'support': 531410}, 'weighted avg': {'precision': 0.5720334344317117, 'recall': 0.575154776914247, 'f1-score': 0.5726083745001724, 'support': 531410}}
[[ 60535  53483  24325]
 [ 34674 169710  47953]
 [ 23515  41817  75398]]
Evaluating performance on  val set...
588/588 - 9s - 9s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8375558
{'0': {'precision': 0.31031592057675267, 'recall': 0.6409102151867425, 'f1-score': 0.41816480005164125, 'support': 20215}, '1': {'precision': 0.9060380455913483, 'recall': 0.5719246257192463, 'f1-score': 0.7012159104840239, 'support': 110011}, '2': {'precision': 0.3514674302075877, 'recall': 0.6845249950209121, 'f1-score': 0.4644594594594595, 'support': 20084}, 'accuracy': 0.5962477546404098, 'macro avg': {'precision': 0.5226071321252296, 'recall': 0.6324532786423003, 'f1-score': 0.5279467233317082, 'support': 150310}, 'weighted avg': {'precision': 0.7518199696380684, 'recall': 0.5962477546404098, 'f1-score': 0.6315139960420841, 'support': 150310}}
[[12956  3698  3561]
 [25286 62918 21807]
 [ 3509  2827 13748]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.85670555
{'0': {'precision': 0.3771804791963619, 'recall': 0.6187277315914489, 'f1-score': 0.4686617095146395, 'support': 26944}, '1': {'precision': 0.8391435714176163, 'recall': 0.5664340732151731, 'f1-score': 0.6763333395140705, 'support': 96592}, '2': {'precision': 0.4175507210950868, 'recall': 0.6380070217375066, 'f1-score': 0.5047574020447965, 'support': 26774}, 'accuracy': 0.5885569822367108, 'macro avg': {'precision': 0.5446249239030216, 'recall': 0.6077229421813762, 'f1-score': 0.5499174836911688, 'support': 150310}, 'weighted avg': {'precision': 0.6812375070749587, 'recall': 0.5885569822367108, 'f1-score': 0.608544911941008, 'support': 150310}}
[[16671  5939  4334]
 [22385 54713 19494]
 [ 5143  4549 17082]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.88832486
{'0': {'precision': 0.4087793247328309, 'recall': 0.6020190619513419, 'f1-score': 0.4869278559655129, 'support': 31896}, '1': {'precision': 0.775058046371693, 'recall': 0.5463966248616746, 'f1-score': 0.6409438171861266, 'support': 86752}, '2': {'precision': 0.4470814168523875, 'recall': 0.5955719790284885, 'f1-score': 0.5107529794149513, 'support': 31662}, 'accuracy': 0.5685583128201717, 'macro avg': {'precision': 0.5436395959856372, 'recall': 0.5813292219471684, 'f1-score': 0.5462082175221971, 'support': 150310}, 'weighted avg': {'precision': 0.6282466422785961, 'recall': 0.5685583128201717, 'f1-score': 0.5808374010820507, 'support': 150310}}
[[19202  7729  4965]
 [20995 47401 18356]
 [ 6777  6028 18857]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9423456
{'0': {'precision': 0.4466476048400464, 'recall': 0.5472708809342473, 'f1-score': 0.49186574486047413, 'support': 39390}, '1': {'precision': 0.6539602517276266, 'recall': 0.5305574491172911, 'f1-score': 0.5858308115332033, 'support': 71881}, '2': {'precision': 0.4797502801344645, 'recall': 0.5373856912318451, 'f1-score': 0.506935047361299, 'support': 39039}, 'accuracy': 0.5367107976847848, 'macro avg': {'precision': 0.5267860455673792, 'recall': 0.5384046737611278, 'f1-score': 0.5282105345849921, 'support': 150310}, 'weighted avg': {'precision': 0.5543858505438914, 'recall': 0.5367107976847848, 'f1-score': 0.5407154119340697, 'support': 150310}}
[[21557 11308  6525]
 [17519 38137 16225]
 [ 9188  8872 20979]]
training model: results/AAL/W2/deepOF_L2/seq2seq
Epoch 1/50
2076/2076 - 65s - loss: 10.7290 - accuracy10: 0.5699 - accuracy20: 0.5685 - accuracy30: 0.5567 - accuracy50: 0.5350 - val_loss: 11.1466 - val_accuracy10: 0.7145 - val_accuracy20: 0.6785 - val_accuracy30: 0.6353 - val_accuracy50: 0.5639 - 65s/epoch - 31ms/step
Epoch 2/50
2076/2076 - 59s - loss: 9.9079 - accuracy10: 0.6314 - accuracy20: 0.6199 - accuracy30: 0.6002 - accuracy50: 0.5687 - val_loss: 10.9753 - val_accuracy10: 0.7288 - val_accuracy20: 0.6903 - val_accuracy30: 0.6477 - val_accuracy50: 0.5728 - 59s/epoch - 29ms/step
Epoch 3/50
2076/2076 - 59s - loss: 9.7324 - accuracy10: 0.6386 - accuracy20: 0.6259 - accuracy30: 0.6060 - accuracy50: 0.5736 - val_loss: 10.8642 - val_accuracy10: 0.7170 - val_accuracy20: 0.6818 - val_accuracy30: 0.6410 - val_accuracy50: 0.5717 - 59s/epoch - 28ms/step
Epoch 4/50
2076/2076 - 59s - loss: 9.6152 - accuracy10: 0.6440 - accuracy20: 0.6303 - accuracy30: 0.6104 - accuracy50: 0.5768 - val_loss: 10.8747 - val_accuracy10: 0.7206 - val_accuracy20: 0.6843 - val_accuracy30: 0.6437 - val_accuracy50: 0.5723 - 59s/epoch - 28ms/step
Epoch 5/50
2076/2076 - 59s - loss: 9.5498 - accuracy10: 0.6466 - accuracy20: 0.6321 - accuracy30: 0.6121 - accuracy50: 0.5790 - val_loss: 10.7702 - val_accuracy10: 0.7214 - val_accuracy20: 0.6853 - val_accuracy30: 0.6443 - val_accuracy50: 0.5723 - 59s/epoch - 28ms/step
Epoch 6/50
2076/2076 - 59s - loss: 9.4966 - accuracy10: 0.6486 - accuracy20: 0.6346 - accuracy30: 0.6140 - accuracy50: 0.5794 - val_loss: 10.8057 - val_accuracy10: 0.7249 - val_accuracy20: 0.6880 - val_accuracy30: 0.6469 - val_accuracy50: 0.5742 - 59s/epoch - 29ms/step
Epoch 7/50
2076/2076 - 58s - loss: 9.4600 - accuracy10: 0.6498 - accuracy20: 0.6355 - accuracy30: 0.6148 - accuracy50: 0.5809 - val_loss: 10.8130 - val_accuracy10: 0.7271 - val_accuracy20: 0.6899 - val_accuracy30: 0.6479 - val_accuracy50: 0.5750 - 58s/epoch - 28ms/step
Epoch 8/50
2076/2076 - 60s - loss: 9.4211 - accuracy10: 0.6508 - accuracy20: 0.6374 - accuracy30: 0.6162 - accuracy50: 0.5819 - val_loss: 10.8091 - val_accuracy10: 0.7243 - val_accuracy20: 0.6880 - val_accuracy30: 0.6464 - val_accuracy50: 0.5749 - 60s/epoch - 29ms/step
Epoch 9/50
2076/2076 - 59s - loss: 9.3895 - accuracy10: 0.6522 - accuracy20: 0.6383 - accuracy30: 0.6174 - accuracy50: 0.5833 - val_loss: 10.8412 - val_accuracy10: 0.7261 - val_accuracy20: 0.6891 - val_accuracy30: 0.6474 - val_accuracy50: 0.5751 - 59s/epoch - 28ms/step
Epoch 10/50
2076/2076 - 58s - loss: 9.3609 - accuracy10: 0.6528 - accuracy20: 0.6393 - accuracy30: 0.6182 - accuracy50: 0.5837 - val_loss: 10.8748 - val_accuracy10: 0.7259 - val_accuracy20: 0.6892 - val_accuracy30: 0.6480 - val_accuracy50: 0.5752 - 58s/epoch - 28ms/step
Epoch 11/50
2076/2076 - 58s - loss: 9.3324 - accuracy10: 0.6535 - accuracy20: 0.6407 - accuracy30: 0.6195 - accuracy50: 0.5848 - val_loss: 10.8416 - val_accuracy10: 0.7338 - val_accuracy20: 0.6965 - val_accuracy30: 0.6544 - val_accuracy50: 0.5798 - 58s/epoch - 28ms/step
Epoch 12/50
2076/2076 - 58s - loss: 9.3065 - accuracy10: 0.6541 - accuracy20: 0.6415 - accuracy30: 0.6205 - accuracy50: 0.5856 - val_loss: 10.7536 - val_accuracy10: 0.7292 - val_accuracy20: 0.6921 - val_accuracy30: 0.6517 - val_accuracy50: 0.5789 - 58s/epoch - 28ms/step
Epoch 13/50
2076/2076 - 58s - loss: 9.2809 - accuracy10: 0.6550 - accuracy20: 0.6424 - accuracy30: 0.6210 - accuracy50: 0.5865 - val_loss: 10.7194 - val_accuracy10: 0.7288 - val_accuracy20: 0.6933 - val_accuracy30: 0.6524 - val_accuracy50: 0.5795 - 58s/epoch - 28ms/step
Epoch 14/50
2076/2076 - 59s - loss: 9.2602 - accuracy10: 0.6556 - accuracy20: 0.6423 - accuracy30: 0.6210 - accuracy50: 0.5867 - val_loss: 10.7602 - val_accuracy10: 0.7213 - val_accuracy20: 0.6860 - val_accuracy30: 0.6459 - val_accuracy50: 0.5748 - 59s/epoch - 29ms/step
Epoch 15/50
2076/2076 - 58s - loss: 9.2386 - accuracy10: 0.6560 - accuracy20: 0.6435 - accuracy30: 0.6223 - accuracy50: 0.5877 - val_loss: 10.7874 - val_accuracy10: 0.7308 - val_accuracy20: 0.6947 - val_accuracy30: 0.6540 - val_accuracy50: 0.5806 - 58s/epoch - 28ms/step
Epoch 16/50
2076/2076 - 58s - loss: 9.2163 - accuracy10: 0.6565 - accuracy20: 0.6442 - accuracy30: 0.6232 - accuracy50: 0.5889 - val_loss: 10.8356 - val_accuracy10: 0.7364 - val_accuracy20: 0.6979 - val_accuracy30: 0.6561 - val_accuracy50: 0.5814 - 58s/epoch - 28ms/step
Epoch 17/50
2076/2076 - 60s - loss: 9.1918 - accuracy10: 0.6567 - accuracy20: 0.6452 - accuracy30: 0.6237 - accuracy50: 0.5893 - val_loss: 10.8954 - val_accuracy10: 0.7334 - val_accuracy20: 0.6963 - val_accuracy30: 0.6550 - val_accuracy50: 0.5809 - 60s/epoch - 29ms/step
Epoch 18/50
2076/2076 - 58s - loss: 9.1734 - accuracy10: 0.6577 - accuracy20: 0.6460 - accuracy30: 0.6248 - accuracy50: 0.5898 - val_loss: 10.8002 - val_accuracy10: 0.7297 - val_accuracy20: 0.6931 - val_accuracy30: 0.6533 - val_accuracy50: 0.5795 - 58s/epoch - 28ms/step
Epoch 19/50
2076/2076 - 59s - loss: 9.1494 - accuracy10: 0.6584 - accuracy20: 0.6459 - accuracy30: 0.6249 - accuracy50: 0.5909 - val_loss: 10.8469 - val_accuracy10: 0.7317 - val_accuracy20: 0.6942 - val_accuracy30: 0.6531 - val_accuracy50: 0.5803 - 59s/epoch - 28ms/step
Epoch 20/50
2076/2076 - 58s - loss: 9.1275 - accuracy10: 0.6590 - accuracy20: 0.6467 - accuracy30: 0.6259 - accuracy50: 0.5924 - val_loss: 10.9653 - val_accuracy10: 0.7339 - val_accuracy20: 0.6963 - val_accuracy30: 0.6559 - val_accuracy50: 0.5823 - 58s/epoch - 28ms/step
Epoch 21/50
2076/2076 - 59s - loss: 9.1034 - accuracy10: 0.6589 - accuracy20: 0.6470 - accuracy30: 0.6263 - accuracy50: 0.5921 - val_loss: 10.8600 - val_accuracy10: 0.7228 - val_accuracy20: 0.6879 - val_accuracy30: 0.6502 - val_accuracy50: 0.5795 - 59s/epoch - 28ms/step
Epoch 22/50
2076/2076 - 59s - loss: 9.0896 - accuracy10: 0.6595 - accuracy20: 0.6481 - accuracy30: 0.6268 - accuracy50: 0.5929 - val_loss: 10.9178 - val_accuracy10: 0.7251 - val_accuracy20: 0.6904 - val_accuracy30: 0.6514 - val_accuracy50: 0.5805 - 59s/epoch - 28ms/step
Epoch 23/50
2076/2076 - 60s - loss: 9.0626 - accuracy10: 0.6599 - accuracy20: 0.6491 - accuracy30: 0.6279 - accuracy50: 0.5931 - val_loss: 10.8868 - val_accuracy10: 0.7266 - val_accuracy20: 0.6900 - val_accuracy30: 0.6504 - val_accuracy50: 0.5793 - 60s/epoch - 29ms/step
testing model: results/AAL/W2/deepOF_L2/seq2seq
Evaluating performance on  test set...
4856/4856 - 50s - 50s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8858086
{'0': {'precision': 0.45800148667303814, 'recall': 0.4727918637461684, 'f1-score': 0.46527916510176526, 'support': 246305}, '1': {'precision': 0.81056867205271, 'recall': 0.6781129792391494, 'f1-score': 0.7384481922063036, 'support': 761963}, '2': {'precision': 0.3944804963680732, 'recall': 0.5904480207303352, 'f1-score': 0.4729687977426629, 'support': 234632}, 'accuracy': 0.6208753721136053, 'macro avg': {'precision': 0.5543502183646071, 'recall': 0.5804509545718842, 'f1-score': 0.558898718350244, 'support': 1242900}, 'weighted avg': {'precision': 0.6621523381302883, 'recall': 0.6208753721136053, 'f1-score': 0.6341977629659976, 'support': 1242900}}
[[116451  67267  62587]
 [ 95200 516697 150066]
 [ 42608  53486 138538]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9171755
{'0': {'precision': 0.5128497605000405, 'recall': 0.4326542023868738, 'f1-score': 0.4693509763744538, 'support': 307599}, '1': {'precision': 0.7217086859775077, 'recall': 0.6966074784829668, 'f1-score': 0.708935962990017, 'support': 637402}, '2': {'precision': 0.4564546620021295, 'recall': 0.5641240823232035, 'f1-score': 0.5046098966019935, 'support': 297899}, 'accuracy': 0.5995293265749457, 'macro avg': {'precision': 0.5636710361598926, 'recall': 0.564461921064348, 'f1-score': 0.5609656119888214, 'support': 1242900}, 'weighted avg': {'precision': 0.6064430128693055, 'recall': 0.5995293265749457, 'f1-score': 0.6006693018355505, 'support': 1242900}}
[[133084  93896  80619]
 [ 73886 444019 119497]
 [ 52529  77318 168052]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.94458264
{'0': {'precision': 0.5338411684302674, 'recall': 0.3985564368412453, 'f1-score': 0.4563843423145159, 'support': 348859}, '1': {'precision': 0.6466014347040029, 'recall': 0.7002878522046453, 'f1-score': 0.6723746849016548, 'support': 555146}, '2': {'precision': 0.48136586491924377, 'recall': 0.5414685964679326, 'f1-score': 0.5096513836890227, 'support': 338895}, 'accuracy': 0.5722930243784697, 'macro avg': {'precision': 0.5539361560178381, 'recall': 0.5467709618379409, 'f1-score': 0.5461368036350644, 'support': 1242900}, 'weighted avg': {'precision': 0.5698978043602947, 'recall': 0.5722930243784697, 'f1-score': 0.5673812919584883, 'support': 1242900}}
[[139040 116364  93455]
 [ 62131 388762 104253]
 [ 59281  96113 183501]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0034076
{'0': {'precision': 0.5453576651420393, 'recall': 0.34591322195798263, 'f1-score': 0.4233200697995979, 'support': 405356}, '1': {'precision': 0.5259579665670677, 'recall': 0.7023880939060805, 'f1-score': 0.6015025008008913, 'support': 445083}, '2': {'precision': 0.4995784406904375, 'recall': 0.49823294543916463, 'f1-score': 0.4989047859006334, 'support': 392461}, 'accuracy': 0.5216638506718159, 'macro avg': {'precision': 0.5236313574665149, 'recall': 0.5155114204344092, 'f1-score': 0.5079091188337076, 'support': 1242900}, 'weighted avg': {'precision': 0.523955270542036, 'recall': 0.5216638506718159, 'f1-score': 0.5109940775259453, 'support': 1242900}}
[[140218 152749 112389]
 [ 48984 312621  83478]
 [ 67910 129014 195537]]
Evaluating performance on  train set...
2076/2076 - 21s - 21s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6572372
{'0': {'precision': 0.47019423079504424, 'recall': 0.4818228084895669, 'f1-score': 0.47593750000000007, 'support': 72701}, '1': {'precision': 0.8708964856100878, 'recall': 0.7851532908660667, 'f1-score': 0.825805179763929, 'support': 384139}, '2': {'precision': 0.4144874855324074, 'recall': 0.6147110097894596, 'f1-score': 0.4951231894233158, 'support': 74570}, 'accuracy': 0.7197380553621497, 'macro avg': {'precision': 0.5851927339791798, 'recall': 0.6272290363816978, 'f1-score': 0.5989552897290816, 'support': 531410}, 'weighted avg': {'precision': 0.7520318165916254, 'recall': 0.7197380553621497, 'f1-score': 0.7315376909959026, 'support': 531410}}
[[ 35029  23960  13712]
 [ 31490 301608  51041]
 [  7980  20751  45839]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.712014
{'0': {'precision': 0.5429379257164889, 'recall': 0.4390882728945153, 'f1-score': 0.4855220286973561, 'support': 96213}, '1': {'precision': 0.7972785005130107, 'recall': 0.7909330737752349, 'f1-score': 0.7940931111124352, 'support': 336983}, '2': {'precision': 0.47594699033520815, 'recall': 0.5781253181827438, 'f1-score': 0.5220837375237342, 'support': 98214}, 'accuracy': 0.6879001147889576, 'macro avg': {'precision': 0.6053878055215692, 'recall': 0.6027155549508314, 'f1-score': 0.6005662924445084, 'support': 531410}, 'weighted avg': {'precision': 0.6918417893794219, 'recall': 0.6879001147889576, 'f1-score': 0.687953448384894, 'support': 531410}}
[[ 42246  36015  17952]
 [ 25885 266531  44567]
 [  9679  31755  56780]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.77151513
{'0': {'precision': 0.5733995163548428, 'recall': 0.39904693575673833, 'f1-score': 0.4705931508494847, 'support': 112899}, '1': {'precision': 0.7304170655669293, 'recall': 0.7847558764382027, 'f1-score': 0.7566120916808905, 'support': 303330}, '2': {'precision': 0.49844025712125034, 'recall': 0.5493440758458427, 'f1-score': 0.5226556530717604, 'support': 115181}, 'accuracy': 0.6517867559887845, 'macro avg': {'precision': 0.6007522796810074, 'recall': 0.5777156293469279, 'f1-score': 0.5832869652007119, 'support': 531410}, 'weighted avg': {'precision': 0.6467783589899415, 'recall': 0.6517867559887845, 'f1-score': 0.6451377329816504, 'support': 531410}}
[[ 45052  46734  21113]
 [ 22733 238040  42557]
 [ 10785  41122  63274]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8694154
{'0': {'precision': 0.5981113751948682, 'recall': 0.3385188399508209, 'f1-score': 0.43234131382546365, 'support': 138270}, '1': {'precision': 0.6142379706311765, 'recall': 0.7781408298975401, 'f1-score': 0.6865425472436543, 'support': 252489}, '2': {'precision': 0.5211007660046966, 'recall': 0.49382514166269703, 'f1-score': 0.5070964444768927, 'support': 140651}, 'accuracy': 0.5885022863702226, 'macro avg': {'precision': 0.5778167039435805, 'recall': 0.5368282705036861, 'f1-score': 0.5419934351820035, 'support': 531410}, 'weighted avg': {'precision': 0.5853908181144806, 'recall': 0.5885022863702226, 'f1-score': 0.5729058480001681, 'support': 531410}}
[[ 46807  64906  26557]
 [ 18742 196472  37275]
 [ 12709  58485  69457]]
Evaluating performance on  val set...
588/588 - 6s - 6s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6432392
{'0': {'precision': 0.4860886444516338, 'recall': 0.44465818289434744, 'f1-score': 0.464451313755796, 'support': 20274}, '1': {'precision': 0.8669608275726822, 'recall': 0.8046687295231161, 'f1-score': 0.8346541429683997, 'support': 109880}, '2': {'precision': 0.4088115786292354, 'recall': 0.6039888866838659, 'f1-score': 0.48759387203364374, 'support': 20156}, 'accuracy': 0.7291996540483002, 'macro avg': {'precision': 0.5872870168845171, 'recall': 0.6177719330337764, 'f1-score': 0.5955664429192798, 'support': 150310}, 'weighted avg': {'precision': 0.7541522393064307, 'recall': 0.7291996540483002, 'f1-score': 0.7381812603896141, 'support': 150310}}
[[ 9015  7409  3850]
 [ 7708 88417 13755]
 [ 1823  6159 12174]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7096174
{'0': {'precision': 0.55337222392795, 'recall': 0.4005630255213542, 'f1-score': 0.46472850727346954, 'support': 26997}, '1': {'precision': 0.7890866600183333, 'recall': 0.811736422701885, 'f1-score': 0.8002513076168682, 'support': 96503}, '2': {'precision': 0.4749642800444515, 'recall': 0.5579634464751958, 'f1-score': 0.5131292341994683, 'support': 26810}, 'accuracy': 0.6926219147096001, 'macro avg': {'precision': 0.605807721330245, 'recall': 0.5900876315661451, 'f1-score': 0.5927030163632687, 'support': 150310}, 'weighted avg': {'precision': 0.6907219228868594, 'recall': 0.6926219147096001, 'f1-score': 0.6887760110351956, 'support': 150310}}
[[10814 11308  4875]
 [ 6507 78335 11661]
 [ 2221  9630 14959]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7794584
{'0': {'precision': 0.5819862598504748, 'recall': 0.3606059657579267, 'f1-score': 0.44529906271137304, 'support': 31949}, '1': {'precision': 0.7179318901957568, 'recall': 0.8079954760008771, 'f1-score': 0.7603058077407585, 'support': 86649}, '2': {'precision': 0.4990756175178057, 'recall': 0.5192671543895055, 'f1-score': 0.5089712086791227, 'support': 31712}, 'accuracy': 0.651985895815315, 'macro avg': {'precision': 0.5996645891880125, 'recall': 0.5626228653827697, 'f1-score': 0.5715253597104181, 'support': 150310}, 'weighted avg': {'precision': 0.6428623867491158, 'recall': 0.651985895815315, 'f1-score': 0.6403239482344952, 'support': 150310}}
[[11521 14784  5644]
 [ 5753 70012 10884]
 [ 2522 12723 16467]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8934833
{'0': {'precision': 0.6013061968408262, 'recall': 0.3011028013689948, 'f1-score': 0.40127033464533673, 'support': 39445}, '1': {'precision': 0.5965061339522546, 'recall': 0.8016431107707304, 'f1-score': 0.6840257356217362, 'support': 71815}, '2': {'precision': 0.520119837866416, 'recall': 0.45346991037131884, 'f1-score': 0.48451351647148955, 'support': 39050}, 'accuracy': 0.5798350076508549, 'macro avg': {'precision': 0.5726440562198323, 'recall': 0.5187386075036814, 'f1-score': 0.5232698622461874, 'support': 150310}, 'weighted avg': {'precision': 0.5779209008905004, 'recall': 0.5798350076508549, 'f1-score': 0.5579912805001127, 'support': 150310}}
[[11877 20714  6854]
 [ 4761 57570  9484]
 [ 3114 18228 17708]]
training model: results/AAL/W2/deepVOL_L2/seq2seq
Epoch 1/50
2076/2076 - 65s - loss: 11.0825 - accuracy10: 0.5251 - accuracy20: 0.5352 - accuracy30: 0.5307 - accuracy50: 0.5162 - val_loss: 11.1930 - val_accuracy10: 0.6391 - val_accuracy20: 0.6250 - val_accuracy30: 0.6003 - val_accuracy50: 0.5450 - 65s/epoch - 31ms/step
Epoch 2/50
2076/2076 - 56s - loss: 10.4840 - accuracy10: 0.5760 - accuracy20: 0.5755 - accuracy30: 0.5664 - accuracy50: 0.5448 - val_loss: 10.6465 - val_accuracy10: 0.7096 - val_accuracy20: 0.6787 - val_accuracy30: 0.6418 - val_accuracy50: 0.5698 - 56s/epoch - 27ms/step
Epoch 3/50
2076/2076 - 58s - loss: 10.0991 - accuracy10: 0.6181 - accuracy20: 0.6103 - accuracy30: 0.5922 - accuracy50: 0.5613 - val_loss: 10.7815 - val_accuracy10: 0.7081 - val_accuracy20: 0.6798 - val_accuracy30: 0.6410 - val_accuracy50: 0.5689 - 58s/epoch - 28ms/step
Epoch 4/50
2076/2076 - 59s - loss: 9.8895 - accuracy10: 0.6317 - accuracy20: 0.6234 - accuracy30: 0.6024 - accuracy50: 0.5679 - val_loss: 10.5634 - val_accuracy10: 0.7118 - val_accuracy20: 0.6813 - val_accuracy30: 0.6401 - val_accuracy50: 0.5686 - 59s/epoch - 29ms/step
Epoch 5/50
2076/2076 - 57s - loss: 9.7465 - accuracy10: 0.6412 - accuracy20: 0.6307 - accuracy30: 0.6080 - accuracy50: 0.5725 - val_loss: 10.2311 - val_accuracy10: 0.6850 - val_accuracy20: 0.6662 - val_accuracy30: 0.6324 - val_accuracy50: 0.5686 - 57s/epoch - 28ms/step
Epoch 6/50
2076/2076 - 58s - loss: 9.6685 - accuracy10: 0.6470 - accuracy20: 0.6347 - accuracy30: 0.6118 - accuracy50: 0.5753 - val_loss: 10.3288 - val_accuracy10: 0.6888 - val_accuracy20: 0.6678 - val_accuracy30: 0.6313 - val_accuracy50: 0.5662 - 58s/epoch - 28ms/step
Epoch 7/50
2076/2076 - 58s - loss: 9.5991 - accuracy10: 0.6514 - accuracy20: 0.6368 - accuracy30: 0.6134 - accuracy50: 0.5775 - val_loss: 10.2751 - val_accuracy10: 0.6645 - val_accuracy20: 0.6492 - val_accuracy30: 0.6162 - val_accuracy50: 0.5587 - 58s/epoch - 28ms/step
Epoch 8/50
2076/2076 - 57s - loss: 9.5452 - accuracy10: 0.6544 - accuracy20: 0.6394 - accuracy30: 0.6152 - accuracy50: 0.5792 - val_loss: 10.1841 - val_accuracy10: 0.6636 - val_accuracy20: 0.6518 - val_accuracy30: 0.6215 - val_accuracy50: 0.5644 - 57s/epoch - 28ms/step
Epoch 9/50
2076/2076 - 58s - loss: 9.5006 - accuracy10: 0.6558 - accuracy20: 0.6402 - accuracy30: 0.6165 - accuracy50: 0.5808 - val_loss: 10.1537 - val_accuracy10: 0.6606 - val_accuracy20: 0.6512 - val_accuracy30: 0.6207 - val_accuracy50: 0.5621 - 58s/epoch - 28ms/step
Epoch 10/50
2076/2076 - 58s - loss: 9.4589 - accuracy10: 0.6578 - accuracy20: 0.6414 - accuracy30: 0.6170 - accuracy50: 0.5816 - val_loss: 10.1330 - val_accuracy10: 0.6456 - val_accuracy20: 0.6408 - val_accuracy30: 0.6139 - val_accuracy50: 0.5608 - 58s/epoch - 28ms/step
Epoch 11/50
2076/2076 - 58s - loss: 9.4265 - accuracy10: 0.6582 - accuracy20: 0.6428 - accuracy30: 0.6188 - accuracy50: 0.5827 - val_loss: 10.1810 - val_accuracy10: 0.6470 - val_accuracy20: 0.6406 - val_accuracy30: 0.6111 - val_accuracy50: 0.5588 - 58s/epoch - 28ms/step
Epoch 12/50
2076/2076 - 58s - loss: 9.3967 - accuracy10: 0.6594 - accuracy20: 0.6433 - accuracy30: 0.6190 - accuracy50: 0.5827 - val_loss: 10.1950 - val_accuracy10: 0.6318 - val_accuracy20: 0.6330 - val_accuracy30: 0.6065 - val_accuracy50: 0.5560 - 58s/epoch - 28ms/step
Epoch 13/50
2076/2076 - 58s - loss: 9.3672 - accuracy10: 0.6600 - accuracy20: 0.6447 - accuracy30: 0.6204 - accuracy50: 0.5843 - val_loss: 10.2810 - val_accuracy10: 0.6370 - val_accuracy20: 0.6354 - val_accuracy30: 0.6086 - val_accuracy50: 0.5574 - 58s/epoch - 28ms/step
Epoch 14/50
2076/2076 - 57s - loss: 9.3420 - accuracy10: 0.6619 - accuracy20: 0.6458 - accuracy30: 0.6213 - accuracy50: 0.5846 - val_loss: 10.2217 - val_accuracy10: 0.6606 - val_accuracy20: 0.6520 - val_accuracy30: 0.6207 - val_accuracy50: 0.5632 - 57s/epoch - 28ms/step
Epoch 15/50
2076/2076 - 58s - loss: 9.3160 - accuracy10: 0.6610 - accuracy20: 0.6452 - accuracy30: 0.6213 - accuracy50: 0.5854 - val_loss: 10.2892 - val_accuracy10: 0.6613 - val_accuracy20: 0.6538 - val_accuracy30: 0.6229 - val_accuracy50: 0.5639 - 58s/epoch - 28ms/step
Epoch 16/50
2076/2076 - 58s - loss: 9.2913 - accuracy10: 0.6624 - accuracy20: 0.6468 - accuracy30: 0.6225 - accuracy50: 0.5863 - val_loss: 10.2723 - val_accuracy10: 0.6518 - val_accuracy20: 0.6458 - val_accuracy30: 0.6173 - val_accuracy50: 0.5630 - 58s/epoch - 28ms/step
Epoch 17/50
2076/2076 - 57s - loss: 9.2774 - accuracy10: 0.6630 - accuracy20: 0.6466 - accuracy30: 0.6227 - accuracy50: 0.5867 - val_loss: 10.2431 - val_accuracy10: 0.6458 - val_accuracy20: 0.6425 - val_accuracy30: 0.6160 - val_accuracy50: 0.5628 - 57s/epoch - 28ms/step
Epoch 18/50
2076/2076 - 58s - loss: 9.2566 - accuracy10: 0.6633 - accuracy20: 0.6476 - accuracy30: 0.6238 - accuracy50: 0.5876 - val_loss: 10.2703 - val_accuracy10: 0.6373 - val_accuracy20: 0.6366 - val_accuracy30: 0.6101 - val_accuracy50: 0.5588 - 58s/epoch - 28ms/step
Epoch 19/50
2076/2076 - 57s - loss: 9.2344 - accuracy10: 0.6641 - accuracy20: 0.6481 - accuracy30: 0.6244 - accuracy50: 0.5882 - val_loss: 10.3247 - val_accuracy10: 0.6435 - val_accuracy20: 0.6384 - val_accuracy30: 0.6105 - val_accuracy50: 0.5583 - 57s/epoch - 27ms/step
Epoch 20/50
2076/2076 - 58s - loss: 9.2146 - accuracy10: 0.6640 - accuracy20: 0.6484 - accuracy30: 0.6248 - accuracy50: 0.5895 - val_loss: 10.3231 - val_accuracy10: 0.6343 - val_accuracy20: 0.6337 - val_accuracy30: 0.6085 - val_accuracy50: 0.5572 - 58s/epoch - 28ms/step
testing model: results/AAL/W2/deepVOL_L2/seq2seq
Evaluating performance on  test set...
4856/4856 - 43s - 43s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.95996547
{'0': {'precision': 0.4108280160917169, 'recall': 0.5659418289296329, 'f1-score': 0.47606866650842794, 'support': 246308}, '1': {'precision': 0.858842679218152, 'recall': 0.5048046889354353, 'f1-score': 0.6358649921558968, 'support': 761964}, '2': {'precision': 0.3571108838850392, 'recall': 0.6936321830262581, 'f1-score': 0.47148272450609896, 'support': 234633}, 'accuracy': 0.5525667689807346, 'macro avg': {'precision': 0.5422605263983027, 'recall': 0.588126233630442, 'f1-score': 0.5278054610568078, 'support': 1242905}, 'weighted avg': {'precision': 0.6753431905366034, 'recall': 0.5525667689807346, 'f1-score': 0.5731662195360652, 'support': 1242905}}
[[139396  38162  68750]
 [153082 384643 224239]
 [ 46827  25057 162749]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.94894713
{'0': {'precision': 0.4720532659326539, 'recall': 0.5063751210980423, 'f1-score': 0.48861221295263724, 'support': 307602}, '1': {'precision': 0.7698336306218378, 'recall': 0.5382960831625881, 'f1-score': 0.63357390889274, 'support': 637402}, '2': {'precision': 0.42324657619268774, 'recall': 0.6638413432650444, 'f1-score': 0.5169196909339941, 'support': 297901}, 'accuracy': 0.5604869237793717, 'macro avg': {'precision': 0.5550444909157265, 'recall': 0.5695041825085583, 'f1-score': 0.5463686042597905, 'support': 1242905}, 'weighted avg': {'precision': 0.6130666485591536, 'recall': 0.5604869237793717, 'f1-score': 0.569738043900085, 'support': 1242905}}
[[155762  60117  91723]
 [116530 343111 177761]
 [ 57675  42467 197759]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9605032
{'0': {'precision': 0.49812368567353943, 'recall': 0.47257368243030196, 'f1-score': 0.48501242957798274, 'support': 348862}, '1': {'precision': 0.6946592081580908, 'recall': 0.5408883428863759, 'f1-score': 0.6082049495444621, 'support': 555146}, '2': {'precision': 0.45222951181936255, 'recall': 0.6400912371605532, 'f1-score': 0.5300057661109048, 'support': 338897}, 'accuracy': 0.5487627775252332, 'macro avg': {'precision': 0.5483374685503309, 'recall': 0.5511844208257436, 'f1-score': 0.5410743817444499, 'support': 1242905}, 'weighted avg': {'precision': 0.57339292292703, 'recall': 0.5487627775252332, 'f1-score': 0.552304733865365, 'support': 1242905}}
[[164863  77241 106758]
 [ 98878 300272 155996]
 [ 67227  54745 216925]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9933063
{'0': {'precision': 0.5144175215446903, 'recall': 0.431612134488858, 'f1-score': 0.4693908760181578, 'support': 405357}, '1': {'precision': 0.5716001575847258, 'recall': 0.5346136908987966, 'f1-score': 0.5524885995300498, 'support': 445084}, '2': {'precision': 0.478368556711626, 'recall': 0.5930047087121366, 'f1-score': 0.5295536407054556, 'support': 392464}, 'accuracy': 0.5194588484236526, 'macro avg': {'precision': 0.5214620786136808, 'recall': 0.519743511366597, 'f1-score': 0.5171443720845544, 'support': 1242905}, 'weighted avg': {'precision': 0.5235116642547119, 'recall': 0.5194588484236526, 'f1-score': 0.518145355605739, 'support': 1242905}}
[[174957 103591 126809]
 [ 80164 237948 126972]
 [ 84986  74745 232733]]
Evaluating performance on  train set...
2076/2076 - 20s - 20s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.80926156
{'0': {'precision': 0.3717698441584224, 'recall': 0.6174644172116283, 'f1-score': 0.4641057414291615, 'support': 72788}, '1': {'precision': 0.9057998781860205, 'recall': 0.5848031645750923, 'f1-score': 0.7107387011014054, 'support': 384001}, '2': {'precision': 0.3322837163820196, 'recall': 0.7240455099770842, 'f1-score': 0.45551808447854314, 'support': 74621}, 'accuracy': 0.6088293408102972, 'macro avg': {'precision': 0.5366178129088208, 'recall': 0.6421043639212682, 'f1-score': 0.5434541756697033, 'support': 531410}, 'weighted avg': {'precision': 0.752119428765089, 'recall': 0.6088293408102972, 'f1-score': 0.6411187513420146, 'support': 531410}}
[[ 44944  13863  13981]
 [ 64847 224565  94589]
 [ 11101   9491  54029]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8080636
{'0': {'precision': 0.45038912961171174, 'recall': 0.5558024358082502, 'f1-score': 0.4975739886972041, 'support': 96313}, '1': {'precision': 0.8344251112967739, 'recall': 0.6138538601549347, 'f1-score': 0.70734310954789, 'support': 336787}, '2': {'precision': 0.40480842749129214, 'recall': 0.6785677957481436, 'f1-score': 0.5070998540501095, 'support': 98310}, 'accuracy': 0.6153045670950866, 'macro avg': {'precision': 0.5632075561332592, 'recall': 0.6160746972371095, 'f1-score': 0.5706723174317345, 'support': 531410}, 'weighted avg': {'precision': 0.6853438488272112, 'recall': 0.6153045670950866, 'f1-score': 0.6322797727938227, 'support': 531410}}
[[ 53531  24052  18730]
 [ 50695 206738  79354]
 [ 14629  16971  66710]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8397012
{'0': {'precision': 0.48549434038709893, 'recall': 0.5085319705757533, 'f1-score': 0.49674619453740687, 'support': 113104}, '1': {'precision': 0.7696158188338424, 'recall': 0.6116671394923832, 'f1-score': 0.6816108221368574, 'support': 303142}, '2': {'precision': 0.4360825761143183, 'recall': 0.6513406967455108, 'f1-score': 0.5224061983111343, 'support': 115164}, 'accuracy': 0.5983139195724582, 'macro avg': {'precision': 0.5637309117784199, 'recall': 0.5905132689378824, 'f1-score': 0.5669210716617995, 'support': 531410}, 'weighted avg': {'precision': 0.6368627692811586, 'recall': 0.5983139195724582, 'f1-score': 0.6077628137473393, 'support': 531410}}
[[ 57517  32667  22920]
 [ 43640 185422  74080]
 [ 17314  22839  75011]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9056601
{'0': {'precision': 0.5154508230968496, 'recall': 0.4458772760457703, 'f1-score': 0.47814644998507827, 'support': 138343}, '1': {'precision': 0.6533405552259851, 'recall': 0.6023056468135866, 'f1-score': 0.6267859609908384, 'support': 252337}, '2': {'precision': 0.4696896948312248, 'recall': 0.5977972003126555, 'f1-score': 0.5260564525206037, 'support': 140730}, 'accuracy': 0.5603884006699159, 'macro avg': {'precision': 0.5461603577180199, 'recall': 0.5486600410573375, 'f1-score': 0.5436629544988402, 'support': 531410}, 'weighted avg': {'precision': 0.5688083394315973, 'recall': 0.5603884006699159, 'f1-score': 0.5614147794208906, 'support': 531410}}
[[ 61684  46680  29979]
 [ 35346 151984  65007]
 [ 22640  33962  84128]]
Evaluating performance on  val set...
588/588 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7538183
{'0': {'precision': 0.3961630535975529, 'recall': 0.5894138016324512, 'f1-score': 0.47384223817382837, 'support': 20215}, '1': {'precision': 0.898850312166895, 'recall': 0.6438719764387197, 'f1-score': 0.7502899663691973, 'support': 110011}, '2': {'precision': 0.34713975380159307, 'recall': 0.7160924118701454, 'f1-score': 0.4676008713463602, 'support': 20084}, 'accuracy': 0.646197857760628, 'macro avg': {'precision': 0.5473843731886804, 'recall': 0.6497927299804388, 'f1-score': 0.563911025296462, 'support': 150310}, 'weighted avg': {'precision': 0.7575265294100062, 'recall': 0.646197857760628, 'f1-score': 0.6753387415012041, 'support': 150310}}
[[11915  4760  3540]
 [15670 70833 23508]
 [ 2491  3211 14382]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7716662
{'0': {'precision': 0.47562377442693893, 'recall': 0.5221199524940617, 'f1-score': 0.497788471745515, 'support': 26944}, '1': {'precision': 0.82099266664975, 'recall': 0.6699209044227266, 'f1-score': 0.7378028618664844, 'support': 96592}, '2': {'precision': 0.420861764565539, 'recall': 0.6588481362515873, 'f1-score': 0.5136268343815513, 'support': 26774}, 'accuracy': 0.6414543277227064, 'macro avg': {'precision': 0.572492735214076, 'recall': 0.6169629977227918, 'f1-score': 0.5830727226645168, 'support': 150310}, 'weighted avg': {'precision': 0.6878097499811712, 'recall': 0.6414543277227064, 'f1-score': 0.6548473919223623, 'support': 150310}}
[[14068  8237  4639]
 [12248 64709 19635]
 [ 3262  5872 17640]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8208333
{'0': {'precision': 0.5058263971462544, 'recall': 0.46679834462001507, 'f1-score': 0.4855293407901388, 'support': 31896}, '1': {'precision': 0.7481059126767164, 'recall': 0.6624400590188122, 'f1-score': 0.7026716390536162, 'support': 86752}, '2': {'precision': 0.4466940554281953, 'recall': 0.6215652833049081, 'f1-score': 0.5198166906588835, 'support': 31662}, 'accuracy': 0.6123145499301443, 'macro avg': {'precision': 0.5668754550837221, 'recall': 0.5836012289812451, 'f1-score': 0.5693392235008795, 'support': 150310}, 'weighted avg': {'precision': 0.6332030475874855, 'recall': 0.6123145499301443, 'f1-score': 0.6180763085933281, 'support': 150310}}
[[14889 11300  5707]
 [10614 57468 18670]
 [ 3932  8050 19680]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.90902156
{'0': {'precision': 0.5253113429821609, 'recall': 0.3962173140390962, 'f1-score': 0.4517221418234443, 'support': 39390}, '1': {'precision': 0.6241232902480316, 'recall': 0.6462208372170671, 'f1-score': 0.6349798710929758, 'support': 71881}, '2': {'precision': 0.4757222679429982, 'recall': 0.5626681011296396, 'f1-score': 0.515555138300494, 'support': 39039}, 'accuracy': 0.559004723571286, 'macro avg': {'precision': 0.5417189670577303, 'recall': 0.5350354174619344, 'f1-score': 0.5340857170723048, 'support': 150310}, 'weighted avg': {'precision': 0.5596855940696746, 'recall': 0.559004723571286, 'f1-score': 0.5559382630867717, 'support': 150310}}
[[15607 16147  7636]
 [ 8858 46451 16572]
 [ 5245 11828 21966]]
training model: results/AAL/W2/deepVOL_L3/seq2seq
Epoch 1/50
2076/2076 - 90s - loss: 11.9075 - accuracy10: 0.4101 - accuracy20: 0.4355 - accuracy30: 0.4494 - accuracy50: 0.4572 - val_loss: 11.5034 - val_accuracy10: 0.5968 - val_accuracy20: 0.5899 - val_accuracy30: 0.5696 - val_accuracy50: 0.5229 - 90s/epoch - 43ms/step
Epoch 2/50
2076/2076 - 84s - loss: 10.7274 - accuracy10: 0.5462 - accuracy20: 0.5565 - accuracy30: 0.5550 - accuracy50: 0.5390 - val_loss: 10.8848 - val_accuracy10: 0.5971 - val_accuracy20: 0.5924 - val_accuracy30: 0.5783 - val_accuracy50: 0.5380 - 84s/epoch - 41ms/step
Epoch 3/50
2076/2076 - 83s - loss: 10.2602 - accuracy10: 0.6031 - accuracy20: 0.5951 - accuracy30: 0.5814 - accuracy50: 0.5561 - val_loss: 10.4771 - val_accuracy10: 0.6317 - val_accuracy20: 0.6188 - val_accuracy30: 0.5982 - val_accuracy50: 0.5523 - 83s/epoch - 40ms/step
Epoch 4/50
2076/2076 - 83s - loss: 10.0097 - accuracy10: 0.6228 - accuracy20: 0.6108 - accuracy30: 0.5927 - accuracy50: 0.5632 - val_loss: 10.5734 - val_accuracy10: 0.7014 - val_accuracy20: 0.6709 - val_accuracy30: 0.6357 - val_accuracy50: 0.5696 - 83s/epoch - 40ms/step
Epoch 5/50
2076/2076 - 83s - loss: 9.8062 - accuracy10: 0.6327 - accuracy20: 0.6210 - accuracy30: 0.6007 - accuracy50: 0.5690 - val_loss: 10.3559 - val_accuracy10: 0.6914 - val_accuracy20: 0.6657 - val_accuracy30: 0.6333 - val_accuracy50: 0.5703 - 83s/epoch - 40ms/step
Epoch 6/50
2076/2076 - 83s - loss: 9.6497 - accuracy10: 0.6401 - accuracy20: 0.6292 - accuracy30: 0.6072 - accuracy50: 0.5729 - val_loss: 10.3055 - val_accuracy10: 0.7069 - val_accuracy20: 0.6782 - val_accuracy30: 0.6425 - val_accuracy50: 0.5764 - 83s/epoch - 40ms/step
Epoch 7/50
2076/2076 - 83s - loss: 9.5650 - accuracy10: 0.6437 - accuracy20: 0.6327 - accuracy30: 0.6114 - accuracy50: 0.5764 - val_loss: 10.2117 - val_accuracy10: 0.7157 - val_accuracy20: 0.6828 - val_accuracy30: 0.6442 - val_accuracy50: 0.5764 - 83s/epoch - 40ms/step
Epoch 8/50
2076/2076 - 84s - loss: 9.4915 - accuracy10: 0.6476 - accuracy20: 0.6370 - accuracy30: 0.6150 - accuracy50: 0.5785 - val_loss: 10.0266 - val_accuracy10: 0.6951 - val_accuracy20: 0.6656 - val_accuracy30: 0.6297 - val_accuracy50: 0.5707 - 84s/epoch - 40ms/step
Epoch 9/50
2076/2076 - 83s - loss: 9.4328 - accuracy10: 0.6500 - accuracy20: 0.6391 - accuracy30: 0.6173 - accuracy50: 0.5807 - val_loss: 9.9817 - val_accuracy10: 0.6922 - val_accuracy20: 0.6642 - val_accuracy30: 0.6306 - val_accuracy50: 0.5726 - 83s/epoch - 40ms/step
Epoch 10/50
2076/2076 - 84s - loss: 9.3876 - accuracy10: 0.6539 - accuracy20: 0.6416 - accuracy30: 0.6193 - accuracy50: 0.5825 - val_loss: 9.9716 - val_accuracy10: 0.7059 - val_accuracy20: 0.6763 - val_accuracy30: 0.6408 - val_accuracy50: 0.5782 - 84s/epoch - 40ms/step
Epoch 11/50
2076/2076 - 83s - loss: 9.3548 - accuracy10: 0.6557 - accuracy20: 0.6429 - accuracy30: 0.6204 - accuracy50: 0.5837 - val_loss: 9.9282 - val_accuracy10: 0.7077 - val_accuracy20: 0.6780 - val_accuracy30: 0.6426 - val_accuracy50: 0.5803 - 83s/epoch - 40ms/step
Epoch 12/50
2076/2076 - 84s - loss: 9.3203 - accuracy10: 0.6571 - accuracy20: 0.6445 - accuracy30: 0.6224 - accuracy50: 0.5856 - val_loss: 9.9322 - val_accuracy10: 0.7122 - val_accuracy20: 0.6789 - val_accuracy30: 0.6423 - val_accuracy50: 0.5782 - 84s/epoch - 40ms/step
Epoch 13/50
2076/2076 - 83s - loss: 9.2907 - accuracy10: 0.6588 - accuracy20: 0.6447 - accuracy30: 0.6229 - accuracy50: 0.5860 - val_loss: 9.8461 - val_accuracy10: 0.7017 - val_accuracy20: 0.6723 - val_accuracy30: 0.6376 - val_accuracy50: 0.5777 - 83s/epoch - 40ms/step
Epoch 14/50
2076/2076 - 83s - loss: 9.2601 - accuracy10: 0.6601 - accuracy20: 0.6466 - accuracy30: 0.6247 - accuracy50: 0.5876 - val_loss: 9.8056 - val_accuracy10: 0.6899 - val_accuracy20: 0.6627 - val_accuracy30: 0.6308 - val_accuracy50: 0.5741 - 83s/epoch - 40ms/step
Epoch 15/50
2076/2076 - 84s - loss: 9.2391 - accuracy10: 0.6609 - accuracy20: 0.6473 - accuracy30: 0.6257 - accuracy50: 0.5886 - val_loss: 9.8187 - val_accuracy10: 0.6990 - val_accuracy20: 0.6717 - val_accuracy30: 0.6380 - val_accuracy50: 0.5801 - 84s/epoch - 40ms/step
Epoch 16/50
2076/2076 - 83s - loss: 9.2229 - accuracy10: 0.6615 - accuracy20: 0.6472 - accuracy30: 0.6253 - accuracy50: 0.5886 - val_loss: 9.8367 - val_accuracy10: 0.6749 - val_accuracy20: 0.6500 - val_accuracy30: 0.6205 - val_accuracy50: 0.5689 - 83s/epoch - 40ms/step
Epoch 17/50
2076/2076 - 83s - loss: 9.1948 - accuracy10: 0.6627 - accuracy20: 0.6487 - accuracy30: 0.6266 - accuracy50: 0.5896 - val_loss: 9.8289 - val_accuracy10: 0.6752 - val_accuracy20: 0.6497 - val_accuracy30: 0.6191 - val_accuracy50: 0.5686 - 83s/epoch - 40ms/step
Epoch 18/50
2076/2076 - 83s - loss: 9.1704 - accuracy10: 0.6637 - accuracy20: 0.6490 - accuracy30: 0.6276 - accuracy50: 0.5906 - val_loss: 9.8695 - val_accuracy10: 0.6816 - val_accuracy20: 0.6530 - val_accuracy30: 0.6205 - val_accuracy50: 0.5676 - 83s/epoch - 40ms/step
Epoch 19/50
2076/2076 - 83s - loss: 9.1505 - accuracy10: 0.6640 - accuracy20: 0.6503 - accuracy30: 0.6282 - accuracy50: 0.5914 - val_loss: 9.8204 - val_accuracy10: 0.6780 - val_accuracy20: 0.6516 - val_accuracy30: 0.6203 - val_accuracy50: 0.5689 - 83s/epoch - 40ms/step
Epoch 20/50
2076/2076 - 83s - loss: 9.1362 - accuracy10: 0.6644 - accuracy20: 0.6504 - accuracy30: 0.6285 - accuracy50: 0.5917 - val_loss: 9.8247 - val_accuracy10: 0.6839 - val_accuracy20: 0.6559 - val_accuracy30: 0.6243 - val_accuracy50: 0.5706 - 83s/epoch - 40ms/step
Epoch 21/50
2076/2076 - 84s - loss: 9.1127 - accuracy10: 0.6658 - accuracy20: 0.6514 - accuracy30: 0.6297 - accuracy50: 0.5930 - val_loss: 9.8641 - val_accuracy10: 0.6805 - val_accuracy20: 0.6522 - val_accuracy30: 0.6212 - val_accuracy50: 0.5685 - 84s/epoch - 41ms/step
Epoch 22/50
2076/2076 - 84s - loss: 9.0990 - accuracy10: 0.6659 - accuracy20: 0.6514 - accuracy30: 0.6294 - accuracy50: 0.5934 - val_loss: 9.7508 - val_accuracy10: 0.6809 - val_accuracy20: 0.6528 - val_accuracy30: 0.6204 - val_accuracy50: 0.5690 - 84s/epoch - 40ms/step
Epoch 23/50
2076/2076 - 83s - loss: 9.0841 - accuracy10: 0.6658 - accuracy20: 0.6515 - accuracy30: 0.6300 - accuracy50: 0.5940 - val_loss: 9.8137 - val_accuracy10: 0.6695 - val_accuracy20: 0.6442 - val_accuracy30: 0.6135 - val_accuracy50: 0.5637 - 83s/epoch - 40ms/step
Epoch 24/50
2076/2076 - 83s - loss: 9.0660 - accuracy10: 0.6663 - accuracy20: 0.6522 - accuracy30: 0.6309 - accuracy50: 0.5944 - val_loss: 9.8594 - val_accuracy10: 0.6698 - val_accuracy20: 0.6421 - val_accuracy30: 0.6115 - val_accuracy50: 0.5630 - 83s/epoch - 40ms/step
Epoch 25/50
2076/2076 - 84s - loss: 9.0507 - accuracy10: 0.6664 - accuracy20: 0.6523 - accuracy30: 0.6314 - accuracy50: 0.5949 - val_loss: 9.8451 - val_accuracy10: 0.6675 - val_accuracy20: 0.6393 - val_accuracy30: 0.6086 - val_accuracy50: 0.5606 - 84s/epoch - 40ms/step
Epoch 26/50
2076/2076 - 83s - loss: 9.0378 - accuracy10: 0.6672 - accuracy20: 0.6530 - accuracy30: 0.6315 - accuracy50: 0.5954 - val_loss: 9.8332 - val_accuracy10: 0.6790 - val_accuracy20: 0.6507 - val_accuracy30: 0.6187 - val_accuracy50: 0.5683 - 83s/epoch - 40ms/step
Epoch 27/50
2076/2076 - 82s - loss: 9.0283 - accuracy10: 0.6668 - accuracy20: 0.6528 - accuracy30: 0.6311 - accuracy50: 0.5955 - val_loss: 9.8770 - val_accuracy10: 0.6880 - val_accuracy20: 0.6578 - val_accuracy30: 0.6236 - val_accuracy50: 0.5704 - 82s/epoch - 40ms/step
Epoch 28/50
2076/2076 - 83s - loss: 9.0140 - accuracy10: 0.6674 - accuracy20: 0.6531 - accuracy30: 0.6319 - accuracy50: 0.5964 - val_loss: 9.9195 - val_accuracy10: 0.6684 - val_accuracy20: 0.6405 - val_accuracy30: 0.6100 - val_accuracy50: 0.5608 - 83s/epoch - 40ms/step
Epoch 29/50
2076/2076 - 82s - loss: 8.9971 - accuracy10: 0.6684 - accuracy20: 0.6542 - accuracy30: 0.6322 - accuracy50: 0.5967 - val_loss: 9.9566 - val_accuracy10: 0.6652 - val_accuracy20: 0.6360 - val_accuracy30: 0.6049 - val_accuracy50: 0.5586 - 82s/epoch - 40ms/step
Epoch 30/50
2076/2076 - 84s - loss: 8.9837 - accuracy10: 0.6685 - accuracy20: 0.6542 - accuracy30: 0.6323 - accuracy50: 0.5970 - val_loss: 9.9439 - val_accuracy10: 0.6927 - val_accuracy20: 0.6606 - val_accuracy30: 0.6250 - val_accuracy50: 0.5697 - 84s/epoch - 40ms/step
Epoch 31/50
2076/2076 - 83s - loss: 8.9731 - accuracy10: 0.6689 - accuracy20: 0.6545 - accuracy30: 0.6329 - accuracy50: 0.5979 - val_loss: 9.9767 - val_accuracy10: 0.6897 - val_accuracy20: 0.6586 - val_accuracy30: 0.6236 - val_accuracy50: 0.5689 - 83s/epoch - 40ms/step
Epoch 32/50
2076/2076 - 83s - loss: 8.9538 - accuracy10: 0.6695 - accuracy20: 0.6552 - accuracy30: 0.6337 - accuracy50: 0.5985 - val_loss: 9.9868 - val_accuracy10: 0.6710 - val_accuracy20: 0.6435 - val_accuracy30: 0.6114 - val_accuracy50: 0.5618 - 83s/epoch - 40ms/step
testing model: results/AAL/W2/deepVOL_L3/seq2seq
Evaluating performance on  test set...
4856/4856 - 79s - 79s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9334484
{'0': {'precision': 0.4213330616108759, 'recall': 0.5204175260243272, 'f1-score': 0.46566280379263997, 'support': 246308}, '1': {'precision': 0.8797218372941852, 'recall': 0.5007296932663485, 'f1-score': 0.6382011044881225, 'support': 761964}, '2': {'precision': 0.35556369685327843, 'recall': 0.7652333644457514, 'f1-score': 0.4855280468034878, 'support': 234633}, 'accuracy': 0.5545637035815287, 'macro avg': {'precision': 0.5522061985861132, 'recall': 0.595460194578809, 'f1-score': 0.5297973183614167, 'support': 1242905}, 'weighted avg': {'precision': 0.6899328996625272, 'recall': 0.5545637035815287, 'f1-score': 0.5751876792372612, 'support': 1242905}}
[[128183  30837  87288]
 [142293 381538 238133]
 [ 33756  21328 179549]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.93575746
{'0': {'precision': 0.47390430437407044, 'recall': 0.49515282735482863, 'f1-score': 0.484295607603228, 'support': 307602}, '1': {'precision': 0.8070442565426412, 'recall': 0.4914496659878695, 'f1-score': 0.6108948581636354, 'support': 637402}, '2': {'precision': 0.41188116955555765, 'recall': 0.7374362623824694, 'f1-score': 0.5285504279015382, 'support': 297901}, 'accuracy': 0.5513245179639634, 'macro avg': {'precision': 0.5642765768240898, 'recall': 0.5746795852417225, 'f1-score': 0.5412469645561339, 'support': 1242905}, 'weighted avg': {'precision': 0.6298834965943783, 'recall': 0.5513245179639634, 'f1-score': 0.5598268595713122, 'support': 1242905}}
[[152310  44034 111258]
 [121727 313251 202424]
 [ 47357  30861 219683]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9464253
{'0': {'precision': 0.4995014183255088, 'recall': 0.4623518755267126, 'f1-score': 0.4802092357892042, 'support': 348862}, '1': {'precision': 0.7383437136480266, 'recall': 0.47791391814045314, 'f1-score': 0.580246697576765, 'support': 555146}, '2': {'precision': 0.43512142048140123, 'recall': 0.7198440824203224, 'f1-score': 0.5423877663548077, 'support': 338897}, 'accuracy': 0.5395118693705472, 'macro avg': {'precision': 0.5576555174849789, 'recall': 0.5533699586958294, 'f1-score': 0.534281233240259, 'support': 1242905}, 'weighted avg': {'precision': 0.5886266183607005, 'recall': 0.5395118693705472, 'f1-score': 0.5418450922984375, 'support': 1242905}}
[[161297  54867 132698]
 [105830 265312 184004]
 [ 55789  39155 243953]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9664706
{'0': {'precision': 0.5207988017335262, 'recall': 0.40229230036733055, 'f1-score': 0.4539386145118278, 'support': 405357}, '1': {'precision': 0.6165030319230411, 'recall': 0.4611915952943714, 'f1-score': 0.5276559975631104, 'support': 445084}, '2': {'precision': 0.4580357187737191, 'recall': 0.6965454156304782, 'f1-score': 0.5526552800838578, 'support': 392464}, 'accuracy': 0.5162985103447166, 'macro avg': {'precision': 0.5317791841434288, 'recall': 0.5200097704307267, 'f1-score': 0.5114166307195988, 'support': 1242905}, 'weighted avg': {'precision': 0.5352521758843523, 'recall': 0.5162985103447166, 'f1-score': 0.5115079099568202, 'support': 1242905}}
[[163072  73526 168759]
 [ 85114 205269 154701]
 [ 64933  54162 273369]]
Evaluating performance on  train set...
2076/2076 - 35s - 35s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7098077
{'0': {'precision': 0.4322203034032036, 'recall': 0.5742292685607517, 'f1-score': 0.49320612893899973, 'support': 72788}, '1': {'precision': 0.9086478738652651, 'recall': 0.6685998213546319, 'f1-score': 0.7703568792419542, 'support': 384001}, '2': {'precision': 0.36847363163152635, 'recall': 0.7513166534889643, 'f1-score': 0.494450397534098, 'support': 74621}, 'accuracy': 0.6672889106339738, 'macro avg': {'precision': 0.5697806029666651, 'recall': 0.6647152478014493, 'f1-score': 0.586004468571684, 'support': 531410}, 'weighted avg': {'precision': 0.767539215525158, 'recall': 0.6672889106339738, 'f1-score': 0.693652138298853, 'support': 531410}}
[[ 41797  14854  16137]
 [ 47307 256743  79951]
 [  7599  10958  56064]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.74580574
{'0': {'precision': 0.500309071240921, 'recall': 0.5378297841412893, 'f1-score': 0.5183913854960495, 'support': 96313}, '1': {'precision': 0.8478041789763692, 'recall': 0.6569552862788647, 'f1-score': 0.7402770342612419, 'support': 336787}, '2': {'precision': 0.4246169885141491, 'recall': 0.720872749465975, 'f1-score': 0.5344348462167858, 'support': 98310}, 'accuracy': 0.6471895523230651, 'macro avg': {'precision': 0.5909100795771464, 'recall': 0.6385526066287097, 'f1-score': 0.5977010886580257, 'support': 531410}, 'weighted avg': {'precision': 0.7065350477863932, 'recall': 0.6471895523230651, 'f1-score': 0.6619818986857494, 'support': 531410}}
[[ 51800  23033  21480]
 [ 40981 221254  74552]
 [ 10755  16686  70869]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7905085
{'0': {'precision': 0.5320213822791996, 'recall': 0.4971707455085585, 'f1-score': 0.5140060055119082, 'support': 113104}, '1': {'precision': 0.7883781054332458, 'recall': 0.6438005951006459, 'f1-score': 0.7087918473484272, 'support': 303142}, '2': {'precision': 0.45085173855695565, 'recall': 0.6974922718905213, 'f1-score': 0.5476853635337795, 'support': 115164}, 'accuracy': 0.6242279972149565, 'macro avg': {'precision': 0.5904170754231337, 'recall': 0.6128212041665752, 'f1-score': 0.5901610721313716, 'support': 531410}, 'weighted avg': {'precision': 0.6606690722374905, 'recall': 0.6242279972149565, 'f1-score': 0.6324200723402268, 'support': 531410}}
[[ 56232  30432  26440]
 [ 36580 195163  71399]
 [ 12883  21955  80326]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.86455053
{'0': {'precision': 0.5597971093742634, 'recall': 0.42919410450835965, 'f1-score': 0.4858721001595679, 'support': 138343}, '1': {'precision': 0.6753906233400898, 'recall': 0.6298679939921613, 'f1-score': 0.6518354775604616, 'support': 252337}, '2': {'precision': 0.48030671424210847, 'recall': 0.6485113337596816, 'f1-score': 0.55187698038362, 'support': 140730}, 'accuracy': 0.5825633691499972, 'macro avg': {'precision': 0.5718314823188205, 'recall': 0.5691911440867342, 'f1-score': 0.5631948527012165, 'support': 531410}, 'weighted avg': {'precision': 0.5936350823643212, 'recall': 0.5825633691499972, 'f1-score': 0.582158522238829, 'support': 531410}}
[[ 59376  43242  35725]
 [ 30374 158939  63024]
 [ 16317  33148  91265]]
Evaluating performance on  val set...
588/588 - 10s - 10s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6907317
{'0': {'precision': 0.43293253923661834, 'recall': 0.5717536482809795, 'f1-score': 0.49275238744884037, 'support': 20215}, '1': {'precision': 0.9021205436561588, 'recall': 0.6914308569143086, 'f1-score': 0.7828476449732156, 'support': 110011}, '2': {'precision': 0.3710650209950375, 'recall': 0.7260007966540529, 'f1-score': 0.4911163879486014, 'support': 20084}, 'accuracy': 0.6799547601623311, 'macro avg': {'precision': 0.5687060346292715, 'recall': 0.6630617672831137, 'f1-score': 0.5889054734568858, 'support': 150310}, 'weighted avg': {'precision': 0.7680619006752064, 'recall': 0.6799547601623311, 'f1-score': 0.7048527930209996, 'support': 150310}}
[[11558  4708  3949]
 [13181 76065 20765]
 [ 1958  3545 14581]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7404582
{'0': {'precision': 0.4995797730774618, 'recall': 0.5294685273159145, 'f1-score': 0.5140900900900901, 'support': 26944}, '1': {'precision': 0.8358596850595315, 'recall': 0.6759255424879907, 'f1-score': 0.7474327712333001, 'support': 96592}, '2': {'precision': 0.4256026028778297, 'recall': 0.6937700754463285, 'f1-score': 0.5275639751199978, 'support': 26774}, 'accuracy': 0.652850775064866, 'macro avg': {'precision': 0.5870140203382743, 'recall': 0.6330547150834113, 'f1-score': 0.5963622788144627, 'support': 150310}, 'weighted avg': {'precision': 0.7025022965505981, 'recall': 0.652850775064866, 'f1-score': 0.6664404729972533, 'support': 150310}}
[[14266  7355  5323]
 [11557 65289 19746]
 [ 2733  5466 18575]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7969852
{'0': {'precision': 0.5246981339187706, 'recall': 0.47955856533734637, 'f1-score': 0.501113877604508, 'support': 31896}, '1': {'precision': 0.7684069972890226, 'recall': 0.6567226115824419, 'f1-score': 0.7081885701855248, 'support': 86752}, '2': {'precision': 0.4477719876635117, 'recall': 0.6648979849662056, 'f1-score': 0.5351500438501723, 'support': 31662}, 'accuracy': 0.6208502428314816, 'macro avg': {'precision': 0.5802923729571017, 'recall': 0.6003930539619979, 'f1-score': 0.5814841638800683, 'support': 150310}, 'weighted avg': {'precision': 0.6491515679708103, 'recall': 0.6208502428314816, 'f1-score': 0.6277973772150368, 'support': 150310}}
[[15296  9850  6750]
 [10567 56972 19213]
 [ 3289  7321 21052]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8838411
{'0': {'precision': 0.5447511929107021, 'recall': 0.40576288398070576, 'f1-score': 0.4650953004510403, 'support': 39390}, '1': {'precision': 0.6461183334749483, 'recall': 0.6347296225706376, 'f1-score': 0.6403733464332082, 'support': 71881}, '2': {'precision': 0.4726149813329097, 'recall': 0.6096211480826865, 'f1-score': 0.532445886235248, 'support': 39039}, 'accuracy': 0.568205708203047, 'macro avg': {'precision': 0.5544948359061866, 'recall': 0.55003788487801, 'f1-score': 0.5459715110398321, 'support': 150310}, 'weighted avg': {'precision': 0.5744913689942172, 'recall': 0.568205708203047, 'f1-score': 0.5664089904362303, 'support': 150310}}
[[15983 14068  9339]
 [ 9038 45625 17218]
 [ 4319 10921 23799]]
training model: results/AAL/W3/deepLOB_L1/seq2seq
Epoch 1/50
2159/2159 - 65s - loss: 11.5676 - accuracy10: 0.4495 - accuracy20: 0.4736 - accuracy30: 0.4827 - accuracy50: 0.4833 - val_loss: 12.2943 - val_accuracy10: 0.6390 - val_accuracy20: 0.6054 - val_accuracy30: 0.5670 - val_accuracy50: 0.4880 - 65s/epoch - 30ms/step
Epoch 2/50
2159/2159 - 56s - loss: 11.0575 - accuracy10: 0.5003 - accuracy20: 0.5155 - accuracy30: 0.5184 - accuracy50: 0.5087 - val_loss: 11.2331 - val_accuracy10: 0.6251 - val_accuracy20: 0.6053 - val_accuracy30: 0.5817 - val_accuracy50: 0.5267 - 56s/epoch - 26ms/step
Epoch 3/50
2159/2159 - 60s - loss: 10.5990 - accuracy10: 0.5544 - accuracy20: 0.5563 - accuracy30: 0.5487 - accuracy50: 0.5295 - val_loss: 11.0299 - val_accuracy10: 0.6531 - val_accuracy20: 0.6284 - val_accuracy30: 0.6008 - val_accuracy50: 0.5443 - 60s/epoch - 28ms/step
Epoch 4/50
2159/2159 - 58s - loss: 10.3883 - accuracy10: 0.5751 - accuracy20: 0.5719 - accuracy30: 0.5605 - accuracy50: 0.5371 - val_loss: 11.1366 - val_accuracy10: 0.6602 - val_accuracy20: 0.6358 - val_accuracy30: 0.6073 - val_accuracy50: 0.5476 - 58s/epoch - 27ms/step
Epoch 5/50
2159/2159 - 60s - loss: 10.2622 - accuracy10: 0.5871 - accuracy20: 0.5819 - accuracy30: 0.5679 - accuracy50: 0.5425 - val_loss: 11.2278 - val_accuracy10: 0.6864 - val_accuracy20: 0.6518 - val_accuracy30: 0.6168 - val_accuracy50: 0.5475 - 60s/epoch - 28ms/step
Epoch 6/50
2159/2159 - 61s - loss: 10.1764 - accuracy10: 0.5932 - accuracy20: 0.5863 - accuracy30: 0.5721 - accuracy50: 0.5458 - val_loss: 11.5108 - val_accuracy10: 0.6872 - val_accuracy20: 0.6503 - val_accuracy30: 0.6146 - val_accuracy50: 0.5454 - 61s/epoch - 28ms/step
Epoch 7/50
2159/2159 - 58s - loss: 10.1072 - accuracy10: 0.5990 - accuracy20: 0.5913 - accuracy30: 0.5770 - accuracy50: 0.5494 - val_loss: 11.3319 - val_accuracy10: 0.6951 - val_accuracy20: 0.6561 - val_accuracy30: 0.6181 - val_accuracy50: 0.5462 - 58s/epoch - 27ms/step
Epoch 8/50
2159/2159 - 58s - loss: 10.0524 - accuracy10: 0.6027 - accuracy20: 0.5941 - accuracy30: 0.5793 - accuracy50: 0.5517 - val_loss: 11.0197 - val_accuracy10: 0.6864 - val_accuracy20: 0.6524 - val_accuracy30: 0.6176 - val_accuracy50: 0.5510 - 58s/epoch - 27ms/step
Epoch 9/50
2159/2159 - 54s - loss: 10.0077 - accuracy10: 0.6057 - accuracy20: 0.5971 - accuracy30: 0.5818 - accuracy50: 0.5532 - val_loss: 10.9025 - val_accuracy10: 0.6837 - val_accuracy20: 0.6512 - val_accuracy30: 0.6175 - val_accuracy50: 0.5523 - 54s/epoch - 25ms/step
Epoch 10/50
2159/2159 - 55s - loss: 9.9691 - accuracy10: 0.6086 - accuracy20: 0.5992 - accuracy30: 0.5839 - accuracy50: 0.5553 - val_loss: 10.8739 - val_accuracy10: 0.6809 - val_accuracy20: 0.6498 - val_accuracy30: 0.6173 - val_accuracy50: 0.5540 - 55s/epoch - 26ms/step
Epoch 11/50
2159/2159 - 54s - loss: 9.9345 - accuracy10: 0.6111 - accuracy20: 0.6014 - accuracy30: 0.5855 - accuracy50: 0.5563 - val_loss: 10.7931 - val_accuracy10: 0.6874 - val_accuracy20: 0.6554 - val_accuracy30: 0.6214 - val_accuracy50: 0.5570 - 54s/epoch - 25ms/step
Epoch 12/50
2159/2159 - 53s - loss: 9.9048 - accuracy10: 0.6129 - accuracy20: 0.6036 - accuracy30: 0.5876 - accuracy50: 0.5575 - val_loss: 10.8597 - val_accuracy10: 0.6848 - val_accuracy20: 0.6528 - val_accuracy30: 0.6195 - val_accuracy50: 0.5550 - 53s/epoch - 25ms/step
Epoch 13/50
2159/2159 - 55s - loss: 9.8862 - accuracy10: 0.6144 - accuracy20: 0.6050 - accuracy30: 0.5884 - accuracy50: 0.5580 - val_loss: 10.7346 - val_accuracy10: 0.6796 - val_accuracy20: 0.6514 - val_accuracy30: 0.6190 - val_accuracy50: 0.5572 - 55s/epoch - 26ms/step
Epoch 14/50
2159/2159 - 58s - loss: 9.8618 - accuracy10: 0.6158 - accuracy20: 0.6061 - accuracy30: 0.5898 - accuracy50: 0.5590 - val_loss: 10.7463 - val_accuracy10: 0.6804 - val_accuracy20: 0.6525 - val_accuracy30: 0.6207 - val_accuracy50: 0.5588 - 58s/epoch - 27ms/step
Epoch 15/50
2159/2159 - 57s - loss: 9.8397 - accuracy10: 0.6169 - accuracy20: 0.6072 - accuracy30: 0.5904 - accuracy50: 0.5600 - val_loss: 10.6410 - val_accuracy10: 0.6822 - val_accuracy20: 0.6537 - val_accuracy30: 0.6213 - val_accuracy50: 0.5599 - 57s/epoch - 27ms/step
Epoch 16/50
2159/2159 - 52s - loss: 9.8208 - accuracy10: 0.6177 - accuracy20: 0.6087 - accuracy30: 0.5922 - accuracy50: 0.5612 - val_loss: 10.6736 - val_accuracy10: 0.6867 - val_accuracy20: 0.6563 - val_accuracy30: 0.6227 - val_accuracy50: 0.5598 - 52s/epoch - 24ms/step
Epoch 17/50
2159/2159 - 53s - loss: 9.8022 - accuracy10: 0.6183 - accuracy20: 0.6094 - accuracy30: 0.5929 - accuracy50: 0.5621 - val_loss: 10.7329 - val_accuracy10: 0.6884 - val_accuracy20: 0.6578 - val_accuracy30: 0.6240 - val_accuracy50: 0.5594 - 53s/epoch - 24ms/step
Epoch 18/50
2159/2159 - 57s - loss: 9.7877 - accuracy10: 0.6196 - accuracy20: 0.6106 - accuracy30: 0.5935 - accuracy50: 0.5629 - val_loss: 10.6630 - val_accuracy10: 0.6884 - val_accuracy20: 0.6592 - val_accuracy30: 0.6248 - val_accuracy50: 0.5603 - 57s/epoch - 26ms/step
Epoch 19/50
2159/2159 - 58s - loss: 9.7743 - accuracy10: 0.6201 - accuracy20: 0.6105 - accuracy30: 0.5936 - accuracy50: 0.5632 - val_loss: 10.5670 - val_accuracy10: 0.6873 - val_accuracy20: 0.6595 - val_accuracy30: 0.6263 - val_accuracy50: 0.5619 - 58s/epoch - 27ms/step
Epoch 20/50
2159/2159 - 57s - loss: 9.7544 - accuracy10: 0.6209 - accuracy20: 0.6115 - accuracy30: 0.5943 - accuracy50: 0.5637 - val_loss: 10.7508 - val_accuracy10: 0.6921 - val_accuracy20: 0.6600 - val_accuracy30: 0.6255 - val_accuracy50: 0.5594 - 57s/epoch - 26ms/step
Epoch 21/50
2159/2159 - 56s - loss: 9.7381 - accuracy10: 0.6218 - accuracy20: 0.6126 - accuracy30: 0.5956 - accuracy50: 0.5649 - val_loss: 10.6935 - val_accuracy10: 0.6957 - val_accuracy20: 0.6634 - val_accuracy30: 0.6273 - val_accuracy50: 0.5601 - 56s/epoch - 26ms/step
Epoch 22/50
2159/2159 - 55s - loss: 9.7265 - accuracy10: 0.6219 - accuracy20: 0.6130 - accuracy30: 0.5964 - accuracy50: 0.5653 - val_loss: 10.6582 - val_accuracy10: 0.6850 - val_accuracy20: 0.6568 - val_accuracy30: 0.6240 - val_accuracy50: 0.5606 - 55s/epoch - 25ms/step
Epoch 23/50
2159/2159 - 53s - loss: 9.7164 - accuracy10: 0.6219 - accuracy20: 0.6133 - accuracy30: 0.5968 - accuracy50: 0.5657 - val_loss: 10.5482 - val_accuracy10: 0.6801 - val_accuracy20: 0.6544 - val_accuracy30: 0.6224 - val_accuracy50: 0.5613 - 53s/epoch - 25ms/step
Epoch 24/50
2159/2159 - 53s - loss: 9.6997 - accuracy10: 0.6229 - accuracy20: 0.6142 - accuracy30: 0.5969 - accuracy50: 0.5662 - val_loss: 10.5538 - val_accuracy10: 0.6843 - val_accuracy20: 0.6577 - val_accuracy30: 0.6246 - val_accuracy50: 0.5613 - 53s/epoch - 25ms/step
Epoch 25/50
2159/2159 - 56s - loss: 9.6873 - accuracy10: 0.6236 - accuracy20: 0.6151 - accuracy30: 0.5981 - accuracy50: 0.5668 - val_loss: 10.5509 - val_accuracy10: 0.6869 - val_accuracy20: 0.6600 - val_accuracy30: 0.6262 - val_accuracy50: 0.5630 - 56s/epoch - 26ms/step
Epoch 26/50
2159/2159 - 55s - loss: 9.6686 - accuracy10: 0.6246 - accuracy20: 0.6160 - accuracy30: 0.5991 - accuracy50: 0.5678 - val_loss: 10.5475 - val_accuracy10: 0.6856 - val_accuracy20: 0.6577 - val_accuracy30: 0.6243 - val_accuracy50: 0.5613 - 55s/epoch - 25ms/step
Epoch 27/50
2159/2159 - 59s - loss: 9.6580 - accuracy10: 0.6248 - accuracy20: 0.6167 - accuracy30: 0.5995 - accuracy50: 0.5682 - val_loss: 10.5943 - val_accuracy10: 0.6906 - val_accuracy20: 0.6610 - val_accuracy30: 0.6265 - val_accuracy50: 0.5603 - 59s/epoch - 27ms/step
Epoch 28/50
2159/2159 - 55s - loss: 9.6454 - accuracy10: 0.6257 - accuracy20: 0.6178 - accuracy30: 0.6002 - accuracy50: 0.5687 - val_loss: 10.5816 - val_accuracy10: 0.6817 - val_accuracy20: 0.6564 - val_accuracy30: 0.6243 - val_accuracy50: 0.5612 - 55s/epoch - 25ms/step
Epoch 29/50
2159/2159 - 52s - loss: 9.6301 - accuracy10: 0.6257 - accuracy20: 0.6180 - accuracy30: 0.6006 - accuracy50: 0.5690 - val_loss: 10.7232 - val_accuracy10: 0.6920 - val_accuracy20: 0.6621 - val_accuracy30: 0.6273 - val_accuracy50: 0.5601 - 52s/epoch - 24ms/step
Epoch 30/50
2159/2159 - 53s - loss: 9.6195 - accuracy10: 0.6255 - accuracy20: 0.6180 - accuracy30: 0.6010 - accuracy50: 0.5696 - val_loss: 10.6243 - val_accuracy10: 0.6803 - val_accuracy20: 0.6538 - val_accuracy30: 0.6212 - val_accuracy50: 0.5593 - 53s/epoch - 24ms/step
Epoch 31/50
2159/2159 - 58s - loss: 9.6127 - accuracy10: 0.6258 - accuracy20: 0.6182 - accuracy30: 0.6016 - accuracy50: 0.5699 - val_loss: 10.6529 - val_accuracy10: 0.6854 - val_accuracy20: 0.6585 - val_accuracy30: 0.6250 - val_accuracy50: 0.5606 - 58s/epoch - 27ms/step
Epoch 32/50
2159/2159 - 57s - loss: 9.5971 - accuracy10: 0.6265 - accuracy20: 0.6192 - accuracy30: 0.6027 - accuracy50: 0.5709 - val_loss: 10.7334 - val_accuracy10: 0.6824 - val_accuracy20: 0.6550 - val_accuracy30: 0.6217 - val_accuracy50: 0.5581 - 57s/epoch - 26ms/step
Epoch 33/50
2159/2159 - 56s - loss: 9.5875 - accuracy10: 0.6261 - accuracy20: 0.6193 - accuracy30: 0.6023 - accuracy50: 0.5707 - val_loss: 10.6915 - val_accuracy10: 0.6837 - val_accuracy20: 0.6562 - val_accuracy30: 0.6230 - val_accuracy50: 0.5586 - 56s/epoch - 26ms/step
Epoch 34/50
2159/2159 - 59s - loss: 9.5751 - accuracy10: 0.6274 - accuracy20: 0.6204 - accuracy30: 0.6031 - accuracy50: 0.5716 - val_loss: 10.5837 - val_accuracy10: 0.6841 - val_accuracy20: 0.6567 - val_accuracy30: 0.6234 - val_accuracy50: 0.5600 - 59s/epoch - 27ms/step
Epoch 35/50
2159/2159 - 56s - loss: 9.5590 - accuracy10: 0.6279 - accuracy20: 0.6205 - accuracy30: 0.6041 - accuracy50: 0.5725 - val_loss: 10.6605 - val_accuracy10: 0.6831 - val_accuracy20: 0.6543 - val_accuracy30: 0.6222 - val_accuracy50: 0.5597 - 56s/epoch - 26ms/step
Epoch 36/50
2159/2159 - 56s - loss: 9.5561 - accuracy10: 0.6271 - accuracy20: 0.6206 - accuracy30: 0.6039 - accuracy50: 0.5725 - val_loss: 10.6279 - val_accuracy10: 0.6837 - val_accuracy20: 0.6549 - val_accuracy30: 0.6227 - val_accuracy50: 0.5601 - 56s/epoch - 26ms/step
testing model: results/AAL/W3/deepLOB_L1/seq2seq
Evaluating performance on  test set...
5760/5760 - 53s - 53s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.58729243
{'0': {'precision': 0.3574459886323881, 'recall': 0.4618246850659347, 'f1-score': 0.40298618375548045, 'support': 152651}, '1': {'precision': 0.8438355135241514, 'recall': 0.8854368832210417, 'f1-score': 0.8641357931258828, 'support': 1167051}, '2': {'precision': 0.44730994929449075, 'recall': 0.15218809968404526, 'f1-score': 0.22710749857780607, 'support': 154769}, 'accuracy': 0.7646145634603868, 'macro avg': {'precision': 0.5495304838170101, 'recall': 0.4998165559903405, 'f1-score': 0.49807649181972313, 'support': 1474471}, 'weighted avg': {'precision': 0.7518583146409499, 'recall': 0.7646145634603868, 'f1-score': 0.7495271089680305, 'support': 1474471}}
[[  70498   76817    5336]
 [ 109934 1033350   23767]
 [  16795  114420   23554]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.67810166
{'0': {'precision': 0.4381731879409878, 'recall': 0.4069514740785222, 'f1-score': 0.42198561407063484, 'support': 209826}, '1': {'precision': 0.7757499981480003, 'recall': 0.892165187551769, 'f1-score': 0.8298948873717792, 'support': 1056375}, '2': {'precision': 0.500394169384632, 'recall': 0.15543285158688241, 'f1-score': 0.23718965574088796, 'support': 208270}, 'accuracy': 0.7190524601704611, 'macro avg': {'precision': 0.5714391184912068, 'recall': 0.4848498377390578, 'f1-score': 0.4963567190611007, 'support': 1474471}, 'weighted avg': {'precision': 0.6888166164571815, 'recall': 0.7190524601704611, 'f1-score': 0.6881269653363837, 'support': 1474471}}
[[ 85389 117481   6956]
 [ 88549 942461  25365]
 [ 20937 154961  32372]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.74843675
{'0': {'precision': 0.48522124088716606, 'recall': 0.34773241153978196, 'f1-score': 0.40512974937418256, 'support': 253419}, '1': {'precision': 0.7176746694249029, 'recall': 0.9028965991521044, 'f1-score': 0.7997007362599237, 'support': 971346}, '2': {'precision': 0.534452571234927, 'recall': 0.15158226073862863, 'f1-score': 0.236179054559976, 'support': 249706}, 'accuracy': 0.6802426090441928, 'macro avg': {'precision': 0.5791161605156653, 'recall': 0.467403757143505, 'f1-score': 0.48033651339802735, 'support': 1474471}, 'weighted avg': {'precision': 0.6466934343533206, 'recall': 0.6802426090441928, 'f1-score': 0.6364513200447761, 'support': 1474471}}
[[ 88122 157246   8051]
 [ 69401 877025  24920]
 [ 24089 187766  37851]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8550776
{'0': {'precision': 0.5301478740765656, 'recall': 0.26335723148615153, 'f1-score': 0.35190265422693756, 'support': 323177}, '1': {'precision': 0.6170048077271588, 'recall': 0.9176580515707825, 'f1-score': 0.7378811916093777, 'support': 834775}, '2': {'precision': 0.5653855717956511, 'recall': 0.1293002947690344, 'f1-score': 0.21046785204612953, 'support': 316519}, 'accuracy': 0.6050135947061692, 'macro avg': {'precision': 0.5708460845331251, 'recall': 0.43677185927532286, 'f1-score': 0.43341723262748166, 'support': 1474471}, 'weighted avg': {'precision': 0.5868864587164271, 'recall': 0.6050135947061692, 'f1-score': 0.5400639889645887, 'support': 1474471}}
[[ 85111 228362   9704]
 [ 46981 766038  21756]
 [ 28450 247143  40926]]
Evaluating performance on  train set...
2159/2159 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7422636
{'0': {'precision': 0.35753883165106426, 'recall': 0.6714464605789771, 'f1-score': 0.46661149550810077, 'support': 81454}, '1': {'precision': 0.8353867007146445, 'recall': 0.7102887645507749, 'f1-score': 0.7677753848164518, 'support': 388725}, '2': {'precision': 0.45458099830574744, 'recall': 0.38115590092277807, 'f1-score': 0.41464300573911783, 'support': 82360}, 'accuracy': 0.6555030504634062, 'macro avg': {'precision': 0.549168843557152, 'recall': 0.5876303753508434, 'f1-score': 0.5496766286878901, 'support': 552539}, 'weighted avg': {'precision': 0.708181602111466, 'recall': 0.6555030504634062, 'f1-score': 0.6707415352953653, 'support': 552539}}
[[ 54692  20759   6003]
 [ 80956 276107  31662]
 [ 17320  33648  31392]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8013059
{'0': {'precision': 0.43303925228747897, 'recall': 0.6075051455454278, 'f1-score': 0.5056460340100416, 'support': 108832}, '1': {'precision': 0.7477363285345966, 'recall': 0.7265069952386232, 'f1-score': 0.7369688090349389, 'support': 333727}, '2': {'precision': 0.5195349698444609, 'recall': 0.3571649390798327, 'f1-score': 0.42331400737116626, 'support': 109980}, 'accuracy': 0.6295519411299474, 'macro avg': {'precision': 0.5667701835555121, 'recall': 0.5637256932879612, 'f1-score': 0.5553096168053823, 'support': 552539}, 'weighted avg': {'precision': 0.6403290728822945, 'recall': 0.6295519411299474, 'f1-score': 0.6289744858496228, 'support': 552539}}
[[ 66116  33921   8795]
 [ 63740 242455  27532]
 [ 22823  47876  39281]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8543188
{'0': {'precision': 0.4714035483485715, 'recall': 0.5530224014197426, 'f1-score': 0.5089615748302243, 'support': 128474}, '1': {'precision': 0.6734921306903078, 'recall': 0.7351439143479428, 'f1-score': 0.702968865495366, 'support': 294307}, '2': {'precision': 0.546001762376975, 'recall': 0.33903882612247416, 'f1-score': 0.41832159786241685, 'support': 129758}, 'accuracy': 0.5997766673483682, 'macro avg': {'precision': 0.5636324804719514, 'recall': 0.5424017139633864, 'f1-score': 0.5434173460626691, 'support': 552539}, 'weighted avg': {'precision': 0.5965635813220755, 'recall': 0.5997766673483682, 'f1-score': 0.5910126907919883, 'support': 552539}}
[[ 71049  45965  11460]
 [ 52829 216358  25120]
 [ 26840  58925  43993]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9463243
{'0': {'precision': 0.5056853421542278, 'recall': 0.46901065468467373, 'f1-score': 0.48665802292691174, 'support': 156457}, '1': {'precision': 0.5495492721854142, 'recall': 0.74841928721174, 'f1-score': 0.633749210023646, 'support': 238500}, '2': {'precision': 0.5610438024231128, 'recall': 0.294157962203805, 'f1-score': 0.3859568781405728, 'support': 157582}, 'accuracy': 0.5397483254575695, 'macro avg': {'precision': 0.5387594722542516, 'recall': 0.503862634700073, 'f1-score': 0.5021213703637102, 'support': 552539}, 'weighted avg': {'precision': 0.5404069531147743, 'recall': 0.5397483254575695, 'f1-score': 0.5214294333157716, 'support': 552539}}
[[ 73380  67652  15425]
 [ 39160 178498  20842]
 [ 32570  78658  46354]]
Evaluating performance on  val set...
850/850 - 8s - 8s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.69103277
{'0': {'precision': 0.3749007456182822, 'recall': 0.6478147379693461, 'f1-score': 0.47494387673736765, 'support': 29882}, '1': {'precision': 0.8593430144477701, 'recall': 0.7374789915966387, 'f1-score': 0.7937608792108946, 'support': 157675}, '2': {'precision': 0.4448100016450074, 'recall': 0.45387404323888814, 'f1-score': 0.4492963129122842, 'support': 29788}, 'accuracy': 0.6862821781039361, 'macro avg': {'precision': 0.5596845872370199, 'recall': 0.613055924268291, 'f1-score': 0.5726670229535155, 'support': 217345}, 'weighted avg': {'precision': 0.7359253454766345, 'recall': 0.6862821781039361, 'f1-score': 0.702717606217189, 'support': 217345}}
[[ 19358   8105   2419]
 [ 26937 116282  14456]
 [  5340  10928  13520]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7552578
{'0': {'precision': 0.4493180046765394, 'recall': 0.5785578081091931, 'f1-score': 0.5058129332280425, 'support': 39856}, '1': {'precision': 0.7759543936704671, 'recall': 0.7496476058998764, 'f1-score': 0.7625741886368508, 'support': 137630}, '2': {'precision': 0.505610840567436, 'recall': 0.419378308537595, 'f1-score': 0.4584750411409764, 'support': 39859}, 'accuracy': 0.6577054912696404, 'macro avg': {'precision': 0.5769610796381475, 'recall': 0.5825279075155548, 'f1-score': 0.5756207210019566, 'support': 217345}, 'weighted avg': {'precision': 0.6664784747265038, 'recall': 0.6577054912696404, 'f1-score': 0.6597212841963919, 'support': 217345}}
[[ 23059  13354   3443]
 [ 21554 103174  12902]
 [  6707  16436  16716]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.817489
{'0': {'precision': 0.48589174800354923, 'recall': 0.5214686276584488, 'f1-score': 0.5030519546800041, 'support': 47255}, '1': {'precision': 0.702352011668895, 'recall': 0.7521069929387264, 'f1-score': 0.7263784786058863, 'support': 122924}, '2': {'precision': 0.5302588719355392, 'recall': 0.3934613916804478, 'f1-score': 0.45173068497152036, 'support': 47166}, 'accuracy': 0.624132140145851, 'macro avg': {'precision': 0.5728342105359945, 'recall': 0.555679004092541, 'f1-score': 0.5603870394191369, 'support': 217345}, 'weighted avg': {'precision': 0.6179434686236474, 'recall': 0.624132140145851, 'f1-score': 0.6182217106900104, 'support': 217345}}
[[24642 18310  4303]
 [18335 92452 12137]
 [ 7738 20870 18558]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.91890484
{'0': {'precision': 0.5215057081147794, 'recall': 0.43502805470237993, 'f1-score': 0.4743577749920482, 'support': 58279}, '1': {'precision': 0.5776158094450915, 'recall': 0.7607247825355513, 'f1-score': 0.6566440017767451, 'support': 101051}, '2': {'precision': 0.5517463879927058, 'recall': 0.3389985348616737, 'f1-score': 0.4199658338671791, 'support': 58015}, 'accuracy': 0.5608226552255631, 'macro avg': {'precision': 0.5502893018508589, 'recall': 0.5115837906998683, 'f1-score': 0.5169892035453242, 'support': 217345}, 'weighted avg': {'precision': 0.5556652005928547, 'recall': 0.5608226552255631, 'f1-score': 0.5445901568663086, 'support': 217345}}
[[25353 27154  5772]
 [13973 76872 10206]
 [ 9289 29059 19667]]
training model: results/AAL/W3/deepOF_L1/seq2seq
Epoch 1/50
2159/2159 - 60s - loss: 12.5772 - accuracy10: 0.3904 - accuracy20: 0.4114 - accuracy30: 0.4208 - accuracy50: 0.4252 - val_loss: 14.2067 - val_accuracy10: 0.7127 - val_accuracy20: 0.6306 - val_accuracy30: 0.5670 - val_accuracy50: 0.4696 - 60s/epoch - 28ms/step
Epoch 2/50
2159/2159 - 52s - loss: 12.4180 - accuracy10: 0.3880 - accuracy20: 0.4150 - accuracy30: 0.4288 - accuracy50: 0.4335 - val_loss: 13.2573 - val_accuracy10: 0.7056 - val_accuracy20: 0.6296 - val_accuracy30: 0.5694 - val_accuracy50: 0.4742 - 52s/epoch - 24ms/step
Epoch 3/50
2159/2159 - 53s - loss: 12.3055 - accuracy10: 0.4074 - accuracy20: 0.4298 - accuracy30: 0.4414 - accuracy50: 0.4428 - val_loss: 12.7771 - val_accuracy10: 0.6864 - val_accuracy20: 0.6225 - val_accuracy30: 0.5700 - val_accuracy50: 0.4807 - 53s/epoch - 25ms/step
Epoch 4/50
2159/2159 - 54s - loss: 12.2281 - accuracy10: 0.4224 - accuracy20: 0.4400 - accuracy30: 0.4487 - accuracy50: 0.4480 - val_loss: 12.7561 - val_accuracy10: 0.6804 - val_accuracy20: 0.6196 - val_accuracy30: 0.5694 - val_accuracy50: 0.4828 - 54s/epoch - 25ms/step
Epoch 5/50
2159/2159 - 55s - loss: 12.1612 - accuracy10: 0.4362 - accuracy20: 0.4490 - accuracy30: 0.4548 - accuracy50: 0.4535 - val_loss: 12.7240 - val_accuracy10: 0.6873 - val_accuracy20: 0.6214 - val_accuracy30: 0.5703 - val_accuracy50: 0.4839 - 55s/epoch - 26ms/step
Epoch 6/50
2159/2159 - 53s - loss: 12.1010 - accuracy10: 0.4475 - accuracy20: 0.4572 - accuracy30: 0.4613 - accuracy50: 0.4578 - val_loss: 12.7197 - val_accuracy10: 0.6882 - val_accuracy20: 0.6230 - val_accuracy30: 0.5712 - val_accuracy50: 0.4852 - 53s/epoch - 25ms/step
Epoch 7/50
2159/2159 - 53s - loss: 12.0352 - accuracy10: 0.4553 - accuracy20: 0.4645 - accuracy30: 0.4665 - accuracy50: 0.4610 - val_loss: 12.8533 - val_accuracy10: 0.6875 - val_accuracy20: 0.6217 - val_accuracy30: 0.5711 - val_accuracy50: 0.4871 - 53s/epoch - 24ms/step
Epoch 8/50
2159/2159 - 52s - loss: 11.9639 - accuracy10: 0.4621 - accuracy20: 0.4716 - accuracy30: 0.4729 - accuracy50: 0.4665 - val_loss: 12.8838 - val_accuracy10: 0.6866 - val_accuracy20: 0.6217 - val_accuracy30: 0.5712 - val_accuracy50: 0.4880 - 52s/epoch - 24ms/step
Epoch 9/50
2159/2159 - 55s - loss: 11.9042 - accuracy10: 0.4678 - accuracy20: 0.4767 - accuracy30: 0.4776 - accuracy50: 0.4705 - val_loss: 12.8253 - val_accuracy10: 0.6789 - val_accuracy20: 0.6172 - val_accuracy30: 0.5688 - val_accuracy50: 0.4890 - 55s/epoch - 25ms/step
Epoch 10/50
2159/2159 - 53s - loss: 11.8465 - accuracy10: 0.4736 - accuracy20: 0.4808 - accuracy30: 0.4805 - accuracy50: 0.4731 - val_loss: 12.7217 - val_accuracy10: 0.6753 - val_accuracy20: 0.6156 - val_accuracy30: 0.5688 - val_accuracy50: 0.4915 - 53s/epoch - 25ms/step
Epoch 11/50
2159/2159 - 53s - loss: 11.7913 - accuracy10: 0.4784 - accuracy20: 0.4848 - accuracy30: 0.4840 - accuracy50: 0.4764 - val_loss: 12.6635 - val_accuracy10: 0.6699 - val_accuracy20: 0.6130 - val_accuracy30: 0.5682 - val_accuracy50: 0.4925 - 53s/epoch - 24ms/step
Epoch 12/50
2159/2159 - 49s - loss: 11.7476 - accuracy10: 0.4809 - accuracy20: 0.4879 - accuracy30: 0.4871 - accuracy50: 0.4785 - val_loss: 12.7023 - val_accuracy10: 0.6686 - val_accuracy20: 0.6113 - val_accuracy30: 0.5666 - val_accuracy50: 0.4925 - 49s/epoch - 23ms/step
Epoch 13/50
2159/2159 - 51s - loss: 11.7064 - accuracy10: 0.4851 - accuracy20: 0.4911 - accuracy30: 0.4898 - accuracy50: 0.4806 - val_loss: 12.6641 - val_accuracy10: 0.6700 - val_accuracy20: 0.6131 - val_accuracy30: 0.5685 - val_accuracy50: 0.4939 - 51s/epoch - 23ms/step
Epoch 14/50
2159/2159 - 55s - loss: 11.6719 - accuracy10: 0.4878 - accuracy20: 0.4936 - accuracy30: 0.4922 - accuracy50: 0.4827 - val_loss: 12.6503 - val_accuracy10: 0.6699 - val_accuracy20: 0.6124 - val_accuracy30: 0.5676 - val_accuracy50: 0.4934 - 55s/epoch - 26ms/step
Epoch 15/50
2159/2159 - 53s - loss: 11.6372 - accuracy10: 0.4909 - accuracy20: 0.4966 - accuracy30: 0.4948 - accuracy50: 0.4849 - val_loss: 12.5309 - val_accuracy10: 0.6621 - val_accuracy20: 0.6091 - val_accuracy30: 0.5672 - val_accuracy50: 0.4958 - 53s/epoch - 25ms/step
Epoch 16/50
2159/2159 - 54s - loss: 11.6007 - accuracy10: 0.4935 - accuracy20: 0.4985 - accuracy30: 0.4965 - accuracy50: 0.4867 - val_loss: 12.6421 - val_accuracy10: 0.6654 - val_accuracy20: 0.6089 - val_accuracy30: 0.5660 - val_accuracy50: 0.4948 - 54s/epoch - 25ms/step
Epoch 17/50
2159/2159 - 54s - loss: 11.5700 - accuracy10: 0.4961 - accuracy20: 0.5008 - accuracy30: 0.4988 - accuracy50: 0.4879 - val_loss: 12.6367 - val_accuracy10: 0.6645 - val_accuracy20: 0.6093 - val_accuracy30: 0.5664 - val_accuracy50: 0.4959 - 54s/epoch - 25ms/step
Epoch 18/50
2159/2159 - 52s - loss: 11.5367 - accuracy10: 0.4988 - accuracy20: 0.5024 - accuracy30: 0.5002 - accuracy50: 0.4898 - val_loss: 12.6540 - val_accuracy10: 0.6641 - val_accuracy20: 0.6083 - val_accuracy30: 0.5654 - val_accuracy50: 0.4946 - 52s/epoch - 24ms/step
Epoch 19/50
2159/2159 - 51s - loss: 11.5062 - accuracy10: 0.4999 - accuracy20: 0.5046 - accuracy30: 0.5020 - accuracy50: 0.4915 - val_loss: 12.7728 - val_accuracy10: 0.6640 - val_accuracy20: 0.6076 - val_accuracy30: 0.5647 - val_accuracy50: 0.4935 - 51s/epoch - 24ms/step
Epoch 20/50
2159/2159 - 54s - loss: 11.4764 - accuracy10: 0.5027 - accuracy20: 0.5065 - accuracy30: 0.5045 - accuracy50: 0.4939 - val_loss: 12.7152 - val_accuracy10: 0.6597 - val_accuracy20: 0.6040 - val_accuracy30: 0.5626 - val_accuracy50: 0.4930 - 54s/epoch - 25ms/step
Epoch 21/50
2159/2159 - 53s - loss: 11.4503 - accuracy10: 0.5038 - accuracy20: 0.5083 - accuracy30: 0.5057 - accuracy50: 0.4950 - val_loss: 12.7421 - val_accuracy10: 0.6533 - val_accuracy20: 0.6005 - val_accuracy30: 0.5599 - val_accuracy50: 0.4931 - 53s/epoch - 24ms/step
Epoch 22/50
2159/2159 - 50s - loss: 11.4283 - accuracy10: 0.5058 - accuracy20: 0.5098 - accuracy30: 0.5071 - accuracy50: 0.4964 - val_loss: 12.6643 - val_accuracy10: 0.6532 - val_accuracy20: 0.6015 - val_accuracy30: 0.5629 - val_accuracy50: 0.4959 - 50s/epoch - 23ms/step
Epoch 23/50
2159/2159 - 50s - loss: 11.4030 - accuracy10: 0.5080 - accuracy20: 0.5118 - accuracy30: 0.5093 - accuracy50: 0.4988 - val_loss: 12.6747 - val_accuracy10: 0.6482 - val_accuracy20: 0.5976 - val_accuracy30: 0.5590 - val_accuracy50: 0.4943 - 50s/epoch - 23ms/step
Epoch 24/50
2159/2159 - 51s - loss: 11.3733 - accuracy10: 0.5091 - accuracy20: 0.5125 - accuracy30: 0.5099 - accuracy50: 0.4999 - val_loss: 12.7208 - val_accuracy10: 0.6485 - val_accuracy20: 0.5990 - val_accuracy30: 0.5601 - val_accuracy50: 0.4952 - 51s/epoch - 24ms/step
Epoch 25/50
2159/2159 - 53s - loss: 11.3572 - accuracy10: 0.5098 - accuracy20: 0.5137 - accuracy30: 0.5109 - accuracy50: 0.5005 - val_loss: 12.7092 - val_accuracy10: 0.6461 - val_accuracy20: 0.5971 - val_accuracy30: 0.5593 - val_accuracy50: 0.4951 - 53s/epoch - 25ms/step
testing model: results/AAL/W3/deepOF_L1/seq2seq
Evaluating performance on  test set...
5760/5760 - 57s - 57s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.78936285
{'0': {'precision': 0.23315374679901157, 'recall': 0.4765638818465892, 'f1-score': 0.31311792227468566, 'support': 152649}, '1': {'precision': 0.8428577700963155, 'recall': 0.7237461976779058, 'f1-score': 0.7787738558548092, 'support': 1167050}, '2': {'precision': 0.29544689078775027, 'recall': 0.30606456114959163, 'f1-score': 0.3006620162616075, 'support': 154768}, 'accuracy': 0.6543137282828303, 'macro avg': {'precision': 0.4571528025610258, 'recall': 0.5021248802246955, 'f1-score': 0.4641845981303674, 'support': 1474467}, 'weighted avg': {'precision': 0.7222769795997238, 'recall': 0.6543137282828303, 'f1-score': 0.6803801137125755, 'support': 1474467}}
[[ 72747  69586  10316]
 [219757 844648 102645]
 [ 19509  87890  47369]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8387634
{'0': {'precision': 0.2953631684345083, 'recall': 0.45480021351227695, 'f1-score': 0.35813860100467054, 'support': 209824}, '1': {'precision': 0.7754177449300712, 'recall': 0.7167821245127199, 'f1-score': 0.744947898706605, 'support': 1056374}, '2': {'precision': 0.3517471281456026, 'recall': 0.29536800964137727, 'f1-score': 0.32110158786499493, 'support': 208269}, 'accuracy': 0.6199758963747578, 'macro avg': {'precision': 0.4741760138367274, 'recall': 0.4889834492221247, 'f1-score': 0.4747293625254236, 'support': 1474467}, 'weighted avg': {'precision': 0.6472599583226466, 'recall': 0.6199758963747578, 'f1-score': 0.630034562976689, 'support': 1474467}}
[[ 95428 100185  14211]
 [200024 757190  99160]
 [ 27635 119118  61516]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8799758
{'0': {'precision': 0.33849318753659424, 'recall': 0.4220378978604519, 'f1-score': 0.37567682912907485, 'support': 253418}, '1': {'precision': 0.7161304236886551, 'recall': 0.7281233753197885, 'f1-score': 0.722077105316758, 'support': 971345}, '2': {'precision': 0.39383814149452867, 'recall': 0.26953112485182457, 'f1-score': 0.32003785122945166, 'support': 249704}, 'accuracy': 0.5978526477703469, 'macro avg': {'precision': 0.482820584239926, 'recall': 0.4732307993440217, 'f1-score': 0.4725972618917615, 'support': 1474467}, 'weighted avg': {'precision': 0.5966447077355784, 'recall': 0.5978526477703469, 'f1-score': 0.5944548017361779, 'support': 1474467}}
[[106952 130726  15740]
 [176239 707259  87847]
 [ 32774 149627  67303]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.947176
{'0': {'precision': 0.39305828555133465, 'recall': 0.35826298982597715, 'f1-score': 0.3748549153936184, 'support': 323176}, '1': {'precision': 0.6139390906153204, 'recall': 0.746499052438145, 'f1-score': 0.6737608052805995, 'support': 834774}, '2': {'precision': 0.43452972999199435, 'recall': 0.22636066941112168, 'f1-score': 0.29766037046038546, 'support': 316517}, 'accuracy': 0.5497491635960655, 'macro avg': {'precision': 0.4805090353862165, 'recall': 0.4437075705584146, 'f1-score': 0.4487586970448678, 'support': 1474467}, 'weighted avg': {'precision': 0.5270131114962407, 'recall': 0.5497491635960655, 'f1-score': 0.5275104034756729, 'support': 1474467}}
[[115782 187708  19686]
 [138065 623158  73551]
 [ 40720 204150  71647]]
Evaluating performance on  train set...
2159/2159 - 21s - 21s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.820819
{'0': {'precision': 0.33478814788652445, 'recall': 0.3263251078897864, 'f1-score': 0.330502459373638, 'support': 81333}, '1': {'precision': 0.7507034616173756, 'recall': 0.7907586462412457, 'f1-score': 0.7702106331524804, 'support': 388666}, '2': {'precision': 0.3594750771254522, 'recall': 0.2781109536098087, 'f1-score': 0.31360146452088855, 'support': 82539}, 'accuracy': 0.6458144055250499, 'macro avg': {'precision': 0.48165556220978406, 'recall': 0.46506490258028027, 'f1-score': 0.4714381856823356, 'support': 552538}, 'weighted avg': {'precision': 0.6310388596547049, 'recall': 0.6458144055250499, 'f1-score': 0.6372770628502794, 'support': 552538}}
[[ 26541  49523   5269]
 [ 45692 307341  35633]
 [  7044  52540  22955]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9007162
{'0': {'precision': 0.40257370947203447, 'recall': 0.3024274032580001, 'f1-score': 0.34538760117443756, 'support': 108717}, '1': {'precision': 0.6552495675655496, 'recall': 0.7887096097733414, 'f1-score': 0.7158119687167364, 'support': 333806}, '2': {'precision': 0.4271836226491581, 'recall': 0.26819979093759944, 'f1-score': 0.32951766190545323, 'support': 110015}, 'accuracy': 0.5893911368991815, 'macro avg': {'precision': 0.49500229989558076, 'recall': 0.45311226798964704, 'f1-score': 0.4635724105988757, 'support': 552538}, 'weighted avg': {'precision': 0.5601233749881531, 'recall': 0.5893911368991815, 'f1-score': 0.566013051484004, 'support': 552538}}
[[ 32879  67976   7862]
 [ 38827 263276  31703]
 [  9966  70543  29506]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.95828193
{'0': {'precision': 0.4407926109981678, 'recall': 0.2734803833786214, 'f1-score': 0.33754078117267194, 'support': 128437}, '1': {'precision': 0.5797240430624958, 'recall': 0.7988022772357944, 'f1-score': 0.6718549786796374, 'support': 294392}, '2': {'precision': 0.4677944918091327, 'recall': 0.24238873169941946, 'f1-score': 0.3193207324876345, 'support': 129709}, 'accuracy': 0.5460728492881938, 'macro avg': {'precision': 0.4961037152899321, 'recall': 0.4382237974379451, 'f1-score': 0.442905497446648, 'support': 552538}, 'weighted avg': {'precision': 0.5211539419951149, 'recall': 0.5460728492881938, 'f1-score': 0.5113860568597434, 'support': 552538}}
[[ 35125  84118   9194]
 [ 32656 235161  26575]
 [ 11905  86364  31440]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0392721
{'0': {'precision': 0.4817351598173516, 'recall': 0.22787487618621594, 'f1-score': 0.30939624393185455, 'support': 156485}, '1': {'precision': 0.46882714111117013, 'recall': 0.8135916470011275, 'f1-score': 0.5948662783659496, 'support': 238573}, '2': {'precision': 0.5000465101857307, 'recall': 0.20481330962661926, 'f1-score': 0.29060013874998875, 'support': 157480}, 'accuracy': 0.4742008694424637, 'macro avg': {'precision': 0.4835362703714175, 'recall': 0.41542661093798755, 'f1-score': 0.39828755368259766, 'support': 552538}, 'weighted avg': {'precision': 0.4813807347990226, 'recall': 0.4742008694424637, 'f1-score': 0.42729841877051744, 'support': 552538}}
[[ 35659 109150  11676]
 [ 23900 194101  20572]
 [ 14463 110763  32254]]
Evaluating performance on  val set...
850/850 - 8s - 8s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.79988
{'0': {'precision': 0.3232780987304113, 'recall': 0.311978366829138, 'f1-score': 0.3175277348329114, 'support': 29954}, '1': {'precision': 0.7692878156410885, 'recall': 0.797095282851119, 'f1-score': 0.7829447209850668, 'support': 157468}, '2': {'precision': 0.3467837645383337, 'recall': 0.29295190990208203, 'f1-score': 0.31760294197568884, 'support': 29923}, 'accuracy': 0.6608295566955762, 'macro avg': {'precision': 0.4797832263032779, 'recall': 0.467341853194113, 'f1-score': 0.4726917992645558, 'support': 217345}, 'weighted avg': {'precision': 0.6496514597024189, 'recall': 0.6608295566955762, 'f1-score': 0.6547360092295662, 'support': 217345}}
[[  9345  18674   1935]
 [ 17374 125517  14577]
 [  2188  18969   8766]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.87727606
{'0': {'precision': 0.387802654239692, 'recall': 0.28805779215892846, 'f1-score': 0.3305699481865285, 'support': 39867}, '1': {'precision': 0.6809474332572217, 'recall': 0.7959970326841118, 'f1-score': 0.7339912214521153, 'support': 137498}, '2': {'precision': 0.41521312446765174, 'recall': 0.28044022011005504, 'f1-score': 0.3347715091888987, 'support': 39980}, 'accuracy': 0.6079919022751846, 'macro avg': {'precision': 0.49465440398818855, 'recall': 0.45483168165103177, 'f1-score': 0.46644422627584753, 'support': 217345}, 'weighted avg': {'precision': 0.5782956097945294, 'recall': 0.6079919022751846, 'f1-score': 0.5865574180632057, 'support': 217345}}
[[ 11484  25628   2755]
 [ 15014 109448  13036]
 [  3115  25653  11212]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9353059
{'0': {'precision': 0.42638577102400277, 'recall': 0.2609982453544173, 'f1-score': 0.3237955362060374, 'support': 47303}, '1': {'precision': 0.6093368366516172, 'recall': 0.8043329588197938, 'f1-score': 0.6933863937843472, 'support': 122826}, '2': {'precision': 0.45285246401096807, 'recall': 0.2518425957302609, 'f1-score': 0.32367912458828973, 'support': 47216}, 'accuracy': 0.5660585704755113, 'macro avg': {'precision': 0.496191690562196, 'recall': 0.4390579333014906, 'f1-score': 0.4469536848595581, 'support': 217345}, 'weighted avg': {'precision': 0.5355246928434599, 'recall': 0.5660585704755113, 'f1-score': 0.5326334215126692, 'support': 217345}}
[[12346 31762  3195]
 [12861 98793 11172]
 [ 3748 31577 11891]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0205227
{'0': {'precision': 0.46906678592725104, 'recall': 0.21594633083403394, 'f1-score': 0.2957410562180579, 'support': 58283}, '1': {'precision': 0.5002450609626963, 'recall': 0.8182852957478819, 'f1-score': 0.6209082340394372, 'support': 101032}, '2': {'precision': 0.49013783269961975, 'recall': 0.2132517663277615, 'f1-score': 0.29719733903311796, 'support': 58030}, 'accuracy': 0.49522188226092156, 'macro avg': {'precision': 0.4864832265298557, 'recall': 0.41582779763655914, 'f1-score': 0.40461554309687103, 'support': 217345}, 'weighted avg': {'precision': 0.4891857503735538, 'recall': 0.49522188226092156, 'f1-score': 0.4472826072148948, 'support': 217345}}
[[12586 41561  4136]
 [ 9622 82673  8737]
 [ 4624 41031 12375]]
training model: results/AAL/W3/deepLOB_L2/seq2seq
Epoch 1/50
2159/2159 - 113s - loss: 11.8068 - accuracy10: 0.4057 - accuracy20: 0.4382 - accuracy30: 0.4553 - accuracy50: 0.4645 - val_loss: 13.2834 - val_accuracy10: 0.6719 - val_accuracy20: 0.6110 - val_accuracy30: 0.5621 - val_accuracy50: 0.4800 - 113s/epoch - 52ms/step
Epoch 2/50
2159/2159 - 104s - loss: 10.9850 - accuracy10: 0.5086 - accuracy20: 0.5272 - accuracy30: 0.5317 - accuracy50: 0.5198 - val_loss: 10.6135 - val_accuracy10: 0.6566 - val_accuracy20: 0.6361 - val_accuracy30: 0.6071 - val_accuracy50: 0.5462 - 104s/epoch - 48ms/step
Epoch 3/50
2159/2159 - 105s - loss: 10.2933 - accuracy10: 0.5919 - accuracy20: 0.5873 - accuracy30: 0.5737 - accuracy50: 0.5467 - val_loss: 10.2770 - val_accuracy10: 0.6868 - val_accuracy20: 0.6615 - val_accuracy30: 0.6286 - val_accuracy50: 0.5638 - 105s/epoch - 49ms/step
Epoch 4/50
2159/2159 - 105s - loss: 10.0177 - accuracy10: 0.6142 - accuracy20: 0.6056 - accuracy30: 0.5876 - accuracy50: 0.5558 - val_loss: 10.1394 - val_accuracy10: 0.6847 - val_accuracy20: 0.6594 - val_accuracy30: 0.6281 - val_accuracy50: 0.5666 - 105s/epoch - 49ms/step
Epoch 5/50
2159/2159 - 105s - loss: 9.8934 - accuracy10: 0.6211 - accuracy20: 0.6121 - accuracy30: 0.5935 - accuracy50: 0.5600 - val_loss: 10.1117 - val_accuracy10: 0.6856 - val_accuracy20: 0.6603 - val_accuracy30: 0.6295 - val_accuracy50: 0.5673 - 105s/epoch - 48ms/step
Epoch 6/50
2159/2159 - 104s - loss: 9.8226 - accuracy10: 0.6246 - accuracy20: 0.6150 - accuracy30: 0.5973 - accuracy50: 0.5632 - val_loss: 10.0084 - val_accuracy10: 0.6518 - val_accuracy20: 0.6337 - val_accuracy30: 0.6101 - val_accuracy50: 0.5606 - 104s/epoch - 48ms/step
Epoch 7/50
2159/2159 - 104s - loss: 9.7832 - accuracy10: 0.6269 - accuracy20: 0.6172 - accuracy30: 0.5989 - accuracy50: 0.5647 - val_loss: 9.9156 - val_accuracy10: 0.6740 - val_accuracy20: 0.6540 - val_accuracy30: 0.6263 - val_accuracy50: 0.5688 - 104s/epoch - 48ms/step
Epoch 8/50
2159/2159 - 104s - loss: 9.7197 - accuracy10: 0.6290 - accuracy20: 0.6192 - accuracy30: 0.6008 - accuracy50: 0.5667 - val_loss: 9.9546 - val_accuracy10: 0.6674 - val_accuracy20: 0.6480 - val_accuracy30: 0.6215 - val_accuracy50: 0.5661 - 104s/epoch - 48ms/step
Epoch 9/50
2159/2159 - 105s - loss: 9.6833 - accuracy10: 0.6300 - accuracy20: 0.6201 - accuracy30: 0.6021 - accuracy50: 0.5677 - val_loss: 9.8753 - val_accuracy10: 0.6688 - val_accuracy20: 0.6497 - val_accuracy30: 0.6247 - val_accuracy50: 0.5694 - 105s/epoch - 48ms/step
Epoch 10/50
2159/2159 - 105s - loss: 9.6528 - accuracy10: 0.6315 - accuracy20: 0.6216 - accuracy30: 0.6036 - accuracy50: 0.5692 - val_loss: 9.7731 - val_accuracy10: 0.6561 - val_accuracy20: 0.6426 - val_accuracy30: 0.6205 - val_accuracy50: 0.5701 - 105s/epoch - 48ms/step
Epoch 11/50
2159/2159 - 104s - loss: 9.6217 - accuracy10: 0.6326 - accuracy20: 0.6222 - accuracy30: 0.6046 - accuracy50: 0.5703 - val_loss: 9.8304 - val_accuracy10: 0.6671 - val_accuracy20: 0.6515 - val_accuracy30: 0.6267 - val_accuracy50: 0.5727 - 104s/epoch - 48ms/step
Epoch 12/50
2159/2159 - 105s - loss: 9.5974 - accuracy10: 0.6331 - accuracy20: 0.6233 - accuracy30: 0.6054 - accuracy50: 0.5711 - val_loss: 9.8066 - val_accuracy10: 0.6536 - val_accuracy20: 0.6402 - val_accuracy30: 0.6191 - val_accuracy50: 0.5695 - 105s/epoch - 49ms/step
Epoch 13/50
2159/2159 - 104s - loss: 9.5688 - accuracy10: 0.6338 - accuracy20: 0.6239 - accuracy30: 0.6063 - accuracy50: 0.5722 - val_loss: 9.7900 - val_accuracy10: 0.6573 - val_accuracy20: 0.6420 - val_accuracy30: 0.6197 - val_accuracy50: 0.5699 - 104s/epoch - 48ms/step
Epoch 14/50
2159/2159 - 105s - loss: 9.5541 - accuracy10: 0.6346 - accuracy20: 0.6245 - accuracy30: 0.6064 - accuracy50: 0.5727 - val_loss: 9.7755 - val_accuracy10: 0.6635 - val_accuracy20: 0.6477 - val_accuracy30: 0.6237 - val_accuracy50: 0.5712 - 105s/epoch - 48ms/step
Epoch 15/50
2159/2159 - 105s - loss: 9.5353 - accuracy10: 0.6354 - accuracy20: 0.6254 - accuracy30: 0.6069 - accuracy50: 0.5731 - val_loss: 9.8269 - val_accuracy10: 0.6673 - val_accuracy20: 0.6489 - val_accuracy30: 0.6242 - val_accuracy50: 0.5711 - 105s/epoch - 49ms/step
Epoch 16/50
2159/2159 - 105s - loss: 9.5142 - accuracy10: 0.6356 - accuracy20: 0.6260 - accuracy30: 0.6080 - accuracy50: 0.5740 - val_loss: 9.8640 - val_accuracy10: 0.6636 - val_accuracy20: 0.6456 - val_accuracy30: 0.6207 - val_accuracy50: 0.5687 - 105s/epoch - 48ms/step
Epoch 17/50
2159/2159 - 105s - loss: 9.4946 - accuracy10: 0.6362 - accuracy20: 0.6268 - accuracy30: 0.6086 - accuracy50: 0.5745 - val_loss: 9.8122 - val_accuracy10: 0.6609 - val_accuracy20: 0.6448 - val_accuracy30: 0.6206 - val_accuracy50: 0.5691 - 105s/epoch - 48ms/step
Epoch 18/50
2159/2159 - 105s - loss: 9.4766 - accuracy10: 0.6369 - accuracy20: 0.6276 - accuracy30: 0.6096 - accuracy50: 0.5751 - val_loss: 9.9132 - val_accuracy10: 0.6554 - val_accuracy20: 0.6397 - val_accuracy30: 0.6167 - val_accuracy50: 0.5662 - 105s/epoch - 49ms/step
Epoch 19/50
2159/2159 - 105s - loss: 9.4572 - accuracy10: 0.6371 - accuracy20: 0.6281 - accuracy30: 0.6100 - accuracy50: 0.5759 - val_loss: 9.8408 - val_accuracy10: 0.6501 - val_accuracy20: 0.6379 - val_accuracy30: 0.6167 - val_accuracy50: 0.5677 - 105s/epoch - 48ms/step
Epoch 20/50
2159/2159 - 105s - loss: 9.4463 - accuracy10: 0.6367 - accuracy20: 0.6282 - accuracy30: 0.6104 - accuracy50: 0.5764 - val_loss: 9.9655 - val_accuracy10: 0.6378 - val_accuracy20: 0.6258 - val_accuracy30: 0.6068 - val_accuracy50: 0.5614 - 105s/epoch - 49ms/step
testing model: results/AAL/W3/deepLOB_L2/seq2seq
Evaluating performance on  test set...
5760/5760 - 92s - 92s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.64478534
{'0': {'precision': 0.35232050600074327, 'recall': 0.6334711203988183, 'f1-score': 0.45280333023504105, 'support': 152651}, '1': {'precision': 0.9162958888481441, 'recall': 0.7707855098020566, 'f1-score': 0.837265581115903, 'support': 1167051}, '2': {'precision': 0.3776026754014247, 'recall': 0.5325678915028204, 'f1-score': 0.44189313075318853, 'support': 154769}, 'accuracy': 0.7315647442370857, 'macro avg': {'precision': 0.5487396900834374, 'recall': 0.6456081739012317, 'f1-score': 0.5773206807013775, 'support': 1474471}, 'weighted avg': {'precision': 0.8013635394706563, 'recall': 0.7315647442370857, 'f1-score': 0.7559618824813409, 'support': 1474471}}
[[ 96700  39912  16039]
 [147684 899546 119821]
 [ 30082  42262  82425]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.69714695
{'0': {'precision': 0.42641906217897946, 'recall': 0.5875582625604072, 'f1-score': 0.4941847064694765, 'support': 209826}, '1': {'precision': 0.8605268523125451, 'recall': 0.7711371435333096, 'f1-score': 0.8133834178059487, 'support': 1056375}, '2': {'precision': 0.42647865847272665, 'recall': 0.48881740048974887, 'f1-score': 0.45552515420049533, 'support': 208270}, 'accuracy': 0.7051349263566391, 'macro avg': {'precision': 0.5711415243214171, 'recall': 0.6158376021944886, 'f1-score': 0.5876977594919736, 'support': 1474471}, 'weighted avg': {'precision': 0.7374411364838956, 'recall': 0.7051349263566391, 'f1-score': 0.7174118257122456, 'support': 1474471}}
[[123285  66919  19622]
 [124480 814610 117285]
 [ 41352  65112 101806]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7493124
{'0': {'precision': 0.46264539421001916, 'recall': 0.5380377951140206, 'f1-score': 0.4975015279082708, 'support': 253419}, '1': {'precision': 0.8030644467993651, 'recall': 0.7770464901281314, 'f1-score': 0.7898412638615504, 'support': 971346}, '2': {'precision': 0.4600986330608348, 'recall': 0.44199178233602715, 'f1-score': 0.4508634864221739, 'support': 249706}, 'accuracy': 0.679225295038017, 'macro avg': {'precision': 0.5752694913567397, 'recall': 0.5856920225260597, 'f1-score': 0.579402092730665, 'support': 1474471}, 'weighted avg': {'precision': 0.6864739696902643, 'recall': 0.679225295038017, 'f1-score': 0.6821896190080259, 'support': 1474471}}
[[136349  95007  22063]
 [109117 754781 107448]
 [ 49250  90088 110368]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8295697
{'0': {'precision': 0.49931489281278685, 'recall': 0.45779557332359666, 'f1-score': 0.4776546819030769, 'support': 323177}, '1': {'precision': 0.6971830387310924, 'recall': 0.7860297685004941, 'f1-score': 0.7389453756930873, 'support': 834775}, '2': {'precision': 0.4964115589571792, 'recall': 0.37171544204297374, 'f1-score': 0.4251079435622279, 'support': 316519}, 'accuracy': 0.6251475953070627, 'macro avg': {'precision': 0.5643031635003528, 'recall': 0.5385135946223548, 'f1-score': 0.5472360003861306, 'support': 1474471}, 'weighted avg': {'precision': 0.6107151313934782, 'recall': 0.6251475953070627, 'f1-score': 0.6143049773891521, 'support': 1474471}}
[[147949 147628  27600]
 [ 86861 656158  91756]
 [ 61494 137370 117655]]
Evaluating performance on  train set...
2159/2159 - 35s - 35s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.80380106
{'0': {'precision': 0.3438992384159531, 'recall': 0.7046062808456307, 'f1-score': 0.46220751138546284, 'support': 81454}, '1': {'precision': 0.8870038195255351, 'recall': 0.6057752910154994, 'f1-score': 0.7198988693112076, 'support': 388725}, '2': {'precision': 0.4087308191592051, 'recall': 0.5963817387081107, 'f1-score': 0.4850394011810479, 'support': 82360}, 'accuracy': 0.6189445450909348, 'macro avg': {'precision': 0.5465446257002311, 'recall': 0.6355877701897469, 'f1-score': 0.5557152606259061, 'support': 552539}, 'weighted avg': {'precision': 0.7356505125917787, 'recall': 0.6189445450909348, 'f1-score': 0.646903085006962, 'support': 552539}}
[[ 57393  13886  10175]
 [ 92366 235480  60879]
 [ 17130  16112  49118]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8255395
{'0': {'precision': 0.41357139979163426, 'recall': 0.6602010438106439, 'f1-score': 0.5085626316068869, 'support': 108832}, '1': {'precision': 0.8091754533785859, 'recall': 0.6158207157347173, 'f1-score': 0.6993801354071488, 'support': 333727}, '2': {'precision': 0.4773921681727873, 'recall': 0.5418257865066376, 'f1-score': 0.5075722730447523, 'support': 109980}, 'accuracy': 0.6098338759797951, 'macro avg': {'precision': 0.5667130071143358, 'recall': 0.6059491820173329, 'f1-score': 0.5718383466862627, 'support': 552539}, 'weighted avg': {'precision': 0.6652147446016329, 'recall': 0.6098338759797951, 'f1-score': 0.6236170141139794, 'support': 552539}}
[[ 71851  23019  13962]
 [ 76939 205516  51272]
 [ 24943  25447  59590]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8557961
{'0': {'precision': 0.44774627561305685, 'recall': 0.620639195479241, 'f1-score': 0.5202034205710521, 'support': 128474}, '1': {'precision': 0.7347493553254508, 'recall': 0.6254183556626244, 'f1-score': 0.6756898137186341, 'support': 294307}, '2': {'precision': 0.5137241613012539, 'recall': 0.4906980687125264, 'f1-score': 0.5019471817106819, 'support': 129758}, 'accuracy': 0.5926694767247199, 'macro avg': {'precision': 0.5654065974132538, 'recall': 0.5789185399514639, 'f1-score': 0.5659468053334561, 'support': 552539}, 'weighted avg': {'precision': 0.616111176320599, 'recall': 0.5926694767247199, 'f1-score': 0.5987351456909831, 'support': 552539}}
[[ 79736  31804  16934]
 [ 66906 184065  43336]
 [ 31441  34645  63672]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9179449
{'0': {'precision': 0.48012148136716143, 'recall': 0.5567472212812467, 'f1-score': 0.5156029880077186, 'support': 156457}, '1': {'precision': 0.6078596721206647, 'recall': 0.6377148846960168, 'f1-score': 0.6224294781815131, 'support': 238500}, '2': {'precision': 0.5413406342536684, 'recall': 0.4153202776966912, 'f1-score': 0.47003016374605, 'support': 157582}, 'accuracy': 0.5513619853078244, 'macro avg': {'precision': 0.5431072625804981, 'recall': 0.5365941278913183, 'f1-score': 0.5360208766450939, 'support': 552539}, 'weighted avg': {'precision': 0.5527183388647716, 'recall': 0.5513619853078244, 'f1-score': 0.5487167792761136, 'support': 552539}}
[[ 87107  47720  21630]
 [ 52584 152095  33821]
 [ 41736  50399  65447]]
Evaluating performance on  val set...
850/850 - 14s - 14s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7451749
{'0': {'precision': 0.37514410883098914, 'recall': 0.6533699216919885, 'f1-score': 0.47662524717427923, 'support': 29882}, '1': {'precision': 0.8977693558993528, 'recall': 0.6580434437926114, 'f1-score': 0.7594374320669578, 'support': 157675}, '2': {'precision': 0.39027529208309036, 'recall': 0.6515375318920371, 'f1-score': 0.48814718865148343, 'support': 29788}, 'accuracy': 0.6565092364673676, 'macro avg': {'precision': 0.5543962522711441, 'recall': 0.6543169657922123, 'f1-score': 0.5747366226309069, 'support': 217345}, 'weighted avg': {'precision': 0.7563613602893516, 'recall': 0.6565092364673676, 'f1-score': 0.6833731679715189, 'support': 217345}}
[[ 19524   6451   3907]
 [ 27504 103757  26414]
 [  5016   5364  19408]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.77625746
{'0': {'precision': 0.4433464719924499, 'recall': 0.6011140104375753, 'f1-score': 0.5103147132435167, 'support': 39856}, '1': {'precision': 0.8225904530252356, 'recall': 0.6683644554239628, 'f1-score': 0.7375008017445963, 'support': 137630}, '2': {'precision': 0.4613053613053613, 'recall': 0.5958001956898066, 'f1-score': 0.5199969344967648, 'support': 39859}, 'accuracy': 0.6427247003611769, 'macro avg': {'precision': 0.5757474287743489, 'recall': 0.6217595538504482, 'f1-score': 0.5892708164949593, 'support': 217345}, 'weighted avg': {'precision': 0.6867897188058831, 'recall': 0.6427247003611769, 'f1-score': 0.655952041074094, 'support': 217345}}
[[23958 10650  5248]
 [23159 91987 22484]
 [ 6922  9189 23748]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.81817394
{'0': {'precision': 0.4756991041311523, 'recall': 0.5550946989736536, 'f1-score': 0.5123392286883405, 'support': 47255}, '1': {'precision': 0.7480970226380164, 'recall': 0.6771907845498031, 'f1-score': 0.7108801564494848, 'support': 122924}, '2': {'precision': 0.49691733752208916, 'recall': 0.5365729550947717, 'f1-score': 0.5159843418691894, 'support': 47166}, 'accuracy': 0.6201292875382457, 'macro avg': {'precision': 0.5735711547637526, 'recall': 0.5896194795394094, 'f1-score': 0.5797345756690049, 'support': 217345}, 'weighted avg': {'precision': 0.6343639960341392, 'recall': 0.6201292875382457, 'f1-score': 0.6254192186232312, 'support': 217345}}
[[26231 14761  6263]
 [20322 83243 19359]
 [ 8589 13269 25308]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8961569
{'0': {'precision': 0.503764250376425, 'recall': 0.4822320218260437, 'f1-score': 0.49276302523955223, 'support': 58279}, '1': {'precision': 0.6187283505338713, 'recall': 0.6858418026541053, 'f1-score': 0.6505587549222531, 'support': 101051}, '2': {'precision': 0.5307498233928751, 'recall': 0.45326208739119195, 'f1-score': 0.4889550018594273, 'support': 58015}, 'accuracy': 0.5691642319814121, 'macro avg': {'precision': 0.5510808081010572, 'recall': 0.5404453039571137, 'f1-score': 0.5440922606737443, 'support': 217345}, 'weighted avg': {'precision': 0.5644180740372383, 'recall': 0.5691642319814121, 'f1-score': 0.565111106878277, 'support': 217345}}
[[28104 22251  7924]
 [16421 69305 15325]
 [11263 20456 26296]]
training model: results/AAL/W3/deepOF_L2/seq2seq
Epoch 1/50
2159/2159 - 75s - loss: 11.0635 - accuracy10: 0.5277 - accuracy20: 0.5363 - accuracy30: 0.5312 - accuracy50: 0.5135 - val_loss: 11.1650 - val_accuracy10: 0.7377 - val_accuracy20: 0.6938 - val_accuracy30: 0.6469 - val_accuracy50: 0.5617 - 75s/epoch - 35ms/step
Epoch 2/50
2159/2159 - 64s - loss: 10.2325 - accuracy10: 0.6008 - accuracy20: 0.5965 - accuracy30: 0.5813 - accuracy50: 0.5510 - val_loss: 10.7694 - val_accuracy10: 0.7355 - val_accuracy20: 0.6974 - val_accuracy30: 0.6532 - val_accuracy50: 0.5709 - 64s/epoch - 30ms/step
Epoch 3/50
2159/2159 - 66s - loss: 10.0821 - accuracy10: 0.6098 - accuracy20: 0.6026 - accuracy30: 0.5856 - accuracy50: 0.5547 - val_loss: 10.4930 - val_accuracy10: 0.7246 - val_accuracy20: 0.6916 - val_accuracy30: 0.6504 - val_accuracy50: 0.5730 - 66s/epoch - 30ms/step
Epoch 4/50
2159/2159 - 65s - loss: 9.9965 - accuracy10: 0.6139 - accuracy20: 0.6059 - accuracy30: 0.5887 - accuracy50: 0.5571 - val_loss: 10.5423 - val_accuracy10: 0.7318 - val_accuracy20: 0.6969 - val_accuracy30: 0.6543 - val_accuracy50: 0.5738 - 65s/epoch - 30ms/step
Epoch 5/50
2159/2159 - 64s - loss: 9.9355 - accuracy10: 0.6164 - accuracy20: 0.6083 - accuracy30: 0.5907 - accuracy50: 0.5588 - val_loss: 10.4152 - val_accuracy10: 0.7271 - val_accuracy20: 0.6934 - val_accuracy30: 0.6524 - val_accuracy50: 0.5737 - 64s/epoch - 30ms/step
Epoch 6/50
2159/2159 - 64s - loss: 9.8773 - accuracy10: 0.6178 - accuracy20: 0.6105 - accuracy30: 0.5931 - accuracy50: 0.5613 - val_loss: 10.3912 - val_accuracy10: 0.7204 - val_accuracy20: 0.6906 - val_accuracy30: 0.6513 - val_accuracy50: 0.5742 - 64s/epoch - 29ms/step
Epoch 7/50
2159/2159 - 63s - loss: 9.8379 - accuracy10: 0.6193 - accuracy20: 0.6120 - accuracy30: 0.5950 - accuracy50: 0.5626 - val_loss: 10.3779 - val_accuracy10: 0.7303 - val_accuracy20: 0.6965 - val_accuracy30: 0.6550 - val_accuracy50: 0.5754 - 63s/epoch - 29ms/step
Epoch 8/50
2159/2159 - 63s - loss: 9.7961 - accuracy10: 0.6204 - accuracy20: 0.6140 - accuracy30: 0.5970 - accuracy50: 0.5637 - val_loss: 10.3222 - val_accuracy10: 0.7273 - val_accuracy20: 0.6952 - val_accuracy30: 0.6546 - val_accuracy50: 0.5765 - 63s/epoch - 29ms/step
Epoch 9/50
2159/2159 - 64s - loss: 9.7651 - accuracy10: 0.6215 - accuracy20: 0.6147 - accuracy30: 0.5979 - accuracy50: 0.5651 - val_loss: 10.2970 - val_accuracy10: 0.7234 - val_accuracy20: 0.6927 - val_accuracy30: 0.6539 - val_accuracy50: 0.5765 - 64s/epoch - 29ms/step
Epoch 10/50
2159/2159 - 64s - loss: 9.7377 - accuracy10: 0.6226 - accuracy20: 0.6162 - accuracy30: 0.5991 - accuracy50: 0.5665 - val_loss: 10.2958 - val_accuracy10: 0.7213 - val_accuracy20: 0.6914 - val_accuracy30: 0.6530 - val_accuracy50: 0.5767 - 64s/epoch - 30ms/step
Epoch 11/50
2159/2159 - 66s - loss: 9.7058 - accuracy10: 0.6237 - accuracy20: 0.6171 - accuracy30: 0.6002 - accuracy50: 0.5675 - val_loss: 10.3236 - val_accuracy10: 0.7279 - val_accuracy20: 0.6961 - val_accuracy30: 0.6568 - val_accuracy50: 0.5786 - 66s/epoch - 31ms/step
Epoch 12/50
2159/2159 - 64s - loss: 9.6804 - accuracy10: 0.6248 - accuracy20: 0.6180 - accuracy30: 0.6015 - accuracy50: 0.5688 - val_loss: 10.3121 - val_accuracy10: 0.7226 - val_accuracy20: 0.6919 - val_accuracy30: 0.6541 - val_accuracy50: 0.5778 - 64s/epoch - 29ms/step
Epoch 13/50
2159/2159 - 64s - loss: 9.6533 - accuracy10: 0.6257 - accuracy20: 0.6193 - accuracy30: 0.6024 - accuracy50: 0.5696 - val_loss: 10.3092 - val_accuracy10: 0.7184 - val_accuracy20: 0.6897 - val_accuracy30: 0.6526 - val_accuracy50: 0.5769 - 64s/epoch - 30ms/step
Epoch 14/50
2159/2159 - 66s - loss: 9.6308 - accuracy10: 0.6267 - accuracy20: 0.6206 - accuracy30: 0.6035 - accuracy50: 0.5710 - val_loss: 10.3207 - val_accuracy10: 0.7156 - val_accuracy20: 0.6879 - val_accuracy30: 0.6514 - val_accuracy50: 0.5772 - 66s/epoch - 30ms/step
Epoch 15/50
2159/2159 - 64s - loss: 9.6065 - accuracy10: 0.6272 - accuracy20: 0.6213 - accuracy30: 0.6045 - accuracy50: 0.5720 - val_loss: 10.3224 - val_accuracy10: 0.7205 - val_accuracy20: 0.6900 - val_accuracy30: 0.6526 - val_accuracy50: 0.5767 - 64s/epoch - 30ms/step
Epoch 16/50
2159/2159 - 65s - loss: 9.5800 - accuracy10: 0.6293 - accuracy20: 0.6221 - accuracy30: 0.6053 - accuracy50: 0.5723 - val_loss: 10.3235 - val_accuracy10: 0.7162 - val_accuracy20: 0.6874 - val_accuracy30: 0.6508 - val_accuracy50: 0.5762 - 65s/epoch - 30ms/step
Epoch 17/50
2159/2159 - 65s - loss: 9.5555 - accuracy10: 0.6292 - accuracy20: 0.6233 - accuracy30: 0.6067 - accuracy50: 0.5740 - val_loss: 10.3489 - val_accuracy10: 0.7181 - val_accuracy20: 0.6881 - val_accuracy30: 0.6512 - val_accuracy50: 0.5779 - 65s/epoch - 30ms/step
Epoch 18/50
2159/2159 - 65s - loss: 9.5335 - accuracy10: 0.6300 - accuracy20: 0.6244 - accuracy30: 0.6077 - accuracy50: 0.5749 - val_loss: 10.3700 - val_accuracy10: 0.7164 - val_accuracy20: 0.6862 - val_accuracy30: 0.6492 - val_accuracy50: 0.5758 - 65s/epoch - 30ms/step
Epoch 19/50
2159/2159 - 64s - loss: 9.5103 - accuracy10: 0.6308 - accuracy20: 0.6243 - accuracy30: 0.6079 - accuracy50: 0.5754 - val_loss: 10.3135 - val_accuracy10: 0.7131 - val_accuracy20: 0.6839 - val_accuracy30: 0.6483 - val_accuracy50: 0.5766 - 64s/epoch - 30ms/step
Epoch 20/50
2159/2159 - 64s - loss: 9.4931 - accuracy10: 0.6310 - accuracy20: 0.6255 - accuracy30: 0.6091 - accuracy50: 0.5762 - val_loss: 10.3795 - val_accuracy10: 0.7135 - val_accuracy20: 0.6852 - val_accuracy30: 0.6491 - val_accuracy50: 0.5766 - 64s/epoch - 30ms/step
testing model: results/AAL/W3/deepOF_L2/seq2seq
Evaluating performance on  test set...
5760/5760 - 55s - 55s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.59284705
{'0': {'precision': 0.39300370062758316, 'recall': 0.5238684825973311, 'f1-score': 0.44909695390421417, 'support': 152649}, '1': {'precision': 0.9034429007954672, 'recall': 0.8134732873484427, 'f1-score': 0.856100806220718, 'support': 1167050}, '2': {'precision': 0.37650970435003794, 'recall': 0.5355887521968365, 'f1-score': 0.44217674373944793, 'support': 154768}, 'accuracy': 0.7543227484914888, 'macro avg': {'precision': 0.5576521019243628, 'recall': 0.6243101740475367, 'f1-score': 0.5824581679547934, 'support': 1474467}, 'weighted avg': {'precision': 0.7952882724355966, 'recall': 0.7543227484914888, 'f1-score': 0.7705167067770796, 'support': 1474467}}
[[ 79968  52644  20037]
 [100456 949364 117230]
 [ 23055  48821  82892]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6463035
{'0': {'precision': 0.4818398819369472, 'recall': 0.46370291291749277, 'f1-score': 0.4725974499089254, 'support': 209824}, '1': {'precision': 0.8411816770661283, 'recall': 0.8330865772917546, 'f1-score': 0.8371145572443786, 'support': 1056374}, '2': {'precision': 0.4383585248284607, 'recall': 0.476379105867892, 'f1-score': 0.4565786627765174, 'support': 208269}, 'accuracy': 0.7301363814856487, 'macro avg': {'precision': 0.5871266946105121, 'recall': 0.5910561986923798, 'f1-score': 0.5887635566432737, 'support': 1474467}, 'weighted avg': {'precision': 0.7331466325961117, 'recall': 0.7301363814856487, 'f1-score': 0.7314911233292883, 'support': 1474467}}
[[ 97296  86087  26441]
 [ 75646 880051 100677]
 [ 28984  80070  99215]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.70676076
{'0': {'precision': 0.5307054155717009, 'recall': 0.406419433505118, 'f1-score': 0.4603207236842105, 'support': 253418}, '1': {'precision': 0.7814003166138501, 'recall': 0.8450694655349026, 'f1-score': 0.8119887072937667, 'support': 971345}, '2': {'precision': 0.46914826059345993, 'recall': 0.43195143049370455, 'f1-score': 0.44978211463480744, 'support': 249704}, 'accuracy': 0.6997158973378177, 'macro avg': {'precision': 0.593751330926337, 'recall': 0.5611467765112418, 'f1-score': 0.5740305152042615, 'support': 1474467}, 'weighted avg': {'precision': 0.6854326294232824, 'recall': 0.6997158973378177, 'f1-score': 0.6902067806153946, 'support': 1474467}}
[[102994 119737  30687]
 [ 59132 820854  91359]
 [ 31944 109900 107860]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8120324
{'0': {'precision': 0.5747791789345036, 'recall': 0.32015372428645694, 'f1-score': 0.4112435560607807, 'support': 323176}, '1': {'precision': 0.6742574480975694, 'recall': 0.8585629164300757, 'f1-score': 0.755329788747609, 'support': 834774}, '2': {'precision': 0.4978509812052648, 'recall': 0.3641289409415608, 'f1-score': 0.4206175709556985, 'support': 316517}, 'accuracy': 0.6344156905512297, 'macro avg': {'precision': 0.5822958694124459, 'recall': 0.5142818605526979, 'f1-score': 0.5290636385880294, 'support': 1474467}, 'weighted avg': {'precision': 0.6145852853456092, 'recall': 0.6344156905512297, 'f1-score': 0.6080613050354333, 'support': 1474467}}
[[103466 180055  39655]
 [ 41475 716706  76593]
 [ 35069 166195 115253]]
Evaluating performance on  train set...
2159/2159 - 22s - 22s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7238968
{'0': {'precision': 0.4213727273562458, 'recall': 0.5639285406907405, 'f1-score': 0.4823379709962036, 'support': 81333}, '1': {'precision': 0.8560391726890593, 'recall': 0.7372293949046225, 'f1-score': 0.7922044709001658, 'support': 388666}, '2': {'precision': 0.4124405777949085, 'recall': 0.5444941179321291, 'f1-score': 0.46935589149108375, 'support': 82539}, 'accuracy': 0.682928594956365, 'macro avg': {'precision': 0.5632841592800711, 'recall': 0.6152173511758307, 'f1-score': 0.5812994444624844, 'support': 552538}, 'weighted avg': {'precision': 0.7257912794722633, 'recall': 0.682928594956365, 'f1-score': 0.6983648237943826, 'support': 552538}}
[[ 45866  24338  11129]
 [ 49235 286536  52895]
 [ 13748  23849  44942]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.77512234
{'0': {'precision': 0.5047784211164257, 'recall': 0.49798099653228106, 'f1-score': 0.5013566699078577, 'support': 108717}, '1': {'precision': 0.7689577964598031, 'recall': 0.763401496677711, 'f1-score': 0.7661695730607336, 'support': 333806}, '2': {'precision': 0.478404790545346, 'recall': 0.49525973730854883, 'f1-score': 0.4866863773190535, 'support': 110015}, 'accuracy': 0.6577882426186072, 'macro avg': {'precision': 0.5840470027071917, 'recall': 0.585547410172847, 'f1-score': 0.5847375400958815, 'support': 552538}, 'weighted avg': {'precision': 0.6591264760892857, 'recall': 0.6577882426186072, 'f1-score': 0.6584176932414412, 'support': 552538}}
[[ 54139  38416  16162]
 [ 35735 254828  43243]
 [ 17379  38150  54486]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.830467
{'0': {'precision': 0.544586939949242, 'recall': 0.43939830422697507, 'f1-score': 0.48637025673730744, 'support': 128437}, '1': {'precision': 0.6905708969514567, 'recall': 0.7778540177722221, 'f1-score': 0.7316184046786465, 'support': 294392}, '2': {'precision': 0.5050976915470385, 'recall': 0.4568071606442113, 'f1-score': 0.4797402607917673, 'support': 129709}, 'accuracy': 0.6238141087128849, 'macro avg': {'precision': 0.5800851761492457, 'recall': 0.5580198275478028, 'f1-score': 0.5659096407359071, 'support': 552538}, 'weighted avg': {'precision': 0.613096975727405, 'recall': 0.6238141087128849, 'f1-score': 0.6154819605923303, 'support': 552538}}
[[ 56435  51672  20330]
 [ 27672 228994  37726]
 [ 19522  50935  59252]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.92781955
{'0': {'precision': 0.5702413807307328, 'recall': 0.3538677828545867, 'f1-score': 0.4367234111351654, 'support': 156485}, '1': {'precision': 0.5647547985877546, 'recall': 0.792512145129583, 'f1-score': 0.6595239631714161, 'support': 238573}, '2': {'precision': 0.5214432545340009, 'recall': 0.3994729489458979, 'f1-score': 0.4523809523809524, 'support': 157480}, 'accuracy': 0.5562621937314719, 'macro avg': {'precision': 0.5521464779508294, 'recall': 0.5152842923100226, 'f1-score': 0.516209442229178, 'support': 552538}, 'weighted avg': {'precision': 0.553964347703035, 'recall': 0.5562621937314719, 'f1-score': 0.5373860727011228, 'support': 552538}}
[[ 55375  73600  27510]
 [ 19276 189072  30225]
 [ 22457  72114  62909]]
Evaluating performance on  val set...
850/850 - 9s - 9s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.64661324
{'0': {'precision': 0.44812955824852335, 'recall': 0.5394938906323029, 'f1-score': 0.48958570021964715, 'support': 29954}, '1': {'precision': 0.8682963699095102, 'recall': 0.787906114258135, 'f1-score': 0.8261502145779855, 'support': 157468}, '2': {'precision': 0.43088943872900115, 'recall': 0.5528857400661699, 'f1-score': 0.4843233115723528, 'support': 29923}, 'accuracy': 0.7213140398904967, 'macro avg': {'precision': 0.5824384556290115, 'recall': 0.6267619149855359, 'f1-score': 0.6000197421233285, 'support': 217345}, 'weighted avg': {'precision': 0.7501698692851223, 'recall': 0.7213140398904967, 'f1-score': 0.7327045872034096, 'support': 217345}}
[[ 16160   9814   3980]
 [ 15527 124070  17871]
 [  4374   9005  16544]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.708648
{'0': {'precision': 0.5287047154744894, 'recall': 0.4733238016404545, 'f1-score': 0.4994838402286985, 'support': 39867}, '1': {'precision': 0.7859971721406613, 'recall': 0.8126300018909366, 'f1-score': 0.7990917380343637, 'support': 137498}, '2': {'precision': 0.5029495911081854, 'recall': 0.4968734367183592, 'f1-score': 0.499893050819734, 'support': 39980}, 'accuracy': 0.692309461915388, 'macro avg': {'precision': 0.605883826241112, 'recall': 0.5942757467499168, 'f1-score': 0.5994895430275987, 'support': 217345}, 'weighted avg': {'precision': 0.6867369146717126, 'recall': 0.692309461915388, 'f1-score': 0.6890987242697989, 'support': 217345}}
[[ 18870  15670   5327]
 [ 11458 111735  14305]
 [  5363  14752  19865]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7775278
{'0': {'precision': 0.5657913783619467, 'recall': 0.4131450436547365, 'f1-score': 0.4775670788329016, 'support': 47303}, '1': {'precision': 0.7106368359427037, 'recall': 0.8251998762477, 'f1-score': 0.7636455417719897, 'support': 122826}, '2': {'precision': 0.5291584737536401, 'recall': 0.4502710945442223, 'f1-score': 0.4865378233954665, 'support': 47216}, 'accuracy': 0.6540707170627343, 'macro avg': {'precision': 0.6018622293527635, 'recall': 0.562872004815553, 'f1-score': 0.575916814666786, 'support': 217345}, 'weighted avg': {'precision': 0.6396883115733307, 'recall': 0.6540707170627343, 'f1-score': 0.6411845347864432, 'support': 217345}}
[[ 19543  21314   6446]
 [  8999 101356  12471]
 [  5999  19957  21260]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.89676595
{'0': {'precision': 0.5891323889526053, 'recall': 0.32609851929379063, 'f1-score': 0.41981798904400075, 'support': 58283}, '1': {'precision': 0.5846145330251996, 'recall': 0.8362894924380394, 'f1-score': 0.6881632852523639, 'support': 101032}, '2': {'precision': 0.5436658612357611, 'recall': 0.37997587454764775, 'f1-score': 0.44731610337972166, 'support': 58030}, 'accuracy': 0.5776438381375233, 'macro avg': {'precision': 0.5724709277378554, 'recall': 0.5141212954264927, 'f1-score': 0.5184324592253621, 'support': 217345}, 'weighted avg': {'precision': 0.5748929510843952, 'recall': 0.5776438381375233, 'f1-score': 0.5518991390195016, 'support': 217345}}
[[19006 30818  8459]
 [ 6491 84492 10049]
 [ 6764 29216 22050]]
training model: results/AAL/W3/deepVOL_L2/seq2seq
Epoch 1/50
2159/2159 - 69s - loss: 11.3926 - accuracy10: 0.5038 - accuracy20: 0.5158 - accuracy30: 0.5139 - accuracy50: 0.5012 - val_loss: 10.9094 - val_accuracy10: 0.6327 - val_accuracy20: 0.6242 - val_accuracy30: 0.6030 - val_accuracy50: 0.5473 - 69s/epoch - 32ms/step
Epoch 2/50
2159/2159 - 63s - loss: 10.7654 - accuracy10: 0.5590 - accuracy20: 0.5631 - accuracy30: 0.5547 - accuracy50: 0.5308 - val_loss: 10.8783 - val_accuracy10: 0.6658 - val_accuracy20: 0.6482 - val_accuracy30: 0.6205 - val_accuracy50: 0.5599 - 63s/epoch - 29ms/step
Epoch 3/50
2159/2159 - 63s - loss: 10.4471 - accuracy10: 0.5870 - accuracy20: 0.5831 - accuracy30: 0.5689 - accuracy50: 0.5413 - val_loss: 10.8208 - val_accuracy10: 0.6877 - val_accuracy20: 0.6699 - val_accuracy30: 0.6384 - val_accuracy50: 0.5704 - 63s/epoch - 29ms/step
Epoch 4/50
2159/2159 - 63s - loss: 10.2672 - accuracy10: 0.5992 - accuracy20: 0.5933 - accuracy30: 0.5768 - accuracy50: 0.5466 - val_loss: 10.8253 - val_accuracy10: 0.7050 - val_accuracy20: 0.6805 - val_accuracy30: 0.6453 - val_accuracy50: 0.5718 - 63s/epoch - 29ms/step
Epoch 5/50
2159/2159 - 62s - loss: 10.1387 - accuracy10: 0.6078 - accuracy20: 0.6004 - accuracy30: 0.5826 - accuracy50: 0.5509 - val_loss: 10.5164 - val_accuracy10: 0.6999 - val_accuracy20: 0.6792 - val_accuracy30: 0.6443 - val_accuracy50: 0.5740 - 62s/epoch - 29ms/step
Epoch 6/50
2159/2159 - 63s - loss: 10.0555 - accuracy10: 0.6127 - accuracy20: 0.6058 - accuracy30: 0.5870 - accuracy50: 0.5541 - val_loss: 10.5425 - val_accuracy10: 0.6969 - val_accuracy20: 0.6783 - val_accuracy30: 0.6447 - val_accuracy50: 0.5750 - 63s/epoch - 29ms/step
Epoch 7/50
2159/2159 - 63s - loss: 9.9875 - accuracy10: 0.6183 - accuracy20: 0.6103 - accuracy30: 0.5906 - accuracy50: 0.5563 - val_loss: 10.5346 - val_accuracy10: 0.6985 - val_accuracy20: 0.6781 - val_accuracy30: 0.6446 - val_accuracy50: 0.5739 - 63s/epoch - 29ms/step
Epoch 8/50
2159/2159 - 63s - loss: 9.9411 - accuracy10: 0.6208 - accuracy20: 0.6114 - accuracy30: 0.5920 - accuracy50: 0.5581 - val_loss: 10.5355 - val_accuracy10: 0.7004 - val_accuracy20: 0.6800 - val_accuracy30: 0.6456 - val_accuracy50: 0.5746 - 63s/epoch - 29ms/step
Epoch 9/50
2159/2159 - 61s - loss: 9.9004 - accuracy10: 0.6225 - accuracy20: 0.6136 - accuracy30: 0.5942 - accuracy50: 0.5594 - val_loss: 10.5129 - val_accuracy10: 0.6995 - val_accuracy20: 0.6793 - val_accuracy30: 0.6460 - val_accuracy50: 0.5742 - 61s/epoch - 28ms/step
Epoch 10/50
2159/2159 - 62s - loss: 9.8651 - accuracy10: 0.6233 - accuracy20: 0.6146 - accuracy30: 0.5952 - accuracy50: 0.5609 - val_loss: 10.4708 - val_accuracy10: 0.6978 - val_accuracy20: 0.6798 - val_accuracy30: 0.6467 - val_accuracy50: 0.5753 - 62s/epoch - 29ms/step
Epoch 11/50
2159/2159 - 59s - loss: 9.8312 - accuracy10: 0.6254 - accuracy20: 0.6158 - accuracy30: 0.5972 - accuracy50: 0.5622 - val_loss: 10.4333 - val_accuracy10: 0.6993 - val_accuracy20: 0.6794 - val_accuracy30: 0.6459 - val_accuracy50: 0.5749 - 59s/epoch - 28ms/step
Epoch 12/50
2159/2159 - 60s - loss: 9.8048 - accuracy10: 0.6264 - accuracy20: 0.6163 - accuracy30: 0.5974 - accuracy50: 0.5631 - val_loss: 10.3894 - val_accuracy10: 0.6959 - val_accuracy20: 0.6771 - val_accuracy30: 0.6451 - val_accuracy50: 0.5746 - 60s/epoch - 28ms/step
Epoch 13/50
2159/2159 - 61s - loss: 9.7827 - accuracy10: 0.6276 - accuracy20: 0.6172 - accuracy30: 0.5982 - accuracy50: 0.5640 - val_loss: 10.3083 - val_accuracy10: 0.6971 - val_accuracy20: 0.6800 - val_accuracy30: 0.6477 - val_accuracy50: 0.5775 - 61s/epoch - 28ms/step
Epoch 14/50
2159/2159 - 63s - loss: 9.7570 - accuracy10: 0.6285 - accuracy20: 0.6186 - accuracy30: 0.5999 - accuracy50: 0.5652 - val_loss: 10.4047 - val_accuracy10: 0.6991 - val_accuracy20: 0.6803 - val_accuracy30: 0.6478 - val_accuracy50: 0.5764 - 63s/epoch - 29ms/step
Epoch 15/50
2159/2159 - 61s - loss: 9.7348 - accuracy10: 0.6293 - accuracy20: 0.6195 - accuracy30: 0.6006 - accuracy50: 0.5658 - val_loss: 10.3086 - val_accuracy10: 0.6893 - val_accuracy20: 0.6737 - val_accuracy30: 0.6431 - val_accuracy50: 0.5749 - 61s/epoch - 28ms/step
Epoch 16/50
2159/2159 - 62s - loss: 9.7103 - accuracy10: 0.6305 - accuracy20: 0.6202 - accuracy30: 0.6017 - accuracy50: 0.5667 - val_loss: 10.3754 - val_accuracy10: 0.6985 - val_accuracy20: 0.6804 - val_accuracy30: 0.6471 - val_accuracy50: 0.5757 - 62s/epoch - 29ms/step
Epoch 17/50
2159/2159 - 62s - loss: 9.6909 - accuracy10: 0.6310 - accuracy20: 0.6210 - accuracy30: 0.6022 - accuracy50: 0.5670 - val_loss: 10.3404 - val_accuracy10: 0.6911 - val_accuracy20: 0.6752 - val_accuracy30: 0.6445 - val_accuracy50: 0.5765 - 62s/epoch - 29ms/step
Epoch 18/50
2159/2159 - 63s - loss: 9.6752 - accuracy10: 0.6311 - accuracy20: 0.6213 - accuracy30: 0.6029 - accuracy50: 0.5676 - val_loss: 10.4524 - val_accuracy10: 0.7033 - val_accuracy20: 0.6824 - val_accuracy30: 0.6480 - val_accuracy50: 0.5766 - 63s/epoch - 29ms/step
Epoch 19/50
2159/2159 - 62s - loss: 9.6573 - accuracy10: 0.6319 - accuracy20: 0.6223 - accuracy30: 0.6037 - accuracy50: 0.5688 - val_loss: 10.4266 - val_accuracy10: 0.7101 - val_accuracy20: 0.6865 - val_accuracy30: 0.6512 - val_accuracy50: 0.5763 - 62s/epoch - 29ms/step
Epoch 20/50
2159/2159 - 62s - loss: 9.6408 - accuracy10: 0.6318 - accuracy20: 0.6222 - accuracy30: 0.6041 - accuracy50: 0.5690 - val_loss: 10.4433 - val_accuracy10: 0.7132 - val_accuracy20: 0.6881 - val_accuracy30: 0.6518 - val_accuracy50: 0.5776 - 62s/epoch - 29ms/step
Epoch 21/50
2159/2159 - 63s - loss: 9.6237 - accuracy10: 0.6328 - accuracy20: 0.6230 - accuracy30: 0.6051 - accuracy50: 0.5705 - val_loss: 10.4050 - val_accuracy10: 0.7043 - val_accuracy20: 0.6829 - val_accuracy30: 0.6497 - val_accuracy50: 0.5777 - 63s/epoch - 29ms/step
Epoch 22/50
2159/2159 - 63s - loss: 9.6129 - accuracy10: 0.6333 - accuracy20: 0.6235 - accuracy30: 0.6054 - accuracy50: 0.5706 - val_loss: 10.4819 - val_accuracy10: 0.7080 - val_accuracy20: 0.6840 - val_accuracy30: 0.6495 - val_accuracy50: 0.5763 - 63s/epoch - 29ms/step
Epoch 23/50
2159/2159 - 62s - loss: 9.5954 - accuracy10: 0.6337 - accuracy20: 0.6242 - accuracy30: 0.6058 - accuracy50: 0.5713 - val_loss: 10.5219 - val_accuracy10: 0.7119 - val_accuracy20: 0.6866 - val_accuracy30: 0.6504 - val_accuracy50: 0.5771 - 62s/epoch - 29ms/step
testing model: results/AAL/W3/deepVOL_L2/seq2seq
Evaluating performance on  test set...
5760/5760 - 54s - 54s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5714987
{'0': {'precision': 0.3685570006539272, 'recall': 0.6645812998277115, 'f1-score': 0.4741593462191904, 'support': 152651}, '1': {'precision': 0.9192530455557594, 'recall': 0.7856528977739619, 'f1-score': 0.8472183721970277, 'support': 1167051}, '2': {'precision': 0.4206290205873899, 'recall': 0.5483785512602652, 'f1-score': 0.4760828287191166, 'support': 154769}, 'accuracy': 0.7482127488434835, 'macro avg': {'precision': 0.5694796889323589, 'recall': 0.6662042496206462, 'f1-score': 0.5991535157117782, 'support': 1474471}, 'weighted avg': {'precision': 0.8099013908466203, 'recall': 0.7482127488434835, 'f1-score': 0.7696392876961622, 'support': 1474471}}
[[101449  33062  18140]
 [151392 916897  98762]
 [ 22419  47478  84872]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.61676884
{'0': {'precision': 0.4644439690737402, 'recall': 0.5794515455663264, 'f1-score': 0.5156124764105935, 'support': 209826}, '1': {'precision': 0.8545819167282582, 'recall': 0.820908294876346, 'f1-score': 0.8374067233991188, 'support': 1056375}, '2': {'precision': 0.4947634853513997, 'recall': 0.4702165458299323, 'f1-score': 0.48217780589699344, 'support': 208270}, 'accuracy': 0.7370121216354882, 'macro avg': {'precision': 0.6045964570511327, 'recall': 0.6235254620908682, 'f1-score': 0.6117323352355686, 'support': 1474471}, 'weighted avg': {'precision': 0.7482383740560623, 'recall': 0.7370121216354882, 'f1-score': 0.7414371680014324, 'support': 1474471}}
[[121584  67084  21158]
 [110341 867187  78847]
 [ 29859  80479  97932]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6743557
{'0': {'precision': 0.5171875252876725, 'recall': 0.5044057470039737, 'f1-score': 0.5107166758228037, 'support': 253419}, '1': {'precision': 0.7917902985038575, 'recall': 0.8436736240227478, 'f1-score': 0.8169089900470557, 'support': 971346}, '2': {'precision': 0.5373700083194676, 'recall': 0.41387471666680015, 'f1-score': 0.46760597792890013, 'support': 249706}, 'accuracy': 0.7125755609978087, 'macro avg': {'precision': 0.6154492773703325, 'recall': 0.5873180292311739, 'f1-score': 0.5984105479329199, 'support': 1474471}, 'weighted avg': {'precision': 0.7015071846505123, 'recall': 0.7125755609978087, 'f1-score': 0.7051278780262891, 'support': 1474471}}
[[127826 102183  23410]
 [ 86284 819499  65563]
 [ 33046 113313 103347]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7929078
{'0': {'precision': 0.5659775468506273, 'recall': 0.39856796739867006, 'f1-score': 0.4677446882682538, 'support': 323177}, '1': {'precision': 0.679891593724381, 'recall': 0.8673055613788146, 'f1-score': 0.7622477309073528, 'support': 834775}, '2': {'precision': 0.5735619742531717, 'recall': 0.32980642552263845, 'f1-score': 0.4187979667898307, 'support': 316519}, 'accuracy': 0.6491840124356464, 'macro avg': {'precision': 0.60647703827606, 'recall': 0.531893318100041, 'f1-score': 0.5495967953218125, 'support': 1474471}, 'weighted avg': {'precision': 0.6320983548258697, 'recall': 0.6491840124356464, 'f1-score': 0.623971029839858, 'support': 1474471}}
[[128808 167034  27335]
 [ 60492 724005  50278]
 [ 38285 173844 104390]]
Evaluating performance on  train set...
2159/2159 - 21s - 21s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.71587205
{'0': {'precision': 0.395102876540454, 'recall': 0.6301593537456724, 'f1-score': 0.4856860342437561, 'support': 81454}, '1': {'precision': 0.8663005627192207, 'recall': 0.7065277509807705, 'f1-score': 0.7782990462723005, 'support': 388725}, '2': {'precision': 0.4365304846866299, 'recall': 0.5596770276833414, 'f1-score': 0.4904923545122743, 'support': 82360}, 'accuracy': 0.6733805215559445, 'macro avg': {'precision': 0.5659779746487682, 'recall': 0.6321213774699281, 'f1-score': 0.5848258116761104, 'support': 552539}, 'weighted avg': {'precision': 0.7327773182844035, 'recall': 0.6733805215559445, 'f1-score': 0.6922630209145813, 'support': 552539}}
[[ 51329  19221  10904]
 [ 65485 274645  48595]
 [ 13099  23166  46095]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.76932895
{'0': {'precision': 0.47878864413066985, 'recall': 0.5574003969420759, 'f1-score': 0.5151125320018851, 'support': 108832}, '1': {'precision': 0.7748261046509821, 'recall': 0.7473413898186242, 'f1-score': 0.7608356110894182, 'support': 333727}, '2': {'precision': 0.5147235663642747, 'recall': 0.4864975450081833, 'f1-score': 0.5002126873869368, 'support': 109980}, 'accuracy': 0.6580096608565187, 'macro avg': {'precision': 0.5894461050486423, 'recall': 0.5970797772562945, 'f1-score': 0.5920536101594134, 'support': 552539}, 'weighted avg': {'precision': 0.6647444161835279, 'recall': 0.6580096608565187, 'f1-score': 0.6605606200171983, 'support': 552539}}
[[ 60663  34223  13946]
 [ 47821 249408  36498]
 [ 18217  38258  53505]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.82828456
{'0': {'precision': 0.5193909796035622, 'recall': 0.4925510219966686, 'f1-score': 0.5056150597861044, 'support': 128474}, '1': {'precision': 0.6925898775068212, 'recall': 0.7736513232780736, 'f1-score': 0.730879851057683, 'support': 294307}, '2': {'precision': 0.5518435326774627, 'recall': 0.43358405647435994, 'f1-score': 0.4856177360396014, 'support': 129758}, 'accuracy': 0.6284298483907923, 'macro avg': {'precision': 0.5879414632626153, 'recall': 0.5665954672497007, 'f1-score': 0.5740375489611297, 'support': 552539}, 'weighted avg': {'precision': 0.6192656064208142, 'recall': 0.6284298483907923, 'f1-score': 0.6209050070840612, 'support': 552539}}
[[ 63280  48602  16592]
 [ 37518 227691  29098]
 [ 21037  52460  56261]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.94334817
{'0': {'precision': 0.549031418868781, 'recall': 0.4019698703158056, 'f1-score': 0.46412994546246206, 'support': 156457}, '1': {'precision': 0.560459941743064, 'recall': 0.7994884696016772, 'f1-score': 0.6589680275505991, 'support': 238500}, '2': {'precision': 0.5732257371667024, 'recall': 0.3556624487568377, 'f1-score': 0.4389653619470933, 'support': 157582}, 'accuracy': 0.5603495861830567, 'macro avg': {'precision': 0.5609056992595158, 'recall': 0.5190402628914401, 'f1-score': 0.5206877783200515, 'support': 552539}, 'weighted avg': {'precision': 0.5608645958418806, 'recall': 0.5603495861830567, 'f1-score': 0.5410537412099149, 'support': 552539}}
[[ 62891  73170  20396]
 [ 26491 190678  21331]
 [ 25167  76369  56046]]
Evaluating performance on  val set...
850/850 - 8s - 8s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6663585
{'0': {'precision': 0.3989193098900164, 'recall': 0.6275349708854829, 'f1-score': 0.48776808125999827, 'support': 29882}, '1': {'precision': 0.8808734170459657, 'recall': 0.7327604249246868, 'f1-score': 0.8000193880306609, 'support': 157675}, '2': {'precision': 0.43742182514358646, 'recall': 0.5752652074660938, 'f1-score': 0.4969621391180778, 'support': 29788}, 'accuracy': 0.6967079988037452, 'macro avg': {'precision': 0.5724048506931895, 'recall': 0.6451868677587546, 'f1-score': 0.5949165361362456, 'support': 217345}, 'weighted avg': {'precision': 0.7538344299534531, 'recall': 0.6967079988037452, 'f1-score': 0.7155538476247212, 'support': 217345}}
[[ 18752   7233   3897]
 [ 23995 115538  18142]
 [  4260   8392  17136]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7202565
{'0': {'precision': 0.4797095070422535, 'recall': 0.5469189080690485, 'f1-score': 0.511114237478897, 'support': 39856}, '1': {'precision': 0.7937886337241974, 'recall': 0.7697667659667223, 'f1-score': 0.7815931684464856, 'support': 137630}, '2': {'precision': 0.5151404786680541, 'recall': 0.4968012243157129, 'f1-score': 0.5058046718348893, 'support': 39859}, 'accuracy': 0.6788423934298006, 'macro avg': {'precision': 0.5962128731448351, 'recall': 0.6044956327838279, 'f1-score': 0.5995040259200907, 'support': 217345}, 'weighted avg': {'precision': 0.6850924388017544, 'recall': 0.6788423934298006, 'f1-score': 0.6814166658396357, 'support': 217345}}
[[ 21798  13255   4803]
 [ 17852 105943  13835]
 [  5790  14267  19802]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7865032
{'0': {'precision': 0.5205036386739055, 'recall': 0.4767749444503227, 'f1-score': 0.4976805831676607, 'support': 47255}, '1': {'precision': 0.7140722400873152, 'recall': 0.7930347206403957, 'f1-score': 0.7514849233544428, 'support': 122924}, '2': {'precision': 0.5505953173694164, 'recall': 0.43826061145740575, 'f1-score': 0.4880473149252145, 'support': 47166}, 'accuracy': 0.6472842715498401, 'macro avg': {'precision': 0.5950570653768791, 'recall': 0.5693567588493748, 'f1-score': 0.5790709404824393, 'support': 217345}, 'weighted avg': {'precision': 0.6365105901910532, 'recall': 0.6472842715498401, 'f1-score': 0.6391344099554718, 'support': 217345}}
[[22530 19176  5549]
 [14118 97483 11323]
 [ 6637 19858 20671]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.910407
{'0': {'precision': 0.5539158640156486, 'recall': 0.38386039568283603, 'f1-score': 0.45346928019783916, 'support': 58279}, '1': {'precision': 0.5845872651534473, 'recall': 0.8165975596480984, 'f1-score': 0.68138410533139, 'support': 101051}, '2': {'precision': 0.5769789397240378, 'recall': 0.3560630871326381, 'f1-score': 0.44036795037146786, 'support': 58015}, 'accuracy': 0.5776346361775058, 'macro avg': {'precision': 0.5718273562977112, 'recall': 0.5188403474878576, 'f1-score': 0.5250737786335656, 'support': 217345}, 'weighted avg': {'precision': 0.5743321611174816, 'recall': 0.5776346361775058, 'f1-score': 0.5559374637065166, 'support': 217345}}
[[22371 29234  6674]
 [10062 82518  8471]
 [ 7954 29404 20657]]
training model: results/AAL/W3/deepVOL_L3/seq2seq
Epoch 1/50
2159/2159 - 98s - loss: 12.1627 - accuracy10: 0.4267 - accuracy20: 0.4457 - accuracy30: 0.4547 - accuracy50: 0.4548 - val_loss: 11.0719 - val_accuracy10: 0.6110 - val_accuracy20: 0.6049 - val_accuracy30: 0.5862 - val_accuracy50: 0.5388 - 98s/epoch - 45ms/step
Epoch 2/50
2159/2159 - 92s - loss: 10.9113 - accuracy10: 0.5399 - accuracy20: 0.5489 - accuracy30: 0.5463 - accuracy50: 0.5259 - val_loss: 10.6960 - val_accuracy10: 0.6672 - val_accuracy20: 0.6478 - val_accuracy30: 0.6197 - val_accuracy50: 0.5567 - 92s/epoch - 43ms/step
Epoch 3/50
2159/2159 - 90s - loss: 10.5273 - accuracy10: 0.5768 - accuracy20: 0.5746 - accuracy30: 0.5643 - accuracy50: 0.5386 - val_loss: 10.3855 - val_accuracy10: 0.6918 - val_accuracy20: 0.6687 - val_accuracy30: 0.6357 - val_accuracy50: 0.5662 - 90s/epoch - 42ms/step
Epoch 4/50
2159/2159 - 90s - loss: 10.2626 - accuracy10: 0.5900 - accuracy20: 0.5851 - accuracy30: 0.5723 - accuracy50: 0.5458 - val_loss: 10.2639 - val_accuracy10: 0.6779 - val_accuracy20: 0.6578 - val_accuracy30: 0.6282 - val_accuracy50: 0.5622 - 90s/epoch - 42ms/step
Epoch 5/50
2159/2159 - 91s - loss: 10.0808 - accuracy10: 0.6021 - accuracy20: 0.5968 - accuracy30: 0.5819 - accuracy50: 0.5520 - val_loss: 10.3288 - val_accuracy10: 0.7219 - val_accuracy20: 0.6873 - val_accuracy30: 0.6456 - val_accuracy50: 0.5662 - 91s/epoch - 42ms/step
Epoch 6/50
2159/2159 - 90s - loss: 9.9956 - accuracy10: 0.6061 - accuracy20: 0.6002 - accuracy30: 0.5849 - accuracy50: 0.5542 - val_loss: 10.2320 - val_accuracy10: 0.7111 - val_accuracy20: 0.6822 - val_accuracy30: 0.6450 - val_accuracy50: 0.5696 - 90s/epoch - 42ms/step
Epoch 7/50
2159/2159 - 90s - loss: 9.8959 - accuracy10: 0.6140 - accuracy20: 0.6071 - accuracy30: 0.5904 - accuracy50: 0.5581 - val_loss: 10.1376 - val_accuracy10: 0.7050 - val_accuracy20: 0.6790 - val_accuracy30: 0.6437 - val_accuracy50: 0.5714 - 90s/epoch - 42ms/step
Epoch 8/50
2159/2159 - 91s - loss: 9.8332 - accuracy10: 0.6178 - accuracy20: 0.6107 - accuracy30: 0.5932 - accuracy50: 0.5606 - val_loss: 10.1778 - val_accuracy10: 0.7032 - val_accuracy20: 0.6779 - val_accuracy30: 0.6426 - val_accuracy50: 0.5715 - 91s/epoch - 42ms/step
Epoch 9/50
2159/2159 - 93s - loss: 9.7793 - accuracy10: 0.6224 - accuracy20: 0.6136 - accuracy30: 0.5967 - accuracy50: 0.5633 - val_loss: 10.1114 - val_accuracy10: 0.7114 - val_accuracy20: 0.6842 - val_accuracy30: 0.6483 - val_accuracy50: 0.5752 - 93s/epoch - 43ms/step
Epoch 10/50
2159/2159 - 91s - loss: 9.7496 - accuracy10: 0.6238 - accuracy20: 0.6151 - accuracy30: 0.5975 - accuracy50: 0.5639 - val_loss: 10.0339 - val_accuracy10: 0.7023 - val_accuracy20: 0.6805 - val_accuracy30: 0.6480 - val_accuracy50: 0.5765 - 91s/epoch - 42ms/step
Epoch 11/50
2159/2159 - 91s - loss: 9.7130 - accuracy10: 0.6259 - accuracy20: 0.6172 - accuracy30: 0.5996 - accuracy50: 0.5660 - val_loss: 10.1220 - val_accuracy10: 0.7092 - val_accuracy20: 0.6840 - val_accuracy30: 0.6489 - val_accuracy50: 0.5748 - 91s/epoch - 42ms/step
Epoch 12/50
2159/2159 - 92s - loss: 9.6836 - accuracy10: 0.6279 - accuracy20: 0.6186 - accuracy30: 0.6008 - accuracy50: 0.5669 - val_loss: 9.9938 - val_accuracy10: 0.7044 - val_accuracy20: 0.6827 - val_accuracy30: 0.6487 - val_accuracy50: 0.5772 - 92s/epoch - 43ms/step
Epoch 13/50
2159/2159 - 92s - loss: 9.6587 - accuracy10: 0.6284 - accuracy20: 0.6188 - accuracy30: 0.6010 - accuracy50: 0.5675 - val_loss: 9.9407 - val_accuracy10: 0.6997 - val_accuracy20: 0.6801 - val_accuracy30: 0.6481 - val_accuracy50: 0.5774 - 92s/epoch - 42ms/step
Epoch 14/50
2159/2159 - 92s - loss: 9.6368 - accuracy10: 0.6303 - accuracy20: 0.6208 - accuracy30: 0.6029 - accuracy50: 0.5690 - val_loss: 9.8322 - val_accuracy10: 0.6862 - val_accuracy20: 0.6707 - val_accuracy30: 0.6425 - val_accuracy50: 0.5783 - 92s/epoch - 42ms/step
Epoch 15/50
2159/2159 - 90s - loss: 9.6155 - accuracy10: 0.6316 - accuracy20: 0.6214 - accuracy30: 0.6036 - accuracy50: 0.5702 - val_loss: 9.8566 - val_accuracy10: 0.6879 - val_accuracy20: 0.6723 - val_accuracy30: 0.6431 - val_accuracy50: 0.5767 - 90s/epoch - 42ms/step
Epoch 16/50
2159/2159 - 91s - loss: 9.5956 - accuracy10: 0.6327 - accuracy20: 0.6225 - accuracy30: 0.6044 - accuracy50: 0.5707 - val_loss: 9.9226 - val_accuracy10: 0.6977 - val_accuracy20: 0.6780 - val_accuracy30: 0.6459 - val_accuracy50: 0.5776 - 91s/epoch - 42ms/step
Epoch 17/50
2159/2159 - 91s - loss: 9.5787 - accuracy10: 0.6330 - accuracy20: 0.6229 - accuracy30: 0.6055 - accuracy50: 0.5716 - val_loss: 9.8105 - val_accuracy10: 0.6776 - val_accuracy20: 0.6665 - val_accuracy30: 0.6398 - val_accuracy50: 0.5778 - 91s/epoch - 42ms/step
Epoch 18/50
2159/2159 - 91s - loss: 9.5609 - accuracy10: 0.6341 - accuracy20: 0.6237 - accuracy30: 0.6059 - accuracy50: 0.5719 - val_loss: 9.8245 - val_accuracy10: 0.6743 - val_accuracy20: 0.6615 - val_accuracy30: 0.6355 - val_accuracy50: 0.5757 - 91s/epoch - 42ms/step
Epoch 19/50
2159/2159 - 91s - loss: 9.5465 - accuracy10: 0.6346 - accuracy20: 0.6245 - accuracy30: 0.6063 - accuracy50: 0.5723 - val_loss: 9.9251 - val_accuracy10: 0.6848 - val_accuracy20: 0.6688 - val_accuracy30: 0.6398 - val_accuracy50: 0.5766 - 91s/epoch - 42ms/step
Epoch 20/50
2159/2159 - 91s - loss: 9.5345 - accuracy10: 0.6348 - accuracy20: 0.6248 - accuracy30: 0.6071 - accuracy50: 0.5735 - val_loss: 9.9726 - val_accuracy10: 0.6832 - val_accuracy20: 0.6672 - val_accuracy30: 0.6385 - val_accuracy50: 0.5751 - 91s/epoch - 42ms/step
Epoch 21/50
2159/2159 - 90s - loss: 9.5169 - accuracy10: 0.6354 - accuracy20: 0.6252 - accuracy30: 0.6072 - accuracy50: 0.5734 - val_loss: 9.8932 - val_accuracy10: 0.6928 - val_accuracy20: 0.6741 - val_accuracy30: 0.6442 - val_accuracy50: 0.5777 - 90s/epoch - 42ms/step
Epoch 22/50
2159/2159 - 90s - loss: 9.5017 - accuracy10: 0.6366 - accuracy20: 0.6261 - accuracy30: 0.6082 - accuracy50: 0.5740 - val_loss: 9.9272 - val_accuracy10: 0.6900 - val_accuracy20: 0.6719 - val_accuracy30: 0.6429 - val_accuracy50: 0.5769 - 90s/epoch - 42ms/step
Epoch 23/50
2159/2159 - 91s - loss: 9.4881 - accuracy10: 0.6365 - accuracy20: 0.6265 - accuracy30: 0.6086 - accuracy50: 0.5750 - val_loss: 9.9244 - val_accuracy10: 0.6791 - val_accuracy20: 0.6625 - val_accuracy30: 0.6353 - val_accuracy50: 0.5740 - 91s/epoch - 42ms/step
Epoch 24/50
2159/2159 - 92s - loss: 9.4803 - accuracy10: 0.6370 - accuracy20: 0.6270 - accuracy30: 0.6091 - accuracy50: 0.5755 - val_loss: 9.9862 - val_accuracy10: 0.6833 - val_accuracy20: 0.6648 - val_accuracy30: 0.6359 - val_accuracy50: 0.5734 - 92s/epoch - 43ms/step
Epoch 25/50
2159/2159 - 91s - loss: 9.4650 - accuracy10: 0.6375 - accuracy20: 0.6275 - accuracy30: 0.6098 - accuracy50: 0.5756 - val_loss: 9.9832 - val_accuracy10: 0.6912 - val_accuracy20: 0.6714 - val_accuracy30: 0.6412 - val_accuracy50: 0.5764 - 91s/epoch - 42ms/step
Epoch 26/50
2159/2159 - 91s - loss: 9.4523 - accuracy10: 0.6377 - accuracy20: 0.6281 - accuracy30: 0.6098 - accuracy50: 0.5761 - val_loss: 9.9692 - val_accuracy10: 0.6874 - val_accuracy20: 0.6686 - val_accuracy30: 0.6393 - val_accuracy50: 0.5759 - 91s/epoch - 42ms/step
Epoch 27/50
2159/2159 - 92s - loss: 9.4352 - accuracy10: 0.6385 - accuracy20: 0.6284 - accuracy30: 0.6112 - accuracy50: 0.5769 - val_loss: 10.0657 - val_accuracy10: 0.6822 - val_accuracy20: 0.6639 - val_accuracy30: 0.6358 - val_accuracy50: 0.5735 - 92s/epoch - 42ms/step
testing model: results/AAL/W3/deepVOL_L3/seq2seq
Evaluating performance on  test set...
5760/5760 - 97s - 97s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.56402344
{'0': {'precision': 0.3610632802410676, 'recall': 0.7033036141263405, 'f1-score': 0.47716085734285935, 'support': 152651}, '1': {'precision': 0.9239302613520638, 'recall': 0.7781630794198369, 'f1-score': 0.8448049235852646, 'support': 1167051}, '2': {'precision': 0.42139546858908344, 'recall': 0.528755758582145, 'f1-score': 0.46901014130194946, 'support': 154769}, 'accuracy': 0.7442336946606614, 'macro avg': {'precision': 0.5687963367274049, 'recall': 0.6700741507094407, 'f1-score': 0.5969919740766911, 'support': 1474471}, 'weighted avg': {'precision': 0.8129080609325857, 'recall': 0.7442336946606614, 'f1-score': 0.7672973856172911, 'support': 1474471}}
[[107360  31337  13954]
 [160484 908156  98411]
 [ 29500  43434  81835]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.61279887
{'0': {'precision': 0.4455818875861541, 'recall': 0.6380906084088721, 'f1-score': 0.5247371669883697, 'support': 209826}, '1': {'precision': 0.8628260138406189, 'recall': 0.8014000709975151, 'f1-score': 0.8309794384909289, 'support': 1056375}, '2': {'precision': 0.49215857111740363, 'recall': 0.4556537187304941, 'f1-score': 0.4732031553857967, 'support': 208270}, 'accuracy': 0.7293232623768118, 'macro avg': {'precision': 0.6001888241813922, 'recall': 0.6317147993789605, 'f1-score': 0.6096399202883651, 'support': 1474471}, 'weighted avg': {'precision': 0.7510926706067177, 'recall': 0.7293232623768118, 'f1-score': 0.736863204707693, 'support': 1474471}}
[[133888  60166  15772]
 [127645 846579  82151]
 [ 38946  74425  94899]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.66998655
{'0': {'precision': 0.49516307352128247, 'recall': 0.5655455983963318, 'f1-score': 0.5280192462499471, 'support': 253419}, '1': {'precision': 0.8014013257355507, 'recall': 0.8229662756628431, 'f1-score': 0.8120406535861401, 'support': 971346}, '2': {'precision': 0.5340101414578745, 'recall': 0.4010796696915573, 'f1-score': 0.458096342392162, 'support': 249706}, 'accuracy': 0.7072753550256329, 'macro avg': {'precision': 0.6101915135715692, 'recall': 0.5965305145835774, 'f1-score': 0.599385414076083, 'support': 1474471}, 'weighted avg': {'precision': 0.7034843272329494, 'recall': 0.7072753550256329, 'f1-score': 0.7032840627839241, 'support': 1474471}}
[[143320  93575  16524]
 [101090 799385  70871]
 [ 45030 104524 100152]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7837008
{'0': {'precision': 0.5379869589445574, 'recall': 0.4600482088762505, 'f1-score': 0.49597438014461204, 'support': 323177}, '1': {'precision': 0.6898948012040638, 'recall': 0.8434224791111378, 'f1-score': 0.7589724462477881, 'support': 834775}, '2': {'precision': 0.5725717889947006, 'recall': 0.3212161039305697, 'f1-score': 0.4115501692006282, 'support': 316519}, 'accuracy': 0.6472938430121719, 'macro avg': {'precision': 0.6001511830477739, 'recall': 0.5415622639726526, 'f1-score': 0.5554989985310095, 'support': 1474471}, 'weighted avg': {'precision': 0.6314141100006451, 'recall': 0.6472938430121719, 'f1-score': 0.6267482941839523, 'support': 1474471}}
[[148677 154821  19679]
 [ 74488 704068  56219]
 [ 53193 161655 101671]]
Evaluating performance on  train set...
2159/2159 - 36s - 36s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7266245
{'0': {'precision': 0.3631617327148276, 'recall': 0.7275763007341567, 'f1-score': 0.48449373168249243, 'support': 81454}, '1': {'precision': 0.882935757303095, 'recall': 0.6664248504726992, 'f1-score': 0.7595524593624656, 'support': 388725}, '2': {'precision': 0.44441201913556444, 'recall': 0.5177270519669742, 'f1-score': 0.4782762314435216, 'support': 82360}, 'accuracy': 0.6532751534280838, 'macro avg': {'precision': 0.5635031697178291, 'recall': 0.6372427343912767, 'f1-score': 0.5741074741628266, 'support': 552539}, 'weighted avg': {'precision': 0.7409467058980529, 'recall': 0.6532751534280838, 'f1-score': 0.6770776589667491, 'support': 552539}}
[[ 59264  15262   6928]
 [ 83290 259056  46379]
 [ 20635  19085  42640]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7635936
{'0': {'precision': 0.4420408891513932, 'recall': 0.6601734783887092, 'f1-score': 0.5295225320504553, 'support': 108832}, '1': {'precision': 0.796504009288241, 'recall': 0.703038711281976, 'f1-score': 0.746858551662998, 'support': 333727}, '2': {'precision': 0.5230311412884027, 'recall': 0.4538643389707219, 'f1-score': 0.4859991432020875, 'support': 109980}, 'accuracy': 0.6449988145633159, 'macro avg': {'precision': 0.587192013242679, 'recall': 0.6056921762138024, 'f1-score': 0.5874600756385137, 'support': 552539}, 'weighted avg': {'precision': 0.6722530943060305, 'recall': 0.6449988145633159, 'f1-score': 0.6521278060884717, 'support': 552539}}
[[ 71848  27824   9160]
 [ 62744 234623  36360]
 [ 27945  32119  49916]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.81266034
{'0': {'precision': 0.4813113685780348, 'recall': 0.5978797266372963, 'f1-score': 0.533300007290072, 'support': 128474}, '1': {'precision': 0.71685354158929, 'recall': 0.7279507453101693, 'f1-score': 0.7223595259369153, 'support': 294307}, '2': {'precision': 0.5594609244635285, 'recall': 0.40566284930408913, 'f1-score': 0.4703075789050459, 'support': 129758}, 'accuracy': 0.622021250988618, 'macro avg': {'precision': 0.5858752782102844, 'recall': 0.5771644404171848, 'f1-score': 0.5753223707106777, 'support': 552539}, 'weighted avg': {'precision': 0.6251242765990312, 'recall': 0.622021250988618, 'f1-score': 0.619208455801421, 'support': 552539}}
[[ 76812  40665  10997]
 [ 49614 214241  30452]
 [ 33163  43957  52638]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.90706813
{'0': {'precision': 0.5097694236871737, 'recall': 0.509270917887982, 'f1-score': 0.5095200488551961, 'support': 156457}, '1': {'precision': 0.585440063406598, 'recall': 0.7494884696016771, 'f1-score': 0.6573843712476855, 'support': 238500}, '2': {'precision': 0.5839126991111502, 'recall': 0.3368405020878019, 'f1-score': 0.4272272884589071, 'support': 157582}, 'accuracy': 0.5637828279994715, 'macro avg': {'precision': 0.5597073954016406, 'recall': 0.5318666298591537, 'f1-score': 0.531377236187263, 'support': 552539}, 'weighted avg': {'precision': 0.5635775588612406, 'recall': 0.5637828279994715, 'f1-score': 0.5498751787588603, 'support': 552539}}
[[ 79679  62403  14375]
 [ 36298 178753  23449]
 [ 40327  64175  53080]]
Evaluating performance on  val set...
850/850 - 14s - 14s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.674848
{'0': {'precision': 0.36851569591204125, 'recall': 0.7200990562880664, 'f1-score': 0.4875329942337974, 'support': 29882}, '1': {'precision': 0.8956118922540217, 'recall': 0.6952402092912636, 'f1-score': 0.7828074009011903, 'support': 157675}, '2': {'precision': 0.4386540828887977, 'recall': 0.5383040150396132, 'f1-score': 0.4833968919102241, 'support': 29788}, 'accuracy': 0.6771492327865836, 'macro avg': {'precision': 0.5675938903516202, 'recall': 0.651214426872981, 'f1-score': 0.5845790956817373, 'support': 217345}, 'weighted avg': {'precision': 0.7605153969840024, 'recall': 0.6771492327865836, 'f1-score': 0.7011757550760831, 'support': 217345}}
[[ 21518   5760   2604]
 [ 30137 109622  17916]
 [  6736   7017  16035]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.71598405
{'0': {'precision': 0.4431428620648073, 'recall': 0.64542352468888, 'f1-score': 0.5254889944333794, 'support': 39856}, '1': {'precision': 0.8134864517806928, 'recall': 0.7272614982198649, 'f1-score': 0.7679612693346428, 'support': 137630}, '2': {'precision': 0.5203839576322613, 'recall': 0.47331844752753455, 'f1-score': 0.49573660215731874, 'support': 39859}, 'accuracy': 0.6656835906047989, 'macro avg': {'precision': 0.5923377571592537, 'recall': 0.6153344901454264, 'f1-score': 0.5963956219751135, 'support': 217345}, 'weighted avg': {'precision': 0.6918218796673309, 'recall': 0.6656835906047989, 'f1-score': 0.6735741060804354, 'support': 217345}}
[[ 25724  10825   3307]
 [ 23456 100093  14081]
 [  8869  12124  18866]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.77440286
{'0': {'precision': 0.48057831495867914, 'recall': 0.5746905089408528, 'f1-score': 0.5234378011641803, 'support': 47255}, '1': {'precision': 0.7351420363868497, 'recall': 0.7494712179883505, 'f1-score': 0.7422374760316464, 'support': 122924}, '2': {'precision': 0.5554398017794797, 'recall': 0.4182461942924988, 'f1-score': 0.47717762028010935, 'support': 47166}, 'accuracy': 0.6395914329752237, 'macro avg': {'precision': 0.5903867177083362, 'recall': 0.5808026404072341, 'f1-score': 0.5809509658253119, 'support': 217345}, 'weighted avg': {'precision': 0.640797817501762, 'recall': 0.6395914329752237, 'f1-score': 0.6371456092197155, 'support': 217345}}
[[27157 16255  3843]
 [18850 92128 11946]
 [10502 16937 19727]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8813664
{'0': {'precision': 0.5103105906313645, 'recall': 0.4815285094116234, 'f1-score': 0.49550193783051266, 'support': 58279}, '1': {'precision': 0.6050150388829149, 'recall': 0.7683644892183155, 'f1-score': 0.6769753907186608, 'support': 101051}, '2': {'precision': 0.5834092712895734, 'recall': 0.34210118072912177, 'f1-score': 0.4312971293217724, 'support': 58015}, 'accuracy': 0.5776714440175758, 'macro avg': {'precision': 0.5662449669346176, 'recall': 0.5306647264530202, 'f1-score': 0.5345914859569819, 'support': 217345}, 'weighted avg': {'precision': 0.5738538014650778, 'recall': 0.5776714440175758, 'f1-score': 0.5627371257675053, 'support': 217345}}
[[28063 25363  4853]
 [14088 77644  9319]
 [12841 25327 19847]]
training model: results/AAL/W4/deepLOB_L1/seq2seq
Epoch 1/50
2425/2425 - 71s - loss: 11.0277 - accuracy10: 0.4882 - accuracy20: 0.5076 - accuracy30: 0.5159 - accuracy50: 0.5167 - val_loss: 15.7089 - val_accuracy10: 0.7252 - val_accuracy20: 0.6488 - val_accuracy30: 0.5932 - val_accuracy50: 0.5112 - 71s/epoch - 29ms/step
Epoch 2/50
2425/2425 - 64s - loss: 10.9836 - accuracy10: 0.4865 - accuracy20: 0.5062 - accuracy30: 0.5161 - accuracy50: 0.5184 - val_loss: 14.6532 - val_accuracy10: 0.7114 - val_accuracy20: 0.6358 - val_accuracy30: 0.5835 - val_accuracy50: 0.5064 - 64s/epoch - 26ms/step
Epoch 3/50
2425/2425 - 62s - loss: 10.6706 - accuracy10: 0.5208 - accuracy20: 0.5335 - accuracy30: 0.5393 - accuracy50: 0.5360 - val_loss: 11.9649 - val_accuracy10: 0.6069 - val_accuracy20: 0.5923 - val_accuracy30: 0.5810 - val_accuracy50: 0.5406 - 62s/epoch - 26ms/step
Epoch 4/50
2425/2425 - 61s - loss: 10.2231 - accuracy10: 0.5711 - accuracy20: 0.5731 - accuracy30: 0.5703 - accuracy50: 0.5586 - val_loss: 12.0214 - val_accuracy10: 0.6341 - val_accuracy20: 0.6086 - val_accuracy30: 0.5855 - val_accuracy50: 0.5429 - 61s/epoch - 25ms/step
Epoch 5/50
2425/2425 - 60s - loss: 9.8976 - accuracy10: 0.6018 - accuracy20: 0.5992 - accuracy30: 0.5900 - accuracy50: 0.5716 - val_loss: 12.6624 - val_accuracy10: 0.6600 - val_accuracy20: 0.6337 - val_accuracy30: 0.6053 - val_accuracy50: 0.5564 - 60s/epoch - 25ms/step
Epoch 6/50
2425/2425 - 57s - loss: 9.6894 - accuracy10: 0.6204 - accuracy20: 0.6143 - accuracy30: 0.6009 - accuracy50: 0.5790 - val_loss: 13.1768 - val_accuracy10: 0.6193 - val_accuracy20: 0.5952 - val_accuracy30: 0.5699 - val_accuracy50: 0.5296 - 57s/epoch - 23ms/step
Epoch 7/50
2425/2425 - 60s - loss: 9.5573 - accuracy10: 0.6278 - accuracy20: 0.6209 - accuracy30: 0.6064 - accuracy50: 0.5827 - val_loss: 12.6526 - val_accuracy10: 0.6146 - val_accuracy20: 0.6015 - val_accuracy30: 0.5818 - val_accuracy50: 0.5436 - 60s/epoch - 25ms/step
Epoch 8/50
2425/2425 - 63s - loss: 9.4676 - accuracy10: 0.6339 - accuracy20: 0.6263 - accuracy30: 0.6102 - accuracy50: 0.5856 - val_loss: 12.6270 - val_accuracy10: 0.5964 - val_accuracy20: 0.5865 - val_accuracy30: 0.5675 - val_accuracy50: 0.5329 - 63s/epoch - 26ms/step
Epoch 9/50
2425/2425 - 64s - loss: 9.4083 - accuracy10: 0.6370 - accuracy20: 0.6286 - accuracy30: 0.6123 - accuracy50: 0.5870 - val_loss: 12.4074 - val_accuracy10: 0.6149 - val_accuracy20: 0.6027 - val_accuracy30: 0.5822 - val_accuracy50: 0.5428 - 64s/epoch - 26ms/step
Epoch 10/50
2425/2425 - 62s - loss: 9.3634 - accuracy10: 0.6391 - accuracy20: 0.6312 - accuracy30: 0.6146 - accuracy50: 0.5882 - val_loss: 12.4190 - val_accuracy10: 0.6161 - val_accuracy20: 0.6062 - val_accuracy30: 0.5866 - val_accuracy50: 0.5486 - 62s/epoch - 25ms/step
Epoch 11/50
2425/2425 - 66s - loss: 9.3217 - accuracy10: 0.6424 - accuracy20: 0.6340 - accuracy30: 0.6165 - accuracy50: 0.5893 - val_loss: 12.3188 - val_accuracy10: 0.6219 - val_accuracy20: 0.6106 - val_accuracy30: 0.5893 - val_accuracy50: 0.5491 - 66s/epoch - 27ms/step
Epoch 12/50
2425/2425 - 59s - loss: 9.2852 - accuracy10: 0.6452 - accuracy20: 0.6363 - accuracy30: 0.6185 - accuracy50: 0.5903 - val_loss: 13.1190 - val_accuracy10: 0.5959 - val_accuracy20: 0.5867 - val_accuracy30: 0.5688 - val_accuracy50: 0.5328 - 59s/epoch - 24ms/step
Epoch 13/50
2425/2425 - 62s - loss: 9.2531 - accuracy10: 0.6466 - accuracy20: 0.6379 - accuracy30: 0.6197 - accuracy50: 0.5913 - val_loss: 11.9904 - val_accuracy10: 0.6250 - val_accuracy20: 0.6129 - val_accuracy30: 0.5922 - val_accuracy50: 0.5516 - 62s/epoch - 26ms/step
testing model: results/AAL/W4/deepLOB_L1/seq2seq
Evaluating performance on  test set...
4457/4457 - 41s - 41s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8444519
{'0': {'precision': 0.34698273807821717, 'recall': 0.4226861581691302, 'f1-score': 0.3811114135555602, 'support': 172246}, '1': {'precision': 0.7764499389770528, 'recall': 0.5464008001000125, 'f1-score': 0.6414221277763551, 'support': 799900}, '2': {'precision': 0.2948130244684029, 'recall': 0.6430725121880424, 'f1-score': 0.4042842007064611, 'support': 168813}, 'accuracy': 0.542027364699345, 'macro avg': {'precision': 0.47274856717455765, 'recall': 0.5373864901523949, 'f1-score': 0.4756059140127922, 'support': 1140959}, 'weighted avg': {'precision': 0.640353392181796, 'recall': 0.542027364699345, 'f1-score': 0.5670378210973903, 'support': 1140959}}
[[ 72806  73230  26210]
 [129373 437066 233461]
 [  7647  52607 108559]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8903365
{'0': {'precision': 0.4310055397011919, 'recall': 0.3810577686982181, 'f1-score': 0.40449557948584874, 'support': 229086}, '1': {'precision': 0.6838000932259974, 'recall': 0.5529688459646457, 'f1-score': 0.6114644966247995, 'support': 687102}, '2': {'precision': 0.3619788809296153, 'recall': 0.6164451819852205, 'f1-score': 0.45612152355432367, 'support': 224771}, 'accuracy': 0.5309568529631652, 'macro avg': {'precision': 0.49226150461893486, 'recall': 0.5168239322160281, 'f1-score': 0.49069386655499064, 'support': 1140959}, 'weighted avg': {'precision': 0.5696436960216688, 'recall': 0.5309568529631652, 'f1-score': 0.5393056576553733, 'support': 1140959}}
[[ 87295 101126  40665]
 [103598 379946 203558]
 [ 11645  74567 138559]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9256685
{'0': {'precision': 0.48698397672700405, 'recall': 0.31518368810753056, 'f1-score': 0.38268659424398427, 'support': 267682}, '1': {'precision': 0.6071419685612727, 'recall': 0.5985081362494767, 'f1-score': 0.6027941383532419, 'support': 611584}, '2': {'precision': 0.4029696511194439, 'recall': 0.5617765855410729, 'f1-score': 0.46930250895027587, 'support': 261693}, 'accuracy': 0.5236121543368342, 'macro avg': {'precision': 0.4990318654692402, 'recall': 0.49182280329936007, 'f1-score': 0.48492774718250065, 'support': 1140959}, 'weighted avg': {'precision': 0.5321220968231251, 'recall': 0.5236121543368342, 'f1-score': 0.5205364475899412, 'support': 1140959}}
[[ 84369 135027  48286]
 [ 76021 366038 169525]
 [ 12858 101822 147013]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9873636
{'0': {'precision': 0.5461007235153719, 'recall': 0.22671446054830433, 'f1-score': 0.32041019247526836, 'support': 321938}, '1': {'precision': 0.4973134162869852, 'recall': 0.6690257636153455, 'f1-score': 0.5705295574747272, 'support': 509517}, '2': {'precision': 0.44422627018327676, 'recall': 0.4619649503722084, 'f1-score': 0.4529219930721752, 'support': 309504}, 'accuracy': 0.4880525943526455, 'macro avg': {'precision': 0.4958801366618779, 'recall': 0.4525683915119528, 'f1-score': 0.4479539143407236, 'support': 1140959}, 'weighted avg': {'precision': 0.49667869062796516, 'recall': 0.4880525943526455, 'f1-score': 0.46805178242580503, 'support': 1140959}}
[[ 72988 191992  56958]
 [ 46712 340880 121925]
 [ 13953 152571 142980]]
Evaluating performance on  train set...
2425/2425 - 22s - 22s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7715154
{'0': {'precision': 0.3643052155299486, 'recall': 0.35717696735114485, 'f1-score': 0.3607058778737364, 'support': 79574}, '1': {'precision': 0.8320988272888465, 'recall': 0.6435774444119116, 'f1-score': 0.7257960936750749, 'support': 464488}, '2': {'precision': 0.2745561872162296, 'recall': 0.6569546788392566, 'f1-score': 0.3872654165801754, 'support': 76675}, 'accuracy': 0.6085153615782529, 'macro avg': {'precision': 0.4903200766783416, 'recall': 0.5525696968674377, 'f1-score': 0.4912557960429956, 'support': 620737}, 'weighted avg': {'precision': 0.7032619917374449, 'recall': 0.6085153615782529, 'f1-score': 0.6371780017965061, 'support': 620737}}
[[ 28422  37506  13646]
 [ 46105 298934 119449]
 [  3490  22813  50372]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.82185024
{'0': {'precision': 0.43343179660301717, 'recall': 0.3137427095961283, 'f1-score': 0.36400081952235136, 'support': 104761}, '1': {'precision': 0.7617763661819293, 'recall': 0.6571966625436607, 'f1-score': 0.7056327010091716, 'support': 413129}, '2': {'precision': 0.34315514716804957, 'recall': 0.6289147957645823, 'f1-score': 0.444032553142559, 'support': 102847}, 'accuracy': 0.5945464826488512, 'macro avg': {'precision': 0.5127877699843321, 'recall': 0.5332847226347904, 'f1-score': 0.5045553578913607, 'support': 620737}, 'weighted avg': {'precision': 0.6370026826966901, 'recall': 0.5945464826488512, 'f1-score': 0.6046326189388612, 'support': 620737}}
[[ 32868  51538  20355]
 [ 38167 271507 103455]
 [  4797  33368  64682]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.86003685
{'0': {'precision': 0.48265077030270187, 'recall': 0.254222497696078, 'f1-score': 0.33303063001463656, 'support': 122617}, '1': {'precision': 0.6963583640683455, 'recall': 0.6990568468245937, 'f1-score': 0.6977049962556249, 'support': 376503}, '2': {'precision': 0.39161569111622424, 'recall': 0.5737849149378788, 'f1-score': 0.4655128132431865, 'support': 121617}, 'accuracy': 0.5866429743997861, 'macro avg': {'precision': 0.5235416084957573, 'recall': 0.5090214198195168, 'f1-score': 0.498749479837816, 'support': 620737}, 'weighted avg': {'precision': 0.5944374641039805, 'recall': 0.5866429743997861, 'f1-score': 0.5801772937233206, 'support': 620737}}
[[ 31172  68049  23396]
 [ 28294 263197  85012]
 [  5119  46716  69782]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.92514604
{'0': {'precision': 0.5343704701823155, 'recall': 0.1760614540171124, 'f1-score': 0.26485871132586203, 'support': 148664}, '1': {'precision': 0.5914343036317111, 'recall': 0.7617291094820037, 'f1-score': 0.6658659568482331, 'support': 323149}, '2': {'precision': 0.44877572142117883, 'recall': 0.4687760199833472, 'f1-score': 0.4585578928354435, 'support': 148924}, 'accuracy': 0.5511802905256171, 'macro avg': {'precision': 0.5248601650784018, 'recall': 0.46885552782748774, 'f1-score': 0.46309418700317956, 'support': 620737}, 'weighted avg': {'precision': 0.5435418396203145, 'recall': 0.5511802905256171, 'f1-score': 0.5200900690352327, 'support': 620737}}
[[ 26174  96255  26235]
 [ 17483 246152  59514]
 [  5324  73788  69812]]
Evaluating performance on  val set...
787/787 - 7s - 7s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7639973
{'0': {'precision': 0.38784382237029214, 'recall': 0.35349009442695795, 'f1-score': 0.3698709752411949, 'support': 27005}, '1': {'precision': 0.8288670388336832, 'recall': 0.642084668578175, 'f1-score': 0.7236169824518718, 'support': 148225}, '2': {'precision': 0.28532353607613375, 'recall': 0.6782471529701447, 'f1-score': 0.401672400829365, 'support': 25992}, 'accuracy': 0.6080249674488873, 'macro avg': {'precision': 0.500678132426703, 'recall': 0.5579406386584259, 'f1-score': 0.49838678617414395, 'support': 201222}, 'weighted avg': {'precision': 0.6994695838622182, 'recall': 0.6080249674488873, 'f1-score': 0.6345566685187207, 'support': 201222}}
[[ 9546 12477  4982]
 [13877 95173 39175]
 [ 1190  7173 17629]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.81782323
{'0': {'precision': 0.4587897435897436, 'recall': 0.3162881466187742, 'f1-score': 0.3744391615884283, 'support': 35357}, '1': {'precision': 0.754251998877823, 'recall': 0.6552898164368954, 'f1-score': 0.7012969016197006, 'support': 131290}, '2': {'precision': 0.35398117324753514, 'recall': 0.6427765726681128, 'f1-score': 0.4565418352883173, 'support': 34575}, 'accuracy': 0.5935732673365736, 'macro avg': {'precision': 0.5223409719050339, 'recall': 0.5381181785745941, 'f1-score': 0.5107592994988154, 'support': 201222}, 'weighted avg': {'precision': 0.6335593173798366, 'recall': 0.5935732673365736, 'f1-score': 0.6018091938507029, 'support': 201222}}
[[11183 17308  6866]
 [11564 86033 33693]
 [ 1628 10723 22224]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.86135083
{'0': {'precision': 0.5105355982548965, 'recall': 0.2663180321518497, 'f1-score': 0.3500397772474145, 'support': 41304}, '1': {'precision': 0.6856127293511002, 'recall': 0.688779359251622, 'f1-score': 0.6871923963085466, 'support': 119298}, '2': {'precision': 0.3975295435171411, 'recall': 0.5854997538158543, 'f1-score': 0.47354326162055616, 'support': 40620}, 'accuracy': 0.5812137837810974, 'macro avg': {'precision': 0.5312259570410459, 'recall': 0.5135323817397753, 'f1-score': 0.5035918117255057, 'support': 201222}, 'weighted avg': {'precision': 0.5915210056261943, 'recall': 0.5812137837810974, 'f1-score': 0.5748578621685063, 'support': 201222}}
[[11000 22610  7694]
 [ 8778 82170 28350]
 [ 1768 15069 23783]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.93671495
{'0': {'precision': 0.5599275023386342, 'recall': 0.1916971916971917, 'f1-score': 0.2856120364433443, 'support': 49959}, '1': {'precision': 0.5750401559038695, 'recall': 0.7416254319824065, 'f1-score': 0.6477945621926172, 'support': 101856}, '2': {'precision': 0.44812813951284236, 'recall': 0.47849495010828424, 'f1-score': 0.46281396213856424, 'support': 49407}, 'accuracy': 0.5404826510023755, 'macro avg': {'precision': 0.527698599251782, 'recall': 0.47060585792929416, 'f1-score': 0.4654068535915086, 'support': 201222}, 'weighted avg': {'precision': 0.540126701841704, 'recall': 0.5404826510023755, 'f1-score': 0.5124534299566862, 'support': 201222}}
[[ 9577 31944  8438]
 [ 5641 75539 20676]
 [ 1886 23880 23641]]
training model: results/AAL/W4/deepOF_L1/seq2seq
Epoch 1/50
2425/2425 - 66s - loss: 12.4276 - accuracy10: 0.4263 - accuracy20: 0.4412 - accuracy30: 0.4473 - accuracy50: 0.4499 - val_loss: 12.8627 - val_accuracy10: 0.3582 - val_accuracy20: 0.3474 - val_accuracy30: 0.3467 - val_accuracy50: 0.3592 - 66s/epoch - 27ms/step
Epoch 2/50
2425/2425 - 57s - loss: 12.4285 - accuracy10: 0.3633 - accuracy20: 0.3877 - accuracy30: 0.4054 - accuracy50: 0.4212 - val_loss: 12.8830 - val_accuracy10: 0.4789 - val_accuracy20: 0.4687 - val_accuracy30: 0.4686 - val_accuracy50: 0.4585 - 57s/epoch - 24ms/step
Epoch 3/50
2425/2425 - 59s - loss: 12.3267 - accuracy10: 0.3853 - accuracy20: 0.4057 - accuracy30: 0.4210 - accuracy50: 0.4338 - val_loss: 12.7841 - val_accuracy10: 0.5538 - val_accuracy20: 0.5256 - val_accuracy30: 0.5112 - val_accuracy50: 0.4833 - 59s/epoch - 24ms/step
Epoch 4/50
2425/2425 - 59s - loss: 12.2380 - accuracy10: 0.4138 - accuracy20: 0.4274 - accuracy30: 0.4381 - accuracy50: 0.4466 - val_loss: 12.7658 - val_accuracy10: 0.5712 - val_accuracy20: 0.5386 - val_accuracy30: 0.5216 - val_accuracy50: 0.4920 - 59s/epoch - 24ms/step
Epoch 5/50
2425/2425 - 61s - loss: 12.1689 - accuracy10: 0.4318 - accuracy20: 0.4391 - accuracy30: 0.4474 - accuracy50: 0.4540 - val_loss: 12.6935 - val_accuracy10: 0.5711 - val_accuracy20: 0.5367 - val_accuracy30: 0.5191 - val_accuracy50: 0.4907 - 61s/epoch - 25ms/step
Epoch 6/50
2425/2425 - 61s - loss: 12.0986 - accuracy10: 0.4454 - accuracy20: 0.4501 - accuracy30: 0.4563 - accuracy50: 0.4604 - val_loss: 12.6201 - val_accuracy10: 0.5816 - val_accuracy20: 0.5458 - val_accuracy30: 0.5274 - val_accuracy50: 0.4974 - 61s/epoch - 25ms/step
Epoch 7/50
2425/2425 - 61s - loss: 12.0118 - accuracy10: 0.4576 - accuracy20: 0.4596 - accuracy30: 0.4649 - accuracy50: 0.4685 - val_loss: 12.6438 - val_accuracy10: 0.6052 - val_accuracy20: 0.5639 - val_accuracy30: 0.5424 - val_accuracy50: 0.5053 - 61s/epoch - 25ms/step
Epoch 8/50
2425/2425 - 58s - loss: 11.9364 - accuracy10: 0.4691 - accuracy20: 0.4677 - accuracy30: 0.4717 - accuracy50: 0.4734 - val_loss: 12.6024 - val_accuracy10: 0.6057 - val_accuracy20: 0.5601 - val_accuracy30: 0.5377 - val_accuracy50: 0.5023 - 58s/epoch - 24ms/step
Epoch 9/50
2425/2425 - 58s - loss: 11.8553 - accuracy10: 0.4754 - accuracy20: 0.4733 - accuracy30: 0.4766 - accuracy50: 0.4777 - val_loss: 12.5909 - val_accuracy10: 0.6171 - val_accuracy20: 0.5742 - val_accuracy30: 0.5520 - val_accuracy50: 0.5125 - 58s/epoch - 24ms/step
Epoch 10/50
2425/2425 - 59s - loss: 11.7731 - accuracy10: 0.4801 - accuracy20: 0.4784 - accuracy30: 0.4810 - accuracy50: 0.4817 - val_loss: 12.6241 - val_accuracy10: 0.6332 - val_accuracy20: 0.5846 - val_accuracy30: 0.5600 - val_accuracy50: 0.5175 - 59s/epoch - 24ms/step
Epoch 11/50
2425/2425 - 61s - loss: 11.7022 - accuracy10: 0.4853 - accuracy20: 0.4838 - accuracy30: 0.4858 - accuracy50: 0.4857 - val_loss: 12.6420 - val_accuracy10: 0.6465 - val_accuracy20: 0.5944 - val_accuracy30: 0.5675 - val_accuracy50: 0.5205 - 61s/epoch - 25ms/step
Epoch 12/50
2425/2425 - 61s - loss: 11.6321 - accuracy10: 0.4914 - accuracy20: 0.4893 - accuracy30: 0.4906 - accuracy50: 0.4886 - val_loss: 12.8266 - val_accuracy10: 0.6573 - val_accuracy20: 0.6003 - val_accuracy30: 0.5694 - val_accuracy50: 0.5206 - 61s/epoch - 25ms/step
Epoch 13/50
2425/2425 - 56s - loss: 11.5683 - accuracy10: 0.4965 - accuracy20: 0.4948 - accuracy30: 0.4946 - accuracy50: 0.4918 - val_loss: 12.8592 - val_accuracy10: 0.6459 - val_accuracy20: 0.5917 - val_accuracy30: 0.5619 - val_accuracy50: 0.5161 - 56s/epoch - 23ms/step
Epoch 14/50
2425/2425 - 57s - loss: 11.5168 - accuracy10: 0.4994 - accuracy20: 0.4973 - accuracy30: 0.4971 - accuracy50: 0.4942 - val_loss: 12.8733 - val_accuracy10: 0.6466 - val_accuracy20: 0.5928 - val_accuracy30: 0.5625 - val_accuracy50: 0.5172 - 57s/epoch - 24ms/step
Epoch 15/50
2425/2425 - 57s - loss: 11.4657 - accuracy10: 0.5042 - accuracy20: 0.5021 - accuracy30: 0.5006 - accuracy50: 0.4959 - val_loss: 12.7377 - val_accuracy10: 0.6434 - val_accuracy20: 0.5913 - val_accuracy30: 0.5620 - val_accuracy50: 0.5183 - 57s/epoch - 24ms/step
Epoch 16/50
2425/2425 - 61s - loss: 11.4245 - accuracy10: 0.5058 - accuracy20: 0.5052 - accuracy30: 0.5034 - accuracy50: 0.4984 - val_loss: 12.7598 - val_accuracy10: 0.6309 - val_accuracy20: 0.5829 - val_accuracy30: 0.5565 - val_accuracy50: 0.5161 - 61s/epoch - 25ms/step
Epoch 17/50
2425/2425 - 58s - loss: 11.3716 - accuracy10: 0.5095 - accuracy20: 0.5084 - accuracy30: 0.5062 - accuracy50: 0.5009 - val_loss: 12.8307 - val_accuracy10: 0.6377 - val_accuracy20: 0.5897 - val_accuracy30: 0.5621 - val_accuracy50: 0.5195 - 58s/epoch - 24ms/step
Epoch 18/50
2425/2425 - 59s - loss: 11.3245 - accuracy10: 0.5113 - accuracy20: 0.5114 - accuracy30: 0.5092 - accuracy50: 0.5042 - val_loss: 12.8563 - val_accuracy10: 0.6378 - val_accuracy20: 0.5896 - val_accuracy30: 0.5611 - val_accuracy50: 0.5198 - 59s/epoch - 25ms/step
Epoch 19/50
2425/2425 - 61s - loss: 11.2944 - accuracy10: 0.5138 - accuracy20: 0.5128 - accuracy30: 0.5110 - accuracy50: 0.5051 - val_loss: 12.8849 - val_accuracy10: 0.6418 - val_accuracy20: 0.5905 - val_accuracy30: 0.5618 - val_accuracy50: 0.5193 - 61s/epoch - 25ms/step
testing model: results/AAL/W4/deepOF_L1/seq2seq
Evaluating performance on  test set...
4457/4457 - 42s - 42s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.90011525
{'0': {'precision': 0.31401051659598467, 'recall': 0.3297105866643444, 'f1-score': 0.32166909278338834, 'support': 172245}, '1': {'precision': 0.7465489038083387, 'recall': 0.7057737361513593, 'f1-score': 0.7255889215844412, 'support': 799898}, '2': {'precision': 0.2844979376033038, 'recall': 0.34361301329289384, 'f1-score': 0.31127364831325915, 'support': 168812}, 'accuracy': 0.5954169971646559, 'macro avg': {'precision': 0.4483524526692091, 'recall': 0.45969911203619923, 'f1-score': 0.4528438875603629, 'support': 1140955}, 'weighted avg': {'precision': 0.6128869081885322, 'recall': 0.5954169971646559, 'f1-score': 0.6033101631555003, 'support': 1140955}}
[[ 56791  96243  19211]
 [108679 564547 126672]
 [ 15387  95419  58006]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.952053
{'0': {'precision': 0.37264393711339205, 'recall': 0.3350255801365438, 'f1-score': 0.3528348986994359, 'support': 229084}, '1': {'precision': 0.6541344557543642, 'recall': 0.681261297449287, 'f1-score': 0.6674223532078895, 'support': 687102}, '2': {'precision': 0.3465800064721674, 'recall': 0.3383028798455303, 'f1-score': 0.342391426705991, 'support': 224769}, 'accuracy': 0.5441800947451916, 'macro avg': {'precision': 0.4577861331133079, 'recall': 0.451529919143787, 'f1-score': 0.45421622620443874, 'support': 1140955}, 'weighted avg': {'precision': 0.5370275760062072, 'recall': 0.5441800947451916, 'f1-score': 0.5402273027917733, 'support': 1140955}}
[[ 76749 122540  29795]
 [105440 468096 113566]
 [ 23769 124960  76040]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.98560655
{'0': {'precision': 0.40429622910702306, 'recall': 0.3197063658099223, 'f1-score': 0.35705970952573673, 'support': 267680}, '1': {'precision': 0.5853999092349284, 'recall': 0.6875833900167434, 'f1-score': 0.6323904710201048, 'support': 611584}, '2': {'precision': 0.38770663164930813, 'recall': 0.3125212559851122, 'f1-score': 0.3460775145249813, 'support': 261691}, 'accuracy': 0.5152508205845103, 'macro avg': {'precision': 0.4591342566637531, 'recall': 0.4399370039372594, 'f1-score': 0.44517589835694094, 'support': 1140955}, 'weighted avg': {'precision': 0.497567887287265, 'recall': 0.5152508205845103, 'f1-score': 0.5021258574858481, 'support': 1140955}}
[[ 85579 147055  35046]
 [ 96956 420515  94113]
 [ 29139 150768  81784]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.029318
{'0': {'precision': 0.446328950961651, 'recall': 0.28429874260722626, 'f1-score': 0.3473472485768501, 'support': 321936}, '1': {'precision': 0.4872178253138552, 'recall': 0.7130890627790633, 'f1-score': 0.578901455734069, 'support': 509517}, '2': {'precision': 0.43123603186706283, 'recall': 0.2649611311073919, 'f1-score': 0.3282426095779789, 'support': 309502}, 'accuracy': 0.4705382771450232, 'macro avg': {'precision': 0.4549276027141897, 'recall': 0.4207829788312271, 'f1-score': 0.41816377129629934, 'support': 1140955}, 'weighted avg': {'precision': 0.46049452975108507, 'recall': 0.4705382771450232, 'f1-score': 0.4455701241404754, 'support': 1140955}}
[[ 91526 190032  40378]
 [ 78405 363331  67781]
 [ 35133 192363  82006]]
Evaluating performance on  train set...
2425/2425 - 20s - 20s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.87115735
{'0': {'precision': 0.2994142276674298, 'recall': 0.3639725701104467, 'f1-score': 0.32855210967957316, 'support': 79767}, '1': {'precision': 0.8026340992684944, 'recall': 0.7130139981088875, 'f1-score': 0.7551744354487325, 'support': 464277}, '2': {'precision': 0.2620743548517484, 'recall': 0.3804537749380623, 'f1-score': 0.3103589492663054, 'support': 76690}, 'accuracy': 0.6270737546195311, 'macro avg': {'precision': 0.45470756059589085, 'recall': 0.4858134477191322, 'f1-score': 0.46469516479820366, 'support': 620734}, 'weighted avg': {'precision': 0.6711834838723305, 'recall': 0.6270737546195311, 'f1-score': 0.6453958786193035, 'support': 620734}}
[[ 29033  42054   8680]
 [ 59767 331036  73474]
 [  8166  39347  29177]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9151091
{'0': {'precision': 0.35126228877945187, 'recall': 0.3657279008815821, 'f1-score': 0.3583491695887865, 'support': 104925}, '1': {'precision': 0.7286057139939235, 'recall': 0.691005903404991, 'f1-score': 0.7093078747085697, 'support': 412982}, '2': {'precision': 0.3219883489959772, 'recall': 0.37519328581014716, 'f1-score': 0.346560668328505, 'support': 102827}, 'accuracy': 0.5837073529080089, 'macro avg': {'precision': 0.46728545058978416, 'recall': 0.47730903003224007, 'f1-score': 0.47140590420862033, 'support': 620734}, 'weighted avg': {'precision': 0.5974641901185239, 'recall': 0.5837073529080089, 'f1-score': 0.5898935214990852, 'support': 620734}}
[[ 38374  53555  12996]
 [ 59367 285373  68242]
 [ 11505  52742  38580]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.94590145
{'0': {'precision': 0.38723182987726706, 'recall': 0.3517517142531394, 'f1-score': 0.3686400355044231, 'support': 122794}, '1': {'precision': 0.6683910598926274, 'recall': 0.6995996078441792, 'f1-score': 0.6836393469862502, 'support': 376381}, '2': {'precision': 0.3647471276337256, 'recall': 0.3457744798821971, 'f1-score': 0.35500749593530273, 'support': 121559}, 'accuracy': 0.5614981618535476, 'macro avg': {'precision': 0.4734566724678733, 'recall': 0.46570860065983855, 'f1-score': 0.469095626141992, 'support': 620734}, 'weighted avg': {'precision': 0.5533090452906143, 'recall': 0.5614981618535476, 'f1-score': 0.5569696549184697, 'support': 620734}}
[[ 43193  64654  14947]
 [ 54808 263316  58257]
 [ 13542  65985  42032]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9896444
{'0': {'precision': 0.4298605338505588, 'recall': 0.31263686805583546, 'f1-score': 0.3619952087611225, 'support': 148866}, '1': {'precision': 0.5724758152779376, 'recall': 0.7237803368003962, 'f1-score': 0.6392976229699819, 'support': 323040}, '2': {'precision': 0.4174347638041232, 'recall': 0.29182680678366973, 'f1-score': 0.34350840145053047, 'support': 148828}, 'accuracy': 0.5216131225291348, 'macro avg': {'precision': 0.4732570376442065, 'recall': 0.44274800387996716, 'f1-score': 0.4482670777272117, 'support': 620734}, 'weighted avg': {'precision': 0.5011006109332214, 'recall': 0.5216131225291348, 'f1-score': 0.5018754430122013, 'support': 620734}}
[[ 46541  85632  16693]
 [ 45310 233810  43920]
 [ 16419  88977  43432]]
Evaluating performance on  val set...
787/787 - 7s - 7s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.87930286
{'0': {'precision': 0.3028699987838988, 'recall': 0.36843078516217315, 'f1-score': 0.33244898299711334, 'support': 27039}, '1': {'precision': 0.7909956906327965, 'recall': 0.7059335528446508, 'f1-score': 0.7460478183672159, 'support': 148208}, '2': {'precision': 0.2651136993899057, 'recall': 0.36804619826756496, 'f1-score': 0.3082131055049569, 'support': 25975}, 'accuracy': 0.6169653417618352, 'macro avg': {'precision': 0.45299312960220034, 'recall': 0.48080351209146294, 'f1-score': 0.46223663562309536, 'support': 201222}, 'weighted avg': {'precision': 0.657520149665922, 'recall': 0.6169653417618352, 'f1-score': 0.6339524432284668, 'support': 201222}}
[[  9962  13982   3095]
 [ 20178 104625  23405]
 [  2752  13663   9560]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9239551
{'0': {'precision': 0.3551369029921345, 'recall': 0.3713260230612706, 'f1-score': 0.363051076940081, 'support': 35384}, '1': {'precision': 0.7151538804638715, 'recall': 0.6839920165762691, 'f1-score': 0.6992259290408995, 'support': 131272}, '2': {'precision': 0.325213973573294, 'recall': 0.3638546548631603, 'f1-score': 0.3434508936495583, 'support': 34566}, 'accuracy': 0.5740177515381022, 'macro avg': {'precision': 0.4651682523431, 'recall': 0.47305756483356665, 'f1-score': 0.4685759665435129, 'support': 201222}, 'weighted avg': {'precision': 0.584862443382242, 'recall': 0.5740177515381022, 'f1-score': 0.578995880437504, 'support': 201222}}
[[13139 17642  4603]
 [19990 89789 21493]
 [ 3868 18121 12577]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9538358
{'0': {'precision': 0.3890369744794278, 'recall': 0.35731426493758334, 'f1-score': 0.3725014530108913, 'support': 41255}, '1': {'precision': 0.6547286797120294, 'recall': 0.6920923605581863, 'f1-score': 0.6728922461385517, 'support': 119315}, '2': {'precision': 0.37025290939876904, 'recall': 0.3388763160484109, 'f1-score': 0.353870458135861, 'support': 40652}, 'accuracy': 0.5520966892288119, 'macro avg': {'precision': 0.4713395211967421, 'recall': 0.46276098051472686, 'f1-score': 0.466421385761768, 'support': 201222}, 'weighted avg': {'precision': 0.5427845567327049, 'recall': 0.5520966892288119, 'f1-score': 0.5468548551158653, 'support': 201222}}
[[14741 21295  5219]
 [18526 82577 18212]
 [ 4624 22252 13776]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9961519
{'0': {'precision': 0.4362478222996516, 'recall': 0.3206610908799872, 'f1-score': 0.36962889498812185, 'support': 49978}, '1': {'precision': 0.5569445081578666, 'recall': 0.7152605946349319, 'f1-score': 0.6262519450820588, 'support': 101844}, '2': {'precision': 0.42009972693814557, 'recall': 0.28651821862348176, 'f1-score': 0.340682616858422, 'support': 49400}, 'accuracy': 0.5119967001620102, 'macro avg': {'precision': 0.47109735246522116, 'recall': 0.440813301379467, 'f1-score': 0.4455211523095342, 'support': 201222}, 'weighted avg': {'precision': 0.49337138415514276, 'recall': 0.5119967001620102, 'f1-score': 0.4924065821901164, 'support': 201222}}
[[16026 28258  5694]
 [15155 72845 13844]
 [ 5555 29691 14154]]
training model: results/AAL/W4/deepLOB_L2/seq2seq
Epoch 1/50
2425/2425 - 123s - loss: 11.0729 - accuracy10: 0.4695 - accuracy20: 0.4935 - accuracy30: 0.5053 - accuracy50: 0.5102 - val_loss: 13.1584 - val_accuracy10: 0.6003 - val_accuracy20: 0.5531 - val_accuracy30: 0.5205 - val_accuracy50: 0.4707 - 123s/epoch - 51ms/step
Epoch 2/50
2425/2425 - 116s - loss: 10.5318 - accuracy10: 0.5287 - accuracy20: 0.5429 - accuracy30: 0.5457 - accuracy50: 0.5402 - val_loss: 11.3310 - val_accuracy10: 0.4872 - val_accuracy20: 0.5015 - val_accuracy30: 0.5040 - val_accuracy50: 0.4983 - 116s/epoch - 48ms/step
Epoch 3/50
2425/2425 - 115s - loss: 9.7582 - accuracy10: 0.6171 - accuracy20: 0.6125 - accuracy30: 0.6005 - accuracy50: 0.5779 - val_loss: 11.1086 - val_accuracy10: 0.6654 - val_accuracy20: 0.6503 - val_accuracy30: 0.6279 - val_accuracy50: 0.5824 - 115s/epoch - 47ms/step
Epoch 4/50
2425/2425 - 117s - loss: 9.4480 - accuracy10: 0.6397 - accuracy20: 0.6314 - accuracy30: 0.6157 - accuracy50: 0.5876 - val_loss: 10.6284 - val_accuracy10: 0.6616 - val_accuracy20: 0.6552 - val_accuracy30: 0.6362 - val_accuracy50: 0.5910 - 117s/epoch - 48ms/step
Epoch 5/50
2425/2425 - 118s - loss: 9.2761 - accuracy10: 0.6497 - accuracy20: 0.6403 - accuracy30: 0.6225 - accuracy50: 0.5920 - val_loss: 10.2933 - val_accuracy10: 0.6550 - val_accuracy20: 0.6506 - val_accuracy30: 0.6332 - val_accuracy50: 0.5903 - 118s/epoch - 49ms/step
Epoch 6/50
2425/2425 - 116s - loss: 9.1845 - accuracy10: 0.6550 - accuracy20: 0.6443 - accuracy30: 0.6262 - accuracy50: 0.5941 - val_loss: 10.3217 - val_accuracy10: 0.5846 - val_accuracy20: 0.5955 - val_accuracy30: 0.5885 - val_accuracy50: 0.5635 - 116s/epoch - 48ms/step
Epoch 7/50
2425/2425 - 115s - loss: 9.1189 - accuracy10: 0.6577 - accuracy20: 0.6461 - accuracy30: 0.6282 - accuracy50: 0.5961 - val_loss: 10.4615 - val_accuracy10: 0.5558 - val_accuracy20: 0.5707 - val_accuracy30: 0.5678 - val_accuracy50: 0.5498 - 115s/epoch - 48ms/step
Epoch 8/50
2425/2425 - 114s - loss: 9.0679 - accuracy10: 0.6599 - accuracy20: 0.6484 - accuracy30: 0.6302 - accuracy50: 0.5980 - val_loss: 10.7007 - val_accuracy10: 0.5404 - val_accuracy20: 0.5565 - val_accuracy30: 0.5549 - val_accuracy50: 0.5393 - 114s/epoch - 47ms/step
Epoch 9/50
2425/2425 - 155s - loss: 9.0196 - accuracy10: 0.6623 - accuracy20: 0.6502 - accuracy30: 0.6321 - accuracy50: 0.5995 - val_loss: 10.4477 - val_accuracy10: 0.5849 - val_accuracy20: 0.5952 - val_accuracy30: 0.5876 - val_accuracy50: 0.5614 - 155s/epoch - 64ms/step
Epoch 10/50
2425/2425 - 158s - loss: 8.9896 - accuracy10: 0.6624 - accuracy20: 0.6506 - accuracy30: 0.6327 - accuracy50: 0.6001 - val_loss: 10.3683 - val_accuracy10: 0.6114 - val_accuracy20: 0.6172 - val_accuracy30: 0.6063 - val_accuracy50: 0.5752 - 158s/epoch - 65ms/step
Epoch 11/50
2425/2425 - 131s - loss: 8.9554 - accuracy10: 0.6639 - accuracy20: 0.6517 - accuracy30: 0.6339 - accuracy50: 0.6010 - val_loss: 10.4846 - val_accuracy10: 0.5538 - val_accuracy20: 0.5688 - val_accuracy30: 0.5650 - val_accuracy50: 0.5473 - 131s/epoch - 54ms/step
Epoch 12/50
2425/2425 - 138s - loss: 8.9254 - accuracy10: 0.6648 - accuracy20: 0.6530 - accuracy30: 0.6347 - accuracy50: 0.6014 - val_loss: 10.3462 - val_accuracy10: 0.5909 - val_accuracy20: 0.5979 - val_accuracy30: 0.5896 - val_accuracy50: 0.5649 - 138s/epoch - 57ms/step
Epoch 13/50
2425/2425 - 159s - loss: 8.9003 - accuracy10: 0.6655 - accuracy20: 0.6536 - accuracy30: 0.6352 - accuracy50: 0.6023 - val_loss: 10.4772 - val_accuracy10: 0.5500 - val_accuracy20: 0.5649 - val_accuracy30: 0.5618 - val_accuracy50: 0.5454 - 159s/epoch - 65ms/step
Epoch 14/50
2425/2425 - 161s - loss: 8.8752 - accuracy10: 0.6661 - accuracy20: 0.6544 - accuracy30: 0.6362 - accuracy50: 0.6031 - val_loss: 10.4991 - val_accuracy10: 0.5427 - val_accuracy20: 0.5578 - val_accuracy30: 0.5541 - val_accuracy50: 0.5384 - 161s/epoch - 66ms/step
Epoch 15/50
2425/2425 - 117s - loss: 8.8472 - accuracy10: 0.6662 - accuracy20: 0.6552 - accuracy30: 0.6366 - accuracy50: 0.6038 - val_loss: 10.4498 - val_accuracy10: 0.5535 - val_accuracy20: 0.5679 - val_accuracy30: 0.5636 - val_accuracy50: 0.5468 - 117s/epoch - 48ms/step
testing model: results/AAL/W4/deepLOB_L2/seq2seq
Evaluating performance on  test set...
4457/4457 - 73s - 73s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2508531
{'0': {'precision': 0.3562989265500937, 'recall': 0.5551710925072281, 'f1-score': 0.43403921177033955, 'support': 172246}, '1': {'precision': 0.911134165744074, 'recall': 0.31071508938617326, 'f1-score': 0.4634010825202623, 'support': 799900}, '2': {'precision': 0.24501742276463429, 'recall': 0.8705431453738752, 'f1-score': 0.38240548111313644, 'support': 168813}, 'accuracy': 0.43045017393263035, 'macro avg': {'precision': 0.5041501716862673, 'recall': 0.5788097757557589, 'f1-score': 0.4266152584679128, 'support': 1140959}, 'weighted avg': {'precision': 0.7288162066037416, 'recall': 0.43045017393263035, 'f1-score': 0.44698456339071224, 'support': 1140959}}
[[ 95626  13697  62923]
 [161451 248541 389908]
 [ 11310  10544 146959]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2193558
{'0': {'precision': 0.436721626973112, 'recall': 0.5150904027308522, 'f1-score': 0.4726797134279093, 'support': 229086}, '1': {'precision': 0.842283936247808, 'recall': 0.315960366874205, 'f1-score': 0.45953749272371275, 'support': 687102}, '2': {'precision': 0.30809310034322107, 'recall': 0.8402596420356718, 'f1-score': 0.4508687769086892, 'support': 224771}, 'accuracy': 0.4592303492062379, 'macro avg': {'precision': 0.5290328878547136, 'recall': 0.5571034705469097, 'f1-score': 0.46102866102010376, 'support': 1140959}, 'weighted avg': {'precision': 0.6556170572805419, 'recall': 0.4592303492062379, 'f1-score': 0.4604684839773713, 'support': 1140959}}
[[118000  22481  88605]
 [134460 217097 335545]
 [ 17735  18170 188866]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1927657
{'0': {'precision': 0.47676217634656515, 'recall': 0.4696841774941909, 'f1-score': 0.47319671051393514, 'support': 267682}, '1': {'precision': 0.7766027543023184, 'recall': 0.3102746311218083, 'f1-score': 0.4433989267801418, 'support': 611584}, '2': {'precision': 0.33983087535905804, 'recall': 0.8218828933139213, 'f1-score': 0.48084337228188273, 'support': 261693}, 'accuracy': 0.4650175860832861, 'macro avg': {'precision': 0.5310652686693139, 'recall': 0.5339472339766401, 'f1-score': 0.46581300319198654, 'support': 1140959}, 'weighted avg': {'precision': 0.6060777232497999, 'recall': 0.4650175860832861, 'f1-score': 0.45897817162777993, 'support': 1140959}}
[[125726  30087 111869]
 [115869 189759 305956]
 [ 22113  24499 215081]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1550568
{'0': {'precision': 0.5128119125435839, 'recall': 0.40842025483167566, 'f1-score': 0.4547013867275305, 'support': 321938}, '1': {'precision': 0.6596504787667998, 'recall': 0.3015130015288989, 'f1-score': 0.413859244322858, 'support': 509517}, '2': {'precision': 0.37146426012058303, 'recall': 0.7821255944995864, 'f1-score': 0.5037001740585181, 'support': 309504}, 'accuracy': 0.46205253650657035, 'macro avg': {'precision': 0.5146422171436557, 'recall': 0.4973529502867204, 'f1-score': 0.4574202683696355, 'support': 1140959}, 'weighted avg': {'precision': 0.5400425859777966, 'recall': 0.46205253650657035, 'f1-score': 0.4497542806549095, 'support': 1140959}}
[[131486  43016 147436]
 [ 93731 153626 262160]
 [ 31185  36248 242071]]
Evaluating performance on  train set...
2425/2425 - 40s - 40s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.717273
{'0': {'precision': 0.4243445957541313, 'recall': 0.5282630004775429, 'f1-score': 0.4706356537072802, 'support': 79574}, '1': {'precision': 0.9165418675715683, 'recall': 0.683836826785622, 'f1-score': 0.7832709652362075, 'support': 464488}, '2': {'precision': 0.33417276252148537, 'recall': 0.7632213889794588, 'f1-score': 0.46482441996235013, 'support': 76675}, 'accuracy': 0.6736991672801846, 'macro avg': {'precision': 0.558353075282395, 'recall': 0.6584404054142079, 'f1-score': 0.5729103463019459, 'support': 620737}, 'weighted avg': {'precision': 0.7815100314842788, 'recall': 0.6736991672801846, 'f1-score': 0.7038580558422518, 'support': 620737}}
[[ 42036  17407  20131]
 [ 50386 317634  96468]
 [  6639  11516  58520]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7416772
{'0': {'precision': 0.4911907897362225, 'recall': 0.46997451341625224, 'f1-score': 0.48034849290477416, 'support': 104761}, '1': {'precision': 0.8576333096260393, 'recall': 0.7092820886454352, 'f1-score': 0.7764349572599749, 'support': 413129}, '2': {'precision': 0.40552691322679135, 'recall': 0.7051445350860988, 'f1-score': 0.5149229092484051, 'support': 102847}, 'accuracy': 0.668208919397426, 'macro avg': {'precision': 0.5847836708630177, 'recall': 0.6281337123825954, 'f1-score': 0.5905687864710514, 'support': 620737}, 'weighted avg': {'precision': 0.7208818812809422, 'recall': 0.668208919397426, 'f1-score': 0.6831361146033246, 'support': 620737}}
[[ 49235  27786  27740]
 [ 41532 293025  78572]
 [  9469  20856  72522]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.77647483
{'0': {'precision': 0.5254972212609165, 'recall': 0.42105091463663274, 'f1-score': 0.4675115342995432, 'support': 122617}, '1': {'precision': 0.8026254530453487, 'recall': 0.7234656828763648, 'f1-score': 0.7609925224166857, 'support': 376503}, '2': {'precision': 0.43969288066360496, 'recall': 0.6620538247120057, 'f1-score': 0.5284342615623913, 'support': 121617}, 'accuracy': 0.6516962900552086, 'macro avg': {'precision': 0.5892718516566233, 'recall': 0.6021901407416678, 'f1-score': 0.5856461060928734, 'support': 620737}, 'weighted avg': {'precision': 0.6767760143103253, 'recall': 0.6516962900552086, 'f1-score': 0.657456248068167, 'support': 620737}}
[[ 51628  37136  33853]
 [ 35365 272387  68751]
 [ 11253  29847  80517]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8436215
{'0': {'precision': 0.5497628337943438, 'recall': 0.35161168810202875, 'f1-score': 0.4289072596360951, 'support': 148664}, '1': {'precision': 0.7042542588294964, 'recall': 0.7390584529118147, 'f1-score': 0.7212367198777535, 'support': 323149}, '2': {'precision': 0.4721261733597088, 'recall': 0.5913687518465794, 'f1-score': 0.5250625258971983, 'support': 148924}, 'accuracy': 0.6108335736390774, 'macro avg': {'precision': 0.5753810886611831, 'recall': 0.5606796309534743, 'f1-score': 0.558402168470349, 'support': 620737}, 'weighted avg': {'precision': 0.6115632218654866, 'recall': 0.6108335736390774, 'f1-score': 0.6041599022533392, 'support': 620737}}
[[ 52272  53815  42577]
 [ 28432 238826  55891]
 [ 14377  46478  88069]]
Evaluating performance on  val set...
787/787 - 13s - 13s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7324101
{'0': {'precision': 0.44873715024848526, 'recall': 0.48816885761895945, 'f1-score': 0.4676232197648227, 'support': 27005}, '1': {'precision': 0.9093111321490227, 'recall': 0.6609613762860516, 'f1-score': 0.7654971148624627, 'support': 148225}, '2': {'precision': 0.32190883279772864, 'recall': 0.7938981224992305, 'f1-score': 0.4580771194530158, 'support': 25992}, 'accuracy': 0.6549432964586377, 'macro avg': {'precision': 0.5599857050650788, 'recall': 0.6476761188014138, 'f1-score': 0.5637324846934337, 'support': 201222}, 'weighted avg': {'precision': 0.7716245921784287, 'recall': 0.6549432964586377, 'f1-score': 0.6858112700850819, 'support': 201222}}
[[13183  6372  7450]
 [14237 97971 36017]
 [ 1958  3399 20635]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7556101
{'0': {'precision': 0.5172379200802542, 'recall': 0.43748055547699183, 'f1-score': 0.474027765008734, 'support': 35357}, '1': {'precision': 0.8477879941214154, 'recall': 0.6854368192550842, 'f1-score': 0.758016829656584, 'support': 131290}, '2': {'precision': 0.3916586106891313, 'recall': 0.7382212581344902, 'f1-score': 0.5117901828681425, 'support': 34575}, 'accuracy': 0.6509377702239317, 'macro avg': {'precision': 0.5855615082969337, 'recall': 0.6203795442888554, 'f1-score': 0.5812782591778202, 'support': 201222}, 'weighted avg': {'precision': 0.7113320777700992, 'recall': 0.6509377702239317, 'f1-score': 0.6658087824675869, 'support': 201222}}
[[15468  9885 10004]
 [11658 89991 29641]
 [ 2779  6272 25524]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7925086
{'0': {'precision': 0.5490676466585, 'recall': 0.3906643424365679, 'f1-score': 0.4565155887512024, 'support': 41304}, '1': {'precision': 0.787784522003035, 'recall': 0.6962731982095257, 'f1-score': 0.7392074326549137, 'support': 119298}, '2': {'precision': 0.4227038587824201, 'recall': 0.6909158050221565, 'f1-score': 0.5245108116695013, 'support': 40620}, 'accuracy': 0.6324606653348044, 'macro avg': {'precision': 0.5865186758146517, 'recall': 0.5926177818894166, 'f1-score': 0.5734112776918724, 'support': 201222}, 'weighted avg': {'precision': 0.6650865150293837, 'recall': 0.6324606653348044, 'f1-score': 0.6378403820092272, 'support': 201222}}
[[16136 13180 11988]
 [ 9893 83064 26341]
 [ 3359  9196 28065]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.86476535
{'0': {'precision': 0.5656229180546303, 'recall': 0.32288476550771633, 'f1-score': 0.41109610336654856, 'support': 49959}, '1': {'precision': 0.68194695799657, 'recall': 0.7066054037071945, 'f1-score': 0.6940572337809494, 'support': 101856}, '2': {'precision': 0.45494610207849445, 'recall': 0.6184548748153096, 'f1-score': 0.5242470254179857, 'support': 49407}, 'accuracy': 0.5896919819900408, 'macro avg': {'precision': 0.5675053260432316, 'recall': 0.5493150146767402, 'f1-score': 0.5431334541884946, 'support': 201222}, 'weighted avg': {'precision': 0.5973296497509322, 'recall': 0.5896919819900408, 'f1-score': 0.5821098916465804, 'support': 201222}}
[[16131 18999 14829]
 [ 8105 71972 21779]
 [ 4283 14568 30556]]
training model: results/AAL/W4/deepOF_L2/seq2seq
Epoch 1/50
2425/2425 - 79s - loss: 10.5156 - accuracy10: 0.5691 - accuracy20: 0.5768 - accuracy30: 0.5705 - accuracy50: 0.5519 - val_loss: 12.2424 - val_accuracy10: 0.7456 - val_accuracy20: 0.7097 - val_accuracy30: 0.6696 - val_accuracy50: 0.5956 - 79s/epoch - 32ms/step
Epoch 2/50
2425/2425 - 70s - loss: 9.6174 - accuracy10: 0.6264 - accuracy20: 0.6217 - accuracy30: 0.6093 - accuracy50: 0.5847 - val_loss: 12.1156 - val_accuracy10: 0.7433 - val_accuracy20: 0.7097 - val_accuracy30: 0.6717 - val_accuracy50: 0.6003 - 70s/epoch - 29ms/step
Epoch 3/50
2425/2425 - 70s - loss: 9.4463 - accuracy10: 0.6360 - accuracy20: 0.6287 - accuracy30: 0.6141 - accuracy50: 0.5881 - val_loss: 11.8709 - val_accuracy10: 0.7392 - val_accuracy20: 0.7078 - val_accuracy30: 0.6715 - val_accuracy50: 0.6034 - 70s/epoch - 29ms/step
Epoch 4/50
2425/2425 - 71s - loss: 9.3478 - accuracy10: 0.6405 - accuracy20: 0.6331 - accuracy30: 0.6178 - accuracy50: 0.5906 - val_loss: 11.7577 - val_accuracy10: 0.7360 - val_accuracy20: 0.7067 - val_accuracy30: 0.6715 - val_accuracy50: 0.6051 - 71s/epoch - 29ms/step
Epoch 5/50
2425/2425 - 70s - loss: 9.2681 - accuracy10: 0.6432 - accuracy20: 0.6359 - accuracy30: 0.6206 - accuracy50: 0.5924 - val_loss: 11.5244 - val_accuracy10: 0.7242 - val_accuracy20: 0.6997 - val_accuracy30: 0.6674 - val_accuracy50: 0.6048 - 70s/epoch - 29ms/step
Epoch 6/50
2425/2425 - 69s - loss: 9.2129 - accuracy10: 0.6449 - accuracy20: 0.6381 - accuracy30: 0.6224 - accuracy50: 0.5935 - val_loss: 11.5409 - val_accuracy10: 0.7275 - val_accuracy20: 0.7024 - val_accuracy30: 0.6702 - val_accuracy50: 0.6066 - 69s/epoch - 29ms/step
Epoch 7/50
2425/2425 - 70s - loss: 9.1724 - accuracy10: 0.6469 - accuracy20: 0.6403 - accuracy30: 0.6245 - accuracy50: 0.5952 - val_loss: 11.5601 - val_accuracy10: 0.7271 - val_accuracy20: 0.7025 - val_accuracy30: 0.6699 - val_accuracy50: 0.6055 - 70s/epoch - 29ms/step
Epoch 8/50
2425/2425 - 71s - loss: 9.1324 - accuracy10: 0.6487 - accuracy20: 0.6417 - accuracy30: 0.6254 - accuracy50: 0.5959 - val_loss: 11.7096 - val_accuracy10: 0.7256 - val_accuracy20: 0.6995 - val_accuracy30: 0.6677 - val_accuracy50: 0.6047 - 71s/epoch - 29ms/step
Epoch 9/50
2425/2425 - 70s - loss: 9.0974 - accuracy10: 0.6498 - accuracy20: 0.6435 - accuracy30: 0.6270 - accuracy50: 0.5974 - val_loss: 11.5743 - val_accuracy10: 0.7225 - val_accuracy20: 0.6985 - val_accuracy30: 0.6670 - val_accuracy50: 0.6052 - 70s/epoch - 29ms/step
Epoch 10/50
2425/2425 - 70s - loss: 9.0661 - accuracy10: 0.6508 - accuracy20: 0.6450 - accuracy30: 0.6283 - accuracy50: 0.5985 - val_loss: 11.5214 - val_accuracy10: 0.7182 - val_accuracy20: 0.6964 - val_accuracy30: 0.6659 - val_accuracy50: 0.6056 - 70s/epoch - 29ms/step
Epoch 11/50
2425/2425 - 70s - loss: 9.0379 - accuracy10: 0.6519 - accuracy20: 0.6459 - accuracy30: 0.6289 - accuracy50: 0.5988 - val_loss: 11.4723 - val_accuracy10: 0.7160 - val_accuracy20: 0.6948 - val_accuracy30: 0.6649 - val_accuracy50: 0.6055 - 70s/epoch - 29ms/step
Epoch 12/50
2425/2425 - 70s - loss: 9.0097 - accuracy10: 0.6530 - accuracy20: 0.6464 - accuracy30: 0.6297 - accuracy50: 0.5997 - val_loss: 11.4566 - val_accuracy10: 0.7199 - val_accuracy20: 0.6971 - val_accuracy30: 0.6668 - val_accuracy50: 0.6068 - 70s/epoch - 29ms/step
Epoch 13/50
2425/2425 - 69s - loss: 8.9846 - accuracy10: 0.6536 - accuracy20: 0.6471 - accuracy30: 0.6303 - accuracy50: 0.6005 - val_loss: 11.2717 - val_accuracy10: 0.7146 - val_accuracy20: 0.6935 - val_accuracy30: 0.6638 - val_accuracy50: 0.6053 - 69s/epoch - 29ms/step
Epoch 14/50
2425/2425 - 70s - loss: 8.9577 - accuracy10: 0.6556 - accuracy20: 0.6489 - accuracy30: 0.6315 - accuracy50: 0.6010 - val_loss: 11.5133 - val_accuracy10: 0.7158 - val_accuracy20: 0.6928 - val_accuracy30: 0.6619 - val_accuracy50: 0.6020 - 70s/epoch - 29ms/step
Epoch 15/50
2425/2425 - 70s - loss: 8.9349 - accuracy10: 0.6552 - accuracy20: 0.6491 - accuracy30: 0.6321 - accuracy50: 0.6019 - val_loss: 11.4094 - val_accuracy10: 0.7128 - val_accuracy20: 0.6906 - val_accuracy30: 0.6602 - val_accuracy50: 0.6022 - 70s/epoch - 29ms/step
Epoch 16/50
2425/2425 - 70s - loss: 8.9099 - accuracy10: 0.6562 - accuracy20: 0.6497 - accuracy30: 0.6329 - accuracy50: 0.6026 - val_loss: 11.3113 - val_accuracy10: 0.7177 - val_accuracy20: 0.6952 - val_accuracy30: 0.6646 - val_accuracy50: 0.6053 - 70s/epoch - 29ms/step
Epoch 17/50
2425/2425 - 74s - loss: 8.8851 - accuracy10: 0.6577 - accuracy20: 0.6510 - accuracy30: 0.6337 - accuracy50: 0.6031 - val_loss: 11.4675 - val_accuracy10: 0.7188 - val_accuracy20: 0.6949 - val_accuracy30: 0.6636 - val_accuracy50: 0.6044 - 74s/epoch - 30ms/step
Epoch 18/50
2425/2425 - 71s - loss: 8.8637 - accuracy10: 0.6578 - accuracy20: 0.6513 - accuracy30: 0.6349 - accuracy50: 0.6044 - val_loss: 11.4271 - val_accuracy10: 0.7129 - val_accuracy20: 0.6912 - val_accuracy30: 0.6614 - val_accuracy50: 0.6040 - 71s/epoch - 29ms/step
Epoch 19/50
2425/2425 - 70s - loss: 8.8443 - accuracy10: 0.6585 - accuracy20: 0.6515 - accuracy30: 0.6347 - accuracy50: 0.6045 - val_loss: 11.6411 - val_accuracy10: 0.7234 - val_accuracy20: 0.6977 - val_accuracy30: 0.6658 - val_accuracy50: 0.6054 - 70s/epoch - 29ms/step
Epoch 20/50
2425/2425 - 71s - loss: 8.8173 - accuracy10: 0.6585 - accuracy20: 0.6520 - accuracy30: 0.6352 - accuracy50: 0.6050 - val_loss: 11.5234 - val_accuracy10: 0.7118 - val_accuracy20: 0.6901 - val_accuracy30: 0.6607 - val_accuracy50: 0.6031 - 71s/epoch - 29ms/step
Epoch 21/50
2425/2425 - 70s - loss: 8.8034 - accuracy10: 0.6597 - accuracy20: 0.6531 - accuracy30: 0.6361 - accuracy50: 0.6055 - val_loss: 11.4311 - val_accuracy10: 0.7076 - val_accuracy20: 0.6871 - val_accuracy30: 0.6590 - val_accuracy50: 0.6024 - 70s/epoch - 29ms/step
Epoch 22/50
2425/2425 - 69s - loss: 8.7813 - accuracy10: 0.6602 - accuracy20: 0.6535 - accuracy30: 0.6371 - accuracy50: 0.6069 - val_loss: 11.5546 - val_accuracy10: 0.7082 - val_accuracy20: 0.6878 - val_accuracy30: 0.6592 - val_accuracy50: 0.6019 - 69s/epoch - 29ms/step
Epoch 23/50
2425/2425 - 69s - loss: 8.7554 - accuracy10: 0.6615 - accuracy20: 0.6552 - accuracy30: 0.6384 - accuracy50: 0.6077 - val_loss: 11.5690 - val_accuracy10: 0.7157 - val_accuracy20: 0.6933 - val_accuracy30: 0.6631 - val_accuracy50: 0.6043 - 69s/epoch - 29ms/step
testing model: results/AAL/W4/deepOF_L2/seq2seq
Evaluating performance on  test set...
4457/4457 - 44s - 44s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.87349194
{'0': {'precision': 0.42116307718448664, 'recall': 0.5756103225057331, 'f1-score': 0.4864211158945677, 'support': 172245}, '1': {'precision': 0.8707251105341417, 'recall': 0.6632658163915899, 'f1-score': 0.7529669063277916, 'support': 799898}, '2': {'precision': 0.36587325431842044, 'recall': 0.642033741677132, 'f1-score': 0.4661203372591352, 'support': 168812}, 'accuracy': 0.6468914199070077, 'macro avg': {'precision': 0.5525871473456829, 'recall': 0.626969960191485, 'f1-score': 0.5685027864938316, 'support': 1140955}, 'weighted avg': {'precision': 0.7281604484871727, 'recall': 0.6468914199070077, 'f1-score': 0.6702867632101501, 'support': 1140955}}
[[ 99146  37795  35304]
 [116809 530545 152544]
 [ 19455  40974 108383]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.88274014
{'0': {'precision': 0.5099558196885593, 'recall': 0.5109130275357511, 'f1-score': 0.5104339748537935, 'support': 229084}, '1': {'precision': 0.7975088752010195, 'recall': 0.688548425124654, 'f1-score': 0.7390340600221195, 'support': 687102}, '2': {'precision': 0.4286001602690005, 'recall': 0.6067874128549755, 'f1-score': 0.5023610272125882, 'support': 224769}, 'accuracy': 0.63677533294477, 'macro avg': {'precision': 0.5786882850528597, 'recall': 0.6020829551717936, 'f1-score': 0.5839430206961671, 'support': 1140955}, 'weighted avg': {'precision': 0.6670979062183942, 'recall': 0.63677533294477, 'f1-score': 0.6465103559126091, 'support': 1140955}}
[[117042  57913  54129]
 [ 86300 473103 127699]
 [ 26172  62210 136387]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.90974414
{'0': {'precision': 0.5437949107750506, 'recall': 0.45969441123729826, 'f1-score': 0.49822051088950164, 'support': 267680}, '1': {'precision': 0.7336285034907555, 'recall': 0.6946633659480954, 'f1-score': 0.7136144320286222, 'support': 611584}, '2': {'precision': 0.45061566519256674, 'recall': 0.5778341631924675, 'f1-score': 0.5063564962169095, 'support': 261691}, 'accuracy': 0.6127410809365839, 'macro avg': {'precision': 0.5760130264861243, 'recall': 0.577397313459287, 'f1-score': 0.5727304797116778, 'support': 1140955}, 'weighted avg': {'precision': 0.6241793413719768, 'recall': 0.6127410809365839, 'f1-score': 0.6155437970859446, 'support': 1140955}}
[[123051  74959  69670]
 [ 72051 424845 114688]
 [ 31180  79297 151214]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.96959347
{'0': {'precision': 0.5658351449606314, 'recall': 0.384837358978182, 'f1-score': 0.45810623932319205, 'support': 321936}, '1': {'precision': 0.6251426320962215, 'recall': 0.6978432515499974, 'f1-score': 0.6594954223732434, 'support': 509517}, '2': {'precision': 0.46191694882625384, 'recall': 0.52717591485677, 'f1-score': 0.4923935841141943, 'support': 309502}, 'accuracy': 0.5632281728902542, 'macro avg': {'precision': 0.5509649086277022, 'recall': 0.5366188417949832, 'f1-score': 0.5366650819368766, 'support': 1140955}, 'weighted avg': {'precision': 0.564130681053538, 'recall': 0.5632281728902542, 'f1-score': 0.5573417167676292, 'support': 1140955}}
[[123893 104797  93246]
 [ 57134 355563  96820]
 [ 37929 108411 163162]]
Evaluating performance on  train set...
2425/2425 - 24s - 24s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6678543
{'0': {'precision': 0.42471818181818183, 'recall': 0.5856933318289518, 'f1-score': 0.4923827641265341, 'support': 79767}, '1': {'precision': 0.8939094265737045, 'recall': 0.7748843901377841, 'f1-score': 0.8301522379966195, 'support': 464277}, '2': {'precision': 0.4103310059477631, 'recall': 0.579332377102621, 'f1-score': 0.4804018035747111, 'support': 76690}, 'accuracy': 0.726412601855223, 'macro avg': {'precision': 0.5763195381132166, 'recall': 0.6466366996897857, 'f1-score': 0.6009789352326216, 'support': 620734}, 'weighted avg': {'precision': 0.7738715245122463, 'recall': 0.726412601855223, 'f1-score': 0.7435366853798605, 'support': 620734}}
[[ 46719  20467  12581]
 [ 53250 359761  51266]
 [ 10031  22230  44429]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.70827514
{'0': {'precision': 0.49965260001462736, 'recall': 0.5208863473909936, 'f1-score': 0.510048574721547, 'support': 104925}, '1': {'precision': 0.8308473660695128, 'recall': 0.796998416395872, 'f1-score': 0.8135709686469198, 'support': 412982}, '2': {'precision': 0.4777634057625029, 'recall': 0.5352193490036663, 'f1-score': 0.5048619392716265, 'support': 102827}, 'accuracy': 0.7069614359774073, 'macro avg': {'precision': 0.6027544572822143, 'recall': 0.6177013709301773, 'f1-score': 0.6094938275466978, 'support': 620734}, 'weighted avg': {'precision': 0.7163745400042454, 'recall': 0.7069614359774073, 'f1-score': 0.711126587404402, 'support': 620734}}
[[ 54654  32167  18104]
 [ 41782 329146  42054]
 [ 12948  34844  55035]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.75572306
{'0': {'precision': 0.5317248770300349, 'recall': 0.4727429678974543, 'f1-score': 0.5005022266098195, 'support': 122794}, '1': {'precision': 0.7743710209011443, 'recall': 0.8040203942281889, 'f1-score': 0.7889172324886302, 'support': 376381}, '2': {'precision': 0.5031589232336112, 'recall': 0.4998889428178909, 'f1-score': 0.5015186028853456, 'support': 121559}, 'accuracy': 0.6789284943309051, 'macro avg': {'precision': 0.6030849403882635, 'recall': 0.5922174349811781, 'f1-score': 0.5969793539945983, 'support': 620734}, 'weighted avg': {'precision': 0.6732588505175715, 'recall': 0.6789284943309051, 'f1-score': 0.6755812105406971, 'support': 620734}}
[[ 58050  42424  22320]
 [ 36080 302618  37683]
 [ 15043  45750  60766]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8498263
{'0': {'precision': 0.5524146490561843, 'recall': 0.4006421882767052, 'f1-score': 0.46444368303015193, 'support': 148866}, '1': {'precision': 0.6755197317513542, 'recall': 0.8107324170381377, 'f1-score': 0.7369755466133889, 'support': 323040}, '2': {'precision': 0.5214203473310519, 'recall': 0.43817695594914935, 'f1-score': 0.4761880421765926, 'support': 148828}, 'accuracy': 0.6230591525516566, 'macro avg': {'precision': 0.5831182427128635, 'recall': 0.5498505204213308, 'f1-score': 0.5592024239400445, 'support': 620734}, 'weighted avg': {'precision': 0.6090492880105507, 'recall': 0.6230591525516566, 'f1-score': 0.6090895098979816, 'support': 620734}}
[[ 59642  60390  28834]
 [ 30120 261899  31021]
 [ 18204  65411  65213]]
Evaluating performance on  val set...
787/787 - 8s - 8s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6915482
{'0': {'precision': 0.4369648155998304, 'recall': 0.5718406745811605, 'f1-score': 0.4953863898500577, 'support': 27039}, '1': {'precision': 0.8849293049096414, 'recall': 0.7652016085501457, 'f1-score': 0.8207219464184915, 'support': 148208}, '2': {'precision': 0.39821130012473127, 'recall': 0.5776708373435996, 'f1-score': 0.4714402412969712, 'support': 25975}, 'accuracy': 0.7150112810726461, 'macro avg': {'precision': 0.5733684735447344, 'recall': 0.6382377068249686, 'f1-score': 0.5958495258551735, 'support': 201222}, 'weighted avg': {'precision': 0.7619059178011939, 'recall': 0.7150112810726461, 'f1-score': 0.7319178375010502, 'support': 201222}}
[[ 15462   7008   4569]
 [ 16692 113409  18107]
 [  3231   7739  15005]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.73739606
{'0': {'precision': 0.5097329495254652, 'recall': 0.5054544426859597, 'f1-score': 0.5075846802230705, 'support': 35384}, '1': {'precision': 0.8185788105503424, 'recall': 0.7868014504235481, 'f1-score': 0.8023756253690065, 'support': 131272}, '2': {'precision': 0.4626241897945394, 'recall': 0.5348029855927791, 'f1-score': 0.4961019792016102, 'support': 34566}, 'accuracy': 0.6940394191489996, 'macro avg': {'precision': 0.5969786499567823, 'recall': 0.6090196262340957, 'f1-score': 0.6020207615978957, 'support': 201222}, 'weighted avg': {'precision': 0.7031235950791248, 'recall': 0.6940394191489996, 'f1-score': 0.6979261235428345, 'support': 201222}}
[[ 17885  10987   6512]
 [ 13026 103285  14961]
 [  4176  11904  18486]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7891353
{'0': {'precision': 0.5397711015736767, 'recall': 0.457277905708399, 'f1-score': 0.49511186929991474, 'support': 41255}, '1': {'precision': 0.7594300555631498, 'recall': 0.7915601558898714, 'f1-score': 0.7751623043524651, 'support': 119315}, '2': {'precision': 0.48519411105013244, 'recall': 0.5001967922857424, 'f1-score': 0.492581242959751, 'support': 40652}, 'accuracy': 0.6641619703610937, 'macro avg': {'precision': 0.5947984227289863, 'recall': 0.5830116179613376, 'f1-score': 0.5876184722040436, 'support': 201222}, 'weighted avg': {'precision': 0.6589923809392075, 'recall': 0.6641619703610937, 'f1-score': 0.6606571011150976, 'support': 201222}}
[[18865 14483  7907]
 [11202 94445 13668]
 [ 4883 15435 20334]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.89083606
{'0': {'precision': 0.557938288511407, 'recall': 0.38314858537756613, 'f1-score': 0.45431143904435406, 'support': 49978}, '1': {'precision': 0.6550194255866203, 'recall': 0.792957857114803, 'f1-score': 0.7174184378261932, 'support': 101844}, '2': {'precision': 0.501375831231369, 'recall': 0.44261133603238867, 'f1-score': 0.47016449844102787, 'support': 49400}, 'accuracy': 0.6051624573853753, 'macro avg': {'precision': 0.5714445151097988, 'recall': 0.539572592841586, 'f1-score': 0.5472981251038583, 'support': 201222}, 'weighted avg': {'precision': 0.5931876446188612, 'recall': 0.6051624573853753, 'f1-score': 0.5913690685189309, 'support': 201222}}
[[19149 20759 10070]
 [ 9411 80758 11675]
 [ 5761 21774 21865]]
training model: results/AAL/W4/deepVOL_L2/seq2seq
Epoch 1/50
2425/2425 - 76s - loss: 10.7959 - accuracy10: 0.5294 - accuracy20: 0.5428 - accuracy30: 0.5430 - accuracy50: 0.5327 - val_loss: 11.6101 - val_accuracy10: 0.7125 - val_accuracy20: 0.6816 - val_accuracy30: 0.6483 - val_accuracy50: 0.5845 - 76s/epoch - 31ms/step
Epoch 2/50
2425/2425 - 68s - loss: 9.9380 - accuracy10: 0.6120 - accuracy20: 0.6089 - accuracy30: 0.5949 - accuracy50: 0.5698 - val_loss: 11.7807 - val_accuracy10: 0.7465 - val_accuracy20: 0.7118 - val_accuracy30: 0.6728 - val_accuracy50: 0.6025 - 68s/epoch - 28ms/step
Epoch 3/50
2425/2425 - 68s - loss: 9.6177 - accuracy10: 0.6351 - accuracy20: 0.6284 - accuracy30: 0.6111 - accuracy50: 0.5811 - val_loss: 11.2628 - val_accuracy10: 0.7425 - val_accuracy20: 0.7109 - val_accuracy30: 0.6737 - val_accuracy50: 0.6057 - 68s/epoch - 28ms/step
Epoch 4/50
2425/2425 - 68s - loss: 9.4892 - accuracy10: 0.6429 - accuracy20: 0.6345 - accuracy30: 0.6163 - accuracy50: 0.5858 - val_loss: 11.2998 - val_accuracy10: 0.7487 - val_accuracy20: 0.7154 - val_accuracy30: 0.6779 - val_accuracy50: 0.6078 - 68s/epoch - 28ms/step
Epoch 5/50
2425/2425 - 68s - loss: 9.3939 - accuracy10: 0.6481 - accuracy20: 0.6383 - accuracy30: 0.6200 - accuracy50: 0.5892 - val_loss: 11.1363 - val_accuracy10: 0.7445 - val_accuracy20: 0.7144 - val_accuracy30: 0.6783 - val_accuracy50: 0.6095 - 68s/epoch - 28ms/step
Epoch 6/50
2425/2425 - 69s - loss: 9.3187 - accuracy10: 0.6511 - accuracy20: 0.6406 - accuracy30: 0.6225 - accuracy50: 0.5917 - val_loss: 10.7827 - val_accuracy10: 0.7252 - val_accuracy20: 0.7029 - val_accuracy30: 0.6726 - val_accuracy50: 0.6100 - 69s/epoch - 28ms/step
Epoch 7/50
2425/2425 - 69s - loss: 9.2634 - accuracy10: 0.6549 - accuracy20: 0.6431 - accuracy30: 0.6243 - accuracy50: 0.5934 - val_loss: 10.7114 - val_accuracy10: 0.7284 - val_accuracy20: 0.7051 - val_accuracy30: 0.6736 - val_accuracy50: 0.6103 - 69s/epoch - 29ms/step
Epoch 8/50
2425/2425 - 68s - loss: 9.2222 - accuracy10: 0.6566 - accuracy20: 0.6438 - accuracy30: 0.6256 - accuracy50: 0.5947 - val_loss: 10.7117 - val_accuracy10: 0.7307 - val_accuracy20: 0.7074 - val_accuracy30: 0.6743 - val_accuracy50: 0.6104 - 68s/epoch - 28ms/step
Epoch 9/50
2425/2425 - 68s - loss: 9.1862 - accuracy10: 0.6588 - accuracy20: 0.6457 - accuracy30: 0.6265 - accuracy50: 0.5961 - val_loss: 10.6933 - val_accuracy10: 0.7290 - val_accuracy20: 0.7063 - val_accuracy30: 0.6751 - val_accuracy50: 0.6126 - 68s/epoch - 28ms/step
Epoch 10/50
2425/2425 - 69s - loss: 9.1526 - accuracy10: 0.6603 - accuracy20: 0.6463 - accuracy30: 0.6275 - accuracy50: 0.5968 - val_loss: 10.5582 - val_accuracy10: 0.7200 - val_accuracy20: 0.7003 - val_accuracy30: 0.6697 - val_accuracy50: 0.6097 - 69s/epoch - 29ms/step
Epoch 11/50
2425/2425 - 69s - loss: 9.1251 - accuracy10: 0.6611 - accuracy20: 0.6473 - accuracy30: 0.6286 - accuracy50: 0.5975 - val_loss: 10.5428 - val_accuracy10: 0.7154 - val_accuracy20: 0.6969 - val_accuracy30: 0.6682 - val_accuracy50: 0.6105 - 69s/epoch - 29ms/step
Epoch 12/50
2425/2425 - 69s - loss: 9.0967 - accuracy10: 0.6617 - accuracy20: 0.6481 - accuracy30: 0.6296 - accuracy50: 0.5983 - val_loss: 10.5333 - val_accuracy10: 0.7116 - val_accuracy20: 0.6937 - val_accuracy30: 0.6655 - val_accuracy50: 0.6077 - 69s/epoch - 29ms/step
Epoch 13/50
2425/2425 - 70s - loss: 9.0686 - accuracy10: 0.6631 - accuracy20: 0.6492 - accuracy30: 0.6306 - accuracy50: 0.5990 - val_loss: 10.5549 - val_accuracy10: 0.7219 - val_accuracy20: 0.7031 - val_accuracy30: 0.6735 - val_accuracy50: 0.6129 - 70s/epoch - 29ms/step
Epoch 14/50
2425/2425 - 71s - loss: 9.0508 - accuracy10: 0.6632 - accuracy20: 0.6491 - accuracy30: 0.6307 - accuracy50: 0.5996 - val_loss: 10.5252 - val_accuracy10: 0.7177 - val_accuracy20: 0.6990 - val_accuracy30: 0.6699 - val_accuracy50: 0.6103 - 71s/epoch - 29ms/step
Epoch 15/50
2425/2425 - 69s - loss: 9.0261 - accuracy10: 0.6640 - accuracy20: 0.6493 - accuracy30: 0.6314 - accuracy50: 0.6001 - val_loss: 10.5766 - val_accuracy10: 0.7235 - val_accuracy20: 0.7021 - val_accuracy30: 0.6713 - val_accuracy50: 0.6108 - 69s/epoch - 29ms/step
Epoch 16/50
2425/2425 - 71s - loss: 9.0052 - accuracy10: 0.6645 - accuracy20: 0.6502 - accuracy30: 0.6323 - accuracy50: 0.6011 - val_loss: 10.4659 - val_accuracy10: 0.7057 - val_accuracy20: 0.6894 - val_accuracy30: 0.6629 - val_accuracy50: 0.6075 - 71s/epoch - 29ms/step
Epoch 17/50
2425/2425 - 68s - loss: 8.9852 - accuracy10: 0.6647 - accuracy20: 0.6510 - accuracy30: 0.6329 - accuracy50: 0.6018 - val_loss: 10.3933 - val_accuracy10: 0.7103 - val_accuracy20: 0.6937 - val_accuracy30: 0.6667 - val_accuracy50: 0.6107 - 68s/epoch - 28ms/step
Epoch 18/50
2425/2425 - 68s - loss: 8.9718 - accuracy10: 0.6645 - accuracy20: 0.6506 - accuracy30: 0.6329 - accuracy50: 0.6020 - val_loss: 10.5016 - val_accuracy10: 0.7177 - val_accuracy20: 0.6984 - val_accuracy30: 0.6701 - val_accuracy50: 0.6117 - 68s/epoch - 28ms/step
Epoch 19/50
2425/2425 - 68s - loss: 8.9523 - accuracy10: 0.6657 - accuracy20: 0.6520 - accuracy30: 0.6338 - accuracy50: 0.6028 - val_loss: 10.4996 - val_accuracy10: 0.7227 - val_accuracy20: 0.7005 - val_accuracy30: 0.6710 - val_accuracy50: 0.6125 - 68s/epoch - 28ms/step
Epoch 20/50
2425/2425 - 69s - loss: 8.9333 - accuracy10: 0.6655 - accuracy20: 0.6515 - accuracy30: 0.6345 - accuracy50: 0.6036 - val_loss: 10.4744 - val_accuracy10: 0.7185 - val_accuracy20: 0.6990 - val_accuracy30: 0.6707 - val_accuracy50: 0.6124 - 69s/epoch - 28ms/step
Epoch 21/50
2425/2425 - 69s - loss: 8.9179 - accuracy10: 0.6662 - accuracy20: 0.6520 - accuracy30: 0.6342 - accuracy50: 0.6036 - val_loss: 10.5205 - val_accuracy10: 0.7261 - val_accuracy20: 0.7043 - val_accuracy30: 0.6733 - val_accuracy50: 0.6135 - 69s/epoch - 28ms/step
Epoch 22/50
2425/2425 - 69s - loss: 8.8987 - accuracy10: 0.6660 - accuracy20: 0.6520 - accuracy30: 0.6346 - accuracy50: 0.6041 - val_loss: 10.4816 - val_accuracy10: 0.7156 - val_accuracy20: 0.6966 - val_accuracy30: 0.6689 - val_accuracy50: 0.6116 - 69s/epoch - 28ms/step
Epoch 23/50
2425/2425 - 70s - loss: 8.8820 - accuracy10: 0.6670 - accuracy20: 0.6537 - accuracy30: 0.6357 - accuracy50: 0.6052 - val_loss: 10.4166 - val_accuracy10: 0.7141 - val_accuracy20: 0.6954 - val_accuracy30: 0.6684 - val_accuracy50: 0.6124 - 70s/epoch - 29ms/step
Epoch 24/50
2425/2425 - 70s - loss: 8.8670 - accuracy10: 0.6675 - accuracy20: 0.6540 - accuracy30: 0.6364 - accuracy50: 0.6056 - val_loss: 10.4164 - val_accuracy10: 0.7079 - val_accuracy20: 0.6882 - val_accuracy30: 0.6617 - val_accuracy50: 0.6076 - 70s/epoch - 29ms/step
Epoch 25/50
2425/2425 - 70s - loss: 8.8495 - accuracy10: 0.6677 - accuracy20: 0.6542 - accuracy30: 0.6364 - accuracy50: 0.6060 - val_loss: 10.3868 - val_accuracy10: 0.7043 - val_accuracy20: 0.6857 - val_accuracy30: 0.6606 - val_accuracy50: 0.6068 - 70s/epoch - 29ms/step
Epoch 26/50
2425/2425 - 71s - loss: 8.8318 - accuracy10: 0.6682 - accuracy20: 0.6551 - accuracy30: 0.6375 - accuracy50: 0.6066 - val_loss: 10.4053 - val_accuracy10: 0.7058 - val_accuracy20: 0.6877 - val_accuracy30: 0.6619 - val_accuracy50: 0.6076 - 71s/epoch - 29ms/step
Epoch 27/50
2425/2425 - 70s - loss: 8.8176 - accuracy10: 0.6687 - accuracy20: 0.6552 - accuracy30: 0.6377 - accuracy50: 0.6070 - val_loss: 10.3987 - val_accuracy10: 0.6888 - val_accuracy20: 0.6718 - val_accuracy30: 0.6481 - val_accuracy50: 0.5989 - 70s/epoch - 29ms/step
Epoch 28/50
2425/2425 - 69s - loss: 8.7997 - accuracy10: 0.6692 - accuracy20: 0.6559 - accuracy30: 0.6382 - accuracy50: 0.6072 - val_loss: 10.3841 - val_accuracy10: 0.7041 - val_accuracy20: 0.6870 - val_accuracy30: 0.6617 - val_accuracy50: 0.6087 - 69s/epoch - 29ms/step
Epoch 29/50
2425/2425 - 70s - loss: 8.7921 - accuracy10: 0.6691 - accuracy20: 0.6556 - accuracy30: 0.6384 - accuracy50: 0.6078 - val_loss: 10.3919 - val_accuracy10: 0.7076 - val_accuracy20: 0.6877 - val_accuracy30: 0.6609 - val_accuracy50: 0.6074 - 70s/epoch - 29ms/step
Epoch 30/50
2425/2425 - 70s - loss: 8.7735 - accuracy10: 0.6697 - accuracy20: 0.6562 - accuracy30: 0.6394 - accuracy50: 0.6088 - val_loss: 10.4867 - val_accuracy10: 0.7143 - val_accuracy20: 0.6940 - val_accuracy30: 0.6661 - val_accuracy50: 0.6097 - 70s/epoch - 29ms/step
Epoch 31/50
2425/2425 - 70s - loss: 8.7608 - accuracy10: 0.6700 - accuracy20: 0.6568 - accuracy30: 0.6395 - accuracy50: 0.6085 - val_loss: 10.4407 - val_accuracy10: 0.6847 - val_accuracy20: 0.6702 - val_accuracy30: 0.6475 - val_accuracy50: 0.5981 - 70s/epoch - 29ms/step
Epoch 32/50
2425/2425 - 71s - loss: 8.7537 - accuracy10: 0.6695 - accuracy20: 0.6566 - accuracy30: 0.6394 - accuracy50: 0.6085 - val_loss: 10.3892 - val_accuracy10: 0.7034 - val_accuracy20: 0.6856 - val_accuracy30: 0.6603 - val_accuracy50: 0.6073 - 71s/epoch - 29ms/step
Epoch 33/50
2425/2425 - 69s - loss: 8.7361 - accuracy10: 0.6704 - accuracy20: 0.6577 - accuracy30: 0.6408 - accuracy50: 0.6099 - val_loss: 10.5088 - val_accuracy10: 0.7016 - val_accuracy20: 0.6841 - val_accuracy30: 0.6583 - val_accuracy50: 0.6048 - 69s/epoch - 28ms/step
Epoch 34/50
2425/2425 - 71s - loss: 8.7128 - accuracy10: 0.6709 - accuracy20: 0.6581 - accuracy30: 0.6413 - accuracy50: 0.6102 - val_loss: 10.5793 - val_accuracy10: 0.7127 - val_accuracy20: 0.6910 - val_accuracy30: 0.6630 - val_accuracy50: 0.6073 - 71s/epoch - 29ms/step
Epoch 35/50
2425/2425 - 69s - loss: 8.7032 - accuracy10: 0.6711 - accuracy20: 0.6581 - accuracy30: 0.6413 - accuracy50: 0.6105 - val_loss: 10.4963 - val_accuracy10: 0.6987 - val_accuracy20: 0.6811 - val_accuracy30: 0.6556 - val_accuracy50: 0.6028 - 69s/epoch - 28ms/step
Epoch 36/50
2425/2425 - 68s - loss: 8.6888 - accuracy10: 0.6711 - accuracy20: 0.6583 - accuracy30: 0.6416 - accuracy50: 0.6111 - val_loss: 10.6594 - val_accuracy10: 0.7117 - val_accuracy20: 0.6914 - val_accuracy30: 0.6638 - val_accuracy50: 0.6070 - 68s/epoch - 28ms/step
Epoch 37/50
2425/2425 - 70s - loss: 8.6778 - accuracy10: 0.6718 - accuracy20: 0.6593 - accuracy30: 0.6429 - accuracy50: 0.6117 - val_loss: 10.5167 - val_accuracy10: 0.7011 - val_accuracy20: 0.6842 - val_accuracy30: 0.6584 - val_accuracy50: 0.6047 - 70s/epoch - 29ms/step
Epoch 38/50
2425/2425 - 71s - loss: 8.6656 - accuracy10: 0.6717 - accuracy20: 0.6597 - accuracy30: 0.6432 - accuracy50: 0.6119 - val_loss: 10.5621 - val_accuracy10: 0.7061 - val_accuracy20: 0.6877 - val_accuracy30: 0.6610 - val_accuracy50: 0.6063 - 71s/epoch - 29ms/step
testing model: results/AAL/W4/deepVOL_L2/seq2seq
Evaluating performance on  test set...
4457/4457 - 44s - 44s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.76224256
{'0': {'precision': 0.4477712210621879, 'recall': 0.5726925443841947, 'f1-score': 0.5025856842255431, 'support': 172246}, '1': {'precision': 0.868049786147266, 'recall': 0.7053569196149518, 'f1-score': 0.7782919965790271, 'support': 799900}, '2': {'precision': 0.3963218424776211, 'recall': 0.635472386605297, 'f1-score': 0.48818180990780263, 'support': 168813}, 'accuracy': 0.6749891976837029, 'macro avg': {'precision': 0.5707142832290251, 'recall': 0.6378406168681479, 'f1-score': 0.5896864969041243, 'support': 1140959}, 'weighted avg': {'precision': 0.7348065135350617, 'recall': 0.6749891976837029, 'f1-score': 0.6937458556395476, 'support': 1140959}}
[[ 98644  43108  30494]
 [102776 564215 132909]
 [ 18880  42657 107276]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.801835
{'0': {'precision': 0.5276702089337176, 'recall': 0.5115327868136856, 'f1-score': 0.5194762016641326, 'support': 229086}, '1': {'precision': 0.7892911679849918, 'recall': 0.727433481491831, 'f1-score': 0.7571009311889606, 'support': 687102}, '2': {'precision': 0.46133405222213664, 'recall': 0.5862366586436862, 'f1-score': 0.5163392418058883, 'support': 224771}, 'accuracy': 0.6562681042877089, 'macro avg': {'precision': 0.5927651430469486, 'recall': 0.6084009756497343, 'f1-score': 0.5976387915529938, 'support': 1140959}, 'weighted avg': {'precision': 0.6721537880332557, 'recall': 0.6562681042877089, 'f1-score': 0.6619592613548585, 'support': 1140959}}
[[117185  68177  43724]
 [ 77148 499821 110133]
 [ 27747  65255 131769]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8501138
{'0': {'precision': 0.5563973563097806, 'recall': 0.45570490357962057, 'f1-score': 0.5010422635294021, 'support': 267682}, '1': {'precision': 0.7196287811252872, 'recall': 0.7365186139598158, 'f1-score': 0.7279757450776632, 'support': 611584}, '2': {'precision': 0.4851241792942099, 'recall': 0.5483180673537312, 'f1-score': 0.5147890039912103, 'support': 261693}, 'accuracy': 0.6274703999004346, 'macro avg': {'precision': 0.5870501055764259, 'recall': 0.5801805282977225, 'f1-score': 0.5812690041994252, 'support': 1140959}, 'weighted avg': {'precision': 0.6275463075005167, 'recall': 0.6274703999004346, 'f1-score': 0.6258375560253494, 'support': 1140959}}
[[121984  90535  55163]
 [ 64013 450443  97128]
 [ 33242  84960 143491]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9402245
{'0': {'precision': 0.5725496446586286, 'recall': 0.3793711832713131, 'f1-score': 0.4563590370179392, 'support': 321938}, '1': {'precision': 0.6076503485518548, 'recall': 0.7440242425669801, 'f1-score': 0.6689577407127683, 'support': 509517}, '2': {'precision': 0.49699449594438005, 'recall': 0.4877966035980149, 'f1-score': 0.4923525958779024, 'support': 309504}, 'accuracy': 0.5716261495811856, 'macro avg': {'precision': 0.5590648297182877, 'recall': 0.5370640098121027, 'f1-score': 0.5392231245362032, 'support': 1140959}, 'weighted avg': {'precision': 0.5677289496099109, 'recall': 0.5716261495811856, 'f1-score': 0.5610628906637515, 'support': 1140959}}
[[122134 127657  72147]
 [ 49770 379093  80654]
 [ 41412 117117 150975]]
Evaluating performance on  train set...
2425/2425 - 24s - 24s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6658018
{'0': {'precision': 0.42355230129157223, 'recall': 0.6128132304521577, 'f1-score': 0.5009013636013456, 'support': 79574}, '1': {'precision': 0.9096841258841143, 'recall': 0.7404217116480942, 'f1-score': 0.8163717286807906, 'support': 464488}, '2': {'precision': 0.3948441322210374, 'recall': 0.6567981741115096, 'f1-score': 0.49319602975237364, 'support': 76675}, 'accuracy': 0.7137338357468622, 'macro avg': {'precision': 0.5760268531322413, 'recall': 0.670011038737254, 'f1-score': 0.6034897073448366, 'support': 620737}, 'weighted avg': {'precision': 0.7837712024974895, 'recall': 0.7137338357468622, 'f1-score': 0.7360112289100855, 'support': 620737}}
[[ 48764  17730  13080]
 [ 56467 343917  64104]
 [  9900  16415  50360]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7030165
{'0': {'precision': 0.49237484042369667, 'recall': 0.5448783421311366, 'f1-score': 0.5172977847054506, 'support': 104761}, '1': {'precision': 0.8487663076220657, 'recall': 0.760464649056348, 'f1-score': 0.8021928357492487, 'support': 413129}, '2': {'precision': 0.462177697243346, 'recall': 0.6051221717697162, 'f1-score': 0.5240775905988556, 'support': 102847}, 'accuracy': 0.6983424542116871, 'macro avg': {'precision': 0.6011062817630362, 'recall': 0.6368217209857335, 'f1-score': 0.6145227370178517, 'support': 620737}, 'weighted avg': {'precision': 0.724566517200698, 'recall': 0.6983424542116871, 'f1-score': 0.7080318479873111, 'support': 620737}}
[[ 57082  29179  18500]
 [ 45038 314170  53921]
 [ 13812  26800  62235]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7496904
{'0': {'precision': 0.5251407849085552, 'recall': 0.4912940293760245, 'f1-score': 0.5076538673835277, 'support': 122617}, '1': {'precision': 0.7915835926696687, 'recall': 0.770849103459999, 'f1-score': 0.781078768044955, 'support': 376503}, '2': {'precision': 0.49207932157667417, 'recall': 0.5639589859970234, 'f1-score': 0.5255728949153061, 'support': 121617}, 'accuracy': 0.675092672097845, 'macro avg': {'precision': 0.602934566384966, 'recall': 0.6087007062776824, 'f1-score': 0.6047685101145963, 'support': 620737}, 'weighted avg': {'precision': 0.6802719925930483, 'recall': 0.675092672097845, 'f1-score': 0.6770082859940852, 'support': 620737}}
[[ 60241  39659  22717]
 [ 38198 290227  48078]
 [ 16275  36755  68587]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.83950084
{'0': {'precision': 0.5467797910588907, 'recall': 0.4122585158478179, 'f1-score': 0.47008471618734976, 'support': 148664}, '1': {'precision': 0.6914693292168905, 'recall': 0.7818003459704347, 'f1-score': 0.7338655914993615, 'support': 323149}, '2': {'precision': 0.5167080762681109, 'recall': 0.49713948054040985, 'f1-score': 0.5067349285440508, 'support': 148924}, 'accuracy': 0.6250022151088142, 'macro avg': {'precision': 0.5849857321812973, 'recall': 0.5637327807862208, 'f1-score': 0.5702284120769207, 'support': 620737}, 'weighted avg': {'precision': 0.6148889572802009, 'recall': 0.6250022151088142, 'f1-score': 0.6161991290565852, 'support': 620737}}
[[ 61288  58133  29243]
 [ 30506 252638  40005]
 [ 20295  54593  74036]]
Evaluating performance on  val set...
787/787 - 7s - 7s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.67417514
{'0': {'precision': 0.4375556214773064, 'recall': 0.6008146639511202, 'f1-score': 0.5063508410573291, 'support': 27005}, '1': {'precision': 0.9017034185042585, 'recall': 0.7299645808736718, 'f1-score': 0.8067959391392854, 'support': 148225}, '2': {'precision': 0.390717376039142, 'recall': 0.663627269929209, 'f1-score': 0.4918518940960093, 'support': 25992}, 'accuracy': 0.7040631740068184, 'macro avg': {'precision': 0.5766588053402356, 'recall': 0.6648021715846669, 'f1-score': 0.601666224764208, 'support': 201222}, 'weighted avg': {'precision': 0.7734080011320719, 'recall': 0.7040631740068184, 'f1-score': 0.725793138787097, 'support': 201222}}
[[ 16225   6033   4747]
 [ 17875 108199  22151]
 [  2981   5762  17249]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7136397
{'0': {'precision': 0.5047438835882949, 'recall': 0.5356506490935317, 'f1-score': 0.5197381961882023, 'support': 35357}, '1': {'precision': 0.8363602273792581, 'recall': 0.7474750552212659, 'f1-score': 0.7894235139385506, 'support': 131290}, '2': {'precision': 0.454759182969178, 'recall': 0.6098047722342733, 'f1-score': 0.520991376115051, 'support': 34575}, 'accuracy': 0.6865998747651847, 'macro avg': {'precision': 0.5986210979789103, 'recall': 0.630976825516357, 'f1-score': 0.610051028747268, 'support': 201222}, 'weighted avg': {'precision': 0.7125227981821742, 'recall': 0.6865998747651847, 'f1-score': 0.6959133363985869, 'support': 201222}}
[[18939  9993  6425]
 [14300 98136 18854]
 [ 4283  9208 21084]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.76512814
{'0': {'precision': 0.5369434286943429, 'recall': 0.48348828200658533, 'f1-score': 0.5088157358336731, 'support': 41304}, '1': {'precision': 0.7757843289104583, 'recall': 0.7557293500310148, 'f1-score': 0.7656255307585177, 'support': 119298}, '2': {'precision': 0.48268362054542413, 'recall': 0.568193008370261, 'f1-score': 0.5219593830566738, 'support': 40620}, 'accuracy': 0.6619902396358252, 'macro avg': {'precision': 0.5984704593834085, 'recall': 0.602470213469287, 'f1-score': 0.5988002165496216, 'support': 201222}, 'weighted avg': {'precision': 0.6675912122715513, 'recall': 0.6619902396358252, 'f1-score': 0.6637232005499686, 'support': 201222}}
[[19970 13606  7728]
 [12133 90157 17008]
 [ 5089 12451 23080]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.86221105
{'0': {'precision': 0.5559899393077806, 'recall': 0.40707380051642345, 'f1-score': 0.4700186047586581, 'support': 49959}, '1': {'precision': 0.6696872840359365, 'recall': 0.7611039114043355, 'f1-score': 0.7124751856481141, 'support': 101856}, '2': {'precision': 0.50632108665412, 'recall': 0.5009614022304532, 'f1-score': 0.5036269851766693, 'support': 49407}, 'accuracy': 0.60933198159247, 'macro avg': {'precision': 0.5773327699992791, 'recall': 0.5563797047170708, 'f1-score': 0.5620402585278138, 'support': 201222}, 'weighted avg': {'precision': 0.6013466485223378, 'recall': 0.60933198159247, 'f1-score': 0.600999048022263, 'support': 201222}}
[[20337 19969  9653]
 [ 9853 77523 14480]
 [ 6388 18268 24751]]
training model: results/AAL/W4/deepVOL_L3/seq2seq
Epoch 1/50
2425/2425 - 108s - loss: 11.1399 - accuracy10: 0.4899 - accuracy20: 0.5060 - accuracy30: 0.5120 - accuracy50: 0.5099 - val_loss: 11.3263 - val_accuracy10: 0.6130 - val_accuracy20: 0.6192 - val_accuracy30: 0.6094 - val_accuracy50: 0.5716 - 108s/epoch - 44ms/step
Epoch 2/50
2425/2425 - 101s - loss: 9.9599 - accuracy10: 0.5921 - accuracy20: 0.5944 - accuracy30: 0.5849 - accuracy50: 0.5646 - val_loss: 12.6846 - val_accuracy10: 0.7472 - val_accuracy20: 0.7046 - val_accuracy30: 0.6628 - val_accuracy50: 0.5898 - 101s/epoch - 42ms/step
Epoch 3/50
2425/2425 - 100s - loss: 9.6476 - accuracy10: 0.6185 - accuracy20: 0.6170 - accuracy30: 0.6029 - accuracy50: 0.5769 - val_loss: 11.7359 - val_accuracy10: 0.7362 - val_accuracy20: 0.7042 - val_accuracy30: 0.6676 - val_accuracy50: 0.6002 - 100s/epoch - 41ms/step
Epoch 4/50
2425/2425 - 101s - loss: 9.4318 - accuracy10: 0.6324 - accuracy20: 0.6283 - accuracy30: 0.6122 - accuracy50: 0.5840 - val_loss: 11.1630 - val_accuracy10: 0.7306 - val_accuracy20: 0.7037 - val_accuracy30: 0.6706 - val_accuracy50: 0.6062 - 101s/epoch - 42ms/step
Epoch 5/50
2425/2425 - 100s - loss: 9.2998 - accuracy10: 0.6411 - accuracy20: 0.6351 - accuracy30: 0.6179 - accuracy50: 0.5880 - val_loss: 10.9016 - val_accuracy10: 0.7302 - val_accuracy20: 0.7041 - val_accuracy30: 0.6716 - val_accuracy50: 0.6090 - 100s/epoch - 41ms/step
Epoch 6/50
2425/2425 - 102s - loss: 9.2214 - accuracy10: 0.6451 - accuracy20: 0.6382 - accuracy30: 0.6210 - accuracy50: 0.5911 - val_loss: 10.4457 - val_accuracy10: 0.7250 - val_accuracy20: 0.7014 - val_accuracy30: 0.6706 - val_accuracy50: 0.6099 - 102s/epoch - 42ms/step
Epoch 7/50
2425/2425 - 100s - loss: 9.1591 - accuracy10: 0.6493 - accuracy20: 0.6409 - accuracy30: 0.6229 - accuracy50: 0.5929 - val_loss: 10.1719 - val_accuracy10: 0.7056 - val_accuracy20: 0.6898 - val_accuracy30: 0.6644 - val_accuracy50: 0.6107 - 100s/epoch - 41ms/step
Epoch 8/50
2425/2425 - 100s - loss: 9.1175 - accuracy10: 0.6525 - accuracy20: 0.6431 - accuracy30: 0.6251 - accuracy50: 0.5950 - val_loss: 10.1783 - val_accuracy10: 0.7128 - val_accuracy20: 0.6924 - val_accuracy30: 0.6664 - val_accuracy50: 0.6116 - 100s/epoch - 41ms/step
Epoch 9/50
2425/2425 - 100s - loss: 9.0718 - accuracy10: 0.6550 - accuracy20: 0.6441 - accuracy30: 0.6263 - accuracy50: 0.5960 - val_loss: 10.0577 - val_accuracy10: 0.7203 - val_accuracy20: 0.6985 - val_accuracy30: 0.6700 - val_accuracy50: 0.6142 - 100s/epoch - 41ms/step
Epoch 10/50
2425/2425 - 99s - loss: 9.0389 - accuracy10: 0.6569 - accuracy20: 0.6462 - accuracy30: 0.6280 - accuracy50: 0.5976 - val_loss: 9.9943 - val_accuracy10: 0.7170 - val_accuracy20: 0.6951 - val_accuracy30: 0.6663 - val_accuracy50: 0.6119 - 99s/epoch - 41ms/step
Epoch 11/50
2425/2425 - 101s - loss: 9.0093 - accuracy10: 0.6581 - accuracy20: 0.6477 - accuracy30: 0.6293 - accuracy50: 0.5985 - val_loss: 9.9620 - val_accuracy10: 0.7028 - val_accuracy20: 0.6842 - val_accuracy30: 0.6580 - val_accuracy50: 0.6083 - 101s/epoch - 41ms/step
Epoch 12/50
2425/2425 - 100s - loss: 8.9838 - accuracy10: 0.6602 - accuracy20: 0.6488 - accuracy30: 0.6305 - accuracy50: 0.5994 - val_loss: 9.8778 - val_accuracy10: 0.6998 - val_accuracy20: 0.6835 - val_accuracy30: 0.6582 - val_accuracy50: 0.6090 - 100s/epoch - 41ms/step
Epoch 13/50
2425/2425 - 101s - loss: 8.9599 - accuracy10: 0.6604 - accuracy20: 0.6492 - accuracy30: 0.6314 - accuracy50: 0.6004 - val_loss: 9.9628 - val_accuracy10: 0.7135 - val_accuracy20: 0.6933 - val_accuracy30: 0.6656 - val_accuracy50: 0.6124 - 101s/epoch - 42ms/step
Epoch 14/50
2425/2425 - 100s - loss: 8.9411 - accuracy10: 0.6618 - accuracy20: 0.6499 - accuracy30: 0.6316 - accuracy50: 0.6009 - val_loss: 9.9814 - val_accuracy10: 0.7094 - val_accuracy20: 0.6891 - val_accuracy30: 0.6607 - val_accuracy50: 0.6085 - 100s/epoch - 41ms/step
Epoch 15/50
2425/2425 - 100s - loss: 8.9201 - accuracy10: 0.6628 - accuracy20: 0.6509 - accuracy30: 0.6322 - accuracy50: 0.6012 - val_loss: 9.9250 - val_accuracy10: 0.7022 - val_accuracy20: 0.6845 - val_accuracy30: 0.6582 - val_accuracy50: 0.6078 - 100s/epoch - 41ms/step
Epoch 16/50
2425/2425 - 101s - loss: 8.9048 - accuracy10: 0.6638 - accuracy20: 0.6518 - accuracy30: 0.6329 - accuracy50: 0.6020 - val_loss: 9.9254 - val_accuracy10: 0.7040 - val_accuracy20: 0.6856 - val_accuracy30: 0.6598 - val_accuracy50: 0.6100 - 101s/epoch - 42ms/step
Epoch 17/50
2425/2425 - 99s - loss: 8.8857 - accuracy10: 0.6645 - accuracy20: 0.6523 - accuracy30: 0.6331 - accuracy50: 0.6023 - val_loss: 10.0111 - val_accuracy10: 0.7058 - val_accuracy20: 0.6878 - val_accuracy30: 0.6604 - val_accuracy50: 0.6089 - 99s/epoch - 41ms/step
Epoch 18/50
2425/2425 - 101s - loss: 8.8686 - accuracy10: 0.6655 - accuracy20: 0.6533 - accuracy30: 0.6346 - accuracy50: 0.6030 - val_loss: 9.9176 - val_accuracy10: 0.7013 - val_accuracy20: 0.6847 - val_accuracy30: 0.6590 - val_accuracy50: 0.6088 - 101s/epoch - 42ms/step
Epoch 19/50
2425/2425 - 100s - loss: 8.8539 - accuracy10: 0.6656 - accuracy20: 0.6533 - accuracy30: 0.6345 - accuracy50: 0.6035 - val_loss: 10.0183 - val_accuracy10: 0.7056 - val_accuracy20: 0.6862 - val_accuracy30: 0.6595 - val_accuracy50: 0.6083 - 100s/epoch - 41ms/step
Epoch 20/50
2425/2425 - 100s - loss: 8.8406 - accuracy10: 0.6665 - accuracy20: 0.6541 - accuracy30: 0.6354 - accuracy50: 0.6038 - val_loss: 9.9249 - val_accuracy10: 0.7041 - val_accuracy20: 0.6852 - val_accuracy30: 0.6588 - val_accuracy50: 0.6088 - 100s/epoch - 41ms/step
Epoch 21/50
2425/2425 - 100s - loss: 8.8235 - accuracy10: 0.6668 - accuracy20: 0.6543 - accuracy30: 0.6357 - accuracy50: 0.6041 - val_loss: 9.9783 - val_accuracy10: 0.6922 - val_accuracy20: 0.6765 - val_accuracy30: 0.6525 - val_accuracy50: 0.6052 - 100s/epoch - 41ms/step
Epoch 22/50
2425/2425 - 99s - loss: 8.8152 - accuracy10: 0.6671 - accuracy20: 0.6542 - accuracy30: 0.6359 - accuracy50: 0.6045 - val_loss: 9.8694 - val_accuracy10: 0.6855 - val_accuracy20: 0.6715 - val_accuracy30: 0.6490 - val_accuracy50: 0.6031 - 99s/epoch - 41ms/step
Epoch 23/50
2425/2425 - 100s - loss: 8.7967 - accuracy10: 0.6677 - accuracy20: 0.6549 - accuracy30: 0.6361 - accuracy50: 0.6051 - val_loss: 9.9277 - val_accuracy10: 0.6939 - val_accuracy20: 0.6779 - val_accuracy30: 0.6540 - val_accuracy50: 0.6063 - 100s/epoch - 41ms/step
Epoch 24/50
2425/2425 - 100s - loss: 8.7832 - accuracy10: 0.6673 - accuracy20: 0.6545 - accuracy30: 0.6363 - accuracy50: 0.6053 - val_loss: 9.9368 - val_accuracy10: 0.6958 - val_accuracy20: 0.6798 - val_accuracy30: 0.6553 - val_accuracy50: 0.6073 - 100s/epoch - 41ms/step
Epoch 25/50
2425/2425 - 99s - loss: 8.7739 - accuracy10: 0.6684 - accuracy20: 0.6551 - accuracy30: 0.6368 - accuracy50: 0.6057 - val_loss: 9.9105 - val_accuracy10: 0.6970 - val_accuracy20: 0.6789 - val_accuracy30: 0.6535 - val_accuracy50: 0.6060 - 99s/epoch - 41ms/step
Epoch 26/50
2425/2425 - 99s - loss: 8.7597 - accuracy10: 0.6686 - accuracy20: 0.6558 - accuracy30: 0.6372 - accuracy50: 0.6063 - val_loss: 9.9922 - val_accuracy10: 0.7026 - val_accuracy20: 0.6849 - val_accuracy30: 0.6593 - val_accuracy50: 0.6093 - 99s/epoch - 41ms/step
Epoch 27/50
2425/2425 - 99s - loss: 8.7465 - accuracy10: 0.6689 - accuracy20: 0.6562 - accuracy30: 0.6375 - accuracy50: 0.6067 - val_loss: 9.9673 - val_accuracy10: 0.6995 - val_accuracy20: 0.6821 - val_accuracy30: 0.6574 - val_accuracy50: 0.6080 - 99s/epoch - 41ms/step
Epoch 28/50
2425/2425 - 99s - loss: 8.7317 - accuracy10: 0.6698 - accuracy20: 0.6571 - accuracy30: 0.6388 - accuracy50: 0.6075 - val_loss: 9.9646 - val_accuracy10: 0.6862 - val_accuracy20: 0.6721 - val_accuracy30: 0.6489 - val_accuracy50: 0.6039 - 99s/epoch - 41ms/step
Epoch 29/50
2425/2425 - 100s - loss: 8.7243 - accuracy10: 0.6702 - accuracy20: 0.6569 - accuracy30: 0.6380 - accuracy50: 0.6072 - val_loss: 10.0312 - val_accuracy10: 0.6996 - val_accuracy20: 0.6827 - val_accuracy30: 0.6572 - val_accuracy50: 0.6079 - 100s/epoch - 41ms/step
Epoch 30/50
2425/2425 - 98s - loss: 8.7131 - accuracy10: 0.6706 - accuracy20: 0.6579 - accuracy30: 0.6396 - accuracy50: 0.6083 - val_loss: 9.9240 - val_accuracy10: 0.6917 - val_accuracy20: 0.6748 - val_accuracy30: 0.6502 - val_accuracy50: 0.6033 - 98s/epoch - 41ms/step
Epoch 31/50
2425/2425 - 99s - loss: 8.7045 - accuracy10: 0.6702 - accuracy20: 0.6580 - accuracy30: 0.6397 - accuracy50: 0.6087 - val_loss: 9.9705 - val_accuracy10: 0.6980 - val_accuracy20: 0.6812 - val_accuracy30: 0.6568 - val_accuracy50: 0.6074 - 99s/epoch - 41ms/step
Epoch 32/50
2425/2425 - 101s - loss: 8.6904 - accuracy10: 0.6706 - accuracy20: 0.6579 - accuracy30: 0.6399 - accuracy50: 0.6090 - val_loss: 9.9925 - val_accuracy10: 0.6988 - val_accuracy20: 0.6801 - val_accuracy30: 0.6547 - val_accuracy50: 0.6050 - 101s/epoch - 42ms/step
testing model: results/AAL/W4/deepVOL_L3/seq2seq
Evaluating performance on  test set...
4457/4457 - 75s - 75s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8145739
{'0': {'precision': 0.384856005377178, 'recall': 0.69142969938344, 'f1-score': 0.49447998970317747, 'support': 172246}, '1': {'precision': 0.896353114593001, 'recall': 0.6157707213401675, 'f1-score': 0.7300301613297664, 'support': 799900}, '2': {'precision': 0.39025436801622737, 'recall': 0.6518988466528052, 'f1-score': 0.48823218856891876, 'support': 168813}, 'accuracy': 0.6325380666614664, 'macro avg': {'precision': 0.5571544959954688, 'recall': 0.6530330891254709, 'f1-score': 0.5709141132006209, 'support': 1140959}, 'weighted avg': {'precision': 0.7442535397793105, 'recall': 0.6325380666614664, 'f1-score': 0.6586943674601615, 'support': 1140959}}
[[119096  29326  23824]
 [159225 492555 148120]
 [ 31135  27629 110049]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8214357
{'0': {'precision': 0.466818966958266, 'recall': 0.6217141160961386, 'f1-score': 0.5332459728371257, 'support': 229086}, '1': {'precision': 0.8268441982376935, 'recall': 0.6351808028502318, 'f1-score': 0.7184494947458008, 'support': 687102}, '2': {'precision': 0.45100298997821636, 'recall': 0.6180601590062775, 'f1-score': 0.5214789789789789, 'support': 224771}, 'accuracy': 0.6291041132941675, 'macro avg': {'precision': 0.5815553850580587, 'recall': 0.624985025984216, 'f1-score': 0.5910581488539685, 'support': 1140959}, 'weighted avg': {'precision': 0.6805155883975766, 'recall': 0.6291041132941675, 'f1-score': 0.6424600912533046, 'support': 1140959}}
[[142426  48023  38637]
 [120198 436434 130470]
 [ 42475  43374 138922]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8492086
{'0': {'precision': 0.5004275198280748, 'recall': 0.5706584678835335, 'f1-score': 0.5332404774745999, 'support': 267682}, '1': {'precision': 0.7647238620711275, 'recall': 0.6381772577438258, 'f1-score': 0.6957430860019447, 'support': 611584}, '2': {'precision': 0.4733486818040703, 'recall': 0.5884567030833839, 'f1-score': 0.5246633868461936, 'support': 261693}, 'accuracy': 0.6109325576116232, 'macro avg': {'precision': 0.5795000212344242, 'recall': 0.5990974762369143, 'f1-score': 0.5845489834409127, 'support': 1140959}, 'weighted avg': {'precision': 0.6358864379972284, 'recall': 0.6109325576116232, 'f1-score': 0.6183788836362307, 'support': 1140959}}
[[152755  63151  51776]
 [101725 390299 119560]
 [ 50769  56929 153995]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9115222
{'0': {'precision': 0.5290030039483334, 'recall': 0.49066590461517434, 'f1-score': 0.5091137629019652, 'support': 321938}, '1': {'precision': 0.6565050543244342, 'recall': 0.6406322065799571, 'f1-score': 0.6484715137849343, 'support': 509517}, '2': {'precision': 0.4843548097371029, 'recall': 0.5401448769644334, 'f1-score': 0.5107307937885125, 'support': 309504}, 'accuracy': 0.5710582062983859, 'macro avg': {'precision': 0.5566209560032901, 'recall': 0.5571476627198549, 'f1-score': 0.5561053568251374, 'support': 1140959}, 'weighted avg': {'precision': 0.5738299149068579, 'recall': 0.5710582062983859, 'f1-score': 0.5717852705408442, 'support': 1140959}}
[[157964  89382  74592]
 [ 79719 326413 103385]
 [ 60924  81403 167177]]
Evaluating performance on  train set...
2425/2425 - 41s - 41s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6764056
{'0': {'precision': 0.3892884446583798, 'recall': 0.6911051348430391, 'f1-score': 0.4980393222303728, 'support': 79574}, '1': {'precision': 0.9223953903605364, 'recall': 0.7051333941888703, 'f1-score': 0.7992630281733105, 'support': 464488}, '2': {'precision': 0.39897256144130816, 'recall': 0.647238343658298, 'f1-score': 0.4936487252688225, 'support': 76675}, 'accuracy': 0.696183729985485, 'macro avg': {'precision': 0.5702187988200748, 'recall': 0.6811589575634024, 'f1-score': 0.5969836918908352, 'support': 620737}, 'weighted avg': {'precision': 0.7894004222747204, 'recall': 0.696183729985485, 'f1-score': 0.7228980751386035, 'support': 620737}}
[[ 54994  14447  10133]
 [ 72335 327526  64627]
 [ 13939  13109  49627]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7000442
{'0': {'precision': 0.46014034937428167, 'recall': 0.6152671318525024, 'f1-score': 0.5265152752818167, 'support': 104761}, '1': {'precision': 0.8661578463741482, 'recall': 0.7232801376809664, 'f1-score': 0.7882972128055296, 'support': 413129}, '2': {'precision': 0.46251022649380513, 'recall': 0.6101490563652805, 'f1-score': 0.5261692743707131, 'support': 102847}, 'accuracy': 0.6863067611564962, 'macro avg': {'precision': 0.5962694740807449, 'recall': 0.6495654419662498, 'f1-score': 0.6136605874860198, 'support': 620737}, 'weighted avg': {'precision': 0.7307563063257273, 'recall': 0.6863067611564962, 'f1-score': 0.7006858578498443, 'support': 620737}}
[[ 64456  24293  16012]
 [ 57408 298808  56913]
 [ 18215  21880  62752]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7396657
{'0': {'precision': 0.4923494710570351, 'recall': 0.5663080975721148, 'f1-score': 0.5267453812397356, 'support': 122617}, '1': {'precision': 0.814499377434913, 'recall': 0.7279835751640757, 'f1-score': 0.768815198579551, 'support': 376503}, '2': {'precision': 0.4884628814861373, 'recall': 0.5751087430211237, 'f1-score': 0.5282564282666243, 'support': 121617}, 'accuracy': 0.6660953028416221, 'macro avg': {'precision': 0.5984372433260284, 'recall': 0.6231334719191047, 'f1-score': 0.6079390026953037, 'support': 620737}, 'weighted avg': {'precision': 0.6869854132308484, 'recall': 0.6660953028416221, 'f1-score': 0.6738669181292098, 'support': 620737}}
[[ 69439  32440  20738]
 [ 49906 274088  52509]
 [ 21691  29983  69943]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8173902
{'0': {'precision': 0.5195204050807716, 'recall': 0.48586745950600013, 'f1-score': 0.5021307065047376, 'support': 148664}, '1': {'precision': 0.7194573972022044, 'recall': 0.7352892937932657, 'f1-score': 0.7272871968399579, 'support': 323149}, '2': {'precision': 0.5109975370271324, 'recall': 0.5196408906556365, 'f1-score': 0.5152829704994223, 'support': 148924}, 'accuracy': 0.6238165277726315, 'macro avg': {'precision': 0.5833251131033693, 'recall': 0.5802658813183007, 'f1-score': 0.5815669579480393, 'support': 620737}, 'weighted avg': {'precision': 0.6215606885905811, 'recall': 0.6238165277726315, 'f1-score': 0.6225001745056471, 'support': 620737}}
[[ 72231  47454  28979]
 [ 40464 237608  45077]
 [ 26339  45198  77387]]
Evaluating performance on  val set...
787/787 - 13s - 13s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6880024
{'0': {'precision': 0.407983563252128, 'recall': 0.6691353453064247, 'f1-score': 0.5069008078994613, 'support': 27005}, '1': {'precision': 0.9138165556849601, 'recall': 0.6934525215044696, 'f1-score': 0.7885280737689199, 'support': 148225}, '2': {'precision': 0.3858267716535433, 'recall': 0.659818405663281, 'f1-score': 0.48692541381562127, 'support': 25992}, 'accuracy': 0.6858444901650913, 'macro avg': {'precision': 0.5692089635302104, 'recall': 0.6741354241580583, 'f1-score': 0.5941180984946675, 'support': 201222}, 'weighted avg': {'precision': 0.7777303900211995, 'recall': 0.6858444901650913, 'f1-score': 0.7117740376679426, 'support': 201222}}
[[ 18070   5123   3812]
 [ 21950 102787  23488]
 [  4271   4571  17150]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7163725
{'0': {'precision': 0.47600780824405303, 'recall': 0.593121588370054, 'f1-score': 0.5281503028471409, 'support': 35357}, '1': {'precision': 0.8527996319300667, 'recall': 0.7059029629065428, 'f1-score': 0.7724293126080886, 'support': 131290}, '2': {'precision': 0.4441236518116764, 'recall': 0.6228778018799711, 'f1-score': 0.5185274360147353, 'support': 34575}, 'accuracy': 0.6718201787080935, 'macro avg': {'precision': 0.5909770306619321, 'recall': 0.6406341177188559, 'f1-score': 0.6063690171566548, 'support': 201222}, 'weighted avg': {'precision': 0.716372200920238, 'recall': 0.6718201787080935, 'f1-score': 0.6858799773896084, 'support': 201222}}
[[20971  8553  5833]
 [17490 92678 21122]
 [ 5595  7444 21536]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7614856
{'0': {'precision': 0.5062428291826956, 'recall': 0.5448140615920977, 'f1-score': 0.5248207101626727, 'support': 41304}, '1': {'precision': 0.7961154954869808, 'recall': 0.7060721889721537, 'f1-score': 0.7483951790957917, 'support': 119298}, '2': {'precision': 0.46799827335870975, 'recall': 0.5871984244214673, 'f1-score': 0.5208656344856202, 'support': 40620}, 'accuracy': 0.6489747641907943, 'macro avg': {'precision': 0.5901188660094621, 'recall': 0.6126948916619063, 'f1-score': 0.5980271745813616, 'support': 201222}, 'weighted avg': {'precision': 0.6703786368339381, 'recall': 0.6489747641907943, 'f1-score': 0.6565723666454696, 'support': 201222}}
[[22503 11452  7349]
 [15300 84233 19765]
 [ 6648 10120 23852]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8460244
{'0': {'precision': 0.5273989755264655, 'recall': 0.4637002341920375, 'f1-score': 0.49350262025478253, 'support': 49959}, '1': {'precision': 0.6944219419048722, 'recall': 0.7069392082940622, 'f1-score': 0.7006246716095511, 'support': 101856}, '2': {'precision': 0.4897117806174797, 'recall': 0.5313214726658165, 'f1-score': 0.5096687764532287, 'support': 49407}, 'accuracy': 0.6034280545864766, 'macro avg': {'precision': 0.5705108993496059, 'recall': 0.5673203050506387, 'f1-score': 0.5679320227725208, 'support': 201222}, 'weighted avg': {'precision': 0.6026903453795169, 'recall': 0.6034280545864766, 'f1-score': 0.6023145043533799, 'support': 201222}}
[[23166 16667 10126]
 [12622 72006 17228]
 [ 8137 15019 26251]]
training model: results/AAL/W5/deepLOB_L1/seq2seq
Epoch 1/50
1701/1701 - 49s - loss: 11.9060 - accuracy10: 0.4486 - accuracy20: 0.4654 - accuracy30: 0.4717 - accuracy50: 0.4712 - val_loss: 13.2508 - val_accuracy10: 0.3396 - val_accuracy20: 0.3495 - val_accuracy30: 0.3533 - val_accuracy50: 0.3554 - 49s/epoch - 29ms/step
Epoch 2/50
1701/1701 - 45s - loss: 11.7792 - accuracy10: 0.4253 - accuracy20: 0.4538 - accuracy30: 0.4669 - accuracy50: 0.4704 - val_loss: 12.4229 - val_accuracy10: 0.5009 - val_accuracy20: 0.4868 - val_accuracy30: 0.4684 - val_accuracy50: 0.4320 - 45s/epoch - 27ms/step
Epoch 3/50
1701/1701 - 43s - loss: 11.4698 - accuracy10: 0.4782 - accuracy20: 0.4960 - accuracy30: 0.5000 - accuracy50: 0.4922 - val_loss: 12.2881 - val_accuracy10: 0.3460 - val_accuracy20: 0.3793 - val_accuracy30: 0.3917 - val_accuracy50: 0.4115 - 43s/epoch - 25ms/step
Epoch 4/50
1701/1701 - 43s - loss: 11.1485 - accuracy10: 0.5313 - accuracy20: 0.5327 - accuracy30: 0.5264 - accuracy50: 0.5090 - val_loss: 12.1646 - val_accuracy10: 0.3397 - val_accuracy20: 0.3669 - val_accuracy30: 0.3860 - val_accuracy50: 0.4152 - 43s/epoch - 26ms/step
Epoch 5/50
1701/1701 - 46s - loss: 10.9504 - accuracy10: 0.5518 - accuracy20: 0.5487 - accuracy30: 0.5382 - accuracy50: 0.5181 - val_loss: 11.7348 - val_accuracy10: 0.4408 - val_accuracy20: 0.4589 - val_accuracy30: 0.4656 - val_accuracy50: 0.4683 - 46s/epoch - 27ms/step
Epoch 6/50
1701/1701 - 46s - loss: 10.7900 - accuracy10: 0.5678 - accuracy20: 0.5624 - accuracy30: 0.5493 - accuracy50: 0.5263 - val_loss: 11.5447 - val_accuracy10: 0.4777 - val_accuracy20: 0.4866 - val_accuracy30: 0.4882 - val_accuracy50: 0.4825 - 46s/epoch - 27ms/step
Epoch 7/50
1701/1701 - 45s - loss: 10.6796 - accuracy10: 0.5762 - accuracy20: 0.5703 - accuracy30: 0.5561 - accuracy50: 0.5309 - val_loss: 11.5948 - val_accuracy10: 0.4527 - val_accuracy20: 0.4693 - val_accuracy30: 0.4752 - val_accuracy50: 0.4754 - 45s/epoch - 26ms/step
Epoch 8/50
1701/1701 - 45s - loss: 10.5884 - accuracy10: 0.5834 - accuracy20: 0.5766 - accuracy30: 0.5621 - accuracy50: 0.5365 - val_loss: 11.5147 - val_accuracy10: 0.4495 - val_accuracy20: 0.4690 - val_accuracy30: 0.4746 - val_accuracy50: 0.4753 - 45s/epoch - 26ms/step
Epoch 9/50
1701/1701 - 46s - loss: 10.5172 - accuracy10: 0.5886 - accuracy20: 0.5820 - accuracy30: 0.5670 - accuracy50: 0.5398 - val_loss: 11.6252 - val_accuracy10: 0.4160 - val_accuracy20: 0.4424 - val_accuracy30: 0.4528 - val_accuracy50: 0.4621 - 46s/epoch - 27ms/step
Epoch 10/50
1701/1701 - 43s - loss: 10.4664 - accuracy10: 0.5933 - accuracy20: 0.5854 - accuracy30: 0.5698 - accuracy50: 0.5418 - val_loss: 11.5268 - val_accuracy10: 0.4781 - val_accuracy20: 0.4910 - val_accuracy30: 0.4909 - val_accuracy50: 0.4846 - 43s/epoch - 25ms/step
Epoch 11/50
1701/1701 - 45s - loss: 10.4237 - accuracy10: 0.5958 - accuracy20: 0.5881 - accuracy30: 0.5721 - accuracy50: 0.5435 - val_loss: 11.6586 - val_accuracy10: 0.6107 - val_accuracy20: 0.5831 - val_accuracy30: 0.5548 - val_accuracy50: 0.5036 - 45s/epoch - 27ms/step
Epoch 12/50
1701/1701 - 42s - loss: 10.3760 - accuracy10: 0.5984 - accuracy20: 0.5911 - accuracy30: 0.5753 - accuracy50: 0.5461 - val_loss: 11.6112 - val_accuracy10: 0.5082 - val_accuracy20: 0.5153 - val_accuracy30: 0.5122 - val_accuracy50: 0.4926 - 42s/epoch - 25ms/step
Epoch 13/50
1701/1701 - 44s - loss: 10.3347 - accuracy10: 0.6016 - accuracy20: 0.5945 - accuracy30: 0.5780 - accuracy50: 0.5485 - val_loss: 11.6474 - val_accuracy10: 0.5421 - val_accuracy20: 0.5403 - val_accuracy30: 0.5282 - val_accuracy50: 0.5003 - 44s/epoch - 26ms/step
Epoch 14/50
1701/1701 - 44s - loss: 10.2998 - accuracy10: 0.6045 - accuracy20: 0.5968 - accuracy30: 0.5801 - accuracy50: 0.5500 - val_loss: 11.7342 - val_accuracy10: 0.4531 - val_accuracy20: 0.4726 - val_accuracy30: 0.4768 - val_accuracy50: 0.4695 - 44s/epoch - 26ms/step
Epoch 15/50
1701/1701 - 45s - loss: 10.2685 - accuracy10: 0.6062 - accuracy20: 0.5984 - accuracy30: 0.5822 - accuracy50: 0.5511 - val_loss: 11.7868 - val_accuracy10: 0.5430 - val_accuracy20: 0.5403 - val_accuracy30: 0.5285 - val_accuracy50: 0.4942 - 45s/epoch - 27ms/step
Epoch 16/50
1701/1701 - 45s - loss: 10.2438 - accuracy10: 0.6087 - accuracy20: 0.6009 - accuracy30: 0.5840 - accuracy50: 0.5524 - val_loss: 11.7840 - val_accuracy10: 0.4743 - val_accuracy20: 0.4895 - val_accuracy30: 0.4907 - val_accuracy50: 0.4769 - 45s/epoch - 26ms/step
Epoch 17/50
1701/1701 - 45s - loss: 10.2137 - accuracy10: 0.6097 - accuracy20: 0.6021 - accuracy30: 0.5852 - accuracy50: 0.5537 - val_loss: 12.0198 - val_accuracy10: 0.4624 - val_accuracy20: 0.4765 - val_accuracy30: 0.4769 - val_accuracy50: 0.4650 - 45s/epoch - 27ms/step
Epoch 18/50
1701/1701 - 42s - loss: 10.1851 - accuracy10: 0.6111 - accuracy20: 0.6039 - accuracy30: 0.5869 - accuracy50: 0.5552 - val_loss: 11.8203 - val_accuracy10: 0.4599 - val_accuracy20: 0.4791 - val_accuracy30: 0.4824 - val_accuracy50: 0.4723 - 42s/epoch - 25ms/step
testing model: results/AAL/W5/deepLOB_L1/seq2seq
Evaluating performance on  test set...
6357/6357 - 68s - 68s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9874963
{'0': {'precision': 0.3713075035987268, 'recall': 0.35528740760859023, 'f1-score': 0.36312084861703187, 'support': 257735}, '1': {'precision': 0.8111569890206677, 'recall': 0.3895542366095194, 'f1-score': 0.5263374488109361, 'support': 1106439}, '2': {'precision': 0.24563820667175384, 'recall': 0.7931481587102417, 'f1-score': 0.37510598487484564, 'support': 262995}, 'accuracy': 0.44935836412812685, 'macro avg': {'precision': 0.4760342330970495, 'recall': 0.5126632676427838, 'f1-score': 0.4215214274342712, 'support': 1627169}, 'weighted avg': {'precision': 0.6500838495440204, 'recall': 0.44935836412812685, 'f1-score': 0.47604165943143834, 'support': 1627169}}
[[ 91570  71580  94585]
 [129408 431018 546013]
 [ 25637  28764 208594]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9994825
{'0': {'precision': 0.438717667600601, 'recall': 0.3194714260791915, 'f1-score': 0.36971715917004155, 'support': 338193}, '1': {'precision': 0.7300657835630934, 'recall': 0.38639029245623935, 'f1-score': 0.5053317146681058, 'support': 946398}, '2': {'precision': 0.3036156242968862, 'recall': 0.7799274909655611, 'f1-score': 0.4370812176097995, 'support': 342578}, 'accuracy': 0.455335616644614, 'macro avg': {'precision': 0.4907996918201935, 'recall': 0.49526306983366397, 'f1-score': 0.4373766971493156, 'support': 1627169}, 'weighted avg': {'precision': 0.5797283963323866, 'recall': 0.455335616644614, 'f1-score': 0.46277620128947256, 'support': 1627169}}
[[108043  92187 137963]
 [105854 365679 474865]
 [ 32373  43019 267186]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0091171
{'0': {'precision': 0.47029413142241583, 'recall': 0.30341679110209074, 'f1-score': 0.3688590456103187, 'support': 397127}, '1': {'precision': 0.6649923306420348, 'recall': 0.38003588243085407, 'f1-score': 0.4836633959233962, 'support': 830490}, '2': {'precision': 0.3407765571361792, 'recall': 0.7644862245715202, 'f1-score': 0.4714154640853836, 'support': 399552}, 'accuracy': 0.4557381562701846, 'macro avg': {'precision': 0.4920210064002099, 'recall': 0.482646299368155, 'f1-score': 0.44131263520636616, 'support': 1627169}, 'weighted avg': {'precision': 0.5378629590172673, 'recall': 0.4557381562701846, 'f1-score': 0.45263675217064336, 'support': 1627169}}
[[120495 103767 172865]
 [ 96850 315616 418024]
 [ 38867  55233 305452]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0324943
{'0': {'precision': 0.5053937137224839, 'recall': 0.2673982819526388, 'f1-score': 0.3497484744028551, 'support': 483223}, '1': {'precision': 0.5458024111476436, 'recall': 0.39390875945400305, 'f1-score': 0.4575796423586651, 'support': 663740}, '2': {'precision': 0.3880776625926075, 'recall': 0.721252962270359, 'f1-score': 0.5046325368876403, 'support': 480206}, 'accuracy': 0.452943732335117, 'macro avg': {'precision': 0.47975792915424503, 'recall': 0.46085333455900024, 'f1-score': 0.43732021788305353, 'support': 1627169}, 'weighted avg': {'precision': 0.48725484626624677, 'recall': 0.452943732335117, 'f1-score': 0.4394429778800957, 'support': 1627169}}
[[129213 133473 220537]
 [ 76698 261453 325589]
 [ 49757  84099 346350]]
Evaluating performance on  train set...
1701/1701 - 15s - 15s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9547718
{'0': {'precision': 0.3326715708484015, 'recall': 0.5982017212519812, 'f1-score': 0.4275656160337106, 'support': 67509}, '1': {'precision': 0.873532531177998, 'recall': 0.4012801989180471, 'f1-score': 0.5499338053301099, 'support': 297610}, '2': {'precision': 0.289560656477356, 'recall': 0.7303375581444971, 'f1-score': 0.4147022119551389, 'support': 70299}, 'accuracy': 0.4849386107143021, 'macro avg': {'precision': 0.49858825283458513, 'recall': 0.5766064927715084, 'f1-score': 0.4640672111063198, 'support': 435418}, 'weighted avg': {'precision': 0.6953919366447652, 'recall': 0.4849386107143021, 'f1-score': 0.5091279592836035, 'support': 435418}}
[[ 40384  10415  16710]
 [ 68927 119425 109258]
 [ 12082   6875  51342]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.95479554
{'0': {'precision': 0.4064634765316226, 'recall': 0.5505031722956603, 'f1-score': 0.4676431169825771, 'support': 88737}, '1': {'precision': 0.794717631011438, 'recall': 0.40799799697982114, 'f1-score': 0.5391851474629242, 'support': 255614}, '2': {'precision': 0.34920056954664525, 'recall': 0.7055794085673186, 'f1-score': 0.46718507450749436, 'support': 91067}, 'accuracy': 0.49927885388293547, 'macro avg': {'precision': 0.5167938923632353, 'recall': 0.5546935259476, 'f1-score': 0.49133777965099856, 'support': 435418}, 'weighted avg': {'precision': 0.622413290946283, 'recall': 0.49927885388293547, 'f1-score': 0.509546373221697, 'support': 435418}}
[[ 48850  15781  24106]
 [ 55679 104290  95645]
 [ 15654  11158  64255]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.964289
{'0': {'precision': 0.44208941966048165, 'recall': 0.5188170226730886, 'f1-score': 0.47738990261427167, 'support': 103603}, '1': {'precision': 0.7266533415821952, 'recall': 0.4049586046244359, 'f1-score': 0.5200802699887315, 'support': 226233}, '2': {'precision': 0.383913163893564, 'recall': 0.6827110681744994, 'f1-score': 0.4914603631305866, 'support': 105582}, 'accuracy': 0.4994005759982362, 'macro avg': {'precision': 0.5175519750454136, 'recall': 0.5354955651573413, 'f1-score': 0.49631017857786325, 'support': 435418}, 'weighted avg': {'precision': 0.5758353472788444, 'recall': 0.4994005759982362, 'f1-score': 0.5029826829872919, 'support': 435418}}
[[53751 19747 30105]
 [49049 91615 85569]
 [18784 14716 72082]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9897561
{'0': {'precision': 0.4807735162304702, 'recall': 0.4681954089506173, 'f1-score': 0.4744011043379469, 'support': 124416}, '1': {'precision': 0.6073830566076689, 'recall': 0.41448969086130755, 'f1-score': 0.4927306574938322, 'support': 184545}, '2': {'precision': 0.4266302039082413, 'recall': 0.6353384945080146, 'f1-score': 0.510475670077547, 'support': 126457}, 'accuracy': 0.4939759036144578, 'macro avg': {'precision': 0.5049289255821268, 'recall': 0.5060078647733132, 'f1-score': 0.4925358106364421, 'support': 435418}, 'weighted avg': {'precision': 0.5187102960204146, 'recall': 0.4939759036144578, 'f1-score': 0.49264681018126405, 'support': 435418}}
[[58251 27170 38995]
 [39071 76492 68982]
 [23839 22275 80343]]
Evaluating performance on  val set...
563/563 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.993714
{'0': {'precision': 0.33632170128482447, 'recall': 0.5790630889347572, 'f1-score': 0.42550736106302645, 'support': 22286}, '1': {'precision': 0.8712231131475118, 'recall': 0.3452498638206872, 'f1-score': 0.49452748538856667, 'support': 99134}, '2': {'precision': 0.2643254069846242, 'recall': 0.7752992623349088, 'f1-score': 0.3942409200152737, 'support': 22639}, 'accuracy': 0.4490035332745611, 'macro avg': {'precision': 0.4906234071389868, 'recall': 0.5665374050301177, 'f1-score': 0.43809192215562226, 'support': 144059}, 'weighted avg': {'precision': 0.6930990803929218, 'recall': 0.4490035332745611, 'f1-score': 0.4680899143641602, 'support': 144059}}
[[12905  3282  6099]
 [22156 34226 42752]
 [ 3310  1777 17552]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9888216
{'0': {'precision': 0.4106060204919118, 'recall': 0.5228222761596548, 'f1-score': 0.4599688589011641, 'support': 29664}, '1': {'precision': 0.7932205202234875, 'recall': 0.35064996454738834, 'f1-score': 0.48631860162095275, 'support': 84620}, '2': {'precision': 0.32665030995484967, 'recall': 0.7556675062972292, 'f1-score': 0.4561303924748621, 'support': 29775}, 'accuracy': 0.46981445102353897, 'macro avg': {'precision': 0.5101589502234164, 'recall': 0.5430465823347576, 'f1-score': 0.4674726176656597, 'support': 144059}, 'weighted avg': {'precision': 0.6180006135825546, 'recall': 0.46981445102353897, 'f1-score': 0.47465329299487136, 'support': 144059}}
[[15509  4892  9263]
 [17830 29672 37118]
 [ 4432  2843 22500]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.99359375
{'0': {'precision': 0.4485919759753431, 'recall': 0.4882447388038305, 'f1-score': 0.4675791814824476, 'support': 34878}, '1': {'precision': 0.7248350296387429, 'recall': 0.3486148466917698, 'f1-score': 0.4707965566089136, 'support': 74360}, '2': {'precision': 0.36289703415133506, 'recall': 0.73300594468855, 'f1-score': 0.4854548048119443, 'support': 34821}, 'accuracy': 0.47533302327518584, 'macro avg': {'precision': 0.5121080132551404, 'recall': 0.5232885100613834, 'f1-score': 0.4746101809677685, 'support': 144059}, 'weighted avg': {'precision': 0.570468775766794, 'recall': 0.47533302327518584, 'f1-score': 0.473560696655817, 'support': 144059}}
[[17029  5992 11857]
 [15484 25923 32953]
 [ 5448  3849 25524]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0113485
{'0': {'precision': 0.4833430897770209, 'recall': 0.43241763473624073, 'f1-score': 0.45646437994722955, 'support': 42008}, '1': {'precision': 0.6070823496736565, 'recall': 0.361959329668146, 'f1-score': 0.45351840901310264, 'support': 60388}, '2': {'precision': 0.4053382903848337, 'recall': 0.6856203345894438, 'f1-score': 0.5094751861595398, 'support': 41663}, 'accuracy': 0.476110482510638, 'macro avg': {'precision': 0.4985879099451704, 'recall': 0.49333243299794355, 'f1-score': 0.4731526583732906, 'support': 144059}, 'weighted avg': {'precision': 0.5126536671762902, 'recall': 0.476110482510638, 'f1-score': 0.4705606039002864, 'support': 144059}}
[[18165  8184 15659]
 [12282 21858 26248]
 [ 7135  5963 28565]]
training model: results/AAL/W5/deepOF_L1/seq2seq
Epoch 1/50
1701/1701 - 46s - loss: 12.5291 - accuracy10: 0.4167 - accuracy20: 0.4283 - accuracy30: 0.4321 - accuracy50: 0.4330 - val_loss: 13.1374 - val_accuracy10: 0.6373 - val_accuracy20: 0.5681 - val_accuracy30: 0.5149 - val_accuracy50: 0.4395 - 46s/epoch - 27ms/step
Epoch 2/50
1701/1701 - 41s - loss: 12.3890 - accuracy10: 0.4192 - accuracy20: 0.4333 - accuracy30: 0.4381 - accuracy50: 0.4373 - val_loss: 12.8316 - val_accuracy10: 0.5833 - val_accuracy20: 0.5371 - val_accuracy30: 0.4967 - val_accuracy50: 0.4388 - 41s/epoch - 24ms/step
Epoch 3/50
1701/1701 - 40s - loss: 12.2938 - accuracy10: 0.4311 - accuracy20: 0.4433 - accuracy30: 0.4470 - accuracy50: 0.4430 - val_loss: 12.6539 - val_accuracy10: 0.5966 - val_accuracy20: 0.5506 - val_accuracy30: 0.5101 - val_accuracy50: 0.4486 - 40s/epoch - 23ms/step
Epoch 4/50
1701/1701 - 43s - loss: 12.2124 - accuracy10: 0.4518 - accuracy20: 0.4563 - accuracy30: 0.4567 - accuracy50: 0.4504 - val_loss: 12.6374 - val_accuracy10: 0.5883 - val_accuracy20: 0.5423 - val_accuracy30: 0.5043 - val_accuracy50: 0.4479 - 43s/epoch - 25ms/step
Epoch 5/50
1701/1701 - 44s - loss: 12.1454 - accuracy10: 0.4633 - accuracy20: 0.4660 - accuracy30: 0.4651 - accuracy50: 0.4566 - val_loss: 12.6194 - val_accuracy10: 0.5963 - val_accuracy20: 0.5503 - val_accuracy30: 0.5109 - val_accuracy50: 0.4522 - 44s/epoch - 26ms/step
Epoch 6/50
1701/1701 - 44s - loss: 12.0942 - accuracy10: 0.4770 - accuracy20: 0.4753 - accuracy30: 0.4714 - accuracy50: 0.4607 - val_loss: 12.5512 - val_accuracy10: 0.5983 - val_accuracy20: 0.5518 - val_accuracy30: 0.5129 - val_accuracy50: 0.4538 - 44s/epoch - 26ms/step
Epoch 7/50
1701/1701 - 43s - loss: 12.0417 - accuracy10: 0.4874 - accuracy20: 0.4841 - accuracy30: 0.4790 - accuracy50: 0.4661 - val_loss: 12.5471 - val_accuracy10: 0.5973 - val_accuracy20: 0.5511 - val_accuracy30: 0.5127 - val_accuracy50: 0.4553 - 43s/epoch - 25ms/step
Epoch 8/50
1701/1701 - 43s - loss: 11.9941 - accuracy10: 0.4932 - accuracy20: 0.4888 - accuracy30: 0.4821 - accuracy50: 0.4684 - val_loss: 12.5200 - val_accuracy10: 0.5895 - val_accuracy20: 0.5452 - val_accuracy30: 0.5084 - val_accuracy50: 0.4544 - 43s/epoch - 25ms/step
Epoch 9/50
1701/1701 - 40s - loss: 11.9522 - accuracy10: 0.4964 - accuracy20: 0.4923 - accuracy30: 0.4858 - accuracy50: 0.4716 - val_loss: 12.4585 - val_accuracy10: 0.5762 - val_accuracy20: 0.5352 - val_accuracy30: 0.5038 - val_accuracy50: 0.4540 - 40s/epoch - 24ms/step
Epoch 10/50
1701/1701 - 43s - loss: 11.9076 - accuracy10: 0.4990 - accuracy20: 0.4954 - accuracy30: 0.4894 - accuracy50: 0.4745 - val_loss: 12.4383 - val_accuracy10: 0.5827 - val_accuracy20: 0.5388 - val_accuracy30: 0.5066 - val_accuracy50: 0.4564 - 43s/epoch - 25ms/step
Epoch 11/50
1701/1701 - 44s - loss: 11.8661 - accuracy10: 0.5006 - accuracy20: 0.4973 - accuracy30: 0.4910 - accuracy50: 0.4765 - val_loss: 12.4344 - val_accuracy10: 0.5694 - val_accuracy20: 0.5292 - val_accuracy30: 0.4998 - val_accuracy50: 0.4556 - 44s/epoch - 26ms/step
Epoch 12/50
1701/1701 - 44s - loss: 11.8217 - accuracy10: 0.5008 - accuracy20: 0.5001 - accuracy30: 0.4946 - accuracy50: 0.4794 - val_loss: 12.3675 - val_accuracy10: 0.5602 - val_accuracy20: 0.5237 - val_accuracy30: 0.4966 - val_accuracy50: 0.4569 - 44s/epoch - 26ms/step
Epoch 13/50
1701/1701 - 38s - loss: 11.7757 - accuracy10: 0.5028 - accuracy20: 0.5027 - accuracy30: 0.4964 - accuracy50: 0.4818 - val_loss: 12.3862 - val_accuracy10: 0.5435 - val_accuracy20: 0.5114 - val_accuracy30: 0.4874 - val_accuracy50: 0.4525 - 38s/epoch - 23ms/step
Epoch 14/50
1701/1701 - 43s - loss: 11.7374 - accuracy10: 0.5046 - accuracy20: 0.5044 - accuracy30: 0.4987 - accuracy50: 0.4840 - val_loss: 12.3753 - val_accuracy10: 0.5494 - val_accuracy20: 0.5177 - val_accuracy30: 0.4925 - val_accuracy50: 0.4563 - 43s/epoch - 25ms/step
Epoch 15/50
1701/1701 - 42s - loss: 11.6968 - accuracy10: 0.5074 - accuracy20: 0.5068 - accuracy30: 0.5004 - accuracy50: 0.4857 - val_loss: 12.4025 - val_accuracy10: 0.5502 - val_accuracy20: 0.5188 - val_accuracy30: 0.4929 - val_accuracy50: 0.4562 - 42s/epoch - 25ms/step
Epoch 16/50
1701/1701 - 43s - loss: 11.6593 - accuracy10: 0.5101 - accuracy20: 0.5106 - accuracy30: 0.5042 - accuracy50: 0.4886 - val_loss: 12.3425 - val_accuracy10: 0.5430 - val_accuracy20: 0.5153 - val_accuracy30: 0.4935 - val_accuracy50: 0.4588 - 43s/epoch - 25ms/step
Epoch 17/50
1701/1701 - 44s - loss: 11.6202 - accuracy10: 0.5118 - accuracy20: 0.5122 - accuracy30: 0.5064 - accuracy50: 0.4916 - val_loss: 12.3461 - val_accuracy10: 0.5519 - val_accuracy20: 0.5226 - val_accuracy30: 0.4969 - val_accuracy50: 0.4601 - 44s/epoch - 26ms/step
Epoch 18/50
1701/1701 - 43s - loss: 11.5887 - accuracy10: 0.5131 - accuracy20: 0.5141 - accuracy30: 0.5080 - accuracy50: 0.4924 - val_loss: 12.3308 - val_accuracy10: 0.5424 - val_accuracy20: 0.5149 - val_accuracy30: 0.4924 - val_accuracy50: 0.4598 - 43s/epoch - 25ms/step
Epoch 19/50
1701/1701 - 44s - loss: 11.5539 - accuracy10: 0.5159 - accuracy20: 0.5169 - accuracy30: 0.5105 - accuracy50: 0.4953 - val_loss: 12.3666 - val_accuracy10: 0.5492 - val_accuracy20: 0.5186 - val_accuracy30: 0.4943 - val_accuracy50: 0.4595 - 44s/epoch - 26ms/step
Epoch 20/50
1701/1701 - 43s - loss: 11.5257 - accuracy10: 0.5184 - accuracy20: 0.5192 - accuracy30: 0.5123 - accuracy50: 0.4966 - val_loss: 12.3551 - val_accuracy10: 0.5522 - val_accuracy20: 0.5200 - val_accuracy30: 0.4961 - val_accuracy50: 0.4621 - 43s/epoch - 25ms/step
Epoch 21/50
1701/1701 - 39s - loss: 11.4969 - accuracy10: 0.5188 - accuracy20: 0.5197 - accuracy30: 0.5134 - accuracy50: 0.4980 - val_loss: 12.3651 - val_accuracy10: 0.5417 - val_accuracy20: 0.5143 - val_accuracy30: 0.4926 - val_accuracy50: 0.4611 - 39s/epoch - 23ms/step
Epoch 22/50
1701/1701 - 42s - loss: 11.4718 - accuracy10: 0.5202 - accuracy20: 0.5213 - accuracy30: 0.5148 - accuracy50: 0.4992 - val_loss: 12.3863 - val_accuracy10: 0.5362 - val_accuracy20: 0.5103 - val_accuracy30: 0.4893 - val_accuracy50: 0.4595 - 42s/epoch - 24ms/step
Epoch 23/50
1701/1701 - 41s - loss: 11.4393 - accuracy10: 0.5216 - accuracy20: 0.5229 - accuracy30: 0.5164 - accuracy50: 0.5012 - val_loss: 12.3541 - val_accuracy10: 0.5299 - val_accuracy20: 0.5068 - val_accuracy30: 0.4886 - val_accuracy50: 0.4604 - 41s/epoch - 24ms/step
Epoch 24/50
1701/1701 - 44s - loss: 11.4043 - accuracy10: 0.5230 - accuracy20: 0.5251 - accuracy30: 0.5190 - accuracy50: 0.5027 - val_loss: 12.3792 - val_accuracy10: 0.5336 - val_accuracy20: 0.5080 - val_accuracy30: 0.4882 - val_accuracy50: 0.4600 - 44s/epoch - 26ms/step
Epoch 25/50
1701/1701 - 44s - loss: 11.3851 - accuracy10: 0.5232 - accuracy20: 0.5258 - accuracy30: 0.5196 - accuracy50: 0.5044 - val_loss: 12.3856 - val_accuracy10: 0.5302 - val_accuracy20: 0.5059 - val_accuracy30: 0.4877 - val_accuracy50: 0.4594 - 44s/epoch - 26ms/step
Epoch 26/50
1701/1701 - 46s - loss: 11.3660 - accuracy10: 0.5257 - accuracy20: 0.5272 - accuracy30: 0.5211 - accuracy50: 0.5057 - val_loss: 12.3837 - val_accuracy10: 0.5321 - val_accuracy20: 0.5055 - val_accuracy30: 0.4873 - val_accuracy50: 0.4589 - 46s/epoch - 27ms/step
Epoch 27/50
1701/1701 - 46s - loss: 11.3401 - accuracy10: 0.5258 - accuracy20: 0.5272 - accuracy30: 0.5216 - accuracy50: 0.5076 - val_loss: 12.3270 - val_accuracy10: 0.5284 - val_accuracy20: 0.5048 - val_accuracy30: 0.4868 - val_accuracy50: 0.4599 - 46s/epoch - 27ms/step
Epoch 28/50
1701/1701 - 45s - loss: 11.3089 - accuracy10: 0.5277 - accuracy20: 0.5296 - accuracy30: 0.5230 - accuracy50: 0.5081 - val_loss: 12.3542 - val_accuracy10: 0.5268 - val_accuracy20: 0.5039 - val_accuracy30: 0.4869 - val_accuracy50: 0.4600 - 45s/epoch - 26ms/step
Epoch 29/50
1701/1701 - 39s - loss: 11.2887 - accuracy10: 0.5296 - accuracy20: 0.5316 - accuracy30: 0.5254 - accuracy50: 0.5102 - val_loss: 12.3600 - val_accuracy10: 0.5236 - val_accuracy20: 0.5015 - val_accuracy30: 0.4845 - val_accuracy50: 0.4599 - 39s/epoch - 23ms/step
Epoch 30/50
1701/1701 - 42s - loss: 11.2636 - accuracy10: 0.5307 - accuracy20: 0.5325 - accuracy30: 0.5263 - accuracy50: 0.5113 - val_loss: 12.3591 - val_accuracy10: 0.5119 - val_accuracy20: 0.4893 - val_accuracy30: 0.4754 - val_accuracy50: 0.4547 - 42s/epoch - 25ms/step
Epoch 31/50
1701/1701 - 39s - loss: 11.2427 - accuracy10: 0.5320 - accuracy20: 0.5338 - accuracy30: 0.5279 - accuracy50: 0.5126 - val_loss: 12.3217 - val_accuracy10: 0.5192 - val_accuracy20: 0.4990 - val_accuracy30: 0.4840 - val_accuracy50: 0.4602 - 39s/epoch - 23ms/step
Epoch 32/50
1701/1701 - 42s - loss: 11.2203 - accuracy10: 0.5324 - accuracy20: 0.5346 - accuracy30: 0.5288 - accuracy50: 0.5139 - val_loss: 12.3694 - val_accuracy10: 0.5154 - val_accuracy20: 0.4946 - val_accuracy30: 0.4803 - val_accuracy50: 0.4573 - 42s/epoch - 25ms/step
Epoch 33/50
1701/1701 - 40s - loss: 11.1918 - accuracy10: 0.5360 - accuracy20: 0.5370 - accuracy30: 0.5308 - accuracy50: 0.5153 - val_loss: 12.3241 - val_accuracy10: 0.5157 - val_accuracy20: 0.4970 - val_accuracy30: 0.4829 - val_accuracy50: 0.4581 - 40s/epoch - 24ms/step
Epoch 34/50
1701/1701 - 39s - loss: 11.1760 - accuracy10: 0.5355 - accuracy20: 0.5381 - accuracy30: 0.5315 - accuracy50: 0.5171 - val_loss: 12.3292 - val_accuracy10: 0.5097 - val_accuracy20: 0.4915 - val_accuracy30: 0.4783 - val_accuracy50: 0.4582 - 39s/epoch - 23ms/step
Epoch 35/50
1701/1701 - 40s - loss: 11.1483 - accuracy10: 0.5369 - accuracy20: 0.5387 - accuracy30: 0.5336 - accuracy50: 0.5186 - val_loss: 12.3452 - val_accuracy10: 0.5236 - val_accuracy20: 0.5022 - val_accuracy30: 0.4856 - val_accuracy50: 0.4606 - 40s/epoch - 23ms/step
Epoch 36/50
1701/1701 - 38s - loss: 11.1284 - accuracy10: 0.5383 - accuracy20: 0.5406 - accuracy30: 0.5341 - accuracy50: 0.5195 - val_loss: 12.3235 - val_accuracy10: 0.5104 - val_accuracy20: 0.4901 - val_accuracy30: 0.4759 - val_accuracy50: 0.4563 - 38s/epoch - 22ms/step
Epoch 37/50
1701/1701 - 43s - loss: 11.1037 - accuracy10: 0.5391 - accuracy20: 0.5411 - accuracy30: 0.5350 - accuracy50: 0.5200 - val_loss: 12.3533 - val_accuracy10: 0.5055 - val_accuracy20: 0.4864 - val_accuracy30: 0.4735 - val_accuracy50: 0.4540 - 43s/epoch - 25ms/step
Epoch 38/50
1701/1701 - 41s - loss: 11.0880 - accuracy10: 0.5393 - accuracy20: 0.5421 - accuracy30: 0.5363 - accuracy50: 0.5213 - val_loss: 12.3402 - val_accuracy10: 0.5142 - val_accuracy20: 0.4938 - val_accuracy30: 0.4802 - val_accuracy50: 0.4592 - 41s/epoch - 24ms/step
Epoch 39/50
1701/1701 - 41s - loss: 11.0694 - accuracy10: 0.5401 - accuracy20: 0.5430 - accuracy30: 0.5370 - accuracy50: 0.5223 - val_loss: 12.3687 - val_accuracy10: 0.5167 - val_accuracy20: 0.4953 - val_accuracy30: 0.4813 - val_accuracy50: 0.4595 - 41s/epoch - 24ms/step
Epoch 40/50
1701/1701 - 41s - loss: 11.0315 - accuracy10: 0.5411 - accuracy20: 0.5448 - accuracy30: 0.5392 - accuracy50: 0.5240 - val_loss: 12.3678 - val_accuracy10: 0.4988 - val_accuracy20: 0.4821 - val_accuracy30: 0.4713 - val_accuracy50: 0.4546 - 41s/epoch - 24ms/step
Epoch 41/50
1701/1701 - 41s - loss: 11.0286 - accuracy10: 0.5419 - accuracy20: 0.5448 - accuracy30: 0.5384 - accuracy50: 0.5240 - val_loss: 12.4401 - val_accuracy10: 0.5252 - val_accuracy20: 0.5003 - val_accuracy30: 0.4833 - val_accuracy50: 0.4569 - 41s/epoch - 24ms/step
testing model: results/AAL/W5/deepOF_L1/seq2seq
Evaluating performance on  test set...
6357/6357 - 62s - 62s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.995103
{'0': {'precision': 0.2774572923295619, 'recall': 0.5210295966352645, 'f1-score': 0.36209351237663806, 'support': 257732}, '1': {'precision': 0.7882967980277087, 'recall': 0.474809252755238, 'f1-score': 0.5926511291571693, 'support': 1106438}, '2': {'precision': 0.2853214415313911, 'recall': 0.5172171228240948, 'f1-score': 0.3677658411029866, 'support': 262994}, 'accuracy': 0.48898451538996685, 'macro avg': {'precision': 0.45035851062955395, 'recall': 0.5043519907381991, 'f1-score': 0.440836827545598, 'support': 1627164}, 'weighted avg': {'precision': 0.6260886933812273, 'recall': 0.48898451538996685, 'f1-score': 0.5197847449853208, 'support': 1627164}}
[[134286  69009  54437]
 [294810 525347 286281]
 [ 54892  72077 136025]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0166476
{'0': {'precision': 0.3355616555053361, 'recall': 0.5031683466937127, 'f1-score': 0.40261825133651247, 'support': 338189}, '1': {'precision': 0.7021076168708509, 'recall': 0.4489009909150273, 'f1-score': 0.5476532543898152, 'support': 946398}, '2': {'precision': 0.3402852621051916, 'recall': 0.511520037830911, 'f1-score': 0.4086913527267469, 'support': 342577}, 'accuracy': 0.4733634716598941, 'macro avg': {'precision': 0.45931817816045956, 'recall': 0.48786312514655034, 'f1-score': 0.4529876194843581, 'support': 1627164}, 'weighted avg': {'precision': 0.54974815651111, 'recall': 0.4733634716598941, 'f1-score': 0.4882527305129212, 'support': 1627164}}
[[170166  88408  79615]
 [261444 424839 260115]
 [ 75498  91844 175235]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0331954
{'0': {'precision': 0.3732801841528908, 'recall': 0.47938930913266387, 'f1-score': 0.41973245437558904, 'support': 397124}, '1': {'precision': 0.6288846649216835, 'recall': 0.437427301954268, 'f1-score': 0.5159678044748202, 'support': 830490}, '2': {'precision': 0.37169437457483545, 'recall': 0.5018846201977224, 'f1-score': 0.4270883140034524, 'support': 399550}, 'accuracy': 0.4634959967157582, 'macro avg': {'precision': 0.4579530745498032, 'recall': 0.472900410428218, 'f1-score': 0.4542628576179539, 'support': 1627164}, 'weighted avg': {'precision': 0.5033490370876673, 'recall': 0.4634959967157582, 'f1-score': 0.47065634994986627, 'support': 1627164}}
[[190377 105226 101521]
 [229763 363279 237448]
 [ 89871 109151 200528]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.057751
{'0': {'precision': 0.42121832680222404, 'recall': 0.4333234689717541, 'f1-score': 0.42718515926795997, 'support': 483221}, '1': {'precision': 0.5077397921507492, 'recall': 0.43818880614217337, 'f1-score': 0.47040737272331745, 'support': 663739}, '2': {'precision': 0.4079323519436075, 'recall': 0.47337173367985275, 'f1-score': 0.43822251096688875, 'support': 480204}, 'accuracy': 0.4471270259174859, 'macro avg': {'precision': 0.44563015696552694, 'recall': 0.4482946695979268, 'f1-score': 0.44527168098605535, 'support': 1627164}, 'weighted avg': {'precision': 0.45259051339064266, 'recall': 0.4471270259174859, 'f1-score': 0.44807331139760265, 'support': 1627164}}
[[209391 139711 134119]
 [177093 290843 195803]
 [110624 142265 227315]]
Evaluating performance on  train set...
1701/1701 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9147635
{'0': {'precision': 0.3032360602180919, 'recall': 0.5089058147116353, 'f1-score': 0.3800286601120953, 'support': 67484}, '1': {'precision': 0.7824580533961799, 'recall': 0.5976029524855347, 'f1-score': 0.6776501051950153, 'support': 297783}, '2': {'precision': 0.3285302593659942, 'recall': 0.4436429986742883, 'f1-score': 0.37750633786586774, 'support': 70151}, 'accuracy': 0.5590513024266337, 'macro avg': {'precision': 0.4714081243267554, 'recall': 0.5167172552904861, 'f1-score': 0.4783950343909928, 'support': 435418}, 'weighted avg': {'precision': 0.6350518697596705, 'recall': 0.5590513024266337, 'f1-score': 0.5831660208854949, 'support': 435418}}
[[ 34343  22757  10384]
 [ 66602 177956  53225]
 [ 12310  26719  31122]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9455793
{'0': {'precision': 0.3704984202081024, 'recall': 0.5052505724308289, 'f1-score': 0.4275072891166688, 'support': 88657}, '1': {'precision': 0.7002878695751311, 'recall': 0.576616783096432, 'f1-score': 0.6324634149480667, 'support': 255662}, '2': {'precision': 0.38605245952078765, 'recall': 0.4407402935268225, 'f1-score': 0.41158772545783506, 'support': 91099}, 'accuracy': 0.5336573132024859, 'macro avg': {'precision': 0.4856129164346737, 'recall': 0.5075358830180278, 'f1-score': 0.49051947650752353, 'support': 435418}, 'weighted avg': {'precision': 0.5673933295398701, 'recall': 0.5336573132024859, 'f1-score': 0.5445195318639846, 'support': 435418}}
[[ 44794  29199  14664]
 [ 59054 147419  49189]
 [ 17054  33894  40151]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.97239864
{'0': {'precision': 0.41175896242534704, 'recall': 0.4886777330359126, 'f1-score': 0.44693299890929483, 'support': 103557}, '1': {'precision': 0.6323619480391188, 'recall': 0.5657245877299963, 'f1-score': 0.5971900888125979, 'support': 226308}, '2': {'precision': 0.41557025514283635, 'recall': 0.4332989114473298, 'f1-score': 0.4242494515535066, 'support': 105553}, 'accuracy': 0.5152979435852445, 'macro avg': {'precision': 0.4865637218691008, 'recall': 0.49590041073774627, 'f1-score': 0.4894575130917998, 'support': 435418}, 'weighted avg': {'precision': 0.5273410326394645, 'recall': 0.5152979435852445, 'f1-score': 0.519530055135246, 'support': 435418}}
[[ 50606  34611  18340]
 [ 52300 128028  45980]
 [ 19996  39821  45736]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0133433
{'0': {'precision': 0.4559231165037263, 'recall': 0.44191321974998793, 'f1-score': 0.4488088624554753, 'support': 124314}, '1': {'precision': 0.5191852132022137, 'recall': 0.5647598269823139, 'f1-score': 0.5410144247349328, 'support': 184721}, '2': {'precision': 0.4490209495736393, 'recall': 0.4049832651543325, 'f1-score': 0.4258666810888168, 'support': 126383}, 'accuracy': 0.48331029034169465, 'macro avg': {'precision': 0.47470975975985974, 'recall': 0.47055210396221137, 'f1-score': 0.4718966560930749, 'support': 435418}, 'weighted avg': {'precision': 0.4807579216820058, 'recall': 0.48331029034169465, 'f1-score': 0.48126687283208186, 'support': 435418}}
[[ 54936  45581  23797]
 [ 41390 104323  39008]
 [ 24168  51032  51183]]
Evaluating performance on  val set...
563/563 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9594196
{'0': {'precision': 0.2800692383778437, 'recall': 0.5070056851246698, 'f1-score': 0.3608212937447235, 'support': 22339}, '1': {'precision': 0.7818352338702474, 'recall': 0.530275340515544, 'f1-score': 0.6319405589146587, 'support': 99041}, '2': {'precision': 0.2962160085613149, 'recall': 0.47603298496273755, 'f1-score': 0.3651894451962111, 'support': 22677}, 'accuracy': 0.5181282409046419, 'macro avg': {'precision': 0.4527068269364687, 'recall': 0.5044380035343171, 'f1-score': 0.45265043261853116, 'support': 144057}, 'weighted avg': {'precision': 0.6275814472050006, 'recall': 0.5181282409046419, 'f1-score': 0.5479068203915435, 'support': 144057}}
[[11326  7096  3917]
 [24791 52519 21731]
 [ 4323  7559 10795]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.98695874
{'0': {'precision': 0.34506943797185197, 'recall': 0.4985523835173714, 'f1-score': 0.40784907738914894, 'support': 29704}, '1': {'precision': 0.6993061919099358, 'recall': 0.5051536643026004, 'f1-score': 0.5865817503019655, 'support': 84600}, '2': {'precision': 0.35164505733343326, 'recall': 0.4730951500689006, 'f1-score': 0.40342781806196437, 'support': 29753}, 'accuracy': 0.4971712585990268, 'macro avg': {'precision': 0.46534022907174033, 'recall': 0.4922670659629575, 'f1-score': 0.46595288191769296, 'support': 144057}, 'weighted avg': {'precision': 0.5544592891142958, 'recall': 0.4971712585990268, 'f1-score': 0.5118998239662855, 'support': 144057}}
[[14809  8898  5997]
 [21908 42736 19956]
 [ 6199  9478 14076]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.009417
{'0': {'precision': 0.3856888704050276, 'recall': 0.477871292797435, 'f1-score': 0.42685998491299404, 'support': 34932}, '1': {'precision': 0.6294531543532466, 'recall': 0.49560961179017576, 'f1-score': 0.5545700077489637, 'support': 74367}, '2': {'precision': 0.38288096253138176, 'recall': 0.46510155935324243, 'f1-score': 0.42000519615484544, 'support': 34758}, 'accuracy': 0.48394732640552, 'macro avg': {'precision': 0.4660076624298853, 'recall': 0.4795274879802844, 'f1-score': 0.46714506293893443, 'support': 144057}, 'weighted avg': {'precision': 0.5108505858545026, 'recall': 0.48394732640552, 'f1-score': 0.49113421331277207, 'support': 144057}}
[[16693 10561  7678]
 [19132 36857 18378]
 [ 7456 11136 16166]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0426832
{'0': {'precision': 0.42887594145232344, 'recall': 0.43034364751176385, 'f1-score': 0.42960854092526696, 'support': 42078}, '1': {'precision': 0.5158923785306851, 'recall': 0.49756412805726785, 'f1-score': 0.5065625210877926, 'support': 60348}, '2': {'precision': 0.41672205541931195, 'recall': 0.43674185102447693, 'f1-score': 0.42649714996129573, 'support': 41631}, 'accuracy': 0.4603524993578931, 'macro avg': {'precision': 0.45383012513410687, 'recall': 0.4548832088645029, 'f1-score': 0.45422273732478513, 'support': 144057}, 'weighted avg': {'precision': 0.46181630197187246, 'recall': 0.4603524993578931, 'f1-score': 0.4609467506452182, 'support': 144057}}
[[18108 13829 10141]
 [15013 30027 15308]
 [ 9101 14348 18182]]
training model: results/AAL/W5/deepLOB_L2/seq2seq
Epoch 1/50
1701/1701 - 87s - loss: 11.9574 - accuracy10: 0.4422 - accuracy20: 0.4595 - accuracy30: 0.4654 - accuracy50: 0.4651 - val_loss: 13.3889 - val_accuracy10: 0.6087 - val_accuracy20: 0.5382 - val_accuracy30: 0.4844 - val_accuracy50: 0.4110 - 87s/epoch - 51ms/step
Epoch 2/50
1701/1701 - 81s - loss: 11.5591 - accuracy10: 0.4566 - accuracy20: 0.4799 - accuracy30: 0.4886 - accuracy50: 0.4882 - val_loss: 12.2637 - val_accuracy10: 0.4003 - val_accuracy20: 0.3979 - val_accuracy30: 0.3948 - val_accuracy50: 0.4064 - 81s/epoch - 47ms/step
Epoch 3/50
1701/1701 - 80s - loss: 10.9873 - accuracy10: 0.5512 - accuracy20: 0.5542 - accuracy30: 0.5461 - accuracy50: 0.5251 - val_loss: 11.8068 - val_accuracy10: 0.6176 - val_accuracy20: 0.5837 - val_accuracy30: 0.5508 - val_accuracy50: 0.4956 - 80s/epoch - 47ms/step
Epoch 4/50
1701/1701 - 81s - loss: 10.5025 - accuracy10: 0.6045 - accuracy20: 0.5954 - accuracy30: 0.5788 - accuracy50: 0.5456 - val_loss: 11.3107 - val_accuracy10: 0.5706 - val_accuracy20: 0.5634 - val_accuracy30: 0.5496 - val_accuracy50: 0.5135 - 81s/epoch - 48ms/step
Epoch 5/50
1701/1701 - 81s - loss: 10.2902 - accuracy10: 0.6188 - accuracy20: 0.6068 - accuracy30: 0.5893 - accuracy50: 0.5539 - val_loss: 10.9131 - val_accuracy10: 0.5456 - val_accuracy20: 0.5475 - val_accuracy30: 0.5382 - val_accuracy50: 0.5133 - 81s/epoch - 48ms/step
Epoch 6/50
1701/1701 - 81s - loss: 10.1643 - accuracy10: 0.6245 - accuracy20: 0.6115 - accuracy30: 0.5936 - accuracy50: 0.5586 - val_loss: 10.8376 - val_accuracy10: 0.5922 - val_accuracy20: 0.5828 - val_accuracy30: 0.5652 - val_accuracy50: 0.5270 - 81s/epoch - 47ms/step
Epoch 7/50
1701/1701 - 80s - loss: 10.0682 - accuracy10: 0.6279 - accuracy20: 0.6154 - accuracy30: 0.5971 - accuracy50: 0.5618 - val_loss: 10.7500 - val_accuracy10: 0.6113 - val_accuracy20: 0.5971 - val_accuracy30: 0.5757 - val_accuracy50: 0.5344 - 80s/epoch - 47ms/step
Epoch 8/50
1701/1701 - 80s - loss: 10.0073 - accuracy10: 0.6302 - accuracy20: 0.6179 - accuracy30: 0.5999 - accuracy50: 0.5644 - val_loss: 10.7472 - val_accuracy10: 0.5796 - val_accuracy20: 0.5754 - val_accuracy30: 0.5610 - val_accuracy50: 0.5272 - 80s/epoch - 47ms/step
Epoch 9/50
1701/1701 - 82s - loss: 9.9604 - accuracy10: 0.6318 - accuracy20: 0.6190 - accuracy30: 0.6011 - accuracy50: 0.5658 - val_loss: 10.6776 - val_accuracy10: 0.6047 - val_accuracy20: 0.5949 - val_accuracy30: 0.5768 - val_accuracy50: 0.5361 - 82s/epoch - 48ms/step
Epoch 10/50
1701/1701 - 82s - loss: 9.9154 - accuracy10: 0.6338 - accuracy20: 0.6215 - accuracy30: 0.6035 - accuracy50: 0.5678 - val_loss: 10.6736 - val_accuracy10: 0.6045 - val_accuracy20: 0.5935 - val_accuracy30: 0.5736 - val_accuracy50: 0.5323 - 82s/epoch - 48ms/step
Epoch 11/50
1701/1701 - 81s - loss: 9.8833 - accuracy10: 0.6352 - accuracy20: 0.6230 - accuracy30: 0.6051 - accuracy50: 0.5689 - val_loss: 10.8544 - val_accuracy10: 0.5937 - val_accuracy20: 0.5841 - val_accuracy30: 0.5661 - val_accuracy50: 0.5265 - 81s/epoch - 48ms/step
Epoch 12/50
1701/1701 - 80s - loss: 9.8510 - accuracy10: 0.6366 - accuracy20: 0.6244 - accuracy30: 0.6059 - accuracy50: 0.5700 - val_loss: 10.6859 - val_accuracy10: 0.5692 - val_accuracy20: 0.5701 - val_accuracy30: 0.5591 - val_accuracy50: 0.5282 - 80s/epoch - 47ms/step
Epoch 13/50
1701/1701 - 81s - loss: 9.8236 - accuracy10: 0.6377 - accuracy20: 0.6256 - accuracy30: 0.6076 - accuracy50: 0.5712 - val_loss: 10.8829 - val_accuracy10: 0.5671 - val_accuracy20: 0.5673 - val_accuracy30: 0.5560 - val_accuracy50: 0.5248 - 81s/epoch - 48ms/step
Epoch 14/50
1701/1701 - 81s - loss: 9.7934 - accuracy10: 0.6392 - accuracy20: 0.6275 - accuracy30: 0.6087 - accuracy50: 0.5723 - val_loss: 10.8643 - val_accuracy10: 0.5607 - val_accuracy20: 0.5622 - val_accuracy30: 0.5527 - val_accuracy50: 0.5239 - 81s/epoch - 47ms/step
Epoch 15/50
1701/1701 - 80s - loss: 9.7699 - accuracy10: 0.6395 - accuracy20: 0.6274 - accuracy30: 0.6095 - accuracy50: 0.5737 - val_loss: 10.7976 - val_accuracy10: 0.5567 - val_accuracy20: 0.5601 - val_accuracy30: 0.5515 - val_accuracy50: 0.5241 - 80s/epoch - 47ms/step
Epoch 16/50
1701/1701 - 80s - loss: 9.7439 - accuracy10: 0.6395 - accuracy20: 0.6279 - accuracy30: 0.6105 - accuracy50: 0.5749 - val_loss: 10.7296 - val_accuracy10: 0.5842 - val_accuracy20: 0.5817 - val_accuracy30: 0.5674 - val_accuracy50: 0.5325 - 80s/epoch - 47ms/step
Epoch 17/50
1701/1701 - 80s - loss: 9.7210 - accuracy10: 0.6408 - accuracy20: 0.6294 - accuracy30: 0.6113 - accuracy50: 0.5758 - val_loss: 10.7173 - val_accuracy10: 0.5821 - val_accuracy20: 0.5799 - val_accuracy30: 0.5668 - val_accuracy50: 0.5319 - 80s/epoch - 47ms/step
Epoch 18/50
1701/1701 - 80s - loss: 9.6934 - accuracy10: 0.6415 - accuracy20: 0.6308 - accuracy30: 0.6127 - accuracy50: 0.5769 - val_loss: 10.6364 - val_accuracy10: 0.6014 - val_accuracy20: 0.5946 - val_accuracy30: 0.5777 - val_accuracy50: 0.5394 - 80s/epoch - 47ms/step
Epoch 19/50
1701/1701 - 80s - loss: 9.6753 - accuracy10: 0.6415 - accuracy20: 0.6310 - accuracy30: 0.6131 - accuracy50: 0.5778 - val_loss: 10.7518 - val_accuracy10: 0.5891 - val_accuracy20: 0.5858 - val_accuracy30: 0.5718 - val_accuracy50: 0.5371 - 80s/epoch - 47ms/step
Epoch 20/50
1701/1701 - 79s - loss: 9.6501 - accuracy10: 0.6432 - accuracy20: 0.6320 - accuracy30: 0.6143 - accuracy50: 0.5787 - val_loss: 10.9187 - val_accuracy10: 0.5643 - val_accuracy20: 0.5655 - val_accuracy30: 0.5554 - val_accuracy50: 0.5265 - 79s/epoch - 47ms/step
Epoch 21/50
1701/1701 - 80s - loss: 9.6264 - accuracy10: 0.6435 - accuracy20: 0.6334 - accuracy30: 0.6154 - accuracy50: 0.5797 - val_loss: 11.2592 - val_accuracy10: 0.5352 - val_accuracy20: 0.5413 - val_accuracy30: 0.5364 - val_accuracy50: 0.5148 - 80s/epoch - 47ms/step
Epoch 22/50
1701/1701 - 80s - loss: 9.6096 - accuracy10: 0.6439 - accuracy20: 0.6335 - accuracy30: 0.6155 - accuracy50: 0.5804 - val_loss: 11.1053 - val_accuracy10: 0.5518 - val_accuracy20: 0.5547 - val_accuracy30: 0.5455 - val_accuracy50: 0.5192 - 80s/epoch - 47ms/step
Epoch 23/50
1701/1701 - 80s - loss: 9.5815 - accuracy10: 0.6448 - accuracy20: 0.6352 - accuracy30: 0.6172 - accuracy50: 0.5822 - val_loss: 10.9338 - val_accuracy10: 0.5982 - val_accuracy20: 0.5872 - val_accuracy30: 0.5684 - val_accuracy50: 0.5305 - 80s/epoch - 47ms/step
Epoch 24/50
1701/1701 - 80s - loss: 9.5615 - accuracy10: 0.6448 - accuracy20: 0.6353 - accuracy30: 0.6181 - accuracy50: 0.5829 - val_loss: 10.9247 - val_accuracy10: 0.5742 - val_accuracy20: 0.5711 - val_accuracy30: 0.5575 - val_accuracy50: 0.5264 - 80s/epoch - 47ms/step
Epoch 25/50
1701/1701 - 80s - loss: 9.5462 - accuracy10: 0.6443 - accuracy20: 0.6360 - accuracy30: 0.6182 - accuracy50: 0.5834 - val_loss: 10.9696 - val_accuracy10: 0.5781 - val_accuracy20: 0.5705 - val_accuracy30: 0.5558 - val_accuracy50: 0.5232 - 80s/epoch - 47ms/step
Epoch 26/50
1701/1701 - 80s - loss: 9.5238 - accuracy10: 0.6452 - accuracy20: 0.6365 - accuracy30: 0.6190 - accuracy50: 0.5843 - val_loss: 10.9078 - val_accuracy10: 0.5654 - val_accuracy20: 0.5643 - val_accuracy30: 0.5517 - val_accuracy50: 0.5219 - 80s/epoch - 47ms/step
Epoch 27/50
1701/1701 - 80s - loss: 9.5043 - accuracy10: 0.6455 - accuracy20: 0.6371 - accuracy30: 0.6199 - accuracy50: 0.5856 - val_loss: 10.8621 - val_accuracy10: 0.5741 - val_accuracy20: 0.5712 - val_accuracy30: 0.5560 - val_accuracy50: 0.5250 - 80s/epoch - 47ms/step
Epoch 28/50
1701/1701 - 80s - loss: 9.4846 - accuracy10: 0.6460 - accuracy20: 0.6376 - accuracy30: 0.6207 - accuracy50: 0.5866 - val_loss: 11.0823 - val_accuracy10: 0.5439 - val_accuracy20: 0.5441 - val_accuracy30: 0.5326 - val_accuracy50: 0.5100 - 80s/epoch - 47ms/step
testing model: results/AAL/W5/deepLOB_L2/seq2seq
Evaluating performance on  test set...
6357/6357 - 100s - 100s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8834633
{'0': {'precision': 0.45730321239140775, 'recall': 0.40276252740217666, 'f1-score': 0.4283035332999127, 'support': 257735}, '1': {'precision': 0.8451599685159035, 'recall': 0.5890726917615883, 'f1-score': 0.6942536889746711, 'support': 1106439}, '2': {'precision': 0.315136965611536, 'recall': 0.7536949371661058, 'f1-score': 0.44444245138651434, 'support': 262995}, 'accuracy': 0.5861695988554354, 'macro avg': {'precision': 0.5392000488396157, 'recall': 0.5818433854432903, 'f1-score': 0.5223332245536995, 'support': 1627169}, 'weighted avg': {'precision': 0.6980592920105246, 'recall': 0.5861695988554354, 'f1-score': 0.6117522586977109, 'support': 1627169}}
[[103806  78735  75194]
 [ 99088 651773 355578]
 [ 24102  40675 198218]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9139075
{'0': {'precision': 0.523993326302322, 'recall': 0.3584609971229446, 'f1-score': 0.42570173944647427, 'support': 338193}, '1': {'precision': 0.7607119789506606, 'recall': 0.5911244529257247, 'f1-score': 0.665280860595084, 'support': 946398}, '2': {'precision': 0.3740547366890875, 'recall': 0.7210766599139466, 'f1-score': 0.4925840698082506, 'support': 342578}, 'accuracy': 0.570127012006743, 'macro avg': {'precision': 0.5529200139806901, 'recall': 0.5568873699875386, 'f1-score': 0.5278555566166029, 'support': 1627169}, 'weighted avg': {'precision': 0.6301067031405974, 'recall': 0.570127012006743, 'f1-score': 0.5791274844474413, 'support': 1627169}}
[[121229 109840 107124]
 [ 80710 559439 306249]
 [ 29417  66136 247025]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.94173056
{'0': {'precision': 0.550203005760687, 'recall': 0.3258806376801376, 'f1-score': 0.4093228031666408, 'support': 397127}, '1': {'precision': 0.6872903508240981, 'recall': 0.5879179761345712, 'f1-score': 0.6337322985288497, 'support': 830490}, '2': {'precision': 0.4066197044638547, 'recall': 0.6935968284478616, 'f1-score': 0.5126811476903468, 'support': 399552}, 'accuracy': 0.5499146062885908, 'macro avg': {'precision': 0.5480376870162132, 'recall': 0.5357984807541901, 'f1-score': 0.5185787497952791, 'support': 1627169}, 'weighted avg': {'precision': 0.5849140124243836, 'recall': 0.5499146062885908, 'f1-score': 0.5492387400327541, 'support': 1627169}}
[[129416 134073 133638]
 [ 71455 488260 270775]
 [ 34344  88080 277128]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.98934275
{'0': {'precision': 0.5696259865230378, 'recall': 0.27587469967282185, 'f1-score': 0.3717215148929525, 'support': 483223}, '1': {'precision': 0.5618476862395401, 'recall': 0.5809503721336668, 'f1-score': 0.5712393716663199, 'support': 663740}, '2': {'precision': 0.43940930884664414, 'recall': 0.6467828390315823, 'f1-score': 0.5233004138869911, 'support': 480206}, 'accuracy': 0.5097798692084228, 'macro avg': {'precision': 0.5236276605364073, 'recall': 0.5012026369460236, 'f1-score': 0.4887537668154212, 'support': 1627169}, 'weighted avg': {'precision': 0.5280239163321485, 'recall': 0.5097798692084228, 'f1-score': 0.4978406082539286, 'support': 1627169}}
[[133309 175064 174850]
 [ 56746 385600 221394]
 [ 43974 125643 310589]]
Evaluating performance on  train set...
1701/1701 - 28s - 28s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.87374616
{'0': {'precision': 0.3755487040133779, 'recall': 0.6387148380215971, 'f1-score': 0.47299053887289183, 'support': 67509}, '1': {'precision': 0.8884431982177251, 'recall': 0.5440307785356675, 'f1-score': 0.6748331245871096, 'support': 297610}, '2': {'precision': 0.3591856204332083, 'recall': 0.7069517347330687, 'f1-score': 0.47634931132645136, 'support': 70299}, 'accuracy': 0.5850148592846415, 'macro avg': {'precision': 0.5410591742214371, 'recall': 0.6298991170967777, 'f1-score': 0.5413909915954843, 'support': 435418}, 'weighted avg': {'precision': 0.7234723590013513, 'recall': 0.5850148592846415, 'f1-score': 0.6114930589320561, 'support': 435418}}
[[ 43119  11093  13297]
 [ 60333 161909  75368]
 [ 11364   9237  49698]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.86558205
{'0': {'precision': 0.4538428808363943, 'recall': 0.5889876827028184, 'f1-score': 0.5126582899292783, 'support': 88737}, '1': {'precision': 0.812884942808497, 'recall': 0.5566048807968265, 'f1-score': 0.6607653724688836, 'support': 255614}, '2': {'precision': 0.4229744338329971, 'recall': 0.6745473113202367, 'f1-score': 0.5199282262228204, 'support': 91067}, 'accuracy': 0.5878718840286805, 'macro avg': {'precision': 0.5632340858259628, 'recall': 0.6067132916066272, 'f1-score': 0.5644506295403274, 'support': 435418}, 'weighted avg': {'precision': 0.6581639717551866, 'recall': 0.5878718840286805, 'f1-score': 0.6011256823768176, 'support': 435418}}
[[ 52265  17630  18842]
 [ 48378 142276  64960]
 [ 14518  15120  61429]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.88062173
{'0': {'precision': 0.491794591119567, 'recall': 0.5464030964354314, 'f1-score': 0.5176626583146632, 'support': 103603}, '1': {'precision': 0.7435446112685477, 'recall': 0.5601702669371842, 'f1-score': 0.638961156824782, 'support': 226233}, '2': {'precision': 0.45507499733105583, 'recall': 0.6459718512625258, 'f1-score': 0.5339748056401544, 'support': 105582}, 'accuracy': 0.5777000491481749, 'macro avg': {'precision': 0.5634713999063902, 'recall': 0.5841817382117137, 'f1-score': 0.5635328735931999, 'support': 435418}, 'weighted avg': {'precision': 0.613694085759168, 'recall': 0.5777000491481749, 'f1-score': 0.5846419571777322, 'support': 435418}}
[[ 56609  23459  23535]
 [ 41370 126729  58134]
 [ 17128  20251  68203]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.92202806
{'0': {'precision': 0.5250497823673498, 'recall': 0.4789576903292181, 'f1-score': 0.5009457357824388, 'support': 124416}, '1': {'precision': 0.6227185643846805, 'recall': 0.5618521227884797, 'f1-score': 0.5907216024976356, 'support': 184545}, '2': {'precision': 0.485236492790364, 'recall': 0.5963608183018734, 'f1-score': 0.5350901466612742, 'support': 126457}, 'accuracy': 0.5481881777969675, 'macro avg': {'precision': 0.5443349465141315, 'recall': 0.5457235438065238, 'f1-score': 0.5422524949804495, 'support': 435418}, 'weighted avg': {'precision': 0.5548823024224495, 'recall': 0.5481881777969675, 'f1-score': 0.5489122578129034, 'support': 435418}}
[[ 59590  33328  31498]
 [ 32353 103687  48505]
 [ 21551  29492  75414]]
Evaluating performance on  val set...
563/563 - 9s - 9s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.85327727
{'0': {'precision': 0.3981358189081225, 'recall': 0.603742259714619, 'f1-score': 0.47984165760239655, 'support': 22286}, '1': {'precision': 0.8697451700125376, 'recall': 0.5808098129804103, 'f1-score': 0.6965010433362568, 'support': 99134}, '2': {'precision': 0.35313074461566396, 'recall': 0.6873095101373735, 'f1-score': 0.466552727054661, 'support': 22639}, 'accuracy': 0.6010939962098862, 'macro avg': {'precision': 0.5403372445121081, 'recall': 0.6239538609441343, 'f1-score': 0.5476318093311048, 'support': 144059}, 'weighted avg': {'precision': 0.715600548883189, 'recall': 0.6010939962098862, 'f1-score': 0.6268471445672534, 'support': 144059}}
[[13455  4737  4094]
 [17147 57578 24409]
 [ 3193  3886 15560]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.86462307
{'0': {'precision': 0.47280199618376634, 'recall': 0.5429476806903991, 'f1-score': 0.5054527766009195, 'support': 29664}, '1': {'precision': 0.7861637193830318, 'recall': 0.5920940675963129, 'f1-score': 0.6754656187015928, 'support': 84620}, '2': {'precision': 0.418974126191557, 'recall': 0.6509823677581864, 'f1-score': 0.5098240353507457, 'support': 29775}, 'accuracy': 0.5941454542930327, 'macro avg': {'precision': 0.5593132805861184, 'recall': 0.5953413720149662, 'f1-score': 0.5635808102177526, 'support': 144059}, 'weighted avg': {'precision': 0.6457446390460923, 'recall': 0.5941454542930327, 'f1-score': 0.6062214958606329, 'support': 144059}}
[[16106  7480  6078]
 [13715 50103 20802]
 [ 4244  6148 19383]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.89060366
{'0': {'precision': 0.5071445303349731, 'recall': 0.49658810711623375, 'f1-score': 0.5018108068955528, 'support': 34878}, '1': {'precision': 0.7118881343932031, 'recall': 0.5949569661108123, 'f1-score': 0.6481912882950199, 'support': 74360}, '2': {'precision': 0.45183308557191015, 'recall': 0.6197409609143908, 'f1-score': 0.5226320505679203, 'support': 34821}, 'accuracy': 0.5771315919172005, 'macro avg': {'precision': 0.5569552501000288, 'recall': 0.5704286780471456, 'f1-score': 0.557544715252831, 'support': 144059}, 'weighted avg': {'precision': 0.5994590305027888, 'recall': 0.5771315919172005, 'f1-score': 0.5824018780731945, 'support': 144059}}
[[17320  9828  7730]
 [11668 44241 18451]
 [ 5164  8077 21580]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.94420105
{'0': {'precision': 0.5357153473440147, 'recall': 0.4290135212340507, 'f1-score': 0.4764636677285886, 'support': 42008}, '1': {'precision': 0.5915534797748915, 'recall': 0.5935616347618732, 'f1-score': 0.5925558558781957, 'support': 60388}, '2': {'precision': 0.4784144505770196, 'recall': 0.5721383481746394, 'f1-score': 0.5210956628191675, 'support': 41663}, 'accuracy': 0.5393831693958725, 'macro avg': {'precision': 0.5352277592319753, 'recall': 0.5315711680568544, 'f1-score': 0.5300383954753173, 'support': 144059}, 'weighted avg': {'precision': 0.5425502266589654, 'recall': 0.5393831693958725, 'f1-score': 0.538036203074782, 'support': 144059}}
[[18022 13434 10552]
 [ 9108 35844 15436]
 [ 6511 11315 23837]]
training model: results/AAL/W5/deepOF_L2/seq2seq
Epoch 1/50
1701/1701 - 57s - loss: 11.2865 - accuracy10: 0.5252 - accuracy20: 0.5310 - accuracy30: 0.5253 - accuracy50: 0.5059 - val_loss: 11.5274 - val_accuracy10: 0.6469 - val_accuracy20: 0.6129 - val_accuracy30: 0.5784 - val_accuracy50: 0.5162 - 57s/epoch - 33ms/step
Epoch 2/50
1701/1701 - 49s - loss: 10.4309 - accuracy10: 0.6065 - accuracy20: 0.5986 - accuracy30: 0.5818 - accuracy50: 0.5483 - val_loss: 11.0421 - val_accuracy10: 0.6570 - val_accuracy20: 0.6272 - val_accuracy30: 0.5953 - val_accuracy50: 0.5367 - 49s/epoch - 29ms/step
Epoch 3/50
1701/1701 - 49s - loss: 10.2583 - accuracy10: 0.6175 - accuracy20: 0.6062 - accuracy30: 0.5886 - accuracy50: 0.5545 - val_loss: 10.9338 - val_accuracy10: 0.6633 - val_accuracy20: 0.6340 - val_accuracy30: 0.6035 - val_accuracy50: 0.5431 - 49s/epoch - 29ms/step
Epoch 4/50
1701/1701 - 49s - loss: 10.1665 - accuracy10: 0.6224 - accuracy20: 0.6107 - accuracy30: 0.5928 - accuracy50: 0.5575 - val_loss: 10.8665 - val_accuracy10: 0.6643 - val_accuracy20: 0.6347 - val_accuracy30: 0.6031 - val_accuracy50: 0.5434 - 49s/epoch - 29ms/step
Epoch 5/50
1701/1701 - 50s - loss: 10.1077 - accuracy10: 0.6248 - accuracy20: 0.6128 - accuracy30: 0.5944 - accuracy50: 0.5590 - val_loss: 10.7739 - val_accuracy10: 0.6585 - val_accuracy20: 0.6310 - val_accuracy30: 0.6012 - val_accuracy50: 0.5446 - 50s/epoch - 29ms/step
Epoch 6/50
1701/1701 - 49s - loss: 10.0598 - accuracy10: 0.6265 - accuracy20: 0.6149 - accuracy30: 0.5961 - accuracy50: 0.5607 - val_loss: 10.7740 - val_accuracy10: 0.6579 - val_accuracy20: 0.6306 - val_accuracy30: 0.6011 - val_accuracy50: 0.5433 - 49s/epoch - 29ms/step
Epoch 7/50
1701/1701 - 50s - loss: 10.0190 - accuracy10: 0.6285 - accuracy20: 0.6169 - accuracy30: 0.5980 - accuracy50: 0.5621 - val_loss: 10.7256 - val_accuracy10: 0.6552 - val_accuracy20: 0.6301 - val_accuracy30: 0.6017 - val_accuracy50: 0.5452 - 50s/epoch - 29ms/step
Epoch 8/50
1701/1701 - 49s - loss: 9.9811 - accuracy10: 0.6309 - accuracy20: 0.6190 - accuracy30: 0.6003 - accuracy50: 0.5646 - val_loss: 10.6997 - val_accuracy10: 0.6438 - val_accuracy20: 0.6211 - val_accuracy30: 0.5950 - val_accuracy50: 0.5436 - 49s/epoch - 29ms/step
Epoch 9/50
1701/1701 - 51s - loss: 9.9506 - accuracy10: 0.6311 - accuracy20: 0.6205 - accuracy30: 0.6012 - accuracy50: 0.5649 - val_loss: 10.6744 - val_accuracy10: 0.6414 - val_accuracy20: 0.6196 - val_accuracy30: 0.5952 - val_accuracy50: 0.5445 - 51s/epoch - 30ms/step
Epoch 10/50
1701/1701 - 49s - loss: 9.9198 - accuracy10: 0.6318 - accuracy20: 0.6208 - accuracy30: 0.6019 - accuracy50: 0.5665 - val_loss: 10.6455 - val_accuracy10: 0.6412 - val_accuracy20: 0.6208 - val_accuracy30: 0.5958 - val_accuracy50: 0.5456 - 49s/epoch - 29ms/step
Epoch 11/50
1701/1701 - 50s - loss: 9.8940 - accuracy10: 0.6328 - accuracy20: 0.6219 - accuracy30: 0.6031 - accuracy50: 0.5673 - val_loss: 10.5856 - val_accuracy10: 0.6401 - val_accuracy20: 0.6184 - val_accuracy30: 0.5945 - val_accuracy50: 0.5460 - 50s/epoch - 29ms/step
Epoch 12/50
1701/1701 - 49s - loss: 9.8589 - accuracy10: 0.6340 - accuracy20: 0.6233 - accuracy30: 0.6049 - accuracy50: 0.5695 - val_loss: 10.6784 - val_accuracy10: 0.6268 - val_accuracy20: 0.6085 - val_accuracy30: 0.5844 - val_accuracy50: 0.5396 - 49s/epoch - 29ms/step
Epoch 13/50
1701/1701 - 50s - loss: 9.8350 - accuracy10: 0.6348 - accuracy20: 0.6243 - accuracy30: 0.6059 - accuracy50: 0.5706 - val_loss: 10.6410 - val_accuracy10: 0.6342 - val_accuracy20: 0.6153 - val_accuracy30: 0.5913 - val_accuracy50: 0.5444 - 50s/epoch - 30ms/step
Epoch 14/50
1701/1701 - 50s - loss: 9.8149 - accuracy10: 0.6356 - accuracy20: 0.6252 - accuracy30: 0.6066 - accuracy50: 0.5714 - val_loss: 10.6488 - val_accuracy10: 0.6267 - val_accuracy20: 0.6074 - val_accuracy30: 0.5848 - val_accuracy50: 0.5405 - 50s/epoch - 30ms/step
Epoch 15/50
1701/1701 - 48s - loss: 9.7889 - accuracy10: 0.6348 - accuracy20: 0.6258 - accuracy30: 0.6077 - accuracy50: 0.5724 - val_loss: 10.6238 - val_accuracy10: 0.6248 - val_accuracy20: 0.6064 - val_accuracy30: 0.5836 - val_accuracy50: 0.5403 - 48s/epoch - 28ms/step
Epoch 16/50
1701/1701 - 49s - loss: 9.7652 - accuracy10: 0.6360 - accuracy20: 0.6270 - accuracy30: 0.6086 - accuracy50: 0.5733 - val_loss: 10.7009 - val_accuracy10: 0.6147 - val_accuracy20: 0.5977 - val_accuracy30: 0.5755 - val_accuracy50: 0.5347 - 49s/epoch - 29ms/step
Epoch 17/50
1701/1701 - 49s - loss: 9.7392 - accuracy10: 0.6373 - accuracy20: 0.6275 - accuracy30: 0.6099 - accuracy50: 0.5749 - val_loss: 10.7475 - val_accuracy10: 0.6061 - val_accuracy20: 0.5916 - val_accuracy30: 0.5714 - val_accuracy50: 0.5331 - 49s/epoch - 29ms/step
Epoch 18/50
1701/1701 - 51s - loss: 9.7149 - accuracy10: 0.6377 - accuracy20: 0.6283 - accuracy30: 0.6098 - accuracy50: 0.5754 - val_loss: 10.7329 - val_accuracy10: 0.6100 - val_accuracy20: 0.5931 - val_accuracy30: 0.5700 - val_accuracy50: 0.5305 - 51s/epoch - 30ms/step
Epoch 19/50
1701/1701 - 49s - loss: 9.6955 - accuracy10: 0.6382 - accuracy20: 0.6294 - accuracy30: 0.6117 - accuracy50: 0.5769 - val_loss: 10.7494 - val_accuracy10: 0.6024 - val_accuracy20: 0.5885 - val_accuracy30: 0.5679 - val_accuracy50: 0.5304 - 49s/epoch - 29ms/step
Epoch 20/50
1701/1701 - 49s - loss: 9.6722 - accuracy10: 0.6381 - accuracy20: 0.6298 - accuracy30: 0.6118 - accuracy50: 0.5772 - val_loss: 10.7639 - val_accuracy10: 0.6087 - val_accuracy20: 0.5922 - val_accuracy30: 0.5692 - val_accuracy50: 0.5300 - 49s/epoch - 29ms/step
Epoch 21/50
1701/1701 - 49s - loss: 9.6535 - accuracy10: 0.6395 - accuracy20: 0.6313 - accuracy30: 0.6128 - accuracy50: 0.5785 - val_loss: 10.7947 - val_accuracy10: 0.6122 - val_accuracy20: 0.5931 - val_accuracy30: 0.5700 - val_accuracy50: 0.5304 - 49s/epoch - 29ms/step
testing model: results/AAL/W5/deepOF_L2/seq2seq
Evaluating performance on  test set...
6357/6357 - 64s - 64s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8732366
{'0': {'precision': 0.37991500990007293, 'recall': 0.636525538155914, 'f1-score': 0.47582833367413685, 'support': 257732}, '1': {'precision': 0.8492253696874146, 'recall': 0.5812734197487794, 'f1-score': 0.6901538657997486, 'support': 1106438}, '2': {'precision': 0.35339938815579197, 'recall': 0.5885913747081682, 'f1-score': 0.44163454652831474, 'support': 262994}, 'accuracy': 0.591207770083409, 'macro avg': {'precision': 0.5275132559144265, 'recall': 0.6021301108709539, 'f1-score': 0.5358722486674, 'support': 1627164}, 'weighted avg': {'precision': 0.6947507403103889, 'recall': 0.591207770083409, 'f1-score': 0.6160386334702049, 'support': 1627164}}
[[164053  53237  40442]
 [220513 643143 242782]
 [ 47249  60949 154796]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.90006185
{'0': {'precision': 0.44458844929513414, 'recall': 0.5781678292315835, 'f1-score': 0.5026549218562215, 'support': 338189}, '1': {'precision': 0.7622109270015125, 'recall': 0.5729576774253539, 'f1-score': 0.6541714671765764, 'support': 946398}, '2': {'precision': 0.40515850337849196, 'recall': 0.5628982681265817, 'f1-score': 0.4711769528019166, 'support': 342577}, 'accuracy': 0.571922682655221, 'macro avg': {'precision': 0.5373192932250462, 'recall': 0.571341258261173, 'f1-score': 0.5426677806115715, 'support': 1627164}, 'weighted avg': {'precision': 0.6210239438574988, 'recall': 0.571922682655221, 'f1-score': 0.5841533616283505, 'support': 1627164}}
[[195530  79902  62757]
 [183793 542246 220359]
 [ 60477  89264 192836]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9309187
{'0': {'precision': 0.47846563203033105, 'recall': 0.5275153352605232, 'f1-score': 0.5017946989013833, 'support': 397124}, '1': {'precision': 0.6869336827425468, 'recall': 0.5593047477994919, 'f1-score': 0.6165838907955842, 'support': 830490}, '2': {'precision': 0.42651712982811707, 'recall': 0.5477737454636467, 'f1-score': 0.47959986413787814, 'support': 399550}, 'accuracy': 0.5487148191577493, 'macro avg': {'precision': 0.5306388148669984, 'recall': 0.5448646095078873, 'f1-score': 0.5326594846116152, 'support': 1627164}, 'weighted avg': {'precision': 0.5721099158155509, 'recall': 0.5487148191577493, 'f1-score': 0.554932139101914, 'support': 1627164}}
[[209489 101684  85951]
 [157667 464497 208326]
 [ 70679 110008 218863]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.97402334
{'0': {'precision': 0.510772676888971, 'recall': 0.4577305208175969, 'f1-score': 0.4827991150993003, 'support': 483221}, '1': {'precision': 0.559508672898299, 'recall': 0.5429815032716173, 'f1-score': 0.5511212106383498, 'support': 663739}, '2': {'precision': 0.44851643026885896, 'recall': 0.5136983448700969, 'f1-score': 0.4788996257989993, 'support': 480204}, 'accuracy': 0.5090224464159728, 'macro avg': {'precision': 0.5062659266853763, 'recall': 0.5048034563197704, 'f1-score': 0.5042733171788831, 'support': 1627164}, 'weighted avg': {'precision': 0.5122797668954308, 'recall': 0.5090224464159728, 'f1-score': 0.5095176812739646, 'support': 1627164}}
[[221185 139421 122615]
 [122645 360398 180696]
 [ 89210 144314 246680]]
Evaluating performance on  train set...
1701/1701 - 18s - 18s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7892474
{'0': {'precision': 0.3909698209533465, 'recall': 0.6400331930531682, 'f1-score': 0.4854179075961743, 'support': 67484}, '1': {'precision': 0.8550789167917632, 'recall': 0.6771474530110853, 'f1-score': 0.7557819419378898, 'support': 297783}, '2': {'precision': 0.4313107286313758, 'recall': 0.5479750823224188, 'f1-score': 0.4826936720304878, 'support': 70151}, 'accuracy': 0.6505840364890748, 'macro avg': {'precision': 0.5591198221254952, 'recall': 0.6217185761288907, 'f1-score': 0.5746311738548506, 'support': 435418}, 'weighted avg': {'precision': 0.7148741012094973, 'recall': 0.6505840364890748, 'f1-score': 0.6698813551091632, 'support': 435418}}
[[ 43192  14387   9905]
 [ 55360 201643  40780]
 [ 11922  19788  38441]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8150596
{'0': {'precision': 0.4668519359752024, 'recall': 0.5911885130333758, 'f1-score': 0.5217144620407513, 'support': 88657}, '1': {'precision': 0.7735337236965701, 'recall': 0.6893007173533806, 'f1-score': 0.7289920659215197, 'support': 255662}, '2': {'precision': 0.4913927848353562, 'recall': 0.51419883862611, 'f1-score': 0.5025371997468163, 'support': 91099}, 'accuracy': 0.6326885888961871, 'macro avg': {'precision': 0.5772594815023763, 'recall': 0.5982293563376222, 'f1-score': 0.584414575903029, 'support': 435418}, 'weighted avg': {'precision': 0.6520590840552807, 'recall': 0.6326885888961871, 'f1-score': 0.6394082122891328, 'support': 435418}}
[[ 52413  22768  13476]
 [ 44426 176228  35008]
 [ 15430  28826  46843]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8521491
{'0': {'precision': 0.5053879408006235, 'recall': 0.5384860511602306, 'f1-score': 0.5214122751243595, 'support': 103557}, '1': {'precision': 0.7008222841225626, 'recall': 0.6948362408752673, 'f1-score': 0.6978164252922786, 'support': 226308}, '2': {'precision': 0.5125019860184302, 'recall': 0.48895815372372176, 'f1-score': 0.500453317947997, 'support': 105553}, 'accuracy': 0.6077424451905985, 'macro avg': {'precision': 0.5729040703138722, 'recall': 0.5740934819197399, 'f1-score': 0.5732273394548785, 'support': 435418}, 'weighted avg': {'precision': 0.6086892838396722, 'recall': 0.6077424451905985, 'f1-score': 0.6080173066328521, 'support': 435418}}
[[ 55764  31077  16716]
 [ 36684 157247  32377]
 [ 17891  36051  51611]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9159611
{'0': {'precision': 0.5378272017732528, 'recall': 0.46063194813134484, 'f1-score': 0.49624542322941273, 'support': 124314}, '1': {'precision': 0.5794275098608487, 'recall': 0.6990325951028848, 'f1-score': 0.6336352840725074, 'support': 184721}, '2': {'precision': 0.524986804403559, 'recall': 0.44071591907139407, 'f1-score': 0.4791744630697826, 'support': 126383}, 'accuracy': 0.5559898763946369, 'macro avg': {'precision': 0.5474138386792201, 'recall': 0.5334601541018745, 'f1-score': 0.5363517234572343, 'support': 435418}, 'weighted avg': {'precision': 0.5517486349006725, 'recall': 0.5559898763946369, 'f1-score': 0.549576505837258, 'support': 435418}}
[[ 57263  44820  22231]
 [ 27429 129126  28166]
 [ 21779  48905  55699]]
Evaluating performance on  val set...
563/563 - 6s - 6s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8092543
{'0': {'precision': 0.3854825785416264, 'recall': 0.6245131832221675, 'f1-score': 0.476712796856313, 'support': 22339}, '1': {'precision': 0.8500649519355676, 'recall': 0.6607162690199009, 'f1-score': 0.743524920322007, 'support': 99041}, '2': {'precision': 0.4160461050314058, 'recall': 0.5666534374035366, 'f1-score': 0.47980882325485874, 'support': 22677}, 'accuracy': 0.6402951609432378, 'macro avg': {'precision': 0.5505312118362, 'recall': 0.617294296548535, 'f1-score': 0.566682180144393, 'support': 144057}, 'weighted avg': {'precision': 0.709700019787231, 'recall': 0.6402951609432378, 'f1-score': 0.6606368554637089, 'support': 144057}}
[[13951  5419  2969]
 [18536 65438 15067]
 [ 3704  6123 12850]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8370894
{'0': {'precision': 0.457963884083045, 'recall': 0.5703272286560732, 'f1-score': 0.508006477150054, 'support': 29704}, '1': {'precision': 0.765260438505133, 'recall': 0.6687706855791962, 'f1-score': 0.7137693729381265, 'support': 84600}, '2': {'precision': 0.47615598213207777, 'recall': 0.53023224548785, 'f1-score': 0.5017412737536774, 'support': 29753}, 'accuracy': 0.6198588058893355, 'macro avg': {'precision': 0.5664601015734186, 'recall': 0.5897767199077064, 'f1-score': 0.574505707947286, 'support': 144057}, 'weighted avg': {'precision': 0.6421865042775619, 'recall': 0.6198588058893355, 'f1-score': 0.6275503548305453, 'support': 144057}}
[[16941  8391  4372]
 [15038 56578 12984]
 [ 5013  8964 15776]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8720949
{'0': {'precision': 0.49527969182355813, 'recall': 0.5226439940455743, 'f1-score': 0.5085940329275428, 'support': 34932}, '1': {'precision': 0.692610946848235, 'recall': 0.6709293100434333, 'f1-score': 0.6815977487261451, 'support': 74367}, '2': {'precision': 0.4981795426100808, 'recall': 0.5038839979285344, 'f1-score': 0.5010155333695683, 'support': 34758}, 'accuracy': 0.5946673886031224, 'macro avg': {'precision': 0.5620233937606246, 'recall': 0.5658191006725141, 'f1-score': 0.5637357716744188, 'support': 144057}, 'weighted avg': {'precision': 0.5978483032486059, 'recall': 0.5946673886031224, 'f1-score': 0.5960757508944489, 'support': 144057}}
[[18257 10948  5727]
 [12557 49895 11915]
 [ 6048 11196 17514]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9335604
{'0': {'precision': 0.5255110520192787, 'recall': 0.45087694282047625, 'f1-score': 0.4853415195702226, 'support': 42078}, '1': {'precision': 0.5726548910353411, 'recall': 0.6709915821568238, 'f1-score': 0.6179354336596495, 'support': 60348}, '2': {'precision': 0.5136129309418966, 'recall': 0.4594893228603685, 'f1-score': 0.48504595879556256, 'support': 41631}, 'accuracy': 0.5455757096149441, 'macro avg': {'precision': 0.5372596246655055, 'recall': 0.5271192826125561, 'f1-score': 0.5294409706751448, 'support': 144057}, 'weighted avg': {'precision': 0.5418219964257903, 'recall': 0.5455757096149441, 'f1-score': 0.540802018101074, 'support': 144057}}
[[18972 15195  7911]
 [ 9651 40493 10204]
 [ 7479 15023 19129]]
training model: results/AAL/W5/deepVOL_L2/seq2seq
Epoch 1/50
1701/1701 - 57s - loss: 11.7424 - accuracy10: 0.4921 - accuracy20: 0.5029 - accuracy30: 0.5021 - accuracy50: 0.4887 - val_loss: 11.5900 - val_accuracy10: 0.5120 - val_accuracy20: 0.5254 - val_accuracy30: 0.5197 - val_accuracy50: 0.4929 - 57s/epoch - 33ms/step
Epoch 2/50
1701/1701 - 48s - loss: 11.0562 - accuracy10: 0.5601 - accuracy20: 0.5613 - accuracy30: 0.5506 - accuracy50: 0.5247 - val_loss: 11.2701 - val_accuracy10: 0.5814 - val_accuracy20: 0.5723 - val_accuracy30: 0.5515 - val_accuracy50: 0.5092 - 48s/epoch - 28ms/step
Epoch 3/50
1701/1701 - 49s - loss: 10.7966 - accuracy10: 0.5830 - accuracy20: 0.5778 - accuracy30: 0.5628 - accuracy50: 0.5335 - val_loss: 11.2237 - val_accuracy10: 0.5878 - val_accuracy20: 0.5746 - val_accuracy30: 0.5506 - val_accuracy50: 0.5067 - 49s/epoch - 29ms/step
Epoch 4/50
1701/1701 - 48s - loss: 10.6208 - accuracy10: 0.5977 - accuracy20: 0.5900 - accuracy30: 0.5727 - accuracy50: 0.5416 - val_loss: 11.3074 - val_accuracy10: 0.6069 - val_accuracy20: 0.5880 - val_accuracy30: 0.5623 - val_accuracy50: 0.5136 - 48s/epoch - 28ms/step
Epoch 5/50
1701/1701 - 47s - loss: 10.4701 - accuracy10: 0.6055 - accuracy20: 0.5963 - accuracy30: 0.5776 - accuracy50: 0.5456 - val_loss: 11.2203 - val_accuracy10: 0.6177 - val_accuracy20: 0.6008 - val_accuracy30: 0.5743 - val_accuracy50: 0.5224 - 47s/epoch - 28ms/step
Epoch 6/50
1701/1701 - 48s - loss: 10.3670 - accuracy10: 0.6120 - accuracy20: 0.6021 - accuracy30: 0.5828 - accuracy50: 0.5489 - val_loss: 10.9966 - val_accuracy10: 0.6202 - val_accuracy20: 0.6033 - val_accuracy30: 0.5776 - val_accuracy50: 0.5267 - 48s/epoch - 28ms/step
Epoch 7/50
1701/1701 - 48s - loss: 10.2930 - accuracy10: 0.6173 - accuracy20: 0.6069 - accuracy30: 0.5877 - accuracy50: 0.5521 - val_loss: 11.0705 - val_accuracy10: 0.6072 - val_accuracy20: 0.5925 - val_accuracy30: 0.5682 - val_accuracy50: 0.5215 - 48s/epoch - 28ms/step
Epoch 8/50
1701/1701 - 48s - loss: 10.2296 - accuracy10: 0.6215 - accuracy20: 0.6103 - accuracy30: 0.5909 - accuracy50: 0.5559 - val_loss: 11.0939 - val_accuracy10: 0.6257 - val_accuracy20: 0.6054 - val_accuracy30: 0.5775 - val_accuracy50: 0.5242 - 48s/epoch - 28ms/step
Epoch 9/50
1701/1701 - 48s - loss: 10.1820 - accuracy10: 0.6249 - accuracy20: 0.6132 - accuracy30: 0.5924 - accuracy50: 0.5564 - val_loss: 11.0873 - val_accuracy10: 0.6378 - val_accuracy20: 0.6126 - val_accuracy30: 0.5818 - val_accuracy50: 0.5256 - 48s/epoch - 28ms/step
Epoch 10/50
1701/1701 - 48s - loss: 10.1445 - accuracy10: 0.6260 - accuracy20: 0.6144 - accuracy30: 0.5953 - accuracy50: 0.5588 - val_loss: 11.0283 - val_accuracy10: 0.6403 - val_accuracy20: 0.6170 - val_accuracy30: 0.5867 - val_accuracy50: 0.5299 - 48s/epoch - 28ms/step
Epoch 11/50
1701/1701 - 48s - loss: 10.1103 - accuracy10: 0.6276 - accuracy20: 0.6159 - accuracy30: 0.5956 - accuracy50: 0.5594 - val_loss: 11.0050 - val_accuracy10: 0.6349 - val_accuracy20: 0.6139 - val_accuracy30: 0.5857 - val_accuracy50: 0.5307 - 48s/epoch - 28ms/step
Epoch 12/50
1701/1701 - 48s - loss: 10.0789 - accuracy10: 0.6290 - accuracy20: 0.6174 - accuracy30: 0.5971 - accuracy50: 0.5612 - val_loss: 10.9333 - val_accuracy10: 0.6353 - val_accuracy20: 0.6146 - val_accuracy30: 0.5864 - val_accuracy50: 0.5314 - 48s/epoch - 28ms/step
Epoch 13/50
1701/1701 - 48s - loss: 10.0460 - accuracy10: 0.6300 - accuracy20: 0.6186 - accuracy30: 0.5986 - accuracy50: 0.5625 - val_loss: 10.9080 - val_accuracy10: 0.6392 - val_accuracy20: 0.6169 - val_accuracy30: 0.5880 - val_accuracy50: 0.5321 - 48s/epoch - 28ms/step
Epoch 14/50
1701/1701 - 48s - loss: 10.0258 - accuracy10: 0.6303 - accuracy20: 0.6191 - accuracy30: 0.5989 - accuracy50: 0.5631 - val_loss: 10.8321 - val_accuracy10: 0.6360 - val_accuracy20: 0.6170 - val_accuracy30: 0.5910 - val_accuracy50: 0.5358 - 48s/epoch - 28ms/step
Epoch 15/50
1701/1701 - 49s - loss: 9.9949 - accuracy10: 0.6321 - accuracy20: 0.6204 - accuracy30: 0.6002 - accuracy50: 0.5646 - val_loss: 10.7875 - val_accuracy10: 0.6441 - val_accuracy20: 0.6222 - val_accuracy30: 0.5943 - val_accuracy50: 0.5378 - 49s/epoch - 29ms/step
Epoch 16/50
1701/1701 - 48s - loss: 9.9730 - accuracy10: 0.6320 - accuracy20: 0.6210 - accuracy30: 0.6011 - accuracy50: 0.5655 - val_loss: 10.7344 - val_accuracy10: 0.6370 - val_accuracy20: 0.6163 - val_accuracy30: 0.5900 - val_accuracy50: 0.5372 - 48s/epoch - 28ms/step
Epoch 17/50
1701/1701 - 48s - loss: 9.9432 - accuracy10: 0.6327 - accuracy20: 0.6222 - accuracy30: 0.6022 - accuracy50: 0.5662 - val_loss: 10.7464 - val_accuracy10: 0.6336 - val_accuracy20: 0.6144 - val_accuracy30: 0.5889 - val_accuracy50: 0.5374 - 48s/epoch - 28ms/step
Epoch 18/50
1701/1701 - 48s - loss: 9.9221 - accuracy10: 0.6335 - accuracy20: 0.6224 - accuracy30: 0.6026 - accuracy50: 0.5668 - val_loss: 10.8042 - val_accuracy10: 0.6302 - val_accuracy20: 0.6126 - val_accuracy30: 0.5877 - val_accuracy50: 0.5366 - 48s/epoch - 28ms/step
Epoch 19/50
1701/1701 - 48s - loss: 9.8975 - accuracy10: 0.6335 - accuracy20: 0.6228 - accuracy30: 0.6035 - accuracy50: 0.5679 - val_loss: 10.7677 - val_accuracy10: 0.6307 - val_accuracy20: 0.6130 - val_accuracy30: 0.5887 - val_accuracy50: 0.5378 - 48s/epoch - 28ms/step
Epoch 20/50
1701/1701 - 48s - loss: 9.8813 - accuracy10: 0.6342 - accuracy20: 0.6233 - accuracy30: 0.6036 - accuracy50: 0.5683 - val_loss: 10.6749 - val_accuracy10: 0.6263 - val_accuracy20: 0.6122 - val_accuracy30: 0.5897 - val_accuracy50: 0.5413 - 48s/epoch - 28ms/step
Epoch 21/50
1701/1701 - 47s - loss: 9.8634 - accuracy10: 0.6344 - accuracy20: 0.6244 - accuracy30: 0.6047 - accuracy50: 0.5691 - val_loss: 10.7132 - val_accuracy10: 0.6090 - val_accuracy20: 0.6006 - val_accuracy30: 0.5815 - val_accuracy50: 0.5375 - 47s/epoch - 28ms/step
Epoch 22/50
1701/1701 - 48s - loss: 9.8420 - accuracy10: 0.6351 - accuracy20: 0.6248 - accuracy30: 0.6052 - accuracy50: 0.5698 - val_loss: 10.7856 - val_accuracy10: 0.6250 - val_accuracy20: 0.6104 - val_accuracy30: 0.5861 - val_accuracy50: 0.5376 - 48s/epoch - 28ms/step
Epoch 23/50
1701/1701 - 48s - loss: 9.8272 - accuracy10: 0.6360 - accuracy20: 0.6255 - accuracy30: 0.6063 - accuracy50: 0.5707 - val_loss: 10.7470 - val_accuracy10: 0.6186 - val_accuracy20: 0.6099 - val_accuracy30: 0.5885 - val_accuracy50: 0.5416 - 48s/epoch - 28ms/step
Epoch 24/50
1701/1701 - 47s - loss: 9.8100 - accuracy10: 0.6362 - accuracy20: 0.6264 - accuracy30: 0.6068 - accuracy50: 0.5711 - val_loss: 10.6793 - val_accuracy10: 0.6267 - val_accuracy20: 0.6151 - val_accuracy30: 0.5933 - val_accuracy50: 0.5442 - 47s/epoch - 28ms/step
Epoch 25/50
1701/1701 - 48s - loss: 9.7911 - accuracy10: 0.6376 - accuracy20: 0.6269 - accuracy30: 0.6070 - accuracy50: 0.5722 - val_loss: 10.7581 - val_accuracy10: 0.6081 - val_accuracy20: 0.6020 - val_accuracy30: 0.5839 - val_accuracy50: 0.5393 - 48s/epoch - 28ms/step
Epoch 26/50
1701/1701 - 49s - loss: 9.7698 - accuracy10: 0.6369 - accuracy20: 0.6273 - accuracy30: 0.6083 - accuracy50: 0.5729 - val_loss: 10.7572 - val_accuracy10: 0.6230 - val_accuracy20: 0.6129 - val_accuracy30: 0.5911 - val_accuracy50: 0.5431 - 49s/epoch - 29ms/step
Epoch 27/50
1701/1701 - 47s - loss: 9.7487 - accuracy10: 0.6383 - accuracy20: 0.6281 - accuracy30: 0.6091 - accuracy50: 0.5741 - val_loss: 10.8384 - val_accuracy10: 0.6265 - val_accuracy20: 0.6142 - val_accuracy30: 0.5921 - val_accuracy50: 0.5417 - 47s/epoch - 28ms/step
Epoch 28/50
1701/1701 - 48s - loss: 9.7368 - accuracy10: 0.6393 - accuracy20: 0.6289 - accuracy30: 0.6099 - accuracy50: 0.5749 - val_loss: 10.7194 - val_accuracy10: 0.6168 - val_accuracy20: 0.6063 - val_accuracy30: 0.5839 - val_accuracy50: 0.5394 - 48s/epoch - 28ms/step
Epoch 29/50
1701/1701 - 48s - loss: 9.7178 - accuracy10: 0.6400 - accuracy20: 0.6298 - accuracy30: 0.6104 - accuracy50: 0.5757 - val_loss: 10.8022 - val_accuracy10: 0.6090 - val_accuracy20: 0.6016 - val_accuracy30: 0.5820 - val_accuracy50: 0.5379 - 48s/epoch - 28ms/step
Epoch 30/50
1701/1701 - 48s - loss: 9.7035 - accuracy10: 0.6404 - accuracy20: 0.6306 - accuracy30: 0.6114 - accuracy50: 0.5760 - val_loss: 10.7678 - val_accuracy10: 0.6189 - val_accuracy20: 0.6076 - val_accuracy30: 0.5852 - val_accuracy50: 0.5385 - 48s/epoch - 28ms/step
testing model: results/AAL/W5/deepVOL_L2/seq2seq
Evaluating performance on  test set...
6357/6357 - 59s - 59s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8379809
{'0': {'precision': 0.42042546187713453, 'recall': 0.5946573030438241, 'f1-score': 0.4925885453493604, 'support': 257735}, '1': {'precision': 0.857629668192592, 'recall': 0.6193861568509426, 'f1-score': 0.719293504072648, 'support': 1106439}, '2': {'precision': 0.36166421455475833, 'recall': 0.6374569858742561, 'f1-score': 0.4614963229879663, 'support': 262995}, 'accuracy': 0.6183899767018669, 'macro avg': {'precision': 0.5465731148748283, 'recall': 0.6171668152563409, 'f1-score': 0.5577927908033249, 'support': 1627169}, 'weighted avg': {'precision': 0.708217246622247, 'recall': 0.6183899767018669, 'f1-score': 0.6417175594867369, 'support': 1627169}}
[[153264  62586  41885]
 [167113 685313 254013]
 [ 44168  51179 167648]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.87015146
{'0': {'precision': 0.48418091078221603, 'recall': 0.533287205826259, 'f1-score': 0.5075490441629638, 'support': 338193}, '1': {'precision': 0.765584106206528, 'recall': 0.6265207661047466, 'f1-score': 0.6891066187302028, 'support': 946398}, '2': {'precision': 0.4214646438351885, 'recall': 0.5907588928652745, 'f1-score': 0.49195454827210267, 'support': 342578}, 'accuracy': 0.5996138077851778, 'macro avg': {'precision': 0.5570765536079775, 'recall': 0.5835222882654267, 'f1-score': 0.5628700703884231, 'support': 1627169}, 'weighted avg': {'precision': 0.6346472778559491, 'recall': 0.5996138077851778, 'f1-score': 0.6098637971124032, 'support': 1627169}}
[[180354  98897  58942]
 [134598 592938 218862]
 [ 57541  82656 202381]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.906183
{'0': {'precision': 0.5118833077963285, 'recall': 0.487078440901777, 'f1-score': 0.49917291389788515, 'support': 397127}, '1': {'precision': 0.685693962951868, 'recall': 0.6256535298438272, 'f1-score': 0.6542992618971315, 'support': 830490}, '2': {'precision': 0.4508875619258822, 'recall': 0.5546662261733141, 'f1-score': 0.4974216304722316, 'support': 399552}, 'accuracy': 0.5744019213738708, 'macro avg': {'precision': 0.5494882775580262, 'recall': 0.5557993989729727, 'f1-score': 0.5502979354224161, 'support': 1627169}, 'weighted avg': {'precision': 0.585616914290857, 'recall': 0.5744019213738708, 'f1-score': 0.577917747381443, 'support': 1627169}}
[[193432 129209  74486]
 [115480 519599 195411]
 [ 68971 108963 221618]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9642783
{'0': {'precision': 0.5368727459801672, 'recall': 0.42328490158787974, 'f1-score': 0.47336003212185945, 'support': 483223}, '1': {'precision': 0.5549206426235519, 'recall': 0.6202112272877934, 'f1-score': 0.5857521553472105, 'support': 663740}, '2': {'precision': 0.4783513003892146, 'recall': 0.5024010528814717, 'f1-score': 0.4900813057675803, 'support': 480206}, 'accuracy': 0.5269618582949896, 'macro avg': {'precision': 0.5233815629976445, 'recall': 0.515299060585715, 'f1-score': 0.5163978310788834, 'support': 1627169}, 'weighted avg': {'precision': 0.5269639790460817, 'recall': 0.5269618582949896, 'f1-score': 0.5241407462344756, 'support': 1627169}}
[[204541 177307 101375]
 [ 90363 411659 161718]
 [ 86082 152868 241256]]
Evaluating performance on  train set...
1701/1701 - 16s - 16s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8082192
{'0': {'precision': 0.4125627336892408, 'recall': 0.6112814587684605, 'f1-score': 0.49263735935774616, 'support': 67509}, '1': {'precision': 0.8741434277547729, 'recall': 0.6412284533449817, 'f1-score': 0.7397862467582309, 'support': 297610}, '2': {'precision': 0.3907584557567475, 'recall': 0.650791618657449, 'f1-score': 0.4883151260279967, 'support': 70299}, 'accuracy': 0.6381293377857599, 'macro avg': {'precision': 0.5591548724002537, 'recall': 0.6344338435902971, 'f1-score': 0.5735795773813246, 'support': 435418}, 'weighted avg': {'precision': 0.7245347041325083, 'recall': 0.6381293377857599, 'f1-score': 0.6608668117423747, 'support': 435418}}
[[ 41267  14713  11529]
 [ 46973 190836  59801]
 [ 11786  12763  45750]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.82541907
{'0': {'precision': 0.48798665403143016, 'recall': 0.557095687255598, 'f1-score': 0.520256155250709, 'support': 88737}, '1': {'precision': 0.789771900422963, 'recall': 0.6581720876008357, 'f1-score': 0.7179916139426206, 'support': 255614}, '2': {'precision': 0.45303196716573213, 'recall': 0.6024026266375306, 'f1-score': 0.517147435897436, 'support': 91067}, 'accuracy': 0.6259088967383066, 'macro avg': {'precision': 0.5769301738733751, 'recall': 0.6058901338313214, 'f1-score': 0.5851317350302552, 'support': 435418}, 'weighted avg': {'precision': 0.6578402556334005, 'recall': 0.6259088967383066, 'f1-score': 0.6356874185258372, 'support': 435418}}
[[ 49435  23914  15388]
 [ 36530 168238  50846]
 [ 15339  20869  54859]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.85726106
{'0': {'precision': 0.5217476623593246, 'recall': 0.5132669903381176, 'f1-score': 0.5174725820106849, 'support': 103603}, '1': {'precision': 0.7156069419190236, 'recall': 0.6645316996194189, 'f1-score': 0.6891242416672206, 'support': 226233}, '2': {'precision': 0.48383881762861286, 'recall': 0.5655509461840086, 'f1-score': 0.5215135701652873, 'support': 105582}, 'accuracy': 0.6045386272501366, 'macro avg': {'precision': 0.5737311406356537, 'recall': 0.581116545380515, 'f1-score': 0.576036797947731, 'support': 435418}, 'weighted avg': {'precision': 0.6132801087631743, 'recall': 0.6045386272501366, 'f1-score': 0.6076386420505001, 'support': 435418}}
[[ 53176  32054  18373]
 [ 30566 150339  45328]
 [ 18177  27693  59712]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.91617006
{'0': {'precision': 0.5453175923829029, 'recall': 0.44514371141975306, 'f1-score': 0.49016492828916214, 'support': 124416}, '1': {'precision': 0.5918716011357621, 'recall': 0.6664228237015362, 'f1-score': 0.626938713089579, 'support': 184545}, '2': {'precision': 0.5099193286109767, 'recall': 0.508346710739619, 'f1-score': 0.5091318052937542, 'support': 126457}, 'accuracy': 0.5572851834329311, 'macro avg': {'precision': 0.5490361740432138, 'recall': 0.5399710819536362, 'f1-score': 0.5420784822241651, 'support': 435418}, 'weighted avg': {'precision': 0.5547681693078117, 'recall': 0.5572851834329311, 'f1-score': 0.5536428104193512, 'support': 435418}}
[[ 55383  44981  24052]
 [ 23829 122985  37731]
 [ 22349  39824  64284]]
Evaluating performance on  val set...
563/563 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.82639
{'0': {'precision': 0.41304548674201597, 'recall': 0.6018127972718299, 'f1-score': 0.4898734408386143, 'support': 22286}, '1': {'precision': 0.8627638490430058, 'recall': 0.6279480299392741, 'f1-score': 0.7268619334800657, 'support': 99134}, '2': {'precision': 0.3705845061493597, 'recall': 0.6455232121560139, 'f1-score': 0.47085736379160353, 'support': 22639}, 'accuracy': 0.6266668517760084, 'macro avg': {'precision': 0.5487979473114605, 'recall': 0.6250946797890393, 'f1-score': 0.5625309127034278, 'support': 144059}, 'weighted avg': {'precision': 0.7158457698809325, 'recall': 0.6266668517760084, 'f1-score': 0.6499683482116375, 'support': 144059}}
[[13412  5455  3419]
 [15481 62251 21402]
 [ 3578  4447 14614]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8500807
{'0': {'precision': 0.4887596432015429, 'recall': 0.5467570118662352, 'f1-score': 0.5161341649694501, 'support': 29664}, '1': {'precision': 0.7745946639668031, 'recall': 0.6419286220751595, 'f1-score': 0.7020491511951766, 'support': 84620}, '2': {'precision': 0.4355796603514283, 'recall': 0.5961041141897565, 'f1-score': 0.5033535158742538, 'support': 29775}, 'accuracy': 0.6128600087464164, 'macro avg': {'precision': 0.5663113225065914, 'recall': 0.594929916043717, 'f1-score': 0.5738456106796268, 'support': 144059}, 'weighted avg': {'precision': 0.645667059383761, 'recall': 0.6128600087464164, 'f1-score': 0.6226987135753096, 'support': 144059}}
[[16219  8626  4819]
 [12120 54320 18180]
 [ 4845  7181 17749]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8831208
{'0': {'precision': 0.5212180688137509, 'recall': 0.5025230804518608, 'f1-score': 0.5116998759214656, 'support': 34878}, '1': {'precision': 0.6973201201375487, 'recall': 0.6463152232383002, 'f1-score': 0.6708495892686399, 'support': 74360}, '2': {'precision': 0.46602105466021054, 'recall': 0.5555555555555556, 'f1-score': 0.5068647487292355, 'support': 34821}, 'accuracy': 0.5895639980841183, 'macro avg': {'precision': 0.5615197478705034, 'recall': 0.5681312864152389, 'f1-score': 0.563138071306447, 'support': 144059}, 'weighted avg': {'precision': 0.5987761061914723, 'recall': 0.5895639980841183, 'f1-score': 0.5926806457486561, 'support': 144059}}
[[17527 11344  6007]
 [10141 48060 16159]
 [ 5959  9517 19345]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9453922
{'0': {'precision': 0.5401727606200449, 'recall': 0.43467910874119214, 'f1-score': 0.48171793383633194, 'support': 42008}, '1': {'precision': 0.5721657062213337, 'recall': 0.6445154666490032, 'f1-score': 0.6061894526991247, 'support': 60388}, '2': {'precision': 0.4904927659775994, 'recall': 0.49717975181816, 'f1-score': 0.49381362195151024, 'support': 41663}, 'accuracy': 0.5407159566566476, 'macro avg': {'precision': 0.534277077606326, 'recall': 0.5254581090694518, 'f1-score': 0.5272403361623224, 'support': 144059}, 'weighted avg': {'precision': 0.539216016384575, 'recall': 0.5407159566566476, 'f1-score': 0.5373932386422032, 'support': 144059}}
[[18260 15625  8123]
 [ 8073 38921 13394]
 [ 7471 13478 20714]]
training model: results/AAL/W5/deepVOL_L3/seq2seq
Epoch 1/50
1701/1701 - 76s - loss: 12.5050 - accuracy10: 0.4179 - accuracy20: 0.4292 - accuracy30: 0.4347 - accuracy50: 0.4335 - val_loss: 12.5873 - val_accuracy10: 0.4832 - val_accuracy20: 0.4943 - val_accuracy30: 0.4826 - val_accuracy50: 0.4279 - 76s/epoch - 45ms/step
Epoch 2/50
1701/1701 - 70s - loss: 11.6913 - accuracy10: 0.4434 - accuracy20: 0.4687 - accuracy30: 0.4789 - accuracy50: 0.4788 - val_loss: 11.5369 - val_accuracy10: 0.5523 - val_accuracy20: 0.5495 - val_accuracy30: 0.5364 - val_accuracy50: 0.5036 - 70s/epoch - 41ms/step
Epoch 3/50
1701/1701 - 70s - loss: 10.9971 - accuracy10: 0.5603 - accuracy20: 0.5607 - accuracy30: 0.5505 - accuracy50: 0.5259 - val_loss: 11.4754 - val_accuracy10: 0.5785 - val_accuracy20: 0.5668 - val_accuracy30: 0.5454 - val_accuracy50: 0.5060 - 70s/epoch - 41ms/step
Epoch 4/50
1701/1701 - 69s - loss: 10.6547 - accuracy10: 0.5898 - accuracy20: 0.5830 - accuracy30: 0.5671 - accuracy50: 0.5367 - val_loss: 11.1915 - val_accuracy10: 0.6316 - val_accuracy20: 0.6070 - val_accuracy30: 0.5773 - val_accuracy50: 0.5221 - 69s/epoch - 40ms/step
Epoch 5/50
1701/1701 - 70s - loss: 10.4606 - accuracy10: 0.6019 - accuracy20: 0.5937 - accuracy30: 0.5772 - accuracy50: 0.5450 - val_loss: 11.1731 - val_accuracy10: 0.6440 - val_accuracy20: 0.6181 - val_accuracy30: 0.5867 - val_accuracy50: 0.5277 - 70s/epoch - 41ms/step
Epoch 6/50
1701/1701 - 69s - loss: 10.3257 - accuracy10: 0.6097 - accuracy20: 0.6006 - accuracy30: 0.5838 - accuracy50: 0.5505 - val_loss: 10.9812 - val_accuracy10: 0.6367 - val_accuracy20: 0.6138 - val_accuracy30: 0.5838 - val_accuracy50: 0.5282 - 69s/epoch - 41ms/step
Epoch 7/50
1701/1701 - 69s - loss: 10.2473 - accuracy10: 0.6129 - accuracy20: 0.6041 - accuracy30: 0.5872 - accuracy50: 0.5530 - val_loss: 11.0321 - val_accuracy10: 0.6486 - val_accuracy20: 0.6218 - val_accuracy30: 0.5885 - val_accuracy50: 0.5282 - 69s/epoch - 41ms/step
Epoch 8/50
1701/1701 - 71s - loss: 10.1715 - accuracy10: 0.6183 - accuracy20: 0.6089 - accuracy30: 0.5913 - accuracy50: 0.5562 - val_loss: 10.9768 - val_accuracy10: 0.6348 - val_accuracy20: 0.6163 - val_accuracy30: 0.5892 - val_accuracy50: 0.5345 - 71s/epoch - 42ms/step
Epoch 9/50
1701/1701 - 70s - loss: 10.1111 - accuracy10: 0.6212 - accuracy20: 0.6122 - accuracy30: 0.5941 - accuracy50: 0.5580 - val_loss: 10.8525 - val_accuracy10: 0.6335 - val_accuracy20: 0.6152 - val_accuracy30: 0.5888 - val_accuracy50: 0.5344 - 70s/epoch - 41ms/step
Epoch 10/50
1701/1701 - 70s - loss: 10.0716 - accuracy10: 0.6244 - accuracy20: 0.6153 - accuracy30: 0.5966 - accuracy50: 0.5600 - val_loss: 10.8272 - val_accuracy10: 0.6381 - val_accuracy20: 0.6182 - val_accuracy30: 0.5910 - val_accuracy50: 0.5359 - 70s/epoch - 41ms/step
Epoch 11/50
1701/1701 - 70s - loss: 10.0332 - accuracy10: 0.6260 - accuracy20: 0.6159 - accuracy30: 0.5973 - accuracy50: 0.5614 - val_loss: 10.8034 - val_accuracy10: 0.6381 - val_accuracy20: 0.6203 - val_accuracy30: 0.5936 - val_accuracy50: 0.5403 - 70s/epoch - 41ms/step
Epoch 12/50
1701/1701 - 71s - loss: 9.9994 - accuracy10: 0.6273 - accuracy20: 0.6172 - accuracy30: 0.5993 - accuracy50: 0.5636 - val_loss: 10.7911 - val_accuracy10: 0.6460 - val_accuracy20: 0.6250 - val_accuracy30: 0.5972 - val_accuracy50: 0.5405 - 71s/epoch - 42ms/step
Epoch 13/50
1701/1701 - 70s - loss: 9.9676 - accuracy10: 0.6286 - accuracy20: 0.6186 - accuracy30: 0.5998 - accuracy50: 0.5639 - val_loss: 10.8120 - val_accuracy10: 0.6487 - val_accuracy20: 0.6278 - val_accuracy30: 0.5996 - val_accuracy50: 0.5424 - 70s/epoch - 41ms/step
Epoch 14/50
1701/1701 - 70s - loss: 9.9474 - accuracy10: 0.6304 - accuracy20: 0.6203 - accuracy30: 0.6017 - accuracy50: 0.5662 - val_loss: 10.7798 - val_accuracy10: 0.6455 - val_accuracy20: 0.6220 - val_accuracy30: 0.5911 - val_accuracy50: 0.5346 - 70s/epoch - 41ms/step
Epoch 15/50
1701/1701 - 71s - loss: 9.9243 - accuracy10: 0.6308 - accuracy20: 0.6211 - accuracy30: 0.6031 - accuracy50: 0.5668 - val_loss: 10.8228 - val_accuracy10: 0.6294 - val_accuracy20: 0.6144 - val_accuracy30: 0.5898 - val_accuracy50: 0.5396 - 71s/epoch - 42ms/step
Epoch 16/50
1701/1701 - 71s - loss: 9.8926 - accuracy10: 0.6325 - accuracy20: 0.6217 - accuracy30: 0.6035 - accuracy50: 0.5679 - val_loss: 10.8673 - val_accuracy10: 0.6344 - val_accuracy20: 0.6181 - val_accuracy30: 0.5932 - val_accuracy50: 0.5414 - 71s/epoch - 42ms/step
Epoch 17/50
1701/1701 - 70s - loss: 9.8700 - accuracy10: 0.6340 - accuracy20: 0.6237 - accuracy30: 0.6054 - accuracy50: 0.5689 - val_loss: 10.7291 - val_accuracy10: 0.6442 - val_accuracy20: 0.6255 - val_accuracy30: 0.5976 - val_accuracy50: 0.5448 - 70s/epoch - 41ms/step
Epoch 18/50
1701/1701 - 71s - loss: 9.8520 - accuracy10: 0.6347 - accuracy20: 0.6244 - accuracy30: 0.6057 - accuracy50: 0.5693 - val_loss: 10.8134 - val_accuracy10: 0.6320 - val_accuracy20: 0.6180 - val_accuracy30: 0.5942 - val_accuracy50: 0.5440 - 71s/epoch - 42ms/step
Epoch 19/50
1701/1701 - 69s - loss: 9.8316 - accuracy10: 0.6352 - accuracy20: 0.6248 - accuracy30: 0.6062 - accuracy50: 0.5708 - val_loss: 10.8357 - val_accuracy10: 0.6508 - val_accuracy20: 0.6311 - val_accuracy30: 0.6037 - val_accuracy50: 0.5484 - 69s/epoch - 41ms/step
Epoch 20/50
1701/1701 - 70s - loss: 9.8084 - accuracy10: 0.6362 - accuracy20: 0.6260 - accuracy30: 0.6077 - accuracy50: 0.5713 - val_loss: 10.8476 - val_accuracy10: 0.6607 - val_accuracy20: 0.6338 - val_accuracy30: 0.6024 - val_accuracy50: 0.5434 - 70s/epoch - 41ms/step
Epoch 21/50
1701/1701 - 69s - loss: 9.7932 - accuracy10: 0.6357 - accuracy20: 0.6259 - accuracy30: 0.6085 - accuracy50: 0.5731 - val_loss: 10.7730 - val_accuracy10: 0.6550 - val_accuracy20: 0.6329 - val_accuracy30: 0.6032 - val_accuracy50: 0.5458 - 69s/epoch - 41ms/step
Epoch 22/50
1701/1701 - 71s - loss: 9.7844 - accuracy10: 0.6368 - accuracy20: 0.6266 - accuracy30: 0.6086 - accuracy50: 0.5729 - val_loss: 10.7346 - val_accuracy10: 0.6483 - val_accuracy20: 0.6289 - val_accuracy30: 0.6015 - val_accuracy50: 0.5467 - 71s/epoch - 42ms/step
Epoch 23/50
1701/1701 - 71s - loss: 9.7592 - accuracy10: 0.6374 - accuracy20: 0.6275 - accuracy30: 0.6097 - accuracy50: 0.5742 - val_loss: 10.7095 - val_accuracy10: 0.6419 - val_accuracy20: 0.6233 - val_accuracy30: 0.5985 - val_accuracy50: 0.5468 - 71s/epoch - 42ms/step
Epoch 24/50
1701/1701 - 71s - loss: 9.7439 - accuracy10: 0.6378 - accuracy20: 0.6279 - accuracy30: 0.6096 - accuracy50: 0.5744 - val_loss: 10.7024 - val_accuracy10: 0.6342 - val_accuracy20: 0.6189 - val_accuracy30: 0.5953 - val_accuracy50: 0.5461 - 71s/epoch - 42ms/step
Epoch 25/50
1701/1701 - 71s - loss: 9.7245 - accuracy10: 0.6384 - accuracy20: 0.6293 - accuracy30: 0.6112 - accuracy50: 0.5760 - val_loss: 10.7351 - val_accuracy10: 0.6400 - val_accuracy20: 0.6213 - val_accuracy30: 0.5945 - val_accuracy50: 0.5421 - 71s/epoch - 42ms/step
Epoch 26/50
1701/1701 - 71s - loss: 9.7114 - accuracy10: 0.6387 - accuracy20: 0.6297 - accuracy30: 0.6118 - accuracy50: 0.5767 - val_loss: 10.7413 - val_accuracy10: 0.6499 - val_accuracy20: 0.6291 - val_accuracy30: 0.6016 - val_accuracy50: 0.5484 - 71s/epoch - 42ms/step
Epoch 27/50
1701/1701 - 71s - loss: 9.6935 - accuracy10: 0.6396 - accuracy20: 0.6302 - accuracy30: 0.6129 - accuracy50: 0.5774 - val_loss: 10.7644 - val_accuracy10: 0.6406 - val_accuracy20: 0.6216 - val_accuracy30: 0.5967 - val_accuracy50: 0.5468 - 71s/epoch - 42ms/step
Epoch 28/50
1701/1701 - 71s - loss: 9.6843 - accuracy10: 0.6398 - accuracy20: 0.6307 - accuracy30: 0.6125 - accuracy50: 0.5778 - val_loss: 10.6812 - val_accuracy10: 0.6419 - val_accuracy20: 0.6235 - val_accuracy30: 0.5976 - val_accuracy50: 0.5475 - 71s/epoch - 42ms/step
Epoch 29/50
1701/1701 - 70s - loss: 9.6631 - accuracy10: 0.6411 - accuracy20: 0.6313 - accuracy30: 0.6134 - accuracy50: 0.5775 - val_loss: 10.8001 - val_accuracy10: 0.6443 - val_accuracy20: 0.6242 - val_accuracy30: 0.5964 - val_accuracy50: 0.5451 - 70s/epoch - 41ms/step
Epoch 30/50
1701/1701 - 71s - loss: 9.6534 - accuracy10: 0.6406 - accuracy20: 0.6317 - accuracy30: 0.6138 - accuracy50: 0.5786 - val_loss: 10.8502 - val_accuracy10: 0.6424 - val_accuracy20: 0.6234 - val_accuracy30: 0.5971 - val_accuracy50: 0.5448 - 71s/epoch - 42ms/step
Epoch 31/50
1701/1701 - 71s - loss: 9.6335 - accuracy10: 0.6414 - accuracy20: 0.6325 - accuracy30: 0.6146 - accuracy50: 0.5797 - val_loss: 10.7840 - val_accuracy10: 0.6492 - val_accuracy20: 0.6278 - val_accuracy30: 0.5998 - val_accuracy50: 0.5458 - 71s/epoch - 42ms/step
Epoch 32/50
1701/1701 - 70s - loss: 9.6158 - accuracy10: 0.6425 - accuracy20: 0.6335 - accuracy30: 0.6157 - accuracy50: 0.5807 - val_loss: 10.9331 - val_accuracy10: 0.6388 - val_accuracy20: 0.6205 - val_accuracy30: 0.5943 - val_accuracy50: 0.5431 - 70s/epoch - 41ms/step
Epoch 33/50
1701/1701 - 71s - loss: 9.6032 - accuracy10: 0.6420 - accuracy20: 0.6332 - accuracy30: 0.6155 - accuracy50: 0.5811 - val_loss: 10.9232 - val_accuracy10: 0.6361 - val_accuracy20: 0.6177 - val_accuracy30: 0.5916 - val_accuracy50: 0.5397 - 71s/epoch - 42ms/step
Epoch 34/50
1701/1701 - 71s - loss: 9.5898 - accuracy10: 0.6428 - accuracy20: 0.6334 - accuracy30: 0.6162 - accuracy50: 0.5817 - val_loss: 10.9871 - val_accuracy10: 0.6547 - val_accuracy20: 0.6305 - val_accuracy30: 0.5998 - val_accuracy50: 0.5418 - 71s/epoch - 42ms/step
Epoch 35/50
1701/1701 - 70s - loss: 9.5712 - accuracy10: 0.6429 - accuracy20: 0.6343 - accuracy30: 0.6167 - accuracy50: 0.5824 - val_loss: 10.8911 - val_accuracy10: 0.6358 - val_accuracy20: 0.6184 - val_accuracy30: 0.5932 - val_accuracy50: 0.5421 - 70s/epoch - 41ms/step
Epoch 36/50
1701/1701 - 70s - loss: 9.5657 - accuracy10: 0.6431 - accuracy20: 0.6342 - accuracy30: 0.6169 - accuracy50: 0.5823 - val_loss: 11.0310 - val_accuracy10: 0.6537 - val_accuracy20: 0.6299 - val_accuracy30: 0.5991 - val_accuracy50: 0.5430 - 70s/epoch - 41ms/step
Epoch 37/50
1701/1701 - 72s - loss: 9.5408 - accuracy10: 0.6433 - accuracy20: 0.6349 - accuracy30: 0.6177 - accuracy50: 0.5832 - val_loss: 10.9342 - val_accuracy10: 0.6482 - val_accuracy20: 0.6245 - val_accuracy30: 0.5952 - val_accuracy50: 0.5432 - 72s/epoch - 42ms/step
Epoch 38/50
1701/1701 - 72s - loss: 9.5353 - accuracy10: 0.6432 - accuracy20: 0.6356 - accuracy30: 0.6182 - accuracy50: 0.5838 - val_loss: 10.9931 - val_accuracy10: 0.6552 - val_accuracy20: 0.6293 - val_accuracy30: 0.5988 - val_accuracy50: 0.5431 - 72s/epoch - 42ms/step
testing model: results/AAL/W5/deepVOL_L3/seq2seq
Evaluating performance on  test set...
6357/6357 - 108s - 108s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.80802923
{'0': {'precision': 0.42328595488902415, 'recall': 0.6016528604962461, 'f1-score': 0.49694908953396705, 'support': 257735}, '1': {'precision': 0.8613808799361183, 'recall': 0.6376158107225071, 'f1-score': 0.7327969054554954, 'support': 1106439}, '2': {'precision': 0.3712105093998832, 'recall': 0.6236088138557767, 'f1-score': 0.4653913329710602, 'support': 262995}, 'accuracy': 0.6296555551390175, 'macro avg': {'precision': 0.5519591147416752, 'recall': 0.6209591616915099, 'f1-score': 0.5650457759868409, 'support': 1627169}, 'weighted avg': {'precision': 0.7127640170864759, 'recall': 0.6296555551390175, 'f1-score': 0.6522198016807313, 'support': 1627169}}
[[155067  61780  40888]
 [164036 705483 236920]
 [ 47238  51751 164006]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.852027
{'0': {'precision': 0.4892517380168313, 'recall': 0.537707758587552, 'f1-score': 0.5123365747216787, 'support': 338193}, '1': {'precision': 0.7723342024483388, 'recall': 0.6425721525193417, 'f1-score': 0.7015028933739919, 'support': 946398}, '2': {'precision': 0.42782370911576834, 'recall': 0.5845676021227283, 'f1-score': 0.49406168739854056, 'support': 342578}, 'accuracy': 0.6085649370163763, 'macro avg': {'precision': 0.5631365498603128, 'recall': 0.588282504409874, 'f1-score': 0.569300385164737, 'support': 1627169}, 'weighted avg': {'precision': 0.6409660263840393, 'recall': 0.6085649370163763, 'f1-score': 0.6185124244892971, 'support': 1627169}}
[[181849  97231  59113]
 [129552 608129 208717]
 [ 60287  82031 200260]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.894326
{'0': {'precision': 0.519396448123915, 'recall': 0.4897375398801895, 'f1-score': 0.504131149580664, 'support': 397127}, '1': {'precision': 0.6947424406579337, 'recall': 0.6370082722248311, 'f1-score': 0.6646239081889364, 'support': 830490}, '2': {'precision': 0.45369918004087584, 'recall': 0.557817255325965, 'f1-score': 0.5003996425668727, 'support': 399552}, 'accuracy': 0.5816199792400175, 'macro avg': {'precision': 0.5559460229409082, 'recall': 0.5615210224769952, 'f1-score': 0.5563849001121577, 'support': 1627169}, 'weighted avg': {'precision': 0.592759214058162, 'recall': 0.5816199792400175, 'f1-score': 0.5851286980874323, 'support': 1627169}}
[[194488 126053  76586]
 [109680 529029 191781]
 [ 70282 106393 222877]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9582399
{'0': {'precision': 0.5440803554966506, 'recall': 0.4213686020739907, 'f1-score': 0.4749259440673617, 'support': 483223}, '1': {'precision': 0.5653980701694569, 'recall': 0.6245879410612589, 'f1-score': 0.5935209543546188, 'support': 663740}, '2': {'precision': 0.47700146428660767, 'recall': 0.5162388641541339, 'f1-score': 0.49584513852705187, 'support': 480206}, 'accuracy': 0.5322618609376162, 'macro avg': {'precision': 0.5288266299842383, 'recall': 0.5207318024297946, 'f1-score': 0.5214306789830109, 'support': 1627169}, 'weighted avg': {'precision': 0.5329799313271381, 'recall': 0.5322618609376162, 'f1-score': 0.5294757633072649, 'support': 1627169}}
[[203615 171657 107951]
 [ 85321 414564 163855]
 [ 85301 147004 247901]]
Evaluating performance on  train set...
1701/1701 - 30s - 30s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.77328724
{'0': {'precision': 0.4254626263453799, 'recall': 0.6154142410641544, 'f1-score': 0.503106116567166, 'support': 67509}, '1': {'precision': 0.8742646316907, 'recall': 0.6696213164880213, 'f1-score': 0.7583801566718739, 'support': 297610}, '2': {'precision': 0.4025240844275282, 'recall': 0.6288282905873483, 'f1-score': 0.49084781896613944, 'support': 70299}, 'accuracy': 0.6546307226619019, 'macro avg': {'precision': 0.567417114154536, 'recall': 0.637954616046508, 'f1-score': 0.5841113640683931, 'support': 435418}, 'weighted avg': {'precision': 0.7285171813994604, 'recall': 0.6546307226619019, 'f1-score': 0.6756078528585172, 'support': 435418}}
[[ 41546  15224  10739]
 [ 43447 199286  54877]
 [ 12656  13437  44206]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.80304813
{'0': {'precision': 0.5017327685791297, 'recall': 0.5579859585065982, 'f1-score': 0.5283663157670083, 'support': 88737}, '1': {'precision': 0.7919975772149724, 'recall': 0.6854710618354237, 'f1-score': 0.734894001639939, 'support': 255614}, '2': {'precision': 0.46398670118356006, 'recall': 0.5884678313768983, 'f1-score': 0.5188656410057801, 'support': 91067}, 'accuracy': 0.639201870386617, 'macro avg': {'precision': 0.5859056823258875, 'recall': 0.61064161723964, 'f1-score': 0.5940419861375758, 'support': 435418}, 'weighted avg': {'precision': 0.6642394349896363, 'recall': 0.639201870386617, 'f1-score': 0.647622226060663, 'support': 435418}}
[[ 49514  24699  14524]
 [ 33013 175216  47385]
 [ 16159  21318  53590]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8406732
{'0': {'precision': 0.5343349153088883, 'recall': 0.5118481125063946, 'f1-score': 0.5228498466817191, 'support': 103603}, '1': {'precision': 0.7194605027427369, 'recall': 0.6887368332648199, 'f1-score': 0.7037635076388027, 'support': 226233}, '2': {'precision': 0.49178532311062434, 'recall': 0.5570930651057946, 'f1-score': 0.5224060217154783, 'support': 105582}, 'accuracy': 0.6147265386364367, 'macro avg': {'precision': 0.5818602470540831, 'recall': 0.5858926702923364, 'f1-score': 0.5830064586786667, 'support': 435418}, 'weighted avg': {'precision': 0.6202042316404243, 'recall': 0.6147265386364367, 'f1-score': 0.6167407293087999, 'support': 435418}}
[[ 53029  32748  17826]
 [ 27460 155815  42958]
 [ 18754  28009  58819]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.90663624
{'0': {'precision': 0.5576317680760393, 'recall': 0.4427806712962963, 'f1-score': 0.4936135515463224, 'support': 124416}, '1': {'precision': 0.5986971484759095, 'recall': 0.6862608035980384, 'f1-score': 0.6394954567373844, 'support': 184545}, '2': {'precision': 0.5153927940459345, 'recall': 0.5098254742718868, 'f1-score': 0.5125940178415253, 'support': 126457}, 'accuracy': 0.5654474550891327, 'macro avg': {'precision': 0.5572405701992945, 'recall': 0.5462889830554072, 'f1-score': 0.5485676753750773, 'support': 435418}, 'weighted avg': {'precision': 0.5627693523903513, 'recall': 0.5654474550891327, 'f1-score': 0.5609557124578534, 'support': 435418}}
[[ 55089  45253  24074]
 [ 21353 126646  36546]
 [ 22349  39637  64471]]
Evaluating performance on  val set...
563/563 - 10s - 10s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7939354
{'0': {'precision': 0.41678054981725726, 'recall': 0.5884411738311047, 'f1-score': 0.48795371248906994, 'support': 22286}, '1': {'precision': 0.8619082820709137, 'recall': 0.658633768434644, 'f1-score': 0.7466835917844563, 'support': 99134}, '2': {'precision': 0.3839033659066232, 'recall': 0.6247184062900305, 'f1-score': 0.47556280367860926, 'support': 22639}, 'accuracy': 0.642445109295497, 'macro avg': {'precision': 0.5541973992649315, 'recall': 0.6239311161852598, 'f1-score': 0.5700667026507118, 'support': 144059}, 'weighted avg': {'precision': 0.7179278994634518, 'recall': 0.642445109295497, 'f1-score': 0.6640510758576121, 'support': 144059}}
[[13114  5729  3443]
 [14587 65293 19254]
 [ 3764  4732 14143]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8317834
{'0': {'precision': 0.4904377125386079, 'recall': 0.5299352750809061, 'f1-score': 0.5094220393084563, 'support': 29664}, '1': {'precision': 0.7749315311141693, 'recall': 0.672098794611203, 'f1-score': 0.719861275480821, 'support': 84620}, '2': {'precision': 0.44796063705813804, 'recall': 0.5809571788413098, 'f1-score': 0.5058634303260712, 'support': 29775}, 'accuracy': 0.6239873940538252, 'macro avg': {'precision': 0.5711099602369717, 'recall': 0.5943304161778064, 'f1-score': 0.5783822483717829, 'support': 144059}, 'weighted avg': {'precision': 0.648769451655449, 'recall': 0.6239873940538252, 'f1-score': 0.6322981566107767, 'support': 144059}}
[[15720  9075  4869]
 [11299 56873 16448]
 [ 5034  7443 17298]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8706507
{'0': {'precision': 0.5241793261347112, 'recall': 0.4857503297207409, 'f1-score': 0.5042336939537791, 'support': 34878}, '1': {'precision': 0.6992240922158028, 'recall': 0.6738165680473372, 'f1-score': 0.686285252503116, 'support': 74360}, '2': {'precision': 0.474750499001996, 'recall': 0.5464518537664054, 'f1-score': 0.5080840042189023, 'support': 34821}, 'accuracy': 0.59749824724592, 'macro avg': {'precision': 0.56605130578417, 'recall': 0.5686729171781612, 'f1-score': 0.5662009835585992, 'support': 144059}, 'weighted avg': {'precision': 0.6025858652346752, 'recall': 0.59749824724592, 'f1-score': 0.5991352658616123, 'support': 144059}}
[[16942 11784  6152]
 [ 9355 50105 14900]
 [ 6024  9769 19028]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.93910676
{'0': {'precision': 0.5463627366076952, 'recall': 0.4205151399733384, 'f1-score': 0.4752488566047889, 'support': 42008}, '1': {'precision': 0.5792764242797941, 'recall': 0.6689574087567066, 'f1-score': 0.620895292987512, 'support': 60388}, '2': {'precision': 0.4956894498690164, 'recall': 0.49957996303674723, 'f1-score': 0.49762710243505914, 'support': 41663}, 'accuracy': 0.5475256665671704, 'macro avg': {'precision': 0.5404428702521685, 'recall': 0.5296841705889307, 'f1-score': 0.5312570840091201, 'support': 144059}, 'weighted avg': {'precision': 0.5455046897362685, 'recall': 0.5475256665671704, 'f1-score': 0.5427742583936839, 'support': 144059}}
[[17665 15849  8494]
 [ 7309 40397 12682]
 [ 7358 13491 20814]]
training model: results/AAL/W6/deepLOB_L1/seq2seq
Epoch 1/50
1766/1766 - 56s - loss: 11.6799 - accuracy10: 0.4551 - accuracy20: 0.4717 - accuracy30: 0.4790 - accuracy50: 0.4819 - val_loss: 12.1031 - val_accuracy10: 0.5708 - val_accuracy20: 0.5414 - val_accuracy30: 0.5177 - val_accuracy50: 0.4807 - 56s/epoch - 32ms/step
Epoch 2/50
1766/1766 - 46s - loss: 11.4808 - accuracy10: 0.4592 - accuracy20: 0.4817 - accuracy30: 0.4928 - accuracy50: 0.4963 - val_loss: 11.1518 - val_accuracy10: 0.5978 - val_accuracy20: 0.5890 - val_accuracy30: 0.5774 - val_accuracy50: 0.5409 - 46s/epoch - 26ms/step
Epoch 3/50
1766/1766 - 49s - loss: 10.9316 - accuracy10: 0.5311 - accuracy20: 0.5366 - accuracy30: 0.5337 - accuracy50: 0.5232 - val_loss: 10.9974 - val_accuracy10: 0.6214 - val_accuracy20: 0.6022 - val_accuracy30: 0.5839 - val_accuracy50: 0.5466 - 49s/epoch - 27ms/step
Epoch 4/50
1766/1766 - 44s - loss: 10.7263 - accuracy10: 0.5586 - accuracy20: 0.5557 - accuracy30: 0.5458 - accuracy50: 0.5293 - val_loss: 10.6525 - val_accuracy10: 0.6611 - val_accuracy20: 0.6377 - val_accuracy30: 0.6144 - val_accuracy50: 0.5693 - 44s/epoch - 25ms/step
Epoch 5/50
1766/1766 - 44s - loss: 10.5398 - accuracy10: 0.5757 - accuracy20: 0.5687 - accuracy30: 0.5551 - accuracy50: 0.5365 - val_loss: 10.5925 - val_accuracy10: 0.6616 - val_accuracy20: 0.6378 - val_accuracy30: 0.6144 - val_accuracy50: 0.5709 - 44s/epoch - 25ms/step
Epoch 6/50
1766/1766 - 42s - loss: 10.4124 - accuracy10: 0.5858 - accuracy20: 0.5773 - accuracy30: 0.5625 - accuracy50: 0.5418 - val_loss: 10.3476 - val_accuracy10: 0.6583 - val_accuracy20: 0.6355 - val_accuracy30: 0.6116 - val_accuracy50: 0.5690 - 42s/epoch - 24ms/step
Epoch 7/50
1766/1766 - 44s - loss: 10.3159 - accuracy10: 0.5960 - accuracy20: 0.5860 - accuracy30: 0.5693 - accuracy50: 0.5463 - val_loss: 10.4956 - val_accuracy10: 0.6323 - val_accuracy20: 0.6113 - val_accuracy30: 0.5892 - val_accuracy50: 0.5504 - 44s/epoch - 25ms/step
Epoch 8/50
1766/1766 - 41s - loss: 10.2297 - accuracy10: 0.6018 - accuracy20: 0.5911 - accuracy30: 0.5742 - accuracy50: 0.5503 - val_loss: 10.6317 - val_accuracy10: 0.6479 - val_accuracy20: 0.6241 - val_accuracy30: 0.6019 - val_accuracy50: 0.5608 - 41s/epoch - 23ms/step
Epoch 9/50
1766/1766 - 43s - loss: 10.1624 - accuracy10: 0.6083 - accuracy20: 0.5967 - accuracy30: 0.5790 - accuracy50: 0.5540 - val_loss: 10.6735 - val_accuracy10: 0.6701 - val_accuracy20: 0.6429 - val_accuracy30: 0.6168 - val_accuracy50: 0.5695 - 43s/epoch - 25ms/step
Epoch 10/50
1766/1766 - 42s - loss: 10.0961 - accuracy10: 0.6130 - accuracy20: 0.6015 - accuracy30: 0.5834 - accuracy50: 0.5568 - val_loss: 10.7491 - val_accuracy10: 0.6429 - val_accuracy20: 0.6187 - val_accuracy30: 0.5961 - val_accuracy50: 0.5537 - 42s/epoch - 24ms/step
Epoch 11/50
1766/1766 - 43s - loss: 10.0387 - accuracy10: 0.6168 - accuracy20: 0.6041 - accuracy30: 0.5864 - accuracy50: 0.5593 - val_loss: 10.8808 - val_accuracy10: 0.6498 - val_accuracy20: 0.6236 - val_accuracy30: 0.5982 - val_accuracy50: 0.5541 - 43s/epoch - 24ms/step
Epoch 12/50
1766/1766 - 43s - loss: 10.0026 - accuracy10: 0.6206 - accuracy20: 0.6078 - accuracy30: 0.5892 - accuracy50: 0.5612 - val_loss: 11.1373 - val_accuracy10: 0.6280 - val_accuracy20: 0.6053 - val_accuracy30: 0.5837 - val_accuracy50: 0.5456 - 43s/epoch - 24ms/step
Epoch 13/50
1766/1766 - 42s - loss: 9.9616 - accuracy10: 0.6239 - accuracy20: 0.6111 - accuracy30: 0.5923 - accuracy50: 0.5637 - val_loss: 11.2808 - val_accuracy10: 0.6118 - val_accuracy20: 0.5894 - val_accuracy30: 0.5691 - val_accuracy50: 0.5331 - 42s/epoch - 24ms/step
Epoch 14/50
1766/1766 - 42s - loss: 9.9318 - accuracy10: 0.6252 - accuracy20: 0.6123 - accuracy30: 0.5938 - accuracy50: 0.5652 - val_loss: 11.2245 - val_accuracy10: 0.6380 - val_accuracy20: 0.6113 - val_accuracy30: 0.5878 - val_accuracy50: 0.5461 - 42s/epoch - 24ms/step
Epoch 15/50
1766/1766 - 45s - loss: 9.9011 - accuracy10: 0.6278 - accuracy20: 0.6145 - accuracy30: 0.5957 - accuracy50: 0.5667 - val_loss: 11.1541 - val_accuracy10: 0.6234 - val_accuracy20: 0.5982 - val_accuracy30: 0.5760 - val_accuracy50: 0.5384 - 45s/epoch - 25ms/step
Epoch 16/50
1766/1766 - 45s - loss: 9.8673 - accuracy10: 0.6305 - accuracy20: 0.6179 - accuracy30: 0.5980 - accuracy50: 0.5683 - val_loss: 11.1335 - val_accuracy10: 0.6388 - val_accuracy20: 0.6146 - val_accuracy30: 0.5925 - val_accuracy50: 0.5501 - 45s/epoch - 25ms/step
testing model: results/AAL/W6/deepLOB_L1/seq2seq
Evaluating performance on  test set...
6203/6203 - 59s - 59s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.918041
{'0': {'precision': 0.3235487096169468, 'recall': 0.6136531984869286, 'f1-score': 0.4237010164105467, 'support': 202502}, '1': {'precision': 0.9090758521401646, 'recall': 0.4833199554295662, 'f1-score': 0.6311057501750996, 'support': 1181052}, '2': {'precision': 0.25998336467650546, 'recall': 0.7327721221613156, 'f1-score': 0.3837975501247752, 'support': 204320}, 'accuracy': 0.5320396958448844, 'macro avg': {'precision': 0.4975359754778723, 'recall': 0.6099150920259367, 'f1-score': 0.4795347722368071, 'support': 1587874}, 'weighted avg': {'precision': 0.7508813137486982, 'recall': 0.5320396958448844, 'f1-score': 0.5728329370733851, 'support': 1587874}}
[[124266  33605  44631]
 [228694 570826 381532]
 [ 31112  23488 149720]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9318999
{'0': {'precision': 0.37880289857945815, 'recall': 0.5765748774047529, 'f1-score': 0.45721857949650613, 'support': 265100}, '1': {'precision': 0.8480454014466606, 'recall': 0.48065910528856964, 'f1-score': 0.6135611670423332, 'support': 1054217}, '2': {'precision': 0.3178740125278605, 'recall': 0.6946197641469036, 'f1-score': 0.4361539333815753, 'support': 268557}, 'accuracy': 0.5328596601493569, 'macro avg': {'precision': 0.5149074375179931, 'recall': 0.5839512489467421, 'f1-score': 0.5023112266401383, 'support': 1587874}, 'weighted avg': {'precision': 0.6800362110424083, 'recall': 0.5328596601493569, 'f1-score': 0.5574544643640156, 'support': 1587874}}
[[152850  51790  60460]
 [207651 506719 339847]
 [ 43007  39005 186545]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.95070374
{'0': {'precision': 0.4097435209323723, 'recall': 0.5487176031548919, 'f1-score': 0.46915514268430025, 'support': 311643}, '1': {'precision': 0.7902427932681626, 'recall': 0.4744220312737716, 'f1-score': 0.5928979503601424, 'support': 959654}, '2': {'precision': 0.35263340298316626, 'recall': 0.6621011633820524, 'f1-score': 0.4601774574386457, 'support': 316577}, 'accuracy': 0.5264214918815977, 'macro avg': {'precision': 0.5175399057279004, 'recall': 0.5617469326035719, 'f1-score': 0.5074101834943627, 'support': 1587874}, 'weighted avg': {'precision': 0.6283174750900226, 'recall': 0.5264214918815977, 'f1-score': 0.5421509545027058, 'support': 1587874}}
[[171004  66801  73838]
 [193415 455281 310958]
 [ 52925  54046 209606]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9857279
{'0': {'precision': 0.4434685171438505, 'recall': 0.49511263110134307, 'f1-score': 0.4678697515802726, 'support': 381289}, '1': {'precision': 0.684073426078087, 'recall': 0.4729703422462905, 'f1-score': 0.5592639644432862, 'support': 816751}, '2': {'precision': 0.39501705502127277, 'recall': 0.6054217949178369, 'f1-score': 0.4780940574002949, 'support': 389834}, 'accuracy': 0.510805013496033, 'macro avg': {'precision': 0.50751966608107, 'recall': 0.5245015894218235, 'f1-score': 0.5017425911412846, 'support': 1587874}, 'weighted avg': {'precision': 0.5553327284678305, 'recall': 0.510805013496033, 'f1-score': 0.5173901145216154, 'support': 1587874}}
[[188781  95635  96873]
 [165861 386299 264591]
 [ 71050  82770 236014]]
Evaluating performance on  train set...
1766/1766 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.81566447
{'0': {'precision': 0.40835437313939027, 'recall': 0.3688707344055825, 'f1-score': 0.38760965402534225, 'support': 58755}, '1': {'precision': 0.8481329065691205, 'recall': 0.666972309370346, 'f1-score': 0.7467219535596809, 'support': 333723}, '2': {'precision': 0.2873597749071272, 'recall': 0.6589820711441198, 'f1-score': 0.40020409204551255, 'support': 59513}, 'accuracy': 0.6271695675356368, 'macro avg': {'precision': 0.5146156848718794, 'recall': 0.5649417049733495, 'f1-score': 0.5115118998768452, 'support': 451991}, 'weighted avg': {'precision': 0.7171292380972615, 'recall': 0.6271695675356368, 'f1-score': 0.6544148929070733, 'support': 451991}}
[[ 21673  23973  13109]
 [ 26989 222584  84150]
 [  4412  15883  39218]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8655178
{'0': {'precision': 0.47125254853293147, 'recall': 0.3416273600061691, 'f1-score': 0.396104670223229, 'support': 77807}, '1': {'precision': 0.7750386785136428, 'recall': 0.6652710616397852, 'f1-score': 0.7159721136257016, 'support': 295929}, '2': {'precision': 0.345124992053345, 'recall': 0.6243562711647818, 'f1-score': 0.4445283499526894, 'support': 78255}, 'accuracy': 0.6024743855519247, 'macro avg': {'precision': 0.5304720730333065, 'recall': 0.5437515642702454, 'f1-score': 0.5188683779338733, 'support': 451991}, 'weighted avg': {'precision': 0.6483114141447509, 'recall': 0.6024743855519247, 'f1-score': 0.6139130949836319, 'support': 451991}}
[[ 26581  33330  17896]
 [ 24242 196873  74814]
 [  5582  23814  48859]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.90896267
{'0': {'precision': 0.5011038652265472, 'recall': 0.32079799956512284, 'f1-score': 0.39117350726482125, 'support': 91980}, '1': {'precision': 0.7131573226406435, 'recall': 0.6611602327482281, 'f1-score': 0.6861751268101557, 'support': 267929}, '2': {'precision': 0.37892241885663347, 'recall': 0.5955018353206925, 'f1-score': 0.4631432251525581, 'support': 92082}, 'accuracy': 0.5785203687684047, 'macro avg': {'precision': 0.5310612022412747, 'recall': 0.5258200225446811, 'f1-score': 0.5134972864091784, 'support': 451991}, 'weighted avg': {'precision': 0.6019124185978908, 'recall': 0.5785203687684047, 'f1-score': 0.5807051671556166, 'support': 451991}}
[[ 29507  40600  21873]
 [ 22780 177144  68005]
 [  6597  30650  54835]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.97703886
{'0': {'precision': 0.5351372103892635, 'recall': 0.2827246831815015, 'f1-score': 0.36998055406489283, 'support': 113393}, '1': {'precision': 0.6071973596929952, 'recall': 0.6616879459672805, 'f1-score': 0.633272640071983, 'support': 225493}, '2': {'precision': 0.41952389411973706, 'recall': 0.5428495645639008, 'f1-score': 0.47328479644182697, 'support': 113105}, 'accuracy': 0.5368779466847792, 'macro avg': {'precision': 0.5206194880673319, 'recall': 0.4957540645708942, 'f1-score': 0.49217933019290094, 'support': 451991}, 'weighted avg': {'precision': 0.5421564101305892, 'recall': 0.5368779466847792, 'f1-score': 0.5271844556559421, 'support': 451991}}
[[ 32059  53252  28082]
 [ 19414 149206  56873]
 [  8435  43271  61399]]
Evaluating performance on  val set...
579/579 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7401946
{'0': {'precision': 0.39115106645513836, 'recall': 0.5134197130957889, 'f1-score': 0.4440220110055027, 'support': 17288}, '1': {'precision': 0.885309818767072, 'recall': 0.6840174091231511, 'f1-score': 0.7717540583533411, 'support': 114193}, '2': {'precision': 0.2819304998519555, 'recall': 0.6313061298294256, 'f1-score': 0.3897882475531242, 'support': 16591}, 'accuracy': 0.6581933113620401, 'macro avg': {'precision': 0.519463795024722, 'recall': 0.6095810840161219, 'f1-score': 0.5351881056373227, 'support': 148072}, 'weighted avg': {'precision': 0.7600080548273035, 'recall': 0.6581933113620401, 'f1-score': 0.6906919642265931, 'support': 148072}}
[[ 8876  5889  2523]
 [11929 78110 24154]
 [ 1887  4230 10474]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7856228
{'0': {'precision': 0.44980929628232535, 'recall': 0.4680739706908583, 'f1-score': 0.45875991194135124, 'support': 22928}, '1': {'precision': 0.8223026724309632, 'recall': 0.6812587358285448, 'f1-score': 0.7451652802624524, 'support': 103024}, '2': {'precision': 0.33883170355120945, 'recall': 0.595253164556962, 'f1-score': 0.43184650705149225, 'support': 22120}, 'accuracy': 0.6354003457777297, 'macro avg': {'precision': 0.536981224088166, 'recall': 0.5815286236921217, 'f1-score': 0.5452572330850987, 'support': 148072}, 'weighted avg': {'precision': 0.6924002873753408, 'recall': 0.6354003457777297, 'f1-score': 0.6540115607996733, 'support': 148072}}
[[10732  8623  3573]
 [10718 70186 22120]
 [ 2409  6544 13167]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8325041
{'0': {'precision': 0.4778696792414767, 'recall': 0.43605036447978796, 'f1-score': 0.4560032340654898, 'support': 27162}, '1': {'precision': 0.7663908872901679, 'recall': 0.6757482529311639, 'f1-score': 0.7182209936680769, 'support': 94587}, '2': {'precision': 0.37197583172462206, 'recall': 0.5636515594727045, 'f1-score': 0.44818003322760913, 'support': 26323}, 'accuracy': 0.6118509914095845, 'macro avg': {'precision': 0.5387454660854222, 'recall': 0.5584833922945521, 'f1-score': 0.540801420320392, 'support': 148072}, 'weighted avg': {'precision': 0.643349390176126, 'recall': 0.6118509914095845, 'f1-score': 0.6221147278784617, 'support': 148072}}
[[11844 10839  4479]
 [10099 63917 20571]
 [ 2842  8644 14837]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.905508
{'0': {'precision': 0.5113858424725822, 'recall': 0.37695857953376255, 'f1-score': 0.4340012184390442, 'support': 34017}, '1': {'precision': 0.6635929663423772, 'recall': 0.6762608535008313, 'f1-score': 0.6698670245211662, 'support': 81195}, '2': {'precision': 0.40971877173805027, 'recall': 0.5018867924528302, 'f1-score': 0.4511434511434511, 'support': 32860}, 'accuracy': 0.5688043654438382, 'macro avg': {'precision': 0.5282325268510032, 'recall': 0.5183687418291414, 'f1-score': 0.5183372313678872, 'support': 148072}, 'weighted avg': {'precision': 0.572286468372626, 'recall': 0.5688043654438382, 'f1-score': 0.5671419735548305, 'support': 148072}}
[[12823 15161  6033]
 [ 8559 54909 17727]
 [ 3693 12675 16492]]
training model: results/AAL/W6/deepOF_L1/seq2seq
Epoch 1/50
1766/1766 - 49s - loss: 12.3393 - accuracy10: 0.4194 - accuracy20: 0.4339 - accuracy30: 0.4406 - accuracy50: 0.4459 - val_loss: 12.5656 - val_accuracy10: 0.6832 - val_accuracy20: 0.6360 - val_accuracy30: 0.5948 - val_accuracy50: 0.5266 - 49s/epoch - 28ms/step
Epoch 2/50
1766/1766 - 40s - loss: 12.2115 - accuracy10: 0.4208 - accuracy20: 0.4346 - accuracy30: 0.4424 - accuracy50: 0.4475 - val_loss: 11.6930 - val_accuracy10: 0.6186 - val_accuracy20: 0.5924 - val_accuracy30: 0.5728 - val_accuracy50: 0.5277 - 40s/epoch - 23ms/step
Epoch 3/50
1766/1766 - 39s - loss: 12.0681 - accuracy10: 0.4339 - accuracy20: 0.4451 - accuracy30: 0.4531 - accuracy50: 0.4579 - val_loss: 11.5471 - val_accuracy10: 0.5920 - val_accuracy20: 0.5743 - val_accuracy30: 0.5675 - val_accuracy50: 0.5354 - 39s/epoch - 22ms/step
Epoch 4/50
1766/1766 - 41s - loss: 11.9820 - accuracy10: 0.4485 - accuracy20: 0.4555 - accuracy30: 0.4614 - accuracy50: 0.4641 - val_loss: 11.5016 - val_accuracy10: 0.6480 - val_accuracy20: 0.6166 - val_accuracy30: 0.5946 - val_accuracy50: 0.5472 - 41s/epoch - 23ms/step
Epoch 5/50
1766/1766 - 41s - loss: 11.9089 - accuracy10: 0.4622 - accuracy20: 0.4637 - accuracy30: 0.4670 - accuracy50: 0.4676 - val_loss: 11.4530 - val_accuracy10: 0.6209 - val_accuracy20: 0.5909 - val_accuracy30: 0.5734 - val_accuracy50: 0.5374 - 41s/epoch - 23ms/step
Epoch 6/50
1766/1766 - 40s - loss: 11.8478 - accuracy10: 0.4738 - accuracy20: 0.4715 - accuracy30: 0.4716 - accuracy50: 0.4706 - val_loss: 11.4649 - val_accuracy10: 0.6143 - val_accuracy20: 0.5855 - val_accuracy30: 0.5676 - val_accuracy50: 0.5331 - 40s/epoch - 23ms/step
Epoch 7/50
1766/1766 - 40s - loss: 11.7931 - accuracy10: 0.4836 - accuracy20: 0.4786 - accuracy30: 0.4768 - accuracy50: 0.4740 - val_loss: 11.4022 - val_accuracy10: 0.6499 - val_accuracy20: 0.6153 - val_accuracy30: 0.5898 - val_accuracy50: 0.5463 - 40s/epoch - 23ms/step
Epoch 8/50
1766/1766 - 40s - loss: 11.7372 - accuracy10: 0.4906 - accuracy20: 0.4853 - accuracy30: 0.4825 - accuracy50: 0.4785 - val_loss: 11.3671 - val_accuracy10: 0.6739 - val_accuracy20: 0.6361 - val_accuracy30: 0.6073 - val_accuracy50: 0.5563 - 40s/epoch - 23ms/step
Epoch 9/50
1766/1766 - 40s - loss: 11.6719 - accuracy10: 0.4978 - accuracy20: 0.4919 - accuracy30: 0.4884 - accuracy50: 0.4834 - val_loss: 11.4433 - val_accuracy10: 0.6860 - val_accuracy20: 0.6475 - val_accuracy30: 0.6150 - val_accuracy50: 0.5596 - 40s/epoch - 22ms/step
Epoch 10/50
1766/1766 - 42s - loss: 11.6125 - accuracy10: 0.5052 - accuracy20: 0.4994 - accuracy30: 0.4942 - accuracy50: 0.4883 - val_loss: 11.4075 - val_accuracy10: 0.6934 - val_accuracy20: 0.6515 - val_accuracy30: 0.6178 - val_accuracy50: 0.5623 - 42s/epoch - 24ms/step
Epoch 11/50
1766/1766 - 41s - loss: 11.5618 - accuracy10: 0.5099 - accuracy20: 0.5036 - accuracy30: 0.4981 - accuracy50: 0.4912 - val_loss: 11.4627 - val_accuracy10: 0.6934 - val_accuracy20: 0.6507 - val_accuracy30: 0.6162 - val_accuracy50: 0.5581 - 41s/epoch - 23ms/step
Epoch 12/50
1766/1766 - 41s - loss: 11.5144 - accuracy10: 0.5139 - accuracy20: 0.5078 - accuracy30: 0.5010 - accuracy50: 0.4928 - val_loss: 11.4786 - val_accuracy10: 0.6995 - val_accuracy20: 0.6567 - val_accuracy30: 0.6219 - val_accuracy50: 0.5647 - 41s/epoch - 23ms/step
Epoch 13/50
1766/1766 - 42s - loss: 11.4684 - accuracy10: 0.5164 - accuracy20: 0.5101 - accuracy30: 0.5041 - accuracy50: 0.4963 - val_loss: 11.4885 - val_accuracy10: 0.6923 - val_accuracy20: 0.6481 - val_accuracy30: 0.6120 - val_accuracy50: 0.5545 - 42s/epoch - 24ms/step
Epoch 14/50
1766/1766 - 41s - loss: 11.4252 - accuracy10: 0.5203 - accuracy20: 0.5134 - accuracy30: 0.5062 - accuracy50: 0.4976 - val_loss: 11.4419 - val_accuracy10: 0.6888 - val_accuracy20: 0.6450 - val_accuracy30: 0.6084 - val_accuracy50: 0.5540 - 41s/epoch - 23ms/step
Epoch 15/50
1766/1766 - 41s - loss: 11.3857 - accuracy10: 0.5216 - accuracy20: 0.5147 - accuracy30: 0.5082 - accuracy50: 0.4996 - val_loss: 11.5026 - val_accuracy10: 0.7034 - val_accuracy20: 0.6568 - val_accuracy30: 0.6198 - val_accuracy50: 0.5620 - 41s/epoch - 23ms/step
Epoch 16/50
1766/1766 - 41s - loss: 11.3478 - accuracy10: 0.5256 - accuracy20: 0.5194 - accuracy30: 0.5115 - accuracy50: 0.5019 - val_loss: 11.3173 - val_accuracy10: 0.6894 - val_accuracy20: 0.6443 - val_accuracy30: 0.6094 - val_accuracy50: 0.5576 - 41s/epoch - 23ms/step
Epoch 17/50
1766/1766 - 41s - loss: 11.3175 - accuracy10: 0.5263 - accuracy20: 0.5201 - accuracy30: 0.5130 - accuracy50: 0.5035 - val_loss: 11.3609 - val_accuracy10: 0.6920 - val_accuracy20: 0.6467 - val_accuracy30: 0.6123 - val_accuracy50: 0.5596 - 41s/epoch - 23ms/step
Epoch 18/50
1766/1766 - 42s - loss: 11.2775 - accuracy10: 0.5285 - accuracy20: 0.5228 - accuracy30: 0.5151 - accuracy50: 0.5056 - val_loss: 11.3993 - val_accuracy10: 0.6870 - val_accuracy20: 0.6412 - val_accuracy30: 0.6077 - val_accuracy50: 0.5565 - 42s/epoch - 24ms/step
Epoch 19/50
1766/1766 - 41s - loss: 11.2524 - accuracy10: 0.5295 - accuracy20: 0.5232 - accuracy30: 0.5164 - accuracy50: 0.5070 - val_loss: 11.2660 - val_accuracy10: 0.6909 - val_accuracy20: 0.6446 - val_accuracy30: 0.6117 - val_accuracy50: 0.5606 - 41s/epoch - 23ms/step
Epoch 20/50
1766/1766 - 42s - loss: 11.2210 - accuracy10: 0.5326 - accuracy20: 0.5261 - accuracy30: 0.5184 - accuracy50: 0.5084 - val_loss: 11.3508 - val_accuracy10: 0.6925 - val_accuracy20: 0.6442 - val_accuracy30: 0.6109 - val_accuracy50: 0.5607 - 42s/epoch - 24ms/step
Epoch 21/50
1766/1766 - 41s - loss: 11.1804 - accuracy10: 0.5339 - accuracy20: 0.5279 - accuracy30: 0.5206 - accuracy50: 0.5106 - val_loss: 11.3325 - val_accuracy10: 0.6933 - val_accuracy20: 0.6452 - val_accuracy30: 0.6110 - val_accuracy50: 0.5613 - 41s/epoch - 23ms/step
Epoch 22/50
1766/1766 - 42s - loss: 11.1539 - accuracy10: 0.5344 - accuracy20: 0.5287 - accuracy30: 0.5210 - accuracy50: 0.5112 - val_loss: 11.4240 - val_accuracy10: 0.6762 - val_accuracy20: 0.6297 - val_accuracy30: 0.5981 - val_accuracy50: 0.5519 - 42s/epoch - 24ms/step
Epoch 23/50
1766/1766 - 41s - loss: 11.1202 - accuracy10: 0.5392 - accuracy20: 0.5324 - accuracy30: 0.5242 - accuracy50: 0.5132 - val_loss: 11.4311 - val_accuracy10: 0.6881 - val_accuracy20: 0.6393 - val_accuracy30: 0.6047 - val_accuracy50: 0.5552 - 41s/epoch - 23ms/step
Epoch 24/50
1766/1766 - 43s - loss: 11.0928 - accuracy10: 0.5388 - accuracy20: 0.5330 - accuracy30: 0.5257 - accuracy50: 0.5153 - val_loss: 11.4009 - val_accuracy10: 0.6943 - val_accuracy20: 0.6455 - val_accuracy30: 0.6120 - val_accuracy50: 0.5611 - 43s/epoch - 24ms/step
Epoch 25/50
1766/1766 - 40s - loss: 11.0640 - accuracy10: 0.5406 - accuracy20: 0.5340 - accuracy30: 0.5272 - accuracy50: 0.5173 - val_loss: 11.3482 - val_accuracy10: 0.6880 - val_accuracy20: 0.6387 - val_accuracy30: 0.6064 - val_accuracy50: 0.5586 - 40s/epoch - 23ms/step
Epoch 26/50
1766/1766 - 40s - loss: 11.0333 - accuracy10: 0.5419 - accuracy20: 0.5359 - accuracy30: 0.5284 - accuracy50: 0.5185 - val_loss: 11.4331 - val_accuracy10: 0.6927 - val_accuracy20: 0.6413 - val_accuracy30: 0.6069 - val_accuracy50: 0.5566 - 40s/epoch - 23ms/step
Epoch 27/50
1766/1766 - 40s - loss: 11.0097 - accuracy10: 0.5435 - accuracy20: 0.5380 - accuracy30: 0.5306 - accuracy50: 0.5207 - val_loss: 11.2964 - val_accuracy10: 0.6858 - val_accuracy20: 0.6359 - val_accuracy30: 0.6050 - val_accuracy50: 0.5598 - 40s/epoch - 23ms/step
Epoch 28/50
1766/1766 - 40s - loss: 10.9833 - accuracy10: 0.5448 - accuracy20: 0.5397 - accuracy30: 0.5317 - accuracy50: 0.5210 - val_loss: 11.4167 - val_accuracy10: 0.6837 - val_accuracy20: 0.6337 - val_accuracy30: 0.5997 - val_accuracy50: 0.5524 - 40s/epoch - 23ms/step
Epoch 29/50
1766/1766 - 40s - loss: 10.9486 - accuracy10: 0.5468 - accuracy20: 0.5411 - accuracy30: 0.5336 - accuracy50: 0.5225 - val_loss: 11.3473 - val_accuracy10: 0.6879 - val_accuracy20: 0.6353 - val_accuracy30: 0.6019 - val_accuracy50: 0.5559 - 40s/epoch - 23ms/step
testing model: results/AAL/W6/deepOF_L1/seq2seq
Evaluating performance on  test set...
6203/6203 - 59s - 59s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.78977925
{'0': {'precision': 0.39739382239382237, 'recall': 0.2643038449762467, 'f1-score': 0.31746436600252687, 'support': 202498}, '1': {'precision': 0.8055304778145584, 'recall': 0.7955187409191128, 'f1-score': 0.8004933064954152, 'support': 1181052}, '2': {'precision': 0.29811447060136115, 'recall': 0.41848286258253026, 'f1-score': 0.34818939802701904, 'support': 204319}, 'accuracy': 0.6792588053548498, 'macro avg': {'precision': 0.5003462569365806, 'recall': 0.49276848282596325, 'f1-score': 0.488715690174987, 'support': 1587869}, 'weighted avg': {'precision': 0.6881898233731772, 'recall': 0.6792588053548498, 'f1-score': 0.680693325095008, 'support': 1587869}}
[[ 53521 120199  28778]
 [ 68969 939549 172534]
 [ 12190 106625  85504]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8576629
{'0': {'precision': 0.4462488471871366, 'recall': 0.2518861091830884, 'f1-score': 0.32201191136401996, 'support': 265096}, '1': {'precision': 0.7333051841004747, 'recall': 0.7742741769483892, 'f1-score': 0.7532330072180912, 'support': 1054217}, '2': {'precision': 0.3447865403543307, 'recall': 0.41740642547550605, 'f1-score': 0.3776369602274641, 'support': 268556}, 'accuracy': 0.6267040920882012, 'macro avg': {'precision': 0.5081135238806473, 'recall': 0.48118890386899454, 'f1-score': 0.4842939596031917, 'support': 1587869}, 'weighted avg': {'precision': 0.6196708102445283, 'recall': 0.6267040920882012, 'f1-score': 0.6177158079893477, 'support': 1587869}}
[[ 66774 156694  41628]
 [ 66569 816253 171395]
 [ 16291 140168 112097]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.90860146
{'0': {'precision': 0.47453938593300277, 'recall': 0.2385997901417987, 'f1-score': 0.31753969406318594, 'support': 311639}, '1': {'precision': 0.6745378036339982, 'recall': 0.7606918743630516, 'f1-score': 0.7150290076096613, 'support': 959654}, '2': {'precision': 0.3733321488342236, 'recall': 0.411512559385424, 'f1-score': 0.39149367119039313, 'support': 316576}, 'accuracy': 0.5886083801623434, 'macro avg': {'precision': 0.5074697794670748, 'recall': 0.4702680746300914, 'f1-score': 0.47468745762108017, 'support': 1587869}, 'weighted avg': {'precision': 0.5752337752363067, 'recall': 0.5886083801623434, 'f1-score': 0.5725130350410323, 'support': 1587869}}
[[ 74357 185486  51796]
 [ 62772 730001 166881]
 [ 19564 166737 130275]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.97635233
{'0': {'precision': 0.5062690763560835, 'recall': 0.20968249555451812, 'f1-score': 0.29654453601976244, 'support': 381286}, '1': {'precision': 0.5777364505347531, 'recall': 0.755769819406183, 'f1-score': 0.6548687212462212, 'support': 816750}, '2': {'precision': 0.4132675359737106, 'recall': 0.38324615925280825, 'f1-score': 0.3976910801533779, 'support': 389833}, 'accuracy': 0.5331837827931649, 'macro avg': {'precision': 0.4990910209548491, 'recall': 0.44956615807116984, 'f1-score': 0.4497014458064539, 'support': 1587869}, 'weighted avg': {'precision': 0.5201971197705887, 'recall': 0.5331837827931649, 'f1-score': 0.5056874432891593, 'support': 1587869}}
[[ 79949 235827  65510]
 [ 52873 617275 146602]
 [ 25096 215335 149402]]
Evaluating performance on  train set...
1766/1766 - 17s - 17s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.80528075
{'0': {'precision': 0.3735899255054984, 'recall': 0.35887344101410756, 'f1-score': 0.36608384315906567, 'support': 58692}, '1': {'precision': 0.8129186510241221, 'recall': 0.7547519689403221, 'f1-score': 0.7827562048240497, 'support': 333809}, '2': {'precision': 0.31110462741436656, 'recall': 0.4481071812802582, 'f1-score': 0.36724459782466434, 'support': 59488}, 'accuracy': 0.6629873735865254, 'macro avg': {'precision': 0.4992044013146623, 'recall': 0.5205775304115626, 'f1-score': 0.5053615486025932, 'support': 451989}, 'weighted avg': {'precision': 0.6898249602603288, 'recall': 0.6629873735865254, 'f1-score': 0.673963095416474, 'support': 451989}}
[[ 21063  29750   7879]
 [ 30717 251943  51149]
 [  4600  28231  26657]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8626651
{'0': {'precision': 0.43522177610571905, 'recall': 0.35399925427825707, 'f1-score': 0.3904310155347102, 'support': 77777}, '1': {'precision': 0.7409337317218586, 'recall': 0.7265808496760741, 'f1-score': 0.7336871022232838, 'support': 295901}, '2': {'precision': 0.3613202378295014, 'recall': 0.454738159390124, 'f1-score': 0.40268221112801, 'support': 78311}, 'accuracy': 0.615368958094113, 'macro avg': {'precision': 0.5124919152190263, 'recall': 0.5117727544481517, 'f1-score': 0.5089334429620013, 'support': 451989}, 'weighted avg': {'precision': 0.622556357289824, 'recall': 0.615368958094113, 'f1-score': 0.6172710994423772, 'support': 451989}}
[[ 27533  38865  11379]
 [ 29337 214996  51568]
 [  6392  36308  35611]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.907759
{'0': {'precision': 0.46998029275044, 'recall': 0.3399012098529028, 'f1-score': 0.3944944281339773, 'support': 91912}, '1': {'precision': 0.6805322734567394, 'recall': 0.7106148087050314, 'f1-score': 0.6952482847012512, 'support': 267937}, '2': {'precision': 0.3907977490897054, 'recall': 0.4484588669416106, 'f1-score': 0.4176475047378395, 'support': 92140}, 'accuracy': 0.5817884948527509, 'macro avg': {'precision': 0.5137701050989616, 'recall': 0.4996582951665149, 'f1-score': 0.5024634058576893, 'support': 451989}, 'weighted avg': {'precision': 0.5786528190322824, 'recall': 0.5817884948527509, 'f1-score': 0.5774997900904532, 'support': 451989}}
[[ 31241  46411  14260]
 [ 27383 190400  50154]
 [  7849  42970  41321]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.96853155
{'0': {'precision': 0.5114570211744947, 'recall': 0.30088839092729663, 'f1-score': 0.3788818840780959, 'support': 113351}, '1': {'precision': 0.5766674372904866, 'recall': 0.7078249148694665, 'f1-score': 0.6355500350340786, 'support': 225536}, '2': {'precision': 0.43290957196721763, 'recall': 0.4151915969655709, 'f1-score': 0.42386550829290304, 'support': 113102}, 'accuracy': 0.5325461460345274, 'macro avg': {'precision': 0.5070113434773996, 'recall': 0.47463496758744467, 'f1-score': 0.4794324758016925, 'support': 451989}, 'weighted avg': {'precision': 0.5243410135037215, 'recall': 0.5325461460345274, 'f1-score': 0.5182119252073084, 'support': 451989}}
[[ 34106  60948  18297]
 [ 22679 159640  43217]
 [  9899  56244  46959]]
Evaluating performance on  val set...
579/579 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.77411664
{'0': {'precision': 0.35294830616326284, 'recall': 0.3369980326351117, 'f1-score': 0.34478879910013915, 'support': 17282}, '1': {'precision': 0.839432391094998, 'recall': 0.7785619839052882, 'f1-score': 0.8078521877001776, 'support': 114199}, '2': {'precision': 0.294468483218337, 'recall': 0.455307094207703, 'f1-score': 0.3576365874443708, 'support': 16591}, 'accuracy': 0.6908058241936356, 'macro avg': {'precision': 0.4956163934921993, 'recall': 0.5236223702493676, 'f1-score': 0.5034258580815626, 'support': 148072}, 'weighted avg': {'precision': 0.7215916504325369, 'recall': 0.6908058241936356, 'f1-score': 0.703361206923056, 'support': 148072}}
[[ 5824  9210  2248]
 [ 9437 88911 15851]
 [ 1240  7797  7554]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8314718
{'0': {'precision': 0.41230117800336574, 'recall': 0.3320073439412485, 'f1-score': 0.3678233285710827, 'support': 22876}, '1': {'precision': 0.7761546745373324, 'recall': 0.7553444411019786, 'f1-score': 0.7656081715755462, 'support': 103051}, '2': {'precision': 0.3434935122432994, 'recall': 0.4554526981259878, 'f1-score': 0.3916284848955502, 'support': 22145}, 'accuracy': 0.6450915770706143, 'macro avg': {'precision': 0.5106497882613326, 'recall': 0.5142681610564049, 'f1-score': 0.508353328347393, 'support': 148072}, 'weighted avg': {'precision': 0.6552351622344501, 'recall': 0.6450915770706143, 'f1-score': 0.6482226683737348, 'support': 148072}}
[[ 7595 12094  3187]
 [ 9122 77839 16090]
 [ 1704 10355 10086]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8794832
{'0': {'precision': 0.44515430985625226, 'recall': 0.3182203233766712, 'f1-score': 0.3711340206185567, 'support': 27151}, '1': {'precision': 0.7218316765249347, 'recall': 0.7389801849405548, 'f1-score': 0.7303052773397111, 'support': 94625}, '2': {'precision': 0.37181503617489775, 'recall': 0.4494980225129297, 'f1-score': 0.40698274971593845, 'support': 26296}, 'accuracy': 0.6104192554973257, 'macro avg': {'precision': 0.5129336741853615, 'recall': 0.5022328436100519, 'f1-score': 0.5028073492247355, 'support': 148072}, 'weighted avg': {'precision': 0.6089399430637404, 'recall': 0.6104192554973257, 'f1-score': 0.6070277638487688, 'support': 148072}}
[[ 8640 14517  3994]
 [ 8723 69926 15976]
 [ 2046 12430 11820]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9440916
{'0': {'precision': 0.4907336105549566, 'recall': 0.28107265723779, 'f1-score': 0.3574259647023632, 'support': 34009}, '1': {'precision': 0.6240818796427677, 'recall': 0.7366716338871169, 'f1-score': 0.6757188769083915, 'support': 81199}, '2': {'precision': 0.4142617193464651, 'recall': 0.41276168451801365, 'f1-score': 0.4135103415689921, 'support': 32864}, 'accuracy': 0.560139661786158, 'macro avg': {'precision': 0.5096924031813964, 'recall': 0.47683532521430677, 'f1-score': 0.48221839439324893, 'support': 148072}, 'weighted avg': {'precision': 0.5468858464198421, 'recall': 0.560139661786158, 'f1-score': 0.5444175845870286, 'support': 148072}}
[[ 9559 19338  5112]
 [ 7314 59817 14068]
 [ 2606 16693 13565]]
training model: results/AAL/W6/deepLOB_L2/seq2seq
Epoch 1/50
1766/1766 - 90s - loss: 11.8283 - accuracy10: 0.4438 - accuracy20: 0.4578 - accuracy30: 0.4647 - accuracy50: 0.4703 - val_loss: 13.4820 - val_accuracy10: 0.7203 - val_accuracy20: 0.6394 - val_accuracy30: 0.5800 - val_accuracy50: 0.5004 - 90s/epoch - 51ms/step
Epoch 2/50
1766/1766 - 83s - loss: 11.2011 - accuracy10: 0.4958 - accuracy20: 0.5109 - accuracy30: 0.5144 - accuracy50: 0.5101 - val_loss: 12.8489 - val_accuracy10: 0.5824 - val_accuracy20: 0.5526 - val_accuracy30: 0.5298 - val_accuracy50: 0.4957 - 83s/epoch - 47ms/step
Epoch 3/50
1766/1766 - 82s - loss: 10.4847 - accuracy10: 0.5998 - accuracy20: 0.5923 - accuracy30: 0.5760 - accuracy50: 0.5513 - val_loss: 11.8778 - val_accuracy10: 0.6089 - val_accuracy20: 0.5800 - val_accuracy30: 0.5543 - val_accuracy50: 0.5149 - 82s/epoch - 46ms/step
Epoch 4/50
1766/1766 - 83s - loss: 10.0703 - accuracy10: 0.6401 - accuracy20: 0.6241 - accuracy30: 0.6004 - accuracy50: 0.5677 - val_loss: 10.0791 - val_accuracy10: 0.7022 - val_accuracy20: 0.6748 - val_accuracy30: 0.6444 - val_accuracy50: 0.5925 - 83s/epoch - 47ms/step
Epoch 5/50
1766/1766 - 83s - loss: 9.8784 - accuracy10: 0.6492 - accuracy20: 0.6317 - accuracy30: 0.6076 - accuracy50: 0.5732 - val_loss: 10.1291 - val_accuracy10: 0.7101 - val_accuracy20: 0.6791 - val_accuracy30: 0.6473 - val_accuracy50: 0.5948 - 83s/epoch - 47ms/step
Epoch 6/50
1766/1766 - 83s - loss: 9.7601 - accuracy10: 0.6539 - accuracy20: 0.6362 - accuracy30: 0.6124 - accuracy50: 0.5775 - val_loss: 9.9545 - val_accuracy10: 0.7132 - val_accuracy20: 0.6865 - val_accuracy30: 0.6560 - val_accuracy50: 0.6032 - 83s/epoch - 47ms/step
Epoch 7/50
1766/1766 - 83s - loss: 9.6732 - accuracy10: 0.6567 - accuracy20: 0.6381 - accuracy30: 0.6139 - accuracy50: 0.5801 - val_loss: 10.1485 - val_accuracy10: 0.7119 - val_accuracy20: 0.6832 - val_accuracy30: 0.6537 - val_accuracy50: 0.6005 - 83s/epoch - 47ms/step
Epoch 8/50
1766/1766 - 82s - loss: 9.6038 - accuracy10: 0.6580 - accuracy20: 0.6392 - accuracy30: 0.6165 - accuracy50: 0.5827 - val_loss: 9.9510 - val_accuracy10: 0.7208 - val_accuracy20: 0.6938 - val_accuracy30: 0.6654 - val_accuracy50: 0.6099 - 82s/epoch - 47ms/step
Epoch 9/50
1766/1766 - 83s - loss: 9.5550 - accuracy10: 0.6603 - accuracy20: 0.6416 - accuracy30: 0.6180 - accuracy50: 0.5841 - val_loss: 9.9267 - val_accuracy10: 0.7126 - val_accuracy20: 0.6896 - val_accuracy30: 0.6612 - val_accuracy50: 0.6073 - 83s/epoch - 47ms/step
Epoch 10/50
1766/1766 - 82s - loss: 9.5076 - accuracy10: 0.6618 - accuracy20: 0.6421 - accuracy30: 0.6192 - accuracy50: 0.5861 - val_loss: 9.9569 - val_accuracy10: 0.7119 - val_accuracy20: 0.6868 - val_accuracy30: 0.6594 - val_accuracy50: 0.6083 - 82s/epoch - 47ms/step
Epoch 11/50
1766/1766 - 83s - loss: 9.4722 - accuracy10: 0.6627 - accuracy20: 0.6436 - accuracy30: 0.6203 - accuracy50: 0.5872 - val_loss: 9.9276 - val_accuracy10: 0.7142 - val_accuracy20: 0.6905 - val_accuracy30: 0.6635 - val_accuracy50: 0.6128 - 83s/epoch - 47ms/step
Epoch 12/50
1766/1766 - 83s - loss: 9.4356 - accuracy10: 0.6629 - accuracy20: 0.6449 - accuracy30: 0.6218 - accuracy50: 0.5886 - val_loss: 9.9069 - val_accuracy10: 0.7236 - val_accuracy20: 0.6988 - val_accuracy30: 0.6695 - val_accuracy50: 0.6137 - 83s/epoch - 47ms/step
Epoch 13/50
1766/1766 - 83s - loss: 9.4043 - accuracy10: 0.6640 - accuracy20: 0.6448 - accuracy30: 0.6218 - accuracy50: 0.5890 - val_loss: 10.2531 - val_accuracy10: 0.6484 - val_accuracy20: 0.6322 - val_accuracy30: 0.6111 - val_accuracy50: 0.5698 - 83s/epoch - 47ms/step
Epoch 14/50
1766/1766 - 82s - loss: 9.3767 - accuracy10: 0.6630 - accuracy20: 0.6450 - accuracy30: 0.6228 - accuracy50: 0.5900 - val_loss: 10.2499 - val_accuracy10: 0.6138 - val_accuracy20: 0.6009 - val_accuracy30: 0.5843 - val_accuracy50: 0.5539 - 82s/epoch - 47ms/step
Epoch 15/50
1766/1766 - 84s - loss: 9.3539 - accuracy10: 0.6642 - accuracy20: 0.6463 - accuracy30: 0.6234 - accuracy50: 0.5904 - val_loss: 11.6462 - val_accuracy10: 0.4973 - val_accuracy20: 0.4990 - val_accuracy30: 0.4942 - val_accuracy50: 0.4832 - 84s/epoch - 47ms/step
Epoch 16/50
1766/1766 - 84s - loss: 9.3246 - accuracy10: 0.6642 - accuracy20: 0.6474 - accuracy30: 0.6248 - accuracy50: 0.5919 - val_loss: 10.0256 - val_accuracy10: 0.6545 - val_accuracy20: 0.6393 - val_accuracy30: 0.6191 - val_accuracy50: 0.5803 - 84s/epoch - 47ms/step
Epoch 17/50
1766/1766 - 83s - loss: 9.2986 - accuracy10: 0.6646 - accuracy20: 0.6471 - accuracy30: 0.6255 - accuracy50: 0.5928 - val_loss: 10.2011 - val_accuracy10: 0.6112 - val_accuracy20: 0.6007 - val_accuracy30: 0.5852 - val_accuracy50: 0.5544 - 83s/epoch - 47ms/step
Epoch 18/50
1766/1766 - 83s - loss: 9.2733 - accuracy10: 0.6650 - accuracy20: 0.6479 - accuracy30: 0.6256 - accuracy50: 0.5933 - val_loss: 10.7393 - val_accuracy10: 0.5647 - val_accuracy20: 0.5600 - val_accuracy30: 0.5486 - val_accuracy50: 0.5238 - 83s/epoch - 47ms/step
Epoch 19/50
1766/1766 - 83s - loss: 9.2512 - accuracy10: 0.6656 - accuracy20: 0.6491 - accuracy30: 0.6265 - accuracy50: 0.5944 - val_loss: 9.9334 - val_accuracy10: 0.7038 - val_accuracy20: 0.6823 - val_accuracy30: 0.6559 - val_accuracy50: 0.6053 - 83s/epoch - 47ms/step
Epoch 20/50
1766/1766 - 82s - loss: 9.2244 - accuracy10: 0.6661 - accuracy20: 0.6491 - accuracy30: 0.6274 - accuracy50: 0.5957 - val_loss: 9.9318 - val_accuracy10: 0.6684 - val_accuracy20: 0.6528 - val_accuracy30: 0.6326 - val_accuracy50: 0.5917 - 82s/epoch - 47ms/step
Epoch 21/50
1766/1766 - 82s - loss: 9.1999 - accuracy10: 0.6662 - accuracy20: 0.6501 - accuracy30: 0.6283 - accuracy50: 0.5956 - val_loss: 9.9483 - val_accuracy10: 0.6732 - val_accuracy20: 0.6554 - val_accuracy30: 0.6327 - val_accuracy50: 0.5918 - 82s/epoch - 46ms/step
Epoch 22/50
1766/1766 - 83s - loss: 9.1792 - accuracy10: 0.6665 - accuracy20: 0.6499 - accuracy30: 0.6286 - accuracy50: 0.5964 - val_loss: 11.3160 - val_accuracy10: 0.5023 - val_accuracy20: 0.5049 - val_accuracy30: 0.4990 - val_accuracy50: 0.4874 - 83s/epoch - 47ms/step
testing model: results/AAL/W6/deepLOB_L2/seq2seq
Evaluating performance on  test set...
6203/6203 - 100s - 100s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8188349
{'0': {'precision': 0.33193038392412905, 'recall': 0.6457121411146557, 'f1-score': 0.43846594929195853, 'support': 202502}, '1': {'precision': 0.9094428013496385, 'recall': 0.6433450855677819, 'f1-score': 0.7535936643797405, 'support': 1181052}, '2': {'precision': 0.3398575569311971, 'recall': 0.5962460845732185, 'f1-score': 0.432940816910368, 'support': 204320}, 'accuracy': 0.6375864835622977, 'macro avg': {'precision': 0.5270769140683216, 'recall': 0.6284344370852187, 'f1-score': 0.5416668101940223, 'support': 1587874}, 'weighted avg': {'precision': 0.7625009931878596, 'recall': 0.6375864835622977, 'f1-score': 0.6721452734144321, 'support': 1587874}}
[[130758  37173  34571]
 [219165 759824 202063]
 [ 44009  38486 121825]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8364791
{'0': {'precision': 0.3919546975088087, 'recall': 0.5971180686533384, 'f1-score': 0.473257863289898, 'support': 265100}, '1': {'precision': 0.8456206970884215, 'recall': 0.6586310029149597, 'f1-score': 0.7405037438983683, 'support': 1054217}, '2': {'precision': 0.4038329062301948, 'recall': 0.545712828189174, 'f1-score': 0.46417310801672934, 'support': 268557}, 'accuracy': 0.6292634050308777, 'macro avg': {'precision': 0.5471361002758083, 'recall': 0.6004872999191574, 'f1-score': 0.5593115717349985, 'support': 1587874}, 'weighted avg': {'precision': 0.695160358145868, 'recall': 0.6292634050308777, 'f1-score': 0.649150519694325, 'support': 1587874}}
[[158296  61724  45080]
 [188602 694340 171275]
 [ 56965  65037 146555]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8636162
{'0': {'precision': 0.42488642750948363, 'recall': 0.5603077880780252, 'f1-score': 0.4832898338532051, 'support': 311643}, '1': {'precision': 0.7861805382422692, 'recall': 0.6670550010733035, 'f1-score': 0.7217352529487338, 'support': 959654}, '2': {'precision': 0.43725528042794903, 'recall': 0.5009049930980457, 'f1-score': 0.46692097161962615, 'support': 316577}, 'accuracy': 0.612978737607644, 'macro avg': {'precision': 0.5494407487265672, 'recall': 0.5760892607497915, 'f1-score': 0.5573153528071884, 'support': 1587874}, 'weighted avg': {'precision': 0.645705606418849, 'recall': 0.612978737607644, 'f1-score': 0.6241341923585908, 'support': 1587874}}
[[174616  84462  52565]
 [167992 640142 151520]
 [ 68363  89639 158575]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9133417
{'0': {'precision': 0.4578505773644013, 'recall': 0.4944700738809669, 'f1-score': 0.47545626259340235, 'support': 381289}, '1': {'precision': 0.6831496836470126, 'recall': 0.6777781722948609, 'f1-score': 0.6804533274331931, 'support': 816751}, '2': {'precision': 0.4710274496937883, 'recall': 0.4419393895863368, 'f1-score': 0.45602003192190516, 'support': 389834}, 'accuracy': 0.575861182940208, 'macro avg': {'precision': 0.5373425702350674, 'recall': 0.538062545254055, 'f1-score': 0.5373098739828336, 'support': 1587874}, 'weighted avg': {'precision': 0.5769721595573734, 'recall': 0.575861182940208, 'f1-score': 0.5761283903298421, 'support': 1587874}}
[[188536 125293  67460]
 [137158 553576 126017]
 [ 86091 131460 172283]]
Evaluating performance on  train set...
1766/1766 - 29s - 29s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.82039243
{'0': {'precision': 0.41999215334603746, 'recall': 0.5101523274614926, 'f1-score': 0.4607025660336759, 'support': 58755}, '1': {'precision': 0.8914334249473153, 'recall': 0.6667206036143748, 'f1-score': 0.7628732721777547, 'support': 333723}, '2': {'precision': 0.3086968135851937, 'recall': 0.6796330213566784, 'f1-score': 0.42455573166507465, 'support': 59513}, 'accuracy': 0.6480682137476189, 'macro avg': {'precision': 0.5400407972928488, 'recall': 0.6188353174775153, 'f1-score': 0.5493771899588351, 'support': 451991}, 'weighted avg': {'precision': 0.7534219692658369, 'recall': 0.6480682137476189, 'f1-score': 0.6790478605478185, 'support': 451991}}
[[ 29974  15463  13318]
 [ 33963 222500  77260]
 [  7431  11635  40447]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8354119
{'0': {'precision': 0.48775380624940895, 'recall': 0.46403279910547895, 'f1-score': 0.47559770796285317, 'support': 77807}, '1': {'precision': 0.8248781331313197, 'recall': 0.6770306391060018, 'f1-score': 0.7436773524220653, 'support': 295929}, '2': {'precision': 0.371787089132366, 'recall': 0.6417609098460162, 'f1-score': 0.47081819673283803, 'support': 78255}, 'accuracy': 0.6342582042562794, 'macro avg': {'precision': 0.5614730095043649, 'recall': 0.5942747826858323, 'f1-score': 0.5633644190392522, 'support': 451991}, 'weighted avg': {'precision': 0.6883991498112118, 'recall': 0.6342582042562794, 'f1-score': 0.650288178467499, 'support': 451991}}
[[ 36105  23510  18192]
 [ 28909 200353  66667]
 [  9009  19025  50221]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.86065406
{'0': {'precision': 0.5179319492048484, 'recall': 0.4287888671450315, 'f1-score': 0.4691635589339138, 'support': 91980}, '1': {'precision': 0.7641316875877533, 'recall': 0.6804713188941847, 'f1-score': 0.719879018565754, 'support': 267929}, '2': {'precision': 0.4070398624377946, 'recall': 0.6066875176473143, 'f1-score': 0.4872039733308913, 'support': 92082}, 'accuracy': 0.6142224070833269, 'macro avg': {'precision': 0.5630344997434654, 'recall': 0.5719825678955102, 'f1-score': 0.5587488502768531, 'support': 451991}, 'weighted avg': {'precision': 0.6412814950398528, 'recall': 0.6142224070833269, 'f1-score': 0.6214567236699412, 'support': 451991}}
[[ 39440  30506  22034]
 [ 26263 182318  59348]
 [ 10446  25771  55865]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.91515756
{'0': {'precision': 0.5477907673080428, 'recall': 0.37108110729939237, 'f1-score': 0.4424442843849069, 'support': 113393}, '1': {'precision': 0.6567487300719802, 'recall': 0.6874581472595601, 'f1-score': 0.6717526487985613, 'support': 225493}, '2': {'precision': 0.4459249676584735, 'recall': 0.5485699129127801, 'f1-score': 0.49195028642787764, 'support': 113105}, 'accuracy': 0.5733322123670604, 'macro avg': {'precision': 0.5501548216794988, 'recall': 0.5357030558239109, 'f1-score': 0.5353824065371153, 'support': 451991}, 'weighted avg': {'precision': 0.5766579939301746, 'recall': 0.5733322123670604, 'f1-score': 0.5692317809894818, 'support': 451991}}
[[ 42078  42981  28334]
 [ 21716 155017  48760]
 [ 13020  38039  62046]]
Evaluating performance on  val set...
579/579 - 9s - 9s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.678505
{'0': {'precision': 0.4157420249653259, 'recall': 0.5548357242017584, 'f1-score': 0.47532210109018824, 'support': 17288}, '1': {'precision': 0.8968501946508923, 'recall': 0.7767025999842372, 'f1-score': 0.8324635831205885, 'support': 114193}, '2': {'precision': 0.3429611185596629, 'recall': 0.5396299198360557, 'f1-score': 0.41938354881019296, 'support': 16591}, 'accuracy': 0.724235507050624, 'macro avg': {'precision': 0.5518511127252937, 'recall': 0.6237227480073504, 'f1-score': 0.5757230776736566, 'support': 148072}, 'weighted avg': {'precision': 0.7786173640080047, 'recall': 0.724235507050624, 'f1-score': 0.7444815690288944, 'support': 148072}}
[[ 9592  5133  2563]
 [10910 88694 14589]
 [ 2570  5068  8953]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.72377115
{'0': {'precision': 0.4811174773116976, 'recall': 0.5017445917655269, 'f1-score': 0.4912145861354854, 'support': 22928}, '1': {'precision': 0.8342175476188023, 'recall': 0.7860304395092406, 'f1-score': 0.8094074373928645, 'support': 103024}, '2': {'precision': 0.4043118724158299, 'recall': 0.49511754068716096, 'f1-score': 0.4451308730287758, 'support': 22120}, 'accuracy': 0.6985520557566589, 'macro avg': {'precision': 0.5732156324487766, 'recall': 0.5942975239873095, 'f1-score': 0.5819176321857086, 'support': 148072}, 'weighted avg': {'precision': 0.7153200386536297, 'recall': 0.6985520557566589, 'f1-score': 0.70571920938647, 'support': 148072}}
[[11504  8030  3394]
 [ 9302 80980 12742]
 [ 3105  8063 10952]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7745882
{'0': {'precision': 0.5127005621896672, 'recall': 0.45998085560709817, 'f1-score': 0.48491199472162394, 'support': 27162}, '1': {'precision': 0.7767581555345395, 'recall': 0.7901931555076279, 'f1-score': 0.7834180598501126, 'support': 94587}, '2': {'precision': 0.4364264919941776, 'recall': 0.45560916308931354, 'f1-score': 0.4458115718454362, 'support': 26323}, 'accuracy': 0.6701402020638608, 'macro avg': {'precision': 0.5752950699061281, 'recall': 0.5685943914013466, 'f1-score': 0.5713805421390576, 'support': 148072}, 'weighted avg': {'precision': 0.6678187022293477, 'recall': 0.6701402020638608, 'f1-score': 0.6686439139969661, 'support': 148072}}
[[12494 10714  3954]
 [ 8312 74742 11533]
 [ 3563 10767 11993]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8592583
{'0': {'precision': 0.5435389797091925, 'recall': 0.3890113766646089, 'f1-score': 0.45347223412093285, 'support': 34017}, '1': {'precision': 0.6750675161360958, 'recall': 0.7973520536978878, 'f1-score': 0.7311319156625146, 'support': 81195}, '2': {'precision': 0.46483125471732023, 'recall': 0.39357881923311017, 'f1-score': 0.4262478783184747, 'support': 32860}, 'accuracy': 0.6139378140364147, 'macro avg': {'precision': 0.5611459168542029, 'recall': 0.526647416531869, 'f1-score': 0.5369506760339741, 'support': 148072}, 'weighted avg': {'precision': 0.5981956580275072, 'recall': 0.6139378140364147, 'f1-score': 0.5996847895743606, 'support': 148072}}
[[13233 15606  5178]
 [ 6742 64741  9712]
 [ 4371 15556 12933]]
training model: results/AAL/W6/deepOF_L2/seq2seq
Epoch 1/50
1766/1766 - 58s - loss: 10.9899 - accuracy10: 0.5393 - accuracy20: 0.5430 - accuracy30: 0.5361 - accuracy50: 0.5202 - val_loss: 10.3411 - val_accuracy10: 0.7515 - val_accuracy20: 0.7172 - val_accuracy30: 0.6808 - val_accuracy50: 0.6145 - 58s/epoch - 33ms/step
Epoch 2/50
1766/1766 - 51s - loss: 10.0893 - accuracy10: 0.6223 - accuracy20: 0.6122 - accuracy30: 0.5935 - accuracy50: 0.5647 - val_loss: 10.2297 - val_accuracy10: 0.7620 - val_accuracy20: 0.7260 - val_accuracy30: 0.6878 - val_accuracy50: 0.6205 - 51s/epoch - 29ms/step
Epoch 3/50
1766/1766 - 51s - loss: 9.9127 - accuracy10: 0.6337 - accuracy20: 0.6206 - accuracy30: 0.6000 - accuracy50: 0.5705 - val_loss: 10.1617 - val_accuracy10: 0.7615 - val_accuracy20: 0.7258 - val_accuracy30: 0.6892 - val_accuracy50: 0.6220 - 51s/epoch - 29ms/step
Epoch 4/50
1766/1766 - 52s - loss: 9.8228 - accuracy10: 0.6381 - accuracy20: 0.6241 - accuracy30: 0.6036 - accuracy50: 0.5742 - val_loss: 10.1291 - val_accuracy10: 0.7649 - val_accuracy20: 0.7292 - val_accuracy30: 0.6923 - val_accuracy50: 0.6253 - 52s/epoch - 29ms/step
Epoch 5/50
1766/1766 - 51s - loss: 9.7551 - accuracy10: 0.6418 - accuracy20: 0.6269 - accuracy30: 0.6063 - accuracy50: 0.5766 - val_loss: 10.1330 - val_accuracy10: 0.7627 - val_accuracy20: 0.7269 - val_accuracy30: 0.6902 - val_accuracy50: 0.6249 - 51s/epoch - 29ms/step
Epoch 6/50
1766/1766 - 50s - loss: 9.7103 - accuracy10: 0.6440 - accuracy20: 0.6286 - accuracy30: 0.6084 - accuracy50: 0.5784 - val_loss: 10.1438 - val_accuracy10: 0.7586 - val_accuracy20: 0.7238 - val_accuracy30: 0.6888 - val_accuracy50: 0.6235 - 50s/epoch - 28ms/step
Epoch 7/50
1766/1766 - 51s - loss: 9.6603 - accuracy10: 0.6460 - accuracy20: 0.6307 - accuracy30: 0.6101 - accuracy50: 0.5799 - val_loss: 10.1784 - val_accuracy10: 0.7606 - val_accuracy20: 0.7248 - val_accuracy30: 0.6880 - val_accuracy50: 0.6218 - 51s/epoch - 29ms/step
Epoch 8/50
1766/1766 - 51s - loss: 9.6193 - accuracy10: 0.6468 - accuracy20: 0.6319 - accuracy30: 0.6113 - accuracy50: 0.5809 - val_loss: 10.1836 - val_accuracy10: 0.7528 - val_accuracy20: 0.7175 - val_accuracy30: 0.6812 - val_accuracy50: 0.6177 - 51s/epoch - 29ms/step
Epoch 9/50
1766/1766 - 51s - loss: 9.5774 - accuracy10: 0.6482 - accuracy20: 0.6335 - accuracy30: 0.6124 - accuracy50: 0.5822 - val_loss: 10.0763 - val_accuracy10: 0.7568 - val_accuracy20: 0.7232 - val_accuracy30: 0.6876 - val_accuracy50: 0.6239 - 51s/epoch - 29ms/step
Epoch 10/50
1766/1766 - 52s - loss: 9.5486 - accuracy10: 0.6482 - accuracy20: 0.6341 - accuracy30: 0.6132 - accuracy50: 0.5828 - val_loss: 10.0521 - val_accuracy10: 0.7608 - val_accuracy20: 0.7262 - val_accuracy30: 0.6895 - val_accuracy50: 0.6254 - 52s/epoch - 29ms/step
Epoch 11/50
1766/1766 - 50s - loss: 9.5156 - accuracy10: 0.6496 - accuracy20: 0.6353 - accuracy30: 0.6138 - accuracy50: 0.5837 - val_loss: 9.9655 - val_accuracy10: 0.7594 - val_accuracy20: 0.7268 - val_accuracy30: 0.6910 - val_accuracy50: 0.6280 - 50s/epoch - 29ms/step
Epoch 12/50
1766/1766 - 51s - loss: 9.4840 - accuracy10: 0.6499 - accuracy20: 0.6366 - accuracy30: 0.6150 - accuracy50: 0.5846 - val_loss: 10.0442 - val_accuracy10: 0.7586 - val_accuracy20: 0.7256 - val_accuracy30: 0.6902 - val_accuracy50: 0.6265 - 51s/epoch - 29ms/step
Epoch 13/50
1766/1766 - 51s - loss: 9.4544 - accuracy10: 0.6507 - accuracy20: 0.6380 - accuracy30: 0.6165 - accuracy50: 0.5855 - val_loss: 10.0024 - val_accuracy10: 0.7578 - val_accuracy20: 0.7245 - val_accuracy30: 0.6884 - val_accuracy50: 0.6251 - 51s/epoch - 29ms/step
Epoch 14/50
1766/1766 - 50s - loss: 9.4281 - accuracy10: 0.6514 - accuracy20: 0.6375 - accuracy30: 0.6174 - accuracy50: 0.5865 - val_loss: 9.9862 - val_accuracy10: 0.7528 - val_accuracy20: 0.7209 - val_accuracy30: 0.6856 - val_accuracy50: 0.6237 - 50s/epoch - 28ms/step
Epoch 15/50
1766/1766 - 51s - loss: 9.3993 - accuracy10: 0.6517 - accuracy20: 0.6389 - accuracy30: 0.6178 - accuracy50: 0.5875 - val_loss: 9.9680 - val_accuracy10: 0.7568 - val_accuracy20: 0.7240 - val_accuracy30: 0.6878 - val_accuracy50: 0.6254 - 51s/epoch - 29ms/step
Epoch 16/50
1766/1766 - 51s - loss: 9.3685 - accuracy10: 0.6527 - accuracy20: 0.6402 - accuracy30: 0.6192 - accuracy50: 0.5890 - val_loss: 10.0036 - val_accuracy10: 0.7537 - val_accuracy20: 0.7215 - val_accuracy30: 0.6861 - val_accuracy50: 0.6231 - 51s/epoch - 29ms/step
Epoch 17/50
1766/1766 - 51s - loss: 9.3446 - accuracy10: 0.6531 - accuracy20: 0.6415 - accuracy30: 0.6205 - accuracy50: 0.5902 - val_loss: 10.0053 - val_accuracy10: 0.7559 - val_accuracy20: 0.7236 - val_accuracy30: 0.6876 - val_accuracy50: 0.6248 - 51s/epoch - 29ms/step
Epoch 18/50
1766/1766 - 52s - loss: 9.3222 - accuracy10: 0.6532 - accuracy20: 0.6416 - accuracy30: 0.6212 - accuracy50: 0.5903 - val_loss: 9.9842 - val_accuracy10: 0.7498 - val_accuracy20: 0.7189 - val_accuracy30: 0.6846 - val_accuracy50: 0.6229 - 52s/epoch - 29ms/step
Epoch 19/50
1766/1766 - 51s - loss: 9.2932 - accuracy10: 0.6540 - accuracy20: 0.6427 - accuracy30: 0.6222 - accuracy50: 0.5914 - val_loss: 10.1621 - val_accuracy10: 0.7504 - val_accuracy20: 0.7188 - val_accuracy30: 0.6835 - val_accuracy50: 0.6212 - 51s/epoch - 29ms/step
Epoch 20/50
1766/1766 - 54s - loss: 9.2689 - accuracy10: 0.6538 - accuracy20: 0.6433 - accuracy30: 0.6227 - accuracy50: 0.5921 - val_loss: 10.1944 - val_accuracy10: 0.7413 - val_accuracy20: 0.7112 - val_accuracy30: 0.6764 - val_accuracy50: 0.6152 - 54s/epoch - 30ms/step
Epoch 21/50
1766/1766 - 51s - loss: 9.2451 - accuracy10: 0.6545 - accuracy20: 0.6438 - accuracy30: 0.6231 - accuracy50: 0.5930 - val_loss: 10.1616 - val_accuracy10: 0.7345 - val_accuracy20: 0.7036 - val_accuracy30: 0.6695 - val_accuracy50: 0.6105 - 51s/epoch - 29ms/step
testing model: results/AAL/W6/deepOF_L2/seq2seq
Evaluating performance on  test set...
6203/6203 - 61s - 61s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.61119807
{'0': {'precision': 0.4616155916109746, 'recall': 0.4887998893816235, 'f1-score': 0.47481897050040656, 'support': 202498}, '1': {'precision': 0.8623965319096318, 'recall': 0.8533019714627298, 'f1-score': 0.8578251475007543, 'support': 1181052}, '2': {'precision': 0.4654013444049031, 'recall': 0.4666085875518185, 'f1-score': 0.4660041841004184, 'support': 204319}, 'accuracy': 0.7570599337854698, 'macro avg': {'precision': 0.5964711559751699, 'recall': 0.602903482798724, 'f1-score': 0.5995494340338597, 'support': 1587869}, 'weighted avg': {'precision': 0.7602023341739393, 'recall': 0.7570599337854698, 'f1-score': 0.7585635256344608, 'support': 1587869}}
[[  98981   76607   26910]
 [  90656 1007794   82602]
 [  24786   84196   95337]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6961945
{'0': {'precision': 0.5193084091164253, 'recall': 0.43620801520958447, 'f1-score': 0.474144629344508, 'support': 265096}, '1': {'precision': 0.7877534673550589, 'recall': 0.8582578349618721, 'f1-score': 0.8214956779752195, 'support': 1054217}, '2': {'precision': 0.5177588817490213, 'recall': 0.4176372898017546, 'f1-score': 0.4623397501958036, 'support': 268556}, 'accuracy': 0.7132742058696278, 'macro avg': {'precision': 0.6082735860735019, 'recall': 0.570701046657737, 'f1-score': 0.585993352505177, 'support': 1587869}, 'weighted avg': {'precision': 0.6972722141214207, 'recall': 0.7132742058696278, 'f1-score': 0.7027611646567179, 'support': 1587869}}
[[115637 116422  33037]
 [ 77999 904790  71428]
 [ 29039 127358 112159]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.77263767
{'0': {'precision': 0.5424776135034649, 'recall': 0.3988974422328399, 'f1-score': 0.45973797834669333, 'support': 311639}, '1': {'precision': 0.723473719151469, 'recall': 0.856231516775838, 'f1-score': 0.7842741617968843, 'support': 959654}, '2': {'precision': 0.5377239170800405, 'recall': 0.3787147478014758, 'f1-score': 0.44442467444369066, 'support': 316576}, 'accuracy': 0.671270740848269, 'macro avg': {'precision': 0.6012250832449915, 'recall': 0.5446145689367179, 'f1-score': 0.5628122715290894, 'support': 1587869}, 'weighted avg': {'precision': 0.6509177496674606, 'recall': 0.671270740848269, 'f1-score': 0.6528235679616506, 'support': 1587869}}
[[124312 150108  37219]
 [ 72117 821686  65851]
 [ 32727 163957 119892]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8918027
{'0': {'precision': 0.5546490507930971, 'recall': 0.34198213414602163, 'f1-score': 0.42309495649578105, 'support': 381286}, '1': {'precision': 0.6175389493480021, 'recall': 0.8579712274257729, 'f1-score': 0.7181660400524111, 'support': 816750}, '2': {'precision': 0.5608411493567547, 'recall': 0.31368047343349587, 'f1-score': 0.40233405936815225, 'support': 389833}, 'accuracy': 0.6004424798267364, 'macro avg': {'precision': 0.5776763831659514, 'recall': 0.5045446116684301, 'f1-score': 0.5145316853054481, 'support': 1587869}, 'weighted avg': {'precision': 0.5885178453876669, 'recall': 0.6004424798267364, 'f1-score': 0.5697733189330618, 'support': 1587869}}
[[130393 207355  43538]
 [ 63788 700748  52214]
 [ 40910 226640 122283]]
Evaluating performance on  train set...
1766/1766 - 18s - 18s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.64308256
{'0': {'precision': 0.45062757186472174, 'recall': 0.5205649833026648, 'f1-score': 0.4830781149945056, 'support': 58692}, '1': {'precision': 0.8667402277858103, 'recall': 0.8188994305126585, 'f1-score': 0.8421409349761935, 'support': 333809}, '2': {'precision': 0.44719783733503865, 'recall': 0.5172303657880581, 'f1-score': 0.47967137467651916, 'support': 59488}, 'accuracy': 0.7404560730460255, 'macro avg': {'precision': 0.5881885456618569, 'recall': 0.6188982598677938, 'f1-score': 0.6016301415490727, 'support': 451989}, 'weighted avg': {'precision': 0.7574892908726198, 'recall': 0.7404560730460255, 'f1-score': 0.7478096476362975, 'support': 451989}}
[[ 30553  20347   7792]
 [ 30210 273356  30243]
 [  7038  21681  30769]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7071461
{'0': {'precision': 0.5248670363245446, 'recall': 0.4770819136762796, 'f1-score': 0.49983498683262273, 'support': 77777}, '1': {'precision': 0.7951527602157074, 'recall': 0.8266954150205643, 'f1-score': 0.8106173575902177, 'support': 295901}, '2': {'precision': 0.5105493252233416, 'recall': 0.4801879684846318, 'f1-score': 0.4949034317112493, 'support': 78311}, 'accuracy': 0.7064994944567236, 'macro avg': {'precision': 0.6101897072545311, 'recall': 0.5946550990604919, 'f1-score': 0.6017852587113632, 'support': 451989}, 'weighted avg': {'precision': 0.6993327461340149, 'recall': 0.7064994944567236, 'f1-score': 0.7024386326656701, 'support': 451989}}
[[ 37106  30797   9874]
 [ 25105 244620  26176]
 [  8485  32222  37604]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.77209675
{'0': {'precision': 0.5535416267680775, 'recall': 0.4402580729393333, 'f1-score': 0.49044323511944443, 'support': 91912}, '1': {'precision': 0.7311131902682223, 'recall': 0.8253507354340759, 'f1-score': 0.7753791132694027, 'support': 267937}, '2': {'precision': 0.5355693982778025, 'recall': 0.4441610592576514, 'f1-score': 0.4856010536682606, 'support': 92140}, 'accuracy': 0.6693348731938167, 'macro avg': {'precision': 0.6067414051047008, 'recall': 0.5699232892103535, 'f1-score': 0.5838078006857026, 'support': 451989}, 'weighted avg': {'precision': 0.655141512775136, 'recall': 0.6693348731938167, 'f1-score': 0.6583648123811772, 'support': 451989}}
[[ 40465  40028  11419]
 [ 22725 221142  24070]
 [  9912  41303  40925]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8795374
{'0': {'precision': 0.5761604386245076, 'recall': 0.3819551658123881, 'f1-score': 0.4593755802541182, 'support': 113351}, '1': {'precision': 0.6208336096558127, 'recall': 0.830160151816118, 'f1-score': 0.7103977113197094, 'support': 225536}, '2': {'precision': 0.5611506012090614, 'recall': 0.3734239889657124, 'f1-score': 0.4484331119569776, 'support': 113102}, 'accuracy': 0.6034682259966504, 'macro avg': {'precision': 0.5860482164964606, 'recall': 0.5285131021980728, 'f1-score': 0.5394021345102683, 'support': 451989}, 'weighted avg': {'precision': 0.5946957695072385, 'recall': 0.6034682259966504, 'f1-score': 0.5818938545985513, 'support': 451989}}
[[ 43295  56106  13950]
 [ 19225 187231  19080]
 [ 12624  58243  42235]]
Evaluating performance on  val set...
579/579 - 6s - 6s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.60375535
{'0': {'precision': 0.4344068032901157, 'recall': 0.5409096169424835, 'f1-score': 0.48184325146259116, 'support': 17282}, '1': {'precision': 0.8891664944677173, 'recall': 0.8289564707221604, 'f1-score': 0.8580064804114835, 'support': 114199}, '2': {'precision': 0.4238562254194255, 'recall': 0.5131697908504611, 'f1-score': 0.4642565025355799, 'support': 16591}, 'accuracy': 0.7599546166729699, 'macro avg': {'precision': 0.5824765077257529, 'recall': 0.6276786261717017, 'f1-score': 0.6013687448032182, 'support': 148072}, 'weighted avg': {'precision': 0.7839533572323756, 'recall': 0.7599546166729699, 'f1-score': 0.7699847152861805, 'support': 148072}}
[[ 9348  5798  2136]
 [10096 94666  9437]
 [ 2075  6002  8514]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6649983
{'0': {'precision': 0.5012692050768203, 'recall': 0.4920440636474908, 'f1-score': 0.4966137962983388, 'support': 22876}, '1': {'precision': 0.8256475837003134, 'recall': 0.8332670231244723, 'f1-score': 0.8294398052672505, 'support': 103051}, '2': {'precision': 0.48373814480684707, 'recall': 0.472160758636261, 'f1-score': 0.47787934186471664, 'support': 22145}, 'accuracy': 0.7265451942298341, 'macro avg': {'precision': 0.6035516445279936, 'recall': 0.5991572818027414, 'f1-score': 0.6013109811434353, 'support': 148072}, 'weighted avg': {'precision': 0.7243991078663486, 'recall': 0.7265451942298341, 'f1-score': 0.7254428697006211, 'support': 148072}}
[[11256  8895  2725]
 [ 8748 85869  8434]
 [ 2451  9238 10456]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.73051834
{'0': {'precision': 0.5318605154862465, 'recall': 0.45221170490957974, 'f1-score': 0.48881280356716295, 'support': 27151}, '1': {'precision': 0.7676434091863953, 'recall': 0.8302879788639366, 'f1-score': 0.7977377495278516, 'support': 94625}, '2': {'precision': 0.5080388692579505, 'recall': 0.4374049285062367, 'f1-score': 0.4700833742030407, 'support': 26296}, 'accuracy': 0.6911907720568372, 'macro avg': {'precision': 0.6025142646435308, 'recall': 0.5733015374265843, 'f1-score': 0.585544642432685, 'support': 148072}, 'weighted avg': {'precision': 0.6783064492695229, 'recall': 0.6911907720568372, 'f1-score': 0.6829042856635161, 'support': 148072}}
[[12278 11709  3164]
 [ 8085 78566  7974]
 [ 2722 12072 11502]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.837223
{'0': {'precision': 0.55910150455605, 'recall': 0.38789732129730364, 'f1-score': 0.4580237483508089, 'support': 34009}, '1': {'precision': 0.6640083966021227, 'recall': 0.833667902314068, 'f1-score': 0.7392284801659889, 'support': 81199}, '2': {'precision': 0.5341085615374374, 'recall': 0.3661757546251217, 'f1-score': 0.4344796461774528, 'support': 32864}, 'accuracy': 0.6275257982603057, 'macro avg': {'precision': 0.5857394875652034, 'recall': 0.5292469927454978, 'f1-score': 0.5439106248980835, 'support': 148072}, 'weighted avg': {'precision': 0.6110827477882976, 'recall': 0.6275257982603057, 'f1-score': 0.6070039042535833, 'support': 148072}}
[[13192 16868  3949]
 [ 6958 67693  6548]
 [ 3445 17385 12034]]
training model: results/AAL/W6/deepVOL_L2/seq2seq
Epoch 1/50
1766/1766 - 57s - loss: 11.6565 - accuracy10: 0.4736 - accuracy20: 0.4884 - accuracy30: 0.4919 - accuracy50: 0.4875 - val_loss: 10.6725 - val_accuracy10: 0.7024 - val_accuracy20: 0.6805 - val_accuracy30: 0.6512 - val_accuracy50: 0.5922 - 57s/epoch - 32ms/step
Epoch 2/50
1766/1766 - 49s - loss: 10.9782 - accuracy10: 0.5628 - accuracy20: 0.5627 - accuracy30: 0.5521 - accuracy50: 0.5312 - val_loss: 10.4797 - val_accuracy10: 0.6964 - val_accuracy20: 0.6756 - val_accuracy30: 0.6489 - val_accuracy50: 0.5932 - 49s/epoch - 28ms/step
Epoch 3/50
1766/1766 - 50s - loss: 10.6538 - accuracy10: 0.5915 - accuracy20: 0.5807 - accuracy30: 0.5631 - accuracy50: 0.5377 - val_loss: 9.8708 - val_accuracy10: 0.7004 - val_accuracy20: 0.6800 - val_accuracy30: 0.6537 - val_accuracy50: 0.6030 - 50s/epoch - 28ms/step
Epoch 4/50
1766/1766 - 50s - loss: 10.3844 - accuracy10: 0.6116 - accuracy20: 0.5993 - accuracy30: 0.5793 - accuracy50: 0.5505 - val_loss: 10.0979 - val_accuracy10: 0.7015 - val_accuracy20: 0.6811 - val_accuracy30: 0.6520 - val_accuracy50: 0.5979 - 50s/epoch - 28ms/step
Epoch 5/50
1766/1766 - 50s - loss: 10.1855 - accuracy10: 0.6252 - accuracy20: 0.6121 - accuracy30: 0.5903 - accuracy50: 0.5581 - val_loss: 9.9305 - val_accuracy10: 0.7103 - val_accuracy20: 0.6904 - val_accuracy30: 0.6618 - val_accuracy50: 0.6083 - 50s/epoch - 28ms/step
Epoch 6/50
1766/1766 - 49s - loss: 10.0691 - accuracy10: 0.6337 - accuracy20: 0.6195 - accuracy30: 0.5969 - accuracy50: 0.5631 - val_loss: 9.7621 - val_accuracy10: 0.7149 - val_accuracy20: 0.6937 - val_accuracy30: 0.6649 - val_accuracy50: 0.6105 - 49s/epoch - 28ms/step
Epoch 7/50
1766/1766 - 50s - loss: 9.9928 - accuracy10: 0.6385 - accuracy20: 0.6231 - accuracy30: 0.6007 - accuracy50: 0.5663 - val_loss: 9.7899 - val_accuracy10: 0.7207 - val_accuracy20: 0.6992 - val_accuracy30: 0.6700 - val_accuracy50: 0.6143 - 50s/epoch - 28ms/step
Epoch 8/50
1766/1766 - 50s - loss: 9.9333 - accuracy10: 0.6426 - accuracy20: 0.6260 - accuracy30: 0.6029 - accuracy50: 0.5683 - val_loss: 9.6378 - val_accuracy10: 0.7168 - val_accuracy20: 0.6963 - val_accuracy30: 0.6666 - val_accuracy50: 0.6118 - 50s/epoch - 28ms/step
Epoch 9/50
1766/1766 - 49s - loss: 9.8758 - accuracy10: 0.6447 - accuracy20: 0.6283 - accuracy30: 0.6057 - accuracy50: 0.5711 - val_loss: 9.7659 - val_accuracy10: 0.7231 - val_accuracy20: 0.7011 - val_accuracy30: 0.6723 - val_accuracy50: 0.6157 - 49s/epoch - 28ms/step
Epoch 10/50
1766/1766 - 50s - loss: 9.8283 - accuracy10: 0.6490 - accuracy20: 0.6311 - accuracy30: 0.6075 - accuracy50: 0.5726 - val_loss: 9.6172 - val_accuracy10: 0.7175 - val_accuracy20: 0.6953 - val_accuracy30: 0.6669 - val_accuracy50: 0.6130 - 50s/epoch - 28ms/step
Epoch 11/50
1766/1766 - 50s - loss: 9.7887 - accuracy10: 0.6495 - accuracy20: 0.6314 - accuracy30: 0.6083 - accuracy50: 0.5734 - val_loss: 9.5792 - val_accuracy10: 0.7273 - val_accuracy20: 0.7037 - val_accuracy30: 0.6740 - val_accuracy50: 0.6178 - 50s/epoch - 28ms/step
Epoch 12/50
1766/1766 - 50s - loss: 9.7502 - accuracy10: 0.6511 - accuracy20: 0.6328 - accuracy30: 0.6097 - accuracy50: 0.5753 - val_loss: 9.4735 - val_accuracy10: 0.7128 - val_accuracy20: 0.6943 - val_accuracy30: 0.6679 - val_accuracy50: 0.6163 - 50s/epoch - 28ms/step
Epoch 13/50
1766/1766 - 50s - loss: 9.7148 - accuracy10: 0.6526 - accuracy20: 0.6344 - accuracy30: 0.6110 - accuracy50: 0.5766 - val_loss: 9.4933 - val_accuracy10: 0.7251 - val_accuracy20: 0.7032 - val_accuracy30: 0.6747 - val_accuracy50: 0.6190 - 50s/epoch - 28ms/step
Epoch 14/50
1766/1766 - 51s - loss: 9.6920 - accuracy10: 0.6536 - accuracy20: 0.6354 - accuracy30: 0.6124 - accuracy50: 0.5775 - val_loss: 9.4993 - val_accuracy10: 0.7201 - val_accuracy20: 0.6988 - val_accuracy30: 0.6707 - val_accuracy50: 0.6165 - 51s/epoch - 29ms/step
Epoch 15/50
1766/1766 - 49s - loss: 9.6633 - accuracy10: 0.6547 - accuracy20: 0.6365 - accuracy30: 0.6129 - accuracy50: 0.5785 - val_loss: 9.4822 - val_accuracy10: 0.7346 - val_accuracy20: 0.7124 - val_accuracy30: 0.6826 - val_accuracy50: 0.6246 - 49s/epoch - 28ms/step
Epoch 16/50
1766/1766 - 49s - loss: 9.6388 - accuracy10: 0.6558 - accuracy20: 0.6372 - accuracy30: 0.6136 - accuracy50: 0.5795 - val_loss: 9.4609 - val_accuracy10: 0.7211 - val_accuracy20: 0.6999 - val_accuracy30: 0.6726 - val_accuracy50: 0.6190 - 49s/epoch - 28ms/step
Epoch 17/50
1766/1766 - 49s - loss: 9.6113 - accuracy10: 0.6566 - accuracy20: 0.6376 - accuracy30: 0.6145 - accuracy50: 0.5806 - val_loss: 9.4348 - val_accuracy10: 0.7161 - val_accuracy20: 0.6973 - val_accuracy30: 0.6720 - val_accuracy50: 0.6197 - 49s/epoch - 28ms/step
Epoch 18/50
1766/1766 - 49s - loss: 9.5907 - accuracy10: 0.6569 - accuracy20: 0.6381 - accuracy30: 0.6153 - accuracy50: 0.5811 - val_loss: 9.4216 - val_accuracy10: 0.7245 - val_accuracy20: 0.7025 - val_accuracy30: 0.6757 - val_accuracy50: 0.6214 - 49s/epoch - 28ms/step
Epoch 19/50
1766/1766 - 50s - loss: 9.5617 - accuracy10: 0.6578 - accuracy20: 0.6389 - accuracy30: 0.6165 - accuracy50: 0.5822 - val_loss: 9.4092 - val_accuracy10: 0.7222 - val_accuracy20: 0.7001 - val_accuracy30: 0.6732 - val_accuracy50: 0.6195 - 50s/epoch - 28ms/step
Epoch 20/50
1766/1766 - 49s - loss: 9.5445 - accuracy10: 0.6579 - accuracy20: 0.6389 - accuracy30: 0.6159 - accuracy50: 0.5823 - val_loss: 9.4022 - val_accuracy10: 0.7164 - val_accuracy20: 0.6971 - val_accuracy30: 0.6706 - val_accuracy50: 0.6174 - 49s/epoch - 28ms/step
Epoch 21/50
1766/1766 - 49s - loss: 9.5219 - accuracy10: 0.6579 - accuracy20: 0.6400 - accuracy30: 0.6174 - accuracy50: 0.5834 - val_loss: 9.4640 - val_accuracy10: 0.7215 - val_accuracy20: 0.6999 - val_accuracy30: 0.6741 - val_accuracy50: 0.6202 - 49s/epoch - 28ms/step
Epoch 22/50
1766/1766 - 50s - loss: 9.4954 - accuracy10: 0.6592 - accuracy20: 0.6410 - accuracy30: 0.6186 - accuracy50: 0.5845 - val_loss: 9.4709 - val_accuracy10: 0.7108 - val_accuracy20: 0.6903 - val_accuracy30: 0.6653 - val_accuracy50: 0.6142 - 50s/epoch - 28ms/step
Epoch 23/50
1766/1766 - 49s - loss: 9.4791 - accuracy10: 0.6592 - accuracy20: 0.6413 - accuracy30: 0.6186 - accuracy50: 0.5846 - val_loss: 9.4217 - val_accuracy10: 0.7256 - val_accuracy20: 0.7041 - val_accuracy30: 0.6772 - val_accuracy50: 0.6220 - 49s/epoch - 28ms/step
Epoch 24/50
1766/1766 - 49s - loss: 9.4647 - accuracy10: 0.6592 - accuracy20: 0.6413 - accuracy30: 0.6192 - accuracy50: 0.5854 - val_loss: 9.4121 - val_accuracy10: 0.7186 - val_accuracy20: 0.6989 - val_accuracy30: 0.6739 - val_accuracy50: 0.6200 - 49s/epoch - 28ms/step
Epoch 25/50
1766/1766 - 49s - loss: 9.4379 - accuracy10: 0.6600 - accuracy20: 0.6425 - accuracy30: 0.6203 - accuracy50: 0.5868 - val_loss: 9.4127 - val_accuracy10: 0.7236 - val_accuracy20: 0.7035 - val_accuracy30: 0.6770 - val_accuracy50: 0.6226 - 49s/epoch - 28ms/step
Epoch 26/50
1766/1766 - 50s - loss: 9.4177 - accuracy10: 0.6604 - accuracy20: 0.6434 - accuracy30: 0.6211 - accuracy50: 0.5869 - val_loss: 9.4615 - val_accuracy10: 0.7324 - val_accuracy20: 0.7091 - val_accuracy30: 0.6817 - val_accuracy50: 0.6250 - 50s/epoch - 28ms/step
Epoch 27/50
1766/1766 - 50s - loss: 9.3994 - accuracy10: 0.6599 - accuracy20: 0.6434 - accuracy30: 0.6211 - accuracy50: 0.5876 - val_loss: 9.4743 - val_accuracy10: 0.7211 - val_accuracy20: 0.7014 - val_accuracy30: 0.6760 - val_accuracy50: 0.6217 - 50s/epoch - 28ms/step
Epoch 28/50
1766/1766 - 50s - loss: 9.3833 - accuracy10: 0.6608 - accuracy20: 0.6441 - accuracy30: 0.6213 - accuracy50: 0.5875 - val_loss: 9.4849 - val_accuracy10: 0.7276 - val_accuracy20: 0.7061 - val_accuracy30: 0.6796 - val_accuracy50: 0.6238 - 50s/epoch - 28ms/step
Epoch 29/50
1766/1766 - 49s - loss: 9.3649 - accuracy10: 0.6609 - accuracy20: 0.6446 - accuracy30: 0.6225 - accuracy50: 0.5891 - val_loss: 9.5071 - val_accuracy10: 0.7227 - val_accuracy20: 0.7026 - val_accuracy30: 0.6764 - val_accuracy50: 0.6211 - 49s/epoch - 28ms/step
Epoch 30/50
1766/1766 - 49s - loss: 9.3455 - accuracy10: 0.6607 - accuracy20: 0.6439 - accuracy30: 0.6219 - accuracy50: 0.5886 - val_loss: 9.4911 - val_accuracy10: 0.7159 - val_accuracy20: 0.6969 - val_accuracy30: 0.6716 - val_accuracy50: 0.6198 - 49s/epoch - 28ms/step
testing model: results/AAL/W6/deepVOL_L2/seq2seq
Evaluating performance on  test set...
6203/6203 - 59s - 59s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6598565
{'0': {'precision': 0.4271237067026541, 'recall': 0.5861028533051525, 'f1-score': 0.494141060042425, 'support': 202502}, '1': {'precision': 0.8921306508468074, 'recall': 0.7718652523343595, 'f1-score': 0.8276518573328672, 'support': 1181052}, '2': {'precision': 0.4089588806257613, 'recall': 0.5767717306186374, 'f1-score': 0.4785808995676991, 'support': 204320}, 'accuracy': 0.7230712260544603, 'macro avg': {'precision': 0.576071079391741, 'recall': 0.6449132787527164, 'f1-score': 0.6001246056476637, 'support': 1587874}, 'weighted avg': {'precision': 0.7706559669017062, 'recall': 0.7230712260544603, 'f1-score': 0.7402023609852425, 'support': 1587874}}
[[118687  55935  27880]
 [127004 911613 142435]
 [ 32184  54290 117846]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7180913
{'0': {'precision': 0.4800840370695328, 'recall': 0.5283930592229348, 'f1-score': 0.5030814759479668, 'support': 265100}, '1': {'precision': 0.8200026600345804, 'recall': 0.7778208850739459, 'f1-score': 0.7983549832441179, 'support': 1054217}, '2': {'precision': 0.46840205193322776, 'recall': 0.5164601928082306, 'f1-score': 0.49125858026309266, 'support': 268557}, 'accuracy': 0.6919743002278518, 'macro avg': {'precision': 0.5894962496791136, 'recall': 0.6075580457017038, 'f1-score': 0.5975650131517257, 'support': 1587874}, 'weighted avg': {'precision': 0.7037861142268469, 'recall': 0.6919743002278518, 'f1-score': 0.6971190567917768, 'support': 1587874}}
[[140077  89002  36021]
 [112834 819992 121391]
 [ 38865  90993 138699]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7772524
{'0': {'precision': 0.5023235301861457, 'recall': 0.48975911539806766, 'f1-score': 0.4959617606106345, 'support': 311643}, '1': {'precision': 0.7563557515440182, 'recall': 0.7764048292405388, 'f1-score': 0.7662491657008165, 'support': 959654}, '2': {'precision': 0.49897301745535805, 'recall': 0.47116499303486986, 'f1-score': 0.4846704608041123, 'support': 316577}, 'accuracy': 0.6592903467151676, 'macro avg': {'precision': 0.5858840997285073, 'recall': 0.5791096458911588, 'f1-score': 0.5822937957051878, 'support': 1587874}, 'weighted avg': {'precision': 0.6551834813448607, 'recall': 0.6592903467151676, 'f1-score': 0.657062593312451, 'support': 1587874}}
[[152630 116859  42154]
 [106954 745080 107620]
 [ 44264 123153 149160]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.87083954
{'0': {'precision': 0.5166618144708133, 'recall': 0.4328580158357571, 'f1-score': 0.4710616897758344, 'support': 381289}, '1': {'precision': 0.6491235296055883, 'recall': 0.7718484580980005, 'f1-score': 0.705186308775733, 'support': 816751}, '2': {'precision': 0.5258710300306463, 'recall': 0.40099632151120734, 'f1-score': 0.4550216344999324, 'support': 389834}, 'accuracy': 0.5994014638441085, 'macro avg': {'precision': 0.5638854580356827, 'recall': 0.5352342651483216, 'f1-score': 0.5437565443504999, 'support': 1587874}, 'weighted avg': {'precision': 0.587056759936634, 'recall': 0.5994014638441085, 'f1-score': 0.5875498732112708, 'support': 1587874}}
[[165044 163959  52286]
 [ 97688 630408  88655]
 [ 56711 176801 156322]]
Evaluating performance on  train set...
1766/1766 - 17s - 17s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7095725
{'0': {'precision': 0.393646350256606, 'recall': 0.6318440983746064, 'f1-score': 0.4850813063901792, 'support': 58755}, '1': {'precision': 0.8952048115644283, 'recall': 0.720744449738256, 'f1-score': 0.798557126470554, 'support': 333723}, '2': {'precision': 0.39336157398564, 'recall': 0.5882412246063885, 'f1-score': 0.4714564675779409, 'support': 59513}, 'accuracy': 0.6917416497231139, 'macro avg': {'precision': 0.5607375786022247, 'recall': 0.6469432575730837, 'f1-score': 0.5850316334795581, 'support': 451991}, 'weighted avg': {'precision': 0.7639294897280035, 'recall': 0.6917416497231139, 'f1-score': 0.7147390563729226, 'support': 451991}}
[[ 37124  13612   8019]
 [ 47224 240529  45970]
 [  9960  14545  35008]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.74702674
{'0': {'precision': 0.4614532182470695, 'recall': 0.5833536828305936, 'f1-score': 0.5152922210617139, 'support': 77807}, '1': {'precision': 0.8253602283510478, 'recall': 0.7318546002588459, 'f1-score': 0.7758000616120875, 'support': 295929}, '2': {'precision': 0.4606092494546571, 'recall': 0.5369624944093029, 'f1-score': 0.4958638675493563, 'support': 78255}, 'accuracy': 0.6725487896882902, 'macro avg': {'precision': 0.5824742320175914, 'recall': 0.6173902591662475, 'f1-score': 0.5956520500743859, 'support': 451991}, 'weighted avg': {'precision': 0.6995654656484778, 'recall': 0.6725487896882902, 'f1-score': 0.6824890434367654, 'support': 451991}}
[[ 45389  21994  10424]
 [ 40569 216577  38783]
 [ 12403  23832  42020]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7938845
{'0': {'precision': 0.49356214719877056, 'recall': 0.5446944988040878, 'f1-score': 0.5178692328762875, 'support': 91980}, '1': {'precision': 0.7617322926149019, 'recall': 0.7339444405047606, 'f1-score': 0.7475802343352013, 'support': 267929}, '2': {'precision': 0.49375588939313525, 'recall': 0.49506961186768317, 'f1-score': 0.49441187794521957, 'support': 92082}, 'accuracy': 0.6467673028887744, 'macro avg': {'precision': 0.5830167764022692, 'recall': 0.5912361837255106, 'f1-score': 0.5866204483855695, 'support': 451991}, 'weighted avg': {'precision': 0.6525661960845673, 'recall': 0.6467673028887744, 'f1-score': 0.6492573329781096, 'support': 451991}}
[[ 50101  29392  12487]
 [ 37031 196645  34253]
 [ 14377  32118  45587]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.87448215
{'0': {'precision': 0.5232651823205468, 'recall': 0.4868466307444022, 'f1-score': 0.5043993896589216, 'support': 113393}, '1': {'precision': 0.650697566482196, 'recall': 0.7336547032502118, 'f1-score': 0.689690536839165, 'support': 225493}, '2': {'precision': 0.5232035035610142, 'recall': 0.42672737721586135, 'f1-score': 0.4700663244933139, 'support': 113105}, 'accuracy': 0.5949321999774332, 'macro avg': {'precision': 0.5657220841212524, 'recall': 0.5490762370701584, 'f1-score': 0.5547187503304668, 'support': 451991}, 'weighted avg': {'precision': 0.58682426740336, 'recall': 0.5949321999774332, 'f1-score': 0.5882475532629726, 'support': 451991}}
[[ 55205  42362  15826]
 [ 31901 165434  28158]
 [ 18395  46445  48265]]
Evaluating performance on  val set...
579/579 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.67194295
{'0': {'precision': 0.39977073549532227, 'recall': 0.6253470615455807, 'f1-score': 0.4877399562382983, 'support': 17288}, '1': {'precision': 0.9115785435713829, 'recall': 0.7491527501685743, 'f1-score': 0.8224227188171448, 'support': 114193}, '2': {'precision': 0.3619173748298569, 'recall': 0.5929720933035983, 'f1-score': 0.4494905651756751, 'support': 16591}, 'accuracy': 0.7171983899724458, 'macro avg': {'precision': 0.557755551298854, 'recall': 0.6558239683392512, 'f1-score': 0.5865510800770394, 'support': 148072}, 'weighted avg': {'precision': 0.7902351306600317, 'recall': 0.7171983899724458, 'f1-score': 0.7415612935609942, 'support': 148072}}
[[10811  4304  2173]
 [13473 85548 15172]
 [ 2759  3994  9838]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7105154
{'0': {'precision': 0.46325607687959297, 'recall': 0.571877180739707, 'f1-score': 0.5118675827607745, 'support': 22928}, '1': {'precision': 0.850607265399488, 'recall': 0.7579787234042553, 'f1-score': 0.8016260412977534, 'support': 103024}, '2': {'precision': 0.4290312198261989, 'recall': 0.5423598553345389, 'f1-score': 0.47908471936585273, 'support': 22120}, 'accuracy': 0.696951483062294, 'macro avg': {'precision': 0.5809648540350933, 'recall': 0.624071919826167, 'f1-score': 0.5975261144747935, 'support': 148072}, 'weighted avg': {'precision': 0.7276505269312745, 'recall': 0.696951483062294, 'f1-score': 0.7085753904085274, 'support': 148072}}
[[13112  6968  2848]
 [11816 78090 13118]
 [ 3376  6747 11997]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.76166147
{'0': {'precision': 0.4926667123569324, 'recall': 0.529305647595906, 'f1-score': 0.5103294050830611, 'support': 27162}, '1': {'precision': 0.7926287107414313, 'recall': 0.7596287016186156, 'f1-score': 0.7757779265369582, 'support': 94587}, '2': {'precision': 0.4633688608760313, 'recall': 0.497131785890666, 'f1-score': 0.4796569166483396, 'support': 26323}, 'accuracy': 0.6707142471230212, 'macro avg': {'precision': 0.5828880946581316, 'recall': 0.5953553783683958, 'f1-score': 0.5885880827561196, 'support': 148072}, 'weighted avg': {'precision': 0.6790712871358429, 'recall': 0.6707142471230212, 'f1-score': 0.6744427241825033, 'support': 148072}}
[[14377  9405  3380]
 [10961 71851 11775]
 [ 3844  9393 13086]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8472407
{'0': {'precision': 0.5210385844673631, 'recall': 0.4648558073904224, 'f1-score': 0.49134636298667, 'support': 34017}, '1': {'precision': 0.6889836277803199, 'recall': 0.7603300695855656, 'f1-score': 0.7229007365425825, 'support': 81195}, '2': {'precision': 0.4962304409672831, 'recall': 0.42465003043213634, 'f1-score': 0.4576582486061003, 'support': 32860}, 'accuracy': 0.6179561294505376, 'macro avg': {'precision': 0.5687508844049887, 'recall': 0.5499453024693748, 'f1-score': 0.5573017827117842, 'support': 148072}, 'weighted avg': {'precision': 0.6076255299829426, 'recall': 0.6179561294505376, 'f1-score': 0.6108427290945553, 'support': 148072}}
[[15813 13809  4395]
 [ 9689 61735  9771]
 [ 4847 14059 13954]]
training model: results/AAL/W6/deepVOL_L3/seq2seq
Epoch 1/50
1766/1766 - 79s - loss: 12.4110 - accuracy10: 0.4271 - accuracy20: 0.4341 - accuracy30: 0.4383 - accuracy50: 0.4416 - val_loss: 12.2622 - val_accuracy10: 0.6710 - val_accuracy20: 0.6237 - val_accuracy30: 0.5889 - val_accuracy50: 0.5234 - 79s/epoch - 45ms/step
Epoch 2/50
1766/1766 - 73s - loss: 11.4098 - accuracy10: 0.4743 - accuracy20: 0.4901 - accuracy30: 0.4961 - accuracy50: 0.4952 - val_loss: 10.4039 - val_accuracy10: 0.6784 - val_accuracy20: 0.6629 - val_accuracy30: 0.6418 - val_accuracy50: 0.5943 - 73s/epoch - 41ms/step
Epoch 3/50
1766/1766 - 72s - loss: 10.6355 - accuracy10: 0.5817 - accuracy20: 0.5775 - accuracy30: 0.5644 - accuracy50: 0.5407 - val_loss: 10.0550 - val_accuracy10: 0.6904 - val_accuracy20: 0.6743 - val_accuracy30: 0.6525 - val_accuracy50: 0.6047 - 72s/epoch - 41ms/step
Epoch 4/50
1766/1766 - 72s - loss: 10.3673 - accuracy10: 0.6009 - accuracy20: 0.5910 - accuracy30: 0.5739 - accuracy50: 0.5484 - val_loss: 9.6063 - val_accuracy10: 0.7086 - val_accuracy20: 0.6877 - val_accuracy30: 0.6612 - val_accuracy50: 0.6116 - 72s/epoch - 41ms/step
Epoch 5/50
1766/1766 - 71s - loss: 10.1755 - accuracy10: 0.6161 - accuracy20: 0.6041 - accuracy30: 0.5847 - accuracy50: 0.5557 - val_loss: 9.6152 - val_accuracy10: 0.7206 - val_accuracy20: 0.6977 - val_accuracy30: 0.6681 - val_accuracy50: 0.6123 - 71s/epoch - 40ms/step
Epoch 6/50
1766/1766 - 71s - loss: 10.0192 - accuracy10: 0.6256 - accuracy20: 0.6144 - accuracy30: 0.5938 - accuracy50: 0.5616 - val_loss: 9.5063 - val_accuracy10: 0.7291 - val_accuracy20: 0.7069 - val_accuracy30: 0.6769 - val_accuracy50: 0.6202 - 71s/epoch - 40ms/step
Epoch 7/50
1766/1766 - 72s - loss: 9.9431 - accuracy10: 0.6304 - accuracy20: 0.6204 - accuracy30: 0.5995 - accuracy50: 0.5660 - val_loss: 9.4976 - val_accuracy10: 0.7180 - val_accuracy20: 0.6964 - val_accuracy30: 0.6692 - val_accuracy50: 0.6151 - 72s/epoch - 41ms/step
Epoch 8/50
1766/1766 - 72s - loss: 9.8497 - accuracy10: 0.6352 - accuracy20: 0.6247 - accuracy30: 0.6041 - accuracy50: 0.5697 - val_loss: 9.5107 - val_accuracy10: 0.7158 - val_accuracy20: 0.6981 - val_accuracy30: 0.6712 - val_accuracy50: 0.6165 - 72s/epoch - 41ms/step
Epoch 9/50
1766/1766 - 72s - loss: 9.7935 - accuracy10: 0.6390 - accuracy20: 0.6293 - accuracy30: 0.6080 - accuracy50: 0.5722 - val_loss: 9.4739 - val_accuracy10: 0.7095 - val_accuracy20: 0.6935 - val_accuracy30: 0.6690 - val_accuracy50: 0.6162 - 72s/epoch - 41ms/step
Epoch 10/50
1766/1766 - 72s - loss: 9.7431 - accuracy10: 0.6411 - accuracy20: 0.6306 - accuracy30: 0.6098 - accuracy50: 0.5743 - val_loss: 9.3225 - val_accuracy10: 0.7084 - val_accuracy20: 0.6928 - val_accuracy30: 0.6693 - val_accuracy50: 0.6173 - 72s/epoch - 41ms/step
Epoch 11/50
1766/1766 - 72s - loss: 9.7073 - accuracy10: 0.6442 - accuracy20: 0.6332 - accuracy30: 0.6120 - accuracy50: 0.5759 - val_loss: 9.3253 - val_accuracy10: 0.7127 - val_accuracy20: 0.6982 - val_accuracy30: 0.6737 - val_accuracy50: 0.6204 - 72s/epoch - 41ms/step
Epoch 12/50
1766/1766 - 73s - loss: 9.6619 - accuracy10: 0.6464 - accuracy20: 0.6346 - accuracy30: 0.6134 - accuracy50: 0.5779 - val_loss: 9.3010 - val_accuracy10: 0.7088 - val_accuracy20: 0.6947 - val_accuracy30: 0.6713 - val_accuracy50: 0.6198 - 73s/epoch - 41ms/step
Epoch 13/50
1766/1766 - 72s - loss: 9.6355 - accuracy10: 0.6482 - accuracy20: 0.6363 - accuracy30: 0.6146 - accuracy50: 0.5786 - val_loss: 9.3327 - val_accuracy10: 0.7274 - val_accuracy20: 0.7091 - val_accuracy30: 0.6824 - val_accuracy50: 0.6248 - 72s/epoch - 41ms/step
Epoch 14/50
1766/1766 - 72s - loss: 9.6044 - accuracy10: 0.6502 - accuracy20: 0.6377 - accuracy30: 0.6164 - accuracy50: 0.5803 - val_loss: 9.2970 - val_accuracy10: 0.7250 - val_accuracy20: 0.7064 - val_accuracy30: 0.6803 - val_accuracy50: 0.6243 - 72s/epoch - 41ms/step
Epoch 15/50
1766/1766 - 72s - loss: 9.5747 - accuracy10: 0.6514 - accuracy20: 0.6391 - accuracy30: 0.6179 - accuracy50: 0.5818 - val_loss: 9.3827 - val_accuracy10: 0.7340 - val_accuracy20: 0.7112 - val_accuracy30: 0.6827 - val_accuracy50: 0.6247 - 72s/epoch - 41ms/step
Epoch 16/50
1766/1766 - 72s - loss: 9.5483 - accuracy10: 0.6525 - accuracy20: 0.6394 - accuracy30: 0.6183 - accuracy50: 0.5828 - val_loss: 9.3667 - val_accuracy10: 0.7278 - val_accuracy20: 0.7070 - val_accuracy30: 0.6807 - val_accuracy50: 0.6240 - 72s/epoch - 41ms/step
Epoch 17/50
1766/1766 - 72s - loss: 9.5262 - accuracy10: 0.6540 - accuracy20: 0.6406 - accuracy30: 0.6197 - accuracy50: 0.5840 - val_loss: 9.4738 - val_accuracy10: 0.7298 - val_accuracy20: 0.7090 - val_accuracy30: 0.6823 - val_accuracy50: 0.6253 - 72s/epoch - 41ms/step
Epoch 18/50
1766/1766 - 72s - loss: 9.5019 - accuracy10: 0.6546 - accuracy20: 0.6412 - accuracy30: 0.6202 - accuracy50: 0.5849 - val_loss: 9.4547 - val_accuracy10: 0.7331 - val_accuracy20: 0.7122 - val_accuracy30: 0.6844 - val_accuracy50: 0.6272 - 72s/epoch - 41ms/step
Epoch 19/50
1766/1766 - 72s - loss: 9.4812 - accuracy10: 0.6559 - accuracy20: 0.6416 - accuracy30: 0.6205 - accuracy50: 0.5859 - val_loss: 9.4108 - val_accuracy10: 0.7300 - val_accuracy20: 0.7088 - val_accuracy30: 0.6817 - val_accuracy50: 0.6249 - 72s/epoch - 41ms/step
Epoch 20/50
1766/1766 - 72s - loss: 9.4557 - accuracy10: 0.6562 - accuracy20: 0.6424 - accuracy30: 0.6213 - accuracy50: 0.5865 - val_loss: 9.4165 - val_accuracy10: 0.7310 - val_accuracy20: 0.7094 - val_accuracy30: 0.6829 - val_accuracy50: 0.6260 - 72s/epoch - 41ms/step
Epoch 21/50
1766/1766 - 72s - loss: 9.4407 - accuracy10: 0.6567 - accuracy20: 0.6430 - accuracy30: 0.6222 - accuracy50: 0.5878 - val_loss: 9.3863 - val_accuracy10: 0.7289 - val_accuracy20: 0.7061 - val_accuracy30: 0.6792 - val_accuracy50: 0.6242 - 72s/epoch - 41ms/step
Epoch 22/50
1766/1766 - 72s - loss: 9.4225 - accuracy10: 0.6572 - accuracy20: 0.6439 - accuracy30: 0.6232 - accuracy50: 0.5884 - val_loss: 9.3657 - val_accuracy10: 0.7438 - val_accuracy20: 0.7186 - val_accuracy30: 0.6883 - val_accuracy50: 0.6282 - 72s/epoch - 41ms/step
Epoch 23/50
1766/1766 - 71s - loss: 9.3923 - accuracy10: 0.6583 - accuracy20: 0.6445 - accuracy30: 0.6238 - accuracy50: 0.5900 - val_loss: 9.3824 - val_accuracy10: 0.7347 - val_accuracy20: 0.7095 - val_accuracy30: 0.6800 - val_accuracy50: 0.6239 - 71s/epoch - 40ms/step
Epoch 24/50
1766/1766 - 72s - loss: 9.3864 - accuracy10: 0.6585 - accuracy20: 0.6442 - accuracy30: 0.6232 - accuracy50: 0.5898 - val_loss: 9.3439 - val_accuracy10: 0.7304 - val_accuracy20: 0.7058 - val_accuracy30: 0.6786 - val_accuracy50: 0.6243 - 72s/epoch - 41ms/step
testing model: results/AAL/W6/deepVOL_L3/seq2seq
Evaluating performance on  test set...
6203/6203 - 102s - 102s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6566218
{'0': {'precision': 0.43007838999020126, 'recall': 0.563535174961235, 'f1-score': 0.48784418671260815, 'support': 202502}, '1': {'precision': 0.8957051746198633, 'recall': 0.7646073161892957, 'f1-score': 0.8249805183711989, 'support': 1181052}, '2': {'precision': 0.3981943348688061, 'recall': 0.6126174628034455, 'f1-score': 0.4826631499390742, 'support': 204320}, 'accuracy': 0.7194072073728772, 'macro avg': {'precision': 0.5746592998262903, 'recall': 0.6469199846513254, 'f1-score': 0.5984959516742938, 'support': 1587874}, 'weighted avg': {'precision': 0.7723063596515397, 'recall': 0.7194072073728772, 'f1-score': 0.7379376760854889, 'support': 1587874}}
[[114117  56058  32327]
 [121164 903041 156847]
 [ 30059  49091 125170]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.707847
{'0': {'precision': 0.48788845784061025, 'recall': 0.4919502074688797, 'f1-score': 0.4899109140187864, 'support': 265100}, '1': {'precision': 0.8231665366231339, 'recall': 0.7785693078370013, 'f1-score': 0.8002470605498218, 'support': 1054217}, '2': {'precision': 0.46009614641460433, 'recall': 0.5541654099502155, 'f1-score': 0.5027684781984453, 'support': 268557}, 'accuracy': 0.6927640354335419, 'macro avg': {'precision': 0.5903837136261162, 'recall': 0.6082283084186989, 'f1-score': 0.5976421509223512, 'support': 1587874}, 'weighted avg': {'precision': 0.7057848593184617, 'recall': 0.6927640354335419, 'f1-score': 0.6981230456179593, 'support': 1587874}}
[[130416  91745  42939]
 [101735 820781 131701]
 [ 35156  84576 148825]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7650563
{'0': {'precision': 0.5205234476936066, 'recall': 0.435235188982265, 'f1-score': 0.4740739187344794, 'support': 311643}, '1': {'precision': 0.7576426398709439, 'recall': 0.7869502966694246, 'f1-score': 0.7720184213081991, 'support': 959654}, '2': {'precision': 0.4892592839119201, 'recall': 0.5108046383660215, 'f1-score': 0.4997998748251803, 'support': 316577}, 'accuracy': 0.6628655674190773, 'macro avg': {'precision': 0.5891417904921569, 'recall': 0.5776633746725705, 'f1-score': 0.5819640716226195, 'support': 1587874}, 'weighted avg': {'precision': 0.6575965820054195, 'recall': 0.6628655674190773, 'f1-score': 0.6592698975553469, 'support': 1587874}}
[[135638 124920  51085]
 [ 86730 755200 117724]
 [ 38212 116656 161709]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8592171
{'0': {'precision': 0.544440303630622, 'recall': 0.36399161790662726, 'f1-score': 0.43629401889959823, 'support': 381289}, '1': {'precision': 0.6506644291570418, 'recall': 0.7880418879193292, 'f1-score': 0.7127942917451573, 'support': 816751}, '2': {'precision': 0.5125696698898081, 'recall': 0.4519949516973891, 'f1-score': 0.4803802627597131, 'support': 389834}, 'accuracy': 0.6037147783766218, 'macro avg': {'precision': 0.5692248008924906, 'recall': 0.5346761525077819, 'f1-score': 0.5431561911348229, 'support': 1587874}, 'weighted avg': {'precision': 0.5912540962326247, 'recall': 0.6037147783766218, 'f1-score': 0.589340287769702, 'support': 1587874}}
[[138786 177881  64622]
 [ 70178 643634 102939]
 [ 45951 167680 176203]]
Evaluating performance on  train set...
1766/1766 - 31s - 31s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.69079673
{'0': {'precision': 0.42177423386492024, 'recall': 0.5743681388817973, 'f1-score': 0.4863836502914958, 'support': 58755}, '1': {'precision': 0.8931891118306927, 'recall': 0.7405812605064679, 'f1-score': 0.8097577597321218, 'support': 333723}, '2': {'precision': 0.38897927053266856, 'recall': 0.6227210861492447, 'f1-score': 0.47884848954699333, 'support': 59513}, 'accuracy': 0.703456484753015, 'macro avg': {'precision': 0.5679808720760938, 'recall': 0.6458901618458366, 'f1-score': 0.5916632998568704, 'support': 451991}, 'weighted avg': {'precision': 0.7655205931211427, 'recall': 0.703456484753015, 'f1-score': 0.7241515215620885, 'support': 451991}}
[[ 33747  15379   9629]
 [ 37988 247149  48586]
 [  8277  14176  37060]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7271255
{'0': {'precision': 0.49512787007653536, 'recall': 0.5113421671571966, 'f1-score': 0.5031044119320697, 'support': 77807}, '1': {'precision': 0.8212515455570023, 'recall': 0.760875074764555, 'f1-score': 0.7899112790342779, 'support': 295929}, '2': {'precision': 0.45676820947436464, 'recall': 0.5688837773944156, 'f1-score': 0.5066982323950875, 'support': 78255}, 'accuracy': 0.6846795622036722, 'macro avg': {'precision': 0.5910492083693007, 'recall': 0.6137003397720556, 'f1-score': 0.5999046411204784, 'support': 451991}, 'weighted avg': {'precision': 0.7020072502430347, 'recall': 0.6846795622036721, 'f1-score': 0.691505738053658, 'support': 451991}}
[[ 39786  25241  12780]
 [ 30599 225165  40165]
 [  9970  23767  44518]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.77545804
{'0': {'precision': 0.5361847601177242, 'recall': 0.4535768645357686, 'f1-score': 0.491433485090318, 'support': 91980}, '1': {'precision': 0.7551267683530302, 'recall': 0.7745820721161203, 'f1-score': 0.7647307009899385, 'support': 267929}, '2': {'precision': 0.48926019124308, 'recall': 0.5278773267305228, 'f1-score': 0.5078356805549751, 'support': 92082}, 'accuracy': 0.6589976349086597, 'macro avg': {'precision': 0.5935239065712782, 'recall': 0.5853454211274706, 'f1-score': 0.5879999555450771, 'support': 451991}, 'weighted avg': {'precision': 0.6564084043348929, 'recall': 0.6589976349086597, 'f1-score': 0.6567788055094103, 'support': 451991}}
[[ 41720  34852  15408]
 [ 25062 207533  35334]
 [ 11027  32447  48608]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.86288726
{'0': {'precision': 0.5708687478486509, 'recall': 0.3802703870609297, 'f1-score': 0.45647260582129606, 'support': 113393}, '1': {'precision': 0.6433886411812002, 'recall': 0.7807071616413813, 'f1-score': 0.7054274282577292, 'support': 225493}, '2': {'precision': 0.5159913260791349, 'recall': 0.4691481366871491, 'f1-score': 0.491456039121616, 'support': 113105}, 'accuracy': 0.6022841162766516, 'macro avg': {'precision': 0.5767495717029953, 'recall': 0.5433752284631533, 'f1-score': 0.5511186910668805, 'support': 451991}, 'weighted avg': {'precision': 0.5933156937347315, 'recall': 0.6022841162766516, 'f1-score': 0.5894274013793741, 'support': 451991}}
[[ 43120  50812  19461]
 [ 19136 176044  30313]
 [ 13278  46764  53063]]
Evaluating performance on  val set...
579/579 - 10s - 10s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6534146
{'0': {'precision': 0.41132090860894743, 'recall': 0.5834104581212401, 'f1-score': 0.48247984883637496, 'support': 17288}, '1': {'precision': 0.9114151131440081, 'recall': 0.7607909416514147, 'f1-score': 0.8293192817663736, 'support': 114193}, '2': {'precision': 0.3656039674105561, 'recall': 0.622084262551986, 'f1-score': 0.4605430490172017, 'support': 16591}, 'accuracy': 0.7245394132584149, 'macro avg': {'precision': 0.5627799963878372, 'recall': 0.6554285541082137, 'f1-score': 0.5907807265399835, 'support': 148072}, 'weighted avg': {'precision': 0.7918706933558927, 'recall': 0.7245394132584149, 'f1-score': 0.7475041742913929, 'support': 148072}}
[[10086  4573  2629]
 [12036 86877 15280]
 [ 2399  3871 10321]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6894195
{'0': {'precision': 0.47823121062557683, 'recall': 0.51980111653873, 'f1-score': 0.49815043156596794, 'support': 22928}, '1': {'precision': 0.8492408960611529, 'recall': 0.776421028109955, 'f1-score': 0.8112000162260286, 'support': 103024}, '2': {'precision': 0.43541314181140156, 'recall': 0.5700723327305606, 'f1-score': 0.4937256514163779, 'support': 22120}, 'accuracy': 0.7058593116862067, 'macro avg': {'precision': 0.5876284161660438, 'recall': 0.6220981591264151, 'f1-score': 0.6010253664027915, 'support': 148072}, 'weighted avg': {'precision': 0.7299720269186317, 'recall': 0.7058593116862067, 'f1-score': 0.7152998201952102, 'support': 148072}}
[[11918  7512  3498]
 [10181 79990 12853]
 [ 2822  6688 12610]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7411145
{'0': {'precision': 0.5162591586399934, 'recall': 0.4617480303364995, 'f1-score': 0.4874844527363184, 'support': 27162}, '1': {'precision': 0.7892490924144959, 'recall': 0.7860699673316629, 'f1-score': 0.787656322003464, 'support': 94587}, '2': {'precision': 0.46790883267956174, 'recall': 0.525661968620598, 'f1-score': 0.49510689686018433, 'support': 26323}, 'accuracy': 0.6802839159327895, 'macro avg': {'precision': 0.5911390279113503, 'recall': 0.5911599887629202, 'f1-score': 0.5900825571999889, 'support': 148072}, 'weighted avg': {'precision': 0.6820472430561721, 'recall': 0.6802839159327895, 'f1-score': 0.6805864719907624, 'support': 148072}}
[[12542 10459  4161]
 [ 8661 74352 11574]
 [ 3091  9395 13837]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8306647
{'0': {'precision': 0.5510480054090602, 'recall': 0.3833377428932592, 'f1-score': 0.4521419531561519, 'support': 34017}, '1': {'precision': 0.6848789762652482, 'recall': 0.7896668514071064, 'f1-score': 0.7335495643916642, 'support': 81195}, '2': {'precision': 0.4937642091588178, 'recall': 0.46265976871576386, 'f1-score': 0.4777062058130401, 'support': 32860}, 'accuracy': 0.6237506078124155, 'macro avg': {'precision': 0.5765637302777087, 'recall': 0.5452214543387098, 'f1-score': 0.554465907786952, 'support': 148072}, 'weighted avg': {'precision': 0.6117215975391403, 'recall': 0.6237506078124155, 'f1-score': 0.6121244774455027, 'support': 148072}}
[[13040 15542  5435]
 [ 6926 64117 10152]
 [ 3698 13959 15203]]
training model: results/AAL/W7/deepLOB_L1/seq2seq
Epoch 1/50
2013/2013 - 58s - loss: 11.6208 - accuracy10: 0.4503 - accuracy20: 0.4663 - accuracy30: 0.4744 - accuracy50: 0.4769 - val_loss: 12.3651 - val_accuracy10: 0.6258 - val_accuracy20: 0.5745 - val_accuracy30: 0.5366 - val_accuracy50: 0.4804 - 58s/epoch - 29ms/step
Epoch 2/50
2013/2013 - 49s - loss: 11.2933 - accuracy10: 0.4632 - accuracy20: 0.4850 - accuracy30: 0.4966 - accuracy50: 0.4990 - val_loss: 11.2846 - val_accuracy10: 0.6507 - val_accuracy20: 0.6211 - val_accuracy30: 0.5948 - val_accuracy50: 0.5468 - 49s/epoch - 25ms/step
Epoch 3/50
2013/2013 - 50s - loss: 10.8216 - accuracy10: 0.5336 - accuracy20: 0.5385 - accuracy30: 0.5349 - accuracy50: 0.5208 - val_loss: 11.6957 - val_accuracy10: 0.7572 - val_accuracy20: 0.6981 - val_accuracy30: 0.6477 - val_accuracy50: 0.5664 - 50s/epoch - 25ms/step
Epoch 4/50
2013/2013 - 50s - loss: 10.6018 - accuracy10: 0.5659 - accuracy20: 0.5602 - accuracy30: 0.5476 - accuracy50: 0.5262 - val_loss: 10.8059 - val_accuracy10: 0.7298 - val_accuracy20: 0.6871 - val_accuracy30: 0.6480 - val_accuracy50: 0.5822 - 50s/epoch - 25ms/step
Epoch 5/50
2013/2013 - 50s - loss: 10.4271 - accuracy10: 0.5880 - accuracy20: 0.5792 - accuracy30: 0.5623 - accuracy50: 0.5359 - val_loss: 10.3993 - val_accuracy10: 0.7250 - val_accuracy20: 0.6858 - val_accuracy30: 0.6467 - val_accuracy50: 0.5849 - 50s/epoch - 25ms/step
Epoch 6/50
2013/2013 - 52s - loss: 10.2542 - accuracy10: 0.6063 - accuracy20: 0.5929 - accuracy30: 0.5727 - accuracy50: 0.5424 - val_loss: 10.7335 - val_accuracy10: 0.7595 - val_accuracy20: 0.7085 - val_accuracy30: 0.6629 - val_accuracy50: 0.5902 - 52s/epoch - 26ms/step
Epoch 7/50
2013/2013 - 52s - loss: 10.1392 - accuracy10: 0.6142 - accuracy20: 0.6000 - accuracy30: 0.5788 - accuracy50: 0.5478 - val_loss: 10.4409 - val_accuracy10: 0.7471 - val_accuracy20: 0.7008 - val_accuracy30: 0.6572 - val_accuracy50: 0.5895 - 52s/epoch - 26ms/step
Epoch 8/50
2013/2013 - 52s - loss: 10.0299 - accuracy10: 0.6222 - accuracy20: 0.6066 - accuracy30: 0.5852 - accuracy50: 0.5528 - val_loss: 10.2369 - val_accuracy10: 0.7244 - val_accuracy20: 0.6819 - val_accuracy30: 0.6427 - val_accuracy50: 0.5812 - 52s/epoch - 26ms/step
Epoch 9/50
2013/2013 - 53s - loss: 9.9376 - accuracy10: 0.6263 - accuracy20: 0.6106 - accuracy30: 0.5898 - accuracy50: 0.5571 - val_loss: 10.5020 - val_accuracy10: 0.7495 - val_accuracy20: 0.6987 - val_accuracy30: 0.6533 - val_accuracy50: 0.5848 - 53s/epoch - 26ms/step
Epoch 10/50
2013/2013 - 49s - loss: 9.8711 - accuracy10: 0.6306 - accuracy20: 0.6143 - accuracy30: 0.5930 - accuracy50: 0.5603 - val_loss: 10.2965 - val_accuracy10: 0.7189 - val_accuracy20: 0.6766 - val_accuracy30: 0.6382 - val_accuracy50: 0.5792 - 49s/epoch - 24ms/step
Epoch 11/50
2013/2013 - 48s - loss: 9.8324 - accuracy10: 0.6318 - accuracy20: 0.6162 - accuracy30: 0.5957 - accuracy50: 0.5629 - val_loss: 10.2166 - val_accuracy10: 0.7340 - val_accuracy20: 0.6901 - val_accuracy30: 0.6512 - val_accuracy50: 0.5886 - 48s/epoch - 24ms/step
Epoch 12/50
2013/2013 - 50s - loss: 9.7829 - accuracy10: 0.6362 - accuracy20: 0.6181 - accuracy30: 0.5971 - accuracy50: 0.5644 - val_loss: 10.0409 - val_accuracy10: 0.7144 - val_accuracy20: 0.6745 - val_accuracy30: 0.6397 - val_accuracy50: 0.5825 - 50s/epoch - 25ms/step
Epoch 13/50
2013/2013 - 49s - loss: 9.7329 - accuracy10: 0.6385 - accuracy20: 0.6211 - accuracy30: 0.5996 - accuracy50: 0.5665 - val_loss: 10.8266 - val_accuracy10: 0.7597 - val_accuracy20: 0.7011 - val_accuracy30: 0.6533 - val_accuracy50: 0.5812 - 49s/epoch - 25ms/step
Epoch 14/50
2013/2013 - 52s - loss: 9.6948 - accuracy10: 0.6407 - accuracy20: 0.6227 - accuracy30: 0.6010 - accuracy50: 0.5682 - val_loss: 10.3402 - val_accuracy10: 0.7306 - val_accuracy20: 0.6793 - val_accuracy30: 0.6353 - val_accuracy50: 0.5740 - 52s/epoch - 26ms/step
Epoch 15/50
2013/2013 - 52s - loss: 9.6602 - accuracy10: 0.6430 - accuracy20: 0.6240 - accuracy30: 0.6024 - accuracy50: 0.5688 - val_loss: 10.3134 - val_accuracy10: 0.7330 - val_accuracy20: 0.6853 - val_accuracy30: 0.6464 - val_accuracy50: 0.5844 - 52s/epoch - 26ms/step
Epoch 16/50
2013/2013 - 53s - loss: 9.6342 - accuracy10: 0.6444 - accuracy20: 0.6259 - accuracy30: 0.6046 - accuracy50: 0.5715 - val_loss: 10.2753 - val_accuracy10: 0.7341 - val_accuracy20: 0.6854 - val_accuracy30: 0.6448 - val_accuracy50: 0.5834 - 53s/epoch - 26ms/step
Epoch 17/50
2013/2013 - 53s - loss: 9.6079 - accuracy10: 0.6461 - accuracy20: 0.6272 - accuracy30: 0.6054 - accuracy50: 0.5711 - val_loss: 10.3808 - val_accuracy10: 0.7411 - val_accuracy20: 0.6886 - val_accuracy30: 0.6474 - val_accuracy50: 0.5843 - 53s/epoch - 26ms/step
Epoch 18/50
2013/2013 - 49s - loss: 9.5790 - accuracy10: 0.6467 - accuracy20: 0.6280 - accuracy30: 0.6063 - accuracy50: 0.5725 - val_loss: 10.2334 - val_accuracy10: 0.7215 - val_accuracy20: 0.6742 - val_accuracy30: 0.6365 - val_accuracy50: 0.5782 - 49s/epoch - 24ms/step
Epoch 19/50
2013/2013 - 51s - loss: 9.5596 - accuracy10: 0.6475 - accuracy20: 0.6289 - accuracy30: 0.6069 - accuracy50: 0.5733 - val_loss: 10.3350 - val_accuracy10: 0.7396 - val_accuracy20: 0.6888 - val_accuracy30: 0.6479 - val_accuracy50: 0.5853 - 51s/epoch - 25ms/step
Epoch 20/50
2013/2013 - 54s - loss: 9.5387 - accuracy10: 0.6487 - accuracy20: 0.6297 - accuracy30: 0.6079 - accuracy50: 0.5740 - val_loss: 10.4248 - val_accuracy10: 0.7395 - val_accuracy20: 0.6880 - val_accuracy30: 0.6461 - val_accuracy50: 0.5825 - 54s/epoch - 27ms/step
Epoch 21/50
2013/2013 - 51s - loss: 9.5157 - accuracy10: 0.6498 - accuracy20: 0.6309 - accuracy30: 0.6093 - accuracy50: 0.5752 - val_loss: 10.4312 - val_accuracy10: 0.7422 - val_accuracy20: 0.6874 - val_accuracy30: 0.6441 - val_accuracy50: 0.5806 - 51s/epoch - 26ms/step
Epoch 22/50
2013/2013 - 49s - loss: 9.5115 - accuracy10: 0.6492 - accuracy20: 0.6311 - accuracy30: 0.6089 - accuracy50: 0.5754 - val_loss: 10.3575 - val_accuracy10: 0.7471 - val_accuracy20: 0.6971 - val_accuracy30: 0.6550 - val_accuracy50: 0.5895 - 49s/epoch - 25ms/step
testing model: results/AAL/W7/deepLOB_L1/seq2seq
Evaluating performance on  test set...
5331/5331 - 51s - 51s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.671327
{'0': {'precision': 0.31838434031188406, 'recall': 0.6795913613067668, 'f1-score': 0.4336202713159655, 'support': 145948}, '1': {'precision': 0.8895316118401927, 'recall': 0.7573368575404645, 'f1-score': 0.8181285732518843, 'support': 1070690}, '2': {'precision': 0.42983032641494767, 'recall': 0.41106185121107264, 'f1-score': 0.4202366352880214, 'support': 147968}, 'accuracy': 0.7114742277258052, 'macro avg': {'precision': 0.5459154261890081, 'recall': 0.6159966900194347, 'f1-score': 0.5573284932852903, 'support': 1364606}, 'weighted avg': {'precision': 0.7785993121237791, 'recall': 0.7114742277258052, 'f1-score': 0.7338599331260308, 'support': 1364606}}
[[ 99185  35646  11117]
 [190251 810873  69566]
 [ 22090  65054  60824]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.74908715
{'0': {'precision': 0.3757610477980399, 'recall': 0.6492106937612993, 'f1-score': 0.4760093974070118, 'support': 198022}, '1': {'precision': 0.8326187140626695, 'recall': 0.7309128439559711, 'f1-score': 0.7784578560060683, 'support': 966003}, '2': {'precision': 0.46502364235563837, 'recall': 0.4044999277100024, 'f1-score': 0.43265539012840754, 'support': 200581}, 'accuracy': 0.6710779521708098, 'macro avg': {'precision': 0.5578011347387827, 'recall': 0.5948744884757576, 'f1-score': 0.5623742145138292, 'support': 1364606}, 'weighted avg': {'precision': 0.7122906077322543, 'recall': 0.6710779521708098, 'f1-score': 0.6837397812820019, 'support': 1364606}}
[[128558  54650  14814]
 [181413 706064  78526]
 [ 32156  87290  81135]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.81471914
{'0': {'precision': 0.40352863119981586, 'recall': 0.6255389175052161, 'f1-score': 0.49058560530985684, 'support': 238209}, '1': {'precision': 0.7792414005411623, 'recall': 0.7066531790927535, 'f1-score': 0.7411742670314715, 'support': 884765}, '2': {'precision': 0.4830046529943936, 'recall': 0.3857808568401536, 'f1-score': 0.42895270876569747, 'support': 241632}, 'accuracy': 0.635676524945662, 'macro avg': {'precision': 0.5552582282451239, 'recall': 0.5726576511460411, 'f1-score': 0.5535708603690086, 'support': 1364606}, 'weighted avg': {'precision': 0.6612011450716322, 'recall': 0.635676524945662, 'f1-score': 0.6421455407273811, 'support': 1364606}}
[[149009  70501  18699]
 [178465 625222  81078]
 [ 41791 106624  93217]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.89775187
{'0': {'precision': 0.4339226304063302, 'recall': 0.5798883129107738, 'f1-score': 0.49639760497520535, 'support': 299587}, '1': {'precision': 0.6854701696173532, 'recall': 0.6772375356546657, 'f1-score': 0.6813289844042891, 'support': 760770}, '2': {'precision': 0.49969192273139895, 'recall': 0.3491843851582092, 'f1-score': 0.4110955039875555, 'support': 304249}, 'accuracy': 0.5827235114018259, 'macro avg': {'precision': 0.5396949075850275, 'recall': 0.5354367445745496, 'f1-score': 0.5296073644556832, 'support': 1364606}, 'weighted avg': {'precision': 0.5888245309008171, 'recall': 0.5827235114018259, 'f1-score': 0.5804784067633204, 'support': 1364606}}
[[173727  98732  27128]
 [166306 515222  79242]
 [ 60331 137679 106239]]
Evaluating performance on  train set...
2013/2013 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7113307
{'0': {'precision': 0.37110205793367884, 'recall': 0.3700103041978406, 'f1-score': 0.37055537691899293, 'support': 66963}, '1': {'precision': 0.8304270180062463, 'recall': 0.7785898628104527, 'f1-score': 0.803673430319012, 'support': 382828}, '2': {'precision': 0.3801707303464822, 'recall': 0.5199706964179424, 'f1-score': 0.4392146245874588, 'support': 65521}, 'accuracy': 0.6926134070233179, 'macro avg': {'precision': 0.5272332687621358, 'recall': 0.5561902878087452, 'f1-score': 0.5378144772751546, 'support': 515312}, 'weighted avg': {'precision': 0.7134900564662574, 'recall': 0.6926134070233179, 'f1-score': 0.7010509615619045, 'support': 515312}}
[[ 24777  34273   7913]
 [ 37129 298066  47633]
 [  4860  26592  34069]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7928694
{'0': {'precision': 0.42582751692047377, 'recall': 0.36423563998190867, 'f1-score': 0.3926307834820341, 'support': 88440}, '1': {'precision': 0.7599970436067996, 'recall': 0.7555408602624579, 'f1-score': 0.7577624006072263, 'support': 340245}, '2': {'precision': 0.4273966119076262, 'recall': 0.5003520842231637, 'f1-score': 0.46100584447008897, 'support': 86627}, 'accuracy': 0.6454846772440773, 'macro avg': {'precision': 0.5377403908116333, 'recall': 0.5400428614891768, 'f1-score': 0.5371330095197832, 'support': 515312}, 'weighted avg': {'precision': 0.6467333692950371, 'recall': 0.6454846772440773, 'f1-score': 0.6452104507068868, 'support': 515312}}
[[ 32213  44536  11691]
 [ 36797 257069  46379]
 [  6638  36645  43344]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8566873
{'0': {'precision': 0.4500740882367, 'recall': 0.3589680051085081, 'f1-score': 0.399391326939085, 'support': 104923}, '1': {'precision': 0.6994563307875806, 'recall': 0.7378134814073096, 'f1-score': 0.7181230777019758, 'support': 307594}, '2': {'precision': 0.45505104230819476, 'recall': 0.47440050586118004, 'f1-score': 0.46452436404856146, 'support': 102795}, 'accuracy': 0.6081306082528642, 'macro avg': {'precision': 0.5348604871108251, 'recall': 0.5237273307923326, 'f1-score': 0.5273462562298741, 'support': 515312}, 'weighted avg': {'precision': 0.5999252221302923, 'recall': 0.6081306082528642, 'f1-score': 0.602637757633168, 'support': 515312}}
[[ 37664  52155  15104]
 [ 37351 226947  43296]
 [  8669  45360  48766]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.93873274
{'0': {'precision': 0.47845155127119565, 'recall': 0.3384891865323175, 'f1-score': 0.3964808434461107, 'support': 130208}, '1': {'precision': 0.5944502496226635, 'recall': 0.7152280876030236, 'f1-score': 0.6492701347010089, 'support': 257708}, '2': {'precision': 0.48069409331188234, 'recall': 0.4268501365819963, 'f1-score': 0.4521748530279974, 'support': 127396}, 'accuracy': 0.5487413450492129, 'macro avg': {'precision': 0.5178652980685805, 'recall': 0.4935224702391125, 'f1-score': 0.4993086103917057, 'support': 515312}, 'weighted avg': {'precision': 0.5370170095577781, 'recall': 0.5487413450492129, 'f1-score': 0.5366697323433445, 'support': 515312}}
[[ 44074  65222  20912]
 [ 35553 184320  37835]
 [ 12491  60526  54379]]
Evaluating performance on  val set...
696/696 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6542071
{'0': {'precision': 0.3823581770709708, 'recall': 0.5998417426922361, 'f1-score': 0.46702181633688483, 'support': 21484}, '1': {'precision': 0.8866442103086745, 'recall': 0.7587490692479524, 'f1-score': 0.8177260448116955, 'support': 135643}, '2': {'precision': 0.4050731845957084, 'recall': 0.5481203730410538, 'f1-score': 0.46586312563840654, 'support': 20802}, 'accuracy': 0.7149368568361537, 'macro avg': {'precision': 0.5580251906584511, 'recall': 0.6355703949937473, 'f1-score': 0.5835369955956623, 'support': 177929}, 'weighted avg': {'precision': 0.7694529620300918, 'recall': 0.7149368568361537, 'f1-score': 0.7342434079779271, 'support': 177929}}
[[ 12887   6357   2240]
 [ 18218 102919  14506]
 [  2599   6801  11402]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.73223406
{'0': {'precision': 0.43106382978723407, 'recall': 0.568342801037941, 'f1-score': 0.4902749629450377, 'support': 28518}, '1': {'precision': 0.8224825990339939, 'recall': 0.7374019280956968, 'f1-score': 0.7776219890697099, 'support': 121467}, '2': {'precision': 0.456613739777898, 'recall': 0.5135270541082164, 'f1-score': 0.48340098701386197, 'support': 27944}, 'accuracy': 0.6751457041853773, 'macro avg': {'precision': 0.570053389533042, 'recall': 0.6064239277472847, 'f1-score': 0.5837659796762033, 'support': 177929}, 'weighted avg': {'precision': 0.7022867913554737, 'recall': 0.6751457041853773, 'f1-score': 0.6853589281157787, 'support': 177929}}
[[16208  9260  3050]
 [17870 89570 14027]
 [ 3522 10072 14350]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7996859
{'0': {'precision': 0.4527614514013698, 'recall': 0.5467182825972198, 'f1-score': 0.4953236263152301, 'support': 34098}, '1': {'precision': 0.7634048970043789, 'recall': 0.7159369050856677, 'f1-score': 0.738909342677102, 'support': 110310}, '2': {'precision': 0.4873588758107134, 'recall': 0.4842039318636079, 'f1-score': 0.4857762813318369, 'support': 33521}, 'accuracy': 0.6398507269753666, 'macro avg': {'precision': 0.5678417414054874, 'recall': 0.5822863731821651, 'f1-score': 0.573336416774723, 'support': 177929}, 'weighted avg': {'precision': 0.6518679419009147, 'recall': 0.6398507269753666, 'f1-score': 0.6445399082068259, 'support': 177929}}
[[18642 11605  3851]
 [18113 78975 13222]
 [ 4419 12871 16231]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8901137
{'0': {'precision': 0.4787293001396617, 'recall': 0.5040614350403809, 'f1-score': 0.49106889063228387, 'support': 42842}, '1': {'precision': 0.6558689141256683, 'recall': 0.6899544066411458, 'f1-score': 0.672480020961614, 'support': 92996}, '2': {'precision': 0.5140464690920522, 'recall': 0.4273360100734124, 'f1-score': 0.4666978023403648, 'support': 42091}, 'accuracy': 0.5830696513777968, 'macro avg': {'precision': 0.549548227785794, 'recall': 0.5404506172516464, 'f1-score': 0.5434155713114208, 'support': 177929}, 'weighted avg': {'precision': 0.5796673737567659, 'recall': 0.5830696513777968, 'f1-score': 0.5801196131047938, 'support': 177929}}
[[21595 15866  5381]
 [17210 64163 11623]
 [ 6304 17800 17987]]
training model: results/AAL/W7/deepOF_L1/seq2seq
Epoch 1/50
2013/2013 - 52s - loss: 12.4503 - accuracy10: 0.4094 - accuracy20: 0.4246 - accuracy30: 0.4314 - accuracy50: 0.4343 - val_loss: 12.7805 - val_accuracy10: 0.6849 - val_accuracy20: 0.6287 - val_accuracy30: 0.5834 - val_accuracy50: 0.5127 - 52s/epoch - 26ms/step
Epoch 2/50
2013/2013 - 49s - loss: 12.2847 - accuracy10: 0.3980 - accuracy20: 0.4178 - accuracy30: 0.4293 - accuracy50: 0.4372 - val_loss: 12.2566 - val_accuracy10: 0.6969 - val_accuracy20: 0.6474 - val_accuracy30: 0.6048 - val_accuracy50: 0.5309 - 49s/epoch - 24ms/step
Epoch 3/50
2013/2013 - 49s - loss: 12.1630 - accuracy10: 0.4361 - accuracy20: 0.4482 - accuracy30: 0.4558 - accuracy50: 0.4580 - val_loss: 12.0097 - val_accuracy10: 0.6802 - val_accuracy20: 0.6342 - val_accuracy30: 0.5979 - val_accuracy50: 0.5315 - 49s/epoch - 24ms/step
Epoch 4/50
2013/2013 - 46s - loss: 12.0550 - accuracy10: 0.4576 - accuracy20: 0.4626 - accuracy30: 0.4663 - accuracy50: 0.4647 - val_loss: 11.9339 - val_accuracy10: 0.6708 - val_accuracy20: 0.6260 - val_accuracy30: 0.5914 - val_accuracy50: 0.5295 - 46s/epoch - 23ms/step
Epoch 5/50
2013/2013 - 50s - loss: 11.9801 - accuracy10: 0.4724 - accuracy20: 0.4726 - accuracy30: 0.4738 - accuracy50: 0.4703 - val_loss: 11.8651 - val_accuracy10: 0.6704 - val_accuracy20: 0.6243 - val_accuracy30: 0.5886 - val_accuracy50: 0.5286 - 50s/epoch - 25ms/step
Epoch 6/50
2013/2013 - 50s - loss: 11.9079 - accuracy10: 0.4815 - accuracy20: 0.4792 - accuracy30: 0.4788 - accuracy50: 0.4737 - val_loss: 11.7896 - val_accuracy10: 0.6647 - val_accuracy20: 0.6199 - val_accuracy30: 0.5850 - val_accuracy50: 0.5275 - 50s/epoch - 25ms/step
Epoch 7/50
2013/2013 - 51s - loss: 11.8414 - accuracy10: 0.4923 - accuracy20: 0.4874 - accuracy30: 0.4846 - accuracy50: 0.4773 - val_loss: 11.7792 - val_accuracy10: 0.6709 - val_accuracy20: 0.6239 - val_accuracy30: 0.5882 - val_accuracy50: 0.5294 - 51s/epoch - 25ms/step
Epoch 8/50
2013/2013 - 51s - loss: 11.7810 - accuracy10: 0.4982 - accuracy20: 0.4925 - accuracy30: 0.4882 - accuracy50: 0.4793 - val_loss: 11.7197 - val_accuracy10: 0.6624 - val_accuracy20: 0.6171 - val_accuracy30: 0.5827 - val_accuracy50: 0.5276 - 51s/epoch - 25ms/step
Epoch 9/50
2013/2013 - 49s - loss: 11.6949 - accuracy10: 0.5075 - accuracy20: 0.5011 - accuracy30: 0.4952 - accuracy50: 0.4844 - val_loss: 11.7258 - val_accuracy10: 0.6669 - val_accuracy20: 0.6187 - val_accuracy30: 0.5819 - val_accuracy50: 0.5264 - 49s/epoch - 24ms/step
Epoch 10/50
2013/2013 - 48s - loss: 11.6213 - accuracy10: 0.5111 - accuracy20: 0.5058 - accuracy30: 0.4982 - accuracy50: 0.4870 - val_loss: 11.6821 - val_accuracy10: 0.6628 - val_accuracy20: 0.6173 - val_accuracy30: 0.5814 - val_accuracy50: 0.5276 - 48s/epoch - 24ms/step
Epoch 11/50
2013/2013 - 47s - loss: 11.5604 - accuracy10: 0.5145 - accuracy20: 0.5093 - accuracy30: 0.5020 - accuracy50: 0.4901 - val_loss: 11.5954 - val_accuracy10: 0.6457 - val_accuracy20: 0.6031 - val_accuracy30: 0.5690 - val_accuracy50: 0.5214 - 47s/epoch - 23ms/step
Epoch 12/50
2013/2013 - 46s - loss: 11.5081 - accuracy10: 0.5187 - accuracy20: 0.5132 - accuracy30: 0.5045 - accuracy50: 0.4917 - val_loss: 11.5934 - val_accuracy10: 0.6530 - val_accuracy20: 0.6079 - val_accuracy30: 0.5726 - val_accuracy50: 0.5233 - 46s/epoch - 23ms/step
Epoch 13/50
2013/2013 - 46s - loss: 11.4483 - accuracy10: 0.5224 - accuracy20: 0.5159 - accuracy30: 0.5065 - accuracy50: 0.4938 - val_loss: 11.5482 - val_accuracy10: 0.6434 - val_accuracy20: 0.6018 - val_accuracy30: 0.5683 - val_accuracy50: 0.5219 - 46s/epoch - 23ms/step
Epoch 14/50
2013/2013 - 47s - loss: 11.3948 - accuracy10: 0.5235 - accuracy20: 0.5178 - accuracy30: 0.5092 - accuracy50: 0.4968 - val_loss: 11.5256 - val_accuracy10: 0.6381 - val_accuracy20: 0.5981 - val_accuracy30: 0.5651 - val_accuracy50: 0.5207 - 47s/epoch - 24ms/step
Epoch 15/50
2013/2013 - 46s - loss: 11.3504 - accuracy10: 0.5276 - accuracy20: 0.5203 - accuracy30: 0.5111 - accuracy50: 0.4984 - val_loss: 11.5103 - val_accuracy10: 0.6343 - val_accuracy20: 0.5953 - val_accuracy30: 0.5641 - val_accuracy50: 0.5198 - 46s/epoch - 23ms/step
Epoch 16/50
2013/2013 - 47s - loss: 11.3010 - accuracy10: 0.5298 - accuracy20: 0.5230 - accuracy30: 0.5144 - accuracy50: 0.5016 - val_loss: 11.4888 - val_accuracy10: 0.6244 - val_accuracy20: 0.5854 - val_accuracy30: 0.5540 - val_accuracy50: 0.5132 - 47s/epoch - 24ms/step
Epoch 17/50
2013/2013 - 48s - loss: 11.2694 - accuracy10: 0.5307 - accuracy20: 0.5244 - accuracy30: 0.5155 - accuracy50: 0.5029 - val_loss: 11.4728 - val_accuracy10: 0.6203 - val_accuracy20: 0.5833 - val_accuracy30: 0.5529 - val_accuracy50: 0.5121 - 48s/epoch - 24ms/step
Epoch 18/50
2013/2013 - 47s - loss: 11.2321 - accuracy10: 0.5328 - accuracy20: 0.5265 - accuracy30: 0.5170 - accuracy50: 0.5043 - val_loss: 11.4965 - val_accuracy10: 0.6203 - val_accuracy20: 0.5813 - val_accuracy30: 0.5502 - val_accuracy50: 0.5113 - 47s/epoch - 23ms/step
Epoch 19/50
2013/2013 - 48s - loss: 11.2003 - accuracy10: 0.5345 - accuracy20: 0.5278 - accuracy30: 0.5191 - accuracy50: 0.5065 - val_loss: 11.4958 - val_accuracy10: 0.6254 - val_accuracy20: 0.5848 - val_accuracy30: 0.5537 - val_accuracy50: 0.5145 - 48s/epoch - 24ms/step
Epoch 20/50
2013/2013 - 49s - loss: 11.1675 - accuracy10: 0.5358 - accuracy20: 0.5300 - accuracy30: 0.5207 - accuracy50: 0.5079 - val_loss: 11.5065 - val_accuracy10: 0.6202 - val_accuracy20: 0.5818 - val_accuracy30: 0.5518 - val_accuracy50: 0.5129 - 49s/epoch - 24ms/step
Epoch 21/50
2013/2013 - 47s - loss: 11.1293 - accuracy10: 0.5384 - accuracy20: 0.5319 - accuracy30: 0.5231 - accuracy50: 0.5101 - val_loss: 11.5187 - val_accuracy10: 0.6170 - val_accuracy20: 0.5778 - val_accuracy30: 0.5495 - val_accuracy50: 0.5102 - 47s/epoch - 23ms/step
Epoch 22/50
2013/2013 - 47s - loss: 11.0997 - accuracy10: 0.5394 - accuracy20: 0.5335 - accuracy30: 0.5247 - accuracy50: 0.5120 - val_loss: 11.5196 - val_accuracy10: 0.6050 - val_accuracy20: 0.5673 - val_accuracy30: 0.5402 - val_accuracy50: 0.5045 - 47s/epoch - 24ms/step
Epoch 23/50
2013/2013 - 46s - loss: 11.0712 - accuracy10: 0.5404 - accuracy20: 0.5344 - accuracy30: 0.5256 - accuracy50: 0.5128 - val_loss: 11.4899 - val_accuracy10: 0.6214 - val_accuracy20: 0.5801 - val_accuracy30: 0.5516 - val_accuracy50: 0.5127 - 46s/epoch - 23ms/step
Epoch 24/50
2013/2013 - 46s - loss: 11.0433 - accuracy10: 0.5434 - accuracy20: 0.5367 - accuracy30: 0.5274 - accuracy50: 0.5135 - val_loss: 11.5253 - val_accuracy10: 0.6194 - val_accuracy20: 0.5794 - val_accuracy30: 0.5498 - val_accuracy50: 0.5112 - 46s/epoch - 23ms/step
Epoch 25/50
2013/2013 - 48s - loss: 11.0126 - accuracy10: 0.5442 - accuracy20: 0.5380 - accuracy30: 0.5289 - accuracy50: 0.5161 - val_loss: 11.5388 - val_accuracy10: 0.6165 - val_accuracy20: 0.5767 - val_accuracy30: 0.5469 - val_accuracy50: 0.5085 - 48s/epoch - 24ms/step
Epoch 26/50
2013/2013 - 50s - loss: 10.9859 - accuracy10: 0.5458 - accuracy20: 0.5401 - accuracy30: 0.5306 - accuracy50: 0.5176 - val_loss: 11.5636 - val_accuracy10: 0.6037 - val_accuracy20: 0.5635 - val_accuracy30: 0.5368 - val_accuracy50: 0.5023 - 50s/epoch - 25ms/step
Epoch 27/50
2013/2013 - 51s - loss: 10.9565 - accuracy10: 0.5469 - accuracy20: 0.5406 - accuracy30: 0.5313 - accuracy50: 0.5182 - val_loss: 11.5165 - val_accuracy10: 0.6065 - val_accuracy20: 0.5685 - val_accuracy30: 0.5417 - val_accuracy50: 0.5062 - 51s/epoch - 25ms/step
testing model: results/AAL/W7/deepOF_L1/seq2seq
Evaluating performance on  test set...
5331/5331 - 51s - 51s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8065075
{'0': {'precision': 0.264208424578127, 'recall': 0.562131718146189, 'f1-score': 0.3594644093342797, 'support': 145948}, '1': {'precision': 0.8726865803196444, 'recall': 0.6843005325557633, 'f1-score': 0.7670967687897463, 'support': 1070686}, '2': {'precision': 0.2973946849521963, 'recall': 0.4311637054208033, 'f1-score': 0.35199867582554, 'support': 147967}, 'accuracy': 0.6437859857936495, 'macro avg': {'precision': 0.47809656328332256, 'recall': 0.5591986520409186, 'f1-score': 0.4928532846498553, 'support': 1364601}, 'weighted avg': {'precision': 0.7452277951099032, 'recall': 0.6437859857936495, 'f1-score': 0.6784892218808395, 'support': 1364601}}
[[ 82042  46802  17104]
 [204394 732671 133621]
 [ 24084  60085  63798]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.86059725
{'0': {'precision': 0.3162519147952253, 'recall': 0.5525676569656753, 'f1-score': 0.4022712776028426, 'support': 198021}, '1': {'precision': 0.8141452970658362, 'recall': 0.6581735855619346, 'f1-score': 0.7278979243706137, 'support': 966002}, '2': {'precision': 0.3481548177538046, 'recall': 0.41254275144831437, 'f1-score': 0.37762378180540374, 'support': 200578}, 'accuracy': 0.6067443890192078, 'macro avg': {'precision': 0.4928506765382887, 'recall': 0.5410946646586415, 'f1-score': 0.50259766125962, 'support': 1364601}, 'weighted avg': {'precision': 0.6734002852931221, 'recall': 0.6067443890192078, 'f1-score': 0.6291597575459921, 'support': 1364601}}
[[109420  63949  24652]
 [199931 635797 130274]
 [ 36639  81192  82747]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.90719026
{'0': {'precision': 0.3463413455601669, 'recall': 0.5416148911875336, 'f1-score': 0.42250647594159046, 'support': 238208}, '1': {'precision': 0.7618169641525652, 'recall': 0.6351252989497764, 'f1-score': 0.6927261632529786, 'support': 884764}, '2': {'precision': 0.37832909561779604, 'recall': 0.3984207193672945, 'f1-score': 0.38811505976738087, 'support': 241629}, 'accuracy': 0.5768887755468448, 'macro avg': {'precision': 0.4954958017768427, 'recall': 0.5250536365015348, 'f1-score': 0.5011158996539833, 'support': 1364601}, 'weighted avg': {'precision': 0.6213866066049408, 'recall': 0.5768887755468448, 'f1-score': 0.5916186837778847, 'support': 1364601}}
[[129017  78195  30996]
 [195633 561936 127195]
 [ 47864  97495  96270]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9626466
{'0': {'precision': 0.3877649201702075, 'recall': 0.5031109597911785, 'f1-score': 0.43797073318145885, 'support': 299586}, '1': {'precision': 0.6663592920105946, 'recall': 0.6250167593359359, 'f1-score': 0.6450262490334657, 'support': 760770}, '2': {'precision': 0.41677435586610706, 'recall': 0.3593551249815116, 'f1-score': 0.3859407597242373, 'support': 304245}, 'accuracy': 0.5390227619648528, 'macro avg': {'precision': 0.49029952268230304, 'recall': 0.49582761470287534, 'f1-score': 0.4896459139797206, 'support': 1364601}, 'weighted avg': {'precision': 0.5495500984225393, 'recall': 0.5390227619648528, 'f1-score': 0.5418045758360069, 'support': 1364601}}
[[150725 108167  40694]
 [172973 475494 112303]
 [ 65004 129909 109332]]
Evaluating performance on  train set...
2013/2013 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8580871
{'0': {'precision': 0.28907687568170654, 'recall': 0.51833328356872, 'f1-score': 0.371157495256167, 'support': 66982}, '1': {'precision': 0.8374613161899226, 'recall': 0.6396672412892441, 'f1-score': 0.7253215261478317, 'support': 382860}, '2': {'precision': 0.2989335616704939, 'recall': 0.46926742836194785, 'f1-score': 0.3652163575844032, 'support': 65468}, 'accuracy': 0.6022471910112359, 'macro avg': {'precision': 0.4751572511807076, 'recall': 0.542422651073304, 'f1-score': 0.487231792996134, 'support': 515310}, 'weighted avg': {'precision': 0.6977624521527425, 'recall': 0.6022471910112359, 'f1-score': 0.6335360372330114, 'support': 515310}}
[[ 34719  23133   9130]
 [ 75037 244903  62920]
 [ 10347  24399  30722]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.90543896
{'0': {'precision': 0.34188397053456376, 'recall': 0.5191011490093187, 'f1-score': 0.412254190935096, 'support': 88424}, '1': {'precision': 0.7700151900996292, 'recall': 0.6078899336039338, 'f1-score': 0.679414677732755, 'support': 340231}, '2': {'precision': 0.3536525721399671, 'recall': 0.4589463966303156, 'f1-score': 0.3994776756566722, 'support': 86655}, 'accuracy': 0.5676078477033242, 'macro avg': {'precision': 0.48851724425805326, 'recall': 0.5286458264145227, 'f1-score': 0.49704884810817446, 'support': 515310}, 'weighted avg': {'precision': 0.6265346102193321, 'recall': 0.5676078477033242, 'f1-score': 0.5864971333429719, 'support': 515310}}
[[ 45901  30059  12464]
 [ 73187 206823  60221]
 [ 15171  31714  39770]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9437935
{'0': {'precision': 0.3724892062552075, 'recall': 0.5156819005128792, 'f1-score': 0.43254264935771086, 'support': 104898}, '1': {'precision': 0.7119473917328726, 'recall': 0.5800263324718389, 'f1-score': 0.6392517538139633, 'support': 307605}, '2': {'precision': 0.3853448275862069, 'recall': 0.4478391549213575, 'f1-score': 0.4142482466361056, 'support': 102807}, 'accuracy': 0.5405561700723837, 'macro avg': {'precision': 0.4899271418580957, 'recall': 0.5145157959686918, 'f1-score': 0.4953475499359266, 'support': 515310}, 'weighted avg': {'precision': 0.5776874034685998, 'recall': 0.5405561700723837, 'f1-score': 0.5522840892980679, 'support': 515310}}
[[ 54094  35254  15550]
 [ 71297 178419  57889]
 [ 19832  36934  46041]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.99103713
{'0': {'precision': 0.4146483785945634, 'recall': 0.4858903341297951, 'f1-score': 0.4474513674424528, 'support': 130159}, '1': {'precision': 0.6053216924781526, 'recall': 0.5638448943484368, 'f1-score': 0.583847587825025, 'support': 257734}, '2': {'precision': 0.4257867887934547, 'recall': 0.41007086966417355, 'f1-score': 0.41778108271265857, 'support': 127417}, 'accuracy': 0.5061322310842017, 'macro avg': {'precision': 0.4819189532887236, 'recall': 0.48660203271413516, 'f1-score': 0.4830266793267121, 'support': 515310}, 'weighted avg': {'precision': 0.5127683814914316, 'recall': 0.5061322310842017, 'f1-score': 0.5083340299071161, 'support': 515310}}
[[ 63243  46227  20689]
 [ 62637 145322  49775]
 [ 26642  48525  52250]]
Evaluating performance on  val set...
696/696 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8322885
{'0': {'precision': 0.2792501458860144, 'recall': 0.5340866815476191, 'f1-score': 0.3667454336441435, 'support': 21504}, '1': {'precision': 0.8508987431823571, 'recall': 0.6618561721153633, 'f1-score': 0.7445655331546052, 'support': 135537}, '2': {'precision': 0.297233554309026, 'recall': 0.4464764458062045, 'f1-score': 0.356880453084341, 'support': 20888}, 'accuracy': 0.6211297764838783, 'macro avg': {'precision': 0.47579414779246587, 'recall': 0.5474730998230622, 'f1-score': 0.4893971399610299, 'support': 177929}, 'weighted avg': {'precision': 0.7168132939219966, 'recall': 0.6211297764838783, 'f1-score': 0.6533909108480634, 'support': 177929}}
[[11485  7494  2525]
 [26306 89706 19525]
 [ 3337  8225  9326]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8842924
{'0': {'precision': 0.3281709942445411, 'recall': 0.523697679310103, 'f1-score': 0.40349503025064826, 'support': 28526}, '1': {'precision': 0.7842496103657978, 'recall': 0.634285996753969, 'f1-score': 0.7013409368338587, 'support': 121379}, '2': {'precision': 0.3517728839301361, 'recall': 0.4297744790179846, 'f1-score': 0.3868812437763002, 'support': 28024}, 'accuracy': 0.584345441159114, 'macro avg': {'precision': 0.48806449618015835, 'recall': 0.5292527183606855, 'f1-score': 0.49723907028693565, 'support': 177929}, 'weighted avg': {'precision': 0.6430144750865125, 'recall': 0.584345441159114, 'f1-score': 0.6040618492796225, 'support': 177929}}
[[14939 10044  3543]
 [25739 76989 18651]
 [ 4844 11136 12044]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.92862517
{'0': {'precision': 0.3572097568921285, 'recall': 0.5146981165287802, 'f1-score': 0.4217307692307693, 'support': 34086}, '1': {'precision': 0.7258787603144695, 'recall': 0.6079503713982533, 'f1-score': 0.6617013400459022, 'support': 110259}, '2': {'precision': 0.38388768543146234, 'recall': 0.4168651738923297, 'f1-score': 0.39969737198977917, 'support': 33584}, 'accuracy': 0.5540187378111494, 'macro avg': {'precision': 0.48899206754602015, 'recall': 0.5131712206064544, 'f1-score': 0.49437649375548354, 'support': 177929}, 'weighted avg': {'precision': 0.5907019206226551, 'recall': 0.5540187378111494, 'f1-score': 0.5662768834367972, 'support': 177929}}
[[17544 12082  4460]
 [25218 67032 18009]
 [ 6352 13232 14000]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9845537
{'0': {'precision': 0.3976158580387132, 'recall': 0.47793517070780145, 'f1-score': 0.4340914389876852, 'support': 42851}, '1': {'precision': 0.6191582752388329, 'recall': 0.5934366257800732, 'f1-score': 0.6060246457787374, 'support': 92940}, '2': {'precision': 0.42198002302975124, 'recall': 0.37396174474346194, 'f1-score': 0.3965224393251217, 'support': 42138}, 'accuracy': 0.5136430823530734, 'macro avg': {'precision': 0.47958471876909914, 'recall': 0.4817778470771122, 'f1-score': 0.47887950803051477, 'support': 177929}, 'weighted avg': {'precision': 0.5191070676727328, 'recall': 0.5136430823530734, 'f1-score': 0.515002306420084, 'support': 177929}}
[[20480 16401  5970]
 [22171 55154 15615]
 [ 8856 17524 15758]]
training model: results/AAL/W7/deepLOB_L2/seq2seq
Epoch 1/50
2013/2013 - 103s - loss: 11.7751 - accuracy10: 0.4466 - accuracy20: 0.4615 - accuracy30: 0.4686 - accuracy50: 0.4705 - val_loss: 16.3132 - val_accuracy10: 0.1289 - val_accuracy20: 0.1667 - val_accuracy30: 0.1973 - val_accuracy50: 0.2452 - 103s/epoch - 51ms/step
Epoch 2/50
2013/2013 - 95s - loss: 11.2621 - accuracy10: 0.4799 - accuracy20: 0.4960 - accuracy30: 0.5024 - accuracy50: 0.5009 - val_loss: 11.6976 - val_accuracy10: 0.6893 - val_accuracy20: 0.6537 - val_accuracy30: 0.6204 - val_accuracy50: 0.5606 - 95s/epoch - 47ms/step
Epoch 3/50
2013/2013 - 94s - loss: 10.5722 - accuracy10: 0.5744 - accuracy20: 0.5701 - accuracy30: 0.5593 - accuracy50: 0.5380 - val_loss: 10.7105 - val_accuracy10: 0.6964 - val_accuracy20: 0.6601 - val_accuracy30: 0.6259 - val_accuracy50: 0.5701 - 94s/epoch - 47ms/step
Epoch 4/50
2013/2013 - 95s - loss: 10.0936 - accuracy10: 0.6245 - accuracy20: 0.6082 - accuracy30: 0.5879 - accuracy50: 0.5565 - val_loss: 10.2456 - val_accuracy10: 0.6876 - val_accuracy20: 0.6572 - val_accuracy30: 0.6264 - val_accuracy50: 0.5739 - 95s/epoch - 47ms/step
Epoch 5/50
2013/2013 - 95s - loss: 9.8456 - accuracy10: 0.6447 - accuracy20: 0.6231 - accuracy30: 0.6008 - accuracy50: 0.5665 - val_loss: 9.9033 - val_accuracy10: 0.5944 - val_accuracy20: 0.5840 - val_accuracy30: 0.5687 - val_accuracy50: 0.5431 - 95s/epoch - 47ms/step
Epoch 6/50
2013/2013 - 95s - loss: 9.7029 - accuracy10: 0.6523 - accuracy20: 0.6275 - accuracy30: 0.6048 - accuracy50: 0.5717 - val_loss: 9.6918 - val_accuracy10: 0.6838 - val_accuracy20: 0.6598 - val_accuracy30: 0.6333 - val_accuracy50: 0.5879 - 95s/epoch - 47ms/step
Epoch 7/50
2013/2013 - 95s - loss: 9.5966 - accuracy10: 0.6568 - accuracy20: 0.6314 - accuracy30: 0.6088 - accuracy50: 0.5750 - val_loss: 9.8544 - val_accuracy10: 0.6169 - val_accuracy20: 0.6050 - val_accuracy30: 0.5884 - val_accuracy50: 0.5589 - 95s/epoch - 47ms/step
Epoch 8/50
2013/2013 - 95s - loss: 9.5186 - accuracy10: 0.6598 - accuracy20: 0.6354 - accuracy30: 0.6121 - accuracy50: 0.5777 - val_loss: 9.6168 - val_accuracy10: 0.6813 - val_accuracy20: 0.6564 - val_accuracy30: 0.6293 - val_accuracy50: 0.5856 - 95s/epoch - 47ms/step
Epoch 9/50
2013/2013 - 95s - loss: 9.4650 - accuracy10: 0.6615 - accuracy20: 0.6364 - accuracy30: 0.6134 - accuracy50: 0.5797 - val_loss: 9.9229 - val_accuracy10: 0.5993 - val_accuracy20: 0.5840 - val_accuracy30: 0.5669 - val_accuracy50: 0.5421 - 95s/epoch - 47ms/step
Epoch 10/50
2013/2013 - 94s - loss: 9.4240 - accuracy10: 0.6620 - accuracy20: 0.6375 - accuracy30: 0.6144 - accuracy50: 0.5808 - val_loss: 9.6460 - val_accuracy10: 0.6917 - val_accuracy20: 0.6664 - val_accuracy30: 0.6388 - val_accuracy50: 0.5931 - 94s/epoch - 47ms/step
Epoch 11/50
2013/2013 - 94s - loss: 9.3822 - accuracy10: 0.6635 - accuracy20: 0.6392 - accuracy30: 0.6152 - accuracy50: 0.5818 - val_loss: 9.8781 - val_accuracy10: 0.7066 - val_accuracy20: 0.6786 - val_accuracy30: 0.6466 - val_accuracy50: 0.5957 - 94s/epoch - 47ms/step
Epoch 12/50
2013/2013 - 95s - loss: 9.3466 - accuracy10: 0.6646 - accuracy20: 0.6405 - accuracy30: 0.6169 - accuracy50: 0.5831 - val_loss: 9.9391 - val_accuracy10: 0.7005 - val_accuracy20: 0.6712 - val_accuracy30: 0.6399 - val_accuracy50: 0.5906 - 95s/epoch - 47ms/step
Epoch 13/50
2013/2013 - 95s - loss: 9.3159 - accuracy10: 0.6651 - accuracy20: 0.6412 - accuracy30: 0.6175 - accuracy50: 0.5834 - val_loss: 9.9371 - val_accuracy10: 0.6802 - val_accuracy20: 0.6546 - val_accuracy30: 0.6271 - val_accuracy50: 0.5827 - 95s/epoch - 47ms/step
Epoch 14/50
2013/2013 - 94s - loss: 9.2865 - accuracy10: 0.6656 - accuracy20: 0.6419 - accuracy30: 0.6180 - accuracy50: 0.5839 - val_loss: 9.7287 - val_accuracy10: 0.6946 - val_accuracy20: 0.6699 - val_accuracy30: 0.6417 - val_accuracy50: 0.5940 - 94s/epoch - 47ms/step
Epoch 15/50
2013/2013 - 94s - loss: 9.2602 - accuracy10: 0.6665 - accuracy20: 0.6431 - accuracy30: 0.6197 - accuracy50: 0.5853 - val_loss: 9.7204 - val_accuracy10: 0.5918 - val_accuracy20: 0.5750 - val_accuracy30: 0.5556 - val_accuracy50: 0.5322 - 94s/epoch - 47ms/step
Epoch 16/50
2013/2013 - 94s - loss: 9.2315 - accuracy10: 0.6671 - accuracy20: 0.6439 - accuracy30: 0.6198 - accuracy50: 0.5855 - val_loss: 9.7429 - val_accuracy10: 0.6195 - val_accuracy20: 0.6007 - val_accuracy30: 0.5808 - val_accuracy50: 0.5517 - 94s/epoch - 47ms/step
Epoch 17/50
2013/2013 - 95s - loss: 9.2074 - accuracy10: 0.6679 - accuracy20: 0.6449 - accuracy30: 0.6213 - accuracy50: 0.5868 - val_loss: 9.6637 - val_accuracy10: 0.6643 - val_accuracy20: 0.6401 - val_accuracy30: 0.6151 - val_accuracy50: 0.5752 - 95s/epoch - 47ms/step
Epoch 18/50
2013/2013 - 95s - loss: 9.1825 - accuracy10: 0.6683 - accuracy20: 0.6457 - accuracy30: 0.6219 - accuracy50: 0.5871 - val_loss: 9.6804 - val_accuracy10: 0.6231 - val_accuracy20: 0.6040 - val_accuracy30: 0.5832 - val_accuracy50: 0.5517 - 95s/epoch - 47ms/step
testing model: results/AAL/W7/deepLOB_L2/seq2seq
Evaluating performance on  test set...
5331/5331 - 87s - 87s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7392106
{'0': {'precision': 0.27111404865982686, 'recall': 0.7419765944034862, 'f1-score': 0.39712197501164337, 'support': 145948}, '1': {'precision': 0.9096986965747196, 'recall': 0.7007387759295408, 'f1-score': 0.7916620942894526, 'support': 1070690}, '2': {'precision': 0.4523748486790572, 'recall': 0.4293293144463668, 'f1-score': 0.44055090534608427, 'support': 147968}, 'accuracy': 0.6757195849937637, 'macro avg': {'precision': 0.5443958646378678, 'recall': 0.6240148949264647, 'f1-score': 0.5431116582157268, 'support': 1364606}, 'weighted avg': {'precision': 0.7918115941295389, 'recall': 0.6757195849937637, 'f1-score': 0.7113930922962545, 'support': 1364606}}
[[108290  20509  17149]
 [260662 750274  59754]
 [ 30474  53967  63527]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.78051907
{'0': {'precision': 0.33439938655183216, 'recall': 0.7223338820939088, 'f1-score': 0.45715984198616744, 'support': 198022}, '1': {'precision': 0.8556262946458585, 'recall': 0.698265947414242, 'f1-score': 0.7689782973256131, 'support': 966003}, '2': {'precision': 0.5093086986674926, 'recall': 0.37710949691147216, 'f1-score': 0.4333510933892489, 'support': 200581}, 'accuracy': 0.6545523030090736, 'macro avg': {'precision': 0.5664447932883944, 'recall': 0.5992364421398743, 'f1-score': 0.5531630775670098, 'support': 1364606}, 'weighted avg': {'precision': 0.7290849160255595, 'recall': 0.6545523030090736, 'f1-score': 0.6743961583375186, 'support': 1364606}}
[[143038  35637  19347]
 [237947 674527  53529]
 [ 46761  78179  75641]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8225721
{'0': {'precision': 0.3716861825134155, 'recall': 0.7010482391513335, 'f1-score': 0.4858051322032518, 'support': 238209}, '1': {'precision': 0.8039554886303619, 'recall': 0.6933490813944946, 'f1-score': 0.744567018204813, 'support': 884765}, '2': {'precision': 0.5363100241672796, 'recall': 0.3379726195205933, 'f1-score': 0.41464417726146474, 'support': 241632}, 'accuracy': 0.631766238753164, 'macro avg': {'precision': 0.5706505651036856, 'recall': 0.5774566466888071, 'f1-score': 0.5483387758898431, 'support': 1364606}, 'weighted avg': {'precision': 0.681105268119859, 'recall': 0.631766238753164, 'f1-score': 0.6409771717543584, 'support': 1364606}}
[[166996  50736  20477]
 [221184 613451  50130]
 [ 61113  98854  81665]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.88711
{'0': {'precision': 0.41331566899417804, 'recall': 0.646683601090835, 'f1-score': 0.5043106589893901, 'support': 299587}, '1': {'precision': 0.711710185774875, 'recall': 0.690399200809706, 'f1-score': 0.7008927379967439, 'support': 760770}, '2': {'precision': 0.5573269992082344, 'recall': 0.28919733507751877, 'f1-score': 0.38079822731561225, 'support': 304249}, 'accuracy': 0.5913509100795394, 'macro avg': {'precision': 0.5607842846590958, 'recall': 0.5420933789926866, 'f1-score': 0.5286672081005821, 'support': 1364606}, 'weighted avg': {'precision': 0.6117794744717644, 'recall': 0.5913509100795394, 'f1-score': 0.5863674683703465, 'support': 1364606}}
[[193738  80983  24866]
 [190514 525235  45021]
 [ 84489 131772  87988]]
Evaluating performance on  train set...
2013/2013 - 33s - 33s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7322316
{'0': {'precision': 0.35104575948389755, 'recall': 0.6110837328076699, 'f1-score': 0.44592407739376333, 'support': 66963}, '1': {'precision': 0.8943793693538331, 'recall': 0.704452129938249, 'f1-score': 0.7881348997603601, 'support': 382828}, '2': {'precision': 0.41001296109613844, 'recall': 0.608339311060576, 'f1-score': 0.4898638891449289, 'support': 65521}, 'accuracy': 0.6800986586766852, 'macro avg': {'precision': 0.5518126966446231, 'recall': 0.6412917246021649, 'f1-score': 0.5746409554330175, 'support': 515312}, 'weighted avg': {'precision': 0.762188735421045, 'recall': 0.6800986586766852, 'f1-score': 0.7057411690017749, 'support': 515312}}
[[ 40920  15493  10550]
 [ 66339 269684  46805]
 [  9307  16355  39859]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7847971
{'0': {'precision': 0.400802270577105, 'recall': 0.5987788331071913, 'f1-score': 0.4801849794845056, 'support': 88440}, '1': {'precision': 0.8308284164496844, 'recall': 0.6874134814618877, 'f1-score': 0.7523473763103973, 'support': 340245}, '2': {'precision': 0.4679072329209041, 'recall': 0.5491821256652083, 'f1-score': 0.5052973696369112, 'support': 86627}, 'accuracy': 0.6489641227062439, 'macro avg': {'precision': 0.5665126399825645, 'recall': 0.6117914800780958, 'f1-score': 0.579276575143938, 'support': 515312}, 'weighted avg': {'precision': 0.6960163303610264, 'recall': 0.6489641227062439, 'f1-score': 0.6641071581447308, 'support': 515312}}
[[ 52956  22158  13326]
 [ 65582 233889  40774]
 [ 13587  25466  47574]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8337826
{'0': {'precision': 0.426610173011818, 'recall': 0.5872878205922438, 'f1-score': 0.4942172887826631, 'support': 104923}, '1': {'precision': 0.7718507115232982, 'recall': 0.6683062738544965, 'f1-score': 0.7163561725942807, 'support': 307594}, '2': {'precision': 0.49535588907701283, 'recall': 0.5037696386010992, 'f1-score': 0.499527337268974, 'support': 102795}, 'accuracy': 0.6189881081752414, 'macro avg': {'precision': 0.564605591204043, 'recall': 0.5864545776826132, 'f1-score': 0.5700335995486393, 'support': 515312}, 'weighted avg': {'precision': 0.6464005797669914, 'recall': 0.6189881081752414, 'f1-score': 0.627873082285048, 'support': 515312}}
[[ 61620  27596  15707]
 [ 64978 205567  37049]
 [ 17843  33167  51785]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9003836
{'0': {'precision': 0.45868942215839514, 'recall': 0.5494670066355369, 'f1-score': 0.4999912643919144, 'support': 130208}, '1': {'precision': 0.6641672456060497, 'recall': 0.6454824840517175, 'f1-score': 0.6546915771617936, 'support': 257708}, '2': {'precision': 0.5175197700157058, 'recall': 0.4422901817953468, 'f1-score': 0.47695674071942207, 'support': 127396}, 'accuracy': 0.5709880616015152, 'macro avg': {'precision': 0.5467921459267169, 'recall': 0.5457465574942004, 'f1-score': 0.54387986075771, 'support': 515312}, 'weighted avg': {'precision': 0.5759931719656538, 'recall': 0.5709880616015152, 'f1-score': 0.5716624112418212, 'support': 515312}}
[[ 71545  38306  20357]
 [ 59188 166346  32174]
 [ 25244  45806  56346]]
Evaluating performance on  val set...
696/696 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.712797
{'0': {'precision': 0.3294468779524178, 'recall': 0.7141593744181717, 'f1-score': 0.4508933819207712, 'support': 21484}, '1': {'precision': 0.9150656342039049, 'recall': 0.691734921816828, 'f1-score': 0.7878798056939891, 'support': 135643}, '2': {'precision': 0.419584302022971, 'recall': 0.58129026055187, 'f1-score': 0.48737429717256814, 'support': 20802}, 'accuracy': 0.6815302733112646, 'macro avg': {'precision': 0.5546989380597646, 'recall': 0.6623948522622899, 'f1-score': 0.5753824949291094, 'support': 177929}, 'weighted avg': {'precision': 0.7864276042518747, 'recall': 0.6815302733112647, 'f1-score': 0.7120578097483792, 'support': 177929}}
[[15343  3536  2605]
 [27692 93829 14122]
 [ 3537  5173 12092]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7613021
{'0': {'precision': 0.38377283542760504, 'recall': 0.6843397152675503, 'f1-score': 0.49176651421803935, 'support': 28518}, '1': {'precision': 0.8532962505150391, 'recall': 0.6819794676743478, 'f1-score': 0.7580794977739341, 'support': 121467}, '2': {'precision': 0.48103080410721427, 'recall': 0.5163541368451188, 'f1-score': 0.4980669658267173, 'support': 27944}, 'accuracy': 0.6563460706236758, 'macro avg': {'precision': 0.5726999633499528, 'recall': 0.627557773262339, 'f1-score': 0.5826376592728969, 'support': 177929}, 'weighted avg': {'precision': 0.7195774391583535, 'recall': 0.6563460706236758, 'f1-score': 0.674560207170491, 'support': 177929}}
[[19516  5860  3142]
 [26204 82838 12425]
 [ 5133  8382 14429]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.810554
{'0': {'precision': 0.41480374797107866, 'recall': 0.659540148982345, 'f1-score': 0.5092963743007903, 'support': 34098}, '1': {'precision': 0.7937105430141642, 'recall': 0.6690236605928747, 'f1-score': 0.7260528011569621, 'support': 110310}, '2': {'precision': 0.5109657685799818, 'recall': 0.46845261179559083, 'f1-score': 0.4887865158047095, 'support': 33521}, 'accuracy': 0.6294195999527902, 'macro avg': {'precision': 0.5731600198550749, 'recall': 0.5990054737902701, 'f1-score': 0.5747118970874874, 'support': 177929}, 'weighted avg': {'precision': 0.6678297058196239, 'recall': 0.6294195999527902, 'f1-score': 0.6398141115996971, 'support': 177929}}
[[22489  8043  3566]
 [25047 73800 11463]
 [ 6680 11138 15703]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.882859
{'0': {'precision': 0.4529432193089078, 'recall': 0.6088651323467625, 'f1-score': 0.5194559502947268, 'support': 42842}, '1': {'precision': 0.6868823456497978, 'recall': 0.6554690524323626, 'f1-score': 0.6708081369436389, 'support': 92996}, '2': {'precision': 0.5382643372578807, 'recall': 0.4040531229954147, 'f1-score': 0.46160109652991704, 'support': 42091}, 'accuracy': 0.5847725778259868, 'macro avg': {'precision': 0.5593633007388621, 'recall': 0.5561291025915133, 'f1-score': 0.550621727922761, 'support': 177929}, 'weighted avg': {'precision': 0.5953969742830133, 'recall': 0.5847725778259868, 'f1-score': 0.5848751866181346, 'support': 177929}}
[[26085 12065  4692]
 [22143 60956  9897]
 [ 9362 15722 17007]]
training model: results/AAL/W7/deepOF_L2/seq2seq
Epoch 1/50
2013/2013 - 66s - loss: 10.8547 - accuracy10: 0.5545 - accuracy20: 0.5533 - accuracy30: 0.5447 - accuracy50: 0.5262 - val_loss: 10.4760 - val_accuracy10: 0.7333 - val_accuracy20: 0.6941 - val_accuracy30: 0.6532 - val_accuracy50: 0.5867 - 66s/epoch - 33ms/step
Epoch 2/50
2013/2013 - 57s - loss: 9.9072 - accuracy10: 0.6299 - accuracy20: 0.6151 - accuracy30: 0.5954 - accuracy50: 0.5659 - val_loss: 10.4793 - val_accuracy10: 0.7450 - val_accuracy20: 0.7039 - val_accuracy30: 0.6636 - val_accuracy50: 0.5947 - 57s/epoch - 29ms/step
Epoch 3/50
2013/2013 - 58s - loss: 9.7360 - accuracy10: 0.6400 - accuracy20: 0.6222 - accuracy30: 0.6017 - accuracy50: 0.5706 - val_loss: 10.5010 - val_accuracy10: 0.7328 - val_accuracy20: 0.6935 - val_accuracy30: 0.6548 - val_accuracy50: 0.5912 - 58s/epoch - 29ms/step
Epoch 4/50
2013/2013 - 57s - loss: 9.6529 - accuracy10: 0.6447 - accuracy20: 0.6257 - accuracy30: 0.6051 - accuracy50: 0.5737 - val_loss: 10.4840 - val_accuracy10: 0.7295 - val_accuracy20: 0.6919 - val_accuracy30: 0.6543 - val_accuracy50: 0.5911 - 57s/epoch - 29ms/step
Epoch 5/50
2013/2013 - 59s - loss: 9.5940 - accuracy10: 0.6473 - accuracy20: 0.6279 - accuracy30: 0.6071 - accuracy50: 0.5750 - val_loss: 10.3608 - val_accuracy10: 0.7395 - val_accuracy20: 0.7007 - val_accuracy30: 0.6628 - val_accuracy50: 0.5969 - 59s/epoch - 29ms/step
Epoch 6/50
2013/2013 - 58s - loss: 9.5404 - accuracy10: 0.6499 - accuracy20: 0.6303 - accuracy30: 0.6087 - accuracy50: 0.5770 - val_loss: 10.4256 - val_accuracy10: 0.7412 - val_accuracy20: 0.7032 - val_accuracy30: 0.6655 - val_accuracy50: 0.5985 - 58s/epoch - 29ms/step
Epoch 7/50
2013/2013 - 60s - loss: 9.4987 - accuracy10: 0.6511 - accuracy20: 0.6324 - accuracy30: 0.6109 - accuracy50: 0.5782 - val_loss: 10.5100 - val_accuracy10: 0.7374 - val_accuracy20: 0.6997 - val_accuracy30: 0.6622 - val_accuracy50: 0.5959 - 60s/epoch - 30ms/step
Epoch 8/50
2013/2013 - 58s - loss: 9.5250 - accuracy10: 0.6507 - accuracy20: 0.6309 - accuracy30: 0.6088 - accuracy50: 0.5760 - val_loss: 10.4473 - val_accuracy10: 0.7468 - val_accuracy20: 0.7075 - val_accuracy30: 0.6689 - val_accuracy50: 0.6013 - 58s/epoch - 29ms/step
Epoch 9/50
2013/2013 - 62s - loss: 9.4765 - accuracy10: 0.6515 - accuracy20: 0.6322 - accuracy30: 0.6110 - accuracy50: 0.5778 - val_loss: 10.4379 - val_accuracy10: 0.7500 - val_accuracy20: 0.7098 - val_accuracy30: 0.6699 - val_accuracy50: 0.6015 - 62s/epoch - 31ms/step
Epoch 10/50
2013/2013 - 58s - loss: 9.4330 - accuracy10: 0.6538 - accuracy20: 0.6342 - accuracy30: 0.6120 - accuracy50: 0.5787 - val_loss: 10.4641 - val_accuracy10: 0.7492 - val_accuracy20: 0.7082 - val_accuracy30: 0.6688 - val_accuracy50: 0.6016 - 58s/epoch - 29ms/step
Epoch 11/50
2013/2013 - 58s - loss: 9.3950 - accuracy10: 0.6555 - accuracy20: 0.6359 - accuracy30: 0.6139 - accuracy50: 0.5799 - val_loss: 10.4785 - val_accuracy10: 0.7482 - val_accuracy20: 0.7074 - val_accuracy30: 0.6678 - val_accuracy50: 0.5999 - 58s/epoch - 29ms/step
Epoch 12/50
2013/2013 - 57s - loss: 9.3594 - accuracy10: 0.6565 - accuracy20: 0.6372 - accuracy30: 0.6151 - accuracy50: 0.5816 - val_loss: 10.5553 - val_accuracy10: 0.7564 - val_accuracy20: 0.7131 - val_accuracy30: 0.6723 - val_accuracy50: 0.6024 - 57s/epoch - 28ms/step
Epoch 13/50
2013/2013 - 57s - loss: 9.3345 - accuracy10: 0.6571 - accuracy20: 0.6381 - accuracy30: 0.6157 - accuracy50: 0.5821 - val_loss: 10.5589 - val_accuracy10: 0.7494 - val_accuracy20: 0.7080 - val_accuracy30: 0.6679 - val_accuracy50: 0.5993 - 57s/epoch - 29ms/step
Epoch 14/50
2013/2013 - 59s - loss: 9.3079 - accuracy10: 0.6580 - accuracy20: 0.6390 - accuracy30: 0.6165 - accuracy50: 0.5828 - val_loss: 10.5501 - val_accuracy10: 0.7559 - val_accuracy20: 0.7128 - val_accuracy30: 0.6720 - val_accuracy50: 0.6021 - 59s/epoch - 29ms/step
Epoch 15/50
2013/2013 - 58s - loss: 9.2823 - accuracy10: 0.6592 - accuracy20: 0.6401 - accuracy30: 0.6173 - accuracy50: 0.5833 - val_loss: 10.5484 - val_accuracy10: 0.7513 - val_accuracy20: 0.7092 - val_accuracy30: 0.6684 - val_accuracy50: 0.5998 - 58s/epoch - 29ms/step
testing model: results/AAL/W7/deepOF_L2/seq2seq
Evaluating performance on  test set...
5331/5331 - 52s - 52s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5996014
{'0': {'precision': 0.3722836332476435, 'recall': 0.5953558801765012, 'f1-score': 0.4581070679165305, 'support': 145948}, '1': {'precision': 0.8979718268000155, 'recall': 0.8014413189301065, 'f1-score': 0.8469649973473493, 'support': 1070686}, '2': {'precision': 0.43973077010682643, 'recall': 0.5218866368852514, 'f1-score': 0.4772992066852299, 'support': 147967}, 'accuracy': 0.7490870957884392, 'macro avg': {'precision': 0.5699954100514951, 'recall': 0.639561278663953, 'f1-score': 0.5941237573163699, 'support': 1364601}, 'weighted avg': {'precision': 0.7920597727209825, 'recall': 0.7490870957884392, 'f1-score': 0.7652917645624759, 'support': 1364601}}
[[ 86891  39371  19686]
 [133890 858092  78704]
 [ 12619  58126  77222]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6732357
{'0': {'precision': 0.43746179190980905, 'recall': 0.5565116831043172, 'f1-score': 0.48985733368005313, 'support': 198021}, '1': {'precision': 0.8348387180409581, 'recall': 0.7999890269378325, 'f1-score': 0.8170424263313173, 'support': 966002}, '2': {'precision': 0.5012405488359161, 'recall': 0.4673443747569524, 'f1-score': 0.48369935395983404, 'support': 200578}, 'accuracy': 0.7157630692048444, 'macro avg': {'precision': 0.5911803529288945, 'recall': 0.6079483615997007, 'f1-score': 0.5968663713237348, 'support': 1364601}, 'weighted avg': {'precision': 0.7281398149387142, 'recall': 0.7157630692048444, 'f1-score': 0.7205667488241021, 'support': 1364601}}
[[110201  62986  24834]
 [124770 772791  68441]
 [ 16939  89900  93739]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7453837
{'0': {'precision': 0.4672031712497247, 'recall': 0.5254525456743686, 'f1-score': 0.49461881193009494, 'support': 238208}, '1': {'precision': 0.7761389497663267, 'recall': 0.7917342929866044, 'f1-score': 0.7838590593888232, 'support': 884764}, '2': {'precision': 0.5251143434010466, 'recall': 0.4219361086624536, 'f1-score': 0.467904750321836, 'support': 241629}, 'accuracy': 0.6797715962394869, 'macro avg': {'precision': 0.5894854881390327, 'recall': 0.5797076491078089, 'f1-score': 0.5821275405469181, 'support': 1364601}, 'weighted avg': {'precision': 0.6777616229577439, 'recall': 0.6797715962394869, 'f1-score': 0.6774227717031218, 'support': 1364601}}
[[125167  84145  28896]
 [120962 700498  63304]
 [ 21778 117899 101952]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8464537
{'0': {'precision': 0.4954089914602301, 'recall': 0.4686100151542462, 'f1-score': 0.48163700799017445, 'support': 299586}, '1': {'precision': 0.6742696856877978, 'recall': 0.7829751436045059, 'f1-score': 0.724567887794058, 'support': 760770}, '2': {'precision': 0.5449140546006067, 'recall': 0.35426712024848395, 'f1-score': 0.4293798364688424, 'support': 304245}, 'accuracy': 0.6183763605625381, 'macro avg': {'precision': 0.5715309105828782, 'recall': 0.535284093002412, 'f1-score': 0.5451949107510249, 'support': 1364601}, 'weighted avg': {'precision': 0.6061618915992821, 'recall': 0.6183763605625381, 'f1-score': 0.605420840977907, 'support': 1364601}}
[[140389 123725  35472]
 [110562 595664  54544]
 [ 32429 164032 107784]]
Evaluating performance on  train set...
2013/2013 - 20s - 20s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.65712315
{'0': {'precision': 0.41315127811146807, 'recall': 0.5298886267952584, 'f1-score': 0.4642945908823337, 'support': 66982}, '1': {'precision': 0.8771843021292944, 'recall': 0.7872068118894635, 'f1-score': 0.8297634517542893, 'support': 382860}, '2': {'precision': 0.4332509846878132, 'recall': 0.5678957658703488, 'f1-score': 0.4915191496675083, 'support': 65468}, 'accuracy': 0.7258970328540102, 'macro avg': {'precision': 0.5745288549761919, 'recall': 0.628330401518357, 'f1-score': 0.5951923974347104, 'support': 515310}, 'weighted avg': {'precision': 0.7604675948249127, 'recall': 0.7258970328540102, 'f1-score': 0.7392858495188529, 'support': 515310}}
[[ 35493  20553  10936]
 [ 43771 301390  37699]
 [  6644  21645  37179]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7274429
{'0': {'precision': 0.4672460968936102, 'recall': 0.49245679905907896, 'f1-score': 0.4795203145045397, 'support': 88424}, '1': {'precision': 0.8066231174015606, 'recall': 0.7839320931955054, 'f1-score': 0.7951157490561059, 'support': 340231}, '2': {'precision': 0.49068941009239514, 'recall': 0.5178697132306272, 'f1-score': 0.5039133119982033, 'support': 86655}, 'accuracy': 0.6891754477887098, 'macro avg': {'precision': 0.5881862081291886, 'recall': 0.5980862018284038, 'f1-score': 0.5928497918529497, 'support': 515310}, 'weighted avg': {'precision': 0.6952604249091372, 'recall': 0.6891754477887098, 'f1-score': 0.6919926621995725, 'support': 515310}}
[[ 43545  30835  14044]
 [ 40978 266718  32535]
 [  8672  33107  44876]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7946048
{'0': {'precision': 0.4876623117979766, 'recall': 0.4668630479132109, 'f1-score': 0.47703607017270433, 'support': 104898}, '1': {'precision': 0.7429800547516621, 'recall': 0.77201280863445, 'f1-score': 0.7572182453007669, 'support': 307605}, '2': {'precision': 0.5149221612202265, 'recall': 0.47712704387833516, 'f1-score': 0.4953046428499303, 'support': 102807}, 'accuracy': 0.6510644078321787, 'macro avg': {'precision': 0.581854842589955, 'recall': 0.5720009668086653, 'f1-score': 0.5765196527744673, 'support': 515310}, 'weighted avg': {'precision': 0.6455081088149599, 'recall': 0.6510644078321787, 'f1-score': 0.6479304349851381, 'support': 515310}}
[[ 48973  39427  16498]
 [ 40419 237475  29711]
 [ 11032  42723  49052]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8878725
{'0': {'precision': 0.5102852491768101, 'recall': 0.4238661944237433, 'f1-score': 0.46307837582625117, 'support': 130159}, '1': {'precision': 0.63050162125851, 'recall': 0.7574708808306239, 'f1-score': 0.6881787898549447, 'support': 257734}, '2': {'precision': 0.5366346173558294, 'recall': 0.41087923903403784, 'f1-score': 0.4654117124124903, 'support': 127417}, 'accuracy': 0.5875084900351245, 'macro avg': {'precision': 0.5591404959303832, 'recall': 0.5307387714294683, 'f1-score': 0.5388896260312287, 'support': 515310}, 'weighted avg': {'precision': 0.5769270839701789, 'recall': 0.5875084900351245, 'f1-score': 0.5762400394017302, 'support': 515310}}
[[ 55170  54714  20275]
 [ 37578 195226  24930]
 [ 15368  59696  52353]]
Evaluating performance on  val set...
696/696 - 7s - 7s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.61974514
{'0': {'precision': 0.4028727320536419, 'recall': 0.5699869791666666, 'f1-score': 0.47207672161454317, 'support': 21504}, '1': {'precision': 0.8857920949974238, 'recall': 0.7991323402465748, 'f1-score': 0.8402336568223603, 'support': 135537}, '2': {'precision': 0.43756936736958935, 'recall': 0.528485254691689, 'f1-score': 0.478749241044323, 'support': 20888}, 'accuracy': 0.7396658217603651, 'macro avg': {'precision': 0.5754113981402184, 'recall': 0.6325348580349769, 'f1-score': 0.5970198731604088, 'support': 177929}, 'weighted avg': {'precision': 0.7748086447704609, 'recall': 0.7396658217603651, 'f1-score': 0.753302728129002, 'support': 177929}}
[[ 12257   6318   2929]
 [ 15965 108312  11260]
 [  2202   7647  11039]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7007635
{'0': {'precision': 0.4548519362186788, 'recall': 0.5249947416392063, 'f1-score': 0.48741273535011637, 'support': 28526}, '1': {'precision': 0.8156459075184599, 'recall': 0.794478451791496, 'f1-score': 0.8049230409669126, 'support': 121379}, '2': {'precision': 0.49815126050420167, 'recall': 0.4759491864116472, 'f1-score': 0.4867972043285461, 'support': 28024}, 'accuracy': 0.7011054971364983, 'macro avg': {'precision': 0.5895497014137802, 'recall': 0.5984741266141166, 'f1-score': 0.5930443268818584, 'support': 177929}, 'weighted avg': {'precision': 0.7077968283170643, 'recall': 0.7011054971364983, 'f1-score': 0.7039138888670395, 'support': 177929}}
[[14976  9901  3649]
 [15158 96433  9788]
 [ 2791 11895 13338]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.77557147
{'0': {'precision': 0.48177261335156074, 'recall': 0.49627413014140703, 'f1-score': 0.48891586462036474, 'support': 34086}, '1': {'precision': 0.7515034755668949, 'recall': 0.7854052730389356, 'f1-score': 0.7680804640519396, 'support': 110259}, '2': {'precision': 0.5263921113689095, 'recall': 0.4323487374940448, 'f1-score': 0.4747580434213968, 'support': 33584}, 'accuracy': 0.6633769649691731, 'macro avg': {'precision': 0.5865560667624551, 'recall': 0.5713427135581292, 'f1-score': 0.5772514573645671, 'support': 177929}, 'weighted avg': {'precision': 0.6573412747750227, 'recall': 0.6633769649691731, 'f1-score': 0.6592362356761223, 'support': 177929}}
[[16916 13036  4134]
 [14731 86598  8930]
 [ 3465 15599 14520]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8807114
{'0': {'precision': 0.5062763741253138, 'recall': 0.44237007304380294, 'f1-score': 0.4721706749031671, 'support': 42851}, '1': {'precision': 0.6387768876889465, 'recall': 0.7738863783085862, 'f1-score': 0.6998705835417295, 'support': 92940}, '2': {'precision': 0.5479938326938937, 'recall': 0.36268925910104893, 'f1-score': 0.43648878289802506, 'support': 42138}, 'accuracy': 0.5966649618668121, 'macro avg': {'precision': 0.5643490315027181, 'recall': 0.5263152368178127, 'f1-score': 0.5361766804476406, 'support': 177929}, 'weighted avg': {'precision': 0.5853668427940909, 'recall': 0.5966649618668121, 'f1-score': 0.5826578127140654, 'support': 177929}}
[[18956 18815  5080]
 [13489 71925  7526]
 [ 4997 21858 15283]]
training model: results/AAL/W7/deepVOL_L2/seq2seq
Epoch 1/50
2013/2013 - 64s - loss: 11.7716 - accuracy10: 0.4409 - accuracy20: 0.4588 - accuracy30: 0.4672 - accuracy50: 0.4693 - val_loss: 11.1817 - val_accuracy10: 0.6490 - val_accuracy20: 0.6311 - val_accuracy30: 0.6073 - val_accuracy50: 0.5523 - 64s/epoch - 32ms/step
Epoch 2/50
2013/2013 - 56s - loss: 10.7970 - accuracy10: 0.5673 - accuracy20: 0.5618 - accuracy30: 0.5492 - accuracy50: 0.5269 - val_loss: 10.7763 - val_accuracy10: 0.7071 - val_accuracy20: 0.6728 - val_accuracy30: 0.6356 - val_accuracy50: 0.5714 - 56s/epoch - 28ms/step
Epoch 3/50
2013/2013 - 57s - loss: 10.3841 - accuracy10: 0.6076 - accuracy20: 0.5904 - accuracy30: 0.5700 - accuracy50: 0.5425 - val_loss: 10.5651 - val_accuracy10: 0.7325 - val_accuracy20: 0.6927 - val_accuracy30: 0.6510 - val_accuracy50: 0.5807 - 57s/epoch - 28ms/step
Epoch 4/50
2013/2013 - 56s - loss: 10.0930 - accuracy10: 0.6311 - accuracy20: 0.6123 - accuracy30: 0.5881 - accuracy50: 0.5559 - val_loss: 10.4758 - val_accuracy10: 0.7344 - val_accuracy20: 0.6956 - val_accuracy30: 0.6552 - val_accuracy50: 0.5862 - 56s/epoch - 28ms/step
Epoch 5/50
2013/2013 - 56s - loss: 9.9567 - accuracy10: 0.6387 - accuracy20: 0.6193 - accuracy30: 0.5945 - accuracy50: 0.5607 - val_loss: 10.4840 - val_accuracy10: 0.7479 - val_accuracy20: 0.7046 - val_accuracy30: 0.6617 - val_accuracy50: 0.5895 - 56s/epoch - 28ms/step
Epoch 6/50
2013/2013 - 56s - loss: 9.8476 - accuracy10: 0.6460 - accuracy20: 0.6269 - accuracy30: 0.6006 - accuracy50: 0.5653 - val_loss: 10.5375 - val_accuracy10: 0.7488 - val_accuracy20: 0.7038 - val_accuracy30: 0.6606 - val_accuracy50: 0.5884 - 56s/epoch - 28ms/step
Epoch 7/50
2013/2013 - 57s - loss: 9.7772 - accuracy10: 0.6488 - accuracy20: 0.6292 - accuracy30: 0.6032 - accuracy50: 0.5670 - val_loss: 10.4103 - val_accuracy10: 0.7437 - val_accuracy20: 0.7024 - val_accuracy30: 0.6612 - val_accuracy50: 0.5914 - 57s/epoch - 28ms/step
Epoch 8/50
2013/2013 - 57s - loss: 9.7102 - accuracy10: 0.6536 - accuracy20: 0.6329 - accuracy30: 0.6059 - accuracy50: 0.5693 - val_loss: 10.4429 - val_accuracy10: 0.7424 - val_accuracy20: 0.7017 - val_accuracy30: 0.6603 - val_accuracy50: 0.5907 - 57s/epoch - 28ms/step
Epoch 9/50
2013/2013 - 57s - loss: 9.6660 - accuracy10: 0.6557 - accuracy20: 0.6352 - accuracy30: 0.6081 - accuracy50: 0.5715 - val_loss: 10.3838 - val_accuracy10: 0.7461 - val_accuracy20: 0.7045 - val_accuracy30: 0.6635 - val_accuracy50: 0.5935 - 57s/epoch - 28ms/step
Epoch 10/50
2013/2013 - 57s - loss: 9.6161 - accuracy10: 0.6583 - accuracy20: 0.6370 - accuracy30: 0.6099 - accuracy50: 0.5731 - val_loss: 10.3532 - val_accuracy10: 0.7403 - val_accuracy20: 0.6998 - val_accuracy30: 0.6607 - val_accuracy50: 0.5923 - 57s/epoch - 28ms/step
Epoch 11/50
2013/2013 - 57s - loss: 9.5772 - accuracy10: 0.6605 - accuracy20: 0.6385 - accuracy30: 0.6111 - accuracy50: 0.5744 - val_loss: 10.3278 - val_accuracy10: 0.7408 - val_accuracy20: 0.7004 - val_accuracy30: 0.6612 - val_accuracy50: 0.5929 - 57s/epoch - 28ms/step
Epoch 12/50
2013/2013 - 58s - loss: 9.5451 - accuracy10: 0.6621 - accuracy20: 0.6397 - accuracy30: 0.6123 - accuracy50: 0.5758 - val_loss: 10.3010 - val_accuracy10: 0.7424 - val_accuracy20: 0.7010 - val_accuracy30: 0.6606 - val_accuracy50: 0.5925 - 58s/epoch - 29ms/step
Epoch 13/50
2013/2013 - 56s - loss: 9.5124 - accuracy10: 0.6639 - accuracy20: 0.6404 - accuracy30: 0.6130 - accuracy50: 0.5759 - val_loss: 10.2997 - val_accuracy10: 0.7393 - val_accuracy20: 0.6986 - val_accuracy30: 0.6596 - val_accuracy50: 0.5917 - 56s/epoch - 28ms/step
Epoch 14/50
2013/2013 - 57s - loss: 9.4845 - accuracy10: 0.6640 - accuracy20: 0.6410 - accuracy30: 0.6139 - accuracy50: 0.5776 - val_loss: 10.2582 - val_accuracy10: 0.7393 - val_accuracy20: 0.6998 - val_accuracy30: 0.6612 - val_accuracy50: 0.5940 - 57s/epoch - 28ms/step
Epoch 15/50
2013/2013 - 57s - loss: 9.4601 - accuracy10: 0.6651 - accuracy20: 0.6416 - accuracy30: 0.6147 - accuracy50: 0.5784 - val_loss: 10.2022 - val_accuracy10: 0.7413 - val_accuracy20: 0.7015 - val_accuracy30: 0.6623 - val_accuracy50: 0.5955 - 57s/epoch - 29ms/step
Epoch 16/50
2013/2013 - 57s - loss: 9.4367 - accuracy10: 0.6660 - accuracy20: 0.6422 - accuracy30: 0.6152 - accuracy50: 0.5790 - val_loss: 10.2275 - val_accuracy10: 0.7364 - val_accuracy20: 0.6972 - val_accuracy30: 0.6596 - val_accuracy50: 0.5935 - 57s/epoch - 28ms/step
Epoch 17/50
2013/2013 - 57s - loss: 9.4205 - accuracy10: 0.6664 - accuracy20: 0.6424 - accuracy30: 0.6155 - accuracy50: 0.5796 - val_loss: 10.1742 - val_accuracy10: 0.7381 - val_accuracy20: 0.6982 - val_accuracy30: 0.6599 - val_accuracy50: 0.5947 - 57s/epoch - 28ms/step
Epoch 18/50
2013/2013 - 57s - loss: 9.3916 - accuracy10: 0.6672 - accuracy20: 0.6430 - accuracy30: 0.6161 - accuracy50: 0.5806 - val_loss: 10.1822 - val_accuracy10: 0.7384 - val_accuracy20: 0.6984 - val_accuracy30: 0.6588 - val_accuracy50: 0.5930 - 57s/epoch - 28ms/step
Epoch 19/50
2013/2013 - 57s - loss: 9.3691 - accuracy10: 0.6682 - accuracy20: 0.6437 - accuracy30: 0.6170 - accuracy50: 0.5815 - val_loss: 10.1871 - val_accuracy10: 0.7422 - val_accuracy20: 0.7019 - val_accuracy30: 0.6636 - val_accuracy50: 0.5964 - 57s/epoch - 28ms/step
Epoch 20/50
2013/2013 - 57s - loss: 9.3488 - accuracy10: 0.6677 - accuracy20: 0.6437 - accuracy30: 0.6171 - accuracy50: 0.5814 - val_loss: 10.1294 - val_accuracy10: 0.7369 - val_accuracy20: 0.6972 - val_accuracy30: 0.6586 - val_accuracy50: 0.5931 - 57s/epoch - 28ms/step
Epoch 21/50
2013/2013 - 57s - loss: 9.3242 - accuracy10: 0.6688 - accuracy20: 0.6447 - accuracy30: 0.6185 - accuracy50: 0.5832 - val_loss: 10.1761 - val_accuracy10: 0.7323 - val_accuracy20: 0.6928 - val_accuracy30: 0.6549 - val_accuracy50: 0.5905 - 57s/epoch - 28ms/step
Epoch 22/50
2013/2013 - 58s - loss: 9.3031 - accuracy10: 0.6690 - accuracy20: 0.6449 - accuracy30: 0.6185 - accuracy50: 0.5830 - val_loss: 10.1555 - val_accuracy10: 0.7412 - val_accuracy20: 0.6998 - val_accuracy30: 0.6603 - val_accuracy50: 0.5939 - 58s/epoch - 29ms/step
Epoch 23/50
2013/2013 - 57s - loss: 9.2850 - accuracy10: 0.6694 - accuracy20: 0.6457 - accuracy30: 0.6191 - accuracy50: 0.5842 - val_loss: 10.1602 - val_accuracy10: 0.7403 - val_accuracy20: 0.7003 - val_accuracy30: 0.6610 - val_accuracy50: 0.5943 - 57s/epoch - 28ms/step
Epoch 24/50
2013/2013 - 57s - loss: 9.2693 - accuracy10: 0.6687 - accuracy20: 0.6446 - accuracy30: 0.6188 - accuracy50: 0.5841 - val_loss: 10.1203 - val_accuracy10: 0.7362 - val_accuracy20: 0.6959 - val_accuracy30: 0.6569 - val_accuracy50: 0.5923 - 57s/epoch - 28ms/step
Epoch 25/50
2013/2013 - 57s - loss: 9.2516 - accuracy10: 0.6690 - accuracy20: 0.6454 - accuracy30: 0.6199 - accuracy50: 0.5843 - val_loss: 10.1774 - val_accuracy10: 0.7402 - val_accuracy20: 0.6983 - val_accuracy30: 0.6584 - val_accuracy50: 0.5921 - 57s/epoch - 28ms/step
Epoch 26/50
2013/2013 - 57s - loss: 9.2353 - accuracy10: 0.6701 - accuracy20: 0.6464 - accuracy30: 0.6206 - accuracy50: 0.5853 - val_loss: 10.2263 - val_accuracy10: 0.7422 - val_accuracy20: 0.6985 - val_accuracy30: 0.6575 - val_accuracy50: 0.5908 - 57s/epoch - 28ms/step
Epoch 27/50
2013/2013 - 57s - loss: 9.2096 - accuracy10: 0.6706 - accuracy20: 0.6468 - accuracy30: 0.6213 - accuracy50: 0.5863 - val_loss: 10.1925 - val_accuracy10: 0.7367 - val_accuracy20: 0.6937 - val_accuracy30: 0.6540 - val_accuracy50: 0.5887 - 57s/epoch - 28ms/step
Epoch 28/50
2013/2013 - 57s - loss: 9.1942 - accuracy10: 0.6700 - accuracy20: 0.6477 - accuracy30: 0.6217 - accuracy50: 0.5869 - val_loss: 10.1281 - val_accuracy10: 0.7345 - val_accuracy20: 0.6927 - val_accuracy30: 0.6536 - val_accuracy50: 0.5900 - 57s/epoch - 28ms/step
Epoch 29/50
2013/2013 - 56s - loss: 9.1778 - accuracy10: 0.6703 - accuracy20: 0.6471 - accuracy30: 0.6223 - accuracy50: 0.5877 - val_loss: 10.2030 - val_accuracy10: 0.7405 - val_accuracy20: 0.6971 - val_accuracy30: 0.6563 - val_accuracy50: 0.5893 - 56s/epoch - 28ms/step
Epoch 30/50
2013/2013 - 57s - loss: 9.1588 - accuracy10: 0.6702 - accuracy20: 0.6476 - accuracy30: 0.6224 - accuracy50: 0.5879 - val_loss: 10.1198 - val_accuracy10: 0.7311 - val_accuracy20: 0.6910 - val_accuracy30: 0.6517 - val_accuracy50: 0.5882 - 57s/epoch - 28ms/step
Epoch 31/50
2013/2013 - 57s - loss: 9.1421 - accuracy10: 0.6715 - accuracy20: 0.6485 - accuracy30: 0.6227 - accuracy50: 0.5883 - val_loss: 10.1868 - val_accuracy10: 0.7302 - val_accuracy20: 0.6875 - val_accuracy30: 0.6483 - val_accuracy50: 0.5848 - 57s/epoch - 28ms/step
Epoch 32/50
2013/2013 - 56s - loss: 9.1292 - accuracy10: 0.6715 - accuracy20: 0.6488 - accuracy30: 0.6240 - accuracy50: 0.5892 - val_loss: 10.2213 - val_accuracy10: 0.7339 - val_accuracy20: 0.6904 - val_accuracy30: 0.6504 - val_accuracy50: 0.5858 - 56s/epoch - 28ms/step
Epoch 33/50
2013/2013 - 56s - loss: 9.1171 - accuracy10: 0.6718 - accuracy20: 0.6491 - accuracy30: 0.6243 - accuracy50: 0.5899 - val_loss: 10.1972 - val_accuracy10: 0.7358 - val_accuracy20: 0.6936 - val_accuracy30: 0.6526 - val_accuracy50: 0.5874 - 56s/epoch - 28ms/step
Epoch 34/50
2013/2013 - 56s - loss: 9.0975 - accuracy10: 0.6716 - accuracy20: 0.6493 - accuracy30: 0.6244 - accuracy50: 0.5900 - val_loss: 10.2544 - val_accuracy10: 0.7329 - val_accuracy20: 0.6906 - val_accuracy30: 0.6507 - val_accuracy50: 0.5867 - 56s/epoch - 28ms/step
Epoch 35/50
2013/2013 - 57s - loss: 9.0769 - accuracy10: 0.6712 - accuracy20: 0.6494 - accuracy30: 0.6247 - accuracy50: 0.5906 - val_loss: 10.3602 - val_accuracy10: 0.7383 - val_accuracy20: 0.6933 - val_accuracy30: 0.6523 - val_accuracy50: 0.5865 - 57s/epoch - 28ms/step
Epoch 36/50
2013/2013 - 57s - loss: 9.0643 - accuracy10: 0.6716 - accuracy20: 0.6496 - accuracy30: 0.6247 - accuracy50: 0.5911 - val_loss: 10.3408 - val_accuracy10: 0.7368 - val_accuracy20: 0.6928 - val_accuracy30: 0.6521 - val_accuracy50: 0.5860 - 57s/epoch - 28ms/step
Epoch 37/50
2013/2013 - 56s - loss: 9.0440 - accuracy10: 0.6716 - accuracy20: 0.6501 - accuracy30: 0.6251 - accuracy50: 0.5918 - val_loss: 10.3428 - val_accuracy10: 0.7370 - val_accuracy20: 0.6938 - val_accuracy30: 0.6536 - val_accuracy50: 0.5880 - 56s/epoch - 28ms/step
Epoch 38/50
2013/2013 - 57s - loss: 9.0332 - accuracy10: 0.6721 - accuracy20: 0.6506 - accuracy30: 0.6262 - accuracy50: 0.5927 - val_loss: 10.3142 - val_accuracy10: 0.7363 - val_accuracy20: 0.6923 - val_accuracy30: 0.6527 - val_accuracy50: 0.5877 - 57s/epoch - 28ms/step
Epoch 39/50
2013/2013 - 57s - loss: 9.0114 - accuracy10: 0.6726 - accuracy20: 0.6503 - accuracy30: 0.6266 - accuracy50: 0.5932 - val_loss: 10.3148 - val_accuracy10: 0.7389 - val_accuracy20: 0.6937 - val_accuracy30: 0.6522 - val_accuracy50: 0.5875 - 57s/epoch - 28ms/step
Epoch 40/50
2013/2013 - 57s - loss: 9.0018 - accuracy10: 0.6721 - accuracy20: 0.6505 - accuracy30: 0.6263 - accuracy50: 0.5930 - val_loss: 10.2947 - val_accuracy10: 0.7343 - val_accuracy20: 0.6901 - val_accuracy30: 0.6494 - val_accuracy50: 0.5844 - 57s/epoch - 28ms/step
testing model: results/AAL/W7/deepVOL_L2/seq2seq
Evaluating performance on  test set...
5331/5331 - 50s - 50s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6081469
{'0': {'precision': 0.38246994204460916, 'recall': 0.5882780168279114, 'f1-score': 0.46355731566742525, 'support': 145948}, '1': {'precision': 0.9086104533070187, 'recall': 0.7808581382099394, 'f1-score': 0.8399041811015355, 'support': 1070690}, '2': {'precision': 0.41167137934483167, 'recall': 0.6120039467993079, 'f1-score': 0.49223518924178267, 'support': 147968}, 'accuracy': 0.741951889409837, 'macro avg': {'precision': 0.5675839248988198, 'recall': 0.6603800339457195, 'f1-score': 0.5985655620035811, 'support': 1364606}, 'weighted avg': {'precision': 0.7984539420255476, 'recall': 0.741951889409837, 'f1-score': 0.7619542397236715, 'support': 1364606}}
[[ 85858  37459  22631]
 [127847 836057 106786]
 [ 10778  46633  90557]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.678703
{'0': {'precision': 0.43669998915579905, 'recall': 0.5490804052075022, 'f1-score': 0.4864844307532612, 'support': 198022}, '1': {'precision': 0.8450541217452202, 'recall': 0.7694613784843318, 'f1-score': 0.8054880975989303, 'support': 966003}, '2': {'precision': 0.4666785293644136, 'recall': 0.549164676614435, 'f1-score': 0.5045726784466864, 'support': 200581}, 'accuracy': 0.7051002267321117, 'macro avg': {'precision': 0.5828108800884776, 'recall': 0.6225688201020897, 'f1-score': 0.5988484022662927, 'support': 1364606}, 'weighted avg': {'precision': 0.7301798967022725, 'recall': 0.7051002267321117, 'f1-score': 0.7149655146665019, 'support': 1364606}}
[[108730  60918  28374]
 [125193 743302  97508]
 [ 15058  75371 110152]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.74817455
{'0': {'precision': 0.4624369644080551, 'recall': 0.5185446393713083, 'f1-score': 0.4888862502968416, 'support': 238209}, '1': {'precision': 0.7855402993239626, 'recall': 0.7530564613202376, 'f1-score': 0.7689554705492334, 'support': 884765}, '2': {'precision': 0.4885226438630338, 'recall': 0.5040598927294399, 'f1-score': 0.4961696632440437, 'support': 241632}, 'accuracy': 0.6680294531901516, 'macro avg': {'precision': 0.5788333025316837, 'recall': 0.5918869978069953, 'f1-score': 0.584670461363373, 'support': 1364606}, 'weighted avg': {'precision': 0.6765454008468061, 'recall': 0.6680294531901516, 'f1-score': 0.6717634685516828, 'support': 1364606}}
[[123522  81901  32786]
 [123753 666278  94734]
 [ 19836  99999 121797]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8529166
{'0': {'precision': 0.48708678414718454, 'recall': 0.4609445670205984, 'f1-score': 0.4736552362822525, 'support': 299587}, '1': {'precision': 0.6800117032616164, 'recall': 0.7362632595922552, 'f1-score': 0.7070203828152216, 'support': 760770}, '2': {'precision': 0.5080032323734635, 'recall': 0.42977298199829744, 'f1-score': 0.4656250834601928, 'support': 304249}, 'accuracy': 0.6074852374971237, 'macro avg': {'precision': 0.5583672399274215, 'recall': 0.542326936203717, 'f1-score': 0.5487669008525556, 'support': 1364606}, 'weighted avg': {'precision': 0.5993062080476244, 'recall': 0.6074852374971237, 'f1-score': 0.601966292046281, 'support': 1364606}}
[[138093 120276  41218]
 [115223 560127  85420]
 [ 30192 143299 130758]]
Evaluating performance on  train set...
2013/2013 - 20s - 20s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.65895647
{'0': {'precision': 0.39613927403956695, 'recall': 0.5917745620715917, 'f1-score': 0.47458621763395525, 'support': 66963}, '1': {'precision': 0.8915778530341891, 'recall': 0.7482185211113085, 'f1-score': 0.8136315864223832, 'support': 382828}, '2': {'precision': 0.42817024264150544, 'recall': 0.6143221257306818, 'f1-score': 0.5046261471340455, 'support': 65521}, 'accuracy': 0.7108644859813084, 'macro avg': {'precision': 0.5719624565717539, 'recall': 0.651438402971194, 'f1-score': 0.5976146503967946, 'support': 515312}, 'weighted avg': {'precision': 0.7682758852830871, 'recall': 0.7108644859813084, 'f1-score': 0.730284331909019, 'support': 515312}}
[[ 39627  16065  11271]
 [ 53904 286439  42485]
 [  6502  18768  40251]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7216987
{'0': {'precision': 0.4496391993618367, 'recall': 0.5544889190411578, 'f1-score': 0.4965899252163258, 'support': 88440}, '1': {'precision': 0.820730859717876, 'recall': 0.7392379020999574, 'f1-score': 0.7778557799061707, 'support': 340245}, '2': {'precision': 0.4841864753276947, 'recall': 0.5577475844713542, 'f1-score': 0.5183703028189792, 'support': 86627}, 'accuracy': 0.6770209116030677, 'macro avg': {'precision': 0.5848521781358025, 'recall': 0.6171581352041565, 'f1-score': 0.5976053359804919, 'support': 515312}, 'weighted avg': {'precision': 0.7004674526393365, 'recall': 0.6770209116030677, 'f1-score': 0.6859627119931355, 'support': 515312}}
[[ 49039  25260  14141]
 [ 51392 251522  37331]
 [  8632  29679  48316]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7829989
{'0': {'precision': 0.4774574253325741, 'recall': 0.5274725274725275, 'f1-score': 0.5012203570959576, 'support': 104923}, '1': {'precision': 0.7563339337383523, 'recall': 0.7248775983926865, 'f1-score': 0.7402717486034911, 'support': 307594}, '2': {'precision': 0.5091350612350258, 'recall': 0.5180602169366214, 'f1-score': 0.5135588643727819, 'support': 102795}, 'accuracy': 0.6434276710031981, 'macro avg': {'precision': 0.5809754734353174, 'recall': 0.5901367809339452, 'f1-score': 0.5850169900240769, 'support': 515312}, 'weighted avg': {'precision': 0.6502402118951992, 'recall': 0.6434276710031981, 'f1-score': 0.6463734111193248, 'support': 515312}}
[[ 55344  33300  16279]
 [ 49562 222968  35064]
 [ 11008  38533  53254]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8781476
{'0': {'precision': 0.5077426551401716, 'recall': 0.4754316171049398, 'f1-score': 0.49105620116606513, 'support': 130208}, '1': {'precision': 0.640055125904628, 'recall': 0.7100516864047682, 'f1-score': 0.673238913243034, 'support': 257708}, '2': {'precision': 0.5326096056707504, 'recall': 0.4494254136707589, 'f1-score': 0.48749441239702845, 'support': 127396}, 'accuracy': 0.5863360449591704, 'macro avg': {'precision': 0.56013579557185, 'recall': 0.544969572393489, 'f1-score': 0.5505965089353758, 'support': 515312}, 'weighted avg': {'precision': 0.5800598770281932, 'recall': 0.5863360449591704, 'f1-score': 0.5812853918736585, 'support': 515312}}
[[ 61905  48324  19979]
 [ 44457 182986  30265]
 [ 15560  54581  57255]]
Evaluating performance on  val set...
696/696 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6262369
{'0': {'precision': 0.4035019831672632, 'recall': 0.5824334388382052, 'f1-score': 0.47673111724926187, 'support': 21484}, '1': {'precision': 0.8960010231923602, 'recall': 0.774702712266759, 'f1-score': 0.8309485495585612, 'support': 135643}, '2': {'precision': 0.42158715162966465, 'recall': 0.6006633977502164, 'f1-score': 0.49544012688342587, 'support': 20802}, 'accuracy': 0.7311399490808131, 'macro avg': {'precision': 0.5736967193297627, 'recall': 0.6525998496183935, 'f1-score': 0.6010399312304163, 'support': 177929}, 'weighted avg': {'precision': 0.7810697487393684, 'recall': 0.7311399490808131, 'f1-score': 0.7489537453151768, 'support': 177929}}
[[ 12513   5850   3121]
 [ 16538 105083  14022]
 [  1960   6347  12495]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7051192
{'0': {'precision': 0.44861913937058445, 'recall': 0.5388526544638474, 'f1-score': 0.4896132033390684, 'support': 28518}, '1': {'precision': 0.8254272665643844, 'recall': 0.7618283155095623, 'f1-score': 0.7923536337364872, 'support': 121467}, '2': {'precision': 0.47844267747964647, 'recall': 0.5404738047523618, 'f1-score': 0.507570029070256, 'support': 27944}, 'accuracy': 0.6913263155528329, 'macro avg': {'precision': 0.5841630278048717, 'recall': 0.6137182582419239, 'f1-score': 0.5965122887152705, 'support': 177929}, 'weighted avg': {'precision': 0.7105390160335732, 'recall': 0.6913263155528329, 'f1-score': 0.6991055143019557, 'support': 177929}}
[[15367  9299  3852]
 [16318 92537 12612]
 [ 2569 10272 15103]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7778378
{'0': {'precision': 0.47214731279453026, 'recall': 0.508328934248343, 'f1-score': 0.4895705348190202, 'support': 34098}, '1': {'precision': 0.7594506806340863, 'recall': 0.7439670020850331, 'f1-score': 0.7516291082607123, 'support': 110310}, '2': {'precision': 0.5017643333232802, 'recall': 0.49631574237045434, 'f1-score': 0.49902516572182737, 'support': 33521}, 'accuracy': 0.6521533870251617, 'macro avg': {'precision': 0.5777874422506323, 'recall': 0.5828705595679434, 'f1-score': 0.5800749362671866, 'support': 177929}, 'weighted avg': {'precision': 0.6558454544775929, 'recall': 0.6521533870251617, 'f1-score': 0.6538192515478618, 'support': 177929}}
[[17333 12390  4375]
 [16098 82067 12145]
 [ 3280 13604 16637]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8864425
{'0': {'precision': 0.497615751422858, 'recall': 0.4530600812287008, 'f1-score': 0.47429381292151307, 'support': 42842}, '1': {'precision': 0.6428516928946113, 'recall': 0.7247946148221429, 'f1-score': 0.6813683369893755, 'support': 92996}, '2': {'precision': 0.5244034866316438, 'recall': 0.4245088023567984, 'f1-score': 0.4691980463210966, 'support': 42091}, 'accuracy': 0.5883301766434926, 'macro avg': {'precision': 0.5549569769830377, 'recall': 0.5341211661358807, 'f1-score': 0.5416200654106617, 'support': 177929}, 'weighted avg': {'precision': 0.5798613897155488, 'recall': 0.5883301766434926, 'f1-score': 0.5813174938742347, 'support': 177929}}
[[19410 17964  5468]
 [14856 67403 10737]
 [ 4740 19483 17868]]
training model: results/AAL/W7/deepVOL_L3/seq2seq
Epoch 1/50
2013/2013 - 90s - loss: 12.2514 - accuracy10: 0.3865 - accuracy20: 0.4106 - accuracy30: 0.4261 - accuracy50: 0.4383 - val_loss: 12.2016 - val_accuracy10: 0.6203 - val_accuracy20: 0.5767 - val_accuracy30: 0.5432 - val_accuracy50: 0.4867 - 90s/epoch - 45ms/step
Epoch 2/50
2013/2013 - 82s - loss: 11.7009 - accuracy10: 0.3677 - accuracy20: 0.4030 - accuracy30: 0.4275 - accuracy50: 0.4478 - val_loss: 11.0798 - val_accuracy10: 0.5837 - val_accuracy20: 0.5718 - val_accuracy30: 0.5533 - val_accuracy50: 0.5170 - 82s/epoch - 41ms/step
Epoch 3/50
2013/2013 - 83s - loss: 10.8370 - accuracy10: 0.5466 - accuracy20: 0.5460 - accuracy30: 0.5370 - accuracy50: 0.5193 - val_loss: 10.6941 - val_accuracy10: 0.6935 - val_accuracy20: 0.6619 - val_accuracy30: 0.6273 - val_accuracy50: 0.5664 - 83s/epoch - 41ms/step
Epoch 4/50
2013/2013 - 83s - loss: 10.3031 - accuracy10: 0.6104 - accuracy20: 0.5984 - accuracy30: 0.5782 - accuracy50: 0.5460 - val_loss: 10.3597 - val_accuracy10: 0.6696 - val_accuracy20: 0.6441 - val_accuracy30: 0.6139 - val_accuracy50: 0.5614 - 83s/epoch - 41ms/step
Epoch 5/50
2013/2013 - 83s - loss: 10.0493 - accuracy10: 0.6230 - accuracy20: 0.6074 - accuracy30: 0.5868 - accuracy50: 0.5552 - val_loss: 10.1411 - val_accuracy10: 0.7070 - val_accuracy20: 0.6714 - val_accuracy30: 0.6351 - val_accuracy50: 0.5727 - 83s/epoch - 41ms/step
Epoch 6/50
2013/2013 - 83s - loss: 9.8912 - accuracy10: 0.6316 - accuracy20: 0.6145 - accuracy30: 0.5932 - accuracy50: 0.5596 - val_loss: 10.0449 - val_accuracy10: 0.7015 - val_accuracy20: 0.6673 - val_accuracy30: 0.6346 - val_accuracy50: 0.5749 - 83s/epoch - 41ms/step
Epoch 7/50
2013/2013 - 83s - loss: 9.7880 - accuracy10: 0.6365 - accuracy20: 0.6202 - accuracy30: 0.5997 - accuracy50: 0.5650 - val_loss: 10.0251 - val_accuracy10: 0.6976 - val_accuracy20: 0.6639 - val_accuracy30: 0.6306 - val_accuracy50: 0.5711 - 83s/epoch - 41ms/step
Epoch 8/50
2013/2013 - 83s - loss: 9.6929 - accuracy10: 0.6436 - accuracy20: 0.6265 - accuracy30: 0.6050 - accuracy50: 0.5684 - val_loss: 9.9422 - val_accuracy10: 0.7077 - val_accuracy20: 0.6722 - val_accuracy30: 0.6369 - val_accuracy50: 0.5765 - 83s/epoch - 41ms/step
Epoch 9/50
2013/2013 - 83s - loss: 9.6101 - accuracy10: 0.6489 - accuracy20: 0.6306 - accuracy30: 0.6092 - accuracy50: 0.5716 - val_loss: 9.8158 - val_accuracy10: 0.7157 - val_accuracy20: 0.6785 - val_accuracy30: 0.6419 - val_accuracy50: 0.5795 - 83s/epoch - 41ms/step
Epoch 10/50
2013/2013 - 85s - loss: 9.5592 - accuracy10: 0.6518 - accuracy20: 0.6335 - accuracy30: 0.6113 - accuracy50: 0.5737 - val_loss: 9.9447 - val_accuracy10: 0.6973 - val_accuracy20: 0.6598 - val_accuracy30: 0.6261 - val_accuracy50: 0.5677 - 85s/epoch - 42ms/step
Epoch 11/50
2013/2013 - 84s - loss: 9.5144 - accuracy10: 0.6543 - accuracy20: 0.6349 - accuracy30: 0.6127 - accuracy50: 0.5753 - val_loss: 9.8238 - val_accuracy10: 0.6966 - val_accuracy20: 0.6604 - val_accuracy30: 0.6269 - val_accuracy50: 0.5689 - 84s/epoch - 42ms/step
Epoch 12/50
2013/2013 - 84s - loss: 9.4783 - accuracy10: 0.6564 - accuracy20: 0.6370 - accuracy30: 0.6152 - accuracy50: 0.5771 - val_loss: 9.6294 - val_accuracy10: 0.7174 - val_accuracy20: 0.6774 - val_accuracy30: 0.6420 - val_accuracy50: 0.5789 - 84s/epoch - 42ms/step
Epoch 13/50
2013/2013 - 84s - loss: 9.4491 - accuracy10: 0.6568 - accuracy20: 0.6375 - accuracy30: 0.6153 - accuracy50: 0.5773 - val_loss: 9.7069 - val_accuracy10: 0.7165 - val_accuracy20: 0.6760 - val_accuracy30: 0.6394 - val_accuracy50: 0.5775 - 84s/epoch - 42ms/step
Epoch 14/50
2013/2013 - 83s - loss: 9.4213 - accuracy10: 0.6587 - accuracy20: 0.6388 - accuracy30: 0.6166 - accuracy50: 0.5789 - val_loss: 9.7240 - val_accuracy10: 0.7238 - val_accuracy20: 0.6812 - val_accuracy30: 0.6447 - val_accuracy50: 0.5817 - 83s/epoch - 41ms/step
Epoch 15/50
2013/2013 - 83s - loss: 9.3912 - accuracy10: 0.6602 - accuracy20: 0.6409 - accuracy30: 0.6183 - accuracy50: 0.5797 - val_loss: 9.9090 - val_accuracy10: 0.7100 - val_accuracy20: 0.6695 - val_accuracy30: 0.6335 - val_accuracy50: 0.5724 - 83s/epoch - 41ms/step
Epoch 16/50
2013/2013 - 84s - loss: 9.3658 - accuracy10: 0.6610 - accuracy20: 0.6414 - accuracy30: 0.6188 - accuracy50: 0.5804 - val_loss: 9.7537 - val_accuracy10: 0.7141 - val_accuracy20: 0.6729 - val_accuracy30: 0.6365 - val_accuracy50: 0.5748 - 84s/epoch - 42ms/step
Epoch 17/50
2013/2013 - 83s - loss: 9.3490 - accuracy10: 0.6628 - accuracy20: 0.6428 - accuracy30: 0.6192 - accuracy50: 0.5806 - val_loss: 9.7904 - val_accuracy10: 0.7154 - val_accuracy20: 0.6763 - val_accuracy30: 0.6394 - val_accuracy50: 0.5781 - 83s/epoch - 41ms/step
Epoch 18/50
2013/2013 - 83s - loss: 9.3167 - accuracy10: 0.6634 - accuracy20: 0.6443 - accuracy30: 0.6207 - accuracy50: 0.5824 - val_loss: 9.7839 - val_accuracy10: 0.7046 - val_accuracy20: 0.6665 - val_accuracy30: 0.6307 - val_accuracy50: 0.5703 - 83s/epoch - 41ms/step
Epoch 19/50
2013/2013 - 83s - loss: 9.3045 - accuracy10: 0.6645 - accuracy20: 0.6448 - accuracy30: 0.6217 - accuracy50: 0.5827 - val_loss: 9.8367 - val_accuracy10: 0.7029 - val_accuracy20: 0.6657 - val_accuracy30: 0.6301 - val_accuracy50: 0.5699 - 83s/epoch - 41ms/step
Epoch 20/50
2013/2013 - 83s - loss: 9.2837 - accuracy10: 0.6640 - accuracy20: 0.6448 - accuracy30: 0.6215 - accuracy50: 0.5834 - val_loss: 9.8861 - val_accuracy10: 0.7087 - val_accuracy20: 0.6699 - val_accuracy30: 0.6334 - val_accuracy50: 0.5720 - 83s/epoch - 41ms/step
Epoch 21/50
2013/2013 - 84s - loss: 9.2618 - accuracy10: 0.6652 - accuracy20: 0.6461 - accuracy30: 0.6231 - accuracy50: 0.5845 - val_loss: 9.7890 - val_accuracy10: 0.7021 - val_accuracy20: 0.6631 - val_accuracy30: 0.6288 - val_accuracy50: 0.5691 - 84s/epoch - 42ms/step
Epoch 22/50
2013/2013 - 83s - loss: 9.2426 - accuracy10: 0.6655 - accuracy20: 0.6463 - accuracy30: 0.6232 - accuracy50: 0.5848 - val_loss: 9.8443 - val_accuracy10: 0.7037 - val_accuracy20: 0.6653 - val_accuracy30: 0.6300 - val_accuracy50: 0.5698 - 83s/epoch - 41ms/step
testing model: results/AAL/W7/deepVOL_L3/seq2seq
Evaluating performance on  test set...
5331/5331 - 92s - 92s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6541159
{'0': {'precision': 0.36077768791588927, 'recall': 0.6174116808726395, 'f1-score': 0.4554299317183622, 'support': 145948}, '1': {'precision': 0.9178523942309468, 'recall': 0.7427378606319289, 'f1-score': 0.8210619346592287, 'support': 1070690}, '2': {'precision': 0.3927116542685087, 'recall': 0.6593249891868512, 'f1-score': 0.4922349593331854, 'support': 147968}, 'accuracy': 0.72028922634079, 'macro avg': {'precision': 0.5571139121384483, 'recall': 0.67315817689714, 'f1-score': 0.5895756085702588, 'support': 1364606}, 'weighted avg': {'precision': 0.8013294093928088, 'recall': 0.72028922634079, 'f1-score': 0.7463010663571272, 'support': 1364606}}
[[ 90110  31108  24730]
 [149313 795242 126135]
 [ 10343  40066  97559]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7192457
{'0': {'precision': 0.40897311646721723, 'recall': 0.5881619214026724, 'f1-score': 0.4824670778739287, 'support': 198022}, '1': {'precision': 0.858995715298542, 'recall': 0.7211851308950387, 'f1-score': 0.7840810611875558, 'support': 966003}, '2': {'precision': 0.44753103643269826, 'recall': 0.5997327762848924, 'f1-score': 0.5125719569302354, 'support': 200581}, 'accuracy': 0.6840296759650771, 'macro avg': {'precision': 0.5718332893994859, 'recall': 0.6363599428608678, 'f1-score': 0.59304003199724, 'support': 1364606}, 'weighted avg': {'precision': 0.733211150510342, 'recall': 0.6840296759650771, 'f1-score': 0.7004043282369689, 'support': 1364606}}
[[116469  49098  32455]
 [153289 696667 116047]
 [ 15026  65260 120295]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7786397
{'0': {'precision': 0.4313202617702867, 'recall': 0.5696888026900747, 'f1-score': 0.49094125563458246, 'support': 238209}, '1': {'precision': 0.8053520345994342, 'recall': 0.6962165094686159, 'f1-score': 0.7468182316915338, 'support': 884765}, '2': {'precision': 0.47119542914864737, 'recall': 0.5559818235995232, 'f1-score': 0.5100893604661096, 'support': 241632}, 'accuracy': 0.6492980391409682, 'macro avg': {'precision': 0.5692892418394561, 'recall': 0.6072957119194046, 'f1-score': 0.5826162825974087, 'support': 1364606}, 'weighted avg': {'precision': 0.6808907150228363, 'recall': 0.6492980391409682, 'f1-score': 0.6602339214939442, 'support': 1364606}}
[[135705  63460  39044]
 [157053 615988 111724]
 [ 21869  85420 134343]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.86711806
{'0': {'precision': 0.4506164715370205, 'recall': 0.5371427999212249, 'f1-score': 0.4900898431551698, 'support': 299587}, '1': {'precision': 0.7125746945381765, 'recall': 0.6481472718430011, 'f1-score': 0.6788357293556037, 'support': 760770}, '2': {'precision': 0.48343623616516856, 'recall': 0.5013262163556823, 'f1-score': 0.4922187244355449, 'support': 304249}, 'accuracy': 0.5910423961201988, 'macro avg': {'precision': 0.5488758007467885, 'recall': 0.5622054293733028, 'f1-score': 0.5537147656487728, 'support': 1364606}, 'weighted avg': {'precision': 0.6039760037983024, 'recall': 0.5910423961201988, 'f1-score': 0.5957906226075369, 'support': 1364606}}
[[160921  85606  53060]
 [157759 493091 109920]
 [ 38433 113288 152528]]
Evaluating performance on  train set...
2013/2013 - 35s - 35s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.70693165
{'0': {'precision': 0.36675783831411995, 'recall': 0.5967325239311262, 'f1-score': 0.45429895119802177, 'support': 66963}, '1': {'precision': 0.899554223911137, 'recall': 0.7073907864628501, 'f1-score': 0.7919827571080137, 'support': 382828}, '2': {'precision': 0.40550934366453967, 'recall': 0.6517757665481296, 'f1-score': 0.49996195114527064, 'support': 65521}, 'accuracy': 0.6859397801720123, 'macro avg': {'precision': 0.5572738019632656, 'recall': 0.651966358980702, 'f1-score': 0.582081219817102, 'support': 515312}, 'weighted avg': {'precision': 0.7675022651611557, 'recall': 0.6859397801720123, 'f1-score': 0.7109719987273905, 'support': 515312}}
[[ 39959  13300  13704]
 [ 63116 270809  48903]
 [  5877  16939  42705]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7647544
{'0': {'precision': 0.4149716887321976, 'recall': 0.5709520578923564, 'f1-score': 0.48062325399884825, 'support': 88440}, '1': {'precision': 0.8328310355883296, 'recall': 0.6871048803068377, 'f1-score': 0.7529821001521849, 'support': 340245}, '2': {'precision': 0.45931154190171714, 'recall': 0.5987163355535803, 'f1-score': 0.5198300141320799, 'support': 86627}, 'accuracy': 0.6523116092774862, 'macro avg': {'precision': 0.5690380887407481, 'recall': 0.6189244245842581, 'f1-score': 0.584478456094371, 'support': 515312}, 'weighted avg': {'precision': 0.6983254276934107, 'recall': 0.6523116092774862, 'f1-score': 0.667044489327161, 'support': 515312}}
[[ 50495  20461  17484]
 [ 62891 233784  43570]
 [  8297  26465  51865]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8167323
{'0': {'precision': 0.44005640685328185, 'recall': 0.5561697625878025, 'f1-score': 0.4913463926813763, 'support': 104923}, '1': {'precision': 0.7736244654068974, 'recall': 0.6633581929426452, 'f1-score': 0.7142607106726923, 'support': 307594}, '2': {'precision': 0.4839683233573206, 'recall': 0.5600369667785398, 'f1-score': 0.5192313762982138, 'support': 102795}, 'accuracy': 0.6209228583848232, 'macro avg': {'precision': 0.5658830652058333, 'recall': 0.5931883074363292, 'f1-score': 0.5749461598840941, 'support': 515312}, 'weighted avg': {'precision': 0.647925540232232, 'recall': 0.6209228583848232, 'f1-score': 0.629968321957453, 'support': 515312}}
[[ 58355  25945  20623]
 [ 62789 204045  40760]
 [ 11464  33762  57569]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8940095
{'0': {'precision': 0.4649585328029128, 'recall': 0.5295987957729171, 'f1-score': 0.49517804953360284, 'support': 130208}, '1': {'precision': 0.6694185575364667, 'recall': 0.6154407313703882, 'f1-score': 0.6412958215738442, 'support': 257708}, '2': {'precision': 0.5006842259021788, 'recall': 0.5112091431442117, 'f1-score': 0.5058919485765332, 'support': 127396}, 'accuracy': 0.5679821156891359, 'macro avg': {'precision': 0.5450204387471861, 'recall': 0.5520828900958391, 'f1-score': 0.5474552732279935, 'support': 515312}, 'weighted avg': {'precision': 0.576041322359742, 'recall': 0.5679821156891359, 'f1-score': 0.5709003821775539, 'support': 515312}}
[[ 68958  34472  26778]
 [ 60934 158604  38170]
 [ 18418  43852  65126]]
Evaluating performance on  val set...
696/696 - 12s - 12s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.65559816
{'0': {'precision': 0.3783815095869779, 'recall': 0.6080804319493577, 'f1-score': 0.46648812712015714, 'support': 21484}, '1': {'precision': 0.9037419836871926, 'recall': 0.7490618756588987, 'f1-score': 0.8191639456604991, 'support': 135643}, '2': {'precision': 0.41632231404958675, 'recall': 0.619940390347082, 'f1-score': 0.49812661748232834, 'support': 20802}, 'accuracy': 0.7169432751265954, 'macro avg': {'precision': 0.5661486024412524, 'recall': 0.6590275659851127, 'f1-score': 0.5945928967543281, 'support': 177929}, 'weighted avg': {'precision': 0.7833223309416002, 'recall': 0.7169432751265954, 'f1-score': 0.7390471249832459, 'support': 177929}}
[[ 13064   4849   3571]
 [ 19529 101605  14509]
 [  1933   5973  12896]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7298105
{'0': {'precision': 0.4188224456897213, 'recall': 0.5739532926572691, 'f1-score': 0.4842675187502774, 'support': 28518}, '1': {'precision': 0.836541919851591, 'recall': 0.7276379592811216, 'f1-score': 0.7782987922737219, 'support': 121467}, '2': {'precision': 0.4743929625835994, 'recall': 0.5635198969367307, 'f1-score': 0.5151297065654749, 'support': 27944}, 'accuracy': 0.6772308055460324, 'macro avg': {'precision': 0.5765857760416372, 'recall': 0.6217037162917071, 'f1-score': 0.5925653391964913, 'support': 177929}, 'weighted avg': {'precision': 0.712714919047647, 'recall': 0.6772308055460324, 'f1-score': 0.6898411446200351, 'support': 177929}}
[[16368  7596  4554]
 [20190 88384 12893]
 [ 2523  9674 15747]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.79212373
{'0': {'precision': 0.4406475658047985, 'recall': 0.5547832717461435, 'f1-score': 0.4911720413356183, 'support': 34098}, '1': {'precision': 0.7757940668404077, 'recall': 0.7043332426797208, 'f1-score': 0.7383385837621578, 'support': 110310}, '2': {'precision': 0.5015208034433285, 'recall': 0.5214044927060648, 'f1-score': 0.5112693978441152, 'support': 33521}, 'accuracy': 0.6412108200461982, 'macro avg': {'precision': 0.572654145362845, 'recall': 0.5935070023773097, 'f1-score': 0.5802600076472971, 'support': 177929}, 'weighted avg': {'precision': 0.659895368738099, 'recall': 0.6412108200461982, 'f1-score': 0.6481932395809459, 'support': 177929}}
[[18917  9854  5327]
 [20570 77695 12045]
 [ 3443 12600 17478]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8845839
{'0': {'precision': 0.46108881341977975, 'recall': 0.5228980906586994, 'f1-score': 0.4900521727717195, 'support': 42842}, '1': {'precision': 0.6691777967848762, 'recall': 0.6562110198288098, 'f1-score': 0.6626309788805038, 'support': 92996}, '2': {'precision': 0.5145740498034076, 'recall': 0.4663942410491554, 'f1-score': 0.489300980795354, 'support': 42091}, 'accuracy': 0.5792085607180392, 'macro avg': {'precision': 0.5482802200026878, 'recall': 0.5485011171788883, 'f1-score': 0.5473280441491924, 'support': 177929}, 'weighted avg': {'precision': 0.5825006697312511, 'recall': 0.5792085607180392, 'f1-score': 0.580074149129791, 'support': 177929}}
[[22402 13381  7059]
 [20511 61025 11460]
 [ 5672 16788 19631]]
training model: results/AAL/W8/deepLOB_L1/seq2seq
Epoch 1/50
1814/1814 - 52s - loss: 11.1313 - accuracy10: 0.4881 - accuracy20: 0.5009 - accuracy30: 0.5071 - accuracy50: 0.5112 - val_loss: 13.6716 - val_accuracy10: 0.4294 - val_accuracy20: 0.4293 - val_accuracy30: 0.4292 - val_accuracy50: 0.4250 - 52s/epoch - 29ms/step
Epoch 2/50
1814/1814 - 49s - loss: 10.9010 - accuracy10: 0.5027 - accuracy20: 0.5194 - accuracy30: 0.5305 - accuracy50: 0.5382 - val_loss: 10.5881 - val_accuracy10: 0.7487 - val_accuracy20: 0.7171 - val_accuracy30: 0.6923 - val_accuracy50: 0.6434 - 49s/epoch - 27ms/step
Epoch 3/50
1814/1814 - 48s - loss: 10.7156 - accuracy10: 0.5261 - accuracy20: 0.5402 - accuracy30: 0.5452 - accuracy50: 0.5475 - val_loss: 10.3501 - val_accuracy10: 0.7791 - val_accuracy20: 0.7456 - val_accuracy30: 0.7153 - val_accuracy50: 0.6579 - 48s/epoch - 26ms/step
Epoch 4/50
1814/1814 - 44s - loss: 10.4187 - accuracy10: 0.5629 - accuracy20: 0.5622 - accuracy30: 0.5582 - accuracy50: 0.5530 - val_loss: 9.7367 - val_accuracy10: 0.7917 - val_accuracy20: 0.7559 - val_accuracy30: 0.7255 - val_accuracy50: 0.6708 - 44s/epoch - 24ms/step
Epoch 5/50
1814/1814 - 47s - loss: 10.1585 - accuracy10: 0.5930 - accuracy20: 0.5851 - accuracy30: 0.5734 - accuracy50: 0.5612 - val_loss: 9.5020 - val_accuracy10: 0.7613 - val_accuracy20: 0.7312 - val_accuracy30: 0.7008 - val_accuracy50: 0.6561 - 47s/epoch - 26ms/step
Epoch 6/50
1814/1814 - 47s - loss: 9.9401 - accuracy10: 0.6067 - accuracy20: 0.5972 - accuracy30: 0.5835 - accuracy50: 0.5692 - val_loss: 9.5642 - val_accuracy10: 0.7660 - val_accuracy20: 0.7334 - val_accuracy30: 0.7041 - val_accuracy50: 0.6599 - 47s/epoch - 26ms/step
Epoch 7/50
1814/1814 - 49s - loss: 9.8319 - accuracy10: 0.6169 - accuracy20: 0.6069 - accuracy30: 0.5909 - accuracy50: 0.5744 - val_loss: 9.4078 - val_accuracy10: 0.7505 - val_accuracy20: 0.7222 - val_accuracy30: 0.6933 - val_accuracy50: 0.6517 - 49s/epoch - 27ms/step
Epoch 8/50
1814/1814 - 46s - loss: 9.6326 - accuracy10: 0.6320 - accuracy20: 0.6210 - accuracy30: 0.6027 - accuracy50: 0.5842 - val_loss: 9.8039 - val_accuracy10: 0.7922 - val_accuracy20: 0.7546 - val_accuracy30: 0.7199 - val_accuracy50: 0.6656 - 46s/epoch - 26ms/step
Epoch 9/50
1814/1814 - 44s - loss: 9.5093 - accuracy10: 0.6423 - accuracy20: 0.6284 - accuracy30: 0.6084 - accuracy50: 0.5879 - val_loss: 9.8126 - val_accuracy10: 0.7820 - val_accuracy20: 0.7439 - val_accuracy30: 0.7099 - val_accuracy50: 0.6585 - 44s/epoch - 24ms/step
Epoch 10/50
1814/1814 - 44s - loss: 9.4434 - accuracy10: 0.6476 - accuracy20: 0.6333 - accuracy30: 0.6136 - accuracy50: 0.5930 - val_loss: 9.7064 - val_accuracy10: 0.8056 - val_accuracy20: 0.7672 - val_accuracy30: 0.7304 - val_accuracy50: 0.6762 - 44s/epoch - 24ms/step
Epoch 11/50
1814/1814 - 45s - loss: 9.3423 - accuracy10: 0.6560 - accuracy20: 0.6394 - accuracy30: 0.6182 - accuracy50: 0.5964 - val_loss: 9.7460 - val_accuracy10: 0.8068 - val_accuracy20: 0.7682 - val_accuracy30: 0.7315 - val_accuracy50: 0.6759 - 45s/epoch - 25ms/step
Epoch 12/50
1814/1814 - 44s - loss: 9.2924 - accuracy10: 0.6589 - accuracy20: 0.6422 - accuracy30: 0.6212 - accuracy50: 0.5991 - val_loss: 9.8798 - val_accuracy10: 0.8047 - val_accuracy20: 0.7632 - val_accuracy30: 0.7259 - val_accuracy50: 0.6698 - 44s/epoch - 24ms/step
Epoch 13/50
1814/1814 - 44s - loss: 9.2602 - accuracy10: 0.6598 - accuracy20: 0.6424 - accuracy30: 0.6217 - accuracy50: 0.6003 - val_loss: 9.8270 - val_accuracy10: 0.8127 - val_accuracy20: 0.7711 - val_accuracy30: 0.7331 - val_accuracy50: 0.6760 - 44s/epoch - 24ms/step
Epoch 14/50
1814/1814 - 45s - loss: 9.2120 - accuracy10: 0.6648 - accuracy20: 0.6464 - accuracy30: 0.6253 - accuracy50: 0.6032 - val_loss: 9.8896 - val_accuracy10: 0.8028 - val_accuracy20: 0.7620 - val_accuracy30: 0.7255 - val_accuracy50: 0.6706 - 45s/epoch - 25ms/step
Epoch 15/50
1814/1814 - 47s - loss: 9.1715 - accuracy10: 0.6680 - accuracy20: 0.6487 - accuracy30: 0.6273 - accuracy50: 0.6048 - val_loss: 9.8147 - val_accuracy10: 0.8079 - val_accuracy20: 0.7686 - val_accuracy30: 0.7302 - val_accuracy50: 0.6746 - 47s/epoch - 26ms/step
Epoch 16/50
1814/1814 - 46s - loss: 9.1201 - accuracy10: 0.6712 - accuracy20: 0.6519 - accuracy30: 0.6301 - accuracy50: 0.6063 - val_loss: 9.7738 - val_accuracy10: 0.8033 - val_accuracy20: 0.7652 - val_accuracy30: 0.7279 - val_accuracy50: 0.6734 - 46s/epoch - 25ms/step
Epoch 17/50
1814/1814 - 46s - loss: 9.0825 - accuracy10: 0.6738 - accuracy20: 0.6548 - accuracy30: 0.6330 - accuracy50: 0.6087 - val_loss: 9.8318 - val_accuracy10: 0.8013 - val_accuracy20: 0.7644 - val_accuracy30: 0.7287 - val_accuracy50: 0.6746 - 46s/epoch - 25ms/step
testing model: results/AAL/W8/deepLOB_L1/seq2seq
Evaluating performance on  test set...
5918/5918 - 60s - 60s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.569733
{'0': {'precision': 0.34951766369779336, 'recall': 0.527778628291488, 'f1-score': 0.42053740519473387, 'support': 130640}, '1': {'precision': 0.9110528328689286, 'recall': 0.8103946907167213, 'f1-score': 0.8577808717416575, 'support': 1255160}, '2': {'precision': 0.3401240211471956, 'recall': 0.5297814376818772, 'f1-score': 0.41427810593589615, 'support': 129208}, 'accuracy': 0.762092345386955, 'macro avg': {'precision': 0.5335648392379725, 'recall': 0.6226515855633622, 'f1-score': 0.5641987942907626, 'support': 1515008}, 'weighted avg': {'precision': 0.8139394681834228, 'recall': 0.762092345386955, 'f1-score': 0.7822528271148826, 'support': 1515008}}
[[  68949   49354   12337]
 [ 117518 1017175  120467]
 [  10802   49954   68452]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.63490194
{'0': {'precision': 0.4219533757423174, 'recall': 0.491432856199568, 'f1-score': 0.45405053278116425, 'support': 178706}, '1': {'precision': 0.8613930897531843, 'recall': 0.8020210452242933, 'f1-score': 0.8306474877973626, 'support': 1159598}, '2': {'precision': 0.391947324871041, 'recall': 0.503961427019196, 'f1-score': 0.4409518999376096, 'support': 176704}, 'accuracy': 0.730620564379858, 'macro avg': {'precision': 0.5584312634555142, 'recall': 0.5991384428143524, 'f1-score': 0.5752166401720455, 'support': 1515008}, 'weighted avg': {'precision': 0.7548039113661658, 'recall': 0.730620564379858, 'f1-score': 0.74077277782864, 'support': 1515008}}
[[ 87822  75173  15711]
 [107135 930022 122441]
 [ 13175  74477  89052]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.69887114
{'0': {'precision': 0.4560436390105769, 'recall': 0.47409171027011066, 'f1-score': 0.46489257492155495, 'support': 216726}, '1': {'precision': 0.8170844682484805, 'recall': 0.7888671588655268, 'f1-score': 0.8027279179992016, 'support': 1084521}, '2': {'precision': 0.42237169104464695, 'recall': 0.47942795926291515, 'f1-score': 0.4490948689520988, 'support': 213761}, 'accuracy': 0.7001771607806692, 'macro avg': {'precision': 0.5651665994345682, 'recall': 0.5807956094661842, 'f1-score': 0.5722384539576185, 'support': 1515008}, 'weighted avg': {'precision': 0.7097443533941149, 'recall': 0.7001771607806692, 'f1-score': 0.7045035807275808, 'support': 1515008}}
[[102748  94743  19235]
 [108059 855543 120919]
 [ 14496  96782 102483]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.791718
{'0': {'precision': 0.5022833017404791, 'recall': 0.41555580901327327, 'f1-score': 0.4548220736360019, 'support': 280564}, '1': {'precision': 0.7274685247625824, 'recall': 0.7854118418155043, 'f1-score': 0.7553305687863814, 'support': 958147}, '2': {'precision': 0.46521270086626093, 'recall': 0.41828177649413495, 'f1-score': 0.4405007613569878, 'support': 276297}, 'accuracy': 0.6499635645488341, 'macro avg': {'precision': 0.5649881757897741, 'recall': 0.5397498091076375, 'f1-score': 0.5502178012597904, 'support': 1515008}, 'weighted avg': {'precision': 0.6379380640078832, 'recall': 0.6499635645488341, 'f1-score': 0.642262917172205, 'support': 1515008}}
[[116590 138991  24983]
 [ 97736 752540 107871]
 [ 17794 142933 115570]]
Evaluating performance on  train set...
1814/1814 - 17s - 17s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.63279957
{'0': {'precision': 0.3213502459842333, 'recall': 0.4480023137627567, 'f1-score': 0.3742514453360946, 'support': 48406}, '1': {'precision': 0.8627931581731617, 'recall': 0.7990908719735428, 'f1-score': 0.8297211172268583, 'support': 367385}, '2': {'precision': 0.3289997346776333, 'recall': 0.3836000659957103, 'f1-score': 0.35420812583910194, 'support': 48488}, 'accuracy': 0.7190934761210392, 'macro avg': {'precision': 0.5043810462783428, 'recall': 0.5435644172440033, 'f1-score': 0.5193935628006849, 'support': 464279}, 'weighted avg': {'precision': 0.7505941116389259, 'recall': 0.7190934761210392, 'f1-score': 0.7325723362913564, 'support': 464279}}
[[ 21686  21654   5066]
 [ 40942 293574  32869]
 [  4856  25032  18600]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7035271
{'0': {'precision': 0.38397610520347913, 'recall': 0.43336714787358566, 'f1-score': 0.40717930670420555, 'support': 64075}, '1': {'precision': 0.8111111787553726, 'recall': 0.7926153095644621, 'f1-score': 0.8017565872020075, 'support': 336182}, '2': {'precision': 0.38659647574315165, 'recall': 0.3831183030833151, 'f1-score': 0.3848495308626479, 'support': 64022}, 'accuracy': 0.6865677749801304, 'macro avg': {'precision': 0.5272279199006679, 'recall': 0.5363669201737876, 'f1-score': 0.5312618082562869, 'support': 464279}, 'weighted avg': {'precision': 0.6936237193740825, 'recall': 0.6865677749801304, 'f1-score': 0.6898114791767573, 'support': 464279}}
[[ 27768  29182   7125]
 [ 37926 266463  31793]
 [  6623  32871  24528]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7628045
{'0': {'precision': 0.4118240643802268, 'recall': 0.43018077369031305, 'f1-score': 0.420802319961334, 'support': 75896}, '1': {'precision': 0.769871699639975, 'recall': 0.7792064035421672, 'f1-score': 0.7745109262509857, 'support': 312577}, '2': {'precision': 0.4176707997610479, 'recall': 0.37814948684800676, 'f1-score': 0.3969288073165834, 'support': 75806}, 'accuracy': 0.6566676502706347, 'macro avg': {'precision': 0.5331221879270832, 'recall': 0.529178888026829, 'f1-score': 0.5307473511763011, 'support': 464279}, 'weighted avg': {'precision': 0.6538351682829767, 'recall': 0.6566676502706347, 'f1-score': 0.6550395340689127, 'support': 464279}}
[[ 32649  34155   9092]
 [ 38140 243562  30875]
 [  8490  38650  28666]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8456227
{'0': {'precision': 0.45054446460980035, 'recall': 0.38977530712270053, 'f1-score': 0.4179625732324669, 'support': 94262}, '1': {'precision': 0.6890718582073282, 'recall': 0.7811462986453627, 'f1-score': 0.7322259339955469, 'support': 275129}, '2': {'precision': 0.4563023193438643, 'recall': 0.34065424500463704, 'f1-score': 0.3900873122665589, 'support': 94888}, 'accuracy': 0.6116602301633285, 'macro avg': {'precision': 0.5319728807203309, 'recall': 0.5038586169242334, 'f1-score': 0.5134252731648575, 'support': 464279}, 'weighted avg': {'precision': 0.5930711664272422, 'recall': 0.6116602301633285, 'f1-score': 0.5984961240087293, 'support': 464279}}
[[ 36741  45755  11766]
 [ 33464 214916  26749]
 [ 11343  51221  32324]]
Evaluating performance on  val set...
636/636 - 6s - 6s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5766699
{'0': {'precision': 0.2956371082060167, 'recall': 0.5595885816501454, 'f1-score': 0.3868806843068044, 'support': 13417}, '1': {'precision': 0.9116599761492853, 'recall': 0.7981457109455992, 'f1-score': 0.8511347286961498, 'support': 136009}, '2': {'precision': 0.33678500986193294, 'recall': 0.46231949458483756, 'f1-score': 0.38969189806009885, 'support': 13296}, 'accuracy': 0.7510355084131217, 'macro avg': {'precision': 0.514694031405745, 'recall': 0.6066845957268607, 'f1-score': 0.5425691036876844, 'support': 162722}, 'weighted avg': {'precision': 0.8138937468075154, 'recall': 0.7510355084131217, 'f1-score': 0.7751509011269903, 'support': 162722}}
[[  7508   4738   1171]
 [ 16520 108555  10934]
 [  1368   5781   6147]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.64176553
{'0': {'precision': 0.3605145413870246, 'recall': 0.5326392331845976, 'f1-score': 0.42999132813021146, 'support': 18153}, '1': {'precision': 0.8692739374429025, 'recall': 0.7891037184469086, 'f1-score': 0.8272510111903687, 'support': 126612}, '2': {'precision': 0.38159965660323364, 'recall': 0.44556440385365037, 'f1-score': 0.41110882745863736, 'support': 17957}, 'accuracy': 0.7225820724917343, 'macro avg': {'precision': 0.5371293784777202, 'recall': 0.5891024518283855, 'f1-score': 0.5561170555930726, 'support': 162722}, 'weighted avg': {'precision': 0.758700834988162, 'recall': 0.7225820724917343, 'f1-score': 0.73701047690575, 'support': 162722}}
[[ 9669  6874  1610]
 [15346 99910 11356]
 [ 1805  8151  8001]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.70417154
{'0': {'precision': 0.39049253475201645, 'recall': 0.5172304055282778, 'f1-score': 0.4450137881128865, 'support': 21996}, '1': {'precision': 0.8316305827825319, 'recall': 0.7746327451095675, 'f1-score': 0.802120387201141, 'support': 119059}, '2': {'precision': 0.40792489421720735, 'recall': 0.42714727465731295, 'f1-score': 0.41731484612783226, 'support': 21667}, 'accuracy': 0.693569400572756, 'macro avg': {'precision': 0.5433493372505852, 'recall': 0.573003475098386, 'f1-score': 0.5548163404806199, 'support': 162722}, 'weighted avg': {'precision': 0.7155817162578818, 'recall': 0.693569400572756, 'f1-score': 0.7026101893669169, 'support': 162722}}
[[11377  8511  2108]
 [15507 92227 11325]
 [ 2251 10161  9255]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.78971595
{'0': {'precision': 0.43731983642823624, 'recall': 0.4592397043294615, 'f1-score': 0.4480118123755236, 'support': 28410}, '1': {'precision': 0.7533688785012599, 'recall': 0.7752973673826034, 'f1-score': 0.7641758424937258, 'support': 106434}, '2': {'precision': 0.44926357252954274, 'recall': 0.3763899849343568, 'f1-score': 0.4096108053245891, 'support': 27878}, 'accuracy': 0.6517741915659837, 'macro avg': {'precision': 0.5466507624863463, 'recall': 0.5369756855488071, 'f1-score': 0.5405994867312794, 'support': 162722}, 'weighted avg': {'precision': 0.6460889716344925, 'recall': 0.6517741915659837, 'f1-score': 0.6482309536534994, 'support': 162722}}
[[13047 12562  2801]
 [13854 82518 10062]
 [ 2933 14452 10493]]
training model: results/AAL/W8/deepOF_L1/seq2seq
Epoch 1/50
1814/1814 - 49s - loss: 11.8961 - accuracy10: 0.4636 - accuracy20: 0.4770 - accuracy30: 0.4815 - accuracy50: 0.4837 - val_loss: 11.9501 - val_accuracy10: 0.8001 - val_accuracy20: 0.7619 - val_accuracy30: 0.7274 - val_accuracy50: 0.6606 - 49s/epoch - 27ms/step
Epoch 2/50
1814/1814 - 43s - loss: 11.7448 - accuracy10: 0.4765 - accuracy20: 0.4867 - accuracy30: 0.4935 - accuracy50: 0.4979 - val_loss: 11.2442 - val_accuracy10: 0.7981 - val_accuracy20: 0.7599 - val_accuracy30: 0.7277 - val_accuracy50: 0.6644 - 43s/epoch - 24ms/step
Epoch 3/50
1814/1814 - 43s - loss: 11.6618 - accuracy10: 0.4913 - accuracy20: 0.4977 - accuracy30: 0.5044 - accuracy50: 0.5087 - val_loss: 11.0038 - val_accuracy10: 0.7966 - val_accuracy20: 0.7579 - val_accuracy30: 0.7267 - val_accuracy50: 0.6662 - 43s/epoch - 23ms/step
Epoch 4/50
1814/1814 - 44s - loss: 11.5203 - accuracy10: 0.5161 - accuracy20: 0.5137 - accuracy30: 0.5160 - accuracy50: 0.5169 - val_loss: 10.7564 - val_accuracy10: 0.7893 - val_accuracy20: 0.7524 - val_accuracy30: 0.7232 - val_accuracy50: 0.6666 - 44s/epoch - 24ms/step
Epoch 5/50
1814/1814 - 45s - loss: 11.4122 - accuracy10: 0.5287 - accuracy20: 0.5217 - accuracy30: 0.5214 - accuracy50: 0.5211 - val_loss: 10.6466 - val_accuracy10: 0.7877 - val_accuracy20: 0.7494 - val_accuracy30: 0.7200 - val_accuracy50: 0.6654 - 45s/epoch - 25ms/step
Epoch 6/50
1814/1814 - 44s - loss: 11.3037 - accuracy10: 0.5349 - accuracy20: 0.5278 - accuracy30: 0.5257 - accuracy50: 0.5239 - val_loss: 10.6923 - val_accuracy10: 0.7849 - val_accuracy20: 0.7470 - val_accuracy30: 0.7167 - val_accuracy50: 0.6627 - 44s/epoch - 24ms/step
Epoch 7/50
1814/1814 - 45s - loss: 11.2063 - accuracy10: 0.5399 - accuracy20: 0.5328 - accuracy30: 0.5305 - accuracy50: 0.5283 - val_loss: 10.6440 - val_accuracy10: 0.7727 - val_accuracy20: 0.7362 - val_accuracy30: 0.7090 - val_accuracy50: 0.6584 - 45s/epoch - 25ms/step
Epoch 8/50
1814/1814 - 45s - loss: 11.1193 - accuracy10: 0.5441 - accuracy20: 0.5347 - accuracy30: 0.5318 - accuracy50: 0.5302 - val_loss: 10.5507 - val_accuracy10: 0.7758 - val_accuracy20: 0.7394 - val_accuracy30: 0.7113 - val_accuracy50: 0.6616 - 45s/epoch - 25ms/step
Epoch 9/50
1814/1814 - 44s - loss: 11.0302 - accuracy10: 0.5481 - accuracy20: 0.5387 - accuracy30: 0.5350 - accuracy50: 0.5340 - val_loss: 10.4763 - val_accuracy10: 0.7700 - val_accuracy20: 0.7369 - val_accuracy30: 0.7108 - val_accuracy50: 0.6634 - 44s/epoch - 24ms/step
Epoch 10/50
1814/1814 - 44s - loss: 10.9544 - accuracy10: 0.5527 - accuracy20: 0.5436 - accuracy30: 0.5390 - accuracy50: 0.5369 - val_loss: 10.4184 - val_accuracy10: 0.7666 - val_accuracy20: 0.7352 - val_accuracy30: 0.7099 - val_accuracy50: 0.6631 - 44s/epoch - 24ms/step
Epoch 11/50
1814/1814 - 42s - loss: 10.8787 - accuracy10: 0.5582 - accuracy20: 0.5483 - accuracy30: 0.5433 - accuracy50: 0.5414 - val_loss: 10.5417 - val_accuracy10: 0.7614 - val_accuracy20: 0.7300 - val_accuracy30: 0.7036 - val_accuracy50: 0.6577 - 42s/epoch - 23ms/step
Epoch 12/50
1814/1814 - 42s - loss: 10.8213 - accuracy10: 0.5621 - accuracy20: 0.5511 - accuracy30: 0.5450 - accuracy50: 0.5426 - val_loss: 10.4366 - val_accuracy10: 0.7688 - val_accuracy20: 0.7372 - val_accuracy30: 0.7109 - val_accuracy50: 0.6629 - 42s/epoch - 23ms/step
Epoch 13/50
1814/1814 - 44s - loss: 10.7562 - accuracy10: 0.5665 - accuracy20: 0.5551 - accuracy30: 0.5483 - accuracy50: 0.5451 - val_loss: 10.5623 - val_accuracy10: 0.7639 - val_accuracy20: 0.7309 - val_accuracy30: 0.7043 - val_accuracy50: 0.6583 - 44s/epoch - 24ms/step
Epoch 14/50
1814/1814 - 43s - loss: 10.6975 - accuracy10: 0.5695 - accuracy20: 0.5581 - accuracy30: 0.5509 - accuracy50: 0.5469 - val_loss: 10.5413 - val_accuracy10: 0.7707 - val_accuracy20: 0.7374 - val_accuracy30: 0.7090 - val_accuracy50: 0.6623 - 43s/epoch - 24ms/step
Epoch 15/50
1814/1814 - 46s - loss: 10.6200 - accuracy10: 0.5745 - accuracy20: 0.5625 - accuracy30: 0.5541 - accuracy50: 0.5490 - val_loss: 10.5632 - val_accuracy10: 0.7675 - val_accuracy20: 0.7335 - val_accuracy30: 0.7058 - val_accuracy50: 0.6591 - 46s/epoch - 25ms/step
Epoch 16/50
1814/1814 - 47s - loss: 10.5702 - accuracy10: 0.5771 - accuracy20: 0.5651 - accuracy30: 0.5565 - accuracy50: 0.5511 - val_loss: 10.5471 - val_accuracy10: 0.7657 - val_accuracy20: 0.7319 - val_accuracy30: 0.7051 - val_accuracy50: 0.6588 - 47s/epoch - 26ms/step
Epoch 17/50
1814/1814 - 44s - loss: 10.5308 - accuracy10: 0.5780 - accuracy20: 0.5666 - accuracy30: 0.5580 - accuracy50: 0.5523 - val_loss: 10.4960 - val_accuracy10: 0.7644 - val_accuracy20: 0.7320 - val_accuracy30: 0.7051 - val_accuracy50: 0.6592 - 44s/epoch - 24ms/step
Epoch 18/50
1814/1814 - 47s - loss: 10.4817 - accuracy10: 0.5819 - accuracy20: 0.5695 - accuracy30: 0.5606 - accuracy50: 0.5537 - val_loss: 10.5936 - val_accuracy10: 0.7587 - val_accuracy20: 0.7262 - val_accuracy30: 0.6997 - val_accuracy50: 0.6558 - 47s/epoch - 26ms/step
Epoch 19/50
1814/1814 - 47s - loss: 10.4345 - accuracy10: 0.5823 - accuracy20: 0.5708 - accuracy30: 0.5614 - accuracy50: 0.5553 - val_loss: 10.6145 - val_accuracy10: 0.7578 - val_accuracy20: 0.7250 - val_accuracy30: 0.6981 - val_accuracy50: 0.6542 - 47s/epoch - 26ms/step
Epoch 20/50
1814/1814 - 45s - loss: 10.3843 - accuracy10: 0.5877 - accuracy20: 0.5756 - accuracy30: 0.5654 - accuracy50: 0.5584 - val_loss: 10.6609 - val_accuracy10: 0.7597 - val_accuracy20: 0.7273 - val_accuracy30: 0.6997 - val_accuracy50: 0.6556 - 45s/epoch - 25ms/step
testing model: results/AAL/W8/deepOF_L1/seq2seq
Evaluating performance on  test set...
5918/5918 - 56s - 56s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.66564596
{'0': {'precision': 0.2823578653644925, 'recall': 0.464746362112386, 'f1-score': 0.3512891131271986, 'support': 130639}, '1': {'precision': 0.8999716766936092, 'recall': 0.7771858204305753, 'f1-score': 0.8340841299815184, 'support': 1255158}, '2': {'precision': 0.28451160530395947, 'recall': 0.47577511880253237, 'f1-score': 0.3560855096431499, 'support': 129206}, 'accuracy': 0.7245384992636978, 'macro avg': {'precision': 0.4889470491206871, 'recall': 0.5725691004484978, 'f1-score': 0.5138195842506222, 'support': 1515003}, 'weighted avg': {'precision': 0.7942256255754296, 'recall': 0.7245384992636978, 'f1-score': 0.7516868357541995, 'support': 1515003}}
[[ 60714  55062  14863]
 [139938 975491 139729]
 [ 14373  53360  61473]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.71747094
{'0': {'precision': 0.3499536839105031, 'recall': 0.4397190901205898, 'f1-score': 0.3897343824783198, 'support': 178705}, '1': {'precision': 0.8477631804668752, 'recall': 0.7756263598474298, 'f1-score': 0.8100920368759973, 'support': 1159597}, '2': {'precision': 0.3438024162103053, 'recall': 0.4465962275255941, 'f1-score': 0.38851499382129506, 'support': 176701}, 'accuracy': 0.6976276614633766, 'macro avg': {'precision': 0.5138397601958945, 'recall': 0.5539805591645379, 'f1-score': 0.529447137725204, 'support': 1515003}, 'weighted avg': {'precision': 0.7302641279323214, 'recall': 0.6976276614633766, 'f1-score': 0.7113377111657869, 'support': 1515003}}
[[ 78580  81555  18570]
 [128134 899414 132049]
 [ 17830  79957  78914]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.76222
{'0': {'precision': 0.39789183820873963, 'recall': 0.4066951205444688, 'f1-score': 0.40224531939896635, 'support': 216725}, '1': {'precision': 0.7990564107592556, 'recall': 0.7814553904031276, 'f1-score': 0.7901578956446423, 'support': 1084520}, '2': {'precision': 0.38189064298352604, 'recall': 0.4160031437419886, 'f1-score': 0.398217684333087, 'support': 213758}, 'accuracy': 0.6762818291448928, 'macro avg': {'precision': 0.5262796306505071, 'recall': 0.5347178848965284, 'f1-score': 0.5302069664588985, 'support': 1515003}, 'weighted avg': {'precision': 0.6828091741701433, 'recall': 0.6762818291448928, 'f1-score': 0.679365567988275, 'support': 1515003}}
[[ 88141 107719  20865]
 [113953 847504 123063]
 [ 19426 105408  88924]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8360667
{'0': {'precision': 0.46446035795740076, 'recall': 0.3425991930539912, 'f1-score': 0.39432962200214966, 'support': 280564}, '1': {'precision': 0.7084489655834139, 'recall': 0.8014288025298885, 'f1-score': 0.7520759867211285, 'support': 958145}, '2': {'precision': 0.4340790970533782, 'recall': 0.35216472308482993, 'f1-score': 0.38885480838207287, 'support': 276294}, 'accuracy': 0.6345248161224764, 'macro avg': {'precision': 0.5356628068647309, 'recall': 0.4987309062229032, 'f1-score': 0.5117534723684504, 'support': 1515003}, 'weighted avg': {'precision': 0.6132272609626161, 'recall': 0.6345248161224764, 'f1-score': 0.6195834548125932, 'support': 1515003}}
[[ 96121 159549  24894]
 [ 88300 767885 101960]
 [ 22531 156462  97301]]
Evaluating performance on  train set...
1814/1814 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7390073
{'0': {'precision': 0.2559977390721822, 'recall': 0.5066918040938095, 'f1-score': 0.3401435286918305, 'support': 48268}, '1': {'precision': 0.8682047014903795, 'recall': 0.7354229825124775, 'f1-score': 0.7963166230800399, 'support': 367462}, '2': {'precision': 0.3321270747068444, 'recall': 0.393227181906194, 'f1-score': 0.3601037491157746, 'support': 48547}, 'accuracy': 0.6758616084794207, 'macro avg': {'precision': 0.48544317175646867, 'recall': 0.5451139895041605, 'f1-score': 0.498854633629215, 'support': 464277}, 'weighted avg': {'precision': 0.748502527552274, 'recall': 0.6758616084794207, 'f1-score': 0.7032786536947951, 'support': 464277}}
[[ 24457  19343   4468]
 [ 63302 270240  33920]
 [  7777  21680  19090]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7862172
{'0': {'precision': 0.3145921580859049, 'recall': 0.4888141952630345, 'f1-score': 0.3828127869534876, 'support': 63965}, '1': {'precision': 0.8142481258998163, 'recall': 0.7317175454458932, 'f1-score': 0.7707799094254264, 'support': 336224}, '2': {'precision': 0.38946177262802223, 'recall': 0.38128822868555734, 'f1-score': 0.3853316618176944, 'support': 64088}, 'accuracy': 0.6498792746571551, 'macro avg': {'precision': 0.5061006855379145, 'recall': 0.5339399897981617, 'f1-score': 0.5129747860655361, 'support': 464277}, 'weighted avg': {'precision': 0.6867720678790666, 'recall': 0.6498792746571551, 'f1-score': 0.6641217629275342, 'support': 464277}}
[[ 31267  26579   6119]
 [ 58015 246021  32188]
 [ 10107  29545  24436]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.82370746
{'0': {'precision': 0.35229931423961275, 'recall': 0.46071268430353707, 'f1-score': 0.39927765649823416, 'support': 75826}, '1': {'precision': 0.7670102955519088, 'recall': 0.7371721249852038, 'f1-score': 0.7517952633107233, 'support': 312581}, '2': {'precision': 0.42514220353654014, 'recall': 0.3625280084354817, 'f1-score': 0.3913464137842722, 'support': 75870}, 'accuracy': 0.6307979934392615, 'macro avg': {'precision': 0.5148172711093539, 'recall': 0.5201376059080741, 'f1-score': 0.5141397778644099, 'support': 464277}, 'weighted avg': {'precision': 0.6434129452412276, 'recall': 0.6307979934392615, 'f1-score': 0.6353189910255668, 'support': 464277}}
[[ 34934  33510   7382]
 [ 52346 230426  29809]
 [ 11880  36485  27505]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8851565
{'0': {'precision': 0.404319946000675, 'recall': 0.40671348851025907, 'f1-score': 0.40551318531368674, 'support': 94258}, '1': {'precision': 0.6813947194224429, 'recall': 0.7598248829159031, 'f1-score': 0.7184757438278662, 'support': 275016}, '2': {'precision': 0.47306896002548177, 'recall': 0.31266381061650683, 'f1-score': 0.37649325381987797, 'support': 95003}, 'accuracy': 0.5966351983837235, 'macro avg': {'precision': 0.5195945418161999, 'recall': 0.49306739401422295, 'f1-score': 0.5001607276538103, 'support': 464277}, 'weighted avg': {'precision': 0.5825139088003821, 'recall': 0.5966351983837235, 'f1-score': 0.5849593574062721, 'support': 464277}}
[[ 38336  46936   8986]
 [ 41952 208964  24100]
 [ 14528  50771  29704]]
Evaluating performance on  val set...
636/636 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5977506
{'0': {'precision': 0.2973664409330323, 'recall': 0.4411042488280378, 'f1-score': 0.35524659914903817, 'support': 13439}, '1': {'precision': 0.8976549043156714, 'recall': 0.8351269498228436, 'f1-score': 0.8652627570449353, 'support': 136038}, '2': {'precision': 0.32846400394477315, 'recall': 0.40237088492902445, 'f1-score': 0.3616804669471969, 'support': 13244}, 'accuracy': 0.7673625407906786, 'macro avg': {'precision': 0.5078284497311589, 'recall': 0.5595340278599686, 'f1-score': 0.5273966077137234, 'support': 162721}, 'weighted avg': {'precision': 0.8017506206404761, 'recall': 0.7673625407906786, 'f1-score': 0.782153932762775, 'support': 162721}}
[[  5928   6364   1147]
 [ 12681 113609   9748]
 [  1326   6589   5329]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6585816
{'0': {'precision': 0.3585412667946257, 'recall': 0.41147640288562143, 'f1-score': 0.38318931254647554, 'support': 18159}, '1': {'precision': 0.8487957862570865, 'recall': 0.8334215035254917, 'f1-score': 0.841038389826457, 'support': 126649}, '2': {'precision': 0.3822321122903115, 'recall': 0.37397420867526376, 'f1-score': 0.37805807161601623, 'support': 17913}, 'accuracy': 0.7357562945163808, 'macro avg': {'precision': 0.5298563884473412, 'recall': 0.5396240383621257, 'f1-score': 0.5340952579963162, 'support': 162721}, 'weighted avg': {'precision': 0.7427241242670197, 'recall': 0.7357562945163808, 'f1-score': 0.738977513636962, 'support': 162721}}
[[  7472   9227   1460]
 [ 11730 105552   9367]
 [  1638   9576   6699]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7104719
{'0': {'precision': 0.40167465272736075, 'recall': 0.37727871982543076, 'f1-score': 0.38909465985278263, 'support': 21997}, '1': {'precision': 0.8041261197396404, 'recall': 0.838226155887342, 'f1-score': 0.8208221295770942, 'support': 119086}, '2': {'precision': 0.41586699397455923, 'recall': 0.34448655143728624, 'f1-score': 0.37682624740912996, 'support': 21638}, 'accuracy': 0.7102586636021165, 'macro avg': {'precision': 0.5405559221471868, 'recall': 0.519997142383353, 'f1-score': 0.5289143456130022, 'support': 162721}, 'weighted avg': {'precision': 0.6980926275464143, 'recall': 0.7102586636021165, 'f1-score': 0.703419384695511, 'support': 162721}}
[[ 8299 11985  1713]
 [10508 99821  8757]
 [ 1854 12330  7454]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7941639
{'0': {'precision': 0.4614396547294867, 'recall': 0.31621012604746146, 'f1-score': 0.375263762665831, 'support': 28402}, '1': {'precision': 0.722021202310671, 'recall': 0.8545053293891158, 'f1-score': 0.7826965837881545, 'support': 106485}, '2': {'precision': 0.46692584426134387, 'recall': 0.28910684774017387, 'f1-score': 0.35710481938404187, 'support': 27834}, 'accuracy': 0.6638356450611783, 'macro avg': {'precision': 0.5501289004338338, 'recall': 0.4866074343922504, 'f1-score': 0.5050217219460091, 'support': 162721}, 'weighted avg': {'precision': 0.6329032561921875, 'recall': 0.6638356450611783, 'f1-score': 0.6387825950839288, 'support': 162721}}
[[ 8981 17420  2001]
 [ 8307 90992  7186]
 [ 2175 17612  8047]]
training model: results/AAL/W8/deepLOB_L2/seq2seq
Epoch 1/50
1814/1814 - 92s - loss: 11.2740 - accuracy10: 0.4843 - accuracy20: 0.4964 - accuracy30: 0.5022 - accuracy50: 0.5059 - val_loss: 11.2326 - val_accuracy10: 0.4619 - val_accuracy20: 0.4581 - val_accuracy30: 0.4562 - val_accuracy50: 0.4480 - 92s/epoch - 51ms/step
Epoch 2/50
1814/1814 - 85s - loss: 10.8504 - accuracy10: 0.5140 - accuracy20: 0.5265 - accuracy30: 0.5318 - accuracy50: 0.5336 - val_loss: 11.9682 - val_accuracy10: 0.2588 - val_accuracy20: 0.2858 - val_accuracy30: 0.3051 - val_accuracy50: 0.3311 - 85s/epoch - 47ms/step
Epoch 3/50
1814/1814 - 85s - loss: 10.1661 - accuracy10: 0.5925 - accuracy20: 0.5930 - accuracy30: 0.5892 - accuracy50: 0.5789 - val_loss: 9.1244 - val_accuracy10: 0.7072 - val_accuracy20: 0.6893 - val_accuracy30: 0.6745 - val_accuracy50: 0.6425 - 85s/epoch - 47ms/step
Epoch 4/50
1814/1814 - 86s - loss: 9.5210 - accuracy10: 0.6590 - accuracy20: 0.6440 - accuracy30: 0.6263 - accuracy50: 0.5995 - val_loss: 8.9121 - val_accuracy10: 0.7275 - val_accuracy20: 0.7117 - val_accuracy30: 0.6956 - val_accuracy50: 0.6599 - 86s/epoch - 47ms/step
Epoch 5/50
1814/1814 - 87s - loss: 9.2059 - accuracy10: 0.6837 - accuracy20: 0.6628 - accuracy30: 0.6404 - accuracy50: 0.6090 - val_loss: 8.7593 - val_accuracy10: 0.7444 - val_accuracy20: 0.7246 - val_accuracy30: 0.7066 - val_accuracy50: 0.6664 - 87s/epoch - 48ms/step
Epoch 6/50
1814/1814 - 86s - loss: 9.0501 - accuracy10: 0.6897 - accuracy20: 0.6679 - accuracy30: 0.6449 - accuracy50: 0.6130 - val_loss: 8.8671 - val_accuracy10: 0.7430 - val_accuracy20: 0.7235 - val_accuracy30: 0.7051 - val_accuracy50: 0.6654 - 86s/epoch - 47ms/step
Epoch 7/50
1814/1814 - 86s - loss: 8.9304 - accuracy10: 0.6939 - accuracy20: 0.6711 - accuracy30: 0.6476 - accuracy50: 0.6151 - val_loss: 8.7765 - val_accuracy10: 0.7753 - val_accuracy20: 0.7488 - val_accuracy30: 0.7257 - val_accuracy50: 0.6790 - 86s/epoch - 47ms/step
Epoch 8/50
1814/1814 - 86s - loss: 8.8732 - accuracy10: 0.6945 - accuracy20: 0.6720 - accuracy30: 0.6489 - accuracy50: 0.6170 - val_loss: 8.8207 - val_accuracy10: 0.7558 - val_accuracy20: 0.7313 - val_accuracy30: 0.7095 - val_accuracy50: 0.6669 - 86s/epoch - 48ms/step
Epoch 9/50
1814/1814 - 85s - loss: 8.8011 - accuracy10: 0.6975 - accuracy20: 0.6747 - accuracy30: 0.6516 - accuracy50: 0.6189 - val_loss: 8.6771 - val_accuracy10: 0.7540 - val_accuracy20: 0.7305 - val_accuracy30: 0.7101 - val_accuracy50: 0.6684 - 85s/epoch - 47ms/step
Epoch 10/50
1814/1814 - 86s - loss: 8.7493 - accuracy10: 0.6977 - accuracy20: 0.6747 - accuracy30: 0.6520 - accuracy50: 0.6194 - val_loss: 8.8181 - val_accuracy10: 0.7516 - val_accuracy20: 0.7256 - val_accuracy30: 0.7059 - val_accuracy50: 0.6655 - 86s/epoch - 47ms/step
Epoch 11/50
1814/1814 - 86s - loss: 8.7100 - accuracy10: 0.6985 - accuracy20: 0.6755 - accuracy30: 0.6525 - accuracy50: 0.6210 - val_loss: 8.7427 - val_accuracy10: 0.7513 - val_accuracy20: 0.7282 - val_accuracy30: 0.7079 - val_accuracy50: 0.6669 - 86s/epoch - 47ms/step
Epoch 12/50
1814/1814 - 86s - loss: 8.6633 - accuracy10: 0.6998 - accuracy20: 0.6771 - accuracy30: 0.6544 - accuracy50: 0.6220 - val_loss: 8.8184 - val_accuracy10: 0.7354 - val_accuracy20: 0.7133 - val_accuracy30: 0.6951 - val_accuracy50: 0.6568 - 86s/epoch - 48ms/step
Epoch 13/50
1814/1814 - 85s - loss: 8.6373 - accuracy10: 0.7005 - accuracy20: 0.6773 - accuracy30: 0.6546 - accuracy50: 0.6219 - val_loss: 8.8027 - val_accuracy10: 0.7297 - val_accuracy20: 0.7078 - val_accuracy30: 0.6908 - val_accuracy50: 0.6549 - 85s/epoch - 47ms/step
Epoch 14/50
1814/1814 - 86s - loss: 8.5918 - accuracy10: 0.7009 - accuracy20: 0.6784 - accuracy30: 0.6560 - accuracy50: 0.6236 - val_loss: 8.8824 - val_accuracy10: 0.7207 - val_accuracy20: 0.6972 - val_accuracy30: 0.6791 - val_accuracy50: 0.6452 - 86s/epoch - 48ms/step
Epoch 15/50
1814/1814 - 86s - loss: 8.5631 - accuracy10: 0.7014 - accuracy20: 0.6796 - accuracy30: 0.6570 - accuracy50: 0.6240 - val_loss: 8.9386 - val_accuracy10: 0.7284 - val_accuracy20: 0.7032 - val_accuracy30: 0.6836 - val_accuracy50: 0.6477 - 86s/epoch - 47ms/step
Epoch 16/50
1814/1814 - 86s - loss: 8.5352 - accuracy10: 0.7015 - accuracy20: 0.6793 - accuracy30: 0.6566 - accuracy50: 0.6233 - val_loss: 8.9882 - val_accuracy10: 0.7263 - val_accuracy20: 0.7003 - val_accuracy30: 0.6807 - val_accuracy50: 0.6450 - 86s/epoch - 47ms/step
Epoch 17/50
1814/1814 - 86s - loss: 8.5042 - accuracy10: 0.7021 - accuracy20: 0.6804 - accuracy30: 0.6574 - accuracy50: 0.6249 - val_loss: 9.2315 - val_accuracy10: 0.7256 - val_accuracy20: 0.7008 - val_accuracy30: 0.6810 - val_accuracy50: 0.6434 - 86s/epoch - 48ms/step
Epoch 18/50
1814/1814 - 86s - loss: 8.4759 - accuracy10: 0.7030 - accuracy20: 0.6812 - accuracy30: 0.6586 - accuracy50: 0.6254 - val_loss: 9.3251 - val_accuracy10: 0.7241 - val_accuracy20: 0.6988 - val_accuracy30: 0.6792 - val_accuracy50: 0.6425 - 86s/epoch - 47ms/step
Epoch 19/50
1814/1814 - 85s - loss: 8.4487 - accuracy10: 0.7038 - accuracy20: 0.6814 - accuracy30: 0.6583 - accuracy50: 0.6256 - val_loss: 9.1671 - val_accuracy10: 0.7257 - val_accuracy20: 0.7002 - val_accuracy30: 0.6791 - val_accuracy50: 0.6421 - 85s/epoch - 47ms/step
testing model: results/AAL/W8/deepLOB_L2/seq2seq
Evaluating performance on  test set...
5918/5918 - 94s - 94s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5470482
{'0': {'precision': 0.37344099738783826, 'recall': 0.6117268830373546, 'f1-score': 0.46376643386267946, 'support': 130640}, '1': {'precision': 0.9319817410936727, 'recall': 0.8136492558717614, 'f1-score': 0.868804749050811, 'support': 1255160}, '2': {'precision': 0.3633457593255854, 'recall': 0.5770850102160857, 'f1-score': 0.44592626703306887, 'support': 129208}, 'accuracy': 0.776061908583981, 'macro avg': {'precision': 0.5562561659356987, 'recall': 0.6674870497084006, 'f1-score': 0.5928324833155197, 'support': 1515008}, 'weighted avg': {'precision': 0.8353221322401081, 'recall': 0.776061908583981, 'f1-score': 0.797812722341562, 'support': 1515008}}
[[  79916   38167   12557]
 [ 115806 1021260  118094]
 [  18277   36367   74564]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.60118073
{'0': {'precision': 0.43924403361198866, 'recall': 0.5671661835640661, 'f1-score': 0.49507518494005476, 'support': 178706}, '1': {'precision': 0.8850725713874377, 'recall': 0.8058387475659669, 'f1-score': 0.8435992644171265, 'support': 1159598}, '2': {'precision': 0.41858632899868253, 'recall': 0.5412101593625498, 'f1-score': 0.47206501913997234, 'support': 176704}, 'accuracy': 0.7468204788357553, 'macro avg': {'precision': 0.5809676446660363, 'recall': 0.638071696830861, 'f1-score': 0.6035798228323846, 'support': 1515008}, 'weighted avg': {'precision': 0.7780749716079236, 'recall': 0.7468204788357553, 'f1-score': 0.7591542110415114, 'support': 1515008}}
[[101356  61371  15979]
 [108293 934449 116856]
 [ 21102  59968  95634]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6564947
{'0': {'precision': 0.47533014833204684, 'recall': 0.5256406707086367, 'f1-score': 0.49922106264146315, 'support': 216726}, '1': {'precision': 0.8380746573232712, 'recall': 0.8028051093524238, 'f1-score': 0.8200608363658114, 'support': 1084521}, '2': {'precision': 0.45350435374667497, 'recall': 0.5016677504315568, 'f1-score': 0.4763717616119976, 'support': 213761}, 'accuracy': 0.7206668215613383, 'macro avg': {'precision': 0.5889697198006644, 'recall': 0.6100378434975391, 'f1-score': 0.598551220206424, 'support': 1515008}, 'weighted avg': {'precision': 0.7319218851144982, 'recall': 0.7206668215613383, 'f1-score': 0.7256708126110634, 'support': 1515008}}
[[113920  83487  19319]
 [103955 870659 109907]
 [ 21790  84734 107237]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.75493526
{'0': {'precision': 0.5143978329771939, 'recall': 0.4616130365977103, 'f1-score': 0.4865780763349602, 'support': 280564}, '1': {'precision': 0.7499372710392934, 'recall': 0.7954353559526879, 'f1-score': 0.7720165476108475, 'support': 958147}, '2': {'precision': 0.49144182995420255, 'recall': 0.4392555836654035, 'f1-score': 0.4638856081367749, 'support': 276297}, 'accuracy': 0.6686571952095303, 'macro avg': {'precision': 0.58525897799023, 'recall': 0.5654346587386005, 'f1-score': 0.5741600773608608, 'support': 1515008}, 'weighted avg': {'precision': 0.6591751088685708, 'recall': 0.6686571952095303, 'f1-score': 0.6629614050380584, 'support': 1515008}}
[[129512 124301  26751]
 [ 97162 762144  98841]
 [ 25100 129832 121365]]
Evaluating performance on  train set...
1814/1814 - 29s - 29s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.58048606
{'0': {'precision': 0.3725771971496437, 'recall': 0.6480808164277155, 'f1-score': 0.4731460114926926, 'support': 48406}, '1': {'precision': 0.9116416359258352, 'recall': 0.8213372892197558, 'f1-score': 0.8641366136963078, 'support': 367385}, '2': {'precision': 0.4393309701340504, 'recall': 0.44474921630094044, 'f1-score': 0.4420234898641031, 'support': 48488}, 'accuracy': 0.763943663185283, 'macro avg': {'precision': 0.5745166010698431, 'recall': 0.638055773982804, 'f1-score': 0.5931020383510345, 'support': 464279}, 'weighted avg': {'precision': 0.8061116576448611, 'recall': 0.763943663185283, 'f1-score': 0.7792873910550854, 'support': 464279}}
[[ 31371  12491   4544]
 [ 42661 301747  22977]
 [ 10168  16755  21565]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.63603795
{'0': {'precision': 0.43142756152520656, 'recall': 0.6095669137729224, 'f1-score': 0.5052552601111205, 'support': 64075}, '1': {'precision': 0.8631105216678033, 'recall': 0.8169205965816135, 'f1-score': 0.8393805979158675, 'support': 336182}, '2': {'precision': 0.4896140830873353, 'recall': 0.4248695760832214, 'f1-score': 0.4549499071735603, 'support': 64022}, 'accuracy': 0.734241695187592, 'macro avg': {'precision': 0.594717388760115, 'recall': 0.6171190288125857, 'f1-score': 0.599861921733516, 'support': 464279}, 'weighted avg': {'precision': 0.7520306006247761, 'recall': 0.734241695187592, 'f1-score': 0.7402567893814664, 'support': 464279}}
[[ 39058  19105   5912]
 [ 39105 274634  22443]
 [ 12369  24452  27201]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.68834364
{'0': {'precision': 0.46246310476109, 'recall': 0.5697796985348371, 'f1-score': 0.5105428443248092, 'support': 75896}, '1': {'precision': 0.8165740515486357, 'recall': 0.8161221075127089, 'f1-score': 0.8163480169797162, 'support': 312577}, '2': {'precision': 0.5148628505833776, 'recall': 0.3964198084584334, 'f1-score': 0.4479440722052872, 'support': 75806}, 'accuracy': 0.7073246905416786, 'macro avg': {'precision': 0.5979666689643678, 'recall': 0.5941072048353265, 'f1-score': 0.5916116445032709, 'support': 464279}, 'weighted avg': {'precision': 0.7094248509219437, 'recall': 0.7073246905416786, 'f1-score': 0.7062060143877679, 'support': 464279}}
[[ 43244  25327   7325]
 [ 36485 255101  20991]
 [ 13779  31976  30051]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7817113
{'0': {'precision': 0.49165861976866027, 'recall': 0.5077443720693386, 'f1-score': 0.49957204292096363, 'support': 94262}, '1': {'precision': 0.7323056853863349, 'recall': 0.8120736091070008, 'f1-score': 0.7701296216825484, 'support': 275129}, '2': {'precision': 0.5370097841028544, 'recall': 0.3499494140460332, 'f1-score': 0.4237540118553116, 'support': 94888}, 'accuracy': 0.6558384075092778, 'macro avg': {'precision': 0.5869913630859499, 'recall': 0.5565891317407908, 'f1-score': 0.5644852254862746, 'support': 464279}, 'weighted avg': {'precision': 0.643533392906511, 'recall': 0.6558384075092778, 'f1-score': 0.6444074000130106, 'support': 464279}}
[[ 47861  36617   9784]
 [ 32859 223425  18845]
 [ 16626  45056  33206]]
Evaluating performance on  val set...
636/636 - 10s - 10s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.58560336
{'0': {'precision': 0.31334291777914697, 'recall': 0.6822687635089811, 'f1-score': 0.4294527456545706, 'support': 13417}, '1': {'precision': 0.9398822709180927, 'recall': 0.7830290642531009, 'f1-score': 0.8543157388095619, 'support': 136009}, '2': {'precision': 0.35173540624845273, 'recall': 0.5342960288808665, 'f1-score': 0.4242080434717702, 'support': 13296}, 'accuracy': 0.7543970698491906, 'macro avg': {'precision': 0.5349868649818975, 'recall': 0.6665312855476495, 'f1-score': 0.5693255093119677, 'support': 162722}, 'weighted avg': {'precision': 0.8401644748381971, 'recall': 0.7543970698491906, 'f1-score': 0.7841402327540082, 'support': 162722}}
[[  9154   2908   1355]
 [ 17772 106499  11738]
 [  2288   3904   7104]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.63615644
{'0': {'precision': 0.3708528914008366, 'recall': 0.6397840577315045, 'f1-score': 0.4695370931877906, 'support': 18153}, '1': {'precision': 0.9006386468383775, 'recall': 0.7763324171484536, 'f1-score': 0.8338784045743568, 'support': 126612}, '2': {'precision': 0.4058289922759116, 'recall': 0.5032577824803698, 'f1-score': 0.4493225605966439, 'support': 17957}, 'accuracy': 0.7309644670050761, 'macro avg': {'precision': 0.5591068435050418, 'recall': 0.6397914191201094, 'f1-score': 0.5842460194529303, 'support': 162722}, 'weighted avg': {'precision': 0.7869324621464742, 'recall': 0.7309644670050761, 'f1-score': 0.7507958643160751, 'support': 162722}}
[[11614  4771  1768]
 [16856 98293 11463]
 [ 2847  6073  9037]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.67994726
{'0': {'precision': 0.4066148462419869, 'recall': 0.5969267139479906, 'f1-score': 0.48372538545139715, 'support': 21996}, '1': {'precision': 0.8605466273910287, 'recall': 0.7753802736458395, 'f1-score': 0.815746570349261, 'support': 119059}, '2': {'precision': 0.4377888145109048, 'recall': 0.46785434070245074, 'f1-score': 0.4523225201909777, 'support': 21667}, 'accuracy': 0.7103096077973476, 'macro avg': {'precision': 0.5683167627146402, 'recall': 0.6133871094320936, 'f1-score': 0.583931491997212, 'support': 162722}, 'weighted avg': {'precision': 0.7428945767167009, 'recall': 0.7103096077973476, 'f1-score': 0.72247432149666, 'support': 162722}}
[[13130  6618  2248]
 [15973 92316 10770]
 [ 3188  8342 10137]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.75954646
{'0': {'precision': 0.44958534693634034, 'recall': 0.5304822245688138, 'f1-score': 0.48669508493186076, 'support': 28410}, '1': {'precision': 0.783170689950351, 'recall': 0.7736343649585659, 'f1-score': 0.7783733197209461, 'support': 106434}, '2': {'precision': 0.47410855290499543, 'recall': 0.40921156467465386, 'f1-score': 0.439276087793608, 'support': 27878}, 'accuracy': 0.6687479259104485, 'macro avg': {'precision': 0.5689548632638955, 'recall': 0.5711093847340112, 'f1-score': 0.5681148308154716, 'support': 162722}, 'weighted avg': {'precision': 0.6719798623328287, 'recall': 0.6687479259104485, 'f1-score': 0.6693534497462148, 'support': 162722}}
[[15071 10238  3101]
 [14540 82341  9553]
 [ 3911 12559 11408]]
training model: results/AAL/W8/deepOF_L2/seq2seq
Epoch 1/50
1814/1814 - 61s - loss: 10.4718 - accuracy10: 0.5816 - accuracy20: 0.5802 - accuracy30: 0.5709 - accuracy50: 0.5558 - val_loss: 10.2046 - val_accuracy10: 0.8065 - val_accuracy20: 0.7793 - val_accuracy30: 0.7498 - val_accuracy50: 0.6924 - 61s/epoch - 34ms/step
Epoch 2/50
1814/1814 - 53s - loss: 9.3729 - accuracy10: 0.6512 - accuracy20: 0.6425 - accuracy30: 0.6249 - accuracy50: 0.5998 - val_loss: 9.6215 - val_accuracy10: 0.8013 - val_accuracy20: 0.7771 - val_accuracy30: 0.7496 - val_accuracy50: 0.6958 - 53s/epoch - 29ms/step
Epoch 3/50
1814/1814 - 54s - loss: 9.1251 - accuracy10: 0.6660 - accuracy20: 0.6533 - accuracy30: 0.6330 - accuracy50: 0.6065 - val_loss: 9.6127 - val_accuracy10: 0.7995 - val_accuracy20: 0.7739 - val_accuracy30: 0.7461 - val_accuracy50: 0.6927 - 54s/epoch - 30ms/step
Epoch 4/50
1814/1814 - 53s - loss: 9.0156 - accuracy10: 0.6726 - accuracy20: 0.6577 - accuracy30: 0.6360 - accuracy50: 0.6097 - val_loss: 9.3983 - val_accuracy10: 0.7965 - val_accuracy20: 0.7711 - val_accuracy30: 0.7422 - val_accuracy50: 0.6897 - 53s/epoch - 29ms/step
Epoch 5/50
1814/1814 - 54s - loss: 8.9312 - accuracy10: 0.6777 - accuracy20: 0.6614 - accuracy30: 0.6394 - accuracy50: 0.6126 - val_loss: 9.3744 - val_accuracy10: 0.7881 - val_accuracy20: 0.7629 - val_accuracy30: 0.7346 - val_accuracy50: 0.6831 - 54s/epoch - 30ms/step
Epoch 6/50
1814/1814 - 53s - loss: 8.8719 - accuracy10: 0.6815 - accuracy20: 0.6642 - accuracy30: 0.6416 - accuracy50: 0.6151 - val_loss: 9.3574 - val_accuracy10: 0.7912 - val_accuracy20: 0.7665 - val_accuracy30: 0.7384 - val_accuracy50: 0.6868 - 53s/epoch - 29ms/step
Epoch 7/50
1814/1814 - 53s - loss: 8.8195 - accuracy10: 0.6829 - accuracy20: 0.6657 - accuracy30: 0.6427 - accuracy50: 0.6157 - val_loss: 9.3294 - val_accuracy10: 0.7820 - val_accuracy20: 0.7582 - val_accuracy30: 0.7302 - val_accuracy50: 0.6791 - 53s/epoch - 29ms/step
Epoch 8/50
1814/1814 - 52s - loss: 8.7744 - accuracy10: 0.6852 - accuracy20: 0.6673 - accuracy30: 0.6440 - accuracy50: 0.6166 - val_loss: 9.3197 - val_accuracy10: 0.7838 - val_accuracy20: 0.7604 - val_accuracy30: 0.7320 - val_accuracy50: 0.6816 - 52s/epoch - 29ms/step
Epoch 9/50
1814/1814 - 52s - loss: 8.7339 - accuracy10: 0.6864 - accuracy20: 0.6684 - accuracy30: 0.6458 - accuracy50: 0.6177 - val_loss: 9.3889 - val_accuracy10: 0.7844 - val_accuracy20: 0.7584 - val_accuracy30: 0.7293 - val_accuracy50: 0.6766 - 52s/epoch - 29ms/step
Epoch 10/50
1814/1814 - 53s - loss: 8.6930 - accuracy10: 0.6874 - accuracy20: 0.6703 - accuracy30: 0.6469 - accuracy50: 0.6181 - val_loss: 9.3235 - val_accuracy10: 0.7812 - val_accuracy20: 0.7557 - val_accuracy30: 0.7261 - val_accuracy50: 0.6744 - 53s/epoch - 29ms/step
Epoch 11/50
1814/1814 - 53s - loss: 8.6576 - accuracy10: 0.6880 - accuracy20: 0.6715 - accuracy30: 0.6478 - accuracy50: 0.6183 - val_loss: 9.2803 - val_accuracy10: 0.7704 - val_accuracy20: 0.7451 - val_accuracy30: 0.7169 - val_accuracy50: 0.6681 - 53s/epoch - 29ms/step
Epoch 12/50
1814/1814 - 56s - loss: 8.6161 - accuracy10: 0.6890 - accuracy20: 0.6723 - accuracy30: 0.6485 - accuracy50: 0.6198 - val_loss: 9.3069 - val_accuracy10: 0.7776 - val_accuracy20: 0.7509 - val_accuracy30: 0.7220 - val_accuracy50: 0.6718 - 56s/epoch - 31ms/step
Epoch 13/50
1814/1814 - 54s - loss: 8.5835 - accuracy10: 0.6900 - accuracy20: 0.6731 - accuracy30: 0.6490 - accuracy50: 0.6201 - val_loss: 9.3099 - val_accuracy10: 0.7700 - val_accuracy20: 0.7451 - val_accuracy30: 0.7163 - val_accuracy50: 0.6665 - 54s/epoch - 30ms/step
Epoch 14/50
1814/1814 - 53s - loss: 8.5487 - accuracy10: 0.6920 - accuracy20: 0.6744 - accuracy30: 0.6500 - accuracy50: 0.6207 - val_loss: 9.3597 - val_accuracy10: 0.7760 - val_accuracy20: 0.7486 - val_accuracy30: 0.7194 - val_accuracy50: 0.6686 - 53s/epoch - 29ms/step
Epoch 15/50
1814/1814 - 55s - loss: 8.5158 - accuracy10: 0.6918 - accuracy20: 0.6745 - accuracy30: 0.6505 - accuracy50: 0.6211 - val_loss: 9.3946 - val_accuracy10: 0.7772 - val_accuracy20: 0.7488 - val_accuracy30: 0.7204 - val_accuracy50: 0.6682 - 55s/epoch - 30ms/step
Epoch 16/50
1814/1814 - 53s - loss: 8.4867 - accuracy10: 0.6906 - accuracy20: 0.6749 - accuracy30: 0.6516 - accuracy50: 0.6227 - val_loss: 9.3949 - val_accuracy10: 0.7750 - val_accuracy20: 0.7485 - val_accuracy30: 0.7189 - val_accuracy50: 0.6690 - 53s/epoch - 29ms/step
Epoch 17/50
1814/1814 - 53s - loss: 8.4525 - accuracy10: 0.6915 - accuracy20: 0.6757 - accuracy30: 0.6522 - accuracy50: 0.6223 - val_loss: 9.5153 - val_accuracy10: 0.7781 - val_accuracy20: 0.7497 - val_accuracy30: 0.7198 - val_accuracy50: 0.6687 - 53s/epoch - 29ms/step
Epoch 18/50
1814/1814 - 53s - loss: 8.4218 - accuracy10: 0.6919 - accuracy20: 0.6761 - accuracy30: 0.6534 - accuracy50: 0.6243 - val_loss: 9.4557 - val_accuracy10: 0.7760 - val_accuracy20: 0.7476 - val_accuracy30: 0.7182 - val_accuracy50: 0.6681 - 53s/epoch - 29ms/step
Epoch 19/50
1814/1814 - 53s - loss: 8.3894 - accuracy10: 0.6929 - accuracy20: 0.6766 - accuracy30: 0.6532 - accuracy50: 0.6248 - val_loss: 9.4693 - val_accuracy10: 0.7744 - val_accuracy20: 0.7454 - val_accuracy30: 0.7161 - val_accuracy50: 0.6668 - 53s/epoch - 29ms/step
Epoch 20/50
1814/1814 - 53s - loss: 8.3533 - accuracy10: 0.6933 - accuracy20: 0.6770 - accuracy30: 0.6540 - accuracy50: 0.6258 - val_loss: 9.5008 - val_accuracy10: 0.7751 - val_accuracy20: 0.7454 - val_accuracy30: 0.7161 - val_accuracy50: 0.6666 - 53s/epoch - 29ms/step
Epoch 21/50
1814/1814 - 53s - loss: 8.3187 - accuracy10: 0.6935 - accuracy20: 0.6779 - accuracy30: 0.6550 - accuracy50: 0.6266 - val_loss: 9.5841 - val_accuracy10: 0.7764 - val_accuracy20: 0.7460 - val_accuracy30: 0.7163 - val_accuracy50: 0.6669 - 53s/epoch - 29ms/step
testing model: results/AAL/W8/deepOF_L2/seq2seq
Evaluating performance on  test set...
5918/5918 - 59s - 59s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5744534
{'0': {'precision': 0.33932152302346147, 'recall': 0.6256171587351403, 'f1-score': 0.43999763123751684, 'support': 130639}, '1': {'precision': 0.929326000384961, 'recall': 0.7924101985566757, 'f1-score': 0.8554241944167789, 'support': 1255158}, '2': {'precision': 0.35263018508891525, 'recall': 0.5564911846199093, 'f1-score': 0.43170383179029026, 'support': 129206}, 'accuracy': 0.7579074100843365, 'macro avg': {'precision': 0.540425902832446, 'recall': 0.6581728473039085, 'f1-score': 0.5757085524815286, 'support': 1515003}, 'weighted avg': {'precision': 0.8292666906481686, 'recall': 0.7579074100843365, 'f1-score': 0.7834651791800475, 'support': 1515003}}
[[ 81730  38702  10207]
 [138765 994600 121793]
 [ 20368  36936  71902]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6234251
{'0': {'precision': 0.4045779087667185, 'recall': 0.5853333706387622, 'f1-score': 0.4784528794673997, 'support': 178705}, '1': {'precision': 0.8821990915790437, 'recall': 0.789739883769965, 'f1-score': 0.8334129634129362, 'support': 1159597}, '2': {'precision': 0.41868749771053887, 'recall': 0.5174730193943441, 'f1-score': 0.46286823608618727, 'support': 176701}, 'accuracy': 0.7338731342446186, 'macro avg': {'precision': 0.5684881660187671, 'recall': 0.630848757934357, 'f1-score': 0.5915780263221745, 'support': 1515003}, 'weighted avg': {'precision': 0.7717991414649942, 'recall': 0.7338731342446186, 'f1-score': 0.7483248377360557, 'support': 1515003}}
[[104602  61695  12408]
 [129271 915780 114546]
 [ 24673  60590  91438]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6862176
{'0': {'precision': 0.4312568172684999, 'recall': 0.5545876110278002, 'f1-score': 0.4852077694281117, 'support': 216725}, '1': {'precision': 0.8372479823119926, 'recall': 0.7737441448751522, 'f1-score': 0.8042444319744142, 'support': 1084520}, '2': {'precision': 0.4467009630914638, 'recall': 0.48908111041458097, 'f1-score': 0.4669313705347971, 'support': 213758}, 'accuracy': 0.7022289724838828, 'macro avg': {'precision': 0.5717352542239854, 'recall': 0.6058042887725111, 'f1-score': 0.5854611906457744, 'support': 1515003}, 'weighted avg': {'precision': 0.7240660381319529, 'recall': 0.7022289724838828, 'f1-score': 0.7110125465738195, 'support': 1515003}}
[[120193  82066  14466]
 [130352 839141 115027]
 [ 28159  81054 104545]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.78729355
{'0': {'precision': 0.4678848062232346, 'recall': 0.5007876990633153, 'f1-score': 0.4837774464671228, 'support': 280564}, '1': {'precision': 0.7518205330827832, 'recall': 0.7566328687202877, 'f1-score': 0.7542190246371377, 'support': 958145}, '2': {'precision': 0.48014822446102917, 'recall': 0.43520308077627456, 'f1-score': 0.45657221510275764, 'support': 276294}, 'accuracy': 0.6506330350500956, 'macro avg': {'precision': 0.5666178545890156, 'recall': 0.5642078828532925, 'f1-score': 0.5648562287356728, 'support': 1515003}, 'weighted avg': {'precision': 0.64969296494664, 'recall': 0.6506330350500956, 'f1-score': 0.6498534236903516, 'support': 1515003}}
[[140503 119535  20526]
 [123520 724964 109661]
 [ 36271 119779 120244]]
Evaluating performance on  train set...
1814/1814 - 19s - 19s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6261467
{'0': {'precision': 0.3446273820873459, 'recall': 0.6665285489351123, 'f1-score': 0.45433939881797186, 'support': 48268}, '1': {'precision': 0.9262795460616794, 'recall': 0.7643239300934518, 'f1-score': 0.8375442651060498, 'support': 367462}, '2': {'precision': 0.39231439500228915, 'recall': 0.5471810822501906, 'f1-score': 0.45698360542930383, 'support': 48547}, 'accuracy': 0.7314512672391698, 'macro avg': {'precision': 0.5544071077171048, 'recall': 0.6593445204262516, 'f1-score': 0.5829557564511085, 'support': 464277}, 'weighted avg': {'precision': 0.8099748554584547, 'recall': 0.7314512672391698, 'f1-score': 0.7579116086718092, 'support': 464277}}
[[ 32172  10579   5517]
 [ 50972 280860  35630]
 [ 10209  11774  26564]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6616784
{'0': {'precision': 0.40376067346959255, 'recall': 0.6290940358008286, 'f1-score': 0.49184736108734456, 'support': 63965}, '1': {'precision': 0.8803666068665178, 'recall': 0.7647907347482631, 'f1-score': 0.8185189429388134, 'support': 336224}, '2': {'precision': 0.4572314904177582, 'recall': 0.5174603669953813, 'f1-score': 0.4854850751731104, 'support': 64088}, 'accuracy': 0.7119542859112125, 'macro avg': {'precision': 0.5804529235846229, 'recall': 0.6371150458481577, 'f1-score': 0.5986171263997561, 'support': 464277}, 'weighted avg': {'precision': 0.7562941633194491, 'recall': 0.7119542859112125, 'f1-score': 0.7275408797340939, 'support': 464277}}
[[ 40240  16472   7253]
 [ 46969 257141  32114]
 [ 12454  18471  33163]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.712833
{'0': {'precision': 0.4278620042243605, 'recall': 0.6010866984939203, 'f1-score': 0.4998930633777715, 'support': 75826}, '1': {'precision': 0.8378855128923867, 'recall': 0.7506822231677549, 'f1-score': 0.7918903869193258, 'support': 312581}, '2': {'precision': 0.47962112144962227, 'recall': 0.4912086463687887, 'f1-score': 0.4853457313460048, 'support': 75870}, 'accuracy': 0.6838482199204354, 'macro avg': {'precision': 0.5817895461887898, 'recall': 0.6143258560101547, 'f1-score': 0.592376393881034, 'support': 464277}, 'weighted avg': {'precision': 0.7123743160271009, 'recall': 0.6838482199204354, 'f1-score': 0.6941070979060647, 'support': 464277}}
[[ 45578  21432   8816]
 [ 46313 234649  31619]
 [ 14634  23968  37268]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.79640794
{'0': {'precision': 0.45836088700789135, 'recall': 0.5515181735237328, 'f1-score': 0.50064283753786, 'support': 94258}, '1': {'precision': 0.7584513416668537, 'recall': 0.7373207377025337, 'f1-score': 0.7477367848516695, 'support': 275016}, '2': {'precision': 0.5010897159553576, 'recall': 0.44045977495447514, 'f1-score': 0.4688226495846194, 'support': 95003}, 'accuracy': 0.6388535292508567, 'macro avg': {'precision': 0.5726339815433675, 'recall': 0.5764328953935806, 'f1-score': 0.5724007573247163, 'support': 464277}, 'weighted avg': {'precision': 0.6448638656499204, 'recall': 0.6388535292508567, 'f1-score': 0.6404985178716541, 'support': 464277}}
[[ 51985  30309  11964]
 [ 42542 202775  29699]
 [ 18888  34270  41845]]
Evaluating performance on  val set...
636/636 - 6s - 6s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.54132575
{'0': {'precision': 0.3268782986650109, 'recall': 0.6267579432993526, 'f1-score': 0.42966817149998726, 'support': 13439}, '1': {'precision': 0.9319039697350977, 'recall': 0.8112218644790427, 'f1-score': 0.8673853155125186, 'support': 136038}, '2': {'precision': 0.360673429743147, 'recall': 0.5046813651464814, 'f1-score': 0.4206948640483384, 'support': 13244}, 'accuracy': 0.7710375427879622, 'macro avg': {'precision': 0.5398185660477518, 'recall': 0.6475537243082922, 'f1-score': 0.572582783686948, 'support': 162721}, 'weighted avg': {'precision': 0.8354424357894834, 'recall': 0.7710375427879622, 'f1-score': 0.7948780851146228, 'support': 162721}}
[[  8423   3893   1123]
 [ 14956 110357  10725]
 [  2389   4171   6684]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.59683543
{'0': {'precision': 0.3820521160865951, 'recall': 0.5821355801530921, 'f1-score': 0.46133368246486867, 'support': 18159}, '1': {'precision': 0.889558302659907, 'recall': 0.8090865304897789, 'f1-score': 0.8474162776369598, 'support': 126649}, '2': {'precision': 0.42134944612286, 'recall': 0.4671467649193323, 'f1-score': 0.443067799751145, 'support': 17913}, 'accuracy': 0.7461175877729365, 'macro avg': {'precision': 0.564319954956454, 'recall': 0.6194562918540677, 'f1-score': 0.5839392532843245, 'support': 162721}, 'weighted avg': {'precision': 0.7813803164802934, 'recall': 0.7461175877729365, 'f1-score': 0.7598186834106546, 'support': 162721}}
[[ 10571   6158   1430]
 [ 14117 102470  10062]
 [  2981   6564   8368]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.65731806
{'0': {'precision': 0.4085337105139085, 'recall': 0.5514842933127244, 'f1-score': 0.46936604050995334, 'support': 21997}, '1': {'precision': 0.8504462886865594, 'recall': 0.7976924239625145, 'f1-score': 0.8232250796195594, 'support': 119086}, '2': {'precision': 0.44833083270817703, 'recall': 0.4419077548756817, 'f1-score': 0.4450961225154773, 'support': 21638}, 'accuracy': 0.7170985920686328, 'macro avg': {'precision': 0.569103610636215, 'recall': 0.5970281573836402, 'f1-score': 0.5792290808816634, 'support': 162721}, 'weighted avg': {'precision': 0.7372357920787213, 'recall': 0.7170985920686328, 'f1-score': 0.7251074939538362, 'support': 162721}}
[[12131  8123  1743]
 [14069 94994 10023]
 [ 3494  8582  9562]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.75752527
{'0': {'precision': 0.44119500819362156, 'recall': 0.4929230335891839, 'f1-score': 0.46562676688728505, 'support': 28402}, '1': {'precision': 0.7732697338620964, 'recall': 0.7855566511715265, 'f1-score': 0.7793647687993216, 'support': 106485}, '2': {'precision': 0.4783008942661757, 'recall': 0.39200258676438887, 'f1-score': 0.4308731192986613, 'support': 27834}, 'accuracy': 0.667160354225945, 'macro avg': {'precision': 0.5642552121072979, 'recall': 0.5568274238416997, 'f1-score': 0.558621551661756, 'support': 162721}, 'weighted avg': {'precision': 0.6648525717272221, 'recall': 0.667160354225945, 'f1-score': 0.6649929095893422, 'support': 162721}}
[[14000 11980  2422]
 [13356 83650  9479]
 [ 4376 12547 10911]]
training model: results/AAL/W8/deepVOL_L2/seq2seq
Epoch 1/50
1814/1814 - 59s - loss: 10.8592 - accuracy10: 0.5639 - accuracy20: 0.5671 - accuracy30: 0.5601 - accuracy50: 0.5467 - val_loss: 10.0590 - val_accuracy10: 0.7891 - val_accuracy20: 0.7670 - val_accuracy30: 0.7376 - val_accuracy50: 0.6783 - 59s/epoch - 33ms/step
Epoch 2/50
1814/1814 - 52s - loss: 10.0238 - accuracy10: 0.6311 - accuracy20: 0.6222 - accuracy30: 0.6045 - accuracy50: 0.5802 - val_loss: 9.5353 - val_accuracy10: 0.7792 - val_accuracy20: 0.7555 - val_accuracy30: 0.7265 - val_accuracy50: 0.6723 - 52s/epoch - 29ms/step
Epoch 3/50
1814/1814 - 52s - loss: 9.5992 - accuracy10: 0.6634 - accuracy20: 0.6462 - accuracy30: 0.6215 - accuracy50: 0.5908 - val_loss: 9.3000 - val_accuracy10: 0.7887 - val_accuracy20: 0.7673 - val_accuracy30: 0.7393 - val_accuracy50: 0.6854 - 52s/epoch - 28ms/step
Epoch 4/50
1814/1814 - 52s - loss: 9.3621 - accuracy10: 0.6742 - accuracy20: 0.6543 - accuracy30: 0.6289 - accuracy50: 0.5992 - val_loss: 9.1385 - val_accuracy10: 0.7860 - val_accuracy20: 0.7628 - val_accuracy30: 0.7362 - val_accuracy50: 0.6850 - 52s/epoch - 28ms/step
Epoch 5/50
1814/1814 - 52s - loss: 9.2263 - accuracy10: 0.6817 - accuracy20: 0.6607 - accuracy30: 0.6347 - accuracy50: 0.6044 - val_loss: 9.2185 - val_accuracy10: 0.8046 - val_accuracy20: 0.7786 - val_accuracy30: 0.7495 - val_accuracy50: 0.6938 - 52s/epoch - 29ms/step
Epoch 6/50
1814/1814 - 52s - loss: 9.1697 - accuracy10: 0.6831 - accuracy20: 0.6613 - accuracy30: 0.6360 - accuracy50: 0.6067 - val_loss: 9.1642 - val_accuracy10: 0.7911 - val_accuracy20: 0.7685 - val_accuracy30: 0.7416 - val_accuracy50: 0.6902 - 52s/epoch - 29ms/step
Epoch 7/50
1814/1814 - 52s - loss: 9.0882 - accuracy10: 0.6878 - accuracy20: 0.6644 - accuracy30: 0.6385 - accuracy50: 0.6101 - val_loss: 9.2676 - val_accuracy10: 0.7911 - val_accuracy20: 0.7639 - val_accuracy30: 0.7345 - val_accuracy50: 0.6832 - 52s/epoch - 29ms/step
Epoch 8/50
1814/1814 - 52s - loss: 9.0370 - accuracy10: 0.6905 - accuracy20: 0.6670 - accuracy30: 0.6409 - accuracy50: 0.6124 - val_loss: 9.2590 - val_accuracy10: 0.7912 - val_accuracy20: 0.7634 - val_accuracy30: 0.7352 - val_accuracy50: 0.6851 - 52s/epoch - 29ms/step
Epoch 9/50
1814/1814 - 52s - loss: 8.9922 - accuracy10: 0.6924 - accuracy20: 0.6679 - accuracy30: 0.6418 - accuracy50: 0.6130 - val_loss: 9.1673 - val_accuracy10: 0.7892 - val_accuracy20: 0.7633 - val_accuracy30: 0.7360 - val_accuracy50: 0.6866 - 52s/epoch - 28ms/step
Epoch 10/50
1814/1814 - 52s - loss: 8.9501 - accuracy10: 0.6934 - accuracy20: 0.6693 - accuracy30: 0.6436 - accuracy50: 0.6150 - val_loss: 9.1177 - val_accuracy10: 0.7904 - val_accuracy20: 0.7638 - val_accuracy30: 0.7368 - val_accuracy50: 0.6862 - 52s/epoch - 29ms/step
Epoch 11/50
1814/1814 - 53s - loss: 8.9091 - accuracy10: 0.6949 - accuracy20: 0.6706 - accuracy30: 0.6447 - accuracy50: 0.6160 - val_loss: 9.0900 - val_accuracy10: 0.7854 - val_accuracy20: 0.7604 - val_accuracy30: 0.7325 - val_accuracy50: 0.6833 - 53s/epoch - 29ms/step
Epoch 12/50
1814/1814 - 52s - loss: 8.8738 - accuracy10: 0.6957 - accuracy20: 0.6713 - accuracy30: 0.6457 - accuracy50: 0.6169 - val_loss: 9.1866 - val_accuracy10: 0.7901 - val_accuracy20: 0.7628 - val_accuracy30: 0.7334 - val_accuracy50: 0.6823 - 52s/epoch - 29ms/step
Epoch 13/50
1814/1814 - 51s - loss: 8.8378 - accuracy10: 0.6970 - accuracy20: 0.6734 - accuracy30: 0.6475 - accuracy50: 0.6183 - val_loss: 9.1678 - val_accuracy10: 0.7908 - val_accuracy20: 0.7652 - val_accuracy30: 0.7360 - val_accuracy50: 0.6851 - 51s/epoch - 28ms/step
Epoch 14/50
1814/1814 - 52s - loss: 8.8050 - accuracy10: 0.6979 - accuracy20: 0.6740 - accuracy30: 0.6477 - accuracy50: 0.6191 - val_loss: 9.2507 - val_accuracy10: 0.7955 - val_accuracy20: 0.7687 - val_accuracy30: 0.7393 - val_accuracy50: 0.6869 - 52s/epoch - 29ms/step
Epoch 15/50
1814/1814 - 52s - loss: 8.7714 - accuracy10: 0.6990 - accuracy20: 0.6748 - accuracy30: 0.6484 - accuracy50: 0.6199 - val_loss: 9.2161 - val_accuracy10: 0.7945 - val_accuracy20: 0.7659 - val_accuracy30: 0.7365 - val_accuracy50: 0.6852 - 52s/epoch - 29ms/step
Epoch 16/50
1814/1814 - 53s - loss: 8.7509 - accuracy10: 0.6997 - accuracy20: 0.6751 - accuracy30: 0.6488 - accuracy50: 0.6204 - val_loss: 9.1642 - val_accuracy10: 0.7818 - val_accuracy20: 0.7556 - val_accuracy30: 0.7260 - val_accuracy50: 0.6776 - 53s/epoch - 29ms/step
Epoch 17/50
1814/1814 - 52s - loss: 8.7223 - accuracy10: 0.6998 - accuracy20: 0.6761 - accuracy30: 0.6500 - accuracy50: 0.6219 - val_loss: 9.2113 - val_accuracy10: 0.7760 - val_accuracy20: 0.7523 - val_accuracy30: 0.7255 - val_accuracy50: 0.6781 - 52s/epoch - 29ms/step
Epoch 18/50
1814/1814 - 52s - loss: 8.6969 - accuracy10: 0.7005 - accuracy20: 0.6765 - accuracy30: 0.6507 - accuracy50: 0.6224 - val_loss: 9.1075 - val_accuracy10: 0.7832 - val_accuracy20: 0.7593 - val_accuracy30: 0.7325 - val_accuracy50: 0.6836 - 52s/epoch - 28ms/step
Epoch 19/50
1814/1814 - 52s - loss: 8.6763 - accuracy10: 0.7006 - accuracy20: 0.6764 - accuracy30: 0.6503 - accuracy50: 0.6229 - val_loss: 9.0419 - val_accuracy10: 0.7796 - val_accuracy20: 0.7567 - val_accuracy30: 0.7297 - val_accuracy50: 0.6820 - 52s/epoch - 29ms/step
Epoch 20/50
1814/1814 - 52s - loss: 8.6444 - accuracy10: 0.7021 - accuracy20: 0.6782 - accuracy30: 0.6516 - accuracy50: 0.6232 - val_loss: 9.0829 - val_accuracy10: 0.7777 - val_accuracy20: 0.7530 - val_accuracy30: 0.7255 - val_accuracy50: 0.6787 - 52s/epoch - 29ms/step
Epoch 21/50
1814/1814 - 52s - loss: 8.6276 - accuracy10: 0.7023 - accuracy20: 0.6787 - accuracy30: 0.6528 - accuracy50: 0.6246 - val_loss: 9.1763 - val_accuracy10: 0.7882 - val_accuracy20: 0.7615 - val_accuracy30: 0.7331 - val_accuracy50: 0.6836 - 52s/epoch - 29ms/step
Epoch 22/50
1814/1814 - 52s - loss: 8.6033 - accuracy10: 0.7017 - accuracy20: 0.6787 - accuracy30: 0.6525 - accuracy50: 0.6245 - val_loss: 9.1539 - val_accuracy10: 0.7779 - val_accuracy20: 0.7521 - val_accuracy30: 0.7251 - val_accuracy50: 0.6786 - 52s/epoch - 29ms/step
Epoch 23/50
1814/1814 - 52s - loss: 8.5762 - accuracy10: 0.7027 - accuracy20: 0.6797 - accuracy30: 0.6540 - accuracy50: 0.6256 - val_loss: 9.2578 - val_accuracy10: 0.7830 - val_accuracy20: 0.7562 - val_accuracy30: 0.7283 - val_accuracy50: 0.6797 - 52s/epoch - 29ms/step
Epoch 24/50
1814/1814 - 52s - loss: 8.5560 - accuracy10: 0.7035 - accuracy20: 0.6807 - accuracy30: 0.6549 - accuracy50: 0.6263 - val_loss: 9.1811 - val_accuracy10: 0.7753 - val_accuracy20: 0.7504 - val_accuracy30: 0.7234 - val_accuracy50: 0.6766 - 52s/epoch - 29ms/step
Epoch 25/50
1814/1814 - 52s - loss: 8.5311 - accuracy10: 0.7034 - accuracy20: 0.6808 - accuracy30: 0.6550 - accuracy50: 0.6269 - val_loss: 9.0411 - val_accuracy10: 0.7562 - val_accuracy20: 0.7325 - val_accuracy30: 0.7058 - val_accuracy50: 0.6637 - 52s/epoch - 29ms/step
Epoch 26/50
1814/1814 - 52s - loss: 8.5089 - accuracy10: 0.7038 - accuracy20: 0.6809 - accuracy30: 0.6556 - accuracy50: 0.6282 - val_loss: 9.0250 - val_accuracy10: 0.7645 - val_accuracy20: 0.7406 - val_accuracy30: 0.7142 - val_accuracy50: 0.6709 - 52s/epoch - 29ms/step
Epoch 27/50
1814/1814 - 52s - loss: 8.4912 - accuracy10: 0.7032 - accuracy20: 0.6810 - accuracy30: 0.6559 - accuracy50: 0.6277 - val_loss: 9.0708 - val_accuracy10: 0.7680 - val_accuracy20: 0.7417 - val_accuracy30: 0.7143 - val_accuracy50: 0.6691 - 52s/epoch - 29ms/step
Epoch 28/50
1814/1814 - 52s - loss: 8.4703 - accuracy10: 0.7040 - accuracy20: 0.6820 - accuracy30: 0.6569 - accuracy50: 0.6286 - val_loss: 9.0863 - val_accuracy10: 0.7697 - val_accuracy20: 0.7451 - val_accuracy30: 0.7170 - val_accuracy50: 0.6719 - 52s/epoch - 28ms/step
Epoch 29/50
1814/1814 - 52s - loss: 8.4468 - accuracy10: 0.7049 - accuracy20: 0.6824 - accuracy30: 0.6567 - accuracy50: 0.6281 - val_loss: 9.1539 - val_accuracy10: 0.7664 - val_accuracy20: 0.7410 - val_accuracy30: 0.7131 - val_accuracy50: 0.6670 - 52s/epoch - 28ms/step
Epoch 30/50
1814/1814 - 52s - loss: 8.4196 - accuracy10: 0.7045 - accuracy20: 0.6825 - accuracy30: 0.6574 - accuracy50: 0.6296 - val_loss: 9.1357 - val_accuracy10: 0.7710 - val_accuracy20: 0.7473 - val_accuracy30: 0.7204 - val_accuracy50: 0.6743 - 52s/epoch - 29ms/step
Epoch 31/50
1814/1814 - 52s - loss: 8.4005 - accuracy10: 0.7047 - accuracy20: 0.6826 - accuracy30: 0.6573 - accuracy50: 0.6298 - val_loss: 9.1752 - val_accuracy10: 0.7661 - val_accuracy20: 0.7421 - val_accuracy30: 0.7149 - val_accuracy50: 0.6705 - 52s/epoch - 29ms/step
Epoch 32/50
1814/1814 - 52s - loss: 8.3950 - accuracy10: 0.7048 - accuracy20: 0.6836 - accuracy30: 0.6588 - accuracy50: 0.6311 - val_loss: 9.1893 - val_accuracy10: 0.7690 - val_accuracy20: 0.7439 - val_accuracy30: 0.7164 - val_accuracy50: 0.6720 - 52s/epoch - 29ms/step
Epoch 33/50
1814/1814 - 52s - loss: 8.3572 - accuracy10: 0.7055 - accuracy20: 0.6839 - accuracy30: 0.6594 - accuracy50: 0.6318 - val_loss: 9.1773 - val_accuracy10: 0.7484 - val_accuracy20: 0.7276 - val_accuracy30: 0.7036 - val_accuracy50: 0.6613 - 52s/epoch - 29ms/step
Epoch 34/50
1814/1814 - 52s - loss: 8.3495 - accuracy10: 0.7057 - accuracy20: 0.6854 - accuracy30: 0.6599 - accuracy50: 0.6324 - val_loss: 9.1892 - val_accuracy10: 0.7452 - val_accuracy20: 0.7230 - val_accuracy30: 0.6984 - val_accuracy50: 0.6561 - 52s/epoch - 29ms/step
Epoch 35/50
1814/1814 - 52s - loss: 8.3296 - accuracy10: 0.7056 - accuracy20: 0.6850 - accuracy30: 0.6600 - accuracy50: 0.6326 - val_loss: 9.2235 - val_accuracy10: 0.7287 - val_accuracy20: 0.7068 - val_accuracy30: 0.6810 - val_accuracy50: 0.6424 - 52s/epoch - 28ms/step
Epoch 36/50
1814/1814 - 53s - loss: 8.3092 - accuracy10: 0.7061 - accuracy20: 0.6856 - accuracy30: 0.6606 - accuracy50: 0.6331 - val_loss: 9.2471 - val_accuracy10: 0.7357 - val_accuracy20: 0.7117 - val_accuracy30: 0.6851 - val_accuracy50: 0.6452 - 53s/epoch - 29ms/step
testing model: results/AAL/W8/deepVOL_L2/seq2seq
Evaluating performance on  test set...
5918/5918 - 57s - 57s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.57157564
{'0': {'precision': 0.3273000480558883, 'recall': 0.6985992039191672, 'f1-score': 0.44575829951011287, 'support': 130640}, '1': {'precision': 0.9343415281328095, 'recall': 0.7810263233372637, 'f1-score': 0.8508324646908775, 'support': 1255160}, '2': {'precision': 0.37067563809075543, 'recall': 0.5363677171692155, 'f1-score': 0.438387966043799, 'support': 129208}, 'accuracy': 0.7530527891601893, 'macro avg': {'precision': 0.544105738093151, 'recall': 0.6719977481418821, 'f1-score': 0.5783262434149298, 'support': 1515008}, 'weighted avg': {'precision': 0.8339235492985045, 'recall': 0.7530527891601893, 'f1-score': 0.7807272126259334, 'support': 1515008}}
[[ 91265  30413   8962]
 [166148 980313 108699]
 [ 21429  38476  69303]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.62112075
{'0': {'precision': 0.38985536988504277, 'recall': 0.6484449318993206, 'f1-score': 0.48694917711425856, 'support': 178706}, '1': {'precision': 0.8859502282212878, 'recall': 0.7781714007785456, 'f1-score': 0.8285706021733352, 'support': 1159598}, '2': {'precision': 0.43794356498258363, 'recall': 0.49379187794277435, 'f1-score': 0.4641939448106357, 'support': 176704}, 'accuracy': 0.729700437225414, 'macro avg': {'precision': 0.571249721029638, 'recall': 0.6401360702068802, 'f1-score': 0.5932379080327431, 'support': 1515008}, 'weighted avg': {'precision': 0.7751787358101789, 'recall': 0.729700437225414, 'f1-score': 0.7457745963111709, 'support': 1515008}}
[[115881  51249  11576]
 [156825 902366 100407]
 [ 24535  64914  87255]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.68072236
{'0': {'precision': 0.4220449809127467, 'recall': 0.6111264915146314, 'f1-score': 0.49928375943364217, 'support': 216726}, '1': {'precision': 0.8394546301222717, 'recall': 0.7695904459203649, 'f1-score': 0.8030057985878268, 'support': 1084521}, '2': {'precision': 0.46907816841850913, 'recall': 0.45407721707888715, 'f1-score': 0.461455812648864, 'support': 213761}, 'accuracy': 0.7024042117269348, 'macro avg': {'precision': 0.5768592598178426, 'recall': 0.6115980515046279, 'f1-score': 0.5879151235567777, 'support': 1515008}, 'weighted avg': {'precision': 0.7274845504495298, 'recall': 0.7024042117269348, 'f1-score': 0.7113663292239498, 'support': 1515008}}
[[132447  70935  13344]
 [153367 834637  96517]
 [ 28008  88689  97064]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.78337294
{'0': {'precision': 0.46494457014616536, 'recall': 0.539787713320312, 'f1-score': 0.49957858520083587, 'support': 280564}, '1': {'precision': 0.7495326892901879, 'recall': 0.7662686414506333, 'f1-score': 0.7578082746035482, 'support': 958147}, '2': {'precision': 0.5090826737865929, 'recall': 0.38645008812980236, 'f1-score': 0.4393698422136586, 'support': 276297}, 'accuracy': 0.6550579270868536, 'macro avg': {'precision': 0.5745199777409821, 'recall': 0.5641688143002492, 'f1-score': 0.5655855673393475, 'support': 1515008}, 'weighted avg': {'precision': 0.6529782163150483, 'recall': 0.6550579270868536, 'f1-score': 0.6519121089518738, 'support': 1515008}}
[[151445 111014  18105]
 [139089 734198  84860]
 [ 35193 134329 106775]]
Evaluating performance on  train set...
1814/1814 - 18s - 18s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.62380236
{'0': {'precision': 0.3492128777518431, 'recall': 0.701607238772053, 'f1-score': 0.46632202610206025, 'support': 48406}, '1': {'precision': 0.928347621237638, 'recall': 0.7637247029682758, 'f1-score': 0.8380280217794517, 'support': 367385}, '2': {'precision': 0.3984009631264567, 'recall': 0.5323378980366276, 'f1-score': 0.45573240816758914, 'support': 48488}, 'accuracy': 0.7330829091989945, 'macro avg': {'precision': 0.5586538207053126, 'recall': 0.6658899465923188, 'f1-score': 0.586694152016367, 'support': 464279}, 'weighted avg': {'precision': 0.8126205477502128, 'recall': 0.7330829091989945, 'f1-score': 0.7593478528733159, 'support': 464279}}
[[ 33962  10143   4301]
 [ 52128 280581  34676]
 [ 11163  11513  25812]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6630969
{'0': {'precision': 0.40814219625030435, 'recall': 0.6540148263753414, 'f1-score': 0.5026206896551724, 'support': 64075}, '1': {'precision': 0.879829206507656, 'recall': 0.7655525875864859, 'f1-score': 0.8187224729162922, 'support': 336182}, '2': {'precision': 0.46516710813901313, 'recall': 0.501968073474743, 'f1-score': 0.48286742444162306, 'support': 64022}, 'accuracy': 0.7138121689759821, 'macro avg': {'precision': 0.5843795036323245, 'recall': 0.6405118291455234, 'f1-score': 0.6014035290043626, 'support': 464279}, 'weighted avg': {'precision': 0.757551778400856, 'recall': 0.7138121689759821, 'f1-score': 0.7287844535876095, 'support': 464279}}
[[ 41906  16136   6033]
 [ 47900 257365  30917]
 [ 12869  19016  32137]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7127021
{'0': {'precision': 0.4358290743371649, 'recall': 0.6224702224096131, 'f1-score': 0.5126916774284567, 'support': 75896}, '1': {'precision': 0.8342111916399798, 'recall': 0.7600367269504794, 'f1-score': 0.7953984274165874, 'support': 312577}, '2': {'precision': 0.49649070987524085, 'recall': 0.465649157058808, 'f1-score': 0.48057561792475306, 'support': 75806}, 'accuracy': 0.6894819709700417, 'macro avg': {'precision': 0.5888436586174618, 'recall': 0.6160520354729668, 'f1-score': 0.5962219075899324, 'support': 464279}, 'weighted avg': {'precision': 0.7139454720716336, 'recall': 0.6894819709700417, 'f1-score': 0.6977808970233601, 'support': 464279}}
[[ 47243  21532   7121]
 [ 46330 237570  28677]
 [ 14825  25682  35299]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.800098
{'0': {'precision': 0.46988187924245933, 'recall': 0.5595892300184592, 'f1-score': 0.5108270385434824, 'support': 94262}, '1': {'precision': 0.7476783004552352, 'recall': 0.7611193294781721, 'f1-score': 0.7543389456848294, 'support': 275129}, '2': {'precision': 0.5287298807438913, 'recall': 0.4008936851867465, 'f1-score': 0.45602215375762734, 'support': 94888}, 'accuracy': 0.6465810428643122, 'macro avg': {'precision': 0.5820966868138618, 'recall': 0.5738674148944592, 'f1-score': 0.5737293793286464, 'support': 464279}, 'weighted avg': {'precision': 0.6465295861995211, 'recall': 0.6465810428643122, 'f1-score': 0.6439298960759822, 'support': 464279}}
[[ 52748  32066   9448]
 [ 41265 209406  24458]
 [ 18245  38603  38040]]
Evaluating performance on  val set...
636/636 - 6s - 6s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5520637
{'0': {'precision': 0.32271288837744533, 'recall': 0.6688529477528509, 'f1-score': 0.4353668890236507, 'support': 13417}, '1': {'precision': 0.9364966847915352, 'recall': 0.796513466020631, 'f1-score': 0.8608515304662916, 'support': 136009}, '2': {'precision': 0.3631401091759813, 'recall': 0.5253459687123947, 'f1-score': 0.42943653745657984, 'support': 13296}, 'accuracy': 0.7638303364019616, 'macro avg': {'precision': 0.5407832274483205, 'recall': 0.6635707941619589, 'f1-score': 0.5752183189821741, 'support': 162722}, 'weighted avg': {'precision': 0.8390391423211117, 'recall': 0.7638303364019616, 'f1-score': 0.7905179481523265, 'support': 162722}}
[[  8974   3411   1032]
 [ 16458 108333  11218]
 [  2376   3935   6985]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.60480106
{'0': {'precision': 0.3796308770039068, 'recall': 0.6209441965515342, 'f1-score': 0.47118821193437144, 'support': 18153}, '1': {'precision': 0.8934331489944343, 'recall': 0.7936688465548289, 'f1-score': 0.8406012899124164, 'support': 126612}, '2': {'precision': 0.4249854057209574, 'recall': 0.48649551706855265, 'f1-score': 0.45366499623503753, 'support': 17957}, 'accuracy': 0.7405022062167378, 'macro avg': {'precision': 0.5660164772397661, 'recall': 0.6337028533916386, 'f1-score': 0.5884848326939417, 'support': 162722}, 'weighted avg': {'precision': 0.7844191940934014, 'recall': 0.7405022062167378, 'f1-score': 0.7566902598728389, 'support': 162722}}
[[ 11272   5504   1377]
 [ 15681 100488  10443]
 [  2739   6482   8736]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.66119766
{'0': {'precision': 0.40900878054965606, 'recall': 0.5866066557555919, 'f1-score': 0.48196776422688303, 'support': 21996}, '1': {'precision': 0.8527790683903177, 'recall': 0.7862236370203008, 'f1-score': 0.8181500353980755, 'support': 119059}, '2': {'precision': 0.45665171898355755, 'recall': 0.4511930585683297, 'f1-score': 0.453905977945444, 'support': 21667}, 'accuracy': 0.714629859515001, 'macro avg': {'precision': 0.5728131893078438, 'recall': 0.6080077837814075, 'f1-score': 0.5846745925234674, 'support': 162722}, 'weighted avg': {'precision': 0.7400465397160175, 'recall': 0.714629859515001, 'f1-score': 0.7242061235145704, 'support': 162722}}
[[12903  7428  1665]
 [15485 93607  9967]
 [ 3159  8732  9776]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7569759
{'0': {'precision': 0.45021315468940315, 'recall': 0.5204153467089053, 'f1-score': 0.4827755102040816, 'support': 28410}, '1': {'precision': 0.7726324148629682, 'recall': 0.7861491628614916, 'f1-score': 0.7793321846039213, 'support': 106434}, '2': {'precision': 0.4963402205132956, 'recall': 0.38431738288255973, 'f1-score': 0.433203946304383, 'support': 27878}, 'accuracy': 0.6709111244945367, 'macro avg': {'precision': 0.573061930021889, 'recall': 0.5636272974843188, 'f1-score': 0.5651038803707954, 'support': 162722}, 'weighted avg': {'precision': 0.6690053393869345, 'recall': 0.6709111244945367, 'f1-score': 0.6682560046957713, 'support': 162722}}
[[14785 11370  2255]
 [14144 83673  8617]
 [ 3911 13253 10714]]
training model: results/AAL/W8/deepVOL_L3/seq2seq
Epoch 1/50
1814/1814 - 85s - loss: 11.6507 - accuracy10: 0.4550 - accuracy20: 0.4724 - accuracy30: 0.4816 - accuracy50: 0.4884 - val_loss: 10.3806 - val_accuracy10: 0.7382 - val_accuracy20: 0.7229 - val_accuracy30: 0.7017 - val_accuracy50: 0.6548 - 85s/epoch - 47ms/step
Epoch 2/50
1814/1814 - 75s - loss: 10.3664 - accuracy10: 0.5822 - accuracy20: 0.5860 - accuracy30: 0.5807 - accuracy50: 0.5681 - val_loss: 9.9017 - val_accuracy10: 0.7490 - val_accuracy20: 0.7308 - val_accuracy30: 0.7099 - val_accuracy50: 0.6654 - 75s/epoch - 42ms/step
Epoch 3/50
1814/1814 - 75s - loss: 9.7771 - accuracy10: 0.6456 - accuracy20: 0.6335 - accuracy30: 0.6152 - accuracy50: 0.5901 - val_loss: 9.4739 - val_accuracy10: 0.7445 - val_accuracy20: 0.7269 - val_accuracy30: 0.7075 - val_accuracy50: 0.6665 - 75s/epoch - 42ms/step
Epoch 4/50
1814/1814 - 76s - loss: 9.4460 - accuracy10: 0.6640 - accuracy20: 0.6477 - accuracy30: 0.6251 - accuracy50: 0.5982 - val_loss: 9.1794 - val_accuracy10: 0.7503 - val_accuracy20: 0.7324 - val_accuracy30: 0.7106 - val_accuracy50: 0.6678 - 76s/epoch - 42ms/step
Epoch 5/50
1814/1814 - 76s - loss: 9.2570 - accuracy10: 0.6713 - accuracy20: 0.6545 - accuracy30: 0.6313 - accuracy50: 0.6024 - val_loss: 9.0526 - val_accuracy10: 0.7606 - val_accuracy20: 0.7423 - val_accuracy30: 0.7193 - val_accuracy50: 0.6755 - 76s/epoch - 42ms/step
Epoch 6/50
1814/1814 - 75s - loss: 9.1290 - accuracy10: 0.6784 - accuracy20: 0.6608 - accuracy30: 0.6362 - accuracy50: 0.6068 - val_loss: 9.1453 - val_accuracy10: 0.7831 - val_accuracy20: 0.7593 - val_accuracy30: 0.7327 - val_accuracy50: 0.6819 - 75s/epoch - 41ms/step
Epoch 7/50
1814/1814 - 76s - loss: 9.0392 - accuracy10: 0.6837 - accuracy20: 0.6649 - accuracy30: 0.6405 - accuracy50: 0.6103 - val_loss: 8.8717 - val_accuracy10: 0.7867 - val_accuracy20: 0.7640 - val_accuracy30: 0.7371 - val_accuracy50: 0.6867 - 76s/epoch - 42ms/step
Epoch 8/50
1814/1814 - 75s - loss: 8.9683 - accuracy10: 0.6870 - accuracy20: 0.6666 - accuracy30: 0.6412 - accuracy50: 0.6116 - val_loss: 8.9474 - val_accuracy10: 0.7922 - val_accuracy20: 0.7671 - val_accuracy30: 0.7395 - val_accuracy50: 0.6888 - 75s/epoch - 41ms/step
Epoch 9/50
1814/1814 - 75s - loss: 8.9127 - accuracy10: 0.6892 - accuracy20: 0.6689 - accuracy30: 0.6438 - accuracy50: 0.6134 - val_loss: 8.7984 - val_accuracy10: 0.7856 - val_accuracy20: 0.7624 - val_accuracy30: 0.7351 - val_accuracy50: 0.6841 - 75s/epoch - 42ms/step
Epoch 10/50
1814/1814 - 75s - loss: 8.8564 - accuracy10: 0.6909 - accuracy20: 0.6707 - accuracy30: 0.6460 - accuracy50: 0.6162 - val_loss: 8.7535 - val_accuracy10: 0.7987 - val_accuracy20: 0.7726 - val_accuracy30: 0.7440 - val_accuracy50: 0.6917 - 75s/epoch - 42ms/step
Epoch 11/50
1814/1814 - 76s - loss: 8.8136 - accuracy10: 0.6925 - accuracy20: 0.6721 - accuracy30: 0.6470 - accuracy50: 0.6162 - val_loss: 8.7131 - val_accuracy10: 0.7955 - val_accuracy20: 0.7692 - val_accuracy30: 0.7402 - val_accuracy50: 0.6878 - 76s/epoch - 42ms/step
Epoch 12/50
1814/1814 - 76s - loss: 8.7838 - accuracy10: 0.6949 - accuracy20: 0.6745 - accuracy30: 0.6495 - accuracy50: 0.6185 - val_loss: 8.5724 - val_accuracy10: 0.7840 - val_accuracy20: 0.7626 - val_accuracy30: 0.7359 - val_accuracy50: 0.6868 - 76s/epoch - 42ms/step
Epoch 13/50
1814/1814 - 76s - loss: 8.7475 - accuracy10: 0.6956 - accuracy20: 0.6747 - accuracy30: 0.6500 - accuracy50: 0.6188 - val_loss: 8.5821 - val_accuracy10: 0.7847 - val_accuracy20: 0.7619 - val_accuracy30: 0.7351 - val_accuracy50: 0.6867 - 76s/epoch - 42ms/step
Epoch 14/50
1814/1814 - 76s - loss: 8.7149 - accuracy10: 0.6954 - accuracy20: 0.6748 - accuracy30: 0.6508 - accuracy50: 0.6197 - val_loss: 8.5416 - val_accuracy10: 0.7733 - val_accuracy20: 0.7520 - val_accuracy30: 0.7259 - val_accuracy50: 0.6783 - 76s/epoch - 42ms/step
Epoch 15/50
1814/1814 - 77s - loss: 8.6814 - accuracy10: 0.6980 - accuracy20: 0.6765 - accuracy30: 0.6520 - accuracy50: 0.6207 - val_loss: 8.5843 - val_accuracy10: 0.7825 - val_accuracy20: 0.7587 - val_accuracy30: 0.7317 - val_accuracy50: 0.6822 - 77s/epoch - 42ms/step
Epoch 16/50
1814/1814 - 76s - loss: 8.6511 - accuracy10: 0.6990 - accuracy20: 0.6780 - accuracy30: 0.6532 - accuracy50: 0.6213 - val_loss: 8.5656 - val_accuracy10: 0.7705 - val_accuracy20: 0.7475 - val_accuracy30: 0.7204 - val_accuracy50: 0.6733 - 76s/epoch - 42ms/step
Epoch 17/50
1814/1814 - 74s - loss: 8.6306 - accuracy10: 0.6988 - accuracy20: 0.6776 - accuracy30: 0.6533 - accuracy50: 0.6224 - val_loss: 8.5316 - val_accuracy10: 0.7676 - val_accuracy20: 0.7453 - val_accuracy30: 0.7173 - val_accuracy50: 0.6717 - 74s/epoch - 41ms/step
Epoch 18/50
1814/1814 - 77s - loss: 8.6094 - accuracy10: 0.6997 - accuracy20: 0.6785 - accuracy30: 0.6541 - accuracy50: 0.6226 - val_loss: 8.5918 - val_accuracy10: 0.7637 - val_accuracy20: 0.7423 - val_accuracy30: 0.7163 - val_accuracy50: 0.6705 - 77s/epoch - 42ms/step
Epoch 19/50
1814/1814 - 76s - loss: 8.5864 - accuracy10: 0.7002 - accuracy20: 0.6785 - accuracy30: 0.6544 - accuracy50: 0.6231 - val_loss: 8.6792 - val_accuracy10: 0.7758 - val_accuracy20: 0.7516 - val_accuracy30: 0.7245 - val_accuracy50: 0.6768 - 76s/epoch - 42ms/step
Epoch 20/50
1814/1814 - 75s - loss: 8.5631 - accuracy10: 0.7005 - accuracy20: 0.6792 - accuracy30: 0.6554 - accuracy50: 0.6247 - val_loss: 8.6236 - val_accuracy10: 0.7702 - val_accuracy20: 0.7462 - val_accuracy30: 0.7187 - val_accuracy50: 0.6717 - 75s/epoch - 41ms/step
Epoch 21/50
1814/1814 - 75s - loss: 8.5410 - accuracy10: 0.7011 - accuracy20: 0.6790 - accuracy30: 0.6552 - accuracy50: 0.6242 - val_loss: 8.6537 - val_accuracy10: 0.7771 - val_accuracy20: 0.7508 - val_accuracy30: 0.7236 - val_accuracy50: 0.6749 - 75s/epoch - 41ms/step
Epoch 22/50
1814/1814 - 76s - loss: 8.5324 - accuracy10: 0.7002 - accuracy20: 0.6793 - accuracy30: 0.6562 - accuracy50: 0.6248 - val_loss: 8.6048 - val_accuracy10: 0.7824 - val_accuracy20: 0.7569 - val_accuracy30: 0.7298 - val_accuracy50: 0.6811 - 76s/epoch - 42ms/step
Epoch 23/50
1814/1814 - 76s - loss: 8.4951 - accuracy10: 0.7009 - accuracy20: 0.6795 - accuracy30: 0.6567 - accuracy50: 0.6260 - val_loss: 8.6418 - val_accuracy10: 0.7736 - val_accuracy20: 0.7468 - val_accuracy30: 0.7196 - val_accuracy50: 0.6712 - 76s/epoch - 42ms/step
Epoch 24/50
1814/1814 - 76s - loss: 8.4874 - accuracy10: 0.7024 - accuracy20: 0.6810 - accuracy30: 0.6573 - accuracy50: 0.6260 - val_loss: 8.6037 - val_accuracy10: 0.7734 - val_accuracy20: 0.7461 - val_accuracy30: 0.7191 - val_accuracy50: 0.6714 - 76s/epoch - 42ms/step
Epoch 25/50
1814/1814 - 77s - loss: 8.4620 - accuracy10: 0.7025 - accuracy20: 0.6808 - accuracy30: 0.6577 - accuracy50: 0.6266 - val_loss: 8.6109 - val_accuracy10: 0.7695 - val_accuracy20: 0.7437 - val_accuracy30: 0.7161 - val_accuracy50: 0.6700 - 77s/epoch - 42ms/step
Epoch 26/50
1814/1814 - 76s - loss: 8.4422 - accuracy10: 0.7028 - accuracy20: 0.6820 - accuracy30: 0.6591 - accuracy50: 0.6280 - val_loss: 8.6604 - val_accuracy10: 0.7751 - val_accuracy20: 0.7478 - val_accuracy30: 0.7184 - val_accuracy50: 0.6697 - 76s/epoch - 42ms/step
Epoch 27/50
1814/1814 - 77s - loss: 8.4184 - accuracy10: 0.7033 - accuracy20: 0.6823 - accuracy30: 0.6585 - accuracy50: 0.6277 - val_loss: 8.6687 - val_accuracy10: 0.7737 - val_accuracy20: 0.7468 - val_accuracy30: 0.7184 - val_accuracy50: 0.6703 - 77s/epoch - 43ms/step
testing model: results/AAL/W8/deepVOL_L3/seq2seq
Evaluating performance on  test set...
5918/5918 - 99s - 99s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5526508
{'0': {'precision': 0.33254782466307375, 'recall': 0.7150949173300674, 'f1-score': 0.453977772486284, 'support': 130640}, '1': {'precision': 0.9366817203393407, 'recall': 0.7956563306670066, 'f1-score': 0.8604287600507464, 'support': 1255160}, '2': {'precision': 0.40953895450295114, 'recall': 0.5321806699275586, 'f1-score': 0.46287389476589397, 'support': 129208}, 'accuracy': 0.7662388581446434, 'macro avg': {'precision': 0.5595894998351219, 'recall': 0.6809773059748775, 'f1-score': 0.5924268091009748, 'support': 1515008}, 'weighted avg': {'precision': 0.8396293518902396, 'recall': 0.7662388581446434, 'f1-score': 0.7914746515251502, 'support': 1515008}}
[[ 93420  27733   9487]
 [166832 998676  89652]
 [ 20670  39776  68762]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.60287195
{'0': {'precision': 0.4001832859395426, 'recall': 0.6646447237361924, 'f1-score': 0.49957308994553223, 'support': 178706}, '1': {'precision': 0.8899875791333318, 'recall': 0.7915415514686986, 'f1-score': 0.8378827774727319, 'support': 1159598}, '2': {'precision': 0.4672802675585284, 'recall': 0.49417670228178195, 'f1-score': 0.4803522755714714, 'support': 176704}, 'accuracy': 0.741889811802974, 'macro avg': {'precision': 0.5858170442104677, 'recall': 0.6501209924955577, 'f1-score': 0.6059360476632452, 'support': 1515008}, 'weighted avg': {'precision': 0.782908911031247, 'recall': 0.741889811802974, 'f1-score': 0.7562759207253114, 'support': 1515008}}
[[118776  48620  11310]
 [153486 917870  88242]
 [ 24542  64839  87323]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6620837
{'0': {'precision': 0.4317214773951425, 'recall': 0.6268652584369203, 'f1-score': 0.51130660594827, 'support': 216726}, '1': {'precision': 0.844725212374034, 'recall': 0.7797211856662988, 'f1-score': 0.8109225948594759, 'support': 1084521}, '2': {'precision': 0.4936086923791122, 'recall': 0.4601119942365539, 'f1-score': 0.47627210568113587, 'support': 213761}, 'accuracy': 0.7127592725582967, 'macro avg': {'precision': 0.5900184607160962, 'recall': 0.6222328127799243, 'f1-score': 0.599500435496294, 'support': 1515008}, 'weighted avg': {'precision': 0.7361029041765396, 'recall': 0.7127592725582967, 'f1-score': 0.72084399591477, 'support': 1515008}}
[[135858  67742  13126]
 [151122 845624  87775]
 [ 27709  87698  98354]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7624319
{'0': {'precision': 0.4720544888241823, 'recall': 0.563960451091373, 'f1-score': 0.51393093323286, 'support': 280564}, '1': {'precision': 0.7580354801881982, 'recall': 0.7664366741220293, 'f1-score': 0.7622129281394645, 'support': 958147}, '2': {'precision': 0.5251073185061643, 'recall': 0.40111184703416974, 'f1-score': 0.4548097777577147, 'support': 276297}, 'accuracy': 0.6623146544440689, 'macro avg': {'precision': 0.5850657625061816, 'recall': 0.5771696574158574, 'f1-score': 0.5769845463766797, 'support': 1515008}, 'weighted avg': {'precision': 0.6625948467728534, 'recall': 0.6623146544440689, 'f1-score': 0.6601715145891711, 'support': 1515008}}
[[158227 104488  17849]
 [141409 734359  82379]
 [ 35552 129919 110826]]
Evaluating performance on  train set...
1814/1814 - 31s - 31s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6132324
{'0': {'precision': 0.34172132244679426, 'recall': 0.6856381440317316, 'f1-score': 0.456115275993101, 'support': 48406}, '1': {'precision': 0.9321940701886515, 'recall': 0.7614083318589491, 'f1-score': 0.8381900392831352, 'support': 367385}, '2': {'precision': 0.41567405596386353, 'recall': 0.5750494967827091, 'f1-score': 0.4825425943392145, 'support': 48488}, 'accuracy': 0.7340456923530894, 'macro avg': {'precision': 0.5631964828664365, 'recall': 0.67403199089113, 'f1-score': 0.5922826365384836, 'support': 464279}, 'weighted avg': {'precision': 0.8166871308764623, 'recall': 0.7340456923530894, 'f1-score': 0.7612118767940753, 'support': 464279}}
[[ 33189   9095   6122]
 [ 54581 279730  33074]
 [  9353  11252  27883]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.65122867
{'0': {'precision': 0.4047825874774291, 'recall': 0.647241513850956, 'f1-score': 0.4980724193838948, 'support': 64075}, '1': {'precision': 0.8857949024720002, 'recall': 0.7620009399670417, 'f1-score': 0.8192477865493195, 'support': 336182}, '2': {'precision': 0.4728261617900172, 'recall': 0.5363625003904907, 'f1-score': 0.502594275761634, 'support': 64022}, 'accuracy': 0.7150484945474596, 'macro avg': {'precision': 0.5878012172464822, 'recall': 0.6485349847361629, 'f1-score': 0.6066381605649495, 'support': 464279}, 'weighted avg': {'precision': 0.7624639984267622, 'recall': 0.7150484945474596, 'f1-score': 0.7312573697551639, 'support': 464279}}
[[ 41472  15007   7596]
 [ 49321 256171  30690]
 [ 11662  18021  34339]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7004859
{'0': {'precision': 0.4332750178186295, 'recall': 0.616738695056393, 'f1-score': 0.5089790082042528, 'support': 75896}, '1': {'precision': 0.8424473202015574, 'recall': 0.7530944375305925, 'f1-score': 0.7952689269105965, 'support': 312577}, '2': {'precision': 0.4978521777615787, 'recall': 0.50452470780677, 'f1-score': 0.5011662342427341, 'support': 75806}, 'accuracy': 0.6902185970074028, 'macro avg': {'precision': 0.5911915052605886, 'recall': 0.6247859467979184, 'f1-score': 0.6018047231191944, 'support': 464279}, 'weighted avg': {'precision': 0.7192952490773847, 'recall': 0.6902185970074028, 'f1-score': 0.7004487683625754, 'support': 464279}}
[[ 46808  19999   9089]
 [ 47690 235400  29487]
 [ 13535  24025  38246]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.78430146
{'0': {'precision': 0.46501174161438436, 'recall': 0.5629946319831958, 'f1-score': 0.5093336404556927, 'support': 94262}, '1': {'precision': 0.7604437987448491, 'recall': 0.7438656048617194, 'f1-score': 0.7520633520743762, 'support': 275129}, '2': {'precision': 0.5229438191153238, 'recall': 0.4465369699013574, 'f1-score': 0.48172950111419344, 'support': 94888}, 'accuracy': 0.6463764245206007, 'macro avg': {'precision': 0.5827997864915191, 'recall': 0.5844657355820909, 'f1-score': 0.5810421645480875, 'support': 464279}, 'weighted avg': {'precision': 0.6519230286124109, 'recall': 0.6463764245206007, 'f1-score': 0.647532183258836, 'support': 464279}}
[[ 53069  29259  11934]
 [ 43751 204659  26719]
 [ 17304  35213  42371]]
Evaluating performance on  val set...
636/636 - 11s - 11s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.54415977
{'0': {'precision': 0.31560794293942335, 'recall': 0.7024670194529329, 'f1-score': 0.43553604436229204, 'support': 13417}, '1': {'precision': 0.9410665229335466, 'recall': 0.7958958598328052, 'f1-score': 0.862414703808602, 'support': 136009}, '2': {'precision': 0.39655655880208623, 'recall': 0.5318140794223827, 'f1-score': 0.45433225174285985, 'support': 13296}, 'accuracy': 0.7666142254888706, 'macro avg': {'precision': 0.5510770082250188, 'recall': 0.6767256529027069, 'f1-score': 0.5840943333045846, 'support': 162722}, 'weighted avg': {'precision': 0.8450034076149476, 'recall': 0.7666142254888706, 'f1-score': 0.7938726796418806, 'support': 162722}}
[[  9425   2932   1060]
 [ 18060 108249   9700]
 [  2378   3847   7071]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.59529805
{'0': {'precision': 0.3746244584295247, 'recall': 0.6525643144383848, 'f1-score': 0.47599148149636356, 'support': 18153}, '1': {'precision': 0.9007647977594657, 'recall': 0.7925552080371528, 'f1-score': 0.8432025006932364, 'support': 126612}, '2': {'precision': 0.4519518757297325, 'recall': 0.4957955114996937, 'f1-score': 0.4728595708519227, 'support': 17957}, 'accuracy': 0.7441894765305245, 'macro avg': {'precision': 0.575780377306241, 'recall': 0.6469716779917437, 'f1-score': 0.5973511843471743, 'support': 162722}, 'weighted avg': {'precision': 0.7925412064765148, 'recall': 0.7441894765305245, 'f1-score': 0.7613682703946825, 'support': 162722}}
[[ 11846   4922   1385]
 [ 16854 100347   9411]
 [  2921   6133   8903]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6512332
{'0': {'precision': 0.40255258382173564, 'recall': 0.6151573013275141, 'f1-score': 0.486647844773328, 'support': 21996}, '1': {'precision': 0.8611992048448985, 'recall': 0.7823264095952427, 'f1-score': 0.819870254473756, 'support': 119059}, '2': {'precision': 0.47885845184690273, 'recall': 0.4631005676835741, 'f1-score': 0.47084770418338384, 'support': 21667}, 'accuracy': 0.7172232396356977, 'macro avg': {'precision': 0.580870080171179, 'recall': 0.6201947595354437, 'f1-score': 0.5924552678101559, 'support': 162722}, 'weighted avg': {'precision': 0.7482914961685483, 'recall': 0.7172232396356977, 'f1-score': 0.7283532394363788, 'support': 162722}}
[[13531  6751  1714]
 [16710 93143  9206]
 [ 3372  8261 10034]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7439478
{'0': {'precision': 0.438812937645882, 'recall': 0.5558606124604013, 'f1-score': 0.4904500139755893, 'support': 28410}, '1': {'precision': 0.785272963770611, 'recall': 0.7714170283931826, 'f1-score': 0.7782833309635527, 'support': 106434}, '2': {'precision': 0.5091983046262062, 'recall': 0.4050864480952723, 'f1-score': 0.45121463960364394, 'support': 27878}, 'accuracy': 0.6710217426039503, 'macro avg': {'precision': 0.5777614020142331, 'recall': 0.5774546963162854, 'f1-score': 0.5733159948475953, 'support': 162722}, 'weighted avg': {'precision': 0.677485825646502, 'recall': 0.6710217426039503, 'f1-score': 0.6719955179243843, 'support': 162722}}
[[15792 10253  2365]
 [15809 82105  8520]
 [ 4387 12198 11293]]
training model: results/AAL/W9/deepLOB_L1/seq2seq
Epoch 1/50
1577/1577 - 47s - loss: 10.6499 - accuracy10: 0.4971 - accuracy20: 0.5081 - accuracy30: 0.5137 - accuracy50: 0.5200 - val_loss: 13.2223 - val_accuracy10: 0.8001 - val_accuracy20: 0.7496 - val_accuracy30: 0.7098 - val_accuracy50: 0.6499 - 47s/epoch - 30ms/step
Epoch 2/50
1577/1577 - 43s - loss: 10.4351 - accuracy10: 0.5046 - accuracy20: 0.5183 - accuracy30: 0.5257 - accuracy50: 0.5320 - val_loss: 11.0589 - val_accuracy10: 0.5976 - val_accuracy20: 0.5866 - val_accuracy30: 0.5753 - val_accuracy50: 0.5619 - 43s/epoch - 27ms/step
Epoch 3/50
1577/1577 - 43s - loss: 9.9756 - accuracy10: 0.5572 - accuracy20: 0.5604 - accuracy30: 0.5585 - accuracy50: 0.5562 - val_loss: 10.5091 - val_accuracy10: 0.7358 - val_accuracy20: 0.6985 - val_accuracy30: 0.6715 - val_accuracy50: 0.6366 - 43s/epoch - 27ms/step
Epoch 4/50
1577/1577 - 42s - loss: 9.5864 - accuracy10: 0.6089 - accuracy20: 0.6004 - accuracy30: 0.5923 - accuracy50: 0.5804 - val_loss: 10.3311 - val_accuracy10: 0.7027 - val_accuracy20: 0.6778 - val_accuracy30: 0.6579 - val_accuracy50: 0.6268 - 42s/epoch - 26ms/step
Epoch 5/50
1577/1577 - 42s - loss: 9.4212 - accuracy10: 0.6250 - accuracy20: 0.6119 - accuracy30: 0.5993 - accuracy50: 0.5823 - val_loss: 9.8835 - val_accuracy10: 0.6220 - val_accuracy20: 0.6086 - val_accuracy30: 0.5999 - val_accuracy50: 0.5837 - 42s/epoch - 26ms/step
Epoch 6/50
1577/1577 - 40s - loss: 9.2538 - accuracy10: 0.6421 - accuracy20: 0.6263 - accuracy30: 0.6095 - accuracy50: 0.5881 - val_loss: 9.9408 - val_accuracy10: 0.6317 - val_accuracy20: 0.6151 - val_accuracy30: 0.6001 - val_accuracy50: 0.5785 - 40s/epoch - 26ms/step
Epoch 7/50
1577/1577 - 42s - loss: 9.0874 - accuracy10: 0.6581 - accuracy20: 0.6399 - accuracy30: 0.6201 - accuracy50: 0.5955 - val_loss: 10.1708 - val_accuracy10: 0.7095 - val_accuracy20: 0.6819 - val_accuracy30: 0.6581 - val_accuracy50: 0.6226 - 42s/epoch - 27ms/step
Epoch 8/50
1577/1577 - 42s - loss: 8.9873 - accuracy10: 0.6646 - accuracy20: 0.6453 - accuracy30: 0.6241 - accuracy50: 0.5986 - val_loss: 10.3385 - val_accuracy10: 0.5884 - val_accuracy20: 0.5732 - val_accuracy30: 0.5586 - val_accuracy50: 0.5379 - 42s/epoch - 27ms/step
Epoch 9/50
1577/1577 - 42s - loss: 8.9348 - accuracy10: 0.6699 - accuracy20: 0.6494 - accuracy30: 0.6283 - accuracy50: 0.6021 - val_loss: 10.2912 - val_accuracy10: 0.6848 - val_accuracy20: 0.6606 - val_accuracy30: 0.6380 - val_accuracy50: 0.6064 - 42s/epoch - 26ms/step
Epoch 10/50
1577/1577 - 42s - loss: 8.8071 - accuracy10: 0.6789 - accuracy20: 0.6590 - accuracy30: 0.6364 - accuracy50: 0.6090 - val_loss: 10.2414 - val_accuracy10: 0.6377 - val_accuracy20: 0.6172 - val_accuracy30: 0.5951 - val_accuracy50: 0.5698 - 42s/epoch - 26ms/step
Epoch 11/50
1577/1577 - 41s - loss: 8.7654 - accuracy10: 0.6792 - accuracy20: 0.6593 - accuracy30: 0.6359 - accuracy50: 0.6074 - val_loss: 10.5675 - val_accuracy10: 0.6374 - val_accuracy20: 0.6199 - val_accuracy30: 0.5994 - val_accuracy50: 0.5742 - 41s/epoch - 26ms/step
Epoch 12/50
1577/1577 - 42s - loss: 8.6823 - accuracy10: 0.6858 - accuracy20: 0.6655 - accuracy30: 0.6412 - accuracy50: 0.6117 - val_loss: 10.2534 - val_accuracy10: 0.6648 - val_accuracy20: 0.6446 - val_accuracy30: 0.6223 - val_accuracy50: 0.5938 - 42s/epoch - 27ms/step
Epoch 13/50
1577/1577 - 40s - loss: 8.6197 - accuracy10: 0.6894 - accuracy20: 0.6686 - accuracy30: 0.6434 - accuracy50: 0.6141 - val_loss: 10.4339 - val_accuracy10: 0.6743 - val_accuracy20: 0.6514 - val_accuracy30: 0.6290 - val_accuracy50: 0.6003 - 40s/epoch - 25ms/step
Epoch 14/50
1577/1577 - 43s - loss: 8.5776 - accuracy10: 0.6907 - accuracy20: 0.6705 - accuracy30: 0.6458 - accuracy50: 0.6158 - val_loss: 10.5122 - val_accuracy10: 0.6607 - val_accuracy20: 0.6386 - val_accuracy30: 0.6138 - val_accuracy50: 0.5854 - 43s/epoch - 27ms/step
Epoch 15/50
1577/1577 - 42s - loss: 8.5283 - accuracy10: 0.6932 - accuracy20: 0.6725 - accuracy30: 0.6481 - accuracy50: 0.6182 - val_loss: 10.4621 - val_accuracy10: 0.6708 - val_accuracy20: 0.6387 - val_accuracy30: 0.6116 - val_accuracy50: 0.5806 - 42s/epoch - 27ms/step
testing model: results/AAL/W9/deepLOB_L1/seq2seq
Evaluating performance on  test set...
3870/3870 - 40s - 40s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0573854
{'0': {'precision': 0.1869203786459084, 'recall': 0.7387800159056109, 'f1-score': 0.29835363822224564, 'support': 84247}, '1': {'precision': 0.9395310530963792, 'recall': 0.3440838723744458, 'f1-score': 0.5036985415962911, 'support': 825540}, '2': {'precision': 0.1640136753098752, 'recall': 0.7203964850267578, 'f1-score': 0.2671947485193538, 'support': 80911}, 'accuracy': 0.40838176719848024, 'macro avg': {'precision': 0.4301550356840543, 'recall': 0.6010867911022716, 'f1-score': 0.3564156427792968, 'support': 990698}, 'weighted avg': {'precision': 0.812193480955815, 'recall': 0.40838176719848024, 'f1-score': 0.46692098630073053, 'support': 990698}}
[[ 62240   9080  12927]
 [257315 284055 284170]
 [ 13421   9202  58288]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0685383
{'0': {'precision': 0.24231784779458512, 'recall': 0.7333951617796192, 'f1-score': 0.36427665807787607, 'support': 115373}, '1': {'precision': 0.9111941022407605, 'recall': 0.3192211574153949, 'f1-score': 0.47280368747810025, 'support': 765084}, '2': {'precision': 0.2112601009965781, 'recall': 0.7157137544107909, 'f1-score': 0.32622659023110523, 'support': 110241}, 'accuracy': 0.4115744656797531, 'macro avg': {'precision': 0.4549240170106413, 'recall': 0.5894433578686016, 'f1-score': 0.38776897859569387, 'support': 990698}, 'weighted avg': {'precision': 0.7554133453043596, 'recall': 0.4115744656797531, 'f1-score': 0.44385450746502053, 'support': 990698}}
[[ 84614  11504  19255]
 [245531 244231 275322]
 [ 19041  12299  78901]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.06733
{'0': {'precision': 0.28011792419561876, 'recall': 0.7171272154732843, 'f1-score': 0.40287022516701393, 'support': 138458}, '1': {'precision': 0.8824332297525862, 'recall': 0.3114899773541103, 'f1-score': 0.46044687818449187, 'support': 720219}, '2': {'precision': 0.2433436386625236, 'recall': 0.7041152543913468, 'f1-score': 0.36168739202838773, 'support': 132021}, 'accuracy': 0.42050251438884506, 'macro avg': {'precision': 0.4686315975369095, 'recall': 0.5775774824062472, 'f1-score': 0.4083348317932978, 'support': 990698}, 'weighted avg': {'precision': 0.713089373721679, 'recall': 0.42050251438884506, 'f1-score': 0.4392393312374817, 'support': 990698}}
[[ 99292  14114  25052]
 [231885 224341 263993]
 [ 23288  15775  92958]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0645827
{'0': {'precision': 0.33376732465350695, 'recall': 0.6737219883007884, 'f1-score': 0.4463896196298342, 'support': 176935}, '1': {'precision': 0.8228660011975164, 'recall': 0.31001061457951895, 'f1-score': 0.45035300613538237, 'support': 647223}, '2': {'precision': 0.28922275538220726, 'recall': 0.6767923621952684, 'f1-score': 0.4052602247191011, 'support': 166540}, 'accuracy': 0.4366254903108717, 'macro avg': {'precision': 0.48195202707774354, 'recall': 0.5535083216918586, 'f1-score': 0.43400095016143925, 'support': 990698}, 'weighted avg': {'precision': 0.6458073814239873, 'recall': 0.4366254903108717, 'f1-score': 0.44206489653141967, 'support': 990698}}
[[119205  20661  37069]
 [206649 200646 239928]
 [ 31296  22531 112713]]
Evaluating performance on  train set...
1577/1577 - 15s - 15s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.83935463
{'0': {'precision': 0.20936594295011948, 'recall': 0.7010351402887497, 'f1-score': 0.3224356514725574, 'support': 29368}, '1': {'precision': 0.9533038474926797, 'recall': 0.538673809413616, 'f1-score': 0.6883746719402655, 'support': 345712}, '2': {'precision': 0.18756772014167736, 'recall': 0.7245867041857194, 'f1-score': 0.2979957615165959, 'support': 28430}, 'accuracy': 0.5635895021189066, 'macro avg': {'precision': 0.4500791701948255, 'recall': 0.6547652179626949, 'f1-score': 0.4362686949764729, 'support': 403510}, 'weighted avg': {'precision': 0.8452077743316803, 'recall': 0.5635895021189066, 'f1-score': 0.6342363121067035, 'support': 403510}}
[[ 20588   4858   3922]
 [ 74181 186226  85305]
 [  3566   4264  20600]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8722828
{'0': {'precision': 0.26456134312375706, 'recall': 0.6840452882428557, 'f1-score': 0.38155318386144893, 'support': 40452}, '1': {'precision': 0.9265157880771272, 'recall': 0.5175200242081406, 'f1-score': 0.6640977585120672, 'support': 323858}, '2': {'precision': 0.23763366152073342, 'recall': 0.7154591836734694, 'f1-score': 0.35676940886135533, 'support': 39200}, 'accuracy': 0.553443532997943, 'macro avg': {'precision': 0.4762369309072059, 'recall': 0.6390081653748219, 'f1-score': 0.4674734504116238, 'support': 403510}, 'weighted avg': {'precision': 0.7932314566646111, 'recall': 0.553443532997943, 'f1-score': 0.6059163889299635, 'support': 403510}}
[[ 27671   7020   5761]
 [ 72040 167603  84215]
 [  4881   6273  28046]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.89536947
{'0': {'precision': 0.29856298174348345, 'recall': 0.6597149808828641, 'f1-score': 0.4110842145496241, 'support': 48909}, '1': {'precision': 0.8972516906231772, 'recall': 0.5058836170406741, 'f1-score': 0.646986684989121, 'support': 307124}, '2': {'precision': 0.27052290681888813, 'recall': 0.6967373675674537, 'f1-score': 0.38972637035727964, 'support': 47477}, 'accuracy': 0.5469852048276375, 'macro avg': {'precision': 0.48877919306184964, 'recall': 0.6207786551636639, 'f1-score': 0.48259908996534157, 'support': 403510}, 'weighted avg': {'precision': 0.7509443660679661, 'recall': 0.5469852048276375, 'f1-score': 0.588123950770635, 'support': 403510}}
[[ 32266   9326   7317]
 [ 69873 155369  81882]
 [  5932   8466  33079]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.92669785
{'0': {'precision': 0.3454959783108005, 'recall': 0.6065368985310162, 'f1-score': 0.44022861864756924, 'support': 63241}, '1': {'precision': 0.8339253514416495, 'recall': 0.4958742590341355, 'f1-score': 0.6219314737022011, 'support': 278859}, '2': {'precision': 0.3162469408699771, 'recall': 0.6523204689789937, 'f1-score': 0.42597830710336027, 'support': 61410}, 'accuracy': 0.5370275829595301, 'macro avg': {'precision': 0.49855609020747566, 'recall': 0.5849105421813817, 'f1-score': 0.49604613315104357, 'support': 403510}, 'weighted avg': {'precision': 0.6785899367570707, 'recall': 0.5370275829595301, 'f1-score': 0.5636316689455786, 'support': 403510}}
[[ 38358  14339  10544]
 [ 64513 138279  76067]
 [  8152  13199  40059]]
Evaluating performance on  val set...
600/600 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7562169
{'0': {'precision': 0.2510753403396745, 'recall': 0.5486434108527132, 'f1-score': 0.3444981898938274, 'support': 10320}, '1': {'precision': 0.9494218644580416, 'recall': 0.6159570132673238, 'f1-score': 0.7471712622212459, 'support': 132506}, '2': {'precision': 0.1842743640531458, 'recall': 0.7793674698795181, 'f1-score': 0.29807225012149685, 'support': 10624}, 'accuracy': 0.6227435646790486, 'macro avg': {'precision': 0.46159052295028724, 'recall': 0.6479892979998517, 'f1-score': 0.4632472340788567, 'support': 153450}, 'weighted avg': {'precision': 0.8494814071546647, 'recall': 0.6227435646790486, 'f1-score': 0.6889971728698826, 'support': 153450}}
[[ 5662  2785  1873]
 [16108 81618 34780]
 [  781  1563  8280]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7985917
{'0': {'precision': 0.31866709802652865, 'recall': 0.545781964260978, 'f1-score': 0.4023898279119645, 'support': 14438}, '1': {'precision': 0.9231507446874805, 'recall': 0.5961719561175457, 'f1-score': 0.7244762221483205, 'support': 124241}, '2': {'precision': 0.23567141708086703, 'recall': 0.7736104529144946, 'f1-score': 0.36128236744759556, 'support': 14771}, 'accuracy': 0.6085109156076898, 'macro avg': {'precision': 0.49249641993162535, 'recall': 0.6385214577643393, 'f1-score': 0.4960494725026268, 'support': 153450}, 'weighted avg': {'precision': 0.8000989881637391, 'recall': 0.6085109156076898, 'f1-score': 0.6592105343818239, 'support': 153450}}
[[ 7880  3789  2769]
 [15881 74069 34291]
 [  967  2377 11427]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.82890403
{'0': {'precision': 0.35593480934809346, 'recall': 0.5262858766695084, 'f1-score': 0.42466350232739447, 'support': 17595}, '1': {'precision': 0.8953218722875022, 'recall': 0.5859624727618046, 'f1-score': 0.7083380310562188, 'support': 117941}, '2': {'precision': 0.2705343815305005, 'recall': 0.7587920062520933, 'f1-score': 0.39886148564386215, 'support': 17914}, 'accuracy': 0.5992961876832844, 'macro avg': {'precision': 0.5072636877220321, 'recall': 0.6236801185611354, 'f1-score': 0.5106210063424919, 'support': 153450}, 'weighted avg': {'precision': 0.7605355674205108, 'recall': 0.5992961876832844, 'f1-score': 0.6396823375567036, 'support': 153450}}
[[ 9260  4835  3500]
 [15680 69109 33152]
 [ 1076  3245 13593]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8723567
{'0': {'precision': 0.402756956378661, 'recall': 0.48022845184636176, 'f1-score': 0.43809410173805824, 'support': 22937}, '1': {'precision': 0.8354987709678291, 'recall': 0.5764095301100417, 'f1-score': 0.6821823394811568, 'support': 107323}, '2': {'precision': 0.31858084096890066, 'recall': 0.7151789564467443, 'f1-score': 0.44080320004252554, 'support': 23190}, 'accuracy': 0.5830042359074618, 'macro avg': {'precision': 0.5189455227717968, 'recall': 0.5906056461343826, 'f1-score': 0.5203598804205801, 'support': 153450}, 'weighted avg': {'precision': 0.6926957354650145, 'recall': 0.5830042359074618, 'f1-score': 0.609218936726544, 'support': 153450}}
[[11015  6985  4937]
 [14924 61862 30537]
 [ 1410  5195 16585]]
training model: results/AAL/W9/deepOF_L1/seq2seq
Epoch 1/50
1577/1577 - 44s - loss: 11.7565 - accuracy10: 0.4367 - accuracy20: 0.4516 - accuracy30: 0.4599 - accuracy50: 0.4680 - val_loss: 11.7114 - val_accuracy10: 0.7116 - val_accuracy20: 0.7009 - val_accuracy30: 0.6856 - val_accuracy50: 0.6515 - 44s/epoch - 28ms/step
Epoch 2/50
1577/1577 - 39s - loss: 11.4158 - accuracy10: 0.4639 - accuracy20: 0.4725 - accuracy30: 0.4784 - accuracy50: 0.4860 - val_loss: 11.4103 - val_accuracy10: 0.7136 - val_accuracy20: 0.6969 - val_accuracy30: 0.6816 - val_accuracy50: 0.6511 - 39s/epoch - 25ms/step
Epoch 3/50
1577/1577 - 40s - loss: 11.2233 - accuracy10: 0.4920 - accuracy20: 0.4935 - accuracy30: 0.4996 - accuracy50: 0.5078 - val_loss: 11.0471 - val_accuracy10: 0.7145 - val_accuracy20: 0.6925 - val_accuracy30: 0.6806 - val_accuracy50: 0.6571 - 40s/epoch - 25ms/step
Epoch 4/50
1577/1577 - 41s - loss: 11.0721 - accuracy10: 0.5174 - accuracy20: 0.5104 - accuracy30: 0.5128 - accuracy50: 0.5194 - val_loss: 10.9758 - val_accuracy10: 0.7270 - val_accuracy20: 0.6973 - val_accuracy30: 0.6823 - val_accuracy50: 0.6585 - 41s/epoch - 26ms/step
Epoch 5/50
1577/1577 - 40s - loss: 10.9438 - accuracy10: 0.5330 - accuracy20: 0.5203 - accuracy30: 0.5198 - accuracy50: 0.5249 - val_loss: 10.8393 - val_accuracy10: 0.7250 - val_accuracy20: 0.6967 - val_accuracy30: 0.6817 - val_accuracy50: 0.6577 - 40s/epoch - 25ms/step
Epoch 6/50
1577/1577 - 39s - loss: 10.8361 - accuracy10: 0.5413 - accuracy20: 0.5264 - accuracy30: 0.5249 - accuracy50: 0.5298 - val_loss: 10.8144 - val_accuracy10: 0.7416 - val_accuracy20: 0.7110 - val_accuracy30: 0.6932 - val_accuracy50: 0.6655 - 39s/epoch - 25ms/step
Epoch 7/50
1577/1577 - 41s - loss: 10.7364 - accuracy10: 0.5492 - accuracy20: 0.5336 - accuracy30: 0.5317 - accuracy50: 0.5362 - val_loss: 10.7309 - val_accuracy10: 0.7505 - val_accuracy20: 0.7186 - val_accuracy30: 0.6979 - val_accuracy50: 0.6680 - 41s/epoch - 26ms/step
Epoch 8/50
1577/1577 - 39s - loss: 10.6518 - accuracy10: 0.5548 - accuracy20: 0.5397 - accuracy30: 0.5363 - accuracy50: 0.5403 - val_loss: 10.6222 - val_accuracy10: 0.7445 - val_accuracy20: 0.7103 - val_accuracy30: 0.6885 - val_accuracy50: 0.6604 - 39s/epoch - 25ms/step
Epoch 9/50
1577/1577 - 42s - loss: 10.5620 - accuracy10: 0.5582 - accuracy20: 0.5430 - accuracy30: 0.5379 - accuracy50: 0.5398 - val_loss: 10.7415 - val_accuracy10: 0.7554 - val_accuracy20: 0.7217 - val_accuracy30: 0.6990 - val_accuracy50: 0.6666 - 42s/epoch - 26ms/step
Epoch 10/50
1577/1577 - 40s - loss: 10.4824 - accuracy10: 0.5650 - accuracy20: 0.5482 - accuracy30: 0.5407 - accuracy50: 0.5414 - val_loss: 10.6596 - val_accuracy10: 0.7517 - val_accuracy20: 0.7173 - val_accuracy30: 0.6931 - val_accuracy50: 0.6623 - 40s/epoch - 25ms/step
Epoch 11/50
1577/1577 - 41s - loss: 10.4169 - accuracy10: 0.5693 - accuracy20: 0.5517 - accuracy30: 0.5425 - accuracy50: 0.5418 - val_loss: 10.6453 - val_accuracy10: 0.7557 - val_accuracy20: 0.7214 - val_accuracy30: 0.6969 - val_accuracy50: 0.6648 - 41s/epoch - 26ms/step
Epoch 12/50
1577/1577 - 39s - loss: 10.3450 - accuracy10: 0.5739 - accuracy20: 0.5547 - accuracy30: 0.5450 - accuracy50: 0.5438 - val_loss: 10.6302 - val_accuracy10: 0.7550 - val_accuracy20: 0.7195 - val_accuracy30: 0.6946 - val_accuracy50: 0.6627 - 39s/epoch - 25ms/step
Epoch 13/50
1577/1577 - 40s - loss: 10.2730 - accuracy10: 0.5787 - accuracy20: 0.5597 - accuracy30: 0.5486 - accuracy50: 0.5461 - val_loss: 10.5747 - val_accuracy10: 0.7498 - val_accuracy20: 0.7152 - val_accuracy30: 0.6898 - val_accuracy50: 0.6583 - 40s/epoch - 25ms/step
Epoch 14/50
1577/1577 - 40s - loss: 10.2261 - accuracy10: 0.5807 - accuracy20: 0.5610 - accuracy30: 0.5502 - accuracy50: 0.5474 - val_loss: 10.5218 - val_accuracy10: 0.7582 - val_accuracy20: 0.7250 - val_accuracy30: 0.6988 - val_accuracy50: 0.6654 - 40s/epoch - 26ms/step
Epoch 15/50
1577/1577 - 38s - loss: 10.1612 - accuracy10: 0.5833 - accuracy20: 0.5645 - accuracy30: 0.5531 - accuracy50: 0.5501 - val_loss: 10.5509 - val_accuracy10: 0.7565 - val_accuracy20: 0.7213 - val_accuracy30: 0.6932 - val_accuracy50: 0.6582 - 38s/epoch - 24ms/step
Epoch 16/50
1577/1577 - 39s - loss: 10.1103 - accuracy10: 0.5850 - accuracy20: 0.5662 - accuracy30: 0.5543 - accuracy50: 0.5510 - val_loss: 10.5661 - val_accuracy10: 0.7560 - val_accuracy20: 0.7206 - val_accuracy30: 0.6926 - val_accuracy50: 0.6604 - 39s/epoch - 25ms/step
Epoch 17/50
1577/1577 - 40s - loss: 10.0640 - accuracy10: 0.5876 - accuracy20: 0.5691 - accuracy30: 0.5581 - accuracy50: 0.5547 - val_loss: 10.4685 - val_accuracy10: 0.7487 - val_accuracy20: 0.7132 - val_accuracy30: 0.6877 - val_accuracy50: 0.6576 - 40s/epoch - 25ms/step
Epoch 18/50
1577/1577 - 37s - loss: 9.9985 - accuracy10: 0.5897 - accuracy20: 0.5712 - accuracy30: 0.5596 - accuracy50: 0.5557 - val_loss: 10.3805 - val_accuracy10: 0.7502 - val_accuracy20: 0.7162 - val_accuracy30: 0.6895 - val_accuracy50: 0.6584 - 37s/epoch - 23ms/step
Epoch 19/50
1577/1577 - 40s - loss: 9.9599 - accuracy10: 0.5921 - accuracy20: 0.5735 - accuracy30: 0.5619 - accuracy50: 0.5569 - val_loss: 10.5142 - val_accuracy10: 0.7454 - val_accuracy20: 0.7126 - val_accuracy30: 0.6858 - val_accuracy50: 0.6546 - 40s/epoch - 25ms/step
Epoch 20/50
1577/1577 - 39s - loss: 9.9016 - accuracy10: 0.5950 - accuracy20: 0.5769 - accuracy30: 0.5639 - accuracy50: 0.5582 - val_loss: 10.5836 - val_accuracy10: 0.7551 - val_accuracy20: 0.7229 - val_accuracy30: 0.6958 - val_accuracy50: 0.6623 - 39s/epoch - 24ms/step
Epoch 21/50
1577/1577 - 39s - loss: 9.8537 - accuracy10: 0.5968 - accuracy20: 0.5791 - accuracy30: 0.5657 - accuracy50: 0.5593 - val_loss: 10.5970 - val_accuracy10: 0.7519 - val_accuracy20: 0.7219 - val_accuracy30: 0.6959 - val_accuracy50: 0.6639 - 39s/epoch - 24ms/step
Epoch 22/50
1577/1577 - 40s - loss: 9.8147 - accuracy10: 0.5967 - accuracy20: 0.5790 - accuracy30: 0.5666 - accuracy50: 0.5603 - val_loss: 10.6106 - val_accuracy10: 0.7508 - val_accuracy20: 0.7191 - val_accuracy30: 0.6926 - val_accuracy50: 0.6603 - 40s/epoch - 26ms/step
Epoch 23/50
1577/1577 - 39s - loss: 9.7616 - accuracy10: 0.5990 - accuracy20: 0.5818 - accuracy30: 0.5684 - accuracy50: 0.5621 - val_loss: 10.6153 - val_accuracy10: 0.7535 - val_accuracy20: 0.7219 - val_accuracy30: 0.6949 - val_accuracy50: 0.6619 - 39s/epoch - 25ms/step
Epoch 24/50
1577/1577 - 39s - loss: 9.7299 - accuracy10: 0.6005 - accuracy20: 0.5830 - accuracy30: 0.5690 - accuracy50: 0.5617 - val_loss: 10.6431 - val_accuracy10: 0.7564 - val_accuracy20: 0.7261 - val_accuracy30: 0.6992 - val_accuracy50: 0.6663 - 39s/epoch - 25ms/step
Epoch 25/50
1577/1577 - 37s - loss: 9.6835 - accuracy10: 0.6015 - accuracy20: 0.5854 - accuracy30: 0.5718 - accuracy50: 0.5648 - val_loss: 10.6048 - val_accuracy10: 0.7472 - val_accuracy20: 0.7171 - val_accuracy30: 0.6923 - val_accuracy50: 0.6609 - 37s/epoch - 24ms/step
Epoch 26/50
1577/1577 - 41s - loss: 9.6223 - accuracy10: 0.6044 - accuracy20: 0.5881 - accuracy30: 0.5741 - accuracy50: 0.5661 - val_loss: 10.7561 - val_accuracy10: 0.7580 - val_accuracy20: 0.7272 - val_accuracy30: 0.6999 - val_accuracy50: 0.6659 - 41s/epoch - 26ms/step
Epoch 27/50
1577/1577 - 37s - loss: 9.5955 - accuracy10: 0.6035 - accuracy20: 0.5885 - accuracy30: 0.5744 - accuracy50: 0.5667 - val_loss: 10.7624 - val_accuracy10: 0.7557 - val_accuracy20: 0.7256 - val_accuracy30: 0.6988 - val_accuracy50: 0.6647 - 37s/epoch - 24ms/step
Epoch 28/50
1577/1577 - 39s - loss: 9.5734 - accuracy10: 0.6047 - accuracy20: 0.5900 - accuracy30: 0.5759 - accuracy50: 0.5672 - val_loss: 10.7368 - val_accuracy10: 0.7490 - val_accuracy20: 0.7184 - val_accuracy30: 0.6917 - val_accuracy50: 0.6594 - 39s/epoch - 24ms/step
testing model: results/AAL/W9/deepOF_L1/seq2seq
Evaluating performance on  test set...
3870/3870 - 38s - 38s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.67848337
{'0': {'precision': 0.2834785345407207, 'recall': 0.470437414683364, 'f1-score': 0.35377659550727286, 'support': 84245}, '1': {'precision': 0.9019088761617995, 'recall': 0.7779133122884713, 'f1-score': 0.8353347468099221, 'support': 825538}, '2': {'precision': 0.2738789738271178, 'recall': 0.46998553966704154, 'f1-score': 0.3460822635911484, 'support': 80911}, 'accuracy': 0.7266179062354269, 'macro avg': {'precision': 0.48642212817654595, 'recall': 0.5727787555462923, 'f1-score': 0.5117312019694479, 'support': 990694}, 'weighted avg': {'precision': 0.7980279688809748, 'recall': 0.7266179062354269, 'f1-score': 0.7544270456164094, 'support': 990694}}
[[ 39632  36941   7672]
 [ 90194 642197  93147]
 [  9980  32904  38027]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7502624
{'0': {'precision': 0.3414993804213135, 'recall': 0.4777457073267979, 'f1-score': 0.3982931737790447, 'support': 115371}, '1': {'precision': 0.8596562223869219, 'recall': 0.7413453721300461, 'f1-score': 0.7961293283803634, 'support': 765082}, '2': {'precision': 0.31601054823694597, 'recall': 0.48589907566150525, 'f1-score': 0.3829589487681771, 'support': 110241}, 'accuracy': 0.6822227650515699, 'macro avg': {'precision': 0.5057220503483938, 'recall': 0.5683300517061164, 'f1-score': 0.5257938169758617, 'support': 990694}, 'weighted avg': {'precision': 0.7388193991313236, 'recall': 0.6822227650515699, 'f1-score': 0.7038232572712866, 'support': 990694}}
[[ 55118  49288  10965]
 [ 92916 567190 104976]
 [ 13366  43309  53566]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8041793
{'0': {'precision': 0.3775660932574991, 'recall': 0.4689143121280407, 'f1-score': 0.41831126574530464, 'support': 138456}, '1': {'precision': 0.8206844612860008, 'recall': 0.718697281513766, 'f1-score': 0.7663124420770254, 'support': 720217}, '2': {'precision': 0.33846562957053583, 'recall': 0.4820445232197908, 'f1-score': 0.3976928316554495, 'support': 132021}, 'accuracy': 0.6522518557697937, 'macro avg': {'precision': 0.512238728038012, 'recall': 0.5565520389538658, 'f1-score': 0.5274388464925932, 'support': 990694}, 'weighted avg': {'precision': 0.6944947305056978, 'recall': 0.6522518557697937, 'f1-score': 0.6685543245779273, 'support': 990694}}
[[ 64924  60275  13257]
 [ 91471 517618 111128]
 [ 15559  52822  63640]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.86217123
{'0': {'precision': 0.42955460478774043, 'recall': 0.42331277941367634, 'f1-score': 0.4264108512788397, 'support': 176933}, '1': {'precision': 0.7446136868174877, 'recall': 0.7172449596042155, 'f1-score': 0.730673126337403, 'support': 647221}, '2': {'precision': 0.3801244167962675, 'recall': 0.4402906208718626, 'f1-score': 0.4080013354106388, 'support': 166540}, 'accuracy': 0.618192903156777, 'macro avg': {'precision': 0.5180975694671653, 'recall': 0.5269494532965848, 'f1-score': 0.5216951043422938, 'support': 990694}, 'weighted avg': {'precision': 0.6270734659318224, 'recall': 0.618192903156777, 'f1-score': 0.6220908626173441, 'support': 990694}}
[[ 74898  84478  17557]
 [ 80988 464216 102017]
 [ 18476  74738  73326]]
Evaluating performance on  train set...
1577/1577 - 16s - 16s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6281886
{'0': {'precision': 0.2704461129965359, 'recall': 0.5233428610317137, 'f1-score': 0.3566087390008928, 'support': 29388}, '1': {'precision': 0.9251759205623974, 'recall': 0.7807751606119597, 'f1-score': 0.8468641169642016, 'support': 345709}, '2': {'precision': 0.2684277646201494, 'recall': 0.5185654453947137, 'f1-score': 0.3537447630937661, 'support': 28413}, 'accuracy': 0.7435627369829744, 'macro avg': {'precision': 0.4880165993930276, 'recall': 0.6075611556794623, 'f1-score': 0.5190725396862869, 'support': 403510}, 'weighted avg': {'precision': 0.8312466872360049, 'recall': 0.7435627369829744, 'f1-score': 0.7764355643902718, 'support': 403510}}
[[ 15380  11485   2523]
 [ 38155 269921  37633]
 [  3334  10345  14734]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6882607
{'0': {'precision': 0.32810042205921286, 'recall': 0.5209832579073621, 'f1-score': 0.4026336410374023, 'support': 40437}, '1': {'precision': 0.889973694675817, 'recall': 0.7530369121819153, 'f1-score': 0.8157988027156282, 'support': 323931}, '2': {'precision': 0.31626081089370056, 'recall': 0.526902048949977, 'f1-score': 0.39526994652816383, 'support': 39142}, 'accuracy': 0.7078461500334564, 'macro avg': {'precision': 0.5114449758762435, 'recall': 0.6003074063464182, 'f1-score': 0.5379007967603981, 'support': 403510}, 'weighted avg': {'precision': 0.7780142903938977, 'recall': 0.7078461500334564, 'f1-score': 0.7336013351642114, 'support': 403510}}
[[ 21067  15930   3440]
 [ 38851 243932  41148]
 [  4291  14227  20624]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.74203527
{'0': {'precision': 0.36180367469438546, 'recall': 0.5052646643904234, 'f1-score': 0.42166598416598416, 'support': 48911}, '1': {'precision': 0.8562696823847168, 'recall': 0.7338231847067402, 'f1-score': 0.7903318835015453, 'support': 307168}, '2': {'precision': 0.3430004724715822, 'recall': 0.5203980519069806, 'f1-score': 0.41347482683239384, 'support': 47431}, 'accuracy': 0.6810314490347203, 'macro avg': {'precision': 0.5203579431835615, 'recall': 0.5864953003347148, 'f1-score': 0.5418242314999744, 'support': 403510}, 'weighted avg': {'precision': 0.7360007948787525, 'recall': 0.6810314490347203, 'f1-score': 0.7013464188110143, 'support': 403510}}
[[ 24713  20033   4165]
 [ 38647 225407  43114]
 [  4945  17803  24683]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8044894
{'0': {'precision': 0.41226761533165024, 'recall': 0.45453826566923405, 'f1-score': 0.43237225536140095, 'support': 63229}, '1': {'precision': 0.7863519548121862, 'recall': 0.731892659520676, 'f1-score': 0.7581455821987779, 'support': 278851}, '2': {'precision': 0.39002679809854696, 'recall': 0.47147973302946444, 'f1-score': 0.4269026966076837, 'support': 61430}, 'accuracy': 0.6487868949964065, 'macro avg': {'precision': 0.5295487894141279, 'recall': 0.5526368860731249, 'f1-score': 0.5391401780559542, 'support': 403510}, 'weighted avg': {'precision': 0.6673976957407043, 'recall': 0.6487868949964065, 'f1-score': 0.656669603550265, 'support': 403510}}
[[ 28740  29018   5471]
 [ 34937 204089  39825]
 [  6035  26432  28963]]
Evaluating performance on  val set...
600/600 - 6s - 6s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.62085474
{'0': {'precision': 0.25878108980444275, 'recall': 0.5292690030094166, 'f1-score': 0.3476043227390098, 'support': 10301}, '1': {'precision': 0.9303303249581839, 'recall': 0.784904122614385, 'f1-score': 0.8514522413962474, 'support': 132513}, '2': {'precision': 0.27338094544041197, 'recall': 0.5290522752914629, 'f1-score': 0.36048560171690314, 'support': 10636}, 'accuracy': 0.7500097751710655, 'macro avg': {'precision': 0.48749745340101286, 'recall': 0.6144084669717548, 'f1-score': 0.5198473886173868, 'support': 153450}, 'weighted avg': {'precision': 0.8397148653826237, 'recall': 0.7500097751710655, 'f1-score': 0.7835991388239586, 'support': 153450}}
[[  5452   3940    909]
 [ 14456 104010  14047]
 [  1160   3849   5627]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6798675
{'0': {'precision': 0.32162330905306974, 'recall': 0.5348885504637962, 'f1-score': 0.4017051805255908, 'support': 14446}, '1': {'precision': 0.8964292515711293, 'recall': 0.7578670273142223, 'f1-score': 0.8213452218407702, 'support': 124221}, '2': {'precision': 0.3240319606637984, 'recall': 0.5349387810322668, 'f1-score': 0.40359293661324896, 'support': 14783}, 'accuracy': 0.7153991528185076, 'macro avg': {'precision': 0.5140281737626659, 'recall': 0.6092314529367617, 'f1-score': 0.5422144463265366, 'support': 153450}, 'weighted avg': {'precision': 0.7871728436395622, 'recall': 0.7153991528185076, 'f1-score': 0.7415944752173911, 'support': 153450}}
[[ 7727  5508  1211]
 [14792 94143 15286]
 [ 1506  5369  7908]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7343374
{'0': {'precision': 0.357511131942817, 'recall': 0.5196729688298416, 'f1-score': 0.4236029156542867, 'support': 17613}, '1': {'precision': 0.8632952497871413, 'recall': 0.7396744339918736, 'f1-score': 0.7967180311841858, 'support': 117887}, '2': {'precision': 0.3512033380523061, 'recall': 0.5251810584958218, 'f1-score': 0.4209233791748526, 'support': 17950}, 'accuracy': 0.6893320299771912, 'macro avg': {'precision': 0.5240032399274215, 'recall': 0.594842820439179, 'f1-score': 0.5470814420044418, 'support': 153450}, 'weighted avg': {'precision': 0.7453387461492633, 'recall': 0.6893320299771912, 'f1-score': 0.7099328208003759, 'support': 153450}}
[[ 9153  7031  1429]
 [14703 87198 15986]
 [ 1746  6777  9427]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.795291
{'0': {'precision': 0.4073322096230463, 'recall': 0.46329135985360115, 'f1-score': 0.43351340332280097, 'support': 22951}, '1': {'precision': 0.7949650742110379, 'recall': 0.7392110633777222, 'f1-score': 0.7660749811677902, 'support': 107309}, '2': {'precision': 0.40035554910568516, 'recall': 0.47585166019836134, 'f1-score': 0.43485114180442536, 'support': 23190}, 'accuracy': 0.6581427174975563, 'macro avg': {'precision': 0.5342176109799232, 'recall': 0.5594513611432282, 'f1-score': 0.5448131754316722, 'support': 153450}, 'weighted avg': {'precision': 0.6773531044335722, 'recall': 0.6581427174975563, 'f1-score': 0.6662789459253219, 'support': 153450}}
[[10633 10462  1856]
 [13313 79324 14672]
 [ 2158  9997 11035]]
training model: results/AAL/W9/deepLOB_L2/seq2seq
Epoch 1/50
1577/1577 - 86s - loss: 10.7958 - accuracy10: 0.4817 - accuracy20: 0.4941 - accuracy30: 0.5023 - accuracy50: 0.5126 - val_loss: 11.3107 - val_accuracy10: 0.2119 - val_accuracy20: 0.2294 - val_accuracy30: 0.2453 - val_accuracy50: 0.2773 - 86s/epoch - 54ms/step
Epoch 2/50
1577/1577 - 77s - loss: 10.3777 - accuracy10: 0.5036 - accuracy20: 0.5178 - accuracy30: 0.5285 - accuracy50: 0.5399 - val_loss: 12.8177 - val_accuracy10: 0.8176 - val_accuracy20: 0.7769 - val_accuracy30: 0.7442 - val_accuracy50: 0.6898 - 77s/epoch - 49ms/step
Epoch 3/50
1577/1577 - 77s - loss: 9.7659 - accuracy10: 0.5887 - accuracy20: 0.5868 - accuracy30: 0.5797 - accuracy50: 0.5735 - val_loss: 10.6078 - val_accuracy10: 0.7606 - val_accuracy20: 0.7340 - val_accuracy30: 0.7020 - val_accuracy50: 0.6575 - 77s/epoch - 49ms/step
Epoch 4/50
1577/1577 - 76s - loss: 9.1106 - accuracy10: 0.6700 - accuracy20: 0.6543 - accuracy30: 0.6315 - accuracy50: 0.6064 - val_loss: 9.9574 - val_accuracy10: 0.5066 - val_accuracy20: 0.5149 - val_accuracy30: 0.5097 - val_accuracy50: 0.5088 - 76s/epoch - 48ms/step
Epoch 5/50
1577/1577 - 76s - loss: 8.8865 - accuracy10: 0.6886 - accuracy20: 0.6691 - accuracy30: 0.6435 - accuracy50: 0.6142 - val_loss: 11.4492 - val_accuracy10: 0.3073 - val_accuracy20: 0.3264 - val_accuracy30: 0.3332 - val_accuracy50: 0.3539 - 76s/epoch - 48ms/step
Epoch 6/50
1577/1577 - 77s - loss: 8.7357 - accuracy10: 0.6964 - accuracy20: 0.6756 - accuracy30: 0.6505 - accuracy50: 0.6200 - val_loss: 10.5625 - val_accuracy10: 0.3824 - val_accuracy20: 0.3909 - val_accuracy30: 0.3887 - val_accuracy50: 0.3993 - 77s/epoch - 49ms/step
Epoch 7/50
1577/1577 - 76s - loss: 8.6084 - accuracy10: 0.7016 - accuracy20: 0.6804 - accuracy30: 0.6542 - accuracy50: 0.6234 - val_loss: 9.8106 - val_accuracy10: 0.5666 - val_accuracy20: 0.5630 - val_accuracy30: 0.5478 - val_accuracy50: 0.5371 - 76s/epoch - 48ms/step
Epoch 8/50
1577/1577 - 76s - loss: 8.4767 - accuracy10: 0.7062 - accuracy20: 0.6854 - accuracy30: 0.6582 - accuracy50: 0.6260 - val_loss: 9.6562 - val_accuracy10: 0.5385 - val_accuracy20: 0.5417 - val_accuracy30: 0.5312 - val_accuracy50: 0.5214 - 76s/epoch - 48ms/step
Epoch 9/50
1577/1577 - 76s - loss: 8.4043 - accuracy10: 0.7065 - accuracy20: 0.6870 - accuracy30: 0.6603 - accuracy50: 0.6290 - val_loss: 9.3421 - val_accuracy10: 0.5802 - val_accuracy20: 0.5787 - val_accuracy30: 0.5635 - val_accuracy50: 0.5489 - 76s/epoch - 48ms/step
Epoch 10/50
1577/1577 - 76s - loss: 8.3334 - accuracy10: 0.7082 - accuracy20: 0.6884 - accuracy30: 0.6613 - accuracy50: 0.6303 - val_loss: 9.2650 - val_accuracy10: 0.5992 - val_accuracy20: 0.5970 - val_accuracy30: 0.5801 - val_accuracy50: 0.5621 - 76s/epoch - 48ms/step
Epoch 11/50
1577/1577 - 76s - loss: 8.2770 - accuracy10: 0.7079 - accuracy20: 0.6894 - accuracy30: 0.6620 - accuracy50: 0.6302 - val_loss: 9.4532 - val_accuracy10: 0.5611 - val_accuracy20: 0.5635 - val_accuracy30: 0.5500 - val_accuracy50: 0.5367 - 76s/epoch - 48ms/step
Epoch 12/50
1577/1577 - 76s - loss: 8.2203 - accuracy10: 0.7094 - accuracy20: 0.6911 - accuracy30: 0.6639 - accuracy50: 0.6326 - val_loss: 9.7863 - val_accuracy10: 0.5279 - val_accuracy20: 0.5328 - val_accuracy30: 0.5222 - val_accuracy50: 0.5142 - 76s/epoch - 48ms/step
Epoch 13/50
1577/1577 - 76s - loss: 8.1797 - accuracy10: 0.7103 - accuracy20: 0.6912 - accuracy30: 0.6640 - accuracy50: 0.6330 - val_loss: 9.2674 - val_accuracy10: 0.5690 - val_accuracy20: 0.5681 - val_accuracy30: 0.5549 - val_accuracy50: 0.5431 - 76s/epoch - 48ms/step
Epoch 14/50
1577/1577 - 75s - loss: 8.1249 - accuracy10: 0.7110 - accuracy20: 0.6915 - accuracy30: 0.6652 - accuracy50: 0.6348 - val_loss: 10.2336 - val_accuracy10: 0.4752 - val_accuracy20: 0.4812 - val_accuracy30: 0.4728 - val_accuracy50: 0.4710 - 75s/epoch - 48ms/step
Epoch 15/50
1577/1577 - 76s - loss: 8.0855 - accuracy10: 0.7113 - accuracy20: 0.6919 - accuracy30: 0.6645 - accuracy50: 0.6344 - val_loss: 9.3506 - val_accuracy10: 0.5746 - val_accuracy20: 0.5721 - val_accuracy30: 0.5556 - val_accuracy50: 0.5408 - 76s/epoch - 48ms/step
Epoch 16/50
1577/1577 - 76s - loss: 8.0402 - accuracy10: 0.7130 - accuracy20: 0.6934 - accuracy30: 0.6658 - accuracy50: 0.6358 - val_loss: 8.9801 - val_accuracy10: 0.6474 - val_accuracy20: 0.6402 - val_accuracy30: 0.6222 - val_accuracy50: 0.6012 - 76s/epoch - 48ms/step
Epoch 17/50
1577/1577 - 75s - loss: 8.0010 - accuracy10: 0.7135 - accuracy20: 0.6933 - accuracy30: 0.6657 - accuracy50: 0.6354 - val_loss: 9.3565 - val_accuracy10: 0.5878 - val_accuracy20: 0.5838 - val_accuracy30: 0.5668 - val_accuracy50: 0.5508 - 75s/epoch - 48ms/step
Epoch 18/50
1577/1577 - 75s - loss: 7.9711 - accuracy10: 0.7128 - accuracy20: 0.6926 - accuracy30: 0.6658 - accuracy50: 0.6369 - val_loss: 9.6263 - val_accuracy10: 0.5644 - val_accuracy20: 0.5609 - val_accuracy30: 0.5451 - val_accuracy50: 0.5323 - 75s/epoch - 48ms/step
Epoch 19/50
1577/1577 - 76s - loss: 7.9270 - accuracy10: 0.7150 - accuracy20: 0.6945 - accuracy30: 0.6665 - accuracy50: 0.6364 - val_loss: 9.4298 - val_accuracy10: 0.5990 - val_accuracy20: 0.5954 - val_accuracy30: 0.5783 - val_accuracy50: 0.5608 - 76s/epoch - 48ms/step
Epoch 20/50
1577/1577 - 76s - loss: 7.8977 - accuracy10: 0.7144 - accuracy20: 0.6940 - accuracy30: 0.6658 - accuracy50: 0.6360 - val_loss: 9.5377 - val_accuracy10: 0.5798 - val_accuracy20: 0.5760 - val_accuracy30: 0.5609 - val_accuracy50: 0.5469 - 76s/epoch - 48ms/step
Epoch 21/50
1577/1577 - 75s - loss: 7.8602 - accuracy10: 0.7163 - accuracy20: 0.6951 - accuracy30: 0.6669 - accuracy50: 0.6377 - val_loss: 9.1503 - val_accuracy10: 0.6367 - val_accuracy20: 0.6290 - val_accuracy30: 0.6105 - val_accuracy50: 0.5895 - 75s/epoch - 48ms/step
Epoch 22/50
1577/1577 - 75s - loss: 7.8365 - accuracy10: 0.7155 - accuracy20: 0.6948 - accuracy30: 0.6671 - accuracy50: 0.6372 - val_loss: 10.3715 - val_accuracy10: 0.4863 - val_accuracy20: 0.4908 - val_accuracy30: 0.4823 - val_accuracy50: 0.4768 - 75s/epoch - 48ms/step
Epoch 23/50
1577/1577 - 76s - loss: 7.8028 - accuracy10: 0.7171 - accuracy20: 0.6952 - accuracy30: 0.6677 - accuracy50: 0.6383 - val_loss: 9.5573 - val_accuracy10: 0.6112 - val_accuracy20: 0.6040 - val_accuracy30: 0.5871 - val_accuracy50: 0.5676 - 76s/epoch - 49ms/step
Epoch 24/50
1577/1577 - 76s - loss: 7.7659 - accuracy10: 0.7160 - accuracy20: 0.6946 - accuracy30: 0.6670 - accuracy50: 0.6392 - val_loss: 9.4899 - val_accuracy10: 0.6134 - val_accuracy20: 0.6085 - val_accuracy30: 0.5930 - val_accuracy50: 0.5769 - 76s/epoch - 48ms/step
Epoch 25/50
1577/1577 - 76s - loss: 7.7272 - accuracy10: 0.7172 - accuracy20: 0.6959 - accuracy30: 0.6681 - accuracy50: 0.6397 - val_loss: 9.5516 - val_accuracy10: 0.5905 - val_accuracy20: 0.5901 - val_accuracy30: 0.5758 - val_accuracy50: 0.5617 - 76s/epoch - 48ms/step
Epoch 26/50
1577/1577 - 76s - loss: 7.6974 - accuracy10: 0.7175 - accuracy20: 0.6961 - accuracy30: 0.6690 - accuracy50: 0.6401 - val_loss: 9.6970 - val_accuracy10: 0.5426 - val_accuracy20: 0.5438 - val_accuracy30: 0.5297 - val_accuracy50: 0.5187 - 76s/epoch - 48ms/step
testing model: results/AAL/W9/deepLOB_L2/seq2seq
Evaluating performance on  test set...
3870/3870 - 62s - 62s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.6536171
{'0': {'precision': 0.1882070152891109, 'recall': 0.7370114069343715, 'f1-score': 0.2998442612065531, 'support': 84247}, '1': {'precision': 0.9641663871476427, 'recall': 0.2681093587227754, 'f1-score': 0.41955225139583796, 'support': 825540}, '2': {'precision': 0.14602218310920648, 'recall': 0.7782501761194399, 'f1-score': 0.24590541648767916, 'support': 80911}, 'accuracy': 0.3496474203036647, 'macro avg': {'precision': 0.43279852851532, 'recall': 0.5944569805921955, 'f1-score': 0.3217673096966901, 'support': 990698}, 'weighted avg': {'precision': 0.8313619251482043, 'recall': 0.3496474203036647, 'f1-score': 0.39519066178050544, 'support': 990698}}
[[ 62091   4838  17318]
 [253263 221335 350942]
 [ 14554   3388  62969]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.5964643
{'0': {'precision': 0.24617284896866645, 'recall': 0.7238001958863859, 'f1-score': 0.3673915625811163, 'support': 115373}, '1': {'precision': 0.9366789378281912, 'recall': 0.26206011366072224, 'f1-score': 0.40954065625204267, 'support': 765084}, '2': {'precision': 0.1953386294793393, 'recall': 0.7750836803004327, 'f1-score': 0.3120368984015805, 'support': 110241}, 'accuracy': 0.37291990091834243, 'macro avg': {'precision': 0.459396805425399, 'recall': 0.5869813299491803, 'f1-score': 0.3629897057449132, 'support': 990698}, 'weighted avg': {'precision': 0.7737717189555623, 'recall': 0.37291990091834243, 'f1-score': 0.39378229280194127, 'support': 990698}}
[[ 83507   7789  24077]
 [236684 200498 327902]
 [ 19030   5765  85446]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.553403
{'0': {'precision': 0.28325847379144287, 'recall': 0.7069002874517905, 'f1-score': 0.40445129485076264, 'support': 138458}, '1': {'precision': 0.9082059483898748, 'recall': 0.24599600954709608, 'f1-score': 0.3871333567137224, 'support': 720219}, '2': {'precision': 0.22650660765545988, 'recall': 0.7722029071132623, 'f1-score': 0.35027014026679043, 'support': 132021}, 'accuracy': 0.38053372470722663, 'macro avg': {'precision': 0.4726570099455925, 'recall': 0.575033068037383, 'f1-score': 0.38061826394375853, 'support': 990698}, 'weighted avg': {'precision': 0.7300208646397834, 'recall': 0.38053372470722663, 'f1-score': 0.384641263644026, 'support': 990698}}
[[ 97876  10158  30424]
 [225335 177171 317713]
 [ 22325   7749 101947]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.4582189
{'0': {'precision': 0.3358303187495734, 'recall': 0.6673976318987199, 'f1-score': 0.4468223982563915, 'support': 176935}, '1': {'precision': 0.8489460359002077, 'recall': 0.23054650406428695, 'f1-score': 0.36261768093823965, 'support': 647223}, '2': {'precision': 0.2712271939461569, 'recall': 0.7545454545454545, 'f1-score': 0.39902262288262746, 'support': 166540}, 'accuracy': 0.3966526630718948, 'macro avg': {'precision': 0.485334516198646, 'recall': 0.5508298635028205, 'f1-score': 0.4028209006924195, 'support': 990698}, 'weighted avg': {'precision': 0.6601887906518322, 'recall': 0.3966526630718948, 'f1-score': 0.3837761375921398, 'support': 990698}}
[[118086  14948  43901]
 [204262 149215 293746]
 [ 29276  11602 125662]]
Evaluating performance on  train set...
1577/1577 - 26s - 26s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8884021
{'0': {'precision': 0.24008489189547685, 'recall': 0.7395804957777172, 'f1-score': 0.3624954103942054, 'support': 29368}, '1': {'precision': 0.9687386627591958, 'recall': 0.5947378164483732, 'f1-score': 0.7370056725004704, 'support': 345712}, '2': {'precision': 0.20872230875306302, 'recall': 0.740028139289483, 'f1-score': 0.32560802915754206, 'support': 28430}, 'accuracy': 0.6155163440806919, 'macro avg': {'precision': 0.4725152878025785, 'recall': 0.6914488171718579, 'f1-score': 0.4750363706840726, 'support': 403510}, 'weighted avg': {'precision': 0.862157985980132, 'recall': 0.6155163440806919, 'f1-score': 0.6807625747388877, 'support': 403510}}
[[ 21720   3709   3939]
 [ 64283 205608  75821]
 [  4465   2926  21039]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8858616
{'0': {'precision': 0.29773375790910217, 'recall': 0.7119054682092356, 'f1-score': 0.4198693649034816, 'support': 40452}, '1': {'precision': 0.9435030785657975, 'recall': 0.5838824423049608, 'f1-score': 0.7213566899877164, 'support': 323858}, '2': {'precision': 0.2683795878459687, 'recall': 0.7282397959183673, 'f1-score': 0.39221532204880194, 'support': 39200}, 'accuracy': 0.6107407499194568, 'macro avg': {'precision': 0.5032054747736229, 'recall': 0.6746759021441878, 'f1-score': 0.5111471256466666, 'support': 403510}, 'weighted avg': {'precision': 0.8131779282710788, 'recall': 0.6107407499194568, 'f1-score': 0.6591572230661707, 'support': 403510}}
[[ 28798   6127   5527]
 [ 62469 189095  72294]
 [  5457   5196  28547]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9054083
{'0': {'precision': 0.3298735093571771, 'recall': 0.6894436606759492, 'f1-score': 0.4462383378548269, 'support': 48909}, '1': {'precision': 0.9177029875854432, 'recall': 0.5612879488415102, 'f1-score': 0.696550080005172, 'support': 307124}, '2': {'precision': 0.29967825818678656, 'recall': 0.7160730458959075, 'f1-score': 0.4225276842196841, 'support': 47477}, 'accuracy': 0.5950335803325816, 'macro avg': {'precision': 0.5157515850431357, 'recall': 0.6556015518044557, 'f1-score': 0.521772034026561, 'support': 403510}, 'weighted avg': {'precision': 0.7737360176755864, 'recall': 0.5950335803325816, 'f1-score': 0.6339685869032939, 'support': 403510}}
[[ 33720   8205   6984]
 [ 62275 172385  72464]
 [  6226   7254  33997]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9270509
{'0': {'precision': 0.37337827701482584, 'recall': 0.6375610758843155, 'f1-score': 0.4709510126848412, 'support': 63241}, '1': {'precision': 0.8603093696607448, 'recall': 0.5398965068367885, 'f1-score': 0.6634424712466398, 'support': 278859}, '2': {'precision': 0.3434642637858648, 'recall': 0.6740758834066113, 'f1-score': 0.45506013235714443, 'support': 61410}, 'accuracy': 0.5756239002750861, 'macro avg': {'precision': 0.5257173034871451, 'recall': 0.6171778220425718, 'f1-score': 0.5298178720962085, 'support': 403510}, 'weighted avg': {'precision': 0.7053355965651662, 'recall': 0.5756239002750861, 'f1-score': 0.6015602086952517, 'support': 403510}}
[[ 40320  12691  10230]
 [ 59407 150555  68897]
 [  8260  11755  41395]]
Evaluating performance on  val set...
600/600 - 10s - 10s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.81326926
{'0': {'precision': 0.2622646414379619, 'recall': 0.6843023255813954, 'f1-score': 0.3791983246972911, 'support': 10320}, '1': {'precision': 0.9677767942336211, 'recall': 0.6353221740902298, 'f1-score': 0.7670768543871558, 'support': 132506}, '2': {'precision': 0.20308073654390935, 'recall': 0.7557417168674698, 'f1-score': 0.3201355661881978, 'support': 10624}, 'accuracy': 0.6469534050179212, 'macro avg': {'precision': 0.47770739073849744, 'recall': 0.6917887388463649, 'f1-score': 0.48880358175754823, 'support': 153450}, 'weighted avg': {'precision': 0.8673856809475559, 'recall': 0.6469534050179212, 'f1-score': 0.7100471334863729, 'support': 153450}}
[[ 7062  1756  1502]
 [18317 84184 30005]
 [ 1548  1047  8029]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8133652
{'0': {'precision': 0.32485396005977446, 'recall': 0.6624878792076465, 'f1-score': 0.4359418440362791, 'support': 14438}, '1': {'precision': 0.9434194042739513, 'recall': 0.6243269130158321, 'f1-score': 0.7513997868836578, 'support': 124241}, '2': {'precision': 0.26587216119845886, 'recall': 0.7521494820932909, 'f1-score': 0.392871035043672, 'support': 14771}, 'accuracy': 0.6402215705441512, 'macro avg': {'precision': 0.5113818418440615, 'recall': 0.6796547581055897, 'f1-score': 0.5267375553212029, 'support': 153450}, 'weighted avg': {'precision': 0.8199987577374092, 'recall': 0.6402215705441512, 'f1-score': 0.6872068251876077, 'support': 153450}}
[[ 9565  2758  2115]
 [18112 77567 28562]
 [ 1767  1894 11110]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8394208
{'0': {'precision': 0.355758051846033, 'recall': 0.6434782608695652, 'f1-score': 0.45819506272764066, 'support': 17595}, '1': {'precision': 0.9201034276656012, 'recall': 0.6004103746788648, 'f1-score': 0.7266486406058398, 'support': 117941}, '2': {'precision': 0.29852450574300876, 'recall': 0.7442782181533996, 'f1-score': 0.4261310065998689, 'support': 17914}, 'accuracy': 0.6221440208536982, 'macro avg': {'precision': 0.5247953284182143, 'recall': 0.6627222845672766, 'f1-score': 0.5369915699777831, 'support': 153450}, 'weighted avg': {'precision': 0.7828299073341146, 'recall': 0.6221440208536982, 'f1-score': 0.6607841010271506, 'support': 153450}}
[[11322  3526  2747]
 [18545 70813 28583]
 [ 1958  2623 13333]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.87169427
{'0': {'precision': 0.3975998598458304, 'recall': 0.5936696167763875, 'f1-score': 0.4762437702194632, 'support': 22937}, '1': {'precision': 0.8668793180298641, 'recall': 0.5798850199863962, 'f1-score': 0.6949166736454233, 'support': 107323}, '2': {'precision': 0.34528580468255643, 'recall': 0.7059077188443295, 'f1-score': 0.4637393767705383, 'support': 23190}, 'accuracy': 0.60099055066797, 'macro avg': {'precision': 0.536588327519417, 'recall': 0.6264874518690376, 'f1-score': 0.544966606878475, 'support': 153450}, 'weighted avg': {'precision': 0.7179082101322347, 'recall': 0.60099055066797, 'f1-score': 0.6272939828639973, 'support': 153450}}
[[13617  5270  4050]
 [18098 62235 26990]
 [ 2533  4287 16370]]
training model: results/AAL/W9/deepOF_L2/seq2seq
Epoch 1/50
1577/1577 - 55s - loss: 10.3885 - accuracy10: 0.5438 - accuracy20: 0.5437 - accuracy30: 0.5372 - accuracy50: 0.5319 - val_loss: 10.1993 - val_accuracy10: 0.8052 - val_accuracy20: 0.7881 - val_accuracy30: 0.7632 - val_accuracy50: 0.7167 - 55s/epoch - 35ms/step
Epoch 2/50
1577/1577 - 48s - loss: 9.1836 - accuracy10: 0.6464 - accuracy20: 0.6356 - accuracy30: 0.6192 - accuracy50: 0.6025 - val_loss: 9.4588 - val_accuracy10: 0.8029 - val_accuracy20: 0.7835 - val_accuracy30: 0.7595 - val_accuracy50: 0.7184 - 48s/epoch - 30ms/step
Epoch 3/50
1577/1577 - 47s - loss: 8.8002 - accuracy10: 0.6772 - accuracy20: 0.6605 - accuracy30: 0.6390 - accuracy50: 0.6185 - val_loss: 9.8223 - val_accuracy10: 0.7667 - val_accuracy20: 0.7471 - val_accuracy30: 0.7224 - val_accuracy50: 0.6820 - 47s/epoch - 30ms/step
Epoch 4/50
1577/1577 - 47s - loss: 8.6408 - accuracy10: 0.6844 - accuracy20: 0.6665 - accuracy30: 0.6434 - accuracy50: 0.6224 - val_loss: 10.1765 - val_accuracy10: 0.7241 - val_accuracy20: 0.7102 - val_accuracy30: 0.6868 - val_accuracy50: 0.6495 - 47s/epoch - 30ms/step
Epoch 5/50
1577/1577 - 47s - loss: 8.5484 - accuracy10: 0.6871 - accuracy20: 0.6692 - accuracy30: 0.6456 - accuracy50: 0.6239 - val_loss: 9.7502 - val_accuracy10: 0.7571 - val_accuracy20: 0.7425 - val_accuracy30: 0.7166 - val_accuracy50: 0.6775 - 47s/epoch - 30ms/step
Epoch 6/50
1577/1577 - 46s - loss: 8.4811 - accuracy10: 0.6911 - accuracy20: 0.6726 - accuracy30: 0.6478 - accuracy50: 0.6245 - val_loss: 9.8144 - val_accuracy10: 0.7812 - val_accuracy20: 0.7617 - val_accuracy30: 0.7336 - val_accuracy50: 0.6898 - 46s/epoch - 29ms/step
Epoch 7/50
1577/1577 - 47s - loss: 8.4100 - accuracy10: 0.6926 - accuracy20: 0.6749 - accuracy30: 0.6492 - accuracy50: 0.6245 - val_loss: 9.5680 - val_accuracy10: 0.7740 - val_accuracy20: 0.7564 - val_accuracy30: 0.7284 - val_accuracy50: 0.6854 - 47s/epoch - 30ms/step
Epoch 8/50
1577/1577 - 47s - loss: 8.3577 - accuracy10: 0.6928 - accuracy20: 0.6761 - accuracy30: 0.6499 - accuracy50: 0.6240 - val_loss: 9.7337 - val_accuracy10: 0.8002 - val_accuracy20: 0.7792 - val_accuracy30: 0.7480 - val_accuracy50: 0.7010 - 47s/epoch - 30ms/step
Epoch 9/50
1577/1577 - 47s - loss: 8.2922 - accuracy10: 0.6949 - accuracy20: 0.6789 - accuracy30: 0.6518 - accuracy50: 0.6240 - val_loss: 9.3889 - val_accuracy10: 0.7913 - val_accuracy20: 0.7723 - val_accuracy30: 0.7418 - val_accuracy50: 0.6964 - 47s/epoch - 30ms/step
Epoch 10/50
1577/1577 - 46s - loss: 8.2442 - accuracy10: 0.6967 - accuracy20: 0.6805 - accuracy30: 0.6528 - accuracy50: 0.6247 - val_loss: 9.4480 - val_accuracy10: 0.7959 - val_accuracy20: 0.7765 - val_accuracy30: 0.7456 - val_accuracy50: 0.7003 - 46s/epoch - 29ms/step
Epoch 11/50
1577/1577 - 47s - loss: 8.1976 - accuracy10: 0.6967 - accuracy20: 0.6813 - accuracy30: 0.6530 - accuracy50: 0.6249 - val_loss: 9.5830 - val_accuracy10: 0.7878 - val_accuracy20: 0.7666 - val_accuracy30: 0.7350 - val_accuracy50: 0.6903 - 47s/epoch - 30ms/step
Epoch 12/50
1577/1577 - 47s - loss: 8.1644 - accuracy10: 0.6974 - accuracy20: 0.6814 - accuracy30: 0.6531 - accuracy50: 0.6246 - val_loss: 9.5861 - val_accuracy10: 0.8058 - val_accuracy20: 0.7858 - val_accuracy30: 0.7565 - val_accuracy50: 0.7112 - 47s/epoch - 30ms/step
Epoch 13/50
1577/1577 - 46s - loss: 8.1145 - accuracy10: 0.6983 - accuracy20: 0.6816 - accuracy30: 0.6534 - accuracy50: 0.6248 - val_loss: 9.5664 - val_accuracy10: 0.7802 - val_accuracy20: 0.7608 - val_accuracy30: 0.7298 - val_accuracy50: 0.6864 - 46s/epoch - 29ms/step
Epoch 14/50
1577/1577 - 46s - loss: 8.0857 - accuracy10: 0.6987 - accuracy20: 0.6826 - accuracy30: 0.6543 - accuracy50: 0.6260 - val_loss: 9.5802 - val_accuracy10: 0.7823 - val_accuracy20: 0.7611 - val_accuracy30: 0.7317 - val_accuracy50: 0.6883 - 46s/epoch - 29ms/step
Epoch 15/50
1577/1577 - 47s - loss: 8.0457 - accuracy10: 0.6986 - accuracy20: 0.6819 - accuracy30: 0.6546 - accuracy50: 0.6267 - val_loss: 9.7294 - val_accuracy10: 0.7886 - val_accuracy20: 0.7676 - val_accuracy30: 0.7367 - val_accuracy50: 0.6916 - 47s/epoch - 30ms/step
Epoch 16/50
1577/1577 - 46s - loss: 7.9965 - accuracy10: 0.6999 - accuracy20: 0.6829 - accuracy30: 0.6550 - accuracy50: 0.6271 - val_loss: 9.8107 - val_accuracy10: 0.7958 - val_accuracy20: 0.7739 - val_accuracy30: 0.7422 - val_accuracy50: 0.6956 - 46s/epoch - 29ms/step
Epoch 17/50
1577/1577 - 46s - loss: 7.9613 - accuracy10: 0.7004 - accuracy20: 0.6833 - accuracy30: 0.6556 - accuracy50: 0.6282 - val_loss: 9.7485 - val_accuracy10: 0.7901 - val_accuracy20: 0.7673 - val_accuracy30: 0.7352 - val_accuracy50: 0.6902 - 46s/epoch - 29ms/step
Epoch 18/50
1577/1577 - 48s - loss: 7.9231 - accuracy10: 0.7018 - accuracy20: 0.6847 - accuracy30: 0.6566 - accuracy50: 0.6288 - val_loss: 9.8483 - val_accuracy10: 0.7969 - val_accuracy20: 0.7741 - val_accuracy30: 0.7421 - val_accuracy50: 0.6959 - 48s/epoch - 30ms/step
Epoch 19/50
1577/1577 - 47s - loss: 7.8747 - accuracy10: 0.7024 - accuracy20: 0.6852 - accuracy30: 0.6577 - accuracy50: 0.6300 - val_loss: 10.2785 - val_accuracy10: 0.7758 - val_accuracy20: 0.7500 - val_accuracy30: 0.7171 - val_accuracy50: 0.6749 - 47s/epoch - 30ms/step
testing model: results/AAL/W9/deepOF_L2/seq2seq
Evaluating performance on  test set...
3870/3870 - 38s - 38s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5579259
{'0': {'precision': 0.40814814814814815, 'recall': 0.48399311531841654, 'f1-score': 0.4428466697439518, 'support': 84245}, '1': {'precision': 0.9256049951454142, 'recall': 0.8279909586233463, 'f1-score': 0.874081130935445, 'support': 825538}, '2': {'precision': 0.31243393711798423, 'recall': 0.5881647736401725, 'f1-score': 0.4080899377433241, 'support': 80911}, 'accuracy': 0.7791517865254054, 'macro avg': {'precision': 0.5487290268038488, 'recall': 0.6333829491939784, 'f1-score': 0.5750059128075736, 'support': 990694}, 'weighted avg': {'precision': 0.8315240422463939, 'recall': 0.7791517865254054, 'f1-score': 0.7993525461096108, 'support': 990694}}
[[ 40774  32339  11132]
 [ 48404 683538  93596]
 [ 10722  22600  47589]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.61017764
{'0': {'precision': 0.48806917886281814, 'recall': 0.4676911875601321, 'f1-score': 0.47766294124156244, 'support': 115371}, '1': {'precision': 0.8830287388392857, 'recall': 0.8273034785813809, 'f1-score': 0.8542583012682521, 'support': 765082}, '2': {'precision': 0.37739684094526754, 'recall': 0.5591748986311808, 'f1-score': 0.45064532990229583, 'support': 110241}, 'accuracy': 0.7555885066428181, 'macro avg': {'precision': 0.5828315862157905, 'recall': 0.6180565215908979, 'f1-score': 0.5941888574707035, 'support': 990694}, 'weighted avg': {'precision': 0.7807688629848044, 'recall': 0.7555885066428181, 'f1-score': 0.7654893364234123, 'support': 990694}}
[[ 53958  48019  13394]
 [ 43825 632955  88302]
 [ 12771  35826  61644]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6761144
{'0': {'precision': 0.513275475158252, 'recall': 0.46089732478188017, 'f1-score': 0.4856782973023369, 'support': 138456}, '1': {'precision': 0.8459275527160086, 'recall': 0.8065027623618992, 'f1-score': 0.8257448459983453, 'support': 720217}, '2': {'precision': 0.39736584388702173, 'recall': 0.5409215200612024, 'f1-score': 0.45816184796799875, 'support': 132021}, 'accuracy': 0.72281047427359, 'macro avg': {'precision': 0.5855229572537608, 'recall': 0.6027738690683272, 'f1-score': 0.589861663756227, 'support': 990694}, 'weighted avg': {'precision': 0.7396613984729745, 'recall': 0.72281047427359, 'f1-score': 0.7292337850156212, 'support': 990694}}
[[ 63814  59444  15198]
 [ 46255 580857  93105]
 [ 14258  46350  71413]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7731423
{'0': {'precision': 0.5370912104491461, 'recall': 0.42855770263320014, 'f1-score': 0.4767251785534654, 'support': 176933}, '1': {'precision': 0.7743693591573891, 'recall': 0.7810778698466212, 'f1-score': 0.7777091478859643, 'support': 647221}, '2': {'precision': 0.42481201096157856, 'recall': 0.5017113005884473, 'f1-score': 0.46007042428013345, 'support': 166540}, 'accuracy': 0.6711567850415971, 'macro avg': {'precision': 0.5787575268560379, 'recall': 0.5704489576894228, 'f1-score': 0.5715015835731877, 'support': 990694}, 'weighted avg': {'precision': 0.6732305459073584, 'recall': 0.6711567850415971, 'f1-score': 0.6705584538520628, 'support': 990694}}
[[ 75826  81295  19812]
 [ 48371 505530  93320]
 [ 16982  66003  83555]]
Evaluating performance on  train set...
1577/1577 - 16s - 16s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.4925249
{'0': {'precision': 0.40910172673665285, 'recall': 0.5264393630053082, 'f1-score': 0.46041217171341414, 'support': 29388}, '1': {'precision': 0.9406215316315205, 'recall': 0.8433104142501352, 'f1-score': 0.8893118768616937, 'support': 345709}, '2': {'precision': 0.3167769825467721, 'recall': 0.6215464752050118, 'f1-score': 0.41966683301252344, 'support': 28413}, 'accuracy': 0.8046169859483037, 'macro avg': {'precision': 0.5555000803049818, 'recall': 0.6637654174868185, 'f1-score': 0.5897969605292105, 'support': 403510}, 'weighted avg': {'precision': 0.8579826894729734, 'recall': 0.8046169859483037, 'f1-score': 0.8250048481244031, 'support': 403510}}
[[ 15471  10816   3101]
 [ 19181 291540  34988]
 [  3165   7588  17660]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.54459083
{'0': {'precision': 0.4742253652182004, 'recall': 0.5041422459628558, 'f1-score': 0.48872640095894515, 'support': 40437}, '1': {'precision': 0.9041702252101064, 'recall': 0.8399381349731887, 'f1-score': 0.8708714091381933, 'support': 323931}, '2': {'precision': 0.3856349512608426, 'recall': 0.5872208880486434, 'f1-score': 0.4655425591169173, 'support': 39142}, 'accuracy': 0.7817724467795099, 'macro avg': {'precision': 0.5880101805630498, 'recall': 0.6437670896615626, 'f1-score': 0.6083801230713519, 'support': 403510}, 'weighted avg': {'precision': 0.8107842174372759, 'recall': 0.7817724467795099, 'f1-score': 0.7932570264877582, 'support': 403510}}
[[ 20386  16377   3674]
 [ 18905 272082  32944]
 [  3697  12460  22985]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.61229974
{'0': {'precision': 0.4878206684470341, 'recall': 0.4929770399296682, 'f1-score': 0.49038529983017926, 'support': 48911}, '1': {'precision': 0.8716619573949417, 'recall': 0.8195157047609126, 'f1-score': 0.8447848848916035, 'support': 307168}, '2': {'precision': 0.410736713126053, 'recall': 0.5653897240201556, 'f1-score': 0.4758119605042539, 'support': 47431}, 'accuracy': 0.7500631954598399, 'macro avg': {'precision': 0.590073112989343, 'recall': 0.6259608229035788, 'f1-score': 0.6036607150753456, 'support': 403510}, 'weighted avg': {'precision': 0.7709551433267678, 'recall': 0.7500631954598399, 'f1-score': 0.7584554435356131, 'support': 403510}}
[[ 24112  20617   4182]
 [ 21148 251729  34291]
 [  4168  16446  26817]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.71275085
{'0': {'precision': 0.5067984300532661, 'recall': 0.457448322763289, 'f1-score': 0.4808605082252019, 'support': 63229}, '1': {'precision': 0.8053375196232339, 'recall': 0.7947470154311801, 'f1-score': 0.8000072197604844, 'support': 278851}, '2': {'precision': 0.4425295422011396, 'recall': 0.5132996907048674, 'f1-score': 0.47529468511651746, 'support': 61430}, 'accuracy': 0.6990458724690838, 'macro avg': {'precision': 0.5848884972925465, 'recall': 0.5884983429664454, 'f1-score': 0.5853874710340679, 'support': 403510}, 'weighted avg': {'precision': 0.7033236360826555, 'recall': 0.6990458724690838, 'f1-score': 0.7005637897913554, 'support': 403510}}
[[ 28924  28874   5431]
 [ 22944 221616  34291]
 [  5204  24694  31532]]
Evaluating performance on  val set...
600/600 - 6s - 6s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5071084
{'0': {'precision': 0.3999553538209688, 'recall': 0.5217940005824677, 'f1-score': 0.45282224094355517, 'support': 10301}, '1': {'precision': 0.9476034223146754, 'recall': 0.8216024088202667, 'f1-score': 0.8801160844926963, 'support': 132513}, '2': {'precision': 0.2881598853411896, 'recall': 0.680518992102294, 'f1-score': 0.4048777759131845, 'support': 10636}, 'accuracy': 0.7916976213750407, 'macro avg': {'precision': 0.5452395538256113, 'recall': 0.6746384671683429, 'f1-score': 0.5792720337831453, 'support': 153450}, 'weighted avg': {'precision': 0.8651324922866293, 'recall': 0.7916976213750407, 'f1-score': 0.818492177471182, 'support': 153450}}
[[  5375   3661   1265]
 [  7025 108873  16615]
 [  1039   2359   7238]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.5503073
{'0': {'precision': 0.4725374489332728, 'recall': 0.5044302921223868, 'f1-score': 0.4879633039809823, 'support': 14446}, '1': {'precision': 0.9144090663788451, 'recall': 0.8184123457386432, 'f1-score': 0.8637516408171588, 'support': 124221}, '2': {'precision': 0.3588588029349324, 'recall': 0.6517621592369613, 'f1-score': 0.46286510376633355, 'support': 14783}, 'accuracy': 0.7727989573150863, 'macro avg': {'precision': 0.5819351060823501, 'recall': 0.6582015990326637, 'f1-score': 0.6048600161881582, 'support': 153450}, 'weighted avg': {'precision': 0.8192902854722951, 'recall': 0.7727989573150863, 'f1-score': 0.7897539608487146, 'support': 153450}}
[[  7287   5612   1547]
 [  6890 101664  15667]
 [  1244   3904   9635]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6159269
{'0': {'precision': 0.4903113799283154, 'recall': 0.49707602339181284, 'f1-score': 0.49367052919450793, 'support': 17613}, '1': {'precision': 0.8846654836517406, 'recall': 0.7950410138522483, 'f1-score': 0.8374621924577024, 'support': 117887}, '2': {'precision': 0.3839460370994941, 'recall': 0.6342061281337047, 'f1-score': 0.47831932773109237, 'support': 17950}, 'accuracy': 0.7420267188009123, 'macro avg': {'precision': 0.58630763355985, 'recall': 0.6421077217925886, 'f1-score': 0.6031506831277675, 'support': 153450}, 'weighted avg': {'precision': 0.7808292314882117, 'recall': 0.7420267188009123, 'f1-score': 0.7559905926734255, 'support': 153450}}
[[ 8755  7044  1814]
 [ 7710 93725 16452]
 [ 1391  5175 11384]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7099173
{'0': {'precision': 0.5117507389639967, 'recall': 0.4601542416452442, 'f1-score': 0.48458291272827386, 'support': 22951}, '1': {'precision': 0.8218550955414012, 'recall': 0.7695533459448881, 'f1-score': 0.7948447704161434, 'support': 107309}, '2': {'precision': 0.42009711440324127, 'recall': 0.5857266062958172, 'f1-score': 0.48927471498298, 'support': 23190}, 'accuracy': 0.6954969045291626, 'macro avg': {'precision': 0.5845676496362131, 'recall': 0.6051447312953165, 'f1-score': 0.5895674660424658, 'support': 153450}, 'weighted avg': {'precision': 0.7147584994488504, 'recall': 0.6954969045291626, 'f1-score': 0.7022609354126285, 'support': 153450}}
[[10561 10008  2382]
 [ 8361 82580 16368]
 [ 1715  7892 13583]]
training model: results/AAL/W9/deepVOL_L2/seq2seq
Epoch 1/50
1577/1577 - 54s - loss: 10.2167 - accuracy10: 0.5830 - accuracy20: 0.5837 - accuracy30: 0.5727 - accuracy50: 0.5578 - val_loss: 9.9429 - val_accuracy10: 0.7753 - val_accuracy20: 0.7661 - val_accuracy30: 0.7440 - val_accuracy50: 0.6990 - 54s/epoch - 34ms/step
Epoch 2/50
1577/1577 - 48s - loss: 9.6286 - accuracy10: 0.6412 - accuracy20: 0.6340 - accuracy30: 0.6143 - accuracy50: 0.5898 - val_loss: 9.3198 - val_accuracy10: 0.7737 - val_accuracy20: 0.7605 - val_accuracy30: 0.7331 - val_accuracy50: 0.6864 - 48s/epoch - 30ms/step
Epoch 3/50
1577/1577 - 45s - loss: 9.3270 - accuracy10: 0.6603 - accuracy20: 0.6459 - accuracy30: 0.6228 - accuracy50: 0.5970 - val_loss: 8.9954 - val_accuracy10: 0.7295 - val_accuracy20: 0.7222 - val_accuracy30: 0.7018 - val_accuracy50: 0.6657 - 45s/epoch - 29ms/step
Epoch 4/50
1577/1577 - 46s - loss: 9.0646 - accuracy10: 0.6775 - accuracy20: 0.6592 - accuracy30: 0.6315 - accuracy50: 0.6024 - val_loss: 8.8540 - val_accuracy10: 0.7541 - val_accuracy20: 0.7422 - val_accuracy30: 0.7170 - val_accuracy50: 0.6761 - 46s/epoch - 29ms/step
Epoch 5/50
1577/1577 - 46s - loss: 8.8659 - accuracy10: 0.6890 - accuracy20: 0.6688 - accuracy30: 0.6400 - accuracy50: 0.6086 - val_loss: 8.7264 - val_accuracy10: 0.7541 - val_accuracy20: 0.7384 - val_accuracy30: 0.7113 - val_accuracy50: 0.6713 - 46s/epoch - 29ms/step
Epoch 6/50
1577/1577 - 46s - loss: 8.7519 - accuracy10: 0.6952 - accuracy20: 0.6742 - accuracy30: 0.6436 - accuracy50: 0.6117 - val_loss: 8.6935 - val_accuracy10: 0.7593 - val_accuracy20: 0.7431 - val_accuracy30: 0.7136 - val_accuracy50: 0.6708 - 46s/epoch - 29ms/step
Epoch 7/50
1577/1577 - 46s - loss: 8.6687 - accuracy10: 0.6986 - accuracy20: 0.6773 - accuracy30: 0.6472 - accuracy50: 0.6151 - val_loss: 8.7031 - val_accuracy10: 0.7473 - val_accuracy20: 0.7296 - val_accuracy30: 0.7021 - val_accuracy50: 0.6619 - 46s/epoch - 29ms/step
Epoch 8/50
1577/1577 - 46s - loss: 8.6130 - accuracy10: 0.7001 - accuracy20: 0.6796 - accuracy30: 0.6487 - accuracy50: 0.6154 - val_loss: 8.6775 - val_accuracy10: 0.7609 - val_accuracy20: 0.7432 - val_accuracy30: 0.7149 - val_accuracy50: 0.6727 - 46s/epoch - 29ms/step
Epoch 9/50
1577/1577 - 45s - loss: 8.5677 - accuracy10: 0.7013 - accuracy20: 0.6811 - accuracy30: 0.6512 - accuracy50: 0.6184 - val_loss: 8.7316 - val_accuracy10: 0.7743 - val_accuracy20: 0.7583 - val_accuracy30: 0.7303 - val_accuracy50: 0.6865 - 45s/epoch - 29ms/step
Epoch 10/50
1577/1577 - 46s - loss: 8.5213 - accuracy10: 0.7023 - accuracy20: 0.6825 - accuracy30: 0.6524 - accuracy50: 0.6191 - val_loss: 8.5927 - val_accuracy10: 0.7614 - val_accuracy20: 0.7437 - val_accuracy30: 0.7149 - val_accuracy50: 0.6731 - 46s/epoch - 29ms/step
Epoch 11/50
1577/1577 - 45s - loss: 8.4694 - accuracy10: 0.7050 - accuracy20: 0.6844 - accuracy30: 0.6540 - accuracy50: 0.6204 - val_loss: 8.6190 - val_accuracy10: 0.7656 - val_accuracy20: 0.7469 - val_accuracy30: 0.7196 - val_accuracy50: 0.6772 - 45s/epoch - 29ms/step
Epoch 12/50
1577/1577 - 46s - loss: 8.4368 - accuracy10: 0.7057 - accuracy20: 0.6851 - accuracy30: 0.6555 - accuracy50: 0.6215 - val_loss: 8.6057 - val_accuracy10: 0.7607 - val_accuracy20: 0.7420 - val_accuracy30: 0.7148 - val_accuracy50: 0.6744 - 46s/epoch - 29ms/step
Epoch 13/50
1577/1577 - 46s - loss: 8.3836 - accuracy10: 0.7078 - accuracy20: 0.6861 - accuracy30: 0.6562 - accuracy50: 0.6227 - val_loss: 8.6471 - val_accuracy10: 0.7679 - val_accuracy20: 0.7482 - val_accuracy30: 0.7208 - val_accuracy50: 0.6798 - 46s/epoch - 29ms/step
Epoch 14/50
1577/1577 - 46s - loss: 8.3737 - accuracy10: 0.7086 - accuracy20: 0.6860 - accuracy30: 0.6568 - accuracy50: 0.6230 - val_loss: 8.6992 - val_accuracy10: 0.7624 - val_accuracy20: 0.7414 - val_accuracy30: 0.7149 - val_accuracy50: 0.6737 - 46s/epoch - 29ms/step
Epoch 15/50
1577/1577 - 46s - loss: 8.3356 - accuracy10: 0.7086 - accuracy20: 0.6855 - accuracy30: 0.6564 - accuracy50: 0.6245 - val_loss: 8.5756 - val_accuracy10: 0.7481 - val_accuracy20: 0.7287 - val_accuracy30: 0.7010 - val_accuracy50: 0.6610 - 46s/epoch - 29ms/step
Epoch 16/50
1577/1577 - 46s - loss: 8.3080 - accuracy10: 0.7088 - accuracy20: 0.6868 - accuracy30: 0.6574 - accuracy50: 0.6245 - val_loss: 8.6118 - val_accuracy10: 0.7593 - val_accuracy20: 0.7413 - val_accuracy30: 0.7137 - val_accuracy50: 0.6729 - 46s/epoch - 29ms/step
Epoch 17/50
1577/1577 - 46s - loss: 8.2788 - accuracy10: 0.7091 - accuracy20: 0.6879 - accuracy30: 0.6585 - accuracy50: 0.6254 - val_loss: 8.5835 - val_accuracy10: 0.7679 - val_accuracy20: 0.7488 - val_accuracy30: 0.7223 - val_accuracy50: 0.6820 - 46s/epoch - 29ms/step
Epoch 18/50
1577/1577 - 46s - loss: 8.2484 - accuracy10: 0.7093 - accuracy20: 0.6864 - accuracy30: 0.6580 - accuracy50: 0.6256 - val_loss: 8.5670 - val_accuracy10: 0.7544 - val_accuracy20: 0.7385 - val_accuracy30: 0.7139 - val_accuracy50: 0.6748 - 46s/epoch - 29ms/step
Epoch 19/50
1577/1577 - 46s - loss: 8.2186 - accuracy10: 0.7102 - accuracy20: 0.6880 - accuracy30: 0.6593 - accuracy50: 0.6266 - val_loss: 8.6957 - val_accuracy10: 0.7729 - val_accuracy20: 0.7567 - val_accuracy30: 0.7328 - val_accuracy50: 0.6924 - 46s/epoch - 29ms/step
Epoch 20/50
1577/1577 - 46s - loss: 8.1838 - accuracy10: 0.7095 - accuracy20: 0.6880 - accuracy30: 0.6597 - accuracy50: 0.6274 - val_loss: 8.6658 - val_accuracy10: 0.7712 - val_accuracy20: 0.7547 - val_accuracy30: 0.7307 - val_accuracy50: 0.6902 - 46s/epoch - 29ms/step
Epoch 21/50
1577/1577 - 47s - loss: 8.1581 - accuracy10: 0.7113 - accuracy20: 0.6883 - accuracy30: 0.6598 - accuracy50: 0.6266 - val_loss: 8.6805 - val_accuracy10: 0.7617 - val_accuracy20: 0.7434 - val_accuracy30: 0.7187 - val_accuracy50: 0.6790 - 47s/epoch - 30ms/step
Epoch 22/50
1577/1577 - 46s - loss: 8.1288 - accuracy10: 0.7117 - accuracy20: 0.6890 - accuracy30: 0.6608 - accuracy50: 0.6282 - val_loss: 8.7019 - val_accuracy10: 0.7774 - val_accuracy20: 0.7576 - val_accuracy30: 0.7321 - val_accuracy50: 0.6916 - 46s/epoch - 29ms/step
Epoch 23/50
1577/1577 - 46s - loss: 8.1116 - accuracy10: 0.7111 - accuracy20: 0.6890 - accuracy30: 0.6602 - accuracy50: 0.6281 - val_loss: 8.7341 - val_accuracy10: 0.7720 - val_accuracy20: 0.7533 - val_accuracy30: 0.7284 - val_accuracy50: 0.6874 - 46s/epoch - 29ms/step
Epoch 24/50
1577/1577 - 47s - loss: 8.0798 - accuracy10: 0.7121 - accuracy20: 0.6892 - accuracy30: 0.6614 - accuracy50: 0.6291 - val_loss: 8.7229 - val_accuracy10: 0.7625 - val_accuracy20: 0.7433 - val_accuracy30: 0.7183 - val_accuracy50: 0.6783 - 47s/epoch - 30ms/step
Epoch 25/50
1577/1577 - 46s - loss: 8.0447 - accuracy10: 0.7128 - accuracy20: 0.6903 - accuracy30: 0.6615 - accuracy50: 0.6282 - val_loss: 8.7828 - val_accuracy10: 0.7666 - val_accuracy20: 0.7473 - val_accuracy30: 0.7224 - val_accuracy50: 0.6819 - 46s/epoch - 29ms/step
Epoch 26/50
1577/1577 - 45s - loss: 8.0347 - accuracy10: 0.7119 - accuracy20: 0.6903 - accuracy30: 0.6621 - accuracy50: 0.6294 - val_loss: 8.8836 - val_accuracy10: 0.7706 - val_accuracy20: 0.7521 - val_accuracy30: 0.7270 - val_accuracy50: 0.6866 - 45s/epoch - 29ms/step
Epoch 27/50
1577/1577 - 45s - loss: 8.0040 - accuracy10: 0.7118 - accuracy20: 0.6900 - accuracy30: 0.6616 - accuracy50: 0.6294 - val_loss: 8.7927 - val_accuracy10: 0.7631 - val_accuracy20: 0.7446 - val_accuracy30: 0.7217 - val_accuracy50: 0.6841 - 45s/epoch - 29ms/step
Epoch 28/50
1577/1577 - 45s - loss: 7.9693 - accuracy10: 0.7131 - accuracy20: 0.6901 - accuracy30: 0.6619 - accuracy50: 0.6294 - val_loss: 8.8832 - val_accuracy10: 0.7631 - val_accuracy20: 0.7430 - val_accuracy30: 0.7181 - val_accuracy50: 0.6792 - 45s/epoch - 29ms/step
testing model: results/AAL/W9/deepVOL_L2/seq2seq
Evaluating performance on  test set...
3870/3870 - 36s - 36s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.711696
{'0': {'precision': 0.32918961648306816, 'recall': 0.6129357721936686, 'f1-score': 0.42833383794186086, 'support': 84247}, '1': {'precision': 0.9447341576810153, 'recall': 0.7000375511786224, 'f1-score': 0.8041838058077336, 'support': 825540}, '2': {'precision': 0.24638255341755283, 'recall': 0.676372804686631, 'f1-score': 0.36119315313055844, 'support': 80911}, 'accuracy': 0.6906978716016384, 'macro avg': {'precision': 0.5067687758605454, 'recall': 0.6631153760196407, 'f1-score': 0.5312369322933844, 'support': 990698}, 'weighted avg': {'precision': 0.8353546014339406, 'recall': 0.6906978716016384, 'f1-score': 0.7360429102557499, 'support': 990698}}
[[ 51638  20070  12539]
 [ 92778 577909 154853]
 [ 12448  13737  54726]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7338401
{'0': {'precision': 0.39911993746924124, 'recall': 0.5974881471401454, 'f1-score': 0.47856210602315963, 'support': 115373}, '1': {'precision': 0.9068495406988515, 'recall': 0.6908391758290593, 'f1-score': 0.784241864909498, 'support': 765084}, '2': {'precision': 0.3035242684176728, 'recall': 0.6474088587730518, 'f1-score': 0.41328731665228646, 'support': 110241}, 'accuracy': 0.6751351067631105, 'macro avg': {'precision': 0.5364979155285886, 'recall': 0.6452453939140855, 'f1-score': 0.5586970958616481, 'support': 990698}, 'weighted avg': {'precision': 0.7805855643357628, 'recall': 0.6751351067631105, 'f1-score': 0.7073651666862083, 'support': 990698}}
[[ 68934  31004  15435]
 [ 88199 528550 148335]
 [ 15582  23288  71371]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.77427495
{'0': {'precision': 0.42881106595546525, 'recall': 0.5852677346198847, 'f1-score': 0.4949699786827268, 'support': 138458}, '1': {'precision': 0.8716884642691106, 'recall': 0.6716665347623432, 'f1-score': 0.7587158761987588, 'support': 720219}, '2': {'precision': 0.3344598975555988, 'recall': 0.6251581187841329, 'f1-score': 0.43577823009643896, 'support': 132021}, 'accuracy': 0.6533938697766625, 'macro avg': {'precision': 0.5449864759267249, 'recall': 0.6273641293887869, 'f1-score': 0.5631546949926415, 'support': 990698}, 'weighted avg': {'precision': 0.7382013961395745, 'recall': 0.6533938697766625, 'f1-score': 0.6788204081001564, 'support': 990698}}
[[ 81035  39508  17915]
 [ 90153 483747 146319]
 [ 17788  31699  82534]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8363885
{'0': {'precision': 0.4673583253086091, 'recall': 0.5458558227597705, 'f1-score': 0.5035663263710022, 'support': 176935}, '1': {'precision': 0.8022861432812387, 'recall': 0.650550119510586, 'f1-score': 0.7184943820032985, 'support': 647223}, '2': {'precision': 0.3746966990830572, 'recall': 0.5832412633601537, 'f1-score': 0.45626874540539397, 'support': 166540}, 'accuracy': 0.6205372373821285, 'macro avg': {'precision': 0.548113722557635, 'recall': 0.59321573521017, 'f1-score': 0.5594431512598982, 'support': 990698}, 'weighted avg': {'precision': 0.6705899053664026, 'recall': 0.6205372373821285, 'f1-score': 0.6360279259871207, 'support': 990698}}
[[ 96581  55912  24442]
 [ 88516 421051 137656]
 [ 21556  47851  97133]]
Evaluating performance on  train set...
1577/1577 - 16s - 16s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.596453
{'0': {'precision': 0.31860328144720235, 'recall': 0.6446812857532007, 'f1-score': 0.42645253567285707, 'support': 29368}, '1': {'precision': 0.9557213083279297, 'recall': 0.7631323182302032, 'f1-score': 0.848637494591956, 'support': 345712}, '2': {'precision': 0.2848555219142244, 'recall': 0.6817094618360886, 'f1-score': 0.40181199983414195, 'support': 28430}, 'accuracy': 0.7487745037297713, 'macro avg': {'precision': 0.5197267038964521, 'recall': 0.6965076886064976, 'f1-score': 0.5589673433663184, 'support': 403510}, 'weighted avg': {'precision': 0.8620839845412209, 'recall': 0.7487745037297713, 'f1-score': 0.7864284373455416, 'support': 403510}}
[[ 18933   6726   3709]
 [ 36940 263824  44948]
 [  3552   5497  19381]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.62710726
{'0': {'precision': 0.37998334468922706, 'recall': 0.6203895975477108, 'f1-score': 0.4712996610233152, 'support': 40452}, '1': {'precision': 0.9233275626148159, 'recall': 0.7542503195845093, 'f1-score': 0.8302685873163703, 'support': 323858}, '2': {'precision': 0.34765673218032944, 'recall': 0.6466326530612245, 'f1-score': 0.45219469989563915, 'support': 39200}, 'accuracy': 0.7303759510297143, 'macro avg': {'precision': 0.5503225464947908, 'recall': 0.6737575233978149, 'f1-score': 0.5845876494117749, 'support': 403510}, 'weighted avg': {'precision': 0.812932140304197, 'recall': 0.7303759510297143, 'f1-score': 0.7575528989981148, 'support': 403510}}
[[ 25096  10817   4539]
 [ 36564 244270  43024]
 [  4385   9467  25348]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.67855287
{'0': {'precision': 0.4039641017935443, 'recall': 0.604653540248216, 'f1-score': 0.4843427560680009, 'support': 48909}, '1': {'precision': 0.8918621932709335, 'recall': 0.7346674307445853, 'f1-score': 0.8056688257432388, 'support': 307124}, '2': {'precision': 0.37822560825755713, 'recall': 0.6158982244033954, 'f1-score': 0.46865083181075107, 'support': 47477}, 'accuracy': 0.7049342023741667, 'macro avg': {'precision': 0.5580173011073449, 'recall': 0.6517397317987322, 'f1-score': 0.5862208045406637, 'support': 403510}, 'weighted avg': {'precision': 0.7722901085574254, 'recall': 0.7049342023741667, 'f1-score': 0.7270677005178939, 'support': 403510}}
[[ 29573  14174   5162]
 [ 38582 225634  42908]
 [  5052  13184  29241]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7557399
{'0': {'precision': 0.4343263454701483, 'recall': 0.5602061953479547, 'f1-score': 0.4892998460061736, 'support': 63241}, '1': {'precision': 0.8265833378439708, 'recall': 0.7119117546860599, 'f1-score': 0.7649740285762726, 'support': 278859}, '2': {'precision': 0.41828610564164026, 'recall': 0.5569451229441459, 'f1-score': 0.4777582991681624, 'support': 61410}, 'accuracy': 0.6645510644098039, 'macro avg': {'precision': 0.5597319296519198, 'recall': 0.6096876909927201, 'f1-score': 0.5773440579168695, 'support': 403510}, 'weighted avg': {'precision': 0.7029674237792437, 'recall': 0.6645510644098039, 'f1-score': 0.6780571518622689, 'support': 403510}}
[[ 35428  21013   6800]
 [ 39571 198523  40765]
 [  6571  20637  34202]]
Evaluating performance on  val set...
600/600 - 6s - 6s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.58389664
{'0': {'precision': 0.3103291300587244, 'recall': 0.6605620155038759, 'f1-score': 0.4222752191284418, 'support': 10320}, '1': {'precision': 0.9615866269472326, 'recall': 0.7649238525047922, 'f1-score': 0.8520545411748881, 'support': 132506}, '2': {'precision': 0.2908693484679986, 'recall': 0.7139495481927711, 'f1-score': 0.41334023596087294, 'support': 10624}, 'accuracy': 0.754376018246986, 'macro avg': {'precision': 0.5209283684913185, 'recall': 0.7131451387338131, 'f1-score': 0.5625566654214009, 'support': 153450}, 'weighted avg': {'precision': 0.8713508645852073, 'recall': 0.754376018246986, 'f1-score': 0.7927764481014895, 'support': 153450}}
[[  6817   2216   1287]
 [ 13944 101357  17205]
 [  1206   1833   7585]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.60834527
{'0': {'precision': 0.37578783662110177, 'recall': 0.635960659371104, 'f1-score': 0.4724223091171023, 'support': 14438}, '1': {'precision': 0.9318675218335201, 'recall': 0.7566262344958589, 'f1-score': 0.8351531196972255, 'support': 124241}, '2': {'precision': 0.3597853512918014, 'recall': 0.685397061810304, 'f1-score': 0.4718713586576555, 'support': 14771}, 'accuracy': 0.73841642228739, 'macro avg': {'precision': 0.5558135699154744, 'recall': 0.692661318559089, 'f1-score': 0.5931489291573278, 'support': 153450}, 'weighted avg': {'precision': 0.8244781165798959, 'recall': 0.73841642228739, 'f1-score': 0.7660547662565522, 'support': 153450}}
[[ 9182  3691  1565]
 [13787 94004 16450]
 [ 1465  3182 10124]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.65801096
{'0': {'precision': 0.40380056304637724, 'recall': 0.6195510088093208, 'f1-score': 0.48893274427575073, 'support': 17595}, '1': {'precision': 0.9020605733949709, 'recall': 0.7379028497299497, 'f1-score': 0.8117657483711797, 'support': 117941}, '2': {'precision': 0.3923805711235655, 'recall': 0.6565814446801385, 'f1-score': 0.49120902067237415, 'support': 17914}, 'accuracy': 0.7148387096774194, 'macro avg': {'precision': 0.5660805691883045, 'recall': 0.6713451010731363, 'f1-score': 0.5973025044397682, 'support': 153450}, 'weighted avg': {'precision': 0.785427843236786, 'recall': 0.7148387096774194, 'f1-score': 0.737326517826667, 'support': 153450}}
[[10901  4919  1775]
 [14473 87029 16439]
 [ 1622  4530 11762]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7361499
{'0': {'precision': 0.4343954546964814, 'recall': 0.5699960762087457, 'f1-score': 0.49304219934381716, 'support': 22937}, '1': {'precision': 0.8385962229528251, 'recall': 0.7153732191608508, 'f1-score': 0.7720991974898932, 'support': 107323}, '2': {'precision': 0.43474842767295596, 'recall': 0.5961621388529539, 'f1-score': 0.502818694308056, 'support': 23190}, 'accuracy': 0.6756272401433692, 'macro avg': {'precision': 0.5692467017740874, 'recall': 0.6271771447408502, 'f1-score': 0.5893200303805889, 'support': 153450}, 'weighted avg': {'precision': 0.7171469991402742, 'recall': 0.6756272401433692, 'f1-score': 0.689692255585277, 'support': 153450}}
[[13074  7528  2335]
 [14907 76776 15640]
 [ 2116  7249 13825]]
training model: results/AAL/W9/deepVOL_L3/seq2seq
Epoch 1/50
1577/1577 - 75s - loss: 10.6720 - accuracy10: 0.5144 - accuracy20: 0.5243 - accuracy30: 0.5268 - accuracy50: 0.5280 - val_loss: 9.6258 - val_accuracy10: 0.6473 - val_accuracy20: 0.6525 - val_accuracy30: 0.6448 - val_accuracy50: 0.6220 - 75s/epoch - 48ms/step
Epoch 2/50
1577/1577 - 66s - loss: 9.4554 - accuracy10: 0.6460 - accuracy20: 0.6389 - accuracy30: 0.6225 - accuracy50: 0.5998 - val_loss: 9.0360 - val_accuracy10: 0.7053 - val_accuracy20: 0.6951 - val_accuracy30: 0.6768 - val_accuracy50: 0.6500 - 66s/epoch - 42ms/step
Epoch 3/50
1577/1577 - 67s - loss: 9.0932 - accuracy10: 0.6688 - accuracy20: 0.6553 - accuracy30: 0.6330 - accuracy50: 0.6057 - val_loss: 8.9152 - val_accuracy10: 0.7260 - val_accuracy20: 0.7161 - val_accuracy30: 0.6987 - val_accuracy50: 0.6721 - 67s/epoch - 43ms/step
Epoch 4/50
1577/1577 - 66s - loss: 8.8817 - accuracy10: 0.6845 - accuracy20: 0.6673 - accuracy30: 0.6411 - accuracy50: 0.6118 - val_loss: 8.8680 - val_accuracy10: 0.7099 - val_accuracy20: 0.6998 - val_accuracy30: 0.6841 - val_accuracy50: 0.6603 - 66s/epoch - 42ms/step
Epoch 5/50
1577/1577 - 66s - loss: 8.7025 - accuracy10: 0.6912 - accuracy20: 0.6732 - accuracy30: 0.6461 - accuracy50: 0.6167 - val_loss: 8.7310 - val_accuracy10: 0.6989 - val_accuracy20: 0.6898 - val_accuracy30: 0.6738 - val_accuracy50: 0.6507 - 66s/epoch - 42ms/step
Epoch 6/50
1577/1577 - 67s - loss: 8.5926 - accuracy10: 0.6975 - accuracy20: 0.6773 - accuracy30: 0.6496 - accuracy50: 0.6194 - val_loss: 8.5660 - val_accuracy10: 0.7322 - val_accuracy20: 0.7214 - val_accuracy30: 0.7026 - val_accuracy50: 0.6752 - 67s/epoch - 43ms/step
Epoch 7/50
1577/1577 - 67s - loss: 8.5339 - accuracy10: 0.6997 - accuracy20: 0.6791 - accuracy30: 0.6510 - accuracy50: 0.6212 - val_loss: 8.4371 - val_accuracy10: 0.7168 - val_accuracy20: 0.7076 - val_accuracy30: 0.6890 - val_accuracy50: 0.6608 - 67s/epoch - 42ms/step
Epoch 8/50
1577/1577 - 66s - loss: 8.4663 - accuracy10: 0.7046 - accuracy20: 0.6830 - accuracy30: 0.6551 - accuracy50: 0.6245 - val_loss: 8.4138 - val_accuracy10: 0.7100 - val_accuracy20: 0.7025 - val_accuracy30: 0.6835 - val_accuracy50: 0.6550 - 66s/epoch - 42ms/step
Epoch 9/50
1577/1577 - 66s - loss: 8.4218 - accuracy10: 0.7040 - accuracy20: 0.6826 - accuracy30: 0.6553 - accuracy50: 0.6256 - val_loss: 8.4694 - val_accuracy10: 0.6931 - val_accuracy20: 0.6902 - val_accuracy30: 0.6762 - val_accuracy50: 0.6546 - 66s/epoch - 42ms/step
Epoch 10/50
1577/1577 - 67s - loss: 8.3636 - accuracy10: 0.7077 - accuracy20: 0.6859 - accuracy30: 0.6582 - accuracy50: 0.6268 - val_loss: 8.4121 - val_accuracy10: 0.6836 - val_accuracy20: 0.6801 - val_accuracy30: 0.6662 - val_accuracy50: 0.6457 - 67s/epoch - 42ms/step
Epoch 11/50
1577/1577 - 66s - loss: 8.3239 - accuracy10: 0.7086 - accuracy20: 0.6872 - accuracy30: 0.6599 - accuracy50: 0.6289 - val_loss: 8.5698 - val_accuracy10: 0.7207 - val_accuracy20: 0.7116 - val_accuracy30: 0.6931 - val_accuracy50: 0.6651 - 66s/epoch - 42ms/step
Epoch 12/50
1577/1577 - 66s - loss: 8.2951 - accuracy10: 0.7108 - accuracy20: 0.6891 - accuracy30: 0.6621 - accuracy50: 0.6307 - val_loss: 8.4901 - val_accuracy10: 0.7566 - val_accuracy20: 0.7459 - val_accuracy30: 0.7249 - val_accuracy50: 0.6901 - 66s/epoch - 42ms/step
Epoch 13/50
1577/1577 - 67s - loss: 8.2690 - accuracy10: 0.7107 - accuracy20: 0.6892 - accuracy30: 0.6611 - accuracy50: 0.6295 - val_loss: 8.3379 - val_accuracy10: 0.6954 - val_accuracy20: 0.6900 - val_accuracy30: 0.6737 - val_accuracy50: 0.6494 - 67s/epoch - 42ms/step
Epoch 14/50
1577/1577 - 66s - loss: 8.2426 - accuracy10: 0.7119 - accuracy20: 0.6904 - accuracy30: 0.6637 - accuracy50: 0.6314 - val_loss: 8.2772 - val_accuracy10: 0.6965 - val_accuracy20: 0.6909 - val_accuracy30: 0.6760 - val_accuracy50: 0.6534 - 66s/epoch - 42ms/step
Epoch 15/50
1577/1577 - 66s - loss: 8.2077 - accuracy10: 0.7133 - accuracy20: 0.6920 - accuracy30: 0.6643 - accuracy50: 0.6323 - val_loss: 8.2922 - val_accuracy10: 0.6924 - val_accuracy20: 0.6864 - val_accuracy30: 0.6697 - val_accuracy50: 0.6468 - 66s/epoch - 42ms/step
Epoch 16/50
1577/1577 - 67s - loss: 8.1712 - accuracy10: 0.7136 - accuracy20: 0.6929 - accuracy30: 0.6651 - accuracy50: 0.6330 - val_loss: 8.2990 - val_accuracy10: 0.7086 - val_accuracy20: 0.7053 - val_accuracy30: 0.6901 - val_accuracy50: 0.6639 - 67s/epoch - 42ms/step
Epoch 17/50
1577/1577 - 66s - loss: 8.1401 - accuracy10: 0.7150 - accuracy20: 0.6927 - accuracy30: 0.6660 - accuracy50: 0.6337 - val_loss: 8.3980 - val_accuracy10: 0.6685 - val_accuracy20: 0.6665 - val_accuracy30: 0.6535 - val_accuracy50: 0.6329 - 66s/epoch - 42ms/step
Epoch 18/50
1577/1577 - 66s - loss: 8.1138 - accuracy10: 0.7150 - accuracy20: 0.6935 - accuracy30: 0.6658 - accuracy50: 0.6346 - val_loss: 8.3097 - val_accuracy10: 0.7195 - val_accuracy20: 0.7138 - val_accuracy30: 0.6976 - val_accuracy50: 0.6702 - 66s/epoch - 42ms/step
Epoch 19/50
1577/1577 - 66s - loss: 8.0939 - accuracy10: 0.7155 - accuracy20: 0.6938 - accuracy30: 0.6670 - accuracy50: 0.6351 - val_loss: 8.2598 - val_accuracy10: 0.7161 - val_accuracy20: 0.7106 - val_accuracy30: 0.6930 - val_accuracy50: 0.6627 - 66s/epoch - 42ms/step
Epoch 20/50
1577/1577 - 66s - loss: 8.0656 - accuracy10: 0.7148 - accuracy20: 0.6938 - accuracy30: 0.6669 - accuracy50: 0.6350 - val_loss: 8.4777 - val_accuracy10: 0.7131 - val_accuracy20: 0.7074 - val_accuracy30: 0.6894 - val_accuracy50: 0.6596 - 66s/epoch - 42ms/step
Epoch 21/50
1577/1577 - 66s - loss: 8.0340 - accuracy10: 0.7150 - accuracy20: 0.6942 - accuracy30: 0.6671 - accuracy50: 0.6353 - val_loss: 8.3575 - val_accuracy10: 0.7014 - val_accuracy20: 0.6971 - val_accuracy30: 0.6798 - val_accuracy50: 0.6533 - 66s/epoch - 42ms/step
Epoch 22/50
1577/1577 - 67s - loss: 8.0100 - accuracy10: 0.7160 - accuracy20: 0.6951 - accuracy30: 0.6683 - accuracy50: 0.6361 - val_loss: 8.3218 - val_accuracy10: 0.7197 - val_accuracy20: 0.7140 - val_accuracy30: 0.6955 - val_accuracy50: 0.6655 - 67s/epoch - 43ms/step
Epoch 23/50
1577/1577 - 67s - loss: 7.9910 - accuracy10: 0.7176 - accuracy20: 0.6960 - accuracy30: 0.6685 - accuracy50: 0.6363 - val_loss: 8.4646 - val_accuracy10: 0.7249 - val_accuracy20: 0.7184 - val_accuracy30: 0.6988 - val_accuracy50: 0.6651 - 67s/epoch - 43ms/step
Epoch 24/50
1577/1577 - 68s - loss: 7.9653 - accuracy10: 0.7178 - accuracy20: 0.6960 - accuracy30: 0.6687 - accuracy50: 0.6357 - val_loss: 8.4402 - val_accuracy10: 0.7297 - val_accuracy20: 0.7245 - val_accuracy30: 0.7053 - val_accuracy50: 0.6727 - 68s/epoch - 43ms/step
Epoch 25/50
1577/1577 - 68s - loss: 7.9373 - accuracy10: 0.7162 - accuracy20: 0.6962 - accuracy30: 0.6694 - accuracy50: 0.6371 - val_loss: 8.3737 - val_accuracy10: 0.7037 - val_accuracy20: 0.6980 - val_accuracy30: 0.6746 - val_accuracy50: 0.6406 - 68s/epoch - 43ms/step
Epoch 26/50
1577/1577 - 70s - loss: 7.9089 - accuracy10: 0.7175 - accuracy20: 0.6968 - accuracy30: 0.6692 - accuracy50: 0.6368 - val_loss: 8.4668 - val_accuracy10: 0.7004 - val_accuracy20: 0.6967 - val_accuracy30: 0.6783 - val_accuracy50: 0.6470 - 70s/epoch - 44ms/step
Epoch 27/50
1577/1577 - 71s - loss: 7.8854 - accuracy10: 0.7175 - accuracy20: 0.6974 - accuracy30: 0.6705 - accuracy50: 0.6377 - val_loss: 8.5102 - val_accuracy10: 0.7040 - val_accuracy20: 0.7025 - val_accuracy30: 0.6834 - val_accuracy50: 0.6526 - 71s/epoch - 45ms/step
Epoch 28/50
1577/1577 - 68s - loss: 7.8707 - accuracy10: 0.7175 - accuracy20: 0.6971 - accuracy30: 0.6691 - accuracy50: 0.6362 - val_loss: 8.6162 - val_accuracy10: 0.7314 - val_accuracy20: 0.7259 - val_accuracy30: 0.7036 - val_accuracy50: 0.6678 - 68s/epoch - 43ms/step
Epoch 29/50
1577/1577 - 68s - loss: 7.8431 - accuracy10: 0.7190 - accuracy20: 0.6983 - accuracy30: 0.6702 - accuracy50: 0.6379 - val_loss: 8.5624 - val_accuracy10: 0.6952 - val_accuracy20: 0.6921 - val_accuracy30: 0.6725 - val_accuracy50: 0.6418 - 68s/epoch - 43ms/step
testing model: results/AAL/W9/deepVOL_L3/seq2seq
Evaluating performance on  test set...
3870/3870 - 67s - 67s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.82030106
{'0': {'precision': 0.32487957013943874, 'recall': 0.6380167839804385, 'f1-score': 0.4305315263360246, 'support': 84247}, '1': {'precision': 0.9579353138085074, 'recall': 0.5969220146812995, 'f1-score': 0.735517872894903, 'support': 825540}, '2': {'precision': 0.19835471178501224, 'recall': 0.7619977506148732, 'f1-score': 0.3147716075540285, 'support': 80911}, 'accuracy': 0.613898483695334, 'macro avg': {'precision': 0.49372319857765273, 'recall': 0.665645516425537, 'f1-score': 0.49360700226165205, 'support': 990698}, 'weighted avg': {'precision': 0.8420660243507604, 'recall': 0.613898483695334, 'f1-score': 0.6752197943547815, 'support': 990698}}
[[ 53751  13787  16709]
 [100293 492783 232464]
 [ 11405   7852  61654]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8224033
{'0': {'precision': 0.401954181743468, 'recall': 0.6104374507033709, 'f1-score': 0.4847291860957303, 'support': 115373}, '1': {'precision': 0.9253035577127355, 'recall': 0.592042180989277, 'f1-score': 0.7220750319620727, 'support': 765084}, '2': {'precision': 0.2512609063800022, 'recall': 0.7429177892072822, 'f1-score': 0.37551840108941603, 'support': 110241}, 'accuracy': 0.610973273389065, 'macro avg': {'precision': 0.5261728819454019, 'recall': 0.6484658069666434, 'f1-score': 0.527440873049073, 'support': 990698}, 'weighted avg': {'precision': 0.7893514073306069, 'recall': 0.610973273389065, 'f1-score': 0.6558711516482232, 'support': 990698}}
[[ 70428  22233  22712]
 [ 90778 452962 221344]
 [ 14008  14333  81900]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8498476
{'0': {'precision': 0.44022179707513215, 'recall': 0.5883083678805126, 'f1-score': 0.503604416801652, 'support': 138458}, '1': {'precision': 0.8942214389835302, 'recall': 0.5706750307892461, 'f1-score': 0.6967179698419036, 'support': 720219}, '2': {'precision': 0.2788136425900345, 'recall': 0.7307852538611281, 'f1-score': 0.4036313813264164, 'support': 132021}, 'accuracy': 0.594475814022033, 'macro avg': {'precision': 0.5377522928828989, 'recall': 0.6299228841769623, 'f1-score': 0.5346512559899907, 'support': 990698}, 'weighted avg': {'precision': 0.7487617377355025, 'recall': 0.594475814022033, 'f1-score': 0.6306719085505209, 'support': 990698}}
[[ 81456  29006  27996]
 [ 87649 411011 221559]
 [ 15929  19613  96479]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.889062
{'0': {'precision': 0.4865249814330624, 'recall': 0.5405600926894057, 'f1-score': 0.5121211391059672, 'support': 176935}, '1': {'precision': 0.8324437119855826, 'recall': 0.5424003782313052, 'f1-score': 0.656827617691578, 'support': 647223}, '2': {'precision': 0.3150320759834263, 'recall': 0.7044373724030263, 'f1-score': 0.43536443035085737, 'support': 166540}, 'accuracy': 0.5693107283955353, 'macro avg': {'precision': 0.5446669231340238, 'recall': 0.5957992811079124, 'f1-score': 0.5347710623828009, 'support': 990698}, 'weighted avg': {'precision': 0.6836850948791493, 'recall': 0.5693107283955353, 'f1-score': 0.5937547942799343, 'support': 990698}}
[[ 95644  41243  40048]
 [ 81137 351054 215032]
 [ 19805  29418 117317]]
Evaluating performance on  train set...
1577/1577 - 27s - 27s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.66755307
{'0': {'precision': 0.3196585446709763, 'recall': 0.6566671206755652, 'f1-score': 0.4299984392071172, 'support': 29368}, '1': {'precision': 0.9644262177821225, 'recall': 0.7020120794187069, 'f1-score': 0.8125579635662366, 'support': 345712}, '2': {'precision': 0.23700482880678217, 'recall': 0.7630671825536405, 'f1-score': 0.36167516921743187, 'support': 28430}, 'accuracy': 0.703013556045699, 'macro avg': {'precision': 0.5070298637532936, 'recall': 0.707248794215971, 'f1-score': 0.5347438573302619, 'support': 403510}, 'weighted avg': {'precision': 0.8662474189605391, 'recall': 0.703013556045699, 'f1-score': 0.7529470345812916, 'support': 403510}}
[[ 19285   5405   4678]
 [ 37856 242694  65162]
 [  3189   3547  21694]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6879217
{'0': {'precision': 0.3867607578430621, 'recall': 0.6232324730544844, 'f1-score': 0.4773138199683823, 'support': 40452}, '1': {'precision': 0.936323044874721, 'recall': 0.6967158445985586, 'f1-score': 0.7989412931095532, 'support': 323858}, '2': {'precision': 0.29669313664053915, 'recall': 0.7367602040816327, 'f1-score': 0.42303157247167567, 'support': 39200}, 'accuracy': 0.6932393249237937, 'macro avg': {'precision': 0.5399256464527741, 'recall': 0.685569507244892, 'f1-score': 0.5664288951832037, 'support': 403510}, 'weighted avg': {'precision': 0.8190907927922829, 'recall': 0.6932393249237937, 'f1-score': 0.73017934026449, 'support': 403510}}
[[ 25211   8942   6299]
 [ 36058 225637  62163]
 [  3916   6403  28881]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7295902
{'0': {'precision': 0.41812580598939675, 'recall': 0.5966386554621849, 'f1-score': 0.4916806375790866, 'support': 48909}, '1': {'precision': 0.9082818402148518, 'recall': 0.6772248342688947, 'f1-score': 0.7759172870202324, 'support': 307124}, '2': {'precision': 0.32549057054189545, 'recall': 0.7179687006339912, 'f1-score': 0.4479178985821475, 'support': 47477}, 'accuracy': 0.6722509974969642, 'macro avg': {'precision': 0.5506327389153812, 'recall': 0.6639440634550237, 'f1-score': 0.5718386077271554, 'support': 403510}, 'weighted avg': {'precision': 0.7802993302691362, 'recall': 0.6722509974969642, 'f1-score': 0.7028728587473471, 'support': 403510}}
[[ 29181  12037   7691]
 [ 36185 207992  62947]
 [  4424   8966  34087]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.78893656
{'0': {'precision': 0.4578783464093345, 'recall': 0.5417055391280973, 'f1-score': 0.4962769810227437, 'support': 63241}, '1': {'precision': 0.8496153720710269, 'recall': 0.6539039442872563, 'f1-score': 0.7390218893495609, 'support': 278859}, '2': {'precision': 0.36318687098923447, 'recall': 0.6746132551701677, 'f1-score': 0.4721731499105301, 'support': 61410}, 'accuracy': 0.6394711407400064, 'macro avg': {'precision': 0.5568935298231986, 'recall': 0.6234075795285071, 'f1-score': 0.5691573400942783, 'support': 403510}, 'weighted avg': {'precision': 0.7141901893213949, 'recall': 0.6394711407400064, 'f1-score': 0.6603655689697756, 'support': 403510}}
[[ 34258  18127  10856]
 [ 34728 182347  61784]
 [  5833  14149  41428]]
Evaluating performance on  val set...
600/600 - 10s - 10s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6417241
{'0': {'precision': 0.3174206679618836, 'recall': 0.664922480620155, 'f1-score': 0.4297075583943891, 'support': 10320}, '1': {'precision': 0.9685703452445611, 'recall': 0.7132960016904895, 'f1-score': 0.8215603527330728, 'support': 132506}, '2': {'precision': 0.24216765453005928, 'recall': 0.7806852409638554, 'f1-score': 0.36966550041227464, 'support': 10624}, 'accuracy': 0.7147083740632127, 'macro avg': {'precision': 0.5093862225788347, 'recall': 0.7196345744248333, 'f1-score': 0.5403111371799122, 'support': 153450}, 'weighted avg': {'precision': 0.87448649476748, 'recall': 0.7147083740632127, 'f1-score': 0.7639203934718712, 'support': 153450}}
[[ 6862  1854  1604]
 [13639 94516 24351]
 [ 1117  1213  8294]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6544461
{'0': {'precision': 0.39086754053121764, 'recall': 0.6278570439118991, 'f1-score': 0.48179643901142705, 'support': 14438}, '1': {'precision': 0.9425089331291475, 'recall': 0.7133393968174757, 'f1-score': 0.8120656242412025, 'support': 124241}, '2': {'precision': 0.3093082316568211, 'recall': 0.7585810033173109, 'f1-score': 0.43943761397729275, 'support': 14771}, 'accuracy': 0.7096513522319974, 'macro avg': {'precision': 0.547561568439062, 'recall': 0.6999258146822286, 'f1-score': 0.5777665590766409, 'support': 153450}, 'weighted avg': {'precision': 0.8296538924789251, 'recall': 0.7096513522319974, 'f1-score': 0.7451218977116769, 'support': 153450}}
[[ 9065  3184  2189]
 [12783 88626 22832]
 [ 1344  2222 11205]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6935077
{'0': {'precision': 0.42644741626600946, 'recall': 0.5998863313441318, 'f1-score': 0.49851225617531764, 'support': 17595}, '1': {'precision': 0.916814946619217, 'recall': 0.6989935645788996, 'f1-score': 0.7932223938112488, 'support': 117941}, '2': {'precision': 0.34188607235875085, 'recall': 0.7400915485095456, 'f1-score': 0.4677120632176811, 'support': 17914}, 'accuracy': 0.6924275008145976, 'macro avg': {'precision': 0.5617161450813258, 'recall': 0.6796571481441923, 'f1-score': 0.5864822377347493, 'support': 153450}, 'weighted avg': {'precision': 0.7934699316301869, 'recall': 0.6924275008145976, 'f1-score': 0.7214295170829506, 'support': 153450}}
[[10555  4317  2723]
 [12703 82440 22798]
 [ 1493  3163 13258]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.753672
{'0': {'precision': 0.4708952683535686, 'recall': 0.5427911235122291, 'f1-score': 0.5042935839274141, 'support': 22937}, '1': {'precision': 0.8613160987074031, 'recall': 0.6829663725389712, 'f1-score': 0.7618423992973814, 'support': 107323}, '2': {'precision': 0.3833838371787836, 'recall': 0.6928848641655886, 'f1-score': 0.4936329703076758, 'support': 23190}, 'accuracy': 0.6635125448028674, 'macro avg': {'precision': 0.5718650680799184, 'recall': 0.6395474534055964, 'f1-score': 0.5865896511774905, 'support': 153450}, 'weighted avg': {'precision': 0.7307306850177675, 'recall': 0.6635125448028674, 'f1-score': 0.6828122667694426, 'support': 153450}}
[[12450  6616  3871]
 [12053 73298 21972]
 [ 1936  5186 16068]]
training model: results/AAL/W10/deepLOB_L1/seq2seq
Epoch 1/50
1686/1686 - 49s - loss: 11.0653 - accuracy10: 0.4754 - accuracy20: 0.4958 - accuracy30: 0.5058 - accuracy50: 0.5141 - val_loss: 18.7367 - val_accuracy10: 0.5752 - val_accuracy20: 0.5461 - val_accuracy30: 0.5240 - val_accuracy50: 0.4833 - 49s/epoch - 29ms/step
Epoch 2/50
1686/1686 - 45s - loss: 10.8917 - accuracy10: 0.4681 - accuracy20: 0.4960 - accuracy30: 0.5135 - accuracy50: 0.5257 - val_loss: 18.7821 - val_accuracy10: 0.6453 - val_accuracy20: 0.5881 - val_accuracy30: 0.5531 - val_accuracy50: 0.5020 - 45s/epoch - 27ms/step
Epoch 3/50
1686/1686 - 45s - loss: 10.6832 - accuracy10: 0.5052 - accuracy20: 0.5242 - accuracy30: 0.5351 - accuracy50: 0.5413 - val_loss: 17.4586 - val_accuracy10: 0.5545 - val_accuracy20: 0.5349 - val_accuracy30: 0.5231 - val_accuracy50: 0.4986 - 45s/epoch - 27ms/step
Epoch 4/50
1686/1686 - 47s - loss: 10.2456 - accuracy10: 0.5551 - accuracy20: 0.5610 - accuracy30: 0.5615 - accuracy50: 0.5593 - val_loss: 16.6297 - val_accuracy10: 0.5691 - val_accuracy20: 0.5557 - val_accuracy30: 0.5429 - val_accuracy50: 0.5145 - 47s/epoch - 28ms/step
Epoch 5/50
1686/1686 - 45s - loss: 9.9707 - accuracy10: 0.5890 - accuracy20: 0.5848 - accuracy30: 0.5771 - accuracy50: 0.5686 - val_loss: 16.8785 - val_accuracy10: 0.6017 - val_accuracy20: 0.5806 - val_accuracy30: 0.5609 - val_accuracy50: 0.5259 - 45s/epoch - 26ms/step
Epoch 6/50
1686/1686 - 44s - loss: 9.8253 - accuracy10: 0.5977 - accuracy20: 0.5934 - accuracy30: 0.5849 - accuracy50: 0.5747 - val_loss: 17.6767 - val_accuracy10: 0.5653 - val_accuracy20: 0.5534 - val_accuracy30: 0.5400 - val_accuracy50: 0.5129 - 44s/epoch - 26ms/step
Epoch 7/50
1686/1686 - 44s - loss: 9.6734 - accuracy10: 0.6143 - accuracy20: 0.6071 - accuracy30: 0.5962 - accuracy50: 0.5829 - val_loss: 17.5225 - val_accuracy10: 0.5662 - val_accuracy20: 0.5516 - val_accuracy30: 0.5368 - val_accuracy50: 0.5095 - 44s/epoch - 26ms/step
Epoch 8/50
1686/1686 - 44s - loss: 9.5703 - accuracy10: 0.6230 - accuracy20: 0.6139 - accuracy30: 0.6013 - accuracy50: 0.5868 - val_loss: 18.1374 - val_accuracy10: 0.5732 - val_accuracy20: 0.5588 - val_accuracy30: 0.5430 - val_accuracy50: 0.5139 - 44s/epoch - 26ms/step
Epoch 9/50
1686/1686 - 46s - loss: 9.4765 - accuracy10: 0.6325 - accuracy20: 0.6214 - accuracy30: 0.6068 - accuracy50: 0.5909 - val_loss: 17.9726 - val_accuracy10: 0.5631 - val_accuracy20: 0.5520 - val_accuracy30: 0.5403 - val_accuracy50: 0.5149 - 46s/epoch - 27ms/step
Epoch 10/50
1686/1686 - 44s - loss: 9.4037 - accuracy10: 0.6385 - accuracy20: 0.6262 - accuracy30: 0.6109 - accuracy50: 0.5936 - val_loss: 17.5205 - val_accuracy10: 0.5523 - val_accuracy20: 0.5417 - val_accuracy30: 0.5298 - val_accuracy50: 0.5045 - 44s/epoch - 26ms/step
Epoch 11/50
1686/1686 - 44s - loss: 9.3304 - accuracy10: 0.6409 - accuracy20: 0.6285 - accuracy30: 0.6130 - accuracy50: 0.5957 - val_loss: 17.5386 - val_accuracy10: 0.5367 - val_accuracy20: 0.5290 - val_accuracy30: 0.5188 - val_accuracy50: 0.4967 - 44s/epoch - 26ms/step
Epoch 12/50
1686/1686 - 44s - loss: 9.2704 - accuracy10: 0.6458 - accuracy20: 0.6331 - accuracy30: 0.6164 - accuracy50: 0.5983 - val_loss: 17.7794 - val_accuracy10: 0.5675 - val_accuracy20: 0.5544 - val_accuracy30: 0.5403 - val_accuracy50: 0.5131 - 44s/epoch - 26ms/step
Epoch 13/50
1686/1686 - 45s - loss: 9.2183 - accuracy10: 0.6491 - accuracy20: 0.6359 - accuracy30: 0.6180 - accuracy50: 0.5996 - val_loss: 17.6827 - val_accuracy10: 0.5621 - val_accuracy20: 0.5504 - val_accuracy30: 0.5366 - val_accuracy50: 0.5115 - 45s/epoch - 27ms/step
Epoch 14/50
1686/1686 - 46s - loss: 9.1613 - accuracy10: 0.6520 - accuracy20: 0.6389 - accuracy30: 0.6209 - accuracy50: 0.6022 - val_loss: 18.2922 - val_accuracy10: 0.5580 - val_accuracy20: 0.5510 - val_accuracy30: 0.5398 - val_accuracy50: 0.5166 - 46s/epoch - 27ms/step
testing model: results/AAL/W10/deepLOB_L1/seq2seq
Evaluating performance on  test set...
10110/10110 - 102s - 102s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.773111
{'0': {'precision': 0.26940923825907853, 'recall': 0.6337548822244017, 'f1-score': 0.3780916805500382, 'support': 290595}, '1': {'precision': 0.853815351321695, 'recall': 0.6714733025708636, 'f1-score': 0.751745202161669, 'support': 2002440}, '2': {'precision': 0.3123898663383003, 'recall': 0.3490710552893251, 'f1-score': 0.3297133866535207, 'support': 295066}, 'accuracy': 0.6304815770327356, 'macro avg': {'precision': 0.4785381519730246, 'recall': 0.5514330800281968, 'f1-score': 0.4865167564550759, 'support': 2588101}, 'weighted avg': {'precision': 0.7264703417654444, 'recall': 0.6304815770327356, 'f1-score': 0.6616756551125162, 'support': 2588101}}
[[ 184166   92048   14381]
 [ 445522 1344585  212333]
 [  53904  138163  102999]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8251178
{'0': {'precision': 0.3458635798835917, 'recall': 0.598582940963419, 'f1-score': 0.4384113536321509, 'support': 397584}, '1': {'precision': 0.787100305043327, 'recall': 0.680390219490085, 'f1-score': 0.7298654953556384, 'support': 1790377}, '2': {'precision': 0.3920739477291497, 'recall': 0.3452541610436347, 'f1-score': 0.3671775435649577, 'support': 400140}, 'accuracy': 0.6160084169821811, 'macro avg': {'precision': 0.5083459442186894, 'recall': 0.5414091071657129, 'f1-score': 0.5118181308509157, 'support': 2588101}, 'weighted avg': {'precision': 0.6582434680220502, 'recall': 0.6160084169821811, 'f1-score': 0.6290180166395782, 'support': 2588101}}
[[ 237987  140680   18917]
 [ 376932 1218155  195290]
 [  73176  188814  138150]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.872127
{'0': {'precision': 0.39117860471701454, 'recall': 0.5592604228384194, 'f1-score': 0.4603571729205338, 'support': 474271}, '1': {'precision': 0.7294353293351149, 'recall': 0.6886841868820255, 'f1-score': 0.708474244831219, 'support': 1636091}, '2': {'precision': 0.4365237288460328, 'recall': 0.3338370951502808, 'f1-score': 0.37833651209352204, 'support': 477739}, 'accuracy': 0.5994657859179375, 'macro avg': {'precision': 0.5190458876327207, 'recall': 0.5272605682902419, 'f1-score': 0.5157226432817582, 'support': 2588101}, 'weighted avg': {'precision': 0.6133808746799818, 'recall': 0.5994657859179375, 'f1-score': 0.6020663410776456, 'support': 2588101}}
[[ 265241  186445   22585]
 [ 326056 1126750  183285]
 [  86759  231493  159487]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.95782197
{'0': {'precision': 0.4421315217457117, 'recall': 0.4933052301622688, 'f1-score': 0.4663186295639957, 'support': 592104}, '1': {'precision': 0.6284895931565134, 'recall': 0.7031994958292171, 'f1-score': 0.6637488715600728, 'support': 1397939}, '2': {'precision': 0.48879592679234896, 'recall': 0.29696785261630143, 'f1-score': 0.3694664492078285, 'support': 598058}, 'accuracy': 0.5613080787805422, 'macro avg': {'precision': 0.519805680564858, 'recall': 0.49782419286926255, 'f1-score': 0.49984465011063234, 'support': 2588101}, 'weighted avg': {'precision': 0.5535743273948447, 'recall': 0.5613080787805422, 'f1-score': 0.5505781749937549, 'support': 2588101}}
[[292088 270348  29668]
 [258831 983030 156078]
 [109717 310737 177604]]
Evaluating performance on  train set...
1686/1686 - 16s - 16s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8270879
{'0': {'precision': 0.2192336589030804, 'recall': 0.684398161178347, 'f1-score': 0.3320890426548914, 'support': 42636}, '1': {'precision': 0.8696687181699043, 'recall': 0.6054266609693848, 'f1-score': 0.7138801132959312, 'support': 346364}, '2': {'precision': 0.2515869140625, 'recall': 0.3389165570381507, 'f1-score': 0.2887941388421811, 'support': 42568}, 'accuracy': 0.5869411077744411, 'macro avg': {'precision': 0.4468297637118282, 'recall': 0.5429137930619609, 'f1-score': 0.44492109826433457, 'support': 431568}, 'weighted avg': {'precision': 0.7444452182251812, 'recall': 0.5869411077744411, 'f1-score': 0.6342330962594535, 'support': 431568}}
[[ 29180  11374   2082]
 [ 95831 209698  40835]
 [  8089  20052  14427]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.86707056
{'0': {'precision': 0.28654012982739535, 'recall': 0.6599207716155701, 'f1-score': 0.3995807608877023, 'support': 58060}, '1': {'precision': 0.8119633560949225, 'recall': 0.6088573863834399, 'f1-score': 0.6958933974580676, 'support': 315601}, '2': {'precision': 0.3165239558141055, 'recall': 0.3345018736940266, 'f1-score': 0.32526468686766913, 'support': 57907}, 'accuracy': 0.5789145627108591, 'macro avg': {'precision': 0.47167581391214114, 'recall': 0.5344266772310122, 'f1-score': 0.4735796150711464, 'support': 431568}, 'weighted avg': {'precision': 0.6747996139519603, 'recall': 0.5789145627108591, 'f1-score': 0.606299385799572, 'support': 431568}}
[[ 38315  17147   2598]
 [ 84217 192156  39228]
 [ 11184  27353  19370]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9023704
{'0': {'precision': 0.32950487843708065, 'recall': 0.6250215703192408, 'f1-score': 0.4315179675051006, 'support': 69540}, '1': {'precision': 0.7623670122653656, 'recall': 0.6147614607773827, 'f1-score': 0.6806537912519024, 'support': 292803}, '2': {'precision': 0.3544194243811862, 'recall': 0.3253593355001806, 'f1-score': 0.3392682302257973, 'support': 69225}, 'accuracy': 0.5699936047158269, 'macro avg': {'precision': 0.4820971050278775, 'recall': 0.5217141221989348, 'f1-score': 0.48381332966093343, 'support': 431568}, 'weighted avg': {'precision': 0.6271822799457746, 'recall': 0.5699936047158268, 'f1-score': 0.585750275130724, 'support': 431568}}
[[ 43464  23007   3069]
 [ 74842 180004  37957]
 [ 13601  33101  22523]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.967993
{'0': {'precision': 0.3833034737895251, 'recall': 0.5635476293644097, 'f1-score': 0.45626976250375056, 'support': 87698}, '1': {'precision': 0.6750441157362194, 'recall': 0.6274984999259704, 'f1-score': 0.650403549050847, 'support': 256654}, '2': {'precision': 0.4048146876073313, 'recall': 0.2973078334250596, 'f1-score': 0.34283070007271765, 'support': 87216}, 'accuracy': 0.5477746264783302, 'macro avg': {'precision': 0.48772075904435863, 'recall': 0.4961179875718133, 'f1-score': 0.48316800387577175, 'support': 431568}, 'weighted avg': {'precision': 0.561149200865028, 'recall': 0.5477746264783302, 'f1-score': 0.5487963436762969, 'support': 431568}}
[[ 49422  34118   4158]
 [ 61638 161050  33966]
 [ 17877  43409  25930]]
Evaluating performance on  val set...
705/705 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.91262823
{'0': {'precision': 0.2253888408838415, 'recall': 0.6881654574578348, 'f1-score': 0.3395634284120232, 'support': 21226}, '1': {'precision': 0.8336559925722526, 'recall': 0.6154771714637828, 'f1-score': 0.7081422812147349, 'support': 137131}, '2': {'precision': 0.2571010860484545, 'recall': 0.16742984086684498, 'f1-score': 0.20279509074435076, 'support': 22057}, 'accuracy': 0.5692518318977463, 'macro avg': {'precision': 0.4387153065015162, 'recall': 0.4903574899294874, 'f1-score': 0.41683360012370296, 'support': 180414}, 'weighted avg': {'precision': 0.6916041000642786, 'recall': 0.5692518318977463, 'f1-score': 0.6029957975172634, 'support': 180414}}
[[14607  6033   586]
 [42645 84401 10085]
 [ 7556 10808  3693]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9723086
{'0': {'precision': 0.28495863702063534, 'recall': 0.6613375205195917, 'f1-score': 0.39829779917469044, 'support': 28022}, '1': {'precision': 0.7676888915561424, 'recall': 0.6239543448040388, 'f1-score': 0.6883988752707557, 'support': 123009}, '2': {'precision': 0.32710037657447083, 'recall': 0.17145968757444782, 'f1-score': 0.2249860444345205, 'support': 29383}, 'accuracy': 0.5560654938086844, 'macro avg': {'precision': 0.45991596838374954, 'recall': 0.48558385096602613, 'f1-score': 0.4372275729599888, 'support': 180414}, 'weighted avg': {'precision': 0.6209548269696887, 'recall': 0.5560654938086844, 'f1-score': 0.5678668125548632, 'support': 180414}}
[[18532  8790   700]
 [36593 76752  9664]
 [ 9909 14436  5038]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0136095
{'0': {'precision': 0.3223438666334909, 'recall': 0.6286355502987293, 'f1-score': 0.42616445819669607, 'support': 32973}, '1': {'precision': 0.7129118272697312, 'recall': 0.6321820758058803, 'f1-score': 0.6701243352593016, 'support': 112920}, '2': {'precision': 0.36458659322776493, 'recall': 0.16873786970249993, 'f1-score': 0.2307022060279615, 'support': 34521}, 'accuracy': 0.5428569844912258, 'macro avg': {'precision': 0.4666140957103291, 'recall': 0.47651849860236983, 'f1-score': 0.44233033316131976, 'support': 180414}, 'weighted avg': {'precision': 0.574880783279678, 'recall': 0.5428569844912258, 'f1-score': 0.5414570458605832, 'support': 180414}}
[[20728 11460   785]
 [32167 71386  9367]
 [11409 17287  5825]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.084481
{'0': {'precision': 0.36875435374580456, 'recall': 0.5740905057675244, 'f1-score': 0.44906300609238836, 'support': 40572}, '1': {'precision': 0.6208581809565183, 'recall': 0.6460670694119097, 'f1-score': 0.6332118258347766, 'support': 97332}, '2': {'precision': 0.4142552924965552, 'recall': 0.1555869207245354, 'f1-score': 0.22621246323277927, 'support': 42510}, 'accuracy': 0.514311527930205, 'macro avg': {'precision': 0.467955942399626, 'recall': 0.4585814986346565, 'f1-score': 0.4361624317199814, 'support': 180414}, 'weighted avg': {'precision': 0.5154836242922566, 'recall': 0.514311527930205, 'f1-score': 0.4959008143899936, 'support': 180414}}
[[23292 16298   982]
 [26079 62883  8370]
 [13793 22103  6614]]
training model: results/AAL/W10/deepOF_L1/seq2seq
Epoch 1/50
1686/1686 - 49s - loss: 11.7502 - accuracy10: 0.4682 - accuracy20: 0.4818 - accuracy30: 0.4875 - accuracy50: 0.4938 - val_loss: 16.7356 - val_accuracy10: 0.6981 - val_accuracy20: 0.6572 - val_accuracy30: 0.6201 - val_accuracy50: 0.5547 - 49s/epoch - 29ms/step
Epoch 2/50
1686/1686 - 42s - loss: 11.5403 - accuracy10: 0.4764 - accuracy20: 0.4881 - accuracy30: 0.4972 - accuracy50: 0.5048 - val_loss: 15.3855 - val_accuracy10: 0.7042 - val_accuracy20: 0.6643 - val_accuracy30: 0.6284 - val_accuracy50: 0.5630 - 42s/epoch - 25ms/step
Epoch 3/50
1686/1686 - 43s - loss: 11.3795 - accuracy10: 0.5119 - accuracy20: 0.5137 - accuracy30: 0.5203 - accuracy50: 0.5248 - val_loss: 14.7887 - val_accuracy10: 0.7137 - val_accuracy20: 0.6740 - val_accuracy30: 0.6391 - val_accuracy50: 0.5722 - 43s/epoch - 25ms/step
Epoch 4/50
1686/1686 - 41s - loss: 11.2851 - accuracy10: 0.5303 - accuracy20: 0.5236 - accuracy30: 0.5260 - accuracy50: 0.5285 - val_loss: 14.6670 - val_accuracy10: 0.7124 - val_accuracy20: 0.6722 - val_accuracy30: 0.6369 - val_accuracy50: 0.5721 - 41s/epoch - 24ms/step
Epoch 5/50
1686/1686 - 43s - loss: 11.2071 - accuracy10: 0.5427 - accuracy20: 0.5295 - accuracy30: 0.5288 - accuracy50: 0.5290 - val_loss: 14.5020 - val_accuracy10: 0.7108 - val_accuracy20: 0.6719 - val_accuracy30: 0.6373 - val_accuracy50: 0.5738 - 43s/epoch - 26ms/step
Epoch 6/50
1686/1686 - 43s - loss: 11.1332 - accuracy10: 0.5458 - accuracy20: 0.5330 - accuracy30: 0.5306 - accuracy50: 0.5302 - val_loss: 14.5177 - val_accuracy10: 0.7133 - val_accuracy20: 0.6738 - val_accuracy30: 0.6388 - val_accuracy50: 0.5756 - 43s/epoch - 26ms/step
Epoch 7/50
1686/1686 - 43s - loss: 11.0521 - accuracy10: 0.5475 - accuracy20: 0.5377 - accuracy30: 0.5350 - accuracy50: 0.5331 - val_loss: 14.6037 - val_accuracy10: 0.7133 - val_accuracy20: 0.6736 - val_accuracy30: 0.6393 - val_accuracy50: 0.5765 - 43s/epoch - 25ms/step
Epoch 8/50
1686/1686 - 42s - loss: 10.9744 - accuracy10: 0.5520 - accuracy20: 0.5427 - accuracy30: 0.5389 - accuracy50: 0.5359 - val_loss: 14.5938 - val_accuracy10: 0.7115 - val_accuracy20: 0.6717 - val_accuracy30: 0.6384 - val_accuracy50: 0.5772 - 42s/epoch - 25ms/step
Epoch 9/50
1686/1686 - 42s - loss: 10.9055 - accuracy10: 0.5525 - accuracy20: 0.5447 - accuracy30: 0.5415 - accuracy50: 0.5395 - val_loss: 14.7088 - val_accuracy10: 0.7098 - val_accuracy20: 0.6697 - val_accuracy30: 0.6364 - val_accuracy50: 0.5762 - 42s/epoch - 25ms/step
Epoch 10/50
1686/1686 - 41s - loss: 10.8278 - accuracy10: 0.5579 - accuracy20: 0.5490 - accuracy30: 0.5456 - accuracy50: 0.5427 - val_loss: 14.6278 - val_accuracy10: 0.7050 - val_accuracy20: 0.6676 - val_accuracy30: 0.6368 - val_accuracy50: 0.5783 - 41s/epoch - 24ms/step
Epoch 11/50
1686/1686 - 43s - loss: 10.7617 - accuracy10: 0.5578 - accuracy20: 0.5498 - accuracy30: 0.5466 - accuracy50: 0.5443 - val_loss: 14.6642 - val_accuracy10: 0.7004 - val_accuracy20: 0.6620 - val_accuracy30: 0.6314 - val_accuracy50: 0.5767 - 43s/epoch - 25ms/step
Epoch 12/50
1686/1686 - 42s - loss: 10.7028 - accuracy10: 0.5615 - accuracy20: 0.5526 - accuracy30: 0.5491 - accuracy50: 0.5461 - val_loss: 14.5293 - val_accuracy10: 0.6935 - val_accuracy20: 0.6567 - val_accuracy30: 0.6287 - val_accuracy50: 0.5752 - 42s/epoch - 25ms/step
Epoch 13/50
1686/1686 - 40s - loss: 10.6452 - accuracy10: 0.5627 - accuracy20: 0.5534 - accuracy30: 0.5496 - accuracy50: 0.5471 - val_loss: 14.6405 - val_accuracy10: 0.6979 - val_accuracy20: 0.6597 - val_accuracy30: 0.6315 - val_accuracy50: 0.5776 - 40s/epoch - 24ms/step
Epoch 14/50
1686/1686 - 43s - loss: 10.5992 - accuracy10: 0.5633 - accuracy20: 0.5541 - accuracy30: 0.5500 - accuracy50: 0.5468 - val_loss: 14.6677 - val_accuracy10: 0.6867 - val_accuracy20: 0.6503 - val_accuracy30: 0.6243 - val_accuracy50: 0.5750 - 43s/epoch - 25ms/step
Epoch 15/50
1686/1686 - 42s - loss: 10.5565 - accuracy10: 0.5637 - accuracy20: 0.5549 - accuracy30: 0.5512 - accuracy50: 0.5486 - val_loss: 14.7109 - val_accuracy10: 0.6833 - val_accuracy20: 0.6486 - val_accuracy30: 0.6242 - val_accuracy50: 0.5752 - 42s/epoch - 25ms/step
testing model: results/AAL/W10/deepOF_L1/seq2seq
Evaluating performance on  test set...
10110/10110 - 91s - 91s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7634729
{'0': {'precision': 0.3545630402311516, 'recall': 0.34880519766545537, 'f1-score': 0.35166055181147166, 'support': 290592}, '1': {'precision': 0.8324245597314923, 'recall': 0.8043237250554324, 'f1-score': 0.8181329150413916, 'support': 2002440}, '2': {'precision': 0.31192685522659036, 'recall': 0.3883767589404333, 'f1-score': 0.3459789114568002, 'support': 295064}, 'accuracy': 0.7057566643586637, 'macro avg': {'precision': 0.49963815172974474, 'recall': 0.5138352272204404, 'f1-score': 0.5052574594365545, 'support': 2588096}, 'weighted avg': {'precision': 0.7194291880927751, 'recall': 0.7057566643586637, 'f1-score': 0.711927895641264, 'support': 2588096}}
[[ 101360  162579   26653]
 [ 165698 1610610  226132]
 [  18815  161653  114596]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8166816
{'0': {'precision': 0.4532881679984206, 'recall': 0.32917065956371155, 'f1-score': 0.3813853457244521, 'support': 397581}, '1': {'precision': 0.7595493233090526, 'recall': 0.8159532880505056, 'f1-score': 0.7867416573251471, 'support': 1790377}, '2': {'precision': 0.38998109288949045, 'recall': 0.3665035562730858, 'f1-score': 0.3778780113555109, 'support': 400138}, 'accuracy': 0.6716860580133039, 'macro avg': {'precision': 0.5342728613989879, 'recall': 0.503875834629101, 'f1-score': 0.5153350048017034, 'support': 2588096}, 'weighted avg': {'precision': 0.6553638877714298, 'recall': 0.6716860580133039, 'f1-score': 0.6612579622483362, 'support': 2588096}}
[[ 130872  231902   34807]
 [ 134923 1460864  194590]
 [  22922  230564  146652]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8604023
{'0': {'precision': 0.510454604814487, 'recall': 0.2967014430659458, 'f1-score': 0.37527469010688913, 'support': 474268}, '1': {'precision': 0.6976272452817373, 'recall': 0.8286433945300109, 'f1-score': 0.757512060532306, 'support': 1636091}, '2': {'precision': 0.43554020185599135, 'recall': 0.3364759271314552, 'f1-score': 0.37965215419715354, 'support': 477737}, 'accuracy': 0.6403158924553031, 'macro avg': {'precision': 0.5478740173174051, 'recall': 0.48727358824247063, 'f1-score': 0.5041463016121163, 'support': 2588096}, 'weighted avg': {'precision': 0.6149492179928703, 'recall': 0.6403158924553031, 'f1-score': 0.6177179372579922, 'support': 2588096}}
[[ 140716  294277   39275]
 [ 111302 1355736  169053]
 [  23650  293340  160747]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9404932
{'0': {'precision': 0.5684378966384526, 'recall': 0.24658124205160944, 'f1-score': 0.3439578678056463, 'support': 592101}, '1': {'precision': 0.595737808336341, 'recall': 0.8430518069815636, 'f1-score': 0.6981393672266919, 'support': 1397939}, '2': {'precision': 0.48421404530670986, 'recall': 0.28578260229811253, 'f1-score': 0.3594300062669028, 'support': 598056}, 'accuracy': 0.5778185971463191, 'macro avg': {'precision': 0.5494632500938345, 'recall': 0.45847188377709513, 'f1-score': 0.4671757470997469, 'support': 2588096}, 'weighted avg': {'precision': 0.5637213141109798, 'recall': 0.5778185971463191, 'f1-score': 0.538841417858945, 'support': 2588096}}
[[ 146001  398954   47146]
 [  84492 1178535  134912]
 [  26353  400789  170914]]
Evaluating performance on  train set...
1686/1686 - 16s - 16s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.71025085
{'0': {'precision': 0.34788679066685596, 'recall': 0.3449400502123466, 'f1-score': 0.34640715388149906, 'support': 42619}, '1': {'precision': 0.8568289384719405, 'recall': 0.8344008825330084, 'f1-score': 0.8454661969193314, 'support': 346276}, '2': {'precision': 0.32282708845208846, 'recall': 0.3941318459843922, 'f1-score': 0.35493367944537657, 'support': 42671}, 'accuracy': 0.742533007697548, 'macro avg': {'precision': 0.5091809391969616, 'recall': 0.524490926243249, 'f1-score': 0.5156023434154023, 'support': 431566}, 'weighted avg': {'precision': 0.7537693871182612, 'recall': 0.742533007697548, 'f1-score': 0.7476806660657412, 'support': 431566}}
[[ 14701  24744   3174]
 [ 25239 288933  32104]
 [  2318  23535  16818]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7626044
{'0': {'precision': 0.4355922352667674, 'recall': 0.3230461543766487, 'f1-score': 0.37097093529737857, 'support': 58001}, '1': {'precision': 0.7936873047073373, 'recall': 0.8419021303428892, 'f1-score': 0.8170840656459651, 'support': 315583}, '2': {'precision': 0.40065431157871256, 'recall': 0.3717360560173847, 'f1-score': 0.3856538347990231, 'support': 57982}, 'accuracy': 0.7090016359027356, 'macro avg': {'precision': 0.543311283850939, 'recall': 0.5122281135789741, 'f1-score': 0.5245696119141222, 'support': 431566}, 'weighted avg': {'precision': 0.6927555558434175, 'recall': 0.7090016359027356, 'f1-score': 0.6991642218252848, 'support': 431566}}
[[ 18737  35422   3842]
 [ 21492 265690  28401]
 [  2786  33642  21554]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8053023
{'0': {'precision': 0.4899281623143384, 'recall': 0.29056076918648166, 'f1-score': 0.3647813516443802, 'support': 69476}, '1': {'precision': 0.7393448355569253, 'recall': 0.8520434822700121, 'f1-score': 0.7917036228423279, 'support': 292809}, '2': {'precision': 0.4440098261526833, 'recall': 0.33915503529106106, 'f1-score': 0.3845631377811966, 'support': 69281}, 'accuracy': 0.6793167209650436, 'macro avg': {'precision': 0.5577609413413157, 'recall': 0.49391976224918493, 'f1-score': 0.5136827040893016, 'support': 431566}, 'weighted avg': {'precision': 0.6517809923052853, 'recall': 0.6793167209650436, 'f1-score': 0.6576153219584101, 'support': 431566}}
[[ 20187  45059   4230]
 [ 18130 249486  25193]
 [  2887  42897  23497]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.87917244
{'0': {'precision': 0.5467894215220906, 'recall': 0.23930736128391566, 'f1-score': 0.33291252808676525, 'support': 87607}, '1': {'precision': 0.6489107650627383, 'recall': 0.86581256841031, 'f1-score': 0.7418319685877677, 'support': 256723}, '2': {'precision': 0.4964884592621819, 'recall': 0.28849328258975654, 'f1-score': 0.36493482012093437, 'support': 87236}, 'accuracy': 0.6219349995134, 'macro avg': {'precision': 0.5640628819490036, 'recall': 0.46453773742799404, 'f1-score': 0.47989310559848913, 'support': 431566}, 'weighted avg': {'precision': 0.5973699652490763, 'recall': 0.6219349995134, 'f1-score': 0.5826368395284256, 'support': 431566}}
[[ 20965  61475   5167]
 [ 14093 222274  20356]
 [  3284  58785  25167]]
Evaluating performance on  val set...
705/705 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7654672
{'0': {'precision': 0.36738202891167293, 'recall': 0.27180212014134275, 'f1-score': 0.31244584055459274, 'support': 21225}, '1': {'precision': 0.8059742260820844, 'recall': 0.8386375064677632, 'f1-score': 0.821981507076811, 'support': 137219}, '2': {'precision': 0.33290775614427065, 'recall': 0.3323167956304051, 'f1-score': 0.33261201339377233, 'support': 21970}, 'accuracy': 0.710294101344685, 'macro avg': {'precision': 0.5020880037126759, 'recall': 0.48091880741317033, 'f1-score': 0.4890131203417254, 'support': 180414}, 'weighted avg': {'precision': 0.6967676804178025, 'recall': 0.710294101344685, 'f1-score': 0.702443431882256, 'support': 180414}}
[[  5769  14032   1424]
 [  8936 115077  13206]
 [   998  13671   7301]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8228183
{'0': {'precision': 0.45935975990996625, 'recall': 0.262252364804569, 'f1-score': 0.3338862505396623, 'support': 28015}, '1': {'precision': 0.735145078194927, 'recall': 0.8473517465475223, 'f1-score': 0.7872704149983584, 'support': 123100}, '2': {'precision': 0.4188451466867871, 'recall': 0.3220929041946824, 'f1-score': 0.36415203550067526, 'support': 29299}, 'accuracy': 0.6711951400667354, 'macro avg': {'precision': 0.5377833282638934, 'recall': 0.47723233851559127, 'f1-score': 0.495102900346232, 'support': 180414}, 'weighted avg': {'precision': 0.6409539545293015, 'recall': 0.6711951400667354, 'f1-score': 0.6481542556747306, 'support': 180414}}
[[  7347  18940   1728]
 [  7425 104309  11366]
 [  1222  18640   9437]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.86652607
{'0': {'precision': 0.5076549050528945, 'recall': 0.2340857445841539, 'f1-score': 0.3204213669542137, 'support': 33005}, '1': {'precision': 0.6768440187373278, 'recall': 0.8571643601526461, 'f1-score': 0.7564059991170875, 'support': 112941}, '2': {'precision': 0.4633431085043988, 'recall': 0.2979575258210514, 'f1-score': 0.3626860664277011, 'support': 34468}, 'accuracy': 0.636341969026794, 'macro avg': {'precision': 0.5492806774315403, 'recall': 0.46306921018595043, 'f1-score': 0.4798378108330008, 'support': 180414}, 'weighted avg': {'precision': 0.6051032665170826, 'recall': 0.636341969026794, 'f1-score': 0.6014268321761991, 'support': 180414}}
[[ 7726 23340  1939]
 [ 6176 96809  9956]
 [ 1317 22881 10270]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9422594
{'0': {'precision': 0.563329054343175, 'recall': 0.19447521973557869, 'f1-score': 0.28913413495854606, 'support': 40617}, '1': {'precision': 0.5831364309578755, 'recall': 0.8697854588796186, 'f1-score': 0.6981842475328777, 'support': 97324}, '2': {'precision': 0.517736844584727, 'recall': 0.2587526193110917, 'f1-score': 0.345054945054945, 'support': 42473}, 'accuracy': 0.5739022470539981, 'macro avg': {'precision': 0.5547341099619258, 'recall': 0.4410044326420963, 'f1-score': 0.44412444251545624, 'support': 180414}, 'weighted avg': {'precision': 0.5632808052969732, 'recall': 0.5739022470539981, 'f1-score': 0.5229603220804356, 'support': 180414}}
[[ 7899 30473  2245]
 [ 4681 84651  7992]
 [ 1442 30041 10990]]
training model: results/AAL/W10/deepLOB_L2/seq2seq
Epoch 1/50
1686/1686 - 91s - loss: 11.2806 - accuracy10: 0.4585 - accuracy20: 0.4756 - accuracy30: 0.4858 - accuracy50: 0.4978 - val_loss: 17.2999 - val_accuracy10: 0.5370 - val_accuracy20: 0.5093 - val_accuracy30: 0.4876 - val_accuracy50: 0.4560 - 91s/epoch - 54ms/step
Epoch 2/50
1686/1686 - 82s - loss: 11.0091 - accuracy10: 0.4603 - accuracy20: 0.4875 - accuracy30: 0.5054 - accuracy50: 0.5210 - val_loss: 16.1356 - val_accuracy10: 0.5532 - val_accuracy20: 0.5341 - val_accuracy30: 0.5197 - val_accuracy50: 0.4910 - 82s/epoch - 49ms/step
Epoch 3/50
1686/1686 - 84s - loss: 10.6842 - accuracy10: 0.4948 - accuracy20: 0.5178 - accuracy30: 0.5292 - accuracy50: 0.5396 - val_loss: 16.7097 - val_accuracy10: 0.4991 - val_accuracy20: 0.4975 - val_accuracy30: 0.4914 - val_accuracy50: 0.4767 - 84s/epoch - 50ms/step
Epoch 4/50
1686/1686 - 83s - loss: 10.1531 - accuracy10: 0.5768 - accuracy20: 0.5801 - accuracy30: 0.5765 - accuracy50: 0.5714 - val_loss: 16.2132 - val_accuracy10: 0.5753 - val_accuracy20: 0.5633 - val_accuracy30: 0.5496 - val_accuracy50: 0.5207 - 83s/epoch - 49ms/step
Epoch 5/50
1686/1686 - 82s - loss: 9.7587 - accuracy10: 0.6192 - accuracy20: 0.6133 - accuracy30: 0.6024 - accuracy50: 0.5884 - val_loss: 14.8875 - val_accuracy10: 0.4866 - val_accuracy20: 0.4993 - val_accuracy30: 0.5020 - val_accuracy50: 0.4938 - 82s/epoch - 48ms/step
Epoch 6/50
1686/1686 - 82s - loss: 9.3638 - accuracy10: 0.6525 - accuracy20: 0.6398 - accuracy30: 0.6231 - accuracy50: 0.6021 - val_loss: 16.4839 - val_accuracy10: 0.4081 - val_accuracy20: 0.4254 - val_accuracy30: 0.4322 - val_accuracy50: 0.4353 - 82s/epoch - 49ms/step
Epoch 7/50
1686/1686 - 82s - loss: 9.1465 - accuracy10: 0.6664 - accuracy20: 0.6511 - accuracy30: 0.6329 - accuracy50: 0.6101 - val_loss: 17.0368 - val_accuracy10: 0.4406 - val_accuracy20: 0.4520 - val_accuracy30: 0.4536 - val_accuracy50: 0.4500 - 82s/epoch - 49ms/step
Epoch 8/50
1686/1686 - 82s - loss: 9.0107 - accuracy10: 0.6719 - accuracy20: 0.6566 - accuracy30: 0.6374 - accuracy50: 0.6138 - val_loss: 17.3418 - val_accuracy10: 0.4200 - val_accuracy20: 0.4351 - val_accuracy30: 0.4387 - val_accuracy50: 0.4407 - 82s/epoch - 49ms/step
Epoch 9/50
1686/1686 - 82s - loss: 8.9164 - accuracy10: 0.6759 - accuracy20: 0.6595 - accuracy30: 0.6399 - accuracy50: 0.6163 - val_loss: 16.9646 - val_accuracy10: 0.4446 - val_accuracy20: 0.4579 - val_accuracy30: 0.4591 - val_accuracy50: 0.4547 - 82s/epoch - 49ms/step
Epoch 10/50
1686/1686 - 82s - loss: 8.8461 - accuracy10: 0.6778 - accuracy20: 0.6616 - accuracy30: 0.6419 - accuracy50: 0.6185 - val_loss: 17.3803 - val_accuracy10: 0.4399 - val_accuracy20: 0.4527 - val_accuracy30: 0.4545 - val_accuracy50: 0.4530 - 82s/epoch - 49ms/step
Epoch 11/50
1686/1686 - 82s - loss: 8.7776 - accuracy10: 0.6809 - accuracy20: 0.6640 - accuracy30: 0.6431 - accuracy50: 0.6191 - val_loss: 16.8455 - val_accuracy10: 0.4359 - val_accuracy20: 0.4479 - val_accuracy30: 0.4478 - val_accuracy50: 0.4463 - 82s/epoch - 49ms/step
Epoch 12/50
1686/1686 - 82s - loss: 8.7223 - accuracy10: 0.6817 - accuracy20: 0.6654 - accuracy30: 0.6451 - accuracy50: 0.6209 - val_loss: 17.6865 - val_accuracy10: 0.4316 - val_accuracy20: 0.4427 - val_accuracy30: 0.4424 - val_accuracy50: 0.4409 - 82s/epoch - 48ms/step
Epoch 13/50
1686/1686 - 82s - loss: 8.6731 - accuracy10: 0.6840 - accuracy20: 0.6672 - accuracy30: 0.6462 - accuracy50: 0.6221 - val_loss: 17.6184 - val_accuracy10: 0.4083 - val_accuracy20: 0.4224 - val_accuracy30: 0.4254 - val_accuracy50: 0.4301 - 82s/epoch - 49ms/step
Epoch 14/50
1686/1686 - 82s - loss: 8.6310 - accuracy10: 0.6857 - accuracy20: 0.6689 - accuracy30: 0.6469 - accuracy50: 0.6221 - val_loss: 17.0198 - val_accuracy10: 0.4045 - val_accuracy20: 0.4207 - val_accuracy30: 0.4246 - val_accuracy50: 0.4297 - 82s/epoch - 48ms/step
Epoch 15/50
1686/1686 - 82s - loss: 8.5967 - accuracy10: 0.6861 - accuracy20: 0.6690 - accuracy30: 0.6472 - accuracy50: 0.6228 - val_loss: 17.4168 - val_accuracy10: 0.4102 - val_accuracy20: 0.4251 - val_accuracy30: 0.4281 - val_accuracy50: 0.4325 - 82s/epoch - 49ms/step
testing model: results/AAL/W10/deepLOB_L2/seq2seq
Evaluating performance on  test set...
10110/10110 - 161s - 161s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7754152
{'0': {'precision': 0.281294314638487, 'recall': 0.7174280355821676, 'f1-score': 0.4041331958315241, 'support': 290595}, '1': {'precision': 0.8968968189838558, 'recall': 0.6790305826891193, 'f1-score': 0.7729040931201533, 'support': 2002440}, '2': {'precision': 0.3800777815046823, 'recall': 0.4262707326496445, 'f1-score': 0.401851138910499, 'support': 295066}, 'accuracy': 0.6545250745623915, 'macro avg': {'precision': 0.5194229717090083, 'recall': 0.6075764503069772, 'f1-score': 0.5262961426207254, 'support': 2588101}, 'weighted avg': {'precision': 0.768854391017145, 'recall': 0.6545250745623915, 'f1-score': 0.6891948059306598, 'support': 2588101}}
[[ 208481   56193   25921]
 [ 463494 1359718  179228]
 [  69174  100114  125778]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8036149
{'0': {'precision': 0.35990968314872723, 'recall': 0.670736246931466, 'f1-score': 0.46845276940197494, 'support': 397584}, '1': {'precision': 0.8341707634349788, 'recall': 0.695923260855116, 'f1-score': 0.7588015227613355, 'support': 1790377}, '2': {'precision': 0.45672806275583666, 'recall': 0.4034887789273754, 'f1-score': 0.42846091686050436, 'support': 400140}, 'accuracy': 0.6468414486142542, 'macro avg': {'precision': 0.5502695031131809, 'recall': 0.5900494289046524, 'f1-score': 0.551905069674605, 'support': 2588101}, 'weighted avg': {'precision': 0.7029592923238123, 'recall': 0.6468414486142542, 'f1-score': 0.6631249982359069, 'support': 2588101}}
[[ 266674   99071   31839]
 [ 384206 1245965  160206]
 [  90067  148621  161452]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.84150916
{'0': {'precision': 0.4037329473650101, 'recall': 0.6304918495965387, 'f1-score': 0.49225339302455556, 'support': 474271}, '1': {'precision': 0.7768308210595565, 'recall': 0.7044186417503672, 'f1-score': 0.7388547649530046, 'support': 1636091}, '2': {'precision': 0.4955835875450023, 'recall': 0.3774613334896251, 'f1-score': 0.42853153899257257, 'support': 477739}, 'accuracy': 0.6305182834827543, 'macro avg': {'precision': 0.5587157853231896, 'recall': 0.5707906082788436, 'f1-score': 0.5532132323233776, 'support': 2588101}, 'weighted avg': {'precision': 0.6565448377277637, 'recall': 0.6305182834827543, 'f1-score': 0.6363821848979804, 'support': 2588101}}
[[ 299024  139622   35625]
 [ 335681 1152493  147917]
 [ 105943  191468  180328]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.92201656
{'0': {'precision': 0.4529126088156855, 'recall': 0.5624484887789983, 'f1-score': 0.5017722522180462, 'support': 592104}, '1': {'precision': 0.6739154058769731, 'recall': 0.7142200053078138, 'f1-score': 0.6934825822959947, 'support': 1397939}, '2': {'precision': 0.5316159061340918, 'recall': 0.3300081263021312, 'f1-score': 0.4072253384104792, 'support': 598058}, 'accuracy': 0.5907141954660966, 'macro avg': {'precision': 0.5528146402755835, 'recall': 0.5355588734629811, 'f1-score': 0.5341600576415066, 'support': 2588101}, 'weighted avg': {'precision': 0.5904719875681804, 'recall': 0.5907141954660966, 'f1-score': 0.5834749403824229, 'support': 2588101}}
[[333028 214914  44162]
 [269776 998436 129727]
 [132499 268195 197364]]
Evaluating performance on  train set...
1686/1686 - 28s - 28s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0083886
{'0': {'precision': 0.19445749709853652, 'recall': 0.8056102823904682, 'f1-score': 0.31329268348299594, 'support': 42636}, '1': {'precision': 0.9273283300644589, 'recall': 0.4955162776731993, 'f1-score': 0.6458980549184014, 'support': 346364}, '2': {'precision': 0.2967761330775618, 'recall': 0.48700902086074044, 'f1-score': 0.3688068171710163, 'support': 42568}, 'accuracy': 0.5253123493864235, 'macro avg': {'precision': 0.4728539867468524, 'recall': 0.5960451936414694, 'f1-score': 0.44266585185747126, 'support': 431568}, 'weighted avg': {'precision': 0.792730707544547, 'recall': 0.5253123493864235, 'f1-score': 0.5857078127666416, 'support': 431568}}
[[ 34348   4254   4034]
 [129646 171629  45089]
 [ 12641   9196  20731]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0057331
{'0': {'precision': 0.25749497124401505, 'recall': 0.7827075439200827, 'f1-score': 0.3875077277281545, 'support': 58060}, '1': {'precision': 0.880939401448198, 'recall': 0.5069153773277018, 'f1-score': 0.6435280346576672, 'support': 315601}, '2': {'precision': 0.36492555594871934, 'recall': 0.46305282608320236, 'f1-score': 0.4081744491380294, 'support': 57907}, 'accuracy': 0.5381330404478553, 'macro avg': {'precision': 0.5011199762136441, 'recall': 0.5842252491103289, 'f1-score': 0.47973673717461707, 'support': 431568}, 'weighted avg': {'precision': 0.7278279627664765, 'recall': 0.5381330404478553, 'f1-score': 0.5775056254498178, 'support': 431568}}
[[ 45444   7748   4868]
 [113822 159983  41796]
 [ 17219  13874  26814]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0073284
{'0': {'precision': 0.29868489612831606, 'recall': 0.7583692838654013, 'f1-score': 0.4285749114195625, 'support': 69540}, '1': {'precision': 0.8372783367613542, 'recall': 0.5144004672083278, 'f1-score': 0.637276202524683, 'support': 292803}, '2': {'precision': 0.4038927496871422, 'recall': 0.4382520765619357, 'f1-score': 0.4203714865698114, 'support': 69225}, 'accuracy': 0.5414975160345531, 'macro avg': {'precision': 0.5132853275256042, 'recall': 0.5703406092118882, 'f1-score': 0.49540753350468564, 'support': 431568}, 'weighted avg': {'precision': 0.6809764211261964, 'recall': 0.5414975160345531, 'f1-score': 0.5688551964597613, 'support': 431568}}
[[ 52737  11300   5503]
 [102912 150618  39273]
 [ 20915  17972  30338]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0200387
{'0': {'precision': 0.3523875062559716, 'recall': 0.7065269447421834, 'f1-score': 0.4702386825029408, 'support': 87698}, '1': {'precision': 0.7520420492319, 'recall': 0.5262571399627514, 'f1-score': 0.6192094954074815, 'support': 256654}, '2': {'precision': 0.44582791546816924, 'recall': 0.38919464318473673, 'f1-score': 0.415590775804546, 'support': 87216}, 'accuracy': 0.5351902828754681, 'macro avg': {'precision': 0.5167524903186803, 'recall': 0.5406595759632239, 'f1-score': 0.5016796512383228, 'support': 431568}, 'weighted avg': {'precision': 0.6089459994778855, 'recall': 0.5351902828754681, 'f1-score': 0.5477879521072553, 'support': 431568}}
[[ 61961  18671   7066]
 [ 86461 135066  35127]
 [ 27410  25862  33944]]
Evaluating performance on  val set...
705/705 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.134957
{'0': {'precision': 0.1997435150102011, 'recall': 0.8071704513332705, 'f1-score': 0.32023999775703027, 'support': 21226}, '1': {'precision': 0.8975620127569099, 'recall': 0.46177013220934726, 'f1-score': 0.6098102378166516, 'support': 137131}, '2': {'precision': 0.3010502719083399, 'recall': 0.32878451285306254, 'f1-score': 0.31430676548346553, 'support': 22057}, 'accuracy': 0.4861485250590309, 'macro avg': {'precision': 0.466118599891817, 'recall': 0.5325750321318935, 'f1-score': 0.4147856670190491, 'support': 180414}, 'weighted avg': {'precision': 0.7425343824118783, 'recall': 0.4861485250590309, 'f1-score': 0.5396142552168611, 'support': 180414}}
[[17133  2543  1550]
 [58521 63323 15287]
 [10121  4684  7252]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1387897
{'0': {'precision': 0.256528794405725, 'recall': 0.7841695810434659, 'f1-score': 0.38659054723304687, 'support': 28022}, '1': {'precision': 0.8420954189686924, 'recall': 0.4758107130372574, 'f1-score': 0.6080524432116272, 'support': 123009}, '2': {'precision': 0.3744010138212348, 'recall': 0.3217506721573699, 'f1-score': 0.3460848555844346, 'support': 29383}, 'accuracy': 0.49861429822519315, 'macro avg': {'precision': 0.4910084090652174, 'recall': 0.5272436554126978, 'f1-score': 0.4469092820097029, 'support': 180414}, 'weighted avg': {'precision': 0.6749741719482216, 'recall': 0.49861429822519315, 'f1-score': 0.5309896937777607, 'support': 180414}}
[[21974  4205  1843]
 [50526 58529 13954]
 [13159  6770  9454]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1415365
{'0': {'precision': 0.2932264959760784, 'recall': 0.7613501956145937, 'f1-score': 0.423388932926315, 'support': 32973}, '1': {'precision': 0.7912998146431881, 'recall': 0.48391781792419414, 'f1-score': 0.6005627115663604, 'support': 112920}, '2': {'precision': 0.41390561274033794, 'recall': 0.3086816720257235, 'f1-score': 0.35363223044502706, 'support': 34521}, 'accuracy': 0.5010919329985478, 'macro avg': {'precision': 0.4994773077865349, 'recall': 0.5179832285215038, 'f1-score': 0.4591946249792342, 'support': 180414}, 'weighted avg': {'precision': 0.6280586206100262, 'recall': 0.5010919329985478, 'f1-score': 0.5209334248043144, 'support': 180414}}
[[25104  5849  2020]
 [45207 54644 13069]
 [15302  8563 10656]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1516916
{'0': {'precision': 0.339717907265528, 'recall': 0.7147540175490487, 'f1-score': 0.46054282401893054, 'support': 40572}, '1': {'precision': 0.6954674631713258, 'recall': 0.4927978465458431, 'f1-score': 0.5768490679494888, 'support': 97332}, '2': {'precision': 0.4602054899555283, 'recall': 0.28238061632557043, 'f1-score': 0.3500014578534565, 'support': 42510}, 'accuracy': 0.49313246200405736, 'macro avg': {'precision': 0.4984636201307941, 'recall': 0.49664416014015406, 'f1-score': 0.46246444994062524, 'support': 180414}, 'weighted avg': {'precision': 0.5600319788762401, 'recall': 0.49313246200405736, 'f1-score': 0.49724289085717366, 'support': 180414}}
[[28999  9121  2452]
 [37739 47965 11628]
 [18624 11882 12004]]
training model: results/AAL/W10/deepOF_L2/seq2seq
Epoch 1/50
1686/1686 - 58s - loss: 10.3175 - accuracy10: 0.5705 - accuracy20: 0.5742 - accuracy30: 0.5697 - accuracy50: 0.5613 - val_loss: 13.1017 - val_accuracy10: 0.7184 - val_accuracy20: 0.7016 - val_accuracy30: 0.6778 - val_accuracy50: 0.6238 - 58s/epoch - 34ms/step
Epoch 2/50
1686/1686 - 51s - loss: 9.3361 - accuracy10: 0.6451 - accuracy20: 0.6357 - accuracy30: 0.6225 - accuracy50: 0.6059 - val_loss: 13.4297 - val_accuracy10: 0.7279 - val_accuracy20: 0.7100 - val_accuracy30: 0.6842 - val_accuracy50: 0.6298 - 51s/epoch - 30ms/step
Epoch 3/50
1686/1686 - 51s - loss: 9.1064 - accuracy10: 0.6567 - accuracy20: 0.6431 - accuracy30: 0.6282 - accuracy50: 0.6107 - val_loss: 13.2392 - val_accuracy10: 0.7266 - val_accuracy20: 0.7110 - val_accuracy30: 0.6871 - val_accuracy50: 0.6346 - 51s/epoch - 30ms/step
Epoch 4/50
1686/1686 - 51s - loss: 8.9935 - accuracy10: 0.6614 - accuracy20: 0.6478 - accuracy30: 0.6312 - accuracy50: 0.6121 - val_loss: 13.0914 - val_accuracy10: 0.7077 - val_accuracy20: 0.6965 - val_accuracy30: 0.6753 - val_accuracy50: 0.6274 - 51s/epoch - 30ms/step
Epoch 5/50
1686/1686 - 50s - loss: 8.9042 - accuracy10: 0.6641 - accuracy20: 0.6506 - accuracy30: 0.6334 - accuracy50: 0.6138 - val_loss: 13.0279 - val_accuracy10: 0.7178 - val_accuracy20: 0.7044 - val_accuracy30: 0.6824 - val_accuracy50: 0.6321 - 50s/epoch - 30ms/step
Epoch 6/50
1686/1686 - 50s - loss: 8.8401 - accuracy10: 0.6678 - accuracy20: 0.6545 - accuracy30: 0.6358 - accuracy50: 0.6146 - val_loss: 13.1662 - val_accuracy10: 0.7301 - val_accuracy20: 0.7150 - val_accuracy30: 0.6901 - val_accuracy50: 0.6364 - 50s/epoch - 30ms/step
Epoch 7/50
1686/1686 - 52s - loss: 8.7969 - accuracy10: 0.6700 - accuracy20: 0.6563 - accuracy30: 0.6371 - accuracy50: 0.6153 - val_loss: 13.0286 - val_accuracy10: 0.7282 - val_accuracy20: 0.7121 - val_accuracy30: 0.6865 - val_accuracy50: 0.6337 - 52s/epoch - 31ms/step
Epoch 8/50
1686/1686 - 51s - loss: 8.7484 - accuracy10: 0.6714 - accuracy20: 0.6591 - accuracy30: 0.6393 - accuracy50: 0.6161 - val_loss: 12.9791 - val_accuracy10: 0.7283 - val_accuracy20: 0.7122 - val_accuracy30: 0.6866 - val_accuracy50: 0.6338 - 51s/epoch - 30ms/step
Epoch 9/50
1686/1686 - 51s - loss: 8.7090 - accuracy10: 0.6725 - accuracy20: 0.6603 - accuracy30: 0.6402 - accuracy50: 0.6166 - val_loss: 13.2111 - val_accuracy10: 0.7225 - val_accuracy20: 0.7064 - val_accuracy30: 0.6817 - val_accuracy50: 0.6314 - 51s/epoch - 30ms/step
Epoch 10/50
1686/1686 - 51s - loss: 8.6775 - accuracy10: 0.6735 - accuracy20: 0.6618 - accuracy30: 0.6411 - accuracy50: 0.6177 - val_loss: 13.1304 - val_accuracy10: 0.7309 - val_accuracy20: 0.7126 - val_accuracy30: 0.6865 - val_accuracy50: 0.6332 - 51s/epoch - 30ms/step
Epoch 11/50
1686/1686 - 51s - loss: 8.6598 - accuracy10: 0.6744 - accuracy20: 0.6626 - accuracy30: 0.6418 - accuracy50: 0.6170 - val_loss: 13.0525 - val_accuracy10: 0.7221 - val_accuracy20: 0.7066 - val_accuracy30: 0.6813 - val_accuracy50: 0.6306 - 51s/epoch - 30ms/step
Epoch 12/50
1686/1686 - 50s - loss: 8.6173 - accuracy10: 0.6757 - accuracy20: 0.6645 - accuracy30: 0.6440 - accuracy50: 0.6190 - val_loss: 12.8929 - val_accuracy10: 0.7230 - val_accuracy20: 0.7072 - val_accuracy30: 0.6822 - val_accuracy50: 0.6313 - 50s/epoch - 30ms/step
Epoch 13/50
1686/1686 - 53s - loss: 8.5809 - accuracy10: 0.6769 - accuracy20: 0.6657 - accuracy30: 0.6445 - accuracy50: 0.6194 - val_loss: 13.0639 - val_accuracy10: 0.7227 - val_accuracy20: 0.7054 - val_accuracy30: 0.6799 - val_accuracy50: 0.6293 - 53s/epoch - 31ms/step
Epoch 14/50
1686/1686 - 50s - loss: 8.5460 - accuracy10: 0.6770 - accuracy20: 0.6675 - accuracy30: 0.6457 - accuracy50: 0.6211 - val_loss: 13.0628 - val_accuracy10: 0.7185 - val_accuracy20: 0.7011 - val_accuracy30: 0.6751 - val_accuracy50: 0.6253 - 50s/epoch - 30ms/step
Epoch 15/50
1686/1686 - 49s - loss: 8.5218 - accuracy10: 0.6785 - accuracy20: 0.6676 - accuracy30: 0.6463 - accuracy50: 0.6213 - val_loss: 13.1569 - val_accuracy10: 0.7065 - val_accuracy20: 0.6921 - val_accuracy30: 0.6683 - val_accuracy50: 0.6220 - 49s/epoch - 29ms/step
Epoch 16/50
1686/1686 - 52s - loss: 8.4950 - accuracy10: 0.6784 - accuracy20: 0.6684 - accuracy30: 0.6477 - accuracy50: 0.6224 - val_loss: 13.3683 - val_accuracy10: 0.7107 - val_accuracy20: 0.6947 - val_accuracy30: 0.6707 - val_accuracy50: 0.6227 - 52s/epoch - 31ms/step
Epoch 17/50
1686/1686 - 51s - loss: 8.4665 - accuracy10: 0.6793 - accuracy20: 0.6695 - accuracy30: 0.6487 - accuracy50: 0.6227 - val_loss: 13.4055 - val_accuracy10: 0.7180 - val_accuracy20: 0.7006 - val_accuracy30: 0.6754 - val_accuracy50: 0.6260 - 51s/epoch - 30ms/step
Epoch 18/50
1686/1686 - 51s - loss: 8.4354 - accuracy10: 0.6793 - accuracy20: 0.6698 - accuracy30: 0.6489 - accuracy50: 0.6232 - val_loss: 13.1425 - val_accuracy10: 0.7123 - val_accuracy20: 0.6964 - val_accuracy30: 0.6721 - val_accuracy50: 0.6239 - 51s/epoch - 30ms/step
Epoch 19/50
1686/1686 - 50s - loss: 8.4091 - accuracy10: 0.6801 - accuracy20: 0.6703 - accuracy30: 0.6498 - accuracy50: 0.6236 - val_loss: 13.0625 - val_accuracy10: 0.7033 - val_accuracy20: 0.6894 - val_accuracy30: 0.6658 - val_accuracy50: 0.6200 - 50s/epoch - 29ms/step
Epoch 20/50
1686/1686 - 50s - loss: 8.3734 - accuracy10: 0.6808 - accuracy20: 0.6710 - accuracy30: 0.6503 - accuracy50: 0.6241 - val_loss: 13.1624 - val_accuracy10: 0.7032 - val_accuracy20: 0.6884 - val_accuracy30: 0.6649 - val_accuracy50: 0.6181 - 50s/epoch - 30ms/step
Epoch 21/50
1686/1686 - 50s - loss: 8.3369 - accuracy10: 0.6818 - accuracy20: 0.6726 - accuracy30: 0.6518 - accuracy50: 0.6261 - val_loss: 13.2823 - val_accuracy10: 0.7020 - val_accuracy20: 0.6867 - val_accuracy30: 0.6623 - val_accuracy50: 0.6165 - 50s/epoch - 30ms/step
Epoch 22/50
1686/1686 - 49s - loss: 8.3197 - accuracy10: 0.6815 - accuracy20: 0.6724 - accuracy30: 0.6518 - accuracy50: 0.6256 - val_loss: 13.4030 - val_accuracy10: 0.6993 - val_accuracy20: 0.6835 - val_accuracy30: 0.6596 - val_accuracy50: 0.6137 - 49s/epoch - 29ms/step
testing model: results/AAL/W10/deepOF_L2/seq2seq
Evaluating performance on  test set...
10110/10110 - 99s - 99s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6085112
{'0': {'precision': 0.4505248486432336, 'recall': 0.5339238519986785, 'f1-score': 0.48869171639287723, 'support': 290592}, '1': {'precision': 0.8910078927991664, 'recall': 0.826691436447534, 'f1-score': 0.8576455520970196, 'support': 2002440}, '2': {'precision': 0.39905395072768035, 'recall': 0.5217884933438169, 'f1-score': 0.45224188145030175, 'support': 295064}, 'accuracy': 0.7590580102129133, 'macro avg': {'precision': 0.5801955640566935, 'recall': 0.6274679272633431, 'f1-score': 0.5995263833133996, 'support': 2588096}, 'weighted avg': {'precision': 0.7854636059061216, 'recall': 0.7590580102129133, 'f1-score': 0.7700000158801864, 'support': 2588096}}
[[ 155154  101307   34131]
 [ 149317 1655400  197723]
 [  39914  101189  153961]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.67764145
{'0': {'precision': 0.5409527035280791, 'recall': 0.49008629688038413, 'f1-score': 0.5142647507116209, 'support': 397581}, '1': {'precision': 0.8240972503757297, 'recall': 0.841312192906857, 'f1-score': 0.8326157482517328, 'support': 1790377}, '2': {'precision': 0.47811048102708414, 'recall': 0.4780925580674667, 'f1-score': 0.4781015193793025, 'support': 400138}, 'accuracy': 0.7312008519003932, 'macro avg': {'precision': 0.614386811643631, 'recall': 0.6031636826182359, 'f1-score': 0.6083273394475521, 'support': 2588096}, 'weighted avg': {'precision': 0.727108828773956, 'recall': 0.7312008519003932, 'f1-score': 0.7289005373532376, 'support': 2588096}}
[[ 194849  160875   41857]
 [ 117148 1506266  166963]
 [  48199  160636  191303]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.74826366
{'0': {'precision': 0.5720868536847825, 'recall': 0.45287052889927215, 'f1-score': 0.5055454605368458, 'support': 474268}, '1': {'precision': 0.7646107043760239, 'recall': 0.8387724154707776, 'f1-score': 0.7999764491290987, 'support': 1636091}, '2': {'precision': 0.5086867043170288, 'recall': 0.44495192961817903, 'f1-score': 0.4746895157193309, 'support': 477737}, 'accuracy': 0.6953606048616434, 'macro avg': {'precision': 0.6151280874592784, 'recall': 0.5788649579960762, 'f1-score': 0.5934038084617584, 'support': 2588096}, 'weighted avg': {'precision': 0.6820897060684581, 'recall': 0.6953606048616434, 'f1-score': 0.6859772776130295, 'support': 2588096}}
[[ 214782  210841   48645]
 [ 107118 1372308  156665]
 [  53536  211631  212570]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8746713
{'0': {'precision': 0.5948883816620436, 'recall': 0.3926357158660431, 'f1-score': 0.47305058414055584, 'support': 592101}, '1': {'precision': 0.6590927069842712, 'recall': 0.8343912001882772, 'f1-score': 0.736454075165886, 'support': 1397939}, '2': {'precision': 0.5341642653992965, 'recall': 0.38187561031074013, 'f1-score': 0.44536119063033835, 'support': 598056}, 'accuracy': 0.6287599068968075, 'macro avg': {'precision': 0.596048451348537, 'recall': 0.5363008421216868, 'f1-score': 0.5516219499789267, 'support': 2588096}, 'weighted avg': {'precision': 0.615535725601757, 'recall': 0.6287599068968075, 'f1-score': 0.6089273850456661, 'support': 2588096}}
[[ 232480  298114   61507]
 [  93849 1166428  137662]
 [  64467  305206  228383]]
Evaluating performance on  train set...
1686/1686 - 17s - 17s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5592704
{'0': {'precision': 0.4460935529557845, 'recall': 0.5395011614538117, 'f1-score': 0.4883711051167137, 'support': 42619}, '1': {'precision': 0.9112101845828071, 'recall': 0.8251510355901073, 'f1-score': 0.866047938313066, 'support': 346276}, '2': {'precision': 0.36736843689334997, 'recall': 0.5720981462820183, 'f1-score': 0.4474258169754953, 'support': 42671}, 'accuracy': 0.7719213283715585, 'macro avg': {'precision': 0.5748907248106473, 'recall': 0.6455834477753124, 'f1-score': 0.600614953468425, 'support': 431566}, 'weighted avg': {'precision': 0.8115056737108458, 'recall': 0.7719213283715585, 'f1-score': 0.7873595488347689, 'support': 431566}}
[[ 22993  14901   4725]
 [ 23232 285730  37314]
 [  5318  12941  24412]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.61359674
{'0': {'precision': 0.5329678443533798, 'recall': 0.49780176203858556, 'f1-score': 0.5147849342545131, 'support': 58001}, '1': {'precision': 0.856375129325303, 'recall': 0.8366958929980386, 'f1-score': 0.8464211413752537, 'support': 315583}, '2': {'precision': 0.4467499746600831, 'recall': 0.5321134145079507, 'f1-score': 0.4857095629038986, 'support': 57982}, 'accuracy': 0.7502282385544737, 'macro avg': {'precision': 0.6120309827795887, 'recall': 0.6222036898481916, 'f1-score': 0.6156385461778885, 'support': 431566}, 'weighted avg': {'precision': 0.7578761010110816, 'recall': 0.7502282385544737, 'f1-score': 0.7533878384919491, 'support': 431566}}
[[ 28873  23533   5595]
 [ 18923 264047  32613]
 [  6378  20751  30853]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6763829
{'0': {'precision': 0.5659867549668874, 'recall': 0.4612959871034602, 'f1-score': 0.5083068334113131, 'support': 69476}, '1': {'precision': 0.8067021287133617, 'recall': 0.8343903363626118, 'f1-score': 0.8203126573863293, 'support': 292809}, '2': {'precision': 0.4791903665270109, 'recall': 0.4985638198062961, 'f1-score': 0.4886851580682357, 'support': 69281}, 'accuracy': 0.720415880769106, 'macro avg': {'precision': 0.6172930834024201, 'recall': 0.5980833810907894, 'f1-score': 0.605768216288626, 'support': 431566}, 'weighted avg': {'precision': 0.7153736095472489, 'recall': 0.720415880769106, 'f1-score': 0.716846672098459, 'support': 431566}}
[[ 32049  30916   6511]
 [ 17462 244317  31030]
 [  7114  27626  34541]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7889217
{'0': {'precision': 0.590576821967063, 'recall': 0.39746823883936216, 'f1-score': 0.4751514655313575, 'support': 87607}, '1': {'precision': 0.7152707449706377, 'recall': 0.8335988594711031, 'f1-score': 0.7699148792263579, 'support': 256723}, '2': {'precision': 0.5149566828311448, 'recall': 0.43335320280618095, 'f1-score': 0.47064389223644243, 'support': 87236}, 'accuracy': 0.6641602906623784, 'macro avg': {'precision': 0.6069347499229485, 'recall': 0.554806767038882, 'f1-score': 0.571903412331386, 'support': 431566}, 'weighted avg': {'precision': 0.6494670022351697, 'recall': 0.6641602906623784, 'f1-score': 0.6495844032281789, 'support': 431566}}
[[ 34821  44416   8370]
 [ 15481 214004  27238]
 [  8659  40773  37804]]
Evaluating performance on  val set...
705/705 - 8s - 8s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6840149
{'0': {'precision': 0.3996339851560647, 'recall': 0.5555712603062426, 'f1-score': 0.46487424111014747, 'support': 21225}, '1': {'precision': 0.9011465548515554, 'recall': 0.7784053228780271, 'f1-score': 0.835290989567856, 'support': 137219}, '2': {'precision': 0.3597195626660078, 'recall': 0.5301319981793354, 'f1-score': 0.4286082284536689, 'support': 21970}, 'accuracy': 0.7219561674814593, 'macro avg': {'precision': 0.5535000342245425, 'recall': 0.6213695271212017, 'f1-score': 0.5762578197105575, 'support': 180414}, 'weighted avg': {'precision': 0.776213039103868, 'recall': 0.7219561674814593, 'f1-score': 0.7421889257164168, 'support': 180414}}
[[ 11792   5965   3468]
 [ 13144 106812  17263]
 [  4571   5752  11647]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.724813
{'0': {'precision': 0.4741312491926108, 'recall': 0.5240406924861681, 'f1-score': 0.4978382136014514, 'support': 28015}, '1': {'precision': 0.8439241725727654, 'recall': 0.797059301380991, 'f1-score': 0.8198225297037147, 'support': 123100}, '2': {'precision': 0.4398541553667209, 'recall': 0.49820812997030617, 'f1-score': 0.46721613187164923, 'support': 29299}, 'accuracy': 0.7061314532131653, 'macro avg': {'precision': 0.5859698590440323, 'recall': 0.6064360412791551, 'f1-score': 0.5949589583922718, 'support': 180414}, 'weighted avg': {'precision': 0.7208816360588866, 'recall': 0.7061314532131653, 'f1-score': 0.7125614221084805, 'support': 180414}}
[[14681  9278  4056]
 [10449 98118 14533]
 [ 5834  8868 14597]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.77171004
{'0': {'precision': 0.506482982171799, 'recall': 0.49234964399333436, 'f1-score': 0.49931632073007726, 'support': 33005}, '1': {'precision': 0.7917716131183796, 'recall': 0.7988241648294242, 'f1-score': 0.7952822537992313, 'support': 112941}, '2': {'precision': 0.47538027513596837, 'recall': 0.4742079610073111, 'f1-score': 0.4747933944314534, 'support': 34468}, 'accuracy': 0.6807398538916049, 'macro avg': {'precision': 0.5912116234753823, 'recall': 0.5884605899433566, 'f1-score': 0.5897973229869207, 'support': 180414}, 'weighted avg': {'precision': 0.6791344125576158, 'recall': 0.6807398538916049, 'f1-score': 0.6799089145592833, 'support': 180414}}
[[16250 12178  4577]
 [ 9260 90220 13461]
 [ 6574 11549 16345]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.86043054
{'0': {'precision': 0.5309673760558756, 'recall': 0.43796932318979737, 'f1-score': 0.4800053966540745, 'support': 40617}, '1': {'precision': 0.6962968243219161, 'recall': 0.8029263080021372, 'f1-score': 0.7458196533557303, 'support': 97324}, '2': {'precision': 0.5127872444713548, 'recall': 0.41873660913992417, 'f1-score': 0.4610140494582404, 'support': 42473}, 'accuracy': 0.6303169377099338, 'macro avg': {'precision': 0.5800171482830488, 'recall': 0.5532107467772862, 'f1-score': 0.5622796998226817, 'support': 180414}, 'weighted avg': {'precision': 0.6158740822663403, 'recall': 0.6303169377099338, 'f1-score': 0.6189274716027109, 'support': 180414}}
[[17789 17370  5458]
 [ 7740 78144 11440]
 [ 7974 16714 17785]]
training model: results/AAL/W10/deepVOL_L2/seq2seq
Epoch 1/50
1686/1686 - 57s - loss: 10.7940 - accuracy10: 0.5416 - accuracy20: 0.5491 - accuracy30: 0.5474 - accuracy50: 0.5419 - val_loss: 13.4405 - val_accuracy10: 0.6232 - val_accuracy20: 0.6244 - val_accuracy30: 0.6147 - val_accuracy50: 0.5812 - 57s/epoch - 34ms/step
Epoch 2/50
1686/1686 - 48s - loss: 10.2812 - accuracy10: 0.5943 - accuracy20: 0.5931 - accuracy30: 0.5867 - accuracy50: 0.5746 - val_loss: 13.1593 - val_accuracy10: 0.6074 - val_accuracy20: 0.6152 - val_accuracy30: 0.6108 - val_accuracy50: 0.5836 - 48s/epoch - 29ms/step
Epoch 3/50
1686/1686 - 48s - loss: 9.9961 - accuracy10: 0.6186 - accuracy20: 0.6089 - accuracy30: 0.5982 - accuracy50: 0.5833 - val_loss: 12.9187 - val_accuracy10: 0.6485 - val_accuracy20: 0.6425 - val_accuracy30: 0.6294 - val_accuracy50: 0.5942 - 48s/epoch - 28ms/step
Epoch 4/50
1686/1686 - 48s - loss: 9.6939 - accuracy10: 0.6416 - accuracy20: 0.6224 - accuracy30: 0.6035 - accuracy50: 0.5835 - val_loss: 12.9637 - val_accuracy10: 0.6622 - val_accuracy20: 0.6482 - val_accuracy30: 0.6305 - val_accuracy50: 0.5923 - 48s/epoch - 29ms/step
Epoch 5/50
1686/1686 - 49s - loss: 9.4918 - accuracy10: 0.6539 - accuracy20: 0.6328 - accuracy30: 0.6100 - accuracy50: 0.5864 - val_loss: 12.6066 - val_accuracy10: 0.6857 - val_accuracy20: 0.6688 - val_accuracy30: 0.6484 - val_accuracy50: 0.6067 - 49s/epoch - 29ms/step
Epoch 6/50
1686/1686 - 49s - loss: 9.3583 - accuracy10: 0.6593 - accuracy20: 0.6400 - accuracy30: 0.6164 - accuracy50: 0.5918 - val_loss: 12.6394 - val_accuracy10: 0.6703 - val_accuracy20: 0.6613 - val_accuracy30: 0.6439 - val_accuracy50: 0.6036 - 49s/epoch - 29ms/step
Epoch 7/50
1686/1686 - 49s - loss: 9.2609 - accuracy10: 0.6639 - accuracy20: 0.6452 - accuracy30: 0.6224 - accuracy50: 0.5969 - val_loss: 13.0909 - val_accuracy10: 0.6903 - val_accuracy20: 0.6768 - val_accuracy30: 0.6560 - val_accuracy50: 0.6107 - 49s/epoch - 29ms/step
Epoch 8/50
1686/1686 - 49s - loss: 9.1740 - accuracy10: 0.6666 - accuracy20: 0.6489 - accuracy30: 0.6255 - accuracy50: 0.5998 - val_loss: 12.9507 - val_accuracy10: 0.7103 - val_accuracy20: 0.6928 - val_accuracy30: 0.6688 - val_accuracy50: 0.6196 - 49s/epoch - 29ms/step
Epoch 9/50
1686/1686 - 48s - loss: 9.1009 - accuracy10: 0.6722 - accuracy20: 0.6540 - accuracy30: 0.6303 - accuracy50: 0.6034 - val_loss: 13.1864 - val_accuracy10: 0.6929 - val_accuracy20: 0.6784 - val_accuracy30: 0.6575 - val_accuracy50: 0.6121 - 48s/epoch - 28ms/step
Epoch 10/50
1686/1686 - 47s - loss: 9.0429 - accuracy10: 0.6730 - accuracy20: 0.6561 - accuracy30: 0.6323 - accuracy50: 0.6052 - val_loss: 13.2036 - val_accuracy10: 0.6962 - val_accuracy20: 0.6812 - val_accuracy30: 0.6606 - val_accuracy50: 0.6150 - 47s/epoch - 28ms/step
Epoch 11/50
1686/1686 - 47s - loss: 8.9839 - accuracy10: 0.6769 - accuracy20: 0.6588 - accuracy30: 0.6352 - accuracy50: 0.6069 - val_loss: 12.8089 - val_accuracy10: 0.6857 - val_accuracy20: 0.6749 - val_accuracy30: 0.6569 - val_accuracy50: 0.6142 - 47s/epoch - 28ms/step
Epoch 12/50
1686/1686 - 47s - loss: 8.9403 - accuracy10: 0.6782 - accuracy20: 0.6600 - accuracy30: 0.6361 - accuracy50: 0.6084 - val_loss: 13.0219 - val_accuracy10: 0.6820 - val_accuracy20: 0.6704 - val_accuracy30: 0.6524 - val_accuracy50: 0.6106 - 47s/epoch - 28ms/step
Epoch 13/50
1686/1686 - 47s - loss: 8.8948 - accuracy10: 0.6795 - accuracy20: 0.6609 - accuracy30: 0.6378 - accuracy50: 0.6099 - val_loss: 12.7997 - val_accuracy10: 0.6835 - val_accuracy20: 0.6722 - val_accuracy30: 0.6537 - val_accuracy50: 0.6114 - 47s/epoch - 28ms/step
Epoch 14/50
1686/1686 - 47s - loss: 8.8639 - accuracy10: 0.6809 - accuracy20: 0.6625 - accuracy30: 0.6389 - accuracy50: 0.6102 - val_loss: 13.0157 - val_accuracy10: 0.6884 - val_accuracy20: 0.6758 - val_accuracy30: 0.6572 - val_accuracy50: 0.6148 - 47s/epoch - 28ms/step
Epoch 15/50
1686/1686 - 47s - loss: 8.8272 - accuracy10: 0.6817 - accuracy20: 0.6627 - accuracy30: 0.6395 - accuracy50: 0.6123 - val_loss: 12.9779 - val_accuracy10: 0.6846 - val_accuracy20: 0.6716 - val_accuracy30: 0.6529 - val_accuracy50: 0.6110 - 47s/epoch - 28ms/step
testing model: results/AAL/W10/deepVOL_L2/seq2seq
Evaluating performance on  test set...
10110/10110 - 88s - 88s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6506158
{'0': {'precision': 0.3927371205264746, 'recall': 0.5778970732462706, 'f1-score': 0.46765637139825733, 'support': 290595}, '1': {'precision': 0.8974375064534402, 'recall': 0.7856190447653862, 'f1-score': 0.8378137930612101, 'support': 2002440}, '2': {'precision': 0.3818863924664038, 'recall': 0.5274819870808565, 'f1-score': 0.4430288047570048, 'support': 295066}, 'accuracy': 0.7328659121108488, 'macro avg': {'precision': 0.5573536731487728, 'recall': 0.6303327016975044, 'f1-score': 0.5828329897388241, 'support': 2588101}, 'weighted avg': {'precision': 0.7819918520341785, 'recall': 0.7328659121108488, 'f1-score': 0.7512431672212161, 'support': 2588101}}
[[ 167934   88122   34539]
 [ 211905 1573155  217380]
 [  47760   91664  155642]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.70208275
{'0': {'precision': 0.4680572345429369, 'recall': 0.5356151152963902, 'f1-score': 0.499562491056285, 'support': 397584}, '1': {'precision': 0.8303796933906528, 'recall': 0.7909194543942422, 'f1-score': 0.8101693693405049, 'support': 1790377}, '2': {'precision': 0.4531336920394359, 'recall': 0.4844954266006898, 'f1-score': 0.4682900670794011, 'support': 400140}, 'accuracy': 0.7043241357273151, 'macro avg': {'precision': 0.5838568733243418, 'recall': 0.6036766654304407, 'f1-score': 0.5926739758253969, 'support': 2588101}, 'weighted avg': {'precision': 0.7163946412388295, 'recall': 0.7043241357273151, 'f1-score': 0.7095968224798872, 'support': 2588101}}
[[ 212952  142935   41697]
 [ 182062 1416044  192271]
 [  59956  146318  193866]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.76116604
{'0': {'precision': 0.5009645647149706, 'recall': 0.4977175496709687, 'f1-score': 0.49933577868314954, 'support': 474271}, '1': {'precision': 0.7688901835129625, 'recall': 0.7905452691812375, 'f1-score': 0.7795673697759157, 'support': 1636091}, '2': {'precision': 0.48993867514388106, 'recall': 0.4458354875779453, 'f1-score': 0.4668477861810706, 'support': 477739}, 'accuracy': 0.6732542508967, 'macro avg': {'precision': 0.5865978077906047, 'recall': 0.5780327688100505, 'f1-score': 0.5819169782133785, 'support': 2588101}, 'weighted avg': {'precision': 0.6683008456897171, 'recall': 0.6732542508967, 'f1-score': 0.6704896876892524, 'support': 2588101}}
[[ 236053  192155   46063]
 [ 167009 1293404  175678]
 [  68135  196611  212993]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8762551
{'0': {'precision': 0.5332727473126218, 'recall': 0.4330810127950495, 'f1-score': 0.477982931377876, 'support': 592104}, '1': {'precision': 0.6601070538359566, 'recall': 0.7914858945919672, 'f1-score': 0.7198511436662053, 'support': 1397939}, '2': {'precision': 0.5280948139075244, 'recall': 0.3806470275458233, 'f1-score': 0.4424088602650384, 'support': 598058}, 'accuracy': 0.6145536824103851, 'macro avg': {'precision': 0.5738248716853676, 'recall': 0.53507131164428, 'f1-score': 0.5467476451030399, 'support': 2588101}, 'weighted avg': {'precision': 0.600584617726697, 'recall': 0.6145536824103851, 'f1-score': 0.6004053750910592, 'support': 2588101}}
[[ 256429  280537   55138]
 [ 143201 1106449  148289]
 [  81229  289180  227649]]
Evaluating performance on  train set...
1686/1686 - 16s - 16s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.619308
{'0': {'precision': 0.3601779217826285, 'recall': 0.594450698939863, 'f1-score': 0.4485681922763796, 'support': 42636}, '1': {'precision': 0.918252546641696, 'recall': 0.7799886824265801, 'f1-score': 0.8434921749990243, 'support': 346364}, '2': {'precision': 0.35450596366567644, 'recall': 0.5578838564179666, 'f1-score': 0.43352775267668886, 'support': 42568}, 'accuracy': 0.7397513253994735, 'macro avg': {'precision': 0.5443121440300003, 'recall': 0.6441077459281366, 'f1-score': 0.5751960399840309, 'support': 431568}, 'weighted avg': {'precision': 0.8075130241339697, 'recall': 0.7397513253994735, 'f1-score': 0.7640392395247076, 'support': 431568}}
[[ 25345  12026   5265]
 [ 38228 270160  37976]
 [  6795  12025  23748]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6613871
{'0': {'precision': 0.430231162213715, 'recall': 0.5555287633482604, 'f1-score': 0.48491682264769337, 'support': 58060}, '1': {'precision': 0.8635001257580416, 'recall': 0.783232626005621, 'f1-score': 0.8214101168866773, 'support': 315601}, '2': {'precision': 0.4252079334612924, 'recall': 0.5164660576441535, 'f1-score': 0.46641505902902325, 'support': 57907}, 'accuracy': 0.7168047677306937, 'macro avg': {'precision': 0.572979740477683, 'recall': 0.618409148999345, 'f1-score': 0.5909139995211313, 'support': 431568}, 'weighted avg': {'precision': 0.74640205082498, 'recall': 0.7168047677306937, 'f1-score': 0.7285081883866991, 'support': 431568}}
[[ 32254  19634   6172]
 [ 34156 247189  34256]
 [  8559  19441  29907]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.714753
{'0': {'precision': 0.4631163352966897, 'recall': 0.517845844118493, 'f1-score': 0.4889543646213798, 'support': 69540}, '1': {'precision': 0.811557308558399, 'recall': 0.7828232634228475, 'f1-score': 0.7969313624423936, 'support': 292803}, '2': {'precision': 0.4616947347773699, 'recall': 0.4760274467316721, 'f1-score': 0.4687515558432137, 'support': 69225}, 'accuracy': 0.6909154524895266, 'macro avg': {'precision': 0.5787894595441528, 'recall': 0.5922321847576708, 'f1-score': 0.584879094302329, 'support': 431568}, 'weighted avg': {'precision': 0.699292678301728, 'recall': 0.6909154524895266, 'f1-score': 0.6946648191854757, 'support': 431568}}
[[ 36011  26690   6839]
 [ 32008 229213  31582]
 [  9739  26533  32953]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.81536907
{'0': {'precision': 0.4998993887868803, 'recall': 0.45324864877192184, 'f1-score': 0.47543238523550935, 'support': 87698}, '1': {'precision': 0.717206955965682, 'recall': 0.7865959618786381, 'f1-score': 0.7503005729003102, 'support': 256654}, '2': {'precision': 0.5037764457481331, 'recall': 0.4076201614382682, 'f1-score': 0.450625851633552, 'support': 87216}, 'accuracy': 0.642269584399214, 'macro avg': {'precision': 0.5736275968335651, 'recall': 0.5491549240296094, 'f1-score': 0.5587862699231237, 'support': 431568}, 'weighted avg': {'precision': 0.6299159742302886, 'recall': 0.642269584399214, 'f1-score': 0.6338836448337499, 'support': 431568}}
[[ 39749  39724   8225]
 [ 27978 201883  26793]
 [ 11787  39878  35551]]
Evaluating performance on  val set...
705/705 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7445707
{'0': {'precision': 0.3374140488067952, 'recall': 0.5895128615848487, 'f1-score': 0.42918145804393676, 'support': 21226}, '1': {'precision': 0.9010025516205505, 'recall': 0.726145072959433, 'f1-score': 0.8041784945628692, 'support': 137131}, '2': {'precision': 0.3511627198195727, 'recall': 0.5223738495715646, 'f1-score': 0.41998979368666617, 'support': 22057}, 'accuracy': 0.6851574711496891, 'macro avg': {'precision': 0.5298597734156395, 'recall': 0.6126772613719488, 'f1-score': 0.551116582097824, 'support': 180414}, 'weighted avg': {'precision': 0.7674732981770321, 'recall': 0.6851574711496891, 'f1-score': 0.7130894589426996, 'support': 180414}}
[[12513  5298  3415]
 [19680 99577 17874]
 [ 4892  5643 11522]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7718262
{'0': {'precision': 0.4021464162514373, 'recall': 0.5616301477410606, 'f1-score': 0.46869276471551735, 'support': 28022}, '1': {'precision': 0.843145853549302, 'recall': 0.7346210439886512, 'f1-score': 0.7851510741360209, 'support': 123009}, '2': {'precision': 0.42524118112776005, 'recall': 0.49355069257734063, 'f1-score': 0.45685662980814673, 'support': 29383}, 'accuracy': 0.6684902502023125, 'macro avg': {'precision': 0.5568444836428331, 'recall': 0.5966006281023509, 'f1-score': 0.5702334895532283, 'support': 180414}, 'weighted avg': {'precision': 0.7065878302156199, 'recall': 0.6684902502023125, 'f1-score': 0.6825311532636537, 'support': 180414}}
[[15738  8214  4070]
 [17113 90365 15531]
 [ 6284  8597 14502]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.80731064
{'0': {'precision': 0.43542471999207055, 'recall': 0.5329208746550208, 'f1-score': 0.47926468382222587, 'support': 32973}, '1': {'precision': 0.7889294979832219, 'recall': 0.7378852284803401, 'f1-score': 0.7625541105731831, 'support': 112920}, '2': {'precision': 0.4643479270700267, 'recall': 0.4633121867848556, 'f1-score': 0.46382947872109037, 'support': 34521}, 'accuracy': 0.6478876362144844, 'macro avg': {'precision': 0.5629007150151063, 'recall': 0.5780394299734055, 'f1-score': 0.5685494243721664, 'support': 180414}, 'weighted avg': {'precision': 0.6622154211699113, 'recall': 0.6478876362144844, 'f1-score': 0.6536203510843108, 'support': 180414}}
[[17572 10908  4493]
 [15641 83322 13957]
 [ 7143 11384 15994]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.88777107
{'0': {'precision': 0.47275340430196583, 'recall': 0.47833481218574386, 'f1-score': 0.47552773115420893, 'support': 40572}, '1': {'precision': 0.6894488966538798, 'recall': 0.7460033699091768, 'f1-score': 0.7166120563736132, 'support': 97332}, '2': {'precision': 0.5105295620759538, 'recall': 0.4088920254057869, 'f1-score': 0.4540930287236961, 'support': 42510}, 'accuracy': 0.606377553848371, 'macro avg': {'precision': 0.5575772876772664, 'recall': 0.5444100691669025, 'f1-score': 0.5487442720838395, 'support': 180414}, 'weighted avg': {'precision': 0.598559994303677, 'recall': 0.606377553848371, 'f1-score': 0.6005403706496691, 'support': 180414}}
[[19407 15931  5234]
 [13291 72610 11431]
 [ 8353 16775 17382]]
training model: results/AAL/W10/deepVOL_L3/seq2seq
Epoch 1/50
1686/1686 - 78s - loss: 11.3217 - accuracy10: 0.4469 - accuracy20: 0.4687 - accuracy30: 0.4825 - accuracy50: 0.4962 - val_loss: 13.3105 - val_accuracy10: 0.5620 - val_accuracy20: 0.5642 - val_accuracy30: 0.5578 - val_accuracy50: 0.5381 - 78s/epoch - 46ms/step
Epoch 2/50
1686/1686 - 71s - loss: 9.9814 - accuracy10: 0.5989 - accuracy20: 0.5998 - accuracy30: 0.5908 - accuracy50: 0.5768 - val_loss: 13.0833 - val_accuracy10: 0.5809 - val_accuracy20: 0.5850 - val_accuracy30: 0.5802 - val_accuracy50: 0.5587 - 71s/epoch - 42ms/step
Epoch 3/50
1686/1686 - 69s - loss: 9.6942 - accuracy10: 0.6223 - accuracy20: 0.6195 - accuracy30: 0.6072 - accuracy50: 0.5879 - val_loss: 13.1935 - val_accuracy10: 0.6154 - val_accuracy20: 0.6123 - val_accuracy30: 0.6020 - val_accuracy50: 0.5747 - 69s/epoch - 41ms/step
Epoch 4/50
1686/1686 - 70s - loss: 9.4461 - accuracy10: 0.6386 - accuracy20: 0.6299 - accuracy30: 0.6131 - accuracy50: 0.5907 - val_loss: 12.6223 - val_accuracy10: 0.6119 - val_accuracy20: 0.6115 - val_accuracy30: 0.6025 - val_accuracy50: 0.5762 - 70s/epoch - 41ms/step
Epoch 5/50
1686/1686 - 69s - loss: 9.2656 - accuracy10: 0.6494 - accuracy20: 0.6392 - accuracy30: 0.6193 - accuracy50: 0.5948 - val_loss: 12.6688 - val_accuracy10: 0.6311 - val_accuracy20: 0.6266 - val_accuracy30: 0.6135 - val_accuracy50: 0.5821 - 69s/epoch - 41ms/step
Epoch 6/50
1686/1686 - 69s - loss: 9.1236 - accuracy10: 0.6595 - accuracy20: 0.6469 - accuracy30: 0.6251 - accuracy50: 0.5992 - val_loss: 12.8898 - val_accuracy10: 0.6073 - val_accuracy20: 0.6060 - val_accuracy30: 0.5949 - val_accuracy50: 0.5694 - 69s/epoch - 41ms/step
Epoch 7/50
1686/1686 - 71s - loss: 9.0649 - accuracy10: 0.6620 - accuracy20: 0.6500 - accuracy30: 0.6279 - accuracy50: 0.6015 - val_loss: 12.4085 - val_accuracy10: 0.6363 - val_accuracy20: 0.6314 - val_accuracy30: 0.6170 - val_accuracy50: 0.5840 - 71s/epoch - 42ms/step
Epoch 8/50
1686/1686 - 68s - loss: 8.9926 - accuracy10: 0.6638 - accuracy20: 0.6524 - accuracy30: 0.6306 - accuracy50: 0.6037 - val_loss: 12.7350 - val_accuracy10: 0.6233 - val_accuracy20: 0.6213 - val_accuracy30: 0.6081 - val_accuracy50: 0.5786 - 68s/epoch - 41ms/step
Epoch 9/50
1686/1686 - 69s - loss: 8.9378 - accuracy10: 0.6671 - accuracy20: 0.6551 - accuracy30: 0.6329 - accuracy50: 0.6053 - val_loss: 12.1864 - val_accuracy10: 0.6377 - val_accuracy20: 0.6353 - val_accuracy30: 0.6220 - val_accuracy50: 0.5894 - 69s/epoch - 41ms/step
Epoch 10/50
1686/1686 - 69s - loss: 8.8854 - accuracy10: 0.6697 - accuracy20: 0.6578 - accuracy30: 0.6357 - accuracy50: 0.6084 - val_loss: 12.4398 - val_accuracy10: 0.6298 - val_accuracy20: 0.6269 - val_accuracy30: 0.6135 - val_accuracy50: 0.5827 - 69s/epoch - 41ms/step
Epoch 11/50
1686/1686 - 72s - loss: 8.8316 - accuracy10: 0.6725 - accuracy20: 0.6605 - accuracy30: 0.6382 - accuracy50: 0.6102 - val_loss: 12.1759 - val_accuracy10: 0.5947 - val_accuracy20: 0.5992 - val_accuracy30: 0.5909 - val_accuracy50: 0.5682 - 72s/epoch - 42ms/step
Epoch 12/50
1686/1686 - 71s - loss: 8.7969 - accuracy10: 0.6736 - accuracy20: 0.6619 - accuracy30: 0.6408 - accuracy50: 0.6120 - val_loss: 12.1812 - val_accuracy10: 0.6273 - val_accuracy20: 0.6258 - val_accuracy30: 0.6141 - val_accuracy50: 0.5856 - 71s/epoch - 42ms/step
Epoch 13/50
1686/1686 - 68s - loss: 8.7496 - accuracy10: 0.6760 - accuracy20: 0.6640 - accuracy30: 0.6421 - accuracy50: 0.6140 - val_loss: 12.9064 - val_accuracy10: 0.6028 - val_accuracy20: 0.6037 - val_accuracy30: 0.5954 - val_accuracy50: 0.5703 - 68s/epoch - 41ms/step
Epoch 14/50
1686/1686 - 69s - loss: 8.7164 - accuracy10: 0.6787 - accuracy20: 0.6657 - accuracy30: 0.6437 - accuracy50: 0.6149 - val_loss: 12.3814 - val_accuracy10: 0.6345 - val_accuracy20: 0.6331 - val_accuracy30: 0.6224 - val_accuracy50: 0.5906 - 69s/epoch - 41ms/step
Epoch 15/50
1686/1686 - 70s - loss: 8.6968 - accuracy10: 0.6784 - accuracy20: 0.6644 - accuracy30: 0.6430 - accuracy50: 0.6146 - val_loss: 12.3027 - val_accuracy10: 0.6443 - val_accuracy20: 0.6403 - val_accuracy30: 0.6275 - val_accuracy50: 0.5949 - 70s/epoch - 41ms/step
Epoch 16/50
1686/1686 - 70s - loss: 8.6611 - accuracy10: 0.6813 - accuracy20: 0.6674 - accuracy30: 0.6455 - accuracy50: 0.6160 - val_loss: 12.2919 - val_accuracy10: 0.6413 - val_accuracy20: 0.6385 - val_accuracy30: 0.6260 - val_accuracy50: 0.5932 - 70s/epoch - 42ms/step
Epoch 17/50
1686/1686 - 70s - loss: 8.6471 - accuracy10: 0.6811 - accuracy20: 0.6665 - accuracy30: 0.6445 - accuracy50: 0.6159 - val_loss: 12.5760 - val_accuracy10: 0.6196 - val_accuracy20: 0.6179 - val_accuracy30: 0.6070 - val_accuracy50: 0.5787 - 70s/epoch - 42ms/step
Epoch 18/50
1686/1686 - 71s - loss: 8.6231 - accuracy10: 0.6825 - accuracy20: 0.6670 - accuracy30: 0.6460 - accuracy50: 0.6174 - val_loss: 12.2481 - val_accuracy10: 0.6479 - val_accuracy20: 0.6435 - val_accuracy30: 0.6290 - val_accuracy50: 0.5953 - 71s/epoch - 42ms/step
Epoch 19/50
1686/1686 - 69s - loss: 8.5824 - accuracy10: 0.6824 - accuracy20: 0.6677 - accuracy30: 0.6462 - accuracy50: 0.6184 - val_loss: 12.2633 - val_accuracy10: 0.6516 - val_accuracy20: 0.6467 - val_accuracy30: 0.6317 - val_accuracy50: 0.5966 - 69s/epoch - 41ms/step
Epoch 20/50
1686/1686 - 69s - loss: 8.5678 - accuracy10: 0.6840 - accuracy20: 0.6692 - accuracy30: 0.6472 - accuracy50: 0.6187 - val_loss: 12.0131 - val_accuracy10: 0.6533 - val_accuracy20: 0.6489 - val_accuracy30: 0.6347 - val_accuracy50: 0.5987 - 69s/epoch - 41ms/step
Epoch 21/50
1686/1686 - 70s - loss: 8.5376 - accuracy10: 0.6841 - accuracy20: 0.6689 - accuracy30: 0.6476 - accuracy50: 0.6202 - val_loss: 11.9255 - val_accuracy10: 0.6500 - val_accuracy20: 0.6458 - val_accuracy30: 0.6316 - val_accuracy50: 0.5973 - 70s/epoch - 42ms/step
Epoch 22/50
1686/1686 - 68s - loss: 8.5198 - accuracy10: 0.6844 - accuracy20: 0.6694 - accuracy30: 0.6478 - accuracy50: 0.6201 - val_loss: 12.2737 - val_accuracy10: 0.6532 - val_accuracy20: 0.6472 - val_accuracy30: 0.6322 - val_accuracy50: 0.5963 - 68s/epoch - 40ms/step
Epoch 23/50
1686/1686 - 69s - loss: 8.4922 - accuracy10: 0.6849 - accuracy20: 0.6698 - accuracy30: 0.6485 - accuracy50: 0.6207 - val_loss: 12.0541 - val_accuracy10: 0.6537 - val_accuracy20: 0.6506 - val_accuracy30: 0.6367 - val_accuracy50: 0.6017 - 69s/epoch - 41ms/step
Epoch 24/50
1686/1686 - 69s - loss: 8.4695 - accuracy10: 0.6856 - accuracy20: 0.6707 - accuracy30: 0.6490 - accuracy50: 0.6219 - val_loss: 12.4694 - val_accuracy10: 0.6407 - val_accuracy20: 0.6377 - val_accuracy30: 0.6245 - val_accuracy50: 0.5914 - 69s/epoch - 41ms/step
Epoch 25/50
1686/1686 - 69s - loss: 8.4502 - accuracy10: 0.6864 - accuracy20: 0.6708 - accuracy30: 0.6495 - accuracy50: 0.6219 - val_loss: 12.2440 - val_accuracy10: 0.6506 - val_accuracy20: 0.6455 - val_accuracy30: 0.6310 - val_accuracy50: 0.5958 - 69s/epoch - 41ms/step
Epoch 26/50
1686/1686 - 68s - loss: 8.4335 - accuracy10: 0.6863 - accuracy20: 0.6709 - accuracy30: 0.6497 - accuracy50: 0.6222 - val_loss: 12.4112 - val_accuracy10: 0.6568 - val_accuracy20: 0.6504 - val_accuracy30: 0.6346 - val_accuracy50: 0.5982 - 68s/epoch - 41ms/step
Epoch 27/50
1686/1686 - 69s - loss: 8.4099 - accuracy10: 0.6868 - accuracy20: 0.6712 - accuracy30: 0.6500 - accuracy50: 0.6230 - val_loss: 12.5321 - val_accuracy10: 0.6324 - val_accuracy20: 0.6288 - val_accuracy30: 0.6175 - val_accuracy50: 0.5862 - 69s/epoch - 41ms/step
Epoch 28/50
1686/1686 - 69s - loss: 8.3917 - accuracy10: 0.6877 - accuracy20: 0.6721 - accuracy30: 0.6511 - accuracy50: 0.6236 - val_loss: 12.7857 - val_accuracy10: 0.6449 - val_accuracy20: 0.6393 - val_accuracy30: 0.6252 - val_accuracy50: 0.5908 - 69s/epoch - 41ms/step
Epoch 29/50
1686/1686 - 71s - loss: 8.3668 - accuracy10: 0.6880 - accuracy20: 0.6727 - accuracy30: 0.6517 - accuracy50: 0.6245 - val_loss: 12.4210 - val_accuracy10: 0.6632 - val_accuracy20: 0.6542 - val_accuracy30: 0.6368 - val_accuracy50: 0.6001 - 71s/epoch - 42ms/step
Epoch 30/50
1686/1686 - 69s - loss: 8.3517 - accuracy10: 0.6879 - accuracy20: 0.6730 - accuracy30: 0.6523 - accuracy50: 0.6246 - val_loss: 12.5218 - val_accuracy10: 0.6202 - val_accuracy20: 0.6199 - val_accuracy30: 0.6085 - val_accuracy50: 0.5807 - 69s/epoch - 41ms/step
Epoch 31/50
1686/1686 - 69s - loss: 8.3648 - accuracy10: 0.6875 - accuracy20: 0.6730 - accuracy30: 0.6519 - accuracy50: 0.6250 - val_loss: 12.8522 - val_accuracy10: 0.6181 - val_accuracy20: 0.6193 - val_accuracy30: 0.6091 - val_accuracy50: 0.5813 - 69s/epoch - 41ms/step
testing model: results/AAL/W10/deepVOL_L3/seq2seq
Evaluating performance on  test set...
10110/10110 - 155s - 155s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6867919
{'0': {'precision': 0.3797344427540956, 'recall': 0.6313357077719851, 'f1-score': 0.47423002856293545, 'support': 290595}, '1': {'precision': 0.9090412802081203, 'recall': 0.730115259383552, 'f1-score': 0.8098127226516663, 'support': 2002440}, '2': {'precision': 0.3512931251447152, 'recall': 0.5913083852426236, 'f1-score': 0.44074313118976016, 'support': 295066}, 'accuracy': 0.703198986438319, 'macro avg': {'precision': 0.5466896160356437, 'recall': 0.6509197841327202, 'f1-score': 0.5749286274681206, 'support': 2588101}, 'weighted avg': {'precision': 0.7860219554012865, 'recall': 0.703198986438319, 'f1-score': 0.7300559662256174, 'support': 2588101}}
[[ 183463   77115   30017]
 [ 248255 1462012  292173]
 [  51417   69174  174475]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.72738475
{'0': {'precision': 0.46184339144926606, 'recall': 0.5799202181174292, 'f1-score': 0.5141902017805213, 'support': 397584}, '1': {'precision': 0.8442645733220965, 'recall': 0.7397095695487599, 'f1-score': 0.7885363368185645, 'support': 1790377}, '2': {'precision': 0.42202935324817625, 'recall': 0.5486729644624382, 'f1-score': 0.47708981860260447, 'support': 400140}, 'accuracy': 0.6856270292388126, 'macro avg': {'precision': 0.5760457726731796, 'recall': 0.6227675840428758, 'f1-score': 0.5932721190672301, 'support': 2588101}, 'weighted avg': {'precision': 0.7202362822569078, 'recall': 0.6856270292388126, 'f1-score': 0.6982393029887799, 'support': 2588101}}
[[ 230567  128784   38233]
 [ 203582 1324359  262436]
 [  65083  115511  219546]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.77851766
{'0': {'precision': 0.5004929605237213, 'recall': 0.535179254055171, 'f1-score': 0.5172552579907908, 'support': 474271}, '1': {'precision': 0.7848413518917645, 'recall': 0.739159985599823, 'f1-score': 0.7613160278682033, 'support': 1636091}, '2': {'precision': 0.457505860047621, 'recall': 0.5172238397953695, 'f1-score': 0.4855355032289061, 'support': 477739}, 'accuracy': 0.6608130826424471, 'macro avg': {'precision': 0.5809467241543689, 'recall': 0.5971876931501211, 'f1-score': 0.5880355963626335, 'support': 2588101}, 'weighted avg': {'precision': 0.6723113051661372, 'recall': 0.6608130826424471, 'f1-score': 0.6656852710116573, 'support': 2588101}}
[[ 253820  175151   45300]
 [ 179058 1209333  247700]
 [  74262  156379  247098]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8832425
{'0': {'precision': 0.5344243159778453, 'recall': 0.4670463296988367, 'f1-score': 0.49846875963221393, 'support': 592104}, '1': {'precision': 0.6794004674632184, 'recall': 0.7317107541888451, 'f1-score': 0.7045860323635653, 'support': 1397939}, '2': {'precision': 0.4923620623139624, 'recall': 0.46520738791220917, 'f1-score': 0.47839970012002075, 'support': 598058}, 'accuracy': 0.6095774469388946, 'macro avg': {'precision': 0.5687289485850088, 'recall': 0.554654823933297, 'f1-score': 0.5604848307052667, 'support': 2588101}, 'weighted avg': {'precision': 0.6030121141084424, 'recall': 0.6095774469388946, 'f1-score': 0.6051635572970073, 'support': 2588101}}
[[ 276540  251692   63872]
 [ 152071 1022887  222981]
 [  88843  230994  278221]]
Evaluating performance on  train set...
1686/1686 - 27s - 27s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6608999
{'0': {'precision': 0.35198402065622486, 'recall': 0.6778309409888357, 'f1-score': 0.46335636754260795, 'support': 42636}, '1': {'precision': 0.9312896445385273, 'recall': 0.7201816586019332, 'f1-score': 0.8122426584914353, 'support': 346364}, '2': {'precision': 0.3248134488378077, 'recall': 0.6227447848148844, 'f1-score': 0.42694131952553127, 'support': 42568}, 'accuracy': 0.7063869424980536, 'macro avg': {'precision': 0.5360290380108532, 'recall': 0.6735857948018844, 'f1-score': 0.5675134485198582, 'support': 431568}, 'weighted avg': {'precision': 0.8142379788023418, 'recall': 0.7063869424980534, 'f1-score': 0.7397705954608241, 'support': 431568}}
[[ 28900   9646   4090]
 [ 45905 249445  51014]
 [  7301   8758  26509]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6866745
{'0': {'precision': 0.4270874809696686, 'recall': 0.6281260764726145, 'f1-score': 0.5084559079818752, 'support': 58060}, '1': {'precision': 0.8800092061604557, 'recall': 0.7269115116872253, 'f1-score': 0.7961672473867596, 'support': 315601}, '2': {'precision': 0.39483873986640616, 'recall': 0.5828656293712332, 'f1-score': 0.4707720203640421, 'support': 57907}, 'accuracy': 0.694293830867905, 'macro avg': {'precision': 0.5673118089988435, 'recall': 0.6459677391770243, 'f1-score': 0.5917983919108923, 'support': 431568}, 'weighted avg': {'precision': 0.7539771519852931, 'recall': 0.694293830867905, 'f1-score': 0.7137997368738114, 'support': 431568}}
[[ 36469  16570   5021]
 [ 39477 229414  46710]
 [  9444  14711  33752]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.72904474
{'0': {'precision': 0.4648779086469405, 'recall': 0.581765890135174, 'f1-score': 0.5167949413981414, 'support': 69540}, '1': {'precision': 0.8311567492348405, 'recall': 0.7262015758035266, 'f1-score': 0.7751425363449453, 'support': 292803}, '2': {'precision': 0.4302590346506752, 'recall': 0.5513903936439147, 'f1-score': 0.4833511672227885, 'support': 69225}, 'accuracy': 0.6748878508137768, 'macro avg': {'precision': 0.575431230844152, 'recall': 0.6197859531942052, 'f1-score': 0.5917628816552917, 'support': 431568}, 'weighted avg': {'precision': 0.7078316304434301, 'recall': 0.6748878508137768, 'f1-score': 0.6867097765479213, 'support': 431568}}
[[ 40456  23082   6002]
 [ 35627 212634  44542]
 [ 10942  20113  38170]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8163285
{'0': {'precision': 0.503070589823188, 'recall': 0.5100116308239641, 'f1-score': 0.5065173323669637, 'support': 87698}, '1': {'precision': 0.7407558357907187, 'recall': 0.7223187637831477, 'f1-score': 0.7314211315394934, 'support': 256654}, '2': {'precision': 0.4701171071714613, 'recall': 0.49802788479178134, 'f1-score': 0.48367017426646625, 'support': 87216}, 'accuracy': 0.6338491269046824, 'macro avg': {'precision': 0.571314510928456, 'recall': 0.5767860931329644, 'f1-score': 0.5738695460576411, 'support': 431568}, 'weighted avg': {'precision': 0.6377626851027213, 'recall': 0.6338491269046824, 'f1-score': 0.6356506831527807, 'support': 431568}}
[[ 44727  34524   8447]
 [ 30757 185386  40511]
 [ 13424  30356  43436]]
Evaluating performance on  val set...
705/705 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.780492
{'0': {'precision': 0.3259639753801593, 'recall': 0.678648826910393, 'f1-score': 0.44039866703353814, 'support': 21226}, '1': {'precision': 0.9168804670612715, 'recall': 0.6619436888814345, 'f1-score': 0.7688294308715851, 'support': 137131}, '2': {'precision': 0.3280494357872112, 'recall': 0.5535657614362788, 'f1-score': 0.411964168227137, 'support': 22057}, 'accuracy': 0.6506590397640981, 'macro avg': {'precision': 0.5236312927428807, 'recall': 0.6313860924093687, 'f1-score': 0.5403974220440867, 'support': 180414}, 'weighted avg': {'precision': 0.7753690571416686, 'recall': 0.6506590397640981, 'f1-score': 0.686559493442256, 'support': 180414}}
[[14405  4114  2707]
 [24055 90773 22303]
 [ 5732  4115 12210]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7921565
{'0': {'precision': 0.3942162007861048, 'recall': 0.6406751837841695, 'f1-score': 0.48809863654282726, 'support': 28022}, '1': {'precision': 0.8626940317091392, 'recall': 0.6759098927720736, 'f1-score': 0.7579643093192334, 'support': 123009}, '2': {'precision': 0.40182351871574407, 'recall': 0.5264608787394072, 'f1-score': 0.4557748968768415, 'support': 29383}, 'accuracy': 0.6460973095214341, 'macro avg': {'precision': 0.5529112504036626, 'recall': 0.6143486517652167, 'f1-score': 0.5672792809129673, 'support': 180414}, 'weighted avg': {'precision': 0.7148704478331085, 'recall': 0.6460973095214341, 'f1-score': 0.66683275972588, 'support': 180414}}
[[17953  6777  3292]
 [20130 83143 19736]
 [ 7458  6456 15469]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8194268
{'0': {'precision': 0.4302451255890364, 'recall': 0.6036454068480271, 'f1-score': 0.5024042405502619, 'support': 32973}, '1': {'precision': 0.8105994051462261, 'recall': 0.6782058094226001, 'f1-score': 0.7385159862485957, 'support': 112920}, '2': {'precision': 0.43957151858853183, 'recall': 0.5051997334955535, 'f1-score': 0.4701062051862634, 'support': 34521}, 'accuracy': 0.6314753843936723, 'macro avg': {'precision': 0.5601386831079315, 'recall': 0.5956836499220602, 'f1-score': 0.5703421439950404, 'support': 180414}, 'weighted avg': {'precision': 0.6700910447545858, 'recall': 0.6314753843936723, 'f1-score': 0.6440051021544348, 'support': 180414}}
[[19904  9310  3759]
 [17861 76583 18476]
 [ 8497  8584 17440]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.88605046
{'0': {'precision': 0.4691057431494415, 'recall': 0.541358572414473, 'f1-score': 0.5026489535775176, 'support': 40572}, '1': {'precision': 0.7150165839276811, 'recall': 0.6777421608515185, 'f1-score': 0.6958805844190095, 'support': 97332}, '2': {'precision': 0.48208539978226683, 'recall': 0.46876029169607153, 'f1-score': 0.4753294770111516, 'support': 42510}, 'accuracy': 0.5978305453013624, 'macro avg': {'precision': 0.5554025756197966, 'recall': 0.5626203416540211, 'f1-score': 0.5579530050025595, 'support': 180414}, 'weighted avg': {'precision': 0.6048311256479673, 'recall': 0.5978305453013624, 'f1-score': 0.6004588250078271, 'support': 180414}}
[[21964 13696  4912]
 [14870 65966 16496]
 [ 9987 12596 19927]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :       256            32
 Used       :        24 (peak)  17.22 (ave)

============================================
