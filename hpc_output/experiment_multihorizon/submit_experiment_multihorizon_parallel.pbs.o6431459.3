This machine has 1 visible gpus.
This machine has 1 physical gpus.
training model: results/CHTR/W0/deepLOB_L1/seq2seq
Epoch 1/50
486/486 - 27s - loss: 13.1304 - accuracy10: 0.3787 - accuracy20: 0.3761 - accuracy30: 0.3750 - accuracy50: 0.3704 - val_loss: 13.6858 - val_accuracy10: 0.3612 - val_accuracy20: 0.3610 - val_accuracy30: 0.3587 - val_accuracy50: 0.3574 - 27s/epoch - 56ms/step
Epoch 2/50
486/486 - 12s - loss: 13.0323 - accuracy10: 0.3890 - accuracy20: 0.3892 - accuracy30: 0.3861 - accuracy50: 0.3804 - val_loss: 13.4490 - val_accuracy10: 0.3682 - val_accuracy20: 0.3649 - val_accuracy30: 0.3621 - val_accuracy50: 0.3570 - 12s/epoch - 25ms/step
Epoch 3/50
486/486 - 12s - loss: 12.9787 - accuracy10: 0.4010 - accuracy20: 0.3991 - accuracy30: 0.3929 - accuracy50: 0.3867 - val_loss: 13.3802 - val_accuracy10: 0.3776 - val_accuracy20: 0.3714 - val_accuracy30: 0.3656 - val_accuracy50: 0.3603 - 12s/epoch - 24ms/step
Epoch 4/50
486/486 - 11s - loss: 12.9535 - accuracy10: 0.4079 - accuracy20: 0.4040 - accuracy30: 0.3991 - accuracy50: 0.3872 - val_loss: 13.2656 - val_accuracy10: 0.3853 - val_accuracy20: 0.3776 - val_accuracy30: 0.3712 - val_accuracy50: 0.3635 - 11s/epoch - 23ms/step
Epoch 5/50
486/486 - 12s - loss: 12.9285 - accuracy10: 0.4155 - accuracy20: 0.4114 - accuracy30: 0.4041 - accuracy50: 0.3907 - val_loss: 13.2188 - val_accuracy10: 0.3944 - val_accuracy20: 0.3865 - val_accuracy30: 0.3769 - val_accuracy50: 0.3678 - 12s/epoch - 24ms/step
Epoch 6/50
486/486 - 11s - loss: 12.9022 - accuracy10: 0.4196 - accuracy20: 0.4144 - accuracy30: 0.4089 - accuracy50: 0.3965 - val_loss: 13.1851 - val_accuracy10: 0.3982 - val_accuracy20: 0.3917 - val_accuracy30: 0.3834 - val_accuracy50: 0.3755 - 11s/epoch - 23ms/step
Epoch 7/50
486/486 - 12s - loss: 12.8747 - accuracy10: 0.4260 - accuracy20: 0.4215 - accuracy30: 0.4136 - accuracy50: 0.3994 - val_loss: 13.2152 - val_accuracy10: 0.4038 - val_accuracy20: 0.3944 - val_accuracy30: 0.3860 - val_accuracy50: 0.3771 - 12s/epoch - 24ms/step
Epoch 8/50
486/486 - 12s - loss: 12.8529 - accuracy10: 0.4302 - accuracy20: 0.4247 - accuracy30: 0.4167 - accuracy50: 0.4029 - val_loss: 13.1479 - val_accuracy10: 0.4094 - val_accuracy20: 0.4003 - val_accuracy30: 0.3904 - val_accuracy50: 0.3791 - 12s/epoch - 24ms/step
Epoch 9/50
486/486 - 12s - loss: 12.8348 - accuracy10: 0.4323 - accuracy20: 0.4266 - accuracy30: 0.4174 - accuracy50: 0.4037 - val_loss: 13.1186 - val_accuracy10: 0.4156 - val_accuracy20: 0.4072 - val_accuracy30: 0.3940 - val_accuracy50: 0.3803 - 12s/epoch - 25ms/step
Epoch 10/50
486/486 - 14s - loss: 12.8247 - accuracy10: 0.4330 - accuracy20: 0.4275 - accuracy30: 0.4197 - accuracy50: 0.4045 - val_loss: 13.1528 - val_accuracy10: 0.4111 - val_accuracy20: 0.3998 - val_accuracy30: 0.3886 - val_accuracy50: 0.3773 - 14s/epoch - 28ms/step
Epoch 11/50
486/486 - 12s - loss: 12.8074 - accuracy10: 0.4348 - accuracy20: 0.4297 - accuracy30: 0.4200 - accuracy50: 0.4058 - val_loss: 13.1628 - val_accuracy10: 0.4160 - val_accuracy20: 0.4044 - val_accuracy30: 0.3941 - val_accuracy50: 0.3810 - 12s/epoch - 25ms/step
Epoch 12/50
486/486 - 12s - loss: 12.7964 - accuracy10: 0.4366 - accuracy20: 0.4308 - accuracy30: 0.4215 - accuracy50: 0.4071 - val_loss: 13.1223 - val_accuracy10: 0.4168 - val_accuracy20: 0.4045 - val_accuracy30: 0.3929 - val_accuracy50: 0.3810 - 12s/epoch - 24ms/step
Epoch 13/50
486/486 - 12s - loss: 12.7803 - accuracy10: 0.4383 - accuracy20: 0.4336 - accuracy30: 0.4240 - accuracy50: 0.4088 - val_loss: 13.0819 - val_accuracy10: 0.4224 - val_accuracy20: 0.4128 - val_accuracy30: 0.4000 - val_accuracy50: 0.3862 - 12s/epoch - 24ms/step
Epoch 14/50
486/486 - 12s - loss: 12.7660 - accuracy10: 0.4398 - accuracy20: 0.4358 - accuracy30: 0.4249 - accuracy50: 0.4096 - val_loss: 13.1683 - val_accuracy10: 0.4148 - val_accuracy20: 0.4020 - val_accuracy30: 0.3912 - val_accuracy50: 0.3807 - 12s/epoch - 24ms/step
Epoch 15/50
486/486 - 12s - loss: 12.7617 - accuracy10: 0.4411 - accuracy20: 0.4374 - accuracy30: 0.4269 - accuracy50: 0.4112 - val_loss: 13.0982 - val_accuracy10: 0.4210 - val_accuracy20: 0.4129 - val_accuracy30: 0.3994 - val_accuracy50: 0.3873 - 12s/epoch - 24ms/step
Epoch 16/50
486/486 - 12s - loss: 12.7449 - accuracy10: 0.4406 - accuracy20: 0.4377 - accuracy30: 0.4275 - accuracy50: 0.4138 - val_loss: 13.1337 - val_accuracy10: 0.4185 - val_accuracy20: 0.4088 - val_accuracy30: 0.3972 - val_accuracy50: 0.3870 - 12s/epoch - 24ms/step
Epoch 17/50
486/486 - 12s - loss: 12.7395 - accuracy10: 0.4414 - accuracy20: 0.4370 - accuracy30: 0.4276 - accuracy50: 0.4131 - val_loss: 13.1275 - val_accuracy10: 0.4136 - val_accuracy20: 0.4058 - val_accuracy30: 0.3921 - val_accuracy50: 0.3804 - 12s/epoch - 24ms/step
Epoch 18/50
486/486 - 12s - loss: 12.7269 - accuracy10: 0.4439 - accuracy20: 0.4400 - accuracy30: 0.4301 - accuracy50: 0.4140 - val_loss: 13.1280 - val_accuracy10: 0.4211 - val_accuracy20: 0.4108 - val_accuracy30: 0.3977 - val_accuracy50: 0.3843 - 12s/epoch - 25ms/step
Epoch 19/50
486/486 - 12s - loss: 12.7233 - accuracy10: 0.4440 - accuracy20: 0.4387 - accuracy30: 0.4297 - accuracy50: 0.4139 - val_loss: 13.1463 - val_accuracy10: 0.4149 - val_accuracy20: 0.4061 - val_accuracy30: 0.3958 - val_accuracy50: 0.3833 - 12s/epoch - 24ms/step
Epoch 20/50
486/486 - 12s - loss: 12.7127 - accuracy10: 0.4451 - accuracy20: 0.4413 - accuracy30: 0.4308 - accuracy50: 0.4165 - val_loss: 13.1257 - val_accuracy10: 0.4217 - val_accuracy20: 0.4100 - val_accuracy30: 0.3977 - val_accuracy50: 0.3829 - 12s/epoch - 25ms/step
Epoch 21/50
486/486 - 12s - loss: 12.7064 - accuracy10: 0.4462 - accuracy20: 0.4425 - accuracy30: 0.4329 - accuracy50: 0.4171 - val_loss: 13.1355 - val_accuracy10: 0.4173 - val_accuracy20: 0.4077 - val_accuracy30: 0.3959 - val_accuracy50: 0.3860 - 12s/epoch - 24ms/step
Epoch 22/50
486/486 - 12s - loss: 12.7018 - accuracy10: 0.4467 - accuracy20: 0.4425 - accuracy30: 0.4333 - accuracy50: 0.4182 - val_loss: 13.1231 - val_accuracy10: 0.4176 - val_accuracy20: 0.4072 - val_accuracy30: 0.3969 - val_accuracy50: 0.3864 - 12s/epoch - 25ms/step
Epoch 23/50
486/486 - 11s - loss: 12.6830 - accuracy10: 0.4488 - accuracy20: 0.4445 - accuracy30: 0.4342 - accuracy50: 0.4189 - val_loss: 13.1115 - val_accuracy10: 0.4204 - val_accuracy20: 0.4084 - val_accuracy30: 0.3977 - val_accuracy50: 0.3865 - 11s/epoch - 24ms/step
testing model: results/CHTR/W0/deepLOB_L1/seq2seq
Evaluating performance on  test set...
1269/1269 - 12s - 12s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0923743
{'0': {'precision': 0.4075014556511613, 'recall': 0.4467951161986505, 'f1-score': 0.42624462330345925, 'support': 112781}, '1': {'precision': 0.34469349845201236, 'recall': 0.27529523470417183, 'f1-score': 0.3061103290515573, 'support': 101106}, '2': {'precision': 0.40866415194669237, 'recall': 0.44360868349612637, 'f1-score': 0.42542002724501055, 'support': 110877}, 'accuracy': 0.3923156507494673, 'macro avg': {'precision': 0.38695303534995534, 'recall': 0.3885663447996495, 'f1-score': 0.38592499320000906, 'support': 324764}, 'weighted avg': {'precision': 0.38834494494363964, 'recall': 0.3923156507494673, 'f1-score': 0.3885627167750096, 'support': 324764}}
[[50390 26907 35484]
 [37584 27834 35688]
 [35682 26009 49186]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0955881
{'0': {'precision': 0.3971908463000448, 'recall': 0.455245820345707, 'f1-score': 0.42424142398560827, 'support': 112928}, '1': {'precision': 0.33068644864695435, 'recall': 0.22103939898833694, 'f1-score': 0.2649675891597101, 'support': 100231}, '2': {'precision': 0.403052994942844, 'recall': 0.4634648985260517, 'f1-score': 0.4311530478706999, 'support': 111605}, 'accuracy': 0.38578783362687985, 'macro avg': {'precision': 0.3769767632966144, 'recall': 0.37991670595336524, 'f1-score': 0.37345402033867275, 'support': 324764}, 'weighted avg': {'precision': 0.3786803057786591, 'recall': 0.38578783362687985, 'f1-score': 0.37746036464793864, 'support': 324764}}
[[51410 22970 38548]
 [40016 22155 38060]
 [38008 21872 51725]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1012473
{'0': {'precision': 0.3807263632108589, 'recall': 0.46987201473003953, 'f1-score': 0.420627802690583, 'support': 110794}, '1': {'precision': 0.33571059826771954, 'recall': 0.16813337291365427, 'f1-score': 0.22405410578702226, 'support': 104429}, '2': {'precision': 0.3864227456585646, 'recall': 0.47879789302635545, 'f1-score': 0.42767911019782445, 'support': 109541}, 'accuracy': 0.3758575457870946, 'macro avg': {'precision': 0.3676199023790477, 'recall': 0.37226776022334973, 'f1-score': 0.35745367289180985, 'support': 324764}, 'weighted avg': {'precision': 0.36817274308195613, 'recall': 0.3758575457870946, 'f1-score': 0.359797207802322, 'support': 324764}}
[[52059 17861 40874]
 [44466 17558 42405]
 [40211 16882 52448]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1100805
{'0': {'precision': 0.3616920615042093, 'recall': 0.48194535863609816, 'f1-score': 0.41324817068566005, 'support': 107867}, '1': {'precision': 0.3387811413865379, 'recall': 0.11650760050365883, 'f1-score': 0.17338701464467815, 'support': 109598}, '2': {'precision': 0.3699936515909392, 'recall': 0.49428233254736764, 'f1-score': 0.42320121926891746, 'support': 107299}, 'accuracy': 0.36269722013523664, 'macro avg': {'precision': 0.35682228482722883, 'recall': 0.36424509722904147, 'f1-score': 0.33661213486641856, 'support': 324764}, 'weighted avg': {'precision': 0.35670308887072616, 'recall': 0.36269722013523664, 'f1-score': 0.33559069996894086, 'support': 324764}}
[[51986 12823 43058]
 [49580 12769 47249]
 [42164 12099 53036]]
Evaluating performance on  train set...
486/486 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0876163
{'0': {'precision': 0.40709717706337073, 'recall': 0.45802747292681156, 'f1-score': 0.43106317973506003, 'support': 41277}, '1': {'precision': 0.3904274729571224, 'recall': 0.2922326545543226, 'f1-score': 0.33426782152670265, 'support': 41005}, '2': {'precision': 0.39938882050846736, 'recall': 0.4483834846210659, 'f1-score': 0.42247039676749537, 'support': 41973}, 'accuracy': 0.40005633576113636, 'macro avg': {'precision': 0.39897115684298684, 'recall': 0.3995478707007334, 'f1-score': 0.39593379934308603, 'support': 124255}, 'weighted avg': {'precision': 0.39899219886083825, 'recall': 0.40005633576113636, 'f1-score': 0.3962174307283296, 'support': 124255}}
[[18906  9382 12989]
 [13709 11983 15313]
 [13826  9327 18820]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0902493
{'0': {'precision': 0.40138429498958716, 'recall': 0.47660492629945694, 'f1-score': 0.43577239376676347, 'support': 41248}, '1': {'precision': 0.39513079104948, 'recall': 0.24360033030553263, 'f1-score': 0.30139126776645936, 'support': 41174}, '2': {'precision': 0.39147776241156074, 'recall': 0.4669041187579184, 'f1-score': 0.4258770686610121, 'support': 41833}, 'accuracy': 0.3961289284133435, 'macro avg': {'precision': 0.3959976161502093, 'recall': 0.3957031251209693, 'f1-score': 0.38768024339807833, 'support': 124255}, 'weighted avg': {'precision': 0.3959768526446791, 'recall': 0.3961289284133435, 'f1-score': 0.38791146569879503, 'support': 124255}}
[[19659  7750 13839]
 [14622 10030 16522]
 [14697  7604 19532]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0943848
{'0': {'precision': 0.3927231227513637, 'recall': 0.4918243259610959, 'f1-score': 0.4367222706202475, 'support': 41281}, '1': {'precision': 0.3884601981380993, 'recall': 0.18981706723752068, 'f1-score': 0.2550208350355421, 'support': 41108}, '2': {'precision': 0.3847913093196112, 'recall': 0.48225290211627575, 'f1-score': 0.4280444369063772, 'support': 41866}, 'accuracy': 0.3886845599774657, 'macro avg': {'precision': 0.38865821006969137, 'recall': 0.3879647651049641, 'f1-score': 0.3732625141873889, 'support': 124255}, 'weighted avg': {'precision': 0.38864028016043517, 'recall': 0.3886845599774657, 'f1-score': 0.37368505843336597, 'support': 124255}}
[[20303  6244 14734]
 [15759  7803 17546]
 [15636  6040 20190]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1014198
{'0': {'precision': 0.3809156236790355, 'recall': 0.5021806551657297, 'f1-score': 0.4332222024811095, 'support': 41272}, '1': {'precision': 0.37077821795474386, 'recall': 0.13434542490815757, 'f1-score': 0.19722837345524682, 'support': 41103}, '2': {'precision': 0.37546177503594114, 'recall': 0.49264565425023876, 'f1-score': 0.4261445198335244, 'support': 41880}, 'accuracy': 0.37728864029616516, 'macro avg': {'precision': 0.37571853888990675, 'recall': 0.37639057810804205, 'f1-score': 0.3521983652566269, 'support': 124255}, 'weighted avg': {'precision': 0.37572400186374955, 'recall': 0.37728864029616516, 'f1-score': 0.35277097151470255, 'support': 124255}}
[[20726  4807 15739]
 [17001  5522 18580]
 [16684  4564 20632]]
Evaluating performance on  val set...
178/178 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0811543
{'0': {'precision': 0.40541868894759475, 'recall': 0.44602906387293006, 'f1-score': 0.4247554067971163, 'support': 14795}, '1': {'precision': 0.43638287864534336, 'recall': 0.24976443666711537, 'f1-score': 0.31769540279085695, 'support': 14858}, '2': {'precision': 0.4260089686098655, 'recall': 0.5568160332766119, 'f1-score': 0.4827077528274054, 'support': 15867}, 'accuracy': 0.42058435852372583, 'macro avg': {'precision': 0.4226035120676012, 'recall': 0.4175365112722191, 'f1-score': 0.4083861874717929, 'support': 45520}, 'weighted avg': {'precision': 0.4227027816086316, 'recall': 0.42058435852372583, 'f1-score': 0.4100109501832674, 'support': 45520}}
[[6599 2477 5719]
 [4962 3711 6185]
 [4716 2316 8835]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.085355
{'0': {'precision': 0.4013855421686747, 'recall': 0.44631254605130954, 'f1-score': 0.42265850486853374, 'support': 14929}, '1': {'precision': 0.44938758271153034, 'recall': 0.212318744179859, 'f1-score': 0.2883859601572029, 'support': 15034}, '2': {'precision': 0.40780125590136135, 'recall': 0.5718968952882947, 'f1-score': 0.4761063841173008, 'support': 15557}, 'accuracy': 0.41195079086115993, 'macro avg': {'precision': 0.41952479359385547, 'recall': 0.4101760618398211, 'f1-score': 0.3957169497143458, 'support': 45520}, 'weighted avg': {'precision': 0.41943193795208195, 'recall': 0.41195079086115993, 'f1-score': 0.3965784350153466, 'support': 45520}}
[[6663 2024 6242]
 [5164 3192 6678]
 [4773 1887 8897]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0919409
{'0': {'precision': 0.39415542331938963, 'recall': 0.4468937875751503, 'f1-score': 0.4188711141721191, 'support': 14970}, '1': {'precision': 0.44051390355508624, 'recall': 0.16463855817930673, 'f1-score': 0.23969355997127126, 'support': 15203}, '2': {'precision': 0.3919527662366062, 'recall': 0.5839577767641885, 'f1-score': 0.4690673086988381, 'support': 15347}, 'accuracy': 0.39883567662565905, 'macro avg': {'precision': 0.40887403103702735, 'recall': 0.39849670750621513, 'f1-score': 0.37587732761407616, 'support': 45520}, 'weighted avg': {'precision': 0.40889584064746126, 'recall': 0.39883567662565905, 'f1-score': 0.375952059710038, 'support': 45520}}
[[6690 1660 6620]
 [5417 2503 7283]
 [4866 1519 8962]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0979012
{'0': {'precision': 0.38215536544755124, 'recall': 0.4450387804225729, 'f1-score': 0.4112068699224662, 'support': 14956}, '1': {'precision': 0.42184512428298276, 'recall': 0.11676369409896799, 'f1-score': 0.18290155440414507, 'support': 15116}, '2': {'precision': 0.3850077344370584, 'recall': 0.5961289487312273, 'f1-score': 0.4678537861660782, 'support': 15448}, 'accuracy': 0.3873022847100176, 'macro avg': {'precision': 0.3963360747225308, 'recall': 0.38597714108425607, 'f1-score': 0.35398740349756314, 'support': 45520}, 'weighted avg': {'precision': 0.3963032958233485, 'recall': 0.3873022847100176, 'f1-score': 0.3546167647545483, 'support': 45520}}
[[6656 1287 7013]
 [5654 1765 7697]
 [5107 1132 9209]]
training model: results/CHTR/W0/deepOF_L1/seq2seq
Epoch 1/50
486/486 - 17s - loss: 13.0834 - accuracy10: 0.3898 - accuracy20: 0.3875 - accuracy30: 0.3845 - accuracy50: 0.3819 - val_loss: 13.4248 - val_accuracy10: 0.3690 - val_accuracy20: 0.3697 - val_accuracy30: 0.3663 - val_accuracy50: 0.3617 - 17s/epoch - 34ms/step
Epoch 2/50
486/486 - 11s - loss: 12.9897 - accuracy10: 0.4045 - accuracy20: 0.3993 - accuracy30: 0.3953 - accuracy50: 0.3907 - val_loss: 13.2588 - val_accuracy10: 0.3774 - val_accuracy20: 0.3781 - val_accuracy30: 0.3726 - val_accuracy50: 0.3689 - 11s/epoch - 22ms/step
Epoch 3/50
486/486 - 11s - loss: 12.9453 - accuracy10: 0.4109 - accuracy20: 0.4047 - accuracy30: 0.4012 - accuracy50: 0.3964 - val_loss: 13.1993 - val_accuracy10: 0.3797 - val_accuracy20: 0.3817 - val_accuracy30: 0.3767 - val_accuracy50: 0.3718 - 11s/epoch - 23ms/step
Epoch 4/50
486/486 - 11s - loss: 12.9102 - accuracy10: 0.4174 - accuracy20: 0.4114 - accuracy30: 0.4053 - accuracy50: 0.3994 - val_loss: 13.1532 - val_accuracy10: 0.3872 - val_accuracy20: 0.3890 - val_accuracy30: 0.3834 - val_accuracy50: 0.3777 - 11s/epoch - 22ms/step
Epoch 5/50
486/486 - 11s - loss: 12.8873 - accuracy10: 0.4210 - accuracy20: 0.4148 - accuracy30: 0.4075 - accuracy50: 0.4003 - val_loss: 13.1009 - val_accuracy10: 0.3947 - val_accuracy20: 0.3932 - val_accuracy30: 0.3849 - val_accuracy50: 0.3775 - 11s/epoch - 23ms/step
Epoch 6/50
486/486 - 12s - loss: 12.8673 - accuracy10: 0.4262 - accuracy20: 0.4190 - accuracy30: 0.4092 - accuracy50: 0.4020 - val_loss: 13.0992 - val_accuracy10: 0.4000 - val_accuracy20: 0.3924 - val_accuracy30: 0.3855 - val_accuracy50: 0.3773 - 12s/epoch - 24ms/step
Epoch 7/50
486/486 - 11s - loss: 12.8474 - accuracy10: 0.4290 - accuracy20: 0.4228 - accuracy30: 0.4138 - accuracy50: 0.4047 - val_loss: 13.0663 - val_accuracy10: 0.4063 - val_accuracy20: 0.3990 - val_accuracy30: 0.3918 - val_accuracy50: 0.3820 - 11s/epoch - 22ms/step
Epoch 8/50
486/486 - 12s - loss: 12.8298 - accuracy10: 0.4318 - accuracy20: 0.4252 - accuracy30: 0.4147 - accuracy50: 0.4061 - val_loss: 13.1092 - val_accuracy10: 0.3986 - val_accuracy20: 0.3951 - val_accuracy30: 0.3886 - val_accuracy50: 0.3799 - 12s/epoch - 24ms/step
Epoch 9/50
486/486 - 11s - loss: 12.8198 - accuracy10: 0.4322 - accuracy20: 0.4267 - accuracy30: 0.4172 - accuracy50: 0.4072 - val_loss: 13.0495 - val_accuracy10: 0.4123 - val_accuracy20: 0.4043 - val_accuracy30: 0.3956 - val_accuracy50: 0.3854 - 11s/epoch - 22ms/step
Epoch 10/50
486/486 - 10s - loss: 12.8079 - accuracy10: 0.4356 - accuracy20: 0.4284 - accuracy30: 0.4182 - accuracy50: 0.4080 - val_loss: 13.0727 - val_accuracy10: 0.4108 - val_accuracy20: 0.4019 - val_accuracy30: 0.3937 - val_accuracy50: 0.3834 - 10s/epoch - 21ms/step
Epoch 11/50
486/486 - 11s - loss: 12.7945 - accuracy10: 0.4360 - accuracy20: 0.4307 - accuracy30: 0.4202 - accuracy50: 0.4099 - val_loss: 13.0695 - val_accuracy10: 0.4074 - val_accuracy20: 0.4004 - val_accuracy30: 0.3917 - val_accuracy50: 0.3826 - 11s/epoch - 22ms/step
Epoch 12/50
486/486 - 11s - loss: 12.7798 - accuracy10: 0.4377 - accuracy20: 0.4321 - accuracy30: 0.4219 - accuracy50: 0.4110 - val_loss: 13.0700 - val_accuracy10: 0.4118 - val_accuracy20: 0.4018 - val_accuracy30: 0.3931 - val_accuracy50: 0.3823 - 11s/epoch - 22ms/step
Epoch 13/50
486/486 - 10s - loss: 12.7687 - accuracy10: 0.4403 - accuracy20: 0.4351 - accuracy30: 0.4236 - accuracy50: 0.4126 - val_loss: 13.0559 - val_accuracy10: 0.4095 - val_accuracy20: 0.4032 - val_accuracy30: 0.3943 - val_accuracy50: 0.3846 - 10s/epoch - 21ms/step
Epoch 14/50
486/486 - 11s - loss: 12.7611 - accuracy10: 0.4413 - accuracy20: 0.4360 - accuracy30: 0.4263 - accuracy50: 0.4147 - val_loss: 13.0262 - val_accuracy10: 0.4169 - val_accuracy20: 0.4069 - val_accuracy30: 0.3981 - val_accuracy50: 0.3894 - 11s/epoch - 22ms/step
Epoch 15/50
486/486 - 11s - loss: 12.7478 - accuracy10: 0.4423 - accuracy20: 0.4380 - accuracy30: 0.4274 - accuracy50: 0.4160 - val_loss: 13.0212 - val_accuracy10: 0.4194 - val_accuracy20: 0.4094 - val_accuracy30: 0.3988 - val_accuracy50: 0.3896 - 11s/epoch - 23ms/step
Epoch 16/50
486/486 - 10s - loss: 12.7319 - accuracy10: 0.4443 - accuracy20: 0.4397 - accuracy30: 0.4299 - accuracy50: 0.4170 - val_loss: 13.0179 - val_accuracy10: 0.4208 - val_accuracy20: 0.4100 - val_accuracy30: 0.3979 - val_accuracy50: 0.3872 - 10s/epoch - 21ms/step
Epoch 17/50
486/486 - 10s - loss: 12.7233 - accuracy10: 0.4447 - accuracy20: 0.4414 - accuracy30: 0.4307 - accuracy50: 0.4178 - val_loss: 13.0153 - val_accuracy10: 0.4189 - val_accuracy20: 0.4097 - val_accuracy30: 0.3979 - val_accuracy50: 0.3874 - 10s/epoch - 21ms/step
Epoch 18/50
486/486 - 11s - loss: 12.7082 - accuracy10: 0.4480 - accuracy20: 0.4437 - accuracy30: 0.4329 - accuracy50: 0.4206 - val_loss: 13.0133 - val_accuracy10: 0.4211 - val_accuracy20: 0.4108 - val_accuracy30: 0.3990 - val_accuracy50: 0.3904 - 11s/epoch - 22ms/step
Epoch 19/50
486/486 - 11s - loss: 12.6980 - accuracy10: 0.4486 - accuracy20: 0.4436 - accuracy30: 0.4332 - accuracy50: 0.4201 - val_loss: 13.0219 - val_accuracy10: 0.4195 - val_accuracy20: 0.4096 - val_accuracy30: 0.3989 - val_accuracy50: 0.3907 - 11s/epoch - 23ms/step
Epoch 20/50
486/486 - 10s - loss: 12.6790 - accuracy10: 0.4499 - accuracy20: 0.4466 - accuracy30: 0.4371 - accuracy50: 0.4241 - val_loss: 13.0345 - val_accuracy10: 0.4192 - val_accuracy20: 0.4090 - val_accuracy30: 0.3983 - val_accuracy50: 0.3901 - 10s/epoch - 21ms/step
Epoch 21/50
486/486 - 11s - loss: 12.6719 - accuracy10: 0.4494 - accuracy20: 0.4472 - accuracy30: 0.4369 - accuracy50: 0.4241 - val_loss: 13.0361 - val_accuracy10: 0.4221 - val_accuracy20: 0.4087 - val_accuracy30: 0.3978 - val_accuracy50: 0.3870 - 11s/epoch - 22ms/step
Epoch 22/50
486/486 - 11s - loss: 12.6600 - accuracy10: 0.4501 - accuracy20: 0.4479 - accuracy30: 0.4383 - accuracy50: 0.4255 - val_loss: 13.0470 - val_accuracy10: 0.4212 - val_accuracy20: 0.4092 - val_accuracy30: 0.3983 - val_accuracy50: 0.3887 - 11s/epoch - 22ms/step
Epoch 23/50
486/486 - 10s - loss: 12.6451 - accuracy10: 0.4531 - accuracy20: 0.4498 - accuracy30: 0.4407 - accuracy50: 0.4276 - val_loss: 13.0322 - val_accuracy10: 0.4212 - val_accuracy20: 0.4090 - val_accuracy30: 0.3972 - val_accuracy50: 0.3881 - 10s/epoch - 20ms/step
Epoch 24/50
486/486 - 11s - loss: 12.6289 - accuracy10: 0.4537 - accuracy20: 0.4521 - accuracy30: 0.4424 - accuracy50: 0.4295 - val_loss: 13.0502 - val_accuracy10: 0.4223 - val_accuracy20: 0.4094 - val_accuracy30: 0.3985 - val_accuracy50: 0.3872 - 11s/epoch - 22ms/step
Epoch 25/50
486/486 - 10s - loss: 12.6186 - accuracy10: 0.4550 - accuracy20: 0.4524 - accuracy30: 0.4427 - accuracy50: 0.4307 - val_loss: 13.0826 - val_accuracy10: 0.4178 - val_accuracy20: 0.4055 - val_accuracy30: 0.3933 - val_accuracy50: 0.3856 - 10s/epoch - 21ms/step
Epoch 26/50
486/486 - 10s - loss: 12.6092 - accuracy10: 0.4557 - accuracy20: 0.4546 - accuracy30: 0.4439 - accuracy50: 0.4319 - val_loss: 13.1080 - val_accuracy10: 0.4145 - val_accuracy20: 0.4025 - val_accuracy30: 0.3912 - val_accuracy50: 0.3840 - 10s/epoch - 21ms/step
Epoch 27/50
486/486 - 11s - loss: 12.5943 - accuracy10: 0.4562 - accuracy20: 0.4559 - accuracy30: 0.4475 - accuracy50: 0.4354 - val_loss: 13.1108 - val_accuracy10: 0.4145 - val_accuracy20: 0.4032 - val_accuracy30: 0.3917 - val_accuracy50: 0.3837 - 11s/epoch - 23ms/step
Epoch 28/50
486/486 - 10s - loss: 12.5866 - accuracy10: 0.4572 - accuracy20: 0.4574 - accuracy30: 0.4494 - accuracy50: 0.4351 - val_loss: 13.0791 - val_accuracy10: 0.4168 - val_accuracy20: 0.4051 - val_accuracy30: 0.3958 - val_accuracy50: 0.3859 - 10s/epoch - 21ms/step
testing model: results/CHTR/W0/deepOF_L1/seq2seq
Evaluating performance on  test set...
1269/1269 - 12s - 12s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0739422
{'0': {'precision': 0.4185704789560228, 'recall': 0.530422600152512, 'f1-score': 0.46790487029367245, 'support': 112778}, '1': {'precision': 0.4133742768623365, 'recall': 0.29824144956778037, 'f1-score': 0.34649415117321264, 'support': 101106}, '2': {'precision': 0.4251042259729288, 'recall': 0.41752423900789176, 'f1-score': 0.4212801390525679, 'support': 110875}, 'accuracy': 0.41959422217706055, 'macro avg': {'precision': 0.41901632726376264, 'recall': 0.41539609624272805, 'f1-score': 0.41189305350648436, 'support': 324759}, 'weighted avg': {'precision': 0.4191834319199597, 'recall': 0.41959422217706055, 'f1-score': 0.4141885168015424, 'support': 324759}}
[[59820 21082 31876]
 [40223 30154 30729]
 [42872 21710 46293]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0762265
{'0': {'precision': 0.4140400961897046, 'recall': 0.5702318332359244, 'f1-score': 0.47974311981285295, 'support': 112926}, '1': {'precision': 0.4089991735060642, 'recall': 0.21230170607602514, 'f1-score': 0.279514242366525, 'support': 100230}, '2': {'precision': 0.4196372199375459, 'recall': 0.4407049989695617, 'f1-score': 0.4299131590103536, 'support': 111603}, 'accuracy': 0.4152525411151038, 'macro avg': {'precision': 0.41422549654443824, 'recall': 0.4077461794271704, 'f1-score': 0.3963901737299105, 'support': 324759}, 'weighted avg': {'precision': 0.41440776612663954, 'recall': 0.4152525411151038, 'f1-score': 0.400822709595163, 'support': 324759}}
[[64394 14825 33707]
 [44636 21279 34315]
 [46496 15923 49184]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0838399
{'0': {'precision': 0.3985223349254906, 'recall': 0.6032114232074518, 'f1-score': 0.4799543249464072, 'support': 110792}, '1': {'precision': 0.43721425439969935, 'recall': 0.1336997740069713, 'f1-score': 0.20477845734148808, 'support': 104428}, '2': {'precision': 0.40774247170897, 'recall': 0.46577018230949707, 'f1-score': 0.43482892779981847, 'support': 109539}, 'accuracy': 0.4058794367515604, 'macro avg': {'precision': 0.41449302034471996, 'recall': 0.4008937931746401, 'f1-score': 0.3731872366959046, 'support': 324759}, 'weighted avg': {'precision': 0.41407381873341653, 'recall': 0.4058794367515604, 'f1-score': 0.37624955808763905, 'support': 324759}}
[[66831  8427 35534]
 [51892 13962 38574]
 [48974  9545 51020]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0945095
{'0': {'precision': 0.3777289858188938, 'recall': 0.6188405662738845, 'f1-score': 0.46911732149822366, 'support': 107863}, '1': {'precision': 0.4706642688546701, 'recall': 0.07641562802240917, 'f1-score': 0.1314839236372771, 'support': 109598}, '2': {'precision': 0.39181273080437, 'recall': 0.4756286230871032, 'f1-score': 0.4296713520157947, 'support': 107298}, 'accuracy': 0.38846960361375665, 'macro avg': {'precision': 0.4134019951593113, 'recall': 0.390294939127799, 'f1-score': 0.3434241990504318, 'support': 324759}, 'weighted avg': {'precision': 0.4137454744138415, 'recall': 0.38846960361375665, 'f1-score': 0.34214187579143895, 'support': 324759}}
[[66750  4245 36868]
 [58874  8375 42349]
 [51090  5174 51034]]
Evaluating performance on  train set...
486/486 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0602661
{'0': {'precision': 0.4216741435152588, 'recall': 0.5082070554006546, 'f1-score': 0.4609143083316841, 'support': 41245}, '1': {'precision': 0.49062486832680235, 'recall': 0.28317809285245266, 'f1-score': 0.35909455375316107, 'support': 41119}, '2': {'precision': 0.4200976147366764, 'recall': 0.5095726903795655, 'f1-score': 0.46052943841556815, 'support': 41890}, 'accuracy': 0.4341993014309398, 'macro avg': {'precision': 0.44413220885957916, 'recall': 0.4336526128775576, 'f1-score': 0.42684610016680447, 'support': 124254}, 'weighted avg': {'precision': 0.4439602997998938, 'recall': 0.4341993014309398, 'f1-score': 0.4270896532759081, 'support': 124254}}
[[20961  5912 14372]
 [14381 11644 15094]
 [14367  6177 21346]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0653737
{'0': {'precision': 0.41552161899783435, 'recall': 0.5392890891909573, 'f1-score': 0.46938366636790213, 'support': 41271}, '1': {'precision': 0.4973767691556857, 'recall': 0.19777314185911118, 'f1-score': 0.2830116634268259, 'support': 41224}, '2': {'precision': 0.41368006188073225, 'recall': 0.5378960224143299, 'f1-score': 0.46768064794861386, 'support': 41759}, 'accuracy': 0.42551547636293396, 'macro avg': {'precision': 0.442192816678084, 'recall': 0.4249860844881328, 'f1-score': 0.40669199258111394, 'support': 124254}, 'weighted avg': {'precision': 0.44205996083354343, 'recall': 0.42551547636293396, 'f1-score': 0.40697830480679353, 'support': 124254}}
[[22257  4051 14963]
 [16198  8153 16873]
 [15109  4188 22462]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.073867
{'0': {'precision': 0.4052149277744745, 'recall': 0.560918928078627, 'f1-score': 0.47052014904915174, 'support': 41309}, '1': {'precision': 0.5060008136696501, 'recall': 0.12088739855178111, 'f1-score': 0.19515161024594987, 'support': 41154}, '2': {'precision': 0.40709294199860235, 'recall': 0.5575841688401809, 'f1-score': 0.4706001151154689, 'support': 41791}, 'accuracy': 0.4140550807217474, 'macro avg': {'precision': 0.4394362278142423, 'recall': 0.413130165156863, 'f1-score': 0.37875729147019016, 'support': 124254}, 'weighted avg': {'precision': 0.43922772768892865, 'recall': 0.4140550807217474, 'f1-score': 0.37934260157358146, 'support': 124254}}
[[23171  2440 15698]
 [17939  4975 18240]
 [16072  2417 23302]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0833037
{'0': {'precision': 0.3957895439228639, 'recall': 0.5740624243890636, 'f1-score': 0.4685414115881354, 'support': 41330}, '1': {'precision': 0.5126373626373626, 'recall': 0.06828494754818248, 'f1-score': 0.12051668460710442, 'support': 40990}, '2': {'precision': 0.40264749864056554, 'recall': 0.5650546096246483, 'f1-score': 0.4702228572562561, 'support': 41934}, 'accuracy': 0.4041720990873533, 'macro avg': {'precision': 0.43702480173359737, 'recall': 0.4024673271872981, 'f1-score': 0.3530936511504987, 'support': 124254}, 'weighted avg': {'precision': 0.4366507923514006, 'recall': 0.4041720990873533, 'f1-score': 0.35429942488102345, 'support': 124254}}
[[23726  1320 16284]
 [19322  2799 18869]
 [16898  1341 23695]]
Evaluating performance on  val set...
178/178 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0729225
{'0': {'precision': 0.4050698063436917, 'recall': 0.42638493837193553, 'f1-score': 0.4154541555313603, 'support': 14766}, '1': {'precision': 0.47985299908124424, 'recall': 0.2455504063402512, 'f1-score': 0.3248622711924649, 'support': 14889}, '2': {'precision': 0.40962562061099433, 'recall': 0.5772818961169944, 'f1-score': 0.4792129980900552, 'support': 15864}, 'accuracy': 0.4198246885915771, 'macro avg': {'precision': 0.4315161420119768, 'recall': 0.41640574694306043, 'f1-score': 0.40650980827129346, 'support': 45519}, 'weighted avg': {'precision': 0.4311187176599753, 'recall': 0.4198246885915771, 'f1-score': 0.40804291434480794, 'support': 45519}}
[[6296 2036 6434]
 [4468 3656 6765]
 [4779 1927 9158]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0795494
{'0': {'precision': 0.4012190749372535, 'recall': 0.4507855512286827, 'f1-score': 0.4245605159984824, 'support': 14894}, '1': {'precision': 0.49373338397265476, 'recall': 0.17351841964762413, 'f1-score': 0.25679012345679014, 'support': 14984}, '2': {'precision': 0.39674305880352057, 'recall': 0.5965731091362445, 'f1-score': 0.4765577119509704, 'support': 15641}, 'accuracy': 0.4096091741909972, 'macro avg': {'precision': 0.43056517257114296, 'recall': 0.4069590266708505, 'f1-score': 0.38596945046874764, 'support': 45519}, 'weighted avg': {'precision': 0.4301350229642034, 'recall': 0.4096091741909972, 'f1-score': 0.3872006570395454, 'support': 45519}}
[[6714 1431 6749]
 [4945 2600 7439]
 [5075 1235 9331]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0876497
{'0': {'precision': 0.3942468502620136, 'recall': 0.4725061802632458, 'f1-score': 0.4298434888314846, 'support': 14967}, '1': {'precision': 0.5074534161490684, 'recall': 0.10826210826210826, 'f1-score': 0.17845246546169388, 'support': 15093}, '2': {'precision': 0.3856163540084561, 'recall': 0.6076719063328805, 'f1-score': 0.47182320441988945, 'support': 15459}, 'accuracy': 0.39763615193655394, 'macro avg': {'precision': 0.42910554013984603, 'recall': 0.39614673161941155, 'f1-score': 0.3600397195710226, 'support': 45519}, 'weighted avg': {'precision': 0.4288523525215003, 'recall': 0.39763615193655394, 'f1-score': 0.360745303624448, 'support': 45519}}
[[7072  853 7042]
 [5534 1634 7925]
 [5332  733 9394]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0950433
{'0': {'precision': 0.38659602649006625, 'recall': 0.4893046335412057, 'f1-score': 0.4319284953237836, 'support': 14913}, '1': {'precision': 0.5167820990942994, 'recall': 0.06424266507715742, 'f1-score': 0.1142789820923657, 'support': 15099}, '2': {'precision': 0.38123309242136716, 'recall': 0.6088863094086542, 'f1-score': 0.46888811640264194, 'support': 15507}, 'accuracy': 0.3890463323007975, 'macro avg': {'precision': 0.42820373933524425, 'recall': 0.3874778693423391, 'f1-score': 0.338365197939597, 'support': 45519}, 'weighted avg': {'precision': 0.42795274547879625, 'recall': 0.3890463323007975, 'f1-score': 0.3391527938318501, 'support': 45519}}
[[7297  486 7130]
 [5934  970 8195]
 [5644  421 9442]]
training model: results/CHTR/W0/deepLOB_L2/seq2seq
Epoch 1/50
486/486 - 30s - loss: 13.2000 - accuracy10: 0.3595 - accuracy20: 0.3627 - accuracy30: 0.3601 - accuracy50: 0.3595 - val_loss: 13.5378 - val_accuracy10: 0.3483 - val_accuracy20: 0.3466 - val_accuracy30: 0.3442 - val_accuracy50: 0.3419 - 30s/epoch - 61ms/step
Epoch 2/50
486/486 - 23s - loss: 13.0952 - accuracy10: 0.3700 - accuracy20: 0.3734 - accuracy30: 0.3731 - accuracy50: 0.3730 - val_loss: 13.4737 - val_accuracy10: 0.3472 - val_accuracy20: 0.3466 - val_accuracy30: 0.3443 - val_accuracy50: 0.3421 - 23s/epoch - 48ms/step
Epoch 3/50
486/486 - 23s - loss: 13.0283 - accuracy10: 0.3874 - accuracy20: 0.3882 - accuracy30: 0.3864 - accuracy50: 0.3821 - val_loss: 13.1979 - val_accuracy10: 0.3790 - val_accuracy20: 0.3756 - val_accuracy30: 0.3711 - val_accuracy50: 0.3675 - 23s/epoch - 48ms/step
Epoch 4/50
486/486 - 23s - loss: 12.9826 - accuracy10: 0.3984 - accuracy20: 0.3977 - accuracy30: 0.3954 - accuracy50: 0.3903 - val_loss: 13.1243 - val_accuracy10: 0.3887 - val_accuracy20: 0.3846 - val_accuracy30: 0.3768 - val_accuracy50: 0.3691 - 23s/epoch - 48ms/step
Epoch 5/50
486/486 - 23s - loss: 12.9170 - accuracy10: 0.4103 - accuracy20: 0.4101 - accuracy30: 0.4066 - accuracy50: 0.4001 - val_loss: 13.0627 - val_accuracy10: 0.4066 - val_accuracy20: 0.4029 - val_accuracy30: 0.3940 - val_accuracy50: 0.3814 - 23s/epoch - 48ms/step
Epoch 6/50
486/486 - 24s - loss: 12.8741 - accuracy10: 0.4212 - accuracy20: 0.4181 - accuracy30: 0.4118 - accuracy50: 0.4041 - val_loss: 12.9954 - val_accuracy10: 0.4158 - val_accuracy20: 0.4113 - val_accuracy30: 0.4008 - val_accuracy50: 0.3872 - 24s/epoch - 50ms/step
Epoch 7/50
486/486 - 24s - loss: 12.8188 - accuracy10: 0.4296 - accuracy20: 0.4266 - accuracy30: 0.4202 - accuracy50: 0.4090 - val_loss: 12.9954 - val_accuracy10: 0.4221 - val_accuracy20: 0.4181 - val_accuracy30: 0.4094 - val_accuracy50: 0.3976 - 24s/epoch - 49ms/step
Epoch 8/50
486/486 - 24s - loss: 12.7785 - accuracy10: 0.4351 - accuracy20: 0.4338 - accuracy30: 0.4256 - accuracy50: 0.4129 - val_loss: 12.9906 - val_accuracy10: 0.4193 - val_accuracy20: 0.4126 - val_accuracy30: 0.4053 - val_accuracy50: 0.3918 - 24s/epoch - 49ms/step
Epoch 9/50
486/486 - 24s - loss: 12.7545 - accuracy10: 0.4374 - accuracy20: 0.4351 - accuracy30: 0.4282 - accuracy50: 0.4172 - val_loss: 12.9866 - val_accuracy10: 0.4223 - val_accuracy20: 0.4154 - val_accuracy30: 0.4047 - val_accuracy50: 0.3907 - 24s/epoch - 49ms/step
Epoch 10/50
486/486 - 24s - loss: 12.7200 - accuracy10: 0.4423 - accuracy20: 0.4388 - accuracy30: 0.4320 - accuracy50: 0.4197 - val_loss: 13.0689 - val_accuracy10: 0.4134 - val_accuracy20: 0.4051 - val_accuracy30: 0.3980 - val_accuracy50: 0.3825 - 24s/epoch - 49ms/step
Epoch 11/50
486/486 - 23s - loss: 12.6904 - accuracy10: 0.4464 - accuracy20: 0.4441 - accuracy30: 0.4361 - accuracy50: 0.4230 - val_loss: 13.0317 - val_accuracy10: 0.4182 - val_accuracy20: 0.4121 - val_accuracy30: 0.4034 - val_accuracy50: 0.3924 - 23s/epoch - 48ms/step
Epoch 12/50
486/486 - 24s - loss: 12.6590 - accuracy10: 0.4494 - accuracy20: 0.4468 - accuracy30: 0.4391 - accuracy50: 0.4242 - val_loss: 13.1142 - val_accuracy10: 0.4101 - val_accuracy20: 0.4026 - val_accuracy30: 0.3950 - val_accuracy50: 0.3830 - 24s/epoch - 49ms/step
Epoch 13/50
486/486 - 23s - loss: 12.6246 - accuracy10: 0.4517 - accuracy20: 0.4508 - accuracy30: 0.4423 - accuracy50: 0.4289 - val_loss: 13.1848 - val_accuracy10: 0.4067 - val_accuracy20: 0.3998 - val_accuracy30: 0.3918 - val_accuracy50: 0.3811 - 23s/epoch - 48ms/step
Epoch 14/50
486/486 - 24s - loss: 12.6088 - accuracy10: 0.4541 - accuracy20: 0.4533 - accuracy30: 0.4463 - accuracy50: 0.4298 - val_loss: 13.2151 - val_accuracy10: 0.4027 - val_accuracy20: 0.3971 - val_accuracy30: 0.3900 - val_accuracy50: 0.3775 - 24s/epoch - 48ms/step
Epoch 15/50
486/486 - 24s - loss: 12.5807 - accuracy10: 0.4568 - accuracy20: 0.4556 - accuracy30: 0.4476 - accuracy50: 0.4323 - val_loss: 13.2861 - val_accuracy10: 0.3944 - val_accuracy20: 0.3887 - val_accuracy30: 0.3826 - val_accuracy50: 0.3701 - 24s/epoch - 48ms/step
Epoch 16/50
486/486 - 24s - loss: 12.5534 - accuracy10: 0.4592 - accuracy20: 0.4592 - accuracy30: 0.4508 - accuracy50: 0.4352 - val_loss: 13.2457 - val_accuracy10: 0.4016 - val_accuracy20: 0.3942 - val_accuracy30: 0.3864 - val_accuracy50: 0.3748 - 24s/epoch - 48ms/step
Epoch 17/50
486/486 - 23s - loss: 12.5228 - accuracy10: 0.4616 - accuracy20: 0.4612 - accuracy30: 0.4531 - accuracy50: 0.4368 - val_loss: 13.2098 - val_accuracy10: 0.4067 - val_accuracy20: 0.4030 - val_accuracy30: 0.3958 - val_accuracy50: 0.3831 - 23s/epoch - 48ms/step
Epoch 18/50
486/486 - 23s - loss: 12.4970 - accuracy10: 0.4638 - accuracy20: 0.4650 - accuracy30: 0.4576 - accuracy50: 0.4405 - val_loss: 13.2360 - val_accuracy10: 0.4076 - val_accuracy20: 0.3970 - val_accuracy30: 0.3892 - val_accuracy50: 0.3767 - 23s/epoch - 48ms/step
Epoch 19/50
486/486 - 23s - loss: 12.4761 - accuracy10: 0.4636 - accuracy20: 0.4662 - accuracy30: 0.4578 - accuracy50: 0.4416 - val_loss: 13.2537 - val_accuracy10: 0.4063 - val_accuracy20: 0.4004 - val_accuracy30: 0.3920 - val_accuracy50: 0.3821 - 23s/epoch - 48ms/step
testing model: results/CHTR/W0/deepLOB_L2/seq2seq
Evaluating performance on  test set...
1269/1269 - 23s - 23s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0843104
{'0': {'precision': 0.4098374005809061, 'recall': 0.5354802670662612, 'f1-score': 0.4643091909263196, 'support': 112781}, '1': {'precision': 0.42362096063173227, 'recall': 0.10930112950764544, 'f1-score': 0.17376742430794145, 'support': 101106}, '2': {'precision': 0.403004209594174, 'recall': 0.5500058623519756, 'f1-score': 0.465167545137644, 'support': 110877}, 'accuracy': 0.4077607123942309, 'macro avg': {'precision': 0.41215419026893746, 'recall': 0.3982624196419608, 'f1-score': 0.3677480534573017, 'support': 324764}, 'weighted avg': {'precision': 0.41179561302274986, 'recall': 0.4077607123942309, 'f1-score': 0.3741503552307723, 'support': 324764}}
[[60392  8165 44224]
 [43941 11051 46114]
 [43023  6871 60983]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.085952
{'0': {'precision': 0.40220785159056766, 'recall': 0.5452500708415982, 'f1-score': 0.46293107985173937, 'support': 112928}, '1': {'precision': 0.40621919526839323, 'recall': 0.09045105805589089, 'f1-score': 0.147957143673143, 'support': 100231}, '2': {'precision': 0.4020795950614639, 'recall': 0.5380852112360557, 'f1-score': 0.46024501745471547, 'support': 111605}, 'accuracy': 0.4024245298124176, 'macro avg': {'precision': 0.40350221397347497, 'recall': 0.3912621133778482, 'f1-score': 0.3570444136598659, 'support': 324764}, 'weighted avg': {'precision': 0.4034017860113825, 'recall': 0.4024245298124176, 'f1-score': 0.36479849560306415, 'support': 324764}}
[[61574  7224 44130]
 [45992  9066 45173]
 [45524  6028 60053]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0914733
{'0': {'precision': 0.3898803301847945, 'recall': 0.5554723179955593, 'f1-score': 0.4581734258966294, 'support': 110794}, '1': {'precision': 0.4129526462395543, 'recall': 0.07382049047678327, 'f1-score': 0.12525081846023867, 'support': 104429}, '2': {'precision': 0.39211440520759555, 'recall': 0.5306597529692079, 'f1-score': 0.4509864771554701, 'support': 109541}, 'accuracy': 0.39222635513788473, 'macro avg': {'precision': 0.39831579387731475, 'recall': 0.38665085381385017, 'f1-score': 0.34480357383744603, 'support': 324764}, 'weighted avg': {'precision': 0.3980528545574317, 'recall': 0.39222635513788473, 'f1-score': 0.34869688131647214, 'support': 324764}}
[[61543  6065 43186]
 [49790  7709 46930]
 [46518  4894 58129]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0991664
{'0': {'precision': 0.3709105585048586, 'recall': 0.5538023677306313, 'f1-score': 0.44427008574977134, 'support': 107867}, '1': {'precision': 0.41097145849698874, 'recall': 0.05728206719100713, 'f1-score': 0.10054935374857855, 'support': 109598}, '2': {'precision': 0.38178167927617174, 'recall': 0.5281409891984082, 'f1-score': 0.44319052758356403, 'support': 107299}, 'accuracy': 0.37776354522052935, 'macro avg': {'precision': 0.3878878987593397, 'recall': 0.3797418080400156, 'f1-score': 0.3293366556939713, 'support': 324764}, 'weighted avg': {'precision': 0.3880216142406501, 'recall': 0.37776354522052935, 'f1-score': 0.32791808769104996, 'support': 324764}}
[[59737  4937 43193]
 [54749  6278 48571]
 [46569  4061 56669]]
Evaluating performance on  train set...
486/486 - 8s - 8s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.074515
{'0': {'precision': 0.4315524759891918, 'recall': 0.39079874990915037, 'f1-score': 0.4101657851912124, 'support': 41277}, '1': {'precision': 0.46673008561558105, 'recall': 0.2273381294964029, 'f1-score': 0.30574961461510713, 'support': 41005}, '2': {'precision': 0.3905056574443597, 'recall': 0.6224477640387869, 'f1-score': 0.4799221132297292, 'support': 41973}, 'accuracy': 0.4151060319504245, 'macro avg': {'precision': 0.4295960730163775, 'recall': 0.4135282144814467, 'f1-score': 0.3986125043453496, 'support': 124255}, 'weighted avg': {'precision': 0.42929582448983844, 'recall': 0.4151060319504245, 'f1-score': 0.39927123191196784, 'support': 124255}}
[[16131  5499 19647]
 [10553  9322 21130]
 [10695  5152 26126]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0769148
{'0': {'precision': 0.42814902424600826, 'recall': 0.4037044220325834, 'f1-score': 0.41556756217167246, 'support': 41248}, '1': {'precision': 0.4603432802333408, 'recall': 0.19932481663185506, 'f1-score': 0.2781939595267957, 'support': 41174}, '2': {'precision': 0.3870050641158528, 'recall': 0.6247699184854063, 'f1-score': 0.47795038722832306, 'support': 41833}, 'accuracy': 0.4104060198784757, 'macro avg': {'precision': 0.425165789531734, 'recall': 0.40926638571661494, 'f1-score': 0.39057063630893046, 'support': 124255}, 'weighted avg': {'precision': 0.4249651766092744, 'recall': 0.4104060198784757, 'f1-score': 0.39104895129319434, 'support': 124255}}
[[16652  5059 19537]
 [11106  8207 21861]
 [11135  4562 26136]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0806584
{'0': {'precision': 0.4199653207827595, 'recall': 0.41069741527579273, 'f1-score': 0.41527966589509013, 'support': 41281}, '1': {'precision': 0.45140127388535034, 'recall': 0.17239953293762772, 'f1-score': 0.24950711167441203, 'support': 41108}, '2': {'precision': 0.3828701327271394, 'recall': 0.6235608847274638, 'f1-score': 0.4744345803309375, 'support': 41866}, 'accuracy': 0.403581344815098, 'macro avg': {'precision': 0.4180789091317498, 'recall': 0.40221927764696147, 'f1-score': 0.37974045263347994, 'support': 124255}, 'weighted avg': {'precision': 0.41786674943355595, 'recall': 0.403581344815098, 'f1-score': 0.3803676019046475, 'support': 124255}}
[[16954  4541 19786]
 [11728  7087 22293]
 [11688  4072 26106]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0869676
{'0': {'precision': 0.4069602443541211, 'recall': 0.40998740065904243, 'f1-score': 0.4084682140227638, 'support': 41272}, '1': {'precision': 0.4282541092847623, 'recall': 0.14071965549959856, 'f1-score': 0.21183321430533425, 'support': 41103}, '2': {'precision': 0.37844441231747866, 'recall': 0.6250477554918815, 'f1-score': 0.47144529491220166, 'support': 41880}, 'accuracy': 0.39340066798116774, 'macro avg': {'precision': 0.404552921985454, 'recall': 0.3919182705501742, 'f1-score': 0.36391557441343325, 'support': 124255}, 'weighted avg': {'precision': 0.4043929326527776, 'recall': 0.39340066798116774, 'f1-score': 0.364648583056317, 'support': 124255}}
[[16921  4074 20277]
 [12603  5784 22716]
 [12055  3648 26177]]
Evaluating performance on  val set...
178/178 - 3s - 3s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.077047
{'0': {'precision': 0.40805428158572593, 'recall': 0.4389996620479892, 'f1-score': 0.4229617087783277, 'support': 14795}, '1': {'precision': 0.43149081742888007, 'recall': 0.3225871584331673, 'f1-score': 0.36917507509820535, 'support': 14858}, '2': {'precision': 0.42476344958096784, 'recall': 0.4951156488309069, 'f1-score': 0.4572492870030848, 'support': 15867}, 'accuracy': 0.4205623901581722, 'macro avg': {'precision': 0.4214361828651913, 'recall': 0.41890082310402116, 'f1-score': 0.4164620236265393, 'support': 45520}, 'weighted avg': {'precision': 0.42152845597364524, 'recall': 0.4205623901581722, 'f1-score': 0.41735712179399037, 'support': 45520}}
[[6495 3144 5156]
 [4582 4793 5483]
 [4840 3171 7856]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0781401
{'0': {'precision': 0.40335836338910896, 'recall': 0.45696295800120573, 'f1-score': 0.4284906726964387, 'support': 14929}, '1': {'precision': 0.43675771971496435, 'recall': 0.293534654782493, 'f1-score': 0.3511019174158644, 'support': 15034}, '2': {'precision': 0.4147435550991731, 'recall': 0.4932827666002443, 'f1-score': 0.4506165590135056, 'support': 15557}, 'accuracy': 0.4153998242530756, 'macro avg': {'precision': 0.4182865460677488, 'recall': 0.4145934597946477, 'f1-score': 0.41006971637526957, 'support': 45520}, 'weighted avg': {'precision': 0.4182802735480804, 'recall': 0.4153998242530756, 'f1-score': 0.41049308628489334, 'support': 45520}}
[[6822 2902 5205]
 [4997 4413 5624]
 [5094 2789 7674]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0835519
{'0': {'precision': 0.39633262735480995, 'recall': 0.47501670006680025, 'f1-score': 0.4321220223626641, 'support': 14970}, '1': {'precision': 0.42811146885755524, 'recall': 0.25363415115437743, 'f1-score': 0.3185460553490293, 'support': 15203}, '2': {'precision': 0.4050401163103764, 'recall': 0.4901283638496123, 'f1-score': 0.4435403030839083, 'support': 15347}, 'accuracy': 0.4061731107205624, 'macro avg': {'precision': 0.4098280708409138, 'recall': 0.40625973835692997, 'f1-score': 0.39806946026520057, 'support': 45520}, 'weighted avg': {'precision': 0.40988200258256297, 'recall': 0.4061731107205624, 'f1-score': 0.39803900232137773, 'support': 45520}}
[[7111 2665 5194]
 [5492 3856 5855]
 [5339 2486 7522]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0902636
{'0': {'precision': 0.384797350575619, 'recall': 0.489435677988767, 'f1-score': 0.4308543512169281, 'support': 14956}, '1': {'precision': 0.40973657024793386, 'recall': 0.2099100291082297, 'f1-score': 0.2776027996500438, 'support': 15116}, '2': {'precision': 0.39417693169092943, 'recall': 0.4785085447954428, 'f1-score': 0.43226806233735854, 'support': 15448}, 'accuracy': 0.3929042179261863, 'macro avg': {'precision': 0.39623695083816074, 'recall': 0.3926180839641465, 'f1-score': 0.3802417377347768, 'support': 45520}, 'weighted avg': {'precision': 0.3962621355851978, 'recall': 0.3929042179261863, 'f1-score': 0.38044329137297794, 'support': 45520}}
[[7320 2285 5351]
 [5933 3173 6010]
 [5770 2286 7392]]
training model: results/CHTR/W0/deepOF_L2/seq2seq
Epoch 1/50
486/486 - 20s - loss: 13.1078 - accuracy10: 0.3886 - accuracy20: 0.3855 - accuracy30: 0.3829 - accuracy50: 0.3779 - val_loss: 13.2694 - val_accuracy10: 0.3771 - val_accuracy20: 0.3765 - val_accuracy30: 0.3752 - val_accuracy50: 0.3734 - 20s/epoch - 41ms/step
Epoch 2/50
486/486 - 15s - loss: 12.9476 - accuracy10: 0.4160 - accuracy20: 0.4083 - accuracy30: 0.4022 - accuracy50: 0.3953 - val_loss: 13.0997 - val_accuracy10: 0.4066 - val_accuracy20: 0.3920 - val_accuracy30: 0.3837 - val_accuracy50: 0.3818 - 15s/epoch - 30ms/step
Epoch 3/50
486/486 - 14s - loss: 12.8738 - accuracy10: 0.4266 - accuracy20: 0.4195 - accuracy30: 0.4098 - accuracy50: 0.4035 - val_loss: 13.0447 - val_accuracy10: 0.4173 - val_accuracy20: 0.3998 - val_accuracy30: 0.3879 - val_accuracy50: 0.3833 - 14s/epoch - 30ms/step
Epoch 4/50
486/486 - 14s - loss: 12.8274 - accuracy10: 0.4332 - accuracy20: 0.4257 - accuracy30: 0.4167 - accuracy50: 0.4074 - val_loss: 13.0396 - val_accuracy10: 0.4184 - val_accuracy20: 0.4016 - val_accuracy30: 0.3911 - val_accuracy50: 0.3854 - 14s/epoch - 29ms/step
Epoch 5/50
486/486 - 14s - loss: 12.7941 - accuracy10: 0.4375 - accuracy20: 0.4312 - accuracy30: 0.4207 - accuracy50: 0.4107 - val_loss: 12.9702 - val_accuracy10: 0.4262 - val_accuracy20: 0.4117 - val_accuracy30: 0.3997 - val_accuracy50: 0.3897 - 14s/epoch - 30ms/step
Epoch 6/50
486/486 - 15s - loss: 12.7607 - accuracy10: 0.4417 - accuracy20: 0.4358 - accuracy30: 0.4248 - accuracy50: 0.4139 - val_loss: 12.9599 - val_accuracy10: 0.4280 - val_accuracy20: 0.4109 - val_accuracy30: 0.3988 - val_accuracy50: 0.3882 - 15s/epoch - 30ms/step
Epoch 7/50
486/486 - 14s - loss: 12.7313 - accuracy10: 0.4454 - accuracy20: 0.4399 - accuracy30: 0.4288 - accuracy50: 0.4169 - val_loss: 12.9405 - val_accuracy10: 0.4269 - val_accuracy20: 0.4153 - val_accuracy30: 0.4006 - val_accuracy50: 0.3897 - 14s/epoch - 29ms/step
Epoch 8/50
486/486 - 14s - loss: 12.6995 - accuracy10: 0.4492 - accuracy20: 0.4435 - accuracy30: 0.4328 - accuracy50: 0.4211 - val_loss: 12.9352 - val_accuracy10: 0.4314 - val_accuracy20: 0.4183 - val_accuracy30: 0.4065 - val_accuracy50: 0.3950 - 14s/epoch - 29ms/step
Epoch 9/50
486/486 - 14s - loss: 12.6713 - accuracy10: 0.4498 - accuracy20: 0.4471 - accuracy30: 0.4359 - accuracy50: 0.4236 - val_loss: 12.9427 - val_accuracy10: 0.4309 - val_accuracy20: 0.4160 - val_accuracy30: 0.4049 - val_accuracy50: 0.3928 - 14s/epoch - 30ms/step
Epoch 10/50
486/486 - 15s - loss: 12.6392 - accuracy10: 0.4556 - accuracy20: 0.4511 - accuracy30: 0.4400 - accuracy50: 0.4260 - val_loss: 12.9368 - val_accuracy10: 0.4300 - val_accuracy20: 0.4174 - val_accuracy30: 0.4037 - val_accuracy50: 0.3934 - 15s/epoch - 32ms/step
Epoch 11/50
486/486 - 14s - loss: 12.6099 - accuracy10: 0.4578 - accuracy20: 0.4537 - accuracy30: 0.4429 - accuracy50: 0.4294 - val_loss: 12.9655 - val_accuracy10: 0.4277 - val_accuracy20: 0.4157 - val_accuracy30: 0.4044 - val_accuracy50: 0.3939 - 14s/epoch - 29ms/step
Epoch 12/50
486/486 - 14s - loss: 12.5783 - accuracy10: 0.4608 - accuracy20: 0.4569 - accuracy30: 0.4457 - accuracy50: 0.4307 - val_loss: 12.9795 - val_accuracy10: 0.4271 - val_accuracy20: 0.4133 - val_accuracy30: 0.4022 - val_accuracy50: 0.3912 - 14s/epoch - 29ms/step
Epoch 13/50
486/486 - 14s - loss: 12.5495 - accuracy10: 0.4624 - accuracy20: 0.4606 - accuracy30: 0.4499 - accuracy50: 0.4345 - val_loss: 12.9981 - val_accuracy10: 0.4244 - val_accuracy20: 0.4140 - val_accuracy30: 0.4019 - val_accuracy50: 0.3921 - 14s/epoch - 29ms/step
Epoch 14/50
486/486 - 14s - loss: 12.5172 - accuracy10: 0.4649 - accuracy20: 0.4644 - accuracy30: 0.4529 - accuracy50: 0.4376 - val_loss: 13.0100 - val_accuracy10: 0.4246 - val_accuracy20: 0.4119 - val_accuracy30: 0.4012 - val_accuracy50: 0.3911 - 14s/epoch - 29ms/step
Epoch 15/50
486/486 - 14s - loss: 12.4909 - accuracy10: 0.4674 - accuracy20: 0.4672 - accuracy30: 0.4572 - accuracy50: 0.4403 - val_loss: 13.0664 - val_accuracy10: 0.4202 - val_accuracy20: 0.4068 - val_accuracy30: 0.3981 - val_accuracy50: 0.3875 - 14s/epoch - 30ms/step
Epoch 16/50
486/486 - 14s - loss: 12.4568 - accuracy10: 0.4697 - accuracy20: 0.4686 - accuracy30: 0.4588 - accuracy50: 0.4435 - val_loss: 13.0529 - val_accuracy10: 0.4208 - val_accuracy20: 0.4086 - val_accuracy30: 0.3970 - val_accuracy50: 0.3887 - 14s/epoch - 29ms/step
Epoch 17/50
486/486 - 14s - loss: 12.4220 - accuracy10: 0.4726 - accuracy20: 0.4733 - accuracy30: 0.4639 - accuracy50: 0.4476 - val_loss: 13.0847 - val_accuracy10: 0.4175 - val_accuracy20: 0.4073 - val_accuracy30: 0.3971 - val_accuracy50: 0.3894 - 14s/epoch - 29ms/step
Epoch 18/50
486/486 - 14s - loss: 12.3984 - accuracy10: 0.4743 - accuracy20: 0.4756 - accuracy30: 0.4675 - accuracy50: 0.4494 - val_loss: 13.0771 - val_accuracy10: 0.4190 - val_accuracy20: 0.4087 - val_accuracy30: 0.3990 - val_accuracy50: 0.3919 - 14s/epoch - 29ms/step
testing model: results/CHTR/W0/deepOF_L2/seq2seq
Evaluating performance on  test set...
1269/1269 - 13s - 13s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0700713
{'0': {'precision': 0.42893138947108866, 'recall': 0.49358030821614146, 'f1-score': 0.4589905752945736, 'support': 112778}, '1': {'precision': 0.41988989776220775, 'recall': 0.29043775839218244, 'f1-score': 0.343367964406195, 'support': 101106}, '2': {'precision': 0.41681594267801164, 'recall': 0.4700969560315671, 'f1-score': 0.44185602929769463, 'support': 110875}, 'accuracy': 0.4223193198648844, 'macro avg': {'precision': 0.4218790766371027, 'recall': 0.41803834087996367, 'f1-score': 0.41473818966615444, 'support': 324759}, 'weighted avg': {'precision': 0.42198023731240936, 'recall': 0.4223193198648844, 'f1-score': 0.41714436784879266, 'support': 324759}}
[[55665 20274 36839]
 [35654 29365 36087]
 [38457 20296 52122]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0762498
{'0': {'precision': 0.41800563193639223, 'recall': 0.5363158174379682, 'f1-score': 0.4698270846424167, 'support': 112926}, '1': {'precision': 0.4114680946006247, 'recall': 0.18399680734311086, 'f1-score': 0.25428472940365393, 'support': 100230}, '2': {'precision': 0.4069351578292645, 'recall': 0.4924329991129271, 'f1-score': 0.4456201804957552, 'support': 111603}, 'accuracy': 0.4124997305694376, 'macro avg': {'precision': 0.4121362947887605, 'recall': 0.4042485412980021, 'f1-score': 0.38991066484727527, 'support': 324759}, 'weighted avg': {'precision': 0.4121836054831092, 'recall': 0.4124997305694376, 'f1-score': 0.39498582269413796, 'support': 324759}}
[[60564 13069 39293]
 [40987 18442 40801]
 [43337 13309 54957]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0857897
{'0': {'precision': 0.39938070652865026, 'recall': 0.5669452668062676, 'f1-score': 0.4686348239998806, 'support': 110792}, '1': {'precision': 0.4251660805001954, 'recall': 0.1041866166162332, 'f1-score': 0.16736144226184066, 'support': 104428}, '2': {'precision': 0.39068171086663894, 'recall': 0.5060754617077022, 'f1-score': 0.4409542142607146, 'support': 109539}, 'accuracy': 0.3976117674952811, 'macro avg': {'precision': 0.40507616596516155, 'recall': 0.3924024483767343, 'f1-score': 0.35898349350747866, 'support': 324759}, 'weighted avg': {'precision': 0.4047380199434577, 'recall': 0.3976117674952811, 'f1-score': 0.362422269402907, 'support': 324759}}
[[62813  7435 40544]
 [47634 10880 45914]
 [46829  7275 55435]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0969148
{'0': {'precision': 0.37785755226402, 'recall': 0.5806254229902748, 'f1-score': 0.45779363176515314, 'support': 107863}, '1': {'precision': 0.44434201428900666, 'recall': 0.05277468566944652, 'f1-score': 0.09434408514455817, 'support': 109598}, '2': {'precision': 0.3759255327164257, 'recall': 0.5115100001863968, 'f1-score': 0.4333603110997059, 'support': 107298}, 'accuracy': 0.3796538356134857, 'macro avg': {'precision': 0.3993750330898174, 'recall': 0.38163670294870605, 'f1-score': 0.32849934266980574, 'support': 324759}, 'weighted avg': {'precision': 0.399656062037719, 'recall': 0.3796538356134857, 'f1-score': 0.3270659541602673, 'support': 324759}}
[[62628  3573 41662]
 [54363  5784 49451]
 [48754  3660 54884]]
Evaluating performance on  train set...
486/486 - 5s - 5s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0501314
{'0': {'precision': 0.43934455309430365, 'recall': 0.4803976239544187, 'f1-score': 0.4589548781617715, 'support': 41245}, '1': {'precision': 0.4936375915262671, 'recall': 0.3377514044602252, 'f1-score': 0.40108009761309976, 'support': 41119}, '2': {'precision': 0.43097940063895257, 'recall': 0.5249224158510384, 'f1-score': 0.4733346966451765, 'support': 41890}, 'accuracy': 0.4482028747565471, 'macro avg': {'precision': 0.4546538484198412, 'recall': 0.4476904814218941, 'f1-score': 0.4444565574733493, 'support': 124254}, 'weighted avg': {'precision': 0.45449142330314396, 'recall': 0.4482028747565471, 'f1-score': 0.44465044928937303, 'support': 124254}}
[[19814  6940 14491]
 [12690 13888 14541]
 [12595  7306 21989]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.058666
{'0': {'precision': 0.4304309239719949, 'recall': 0.5288216907756051, 'f1-score': 0.4745803253022528, 'support': 41271}, '1': {'precision': 0.5065422565422566, 'recall': 0.22913836600038812, 'f1-score': 0.3155398182789952, 'support': 41224}, '2': {'precision': 0.4236716999690352, 'recall': 0.5570056754232621, 'f1-score': 0.4812745706600456, 'support': 41759}, 'accuracy': 0.4388671592061423, 'macro avg': {'precision': 0.4535482934944289, 'recall': 0.43832191073308513, 'f1-score': 0.4237982380804312, 'support': 124254}, 'weighted avg': {'precision': 0.4534109096363346, 'recall': 0.4388671592061423, 'f1-score': 0.42406492242081073, 'support': 124254}}
[[21825  4466 14980]
 [15117  9446 16661]
 [13763  4736 23260]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0682632
{'0': {'precision': 0.4168505988348952, 'recall': 0.5577719141107265, 'f1-score': 0.4771233032728327, 'support': 41309}, '1': {'precision': 0.5141571844403281, 'recall': 0.1416387228458959, 'f1-score': 0.2220952163227982, 'support': 41154}, '2': {'precision': 0.41444754783755183, 'recall': 0.5716541839151971, 'f1-score': 0.4805197417382384, 'support': 41791}, 'accuracy': 0.42461409693048113, 'macro avg': {'precision': 0.44848511037092503, 'recall': 0.4236882736239398, 'f1-score': 0.3932460871112897, 'support': 124254}, 'weighted avg': {'precision': 0.4482711512499162, 'recall': 0.42461409693048113, 'f1-score': 0.39379813603126335, 'support': 124254}}
[[23041  2736 15532]
 [17104  5829 18221]
 [15129  2772 23890]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0787235
{'0': {'precision': 0.4034054035591078, 'recall': 0.5715218969271716, 'f1-score': 0.4729686436266069, 'support': 41330}, '1': {'precision': 0.5102616324612251, 'recall': 0.07945840448889974, 'f1-score': 0.13750448567749562, 'support': 40990}, '2': {'precision': 0.4069322453933948, 'recall': 0.5756188295893547, 'f1-score': 0.47679529091070705, 'support': 41934}, 'accuracy': 0.4105783314822863, 'macro avg': {'precision': 0.4401997604712426, 'recall': 0.40886637700180867, 'f1-score': 0.3624228067382698, 'support': 124254}, 'weighted avg': {'precision': 0.43984633429917885, 'recall': 0.4105783314822863, 'f1-score': 0.363594223429892, 'support': 124254}}
[[23621  1549 16160]
 [18714  3257 19019]
 [16219  1577 24138]]
Evaluating performance on  val set...
178/178 - 2s - 2s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0635756
{'0': {'precision': 0.4142214463170617, 'recall': 0.4177840986049032, 'f1-score': 0.4159951448127044, 'support': 14766}, '1': {'precision': 0.4728897104128158, 'recall': 0.30928873665121903, 'f1-score': 0.3739797782921184, 'support': 14889}, '2': {'precision': 0.4227307545001915, 'recall': 0.5566061522945033, 'f1-score': 0.4805180670439704, 'support': 15864}, 'accuracy': 0.43067729958918255, 'macro avg': {'precision': 0.436613970410023, 'recall': 0.42789299585020846, 'f1-score': 0.42349766338293104, 'support': 45519}, 'weighted avg': {'precision': 0.4363771054734327, 'recall': 0.43067729958918255, 'f1-score': 0.42473929222701046, 'support': 45519}}
[[6169 2524 6073]
 [4299 4605 5985]
 [4425 2609 8830]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0730921
{'0': {'precision': 0.41192698244996184, 'recall': 0.4711964549483013, 'f1-score': 0.43957282891234223, 'support': 14894}, '1': {'precision': 0.4732055862292952, 'recall': 0.19447410571276028, 'f1-score': 0.27565982404692085, 'support': 14984}, '2': {'precision': 0.40790180971152123, 'recall': 0.5821878396521961, 'f1-score': 0.4797049914394837, 'support': 15641}, 'accuracy': 0.41824293152310027, 'macro avg': {'precision': 0.43101145946359276, 'recall': 0.4159528001044192, 'f1-score': 0.39831254813291556, 'support': 45519}, 'weighted avg': {'precision': 0.43071563932352197, 'recall': 0.41824293152310027, 'f1-score': 0.39940574899370485, 'support': 45519}}
[[7018 1634 6242]
 [5094 2914 6976]
 [4925 1610 9106]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0816104
{'0': {'precision': 0.40576319846881814, 'recall': 0.5099218280216476, 'f1-score': 0.4519185220274751, 'support': 14967}, '1': {'precision': 0.4745762711864407, 'recall': 0.1094547141058769, 'f1-score': 0.17788306234521375, 'support': 15093}, '2': {'precision': 0.39734814240819666, 'recall': 0.5970631994307524, 'f1-score': 0.4771505376344086, 'support': 15459}, 'accuracy': 0.4067312550802961, 'macro avg': {'precision': 0.4258958706878185, 'recall': 0.40547991385275894, 'f1-score': 0.3689840406690325, 'support': 45519}, 'weighted avg': {'precision': 0.4257220586126247, 'recall': 0.4067312550802961, 'f1-score': 0.3696241951811739, 'support': 45519}}
[[7632  922 6413]
 [5855 1652 7586]
 [5322  907 9230]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0899147
{'0': {'precision': 0.3930578348003382, 'recall': 0.5300073761147992, 'f1-score': 0.451373422420193, 'support': 14913}, '1': {'precision': 0.4779281930547381, 'recall': 0.05377839592025962, 'f1-score': 0.09667817597333016, 'support': 15099}, '2': {'precision': 0.39053603812576443, 'recall': 0.5971496743406204, 'f1-score': 0.4722321383038401, 'support': 15507}, 'accuracy': 0.394912014763066, 'macro avg': {'precision': 0.4205073553269469, 'recall': 0.39364514879189305, 'f1-score': 0.34009457889912104, 'support': 45519}, 'weighted avg': {'precision': 0.4203508781064426, 'recall': 0.394912014763066, 'f1-score': 0.3408242579197983, 'support': 45519}}
[[7904  467 6542]
 [6378  812 7909]
 [5827  420 9260]]
training model: results/CHTR/W0/deepVOL_L2/seq2seq
Epoch 1/50
486/486 - 20s - loss: 13.1710 - accuracy10: 0.3658 - accuracy20: 0.3688 - accuracy30: 0.3673 - accuracy50: 0.3661 - val_loss: 13.6078 - val_accuracy10: 0.3298 - val_accuracy20: 0.3354 - val_accuracy30: 0.3367 - val_accuracy50: 0.3366 - 20s/epoch - 40ms/step
Epoch 2/50
486/486 - 14s - loss: 13.1101 - accuracy10: 0.3709 - accuracy20: 0.3727 - accuracy30: 0.3709 - accuracy50: 0.3694 - val_loss: 13.5020 - val_accuracy10: 0.3546 - val_accuracy20: 0.3492 - val_accuracy30: 0.3434 - val_accuracy50: 0.3427 - 14s/epoch - 29ms/step
Epoch 3/50
486/486 - 14s - loss: 13.0715 - accuracy10: 0.3795 - accuracy20: 0.3786 - accuracy30: 0.3749 - accuracy50: 0.3722 - val_loss: 13.4516 - val_accuracy10: 0.3552 - val_accuracy20: 0.3505 - val_accuracy30: 0.3458 - val_accuracy50: 0.3407 - 14s/epoch - 29ms/step
Epoch 4/50
486/486 - 14s - loss: 13.0451 - accuracy10: 0.3867 - accuracy20: 0.3842 - accuracy30: 0.3803 - accuracy50: 0.3755 - val_loss: 13.5105 - val_accuracy10: 0.3554 - val_accuracy20: 0.3518 - val_accuracy30: 0.3497 - val_accuracy50: 0.3466 - 14s/epoch - 28ms/step
Epoch 5/50
486/486 - 14s - loss: 13.0121 - accuracy10: 0.3959 - accuracy20: 0.3940 - accuracy30: 0.3878 - accuracy50: 0.3800 - val_loss: 13.3562 - val_accuracy10: 0.3734 - val_accuracy20: 0.3637 - val_accuracy30: 0.3547 - val_accuracy50: 0.3527 - 14s/epoch - 28ms/step
Epoch 6/50
486/486 - 14s - loss: 12.9776 - accuracy10: 0.4018 - accuracy20: 0.3980 - accuracy30: 0.3905 - accuracy50: 0.3845 - val_loss: 13.3856 - val_accuracy10: 0.3708 - val_accuracy20: 0.3607 - val_accuracy30: 0.3534 - val_accuracy50: 0.3488 - 14s/epoch - 28ms/step
Epoch 7/50
486/486 - 14s - loss: 12.9592 - accuracy10: 0.4092 - accuracy20: 0.4049 - accuracy30: 0.3969 - accuracy50: 0.3861 - val_loss: 13.2849 - val_accuracy10: 0.3781 - val_accuracy20: 0.3689 - val_accuracy30: 0.3601 - val_accuracy50: 0.3531 - 14s/epoch - 29ms/step
Epoch 8/50
486/486 - 14s - loss: 12.9349 - accuracy10: 0.4110 - accuracy20: 0.4075 - accuracy30: 0.3995 - accuracy50: 0.3879 - val_loss: 13.2854 - val_accuracy10: 0.3850 - val_accuracy20: 0.3731 - val_accuracy30: 0.3627 - val_accuracy50: 0.3585 - 14s/epoch - 29ms/step
Epoch 9/50
486/486 - 14s - loss: 12.9147 - accuracy10: 0.4151 - accuracy20: 0.4127 - accuracy30: 0.4040 - accuracy50: 0.3919 - val_loss: 13.1880 - val_accuracy10: 0.3876 - val_accuracy20: 0.3780 - val_accuracy30: 0.3674 - val_accuracy50: 0.3610 - 14s/epoch - 29ms/step
Epoch 10/50
486/486 - 14s - loss: 12.8946 - accuracy10: 0.4190 - accuracy20: 0.4156 - accuracy30: 0.4064 - accuracy50: 0.3939 - val_loss: 13.4349 - val_accuracy10: 0.3662 - val_accuracy20: 0.3611 - val_accuracy30: 0.3564 - val_accuracy50: 0.3485 - 14s/epoch - 30ms/step
Epoch 11/50
486/486 - 14s - loss: 12.8913 - accuracy10: 0.4184 - accuracy20: 0.4136 - accuracy30: 0.4049 - accuracy50: 0.3930 - val_loss: 13.3124 - val_accuracy10: 0.3858 - val_accuracy20: 0.3752 - val_accuracy30: 0.3638 - val_accuracy50: 0.3556 - 14s/epoch - 29ms/step
Epoch 12/50
486/486 - 14s - loss: 12.8729 - accuracy10: 0.4230 - accuracy20: 0.4184 - accuracy30: 0.4089 - accuracy50: 0.3947 - val_loss: 13.3138 - val_accuracy10: 0.3815 - val_accuracy20: 0.3718 - val_accuracy30: 0.3628 - val_accuracy50: 0.3568 - 14s/epoch - 28ms/step
Epoch 13/50
486/486 - 14s - loss: 12.8727 - accuracy10: 0.4217 - accuracy20: 0.4178 - accuracy30: 0.4094 - accuracy50: 0.3971 - val_loss: 13.2264 - val_accuracy10: 0.3798 - val_accuracy20: 0.3739 - val_accuracy30: 0.3629 - val_accuracy50: 0.3567 - 14s/epoch - 29ms/step
Epoch 14/50
486/486 - 14s - loss: 12.8649 - accuracy10: 0.4212 - accuracy20: 0.4176 - accuracy30: 0.4092 - accuracy50: 0.3955 - val_loss: 13.1291 - val_accuracy10: 0.3898 - val_accuracy20: 0.3782 - val_accuracy30: 0.3692 - val_accuracy50: 0.3615 - 14s/epoch - 29ms/step
Epoch 15/50
486/486 - 14s - loss: 12.8393 - accuracy10: 0.4261 - accuracy20: 0.4222 - accuracy30: 0.4130 - accuracy50: 0.3992 - val_loss: 13.2704 - val_accuracy10: 0.3861 - val_accuracy20: 0.3770 - val_accuracy30: 0.3650 - val_accuracy50: 0.3585 - 14s/epoch - 30ms/step
Epoch 16/50
486/486 - 14s - loss: 12.8310 - accuracy10: 0.4280 - accuracy20: 0.4237 - accuracy30: 0.4135 - accuracy50: 0.3996 - val_loss: 13.1524 - val_accuracy10: 0.3889 - val_accuracy20: 0.3783 - val_accuracy30: 0.3665 - val_accuracy50: 0.3600 - 14s/epoch - 28ms/step
Epoch 17/50
486/486 - 14s - loss: 12.8155 - accuracy10: 0.4287 - accuracy20: 0.4263 - accuracy30: 0.4169 - accuracy50: 0.4023 - val_loss: 13.1819 - val_accuracy10: 0.3864 - val_accuracy20: 0.3779 - val_accuracy30: 0.3670 - val_accuracy50: 0.3596 - 14s/epoch - 28ms/step
Epoch 18/50
486/486 - 14s - loss: 12.8082 - accuracy10: 0.4306 - accuracy20: 0.4276 - accuracy30: 0.4175 - accuracy50: 0.4026 - val_loss: 13.1892 - val_accuracy10: 0.3893 - val_accuracy20: 0.3801 - val_accuracy30: 0.3688 - val_accuracy50: 0.3601 - 14s/epoch - 29ms/step
Epoch 19/50
486/486 - 14s - loss: 12.7959 - accuracy10: 0.4303 - accuracy20: 0.4285 - accuracy30: 0.4187 - accuracy50: 0.4051 - val_loss: 13.1475 - val_accuracy10: 0.3878 - val_accuracy20: 0.3805 - val_accuracy30: 0.3688 - val_accuracy50: 0.3616 - 14s/epoch - 28ms/step
Epoch 20/50
486/486 - 14s - loss: 12.7816 - accuracy10: 0.4326 - accuracy20: 0.4296 - accuracy30: 0.4209 - accuracy50: 0.4063 - val_loss: 13.1982 - val_accuracy10: 0.3870 - val_accuracy20: 0.3762 - val_accuracy30: 0.3665 - val_accuracy50: 0.3589 - 14s/epoch - 28ms/step
Epoch 21/50
486/486 - 14s - loss: 12.7761 - accuracy10: 0.4347 - accuracy20: 0.4321 - accuracy30: 0.4218 - accuracy50: 0.4064 - val_loss: 13.2413 - val_accuracy10: 0.3873 - val_accuracy20: 0.3776 - val_accuracy30: 0.3670 - val_accuracy50: 0.3589 - 14s/epoch - 29ms/step
Epoch 22/50
486/486 - 14s - loss: 12.7639 - accuracy10: 0.4340 - accuracy20: 0.4320 - accuracy30: 0.4227 - accuracy50: 0.4077 - val_loss: 13.2226 - val_accuracy10: 0.3860 - val_accuracy20: 0.3760 - val_accuracy30: 0.3662 - val_accuracy50: 0.3595 - 14s/epoch - 29ms/step
Epoch 23/50
486/486 - 14s - loss: 12.7514 - accuracy10: 0.4357 - accuracy20: 0.4339 - accuracy30: 0.4245 - accuracy50: 0.4102 - val_loss: 13.2810 - val_accuracy10: 0.3868 - val_accuracy20: 0.3787 - val_accuracy30: 0.3668 - val_accuracy50: 0.3602 - 14s/epoch - 28ms/step
Epoch 24/50
486/486 - 14s - loss: 12.7476 - accuracy10: 0.4362 - accuracy20: 0.4342 - accuracy30: 0.4244 - accuracy50: 0.4090 - val_loss: 13.2575 - val_accuracy10: 0.3873 - val_accuracy20: 0.3789 - val_accuracy30: 0.3691 - val_accuracy50: 0.3611 - 14s/epoch - 28ms/step
testing model: results/CHTR/W0/deepVOL_L2/seq2seq
Evaluating performance on  test set...
1269/1269 - 12s - 12s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0867039
{'0': {'precision': 0.4140264671394271, 'recall': 0.32872558320993783, 'f1-score': 0.36647786245959485, 'support': 112781}, '1': {'precision': 0.4276203839149775, 'recall': 0.14167309556307242, 'f1-score': 0.2128332949488496, 'support': 101106}, '2': {'precision': 0.3677635557846938, 'recall': 0.6690837594812269, 'f1-score': 0.47464003403721694, 'support': 110877}, 'accuracy': 0.38669310637878584, 'macro avg': {'precision': 0.4031368022796995, 'recall': 0.379827479418079, 'f1-score': 0.3513170638152205, 'support': 324764}, 'weighted avg': {'precision': 0.4024640209545976, 'recall': 0.38669310637878584, 'f1-score': 0.3555724340724294, 'support': 324764}}
[[37074 10031 65676]
 [24922 14324 61860]
 [27549  9142 74186]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.088755
{'0': {'precision': 0.40525436793422404, 'recall': 0.33520473221875885, 'f1-score': 0.36691609801488834, 'support': 112928}, '1': {'precision': 0.4230188217041604, 'recall': 0.10337121249912702, 'f1-score': 0.16614284339822327, 'support': 100231}, '2': {'precision': 0.36617471466622836, 'recall': 0.6787151113301375, 'f1-score': 0.47570242536141777, 'support': 111605}, 'accuracy': 0.38170178960722245, 'macro avg': {'precision': 0.39814930143487093, 'recall': 0.37243035201600777, 'f1-score': 0.33625378892484314, 'support': 324764}, 'weighted avg': {'precision': 0.39730725637887876, 'recall': 0.38170178960722245, 'f1-score': 0.3423363846846746, 'support': 324764}}
[[37854  7555 67519]
 [26274 10361 63596]
 [29280  6577 75748]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0960598
{'0': {'precision': 0.38688099559242933, 'recall': 0.33670595880643356, 'f1-score': 0.3600538560653222, 'support': 110794}, '1': {'precision': 0.4216465449250743, 'recall': 0.06655239444981757, 'f1-score': 0.11495964006881036, 'support': 104429}, '2': {'precision': 0.3542075749565743, 'recall': 0.6850494335454305, 'f1-score': 0.4669676443775144, 'support': 109541}, 'accuracy': 0.36733135446046977, 'macro avg': {'precision': 0.3875783718246926, 'recall': 0.36276926226722717, 'f1-score': 0.31399371350388233, 'support': 324764}, 'weighted avg': {'precision': 0.38703942565668087, 'recall': 0.36733135446046977, 'f1-score': 0.31730434997230117, 'support': 324764}}
[[37305  5225 68264]
 [28928  6950 68551]
 [30192  4308 75041]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1048875
{'0': {'precision': 0.3661960344563943, 'recall': 0.3330212205771923, 'f1-score': 0.34882162729047106, 'support': 107867}, '1': {'precision': 0.4224079946190064, 'recall': 0.04011022098943411, 'f1-score': 0.07326361401608267, 'support': 109598}, '2': {'precision': 0.34268618620007213, 'recall': 0.6906867724769103, 'f1-score': 0.458089819230377, 'support': 107299}, 'accuracy': 0.35234200835067925, 'macro avg': {'precision': 0.3770967384251576, 'recall': 0.3546060713478456, 'f1-score': 0.2933916868456436, 'support': 324764}, 'weighted avg': {'precision': 0.3773984312794623, 'recall': 0.35234200835067925, 'f1-score': 0.29193034804804746, 'support': 324764}}
[[35922  3247 68698]
 [31748  4396 73454]
 [30425  2764 74110]]
Evaluating performance on  train set...
486/486 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0770844
{'0': {'precision': 0.4194288096727121, 'recall': 0.34120696756062696, 'f1-score': 0.37629582131024897, 'support': 41277}, '1': {'precision': 0.4902767835838702, 'recall': 0.20043897085721255, 'f1-score': 0.28454707542107355, 'support': 41005}, '2': {'precision': 0.37146877367680486, 'recall': 0.6541348009434637, 'f1-score': 0.47384907451352637, 'support': 41973}, 'accuracy': 0.4004587340549676, 'macro avg': {'precision': 0.4270581223111291, 'recall': 0.398593579787101, 'f1-score': 0.3782306570816163, 'support': 124255}, 'weighted avg': {'precision': 0.42660835640621037, 'recall': 0.4004587340549676, 'f1-score': 0.37897133031604774, 'support': 124255}}
[[14084  4180 23013]
 [ 9343  8219 23443]
 [10152  4365 27456]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0807774
{'0': {'precision': 0.4134822542238349, 'recall': 0.35361714507370057, 'f1-score': 0.38121373686686527, 'support': 41248}, '1': {'precision': 0.501791277258567, 'recall': 0.1564822460776218, 'f1-score': 0.2385677787240345, 'support': 41174}, '2': {'precision': 0.36915378452567016, 'recall': 0.6718858317596156, 'f1-score': 0.47650289899298137, 'support': 41833}, 'accuracy': 0.39544485131383045, 'macro avg': {'precision': 0.42814243866935736, 'recall': 0.39399507430364594, 'f1-score': 0.3654281381946271, 'support': 124255}, 'weighted avg': {'precision': 0.4278208550169517, 'recall': 0.39544485131383045, 'f1-score': 0.3660266364576174, 'support': 124255}}
[[14586  3187 23475]
 [10174  6443 24557]
 [10516  3210 28107]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0861524
{'0': {'precision': 0.400602246215615, 'recall': 0.3577190475036942, 'f1-score': 0.3779481207529785, 'support': 41281}, '1': {'precision': 0.5039517014270033, 'recall': 0.11168142454023548, 'f1-score': 0.18284280536859296, 'support': 41108}, '2': {'precision': 0.3665546798155411, 'recall': 0.685401041417857, 'f1-score': 0.4776569093375725, 'support': 41866}, 'accuracy': 0.3867289042694459, 'macro avg': {'precision': 0.4237028758193864, 'recall': 0.38493383782059554, 'f1-score': 0.34614927848638133, 'support': 124255}, 'weighted avg': {'precision': 0.42332208839439456, 'recall': 0.3867289042694459, 'f1-score': 0.34699579559955446, 'support': 124255}}
[[14767  2317 24197]
 [11126  4591 25391]
 [10969  2202 28695]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0938262
{'0': {'precision': 0.38594540207059075, 'recall': 0.3531692188408606, 'f1-score': 0.36883057730993557, 'support': 41272}, '1': {'precision': 0.4856266149870801, 'recall': 0.07315767705520278, 'f1-score': 0.12715931916693096, 'support': 41103}, '2': {'precision': 0.36253362558533425, 'recall': 0.6950811843361987, 'f1-score': 0.47652566788894707, 'support': 41880}, 'accuracy': 0.37578367067723634, 'macro avg': {'precision': 0.41136854754766833, 'recall': 0.37380269341075406, 'f1-score': 0.32417185478860455, 'support': 124255}, 'weighted avg': {'precision': 0.4110285914416737, 'recall': 0.37578367067723634, 'f1-score': 0.3251853048460273, 'support': 124255}}
[[14576  1742 24954]
 [11864  3007 26232]
 [11327  1443 29110]]
Evaluating performance on  val set...
178/178 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0849253
{'0': {'precision': 0.4079258878023675, 'recall': 0.26786076377154444, 'f1-score': 0.3233782129742962, 'support': 14795}, '1': {'precision': 0.4714163822525597, 'recall': 0.14874141876430205, 'f1-score': 0.22613322418909237, 'support': 14858}, '2': {'precision': 0.37304367387601634, 'recall': 0.7315812693010652, 'f1-score': 0.4941256597990806, 'support': 15867}, 'accuracy': 0.3906195079086116, 'macro avg': {'precision': 0.4174619813103145, 'recall': 0.38272781727897054, 'f1-score': 0.347879032320823, 'support': 45520}, 'weighted avg': {'precision': 0.41649059953724316, 'recall': 0.3906195079086116, 'f1-score': 0.35115465619482117, 'support': 45520}}
[[ 3963  1188  9644]
 [ 2783  2210  9865]
 [ 2969  1290 11608]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0908052
{'0': {'precision': 0.4012248123271434, 'recall': 0.2720878826445174, 'f1-score': 0.3242725422105137, 'support': 14929}, '1': {'precision': 0.4740474875759249, 'recall': 0.1142077956631635, 'f1-score': 0.1840694682675815, 'support': 15034}, '2': {'precision': 0.3633159186756468, 'recall': 0.7420453815002893, 'f1-score': 0.48779869430183176, 'support': 15557}, 'accuracy': 0.3805579964850615, 'macro avg': {'precision': 0.41286273952623836, 'recall': 0.3761136866026567, 'f1-score': 0.332046901593309, 'support': 45520}, 'weighted avg': {'precision': 0.41232031850363393, 'recall': 0.3805579964850615, 'f1-score': 0.3338543377822754, 'support': 45520}}
[[ 4062   944  9923]
 [ 3010  1717 10307]
 [ 3052   961 11544]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0962343
{'0': {'precision': 0.391640423704552, 'recall': 0.27414829659318635, 'f1-score': 0.3225274077566898, 'support': 14970}, '1': {'precision': 0.46291365538227464, 'recall': 0.08004999013352627, 'f1-score': 0.13649618663077615, 'support': 15203}, '2': {'precision': 0.353233370356658, 'recall': 0.7460089919854043, 'f1-score': 0.47944889968382914, 'support': 15347}, 'accuracy': 0.3684094903339192, 'macro avg': {'precision': 0.4025958164811616, 'recall': 0.36673575957070564, 'f1-score': 0.3128241646904317, 'support': 45520}, 'weighted avg': {'precision': 0.40249573770864444, 'recall': 0.3684094903339192, 'f1-score': 0.3133016055121499, 'support': 45520}}
[[ 4104   719 10147]
 [ 3170  1217 10816]
 [ 3205   693 11449]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1009007
{'0': {'precision': 0.3817504655493482, 'recall': 0.2741374699117411, 'f1-score': 0.3191158156911581, 'support': 14956}, '1': {'precision': 0.4586340921710161, 'recall': 0.054644085736967454, 'f1-score': 0.09765324821185789, 'support': 15116}, '2': {'precision': 0.35122350586737017, 'recall': 0.7498058001035732, 'f1-score': 0.4783695046151941, 'support': 15448}, 'accuracy': 0.36267574692442883, 'macro avg': {'precision': 0.39720268786257823, 'recall': 0.3595291185840939, 'f1-score': 0.29837952283940333, 'support': 45520}, 'weighted avg': {'precision': 0.3969216524308494, 'recall': 0.36267574692442883, 'f1-score': 0.2996193925031398, 'support': 45520}}
[[ 4100   495 10361]
 [ 3255   826 11035]
 [ 3385   480 11583]]
training model: results/CHTR/W0/deepVOL_L3/seq2seq
Epoch 1/50
486/486 - 26s - loss: 13.1754 - accuracy10: 0.3608 - accuracy20: 0.3650 - accuracy30: 0.3658 - accuracy50: 0.3637 - val_loss: 13.7902 - val_accuracy10: 0.3279 - val_accuracy20: 0.3320 - val_accuracy30: 0.3321 - val_accuracy50: 0.3330 - 26s/epoch - 54ms/step
Epoch 2/50
486/486 - 20s - loss: 13.1389 - accuracy10: 0.3624 - accuracy20: 0.3654 - accuracy30: 0.3662 - accuracy50: 0.3652 - val_loss: 13.5783 - val_accuracy10: 0.3422 - val_accuracy20: 0.3383 - val_accuracy30: 0.3356 - val_accuracy50: 0.3372 - 20s/epoch - 42ms/step
Epoch 3/50
486/486 - 21s - loss: 13.1177 - accuracy10: 0.3652 - accuracy20: 0.3651 - accuracy30: 0.3646 - accuracy50: 0.3653 - val_loss: 13.6183 - val_accuracy10: 0.3373 - val_accuracy20: 0.3375 - val_accuracy30: 0.3346 - val_accuracy50: 0.3312 - 21s/epoch - 43ms/step
Epoch 4/50
486/486 - 21s - loss: 13.1046 - accuracy10: 0.3726 - accuracy20: 0.3700 - accuracy30: 0.3677 - accuracy50: 0.3658 - val_loss: 13.4528 - val_accuracy10: 0.3563 - val_accuracy20: 0.3492 - val_accuracy30: 0.3451 - val_accuracy50: 0.3439 - 21s/epoch - 43ms/step
Epoch 5/50
486/486 - 21s - loss: 13.0743 - accuracy10: 0.3765 - accuracy20: 0.3755 - accuracy30: 0.3736 - accuracy50: 0.3693 - val_loss: 13.4858 - val_accuracy10: 0.3601 - val_accuracy20: 0.3527 - val_accuracy30: 0.3477 - val_accuracy50: 0.3453 - 21s/epoch - 43ms/step
Epoch 6/50
486/486 - 20s - loss: 13.0466 - accuracy10: 0.3836 - accuracy20: 0.3834 - accuracy30: 0.3788 - accuracy50: 0.3765 - val_loss: 13.5412 - val_accuracy10: 0.3609 - val_accuracy20: 0.3545 - val_accuracy30: 0.3484 - val_accuracy50: 0.3449 - 20s/epoch - 42ms/step
Epoch 7/50
486/486 - 21s - loss: 13.0236 - accuracy10: 0.3922 - accuracy20: 0.3890 - accuracy30: 0.3841 - accuracy50: 0.3773 - val_loss: 13.3467 - val_accuracy10: 0.3711 - val_accuracy20: 0.3619 - val_accuracy30: 0.3557 - val_accuracy50: 0.3534 - 21s/epoch - 42ms/step
Epoch 8/50
486/486 - 21s - loss: 12.9886 - accuracy10: 0.4033 - accuracy20: 0.3996 - accuracy30: 0.3917 - accuracy50: 0.3819 - val_loss: 13.2540 - val_accuracy10: 0.3729 - val_accuracy20: 0.3640 - val_accuracy30: 0.3558 - val_accuracy50: 0.3525 - 21s/epoch - 42ms/step
Epoch 9/50
486/486 - 20s - loss: 12.9698 - accuracy10: 0.4080 - accuracy20: 0.4038 - accuracy30: 0.3962 - accuracy50: 0.3839 - val_loss: 13.1971 - val_accuracy10: 0.3752 - val_accuracy20: 0.3656 - val_accuracy30: 0.3582 - val_accuracy50: 0.3543 - 20s/epoch - 42ms/step
Epoch 10/50
486/486 - 20s - loss: 12.9424 - accuracy10: 0.4138 - accuracy20: 0.4096 - accuracy30: 0.4012 - accuracy50: 0.3882 - val_loss: 13.2567 - val_accuracy10: 0.3742 - val_accuracy20: 0.3659 - val_accuracy30: 0.3583 - val_accuracy50: 0.3551 - 20s/epoch - 41ms/step
Epoch 11/50
486/486 - 20s - loss: 12.9220 - accuracy10: 0.4155 - accuracy20: 0.4122 - accuracy30: 0.4039 - accuracy50: 0.3902 - val_loss: 13.2347 - val_accuracy10: 0.3761 - val_accuracy20: 0.3679 - val_accuracy30: 0.3598 - val_accuracy50: 0.3550 - 20s/epoch - 42ms/step
Epoch 12/50
486/486 - 21s - loss: 12.9105 - accuracy10: 0.4176 - accuracy20: 0.4136 - accuracy30: 0.4044 - accuracy50: 0.3915 - val_loss: 13.2179 - val_accuracy10: 0.3767 - val_accuracy20: 0.3678 - val_accuracy30: 0.3585 - val_accuracy50: 0.3556 - 21s/epoch - 42ms/step
Epoch 13/50
486/486 - 20s - loss: 12.8857 - accuracy10: 0.4206 - accuracy20: 0.4174 - accuracy30: 0.4074 - accuracy50: 0.3941 - val_loss: 13.2629 - val_accuracy10: 0.3777 - val_accuracy20: 0.3682 - val_accuracy30: 0.3596 - val_accuracy50: 0.3553 - 20s/epoch - 41ms/step
Epoch 14/50
486/486 - 21s - loss: 12.8815 - accuracy10: 0.4214 - accuracy20: 0.4174 - accuracy30: 0.4071 - accuracy50: 0.3933 - val_loss: 13.2323 - val_accuracy10: 0.3759 - val_accuracy20: 0.3693 - val_accuracy30: 0.3616 - val_accuracy50: 0.3566 - 21s/epoch - 43ms/step
Epoch 15/50
486/486 - 21s - loss: 12.8674 - accuracy10: 0.4235 - accuracy20: 0.4202 - accuracy30: 0.4104 - accuracy50: 0.3947 - val_loss: 13.1722 - val_accuracy10: 0.3856 - val_accuracy20: 0.3754 - val_accuracy30: 0.3663 - val_accuracy50: 0.3605 - 21s/epoch - 42ms/step
Epoch 16/50
486/486 - 20s - loss: 12.8497 - accuracy10: 0.4260 - accuracy20: 0.4225 - accuracy30: 0.4129 - accuracy50: 0.3971 - val_loss: 13.1889 - val_accuracy10: 0.3788 - val_accuracy20: 0.3726 - val_accuracy30: 0.3628 - val_accuracy50: 0.3575 - 20s/epoch - 41ms/step
Epoch 17/50
486/486 - 21s - loss: 12.8393 - accuracy10: 0.4269 - accuracy20: 0.4231 - accuracy30: 0.4141 - accuracy50: 0.3994 - val_loss: 13.2027 - val_accuracy10: 0.3816 - val_accuracy20: 0.3735 - val_accuracy30: 0.3629 - val_accuracy50: 0.3589 - 21s/epoch - 44ms/step
Epoch 18/50
486/486 - 21s - loss: 12.8155 - accuracy10: 0.4299 - accuracy20: 0.4265 - accuracy30: 0.4161 - accuracy50: 0.4009 - val_loss: 13.2892 - val_accuracy10: 0.3798 - val_accuracy20: 0.3710 - val_accuracy30: 0.3612 - val_accuracy50: 0.3569 - 21s/epoch - 42ms/step
Epoch 19/50
486/486 - 20s - loss: 12.8064 - accuracy10: 0.4313 - accuracy20: 0.4268 - accuracy30: 0.4172 - accuracy50: 0.4019 - val_loss: 13.2624 - val_accuracy10: 0.3819 - val_accuracy20: 0.3723 - val_accuracy30: 0.3635 - val_accuracy50: 0.3589 - 20s/epoch - 42ms/step
Epoch 20/50
486/486 - 21s - loss: 12.7956 - accuracy10: 0.4314 - accuracy20: 0.4278 - accuracy30: 0.4183 - accuracy50: 0.4031 - val_loss: 13.2725 - val_accuracy10: 0.3825 - val_accuracy20: 0.3738 - val_accuracy30: 0.3645 - val_accuracy50: 0.3591 - 21s/epoch - 42ms/step
Epoch 21/50
486/486 - 20s - loss: 12.7835 - accuracy10: 0.4313 - accuracy20: 0.4281 - accuracy30: 0.4190 - accuracy50: 0.4038 - val_loss: 13.2443 - val_accuracy10: 0.3841 - val_accuracy20: 0.3751 - val_accuracy30: 0.3650 - val_accuracy50: 0.3594 - 20s/epoch - 42ms/step
Epoch 22/50
486/486 - 20s - loss: 12.7722 - accuracy10: 0.4329 - accuracy20: 0.4288 - accuracy30: 0.4193 - accuracy50: 0.4047 - val_loss: 13.2474 - val_accuracy10: 0.3825 - val_accuracy20: 0.3740 - val_accuracy30: 0.3641 - val_accuracy50: 0.3579 - 20s/epoch - 42ms/step
Epoch 23/50
486/486 - 21s - loss: 12.7572 - accuracy10: 0.4339 - accuracy20: 0.4310 - accuracy30: 0.4221 - accuracy50: 0.4069 - val_loss: 13.2179 - val_accuracy10: 0.3849 - val_accuracy20: 0.3766 - val_accuracy30: 0.3662 - val_accuracy50: 0.3606 - 21s/epoch - 44ms/step
Epoch 24/50
486/486 - 20s - loss: 12.7497 - accuracy10: 0.4329 - accuracy20: 0.4313 - accuracy30: 0.4220 - accuracy50: 0.4075 - val_loss: 13.2390 - val_accuracy10: 0.3821 - val_accuracy20: 0.3745 - val_accuracy30: 0.3653 - val_accuracy50: 0.3601 - 20s/epoch - 41ms/step
Epoch 25/50
486/486 - 21s - loss: 12.7416 - accuracy10: 0.4362 - accuracy20: 0.4335 - accuracy30: 0.4233 - accuracy50: 0.4062 - val_loss: 13.1558 - val_accuracy10: 0.3851 - val_accuracy20: 0.3794 - val_accuracy30: 0.3696 - val_accuracy50: 0.3625 - 21s/epoch - 42ms/step
Epoch 26/50
486/486 - 20s - loss: 12.7323 - accuracy10: 0.4362 - accuracy20: 0.4344 - accuracy30: 0.4251 - accuracy50: 0.4096 - val_loss: 13.1788 - val_accuracy10: 0.3843 - val_accuracy20: 0.3766 - val_accuracy30: 0.3666 - val_accuracy50: 0.3599 - 20s/epoch - 42ms/step
Epoch 27/50
486/486 - 20s - loss: 12.7232 - accuracy10: 0.4372 - accuracy20: 0.4360 - accuracy30: 0.4265 - accuracy50: 0.4100 - val_loss: 13.2344 - val_accuracy10: 0.3871 - val_accuracy20: 0.3784 - val_accuracy30: 0.3676 - val_accuracy50: 0.3607 - 20s/epoch - 42ms/step
Epoch 28/50
486/486 - 20s - loss: 12.7160 - accuracy10: 0.4374 - accuracy20: 0.4376 - accuracy30: 0.4285 - accuracy50: 0.4120 - val_loss: 13.1614 - val_accuracy10: 0.3841 - val_accuracy20: 0.3776 - val_accuracy30: 0.3656 - val_accuracy50: 0.3592 - 20s/epoch - 42ms/step
Epoch 29/50
486/486 - 20s - loss: 12.6946 - accuracy10: 0.4396 - accuracy20: 0.4375 - accuracy30: 0.4282 - accuracy50: 0.4142 - val_loss: 13.1828 - val_accuracy10: 0.3856 - val_accuracy20: 0.3764 - val_accuracy30: 0.3654 - val_accuracy50: 0.3601 - 20s/epoch - 42ms/step
Epoch 30/50
486/486 - 21s - loss: 12.6890 - accuracy10: 0.4407 - accuracy20: 0.4388 - accuracy30: 0.4292 - accuracy50: 0.4147 - val_loss: 13.2536 - val_accuracy10: 0.3816 - val_accuracy20: 0.3741 - val_accuracy30: 0.3650 - val_accuracy50: 0.3576 - 21s/epoch - 42ms/step
Epoch 31/50
486/486 - 20s - loss: 12.6895 - accuracy10: 0.4392 - accuracy20: 0.4398 - accuracy30: 0.4298 - accuracy50: 0.4148 - val_loss: 13.1617 - val_accuracy10: 0.3844 - val_accuracy20: 0.3773 - val_accuracy30: 0.3672 - val_accuracy50: 0.3623 - 20s/epoch - 42ms/step
Epoch 32/50
486/486 - 21s - loss: 12.6664 - accuracy10: 0.4406 - accuracy20: 0.4418 - accuracy30: 0.4328 - accuracy50: 0.4179 - val_loss: 13.1711 - val_accuracy10: 0.3842 - val_accuracy20: 0.3767 - val_accuracy30: 0.3660 - val_accuracy50: 0.3599 - 21s/epoch - 42ms/step
Epoch 33/50
486/486 - 21s - loss: 12.6459 - accuracy10: 0.4427 - accuracy20: 0.4440 - accuracy30: 0.4343 - accuracy50: 0.4184 - val_loss: 13.2115 - val_accuracy10: 0.3821 - val_accuracy20: 0.3755 - val_accuracy30: 0.3661 - val_accuracy50: 0.3616 - 21s/epoch - 43ms/step
Epoch 34/50
486/486 - 21s - loss: 12.6353 - accuracy10: 0.4455 - accuracy20: 0.4461 - accuracy30: 0.4364 - accuracy50: 0.4199 - val_loss: 13.3678 - val_accuracy10: 0.3779 - val_accuracy20: 0.3719 - val_accuracy30: 0.3661 - val_accuracy50: 0.3605 - 21s/epoch - 42ms/step
Epoch 35/50
486/486 - 20s - loss: 12.6462 - accuracy10: 0.4425 - accuracy20: 0.4434 - accuracy30: 0.4331 - accuracy50: 0.4192 - val_loss: 13.2740 - val_accuracy10: 0.3809 - val_accuracy20: 0.3736 - val_accuracy30: 0.3661 - val_accuracy50: 0.3613 - 20s/epoch - 42ms/step
testing model: results/CHTR/W0/deepVOL_L3/seq2seq
Evaluating performance on  test set...
1269/1269 - 23s - 23s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0920744
{'0': {'precision': 0.4057994184594171, 'recall': 0.3600961154804444, 'f1-score': 0.38158413981020395, 'support': 112781}, '1': {'precision': 0.43248343706083114, 'recall': 0.10653175874824442, 'f1-score': 0.17095332947123665, 'support': 101106}, '2': {'precision': 0.3676944639103013, 'recall': 0.6625179252685408, 'f1-score': 0.47292029473020075, 'support': 110877}, 'accuracy': 0.3844052912268601, 'macro avg': {'precision': 0.4019924398101831, 'recall': 0.3763819331657432, 'f1-score': 0.34181925467054713, 'support': 324764}, 'weighted avg': {'precision': 0.4010973928013154, 'recall': 0.3844052912268601, 'f1-score': 0.3471931363089934, 'support': 324764}}
[[40612  7278 64891]
 [28904 10771 61431]
 [30563  6856 73458]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0889242
{'0': {'precision': 0.40555367994598246, 'recall': 0.3403938792859167, 'f1-score': 0.370127869357572, 'support': 112928}, '1': {'precision': 0.42431936803498377, 'recall': 0.09003202601989405, 'f1-score': 0.14854565507251147, 'support': 100231}, '2': {'precision': 0.3664505804621658, 'recall': 0.6853008377760853, 'f1-score': 0.4775441904607297, 'support': 111605}, 'accuracy': 0.38165252306290104, 'macro avg': {'precision': 0.39877454281437735, 'recall': 0.371908914360632, 'f1-score': 0.3320725716302711, 'support': 324764}, 'weighted avg': {'precision': 0.39790751924146267, 'recall': 0.38165252306290104, 'f1-score': 0.33865514330638413, 'support': 324764}}
[[38440  6428 68060]
 [27037  9024 64170]
 [29307  5815 76483]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0944985
{'0': {'precision': 0.3929039730757463, 'recall': 0.3245392349766233, 'f1-score': 0.3554643863377984, 'support': 110794}, '1': {'precision': 0.41586803740489053, 'recall': 0.06856333010945236, 'f1-score': 0.11771862617759729, 'support': 104429}, '2': {'precision': 0.35600909128782443, 'recall': 0.7021024091436083, 'f1-score': 0.47245463369085794, 'support': 109541}, 'accuracy': 0.3695791405451343, 'macro avg': {'precision': 0.38826036725615376, 'recall': 0.365068324743228, 'f1-score': 0.3152125487354179, 'support': 324764}, 'weighted avg': {'precision': 0.3878437201779419, 'recall': 0.3695791405451343, 'f1-score': 0.3184765326887851, 'support': 324764}}
[[35957  5321 69516]
 [27663  7160 69606]
 [27896  4736 76909]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1023921
{'0': {'precision': 0.3744399641577061, 'recall': 0.3099186961721379, 'f1-score': 0.33913780072737604, 'support': 107867}, '1': {'precision': 0.4189579782109242, 'recall': 0.05157940838336466, 'f1-score': 0.09185074457108969, 'support': 109598}, '2': {'precision': 0.34564914793842993, 'recall': 0.7151138407627284, 'f1-score': 0.46603905372164356, 'support': 107299}, 'accuracy': 0.35660972275252184, 'macro avg': {'precision': 0.37968236343568673, 'recall': 0.35887064843941036, 'f1-score': 0.29900919967336975, 'support': 324764}, 'weighted avg': {'precision': 0.37995122622706257, 'recall': 0.35660972275252184, 'f1-score': 0.29761291115961375, 'support': 324764}}
[[33430  4116 70321]
 [29006  5653 74939]
 [26844  3724 76731]]
Evaluating performance on  train set...
486/486 - 9s - 9s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0774618
{'0': {'precision': 0.416304206276859, 'recall': 0.3872374445817283, 'f1-score': 0.4012451049302139, 'support': 41277}, '1': {'precision': 0.5246721746380656, 'recall': 0.16880868186806486, 'f1-score': 0.2554337798442747, 'support': 41005}, '2': {'precision': 0.37735148003908237, 'recall': 0.6533009315512354, 'f1-score': 0.4783845080251221, 'support': 41973}, 'accuracy': 0.4050299786728904, 'macro avg': {'precision': 0.43944262031800224, 'recall': 0.40311568600034287, 'f1-score': 0.3783544642665369, 'support': 124255}, 'weighted avg': {'precision': 0.4389082525065727, 'recall': 0.4050299786728904, 'f1-score': 0.37918385009904937, 'support': 124255}}
[[15984  3086 22207]
 [11044  6922 23039]
 [11367  3185 27421]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0757108
{'0': {'precision': 0.4205758388527013, 'recall': 0.3725513964313421, 'f1-score': 0.3951096598359602, 'support': 41248}, '1': {'precision': 0.533073593073593, 'recall': 0.1495361150240443, 'f1-score': 0.23355587588195129, 'support': 41174}, '2': {'precision': 0.37459792298501976, 'recall': 0.6820452752611574, 'f1-score': 0.48359322033898305, 'support': 41833}, 'accuracy': 0.40284897992032515, 'macro avg': {'precision': 0.44274911830377134, 'recall': 0.4013775955721813, 'f1-score': 0.37075291868563154, 'support': 124255}, 'weighted avg': {'precision': 0.442374465691044, 'recall': 0.40284897992032515, 'f1-score': 0.3713658852272973, 'support': 124255}}
[[15367  2718 23163]
 [10545  6157 24472]
 [10626  2675 28532]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0796053
{'0': {'precision': 0.41442886899735404, 'recall': 0.35665318185121486, 'f1-score': 0.38337651516137844, 'support': 41281}, '1': {'precision': 0.5179022746419545, 'recall': 0.11963608056825922, 'f1-score': 0.19437198640423684, 'support': 41108}, '2': {'precision': 0.3705905367712948, 'recall': 0.7013567095017437, 'f1-score': 0.4849420721888703, 'support': 41866}, 'accuracy': 0.39438251981811595, 'macro avg': {'precision': 0.4343072268035344, 'recall': 0.3925486573070726, 'f1-score': 0.3542301912514952, 'support': 124255}, 'weighted avg': {'precision': 0.4338908555754558, 'recall': 0.39438251981811595, 'f1-score': 0.3550681609089491, 'support': 124255}}
[[14723  2334 24224]
 [10544  4918 25646]
 [10259  2244 29363]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0868524
{'0': {'precision': 0.40257920622212057, 'recall': 0.3411271564256639, 'f1-score': 0.3693143066995436, 'support': 41272}, '1': {'precision': 0.4952431289640592, 'recall': 0.09118555823175924, 'f1-score': 0.15401368371309404, 'support': 41103}, '2': {'precision': 0.3659303677415407, 'recall': 0.713992359121299, 'f1-score': 0.4838707067438002, 'support': 41880}, 'accuracy': 0.3841213633254195, 'macro avg': {'precision': 0.42125090097590684, 'recall': 0.38210169125957405, 'f1-score': 0.335732899052146, 'support': 124255}, 'weighted avg': {'precision': 0.4208795712850574, 'recall': 0.3841213633254195, 'f1-score': 0.33670491896658666, 'support': 124255}}
[[14079  2013 25180]
 [10722  3748 26633]
 [10171  1807 29902]]
Evaluating performance on  val set...
178/178 - 3s - 3s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0925046
{'0': {'precision': 0.38336614173228345, 'recall': 0.31591753970936126, 'f1-score': 0.34638900211212803, 'support': 14795}, '1': {'precision': 0.4841799709724238, 'recall': 0.11226275407188047, 'f1-score': 0.18226520242583183, 'support': 14858}, '2': {'precision': 0.3733895525884282, 'recall': 0.7032205205772988, 'f1-score': 0.48778142076502734, 'support': 15867}, 'accuracy': 0.3844463971880492, 'macro avg': {'precision': 0.4136452217643785, 'recall': 0.3771336047861802, 'f1-score': 0.3388118751009957, 'support': 45520}, 'weighted avg': {'precision': 0.4127948178066344, 'recall': 0.3844463971880492, 'f1-score': 0.34210345929636715, 'support': 45520}}
[[ 4674   882  9239]
 [ 3704  1668  9486]
 [ 3814   895 11158]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0934832
{'0': {'precision': 0.392520035618878, 'recall': 0.29526425078705876, 'f1-score': 0.3370159409763371, 'support': 14929}, '1': {'precision': 0.48384948384948384, 'recall': 0.09664759877610749, 'f1-score': 0.1611132671730332, 'support': 15034}, '2': {'precision': 0.36309010132003705, 'recall': 0.730217908337083, 'f1-score': 0.4850140893177355, 'support': 15557}, 'accuracy': 0.378317223198594, 'macro avg': {'precision': 0.41315320692946633, 'recall': 0.3740432526334165, 'f1-score': 0.32771443248903526, 'support': 45520}, 'weighted avg': {'precision': 0.4126256032114057, 'recall': 0.378317223198594, 'f1-score': 0.3295002642581531, 'support': 45520}}
[[ 4408   788  9733]
 [ 3387  1453 10194]
 [ 3435   762 11360]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0965668
{'0': {'precision': 0.3884945834889802, 'recall': 0.27788911155644624, 'f1-score': 0.3240127735804969, 'support': 14970}, '1': {'precision': 0.4626987362413371, 'recall': 0.07465631783200684, 'f1-score': 0.12856819211599457, 'support': 15203}, '2': {'precision': 0.3522976606199203, 'recall': 0.7428161855737277, 'f1-score': 0.477927304741542, 'support': 15347}, 'accuracy': 0.36676186291739893, 'macro avg': {'precision': 0.40116366011674587, 'recall': 0.36512053832072694, 'f1-score': 0.31016942347934445, 'support': 45520}, 'weighted avg': {'precision': 0.4010739235378075, 'recall': 0.36676186291739893, 'f1-score': 0.31062925727390045, 'support': 45520}}
[[ 4160   684 10126]
 [ 3235  1135 10833]
 [ 3313   634 11400]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1004859
{'0': {'precision': 0.38087924745632556, 'recall': 0.2653115806365338, 'f1-score': 0.31276109403326235, 'support': 14956}, '1': {'precision': 0.4336787564766839, 'recall': 0.05537179147922731, 'f1-score': 0.09820485744456177, 'support': 15116}, '2': {'precision': 0.35014470034969253, 'recall': 0.7518772656654583, 'f1-score': 0.47778691896338954, 'support': 15448}, 'accuracy': 0.36072056239015815, 'macro avg': {'precision': 0.3882342347609007, 'recall': 0.35752021259373984, 'f1-score': 0.29625095681373786, 'support': 45520}, 'weighted avg': {'precision': 0.38798228117004413, 'recall': 0.36072056239015815, 'f1-score': 0.297516956758346, 'support': 45520}}
[[ 3968   576 10412]
 [ 3134   837 11145]
 [ 3316   517 11615]]
training model: results/CHTR/W1/deepLOB_L1/seq2seq
Epoch 1/50
384/384 - 15s - loss: 13.1919 - accuracy10: 0.3682 - accuracy20: 0.3689 - accuracy30: 0.3687 - accuracy50: 0.3637 - val_loss: 13.3529 - val_accuracy10: 0.3231 - val_accuracy20: 0.3323 - val_accuracy30: 0.3418 - val_accuracy50: 0.3479 - 15s/epoch - 39ms/step
Epoch 2/50
384/384 - 9s - loss: 13.0980 - accuracy10: 0.3826 - accuracy20: 0.3817 - accuracy30: 0.3799 - accuracy50: 0.3733 - val_loss: 13.2462 - val_accuracy10: 0.3579 - val_accuracy20: 0.3622 - val_accuracy30: 0.3607 - val_accuracy50: 0.3566 - 9s/epoch - 24ms/step
Epoch 3/50
384/384 - 9s - loss: 13.0720 - accuracy10: 0.3891 - accuracy20: 0.3853 - accuracy30: 0.3822 - accuracy50: 0.3742 - val_loss: 13.2799 - val_accuracy10: 0.3724 - val_accuracy20: 0.3705 - val_accuracy30: 0.3649 - val_accuracy50: 0.3628 - 9s/epoch - 22ms/step
Epoch 4/50
384/384 - 9s - loss: 13.0356 - accuracy10: 0.3983 - accuracy20: 0.3927 - accuracy30: 0.3888 - accuracy50: 0.3806 - val_loss: 13.4387 - val_accuracy10: 0.3740 - val_accuracy20: 0.3738 - val_accuracy30: 0.3716 - val_accuracy50: 0.3686 - 9s/epoch - 23ms/step
Epoch 5/50
384/384 - 9s - loss: 13.0089 - accuracy10: 0.4065 - accuracy20: 0.4002 - accuracy30: 0.3928 - accuracy50: 0.3836 - val_loss: 13.4129 - val_accuracy10: 0.3717 - val_accuracy20: 0.3726 - val_accuracy30: 0.3710 - val_accuracy50: 0.3674 - 9s/epoch - 23ms/step
Epoch 6/50
384/384 - 8s - loss: 12.9831 - accuracy10: 0.4124 - accuracy20: 0.4051 - accuracy30: 0.3982 - accuracy50: 0.3871 - val_loss: 13.2016 - val_accuracy10: 0.3787 - val_accuracy20: 0.3772 - val_accuracy30: 0.3737 - val_accuracy50: 0.3735 - 8s/epoch - 21ms/step
Epoch 7/50
384/384 - 9s - loss: 12.9563 - accuracy10: 0.4168 - accuracy20: 0.4100 - accuracy30: 0.4032 - accuracy50: 0.3920 - val_loss: 13.1404 - val_accuracy10: 0.3854 - val_accuracy20: 0.3838 - val_accuracy30: 0.3797 - val_accuracy50: 0.3749 - 9s/epoch - 23ms/step
Epoch 8/50
384/384 - 9s - loss: 12.9439 - accuracy10: 0.4221 - accuracy20: 0.4125 - accuracy30: 0.4057 - accuracy50: 0.3938 - val_loss: 13.2469 - val_accuracy10: 0.3791 - val_accuracy20: 0.3771 - val_accuracy30: 0.3723 - val_accuracy50: 0.3685 - 9s/epoch - 22ms/step
Epoch 9/50
384/384 - 9s - loss: 12.9262 - accuracy10: 0.4236 - accuracy20: 0.4145 - accuracy30: 0.4071 - accuracy50: 0.3959 - val_loss: 13.1787 - val_accuracy10: 0.3847 - val_accuracy20: 0.3791 - val_accuracy30: 0.3708 - val_accuracy50: 0.3618 - 9s/epoch - 24ms/step
Epoch 10/50
384/384 - 9s - loss: 12.9082 - accuracy10: 0.4273 - accuracy20: 0.4180 - accuracy30: 0.4116 - accuracy50: 0.3989 - val_loss: 13.2044 - val_accuracy10: 0.3739 - val_accuracy20: 0.3697 - val_accuracy30: 0.3681 - val_accuracy50: 0.3584 - 9s/epoch - 23ms/step
Epoch 11/50
384/384 - 9s - loss: 12.8959 - accuracy10: 0.4291 - accuracy20: 0.4207 - accuracy30: 0.4137 - accuracy50: 0.3998 - val_loss: 13.2306 - val_accuracy10: 0.3738 - val_accuracy20: 0.3699 - val_accuracy30: 0.3659 - val_accuracy50: 0.3604 - 9s/epoch - 24ms/step
Epoch 12/50
384/384 - 9s - loss: 12.8821 - accuracy10: 0.4321 - accuracy20: 0.4220 - accuracy30: 0.4146 - accuracy50: 0.4015 - val_loss: 13.2574 - val_accuracy10: 0.3701 - val_accuracy20: 0.3643 - val_accuracy30: 0.3588 - val_accuracy50: 0.3541 - 9s/epoch - 24ms/step
Epoch 13/50
384/384 - 9s - loss: 12.8728 - accuracy10: 0.4300 - accuracy20: 0.4222 - accuracy30: 0.4147 - accuracy50: 0.4014 - val_loss: 13.1966 - val_accuracy10: 0.3776 - val_accuracy20: 0.3719 - val_accuracy30: 0.3635 - val_accuracy50: 0.3578 - 9s/epoch - 23ms/step
Epoch 14/50
384/384 - 9s - loss: 12.8522 - accuracy10: 0.4326 - accuracy20: 0.4263 - accuracy30: 0.4190 - accuracy50: 0.4047 - val_loss: 13.2421 - val_accuracy10: 0.3792 - val_accuracy20: 0.3758 - val_accuracy30: 0.3697 - val_accuracy50: 0.3665 - 9s/epoch - 22ms/step
Epoch 15/50
384/384 - 9s - loss: 12.8373 - accuracy10: 0.4345 - accuracy20: 0.4271 - accuracy30: 0.4210 - accuracy50: 0.4050 - val_loss: 13.2388 - val_accuracy10: 0.3772 - val_accuracy20: 0.3717 - val_accuracy30: 0.3664 - val_accuracy50: 0.3627 - 9s/epoch - 23ms/step
Epoch 16/50
384/384 - 9s - loss: 12.8336 - accuracy10: 0.4351 - accuracy20: 0.4274 - accuracy30: 0.4200 - accuracy50: 0.4064 - val_loss: 13.1969 - val_accuracy10: 0.3832 - val_accuracy20: 0.3742 - val_accuracy30: 0.3672 - val_accuracy50: 0.3601 - 9s/epoch - 22ms/step
Epoch 17/50
384/384 - 8s - loss: 12.8241 - accuracy10: 0.4355 - accuracy20: 0.4282 - accuracy30: 0.4215 - accuracy50: 0.4069 - val_loss: 13.2561 - val_accuracy10: 0.3770 - val_accuracy20: 0.3668 - val_accuracy30: 0.3598 - val_accuracy50: 0.3546 - 8s/epoch - 22ms/step
testing model: results/CHTR/W1/deepLOB_L1/seq2seq
Evaluating performance on  test set...
1304/1304 - 12s - 12s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0870976
{'0': {'precision': 0.4054521268803216, 'recall': 0.5912563449607766, 'f1-score': 0.4810356275050318, 'support': 117022}, '1': {'precision': 0.3571249791423327, 'recall': 0.24755176003392837, 'f1-score': 0.2924105109754987, 'support': 103748}, '2': {'precision': 0.4094059840308853, 'recall': 0.3304210815164954, 'f1-score': 0.365697267165327, 'support': 112971}, 'accuracy': 0.3961185470169982, 'macro avg': {'precision': 0.3906610300178465, 'recall': 0.3897430621704001, 'f1-score': 0.3797144685486192, 'support': 333741}, 'weighted avg': {'precision': 0.39176734218990444, 'recall': 0.3961185470169982, 'f1-score': 0.3833569830003327, 'support': 333741}}
[[69190 22546 25286]
 [49503 25683 28562]
 [51956 23687 37328]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0883169
{'0': {'precision': 0.3957870411518976, 'recall': 0.614901310963243, 'f1-score': 0.48159251060378183, 'support': 115869}, '1': {'precision': 0.3684236404759563, 'recall': 0.2103613172498339, 'f1-score': 0.2678095941574881, 'support': 106859}, '2': {'precision': 0.39802180970974316, 'recall': 0.3324025114175817, 'f1-score': 0.36226463254206664, 'support': 111013}, 'accuracy': 0.39140531130427486, 'macro avg': {'precision': 0.3874108304458657, 'recall': 0.3858883798768862, 'f1-score': 0.3705555791011122, 'support': 333741}, 'weighted avg': {'precision': 0.38776903536022594, 'recall': 0.39140531130427486, 'f1-score': 0.37345004565101997, 'support': 333741}}
[[71248 18651 25970]
 [54540 22479 29840]
 [54228 19884 36901]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0900286
{'0': {'precision': 0.3904477091606338, 'recall': 0.6187512409036369, 'f1-score': 0.4787757746591767, 'support': 115843}, '1': {'precision': 0.36825191615107583, 'recall': 0.18676820472470448, 'f1-score': 0.24783875999825983, 'support': 106758}, '2': {'precision': 0.39368028578272596, 'recall': 0.3401115709915422, 'f1-score': 0.36494060060726885, 'support': 111140}, 'accuracy': 0.38777674903592907, 'macro avg': {'precision': 0.3841266370314786, 'recall': 0.3818770055399612, 'f1-score': 0.3638517117549018, 'support': 333741}, 'weighted avg': {'precision': 0.3844241462650499, 'recall': 0.38777674903592907, 'f1-score': 0.3669944380679302, 'support': 333741}}
[[71678 16523 27642]
 [56244 19939 30575]
 [55657 17683 37800]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0932531
{'0': {'precision': 0.38108102219995205, 'recall': 0.6086555608716454, 'f1-score': 0.4687046781373196, 'support': 114955}, '1': {'precision': 0.36228783910757484, 'recall': 0.1699059619910181, 'f1-score': 0.23132499361756445, 'support': 106659}, '2': {'precision': 0.3884394102840705, 'recall': 0.3468299339142223, 'f1-score': 0.3664573154356093, 'support': 112127}, 'accuracy': 0.3804716831315301, 'macro avg': {'precision': 0.3772694238638658, 'recall': 0.3751304855922952, 'f1-score': 0.3554956623968311, 'support': 333741}, 'weighted avg': {'precision': 0.3775471796851219, 'recall': 0.3804716831315301, 'f1-score': 0.358489362042362, 'support': 333741}}
[[69968 15230 29757]
 [57067 18122 31470]
 [56569 16669 38889]]
Evaluating performance on  train set...
384/384 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0878986
{'0': {'precision': 0.38098991172761665, 'recall': 0.6417760731671338, 'f1-score': 0.4781352001846337, 'support': 33895}, '1': {'precision': 0.3545359749739312, 'recall': 0.23193798449612404, 'f1-score': 0.2804228837069806, 'support': 32250}, '2': {'precision': 0.4305306203869938, 'recall': 0.26893243201146383, 'f1-score': 0.33106436830096064, 'support': 32101}, 'accuracy': 0.38542027156321884, 'macro avg': {'precision': 0.3886855023628472, 'recall': 0.38088216322490726, 'f1-score': 0.3632074840641916, 'support': 98246}, 'weighted avg': {'precision': 0.3884931874677823, 'recall': 0.38542027156321884, 'f1-score': 0.36518054573862974, 'support': 98246}}
[[21753  6627  5515]
 [18866  7480  5904]
 [16477  6991  8633]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0898995
{'0': {'precision': 0.3767826293147251, 'recall': 0.6593947298218573, 'f1-score': 0.4795481736168746, 'support': 33737}, '1': {'precision': 0.3540350150212369, 'recall': 0.20921334557698193, 'f1-score': 0.2630060027705095, 'support': 32670}, '2': {'precision': 0.4197406774550206, 'recall': 0.26231979647602, 'f1-score': 0.3228637145563137, 'support': 31839}, 'accuracy': 0.38101296744905644, 'macro avg': {'precision': 0.38351944059699417, 'recall': 0.37697595729161976, 'f1-score': 0.3551392969812326, 'support': 98246}, 'weighted avg': {'precision': 0.3831399032573855, 'recall': 0.38101296744905644, 'f1-score': 0.35676343720440035, 'support': 98246}}
[[22246  5999  5492]
 [19781  6835  6054]
 [17015  6472  8352]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0919126
{'0': {'precision': 0.37506046403015697, 'recall': 0.6670028476506882, 'f1-score': 0.4801366572358939, 'support': 33712}, '1': {'precision': 0.35465470454671316, 'recall': 0.1968039336201598, 'f1-score': 0.25313753779868375, 'support': 32540}, '2': {'precision': 0.4111484483099427, 'recall': 0.2600487591423392, 'f1-score': 0.318590848171549, 'support': 31994}, 'accuracy': 0.3787431549376056, 'macro avg': {'precision': 0.38028787229560423, 'recall': 0.3746185134710624, 'f1-score': 0.35062168106870883, 'support': 98246}, 'weighted avg': {'precision': 0.38005400631642006, 'recall': 0.3787431549376056, 'f1-score': 0.3523447068084824, 'support': 98246}}
[[22486  5540  5686]
 [19906  6404  6230]
 [17561  6113  8320]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0956633
{'0': {'precision': 0.37036605463352923, 'recall': 0.6598552701820986, 'f1-score': 0.4744378458487488, 'support': 33718}, '1': {'precision': 0.34418523676880225, 'recall': 0.1856279928640731, 'f1-score': 0.24118089583799282, 'support': 31951}, '2': {'precision': 0.39759323814526526, 'recall': 0.2555790895417012, 'f1-score': 0.3111476512575208, 'support': 32577}, 'accuracy': 0.3715774688028011, 'macro avg': {'precision': 0.3707148431825322, 'recall': 0.36702078419595763, 'f1-score': 0.3422554643147542, 'support': 98246}, 'weighted avg': {'precision': 0.3708798327585005, 'recall': 0.3715774688028011, 'f1-score': 0.3444346143788457, 'support': 98246}}
[[22249  5373  6096]
 [19501  5931  6519]
 [18323  5928  8326]]
Evaluating performance on  val set...
93/93 - 1s - 886ms/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0916493
{'0': {'precision': 0.38628008600957203, 'recall': 0.6827264925830575, 'f1-score': 0.49339948613449097, 'support': 8157}, '1': {'precision': 0.3427394438722966, 'recall': 0.22648700149720974, 'f1-score': 0.2727421734141943, 'support': 7347}, '2': {'precision': 0.44321329639889195, 'recall': 0.23703703703703705, 'f1-score': 0.3088803088803089, 'support': 8100}, 'accuracy': 0.38777325876970004, 'macro avg': {'precision': 0.3907442754269202, 'recall': 0.3820835103724347, 'f1-score': 0.35834065614299804, 'support': 23604}, 'weighted avg': {'precision': 0.39226491512205, 'recall': 0.38777325876970004, 'f1-score': 0.36139751137110787, 'support': 23604}}
[[5569 1453 1135]
 [4406 1664 1277]
 [4442 1738 1920]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0916041
{'0': {'precision': 0.3812314739962274, 'recall': 0.6963209056232312, 'f1-score': 0.4927081972922381, 'support': 8127}, '1': {'precision': 0.34315008726003493, 'recall': 0.21068845432627914, 'f1-score': 0.2610788381742739, 'support': 7466}, '2': {'precision': 0.4327107279693487, 'recall': 0.22556484833354137, 'f1-score': 0.2965454993025355, 'support': 8011}, 'accuracy': 0.3829435688866294, 'macro avg': {'precision': 0.3856974297418703, 'recall': 0.37752473609435055, 'f1-score': 0.35011084492301575, 'support': 23604}, 'weighted avg': {'precision': 0.38665787080211883, 'recall': 0.3829435688866294, 'f1-score': 0.35286731571410607, 'support': 23604}}
[[5659 1380 1088]
 [4612 1573 1281]
 [4573 1631 1807]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.092973
{'0': {'precision': 0.3791519669839579, 'recall': 0.7039920899765171, 'f1-score': 0.49286146923942203, 'support': 8091}, '1': {'precision': 0.34173478655767486, 'recall': 0.20088093966898024, 'f1-score': 0.2530262273032952, 'support': 7492}, '2': {'precision': 0.4237491022264783, 'recall': 0.22067073930931305, 'f1-score': 0.2902115100836203, 'support': 8021}, 'accuracy': 0.38006270123707847, 'macro avg': {'precision': 0.38154528525603704, 'recall': 0.37518125631827015, 'f1-score': 0.3453664022087792, 'support': 23604}, 'weighted avg': {'precision': 0.38243039886103564, 'recall': 0.38006270123707847, 'f1-score': 0.3478732911774771, 'support': 23604}}
[[5696 1312 1083]
 [4663 1505 1324]
 [4664 1587 1770]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0966154
{'0': {'precision': 0.3755644090305445, 'recall': 0.6955238563698967, 'f1-score': 0.48775439806829934, 'support': 8132}, '1': {'precision': 0.3391445839144584, 'recall': 0.19937141295435912, 'f1-score': 0.25111876075731493, 'support': 7318}, '2': {'precision': 0.4141914191419142, 'recall': 0.21547706647044396, 'f1-score': 0.2834785414649887, 'support': 8154}, 'accuracy': 0.3758684968649382, 'macro avg': {'precision': 0.37630013736230566, 'recall': 0.3701241119315666, 'f1-score': 0.3407839000968677, 'support': 23604}, 'weighted avg': {'precision': 0.37761678829882916, 'recall': 0.3758684968649382, 'f1-score': 0.34382265223771225, 'support': 23604}}
[[5656 1315 1161]
 [4535 1459 1324]
 [4869 1528 1757]]
training model: results/CHTR/W1/deepOF_L1/seq2seq
Epoch 1/50
384/384 - 14s - loss: 13.1464 - accuracy10: 0.3846 - accuracy20: 0.3807 - accuracy30: 0.3779 - accuracy50: 0.3723 - val_loss: 13.1901 - val_accuracy10: 0.3792 - val_accuracy20: 0.3848 - val_accuracy30: 0.3829 - val_accuracy50: 0.3778 - 14s/epoch - 37ms/step
Epoch 2/50
384/384 - 8s - loss: 13.0356 - accuracy10: 0.4025 - accuracy20: 0.3958 - accuracy30: 0.3935 - accuracy50: 0.3835 - val_loss: 13.1320 - val_accuracy10: 0.3864 - val_accuracy20: 0.3887 - val_accuracy30: 0.3875 - val_accuracy50: 0.3838 - 8s/epoch - 22ms/step
Epoch 3/50
384/384 - 8s - loss: 12.9975 - accuracy10: 0.4089 - accuracy20: 0.4008 - accuracy30: 0.3978 - accuracy50: 0.3903 - val_loss: 13.0909 - val_accuracy10: 0.3958 - val_accuracy20: 0.3925 - val_accuracy30: 0.3920 - val_accuracy50: 0.3896 - 8s/epoch - 21ms/step
Epoch 4/50
384/384 - 8s - loss: 12.9725 - accuracy10: 0.4135 - accuracy20: 0.4054 - accuracy30: 0.4007 - accuracy50: 0.3936 - val_loss: 13.1018 - val_accuracy10: 0.3901 - val_accuracy20: 0.3887 - val_accuracy30: 0.3898 - val_accuracy50: 0.3853 - 8s/epoch - 21ms/step
Epoch 5/50
384/384 - 8s - loss: 12.9541 - accuracy10: 0.4184 - accuracy20: 0.4093 - accuracy30: 0.4041 - accuracy50: 0.3964 - val_loss: 13.0622 - val_accuracy10: 0.4010 - val_accuracy20: 0.3981 - val_accuracy30: 0.3936 - val_accuracy50: 0.3880 - 8s/epoch - 22ms/step
Epoch 6/50
384/384 - 8s - loss: 12.9287 - accuracy10: 0.4206 - accuracy20: 0.4106 - accuracy30: 0.4071 - accuracy50: 0.3991 - val_loss: 13.0544 - val_accuracy10: 0.4055 - val_accuracy20: 0.4030 - val_accuracy30: 0.3979 - val_accuracy50: 0.3894 - 8s/epoch - 22ms/step
Epoch 7/50
384/384 - 8s - loss: 12.9146 - accuracy10: 0.4220 - accuracy20: 0.4128 - accuracy30: 0.4088 - accuracy50: 0.3998 - val_loss: 13.0591 - val_accuracy10: 0.3974 - val_accuracy20: 0.3987 - val_accuracy30: 0.3964 - val_accuracy50: 0.3912 - 8s/epoch - 21ms/step
Epoch 8/50
384/384 - 8s - loss: 12.9045 - accuracy10: 0.4228 - accuracy20: 0.4141 - accuracy30: 0.4110 - accuracy50: 0.4015 - val_loss: 13.0508 - val_accuracy10: 0.4023 - val_accuracy20: 0.4029 - val_accuracy30: 0.4011 - val_accuracy50: 0.3930 - 8s/epoch - 20ms/step
Epoch 9/50
384/384 - 8s - loss: 12.8890 - accuracy10: 0.4246 - accuracy20: 0.4171 - accuracy30: 0.4128 - accuracy50: 0.4035 - val_loss: 13.0253 - val_accuracy10: 0.4077 - val_accuracy20: 0.4077 - val_accuracy30: 0.4040 - val_accuracy50: 0.3970 - 8s/epoch - 21ms/step
Epoch 10/50
384/384 - 8s - loss: 12.8770 - accuracy10: 0.4260 - accuracy20: 0.4192 - accuracy30: 0.4157 - accuracy50: 0.4064 - val_loss: 13.0116 - val_accuracy10: 0.4095 - val_accuracy20: 0.4079 - val_accuracy30: 0.4051 - val_accuracy50: 0.4003 - 8s/epoch - 21ms/step
Epoch 11/50
384/384 - 9s - loss: 12.8647 - accuracy10: 0.4265 - accuracy20: 0.4193 - accuracy30: 0.4169 - accuracy50: 0.4057 - val_loss: 13.0310 - val_accuracy10: 0.4068 - val_accuracy20: 0.4063 - val_accuracy30: 0.4032 - val_accuracy50: 0.3983 - 9s/epoch - 23ms/step
Epoch 12/50
384/384 - 8s - loss: 12.8462 - accuracy10: 0.4293 - accuracy20: 0.4231 - accuracy30: 0.4187 - accuracy50: 0.4083 - val_loss: 13.0111 - val_accuracy10: 0.4114 - val_accuracy20: 0.4102 - val_accuracy30: 0.4070 - val_accuracy50: 0.4021 - 8s/epoch - 22ms/step
Epoch 13/50
384/384 - 8s - loss: 12.8445 - accuracy10: 0.4294 - accuracy20: 0.4221 - accuracy30: 0.4185 - accuracy50: 0.4096 - val_loss: 13.0520 - val_accuracy10: 0.4005 - val_accuracy20: 0.4035 - val_accuracy30: 0.4011 - val_accuracy50: 0.3982 - 8s/epoch - 20ms/step
Epoch 14/50
384/384 - 9s - loss: 12.8302 - accuracy10: 0.4301 - accuracy20: 0.4231 - accuracy30: 0.4198 - accuracy50: 0.4108 - val_loss: 13.0400 - val_accuracy10: 0.4008 - val_accuracy20: 0.4036 - val_accuracy30: 0.4009 - val_accuracy50: 0.3992 - 9s/epoch - 22ms/step
Epoch 15/50
384/384 - 8s - loss: 12.8134 - accuracy10: 0.4336 - accuracy20: 0.4266 - accuracy30: 0.4229 - accuracy50: 0.4145 - val_loss: 13.0661 - val_accuracy10: 0.3996 - val_accuracy20: 0.4015 - val_accuracy30: 0.4003 - val_accuracy50: 0.3956 - 8s/epoch - 21ms/step
Epoch 16/50
384/384 - 8s - loss: 12.8011 - accuracy10: 0.4339 - accuracy20: 0.4281 - accuracy30: 0.4240 - accuracy50: 0.4162 - val_loss: 13.0226 - val_accuracy10: 0.4091 - val_accuracy20: 0.4107 - val_accuracy30: 0.4069 - val_accuracy50: 0.4033 - 8s/epoch - 21ms/step
Epoch 17/50
384/384 - 8s - loss: 12.7885 - accuracy10: 0.4349 - accuracy20: 0.4295 - accuracy30: 0.4258 - accuracy50: 0.4169 - val_loss: 13.0357 - val_accuracy10: 0.4086 - val_accuracy20: 0.4060 - val_accuracy30: 0.4016 - val_accuracy50: 0.3952 - 8s/epoch - 21ms/step
Epoch 18/50
384/384 - 8s - loss: 12.7794 - accuracy10: 0.4369 - accuracy20: 0.4316 - accuracy30: 0.4282 - accuracy50: 0.4171 - val_loss: 13.0349 - val_accuracy10: 0.4088 - val_accuracy20: 0.4059 - val_accuracy30: 0.4021 - val_accuracy50: 0.3965 - 8s/epoch - 20ms/step
Epoch 19/50
384/384 - 8s - loss: 12.7653 - accuracy10: 0.4376 - accuracy20: 0.4329 - accuracy30: 0.4313 - accuracy50: 0.4210 - val_loss: 13.0402 - val_accuracy10: 0.4061 - val_accuracy20: 0.4049 - val_accuracy30: 0.4019 - val_accuracy50: 0.3959 - 8s/epoch - 22ms/step
Epoch 20/50
384/384 - 9s - loss: 12.7580 - accuracy10: 0.4374 - accuracy20: 0.4339 - accuracy30: 0.4312 - accuracy50: 0.4221 - val_loss: 13.0550 - val_accuracy10: 0.4043 - val_accuracy20: 0.4006 - val_accuracy30: 0.4006 - val_accuracy50: 0.3942 - 9s/epoch - 23ms/step
Epoch 21/50
384/384 - 8s - loss: 12.7444 - accuracy10: 0.4390 - accuracy20: 0.4348 - accuracy30: 0.4326 - accuracy50: 0.4232 - val_loss: 13.0495 - val_accuracy10: 0.4086 - val_accuracy20: 0.4031 - val_accuracy30: 0.3997 - val_accuracy50: 0.3948 - 8s/epoch - 21ms/step
Epoch 22/50
384/384 - 8s - loss: 12.7293 - accuracy10: 0.4414 - accuracy20: 0.4377 - accuracy30: 0.4347 - accuracy50: 0.4253 - val_loss: 13.0629 - val_accuracy10: 0.4045 - val_accuracy20: 0.4011 - val_accuracy30: 0.3971 - val_accuracy50: 0.3918 - 8s/epoch - 22ms/step
testing model: results/CHTR/W1/deepOF_L1/seq2seq
Evaluating performance on  test set...
1304/1304 - 12s - 12s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0691364
{'0': {'precision': 0.41715673366687145, 'recall': 0.6092068944890233, 'f1-score': 0.49521388182664383, 'support': 117021}, '1': {'precision': 0.466872046793364, 'recall': 0.2161914676228481, 'f1-score': 0.29553255548894175, 'support': 103746}, '2': {'precision': 0.4317160278745645, 'recall': 0.4387132753233188, 'f1-score': 0.4351865267002972, 'support': 112969}, 'accuracy': 0.4293213797732339, 'macro avg': {'precision': 0.4385816027782667, 'recall': 0.42137054581173006, 'f1-score': 0.40864432133862766, 'support': 333736}, 'weighted avg': {'precision': 0.4375396524498915, 'recall': 0.4293213797732339, 'f1-score': 0.412821304569472, 'support': 333736}}
[[71290 12639 33092]
 [49170 22429 32147]
 [50435 12973 49561]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0726594
{'0': {'precision': 0.4126552683255495, 'recall': 0.6184504647570058, 'f1-score': 0.4950158539365428, 'support': 115867}, '1': {'precision': 0.46925637101280276, 'recall': 0.18076494754672132, 'f1-score': 0.260991757870558, 'support': 106857}, '2': {'precision': 0.4221674711155211, 'recall': 0.4522484055777754, 'f1-score': 0.43669052858646396, 'support': 111012}, 'accuracy': 0.42302598461059043, 'macro avg': {'precision': 0.4346930368179578, 'recall': 0.41715460596050086, 'f1-score': 0.39756604679785496, 'support': 333736}, 'weighted avg': {'precision': 0.4339421318523256, 'recall': 0.42302598461059043, 'f1-score': 0.40068403522029433, 'support': 333736}}
[[71658 11022 33187]
 [52011 19316 35530]
 [49982 10825 50205]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0754315
{'0': {'precision': 0.410816094746775, 'recall': 0.6276329419889503, 'f1-score': 0.49659002038816047, 'support': 115840}, '1': {'precision': 0.4766796552131302, 'recall': 0.15125798535004403, 'f1-score': 0.229645747116629, 'support': 106758}, '2': {'precision': 0.4206277516011165, 'recall': 0.46507945077291296, 'f1-score': 0.4417381346118511, 'support': 111138}, 'accuracy': 0.42111429393292904, 'macro avg': {'precision': 0.43604116718700725, 'recall': 0.4146567927039691, 'f1-score': 0.3893246340388801, 'support': 333736}, 'weighted avg': {'precision': 0.4351524261816366, 'recall': 0.42111429393292904, 'f1-score': 0.3929315430068482, 'support': 333736}}
[[72705  9154 33981]
 [53396 16148 37214]
 [50876  8574 51688]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0797551
{'0': {'precision': 0.40194938497571614, 'recall': 0.6285232096875217, 'f1-score': 0.4903274844673076, 'support': 114952}, '1': {'precision': 0.4822485207100592, 'recall': 0.12531643196009676, 'f1-score': 0.19893729441707472, 'support': 106658}, '2': {'precision': 0.4167781992698244, 'recall': 0.4693559031803507, 'f1-score': 0.4415072337319681, 'support': 112126}, 'accuracy': 0.414228611836901, 'macro avg': {'precision': 0.43365870165186654, 'recall': 0.40773184827598974, 'f1-score': 0.3769240042054502, 'support': 333736}, 'weighted avg': {'precision': 0.43259408872567034, 'recall': 0.414228611836901, 'f1-score': 0.38080045015177555, 'support': 333736}}
[[72250  7393 35309]
 [54957 13366 38335]
 [52542  6957 52627]]
Evaluating performance on  train set...
384/384 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0695202
{'0': {'precision': 0.4100236212385745, 'recall': 0.5886411889596603, 'f1-score': 0.4833589597685146, 'support': 33912}, '1': {'precision': 0.44310344827586207, 'recall': 0.2543138103778836, 'f1-score': 0.32315611615387635, 'support': 32338}, '2': {'precision': 0.41793548387096774, 'recall': 0.4049382716049383, 'f1-score': 0.4113342328756251, 'support': 31995}, 'accuracy': 0.4187694030230546, 'macro avg': {'precision': 0.42368751779513475, 'recall': 0.41596442364749403, 'f1-score': 0.40594976959933865, 'support': 98245}, 'weighted avg': {'precision': 0.4234886880781615, 'recall': 0.4187694030230546, 'f1-score': 0.40717115689052413, 'support': 98245}}
[[19962  5015  8935]
 [15005  8224  9109]
 [13718  5321 12956]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0727861
{'0': {'precision': 0.4082999461819052, 'recall': 0.6069693018845561, 'f1-score': 0.48819667051968013, 'support': 33748}, '1': {'precision': 0.444308838643371, 'recall': 0.21223650701113805, 'f1-score': 0.28725679519923586, 'support': 32591}, '2': {'precision': 0.4101759566875846, 'recall': 0.41791512568169, 'f1-score': 0.41400937684354333, 'support': 31906}, 'accuracy': 0.4146266985597231, 'macro avg': {'precision': 0.4209282471709536, 'recall': 0.41237364485912803, 'f1-score': 0.39648761418748646, 'support': 98245}, 'weighted avg': {'precision': 0.42085449659572616, 'recall': 0.4146266985597231, 'f1-score': 0.3974454743407456, 'support': 98245}}
[[20484  4196  9068]
 [15568  6917 10106]
 [14117  4455 13334]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0756599
{'0': {'precision': 0.4061639318825401, 'recall': 0.6203637871785757, 'f1-score': 0.4909159106360035, 'support': 33756}, '1': {'precision': 0.4489375198223914, 'recall': 0.1743709771796372, 'f1-score': 0.25118115475900005, 'support': 32471}, '2': {'precision': 0.40569332355099047, 'recall': 0.4317571366106565, 'f1-score': 0.41831964050655895, 'support': 32018}, 'accuracy': 0.4114916789658507, 'macro avg': {'precision': 0.4202649250853073, 'recall': 0.40883063365628985, 'f1-score': 0.3868055686338541, 'support': 98245}, 'weighted avg': {'precision': 0.4201476790089623, 'recall': 0.4114916789658507, 'f1-score': 0.38802197572749175, 'support': 98245}}
[[20941  3389  9426]
 [15984  5662 10825]
 [14633  3561 13824]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0801417
{'0': {'precision': 0.3998444701553402, 'recall': 0.6259018437694843, 'f1-score': 0.4879635202073978, 'support': 33681}, '1': {'precision': 0.4399723101265823, 'recall': 0.13942337825133186, 'f1-score': 0.21174622816619865, 'support': 31910}, '2': {'precision': 0.40618469358938153, 'recall': 0.44046671158204204, 'f1-score': 0.4226316408086507, 'support': 32654}, 'accuracy': 0.40625986055269986, 'macro avg': {'precision': 0.41533382462376806, 'recall': 0.40193064453428606, 'f1-score': 0.3741137963940824, 'support': 98245}, 'weighted avg': {'precision': 0.414985322407338, 'recall': 0.40625986055269986, 'f1-score': 0.37653351380583694, 'support': 98245}}
[[21081  2734  9866]
 [16300  4449 11161]
 [15342  2929 14383]]
Evaluating performance on  val set...
93/93 - 1s - 904ms/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0784234
{'0': {'precision': 0.3921968153346917, 'recall': 0.6441497273177987, 'f1-score': 0.48754632018387356, 'support': 8068}, '1': {'precision': 0.39889646218760144, 'recall': 0.16768999863555736, 'f1-score': 0.23611911623439003, 'support': 7329}, '2': {'precision': 0.4553080308030803, 'recall': 0.4034360911417083, 'f1-score': 0.4278054137864203, 'support': 8207}, 'accuracy': 0.412514827995255, 'macro avg': {'precision': 0.4154671027751245, 'recall': 0.4050919390316881, 'f1-score': 0.38382361673489457, 'support': 23604}, 'weighted avg': {'precision': 0.41622051712820296, 'recall': 0.412514827995255, 'f1-score': 0.38870698801349296, 'support': 23604}}
[[5197  852 2019]
 [4158 1229 1942]
 [3896 1000 3311]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0811558
{'0': {'precision': 0.39301793490294484, 'recall': 0.6597695452855904, 'f1-score': 0.49259944495837177, 'support': 8071}, '1': {'precision': 0.3939393939393939, 'recall': 0.13150795791745346, 'f1-score': 0.19718879563150973, 'support': 7414}, '2': {'precision': 0.44445910290237467, 'recall': 0.4149525803670403, 'f1-score': 0.42919931205809286, 'support': 8119}, 'accuracy': 0.4096339603457041, 'macro avg': {'precision': 0.41047214391490455, 'recall': 0.4020766945233614, 'f1-score': 0.37299585088265813, 'support': 23604}, 'weighted avg': {'precision': 0.4110014351691541, 'recall': 0.4096339603457041, 'f1-score': 0.37800360386674664, 'support': 23604}}
[[5325  699 2047]
 [4275  975 2164]
 [3949  801 3369]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0835341
{'0': {'precision': 0.391514888696155, 'recall': 0.6734211834908006, 'f1-score': 0.49515539305301637, 'support': 8044}, '1': {'precision': 0.3987792472024415, 'recall': 0.10464495461825948, 'f1-score': 0.16578557834637345, 'support': 7492}, '2': {'precision': 0.43706741861061266, 'recall': 0.4226574119980169, 'f1-score': 0.42974165091367356, 'support': 8068}, 'accuracy': 0.4071767497034401, 'macro avg': {'precision': 0.4091205181697364, 'recall': 0.40024118336902564, 'f1-score': 0.3635608741043545, 'support': 23604}, 'weighted avg': {'precision': 0.40939077351563236, 'recall': 0.4071767497034401, 'f1-score': 0.36825331190734667, 'support': 23604}}
[[5417  542 2085]
 [4401  784 2307]
 [4018  640 3410]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0868828
{'0': {'precision': 0.3912086351370544, 'recall': 0.6824826560951437, 'f1-score': 0.497336824049833, 'support': 8072}, '1': {'precision': 0.37884615384615383, 'recall': 0.08056161395856053, 'f1-score': 0.13286870503597123, 'support': 7336}, '2': {'precision': 0.4274051745792514, 'recall': 0.41520253782332844, 'f1-score': 0.4212154969674464, 'support': 8196}, 'accuracy': 0.40260125402474156, 'macro avg': {'precision': 0.39915332118748653, 'recall': 0.3927489359590109, 'f1-score': 0.35047367535108354, 'support': 23604}, 'weighted avg': {'precision': 0.39993493892108256, 'recall': 0.40260125402474156, 'f1-score': 0.357630481148082, 'support': 23604}}
[[5509  437 2126]
 [4312  591 2433]
 [4261  532 3403]]
training model: results/CHTR/W1/deepLOB_L2/seq2seq
Epoch 1/50
384/384 - 24s - loss: 13.2406 - accuracy10: 0.3594 - accuracy20: 0.3638 - accuracy30: 0.3615 - accuracy50: 0.3563 - val_loss: 13.4493 - val_accuracy10: 0.3500 - val_accuracy20: 0.3511 - val_accuracy30: 0.3479 - val_accuracy50: 0.3486 - 24s/epoch - 62ms/step
Epoch 2/50
384/384 - 18s - loss: 13.1209 - accuracy10: 0.3751 - accuracy20: 0.3782 - accuracy30: 0.3783 - accuracy50: 0.3736 - val_loss: 13.3353 - val_accuracy10: 0.3545 - val_accuracy20: 0.3493 - val_accuracy30: 0.3480 - val_accuracy50: 0.3479 - 18s/epoch - 47ms/step
Epoch 3/50
384/384 - 18s - loss: 13.0597 - accuracy10: 0.3882 - accuracy20: 0.3867 - accuracy30: 0.3863 - accuracy50: 0.3817 - val_loss: 13.4694 - val_accuracy10: 0.3469 - val_accuracy20: 0.3454 - val_accuracy30: 0.3438 - val_accuracy50: 0.3449 - 18s/epoch - 47ms/step
Epoch 4/50
384/384 - 18s - loss: 12.9967 - accuracy10: 0.4041 - accuracy20: 0.4017 - accuracy30: 0.4004 - accuracy50: 0.3934 - val_loss: 13.2363 - val_accuracy10: 0.3631 - val_accuracy20: 0.3626 - val_accuracy30: 0.3584 - val_accuracy50: 0.3594 - 18s/epoch - 47ms/step
Epoch 5/50
384/384 - 18s - loss: 12.9455 - accuracy10: 0.4154 - accuracy20: 0.4094 - accuracy30: 0.4071 - accuracy50: 0.3974 - val_loss: 13.2100 - val_accuracy10: 0.3777 - val_accuracy20: 0.3714 - val_accuracy30: 0.3711 - val_accuracy50: 0.3694 - 18s/epoch - 48ms/step
Epoch 6/50
384/384 - 18s - loss: 12.9009 - accuracy10: 0.4242 - accuracy20: 0.4199 - accuracy30: 0.4155 - accuracy50: 0.4041 - val_loss: 13.3349 - val_accuracy10: 0.3660 - val_accuracy20: 0.3616 - val_accuracy30: 0.3585 - val_accuracy50: 0.3566 - 18s/epoch - 47ms/step
Epoch 7/50
384/384 - 18s - loss: 12.8622 - accuracy10: 0.4294 - accuracy20: 0.4251 - accuracy30: 0.4209 - accuracy50: 0.4098 - val_loss: 13.2731 - val_accuracy10: 0.3792 - val_accuracy20: 0.3698 - val_accuracy30: 0.3660 - val_accuracy50: 0.3642 - 18s/epoch - 48ms/step
Epoch 8/50
384/384 - 18s - loss: 12.8292 - accuracy10: 0.4332 - accuracy20: 0.4280 - accuracy30: 0.4241 - accuracy50: 0.4121 - val_loss: 13.3620 - val_accuracy10: 0.3663 - val_accuracy20: 0.3590 - val_accuracy30: 0.3546 - val_accuracy50: 0.3532 - 18s/epoch - 47ms/step
Epoch 9/50
384/384 - 18s - loss: 12.7997 - accuracy10: 0.4364 - accuracy20: 0.4328 - accuracy30: 0.4277 - accuracy50: 0.4143 - val_loss: 13.4456 - val_accuracy10: 0.3598 - val_accuracy20: 0.3558 - val_accuracy30: 0.3552 - val_accuracy50: 0.3536 - 18s/epoch - 46ms/step
Epoch 10/50
384/384 - 18s - loss: 12.7621 - accuracy10: 0.4389 - accuracy20: 0.4358 - accuracy30: 0.4314 - accuracy50: 0.4183 - val_loss: 13.5759 - val_accuracy10: 0.3430 - val_accuracy20: 0.3430 - val_accuracy30: 0.3416 - val_accuracy50: 0.3390 - 18s/epoch - 47ms/step
Epoch 11/50
384/384 - 18s - loss: 12.7423 - accuracy10: 0.4421 - accuracy20: 0.4375 - accuracy30: 0.4339 - accuracy50: 0.4214 - val_loss: 13.4194 - val_accuracy10: 0.3647 - val_accuracy20: 0.3627 - val_accuracy30: 0.3580 - val_accuracy50: 0.3548 - 18s/epoch - 46ms/step
Epoch 12/50
384/384 - 18s - loss: 12.7092 - accuracy10: 0.4463 - accuracy20: 0.4421 - accuracy30: 0.4382 - accuracy50: 0.4254 - val_loss: 13.6316 - val_accuracy10: 0.3485 - val_accuracy20: 0.3525 - val_accuracy30: 0.3520 - val_accuracy50: 0.3486 - 18s/epoch - 47ms/step
Epoch 13/50
384/384 - 18s - loss: 12.6852 - accuracy10: 0.4472 - accuracy20: 0.4434 - accuracy30: 0.4401 - accuracy50: 0.4268 - val_loss: 13.5534 - val_accuracy10: 0.3567 - val_accuracy20: 0.3577 - val_accuracy30: 0.3529 - val_accuracy50: 0.3519 - 18s/epoch - 47ms/step
Epoch 14/50
384/384 - 18s - loss: 12.6526 - accuracy10: 0.4506 - accuracy20: 0.4470 - accuracy30: 0.4444 - accuracy50: 0.4292 - val_loss: 13.4985 - val_accuracy10: 0.3602 - val_accuracy20: 0.3624 - val_accuracy30: 0.3588 - val_accuracy50: 0.3590 - 18s/epoch - 47ms/step
Epoch 15/50
384/384 - 18s - loss: 12.6186 - accuracy10: 0.4523 - accuracy20: 0.4497 - accuracy30: 0.4460 - accuracy50: 0.4343 - val_loss: 13.5162 - val_accuracy10: 0.3598 - val_accuracy20: 0.3554 - val_accuracy30: 0.3537 - val_accuracy50: 0.3527 - 18s/epoch - 46ms/step
testing model: results/CHTR/W1/deepLOB_L2/seq2seq
Evaluating performance on  test set...
1304/1304 - 23s - 23s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.098169
{'0': {'precision': 0.3768196823655161, 'recall': 0.6808463365862829, 'f1-score': 0.4851366985325458, 'support': 117022}, '1': {'precision': 0.3682569562915466, 'recall': 0.06033851254963951, 'f1-score': 0.10368787630334501, 'support': 103748}, '2': {'precision': 0.39816151333282684, 'recall': 0.3711394959768436, 'f1-score': 0.38417592486542207, 'support': 112971}, 'accuracy': 0.3831174473618764, 'macro avg': {'precision': 0.38107938399662983, 'recall': 0.3707747817042553, 'f1-score': 0.32433349990043764, 'support': 333741}, 'weighted avg': {'precision': 0.38138202945947786, 'recall': 0.3831174473618764, 'f1-score': 0.3323829404669088, 'support': 333741}}
[[79674  5358 31990]
 [66102  6260 31386]
 [65662  5381 41928]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1017756
{'0': {'precision': 0.3688323148536257, 'recall': 0.7214526750036679, 'f1-score': 0.4881201936271218, 'support': 115869}, '1': {'precision': 0.3693007925920113, 'recall': 0.04403934156224558, 'f1-score': 0.07869433621511347, 'support': 106859}, '2': {'precision': 0.3993937659639863, 'recall': 0.339455739417906, 'f1-score': 0.3669935627124256, 'support': 111013}, 'accuracy': 0.3774903293272328, 'macro avg': {'precision': 0.37917562446987446, 'recall': 0.36831591866127317, 'f1-score': 0.31126936418488693, 'support': 333741}, 'weighted avg': {'precision': 0.3791480370296862, 'recall': 0.3774903293272328, 'f1-score': 0.3167373896715905, 'support': 333741}}
[[83594  3872 28403]
 [73887  4706 28266]
 [69164  4165 37684]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1022476
{'0': {'precision': 0.3655702851960696, 'recall': 0.7377139749488532, 'f1-score': 0.4888791002597164, 'support': 115843}, '1': {'precision': 0.3665579432079816, 'recall': 0.03579122876037393, 'f1-score': 0.0652147940810022, 'support': 106758}, '2': {'precision': 0.40257738866306336, 'recall': 0.32436566492711894, 'f1-score': 0.35926413138802515, 'support': 111140}, 'accuracy': 0.37553072592219716, 'macro avg': {'precision': 0.3782352056890382, 'recall': 0.36595695621211527, 'f1-score': 0.3044526752429146, 'support': 333741}, 'weighted avg': {'precision': 0.3782100563759887, 'recall': 0.37553072592219716, 'f1-score': 0.3101927487493328, 'support': 333741}}
[[85459  3164 27220]
 [76659  3821 26278]
 [71651  3439 36050]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1025681
{'0': {'precision': 0.36091057911361296, 'recall': 0.7345396024531339, 'f1-score': 0.4840076121473364, 'support': 114955}, '1': {'precision': 0.3698392003476749, 'recall': 0.031914793875809824, 'f1-score': 0.058759051638573145, 'support': 106659}, '2': {'precision': 0.3976550079491256, 'recall': 0.321225039464179, 'f1-score': 0.3553770787802845, 'support': 112127}, 'accuracy': 0.3711291090995712, 'macro avg': {'precision': 0.3761349291368045, 'recall': 0.3625598119310409, 'f1-score': 0.2993812475220647, 'support': 333741}, 'weighted avg': {'precision': 0.3761090725089205, 'recall': 0.3711291090995712, 'f1-score': 0.30488804928226554, 'support': 333741}}
[[84439  2815 27701]
 [76398  3404 26857]
 [73124  2985 36018]]
Evaluating performance on  train set...
384/384 - 7s - 7s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0981638
{'0': {'precision': 0.36706304050978605, 'recall': 0.7613512317450951, 'f1-score': 0.49532145222123053, 'support': 33895}, '1': {'precision': 0.40419278996865204, 'recall': 0.06396899224806202, 'f1-score': 0.11045671146329711, 'support': 32250}, '2': {'precision': 0.4126018040108591, 'recall': 0.29354225725055294, 'f1-score': 0.3430350024572708, 'support': 32101}, 'accuracy': 0.37957779451580725, 'macro avg': {'precision': 0.3946192114964324, 'recall': 0.3729541604145701, 'f1-score': 0.31627105538059946, 'support': 98246}, 'weighted avg': {'precision': 0.3941305472499727, 'recall': 0.37957779451580725, 'f1-score': 0.3192284284511409, 'support': 98246}}
[[25806  1512  6577]
 [23349  2063  6838]
 [21149  1529  9423]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1020292
{'0': {'precision': 0.362259960456109, 'recall': 0.7928980051575422, 'f1-score': 0.4973089543498266, 'support': 33737}, '1': {'precision': 0.39362995380500854, 'recall': 0.04955616773798592, 'f1-score': 0.08802979637332463, 'support': 32670}, '2': {'precision': 0.4096890246907496, 'recall': 0.26109488363327993, 'f1-score': 0.3189334356416651, 'support': 31839}, 'accuracy': 0.3733688903365022, 'macro avg': {'precision': 0.38852631298395574, 'recall': 0.3678496855096027, 'f1-score': 0.30142406212160544, 'support': 98246}, 'weighted avg': {'precision': 0.38806204561861196, 'recall': 0.3733688903365022, 'f1-score': 0.30340336805377915, 'support': 98246}}
[[26750  1206  5781]
 [24854  1619  6197]
 [22238  1288  8313]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1021119
{'0': {'precision': 0.3608013983421171, 'recall': 0.8082285239677266, 'f1-score': 0.4988922457200403, 'support': 33712}, '1': {'precision': 0.4, 'recall': 0.0446220036877689, 'f1-score': 0.08028753110312412, 'support': 32540}, '2': {'precision': 0.4108807204942926, 'recall': 0.24526473713821342, 'f1-score': 0.30717137712362014, 'support': 31994}, 'accuracy': 0.37198461006046046, 'macro avg': {'precision': 0.39056070627880324, 'recall': 0.36603842159790295, 'f1-score': 0.2954503846489282, 'support': 98246}, 'weighted avg': {'precision': 0.39009277235107637, 'recall': 0.37198461006046046, 'f1-score': 0.2978121520418415, 'support': 98246}}
[[27247  1024  5441]
 [25278  1452  5810]
 [22993  1154  7847]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1015716
{'0': {'precision': 0.35888520168700505, 'recall': 0.8050596120766357, 'f1-score': 0.4964564949019249, 'support': 33718}, '1': {'precision': 0.3858885017421603, 'recall': 0.04159494225532847, 'f1-score': 0.07509535245091115, 'support': 31951}, '2': {'precision': 0.40761805374380383, 'recall': 0.23980108665622984, 'f1-score': 0.30195972324224035, 'support': 32577}, 'accuracy': 0.36933819188567474, 'macro avg': {'precision': 0.38413058572432307, 'recall': 0.362151880329398, 'f1-score': 0.29117052353169215, 'support': 98246}, 'weighted avg': {'precision': 0.3838261922771217, 'recall': 0.36933819188567474, 'f1-score': 0.2949314333949945, 'support': 98246}}
[[27145   974  5599]
 [24868  1329  5754]
 [23624  1141  7812]]
Evaluating performance on  val set...
93/93 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0952488
{'0': {'precision': 0.3644542522491937, 'recall': 0.7896285399043766, 'f1-score': 0.4987224157955865, 'support': 8157}, '1': {'precision': 0.387458006718925, 'recall': 0.04709405199401116, 'f1-score': 0.08398058252427185, 'support': 7347}, '2': {'precision': 0.4243747518856689, 'recall': 0.26395061728395064, 'f1-score': 0.3254681077789618, 'support': 8100}, 'accuracy': 0.3781138790035587, 'macro avg': {'precision': 0.39209567028459585, 'recall': 0.3668910697274462, 'f1-score': 0.3027237020329401, 'support': 23604}, 'weighted avg': {'precision': 0.39217686837970395, 'recall': 0.3781138790035587, 'f1-score': 0.3101752143052031, 'support': 23604}}
[[6441  256 1460]
 [5561  346 1440]
 [5671  291 2138]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0975181
{'0': {'precision': 0.36152535151256926, 'recall': 0.8352405561707887, 'f1-score': 0.5046277366836414, 'support': 8127}, '1': {'precision': 0.40064102564102566, 'recall': 0.0334851326011251, 'f1-score': 0.06180469715698393, 'support': 7466}, '2': {'precision': 0.4291151284490961, 'recall': 0.22519036325053052, 'f1-score': 0.29537453950061404, 'support': 8011}, 'accuracy': 0.37459752584307743, 'macro avg': {'precision': 0.397093835200897, 'recall': 0.3646386840074814, 'f1-score': 0.28726899111374643, 'support': 23604}, 'weighted avg': {'precision': 0.39683713451890595, 'recall': 0.37459752584307743, 'f1-score': 0.2935429978368672, 'support': 23604}}
[[6788  169 1170]
 [5986  250 1230]
 [6002  205 1804]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0986617
{'0': {'precision': 0.35993164871582434, 'recall': 0.8591027067111605, 'f1-score': 0.5073167171477575, 'support': 8091}, '1': {'precision': 0.4092827004219409, 'recall': 0.02589428723972237, 'f1-score': 0.048707004770273656, 'support': 7492}, '2': {'precision': 0.43033001571503404, 'recall': 0.20483730208203466, 'f1-score': 0.2775572261170707, 'support': 8021}, 'accuracy': 0.37230977800372816, 'macro avg': {'precision': 0.39984812161759975, 'recall': 0.36327809867763916, 'f1-score': 0.27786031601170064, 'support': 23604}, 'weighted avg': {'precision': 0.39951830271865807, 'recall': 0.37230977800372816, 'f1-score': 0.28367645097722505, 'support': 23604}}
[[6951  123 1017]
 [6140  194 1158]
 [6221  157 1643]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0977927
{'0': {'precision': 0.35916979966009166, 'recall': 0.8575996064928677, 'f1-score': 0.5062978692511524, 'support': 8132}, '1': {'precision': 0.3661616161616162, 'recall': 0.019814156873462694, 'f1-score': 0.03759398496240601, 'support': 7318}, '2': {'precision': 0.4159852281719863, 'recall': 0.19340201128280599, 'f1-score': 0.2640435328589368, 'support': 8154}, 'accuracy': 0.3684121335366887, 'macro avg': {'precision': 0.3804388813312314, 'recall': 0.35693859154971214, 'f1-score': 0.26931179569083175, 'support': 23604}, 'weighted avg': {'precision': 0.38096437334438854, 'recall': 0.3684121335366887, 'f1-score': 0.2772978317927906, 'support': 23604}}
[[6974  102 1056]
 [6015  145 1158]
 [6428  149 1577]]
training model: results/CHTR/W1/deepOF_L2/seq2seq
Epoch 1/50
384/384 - 17s - loss: 13.2056 - accuracy10: 0.3708 - accuracy20: 0.3679 - accuracy30: 0.3646 - accuracy50: 0.3606 - val_loss: 13.1616 - val_accuracy10: 0.3928 - val_accuracy20: 0.3843 - val_accuracy30: 0.3785 - val_accuracy50: 0.3749 - 17s/epoch - 44ms/step
Epoch 2/50
384/384 - 11s - loss: 12.9990 - accuracy10: 0.4098 - accuracy20: 0.4031 - accuracy30: 0.3982 - accuracy50: 0.3878 - val_loss: 13.1037 - val_accuracy10: 0.3995 - val_accuracy20: 0.3962 - val_accuracy30: 0.3871 - val_accuracy50: 0.3851 - 11s/epoch - 29ms/step
Epoch 3/50
384/384 - 11s - loss: 12.9200 - accuracy10: 0.4240 - accuracy20: 0.4151 - accuracy30: 0.4093 - accuracy50: 0.3985 - val_loss: 13.0689 - val_accuracy10: 0.4044 - val_accuracy20: 0.3973 - val_accuracy30: 0.3897 - val_accuracy50: 0.3848 - 11s/epoch - 29ms/step
Epoch 4/50
384/384 - 11s - loss: 12.8739 - accuracy10: 0.4288 - accuracy20: 0.4204 - accuracy30: 0.4150 - accuracy50: 0.4033 - val_loss: 13.0451 - val_accuracy10: 0.4069 - val_accuracy20: 0.4012 - val_accuracy30: 0.3930 - val_accuracy50: 0.3852 - 11s/epoch - 29ms/step
Epoch 5/50
384/384 - 11s - loss: 12.8417 - accuracy10: 0.4345 - accuracy20: 0.4253 - accuracy30: 0.4179 - accuracy50: 0.4063 - val_loss: 13.0159 - val_accuracy10: 0.4111 - val_accuracy20: 0.4026 - val_accuracy30: 0.3938 - val_accuracy50: 0.3891 - 11s/epoch - 29ms/step
Epoch 6/50
384/384 - 11s - loss: 12.8030 - accuracy10: 0.4383 - accuracy20: 0.4305 - accuracy30: 0.4242 - accuracy50: 0.4122 - val_loss: 12.9991 - val_accuracy10: 0.4137 - val_accuracy20: 0.4047 - val_accuracy30: 0.3963 - val_accuracy50: 0.3911 - 11s/epoch - 29ms/step
Epoch 7/50
384/384 - 11s - loss: 12.7724 - accuracy10: 0.4419 - accuracy20: 0.4326 - accuracy30: 0.4277 - accuracy50: 0.4149 - val_loss: 12.9888 - val_accuracy10: 0.4176 - val_accuracy20: 0.4054 - val_accuracy30: 0.3953 - val_accuracy50: 0.3914 - 11s/epoch - 28ms/step
Epoch 8/50
384/384 - 11s - loss: 12.7416 - accuracy10: 0.4451 - accuracy20: 0.4367 - accuracy30: 0.4308 - accuracy50: 0.4189 - val_loss: 13.0126 - val_accuracy10: 0.4132 - val_accuracy20: 0.4046 - val_accuracy30: 0.3991 - val_accuracy50: 0.3926 - 11s/epoch - 29ms/step
Epoch 9/50
384/384 - 11s - loss: 12.7133 - accuracy10: 0.4490 - accuracy20: 0.4417 - accuracy30: 0.4347 - accuracy50: 0.4214 - val_loss: 12.9957 - val_accuracy10: 0.4177 - val_accuracy20: 0.4065 - val_accuracy30: 0.4008 - val_accuracy50: 0.3946 - 11s/epoch - 29ms/step
Epoch 10/50
384/384 - 11s - loss: 12.6814 - accuracy10: 0.4511 - accuracy20: 0.4438 - accuracy30: 0.4390 - accuracy50: 0.4264 - val_loss: 13.0047 - val_accuracy10: 0.4184 - val_accuracy20: 0.4085 - val_accuracy30: 0.3993 - val_accuracy50: 0.3924 - 11s/epoch - 28ms/step
Epoch 11/50
384/384 - 11s - loss: 12.6480 - accuracy10: 0.4547 - accuracy20: 0.4487 - accuracy30: 0.4433 - accuracy50: 0.4299 - val_loss: 13.0196 - val_accuracy10: 0.4191 - val_accuracy20: 0.4065 - val_accuracy30: 0.3997 - val_accuracy50: 0.3920 - 11s/epoch - 29ms/step
Epoch 12/50
384/384 - 10s - loss: 12.6165 - accuracy10: 0.4586 - accuracy20: 0.4530 - accuracy30: 0.4477 - accuracy50: 0.4329 - val_loss: 13.0247 - val_accuracy10: 0.4221 - val_accuracy20: 0.4115 - val_accuracy30: 0.4032 - val_accuracy50: 0.3931 - 10s/epoch - 27ms/step
Epoch 13/50
384/384 - 11s - loss: 12.5855 - accuracy10: 0.4605 - accuracy20: 0.4571 - accuracy30: 0.4525 - accuracy50: 0.4368 - val_loss: 13.0233 - val_accuracy10: 0.4226 - val_accuracy20: 0.4101 - val_accuracy30: 0.4021 - val_accuracy50: 0.3939 - 11s/epoch - 29ms/step
Epoch 14/50
384/384 - 11s - loss: 12.5455 - accuracy10: 0.4640 - accuracy20: 0.4600 - accuracy30: 0.4575 - accuracy50: 0.4414 - val_loss: 13.1077 - val_accuracy10: 0.4129 - val_accuracy20: 0.4055 - val_accuracy30: 0.3997 - val_accuracy50: 0.3899 - 11s/epoch - 29ms/step
Epoch 15/50
384/384 - 11s - loss: 12.5120 - accuracy10: 0.4659 - accuracy20: 0.4630 - accuracy30: 0.4590 - accuracy50: 0.4435 - val_loss: 13.0896 - val_accuracy10: 0.4146 - val_accuracy20: 0.4061 - val_accuracy30: 0.3998 - val_accuracy50: 0.3914 - 11s/epoch - 28ms/step
Epoch 16/50
384/384 - 11s - loss: 12.4855 - accuracy10: 0.4676 - accuracy20: 0.4668 - accuracy30: 0.4618 - accuracy50: 0.4472 - val_loss: 13.0559 - val_accuracy10: 0.4216 - val_accuracy20: 0.4112 - val_accuracy30: 0.4040 - val_accuracy50: 0.3946 - 11s/epoch - 28ms/step
Epoch 17/50
384/384 - 11s - loss: 12.4458 - accuracy10: 0.4711 - accuracy20: 0.4702 - accuracy30: 0.4663 - accuracy50: 0.4504 - val_loss: 13.0795 - val_accuracy10: 0.4168 - val_accuracy20: 0.4051 - val_accuracy30: 0.3979 - val_accuracy50: 0.3921 - 11s/epoch - 28ms/step
testing model: results/CHTR/W1/deepOF_L2/seq2seq
Evaluating performance on  test set...
1304/1304 - 14s - 14s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.064361
{'0': {'precision': 0.42180884114508266, 'recall': 0.5627109664077388, 'f1-score': 0.4821771158267797, 'support': 117021}, '1': {'precision': 0.42816045249162954, 'recall': 0.25391822335318953, 'f1-score': 0.318783581005857, 'support': 103746}, '2': {'precision': 0.4439056322621211, 'recall': 0.45620479954677834, 'f1-score': 0.44997118759495, 'support': 112969}, 'accuracy': 0.4306667545604909, 'macro avg': {'precision': 0.4312916419662778, 'recall': 0.42427799643590225, 'f1-score': 0.4169772948091956, 'support': 333736}, 'weighted avg': {'precision': 0.4312630404716748, 'recall': 0.4306667545604909, 'f1-score': 0.4204825513508076, 'support': 333736}}
[[65849 16226 34946]
 [47787 26343 29616]
 [42475 18957 51537]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.071191
{'0': {'precision': 0.41197367939154955, 'recall': 0.5824954473663769, 'f1-score': 0.48261486701490564, 'support': 115867}, '1': {'precision': 0.43691636842321774, 'recall': 0.198789035814219, 'f1-score': 0.2732529345553948, 'support': 106857}, '2': {'precision': 0.42878343171849753, 'recall': 0.4684898929845422, 'f1-score': 0.44775811006267646, 'support': 111012}, 'accuracy': 0.4217165663878035, 'macro avg': {'precision': 0.42589115984442155, 'recall': 0.4165914587217127, 'f1-score': 0.40120863721099226, 'support': 333736}, 'weighted avg': {'precision': 0.4255514329068314, 'recall': 0.4217165663878035, 'f1-score': 0.40398593180981296, 'support': 333736}}
[[67492 12516 35859]
 [52190 21242 33425]
 [44144 14860 52008]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0752264
{'0': {'precision': 0.40857173419541937, 'recall': 0.5935082872928177, 'f1-score': 0.48397474253292694, 'support': 115840}, '1': {'precision': 0.4417058914808876, 'recall': 0.15997864328668576, 'f1-score': 0.23488557597095386, 'support': 106758}, '2': {'precision': 0.4237515379034039, 'recall': 0.48345300437294175, 'f1-score': 0.45163784915144534, 'support': 111138}, 'accuracy': 0.4181778411678692, 'macro avg': {'precision': 0.4246763878599036, 'recall': 0.4123133116508151, 'f1-score': 0.3901660558851087, 'support': 333736}, 'weighted avg': {'precision': 0.42422599201591227, 'recall': 0.4181778411678692, 'f1-score': 0.3935256483373525, 'support': 333736}}
[[68752  9777 37311]
 [53924 17079 35755]
 [45598 11810 53730]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0808914
{'0': {'precision': 0.3997434425557339, 'recall': 0.5936825805553623, 'f1-score': 0.47778236731379126, 'support': 114952}, '1': {'precision': 0.44272039041481576, 'recall': 0.13268578071968348, 'f1-score': 0.20417820867959374, 'support': 106658}, '2': {'precision': 0.4193577925645565, 'recall': 0.4901271783529244, 'f1-score': 0.45198911067795083, 'support': 112126}, 'accuracy': 0.4115618333053671, 'macro avg': {'precision': 0.4206072085117021, 'recall': 0.4054985132093234, 'f1-score': 0.3779832288904453, 'support': 333736}, 'weighted avg': {'precision': 0.4200682319516732, 'recall': 0.4115618333053671, 'f1-score': 0.38167596271507703, 'support': 333736}}
[[68245  7993 38714]
 [55128 14152 37378]
 [47349  9821 54956]]
Evaluating performance on  train set...
384/384 - 4s - 4s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0566596
{'0': {'precision': 0.4267866390471258, 'recall': 0.5832448690728945, 'f1-score': 0.49289772727272724, 'support': 33912}, '1': {'precision': 0.4616276261772519, 'recall': 0.29556558847176695, 'f1-score': 0.3603868559470618, 'support': 32338}, '2': {'precision': 0.44361456596999616, 'recall': 0.4325363338021566, 'f1-score': 0.4380054121631245, 'support': 31995}, 'accuracy': 0.4394727467046669, 'macro avg': {'precision': 0.44400961039812464, 'recall': 0.43711559711560605, 'f1-score': 0.4304299984609712, 'support': 98245}, 'weighted avg': {'precision': 0.4437350574268017, 'recall': 0.4394727467046669, 'f1-score': 0.43140435683289713, 'support': 98245}}
[[19779  5267  8866]
 [14289  9558  8491]
 [12276  5880 13839]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0631678
{'0': {'precision': 0.41975333976318974, 'recall': 0.606109991703212, 'f1-score': 0.49600504370809545, 'support': 33748}, '1': {'precision': 0.4675978658353816, 'recall': 0.23932987634623054, 'f1-score': 0.31660983925962005, 'support': 32591}, '2': {'precision': 0.4298723844912131, 'recall': 0.4423619381934432, 'f1-score': 0.4360277421646921, 'support': 31906}, 'accuracy': 0.43125858822331925, 'macro avg': {'precision': 0.43907453002992813, 'recall': 0.4292672687476286, 'f1-score': 0.4162142083774692, 'support': 98245}, 'weighted avg': {'precision': 0.4389111512580354, 'recall': 0.43125858822331925, 'f1-score': 0.41701573238208306, 'support': 98245}}
[[20455  4145  9148]
 [15220  7800  9571]
 [13056  4736 14114]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0679115
{'0': {'precision': 0.41534449465490814, 'recall': 0.6180827112217088, 'f1-score': 0.49682696543594995, 'support': 33756}, '1': {'precision': 0.4732931135962331, 'recall': 0.19811524129223, 'f1-score': 0.27931311464733083, 'support': 32471}, '2': {'precision': 0.42117954677513075, 'recall': 0.45277656318320947, 'f1-score': 0.4364068755832506, 'support': 32018}, 'accuracy': 0.425405873072421, 'macro avg': {'precision': 0.43660571834209067, 'recall': 0.4229915052323827, 'f1-score': 0.40418231855551046, 'support': 98245}, 'weighted avg': {'precision': 0.4363987600570054, 'recall': 0.425405873072421, 'f1-score': 0.4052454835706033, 'support': 98245}}
[[20864  3384  9508]
 [15623  6433 10415]
 [13746  3775 14497]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0757487
{'0': {'precision': 0.40486743018512705, 'recall': 0.612956859950714, 'f1-score': 0.48764068829497, 'support': 33681}, '1': {'precision': 0.4567337257313538, 'recall': 0.16292698213726103, 'f1-score': 0.24017739588386114, 'support': 31910}, '2': {'precision': 0.41471982157792026, 'recall': 0.45556440252342745, 'f1-score': 0.4341836436868834, 'support': 32654}, 'accuracy': 0.4144740190340475, 'macro avg': {'precision': 0.425440325831467, 'recall': 0.4104827482038009, 'f1-score': 0.3873339092885715, 'support': 98245}, 'weighted avg': {'precision': 0.4249882859988618, 'recall': 0.4144740190340475, 'f1-score': 0.3894968642278832, 'support': 98245}}
[[20645  2858 10178]
 [15895  5199 10816]
 [14452  3326 14876]]
Evaluating performance on  val set...
93/93 - 1s - 1s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0707026
{'0': {'precision': 0.3961728085568647, 'recall': 0.5876301437778879, 'f1-score': 0.473271774394809, 'support': 8068}, '1': {'precision': 0.4101427868045298, 'recall': 0.22731614135625597, 'f1-score': 0.29251163199016766, 'support': 7329}, '2': {'precision': 0.4521452145214521, 'recall': 0.4173266723528695, 'f1-score': 0.43403877835508803, 'support': 8207}, 'accuracy': 0.41653956956448057, 'macro avg': {'precision': 0.41948693662761555, 'recall': 0.41075765249567114, 'f1-score': 0.39994072824668825, 'support': 23604}, 'weighted avg': {'precision': 0.4199718047578691, 'recall': 0.41653956956448057, 'f1-score': 0.40350494325679825, 'support': 23604}}
[[4741 1078 2249]
 [3762 1666 1901]
 [3464 1318 3425]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0789094
{'0': {'precision': 0.39323266661396156, 'recall': 0.6162805104695824, 'f1-score': 0.4801158301158301, 'support': 8071}, '1': {'precision': 0.3858605880409646, 'recall': 0.15753978958726733, 'f1-score': 0.22373335887367113, 'support': 7414}, '2': {'precision': 0.43365287588294654, 'recall': 0.4234511639364454, 'f1-score': 0.42849130678631525, 'support': 8119}, 'accuracy': 0.4058634129808507, 'macro avg': {'precision': 0.40424871017929087, 'recall': 0.39909048799776503, 'f1-score': 0.3774468319252722, 'support': 23604}, 'weighted avg': {'precision': 0.4048203249987561, 'recall': 0.4058634129808507, 'f1-score': 0.3818291352038789, 'support': 23604}}
[[4974  848 2249]
 [4005 1168 2241]
 [3670 1011 3438]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0846903
{'0': {'precision': 0.3851132686084142, 'recall': 0.621332670313277, 'f1-score': 0.475501855199315, 'support': 8044}, '1': {'precision': 0.37290322580645163, 'recall': 0.11572343833422317, 'f1-score': 0.17663237241519814, 'support': 7492}, '2': {'precision': 0.42428623057462955, 'recall': 0.4365394149727318, 'f1-score': 0.43032561549269965, 'support': 8068}, 'accuracy': 0.39768683274021355, 'macro avg': {'precision': 0.39410090832983186, 'recall': 0.39119850787341065, 'f1-score': 0.3608199477024043, 'support': 23604}, 'weighted avg': {'precision': 0.39462732624572666, 'recall': 0.39768683274021355, 'f1-score': 0.36519800555639115, 'support': 23604}}
[[4998  661 2385]
 [4231  867 2394]
 [3749  797 3522]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0884886
{'0': {'precision': 0.3822523002053076, 'recall': 0.6227700693756194, 'f1-score': 0.4737313292183009, 'support': 8072}, '1': {'precision': 0.3788285867813004, 'recall': 0.09610141766630316, 'f1-score': 0.15331086223768622, 'support': 7336}, '2': {'precision': 0.4127094972067039, 'recall': 0.43265007320644217, 'f1-score': 0.4224446032880629, 'support': 8196}, 'accuracy': 0.39306897136078633, 'macro avg': {'precision': 0.3912634613977706, 'recall': 0.3838405200827883, 'f1-score': 0.34982893158135003, 'support': 23604}, 'weighted avg': {'precision': 0.3917638586252757, 'recall': 0.39306897136078633, 'f1-score': 0.3563380674197066, 'support': 23604}}
[[5027  517 2528]
 [4113  705 2518]
 [4011  639 3546]]
training model: results/CHTR/W1/deepVOL_L2/seq2seq
Epoch 1/50
384/384 - 16s - loss: 13.2228 - accuracy10: 0.3609 - accuracy20: 0.3643 - accuracy30: 0.3653 - accuracy50: 0.3605 - val_loss: 13.1458 - val_accuracy10: 0.3740 - val_accuracy20: 0.3634 - val_accuracy30: 0.3618 - val_accuracy50: 0.3616 - 16s/epoch - 43ms/step
Epoch 2/50
384/384 - 11s - loss: 13.1237 - accuracy10: 0.3761 - accuracy20: 0.3776 - accuracy30: 0.3769 - accuracy50: 0.3721 - val_loss: 13.0754 - val_accuracy10: 0.3861 - val_accuracy20: 0.3822 - val_accuracy30: 0.3805 - val_accuracy50: 0.3808 - 11s/epoch - 28ms/step
Epoch 3/50
384/384 - 10s - loss: 13.0727 - accuracy10: 0.3846 - accuracy20: 0.3868 - accuracy30: 0.3860 - accuracy50: 0.3784 - val_loss: 13.0431 - val_accuracy10: 0.3939 - val_accuracy20: 0.3914 - val_accuracy30: 0.3919 - val_accuracy50: 0.3856 - 10s/epoch - 27ms/step
Epoch 4/50
384/384 - 10s - loss: 13.0316 - accuracy10: 0.3959 - accuracy20: 0.3959 - accuracy30: 0.3955 - accuracy50: 0.3848 - val_loss: 13.0330 - val_accuracy10: 0.3986 - val_accuracy20: 0.3888 - val_accuracy30: 0.3850 - val_accuracy50: 0.3817 - 10s/epoch - 27ms/step
Epoch 5/50
384/384 - 11s - loss: 13.0008 - accuracy10: 0.4027 - accuracy20: 0.4017 - accuracy30: 0.4004 - accuracy50: 0.3884 - val_loss: 13.0023 - val_accuracy10: 0.4023 - val_accuracy20: 0.3939 - val_accuracy30: 0.3900 - val_accuracy50: 0.3779 - 11s/epoch - 28ms/step
Epoch 6/50
384/384 - 11s - loss: 12.9696 - accuracy10: 0.4085 - accuracy20: 0.4081 - accuracy30: 0.4045 - accuracy50: 0.3928 - val_loss: 13.0218 - val_accuracy10: 0.4007 - val_accuracy20: 0.3902 - val_accuracy30: 0.3841 - val_accuracy50: 0.3716 - 11s/epoch - 27ms/step
Epoch 7/50
384/384 - 11s - loss: 12.9511 - accuracy10: 0.4126 - accuracy20: 0.4120 - accuracy30: 0.4093 - accuracy50: 0.3955 - val_loss: 12.9830 - val_accuracy10: 0.4102 - val_accuracy20: 0.4000 - val_accuracy30: 0.3913 - val_accuracy50: 0.3803 - 11s/epoch - 28ms/step
Epoch 8/50
384/384 - 11s - loss: 12.9325 - accuracy10: 0.4160 - accuracy20: 0.4156 - accuracy30: 0.4111 - accuracy50: 0.3966 - val_loss: 12.9870 - val_accuracy10: 0.4092 - val_accuracy20: 0.3985 - val_accuracy30: 0.3929 - val_accuracy50: 0.3847 - 11s/epoch - 28ms/step
Epoch 9/50
384/384 - 11s - loss: 12.9192 - accuracy10: 0.4183 - accuracy20: 0.4171 - accuracy30: 0.4117 - accuracy50: 0.3979 - val_loss: 12.9876 - val_accuracy10: 0.4098 - val_accuracy20: 0.3971 - val_accuracy30: 0.3905 - val_accuracy50: 0.3765 - 11s/epoch - 28ms/step
Epoch 10/50
384/384 - 11s - loss: 12.8914 - accuracy10: 0.4205 - accuracy20: 0.4203 - accuracy30: 0.4151 - accuracy50: 0.4020 - val_loss: 12.9819 - val_accuracy10: 0.4103 - val_accuracy20: 0.3996 - val_accuracy30: 0.3904 - val_accuracy50: 0.3800 - 11s/epoch - 28ms/step
Epoch 11/50
384/384 - 11s - loss: 12.8845 - accuracy10: 0.4222 - accuracy20: 0.4213 - accuracy30: 0.4180 - accuracy50: 0.4045 - val_loss: 12.9886 - val_accuracy10: 0.4087 - val_accuracy20: 0.3998 - val_accuracy30: 0.3922 - val_accuracy50: 0.3820 - 11s/epoch - 27ms/step
Epoch 12/50
384/384 - 11s - loss: 12.8673 - accuracy10: 0.4221 - accuracy20: 0.4225 - accuracy30: 0.4191 - accuracy50: 0.4057 - val_loss: 12.9872 - val_accuracy10: 0.4084 - val_accuracy20: 0.3985 - val_accuracy30: 0.3928 - val_accuracy50: 0.3822 - 11s/epoch - 29ms/step
Epoch 13/50
384/384 - 11s - loss: 12.8486 - accuracy10: 0.4259 - accuracy20: 0.4259 - accuracy30: 0.4208 - accuracy50: 0.4068 - val_loss: 12.9728 - val_accuracy10: 0.4096 - val_accuracy20: 0.4024 - val_accuracy30: 0.3927 - val_accuracy50: 0.3848 - 11s/epoch - 28ms/step
Epoch 14/50
384/384 - 11s - loss: 12.8352 - accuracy10: 0.4267 - accuracy20: 0.4274 - accuracy30: 0.4226 - accuracy50: 0.4080 - val_loss: 12.9776 - val_accuracy10: 0.4105 - val_accuracy20: 0.4027 - val_accuracy30: 0.3925 - val_accuracy50: 0.3857 - 11s/epoch - 28ms/step
Epoch 15/50
384/384 - 11s - loss: 12.8187 - accuracy10: 0.4280 - accuracy20: 0.4288 - accuracy30: 0.4232 - accuracy50: 0.4094 - val_loss: 13.0072 - val_accuracy10: 0.4068 - val_accuracy20: 0.3965 - val_accuracy30: 0.3935 - val_accuracy50: 0.3838 - 11s/epoch - 28ms/step
Epoch 16/50
384/384 - 10s - loss: 12.8120 - accuracy10: 0.4292 - accuracy20: 0.4301 - accuracy30: 0.4258 - accuracy50: 0.4111 - val_loss: 13.0043 - val_accuracy10: 0.4056 - val_accuracy20: 0.3980 - val_accuracy30: 0.3916 - val_accuracy50: 0.3829 - 10s/epoch - 27ms/step
Epoch 17/50
384/384 - 11s - loss: 12.7894 - accuracy10: 0.4318 - accuracy20: 0.4323 - accuracy30: 0.4274 - accuracy50: 0.4134 - val_loss: 12.9752 - val_accuracy10: 0.4105 - val_accuracy20: 0.3995 - val_accuracy30: 0.3958 - val_accuracy50: 0.3890 - 11s/epoch - 28ms/step
Epoch 18/50
384/384 - 11s - loss: 12.7714 - accuracy10: 0.4323 - accuracy20: 0.4346 - accuracy30: 0.4302 - accuracy50: 0.4161 - val_loss: 13.0084 - val_accuracy10: 0.4047 - val_accuracy20: 0.4004 - val_accuracy30: 0.3920 - val_accuracy50: 0.3869 - 11s/epoch - 29ms/step
Epoch 19/50
384/384 - 11s - loss: 12.7646 - accuracy10: 0.4327 - accuracy20: 0.4353 - accuracy30: 0.4314 - accuracy50: 0.4167 - val_loss: 13.0042 - val_accuracy10: 0.4081 - val_accuracy20: 0.3974 - val_accuracy30: 0.3908 - val_accuracy50: 0.3836 - 11s/epoch - 28ms/step
Epoch 20/50
384/384 - 11s - loss: 12.7519 - accuracy10: 0.4332 - accuracy20: 0.4354 - accuracy30: 0.4311 - accuracy50: 0.4168 - val_loss: 13.0075 - val_accuracy10: 0.4079 - val_accuracy20: 0.3974 - val_accuracy30: 0.3919 - val_accuracy50: 0.3843 - 11s/epoch - 28ms/step
Epoch 21/50
384/384 - 11s - loss: 12.7478 - accuracy10: 0.4335 - accuracy20: 0.4362 - accuracy30: 0.4309 - accuracy50: 0.4163 - val_loss: 12.9775 - val_accuracy10: 0.4097 - val_accuracy20: 0.3971 - val_accuracy30: 0.3918 - val_accuracy50: 0.3832 - 11s/epoch - 27ms/step
Epoch 22/50
384/384 - 11s - loss: 12.7230 - accuracy10: 0.4366 - accuracy20: 0.4380 - accuracy30: 0.4352 - accuracy50: 0.4200 - val_loss: 12.9999 - val_accuracy10: 0.4077 - val_accuracy20: 0.3981 - val_accuracy30: 0.3911 - val_accuracy50: 0.3844 - 11s/epoch - 29ms/step
Epoch 23/50
384/384 - 10s - loss: 12.7127 - accuracy10: 0.4375 - accuracy20: 0.4391 - accuracy30: 0.4342 - accuracy50: 0.4197 - val_loss: 12.9966 - val_accuracy10: 0.4130 - val_accuracy20: 0.4029 - val_accuracy30: 0.3938 - val_accuracy50: 0.3861 - 10s/epoch - 27ms/step
testing model: results/CHTR/W1/deepVOL_L2/seq2seq
Evaluating performance on  test set...
1304/1304 - 13s - 13s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0726947
{'0': {'precision': 0.42976258786400806, 'recall': 0.40961528601459557, 'f1-score': 0.419447142519623, 'support': 117022}, '1': {'precision': 0.4044274297332079, 'recall': 0.3604599606739407, 'f1-score': 0.3811800200798096, 'support': 103748}, '2': {'precision': 0.40204723438367146, 'recall': 0.4617114126634269, 'f1-score': 0.4298186702484889, 'support': 112971}, 'accuracy': 0.4119691617152223, 'macro avg': {'precision': 0.4120790839936291, 'recall': 0.4105955531173211, 'f1-score': 0.41014861094930716, 'support': 333741}, 'weighted avg': {'precision': 0.412505184117446, 'recall': 0.4119691617152223, 'f1-score': 0.41106203083173315, 'support': 333741}}
[[47934 28034 41054]
 [29829 37397 36522]
 [33773 27038 52160]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0777186
{'0': {'precision': 0.42247025264149435, 'recall': 0.4102995624368899, 'f1-score': 0.41629597197898427, 'support': 115869}, '1': {'precision': 0.4057695827232797, 'recall': 0.3319701662939013, 'f1-score': 0.3651786311720531, 'support': 106859}, '2': {'precision': 0.3910498856382581, 'recall': 0.4712691306423572, 'f1-score': 0.42742821661853186, 'support': 111013}, 'accuracy': 0.4055000734102193, 'macro avg': {'precision': 0.40642990700101067, 'recall': 0.4045129531243828, 'f1-score': 0.4029676065898564, 'support': 333741}, 'weighted avg': {'precision': 0.40667151622936415, 'recall': 0.4055000734102193, 'f1-score': 0.4036318880123222, 'support': 333741}}
[[47541 26418 41910]
 [31826 35474 39559]
 [33164 25532 52317]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0823277
{'0': {'precision': 0.4117805458557009, 'recall': 0.40921764802361815, 'f1-score': 0.41049509665966705, 'support': 115843}, '1': {'precision': 0.39438468237516405, 'recall': 0.30117649262818713, 'f1-score': 0.34153543829832433, 'support': 106758}, '2': {'precision': 0.3850844688238555, 'recall': 0.4750044988303041, 'f1-score': 0.42534403300138574, 'support': 111140}, 'accuracy': 0.3965650010037724, 'macro avg': {'precision': 0.39708323235157345, 'recall': 0.39513287982736983, 'f1-score': 0.3924581893197924, 'support': 333741}, 'weighted avg': {'precision': 0.3973257752558213, 'recall': 0.3965650010037724, 'f1-score': 0.3933809739647581, 'support': 333741}}
[[47405 24995 43443]
 [33748 32153 40857]
 [33969 24379 52792]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0883038
{'0': {'precision': 0.3949327346690748, 'recall': 0.40706363359575487, 'f1-score': 0.40090643888605687, 'support': 114955}, '1': {'precision': 0.38255557171759913, 'recall': 0.27123824524887724, 'f1-score': 0.31742026091440734, 'support': 106659}, '2': {'precision': 0.3777071158473702, 'recall': 0.4703595030634905, 'f1-score': 0.4189721122184311, 'support': 112127}, 'accuracy': 0.38492124132186334, 'macro avg': {'precision': 0.3850651407446814, 'recall': 0.3828871273027075, 'f1-score': 0.37909960400629844, 'support': 333741}, 'weighted avg': {'precision': 0.38518987183573183, 'recall': 0.38492124132186334, 'f1-score': 0.3802949392425038, 'support': 333741}}
[[46794 23192 44969]
 [35806 28930 41923]
 [35886 23501 52740]]
Evaluating performance on  train set...
384/384 - 4s - 4s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0685887
{'0': {'precision': 0.42440310780922136, 'recall': 0.44156955303142054, 'f1-score': 0.43281618253061693, 'support': 33895}, '1': {'precision': 0.42898344311910275, 'recall': 0.3735813953488372, 'f1-score': 0.399370183144112, 'support': 32250}, '2': {'precision': 0.41487319100157616, 'recall': 0.4509828354256877, 'f1-score': 0.43217505522717775, 'support': 32101}, 'accuracy': 0.4223276265700385, 'macro avg': {'precision': 0.4227532473099667, 'recall': 0.4220445946019818, 'f1-score': 0.4214538069673022, 'support': 98246}, 'weighted avg': {'precision': 0.4227928229559088, 'recall': 0.4223276265700385, 'f1-score': 0.42162779513792426, 'support': 98246}}
[[14967  8369 10559]
 [10343 12048  9859]
 [ 9956  7668 14477]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0713944
{'0': {'precision': 0.4191145702569253, 'recall': 0.44532708895278184, 'f1-score': 0.4318234076799265, 'support': 33737}, '1': {'precision': 0.4215397401027501, 'recall': 0.3415671870217325, 'f1-score': 0.3773629569510669, 'support': 32670}, '2': {'precision': 0.40902385392601665, 'recall': 0.46154087754012374, 'f1-score': 0.43369831478912724, 'support': 31839}, 'accuracy': 0.41607800826496755, 'macro avg': {'precision': 0.4165593880952307, 'recall': 0.41614505117154604, 'f1-score': 0.41429489314004025, 'support': 98246}, 'weighted avg': {'precision': 0.41665087689132563, 'recall': 0.41607800826496755, 'f1-score': 0.4143211403320243, 'support': 98246}}
[[15024  8033 10680]
 [10959 11159 10552]
 [ 9864  7280 14695]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0754942
{'0': {'precision': 0.4118125830868987, 'recall': 0.4502551020408163, 'f1-score': 0.4301767014779442, 'support': 33712}, '1': {'precision': 0.4138353479255145, 'recall': 0.3114320835894284, 'f1-score': 0.35540436276916604, 'support': 32540}, '2': {'precision': 0.40299195100138213, 'recall': 0.4647746452459836, 'f1-score': 0.4316839156372926, 'support': 31994}, 'accuracy': 0.4090039289131364, 'macro avg': {'precision': 0.4095466273379318, 'recall': 0.4088206102920761, 'f1-score': 0.40575499329480086, 'support': 98246}, 'weighted avg': {'precision': 0.40961008593591586, 'recall': 0.4090039289131364, 'f1-score': 0.4059022262650149, 'support': 98246}}
[[15179  7546 10987]
 [11364 10134 11042]
 [10316  6808 14870]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0822642
{'0': {'precision': 0.39480806116818623, 'recall': 0.44563734503825847, 'f1-score': 0.4186856513925073, 'support': 33718}, '1': {'precision': 0.3955508286803155, 'recall': 0.2793652780820632, 'f1-score': 0.3274574903241191, 'support': 31951}, '2': {'precision': 0.3972515350469153, 'recall': 0.45875924732173007, 'f1-score': 0.425795606712442, 'support': 32577}, 'accuracy': 0.3959143374793885, 'macro avg': {'precision': 0.3958701416318056, 'recall': 0.3945872901473506, 'f1-score': 0.3906462494763561, 'support': 98246}, 'weighted avg': {'precision': 0.39585984152898873, 'recall': 0.3959143374793885, 'f1-score': 0.39137451445218857, 'support': 98246}}
[[15026  7214 11478]
 [11827  8926 11198]
 [11206  6426 14945]]
Evaluating performance on  val set...
93/93 - 1s - 1s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0729135
{'0': {'precision': 0.4147631133671743, 'recall': 0.48081402476400636, 'f1-score': 0.44535286436155114, 'support': 8157}, '1': {'precision': 0.38693270735524254, 'recall': 0.2692255342316592, 'f1-score': 0.3175214704229874, 'support': 7347}, '2': {'precision': 0.4160026560424967, 'recall': 0.4640740740740741, 'f1-score': 0.4387254901960784, 'support': 8100}, 'accuracy': 0.40921030333841724, 'macro avg': {'precision': 0.4058994922549712, 'recall': 0.4047045443565798, 'f1-score': 0.400533274993539, 'support': 23604}, 'weighted avg': {'precision': 0.4065259629986117, 'recall': 0.40921030333841724, 'f1-score': 0.40328969786405255, 'support': 23604}}
[[3922 1511 2724]
 [2816 1978 2553]
 [2718 1623 3759]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0782299
{'0': {'precision': 0.4091760299625468, 'recall': 0.4839424141749723, 'f1-score': 0.44342973110096395, 'support': 8127}, '1': {'precision': 0.3669686117547925, 'recall': 0.2333244039646397, 'f1-score': 0.2852697944812904, 'support': 7466}, '2': {'precision': 0.408112493239589, 'recall': 0.47097740606665833, 'f1-score': 0.4372971719981456, 'support': 8011}, 'accuracy': 0.4002711404846636, 'macro avg': {'precision': 0.39475237831897614, 'recall': 0.39608140806875675, 'f1-score': 0.3886655658601333, 'support': 23604}, 'weighted avg': {'precision': 0.3954647701325727, 'recall': 0.4002711404846636, 'f1-score': 0.3913220367366545, 'support': 23604}}
[[3933 1460 2734]
 [2986 1742 2738]
 [2693 1545 3773]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0825565
{'0': {'precision': 0.40126093146227376, 'recall': 0.48770238536645655, 'f1-score': 0.440278940027894, 'support': 8091}, '1': {'precision': 0.3535681186283596, 'recall': 0.20368392952482647, 'f1-score': 0.25846883468834686, 'support': 7492}, '2': {'precision': 0.3983499048022001, 'recall': 0.46951751651913726, 'f1-score': 0.4310157367668097, 'support': 8021}, 'accuracy': 0.39137434333163873, 'macro avg': {'precision': 0.3843929849642778, 'recall': 0.38696794380347344, 'f1-score': 0.3765878371610169, 'support': 23604}, 'weighted avg': {'precision': 0.38513383865630285, 'recall': 0.39137434333163873, 'f1-score': 0.37942393822476556, 'support': 23604}}
[[3946 1347 2798]
 [3076 1526 2890]
 [2812 1443 3766]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0868931
{'0': {'precision': 0.3983731772641603, 'recall': 0.4938514510575504, 'f1-score': 0.44100367869104484, 'support': 8132}, '1': {'precision': 0.3245546088303641, 'recall': 0.17176824268925936, 'f1-score': 0.22464480386024485, 'support': 7318}, '2': {'precision': 0.3910880829015544, 'recall': 0.4628403237674761, 'f1-score': 0.42394967423051, 'support': 8154}, 'accuracy': 0.3832824944924589, 'macro avg': {'precision': 0.37133862299869297, 'recall': 0.3761533391714286, 'f1-score': 0.3631993855939332, 'support': 23604}, 'weighted avg': {'precision': 0.37297040895238226, 'recall': 0.3832824944924589, 'f1-score': 0.36803415664465466, 'support': 23604}}
[[4016 1254 2862]
 [3047 1257 3014]
 [3018 1362 3774]]
training model: results/CHTR/W1/deepVOL_L3/seq2seq
Epoch 1/50
384/384 - 20s - loss: 13.2608 - accuracy10: 0.3487 - accuracy20: 0.3542 - accuracy30: 0.3564 - accuracy50: 0.3543 - val_loss: 13.2574 - val_accuracy10: 0.3409 - val_accuracy20: 0.3455 - val_accuracy30: 0.3499 - val_accuracy50: 0.3475 - 20s/epoch - 52ms/step
Epoch 2/50
384/384 - 15s - loss: 13.1665 - accuracy10: 0.3596 - accuracy20: 0.3635 - accuracy30: 0.3643 - accuracy50: 0.3605 - val_loss: 13.1942 - val_accuracy10: 0.3608 - val_accuracy20: 0.3545 - val_accuracy30: 0.3452 - val_accuracy50: 0.3377 - 15s/epoch - 40ms/step
Epoch 3/50
384/384 - 15s - loss: 13.1218 - accuracy10: 0.3717 - accuracy20: 0.3726 - accuracy30: 0.3740 - accuracy50: 0.3665 - val_loss: 13.0949 - val_accuracy10: 0.3804 - val_accuracy20: 0.3785 - val_accuracy30: 0.3797 - val_accuracy50: 0.3775 - 15s/epoch - 40ms/step
Epoch 4/50
384/384 - 15s - loss: 13.0865 - accuracy10: 0.3791 - accuracy20: 0.3791 - accuracy30: 0.3787 - accuracy50: 0.3721 - val_loss: 13.0749 - val_accuracy10: 0.3888 - val_accuracy20: 0.3898 - val_accuracy30: 0.3847 - val_accuracy50: 0.3806 - 15s/epoch - 40ms/step
Epoch 5/50
384/384 - 15s - loss: 13.0524 - accuracy10: 0.3876 - accuracy20: 0.3888 - accuracy30: 0.3877 - accuracy50: 0.3790 - val_loss: 13.0422 - val_accuracy10: 0.3926 - val_accuracy20: 0.3894 - val_accuracy30: 0.3867 - val_accuracy50: 0.3829 - 15s/epoch - 40ms/step
Epoch 6/50
384/384 - 15s - loss: 13.0243 - accuracy10: 0.3950 - accuracy20: 0.3955 - accuracy30: 0.3936 - accuracy50: 0.3837 - val_loss: 13.0328 - val_accuracy10: 0.3971 - val_accuracy20: 0.3939 - val_accuracy30: 0.3893 - val_accuracy50: 0.3829 - 15s/epoch - 39ms/step
Epoch 7/50
384/384 - 16s - loss: 12.9970 - accuracy10: 0.4025 - accuracy20: 0.4010 - accuracy30: 0.3997 - accuracy50: 0.3895 - val_loss: 13.0096 - val_accuracy10: 0.3957 - val_accuracy20: 0.3925 - val_accuracy30: 0.3889 - val_accuracy50: 0.3796 - 16s/epoch - 40ms/step
Epoch 8/50
384/384 - 15s - loss: 12.9727 - accuracy10: 0.4086 - accuracy20: 0.4079 - accuracy30: 0.4053 - accuracy50: 0.3962 - val_loss: 12.9962 - val_accuracy10: 0.3966 - val_accuracy20: 0.3887 - val_accuracy30: 0.3833 - val_accuracy50: 0.3730 - 15s/epoch - 40ms/step
Epoch 9/50
384/384 - 15s - loss: 12.9576 - accuracy10: 0.4122 - accuracy20: 0.4121 - accuracy30: 0.4079 - accuracy50: 0.3947 - val_loss: 12.9911 - val_accuracy10: 0.3981 - val_accuracy20: 0.3902 - val_accuracy30: 0.3858 - val_accuracy50: 0.3730 - 15s/epoch - 40ms/step
Epoch 10/50
384/384 - 15s - loss: 12.9301 - accuracy10: 0.4159 - accuracy20: 0.4137 - accuracy30: 0.4085 - accuracy50: 0.3963 - val_loss: 12.9755 - val_accuracy10: 0.4007 - val_accuracy20: 0.3971 - val_accuracy30: 0.3922 - val_accuracy50: 0.3811 - 15s/epoch - 40ms/step
Epoch 11/50
384/384 - 15s - loss: 12.9212 - accuracy10: 0.4181 - accuracy20: 0.4162 - accuracy30: 0.4099 - accuracy50: 0.3981 - val_loss: 12.9798 - val_accuracy10: 0.4002 - val_accuracy20: 0.3927 - val_accuracy30: 0.3881 - val_accuracy50: 0.3732 - 15s/epoch - 40ms/step
Epoch 12/50
384/384 - 15s - loss: 12.8986 - accuracy10: 0.4205 - accuracy20: 0.4167 - accuracy30: 0.4122 - accuracy50: 0.4006 - val_loss: 12.9836 - val_accuracy10: 0.4059 - val_accuracy20: 0.3965 - val_accuracy30: 0.3913 - val_accuracy50: 0.3768 - 15s/epoch - 40ms/step
Epoch 13/50
384/384 - 16s - loss: 12.8849 - accuracy10: 0.4218 - accuracy20: 0.4205 - accuracy30: 0.4150 - accuracy50: 0.4024 - val_loss: 12.9502 - val_accuracy10: 0.4125 - val_accuracy20: 0.4035 - val_accuracy30: 0.3987 - val_accuracy50: 0.3836 - 16s/epoch - 41ms/step
Epoch 14/50
384/384 - 15s - loss: 12.8697 - accuracy10: 0.4239 - accuracy20: 0.4227 - accuracy30: 0.4197 - accuracy50: 0.4059 - val_loss: 12.9667 - val_accuracy10: 0.4093 - val_accuracy20: 0.3968 - val_accuracy30: 0.3909 - val_accuracy50: 0.3760 - 15s/epoch - 40ms/step
Epoch 15/50
384/384 - 15s - loss: 12.8583 - accuracy10: 0.4249 - accuracy20: 0.4246 - accuracy30: 0.4193 - accuracy50: 0.4061 - val_loss: 12.9737 - val_accuracy10: 0.4092 - val_accuracy20: 0.3973 - val_accuracy30: 0.3898 - val_accuracy50: 0.3765 - 15s/epoch - 40ms/step
Epoch 16/50
384/384 - 15s - loss: 12.8414 - accuracy10: 0.4270 - accuracy20: 0.4263 - accuracy30: 0.4213 - accuracy50: 0.4091 - val_loss: 12.9658 - val_accuracy10: 0.4090 - val_accuracy20: 0.3990 - val_accuracy30: 0.3938 - val_accuracy50: 0.3802 - 15s/epoch - 40ms/step
Epoch 17/50
384/384 - 15s - loss: 12.8258 - accuracy10: 0.4275 - accuracy20: 0.4269 - accuracy30: 0.4218 - accuracy50: 0.4093 - val_loss: 12.9853 - val_accuracy10: 0.4084 - val_accuracy20: 0.3995 - val_accuracy30: 0.3931 - val_accuracy50: 0.3790 - 15s/epoch - 39ms/step
Epoch 18/50
384/384 - 15s - loss: 12.8078 - accuracy10: 0.4292 - accuracy20: 0.4288 - accuracy30: 0.4261 - accuracy50: 0.4116 - val_loss: 12.9877 - val_accuracy10: 0.4091 - val_accuracy20: 0.3979 - val_accuracy30: 0.3901 - val_accuracy50: 0.3771 - 15s/epoch - 40ms/step
Epoch 19/50
384/384 - 15s - loss: 12.7994 - accuracy10: 0.4290 - accuracy20: 0.4285 - accuracy30: 0.4248 - accuracy50: 0.4131 - val_loss: 12.9850 - val_accuracy10: 0.4115 - val_accuracy20: 0.3986 - val_accuracy30: 0.3897 - val_accuracy50: 0.3749 - 15s/epoch - 39ms/step
Epoch 20/50
384/384 - 16s - loss: 12.7772 - accuracy10: 0.4320 - accuracy20: 0.4314 - accuracy30: 0.4271 - accuracy50: 0.4130 - val_loss: 12.9999 - val_accuracy10: 0.4069 - val_accuracy20: 0.3974 - val_accuracy30: 0.3922 - val_accuracy50: 0.3815 - 16s/epoch - 40ms/step
Epoch 21/50
384/384 - 15s - loss: 12.7609 - accuracy10: 0.4345 - accuracy20: 0.4361 - accuracy30: 0.4326 - accuracy50: 0.4172 - val_loss: 12.9661 - val_accuracy10: 0.4123 - val_accuracy20: 0.4033 - val_accuracy30: 0.3954 - val_accuracy50: 0.3854 - 15s/epoch - 40ms/step
Epoch 22/50
384/384 - 15s - loss: 12.7482 - accuracy10: 0.4335 - accuracy20: 0.4352 - accuracy30: 0.4309 - accuracy50: 0.4180 - val_loss: 13.0013 - val_accuracy10: 0.4062 - val_accuracy20: 0.3954 - val_accuracy30: 0.3917 - val_accuracy50: 0.3787 - 15s/epoch - 40ms/step
Epoch 23/50
384/384 - 16s - loss: 12.7374 - accuracy10: 0.4357 - accuracy20: 0.4371 - accuracy30: 0.4329 - accuracy50: 0.4195 - val_loss: 12.9942 - val_accuracy10: 0.4096 - val_accuracy20: 0.3994 - val_accuracy30: 0.3920 - val_accuracy50: 0.3839 - 16s/epoch - 41ms/step
testing model: results/CHTR/W1/deepVOL_L3/seq2seq
Evaluating performance on  test set...
1304/1304 - 23s - 23s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0746464
{'0': {'precision': 0.41525845120523863, 'recall': 0.46387004153065237, 'f1-score': 0.43822025243901946, 'support': 117022}, '1': {'precision': 0.39199073570021675, 'recall': 0.38173265990669697, 'f1-score': 0.3867936966808444, 'support': 103748}, '2': {'precision': 0.41254277505956644, 'recall': 0.37243186304449816, 'f1-score': 0.39146251825938094, 'support': 112971}, 'accuracy': 0.4073847684282123, 'macro avg': {'precision': 0.4065973206550073, 'recall': 0.4060115214939491, 'f1-score': 0.40549215579308157, 'support': 333741}, 'weighted avg': {'precision': 0.4071061067283307, 'recall': 0.4073847684282123, 'f1-score': 0.40640615020163456, 'support': 333741}}
[[54283 31503 31236]
 [35467 39604 28677]
 [40971 29926 42074]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0790598
{'0': {'precision': 0.4115508498899767, 'recall': 0.4455031112722126, 'f1-score': 0.4278544698027742, 'support': 115869}, '1': {'precision': 0.38886161515077133, 'recall': 0.38545185712013025, 'f1-score': 0.3871492285495416, 'support': 106859}, '2': {'precision': 0.40211542030061237, 'recall': 0.3708844910055579, 'f1-score': 0.3858690558752413, 'support': 111013}, 'accuracy': 0.4014550205099164, 'macro avg': {'precision': 0.4008426284471201, 'recall': 0.40061315313263357, 'f1-score': 0.4002909180758523, 'support': 333741}, 'weighted avg': {'precision': 0.40114756027317555, 'recall': 0.4014550205099164, 'f1-score': 0.4008555450934445, 'support': 333741}}
[[51620 33130 31119]
 [35571 41189 30099]
 [38237 31603 41173]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0832679
{'0': {'precision': 0.4067390675971425, 'recall': 0.42514437644052727, 'f1-score': 0.41573811453268505, 'support': 115843}, '1': {'precision': 0.37639867576615066, 'recall': 0.3812641675565297, 'f1-score': 0.3788157992703447, 'support': 106758}, '2': {'precision': 0.39465929313611053, 'recall': 0.37114450242936836, 'f1-score': 0.38254087490378286, 'support': 111140}, 'accuracy': 0.39312520787077404, 'macro avg': {'precision': 0.3925990121664679, 'recall': 0.39251768214214183, 'f1-score': 0.39236492956893754, 'support': 333741}, 'weighted avg': {'precision': 0.39301097999420453, 'recall': 0.39312520787077404, 'f1-score': 0.3928721983128226, 'support': 333741}}
[[49250 34262 32331]
 [35117 40703 30938]
 [36718 33173 41249]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0894588
{'0': {'precision': 0.39409226797119173, 'recall': 0.40365360358401114, 'f1-score': 0.39881563736844594, 'support': 114955}, '1': {'precision': 0.3626436468601928, 'recall': 0.37456754704244366, 'f1-score': 0.3685091663784158, 'support': 106659}, '2': {'precision': 0.387183339475201, 'recall': 0.36544275687390193, 'f1-score': 0.37599904568770126, 'support': 112127}, 'accuracy': 0.3815204005501272, 'macro avg': {'precision': 0.3813064181021952, 'recall': 0.38122130250011893, 'f1-score': 0.381107949811521, 'support': 333741}, 'weighted avg': {'precision': 0.3817205308919956, 'recall': 0.3815204005501272, 'f1-score': 0.38146441631765365, 'support': 333741}}
[[46402 35226 33327]
 [35180 39951 31528]
 [36162 34989 40976]]
Evaluating performance on  train set...
384/384 - 7s - 7s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0704392
{'0': {'precision': 0.4101657851912124, 'recall': 0.475910901312878, 'f1-score': 0.44059926525818394, 'support': 33895}, '1': {'precision': 0.4123873873873874, 'recall': 0.39742635658914727, 'f1-score': 0.40476867203537026, 'support': 32250}, '2': {'precision': 0.4220489977728285, 'recall': 0.3660010591570356, 'f1-score': 0.39203189909741576, 'support': 32101}, 'accuracy': 0.41423569407405897, 'macro avg': {'precision': 0.41486739011714274, 'recall': 0.4131127723530203, 'f1-score': 0.4124666121303233, 'support': 98246}, 'weighted avg': {'precision': 0.41477777629425067, 'recall': 0.41423569407405897, 'f1-score': 0.4129686477005982, 'support': 98246}}
[[16131  9335  8429]
 [11773 12817  7660]
 [11424  8928 11749]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0724097
{'0': {'precision': 0.41023754467101115, 'recall': 0.46275602454278686, 'f1-score': 0.43491705319460117, 'support': 33737}, '1': {'precision': 0.40872474903953404, 'recall': 0.40379553106825833, 'f1-score': 0.4062451883102885, 'support': 32670}, '2': {'precision': 0.42215375797091065, 'recall': 0.3701121266371431, 'f1-score': 0.3944237109433836, 'support': 31839}, 'accuracy': 0.4131262341469373, 'macro avg': {'precision': 0.4137053505604853, 'recall': 0.41222122741606276, 'f1-score': 0.4118619841494244, 'support': 98246}, 'weighted avg': {'precision': 0.4135962288105704, 'recall': 0.4131262341469373, 'f1-score': 0.41225987275257797, 'support': 98246}}
[[15612  9869  8256]
 [11604 13192  7874]
 [10840  9215 11784]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0759836
{'0': {'precision': 0.40632066329277483, 'recall': 0.44773374466065496, 'f1-score': 0.4260231442280553, 'support': 33712}, '1': {'precision': 0.3963509672687265, 'recall': 0.3985556238475722, 'f1-score': 0.39745023827400744, 'support': 32540}, '2': {'precision': 0.4192479825210558, 'recall': 0.37185097205726075, 'f1-score': 0.39412963177684657, 'support': 31994}, 'accuracy': 0.40673411640168555, 'macro avg': {'precision': 0.40730653769418573, 'recall': 0.40604678018849594, 'f1-score': 0.40586767142630314, 'support': 98246}, 'weighted avg': {'precision': 0.40722841264406745, 'recall': 0.40673411640168555, 'f1-score': 0.40617334477455397, 'support': 98246}}
[[15094 10289  8329]
 [11420 12969  8151]
 [10634  9463 11897]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0830228
{'0': {'precision': 0.3959453527927137, 'recall': 0.4280502995432707, 'f1-score': 0.41137238135955534, 'support': 33718}, '1': {'precision': 0.3750718673404545, 'recall': 0.3879377797252042, 'f1-score': 0.38139635065694333, 'support': 31951}, '2': {'precision': 0.4100601801927158, 'recall': 0.361850385241121, 'f1-score': 0.38444980757941427, 'support': 32577}, 'accuracy': 0.3930541701443316, 'macro avg': {'precision': 0.3936924667752946, 'recall': 0.3926128215031986, 'f1-score': 0.3924061798653043, 'support': 98246}, 'weighted avg': {'precision': 0.393837277130852, 'recall': 0.3930541701443316, 'f1-score': 0.3926965997194396, 'support': 98246}}
[[14433 10669  8616]
 [11213 12395  8343]
 [10806  9983 11788]]
Evaluating performance on  val set...
93/93 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0710236
{'0': {'precision': 0.4098202203750242, 'recall': 0.5197989456908177, 'f1-score': 0.4583040588012755, 'support': 8157}, '1': {'precision': 0.39336345225112945, 'recall': 0.34367769157479244, 'f1-score': 0.3668458520993753, 'support': 7347}, '2': {'precision': 0.43749086123702297, 'recall': 0.3693827160493827, 'f1-score': 0.40056228663230464, 'support': 8100}, 'accuracy': 0.41336214200982885, 'macro avg': {'precision': 0.4135581779543922, 'recall': 0.4109531177716643, 'f1-score': 0.40857073251098514, 'support': 23604}, 'weighted avg': {'precision': 0.41419339083663814, 'recall': 0.41336214200982885, 'f1-score': 0.4100219117411363, 'support': 23604}}
[[4240 1918 1999]
 [2974 2525 1848]
 [3132 1976 2992]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0747093
{'0': {'precision': 0.4093050647820966, 'recall': 0.5131044665928387, 'f1-score': 0.45536445536445536, 'support': 8127}, '1': {'precision': 0.3828016643550624, 'recall': 0.332708277524779, 'f1-score': 0.35600143317807237, 'support': 7466}, '2': {'precision': 0.42283816948173814, 'recall': 0.36562226937960307, 'f1-score': 0.3921542375150623, 'support': 8011}, 'accuracy': 0.40599051008303677, 'macro avg': {'precision': 0.4049816328729657, 'recall': 0.4038116711657403, 'f1-score': 0.40117337535252995, 'support': 23604}, 'weighted avg': {'precision': 0.40551500013884084, 'recall': 0.40599051008303677, 'f1-score': 0.40248268198557796, 'support': 23604}}
[[4170 1955 2002]
 [2986 2484 1996]
 [3032 2050 2929]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0790886
{'0': {'precision': 0.40459224069675376, 'recall': 0.5052527499691015, 'f1-score': 0.449354218191811, 'support': 8091}, '1': {'precision': 0.3659753625448308, 'recall': 0.3132674853176722, 'f1-score': 0.33757641136281913, 'support': 7492}, '2': {'precision': 0.41823056300268097, 'recall': 0.3695299837925446, 'f1-score': 0.3923749007148531, 'support': 8021}, 'accuracy': 0.3981952211489578, 'macro avg': {'precision': 0.3962660554147552, 'recall': 0.3960167396931061, 'f1-score': 0.39310184342316107, 'support': 23604}, 'weighted avg': {'precision': 0.3969696060628627, 'recall': 0.3981952211489578, 'f1-score': 0.3945130711724293, 'support': 23604}}
[[4088 1994 2009]
 [3031 2347 2114]
 [2985 2072 2964]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0869763
{'0': {'precision': 0.39928415191887057, 'recall': 0.4938514510575504, 'f1-score': 0.4415612974161627, 'support': 8132}, '1': {'precision': 0.33338592615967183, 'recall': 0.2887400929215633, 'f1-score': 0.30946104276508496, 'support': 7318}, '2': {'precision': 0.4009433962264151, 'recall': 0.35442727495707627, 'f1-score': 0.37625309204530666, 'support': 8154}, 'accuracy': 0.38209625487205556, 'macro avg': {'precision': 0.3778711581016525, 'recall': 0.37900627297872996, 'f1-score': 0.37575847740885143, 'support': 23604}, 'weighted avg': {'precision': 0.37942676596640074, 'recall': 0.38209625487205556, 'f1-score': 0.378045250554167, 'support': 23604}}
[[4016 2014 2102]
 [2989 2113 2216]
 [3053 2211 2890]]
training model: results/CHTR/W2/deepLOB_L1/seq2seq
Epoch 1/50
320/320 - 13s - loss: 13.2077 - accuracy10: 0.3721 - accuracy20: 0.3687 - accuracy30: 0.3669 - accuracy50: 0.3628 - val_loss: 13.3442 - val_accuracy10: 0.3534 - val_accuracy20: 0.3473 - val_accuracy30: 0.3389 - val_accuracy50: 0.3360 - 13s/epoch - 40ms/step
Epoch 2/50
320/320 - 7s - loss: 13.1070 - accuracy10: 0.3823 - accuracy20: 0.3793 - accuracy30: 0.3771 - accuracy50: 0.3699 - val_loss: 13.2422 - val_accuracy10: 0.3554 - val_accuracy20: 0.3558 - val_accuracy30: 0.3620 - val_accuracy50: 0.3517 - 7s/epoch - 23ms/step
Epoch 3/50
320/320 - 7s - loss: 13.0536 - accuracy10: 0.3895 - accuracy20: 0.3865 - accuracy30: 0.3830 - accuracy50: 0.3738 - val_loss: 13.1919 - val_accuracy10: 0.3634 - val_accuracy20: 0.3691 - val_accuracy30: 0.3642 - val_accuracy50: 0.3541 - 7s/epoch - 23ms/step
Epoch 4/50
320/320 - 7s - loss: 13.0128 - accuracy10: 0.4001 - accuracy20: 0.3962 - accuracy30: 0.3921 - accuracy50: 0.3813 - val_loss: 13.0769 - val_accuracy10: 0.3835 - val_accuracy20: 0.3860 - val_accuracy30: 0.3786 - val_accuracy50: 0.3703 - 7s/epoch - 23ms/step
Epoch 5/50
320/320 - 7s - loss: 12.9805 - accuracy10: 0.4089 - accuracy20: 0.4033 - accuracy30: 0.3977 - accuracy50: 0.3869 - val_loss: 13.1070 - val_accuracy10: 0.3758 - val_accuracy20: 0.3753 - val_accuracy30: 0.3704 - val_accuracy50: 0.3650 - 7s/epoch - 22ms/step
Epoch 6/50
320/320 - 7s - loss: 12.9632 - accuracy10: 0.4139 - accuracy20: 0.4087 - accuracy30: 0.4032 - accuracy50: 0.3924 - val_loss: 13.1255 - val_accuracy10: 0.3774 - val_accuracy20: 0.3750 - val_accuracy30: 0.3713 - val_accuracy50: 0.3636 - 7s/epoch - 23ms/step
Epoch 7/50
320/320 - 7s - loss: 12.9468 - accuracy10: 0.4144 - accuracy20: 0.4094 - accuracy30: 0.4049 - accuracy50: 0.3911 - val_loss: 13.0976 - val_accuracy10: 0.3821 - val_accuracy20: 0.3816 - val_accuracy30: 0.3783 - val_accuracy50: 0.3675 - 7s/epoch - 23ms/step
Epoch 8/50
320/320 - 7s - loss: 12.9253 - accuracy10: 0.4189 - accuracy20: 0.4150 - accuracy30: 0.4087 - accuracy50: 0.3959 - val_loss: 13.1130 - val_accuracy10: 0.3822 - val_accuracy20: 0.3810 - val_accuracy30: 0.3762 - val_accuracy50: 0.3652 - 7s/epoch - 22ms/step
Epoch 9/50
320/320 - 7s - loss: 12.9136 - accuracy10: 0.4218 - accuracy20: 0.4153 - accuracy30: 0.4091 - accuracy50: 0.3960 - val_loss: 13.0901 - val_accuracy10: 0.3854 - val_accuracy20: 0.3842 - val_accuracy30: 0.3792 - val_accuracy50: 0.3703 - 7s/epoch - 23ms/step
Epoch 10/50
320/320 - 7s - loss: 12.8986 - accuracy10: 0.4221 - accuracy20: 0.4179 - accuracy30: 0.4108 - accuracy50: 0.3977 - val_loss: 13.1124 - val_accuracy10: 0.3800 - val_accuracy20: 0.3759 - val_accuracy30: 0.3751 - val_accuracy50: 0.3639 - 7s/epoch - 23ms/step
Epoch 11/50
320/320 - 7s - loss: 12.8821 - accuracy10: 0.4251 - accuracy20: 0.4214 - accuracy30: 0.4147 - accuracy50: 0.3997 - val_loss: 13.0875 - val_accuracy10: 0.3839 - val_accuracy20: 0.3823 - val_accuracy30: 0.3782 - val_accuracy50: 0.3691 - 7s/epoch - 23ms/step
Epoch 12/50
320/320 - 8s - loss: 12.8690 - accuracy10: 0.4278 - accuracy20: 0.4230 - accuracy30: 0.4159 - accuracy50: 0.4022 - val_loss: 13.0937 - val_accuracy10: 0.3954 - val_accuracy20: 0.3890 - val_accuracy30: 0.3792 - val_accuracy50: 0.3681 - 8s/epoch - 24ms/step
Epoch 13/50
320/320 - 7s - loss: 12.8576 - accuracy10: 0.4287 - accuracy20: 0.4239 - accuracy30: 0.4170 - accuracy50: 0.4022 - val_loss: 13.1070 - val_accuracy10: 0.3858 - val_accuracy20: 0.3828 - val_accuracy30: 0.3754 - val_accuracy50: 0.3656 - 7s/epoch - 23ms/step
Epoch 14/50
320/320 - 8s - loss: 12.8439 - accuracy10: 0.4309 - accuracy20: 0.4261 - accuracy30: 0.4172 - accuracy50: 0.4038 - val_loss: 13.1249 - val_accuracy10: 0.3907 - val_accuracy20: 0.3840 - val_accuracy30: 0.3749 - val_accuracy50: 0.3655 - 8s/epoch - 23ms/step
testing model: results/CHTR/W2/deepLOB_L1/seq2seq
Evaluating performance on  test set...
860/860 - 7s - 7s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0846469
{'0': {'precision': 0.41693606321839083, 'recall': 0.416279218699968, 'f1-score': 0.41660738205566983, 'support': 78075}, '1': {'precision': 0.3435353447526302, 'recall': 0.4230580964909597, 'f1-score': 0.3791720649022148, 'support': 65374}, '2': {'precision': 0.4316174676750427, 'recall': 0.34692463559709785, 'f1-score': 0.3846644441223366, 'support': 76495}, 'accuracy': 0.3941730622340232, 'macro avg': {'precision': 0.3973629585486879, 'recall': 0.3954206502626752, 'f1-score': 0.39348129702674034, 'support': 219944}, 'weighted avg': {'precision': 0.4002252434866907, 'recall': 0.3941730622340232, 'f1-score': 0.3943709425037826, 'support': 219944}}
[[32501 26555 19019]
 [21789 27657 15928]
 [23662 26295 26538]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.087111
{'0': {'precision': 0.39457973381799777, 'recall': 0.4552416090459064, 'f1-score': 0.42274559100824494, 'support': 75349}, '1': {'precision': 0.3517831473749059, 'recall': 0.38263718263718266, 'f1-score': 0.36656205420827387, 'support': 67155}, '2': {'precision': 0.43186138811993463, 'recall': 0.3344137396694215, 'f1-score': 0.37694132716184153, 'support': 77440}, 'accuracy': 0.39053122613028773, 'macro avg': {'precision': 0.39274142310427945, 'recall': 0.3907641771175035, 'f1-score': 0.3887496574594535, 'support': 219944}, 'weighted avg': {'precision': 0.3946392332658398, 'recall': 0.39053122613028773, 'f1-score': 0.3894639938468423, 'support': 219944}}
[[34302 23101 17946]
 [25336 25696 16123]
 [27295 24248 25897]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0895591
{'0': {'precision': 0.3841762867529817, 'recall': 0.4840420545101453, 'f1-score': 0.42836570087531634, 'support': 74665}, '1': {'precision': 0.3452308784173406, 'recall': 0.34703189560357894, 'f1-score': 0.34612904421302304, 'support': 67282}, '2': {'precision': 0.4297783196249807, 'recall': 0.32089695757529135, 'f1-score': 0.36744131420937504, 'support': 77997}, 'accuracy': 0.3842750882042702, 'macro avg': {'precision': 0.3863951615984343, 'recall': 0.3839903025630052, 'f1-score': 0.38064535309923814, 'support': 219944}, 'weighted avg': {'precision': 0.3884341741892323, 'recall': 0.3842750882042702, 'f1-score': 0.3816039518831372, 'support': 219944}}
[[36141 21167 17357]
 [28082 23349 15851]
 [29851 23117 25029]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0930815
{'0': {'precision': 0.3731117977812674, 'recall': 0.4996404780962976, 'f1-score': 0.42720428735485516, 'support': 73709}, '1': {'precision': 0.3361773408269017, 'recall': 0.3164036599920435, 'f1-score': 0.32599092192552337, 'support': 67869}, '2': {'precision': 0.42163801820020225, 'recall': 0.3086287420565041, 'f1-score': 0.35638924908640807, 'support': 78366}, 'accuracy': 0.37504091950678353, 'macro avg': {'precision': 0.3769757189361238, 'recall': 0.3748909600482817, 'f1-score': 0.3698614861222622, 'support': 219944}, 'weighted avg': {'precision': 0.3790046665583852, 'recall': 0.37504091950678353, 'f1-score': 0.3707410913264641, 'support': 219944}}
[[36828 19984 16897]
 [30116 21474 16279]
 [31761 22419 24186]]
Evaluating performance on  train set...
320/320 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0845416
{'0': {'precision': 0.41548452468680913, 'recall': 0.3235072619688004, 'f1-score': 0.36377200233885115, 'support': 27885}, '1': {'precision': 0.36646741740940386, 'recall': 0.5057636356940302, 'f1-score': 0.42499265013075027, 'support': 27153}, '2': {'precision': 0.402649359886202, 'recall': 0.3399639693739679, 'f1-score': 0.36866096866096865, 'support': 26644}, 'accuracy': 0.38946157048064445, 'macro avg': {'precision': 0.39486710066080494, 'recall': 0.3897449556789328, 'f1-score': 0.3858085403768567, 'support': 81682}, 'weighted avg': {'precision': 0.39500337039515665, 'recall': 0.38946157048064445, 'f1-score': 0.3857179129211084, 'support': 81682}}
[[ 9021 12368  6496]
 [ 6478 13733  6942]
 [ 6213 11373  9058]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0862198
{'0': {'precision': 0.41362048894062864, 'recall': 0.37842155714133563, 'f1-score': 0.39523888981589633, 'support': 28167}, '1': {'precision': 0.36365289055872013, 'recall': 0.4423558897243108, 'f1-score': 0.3991618996940269, 'support': 27132}, '2': {'precision': 0.39466561899773006, 'recall': 0.3426827881590418, 'f1-score': 0.3668418169645575, 'support': 26383}, 'accuracy': 0.38811488455228815, 'macro avg': {'precision': 0.39064633283235956, 'recall': 0.3878200783415627, 'f1-score': 0.3870808688248269, 'support': 81682}, 'weighted avg': {'precision': 0.39090058476343614, 'recall': 0.38811488455228815, 'f1-score': 0.3873698260194242, 'support': 81682}}
[[10659 10944  6564]
 [ 7827 12002  7303]
 [ 7284 10058  9041]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0877111
{'0': {'precision': 0.4012103590506457, 'recall': 0.42201280227596016, 'f1-score': 0.4113487469236369, 'support': 28120}, '1': {'precision': 0.35775713794289643, 'recall': 0.38214220099209995, 'f1-score': 0.3695478369014835, 'support': 27215}, '2': {'precision': 0.38707996874185985, 'recall': 0.33840664971343987, 'f1-score': 0.3611105485915635, 'support': 26347}, 'accuracy': 0.3817609754903161, 'macro avg': {'precision': 0.38201582191180067, 'recall': 0.38085388432716666, 'f1-score': 0.38066904413889463, 'support': 81682}, 'weighted avg': {'precision': 0.38217467424967394, 'recall': 0.3817609754903161, 'f1-score': 0.38121680135780794, 'support': 81682}}
[[11867  9604  6649]
 [ 9346 10400  7469]
 [ 8365  9066  8916]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0918642
{'0': {'precision': 0.39317064060262713, 'recall': 0.44574231570032113, 'f1-score': 0.41780923870797015, 'support': 28337}, '1': {'precision': 0.34081044747455347, 'recall': 0.3335087389588423, 'f1-score': 0.33712006079027357, 'support': 26605}, '2': {'precision': 0.3801709111007185, 'recall': 0.3344053851907255, 'f1-score': 0.35582260599669724, 'support': 26740}, 'accuracy': 0.37273817977032886, 'macro avg': {'precision': 0.3713839997259664, 'recall': 0.3712188132832963, 'f1-score': 0.3702506351649803, 'support': 81682}, 'weighted avg': {'precision': 0.3718604902016399, 'recall': 0.37273817977032886, 'f1-score': 0.3712352305152256, 'support': 81682}}
[[12631  8720  6986]
 [10139  8873  7593]
 [ 9356  8442  8942]]
Evaluating performance on  val set...
98/98 - 1s - 838ms/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0866026
{'0': {'precision': 0.4297731328065256, 'recall': 0.37785746302106676, 'f1-score': 0.40214669051878354, 'support': 8924}, '1': {'precision': 0.3471557682083998, 'recall': 0.4776301353163477, 'f1-score': 0.40207296423623584, 'support': 8203}, '2': {'precision': 0.3913192657402642, 'recall': 0.29116670921623694, 'f1-score': 0.33389445948913127, 'support': 7834}, 'accuracy': 0.3834381635351148, 'macro avg': {'precision': 0.3894160555850632, 'recall': 0.38221810251788374, 'f1-score': 0.3793713714147169, 'support': 24961}, 'weighted avg': {'precision': 0.3905536369371486, 'recall': 0.3834381635351148, 'f1-score': 0.38070152587866357, 'support': 24961}}
[[3372 3883 1669]
 [2406 3918 1879]
 [2068 3485 2281]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0880852
{'0': {'precision': 0.41472826669525137, 'recall': 0.4358945470932853, 'f1-score': 0.4250480637187586, 'support': 8876}, '1': {'precision': 0.3432353238355057, 'recall': 0.4224073613528973, 'f1-score': 0.3787279112548079, 'support': 8042}, '2': {'precision': 0.3951176983435048, 'recall': 0.2817356707696133, 'f1-score': 0.3289301785455073, 'support': 8043}, 'accuracy': 0.3818757261327671, 'macro avg': {'precision': 0.384360429624754, 'recall': 0.38001252640526534, 'f1-score': 0.3775687178396912, 'support': 24961}, 'weighted avg': {'precision': 0.3853755144925683, 'recall': 0.3818757261327671, 'f1-score': 0.3791531549986132, 'support': 24961}}
[[3869 3332 1675]
 [2851 3397 1794]
 [2609 3168 2266]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0903908
{'0': {'precision': 0.40032123960695387, 'recall': 0.4866758557316793, 'f1-score': 0.4392949714878175, 'support': 8706}, '1': {'precision': 0.3521207929921623, 'recall': 0.3697204405179717, 'f1-score': 0.3607060629316961, 'support': 8263}, '2': {'precision': 0.37870549026486583, 'recall': 0.27014514514514515, 'f1-score': 0.3153436062221573, 'support': 7992}, 'accuracy': 0.3786306638355835, 'macro avg': {'precision': 0.377049174287994, 'recall': 0.3755138137982654, 'f1-score': 0.371781546880557, 'support': 24961}, 'weighted avg': {'precision': 0.3774442170870232, 'recall': 0.3786306638355835, 'f1-score': 0.373592497123714, 'support': 24961}}
[[4237 2808 1661]
 [3327 3055 1881]
 [3020 2813 2159]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0950575
{'0': {'precision': 0.38091098748261476, 'recall': 0.5085296506904955, 'f1-score': 0.43556483276179114, 'support': 8617}, '1': {'precision': 0.3456710236831888, 'recall': 0.3234439331557278, 'f1-score': 0.3341883015326869, 'support': 8258}, '2': {'precision': 0.37207678883071554, 'recall': 0.26366559485530544, 'f1-score': 0.30862767805442964, 'support': 8086}, 'accuracy': 0.36797403950162255, 'macro avg': {'precision': 0.36621959999883974, 'recall': 0.36521305956717626, 'f1-score': 0.35946027078296927, 'support': 24961}, 'weighted avg': {'precision': 0.3663905375264865, 'recall': 0.36797403950162255, 'f1-score': 0.36090511448713597, 'support': 24961}}
[[4382 2504 1731]
 [3720 2671 1867]
 [3402 2552 2132]]
training model: results/CHTR/W2/deepOF_L1/seq2seq
Epoch 1/50
320/320 - 12s - loss: 13.1797 - accuracy10: 0.3758 - accuracy20: 0.3763 - accuracy30: 0.3731 - accuracy50: 0.3673 - val_loss: 13.0401 - val_accuracy10: 0.4103 - val_accuracy20: 0.3973 - val_accuracy30: 0.3952 - val_accuracy50: 0.3864 - 12s/epoch - 39ms/step
Epoch 2/50
320/320 - 7s - loss: 13.0337 - accuracy10: 0.4024 - accuracy20: 0.3989 - accuracy30: 0.3913 - accuracy50: 0.3845 - val_loss: 12.9742 - val_accuracy10: 0.4164 - val_accuracy20: 0.4085 - val_accuracy30: 0.4039 - val_accuracy50: 0.3984 - 7s/epoch - 22ms/step
Epoch 3/50
320/320 - 7s - loss: 12.9769 - accuracy10: 0.4104 - accuracy20: 0.4087 - accuracy30: 0.4050 - accuracy50: 0.3949 - val_loss: 12.9493 - val_accuracy10: 0.4202 - val_accuracy20: 0.4150 - val_accuracy30: 0.4087 - val_accuracy50: 0.3993 - 7s/epoch - 21ms/step
Epoch 4/50
320/320 - 7s - loss: 12.9374 - accuracy10: 0.4164 - accuracy20: 0.4122 - accuracy30: 0.4081 - accuracy50: 0.3976 - val_loss: 12.9267 - val_accuracy10: 0.4200 - val_accuracy20: 0.4165 - val_accuracy30: 0.4126 - val_accuracy50: 0.4032 - 7s/epoch - 21ms/step
Epoch 5/50
320/320 - 7s - loss: 12.9121 - accuracy10: 0.4216 - accuracy20: 0.4190 - accuracy30: 0.4124 - accuracy50: 0.4006 - val_loss: 12.9119 - val_accuracy10: 0.4241 - val_accuracy20: 0.4193 - val_accuracy30: 0.4127 - val_accuracy50: 0.4042 - 7s/epoch - 23ms/step
Epoch 6/50
320/320 - 7s - loss: 12.8917 - accuracy10: 0.4221 - accuracy20: 0.4192 - accuracy30: 0.4152 - accuracy50: 0.4052 - val_loss: 12.9131 - val_accuracy10: 0.4213 - val_accuracy20: 0.4181 - val_accuracy30: 0.4138 - val_accuracy50: 0.4042 - 7s/epoch - 22ms/step
Epoch 7/50
320/320 - 7s - loss: 12.8697 - accuracy10: 0.4257 - accuracy20: 0.4248 - accuracy30: 0.4191 - accuracy50: 0.4079 - val_loss: 12.8954 - val_accuracy10: 0.4274 - val_accuracy20: 0.4217 - val_accuracy30: 0.4165 - val_accuracy50: 0.4047 - 7s/epoch - 22ms/step
Epoch 8/50
320/320 - 7s - loss: 12.8491 - accuracy10: 0.4281 - accuracy20: 0.4260 - accuracy30: 0.4191 - accuracy50: 0.4091 - val_loss: 12.8854 - val_accuracy10: 0.4241 - val_accuracy20: 0.4219 - val_accuracy30: 0.4166 - val_accuracy50: 0.4065 - 7s/epoch - 23ms/step
Epoch 9/50
320/320 - 7s - loss: 12.8420 - accuracy10: 0.4294 - accuracy20: 0.4270 - accuracy30: 0.4203 - accuracy50: 0.4096 - val_loss: 12.8757 - val_accuracy10: 0.4241 - val_accuracy20: 0.4210 - val_accuracy30: 0.4173 - val_accuracy50: 0.4100 - 7s/epoch - 22ms/step
Epoch 10/50
320/320 - 7s - loss: 12.8269 - accuracy10: 0.4292 - accuracy20: 0.4282 - accuracy30: 0.4236 - accuracy50: 0.4125 - val_loss: 12.8703 - val_accuracy10: 0.4266 - val_accuracy20: 0.4232 - val_accuracy30: 0.4186 - val_accuracy50: 0.4092 - 7s/epoch - 21ms/step
Epoch 11/50
320/320 - 7s - loss: 12.8078 - accuracy10: 0.4337 - accuracy20: 0.4313 - accuracy30: 0.4249 - accuracy50: 0.4145 - val_loss: 12.8755 - val_accuracy10: 0.4274 - val_accuracy20: 0.4234 - val_accuracy30: 0.4164 - val_accuracy50: 0.4076 - 7s/epoch - 22ms/step
Epoch 12/50
320/320 - 7s - loss: 12.7953 - accuracy10: 0.4347 - accuracy20: 0.4314 - accuracy30: 0.4261 - accuracy50: 0.4168 - val_loss: 12.8662 - val_accuracy10: 0.4287 - val_accuracy20: 0.4233 - val_accuracy30: 0.4185 - val_accuracy50: 0.4101 - 7s/epoch - 22ms/step
Epoch 13/50
320/320 - 7s - loss: 12.7799 - accuracy10: 0.4367 - accuracy20: 0.4345 - accuracy30: 0.4273 - accuracy50: 0.4160 - val_loss: 12.8654 - val_accuracy10: 0.4289 - val_accuracy20: 0.4231 - val_accuracy30: 0.4189 - val_accuracy50: 0.4101 - 7s/epoch - 21ms/step
Epoch 14/50
320/320 - 7s - loss: 12.7672 - accuracy10: 0.4377 - accuracy20: 0.4370 - accuracy30: 0.4302 - accuracy50: 0.4206 - val_loss: 12.8680 - val_accuracy10: 0.4278 - val_accuracy20: 0.4224 - val_accuracy30: 0.4211 - val_accuracy50: 0.4125 - 7s/epoch - 21ms/step
Epoch 15/50
320/320 - 7s - loss: 12.7502 - accuracy10: 0.4396 - accuracy20: 0.4401 - accuracy30: 0.4337 - accuracy50: 0.4225 - val_loss: 12.8724 - val_accuracy10: 0.4265 - val_accuracy20: 0.4215 - val_accuracy30: 0.4190 - val_accuracy50: 0.4091 - 7s/epoch - 21ms/step
Epoch 16/50
320/320 - 7s - loss: 12.7435 - accuracy10: 0.4402 - accuracy20: 0.4412 - accuracy30: 0.4344 - accuracy50: 0.4227 - val_loss: 12.8737 - val_accuracy10: 0.4243 - val_accuracy20: 0.4220 - val_accuracy30: 0.4199 - val_accuracy50: 0.4106 - 7s/epoch - 22ms/step
Epoch 17/50
320/320 - 7s - loss: 12.7292 - accuracy10: 0.4420 - accuracy20: 0.4414 - accuracy30: 0.4350 - accuracy50: 0.4261 - val_loss: 12.8916 - val_accuracy10: 0.4302 - val_accuracy20: 0.4258 - val_accuracy30: 0.4177 - val_accuracy50: 0.4082 - 7s/epoch - 21ms/step
Epoch 18/50
320/320 - 7s - loss: 12.7209 - accuracy10: 0.4409 - accuracy20: 0.4415 - accuracy30: 0.4357 - accuracy50: 0.4254 - val_loss: 12.8883 - val_accuracy10: 0.4258 - val_accuracy20: 0.4212 - val_accuracy30: 0.4193 - val_accuracy50: 0.4098 - 7s/epoch - 21ms/step
Epoch 19/50
320/320 - 7s - loss: 12.7042 - accuracy10: 0.4432 - accuracy20: 0.4440 - accuracy30: 0.4385 - accuracy50: 0.4286 - val_loss: 12.8951 - val_accuracy10: 0.4220 - val_accuracy20: 0.4209 - val_accuracy30: 0.4173 - val_accuracy50: 0.4112 - 7s/epoch - 21ms/step
Epoch 20/50
320/320 - 7s - loss: 12.6951 - accuracy10: 0.4432 - accuracy20: 0.4458 - accuracy30: 0.4407 - accuracy50: 0.4312 - val_loss: 12.8893 - val_accuracy10: 0.4262 - val_accuracy20: 0.4253 - val_accuracy30: 0.4216 - val_accuracy50: 0.4094 - 7s/epoch - 22ms/step
Epoch 21/50
320/320 - 7s - loss: 12.6814 - accuracy10: 0.4437 - accuracy20: 0.4470 - accuracy30: 0.4409 - accuracy50: 0.4304 - val_loss: 12.9015 - val_accuracy10: 0.4261 - val_accuracy20: 0.4240 - val_accuracy30: 0.4195 - val_accuracy50: 0.4084 - 7s/epoch - 22ms/step
Epoch 22/50
320/320 - 7s - loss: 12.6708 - accuracy10: 0.4469 - accuracy20: 0.4493 - accuracy30: 0.4447 - accuracy50: 0.4343 - val_loss: 12.8999 - val_accuracy10: 0.4239 - val_accuracy20: 0.4233 - val_accuracy30: 0.4185 - val_accuracy50: 0.4098 - 7s/epoch - 22ms/step
Epoch 23/50
320/320 - 7s - loss: 12.6524 - accuracy10: 0.4460 - accuracy20: 0.4499 - accuracy30: 0.4452 - accuracy50: 0.4349 - val_loss: 12.9050 - val_accuracy10: 0.4221 - val_accuracy20: 0.4206 - val_accuracy30: 0.4179 - val_accuracy50: 0.4107 - 7s/epoch - 21ms/step
testing model: results/CHTR/W2/deepOF_L1/seq2seq
Evaluating performance on  test set...
860/860 - 9s - 9s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0696968
{'0': {'precision': 0.4296249177924164, 'recall': 0.5104069268505117, 'f1-score': 0.4665449053422781, 'support': 78073}, '1': {'precision': 0.3879245415214307, 'recall': 0.3387790066235296, 'f1-score': 0.36168996603083353, 'support': 65373}, '2': {'precision': 0.4495613096511877, 'recall': 0.4119592642464016, 'f1-score': 0.4299396949272791, 'support': 76493}, 'accuracy': 0.42515424731402796, 'macro avg': {'precision': 0.42237025632167824, 'recall': 0.42038173257348094, 'f1-score': 0.41939152210013025, 'support': 219939}, 'weighted avg': {'precision': 0.4241639296297433, 'recall': 0.42515424731402796, 'f1-score': 0.42264762333280465, 'support': 219939}}
[[39849 16820 21404]
 [26047 22147 17179]
 [26857 18124 31512]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0710225
{'0': {'precision': 0.4164451438657678, 'recall': 0.5197881828316611, 'f1-score': 0.4624130724819061, 'support': 75348}, '1': {'precision': 0.39551918883152226, 'recall': 0.315994817804119, 'f1-score': 0.35131287043475384, 'support': 67153}, '2': {'precision': 0.456064339304006, 'recall': 0.42546295100596604, 'f1-score': 0.44023249599144837, 'support': 77438}, 'accuracy': 0.424354025434325, 'macro avg': {'precision': 0.42267622400043203, 'recall': 0.42041531721391534, 'f1-score': 0.41798614630270275, 'support': 219939}, 'weighted avg': {'precision': 0.4240053791943434, 'recall': 0.424354025434325, 'f1-score': 0.42068181358584633, 'support': 219939}}
[[39165 15583 20600]
 [27238 21220 18695]
 [27643 16848 32947]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0731399
{'0': {'precision': 0.40885637434979644, 'recall': 0.5232106503803707, 'f1-score': 0.45901851231706525, 'support': 74664}, '1': {'precision': 0.39698562497511247, 'recall': 0.29635850178359097, 'f1-score': 0.3393699045155141, 'support': 67280}, '2': {'precision': 0.4554512849553704, 'recall': 0.4330918648631322, 'f1-score': 0.44399024717240293, 'support': 77995}, 'accuracy': 0.42185787877547865, 'macro avg': {'precision': 0.4204310947600931, 'recall': 0.41755367234236457, 'f1-score': 0.4141262213349941, 'support': 219939}, 'weighted avg': {'precision': 0.42174861281024684, 'recall': 0.42185787877547865, 'f1-score': 0.41708830497390964, 'support': 219939}}
[[39065 14795 20804]
 [27758 19939 19583]
 [28724 15492 33779]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0771644
{'0': {'precision': 0.3980320258014154, 'recall': 0.5257502577739187, 'f1-score': 0.45306225046326876, 'support': 73708}, '1': {'precision': 0.39565067904418083, 'recall': 0.2712953276260922, 'f1-score': 0.3218796709876489, 'support': 67867}, '2': {'precision': 0.44972647414654676, 'recall': 0.4364121280179674, 'f1-score': 0.44296927620330556, 'support': 78364}, 'accuracy': 0.41540154315514755, 'macro avg': {'precision': 0.4144697263307144, 'recall': 0.4111525711393261, 'f1-score': 0.4059703992180744, 'support': 219939}, 'weighted avg': {'precision': 0.415715878550335, 'recall': 0.41540154315514755, 'f1-score': 0.4089868752174977, 'support': 219939}}
[[38752 14139 20817]
 [28427 18412 21028]
 [30180 13985 34199]]
Evaluating performance on  train set...
320/320 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0594373
{'0': {'precision': 0.4438789846701427, 'recall': 0.5088039510414429, 'f1-score': 0.4741291624285071, 'support': 27942}, '1': {'precision': 0.43982483999807515, 'recall': 0.3388950685947349, 'f1-score': 0.3828192079747021, 'support': 26970}, '2': {'precision': 0.4293235426552596, 'recall': 0.46303560088161677, 'f1-score': 0.44554277498202727, 'support': 26769}, 'accuracy': 0.43770277053415113, 'macro avg': {'precision': 0.4376757891078258, 'recall': 0.4369115401725982, 'f1-score': 0.4341637151284122, 'support': 81681}, 'weighted avg': {'precision': 0.43777015998506214, 'recall': 0.43770277053415113, 'f1-score': 0.4346113005368316, 'support': 81681}}
[[14217  5963  7762]
 [ 9116  9140  8714]
 [ 8696  5678 12395]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0621427
{'0': {'precision': 0.44644108062010784, 'recall': 0.5193820423782864, 'f1-score': 0.4801572352796659, 'support': 28222}, '1': {'precision': 0.43472338642078795, 'recall': 0.307481379923667, 'f1-score': 0.3601953336950624, 'support': 26987}, '2': {'precision': 0.42190860215053766, 'recall': 0.4743124811121185, 'f1-score': 0.44657846066296775, 'support': 26472}, 'accuracy': 0.43476451071852695, 'macro avg': {'precision': 0.4343576897304778, 'recall': 0.433725301138024, 'f1-score': 0.42897700987923204, 'support': 81681}, 'weighted avg': {'precision': 0.4346188798218376, 'recall': 0.43476451071852695, 'f1-score': 0.42963986698450635, 'support': 81681}}
[[14658  5568  7996]
 [ 9481  8298  9208]
 [ 8694  5222 12556]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0653212
{'0': {'precision': 0.44146908137733826, 'recall': 0.5274940385094494, 'f1-score': 0.48066289383644945, 'support': 28097}, '1': {'precision': 0.43188142427167925, 'recall': 0.2795647538874389, 'f1-score': 0.3394180130322235, 'support': 27203}, '2': {'precision': 0.41455737704918033, 'recall': 0.47928433342178084, 'f1-score': 0.44457727536435715, 'support': 26381}, 'accuracy': 0.4293532155580857, 'macro avg': {'precision': 0.4293026275660659, 'recall': 0.4287810419395564, 'f1-score': 0.42155272741101, 'support': 81681}, 'weighted avg': {'precision': 0.4295841790362017, 'recall': 0.4293532155580857, 'f1-score': 0.4219679807791947, 'support': 81681}}
[[14821  5163  8113]
 [ 9855  7605  9743]
 [ 8896  4841 12644]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0722603
{'0': {'precision': 0.4331781140861467, 'recall': 0.5252496735716554, 'f1-score': 0.47479145732650685, 'support': 28337}, '1': {'precision': 0.4132930140705999, 'recall': 0.25184265944645007, 'f1-score': 0.31297317506309, 'support': 26592}, '2': {'precision': 0.40823344152713953, 'recall': 0.4748430023923445, 'f1-score': 0.43902607613748296, 'support': 26752}, 'accuracy': 0.41973041466191646, 'macro avg': {'precision': 0.4182348565612954, 'recall': 0.41731177847014994, 'f1-score': 0.40893023617569324, 'support': 81681}, 'weighted avg': {'precision': 0.41853450712844564, 'recall': 0.41973041466191646, 'f1-score': 0.4103962217207045, 'support': 81681}}
[[14884  4968  8485]
 [ 9966  6697  9929]
 [ 9510  4539 12703]]
Evaluating performance on  val set...
98/98 - 1s - 819ms/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0657222
{'0': {'precision': 0.44039189058104566, 'recall': 0.5068095557043983, 'f1-score': 0.4712721233196657, 'support': 8958}, '1': {'precision': 0.42481149523403045, 'recall': 0.36427961449310725, 'f1-score': 0.3922238276632077, 'support': 8197}, '2': {'precision': 0.41532205168568803, 'recall': 0.4055854470919805, 'f1-score': 0.4103960075183096, 'support': 7806}, 'accuracy': 0.42834822322823607, 'macro avg': {'precision': 0.42684181250025466, 'recall': 0.425558205763162, 'f1-score': 0.42463065283372775, 'support': 24961}, 'weighted avg': {'precision': 0.4274353718888199, 'recall': 0.42834822322823607, 'f1-score': 0.4262756151893275, 'support': 24961}}
[[4540 2103 2315]
 [3069 2986 2142]
 [2700 1940 3166]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.069662
{'0': {'precision': 0.4308766632065679, 'recall': 0.5123429084380611, 'f1-score': 0.46809165000768876, 'support': 8912}, '1': {'precision': 0.41588135331376486, 'recall': 0.3338707677043284, 'f1-score': 0.3703907539900935, 'support': 8063}, '2': {'precision': 0.42035230008870866, 'recall': 0.4153518657650889, 'f1-score': 0.4178371228821566, 'support': 7986}, 'accuracy': 0.4236609110211931, 'macro avg': {'precision': 0.42237010553634713, 'recall': 0.4205218473024928, 'f1-score': 0.41877317562664623, 'support': 24961}, 'weighted avg': {'precision': 0.42266566414703927, 'recall': 0.4236609110211931, 'f1-score': 0.4204535354203577, 'support': 24961}}
[[4566 2008 2338]
 [3135 2692 2236]
 [2896 1773 3317]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.072482
{'0': {'precision': 0.41696601271069356, 'recall': 0.5179633867276888, 'f1-score': 0.46200949124866053, 'support': 8740}, '1': {'precision': 0.4209282700421941, 'recall': 0.3030008504434455, 'f1-score': 0.3523594235659791, 'support': 8231}, '2': {'precision': 0.41520968333537106, 'recall': 0.4250312891113892, 'f1-score': 0.42006308367864426, 'support': 7990}, 'accuracy': 0.41733103641681024, 'macro avg': {'precision': 0.4177013220294196, 'recall': 0.4153318420941745, 'f1-score': 0.4114773328310946, 'support': 24961}, 'weighted avg': {'precision': 0.41771038466641464, 'recall': 0.41733103641681024, 'f1-score': 0.41242487911050174, 'support': 24961}}
[[4527 1848 2365]
 [3319 2494 2418]
 [3011 1583 3396]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.078995
{'0': {'precision': 0.40195200573065903, 'recall': 0.5195000578636731, 'f1-score': 0.4532283305568176, 'support': 8641}, '1': {'precision': 0.41756007393715344, 'recall': 0.2751522533495737, 'f1-score': 0.33171806167400886, 'support': 8210}, '2': {'precision': 0.4109507336275796, 'recall': 0.4247842170160296, 'f1-score': 0.41775298611532163, 'support': 8110}, 'accuracy': 0.40835703697768516, 'macro avg': {'precision': 0.41015427109846403, 'recall': 0.40647884274309215, 'f1-score': 0.4008997927820494, 'support': 24961}, 'weighted avg': {'precision': 0.41000945227604363, 'recall': 0.40835703697768516, 'f1-score': 0.401735828215229, 'support': 24961}}
[[4489 1723 2429]
 [3442 2259 2509]
 [3237 1428 3445]]
training model: results/CHTR/W2/deepLOB_L2/seq2seq
Epoch 1/50
320/320 - 21s - loss: 13.2955 - accuracy10: 0.3526 - accuracy20: 0.3501 - accuracy30: 0.3505 - accuracy50: 0.3494 - val_loss: 13.2886 - val_accuracy10: 0.3442 - val_accuracy20: 0.3458 - val_accuracy30: 0.3473 - val_accuracy50: 0.3380 - 21s/epoch - 66ms/step
Epoch 2/50
320/320 - 15s - loss: 13.1689 - accuracy10: 0.3623 - accuracy20: 0.3635 - accuracy30: 0.3642 - accuracy50: 0.3622 - val_loss: 13.2931 - val_accuracy10: 0.3508 - val_accuracy20: 0.3461 - val_accuracy30: 0.3453 - val_accuracy50: 0.3453 - 15s/epoch - 48ms/step
Epoch 3/50
320/320 - 15s - loss: 13.0994 - accuracy10: 0.3775 - accuracy20: 0.3753 - accuracy30: 0.3743 - accuracy50: 0.3709 - val_loss: 13.1008 - val_accuracy10: 0.3760 - val_accuracy20: 0.3712 - val_accuracy30: 0.3671 - val_accuracy50: 0.3597 - 15s/epoch - 47ms/step
Epoch 4/50
320/320 - 15s - loss: 13.0515 - accuracy10: 0.3862 - accuracy20: 0.3848 - accuracy30: 0.3830 - accuracy50: 0.3784 - val_loss: 13.0691 - val_accuracy10: 0.3946 - val_accuracy20: 0.3938 - val_accuracy30: 0.3900 - val_accuracy50: 0.3831 - 15s/epoch - 48ms/step
Epoch 5/50
320/320 - 15s - loss: 12.9986 - accuracy10: 0.3971 - accuracy20: 0.3968 - accuracy30: 0.3933 - accuracy50: 0.3879 - val_loss: 13.1617 - val_accuracy10: 0.3969 - val_accuracy20: 0.3920 - val_accuracy30: 0.3871 - val_accuracy50: 0.3772 - 15s/epoch - 47ms/step
Epoch 6/50
320/320 - 15s - loss: 12.9454 - accuracy10: 0.4081 - accuracy20: 0.4088 - accuracy30: 0.4042 - accuracy50: 0.3979 - val_loss: 13.1171 - val_accuracy10: 0.4015 - val_accuracy20: 0.4011 - val_accuracy30: 0.3937 - val_accuracy50: 0.3880 - 15s/epoch - 47ms/step
Epoch 7/50
320/320 - 15s - loss: 12.8999 - accuracy10: 0.4193 - accuracy20: 0.4186 - accuracy30: 0.4129 - accuracy50: 0.4048 - val_loss: 13.0930 - val_accuracy10: 0.3984 - val_accuracy20: 0.4006 - val_accuracy30: 0.3933 - val_accuracy50: 0.3859 - 15s/epoch - 47ms/step
Epoch 8/50
320/320 - 15s - loss: 12.8525 - accuracy10: 0.4276 - accuracy20: 0.4264 - accuracy30: 0.4206 - accuracy50: 0.4108 - val_loss: 13.0924 - val_accuracy10: 0.4036 - val_accuracy20: 0.4047 - val_accuracy30: 0.3971 - val_accuracy50: 0.3881 - 15s/epoch - 47ms/step
Epoch 9/50
320/320 - 15s - loss: 12.8127 - accuracy10: 0.4331 - accuracy20: 0.4314 - accuracy30: 0.4246 - accuracy50: 0.4159 - val_loss: 13.0895 - val_accuracy10: 0.4118 - val_accuracy20: 0.4098 - val_accuracy30: 0.4015 - val_accuracy50: 0.3896 - 15s/epoch - 48ms/step
Epoch 10/50
320/320 - 15s - loss: 12.7728 - accuracy10: 0.4370 - accuracy20: 0.4374 - accuracy30: 0.4310 - accuracy50: 0.4204 - val_loss: 13.0869 - val_accuracy10: 0.4136 - val_accuracy20: 0.4150 - val_accuracy30: 0.4052 - val_accuracy50: 0.3927 - 15s/epoch - 47ms/step
Epoch 11/50
320/320 - 15s - loss: 12.7473 - accuracy10: 0.4382 - accuracy20: 0.4385 - accuracy30: 0.4316 - accuracy50: 0.4212 - val_loss: 13.1630 - val_accuracy10: 0.4065 - val_accuracy20: 0.4059 - val_accuracy30: 0.4003 - val_accuracy50: 0.3908 - 15s/epoch - 48ms/step
Epoch 12/50
320/320 - 15s - loss: 12.7002 - accuracy10: 0.4427 - accuracy20: 0.4448 - accuracy30: 0.4381 - accuracy50: 0.4280 - val_loss: 13.1715 - val_accuracy10: 0.4084 - val_accuracy20: 0.4106 - val_accuracy30: 0.4033 - val_accuracy50: 0.3913 - 15s/epoch - 47ms/step
Epoch 13/50
320/320 - 15s - loss: 12.6759 - accuracy10: 0.4463 - accuracy20: 0.4477 - accuracy30: 0.4417 - accuracy50: 0.4311 - val_loss: 13.2244 - val_accuracy10: 0.4067 - val_accuracy20: 0.4060 - val_accuracy30: 0.3963 - val_accuracy50: 0.3856 - 15s/epoch - 48ms/step
Epoch 14/50
320/320 - 15s - loss: 12.6357 - accuracy10: 0.4503 - accuracy20: 0.4517 - accuracy30: 0.4460 - accuracy50: 0.4342 - val_loss: 13.1633 - val_accuracy10: 0.4164 - val_accuracy20: 0.4152 - val_accuracy30: 0.4046 - val_accuracy50: 0.3936 - 15s/epoch - 48ms/step
testing model: results/CHTR/W2/deepLOB_L2/seq2seq
Evaluating performance on  test set...
860/860 - 15s - 15s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0949354
{'0': {'precision': 0.42362558912348536, 'recall': 0.42942042907460776, 'f1-score': 0.4265033265911028, 'support': 78075}, '1': {'precision': 0.31722550204007205, 'recall': 0.2128827974424083, 'f1-score': 0.25478511602361664, 'support': 65374}, '2': {'precision': 0.38184256680078404, 'recall': 0.48384861755670305, 'f1-score': 0.42683580798616116, 'support': 76495}, 'accuracy': 0.38398865165678536, 'macro avg': {'precision': 0.37423121932144715, 'recall': 0.37538394802457303, 'f1-score': 0.36937475020029353, 'support': 219944}, 'weighted avg': {'precision': 0.3774684237288117, 'recall': 0.38398865165678536, 'f1-score': 0.3755791225513297, 'support': 219944}}
[[33527 14190 30358]
 [21897 13917 29560]
 [23719 15764 37012]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0938479
{'0': {'precision': 0.41010657893065383, 'recall': 0.4284595681429083, 'f1-score': 0.4190822353475693, 'support': 75349}, '1': {'precision': 0.31670812060915476, 'recall': 0.21615665252028887, 'f1-score': 0.25694536636309734, 'support': 67155}, '2': {'precision': 0.3823816163289268, 'recall': 0.47100981404958675, 'f1-score': 0.42209351439862525, 'support': 77440}, 'accuracy': 0.3786191030444113, 'macro avg': {'precision': 0.3697321052895785, 'recall': 0.37187534490426133, 'f1-score': 0.36604037203643064, 'support': 219944}, 'weighted avg': {'precision': 0.3718277689951338, 'recall': 0.3786191030444113, 'f1-score': 0.3706375949530214, 'support': 219944}}
[[32284 14614 28451]
 [22176 14516 30463]
 [24261 16704 36475]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0940354
{'0': {'precision': 0.4076223867030256, 'recall': 0.42042456304828235, 'f1-score': 0.41392450964232735, 'support': 74665}, '1': {'precision': 0.3091179844243656, 'recall': 0.2283077197467376, 'f1-score': 0.26263731566574056, 'support': 67282}, '2': {'precision': 0.3831897984792098, 'recall': 0.45808172109183687, 'f1-score': 0.4173022343171492, 'support': 77997}, 'accuracy': 0.37500909322372966, 'macro avg': {'precision': 0.366643389868867, 'recall': 0.36893800129561893, 'f1-score': 0.3646213532084057, 'support': 219944}, 'weighted avg': {'precision': 0.3688250483905199, 'recall': 0.37500909322372966, 'f1-score': 0.36884279523470254, 'support': 219944}}
[[31391 15907 27367]
 [21776 15361 30145]
 [23843 18425 35729]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0944202
{'0': {'precision': 0.4024404913059168, 'recall': 0.4085118506559579, 'f1-score': 0.40545344374873765, 'support': 73709}, '1': {'precision': 0.3103403336312183, 'recall': 0.24560550472233272, 'f1-score': 0.2742040285899935, 'support': 67869}, '2': {'precision': 0.3798995744494645, 'recall': 0.44313860602812444, 'f1-score': 0.4090895704365138, 'support': 78366}, 'accuracy': 0.37058069326737714, 'macro avg': {'precision': 0.36422679979553324, 'recall': 0.3657519871354717, 'f1-score': 0.3629156809250817, 'support': 219944}, 'weighted avg': {'precision': 0.3659894533526339, 'recall': 0.37058069326737714, 'f1-score': 0.36624883778815437, 'support': 219944}}
[[30111 17018 26580]
 [21096 16669 30104]
 [23614 20025 34727]]
Evaluating performance on  train set...
320/320 - 6s - 6s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0914615
{'0': {'precision': 0.41266462204582355, 'recall': 0.4101488255334409, 'f1-score': 0.41140287769784173, 'support': 27885}, '1': {'precision': 0.36143845866068086, 'recall': 0.28464626376459323, 'f1-score': 0.31847868636298077, 'support': 27153}, '2': {'precision': 0.3733848939631096, 'recall': 0.45661312115298003, 'f1-score': 0.4108261434818579, 'support': 26644}, 'accuracy': 0.38358512279327145, 'macro avg': {'precision': 0.38249599155653796, 'recall': 0.3838027368170047, 'f1-score': 0.3802359025142268, 'support': 81682}, 'weighted avg': {'precision': 0.38282312588470346, 'recall': 0.38358512279327145, 'f1-score': 0.3803245853719174, 'support': 81682}}
[[11437  6816  9632]
 [ 8639  7729 10785]
 [ 7639  6839 12166]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0905633
{'0': {'precision': 0.42150460039689697, 'recall': 0.4147406539567579, 'f1-score': 0.41809527218066633, 'support': 28167}, '1': {'precision': 0.35929624346172134, 'recall': 0.27849034350582336, 'f1-score': 0.3137743449192309, 'support': 27132}, '2': {'precision': 0.3683395573367338, 'recall': 0.45984156464389947, 'f1-score': 0.40903573836817264, 'support': 26383}, 'accuracy': 0.3840503415685218, 'macro avg': {'precision': 0.3830468003984507, 'recall': 0.3843575207021603, 'f1-score': 0.3803017851560233, 'support': 81682}, 'weighted avg': {'precision': 0.38366896376432835, 'recall': 0.3840503415685218, 'f1-score': 0.3805171879144597, 'support': 81682}}
[[11682  6702  9783]
 [ 8554  7556 11022]
 [ 7479  6772 12132]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0902771
{'0': {'precision': 0.4236672051696284, 'recall': 0.41034850640113796, 'f1-score': 0.4169015102247272, 'support': 28120}, '1': {'precision': 0.3581021830433378, 'recall': 0.2851001286055484, 'f1-score': 0.31745836913383246, 'support': 27215}, '2': {'precision': 0.3647457213459837, 'recall': 0.45378980529092494, 'f1-score': 0.4044244494807699, 'support': 26347}, 'accuracy': 0.38263020004407333, 'macro avg': {'precision': 0.3821717031863166, 'recall': 0.38307948009920373, 'f1-score': 0.3795947762797765, 'support': 81682}, 'weighted avg': {'precision': 0.3828166332998338, 'recall': 0.38263020004407333, 'f1-score': 0.3797442637786345, 'support': 81682}}
[[11539  6818  9763]
 [ 8396  7759 11060]
 [ 7301  7090 11956]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0926428
{'0': {'precision': 0.42314654197149104, 'recall': 0.3959840491230547, 'f1-score': 0.4091149393856531, 'support': 28337}, '1': {'precision': 0.3463903743315508, 'recall': 0.2921631272317234, 'f1-score': 0.3169742073605872, 'support': 26605}, '2': {'precision': 0.3644725583669478, 'recall': 0.4460359012715034, 'f1-score': 0.4011502757971209, 'support': 26740}, 'accuracy': 0.37855341446095836, 'macro avg': {'precision': 0.3780031582233299, 'recall': 0.37806102587542717, 'f1-score': 0.37574647418112034, 'support': 81682}, 'weighted avg': {'precision': 0.37893802404041566, 'recall': 0.37855341446095836, 'f1-score': 0.3764960113490694, 'support': 81682}}
[[11221  7172  9944]
 [ 7979  7773 10853]
 [ 7318  7495 11927]]
Evaluating performance on  val set...
98/98 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.086062
{'0': {'precision': 0.4139064880904644, 'recall': 0.5783281039892425, 'f1-score': 0.4824942738278876, 'support': 8924}, '1': {'precision': 0.3702026735661923, 'recall': 0.20931366573204924, 'f1-score': 0.26742465540066973, 'support': 8203}, '2': {'precision': 0.37573211102622867, 'recall': 0.3766913454174113, 'f1-score': 0.3762111167771545, 'support': 7834}, 'accuracy': 0.393774287889107, 'macro avg': {'precision': 0.3866137575609618, 'recall': 0.3881110383795677, 'f1-score': 0.37537668200190394, 'support': 24961}, 'weighted avg': {'precision': 0.3875629737896019, 'recall': 0.393774287889107, 'f1-score': 0.3784584446426022, 'support': 24961}}
[[5161 1435 2328]
 [3911 1717 2575]
 [3397 1486 2951]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0875345
{'0': {'precision': 0.41073985680190933, 'recall': 0.5816809373591708, 'f1-score': 0.48148838944325284, 'support': 8876}, '1': {'precision': 0.3617021276595745, 'recall': 0.209276299428003, 'f1-score': 0.2651437573847972, 'support': 8042}, '2': {'precision': 0.382915482036702, 'recall': 0.3683948775332587, 'f1-score': 0.3755148596413409, 'support': 8043}, 'accuracy': 0.39297303793918514, 'macro avg': {'precision': 0.3851191554993953, 'recall': 0.3864507047734775, 'f1-score': 0.3740490021564636, 'support': 24961}, 'weighted avg': {'precision': 0.3859751092357373, 'recall': 0.39297303793918514, 'f1-score': 0.3776388388959639, 'support': 24961}}
[[5163 1432 2281]
 [3865 1683 2494]
 [3542 1538 2963]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0892658
{'0': {'precision': 0.40025740025740025, 'recall': 0.5715598437858948, 'f1-score': 0.4708108619547734, 'support': 8706}, '1': {'precision': 0.36504736948195926, 'recall': 0.21916979305337045, 'f1-score': 0.27389594676346035, 'support': 8263}, '2': {'precision': 0.37817124735729385, 'recall': 0.3581081081081081, 'f1-score': 0.36786632390745505, 'support': 7992}, 'accuracy': 0.3865630383398101, 'macro avg': {'precision': 0.3811586723655511, 'recall': 0.38294591498245784, 'f1-score': 0.3708577108752296, 'support': 24961}, 'weighted avg': {'precision': 0.38153006488321173, 'recall': 0.3865630383398101, 'f1-score': 0.37266412535367616, 'support': 24961}}
[[4976 1526 2204]
 [3950 1811 2502]
 [3506 1624 2862]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0934197
{'0': {'precision': 0.39111256330664923, 'recall': 0.5556458164094232, 'f1-score': 0.45908241047030063, 'support': 8617}, '1': {'precision': 0.3496437945256843, 'recall': 0.22584160813756357, 'f1-score': 0.27442613301942315, 'support': 8258}, '2': {'precision': 0.37251184834123224, 'recall': 0.3402176601533515, 'f1-score': 0.3556331200310258, 'support': 8086}, 'accuracy': 0.3767477264532671, 'macro avg': {'precision': 0.37108940205785523, 'recall': 0.37390169490011277, 'f1-score': 0.3630472211735832, 'support': 24961}, 'weighted avg': {'precision': 0.37136758218395505, 'recall': 0.3767477264532671, 'f1-score': 0.3644795299093727, 'support': 24961}}
[[4788 1643 2186]
 [3945 1865 2448]
 [3509 1826 2751]]
training model: results/CHTR/W2/deepOF_L2/seq2seq
Epoch 1/50
320/320 - 15s - loss: 13.2394 - accuracy10: 0.3658 - accuracy20: 0.3629 - accuracy30: 0.3573 - accuracy50: 0.3534 - val_loss: 13.1133 - val_accuracy10: 0.3906 - val_accuracy20: 0.3842 - val_accuracy30: 0.3804 - val_accuracy50: 0.3733 - 15s/epoch - 47ms/step
Epoch 2/50
320/320 - 10s - loss: 13.0388 - accuracy10: 0.3984 - accuracy20: 0.3945 - accuracy30: 0.3883 - accuracy50: 0.3821 - val_loss: 12.9826 - val_accuracy10: 0.4160 - val_accuracy20: 0.4093 - val_accuracy30: 0.4023 - val_accuracy50: 0.3949 - 10s/epoch - 30ms/step
Epoch 3/50
320/320 - 9s - loss: 12.9419 - accuracy10: 0.4155 - accuracy20: 0.4096 - accuracy30: 0.4036 - accuracy50: 0.3951 - val_loss: 12.9199 - val_accuracy10: 0.4245 - val_accuracy20: 0.4201 - val_accuracy30: 0.4145 - val_accuracy50: 0.4066 - 9s/epoch - 28ms/step
Epoch 4/50
320/320 - 10s - loss: 12.8718 - accuracy10: 0.4262 - accuracy20: 0.4188 - accuracy30: 0.4127 - accuracy50: 0.4016 - val_loss: 12.8716 - val_accuracy10: 0.4296 - val_accuracy20: 0.4221 - val_accuracy30: 0.4169 - val_accuracy50: 0.4060 - 10s/epoch - 30ms/step
Epoch 5/50
320/320 - 9s - loss: 12.8213 - accuracy10: 0.4332 - accuracy20: 0.4266 - accuracy30: 0.4202 - accuracy50: 0.4083 - val_loss: 12.8554 - val_accuracy10: 0.4342 - val_accuracy20: 0.4273 - val_accuracy30: 0.4210 - val_accuracy50: 0.4110 - 9s/epoch - 29ms/step
Epoch 6/50
320/320 - 10s - loss: 12.7776 - accuracy10: 0.4393 - accuracy20: 0.4344 - accuracy30: 0.4261 - accuracy50: 0.4138 - val_loss: 12.8337 - val_accuracy10: 0.4378 - val_accuracy20: 0.4278 - val_accuracy30: 0.4228 - val_accuracy50: 0.4131 - 10s/epoch - 30ms/step
Epoch 7/50
320/320 - 9s - loss: 12.7379 - accuracy10: 0.4445 - accuracy20: 0.4399 - accuracy30: 0.4317 - accuracy50: 0.4192 - val_loss: 12.8439 - val_accuracy10: 0.4355 - val_accuracy20: 0.4281 - val_accuracy30: 0.4204 - val_accuracy50: 0.4086 - 9s/epoch - 29ms/step
Epoch 8/50
320/320 - 9s - loss: 12.7125 - accuracy10: 0.4475 - accuracy20: 0.4422 - accuracy30: 0.4345 - accuracy50: 0.4207 - val_loss: 12.8501 - val_accuracy10: 0.4383 - val_accuracy20: 0.4309 - val_accuracy30: 0.4229 - val_accuracy50: 0.4126 - 9s/epoch - 29ms/step
Epoch 9/50
320/320 - 9s - loss: 12.6793 - accuracy10: 0.4504 - accuracy20: 0.4459 - accuracy30: 0.4379 - accuracy50: 0.4232 - val_loss: 12.8364 - val_accuracy10: 0.4368 - val_accuracy20: 0.4279 - val_accuracy30: 0.4229 - val_accuracy50: 0.4135 - 9s/epoch - 29ms/step
Epoch 10/50
320/320 - 9s - loss: 12.6419 - accuracy10: 0.4542 - accuracy20: 0.4509 - accuracy30: 0.4430 - accuracy50: 0.4293 - val_loss: 12.8343 - val_accuracy10: 0.4365 - val_accuracy20: 0.4302 - val_accuracy30: 0.4222 - val_accuracy50: 0.4117 - 9s/epoch - 29ms/step
Epoch 11/50
320/320 - 9s - loss: 12.6081 - accuracy10: 0.4583 - accuracy20: 0.4554 - accuracy30: 0.4494 - accuracy50: 0.4328 - val_loss: 12.8482 - val_accuracy10: 0.4358 - val_accuracy20: 0.4308 - val_accuracy30: 0.4235 - val_accuracy50: 0.4169 - 9s/epoch - 29ms/step
Epoch 12/50
320/320 - 9s - loss: 12.5674 - accuracy10: 0.4634 - accuracy20: 0.4591 - accuracy30: 0.4526 - accuracy50: 0.4364 - val_loss: 12.8508 - val_accuracy10: 0.4358 - val_accuracy20: 0.4304 - val_accuracy30: 0.4240 - val_accuracy50: 0.4131 - 9s/epoch - 29ms/step
Epoch 13/50
320/320 - 9s - loss: 12.5293 - accuracy10: 0.4662 - accuracy20: 0.4645 - accuracy30: 0.4573 - accuracy50: 0.4423 - val_loss: 12.8792 - val_accuracy10: 0.4344 - val_accuracy20: 0.4283 - val_accuracy30: 0.4205 - val_accuracy50: 0.4100 - 9s/epoch - 29ms/step
Epoch 14/50
320/320 - 9s - loss: 12.4960 - accuracy10: 0.4664 - accuracy20: 0.4672 - accuracy30: 0.4599 - accuracy50: 0.4438 - val_loss: 12.8921 - val_accuracy10: 0.4363 - val_accuracy20: 0.4285 - val_accuracy30: 0.4211 - val_accuracy50: 0.4107 - 9s/epoch - 29ms/step
Epoch 15/50
320/320 - 9s - loss: 12.4464 - accuracy10: 0.4715 - accuracy20: 0.4757 - accuracy30: 0.4699 - accuracy50: 0.4512 - val_loss: 12.9080 - val_accuracy10: 0.4309 - val_accuracy20: 0.4260 - val_accuracy30: 0.4220 - val_accuracy50: 0.4134 - 9s/epoch - 29ms/step
Epoch 16/50
320/320 - 9s - loss: 12.4145 - accuracy10: 0.4761 - accuracy20: 0.4803 - accuracy30: 0.4723 - accuracy50: 0.4542 - val_loss: 12.9257 - val_accuracy10: 0.4300 - val_accuracy20: 0.4278 - val_accuracy30: 0.4256 - val_accuracy50: 0.4133 - 9s/epoch - 29ms/step
testing model: results/CHTR/W2/deepOF_L2/seq2seq
Evaluating performance on  test set...
860/860 - 10s - 10s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0612159
{'0': {'precision': 0.439914716938787, 'recall': 0.5021326194715202, 'f1-score': 0.4689690647654137, 'support': 78073}, '1': {'precision': 0.41060660445082553, 'recall': 0.3499762899056185, 'f1-score': 0.3778748565152403, 'support': 65373}, '2': {'precision': 0.45241265445249257, 'recall': 0.44419750826873045, 'f1-score': 0.4482674459257109, 'support': 76493}, 'accuracy': 0.4367574645697216, 'macro avg': {'precision': 0.43431132528070177, 'recall': 0.4321021392152897, 'f1-score': 0.43170378906878826, 'support': 219939}, 'weighted avg': {'precision': 0.43555007718212896, 'recall': 0.4367574645697216, 'f1-score': 0.4346930582097598, 'support': 219939}}
[[39203 15672 23198]
 [24566 22879 17928]
 [25346 17169 33978]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.06662
{'0': {'precision': 0.42254725669926757, 'recall': 0.5114667940754897, 'f1-score': 0.46277438877948024, 'support': 75348}, '1': {'precision': 0.40442228149522597, 'recall': 0.3115869730317335, 'f1-score': 0.3519862731409443, 'support': 67153}, '2': {'precision': 0.45342026312713485, 'recall': 0.4508380898267001, 'f1-score': 0.45212548968821836, 'support': 77438}, 'accuracy': 0.42909170269938485, 'macro avg': {'precision': 0.4267966004405428, 'recall': 0.42463061897797444, 'f1-score': 0.4222953838695476, 'support': 219939}, 'weighted avg': {'precision': 0.42788326992058884, 'recall': 0.42909170269938485, 'f1-score': 0.4251985892291334, 'support': 219939}}
[[38538 14319 22491]
 [26635 20924 19594]
 [26031 16495 34912]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0712336
{'0': {'precision': 0.4141413060918864, 'recall': 0.5185363762991535, 'f1-score': 0.4604963455030955, 'support': 74664}, '1': {'precision': 0.4023751382714503, 'recall': 0.2865487514863258, 'f1-score': 0.33472520031599146, 'support': 67280}, '2': {'precision': 0.44799531454908903, 'recall': 0.45113148278735815, 'f1-score': 0.4495579291664537, 'support': 77995}, 'accuracy': 0.4236674714352616, 'macro avg': {'precision': 0.42150391963747524, 'recall': 0.4187388701909458, 'f1-score': 0.4149264916618469, 'support': 219939}, 'weighted avg': {'precision': 0.4225473442145503, 'recall': 0.4236674714352616, 'f1-score': 0.4181435820988573, 'support': 219939}}
[[38716 13252 22696]
 [27342 19279 20659]
 [27427 15382 35186]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0772182
{'0': {'precision': 0.40177963170637127, 'recall': 0.5200927986107342, 'f1-score': 0.45334405543959644, 'support': 73708}, '1': {'precision': 0.3948040313549832, 'recall': 0.2597433214964563, 'f1-score': 0.3133393176142272, 'support': 67867}, '2': {'precision': 0.4431243427312334, 'recall': 0.45167423817058855, 'f1-score': 0.4473584428715875, 'support': 78364}, 'accuracy': 0.4153788095790196, 'macro avg': {'precision': 0.4132360019308627, 'recall': 0.4105034527592597, 'f1-score': 0.4046806053084704, 'support': 219939}, 'weighted avg': {'precision': 0.4143582278885156, 'recall': 0.4153788095790196, 'f1-score': 0.4080098578426547, 'support': 219939}}
[[38335 12780 22593]
 [28351 17628 21888]
 [28727 14242 35395]]
Evaluating performance on  train set...
320/320 - 4s - 4s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.051731
{'0': {'precision': 0.4508510134334924, 'recall': 0.4768448929926276, 'f1-score': 0.46348378119836514, 'support': 27942}, '1': {'precision': 0.4473684210526316, 'recall': 0.38954393770856505, 'f1-score': 0.4164585563087168, 'support': 26970}, '2': {'precision': 0.43478564446306384, 'recall': 0.4652396428704845, 'f1-score': 0.4494974103549708, 'support': 26769}, 'accuracy': 0.44421591312545144, 'macro avg': {'precision': 0.44433502631639593, 'recall': 0.44387615785722573, 'f1-score': 0.44314658262068424, 'support': 81681}, 'weighted avg': {'precision': 0.44443606530012947, 'recall': 0.44421591312545144, 'f1-score': 0.44337296624285977, 'support': 81681}}
[[13324  6645  7973]
 [ 8247 10506  8217]
 [ 7982  6333 12454]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0558789
{'0': {'precision': 0.4545334652159578, 'recall': 0.4884841612926086, 'f1-score': 0.470897663615248, 'support': 28222}, '1': {'precision': 0.4387514723203769, 'recall': 0.3588764960907103, 'f1-score': 0.3948146185361081, 'support': 26987}, '2': {'precision': 0.4274003483963521, 'recall': 0.47268812330009063, 'f1-score': 0.4489049130926115, 'support': 26472}, 'accuracy': 0.4405430883559212, 'macro avg': {'precision': 0.440228428644229, 'recall': 0.4400162602278032, 'f1-score': 0.4382057317479892, 'support': 81681}, 'weighted avg': {'precision': 0.440525599118314, 'recall': 0.4405430883559212, 'f1-score': 0.43863256855781746, 'support': 81681}}
[[13786  6388  8048]
 [ 8586  9685  8716]
 [ 7958  6001 12513]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0609461
{'0': {'precision': 0.44848037958450887, 'recall': 0.49788233619247607, 'f1-score': 0.4718919192430299, 'support': 28097}, '1': {'precision': 0.43518428474180687, 'recall': 0.32900783001874795, 'f1-score': 0.37472000669890515, 'support': 27203}, '2': {'precision': 0.4199779433880293, 'recall': 0.47636556612713693, 'f1-score': 0.4463981244671782, 'support': 26381}, 'accuracy': 0.43469105422313636, 'macro avg': {'precision': 0.4345475359047817, 'recall': 0.4344185774461203, 'f1-score': 0.4310033501363711, 'support': 81681}, 'weighted avg': {'precision': 0.43484665280220514, 'recall': 0.43469105422313636, 'f1-score': 0.43129595032835494, 'support': 81681}}
[[13989  5923  8185]
 [ 9082  8950  9171]
 [ 8121  5693 12567]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0706111
{'0': {'precision': 0.43946693361696804, 'recall': 0.49574760913293575, 'f1-score': 0.46591380196673465, 'support': 28337}, '1': {'precision': 0.4134454659423318, 'recall': 0.297645908543923, 'f1-score': 0.34611684449886304, 'support': 26592}, '2': {'precision': 0.41068332733636453, 'recall': 0.4693107057416268, 'f1-score': 0.43804406608167745, 'support': 26752}, 'accuracy': 0.42259521798215005, 'macro avg': {'precision': 0.4211985756318881, 'recall': 0.42090140780616186, 'f1-score': 0.4166915708490917, 'support': 81681}, 'weighted avg': {'precision': 0.42156825578953405, 'recall': 0.42259521798215005, 'f1-score': 0.41778496089741995, 'support': 81681}}
[[14048  5756  8533]
 [ 9194  7915  9483]
 [ 8724  5473 12555]]
Evaluating performance on  val set...
98/98 - 1s - 1s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0605295
{'0': {'precision': 0.44043685756240825, 'recall': 0.5357222594329092, 'f1-score': 0.48342903193311176, 'support': 8958}, '1': {'precision': 0.44471995332555425, 'recall': 0.37196535317799195, 'f1-score': 0.40510197302863216, 'support': 8197}, '2': {'precision': 0.4264114301567485, 'recall': 0.3937996413015629, 'f1-score': 0.4094572094572095, 'support': 7806}, 'accuracy': 0.4375625976523376, 'macro avg': {'precision': 0.4371894136815703, 'recall': 0.433829084637488, 'f1-score': 0.4326627381396511, 'support': 24961}, 'weighted avg': {'precision': 0.43745725136241337, 'recall': 0.4375625976523376, 'f1-score': 0.4345739801288206, 'support': 24961}}
[[4799 1956 2203]
 [3216 3049 1932]
 [2881 1851 3074]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0657024
{'0': {'precision': 0.4316856553332735, 'recall': 0.5399461400359067, 'f1-score': 0.4797846353257889, 'support': 8912}, '1': {'precision': 0.4264522173641474, 'recall': 0.33870767704328414, 'f1-score': 0.37754890440312433, 'support': 8063}, '2': {'precision': 0.4257759784075574, 'recall': 0.3950663661407463, 'f1-score': 0.40984671343206025, 'support': 7986}, 'accuracy': 0.4285885982132126, 'macro avg': {'precision': 0.42797128370165943, 'recall': 0.4245733944066457, 'f1-score': 0.4223934177203245, 'support': 24961}, 'weighted avg': {'precision': 0.428104392953007, 'recall': 0.4285885982132126, 'f1-score': 0.4243841728974903, 'support': 24961}}
[[4812 1866 2234]
 [3311 2731 2021]
 [3024 1807 3155]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0709375
{'0': {'precision': 0.42052225727304593, 'recall': 0.5490846681922197, 'f1-score': 0.47628026994839223, 'support': 8740}, '1': {'precision': 0.4231219675422453, 'recall': 0.30725306767099986, 'f1-score': 0.35599662162162155, 'support': 8231}, '2': {'precision': 0.4211568938193344, 'recall': 0.3991239048811014, 'f1-score': 0.4098444929957589, 'support': 7990}, 'accuracy': 0.42133728616641963, 'macro avg': {'precision': 0.4216003728782085, 'recall': 0.41848721358144036, 'f1-score': 0.41404046152192425, 'support': 24961}, 'weighted avg': {'precision': 0.421582669966072, 'recall': 0.42133728616641963, 'f1-score': 0.41535015628190486, 'support': 24961}}
[[4799 1725 2216]
 [3535 2529 2167]
 [3078 1723 3189]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0783492
{'0': {'precision': 0.4062553851456143, 'recall': 0.5456544381437334, 'f1-score': 0.46574801205116806, 'support': 8641}, '1': {'precision': 0.4114407532421389, 'recall': 0.282095006090134, 'f1-score': 0.33470626490353356, 'support': 8210}, '2': {'precision': 0.417809992234015, 'recall': 0.39802712700369913, 'f1-score': 0.4076787067441273, 'support': 8110}, 'accuracy': 0.4110011618124274, 'macro avg': {'precision': 0.41183537687392274, 'recall': 0.4085921904125221, 'f1-score': 0.40271099456627635, 'support': 24961}, 'weighted avg': {'precision': 0.4117150917102309, 'recall': 0.4110011618124274, 'f1-score': 0.4037795488436772, 'support': 24961}}
[[4715 1679 2247]
 [3643 2316 2251]
 [3248 1634 3228]]
training model: results/CHTR/W2/deepVOL_L2/seq2seq
Epoch 1/50
320/320 - 14s - loss: 13.2385 - accuracy10: 0.3590 - accuracy20: 0.3603 - accuracy30: 0.3631 - accuracy50: 0.3577 - val_loss: 13.2786 - val_accuracy10: 0.3587 - val_accuracy20: 0.3564 - val_accuracy30: 0.3536 - val_accuracy50: 0.3500 - 14s/epoch - 44ms/step
Epoch 2/50
320/320 - 9s - loss: 13.1191 - accuracy10: 0.3748 - accuracy20: 0.3754 - accuracy30: 0.3764 - accuracy50: 0.3707 - val_loss: 13.1706 - val_accuracy10: 0.3795 - val_accuracy20: 0.3761 - val_accuracy30: 0.3697 - val_accuracy50: 0.3624 - 9s/epoch - 28ms/step
Epoch 3/50
320/320 - 10s - loss: 13.0506 - accuracy10: 0.3894 - accuracy20: 0.3902 - accuracy30: 0.3897 - accuracy50: 0.3816 - val_loss: 13.1078 - val_accuracy10: 0.3856 - val_accuracy20: 0.3863 - val_accuracy30: 0.3792 - val_accuracy50: 0.3715 - 10s/epoch - 30ms/step
Epoch 4/50
320/320 - 9s - loss: 13.0142 - accuracy10: 0.3953 - accuracy20: 0.3959 - accuracy30: 0.3951 - accuracy50: 0.3878 - val_loss: 13.0766 - val_accuracy10: 0.3918 - val_accuracy20: 0.3908 - val_accuracy30: 0.3816 - val_accuracy50: 0.3698 - 9s/epoch - 29ms/step
Epoch 5/50
320/320 - 9s - loss: 12.9856 - accuracy10: 0.4016 - accuracy20: 0.4010 - accuracy30: 0.3992 - accuracy50: 0.3904 - val_loss: 13.0587 - val_accuracy10: 0.3967 - val_accuracy20: 0.3991 - val_accuracy30: 0.3890 - val_accuracy50: 0.3755 - 9s/epoch - 29ms/step
Epoch 6/50
320/320 - 9s - loss: 12.9513 - accuracy10: 0.4093 - accuracy20: 0.4058 - accuracy30: 0.4019 - accuracy50: 0.3917 - val_loss: 13.0341 - val_accuracy10: 0.3977 - val_accuracy20: 0.3998 - val_accuracy30: 0.3879 - val_accuracy50: 0.3786 - 9s/epoch - 29ms/step
Epoch 7/50
320/320 - 9s - loss: 12.9224 - accuracy10: 0.4150 - accuracy20: 0.4119 - accuracy30: 0.4076 - accuracy50: 0.3972 - val_loss: 13.0601 - val_accuracy10: 0.3924 - val_accuracy20: 0.3947 - val_accuracy30: 0.3904 - val_accuracy50: 0.3798 - 9s/epoch - 28ms/step
Epoch 8/50
320/320 - 9s - loss: 12.9012 - accuracy10: 0.4159 - accuracy20: 0.4149 - accuracy30: 0.4111 - accuracy50: 0.4009 - val_loss: 13.0103 - val_accuracy10: 0.4068 - val_accuracy20: 0.4053 - val_accuracy30: 0.3945 - val_accuracy50: 0.3835 - 9s/epoch - 29ms/step
Epoch 9/50
320/320 - 9s - loss: 12.8845 - accuracy10: 0.4174 - accuracy20: 0.4162 - accuracy30: 0.4134 - accuracy50: 0.4025 - val_loss: 12.9896 - val_accuracy10: 0.4060 - val_accuracy20: 0.4070 - val_accuracy30: 0.3977 - val_accuracy50: 0.3880 - 9s/epoch - 29ms/step
Epoch 10/50
320/320 - 9s - loss: 12.8642 - accuracy10: 0.4201 - accuracy20: 0.4188 - accuracy30: 0.4152 - accuracy50: 0.4055 - val_loss: 12.9973 - val_accuracy10: 0.4054 - val_accuracy20: 0.4045 - val_accuracy30: 0.3948 - val_accuracy50: 0.3829 - 9s/epoch - 29ms/step
Epoch 11/50
320/320 - 10s - loss: 12.8430 - accuracy10: 0.4239 - accuracy20: 0.4219 - accuracy30: 0.4169 - accuracy50: 0.4064 - val_loss: 12.9997 - val_accuracy10: 0.4085 - val_accuracy20: 0.4047 - val_accuracy30: 0.3958 - val_accuracy50: 0.3862 - 10s/epoch - 30ms/step
Epoch 12/50
320/320 - 9s - loss: 12.8234 - accuracy10: 0.4238 - accuracy20: 0.4238 - accuracy30: 0.4215 - accuracy50: 0.4104 - val_loss: 13.0063 - val_accuracy10: 0.4071 - val_accuracy20: 0.4081 - val_accuracy30: 0.3965 - val_accuracy50: 0.3862 - 9s/epoch - 28ms/step
Epoch 13/50
320/320 - 10s - loss: 12.8093 - accuracy10: 0.4253 - accuracy20: 0.4261 - accuracy30: 0.4216 - accuracy50: 0.4090 - val_loss: 12.9745 - val_accuracy10: 0.4056 - val_accuracy20: 0.4070 - val_accuracy30: 0.3956 - val_accuracy50: 0.3832 - 10s/epoch - 30ms/step
Epoch 14/50
320/320 - 9s - loss: 12.7895 - accuracy10: 0.4291 - accuracy20: 0.4282 - accuracy30: 0.4245 - accuracy50: 0.4108 - val_loss: 12.9923 - val_accuracy10: 0.4115 - val_accuracy20: 0.4064 - val_accuracy30: 0.3983 - val_accuracy50: 0.3852 - 9s/epoch - 29ms/step
Epoch 15/50
320/320 - 9s - loss: 12.7698 - accuracy10: 0.4296 - accuracy20: 0.4303 - accuracy30: 0.4276 - accuracy50: 0.4147 - val_loss: 12.9889 - val_accuracy10: 0.4086 - val_accuracy20: 0.4078 - val_accuracy30: 0.3967 - val_accuracy50: 0.3823 - 9s/epoch - 28ms/step
Epoch 16/50
320/320 - 9s - loss: 12.7555 - accuracy10: 0.4292 - accuracy20: 0.4317 - accuracy30: 0.4275 - accuracy50: 0.4141 - val_loss: 12.9882 - val_accuracy10: 0.4059 - val_accuracy20: 0.4054 - val_accuracy30: 0.3954 - val_accuracy50: 0.3819 - 9s/epoch - 29ms/step
Epoch 17/50
320/320 - 9s - loss: 12.7379 - accuracy10: 0.4319 - accuracy20: 0.4344 - accuracy30: 0.4302 - accuracy50: 0.4147 - val_loss: 13.0160 - val_accuracy10: 0.4080 - val_accuracy20: 0.4006 - val_accuracy30: 0.3933 - val_accuracy50: 0.3812 - 9s/epoch - 28ms/step
Epoch 18/50
320/320 - 9s - loss: 12.7238 - accuracy10: 0.4323 - accuracy20: 0.4335 - accuracy30: 0.4304 - accuracy50: 0.4176 - val_loss: 12.9900 - val_accuracy10: 0.4084 - val_accuracy20: 0.4073 - val_accuracy30: 0.3971 - val_accuracy50: 0.3846 - 9s/epoch - 30ms/step
Epoch 19/50
320/320 - 9s - loss: 12.7051 - accuracy10: 0.4351 - accuracy20: 0.4369 - accuracy30: 0.4338 - accuracy50: 0.4203 - val_loss: 12.9923 - val_accuracy10: 0.4092 - val_accuracy20: 0.4070 - val_accuracy30: 0.3967 - val_accuracy50: 0.3832 - 9s/epoch - 29ms/step
Epoch 20/50
320/320 - 9s - loss: 12.6924 - accuracy10: 0.4361 - accuracy20: 0.4375 - accuracy30: 0.4351 - accuracy50: 0.4206 - val_loss: 12.9993 - val_accuracy10: 0.4075 - val_accuracy20: 0.4059 - val_accuracy30: 0.3963 - val_accuracy50: 0.3800 - 9s/epoch - 29ms/step
Epoch 21/50
320/320 - 9s - loss: 12.6774 - accuracy10: 0.4373 - accuracy20: 0.4390 - accuracy30: 0.4377 - accuracy50: 0.4231 - val_loss: 12.9789 - val_accuracy10: 0.4062 - val_accuracy20: 0.4133 - val_accuracy30: 0.4019 - val_accuracy50: 0.3888 - 9s/epoch - 28ms/step
Epoch 22/50
320/320 - 9s - loss: 12.6550 - accuracy10: 0.4412 - accuracy20: 0.4411 - accuracy30: 0.4403 - accuracy50: 0.4246 - val_loss: 13.0017 - val_accuracy10: 0.4072 - val_accuracy20: 0.4093 - val_accuracy30: 0.4035 - val_accuracy50: 0.3853 - 9s/epoch - 29ms/step
Epoch 23/50
320/320 - 9s - loss: 12.6401 - accuracy10: 0.4398 - accuracy20: 0.4432 - accuracy30: 0.4407 - accuracy50: 0.4265 - val_loss: 13.0071 - val_accuracy10: 0.4037 - val_accuracy20: 0.4075 - val_accuracy30: 0.4023 - val_accuracy50: 0.3850 - 9s/epoch - 28ms/step
testing model: results/CHTR/W2/deepVOL_L2/seq2seq
Evaluating performance on  test set...
860/860 - 9s - 9s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0815456
{'0': {'precision': 0.39073527293677085, 'recall': 0.5559526096701889, 'f1-score': 0.45892695717450027, 'support': 78075}, '1': {'precision': 0.3921580119563943, 'recall': 0.30704867378468503, 'f1-score': 0.3444234728894989, 'support': 65374}, '2': {'precision': 0.4247095543610196, 'recall': 0.3201908621478528, 'f1-score': 0.3651175791003615, 'support': 76495}, 'accuracy': 0.3999745389735569, 'macro avg': {'precision': 0.4025342797513949, 'recall': 0.3943973818675756, 'f1-score': 0.3894893363881202, 'support': 219944}, 'weighted avg': {'precision': 0.4029741737397788, 'recall': 0.3999745389735569, 'f1-score': 0.39226681114901685, 'support': 219944}}
[[43406 15281 19388]
 [31512 20073 13789]
 [36170 15832 24493]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0835232
{'0': {'precision': 0.3749084548908782, 'recall': 0.5774860980238623, 'f1-score': 0.4546527908386099, 'support': 75349}, '1': {'precision': 0.4013677811550152, 'recall': 0.31461544188816915, 'f1-score': 0.35273592386994446, 'support': 67155}, '2': {'precision': 0.43236861107316404, 'recall': 0.28609245867768596, 'f1-score': 0.34433987923625087, 'support': 77440}, 'accuracy': 0.39462772342050706, 'macro avg': {'precision': 0.40288161570635256, 'recall': 0.39273133286323914, 'f1-score': 0.38390953131493505, 'support': 219944}, 'weighted avg': {'precision': 0.403218345363109, 'recall': 0.39462772342050706, 'f1-score': 0.38469471480213063, 'support': 219944}}
[[43513 15199 16637]
 [33578 21128 12449]
 [38972 16313 22155]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0869765
{'0': {'precision': 0.36841594808584177, 'recall': 0.5596330275229358, 'f1-score': 0.4443251117857542, 'support': 74665}, '1': {'precision': 0.3887707956362103, 'recall': 0.32891412264795933, 'f1-score': 0.3563463628678395, 'support': 67282}, '2': {'precision': 0.4291877507408826, 'recall': 0.2729463953741811, 'f1-score': 0.3336833855799373, 'support': 77997}, 'accuracy': 0.3873895173316844, 'macro avg': {'precision': 0.39545816482097823, 'recall': 0.38716451518169204, 'f1-score': 0.3781182867445103, 'support': 219944}, 'weighted avg': {'precision': 0.3961936239695627, 'recall': 0.3873895173316844, 'f1-score': 0.3781759606219569, 'support': 219944}}
[[41785 16817 16063]
 [32901 22130 12251]
 [38732 17976 21289]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0925945
{'0': {'precision': 0.3600770969746643, 'recall': 0.5423896674761562, 'f1-score': 0.4328183697993916, 'support': 73709}, '1': {'precision': 0.3763161424451747, 'recall': 0.3307106337208446, 'f1-score': 0.3520425368393811, 'support': 67869}, '2': {'precision': 0.41783199042032837, 'recall': 0.2627032131281423, 'f1-score': 0.32258671075001766, 'support': 78366}, 'accuracy': 0.377418797512094, 'macro avg': {'precision': 0.3847417432800557, 'recall': 0.3786011714417144, 'f1-score': 0.3691492057962635, 'support': 219944}, 'weighted avg': {'precision': 0.3856661003427988, 'recall': 0.377418797512094, 'f1-score': 0.3686175314031353, 'support': 219944}}
[[39979 17991 15739]
 [32479 22445 12945]
 [38571 19208 20587]]
Evaluating performance on  train set...
320/320 - 3s - 3s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0648131
{'0': {'precision': 0.414163961038961, 'recall': 0.5123543123543124, 'f1-score': 0.4580561388884436, 'support': 27885}, '1': {'precision': 0.44105586878523834, 'recall': 0.38028947077670977, 'f1-score': 0.4084247997626817, 'support': 27153}, '2': {'precision': 0.4259695465634727, 'recall': 0.3800855727368263, 'f1-score': 0.4017216073624499, 'support': 26644}, 'accuracy': 0.4253079013736196, 'macro avg': {'precision': 0.42706312546255737, 'recall': 0.42424311862261616, 'f1-score': 0.4227341820045251, 'support': 81682}, 'weighted avg': {'precision': 0.4269543431519083, 'recall': 0.4253079013736196, 'f1-score': 0.4231816621461945, 'support': 81682}}
[[14287  6486  7112]
 [10292 10326  6535]
 [ 9917  6600 10127]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0643744
{'0': {'precision': 0.41759279839964436, 'recall': 0.5336031526254127, 'f1-score': 0.46852351190012315, 'support': 28167}, '1': {'precision': 0.4382122810001701, 'recall': 0.37980981866430785, 'f1-score': 0.4069262359816775, 'support': 27132}, '2': {'precision': 0.42928655181744385, 'recall': 0.36080051548345526, 'f1-score': 0.39207529295467186, 'support': 26383}, 'accuracy': 0.42670355769937074, 'macro avg': {'precision': 0.4283638770724194, 'recall': 0.42473782892439194, 'f1-score': 0.42250834694549083, 'support': 81682}, 'weighted avg': {'precision': 0.42821893510466225, 'recall': 0.42670355769937074, 'f1-score': 0.42337047144253015, 'support': 81682}}
[[15030  6598  6539]
 [10711 10305  6116]
 [10251  6613  9519]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0674089
{'0': {'precision': 0.41498083326338175, 'recall': 0.5274182076813656, 'f1-score': 0.4644920841228331, 'support': 28120}, '1': {'precision': 0.4270573566084788, 'recall': 0.3775491456917141, 'f1-score': 0.4007801072647489, 'support': 27215}, '2': {'precision': 0.42361650596353334, 'recall': 0.3518427145405549, 'f1-score': 0.3844080447854033, 'support': 26347}, 'accuracy': 0.42085159521069515, 'macro avg': {'precision': 0.42188489861179795, 'recall': 0.4189366893045449, 'f1-score': 0.41656007872432843, 'support': 81682}, 'weighted avg': {'precision': 0.4217900036003924, 'recall': 0.42085159521069515, 'f1-score': 0.4174328099300364, 'support': 81682}}
[[14831  6848  6441]
 [10768 10275  6172]
 [10140  6937  9270]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.077026
{'0': {'precision': 0.41117267895510573, 'recall': 0.513251226311889, 'f1-score': 0.45657599397259413, 'support': 28337}, '1': {'precision': 0.400524633166653, 'recall': 0.3672993798158241, 'f1-score': 0.383193145501245, 'support': 26605}, '2': {'precision': 0.41621029572836804, 'recall': 0.3410620792819746, 'f1-score': 0.37490750637178333, 'support': 26740}, 'accuracy': 0.40934355182292304, 'macro avg': {'precision': 0.40930253595004223, 'recall': 0.40720422846989585, 'f1-score': 0.40489221528187413, 'support': 81682}, 'weighted avg': {'precision': 0.40935360760909617, 'recall': 0.40934355182292304, 'f1-score': 0.4059385702803985, 'support': 81682}}
[[14544  7208  6585]
 [10626  9772  6207]
 [10202  7418  9120]]
Evaluating performance on  val set...
98/98 - 1s - 1s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0763701
{'0': {'precision': 0.40701554488483765, 'recall': 0.5603989242492156, 'f1-score': 0.47154778181132434, 'support': 8924}, '1': {'precision': 0.4159736387886396, 'recall': 0.3231744483725466, 'f1-score': 0.36374862788144896, 'support': 8203}, '2': {'precision': 0.39692112363116966, 'recall': 0.31924942558080166, 'f1-score': 0.35387336399009556, 'support': 7834}, 'accuracy': 0.4067545370778414, 'macro avg': {'precision': 0.40663676910154894, 'recall': 0.40094093273418796, 'f1-score': 0.3963899245609563, 'support': 24961}, 'weighted avg': {'precision': 0.40679133704827874, 'recall': 0.4067545370778414, 'f1-score': 0.39918938876223675, 'support': 24961}}
[[5001 1939 1984]
 [3736 2651 1816]
 [3550 1783 2501]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0768688
{'0': {'precision': 0.400592777474456, 'recall': 0.5786390265885534, 'f1-score': 0.473429506383371, 'support': 8876}, '1': {'precision': 0.4053259018423905, 'recall': 0.32554091022133796, 'f1-score': 0.3610785463071512, 'support': 8042}, '2': {'precision': 0.41753212462594613, 'recall': 0.2949148327738406, 'f1-score': 0.34567181579714373, 'support': 8043}, 'accuracy': 0.4056728496454469, 'macro avg': {'precision': 0.4078169346475975, 'recall': 0.39969825652791063, 'f1-score': 0.39339328949588864, 'support': 24961}, 'weighted avg': {'precision': 0.40757594943496894, 'recall': 0.4056728496454469, 'f1-score': 0.3960655575705035, 'support': 24961}}
[[5136 1997 1743]
 [3858 2618 1566]
 [3827 1844 2372]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0821302
{'0': {'precision': 0.38601751755701097, 'recall': 0.5619113255226281, 'f1-score': 0.45764535291641334, 'support': 8706}, '1': {'precision': 0.4027963706678566, 'recall': 0.3277260075033281, 'f1-score': 0.3614039770452422, 'support': 8263}, '2': {'precision': 0.4032345013477089, 'recall': 0.2807807807807808, 'f1-score': 0.33104669174596146, 'support': 7992}, 'accuracy': 0.3943752253515484, 'macro avg': {'precision': 0.3973494631908589, 'recall': 0.3901393712689123, 'f1-score': 0.3833653405692057, 'support': 24961}, 'weighted avg': {'precision': 0.3970844538860913, 'recall': 0.3943752253515484, 'f1-score': 0.38525165919830356, 'support': 24961}}
[[4892 2082 1732]
 [3966 2708 1589]
 [3815 1933 2244]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0901964
{'0': {'precision': 0.37540115532734275, 'recall': 0.5429964024602529, 'f1-score': 0.4439068355391111, 'support': 8617}, '1': {'precision': 0.38087660928685085, 'recall': 0.3188423347057399, 'f1-score': 0.3471096170324962, 'support': 8258}, '2': {'precision': 0.3850286532951289, 'recall': 0.26589166460549096, 'f1-score': 0.3145574250182882, 'support': 8086}, 'accuracy': 0.37907135130804054, 'macro avg': {'precision': 0.3804354726364408, 'recall': 0.37591013392382794, 'f1-score': 0.36852462586329854, 'support': 24961}, 'weighted avg': {'precision': 0.38033141642926727, 'recall': 0.37907135130804054, 'f1-score': 0.36998068018079205, 'support': 24961}}
[[4679 2150 1788]
 [3979 2633 1646]
 [3806 2130 2150]]
training model: results/CHTR/W2/deepVOL_L3/seq2seq
Epoch 1/50
320/320 - 19s - loss: 13.2788 - accuracy10: 0.3547 - accuracy20: 0.3572 - accuracy30: 0.3554 - accuracy50: 0.3525 - val_loss: 13.2338 - val_accuracy10: 0.3368 - val_accuracy20: 0.3357 - val_accuracy30: 0.3377 - val_accuracy50: 0.3378 - 19s/epoch - 60ms/step
Epoch 2/50
320/320 - 14s - loss: 13.1888 - accuracy10: 0.3578 - accuracy20: 0.3585 - accuracy30: 0.3583 - accuracy50: 0.3551 - val_loss: 13.1608 - val_accuracy10: 0.3550 - val_accuracy20: 0.3617 - val_accuracy30: 0.3546 - val_accuracy50: 0.3505 - 14s/epoch - 43ms/step
Epoch 3/50
320/320 - 14s - loss: 13.0954 - accuracy10: 0.3765 - accuracy20: 0.3786 - accuracy30: 0.3793 - accuracy50: 0.3730 - val_loss: 13.1387 - val_accuracy10: 0.3673 - val_accuracy20: 0.3580 - val_accuracy30: 0.3559 - val_accuracy50: 0.3529 - 14s/epoch - 43ms/step
Epoch 4/50
320/320 - 13s - loss: 13.0466 - accuracy10: 0.3873 - accuracy20: 0.3878 - accuracy30: 0.3861 - accuracy50: 0.3811 - val_loss: 13.0823 - val_accuracy10: 0.3801 - val_accuracy20: 0.3795 - val_accuracy30: 0.3760 - val_accuracy50: 0.3698 - 13s/epoch - 42ms/step
Epoch 5/50
320/320 - 13s - loss: 13.0104 - accuracy10: 0.3923 - accuracy20: 0.3932 - accuracy30: 0.3925 - accuracy50: 0.3847 - val_loss: 13.0613 - val_accuracy10: 0.3814 - val_accuracy20: 0.3821 - val_accuracy30: 0.3766 - val_accuracy50: 0.3707 - 13s/epoch - 42ms/step
Epoch 6/50
320/320 - 13s - loss: 12.9738 - accuracy10: 0.4000 - accuracy20: 0.3986 - accuracy30: 0.3994 - accuracy50: 0.3894 - val_loss: 13.0762 - val_accuracy10: 0.3951 - val_accuracy20: 0.3947 - val_accuracy30: 0.3841 - val_accuracy50: 0.3729 - 13s/epoch - 42ms/step
Epoch 7/50
320/320 - 14s - loss: 12.9439 - accuracy10: 0.4047 - accuracy20: 0.4060 - accuracy30: 0.4049 - accuracy50: 0.3946 - val_loss: 13.0604 - val_accuracy10: 0.3993 - val_accuracy20: 0.3975 - val_accuracy30: 0.3894 - val_accuracy50: 0.3767 - 14s/epoch - 42ms/step
Epoch 8/50
320/320 - 13s - loss: 12.9189 - accuracy10: 0.4082 - accuracy20: 0.4091 - accuracy30: 0.4072 - accuracy50: 0.3973 - val_loss: 13.0482 - val_accuracy10: 0.3879 - val_accuracy20: 0.3878 - val_accuracy30: 0.3827 - val_accuracy50: 0.3756 - 13s/epoch - 41ms/step
Epoch 9/50
320/320 - 14s - loss: 12.8926 - accuracy10: 0.4111 - accuracy20: 0.4128 - accuracy30: 0.4088 - accuracy50: 0.3959 - val_loss: 13.0204 - val_accuracy10: 0.4028 - val_accuracy20: 0.3980 - val_accuracy30: 0.3908 - val_accuracy50: 0.3806 - 14s/epoch - 43ms/step
Epoch 10/50
320/320 - 13s - loss: 12.8712 - accuracy10: 0.4168 - accuracy20: 0.4154 - accuracy30: 0.4123 - accuracy50: 0.4010 - val_loss: 13.0507 - val_accuracy10: 0.4048 - val_accuracy20: 0.4003 - val_accuracy30: 0.3922 - val_accuracy50: 0.3809 - 13s/epoch - 42ms/step
Epoch 11/50
320/320 - 14s - loss: 12.8499 - accuracy10: 0.4186 - accuracy20: 0.4182 - accuracy30: 0.4143 - accuracy50: 0.4040 - val_loss: 13.0291 - val_accuracy10: 0.4033 - val_accuracy20: 0.3982 - val_accuracy30: 0.3923 - val_accuracy50: 0.3820 - 14s/epoch - 43ms/step
Epoch 12/50
320/320 - 13s - loss: 12.8192 - accuracy10: 0.4221 - accuracy20: 0.4203 - accuracy30: 0.4151 - accuracy50: 0.4081 - val_loss: 13.0325 - val_accuracy10: 0.3989 - val_accuracy20: 0.3945 - val_accuracy30: 0.3873 - val_accuracy50: 0.3759 - 13s/epoch - 41ms/step
Epoch 13/50
320/320 - 13s - loss: 12.8073 - accuracy10: 0.4221 - accuracy20: 0.4231 - accuracy30: 0.4184 - accuracy50: 0.4085 - val_loss: 13.0202 - val_accuracy10: 0.3961 - val_accuracy20: 0.3895 - val_accuracy30: 0.3864 - val_accuracy50: 0.3766 - 13s/epoch - 42ms/step
Epoch 14/50
320/320 - 13s - loss: 12.7784 - accuracy10: 0.4251 - accuracy20: 0.4254 - accuracy30: 0.4232 - accuracy50: 0.4098 - val_loss: 13.0258 - val_accuracy10: 0.3950 - val_accuracy20: 0.3938 - val_accuracy30: 0.3882 - val_accuracy50: 0.3760 - 13s/epoch - 41ms/step
Epoch 15/50
320/320 - 13s - loss: 12.7527 - accuracy10: 0.4281 - accuracy20: 0.4299 - accuracy30: 0.4257 - accuracy50: 0.4148 - val_loss: 13.0126 - val_accuracy10: 0.4001 - val_accuracy20: 0.4004 - val_accuracy30: 0.3906 - val_accuracy50: 0.3807 - 13s/epoch - 42ms/step
Epoch 16/50
320/320 - 13s - loss: 12.7434 - accuracy10: 0.4283 - accuracy20: 0.4305 - accuracy30: 0.4279 - accuracy50: 0.4157 - val_loss: 13.0175 - val_accuracy10: 0.3997 - val_accuracy20: 0.3975 - val_accuracy30: 0.3923 - val_accuracy50: 0.3819 - 13s/epoch - 41ms/step
Epoch 17/50
320/320 - 13s - loss: 12.7177 - accuracy10: 0.4322 - accuracy20: 0.4323 - accuracy30: 0.4307 - accuracy50: 0.4170 - val_loss: 12.9941 - val_accuracy10: 0.4077 - val_accuracy20: 0.4027 - val_accuracy30: 0.3979 - val_accuracy50: 0.3840 - 13s/epoch - 42ms/step
Epoch 18/50
320/320 - 13s - loss: 12.7015 - accuracy10: 0.4349 - accuracy20: 0.4364 - accuracy30: 0.4338 - accuracy50: 0.4209 - val_loss: 13.0096 - val_accuracy10: 0.3994 - val_accuracy20: 0.3958 - val_accuracy30: 0.3890 - val_accuracy50: 0.3794 - 13s/epoch - 41ms/step
Epoch 19/50
320/320 - 13s - loss: 12.6800 - accuracy10: 0.4342 - accuracy20: 0.4375 - accuracy30: 0.4352 - accuracy50: 0.4220 - val_loss: 12.9988 - val_accuracy10: 0.4035 - val_accuracy20: 0.3992 - val_accuracy30: 0.3896 - val_accuracy50: 0.3832 - 13s/epoch - 42ms/step
Epoch 20/50
320/320 - 13s - loss: 12.6661 - accuracy10: 0.4374 - accuracy20: 0.4411 - accuracy30: 0.4372 - accuracy50: 0.4247 - val_loss: 13.0306 - val_accuracy10: 0.4013 - val_accuracy20: 0.3967 - val_accuracy30: 0.3891 - val_accuracy50: 0.3794 - 13s/epoch - 42ms/step
Epoch 21/50
320/320 - 13s - loss: 12.6466 - accuracy10: 0.4380 - accuracy20: 0.4399 - accuracy30: 0.4380 - accuracy50: 0.4270 - val_loss: 13.0300 - val_accuracy10: 0.4000 - val_accuracy20: 0.3975 - val_accuracy30: 0.3908 - val_accuracy50: 0.3811 - 13s/epoch - 41ms/step
Epoch 22/50
320/320 - 13s - loss: 12.6273 - accuracy10: 0.4381 - accuracy20: 0.4423 - accuracy30: 0.4411 - accuracy50: 0.4283 - val_loss: 13.0350 - val_accuracy10: 0.4033 - val_accuracy20: 0.3982 - val_accuracy30: 0.3937 - val_accuracy50: 0.3808 - 13s/epoch - 41ms/step
Epoch 23/50
320/320 - 14s - loss: 12.6068 - accuracy10: 0.4421 - accuracy20: 0.4455 - accuracy30: 0.4430 - accuracy50: 0.4312 - val_loss: 13.0394 - val_accuracy10: 0.4051 - val_accuracy20: 0.3993 - val_accuracy30: 0.3928 - val_accuracy50: 0.3800 - 14s/epoch - 42ms/step
Epoch 24/50
320/320 - 13s - loss: 12.5852 - accuracy10: 0.4438 - accuracy20: 0.4484 - accuracy30: 0.4458 - accuracy50: 0.4337 - val_loss: 13.0356 - val_accuracy10: 0.4035 - val_accuracy20: 0.3999 - val_accuracy30: 0.3942 - val_accuracy50: 0.3790 - 13s/epoch - 42ms/step
Epoch 25/50
320/320 - 13s - loss: 12.5638 - accuracy10: 0.4461 - accuracy20: 0.4499 - accuracy30: 0.4471 - accuracy50: 0.4341 - val_loss: 13.0248 - val_accuracy10: 0.4062 - val_accuracy20: 0.4029 - val_accuracy30: 0.3955 - val_accuracy50: 0.3840 - 13s/epoch - 42ms/step
Epoch 26/50
320/320 - 14s - loss: 12.5430 - accuracy10: 0.4469 - accuracy20: 0.4502 - accuracy30: 0.4486 - accuracy50: 0.4354 - val_loss: 13.0364 - val_accuracy10: 0.4052 - val_accuracy20: 0.3997 - val_accuracy30: 0.3943 - val_accuracy50: 0.3802 - 14s/epoch - 43ms/step
Epoch 27/50
320/320 - 13s - loss: 12.5313 - accuracy10: 0.4460 - accuracy20: 0.4531 - accuracy30: 0.4531 - accuracy50: 0.4389 - val_loss: 13.0276 - val_accuracy10: 0.4051 - val_accuracy20: 0.4064 - val_accuracy30: 0.3959 - val_accuracy50: 0.3815 - 13s/epoch - 42ms/step
testing model: results/CHTR/W2/deepVOL_L3/seq2seq
Evaluating performance on  test set...
860/860 - 16s - 16s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0836554
{'0': {'precision': 0.3899373238040227, 'recall': 0.5793147614473263, 'f1-score': 0.46612527567656703, 'support': 78075}, '1': {'precision': 0.384885290148448, 'recall': 0.3053813442653042, 'f1-score': 0.34055474054109375, 'support': 65374}, '2': {'precision': 0.42324456135634875, 'recall': 0.28816262500817047, 'f1-score': 0.34287891986062713, 'support': 76495}, 'accuracy': 0.39663277925290075, 'macro avg': {'precision': 0.3993557251029398, 'recall': 0.39095291024026696, 'f1-score': 0.38318631202609604, 'support': 219944}, 'weighted avg': {'precision': 0.40001973336448193, 'recall': 0.39663277925290075, 'f1-score': 0.38593769087276814, 'support': 219944}}
[[45230 15866 16979]
 [32351 19964 13059]
 [38412 16040 22043]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.085808
{'0': {'precision': 0.3771068403725485, 'recall': 0.5335969953151336, 'f1-score': 0.4419067298286493, 'support': 75349}, '1': {'precision': 0.3815554901018494, 'recall': 0.3665103119648574, 'f1-score': 0.37388160593033676, 'support': 67155}, '2': {'precision': 0.4277959852519459, 'recall': 0.2696926652892562, 'f1-score': 0.3308252811658482, 'support': 77440}, 'accuracy': 0.38966282326410356, 'macro avg': {'precision': 0.3954861052421146, 'recall': 0.3899333241897491, 'f1-score': 0.3822045389749447, 'support': 219944}, 'weighted avg': {'precision': 0.3963122583518147, 'recall': 0.38966282326410356, 'f1-score': 0.3820261484995906, 'support': 219944}}
[[40206 19557 15586]
 [30193 24613 12349]
 [36218 20337 20885]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0899198
{'0': {'precision': 0.3711761282471827, 'recall': 0.46980512957878523, 'f1-score': 0.4147070993675002, 'support': 74665}, '1': {'precision': 0.36141207651815405, 'recall': 0.43776938854374126, 'f1-score': 0.3959429758232008, 'support': 67282}, '2': {'precision': 0.429611760957626, 'recall': 0.24203495006218187, 'f1-score': 0.3096302249485398, 'support': 77997}, 'accuracy': 0.37923289564616447, 'macro avg': {'precision': 0.3873999885743209, 'recall': 0.38320315606156946, 'f1-score': 0.37342676671308034, 'support': 219944}, 'weighted avg': {'precision': 0.3889118205874326, 'recall': 0.37923289564616447, 'f1-score': 0.37170447718020166, 'support': 219944}}
[[35078 25625 13962]
 [26726 29454 11102]
 [32701 26418 18878]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0957305
{'0': {'precision': 0.3633081758067154, 'recall': 0.4218887788465452, 'f1-score': 0.390413237666585, 'support': 73709}, '1': {'precision': 0.347970050094528, 'recall': 0.4800129661553876, 'f1-score': 0.403462710227132, 'support': 67869}, '2': {'precision': 0.4158666241068579, 'recall': 0.21612689176428554, 'f1-score': 0.284433174074043, 'support': 78366}, 'accuracy': 0.36651147564834685, 'macro avg': {'precision': 0.37571495000270044, 'recall': 0.3726762122554061, 'f1-score': 0.35943637398925327, 'support': 219944}, 'weighted avg': {'precision': 0.3773017928434544, 'recall': 0.36651147564834685, 'f1-score': 0.3566792917063343, 'support': 219944}}
[[31097 29813 12799]
 [24300 32578 10991]
 [30197 31232 16937]]
Evaluating performance on  train set...
320/320 - 6s - 6s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0624313
{'0': {'precision': 0.41442185702062373, 'recall': 0.5037116729424421, 'f1-score': 0.4547249830036582, 'support': 27885}, '1': {'precision': 0.43939878477774225, 'recall': 0.40481714727654405, 'f1-score': 0.4213996818033698, 'support': 27153}, '2': {'precision': 0.4277433803187986, 'recall': 0.36559825851974176, 'f1-score': 0.39423680110083575, 'support': 26644}, 'accuracy': 0.4257853627482187, 'macro avg': {'precision': 0.4271880073723882, 'recall': 0.4247090262462427, 'f1-score': 0.4234538219692879, 'support': 81682}, 'weighted avg': {'precision': 0.42707014166284124, 'recall': 0.4257853627482187, 'f1-score': 0.42391612643660265, 'support': 81682}}
[[14046  7185  6654]
 [ 9783 10992  6378]
 [10064  6839  9741]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.061045
{'0': {'precision': 0.42605079085008507, 'recall': 0.48006532467071394, 'f1-score': 0.45144812619981634, 'support': 28167}, '1': {'precision': 0.43032126356505856, 'recall': 0.44283502874834146, 'f1-score': 0.4364884747425209, 'support': 27132}, '2': {'precision': 0.4305044725968306, 'recall': 0.35936019406435965, 'f1-score': 0.39172829814485816, 'support': 26383}, 'accuracy': 0.4287113439925565, 'macro avg': {'precision': 0.42895884233732473, 'recall': 0.42742018249447167, 'f1-score': 0.4265549663623985, 'support': 81682}, 'weighted avg': {'precision': 0.42890782117778337, 'recall': 0.4287113439925565, 'f1-score': 0.4271897401794777, 'support': 81682}}
[[13522  8284  6361]
 [ 8936 12015  6181]
 [ 9280  7622  9481]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0645988
{'0': {'precision': 0.42648762865517004, 'recall': 0.4450213371266003, 'f1-score': 0.43555741185479097, 'support': 28120}, '1': {'precision': 0.4139231281092557, 'recall': 0.4799926511115194, 'f1-score': 0.4445162827100419, 'support': 27215}, '2': {'precision': 0.4293344882344449, 'recall': 0.33863437962576387, 'f1-score': 0.37862841622814464, 'support': 26347}, 'accuracy': 0.4223574349305845, 'macro avg': {'precision': 0.42324841499962357, 'recall': 0.4212161226212945, 'f1-score': 0.41956737026432583, 'support': 81682}, 'weighted avg': {'precision': 0.42321962991588963, 'recall': 0.4223574349305845, 'f1-score': 0.42017957368420755, 'support': 81682}}
[[12514  9610  5996]
 [ 8289 13063  5863]
 [ 8539  8886  8922]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0761218
{'0': {'precision': 0.4213538439106186, 'recall': 0.407911917281293, 'f1-score': 0.41452393760086065, 'support': 28337}, '1': {'precision': 0.38245134262357083, 'recall': 0.49411764705882355, 'f1-score': 0.431171898061596, 'support': 26605}, '2': {'precision': 0.42397866773998794, 'recall': 0.3151458489154824, 'f1-score': 0.36154968251244207, 'support': 26740}, 'accuracy': 0.40562180162092015, 'macro avg': {'precision': 0.40926128475805906, 'recall': 0.4057251377518663, 'f1-score': 0.40241517272496624, 'support': 81682}, 'weighted avg': {'precision': 0.4095420217521924, 'recall': 0.40562180162092015, 'f1-score': 0.4026043887038399, 'support': 81682}}
[[11559 10953  5825]
 [ 7835 13146  5624]
 [ 8039 10274  8427]]
Evaluating performance on  val set...
98/98 - 2s - 2s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0760562
{'0': {'precision': 0.4040219378427788, 'recall': 0.5695876288659794, 'f1-score': 0.4727272727272727, 'support': 8924}, '1': {'precision': 0.41750580945003873, 'recall': 0.32853833963184204, 'f1-score': 0.36771728748806115, 'support': 8203}, '2': {'precision': 0.4052320675105485, 'recall': 0.3064845545059995, 'f1-score': 0.349007922087361, 'support': 7834}, 'accuracy': 0.4077961620127399, 'macro avg': {'precision': 0.40891993826778866, 'recall': 0.4015368410012736, 'f1-score': 0.39648416076756493, 'support': 24961}, 'weighted avg': {'precision': 0.4088329772487185, 'recall': 0.4077961620127399, 'f1-score': 0.3993882918438818, 'support': 24961}}
[[5083 2035 1806]
 [3790 2695 1718]
 [3708 1725 2401]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0778619
{'0': {'precision': 0.40806714053267107, 'recall': 0.5368409193330329, 'f1-score': 0.4636792682333479, 'support': 8876}, '1': {'precision': 0.39554281245927275, 'recall': 0.37739368316339217, 'f1-score': 0.38625517021953537, 'support': 8042}, '2': {'precision': 0.4206023881661023, 'recall': 0.29342285216958847, 'f1-score': 0.3456862457887798, 'support': 8043}, 'accuracy': 0.40703497456031407, 'macro avg': {'precision': 0.40807078038601535, 'recall': 0.4025524848886712, 'f1-score': 0.3985402280805544, 'support': 24961}, 'weighted avg': {'precision': 0.40807116081829337, 'recall': 0.40703497456031407, 'f1-score': 0.40071454423395914, 'support': 24961}}
[[4765 2449 1662]
 [3418 3035 1589]
 [3494 2189 2360]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0841674
{'0': {'precision': 0.40081896962194075, 'recall': 0.48345968297725705, 'f1-score': 0.4382777112511063, 'support': 8706}, '1': {'precision': 0.3883121053194905, 'recall': 0.4390657146314898, 'f1-score': 0.41213222764966495, 'support': 8263}, '2': {'precision': 0.4080515927301153, 'recall': 0.26126126126126126, 'f1-score': 0.3185597680982531, 'support': 7992}, 'accuracy': 0.39762028764873203, 'macro avg': {'precision': 0.3990608892238489, 'recall': 0.39459555295666937, 'f1-score': 0.38965656899967477, 'support': 24961}, 'weighted avg': {'precision': 0.3989944795834561, 'recall': 0.39762028764873203, 'f1-score': 0.39129137525990754, 'support': 24961}}
[[4209 2981 1516]
 [3122 3628 1513]
 [3170 2734 2088]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0920942
{'0': {'precision': 0.3876942072229653, 'recall': 0.4372751537658118, 'f1-score': 0.4109947643979057, 'support': 8617}, '1': {'precision': 0.3724421495505833, 'recall': 0.47166384112375875, 'f1-score': 0.41622141483222913, 'support': 8258}, '2': {'precision': 0.3933946488294314, 'recall': 0.23274795943606233, 'f1-score': 0.29246309246309243, 'support': 8086}, 'accuracy': 0.38239653860021633, 'macro avg': {'precision': 0.3845103352009933, 'recall': 0.3805623181085443, 'f1-score': 0.37322642389774247, 'support': 24961}, 'weighted avg': {'precision': 0.38449490745818643, 'recall': 0.38239653860021633, 'f1-score': 0.3743261445518155, 'support': 24961}}
[[3768 3375 1474]
 [2935 3895 1428]
 [3016 3188 1882]]
training model: results/CHTR/W3/deepLOB_L1/seq2seq
Epoch 1/50
385/385 - 15s - loss: 13.2155 - accuracy10: 0.3685 - accuracy20: 0.3675 - accuracy30: 0.3644 - accuracy50: 0.3602 - val_loss: 13.4658 - val_accuracy10: 0.3358 - val_accuracy20: 0.3381 - val_accuracy30: 0.3416 - val_accuracy50: 0.3461 - 15s/epoch - 40ms/step
Epoch 2/50
385/385 - 9s - loss: 13.0760 - accuracy10: 0.3952 - accuracy20: 0.3895 - accuracy30: 0.3850 - accuracy50: 0.3781 - val_loss: 13.2381 - val_accuracy10: 0.3631 - val_accuracy20: 0.3636 - val_accuracy30: 0.3590 - val_accuracy50: 0.3573 - 9s/epoch - 24ms/step
Epoch 3/50
385/385 - 9s - loss: 13.0138 - accuracy10: 0.4104 - accuracy20: 0.4006 - accuracy30: 0.3945 - accuracy50: 0.3846 - val_loss: 13.2415 - val_accuracy10: 0.3685 - val_accuracy20: 0.3637 - val_accuracy30: 0.3580 - val_accuracy50: 0.3538 - 9s/epoch - 25ms/step
Epoch 4/50
385/385 - 9s - loss: 12.9472 - accuracy10: 0.4252 - accuracy20: 0.4129 - accuracy30: 0.4058 - accuracy50: 0.3937 - val_loss: 13.2572 - val_accuracy10: 0.3804 - val_accuracy20: 0.3776 - val_accuracy30: 0.3720 - val_accuracy50: 0.3620 - 9s/epoch - 23ms/step
Epoch 5/50
385/385 - 9s - loss: 12.9070 - accuracy10: 0.4338 - accuracy20: 0.4197 - accuracy30: 0.4110 - accuracy50: 0.3975 - val_loss: 13.1810 - val_accuracy10: 0.3847 - val_accuracy20: 0.3814 - val_accuracy30: 0.3758 - val_accuracy50: 0.3640 - 9s/epoch - 24ms/step
Epoch 6/50
385/385 - 10s - loss: 12.8683 - accuracy10: 0.4387 - accuracy20: 0.4275 - accuracy30: 0.4160 - accuracy50: 0.4014 - val_loss: 13.1052 - val_accuracy10: 0.4047 - val_accuracy20: 0.3978 - val_accuracy30: 0.3870 - val_accuracy50: 0.3736 - 10s/epoch - 25ms/step
Epoch 7/50
385/385 - 9s - loss: 12.8418 - accuracy10: 0.4410 - accuracy20: 0.4295 - accuracy30: 0.4198 - accuracy50: 0.4037 - val_loss: 13.1249 - val_accuracy10: 0.3937 - val_accuracy20: 0.3905 - val_accuracy30: 0.3825 - val_accuracy50: 0.3696 - 9s/epoch - 23ms/step
Epoch 8/50
385/385 - 9s - loss: 12.8241 - accuracy10: 0.4419 - accuracy20: 0.4303 - accuracy30: 0.4209 - accuracy50: 0.4055 - val_loss: 13.1488 - val_accuracy10: 0.3966 - val_accuracy20: 0.3935 - val_accuracy30: 0.3857 - val_accuracy50: 0.3725 - 9s/epoch - 24ms/step
Epoch 9/50
385/385 - 9s - loss: 12.8001 - accuracy10: 0.4455 - accuracy20: 0.4344 - accuracy30: 0.4244 - accuracy50: 0.4079 - val_loss: 13.1646 - val_accuracy10: 0.4029 - val_accuracy20: 0.3953 - val_accuracy30: 0.3874 - val_accuracy50: 0.3739 - 9s/epoch - 23ms/step
Epoch 10/50
385/385 - 9s - loss: 12.7790 - accuracy10: 0.4481 - accuracy20: 0.4357 - accuracy30: 0.4255 - accuracy50: 0.4098 - val_loss: 13.1361 - val_accuracy10: 0.4056 - val_accuracy20: 0.4003 - val_accuracy30: 0.3914 - val_accuracy50: 0.3816 - 9s/epoch - 24ms/step
Epoch 11/50
385/385 - 9s - loss: 12.7618 - accuracy10: 0.4498 - accuracy20: 0.4390 - accuracy30: 0.4286 - accuracy50: 0.4131 - val_loss: 13.0804 - val_accuracy10: 0.4058 - val_accuracy20: 0.4011 - val_accuracy30: 0.3934 - val_accuracy50: 0.3814 - 9s/epoch - 24ms/step
Epoch 12/50
385/385 - 9s - loss: 12.7462 - accuracy10: 0.4509 - accuracy20: 0.4387 - accuracy30: 0.4289 - accuracy50: 0.4136 - val_loss: 13.1978 - val_accuracy10: 0.3941 - val_accuracy20: 0.3913 - val_accuracy30: 0.3850 - val_accuracy50: 0.3742 - 9s/epoch - 23ms/step
Epoch 13/50
385/385 - 9s - loss: 12.7312 - accuracy10: 0.4517 - accuracy20: 0.4411 - accuracy30: 0.4313 - accuracy50: 0.4169 - val_loss: 13.1808 - val_accuracy10: 0.4023 - val_accuracy20: 0.3983 - val_accuracy30: 0.3926 - val_accuracy50: 0.3812 - 9s/epoch - 24ms/step
Epoch 14/50
385/385 - 9s - loss: 12.7178 - accuracy10: 0.4539 - accuracy20: 0.4434 - accuracy30: 0.4320 - accuracy50: 0.4186 - val_loss: 13.0792 - val_accuracy10: 0.4093 - val_accuracy20: 0.4031 - val_accuracy30: 0.3944 - val_accuracy50: 0.3838 - 9s/epoch - 24ms/step
Epoch 15/50
385/385 - 9s - loss: 12.7023 - accuracy10: 0.4540 - accuracy20: 0.4448 - accuracy30: 0.4355 - accuracy50: 0.4200 - val_loss: 13.1530 - val_accuracy10: 0.4005 - val_accuracy20: 0.3970 - val_accuracy30: 0.3902 - val_accuracy50: 0.3799 - 9s/epoch - 24ms/step
Epoch 16/50
385/385 - 9s - loss: 12.6841 - accuracy10: 0.4560 - accuracy20: 0.4467 - accuracy30: 0.4374 - accuracy50: 0.4225 - val_loss: 13.2393 - val_accuracy10: 0.3985 - val_accuracy20: 0.3948 - val_accuracy30: 0.3888 - val_accuracy50: 0.3772 - 9s/epoch - 24ms/step
Epoch 17/50
385/385 - 9s - loss: 12.6646 - accuracy10: 0.4587 - accuracy20: 0.4485 - accuracy30: 0.4391 - accuracy50: 0.4243 - val_loss: 13.2182 - val_accuracy10: 0.4005 - val_accuracy20: 0.3964 - val_accuracy30: 0.3903 - val_accuracy50: 0.3818 - 9s/epoch - 23ms/step
Epoch 18/50
385/385 - 9s - loss: 12.6496 - accuracy10: 0.4602 - accuracy20: 0.4513 - accuracy30: 0.4424 - accuracy50: 0.4261 - val_loss: 13.2517 - val_accuracy10: 0.3978 - val_accuracy20: 0.3948 - val_accuracy30: 0.3873 - val_accuracy50: 0.3780 - 9s/epoch - 24ms/step
Epoch 19/50
385/385 - 10s - loss: 12.6356 - accuracy10: 0.4615 - accuracy20: 0.4518 - accuracy30: 0.4435 - accuracy50: 0.4282 - val_loss: 13.3302 - val_accuracy10: 0.3945 - val_accuracy20: 0.3914 - val_accuracy30: 0.3836 - val_accuracy50: 0.3730 - 10s/epoch - 25ms/step
Epoch 20/50
385/385 - 10s - loss: 12.6229 - accuracy10: 0.4629 - accuracy20: 0.4534 - accuracy30: 0.4453 - accuracy50: 0.4301 - val_loss: 13.2544 - val_accuracy10: 0.3954 - val_accuracy20: 0.3907 - val_accuracy30: 0.3854 - val_accuracy50: 0.3745 - 10s/epoch - 25ms/step
Epoch 21/50
385/385 - 9s - loss: 12.6135 - accuracy10: 0.4639 - accuracy20: 0.4533 - accuracy30: 0.4436 - accuracy50: 0.4290 - val_loss: 13.2979 - val_accuracy10: 0.3915 - val_accuracy20: 0.3875 - val_accuracy30: 0.3848 - val_accuracy50: 0.3734 - 9s/epoch - 23ms/step
Epoch 22/50
385/385 - 10s - loss: 12.6056 - accuracy10: 0.4646 - accuracy20: 0.4552 - accuracy30: 0.4451 - accuracy50: 0.4320 - val_loss: 13.1085 - val_accuracy10: 0.3963 - val_accuracy20: 0.3933 - val_accuracy30: 0.3887 - val_accuracy50: 0.3776 - 10s/epoch - 25ms/step
Epoch 23/50
385/385 - 9s - loss: 12.5862 - accuracy10: 0.4650 - accuracy20: 0.4564 - accuracy30: 0.4487 - accuracy50: 0.4342 - val_loss: 13.1262 - val_accuracy10: 0.4009 - val_accuracy20: 0.3944 - val_accuracy30: 0.3890 - val_accuracy50: 0.3793 - 9s/epoch - 25ms/step
Epoch 24/50
385/385 - 9s - loss: 12.5656 - accuracy10: 0.4668 - accuracy20: 0.4600 - accuracy30: 0.4505 - accuracy50: 0.4362 - val_loss: 13.1619 - val_accuracy10: 0.3980 - val_accuracy20: 0.3916 - val_accuracy30: 0.3840 - val_accuracy50: 0.3767 - 9s/epoch - 24ms/step
testing model: results/CHTR/W3/deepLOB_L1/seq2seq
Evaluating performance on  test set...
1140/1140 - 11s - 11s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0963366
{'0': {'precision': 0.43347984636929604, 'recall': 0.302968339648606, 'f1-score': 0.35665963150989677, 'support': 103189}, '1': {'precision': 0.4024042493709813, 'recall': 0.23005615283800918, 'f1-score': 0.2927474136645289, 'support': 93851}, '2': {'precision': 0.38448642879110406, 'recall': 0.6742346534129964, 'f1-score': 0.4897117445102422, 'support': 94565}, 'accuracy': 0.399900550402085, 'macro avg': {'precision': 0.4067901748437938, 'recall': 0.40241971529987053, 'f1-score': 0.3797062632282226, 'support': 291605}, 'weighted avg': {'precision': 0.407590240953852, 'recall': 0.399900550402085, 'f1-score': 0.37923759659579054, 'support': 291605}}
[[31263 19497 52429]
 [22619 21591 49641]
 [18239 12567 63759]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0967788
{'0': {'precision': 0.40772071802949245, 'recall': 0.3047993178634509, 'f1-score': 0.34882667286245356, 'support': 98514}, '1': {'precision': 0.4118961460125368, 'recall': 0.21331940561409976, 'f1-score': 0.2810724743283542, 'support': 97647}, '2': {'precision': 0.3853143594522905, 'recall': 0.6757575122584971, 'f1-score': 0.49078498812929927, 'support': 95444}, 'accuracy': 0.3955830661339826, 'macro avg': {'precision': 0.40164374116477325, 'recall': 0.39795874524534924, 'f1-score': 0.3735613784400356, 'support': 291605}, 'weighted avg': {'precision': 0.4017851734682465, 'recall': 0.3955830661339826, 'f1-score': 0.37260224330215663, 'support': 291605}}
[[30027 17672 50815]
 [24741 20830 52076]
 [18878 12069 64497]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0972234
{'0': {'precision': 0.3897700507821541, 'recall': 0.29756782039289054, 'f1-score': 0.3374847489994754, 'support': 96210}, '1': {'precision': 0.41056454410054477, 'recall': 0.202424303390001, 'f1-score': 0.2711574351684038, 'support': 99410}, '2': {'precision': 0.3818943957999539, 'recall': 0.6729593165598792, 'f1-score': 0.4872702036013066, 'support': 95985}, 'accuracy': 0.3886970388024897, 'macro avg': {'precision': 0.3940763302275509, 'recall': 0.39098381344759026, 'f1-score': 0.36530412925639527, 'support': 291605}, 'weighted avg': {'precision': 0.39426666722328074, 'recall': 0.3886970388024897, 'f1-score': 0.36417687907958357, 'support': 291605}}
[[28629 16703 50878]
 [25618 20123 53669]
 [19204 12187 64594]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1009468
{'0': {'precision': 0.3703913704881759, 'recall': 0.2845350529592368, 'f1-score': 0.3218356274671201, 'support': 94129}, '1': {'precision': 0.3984851283946056, 'recall': 0.19176174248036745, 'f1-score': 0.25892285531370035, 'support': 101235}, '2': {'precision': 0.37423348849206817, 'recall': 0.6632931910516308, 'f1-score': 0.4784966587836699, 'support': 96241}, 'accuracy': 0.37733235026834244, 'macro avg': {'precision': 0.3810366624582832, 'recall': 0.37986332883041163, 'f1-score': 0.35308504718816347, 'support': 291605}, 'weighted avg': {'precision': 0.38141258363771036, 'recall': 0.37733235026834244, 'f1-score': 0.3516987636478599, 'support': 291605}}
[[26783 16592 50754]
 [25834 19413 55988]
 [19693 12712 63836]]
Evaluating performance on  train set...
385/385 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0571197
{'0': {'precision': 0.4653426408416085, 'recall': 0.2862239961296565, 'f1-score': 0.3544389111468903, 'support': 33072}, '1': {'precision': 0.45737710661854875, 'recall': 0.4023300252727609, 'f1-score': 0.4280912325577582, 'support': 32446}, '2': {'precision': 0.4173328488372093, 'recall': 0.6283395641469864, 'f1-score': 0.5015466356126497, 'support': 32901}, 'accuracy': 0.43886851116146275, 'macro avg': {'precision': 0.4466841987657888, 'recall': 0.438964528516468, 'f1-score': 0.4280255931057661, 'support': 98419}, 'weighted avg': {'precision': 0.44666718295097624, 'recall': 0.43886851116146275, 'f1-score': 0.42789743504110755, 'support': 98419}}
[[ 9466  8759 14847]
 [ 5376 13054 14016]
 [ 5500  6728 20673]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.06522
{'0': {'precision': 0.45907785189152345, 'recall': 0.28117731257827877, 'f1-score': 0.3487507628576184, 'support': 33534}, '1': {'precision': 0.44773434279075, 'recall': 0.368215023271584, 'f1-score': 0.40409985792571546, 'support': 32443}, '2': {'precision': 0.4050665052051798, 'recall': 0.6392639171444424, 'f1-score': 0.49590511830322453, 'support': 32442}, 'accuracy': 0.4279051809101901, 'macro avg': {'precision': 0.4372928999624844, 'recall': 0.42955208433143505, 'f1-score': 0.41625191302885284, 'support': 98419}, 'weighted avg': {'precision': 0.43753471921434983, 'recall': 0.4279051809101901, 'f1-score': 0.41550283604125804, 'support': 98419}}
[[ 9429  8446 15659]
 [ 5696 11946 14801]
 [ 5414  6289 20739]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0719784
{'0': {'precision': 0.4519045501704461, 'recall': 0.271641968342589, 'f1-score': 0.33931817338724635, 'support': 33673}, '1': {'precision': 0.43106230566379344, 'recall': 0.3383693267834523, 'f1-score': 0.3791324817391907, 'support': 32367}, '2': {'precision': 0.3957287146349321, 'recall': 0.644955063467062, 'f1-score': 0.4904991192014094, 'support': 32379}, 'accuracy': 0.41640333675408203, 'macro avg': {'precision': 0.42623185682305725, 'recall': 0.41832211953103443, 'f1-score': 0.4029832581092821, 'support': 98419}, 'weighted avg': {'precision': 0.4265688090355917, 'recall': 0.41640333675408203, 'f1-score': 0.4021491060622803, 'support': 98419}}
[[ 9147  8287 16239]
 [ 5766 10952 15649]
 [ 5328  6168 20883]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0810593
{'0': {'precision': 0.4422832119761699, 'recall': 0.2580817684811029, 'f1-score': 0.32595928323482504, 'support': 33656}, '1': {'precision': 0.41157452311671516, 'recall': 0.31400117164616287, 'f1-score': 0.3562271542753205, 'support': 32433}, '2': {'precision': 0.38439188689022136, 'recall': 0.6424682957005877, 'f1-score': 0.480999467382998, 'support': 32330}, 'accuracy': 0.4027779188977738, 'macro avg': {'precision': 0.41274987399436885, 'recall': 0.4048504119426178, 'f1-score': 0.38772863496438115, 'support': 98419}, 'weighted avg': {'precision': 0.41314654684232976, 'recall': 0.4027779188977738, 'f1-score': 0.38686344823311625, 'support': 98419}}
[[ 8686  8221 16749]
 [ 5733 10184 16516]
 [ 5220  6339 20771]]
Evaluating performance on  val set...
139/139 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0871223
{'0': {'precision': 0.462656130512363, 'recall': 0.28896672504378285, 'f1-score': 0.35574284594276756, 'support': 12562}, '1': {'precision': 0.4391909991963568, 'recall': 0.2853537551126969, 'f1-score': 0.34594081341984484, 'support': 11491}, '2': {'precision': 0.37120494541103743, 'recall': 0.6578900865877364, 'f1-score': 0.4746151639736113, 'support': 11318}, 'accuracy': 0.40584094314551467, 'macro avg': {'precision': 0.4243506917065858, 'recall': 0.41073685558140544, 'f1-score': 0.39209960777874125, 'support': 35371}, 'weighted avg': {'precision': 0.425770480207621, 'recall': 0.40584094314551467, 'f1-score': 0.39059517524508264, 'support': 35371}}
[[3630 2358 6574]
 [2173 3279 6039]
 [2043 1829 7446]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0883814
{'0': {'precision': 0.44184299486665835, 'recall': 0.2842529198550141, 'f1-score': 0.3459464758357024, 'support': 12415}, '1': {'precision': 0.4477695427212977, 'recall': 0.2730451095761917, 'f1-score': 0.33923085072571246, 'support': 11727}, '2': {'precision': 0.36786437997331095, 'recall': 0.6628372962864013, 'f1-score': 0.4731422032928612, 'support': 11229}, 'accuracy': 0.40072375674987987, 'macro avg': {'precision': 0.41915897252042233, 'recall': 0.4067117752392024, 'f1-score': 0.38610650995142537, 'support': 35371}, 'weighted avg': {'precision': 0.4203223921145156, 'recall': 0.40072375674987987, 'f1-score': 0.3840999543336692, 'support': 35371}}
[[3529 2247 6639]
 [2374 3202 6151]
 [2084 1702 7443]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0909166
{'0': {'precision': 0.4267819115620694, 'recall': 0.2768118297042574, 'f1-score': 0.33581390764378294, 'support': 12308}, '1': {'precision': 0.4485378440366973, 'recall': 0.2625881168177241, 'f1-score': 0.3312513233114546, 'support': 11916}, '2': {'precision': 0.36331569664902996, 'recall': 0.6652911097156186, 'f1-score': 0.4699768687220761, 'support': 11147}, 'accuracy': 0.39444742868451554, 'macro avg': {'precision': 0.4128784840825988, 'recall': 0.4015636854125333, 'f1-score': 0.3790140332257712, 'support': 35371}, 'weighted avg': {'precision': 0.4141101124535346, 'recall': 0.39444742868451554, 'f1-score': 0.376557646080234, 'support': 35371}}
[[3407 2195 6706]
 [2497 3129 6290]
 [2079 1652 7416]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0950329
{'0': {'precision': 0.42004318557093867, 'recall': 0.2722482917592821, 'f1-score': 0.33036963036963035, 'support': 12147}, '1': {'precision': 0.4462893444989893, 'recall': 0.25336065573770494, 'f1-score': 0.3232249294154554, 'support': 12200}, '2': {'precision': 0.3555804005444293, 'recall': 0.6635522496371553, 'f1-score': 0.4630332953538423, 'support': 11024}, 'accuracy': 0.3876904809024342, 'macro avg': {'precision': 0.40730431020478575, 'recall': 0.39638706571138077, 'f1-score': 0.3722092850463093, 'support': 35371}, 'weighted avg': {'precision': 0.4090049168420358, 'recall': 0.3876904809024342, 'f1-score': 0.3692522995377347, 'support': 35371}}
[[3307 2146 6694]
 [2546 3091 6563]
 [2020 1689 7315]]
training model: results/CHTR/W3/deepOF_L1/seq2seq
Epoch 1/50
385/385 - 15s - loss: 13.0699 - accuracy10: 0.4008 - accuracy20: 0.4008 - accuracy30: 0.3964 - accuracy50: 0.3886 - val_loss: 13.0098 - val_accuracy10: 0.4122 - val_accuracy20: 0.4031 - val_accuracy30: 0.4019 - val_accuracy50: 0.3916 - 15s/epoch - 39ms/step
Epoch 2/50
385/385 - 9s - loss: 12.9005 - accuracy10: 0.4274 - accuracy20: 0.4251 - accuracy30: 0.4193 - accuracy50: 0.4099 - val_loss: 12.9541 - val_accuracy10: 0.4211 - val_accuracy20: 0.4139 - val_accuracy30: 0.4097 - val_accuracy50: 0.3983 - 9s/epoch - 22ms/step
Epoch 3/50
385/385 - 8s - loss: 12.8251 - accuracy10: 0.4385 - accuracy20: 0.4343 - accuracy30: 0.4279 - accuracy50: 0.4186 - val_loss: 12.8543 - val_accuracy10: 0.4339 - val_accuracy20: 0.4275 - val_accuracy30: 0.4202 - val_accuracy50: 0.4055 - 8s/epoch - 22ms/step
Epoch 4/50
385/385 - 8s - loss: 12.7673 - accuracy10: 0.4447 - accuracy20: 0.4412 - accuracy30: 0.4336 - accuracy50: 0.4253 - val_loss: 12.8385 - val_accuracy10: 0.4327 - val_accuracy20: 0.4270 - val_accuracy30: 0.4228 - val_accuracy50: 0.4061 - 8s/epoch - 21ms/step
Epoch 5/50
385/385 - 9s - loss: 12.7345 - accuracy10: 0.4484 - accuracy20: 0.4444 - accuracy30: 0.4371 - accuracy50: 0.4268 - val_loss: 12.8343 - val_accuracy10: 0.4332 - val_accuracy20: 0.4266 - val_accuracy30: 0.4238 - val_accuracy50: 0.4087 - 9s/epoch - 22ms/step
Epoch 6/50
385/385 - 9s - loss: 12.7103 - accuracy10: 0.4498 - accuracy20: 0.4475 - accuracy30: 0.4402 - accuracy50: 0.4311 - val_loss: 12.7605 - val_accuracy10: 0.4452 - val_accuracy20: 0.4408 - val_accuracy30: 0.4367 - val_accuracy50: 0.4223 - 9s/epoch - 22ms/step
Epoch 7/50
385/385 - 8s - loss: 12.6846 - accuracy10: 0.4526 - accuracy20: 0.4502 - accuracy30: 0.4431 - accuracy50: 0.4348 - val_loss: 12.8064 - val_accuracy10: 0.4354 - val_accuracy20: 0.4336 - val_accuracy30: 0.4307 - val_accuracy50: 0.4143 - 8s/epoch - 21ms/step
Epoch 8/50
385/385 - 8s - loss: 12.6518 - accuracy10: 0.4543 - accuracy20: 0.4537 - accuracy30: 0.4458 - accuracy50: 0.4367 - val_loss: 12.7524 - val_accuracy10: 0.4432 - val_accuracy20: 0.4430 - val_accuracy30: 0.4382 - val_accuracy50: 0.4240 - 8s/epoch - 22ms/step
Epoch 9/50
385/385 - 8s - loss: 12.6303 - accuracy10: 0.4575 - accuracy20: 0.4557 - accuracy30: 0.4496 - accuracy50: 0.4386 - val_loss: 12.7038 - val_accuracy10: 0.4502 - val_accuracy20: 0.4487 - val_accuracy30: 0.4428 - val_accuracy50: 0.4271 - 8s/epoch - 22ms/step
Epoch 10/50
385/385 - 9s - loss: 12.6085 - accuracy10: 0.4591 - accuracy20: 0.4588 - accuracy30: 0.4513 - accuracy50: 0.4417 - val_loss: 12.6993 - val_accuracy10: 0.4473 - val_accuracy20: 0.4481 - val_accuracy30: 0.4448 - val_accuracy50: 0.4313 - 9s/epoch - 23ms/step
Epoch 11/50
385/385 - 9s - loss: 12.5915 - accuracy10: 0.4619 - accuracy20: 0.4613 - accuracy30: 0.4548 - accuracy50: 0.4430 - val_loss: 12.6827 - val_accuracy10: 0.4519 - val_accuracy20: 0.4520 - val_accuracy30: 0.4478 - val_accuracy50: 0.4362 - 9s/epoch - 23ms/step
Epoch 12/50
385/385 - 9s - loss: 12.5709 - accuracy10: 0.4627 - accuracy20: 0.4644 - accuracy30: 0.4571 - accuracy50: 0.4458 - val_loss: 12.6836 - val_accuracy10: 0.4552 - val_accuracy20: 0.4541 - val_accuracy30: 0.4492 - val_accuracy50: 0.4325 - 9s/epoch - 22ms/step
Epoch 13/50
385/385 - 8s - loss: 12.5551 - accuracy10: 0.4644 - accuracy20: 0.4656 - accuracy30: 0.4594 - accuracy50: 0.4472 - val_loss: 12.7103 - val_accuracy10: 0.4503 - val_accuracy20: 0.4495 - val_accuracy30: 0.4460 - val_accuracy50: 0.4317 - 8s/epoch - 21ms/step
Epoch 14/50
385/385 - 9s - loss: 12.5415 - accuracy10: 0.4656 - accuracy20: 0.4668 - accuracy30: 0.4602 - accuracy50: 0.4493 - val_loss: 12.6933 - val_accuracy10: 0.4535 - val_accuracy20: 0.4507 - val_accuracy30: 0.4459 - val_accuracy50: 0.4314 - 9s/epoch - 22ms/step
Epoch 15/50
385/385 - 8s - loss: 12.5287 - accuracy10: 0.4656 - accuracy20: 0.4671 - accuracy30: 0.4616 - accuracy50: 0.4499 - val_loss: 12.6727 - val_accuracy10: 0.4533 - val_accuracy20: 0.4537 - val_accuracy30: 0.4493 - val_accuracy50: 0.4338 - 8s/epoch - 21ms/step
Epoch 16/50
385/385 - 8s - loss: 12.5048 - accuracy10: 0.4675 - accuracy20: 0.4696 - accuracy30: 0.4646 - accuracy50: 0.4532 - val_loss: 12.7054 - val_accuracy10: 0.4500 - val_accuracy20: 0.4478 - val_accuracy30: 0.4441 - val_accuracy50: 0.4306 - 8s/epoch - 22ms/step
Epoch 17/50
385/385 - 8s - loss: 12.4917 - accuracy10: 0.4689 - accuracy20: 0.4709 - accuracy30: 0.4660 - accuracy50: 0.4536 - val_loss: 12.7310 - val_accuracy10: 0.4456 - val_accuracy20: 0.4443 - val_accuracy30: 0.4400 - val_accuracy50: 0.4287 - 8s/epoch - 22ms/step
Epoch 18/50
385/385 - 8s - loss: 12.4731 - accuracy10: 0.4704 - accuracy20: 0.4732 - accuracy30: 0.4681 - accuracy50: 0.4561 - val_loss: 12.7164 - val_accuracy10: 0.4496 - val_accuracy20: 0.4481 - val_accuracy30: 0.4462 - val_accuracy50: 0.4310 - 8s/epoch - 21ms/step
Epoch 19/50
385/385 - 9s - loss: 12.4583 - accuracy10: 0.4722 - accuracy20: 0.4735 - accuracy30: 0.4678 - accuracy50: 0.4567 - val_loss: 12.7403 - val_accuracy10: 0.4453 - val_accuracy20: 0.4471 - val_accuracy30: 0.4426 - val_accuracy50: 0.4284 - 9s/epoch - 22ms/step
Epoch 20/50
385/385 - 8s - loss: 12.4369 - accuracy10: 0.4744 - accuracy20: 0.4773 - accuracy30: 0.4716 - accuracy50: 0.4607 - val_loss: 12.7243 - val_accuracy10: 0.4480 - val_accuracy20: 0.4464 - val_accuracy30: 0.4421 - val_accuracy50: 0.4304 - 8s/epoch - 22ms/step
Epoch 21/50
385/385 - 9s - loss: 12.4235 - accuracy10: 0.4746 - accuracy20: 0.4768 - accuracy30: 0.4730 - accuracy50: 0.4608 - val_loss: 12.7887 - val_accuracy10: 0.4421 - val_accuracy20: 0.4407 - val_accuracy30: 0.4395 - val_accuracy50: 0.4240 - 9s/epoch - 24ms/step
Epoch 22/50
385/385 - 9s - loss: 12.4137 - accuracy10: 0.4750 - accuracy20: 0.4791 - accuracy30: 0.4745 - accuracy50: 0.4628 - val_loss: 12.7633 - val_accuracy10: 0.4469 - val_accuracy20: 0.4456 - val_accuracy30: 0.4445 - val_accuracy50: 0.4287 - 9s/epoch - 23ms/step
Epoch 23/50
385/385 - 8s - loss: 12.3920 - accuracy10: 0.4762 - accuracy20: 0.4811 - accuracy30: 0.4763 - accuracy50: 0.4652 - val_loss: 12.8040 - val_accuracy10: 0.4439 - val_accuracy20: 0.4414 - val_accuracy30: 0.4391 - val_accuracy50: 0.4245 - 8s/epoch - 22ms/step
Epoch 24/50
385/385 - 8s - loss: 12.3826 - accuracy10: 0.4757 - accuracy20: 0.4812 - accuracy30: 0.4761 - accuracy50: 0.4650 - val_loss: 12.8135 - val_accuracy10: 0.4440 - val_accuracy20: 0.4428 - val_accuracy30: 0.4398 - val_accuracy50: 0.4252 - 8s/epoch - 21ms/step
Epoch 25/50
385/385 - 8s - loss: 12.3656 - accuracy10: 0.4784 - accuracy20: 0.4824 - accuracy30: 0.4780 - accuracy50: 0.4667 - val_loss: 12.8108 - val_accuracy10: 0.4436 - val_accuracy20: 0.4421 - val_accuracy30: 0.4371 - val_accuracy50: 0.4213 - 8s/epoch - 22ms/step
testing model: results/CHTR/W3/deepOF_L1/seq2seq
Evaluating performance on  test set...
1140/1140 - 12s - 12s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.066834
{'0': {'precision': 0.4428375607008894, 'recall': 0.40387448152885996, 'f1-score': 0.42245954069245856, 'support': 103188}, '1': {'precision': 0.4179380693772789, 'recall': 0.40426212040490145, 'f1-score': 0.4109863564228805, 'support': 93850}, '2': {'precision': 0.4305005013447284, 'recall': 0.48581369034400346, 'f1-score': 0.45648760905423397, 'support': 94563}, 'accuracy': 0.43057122575025464, 'macro avg': {'precision': 0.4304253771409656, 'recall': 0.4313167640925883, 'f1-score': 0.42997783538985773, 'support': 291601}, 'weighted avg': {'precision': 0.43082303878698136, 'recall': 0.43057122575025464, 'f1-score': 0.42980189509040184, 'support': 291601}}
[[41675 30105 31408]
 [26545 37940 29365]
 [25889 22734 45940]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0614817
{'0': {'precision': 0.42925915460529757, 'recall': 0.41636129241825953, 'f1-score': 0.42271186091329754, 'support': 98513}, '1': {'precision': 0.4426659199103892, 'recall': 0.404717039100424, 'f1-score': 0.4228417352785401, 'support': 97646}, '2': {'precision': 0.44310827643692696, 'recall': 0.4957146748810796, 'f1-score': 0.4679375911777069, 'support': 95442}, 'accuracy': 0.43843471044337984, 'macro avg': {'precision': 0.43834445031753794, 'recall': 0.4389310021332544, 'f1-score': 0.43783039578984817, 'support': 291601}, 'weighted avg': {'precision': 0.4382814312464454, 'recall': 0.43843471044337984, 'f1-score': 0.4375578863390136, 'support': 291601}}
[[41017 27722 29774]
 [28440 39519 29687]
 [26096 22034 47312]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0619849
{'0': {'precision': 0.42252809698194216, 'recall': 0.41734141296552296, 'f1-score': 0.4199187395744547, 'support': 96209}, '1': {'precision': 0.4473839310536558, 'recall': 0.40470178756450625, 'f1-score': 0.4249738557258601, 'support': 99409}, '2': {'precision': 0.4457936388868052, 'recall': 0.4953272975422731, 'f1-score': 0.46925692514965633, 'support': 95983}, 'accuracy': 0.43870219923799986, 'macro avg': {'precision': 0.43856855564080105, 'recall': 0.43912349935743417, 'f1-score': 0.4380498401499904, 'support': 291601}, 'weighted avg': {'precision': 0.4386596950144916, 'recall': 0.43870219923799986, 'f1-score': 0.43788215913597756, 'support': 291601}}
[[40152 27048 29009]
 [29082 40231 30096]
 [25794 22646 47543]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0709265
{'0': {'precision': 0.40899139122117123, 'recall': 0.408826279109298, 'f1-score': 0.4089088184976995, 'support': 94128}, '1': {'precision': 0.4368694321473466, 'recall': 0.39479819033131164, 'f1-score': 0.4147696905857752, 'support': 101234}, '2': {'precision': 0.4374210099409579, 'recall': 0.4819044254408296, 'f1-score': 0.4585865077991744, 'support': 96239}, 'accuracy': 0.4280746636671342, 'macro avg': {'precision': 0.4277606111031586, 'recall': 0.4285096316271464, 'f1-score': 0.42742167229421635, 'support': 291601}, 'weighted avg': {'precision': 0.4280525181414972, 'recall': 0.4280746636671342, 'f1-score': 0.4273389701969354, 'support': 291601}}
[[38482 27814 27832]
 [29451 39967 31816]
 [26157 23704 46378]]
Evaluating performance on  train set...
385/385 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0429764
{'0': {'precision': 0.4642869740044443, 'recall': 0.3970499517374517, 'f1-score': 0.42804416044745786, 'support': 33152}, '1': {'precision': 0.46940514224859275, 'recall': 0.47533507934062547, 'f1-score': 0.47235150030618495, 'support': 32455}, '2': {'precision': 0.4498951669265093, 'recall': 0.510103319008869, 'f1-score': 0.47811120791852946, 'support': 32811}, 'accuracy': 0.46055599585441687, 'macro avg': {'precision': 0.4611957610598488, 'recall': 0.460829450028982, 'f1-score': 0.45950228955739075, 'support': 98418}, 'weighted avg': {'precision': 0.46117677636102244, 'recall': 0.46055599585441687, 'f1-score': 0.4593468145319578, 'support': 98418}}
[[13163  9357 10632]
 [ 7195 15427  9833]
 [ 7993  8081 16737]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0443637
{'0': {'precision': 0.472676573604924, 'recall': 0.4138875655073845, 'f1-score': 0.44133288882538774, 'support': 33584}, '1': {'precision': 0.466382036685642, 'recall': 0.45515432098765435, 'f1-score': 0.46069978131833805, 'support': 32400}, '2': {'precision': 0.44641758711989515, 'recall': 0.5146451254856015, 'f1-score': 0.47810955961331897, 'support': 32434}, 'accuracy': 0.4606779247698592, 'macro avg': {'precision': 0.4618253991368204, 'recall': 0.46122900399354677, 'f1-score': 0.4600474099190149, 'support': 98418}, 'weighted avg': {'precision': 0.46195061937053433, 'recall': 0.4606779247698592, 'f1-score': 0.45982850809327924, 'support': 98418}}
[[13900  9116 10568]
 [ 7522 14747 10131]
 [ 7985  7757 16692]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0508859
{'0': {'precision': 0.4700831768178159, 'recall': 0.4147972773009766, 'f1-score': 0.44071314026978586, 'support': 33790}, '1': {'precision': 0.45067704480396253, 'recall': 0.43395583635293755, 'f1-score': 0.4421584095929315, 'support': 32289}, '2': {'precision': 0.44378982165231534, 'recall': 0.5147654534772257, 'f1-score': 0.4766499642090194, 'support': 32339}, 'accuracy': 0.45393119144871874, 'macro avg': {'precision': 0.4548500144246979, 'recall': 0.45450618904371326, 'f1-score': 0.45317383802391226, 'support': 98418}, 'weighted avg': {'precision': 0.4550767205873252, 'recall': 0.45393119144871874, 'f1-score': 0.452995723237799, 'support': 98418}}
[[14016  9225 10549]
 [ 7962 14012 10315]
 [ 7838  7854 16647]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0596039
{'0': {'precision': 0.4617879112062049, 'recall': 0.41126030904814365, 'f1-score': 0.43506196947983433, 'support': 33587}, '1': {'precision': 0.43626089764288023, 'recall': 0.4152375683815846, 'f1-score': 0.4254897020847767, 'support': 32538}, '2': {'precision': 0.4353154305200341, 'recall': 0.5059920106524634, 'f1-score': 0.4680004009795357, 'support': 32293}, 'accuracy': 0.4436586803227052, 'macro avg': {'precision': 0.44445474645637306, 'recall': 0.4441632960273972, 'f1-score': 0.44285069084804896, 'support': 98418}, 'weighted avg': {'precision': 0.4446622453105154, 'recall': 0.4436586803227052, 'f1-score': 0.44270506659539727, 'support': 98418}}
[[13813  9367 10407]
 [ 8238 13511 10789]
 [ 7861  8092 16340]]
Evaluating performance on  val set...
139/139 - 1s - 1s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0504403
{'0': {'precision': 0.45863570391872277, 'recall': 0.4255386565272497, 'f1-score': 0.4414677240415828, 'support': 12624}, '1': {'precision': 0.4549759025957555, 'recall': 0.4723490168539326, 'f1-score': 0.46349972005685003, 'support': 11392}, '2': {'precision': 0.44155185529541036, 'recall': 0.4600616468516072, 'f1-score': 0.45061675148796687, 'support': 11355}, 'accuracy': 0.451697718469933, 'macro avg': {'precision': 0.45172115393662954, 'recall': 0.4526497734109298, 'f1-score': 0.45186139852879986, 'support': 35371}, 'weighted avg': {'precision': 0.45197263084222067, 'recall': 0.451697718469933, 'f1-score': 0.4515006805669742, 'support': 35371}}
[[5372 3569 3683]
 [3087 5381 2924]
 [3254 2877 5224]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0522021
{'0': {'precision': 0.45447026714084854, 'recall': 0.4428237569506004, 'f1-score': 0.4485714285714286, 'support': 12409}, '1': {'precision': 0.4627831715210356, 'recall': 0.4509887487214456, 'f1-score': 0.4568098424347075, 'support': 11732}, '2': {'precision': 0.43952055372668186, 'recall': 0.4636687444345503, 'f1-score': 0.451271829093903, 'support': 11230}, 'accuracy': 0.4521500664386079, 'macro avg': {'precision': 0.45225799746285533, 'recall': 0.4524937500355321, 'f1-score': 0.45221770003334644, 'support': 35371}, 'weighted avg': {'precision': 0.4524811153653054, 'recall': 0.4521500664386079, 'f1-score': 0.45216133468975656, 'support': 35371}}
[[5495 3382 3532]
 [3333 5291 3108]
 [3263 2760 5207]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0556751
{'0': {'precision': 0.4502760154898245, 'recall': 0.4424384715025907, 'f1-score': 0.44632283882559515, 'support': 12352}, '1': {'precision': 0.45853529567286505, 'recall': 0.43910878555152333, 'f1-score': 0.4486118296257975, 'support': 11849}, '2': {'precision': 0.43450828636325395, 'recall': 0.4623992837958818, 'f1-score': 0.4480201240404215, 'support': 11170}, 'accuracy': 0.44762658675185885, 'macro avg': {'precision': 0.4477731991753145, 'recall': 0.4479821802833319, 'f1-score': 0.4476515974972714, 'support': 35371}, 'weighted avg': {'precision': 0.44806343107165864, 'recall': 0.44762658675185885, 'f1-score': 0.44762562720707166, 'support': 35371}}
[[5465 3390 3497]
 [3421 5203 3225]
 [3251 2754 5165]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0674875
{'0': {'precision': 0.4408112582781457, 'recall': 0.4395740465577018, 'f1-score': 0.4401917830867157, 'support': 12114}, '1': {'precision': 0.4453323965926056, 'recall': 0.4152132973061492, 'f1-score': 0.42974576271186443, 'support': 12213}, '2': {'precision': 0.41742271505376344, 'recall': 0.44992756247736326, 'f1-score': 0.4330660624019522, 'support': 11044}, 'accuracy': 0.43439540866811793, 'macro avg': {'precision': 0.4345221233081716, 'recall': 0.43490496878040474, 'f1-score': 0.4343345360668441, 'support': 35371}, 'weighted avg': {'precision': 0.4350696504882733, 'recall': 0.43439540866811793, 'f1-score': 0.4343600648406784, 'support': 35371}}
[[5325 3466 3323]
 [3530 5071 3612]
 [3225 2850 4969]]
training model: results/CHTR/W3/deepLOB_L2/seq2seq
Epoch 1/50
385/385 - 25s - loss: 13.2573 - accuracy10: 0.3587 - accuracy20: 0.3593 - accuracy30: 0.3592 - accuracy50: 0.3582 - val_loss: 13.2610 - val_accuracy10: 0.3449 - val_accuracy20: 0.3494 - val_accuracy30: 0.3523 - val_accuracy50: 0.3539 - 25s/epoch - 66ms/step
Epoch 2/50
385/385 - 19s - loss: 13.0947 - accuracy10: 0.3855 - accuracy20: 0.3868 - accuracy30: 0.3840 - accuracy50: 0.3792 - val_loss: 13.2692 - val_accuracy10: 0.3632 - val_accuracy20: 0.3607 - val_accuracy30: 0.3596 - val_accuracy50: 0.3557 - 19s/epoch - 48ms/step
Epoch 3/50
385/385 - 19s - loss: 12.9678 - accuracy10: 0.4069 - accuracy20: 0.4036 - accuracy30: 0.3989 - accuracy50: 0.3917 - val_loss: 13.0988 - val_accuracy10: 0.3812 - val_accuracy20: 0.3819 - val_accuracy30: 0.3803 - val_accuracy50: 0.3746 - 19s/epoch - 48ms/step
Epoch 4/50
385/385 - 19s - loss: 12.8791 - accuracy10: 0.4227 - accuracy20: 0.4198 - accuracy30: 0.4140 - accuracy50: 0.4039 - val_loss: 13.1391 - val_accuracy10: 0.3928 - val_accuracy20: 0.3864 - val_accuracy30: 0.3808 - val_accuracy50: 0.3725 - 19s/epoch - 49ms/step
Epoch 5/50
385/385 - 19s - loss: 12.8128 - accuracy10: 0.4331 - accuracy20: 0.4293 - accuracy30: 0.4232 - accuracy50: 0.4118 - val_loss: 13.0821 - val_accuracy10: 0.3959 - val_accuracy20: 0.3921 - val_accuracy30: 0.3874 - val_accuracy50: 0.3790 - 19s/epoch - 49ms/step
Epoch 6/50
385/385 - 19s - loss: 12.7565 - accuracy10: 0.4407 - accuracy20: 0.4378 - accuracy30: 0.4312 - accuracy50: 0.4190 - val_loss: 13.0332 - val_accuracy10: 0.4069 - val_accuracy20: 0.4041 - val_accuracy30: 0.3969 - val_accuracy50: 0.3871 - 19s/epoch - 50ms/step
Epoch 7/50
385/385 - 19s - loss: 12.7109 - accuracy10: 0.4461 - accuracy20: 0.4417 - accuracy30: 0.4348 - accuracy50: 0.4237 - val_loss: 13.2397 - val_accuracy10: 0.3915 - val_accuracy20: 0.3917 - val_accuracy30: 0.3861 - val_accuracy50: 0.3780 - 19s/epoch - 48ms/step
Epoch 8/50
385/385 - 19s - loss: 12.6543 - accuracy10: 0.4513 - accuracy20: 0.4482 - accuracy30: 0.4421 - accuracy50: 0.4315 - val_loss: 13.1376 - val_accuracy10: 0.3977 - val_accuracy20: 0.3928 - val_accuracy30: 0.3875 - val_accuracy50: 0.3784 - 19s/epoch - 49ms/step
Epoch 9/50
385/385 - 19s - loss: 12.6166 - accuracy10: 0.4548 - accuracy20: 0.4538 - accuracy30: 0.4480 - accuracy50: 0.4354 - val_loss: 13.3502 - val_accuracy10: 0.3867 - val_accuracy20: 0.3856 - val_accuracy30: 0.3798 - val_accuracy50: 0.3709 - 19s/epoch - 49ms/step
Epoch 10/50
385/385 - 19s - loss: 12.5707 - accuracy10: 0.4588 - accuracy20: 0.4582 - accuracy30: 0.4528 - accuracy50: 0.4388 - val_loss: 13.4986 - val_accuracy10: 0.3812 - val_accuracy20: 0.3787 - val_accuracy30: 0.3746 - val_accuracy50: 0.3653 - 19s/epoch - 48ms/step
Epoch 11/50
385/385 - 19s - loss: 12.5364 - accuracy10: 0.4632 - accuracy20: 0.4613 - accuracy30: 0.4566 - accuracy50: 0.4418 - val_loss: 13.2586 - val_accuracy10: 0.3933 - val_accuracy20: 0.3900 - val_accuracy30: 0.3828 - val_accuracy50: 0.3735 - 19s/epoch - 49ms/step
Epoch 12/50
385/385 - 19s - loss: 12.4983 - accuracy10: 0.4661 - accuracy20: 0.4660 - accuracy30: 0.4606 - accuracy50: 0.4481 - val_loss: 13.3008 - val_accuracy10: 0.3894 - val_accuracy20: 0.3889 - val_accuracy30: 0.3842 - val_accuracy50: 0.3741 - 19s/epoch - 49ms/step
Epoch 13/50
385/385 - 19s - loss: 12.4554 - accuracy10: 0.4710 - accuracy20: 0.4702 - accuracy30: 0.4647 - accuracy50: 0.4507 - val_loss: 13.3690 - val_accuracy10: 0.3942 - val_accuracy20: 0.3915 - val_accuracy30: 0.3860 - val_accuracy50: 0.3787 - 19s/epoch - 49ms/step
Epoch 14/50
385/385 - 19s - loss: 12.4215 - accuracy10: 0.4722 - accuracy20: 0.4728 - accuracy30: 0.4676 - accuracy50: 0.4524 - val_loss: 13.2412 - val_accuracy10: 0.3997 - val_accuracy20: 0.3987 - val_accuracy30: 0.3956 - val_accuracy50: 0.3841 - 19s/epoch - 49ms/step
Epoch 15/50
385/385 - 19s - loss: 12.3955 - accuracy10: 0.4745 - accuracy20: 0.4751 - accuracy30: 0.4702 - accuracy50: 0.4549 - val_loss: 13.3729 - val_accuracy10: 0.3923 - val_accuracy20: 0.3926 - val_accuracy30: 0.3865 - val_accuracy50: 0.3756 - 19s/epoch - 48ms/step
Epoch 16/50
385/385 - 18s - loss: 12.3489 - accuracy10: 0.4782 - accuracy20: 0.4814 - accuracy30: 0.4761 - accuracy50: 0.4610 - val_loss: 13.3010 - val_accuracy10: 0.3996 - val_accuracy20: 0.3961 - val_accuracy30: 0.3900 - val_accuracy50: 0.3779 - 18s/epoch - 48ms/step
testing model: results/CHTR/W3/deepLOB_L2/seq2seq
Evaluating performance on  test set...
1140/1140 - 19s - 19s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.104921
{'0': {'precision': 0.42028686268032156, 'recall': 0.2958939421837599, 'f1-score': 0.3472875447147074, 'support': 103189}, '1': {'precision': 0.43253891985393045, 'recall': 0.1438769965157537, 'f1-score': 0.2159288072983713, 'support': 93851}, '2': {'precision': 0.3658643116241165, 'recall': 0.7263469571194416, 'f1-score': 0.4866172636590343, 'support': 94565}, 'accuracy': 0.38656058709555735, 'macro avg': {'precision': 0.40623003138612285, 'recall': 0.3887059652729851, 'f1-score': 0.349944538557371, 'support': 291605}, 'weighted avg': {'precision': 0.4065813338902471, 'recall': 0.38656058709555735, 'f1-score': 0.35019409983793814, 'support': 291605}}
[[30533 10729 61927]
 [23223 13503 57125]
 [18892  6986 68687]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1049901
{'0': {'precision': 0.40231554373201583, 'recall': 0.30088109304261323, 'f1-score': 0.34428247865729716, 'support': 98514}, '1': {'precision': 0.43726248642779586, 'recall': 0.13197538070806067, 'f1-score': 0.2027548989529496, 'support': 97647}, '2': {'precision': 0.3686835723799063, 'recall': 0.7279766145593227, 'f1-score': 0.48947344320731523, 'support': 95444}, 'accuracy': 0.38411206940896075, 'macro avg': {'precision': 0.4027538675132393, 'recall': 0.3869443627699989, 'f1-score': 0.3455036069391873, 'support': 291605}, 'weighted avg': {'precision': 0.40300995651534977, 'recall': 0.38411206940896075, 'f1-score': 0.34441232157878854, 'support': 291605}}
[[29641  9750 59123]
 [24907 12887 59853]
 [19128  6835 69481]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.105084
{'0': {'precision': 0.39036556200888284, 'recall': 0.2969026088764162, 'f1-score': 0.3372789798388287, 'support': 96210}, '1': {'precision': 0.4416584611056407, 'recall': 0.12633537873453374, 'f1-score': 0.19647075387575674, 'support': 99410}, '2': {'precision': 0.36800109477141385, 'recall': 0.7284263166119707, 'f1-score': 0.4889729665464947, 'support': 95985}, 'accuracy': 0.3807959397129679, 'macro avg': {'precision': 0.4000083726286458, 'recall': 0.3838881014076401, 'f1-score': 0.3409075667536934, 'support': 291605}, 'weighted avg': {'precision': 0.4004901267845905, 'recall': 0.3807959397129679, 'f1-score': 0.33920830742630603, 'support': 291605}}
[[28565  9145 58500]
 [25275 12559 61576]
 [19335  6732 69918]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1089358
{'0': {'precision': 0.3807206806428293, 'recall': 0.2909411552231512, 'f1-score': 0.3298306044164494, 'support': 94129}, '1': {'precision': 0.4244299790132679, 'recall': 0.11786437496913123, 'f1-score': 0.18449454185607816, 'support': 101235}, '2': {'precision': 0.3640478179160576, 'recall': 0.7246080152949367, 'f1-score': 0.48461958089096285, 'support': 96241}, 'accuracy': 0.37398192760755133, 'macro avg': {'precision': 0.38973282585738495, 'recall': 0.3778045151624064, 'f1-score': 0.33298157572116344, 'support': 291605}, 'weighted avg': {'precision': 0.3903923180936416, 'recall': 0.37398192760755133, 'f1-score': 0.3304614221033357, 'support': 291605}}
[[27386  9235 57508]
 [24988 11932 64315]
 [19558  6946 69737]]
Evaluating performance on  train set...
385/385 - 7s - 7s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0691562
{'0': {'precision': 0.44605826906598117, 'recall': 0.3147980164489598, 'f1-score': 0.3691058640005672, 'support': 33072}, '1': {'precision': 0.4851696043452793, 'recall': 0.2808050298958269, 'f1-score': 0.3557247437774524, 'support': 32446}, '2': {'precision': 0.3971936056838366, 'recall': 0.679675389805781, 'f1-score': 0.5013845136265289, 'support': 32901}, 'accuracy': 0.42556823377599856, 'macro avg': {'precision': 0.44280715969836565, 'recall': 0.4250928120501893, 'f1-score': 0.4087383738015162, 'support': 98419}, 'weighted avg': {'precision': 0.44261696296183634, 'recall': 0.42556823377599856, 'f1-score': 0.4089146003683883, 'support': 98419}}
[[10411  5611 17050]
 [ 6447  9111 16888]
 [ 6482  4057 22362]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0703437
{'0': {'precision': 0.44376253017470646, 'recall': 0.32343293373889187, 'f1-score': 0.37416127641224667, 'support': 33534}, '1': {'precision': 0.48138342815298824, 'recall': 0.26341583700644206, 'f1-score': 0.3405052195394055, 'support': 32443}, '2': {'precision': 0.392565584704313, 'recall': 0.6803526293076876, 'f1-score': 0.49786278998951133, 'support': 32442}, 'accuracy': 0.4213007650961705, 'macro avg': {'precision': 0.4392371810106692, 'recall': 0.42240046668434045, 'f1-score': 0.40417642864705455, 'support': 98419}, 'weighted avg': {'precision': 0.43928781988664106, 'recall': 0.4213007650961705, 'f1-score': 0.40384275102942463, 'support': 98419}}
[[10846  5426 17262]
 [ 7006  8546 16891]
 [ 6589  3781 22072]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0740954
{'0': {'precision': 0.436849866485991, 'recall': 0.32551302230273516, 'f1-score': 0.3730515281464843, 'support': 33673}, '1': {'precision': 0.4688843096850162, 'recall': 0.24605307875305094, 'f1-score': 0.3227427459880045, 'support': 32367}, '2': {'precision': 0.3889214276840069, 'recall': 0.676765804997066, 'f1-score': 0.4939699285408353, 'support': 32379}, 'accuracy': 0.41494020463528386, 'macro avg': {'precision': 0.4315518679516714, 'recall': 0.4161106353509507, 'f1-score': 0.3965880675584414, 'support': 98419}, 'weighted avg': {'precision': 0.4316169734780698, 'recall': 0.41494020463528386, 'f1-score': 0.396287616038509, 'support': 98419}}
[[10961  5338 17374]
 [ 7347  7964 17056]
 [ 6783  3683 21913]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0817984
{'0': {'precision': 0.42857142857142855, 'recall': 0.32312217732350845, 'f1-score': 0.3684504751740611, 'support': 33656}, '1': {'precision': 0.4449024124136259, 'recall': 0.22631270619430827, 'f1-score': 0.3000143058592712, 'support': 32433}, '2': {'precision': 0.3808934318961553, 'recall': 0.6661923909681411, 'f1-score': 0.4846752779152978, 'support': 32330}, 'accuracy': 0.40391591054572795, 'macro avg': {'precision': 0.41812242429373664, 'recall': 0.40520909149531925, 'f1-score': 0.3843800196495433, 'support': 98419}, 'weighted avg': {'precision': 0.4182912303012003, 'recall': 0.40391591054572795, 'f1-score': 0.3840771081741688, 'support': 98419}}
[[10875  5321 17460]
 [ 7545  7340 17548]
 [ 6955  3837 21538]]
Evaluating performance on  val set...
139/139 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.083707
{'0': {'precision': 0.43114672008012017, 'recall': 0.34270020697341186, 'f1-score': 0.38186898478733317, 'support': 12562}, '1': {'precision': 0.4580666338421139, 'recall': 0.24288573666347577, 'f1-score': 0.3174476797088262, 'support': 11491}, '2': {'precision': 0.3811226869849168, 'recall': 0.6496730871178653, 'f1-score': 0.4804155368985005, 'support': 11318}, 'accuracy': 0.40849848746147976, 'macro avg': {'precision': 0.4234453469690503, 'recall': 0.41175301025158434, 'f1-score': 0.3932440671315533, 'support': 35371}, 'weighted avg': {'precision': 0.42388553782537924, 'recall': 0.40849848746147976, 'f1-score': 0.3924732837932156, 'support': 35371}}
[[4305 1896 6361]
 [3121 2791 5579]
 [2559 1406 7353]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0824817
{'0': {'precision': 0.41756609565303493, 'recall': 0.3396697543294402, 'f1-score': 0.37461135293595094, 'support': 12415}, '1': {'precision': 0.4652077278167208, 'recall': 0.2320286518291123, 'f1-score': 0.3096267637687756, 'support': 11727}, '2': {'precision': 0.37929259125778714, 'recall': 0.6560691067770951, 'f1-score': 0.4806864152420723, 'support': 11229}, 'accuracy': 0.4044273557434056, 'macro avg': {'precision': 0.420688804909181, 'recall': 0.40925583764521584, 'f1-score': 0.38830817731559963, 'support': 35371}, 'weighted avg': {'precision': 0.4212108961825452, 'recall': 0.4044273557434056, 'f1-score': 0.3867411371510416, 'support': 35371}}
[[4217 1789 6409]
 [3359 2721 5647]
 [2523 1339 7367]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0853605
{'0': {'precision': 0.4115771644913819, 'recall': 0.3356353591160221, 'f1-score': 0.3697471470127545, 'support': 12308}, '1': {'precision': 0.46087568137858276, 'recall': 0.2199563611950319, 'f1-score': 0.2977901494063512, 'support': 11916}, '2': {'precision': 0.3739502214078485, 'recall': 0.659101103435902, 'f1-score': 0.4771708774436578, 'support': 11147}, 'accuracy': 0.3986033756467162, 'macro avg': {'precision': 0.41546768909260434, 'recall': 0.40489760791565194, 'f1-score': 0.3815693912875879, 'support': 35371}, 'weighted avg': {'precision': 0.4163272024511721, 'recall': 0.3986033756467162, 'f1-score': 0.37935990151885773, 'support': 35371}}
[[4131 1738 6439]
 [3434 2621 5861]
 [2472 1328 7347]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0917151
{'0': {'precision': 0.3962668298653611, 'recall': 0.31983205729809827, 'f1-score': 0.3539702063687304, 'support': 12147}, '1': {'precision': 0.4584959205391983, 'recall': 0.21188524590163935, 'f1-score': 0.2898306985088014, 'support': 12200}, '2': {'precision': 0.36349039088765117, 'recall': 0.6571117561683599, 'f1-score': 0.46806448486414887, 'support': 11024}, 'accuracy': 0.3877187526504764, 'macro avg': {'precision': 0.40608438043073686, 'recall': 0.3962763531226992, 'f1-score': 0.3706217965805602, 'support': 35371}, 'weighted avg': {'precision': 0.40751523796608036, 'recall': 0.3877187526504764, 'f1-score': 0.3674070142125108, 'support': 35371}}
[[3885 1702 6560]
 [3490 2585 6125]
 [2429 1351 7244]]
training model: results/CHTR/W3/deepOF_L2/seq2seq
Epoch 1/50
385/385 - 17s - loss: 13.0920 - accuracy10: 0.3980 - accuracy20: 0.3944 - accuracy30: 0.3901 - accuracy50: 0.3823 - val_loss: 12.9867 - val_accuracy10: 0.4112 - val_accuracy20: 0.4112 - val_accuracy30: 0.4118 - val_accuracy50: 0.3959 - 17s/epoch - 44ms/step
Epoch 2/50
385/385 - 11s - loss: 12.8322 - accuracy10: 0.4345 - accuracy20: 0.4322 - accuracy30: 0.4253 - accuracy50: 0.4132 - val_loss: 12.7878 - val_accuracy10: 0.4397 - val_accuracy20: 0.4374 - val_accuracy30: 0.4324 - val_accuracy50: 0.4125 - 11s/epoch - 30ms/step
Epoch 3/50
385/385 - 12s - loss: 12.7103 - accuracy10: 0.4487 - accuracy20: 0.4466 - accuracy30: 0.4387 - accuracy50: 0.4271 - val_loss: 12.7326 - val_accuracy10: 0.4502 - val_accuracy20: 0.4465 - val_accuracy30: 0.4397 - val_accuracy50: 0.4203 - 12s/epoch - 30ms/step
Epoch 4/50
385/385 - 12s - loss: 12.6410 - accuracy10: 0.4574 - accuracy20: 0.4534 - accuracy30: 0.4459 - accuracy50: 0.4354 - val_loss: 12.7202 - val_accuracy10: 0.4499 - val_accuracy20: 0.4481 - val_accuracy30: 0.4391 - val_accuracy50: 0.4195 - 12s/epoch - 30ms/step
Epoch 5/50
385/385 - 12s - loss: 12.5923 - accuracy10: 0.4631 - accuracy20: 0.4609 - accuracy30: 0.4523 - accuracy50: 0.4396 - val_loss: 12.6908 - val_accuracy10: 0.4557 - val_accuracy20: 0.4503 - val_accuracy30: 0.4443 - val_accuracy50: 0.4245 - 12s/epoch - 30ms/step
Epoch 6/50
385/385 - 12s - loss: 12.5404 - accuracy10: 0.4665 - accuracy20: 0.4648 - accuracy30: 0.4573 - accuracy50: 0.4456 - val_loss: 12.6561 - val_accuracy10: 0.4589 - val_accuracy20: 0.4531 - val_accuracy30: 0.4469 - val_accuracy50: 0.4270 - 12s/epoch - 31ms/step
Epoch 7/50
385/385 - 12s - loss: 12.4965 - accuracy10: 0.4726 - accuracy20: 0.4689 - accuracy30: 0.4634 - accuracy50: 0.4511 - val_loss: 12.6475 - val_accuracy10: 0.4592 - val_accuracy20: 0.4546 - val_accuracy30: 0.4486 - val_accuracy50: 0.4282 - 12s/epoch - 32ms/step
Epoch 8/50
385/385 - 11s - loss: 12.4487 - accuracy10: 0.4770 - accuracy20: 0.4749 - accuracy30: 0.4681 - accuracy50: 0.4543 - val_loss: 12.6781 - val_accuracy10: 0.4546 - val_accuracy20: 0.4489 - val_accuracy30: 0.4448 - val_accuracy50: 0.4275 - 11s/epoch - 29ms/step
Epoch 9/50
385/385 - 11s - loss: 12.4094 - accuracy10: 0.4799 - accuracy20: 0.4780 - accuracy30: 0.4722 - accuracy50: 0.4589 - val_loss: 12.6227 - val_accuracy10: 0.4609 - val_accuracy20: 0.4555 - val_accuracy30: 0.4501 - val_accuracy50: 0.4326 - 11s/epoch - 29ms/step
Epoch 10/50
385/385 - 11s - loss: 12.3727 - accuracy10: 0.4835 - accuracy20: 0.4826 - accuracy30: 0.4761 - accuracy50: 0.4626 - val_loss: 12.6186 - val_accuracy10: 0.4639 - val_accuracy20: 0.4597 - val_accuracy30: 0.4535 - val_accuracy50: 0.4356 - 11s/epoch - 29ms/step
Epoch 11/50
385/385 - 12s - loss: 12.3257 - accuracy10: 0.4865 - accuracy20: 0.4863 - accuracy30: 0.4805 - accuracy50: 0.4679 - val_loss: 12.6367 - val_accuracy10: 0.4588 - val_accuracy20: 0.4557 - val_accuracy30: 0.4488 - val_accuracy50: 0.4304 - 12s/epoch - 30ms/step
Epoch 12/50
385/385 - 11s - loss: 12.3062 - accuracy10: 0.4897 - accuracy20: 0.4887 - accuracy30: 0.4830 - accuracy50: 0.4701 - val_loss: 12.6446 - val_accuracy10: 0.4605 - val_accuracy20: 0.4549 - val_accuracy30: 0.4478 - val_accuracy50: 0.4294 - 11s/epoch - 29ms/step
Epoch 13/50
385/385 - 12s - loss: 12.2671 - accuracy10: 0.4912 - accuracy20: 0.4922 - accuracy30: 0.4859 - accuracy50: 0.4713 - val_loss: 12.6601 - val_accuracy10: 0.4615 - val_accuracy20: 0.4569 - val_accuracy30: 0.4490 - val_accuracy50: 0.4307 - 12s/epoch - 30ms/step
Epoch 14/50
385/385 - 11s - loss: 12.2207 - accuracy10: 0.4949 - accuracy20: 0.4951 - accuracy30: 0.4910 - accuracy50: 0.4769 - val_loss: 12.6882 - val_accuracy10: 0.4575 - val_accuracy20: 0.4520 - val_accuracy30: 0.4457 - val_accuracy50: 0.4306 - 11s/epoch - 29ms/step
Epoch 15/50
385/385 - 12s - loss: 12.1776 - accuracy10: 0.4992 - accuracy20: 0.4997 - accuracy30: 0.4954 - accuracy50: 0.4828 - val_loss: 12.6949 - val_accuracy10: 0.4561 - val_accuracy20: 0.4515 - val_accuracy30: 0.4438 - val_accuracy50: 0.4281 - 12s/epoch - 30ms/step
Epoch 16/50
385/385 - 12s - loss: 12.1400 - accuracy10: 0.4997 - accuracy20: 0.5022 - accuracy30: 0.4983 - accuracy50: 0.4843 - val_loss: 12.7238 - val_accuracy10: 0.4563 - val_accuracy20: 0.4492 - val_accuracy30: 0.4416 - val_accuracy50: 0.4271 - 12s/epoch - 30ms/step
Epoch 17/50
385/385 - 12s - loss: 12.1003 - accuracy10: 0.5019 - accuracy20: 0.5051 - accuracy30: 0.5023 - accuracy50: 0.4899 - val_loss: 12.7121 - val_accuracy10: 0.4552 - val_accuracy20: 0.4505 - val_accuracy30: 0.4465 - val_accuracy50: 0.4278 - 12s/epoch - 30ms/step
Epoch 18/50
385/385 - 12s - loss: 12.0701 - accuracy10: 0.5022 - accuracy20: 0.5074 - accuracy30: 0.5051 - accuracy50: 0.4917 - val_loss: 12.7785 - val_accuracy10: 0.4552 - val_accuracy20: 0.4492 - val_accuracy30: 0.4437 - val_accuracy50: 0.4239 - 12s/epoch - 30ms/step
Epoch 19/50
385/385 - 11s - loss: 12.0390 - accuracy10: 0.5047 - accuracy20: 0.5107 - accuracy30: 0.5083 - accuracy50: 0.4945 - val_loss: 12.8079 - val_accuracy10: 0.4497 - val_accuracy20: 0.4418 - val_accuracy30: 0.4360 - val_accuracy50: 0.4196 - 11s/epoch - 29ms/step
Epoch 20/50
385/385 - 11s - loss: 12.0059 - accuracy10: 0.5069 - accuracy20: 0.5149 - accuracy30: 0.5130 - accuracy50: 0.4988 - val_loss: 12.8591 - val_accuracy10: 0.4508 - val_accuracy20: 0.4456 - val_accuracy30: 0.4374 - val_accuracy50: 0.4191 - 11s/epoch - 30ms/step
testing model: results/CHTR/W3/deepOF_L2/seq2seq
Evaluating performance on  test set...
1140/1140 - 12s - 12s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0580618
{'0': {'precision': 0.45200973367061337, 'recall': 0.45543086405395977, 'f1-score': 0.45371384988197355, 'support': 103188}, '1': {'precision': 0.45658835546475995, 'recall': 0.3667448055407565, 'f1-score': 0.40676463810249774, 'support': 93850}, '2': {'precision': 0.4284047073916026, 'recall': 0.5085287057305712, 'f1-score': 0.4650407133048372, 'support': 94563}, 'accuracy': 0.4441068446267331, 'macro avg': {'precision': 0.4456675988423253, 'recall': 0.44356812510842913, 'f1-score': 0.44183973376310287, 'support': 291601}, 'weighted avg': {'precision': 0.44582848448202544, 'recall': 0.4441068446267331, 'f1-score': 0.44227671029861293, 'support': 291601}}
[[46995 23557 32636]
 [27906 34419 31525]
 [29068 17407 48088]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.057086
{'0': {'precision': 0.4327222543406501, 'recall': 0.47106473257336595, 'f1-score': 0.45108016816116253, 'support': 98513}, '1': {'precision': 0.48326543538658645, 'recall': 0.34380312557606046, 'f1-score': 0.40177604375482456, 'support': 97646}, '2': {'precision': 0.434782230268426, 'recall': 0.5233859307223235, 'f1-score': 0.4749874009908051, 'support': 95442}, 'accuracy': 0.4455746036536226, 'macro avg': {'precision': 0.45025663999855414, 'recall': 0.44608459629058334, 'f1-score': 0.4426145376355974, 'support': 291601}, 'weighted avg': {'precision': 0.4503214658622508, 'recall': 0.4455746036536226, 'f1-score': 0.44239502505104106, 'support': 291601}}
[[46406 20111 31996]
 [31132 33571 32943]
 [29704 15785 49953]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0610125
{'0': {'precision': 0.41896125007991086, 'recall': 0.4768264923240029, 'f1-score': 0.44602490933662603, 'support': 96209}, '1': {'precision': 0.4904257922427505, 'recall': 0.3225663672303313, 'f1-score': 0.38916701558925443, 'support': 99409}, '2': {'precision': 0.436223440712817, 'recall': 0.5304689372076306, 'f1-score': 0.47875206273536347, 'support': 95983}, 'accuracy': 0.4418949180558366, 'macro avg': {'precision': 0.44853682767849273, 'recall': 0.4432872655873216, 'f1-score': 0.43798132922041466, 'support': 291601}, 'weighted avg': {'precision': 0.4490060562204383, 'recall': 0.4418949180558366, 'f1-score': 0.4374140472515802, 'support': 291601}}
[[45875 18410 31924]
 [33463 32066 33880]
 [30159 14908 50916]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0727521
{'0': {'precision': 0.40464445145871847, 'recall': 0.47668069012408637, 'f1-score': 0.4377185836995703, 'support': 94128}, '1': {'precision': 0.47536730178437836, 'recall': 0.29499970365687417, 'f1-score': 0.3640685859183089, 'support': 101234}, '2': {'precision': 0.42506340495194794, 'recall': 0.5207036648344227, 'f1-score': 0.46804774624997664, 'support': 96239}, 'accuracy': 0.42813639185050806, 'macro avg': {'precision': 0.4350250527316816, 'recall': 0.43079468620512773, 'f1-score': 0.42327830528928523, 'support': 291601}, 'weighted avg': {'precision': 0.43593603377531814, 'recall': 0.42813639185050806, 'f1-score': 0.42215953005880896, 'support': 291601}}
[[44869 17999 31260]
 [34849 29864 36521]
 [31167 14960 50112]]
Evaluating performance on  train set...
385/385 - 4s - 4s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0226443
{'0': {'precision': 0.4895261845386534, 'recall': 0.4144847972972973, 'f1-score': 0.44889092156414356, 'support': 33152}, '1': {'precision': 0.5199311111908436, 'recall': 0.44649514712679095, 'f1-score': 0.4804230348440142, 'support': 32455}, '2': {'precision': 0.44899592720766535, 'recall': 0.5812684770351406, 'f1-score': 0.5066411645946234, 'support': 32811}, 'accuracy': 0.4806437846735353, 'macro avg': {'precision': 0.4861510743123874, 'recall': 0.4807494738197429, 'f1-score': 0.4786517070009271, 'support': 98418}, 'weighted avg': {'precision': 0.48604057846262844, 'recall': 0.4806437846735353, 'f1-score': 0.4785421841438675, 'support': 98418}}
[[13741  7378 12033]
 [ 6592 14491 11372]
 [ 7737  6002 19072]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.027903
{'0': {'precision': 0.49203084832904886, 'recall': 0.4274356836588852, 'f1-score': 0.4574642680731051, 'support': 33584}, '1': {'precision': 0.5232011804449967, 'recall': 0.4158641975308642, 'f1-score': 0.46339827695905633, 'support': 32400}, '2': {'precision': 0.4430213842262589, 'recall': 0.5940371215391256, 'f1-score': 0.5075338496391129, 'support': 32434}, 'accuracy': 0.4785303501392022, 'macro avg': {'precision': 0.4860844710001015, 'recall': 0.47911233424295835, 'f1-score': 0.47613213155709144, 'support': 98418}, 'weighted avg': {'precision': 0.48614113101968287, 'recall': 0.4785303501392022, 'f1-score': 0.47591839939478114, 'support': 98418}}
[[14355  6872 12357]
 [ 7060 13474 11866]
 [ 7760  5407 19267]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0367122
{'0': {'precision': 0.48801432313252213, 'recall': 0.43560224918614976, 'f1-score': 0.4603211834060452, 'support': 33790}, '1': {'precision': 0.5139250982826402, 'recall': 0.3846201492768435, 'f1-score': 0.43996882417543487, 'support': 32289}, '2': {'precision': 0.4359294203030028, 'recall': 0.5943597513837781, 'f1-score': 0.5029634572359383, 'support': 32339}, 'accuracy': 0.47104188258245444, 'macro avg': {'precision': 0.4792896139060551, 'recall': 0.4715273832822571, 'f1-score': 0.4677511549391395, 'support': 98418}, 'weighted avg': {'precision': 0.4794006482581936, 'recall': 0.47104188258245444, 'f1-score': 0.46765572755638085, 'support': 98418}}
[[14719  6518 12553]
 [ 7552 12419 12318]
 [ 7890  5228 19221]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0507826
{'0': {'precision': 0.47661151383155087, 'recall': 0.43653794622919584, 'f1-score': 0.4556954156954157, 'support': 33587}, '1': {'precision': 0.4942667993596123, 'recall': 0.3510664453869322, 'f1-score': 0.41053747596542617, 'support': 32538}, '2': {'precision': 0.4264996408045977, 'recall': 0.5883008701576193, 'f1-score': 0.49450134700730114, 'support': 32293}, 'accuracy': 0.45807677457375684, 'macro avg': {'precision': 0.4657926513319202, 'recall': 0.45863508725791585, 'f1-score': 0.45357807955604773, 'support': 98418}, 'weighted avg': {'precision': 0.4660057807832535, 'recall': 0.45807677457375684, 'f1-score': 0.45349877378966996, 'support': 98418}}
[[14662  6380 12545]
 [ 8114 11423 13001]
 [ 7987  5308 18998]]
Evaluating performance on  val set...
139/139 - 2s - 2s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0411793
{'0': {'precision': 0.46766476308072236, 'recall': 0.48003802281368824, 'f1-score': 0.47377061996716446, 'support': 12624}, '1': {'precision': 0.5044523119836928, 'recall': 0.41274578651685395, 'f1-score': 0.45401438709988895, 'support': 11392}, '2': {'precision': 0.43660250534677664, 'recall': 0.5033905768383972, 'f1-score': 0.4676238393258886, 'support': 11355}, 'accuracy': 0.4658618642390659, 'macro avg': {'precision': 0.4695731934703973, 'recall': 0.4653914620563131, 'f1-score': 0.46513628213098074, 'support': 35371}, 'weighted avg': {'precision': 0.4695412104679516, 'recall': 0.4658618642390659, 'f1-score': 0.46543442084908215, 'support': 35371}}
[[6060 2584 3980]
 [3294 4702 3396]
 [3604 2035 5716]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0461721
{'0': {'precision': 0.45287665099619434, 'recall': 0.48908050608429365, 'f1-score': 0.4702828361100349, 'support': 12409}, '1': {'precision': 0.5161552766155276, 'recall': 0.3785373337879304, 'f1-score': 0.4367623918174665, 'support': 11732}, '2': {'precision': 0.4295974861589107, 'recall': 0.5113089937666964, 'f1-score': 0.4669051878354204, 'support': 11230}, 'accuracy': 0.4594724491815329, 'macro avg': {'precision': 0.46620980459021083, 'recall': 0.4596422778796401, 'f1-score': 0.45798347192097394, 'support': 35371}, 'weighted avg': {'precision': 0.4664742256942047, 'recall': 0.4594724491815329, 'f1-score': 0.4580922607074641, 'support': 35371}}
[[6069 2336 4004]
 [3671 4441 3620]
 [3661 1827 5742]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0515286
{'0': {'precision': 0.44509260609596035, 'recall': 0.49417098445595853, 'f1-score': 0.46834957415790684, 'support': 12352}, '1': {'precision': 0.5139705882352941, 'recall': 0.35395392016203897, 'f1-score': 0.4192113548902993, 'support': 11849}, '2': {'precision': 0.42157516485144847, 'recall': 0.5094001790510295, 'f1-score': 0.461345116957879, 'support': 11170}, 'accuracy': 0.452008707698397, 'macro avg': {'precision': 0.4602127863942343, 'recall': 0.452508361223009, 'f1-score': 0.44963534866869503, 'support': 35371}, 'weighted avg': {'precision': 0.46073947476429794, 'recall': 0.452008707698397, 'f1-score': 0.44967669108911623, 'support': 35371}}
[[6104 2237 4011]
 [3859 4194 3796]
 [3751 1729 5690]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0676223
{'0': {'precision': 0.42907647907647906, 'recall': 0.49091959716031036, 'f1-score': 0.45791945791945793, 'support': 12114}, '1': {'precision': 0.4935611373199031, 'recall': 0.31695734053877017, 'f1-score': 0.3860191463901077, 'support': 12213}, '2': {'precision': 0.4064969271290606, 'recall': 0.5030785947120608, 'f1-score': 0.4496600841696342, 'support': 11044}, 'accuracy': 0.4346498544004976, 'macro avg': {'precision': 0.44304484784181425, 'recall': 0.4369851774703804, 'f1-score': 0.4311995628263999, 'support': 35371}, 'weighted avg': {'precision': 0.44429184079708767, 'recall': 0.4346498544004976, 'f1-score': 0.4305146622280439, 'support': 35371}}
[[5947 2230 3937]
 [4167 3871 4175]
 [3746 1742 5556]]
training model: results/CHTR/W3/deepVOL_L2/seq2seq
Epoch 1/50
385/385 - 16s - loss: 13.2553 - accuracy10: 0.3586 - accuracy20: 0.3570 - accuracy30: 0.3565 - accuracy50: 0.3519 - val_loss: 13.3588 - val_accuracy10: 0.3358 - val_accuracy20: 0.3384 - val_accuracy30: 0.3381 - val_accuracy50: 0.3363 - 16s/epoch - 42ms/step
Epoch 2/50
385/385 - 11s - loss: 13.1557 - accuracy10: 0.3695 - accuracy20: 0.3691 - accuracy30: 0.3661 - accuracy50: 0.3604 - val_loss: 13.4115 - val_accuracy10: 0.3331 - val_accuracy20: 0.3380 - val_accuracy30: 0.3408 - val_accuracy50: 0.3426 - 11s/epoch - 29ms/step
Epoch 3/50
385/385 - 12s - loss: 13.1217 - accuracy10: 0.3755 - accuracy20: 0.3746 - accuracy30: 0.3698 - accuracy50: 0.3630 - val_loss: 13.2799 - val_accuracy10: 0.3446 - val_accuracy20: 0.3480 - val_accuracy30: 0.3485 - val_accuracy50: 0.3474 - 12s/epoch - 30ms/step
Epoch 4/50
385/385 - 11s - loss: 13.0748 - accuracy10: 0.3845 - accuracy20: 0.3820 - accuracy30: 0.3785 - accuracy50: 0.3706 - val_loss: 13.2611 - val_accuracy10: 0.3572 - val_accuracy20: 0.3575 - val_accuracy30: 0.3548 - val_accuracy50: 0.3515 - 11s/epoch - 29ms/step
Epoch 5/50
385/385 - 11s - loss: 13.0397 - accuracy10: 0.3913 - accuracy20: 0.3878 - accuracy30: 0.3825 - accuracy50: 0.3737 - val_loss: 13.1204 - val_accuracy10: 0.3773 - val_accuracy20: 0.3784 - val_accuracy30: 0.3726 - val_accuracy50: 0.3641 - 11s/epoch - 29ms/step
Epoch 6/50
385/385 - 11s - loss: 13.0180 - accuracy10: 0.3939 - accuracy20: 0.3918 - accuracy30: 0.3873 - accuracy50: 0.3773 - val_loss: 13.1151 - val_accuracy10: 0.3818 - val_accuracy20: 0.3827 - val_accuracy30: 0.3769 - val_accuracy50: 0.3658 - 11s/epoch - 29ms/step
Epoch 7/50
385/385 - 11s - loss: 12.9895 - accuracy10: 0.3991 - accuracy20: 0.3954 - accuracy30: 0.3883 - accuracy50: 0.3778 - val_loss: 13.0831 - val_accuracy10: 0.3842 - val_accuracy20: 0.3820 - val_accuracy30: 0.3759 - val_accuracy50: 0.3653 - 11s/epoch - 29ms/step
Epoch 8/50
385/385 - 12s - loss: 12.9770 - accuracy10: 0.3999 - accuracy20: 0.3975 - accuracy30: 0.3916 - accuracy50: 0.3797 - val_loss: 13.0821 - val_accuracy10: 0.3876 - val_accuracy20: 0.3881 - val_accuracy30: 0.3784 - val_accuracy50: 0.3649 - 12s/epoch - 30ms/step
Epoch 9/50
385/385 - 12s - loss: 12.9483 - accuracy10: 0.4058 - accuracy20: 0.4016 - accuracy30: 0.3955 - accuracy50: 0.3837 - val_loss: 13.0608 - val_accuracy10: 0.3901 - val_accuracy20: 0.3896 - val_accuracy30: 0.3820 - val_accuracy50: 0.3669 - 12s/epoch - 30ms/step
Epoch 10/50
385/385 - 11s - loss: 12.9264 - accuracy10: 0.4060 - accuracy20: 0.4044 - accuracy30: 0.3986 - accuracy50: 0.3852 - val_loss: 13.0379 - val_accuracy10: 0.3918 - val_accuracy20: 0.3918 - val_accuracy30: 0.3844 - val_accuracy50: 0.3698 - 11s/epoch - 28ms/step
Epoch 11/50
385/385 - 11s - loss: 12.9017 - accuracy10: 0.4109 - accuracy20: 0.4093 - accuracy30: 0.4013 - accuracy50: 0.3890 - val_loss: 13.0438 - val_accuracy10: 0.3934 - val_accuracy20: 0.3957 - val_accuracy30: 0.3855 - val_accuracy50: 0.3754 - 11s/epoch - 28ms/step
Epoch 12/50
385/385 - 11s - loss: 12.8811 - accuracy10: 0.4141 - accuracy20: 0.4130 - accuracy30: 0.4068 - accuracy50: 0.3919 - val_loss: 13.0164 - val_accuracy10: 0.3960 - val_accuracy20: 0.3976 - val_accuracy30: 0.3892 - val_accuracy50: 0.3768 - 11s/epoch - 29ms/step
Epoch 13/50
385/385 - 11s - loss: 12.8571 - accuracy10: 0.4168 - accuracy20: 0.4158 - accuracy30: 0.4091 - accuracy50: 0.3953 - val_loss: 13.0079 - val_accuracy10: 0.3990 - val_accuracy20: 0.3994 - val_accuracy30: 0.3931 - val_accuracy50: 0.3780 - 11s/epoch - 29ms/step
Epoch 14/50
385/385 - 11s - loss: 12.8377 - accuracy10: 0.4185 - accuracy20: 0.4184 - accuracy30: 0.4115 - accuracy50: 0.3979 - val_loss: 13.0139 - val_accuracy10: 0.3968 - val_accuracy20: 0.3981 - val_accuracy30: 0.3913 - val_accuracy50: 0.3806 - 11s/epoch - 29ms/step
Epoch 15/50
385/385 - 11s - loss: 12.8204 - accuracy10: 0.4220 - accuracy20: 0.4211 - accuracy30: 0.4137 - accuracy50: 0.3983 - val_loss: 13.0052 - val_accuracy10: 0.3965 - val_accuracy20: 0.3978 - val_accuracy30: 0.3936 - val_accuracy50: 0.3816 - 11s/epoch - 29ms/step
Epoch 16/50
385/385 - 11s - loss: 12.8017 - accuracy10: 0.4228 - accuracy20: 0.4228 - accuracy30: 0.4175 - accuracy50: 0.4026 - val_loss: 13.0455 - val_accuracy10: 0.3990 - val_accuracy20: 0.4005 - val_accuracy30: 0.3943 - val_accuracy50: 0.3807 - 11s/epoch - 30ms/step
Epoch 17/50
385/385 - 11s - loss: 12.7793 - accuracy10: 0.4245 - accuracy20: 0.4242 - accuracy30: 0.4208 - accuracy50: 0.4071 - val_loss: 13.0422 - val_accuracy10: 0.3961 - val_accuracy20: 0.3986 - val_accuracy30: 0.3937 - val_accuracy50: 0.3825 - 11s/epoch - 30ms/step
Epoch 18/50
385/385 - 11s - loss: 12.7713 - accuracy10: 0.4268 - accuracy20: 0.4274 - accuracy30: 0.4214 - accuracy50: 0.4075 - val_loss: 13.0555 - val_accuracy10: 0.3979 - val_accuracy20: 0.3981 - val_accuracy30: 0.3906 - val_accuracy50: 0.3795 - 11s/epoch - 30ms/step
Epoch 19/50
385/385 - 11s - loss: 12.7665 - accuracy10: 0.4266 - accuracy20: 0.4267 - accuracy30: 0.4217 - accuracy50: 0.4081 - val_loss: 13.0394 - val_accuracy10: 0.3980 - val_accuracy20: 0.3996 - val_accuracy30: 0.3922 - val_accuracy50: 0.3797 - 11s/epoch - 29ms/step
Epoch 20/50
385/385 - 11s - loss: 12.7456 - accuracy10: 0.4296 - accuracy20: 0.4307 - accuracy30: 0.4247 - accuracy50: 0.4101 - val_loss: 13.0233 - val_accuracy10: 0.4003 - val_accuracy20: 0.4020 - val_accuracy30: 0.3944 - val_accuracy50: 0.3825 - 11s/epoch - 29ms/step
Epoch 21/50
385/385 - 12s - loss: 12.7244 - accuracy10: 0.4319 - accuracy20: 0.4337 - accuracy30: 0.4277 - accuracy50: 0.4155 - val_loss: 13.0363 - val_accuracy10: 0.4015 - val_accuracy20: 0.4021 - val_accuracy30: 0.3958 - val_accuracy50: 0.3838 - 12s/epoch - 30ms/step
Epoch 22/50
385/385 - 11s - loss: 12.6971 - accuracy10: 0.4343 - accuracy20: 0.4364 - accuracy30: 0.4311 - accuracy50: 0.4176 - val_loss: 13.0692 - val_accuracy10: 0.4016 - val_accuracy20: 0.3996 - val_accuracy30: 0.3942 - val_accuracy50: 0.3826 - 11s/epoch - 30ms/step
Epoch 23/50
385/385 - 11s - loss: 12.6885 - accuracy10: 0.4350 - accuracy20: 0.4364 - accuracy30: 0.4305 - accuracy50: 0.4176 - val_loss: 13.0640 - val_accuracy10: 0.3978 - val_accuracy20: 0.4000 - val_accuracy30: 0.3959 - val_accuracy50: 0.3821 - 11s/epoch - 29ms/step
Epoch 24/50
385/385 - 11s - loss: 12.6746 - accuracy10: 0.4357 - accuracy20: 0.4373 - accuracy30: 0.4321 - accuracy50: 0.4197 - val_loss: 13.0534 - val_accuracy10: 0.3999 - val_accuracy20: 0.4008 - val_accuracy30: 0.3963 - val_accuracy50: 0.3829 - 11s/epoch - 29ms/step
Epoch 25/50
385/385 - 11s - loss: 12.6580 - accuracy10: 0.4383 - accuracy20: 0.4408 - accuracy30: 0.4352 - accuracy50: 0.4229 - val_loss: 13.0910 - val_accuracy10: 0.3988 - val_accuracy20: 0.4003 - val_accuracy30: 0.3927 - val_accuracy50: 0.3810 - 11s/epoch - 29ms/step
testing model: results/CHTR/W3/deepVOL_L2/seq2seq
Evaluating performance on  test set...
1140/1140 - 11s - 11s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0855448
{'0': {'precision': 0.4474691274257023, 'recall': 0.15977478219577668, 'f1-score': 0.23547138552065924, 'support': 103189}, '1': {'precision': 0.38716402810816725, 'recall': 0.603499163567783, 'f1-score': 0.4717106057640656, 'support': 93851}, '2': {'precision': 0.39897481284802894, 'recall': 0.45763231639612967, 'f1-score': 0.42629523279466885, 'support': 94565}, 'accuracy': 0.3991769688448415, 'macro avg': {'precision': 0.41120265612729945, 'recall': 0.4069687540532298, 'f1-score': 0.3778257413597979, 'support': 291605}, 'weighted avg': {'precision': 0.412334068925033, 'recall': 0.3991769688448415, 'f1-score': 0.37338583889604937, 'support': 291605}}
[[16487 49960 36742]
 [ 8762 56639 28450]
 [11596 39693 43276]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0807487
{'0': {'precision': 0.4284948158741509, 'recall': 0.17032096960838053, 'f1-score': 0.24375326863850308, 'support': 98514}, '1': {'precision': 0.400273169164022, 'recall': 0.6122461519555132, 'f1-score': 0.484071172648327, 'support': 97647}, '2': {'precision': 0.4074246524847462, 'recall': 0.44005909224257156, 'f1-score': 0.42311353779976124, 'support': 95444}, 'accuracy': 0.4065911078342278, 'macro avg': {'precision': 0.4120642125076397, 'recall': 0.4075420712688218, 'f1-score': 0.38364599302886376, 'support': 291605}, 'weighted avg': {'precision': 0.41214811464871826, 'recall': 0.4065911078342278, 'f1-score': 0.3829318969290824, 'support': 291605}}
[[16779 48645 33090]
 [ 9865 59784 27998]
 [12514 40929 42001]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0822201
{'0': {'precision': 0.407034211410201, 'recall': 0.1763434154453799, 'f1-score': 0.246076639689032, 'support': 96210}, '1': {'precision': 0.4005543259625023, 'recall': 0.5989538275827382, 'f1-score': 0.4800632107684059, 'support': 99410}, '2': {'precision': 0.404802812172917, 'recall': 0.42710840235453457, 'f1-score': 0.41565657333759165, 'support': 95985}, 'accuracy': 0.40295605356561104, 'macro avg': {'precision': 0.4041304498485401, 'recall': 0.40080188179421755, 'f1-score': 0.3805988079316765, 'support': 291605}, 'weighted avg': {'precision': 0.4040906875743737, 'recall': 0.40295605356561104, 'f1-score': 0.38166325501544124, 'support': 291605}}
[[16966 47479 31765]
 [11355 59542 28513]
 [13361 41628 40996]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0879719
{'0': {'precision': 0.38240630810241705, 'recall': 0.1813574987517131, 'f1-score': 0.24603300425163938, 'support': 94129}, '1': {'precision': 0.39594594594594595, 'recall': 0.5730626759519929, 'f1-score': 0.4683174910698069, 'support': 101235}, '2': {'precision': 0.3934928915614671, 'recall': 0.4106773620390478, 'f1-score': 0.4019015176551339, 'support': 96241}, 'accuracy': 0.3930282402565114, 'macro avg': {'precision': 0.39061504853661, 'recall': 0.38836584558091797, 'f1-score': 0.37208400432552674, 'support': 291605}, 'weighted avg': {'precision': 0.39076579822011764, 'recall': 0.3930282402565114, 'f1-score': 0.37464503635500834, 'support': 291605}}
[[17071 46485 30573]
 [12874 58014 30347]
 [14696 42021 39524]]
Evaluating performance on  train set...
385/385 - 4s - 4s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0678262
{'0': {'precision': 0.46815459989112684, 'recall': 0.15602322206095792, 'f1-score': 0.23404544836032112, 'support': 33072}, '1': {'precision': 0.4149713765029812, 'recall': 0.6456573999876718, 'f1-score': 0.5052273631660817, 'support': 32446}, '2': {'precision': 0.40960069350381967, 'recall': 0.45956049968086077, 'f1-score': 0.43314473966912553, 'support': 32901}, 'accuracy': 0.41891301476340953, 'macro avg': {'precision': 0.4309088899659759, 'recall': 0.4204137072431635, 'f1-score': 0.39080585039850946, 'support': 98419}, 'weighted avg': {'precision': 0.43104728382308544, 'recall': 0.41891301476340953, 'f1-score': 0.39000450292436556, 'support': 98419}}
[[ 5160 15167 12745]
 [ 2448 20949  9049]
 [ 3414 14367 15120]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.069257
{'0': {'precision': 0.4681845212811146, 'recall': 0.16434066917158704, 'f1-score': 0.2432844056947357, 'support': 33534}, '1': {'precision': 0.409304939252427, 'recall': 0.6510803563172333, 'f1-score': 0.5026293872694825, 'support': 32443}, '2': {'precision': 0.40281384663679687, 'recall': 0.4350841501756982, 'f1-score': 0.41832757879762306, 'support': 32442}, 'accuracy': 0.41403590770074883, 'macro avg': {'precision': 0.4267677690567795, 'recall': 0.4168350585548395, 'f1-score': 0.3880804572539471, 'support': 98419}, 'weighted avg': {'precision': 0.4272271278248951, 'recall': 0.41403590770074883, 'f1-score': 0.38647504834537616, 'support': 98419}}
[[ 5511 15794 12229]
 [ 2623 21123  8697]
 [ 3637 14690 14115]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0749952
{'0': {'precision': 0.4561417447958049, 'recall': 0.1704926795949277, 'f1-score': 0.24821115890961762, 'support': 33673}, '1': {'precision': 0.4016522499757022, 'recall': 0.6383971328822566, 'f1-score': 0.49307974991647974, 'support': 32367}, '2': {'precision': 0.39723159241595907, 'recall': 0.4218783779610241, 'f1-score': 0.40918417781239236, 'support': 32379}, 'accuracy': 0.4070758694967435, 'macro avg': {'precision': 0.418341862395822, 'recall': 0.41025606347940285, 'f1-score': 0.3834916955461633, 'support': 98419}, 'weighted avg': {'precision': 0.41884088517775053, 'recall': 0.4070758694967435, 'f1-score': 0.38169968311908986, 'support': 98419}}
[[ 5741 15915 12017]
 [ 2993 20663  8711]
 [ 3852 14867 13660]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0843774
{'0': {'precision': 0.4350741264992923, 'recall': 0.17352032327073924, 'f1-score': 0.24809362985619918, 'support': 33656}, '1': {'precision': 0.3878925091052269, 'recall': 0.6074985354422964, 'f1-score': 0.4734704666698707, 'support': 32433}, '2': {'precision': 0.3830589748837753, 'recall': 0.40522734302505414, 'f1-score': 0.393831446994634, 'support': 32330}, 'accuracy': 0.39264776110303906, 'macro avg': {'precision': 0.4020085368294315, 'recall': 0.39541540057936325, 'f1-score': 0.3717985145069013, 'support': 98419}, 'weighted avg': {'precision': 0.40243925672138975, 'recall': 0.39264776110303906, 'f1-score': 0.37023824193784405, 'support': 98419}}
[[ 5840 15972 11844]
 [ 3474 19703  9256]
 [ 4109 15120 13101]]
Evaluating performance on  val set...
139/139 - 2s - 2s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.083225
{'0': {'precision': 0.4353223868642371, 'recall': 0.17306161439261264, 'f1-score': 0.2476646160856687, 'support': 12562}, '1': {'precision': 0.3892334831844307, 'recall': 0.5952484553128535, 'f1-score': 0.47068538398018167, 'support': 11491}, '2': {'precision': 0.39472039987503904, 'recall': 0.4465453260293338, 'f1-score': 0.4190365641323273, 'support': 11318}, 'accuracy': 0.3977269514574086, 'macro avg': {'precision': 0.40642542330790227, 'recall': 0.40495179857826663, 'f1-score': 0.3791288547327259, 'support': 35371}, 'weighted avg': {'precision': 0.407357645100408, 'recall': 0.3977269514574086, 'f1-score': 0.3749530544071165, 'support': 35371}}
[[2174 5926 4462]
 [1363 6840 3288]
 [1457 4807 5054]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0806954
{'0': {'precision': 0.4237481031866464, 'recall': 0.17994361659283126, 'f1-score': 0.2526149149092554, 'support': 12415}, '1': {'precision': 0.39341247283063036, 'recall': 0.6019442312611921, 'f1-score': 0.47583417593528815, 'support': 11727}, '2': {'precision': 0.39972030273116155, 'recall': 0.4327188529699884, 'f1-score': 0.41556553346162073, 'support': 11229}, 'accuracy': 0.40010177829295185, 'macro avg': {'precision': 0.40562695958281275, 'recall': 0.4048689002746706, 'f1-score': 0.3813382081020548, 'support': 35371}, 'weighted avg': {'precision': 0.4060625950443931, 'recall': 0.40010177829295185, 'f1-score': 0.3783525183068635, 'support': 35371}}
[[2234 6015 4166]
 [1537 7059 3131]
 [1501 4869 4859]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0845053
{'0': {'precision': 0.4171285535490792, 'recall': 0.1895515112122197, 'f1-score': 0.26065582928328024, 'support': 12308}, '1': {'precision': 0.3924114671163575, 'recall': 0.5858509566968781, 'f1-score': 0.470006059381943, 'support': 11916}, '2': {'precision': 0.3913913913913914, 'recall': 0.4209204270207231, 'f1-score': 0.40561919170088606, 'support': 11147}, 'accuracy': 0.3959741030787934, 'macro avg': {'precision': 0.4003104706856093, 'recall': 0.39877429830994027, 'f1-score': 0.3787603601220364, 'support': 35371}, 'weighted avg': {'precision': 0.4006907669865263, 'recall': 0.3959741030787934, 'f1-score': 0.37686752651334776, 'support': 35371}}
[[2333 5943 4032]
 [1671 6981 3264]
 [1589 4866 4692]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0911407
{'0': {'precision': 0.3889168765743073, 'recall': 0.19066436157075822, 'f1-score': 0.25588332780908185, 'support': 12147}, '1': {'precision': 0.3901378639665923, 'recall': 0.559016393442623, 'f1-score': 0.45955324955358645, 'support': 12200}, '2': {'precision': 0.3711772098868873, 'recall': 0.4018505079825834, 'f1-score': 0.385905309464698, 'support': 11024}, 'accuracy': 0.3835345339402335, 'macro avg': {'precision': 0.3834106501425956, 'recall': 0.3838437543319882, 'f1-score': 0.3671139622757888, 'support': 35371}, 'weighted avg': {'precision': 0.38380913182928333, 'recall': 0.3835345339402335, 'f1-score': 0.36665586381469284, 'support': 35371}}
[[2316 5788 4043]
 [1918 6820 3462]
 [1721 4873 4430]]
training model: results/CHTR/W3/deepVOL_L3/seq2seq
Epoch 1/50
385/385 - 22s - loss: 13.2467 - accuracy10: 0.3556 - accuracy20: 0.3541 - accuracy30: 0.3533 - accuracy50: 0.3541 - val_loss: 13.4582 - val_accuracy10: 0.3247 - val_accuracy20: 0.3313 - val_accuracy30: 0.3369 - val_accuracy50: 0.3449 - 22s/epoch - 57ms/step
Epoch 2/50
385/385 - 17s - loss: 13.1911 - accuracy10: 0.3594 - accuracy20: 0.3589 - accuracy30: 0.3555 - accuracy50: 0.3550 - val_loss: 13.5047 - val_accuracy10: 0.3246 - val_accuracy20: 0.3312 - val_accuracy30: 0.3368 - val_accuracy50: 0.3450 - 17s/epoch - 44ms/step
Epoch 3/50
385/385 - 17s - loss: 13.1843 - accuracy10: 0.3590 - accuracy20: 0.3564 - accuracy30: 0.3546 - accuracy50: 0.3504 - val_loss: 13.1770 - val_accuracy10: 0.3427 - val_accuracy20: 0.3427 - val_accuracy30: 0.3420 - val_accuracy50: 0.3416 - 17s/epoch - 43ms/step
Epoch 4/50
385/385 - 16s - loss: 13.1427 - accuracy10: 0.3666 - accuracy20: 0.3609 - accuracy30: 0.3587 - accuracy50: 0.3540 - val_loss: 13.1773 - val_accuracy10: 0.3542 - val_accuracy20: 0.3503 - val_accuracy30: 0.3401 - val_accuracy50: 0.3319 - 16s/epoch - 42ms/step
Epoch 5/50
385/385 - 16s - loss: 13.1095 - accuracy10: 0.3757 - accuracy20: 0.3718 - accuracy30: 0.3681 - accuracy50: 0.3621 - val_loss: 13.1287 - val_accuracy10: 0.3647 - val_accuracy20: 0.3659 - val_accuracy30: 0.3574 - val_accuracy50: 0.3479 - 16s/epoch - 43ms/step
Epoch 6/50
385/385 - 16s - loss: 13.0678 - accuracy10: 0.3840 - accuracy20: 0.3809 - accuracy30: 0.3755 - accuracy50: 0.3664 - val_loss: 13.1511 - val_accuracy10: 0.3641 - val_accuracy20: 0.3622 - val_accuracy30: 0.3547 - val_accuracy50: 0.3493 - 16s/epoch - 42ms/step
Epoch 7/50
385/385 - 16s - loss: 13.0520 - accuracy10: 0.3893 - accuracy20: 0.3836 - accuracy30: 0.3776 - accuracy50: 0.3675 - val_loss: 13.1052 - val_accuracy10: 0.3779 - val_accuracy20: 0.3710 - val_accuracy30: 0.3604 - val_accuracy50: 0.3461 - 16s/epoch - 43ms/step
Epoch 8/50
385/385 - 16s - loss: 13.0223 - accuracy10: 0.3936 - accuracy20: 0.3896 - accuracy30: 0.3847 - accuracy50: 0.3726 - val_loss: 13.1135 - val_accuracy10: 0.3719 - val_accuracy20: 0.3743 - val_accuracy30: 0.3659 - val_accuracy50: 0.3559 - 16s/epoch - 42ms/step
Epoch 9/50
385/385 - 16s - loss: 13.0130 - accuracy10: 0.3955 - accuracy20: 0.3924 - accuracy30: 0.3867 - accuracy50: 0.3751 - val_loss: 13.0684 - val_accuracy10: 0.3813 - val_accuracy20: 0.3787 - val_accuracy30: 0.3684 - val_accuracy50: 0.3521 - 16s/epoch - 42ms/step
Epoch 10/50
385/385 - 17s - loss: 12.9815 - accuracy10: 0.4014 - accuracy20: 0.3980 - accuracy30: 0.3890 - accuracy50: 0.3782 - val_loss: 13.0440 - val_accuracy10: 0.3886 - val_accuracy20: 0.3896 - val_accuracy30: 0.3793 - val_accuracy50: 0.3645 - 17s/epoch - 44ms/step
Epoch 11/50
385/385 - 16s - loss: 12.9517 - accuracy10: 0.4039 - accuracy20: 0.4010 - accuracy30: 0.3947 - accuracy50: 0.3811 - val_loss: 13.0388 - val_accuracy10: 0.3887 - val_accuracy20: 0.3876 - val_accuracy30: 0.3781 - val_accuracy50: 0.3673 - 16s/epoch - 43ms/step
Epoch 12/50
385/385 - 16s - loss: 12.9359 - accuracy10: 0.4095 - accuracy20: 0.4057 - accuracy30: 0.3979 - accuracy50: 0.3844 - val_loss: 13.0430 - val_accuracy10: 0.3879 - val_accuracy20: 0.3883 - val_accuracy30: 0.3785 - val_accuracy50: 0.3642 - 16s/epoch - 42ms/step
Epoch 13/50
385/385 - 16s - loss: 12.9108 - accuracy10: 0.4107 - accuracy20: 0.4079 - accuracy30: 0.3998 - accuracy50: 0.3864 - val_loss: 13.0403 - val_accuracy10: 0.3927 - val_accuracy20: 0.3926 - val_accuracy30: 0.3843 - val_accuracy50: 0.3699 - 16s/epoch - 42ms/step
Epoch 14/50
385/385 - 16s - loss: 12.8956 - accuracy10: 0.4131 - accuracy20: 0.4093 - accuracy30: 0.4022 - accuracy50: 0.3883 - val_loss: 13.0496 - val_accuracy10: 0.3903 - val_accuracy20: 0.3920 - val_accuracy30: 0.3826 - val_accuracy50: 0.3714 - 16s/epoch - 43ms/step
Epoch 15/50
385/385 - 16s - loss: 12.8715 - accuracy10: 0.4144 - accuracy20: 0.4132 - accuracy30: 0.4053 - accuracy50: 0.3909 - val_loss: 13.0522 - val_accuracy10: 0.3928 - val_accuracy20: 0.3924 - val_accuracy30: 0.3842 - val_accuracy50: 0.3723 - 16s/epoch - 42ms/step
Epoch 16/50
385/385 - 16s - loss: 12.8543 - accuracy10: 0.4169 - accuracy20: 0.4142 - accuracy30: 0.4081 - accuracy50: 0.3933 - val_loss: 13.0605 - val_accuracy10: 0.3938 - val_accuracy20: 0.3954 - val_accuracy30: 0.3851 - val_accuracy50: 0.3701 - 16s/epoch - 42ms/step
Epoch 17/50
385/385 - 16s - loss: 12.8480 - accuracy10: 0.4167 - accuracy20: 0.4149 - accuracy30: 0.4087 - accuracy50: 0.3943 - val_loss: 13.1047 - val_accuracy10: 0.3900 - val_accuracy20: 0.3899 - val_accuracy30: 0.3814 - val_accuracy50: 0.3697 - 16s/epoch - 42ms/step
Epoch 18/50
385/385 - 16s - loss: 12.8187 - accuracy10: 0.4189 - accuracy20: 0.4197 - accuracy30: 0.4128 - accuracy50: 0.3975 - val_loss: 13.1282 - val_accuracy10: 0.3916 - val_accuracy20: 0.3933 - val_accuracy30: 0.3839 - val_accuracy50: 0.3711 - 16s/epoch - 43ms/step
Epoch 19/50
385/385 - 16s - loss: 12.8089 - accuracy10: 0.4229 - accuracy20: 0.4204 - accuracy30: 0.4141 - accuracy50: 0.4006 - val_loss: 13.1052 - val_accuracy10: 0.3934 - val_accuracy20: 0.3952 - val_accuracy30: 0.3871 - val_accuracy50: 0.3730 - 16s/epoch - 42ms/step
Epoch 20/50
385/385 - 17s - loss: 12.7954 - accuracy10: 0.4210 - accuracy20: 0.4218 - accuracy30: 0.4168 - accuracy50: 0.4019 - val_loss: 13.1280 - val_accuracy10: 0.3919 - val_accuracy20: 0.3923 - val_accuracy30: 0.3875 - val_accuracy50: 0.3745 - 17s/epoch - 43ms/step
Epoch 21/50
385/385 - 16s - loss: 12.7829 - accuracy10: 0.4241 - accuracy20: 0.4229 - accuracy30: 0.4173 - accuracy50: 0.4018 - val_loss: 13.1098 - val_accuracy10: 0.3917 - val_accuracy20: 0.3941 - val_accuracy30: 0.3877 - val_accuracy50: 0.3727 - 16s/epoch - 42ms/step
testing model: results/CHTR/W3/deepVOL_L3/seq2seq
Evaluating performance on  test set...
1140/1140 - 21s - 21s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0847726
{'0': {'precision': 0.42647775534359117, 'recall': 0.11872389498880695, 'f1-score': 0.1857408179509533, 'support': 103189}, '1': {'precision': 0.3802785265049416, 'recall': 0.6133339016099988, 'f1-score': 0.4694742250804383, 'support': 93851}, '2': {'precision': 0.388454950632673, 'recall': 0.4580658806112198, 'f1-score': 0.42039829965643744, 'support': 94565}, 'accuracy': 0.387956310762847, 'macro avg': {'precision': 0.398403744160402, 'recall': 0.39670789240334187, 'f1-score': 0.35853778089594296, 'support': 291605}, 'weighted avg': {'precision': 0.39927839198142634, 'recall': 0.387956310762847, 'f1-score': 0.3531558099777992, 'support': 291605}}
[[12251 51341 39597]
 [ 7692 57562 28597]
 [ 8783 42465 43317]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0835801
{'0': {'precision': 0.41207429289328035, 'recall': 0.1231906125017764, 'f1-score': 0.1896768647677099, 'support': 98514}, '1': {'precision': 0.3921845731313037, 'recall': 0.6024967484920172, 'f1-score': 0.47510680050715104, 'support': 97647}, '2': {'precision': 0.3910721132839321, 'recall': 0.4594945727337496, 'f1-score': 0.42253127604329743, 'support': 95444}, 'accuracy': 0.3937655389996742, 'macro avg': {'precision': 0.3984436597695054, 'recall': 0.3950606445758478, 'f1-score': 0.3624383137727194, 'support': 291605}, 'weighted avg': {'precision': 0.3985398764867291, 'recall': 0.3937655389996742, 'f1-score': 0.3614706727097424, 'support': 291605}}
[[12136 48606 37772]
 [ 8300 58832 30515]
 [ 9015 42573 43856]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0864209
{'0': {'precision': 0.39203071844791, 'recall': 0.12097495062883276, 'f1-score': 0.18489424062145055, 'support': 96210}, '1': {'precision': 0.391068754254595, 'recall': 0.5778895483351776, 'f1-score': 0.4664690836750437, 'support': 99410}, '2': {'precision': 0.38466822007372886, 'recall': 0.4609366046778142, 'f1-score': 0.4193629414078606, 'support': 95985}, 'accuracy': 0.3886421700588124, 'macro avg': {'precision': 0.3892558975920779, 'recall': 0.3866003678806082, 'f1-score': 0.35690875523478494, 'support': 291605}, 'weighted avg': {'precision': 0.38927933123951775, 'recall': 0.3886421700588124, 'f1-score': 0.35806285361828283, 'support': 291605}}
[[11639 46896 37675]
 [ 8864 57448 33098]
 [ 9186 42556 44243]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0907328
{'0': {'precision': 0.3696446800803504, 'recall': 0.1192512403191365, 'f1-score': 0.18032707878164758, 'support': 94129}, '1': {'precision': 0.3864118595637536, 'recall': 0.5396750135822591, 'f1-score': 0.4503612600619067, 'support': 101235}, '2': {'precision': 0.3752357113057989, 'recall': 0.46728525264700077, 'f1-score': 0.4162320503861799, 'support': 96241}, 'accuracy': 0.3800723581557244, 'macro avg': {'precision': 0.37709741698330096, 'recall': 0.37540383551613216, 'f1-score': 0.348973463076578, 'support': 291605}, 'weighted avg': {'precision': 0.37731091300218206, 'recall': 0.3800723581557244, 'f1-score': 0.35193127183080253, 'support': 291605}}
[[11225 45158 37746]
 [ 9469 54634 37132]
 [ 9673 41596 44972]]
Evaluating performance on  train set...
385/385 - 7s - 7s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.073823
{'0': {'precision': 0.4372339053025416, 'recall': 0.10247339138848573, 'f1-score': 0.16603385346495847, 'support': 33072}, '1': {'precision': 0.4066851332007213, 'recall': 0.6742279479750971, 'f1-score': 0.5073460347646602, 'support': 32446}, '2': {'precision': 0.40266290641863495, 'recall': 0.45132366797361784, 'f1-score': 0.42560692481871076, 'support': 32901}, 'accuracy': 0.40758390148243734, 'macro avg': {'precision': 0.41552731497396594, 'recall': 0.4093416691124003, 'f1-score': 0.3663289376827765, 'support': 98419}, 'weighted avg': {'precision': 0.41560590772184, 'recall': 0.40758390148243734, 'f1-score': 0.3653289962225554, 'support': 98419}}
[[ 3389 16305 13378]
 [ 1920 21876  8650]
 [ 2442 15610 14849]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0780505
{'0': {'precision': 0.44083258383656687, 'recall': 0.10231406930279716, 'f1-score': 0.16608175811409345, 'support': 33534}, '1': {'precision': 0.39929527308168083, 'recall': 0.6566593718213483, 'f1-score': 0.49661410072613266, 'support': 32443}, '2': {'precision': 0.39160989217316666, 'recall': 0.45003390666420073, 'f1-score': 0.41879410246113247, 'support': 32442}, 'accuracy': 0.3996687631453276, 'macro avg': {'precision': 0.41057924969713816, 'recall': 0.4030024492627821, 'f1-score': 0.3604966537671195, 'support': 98419}, 'weighted avg': {'precision': 0.41091480845005823, 'recall': 0.3996687631453276, 'f1-score': 0.3583409221644194, 'support': 98419}}
[[ 3431 16538 13565]
 [ 2022 21304  9117]
 [ 2330 15512 14600]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.082285
{'0': {'precision': 0.4295810845540992, 'recall': 0.09927835357704987, 'f1-score': 0.1612833192618502, 'support': 33673}, '1': {'precision': 0.39260620680412767, 'recall': 0.6335774090895048, 'f1-score': 0.4847990543735225, 'support': 32367}, '2': {'precision': 0.3811582126861785, 'recall': 0.4520831403069891, 'f1-score': 0.4136021361061271, 'support': 32379}, 'accuracy': 0.39106270130767434, 'macro avg': {'precision': 0.4011151680148018, 'recall': 0.3949796343245146, 'f1-score': 0.35322816991383327, 'support': 98419}, 'weighted avg': {'precision': 0.4014904715998451, 'recall': 0.39106270130767434, 'f1-score': 0.35068846226229056, 'support': 98419}}
[[ 3343 16326 14004]
 [ 2098 20507  9762]
 [ 2341 15400 14638]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.088708
{'0': {'precision': 0.40380761523046094, 'recall': 0.095792726408367, 'f1-score': 0.1548511047070125, 'support': 33656}, '1': {'precision': 0.3793782445253297, 'recall': 0.5881047081676071, 'f1-score': 0.4612259702575264, 'support': 32433}, '2': {'precision': 0.3660042830818268, 'recall': 0.4546241880606248, 'f1-score': 0.40552919103851676, 'support': 32330}, 'accuracy': 0.3759030268545708, 'macro avg': {'precision': 0.3830633809458725, 'recall': 0.37950720754553297, 'f1-score': 0.34053542200101855, 'support': 98419}, 'weighted avg': {'precision': 0.38333901152137156, 'recall': 0.3759030268545708, 'f1-score': 0.33816000385755607, 'support': 98419}}
[[ 3224 16002 14430]
 [ 2329 19074 11030]
 [ 2431 15201 14698]]
Evaluating performance on  val set...
139/139 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.084997
{'0': {'precision': 0.4180569185475957, 'recall': 0.13564718993790797, 'f1-score': 0.20483231157591056, 'support': 12562}, '1': {'precision': 0.3817231495531951, 'recall': 0.5910712731703072, 'f1-score': 0.46387105586668487, 'support': 11491}, '2': {'precision': 0.3783143238038809, 'recall': 0.4513164870118396, 'f1-score': 0.4116035455278002, 'support': 11318}, 'accuracy': 0.3846088603658364, 'macro avg': {'precision': 0.3926981306348905, 'recall': 0.3926783167066849, 'f1-score': 0.3601023043234652, 'support': 35371}, 'weighted avg': {'precision': 0.3935363218207849, 'recall': 0.3846088603658364, 'f1-score': 0.355148984458011, 'support': 35371}}
[[1704 5949 4909]
 [1214 6792 3485]
 [1158 5052 5108]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0846384
{'0': {'precision': 0.4061978545887962, 'recall': 0.13725332259363673, 'f1-score': 0.20517760385310055, 'support': 12415}, '1': {'precision': 0.38776556359286896, 'recall': 0.5805406327278929, 'f1-score': 0.4649638027591859, 'support': 11727}, '2': {'precision': 0.3771936265511418, 'recall': 0.45747617775402977, 'f1-score': 0.4134739214423696, 'support': 11229}, 'accuracy': 0.3858810890277346, 'macro avg': {'precision': 0.39038568157760234, 'recall': 0.3917567110251865, 'f1-score': 0.36120510935155203, 'support': 35371}, 'weighted avg': {'precision': 0.3908789788673277, 'recall': 0.3858810890277346, 'f1-score': 0.35743431428768163, 'support': 35371}}
[[1704 5845 4866]
 [1303 6808 3616]
 [1188 4904 5137]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.089005
{'0': {'precision': 0.38456107319369265, 'recall': 0.1327591810204745, 'f1-score': 0.1973787521894063, 'support': 12308}, '1': {'precision': 0.38367680541771265, 'recall': 0.5515273581738839, 'f1-score': 0.45253916336718886, 'support': 11916}, '2': {'precision': 0.36589723433145144, 'recall': 0.45931640800215306, 'f1-score': 0.40731901352426414, 'support': 11147}, 'accuracy': 0.37674931441011, 'macro avg': {'precision': 0.37804503764761893, 'recall': 0.38120098239883715, 'f1-score': 0.3524123096936198, 'support': 35371}, 'weighted avg': {'precision': 0.37838135685499763, 'recall': 0.37674931441011, 'f1-score': 0.34950042114686064, 'support': 35371}}
[[1634 5758 4916]
 [1387 6572 3957]
 [1228 4799 5120]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0936939
{'0': {'precision': 0.36363636363636365, 'recall': 0.1297439697044538, 'f1-score': 0.1912505309143863, 'support': 12147}, '1': {'precision': 0.38161270616982285, 'recall': 0.5120491803278688, 'f1-score': 0.43731186559327967, 'support': 12200}, '2': {'precision': 0.3483329924319902, 'recall': 0.4634433962264151, 'f1-score': 0.3977268304075357, 'support': 11024}, 'accuracy': 0.3656102456814905, 'macro avg': {'precision': 0.36452735407939224, 'recall': 0.3684121820862459, 'f1-score': 0.34209640897173393, 'support': 35371}, 'weighted avg': {'precision': 0.3650671124065762, 'recall': 0.3656102456814905, 'f1-score': 0.3404728601868122, 'support': 35371}}
[[1576 5447 5124]
 [1519 6247 4434]
 [1239 4676 5109]]
training model: results/CHTR/W4/deepLOB_L1/seq2seq
Epoch 1/50
346/346 - 15s - loss: 13.1402 - accuracy10: 0.3811 - accuracy20: 0.3838 - accuracy30: 0.3852 - accuracy50: 0.3805 - val_loss: 13.2242 - val_accuracy10: 0.3637 - val_accuracy20: 0.3560 - val_accuracy30: 0.3515 - val_accuracy50: 0.3476 - 15s/epoch - 45ms/step
Epoch 2/50
346/346 - 8s - loss: 13.0084 - accuracy10: 0.3994 - accuracy20: 0.4025 - accuracy30: 0.4017 - accuracy50: 0.3968 - val_loss: 13.3187 - val_accuracy10: 0.3555 - val_accuracy20: 0.3536 - val_accuracy30: 0.3541 - val_accuracy50: 0.3513 - 8s/epoch - 24ms/step
Epoch 3/50
346/346 - 8s - loss: 13.0078 - accuracy10: 0.3979 - accuracy20: 0.4023 - accuracy30: 0.4024 - accuracy50: 0.3967 - val_loss: 13.2611 - val_accuracy10: 0.3558 - val_accuracy20: 0.3542 - val_accuracy30: 0.3537 - val_accuracy50: 0.3549 - 8s/epoch - 23ms/step
Epoch 4/50
346/346 - 8s - loss: 12.9988 - accuracy10: 0.3999 - accuracy20: 0.4049 - accuracy30: 0.4041 - accuracy50: 0.3989 - val_loss: 13.2395 - val_accuracy10: 0.3629 - val_accuracy20: 0.3562 - val_accuracy30: 0.3502 - val_accuracy50: 0.3490 - 8s/epoch - 23ms/step
Epoch 5/50
346/346 - 8s - loss: 12.9934 - accuracy10: 0.4034 - accuracy20: 0.4060 - accuracy30: 0.4030 - accuracy50: 0.3978 - val_loss: 13.2920 - val_accuracy10: 0.3616 - val_accuracy20: 0.3615 - val_accuracy30: 0.3612 - val_accuracy50: 0.3609 - 8s/epoch - 23ms/step
Epoch 6/50
346/346 - 8s - loss: 12.9954 - accuracy10: 0.4003 - accuracy20: 0.4039 - accuracy30: 0.4029 - accuracy50: 0.3986 - val_loss: 13.1358 - val_accuracy10: 0.3760 - val_accuracy20: 0.3786 - val_accuracy30: 0.3699 - val_accuracy50: 0.3599 - 8s/epoch - 24ms/step
Epoch 7/50
346/346 - 8s - loss: 12.9723 - accuracy10: 0.4041 - accuracy20: 0.4046 - accuracy30: 0.4035 - accuracy50: 0.3988 - val_loss: 13.1499 - val_accuracy10: 0.3635 - val_accuracy20: 0.3613 - val_accuracy30: 0.3594 - val_accuracy50: 0.3575 - 8s/epoch - 24ms/step
Epoch 8/50
346/346 - 8s - loss: 12.9745 - accuracy10: 0.4047 - accuracy20: 0.4059 - accuracy30: 0.4035 - accuracy50: 0.3962 - val_loss: 13.0737 - val_accuracy10: 0.3807 - val_accuracy20: 0.3866 - val_accuracy30: 0.3846 - val_accuracy50: 0.3744 - 8s/epoch - 24ms/step
Epoch 9/50
346/346 - 8s - loss: 12.9774 - accuracy10: 0.4032 - accuracy20: 0.4065 - accuracy30: 0.4051 - accuracy50: 0.4002 - val_loss: 13.0988 - val_accuracy10: 0.3743 - val_accuracy20: 0.3811 - val_accuracy30: 0.3813 - val_accuracy50: 0.3778 - 8s/epoch - 24ms/step
Epoch 10/50
346/346 - 8s - loss: 12.9429 - accuracy10: 0.4086 - accuracy20: 0.4133 - accuracy30: 0.4124 - accuracy50: 0.4062 - val_loss: 13.1751 - val_accuracy10: 0.3708 - val_accuracy20: 0.3697 - val_accuracy30: 0.3709 - val_accuracy50: 0.3708 - 8s/epoch - 24ms/step
Epoch 11/50
346/346 - 8s - loss: 12.9413 - accuracy10: 0.4078 - accuracy20: 0.4112 - accuracy30: 0.4099 - accuracy50: 0.4055 - val_loss: 13.2110 - val_accuracy10: 0.3708 - val_accuracy20: 0.3711 - val_accuracy30: 0.3704 - val_accuracy50: 0.3708 - 8s/epoch - 24ms/step
Epoch 12/50
346/346 - 8s - loss: 12.9597 - accuracy10: 0.4061 - accuracy20: 0.4075 - accuracy30: 0.4074 - accuracy50: 0.4018 - val_loss: 13.1314 - val_accuracy10: 0.3739 - val_accuracy20: 0.3775 - val_accuracy30: 0.3779 - val_accuracy50: 0.3722 - 8s/epoch - 24ms/step
Epoch 13/50
346/346 - 8s - loss: 12.9466 - accuracy10: 0.4067 - accuracy20: 0.4080 - accuracy30: 0.4060 - accuracy50: 0.4014 - val_loss: 13.1318 - val_accuracy10: 0.3715 - val_accuracy20: 0.3745 - val_accuracy30: 0.3718 - val_accuracy50: 0.3669 - 8s/epoch - 24ms/step
Epoch 14/50
346/346 - 8s - loss: 12.9123 - accuracy10: 0.4132 - accuracy20: 0.4146 - accuracy30: 0.4125 - accuracy50: 0.4069 - val_loss: 13.0415 - val_accuracy10: 0.3822 - val_accuracy20: 0.3910 - val_accuracy30: 0.3869 - val_accuracy50: 0.3851 - 8s/epoch - 23ms/step
Epoch 15/50
346/346 - 8s - loss: 12.9160 - accuracy10: 0.4135 - accuracy20: 0.4146 - accuracy30: 0.4125 - accuracy50: 0.4049 - val_loss: 13.1448 - val_accuracy10: 0.3737 - val_accuracy20: 0.3793 - val_accuracy30: 0.3774 - val_accuracy50: 0.3717 - 8s/epoch - 23ms/step
Epoch 16/50
346/346 - 8s - loss: 12.8894 - accuracy10: 0.4185 - accuracy20: 0.4171 - accuracy30: 0.4140 - accuracy50: 0.4075 - val_loss: 13.1791 - val_accuracy10: 0.3799 - val_accuracy20: 0.3873 - val_accuracy30: 0.3809 - val_accuracy50: 0.3725 - 8s/epoch - 23ms/step
Epoch 17/50
346/346 - 8s - loss: 12.8579 - accuracy10: 0.4245 - accuracy20: 0.4239 - accuracy30: 0.4210 - accuracy50: 0.4144 - val_loss: 13.1705 - val_accuracy10: 0.3710 - val_accuracy20: 0.3764 - val_accuracy30: 0.3751 - val_accuracy50: 0.3681 - 8s/epoch - 24ms/step
Epoch 18/50
346/346 - 8s - loss: 12.8424 - accuracy10: 0.4248 - accuracy20: 0.4246 - accuracy30: 0.4225 - accuracy50: 0.4160 - val_loss: 13.1527 - val_accuracy10: 0.3741 - val_accuracy20: 0.3744 - val_accuracy30: 0.3727 - val_accuracy50: 0.3679 - 8s/epoch - 24ms/step
Epoch 19/50
346/346 - 9s - loss: 12.8113 - accuracy10: 0.4271 - accuracy20: 0.4285 - accuracy30: 0.4247 - accuracy50: 0.4174 - val_loss: 13.1511 - val_accuracy10: 0.3761 - val_accuracy20: 0.3823 - val_accuracy30: 0.3791 - val_accuracy50: 0.3787 - 9s/epoch - 25ms/step
Epoch 20/50
346/346 - 9s - loss: 12.7819 - accuracy10: 0.4301 - accuracy20: 0.4301 - accuracy30: 0.4281 - accuracy50: 0.4224 - val_loss: 13.1378 - val_accuracy10: 0.3741 - val_accuracy20: 0.3776 - val_accuracy30: 0.3749 - val_accuracy50: 0.3739 - 9s/epoch - 25ms/step
Epoch 21/50
346/346 - 8s - loss: 12.7570 - accuracy10: 0.4337 - accuracy20: 0.4349 - accuracy30: 0.4325 - accuracy50: 0.4248 - val_loss: 13.1429 - val_accuracy10: 0.3724 - val_accuracy20: 0.3774 - val_accuracy30: 0.3756 - val_accuracy50: 0.3758 - 8s/epoch - 23ms/step
Epoch 22/50
346/346 - 8s - loss: 12.7388 - accuracy10: 0.4352 - accuracy20: 0.4383 - accuracy30: 0.4357 - accuracy50: 0.4272 - val_loss: 13.1339 - val_accuracy10: 0.3764 - val_accuracy20: 0.3810 - val_accuracy30: 0.3774 - val_accuracy50: 0.3781 - 8s/epoch - 24ms/step
Epoch 23/50
346/346 - 8s - loss: 12.7239 - accuracy10: 0.4363 - accuracy20: 0.4392 - accuracy30: 0.4359 - accuracy50: 0.4291 - val_loss: 13.1278 - val_accuracy10: 0.3742 - val_accuracy20: 0.3814 - val_accuracy30: 0.3801 - val_accuracy50: 0.3759 - 8s/epoch - 23ms/step
Epoch 24/50
346/346 - 8s - loss: 12.6997 - accuracy10: 0.4381 - accuracy20: 0.4417 - accuracy30: 0.4390 - accuracy50: 0.4315 - val_loss: 13.1321 - val_accuracy10: 0.3822 - val_accuracy20: 0.3820 - val_accuracy30: 0.3802 - val_accuracy50: 0.3784 - 8s/epoch - 24ms/step
testing model: results/CHTR/W4/deepLOB_L1/seq2seq
Evaluating performance on  test set...
925/925 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0703185
{'0': {'precision': 0.340689776449124, 'recall': 0.4421968616262482, 'f1-score': 0.3848627441242566, 'support': 70100}, '1': {'precision': 0.5375081837421398, 'recall': 0.3372275184838469, 'f1-score': 0.4144395855956329, 'support': 104686}, '2': {'precision': 0.34798635494633195, 'recall': 0.4498449311882148, 'f1-score': 0.3924135355826881, 'support': 61908}, 'accuracy': 0.3977709616635825, 'macro avg': {'precision': 0.40872810504586526, 'recall': 0.4097564370994366, 'f1-score': 0.39723862176752583, 'support': 236694}, 'weighted avg': {'precision': 0.42964787579884056, 'recall': 0.3977709616635825, 'f1-score': 0.39991904307514287, 'support': 236694}}
[[30998 17616 21486]
 [38689 35303 30694]
 [21299 12760 27849]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0743506
{'0': {'precision': 0.34440843709136393, 'recall': 0.42553879007558515, 'f1-score': 0.38069920753128084, 'support': 71178}, '1': {'precision': 0.5199545475484851, 'recall': 0.3313339073936358, 'f1-score': 0.4047478170440894, 'support': 102196}, '2': {'precision': 0.34923349197617964, 'recall': 0.46122867972204673, 'f1-score': 0.39749295659630074, 'support': 63320}, 'accuracy': 0.3944121946479421, 'macro avg': {'precision': 0.4045321588720096, 'recall': 0.4060337923970892, 'f1-score': 0.39431332705722366, 'support': 236694}, 'weighted avg': {'precision': 0.42149375729205546, 'recall': 0.3944121946479421, 'f1-score': 0.395575173498175, 'support': 236694}}
[[30289 17808 23081]
 [36995 33861 31340]
 [20661 13454 29205]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0786612
{'0': {'precision': 0.34267698547751696, 'recall': 0.4111222977319126, 'f1-score': 0.37379220911310007, 'support': 71514}, '1': {'precision': 0.49967094690766617, 'recall': 0.3253477896918723, 'f1-score': 0.39409247557140875, 'support': 100348}, '2': {'precision': 0.3510408265834473, 'recall': 0.4632588845014807, 'f1-score': 0.3994175105892053, 'support': 64832}, 'accuracy': 0.38903816742291736, 'macro avg': {'precision': 0.3977962529895435, 'recall': 0.3999096573084218, 'f1-score': 0.3891007317579047, 'support': 236694}, 'weighted avg': {'precision': 0.41152653209962103, 'recall': 0.38903816742291736, 'f1-score': 0.3894175763968386, 'support': 236694}}
[[29401 18370 23743]
 [35920 32648 31780]
 [20477 14321 30034]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0836406
{'0': {'precision': 0.3494957606102832, 'recall': 0.40300113018968126, 'f1-score': 0.37434622852119576, 'support': 73439}, '1': {'precision': 0.463010863942059, 'recall': 0.3205013428827216, 'f1-score': 0.37879589461432656, 'support': 94945}, '2': {'precision': 0.3591030246842044, 'recall': 0.45362318840579713, 'f1-score': 0.4008667529107374, 'support': 68310}, 'accuracy': 0.38451756276035726, 'macro avg': {'precision': 0.39053654974551555, 'recall': 0.3923752204927333, 'f1-score': 0.3846696253487532, 'support': 236694}, 'weighted avg': {'precision': 0.3978027041522615, 'recall': 0.38451756276035726, 'f1-score': 0.38378495771695864, 'support': 236694}}
[[29596 19467 24376]
 [33588 30430 30927]
 [21498 15825 30987]]
Evaluating performance on  train set...
346/346 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0888276
{'0': {'precision': 0.3866567828020756, 'recall': 0.2630004369894786, 'f1-score': 0.31306017925736235, 'support': 29749}, '1': {'precision': 0.36356483065343825, 'recall': 0.3670938547100073, 'f1-score': 0.3653208202272297, 'support': 28949}, '2': {'precision': 0.4006393044367728, 'recall': 0.5244710765934655, 'f1-score': 0.45426736448381344, 'support': 29872}, 'accuracy': 0.3852094388619171, 'macro avg': {'precision': 0.3836203059640955, 'recall': 0.3848551227643171, 'f1-score': 0.37754945465613515, 'support': 88570}, 'weighted avg': {'precision': 0.3838250899435544, 'recall': 0.3852094388619171, 'f1-score': 0.37776644924179537, 'support': 88570}}
[[ 7824 10181 11744]
 [ 6628 10627 11694]
 [ 5783  8422 15667]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0916574
{'0': {'precision': 0.3788564376799671, 'recall': 0.2469913848010459, 'f1-score': 0.29903204204630773, 'support': 29831}, '1': {'precision': 0.3637801774537451, 'recall': 0.36156685808039374, 'f1-score': 0.36267014091267524, 'support': 29256}, '2': {'precision': 0.39224353211467383, 'recall': 0.5327476851066716, 'f1-score': 0.45182447106879337, 'support': 29483}, 'accuracy': 0.379959354183132, 'macro avg': {'precision': 0.3782933824161287, 'recall': 0.3804353093293704, 'f1-score': 0.3711755513425921, 'support': 88570}, 'weighted avg': {'precision': 0.37833279125386465, 'recall': 0.379959354183132, 'f1-score': 0.37091389149086446, 'support': 88570}}
[[ 7368 10195 12268]
 [ 6609 10578 12069]
 [ 5471  8305 15707]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0940309
{'0': {'precision': 0.3767380385937087, 'recall': 0.2372486349713677, 'f1-score': 0.29114829114829116, 'support': 30036}, '1': {'precision': 0.36060926880912536, 'recall': 0.360055923071677, 'f1-score': 0.3603323835036771, 'support': 29326}, '2': {'precision': 0.38440580571655025, 'recall': 0.5313612708846891, 'f1-score': 0.4460923802132735, 'support': 29208}, 'accuracy': 0.37490120808400135, 'macro avg': {'precision': 0.3739177043731281, 'recall': 0.37622194297591127, 'f1-score': 0.3658576849550806, 'support': 88570}, 'weighted avg': {'precision': 0.3739263398178395, 'recall': 0.37490120808400135, 'f1-score': 0.3651519001109653, 'support': 88570}}
[[ 7126 10360 12550]
 [ 6463 10559 12304]
 [ 5326  8362 15520]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0981699
{'0': {'precision': 0.3727619764503468, 'recall': 0.22880432989010263, 'f1-score': 0.2835582822085889, 'support': 30301}, '1': {'precision': 0.3504823151125402, 'recall': 0.3573523829243883, 'f1-score': 0.3538840094323502, 'support': 28977}, '2': {'precision': 0.3806213822787315, 'recall': 0.5252970094223679, 'f1-score': 0.44140681029289425, 'support': 29292}, 'accuracy': 0.36891724060065484, 'macro avg': {'precision': 0.3679552246138728, 'recall': 0.3704845740789529, 'f1-score': 0.3596163673112778, 'support': 88570}, 'weighted avg': {'precision': 0.3680721262633695, 'recall': 0.36891724060065484, 'f1-score': 0.3587702917198049, 'support': 88570}}
[[ 6933 10529 12839]
 [ 6422 10355 12200]
 [ 5244  8661 15387]]
Evaluating performance on  val set...
127/127 - 1s - 996ms/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0878258
{'0': {'precision': 0.41364405186994924, 'recall': 0.20261437908496732, 'f1-score': 0.2719970341077607, 'support': 10863}, '1': {'precision': 0.37450028555111364, 'recall': 0.47669241253975464, 'f1-score': 0.4194618798224923, 'support': 11005}, '2': {'precision': 0.3834801421727708, 'recall': 0.47707392098433143, 'f1-score': 0.4251874062968516, 'support': 10403}, 'accuracy': 0.3845557931269561, 'macro avg': {'precision': 0.3905414931979445, 'recall': 0.38546023753635117, 'f1-score': 0.37221544007570156, 'support': 32271}, 'weighted avg': {'precision': 0.3905715626096681, 'recall': 0.3845557931269561, 'f1-score': 0.37166825808513154, 'support': 32271}}
[[2201 4963 3699]
 [1479 5246 4280]
 [1641 3799 4963]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0856141
{'0': {'precision': 0.4185443668993021, 'recall': 0.19363468634686345, 'f1-score': 0.26477451907915484, 'support': 10840}, '1': {'precision': 0.3834119159879983, 'recall': 0.48592123132639203, 'f1-score': 0.4286227688375993, 'support': 11045}, '2': {'precision': 0.3836174385276814, 'recall': 0.4896976699403043, 'f1-score': 0.4302148536626628, 'support': 10386}, 'accuracy': 0.3889560286325184, 'macro avg': {'precision': 0.3951912404716606, 'recall': 0.3897511958711866, 'f1-score': 0.3745373805264723, 'support': 32271}, 'weighted avg': {'precision': 0.3952792372664118, 'recall': 0.3889560286325184, 'f1-score': 0.3740976647383018, 'support': 32271}}
[[2099 4863 3878]
 [1384 5367 4294]
 [1532 3768 5086]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0878009
{'0': {'precision': 0.41413721413721416, 'recall': 0.18231740801757276, 'f1-score': 0.2531774275546517, 'support': 10926}, '1': {'precision': 0.3747876557191393, 'recall': 0.491369710467706, 'f1-score': 0.4252328943141664, 'support': 10776}, '2': {'precision': 0.38408460211505285, 'recall': 0.4845302299176838, 'f1-score': 0.42849970713747804, 'support': 10569}, 'accuracy': 0.3844938179789904, 'macro avg': {'precision': 0.39100315732380214, 'recall': 0.3860724494676542, 'f1-score': 0.36897000966876536, 'support': 32271}, 'weighted avg': {'precision': 0.39115506614132317, 'recall': 0.3844938179789904, 'f1-score': 0.3680499410407978, 'support': 32271}}
[[1992 4920 4014]
 [1283 5295 4198]
 [1535 3913 5121]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0899069
{'0': {'precision': 0.4058898847631242, 'recall': 0.1735718196751232, 'f1-score': 0.24316031705446178, 'support': 10958}, '1': {'precision': 0.36230359147025815, 'recall': 0.49068972069162076, 'f1-score': 0.4168347994512146, 'support': 10526}, '2': {'precision': 0.3854752794658264, 'recall': 0.4763140817650876, 'f1-score': 0.42610714878089234, 'support': 10787}, 'accuracy': 0.3782033404604753, 'macro avg': {'precision': 0.38455625189973625, 'recall': 0.38019187404394383, 'f1-score': 0.3620340884288562, 'support': 32271}, 'weighted avg': {'precision': 0.38484927026271637, 'recall': 0.3782033404604753, 'f1-score': 0.36096097633186963, 'support': 32271}}
[[1902 4992 4064]
 [1234 5165 4127]
 [1550 4099 5138]]
training model: results/CHTR/W4/deepOF_L1/seq2seq
Epoch 1/50
346/346 - 14s - loss: 13.1221 - accuracy10: 0.3837 - accuracy20: 0.3887 - accuracy30: 0.3896 - accuracy50: 0.3883 - val_loss: 13.0482 - val_accuracy10: 0.3870 - val_accuracy20: 0.3975 - val_accuracy30: 0.4029 - val_accuracy50: 0.4018 - 14s/epoch - 41ms/step
Epoch 2/50
346/346 - 8s - loss: 13.0133 - accuracy10: 0.4012 - accuracy20: 0.4055 - accuracy30: 0.4061 - accuracy50: 0.4018 - val_loss: 12.9219 - val_accuracy10: 0.4076 - val_accuracy20: 0.4172 - val_accuracy30: 0.4194 - val_accuracy50: 0.4159 - 8s/epoch - 23ms/step
Epoch 3/50
346/346 - 8s - loss: 12.9544 - accuracy10: 0.4061 - accuracy20: 0.4132 - accuracy30: 0.4143 - accuracy50: 0.4092 - val_loss: 12.8792 - val_accuracy10: 0.4101 - val_accuracy20: 0.4213 - val_accuracy30: 0.4259 - val_accuracy50: 0.4249 - 8s/epoch - 22ms/step
Epoch 4/50
346/346 - 8s - loss: 12.9117 - accuracy10: 0.4134 - accuracy20: 0.4198 - accuracy30: 0.4195 - accuracy50: 0.4151 - val_loss: 12.7940 - val_accuracy10: 0.4271 - val_accuracy20: 0.4350 - val_accuracy30: 0.4367 - val_accuracy50: 0.4327 - 8s/epoch - 22ms/step
Epoch 5/50
346/346 - 8s - loss: 12.8518 - accuracy10: 0.4207 - accuracy20: 0.4268 - accuracy30: 0.4258 - accuracy50: 0.4230 - val_loss: 12.7788 - val_accuracy10: 0.4289 - val_accuracy20: 0.4371 - val_accuracy30: 0.4418 - val_accuracy50: 0.4392 - 8s/epoch - 22ms/step
Epoch 6/50
346/346 - 8s - loss: 12.8103 - accuracy10: 0.4262 - accuracy20: 0.4315 - accuracy30: 0.4305 - accuracy50: 0.4272 - val_loss: 12.7731 - val_accuracy10: 0.4297 - val_accuracy20: 0.4369 - val_accuracy30: 0.4400 - val_accuracy50: 0.4344 - 8s/epoch - 22ms/step
Epoch 7/50
346/346 - 7s - loss: 12.7848 - accuracy10: 0.4274 - accuracy20: 0.4361 - accuracy30: 0.4356 - accuracy50: 0.4301 - val_loss: 12.7563 - val_accuracy10: 0.4334 - val_accuracy20: 0.4380 - val_accuracy30: 0.4437 - val_accuracy50: 0.4381 - 7s/epoch - 21ms/step
Epoch 8/50
346/346 - 8s - loss: 12.7492 - accuracy10: 0.4319 - accuracy20: 0.4384 - accuracy30: 0.4387 - accuracy50: 0.4337 - val_loss: 12.7548 - val_accuracy10: 0.4327 - val_accuracy20: 0.4390 - val_accuracy30: 0.4442 - val_accuracy50: 0.4418 - 8s/epoch - 22ms/step
Epoch 9/50
346/346 - 8s - loss: 12.7246 - accuracy10: 0.4350 - accuracy20: 0.4411 - accuracy30: 0.4417 - accuracy50: 0.4367 - val_loss: 12.7608 - val_accuracy10: 0.4303 - val_accuracy20: 0.4382 - val_accuracy30: 0.4451 - val_accuracy50: 0.4429 - 8s/epoch - 22ms/step
Epoch 10/50
346/346 - 7s - loss: 12.7021 - accuracy10: 0.4368 - accuracy20: 0.4437 - accuracy30: 0.4440 - accuracy50: 0.4394 - val_loss: 12.7521 - val_accuracy10: 0.4324 - val_accuracy20: 0.4413 - val_accuracy30: 0.4458 - val_accuracy50: 0.4445 - 7s/epoch - 21ms/step
Epoch 11/50
346/346 - 8s - loss: 12.6789 - accuracy10: 0.4393 - accuracy20: 0.4457 - accuracy30: 0.4458 - accuracy50: 0.4403 - val_loss: 12.7532 - val_accuracy10: 0.4344 - val_accuracy20: 0.4397 - val_accuracy30: 0.4443 - val_accuracy50: 0.4420 - 8s/epoch - 22ms/step
Epoch 12/50
346/346 - 8s - loss: 12.6559 - accuracy10: 0.4407 - accuracy20: 0.4480 - accuracy30: 0.4497 - accuracy50: 0.4439 - val_loss: 12.7651 - val_accuracy10: 0.4306 - val_accuracy20: 0.4394 - val_accuracy30: 0.4458 - val_accuracy50: 0.4442 - 8s/epoch - 22ms/step
Epoch 13/50
346/346 - 8s - loss: 12.6328 - accuracy10: 0.4437 - accuracy20: 0.4519 - accuracy30: 0.4531 - accuracy50: 0.4457 - val_loss: 12.7543 - val_accuracy10: 0.4321 - val_accuracy20: 0.4399 - val_accuracy30: 0.4460 - val_accuracy50: 0.4453 - 8s/epoch - 23ms/step
Epoch 14/50
346/346 - 8s - loss: 12.6190 - accuracy10: 0.4437 - accuracy20: 0.4513 - accuracy30: 0.4529 - accuracy50: 0.4477 - val_loss: 12.7322 - val_accuracy10: 0.4355 - val_accuracy20: 0.4430 - val_accuracy30: 0.4474 - val_accuracy50: 0.4470 - 8s/epoch - 23ms/step
Epoch 15/50
346/346 - 8s - loss: 12.6012 - accuracy10: 0.4464 - accuracy20: 0.4540 - accuracy30: 0.4548 - accuracy50: 0.4482 - val_loss: 12.7564 - val_accuracy10: 0.4303 - val_accuracy20: 0.4395 - val_accuracy30: 0.4457 - val_accuracy50: 0.4439 - 8s/epoch - 23ms/step
Epoch 16/50
346/346 - 8s - loss: 12.5786 - accuracy10: 0.4478 - accuracy20: 0.4561 - accuracy30: 0.4587 - accuracy50: 0.4513 - val_loss: 12.7683 - val_accuracy10: 0.4318 - val_accuracy20: 0.4406 - val_accuracy30: 0.4447 - val_accuracy50: 0.4421 - 8s/epoch - 22ms/step
Epoch 17/50
346/346 - 7s - loss: 12.5672 - accuracy10: 0.4488 - accuracy20: 0.4566 - accuracy30: 0.4595 - accuracy50: 0.4515 - val_loss: 12.7885 - val_accuracy10: 0.4313 - val_accuracy20: 0.4385 - val_accuracy30: 0.4430 - val_accuracy50: 0.4381 - 7s/epoch - 22ms/step
Epoch 18/50
346/346 - 8s - loss: 12.5480 - accuracy10: 0.4489 - accuracy20: 0.4589 - accuracy30: 0.4611 - accuracy50: 0.4532 - val_loss: 12.8064 - val_accuracy10: 0.4274 - val_accuracy20: 0.4376 - val_accuracy30: 0.4422 - val_accuracy50: 0.4385 - 8s/epoch - 24ms/step
Epoch 19/50
346/346 - 8s - loss: 12.5309 - accuracy10: 0.4503 - accuracy20: 0.4593 - accuracy30: 0.4630 - accuracy50: 0.4547 - val_loss: 12.7989 - val_accuracy10: 0.4285 - val_accuracy20: 0.4346 - val_accuracy30: 0.4409 - val_accuracy50: 0.4370 - 8s/epoch - 23ms/step
Epoch 20/50
346/346 - 8s - loss: 12.5153 - accuracy10: 0.4538 - accuracy20: 0.4610 - accuracy30: 0.4630 - accuracy50: 0.4565 - val_loss: 12.8067 - val_accuracy10: 0.4288 - val_accuracy20: 0.4358 - val_accuracy30: 0.4410 - val_accuracy50: 0.4404 - 8s/epoch - 22ms/step
Epoch 21/50
346/346 - 8s - loss: 12.5027 - accuracy10: 0.4528 - accuracy20: 0.4625 - accuracy30: 0.4645 - accuracy50: 0.4588 - val_loss: 12.8787 - val_accuracy10: 0.4243 - val_accuracy20: 0.4286 - val_accuracy30: 0.4329 - val_accuracy50: 0.4305 - 8s/epoch - 23ms/step
Epoch 22/50
346/346 - 8s - loss: 12.4791 - accuracy10: 0.4565 - accuracy20: 0.4660 - accuracy30: 0.4684 - accuracy50: 0.4607 - val_loss: 12.8972 - val_accuracy10: 0.4255 - val_accuracy20: 0.4294 - val_accuracy30: 0.4336 - val_accuracy50: 0.4330 - 8s/epoch - 23ms/step
Epoch 23/50
346/346 - 8s - loss: 12.4680 - accuracy10: 0.4563 - accuracy20: 0.4665 - accuracy30: 0.4701 - accuracy50: 0.4635 - val_loss: 12.8930 - val_accuracy10: 0.4251 - val_accuracy20: 0.4297 - val_accuracy30: 0.4349 - val_accuracy50: 0.4320 - 8s/epoch - 22ms/step
Epoch 24/50
346/346 - 8s - loss: 12.4439 - accuracy10: 0.4579 - accuracy20: 0.4689 - accuracy30: 0.4714 - accuracy50: 0.4647 - val_loss: 12.9196 - val_accuracy10: 0.4212 - val_accuracy20: 0.4294 - val_accuracy30: 0.4363 - val_accuracy50: 0.4331 - 8s/epoch - 22ms/step
testing model: results/CHTR/W4/deepOF_L1/seq2seq
Evaluating performance on  test set...
925/925 - 8s - 8s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.060478
{'0': {'precision': 0.3905451914856304, 'recall': 0.508295410776188, 'f1-score': 0.4417075241890996, 'support': 70099}, '1': {'precision': 0.5720242875054591, 'recall': 0.38787577734684714, 'f1-score': 0.46228638438855557, 'support': 104683}, '2': {'precision': 0.3607750459898218, 'recall': 0.4339988369839116, 'f1-score': 0.39401382890578596, 'support': 61908}, 'accuracy': 0.4356035320461363, 'macro avg': {'precision': 0.44111484166030374, 'recall': 0.4433900083689823, 'f1-score': 0.4326692458278137, 'support': 236690}, 'weighted avg': {'precision': 0.4630229727239134, 'recall': 0.4356035320461363, 'f1-score': 0.4383344857618752, 'support': 236690}}
[[35631 16036 18432]
 [34906 40604 29173]
 [20697 14343 26868]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0660099
{'0': {'precision': 0.39523529096846727, 'recall': 0.5186085392753277, 'f1-score': 0.4485939284933038, 'support': 71177}, '1': {'precision': 0.5544981923571066, 'recall': 0.3632049161879972, 'f1-score': 0.4389142144255045, 'support': 102193}, '2': {'precision': 0.36338515132862736, 'recall': 0.43820277953253317, 'f1-score': 0.39730234755901117, 'support': 63320}, 'accuracy': 0.4300012674806709, 'macro avg': {'precision': 0.4377062115514005, 'recall': 0.44000541166528606, 'f1-score': 0.4282701634926065, 'support': 236690}, 'weighted avg': {'precision': 0.4554778142673584, 'recall': 0.4300012674806709, 'f1-score': 0.430692952852212, 'support': 236690}}
[[36913 15749 18515]
 [34981 37117 30095]
 [21501 14072 27747]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.073861
{'0': {'precision': 0.39540878054938927, 'recall': 0.5255474452554745, 'f1-score': 0.45128328280250946, 'support': 71514}, '1': {'precision': 0.5347845110479107, 'recall': 0.3410499671137863, 'f1-score': 0.41649020323719116, 'support': 100346}, '2': {'precision': 0.3628050743769721, 'recall': 0.43452105506709854, 'f1-score': 0.39543779610457974, 'support': 64830}, 'accuracy': 0.4223963834551523, 'macro avg': {'precision': 0.43099945532475736, 'recall': 0.4337061558121198, 'f1-score': 0.4210704273814268, 'support': 236690}, 'weighted avg': {'precision': 0.44556763297850255, 'recall': 0.4223963834551523, 'f1-score': 0.4212363468749747, 'support': 236690}}
[[37584 15463 18467]
 [35115 34223 31008]
 [22352 14308 28170]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0824505
{'0': {'precision': 0.3982204973111343, 'recall': 0.5253482576902652, 'f1-score': 0.45303491116617156, 'support': 73437}, '1': {'precision': 0.4941880314090163, 'recall': 0.32016430565063986, 'f1-score': 0.38858209336810345, 'support': 94945}, '2': {'precision': 0.36875782267746304, 'recall': 0.4226884113134626, 'f1-score': 0.3938856527017994, 'support': 68308}, 'accuracy': 0.4134141704339009, 'macro avg': {'precision': 0.4203887837992046, 'recall': 0.42273365821812253, 'f1-score': 0.41183421907869144, 'support': 236690}, 'weighted avg': {'precision': 0.42821374225619574, 'recall': 0.4134141704339009, 'f1-score': 0.4101102403603838, 'support': 236690}}
[[38580 16158 18699]
 [33821 30398 30726]
 [24480 14955 28873]]
Evaluating performance on  train set...
346/346 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0587391
{'0': {'precision': 0.43525107411385605, 'recall': 0.436996596232265, 'f1-score': 0.43612208862356006, 'support': 29673}, '1': {'precision': 0.4599696452286094, 'recall': 0.3336888827719093, 'f1-score': 0.3867828583963148, 'support': 29063}, '2': {'precision': 0.4352532300427135, 'recall': 0.5499279321556666, 'f1-score': 0.48591653585285666, 'support': 29833}, 'accuracy': 0.4411362892208335, 'macro avg': {'precision': 0.4434913164617263, 'recall': 0.44020447038661364, 'f1-score': 0.4362738276242439, 'support': 88569}, 'weighted avg': {'precision': 0.44336294339242616, 'recall': 0.4411362892208335, 'f1-score': 0.43670436567418924, 'support': 88569}}
[[12967  5997 10709]
 [ 8787  9698 10578]
 [ 8038  5389 16406]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.056619
{'0': {'precision': 0.4358565207273694, 'recall': 0.4402027934461456, 'f1-score': 0.4380188758038921, 'support': 29784}, '1': {'precision': 0.47311775353456287, 'recall': 0.3301245946407237, 'f1-score': 0.3888933569245617, 'support': 29295}, '2': {'precision': 0.4340421058164901, 'recall': 0.5599864360800271, 'f1-score': 0.48903563972341085, 'support': 29490}, 'accuracy': 0.4436766814573948, 'macro avg': {'precision': 0.4476721266928074, 'recall': 0.4434379413889655, 'f1-score': 0.43864929081728815, 'support': 88569}, 'weighted avg': {'precision': 0.4475768824720533, 'recall': 0.4436766814573948, 'f1-score': 0.438756744498544, 'support': 88569}}
[[13111  5807 10866]
 [ 8957  9671 10667]
 [ 8013  4963 16514]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0579636
{'0': {'precision': 0.43557777704680767, 'recall': 0.44125291569476843, 'f1-score': 0.438396980682326, 'support': 30010}, '1': {'precision': 0.47300745484564966, 'recall': 0.32227714334412816, 'f1-score': 0.3833583390778963, 'support': 29335}, '2': {'precision': 0.4275686859956523, 'recall': 0.5586162058581987, 'f1-score': 0.4843854313478229, 'support': 29224}, 'accuracy': 0.4405717576127087, 'macro avg': {'precision': 0.44538463929603656, 'recall': 0.44071542163236516, 'f1-score': 0.4353802503693484, 'support': 88569}, 'weighted avg': {'precision': 0.44533222749053025, 'recall': 0.4405717576127087, 'f1-score': 0.4353418251627033, 'support': 88569}}
[[13242  5695 11073]
 [ 9098  9454 10783]
 [ 8061  4838 16325]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0630199
{'0': {'precision': 0.43237323045738385, 'recall': 0.4360513040324442, 'f1-score': 0.4342044782979841, 'support': 30329}, '1': {'precision': 0.46727511093182733, 'recall': 0.3197832913489078, 'f1-score': 0.3797094917129335, 'support': 28979}, '2': {'precision': 0.42099606815203144, 'recall': 0.5488875978264585, 'f1-score': 0.47650976843541853, 'support': 29261}, 'accuracy': 0.4352877417606612, 'macro avg': {'precision': 0.4402148031804142, 'recall': 0.43490739773593684, 'f1-score': 0.43014124614877874, 'support': 88569}, 'weighted avg': {'precision': 0.4400340875072769, 'recall': 0.4352877417606612, 'f1-score': 0.4303508148092159, 'support': 88569}}
[[13225  5720 11384]
 [ 9007  9267 10705]
 [ 8355  4845 16061]]
Evaluating performance on  val set...
127/127 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0648043
{'0': {'precision': 0.4461729337659859, 'recall': 0.428781069430432, 'f1-score': 0.43730414854309907, 'support': 10903}, '1': {'precision': 0.46140786208697926, 'recall': 0.32080268773267956, 'f1-score': 0.37846813069094803, 'support': 11013}, '2': {'precision': 0.4110364343827379, 'recall': 0.5611357929302685, 'f1-score': 0.47449875454285595, 'support': 10354}, 'accuracy': 0.4343972730089867, 'macro avg': {'precision': 0.43953907674523435, 'recall': 0.4369065166977933, 'f1-score': 0.43009034459230105, 'support': 32270}, 'weighted avg': {'precision': 0.4400985287763655, 'recall': 0.4343972730089867, 'f1-score': 0.4291588707592671, 'support': 32270}}
[[4675 2251 3977]
 [3132 3533 4348]
 [2671 1873 5810]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0595704
{'0': {'precision': 0.450302915562287, 'recall': 0.4372242647058823, 'f1-score': 0.44366722626375676, 'support': 10880}, '1': {'precision': 0.4789209705842483, 'recall': 0.32086095722459357, 'f1-score': 0.3842723515336089, 'support': 11011}, '2': {'precision': 0.4201270151441133, 'recall': 0.5800173427112438, 'f1-score': 0.48729156548486324, 'support': 10379}, 'accuracy': 0.44344592500774715, 'macro avg': {'precision': 0.4497836337635495, 'recall': 0.44603418821390656, 'f1-score': 0.4384103810940763, 'support': 32270}, 'weighted avg': {'precision': 0.4503623433096248, 'recall': 0.44344592500774715, 'f1-score': 0.43743171498771727, 'support': 32270}}
[[4757 2140 3983]
 [3152 3533 4326]
 [2655 1704 6020]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0576555
{'0': {'precision': 0.4572906867356538, 'recall': 0.4433600875592849, 'f1-score': 0.4502176530517736, 'support': 10964}, '1': {'precision': 0.4847895541047368, 'recall': 0.3232080014817559, 'f1-score': 0.3878424181808079, 'support': 10798}, '2': {'precision': 0.4278789557509868, 'recall': 0.5880281690140845, 'f1-score': 0.4953304741673013, 'support': 10508}, 'accuracy': 0.4502634025410598, 'macro avg': {'precision': 0.4566530655304591, 'recall': 0.4515320860183751, 'f1-score': 0.44446351513329424, 'support': 32270}, 'weighted avg': {'precision': 0.45691492908658277, 'recall': 0.4502634025410598, 'f1-score': 0.44403599014955103, 'support': 32270}}
[[4861 2068 4035]
 [3081 3490 4227]
 [2688 1641 6179]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0615747
{'0': {'precision': 0.4499440715883669, 'recall': 0.4392174704276615, 'f1-score': 0.44451606961967033, 'support': 10990}, '1': {'precision': 0.47167418263810595, 'recall': 0.31830718021873516, 'f1-score': 0.38010334450059624, 'support': 10515}, '2': {'precision': 0.43188425861830265, 'recall': 0.5795633999071064, 'f1-score': 0.49494268374915706, 'support': 10765}, 'accuracy': 0.4466377440347072, 'macro avg': {'precision': 0.45116750428159186, 'recall': 0.44569601685116766, 'f1-score': 0.4398540326231412, 'support': 32270}, 'weighted avg': {'precision': 0.45100010601865087, 'recall': 0.4466377440347072, 'f1-score': 0.44034943486531214, 'support': 32270}}
[[4827 2075 4088]
 [3049 3347 4119]
 [2852 1674 6239]]
training model: results/CHTR/W4/deepLOB_L2/seq2seq
Epoch 1/50
346/346 - 22s - loss: 13.2002 - accuracy10: 0.3677 - accuracy20: 0.3742 - accuracy30: 0.3736 - accuracy50: 0.3746 - val_loss: 13.4982 - val_accuracy10: 0.3412 - val_accuracy20: 0.3355 - val_accuracy30: 0.3410 - val_accuracy50: 0.3429 - 22s/epoch - 64ms/step
Epoch 2/50
346/346 - 17s - loss: 13.0858 - accuracy10: 0.3795 - accuracy20: 0.3867 - accuracy30: 0.3870 - accuracy50: 0.3856 - val_loss: 13.2734 - val_accuracy10: 0.3418 - val_accuracy20: 0.3417 - val_accuracy30: 0.3464 - val_accuracy50: 0.3483 - 17s/epoch - 49ms/step
Epoch 3/50
346/346 - 17s - loss: 13.0663 - accuracy10: 0.3836 - accuracy20: 0.3915 - accuracy30: 0.3897 - accuracy50: 0.3897 - val_loss: 13.2994 - val_accuracy10: 0.3456 - val_accuracy20: 0.3440 - val_accuracy30: 0.3504 - val_accuracy50: 0.3499 - 17s/epoch - 48ms/step
Epoch 4/50
346/346 - 17s - loss: 13.0530 - accuracy10: 0.3865 - accuracy20: 0.3933 - accuracy30: 0.3943 - accuracy50: 0.3942 - val_loss: 13.3954 - val_accuracy10: 0.3482 - val_accuracy20: 0.3508 - val_accuracy30: 0.3520 - val_accuracy50: 0.3512 - 17s/epoch - 48ms/step
Epoch 5/50
346/346 - 17s - loss: 13.0448 - accuracy10: 0.3850 - accuracy20: 0.3916 - accuracy30: 0.3911 - accuracy50: 0.3909 - val_loss: 13.1643 - val_accuracy10: 0.3578 - val_accuracy20: 0.3577 - val_accuracy30: 0.3565 - val_accuracy50: 0.3562 - 17s/epoch - 49ms/step
Epoch 6/50
346/346 - 16s - loss: 13.0095 - accuracy10: 0.3965 - accuracy20: 0.4016 - accuracy30: 0.3986 - accuracy50: 0.3934 - val_loss: 13.1957 - val_accuracy10: 0.3602 - val_accuracy20: 0.3641 - val_accuracy30: 0.3629 - val_accuracy50: 0.3578 - 16s/epoch - 47ms/step
Epoch 7/50
346/346 - 17s - loss: 13.0031 - accuracy10: 0.3979 - accuracy20: 0.4022 - accuracy30: 0.4012 - accuracy50: 0.3991 - val_loss: 13.2318 - val_accuracy10: 0.3586 - val_accuracy20: 0.3604 - val_accuracy30: 0.3603 - val_accuracy50: 0.3598 - 17s/epoch - 48ms/step
Epoch 8/50
346/346 - 17s - loss: 12.9685 - accuracy10: 0.4026 - accuracy20: 0.4093 - accuracy30: 0.4068 - accuracy50: 0.4022 - val_loss: 13.1256 - val_accuracy10: 0.3767 - val_accuracy20: 0.3811 - val_accuracy30: 0.3786 - val_accuracy50: 0.3724 - 17s/epoch - 49ms/step
Epoch 9/50
346/346 - 17s - loss: 12.9537 - accuracy10: 0.4079 - accuracy20: 0.4103 - accuracy30: 0.4062 - accuracy50: 0.4011 - val_loss: 13.0828 - val_accuracy10: 0.3736 - val_accuracy20: 0.3794 - val_accuracy30: 0.3801 - val_accuracy50: 0.3806 - 17s/epoch - 49ms/step
Epoch 10/50
346/346 - 17s - loss: 12.9515 - accuracy10: 0.4075 - accuracy20: 0.4080 - accuracy30: 0.4053 - accuracy50: 0.4001 - val_loss: 13.1672 - val_accuracy10: 0.3812 - val_accuracy20: 0.3883 - val_accuracy30: 0.3851 - val_accuracy50: 0.3774 - 17s/epoch - 48ms/step
Epoch 11/50
346/346 - 17s - loss: 12.9099 - accuracy10: 0.4143 - accuracy20: 0.4170 - accuracy30: 0.4117 - accuracy50: 0.4070 - val_loss: 13.2662 - val_accuracy10: 0.3716 - val_accuracy20: 0.3740 - val_accuracy30: 0.3710 - val_accuracy50: 0.3662 - 17s/epoch - 49ms/step
Epoch 12/50
346/346 - 17s - loss: 12.8551 - accuracy10: 0.4218 - accuracy20: 0.4251 - accuracy30: 0.4214 - accuracy50: 0.4147 - val_loss: 13.0621 - val_accuracy10: 0.3838 - val_accuracy20: 0.3936 - val_accuracy30: 0.3953 - val_accuracy50: 0.3901 - 17s/epoch - 48ms/step
Epoch 13/50
346/346 - 17s - loss: 12.8287 - accuracy10: 0.4251 - accuracy20: 0.4279 - accuracy30: 0.4246 - accuracy50: 0.4181 - val_loss: 13.1891 - val_accuracy10: 0.3878 - val_accuracy20: 0.3936 - val_accuracy30: 0.3892 - val_accuracy50: 0.3831 - 17s/epoch - 48ms/step
Epoch 14/50
346/346 - 17s - loss: 12.7887 - accuracy10: 0.4316 - accuracy20: 0.4358 - accuracy30: 0.4318 - accuracy50: 0.4240 - val_loss: 13.2056 - val_accuracy10: 0.3844 - val_accuracy20: 0.3908 - val_accuracy30: 0.3886 - val_accuracy50: 0.3820 - 17s/epoch - 48ms/step
Epoch 15/50
346/346 - 17s - loss: 12.7472 - accuracy10: 0.4377 - accuracy20: 0.4426 - accuracy30: 0.4385 - accuracy50: 0.4306 - val_loss: 13.1169 - val_accuracy10: 0.3905 - val_accuracy20: 0.3973 - val_accuracy30: 0.3955 - val_accuracy50: 0.3884 - 17s/epoch - 49ms/step
Epoch 16/50
346/346 - 17s - loss: 12.7174 - accuracy10: 0.4411 - accuracy20: 0.4451 - accuracy30: 0.4408 - accuracy50: 0.4336 - val_loss: 13.1073 - val_accuracy10: 0.3897 - val_accuracy20: 0.3954 - val_accuracy30: 0.3928 - val_accuracy50: 0.3841 - 17s/epoch - 49ms/step
Epoch 17/50
346/346 - 17s - loss: 12.6858 - accuracy10: 0.4432 - accuracy20: 0.4476 - accuracy30: 0.4442 - accuracy50: 0.4363 - val_loss: 13.0555 - val_accuracy10: 0.3949 - val_accuracy20: 0.4004 - val_accuracy30: 0.3992 - val_accuracy50: 0.3909 - 17s/epoch - 48ms/step
Epoch 18/50
346/346 - 17s - loss: 12.6418 - accuracy10: 0.4463 - accuracy20: 0.4510 - accuracy30: 0.4486 - accuracy50: 0.4401 - val_loss: 13.1825 - val_accuracy10: 0.3871 - val_accuracy20: 0.3906 - val_accuracy30: 0.3892 - val_accuracy50: 0.3828 - 17s/epoch - 48ms/step
Epoch 19/50
346/346 - 17s - loss: 12.6130 - accuracy10: 0.4496 - accuracy20: 0.4547 - accuracy30: 0.4526 - accuracy50: 0.4441 - val_loss: 13.0541 - val_accuracy10: 0.3919 - val_accuracy20: 0.3994 - val_accuracy30: 0.3982 - val_accuracy50: 0.3950 - 17s/epoch - 48ms/step
Epoch 20/50
346/346 - 17s - loss: 12.5752 - accuracy10: 0.4518 - accuracy20: 0.4582 - accuracy30: 0.4559 - accuracy50: 0.4474 - val_loss: 13.0906 - val_accuracy10: 0.3919 - val_accuracy20: 0.3990 - val_accuracy30: 0.3972 - val_accuracy50: 0.3942 - 17s/epoch - 48ms/step
Epoch 21/50
346/346 - 17s - loss: 12.5507 - accuracy10: 0.4547 - accuracy20: 0.4607 - accuracy30: 0.4584 - accuracy50: 0.4511 - val_loss: 13.1265 - val_accuracy10: 0.3871 - val_accuracy20: 0.3973 - val_accuracy30: 0.3919 - val_accuracy50: 0.3898 - 17s/epoch - 48ms/step
Epoch 22/50
346/346 - 17s - loss: 12.5199 - accuracy10: 0.4572 - accuracy20: 0.4625 - accuracy30: 0.4603 - accuracy50: 0.4527 - val_loss: 13.1428 - val_accuracy10: 0.3945 - val_accuracy20: 0.3982 - val_accuracy30: 0.3953 - val_accuracy50: 0.3887 - 17s/epoch - 49ms/step
Epoch 23/50
346/346 - 17s - loss: 12.4957 - accuracy10: 0.4592 - accuracy20: 0.4655 - accuracy30: 0.4629 - accuracy50: 0.4548 - val_loss: 13.1689 - val_accuracy10: 0.3848 - val_accuracy20: 0.3947 - val_accuracy30: 0.3912 - val_accuracy50: 0.3904 - 17s/epoch - 49ms/step
Epoch 24/50
346/346 - 17s - loss: 12.4614 - accuracy10: 0.4622 - accuracy20: 0.4666 - accuracy30: 0.4646 - accuracy50: 0.4570 - val_loss: 13.1827 - val_accuracy10: 0.3887 - val_accuracy20: 0.3946 - val_accuracy30: 0.3921 - val_accuracy50: 0.3907 - 17s/epoch - 48ms/step
Epoch 25/50
346/346 - 17s - loss: 12.4385 - accuracy10: 0.4646 - accuracy20: 0.4705 - accuracy30: 0.4687 - accuracy50: 0.4600 - val_loss: 13.2963 - val_accuracy10: 0.3803 - val_accuracy20: 0.3851 - val_accuracy30: 0.3858 - val_accuracy50: 0.3841 - 17s/epoch - 48ms/step
Epoch 26/50
346/346 - 16s - loss: 12.4125 - accuracy10: 0.4656 - accuracy20: 0.4711 - accuracy30: 0.4703 - accuracy50: 0.4614 - val_loss: 13.3663 - val_accuracy10: 0.3798 - val_accuracy20: 0.3861 - val_accuracy30: 0.3826 - val_accuracy50: 0.3806 - 16s/epoch - 48ms/step
Epoch 27/50
346/346 - 17s - loss: 12.3890 - accuracy10: 0.4677 - accuracy20: 0.4751 - accuracy30: 0.4728 - accuracy50: 0.4652 - val_loss: 13.4327 - val_accuracy10: 0.3781 - val_accuracy20: 0.3776 - val_accuracy30: 0.3752 - val_accuracy50: 0.3723 - 17s/epoch - 49ms/step
Epoch 28/50
346/346 - 17s - loss: 12.3622 - accuracy10: 0.4690 - accuracy20: 0.4776 - accuracy30: 0.4757 - accuracy50: 0.4672 - val_loss: 13.3709 - val_accuracy10: 0.3809 - val_accuracy20: 0.3850 - val_accuracy30: 0.3779 - val_accuracy50: 0.3762 - 17s/epoch - 49ms/step
Epoch 29/50
346/346 - 17s - loss: 12.3408 - accuracy10: 0.4705 - accuracy20: 0.4781 - accuracy30: 0.4769 - accuracy50: 0.4701 - val_loss: 13.3972 - val_accuracy10: 0.3802 - val_accuracy20: 0.3877 - val_accuracy30: 0.3816 - val_accuracy50: 0.3789 - 17s/epoch - 49ms/step
testing model: results/CHTR/W4/deepLOB_L2/seq2seq
Evaluating performance on  test set...
925/925 - 16s - 16s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.065053
{'0': {'precision': 0.3667531088559002, 'recall': 0.5124393723252496, 'f1-score': 0.42752579650809897, 'support': 70100}, '1': {'precision': 0.5501309548236033, 'recall': 0.4353972833043578, 'f1-score': 0.4860855608700057, 'support': 104686}, '2': {'precision': 0.35187404955720547, 'recall': 0.31769722814498935, 'f1-score': 0.33391339779122775, 'support': 61908}, 'accuracy': 0.42742950814131325, 'macro avg': {'precision': 0.422919371078903, 'recall': 0.42184462792486555, 'f1-score': 0.4158415850564441, 'support': 236694}, 'weighted avg': {'precision': 0.443966559048602, 'recall': 0.42742950814131325, 'f1-score': 0.4289412574501867, 'support': 236694}}
[[35922 20153 14025]
 [36904 45580 22202]
 [25120 17120 19668]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0684874
{'0': {'precision': 0.3700982579295438, 'recall': 0.5244176571412515, 'f1-score': 0.433946580637661, 'support': 71178}, '1': {'precision': 0.5349308894230769, 'recall': 0.4180789854788837, 'f1-score': 0.46934112529384625, 'support': 102196}, '2': {'precision': 0.3556508532118288, 'recall': 0.31433986102337336, 'f1-score': 0.33372175881292704, 'support': 63320}, 'accuracy': 0.42230474790235495, 'macro avg': {'precision': 0.42022666685481647, 'recall': 0.4189455012145029, 'f1-score': 0.4123364882481448, 'support': 236694}, 'weighted avg': {'precision': 0.43740214371197766, 'recall': 0.42230474790235495, 'f1-score': 0.4224166946572025, 'support': 236694}}
[[37327 19852 13999]
 [37408 42726 22062]
 [26122 17294 19904]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.072483
{'0': {'precision': 0.36990007124015634, 'recall': 0.53727941382107, 'f1-score': 0.43814856204529384, 'support': 71514}, '1': {'precision': 0.5207631874298541, 'recall': 0.4022800653725037, 'f1-score': 0.45391729682624465, 'support': 100348}, '2': {'precision': 0.3606856770880422, 'recall': 0.3076721372161895, 'f1-score': 0.33207641403421156, 'support': 64832}, 'accuracy': 0.4171546384783729, 'macro avg': {'precision': 0.41711631191935084, 'recall': 0.41574387213658776, 'f1-score': 0.4080474243019167, 'support': 236694}, 'weighted avg': {'precision': 0.4313356141002792, 'recall': 0.4171546384783729, 'f1-score': 0.4157799827739324, 'support': 236694}}
[[38423 19385 13706]
 [38330 40368 21650]
 [27121 17764 19947]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0766096
{'0': {'precision': 0.3779339647362707, 'recall': 0.5498849385204047, 'f1-score': 0.4479757725011232, 'support': 73439}, '1': {'precision': 0.4870526622054117, 'recall': 0.38788772447206277, 'f1-score': 0.4318505619756213, 'support': 94945}, '2': {'precision': 0.37692704875709965, 'recall': 0.29922412531108183, 'f1-score': 0.33361079828298157, 'support': 68310}, 'accuracy': 0.4125622111249123, 'macro avg': {'precision': 0.41397122523292734, 'recall': 0.4123322627678498, 'f1-score': 0.40447904425324205, 'support': 236694}, 'weighted avg': {'precision': 0.42141412181955296, 'recall': 0.4125622111249123, 'f1-score': 0.4085016856962822, 'support': 236694}}
[[40383 19784 13272]
 [37601 36828 20516]
 [28868 19002 20440]]
Evaluating performance on  train set...
346/346 - 6s - 6s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0768405
{'0': {'precision': 0.4087492639673028, 'recall': 0.3966856028774076, 'f1-score': 0.4026270897304674, 'support': 29749}, '1': {'precision': 0.40588065724992795, 'recall': 0.4377353276451691, 'f1-score': 0.4212065813528336, 'support': 28949}, '2': {'precision': 0.4286817894515064, 'recall': 0.4086770219603642, 'f1-score': 0.4184404455869752, 'support': 29872}, 'accuracy': 0.414147002371006, 'macro avg': {'precision': 0.41443723688957906, 'recall': 0.4143659841609803, 'f1-score': 0.4140913722234254, 'support': 88570}, 'weighted avg': {'precision': 0.41453430523864576, 'recall': 0.414147002371006, 'f1-score': 0.41403314447949624, 'support': 88570}}
[[11801  9703  8245]
 [ 8252 12672  8025]
 [ 8818  8846 12208]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0743192
{'0': {'precision': 0.4067531603459747, 'recall': 0.4098756327310516, 'f1-score': 0.4083084269756725, 'support': 29831}, '1': {'precision': 0.41663050372200156, 'recall': 0.4266133442712606, 'f1-score': 0.4215628324861095, 'support': 29256}, '2': {'precision': 0.4235631982628796, 'recall': 0.41020248957026084, 'f1-score': 0.416775794334551, 'support': 29483}, 'accuracy': 0.4155131534379587, 'macro avg': {'precision': 0.4156489541102853, 'recall': 0.4155638221908577, 'f1-score': 0.415549017932111, 'support': 88570}, 'weighted avg': {'precision': 0.4156114860286341, 'recall': 0.4155131534379587, 'f1-score': 0.4155051558845035, 'support': 88570}}
[[12227  9364  8240]
 [ 8556 12481  8219]
 [ 9277  8112 12094]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0756489
{'0': {'precision': 0.40623700623700626, 'recall': 0.42285923558396593, 'f1-score': 0.4143814945922579, 'support': 30036}, '1': {'precision': 0.41527290247092025, 'recall': 0.41147786946736686, 'f1-score': 0.4133666758015895, 'support': 29326}, '2': {'precision': 0.42050483237157926, 'recall': 0.40666940564228976, 'f1-score': 0.4134714124097119, 'support': 29208}, 'accuracy': 0.4137518347070114, 'macro avg': {'precision': 0.41400491369316855, 'recall': 0.4136688368978742, 'f1-score': 0.41373986093451975, 'support': 88570}, 'weighted avg': {'precision': 0.41393398443159096, 'recall': 0.4137518347070114, 'f1-score': 0.4137453620841519, 'support': 88570}}
[[12701  9184  8151]
 [ 9041 12067  8218]
 [ 9523  7807 11878]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.080187
{'0': {'precision': 0.40274514653147026, 'recall': 0.42995280683805814, 'f1-score': 0.4159044837108334, 'support': 30301}, '1': {'precision': 0.4031483364302493, 'recall': 0.3968319701832488, 'f1-score': 0.39996521739130436, 'support': 28977}, '2': {'precision': 0.41593559334271996, 'recall': 0.3933155810460194, 'f1-score': 0.40430945236967236, 'support': 29292}, 'accuracy': 0.40700011290504684, 'macro avg': {'precision': 0.4072763587681465, 'recall': 0.4067001193557755, 'f1-score': 0.40672638449060333, 'support': 88570}, 'weighted avg': {'precision': 0.40723942000659785, 'recall': 0.40700011290504684, 'f1-score': 0.40685498864268077, 'support': 88570}}
[[13028  9248  8025]
 [ 9325 11499  8153]
 [ 9995  7776 11521]]
Evaluating performance on  val set...
127/127 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0903112
{'0': {'precision': 0.40337278726301456, 'recall': 0.3545061216975053, 'f1-score': 0.37736403723664874, 'support': 10863}, '1': {'precision': 0.3871013166232486, 'recall': 0.4995910949568378, 'f1-score': 0.4362107267534116, 'support': 11005}, '2': {'precision': 0.40464734186128387, 'recall': 0.3314428530231664, 'f1-score': 0.3644049883745508, 'support': 10403}, 'accuracy': 0.3965479842583124, 'macro avg': {'precision': 0.3983738152491823, 'recall': 0.39518002322583645, 'f1-score': 0.3926599174548704, 'support': 32271}, 'weighted avg': {'precision': 0.39823478897028025, 'recall': 0.3965479842583124, 'f1-score': 0.39325430505665965, 'support': 32271}}
[[3851 4650 2362]
 [2796 5498 2711]
 [2900 4055 3448]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0848576
{'0': {'precision': 0.4026517794836008, 'recall': 0.3726014760147601, 'f1-score': 0.3870442240429304, 'support': 10840}, '1': {'precision': 0.3999260355029586, 'recall': 0.4895427795382526, 'f1-score': 0.44021982495420314, 'support': 11045}, '2': {'precision': 0.4099770642201835, 'recall': 0.3442133641440401, 'f1-score': 0.3742279912069507, 'support': 10386}, 'accuracy': 0.40348920083046697, 'macro avg': {'precision': 0.40418495973558094, 'recall': 0.4021192065656843, 'f1-score': 0.40049734673469467, 'support': 32271}, 'weighted avg': {'precision': 0.40407641971811337, 'recall': 0.40348920083046697, 'f1-score': 0.4011192486108248, 'support': 32271}}
[[4039 4348 2453]
 [2946 5407 2692]
 [3046 3765 3575]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0866871
{'0': {'precision': 0.3994269340974212, 'recall': 0.3827567270730368, 'f1-score': 0.3909141895681436, 'support': 10926}, '1': {'precision': 0.3909042104455863, 'recall': 0.47299554565701557, 'f1-score': 0.42804954860382116, 'support': 10776}, '2': {'precision': 0.4138324583428441, 'recall': 0.34307881540353863, 'f1-score': 0.37514872484610207, 'support': 10569}, 'accuracy': 0.3998946422484584, 'macro avg': {'precision': 0.40138786762861717, 'recall': 0.39961036271119704, 'f1-score': 0.3980374876726889, 'support': 32271}, 'weighted avg': {'precision': 0.4012989280138694, 'recall': 0.3998946422484584, 'f1-score': 0.3981511959305496, 'support': 32271}}
[[4182 4230 2514]
 [3057 5097 2622]
 [3231 3712 3626]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.088537
{'0': {'precision': 0.3963023979498444, 'recall': 0.3951450994707063, 'f1-score': 0.3957229025772253, 'support': 10958}, '1': {'precision': 0.37777954256670904, 'recall': 0.4519285578567357, 'f1-score': 0.4115407907258413, 'support': 10526}, '2': {'precision': 0.4160859134011196, 'recall': 0.33762862705108, 'f1-score': 0.3727737973387922, 'support': 10787}, 'accuracy': 0.3944408292274798, 'macro avg': {'precision': 0.39672261797255765, 'recall': 0.3949007614595073, 'f1-score': 0.3933458302139529, 'support': 32271}, 'weighted avg': {'precision': 0.39687359826622826, 'recall': 0.3944408292274798, 'f1-score': 0.393211269607852, 'support': 32271}}
[[4330 4099 2529]
 [3187 4757 2582]
 [3409 3736 3642]]
training model: results/CHTR/W4/deepOF_L2/seq2seq
Epoch 1/50
346/346 - 16s - loss: 13.1602 - accuracy10: 0.3837 - accuracy20: 0.3864 - accuracy30: 0.3852 - accuracy50: 0.3836 - val_loss: 13.1347 - val_accuracy10: 0.3756 - val_accuracy20: 0.3797 - val_accuracy30: 0.3804 - val_accuracy50: 0.3808 - 16s/epoch - 47ms/step
Epoch 2/50
346/346 - 10s - loss: 13.0353 - accuracy10: 0.3982 - accuracy20: 0.4025 - accuracy30: 0.4009 - accuracy50: 0.3996 - val_loss: 12.9203 - val_accuracy10: 0.4059 - val_accuracy20: 0.4064 - val_accuracy30: 0.4079 - val_accuracy50: 0.4056 - 10s/epoch - 30ms/step
Epoch 3/50
346/346 - 10s - loss: 12.9346 - accuracy10: 0.4122 - accuracy20: 0.4164 - accuracy30: 0.4149 - accuracy50: 0.4094 - val_loss: 12.8668 - val_accuracy10: 0.4138 - val_accuracy20: 0.4168 - val_accuracy30: 0.4197 - val_accuracy50: 0.4175 - 10s/epoch - 30ms/step
Epoch 4/50
346/346 - 10s - loss: 12.8743 - accuracy10: 0.4178 - accuracy20: 0.4212 - accuracy30: 0.4206 - accuracy50: 0.4141 - val_loss: 12.8299 - val_accuracy10: 0.4150 - val_accuracy20: 0.4198 - val_accuracy30: 0.4208 - val_accuracy50: 0.4194 - 10s/epoch - 30ms/step
Epoch 5/50
346/346 - 10s - loss: 12.8125 - accuracy10: 0.4263 - accuracy20: 0.4290 - accuracy30: 0.4273 - accuracy50: 0.4201 - val_loss: 12.7844 - val_accuracy10: 0.4217 - val_accuracy20: 0.4261 - val_accuracy30: 0.4277 - val_accuracy50: 0.4233 - 10s/epoch - 30ms/step
Epoch 6/50
346/346 - 10s - loss: 12.7605 - accuracy10: 0.4324 - accuracy20: 0.4360 - accuracy30: 0.4338 - accuracy50: 0.4262 - val_loss: 12.7664 - val_accuracy10: 0.4269 - val_accuracy20: 0.4289 - val_accuracy30: 0.4305 - val_accuracy50: 0.4277 - 10s/epoch - 30ms/step
Epoch 7/50
346/346 - 10s - loss: 12.7029 - accuracy10: 0.4397 - accuracy20: 0.4427 - accuracy30: 0.4398 - accuracy50: 0.4316 - val_loss: 12.7451 - val_accuracy10: 0.4317 - val_accuracy20: 0.4327 - val_accuracy30: 0.4330 - val_accuracy50: 0.4290 - 10s/epoch - 30ms/step
Epoch 8/50
346/346 - 10s - loss: 12.6577 - accuracy10: 0.4459 - accuracy20: 0.4485 - accuracy30: 0.4440 - accuracy50: 0.4360 - val_loss: 12.7561 - val_accuracy10: 0.4309 - val_accuracy20: 0.4347 - val_accuracy30: 0.4314 - val_accuracy50: 0.4283 - 10s/epoch - 30ms/step
Epoch 9/50
346/346 - 10s - loss: 12.6062 - accuracy10: 0.4502 - accuracy20: 0.4541 - accuracy30: 0.4526 - accuracy50: 0.4438 - val_loss: 12.7500 - val_accuracy10: 0.4344 - val_accuracy20: 0.4352 - val_accuracy30: 0.4338 - val_accuracy50: 0.4306 - 10s/epoch - 30ms/step
Epoch 10/50
346/346 - 10s - loss: 12.5657 - accuracy10: 0.4542 - accuracy20: 0.4572 - accuracy30: 0.4534 - accuracy50: 0.4452 - val_loss: 12.7279 - val_accuracy10: 0.4383 - val_accuracy20: 0.4411 - val_accuracy30: 0.4409 - val_accuracy50: 0.4341 - 10s/epoch - 30ms/step
Epoch 11/50
346/346 - 10s - loss: 12.5173 - accuracy10: 0.4582 - accuracy20: 0.4621 - accuracy30: 0.4597 - accuracy50: 0.4511 - val_loss: 12.7449 - val_accuracy10: 0.4371 - val_accuracy20: 0.4406 - val_accuracy30: 0.4386 - val_accuracy50: 0.4333 - 10s/epoch - 30ms/step
Epoch 12/50
346/346 - 10s - loss: 12.4792 - accuracy10: 0.4620 - accuracy20: 0.4656 - accuracy30: 0.4637 - accuracy50: 0.4544 - val_loss: 12.7858 - val_accuracy10: 0.4369 - val_accuracy20: 0.4403 - val_accuracy30: 0.4386 - val_accuracy50: 0.4351 - 10s/epoch - 30ms/step
Epoch 13/50
346/346 - 10s - loss: 12.4342 - accuracy10: 0.4661 - accuracy20: 0.4696 - accuracy30: 0.4686 - accuracy50: 0.4573 - val_loss: 12.7789 - val_accuracy10: 0.4368 - val_accuracy20: 0.4402 - val_accuracy30: 0.4403 - val_accuracy50: 0.4338 - 10s/epoch - 30ms/step
Epoch 14/50
346/346 - 10s - loss: 12.3981 - accuracy10: 0.4697 - accuracy20: 0.4753 - accuracy30: 0.4727 - accuracy50: 0.4614 - val_loss: 12.8002 - val_accuracy10: 0.4354 - val_accuracy20: 0.4410 - val_accuracy30: 0.4425 - val_accuracy50: 0.4375 - 10s/epoch - 30ms/step
Epoch 15/50
346/346 - 10s - loss: 12.3728 - accuracy10: 0.4710 - accuracy20: 0.4773 - accuracy30: 0.4758 - accuracy50: 0.4638 - val_loss: 12.8393 - val_accuracy10: 0.4349 - val_accuracy20: 0.4392 - val_accuracy30: 0.4406 - val_accuracy50: 0.4339 - 10s/epoch - 30ms/step
Epoch 16/50
346/346 - 10s - loss: 12.3177 - accuracy10: 0.4765 - accuracy20: 0.4837 - accuracy30: 0.4806 - accuracy50: 0.4690 - val_loss: 12.8974 - val_accuracy10: 0.4332 - val_accuracy20: 0.4359 - val_accuracy30: 0.4368 - val_accuracy50: 0.4351 - 10s/epoch - 30ms/step
Epoch 17/50
346/346 - 10s - loss: 12.2856 - accuracy10: 0.4778 - accuracy20: 0.4860 - accuracy30: 0.4835 - accuracy50: 0.4730 - val_loss: 12.8894 - val_accuracy10: 0.4341 - val_accuracy20: 0.4403 - val_accuracy30: 0.4368 - val_accuracy50: 0.4324 - 10s/epoch - 30ms/step
Epoch 18/50
346/346 - 10s - loss: 12.2300 - accuracy10: 0.4828 - accuracy20: 0.4919 - accuracy30: 0.4890 - accuracy50: 0.4769 - val_loss: 12.9432 - val_accuracy10: 0.4337 - val_accuracy20: 0.4394 - val_accuracy30: 0.4396 - val_accuracy50: 0.4339 - 10s/epoch - 30ms/step
Epoch 19/50
346/346 - 10s - loss: 12.2034 - accuracy10: 0.4844 - accuracy20: 0.4945 - accuracy30: 0.4925 - accuracy50: 0.4793 - val_loss: 12.9976 - val_accuracy10: 0.4241 - val_accuracy20: 0.4297 - val_accuracy30: 0.4314 - val_accuracy50: 0.4269 - 10s/epoch - 30ms/step
Epoch 20/50
346/346 - 11s - loss: 12.1560 - accuracy10: 0.4877 - accuracy20: 0.4991 - accuracy30: 0.4969 - accuracy50: 0.4848 - val_loss: 13.0284 - val_accuracy10: 0.4313 - val_accuracy20: 0.4376 - val_accuracy30: 0.4374 - val_accuracy50: 0.4334 - 11s/epoch - 30ms/step
testing model: results/CHTR/W4/deepOF_L2/seq2seq
Evaluating performance on  test set...
925/925 - 10s - 10s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.055515
{'0': {'precision': 0.397003025305313, 'recall': 0.5597369434656699, 'f1-score': 0.4645301067885303, 'support': 70099}, '1': {'precision': 0.6035534258510175, 'recall': 0.37058548188340035, 'f1-score': 0.45921199817707253, 'support': 104683}, '2': {'precision': 0.3556352862831437, 'recall': 0.42269173612457195, 'f1-score': 0.3862749005454317, 'support': 61908}, 'accuracy': 0.4402340614305632, 'macro avg': {'precision': 0.45206391247982475, 'recall': 0.45100472049121404, 'f1-score': 0.4366723351703448, 'support': 236690}, 'weighted avg': {'precision': 0.47753588090944293, 'recall': 0.4402340614305632, 'f1-score': 0.44170979806458344, 'support': 236690}}
[[39237 12596 18266]
 [36742 38794 29147]
 [22854 12886 26168]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0585116
{'0': {'precision': 0.3989074851224594, 'recall': 0.5622321817441027, 'f1-score': 0.4666931007137192, 'support': 71177}, '1': {'precision': 0.5844409631938501, 'recall': 0.35411427397179845, 'f1-score': 0.44101589158623383, 'support': 102193}, '2': {'precision': 0.3570085424165906, 'recall': 0.41977258370183196, 'f1-score': 0.3858548906889644, 'support': 63320}, 'accuracy': 0.43426422747053106, 'macro avg': {'precision': 0.44678566357763333, 'recall': 0.4453730131392444, 'f1-score': 0.4311879609963058, 'support': 236690}, 'weighted avg': {'precision': 0.46780427701233224, 'recall': 0.43426422747053106, 'f1-score': 0.4339806646533339, 'support': 236690}}
[[40018 12742 18417]
 [36550 36188 29455]
 [23751 12989 26580]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0623966
{'0': {'precision': 0.39868130999100443, 'recall': 0.5639595044326985, 'f1-score': 0.4671318951788041, 'support': 71514}, '1': {'precision': 0.5692312775694295, 'recall': 0.3433619675921312, 'f1-score': 0.42834498834498835, 'support': 100346}, '2': {'precision': 0.35778666666666664, 'recall': 0.41391331173839274, 'f1-score': 0.3838089108202818, 'support': 64830}, 'accuracy': 0.4293379525962229, 'macro avg': {'precision': 0.44189975140903354, 'recall': 0.44041159458774076, 'f1-score': 0.4264285981146914, 'support': 236690}, 'weighted avg': {'precision': 0.4597857390750714, 'recall': 0.4293379525962229, 'f1-score': 0.42786559736685986, 'support': 236690}}
[[40331 12818 18365]
 [36090 34455 29801]
 [24740 13256 26834]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0689507
{'0': {'precision': 0.40285525940356365, 'recall': 0.5575527322739219, 'f1-score': 0.4677450677999018, 'support': 73437}, '1': {'precision': 0.5267209993653763, 'recall': 0.33218178945705407, 'f1-score': 0.4074200861629086, 'support': 94945}, '2': {'precision': 0.36389757233122716, 'recall': 0.40048017801721614, 'f1-score': 0.3813134657067388, 'support': 68308}, 'accuracy': 0.42181756728209896, 'macro avg': {'precision': 0.4311579437000557, 'recall': 0.43007156658273066, 'f1-score': 0.4188262065565164, 'support': 236690}, 'weighted avg': {'precision': 0.4412992620743023, 'recall': 0.42181756728209896, 'f1-score': 0.418602623010075, 'support': 236690}}
[[40945 13747 18745]
 [34332 31539 29074]
 [26360 14592 27356]]
Evaluating performance on  train set...
346/346 - 4s - 4s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0488627
{'0': {'precision': 0.4566489162229056, 'recall': 0.4103730664240218, 'f1-score': 0.4322760432382542, 'support': 29673}, '1': {'precision': 0.4693978504294644, 'recall': 0.3591508103086399, 'f1-score': 0.4069395711500975, 'support': 29063}, '2': {'precision': 0.43974688650229415, 'recall': 0.5846880970737103, 'f1-score': 0.5019640570367919, 'support': 29833}, 'accuracy': 0.4522801431652158, 'macro avg': {'precision': 0.4552645510515547, 'recall': 0.45140399126879066, 'f1-score': 0.44705989047504785, 'support': 88569}, 'weighted avg': {'precision': 0.45513917830320705, 'recall': 0.4522801431652158, 'f1-score': 0.4474353950131831, 'support': 88569}}
[[12177  6246 11250]
 [ 7652 10438 10973]
 [ 6837  5553 17443]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0494974
{'0': {'precision': 0.4549735138316657, 'recall': 0.41525651356432985, 'f1-score': 0.4342086785563825, 'support': 29784}, '1': {'precision': 0.47708285252711746, 'recall': 0.3528247141150367, 'f1-score': 0.40565149136577705, 'support': 29295}, '2': {'precision': 0.43680765357502516, 'recall': 0.58833502882333, 'f1-score': 0.5013726340124259, 'support': 29490}, 'accuracy': 0.45223498063656586, 'macro avg': {'precision': 0.45628800664460273, 'recall': 0.4521387521675655, 'f1-score': 0.44707760131152846, 'support': 88569}, 'weighted avg': {'precision': 0.456237859800514, 'recall': 0.45223498063656586, 'f1-score': 0.44712609037823814, 'support': 88569}}
[[12368  6052 11364]
 [ 7953 10336 11006]
 [ 6863  5277 17350]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0524589
{'0': {'precision': 0.453034262485482, 'recall': 0.4159280239920027, 'f1-score': 0.4336888919773462, 'support': 30010}, '1': {'precision': 0.4757086907870198, 'recall': 0.3478097835350264, 'f1-score': 0.4018273831794104, 'support': 29335}, '2': {'precision': 0.43271247693901793, 'recall': 0.585888310977279, 'f1-score': 0.49778320468652343, 'support': 29224}, 'accuracy': 0.4494461944924296, 'macro avg': {'precision': 0.4538184767371732, 'recall': 0.44987537283476936, 'f1-score': 0.44443315994776, 'support': 88569}, 'weighted avg': {'precision': 0.45383895141067865, 'recall': 0.4494461944924296, 'f1-score': 0.44428441449680056, 'support': 88569}}
[[12482  6069 11459]
 [ 8144 10203 10988]
 [ 6926  5176 17122]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0615026
{'0': {'precision': 0.4433085835216471, 'recall': 0.4074977744073329, 'f1-score': 0.4246495327102804, 'support': 30329}, '1': {'precision': 0.45816640268331316, 'recall': 0.3393836916387729, 'f1-score': 0.3899296263257012, 'support': 28979}, '2': {'precision': 0.42573424434019985, 'recall': 0.570691363931513, 'f1-score': 0.4876688325910783, 'support': 29261}, 'accuracy': 0.4391265566959094, 'macro avg': {'precision': 0.4424030768483867, 'recall': 0.43919094332587294, 'f1-score': 0.43408266387568667, 'support': 88569}, 'weighted avg': {'precision': 0.4423638060340114, 'recall': 0.4391265566959094, 'f1-score': 0.4341094968816418, 'support': 88569}}
[[12359  6288 11682]
 [ 8301  9835 10843]
 [ 7219  5343 16699]]
Evaluating performance on  val set...
127/127 - 1s - 1s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0606303
{'0': {'precision': 0.4600622406639004, 'recall': 0.40676877923507293, 'f1-score': 0.43177724772428566, 'support': 10903}, '1': {'precision': 0.46240460402852496, 'recall': 0.3356033778262054, 'f1-score': 0.38892981163843, 'support': 11013}, '2': {'precision': 0.4095101455216233, 'recall': 0.5789067027235851, 'f1-score': 0.47969268936817255, 'support': 10354}, 'accuracy': 0.437713046172916, 'macro avg': {'precision': 0.44399233007134953, 'recall': 0.4404262865949545, 'f1-score': 0.4334665829102961, 'support': 32270}, 'weighted avg': {'precision': 0.44464172794718126, 'recall': 0.437713046172916, 'f1-score': 0.43252833756523007, 'support': 32270}}
[[4435 2300 4168]
 [2842 3696 4475]
 [2363 1997 5994]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0580515
{'0': {'precision': 0.45487730683431354, 'recall': 0.4123161764705882, 'f1-score': 0.43255230932407673, 'support': 10880}, '1': {'precision': 0.4724521469218831, 'recall': 0.3317591499409681, 'f1-score': 0.3897988582404098, 'support': 11011}, '2': {'precision': 0.41026165167620604, 'recall': 0.580113691107043, 'f1-score': 0.4806226302135302, 'support': 10379}, 'accuracy': 0.4387976448713976, 'macro avg': {'precision': 0.4458637018108009, 'recall': 0.4413963391728664, 'f1-score': 0.4343245992593389, 'support': 32270}, 'weighted avg': {'precision': 0.44652436848036964, 'recall': 0.4387976448713976, 'f1-score': 0.43342505833645295, 'support': 32270}}
[[4486 2149 4245]
 [2948 3653 4410]
 [2428 1930 6021]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0597903
{'0': {'precision': 0.4564236285227159, 'recall': 0.4150857351331631, 'f1-score': 0.4347743014091235, 'support': 10964}, '1': {'precision': 0.4612051988972036, 'recall': 0.32533802556028896, 'f1-score': 0.3815367906597882, 'support': 10798}, '2': {'precision': 0.4160877264677837, 'recall': 0.5813665778454511, 'f1-score': 0.48503374354902745, 'support': 10508}, 'accuracy': 0.43920049581654785, 'macro avg': {'precision': 0.44457218462923437, 'recall': 0.4405967795129677, 'f1-score': 0.43378161187264636, 'support': 32270}, 'weighted avg': {'precision': 0.4448891301685321, 'recall': 0.43920049581654785, 'f1-score': 0.43332613211674015, 'support': 32270}}
[[4551 2138 4275]
 [2987 3513 4298]
 [2433 1966 6109]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0648159
{'0': {'precision': 0.4503074786748661, 'recall': 0.41310282074613286, 'f1-score': 0.43090356871678054, 'support': 10990}, '1': {'precision': 0.43687002652519896, 'recall': 0.31326676176890156, 'f1-score': 0.3648850733868734, 'support': 10515}, '2': {'precision': 0.4208765701802294, 'recall': 0.5726892707849512, 'f1-score': 0.4851847479636407, 'support': 10765}, 'accuracy': 0.4338084908583824, 'macro avg': {'precision': 0.43601802512676474, 'recall': 0.4330196177666619, 'f1-score': 0.42699113002243155, 'support': 32270}, 'weighted avg': {'precision': 0.4361110566327677, 'recall': 0.4338084908583824, 'f1-score': 0.4274995531047098, 'support': 32270}}
[[4540 2187 4263]
 [3001 3294 4220]
 [2541 2059 6165]]
training model: results/CHTR/W4/deepVOL_L2/seq2seq
Epoch 1/50
346/346 - 17s - loss: 13.1692 - accuracy10: 0.3702 - accuracy20: 0.3744 - accuracy30: 0.3775 - accuracy50: 0.3759 - val_loss: 13.2872 - val_accuracy10: 0.3353 - val_accuracy20: 0.3399 - val_accuracy30: 0.3434 - val_accuracy50: 0.3484 - 17s/epoch - 49ms/step
Epoch 2/50
346/346 - 11s - loss: 13.0923 - accuracy10: 0.3739 - accuracy20: 0.3816 - accuracy30: 0.3847 - accuracy50: 0.3836 - val_loss: 13.2536 - val_accuracy10: 0.3503 - val_accuracy20: 0.3542 - val_accuracy30: 0.3568 - val_accuracy50: 0.3534 - 11s/epoch - 31ms/step
Epoch 3/50
346/346 - 10s - loss: 13.0919 - accuracy10: 0.3773 - accuracy20: 0.3832 - accuracy30: 0.3825 - accuracy50: 0.3814 - val_loss: 13.1602 - val_accuracy10: 0.3528 - val_accuracy20: 0.3573 - val_accuracy30: 0.3588 - val_accuracy50: 0.3600 - 10s/epoch - 30ms/step
Epoch 4/50
346/346 - 10s - loss: 13.0695 - accuracy10: 0.3809 - accuracy20: 0.3877 - accuracy30: 0.3891 - accuracy50: 0.3875 - val_loss: 13.2249 - val_accuracy10: 0.3618 - val_accuracy20: 0.3633 - val_accuracy30: 0.3644 - val_accuracy50: 0.3587 - 10s/epoch - 30ms/step
Epoch 5/50
346/346 - 10s - loss: 13.0630 - accuracy10: 0.3813 - accuracy20: 0.3879 - accuracy30: 0.3894 - accuracy50: 0.3875 - val_loss: 13.1614 - val_accuracy10: 0.3565 - val_accuracy20: 0.3549 - val_accuracy30: 0.3523 - val_accuracy50: 0.3488 - 10s/epoch - 30ms/step
Epoch 6/50
346/346 - 10s - loss: 13.0525 - accuracy10: 0.3856 - accuracy20: 0.3902 - accuracy30: 0.3901 - accuracy50: 0.3862 - val_loss: 13.1407 - val_accuracy10: 0.3674 - val_accuracy20: 0.3680 - val_accuracy30: 0.3667 - val_accuracy50: 0.3631 - 10s/epoch - 29ms/step
Epoch 7/50
346/346 - 10s - loss: 13.0549 - accuracy10: 0.3859 - accuracy20: 0.3911 - accuracy30: 0.3919 - accuracy50: 0.3889 - val_loss: 13.1765 - val_accuracy10: 0.3679 - val_accuracy20: 0.3695 - val_accuracy30: 0.3653 - val_accuracy50: 0.3609 - 10s/epoch - 30ms/step
Epoch 8/50
346/346 - 10s - loss: 13.0728 - accuracy10: 0.3823 - accuracy20: 0.3904 - accuracy30: 0.3898 - accuracy50: 0.3866 - val_loss: 13.1634 - val_accuracy10: 0.3678 - val_accuracy20: 0.3697 - val_accuracy30: 0.3698 - val_accuracy50: 0.3644 - 10s/epoch - 30ms/step
Epoch 9/50
346/346 - 10s - loss: 13.0590 - accuracy10: 0.3829 - accuracy20: 0.3886 - accuracy30: 0.3905 - accuracy50: 0.3871 - val_loss: 13.1073 - val_accuracy10: 0.3638 - val_accuracy20: 0.3678 - val_accuracy30: 0.3680 - val_accuracy50: 0.3612 - 10s/epoch - 29ms/step
Epoch 10/50
346/346 - 10s - loss: 13.0436 - accuracy10: 0.3864 - accuracy20: 0.3906 - accuracy30: 0.3902 - accuracy50: 0.3850 - val_loss: 13.1008 - val_accuracy10: 0.3659 - val_accuracy20: 0.3677 - val_accuracy30: 0.3725 - val_accuracy50: 0.3703 - 10s/epoch - 29ms/step
Epoch 11/50
346/346 - 11s - loss: 13.0231 - accuracy10: 0.3917 - accuracy20: 0.3974 - accuracy30: 0.3960 - accuracy50: 0.3882 - val_loss: 13.1080 - val_accuracy10: 0.3724 - val_accuracy20: 0.3702 - val_accuracy30: 0.3665 - val_accuracy50: 0.3621 - 11s/epoch - 31ms/step
Epoch 12/50
346/346 - 10s - loss: 13.0340 - accuracy10: 0.3859 - accuracy20: 0.3906 - accuracy30: 0.3911 - accuracy50: 0.3845 - val_loss: 13.0993 - val_accuracy10: 0.3729 - val_accuracy20: 0.3735 - val_accuracy30: 0.3694 - val_accuracy50: 0.3642 - 10s/epoch - 30ms/step
Epoch 13/50
346/346 - 10s - loss: 13.0036 - accuracy10: 0.3921 - accuracy20: 0.3976 - accuracy30: 0.3985 - accuracy50: 0.3910 - val_loss: 13.0313 - val_accuracy10: 0.3719 - val_accuracy20: 0.3773 - val_accuracy30: 0.3866 - val_accuracy50: 0.3829 - 10s/epoch - 30ms/step
Epoch 14/50
346/346 - 11s - loss: 12.9836 - accuracy10: 0.3956 - accuracy20: 0.3989 - accuracy30: 0.4007 - accuracy50: 0.3929 - val_loss: 13.0396 - val_accuracy10: 0.3744 - val_accuracy20: 0.3767 - val_accuracy30: 0.3766 - val_accuracy50: 0.3718 - 11s/epoch - 30ms/step
Epoch 15/50
346/346 - 11s - loss: 12.9671 - accuracy10: 0.3990 - accuracy20: 0.4048 - accuracy30: 0.4026 - accuracy50: 0.3931 - val_loss: 12.9948 - val_accuracy10: 0.3994 - val_accuracy20: 0.4064 - val_accuracy30: 0.4047 - val_accuracy50: 0.3943 - 11s/epoch - 31ms/step
Epoch 16/50
346/346 - 11s - loss: 12.9380 - accuracy10: 0.4030 - accuracy20: 0.4081 - accuracy30: 0.4089 - accuracy50: 0.4004 - val_loss: 13.1126 - val_accuracy10: 0.3762 - val_accuracy20: 0.3759 - val_accuracy30: 0.3735 - val_accuracy50: 0.3629 - 11s/epoch - 30ms/step
Epoch 17/50
346/346 - 11s - loss: 12.9290 - accuracy10: 0.4054 - accuracy20: 0.4084 - accuracy30: 0.4078 - accuracy50: 0.3980 - val_loss: 13.0234 - val_accuracy10: 0.3778 - val_accuracy20: 0.3850 - val_accuracy30: 0.3851 - val_accuracy50: 0.3776 - 11s/epoch - 31ms/step
Epoch 18/50
346/346 - 10s - loss: 12.9345 - accuracy10: 0.4048 - accuracy20: 0.4070 - accuracy30: 0.4052 - accuracy50: 0.3953 - val_loss: 12.9805 - val_accuracy10: 0.3968 - val_accuracy20: 0.4053 - val_accuracy30: 0.4061 - val_accuracy50: 0.3920 - 10s/epoch - 30ms/step
Epoch 19/50
346/346 - 11s - loss: 12.8989 - accuracy10: 0.4079 - accuracy20: 0.4121 - accuracy30: 0.4107 - accuracy50: 0.4015 - val_loss: 12.9808 - val_accuracy10: 0.4117 - val_accuracy20: 0.4108 - val_accuracy30: 0.4028 - val_accuracy50: 0.3890 - 11s/epoch - 31ms/step
Epoch 20/50
346/346 - 11s - loss: 12.8868 - accuracy10: 0.4102 - accuracy20: 0.4141 - accuracy30: 0.4118 - accuracy50: 0.4014 - val_loss: 12.9733 - val_accuracy10: 0.4051 - val_accuracy20: 0.4152 - val_accuracy30: 0.4112 - val_accuracy50: 0.3934 - 11s/epoch - 31ms/step
Epoch 21/50
346/346 - 10s - loss: 12.8783 - accuracy10: 0.4091 - accuracy20: 0.4133 - accuracy30: 0.4133 - accuracy50: 0.4031 - val_loss: 13.0516 - val_accuracy10: 0.3804 - val_accuracy20: 0.3826 - val_accuracy30: 0.3816 - val_accuracy50: 0.3735 - 10s/epoch - 29ms/step
Epoch 22/50
346/346 - 11s - loss: 12.8652 - accuracy10: 0.4111 - accuracy20: 0.4154 - accuracy30: 0.4143 - accuracy50: 0.4058 - val_loss: 12.9399 - val_accuracy10: 0.4166 - val_accuracy20: 0.4142 - val_accuracy30: 0.4066 - val_accuracy50: 0.3932 - 11s/epoch - 31ms/step
Epoch 23/50
346/346 - 11s - loss: 12.8395 - accuracy10: 0.4151 - accuracy20: 0.4187 - accuracy30: 0.4158 - accuracy50: 0.4082 - val_loss: 12.9663 - val_accuracy10: 0.4107 - val_accuracy20: 0.4110 - val_accuracy30: 0.4062 - val_accuracy50: 0.3900 - 11s/epoch - 31ms/step
Epoch 24/50
346/346 - 11s - loss: 12.8250 - accuracy10: 0.4164 - accuracy20: 0.4214 - accuracy30: 0.4196 - accuracy50: 0.4080 - val_loss: 13.1017 - val_accuracy10: 0.3793 - val_accuracy20: 0.3799 - val_accuracy30: 0.3760 - val_accuracy50: 0.3693 - 11s/epoch - 30ms/step
Epoch 25/50
346/346 - 10s - loss: 12.8189 - accuracy10: 0.4167 - accuracy20: 0.4201 - accuracy30: 0.4185 - accuracy50: 0.4085 - val_loss: 12.9714 - val_accuracy10: 0.4030 - val_accuracy20: 0.4144 - val_accuracy30: 0.4083 - val_accuracy50: 0.3950 - 10s/epoch - 30ms/step
Epoch 26/50
346/346 - 11s - loss: 12.7993 - accuracy10: 0.4184 - accuracy20: 0.4217 - accuracy30: 0.4205 - accuracy50: 0.4100 - val_loss: 13.0125 - val_accuracy10: 0.3879 - val_accuracy20: 0.3881 - val_accuracy30: 0.3904 - val_accuracy50: 0.3826 - 11s/epoch - 31ms/step
Epoch 27/50
346/346 - 10s - loss: 12.7934 - accuracy10: 0.4175 - accuracy20: 0.4230 - accuracy30: 0.4211 - accuracy50: 0.4108 - val_loss: 12.9606 - val_accuracy10: 0.4152 - val_accuracy20: 0.4146 - val_accuracy30: 0.4087 - val_accuracy50: 0.3926 - 10s/epoch - 30ms/step
Epoch 28/50
346/346 - 10s - loss: 12.7760 - accuracy10: 0.4214 - accuracy20: 0.4253 - accuracy30: 0.4240 - accuracy50: 0.4125 - val_loss: 13.0196 - val_accuracy10: 0.3862 - val_accuracy20: 0.3943 - val_accuracy30: 0.3964 - val_accuracy50: 0.3904 - 10s/epoch - 30ms/step
Epoch 29/50
346/346 - 10s - loss: 12.7531 - accuracy10: 0.4219 - accuracy20: 0.4272 - accuracy30: 0.4263 - accuracy50: 0.4166 - val_loss: 12.9967 - val_accuracy10: 0.3951 - val_accuracy20: 0.4026 - val_accuracy30: 0.4035 - val_accuracy50: 0.3914 - 10s/epoch - 29ms/step
Epoch 30/50
346/346 - 10s - loss: 12.7363 - accuracy10: 0.4247 - accuracy20: 0.4275 - accuracy30: 0.4269 - accuracy50: 0.4175 - val_loss: 13.0614 - val_accuracy10: 0.3827 - val_accuracy20: 0.3865 - val_accuracy30: 0.3861 - val_accuracy50: 0.3808 - 10s/epoch - 30ms/step
Epoch 31/50
346/346 - 10s - loss: 12.7484 - accuracy10: 0.4219 - accuracy20: 0.4275 - accuracy30: 0.4264 - accuracy50: 0.4174 - val_loss: 12.9729 - val_accuracy10: 0.4132 - val_accuracy20: 0.4185 - val_accuracy30: 0.4114 - val_accuracy50: 0.3970 - 10s/epoch - 30ms/step
Epoch 32/50
346/346 - 10s - loss: 12.7235 - accuracy10: 0.4260 - accuracy20: 0.4313 - accuracy30: 0.4279 - accuracy50: 0.4188 - val_loss: 13.0566 - val_accuracy10: 0.3847 - val_accuracy20: 0.3849 - val_accuracy30: 0.3859 - val_accuracy50: 0.3824 - 10s/epoch - 29ms/step
testing model: results/CHTR/W4/deepVOL_L2/seq2seq
Evaluating performance on  test set...
925/925 - 10s - 10s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0599289
{'0': {'precision': 0.37515235231981797, 'recall': 0.2634522111269615, 'f1-score': 0.3095333869670153, 'support': 70100}, '1': {'precision': 0.505865435019764, 'recall': 0.6821446993867375, 'f1-score': 0.5809267364105234, 'support': 104686}, '2': {'precision': 0.3722246220302376, 'recall': 0.27838082315694257, 'f1-score': 0.31853467396125984, 'support': 61908}, 'accuracy': 0.45253787590728956, 'macro avg': {'precision': 0.4177474697899399, 'recall': 0.40799257789021387, 'f1-score': 0.40299826577959946, 'support': 236694}, 'weighted avg': {'precision': 0.43219891813373473, 'recall': 0.45253787590728956, 'f1-score': 0.4319206712035519, 'support': 236694}}
[[18468 37522 14110]
 [18319 71411 14956]
 [12441 32233 17234]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0611491
{'0': {'precision': 0.38688988838913874, 'recall': 0.26103571328219394, 'f1-score': 0.3117397359104713, 'support': 71178}, '1': {'precision': 0.49158309073179063, 'recall': 0.6757896590864613, 'f1-score': 0.5691528594444696, 'support': 102196}, '2': {'precision': 0.3719047717885386, 'recall': 0.2829753632343651, 'f1-score': 0.3214019856680329, 'support': 63320}, 'accuracy': 0.44598088671449215, 'macro avg': {'precision': 0.41679258363648936, 'recall': 0.40660024520100685, 'f1-score': 0.4007648603409913, 'support': 236694}, 'weighted avg': {'precision': 0.42808387270416004, 'recall': 0.44598088671449215, 'f1-score': 0.42546634168556186, 'support': 236694}}
[[18580 37931 14667]
 [17539 69063 15594]
 [11905 33497 17918]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0648949
{'0': {'precision': 0.3853970404555751, 'recall': 0.2545655396146209, 'f1-score': 0.30660794435415284, 'support': 71514}, '1': {'precision': 0.4807148293341375, 'recall': 0.6672081157571651, 'f1-score': 0.5588124827856743, 'support': 100348}, '2': {'precision': 0.3698359871659459, 'recall': 0.28624753208292203, 'f1-score': 0.3227169575084123, 'support': 64832}, 'accuracy': 0.43818601231970394, 'macro avg': {'precision': 0.41198261898521943, 'recall': 0.40267372915156935, 'f1-score': 0.3960457948827465, 'support': 236694}, 'weighted avg': {'precision': 0.42154538080857407, 'recall': 0.43818601231970394, 'f1-score': 0.4179441022768009, 'support': 236694}}
[[18205 37703 15606]
 [17380 66953 16015]
 [11652 34622 18558]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0759406
{'0': {'precision': 0.38872257623059486, 'recall': 0.24753877367611216, 'f1-score': 0.30246661952497816, 'support': 73439}, '1': {'precision': 0.44614760511141377, 'recall': 0.6486702827953026, 'f1-score': 0.5286773195301067, 'support': 94945}, '2': {'precision': 0.3654498496646365, 'recall': 0.2775728297467428, 'f1-score': 0.3155065976671048, 'support': 68310}, 'accuracy': 0.41711238983666676, 'macro avg': {'precision': 0.400106677002215, 'recall': 0.39126062873938583, 'f1-score': 0.38221684557406316, 'support': 236694}, 'weighted avg': {'precision': 0.4050409426250482, 'recall': 0.41711238983666676, 'f1-score': 0.3969698000824726, 'support': 236694}}
[[18179 39001 16259]
 [16693 61588 16664]
 [11894 37455 18961]]
Evaluating performance on  train set...
346/346 - 4s - 4s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0671169
{'0': {'precision': 0.42781917536015895, 'recall': 0.2894887223099936, 'f1-score': 0.3453156639066541, 'support': 29749}, '1': {'precision': 0.4003662920840211, 'recall': 0.6116618881481226, 'f1-score': 0.48395648846616374, 'support': 28949}, '2': {'precision': 0.4362945525131128, 'recall': 0.3536422067487949, 'f1-score': 0.3906443561061292, 'support': 29872}, 'accuracy': 0.416427684317489, 'macro avg': {'precision': 0.42149333998576427, 'recall': 0.41826427240230374, 'f1-score': 0.40663883615964896, 'support': 88570}, 'weighted avg': {'precision': 0.42170472293103084, 'recall': 0.416427684317489, 'f1-score': 0.40591825985964003, 'support': 88570}}
[[ 8612 13549  7588]
 [ 5181 17707  6061]
 [ 6337 12971 10564]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.067288
{'0': {'precision': 0.43383043070184585, 'recall': 0.2789044953236566, 'f1-score': 0.3395294741782121, 'support': 29831}, '1': {'precision': 0.40193497581280235, 'recall': 0.6106097894449002, 'f1-score': 0.4847695417972619, 'support': 29256}, '2': {'precision': 0.43107387661843105, 'recall': 0.3647525692772106, 'f1-score': 0.3951497336027926, 'support': 29483}, 'accuracy': 0.41704866207519475, 'macro avg': {'precision': 0.42227976104435977, 'recall': 0.4180889513485891, 'f1-score': 0.4064829165260888, 'support': 88570}, 'weighted avg': {'precision': 0.4223772872867485, 'recall': 0.41704866207519475, 'f1-score': 0.40601920576766487, 'support': 88570}}
[[ 8320 13765  7746]
 [ 4945 17864  6447]
 [ 5913 12816 10754]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0690012
{'0': {'precision': 0.4374932410511517, 'recall': 0.269376747902517, 'f1-score': 0.3334432309911395, 'support': 30036}, '1': {'precision': 0.40234366197183097, 'recall': 0.6088112937325241, 'f1-score': 0.484498175058683, 'support': 29326}, '2': {'precision': 0.42224037975176065, 'recall': 0.37154204327581486, 'f1-score': 0.3952721776029431, 'support': 29208}, 'accuracy': 0.41545670091453085, 'macro avg': {'precision': 0.4206924275915811, 'recall': 0.4165766949702853, 'f1-score': 0.4044045278842552, 'support': 88570}, 'weighted avg': {'precision': 0.42082504494736067, 'recall': 0.41545670091453085, 'f1-score': 0.4038478506407087, 'support': 88570}}
[[ 8091 13746  8199]
 [ 4822 17854  6650]
 [ 5581 12775 10852]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0771334
{'0': {'precision': 0.4285952804986643, 'recall': 0.2541500280518795, 'f1-score': 0.31908678447865096, 'support': 30301}, '1': {'precision': 0.3882398051245038, 'recall': 0.5940228457052145, 'f1-score': 0.4695756550679961, 'support': 28977}, '2': {'precision': 0.4109875885174751, 'recall': 0.3685306568346306, 'f1-score': 0.3886029014723352, 'support': 29292}, 'accuracy': 0.4031726318166422, 'macro avg': {'precision': 0.4092742247135477, 'recall': 0.4055678435305749, 'f1-score': 0.39242178033966074, 'support': 88570}, 'weighted avg': {'precision': 0.40956914158672975, 'recall': 0.4031726318166422, 'f1-score': 0.3913119408752464, 'support': 88570}}
[[ 7701 14030  8570]
 [ 4863 17213  6901]
 [ 5404 13093 10795]]
Evaluating performance on  val set...
127/127 - 1s - 1s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0737978
{'0': {'precision': 0.4173248737537226, 'recall': 0.2966952039031575, 'f1-score': 0.3468201872377058, 'support': 10863}, '1': {'precision': 0.4201549418967887, 'recall': 0.611085870059064, 'f1-score': 0.4979452815519603, 'support': 11005}, '2': {'precision': 0.40950597049871224, 'recall': 0.33624915889647217, 'f1-score': 0.36927949326999204, 'support': 10403}, 'accuracy': 0.41665891977317093, 'macro avg': {'precision': 0.41566192871640784, 'recall': 0.4146767442862312, 'f1-score': 0.40468165401988604, 'support': 32271}, 'weighted avg': {'precision': 0.4157694478094559, 'recall': 0.41665891977317093, 'f1-score': 0.40559666839980935, 'support': 32271}}
[[3223 4794 2846]
 [2082 6725 2198]
 [2418 4487 3498]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0759218
{'0': {'precision': 0.4235133287764867, 'recall': 0.28579335793357935, 'f1-score': 0.3412833930046819, 'support': 10840}, '1': {'precision': 0.41600741656365886, 'recall': 0.6094160253508375, 'f1-score': 0.49447199265381087, 'support': 11045}, '2': {'precision': 0.3998404740200547, 'recall': 0.3378586558829193, 'f1-score': 0.36624569460390355, 'support': 10386}, 'accuracy': 0.413312261783025, 'macro avg': {'precision': 0.41312040645340004, 'recall': 0.4110226797224454, 'f1-score': 0.4006670267541321, 'support': 32271}, 'weighted avg': {'precision': 0.41332557289997257, 'recall': 0.413312261783025, 'f1-score': 0.40174717000366383, 'support': 32271}}
[[3098 4835 2907]
 [1954 6731 2360]
 [2263 4614 3509]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0784063
{'0': {'precision': 0.4229839283174513, 'recall': 0.2721947647812557, 'f1-score': 0.3312357297989642, 'support': 10926}, '1': {'precision': 0.40484129924663453, 'recall': 0.6083890126206385, 'f1-score': 0.48616981831664813, 'support': 10776}, '2': {'precision': 0.3977448596064559, 'recall': 0.34042955814173526, 'f1-score': 0.36686209533520264, 'support': 10569}, 'accuracy': 0.4068048712466301, 'macro avg': {'precision': 0.40852336239018056, 'recall': 0.4070044451812098, 'f1-score': 0.39475588115027166, 'support': 32271}, 'weighted avg': {'precision': 0.4086597149967104, 'recall': 0.4068048712466301, 'f1-score': 0.3946395535174442, 'support': 32271}}
[[2974 4857 3095]
 [1867 6556 2353]
 [2190 4781 3598]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0863681
{'0': {'precision': 0.40935498286906, 'recall': 0.25077568899434205, 'f1-score': 0.3110180521758814, 'support': 10958}, '1': {'precision': 0.38637900301186306, 'recall': 0.5971879156374691, 'f1-score': 0.46919201343534245, 'support': 10526}, '2': {'precision': 0.39153837872752717, 'recall': 0.3371651061462872, 'f1-score': 0.36232317194660296, 'support': 10787}, 'accuracy': 0.3926435499364755, 'macro avg': {'precision': 0.3957574548694834, 'recall': 0.39504290359269945, 'f1-score': 0.3808444125192756, 'support': 32271}, 'weighted avg': {'precision': 0.3959053571105905, 'recall': 0.3926435499364755, 'f1-score': 0.3797598774426491, 'support': 32271}}
[[2748 4984 3226]
 [1814 6286 2426]
 [2151 4999 3637]]
training model: results/CHTR/W4/deepVOL_L3/seq2seq
Epoch 1/50
346/346 - 21s - loss: 13.1560 - accuracy10: 0.3709 - accuracy20: 0.3774 - accuracy30: 0.3790 - accuracy50: 0.3776 - val_loss: 13.4264 - val_accuracy10: 0.3305 - val_accuracy20: 0.3347 - val_accuracy30: 0.3404 - val_accuracy50: 0.3389 - 21s/epoch - 61ms/step
Epoch 2/50
346/346 - 15s - loss: 13.1154 - accuracy10: 0.3758 - accuracy20: 0.3786 - accuracy30: 0.3802 - accuracy50: 0.3805 - val_loss: 13.3558 - val_accuracy10: 0.3410 - val_accuracy20: 0.3416 - val_accuracy30: 0.3431 - val_accuracy50: 0.3403 - 15s/epoch - 44ms/step
Epoch 3/50
346/346 - 15s - loss: 13.1580 - accuracy10: 0.3597 - accuracy20: 0.3658 - accuracy30: 0.3672 - accuracy50: 0.3680 - val_loss: 13.1479 - val_accuracy10: 0.3672 - val_accuracy20: 0.3674 - val_accuracy30: 0.3600 - val_accuracy50: 0.3505 - 15s/epoch - 44ms/step
Epoch 4/50
346/346 - 15s - loss: 13.1578 - accuracy10: 0.3594 - accuracy20: 0.3651 - accuracy30: 0.3674 - accuracy50: 0.3658 - val_loss: 13.1231 - val_accuracy10: 0.3734 - val_accuracy20: 0.3758 - val_accuracy30: 0.3725 - val_accuracy50: 0.3666 - 15s/epoch - 43ms/step
Epoch 5/50
346/346 - 15s - loss: 13.1381 - accuracy10: 0.3652 - accuracy20: 0.3695 - accuracy30: 0.3696 - accuracy50: 0.3667 - val_loss: 13.1914 - val_accuracy10: 0.3481 - val_accuracy20: 0.3518 - val_accuracy30: 0.3492 - val_accuracy50: 0.3501 - 15s/epoch - 44ms/step
Epoch 6/50
346/346 - 15s - loss: 13.1332 - accuracy10: 0.3626 - accuracy20: 0.3688 - accuracy30: 0.3724 - accuracy50: 0.3716 - val_loss: 13.0899 - val_accuracy10: 0.3815 - val_accuracy20: 0.3857 - val_accuracy30: 0.3788 - val_accuracy50: 0.3720 - 15s/epoch - 43ms/step
Epoch 7/50
346/346 - 15s - loss: 13.0628 - accuracy10: 0.3798 - accuracy20: 0.3853 - accuracy30: 0.3848 - accuracy50: 0.3816 - val_loss: 13.3357 - val_accuracy10: 0.3412 - val_accuracy20: 0.3382 - val_accuracy30: 0.3445 - val_accuracy50: 0.3469 - 15s/epoch - 44ms/step
Epoch 8/50
346/346 - 15s - loss: 13.0854 - accuracy10: 0.3757 - accuracy20: 0.3836 - accuracy30: 0.3844 - accuracy50: 0.3818 - val_loss: 13.2653 - val_accuracy10: 0.3488 - val_accuracy20: 0.3456 - val_accuracy30: 0.3437 - val_accuracy50: 0.3400 - 15s/epoch - 42ms/step
Epoch 9/50
346/346 - 15s - loss: 13.1023 - accuracy10: 0.3760 - accuracy20: 0.3818 - accuracy30: 0.3826 - accuracy50: 0.3778 - val_loss: 13.1451 - val_accuracy10: 0.3662 - val_accuracy20: 0.3677 - val_accuracy30: 0.3653 - val_accuracy50: 0.3585 - 15s/epoch - 43ms/step
Epoch 10/50
346/346 - 15s - loss: 13.0636 - accuracy10: 0.3791 - accuracy20: 0.3835 - accuracy30: 0.3828 - accuracy50: 0.3780 - val_loss: 13.0473 - val_accuracy10: 0.3964 - val_accuracy20: 0.3935 - val_accuracy30: 0.3885 - val_accuracy50: 0.3800 - 15s/epoch - 44ms/step
Epoch 11/50
346/346 - 15s - loss: 13.0462 - accuracy10: 0.3827 - accuracy20: 0.3872 - accuracy30: 0.3867 - accuracy50: 0.3844 - val_loss: 13.1475 - val_accuracy10: 0.3716 - val_accuracy20: 0.3733 - val_accuracy30: 0.3710 - val_accuracy50: 0.3619 - 15s/epoch - 43ms/step
Epoch 12/50
346/346 - 15s - loss: 13.0399 - accuracy10: 0.3819 - accuracy20: 0.3851 - accuracy30: 0.3870 - accuracy50: 0.3847 - val_loss: 13.0392 - val_accuracy10: 0.3940 - val_accuracy20: 0.3964 - val_accuracy30: 0.3917 - val_accuracy50: 0.3805 - 15s/epoch - 42ms/step
Epoch 13/50
346/346 - 15s - loss: 13.0339 - accuracy10: 0.3841 - accuracy20: 0.3872 - accuracy30: 0.3867 - accuracy50: 0.3831 - val_loss: 13.1828 - val_accuracy10: 0.3696 - val_accuracy20: 0.3683 - val_accuracy30: 0.3657 - val_accuracy50: 0.3582 - 15s/epoch - 43ms/step
Epoch 14/50
346/346 - 15s - loss: 13.0436 - accuracy10: 0.3858 - accuracy20: 0.3884 - accuracy30: 0.3896 - accuracy50: 0.3811 - val_loss: 13.1792 - val_accuracy10: 0.3626 - val_accuracy20: 0.3630 - val_accuracy30: 0.3621 - val_accuracy50: 0.3568 - 15s/epoch - 43ms/step
Epoch 15/50
346/346 - 15s - loss: 13.0199 - accuracy10: 0.3872 - accuracy20: 0.3920 - accuracy30: 0.3924 - accuracy50: 0.3870 - val_loss: 13.0377 - val_accuracy10: 0.4027 - val_accuracy20: 0.4020 - val_accuracy30: 0.3970 - val_accuracy50: 0.3824 - 15s/epoch - 44ms/step
Epoch 16/50
346/346 - 15s - loss: 13.0094 - accuracy10: 0.3907 - accuracy20: 0.3932 - accuracy30: 0.3934 - accuracy50: 0.3862 - val_loss: 13.0255 - val_accuracy10: 0.4045 - val_accuracy20: 0.4066 - val_accuracy30: 0.4038 - val_accuracy50: 0.3915 - 15s/epoch - 43ms/step
Epoch 17/50
346/346 - 15s - loss: 12.9922 - accuracy10: 0.3932 - accuracy20: 0.3947 - accuracy30: 0.3944 - accuracy50: 0.3887 - val_loss: 13.0525 - val_accuracy10: 0.3754 - val_accuracy20: 0.3778 - val_accuracy30: 0.3740 - val_accuracy50: 0.3653 - 15s/epoch - 43ms/step
Epoch 18/50
346/346 - 15s - loss: 12.9742 - accuracy10: 0.3937 - accuracy20: 0.3976 - accuracy30: 0.3963 - accuracy50: 0.3894 - val_loss: 12.9844 - val_accuracy10: 0.4094 - val_accuracy20: 0.4097 - val_accuracy30: 0.4051 - val_accuracy50: 0.3914 - 15s/epoch - 44ms/step
Epoch 19/50
346/346 - 15s - loss: 12.9457 - accuracy10: 0.3998 - accuracy20: 0.4033 - accuracy30: 0.4020 - accuracy50: 0.3959 - val_loss: 13.0487 - val_accuracy10: 0.3925 - val_accuracy20: 0.3924 - val_accuracy30: 0.3874 - val_accuracy50: 0.3778 - 15s/epoch - 43ms/step
Epoch 20/50
346/346 - 15s - loss: 12.9327 - accuracy10: 0.4009 - accuracy20: 0.4037 - accuracy30: 0.4030 - accuracy50: 0.3959 - val_loss: 13.0321 - val_accuracy10: 0.3936 - val_accuracy20: 0.3960 - val_accuracy30: 0.3882 - val_accuracy50: 0.3803 - 15s/epoch - 43ms/step
Epoch 21/50
346/346 - 15s - loss: 12.9168 - accuracy10: 0.4021 - accuracy20: 0.4045 - accuracy30: 0.4047 - accuracy50: 0.3987 - val_loss: 12.9889 - val_accuracy10: 0.4061 - val_accuracy20: 0.4129 - val_accuracy30: 0.4075 - val_accuracy50: 0.3935 - 15s/epoch - 43ms/step
Epoch 22/50
346/346 - 15s - loss: 12.9036 - accuracy10: 0.4050 - accuracy20: 0.4072 - accuracy30: 0.4063 - accuracy50: 0.3967 - val_loss: 13.0562 - val_accuracy10: 0.3837 - val_accuracy20: 0.3846 - val_accuracy30: 0.3781 - val_accuracy50: 0.3713 - 15s/epoch - 43ms/step
Epoch 23/50
346/346 - 15s - loss: 12.8787 - accuracy10: 0.4075 - accuracy20: 0.4116 - accuracy30: 0.4104 - accuracy50: 0.4026 - val_loss: 13.1235 - val_accuracy10: 0.3847 - val_accuracy20: 0.3846 - val_accuracy30: 0.3807 - val_accuracy50: 0.3713 - 15s/epoch - 45ms/step
Epoch 24/50
346/346 - 15s - loss: 12.8786 - accuracy10: 0.4076 - accuracy20: 0.4105 - accuracy30: 0.4095 - accuracy50: 0.4028 - val_loss: 13.1057 - val_accuracy10: 0.3859 - val_accuracy20: 0.3855 - val_accuracy30: 0.3803 - val_accuracy50: 0.3678 - 15s/epoch - 44ms/step
Epoch 25/50
346/346 - 15s - loss: 12.8597 - accuracy10: 0.4090 - accuracy20: 0.4120 - accuracy30: 0.4119 - accuracy50: 0.4037 - val_loss: 13.1642 - val_accuracy10: 0.3879 - val_accuracy20: 0.3867 - val_accuracy30: 0.3814 - val_accuracy50: 0.3697 - 15s/epoch - 43ms/step
Epoch 26/50
346/346 - 15s - loss: 12.8506 - accuracy10: 0.4095 - accuracy20: 0.4122 - accuracy30: 0.4127 - accuracy50: 0.4040 - val_loss: 12.9472 - val_accuracy10: 0.4153 - val_accuracy20: 0.4126 - val_accuracy30: 0.4104 - val_accuracy50: 0.3956 - 15s/epoch - 43ms/step
Epoch 27/50
346/346 - 15s - loss: 12.8315 - accuracy10: 0.4137 - accuracy20: 0.4166 - accuracy30: 0.4161 - accuracy50: 0.4058 - val_loss: 13.0235 - val_accuracy10: 0.3939 - val_accuracy20: 0.3933 - val_accuracy30: 0.3909 - val_accuracy50: 0.3789 - 15s/epoch - 43ms/step
Epoch 28/50
346/346 - 15s - loss: 12.8130 - accuracy10: 0.4141 - accuracy20: 0.4175 - accuracy30: 0.4175 - accuracy50: 0.4067 - val_loss: 12.9608 - val_accuracy10: 0.4177 - val_accuracy20: 0.4155 - val_accuracy30: 0.4100 - val_accuracy50: 0.3940 - 15s/epoch - 43ms/step
Epoch 29/50
346/346 - 15s - loss: 12.7944 - accuracy10: 0.4183 - accuracy20: 0.4206 - accuracy30: 0.4198 - accuracy50: 0.4082 - val_loss: 12.9587 - val_accuracy10: 0.4111 - val_accuracy20: 0.4137 - val_accuracy30: 0.4105 - val_accuracy50: 0.3977 - 15s/epoch - 43ms/step
Epoch 30/50
346/346 - 15s - loss: 12.7935 - accuracy10: 0.4184 - accuracy20: 0.4222 - accuracy30: 0.4229 - accuracy50: 0.4111 - val_loss: 12.9466 - val_accuracy10: 0.4162 - val_accuracy20: 0.4172 - val_accuracy30: 0.4106 - val_accuracy50: 0.3948 - 15s/epoch - 42ms/step
Epoch 31/50
346/346 - 15s - loss: 12.7700 - accuracy10: 0.4217 - accuracy20: 0.4260 - accuracy30: 0.4256 - accuracy50: 0.4152 - val_loss: 12.9894 - val_accuracy10: 0.3904 - val_accuracy20: 0.3955 - val_accuracy30: 0.4013 - val_accuracy50: 0.3915 - 15s/epoch - 43ms/step
Epoch 32/50
346/346 - 15s - loss: 12.7580 - accuracy10: 0.4211 - accuracy20: 0.4269 - accuracy30: 0.4264 - accuracy50: 0.4151 - val_loss: 12.9500 - val_accuracy10: 0.4191 - val_accuracy20: 0.4225 - val_accuracy30: 0.4156 - val_accuracy50: 0.3991 - 15s/epoch - 42ms/step
Epoch 33/50
346/346 - 15s - loss: 12.7368 - accuracy10: 0.4248 - accuracy20: 0.4302 - accuracy30: 0.4303 - accuracy50: 0.4201 - val_loss: 12.9836 - val_accuracy10: 0.4157 - val_accuracy20: 0.4154 - val_accuracy30: 0.4095 - val_accuracy50: 0.3986 - 15s/epoch - 44ms/step
Epoch 34/50
346/346 - 15s - loss: 12.7350 - accuracy10: 0.4246 - accuracy20: 0.4298 - accuracy30: 0.4299 - accuracy50: 0.4186 - val_loss: 13.0907 - val_accuracy10: 0.3836 - val_accuracy20: 0.3858 - val_accuracy30: 0.3800 - val_accuracy50: 0.3719 - 15s/epoch - 43ms/step
Epoch 35/50
346/346 - 14s - loss: 12.7261 - accuracy10: 0.4238 - accuracy20: 0.4297 - accuracy30: 0.4301 - accuracy50: 0.4197 - val_loss: 13.0486 - val_accuracy10: 0.3933 - val_accuracy20: 0.3975 - val_accuracy30: 0.3984 - val_accuracy50: 0.3891 - 14s/epoch - 42ms/step
Epoch 36/50
346/346 - 15s - loss: 12.6925 - accuracy10: 0.4291 - accuracy20: 0.4345 - accuracy30: 0.4344 - accuracy50: 0.4256 - val_loss: 12.9570 - val_accuracy10: 0.4168 - val_accuracy20: 0.4164 - val_accuracy30: 0.4116 - val_accuracy50: 0.3986 - 15s/epoch - 42ms/step
Epoch 37/50
346/346 - 15s - loss: 12.6829 - accuracy10: 0.4277 - accuracy20: 0.4347 - accuracy30: 0.4347 - accuracy50: 0.4238 - val_loss: 13.0128 - val_accuracy10: 0.4178 - val_accuracy20: 0.4163 - val_accuracy30: 0.4121 - val_accuracy50: 0.3967 - 15s/epoch - 43ms/step
Epoch 38/50
346/346 - 15s - loss: 12.6613 - accuracy10: 0.4315 - accuracy20: 0.4389 - accuracy30: 0.4373 - accuracy50: 0.4278 - val_loss: 13.0003 - val_accuracy10: 0.4089 - val_accuracy20: 0.4136 - val_accuracy30: 0.4133 - val_accuracy50: 0.3995 - 15s/epoch - 43ms/step
Epoch 39/50
346/346 - 15s - loss: 12.6506 - accuracy10: 0.4323 - accuracy20: 0.4400 - accuracy30: 0.4390 - accuracy50: 0.4280 - val_loss: 12.9960 - val_accuracy10: 0.4159 - val_accuracy20: 0.4189 - val_accuracy30: 0.4119 - val_accuracy50: 0.3972 - 15s/epoch - 43ms/step
Epoch 40/50
346/346 - 15s - loss: 12.6348 - accuracy10: 0.4340 - accuracy20: 0.4403 - accuracy30: 0.4404 - accuracy50: 0.4306 - val_loss: 13.0455 - val_accuracy10: 0.4142 - val_accuracy20: 0.4187 - val_accuracy30: 0.4167 - val_accuracy50: 0.4013 - 15s/epoch - 43ms/step
testing model: results/CHTR/W4/deepVOL_L3/seq2seq
Evaluating performance on  test set...
925/925 - 17s - 17s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0633581
{'0': {'precision': 0.37326534990016996, 'recall': 0.32269614835948646, 'f1-score': 0.34614354681988935, 'support': 70100}, '1': {'precision': 0.5128034534511302, 'recall': 0.6331887740481058, 'f1-score': 0.5666729358660899, 'support': 104686}, '2': {'precision': 0.3605885242050866, 'recall': 0.272759578729728, 'f1-score': 0.3105842537498736, 'support': 61908}, 'accuracy': 0.44696105520207524, 'macro avg': {'precision': 0.4155524425187956, 'recall': 0.4095481670457734, 'f1-score': 0.4078002454786176, 'support': 236694}, 'weighted avg': {'precision': 0.43166517829972634, 'recall': 0.44696105520207524, 'f1-score': 0.4343795600112335, 'support': 236694}}
[[22621 33544 13935]
 [22392 66286 16008]
 [15590 29432 16886]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0641782
{'0': {'precision': 0.3835988677719369, 'recall': 0.33319284048441933, 'f1-score': 0.35662353480748554, 'support': 71178}, '1': {'precision': 0.501569931917804, 'recall': 0.6314924263180555, 'f1-score': 0.5590824034929656, 'support': 102196}, '2': {'precision': 0.3638665829743945, 'recall': 0.2654927353126974, 'f1-score': 0.3069913532564531, 'support': 63320}, 'accuracy': 0.4438769043575249, 'macro avg': {'precision': 0.4163451275547118, 'recall': 0.41005933403839073, 'f1-score': 0.40756576385230137, 'support': 236694}, 'weighted avg': {'precision': 0.42925580287832166, 'recall': 0.4438769043575249, 'f1-score': 0.43076050831915014, 'support': 236694}}
[[23716 33812 13650]
 [21920 64536 15740]
 [16189 30320 16811]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0675464
{'0': {'precision': 0.381805595801539, 'recall': 0.3316413569371032, 'f1-score': 0.3549598898467433, 'support': 71514}, '1': {'precision': 0.4894747409226397, 'recall': 0.6316618168772671, 'f1-score': 0.5515519086692829, 'support': 100348}, '2': {'precision': 0.3695594303207773, 'recall': 0.25695644126357353, 'f1-score': 0.30313893185333457, 'support': 64832}, 'accuracy': 0.4383803560715523, 'macro avg': {'precision': 0.413613255681652, 'recall': 0.4067532050259812, 'f1-score': 0.4032169101231203, 'support': 236694}, 'weighted avg': {'precision': 0.4240983449804936, 'recall': 0.4383803560715523, 'f1-score': 0.42411229572173603, 'support': 236694}}
[[23717 34353 13444]
 [21987 63386 14975]
 [16414 31759 16659]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0766493
{'0': {'precision': 0.38306563166202867, 'recall': 0.32052451694603684, 'f1-score': 0.34901547950892586, 'support': 73439}, '1': {'precision': 0.45533139005562057, 'recall': 0.6268365896045078, 'f1-score': 0.527493662808218, 'support': 94945}, '2': {'precision': 0.3726031703264628, 'recall': 0.24293661250182988, 'f1-score': 0.2941124344250673, 'support': 68310}, 'accuracy': 0.42100348973780494, 'macro avg': {'precision': 0.40366673068137066, 'recall': 0.39676590635079156, 'f1-score': 0.3902071922474037, 'support': 236694}, 'weighted avg': {'precision': 0.40903410444480764, 'recall': 0.42100348973780494, 'f1-score': 0.40476334005322745, 'support': 236694}}
[[23539 36413 13487]
 [20974 59515 14456]
 [16936 34779 16595]]
Evaluating performance on  train set...
346/346 - 6s - 6s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0681403
{'0': {'precision': 0.4199623352165725, 'recall': 0.33732226293320783, 'f1-score': 0.3741331742599359, 'support': 29749}, '1': {'precision': 0.4031673203581736, 'recall': 0.5645790873605306, 'f1-score': 0.4704121574948193, 'support': 28949}, '2': {'precision': 0.4378936029168048, 'recall': 0.35380958757364755, 'f1-score': 0.39138646126499776, 'support': 29872}, 'accuracy': 0.4171615671220504, 'macro avg': {'precision': 0.4203410861638503, 'recall': 0.418570312622462, 'f1-score': 0.4119772643399176, 'support': 88570}, 'weighted avg': {'precision': 0.42052058229352346, 'recall': 0.4171615671220504, 'f1-score': 0.41142086168323777, 'support': 88570}}
[[10035 12293  7421]
 [ 6459 16344  6146]
 [ 7401 11902 10569]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0655668
{'0': {'precision': 0.4227752453698, 'recall': 0.34511079078810636, 'f1-score': 0.3800155033036802, 'support': 29831}, '1': {'precision': 0.4085527128908664, 'recall': 0.5649439431227782, 'f1-score': 0.47418628336991286, 'support': 29256}, '2': {'precision': 0.4360797845480559, 'recall': 0.35149068954991014, 'f1-score': 0.38924258643679455, 'support': 29483}, 'accuracy': 0.4198487072372135, 'macro avg': {'precision': 0.42246924760290744, 'recall': 0.4205151411535983, 'f1-score': 0.41448145770346256, 'support': 88570}, 'weighted avg': {'precision': 0.42250611720438097, 'recall': 0.4198487072372135, 'f1-score': 0.41419301751426296, 'support': 88570}}
[[10295 12252  7284]
 [ 6611 16528  6117]
 [ 7445 11675 10363]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0659837
{'0': {'precision': 0.4238952536824877, 'recall': 0.34491943001731257, 'f1-score': 0.3803509802481827, 'support': 30036}, '1': {'precision': 0.408830443726124, 'recall': 0.5692900497851736, 'f1-score': 0.4758986345885237, 'support': 29326}, '2': {'precision': 0.43302996479780204, 'recall': 0.34535058887975895, 'f1-score': 0.38425202849415263, 'support': 29208}, 'accuracy': 0.4193519250310489, 'macro avg': {'precision': 0.4219185540688046, 'recall': 0.4198533562274151, 'f1-score': 0.41350054777695305, 'support': 88570}, 'weighted avg': {'precision': 0.4219195962982242, 'recall': 0.4193519250310489, 'f1-score': 0.4132737794844154, 'support': 88570}}
[[10360 12438  7238]
 [ 6662 16695  5969]
 [ 7418 11703 10087]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0748416
{'0': {'precision': 0.4142331997852216, 'recall': 0.33097917560476553, 'f1-score': 0.3679556794834165, 'support': 30301}, '1': {'precision': 0.3959729919411437, 'recall': 0.5646547261621286, 'f1-score': 0.4655039972687701, 'support': 28977}, '2': {'precision': 0.4234742599183957, 'recall': 0.33306022122081114, 'f1-score': 0.37286451366329065, 'support': 29292}, 'accuracy': 0.40811787286891726, 'macro avg': {'precision': 0.4112268172149203, 'recall': 0.4095647076625684, 'f1-score': 0.40210806347182576, 'support': 88570}, 'weighted avg': {'precision': 0.4113153166501092, 'recall': 0.40811787286891726, 'f1-score': 0.40149352723393095, 'support': 88570}}
[[10029 12902  7370]
 [ 6703 16362  5912]
 [ 7479 12057  9756]]
Evaluating performance on  val set...
127/127 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0744995
{'0': {'precision': 0.4065239099079108, 'recall': 0.3372917242014177, 'f1-score': 0.3686858522841618, 'support': 10863}, '1': {'precision': 0.42565498468866964, 'recall': 0.5683780099954566, 'f1-score': 0.48677042801556425, 'support': 11005}, '2': {'precision': 0.4073338783136751, 'recall': 0.335287897721811, 'f1-score': 0.367816091954023, 'support': 10403}, 'accuracy': 0.4154504043878405, 'macro avg': {'precision': 0.4131709243034185, 'recall': 0.4136525439728951, 'f1-score': 0.40775745741791636, 'support': 32271}, 'weighted avg': {'precision': 0.41330906002062556, 'recall': 0.4154504043878405, 'f1-score': 0.40867446866449236, 'support': 32271}}
[[3664 4328 2871]
 [2546 6255 2204]
 [2803 4112 3488]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0748655
{'0': {'precision': 0.41181619256017504, 'recall': 0.34723247232472326, 'f1-score': 0.3767767767767768, 'support': 10840}, '1': {'precision': 0.4268151871221898, 'recall': 0.5689452240832956, 'f1-score': 0.4877367277243092, 'support': 11045}, '2': {'precision': 0.4063986679352997, 'recall': 0.32900057770075103, 'f1-score': 0.3636266893689476, 'support': 10386}, 'accuracy': 0.4172476836788448, 'macro avg': {'precision': 0.41501001587255487, 'recall': 0.4150594247029233, 'f1-score': 0.40938006462334453, 'support': 32271}, 'weighted avg': {'precision': 0.41520615519484694, 'recall': 0.4172476836788448, 'f1-score': 0.41052149650649644, 'support': 32271}}
[[3764 4288 2788]
 [2558 6284 2203]
 [2818 4151 3417]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0764006
{'0': {'precision': 0.4126585045911675, 'recall': 0.34550613216181586, 'f1-score': 0.37610839892398135, 'support': 10926}, '1': {'precision': 0.4169744175115826, 'recall': 0.5762806236080178, 'f1-score': 0.48385211733998207, 'support': 10776}, '2': {'precision': 0.4072904009720535, 'recall': 0.31715394077017695, 'f1-score': 0.3566147135485931, 'support': 10569}, 'accuracy': 0.41328127420904215, 'macro avg': {'precision': 0.4123077743582679, 'recall': 0.4129802321800035, 'f1-score': 0.4055250766041855, 'support': 32271}, 'weighted avg': {'precision': 0.4123415881795279, 'recall': 0.41328127420904215, 'f1-score': 0.40570207587599233, 'support': 32271}}
[[3775 4371 2780]
 [2468 6210 2098]
 [2905 4312 3352]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0858124
{'0': {'precision': 0.39840460890760027, 'recall': 0.32816207337105313, 'f1-score': 0.3598879103282627, 'support': 10958}, '1': {'precision': 0.3936008461691016, 'recall': 0.5656469694090823, 'f1-score': 0.46419522083187154, 'support': 10526}, '2': {'precision': 0.4026853904902685, 'recall': 0.3030499675535367, 'f1-score': 0.34583443533456754, 'support': 10787}, 'accuracy': 0.39722971088593473, 'macro avg': {'precision': 0.39823028185565684, 'recall': 0.3989530034445574, 'f1-score': 0.3899725221649006, 'support': 32271}, 'weighted avg': {'precision': 0.39826864734293865, 'recall': 0.39722971088593473, 'f1-score': 0.38921281242624534, 'support': 32271}}
[[3596 4565 2797]
 [2520 5954 2052]
 [2910 4608 3269]]
training model: results/CHTR/W5/deepLOB_L1/seq2seq
Epoch 1/50
331/331 - 13s - loss: 13.1977 - accuracy10: 0.3734 - accuracy20: 0.3703 - accuracy30: 0.3697 - accuracy50: 0.3615 - val_loss: 13.3446 - val_accuracy10: 0.3550 - val_accuracy20: 0.3516 - val_accuracy30: 0.3449 - val_accuracy50: 0.3423 - 13s/epoch - 40ms/step
Epoch 2/50
331/331 - 8s - loss: 13.0646 - accuracy10: 0.3964 - accuracy20: 0.3921 - accuracy30: 0.3842 - accuracy50: 0.3743 - val_loss: 13.2119 - val_accuracy10: 0.3727 - val_accuracy20: 0.3711 - val_accuracy30: 0.3655 - val_accuracy50: 0.3544 - 8s/epoch - 23ms/step
Epoch 3/50
331/331 - 8s - loss: 13.0318 - accuracy10: 0.3993 - accuracy20: 0.3971 - accuracy30: 0.3894 - accuracy50: 0.3805 - val_loss: 13.1518 - val_accuracy10: 0.3836 - val_accuracy20: 0.3779 - val_accuracy30: 0.3745 - val_accuracy50: 0.3677 - 8s/epoch - 23ms/step
Epoch 4/50
331/331 - 8s - loss: 12.9892 - accuracy10: 0.4111 - accuracy20: 0.4060 - accuracy30: 0.3991 - accuracy50: 0.3879 - val_loss: 13.1312 - val_accuracy10: 0.3881 - val_accuracy20: 0.3810 - val_accuracy30: 0.3736 - val_accuracy50: 0.3618 - 8s/epoch - 25ms/step
Epoch 5/50
331/331 - 8s - loss: 12.9491 - accuracy10: 0.4198 - accuracy20: 0.4139 - accuracy30: 0.4054 - accuracy50: 0.3902 - val_loss: 13.0219 - val_accuracy10: 0.4061 - val_accuracy20: 0.4007 - val_accuracy30: 0.3945 - val_accuracy50: 0.3821 - 8s/epoch - 23ms/step
Epoch 6/50
331/331 - 8s - loss: 12.9286 - accuracy10: 0.4234 - accuracy20: 0.4156 - accuracy30: 0.4074 - accuracy50: 0.3922 - val_loss: 13.0554 - val_accuracy10: 0.4036 - val_accuracy20: 0.3982 - val_accuracy30: 0.3904 - val_accuracy50: 0.3780 - 8s/epoch - 23ms/step
Epoch 7/50
331/331 - 8s - loss: 12.9047 - accuracy10: 0.4265 - accuracy20: 0.4194 - accuracy30: 0.4107 - accuracy50: 0.3962 - val_loss: 13.1001 - val_accuracy10: 0.3972 - val_accuracy20: 0.3895 - val_accuracy30: 0.3795 - val_accuracy50: 0.3620 - 8s/epoch - 23ms/step
Epoch 8/50
331/331 - 8s - loss: 12.8882 - accuracy10: 0.4295 - accuracy20: 0.4220 - accuracy30: 0.4126 - accuracy50: 0.3986 - val_loss: 13.0433 - val_accuracy10: 0.4089 - val_accuracy20: 0.4024 - val_accuracy30: 0.3970 - val_accuracy50: 0.3824 - 8s/epoch - 23ms/step
Epoch 9/50
331/331 - 8s - loss: 12.8664 - accuracy10: 0.4328 - accuracy20: 0.4250 - accuracy30: 0.4149 - accuracy50: 0.4004 - val_loss: 12.9847 - val_accuracy10: 0.4134 - val_accuracy20: 0.4063 - val_accuracy30: 0.3999 - val_accuracy50: 0.3869 - 8s/epoch - 24ms/step
Epoch 10/50
331/331 - 8s - loss: 12.8484 - accuracy10: 0.4331 - accuracy20: 0.4269 - accuracy30: 0.4170 - accuracy50: 0.4011 - val_loss: 13.0325 - val_accuracy10: 0.4106 - val_accuracy20: 0.4031 - val_accuracy30: 0.3951 - val_accuracy50: 0.3807 - 8s/epoch - 24ms/step
Epoch 11/50
331/331 - 8s - loss: 12.8319 - accuracy10: 0.4382 - accuracy20: 0.4301 - accuracy30: 0.4211 - accuracy50: 0.4036 - val_loss: 13.0164 - val_accuracy10: 0.4112 - val_accuracy20: 0.4043 - val_accuracy30: 0.3978 - val_accuracy50: 0.3849 - 8s/epoch - 23ms/step
Epoch 12/50
331/331 - 8s - loss: 12.8183 - accuracy10: 0.4390 - accuracy20: 0.4316 - accuracy30: 0.4218 - accuracy50: 0.4053 - val_loss: 13.0150 - val_accuracy10: 0.4159 - val_accuracy20: 0.4105 - val_accuracy30: 0.4009 - val_accuracy50: 0.3847 - 8s/epoch - 23ms/step
Epoch 13/50
331/331 - 8s - loss: 12.8080 - accuracy10: 0.4399 - accuracy20: 0.4328 - accuracy30: 0.4214 - accuracy50: 0.4060 - val_loss: 13.0095 - val_accuracy10: 0.4146 - val_accuracy20: 0.4100 - val_accuracy30: 0.4030 - val_accuracy50: 0.3885 - 8s/epoch - 24ms/step
Epoch 14/50
331/331 - 8s - loss: 12.7860 - accuracy10: 0.4406 - accuracy20: 0.4339 - accuracy30: 0.4239 - accuracy50: 0.4077 - val_loss: 13.0366 - val_accuracy10: 0.4130 - val_accuracy20: 0.4058 - val_accuracy30: 0.3977 - val_accuracy50: 0.3842 - 8s/epoch - 24ms/step
Epoch 15/50
331/331 - 8s - loss: 12.7839 - accuracy10: 0.4417 - accuracy20: 0.4356 - accuracy30: 0.4257 - accuracy50: 0.4076 - val_loss: 13.0656 - val_accuracy10: 0.4104 - val_accuracy20: 0.4017 - val_accuracy30: 0.3936 - val_accuracy50: 0.3792 - 8s/epoch - 24ms/step
Epoch 16/50
331/331 - 8s - loss: 12.7692 - accuracy10: 0.4429 - accuracy20: 0.4370 - accuracy30: 0.4272 - accuracy50: 0.4090 - val_loss: 13.0680 - val_accuracy10: 0.4139 - val_accuracy20: 0.4069 - val_accuracy30: 0.3982 - val_accuracy50: 0.3808 - 8s/epoch - 24ms/step
Epoch 17/50
331/331 - 8s - loss: 12.7501 - accuracy10: 0.4442 - accuracy20: 0.4387 - accuracy30: 0.4301 - accuracy50: 0.4137 - val_loss: 13.0665 - val_accuracy10: 0.4151 - val_accuracy20: 0.4061 - val_accuracy30: 0.3952 - val_accuracy50: 0.3790 - 8s/epoch - 23ms/step
Epoch 18/50
331/331 - 8s - loss: 12.7431 - accuracy10: 0.4447 - accuracy20: 0.4384 - accuracy30: 0.4295 - accuracy50: 0.4121 - val_loss: 13.0649 - val_accuracy10: 0.4137 - val_accuracy20: 0.4070 - val_accuracy30: 0.3985 - val_accuracy50: 0.3840 - 8s/epoch - 24ms/step
Epoch 19/50
331/331 - 8s - loss: 12.7378 - accuracy10: 0.4460 - accuracy20: 0.4395 - accuracy30: 0.4300 - accuracy50: 0.4135 - val_loss: 13.0481 - val_accuracy10: 0.4166 - val_accuracy20: 0.4075 - val_accuracy30: 0.3984 - val_accuracy50: 0.3833 - 8s/epoch - 24ms/step
testing model: results/CHTR/W5/deepLOB_L1/seq2seq
Evaluating performance on  test set...
2027/2027 - 23s - 23s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.083698
{'0': {'precision': 0.4765880770499708, 'recall': 0.10021345856235658, 'f1-score': 0.16560475852429307, 'support': 187390}, '1': {'precision': 0.3742473527579763, 'recall': 0.43954183064532515, 'f1-score': 0.40427513636264517, 'support': 147631}, '2': {'precision': 0.39969485700097357, 'recall': 0.6654175006526847, 'f1-score': 0.49941013426079006, 'support': 183856}, 'accuracy': 0.3970305101208957, 'macro avg': {'precision': 0.41684342893630694, 'recall': 0.40172426328678884, 'f1-score': 0.35643000971590943, 'support': 518877}, 'weighted avg': {'precision': 0.42022415393663204, 'recall': 0.3970305101208957, 'f1-score': 0.3517900542920052, 'support': 518877}}
[[ 18779  58557 110054]
 [  9050  64890  73691]
 [ 11574  49941 122341]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.090758
{'0': {'precision': 0.4750464972101674, 'recall': 0.08103063566088216, 'f1-score': 0.13844597219336363, 'support': 189126}, '1': {'precision': 0.36178480810112695, 'recall': 0.4253426498253158, 'f1-score': 0.3909976901317984, 'support': 148840}, '2': {'precision': 0.38839453324305506, 'recall': 0.6690306283200027, 'f1-score': 0.4914727737848702, 'support': 180911}, 'accuracy': 0.3848079602680404, 'macro avg': {'precision': 0.40840861285144986, 'recall': 0.3918013046020669, 'f1-score': 0.3403054787033441, 'support': 518877}, 'weighted avg': {'precision': 0.41234538835345597, 'recall': 0.3848079602680404, 'f1-score': 0.33397637612469555, 'support': 518877}}
[[ 15325  61175 112626]
 [  7564  63308  77968]
 [  9371  50505 121035]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0962061
{'0': {'precision': 0.4611652311279949, 'recall': 0.0646571499385649, 'f1-score': 0.11341331434015671, 'support': 189631}, '1': {'precision': 0.35023163012567654, 'recall': 0.4052408119941621, 'f1-score': 0.3757334940766893, 'support': 150740}, '2': {'precision': 0.37811208214575587, 'recall': 0.6733219051460455, 'f1-score': 0.4842741448084128, 'support': 178506}, 'accuracy': 0.37299591232604257, 'macro avg': {'precision': 0.3965029811331425, 'recall': 0.38107328902625753, 'f1-score': 0.3244736510750863, 'support': 518877}, 'weighted avg': {'precision': 0.40036543382090084, 'recall': 0.37299591232604257, 'f1-score': 0.3172054024401331, 'support': 518877}}
[[ 12261  62876 114494]
 [  6466  61086  83188]
 [  7860  50454 120192]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1034548
{'0': {'precision': 0.4418327059039574, 'recall': 0.05136087095741274, 'f1-score': 0.09202436389019036, 'support': 187380}, '1': {'precision': 0.3446150994973012, 'recall': 0.3758558831703681, 'f1-score': 0.3595581659536412, 'support': 158316}, '2': {'precision': 0.3602197104433355, 'recall': 0.6748142117206853, 'f1-score': 0.4697070786643302, 'support': 173181}, 'accuracy': 0.3584529666953825, 'macro avg': {'precision': 0.38222250528153134, 'recall': 0.36734365528282203, 'f1-score': 0.30709653616938726, 'support': 518877}, 'weighted avg': {'precision': 0.3849311227874536, 'recall': 0.3584529666953825, 'f1-score': 0.29970817264405225, 'support': 518877}}
[[  9624  63145 114611]
 [  5861  59504  92951]
 [  6297  50019 116865]]
Evaluating performance on  train set...
331/331 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0733954
{'0': {'precision': 0.442613910525953, 'recall': 0.22892897889332572, 'f1-score': 0.3017741745975796, 'support': 28048}, '1': {'precision': 0.40630625996605113, 'recall': 0.5575830303885928, 'f1-score': 0.4700736442758313, 'support': 28333}, '2': {'precision': 0.41810469488094093, 'recall': 0.4625804387243574, 'f1-score': 0.43921952536880127, 'support': 28127}, 'accuracy': 0.4168836086524353, 'macro avg': {'precision': 0.42234162179098167, 'recall': 0.4163641493354253, 'f1-score': 0.40368911474740404, 'support': 84508}, 'weighted avg': {'precision': 0.42228358237050084, 'recall': 0.4168836086524353, 'f1-score': 0.4039462086717035, 'support': 84508}}
[[ 6421 12230  9397]
 [ 3824 15798  8711]
 [ 4262 10854 13011]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0779605
{'0': {'precision': 0.4427514148889856, 'recall': 0.21496512365250475, 'f1-score': 0.28941377347751845, 'support': 28386}, '1': {'precision': 0.3910552815454172, 'recall': 0.5479841612670986, 'f1-score': 0.4564070276428614, 'support': 27780}, '2': {'precision': 0.4157179696836279, 'recall': 0.4664102745042693, 'f1-score': 0.4396075823079481, 'support': 28342}, 'accuracy': 0.40876603398494815, 'macro avg': {'precision': 0.4165082220393436, 'recall': 0.40978651980795755, 'f1-score': 0.3951427944761093, 'support': 84508}, 'weighted avg': {'precision': 0.4166911544604513, 'recall': 0.40876603398494815, 'f1-score': 0.3946803225685544, 'support': 84508}}
[[ 6102 12601  9683]
 [ 3661 15223  8896]
 [ 4019 11104 13219]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.081497
{'0': {'precision': 0.4309296264118158, 'recall': 0.19291422105933104, 'f1-score': 0.26651686490975257, 'support': 28282}, '1': {'precision': 0.38409415121255347, 'recall': 0.5387693846923461, 'f1-score': 0.4484697064334791, 'support': 27986}, '2': {'precision': 0.4076892393605597, 'recall': 0.4705028328611898, 'f1-score': 0.4368496325886472, 'support': 28240}, 'accuracy': 0.4002106309461826, 'macro avg': {'precision': 0.407571005661643, 'recall': 0.40072881287095563, 'f1-score': 0.38394540131062627, 'support': 84508}, 'weighted avg': {'precision': 0.40765317756373004, 'recall': 0.4002106309461826, 'f1-score': 0.3836931036343111, 'support': 84508}}
[[ 5456 12932  9894]
 [ 3498 15078  9410]
 [ 3707 11246 13287]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0880297
{'0': {'precision': 0.4071291280796785, 'recall': 0.16467012968656136, 'f1-score': 0.23449490501949932, 'support': 28299}, '1': {'precision': 0.36809026200212025, 'recall': 0.5253809849767627, 'f1-score': 0.4328905380333952, 'support': 27757}, '2': {'precision': 0.4000119602918311, 'recall': 0.47019541684240124, 'f1-score': 0.43227349101719015, 'support': 28452}, 'accuracy': 0.38601079187769205, 'macro avg': {'precision': 0.3917437834578766, 'recall': 0.3867488438352418, 'f1-score': 0.36655297802336156, 'support': 84508}, 'weighted avg': {'precision': 0.39191045690517884, 'recall': 0.38601079187769205, 'f1-score': 0.3662465014881533, 'support': 84508}}
[[ 4660 13391 10248]
 [ 3356 14583  9818]
 [ 3430 11644 13378]]
Evaluating performance on  val set...
136/136 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0766948
{'0': {'precision': 0.4542478310689147, 'recall': 0.2259771986970684, 'f1-score': 0.30181086519114686, 'support': 12280}, '1': {'precision': 0.4023937267849773, 'recall': 0.36855036855036855, 'f1-score': 0.3847292098253921, 'support': 10582}, '2': {'precision': 0.4028247989843419, 'recall': 0.6429958625348307, 'f1-score': 0.4953328780043582, 'support': 11843}, 'accuracy': 0.4117562310906209, 'macro avg': {'precision': 0.41982211894607796, 'recall': 0.4125078099274225, 'f1-score': 0.3939576510069657, 'support': 34705}, 'weighted avg': {'precision': 0.42088885972443346, 'recall': 0.4117562310906209, 'f1-score': 0.3931326666798789, 'support': 34705}}
[[2775 3263 6242]
 [1635 3900 5047]
 [1699 2529 7615]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0796416
{'0': {'precision': 0.4443500424808836, 'recall': 0.21007390745501286, 'f1-score': 0.28527791414389353, 'support': 12448}, '1': {'precision': 0.3876766417290108, 'recall': 0.3597878495660559, 'f1-score': 0.3732119635890767, 'support': 10370}, '2': {'precision': 0.4022192123359033, 'recall': 0.6495331033902583, 'f1-score': 0.4967988932857188, 'support': 11887}, 'accuracy': 0.4053306439994237, 'macro avg': {'precision': 0.41141529884859923, 'recall': 0.4064649534704423, 'f1-score': 0.3850962570062297, 'support': 34705}, 'weighted avg': {'precision': 0.4129853300841021, 'recall': 0.4053306439994237, 'f1-score': 0.3840021893724032, 'support': 34705}}
[[2615 3378 6455]
 [1619 3731 5020]
 [1651 2515 7721]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0827703
{'0': {'precision': 0.4429065743944637, 'recall': 0.19493427380570696, 'f1-score': 0.2707185395447209, 'support': 12476}, '1': {'precision': 0.3734715025906736, 'recall': 0.35078839789760563, 'f1-score': 0.36177474402730375, 'support': 10274}, '2': {'precision': 0.39991821713351056, 'recall': 0.6544542032622334, 'f1-score': 0.4964624512198992, 'support': 11955}, 'accuracy': 0.3993660855784469, 'macro avg': {'precision': 0.4054320980395492, 'recall': 0.4000589583218486, 'f1-score': 0.37631857826397463, 'support': 34705}, 'weighted avg': {'precision': 0.4075427438580328, 'recall': 0.3993660855784469, 'f1-score': 0.3754377416461706, 'support': 34705}}
[[2432 3440 6604]
 [1534 3604 5136]
 [1525 2606 7824]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0903449
{'0': {'precision': 0.4220129487934079, 'recall': 0.172840498192045, 'f1-score': 0.24523999543951658, 'support': 12445}, '1': {'precision': 0.35837552960628294, 'recall': 0.3349430171914236, 'f1-score': 0.3462632918975588, 'support': 10354}, '2': {'precision': 0.3906979077818474, 'recall': 0.6540399798420964, 'f1-score': 0.4891792568395263, 'support': 11906}, 'accuracy': 0.38628439706094225, 'macro avg': {'precision': 0.3903621287271794, 'recall': 0.3872744984085217, 'f1-score': 0.3602275147255339, 'support': 34705}, 'weighted avg': {'precision': 0.39228412826186687, 'recall': 0.38628439706094225, 'f1-score': 0.3590661316664316, 'support': 34705}}
[[2151 3571 6723]
 [1465 3468 5421]
 [1481 2638 7787]]
training model: results/CHTR/W5/deepOF_L1/seq2seq
Epoch 1/50
331/331 - 13s - loss: 13.1194 - accuracy10: 0.3905 - accuracy20: 0.3888 - accuracy30: 0.3842 - accuracy50: 0.3764 - val_loss: 13.1376 - val_accuracy10: 0.3869 - val_accuracy20: 0.3816 - val_accuracy30: 0.3791 - val_accuracy50: 0.3736 - 13s/epoch - 39ms/step
Epoch 2/50
331/331 - 7s - loss: 12.9772 - accuracy10: 0.4164 - accuracy20: 0.4104 - accuracy30: 0.4046 - accuracy50: 0.3961 - val_loss: 13.0899 - val_accuracy10: 0.3965 - val_accuracy20: 0.3913 - val_accuracy30: 0.3875 - val_accuracy50: 0.3804 - 7s/epoch - 22ms/step
Epoch 3/50
331/331 - 7s - loss: 12.9048 - accuracy10: 0.4254 - accuracy20: 0.4203 - accuracy30: 0.4144 - accuracy50: 0.4046 - val_loss: 13.0604 - val_accuracy10: 0.4005 - val_accuracy20: 0.3963 - val_accuracy30: 0.3930 - val_accuracy50: 0.3855 - 7s/epoch - 22ms/step
Epoch 4/50
331/331 - 7s - loss: 12.8529 - accuracy10: 0.4318 - accuracy20: 0.4271 - accuracy30: 0.4212 - accuracy50: 0.4111 - val_loss: 13.0001 - val_accuracy10: 0.4095 - val_accuracy20: 0.4039 - val_accuracy30: 0.3989 - val_accuracy50: 0.3898 - 7s/epoch - 22ms/step
Epoch 5/50
331/331 - 7s - loss: 12.8244 - accuracy10: 0.4345 - accuracy20: 0.4301 - accuracy30: 0.4242 - accuracy50: 0.4146 - val_loss: 12.9673 - val_accuracy10: 0.4141 - val_accuracy20: 0.4086 - val_accuracy30: 0.4046 - val_accuracy50: 0.3944 - 7s/epoch - 22ms/step
Epoch 6/50
331/331 - 8s - loss: 12.7965 - accuracy10: 0.4379 - accuracy20: 0.4322 - accuracy30: 0.4275 - accuracy50: 0.4167 - val_loss: 12.9239 - val_accuracy10: 0.4218 - val_accuracy20: 0.4150 - val_accuracy30: 0.4095 - val_accuracy50: 0.3999 - 8s/epoch - 23ms/step
Epoch 7/50
331/331 - 7s - loss: 12.7662 - accuracy10: 0.4406 - accuracy20: 0.4371 - accuracy30: 0.4326 - accuracy50: 0.4209 - val_loss: 12.9493 - val_accuracy10: 0.4160 - val_accuracy20: 0.4088 - val_accuracy30: 0.4037 - val_accuracy50: 0.3952 - 7s/epoch - 22ms/step
Epoch 8/50
331/331 - 7s - loss: 12.7440 - accuracy10: 0.4451 - accuracy20: 0.4402 - accuracy30: 0.4352 - accuracy50: 0.4228 - val_loss: 12.9508 - val_accuracy10: 0.4177 - val_accuracy20: 0.4101 - val_accuracy30: 0.4035 - val_accuracy50: 0.3959 - 7s/epoch - 22ms/step
Epoch 9/50
331/331 - 7s - loss: 12.7182 - accuracy10: 0.4488 - accuracy20: 0.4430 - accuracy30: 0.4378 - accuracy50: 0.4257 - val_loss: 12.9664 - val_accuracy10: 0.4117 - val_accuracy20: 0.4067 - val_accuracy30: 0.4022 - val_accuracy50: 0.3944 - 7s/epoch - 22ms/step
Epoch 10/50
331/331 - 7s - loss: 12.7018 - accuracy10: 0.4500 - accuracy20: 0.4454 - accuracy30: 0.4394 - accuracy50: 0.4263 - val_loss: 12.9680 - val_accuracy10: 0.4144 - val_accuracy20: 0.4080 - val_accuracy30: 0.4038 - val_accuracy50: 0.3959 - 7s/epoch - 22ms/step
Epoch 11/50
331/331 - 7s - loss: 12.6818 - accuracy10: 0.4531 - accuracy20: 0.4467 - accuracy30: 0.4421 - accuracy50: 0.4299 - val_loss: 13.0104 - val_accuracy10: 0.4044 - val_accuracy20: 0.4036 - val_accuracy30: 0.4032 - val_accuracy50: 0.3939 - 7s/epoch - 22ms/step
Epoch 12/50
331/331 - 7s - loss: 12.6657 - accuracy10: 0.4532 - accuracy20: 0.4482 - accuracy30: 0.4427 - accuracy50: 0.4303 - val_loss: 12.9938 - val_accuracy10: 0.4094 - val_accuracy20: 0.4043 - val_accuracy30: 0.4016 - val_accuracy50: 0.3968 - 7s/epoch - 22ms/step
Epoch 13/50
331/331 - 8s - loss: 12.6541 - accuracy10: 0.4537 - accuracy20: 0.4494 - accuracy30: 0.4446 - accuracy50: 0.4314 - val_loss: 12.9634 - val_accuracy10: 0.4165 - val_accuracy20: 0.4108 - val_accuracy30: 0.4077 - val_accuracy50: 0.4010 - 8s/epoch - 24ms/step
Epoch 14/50
331/331 - 7s - loss: 12.6379 - accuracy10: 0.4561 - accuracy20: 0.4525 - accuracy30: 0.4475 - accuracy50: 0.4340 - val_loss: 12.9702 - val_accuracy10: 0.4113 - val_accuracy20: 0.4076 - val_accuracy30: 0.4045 - val_accuracy50: 0.3983 - 7s/epoch - 21ms/step
Epoch 15/50
331/331 - 7s - loss: 12.6189 - accuracy10: 0.4585 - accuracy20: 0.4531 - accuracy30: 0.4497 - accuracy50: 0.4366 - val_loss: 12.9518 - val_accuracy10: 0.4197 - val_accuracy20: 0.4142 - val_accuracy30: 0.4120 - val_accuracy50: 0.4044 - 7s/epoch - 21ms/step
Epoch 16/50
331/331 - 7s - loss: 12.6084 - accuracy10: 0.4584 - accuracy20: 0.4544 - accuracy30: 0.4492 - accuracy50: 0.4361 - val_loss: 12.9509 - val_accuracy10: 0.4181 - val_accuracy20: 0.4142 - val_accuracy30: 0.4101 - val_accuracy50: 0.4011 - 7s/epoch - 22ms/step
testing model: results/CHTR/W5/deepOF_L1/seq2seq
Evaluating performance on  test set...
2027/2027 - 21s - 21s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0803064
{'0': {'precision': 0.4733014522775856, 'recall': 0.22922370043065496, 'f1-score': 0.3088627073124256, 'support': 187389}, '1': {'precision': 0.36068186333365004, 'recall': 0.56569508700865, 'f1-score': 0.440503097547017, 'support': 147629}, '2': {'precision': 0.4432687611916002, 'recall': 0.47394127949351117, 'f1-score': 0.4580921588728544, 'support': 183854}, 'accuracy': 0.4116680028985954, 'macro avg': {'precision': 0.425750692267612, 'recall': 0.4229533556442721, 'f1-score': 0.4024859879107657, 'support': 518872}, 'weighted avg': {'precision': 0.4306174229155714, 'recall': 0.4116680028985954, 'f1-score': 0.39919398507868314, 'support': 518872}}
[[42954 80715 63720]
 [18396 83513 45720]
 [29404 67314 87136]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0870417
{'0': {'precision': 0.4747366669044392, 'recall': 0.21114189632198982, 'f1-score': 0.29228730996420704, 'support': 189124}, '1': {'precision': 0.34632469859752146, 'recall': 0.5531413137685687, 'f1-score': 0.42595605868155345, 'support': 148839}, '2': {'precision': 0.4319667471934063, 'recall': 0.4704741057658823, 'f1-score': 0.45039886756009473, 'support': 180909}, 'accuracy': 0.39966311537334837, 'macro avg': {'precision': 0.41767603756512234, 'recall': 0.41158577195214696, 'f1-score': 0.3895474120686184, 'support': 518872}, 'weighted avg': {'precision': 0.4229894684511857, 'recall': 0.39966311537334837, 'f1-score': 0.3857572344609145, 'support': 518872}}
[[39932 85984 63208]
 [17795 82329 48715]
 [26387 69409 85113]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0916482
{'0': {'precision': 0.4721248805352023, 'recall': 0.19538047777250436, 'f1-score': 0.27638425243841036, 'support': 189630}, '1': {'precision': 0.33685210077815736, 'recall': 0.5436217568114423, 'f1-score': 0.4159581326172699, 'support': 150739}, '2': {'precision': 0.42152894029320753, 'recall': 0.4655159857257301, 'f1-score': 0.44243184171784694, 'support': 178503}, 'accuracy': 0.38948141352780646, 'macro avg': {'precision': 0.4101686405355223, 'recall': 0.4015060734365589, 'f1-score': 0.37825807559117575, 'support': 518872}, 'weighted avg': {'precision': 0.41542031627115655, 'recall': 0.38948141352780646, 'f1-score': 0.3740561637256418, 'support': 518872}}
[[37050 89592 62988]
 [17748 81945 51046]
 [23677 71730 83096]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0974268
{'0': {'precision': 0.45462231108844725, 'recall': 0.18079934250903248, 'f1-score': 0.2587114067308647, 'support': 187379}, '1': {'precision': 0.3355082042761682, 'recall': 0.5242396488014401, 'f1-score': 0.4091588075506672, 'support': 158315}, '2': {'precision': 0.3975236316008569, 'recall': 0.4521648246313042, 'f1-score': 0.4230873135941214, 'support': 173178}, 'accuracy': 0.3761582818113138, 'macro avg': {'precision': 0.3958847156551575, 'recall': 0.3857346053139256, 'f1-score': 0.36365250929188436, 'support': 518872}, 'weighted avg': {'precision': 0.39922177890269067, 'recall': 0.3761582818113138, 'f1-score': 0.3594768576697323, 'support': 518872}}
[[33878 91284 62217]
 [18860 82995 56460]
 [21781 73092 78305]]
Evaluating performance on  train set...
331/331 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.06116
{'0': {'precision': 0.4874347747855815, 'recall': 0.288467681823022, 'f1-score': 0.36244035142487624, 'support': 28173}, '1': {'precision': 0.4089119495215498, 'recall': 0.5554650421477652, 'f1-score': 0.47105290822532925, 'support': 28234}, '2': {'precision': 0.44150072933274537, 'recall': 0.4632002277742188, 'f1-score': 0.45209024436841105, 'support': 28098}, 'accuracy': 0.4357730311815869, 'macro avg': {'precision': 0.4459491512132922, 'recall': 0.435710983915002, 'f1-score': 0.4285278346728722, 'support': 84505}, 'weighted avg': {'precision': 0.4459263639502646, 'recall': 0.4357730311815869, 'f1-score': 0.42853761928632145, 'support': 84505}}
[[ 8127 12012  8034]
 [ 4121 15683  8430]
 [ 4425 10658 13015]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0661321
{'0': {'precision': 0.49877041427580554, 'recall': 0.2779241769438881, 'f1-score': 0.3569494584837545, 'support': 28461}, '1': {'precision': 0.39267042674289837, 'recall': 0.55037360574667, 'f1-score': 0.458335838393555, 'support': 27703}, '2': {'precision': 0.44431029278599454, 'recall': 0.4674499841219435, 'f1-score': 0.45558650572578147, 'support': 28341}, 'accuracy': 0.43080291107035085, 'macro avg': {'precision': 0.4452503779348995, 'recall': 0.4319159222708339, 'f1-score': 0.42362393420103034, 'support': 84505}, 'weighted avg': {'precision': 0.445723348921485, 'recall': 0.43080291107035085, 'f1-score': 0.42326718451804224, 'support': 84505}}
[[ 7910 12575  7976]
 [ 3863 15247  8593]
 [ 4086 11007 13248]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0690471
{'0': {'precision': 0.4937288473024089, 'recall': 0.2625542576842997, 'f1-score': 0.34280974980417456, 'support': 28337}, '1': {'precision': 0.38468164888900147, 'recall': 0.5440960401361763, 'f1-score': 0.45070798824472347, 'support': 27905}, '2': {'precision': 0.4421196649647946, 'recall': 0.4687754307752185, 'f1-score': 0.45505753048256914, 'support': 28263}, 'accuracy': 0.4244955919768061, 'macro avg': {'precision': 0.4401767203854017, 'recall': 0.4251419095318982, 'f1-score': 0.4161917561771557, 'support': 84505}, 'weighted avg': {'precision': 0.44045871663399727, 'recall': 0.4244955919768061, 'f1-score': 0.4159812706490593, 'support': 84505}}
[[ 7440 13008  7889]
 [ 3893 15183  8829]
 [ 3736 11278 13249]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0754896
{'0': {'precision': 0.4833529452481484, 'recall': 0.24693235262915944, 'f1-score': 0.3268735664466601, 'support': 28279}, '1': {'precision': 0.37419435736677115, 'recall': 0.5357053100204646, 'f1-score': 0.4406154027876211, 'support': 27853}, '2': {'precision': 0.4337872312228738, 'recall': 0.4614598385789307, 'f1-score': 0.447195846710841, 'support': 28373}, 'accuracy': 0.4141411750783977, 'macro avg': {'precision': 0.43044484461259785, 'recall': 0.41469916707618487, 'f1-score': 0.40489493864837406, 'support': 84505}, 'weighted avg': {'precision': 0.430732128109528, 'recall': 0.4141411750783977, 'f1-score': 0.40476192128412997, 'support': 84505}}
[[ 6983 13304  7992]
 [ 3834 14921  9098]
 [ 3630 11650 13093]]
Evaluating performance on  val set...
136/136 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0728341
{'0': {'precision': 0.4806301652892562, 'recall': 0.30166963851515644, 'f1-score': 0.3706802111343492, 'support': 12338}, '1': {'precision': 0.3724699078743864, 'recall': 0.5257712387280493, 'f1-score': 0.4360387310084232, 'support': 10535}, '2': {'precision': 0.44210090984284534, 'recall': 0.4517410412440838, 'f1-score': 0.44686899088704957, 'support': 11832}, 'accuracy': 0.42086154732747444, 'macro avg': {'precision': 0.43173366100216265, 'recall': 0.4263939728290966, 'f1-score': 0.41786264434327397, 'support': 34705}, 'weighted avg': {'precision': 0.4346613866605979, 'recall': 0.42086154732747444, 'f1-score': 0.4164954437782714, 'support': 34705}}
[[3722 5095 3521]
 [1772 5539 3224]
 [2250 4237 5345]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.076562
{'0': {'precision': 0.47435542001663433, 'recall': 0.2758342737385136, 'f1-score': 0.3488277268093781, 'support': 12406}, '1': {'precision': 0.358507793647688, 'recall': 0.5257268553940322, 'f1-score': 0.42630578929000745, 'support': 10456}, '2': {'precision': 0.44538575423589405, 'recall': 0.4572321202398041, 'f1-score': 0.4512311987000542, 'support': 11843}, 'accuracy': 0.41302405993372715, 'macro avg': {'precision': 0.42608298930007216, 'recall': 0.41959774979078324, 'f1-score': 0.40878823826647986, 'support': 34705}, 'weighted avg': {'precision': 0.4295667574851544, 'recall': 0.41302405993372715, 'f1-score': 0.4071154357532979, 'support': 34705}}
[[3422 5459 3525]
 [1741 5497 3218]
 [2051 4377 5415]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0784668
{'0': {'precision': 0.4847417840375587, 'recall': 0.2650834403080873, 'f1-score': 0.34273858921161826, 'support': 12464}, '1': {'precision': 0.3477149248961329, 'recall': 0.5256038647342995, 'f1-score': 0.4185420273129448, 'support': 10350}, '2': {'precision': 0.45034302515517804, 'recall': 0.4637120511311076, 'f1-score': 0.4569297700435053, 'support': 11891}, 'accuracy': 0.4108341737501801, 'macro avg': {'precision': 0.42759991136295655, 'recall': 0.41813311872449815, 'f1-score': 0.40607012885602284, 'support': 34705}, 'weighted avg': {'precision': 0.4320904763301925, 'recall': 0.4108341737501801, 'f1-score': 0.40447070030859844, 'support': 34705}}
[[3304 5689 3471]
 [1651 5440 3259]
 [1861 4516 5514]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0833508
{'0': {'precision': 0.480226854690374, 'recall': 0.25122283698179776, 'f1-score': 0.32987628323242957, 'support': 12471}, '1': {'precision': 0.3371317048602367, 'recall': 0.517491302667182, 'f1-score': 0.40827996340347666, 'support': 10348}, '2': {'precision': 0.44051394649101405, 'recall': 0.455746256099613, 'f1-score': 0.44800066162180047, 'support': 11886}, 'accuracy': 0.4006627287134419, 'macro avg': {'precision': 0.4192908353472083, 'recall': 0.40815346524953094, 'f1-score': 0.3953856360859022, 'support': 34705}, 'weighted avg': {'precision': 0.4239589901953487, 'recall': 0.4006627287134419, 'f1-score': 0.3937099568802053, 'support': 34705}}
[[3133 5865 3473]
 [1586 5355 3407]
 [1805 4664 5417]]
training model: results/CHTR/W5/deepLOB_L2/seq2seq
Epoch 1/50
331/331 - 23s - loss: 13.2567 - accuracy10: 0.3558 - accuracy20: 0.3552 - accuracy30: 0.3549 - accuracy50: 0.3540 - val_loss: 13.4794 - val_accuracy10: 0.3336 - val_accuracy20: 0.3218 - val_accuracy30: 0.3189 - val_accuracy50: 0.3196 - 23s/epoch - 69ms/step
Epoch 2/50
331/331 - 16s - loss: 13.1713 - accuracy10: 0.3635 - accuracy20: 0.3640 - accuracy30: 0.3642 - accuracy50: 0.3601 - val_loss: 13.3532 - val_accuracy10: 0.3506 - val_accuracy20: 0.3420 - val_accuracy30: 0.3404 - val_accuracy50: 0.3348 - 16s/epoch - 49ms/step
Epoch 3/50
331/331 - 16s - loss: 13.0738 - accuracy10: 0.3853 - accuracy20: 0.3850 - accuracy30: 0.3820 - accuracy50: 0.3755 - val_loss: 13.1941 - val_accuracy10: 0.3695 - val_accuracy20: 0.3651 - val_accuracy30: 0.3654 - val_accuracy50: 0.3628 - 16s/epoch - 50ms/step
Epoch 4/50
331/331 - 16s - loss: 13.0101 - accuracy10: 0.3977 - accuracy20: 0.3968 - accuracy30: 0.3925 - accuracy50: 0.3843 - val_loss: 13.1046 - val_accuracy10: 0.3846 - val_accuracy20: 0.3795 - val_accuracy30: 0.3793 - val_accuracy50: 0.3696 - 16s/epoch - 50ms/step
Epoch 5/50
331/331 - 16s - loss: 12.9453 - accuracy10: 0.4105 - accuracy20: 0.4089 - accuracy30: 0.4055 - accuracy50: 0.3961 - val_loss: 13.0471 - val_accuracy10: 0.3920 - val_accuracy20: 0.3911 - val_accuracy30: 0.3883 - val_accuracy50: 0.3781 - 16s/epoch - 50ms/step
Epoch 6/50
331/331 - 16s - loss: 12.8834 - accuracy10: 0.4223 - accuracy20: 0.4196 - accuracy30: 0.4156 - accuracy50: 0.4039 - val_loss: 13.0479 - val_accuracy10: 0.3986 - val_accuracy20: 0.3975 - val_accuracy30: 0.3934 - val_accuracy50: 0.3835 - 16s/epoch - 49ms/step
Epoch 7/50
331/331 - 16s - loss: 12.8439 - accuracy10: 0.4282 - accuracy20: 0.4257 - accuracy30: 0.4211 - accuracy50: 0.4087 - val_loss: 13.0329 - val_accuracy10: 0.4026 - val_accuracy20: 0.3996 - val_accuracy30: 0.3965 - val_accuracy50: 0.3849 - 16s/epoch - 50ms/step
Epoch 8/50
331/331 - 16s - loss: 12.8075 - accuracy10: 0.4342 - accuracy20: 0.4314 - accuracy30: 0.4259 - accuracy50: 0.4127 - val_loss: 13.0653 - val_accuracy10: 0.4002 - val_accuracy20: 0.3967 - val_accuracy30: 0.3959 - val_accuracy50: 0.3810 - 16s/epoch - 50ms/step
Epoch 9/50
331/331 - 16s - loss: 12.7609 - accuracy10: 0.4408 - accuracy20: 0.4371 - accuracy30: 0.4329 - accuracy50: 0.4175 - val_loss: 13.1133 - val_accuracy10: 0.3978 - val_accuracy20: 0.3952 - val_accuracy30: 0.3940 - val_accuracy50: 0.3809 - 16s/epoch - 49ms/step
Epoch 10/50
331/331 - 16s - loss: 12.7276 - accuracy10: 0.4441 - accuracy20: 0.4405 - accuracy30: 0.4358 - accuracy50: 0.4203 - val_loss: 13.1174 - val_accuracy10: 0.4026 - val_accuracy20: 0.3989 - val_accuracy30: 0.3962 - val_accuracy50: 0.3846 - 16s/epoch - 50ms/step
Epoch 11/50
331/331 - 17s - loss: 12.6884 - accuracy10: 0.4486 - accuracy20: 0.4469 - accuracy30: 0.4410 - accuracy50: 0.4261 - val_loss: 13.1470 - val_accuracy10: 0.3983 - val_accuracy20: 0.3946 - val_accuracy30: 0.3950 - val_accuracy50: 0.3837 - 17s/epoch - 50ms/step
Epoch 12/50
331/331 - 16s - loss: 12.6495 - accuracy10: 0.4548 - accuracy20: 0.4516 - accuracy30: 0.4451 - accuracy50: 0.4297 - val_loss: 13.2095 - val_accuracy10: 0.4008 - val_accuracy20: 0.3983 - val_accuracy30: 0.3940 - val_accuracy50: 0.3825 - 16s/epoch - 50ms/step
Epoch 13/50
331/331 - 16s - loss: 12.6161 - accuracy10: 0.4563 - accuracy20: 0.4539 - accuracy30: 0.4493 - accuracy50: 0.4325 - val_loss: 13.2640 - val_accuracy10: 0.4016 - val_accuracy20: 0.3957 - val_accuracy30: 0.3945 - val_accuracy50: 0.3865 - 16s/epoch - 50ms/step
Epoch 14/50
331/331 - 16s - loss: 12.5823 - accuracy10: 0.4608 - accuracy20: 0.4567 - accuracy30: 0.4531 - accuracy50: 0.4356 - val_loss: 13.3146 - val_accuracy10: 0.3991 - val_accuracy20: 0.3937 - val_accuracy30: 0.3923 - val_accuracy50: 0.3829 - 16s/epoch - 49ms/step
Epoch 15/50
331/331 - 16s - loss: 12.5445 - accuracy10: 0.4634 - accuracy20: 0.4622 - accuracy30: 0.4566 - accuracy50: 0.4398 - val_loss: 13.3677 - val_accuracy10: 0.3964 - val_accuracy20: 0.3909 - val_accuracy30: 0.3904 - val_accuracy50: 0.3805 - 16s/epoch - 49ms/step
Epoch 16/50
331/331 - 16s - loss: 12.5057 - accuracy10: 0.4663 - accuracy20: 0.4670 - accuracy30: 0.4626 - accuracy50: 0.4441 - val_loss: 13.2723 - val_accuracy10: 0.4064 - val_accuracy20: 0.3977 - val_accuracy30: 0.3920 - val_accuracy50: 0.3801 - 16s/epoch - 49ms/step
Epoch 17/50
331/331 - 16s - loss: 12.4693 - accuracy10: 0.4705 - accuracy20: 0.4710 - accuracy30: 0.4645 - accuracy50: 0.4463 - val_loss: 13.4424 - val_accuracy10: 0.3937 - val_accuracy20: 0.3878 - val_accuracy30: 0.3844 - val_accuracy50: 0.3762 - 16s/epoch - 49ms/step
testing model: results/CHTR/W5/deepLOB_L2/seq2seq
Evaluating performance on  test set...
2027/2027 - 36s - 36s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0871576
{'0': {'precision': 0.4364617887819583, 'recall': 0.18466300229467955, 'f1-score': 0.25952383630888765, 'support': 187390}, '1': {'precision': 0.35434250723490285, 'recall': 0.5366081649518055, 'f1-score': 0.4268318965517241, 'support': 147631}, '2': {'precision': 0.42028931836592986, 'recall': 0.49382669045339833, 'f1-score': 0.4541000947781965, 'support': 183856}, 'accuracy': 0.3943458661686681, 'macro avg': {'precision': 0.4036978714609303, 'recall': 0.4050326192332945, 'f1-score': 0.38015194254626944, 'support': 518877}, 'weighted avg': {'precision': 0.40736672892214054, 'recall': 0.3943458661686681, 'f1-score': 0.37607143587264447, 'support': 518877}}
[[34604 78851 73935]
 [17114 79220 51297]
 [27565 65498 90793]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0908937
{'0': {'precision': 0.4336241721225322, 'recall': 0.18105390057422036, 'f1-score': 0.2554486689320497, 'support': 189126}, '1': {'precision': 0.34652958162770353, 'recall': 0.5135850577801666, 'f1-score': 0.4138341729082134, 'support': 148840}, '2': {'precision': 0.40645731977001326, 'recall': 0.4927450514341306, 'f1-score': 0.4454610871803072, 'support': 180911}, 'accuracy': 0.38511439127191993, 'macro avg': {'precision': 0.3955370245067496, 'recall': 0.39579466992950585, 'f1-score': 0.37158130967352343, 'support': 518877}, 'weighted avg': {'precision': 0.39916910613348877, 'recall': 0.38511439127191993, 'f1-score': 0.36713108115984683, 'support': 518877}}
[[34242 79554 75330]
 [17554 76442 54844]
 [27171 64597 89143]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0942144
{'0': {'precision': 0.42734601485246815, 'recall': 0.170241152554171, 'f1-score': 0.2434854095801248, 'support': 189631}, '1': {'precision': 0.3426456900270154, 'recall': 0.5006368581663792, 'f1-score': 0.40684124695068535, 'support': 150740}, '2': {'precision': 0.39631268238236755, 'recall': 0.49529427582266145, 'f1-score': 0.44030926679864046, 'support': 178506}, 'accuracy': 0.3780510602705458, 'macro avg': {'precision': 0.3887681290872837, 'recall': 0.38872409551440384, 'f1-score': 0.3635453077764835, 'support': 518877}, 'weighted avg': {'precision': 0.39206335054070157, 'recall': 0.3780510602705458, 'f1-score': 0.3586543193253759, 'support': 518877}}
[[32283 80395 76953]
 [17551 75466 57723]
 [25709 64384 88413]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0991621
{'0': {'precision': 0.4121628318584071, 'recall': 0.1553474223503042, 'f1-score': 0.22564678979089553, 'support': 187380}, '1': {'precision': 0.34601055783099344, 'recall': 0.4839877207610096, 'f1-score': 0.40353062304647896, 'support': 158316}, '2': {'precision': 0.3769273164171866, 'recall': 0.4936396024968097, 'f1-score': 0.42745996109863843, 'support': 173181}, 'accuracy': 0.368528572282063, 'macro avg': {'precision': 0.378366902035529, 'recall': 0.3776582485360412, 'f1-score': 0.35221245797867096, 'support': 518877}, 'weighted avg': {'precision': 0.38021868090442373, 'recall': 0.368528572282063, 'f1-score': 0.34727882159407275, 'support': 518877}}
[[29109 80695 77576]
 [17953 76623 63740]
 [23563 64129 85489]]
Evaluating performance on  train set...
331/331 - 6s - 6s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.076525
{'0': {'precision': 0.4351082290620148, 'recall': 0.16985168282943525, 'f1-score': 0.24432648665281945, 'support': 28048}, '1': {'precision': 0.38688800168102544, 'recall': 0.649842939328698, 'f1-score': 0.4850177153168342, 'support': 28333}, '2': {'precision': 0.42647002194924716, 'recall': 0.3937497777935791, 'f1-score': 0.4094572611653357, 'support': 28127}, 'accuracy': 0.4052989066123917, 'macro avg': {'precision': 0.4161554175640958, 'recall': 0.4044814666505707, 'f1-score': 0.37960048771166316, 'support': 84508}, 'weighted avg': {'precision': 0.4160663566493865, 'recall': 0.4052989066123917, 'f1-score': 0.37998391407331306, 'support': 84508}}
[[ 4764 15704  7580]
 [ 2607 18412  7314]
 [ 3578 13474 11075]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0786803
{'0': {'precision': 0.43953532660445627, 'recall': 0.16261537377580498, 'f1-score': 0.23739971199341697, 'support': 28386}, '1': {'precision': 0.3756045023546555, 'recall': 0.6402447804175666, 'f1-score': 0.47345374203079876, 'support': 27780}, '2': {'precision': 0.4267061869207969, 'recall': 0.4012772563686402, 'f1-score': 0.4136012364760433, 'support': 28342}, 'accuracy': 0.3996663037818905, 'macro avg': {'precision': 0.4139486719599696, 'recall': 0.4013791368540039, 'f1-score': 0.37481823016675303, 'support': 84508}, 'weighted avg': {'precision': 0.414216992546453, 'recall': 0.3996663037818905, 'f1-score': 0.3740907301375579, 'support': 84508}}
[[ 4616 15965  7805]
 [ 2519 17786  7475]
 [ 3367 13602 11373]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0797822
{'0': {'precision': 0.4387022980139337, 'recall': 0.149176154444523, 'f1-score': 0.2226443969497876, 'support': 28282}, '1': {'precision': 0.3745535526702803, 'recall': 0.6370328021153434, 'f1-score': 0.47174005080440307, 'support': 27986}, '2': {'precision': 0.4258601106510827, 'recall': 0.41157932011331444, 'f1-score': 0.4185979507680119, 'support': 28240}, 'accuracy': 0.39842381786339753, 'macro avg': {'precision': 0.41303865377843224, 'recall': 0.3992627588910603, 'f1-score': 0.3709941328407342, 'support': 84508}, 'weighted avg': {'precision': 0.413167080539678, 'recall': 0.39842381786339753, 'f1-score': 0.3706175986419578, 'support': 84508}}
[[ 4219 16121  7942]
 [ 2430 17828  7728]
 [ 2968 13649 11623]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0847937
{'0': {'precision': 0.42404698836807553, 'recall': 0.13011060461500407, 'f1-score': 0.19912389811259534, 'support': 28299}, '1': {'precision': 0.3634582925253704, 'recall': 0.6283820297582592, 'f1-score': 0.46053917038523484, 'support': 27757}, '2': {'precision': 0.4211452794941802, 'recall': 0.41202727400534234, 'f1-score': 0.41653638430926665, 'support': 28452}, 'accuracy': 0.3886850949022578, 'macro avg': {'precision': 0.4028835201292087, 'recall': 0.3901733027928685, 'f1-score': 0.35873315093569896, 'support': 84508}, 'weighted avg': {'precision': 0.4031694400722214, 'recall': 0.3886850949022578, 'f1-score': 0.3581848600302759, 'support': 84508}}
[[ 3682 16497  8120]
 [ 2322 17442  7993]
 [ 2679 14050 11723]]
Evaluating performance on  val set...
136/136 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0838513
{'0': {'precision': 0.4284379671150972, 'recall': 0.18672638436482084, 'f1-score': 0.26009528130671505, 'support': 12280}, '1': {'precision': 0.3794591953086822, 'recall': 0.4402759402759403, 'f1-score': 0.4076115485564305, 'support': 10582}, '2': {'precision': 0.40831625183016107, 'recall': 0.5887021869458752, 'f1-score': 0.4821910228923162, 'support': 11843}, 'accuracy': 0.40121020025932863, 'macro avg': {'precision': 0.40540447141798014, 'recall': 0.4052348371955454, 'f1-score': 0.3832992842518206, 'support': 34705}, 'weighted avg': {'precision': 0.4066372226294328, 'recall': 0.40121020025932863, 'f1-score': 0.38086453667726, 'support': 34705}}
[[2293 4432 5555]
 [1375 4659 4548]
 [1684 3187 6972]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0849292
{'0': {'precision': 0.42873629544143105, 'recall': 0.17906491002570693, 'f1-score': 0.25262084206947355, 'support': 12448}, '1': {'precision': 0.36655601659751036, 'recall': 0.42594021215043393, 'f1-score': 0.39402319357716326, 'support': 10370}, '2': {'precision': 0.409429422548121, 'recall': 0.6012450576259779, 'f1-score': 0.48713492144634146, 'support': 11887}, 'accuracy': 0.39743552802189885, 'macro avg': {'precision': 0.40157391152902083, 'recall': 0.4020833932673729, 'f1-score': 0.3779263190309927, 'support': 34705}, 'weighted avg': {'precision': 0.4035436635528204, 'recall': 0.39743552802189885, 'f1-score': 0.3751971638296686, 'support': 34705}}
[[2229 4484 5735]
 [1379 4417 4574]
 [1591 3149 7147]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0861863
{'0': {'precision': 0.43336745138178095, 'recall': 0.16968579672972106, 'f1-score': 0.2438799608317493, 'support': 12476}, '1': {'precision': 0.3642737896494157, 'recall': 0.42476153396924277, 'f1-score': 0.3921991552080525, 'support': 10274}, '2': {'precision': 0.40969730941704036, 'recall': 0.6113759933082392, 'f1-score': 0.49061923141466685, 'support': 11955}, 'accuracy': 0.3973490851462325, 'macro avg': {'precision': 0.4024461834827457, 'recall': 0.40194110800240096, 'f1-score': 0.37556611581815624, 'support': 34705}, 'weighted avg': {'precision': 0.4047593307125173, 'recall': 0.3973490851462325, 'f1-score': 0.3727835592423794, 'support': 34705}}
[[2117 4446 5913]
 [1292 4364 4618]
 [1476 3170 7309]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.09252
{'0': {'precision': 0.41549766199064797, 'recall': 0.14993973483326636, 'f1-score': 0.2203589985829003, 'support': 12445}, '1': {'precision': 0.35515331845607073, 'recall': 0.4150086922928337, 'f1-score': 0.38275508840689443, 'support': 10354}, '2': {'precision': 0.39961357990615515, 'recall': 0.6080127666722661, 'f1-score': 0.482262416308584, 'support': 11906}, 'accuracy': 0.38616913989338714, 'macro avg': {'precision': 0.3900881867842913, 'recall': 0.39098706459945537, 'f1-score': 0.3617921677661262, 'support': 34705}, 'weighted avg': {'precision': 0.39204509854863717, 'recall': 0.38616913989338714, 'f1-score': 0.35865812566774763, 'support': 34705}}
[[1866 4535 6044]
 [1225 4297 4832]
 [1400 3267 7239]]
training model: results/CHTR/W5/deepOF_L2/seq2seq
Epoch 1/50
331/331 - 15s - loss: 13.1773 - accuracy10: 0.3808 - accuracy20: 0.3783 - accuracy30: 0.3731 - accuracy50: 0.3687 - val_loss: 13.2099 - val_accuracy10: 0.3750 - val_accuracy20: 0.3709 - val_accuracy30: 0.3674 - val_accuracy50: 0.3593 - 15s/epoch - 47ms/step
Epoch 2/50
331/331 - 10s - loss: 12.9439 - accuracy10: 0.4215 - accuracy20: 0.4147 - accuracy30: 0.4075 - accuracy50: 0.3991 - val_loss: 13.0120 - val_accuracy10: 0.4082 - val_accuracy20: 0.4009 - val_accuracy30: 0.3990 - val_accuracy50: 0.3916 - 10s/epoch - 31ms/step
Epoch 3/50
331/331 - 10s - loss: 12.8239 - accuracy10: 0.4379 - accuracy20: 0.4294 - accuracy30: 0.4229 - accuracy50: 0.4106 - val_loss: 12.9476 - val_accuracy10: 0.4146 - val_accuracy20: 0.4068 - val_accuracy30: 0.4054 - val_accuracy50: 0.3950 - 10s/epoch - 31ms/step
Epoch 4/50
331/331 - 10s - loss: 12.7608 - accuracy10: 0.4472 - accuracy20: 0.4378 - accuracy30: 0.4289 - accuracy50: 0.4146 - val_loss: 12.8635 - val_accuracy10: 0.4267 - val_accuracy20: 0.4182 - val_accuracy30: 0.4140 - val_accuracy50: 0.4037 - 10s/epoch - 31ms/step
Epoch 5/50
331/331 - 10s - loss: 12.7061 - accuracy10: 0.4541 - accuracy20: 0.4454 - accuracy30: 0.4361 - accuracy50: 0.4219 - val_loss: 12.8653 - val_accuracy10: 0.4293 - val_accuracy20: 0.4219 - val_accuracy30: 0.4170 - val_accuracy50: 0.4068 - 10s/epoch - 30ms/step
Epoch 6/50
331/331 - 10s - loss: 12.6661 - accuracy10: 0.4587 - accuracy20: 0.4505 - accuracy30: 0.4424 - accuracy50: 0.4275 - val_loss: 12.8106 - val_accuracy10: 0.4340 - val_accuracy20: 0.4280 - val_accuracy30: 0.4234 - val_accuracy50: 0.4108 - 10s/epoch - 30ms/step
Epoch 7/50
331/331 - 10s - loss: 12.6297 - accuracy10: 0.4635 - accuracy20: 0.4539 - accuracy30: 0.4463 - accuracy50: 0.4304 - val_loss: 12.8018 - val_accuracy10: 0.4380 - val_accuracy20: 0.4299 - val_accuracy30: 0.4254 - val_accuracy50: 0.4127 - 10s/epoch - 31ms/step
Epoch 8/50
331/331 - 10s - loss: 12.5852 - accuracy10: 0.4667 - accuracy20: 0.4590 - accuracy30: 0.4505 - accuracy50: 0.4346 - val_loss: 12.8176 - val_accuracy10: 0.4377 - val_accuracy20: 0.4296 - val_accuracy30: 0.4255 - val_accuracy50: 0.4138 - 10s/epoch - 31ms/step
Epoch 9/50
331/331 - 10s - loss: 12.5491 - accuracy10: 0.4692 - accuracy20: 0.4633 - accuracy30: 0.4556 - accuracy50: 0.4383 - val_loss: 12.8051 - val_accuracy10: 0.4407 - val_accuracy20: 0.4326 - val_accuracy30: 0.4282 - val_accuracy50: 0.4169 - 10s/epoch - 30ms/step
Epoch 10/50
331/331 - 10s - loss: 12.5223 - accuracy10: 0.4691 - accuracy20: 0.4653 - accuracy30: 0.4586 - accuracy50: 0.4408 - val_loss: 12.8449 - val_accuracy10: 0.4342 - val_accuracy20: 0.4280 - val_accuracy30: 0.4253 - val_accuracy50: 0.4140 - 10s/epoch - 30ms/step
Epoch 11/50
331/331 - 10s - loss: 12.4856 - accuracy10: 0.4739 - accuracy20: 0.4707 - accuracy30: 0.4636 - accuracy50: 0.4456 - val_loss: 12.8495 - val_accuracy10: 0.4362 - val_accuracy20: 0.4316 - val_accuracy30: 0.4283 - val_accuracy50: 0.4164 - 10s/epoch - 31ms/step
Epoch 12/50
331/331 - 10s - loss: 12.4458 - accuracy10: 0.4766 - accuracy20: 0.4727 - accuracy30: 0.4661 - accuracy50: 0.4498 - val_loss: 12.8391 - val_accuracy10: 0.4384 - val_accuracy20: 0.4319 - val_accuracy30: 0.4309 - val_accuracy50: 0.4219 - 10s/epoch - 30ms/step
Epoch 13/50
331/331 - 10s - loss: 12.4052 - accuracy10: 0.4800 - accuracy20: 0.4772 - accuracy30: 0.4719 - accuracy50: 0.4527 - val_loss: 12.9065 - val_accuracy10: 0.4311 - val_accuracy20: 0.4263 - val_accuracy30: 0.4237 - val_accuracy50: 0.4157 - 10s/epoch - 31ms/step
Epoch 14/50
331/331 - 10s - loss: 12.3784 - accuracy10: 0.4831 - accuracy20: 0.4802 - accuracy30: 0.4745 - accuracy50: 0.4568 - val_loss: 12.9460 - val_accuracy10: 0.4333 - val_accuracy20: 0.4291 - val_accuracy30: 0.4255 - val_accuracy50: 0.4149 - 10s/epoch - 30ms/step
Epoch 15/50
331/331 - 10s - loss: 12.3388 - accuracy10: 0.4851 - accuracy20: 0.4851 - accuracy30: 0.4789 - accuracy50: 0.4586 - val_loss: 12.8999 - val_accuracy10: 0.4390 - val_accuracy20: 0.4354 - val_accuracy30: 0.4308 - val_accuracy50: 0.4193 - 10s/epoch - 31ms/step
Epoch 16/50
331/331 - 11s - loss: 12.2892 - accuracy10: 0.4877 - accuracy20: 0.4889 - accuracy30: 0.4854 - accuracy50: 0.4664 - val_loss: 12.9103 - val_accuracy10: 0.4352 - val_accuracy20: 0.4287 - val_accuracy30: 0.4283 - val_accuracy50: 0.4170 - 11s/epoch - 32ms/step
Epoch 17/50
331/331 - 10s - loss: 12.2396 - accuracy10: 0.4921 - accuracy20: 0.4937 - accuracy30: 0.4904 - accuracy50: 0.4711 - val_loss: 13.0327 - val_accuracy10: 0.4353 - val_accuracy20: 0.4275 - val_accuracy30: 0.4259 - val_accuracy50: 0.4153 - 10s/epoch - 31ms/step
testing model: results/CHTR/W5/deepOF_L2/seq2seq
Evaluating performance on  test set...
2027/2027 - 23s - 23s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0770998
{'0': {'precision': 0.46672953602414186, 'recall': 0.26411368863700646, 'f1-score': 0.3373354371926429, 'support': 187389}, '1': {'precision': 0.3748338502436863, 'recall': 0.5501358134241917, 'f1-score': 0.44587305552276824, 'support': 147629}, '2': {'precision': 0.44375509787928225, 'recall': 0.473457199734572, 'f1-score': 0.4581252269653224, 'support': 183854}, 'accuracy': 0.41966997641036713, 'macro avg': {'precision': 0.42843949471570353, 'recall': 0.42923556726525675, 'f1-score': 0.4137779065602445, 'support': 518872}, 'weighted avg': {'precision': 0.432442832276844, 'recall': 0.41966997641036713, 'f1-score': 0.41101639524265193, 'support': 518872}}
[[49492 74545 63352]
 [20652 81216 45761]
 [35896 60911 87047]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0838706
{'0': {'precision': 0.4663435287806654, 'recall': 0.2574131257799116, 'f1-score': 0.3317218423464399, 'support': 189124}, '1': {'precision': 0.36262815911057117, 'recall': 0.5294445676200458, 'f1-score': 0.43043914056376265, 'support': 148839}, '2': {'precision': 0.43218323181400914, 'recall': 0.47103239750371734, 'f1-score': 0.45077232331781636, 'support': 180909}, 'accuracy': 0.4099257620376509, 'macro avg': {'precision': 0.4203849732350819, 'recall': 0.41929669696789157, 'f1-score': 0.40431110207600635, 'support': 518872}, 'weighted avg': {'precision': 0.42468239256543705, 'recall': 0.4099257620376509, 'f1-score': 0.40154693873132646, 'support': 518872}}
[[48683 77039 63402]
 [21482 78802 48555]
 [34228 61467 85214]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0894411
{'0': {'precision': 0.4615997357735424, 'recall': 0.2505827137056373, 'f1-score': 0.3248294436924928, 'support': 189630}, '1': {'precision': 0.35111390593885705, 'recall': 0.511168310788847, 'f1-score': 0.41628668366685395, 'support': 150739}, '2': {'precision': 0.42195269675330954, 'recall': 0.4644403735511448, 'f1-score': 0.44217824950664036, 'support': 178503}, 'accuracy': 0.3998577683898919, 'macro avg': {'precision': 0.41155544615523637, 'recall': 0.40873046601520974, 'f1-score': 0.39443145895532905, 'support': 518872}, 'weighted avg': {'precision': 0.41586275457263105, 'recall': 0.3998577683898919, 'f1-score': 0.391769434250353, 'support': 518872}}
[[47518 79535 62577]
 [22690 77053 50996]
 [32734 62865 82904]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0977991
{'0': {'precision': 0.4419999803306419, 'recall': 0.23985078370575144, 'f1-score': 0.31095966235383654, 'support': 187379}, '1': {'precision': 0.3450229392804877, 'recall': 0.48547516028171683, 'f1-score': 0.4033725467556426, 'support': 158315}, '2': {'precision': 0.39925628378482636, 'recall': 0.44824977768538726, 'f1-score': 0.42233689782838735, 'support': 173178}, 'accuracy': 0.38434912656686043, 'macro avg': {'precision': 0.3954264011319853, 'recall': 0.39119190722428515, 'f1-score': 0.37888970231262215, 'support': 518872}, 'weighted avg': {'precision': 0.3981448712974576, 'recall': 0.38434912656686043, 'f1-score': 0.3763292191599153, 'support': 518872}}
[[44943 81673 60763]
 [25418 76858 56039]
 [31320 64231 77627]]
Evaluating performance on  train set...
331/331 - 4s - 4s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0420761
{'0': {'precision': 0.4980239323745746, 'recall': 0.32204593050083413, 'f1-score': 0.3911534564894053, 'support': 28173}, '1': {'precision': 0.4410892570526946, 'recall': 0.5742721541403981, 'f1-score': 0.4989460403428062, 'support': 28234}, '2': {'precision': 0.45980086697371986, 'recall': 0.48320165136308635, 'f1-score': 0.4712109117412279, 'support': 28098}, 'accuracy': 0.4599017809597065, 'macro avg': {'precision': 0.4663046854669963, 'recall': 0.45983991200143953, 'f1-score': 0.45377013619114653, 'support': 84505}, 'weighted avg': {'precision': 0.4662922559687859, 'recall': 0.4599017809597065, 'f1-score': 0.4537872673903299, 'support': 84505}}
[[ 9073 11016  8084]
 [ 4153 16214  7867]
 [ 4992  9529 13577]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0484205
{'0': {'precision': 0.5017411972804157, 'recall': 0.3189276553880749, 'f1-score': 0.3899725038666437, 'support': 28461}, '1': {'precision': 0.4239751755675323, 'recall': 0.5622495758582103, 'f1-score': 0.4834189413572105, 'support': 27703}, '2': {'precision': 0.46131554117805634, 'recall': 0.4830457640873646, 'f1-score': 0.47193064101901167, 'support': 28341}, 'accuracy': 0.45373646529791134, 'macro avg': {'precision': 0.46234397134200145, 'recall': 0.4547409984445499, 'f1-score': 0.4484406954142886, 'support': 84505}, 'weighted avg': {'precision': 0.4626895953739134, 'recall': 0.45373646529791134, 'f1-score': 0.44809358809641037, 'support': 84505}}
[[ 9077 11345  8039]
 [ 4180 15576  7947]
 [ 4834  9817 13690]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0543705
{'0': {'precision': 0.4985249095463401, 'recall': 0.31605321664255215, 'f1-score': 0.3868515398902855, 'support': 28337}, '1': {'precision': 0.41472868217054265, 'recall': 0.5483246729976706, 'f1-score': 0.47226037438849366, 'support': 27905}, '2': {'precision': 0.45864534844498417, 'recall': 0.48108834872448075, 'f1-score': 0.4695988533733962, 'support': 28263}, 'accuracy': 0.44794982545411516, 'macro avg': {'precision': 0.4572996467206223, 'recall': 0.44848874612156786, 'f1-score': 0.44290358921739176, 'support': 84505}, 'weighted avg': {'precision': 0.4575160963361247, 'recall': 0.44794982545411516, 'f1-score': 0.44273013698685565, 'support': 84505}}
[[ 8956 11597  7784]
 [ 4339 15301  8265]
 [ 4670  9996 13597]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0645908
{'0': {'precision': 0.48284189834316205, 'recall': 0.30400650659499984, 'f1-score': 0.373101293290513, 'support': 28279}, '1': {'precision': 0.3969781696956662, 'recall': 0.5301403798513625, 'f1-score': 0.45399621823548403, 'support': 27853}, '2': {'precision': 0.4485832429501085, 'recall': 0.46646459662355055, 'f1-score': 0.45734920607495205, 'support': 28373}, 'accuracy': 0.43308679959765695, 'macro avg': {'precision': 0.44280110366297887, 'recall': 0.4335371610233043, 'f1-score': 0.428148905866983, 'support': 84505}, 'weighted avg': {'precision': 0.44303853447728647, 'recall': 0.43308679959765695, 'f1-score': 0.4280510876686583, 'support': 84505}}
[[ 8597 11921  7761]
 [ 4579 14766  8508]
 [ 4629 10509 13235]]
Evaluating performance on  val set...
136/136 - 1s - 1s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0602491
{'0': {'precision': 0.47752808988764045, 'recall': 0.31001783109093856, 'f1-score': 0.37595832514252014, 'support': 12338}, '1': {'precision': 0.39928349330809787, 'recall': 0.5607024205030849, 'f1-score': 0.4664218879545185, 'support': 10535}, '2': {'precision': 0.4553398874044198, 'recall': 0.45799526707234617, 'f1-score': 0.45666371718703913, 'support': 11832}, 'accuracy': 0.4365653364068578, 'macro avg': {'precision': 0.44405049020005266, 'recall': 0.4429051728887899, 'f1-score': 0.4330146434280259, 'support': 34705}, 'weighted avg': {'precision': 0.44621163298670546, 'recall': 0.4365653364068578, 'f1-score': 0.43093426039378513, 'support': 34705}}
[[3825 4969 3544]
 [1690 5907 2938]
 [2495 3918 5419]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0657128
{'0': {'precision': 0.4757720311323123, 'recall': 0.30549733999677575, 'f1-score': 0.37207932456312587, 'support': 12406}, '1': {'precision': 0.385920043074438, 'recall': 0.5483932670237185, 'f1-score': 0.4530299439045588, 'support': 10456}, '2': {'precision': 0.4560222203518222, 'recall': 0.45748543443384276, 'f1-score': 0.456752655538695, 'support': 11843}, 'accuracy': 0.4305431494021034, 'macro avg': {'precision': 0.4392380981861908, 'recall': 0.43712534715144563, 'f1-score': 0.4272873080021265, 'support': 34705}, 'weighted avg': {'precision': 0.44196164657082326, 'recall': 0.4305431494021034, 'f1-score': 0.42536288412450574, 'support': 34705}}
[[3790 5108 3508]
 [1767 5734 2955]
 [2409 4016 5418]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0685347
{'0': {'precision': 0.47694652610186716, 'recall': 0.3012676508344031, 'f1-score': 0.3692776712396125, 'support': 12464}, '1': {'precision': 0.3715887102155201, 'recall': 0.5380676328502415, 'f1-score': 0.4395942692505032, 'support': 10350}, '2': {'precision': 0.4598564795272267, 'recall': 0.45807753763350434, 'f1-score': 0.4589652847994607, 'support': 11891}, 'accuracy': 0.4256159054891226, 'macro avg': {'precision': 0.43613057194820465, 'recall': 0.432470940439383, 'f1-score': 0.4226124084298588, 'support': 34705}, 'weighted avg': {'precision': 0.4396703083164546, 'recall': 0.4256159054891226, 'f1-score': 0.4209777779174075, 'support': 34705}}
[[3755 5295 3414]
 [1797 5569 2984]
 [2321 4123 5447]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0771608
{'0': {'precision': 0.4766666666666667, 'recall': 0.2981316654638762, 'f1-score': 0.36682946080607765, 'support': 12471}, '1': {'precision': 0.35395778364116093, 'recall': 0.5185543100115965, 'f1-score': 0.42073075113689823, 'support': 10348}, '2': {'precision': 0.4507449978714346, 'recall': 0.44539794716473163, 'f1-score': 0.448055520291143, 'support': 11886}, 'accuracy': 0.4142918887768333, 'macro avg': {'precision': 0.42712314939308743, 'recall': 0.4206946408800681, 'f1-score': 0.41187191074470625, 'support': 34705}, 'weighted avg': {'precision': 0.431200697012494, 'recall': 0.4142918887768333, 'f1-score': 0.41072006721388105, 'support': 34705}}
[[3718 5438 3315]
 [1846 5366 3136]
 [2236 4356 5294]]
training model: results/CHTR/W5/deepVOL_L2/seq2seq
Epoch 1/50
331/331 - 16s - loss: 13.2277 - accuracy10: 0.3662 - accuracy20: 0.3664 - accuracy30: 0.3645 - accuracy50: 0.3588 - val_loss: 13.2866 - val_accuracy10: 0.3479 - val_accuracy20: 0.3463 - val_accuracy30: 0.3442 - val_accuracy50: 0.3425 - 16s/epoch - 49ms/step
Epoch 2/50
331/331 - 10s - loss: 13.1468 - accuracy10: 0.3755 - accuracy20: 0.3741 - accuracy30: 0.3720 - accuracy50: 0.3642 - val_loss: 13.2713 - val_accuracy10: 0.3616 - val_accuracy20: 0.3537 - val_accuracy30: 0.3492 - val_accuracy50: 0.3417 - 10s/epoch - 29ms/step
Epoch 3/50
331/331 - 10s - loss: 13.0909 - accuracy10: 0.3869 - accuracy20: 0.3829 - accuracy30: 0.3791 - accuracy50: 0.3703 - val_loss: 13.2089 - val_accuracy10: 0.3692 - val_accuracy20: 0.3674 - val_accuracy30: 0.3600 - val_accuracy50: 0.3489 - 10s/epoch - 30ms/step
Epoch 4/50
331/331 - 10s - loss: 13.0531 - accuracy10: 0.3940 - accuracy20: 0.3914 - accuracy30: 0.3881 - accuracy50: 0.3758 - val_loss: 13.2168 - val_accuracy10: 0.3691 - val_accuracy20: 0.3616 - val_accuracy30: 0.3551 - val_accuracy50: 0.3468 - 10s/epoch - 29ms/step
Epoch 5/50
331/331 - 10s - loss: 13.0297 - accuracy10: 0.3995 - accuracy20: 0.3939 - accuracy30: 0.3890 - accuracy50: 0.3781 - val_loss: 13.1701 - val_accuracy10: 0.3755 - val_accuracy20: 0.3693 - val_accuracy30: 0.3649 - val_accuracy50: 0.3565 - 10s/epoch - 30ms/step
Epoch 6/50
331/331 - 10s - loss: 12.9914 - accuracy10: 0.4044 - accuracy20: 0.4005 - accuracy30: 0.3979 - accuracy50: 0.3833 - val_loss: 13.1207 - val_accuracy10: 0.3812 - val_accuracy20: 0.3739 - val_accuracy30: 0.3674 - val_accuracy50: 0.3550 - 10s/epoch - 30ms/step
Epoch 7/50
331/331 - 10s - loss: 12.9536 - accuracy10: 0.4127 - accuracy20: 0.4075 - accuracy30: 0.4031 - accuracy50: 0.3871 - val_loss: 13.1050 - val_accuracy10: 0.3836 - val_accuracy20: 0.3771 - val_accuracy30: 0.3712 - val_accuracy50: 0.3597 - 10s/epoch - 29ms/step
Epoch 8/50
331/331 - 10s - loss: 12.9246 - accuracy10: 0.4174 - accuracy20: 0.4129 - accuracy30: 0.4099 - accuracy50: 0.3941 - val_loss: 13.1093 - val_accuracy10: 0.3831 - val_accuracy20: 0.3756 - val_accuracy30: 0.3702 - val_accuracy50: 0.3582 - 10s/epoch - 29ms/step
Epoch 9/50
331/331 - 10s - loss: 12.8998 - accuracy10: 0.4201 - accuracy20: 0.4159 - accuracy30: 0.4131 - accuracy50: 0.3989 - val_loss: 13.1176 - val_accuracy10: 0.3836 - val_accuracy20: 0.3780 - val_accuracy30: 0.3718 - val_accuracy50: 0.3612 - 10s/epoch - 29ms/step
Epoch 10/50
331/331 - 10s - loss: 12.8844 - accuracy10: 0.4226 - accuracy20: 0.4181 - accuracy30: 0.4135 - accuracy50: 0.4002 - val_loss: 13.0997 - val_accuracy10: 0.3872 - val_accuracy20: 0.3827 - val_accuracy30: 0.3749 - val_accuracy50: 0.3616 - 10s/epoch - 31ms/step
Epoch 11/50
331/331 - 10s - loss: 12.8564 - accuracy10: 0.4266 - accuracy20: 0.4211 - accuracy30: 0.4177 - accuracy50: 0.4035 - val_loss: 13.1038 - val_accuracy10: 0.3892 - val_accuracy20: 0.3821 - val_accuracy30: 0.3736 - val_accuracy50: 0.3599 - 10s/epoch - 29ms/step
Epoch 12/50
331/331 - 10s - loss: 12.8440 - accuracy10: 0.4288 - accuracy20: 0.4250 - accuracy30: 0.4218 - accuracy50: 0.4055 - val_loss: 13.0796 - val_accuracy10: 0.3905 - val_accuracy20: 0.3850 - val_accuracy30: 0.3778 - val_accuracy50: 0.3641 - 10s/epoch - 29ms/step
Epoch 13/50
331/331 - 10s - loss: 12.8230 - accuracy10: 0.4335 - accuracy20: 0.4290 - accuracy30: 0.4248 - accuracy50: 0.4084 - val_loss: 13.0894 - val_accuracy10: 0.3905 - val_accuracy20: 0.3847 - val_accuracy30: 0.3781 - val_accuracy50: 0.3633 - 10s/epoch - 30ms/step
Epoch 14/50
331/331 - 10s - loss: 12.8083 - accuracy10: 0.4322 - accuracy20: 0.4264 - accuracy30: 0.4244 - accuracy50: 0.4076 - val_loss: 13.0743 - val_accuracy10: 0.3925 - val_accuracy20: 0.3860 - val_accuracy30: 0.3777 - val_accuracy50: 0.3648 - 10s/epoch - 29ms/step
Epoch 15/50
331/331 - 10s - loss: 12.7876 - accuracy10: 0.4353 - accuracy20: 0.4309 - accuracy30: 0.4266 - accuracy50: 0.4094 - val_loss: 13.0783 - val_accuracy10: 0.3923 - val_accuracy20: 0.3850 - val_accuracy30: 0.3783 - val_accuracy50: 0.3649 - 10s/epoch - 30ms/step
Epoch 16/50
331/331 - 10s - loss: 12.7712 - accuracy10: 0.4379 - accuracy20: 0.4341 - accuracy30: 0.4313 - accuracy50: 0.4134 - val_loss: 13.0852 - val_accuracy10: 0.3913 - val_accuracy20: 0.3882 - val_accuracy30: 0.3809 - val_accuracy50: 0.3671 - 10s/epoch - 30ms/step
Epoch 17/50
331/331 - 10s - loss: 12.7680 - accuracy10: 0.4372 - accuracy20: 0.4335 - accuracy30: 0.4294 - accuracy50: 0.4124 - val_loss: 13.0934 - val_accuracy10: 0.3921 - val_accuracy20: 0.3887 - val_accuracy30: 0.3818 - val_accuracy50: 0.3690 - 10s/epoch - 29ms/step
Epoch 18/50
331/331 - 10s - loss: 12.7496 - accuracy10: 0.4405 - accuracy20: 0.4363 - accuracy30: 0.4321 - accuracy50: 0.4161 - val_loss: 13.0866 - val_accuracy10: 0.3894 - val_accuracy20: 0.3858 - val_accuracy30: 0.3792 - val_accuracy50: 0.3648 - 10s/epoch - 30ms/step
Epoch 19/50
331/331 - 10s - loss: 12.7291 - accuracy10: 0.4401 - accuracy20: 0.4383 - accuracy30: 0.4362 - accuracy50: 0.4186 - val_loss: 13.0956 - val_accuracy10: 0.3910 - val_accuracy20: 0.3873 - val_accuracy30: 0.3810 - val_accuracy50: 0.3670 - 10s/epoch - 30ms/step
Epoch 20/50
331/331 - 10s - loss: 12.7185 - accuracy10: 0.4411 - accuracy20: 0.4385 - accuracy30: 0.4350 - accuracy50: 0.4179 - val_loss: 13.0744 - val_accuracy10: 0.3915 - val_accuracy20: 0.3892 - val_accuracy30: 0.3818 - val_accuracy50: 0.3683 - 10s/epoch - 29ms/step
Epoch 21/50
331/331 - 10s - loss: 12.6928 - accuracy10: 0.4448 - accuracy20: 0.4420 - accuracy30: 0.4388 - accuracy50: 0.4217 - val_loss: 13.0925 - val_accuracy10: 0.3926 - val_accuracy20: 0.3875 - val_accuracy30: 0.3817 - val_accuracy50: 0.3679 - 10s/epoch - 29ms/step
Epoch 22/50
331/331 - 10s - loss: 12.6708 - accuracy10: 0.4434 - accuracy20: 0.4436 - accuracy30: 0.4407 - accuracy50: 0.4247 - val_loss: 13.0976 - val_accuracy10: 0.3906 - val_accuracy20: 0.3861 - val_accuracy30: 0.3831 - val_accuracy50: 0.3673 - 10s/epoch - 30ms/step
Epoch 23/50
331/331 - 10s - loss: 12.6666 - accuracy10: 0.4464 - accuracy20: 0.4456 - accuracy30: 0.4429 - accuracy50: 0.4272 - val_loss: 13.1146 - val_accuracy10: 0.3888 - val_accuracy20: 0.3870 - val_accuracy30: 0.3812 - val_accuracy50: 0.3686 - 10s/epoch - 30ms/step
Epoch 24/50
331/331 - 10s - loss: 12.6558 - accuracy10: 0.4471 - accuracy20: 0.4456 - accuracy30: 0.4432 - accuracy50: 0.4266 - val_loss: 13.1087 - val_accuracy10: 0.3919 - val_accuracy20: 0.3880 - val_accuracy30: 0.3831 - val_accuracy50: 0.3709 - 10s/epoch - 29ms/step
testing model: results/CHTR/W5/deepVOL_L2/seq2seq
Evaluating performance on  test set...
2027/2027 - 20s - 20s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0883012
{'0': {'precision': 0.445343652729873, 'recall': 0.14125086717540958, 'f1-score': 0.21447584320875113, 'support': 187390}, '1': {'precision': 0.34596353981798306, 'recall': 0.6602204144116073, 'f1-score': 0.4540167643695428, 'support': 147631}, '2': {'precision': 0.41575037983231106, 'recall': 0.40185253676790533, 'f1-score': 0.40868333858825223, 'support': 183856}, 'accuracy': 0.3812483498015907, 'macro avg': {'precision': 0.40235252412672234, 'recall': 0.40110793945164075, 'f1-score': 0.35905864872218207, 'support': 518877}, 'weighted avg': {'precision': 0.4065820845139964, 'recall': 0.3812483498015907, 'f1-score': 0.3514444870345179, 'support': 518877}}
[[26469 95094 65827]
 [12162 97469 38000]
 [20804 89169 73883]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0944875
{'0': {'precision': 0.44233678377781177, 'recall': 0.1376013874348318, 'f1-score': 0.20990566988897358, 'support': 189126}, '1': {'precision': 0.33848241895087383, 'recall': 0.6501209352324644, 'f1-score': 0.44518260197462256, 'support': 148840}, '2': {'precision': 0.4033289697303753, 'recall': 0.38829590240505, 'f1-score': 0.39566969603947294, 'support': 180911}, 'accuracy': 0.372024583860915, 'macro avg': {'precision': 0.3947160574863536, 'recall': 0.39200607502411544, 'f1-score': 0.35025265596768973, 'support': 518877}, 'weighted avg': {'precision': 0.3989457174789062, 'recall': 0.372024583860915, 'f1-score': 0.34216316888496107, 'support': 518877}}
[[26024 98500 64602]
 [12757 96764 39319]
 [20052 90612 70247]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0985055
{'0': {'precision': 0.4368499756372129, 'recall': 0.13710838417769247, 'f1-score': 0.20871128806974168, 'support': 189631}, '1': {'precision': 0.3324171343099182, 'recall': 0.6354318694440759, 'f1-score': 0.436490486161586, 'support': 150740}, '2': {'precision': 0.3927972759077874, 'recall': 0.3767492409218738, 'f1-score': 0.3846059264723965, 'support': 178506}, 'accuracy': 0.3643194822665102, 'macro avg': {'precision': 0.3873547952849728, 'recall': 0.383096498181214, 'f1-score': 0.343269233567908, 'support': 518877}, 'weighted avg': {'precision': 0.39135580703930384, 'recall': 0.3643194822665102, 'f1-score': 0.3353958099180196, 'support': 518877}}
[[ 26000 100782  62849]
 [ 13843  95785  41112]
 [ 19674  91580  67252]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.102185
{'0': {'precision': 0.42069010544184376, 'recall': 0.13754936492688655, 'f1-score': 0.20731481704913812, 'support': 187380}, '1': {'precision': 0.33382946249229106, 'recall': 0.6120227898633114, 'f1-score': 0.43201512385105323, 'support': 158316}, '2': {'precision': 0.37030066203006623, 'recall': 0.3578625830778203, 'f1-score': 0.3639753923857347, 'support': 173181}, 'accuracy': 0.3558492667819156, 'macro avg': {'precision': 0.37494007665473367, 'recall': 0.36914491262267274, 'f1-score': 0.3344351110953087, 'support': 518877}, 'weighted avg': {'precision': 0.3773697737472486, 'recall': 0.3558492667819156, 'f1-score': 0.32816096916036896, 'support': 518877}}
[[ 25774 101919  59687]
 [ 15721  96893  45702]
 [ 19771  91435  61975]]
Evaluating performance on  train set...
331/331 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0651505
{'0': {'precision': 0.4861324419550095, 'recall': 0.1918496862521392, 'f1-score': 0.275123347905003, 'support': 28048}, '1': {'precision': 0.41688480185737375, 'recall': 0.6464193696396429, 'f1-score': 0.5068773697174328, 'support': 28333}, '2': {'precision': 0.42133803294245237, 'recall': 0.4419952358943364, 'f1-score': 0.43141949924522416, 'support': 28127}, 'accuracy': 0.4275098215553557, 'macro avg': {'precision': 0.44145175891827854, 'recall': 0.42675476392870615, 'f1-score': 0.40447340562255335, 'support': 84508}, 'weighted avg': {'precision': 0.44135010502616834, 'recall': 0.4275098215553557, 'f1-score': 0.4048439488984944, 'support': 84508}}
[[ 5381 13075  9592]
 [ 2536 18315  7482]
 [ 3152 12543 12432]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.069025
{'0': {'precision': 0.4951830443159923, 'recall': 0.1901289367998309, 'f1-score': 0.2747613592974417, 'support': 28386}, '1': {'precision': 0.40364770279971285, 'recall': 0.6476961843052556, 'f1-score': 0.49734645364586216, 'support': 27780}, '2': {'precision': 0.421623669617332, 'recall': 0.4319031825559241, 'f1-score': 0.42670152505446624, 'support': 28342}, 'accuracy': 0.4216287215411559, 'macro avg': {'precision': 0.44015147224434575, 'recall': 0.4232427678870035, 'f1-score': 0.39960311266592335, 'support': 84508}, 'weighted avg': {'precision': 0.440422884508262, 'recall': 0.4216287215411559, 'f1-score': 0.39888809403125053, 'support': 84508}}
[[ 5397 13572  9417]
 [ 2412 17993  7375]
 [ 3090 13011 12241]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.072655
{'0': {'precision': 0.4833409402099498, 'recall': 0.18722155434552012, 'f1-score': 0.26989831026836913, 'support': 28282}, '1': {'precision': 0.40039262927765135, 'recall': 0.6413206603301651, 'f1-score': 0.4929956600560347, 'support': 27986}, '2': {'precision': 0.41560204685487523, 'recall': 0.42276912181303117, 'f1-score': 0.41915494935664505, 'support': 28240}, 'accuracy': 0.41631561508969567, 'macro avg': {'precision': 0.43311187211415875, 'recall': 0.4171037788295721, 'f1-score': 0.39401630656034964, 'support': 84508}, 'weighted avg': {'precision': 0.4332351777010913, 'recall': 0.41631561508969567, 'f1-score': 0.39365712504342615, 'support': 84508}}
[[ 5295 13736  9251]
 [ 2501 17948  7537]
 [ 3159 13142 11939]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0814352
{'0': {'precision': 0.4562853805373349, 'recall': 0.17944096964557052, 'f1-score': 0.2575834432383078, 'support': 28299}, '1': {'precision': 0.38481349911190055, 'recall': 0.6244190654609648, 'f1-score': 0.4761734686868965, 'support': 27757}, '2': {'precision': 0.4053424609195808, 'recall': 0.40373260227752006, 'f1-score': 0.40453592998890675, 'support': 28452}, 'accuracy': 0.401109954087187, 'macro avg': {'precision': 0.41548044685627206, 'recall': 0.40253087912801844, 'f1-score': 0.3794309473047037, 'support': 84508}, 'weighted avg': {'precision': 0.41565877759216846, 'recall': 0.401109954087187, 'f1-score': 0.3788559321080541, 'support': 84508}}
[[ 5078 14125  9096]
 [ 2669 17332  7756]
 [ 3382 13583 11487]]
Evaluating performance on  val set...
136/136 - 1s - 1s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0834402
{'0': {'precision': 0.45562007465781834, 'recall': 0.17890879478827362, 'f1-score': 0.25692901415039177, 'support': 12280}, '1': {'precision': 0.3639357292908647, 'recall': 0.6057456057456058, 'f1-score': 0.45469054796949815, 'support': 10582}, '2': {'precision': 0.40986145069274654, 'recall': 0.4246390272734949, 'f1-score': 0.4171193961763364, 'support': 11843}, 'accuracy': 0.3929116841953609, 'macro avg': {'precision': 0.40980575154714316, 'recall': 0.4030978092691247, 'f1-score': 0.3762463194320755, 'support': 34705}, 'weighted avg': {'precision': 0.4120493175250868, 'recall': 0.3929116841953609, 'f1-score': 0.3718936372654197, 'support': 34705}}
[[2197 5895 4188]
 [1119 6410 3053]
 [1506 5308 5029]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.088302
{'0': {'precision': 0.45296459249947624, 'recall': 0.17368251928020564, 'f1-score': 0.2510887869461703, 'support': 12448}, '1': {'precision': 0.35296752519596863, 'recall': 0.607907425265188, 'f1-score': 0.44661707403471484, 'support': 10370}, '2': {'precision': 0.4094599072233267, 'recall': 0.4158324219735846, 'f1-score': 0.41262156183480114, 'support': 11887}, 'accuracy': 0.38637083993660853, 'macro avg': {'precision': 0.4051306749729238, 'recall': 0.3991407888396594, 'f1-score': 0.3701091409385621, 'support': 34705}, 'weighted avg': {'precision': 0.40818401961905665, 'recall': 0.38637083993660853, 'f1-score': 0.3648409388611497, 'support': 34705}}
[[2162 6115 4171]
 [1108 6304 2958]
 [1503 5441 4943]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0916934
{'0': {'precision': 0.44869131699210635, 'recall': 0.17313241423533185, 'f1-score': 0.24985540775014461, 'support': 12476}, '1': {'precision': 0.34482182628062363, 'recall': 0.6027837259100642, 'f1-score': 0.43869094000141673, 'support': 10274}, '2': {'precision': 0.4053306512446568, 'recall': 0.4045169385194479, 'f1-score': 0.40492338608389855, 'support': 11955}, 'accuracy': 0.38003169572107764, 'macro avg': {'precision': 0.3996145981724623, 'recall': 0.3934776928882813, 'f1-score': 0.36448991127848657, 'support': 34705}, 'weighted avg': {'precision': 0.4030053378369261, 'recall': 0.38003169572107764, 'f1-score': 0.35917492768472464, 'support': 34705}}
[[2160 6210 4106]
 [1092 6193 2989]
 [1562 5557 4836]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0974525
{'0': {'precision': 0.42560130452507133, 'recall': 0.16777822418642024, 'f1-score': 0.2406777707336753, 'support': 12445}, '1': {'precision': 0.33209431345353674, 'recall': 0.5781340544717017, 'f1-score': 0.42186123542055737, 'support': 10354}, '2': {'precision': 0.3927297435026329, 'recall': 0.3883756089366706, 'f1-score': 0.39054054054054055, 'support': 11906}, 'accuracy': 0.36588387840368825, 'macro avg': {'precision': 0.383475120493747, 'recall': 0.37809596253159755, 'f1-score': 0.3510265155649244, 'support': 34705}, 'weighted avg': {'precision': 0.38642711662454343, 'recall': 0.36588387840368825, 'f1-score': 0.3461449867166321, 'support': 34705}}
[[2088 6335 4022]
 [1240 5986 3128]
 [1578 5704 4624]]
training model: results/CHTR/W5/deepVOL_L3/seq2seq
Epoch 1/50
331/331 - 20s - loss: 13.2756 - accuracy10: 0.3548 - accuracy20: 0.3543 - accuracy30: 0.3545 - accuracy50: 0.3524 - val_loss: 13.2670 - val_accuracy10: 0.3450 - val_accuracy20: 0.3478 - val_accuracy30: 0.3491 - val_accuracy50: 0.3470 - 20s/epoch - 61ms/step
Epoch 2/50
331/331 - 14s - loss: 13.1760 - accuracy10: 0.3620 - accuracy20: 0.3604 - accuracy30: 0.3602 - accuracy50: 0.3587 - val_loss: 13.2384 - val_accuracy10: 0.3464 - val_accuracy20: 0.3470 - val_accuracy30: 0.3440 - val_accuracy50: 0.3390 - 14s/epoch - 43ms/step
Epoch 3/50
331/331 - 15s - loss: 13.1537 - accuracy10: 0.3679 - accuracy20: 0.3659 - accuracy30: 0.3658 - accuracy50: 0.3597 - val_loss: 13.3747 - val_accuracy10: 0.3359 - val_accuracy20: 0.3282 - val_accuracy30: 0.3232 - val_accuracy50: 0.3180 - 15s/epoch - 44ms/step
Epoch 4/50
331/331 - 15s - loss: 13.1290 - accuracy10: 0.3715 - accuracy20: 0.3694 - accuracy30: 0.3683 - accuracy50: 0.3622 - val_loss: 13.3429 - val_accuracy10: 0.3455 - val_accuracy20: 0.3428 - val_accuracy30: 0.3348 - val_accuracy50: 0.3296 - 15s/epoch - 44ms/step
Epoch 5/50
331/331 - 14s - loss: 13.0865 - accuracy10: 0.3823 - accuracy20: 0.3788 - accuracy30: 0.3778 - accuracy50: 0.3709 - val_loss: 13.2838 - val_accuracy10: 0.3493 - val_accuracy20: 0.3493 - val_accuracy30: 0.3446 - val_accuracy50: 0.3372 - 14s/epoch - 44ms/step
Epoch 6/50
331/331 - 14s - loss: 13.0502 - accuracy10: 0.3900 - accuracy20: 0.3884 - accuracy30: 0.3871 - accuracy50: 0.3781 - val_loss: 13.2655 - val_accuracy10: 0.3542 - val_accuracy20: 0.3526 - val_accuracy30: 0.3467 - val_accuracy50: 0.3403 - 14s/epoch - 43ms/step
Epoch 7/50
331/331 - 14s - loss: 13.0216 - accuracy10: 0.3971 - accuracy20: 0.3932 - accuracy30: 0.3919 - accuracy50: 0.3813 - val_loss: 13.1939 - val_accuracy10: 0.3668 - val_accuracy20: 0.3622 - val_accuracy30: 0.3557 - val_accuracy50: 0.3453 - 14s/epoch - 43ms/step
Epoch 8/50
331/331 - 14s - loss: 12.9788 - accuracy10: 0.4036 - accuracy20: 0.4004 - accuracy30: 0.3990 - accuracy50: 0.3870 - val_loss: 13.1788 - val_accuracy10: 0.3703 - val_accuracy20: 0.3653 - val_accuracy30: 0.3567 - val_accuracy50: 0.3492 - 14s/epoch - 43ms/step
Epoch 9/50
331/331 - 15s - loss: 12.9559 - accuracy10: 0.4077 - accuracy20: 0.4037 - accuracy30: 0.4014 - accuracy50: 0.3876 - val_loss: 13.1421 - val_accuracy10: 0.3767 - val_accuracy20: 0.3728 - val_accuracy30: 0.3641 - val_accuracy50: 0.3537 - 15s/epoch - 45ms/step
Epoch 10/50
331/331 - 15s - loss: 12.9315 - accuracy10: 0.4097 - accuracy20: 0.4064 - accuracy30: 0.4051 - accuracy50: 0.3940 - val_loss: 13.1188 - val_accuracy10: 0.3746 - val_accuracy20: 0.3703 - val_accuracy30: 0.3644 - val_accuracy50: 0.3579 - 15s/epoch - 44ms/step
Epoch 11/50
331/331 - 14s - loss: 12.9099 - accuracy10: 0.4155 - accuracy20: 0.4095 - accuracy30: 0.4068 - accuracy50: 0.3944 - val_loss: 13.1679 - val_accuracy10: 0.3771 - val_accuracy20: 0.3712 - val_accuracy30: 0.3653 - val_accuracy50: 0.3565 - 14s/epoch - 43ms/step
Epoch 12/50
331/331 - 15s - loss: 12.8805 - accuracy10: 0.4215 - accuracy20: 0.4153 - accuracy30: 0.4137 - accuracy50: 0.3985 - val_loss: 13.1358 - val_accuracy10: 0.3809 - val_accuracy20: 0.3736 - val_accuracy30: 0.3673 - val_accuracy50: 0.3568 - 15s/epoch - 44ms/step
Epoch 13/50
331/331 - 14s - loss: 12.8590 - accuracy10: 0.4225 - accuracy20: 0.4181 - accuracy30: 0.4149 - accuracy50: 0.4013 - val_loss: 13.1186 - val_accuracy10: 0.3857 - val_accuracy20: 0.3816 - val_accuracy30: 0.3737 - val_accuracy50: 0.3615 - 14s/epoch - 44ms/step
Epoch 14/50
331/331 - 14s - loss: 12.8413 - accuracy10: 0.4240 - accuracy20: 0.4199 - accuracy30: 0.4157 - accuracy50: 0.4022 - val_loss: 13.1147 - val_accuracy10: 0.3835 - val_accuracy20: 0.3798 - val_accuracy30: 0.3730 - val_accuracy50: 0.3618 - 14s/epoch - 44ms/step
Epoch 15/50
331/331 - 14s - loss: 12.8250 - accuracy10: 0.4249 - accuracy20: 0.4227 - accuracy30: 0.4192 - accuracy50: 0.4048 - val_loss: 13.1150 - val_accuracy10: 0.3808 - val_accuracy20: 0.3785 - val_accuracy30: 0.3724 - val_accuracy50: 0.3611 - 14s/epoch - 44ms/step
Epoch 16/50
331/331 - 14s - loss: 12.8029 - accuracy10: 0.4295 - accuracy20: 0.4267 - accuracy30: 0.4224 - accuracy50: 0.4089 - val_loss: 13.0765 - val_accuracy10: 0.3853 - val_accuracy20: 0.3801 - val_accuracy30: 0.3758 - val_accuracy50: 0.3629 - 14s/epoch - 44ms/step
Epoch 17/50
331/331 - 14s - loss: 12.7769 - accuracy10: 0.4309 - accuracy20: 0.4298 - accuracy30: 0.4257 - accuracy50: 0.4111 - val_loss: 13.0952 - val_accuracy10: 0.3859 - val_accuracy20: 0.3801 - val_accuracy30: 0.3747 - val_accuracy50: 0.3632 - 14s/epoch - 43ms/step
Epoch 18/50
331/331 - 14s - loss: 12.7609 - accuracy10: 0.4329 - accuracy20: 0.4313 - accuracy30: 0.4276 - accuracy50: 0.4116 - val_loss: 13.0676 - val_accuracy10: 0.3861 - val_accuracy20: 0.3830 - val_accuracy30: 0.3786 - val_accuracy50: 0.3670 - 14s/epoch - 43ms/step
Epoch 19/50
331/331 - 15s - loss: 12.7497 - accuracy10: 0.4324 - accuracy20: 0.4317 - accuracy30: 0.4293 - accuracy50: 0.4136 - val_loss: 13.0759 - val_accuracy10: 0.3906 - val_accuracy20: 0.3842 - val_accuracy30: 0.3800 - val_accuracy50: 0.3676 - 15s/epoch - 44ms/step
Epoch 20/50
331/331 - 15s - loss: 12.7323 - accuracy10: 0.4349 - accuracy20: 0.4348 - accuracy30: 0.4321 - accuracy50: 0.4155 - val_loss: 13.0791 - val_accuracy10: 0.3882 - val_accuracy20: 0.3819 - val_accuracy30: 0.3771 - val_accuracy50: 0.3644 - 15s/epoch - 44ms/step
Epoch 21/50
331/331 - 15s - loss: 12.7140 - accuracy10: 0.4367 - accuracy20: 0.4366 - accuracy30: 0.4333 - accuracy50: 0.4173 - val_loss: 13.0845 - val_accuracy10: 0.3879 - val_accuracy20: 0.3835 - val_accuracy30: 0.3783 - val_accuracy50: 0.3652 - 15s/epoch - 44ms/step
Epoch 22/50
331/331 - 14s - loss: 12.6923 - accuracy10: 0.4377 - accuracy20: 0.4378 - accuracy30: 0.4342 - accuracy50: 0.4200 - val_loss: 13.0737 - val_accuracy10: 0.3907 - val_accuracy20: 0.3850 - val_accuracy30: 0.3803 - val_accuracy50: 0.3702 - 14s/epoch - 43ms/step
Epoch 23/50
331/331 - 14s - loss: 12.6782 - accuracy10: 0.4411 - accuracy20: 0.4391 - accuracy30: 0.4351 - accuracy50: 0.4212 - val_loss: 13.1070 - val_accuracy10: 0.3864 - val_accuracy20: 0.3858 - val_accuracy30: 0.3811 - val_accuracy50: 0.3685 - 14s/epoch - 44ms/step
Epoch 24/50
331/331 - 14s - loss: 12.6628 - accuracy10: 0.4416 - accuracy20: 0.4419 - accuracy30: 0.4368 - accuracy50: 0.4229 - val_loss: 13.1212 - val_accuracy10: 0.3893 - val_accuracy20: 0.3868 - val_accuracy30: 0.3821 - val_accuracy50: 0.3686 - 14s/epoch - 43ms/step
Epoch 25/50
331/331 - 15s - loss: 12.6409 - accuracy10: 0.4428 - accuracy20: 0.4434 - accuracy30: 0.4415 - accuracy50: 0.4260 - val_loss: 13.0983 - val_accuracy10: 0.3886 - val_accuracy20: 0.3863 - val_accuracy30: 0.3807 - val_accuracy50: 0.3687 - 15s/epoch - 44ms/step
Epoch 26/50
331/331 - 15s - loss: 12.6249 - accuracy10: 0.4451 - accuracy20: 0.4439 - accuracy30: 0.4416 - accuracy50: 0.4277 - val_loss: 13.1459 - val_accuracy10: 0.3855 - val_accuracy20: 0.3818 - val_accuracy30: 0.3778 - val_accuracy50: 0.3689 - 15s/epoch - 44ms/step
Epoch 27/50
331/331 - 15s - loss: 12.6178 - accuracy10: 0.4458 - accuracy20: 0.4471 - accuracy30: 0.4448 - accuracy50: 0.4291 - val_loss: 13.1192 - val_accuracy10: 0.3892 - val_accuracy20: 0.3863 - val_accuracy30: 0.3820 - val_accuracy50: 0.3714 - 15s/epoch - 44ms/step
Epoch 28/50
331/331 - 14s - loss: 12.6049 - accuracy10: 0.4458 - accuracy20: 0.4473 - accuracy30: 0.4447 - accuracy50: 0.4299 - val_loss: 13.1246 - val_accuracy10: 0.3885 - val_accuracy20: 0.3835 - val_accuracy30: 0.3809 - val_accuracy50: 0.3705 - 14s/epoch - 43ms/step
testing model: results/CHTR/W5/deepVOL_L3/seq2seq
Evaluating performance on  test set...
2027/2027 - 35s - 35s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0860752
{'0': {'precision': 0.45191829484902307, 'recall': 0.13577565505096323, 'f1-score': 0.20881447740982395, 'support': 187390}, '1': {'precision': 0.3461179926837192, 'recall': 0.6639662401528135, 'f1-score': 0.45503266911926843, 'support': 147631}, '2': {'precision': 0.41731475751646013, 'recall': 0.4071392829170655, 'f1-score': 0.412164226975269, 'support': 183856}, 'accuracy': 0.3822100420716278, 'macro avg': {'precision': 0.4051170150164008, 'recall': 0.40229372604028074, 'f1-score': 0.3586704578347872, 'support': 518877}, 'weighted avg': {'precision': 0.40955474362439437, 'recall': 0.3822100420716278, 'f1-score': 0.35092235541629074, 'support': 518877}}
[[25443 95291 66656]
 [11747 98022 37862]
 [19110 89891 74855]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0910559
{'0': {'precision': 0.45219587683879114, 'recall': 0.13441832429174203, 'f1-score': 0.20723471030589577, 'support': 189126}, '1': {'precision': 0.34171893577485246, 'recall': 0.6449543133566246, 'f1-score': 0.44673979309285694, 'support': 148840}, '2': {'precision': 0.40494112468361393, 'recall': 0.40679671219549945, 'f1-score': 0.40586679755467375, 'support': 180911}, 'accuracy': 0.3758328081607009, 'macro avg': {'precision': 0.3996186457657525, 'recall': 0.3953897832812887, 'f1-score': 0.35328043365114215, 'support': 518877}, 'weighted avg': {'precision': 0.40402975582147505, 'recall': 0.3758328081607009, 'f1-score': 0.34519161735376064, 'support': 518877}}
[[25422 96035 67669]
 [12368 95995 40477]
 [18429 88888 73594]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0956944
{'0': {'precision': 0.44736889031544785, 'recall': 0.13229904393269032, 'f1-score': 0.20420821293394653, 'support': 189631}, '1': {'precision': 0.3369027145324291, 'recall': 0.6198951837601168, 'f1-score': 0.43654855535752246, 'support': 150740}, '2': {'precision': 0.39190785109928333, 'recall': 0.40712917212866795, 'f1-score': 0.39937353171495693, 'support': 178506}, 'accuracy': 0.3684996636967913, 'macro avg': {'precision': 0.3920598186490534, 'recall': 0.38644113327382507, 'f1-score': 0.346710100002142, 'support': 518877}, 'weighted avg': {'precision': 0.39619722611785785, 'recall': 0.3684996636967913, 'f1-score': 0.33884737329613807, 'support': 518877}}
[[25088 96080 68463]
 [12996 93443 44301]
 [17995 87836 72675]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1006404
{'0': {'precision': 0.4300153193287669, 'recall': 0.1303287437293201, 'f1-score': 0.2000319448255526, 'support': 187380}, '1': {'precision': 0.33741238926405154, 'recall': 0.5829227620707951, 'f1-score': 0.4274211663467083, 'support': 158316}, '2': {'precision': 0.3684316584913164, 'recall': 0.40118142290436015, 'f1-score': 0.38410973142117893, 'support': 173181}, 'accuracy': 0.3588210693478416, 'macro avg': {'precision': 0.378619789028045, 'recall': 0.3714776429014918, 'f1-score': 0.33718761419781323, 'support': 518877}, 'weighted avg': {'precision': 0.38120674727100373, 'recall': 0.3588210693478416, 'f1-score': 0.3308493199544568, 'support': 518877}}
[[24421 95157 67802]
 [14734 92286 51296]
 [17636 86068 69477]]
Evaluating performance on  train set...
331/331 - 6s - 6s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0629066
{'0': {'precision': 0.4866906474820144, 'recall': 0.19295493439817457, 'f1-score': 0.2763480392156863, 'support': 28048}, '1': {'precision': 0.4190826531785263, 'recall': 0.6433487452793563, 'f1-score': 0.5075458038647881, 'support': 28333}, '2': {'precision': 0.4221055096510889, 'recall': 0.4486080989796281, 'f1-score': 0.43495346432264737, 'support': 28127}, 'accuracy': 0.4290481374544422, 'macro avg': {'precision': 0.4426262701038765, 'recall': 0.42830392621905294, 'f1-score': 0.4062824358010406, 'support': 84508}, 'weighted avg': {'precision': 0.4425276868821757, 'recall': 0.4290481374544422, 'f1-score': 0.40665074496882797, 'support': 84508}}
[[ 5412 12951  9685]
 [ 2515 18228  7590]
 [ 3193 12316 12618]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0661156
{'0': {'precision': 0.48604444444444445, 'recall': 0.19263016980201508, 'f1-score': 0.2759107881723686, 'support': 28386}, '1': {'precision': 0.4101153587261797, 'recall': 0.636033117350612, 'f1-score': 0.4986805526156104, 'support': 27780}, '2': {'precision': 0.4204473902236951, 'recall': 0.4476395455507727, 'f1-score': 0.43361758121571503, 'support': 28342}, 'accuracy': 0.4239125289913381, 'macro avg': {'precision': 0.4388690644647731, 'recall': 0.42543427756779995, 'f1-score': 0.40273630733456467, 'support': 84508}, 'weighted avg': {'precision': 0.43908484639481754, 'recall': 0.4239125289913381, 'f1-score': 0.4020322202813735, 'support': 84508}}
[[ 5468 13027  9891]
 [ 2514 17669  7597]
 [ 3268 12387 12687]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0698273
{'0': {'precision': 0.4784029679356947, 'recall': 0.19149989392546496, 'f1-score': 0.27351463272984367, 'support': 28282}, '1': {'precision': 0.4087760899678351, 'recall': 0.622132494818838, 'f1-score': 0.49337621672168785, 'support': 27986}, '2': {'precision': 0.41312021965091195, 'recall': 0.44755665722379606, 'f1-score': 0.42964952238501547, 'support': 28240}, 'accuracy': 0.4196762436692384, 'macro avg': {'precision': 0.43343309251814727, 'recall': 0.420396348656033, 'f1-score': 0.39884679061218237, 'support': 84508}, 'weighted avg': {'precision': 0.4335295521836856, 'recall': 0.4196762436692384, 'f1-score': 0.3985003805106194, 'support': 84508}}
[[ 5416 12868  9998]
 [ 2618 17411  7957]
 [ 3287 12314 12639]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0792972
{'0': {'precision': 0.4509564154074592, 'recall': 0.18244460935015372, 'f1-score': 0.25978665593237393, 'support': 28299}, '1': {'precision': 0.39232287678074534, 'recall': 0.5943005368015275, 'f1-score': 0.4726376711936278, 'support': 27757}, '2': {'precision': 0.39984522120469496, 'recall': 0.43582173485168, 'f1-score': 0.41705906094443695, 'support': 28452}, 'accuracy': 0.4030269323614332, 'macro avg': {'precision': 0.4143748377976331, 'recall': 0.40418896033445373, 'f1-score': 0.3831611293568129, 'support': 84508}, 'weighted avg': {'precision': 0.41448996454933046, 'recall': 0.4030269323614332, 'f1-score': 0.3826486346563982, 'support': 84508}}
[[ 5163 12998 10138]
 [ 2787 16496  8474]
 [ 3499 12553 12400]]
Evaluating performance on  val set...
136/136 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0851701
{'0': {'precision': 0.4510915197313182, 'recall': 0.175, 'f1-score': 0.25217085191269656, 'support': 12280}, '1': {'precision': 0.3604444699009107, 'recall': 0.5946890946890947, 'f1-score': 0.44884276594985917, 'support': 10582}, '2': {'precision': 0.40217913795866045, 'recall': 0.42387908469137886, 'f1-score': 0.4127440904419322, 'support': 11843}, 'accuracy': 0.3878979974067137, 'macro avg': {'precision': 0.40457170919696317, 'recall': 0.3978560597934912, 'f1-score': 0.37125256943482926, 'support': 34705}, 'weighted avg': {'precision': 0.40676083485481745, 'recall': 0.3878979974067137, 'f1-score': 0.36693388485443384, 'support': 34705}}
[[2149 5851 4280]
 [1107 6293 3182]
 [1508 5315 5020]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0871587
{'0': {'precision': 0.45418657801786827, 'recall': 0.17561053984575836, 'f1-score': 0.253287758530792, 'support': 12448}, '1': {'precision': 0.3500840433547789, 'recall': 0.5824493731918997, 'f1-score': 0.43731672881294575, 'support': 10370}, '2': {'precision': 0.4032755755993354, 'recall': 0.4287877513249769, 'f1-score': 0.4156405447280437, 'support': 11887}, 'accuracy': 0.38389281083417376, 'macro avg': {'precision': 0.40251539899066086, 'recall': 0.3956158881208783, 'f1-score': 0.3687483440239272, 'support': 34705}, 'weighted avg': {'precision': 0.40564249589121976, 'recall': 0.38389281083417376, 'f1-score': 0.3638847327809768, 'support': 34705}}
[[2186 5911 4351]
 [1139 6040 3191]
 [1488 5302 5097]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0905521
{'0': {'precision': 0.43711467324291, 'recall': 0.17048733568451427, 'f1-score': 0.24530042670972207, 'support': 12476}, '1': {'precision': 0.3443165042810747, 'recall': 0.5675491532022581, 'f1-score': 0.42860818111654225, 'support': 10274}, '2': {'precision': 0.39894606323620585, 'recall': 0.43061480552070264, 'f1-score': 0.41417595237137456, 'support': 11955}, 'accuracy': 0.37764010949430915, 'macro avg': {'precision': 0.3934590802533968, 'recall': 0.3895504314691583, 'f1-score': 0.362694853399213, 'support': 34705}, 'weighted avg': {'precision': 0.3964947590938236, 'recall': 0.37764010949430915, 'f1-score': 0.35773986708029476, 'support': 34705}}
[[2127 5852 4497]
 [1184 5831 3259]
 [1555 5252 5148]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0960861
{'0': {'precision': 0.4152594099694812, 'recall': 0.1640016070711129, 'f1-score': 0.23513824884792625, 'support': 12445}, '1': {'precision': 0.3357895998082914, 'recall': 0.5413366814757582, 'f1-score': 0.41447903571692674, 'support': 10354}, '2': {'precision': 0.38647121697969156, 'recall': 0.4251637829665715, 'f1-score': 0.4048952167653175, 'support': 11906}, 'accuracy': 0.366172021322576, 'macro avg': {'precision': 0.37917340891915474, 'recall': 0.3768340238378142, 'f1-score': 0.3515041671100569, 'support': 34705}, 'weighted avg': {'precision': 0.3816739715558406, 'recall': 0.366172021322576, 'f1-score': 0.34688067694952807, 'support': 34705}}
[[2041 5830 4574]
 [1287 5605 3462]
 [1587 5257 5062]]
training model: results/CHTR/W6/deepLOB_L1/seq2seq
Epoch 1/50
448/448 - 17s - loss: 13.1988 - accuracy10: 0.3699 - accuracy20: 0.3702 - accuracy30: 0.3694 - accuracy50: 0.3651 - val_loss: 13.3271 - val_accuracy10: 0.3421 - val_accuracy20: 0.3379 - val_accuracy30: 0.3333 - val_accuracy50: 0.3378 - 17s/epoch - 38ms/step
Epoch 2/50
448/448 - 10s - loss: 13.0901 - accuracy10: 0.3841 - accuracy20: 0.3830 - accuracy30: 0.3801 - accuracy50: 0.3745 - val_loss: 13.2986 - val_accuracy10: 0.3319 - val_accuracy20: 0.3313 - val_accuracy30: 0.3280 - val_accuracy50: 0.3309 - 10s/epoch - 23ms/step
Epoch 3/50
448/448 - 10s - loss: 13.0568 - accuracy10: 0.3889 - accuracy20: 0.3883 - accuracy30: 0.3841 - accuracy50: 0.3756 - val_loss: 13.1816 - val_accuracy10: 0.3606 - val_accuracy20: 0.3552 - val_accuracy30: 0.3507 - val_accuracy50: 0.3484 - 10s/epoch - 23ms/step
Epoch 4/50
448/448 - 10s - loss: 13.0314 - accuracy10: 0.3965 - accuracy20: 0.3940 - accuracy30: 0.3873 - accuracy50: 0.3796 - val_loss: 13.2216 - val_accuracy10: 0.3601 - val_accuracy20: 0.3471 - val_accuracy30: 0.3354 - val_accuracy50: 0.3305 - 10s/epoch - 22ms/step
Epoch 5/50
448/448 - 10s - loss: 13.0127 - accuracy10: 0.4010 - accuracy20: 0.3996 - accuracy30: 0.3907 - accuracy50: 0.3822 - val_loss: 13.1952 - val_accuracy10: 0.3646 - val_accuracy20: 0.3560 - val_accuracy30: 0.3452 - val_accuracy50: 0.3423 - 10s/epoch - 21ms/step
Epoch 6/50
448/448 - 10s - loss: 12.9988 - accuracy10: 0.4052 - accuracy20: 0.4019 - accuracy30: 0.3918 - accuracy50: 0.3814 - val_loss: 13.1635 - val_accuracy10: 0.3781 - val_accuracy20: 0.3659 - val_accuracy30: 0.3579 - val_accuracy50: 0.3504 - 10s/epoch - 23ms/step
Epoch 7/50
448/448 - 10s - loss: 12.9786 - accuracy10: 0.4085 - accuracy20: 0.4046 - accuracy30: 0.3959 - accuracy50: 0.3845 - val_loss: 13.1945 - val_accuracy10: 0.3755 - val_accuracy20: 0.3668 - val_accuracy30: 0.3550 - val_accuracy50: 0.3481 - 10s/epoch - 23ms/step
Epoch 8/50
448/448 - 11s - loss: 12.9652 - accuracy10: 0.4135 - accuracy20: 0.4084 - accuracy30: 0.3978 - accuracy50: 0.3854 - val_loss: 13.2164 - val_accuracy10: 0.3682 - val_accuracy20: 0.3566 - val_accuracy30: 0.3454 - val_accuracy50: 0.3404 - 11s/epoch - 24ms/step
Epoch 9/50
448/448 - 11s - loss: 12.9477 - accuracy10: 0.4163 - accuracy20: 0.4111 - accuracy30: 0.4002 - accuracy50: 0.3877 - val_loss: 13.1831 - val_accuracy10: 0.3728 - val_accuracy20: 0.3649 - val_accuracy30: 0.3521 - val_accuracy50: 0.3470 - 11s/epoch - 24ms/step
Epoch 10/50
448/448 - 11s - loss: 12.9331 - accuracy10: 0.4192 - accuracy20: 0.4140 - accuracy30: 0.4029 - accuracy50: 0.3906 - val_loss: 13.1762 - val_accuracy10: 0.3756 - val_accuracy20: 0.3605 - val_accuracy30: 0.3496 - val_accuracy50: 0.3410 - 11s/epoch - 25ms/step
Epoch 11/50
448/448 - 10s - loss: 12.9221 - accuracy10: 0.4212 - accuracy20: 0.4152 - accuracy30: 0.4028 - accuracy50: 0.3910 - val_loss: 13.1373 - val_accuracy10: 0.3850 - val_accuracy20: 0.3701 - val_accuracy30: 0.3624 - val_accuracy50: 0.3538 - 10s/epoch - 22ms/step
Epoch 12/50
448/448 - 11s - loss: 12.9079 - accuracy10: 0.4234 - accuracy20: 0.4172 - accuracy30: 0.4056 - accuracy50: 0.3917 - val_loss: 13.1132 - val_accuracy10: 0.3889 - val_accuracy20: 0.3792 - val_accuracy30: 0.3704 - val_accuracy50: 0.3656 - 11s/epoch - 24ms/step
Epoch 13/50
448/448 - 11s - loss: 12.8945 - accuracy10: 0.4253 - accuracy20: 0.4188 - accuracy30: 0.4084 - accuracy50: 0.3934 - val_loss: 13.1044 - val_accuracy10: 0.3913 - val_accuracy20: 0.3802 - val_accuracy30: 0.3699 - val_accuracy50: 0.3652 - 11s/epoch - 24ms/step
Epoch 14/50
448/448 - 11s - loss: 12.8891 - accuracy10: 0.4260 - accuracy20: 0.4179 - accuracy30: 0.4074 - accuracy50: 0.3941 - val_loss: 13.1244 - val_accuracy10: 0.3924 - val_accuracy20: 0.3830 - val_accuracy30: 0.3718 - val_accuracy50: 0.3631 - 11s/epoch - 25ms/step
Epoch 15/50
448/448 - 11s - loss: 12.8733 - accuracy10: 0.4292 - accuracy20: 0.4226 - accuracy30: 0.4088 - accuracy50: 0.3951 - val_loss: 13.1168 - val_accuracy10: 0.3961 - val_accuracy20: 0.3821 - val_accuracy30: 0.3700 - val_accuracy50: 0.3589 - 11s/epoch - 24ms/step
Epoch 16/50
448/448 - 10s - loss: 12.8678 - accuracy10: 0.4304 - accuracy20: 0.4217 - accuracy30: 0.4102 - accuracy50: 0.3962 - val_loss: 13.1037 - val_accuracy10: 0.3957 - val_accuracy20: 0.3831 - val_accuracy30: 0.3744 - val_accuracy50: 0.3643 - 10s/epoch - 23ms/step
Epoch 17/50
448/448 - 10s - loss: 12.8515 - accuracy10: 0.4344 - accuracy20: 0.4253 - accuracy30: 0.4126 - accuracy50: 0.3978 - val_loss: 13.1113 - val_accuracy10: 0.3977 - val_accuracy20: 0.3840 - val_accuracy30: 0.3730 - val_accuracy50: 0.3616 - 10s/epoch - 22ms/step
Epoch 18/50
448/448 - 10s - loss: 12.8463 - accuracy10: 0.4341 - accuracy20: 0.4263 - accuracy30: 0.4145 - accuracy50: 0.3985 - val_loss: 13.1338 - val_accuracy10: 0.3964 - val_accuracy20: 0.3802 - val_accuracy30: 0.3706 - val_accuracy50: 0.3593 - 10s/epoch - 23ms/step
Epoch 19/50
448/448 - 10s - loss: 12.8422 - accuracy10: 0.4343 - accuracy20: 0.4261 - accuracy30: 0.4144 - accuracy50: 0.3995 - val_loss: 13.0997 - val_accuracy10: 0.4043 - val_accuracy20: 0.3868 - val_accuracy30: 0.3735 - val_accuracy50: 0.3592 - 10s/epoch - 23ms/step
Epoch 20/50
448/448 - 10s - loss: 12.8302 - accuracy10: 0.4357 - accuracy20: 0.4269 - accuracy30: 0.4149 - accuracy50: 0.4003 - val_loss: 13.0899 - val_accuracy10: 0.4057 - val_accuracy20: 0.3895 - val_accuracy30: 0.3784 - val_accuracy50: 0.3627 - 10s/epoch - 22ms/step
Epoch 21/50
448/448 - 10s - loss: 12.8244 - accuracy10: 0.4373 - accuracy20: 0.4285 - accuracy30: 0.4157 - accuracy50: 0.4004 - val_loss: 13.1167 - val_accuracy10: 0.3992 - val_accuracy20: 0.3856 - val_accuracy30: 0.3735 - val_accuracy50: 0.3587 - 10s/epoch - 22ms/step
Epoch 22/50
448/448 - 10s - loss: 12.8139 - accuracy10: 0.4387 - accuracy20: 0.4299 - accuracy30: 0.4168 - accuracy50: 0.4010 - val_loss: 13.1194 - val_accuracy10: 0.4006 - val_accuracy20: 0.3857 - val_accuracy30: 0.3718 - val_accuracy50: 0.3596 - 10s/epoch - 23ms/step
Epoch 23/50
448/448 - 10s - loss: 12.8031 - accuracy10: 0.4398 - accuracy20: 0.4302 - accuracy30: 0.4185 - accuracy50: 0.4021 - val_loss: 13.1518 - val_accuracy10: 0.4002 - val_accuracy20: 0.3863 - val_accuracy30: 0.3764 - val_accuracy50: 0.3641 - 10s/epoch - 22ms/step
Epoch 24/50
448/448 - 10s - loss: 12.7951 - accuracy10: 0.4399 - accuracy20: 0.4316 - accuracy30: 0.4200 - accuracy50: 0.4046 - val_loss: 13.1765 - val_accuracy10: 0.3958 - val_accuracy20: 0.3815 - val_accuracy30: 0.3715 - val_accuracy50: 0.3599 - 10s/epoch - 22ms/step
Epoch 25/50
448/448 - 11s - loss: 12.7881 - accuracy10: 0.4421 - accuracy20: 0.4344 - accuracy30: 0.4213 - accuracy50: 0.4047 - val_loss: 13.1662 - val_accuracy10: 0.4034 - val_accuracy20: 0.3866 - val_accuracy30: 0.3746 - val_accuracy50: 0.3660 - 11s/epoch - 24ms/step
Epoch 26/50
448/448 - 10s - loss: 12.7830 - accuracy10: 0.4423 - accuracy20: 0.4333 - accuracy30: 0.4227 - accuracy50: 0.4068 - val_loss: 13.1783 - val_accuracy10: 0.3972 - val_accuracy20: 0.3828 - val_accuracy30: 0.3693 - val_accuracy50: 0.3634 - 10s/epoch - 23ms/step
Epoch 27/50
448/448 - 10s - loss: 12.7730 - accuracy10: 0.4440 - accuracy20: 0.4353 - accuracy30: 0.4235 - accuracy50: 0.4077 - val_loss: 13.2300 - val_accuracy10: 0.3980 - val_accuracy20: 0.3852 - val_accuracy30: 0.3741 - val_accuracy50: 0.3652 - 10s/epoch - 22ms/step
Epoch 28/50
448/448 - 10s - loss: 12.7654 - accuracy10: 0.4441 - accuracy20: 0.4364 - accuracy30: 0.4247 - accuracy50: 0.4084 - val_loss: 13.1619 - val_accuracy10: 0.4003 - val_accuracy20: 0.3861 - val_accuracy30: 0.3747 - val_accuracy50: 0.3649 - 10s/epoch - 22ms/step
Epoch 29/50
448/448 - 10s - loss: 12.7599 - accuracy10: 0.4445 - accuracy20: 0.4375 - accuracy30: 0.4255 - accuracy50: 0.4095 - val_loss: 13.2555 - val_accuracy10: 0.3950 - val_accuracy20: 0.3840 - val_accuracy30: 0.3758 - val_accuracy50: 0.3624 - 10s/epoch - 23ms/step
Epoch 30/50
448/448 - 10s - loss: 12.7609 - accuracy10: 0.4436 - accuracy20: 0.4366 - accuracy30: 0.4254 - accuracy50: 0.4106 - val_loss: 13.2303 - val_accuracy10: 0.3976 - val_accuracy20: 0.3832 - val_accuracy30: 0.3757 - val_accuracy50: 0.3633 - 10s/epoch - 23ms/step
testing model: results/CHTR/W6/deepLOB_L1/seq2seq
Evaluating performance on  test set...
1095/1095 - 10s - 10s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1008807
{'0': {'precision': 0.468032603006057, 'recall': 0.18702191235059762, 'f1-score': 0.2672521153722984, 'support': 100400}, '1': {'precision': 0.29004107187177247, 'recall': 0.49817791773814274, 'f1-score': 0.36662922144295673, 'support': 72719}, '2': {'precision': 0.450372391736988, 'recall': 0.4844629335327662, 'f1-score': 0.46679607452811916, 'support': 106970}, 'accuracy': 0.3814037680880006, 'macro avg': {'precision': 0.40281535553827247, 'recall': 0.3898875878738355, 'f1-score': 0.36689247044779144, 'support': 280089}, 'weighted avg': {'precision': 0.4150762964320525, 'recall': 0.3814037680880006, 'f1-score': 0.3692619089995039, 'support': 280089}}
[[18777 45910 35713]
 [ 8961 36227 27531]
 [12381 42766 51823]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1079617
{'0': {'precision': 0.4712027023191121, 'recall': 0.16364030677628597, 'f1-score': 0.2429191269545112, 'support': 101442}, '1': {'precision': 0.27913820433172454, 'recall': 0.5325612303018796, 'f1-score': 0.3662887497026877, 'support': 73738}, '2': {'precision': 0.43837891281184904, 'recall': 0.4353201345928376, 'f1-score': 0.43684416938484644, 'support': 104909}, 'accuracy': 0.36252405485399286, 'macro avg': {'precision': 0.39623993982089517, 'recall': 0.377173890557001, 'f1-score': 0.34868401534734844, 'support': 280089}, 'weighted avg': {'precision': 0.4083442434506402, 'recall': 0.36252405485399286, 'f1-score': 0.3480339708738692, 'support': 280089}}
[[16600 52903 31939]
 [ 7899 39270 26569]
 [10730 48510 45669]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1120774
{'0': {'precision': 0.4648567020124093, 'recall': 0.14028274502422255, 'f1-score': 0.21552511415525116, 'support': 100939}, '1': {'precision': 0.276910329112613, 'recall': 0.5708718687859498, 'f1-score': 0.37292671976007713, 'support': 74931}, '2': {'precision': 0.43321212375987894, 'recall': 0.39552288930041546, 'f1-score': 0.41351049049259925, 'support': 104219}, 'accuracy': 0.350449321465677, 'macro avg': {'precision': 0.3916597182949671, 'recall': 0.3688925010368626, 'f1-score': 0.33398744146930914, 'support': 280089}, 'weighted avg': {'precision': 0.4028015125238714, 'recall': 0.350449321465677, 'f1-score': 0.3313029477941206, 'support': 280089}}
[[14160 58018 28761]
 [ 6985 42776 25170]
 [ 9316 53682 41221]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1162992
{'0': {'precision': 0.4525916561314791, 'recall': 0.12151949283681925, 'f1-score': 0.1915960301906988, 'support': 100165}, '1': {'precision': 0.2759437230741421, 'recall': 0.6007345707352266, 'f1-score': 0.37817506193228734, 'support': 76235}, '2': {'precision': 0.4224234781611831, 'recall': 0.355370386444078, 'f1-score': 0.38600663108438654, 'support': 103689}, 'accuracy': 0.33852454041393987, 'macro avg': {'precision': 0.38365295245560144, 'recall': 0.3592081500053746, 'f1-score': 0.3185925744024576, 'support': 280089}, 'weighted avg': {'precision': 0.39334311947995726, 'recall': 0.33852454041393987, 'f1-score': 0.3143502021891907, 'support': 280089}}
[[12172 61488 26505]
 [ 6561 45797 23877]
 [ 8161 58680 36848]]
Evaluating performance on  train set...
448/448 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0775931
{'0': {'precision': 0.4491746641074856, 'recall': 0.2935745289409639, 'f1-score': 0.35507609206912766, 'support': 39857}, '1': {'precision': 0.393563418699803, 'recall': 0.560873555771515, 'f1-score': 0.46255398726568414, 'support': 37044}, '2': {'precision': 0.40725603269693744, 'recall': 0.38626768977511083, 'f1-score': 0.3964842951556858, 'support': 37663}, 'accuracy': 0.4104779861038372, 'macro avg': {'precision': 0.41666470516807536, 'recall': 0.41357192482919664, 'f1-score': 0.4047047914968325, 'support': 114564}, 'weighted avg': {'precision': 0.41741211749862356, 'recall': 0.4104779861038372, 'f1-score': 0.4034417942313276, 'support': 114564}}
[[11701 16382 11774]
 [ 6867 20777  9400]
 [ 7482 15633 14548]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0845928
{'0': {'precision': 0.43615546135256134, 'recall': 0.2793099073956615, 'f1-score': 0.3405407077456075, 'support': 39415}, '1': {'precision': 0.3744795281054823, 'recall': 0.5802419354838709, 'f1-score': 0.455187684521299, 'support': 37200}, '2': {'precision': 0.40750560237351263, 'recall': 0.3402197686368547, 'f1-score': 0.3708352481617648, 'support': 37949}, 'accuracy': 0.39720156419119446, 'macro avg': {'precision': 0.4060468639438521, 'recall': 0.3999238705054624, 'f1-score': 0.38885454680955706, 'support': 114564}, 'weighted avg': {'precision': 0.40663852570796744, 'recall': 0.39720156419119446, 'f1-score': 0.38780263165109685, 'support': 114564}}
[[11009 18285 10121]
 [ 6964 21585  8651]
 [ 7268 17770 12911]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.089665
{'0': {'precision': 0.4161765337225776, 'recall': 0.25088641010378115, 'f1-score': 0.3130530258993735, 'support': 38639}, '1': {'precision': 0.3634603789152994, 'recall': 0.6055302950195622, 'f1-score': 0.4542588001983143, 'support': 37828}, '2': {'precision': 0.4051116853693936, 'recall': 0.30039110691130533, 'f1-score': 0.3449793506767552, 'support': 38097}, 'accuracy': 0.3844488670088335, 'macro avg': {'precision': 0.3949161993357569, 'recall': 0.3856026040115495, 'f1-score': 0.370763725591481, 'support': 114564}, 'weighted avg': {'precision': 0.3950906408438289, 'recall': 0.3844488670088335, 'f1-score': 0.3702946482696141, 'support': 114564}}
[[ 9694 20181  8764]
 [ 6881 22906  8041]
 [ 6718 19935 11444]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0953944
{'0': {'precision': 0.3966304136725578, 'recall': 0.21387616180128288, 'f1-score': 0.2778996785222228, 'support': 38195}, '1': {'precision': 0.3536184688744803, 'recall': 0.6402737562516452, 'f1-score': 0.4556080017981569, 'support': 37990}, '2': {'precision': 0.401675800174728, 'recall': 0.2635555902967769, 'f1-score': 0.3182769308223597, 'support': 38379}, 'accuracy': 0.3719143884640899, 'macro avg': {'precision': 0.3839748942405887, 'recall': 0.372568502783235, 'f1-score': 0.35059487038091314, 'support': 114564}, 'weighted avg': {'precision': 0.3840576430438073, 'recall': 0.3719143884640899, 'f1-score': 0.3503550551438464, 'support': 114564}}
[[ 8169 22243  7783]
 [ 6382 24324  7284]
 [ 6045 22219 10115]]
Evaluating performance on  val set...
136/136 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0841675
{'0': {'precision': 0.4480465502909393, 'recall': 0.30592718722127626, 'f1-score': 0.36359256047027083, 'support': 12333}, '1': {'precision': 0.3659317426759287, 'recall': 0.5850878887386517, 'f1-score': 0.4502582778995875, 'support': 10354}, '2': {'precision': 0.425028069817291, 'recall': 0.34453086215455897, 'f1-score': 0.38056939176529725, 'support': 12086}, 'accuracy': 0.4024674316279872, 'macro avg': {'precision': 0.413002120928053, 'recall': 0.41184864603816235, 'f1-score': 0.3981400767117185, 'support': 34773}, 'weighted avg': {'precision': 0.4155955661063612, 'recall': 0.4024674316279872, 'f1-score': 0.3952987354133254, 'support': 34773}}
[[3773 5282 3278]
 [1941 6058 2355]
 [2707 5215 4164]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0916791
{'0': {'precision': 0.4352870090634441, 'recall': 0.2955608435217855, 'f1-score': 0.3520672466034601, 'support': 12187}, '1': {'precision': 0.34781639928698754, 'recall': 0.5922412975433937, 'f1-score': 0.43825232496929284, 'support': 10543}, '2': {'precision': 0.4191434589281535, 'recall': 0.29743419413767336, 'f1-score': 0.3479527903249308, 'support': 12043}, 'accuracy': 0.38616167716331634, 'macro avg': {'precision': 0.40074895575952835, 'recall': 0.3950787784009509, 'f1-score': 0.37942412063256126, 'support': 34773}, 'weighted avg': {'precision': 0.4031753300839921, 'recall': 0.38616167716331634, 'f1-score': 0.3767731645354374, 'support': 34773}}
[[3602 5885 2700]
 [2035 6244 2264]
 [2638 5823 3582]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0953964
{'0': {'precision': 0.42991508817766166, 'recall': 0.2738164572759797, 'f1-score': 0.3345532174443428, 'support': 12019}, '1': {'precision': 0.33844424000817747, 'recall': 0.6229539040451553, 'f1-score': 0.4386011392237382, 'support': 10630}, '2': {'precision': 0.4196239406779661, 'recall': 0.261382382052128, 'f1-score': 0.3221183167310429, 'support': 12124}, 'accuracy': 0.3762114284070975, 'macro avg': {'precision': 0.39599442295460174, 'recall': 0.38605091445775436, 'f1-score': 0.3650908911330413, 'support': 34773}, 'weighted avg': {'precision': 0.3983646039419637, 'recall': 0.3762114284070975, 'f1-score': 0.36202478079139155, 'support': 34773}}
[[3291 6412 2316]
 [1941 6622 2067]
 [2423 6532 3169]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1000478
{'0': {'precision': 0.4101992268807612, 'recall': 0.23472860302875617, 'f1-score': 0.29859307359307363, 'support': 11754}, '1': {'precision': 0.33289835484923336, 'recall': 0.6532235939643347, 'f1-score': 0.44103482341318845, 'support': 10935}, '2': {'precision': 0.4078907435508346, 'recall': 0.2224428997020854, 'f1-score': 0.28788690157438146, 'support': 12084}, 'accuracy': 0.3620625197710868, 'macro avg': {'precision': 0.3836627750936097, 'recall': 0.3701316988983921, 'f1-score': 0.3425049328602145, 'support': 34773}, 'weighted avg': {'precision': 0.3850883434877957, 'recall': 0.3620625197710868, 'f1-score': 0.3396659505841034, 'support': 34773}}
[[2759 7027 1968]
 [1858 7143 1934]
 [2109 7287 2688]]
training model: results/CHTR/W6/deepOF_L1/seq2seq
Epoch 1/50
448/448 - 15s - loss: 13.1470 - accuracy10: 0.3862 - accuracy20: 0.3799 - accuracy30: 0.3732 - accuracy50: 0.3675 - val_loss: 13.1062 - val_accuracy10: 0.3947 - val_accuracy20: 0.3745 - val_accuracy30: 0.3596 - val_accuracy50: 0.3434 - 15s/epoch - 33ms/step
Epoch 2/50
448/448 - 10s - loss: 13.0467 - accuracy10: 0.4061 - accuracy20: 0.3942 - accuracy30: 0.3859 - accuracy50: 0.3778 - val_loss: 13.1174 - val_accuracy10: 0.3968 - val_accuracy20: 0.3730 - val_accuracy30: 0.3536 - val_accuracy50: 0.3380 - 10s/epoch - 22ms/step
Epoch 3/50
448/448 - 10s - loss: 13.0077 - accuracy10: 0.4115 - accuracy20: 0.3992 - accuracy30: 0.3894 - accuracy50: 0.3806 - val_loss: 13.0646 - val_accuracy10: 0.4106 - val_accuracy20: 0.3870 - val_accuracy30: 0.3665 - val_accuracy50: 0.3492 - 10s/epoch - 21ms/step
Epoch 4/50
448/448 - 9s - loss: 12.9853 - accuracy10: 0.4160 - accuracy20: 0.4044 - accuracy30: 0.3939 - accuracy50: 0.3830 - val_loss: 13.0765 - val_accuracy10: 0.4074 - val_accuracy20: 0.3835 - val_accuracy30: 0.3647 - val_accuracy50: 0.3520 - 9s/epoch - 21ms/step
Epoch 5/50
448/448 - 10s - loss: 12.9623 - accuracy10: 0.4202 - accuracy20: 0.4071 - accuracy30: 0.3964 - accuracy50: 0.3845 - val_loss: 13.0612 - val_accuracy10: 0.4058 - val_accuracy20: 0.3892 - val_accuracy30: 0.3745 - val_accuracy50: 0.3590 - 10s/epoch - 22ms/step
Epoch 6/50
448/448 - 10s - loss: 12.9447 - accuracy10: 0.4236 - accuracy20: 0.4089 - accuracy30: 0.3988 - accuracy50: 0.3861 - val_loss: 13.0578 - val_accuracy10: 0.4096 - val_accuracy20: 0.3900 - val_accuracy30: 0.3727 - val_accuracy50: 0.3617 - 10s/epoch - 21ms/step
Epoch 7/50
448/448 - 10s - loss: 12.9295 - accuracy10: 0.4252 - accuracy20: 0.4120 - accuracy30: 0.4006 - accuracy50: 0.3881 - val_loss: 13.0269 - val_accuracy10: 0.4122 - val_accuracy20: 0.3932 - val_accuracy30: 0.3779 - val_accuracy50: 0.3633 - 10s/epoch - 22ms/step
Epoch 8/50
448/448 - 10s - loss: 12.9214 - accuracy10: 0.4255 - accuracy20: 0.4134 - accuracy30: 0.4016 - accuracy50: 0.3894 - val_loss: 13.0171 - val_accuracy10: 0.4136 - val_accuracy20: 0.3938 - val_accuracy30: 0.3804 - val_accuracy50: 0.3637 - 10s/epoch - 22ms/step
Epoch 9/50
448/448 - 9s - loss: 12.9063 - accuracy10: 0.4273 - accuracy20: 0.4152 - accuracy30: 0.4038 - accuracy50: 0.3910 - val_loss: 13.0233 - val_accuracy10: 0.4121 - val_accuracy20: 0.3937 - val_accuracy30: 0.3809 - val_accuracy50: 0.3689 - 9s/epoch - 21ms/step
Epoch 10/50
448/448 - 9s - loss: 12.8929 - accuracy10: 0.4315 - accuracy20: 0.4176 - accuracy30: 0.4072 - accuracy50: 0.3932 - val_loss: 13.0142 - val_accuracy10: 0.4126 - val_accuracy20: 0.3973 - val_accuracy30: 0.3826 - val_accuracy50: 0.3715 - 9s/epoch - 21ms/step
Epoch 11/50
448/448 - 10s - loss: 12.8844 - accuracy10: 0.4310 - accuracy20: 0.4185 - accuracy30: 0.4053 - accuracy50: 0.3917 - val_loss: 13.0053 - val_accuracy10: 0.4150 - val_accuracy20: 0.3990 - val_accuracy30: 0.3858 - val_accuracy50: 0.3735 - 10s/epoch - 23ms/step
Epoch 12/50
448/448 - 9s - loss: 12.8761 - accuracy10: 0.4344 - accuracy20: 0.4213 - accuracy30: 0.4082 - accuracy50: 0.3949 - val_loss: 13.0017 - val_accuracy10: 0.4168 - val_accuracy20: 0.3985 - val_accuracy30: 0.3897 - val_accuracy50: 0.3766 - 9s/epoch - 21ms/step
Epoch 13/50
448/448 - 10s - loss: 12.8657 - accuracy10: 0.4344 - accuracy20: 0.4220 - accuracy30: 0.4113 - accuracy50: 0.3958 - val_loss: 13.0028 - val_accuracy10: 0.4161 - val_accuracy20: 0.3975 - val_accuracy30: 0.3898 - val_accuracy50: 0.3807 - 10s/epoch - 21ms/step
Epoch 14/50
448/448 - 10s - loss: 12.8589 - accuracy10: 0.4345 - accuracy20: 0.4230 - accuracy30: 0.4115 - accuracy50: 0.3966 - val_loss: 12.9936 - val_accuracy10: 0.4164 - val_accuracy20: 0.3992 - val_accuracy30: 0.3897 - val_accuracy50: 0.3796 - 10s/epoch - 21ms/step
Epoch 15/50
448/448 - 10s - loss: 12.8444 - accuracy10: 0.4363 - accuracy20: 0.4230 - accuracy30: 0.4123 - accuracy50: 0.3988 - val_loss: 12.9984 - val_accuracy10: 0.4173 - val_accuracy20: 0.4005 - val_accuracy30: 0.3925 - val_accuracy50: 0.3818 - 10s/epoch - 23ms/step
Epoch 16/50
448/448 - 10s - loss: 12.8326 - accuracy10: 0.4392 - accuracy20: 0.4267 - accuracy30: 0.4152 - accuracy50: 0.4005 - val_loss: 13.0233 - val_accuracy10: 0.4170 - val_accuracy20: 0.4012 - val_accuracy30: 0.3924 - val_accuracy50: 0.3804 - 10s/epoch - 22ms/step
Epoch 17/50
448/448 - 10s - loss: 12.8249 - accuracy10: 0.4384 - accuracy20: 0.4278 - accuracy30: 0.4164 - accuracy50: 0.4023 - val_loss: 13.0245 - val_accuracy10: 0.4162 - val_accuracy20: 0.3982 - val_accuracy30: 0.3881 - val_accuracy50: 0.3755 - 10s/epoch - 22ms/step
Epoch 18/50
448/448 - 9s - loss: 12.8066 - accuracy10: 0.4413 - accuracy20: 0.4320 - accuracy30: 0.4192 - accuracy50: 0.4037 - val_loss: 13.0276 - val_accuracy10: 0.4160 - val_accuracy20: 0.3996 - val_accuracy30: 0.3918 - val_accuracy50: 0.3808 - 9s/epoch - 21ms/step
Epoch 19/50
448/448 - 10s - loss: 12.8022 - accuracy10: 0.4411 - accuracy20: 0.4308 - accuracy30: 0.4196 - accuracy50: 0.4034 - val_loss: 13.0265 - val_accuracy10: 0.4193 - val_accuracy20: 0.4018 - val_accuracy30: 0.3931 - val_accuracy50: 0.3819 - 10s/epoch - 22ms/step
Epoch 20/50
448/448 - 10s - loss: 12.7892 - accuracy10: 0.4432 - accuracy20: 0.4324 - accuracy30: 0.4207 - accuracy50: 0.4059 - val_loss: 13.0166 - val_accuracy10: 0.4191 - val_accuracy20: 0.4045 - val_accuracy30: 0.3958 - val_accuracy50: 0.3825 - 10s/epoch - 21ms/step
Epoch 21/50
448/448 - 9s - loss: 12.7755 - accuracy10: 0.4438 - accuracy20: 0.4341 - accuracy30: 0.4239 - accuracy50: 0.4080 - val_loss: 13.0543 - val_accuracy10: 0.4138 - val_accuracy20: 0.3987 - val_accuracy30: 0.3904 - val_accuracy50: 0.3772 - 9s/epoch - 21ms/step
Epoch 22/50
448/448 - 10s - loss: 12.7652 - accuracy10: 0.4471 - accuracy20: 0.4363 - accuracy30: 0.4249 - accuracy50: 0.4082 - val_loss: 13.0549 - val_accuracy10: 0.4156 - val_accuracy20: 0.4039 - val_accuracy30: 0.3936 - val_accuracy50: 0.3808 - 10s/epoch - 21ms/step
Epoch 23/50
448/448 - 9s - loss: 12.7576 - accuracy10: 0.4463 - accuracy20: 0.4373 - accuracy30: 0.4271 - accuracy50: 0.4115 - val_loss: 13.0585 - val_accuracy10: 0.4120 - val_accuracy20: 0.3980 - val_accuracy30: 0.3898 - val_accuracy50: 0.3753 - 9s/epoch - 21ms/step
Epoch 24/50
448/448 - 9s - loss: 12.7397 - accuracy10: 0.4491 - accuracy20: 0.4392 - accuracy30: 0.4269 - accuracy50: 0.4118 - val_loss: 13.0516 - val_accuracy10: 0.4154 - val_accuracy20: 0.4015 - val_accuracy30: 0.3930 - val_accuracy50: 0.3805 - 9s/epoch - 21ms/step
testing model: results/CHTR/W6/deepOF_L1/seq2seq
Evaluating performance on  test set...
1095/1095 - 9s - 9s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0857433
{'0': {'precision': 0.43878442043700755, 'recall': 0.4304368612920576, 'f1-score': 0.4345705580081051, 'support': 100398}, '1': {'precision': 0.3090357907103596, 'recall': 0.4051404054016887, 'f1-score': 0.35062183873847075, 'support': 72718}, '2': {'precision': 0.46358851896503755, 'recall': 0.37385947199162367, 'f1-score': 0.41391694957356956, 'support': 106968}, 'accuracy': 0.4022614644178175, 'macro avg': {'precision': 0.4038029100374682, 'recall': 0.40314557956179, 'f1-score': 0.3997031154400485, 'support': 280084}, 'weighted avg': {'precision': 0.4145709128995685, 'recall': 0.4022614644178175, 'f1-score': 0.4048871124886372, 'support': 280084}}
[[43215 30409 26774]
 [23758 29461 19499]
 [31515 35462 39991]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0887816
{'0': {'precision': 0.45100362782091663, 'recall': 0.4277109621451104, 'f1-score': 0.43904857797724156, 'support': 101440}, '1': {'precision': 0.3003353310502283, 'recall': 0.45670423261049403, 'f1-score': 0.3623705377558981, 'support': 73737}, '2': {'precision': 0.4521914849139433, 'recall': 0.3092929928412785, 'f1-score': 0.3673342314702653, 'support': 104907}, 'accuracy': 0.3909898459033718, 'macro avg': {'precision': 0.4011768145950294, 'recall': 0.39790272919896097, 'f1-score': 0.3895844490678016, 'support': 280084}, 'weighted avg': {'precision': 0.411782488180944, 'recall': 0.3909898459033718, 'f1-score': 0.39200074375319255, 'support': 280084}}
[[43387 35930 22123]
 [22876 33676 17185]
 [29938 42522 32447]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.092812
{'0': {'precision': 0.45469089625191705, 'recall': 0.40827446823265995, 'f1-score': 0.43023437907814377, 'support': 100937}, '1': {'precision': 0.297559541311379, 'recall': 0.5267245866196901, 'f1-score': 0.3802861685214627, 'support': 74931}, '2': {'precision': 0.45782581144828555, 'recall': 0.2495777999539418, 'f1-score': 0.3230494075564498, 'support': 104216}, 'accuracy': 0.3809142971394296, 'macro avg': {'precision': 0.40335874967052726, 'recall': 0.3948589516020973, 'f1-score': 0.37785665171868543, 'support': 280084}, 'weighted avg': {'precision': 0.41381993884290863, 'recall': 0.3809142971394296, 'f1-score': 0.37698942985816863, 'support': 280084}}
[[41210 42629 17098]
 [21759 39468 13704]
 [27664 50542 26010]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0975847
{'0': {'precision': 0.45749473225314247, 'recall': 0.37717520441680064, 'f1-score': 0.41347043082833085, 'support': 100163}, '1': {'precision': 0.29557199639483084, 'recall': 0.5979484219639531, 'f1-score': 0.39559657549998484, 'support': 76234}, '2': {'precision': 0.46055033153894137, 'recall': 0.19225168053854388, 'f1-score': 0.27126624481186634, 'support': 103687}, 'accuracy': 0.3688072149783636, 'macro avg': {'precision': 0.4045390200623049, 'recall': 0.38912510230643255, 'f1-score': 0.360111083713394, 'support': 280084}, 'weighted avg': {'precision': 0.41455335780020725, 'recall': 0.3688072149783636, 'f1-score': 0.35596153734426794, 'support': 280084}}
[[37779 49971 12413]
 [19714 45584 10936]
 [25085 58668 19934]]
Evaluating performance on  train set...
448/448 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.067832
{'0': {'precision': 0.42530535546507986, 'recall': 0.5108720186592431, 'f1-score': 0.4641782882143834, 'support': 39873}, '1': {'precision': 0.4308253674581149, 'recall': 0.4532086284262313, 'f1-score': 0.44173363193255166, 'support': 36994}, '2': {'precision': 0.436256846353416, 'recall': 0.3211746604414261, 'f1-score': 0.3699731084219533, 'support': 37696}, 'accuracy': 0.4298333667938165, 'macro avg': {'precision': 0.4307958564255369, 'recall': 0.42841843584230016, 'f1-score': 0.4252950095229628, 'support': 114563}, 'weighted avg': {'precision': 0.4306913415530582, 'recall': 0.4298333667938165, 'f1-score': 0.4259331648155065, 'support': 114563}}
[[20370 10995  8508]
 [13091 16766  7137]
 [14434 11155 12107]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0769401
{'0': {'precision': 0.414411739757401, 'recall': 0.4970369051555307, 'f1-score': 0.4519792305112579, 'support': 39317}, '1': {'precision': 0.4000830526461496, 'recall': 0.4646962673169163, 'f1-score': 0.42997582594681705, 'support': 37319}, '2': {'precision': 0.43597522962470386, 'recall': 0.276583963930709, 'f1-score': 0.33845260372975416, 'support': 37927}, 'accuracy': 0.41351919904332113, 'macro avg': {'precision': 0.41682334067608484, 'recall': 0.412772378801052, 'f1-score': 0.406802553395943, 'support': 114563}, 'weighted avg': {'precision': 0.41688292334976856, 'recall': 0.41351919904332113, 'f1-score': 0.40722770140602793, 'support': 114563}}
[[19542 12783  6992]
 [13398 17342  6579]
 [14216 13221 10490]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0824958
{'0': {'precision': 0.40714605734767023, 'recall': 0.4699904321067467, 'f1-score': 0.43631693293802737, 'support': 38671}, '1': {'precision': 0.38002076179829114, 'recall': 0.5037311458057687, 'f1-score': 0.43321726861018184, 'support': 37790}, '2': {'precision': 0.4369925873632192, 'recall': 0.22744212902209857, 'f1-score': 0.2991731828146307, 'support': 38102}, 'accuracy': 0.40045215296387143, 'macro avg': {'precision': 0.40805313550306016, 'recall': 0.400387902311538, 'f1-score': 0.38956912812094663, 'support': 114563}, 'weighted avg': {'precision': 0.40812497347103827, 'recall': 0.40045215296387143, 'f1-score': 0.3896824394091311, 'support': 114563}}
[[18175 14963  5533]
 [13122 19036  5632]
 [13343 16093  8666]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0888001
{'0': {'precision': 0.39393117728258725, 'recall': 0.4190858311698529, 'f1-score': 0.4061193631592991, 'support': 38133}, '1': {'precision': 0.36138773981580785, 'recall': 0.5568700487907245, 'f1-score': 0.43832137510968877, 'support': 38122}, '2': {'precision': 0.4394177812745869, 'recall': 0.17495040200480316, 'f1-score': 0.25026138909634055, 'support': 38308}, 'accuracy': 0.38330001833052557, 'macro avg': {'precision': 0.3982455661243274, 'recall': 0.3836354273217935, 'f1-score': 0.36490070912177613, 'support': 114563}, 'weighted avg': {'precision': 0.3983119974655168, 'recall': 0.38330001833052557, 'f1-score': 0.36471854290467015, 'support': 114563}}
[[15981 18094  4058]
 [12401 21229  4492]
 [12186 19420  6702]]
Evaluating performance on  val set...
136/136 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0728762
{'0': {'precision': 0.41664443851693783, 'recall': 0.5044404973357016, 'f1-score': 0.4563581915126726, 'support': 12386}, '1': {'precision': 0.39497341710971484, 'recall': 0.39689169499757165, 'f1-score': 0.3959302325581396, 'support': 10295}, '2': {'precision': 0.4439143341815098, 'recall': 0.3462619913992723, 'f1-score': 0.389054079167441, 'support': 12092}, 'accuracy': 0.41759411037299055, 'macro avg': {'precision': 0.41851072993605415, 'recall': 0.4158647279108485, 'f1-score': 0.4137808344127511, 'support': 34773}, 'weighted avg': {'precision': 0.41971131261433076, 'recall': 0.41759411037299055, 'f1-score': 0.4150633028371066, 'support': 34773}}
[[6248 3182 2956]
 [3920 4086 2289]
 [4828 3077 4187]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0829195
{'0': {'precision': 0.4038735983690112, 'recall': 0.4870113906416455, 'f1-score': 0.44156326621591496, 'support': 12203}, '1': {'precision': 0.3638523546881629, 'recall': 0.4077983832620067, 'f1-score': 0.38457399103139017, 'support': 10515}, '2': {'precision': 0.4385349933518675, 'recall': 0.3009539610120282, 'f1-score': 0.35694608421881147, 'support': 12055}, 'accuracy': 0.3985563511920168, 'macro avg': {'precision': 0.40208698213634725, 'recall': 0.39858791163856017, 'f1-score': 0.39436111382203887, 'support': 34773}, 'weighted avg': {'precision': 0.40378789219508926, 'recall': 0.3985563511920168, 'f1-score': 0.3949954590799083, 'support': 34773}}
[[5943 3775 2485]
 [4067 4288 2160]
 [4705 3722 3628]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0869
{'0': {'precision': 0.4017442276074058, 'recall': 0.4670489487243414, 'f1-score': 0.43194220275151796, 'support': 12033}, '1': {'precision': 0.3515282272563826, 'recall': 0.45952806242361566, 'f1-score': 0.39833754380246106, 'support': 10637}, '2': {'precision': 0.44832097688617534, 'recall': 0.2548128563166157, 'f1-score': 0.32493941628911605, 'support': 12103}, 'accuracy': 0.3908779800419866, 'macro avg': {'precision': 0.40053114391665456, 'recall': 0.39379662248819086, 'f1-score': 0.3850730542810317, 'support': 34773}, 'weighted avg': {'precision': 0.40259462305177685, 'recall': 0.3908779800419866, 'f1-score': 0.3844194844989781, 'support': 34773}}
[[5620 4433 1980]
 [3934 4888 1815]
 [4435 4584 3084]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0910245
{'0': {'precision': 0.4033560234288428, 'recall': 0.43223070398642915, 'f1-score': 0.4172944644611857, 'support': 11790}, '1': {'precision': 0.3466413931998578, 'recall': 0.5369299935773925, 'f1-score': 0.4212951297649472, 'support': 10899}, '2': {'precision': 0.439604337074377, 'recall': 0.19124462098642833, 'f1-score': 0.2665359552505623, 'support': 12084}, 'accuracy': 0.38130158456273544, 'macro avg': {'precision': 0.3965339179010259, 'recall': 0.38680177285008327, 'f1-score': 0.3683751831588984, 'support': 34773}, 'weighted avg': {'precision': 0.39817648376378456, 'recall': 0.38130158456273544, 'f1-score': 0.36615816405122753, 'support': 34773}}
[[5096 5214 1480]
 [3581 5852 1466]
 [3957 5816 2311]]
training model: results/CHTR/W6/deepLOB_L2/seq2seq
Epoch 1/50
448/448 - 27s - loss: 13.2337 - accuracy10: 0.3564 - accuracy20: 0.3582 - accuracy30: 0.3593 - accuracy50: 0.3572 - val_loss: 13.2893 - val_accuracy10: 0.3305 - val_accuracy20: 0.3308 - val_accuracy30: 0.3355 - val_accuracy50: 0.3354 - 27s/epoch - 60ms/step
Epoch 2/50
448/448 - 21s - loss: 13.1046 - accuracy10: 0.3751 - accuracy20: 0.3776 - accuracy30: 0.3759 - accuracy50: 0.3736 - val_loss: 13.3356 - val_accuracy10: 0.3239 - val_accuracy20: 0.3297 - val_accuracy30: 0.3297 - val_accuracy50: 0.3338 - 21s/epoch - 47ms/step
Epoch 3/50
448/448 - 21s - loss: 13.0490 - accuracy10: 0.3842 - accuracy20: 0.3881 - accuracy30: 0.3865 - accuracy50: 0.3815 - val_loss: 13.2868 - val_accuracy10: 0.3305 - val_accuracy20: 0.3287 - val_accuracy30: 0.3257 - val_accuracy50: 0.3300 - 21s/epoch - 48ms/step
Epoch 4/50
448/448 - 21s - loss: 13.0098 - accuracy10: 0.3917 - accuracy20: 0.3942 - accuracy30: 0.3904 - accuracy50: 0.3855 - val_loss: 13.1474 - val_accuracy10: 0.3699 - val_accuracy20: 0.3670 - val_accuracy30: 0.3607 - val_accuracy50: 0.3555 - 21s/epoch - 48ms/step
Epoch 5/50
448/448 - 22s - loss: 12.9639 - accuracy10: 0.4037 - accuracy20: 0.4043 - accuracy30: 0.3982 - accuracy50: 0.3889 - val_loss: 13.0799 - val_accuracy10: 0.3855 - val_accuracy20: 0.3825 - val_accuracy30: 0.3748 - val_accuracy50: 0.3637 - 22s/epoch - 48ms/step
Epoch 6/50
448/448 - 21s - loss: 12.9191 - accuracy10: 0.4125 - accuracy20: 0.4112 - accuracy30: 0.4051 - accuracy50: 0.3946 - val_loss: 13.1058 - val_accuracy10: 0.3841 - val_accuracy20: 0.3801 - val_accuracy30: 0.3726 - val_accuracy50: 0.3612 - 21s/epoch - 47ms/step
Epoch 7/50
448/448 - 21s - loss: 12.9014 - accuracy10: 0.4164 - accuracy20: 0.4149 - accuracy30: 0.4084 - accuracy50: 0.3977 - val_loss: 13.1200 - val_accuracy10: 0.3852 - val_accuracy20: 0.3820 - val_accuracy30: 0.3730 - val_accuracy50: 0.3622 - 21s/epoch - 47ms/step
Epoch 8/50
448/448 - 21s - loss: 12.8695 - accuracy10: 0.4222 - accuracy20: 0.4201 - accuracy30: 0.4134 - accuracy50: 0.4009 - val_loss: 13.0896 - val_accuracy10: 0.3953 - val_accuracy20: 0.3884 - val_accuracy30: 0.3793 - val_accuracy50: 0.3717 - 21s/epoch - 48ms/step
Epoch 9/50
448/448 - 21s - loss: 12.8338 - accuracy10: 0.4286 - accuracy20: 0.4256 - accuracy30: 0.4169 - accuracy50: 0.4048 - val_loss: 13.1130 - val_accuracy10: 0.3916 - val_accuracy20: 0.3891 - val_accuracy30: 0.3818 - val_accuracy50: 0.3732 - 21s/epoch - 47ms/step
Epoch 10/50
448/448 - 21s - loss: 12.8146 - accuracy10: 0.4285 - accuracy20: 0.4266 - accuracy30: 0.4202 - accuracy50: 0.4086 - val_loss: 13.1316 - val_accuracy10: 0.3880 - val_accuracy20: 0.3837 - val_accuracy30: 0.3797 - val_accuracy50: 0.3693 - 21s/epoch - 48ms/step
Epoch 11/50
448/448 - 21s - loss: 12.7828 - accuracy10: 0.4351 - accuracy20: 0.4322 - accuracy30: 0.4240 - accuracy50: 0.4091 - val_loss: 13.1310 - val_accuracy10: 0.3921 - val_accuracy20: 0.3884 - val_accuracy30: 0.3834 - val_accuracy50: 0.3783 - 21s/epoch - 47ms/step
Epoch 12/50
448/448 - 21s - loss: 12.7611 - accuracy10: 0.4372 - accuracy20: 0.4342 - accuracy30: 0.4272 - accuracy50: 0.4135 - val_loss: 13.1250 - val_accuracy10: 0.3971 - val_accuracy20: 0.3925 - val_accuracy30: 0.3847 - val_accuracy50: 0.3744 - 21s/epoch - 47ms/step
Epoch 13/50
448/448 - 21s - loss: 12.7353 - accuracy10: 0.4386 - accuracy20: 0.4372 - accuracy30: 0.4304 - accuracy50: 0.4161 - val_loss: 13.1186 - val_accuracy10: 0.4010 - val_accuracy20: 0.3953 - val_accuracy30: 0.3855 - val_accuracy50: 0.3749 - 21s/epoch - 48ms/step
Epoch 14/50
448/448 - 21s - loss: 12.7160 - accuracy10: 0.4415 - accuracy20: 0.4398 - accuracy30: 0.4327 - accuracy50: 0.4183 - val_loss: 13.1449 - val_accuracy10: 0.3963 - val_accuracy20: 0.3886 - val_accuracy30: 0.3824 - val_accuracy50: 0.3756 - 21s/epoch - 47ms/step
Epoch 15/50
448/448 - 21s - loss: 12.6885 - accuracy10: 0.4446 - accuracy20: 0.4433 - accuracy30: 0.4375 - accuracy50: 0.4221 - val_loss: 13.1660 - val_accuracy10: 0.3908 - val_accuracy20: 0.3862 - val_accuracy30: 0.3827 - val_accuracy50: 0.3771 - 21s/epoch - 47ms/step
testing model: results/CHTR/W6/deepLOB_L2/seq2seq
Evaluating performance on  test set...
1095/1095 - 19s - 19s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1012611
{'0': {'precision': 0.4298080764734607, 'recall': 0.2893027888446215, 'f1-score': 0.34582894290357724, 'support': 100400}, '1': {'precision': 0.28455161821749947, 'recall': 0.596185316079704, 'f1-score': 0.38523534063746784, 'support': 72719}, '2': {'precision': 0.45625176638792375, 'recall': 0.256557913433673, 'f1-score': 0.3284326924802987, 'support': 106970}, 'accuracy': 0.35647240698492266, 'macro avg': {'precision': 0.39020382035962803, 'recall': 0.38068200611933284, 'f1-score': 0.35316565867378125, 'support': 280089}, 'weighted avg': {'precision': 0.4021946290415189, 'recall': 0.35647240698492266, 'f1-score': 0.3494160774537834, 'support': 280089}}
[[29046 51808 19546]
 [16204 43354 13161]
 [22329 57197 27444]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.102856
{'0': {'precision': 0.4364776800260671, 'recall': 0.26410165414719744, 'f1-score': 0.32908329341243814, 'support': 101442}, '1': {'precision': 0.2831940350898428, 'recall': 0.6345846103772818, 'f1-score': 0.3916207405919546, 'support': 73738}, '2': {'precision': 0.44414316702819956, 'recall': 0.22639621004870888, 'f1-score': 0.2999147646557439, 'support': 104909}, 'accuracy': 0.3475145400212075, 'macro avg': {'precision': 0.38793829404803654, 'recall': 0.375027491524396, 'f1-score': 0.3402062662200456, 'support': 280089}, 'weighted avg': {'precision': 0.3989944127988622, 'recall': 0.3475145400212075, 'f1-score': 0.33462205108156173, 'support': 280089}}
[[26791 57447 17204]
 [14424 46793 12521]
 [20165 60993 23751]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1051002
{'0': {'precision': 0.43113097697479624, 'recall': 0.227424484094354, 'f1-score': 0.29777215682459385, 'support': 100939}, '1': {'precision': 0.28129622988299635, 'recall': 0.6699363414341194, 'f1-score': 0.39622395781946196, 'support': 74931}, '2': {'precision': 0.4419368838737677, 'recall': 0.2051833159020908, 'f1-score': 0.2802511041505576, 'support': 104219}, 'accuracy': 0.3375319987575378, 'macro avg': {'precision': 0.3847880302438534, 'recall': 0.367514713810188, 'f1-score': 0.3247490729315378, 'support': 280089}, 'weighted avg': {'precision': 0.3950671307572306, 'recall': 0.3375319987575378, 'f1-score': 0.31759109049107515, 'support': 280089}}
[[22956 62731 15252]
 [12981 50199 11751]
 [17309 65526 21384]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1089844
{'0': {'precision': 0.41664434922335297, 'recall': 0.18638246892627164, 'f1-score': 0.25755140612389893, 'support': 100165}, '1': {'precision': 0.2783778372568442, 'recall': 0.6930543713517413, 'f1-score': 0.39720934778277717, 'support': 76235}, '2': {'precision': 0.43176871496097613, 'recall': 0.18940292605773032, 'f1-score': 0.2633032565996755, 'support': 103689}, 'accuracy': 0.325407281257029, 'macro avg': {'precision': 0.37559696714705776, 'recall': 0.3562799221119144, 'f1-score': 0.3060213368354505, 'support': 280089}, 'weighted avg': {'precision': 0.3846098274077929, 'recall': 0.325407281257029, 'f1-score': 0.2976930282738134, 'support': 280089}}
[[18669 67557 13939]
 [11493 52835 11907]
 [14646 69404 19639]]
Evaluating performance on  train set...
448/448 - 8s - 8s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0831106
{'0': {'precision': 0.41343548809974656, 'recall': 0.3560729608349851, 'f1-score': 0.3826161975628168, 'support': 39857}, '1': {'precision': 0.3707384599002609, 'recall': 0.5639239822913292, 'f1-score': 0.44736644858712293, 'support': 37044}, '2': {'precision': 0.40975303474257013, 'recall': 0.25991025675065715, 'f1-score': 0.31806735658700636, 'support': 37663}, 'accuracy': 0.39166753954121714, 'macro avg': {'precision': 0.3979756609141925, 'recall': 0.39330239995899047, 'f1-score': 0.38268333424564877, 'support': 114564}, 'weighted avg': {'precision': 0.3984188951611875, 'recall': 0.39166753954121714, 'f1-score': 0.3823325596073723, 'support': 114564}}
[[14192 17863  7802]
 [ 9855 20890  6299]
 [10280 17594  9789]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.08546
{'0': {'precision': 0.40866910866910866, 'recall': 0.33966763922364585, 'f1-score': 0.37098718392795293, 'support': 39415}, '1': {'precision': 0.36259685180654105, 'recall': 0.5975537634408602, 'f1-score': 0.45132734378965533, 'support': 37200}, '2': {'precision': 0.41865456851553734, 'recall': 0.2261456164852829, 'f1-score': 0.2936627429509992, 'support': 37949}, 'accuracy': 0.38580182256206136, 'macro avg': {'precision': 0.3966401763303957, 'recall': 0.38778900638326297, 'f1-score': 0.3719924235562025, 'support': 114564}, 'weighted avg': {'precision': 0.3970166721307947, 'recall': 0.38580182256206136, 'f1-score': 0.3714608819152867, 'support': 114564}}
[[13388 19563  6464]
 [ 9518 22229  5453]
 [ 9854 19513  8582]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0882381
{'0': {'precision': 0.39688572005111994, 'recall': 0.30541680685317946, 'f1-score': 0.3451947406139851, 'support': 38639}, '1': {'precision': 0.3578961540187587, 'recall': 0.6324680131119805, 'f1-score': 0.45712047536708156, 'support': 37828}, '2': {'precision': 0.4163839608475613, 'recall': 0.19652466073444103, 'f1-score': 0.2670209351260744, 'support': 38097}, 'accuracy': 0.37719527949443105, 'macro avg': {'precision': 0.3903886116391466, 'recall': 0.37813649356653367, 'f1-score': 0.3564453837023804, 'support': 114564}, 'weighted avg': {'precision': 0.39049564267733644, 'recall': 0.37719527949443105, 'f1-score': 0.35615576874295407, 'support': 114564}}
[[11801 21306  5532]
 [ 8941 23925  4962]
 [ 8992 21618  7487]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0923494
{'0': {'precision': 0.3865584813227189, 'recall': 0.26443251734520223, 'f1-score': 0.3140400789764159, 'support': 38195}, '1': {'precision': 0.35028765509114856, 'recall': 0.6651224006317452, 'f1-score': 0.4588967082860386, 'support': 37990}, '2': {'precision': 0.4131034905833998, 'recall': 0.17546053831522448, 'f1-score': 0.24630577907827358, 'support': 38379}, 'accuracy': 0.36749764323871376, 'macro avg': {'precision': 0.38331654233242246, 'recall': 0.36833848543072395, 'f1-score': 0.339747522113576, 'support': 114564}, 'weighted avg': {'precision': 0.38342348448146263, 'recall': 0.36749764323871376, 'f1-score': 0.3393842416425394, 'support': 114564}}
[[10100 23256  4839]
 [ 7994 25268  4728]
 [ 8034 23611  6734]]
Evaluating performance on  val set...
136/136 - 3s - 3s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0885093
{'0': {'precision': 0.4180824639841033, 'recall': 0.3411984107678586, 'f1-score': 0.3757478346280918, 'support': 12333}, '1': {'precision': 0.3511157175954152, 'recall': 0.5562101603245123, 'f1-score': 0.4304828823441471, 'support': 10354}, '2': {'precision': 0.41090777751023355, 'recall': 0.28239285123283137, 'f1-score': 0.33473911337779516, 'support': 12086}, 'accuracy': 0.3847812958329739, 'macro avg': {'precision': 0.3933686530299174, 'recall': 0.3932671407750674, 'f1-score': 0.3803232767833447, 'support': 34773}, 'weighted avg': {'precision': 0.39564876678134064, 'recall': 0.3847812958329739, 'f1-score': 0.37779238870800874, 'support': 34773}}
[[4208 5252 2873]
 [2575 5759 2020]
 [3282 5391 3413]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0906397
{'0': {'precision': 0.41526037892121337, 'recall': 0.32912119471568063, 'f1-score': 0.36720681131557265, 'support': 12187}, '1': {'precision': 0.34877291960507756, 'recall': 0.5863606184198046, 'f1-score': 0.43738502900806564, 'support': 10543}, '2': {'precision': 0.4190012180267966, 'recall': 0.25707880096321517, 'f1-score': 0.31864965006175383, 'support': 12043}, 'accuracy': 0.38216432289419955, 'macro avg': {'precision': 0.39434483885102917, 'recall': 0.3908535380329001, 'f1-score': 0.374413830128464, 'support': 34773}, 'weighted avg': {'precision': 0.3963972851927033, 'recall': 0.38216432289419955, 'f1-score': 0.37166760147322986, 'support': 34773}}
[[4011 5749 2427]
 [2495 6182 1866]
 [3153 5794 3096]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0924269
{'0': {'precision': 0.40595063676321425, 'recall': 0.2996921540893585, 'f1-score': 0.34482098410874973, 'support': 12019}, '1': {'precision': 0.34309950041631976, 'recall': 0.6202257761053622, 'f1-score': 0.4418012463981773, 'support': 10630}, '2': {'precision': 0.4153201675643327, 'recall': 0.22896733751237217, 'f1-score': 0.29519353466609954, 'support': 12124}, 'accuracy': 0.3730192965806804, 'macro avg': {'precision': 0.38812343491462226, 'recall': 0.3829617559023643, 'f1-score': 0.3606052550576755, 'support': 34773}, 'weighted avg': {'precision': 0.39000402910972654, 'recall': 0.3730192965806804, 'f1-score': 0.3571643824664964, 'support': 34773}}
[[3602 6232 2185]
 [2314 6593 1723]
 [2957 6391 2776]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0942931
{'0': {'precision': 0.3978616352201258, 'recall': 0.26909988089161135, 'f1-score': 0.321051563134389, 'support': 11754}, '1': {'precision': 0.34318778566566177, 'recall': 0.6454503886602652, 'f1-score': 0.44811275832513253, 'support': 10935}, '2': {'precision': 0.40115071120345214, 'recall': 0.20771267792121814, 'f1-score': 0.2737037238972793, 'support': 12084}, 'accuracy': 0.36611738992896786, 'macro avg': {'precision': 0.38073337736307994, 'recall': 0.37408764915769827, 'f1-score': 0.3476226817856003, 'support': 34773}, 'weighted avg': {'precision': 0.38181144252189586, 'recall': 0.36611738992896786, 'f1-score': 0.34455436358501296, 'support': 34773}}
[[3163 6591 2000]
 [2130 7058 1747]
 [2657 6917 2510]]
training model: results/CHTR/W6/deepOF_L2/seq2seq
Epoch 1/50
448/448 - 19s - loss: 13.2012 - accuracy10: 0.3735 - accuracy20: 0.3691 - accuracy30: 0.3637 - accuracy50: 0.3587 - val_loss: 13.1900 - val_accuracy10: 0.3687 - val_accuracy20: 0.3569 - val_accuracy30: 0.3433 - val_accuracy50: 0.3371 - 19s/epoch - 42ms/step
Epoch 2/50
448/448 - 14s - loss: 13.0374 - accuracy10: 0.4057 - accuracy20: 0.3949 - accuracy30: 0.3870 - accuracy50: 0.3754 - val_loss: 13.1112 - val_accuracy10: 0.3938 - val_accuracy20: 0.3716 - val_accuracy30: 0.3548 - val_accuracy50: 0.3392 - 14s/epoch - 31ms/step
Epoch 3/50
448/448 - 13s - loss: 12.9606 - accuracy10: 0.4220 - accuracy20: 0.4084 - accuracy30: 0.3984 - accuracy50: 0.3838 - val_loss: 13.0600 - val_accuracy10: 0.4013 - val_accuracy20: 0.3815 - val_accuracy30: 0.3629 - val_accuracy50: 0.3463 - 13s/epoch - 30ms/step
Epoch 4/50
448/448 - 14s - loss: 12.9100 - accuracy10: 0.4302 - accuracy20: 0.4163 - accuracy30: 0.4026 - accuracy50: 0.3872 - val_loss: 13.0463 - val_accuracy10: 0.4052 - val_accuracy20: 0.3809 - val_accuracy30: 0.3636 - val_accuracy50: 0.3448 - 14s/epoch - 30ms/step
Epoch 5/50
448/448 - 13s - loss: 12.8732 - accuracy10: 0.4345 - accuracy20: 0.4208 - accuracy30: 0.4073 - accuracy50: 0.3914 - val_loss: 13.0054 - val_accuracy10: 0.4126 - val_accuracy20: 0.3918 - val_accuracy30: 0.3730 - val_accuracy50: 0.3531 - 13s/epoch - 30ms/step
Epoch 6/50
448/448 - 13s - loss: 12.8440 - accuracy10: 0.4406 - accuracy20: 0.4251 - accuracy30: 0.4107 - accuracy50: 0.3939 - val_loss: 12.9827 - val_accuracy10: 0.4151 - val_accuracy20: 0.3965 - val_accuracy30: 0.3786 - val_accuracy50: 0.3598 - 13s/epoch - 30ms/step
Epoch 7/50
448/448 - 13s - loss: 12.8140 - accuracy10: 0.4454 - accuracy20: 0.4296 - accuracy30: 0.4151 - accuracy50: 0.3974 - val_loss: 13.0020 - val_accuracy10: 0.4172 - val_accuracy20: 0.3924 - val_accuracy30: 0.3731 - val_accuracy50: 0.3580 - 13s/epoch - 29ms/step
Epoch 8/50
448/448 - 13s - loss: 12.7865 - accuracy10: 0.4477 - accuracy20: 0.4334 - accuracy30: 0.4197 - accuracy50: 0.4020 - val_loss: 12.9777 - val_accuracy10: 0.4185 - val_accuracy20: 0.3989 - val_accuracy30: 0.3799 - val_accuracy50: 0.3625 - 13s/epoch - 28ms/step
Epoch 9/50
448/448 - 13s - loss: 12.7618 - accuracy10: 0.4516 - accuracy20: 0.4372 - accuracy30: 0.4239 - accuracy50: 0.4052 - val_loss: 12.9809 - val_accuracy10: 0.4202 - val_accuracy20: 0.3996 - val_accuracy30: 0.3801 - val_accuracy50: 0.3627 - 13s/epoch - 29ms/step
Epoch 10/50
448/448 - 13s - loss: 12.7356 - accuracy10: 0.4549 - accuracy20: 0.4398 - accuracy30: 0.4257 - accuracy50: 0.4086 - val_loss: 12.9790 - val_accuracy10: 0.4201 - val_accuracy20: 0.4004 - val_accuracy30: 0.3840 - val_accuracy50: 0.3650 - 13s/epoch - 28ms/step
Epoch 11/50
448/448 - 13s - loss: 12.7045 - accuracy10: 0.4588 - accuracy20: 0.4449 - accuracy30: 0.4307 - accuracy50: 0.4115 - val_loss: 12.9572 - val_accuracy10: 0.4240 - val_accuracy20: 0.4057 - val_accuracy30: 0.3899 - val_accuracy50: 0.3712 - 13s/epoch - 30ms/step
Epoch 12/50
448/448 - 13s - loss: 12.6800 - accuracy10: 0.4613 - accuracy20: 0.4481 - accuracy30: 0.4344 - accuracy50: 0.4150 - val_loss: 12.9687 - val_accuracy10: 0.4239 - val_accuracy20: 0.4036 - val_accuracy30: 0.3888 - val_accuracy50: 0.3737 - 13s/epoch - 29ms/step
Epoch 13/50
448/448 - 13s - loss: 12.6553 - accuracy10: 0.4636 - accuracy20: 0.4507 - accuracy30: 0.4377 - accuracy50: 0.4181 - val_loss: 12.9679 - val_accuracy10: 0.4242 - val_accuracy20: 0.4065 - val_accuracy30: 0.3909 - val_accuracy50: 0.3731 - 13s/epoch - 29ms/step
Epoch 14/50
448/448 - 13s - loss: 12.6280 - accuracy10: 0.4663 - accuracy20: 0.4546 - accuracy30: 0.4402 - accuracy50: 0.4193 - val_loss: 12.9779 - val_accuracy10: 0.4254 - val_accuracy20: 0.4054 - val_accuracy30: 0.3880 - val_accuracy50: 0.3747 - 13s/epoch - 28ms/step
Epoch 15/50
448/448 - 13s - loss: 12.6044 - accuracy10: 0.4690 - accuracy20: 0.4564 - accuracy30: 0.4435 - accuracy50: 0.4224 - val_loss: 12.9682 - val_accuracy10: 0.4241 - val_accuracy20: 0.4072 - val_accuracy30: 0.3934 - val_accuracy50: 0.3766 - 13s/epoch - 30ms/step
Epoch 16/50
448/448 - 13s - loss: 12.5764 - accuracy10: 0.4705 - accuracy20: 0.4602 - accuracy30: 0.4461 - accuracy50: 0.4250 - val_loss: 12.9798 - val_accuracy10: 0.4244 - val_accuracy20: 0.4072 - val_accuracy30: 0.3912 - val_accuracy50: 0.3784 - 13s/epoch - 29ms/step
Epoch 17/50
448/448 - 13s - loss: 12.5475 - accuracy10: 0.4733 - accuracy20: 0.4637 - accuracy30: 0.4502 - accuracy50: 0.4296 - val_loss: 12.9848 - val_accuracy10: 0.4258 - val_accuracy20: 0.4079 - val_accuracy30: 0.3958 - val_accuracy50: 0.3802 - 13s/epoch - 29ms/step
Epoch 18/50
448/448 - 13s - loss: 12.5248 - accuracy10: 0.4753 - accuracy20: 0.4669 - accuracy30: 0.4537 - accuracy50: 0.4318 - val_loss: 12.9808 - val_accuracy10: 0.4290 - val_accuracy20: 0.4109 - val_accuracy30: 0.3984 - val_accuracy50: 0.3839 - 13s/epoch - 28ms/step
Epoch 19/50
448/448 - 13s - loss: 12.4870 - accuracy10: 0.4779 - accuracy20: 0.4700 - accuracy30: 0.4570 - accuracy50: 0.4355 - val_loss: 13.0010 - val_accuracy10: 0.4260 - val_accuracy20: 0.4086 - val_accuracy30: 0.3978 - val_accuracy50: 0.3830 - 13s/epoch - 28ms/step
Epoch 20/50
448/448 - 13s - loss: 12.4637 - accuracy10: 0.4795 - accuracy20: 0.4718 - accuracy30: 0.4592 - accuracy50: 0.4380 - val_loss: 13.0181 - val_accuracy10: 0.4250 - val_accuracy20: 0.4105 - val_accuracy30: 0.3972 - val_accuracy50: 0.3843 - 13s/epoch - 30ms/step
Epoch 21/50
448/448 - 13s - loss: 12.4395 - accuracy10: 0.4814 - accuracy20: 0.4768 - accuracy30: 0.4643 - accuracy50: 0.4425 - val_loss: 13.0234 - val_accuracy10: 0.4260 - val_accuracy20: 0.4109 - val_accuracy30: 0.3999 - val_accuracy50: 0.3881 - 13s/epoch - 28ms/step
testing model: results/CHTR/W6/deepOF_L2/seq2seq
Evaluating performance on  test set...
1095/1095 - 12s - 12s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.080908
{'0': {'precision': 0.4585052663971689, 'recall': 0.3264905675411861, 'f1-score': 0.38139729709289144, 'support': 100398}, '1': {'precision': 0.3110698365527489, 'recall': 0.4606287301630958, 'f1-score': 0.3713566669253539, 'support': 72718}, '2': {'precision': 0.45422294451656375, 'recall': 0.4285113304913619, 'f1-score': 0.44099268331401137, 'support': 106968}, 'accuracy': 0.4002799160251924, 'macro avg': {'precision': 0.4079326824888272, 'recall': 0.40521020939854796, 'f1-score': 0.3979155491107522, 'support': 280084}, 'weighted avg': {'precision': 0.4185912370547177, 'recall': 0.4002799160251924, 'f1-score': 0.4015507679401292, 'support': 280084}}
[[32779 34663 32956]
 [17102 33496 22120]
 [21610 39521 45837]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0901978
{'0': {'precision': 0.47050813888716964, 'recall': 0.2997634069400631, 'f1-score': 0.36621143146181084, 'support': 101440}, '1': {'precision': 0.30128002345552324, 'recall': 0.5295577525529924, 'f1-score': 0.38405854119128174, 'support': 73737}, '2': {'precision': 0.43822292630083054, 'recall': 0.358612866634257, 'f1-score': 0.39444106607393736, 'support': 104907}, 'accuracy': 0.38230316619299926, 'macro avg': {'precision': 0.4033370295478411, 'recall': 0.3959780087091042, 'f1-score': 0.3815703462423434, 'support': 280084}, 'weighted avg': {'precision': 0.4138632811145786, 'recall': 0.38230316619299926, 'f1-score': 0.3814835591391375, 'support': 280084}}
[[30408 42485 28547]
 [15008 39048 19681]
 [19212 48074 37621]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.097541
{'0': {'precision': 0.4741572636894987, 'recall': 0.26602732397436024, 'f1-score': 0.3408306255077173, 'support': 100937}, '1': {'precision': 0.29176686577198563, 'recall': 0.6023408202212702, 'f1-score': 0.3931139302247597, 'support': 74931}, '2': {'precision': 0.4357702767557191, 'recall': 0.28751823136562527, 'f1-score': 0.3464506841950086, 'support': 104216}, 'accuracy': 0.36399794347410064, 'macro avg': {'precision': 0.4005648020724011, 'recall': 0.3852954585204185, 'f1-score': 0.3601317466424952, 'support': 280084}, 'weighted avg': {'precision': 0.4110789259884949, 'recall': 0.36399794347410064, 'f1-score': 0.35690916031123143, 'support': 280084}}
[[26852 51584 22501]
 [13501 45134 16296]
 [16278 57974 29964]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1043504
{'0': {'precision': 0.4776110016351516, 'recall': 0.22745924143645857, 'f1-score': 0.30815946978662967, 'support': 100163}, '1': {'precision': 0.286179675339115, 'recall': 0.6752630060078181, 'f1-score': 0.4019928625533943, 'support': 76234}, '2': {'precision': 0.4272789608014933, 'recall': 0.21635306258258027, 'f1-score': 0.28725454417404556, 'support': 103687}, 'accuracy': 0.3452321446423216, 'macro avg': {'precision': 0.39702321259191997, 'recall': 0.3730251033422856, 'f1-score': 0.3324689588380232, 'support': 280084}, 'weighted avg': {'precision': 0.4068738154810993, 'recall': 0.3452321446423216, 'f1-score': 0.32596029326169257, 'support': 280084}}
[[22783 60751 16629]
 [11316 51478 13440]
 [13603 67651 22433]]
Evaluating performance on  train set...
448/448 - 5s - 5s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0497745
{'0': {'precision': 0.46509349955476403, 'recall': 0.39297268828530585, 'f1-score': 0.4260022021940377, 'support': 39873}, '1': {'precision': 0.43218496529810185, 'recall': 0.5588473806563227, 'f1-score': 0.487421902628787, 'support': 36994}, '2': {'precision': 0.45246239065290433, 'recall': 0.3965407470288625, 'f1-score': 0.4226598617335614, 'support': 37696}, 'accuracy': 0.44770999362796016, 'macro avg': {'precision': 0.4499136185019234, 'recall': 0.449453605323497, 'f1-score': 0.445361322185462, 'support': 114563}, 'weighted avg': {'precision': 0.45031071106759574, 'recall': 0.44770999362796016, 'f1-score': 0.44473571591037725, 'support': 114563}}
[[15669 13886 10318]
 [ 8549 20674  7771]
 [ 9472 13276 14948]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0628501
{'0': {'precision': 0.4533041027247103, 'recall': 0.36813592084848795, 'f1-score': 0.40630482686990327, 'support': 39317}, '1': {'precision': 0.4026226233631723, 'recall': 0.5833221683324848, 'f1-score': 0.47641349426067164, 'support': 37319}, '2': {'precision': 0.45356205146157885, 'recall': 0.34160360692910063, 'f1-score': 0.3897010166636588, 'support': 37927}, 'accuracy': 0.4294492986391767, 'macro avg': {'precision': 0.4364962591831538, 'recall': 0.4310205653700245, 'f1-score': 0.42413977926474455, 'support': 114563}, 'weighted avg': {'precision': 0.43687996136537066, 'recall': 0.4294492986391767, 'f1-score': 0.4236459636126898, 'support': 114563}}
[[14474 16254  8589]
 [ 8530 21769  7020]
 [ 8926 16045 12956]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0730199
{'0': {'precision': 0.44293711577428996, 'recall': 0.3335057278063665, 'f1-score': 0.3805098247477429, 'support': 38671}, '1': {'precision': 0.3791731757202905, 'recall': 0.6230219634824028, 'f1-score': 0.47143157494268295, 'support': 37790}, '2': {'precision': 0.45484520190125466, 'recall': 0.2787780169019999, 'f1-score': 0.3456838336994549, 'support': 38102}, 'accuracy': 0.4108045354957534, 'macro avg': {'precision': 0.42565183113194505, 'recall': 0.411768569396923, 'f1-score': 0.39920841112996025, 'support': 114563}, 'weighted avg': {'precision': 0.4258642615627991, 'recall': 0.4108045354957534, 'f1-score': 0.39891884885626755, 'support': 114563}}
[[12897 19212  6562]
 [ 8077 23544  6169]
 [ 8143 19337 10622]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0829705
{'0': {'precision': 0.4265874608653769, 'recall': 0.2787087299714158, 'f1-score': 0.33714530429679446, 'support': 38133}, '1': {'precision': 0.36203497881977936, 'recall': 0.6792927968102408, 'f1-score': 0.47233495362559397, 'support': 38122}, '2': {'precision': 0.4566225165562914, 'recall': 0.21598621697817688, 'f1-score': 0.2932586659105409, 'support': 38308}, 'accuracy': 0.3910337543534998, 'macro avg': {'precision': 0.41508165208048253, 'recall': 0.39132924791994456, 'f1-score': 0.3675796412776431, 'support': 114563}, 'weighted avg': {'precision': 0.41515020095480615, 'recall': 0.3910337543534998, 'f1-score': 0.3674560544378688, 'support': 114563}}
[[10628 22660  4845]
 [ 7225 25896  5001]
 [ 7061 22973  8274]]
Evaluating performance on  val set...
136/136 - 2s - 2s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0665463
{'0': {'precision': 0.43719896257873286, 'recall': 0.3810754077183917, 'f1-score': 0.4072124924510396, 'support': 12386}, '1': {'precision': 0.38692712246431255, 'recall': 0.5002428363283147, 'f1-score': 0.4363482313069265, 'support': 10295}, '2': {'precision': 0.4451110902784288, 'recall': 0.39265630168706583, 'f1-score': 0.41724153082297116, 'support': 12092}, 'accuracy': 0.4203836309780577, 'macro avg': {'precision': 0.4230790584404914, 'recall': 0.4246581819112574, 'f1-score': 0.4202674181936457, 'support': 34773}, 'weighted avg': {'precision': 0.4250667005986554, 'recall': 0.4203836309780577, 'f1-score': 0.4193260162630418, 'support': 34773}}
[[4720 4142 3524]
 [2750 5150 2395]
 [3326 4018 4748]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0786555
{'0': {'precision': 0.4323079937304075, 'recall': 0.3616323854789806, 'f1-score': 0.39382446120208825, 'support': 12203}, '1': {'precision': 0.36675307841866495, 'recall': 0.5381835473133618, 'f1-score': 0.4362304875698593, 'support': 10515}, '2': {'precision': 0.44116037219485493, 'recall': 0.334301119867275, 'f1-score': 0.3803680981595092, 'support': 12055}, 'accuracy': 0.40554453167687576, 'macro avg': {'precision': 0.41340714811464246, 'recall': 0.4113723508865392, 'f1-score': 0.40347434897715223, 'support': 34773}, 'weighted avg': {'precision': 0.415553773153694, 'recall': 0.40554453167687576, 'f1-score': 0.40198259857242796, 'support': 34773}}
[[4413 4816 2974]
 [2725 5659 2131]
 [3070 4955 4030]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0864776
{'0': {'precision': 0.42199544023450225, 'recall': 0.323028338735145, 'f1-score': 0.3659386179627189, 'support': 12033}, '1': {'precision': 0.3500934168589955, 'recall': 0.5989470715427282, 'f1-score': 0.44189353216577076, 'support': 10637}, '2': {'precision': 0.4367191743617599, 'recall': 0.26571924316285217, 'f1-score': 0.3304053012790876, 'support': 12103}, 'accuracy': 0.3874845426048946, 'macro avg': {'precision': 0.40293601048508587, 'recall': 0.3958982178135751, 'f1-score': 0.37941248380252574, 'support': 34773}, 'weighted avg': {'precision': 0.40512544142786877, 'recall': 0.3874845426048946, 'f1-score': 0.3768054597812526, 'support': 34773}}
[[3887 5743 2403]
 [2521 6371 1745]
 [2803 6084 3216]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0932353
{'0': {'precision': 0.41096765946567815, 'recall': 0.27268871925360477, 'f1-score': 0.32784377708662626, 'support': 11790}, '1': {'precision': 0.34067017082785805, 'recall': 0.666024405908799, 'f1-score': 0.4507715713975222, 'support': 10899}, '2': {'precision': 0.43105281814959234, 'recall': 0.20125786163522014, 'f1-score': 0.27439918763398397, 'support': 12084}, 'accuracy': 0.3711500301958416, 'macro avg': {'precision': 0.39423021614770953, 'recall': 0.37999032893254125, 'f1-score': 0.3510048453727108, 'support': 34773}, 'weighted avg': {'precision': 0.3959139318285119, 'recall': 0.3711500301958416, 'f1-score': 0.3478008015380318, 'support': 34773}}
[[3215 6796 1779]
 [2209 7259 1431]
 [2399 7253 2432]]
training model: results/CHTR/W6/deepVOL_L2/seq2seq
Epoch 1/50
448/448 - 18s - loss: 13.2219 - accuracy10: 0.3563 - accuracy20: 0.3609 - accuracy30: 0.3636 - accuracy50: 0.3631 - val_loss: 13.1922 - val_accuracy10: 0.3528 - val_accuracy20: 0.3448 - val_accuracy30: 0.3376 - val_accuracy50: 0.3342 - 18s/epoch - 41ms/step
Epoch 2/50
448/448 - 13s - loss: 13.1300 - accuracy10: 0.3655 - accuracy20: 0.3688 - accuracy30: 0.3684 - accuracy50: 0.3677 - val_loss: 13.1943 - val_accuracy10: 0.3642 - val_accuracy20: 0.3510 - val_accuracy30: 0.3342 - val_accuracy50: 0.3273 - 13s/epoch - 29ms/step
Epoch 3/50
448/448 - 13s - loss: 13.1039 - accuracy10: 0.3734 - accuracy20: 0.3763 - accuracy30: 0.3736 - accuracy50: 0.3701 - val_loss: 13.3392 - val_accuracy10: 0.3290 - val_accuracy20: 0.3207 - val_accuracy30: 0.3188 - val_accuracy50: 0.3233 - 13s/epoch - 28ms/step
Epoch 4/50
448/448 - 13s - loss: 13.0758 - accuracy10: 0.3813 - accuracy20: 0.3810 - accuracy30: 0.3772 - accuracy50: 0.3738 - val_loss: 13.3038 - val_accuracy10: 0.3436 - val_accuracy20: 0.3340 - val_accuracy30: 0.3274 - val_accuracy50: 0.3278 - 13s/epoch - 30ms/step
Epoch 5/50
448/448 - 13s - loss: 13.0608 - accuracy10: 0.3869 - accuracy20: 0.3864 - accuracy30: 0.3822 - accuracy50: 0.3754 - val_loss: 13.3145 - val_accuracy10: 0.3406 - val_accuracy20: 0.3393 - val_accuracy30: 0.3361 - val_accuracy50: 0.3365 - 13s/epoch - 29ms/step
Epoch 6/50
448/448 - 12s - loss: 13.0358 - accuracy10: 0.3931 - accuracy20: 0.3904 - accuracy30: 0.3866 - accuracy50: 0.3809 - val_loss: 13.2777 - val_accuracy10: 0.3458 - val_accuracy20: 0.3351 - val_accuracy30: 0.3282 - val_accuracy50: 0.3293 - 12s/epoch - 27ms/step
Epoch 7/50
448/448 - 13s - loss: 13.0265 - accuracy10: 0.3928 - accuracy20: 0.3910 - accuracy30: 0.3850 - accuracy50: 0.3782 - val_loss: 13.2485 - val_accuracy10: 0.3596 - val_accuracy20: 0.3516 - val_accuracy30: 0.3441 - val_accuracy50: 0.3421 - 13s/epoch - 29ms/step
Epoch 8/50
448/448 - 12s - loss: 13.0077 - accuracy10: 0.4000 - accuracy20: 0.3958 - accuracy30: 0.3896 - accuracy50: 0.3817 - val_loss: 13.2737 - val_accuracy10: 0.3588 - val_accuracy20: 0.3552 - val_accuracy30: 0.3520 - val_accuracy50: 0.3475 - 12s/epoch - 27ms/step
Epoch 9/50
448/448 - 13s - loss: 12.9934 - accuracy10: 0.4011 - accuracy20: 0.3983 - accuracy30: 0.3918 - accuracy50: 0.3828 - val_loss: 13.1967 - val_accuracy10: 0.3624 - val_accuracy20: 0.3612 - val_accuracy30: 0.3560 - val_accuracy50: 0.3503 - 13s/epoch - 29ms/step
Epoch 10/50
448/448 - 13s - loss: 12.9757 - accuracy10: 0.4053 - accuracy20: 0.4014 - accuracy30: 0.3946 - accuracy50: 0.3848 - val_loss: 13.1983 - val_accuracy10: 0.3752 - val_accuracy20: 0.3707 - val_accuracy30: 0.3648 - val_accuracy50: 0.3576 - 13s/epoch - 29ms/step
Epoch 11/50
448/448 - 13s - loss: 12.9638 - accuracy10: 0.4049 - accuracy20: 0.4012 - accuracy30: 0.3941 - accuracy50: 0.3857 - val_loss: 13.1810 - val_accuracy10: 0.3707 - val_accuracy20: 0.3644 - val_accuracy30: 0.3586 - val_accuracy50: 0.3526 - 13s/epoch - 29ms/step
Epoch 12/50
448/448 - 13s - loss: 12.9553 - accuracy10: 0.4050 - accuracy20: 0.4012 - accuracy30: 0.3952 - accuracy50: 0.3853 - val_loss: 13.1767 - val_accuracy10: 0.3736 - val_accuracy20: 0.3686 - val_accuracy30: 0.3613 - val_accuracy50: 0.3548 - 13s/epoch - 29ms/step
Epoch 13/50
448/448 - 13s - loss: 12.9392 - accuracy10: 0.4081 - accuracy20: 0.4050 - accuracy30: 0.3979 - accuracy50: 0.3893 - val_loss: 13.1466 - val_accuracy10: 0.3863 - val_accuracy20: 0.3776 - val_accuracy30: 0.3701 - val_accuracy50: 0.3583 - 13s/epoch - 28ms/step
Epoch 14/50
448/448 - 13s - loss: 12.9399 - accuracy10: 0.4077 - accuracy20: 0.4039 - accuracy30: 0.3982 - accuracy50: 0.3885 - val_loss: 13.1414 - val_accuracy10: 0.3824 - val_accuracy20: 0.3770 - val_accuracy30: 0.3695 - val_accuracy50: 0.3604 - 13s/epoch - 29ms/step
Epoch 15/50
448/448 - 12s - loss: 12.9286 - accuracy10: 0.4090 - accuracy20: 0.4041 - accuracy30: 0.3983 - accuracy50: 0.3901 - val_loss: 13.1647 - val_accuracy10: 0.3812 - val_accuracy20: 0.3762 - val_accuracy30: 0.3680 - val_accuracy50: 0.3577 - 12s/epoch - 28ms/step
Epoch 16/50
448/448 - 12s - loss: 12.9139 - accuracy10: 0.4111 - accuracy20: 0.4058 - accuracy30: 0.4010 - accuracy50: 0.3906 - val_loss: 13.1406 - val_accuracy10: 0.3808 - val_accuracy20: 0.3751 - val_accuracy30: 0.3667 - val_accuracy50: 0.3597 - 12s/epoch - 28ms/step
Epoch 17/50
448/448 - 12s - loss: 12.9057 - accuracy10: 0.4111 - accuracy20: 0.4073 - accuracy30: 0.4015 - accuracy50: 0.3914 - val_loss: 13.1301 - val_accuracy10: 0.3852 - val_accuracy20: 0.3759 - val_accuracy30: 0.3666 - val_accuracy50: 0.3569 - 12s/epoch - 28ms/step
Epoch 18/50
448/448 - 13s - loss: 12.8919 - accuracy10: 0.4152 - accuracy20: 0.4103 - accuracy30: 0.4047 - accuracy50: 0.3945 - val_loss: 13.1548 - val_accuracy10: 0.3840 - val_accuracy20: 0.3809 - val_accuracy30: 0.3721 - val_accuracy50: 0.3604 - 13s/epoch - 29ms/step
Epoch 19/50
448/448 - 13s - loss: 12.8823 - accuracy10: 0.4143 - accuracy20: 0.4100 - accuracy30: 0.4045 - accuracy50: 0.3939 - val_loss: 13.1198 - val_accuracy10: 0.3871 - val_accuracy20: 0.3786 - val_accuracy30: 0.3714 - val_accuracy50: 0.3585 - 13s/epoch - 28ms/step
Epoch 20/50
448/448 - 12s - loss: 12.8723 - accuracy10: 0.4144 - accuracy20: 0.4117 - accuracy30: 0.4064 - accuracy50: 0.3969 - val_loss: 13.1369 - val_accuracy10: 0.3859 - val_accuracy20: 0.3789 - val_accuracy30: 0.3703 - val_accuracy50: 0.3607 - 12s/epoch - 28ms/step
Epoch 21/50
448/448 - 12s - loss: 12.8660 - accuracy10: 0.4157 - accuracy20: 0.4122 - accuracy30: 0.4068 - accuracy50: 0.3962 - val_loss: 13.1335 - val_accuracy10: 0.3847 - val_accuracy20: 0.3770 - val_accuracy30: 0.3708 - val_accuracy50: 0.3614 - 12s/epoch - 28ms/step
Epoch 22/50
448/448 - 13s - loss: 12.8631 - accuracy10: 0.4165 - accuracy20: 0.4127 - accuracy30: 0.4069 - accuracy50: 0.3962 - val_loss: 13.1459 - val_accuracy10: 0.3837 - val_accuracy20: 0.3767 - val_accuracy30: 0.3717 - val_accuracy50: 0.3612 - 13s/epoch - 28ms/step
Epoch 23/50
448/448 - 13s - loss: 12.8486 - accuracy10: 0.4177 - accuracy20: 0.4139 - accuracy30: 0.4093 - accuracy50: 0.3991 - val_loss: 13.1606 - val_accuracy10: 0.3869 - val_accuracy20: 0.3785 - val_accuracy30: 0.3702 - val_accuracy50: 0.3618 - 13s/epoch - 28ms/step
Epoch 24/50
448/448 - 12s - loss: 12.8379 - accuracy10: 0.4175 - accuracy20: 0.4157 - accuracy30: 0.4101 - accuracy50: 0.3985 - val_loss: 13.1378 - val_accuracy10: 0.3890 - val_accuracy20: 0.3823 - val_accuracy30: 0.3760 - val_accuracy50: 0.3628 - 12s/epoch - 28ms/step
Epoch 25/50
448/448 - 13s - loss: 12.8314 - accuracy10: 0.4185 - accuracy20: 0.4159 - accuracy30: 0.4117 - accuracy50: 0.4011 - val_loss: 13.1339 - val_accuracy10: 0.3884 - val_accuracy20: 0.3829 - val_accuracy30: 0.3757 - val_accuracy50: 0.3659 - 13s/epoch - 28ms/step
Epoch 26/50
448/448 - 13s - loss: 12.8165 - accuracy10: 0.4205 - accuracy20: 0.4192 - accuracy30: 0.4147 - accuracy50: 0.4031 - val_loss: 13.1647 - val_accuracy10: 0.3879 - val_accuracy20: 0.3821 - val_accuracy30: 0.3757 - val_accuracy50: 0.3651 - 13s/epoch - 28ms/step
Epoch 27/50
448/448 - 12s - loss: 12.8155 - accuracy10: 0.4201 - accuracy20: 0.4184 - accuracy30: 0.4142 - accuracy50: 0.4021 - val_loss: 13.1437 - val_accuracy10: 0.3887 - val_accuracy20: 0.3831 - val_accuracy30: 0.3749 - val_accuracy50: 0.3661 - 12s/epoch - 28ms/step
Epoch 28/50
448/448 - 13s - loss: 12.8034 - accuracy10: 0.4212 - accuracy20: 0.4203 - accuracy30: 0.4143 - accuracy50: 0.4030 - val_loss: 13.1558 - val_accuracy10: 0.3881 - val_accuracy20: 0.3812 - val_accuracy30: 0.3750 - val_accuracy50: 0.3637 - 13s/epoch - 29ms/step
Epoch 29/50
448/448 - 13s - loss: 12.7880 - accuracy10: 0.4227 - accuracy20: 0.4223 - accuracy30: 0.4168 - accuracy50: 0.4058 - val_loss: 13.1237 - val_accuracy10: 0.3884 - val_accuracy20: 0.3837 - val_accuracy30: 0.3770 - val_accuracy50: 0.3644 - 13s/epoch - 28ms/step
testing model: results/CHTR/W6/deepVOL_L2/seq2seq
Evaluating performance on  test set...
1095/1095 - 11s - 11s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0993619
{'0': {'precision': 0.4422211654534148, 'recall': 0.24081673306772908, 'f1-score': 0.3118253221042857, 'support': 100400}, '1': {'precision': 0.29851171808176996, 'recall': 0.6479049491879701, 'f1-score': 0.4087147368055796, 'support': 72719}, '2': {'precision': 0.4555650912964991, 'recall': 0.28781901467701226, 'f1-score': 0.35276593794399375, 'support': 106970}, 'accuracy': 0.36445915405460405, 'macro avg': {'precision': 0.39876599161056125, 'recall': 0.3921802323109038, 'f1-score': 0.35776866561795306, 'support': 280089}, 'weighted avg': {'precision': 0.4100063781680022, 'recall': 0.36445915405460405, 'f1-score': 0.3526163528982011, 'support': 280089}}
[[24178 52895 23327]
 [12137 47115 13467]
 [18359 57823 30788]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1036665
{'0': {'precision': 0.4467293563403189, 'recall': 0.23556317895940537, 'f1-score': 0.30846882200693204, 'support': 101442}, '1': {'precision': 0.2965970098947926, 'recall': 0.6682985706148797, 'f1-score': 0.41085348874048505, 'support': 73738}, '2': {'precision': 0.4490818858560794, 'recall': 0.25876712198190815, 'f1-score': 0.32834015687080836, 'support': 104909}, 'accuracy': 0.3581790073869377, 'macro avg': {'precision': 0.3974694173637303, 'recall': 0.3875429571853977, 'f1-score': 0.3492208225394085, 'support': 280089}, 'weighted avg': {'precision': 0.40808572005602606, 'recall': 0.3581790073869377, 'f1-score': 0.34286618293446985, 'support': 280089}}
[[23896 56589 20957]
 [12113 49279 12346]
 [17482 60280 27147]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1088898
{'0': {'precision': 0.43472837871548364, 'recall': 0.22444248506523742, 'f1-score': 0.2960431748686721, 'support': 100939}, '1': {'precision': 0.29122921946201896, 'recall': 0.6763555804673633, 'f1-score': 0.40714675921462773, 'support': 74931}, '2': {'precision': 0.442943193401909, 'recall': 0.22931519204751533, 'f1-score': 0.30218620000758656, 'support': 104219}, 'accuracy': 0.34715394035467295, 'macro avg': {'precision': 0.3896335971931372, 'recall': 0.376704419193372, 'f1-score': 0.33512537803029546, 'support': 280089}, 'weighted avg': {'precision': 0.3993953391094413, 'recall': 0.34715394035467295, 'f1-score': 0.3280520099731543, 'support': 280089}}
[[22655 59884 18400]
 [12595 50680 11656]
 [16863 63457 23899]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1156693
{'0': {'precision': 0.41655906716195545, 'recall': 0.20935456496780314, 'f1-score': 0.2786599869772634, 'support': 100165}, '1': {'precision': 0.28639832493043504, 'recall': 0.6817996983013052, 'f1-score': 0.40336023591494646, 'support': 76235}, '2': {'precision': 0.4250046619563641, 'recall': 0.19782233409522706, 'f1-score': 0.2699799936822154, 'support': 103689}, 'accuracy': 0.3336760815312276, 'macro avg': {'precision': 0.37598735134958483, 'recall': 0.3629921991214451, 'f1-score': 0.31733340552480843, 'support': 280089}, 'weighted avg': {'precision': 0.38425830238582176, 'recall': 0.3336760815312276, 'f1-score': 0.30938773299011657, 'support': 280089}}
[[20970 62765 16430]
 [12937 51977 11321]
 [16434 66743 20512]]
Evaluating performance on  train set...
448/448 - 5s - 5s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0758045
{'0': {'precision': 0.46593514575827055, 'recall': 0.21414055247509847, 'f1-score': 0.2934250107434465, 'support': 39857}, '1': {'precision': 0.37677838905733374, 'recall': 0.7413616240146852, 'f1-score': 0.49963159378894423, 'support': 37044}, '2': {'precision': 0.4462473776598022, 'recall': 0.2767437538167432, 'f1-score': 0.34162569649295316, 'support': 37663}, 'accuracy': 0.40519709507349605, 'macro avg': {'precision': 0.42965363749180213, 'recall': 0.41074864343550893, 'f1-score': 0.37822743367511463, 'support': 114564}, 'weighted avg': {'precision': 0.4306341497636988, 'recall': 0.40519709507349605, 'f1-score': 0.3759474356738006, 'support': 114564}}
[[ 8535 23610  7712]
 [ 4359 27463  5222]
 [ 5424 21816 10423]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0803378
{'0': {'precision': 0.46595281914003683, 'recall': 0.21197513636940252, 'f1-score': 0.2913891117078785, 'support': 39415}, '1': {'precision': 0.3691996509875466, 'recall': 0.7507258064516129, 'f1-score': 0.494975275163503, 'support': 37200}, '2': {'precision': 0.4506693344766805, 'recall': 0.2492819310126749, 'f1-score': 0.3210044112656939, 'support': 37949}, 'accuracy': 0.3992702768758074, 'macro avg': {'precision': 0.4286072682014213, 'recall': 0.4039942912778967, 'f1-score': 0.3691229327123584, 'support': 114564}, 'weighted avg': {'precision': 0.42947355152750283, 'recall': 0.3992702768758074, 'f1-score': 0.3673054229703062, 'support': 114564}}
[[ 8355 24470  6590]
 [ 4332 27927  4941]
 [ 5244 23245  9460]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0841612
{'0': {'precision': 0.45475241889584517, 'recall': 0.20678588990398303, 'f1-score': 0.2842961091640129, 'support': 38639}, '1': {'precision': 0.36597383981365345, 'recall': 0.7559215396002961, 'f1-score': 0.4931787999517084, 'support': 37828}, '2': {'precision': 0.45063626723223754, 'recall': 0.2230884321600126, 'f1-score': 0.29843566199062455, 'support': 38097}, 'accuracy': 0.3935267623337174, 'macro avg': {'precision': 0.42378750864724535, 'recall': 0.39526528722143056, 'f1-score': 0.35863685703544856, 'support': 114564}, 'weighted avg': {'precision': 0.4240697513960231, 'recall': 0.3935267623337174, 'f1-score': 0.3579692435792949, 'support': 114564}}
[[ 7990 25007  5642]
 [ 4514 28595  4719]
 [ 5066 24532  8499]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0913512
{'0': {'precision': 0.4318551195727885, 'recall': 0.19478989396517868, 'f1-score': 0.2684805946989517, 'support': 38195}, '1': {'precision': 0.3573629773801949, 'recall': 0.7539615688339036, 'f1-score': 0.4848951676386691, 'support': 37990}, '2': {'precision': 0.4436427116671516, 'recall': 0.19865030355142135, 'f1-score': 0.27442228781225253, 'support': 38379}, 'accuracy': 0.38150727977375093, 'macro avg': {'precision': 0.4109536028733783, 'recall': 0.38246725545016785, 'f1-score': 0.3425993500499578, 'support': 114564}, 'weighted avg': {'precision': 0.41110199917801293, 'recall': 0.38150727977375093, 'f1-score': 0.3422352284929466, 'support': 114564}}
[[ 7440 25774  4981]
 [ 4767 28643  4580]
 [ 5021 25734  7624]]
Evaluating performance on  val set...
136/136 - 1s - 1s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0878953
{'0': {'precision': 0.4519247074783788, 'recall': 0.21608692126814238, 'f1-score': 0.29237520570488207, 'support': 12333}, '1': {'precision': 0.349673662957224, 'recall': 0.7192389414718949, 'f1-score': 0.4705696502480175, 'support': 10354}, '2': {'precision': 0.44596912521440824, 'recall': 0.2796624193281483, 'f1-score': 0.3437579455886092, 'support': 12086}, 'accuracy': 0.38800218560377303, 'macro avg': {'precision': 0.415855831883337, 'recall': 0.40499609402272857, 'f1-score': 0.3689009338471696, 'support': 34773}, 'weighted avg': {'precision': 0.419408488509225, 'recall': 0.38800218560377303, 'f1-score': 0.3632933626954883, 'support': 34773}}
[[2665 7038 2630]
 [1338 7447 1569]
 [1894 6812 3380]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.092473
{'0': {'precision': 0.4466748123581777, 'recall': 0.20997784524493313, 'f1-score': 0.2856664434025452, 'support': 12187}, '1': {'precision': 0.3424122767656825, 'recall': 0.7237977805178791, 'f1-score': 0.46489384385756494, 'support': 10543}, '2': {'precision': 0.4459899378514353, 'recall': 0.25026986631238063, 'f1-score': 0.3206212435508749, 'support': 12043}, 'accuracy': 0.379719897621718, 'macro avg': {'precision': 0.4116923423250985, 'recall': 0.39468183069173096, 'f1-score': 0.35706051027032837, 'support': 34773}, 'weighted avg': {'precision': 0.41482573817888985, 'recall': 0.379719897621718, 'f1-score': 0.35211325964456075, 'support': 34773}}
[[2559 7422 2206]
 [1374 7631 1538]
 [1796 7233 3014]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0969366
{'0': {'precision': 0.4335414808206958, 'recall': 0.2021798818537316, 'f1-score': 0.27576032682705404, 'support': 12019}, '1': {'precision': 0.3380013831258645, 'recall': 0.735653809971778, 'f1-score': 0.46318782206953746, 'support': 10630}, '2': {'precision': 0.44346816976127323, 'recall': 0.22063675354668427, 'f1-score': 0.2946684291694206, 'support': 12124}, 'accuracy': 0.37169643113910217, 'macro avg': {'precision': 0.40500367790261116, 'recall': 0.38615681512406463, 'f1-score': 0.34453885935533735, 'support': 34773}, 'weighted avg': {'precision': 0.40779621691535267, 'recall': 0.37169643113910217, 'f1-score': 0.3396488641182412, 'support': 34773}}
[[2430 7639 1950]
 [1403 7820 1407]
 [1772 7677 2675]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1019809
{'0': {'precision': 0.41335044929396664, 'recall': 0.19176450570018716, 'f1-score': 0.26198640088336145, 'support': 11754}, '1': {'precision': 0.3357241726437649, 'recall': 0.7319615912208505, 'f1-score': 0.46031746031746035, 'support': 10935}, '2': {'precision': 0.42197481292206607, 'recall': 0.19132737504137703, 'f1-score': 0.26328076069008716, 'support': 12084}, 'accuracy': 0.3614873608834441, 'macro avg': {'precision': 0.3903498116199325, 'recall': 0.3716844906541383, 'f1-score': 0.3285282072969697, 'support': 34773}, 'weighted avg': {'precision': 0.39193652110002297, 'recall': 0.3614873608834441, 'f1-score': 0.32480500091258946, 'support': 34773}}
[[2254 7758 1742]
 [1506 8004 1425]
 [1693 8079 2312]]
training model: results/CHTR/W6/deepVOL_L3/seq2seq
Epoch 1/50
448/448 - 25s - loss: 13.2151 - accuracy10: 0.3567 - accuracy20: 0.3591 - accuracy30: 0.3585 - accuracy50: 0.3591 - val_loss: 13.2380 - val_accuracy10: 0.3429 - val_accuracy20: 0.3384 - val_accuracy30: 0.3295 - val_accuracy50: 0.3299 - 25s/epoch - 56ms/step
Epoch 2/50
448/448 - 19s - loss: 13.1594 - accuracy10: 0.3579 - accuracy20: 0.3607 - accuracy30: 0.3603 - accuracy50: 0.3610 - val_loss: 13.1814 - val_accuracy10: 0.3528 - val_accuracy20: 0.3445 - val_accuracy30: 0.3349 - val_accuracy50: 0.3323 - 19s/epoch - 43ms/step
Epoch 3/50
448/448 - 19s - loss: 13.1554 - accuracy10: 0.3587 - accuracy20: 0.3596 - accuracy30: 0.3568 - accuracy50: 0.3576 - val_loss: 13.3438 - val_accuracy10: 0.2997 - val_accuracy20: 0.3040 - val_accuracy30: 0.3061 - val_accuracy50: 0.3151 - 19s/epoch - 41ms/step
Epoch 4/50
448/448 - 19s - loss: 13.1369 - accuracy10: 0.3628 - accuracy20: 0.3654 - accuracy30: 0.3631 - accuracy50: 0.3612 - val_loss: 13.3539 - val_accuracy10: 0.3054 - val_accuracy20: 0.3074 - val_accuracy30: 0.3100 - val_accuracy50: 0.3179 - 19s/epoch - 41ms/step
Epoch 5/50
448/448 - 19s - loss: 13.1108 - accuracy10: 0.3734 - accuracy20: 0.3714 - accuracy30: 0.3673 - accuracy50: 0.3650 - val_loss: 13.1998 - val_accuracy10: 0.3473 - val_accuracy20: 0.3420 - val_accuracy30: 0.3370 - val_accuracy50: 0.3366 - 19s/epoch - 42ms/step
Epoch 6/50
448/448 - 19s - loss: 13.0856 - accuracy10: 0.3787 - accuracy20: 0.3774 - accuracy30: 0.3718 - accuracy50: 0.3677 - val_loss: 13.2321 - val_accuracy10: 0.3490 - val_accuracy20: 0.3452 - val_accuracy30: 0.3419 - val_accuracy50: 0.3391 - 19s/epoch - 42ms/step
Epoch 7/50
448/448 - 18s - loss: 13.0616 - accuracy10: 0.3857 - accuracy20: 0.3835 - accuracy30: 0.3797 - accuracy50: 0.3743 - val_loss: 13.2440 - val_accuracy10: 0.3447 - val_accuracy20: 0.3374 - val_accuracy30: 0.3341 - val_accuracy50: 0.3329 - 18s/epoch - 41ms/step
Epoch 8/50
448/448 - 18s - loss: 13.0374 - accuracy10: 0.3895 - accuracy20: 0.3867 - accuracy30: 0.3805 - accuracy50: 0.3757 - val_loss: 13.2346 - val_accuracy10: 0.3518 - val_accuracy20: 0.3457 - val_accuracy30: 0.3449 - val_accuracy50: 0.3426 - 18s/epoch - 41ms/step
Epoch 9/50
448/448 - 18s - loss: 13.0282 - accuracy10: 0.3931 - accuracy20: 0.3916 - accuracy30: 0.3861 - accuracy50: 0.3792 - val_loss: 13.2300 - val_accuracy10: 0.3514 - val_accuracy20: 0.3450 - val_accuracy30: 0.3405 - val_accuracy50: 0.3389 - 18s/epoch - 41ms/step
Epoch 10/50
448/448 - 18s - loss: 13.0039 - accuracy10: 0.3988 - accuracy20: 0.3953 - accuracy30: 0.3918 - accuracy50: 0.3821 - val_loss: 13.1829 - val_accuracy10: 0.3692 - val_accuracy20: 0.3615 - val_accuracy30: 0.3554 - val_accuracy50: 0.3479 - 18s/epoch - 41ms/step
Epoch 11/50
448/448 - 18s - loss: 12.9927 - accuracy10: 0.4009 - accuracy20: 0.3972 - accuracy30: 0.3908 - accuracy50: 0.3827 - val_loss: 13.1944 - val_accuracy10: 0.3727 - val_accuracy20: 0.3664 - val_accuracy30: 0.3586 - val_accuracy50: 0.3512 - 18s/epoch - 41ms/step
Epoch 12/50
448/448 - 19s - loss: 12.9673 - accuracy10: 0.4030 - accuracy20: 0.4018 - accuracy30: 0.3966 - accuracy50: 0.3892 - val_loss: 13.2052 - val_accuracy10: 0.3691 - val_accuracy20: 0.3618 - val_accuracy30: 0.3555 - val_accuracy50: 0.3531 - 19s/epoch - 42ms/step
testing model: results/CHTR/W6/deepVOL_L3/seq2seq
Evaluating performance on  test set...
1095/1095 - 20s - 20s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0972387
{'0': {'precision': 0.36694941236586615, 'recall': 0.17881474103585657, 'f1-score': 0.2404553825548301, 'support': 100400}, '1': {'precision': 0.27630253639776575, 'recall': 0.24897207057302767, 'f1-score': 0.26192629028174613, 'support': 72719}, '2': {'precision': 0.38296767649935404, 'recall': 0.5930073852482004, 'f1-score': 0.4653861955628595, 'support': 106970}, 'accuracy': 0.3552156635926438, 'macro avg': {'precision': 0.34207320842099537, 'recall': 0.34026473228569487, 'f1-score': 0.3225892894664786, 'support': 280089}, 'weighted avg': {'precision': 0.3495325325199418, 'recall': 0.3552156635926438, 'f1-score': 0.3319341339747806, 'support': 280089}}
[[17953 22395 60052]
 [12462 18105 42152]
 [18510 25026 63434]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1010656
{'0': {'precision': 0.37306601187212435, 'recall': 0.1542654916109698, 'f1-score': 0.21827336825000523, 'support': 101442}, '1': {'precision': 0.2712922583771292, 'recall': 0.39483034527651956, 'f1-score': 0.3216057087940615, 'support': 73738}, '2': {'precision': 0.37463501138917343, 'recall': 0.46718584678149633, 'f1-score': 0.41582285193119395, 'support': 104909}, 'accuracy': 0.3348042943492961, 'macro avg': {'precision': 0.33966442721280904, 'recall': 0.3387605612229952, 'f1-score': 0.31856730965842023, 'support': 280089}, 'weighted avg': {'precision': 0.3468600885231894, 'recall': 0.3348042943492961, 'f1-score': 0.31947062665910897, 'support': 280089}}
[[15649 37782 48011]
 [10821 29114 33803]
 [15477 40420 49012]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1032996
{'0': {'precision': 0.3716624779157439, 'recall': 0.14797055647470253, 'f1-score': 0.21166900500262176, 'support': 100939}, '1': {'precision': 0.270518079817436, 'recall': 0.5315556979087427, 'f1-score': 0.3585591019368313, 'support': 74931}, '2': {'precision': 0.37109619493665424, 'recall': 0.32995902858403936, 'f1-score': 0.34932066942631484, 'support': 104219}, 'accuracy': 0.3183059670319077, 'macro avg': {'precision': 0.33775891755661136, 'recall': 0.3364950943224949, 'f1-score': 0.3065162587885893, 'support': 280089}, 'weighted avg': {'precision': 0.34439304448671937, 'recall': 0.3183059670319077, 'f1-score': 0.30218502193991714, 'support': 280089}}
[[14936 52268 33735]
 [10558 39830 24543]
 [14693 55138 34388]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.104858
{'0': {'precision': 0.3683470719969505, 'recall': 0.15435531373234163, 'f1-score': 0.21754761184474353, 'support': 100165}, '1': {'precision': 0.2735509205247133, 'recall': 0.6305109201810192, 'f1-score': 0.381559833300258, 'support': 76235}, '2': {'precision': 0.36767628205128206, 'recall': 0.22126744399116588, 'f1-score': 0.2762735641734251, 'support': 103689}, 'accuracy': 0.3087268689595093, 'macro avg': {'precision': 0.336524758190982, 'recall': 0.33537789263484225, 'f1-score': 0.2917936697728089, 'support': 280089}, 'weighted avg': {'precision': 0.34229700167586535, 'recall': 0.3087268689595093, 'f1-score': 0.2839290369405874, 'support': 280089}}
[[15461 62066 22638]
 [11349 48067 16819]
 [15164 65582 22943]]
Evaluating performance on  train set...
448/448 - 8s - 8s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0995764
{'0': {'precision': 0.3524974515800204, 'recall': 0.17352033519833404, 'f1-score': 0.23256048556584896, 'support': 39857}, '1': {'precision': 0.3531291241230812, 'recall': 0.2744843969333765, 'f1-score': 0.3088793705762629, 'support': 37044}, '2': {'precision': 0.3328798185941043, 'recall': 0.5846586835886679, 'f1-score': 0.4242243264331057, 'support': 37663}, 'accuracy': 0.3413288642156349, 'macro avg': {'precision': 0.34616879809906864, 'recall': 0.3442211385734595, 'f1-score': 0.3218880608584059, 'support': 114564}, 'weighted avg': {'precision': 0.3462523900121333, 'recall': 0.3413288642156349, 'f1-score': 0.3202476474570998, 'support': 114564}}
[[ 6916  9484 23457]
 [ 6203 10168 20673]
 [ 6501  9142 22020]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0995213
{'0': {'precision': 0.3553174935663415, 'recall': 0.15062793352784473, 'f1-score': 0.2115672439598033, 'support': 39415}, '1': {'precision': 0.34152296658019227, 'recall': 0.42112903225806453, 'f1-score': 0.377171335363725, 'support': 37200}, '2': {'precision': 0.3362765466297322, 'recall': 0.4606445492634852, 'f1-score': 0.38875607396617484, 'support': 37949}, 'accuracy': 0.341154289305541, 'macro avg': {'precision': 0.3443723355920887, 'recall': 0.3441338383497981, 'f1-score': 0.3258315510965677, 'support': 114564}, 'weighted avg': {'precision': 0.34453102225613813, 'recall': 0.341154289305541, 'f1-score': 0.32403373526717455, 'support': 114564}}
[[ 5937 15267 18211]
 [ 5242 15666 16292]
 [ 5530 14938 17481]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0996423
{'0': {'precision': 0.3493301465500975, 'recall': 0.14374078004089133, 'f1-score': 0.20367450218196487, 'support': 38639}, '1': {'precision': 0.338545524815614, 'recall': 0.5557523527545734, 'f1-score': 0.42077137081440263, 'support': 37828}, '2': {'precision': 0.3377635573057675, 'recall': 0.3241987558075439, 'f1-score': 0.3308421729347477, 'support': 38097}, 'accuracy': 0.3397926050068084, 'macro avg': {'precision': 0.341879742890493, 'recall': 0.3412306295343362, 'f1-score': 0.3184293486437051, 'support': 114564}, 'weighted avg': {'precision': 0.34192281945420977, 'recall': 0.3397926050068084, 'f1-score': 0.31764614335455504, 'support': 114564}}
[[ 5554 20621 12464]
 [ 5053 21023 11752]
 [ 5292 20454 12351]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1002324
{'0': {'precision': 0.3385593220338983, 'recall': 0.14643277915957587, 'f1-score': 0.20444119528465687, 'support': 38195}, '1': {'precision': 0.33572459230622637, 'recall': 0.6491971571466175, 'f1-score': 0.44257617629113877, 'support': 37990}, '2': {'precision': 0.3366284273045318, 'recall': 0.21561270486463952, 'f1-score': 0.2628611362589539, 'support': 38379}, 'accuracy': 0.3363272930414441, 'macro avg': {'precision': 0.3369707805482188, 'recall': 0.3370808803902776, 'f1-score': 0.3032928359449165, 'support': 114564}, 'weighted avg': {'precision': 0.33697246061868397, 'recall': 0.3363272930414441, 'f1-score': 0.3029786664194705, 'support': 114564}}
[[ 5593 24281  8321]
 [ 5341 24663  7986]
 [ 5586 24518  8275]]
Evaluating performance on  val set...
136/136 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0974936
{'0': {'precision': 0.3686149723664378, 'recall': 0.17846428281845456, 'f1-score': 0.2404938811188811, 'support': 12333}, '1': {'precision': 0.33325283747886986, 'recall': 0.2665636468997489, 'f1-score': 0.29620090148100453, 'support': 10354}, '2': {'precision': 0.35769980506822613, 'recall': 0.6073142478901208, 'f1-score': 0.4502238851745078, 'support': 12086}, 'accuracy': 0.3537514738446496, 'macro avg': {'precision': 0.35318920497117795, 'recall': 0.35078072586944137, 'f1-score': 0.3289728892581311, 'support': 34773}, 'weighted avg': {'precision': 0.35429178320841104, 'recall': 0.3537514738446496, 'f1-score': 0.329976736145647, 'support': 34773}}
[[2201 2795 7337]
 [1751 2760 5843]
 [2019 2727 7340]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0987716
{'0': {'precision': 0.36706889840404827, 'recall': 0.15475506687453844, 'f1-score': 0.2177200577200577, 'support': 12187}, '1': {'precision': 0.320859167404783, 'recall': 0.41231148629422365, 'f1-score': 0.36088165705035075, 'support': 10543}, '2': {'precision': 0.35363958475787904, 'recall': 0.4723906003487503, 'f1-score': 0.4044792036971205, 'support': 12043}, 'accuracy': 0.34285221292382023, 'macro avg': {'precision': 0.34718921685557014, 'recall': 0.34648571783917076, 'f1-score': 0.3276936394891763, 'support': 34773}, 'weighted avg': {'precision': 0.3484073386258851, 'recall': 0.34285221292382023, 'f1-score': 0.3258065943070949, 'support': 34773}}
[[1886 4603 5698]
 [1496 4347 4700]
 [1756 4598 5689]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0999773
{'0': {'precision': 0.3524888709024686, 'recall': 0.14493718279390963, 'f1-score': 0.2054124167207122, 'support': 12019}, '1': {'precision': 0.3159849300322928, 'recall': 0.552304797742239, 'f1-score': 0.40198562136254706, 'support': 10630}, '2': {'precision': 0.35596835836814505, 'recall': 0.33033652259980206, 'f1-score': 0.3426737967914439, 'support': 12124}, 'accuracy': 0.334109797831651, 'macro avg': {'precision': 0.3414807197676355, 'recall': 0.3425261677119836, 'f1-score': 0.3166906116249011, 'support': 34773}, 'weighted avg': {'precision': 0.34254289024459883, 'recall': 0.334109797831651, 'f1-score': 0.31336197923531417, 'support': 34773}}
[[1742 6345 3932]
 [1445 5871 3314]
 [1755 6364 4005]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1008674
{'0': {'precision': 0.3545313107740179, 'recall': 0.15509613748511145, 'f1-score': 0.21579071969696972, 'support': 11754}, '1': {'precision': 0.3184408067287691, 'recall': 0.6439871970736168, 'f1-score': 0.42615510302883597, 'support': 10935}, '2': {'precision': 0.34707995210855397, 'recall': 0.2159053293611387, 'f1-score': 0.26621090760675475, 'support': 12084}, 'accuracy': 0.32996865384062346, 'macro avg': {'precision': 0.3400173565371136, 'recall': 0.3383295546399556, 'f1-score': 0.30271891011085345, 'support': 34773}, 'weighted avg': {'precision': 0.34059256865086884, 'recall': 0.32996865384062346, 'f1-score': 0.2994651821372481, 'support': 34773}}
[[1823 7362 2569]
 [1554 7042 2339]
 [1765 7710 2609]]
training model: results/CHTR/W7/deepLOB_L1/seq2seq
Epoch 1/50
401/401 - 17s - loss: 13.1853 - accuracy10: 0.3709 - accuracy20: 0.3733 - accuracy30: 0.3717 - accuracy50: 0.3689 - val_loss: 13.3174 - val_accuracy10: 0.3633 - val_accuracy20: 0.3683 - val_accuracy30: 0.3662 - val_accuracy50: 0.3559 - 17s/epoch - 42ms/step
Epoch 2/50
401/401 - 10s - loss: 13.0753 - accuracy10: 0.3882 - accuracy20: 0.3893 - accuracy30: 0.3871 - accuracy50: 0.3810 - val_loss: 13.2949 - val_accuracy10: 0.3667 - val_accuracy20: 0.3658 - val_accuracy30: 0.3639 - val_accuracy50: 0.3571 - 10s/epoch - 25ms/step
Epoch 3/50
401/401 - 9s - loss: 13.0327 - accuracy10: 0.3939 - accuracy20: 0.3941 - accuracy30: 0.3915 - accuracy50: 0.3852 - val_loss: 13.1720 - val_accuracy10: 0.3783 - val_accuracy20: 0.3769 - val_accuracy30: 0.3733 - val_accuracy50: 0.3615 - 9s/epoch - 23ms/step
Epoch 4/50
401/401 - 9s - loss: 13.0097 - accuracy10: 0.3987 - accuracy20: 0.3990 - accuracy30: 0.3940 - accuracy50: 0.3860 - val_loss: 13.1663 - val_accuracy10: 0.3917 - val_accuracy20: 0.3884 - val_accuracy30: 0.3821 - val_accuracy50: 0.3690 - 9s/epoch - 23ms/step
Epoch 5/50
401/401 - 9s - loss: 12.9760 - accuracy10: 0.4023 - accuracy20: 0.4015 - accuracy30: 0.3979 - accuracy50: 0.3915 - val_loss: 13.1391 - val_accuracy10: 0.3909 - val_accuracy20: 0.3873 - val_accuracy30: 0.3824 - val_accuracy50: 0.3693 - 9s/epoch - 23ms/step
Epoch 6/50
401/401 - 9s - loss: 12.9459 - accuracy10: 0.4063 - accuracy20: 0.4055 - accuracy30: 0.4016 - accuracy50: 0.3940 - val_loss: 13.1670 - val_accuracy10: 0.3906 - val_accuracy20: 0.3884 - val_accuracy30: 0.3812 - val_accuracy50: 0.3711 - 9s/epoch - 22ms/step
Epoch 7/50
401/401 - 9s - loss: 12.9193 - accuracy10: 0.4104 - accuracy20: 0.4083 - accuracy30: 0.4036 - accuracy50: 0.3957 - val_loss: 13.1990 - val_accuracy10: 0.3855 - val_accuracy20: 0.3850 - val_accuracy30: 0.3791 - val_accuracy50: 0.3707 - 9s/epoch - 23ms/step
Epoch 8/50
401/401 - 9s - loss: 12.8917 - accuracy10: 0.4129 - accuracy20: 0.4127 - accuracy30: 0.4051 - accuracy50: 0.3980 - val_loss: 13.1987 - val_accuracy10: 0.3856 - val_accuracy20: 0.3842 - val_accuracy30: 0.3760 - val_accuracy50: 0.3652 - 9s/epoch - 22ms/step
Epoch 9/50
401/401 - 9s - loss: 12.8752 - accuracy10: 0.4132 - accuracy20: 0.4115 - accuracy30: 0.4061 - accuracy50: 0.3981 - val_loss: 13.1904 - val_accuracy10: 0.3861 - val_accuracy20: 0.3863 - val_accuracy30: 0.3797 - val_accuracy50: 0.3694 - 9s/epoch - 23ms/step
Epoch 10/50
401/401 - 9s - loss: 12.8494 - accuracy10: 0.4160 - accuracy20: 0.4156 - accuracy30: 0.4094 - accuracy50: 0.4000 - val_loss: 13.1799 - val_accuracy10: 0.3902 - val_accuracy20: 0.3893 - val_accuracy30: 0.3844 - val_accuracy50: 0.3691 - 9s/epoch - 22ms/step
Epoch 11/50
401/401 - 9s - loss: 12.8345 - accuracy10: 0.4161 - accuracy20: 0.4173 - accuracy30: 0.4123 - accuracy50: 0.4031 - val_loss: 13.2002 - val_accuracy10: 0.3884 - val_accuracy20: 0.3848 - val_accuracy30: 0.3795 - val_accuracy50: 0.3677 - 9s/epoch - 22ms/step
Epoch 12/50
401/401 - 9s - loss: 12.8210 - accuracy10: 0.4165 - accuracy20: 0.4174 - accuracy30: 0.4116 - accuracy50: 0.4022 - val_loss: 13.2433 - val_accuracy10: 0.3807 - val_accuracy20: 0.3800 - val_accuracy30: 0.3755 - val_accuracy50: 0.3635 - 9s/epoch - 23ms/step
Epoch 13/50
401/401 - 9s - loss: 12.7986 - accuracy10: 0.4208 - accuracy20: 0.4197 - accuracy30: 0.4137 - accuracy50: 0.4058 - val_loss: 13.2310 - val_accuracy10: 0.3837 - val_accuracy20: 0.3811 - val_accuracy30: 0.3760 - val_accuracy50: 0.3622 - 9s/epoch - 22ms/step
Epoch 14/50
401/401 - 9s - loss: 12.7825 - accuracy10: 0.4212 - accuracy20: 0.4192 - accuracy30: 0.4137 - accuracy50: 0.4068 - val_loss: 13.2519 - val_accuracy10: 0.3809 - val_accuracy20: 0.3797 - val_accuracy30: 0.3733 - val_accuracy50: 0.3643 - 9s/epoch - 22ms/step
Epoch 15/50
401/401 - 9s - loss: 12.7679 - accuracy10: 0.4226 - accuracy20: 0.4238 - accuracy30: 0.4178 - accuracy50: 0.4093 - val_loss: 13.2087 - val_accuracy10: 0.3857 - val_accuracy20: 0.3827 - val_accuracy30: 0.3769 - val_accuracy50: 0.3652 - 9s/epoch - 22ms/step
testing model: results/CHTR/W7/deepLOB_L1/seq2seq
Evaluating performance on  test set...
1065/1065 - 11s - 11s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0968374
{'0': {'precision': 0.3610633531311868, 'recall': 0.3143398194765728, 'f1-score': 0.3360854489464368, 'support': 88188}, '1': {'precision': 0.3514213224253094, 'recall': 0.49224472879863235, 'f1-score': 0.41008001519166526, 'support': 96515}, '2': {'precision': 0.3795959529162809, 'recall': 0.26165785395204666, 'f1-score': 0.3097814355099838, 'support': 87752}, 'accuracy': 0.36039345947037127, 'macro avg': {'precision': 0.3640268761575924, 'recall': 0.35608080074241727, 'f1-score': 0.3519822998826953, 'support': 272455}, 'weighted avg': {'precision': 0.3636166999325442, 'recall': 0.36039345947037127, 'f1-score': 0.353825463899668, 'support': 272455}}
[[27721 44410 16057]
 [27536 47509 21470]
 [21519 43272 22961]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0960299
{'0': {'precision': 0.3503947463724378, 'recall': 0.33396230756840095, 'f1-score': 0.3419812432254111, 'support': 86914}, '1': {'precision': 0.348864535254318, 'recall': 0.4689087080391428, 'f1-score': 0.40007574189627765, 'support': 96876}, '2': {'precision': 0.38105578561088105, 'recall': 0.25530931032538207, 'f1-score': 0.3057587238554477, 'support': 88665}, 'accuracy': 0.35634875484024886, 'macro avg': {'precision': 0.36010502241254566, 'recall': 0.3527267753109753, 'f1-score': 0.3492719029923788, 'support': 272455}, 'weighted avg': {'precision': 0.35982867238516497, 'recall': 0.35634875484024886, 'f1-score': 0.35084983794123964, 'support': 272455}}
[[29026 41976 15912]
 [30593 45426 20857]
 [23219 42809 22637]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0969104
{'0': {'precision': 0.34393635882203955, 'recall': 0.34626841452530804, 'f1-score': 0.3450984469125963, 'support': 86277}, '1': {'precision': 0.3461197760131608, 'recall': 0.4543161173111861, 'f1-score': 0.39290540085562553, 'support': 96325}, '2': {'precision': 0.378805551329513, 'recall': 0.2493962360744772, 'f1-score': 0.30077176028454466, 'support': 89853}, 'accuracy': 0.35252059973206584, 'macro avg': {'precision': 0.3562872287215711, 'recall': 0.34999358930365715, 'f1-score': 0.3462585360175889, 'support': 272455}, 'weighted avg': {'precision': 0.3562078136138722, 'recall': 0.35252059973206584, 'f1-score': 0.3473818297280043, 'support': 272455}}
[[29875 40219 16183]
 [31998 43762 20565]
 [24989 42455 22409]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0983604
{'0': {'precision': 0.3373714260075602, 'recall': 0.35209074733096085, 'f1-score': 0.3445739653444078, 'support': 85424}, '1': {'precision': 0.3435740724096514, 'recall': 0.4413898073794153, 'f1-score': 0.38638744417694304, 'support': 95265}, '2': {'precision': 0.37659438252047867, 'recall': 0.2499945513588911, 'f1-score': 0.30050496780912084, 'support': 91766}, 'accuracy': 0.3489273458002239, 'macro avg': {'precision': 0.3525132936458968, 'recall': 0.34782503535642245, 'f1-score': 0.3438221257768239, 'support': 272455}, 'weighted avg': {'precision': 0.35275095267016393, 'recall': 0.3489273458002239, 'f1-score': 0.3443512696080782, 'support': 272455}}
[[30077 38184 17163]
 [32403 42049 20813]
 [26671 42154 22941]]
Evaluating performance on  train set...
401/401 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0889248
{'0': {'precision': 0.39713305562362167, 'recall': 0.4581225089747576, 'f1-score': 0.42545316130048433, 'support': 35377}, '1': {'precision': 0.3730973824195502, 'recall': 0.20896755162241887, 'f1-score': 0.26789192050976607, 'support': 33900}, '2': {'precision': 0.3889109373176141, 'recall': 0.4994453605156648, 'f1-score': 0.43730148313426964, 'support': 33355}, 'accuracy': 0.3892548133135864, 'macro avg': {'precision': 0.3863804584535953, 'recall': 0.38884514037094703, 'f1-score': 0.37688218831484005, 'support': 102632}, 'weighted avg': {'precision': 0.3865217640409291, 'recall': 0.3892548133135864, 'f1-score': 0.37726034338755815, 'support': 102632}}
[[16207  6187 12983]
 [13623  7084 13193]
 [10980  5716 16659]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0879154
{'0': {'precision': 0.3979133810505884, 'recall': 0.4617897167314299, 'f1-score': 0.4274785283269689, 'support': 35514}, '1': {'precision': 0.38085786746058, 'recall': 0.20357163906406553, 'f1-score': 0.26532493470579194, 'support': 33934}, '2': {'precision': 0.3824025508907322, 'recall': 0.49873432979749277, 'f1-score': 0.43288910976550754, 'support': 33184}, 'accuracy': 0.3883584067347416, 'macro avg': {'precision': 0.3870579331339669, 'recall': 0.38803189519766274, 'f1-score': 0.37523085759942276, 'support': 102632}, 'weighted avg': {'precision': 0.38725907063874787, 'recall': 0.3883584067347416, 'f1-score': 0.37561385345475995, 'support': 102632}}
[[16400  5797 13317]
 [13614  6908 13412]
 [11201  5433 16550]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0894196
{'0': {'precision': 0.3939873803201208, 'recall': 0.4565137614678899, 'f1-score': 0.42295219165184644, 'support': 35425}, '1': {'precision': 0.37990736656374063, 'recall': 0.20198170731707318, 'f1-score': 0.26374215280967694, 'support': 34112}, '2': {'precision': 0.3766484844300214, 'recall': 0.49448557183864633, 'f1-score': 0.4275971989966555, 'support': 33095}, 'accuracy': 0.3841589367838491, 'macro avg': {'precision': 0.38351441043796103, 'recall': 0.38432701354120313, 'f1-score': 0.3714305144860597, 'support': 102632}, 'weighted avg': {'precision': 0.3837164298491129, 'recall': 0.3841589367838491, 'f1-score': 0.3715330794167967, 'support': 102632}}
[[16172  5805 13448]
 [13586  6890 13636]
 [11289  5441 16365]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0920306
{'0': {'precision': 0.39038868909798513, 'recall': 0.44589804186360565, 'f1-score': 0.41630112158861077, 'support': 35544}, '1': {'precision': 0.3784079112713763, 'recall': 0.2036879098903038, 'f1-score': 0.2648262149657783, 'support': 34003}, '2': {'precision': 0.36982918295945666, 'recall': 0.4888317968868067, 'f1-score': 0.42108414913559666, 'support': 33085}, 'accuracy': 0.37949177644399407, 'macro avg': {'precision': 0.37954192777627266, 'recall': 0.3794725828802387, 'f1-score': 0.36740382856332854, 'support': 102632}, 'weighted avg': {'precision': 0.3797916662490551, 'recall': 0.37949177644399407, 'f1-score': 0.36765786428577985, 'support': 102632}}
[[15849  5873 13822]
 [13341  6926 13736]
 [11408  5504 16173]]
Evaluating performance on  val set...
123/123 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0906054
{'0': {'precision': 0.3740392213203074, 'recall': 0.5186771590795896, 'f1-score': 0.43464106844741235, 'support': 10039}, '1': {'precision': 0.40087118855009335, 'recall': 0.2984065221419307, 'f1-score': 0.3421318179404111, 'support': 10794}, '2': {'precision': 0.41421750663129975, 'recall': 0.3701175578308684, 'f1-score': 0.3909277524658289, 'support': 10548}, 'accuracy': 0.3929766419170836, 'macro avg': {'precision': 0.39637597216723347, 'recall': 0.3957337463507962, 'f1-score': 0.3892335462845507, 'support': 31381}, 'weighted avg': {'precision': 0.3967735130171513, 'recall': 0.3929766419170836, 'f1-score': 0.38812779905044237, 'support': 31381}}
[[5207 2348 2484]
 [4536 3221 3037]
 [4178 2466 3904]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0910741
{'0': {'precision': 0.3752386339531924, 'recall': 0.5237343333662291, 'f1-score': 0.43722194760257044, 'support': 10133}, '1': {'precision': 0.38647214854111406, 'recall': 0.2770488686061989, 'f1-score': 0.3227378447225606, 'support': 10518}, '2': {'precision': 0.40513507939781396, 'recall': 0.36616961789375585, 'f1-score': 0.3846681026042687, 'support': 10730}, 'accuracy': 0.3871769542079602, 'macro avg': {'precision': 0.38894862063070684, 'recall': 0.3889842732887279, 'f1-score': 0.38154263164313323, 'support': 31381}, 'weighted avg': {'precision': 0.3892261731028865, 'recall': 0.38717695420796017, 'f1-score': 0.38088064073141525, 'support': 31381}}
[[5307 2224 2602]
 [4437 2914 3167]
 [4399 2402 3929]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0926293
{'0': {'precision': 0.3703600529284769, 'recall': 0.5252864480442513, 'f1-score': 0.43442388596168774, 'support': 10124}, '1': {'precision': 0.3810188415910677, 'recall': 0.26049618320610685, 'f1-score': 0.30943610087843576, 'support': 10480}, '2': {'precision': 0.3973825707618951, 'recall': 0.3634592187065046, 'f1-score': 0.37966463119123783, 'support': 10777}, 'accuracy': 0.3812816672508843, 'macro avg': {'precision': 0.3829204884271465, 'recall': 0.3830806166522876, 'f1-score': 0.3745082060104538, 'support': 31381}, 'weighted avg': {'precision': 0.38319985344072, 'recall': 0.3812816672508843, 'f1-score': 0.37387729801568154, 'support': 31381}}
[[5318 2112 2694]
 [4504 2730 3246]
 [4537 2323 3917]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0962116
{'0': {'precision': 0.3581574955178596, 'recall': 0.5217478653942742, 'f1-score': 0.4247454716441101, 'support': 9955}, '1': {'precision': 0.38105857865001486, 'recall': 0.24061209162598574, 'f1-score': 0.2949706525492001, 'support': 10652}, '2': {'precision': 0.385797301290259, 'recall': 0.3635604232411361, 'f1-score': 0.37434892722320445, 'support': 10774}, 'accuracy': 0.37200854019948376, 'macro avg': {'precision': 0.3750044584860445, 'recall': 0.3753067934204653, 'f1-score': 0.3646883504721716, 'support': 31381}, 'weighted avg': {'precision': 0.37542060392471566, 'recall': 0.37200854019948376, 'f1-score': 0.36339198569433734, 'support': 31381}}
[[5194 1976 2785]
 [4638 2563 3451]
 [4670 2187 3917]]
training model: results/CHTR/W7/deepOF_L1/seq2seq
Epoch 1/50
401/401 - 14s - loss: 13.1000 - accuracy10: 0.3866 - accuracy20: 0.3862 - accuracy30: 0.3855 - accuracy50: 0.3825 - val_loss: 13.2559 - val_accuracy10: 0.3755 - val_accuracy20: 0.3815 - val_accuracy30: 0.3773 - val_accuracy50: 0.3688 - 14s/epoch - 35ms/step
Epoch 2/50
401/401 - 8s - loss: 13.0106 - accuracy10: 0.3980 - accuracy20: 0.3966 - accuracy30: 0.3968 - accuracy50: 0.3918 - val_loss: 13.1959 - val_accuracy10: 0.3820 - val_accuracy20: 0.3848 - val_accuracy30: 0.3851 - val_accuracy50: 0.3739 - 8s/epoch - 21ms/step
Epoch 3/50
401/401 - 9s - loss: 12.9689 - accuracy10: 0.4046 - accuracy20: 0.4035 - accuracy30: 0.4024 - accuracy50: 0.3972 - val_loss: 13.1408 - val_accuracy10: 0.3850 - val_accuracy20: 0.3880 - val_accuracy30: 0.3863 - val_accuracy50: 0.3764 - 9s/epoch - 21ms/step
Epoch 4/50
401/401 - 9s - loss: 12.9387 - accuracy10: 0.4083 - accuracy20: 0.4057 - accuracy30: 0.4037 - accuracy50: 0.3990 - val_loss: 13.1085 - val_accuracy10: 0.3880 - val_accuracy20: 0.3915 - val_accuracy30: 0.3916 - val_accuracy50: 0.3820 - 9s/epoch - 22ms/step
Epoch 5/50
401/401 - 9s - loss: 12.9112 - accuracy10: 0.4133 - accuracy20: 0.4101 - accuracy30: 0.4080 - accuracy50: 0.4020 - val_loss: 13.0831 - val_accuracy10: 0.3928 - val_accuracy20: 0.3925 - val_accuracy30: 0.3906 - val_accuracy50: 0.3807 - 9s/epoch - 22ms/step
Epoch 6/50
401/401 - 8s - loss: 12.8939 - accuracy10: 0.4138 - accuracy20: 0.4134 - accuracy30: 0.4101 - accuracy50: 0.4048 - val_loss: 13.0644 - val_accuracy10: 0.3936 - val_accuracy20: 0.3941 - val_accuracy30: 0.3929 - val_accuracy50: 0.3835 - 8s/epoch - 20ms/step
Epoch 7/50
401/401 - 9s - loss: 12.8807 - accuracy10: 0.4150 - accuracy20: 0.4133 - accuracy30: 0.4105 - accuracy50: 0.4050 - val_loss: 13.0629 - val_accuracy10: 0.3950 - val_accuracy20: 0.3962 - val_accuracy30: 0.3944 - val_accuracy50: 0.3859 - 9s/epoch - 22ms/step
Epoch 8/50
401/401 - 9s - loss: 12.8674 - accuracy10: 0.4171 - accuracy20: 0.4161 - accuracy30: 0.4122 - accuracy50: 0.4057 - val_loss: 13.0612 - val_accuracy10: 0.3956 - val_accuracy20: 0.3957 - val_accuracy30: 0.3940 - val_accuracy50: 0.3848 - 9s/epoch - 21ms/step
Epoch 9/50
401/401 - 8s - loss: 12.8590 - accuracy10: 0.4164 - accuracy20: 0.4162 - accuracy30: 0.4124 - accuracy50: 0.4066 - val_loss: 13.0568 - val_accuracy10: 0.3971 - val_accuracy20: 0.3963 - val_accuracy30: 0.3941 - val_accuracy50: 0.3854 - 8s/epoch - 21ms/step
Epoch 10/50
401/401 - 8s - loss: 12.8375 - accuracy10: 0.4204 - accuracy20: 0.4185 - accuracy30: 0.4131 - accuracy50: 0.4071 - val_loss: 13.0449 - val_accuracy10: 0.3973 - val_accuracy20: 0.3943 - val_accuracy30: 0.3927 - val_accuracy50: 0.3850 - 8s/epoch - 21ms/step
Epoch 11/50
401/401 - 8s - loss: 12.8272 - accuracy10: 0.4207 - accuracy20: 0.4189 - accuracy30: 0.4167 - accuracy50: 0.4098 - val_loss: 13.0381 - val_accuracy10: 0.4012 - val_accuracy20: 0.3983 - val_accuracy30: 0.3960 - val_accuracy50: 0.3885 - 8s/epoch - 21ms/step
Epoch 12/50
401/401 - 8s - loss: 12.8135 - accuracy10: 0.4224 - accuracy20: 0.4211 - accuracy30: 0.4179 - accuracy50: 0.4115 - val_loss: 13.0418 - val_accuracy10: 0.3998 - val_accuracy20: 0.3970 - val_accuracy30: 0.3972 - val_accuracy50: 0.3875 - 8s/epoch - 21ms/step
Epoch 13/50
401/401 - 9s - loss: 12.8012 - accuracy10: 0.4230 - accuracy20: 0.4235 - accuracy30: 0.4183 - accuracy50: 0.4107 - val_loss: 13.0450 - val_accuracy10: 0.4001 - val_accuracy20: 0.3949 - val_accuracy30: 0.3954 - val_accuracy50: 0.3876 - 9s/epoch - 22ms/step
Epoch 14/50
401/401 - 8s - loss: 12.7843 - accuracy10: 0.4250 - accuracy20: 0.4247 - accuracy30: 0.4207 - accuracy50: 0.4132 - val_loss: 13.0492 - val_accuracy10: 0.4011 - val_accuracy20: 0.3967 - val_accuracy30: 0.3955 - val_accuracy50: 0.3859 - 8s/epoch - 21ms/step
Epoch 15/50
401/401 - 9s - loss: 12.7790 - accuracy10: 0.4236 - accuracy20: 0.4237 - accuracy30: 0.4200 - accuracy50: 0.4121 - val_loss: 13.0378 - val_accuracy10: 0.4005 - val_accuracy20: 0.3972 - val_accuracy30: 0.3965 - val_accuracy50: 0.3863 - 9s/epoch - 21ms/step
Epoch 16/50
401/401 - 9s - loss: 12.7677 - accuracy10: 0.4261 - accuracy20: 0.4264 - accuracy30: 0.4222 - accuracy50: 0.4138 - val_loss: 13.0493 - val_accuracy10: 0.3993 - val_accuracy20: 0.3934 - val_accuracy30: 0.3930 - val_accuracy50: 0.3826 - 9s/epoch - 22ms/step
Epoch 17/50
401/401 - 9s - loss: 12.7513 - accuracy10: 0.4292 - accuracy20: 0.4282 - accuracy30: 0.4226 - accuracy50: 0.4147 - val_loss: 13.0577 - val_accuracy10: 0.4015 - val_accuracy20: 0.3975 - val_accuracy30: 0.3958 - val_accuracy50: 0.3858 - 9s/epoch - 22ms/step
Epoch 18/50
401/401 - 8s - loss: 12.7329 - accuracy10: 0.4304 - accuracy20: 0.4293 - accuracy30: 0.4237 - accuracy50: 0.4171 - val_loss: 13.0705 - val_accuracy10: 0.3990 - val_accuracy20: 0.3961 - val_accuracy30: 0.3932 - val_accuracy50: 0.3857 - 8s/epoch - 21ms/step
Epoch 19/50
401/401 - 9s - loss: 12.7321 - accuracy10: 0.4308 - accuracy20: 0.4306 - accuracy30: 0.4255 - accuracy50: 0.4179 - val_loss: 13.0841 - val_accuracy10: 0.4010 - val_accuracy20: 0.3970 - val_accuracy30: 0.3933 - val_accuracy50: 0.3829 - 9s/epoch - 22ms/step
Epoch 20/50
401/401 - 9s - loss: 12.7069 - accuracy10: 0.4328 - accuracy20: 0.4331 - accuracy30: 0.4280 - accuracy50: 0.4194 - val_loss: 13.0708 - val_accuracy10: 0.3989 - val_accuracy20: 0.3957 - val_accuracy30: 0.3917 - val_accuracy50: 0.3824 - 9s/epoch - 22ms/step
Epoch 21/50
401/401 - 8s - loss: 12.6920 - accuracy10: 0.4343 - accuracy20: 0.4345 - accuracy30: 0.4295 - accuracy50: 0.4206 - val_loss: 13.0845 - val_accuracy10: 0.4005 - val_accuracy20: 0.3950 - val_accuracy30: 0.3950 - val_accuracy50: 0.3840 - 8s/epoch - 21ms/step
Epoch 22/50
401/401 - 8s - loss: 12.6814 - accuracy10: 0.4352 - accuracy20: 0.4356 - accuracy30: 0.4303 - accuracy50: 0.4225 - val_loss: 13.0917 - val_accuracy10: 0.3987 - val_accuracy20: 0.3930 - val_accuracy30: 0.3898 - val_accuracy50: 0.3811 - 8s/epoch - 21ms/step
Epoch 23/50
401/401 - 8s - loss: 12.6738 - accuracy10: 0.4355 - accuracy20: 0.4377 - accuracy30: 0.4315 - accuracy50: 0.4229 - val_loss: 13.0954 - val_accuracy10: 0.3972 - val_accuracy20: 0.3920 - val_accuracy30: 0.3897 - val_accuracy50: 0.3816 - 8s/epoch - 20ms/step
Epoch 24/50
401/401 - 8s - loss: 12.6609 - accuracy10: 0.4368 - accuracy20: 0.4375 - accuracy30: 0.4335 - accuracy50: 0.4243 - val_loss: 13.1057 - val_accuracy10: 0.3952 - val_accuracy20: 0.3889 - val_accuracy30: 0.3894 - val_accuracy50: 0.3790 - 8s/epoch - 20ms/step
Epoch 25/50
401/401 - 9s - loss: 12.6415 - accuracy10: 0.4387 - accuracy20: 0.4402 - accuracy30: 0.4351 - accuracy50: 0.4253 - val_loss: 13.1080 - val_accuracy10: 0.3965 - val_accuracy20: 0.3910 - val_accuracy30: 0.3884 - val_accuracy50: 0.3804 - 9s/epoch - 22ms/step
testing model: results/CHTR/W7/deepOF_L1/seq2seq
Evaluating performance on  test set...
1065/1065 - 11s - 11s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0805733
{'0': {'precision': 0.3984375, 'recall': 0.5736965051141905, 'f1-score': 0.470268913655757, 'support': 88186}, '1': {'precision': 0.43305132242653926, 'recall': 0.16812242910281516, 'f1-score': 0.24221164036960183, 'support': 96513}, '2': {'precision': 0.40300911994815053, 'recall': 0.49602853528734714, 'f1-score': 0.4447066756574511, 'support': 87751}, 'accuracy': 0.40501009359515505, 'macro avg': {'precision': 0.4114993141248966, 'recall': 0.41261582316811757, 'f1-score': 0.38572907656093663, 'support': 272450}, 'weighted avg': {'precision': 0.412171572548808, 'recall': 0.40501009359515505, 'f1-score': 0.3812485298669663, 'support': 272450}}
[[50592 11299 26295]
 [42104 16226 38183]
 [34280  9944 43527]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0796782
{'0': {'precision': 0.39082277266481935, 'recall': 0.5858339469808542, 'f1-score': 0.468859206873213, 'support': 86912}, '1': {'precision': 0.4372190590350614, 'recall': 0.13554720564857445, 'f1-score': 0.20693893953840214, 'support': 96874}, '2': {'precision': 0.4068736735094259, 'recall': 0.5145944238924479, 'f1-score': 0.454437704803737, 'support': 88664}, 'accuracy': 0.40254358597907874, 'macro avg': {'precision': 0.4116385017364355, 'recall': 0.41199185884062556, 'f1-score': 0.3767452837384508, 'support': 272450}, 'weighted avg': {'precision': 0.41254320180160414, 'recall': 0.40254358597907874, 'f1-score': 0.3710360024787168, 'support': 272450}}
[[50916  9084 26912]
 [44143 13131 39600]
 [35220  7818 45626]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0810348
{'0': {'precision': 0.3841170514840782, 'recall': 0.5848507678933642, 'f1-score': 0.4636916686577588, 'support': 86275}, '1': {'precision': 0.4471547785371748, 'recall': 0.12293924670902372, 'f1-score': 0.19285545612220806, 'support': 96324}, '2': {'precision': 0.40835558347730483, 'recall': 0.5208623165017641, 'f1-score': 0.45779797218975143, 'support': 89851}, 'accuracy': 0.40044044778858506, 'macro avg': {'precision': 0.41320913783285257, 'recall': 0.4095507770347173, 'f1-score': 0.37144836565657274, 'support': 272450}, 'weighted avg': {'precision': 0.41439747856716086, 'recall': 0.40044044778858506, 'f1-score': 0.3659945431021658, 'support': 272450}}
[[50458  8026 27791]
 [44467 11842 40015]
 [36436  6615 46800]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0851485
{'0': {'precision': 0.37354586897193126, 'recall': 0.5736344267284774, 'f1-score': 0.45245614035087717, 'support': 85422}, '1': {'precision': 0.42654663857498565, 'recall': 0.11688570708767215, 'f1-score': 0.18349001804414639, 'support': 95264}, '2': {'precision': 0.41050821850009117, 'recall': 0.5152020400156925, 'f1-score': 0.45693492033576405, 'support': 91764}, 'accuracy': 0.39424848596072676, 'macro avg': {'precision': 0.40353357534900275, 'recall': 0.40190739127728065, 'f1-score': 0.36429369291026253, 'support': 272450}, 'weighted avg': {'precision': 0.4045272540244819, 'recall': 0.39424848596072676, 'f1-score': 0.35991880172399066, 'support': 272450}}
[[49001  8130 28291]
 [44530 11135 39599]
 [37647  6840 47277]]
Evaluating performance on  train set...
401/401 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0669824
{'0': {'precision': 0.41877477021671305, 'recall': 0.5588061548848069, 'f1-score': 0.47876122190757364, 'support': 35549}, '1': {'precision': 0.44053361920076234, 'recall': 0.21944996588245766, 'f1-score': 0.2929620975088123, 'support': 33707}, '2': {'precision': 0.42103892722301783, 'recall': 0.48447986577181207, 'f1-score': 0.45053705019434115, 'support': 33376}, 'accuracy': 0.4231818536129083, 'macro avg': {'precision': 0.4267824388801644, 'recall': 0.42091199551302555, 'f1-score': 0.4074201232035757, 'support': 102632}, 'weighted avg': {'precision': 0.4266572437819537, 'recall': 0.4231818536129083, 'f1-score': 0.4085614689922071, 'support': 102632}}
[[19865  5113 10571]
 [14646  7397 11664]
 [12925  4281 16170]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0669173
{'0': {'precision': 0.41802561127058774, 'recall': 0.5766076944678461, 'f1-score': 0.48467466864945885, 'support': 35610}, '1': {'precision': 0.4657514345899615, 'recall': 0.19044790305334441, 'f1-score': 0.27034889849267413, 'support': 33668}, '2': {'precision': 0.41614250490615406, 'recall': 0.49589254662109494, 'f1-score': 0.45253077975376194, 'support': 33354}, 'accuracy': 0.423698261750721, 'macro avg': {'precision': 0.4333065169222344, 'recall': 0.42098271471409515, 'f1-score': 0.402518115631965, 'support': 102632}, 'weighted avg': {'precision': 0.43306988488736764, 'recall': 0.423698261750721, 'f1-score': 0.40391966728667045, 'support': 102632}}
[[20533  3991 11086]
 [15136  6412 12120]
 [13450  3364 16540]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0681838
{'0': {'precision': 0.414773980154355, 'recall': 0.5817961984028793, 'f1-score': 0.4842888740652319, 'support': 35564}, '1': {'precision': 0.479911627526389, 'recall': 0.17316720304703417, 'f1-score': 0.25450206118463875, 'support': 33869}, '2': {'precision': 0.41180970241326553, 'recall': 0.5026958643332631, 'f1-score': 0.4527365208545269, 'support': 33199}, 'accuracy': 0.4213598098059085, 'macro avg': {'precision': 0.4354984366980032, 'recall': 0.41921975526105887, 'f1-score': 0.39717581870146584, 'support': 102632}, 'weighted avg': {'precision': 0.4353108100136288, 'recall': 0.4213598098059085, 'f1-score': 0.3982518082407814, 'support': 102632}}
[[20691  3535 11338]
 [15505  5865 12499]
 [13689  2821 16689]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0735133
{'0': {'precision': 0.409113620465674, 'recall': 0.5750969264482778, 'f1-score': 0.47810905183991403, 'support': 35594}, '1': {'precision': 0.4689655172413793, 'recall': 0.16266981689308918, 'f1-score': 0.2415524613529218, 'support': 33860}, '2': {'precision': 0.40103299716048174, 'recall': 0.49379106636928083, 'f1-score': 0.4426043495880048, 'support': 33178}, 'accuracy': 0.4127465118091823, 'macro avg': {'precision': 0.4263707116225117, 'recall': 0.4105192699035493, 'f1-score': 0.3874219542602802, 'support': 102632}, 'weighted avg': {'precision': 0.42624751929650373, 'recall': 0.4127465118091823, 'f1-score': 0.3885874487804063, 'support': 102632}}
[[20470  3422 11702]
 [15585  5508 12767]
 [13980  2815 16383]]
Evaluating performance on  val set...
123/123 - 1s - 909ms/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0804715
{'0': {'precision': 0.3913462965711741, 'recall': 0.5213049925852694, 'f1-score': 0.4470727881639747, 'support': 10115}, '1': {'precision': 0.4188661923341749, 'recall': 0.17067240250631255, 'f1-score': 0.24252491694352163, 'support': 10693}, '2': {'precision': 0.4099630996309963, 'recall': 0.5253948737349854, 'f1-score': 0.4605563155494756, 'support': 10573}, 'accuracy': 0.40320576144800996, 'macro avg': {'precision': 0.4067251961787817, 'recall': 0.40579075627552247, 'f1-score': 0.38338467355232403, 'support': 31381}, 'weighted avg': {'precision': 0.40699607523167786, 'recall': 0.40320576144800996, 'f1-score': 0.3819165136056941, 'support': 31381}}
[[5273 1290 3552]
 [4425 1825 4443]
 [3776 1242 5555]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0825248
{'0': {'precision': 0.39178893905191875, 'recall': 0.54590131708276, 'f1-score': 0.4561806981519507, 'support': 10174}, '1': {'precision': 0.4028178033941723, 'recall': 0.11983234901886074, 'f1-score': 0.184714778650613, 'support': 10498}, '2': {'precision': 0.4070444539127965, 'recall': 0.5352507236903539, 'f1-score': 0.462425880359808, 'support': 10709}, 'accuracy': 0.3997323221057328, 'macro avg': {'precision': 0.4005503987862958, 'recall': 0.40032812993065825, 'f1-score': 0.36777378572079056, 'support': 31381}, 'weighted avg': {'precision': 0.4006845232114457, 'recall': 0.3997323221057328, 'f1-score': 0.36749743226937526, 'support': 31381}}
[[5554  957 3663]
 [4553 1258 4687]
 [4069  908 5732]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0837101
{'0': {'precision': 0.38988502600602243, 'recall': 0.5624444663836509, 'f1-score': 0.4605311022189887, 'support': 10129}, '1': {'precision': 0.3909871244635193, 'recall': 0.08681978461831698, 'f1-score': 0.14208843484364034, 'support': 10493}, '2': {'precision': 0.4056375095228201, 'recall': 0.5443814480899711, 'f1-score': 0.46487816493372486, 'support': 10759}, 'accuracy': 0.39721487524298144, 'macro avg': {'precision': 0.39550321999745397, 'recall': 0.397881899697313, 'f1-score': 0.35583256733211793, 'support': 31381}, 'weighted avg': {'precision': 0.39565429050593454, 'recall': 0.39721487524298144, 'f1-score': 0.3555424510918199, 'support': 31381}}
[[5697  734 3698]
 [4698  911 4884]
 [4217  685 5857]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0892173
{'0': {'precision': 0.377352127874823, 'recall': 0.5616905933139243, 'f1-score': 0.4514281103759884, 'support': 9961}, '1': {'precision': 0.3750579508576727, 'recall': 0.07602668922093789, 'f1-score': 0.12642600406313487, 'support': 10641}, '2': {'precision': 0.39924984371744116, 'recall': 0.5332591149457278, 'f1-score': 0.4566253574833174, 'support': 10779}, 'accuracy': 0.38724068703992864, 'macro avg': {'precision': 0.38388664081664564, 'recall': 0.39032546582686334, 'f1-score': 0.34482649064081355, 'support': 31381}, 'weighted avg': {'precision': 0.3840957989314523, 'recall': 0.38724068703992864, 'f1-score': 0.3430081656098823, 'support': 31381}}
[[5595  698 3668]
 [4851  809 4981]
 [4381  650 5748]]
training model: results/CHTR/W7/deepLOB_L2/seq2seq
Epoch 1/50
401/401 - 25s - loss: 13.2017 - accuracy10: 0.3599 - accuracy20: 0.3621 - accuracy30: 0.3616 - accuracy50: 0.3593 - val_loss: 13.3127 - val_accuracy10: 0.3604 - val_accuracy20: 0.3598 - val_accuracy30: 0.3579 - val_accuracy50: 0.3559 - 25s/epoch - 62ms/step
Epoch 2/50
401/401 - 20s - loss: 13.0898 - accuracy10: 0.3809 - accuracy20: 0.3850 - accuracy30: 0.3836 - accuracy50: 0.3828 - val_loss: 13.2349 - val_accuracy10: 0.3625 - val_accuracy20: 0.3691 - val_accuracy30: 0.3664 - val_accuracy50: 0.3620 - 20s/epoch - 49ms/step
Epoch 3/50
401/401 - 20s - loss: 13.0205 - accuracy10: 0.3920 - accuracy20: 0.3961 - accuracy30: 0.3960 - accuracy50: 0.3946 - val_loss: 13.1743 - val_accuracy10: 0.3741 - val_accuracy20: 0.3768 - val_accuracy30: 0.3757 - val_accuracy50: 0.3701 - 20s/epoch - 49ms/step
Epoch 4/50
401/401 - 19s - loss: 12.9772 - accuracy10: 0.4001 - accuracy20: 0.4020 - accuracy30: 0.3997 - accuracy50: 0.3962 - val_loss: 13.1672 - val_accuracy10: 0.3817 - val_accuracy20: 0.3834 - val_accuracy30: 0.3799 - val_accuracy50: 0.3733 - 19s/epoch - 47ms/step
Epoch 5/50
401/401 - 19s - loss: 12.9306 - accuracy10: 0.4051 - accuracy20: 0.4066 - accuracy30: 0.4047 - accuracy50: 0.3986 - val_loss: 13.1513 - val_accuracy10: 0.3844 - val_accuracy20: 0.3836 - val_accuracy30: 0.3806 - val_accuracy50: 0.3751 - 19s/epoch - 47ms/step
Epoch 6/50
401/401 - 19s - loss: 12.8787 - accuracy10: 0.4105 - accuracy20: 0.4125 - accuracy30: 0.4095 - accuracy50: 0.4020 - val_loss: 13.1515 - val_accuracy10: 0.3892 - val_accuracy20: 0.3893 - val_accuracy30: 0.3842 - val_accuracy50: 0.3763 - 19s/epoch - 47ms/step
Epoch 7/50
401/401 - 19s - loss: 12.8465 - accuracy10: 0.4136 - accuracy20: 0.4165 - accuracy30: 0.4126 - accuracy50: 0.4059 - val_loss: 13.1406 - val_accuracy10: 0.3942 - val_accuracy20: 0.3917 - val_accuracy30: 0.3855 - val_accuracy50: 0.3767 - 19s/epoch - 48ms/step
Epoch 8/50
401/401 - 19s - loss: 12.7994 - accuracy10: 0.4174 - accuracy20: 0.4195 - accuracy30: 0.4164 - accuracy50: 0.4085 - val_loss: 13.1985 - val_accuracy10: 0.3854 - val_accuracy20: 0.3878 - val_accuracy30: 0.3833 - val_accuracy50: 0.3771 - 19s/epoch - 47ms/step
Epoch 9/50
401/401 - 19s - loss: 12.7679 - accuracy10: 0.4204 - accuracy20: 0.4216 - accuracy30: 0.4173 - accuracy50: 0.4101 - val_loss: 13.2010 - val_accuracy10: 0.3864 - val_accuracy20: 0.3852 - val_accuracy30: 0.3803 - val_accuracy50: 0.3742 - 19s/epoch - 48ms/step
Epoch 10/50
401/401 - 19s - loss: 12.7283 - accuracy10: 0.4242 - accuracy20: 0.4260 - accuracy30: 0.4237 - accuracy50: 0.4149 - val_loss: 13.1924 - val_accuracy10: 0.3872 - val_accuracy20: 0.3877 - val_accuracy30: 0.3817 - val_accuracy50: 0.3747 - 19s/epoch - 49ms/step
Epoch 11/50
401/401 - 19s - loss: 12.6980 - accuracy10: 0.4253 - accuracy20: 0.4280 - accuracy30: 0.4249 - accuracy50: 0.4164 - val_loss: 13.1497 - val_accuracy10: 0.3882 - val_accuracy20: 0.3883 - val_accuracy30: 0.3826 - val_accuracy50: 0.3738 - 19s/epoch - 47ms/step
Epoch 12/50
401/401 - 19s - loss: 12.6675 - accuracy10: 0.4287 - accuracy20: 0.4333 - accuracy30: 0.4312 - accuracy50: 0.4212 - val_loss: 13.1497 - val_accuracy10: 0.3868 - val_accuracy20: 0.3879 - val_accuracy30: 0.3842 - val_accuracy50: 0.3760 - 19s/epoch - 47ms/step
Epoch 13/50
401/401 - 19s - loss: 12.6356 - accuracy10: 0.4335 - accuracy20: 0.4386 - accuracy30: 0.4331 - accuracy50: 0.4239 - val_loss: 13.1479 - val_accuracy10: 0.3868 - val_accuracy20: 0.3886 - val_accuracy30: 0.3827 - val_accuracy50: 0.3769 - 19s/epoch - 47ms/step
Epoch 14/50
401/401 - 19s - loss: 12.6143 - accuracy10: 0.4360 - accuracy20: 0.4405 - accuracy30: 0.4369 - accuracy50: 0.4272 - val_loss: 13.1378 - val_accuracy10: 0.3917 - val_accuracy20: 0.3882 - val_accuracy30: 0.3857 - val_accuracy50: 0.3792 - 19s/epoch - 47ms/step
Epoch 15/50
401/401 - 19s - loss: 12.5892 - accuracy10: 0.4378 - accuracy20: 0.4419 - accuracy30: 0.4399 - accuracy50: 0.4292 - val_loss: 13.2121 - val_accuracy10: 0.3877 - val_accuracy20: 0.3878 - val_accuracy30: 0.3837 - val_accuracy50: 0.3734 - 19s/epoch - 47ms/step
Epoch 16/50
401/401 - 19s - loss: 12.5612 - accuracy10: 0.4403 - accuracy20: 0.4451 - accuracy30: 0.4424 - accuracy50: 0.4332 - val_loss: 13.1684 - val_accuracy10: 0.3898 - val_accuracy20: 0.3887 - val_accuracy30: 0.3852 - val_accuracy50: 0.3759 - 19s/epoch - 47ms/step
Epoch 17/50
401/401 - 19s - loss: 12.5301 - accuracy10: 0.4436 - accuracy20: 0.4483 - accuracy30: 0.4462 - accuracy50: 0.4358 - val_loss: 13.2500 - val_accuracy10: 0.3827 - val_accuracy20: 0.3846 - val_accuracy30: 0.3812 - val_accuracy50: 0.3741 - 19s/epoch - 47ms/step
Epoch 18/50
401/401 - 19s - loss: 12.5103 - accuracy10: 0.4461 - accuracy20: 0.4510 - accuracy30: 0.4482 - accuracy50: 0.4378 - val_loss: 13.2311 - val_accuracy10: 0.3879 - val_accuracy20: 0.3866 - val_accuracy30: 0.3819 - val_accuracy50: 0.3752 - 19s/epoch - 47ms/step
Epoch 19/50
401/401 - 19s - loss: 12.4783 - accuracy10: 0.4478 - accuracy20: 0.4554 - accuracy30: 0.4524 - accuracy50: 0.4417 - val_loss: 13.2592 - val_accuracy10: 0.3870 - val_accuracy20: 0.3891 - val_accuracy30: 0.3834 - val_accuracy50: 0.3754 - 19s/epoch - 47ms/step
Epoch 20/50
401/401 - 19s - loss: 12.4513 - accuracy10: 0.4497 - accuracy20: 0.4569 - accuracy30: 0.4555 - accuracy50: 0.4455 - val_loss: 13.2738 - val_accuracy10: 0.3913 - val_accuracy20: 0.3889 - val_accuracy30: 0.3847 - val_accuracy50: 0.3749 - 19s/epoch - 47ms/step
Epoch 21/50
401/401 - 19s - loss: 12.4154 - accuracy10: 0.4549 - accuracy20: 0.4622 - accuracy30: 0.4596 - accuracy50: 0.4478 - val_loss: 13.4681 - val_accuracy10: 0.3780 - val_accuracy20: 0.3772 - val_accuracy30: 0.3730 - val_accuracy50: 0.3674 - 19s/epoch - 48ms/step
Epoch 22/50
401/401 - 19s - loss: 12.3943 - accuracy10: 0.4548 - accuracy20: 0.4654 - accuracy30: 0.4616 - accuracy50: 0.4503 - val_loss: 13.3720 - val_accuracy10: 0.3894 - val_accuracy20: 0.3869 - val_accuracy30: 0.3823 - val_accuracy50: 0.3744 - 19s/epoch - 46ms/step
Epoch 23/50
401/401 - 19s - loss: 12.3811 - accuracy10: 0.4580 - accuracy20: 0.4672 - accuracy30: 0.4659 - accuracy50: 0.4532 - val_loss: 13.3387 - val_accuracy10: 0.3912 - val_accuracy20: 0.3870 - val_accuracy30: 0.3846 - val_accuracy50: 0.3739 - 19s/epoch - 48ms/step
Epoch 24/50
401/401 - 19s - loss: 12.3506 - accuracy10: 0.4601 - accuracy20: 0.4712 - accuracy30: 0.4674 - accuracy50: 0.4558 - val_loss: 13.5282 - val_accuracy10: 0.3862 - val_accuracy20: 0.3851 - val_accuracy30: 0.3815 - val_accuracy50: 0.3734 - 19s/epoch - 48ms/step
testing model: results/CHTR/W7/deepLOB_L2/seq2seq
Evaluating performance on  test set...
1065/1065 - 19s - 19s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0914524
{'0': {'precision': 0.38304150783897806, 'recall': 0.554916768721368, 'f1-score': 0.4532315799710114, 'support': 88188}, '1': {'precision': 0.3852616726526424, 'recall': 0.12447806040511837, 'f1-score': 0.18816122287566855, 'support': 96515}, '2': {'precision': 0.3842589329762492, 'recall': 0.4970598960707448, 'f1-score': 0.43344065506002066, 'support': 87752}, 'accuracy': 0.3838028298251087, 'macro avg': {'precision': 0.3841873711559565, 'recall': 0.39215157506574366, 'f1-score': 0.35827781930223357, 'support': 272455}, 'weighted avg': {'precision': 0.38422009034851773, 'recall': 0.3838028298251087, 'f1-score': 0.35295829169277726, 'support': 272455}}
[[48937  9720 29531]
 [44138 12014 40363]
 [34684  9450 43618]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.091195
{'0': {'precision': 0.3778093905352435, 'recall': 0.5622454380191914, 'f1-score': 0.45193450385421047, 'support': 86914}, '1': {'precision': 0.38888498559685236, 'recall': 0.11426978818283166, 'f1-score': 0.1766367219288028, 'support': 96876}, '2': {'precision': 0.3908989410882194, 'recall': 0.5054418316133762, 'f1-score': 0.4408517001047656, 'support': 88665}, 'accuracy': 0.3844745003762089, 'macro avg': {'precision': 0.3858644390734384, 'recall': 0.39398568593846645, 'f1-score': 0.3564743086292596, 'support': 272455}, 'weighted avg': {'precision': 0.3860072373245042, 'recall': 0.3844745003762089, 'f1-score': 0.3504410289088054, 'support': 272455}}
[[48867  8620 29427]
 [45402 11070 40404]
 [35074  8776 44815]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0928559
{'0': {'precision': 0.3717743246695933, 'recall': 0.5565562084912549, 'f1-score': 0.44577507937392075, 'support': 86277}, '1': {'precision': 0.3757497106379994, 'recall': 0.11121723332468207, 'f1-score': 0.1716331827357493, 'support': 96325}, '2': {'precision': 0.39329180642069955, 'recall': 0.5024206203465661, 'f1-score': 0.44120837772065796, 'support': 89853}, 'accuracy': 0.3812556201941605, 'macro avg': {'precision': 0.3802719472427641, 'recall': 0.39006468738750105, 'f1-score': 0.35287221327677604, 'support': 272455}, 'weighted avg': {'precision': 0.3802760564828794, 'recall': 0.3812556201941605, 'f1-score': 0.34734763250261175, 'support': 272455}}
[[48018  8609 29650]
 [45621 10713 39991]
 [35520  9189 45144]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0961363
{'0': {'precision': 0.3593585822943621, 'recall': 0.5364885746394455, 'f1-score': 0.430412201696141, 'support': 85424}, '1': {'precision': 0.34892132799379927, 'recall': 0.11340996168582375, 'f1-score': 0.1711809489103138, 'support': 95265}, '2': {'precision': 0.3954423004361141, 'recall': 0.49108602314582744, 'f1-score': 0.4381048671297399, 'support': 91766}, 'accuracy': 0.3732653098676846, 'macro avg': {'precision': 0.3679074035747585, 'recall': 0.3803281864903656, 'f1-score': 0.34656600591206493, 'support': 272455}, 'weighted avg': {'precision': 0.36786256808303514, 'recall': 0.3732653098676846, 'f1-score': 0.3423619175741311, 'support': 272455}}
[[45829  9760 29835]
 [45400 10804 39061]
 [36301 10400 45065]]
Evaluating performance on  train set...
401/401 - 7s - 7s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0633197
{'0': {'precision': 0.42349930200093067, 'recall': 0.5145150804194816, 'f1-score': 0.4645915489362788, 'support': 35377}, '1': {'precision': 0.47244572643084864, 'recall': 0.18359882005899705, 'f1-score': 0.2644347198028636, 'support': 33900}, '2': {'precision': 0.40522397693532425, 'recall': 0.5646529755658822, 'f1-score': 0.4718349554695427, 'support': 33355}, 'accuracy': 0.4215059630524593, 'macro avg': {'precision': 0.43372300178903456, 'recall': 0.420922292014787, 'f1-score': 0.4002870747362284, 'support': 102632}, 'weighted avg': {'precision': 0.4337272067539406, 'recall': 0.4215059630524593, 'f1-score': 0.4008325587314132, 'support': 102632}}
[[18202  3650 13525]
 [13557  6224 14119]
 [11221  3300 18834]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0603795
{'0': {'precision': 0.42889566473325846, 'recall': 0.5267781719885116, 'f1-score': 0.47282423262103046, 'support': 35514}, '1': {'precision': 0.5096414073071719, 'recall': 0.17758000825131137, 'f1-score': 0.2633856374841558, 'support': 33934}, '2': {'precision': 0.4047341541460934, 'recall': 0.5755484570877532, 'f1-score': 0.4752591044256156, 'support': 33184}, 'accuracy': 0.4270890170706992, 'macro avg': {'precision': 0.44775707539550796, 'recall': 0.42663554577585866, 'f1-score': 0.4038229915102673, 'support': 102632}, 'weighted avg': {'precision': 0.4477811045685797, 'recall': 0.4270890170706992, 'f1-score': 0.40436322142168374, 'support': 102632}}
[[18708  3010 13796]
 [13614  6026 14294]
 [11297  2788 19099]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0625669
{'0': {'precision': 0.42565051515774566, 'recall': 0.5259562455892731, 'f1-score': 0.4705169322457638, 'support': 35425}, '1': {'precision': 0.5249822820694543, 'recall': 0.1737218574108818, 'f1-score': 0.26105726872246693, 'support': 34112}, '2': {'precision': 0.40169430955834434, 'recall': 0.5773983985496298, 'f1-score': 0.47378077504772764, 'support': 33095}, 'accuracy': 0.4254715878088705, 'macro avg': {'precision': 0.4507757022618481, 'recall': 0.4256921671832616, 'f1-score': 0.4017849920053194, 'support': 102632}, 'weighted avg': {'precision': 0.4509406255383289, 'recall': 0.4254715878088705, 'f1-score': 0.40195087911832095, 'support': 102632}}
[[18632  2803 13990]
 [13714  5926 14472]
 [11427  2559 19109]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0684158
{'0': {'precision': 0.4206153000961406, 'recall': 0.5169648885887913, 'f1-score': 0.46383945475198785, 'support': 35544}, '1': {'precision': 0.5080903271692745, 'recall': 0.16807340528776873, 'f1-score': 0.25259110295905063, 'support': 34003}, '2': {'precision': 0.3927418340391631, 'recall': 0.5662082514734774, 'f1-score': 0.4637856974858572, 'support': 33085}, 'accuracy': 0.41724803180294645, 'macro avg': {'precision': 0.44048248710152604, 'recall': 0.41708218178334583, 'f1-score': 0.39340541839896526, 'support': 102632}, 'weighted avg': {'precision': 0.44061120508749485, 'recall': 0.41724803180294645, 'f1-score': 0.3938334501416794, 'support': 102632}}
[[18375  2811 14358]
 [13681  5715 14607]
 [11630  2722 18733]]
Evaluating performance on  val set...
123/123 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0909029
{'0': {'precision': 0.3850344496074347, 'recall': 0.47873294152804063, 'f1-score': 0.42680165179166113, 'support': 10039}, '1': {'precision': 0.3951005025125628, 'recall': 0.17481934408004446, 'f1-score': 0.24238921001926783, 'support': 10794}, '2': {'precision': 0.39248035120016994, 'recall': 0.5255024649222602, 'f1-score': 0.44935349195411617, 'support': 10548}, 'accuracy': 0.38991746598260096, 'macro avg': {'precision': 0.3908717677733891, 'recall': 0.39301825017678177, 'f1-score': 0.37284811792168177, 'support': 31381}, 'weighted avg': {'precision': 0.39099959874411366, 'recall': 0.38991746598260096, 'f1-score': 0.37095030586713235, 'support': 31381}}
[[4806 1487 3746]
 [4073 1887 4834]
 [3603 1402 5543]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0912049
{'0': {'precision': 0.3886717191862784, 'recall': 0.48080528964768576, 'f1-score': 0.4298570672313393, 'support': 10133}, '1': {'precision': 0.3767441860465116, 'recall': 0.14632059326868227, 'f1-score': 0.21077860713552007, 'support': 10518}, '2': {'precision': 0.3915723866946684, 'recall': 0.5386766076421249, 'f1-score': 0.4534933898238594, 'support': 10730}, 'accuracy': 0.38848347726331217, 'macro avg': {'precision': 0.38566276397581944, 'recall': 0.3886008301861643, 'f1-score': 0.36470968806357296, 'support': 31381}, 'weighted avg': {'precision': 0.3856657719188541, 'recall': 0.38848347726331217, 'f1-score': 0.3645102171669664, 'support': 31381}}
[[4872 1298 3963]
 [3961 1539 5018]
 [3702 1248 5780]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0932937
{'0': {'precision': 0.38408276959808996, 'recall': 0.47668905570920583, 'f1-score': 0.4254043809775662, 'support': 10124}, '1': {'precision': 0.3727346497159859, 'recall': 0.1314885496183206, 'f1-score': 0.19439937927629258, 'support': 10480}, '2': {'precision': 0.38858390105165685, 'recall': 0.5451424329590795, 'f1-score': 0.4537380290392338, 'support': 10777}, 'accuracy': 0.38491443867308245, 'macro avg': {'precision': 0.3818004401219109, 'recall': 0.3844400127622019, 'f1-score': 0.3578472630976976, 'support': 31381}, 'weighted avg': {'precision': 0.3818387492453491, 'recall': 0.38491443867308245, 'f1-score': 0.35798840657685377, 'support': 31381}}
[[4826 1188 4110]
 [3968 1378 5134]
 [3771 1131 5875]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0990189
{'0': {'precision': 0.3747893765546016, 'recall': 0.46921145153189353, 'f1-score': 0.41671870818092605, 'support': 9955}, '1': {'precision': 0.3657858136300417, 'recall': 0.12345099511828765, 'f1-score': 0.18460026672281882, 'support': 10652}, '2': {'precision': 0.38138745676434116, 'recall': 0.5424169296454427, 'f1-score': 0.44786757098517066, 'support': 10774}, 'accuracy': 0.3769797010930181, 'macro avg': {'precision': 0.37398754898299486, 'recall': 0.3783597920985413, 'f1-score': 0.34972884862963854, 'support': 31381}, 'weighted avg': {'precision': 0.3739985083192784, 'recall': 0.3769797010930181, 'f1-score': 0.34862247827879334, 'support': 31381}}
[[4671 1124 4160]
 [4018 1315 5319]
 [3774 1156 5844]]
training model: results/CHTR/W7/deepOF_L2/seq2seq
Epoch 1/50
401/401 - 17s - loss: 13.1548 - accuracy10: 0.3794 - accuracy20: 0.3782 - accuracy30: 0.3769 - accuracy50: 0.3724 - val_loss: 13.2728 - val_accuracy10: 0.3711 - val_accuracy20: 0.3759 - val_accuracy30: 0.3743 - val_accuracy50: 0.3686 - 17s/epoch - 42ms/step
Epoch 2/50
401/401 - 12s - loss: 13.0219 - accuracy10: 0.3950 - accuracy20: 0.3939 - accuracy30: 0.3936 - accuracy50: 0.3895 - val_loss: 13.2081 - val_accuracy10: 0.3777 - val_accuracy20: 0.3801 - val_accuracy30: 0.3789 - val_accuracy50: 0.3712 - 12s/epoch - 29ms/step
Epoch 3/50
401/401 - 12s - loss: 12.9521 - accuracy10: 0.4064 - accuracy20: 0.4052 - accuracy30: 0.4034 - accuracy50: 0.3973 - val_loss: 13.1578 - val_accuracy10: 0.3812 - val_accuracy20: 0.3802 - val_accuracy30: 0.3797 - val_accuracy50: 0.3719 - 12s/epoch - 30ms/step
Epoch 4/50
401/401 - 12s - loss: 12.8958 - accuracy10: 0.4141 - accuracy20: 0.4120 - accuracy30: 0.4083 - accuracy50: 0.4022 - val_loss: 13.1298 - val_accuracy10: 0.3864 - val_accuracy20: 0.3828 - val_accuracy30: 0.3817 - val_accuracy50: 0.3733 - 12s/epoch - 29ms/step
Epoch 5/50
401/401 - 12s - loss: 12.8497 - accuracy10: 0.4182 - accuracy20: 0.4160 - accuracy30: 0.4122 - accuracy50: 0.4057 - val_loss: 13.1230 - val_accuracy10: 0.3902 - val_accuracy20: 0.3835 - val_accuracy30: 0.3826 - val_accuracy50: 0.3753 - 12s/epoch - 30ms/step
Epoch 6/50
401/401 - 12s - loss: 12.8131 - accuracy10: 0.4219 - accuracy20: 0.4214 - accuracy30: 0.4162 - accuracy50: 0.4087 - val_loss: 13.1117 - val_accuracy10: 0.3907 - val_accuracy20: 0.3875 - val_accuracy30: 0.3841 - val_accuracy50: 0.3764 - 12s/epoch - 29ms/step
Epoch 7/50
401/401 - 12s - loss: 12.7706 - accuracy10: 0.4253 - accuracy20: 0.4237 - accuracy30: 0.4197 - accuracy50: 0.4105 - val_loss: 13.1054 - val_accuracy10: 0.3965 - val_accuracy20: 0.3899 - val_accuracy30: 0.3856 - val_accuracy50: 0.3782 - 12s/epoch - 30ms/step
Epoch 8/50
401/401 - 12s - loss: 12.7346 - accuracy10: 0.4307 - accuracy20: 0.4281 - accuracy30: 0.4235 - accuracy50: 0.4147 - val_loss: 13.1281 - val_accuracy10: 0.3934 - val_accuracy20: 0.3885 - val_accuracy30: 0.3864 - val_accuracy50: 0.3764 - 12s/epoch - 30ms/step
Epoch 9/50
401/401 - 12s - loss: 12.7062 - accuracy10: 0.4330 - accuracy20: 0.4317 - accuracy30: 0.4278 - accuracy50: 0.4183 - val_loss: 13.1089 - val_accuracy10: 0.3971 - val_accuracy20: 0.3906 - val_accuracy30: 0.3878 - val_accuracy50: 0.3778 - 12s/epoch - 29ms/step
Epoch 10/50
401/401 - 12s - loss: 12.6756 - accuracy10: 0.4365 - accuracy20: 0.4335 - accuracy30: 0.4296 - accuracy50: 0.4197 - val_loss: 13.1225 - val_accuracy10: 0.3948 - val_accuracy20: 0.3885 - val_accuracy30: 0.3867 - val_accuracy50: 0.3791 - 12s/epoch - 30ms/step
Epoch 11/50
401/401 - 12s - loss: 12.6444 - accuracy10: 0.4388 - accuracy20: 0.4385 - accuracy30: 0.4348 - accuracy50: 0.4243 - val_loss: 13.1207 - val_accuracy10: 0.3945 - val_accuracy20: 0.3881 - val_accuracy30: 0.3878 - val_accuracy50: 0.3772 - 12s/epoch - 29ms/step
Epoch 12/50
401/401 - 12s - loss: 12.6114 - accuracy10: 0.4404 - accuracy20: 0.4404 - accuracy30: 0.4364 - accuracy50: 0.4249 - val_loss: 13.1255 - val_accuracy10: 0.3963 - val_accuracy20: 0.3879 - val_accuracy30: 0.3828 - val_accuracy50: 0.3746 - 12s/epoch - 30ms/step
Epoch 13/50
401/401 - 12s - loss: 12.5756 - accuracy10: 0.4466 - accuracy20: 0.4439 - accuracy30: 0.4414 - accuracy50: 0.4279 - val_loss: 13.1550 - val_accuracy10: 0.3939 - val_accuracy20: 0.3852 - val_accuracy30: 0.3835 - val_accuracy50: 0.3721 - 12s/epoch - 30ms/step
Epoch 14/50
401/401 - 12s - loss: 12.5483 - accuracy10: 0.4483 - accuracy20: 0.4492 - accuracy30: 0.4452 - accuracy50: 0.4322 - val_loss: 13.1499 - val_accuracy10: 0.3947 - val_accuracy20: 0.3892 - val_accuracy30: 0.3878 - val_accuracy50: 0.3778 - 12s/epoch - 29ms/step
Epoch 15/50
401/401 - 12s - loss: 12.5191 - accuracy10: 0.4520 - accuracy20: 0.4530 - accuracy30: 0.4490 - accuracy50: 0.4352 - val_loss: 13.1846 - val_accuracy10: 0.3948 - val_accuracy20: 0.3862 - val_accuracy30: 0.3836 - val_accuracy50: 0.3718 - 12s/epoch - 29ms/step
Epoch 16/50
401/401 - 12s - loss: 12.4843 - accuracy10: 0.4540 - accuracy20: 0.4567 - accuracy30: 0.4511 - accuracy50: 0.4373 - val_loss: 13.2330 - val_accuracy10: 0.3925 - val_accuracy20: 0.3831 - val_accuracy30: 0.3829 - val_accuracy50: 0.3709 - 12s/epoch - 30ms/step
Epoch 17/50
401/401 - 11s - loss: 12.4548 - accuracy10: 0.4534 - accuracy20: 0.4593 - accuracy30: 0.4548 - accuracy50: 0.4395 - val_loss: 13.2823 - val_accuracy10: 0.3869 - val_accuracy20: 0.3824 - val_accuracy30: 0.3792 - val_accuracy50: 0.3696 - 11s/epoch - 29ms/step
testing model: results/CHTR/W7/deepOF_L2/seq2seq
Evaluating performance on  test set...
1065/1065 - 11s - 11s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.080486
{'0': {'precision': 0.3825114309582874, 'recall': 0.680175991654004, 'f1-score': 0.48965497536704533, 'support': 88186}, '1': {'precision': 0.43547673801521314, 'recall': 0.10202770611212997, 'f1-score': 0.1653221406086044, 'support': 96513}, '2': {'precision': 0.41180517484171264, 'recall': 0.43656482547207437, 'f1-score': 0.4238236953611612, 'support': 87751}, 'accuracy': 0.39690952468342816, 'macro avg': {'precision': 0.40993111460507103, 'recall': 0.40625617441273615, 'f1-score': 0.3596002704456036, 'support': 272450}, 'weighted avg': {'precision': 0.41070888370007314, 'recall': 0.39690952468342816, 'f1-score': 0.3535599284489402, 'support': 272450}}
[[59982  6006 22198]
 [54146  9847 32520]
 [42683  6759 38309]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0832067
{'0': {'precision': 0.37505334700715326, 'recall': 0.6774668630338734, 'f1-score': 0.48281488952575413, 'support': 86912}, '1': {'precision': 0.4343117854001759, 'recall': 0.08155955158246794, 'f1-score': 0.13732988024264334, 'support': 96874}, '2': {'precision': 0.4072912704205949, 'recall': 0.44681043038888385, 'f1-score': 0.42613657754758494, 'support': 88664}, 'accuracy': 0.39051936135070653, 'macro avg': {'precision': 0.4055521342759747, 'recall': 0.40194561500174175, 'f1-score': 0.3487604491053275, 'support': 272450}, 'weighted avg': {'precision': 0.4066149003285519, 'recall': 0.39051936135070653, 'f1-score': 0.34152716464954025, 'support': 272450}}
[[58880  5005 23027]
 [54349  7901 34624]
 [43762  5286 39616]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0855582
{'0': {'precision': 0.3687941440862977, 'recall': 0.6657316719791365, 'f1-score': 0.47464826560337164, 'support': 86275}, '1': {'precision': 0.43125038554068224, 'recall': 0.07257796603131099, 'f1-score': 0.12424579019860486, 'support': 96324}, '2': {'precision': 0.40720803192071564, 'recall': 0.45546515898543144, 'f1-score': 0.429986866298923, 'support': 89851}, 'accuracy': 0.3866801247935401, 'macro avg': {'precision': 0.40241752051589846, 'recall': 0.39792493233195964, 'f1-score': 0.34296030736696653, 'support': 272450}, 'weighted avg': {'precision': 0.4035438641731482, 'recall': 0.3866801247935401, 'f1-score': 0.33603553141437265, 'support': 272450}}
[[57436  4716 24123]
 [53881  6991 35452]
 [44423  4504 40924]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0895431
{'0': {'precision': 0.36022946042978304, 'recall': 0.6483809791388635, 'f1-score': 0.4631439872226914, 'support': 85422}, '1': {'precision': 0.4172218417284104, 'recall': 0.07034136714813571, 'f1-score': 0.12038625645632159, 'support': 95264}, '2': {'precision': 0.4074748872239056, 'recall': 0.45575606991848655, 'f1-score': 0.4302652764131872, 'support': 91764}, 'accuracy': 0.38138741053404296, 'macro avg': {'precision': 0.3949753964606997, 'recall': 0.39149280540182857, 'f1-score': 0.3379318400307334, 'support': 272450}, 'weighted avg': {'precision': 0.3960699873388243, 'recall': 0.38138741053404296, 'f1-score': 0.3322225172926096, 'support': 272450}}
[[55386  4842 25194]
 [52942  6701 35621]
 [45424  4518 41822]]
Evaluating performance on  train set...
401/401 - 4s - 4s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0624664
{'0': {'precision': 0.41130555205841624, 'recall': 0.643309235140229, 'f1-score': 0.5017882611080635, 'support': 35549}, '1': {'precision': 0.4756925334800954, 'recall': 0.15385528228557865, 'f1-score': 0.23250913492792935, 'support': 33707}, '2': {'precision': 0.4346369952116029, 'recall': 0.47048777564717165, 'f1-score': 0.4518523847205237, 'support': 33376}, 'accuracy': 0.42635825083794526, 'macro avg': {'precision': 0.44054502691670483, 'recall': 0.42255076435765976, 'f1-score': 0.39538326025217224, 'support': 102632}, 'weighted avg': {'precision': 0.4400393020531674, 'recall': 0.42635825083794526, 'f1-score': 0.3971108572139144, 'support': 102632}}
[[22869  2983  9697]
 [17792  5186 10729]
 [14940  2733 15703]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0618076
{'0': {'precision': 0.4131594971166589, 'recall': 0.6478517270429655, 'f1-score': 0.5045490333304172, 'support': 35610}, '1': {'precision': 0.5193486995136393, 'recall': 0.14589521207080908, 'f1-score': 0.22779761628715853, 'support': 33668}, '2': {'precision': 0.4247643025498179, 'recall': 0.47547520537266896, 'f1-score': 0.4486914697977083, 'support': 33354}, 'accuracy': 0.4271669654688596, 'macro avg': {'precision': 0.45242416639337196, 'recall': 0.42307404816214783, 'f1-score': 0.39367937313842805, 'support': 102632}, 'weighted avg': {'precision': 0.45176582600744464, 'recall': 0.4271669654688596, 'f1-score': 0.3956089378135959, 'support': 102632}}
[[23070  2384 10156]
 [17435  4912 11321]
 [15333  2162 15859]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0636021
{'0': {'precision': 0.41033259503358366, 'recall': 0.6407322011022382, 'f1-score': 0.500279921402461, 'support': 35564}, '1': {'precision': 0.5380520951302378, 'recall': 0.14027576840178335, 'f1-score': 0.22253448558514252, 'support': 33869}, '2': {'precision': 0.4199743918053777, 'recall': 0.48411096719780716, 'f1-score': 0.44976772821402583, 'support': 33199}, 'accuracy': 0.42491620547197756, 'macro avg': {'precision': 0.456119693989733, 'recall': 0.4217063122339429, 'f1-score': 0.3908607117338765, 'support': 102632}, 'weighted avg': {'precision': 0.4555994685213883, 'recall': 0.42491620547197756, 'f1-score': 0.39228324914274065, 'support': 102632}}
[[22787  2252 10525]
 [17446  4751 11672]
 [15300  1827 16072]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.07013
{'0': {'precision': 0.4051940493943913, 'recall': 0.625948193515761, 'f1-score': 0.49194082578935744, 'support': 35594}, '1': {'precision': 0.531437125748503, 'recall': 0.1362965150620201, 'f1-score': 0.21695186160210606, 'support': 33860}, '2': {'precision': 0.406241979364509, 'recall': 0.4770631141117608, 'f1-score': 0.43881341835320203, 'support': 33178}, 'accuracy': 0.41627367682594124, 'macro avg': {'precision': 0.4476243848358011, 'recall': 0.4131026075631807, 'f1-score': 0.3825687019148885, 'support': 102632}, 'weighted avg': {'precision': 0.44718250120180797, 'recall': 0.41627367682594113, 'f1-score': 0.3840428266146643, 'support': 102632}}
[[22280  2248 11066]
 [17177  4615 12068]
 [15529  1821 15828]]
Evaluating performance on  val set...
123/123 - 1s - 1s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0841771
{'0': {'precision': 0.3729012563109076, 'recall': 0.6279782501235789, 'f1-score': 0.46793620391174634, 'support': 10115}, '1': {'precision': 0.44205168363351605, 'recall': 0.1055830917422613, 'f1-score': 0.17045368762738736, 'support': 10693}, '2': {'precision': 0.41660306961756977, 'recall': 0.4646741700558025, 'f1-score': 0.43932755074666907, 'support': 10573}, 'accuracy': 0.3949523597081036, 'macro avg': {'precision': 0.41051866985399776, 'recall': 0.39941183730721425, 'f1-score': 0.35923914742860097, 'support': 31381}, 'weighted avg': {'precision': 0.4111882704739997, 'recall': 0.3949523597081036, 'f1-score': 0.35693082369623336, 'support': 31381}}
[[6352  645 3118]
 [5802 1129 3762]
 [4880  780 4913]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0887803
{'0': {'precision': 0.3739547394889188, 'recall': 0.6285630037350108, 'f1-score': 0.4689275893675527, 'support': 10174}, '1': {'precision': 0.4181360201511335, 'recall': 0.07906267860544866, 'f1-score': 0.13298085396138748, 'support': 10498}, '2': {'precision': 0.4079707198047987, 'recall': 0.4683910729293118, 'f1-score': 0.43609806990088684, 'support': 10709}, 'accuracy': 0.39007679806252193, 'macro avg': {'precision': 0.40002049314828364, 'recall': 0.3920055850899238, 'f1-score': 0.34600217107660897, 'support': 31381}, 'weighted avg': {'precision': 0.400343070568065, 'recall': 0.39007679806252193, 'f1-score': 0.3453387887473543, 'support': 31381}}
[[6395  546 3233]
 [5622  830 4046]
 [5084  609 5016]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0888655
{'0': {'precision': 0.36983968524282107, 'recall': 0.6217790502517524, 'f1-score': 0.46380440385889976, 'support': 10129}, '1': {'precision': 0.413854351687389, 'recall': 0.06661583913084913, 'f1-score': 0.1147594812017731, 'support': 10493}, '2': {'precision': 0.40014214641080315, 'recall': 0.47095454967933825, 'f1-score': 0.4326701391853813, 'support': 10759}, 'accuracy': 0.38443644243331954, 'macro avg': {'precision': 0.39461206111367114, 'recall': 0.3864498130206466, 'f1-score': 0.3370780080820181, 'support': 31381}, 'weighted avg': {'precision': 0.3949462807850017, 'recall': 0.38443644243331954, 'f1-score': 0.3364183445534724, 'support': 31381}}
[[6298  479 3352]
 [5550  699 4244]
 [5181  511 5067]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0938921
{'0': {'precision': 0.36318378474485863, 'recall': 0.615199277181006, 'f1-score': 0.4567339941864798, 'support': 9961}, '1': {'precision': 0.39713216957605985, 'recall': 0.05986279485010807, 'f1-score': 0.10404246631278072, 'support': 10641}, '2': {'precision': 0.39290142591444516, 'recall': 0.47035903145004176, 'f1-score': 0.4281552168221932, 'support': 10779}, 'accuracy': 0.37713903317293906, 'macro avg': {'precision': 0.3844057934117879, 'recall': 0.3818070344937186, 'f1-score': 0.3296438924404846, 'support': 31381}, 'weighted avg': {'precision': 0.38490301667359844, 'recall': 0.37713903317293906, 'f1-score': 0.3273231663188632, 'support': 31381}}
[[6128  482 3351]
 [5521  637 4483]
 [5224  485 5070]]
training model: results/CHTR/W7/deepVOL_L2/seq2seq
Epoch 1/50
401/401 - 18s - loss: 13.1779 - accuracy10: 0.3651 - accuracy20: 0.3669 - accuracy30: 0.3650 - accuracy50: 0.3619 - val_loss: 13.2172 - val_accuracy10: 0.3495 - val_accuracy20: 0.3578 - val_accuracy30: 0.3589 - val_accuracy50: 0.3599 - 18s/epoch - 45ms/step
Epoch 2/50
401/401 - 12s - loss: 13.1065 - accuracy10: 0.3709 - accuracy20: 0.3739 - accuracy30: 0.3707 - accuracy50: 0.3678 - val_loss: 13.2559 - val_accuracy10: 0.3535 - val_accuracy20: 0.3574 - val_accuracy30: 0.3602 - val_accuracy50: 0.3543 - 12s/epoch - 30ms/step
Epoch 3/50
401/401 - 12s - loss: 13.0872 - accuracy10: 0.3723 - accuracy20: 0.3737 - accuracy30: 0.3718 - accuracy50: 0.3671 - val_loss: 13.2441 - val_accuracy10: 0.3514 - val_accuracy20: 0.3595 - val_accuracy30: 0.3607 - val_accuracy50: 0.3544 - 12s/epoch - 29ms/step
Epoch 4/50
401/401 - 11s - loss: 13.0628 - accuracy10: 0.3731 - accuracy20: 0.3764 - accuracy30: 0.3756 - accuracy50: 0.3723 - val_loss: 13.1806 - val_accuracy10: 0.3547 - val_accuracy20: 0.3604 - val_accuracy30: 0.3629 - val_accuracy50: 0.3575 - 11s/epoch - 28ms/step
Epoch 5/50
401/401 - 11s - loss: 13.0541 - accuracy10: 0.3807 - accuracy20: 0.3812 - accuracy30: 0.3774 - accuracy50: 0.3733 - val_loss: 13.1773 - val_accuracy10: 0.3585 - val_accuracy20: 0.3627 - val_accuracy30: 0.3582 - val_accuracy50: 0.3487 - 11s/epoch - 28ms/step
Epoch 6/50
401/401 - 12s - loss: 13.0316 - accuracy10: 0.3828 - accuracy20: 0.3819 - accuracy30: 0.3807 - accuracy50: 0.3736 - val_loss: 13.1555 - val_accuracy10: 0.3674 - val_accuracy20: 0.3697 - val_accuracy30: 0.3651 - val_accuracy50: 0.3608 - 12s/epoch - 29ms/step
Epoch 7/50
401/401 - 12s - loss: 12.9898 - accuracy10: 0.3889 - accuracy20: 0.3875 - accuracy30: 0.3845 - accuracy50: 0.3776 - val_loss: 13.1740 - val_accuracy10: 0.3651 - val_accuracy20: 0.3623 - val_accuracy30: 0.3569 - val_accuracy50: 0.3487 - 12s/epoch - 31ms/step
Epoch 8/50
401/401 - 12s - loss: 12.9663 - accuracy10: 0.3930 - accuracy20: 0.3908 - accuracy30: 0.3849 - accuracy50: 0.3773 - val_loss: 13.1501 - val_accuracy10: 0.3711 - val_accuracy20: 0.3702 - val_accuracy30: 0.3673 - val_accuracy50: 0.3581 - 12s/epoch - 30ms/step
Epoch 9/50
401/401 - 12s - loss: 12.9484 - accuracy10: 0.3965 - accuracy20: 0.3924 - accuracy30: 0.3865 - accuracy50: 0.3781 - val_loss: 13.1680 - val_accuracy10: 0.3744 - val_accuracy20: 0.3737 - val_accuracy30: 0.3710 - val_accuracy50: 0.3594 - 12s/epoch - 29ms/step
Epoch 10/50
401/401 - 12s - loss: 12.9310 - accuracy10: 0.3960 - accuracy20: 0.3927 - accuracy30: 0.3894 - accuracy50: 0.3827 - val_loss: 13.1336 - val_accuracy10: 0.3779 - val_accuracy20: 0.3782 - val_accuracy30: 0.3738 - val_accuracy50: 0.3652 - 12s/epoch - 31ms/step
Epoch 11/50
401/401 - 12s - loss: 12.9160 - accuracy10: 0.3990 - accuracy20: 0.3973 - accuracy30: 0.3932 - accuracy50: 0.3850 - val_loss: 13.1279 - val_accuracy10: 0.3763 - val_accuracy20: 0.3784 - val_accuracy30: 0.3733 - val_accuracy50: 0.3628 - 12s/epoch - 30ms/step
Epoch 12/50
401/401 - 12s - loss: 12.9059 - accuracy10: 0.3987 - accuracy20: 0.3979 - accuracy30: 0.3921 - accuracy50: 0.3857 - val_loss: 13.1379 - val_accuracy10: 0.3786 - val_accuracy20: 0.3796 - val_accuracy30: 0.3748 - val_accuracy50: 0.3686 - 12s/epoch - 30ms/step
Epoch 13/50
401/401 - 12s - loss: 12.8843 - accuracy10: 0.4023 - accuracy20: 0.4015 - accuracy30: 0.3965 - accuracy50: 0.3876 - val_loss: 13.1609 - val_accuracy10: 0.3792 - val_accuracy20: 0.3801 - val_accuracy30: 0.3780 - val_accuracy50: 0.3677 - 12s/epoch - 29ms/step
Epoch 14/50
401/401 - 12s - loss: 12.8871 - accuracy10: 0.4008 - accuracy20: 0.4001 - accuracy30: 0.3961 - accuracy50: 0.3879 - val_loss: 13.1434 - val_accuracy10: 0.3828 - val_accuracy20: 0.3836 - val_accuracy30: 0.3779 - val_accuracy50: 0.3697 - 12s/epoch - 30ms/step
Epoch 15/50
401/401 - 12s - loss: 12.8711 - accuracy10: 0.4012 - accuracy20: 0.4018 - accuracy30: 0.3972 - accuracy50: 0.3876 - val_loss: 13.1508 - val_accuracy10: 0.3808 - val_accuracy20: 0.3820 - val_accuracy30: 0.3757 - val_accuracy50: 0.3669 - 12s/epoch - 29ms/step
Epoch 16/50
401/401 - 12s - loss: 12.8646 - accuracy10: 0.4015 - accuracy20: 0.4012 - accuracy30: 0.3961 - accuracy50: 0.3872 - val_loss: 13.1631 - val_accuracy10: 0.3823 - val_accuracy20: 0.3800 - val_accuracy30: 0.3779 - val_accuracy50: 0.3692 - 12s/epoch - 30ms/step
Epoch 17/50
401/401 - 12s - loss: 12.8507 - accuracy10: 0.4041 - accuracy20: 0.4038 - accuracy30: 0.3996 - accuracy50: 0.3904 - val_loss: 13.1632 - val_accuracy10: 0.3823 - val_accuracy20: 0.3811 - val_accuracy30: 0.3755 - val_accuracy50: 0.3692 - 12s/epoch - 29ms/step
Epoch 18/50
401/401 - 11s - loss: 12.8412 - accuracy10: 0.4048 - accuracy20: 0.4038 - accuracy30: 0.3981 - accuracy50: 0.3894 - val_loss: 13.1768 - val_accuracy10: 0.3765 - val_accuracy20: 0.3807 - val_accuracy30: 0.3765 - val_accuracy50: 0.3695 - 11s/epoch - 28ms/step
Epoch 19/50
401/401 - 11s - loss: 12.8325 - accuracy10: 0.4040 - accuracy20: 0.4037 - accuracy30: 0.4008 - accuracy50: 0.3898 - val_loss: 13.1543 - val_accuracy10: 0.3829 - val_accuracy20: 0.3810 - val_accuracy30: 0.3795 - val_accuracy50: 0.3705 - 11s/epoch - 28ms/step
Epoch 20/50
401/401 - 12s - loss: 12.8242 - accuracy10: 0.4071 - accuracy20: 0.4060 - accuracy30: 0.4011 - accuracy50: 0.3922 - val_loss: 13.1732 - val_accuracy10: 0.3834 - val_accuracy20: 0.3811 - val_accuracy30: 0.3787 - val_accuracy50: 0.3713 - 12s/epoch - 30ms/step
Epoch 21/50
401/401 - 12s - loss: 12.8186 - accuracy10: 0.4088 - accuracy20: 0.4077 - accuracy30: 0.4016 - accuracy50: 0.3914 - val_loss: 13.2114 - val_accuracy10: 0.3838 - val_accuracy20: 0.3784 - val_accuracy30: 0.3765 - val_accuracy50: 0.3688 - 12s/epoch - 29ms/step
testing model: results/CHTR/W7/deepVOL_L2/seq2seq
Evaluating performance on  test set...
1065/1065 - 11s - 11s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0891623
{'0': {'precision': 0.3792015664092244, 'recall': 0.39529187644577496, 'f1-score': 0.3870795811634595, 'support': 88188}, '1': {'precision': 0.40026615407363597, 'recall': 0.30852199140030045, 'f1-score': 0.34845647950944364, 'support': 96515}, '2': {'precision': 0.36890852900162063, 'recall': 0.44617786489196826, 'f1-score': 0.4038806709166306, 'support': 87752}, 'accuracy': 0.38094364206933257, 'macro avg': {'precision': 0.38279208316149366, 'recall': 0.3833305775793479, 'f1-score': 0.3798055771965112, 'support': 272455}, 'weighted avg': {'precision': 0.3833483578420799, 'recall': 0.38094364206933257, 'f1-score': 0.3788089330633436, 'support': 272455}}
[[34860 22808 30520]
 [30279 29777 36459]
 [26791 21808 39153]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0892694
{'0': {'precision': 0.3692933933843162, 'recall': 0.4217042133603332, 'f1-score': 0.39376245548256106, 'support': 86914}, '1': {'precision': 0.4081867790987706, 'recall': 0.3327862422065321, 'f1-score': 0.36665017599526883, 'support': 96876}, '2': {'precision': 0.3814062085433802, 'recall': 0.4053234083347431, 'f1-score': 0.39300125758652743, 'support': 88665}, 'accuracy': 0.38475711585399425, 'macro avg': {'precision': 0.3862954603421557, 'recall': 0.3866046213005361, 'f1-score': 0.3844712963547858, 'support': 272455}, 'weighted avg': {'precision': 0.387064468940103, 'recall': 0.38475711585399425, 'f1-score': 0.3838745077515129, 'support': 272455}}
[[36652 23354 26908]
 [33258 32239 31379]
 [29339 23388 35938]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0918485
{'0': {'precision': 0.3570285841108964, 'recall': 0.44748890202487335, 'f1-score': 0.39717304309360435, 'support': 86277}, '1': {'precision': 0.40736229530383, 'recall': 0.31248377887360496, 'f1-score': 0.35367035807655023, 'support': 96325}, '2': {'precision': 0.3853341885256779, 'recall': 0.3878000734533071, 'f1-score': 0.3865631985622446, 'support': 89853}, 'accuracy': 0.3800737736506946, 'macro avg': {'precision': 0.3832416893134681, 'recall': 0.3825909181172618, 'f1-score': 0.37913553324413307, 'support': 272455}, 'weighted avg': {'precision': 0.3841587091008606, 'recall': 0.3800737736506946, 'f1-score': 0.3782938795805692, 'support': 272455}}
[[38608 21544 26125]
 [36767 30100 29458]
 [32762 22246 34845]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0963883
{'0': {'precision': 0.3388249694002448, 'recall': 0.4860811949803334, 'f1-score': 0.3993095290757499, 'support': 85424}, '1': {'precision': 0.39488379241448796, 'recall': 0.2427334278066446, 'f1-score': 0.3006552943623882, 'support': 95265}, '2': {'precision': 0.3849648588881834, 'recall': 0.38320292918946014, 'f1-score': 0.3840818733889641, 'support': 91766}, 'accuracy': 0.36634306582738435, 'macro avg': {'precision': 0.37289120690097205, 'recall': 0.3706725173254794, 'f1-score': 0.36134889894236744, 'support': 272455}, 'weighted avg': {'precision': 0.373966614344188, 'recall': 0.36634306582738435, 'f1-score': 0.35968582342996624, 'support': 272455}}
[[41523 17073 26828]
 [42788 23124 29353]
 [38239 18362 35165]]
Evaluating performance on  train set...
401/401 - 4s - 4s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0789487
{'0': {'precision': 0.40091929160470463, 'recall': 0.4191423806427905, 'f1-score': 0.4098283629529311, 'support': 35377}, '1': {'precision': 0.39292752353842786, 'recall': 0.3176106194690265, 'f1-score': 0.3512772829597729, 'support': 33900}, '2': {'precision': 0.3805203294548307, 'recall': 0.4363064008394544, 'f1-score': 0.4065083798882682, 'support': 33355}, 'accuracy': 0.39118403616805675, 'macro avg': {'precision': 0.3914557148659877, 'recall': 0.39101980031709044, 'f1-score': 0.3892046752669907, 'support': 102632}, 'weighted avg': {'precision': 0.39164997677155483, 'recall': 0.39118403616805675, 'f1-score': 0.38940958862436015, 'support': 102632}}
[[14828  8550 11999]
 [11440 10767 11693]
 [10717  8085 14553]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0788734
{'0': {'precision': 0.39957902122434663, 'recall': 0.44900602579264515, 'f1-score': 0.42285305153737024, 'support': 35514}, '1': {'precision': 0.38881642180420156, 'recall': 0.3337950138504155, 'f1-score': 0.3592109853169695, 'support': 33934}, '2': {'precision': 0.3852290655791385, 'recall': 0.38997709739633557, 'f1-score': 0.38758854096470335, 'support': 33184}, 'accuracy': 0.3918271104528802, 'macro avg': {'precision': 0.3912081695358956, 'recall': 0.3909260456797988, 'f1-score': 0.38988419260634766, 'support': 102632}, 'weighted avg': {'precision': 0.3913807304685025, 'recall': 0.3918271104528802, 'f1-score': 0.39040851772757934, 'support': 102632}}
[[15946  9154 10414]
 [12369 11327 10238]
 [11592  8651 12941]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.082453
{'0': {'precision': 0.39216049239882456, 'recall': 0.47841919548341566, 'f1-score': 0.43101650517535156, 'support': 35425}, '1': {'precision': 0.39050093307475575, 'recall': 0.3128517823639775, 'f1-score': 0.34739017919630216, 'support': 34112}, '2': {'precision': 0.38371875584367016, 'recall': 0.37201994258951504, 'f1-score': 0.3777788005707185, 'support': 33095}, 'accuracy': 0.38907942941772544, 'macro avg': {'precision': 0.38879339377241684, 'recall': 0.3877636401456361, 'f1-score': 0.3853951616474574, 'support': 102632}, 'weighted avg': {'precision': 0.3888867555627942, 'recall': 0.38907942941772544, 'f1-score': 0.38605428027777905, 'support': 102632}}
[[16948  8579  9898]
 [13564 10672  9876]
 [12705  8078 12312]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0874397
{'0': {'precision': 0.3800479973518702, 'recall': 0.516824217870808, 'f1-score': 0.43800667620410105, 'support': 35544}, '1': {'precision': 0.3899612137805156, 'recall': 0.25133076493250595, 'f1-score': 0.30566186201223217, 'support': 34003}, '2': {'precision': 0.3705876903122201, 'recall': 0.3627021308750189, 'f1-score': 0.36660251122720194, 'support': 33085}, 'accuracy': 0.3791799828513524, 'macro avg': {'precision': 0.380198967148202, 'recall': 0.3769523712261109, 'f1-score': 0.3700903498145118, 'support': 102632}, 'weighted avg': {'precision': 0.3802826691873252, 'recall': 0.3791799828513524, 'f1-score': 0.37114129781113564, 'support': 102632}}
[[18370  6838 10336]
 [15412  8546 10045]
 [14554  6531 12000]]
Evaluating performance on  val set...
123/123 - 1s - 1s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.089423
{'0': {'precision': 0.36616250439676395, 'recall': 0.41478234883952586, 'f1-score': 0.3889589463359955, 'support': 10039}, '1': {'precision': 0.3862849533954727, 'recall': 0.2687604224569205, 'f1-score': 0.3169798951048951, 'support': 10794}, '2': {'precision': 0.38467077366189295, 'recall': 0.45582100872203263, 'f1-score': 0.41723434720354063, 'support': 10548}, 'accuracy': 0.3783499569803384, 'macro avg': {'precision': 0.3790394104847099, 'recall': 0.37978792667282635, 'f1-score': 0.37439106288147705, 'support': 31381}, 'weighted avg': {'precision': 0.3793050727884864, 'recall': 0.3783499569803384, 'f1-score': 0.3737047176422753, 'support': 31381}}
[[4164 2319 3556]
 [3758 2901 4135]
 [3450 2290 4808]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0891857
{'0': {'precision': 0.365074162091289, 'recall': 0.4396526201519787, 'f1-score': 0.3989075931232091, 'support': 10133}, '1': {'precision': 0.3696289685069489, 'recall': 0.2756227419661533, 'f1-score': 0.31577800773378356, 'support': 10518}, '2': {'precision': 0.39003087781208645, 'recall': 0.41202236719478097, 'f1-score': 0.4007251302968502, 'support': 10730}, 'accuracy': 0.37522704821388736, 'macro avg': {'precision': 0.3749113361367748, 'recall': 0.37576590977097096, 'f1-score': 0.3718035770512809, 'support': 31381}, 'weighted avg': {'precision': 0.37513416698482543, 'recall': 0.37522704821388736, 'f1-score': 0.3716664342929357, 'support': 31381}}
[[4455 2463 3215]
 [3920 2899 3699]
 [3828 2481 4421]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0918549
{'0': {'precision': 0.3580406795155024, 'recall': 0.46424338206242594, 'f1-score': 0.4042836867231517, 'support': 10124}, '1': {'precision': 0.3657825302041383, 'recall': 0.2513358778625954, 'f1-score': 0.29794694870199645, 'support': 10480}, '2': {'precision': 0.3915679001176151, 'recall': 0.4015959914633015, 'f1-score': 0.3965185524507559, 'support': 10777}, 'accuracy': 0.37162614320767345, 'macro avg': {'precision': 0.3717970366124186, 'recall': 0.3723917504627743, 'f1-score': 0.36624972929196803, 'support': 31381}, 'weighted avg': {'precision': 0.3721402127249563, 'recall': 0.37162614320767345, 'f1-score': 0.3661047291846629, 'support': 31381}}
[[4700 2303 3121]
 [4242 2634 3604]
 [4185 2264 4328]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0969667
{'0': {'precision': 0.34579052609804867, 'recall': 0.5037669512807634, 'f1-score': 0.4100907678469212, 'support': 9955}, '1': {'precision': 0.36160871092377944, 'recall': 0.1932970334209538, 'f1-score': 0.2519270769607243, 'support': 10652}, '2': {'precision': 0.3876072961373391, 'recall': 0.4023575273807314, 'f1-score': 0.39484470352491113, 'support': 10774}, 'accuracy': 0.3635639399636723, 'macro avg': {'precision': 0.3650021777197224, 'recall': 0.36647383736081623, 'f1-score': 0.35228751611085224, 'support': 31381}, 'weighted avg': {'precision': 0.3655167676189371, 'recall': 0.3635639399636723, 'f1-score': 0.3511691040272499, 'support': 31381}}
[[5015 1794 3146]
 [4890 2059 3703]
 [4598 1841 4335]]
training model: results/CHTR/W7/deepVOL_L3/seq2seq
Epoch 1/50
401/401 - 23s - loss: 13.1780 - accuracy10: 0.3604 - accuracy20: 0.3629 - accuracy30: 0.3644 - accuracy50: 0.3632 - val_loss: 13.2739 - val_accuracy10: 0.3390 - val_accuracy20: 0.3447 - val_accuracy30: 0.3443 - val_accuracy50: 0.3411 - 23s/epoch - 58ms/step
Epoch 2/50
401/401 - 17s - loss: 13.1132 - accuracy10: 0.3685 - accuracy20: 0.3710 - accuracy30: 0.3710 - accuracy50: 0.3691 - val_loss: 13.2873 - val_accuracy10: 0.3389 - val_accuracy20: 0.3484 - val_accuracy30: 0.3473 - val_accuracy50: 0.3411 - 17s/epoch - 43ms/step
Epoch 3/50
401/401 - 17s - loss: 13.1058 - accuracy10: 0.3738 - accuracy20: 0.3746 - accuracy30: 0.3739 - accuracy50: 0.3719 - val_loss: 13.2461 - val_accuracy10: 0.3439 - val_accuracy20: 0.3524 - val_accuracy30: 0.3535 - val_accuracy50: 0.3452 - 17s/epoch - 42ms/step
Epoch 4/50
401/401 - 17s - loss: 13.0823 - accuracy10: 0.3778 - accuracy20: 0.3790 - accuracy30: 0.3756 - accuracy50: 0.3737 - val_loss: 13.1943 - val_accuracy10: 0.3534 - val_accuracy20: 0.3558 - val_accuracy30: 0.3538 - val_accuracy50: 0.3475 - 17s/epoch - 42ms/step
Epoch 5/50
401/401 - 17s - loss: 13.0716 - accuracy10: 0.3830 - accuracy20: 0.3829 - accuracy30: 0.3794 - accuracy50: 0.3750 - val_loss: 13.1889 - val_accuracy10: 0.3608 - val_accuracy20: 0.3661 - val_accuracy30: 0.3637 - val_accuracy50: 0.3533 - 17s/epoch - 43ms/step
Epoch 6/50
401/401 - 17s - loss: 13.0435 - accuracy10: 0.3893 - accuracy20: 0.3858 - accuracy30: 0.3816 - accuracy50: 0.3760 - val_loss: 13.1490 - val_accuracy10: 0.3729 - val_accuracy20: 0.3772 - val_accuracy30: 0.3720 - val_accuracy50: 0.3647 - 17s/epoch - 41ms/step
Epoch 7/50
401/401 - 17s - loss: 13.0115 - accuracy10: 0.3932 - accuracy20: 0.3900 - accuracy30: 0.3860 - accuracy50: 0.3819 - val_loss: 13.1419 - val_accuracy10: 0.3672 - val_accuracy20: 0.3705 - val_accuracy30: 0.3705 - val_accuracy50: 0.3622 - 17s/epoch - 41ms/step
Epoch 8/50
401/401 - 17s - loss: 12.9984 - accuracy10: 0.3902 - accuracy20: 0.3910 - accuracy30: 0.3873 - accuracy50: 0.3812 - val_loss: 13.1688 - val_accuracy10: 0.3666 - val_accuracy20: 0.3667 - val_accuracy30: 0.3653 - val_accuracy50: 0.3587 - 17s/epoch - 42ms/step
Epoch 9/50
401/401 - 16s - loss: 12.9816 - accuracy10: 0.3948 - accuracy20: 0.3936 - accuracy30: 0.3883 - accuracy50: 0.3829 - val_loss: 13.1886 - val_accuracy10: 0.3630 - val_accuracy20: 0.3655 - val_accuracy30: 0.3617 - val_accuracy50: 0.3550 - 16s/epoch - 41ms/step
Epoch 10/50
401/401 - 17s - loss: 12.9571 - accuracy10: 0.3927 - accuracy20: 0.3942 - accuracy30: 0.3921 - accuracy50: 0.3849 - val_loss: 13.1322 - val_accuracy10: 0.3729 - val_accuracy20: 0.3734 - val_accuracy30: 0.3730 - val_accuracy50: 0.3642 - 17s/epoch - 42ms/step
Epoch 11/50
401/401 - 17s - loss: 12.9292 - accuracy10: 0.3964 - accuracy20: 0.3971 - accuracy30: 0.3926 - accuracy50: 0.3859 - val_loss: 13.2039 - val_accuracy10: 0.3718 - val_accuracy20: 0.3727 - val_accuracy30: 0.3655 - val_accuracy50: 0.3604 - 17s/epoch - 42ms/step
Epoch 12/50
401/401 - 17s - loss: 12.9210 - accuracy10: 0.3976 - accuracy20: 0.3979 - accuracy30: 0.3929 - accuracy50: 0.3865 - val_loss: 13.1867 - val_accuracy10: 0.3686 - val_accuracy20: 0.3706 - val_accuracy30: 0.3700 - val_accuracy50: 0.3597 - 17s/epoch - 42ms/step
Epoch 13/50
401/401 - 17s - loss: 12.8913 - accuracy10: 0.3991 - accuracy20: 0.3987 - accuracy30: 0.3958 - accuracy50: 0.3880 - val_loss: 13.2067 - val_accuracy10: 0.3668 - val_accuracy20: 0.3697 - val_accuracy30: 0.3686 - val_accuracy50: 0.3585 - 17s/epoch - 42ms/step
Epoch 14/50
401/401 - 17s - loss: 12.8760 - accuracy10: 0.4016 - accuracy20: 0.4019 - accuracy30: 0.3988 - accuracy50: 0.3905 - val_loss: 13.2069 - val_accuracy10: 0.3738 - val_accuracy20: 0.3751 - val_accuracy30: 0.3720 - val_accuracy50: 0.3626 - 17s/epoch - 41ms/step
Epoch 15/50
401/401 - 17s - loss: 12.8629 - accuracy10: 0.4034 - accuracy20: 0.4050 - accuracy30: 0.4011 - accuracy50: 0.3927 - val_loss: 13.2164 - val_accuracy10: 0.3716 - val_accuracy20: 0.3698 - val_accuracy30: 0.3653 - val_accuracy50: 0.3543 - 17s/epoch - 42ms/step
Epoch 16/50
401/401 - 17s - loss: 12.8542 - accuracy10: 0.4048 - accuracy20: 0.4045 - accuracy30: 0.3992 - accuracy50: 0.3919 - val_loss: 13.1870 - val_accuracy10: 0.3735 - val_accuracy20: 0.3723 - val_accuracy30: 0.3691 - val_accuracy50: 0.3574 - 17s/epoch - 41ms/step
Epoch 17/50
401/401 - 16s - loss: 12.8416 - accuracy10: 0.4057 - accuracy20: 0.4050 - accuracy30: 0.4008 - accuracy50: 0.3918 - val_loss: 13.1833 - val_accuracy10: 0.3748 - val_accuracy20: 0.3740 - val_accuracy30: 0.3710 - val_accuracy50: 0.3610 - 16s/epoch - 41ms/step
Epoch 18/50
401/401 - 16s - loss: 12.8260 - accuracy10: 0.4060 - accuracy20: 0.4061 - accuracy30: 0.4010 - accuracy50: 0.3938 - val_loss: 13.2017 - val_accuracy10: 0.3784 - val_accuracy20: 0.3768 - val_accuracy30: 0.3736 - val_accuracy50: 0.3631 - 16s/epoch - 41ms/step
Epoch 19/50
401/401 - 17s - loss: 12.8166 - accuracy10: 0.4078 - accuracy20: 0.4071 - accuracy30: 0.4026 - accuracy50: 0.3937 - val_loss: 13.1960 - val_accuracy10: 0.3775 - val_accuracy20: 0.3763 - val_accuracy30: 0.3745 - val_accuracy50: 0.3633 - 17s/epoch - 42ms/step
Epoch 20/50
401/401 - 17s - loss: 12.8004 - accuracy10: 0.4100 - accuracy20: 0.4102 - accuracy30: 0.4049 - accuracy50: 0.3956 - val_loss: 13.2088 - val_accuracy10: 0.3787 - val_accuracy20: 0.3769 - val_accuracy30: 0.3727 - val_accuracy50: 0.3619 - 17s/epoch - 42ms/step
testing model: results/CHTR/W7/deepVOL_L3/seq2seq
Evaluating performance on  test set...
1065/1065 - 19s - 19s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0915246
{'0': {'precision': 0.38687292540865537, 'recall': 0.3502290561074069, 'f1-score': 0.36764014450402627, 'support': 88188}, '1': {'precision': 0.4063954308278099, 'recall': 0.11943221260943895, 'f1-score': 0.1846107031606595, 'support': 96515}, '2': {'precision': 0.3478107344632768, 'recall': 0.6510392925517368, 'f1-score': 0.45339830481572013, 'support': 87752}, 'accuracy': 0.36535574682057587, 'macro avg': {'precision': 0.38035969689991406, 'recall': 0.3735668537561942, 'f1-score': 0.3352163841601353, 'support': 272455}, 'weighted avg': {'precision': 0.381207509948087, 'recall': 0.36535574682057587, 'f1-score': 0.33042432373515335, 'support': 272455}}
[[30886  8591 48711]
 [26573 11527 58415]
 [22376  8246 57130]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0912349
{'0': {'precision': 0.38063347086695154, 'recall': 0.3576984145247026, 'f1-score': 0.3688097229389469, 'support': 86914}, '1': {'precision': 0.4054662202952637, 'recall': 0.15252487716255833, 'f1-score': 0.22166549153152612, 'support': 96876}, '2': {'precision': 0.352166701223305, 'recall': 0.6130040038346586, 'f1-score': 0.44733972288179885, 'support': 88665}, 'accuracy': 0.3678295498339175, 'macro avg': {'precision': 0.37942213079517345, 'recall': 0.37440909850730647, 'f1-score': 0.3459383124507573, 'support': 272455}, 'weighted avg': {'precision': 0.3801992388035402, 'recall': 0.3678295498339175, 'f1-score': 0.3420461028295992, 'support': 272455}}
[[31089 10805 45020]
 [27136 14776 54964]
 [23452 10861 54352]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0927542
{'0': {'precision': 0.37111179550354173, 'recall': 0.3631327004879632, 'f1-score': 0.367078893256551, 'support': 86277}, '1': {'precision': 0.3982574985512459, 'recall': 0.2069037113937192, 'f1-score': 0.27232728465238304, 'support': 96325}, '2': {'precision': 0.3588303500253642, 'recall': 0.5510667423458315, 'f1-score': 0.4346413978046286, 'support': 89853}, 'accuracy': 0.369877594465141, 'macro avg': {'precision': 0.3760665480267173, 'recall': 0.37370105140917137, 'f1-score': 0.3580158585711876, 'support': 272455}, 'weighted avg': {'precision': 0.3766587119687173, 'recall': 0.369877594465141, 'f1-score': 0.3558614262339672, 'support': 272455}}
[[31330 14717 40230]
 [28150 19930 48245]
 [24942 15396 49515]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.096757
{'0': {'precision': 0.3530259365994236, 'recall': 0.36424189923206596, 'f1-score': 0.3585462255562854, 'support': 85424}, '1': {'precision': 0.387094268089933, 'recall': 0.26151262268409176, 'f1-score': 0.31214604320152356, 'support': 95265}, '2': {'precision': 0.3673452374997916, 'recall': 0.4801996382102304, 'f1-score': 0.41625890310026264, 'support': 91766}, 'accuracy': 0.36737809913563707, 'macro avg': {'precision': 0.3691551473963828, 'recall': 0.3686513867087961, 'f1-score': 0.36231705728602387, 'support': 272455}, 'weighted avg': {'precision': 0.36976097381975925, 'recall': 0.36737809913563707, 'f1-score': 0.36176051120152675, 'support': 272455}}
[[31115 19173 35136]
 [29596 24913 40756]
 [27427 20273 44066]]
Evaluating performance on  train set...
401/401 - 7s - 7s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0837847
{'0': {'precision': 0.3989345602034021, 'recall': 0.3725584419255448, 'f1-score': 0.38529562230505, 'support': 35377}, '1': {'precision': 0.4287472777199129, 'recall': 0.1335693215339233, 'f1-score': 0.20368412766244579, 'support': 33900}, '2': {'precision': 0.361662121186455, 'recall': 0.640083945435467, 'f1-score': 0.4621812356583106, 'support': 33355}, 'accuracy': 0.3805635669186998, 'macro avg': {'precision': 0.39644798636992334, 'recall': 0.38207056963164504, 'f1-score': 0.3503869952086021, 'support': 102632}, 'weighted avg': {'precision': 0.39666849231423934, 'recall': 0.3805635669186998, 'f1-score': 0.3502957193996572, 'support': 102632}}
[[13180  3158 19039]
 [10728  4528 18644]
 [ 9130  2875 21350]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0825175
{'0': {'precision': 0.4016154896953139, 'recall': 0.38080756884608885, 'f1-score': 0.39093484419263463, 'support': 35514}, '1': {'precision': 0.4118428824571766, 'recall': 0.16437791006070607, 'f1-score': 0.23497198702556976, 'support': 33934}, '2': {'precision': 0.3588262893853539, 'recall': 0.5992044358727098, 'f1-score': 0.44885889071988083, 'support': 33184}, 'accuracy': 0.37986203133525603, 'macro avg': {'precision': 0.39076155384594813, 'recall': 0.38146330492650155, 'f1-score': 0.3582552406460284, 'support': 102632}, 'weighted avg': {'precision': 0.3911620202403226, 'recall': 0.37986203133525603, 'f1-score': 0.3580962360085688, 'support': 102632}}
[[13524  4055 17935]
 [10761  5578 17595]
 [ 9389  3911 19884]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0838189
{'0': {'precision': 0.3963174933518326, 'recall': 0.38704304869442485, 'f1-score': 0.3916253695319975, 'support': 35425}, '1': {'precision': 0.39281108961960026, 'recall': 0.2143234052532833, 'f1-score': 0.2773310067521432, 'support': 34112}, '2': {'precision': 0.35871236646163807, 'recall': 0.5357002568363801, 'f1-score': 0.4296949793380918, 'support': 33095}, 'accuracy': 0.3775722971392938, 'macro avg': {'precision': 0.3826136498110236, 'recall': 0.37902223692802944, 'f1-score': 0.3662171185407442, 'support': 102632}, 'weighted avg': {'precision': 0.3830258092908682, 'recall': 0.3775722971392938, 'f1-score': 0.36591315924072676, 'support': 102632}}
[[13711  5801 15913]
 [11019  7311 15782]
 [ 9866  5500 17729]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0878454
{'0': {'precision': 0.388238565271792, 'recall': 0.3928370470402881, 'f1-score': 0.39052426967234893, 'support': 35544}, '1': {'precision': 0.3740017560730861, 'recall': 0.26306502367438167, 'f1-score': 0.3088743093922652, 'support': 34003}, '2': {'precision': 0.35782456140350877, 'recall': 0.46235454133293036, 'f1-score': 0.4034284960770093, 'support': 33085}, 'accuracy': 0.3722523189648453, 'macro avg': {'precision': 0.3733549609161289, 'recall': 0.3727522040158667, 'f1-score': 0.36760902504720777, 'support': 102632}, 'weighted avg': {'precision': 0.37371734829106723, 'recall': 0.3722523189648453, 'f1-score': 0.36763270301862006, 'support': 102632}}
[[13963  7717 13864]
 [11469  8945 13589]
 [10533  7255 15297]]
Evaluating performance on  val set...
123/123 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.092647
{'0': {'precision': 0.37269953744710166, 'recall': 0.37722880765016437, 'f1-score': 0.37495049504950495, 'support': 10039}, '1': {'precision': 0.4088860270444301, 'recall': 0.1176579581248842, 'f1-score': 0.18273381294964028, 'support': 10794}, '2': {'precision': 0.3664568841779839, 'recall': 0.6293136139552522, 'f1-score': 0.46319168236689695, 'support': 10548}, 'accuracy': 0.3726777349351518, 'macro avg': {'precision': 0.38268081622317185, 'recall': 0.3747334599101002, 'f1-score': 0.3402919967886808, 'support': 31381}, 'weighted avg': {'precision': 0.3830481388948219, 'recall': 0.3726777349351518, 'f1-score': 0.33849471534962006, 'support': 31381}}
[[3787  895 5357]
 [3405 1270 6119]
 [2969  941 6638]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0900751
{'0': {'precision': 0.3773839337314583, 'recall': 0.38665745583736305, 'f1-score': 0.38196441628077016, 'support': 10133}, '1': {'precision': 0.37305295950155765, 'recall': 0.13662293211637194, 'f1-score': 0.2, 'support': 10518}, '2': {'precision': 0.36997725549658833, 'recall': 0.5912395153774465, 'f1-score': 0.4551422319474836, 'support': 10730}, 'accuracy': 0.3728052005990886, 'macro avg': {'precision': 0.3734713829098681, 'recall': 0.37150663444372717, 'f1-score': 0.3457022160760846, 'support': 31381}, 'weighted avg': {'precision': 0.3733997762982902, 'recall': 0.3728052005990886, 'f1-score': 0.34599667247600596, 'support': 31381}}
[[3918 1179 5036]
 [3314 1437 5767]
 [3150 1236 6344]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0915722
{'0': {'precision': 0.3720886551465064, 'recall': 0.39134729355985776, 'f1-score': 0.381475062584248, 'support': 10124}, '1': {'precision': 0.3604829436565734, 'recall': 0.17948473282442748, 'f1-score': 0.23964836284877053, 'support': 10480}, '2': {'precision': 0.3735739606832098, 'recall': 0.5378120070520553, 'f1-score': 0.44089456869009586, 'support': 10777}, 'accuracy': 0.37089321564003697, 'macro avg': {'precision': 0.3687151864954299, 'recall': 0.36954801114544683, 'f1-score': 0.35400599804103816, 'support': 31381}, 'weighted avg': {'precision': 0.3687229013896011, 'recall': 0.37089321564003697, 'f1-score': 0.35451671849307553, 'support': 31381}}
[[3962 1625 4537]
 [3417 1881 5182]
 [3269 1712 5796]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0955223
{'0': {'precision': 0.35193868349864743, 'recall': 0.3920642893018584, 'f1-score': 0.3709194583036351, 'support': 9955}, '1': {'precision': 0.3554198473282443, 'recall': 0.2185505069470522, 'f1-score': 0.2706662016044646, 'support': 10652}, '2': {'precision': 0.3739174732552216, 'recall': 0.47688880638574344, 'f1-score': 0.4191719355496635, 'support': 10774}, 'accuracy': 0.3622892833243045, 'macro avg': {'precision': 0.36042533469403776, 'recall': 0.362501200878218, 'f1-score': 0.3535858651525878, 'support': 31381}, 'weighted avg': {'precision': 0.36066628421086805, 'recall': 0.3622892833243045, 'f1-score': 0.3534558497344099, 'support': 31381}}
[[3903 2045 4007]
 [3728 2328 4596]
 [3459 2177 5138]]
training model: results/CHTR/W8/deepLOB_L1/seq2seq
Epoch 1/50
358/358 - 15s - loss: 13.2421 - accuracy10: 0.3623 - accuracy20: 0.3615 - accuracy30: 0.3587 - accuracy50: 0.3551 - val_loss: 13.3740 - val_accuracy10: 0.3322 - val_accuracy20: 0.3398 - val_accuracy30: 0.3455 - val_accuracy50: 0.3466 - 15s/epoch - 42ms/step
Epoch 2/50
358/358 - 9s - loss: 13.1250 - accuracy10: 0.3753 - accuracy20: 0.3721 - accuracy30: 0.3710 - accuracy50: 0.3639 - val_loss: 13.2799 - val_accuracy10: 0.3551 - val_accuracy20: 0.3539 - val_accuracy30: 0.3553 - val_accuracy50: 0.3541 - 9s/epoch - 25ms/step
Epoch 3/50
358/358 - 9s - loss: 13.0902 - accuracy10: 0.3820 - accuracy20: 0.3795 - accuracy30: 0.3759 - accuracy50: 0.3676 - val_loss: 13.2393 - val_accuracy10: 0.3528 - val_accuracy20: 0.3542 - val_accuracy30: 0.3553 - val_accuracy50: 0.3546 - 9s/epoch - 24ms/step
Epoch 4/50
358/358 - 9s - loss: 13.0615 - accuracy10: 0.3863 - accuracy20: 0.3857 - accuracy30: 0.3833 - accuracy50: 0.3745 - val_loss: 13.1853 - val_accuracy10: 0.3537 - val_accuracy20: 0.3562 - val_accuracy30: 0.3572 - val_accuracy50: 0.3539 - 9s/epoch - 25ms/step
Epoch 5/50
358/358 - 9s - loss: 13.0320 - accuracy10: 0.3935 - accuracy20: 0.3908 - accuracy30: 0.3871 - accuracy50: 0.3809 - val_loss: 13.1659 - val_accuracy10: 0.3623 - val_accuracy20: 0.3643 - val_accuracy30: 0.3620 - val_accuracy50: 0.3577 - 9s/epoch - 24ms/step
Epoch 6/50
358/358 - 8s - loss: 13.0227 - accuracy10: 0.3922 - accuracy20: 0.3910 - accuracy30: 0.3878 - accuracy50: 0.3796 - val_loss: 13.1617 - val_accuracy10: 0.3603 - val_accuracy20: 0.3605 - val_accuracy30: 0.3610 - val_accuracy50: 0.3561 - 8s/epoch - 23ms/step
Epoch 7/50
358/358 - 8s - loss: 13.0065 - accuracy10: 0.3986 - accuracy20: 0.3961 - accuracy30: 0.3924 - accuracy50: 0.3830 - val_loss: 13.2002 - val_accuracy10: 0.3556 - val_accuracy20: 0.3568 - val_accuracy30: 0.3585 - val_accuracy50: 0.3557 - 8s/epoch - 23ms/step
Epoch 8/50
358/358 - 8s - loss: 12.9876 - accuracy10: 0.4033 - accuracy20: 0.4011 - accuracy30: 0.3971 - accuracy50: 0.3861 - val_loss: 13.2250 - val_accuracy10: 0.3524 - val_accuracy20: 0.3556 - val_accuracy30: 0.3573 - val_accuracy50: 0.3564 - 8s/epoch - 23ms/step
Epoch 9/50
358/358 - 8s - loss: 12.9790 - accuracy10: 0.4030 - accuracy20: 0.4016 - accuracy30: 0.3961 - accuracy50: 0.3869 - val_loss: 13.2389 - val_accuracy10: 0.3513 - val_accuracy20: 0.3577 - val_accuracy30: 0.3579 - val_accuracy50: 0.3583 - 8s/epoch - 23ms/step
Epoch 10/50
358/358 - 8s - loss: 12.9662 - accuracy10: 0.4060 - accuracy20: 0.4024 - accuracy30: 0.3989 - accuracy50: 0.3887 - val_loss: 13.3180 - val_accuracy10: 0.3456 - val_accuracy20: 0.3499 - val_accuracy30: 0.3540 - val_accuracy50: 0.3522 - 8s/epoch - 22ms/step
Epoch 11/50
358/358 - 8s - loss: 12.9541 - accuracy10: 0.4079 - accuracy20: 0.4053 - accuracy30: 0.4015 - accuracy50: 0.3900 - val_loss: 13.3667 - val_accuracy10: 0.3490 - val_accuracy20: 0.3537 - val_accuracy30: 0.3552 - val_accuracy50: 0.3541 - 8s/epoch - 23ms/step
Epoch 12/50
358/358 - 8s - loss: 12.9420 - accuracy10: 0.4092 - accuracy20: 0.4088 - accuracy30: 0.4035 - accuracy50: 0.3920 - val_loss: 13.3273 - val_accuracy10: 0.3545 - val_accuracy20: 0.3569 - val_accuracy30: 0.3598 - val_accuracy50: 0.3579 - 8s/epoch - 23ms/step
Epoch 13/50
358/358 - 8s - loss: 12.9260 - accuracy10: 0.4112 - accuracy20: 0.4108 - accuracy30: 0.4054 - accuracy50: 0.3958 - val_loss: 13.3497 - val_accuracy10: 0.3499 - val_accuracy20: 0.3529 - val_accuracy30: 0.3591 - val_accuracy50: 0.3558 - 8s/epoch - 23ms/step
Epoch 14/50
358/358 - 8s - loss: 12.9111 - accuracy10: 0.4132 - accuracy20: 0.4130 - accuracy30: 0.4079 - accuracy50: 0.3961 - val_loss: 13.4122 - val_accuracy10: 0.3459 - val_accuracy20: 0.3469 - val_accuracy30: 0.3555 - val_accuracy50: 0.3569 - 8s/epoch - 23ms/step
Epoch 15/50
358/358 - 8s - loss: 12.9002 - accuracy10: 0.4165 - accuracy20: 0.4157 - accuracy30: 0.4110 - accuracy50: 0.3979 - val_loss: 13.4541 - val_accuracy10: 0.3442 - val_accuracy20: 0.3497 - val_accuracy30: 0.3555 - val_accuracy50: 0.3540 - 8s/epoch - 22ms/step
Epoch 16/50
358/358 - 8s - loss: 12.8903 - accuracy10: 0.4178 - accuracy20: 0.4169 - accuracy30: 0.4120 - accuracy50: 0.4014 - val_loss: 13.4656 - val_accuracy10: 0.3423 - val_accuracy20: 0.3476 - val_accuracy30: 0.3534 - val_accuracy50: 0.3552 - 8s/epoch - 22ms/step
testing model: results/CHTR/W8/deepLOB_L1/seq2seq
Evaluating performance on  test set...
1223/1223 - 12s - 12s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0978974
{'0': {'precision': 0.36198227402834776, 'recall': 0.5124844981300106, 'f1-score': 0.4242821109817618, 'support': 102407}, '1': {'precision': 0.3446208324067263, 'recall': 0.37126692037632575, 'f1-score': 0.3574479788144803, 'support': 108523}, '2': {'precision': 0.3552821997105644, 'recall': 0.1779281705728529, 'f1-score': 0.23710983639721478, 'support': 102103}, 'accuracy': 0.35440352934035707, 'macro avg': {'precision': 0.3539617687152128, 'recall': 0.35389319635972977, 'f1-score': 0.3396133087311523, 'support': 313033}, 'weighted avg': {'precision': 0.35377798432990754, 'recall': 0.35440352934035707, 'f1-score': 0.34006130590020206, 'support': 313033}}
[[52482 33662 16263]
 [51528 40291 16704]
 [40975 42961 18167]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0970403
{'0': {'precision': 0.36590156948134533, 'recall': 0.5267345334636989, 'f1-score': 0.43182880875759827, 'support': 104322}, '1': {'precision': 0.3446581234559124, 'recall': 0.35934474227950375, 'f1-score': 0.35184823976085605, 'support': 107927}, '2': {'precision': 0.3452612755811643, 'recall': 0.17241824099063344, 'f1-score': 0.22998530910438478, 'support': 100784}, 'accuracy': 0.35494660307379733, 'macro avg': {'precision': 0.351940322839474, 'recall': 0.3528325055779454, 'f1-score': 0.3378874525409464, 'support': 313033}, 'weighted avg': {'precision': 0.3519319471743594, 'recall': 0.35494660307379733, 'f1-score': 0.33926777481178144, 'support': 313033}}
[[54950 33165 16207]
 [52398 38783 16746]
 [42829 40578 17377]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0983045
{'0': {'precision': 0.36892005719994514, 'recall': 0.5315001740341107, 'f1-score': 0.43553236101261134, 'support': 106301}, '1': {'precision': 0.33591910489714716, 'recall': 0.34621317581549343, 'f1-score': 0.3409884663486034, 'support': 106316}, '2': {'precision': 0.3385673397996502, 'recall': 0.16963432122370936, 'f1-score': 0.22602303487076061, 'support': 100416}, 'accuracy': 0.3524899930678235, 'macro avg': {'precision': 0.34780216729891417, 'recall': 0.3491158903577712, 'f1-score': 0.33418128741065845, 'support': 313033}, 'weighted avg': {'precision': 0.3479752120382775, 'recall': 0.3524899930678235, 'f1-score': 0.33621498169810216, 'support': 313033}}
[[56499 33545 16257]
 [52487 36808 17021]
 [44161 39221 17034]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0996615
{'0': {'precision': 0.36221903457586635, 'recall': 0.5281458207147184, 'f1-score': 0.42972151957217275, 'support': 105664}, '1': {'precision': 0.34316744417605516, 'recall': 0.34061750764106224, 'f1-score': 0.34188772136086415, 'support': 109278}, '2': {'precision': 0.3215841584158416, 'recall': 0.16556055091700564, 'f1-score': 0.21858659003573566, 'support': 98091}, 'accuracy': 0.3490622394444036, 'macro avg': {'precision': 0.3423235457225877, 'recall': 0.3447746264242621, 'f1-score': 0.3300652769895908, 'support': 313033}, 'weighted avg': {'precision': 0.3428350228802191, 'recall': 0.3490622394444036, 'f1-score': 0.33289869841883096, 'support': 313033}}
[[55806 33751 16107]
 [53903 37222 18153]
 [44358 37493 16240]]
Evaluating performance on  train set...
358/358 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0912395
{'0': {'precision': 0.40162559970189576, 'recall': 0.546211833269986, 'f1-score': 0.4628908871292444, 'support': 31572}, '1': {'precision': 0.3451041046995836, 'recall': 0.48160324101746693, 'f1-score': 0.40208486394322074, 'support': 30114}, '2': {'precision': 0.3869268897149938, 'recall': 0.08401439478021054, 'f1-score': 0.138052999530244, 'support': 29733}, 'accuracy': 0.3746048414443387, 'macro avg': {'precision': 0.3778855313721577, 'recall': 0.3706098230225545, 'f1-score': 0.33434291686756973, 'support': 91419}, 'weighted avg': {'precision': 0.3782264699308395, 'recall': 0.3746048414443387, 'f1-score': 0.3372111324370579, 'support': 91419}}
[[17245 12356  1971]
 [13624 14503  1987]
 [12069 15166  2498]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0915511
{'0': {'precision': 0.3976683064896556, 'recall': 0.5626251390433815, 'f1-score': 0.46597878444894836, 'support': 31465}, '1': {'precision': 0.3441537587390993, 'recall': 0.4629008140887191, 'f1-score': 0.39479128290871995, 'support': 30095}, '2': {'precision': 0.3868908609683948, 'recall': 0.08322448842894939, 'f1-score': 0.13698252577035444, 'support': 29859}, 'accuracy': 0.3732156335116332, 'macro avg': {'precision': 0.3762376420657166, 'recall': 0.36958348052035, 'f1-score': 0.33258419770934095, 'support': 91419}, 'weighted avg': {'precision': 0.3765312992988931, 'recall': 0.3732156335116332, 'f1-score': 0.33508819117252536, 'support': 91419}}
[[17703 11885  1877]
 [14103 13931  2061]
 [12711 14663  2485]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0923976
{'0': {'precision': 0.3932710280373832, 'recall': 0.5699716352742454, 'f1-score': 0.4654140425753395, 'support': 31377}, '1': {'precision': 0.342535526918963, 'recall': 0.44779597815954186, 'f1-score': 0.3881561859686589, 'support': 30036}, '2': {'precision': 0.3894878706199461, 'recall': 0.08668266346730653, 'f1-score': 0.14180569185475955, 'support': 30006}, 'accuracy': 0.3712029228059813, 'macro avg': {'precision': 0.37509814185876406, 'recall': 0.36815009230036466, 'f1-score': 0.33179197346625267, 'support': 91419}, 'weighted avg': {'precision': 0.3753599927705296, 'recall': 0.3712029228059813, 'f1-score': 0.3338143843778097, 'support': 91419}}
[[17884 11548  1945]
 [14454 13450  2132]
 [13137 14268  2601]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0945691
{'0': {'precision': 0.38522967121439605, 'recall': 0.5666549307044778, 'f1-score': 0.4586528497409327, 'support': 31243}, '1': {'precision': 0.345022210608832, 'recall': 0.43648143863012795, 'f1-score': 0.38540009632083594, 'support': 30251}, '2': {'precision': 0.3706896551724138, 'recall': 0.08908939014202172, 'f1-score': 0.14365385133496783, 'support': 29925}, 'accuracy': 0.3672540719106531, 'macro avg': {'precision': 0.3669805123318806, 'recall': 0.36407525315887584, 'f1-score': 0.3292355991322455, 'support': 91419}, 'weighted avg': {'precision': 0.3671653096392833, 'recall': 0.3672540719106531, 'f1-score': 0.3313017075165609, 'support': 91419}}
[[17704 11430  2109]
 [14630 13204  2417]
 [13623 13636  2666]]
Evaluating performance on  val set...
99/99 - 1s - 896ms/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0967394
{'0': {'precision': 0.39854381554996965, 'recall': 0.5384074941451991, 'f1-score': 0.45803655924689946, 'support': 8540}, '1': {'precision': 0.32778565564594375, 'recall': 0.5386974119955844, 'f1-score': 0.40757238307349664, 'support': 8153}, '2': {'precision': 0.38819875776397517, 'recall': 0.014594279042615295, 'f1-score': 0.02813097783278947, 'support': 8565}, 'accuracy': 0.3608757621347692, 'macro avg': {'precision': 0.3715094096532962, 'recall': 0.36389972839446627, 'f1-score': 0.29791330671772853, 'support': 25258}, 'weighted avg': {'precision': 0.3721958585607161, 'recall': 0.3608757621347692, 'f1-score': 0.29596609709021227, 'support': 25258}}
[[4598 3837  105]
 [3669 4392   92]
 [3270 5170  125]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0954952
{'0': {'precision': 0.3962280108254398, 'recall': 0.5441979323963294, 'f1-score': 0.4585719179758234, 'support': 8609}, '1': {'precision': 0.33467957022022404, 'recall': 0.529603279874593, 'f1-score': 0.4101606275681734, 'support': 8293}, '2': {'precision': 0.37942122186495175, 'recall': 0.014121589277166108, 'f1-score': 0.027229721933771777, 'support': 8356}, 'accuracy': 0.36404307546124, 'macro avg': {'precision': 0.3701096009702052, 'recall': 0.3626409338493628, 'f1-score': 0.29865408915925623, 'support': 25258}, 'weighted avg': {'precision': 0.3704595910577269, 'recall': 0.36404307546124, 'f1-score': 0.2999778004099819, 'support': 25258}}
[[4685 3816  108]
 [3816 4392   85]
 [3323 4915  118]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0950313
{'0': {'precision': 0.3928305323288352, 'recall': 0.5495078170237406, 'f1-score': 0.4581442502655209, 'support': 8635}, '1': {'precision': 0.3354479949874687, 'recall': 0.5109149469163784, 'f1-score': 0.40499267174128883, 'support': 8383}, '2': {'precision': 0.34793187347931875, 'recall': 0.017354368932038833, 'f1-score': 0.03305976187723962, 'support': 8240}, 'accuracy': 0.36309288146329877, 'macro avg': {'precision': 0.35873680026520754, 'recall': 0.3592590442907193, 'f1-score': 0.29873222796134974, 'support': 25258}, 'weighted avg': {'precision': 0.35913812756786084, 'recall': 0.36309288146329877, 'f1-score': 0.30182681154954677, 'support': 25258}}
[[4745 3758  132]
 [3964 4283  136]
 [3370 4727  143]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0973942
{'0': {'precision': 0.375768001966085, 'recall': 0.5365539829219792, 'f1-score': 0.4419926768163423, 'support': 8549}, '1': {'precision': 0.33822115384615387, 'recall': 0.49606299212598426, 'f1-score': 0.4022106817856973, 'support': 8509}, '2': {'precision': 0.3415061295971979, 'recall': 0.02378048780487805, 'f1-score': 0.044464713259605514, 'support': 8200}, 'accuracy': 0.35644152347771, 'macro avg': {'precision': 0.3518317618031456, 'recall': 0.3521324876176138, 'f1-score': 0.2962226906205484, 'support': 25258}, 'weighted avg': {'precision': 0.35199598976886554, 'recall': 0.35644152347771, 'f1-score': 0.29953348381289785, 'support': 25258}}
[[4587 3774  188]
 [4100 4221  188]
 [3520 4485  195]]
training model: results/CHTR/W8/deepOF_L1/seq2seq
Epoch 1/50
358/358 - 14s - loss: 13.1155 - accuracy10: 0.3772 - accuracy20: 0.3825 - accuracy30: 0.3827 - accuracy50: 0.3775 - val_loss: 13.1829 - val_accuracy10: 0.3553 - val_accuracy20: 0.3547 - val_accuracy30: 0.3544 - val_accuracy50: 0.3576 - 14s/epoch - 40ms/step
Epoch 2/50
358/358 - 8s - loss: 13.0105 - accuracy10: 0.3943 - accuracy20: 0.3980 - accuracy30: 0.3986 - accuracy50: 0.3925 - val_loss: 13.0953 - val_accuracy10: 0.3774 - val_accuracy20: 0.3729 - val_accuracy30: 0.3768 - val_accuracy50: 0.3698 - 8s/epoch - 23ms/step
Epoch 3/50
358/358 - 8s - loss: 12.9521 - accuracy10: 0.4055 - accuracy20: 0.4077 - accuracy30: 0.4062 - accuracy50: 0.3987 - val_loss: 13.0613 - val_accuracy10: 0.3800 - val_accuracy20: 0.3797 - val_accuracy30: 0.3848 - val_accuracy50: 0.3810 - 8s/epoch - 23ms/step
Epoch 4/50
358/358 - 8s - loss: 12.9257 - accuracy10: 0.4094 - accuracy20: 0.4125 - accuracy30: 0.4097 - accuracy50: 0.4023 - val_loss: 13.0388 - val_accuracy10: 0.3881 - val_accuracy20: 0.3824 - val_accuracy30: 0.3857 - val_accuracy50: 0.3839 - 8s/epoch - 22ms/step
Epoch 5/50
358/358 - 8s - loss: 12.9045 - accuracy10: 0.4124 - accuracy20: 0.4143 - accuracy30: 0.4134 - accuracy50: 0.4037 - val_loss: 12.9992 - val_accuracy10: 0.3949 - val_accuracy20: 0.3926 - val_accuracy30: 0.3937 - val_accuracy50: 0.3911 - 8s/epoch - 22ms/step
Epoch 6/50
358/358 - 7s - loss: 12.8908 - accuracy10: 0.4124 - accuracy20: 0.4143 - accuracy30: 0.4130 - accuracy50: 0.4043 - val_loss: 13.0080 - val_accuracy10: 0.3920 - val_accuracy20: 0.3908 - val_accuracy30: 0.3929 - val_accuracy50: 0.3886 - 7s/epoch - 21ms/step
Epoch 7/50
358/358 - 7s - loss: 12.8785 - accuracy10: 0.4145 - accuracy20: 0.4176 - accuracy30: 0.4156 - accuracy50: 0.4070 - val_loss: 12.9906 - val_accuracy10: 0.3966 - val_accuracy20: 0.3944 - val_accuracy30: 0.3958 - val_accuracy50: 0.3915 - 7s/epoch - 19ms/step
Epoch 8/50
358/358 - 8s - loss: 12.8568 - accuracy10: 0.4194 - accuracy20: 0.4203 - accuracy30: 0.4174 - accuracy50: 0.4080 - val_loss: 12.9856 - val_accuracy10: 0.3971 - val_accuracy20: 0.3935 - val_accuracy30: 0.3961 - val_accuracy50: 0.3923 - 8s/epoch - 22ms/step
Epoch 9/50
358/358 - 8s - loss: 12.8461 - accuracy10: 0.4209 - accuracy20: 0.4238 - accuracy30: 0.4215 - accuracy50: 0.4106 - val_loss: 12.9816 - val_accuracy10: 0.3975 - val_accuracy20: 0.3976 - val_accuracy30: 0.4001 - val_accuracy50: 0.3967 - 8s/epoch - 22ms/step
Epoch 10/50
358/358 - 8s - loss: 12.8391 - accuracy10: 0.4212 - accuracy20: 0.4240 - accuracy30: 0.4208 - accuracy50: 0.4107 - val_loss: 12.9756 - val_accuracy10: 0.4032 - val_accuracy20: 0.3993 - val_accuracy30: 0.3989 - val_accuracy50: 0.3955 - 8s/epoch - 22ms/step
Epoch 11/50
358/358 - 8s - loss: 12.8280 - accuracy10: 0.4226 - accuracy20: 0.4260 - accuracy30: 0.4222 - accuracy50: 0.4121 - val_loss: 12.9740 - val_accuracy10: 0.4041 - val_accuracy20: 0.3989 - val_accuracy30: 0.4016 - val_accuracy50: 0.3950 - 8s/epoch - 22ms/step
Epoch 12/50
358/358 - 8s - loss: 12.8149 - accuracy10: 0.4237 - accuracy20: 0.4259 - accuracy30: 0.4235 - accuracy50: 0.4125 - val_loss: 12.9698 - val_accuracy10: 0.4028 - val_accuracy20: 0.3994 - val_accuracy30: 0.4005 - val_accuracy50: 0.3945 - 8s/epoch - 21ms/step
Epoch 13/50
358/358 - 8s - loss: 12.8056 - accuracy10: 0.4262 - accuracy20: 0.4279 - accuracy30: 0.4247 - accuracy50: 0.4143 - val_loss: 12.9709 - val_accuracy10: 0.4051 - val_accuracy20: 0.3995 - val_accuracy30: 0.4009 - val_accuracy50: 0.3961 - 8s/epoch - 21ms/step
Epoch 14/50
358/358 - 8s - loss: 12.7929 - accuracy10: 0.4274 - accuracy20: 0.4300 - accuracy30: 0.4273 - accuracy50: 0.4156 - val_loss: 12.9716 - val_accuracy10: 0.4033 - val_accuracy20: 0.4023 - val_accuracy30: 0.4034 - val_accuracy50: 0.3998 - 8s/epoch - 22ms/step
Epoch 15/50
358/358 - 7s - loss: 12.7855 - accuracy10: 0.4278 - accuracy20: 0.4296 - accuracy30: 0.4275 - accuracy50: 0.4171 - val_loss: 12.9720 - val_accuracy10: 0.4045 - val_accuracy20: 0.4021 - val_accuracy30: 0.4006 - val_accuracy50: 0.3944 - 7s/epoch - 20ms/step
Epoch 16/50
358/358 - 7s - loss: 12.7756 - accuracy10: 0.4294 - accuracy20: 0.4332 - accuracy30: 0.4281 - accuracy50: 0.4188 - val_loss: 12.9612 - val_accuracy10: 0.4101 - val_accuracy20: 0.4053 - val_accuracy30: 0.4024 - val_accuracy50: 0.3947 - 7s/epoch - 21ms/step
Epoch 17/50
358/358 - 7s - loss: 12.7631 - accuracy10: 0.4301 - accuracy20: 0.4333 - accuracy30: 0.4298 - accuracy50: 0.4192 - val_loss: 12.9740 - val_accuracy10: 0.4067 - val_accuracy20: 0.4031 - val_accuracy30: 0.4011 - val_accuracy50: 0.3922 - 7s/epoch - 19ms/step
Epoch 18/50
358/358 - 8s - loss: 12.7508 - accuracy10: 0.4320 - accuracy20: 0.4333 - accuracy30: 0.4312 - accuracy50: 0.4204 - val_loss: 12.9626 - val_accuracy10: 0.4102 - val_accuracy20: 0.4067 - val_accuracy30: 0.4054 - val_accuracy50: 0.3971 - 8s/epoch - 23ms/step
Epoch 19/50
358/358 - 8s - loss: 12.7415 - accuracy10: 0.4347 - accuracy20: 0.4362 - accuracy30: 0.4323 - accuracy50: 0.4217 - val_loss: 12.9598 - val_accuracy10: 0.4068 - val_accuracy20: 0.4043 - val_accuracy30: 0.4016 - val_accuracy50: 0.3967 - 8s/epoch - 22ms/step
Epoch 20/50
358/358 - 7s - loss: 12.7342 - accuracy10: 0.4348 - accuracy20: 0.4365 - accuracy30: 0.4332 - accuracy50: 0.4226 - val_loss: 12.9669 - val_accuracy10: 0.4060 - val_accuracy20: 0.4054 - val_accuracy30: 0.4033 - val_accuracy50: 0.3978 - 7s/epoch - 21ms/step
Epoch 21/50
358/358 - 8s - loss: 12.7194 - accuracy10: 0.4364 - accuracy20: 0.4383 - accuracy30: 0.4351 - accuracy50: 0.4237 - val_loss: 12.9580 - val_accuracy10: 0.4103 - val_accuracy20: 0.4065 - val_accuracy30: 0.4029 - val_accuracy50: 0.3984 - 8s/epoch - 21ms/step
Epoch 22/50
358/358 - 8s - loss: 12.7110 - accuracy10: 0.4377 - accuracy20: 0.4393 - accuracy30: 0.4354 - accuracy50: 0.4251 - val_loss: 12.9685 - val_accuracy10: 0.4080 - val_accuracy20: 0.4031 - val_accuracy30: 0.4034 - val_accuracy50: 0.3955 - 8s/epoch - 22ms/step
Epoch 23/50
358/358 - 8s - loss: 12.7010 - accuracy10: 0.4389 - accuracy20: 0.4404 - accuracy30: 0.4378 - accuracy50: 0.4261 - val_loss: 12.9644 - val_accuracy10: 0.4097 - val_accuracy20: 0.4067 - val_accuracy30: 0.4029 - val_accuracy50: 0.3931 - 8s/epoch - 22ms/step
Epoch 24/50
358/358 - 7s - loss: 12.6917 - accuracy10: 0.4391 - accuracy20: 0.4410 - accuracy30: 0.4391 - accuracy50: 0.4276 - val_loss: 12.9666 - val_accuracy10: 0.4101 - val_accuracy20: 0.4066 - val_accuracy30: 0.4049 - val_accuracy50: 0.3970 - 7s/epoch - 20ms/step
Epoch 25/50
358/358 - 7s - loss: 12.6722 - accuracy10: 0.4410 - accuracy20: 0.4439 - accuracy30: 0.4423 - accuracy50: 0.4315 - val_loss: 12.9847 - val_accuracy10: 0.4083 - val_accuracy20: 0.4027 - val_accuracy30: 0.4033 - val_accuracy50: 0.3959 - 7s/epoch - 20ms/step
Epoch 26/50
358/358 - 8s - loss: 12.6703 - accuracy10: 0.4402 - accuracy20: 0.4428 - accuracy30: 0.4409 - accuracy50: 0.4299 - val_loss: 12.9833 - val_accuracy10: 0.4078 - val_accuracy20: 0.4084 - val_accuracy30: 0.4042 - val_accuracy50: 0.3964 - 8s/epoch - 22ms/step
Epoch 27/50
358/358 - 8s - loss: 12.6507 - accuracy10: 0.4423 - accuracy20: 0.4467 - accuracy30: 0.4438 - accuracy50: 0.4327 - val_loss: 12.9938 - val_accuracy10: 0.4105 - val_accuracy20: 0.4075 - val_accuracy30: 0.4025 - val_accuracy50: 0.3960 - 8s/epoch - 21ms/step
Epoch 28/50
358/358 - 8s - loss: 12.6424 - accuracy10: 0.4435 - accuracy20: 0.4479 - accuracy30: 0.4437 - accuracy50: 0.4346 - val_loss: 12.9817 - val_accuracy10: 0.4101 - val_accuracy20: 0.4098 - val_accuracy30: 0.4074 - val_accuracy50: 0.3959 - 8s/epoch - 22ms/step
Epoch 29/50
358/358 - 8s - loss: 12.6319 - accuracy10: 0.4422 - accuracy20: 0.4472 - accuracy30: 0.4450 - accuracy50: 0.4356 - val_loss: 13.0040 - val_accuracy10: 0.4059 - val_accuracy20: 0.4052 - val_accuracy30: 0.4001 - val_accuracy50: 0.3936 - 8s/epoch - 21ms/step
Epoch 30/50
358/358 - 7s - loss: 12.6172 - accuracy10: 0.4453 - accuracy20: 0.4501 - accuracy30: 0.4487 - accuracy50: 0.4362 - val_loss: 13.0102 - val_accuracy10: 0.4058 - val_accuracy20: 0.4013 - val_accuracy30: 0.3991 - val_accuracy50: 0.3919 - 7s/epoch - 21ms/step
Epoch 31/50
358/358 - 7s - loss: 12.5989 - accuracy10: 0.4472 - accuracy20: 0.4526 - accuracy30: 0.4512 - accuracy50: 0.4400 - val_loss: 13.0089 - val_accuracy10: 0.4070 - val_accuracy20: 0.4059 - val_accuracy30: 0.4024 - val_accuracy50: 0.3894 - 7s/epoch - 21ms/step
testing model: results/CHTR/W8/deepOF_L1/seq2seq
Evaluating performance on  test set...
1223/1223 - 12s - 12s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0730497
{'0': {'precision': 0.39489565544588845, 'recall': 0.5329082280335137, 'f1-score': 0.45363712687342583, 'support': 102406}, '1': {'precision': 0.41328560063643593, 'recall': 0.42126408713520885, 'f1-score': 0.41723670580504435, 'support': 108521}, '2': {'precision': 0.4482683443378597, 'recall': 0.2819365138441347, 'f1-score': 0.34615823998749373, 'support': 102101}, 'accuracy': 0.41234330475229053, 'macro avg': {'precision': 0.4188165334733947, 'recall': 0.4120362763376191, 'f1-score': 0.40567735755532136, 'support': 313028}, 'weighted avg': {'precision': 0.41867979025358154, 'recall': 0.41234330475229053, 'f1-score': 0.4059611620245868, 'support': 313028}}
[[54573 30047 17786]
 [45161 45716 17644]
 [38462 34853 28786]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0780543
{'0': {'precision': 0.39438458120417685, 'recall': 0.5445168711656442, 'f1-score': 0.4574474938796547, 'support': 104320}, '1': {'precision': 0.3931228515102583, 'recall': 0.36768371213876044, 'f1-score': 0.37997797673193856, 'support': 107927}, '2': {'precision': 0.43438202577402907, 'recall': 0.293319177225866, 'f1-score': 0.3501782816257389, 'support': 100781}, 'accuracy': 0.40267324328814036, 'macro avg': {'precision': 0.4072964861628214, 'recall': 0.40183992017675685, 'f1-score': 0.39586791741244404, 'support': 313028}, 'weighted avg': {'precision': 0.4068269434226325, 'recall': 0.40267324328814036, 'f1-score': 0.39620137194371463, 'support': 313028}}
[[56804 28755 18761]
 [48513 39683 19731]
 [38715 32505 29561]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0820636
{'0': {'precision': 0.3937338152783772, 'recall': 0.5492619874128637, 'f1-score': 0.4586722809884244, 'support': 106299}, '1': {'precision': 0.37529875188103035, 'recall': 0.3190300613266112, 'f1-score': 0.34488438777377833, 'support': 106316}, '2': {'precision': 0.42185735033080524, 'recall': 0.3124197066116937, 'f1-score': 0.35898316139995534, 'support': 100413}, 'accuracy': 0.39509245179344976, 'macro avg': {'precision': 0.39696330583007094, 'recall': 0.3935705851170563, 'f1-score': 0.3875132767207193, 'support': 313028}, 'weighted avg': {'precision': 0.39649403584991433, 'recall': 0.39509245179344976, 'f1-score': 0.3880474256392376, 'support': 313028}}
[[58386 27062 20851]
 [50256 33918 22142]
 [39646 29396 31371]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0871577
{'0': {'precision': 0.38689773049738996, 'recall': 0.5548541575968655, 'f1-score': 0.45589887749666597, 'support': 105662}, '1': {'precision': 0.3727278445185232, 'recall': 0.2711482850763205, 'f1-score': 0.3139253381080781, 'support': 109276}, '2': {'precision': 0.3959171727518841, 'recall': 0.3309817514527475, 'f1-score': 0.3605490527063946, 'support': 98090}, 'accuracy': 0.3856619855092835, 'macro avg': {'precision': 0.385180915922599, 'recall': 0.38566139804197785, 'f1-score': 0.37679108943704626, 'support': 313028}, 'weighted avg': {'precision': 0.3847774365636738, 'recall': 0.3856619855092835, 'f1-score': 0.3764581731382538, 'support': 313028}}
[[58627 24247 22788]
 [52898 29630 26748]
 [40006 25618 32466]]
Evaluating performance on  train set...
358/358 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0625556
{'0': {'precision': 0.42667542090700183, 'recall': 0.5790294351630867, 'f1-score': 0.4913123894641627, 'support': 31425}, '1': {'precision': 0.40526057587078756, 'recall': 0.355513622670242, 'f1-score': 0.3787606249779565, 'support': 30207}, '2': {'precision': 0.4501167385057471, 'recall': 0.3365788148396844, 'f1-score': 0.3851547342336285, 'support': 29785}, 'accuracy': 0.42617893827187503, 'macro avg': {'precision': 0.42735091176117884, 'recall': 0.4237072908910044, 'f1-score': 0.41840924955858255, 'support': 91417}, 'weighted avg': {'precision': 0.4272368199976492, 'recall': 0.42617893827187503, 'f1-score': 0.4195340888102767, 'support': 91417}}
[[18196  7055  6174]
 [13395 10739  6073]
 [11055  8705 10025]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0637003
{'0': {'precision': 0.42532274987454954, 'recall': 0.5937967710091393, 'f1-score': 0.49563426141271844, 'support': 31403}, '1': {'precision': 0.39334014300306436, 'recall': 0.31910238987039674, 'f1-score': 0.3523534148305395, 'support': 30169}, '2': {'precision': 0.45064935064935063, 'recall': 0.34880214441279944, 'f1-score': 0.3932382661252243, 'support': 29845}, 'accuracy': 0.4231598061629675, 'macro avg': {'precision': 0.42310408117565484, 'recall': 0.4205671017641118, 'f1-score': 0.41374198078949403, 'support': 91417}, 'weighted avg': {'precision': 0.42303640415568, 'recall': 0.4231598061629675, 'f1-score': 0.41492007980652895, 'support': 91417}}
[[18647  6548  6208]
 [14060  9627  6482]
 [11135  8300 10410]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0665922
{'0': {'precision': 0.42360533357317925, 'recall': 0.6005227758120557, 'f1-score': 0.4967828701017879, 'support': 31371}, '1': {'precision': 0.3856088560885609, 'recall': 0.2926975658552851, 'f1-score': 0.33278993062137474, 'support': 29990}, '2': {'precision': 0.44594706368899917, 'recall': 0.35876364120308757, 'f1-score': 0.3976325687735084, 'support': 30056}, 'accuracy': 0.4200531629784395, 'macro avg': {'precision': 0.4183870844502464, 'recall': 0.4173279942901427, 'f1-score': 0.4090684564988904, 'support': 91417}, 'weighted avg': {'precision': 0.4184858118277422, 'recall': 0.4200531629784395, 'f1-score': 0.410385266682945, 'support': 91417}}
[[18839  6182  6350]
 [14165  8778  7047]
 [11469  7804 10783]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0731251
{'0': {'precision': 0.41376388207484055, 'recall': 0.5953282423153436, 'f1-score': 0.4882117671824018, 'support': 31166}, '1': {'precision': 0.3792116377287658, 'recall': 0.26664686860687653, 'f1-score': 0.31311996280223187, 'support': 30306}, '2': {'precision': 0.4324559667524243, 'recall': 0.3648689263650025, 'f1-score': 0.3957978627060315, 'support': 29945}, 'accuracy': 0.41087543892273864, 'macro avg': {'precision': 0.4084771621853436, 'recall': 0.40894801242907425, 'f1-score': 0.39904319756355505, 'support': 91417}, 'weighted avg': {'precision': 0.40843220589336554, 'recall': 0.41087543892273864, 'f1-score': 0.3998948612120643, 'support': 91417}}
[[18554  5974  6638]
 [14524  8081  7701]
 [11764  7255 10926]]
Evaluating performance on  val set...
99/99 - 1s - 822ms/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0772238
{'0': {'precision': 0.4174352871169295, 'recall': 0.4943041691133294, 'f1-score': 0.45262931498010534, 'support': 8515}, '1': {'precision': 0.3745940093828943, 'recall': 0.3821327770278562, 'f1-score': 0.3783258413315514, 'support': 8149}, '2': {'precision': 0.429966477189914, 'recall': 0.3433026882346096, 'f1-score': 0.38177818040636724, 'support': 8593}, 'accuracy': 0.40673872589777094, 'macro avg': {'precision': 0.4073319245632459, 'recall': 0.406579878125265, 'f1-score': 0.40424444557267464, 'support': 25257}, 'weighted avg': {'precision': 0.4078762319655854, 'recall': 0.40673872589777094, 'f1-score': 0.40455065139558627, 'support': 25257}}
[[4209 2361 1945]
 [3069 3114 1966]
 [2805 2838 2950]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0773929
{'0': {'precision': 0.4172153831472469, 'recall': 0.5105687259138153, 'f1-score': 0.4591954626614852, 'support': 8563}, '1': {'precision': 0.3781860525294346, 'recall': 0.3496829764325876, 'f1-score': 0.3633764296369965, 'support': 8359}, '2': {'precision': 0.4243155057454958, 'recall': 0.3588482303539292, 'f1-score': 0.3888455538221529, 'support': 8335}, 'accuracy': 0.4072534346913727, 'macro avg': {'precision': 0.4065723138073924, 'recall': 0.406366644233444, 'f1-score': 0.4038058153735449, 'support': 25257}, 'weighted avg': {'precision': 0.4066414174039722, 'recall': 0.4072534346913727, 'f1-score': 0.4042674115379339, 'support': 25257}}
[[4372 2188 2003]
 [3381 2923 2055]
 [2726 2618 2991]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0777231
{'0': {'precision': 0.42063047938817383, 'recall': 0.5239312267657993, 'f1-score': 0.4666321779617176, 'support': 8608}, '1': {'precision': 0.3785515320334262, 'recall': 0.3242662848962062, 'f1-score': 0.3493124277085207, 'support': 8382}, '2': {'precision': 0.4152277362338545, 'recall': 0.369420587879521, 'f1-score': 0.39098706951734735, 'support': 8267}, 'accuracy': 0.40709506275487983, 'macro avg': {'precision': 0.4048032492184848, 'recall': 0.4058726998471755, 'f1-score': 0.4023105583958619, 'support': 25257}, 'weighted avg': {'precision': 0.4048974067990202, 'recall': 0.40709506275487983, 'f1-score': 0.40293766720699986, 'support': 25257}}
[[4510 2003 2095]
 [3458 2718 2206]
 [2754 2459 3054]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0832008
{'0': {'precision': 0.41048275862068967, 'recall': 0.5235749472202674, 'f1-score': 0.46018246482140096, 'support': 8526}, '1': {'precision': 0.37166691494115894, 'recall': 0.29215456674473067, 'f1-score': 0.3271487576214515, 'support': 8540}, '2': {'precision': 0.3974442560959708, 'recall': 0.3721157367842754, 'f1-score': 0.3843631778058008, 'support': 8191}, 'accuracy': 0.39620699212099614, 'macro avg': {'precision': 0.3931979765526064, 'recall': 0.39594841691642446, 'f1-score': 0.39056480008288447, 'support': 25257}, 'weighted avg': {'precision': 0.393129720682567, 'recall': 0.39620699212099614, 'f1-score': 0.39061190460315065, 'support': 25257}}
[[4464 1918 2144]
 [3568 2495 2477]
 [2843 2300 3048]]
training model: results/CHTR/W8/deepLOB_L2/seq2seq
Epoch 1/50
358/358 - 23s - loss: 13.2754 - accuracy10: 0.3499 - accuracy20: 0.3510 - accuracy30: 0.3503 - accuracy50: 0.3482 - val_loss: 13.3474 - val_accuracy10: 0.3269 - val_accuracy20: 0.3315 - val_accuracy30: 0.3328 - val_accuracy50: 0.3352 - 23s/epoch - 64ms/step
Epoch 2/50
358/358 - 17s - loss: 13.1421 - accuracy10: 0.3657 - accuracy20: 0.3687 - accuracy30: 0.3682 - accuracy50: 0.3642 - val_loss: 13.1739 - val_accuracy10: 0.3482 - val_accuracy20: 0.3489 - val_accuracy30: 0.3536 - val_accuracy50: 0.3530 - 17s/epoch - 46ms/step
Epoch 3/50
358/358 - 17s - loss: 13.0788 - accuracy10: 0.3832 - accuracy20: 0.3826 - accuracy30: 0.3793 - accuracy50: 0.3719 - val_loss: 13.1447 - val_accuracy10: 0.3568 - val_accuracy20: 0.3561 - val_accuracy30: 0.3571 - val_accuracy50: 0.3519 - 17s/epoch - 47ms/step
Epoch 4/50
358/358 - 17s - loss: 13.0340 - accuracy10: 0.3882 - accuracy20: 0.3904 - accuracy30: 0.3886 - accuracy50: 0.3822 - val_loss: 13.1551 - val_accuracy10: 0.3642 - val_accuracy20: 0.3615 - val_accuracy30: 0.3633 - val_accuracy50: 0.3597 - 17s/epoch - 47ms/step
Epoch 5/50
358/358 - 17s - loss: 13.0047 - accuracy10: 0.3953 - accuracy20: 0.3978 - accuracy30: 0.3954 - accuracy50: 0.3862 - val_loss: 13.1620 - val_accuracy10: 0.3645 - val_accuracy20: 0.3646 - val_accuracy30: 0.3629 - val_accuracy50: 0.3583 - 17s/epoch - 48ms/step
Epoch 6/50
358/358 - 17s - loss: 12.9641 - accuracy10: 0.4018 - accuracy20: 0.4038 - accuracy30: 0.4012 - accuracy50: 0.3937 - val_loss: 13.1815 - val_accuracy10: 0.3638 - val_accuracy20: 0.3651 - val_accuracy30: 0.3649 - val_accuracy50: 0.3579 - 17s/epoch - 46ms/step
Epoch 7/50
358/358 - 17s - loss: 12.9290 - accuracy10: 0.4097 - accuracy20: 0.4106 - accuracy30: 0.4092 - accuracy50: 0.4005 - val_loss: 13.2031 - val_accuracy10: 0.3592 - val_accuracy20: 0.3614 - val_accuracy30: 0.3636 - val_accuracy50: 0.3620 - 17s/epoch - 46ms/step
Epoch 8/50
358/358 - 17s - loss: 12.9084 - accuracy10: 0.4101 - accuracy20: 0.4130 - accuracy30: 0.4105 - accuracy50: 0.4003 - val_loss: 13.1487 - val_accuracy10: 0.3698 - val_accuracy20: 0.3699 - val_accuracy30: 0.3714 - val_accuracy50: 0.3678 - 17s/epoch - 48ms/step
Epoch 9/50
358/358 - 17s - loss: 12.8775 - accuracy10: 0.4163 - accuracy20: 0.4180 - accuracy30: 0.4159 - accuracy50: 0.4062 - val_loss: 13.1790 - val_accuracy10: 0.3716 - val_accuracy20: 0.3675 - val_accuracy30: 0.3696 - val_accuracy50: 0.3655 - 17s/epoch - 47ms/step
Epoch 10/50
358/358 - 17s - loss: 12.8547 - accuracy10: 0.4196 - accuracy20: 0.4224 - accuracy30: 0.4167 - accuracy50: 0.4073 - val_loss: 13.2634 - val_accuracy10: 0.3736 - val_accuracy20: 0.3711 - val_accuracy30: 0.3722 - val_accuracy50: 0.3667 - 17s/epoch - 47ms/step
Epoch 11/50
358/358 - 17s - loss: 12.8234 - accuracy10: 0.4232 - accuracy20: 0.4248 - accuracy30: 0.4214 - accuracy50: 0.4115 - val_loss: 13.3272 - val_accuracy10: 0.3652 - val_accuracy20: 0.3638 - val_accuracy30: 0.3657 - val_accuracy50: 0.3616 - 17s/epoch - 47ms/step
Epoch 12/50
358/358 - 17s - loss: 12.7993 - accuracy10: 0.4261 - accuracy20: 0.4281 - accuracy30: 0.4238 - accuracy50: 0.4129 - val_loss: 13.4238 - val_accuracy10: 0.3593 - val_accuracy20: 0.3625 - val_accuracy30: 0.3657 - val_accuracy50: 0.3633 - 17s/epoch - 46ms/step
Epoch 13/50
358/358 - 17s - loss: 12.7769 - accuracy10: 0.4301 - accuracy20: 0.4305 - accuracy30: 0.4264 - accuracy50: 0.4159 - val_loss: 13.3779 - val_accuracy10: 0.3644 - val_accuracy20: 0.3666 - val_accuracy30: 0.3691 - val_accuracy50: 0.3653 - 17s/epoch - 46ms/step
testing model: results/CHTR/W8/deepLOB_L2/seq2seq
Evaluating performance on  test set...
1223/1223 - 23s - 23s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0950942
{'0': {'precision': 0.37373862185427736, 'recall': 0.2658216723466169, 'f1-score': 0.3106754011549611, 'support': 102407}, '1': {'precision': 0.34716240709024093, 'recall': 0.5771495443362237, 'f1-score': 0.4335432961860594, 'support': 108523}, '2': {'precision': 0.38970206928854617, 'recall': 0.22816175822453796, 'f1-score': 0.2878145809910923, 'support': 102103}, 'accuracy': 0.3614698769778266, 'macro avg': {'precision': 0.37020103274435484, 'recall': 0.3570443249691262, 'f1-score': 0.34401109277737096, 'support': 313033}, 'weighted avg': {'precision': 0.36973196862137103, 'recall': 0.3614698769778266, 'f1-score': 0.3458149367670799, 'support': 313033}}
[[27222 58338 16847]
 [26253 62634 19636]
 [19362 59445 23296]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0942078
{'0': {'precision': 0.38607900139154877, 'recall': 0.26861064780199767, 'f1-score': 0.3168063854202586, 'support': 104322}, '1': {'precision': 0.3462652539759461, 'recall': 0.5826067619780037, 'f1-score': 0.4343687288226334, 'support': 107927}, '2': {'precision': 0.3830445124023106, 'recall': 0.22370614383235435, 'f1-score': 0.2824534589461552, 'support': 100784}, 'accuracy': 0.3624122696329141, 'macro avg': {'precision': 0.3717962559232684, 'recall': 0.3583078512041186, 'f1-score': 0.34454285772968235, 'support': 313033}, 'weighted avg': {'precision': 0.3713751003472016, 'recall': 0.3624122696329141, 'f1-score': 0.34627907901685084, 'support': 313033}}
[[28022 59272 17028]
 [25762 62879 19286]
 [18797 59441 22546]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0957992
{'0': {'precision': 0.3962242964418556, 'recall': 0.2655572384079171, 'f1-score': 0.3179908305453235, 'support': 106301}, '1': {'precision': 0.3409090909090909, 'recall': 0.5896102185936265, 'f1-score': 0.432024314936318, 'support': 106316}, '2': {'precision': 0.36959524796242577, 'recall': 0.21315328234544295, 'f1-score': 0.27037542317214897, 'support': 100416}, 'accuracy': 0.35880562113259623, 'macro avg': {'precision': 0.36890954510445745, 'recall': 0.3561069131156622, 'f1-score': 0.34013018955126345, 'support': 313033}, 'weighted avg': {'precision': 0.36889531220207306, 'recall': 0.3588056211325962, 'f1-score': 0.3414459780209196, 'support': 313033}}
[[28229 60657 17415]
 [24538 62685 19093]
 [18478 60534 21404]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0962282
{'0': {'precision': 0.3927410079093478, 'recall': 0.26175423985463353, 'f1-score': 0.3141401693481063, 'support': 105664}, '1': {'precision': 0.3505411033545171, 'recall': 0.5946027562729919, 'f1-score': 0.4410602769481401, 'support': 109278}, '2': {'precision': 0.34385480715483513, 'recall': 0.20068100029564384, 'f1-score': 0.25344568974951565, 'support': 98091}, 'accuracy': 0.3588120102353426, 'macro avg': {'precision': 0.3623789728062334, 'recall': 0.3523459988077564, 'f1-score': 0.33621537868192064, 'support': 313033}, 'weighted avg': {'precision': 0.3626904461853325, 'recall': 0.3588120102353426, 'f1-score': 0.33942821667861506, 'support': 313033}}
[[27658 60299 17707]
 [24445 64977 19856]
 [18320 60086 19685]]
Evaluating performance on  train set...
358/358 - 6s - 6s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0945967
{'0': {'precision': 0.4070263488080301, 'recall': 0.35962245027239326, 'f1-score': 0.3818588460827013, 'support': 31572}, '1': {'precision': 0.33899077118073434, 'recall': 0.5684067211263863, 'f1-score': 0.42469730051607785, 'support': 30114}, '2': {'precision': 0.4006907137375288, 'recall': 0.17559613897016782, 'f1-score': 0.24418305544512778, 'support': 29733}, 'accuracy': 0.36854483203710386, 'macro avg': {'precision': 0.3822359445754311, 'recall': 0.36787510345631586, 'f1-score': 0.35024640068130236, 'support': 91419}, 'weighted avg': {'precision': 0.38255440290816684, 'recall': 0.36854483203710386, 'f1-score': 0.35119260529883506, 'support': 91419}}
[[11354 16567  3651]
 [ 8839 17117  4158]
 [ 7702 16810  5221]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0935065
{'0': {'precision': 0.40522182126936956, 'recall': 0.36402351819481965, 'f1-score': 0.3835194455140547, 'support': 31465}, '1': {'precision': 0.3361139048295174, 'recall': 0.5663399235753448, 'f1-score': 0.4218603039453493, 'support': 30095}, '2': {'precision': 0.3986660237865638, 'recall': 0.1661475601996048, 'f1-score': 0.23454601328510982, 'support': 29859}, 'accuracy': 0.36599612771962065, 'macro avg': {'precision': 0.3800005832951503, 'recall': 0.3655036673232564, 'f1-score': 0.3466419209148379, 'support': 91419}, 'weighted avg': {'precision': 0.3803303621383744, 'recall': 0.36599612771962065, 'f1-score': 0.3474839432832903, 'support': 91419}}
[[11454 16541  3470]
 [ 9038 17044  4013]
 [ 7774 17124  4961]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0939193
{'0': {'precision': 0.40228712174524983, 'recall': 0.36437517927144086, 'f1-score': 0.38239376557352384, 'support': 31377}, '1': {'precision': 0.3358009258354982, 'recall': 0.5723798108935944, 'f1-score': 0.4232762547240653, 'support': 30036}, '2': {'precision': 0.39586510760887983, 'recall': 0.15570219289475437, 'f1-score': 0.22349789513968615, 'support': 30006}, 'accuracy': 0.36422406720703576, 'macro avg': {'precision': 0.37798438506320925, 'recall': 0.3641523943532632, 'f1-score': 0.3430559718124251, 'support': 91419}, 'weighted avg': {'precision': 0.37833500745258397, 'recall': 0.36422406720703576, 'f1-score': 0.3436722411189568, 'support': 91419}}
[[11433 16603  3341]
 [ 9055 17192  3789]
 [ 7932 17402  4672]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0954543
{'0': {'precision': 0.39443489245236674, 'recall': 0.35979259354095317, 'f1-score': 0.37631816812292856, 'support': 31243}, '1': {'precision': 0.3377100126250364, 'recall': 0.5747578592443225, 'f1-score': 0.42544288930214347, 'support': 30251}, '2': {'precision': 0.37962396152164407, 'recall': 0.145062656641604, 'f1-score': 0.20991295938104446, 'support': 29925}, 'accuracy': 0.3606361916013083, 'macro avg': {'precision': 0.37058962219968244, 'recall': 0.35987103647562657, 'f1-score': 0.3372246722687055, 'support': 91419}, 'weighted avg': {'precision': 0.37081615403083024, 'recall': 0.3606361916013083, 'f1-score': 0.338102874461781, 'support': 91419}}
[[11241 16694  3308]
 [ 9078 17387  3786]
 [ 8180 17404  4341]]
Evaluating performance on  val set...
99/99 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0965141
{'0': {'precision': 0.3908085300490364, 'recall': 0.401288056206089, 'f1-score': 0.39597897047778613, 'support': 8540}, '1': {'precision': 0.3183512544802867, 'recall': 0.5447074696430761, 'f1-score': 0.40184590327104913, 'support': 8153}, '2': {'precision': 0.4056715242221347, 'recall': 0.12025685931115003, 'f1-score': 0.18551873198847263, 'support': 8565}, 'accuracy': 0.35228442473671706, 'macro avg': {'precision': 0.37161043625048595, 'recall': 0.3554174617201051, 'f1-score': 0.327781201912436, 'support': 25258}, 'weighted avg': {'precision': 0.3724601801155726, 'recall': 0.35228442473671706, 'f1-score': 0.3265055822602908, 'support': 25258}}
[[3427 4490  623]
 [2826 4441  886]
 [2516 5019 1030]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0944563
{'0': {'precision': 0.39696084161309175, 'recall': 0.3944709025438495, 'f1-score': 0.39571195525518527, 'support': 8609}, '1': {'precision': 0.3255573193457105, 'recall': 0.568792957916315, 'f1-score': 0.41409884996927404, 'support': 8293}, '2': {'precision': 0.3879855465221319, 'recall': 0.10280038295835328, 'f1-score': 0.16253547776726587, 'support': 8356}, 'accuracy': 0.3552141895637026, 'macro avg': {'precision': 0.3701679024936448, 'recall': 0.35535474780617254, 'f1-score': 0.3241154276639084, 'support': 25258}, 'weighted avg': {'precision': 0.37054754776783666, 'recall': 0.3552141895637026, 'f1-score': 0.32460814149221445, 'support': 25258}}
[[3396 4623  590]
 [2811 4717  765]
 [2348 5149  859]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0936991
{'0': {'precision': 0.40099309676638006, 'recall': 0.3834394904458599, 'f1-score': 0.39201989107269714, 'support': 8635}, '1': {'precision': 0.3293914429976083, 'recall': 0.5914350471191697, 'f1-score': 0.42312780029869856, 'support': 8383}, '2': {'precision': 0.3832734735761929, 'recall': 0.09065533980582524, 'f1-score': 0.14662871724408674, 'support': 8240}, 'accuracy': 0.35695621189326154, 'macro avg': {'precision': 0.3712193377800604, 'recall': 0.3551766257902849, 'f1-score': 0.32059213620516086, 'support': 25258}, 'weighted avg': {'precision': 0.3714481463098611, 'recall': 0.35695621189326154, 'f1-score': 0.32228968007791614, 'support': 25258}}
[[3311 4800  524]
 [2747 4958  678]
 [2199 5294  747]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0944635
{'0': {'precision': 0.38797476184584934, 'recall': 0.36682652941864546, 'f1-score': 0.3771043771043771, 'support': 8549}, '1': {'precision': 0.3382496264050419, 'recall': 0.6118227758843577, 'f1-score': 0.43564853556485356, 'support': 8509}, '2': {'precision': 0.39181614349775784, 'recall': 0.0852439024390244, 'f1-score': 0.14002403846153846, 'support': 8200}, 'accuracy': 0.35794599730778365, 'macro avg': {'precision': 0.37268017724954966, 'recall': 0.3546310692473425, 'f1-score': 0.3175923170435897, 'support': 25258}, 'weighted avg': {'precision': 0.37247029403683113, 'recall': 0.35794599730778365, 'f1-score': 0.31985888923791567, 'support': 25258}}
[[3136 4948  465]
 [2683 5206  620]
 [2264 5237  699]]
training model: results/CHTR/W8/deepOF_L2/seq2seq
Epoch 1/50
358/358 - 16s - loss: 13.1728 - accuracy10: 0.3693 - accuracy20: 0.3727 - accuracy30: 0.3738 - accuracy50: 0.3691 - val_loss: 13.1400 - val_accuracy10: 0.3542 - val_accuracy20: 0.3561 - val_accuracy30: 0.3534 - val_accuracy50: 0.3577 - 16s/epoch - 45ms/step
Epoch 2/50
358/358 - 10s - loss: 13.0362 - accuracy10: 0.3861 - accuracy20: 0.3904 - accuracy30: 0.3898 - accuracy50: 0.3860 - val_loss: 13.0322 - val_accuracy10: 0.3792 - val_accuracy20: 0.3813 - val_accuracy30: 0.3842 - val_accuracy50: 0.3797 - 10s/epoch - 29ms/step
Epoch 3/50
358/358 - 10s - loss: 12.9658 - accuracy10: 0.3958 - accuracy20: 0.3997 - accuracy30: 0.3999 - accuracy50: 0.3960 - val_loss: 12.9955 - val_accuracy10: 0.3969 - val_accuracy20: 0.3947 - val_accuracy30: 0.3955 - val_accuracy50: 0.3866 - 10s/epoch - 29ms/step
Epoch 4/50
358/358 - 11s - loss: 12.9164 - accuracy10: 0.4059 - accuracy20: 0.4079 - accuracy30: 0.4073 - accuracy50: 0.4008 - val_loss: 12.9794 - val_accuracy10: 0.3955 - val_accuracy20: 0.3951 - val_accuracy30: 0.3970 - val_accuracy50: 0.3916 - 11s/epoch - 30ms/step
Epoch 5/50
358/358 - 10s - loss: 12.8777 - accuracy10: 0.4135 - accuracy20: 0.4152 - accuracy30: 0.4124 - accuracy50: 0.4036 - val_loss: 12.9696 - val_accuracy10: 0.3991 - val_accuracy20: 0.3997 - val_accuracy30: 0.4008 - val_accuracy50: 0.3913 - 10s/epoch - 29ms/step
Epoch 6/50
358/358 - 10s - loss: 12.8437 - accuracy10: 0.4179 - accuracy20: 0.4204 - accuracy30: 0.4177 - accuracy50: 0.4086 - val_loss: 12.9582 - val_accuracy10: 0.4044 - val_accuracy20: 0.4035 - val_accuracy30: 0.4023 - val_accuracy50: 0.3947 - 10s/epoch - 29ms/step
Epoch 7/50
358/358 - 10s - loss: 12.8106 - accuracy10: 0.4229 - accuracy20: 0.4252 - accuracy30: 0.4217 - accuracy50: 0.4101 - val_loss: 12.9428 - val_accuracy10: 0.4054 - val_accuracy20: 0.4080 - val_accuracy30: 0.4075 - val_accuracy50: 0.3964 - 10s/epoch - 29ms/step
Epoch 8/50
358/358 - 10s - loss: 12.7784 - accuracy10: 0.4281 - accuracy20: 0.4302 - accuracy30: 0.4274 - accuracy50: 0.4147 - val_loss: 12.9624 - val_accuracy10: 0.4050 - val_accuracy20: 0.4028 - val_accuracy30: 0.4037 - val_accuracy50: 0.3939 - 10s/epoch - 28ms/step
Epoch 9/50
358/358 - 10s - loss: 12.7459 - accuracy10: 0.4313 - accuracy20: 0.4345 - accuracy30: 0.4308 - accuracy50: 0.4176 - val_loss: 12.9564 - val_accuracy10: 0.4056 - val_accuracy20: 0.4005 - val_accuracy30: 0.4032 - val_accuracy50: 0.3950 - 10s/epoch - 29ms/step
Epoch 10/50
358/358 - 11s - loss: 12.7174 - accuracy10: 0.4347 - accuracy20: 0.4376 - accuracy30: 0.4333 - accuracy50: 0.4205 - val_loss: 12.9782 - val_accuracy10: 0.4067 - val_accuracy20: 0.4031 - val_accuracy30: 0.4030 - val_accuracy50: 0.3924 - 11s/epoch - 30ms/step
Epoch 11/50
358/358 - 10s - loss: 12.6785 - accuracy10: 0.4393 - accuracy20: 0.4411 - accuracy30: 0.4392 - accuracy50: 0.4251 - val_loss: 12.9868 - val_accuracy10: 0.4082 - val_accuracy20: 0.4015 - val_accuracy30: 0.4025 - val_accuracy50: 0.3937 - 10s/epoch - 29ms/step
Epoch 12/50
358/358 - 10s - loss: 12.6542 - accuracy10: 0.4403 - accuracy20: 0.4445 - accuracy30: 0.4420 - accuracy50: 0.4269 - val_loss: 13.0030 - val_accuracy10: 0.4033 - val_accuracy20: 0.4020 - val_accuracy30: 0.4002 - val_accuracy50: 0.3939 - 10s/epoch - 29ms/step
Epoch 13/50
358/358 - 10s - loss: 12.6236 - accuracy10: 0.4442 - accuracy20: 0.4470 - accuracy30: 0.4449 - accuracy50: 0.4302 - val_loss: 13.0155 - val_accuracy10: 0.4034 - val_accuracy20: 0.4004 - val_accuracy30: 0.3980 - val_accuracy50: 0.3922 - 10s/epoch - 29ms/step
Epoch 14/50
358/358 - 10s - loss: 12.5846 - accuracy10: 0.4495 - accuracy20: 0.4534 - accuracy30: 0.4493 - accuracy50: 0.4352 - val_loss: 13.0141 - val_accuracy10: 0.4062 - val_accuracy20: 0.4027 - val_accuracy30: 0.4025 - val_accuracy50: 0.3961 - 10s/epoch - 29ms/step
Epoch 15/50
358/358 - 10s - loss: 12.5444 - accuracy10: 0.4507 - accuracy20: 0.4554 - accuracy30: 0.4545 - accuracy50: 0.4400 - val_loss: 13.0499 - val_accuracy10: 0.4015 - val_accuracy20: 0.3992 - val_accuracy30: 0.3961 - val_accuracy50: 0.3892 - 10s/epoch - 29ms/step
Epoch 16/50
358/358 - 11s - loss: 12.5210 - accuracy10: 0.4538 - accuracy20: 0.4581 - accuracy30: 0.4564 - accuracy50: 0.4408 - val_loss: 13.0503 - val_accuracy10: 0.4028 - val_accuracy20: 0.4009 - val_accuracy30: 0.4012 - val_accuracy50: 0.3903 - 11s/epoch - 30ms/step
Epoch 17/50
358/358 - 10s - loss: 12.4846 - accuracy10: 0.4555 - accuracy20: 0.4613 - accuracy30: 0.4601 - accuracy50: 0.4456 - val_loss: 13.0768 - val_accuracy10: 0.4078 - val_accuracy20: 0.4049 - val_accuracy30: 0.4056 - val_accuracy50: 0.3944 - 10s/epoch - 29ms/step
testing model: results/CHTR/W8/deepOF_L2/seq2seq
Evaluating performance on  test set...
1223/1223 - 13s - 13s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0767566
{'0': {'precision': 0.38624271767178314, 'recall': 0.5671249731461048, 'f1-score': 0.45952446888475695, 'support': 102406}, '1': {'precision': 0.41894571487433047, 'recall': 0.2998221542374287, 'f1-score': 0.34951258157209225, 'support': 108521}, '2': {'precision': 0.41896470588235296, 'recall': 0.3487918825476734, 'f1-score': 0.3806714020769531, 'support': 102101}, 'accuracy': 0.40324188251530213, 'macro avg': {'precision': 0.40805104614282217, 'recall': 0.4052463366437356, 'f1-score': 0.3965694841779341, 'support': 313028}, 'weighted avg': {'precision': 0.4082532396624837, 'recall': 0.40324188251530213, 'f1-score': 0.39566571823880436, 'support': 313028}}
[[58077 21069 23260]
 [49856 32537 26128]
 [42431 24058 35612]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0802374
{'0': {'precision': 0.38538275553524853, 'recall': 0.5821414877300614, 'f1-score': 0.4637553884864892, 'support': 104320}, '1': {'precision': 0.4023048952730114, 'recall': 0.24808435331288742, 'f1-score': 0.3069102079882623, 'support': 107927}, '2': {'precision': 0.4086036020834036, 'recall': 0.36040523511376155, 'f1-score': 0.3829939791431614, 'support': 100781}, 'accuracy': 0.3955748367558174, 'macro avg': {'precision': 0.3987637509638879, 'recall': 0.3968770253855702, 'f1-score': 0.38455319187263765, 'support': 313028}, 'weighted avg': {'precision': 0.3986933089408453, 'recall': 0.3955748367558174, 'f1-score': 0.38367614512595255, 'support': 313028}}
[[60729 18933 24658]
 [53239 26775 27913]
 [43613 20846 36322]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0831478
{'0': {'precision': 0.3870552519732848, 'recall': 0.5997046068166211, 'f1-score': 0.47046668068885866, 'support': 106299}, '1': {'precision': 0.38541463846358087, 'recall': 0.20480454494149516, 'f1-score': 0.26747578480569495, 'support': 106316}, '2': {'precision': 0.4013045419402611, 'recall': 0.36701423122504057, 'f1-score': 0.38339419285706855, 'support': 100413}, 'accuracy': 0.39093946867372886, 'macro avg': {'precision': 0.391258144125709, 'recall': 0.3905077943277189, 'f1-score': 0.3737788861172074, 'support': 313028}, 'weighted avg': {'precision': 0.3910689200398996, 'recall': 0.39093946867372886, 'f1-score': 0.3735923122382154, 'support': 313028}}
[[63748 16744 25807]
 [55369 21774 29173]
 [45583 17977 36853]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0880383
{'0': {'precision': 0.38066814514226394, 'recall': 0.6108156196172702, 'f1-score': 0.46903047171936657, 'support': 105662}, '1': {'precision': 0.3810080437452946, 'recall': 0.17598557780299426, 'f1-score': 0.24076369327073555, 'support': 109276}, '2': {'precision': 0.3837974411353618, 'recall': 0.36392088897950864, 'f1-score': 0.37359497645211937, 'support': 98090}, 'accuracy': 0.38165275949755295, 'macro avg': {'precision': 0.38182454334097343, 'recall': 0.38357402879992436, 'f1-score': 0.3611297138140738, 'support': 313028}, 'weighted avg': {'precision': 0.3817673931447038, 'recall': 0.38165275949755295, 'f1-score': 0.359438523994189, 'support': 313028}}
[[64540 15023 26099]
 [58831 19231 31214]
 [46173 16220 35697]]
Evaluating performance on  train set...
358/358 - 4s - 4s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0645185
{'0': {'precision': 0.4155188658082462, 'recall': 0.5894351630867144, 'f1-score': 0.4874281278370591, 'support': 31425}, '1': {'precision': 0.4092605079793212, 'recall': 0.30138709570629324, 'f1-score': 0.3471364294974453, 'support': 30207}, '2': {'precision': 0.442343661055542, 'recall': 0.36525096525096523, 'f1-score': 0.40011769249158685, 'support': 29785}, 'accuracy': 0.4212126847304112, 'macro avg': {'precision': 0.42237434494770315, 'recall': 0.4186910746813243, 'f1-score': 0.4115607499420304, 'support': 91417}, 'weighted avg': {'precision': 0.42219082300988664, 'recall': 0.4212126847304112, 'f1-score': 0.4126243971468198, 'support': 91417}}
[[18523  6111  6791]
 [14179  9104  6924]
 [11876  7030 10879]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.067213
{'0': {'precision': 0.41319243078377044, 'recall': 0.612584784893163, 'f1-score': 0.4935094920472037, 'support': 31403}, '1': {'precision': 0.39651758972536677, 'recall': 0.25890815075077067, 'f1-score': 0.31326702494585706, 'support': 30169}, '2': {'precision': 0.442788442430746, 'recall': 0.3732953593566762, 'f1-score': 0.40508308184561687, 'support': 29845}, 'accuracy': 0.41774505835894854, 'macro avg': {'precision': 0.41749948764662775, 'recall': 0.41492943166686996, 'f1-score': 0.4039531996128925, 'support': 91417}, 'weighted avg': {'precision': 0.41735171940309734, 'recall': 0.41774505835894854, 'f1-score': 0.405158078169622, 'support': 91417}}
[[19237  5407  6759]
 [15097  7811  7261]
 [12223  6481 11141]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0706286
{'0': {'precision': 0.4105073290071113, 'recall': 0.6311561633355647, 'f1-score': 0.4974624390734134, 'support': 31371}, '1': {'precision': 0.3919578262576412, 'recall': 0.2330443481160387, 'f1-score': 0.2922983626440267, 'support': 29990}, '2': {'precision': 0.44199897448033765, 'recall': 0.3728373702422145, 'f1-score': 0.4044830262231767, 'support': 30056}, 'accuracy': 0.41562291477515123, 'macro avg': {'precision': 0.41482137658169665, 'recall': 0.412345960564606, 'f1-score': 0.39808127598020565, 'support': 91417}, 'weighted avg': {'precision': 0.4147758273048752, 'recall': 0.41562291477515123, 'f1-score': 0.3995872092502512, 'support': 91417}}
[[19800  4876  6695]
 [15549  6989  7452]
 [12884  5966 11206]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0766569
{'0': {'precision': 0.4028552308721838, 'recall': 0.6374253994737855, 'f1-score': 0.49369400713229533, 'support': 31166}, '1': {'precision': 0.38390037537984867, 'recall': 0.2125981653797928, 'f1-score': 0.27365202064176347, 'support': 30306}, '2': {'precision': 0.4230875557837368, 'recall': 0.3577558857906161, 'f1-score': 0.38768863315600915, 'support': 29945}, 'accuracy': 0.40497938020280694, 'macro avg': {'precision': 0.4032810540119231, 'recall': 0.40259315021473147, 'f1-score': 0.385011553643356, 'support': 91417}, 'weighted avg': {'precision': 0.4031988334726383, 'recall': 0.40497938020280694, 'f1-score': 0.3860234057528807, 'support': 91417}}
[[19866  4502  6798]
 [16053  6443  7810]
 [13394  5838 10713]]
Evaluating performance on  val set...
99/99 - 1s - 1s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0751443
{'0': {'precision': 0.40644091464478965, 'recall': 0.5469172049324721, 'f1-score': 0.46632954488559547, 'support': 8515}, '1': {'precision': 0.3807565789473684, 'recall': 0.28408393667934717, 'f1-score': 0.3253918054677068, 'support': 8149}, '2': {'precision': 0.42673921492421296, 'recall': 0.3833352728965437, 'f1-score': 0.40387444825895047, 'support': 8593}, 'accuracy': 0.40646157500890845, 'macro avg': {'precision': 0.404645569505457, 'recall': 0.404778804836121, 'f1-score': 0.3985319328707509, 'support': 25257}, 'weighted avg': {'precision': 0.40505997639807784, 'recall': 0.40646157500890845, 'f1-score': 0.3996083078491646, 'support': 25257}}
[[4657 1695 2163]
 [3572 2315 2262]
 [3229 2070 3294]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.076593
{'0': {'precision': 0.40747850763709204, 'recall': 0.570127291836973, 'f1-score': 0.47527258566978187, 'support': 8563}, '1': {'precision': 0.39170169987205267, 'recall': 0.25637037923196554, 'f1-score': 0.30990600144613156, 'support': 8359}, '2': {'precision': 0.4193465727098014, 'recall': 0.39268146370725854, 'f1-score': 0.40557620817843865, 'support': 8335}, 'accuracy': 0.4077285505008513, 'macro avg': {'precision': 0.40617559340631537, 'recall': 0.40639304492539896, 'f1-score': 0.39691826509811734, 'support': 25257}, 'weighted avg': {'precision': 0.40617360152286897, 'recall': 0.4077285505008513, 'f1-score': 0.39754290344640464, 'support': 25257}}
[[4882 1497 2184]
 [3868 2143 2348]
 [3231 1831 3273]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0768055
{'0': {'precision': 0.4075700710692326, 'recall': 0.5929368029739777, 'f1-score': 0.4830817282665278, 'support': 8608}, '1': {'precision': 0.39898477157360407, 'recall': 0.23443092340730137, 'f1-score': 0.2953332832343879, 'support': 8382}, '2': {'precision': 0.4091432961966961, 'recall': 0.38647635176000966, 'f1-score': 0.3974869370490172, 'support': 8267}, 'accuracy': 0.406382389040662, 'macro avg': {'precision': 0.4052327129465109, 'recall': 0.4046146927137629, 'f1-score': 0.391967316183311, 'support': 25257}, 'weighted avg': {'precision': 0.405235822019717, 'recall': 0.406382389040662, 'f1-score': 0.39275747735570876, 'support': 25257}}
[[5104 1309 2195]
 [3998 1965 2419]
 [3421 1651 3195]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0817937
{'0': {'precision': 0.3963452566096423, 'recall': 0.5978184377199156, 'f1-score': 0.47666697839708216, 'support': 8526}, '1': {'precision': 0.3899141630901288, 'recall': 0.21276346604215457, 'f1-score': 0.2753030303030303, 'support': 8540}, '2': {'precision': 0.39989660074964456, 'recall': 0.3777316566963741, 'f1-score': 0.38849824208940226, 'support': 8191}, 'accuracy': 0.3962465851051194, 'macro avg': {'precision': 0.39538534014980525, 'recall': 0.3961045201528148, 'f1-score': 0.38015608359650493, 'support': 25257}, 'weighted avg': {'precision': 0.39532247168641754, 'recall': 0.3962465851051194, 'f1-score': 0.379987315894829, 'support': 25257}}
[[5097 1265 2164]
 [4244 1817 2479]
 [3519 1578 3094]]
training model: results/CHTR/W8/deepVOL_L2/seq2seq
Epoch 1/50
358/358 - 17s - loss: 13.2285 - accuracy10: 0.3545 - accuracy20: 0.3579 - accuracy30: 0.3600 - accuracy50: 0.3578 - val_loss: 13.6644 - val_accuracy10: 0.3289 - val_accuracy20: 0.3347 - val_accuracy30: 0.3365 - val_accuracy50: 0.3440 - 17s/epoch - 46ms/step
Epoch 2/50
358/358 - 10s - loss: 13.1535 - accuracy10: 0.3661 - accuracy20: 0.3682 - accuracy30: 0.3671 - accuracy50: 0.3627 - val_loss: 13.4288 - val_accuracy10: 0.3353 - val_accuracy20: 0.3410 - val_accuracy30: 0.3425 - val_accuracy50: 0.3472 - 10s/epoch - 29ms/step
Epoch 3/50
358/358 - 10s - loss: 13.1320 - accuracy10: 0.3663 - accuracy20: 0.3705 - accuracy30: 0.3720 - accuracy50: 0.3693 - val_loss: 13.5565 - val_accuracy10: 0.3400 - val_accuracy20: 0.3440 - val_accuracy30: 0.3463 - val_accuracy50: 0.3485 - 10s/epoch - 29ms/step
Epoch 4/50
358/358 - 11s - loss: 13.0973 - accuracy10: 0.3748 - accuracy20: 0.3786 - accuracy30: 0.3774 - accuracy50: 0.3701 - val_loss: 13.4766 - val_accuracy10: 0.3455 - val_accuracy20: 0.3453 - val_accuracy30: 0.3479 - val_accuracy50: 0.3483 - 11s/epoch - 29ms/step
Epoch 5/50
358/358 - 10s - loss: 13.0791 - accuracy10: 0.3805 - accuracy20: 0.3824 - accuracy30: 0.3821 - accuracy50: 0.3744 - val_loss: 13.3917 - val_accuracy10: 0.3570 - val_accuracy20: 0.3553 - val_accuracy30: 0.3537 - val_accuracy50: 0.3527 - 10s/epoch - 28ms/step
Epoch 6/50
358/358 - 10s - loss: 13.0628 - accuracy10: 0.3859 - accuracy20: 0.3877 - accuracy30: 0.3858 - accuracy50: 0.3783 - val_loss: 13.4253 - val_accuracy10: 0.3612 - val_accuracy20: 0.3560 - val_accuracy30: 0.3555 - val_accuracy50: 0.3532 - 10s/epoch - 28ms/step
Epoch 7/50
358/358 - 10s - loss: 13.0439 - accuracy10: 0.3890 - accuracy20: 0.3895 - accuracy30: 0.3872 - accuracy50: 0.3781 - val_loss: 13.6434 - val_accuracy10: 0.3547 - val_accuracy20: 0.3564 - val_accuracy30: 0.3566 - val_accuracy50: 0.3548 - 10s/epoch - 28ms/step
Epoch 8/50
358/358 - 10s - loss: 13.0349 - accuracy10: 0.3905 - accuracy20: 0.3909 - accuracy30: 0.3887 - accuracy50: 0.3801 - val_loss: 13.4591 - val_accuracy10: 0.3645 - val_accuracy20: 0.3634 - val_accuracy30: 0.3602 - val_accuracy50: 0.3577 - 10s/epoch - 29ms/step
Epoch 9/50
358/358 - 11s - loss: 13.0238 - accuracy10: 0.3931 - accuracy20: 0.3945 - accuracy30: 0.3920 - accuracy50: 0.3834 - val_loss: 13.3256 - val_accuracy10: 0.3721 - val_accuracy20: 0.3678 - val_accuracy30: 0.3662 - val_accuracy50: 0.3610 - 11s/epoch - 30ms/step
Epoch 10/50
358/358 - 11s - loss: 13.0179 - accuracy10: 0.3958 - accuracy20: 0.3944 - accuracy30: 0.3918 - accuracy50: 0.3827 - val_loss: 13.4733 - val_accuracy10: 0.3661 - val_accuracy20: 0.3651 - val_accuracy30: 0.3625 - val_accuracy50: 0.3584 - 11s/epoch - 31ms/step
Epoch 11/50
358/358 - 10s - loss: 13.0000 - accuracy10: 0.3986 - accuracy20: 0.3978 - accuracy30: 0.3939 - accuracy50: 0.3847 - val_loss: 13.5181 - val_accuracy10: 0.3676 - val_accuracy20: 0.3621 - val_accuracy30: 0.3608 - val_accuracy50: 0.3611 - 10s/epoch - 28ms/step
Epoch 12/50
358/358 - 10s - loss: 12.9942 - accuracy10: 0.3995 - accuracy20: 0.3986 - accuracy30: 0.3960 - accuracy50: 0.3845 - val_loss: 13.3089 - val_accuracy10: 0.3732 - val_accuracy20: 0.3706 - val_accuracy30: 0.3677 - val_accuracy50: 0.3619 - 10s/epoch - 28ms/step
Epoch 13/50
358/358 - 10s - loss: 12.9851 - accuracy10: 0.3990 - accuracy20: 0.4021 - accuracy30: 0.3986 - accuracy50: 0.3881 - val_loss: 13.3706 - val_accuracy10: 0.3695 - val_accuracy20: 0.3650 - val_accuracy30: 0.3644 - val_accuracy50: 0.3596 - 10s/epoch - 29ms/step
Epoch 14/50
358/358 - 10s - loss: 12.9751 - accuracy10: 0.4016 - accuracy20: 0.4020 - accuracy30: 0.3979 - accuracy50: 0.3887 - val_loss: 13.3367 - val_accuracy10: 0.3753 - val_accuracy20: 0.3697 - val_accuracy30: 0.3668 - val_accuracy50: 0.3598 - 10s/epoch - 28ms/step
Epoch 15/50
358/358 - 11s - loss: 12.9614 - accuracy10: 0.4036 - accuracy20: 0.4054 - accuracy30: 0.4023 - accuracy50: 0.3916 - val_loss: 13.2145 - val_accuracy10: 0.3768 - val_accuracy20: 0.3678 - val_accuracy30: 0.3657 - val_accuracy50: 0.3603 - 11s/epoch - 31ms/step
Epoch 16/50
358/358 - 10s - loss: 12.9578 - accuracy10: 0.4020 - accuracy20: 0.4049 - accuracy30: 0.4019 - accuracy50: 0.3915 - val_loss: 13.2082 - val_accuracy10: 0.3802 - val_accuracy20: 0.3723 - val_accuracy30: 0.3702 - val_accuracy50: 0.3612 - 10s/epoch - 29ms/step
Epoch 17/50
358/358 - 11s - loss: 12.9472 - accuracy10: 0.4035 - accuracy20: 0.4050 - accuracy30: 0.4024 - accuracy50: 0.3909 - val_loss: 13.1703 - val_accuracy10: 0.3850 - val_accuracy20: 0.3790 - val_accuracy30: 0.3730 - val_accuracy50: 0.3650 - 11s/epoch - 30ms/step
Epoch 18/50
358/358 - 10s - loss: 12.9357 - accuracy10: 0.4061 - accuracy20: 0.4084 - accuracy30: 0.4035 - accuracy50: 0.3925 - val_loss: 13.2431 - val_accuracy10: 0.3800 - val_accuracy20: 0.3718 - val_accuracy30: 0.3701 - val_accuracy50: 0.3640 - 10s/epoch - 27ms/step
Epoch 19/50
358/358 - 10s - loss: 12.9208 - accuracy10: 0.4064 - accuracy20: 0.4078 - accuracy30: 0.4068 - accuracy50: 0.3954 - val_loss: 13.2291 - val_accuracy10: 0.3797 - val_accuracy20: 0.3745 - val_accuracy30: 0.3738 - val_accuracy50: 0.3659 - 10s/epoch - 28ms/step
Epoch 20/50
358/358 - 10s - loss: 12.9091 - accuracy10: 0.4098 - accuracy20: 0.4116 - accuracy30: 0.4080 - accuracy50: 0.3966 - val_loss: 13.2093 - val_accuracy10: 0.3827 - val_accuracy20: 0.3765 - val_accuracy30: 0.3742 - val_accuracy50: 0.3638 - 10s/epoch - 28ms/step
Epoch 21/50
358/358 - 10s - loss: 12.8969 - accuracy10: 0.4113 - accuracy20: 0.4136 - accuracy30: 0.4096 - accuracy50: 0.3989 - val_loss: 13.3221 - val_accuracy10: 0.3769 - val_accuracy20: 0.3715 - val_accuracy30: 0.3724 - val_accuracy50: 0.3621 - 10s/epoch - 28ms/step
Epoch 22/50
358/358 - 11s - loss: 12.8853 - accuracy10: 0.4125 - accuracy20: 0.4139 - accuracy30: 0.4100 - accuracy50: 0.3998 - val_loss: 13.2950 - val_accuracy10: 0.3799 - val_accuracy20: 0.3743 - val_accuracy30: 0.3718 - val_accuracy50: 0.3628 - 11s/epoch - 30ms/step
Epoch 23/50
358/358 - 10s - loss: 12.8745 - accuracy10: 0.4136 - accuracy20: 0.4147 - accuracy30: 0.4109 - accuracy50: 0.4000 - val_loss: 13.2409 - val_accuracy10: 0.3829 - val_accuracy20: 0.3791 - val_accuracy30: 0.3739 - val_accuracy50: 0.3636 - 10s/epoch - 28ms/step
Epoch 24/50
358/358 - 10s - loss: 12.8707 - accuracy10: 0.4120 - accuracy20: 0.4145 - accuracy30: 0.4114 - accuracy50: 0.3993 - val_loss: 13.3560 - val_accuracy10: 0.3739 - val_accuracy20: 0.3693 - val_accuracy30: 0.3663 - val_accuracy50: 0.3606 - 10s/epoch - 29ms/step
Epoch 25/50
358/358 - 10s - loss: 12.8504 - accuracy10: 0.4153 - accuracy20: 0.4172 - accuracy30: 0.4150 - accuracy50: 0.4047 - val_loss: 13.3929 - val_accuracy10: 0.3790 - val_accuracy20: 0.3699 - val_accuracy30: 0.3700 - val_accuracy50: 0.3640 - 10s/epoch - 28ms/step
Epoch 26/50
358/358 - 10s - loss: 12.8433 - accuracy10: 0.4141 - accuracy20: 0.4187 - accuracy30: 0.4162 - accuracy50: 0.4053 - val_loss: 13.3332 - val_accuracy10: 0.3782 - val_accuracy20: 0.3706 - val_accuracy30: 0.3715 - val_accuracy50: 0.3638 - 10s/epoch - 28ms/step
Epoch 27/50
358/358 - 10s - loss: 12.8204 - accuracy10: 0.4163 - accuracy20: 0.4235 - accuracy30: 0.4204 - accuracy50: 0.4093 - val_loss: 13.2699 - val_accuracy10: 0.3758 - val_accuracy20: 0.3713 - val_accuracy30: 0.3684 - val_accuracy50: 0.3629 - 10s/epoch - 28ms/step
testing model: results/CHTR/W8/deepVOL_L2/seq2seq
Evaluating performance on  test set...
1223/1223 - 13s - 13s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0924716
{'0': {'precision': 0.3769759487251422, 'recall': 0.34115831925551965, 'f1-score': 0.35817391482643374, 'support': 102407}, '1': {'precision': 0.3847436624937754, 'recall': 0.6122757387834837, 'f1-score': 0.47254689305716063, 'support': 108523}, '2': {'precision': 0.4170898560456625, 'recall': 0.19466617043573647, 'f1-score': 0.2654433515628652, 'support': 102103}, 'accuracy': 0.3873681049601799, 'macro avg': {'precision': 0.3929364890881934, 'recall': 0.38270007615824664, 'f1-score': 0.36538805314881984, 'support': 313033}, 'weighted avg': {'precision': 0.3927529622683164, 'recall': 0.3873681049601799, 'f1-score': 0.3675787699555512, 'support': 313033}}
[[34937 53067 14403]
 [28702 66446 13375]
 [29038 53189 19876]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.094805
{'0': {'precision': 0.37927877584505454, 'recall': 0.3057840148770154, 'f1-score': 0.3385890706844488, 'support': 104322}, '1': {'precision': 0.37597603200122914, 'recall': 0.6348643064293458, 'f1-score': 0.47226798083881866, 'support': 107927}, '2': {'precision': 0.40946383051646207, 'recall': 0.18966304175265916, 'f1-score': 0.2592444411292018, 'support': 100784}, 'accuracy': 0.381857503841448, 'macro avg': {'precision': 0.3882395461209153, 'recall': 0.3767704543530068, 'f1-score': 0.35670049755082306, 'support': 313033}, 'weighted avg': {'precision': 0.38785843139309767, 'recall': 0.381857503841448, 'f1-score': 0.3591328938313204, 'support': 313033}}
[[31900 57988 14434]
 [26274 68519 13134]
 [25933 55736 19115]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0982405
{'0': {'precision': 0.38249948896156993, 'recall': 0.28164363458481106, 'f1-score': 0.3244136466330395, 'support': 106301}, '1': {'precision': 0.36420228912268016, 'recall': 0.6443903081380037, 'f1-score': 0.4653780445141854, 'support': 106316}, '2': {'precision': 0.3960646461182321, 'recall': 0.1840144996813257, 'f1-score': 0.2512817025906031, 'support': 100416}, 'accuracy': 0.3735261138602, 'macro avg': {'precision': 0.3809221414008274, 'recall': 0.37001614746804684, 'f1-score': 0.347024464579276, 'support': 313033}, 'weighted avg': {'precision': 0.380636662112554, 'recall': 0.3735261138602, 'f1-score': 0.3488300935640871, 'support': 313033}}
[[29939 61529 14833]
 [24464 68509 13343]
 [23869 58069 18478]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1004499
{'0': {'precision': 0.36854472847790065, 'recall': 0.2567856602059358, 'f1-score': 0.3026784021061321, 'support': 105664}, '1': {'precision': 0.3665301486066821, 'recall': 0.6437068760409231, 'f1-score': 0.4670942980271851, 'support': 109278}, '2': {'precision': 0.3751763343509843, 'recall': 0.18165784832451498, 'f1-score': 0.24479002101850456, 'support': 98091}, 'accuracy': 0.36831580057054686, 'macro avg': {'precision': 0.37008373714518905, 'recall': 0.36071679485712466, 'f1-score': 0.3381875737172739, 'support': 313033}, 'weighted avg': {'precision': 0.36991950874876545, 'recall': 0.36831580057054686, 'f1-score': 0.3419353209779263, 'support': 313033}}
[[27133 63225 15306]
 [24565 70343 14370]
 [21924 58348 17819]]
Evaluating performance on  train set...
358/358 - 4s - 4s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0824121
{'0': {'precision': 0.4201854175944294, 'recall': 0.3287406562777144, 'f1-score': 0.368880280063263, 'support': 31572}, '1': {'precision': 0.3764324815789972, 'recall': 0.6599256159925616, 'f1-score': 0.4794046341080971, 'support': 30114}, '2': {'precision': 0.45019748653500896, 'recall': 0.21084317088756602, 'f1-score': 0.28718676989326125, 'support': 29733}, 'accuracy': 0.3994902591365034, 'macro avg': {'precision': 0.41560512856947857, 'recall': 0.39983648105261405, 'f1-score': 0.37849056135487374, 'support': 91419}, 'weighted avg': {'precision': 0.41553400957904446, 'recall': 0.3994902591365034, 'f1-score': 0.37871781120910214, 'support': 91419}}
[[10379 16989  4204]
 [ 6789 19873  3452]
 [ 7533 15931  6269]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0845231
{'0': {'precision': 0.4227489002603465, 'recall': 0.29931670109645636, 'f1-score': 0.35048285358093145, 'support': 31465}, '1': {'precision': 0.3713328047286095, 'recall': 0.6846984548928393, 'f1-score': 0.48152172643041585, 'support': 30095}, '2': {'precision': 0.4581288006447359, 'recall': 0.2094175960346964, 'f1-score': 0.287441390089179, 'support': 29859}, 'accuracy': 0.39682122972248657, 'macro avg': {'precision': 0.41740350187789726, 'recall': 0.39781091734133067, 'f1-score': 0.37314865670017544, 'support': 91419}, 'weighted avg': {'precision': 0.41737847453429233, 'recall': 0.39682122972248657, 'f1-score': 0.3730302432920965, 'support': 91419}}
[[ 9418 17969  4078]
 [ 6171 20606  3318]
 [ 6689 16917  6253]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0883673
{'0': {'precision': 0.4233976534471056, 'recall': 0.2783248876565637, 'f1-score': 0.33586523854393013, 'support': 31377}, '1': {'precision': 0.36558160710220805, 'recall': 0.6950992142762019, 'f1-score': 0.47915543060416543, 'support': 30036}, '2': {'precision': 0.449649225372698, 'recall': 0.20505898820235952, 'f1-score': 0.28166628519111925, 'support': 30006}, 'accuracy': 0.39120970476596767, 'macro avg': {'precision': 0.41287616197400395, 'recall': 0.39282769671170836, 'f1-score': 0.3655623181130716, 'support': 91419}, 'weighted avg': {'precision': 0.4130184313946218, 'recall': 0.39120970476596767, 'f1-score': 0.3651542311430265, 'support': 91419}}
[[ 8733 18583  4061]
 [ 5688 20878  3470]
 [ 6205 17648  6153]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0950587
{'0': {'precision': 0.40677790980007233, 'recall': 0.25202445347757896, 'f1-score': 0.3112252964426877, 'support': 31243}, '1': {'precision': 0.3579493701342224, 'recall': 0.6885061650854517, 'f1-score': 0.4710192451208757, 'support': 30251}, '2': {'precision': 0.4233513513513513, 'recall': 0.1962907268170426, 'f1-score': 0.26821917808219176, 'support': 29925}, 'accuracy': 0.378214594340345, 'macro avg': {'precision': 0.39602621042854874, 'recall': 0.37894044846002445, 'f1-score': 0.35015457321525173, 'support': 91419}, 'weighted avg': {'precision': 0.3960454371739268, 'recall': 0.378214594340345, 'f1-score': 0.350024327820476, 'support': 91419}}
[[ 7874 19163  4206]
 [ 5628 20828  3795]
 [ 5855 18196  5874]]
Evaluating performance on  val set...
99/99 - 1s - 1s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.093575
{'0': {'precision': 0.4052646803586925, 'recall': 0.32810304449648714, 'f1-score': 0.36262456321987835, 'support': 8540}, '1': {'precision': 0.3591753159641319, 'recall': 0.6239421071998038, 'f1-score': 0.4559060763577702, 'support': 8153}, '2': {'precision': 0.43147572351112173, 'recall': 0.21062463514302393, 'f1-score': 0.2830691981798211, 'support': 8565}, 'accuracy': 0.38375960091852085, 'macro avg': {'precision': 0.398638573277982, 'recall': 0.3875565956131049, 'f1-score': 0.3671999459191566, 'support': 25258}, 'weighted avg': {'precision': 0.3992757262329384, 'recall': 0.38375960091852085, 'f1-score': 0.36575753000446704, 'support': 25258}}
[[2802 4533 1205]
 [1894 5087 1172]
 [2218 4543 1804]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0961932
{'0': {'precision': 0.40376872282171045, 'recall': 0.29120687652456734, 'f1-score': 0.33837224996625725, 'support': 8609}, '1': {'precision': 0.35711895039828634, 'recall': 0.6433136380079585, 'f1-score': 0.45928030303030304, 'support': 8293}, '2': {'precision': 0.41411192214111925, 'recall': 0.20368597415031114, 'f1-score': 0.2730627306273063, 'support': 8356}, 'accuracy': 0.37786047984796894, 'macro avg': {'precision': 0.3916665317870387, 'recall': 0.37940216289427897, 'f1-score': 0.3569050945412889, 'support': 25258}, 'weighted avg': {'precision': 0.3918739255616551, 'recall': 0.37786047984796894, 'f1-score': 0.356464107613888, 'support': 25258}}
[[2507 4863 1239]
 [1789 5335 1169]
 [1913 4741 1702]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0972062
{'0': {'precision': 0.397955647955648, 'recall': 0.2660104226983208, 'f1-score': 0.318872770181162, 'support': 8635}, '1': {'precision': 0.35725895585462586, 'recall': 0.6554932601693905, 'f1-score': 0.46246423161083994, 'support': 8383}, '2': {'precision': 0.4014616321559074, 'recall': 0.2, 'f1-score': 0.26699068448764685, 'support': 8240}, 'accuracy': 0.37374297252355687, 'macro avg': {'precision': 0.3855587453220604, 'recall': 0.3738345609559037, 'f1-score': 0.3494425620932162, 'support': 25258}, 'weighted avg': {'precision': 0.38559239433015385, 'recall': 0.37374297252355687, 'f1-score': 0.34960437343757284, 'support': 25258}}
[[2297 5065 1273]
 [1704 5495 1184]
 [1771 4821 1648]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1008992
{'0': {'precision': 0.37922077922077924, 'recall': 0.2390922914960814, 'f1-score': 0.29327785350455554, 'support': 8549}, '1': {'precision': 0.35555414336553126, 'recall': 0.6575390762721824, 'f1-score': 0.4615384615384615, 'support': 8509}, '2': {'precision': 0.3860116166505324, 'recall': 0.19451219512195123, 'f1-score': 0.2586766136879663, 'support': 8200}, 'accuracy': 0.36558714070789455, 'macro avg': {'precision': 0.37359551307894767, 'recall': 0.363714520963405, 'f1-score': 0.3378309762436611, 'support': 25258}, 'weighted avg': {'precision': 0.37345252609035207, 'recall': 0.36558714070789455, 'f1-score': 0.3387287738966877, 'support': 25258}}
[[2044 5217 1288]
 [1665 5595 1249]
 [1681 4924 1595]]
training model: results/CHTR/W8/deepVOL_L3/seq2seq
Epoch 1/50
358/358 - 20s - loss: 13.2406 - accuracy10: 0.3490 - accuracy20: 0.3545 - accuracy30: 0.3586 - accuracy50: 0.3585 - val_loss: 13.4869 - val_accuracy10: 0.3231 - val_accuracy20: 0.3305 - val_accuracy30: 0.3340 - val_accuracy50: 0.3377 - 20s/epoch - 55ms/step
Epoch 2/50
358/358 - 15s - loss: 13.1785 - accuracy10: 0.3538 - accuracy20: 0.3573 - accuracy30: 0.3605 - accuracy50: 0.3562 - val_loss: 13.5554 - val_accuracy10: 0.3287 - val_accuracy20: 0.3339 - val_accuracy30: 0.3360 - val_accuracy50: 0.3389 - 15s/epoch - 41ms/step
Epoch 3/50
358/358 - 14s - loss: 13.1526 - accuracy10: 0.3599 - accuracy20: 0.3643 - accuracy30: 0.3673 - accuracy50: 0.3625 - val_loss: 13.6440 - val_accuracy10: 0.3259 - val_accuracy20: 0.3336 - val_accuracy30: 0.3376 - val_accuracy50: 0.3384 - 14s/epoch - 40ms/step
Epoch 4/50
358/358 - 15s - loss: 13.1412 - accuracy10: 0.3594 - accuracy20: 0.3636 - accuracy30: 0.3649 - accuracy50: 0.3622 - val_loss: 13.4489 - val_accuracy10: 0.3352 - val_accuracy20: 0.3400 - val_accuracy30: 0.3430 - val_accuracy50: 0.3395 - 15s/epoch - 41ms/step
Epoch 5/50
358/358 - 14s - loss: 13.1243 - accuracy10: 0.3660 - accuracy20: 0.3675 - accuracy30: 0.3701 - accuracy50: 0.3679 - val_loss: 13.2775 - val_accuracy10: 0.3446 - val_accuracy20: 0.3425 - val_accuracy30: 0.3419 - val_accuracy50: 0.3423 - 14s/epoch - 40ms/step
Epoch 6/50
358/358 - 14s - loss: 13.1064 - accuracy10: 0.3697 - accuracy20: 0.3730 - accuracy30: 0.3768 - accuracy50: 0.3696 - val_loss: 13.5084 - val_accuracy10: 0.3340 - val_accuracy20: 0.3360 - val_accuracy30: 0.3383 - val_accuracy50: 0.3396 - 14s/epoch - 40ms/step
Epoch 7/50
358/358 - 15s - loss: 13.0966 - accuracy10: 0.3693 - accuracy20: 0.3728 - accuracy30: 0.3736 - accuracy50: 0.3694 - val_loss: 13.4707 - val_accuracy10: 0.3323 - val_accuracy20: 0.3387 - val_accuracy30: 0.3407 - val_accuracy50: 0.3403 - 15s/epoch - 41ms/step
Epoch 8/50
358/358 - 15s - loss: 13.0912 - accuracy10: 0.3732 - accuracy20: 0.3766 - accuracy30: 0.3763 - accuracy50: 0.3706 - val_loss: 13.3271 - val_accuracy10: 0.3465 - val_accuracy20: 0.3482 - val_accuracy30: 0.3460 - val_accuracy50: 0.3446 - 15s/epoch - 42ms/step
Epoch 9/50
358/358 - 15s - loss: 13.0713 - accuracy10: 0.3755 - accuracy20: 0.3803 - accuracy30: 0.3814 - accuracy50: 0.3760 - val_loss: 13.6182 - val_accuracy10: 0.3336 - val_accuracy20: 0.3389 - val_accuracy30: 0.3424 - val_accuracy50: 0.3418 - 15s/epoch - 41ms/step
Epoch 10/50
358/358 - 15s - loss: 13.0681 - accuracy10: 0.3785 - accuracy20: 0.3808 - accuracy30: 0.3793 - accuracy50: 0.3710 - val_loss: 13.3781 - val_accuracy10: 0.3473 - val_accuracy20: 0.3472 - val_accuracy30: 0.3463 - val_accuracy50: 0.3437 - 15s/epoch - 41ms/step
Epoch 11/50
358/358 - 14s - loss: 13.0541 - accuracy10: 0.3784 - accuracy20: 0.3829 - accuracy30: 0.3848 - accuracy50: 0.3777 - val_loss: 13.3364 - val_accuracy10: 0.3521 - val_accuracy20: 0.3471 - val_accuracy30: 0.3484 - val_accuracy50: 0.3439 - 14s/epoch - 40ms/step
Epoch 12/50
358/358 - 15s - loss: 13.0491 - accuracy10: 0.3810 - accuracy20: 0.3851 - accuracy30: 0.3849 - accuracy50: 0.3765 - val_loss: 13.3016 - val_accuracy10: 0.3541 - val_accuracy20: 0.3530 - val_accuracy30: 0.3535 - val_accuracy50: 0.3513 - 15s/epoch - 41ms/step
Epoch 13/50
358/358 - 14s - loss: 13.0333 - accuracy10: 0.3873 - accuracy20: 0.3901 - accuracy30: 0.3875 - accuracy50: 0.3785 - val_loss: 13.2813 - val_accuracy10: 0.3556 - val_accuracy20: 0.3531 - val_accuracy30: 0.3528 - val_accuracy50: 0.3508 - 14s/epoch - 40ms/step
Epoch 14/50
358/358 - 15s - loss: 13.0241 - accuracy10: 0.3879 - accuracy20: 0.3907 - accuracy30: 0.3898 - accuracy50: 0.3805 - val_loss: 13.3652 - val_accuracy10: 0.3521 - val_accuracy20: 0.3519 - val_accuracy30: 0.3543 - val_accuracy50: 0.3482 - 15s/epoch - 41ms/step
Epoch 15/50
358/358 - 14s - loss: 13.0121 - accuracy10: 0.3902 - accuracy20: 0.3927 - accuracy30: 0.3909 - accuracy50: 0.3816 - val_loss: 13.3956 - val_accuracy10: 0.3475 - val_accuracy20: 0.3496 - val_accuracy30: 0.3496 - val_accuracy50: 0.3467 - 14s/epoch - 40ms/step
testing model: results/CHTR/W8/deepVOL_L3/seq2seq
Evaluating performance on  test set...
1223/1223 - 22s - 22s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1036205
{'0': {'precision': 0.34284313390118476, 'recall': 0.293602976359038, 'f1-score': 0.31631826454714734, 'support': 102407}, '1': {'precision': 0.34985700667302194, 'recall': 0.6493001483556481, 'f1-score': 0.45470766073738994, 'support': 108523}, '2': {'precision': 0.3405500292568754, 'recall': 0.079801768802092, 'f1-score': 0.1293035729871696, 'support': 102103}, 'accuracy': 0.34718064868560183, 'macro avg': {'precision': 0.3444167232770274, 'recall': 0.3409016311722593, 'f1-score': 0.30010983275723563, 'support': 313033}, 'weighted avg': {'precision': 0.34452676997572057, 'recall': 0.34718064868560183, 'f1-score': 0.3032962233898422, 'support': 313033}}
[[30067 64777  7563]
 [29844 70464  8215]
 [27788 66167  8148]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1040945
{'0': {'precision': 0.35212738607879684, 'recall': 0.21007074250877092, 'f1-score': 0.263151574826787, 'support': 104322}, '1': {'precision': 0.3453106533851089, 'recall': 0.7580216257285016, 'f1-score': 0.47447708694000534, 'support': 107927}, '2': {'precision': 0.3286012826979895, 'recall': 0.0452452770280997, 'f1-score': 0.07953881441815439, 'support': 100784}, 'accuracy': 0.3459251899959429, 'macro avg': {'precision': 0.34201310738729845, 'recall': 0.3377792150884574, 'f1-score': 0.2723891587283156, 'support': 313033}, 'weighted avg': {'precision': 0.34220266787795883, 'recall': 0.3459251899959429, 'f1-score': 0.2768961324319586, 'support': 313033}}
[[21915 78002  4405]
 [21204 81811  4912]
 [19117 77107  4560]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1063011
{'0': {'precision': 0.36030144927536234, 'recall': 0.1461698384775308, 'f1-score': 0.2079691619932274, 'support': 106301}, '1': {'precision': 0.33999125404692127, 'recall': 0.8336750818315212, 'f1-score': 0.4830030953003749, 'support': 106316}, '2': {'precision': 0.3254123263888889, 'recall': 0.029865758444869342, 'f1-score': 0.054710303561004085, 'support': 100416}, 'accuracy': 0.3423600706634764, 'macro avg': {'precision': 0.34190167657039083, 'recall': 0.3365702262513071, 'f1-score': 0.24856085361820213, 'support': 313033}, 'weighted avg': {'precision': 0.34221158373506766, 'recall': 0.3423600706634764, 'f1-score': 0.2522164653930368, 'support': 313033}}
[[15538 87796  2967]
 [14433 88633  3250]
 [13154 84263  2999]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1058043
{'0': {'precision': 0.35442960233379395, 'recall': 0.10923304058146578, 'f1-score': 0.16699824204761665, 'support': 105664}, '1': {'precision': 0.3496522979130543, 'recall': 0.8728380826881897, 'f1-score': 0.4992920126992768, 'support': 109278}, '2': {'precision': 0.3180930050801094, 'recall': 0.02489525032877634, 'f1-score': 0.0461765373269798, 'support': 98091}, 'accuracy': 0.34937530547897505, 'macro avg': {'precision': 0.3407249684423192, 'recall': 0.3356554578661439, 'f1-score': 0.23748893069129107, 'support': 313033}, 'weighted avg': {'precision': 0.34137555552818316, 'recall': 0.34937530547897505, 'f1-score': 0.24513976971888493, 'support': 313033}}
[[11542 91652  2470]
 [11131 95382  2765]
 [ 9892 85757  2442]]
Evaluating performance on  train set...
358/358 - 6s - 6s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1011788
{'0': {'precision': 0.38037789408320766, 'recall': 0.2716330926137083, 'f1-score': 0.316937063453934, 'support': 31572}, '1': {'precision': 0.34156172909175925, 'recall': 0.7034601846317328, 'f1-score': 0.4598469636945786, 'support': 30114}, '2': {'precision': 0.37332165791009925, 'recall': 0.08603235462280967, 'f1-score': 0.13983873172065053, 'support': 29733}, 'accuracy': 0.35351513361555037, 'macro avg': {'precision': 0.36508709369502207, 'recall': 0.3537085439560836, 'f1-score': 0.3055409196230544, 'support': 91419}, 'weighted avg': {'precision': 0.3652966411413957, 'recall': 0.35351513361555037, 'f1-score': 0.30641325591306234, 'support': 91419}}
[[ 8576 20705  2291]
 [ 6927 21184  2003]
 [ 7043 20132  2558]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1029973
{'0': {'precision': 0.3839564836813805, 'recall': 0.19516923565866837, 'f1-score': 0.2587917992372364, 'support': 31465}, '1': {'precision': 0.3362294023524128, 'recall': 0.7959793985711913, 'f1-score': 0.47276028458373215, 'support': 30095}, '2': {'precision': 0.38478104809763103, 'recall': 0.0538531096151914, 'f1-score': 0.09448263705270579, 'support': 29859}, 'accuracy': 0.3467988054999508, 'macro avg': {'precision': 0.36832231137714144, 'recall': 0.348333914615017, 'f1-score': 0.27534490695789143, 'support': 91419}, 'weighted avg': {'precision': 0.3685141156431121, 'recall': 0.3467988054999508, 'f1-score': 0.2755637426279417, 'support': 91419}}
[[ 6141 23978  1346]
 [ 4915 23955  1225]
 [ 4938 23313  1608]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1058091
{'0': {'precision': 0.3848856061970816, 'recall': 0.13618255410013705, 'f1-score': 0.2011817603992561, 'support': 31377}, '1': {'precision': 0.33242418758563635, 'recall': 0.8562058862698095, 'f1-score': 0.47891022179183973, 'support': 30036}, '2': {'precision': 0.3895093062605753, 'recall': 0.038358994867693126, 'f1-score': 0.06984011407420891, 'support': 30006}, 'accuracy': 0.3406403482864612, 'macro avg': {'precision': 0.36893970001443105, 'recall': 0.3435824784125466, 'f1-score': 0.2499773654217682, 'support': 91419}, 'weighted avg': {'precision': 0.369166855988611, 'recall': 0.3406403482864612, 'f1-score': 0.24932070992570332, 'support': 91419}}
[[ 4273 26167   937]
 [ 3452 25717   867]
 [ 3377 25478  1151]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1083015
{'0': {'precision': 0.38472502672526426, 'recall': 0.10367122235380725, 'f1-score': 0.16333013968029853, 'support': 31243}, '1': {'precision': 0.33450187712886303, 'recall': 0.8894912564873888, 'f1-score': 0.48617347077050943, 'support': 30251}, '2': {'precision': 0.3717748240813135, 'recall': 0.03177944862155389, 'f1-score': 0.05855370501493089, 'support': 29925}, 'accuracy': 0.3401699865454665, 'macro avg': {'precision': 0.3636672426451469, 'recall': 0.34164730915424996, 'f1-score': 0.23601910515524627, 'support': 91419}, 'weighted avg': {'precision': 0.36386683190185815, 'recall': 0.3401699865454665, 'f1-score': 0.23586318862470662, 'support': 91419}}
[[ 3239 27198   806]
 [ 2542 26908   801]
 [ 2638 26336   951]]
Evaluating performance on  val set...
99/99 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1055639
{'0': {'precision': 0.362261773507639, 'recall': 0.2693208430913349, 'f1-score': 0.308952918261804, 'support': 8540}, '1': {'precision': 0.33226761397276494, 'recall': 0.688335581994358, 'f1-score': 0.448189114722677, 'support': 8153}, '2': {'precision': 0.38979692917285785, 'recall': 0.0918855808523059, 'f1-score': 0.14871504157218443, 'support': 8565}, 'accuracy': 0.3444057328371209, 'macro avg': {'precision': 0.36144210555108724, 'recall': 0.34984733531266626, 'f1-score': 0.3019523581855551, 'support': 25258}, 'weighted avg': {'precision': 0.3619171787489397, 'recall': 0.3444057328371209, 'f1-score': 0.2995600643501287, 'support': 25258}}
[[2300 5595  645]
 [1954 5612  587]
 [2095 5683  787]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1062216
{'0': {'precision': 0.37023914968999116, 'recall': 0.19421535602276688, 'f1-score': 0.25478095238095244, 'support': 8609}, '1': {'precision': 0.3342040565457898, 'recall': 0.7868081514530327, 'f1-score': 0.46913757774023085, 'support': 8293}, '2': {'precision': 0.38013136288998356, 'recall': 0.05540928674006702, 'f1-score': 0.09672028410277836, 'support': 8356}, 'accuracy': 0.3428616675904664, 'macro avg': {'precision': 0.36152485637525483, 'recall': 0.34547759807195555, 'f1-score': 0.2735462714079872, 'support': 25258}, 'weighted avg': {'precision': 0.3616802893706576, 'recall': 0.3428616675904664, 'f1-score': 0.2728704507565987, 'support': 25258}}
[[1672 6548  389]
 [1402 6525  366]
 [1442 6451  463]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1073699
{'0': {'precision': 0.37046386872830545, 'recall': 0.13595830920671684, 'f1-score': 0.1989156218231108, 'support': 8635}, '1': {'precision': 0.3357307384948056, 'recall': 0.8519623046642013, 'f1-score': 0.48165632586997564, 'support': 8383}, '2': {'precision': 0.3700980392156863, 'recall': 0.036650485436893206, 'f1-score': 0.06669611307420495, 'support': 8240}, 'accuracy': 0.3411988280940692, 'macro avg': {'precision': 0.35876421547959914, 'recall': 0.3415236997692705, 'f1-score': 0.24908935358909715, 'support': 25258}, 'weighted avg': {'precision': 0.35881677608710616, 'recall': 0.3411988280940692, 'f1-score': 0.24962140097957145, 'support': 25258}}
[[1174 7207  254]
 [ 981 7142  260]
 [1014 6924  302]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.109366
{'0': {'precision': 0.3662911973299958, 'recall': 0.1027020704175927, 'f1-score': 0.1604238991412388, 'support': 8549}, '1': {'precision': 0.33938490719414716, 'recall': 0.883182512633682, 'f1-score': 0.49034320762103617, 'support': 8509}, '2': {'precision': 0.3370473537604457, 'recall': 0.029512195121951218, 'f1-score': 0.054272258353891004, 'support': 8200}, 'accuracy': 0.3418718821759443, 'macro avg': {'precision': 0.34757448609486286, 'recall': 0.3384655927244086, 'f1-score': 0.23501312170538868, 'support': 25258}, 'weighted avg': {'precision': 0.3477329132205554, 'recall': 0.3418718821759443, 'f1-score': 0.23710613611163806, 'support': 25258}}
[[ 878 7429  242]
 [ 760 7515  234]
 [ 759 7199  242]]
training model: results/CHTR/W9/deepLOB_L1/seq2seq
Epoch 1/50
323/323 - 14s - loss: 13.2162 - accuracy10: 0.3692 - accuracy20: 0.3715 - accuracy30: 0.3682 - accuracy50: 0.3615 - val_loss: 13.4252 - val_accuracy10: 0.3309 - val_accuracy20: 0.3358 - val_accuracy30: 0.3277 - val_accuracy50: 0.3177 - 14s/epoch - 42ms/step
Epoch 2/50
323/323 - 8s - loss: 13.1522 - accuracy10: 0.3754 - accuracy20: 0.3748 - accuracy30: 0.3741 - accuracy50: 0.3687 - val_loss: 13.2976 - val_accuracy10: 0.3397 - val_accuracy20: 0.3394 - val_accuracy30: 0.3324 - val_accuracy50: 0.3270 - 8s/epoch - 24ms/step
Epoch 3/50
323/323 - 8s - loss: 13.1067 - accuracy10: 0.3833 - accuracy20: 0.3792 - accuracy30: 0.3751 - accuracy50: 0.3690 - val_loss: 13.2294 - val_accuracy10: 0.3516 - val_accuracy20: 0.3461 - val_accuracy30: 0.3366 - val_accuracy50: 0.3248 - 8s/epoch - 24ms/step
Epoch 4/50
323/323 - 8s - loss: 13.0587 - accuracy10: 0.3955 - accuracy20: 0.3871 - accuracy30: 0.3796 - accuracy50: 0.3702 - val_loss: 13.1754 - val_accuracy10: 0.3731 - val_accuracy20: 0.3601 - val_accuracy30: 0.3493 - val_accuracy50: 0.3383 - 8s/epoch - 24ms/step
Epoch 5/50
323/323 - 8s - loss: 13.0384 - accuracy10: 0.3988 - accuracy20: 0.3903 - accuracy30: 0.3839 - accuracy50: 0.3753 - val_loss: 13.1579 - val_accuracy10: 0.3750 - val_accuracy20: 0.3701 - val_accuracy30: 0.3636 - val_accuracy50: 0.3476 - 8s/epoch - 24ms/step
Epoch 6/50
323/323 - 8s - loss: 13.0087 - accuracy10: 0.4018 - accuracy20: 0.3939 - accuracy30: 0.3898 - accuracy50: 0.3820 - val_loss: 13.1574 - val_accuracy10: 0.3873 - val_accuracy20: 0.3758 - val_accuracy30: 0.3631 - val_accuracy50: 0.3497 - 8s/epoch - 24ms/step
Epoch 7/50
323/323 - 7s - loss: 12.9830 - accuracy10: 0.4071 - accuracy20: 0.4011 - accuracy30: 0.3946 - accuracy50: 0.3867 - val_loss: 13.1638 - val_accuracy10: 0.3841 - val_accuracy20: 0.3736 - val_accuracy30: 0.3596 - val_accuracy50: 0.3521 - 7s/epoch - 23ms/step
Epoch 8/50
323/323 - 7s - loss: 12.9617 - accuracy10: 0.4100 - accuracy20: 0.4041 - accuracy30: 0.3986 - accuracy50: 0.3897 - val_loss: 13.1724 - val_accuracy10: 0.3816 - val_accuracy20: 0.3714 - val_accuracy30: 0.3600 - val_accuracy50: 0.3470 - 7s/epoch - 23ms/step
Epoch 9/50
323/323 - 7s - loss: 12.9337 - accuracy10: 0.4147 - accuracy20: 0.4094 - accuracy30: 0.4054 - accuracy50: 0.3954 - val_loss: 13.1128 - val_accuracy10: 0.3967 - val_accuracy20: 0.3834 - val_accuracy30: 0.3757 - val_accuracy50: 0.3644 - 7s/epoch - 23ms/step
Epoch 10/50
323/323 - 8s - loss: 12.9185 - accuracy10: 0.4188 - accuracy20: 0.4133 - accuracy30: 0.4078 - accuracy50: 0.3991 - val_loss: 13.0904 - val_accuracy10: 0.4000 - val_accuracy20: 0.3891 - val_accuracy30: 0.3769 - val_accuracy50: 0.3674 - 8s/epoch - 25ms/step
Epoch 11/50
323/323 - 8s - loss: 12.8870 - accuracy10: 0.4227 - accuracy20: 0.4192 - accuracy30: 0.4147 - accuracy50: 0.4069 - val_loss: 13.1772 - val_accuracy10: 0.3859 - val_accuracy20: 0.3774 - val_accuracy30: 0.3634 - val_accuracy50: 0.3518 - 8s/epoch - 24ms/step
Epoch 12/50
323/323 - 8s - loss: 12.8712 - accuracy10: 0.4257 - accuracy20: 0.4204 - accuracy30: 0.4145 - accuracy50: 0.4052 - val_loss: 13.1367 - val_accuracy10: 0.3960 - val_accuracy20: 0.3870 - val_accuracy30: 0.3767 - val_accuracy50: 0.3646 - 8s/epoch - 24ms/step
Epoch 13/50
323/323 - 7s - loss: 12.8524 - accuracy10: 0.4265 - accuracy20: 0.4225 - accuracy30: 0.4190 - accuracy50: 0.4079 - val_loss: 13.1586 - val_accuracy10: 0.3920 - val_accuracy20: 0.3799 - val_accuracy30: 0.3689 - val_accuracy50: 0.3581 - 7s/epoch - 22ms/step
Epoch 14/50
323/323 - 7s - loss: 12.8492 - accuracy10: 0.4277 - accuracy20: 0.4228 - accuracy30: 0.4202 - accuracy50: 0.4120 - val_loss: 13.0965 - val_accuracy10: 0.4032 - val_accuracy20: 0.3901 - val_accuracy30: 0.3752 - val_accuracy50: 0.3656 - 7s/epoch - 23ms/step
Epoch 15/50
323/323 - 8s - loss: 12.8271 - accuracy10: 0.4298 - accuracy20: 0.4245 - accuracy30: 0.4210 - accuracy50: 0.4117 - val_loss: 13.0425 - val_accuracy10: 0.4047 - val_accuracy20: 0.4001 - val_accuracy30: 0.3867 - val_accuracy50: 0.3774 - 8s/epoch - 26ms/step
Epoch 16/50
323/323 - 7s - loss: 12.8104 - accuracy10: 0.4323 - accuracy20: 0.4266 - accuracy30: 0.4228 - accuracy50: 0.4141 - val_loss: 13.0904 - val_accuracy10: 0.4005 - val_accuracy20: 0.3924 - val_accuracy30: 0.3775 - val_accuracy50: 0.3701 - 7s/epoch - 23ms/step
Epoch 17/50
323/323 - 8s - loss: 12.7915 - accuracy10: 0.4349 - accuracy20: 0.4301 - accuracy30: 0.4275 - accuracy50: 0.4186 - val_loss: 13.0296 - val_accuracy10: 0.4128 - val_accuracy20: 0.3980 - val_accuracy30: 0.3903 - val_accuracy50: 0.3798 - 8s/epoch - 25ms/step
Epoch 18/50
323/323 - 8s - loss: 12.7662 - accuracy10: 0.4353 - accuracy20: 0.4319 - accuracy30: 0.4289 - accuracy50: 0.4199 - val_loss: 13.0609 - val_accuracy10: 0.4042 - val_accuracy20: 0.3922 - val_accuracy30: 0.3834 - val_accuracy50: 0.3753 - 8s/epoch - 24ms/step
Epoch 19/50
323/323 - 8s - loss: 12.7537 - accuracy10: 0.4382 - accuracy20: 0.4331 - accuracy30: 0.4301 - accuracy50: 0.4209 - val_loss: 13.0411 - val_accuracy10: 0.4096 - val_accuracy20: 0.3963 - val_accuracy30: 0.3910 - val_accuracy50: 0.3830 - 8s/epoch - 24ms/step
Epoch 20/50
323/323 - 7s - loss: 12.7290 - accuracy10: 0.4376 - accuracy20: 0.4355 - accuracy30: 0.4323 - accuracy50: 0.4227 - val_loss: 13.1140 - val_accuracy10: 0.3994 - val_accuracy20: 0.3880 - val_accuracy30: 0.3796 - val_accuracy50: 0.3737 - 7s/epoch - 23ms/step
Epoch 21/50
323/323 - 7s - loss: 12.7072 - accuracy10: 0.4393 - accuracy20: 0.4383 - accuracy30: 0.4340 - accuracy50: 0.4256 - val_loss: 13.1390 - val_accuracy10: 0.3963 - val_accuracy20: 0.3883 - val_accuracy30: 0.3803 - val_accuracy50: 0.3718 - 7s/epoch - 23ms/step
Epoch 22/50
323/323 - 8s - loss: 12.6907 - accuracy10: 0.4405 - accuracy20: 0.4394 - accuracy30: 0.4371 - accuracy50: 0.4271 - val_loss: 13.0313 - val_accuracy10: 0.4174 - val_accuracy20: 0.4015 - val_accuracy30: 0.3943 - val_accuracy50: 0.3824 - 8s/epoch - 23ms/step
Epoch 23/50
323/323 - 8s - loss: 12.6818 - accuracy10: 0.4427 - accuracy20: 0.4415 - accuracy30: 0.4390 - accuracy50: 0.4292 - val_loss: 13.1203 - val_accuracy10: 0.4069 - val_accuracy20: 0.3931 - val_accuracy30: 0.3884 - val_accuracy50: 0.3768 - 8s/epoch - 24ms/step
Epoch 24/50
323/323 - 8s - loss: 12.6680 - accuracy10: 0.4454 - accuracy20: 0.4444 - accuracy30: 0.4412 - accuracy50: 0.4310 - val_loss: 13.0628 - val_accuracy10: 0.4126 - val_accuracy20: 0.4000 - val_accuracy30: 0.3925 - val_accuracy50: 0.3813 - 8s/epoch - 25ms/step
Epoch 25/50
323/323 - 8s - loss: 12.6524 - accuracy10: 0.4444 - accuracy20: 0.4436 - accuracy30: 0.4398 - accuracy50: 0.4307 - val_loss: 13.0647 - val_accuracy10: 0.4069 - val_accuracy20: 0.3994 - val_accuracy30: 0.3919 - val_accuracy50: 0.3792 - 8s/epoch - 25ms/step
Epoch 26/50
323/323 - 8s - loss: 12.6352 - accuracy10: 0.4458 - accuracy20: 0.4457 - accuracy30: 0.4427 - accuracy50: 0.4340 - val_loss: 13.0847 - val_accuracy10: 0.4092 - val_accuracy20: 0.3960 - val_accuracy30: 0.3866 - val_accuracy50: 0.3759 - 8s/epoch - 24ms/step
Epoch 27/50
323/323 - 8s - loss: 12.6124 - accuracy10: 0.4479 - accuracy20: 0.4482 - accuracy30: 0.4446 - accuracy50: 0.4350 - val_loss: 13.1185 - val_accuracy10: 0.4046 - val_accuracy20: 0.3920 - val_accuracy30: 0.3862 - val_accuracy50: 0.3759 - 8s/epoch - 23ms/step
testing model: results/CHTR/W9/deepLOB_L1/seq2seq
Evaluating performance on  test set...
604/604 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0981544
{'0': {'precision': 0.41988974837734505, 'recall': 0.3606613716205896, 'f1-score': 0.3880284293989565, 'support': 52376}, '1': {'precision': 0.43561794660060554, 'recall': 0.14713648196355522, 'f1-score': 0.21997359093752167, 'support': 53780}, '2': {'precision': 0.3535432121763333, 'recall': 0.6686007957559682, 'f1-score': 0.4625165752786439, 'support': 48256}, 'accuracy': 0.38252855995648005, 'macro avg': {'precision': 0.403016969051428, 'recall': 0.392132883113371, 'f1-score': 0.3568395318717074, 'support': 154412}, 'weighted avg': {'precision': 0.40463344737438495, 'recall': 0.38252855995648005, 'f1-score': 0.3527754099128689, 'support': 154412}}
[[18890  5270 28216]
 [15088  7913 30779]
 [11010  4982 32264]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1001161
{'0': {'precision': 0.3966679976928879, 'recall': 0.3658441771012358, 'f1-score': 0.38063307576047856, 'support': 48876}, '1': {'precision': 0.46316570792354794, 'recall': 0.16756176154672395, 'f1-score': 0.2460931722947991, 'support': 59584}, '2': {'precision': 0.33482193715965275, 'recall': 0.6395804317548747, 'f1-score': 0.43954236147461306, 'support': 45952}, 'accuracy': 0.37079372069528277, 'macro avg': {'precision': 0.3982185475920295, 'recall': 0.39099545680094483, 'f1-score': 0.3554228698432969, 'support': 154412}, 'weighted avg': {'precision': 0.40392293508609844, 'recall': 0.37079372069528277, 'f1-score': 0.34624827334251146, 'support': 154412}}
[[17881  5834 25161]
 [16373  9984 33227]
 [10824  5738 29390]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0977542
{'0': {'precision': 0.39486291356469716, 'recall': 0.3576507018151445, 'f1-score': 0.37533672553127806, 'support': 49087}, '1': {'precision': 0.4519461705615493, 'recall': 0.19901625033575074, 'f1-score': 0.2763435471275889, 'support': 59568}, '2': {'precision': 0.3289894887720975, 'recall': 0.6019406866708918, 'f1-score': 0.42545007993697725, 'support': 45757}, 'accuracy': 0.3688443903323576, 'macro avg': {'precision': 0.39193285763278135, 'recall': 0.38620254627392897, 'f1-score': 0.3590434508652814, 'support': 154412}, 'weighted avg': {'precision': 0.3973637888499956, 'recall': 0.3688443903323576, 'f1-score': 0.35199793778415106, 'support': 154412}}
[[17556  7241 24290]
 [15826 11855 31887]
 [11079  7135 27543]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0972911
{'0': {'precision': 0.38682947096297665, 'recall': 0.3438731122783979, 'f1-score': 0.3640886378448838, 'support': 48736}, '1': {'precision': 0.4455791962174941, 'recall': 0.23552149283572144, 'f1-score': 0.3081584827511036, 'support': 60020}, '2': {'precision': 0.32309766515882715, 'recall': 0.5616348344138777, 'f1-score': 0.41020964813348376, 'support': 45656}, 'accuracy': 0.36614382301893633, 'macro avg': {'precision': 0.3851687774464326, 'recall': 0.3803431465093324, 'f1-score': 0.36081892290982376, 'support': 154412}, 'weighted avg': {'precision': 0.3908215129285097, 'recall': 0.36614382301893633, 'f1-score': 0.35598546540367215, 'support': 154412}}
[[16759  8744 23233]
 [15396 14136 30488]
 [11169  8845 25642]]
Evaluating performance on  train set...
323/323 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0742297
{'0': {'precision': 0.4554730983302412, 'recall': 0.36729003740224414, 'f1-score': 0.4066558747129465, 'support': 29410}, '1': {'precision': 0.3892860011244077, 'recall': 0.37391036025611357, 'f1-score': 0.3814432989690722, 'support': 25926}, '2': {'precision': 0.4047976011994003, 'recall': 0.5044140811018719, 'f1-score': 0.4491486724509101, 'support': 27299}, 'accuracy': 0.41466690869486295, 'macro avg': {'precision': 0.41651890021801635, 'recall': 0.4152048262534098, 'f1-score': 0.41241594871097625, 'support': 82635}, 'weighted avg': {'precision': 0.41796650816465436, 'recall': 0.41466690869486295, 'f1-score': 0.41278341929711765, 'support': 82635}}
[[10802  7783 10825]
 [ 6810  9694  9422]
 [ 6104  7425 13770]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0770044
{'0': {'precision': 0.4382732532265243, 'recall': 0.3441671908855805, 'f1-score': 0.3855610367238274, 'support': 28614}, '1': {'precision': 0.4032005371530886, 'recall': 0.38782246779806967, 'f1-score': 0.3953620219828453, 'support': 27871}, '2': {'precision': 0.38627574422160266, 'recall': 0.4927342256214149, 'f1-score': 0.4330582956626951, 'support': 26150}, 'accuracy': 0.4059054879893508, 'macro avg': {'precision': 0.40924984486707183, 'recall': 0.4082412947683551, 'f1-score': 0.40466045145645596, 'support': 82635}, 'weighted avg': {'precision': 0.4099892751281226, 'recall': 0.4059054879893508, 'f1-score': 0.40389729353275194, 'support': 82635}}
[[ 9848  8314 10452]
 [ 7042 10809 10020]
 [ 5580  7685 12885]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0797503
{'0': {'precision': 0.44129265622769026, 'recall': 0.32076385525496437, 'f1-score': 0.37149668449626383, 'support': 28906}, '1': {'precision': 0.3923788859884056, 'recall': 0.4186803646360874, 'f1-score': 0.40510316585289025, 'support': 27644}, '2': {'precision': 0.38210850686338593, 'recall': 0.47061529614721104, 'f1-score': 0.42176870748299317, 'support': 26085}, 'accuracy': 0.4008228958673685, 'macro avg': {'precision': 0.4052600163598273, 'recall': 0.4033531720127543, 'f1-score': 0.3994561859440491, 'support': 82635}, 'weighted avg': {'precision': 0.4062470847305926, 'recall': 0.4008228958673685, 'f1-score': 0.3986082388041408, 'support': 82635}}
[[ 9272  9434 10200]
 [ 6419 11574  9651]
 [ 5320  8489 12276]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0861574
{'0': {'precision': 0.44223873616379983, 'recall': 0.2898303930249983, 'f1-score': 0.350169735623907, 'support': 29362}, '1': {'precision': 0.370966758157975, 'recall': 0.44679522497704316, 'f1-score': 0.4053653253353328, 'support': 27225}, '2': {'precision': 0.37026991699888895, 'recall': 0.4350046068796069, 'f1-score': 0.4000353045013239, 'support': 26048}, 'accuracy': 0.3873056211048587, 'macro avg': {'precision': 0.3944918037735546, 'recall': 0.3905434082938828, 'f1-score': 0.3851901218201879, 'support': 82635}, 'weighted avg': {'precision': 0.39607157451539204, 'recall': 0.3873056211048587, 'f1-score': 0.38407302440000096, 'support': 82635}}
[[ 8510 10938  9914]
 [ 5704 12164  9357]
 [ 5029  9688 11331]]
Evaluating performance on  val set...
112/112 - 1s - 959ms/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0809945
{'0': {'precision': 0.47717495219885275, 'recall': 0.36643112783334864, 'f1-score': 0.4145341292499351, 'support': 10897}, '1': {'precision': 0.31631336405529953, 'recall': 0.23107998922704012, 'f1-score': 0.26706092911057505, 'support': 7426}, '2': {'precision': 0.4101618520794919, 'recall': 0.5938890536932661, 'f1-score': 0.4852157052835676, 'support': 10113}, 'accuracy': 0.41197777465184976, 'macro avg': {'precision': 0.4012167227778814, 'recall': 0.39713339025121824, 'f1-score': 0.38893692121469253, 'support': 28436}, 'weighted avg': {'precision': 0.4113337074717068, 'recall': 0.41197777465184976, 'f1-score': 0.4011590692623573, 'support': 28436}}
[[3993 1893 5011]
 [2084 1716 3626]
 [2291 1816 6006]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0873468
{'0': {'precision': 0.45873091603053434, 'recall': 0.36344736344736345, 'f1-score': 0.40556785827269853, 'support': 10582}, '1': {'precision': 0.32547169811320753, 'recall': 0.22230483271375465, 'f1-score': 0.2641731703725519, 'support': 8070}, '2': {'precision': 0.3922283356258597, 'recall': 0.5828904333605888, 'f1-score': 0.4689195855944746, 'support': 9784}, 'accuracy': 0.3988957659305106, 'macro avg': {'precision': 0.3921436499232005, 'recall': 0.38954754317390233, 'f1-score': 0.3795535380799084, 'support': 28436}, 'weighted avg': {'precision': 0.39803098864017833, 'recall': 0.3988957659305106, 'f1-score': 0.38723821165440037, 'support': 28436}}
[[3846 1918 4818]
 [2257 1794 4019]
 [2281 1800 5703]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.089607
{'0': {'precision': 0.45525386582247657, 'recall': 0.3538709066818096, 'f1-score': 0.3982107673465041, 'support': 10566}, '1': {'precision': 0.31221643421273737, 'recall': 0.2336225323777191, 'f1-score': 0.2672612197928654, 'support': 7953}, '2': {'precision': 0.3913957399103139, 'recall': 0.5632751840274276, 'f1-score': 0.4618628302120798, 'support': 9917}, 'accuracy': 0.3932690955127303, 'macro avg': {'precision': 0.3862886799818426, 'recall': 0.3835895410289854, 'f1-score': 0.37577827245048306, 'support': 28436}, 'weighted avg': {'precision': 0.39297866086175165, 'recall': 0.3932690955127303, 'f1-score': 0.38378524180647827, 'support': 28436}}
[[3739 2103 4724]
 [2133 1858 3962]
 [2341 1990 5586]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0943089
{'0': {'precision': 0.4412542500944465, 'recall': 0.3339687380861609, 'f1-score': 0.3801877068301416, 'support': 10492}, '1': {'precision': 0.3059125964010283, 'recall': 0.2513667992047714, 'f1-score': 0.2759702612372962, 'support': 8048}, '2': {'precision': 0.38841665466071174, 'recall': 0.5448666127728375, 'f1-score': 0.45352847169652627, 'support': 9896}, 'accuracy': 0.38398508932339287, 'macro avg': {'precision': 0.37852783371872883, 'recall': 0.37673405002125665, 'f1-score': 0.3698954799213214, 'support': 28436}, 'weighted avg': {'precision': 0.384561660653707, 'recall': 0.38398508932339287, 'f1-score': 0.3762152144608394, 'support': 28436}}
[[3504 2356 4632]
 [2167 2023 3858]
 [2270 2234 5392]]
training model: results/CHTR/W9/deepOF_L1/seq2seq
Epoch 1/50
323/323 - 12s - loss: 13.1221 - accuracy10: 0.3883 - accuracy20: 0.3893 - accuracy30: 0.3883 - accuracy50: 0.3842 - val_loss: 13.3861 - val_accuracy10: 0.3647 - val_accuracy20: 0.3584 - val_accuracy30: 0.3546 - val_accuracy50: 0.3518 - 12s/epoch - 37ms/step
Epoch 2/50
323/323 - 7s - loss: 13.0063 - accuracy10: 0.4081 - accuracy20: 0.4038 - accuracy30: 0.4009 - accuracy50: 0.3958 - val_loss: 13.1938 - val_accuracy10: 0.3817 - val_accuracy20: 0.3718 - val_accuracy30: 0.3697 - val_accuracy50: 0.3681 - 7s/epoch - 22ms/step
Epoch 3/50
323/323 - 7s - loss: 12.9462 - accuracy10: 0.4154 - accuracy20: 0.4104 - accuracy30: 0.4067 - accuracy50: 0.4031 - val_loss: 13.1673 - val_accuracy10: 0.3822 - val_accuracy20: 0.3764 - val_accuracy30: 0.3753 - val_accuracy50: 0.3747 - 7s/epoch - 21ms/step
Epoch 4/50
323/323 - 7s - loss: 12.8945 - accuracy10: 0.4219 - accuracy20: 0.4169 - accuracy30: 0.4129 - accuracy50: 0.4085 - val_loss: 13.1008 - val_accuracy10: 0.3921 - val_accuracy20: 0.3854 - val_accuracy30: 0.3884 - val_accuracy50: 0.3887 - 7s/epoch - 22ms/step
Epoch 5/50
323/323 - 7s - loss: 12.8594 - accuracy10: 0.4263 - accuracy20: 0.4201 - accuracy30: 0.4171 - accuracy50: 0.4118 - val_loss: 13.0589 - val_accuracy10: 0.4012 - val_accuracy20: 0.3944 - val_accuracy30: 0.3941 - val_accuracy50: 0.3927 - 7s/epoch - 22ms/step
Epoch 6/50
323/323 - 7s - loss: 12.8305 - accuracy10: 0.4304 - accuracy20: 0.4259 - accuracy30: 0.4230 - accuracy50: 0.4169 - val_loss: 13.0300 - val_accuracy10: 0.4046 - val_accuracy20: 0.3986 - val_accuracy30: 0.3978 - val_accuracy50: 0.3972 - 7s/epoch - 22ms/step
Epoch 7/50
323/323 - 7s - loss: 12.8049 - accuracy10: 0.4331 - accuracy20: 0.4283 - accuracy30: 0.4258 - accuracy50: 0.4180 - val_loss: 13.0276 - val_accuracy10: 0.4046 - val_accuracy20: 0.3996 - val_accuracy30: 0.3986 - val_accuracy50: 0.3948 - 7s/epoch - 21ms/step
Epoch 8/50
323/323 - 7s - loss: 12.7812 - accuracy10: 0.4375 - accuracy20: 0.4308 - accuracy30: 0.4278 - accuracy50: 0.4210 - val_loss: 13.0178 - val_accuracy10: 0.4034 - val_accuracy20: 0.3997 - val_accuracy30: 0.3982 - val_accuracy50: 0.3982 - 7s/epoch - 22ms/step
Epoch 9/50
323/323 - 7s - loss: 12.7638 - accuracy10: 0.4382 - accuracy20: 0.4332 - accuracy30: 0.4299 - accuracy50: 0.4235 - val_loss: 13.0004 - val_accuracy10: 0.4101 - val_accuracy20: 0.4045 - val_accuracy30: 0.4010 - val_accuracy50: 0.3988 - 7s/epoch - 22ms/step
Epoch 10/50
323/323 - 7s - loss: 12.7386 - accuracy10: 0.4406 - accuracy20: 0.4359 - accuracy30: 0.4340 - accuracy50: 0.4271 - val_loss: 13.0077 - val_accuracy10: 0.4060 - val_accuracy20: 0.4019 - val_accuracy30: 0.4032 - val_accuracy50: 0.4003 - 7s/epoch - 22ms/step
Epoch 11/50
323/323 - 7s - loss: 12.7145 - accuracy10: 0.4435 - accuracy20: 0.4405 - accuracy30: 0.4366 - accuracy50: 0.4300 - val_loss: 13.0086 - val_accuracy10: 0.4063 - val_accuracy20: 0.4045 - val_accuracy30: 0.4035 - val_accuracy50: 0.4005 - 7s/epoch - 22ms/step
Epoch 12/50
323/323 - 7s - loss: 12.6951 - accuracy10: 0.4452 - accuracy20: 0.4414 - accuracy30: 0.4389 - accuracy50: 0.4322 - val_loss: 12.9931 - val_accuracy10: 0.4107 - val_accuracy20: 0.4047 - val_accuracy30: 0.4034 - val_accuracy50: 0.4005 - 7s/epoch - 21ms/step
Epoch 13/50
323/323 - 7s - loss: 12.6773 - accuracy10: 0.4478 - accuracy20: 0.4438 - accuracy30: 0.4410 - accuracy50: 0.4335 - val_loss: 12.9933 - val_accuracy10: 0.4115 - val_accuracy20: 0.4057 - val_accuracy30: 0.4042 - val_accuracy50: 0.4017 - 7s/epoch - 21ms/step
Epoch 14/50
323/323 - 7s - loss: 12.6561 - accuracy10: 0.4484 - accuracy20: 0.4460 - accuracy30: 0.4437 - accuracy50: 0.4364 - val_loss: 12.9995 - val_accuracy10: 0.4100 - val_accuracy20: 0.4057 - val_accuracy30: 0.4022 - val_accuracy50: 0.4013 - 7s/epoch - 22ms/step
Epoch 15/50
323/323 - 7s - loss: 12.6407 - accuracy10: 0.4498 - accuracy20: 0.4491 - accuracy30: 0.4448 - accuracy50: 0.4380 - val_loss: 13.0141 - val_accuracy10: 0.4110 - val_accuracy20: 0.4056 - val_accuracy30: 0.4028 - val_accuracy50: 0.4012 - 7s/epoch - 23ms/step
Epoch 16/50
323/323 - 7s - loss: 12.6228 - accuracy10: 0.4522 - accuracy20: 0.4487 - accuracy30: 0.4475 - accuracy50: 0.4401 - val_loss: 12.9957 - val_accuracy10: 0.4138 - val_accuracy20: 0.4053 - val_accuracy30: 0.4034 - val_accuracy50: 0.4008 - 7s/epoch - 22ms/step
Epoch 17/50
323/323 - 7s - loss: 12.6075 - accuracy10: 0.4524 - accuracy20: 0.4504 - accuracy30: 0.4494 - accuracy50: 0.4444 - val_loss: 13.0108 - val_accuracy10: 0.4115 - val_accuracy20: 0.4055 - val_accuracy30: 0.4028 - val_accuracy50: 0.3992 - 7s/epoch - 21ms/step
Epoch 18/50
323/323 - 7s - loss: 12.5792 - accuracy10: 0.4540 - accuracy20: 0.4536 - accuracy30: 0.4522 - accuracy50: 0.4464 - val_loss: 13.0028 - val_accuracy10: 0.4140 - val_accuracy20: 0.4103 - val_accuracy30: 0.4077 - val_accuracy50: 0.4043 - 7s/epoch - 22ms/step
Epoch 19/50
323/323 - 7s - loss: 12.5742 - accuracy10: 0.4544 - accuracy20: 0.4550 - accuracy30: 0.4538 - accuracy50: 0.4469 - val_loss: 13.0211 - val_accuracy10: 0.4117 - val_accuracy20: 0.4074 - val_accuracy30: 0.4054 - val_accuracy50: 0.4041 - 7s/epoch - 22ms/step
Epoch 20/50
323/323 - 7s - loss: 12.5529 - accuracy10: 0.4580 - accuracy20: 0.4577 - accuracy30: 0.4551 - accuracy50: 0.4495 - val_loss: 13.0452 - val_accuracy10: 0.4100 - val_accuracy20: 0.4064 - val_accuracy30: 0.4039 - val_accuracy50: 0.4006 - 7s/epoch - 21ms/step
Epoch 21/50
323/323 - 7s - loss: 12.5318 - accuracy10: 0.4571 - accuracy20: 0.4577 - accuracy30: 0.4567 - accuracy50: 0.4506 - val_loss: 13.0499 - val_accuracy10: 0.4128 - val_accuracy20: 0.4078 - val_accuracy30: 0.4069 - val_accuracy50: 0.4037 - 7s/epoch - 22ms/step
Epoch 22/50
323/323 - 7s - loss: 12.5233 - accuracy10: 0.4613 - accuracy20: 0.4600 - accuracy30: 0.4579 - accuracy50: 0.4522 - val_loss: 13.0716 - val_accuracy10: 0.4102 - val_accuracy20: 0.4063 - val_accuracy30: 0.4038 - val_accuracy50: 0.4012 - 7s/epoch - 21ms/step
testing model: results/CHTR/W9/deepOF_L1/seq2seq
Evaluating performance on  test set...
604/604 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0762358
{'0': {'precision': 0.4503979678238781, 'recall': 0.2539046091572154, 'f1-score': 0.3247414498345523, 'support': 52374}, '1': {'precision': 0.4270264702853023, 'recall': 0.46255973521262944, 'f1-score': 0.4440834397008024, 'support': 53779}, '2': {'precision': 0.3962989088835192, 'recall': 0.5471971816392084, 'f1-score': 0.4596810696006406, 'support': 48255}, 'accuracy': 0.4182361017563857, 'macro avg': {'precision': 0.4245744489975665, 'recall': 0.42122050866968436, 'f1-score': 0.4095019863786651, 'support': 154408}, 'weighted avg': {'precision': 0.42535104114071337, 'recall': 0.4182361017563857, 'f1-score': 0.40847807115488316, 'support': 154408}}
[[13298 19405 19671]
 [ 8350 24876 20553]
 [ 7877 13973 26405]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0782814
{'0': {'precision': 0.4342954870685142, 'recall': 0.2545934443671482, 'f1-score': 0.3210061270557885, 'support': 48874}, '1': {'precision': 0.44243254817987154, 'recall': 0.43346256482553747, 'f1-score': 0.43790162600247545, 'support': 59583}, '2': {'precision': 0.37272565373541894, 'recall': 0.5465604665839698, 'f1-score': 0.443207185903488, 'support': 45951}, 'accuracy': 0.41050334179576187, 'macro avg': {'precision': 0.4164845629946015, 'recall': 0.4115388252588852, 'f1-score': 0.4007049796539173, 'support': 154408}, 'weighted avg': {'precision': 0.4191125632608679, 'recall': 0.41050334179576187, 'f1-score': 0.4024801787166551, 'support': 154408}}
[[12443 18544 17887]
 [ 9376 25827 24380]
 [ 6832 14004 25115]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0825635
{'0': {'precision': 0.4406535665443029, 'recall': 0.24944484058266272, 'f1-score': 0.31855966489313264, 'support': 49085}, '1': {'precision': 0.42663844199830653, 'recall': 0.42292841794251945, 'f1-score': 0.424775329208046, 'support': 59568}, '2': {'precision': 0.3639525247143787, 'recall': 0.5374931701453393, 'f1-score': 0.4340183716148843, 'support': 45755}, 'accuracy': 0.40172788974664525, 'macro avg': {'precision': 0.41041484441899606, 'recall': 0.4032888095568405, 'f1-score': 0.3924511219053543, 'support': 154408}, 'weighted avg': {'precision': 0.41251830730978073, 'recall': 0.40172788974664525, 'f1-score': 0.3937492134784683, 'support': 154408}}
[[12244 19132 17709]
 [ 9105 25193 25270]
 [ 6437 14725 24593]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0865076
{'0': {'precision': 0.43630963430480785, 'recall': 0.24115076026511809, 'f1-score': 0.3106200771792567, 'support': 48733}, '1': {'precision': 0.41947752146546424, 'recall': 0.42082639120293236, 'f1-score': 0.4201508737201933, 'support': 60020}, '2': {'precision': 0.35469818614332443, 'recall': 0.522549556456029, 'f1-score': 0.4225656467254129, 'support': 45655}, 'accuracy': 0.3941958965856691, 'macro avg': {'precision': 0.40349511397119886, 'recall': 0.3948422359746931, 'f1-score': 0.38444553254162095, 'support': 154408}, 'weighted avg': {'precision': 0.40563613242388247, 'recall': 0.3941958965856691, 'f1-score': 0.3862956470073535, 'support': 154408}}
[[11752 19381 17600]
 [ 8959 25258 25803]
 [ 6224 15574 23857]]
Evaluating performance on  train set...
323/323 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0643407
{'0': {'precision': 0.48585240090235254, 'recall': 0.2563248095756257, 'f1-score': 0.3355964650624402, 'support': 29408}, '1': {'precision': 0.3992851445957522, 'recall': 0.5196248029831239, 'f1-score': 0.4515751845788929, 'support': 26013}, '2': {'precision': 0.43803168304926804, 'recall': 0.5354596898655104, 'f1-score': 0.48187033944544566, 'support': 27214}, 'accuracy': 0.4311369274520482, 'macro avg': {'precision': 0.44105640951579095, 'recall': 0.43713643414141995, 'f1-score': 0.4230139963622596, 'support': 82635}, 'weighted avg': {'precision': 0.4428528601029645, 'recall': 0.4311369274520482, 'f1-score': 0.42027791539511516, 'support': 82635}}
[[ 7538 11927  9943]
 [ 3744 13517  8752]
 [ 4233  8409 14572]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0654361
{'0': {'precision': 0.478988816094236, 'recall': 0.25244140625, 'f1-score': 0.33063061005413064, 'support': 28672}, '1': {'precision': 0.4131322094055013, 'recall': 0.5015980177397924, 'f1-score': 0.4530872407025966, 'support': 27847}, '2': {'precision': 0.4210713650115679, 'recall': 0.5435748200336958, 'f1-score': 0.4745445428714692, 'support': 26116}, 'accuracy': 0.4284141102438434, 'macro avg': {'precision': 0.43773079683710175, 'recall': 0.4325380813411628, 'f1-score': 0.4194207978760655, 'support': 82635}, 'weighted avg': {'precision': 0.4384916771224183, 'recall': 0.4284141102438434, 'f1-score': 0.41737963967989994, 'support': 82635}}
[[ 7238 11712  9722]
 [ 4083 13968  9796]
 [ 3790  8130 14196]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0680642
{'0': {'precision': 0.4854481164150687, 'recall': 0.24546142208774585, 'f1-score': 0.32605617720940855, 'support': 29084}, '1': {'precision': 0.4010231382118602, 'recall': 0.496704417173446, 'f1-score': 0.4437648436737483, 'support': 27461}, '2': {'precision': 0.42130557848802924, 'recall': 0.547681103871215, 'f1-score': 0.4762523747625237, 'support': 26090}, 'accuracy': 0.42437223936588614, 'macro avg': {'precision': 0.4359256110383194, 'recall': 0.42994898104413565, 'f1-score': 0.4153577985485602, 'support': 82635}, 'weighted avg': {'precision': 0.43714082360990414, 'recall': 0.42437223936588614, 'f1-score': 0.41259355826995203, 'support': 82635}}
[[ 7139 12092  9853]
 [ 4047 13640  9774]
 [ 3520  8281 14289]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0732967
{'0': {'precision': 0.4894140817331364, 'recall': 0.23672302929268874, 'f1-score': 0.31910112359550563, 'support': 29393}, '1': {'precision': 0.383514828544949, 'recall': 0.48760908789630664, 'f1-score': 0.42934262786739075, 'support': 27157}, '2': {'precision': 0.4172322218943641, 'recall': 0.5420739888824995, 'f1-score': 0.4715298040850354, 'support': 26085}, 'accuracy': 0.41556241302111696, 'macro avg': {'precision': 0.43005371072414983, 'recall': 0.4221353686904983, 'f1-score': 0.4066578518493105, 'support': 82635}, 'weighted avg': {'precision': 0.4318262577756609, 'recall': 0.41556241302111696, 'f1-score': 0.40344711091420793, 'support': 82635}}
[[ 6958 12628  9807]
 [ 3972 13242  9943]
 [ 3287  8658 14140]]
Evaluating performance on  val set...
112/112 - 1s - 861ms/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0860473
{'0': {'precision': 0.49392926271335563, 'recall': 0.2585428755641522, 'f1-score': 0.3394195888754534, 'support': 10857}, '1': {'precision': 0.3124883155730043, 'recall': 0.44543637574950035, 'f1-score': 0.36730209306158335, 'support': 7505}, '2': {'precision': 0.4527127924340468, 'recall': 0.5417452596048844, 'f1-score': 0.49324354860577574, 'support': 10073}, 'accuracy': 0.40819412695621593, 'macro avg': {'precision': 0.4197101235734689, 'recall': 0.4152415036395123, 'f1-score': 0.3999884101809375, 'support': 28435}, 'weighted avg': {'precision': 0.4314398020693671, 'recall': 0.40819412695621593, 'f1-score': 0.4012703692616128, 'support': 28435}}
[[2807 4347 3703]
 [1268 3343 2894]
 [1608 3008 5457]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0867237
{'0': {'precision': 0.49627611262488647, 'recall': 0.25836958577643276, 'f1-score': 0.3398221282418061, 'support': 10574}, '1': {'precision': 0.32657257687634356, 'recall': 0.4329615861214374, 'f1-score': 0.3723160530662262, 'support': 8070}, '2': {'precision': 0.43553266290573134, 'recall': 0.5440710856909406, 'f1-score': 0.4837889383343929, 'support': 9791}, 'accuracy': 0.4062950589062775, 'macro avg': {'precision': 0.4194604508023205, 'recall': 0.41180075252960363, 'f1-score': 0.39864237321414175, 'support': 28435}, 'weighted avg': {'precision': 0.42719763013179735, 'recall': 0.4062950589062775, 'f1-score': 0.3986160445755352, 'support': 28435}}
[[2732 4202 3640]
 [1312 3494 3264]
 [1461 3003 5327]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0866683
{'0': {'precision': 0.49691761628993086, 'recall': 0.25201326385599243, 'f1-score': 0.3344229318581845, 'support': 10555}, '1': {'precision': 0.31417161961367013, 'recall': 0.4238817190828217, 'f1-score': 0.3608725798709264, 'support': 7981}, '2': {'precision': 0.4392561312327432, 'recall': 0.5464188301848671, 'f1-score': 0.48701211002566064, 'support': 9899}, 'accuracy': 0.40274309829435556, 'macro avg': {'precision': 0.4167817890454481, 'recall': 0.40743793770789377, 'f1-score': 0.39410254058492383, 'support': 28435}, 'weighted avg': {'precision': 0.42555180513978713, 'recall': 0.40274309829435556, 'f1-score': 0.3949671525534383, 'support': 28435}}
[[2660 4288 3607]
 [1300 3383 3298]
 [1393 3097 5409]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0874671
{'0': {'precision': 0.4929928969091956, 'recall': 0.24621284755512943, 'f1-score': 0.3284097448685977, 'support': 10430}, '1': {'precision': 0.3105022831050228, 'recall': 0.4211047807778053, 'f1-score': 0.35744322960470987, 'support': 8074}, '2': {'precision': 0.4375203649397198, 'recall': 0.5408317389990938, 'f1-score': 0.4837213491241501, 'support': 9931}, 'accuracy': 0.39876912256022506, 'macro avg': {'precision': 0.4136718483179795, 'recall': 0.40271645577734283, 'f1-score': 0.3898581078658192, 'support': 28435}, 'weighted avg': {'precision': 0.4218015154833558, 'recall': 0.39876912256022506, 'f1-score': 0.3908966763833246, 'support': 28435}}
[[2568 4337 3525]
 [1294 3400 3380]
 [1347 3213 5371]]
training model: results/CHTR/W9/deepLOB_L2/seq2seq
Epoch 1/50
323/323 - 22s - loss: 13.2360 - accuracy10: 0.3659 - accuracy20: 0.3672 - accuracy30: 0.3673 - accuracy50: 0.3644 - val_loss: 13.4642 - val_accuracy10: 0.2999 - val_accuracy20: 0.3101 - val_accuracy30: 0.3117 - val_accuracy50: 0.3165 - 22s/epoch - 68ms/step
Epoch 2/50
323/323 - 16s - loss: 13.1396 - accuracy10: 0.3747 - accuracy20: 0.3755 - accuracy30: 0.3770 - accuracy50: 0.3741 - val_loss: 13.3310 - val_accuracy10: 0.3285 - val_accuracy20: 0.3352 - val_accuracy30: 0.3256 - val_accuracy50: 0.3244 - 16s/epoch - 49ms/step
Epoch 3/50
323/323 - 16s - loss: 13.0456 - accuracy10: 0.3914 - accuracy20: 0.3897 - accuracy30: 0.3897 - accuracy50: 0.3867 - val_loss: 13.2003 - val_accuracy10: 0.3580 - val_accuracy20: 0.3562 - val_accuracy30: 0.3543 - val_accuracy50: 0.3504 - 16s/epoch - 49ms/step
Epoch 4/50
323/323 - 16s - loss: 13.0126 - accuracy10: 0.3930 - accuracy20: 0.3927 - accuracy30: 0.3939 - accuracy50: 0.3914 - val_loss: 13.1185 - val_accuracy10: 0.3836 - val_accuracy20: 0.3815 - val_accuracy30: 0.3843 - val_accuracy50: 0.3803 - 16s/epoch - 50ms/step
Epoch 5/50
323/323 - 16s - loss: 12.9560 - accuracy10: 0.4042 - accuracy20: 0.4002 - accuracy30: 0.4016 - accuracy50: 0.3972 - val_loss: 13.1028 - val_accuracy10: 0.3913 - val_accuracy20: 0.3872 - val_accuracy30: 0.3901 - val_accuracy50: 0.3888 - 16s/epoch - 49ms/step
Epoch 6/50
323/323 - 16s - loss: 12.9056 - accuracy10: 0.4127 - accuracy20: 0.4100 - accuracy30: 0.4095 - accuracy50: 0.4032 - val_loss: 13.2100 - val_accuracy10: 0.3774 - val_accuracy20: 0.3733 - val_accuracy30: 0.3761 - val_accuracy50: 0.3775 - 16s/epoch - 49ms/step
Epoch 7/50
323/323 - 16s - loss: 12.8630 - accuracy10: 0.4217 - accuracy20: 0.4179 - accuracy30: 0.4155 - accuracy50: 0.4107 - val_loss: 13.1709 - val_accuracy10: 0.3827 - val_accuracy20: 0.3777 - val_accuracy30: 0.3789 - val_accuracy50: 0.3759 - 16s/epoch - 48ms/step
Epoch 8/50
323/323 - 16s - loss: 12.8265 - accuracy10: 0.4272 - accuracy20: 0.4232 - accuracy30: 0.4199 - accuracy50: 0.4138 - val_loss: 13.2180 - val_accuracy10: 0.3854 - val_accuracy20: 0.3791 - val_accuracy30: 0.3803 - val_accuracy50: 0.3776 - 16s/epoch - 48ms/step
Epoch 9/50
323/323 - 15s - loss: 12.7804 - accuracy10: 0.4325 - accuracy20: 0.4300 - accuracy30: 0.4283 - accuracy50: 0.4212 - val_loss: 13.1774 - val_accuracy10: 0.3878 - val_accuracy20: 0.3820 - val_accuracy30: 0.3832 - val_accuracy50: 0.3800 - 15s/epoch - 48ms/step
Epoch 10/50
323/323 - 16s - loss: 12.7446 - accuracy10: 0.4362 - accuracy20: 0.4342 - accuracy30: 0.4313 - accuracy50: 0.4235 - val_loss: 13.1843 - val_accuracy10: 0.3903 - val_accuracy20: 0.3842 - val_accuracy30: 0.3839 - val_accuracy50: 0.3812 - 16s/epoch - 49ms/step
Epoch 11/50
323/323 - 15s - loss: 12.7071 - accuracy10: 0.4399 - accuracy20: 0.4392 - accuracy30: 0.4368 - accuracy50: 0.4288 - val_loss: 13.2153 - val_accuracy10: 0.3880 - val_accuracy20: 0.3798 - val_accuracy30: 0.3787 - val_accuracy50: 0.3761 - 15s/epoch - 48ms/step
Epoch 12/50
323/323 - 16s - loss: 12.6787 - accuracy10: 0.4424 - accuracy20: 0.4418 - accuracy30: 0.4398 - accuracy50: 0.4319 - val_loss: 13.1958 - val_accuracy10: 0.3968 - val_accuracy20: 0.3866 - val_accuracy30: 0.3869 - val_accuracy50: 0.3840 - 16s/epoch - 50ms/step
Epoch 13/50
323/323 - 16s - loss: 12.6381 - accuracy10: 0.4465 - accuracy20: 0.4466 - accuracy30: 0.4456 - accuracy50: 0.4377 - val_loss: 13.2430 - val_accuracy10: 0.3895 - val_accuracy20: 0.3833 - val_accuracy30: 0.3797 - val_accuracy50: 0.3749 - 16s/epoch - 49ms/step
Epoch 14/50
323/323 - 15s - loss: 12.6006 - accuracy10: 0.4499 - accuracy20: 0.4503 - accuracy30: 0.4500 - accuracy50: 0.4407 - val_loss: 13.2564 - val_accuracy10: 0.3861 - val_accuracy20: 0.3773 - val_accuracy30: 0.3764 - val_accuracy50: 0.3782 - 15s/epoch - 48ms/step
Epoch 15/50
323/323 - 15s - loss: 12.5697 - accuracy10: 0.4530 - accuracy20: 0.4552 - accuracy30: 0.4536 - accuracy50: 0.4443 - val_loss: 13.3271 - val_accuracy10: 0.3842 - val_accuracy20: 0.3784 - val_accuracy30: 0.3773 - val_accuracy50: 0.3742 - 15s/epoch - 48ms/step
testing model: results/CHTR/W9/deepLOB_L2/seq2seq
Evaluating performance on  test set...
604/604 - 11s - 11s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1073782
{'0': {'precision': 0.410762974259439, 'recall': 0.3394111806934474, 'f1-score': 0.37169381311811317, 'support': 52376}, '1': {'precision': 0.414313248973435, 'recall': 0.09193008553365563, 'f1-score': 0.15047250924474606, 'support': 53780}, '2': {'precision': 0.34685134222437275, 'recall': 0.7130305039787799, 'f1-score': 0.46668520314396733, 'support': 48256}, 'accuracy': 0.3699777219387094, 'macro avg': {'precision': 0.39064252181908227, 'recall': 0.3814572567352943, 'f1-score': 0.3296171751689422, 'support': 154412}, 'weighted avg': {'precision': 0.39202617957142605, 'recall': 0.3699777219387094, 'f1-score': 0.3243310614846775, 'support': 154412}}
[[17777  3277 31322]
 [15365  4944 33471]
 [10136  3712 34408]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1107323
{'0': {'precision': 0.39103343789343403, 'recall': 0.37492839021196495, 'f1-score': 0.38281160237729656, 'support': 48876}, '1': {'precision': 0.43975186947654654, 'recall': 0.08685217508055854, 'f1-score': 0.14505549949545912, 'support': 59584}, '2': {'precision': 0.3327799876802289, 'recall': 0.6936368384401114, 'f1-score': 0.44977528169163145, 'support': 45952}, 'accuracy': 0.35861202497215244, 'macro avg': {'precision': 0.38785509835006976, 'recall': 0.38513913457754495, 'f1-score': 0.32588079452146235, 'support': 154412}, 'weighted avg': {'precision': 0.39249690241206586, 'recall': 0.35861202497215244, 'f1-score': 0.3109950036527215, 'support': 154412}}
[[18325  3011 27540]
 [18042  5175 36367]
 [10496  3582 31874]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1068798
{'0': {'precision': 0.39304882706494865, 'recall': 0.3983335710065802, 'f1-score': 0.3956735536353886, 'support': 49087}, '1': {'precision': 0.4201736254650682, 'recall': 0.08531426269137792, 'f1-score': 0.14183051225876672, 'support': 59568}, '2': {'precision': 0.3316409203845738, 'recall': 0.6709355945538388, 'f1-score': 0.44387574370874805, 'support': 45757}, 'accuracy': 0.35835945392845114, 'macro avg': {'precision': 0.38162112430486356, 'recall': 0.38486114275059896, 'f1-score': 0.3271266032009678, 'support': 154412}, 'weighted avg': {'precision': 0.3853158037579803, 'recall': 0.35835945392845114, 'f1-score': 0.3120315136544551, 'support': 154412}}
[[19553  3290 26244]
 [18860  5082 35626]
 [11334  3723 30700]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1059785
{'0': {'precision': 0.38068159535668067, 'recall': 0.39835029546946815, 'f1-score': 0.3893155794413139, 'support': 48736}, '1': {'precision': 0.41527756537696897, 'recall': 0.0904865044985005, 'f1-score': 0.14859503679991246, 'support': 60020}, '2': {'precision': 0.32588336875664187, 'recall': 0.6448002453127738, 'f1-score': 0.43295193834931467, 'support': 45656}, 'accuracy': 0.3515529881097324, 'macro avg': {'precision': 0.3739475098300971, 'recall': 0.37787901509358085, 'f1-score': 0.32362085153018033, 'support': 154412}, 'weighted avg': {'precision': 0.3779265134133494, 'recall': 0.3515529881097324, 'f1-score': 0.30864966379335107, 'support': 154412}}
[[19414  3769 25553]
 [19245  5431 35344]
 [12339  3878 29439]]
Evaluating performance on  train set...
323/323 - 6s - 6s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0793853
{'0': {'precision': 0.4403423514905346, 'recall': 0.41285277116626995, 'f1-score': 0.4261547100940615, 'support': 29410}, '1': {'precision': 0.36778198571038145, 'recall': 0.3633418190233742, 'f1-score': 0.3655484196433769, 'support': 25926}, '2': {'precision': 0.4117427329530019, 'recall': 0.44415546357009417, 'f1-score': 0.42733536574620684, 'support': 27299}, 'accuracy': 0.407660192412416, 'macro avg': {'precision': 0.4066223567179727, 'recall': 0.4067833512532461, 'f1-score': 0.4063461651612151, 'support': 82635}, 'weighted avg': {'precision': 0.40812911218912046, 'recall': 0.407660192412416, 'f1-score': 0.4075300599146396, 'support': 82635}}
[[12142  8178  9090]
 [ 8273  9420  8233]
 [ 7159  8015 12125]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0787072
{'0': {'precision': 0.42768246378849667, 'recall': 0.42514153910673097, 'f1-score': 0.42640821620105857, 'support': 28614}, '1': {'precision': 0.3872644828394965, 'recall': 0.3554590793297693, 'f1-score': 0.3706807849886816, 'support': 27871}, '2': {'precision': 0.3995945331888566, 'recall': 0.43717017208413, 'f1-score': 0.41753866944246604, 'support': 26150}, 'accuracy': 0.4054456344164095, 'macro avg': {'precision': 0.40484715993895, 'recall': 0.40592359684021, 'f1-score': 0.40487589021073545, 'support': 82635}, 'weighted avg': {'precision': 0.4051618740600502, 'recall': 0.4054456344164095, 'f1-score': 0.404805773131447, 'support': 82635}}
[[12165  7988  8461]
 [ 9248  9907  8716]
 [ 7031  7687 11432]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0790085
{'0': {'precision': 0.4295612009237875, 'recall': 0.4246869162111672, 'f1-score': 0.42711015239023026, 'support': 28906}, '1': {'precision': 0.3791027607361963, 'recall': 0.35765446389813343, 'f1-score': 0.36806641352095903, 'support': 27644}, '2': {'precision': 0.39868463380634095, 'recall': 0.42760207015526164, 'f1-score': 0.41263734231068033, 'support': 26085}, 'accuracy': 0.403182670781146, 'macro avg': {'precision': 0.40244953182210824, 'recall': 0.40331448342152076, 'f1-score': 0.4026046360739566, 'support': 82635}, 'weighted avg': {'precision': 0.40293460960286587, 'recall': 0.403182670781146, 'f1-score': 0.4027896057910024, 'support': 82635}}
[[12276  8384  8246]
 [ 9180  9887  8577]
 [ 7122  7809 11154]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0817734
{'0': {'precision': 0.4342558709631577, 'recall': 0.4162863565152238, 'f1-score': 0.4250812916239197, 'support': 29362}, '1': {'precision': 0.36670128328758994, 'recall': 0.36315886134067954, 'f1-score': 0.36492147563068633, 'support': 27225}, '2': {'precision': 0.3933372084574584, 'recall': 0.41565571253071254, 'f1-score': 0.4041885989472505, 'support': 26048}, 'accuracy': 0.3985841350517335, 'macro avg': {'precision': 0.3980981209027354, 'recall': 0.3983669767955386, 'f1-score': 0.3980637887339522, 'support': 82635}, 'weighted avg': {'precision': 0.3991009974783657, 'recall': 0.3985841350517335, 'f1-score': 0.3986752427432074, 'support': 82635}}
[[12223  9011  8128]
 [ 8767  9887  8571]
 [ 7157  8064 10827]]
Evaluating performance on  val set...
112/112 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0930389
{'0': {'precision': 0.4681008902077151, 'recall': 0.28952922822795263, 'f1-score': 0.35777059590633326, 'support': 10897}, '1': {'precision': 0.2794802172226532, 'recall': 0.19404793967142472, 'f1-score': 0.22905738356382133, 'support': 7426}, '2': {'precision': 0.38784764207980654, 'recall': 0.6343320478591912, 'f1-score': 0.4813717029977864, 'support': 10113}, 'accuracy': 0.3872204248136165, 'macro avg': {'precision': 0.37847624983672495, 'recall': 0.37263640525285613, 'f1-score': 0.356066560822647, 'support': 28436}, 'weighted avg': {'precision': 0.3903016844155992, 'recall': 0.3872204248136165, 'f1-score': 0.36811500725674723, 'support': 28436}}
[[3155 1910 5832]
 [1692 1441 4293]
 [1893 1805 6415]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0963937
{'0': {'precision': 0.45597950653903196, 'recall': 0.3195993195993196, 'f1-score': 0.37579865548086, 'support': 10582}, '1': {'precision': 0.3018569735282497, 'recall': 0.18934324659231722, 'f1-score': 0.23271398111483396, 'support': 8070}, '2': {'precision': 0.38127467569091933, 'recall': 0.6218315617334423, 'f1-score': 0.4727089079678334, 'support': 9784}, 'accuracy': 0.38662259108172736, 'macro avg': {'precision': 0.379703718586067, 'recall': 0.3769247093083597, 'f1-score': 0.3604071815211758, 'support': 28436}, 'weighted avg': {'precision': 0.38653651503477865, 'recall': 0.38662259108172736, 'f1-score': 0.36853591065735164, 'support': 28436}}
[[3382 1850 5350]
 [2019 1528 4523]
 [2016 1684 6084]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0926677
{'0': {'precision': 0.44936868686868686, 'recall': 0.33683513155404127, 'f1-score': 0.3850481445418154, 'support': 10566}, '1': {'precision': 0.2917329093799682, 'recall': 0.18458443354708914, 'f1-score': 0.22610704659222178, 'support': 7953}, '2': {'precision': 0.38917592353397057, 'recall': 0.6076434405566199, 'f1-score': 0.4744695090744459, 'support': 9917}, 'accuracy': 0.38869742579828387, 'macro avg': {'precision': 0.37675917326087527, 'recall': 0.37635433521925005, 'f1-score': 0.36187490006949435, 'support': 28436}, 'weighted avg': {'precision': 0.3842888946208967, 'recall': 0.38869742579828387, 'f1-score': 0.37178091708637084, 'support': 28436}}
[[3559 1870 5137]
 [2164 1468 4321]
 [2197 1694 6026]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0929937
{'0': {'precision': 0.43957796589375536, 'recall': 0.34149828440716734, 'f1-score': 0.38438019632033466, 'support': 10492}, '1': {'precision': 0.293343653250774, 'recall': 0.18836978131212723, 'f1-score': 0.22941888619854722, 'support': 8048}, '2': {'precision': 0.38737844810478267, 'recall': 0.5917542441390461, 'f1-score': 0.46823651701115415, 'support': 9896}, 'accuracy': 0.38525109016739345, 'macro avg': {'precision': 0.37343335574977066, 'recall': 0.37387410328611353, 'f1-score': 0.3606785331766787, 'support': 28436}, 'weighted avg': {'precision': 0.3800245766621339, 'recall': 0.38525109016739345, 'f1-score': 0.36970561219092846, 'support': 28436}}
[[3583 1895 5014]
 [2285 1516 4247]
 [2283 1757 5856]]
training model: results/CHTR/W9/deepOF_L2/seq2seq
Epoch 1/50
323/323 - 16s - loss: 13.1992 - accuracy10: 0.3765 - accuracy20: 0.3763 - accuracy30: 0.3747 - accuracy50: 0.3721 - val_loss: 13.3856 - val_accuracy10: 0.3382 - val_accuracy20: 0.3381 - val_accuracy30: 0.3355 - val_accuracy50: 0.3354 - 16s/epoch - 48ms/step
Epoch 2/50
323/323 - 10s - loss: 13.0213 - accuracy10: 0.4015 - accuracy20: 0.3964 - accuracy30: 0.3953 - accuracy50: 0.3915 - val_loss: 13.1238 - val_accuracy10: 0.3644 - val_accuracy20: 0.3624 - val_accuracy30: 0.3618 - val_accuracy50: 0.3645 - 10s/epoch - 30ms/step
Epoch 3/50
323/323 - 10s - loss: 12.9158 - accuracy10: 0.4173 - accuracy20: 0.4100 - accuracy30: 0.4095 - accuracy50: 0.4041 - val_loss: 13.0770 - val_accuracy10: 0.3788 - val_accuracy20: 0.3782 - val_accuracy30: 0.3754 - val_accuracy50: 0.3809 - 10s/epoch - 30ms/step
Epoch 4/50
323/323 - 10s - loss: 12.8416 - accuracy10: 0.4296 - accuracy20: 0.4237 - accuracy30: 0.4197 - accuracy50: 0.4150 - val_loss: 13.0254 - val_accuracy10: 0.3923 - val_accuracy20: 0.3900 - val_accuracy30: 0.3892 - val_accuracy50: 0.3881 - 10s/epoch - 31ms/step
Epoch 5/50
323/323 - 10s - loss: 12.7864 - accuracy10: 0.4376 - accuracy20: 0.4303 - accuracy30: 0.4282 - accuracy50: 0.4222 - val_loss: 13.0312 - val_accuracy10: 0.3970 - val_accuracy20: 0.3951 - val_accuracy30: 0.3921 - val_accuracy50: 0.3910 - 10s/epoch - 30ms/step
Epoch 6/50
323/323 - 10s - loss: 12.7452 - accuracy10: 0.4426 - accuracy20: 0.4362 - accuracy30: 0.4327 - accuracy50: 0.4246 - val_loss: 12.9968 - val_accuracy10: 0.4038 - val_accuracy20: 0.4000 - val_accuracy30: 0.3994 - val_accuracy50: 0.3993 - 10s/epoch - 30ms/step
Epoch 7/50
323/323 - 10s - loss: 12.6988 - accuracy10: 0.4467 - accuracy20: 0.4408 - accuracy30: 0.4371 - accuracy50: 0.4305 - val_loss: 13.0198 - val_accuracy10: 0.4077 - val_accuracy20: 0.4023 - val_accuracy30: 0.4020 - val_accuracy50: 0.4012 - 10s/epoch - 30ms/step
Epoch 8/50
323/323 - 10s - loss: 12.6540 - accuracy10: 0.4514 - accuracy20: 0.4463 - accuracy30: 0.4436 - accuracy50: 0.4355 - val_loss: 13.0281 - val_accuracy10: 0.4076 - val_accuracy20: 0.4046 - val_accuracy30: 0.4015 - val_accuracy50: 0.3998 - 10s/epoch - 30ms/step
Epoch 9/50
323/323 - 10s - loss: 12.6094 - accuracy10: 0.4572 - accuracy20: 0.4521 - accuracy30: 0.4476 - accuracy50: 0.4395 - val_loss: 13.0070 - val_accuracy10: 0.4153 - val_accuracy20: 0.4103 - val_accuracy30: 0.4057 - val_accuracy50: 0.4057 - 10s/epoch - 29ms/step
Epoch 10/50
323/323 - 9s - loss: 12.5756 - accuracy10: 0.4604 - accuracy20: 0.4553 - accuracy30: 0.4538 - accuracy50: 0.4452 - val_loss: 13.0169 - val_accuracy10: 0.4105 - val_accuracy20: 0.4066 - val_accuracy30: 0.4061 - val_accuracy50: 0.4037 - 9s/epoch - 29ms/step
Epoch 11/50
323/323 - 10s - loss: 12.5332 - accuracy10: 0.4641 - accuracy20: 0.4609 - accuracy30: 0.4585 - accuracy50: 0.4494 - val_loss: 13.0176 - val_accuracy10: 0.4181 - val_accuracy20: 0.4129 - val_accuracy30: 0.4130 - val_accuracy50: 0.4094 - 10s/epoch - 30ms/step
Epoch 12/50
323/323 - 10s - loss: 12.4866 - accuracy10: 0.4690 - accuracy20: 0.4661 - accuracy30: 0.4652 - accuracy50: 0.4554 - val_loss: 13.0209 - val_accuracy10: 0.4166 - val_accuracy20: 0.4140 - val_accuracy30: 0.4093 - val_accuracy50: 0.4082 - 10s/epoch - 30ms/step
Epoch 13/50
323/323 - 10s - loss: 12.4450 - accuracy10: 0.4716 - accuracy20: 0.4706 - accuracy30: 0.4686 - accuracy50: 0.4582 - val_loss: 13.0325 - val_accuracy10: 0.4192 - val_accuracy20: 0.4121 - val_accuracy30: 0.4117 - val_accuracy50: 0.4089 - 10s/epoch - 30ms/step
Epoch 14/50
323/323 - 9s - loss: 12.3983 - accuracy10: 0.4755 - accuracy20: 0.4764 - accuracy30: 0.4742 - accuracy50: 0.4624 - val_loss: 13.0618 - val_accuracy10: 0.4173 - val_accuracy20: 0.4149 - val_accuracy30: 0.4109 - val_accuracy50: 0.4101 - 9s/epoch - 29ms/step
Epoch 15/50
323/323 - 9s - loss: 12.3491 - accuracy10: 0.4793 - accuracy20: 0.4822 - accuracy30: 0.4793 - accuracy50: 0.4686 - val_loss: 13.1284 - val_accuracy10: 0.4181 - val_accuracy20: 0.4131 - val_accuracy30: 0.4102 - val_accuracy50: 0.4062 - 9s/epoch - 29ms/step
Epoch 16/50
323/323 - 10s - loss: 12.3089 - accuracy10: 0.4825 - accuracy20: 0.4846 - accuracy30: 0.4834 - accuracy50: 0.4724 - val_loss: 13.1328 - val_accuracy10: 0.4178 - val_accuracy20: 0.4136 - val_accuracy30: 0.4082 - val_accuracy50: 0.4086 - 10s/epoch - 30ms/step
testing model: results/CHTR/W9/deepOF_L2/seq2seq
Evaluating performance on  test set...
604/604 - 7s - 7s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.06735
{'0': {'precision': 0.4599883063730267, 'recall': 0.2253217245197999, 'f1-score': 0.3024772840866857, 'support': 52374}, '1': {'precision': 0.42016104527499243, 'recall': 0.6170810167537515, 'f1-score': 0.499928443918863, 'support': 53779}, '2': {'precision': 0.42833892583736866, 'recall': 0.4417780540876593, 'f1-score': 0.4349547049702114, 'support': 48255}, 'accuracy': 0.4294142790528988, 'macro avg': {'precision': 0.43616275916179587, 'recall': 0.42806026512040357, 'f1-score': 0.4124534776585867, 'support': 154408}, 'weighted avg': {'precision': 0.4362258644507211, 'recall': 0.4294142790528988, 'f1-score': 0.412649191431831, 'support': 154408}}
[[11801 25700 14873]
 [ 7015 33186 13578]
 [ 6839 20098 21318]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0637214
{'0': {'precision': 0.4369996585347346, 'recall': 0.2356672259278962, 'f1-score': 0.30620355970278207, 'support': 48874}, '1': {'precision': 0.44486110048213057, 'recall': 0.5853683097527819, 'f1-score': 0.505533210131536, 'support': 59583}, '2': {'precision': 0.4038550625390239, 'recall': 0.43635611847402667, 'f1-score': 0.41947698744769873, 'support': 45951}, 'accuracy': 0.4303339205222527, 'macro avg': {'precision': 0.42857194051862973, 'recall': 0.4191305513849016, 'f1-score': 0.41040458576067224, 'support': 154408}, 'weighted avg': {'precision': 0.4301695782600907, 'recall': 0.4303339205222527, 'f1-score': 0.41683050804615224, 'support': 154408}}
[[11518 24166 13190]
 [ 8297 34878 16408]
 [ 6542 19358 20051]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0694829
{'0': {'precision': 0.441750073594348, 'recall': 0.24457573596821838, 'f1-score': 0.3148398263857017, 'support': 49085}, '1': {'precision': 0.4354380598645401, 'recall': 0.5687785388127854, 'f1-score': 0.4932557851751021, 'support': 59568}, '2': {'precision': 0.3930963316674423, 'recall': 0.42460933231340836, 'f1-score': 0.4082456029754776, 'support': 45755}, 'accuracy': 0.4229962178125486, 'macro avg': {'precision': 0.4234281550421101, 'recall': 0.4126545356981374, 'f1-score': 0.40544707151209375, 'support': 154408}, 'weighted avg': {'precision': 0.42489766960153175, 'recall': 0.4229962178125486, 'f1-score': 0.4113481882648284, 'support': 154408}}
[[12005 24295 12785]
 [ 8477 33881 17210]
 [ 6694 19633 19428]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0758888
{'0': {'precision': 0.43201896143072616, 'recall': 0.24685531364783617, 'f1-score': 0.31418535107536005, 'support': 48733}, '1': {'precision': 0.4272166170577396, 'recall': 0.5523992002665779, 'f1-score': 0.48180952865353455, 'support': 60020}, '2': {'precision': 0.3807169849862118, 'recall': 0.4082356806483408, 'f1-score': 0.39399640629954547, 'support': 45655}, 'accuracy': 0.4133399823843324, 'macro avg': {'precision': 0.41331752115822584, 'recall': 0.40249673152091825, 'f1-score': 0.39666376200948, 'support': 154408}, 'weighted avg': {'precision': 0.414983390450978, 'recall': 0.4133399823843324, 'f1-score': 0.402940965191871, 'support': 154408}}
[[12030 24198 12505]
 [ 9053 33155 17812]
 [ 6763 20254 18638]]
Evaluating performance on  train set...
323/323 - 3s - 3s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0616409
{'0': {'precision': 0.5053922292805436, 'recall': 0.23265778019586508, 'f1-score': 0.31863270153215667, 'support': 29408}, '1': {'precision': 0.38965342777637235, 'recall': 0.5921270134163688, 'f1-score': 0.4700120531559434, 'support': 26013}, '2': {'precision': 0.4569621537524943, 'recall': 0.49647240390975234, 'f1-score': 0.47589862806220384, 'support': 27214}, 'accuracy': 0.43269800931808555, 'macro avg': {'precision': 0.4506692702698034, 'recall': 0.4404190658406621, 'f1-score': 0.42151446091676803, 'support': 82635}, 'weighted avg': {'precision': 0.45300898345312984, 'recall': 0.43269800931808555, 'f1-score': 0.41807804549510535, 'support': 82635}}
[[ 6842 13773  8793]
 [ 3347 15403  7263]
 [ 3349 10354 13511]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0596583
{'0': {'precision': 0.49460819554277496, 'recall': 0.23995535714285715, 'f1-score': 0.32314123338499834, 'support': 28672}, '1': {'precision': 0.4067550713940289, 'recall': 0.5738858763960211, 'f1-score': 0.4760784080076263, 'support': 27847}, '2': {'precision': 0.44112651175431444, 'recall': 0.49720477867973656, 'f1-score': 0.4674899193548387, 'support': 26116}, 'accuracy': 0.43378713620136744, 'macro avg': {'precision': 0.4474965928970394, 'recall': 0.4370153374062049, 'f1-score': 0.4222365202491545, 'support': 82635}, 'weighted avg': {'precision': 0.44810037679781745, 'recall': 0.43378713620136744, 'f1-score': 0.42029923888514564, 'support': 82635}}
[[ 6880 13434  8358]
 [ 3773 15981  8093]
 [ 3257  9874 12985]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0634878
{'0': {'precision': 0.49522873982598936, 'recall': 0.2426763856415899, 'f1-score': 0.3257338009968617, 'support': 29084}, '1': {'precision': 0.39395642289713656, 'recall': 0.5616328611485379, 'f1-score': 0.46308362107791623, 'support': 27461}, '2': {'precision': 0.43876992542929466, 'recall': 0.4916443081640475, 'f1-score': 0.46370472127828793, 'support': 26090}, 'accuracy': 0.4272765777213045, 'macro avg': {'precision': 0.4426516960508069, 'recall': 0.43198451831805845, 'f1-score': 0.4175073811176886, 'support': 82635}, 'weighted avg': {'precision': 0.4437487426965286, 'recall': 0.4272765777213045, 'f1-score': 0.41493843244102274, 'support': 82635}}
[[ 7058 13777  8249]
 [ 3880 15423  8158]
 [ 3314  9949 12827]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0704311
{'0': {'precision': 0.4892086330935252, 'recall': 0.24522845575477153, 'f1-score': 0.3266934076642419, 'support': 29393}, '1': {'precision': 0.37876269149126623, 'recall': 0.545347424236845, 'f1-score': 0.4470403573908056, 'support': 27157}, '2': {'precision': 0.43145833333333333, 'recall': 0.47636572742955724, 'f1-score': 0.45280131183383443, 'support': 26085}, 'accuracy': 0.41682095964179827, 'macro avg': {'precision': 0.4331432193060416, 'recall': 0.4223138691403912, 'f1-score': 0.4088450256296274, 'support': 82635}, 'weighted avg': {'precision': 0.4346821369921499, 'recall': 0.41682095964179827, 'f1-score': 0.40605187313272517, 'support': 82635}}
[[ 7208 14087  8098]
 [ 4071 14810  8276]
 [ 3455 10204 12426]]
Evaluating performance on  val set...
112/112 - 1s - 1s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0861852
{'0': {'precision': 0.5105314009661835, 'recall': 0.24334530717509442, 'f1-score': 0.3295908183632735, 'support': 10857}, '1': {'precision': 0.3081924577373212, 'recall': 0.47368421052631576, 'f1-score': 0.37342436974789917, 'support': 7505}, '2': {'precision': 0.45492537313432835, 'recall': 0.5295343988881167, 'f1-score': 0.48940269749518306, 'support': 10073}, 'accuracy': 0.4055213645155618, 'macro avg': {'precision': 0.4245497439459444, 'recall': 0.41552130552984234, 'f1-score': 0.3974726285354519, 'support': 28435}, 'weighted avg': {'precision': 0.43742877085248955, 'recall': 0.4055213645155618, 'f1-score': 0.3977728426867249, 'support': 28435}}
[[2642 4554 3661]
 [1220 3555 2730]
 [1313 3426 5334]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0866083
{'0': {'precision': 0.5017975402081363, 'recall': 0.2508038585209003, 'f1-score': 0.33444731698089414, 'support': 10574}, '1': {'precision': 0.3187418086500655, 'recall': 0.45204460966542753, 'f1-score': 0.3738662567255957, 'support': 8070}, '2': {'precision': 0.4389577103801794, 'recall': 0.5247676437544684, 'f1-score': 0.4780424264979531, 'support': 9791}, 'accuracy': 0.40225074731844557, 'macro avg': {'precision': 0.4198323530794604, 'recall': 0.4092053706469321, 'f1-score': 0.3954520000681476, 'support': 28435}, 'weighted avg': {'precision': 0.42820779069102155, 'recall': 0.40225074731844557, 'f1-score': 0.3950786009978193, 'support': 28435}}
[[2652 4438 3484]
 [1339 3648 3083]
 [1294 3359 5138]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0864546
{'0': {'precision': 0.49844862201131596, 'recall': 0.25873993368072, 'f1-score': 0.3406511163776974, 'support': 10555}, '1': {'precision': 0.31350539155029167, 'recall': 0.4444305224909159, 'f1-score': 0.3676600155480694, 'support': 7981}, '2': {'precision': 0.4392716028173853, 'recall': 0.5166178401858773, 'f1-score': 0.4748154681769648, 'support': 9899}, 'accuracy': 0.4006330226833128, 'macro avg': {'precision': 0.4170752054596643, 'recall': 0.4065960987858377, 'f1-score': 0.3943755333675772, 'support': 28435}, 'weighted avg': {'precision': 0.4259385029569761, 'recall': 0.4006330226833128, 'f1-score': 0.39493811981499954, 'support': 28435}}
[[2731 4374 3450]
 [1356 3547 3078]
 [1392 3393 5114]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0868461
{'0': {'precision': 0.4927175843694494, 'recall': 0.26596356663470755, 'f1-score': 0.3454545454545455, 'support': 10430}, '1': {'precision': 0.31342885111684615, 'recall': 0.43621501114689126, 'f1-score': 0.36476619543265504, 'support': 8074}, '2': {'precision': 0.4375, 'recall': 0.5096163528345584, 'f1-score': 0.47081259593469466, 'support': 9931}, 'accuracy': 0.3994021452435379, 'macro avg': {'precision': 0.4145488118287652, 'recall': 0.4039316435387191, 'f1-score': 0.3936777789406318, 'support': 28435}, 'weighted avg': {'precision': 0.4225244047438288, 'recall': 0.3994021452435379, 'f1-score': 0.3947196434408869, 'support': 28435}}
[[2774 4314 3342]
 [1387 3522 3165]
 [1469 3401 5061]]
training model: results/CHTR/W9/deepVOL_L2/seq2seq
Epoch 1/50
323/323 - 16s - loss: 13.2445 - accuracy10: 0.3603 - accuracy20: 0.3582 - accuracy30: 0.3577 - accuracy50: 0.3535 - val_loss: 13.4892 - val_accuracy10: 0.2937 - val_accuracy20: 0.2995 - val_accuracy30: 0.2948 - val_accuracy50: 0.2961 - 16s/epoch - 48ms/step
Epoch 2/50
323/323 - 10s - loss: 13.1487 - accuracy10: 0.3692 - accuracy20: 0.3691 - accuracy30: 0.3652 - accuracy50: 0.3582 - val_loss: 13.4923 - val_accuracy10: 0.2713 - val_accuracy20: 0.2901 - val_accuracy30: 0.2855 - val_accuracy50: 0.2886 - 10s/epoch - 30ms/step
Epoch 3/50
323/323 - 9s - loss: 13.1481 - accuracy10: 0.3677 - accuracy20: 0.3667 - accuracy30: 0.3648 - accuracy50: 0.3594 - val_loss: 13.4333 - val_accuracy10: 0.2855 - val_accuracy20: 0.2966 - val_accuracy30: 0.2900 - val_accuracy50: 0.2935 - 9s/epoch - 29ms/step
Epoch 4/50
323/323 - 10s - loss: 13.1219 - accuracy10: 0.3731 - accuracy20: 0.3748 - accuracy30: 0.3694 - accuracy50: 0.3633 - val_loss: 13.3315 - val_accuracy10: 0.3083 - val_accuracy20: 0.3103 - val_accuracy30: 0.3004 - val_accuracy50: 0.2997 - 10s/epoch - 30ms/step
Epoch 5/50
323/323 - 10s - loss: 13.1146 - accuracy10: 0.3745 - accuracy20: 0.3749 - accuracy30: 0.3693 - accuracy50: 0.3619 - val_loss: 13.3319 - val_accuracy10: 0.3139 - val_accuracy20: 0.3191 - val_accuracy30: 0.3088 - val_accuracy50: 0.3048 - 10s/epoch - 30ms/step
Epoch 6/50
323/323 - 10s - loss: 13.1003 - accuracy10: 0.3723 - accuracy20: 0.3765 - accuracy30: 0.3719 - accuracy50: 0.3605 - val_loss: 13.2069 - val_accuracy10: 0.3542 - val_accuracy20: 0.3474 - val_accuracy30: 0.3356 - val_accuracy50: 0.3289 - 10s/epoch - 29ms/step
Epoch 7/50
323/323 - 10s - loss: 13.0714 - accuracy10: 0.3829 - accuracy20: 0.3796 - accuracy30: 0.3747 - accuracy50: 0.3639 - val_loss: 13.2834 - val_accuracy10: 0.3280 - val_accuracy20: 0.3287 - val_accuracy30: 0.3175 - val_accuracy50: 0.3141 - 10s/epoch - 30ms/step
Epoch 8/50
323/323 - 10s - loss: 13.0664 - accuracy10: 0.3879 - accuracy20: 0.3854 - accuracy30: 0.3773 - accuracy50: 0.3660 - val_loss: 13.2372 - val_accuracy10: 0.3451 - val_accuracy20: 0.3428 - val_accuracy30: 0.3343 - val_accuracy50: 0.3270 - 10s/epoch - 30ms/step
Epoch 9/50
323/323 - 9s - loss: 13.0475 - accuracy10: 0.3887 - accuracy20: 0.3883 - accuracy30: 0.3814 - accuracy50: 0.3694 - val_loss: 13.1996 - val_accuracy10: 0.3560 - val_accuracy20: 0.3508 - val_accuracy30: 0.3437 - val_accuracy50: 0.3364 - 9s/epoch - 29ms/step
Epoch 10/50
323/323 - 10s - loss: 13.0168 - accuracy10: 0.3925 - accuracy20: 0.3939 - accuracy30: 0.3858 - accuracy50: 0.3735 - val_loss: 13.1937 - val_accuracy10: 0.3605 - val_accuracy20: 0.3582 - val_accuracy30: 0.3530 - val_accuracy50: 0.3426 - 10s/epoch - 30ms/step
Epoch 11/50
323/323 - 10s - loss: 13.0073 - accuracy10: 0.3939 - accuracy20: 0.3938 - accuracy30: 0.3872 - accuracy50: 0.3746 - val_loss: 13.2019 - val_accuracy10: 0.3558 - val_accuracy20: 0.3567 - val_accuracy30: 0.3495 - val_accuracy50: 0.3427 - 10s/epoch - 30ms/step
Epoch 12/50
323/323 - 10s - loss: 12.9829 - accuracy10: 0.3973 - accuracy20: 0.3992 - accuracy30: 0.3923 - accuracy50: 0.3796 - val_loss: 13.1974 - val_accuracy10: 0.3648 - val_accuracy20: 0.3617 - val_accuracy30: 0.3524 - val_accuracy50: 0.3414 - 10s/epoch - 30ms/step
Epoch 13/50
323/323 - 10s - loss: 12.9805 - accuracy10: 0.4000 - accuracy20: 0.3987 - accuracy30: 0.3916 - accuracy50: 0.3782 - val_loss: 13.1527 - val_accuracy10: 0.3719 - val_accuracy20: 0.3655 - val_accuracy30: 0.3572 - val_accuracy50: 0.3466 - 10s/epoch - 30ms/step
Epoch 14/50
323/323 - 10s - loss: 12.9504 - accuracy10: 0.4025 - accuracy20: 0.4035 - accuracy30: 0.3975 - accuracy50: 0.3839 - val_loss: 13.1624 - val_accuracy10: 0.3752 - val_accuracy20: 0.3710 - val_accuracy30: 0.3626 - val_accuracy50: 0.3525 - 10s/epoch - 30ms/step
Epoch 15/50
323/323 - 10s - loss: 12.9312 - accuracy10: 0.4027 - accuracy20: 0.4059 - accuracy30: 0.3994 - accuracy50: 0.3840 - val_loss: 13.1618 - val_accuracy10: 0.3764 - val_accuracy20: 0.3716 - val_accuracy30: 0.3634 - val_accuracy50: 0.3518 - 10s/epoch - 30ms/step
Epoch 16/50
323/323 - 10s - loss: 12.9172 - accuracy10: 0.4075 - accuracy20: 0.4091 - accuracy30: 0.4025 - accuracy50: 0.3886 - val_loss: 13.1453 - val_accuracy10: 0.3781 - val_accuracy20: 0.3724 - val_accuracy30: 0.3631 - val_accuracy50: 0.3578 - 10s/epoch - 30ms/step
Epoch 17/50
323/323 - 10s - loss: 12.9031 - accuracy10: 0.4068 - accuracy20: 0.4101 - accuracy30: 0.4044 - accuracy50: 0.3911 - val_loss: 13.1606 - val_accuracy10: 0.3736 - val_accuracy20: 0.3723 - val_accuracy30: 0.3635 - val_accuracy50: 0.3578 - 10s/epoch - 31ms/step
Epoch 18/50
323/323 - 10s - loss: 12.8823 - accuracy10: 0.4110 - accuracy20: 0.4141 - accuracy30: 0.4073 - accuracy50: 0.3939 - val_loss: 13.1826 - val_accuracy10: 0.3701 - val_accuracy20: 0.3742 - val_accuracy30: 0.3645 - val_accuracy50: 0.3565 - 10s/epoch - 31ms/step
Epoch 19/50
323/323 - 9s - loss: 12.8776 - accuracy10: 0.4113 - accuracy20: 0.4151 - accuracy30: 0.4095 - accuracy50: 0.3939 - val_loss: 13.1574 - val_accuracy10: 0.3755 - val_accuracy20: 0.3745 - val_accuracy30: 0.3666 - val_accuracy50: 0.3554 - 9s/epoch - 29ms/step
Epoch 20/50
323/323 - 10s - loss: 12.8586 - accuracy10: 0.4121 - accuracy20: 0.4168 - accuracy30: 0.4103 - accuracy50: 0.3975 - val_loss: 13.1776 - val_accuracy10: 0.3715 - val_accuracy20: 0.3714 - val_accuracy30: 0.3652 - val_accuracy50: 0.3555 - 10s/epoch - 30ms/step
Epoch 21/50
323/323 - 9s - loss: 12.8339 - accuracy10: 0.4172 - accuracy20: 0.4198 - accuracy30: 0.4145 - accuracy50: 0.4007 - val_loss: 13.1608 - val_accuracy10: 0.3766 - val_accuracy20: 0.3730 - val_accuracy30: 0.3684 - val_accuracy50: 0.3579 - 9s/epoch - 29ms/step
Epoch 22/50
323/323 - 10s - loss: 12.8185 - accuracy10: 0.4179 - accuracy20: 0.4218 - accuracy30: 0.4172 - accuracy50: 0.4027 - val_loss: 13.1820 - val_accuracy10: 0.3771 - val_accuracy20: 0.3773 - val_accuracy30: 0.3682 - val_accuracy50: 0.3588 - 10s/epoch - 30ms/step
Epoch 23/50
323/323 - 9s - loss: 12.7973 - accuracy10: 0.4204 - accuracy20: 0.4242 - accuracy30: 0.4195 - accuracy50: 0.4048 - val_loss: 13.1735 - val_accuracy10: 0.3768 - val_accuracy20: 0.3780 - val_accuracy30: 0.3685 - val_accuracy50: 0.3608 - 9s/epoch - 29ms/step
Epoch 24/50
323/323 - 10s - loss: 12.7842 - accuracy10: 0.4218 - accuracy20: 0.4242 - accuracy30: 0.4187 - accuracy50: 0.4065 - val_loss: 13.1960 - val_accuracy10: 0.3789 - val_accuracy20: 0.3768 - val_accuracy30: 0.3659 - val_accuracy50: 0.3569 - 10s/epoch - 30ms/step
Epoch 25/50
323/323 - 10s - loss: 12.7585 - accuracy10: 0.4233 - accuracy20: 0.4288 - accuracy30: 0.4209 - accuracy50: 0.4080 - val_loss: 13.2008 - val_accuracy10: 0.3754 - val_accuracy20: 0.3731 - val_accuracy30: 0.3659 - val_accuracy50: 0.3565 - 10s/epoch - 30ms/step
Epoch 26/50
323/323 - 10s - loss: 12.7415 - accuracy10: 0.4249 - accuracy20: 0.4299 - accuracy30: 0.4265 - accuracy50: 0.4133 - val_loss: 13.2305 - val_accuracy10: 0.3732 - val_accuracy20: 0.3720 - val_accuracy30: 0.3631 - val_accuracy50: 0.3522 - 10s/epoch - 30ms/step
testing model: results/CHTR/W9/deepVOL_L2/seq2seq
Evaluating performance on  test set...
604/604 - 6s - 6s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0798798
{'0': {'precision': 0.39621030598474205, 'recall': 0.2746677867725676, 'f1-score': 0.3244291593843378, 'support': 52376}, '1': {'precision': 0.4165215337839832, 'recall': 0.5247489773149869, 'f1-score': 0.4644132506129972, 'support': 53780}, '2': {'precision': 0.3689646269042086, 'recall': 0.3849676724137931, 'f1-score': 0.37679630850362555, 'support': 48256}, 'accuracy': 0.39623863430303347, 'macro avg': {'precision': 0.39389882222431133, 'recall': 0.39479481216711587, 'f1-score': 0.38854623950032013, 'support': 154412}, 'weighted avg': {'precision': 0.39476981134269984, 'recall': 0.39623863430303347, 'f1-score': 0.38954957472885543, 'support': 154412}}
[[14386 21278 16712]
 [10499 28221 15060]
 [11424 18255 18577]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.075141
{'0': {'precision': 0.38386971694455213, 'recall': 0.2633194205745151, 'f1-score': 0.3123672681819836, 'support': 48876}, '1': {'precision': 0.4419553473612633, 'recall': 0.5890339688506981, 'f1-score': 0.5050037051159378, 'support': 59584}, '2': {'precision': 0.35968846450617287, 'recall': 0.32462134401114207, 'f1-score': 0.34125640556368964, 'support': 45952}, 'accuracy': 0.4072481413361656, 'macro avg': {'precision': 0.3951711762706627, 'recall': 0.3923249111454517, 'f1-score': 0.38620912628720366, 'support': 154412}, 'weighted avg': {'precision': 0.39908742859067364, 'recall': 0.4072481413361656, 'f1-score': 0.3952984075962576, 'support': 154412}}
[[12870 23269 12737]
 [10669 35097 13818]
 [ 9988 21047 14917]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0786531
{'0': {'precision': 0.3836113752268995, 'recall': 0.27123270927129384, 'f1-score': 0.3177793159414755, 'support': 49087}, '1': {'precision': 0.42859259808098393, 'recall': 0.5826450443190975, 'f1-score': 0.49388460799590167, 'support': 59568}, '2': {'precision': 0.35490368228063834, 'recall': 0.300369342395699, 'f1-score': 0.32536723364463854, 'support': 45757}, 'accuracy': 0.40000129523612155, 'macro avg': {'precision': 0.38903588519617394, 'recall': 0.3847490319953635, 'f1-score': 0.37901038586067193, 'support': 154412}, 'weighted avg': {'precision': 0.3924569544359638, 'recall': 0.40000129523612155, 'f1-score': 0.3879645372159988, 'support': 154412}}
[[13314 24145 11628]
 [11507 34707 13354]
 [ 9886 22127 13744]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0858768
{'0': {'precision': 0.3720167064439141, 'recall': 0.28145518713066314, 'f1-score': 0.32046070460704607, 'support': 48736}, '1': {'precision': 0.41613818630475014, 'recall': 0.561946017994002, 'f1-score': 0.47817395619196146, 'support': 60020}, '2': {'precision': 0.3436009865716635, 'recall': 0.27461888908358156, 'f1-score': 0.30526136391303293, 'support': 45656}, 'accuracy': 0.38846074139315595, 'macro avg': {'precision': 0.37725195977344256, 'recall': 0.3726733647360822, 'f1-score': 0.3679653415706802, 'support': 154412}, 'weighted avg': {'precision': 0.38076488090418864, 'recall': 0.38846074139315595, 'f1-score': 0.3772698144003313, 'support': 154412}}
[[13717 24599 10420]
 [12760 33728 13532]
 [10395 22723 12538]]
Evaluating performance on  train set...
323/323 - 4s - 4s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0761126
{'0': {'precision': 0.4276369168356998, 'recall': 0.28673920435226113, 'f1-score': 0.3432933034805618, 'support': 29410}, '1': {'precision': 0.39112122936824134, 'recall': 0.5301241996451439, 'f1-score': 0.4501359185143943, 'support': 25926}, '2': {'precision': 0.39143114311431143, 'recall': 0.3982563463863145, 'f1-score': 0.3948142499182917, 'support': 27299}, 'accuracy': 0.3999394929509288, 'macro avg': {'precision': 0.40339642977275086, 'recall': 0.40503991679457313, 'f1-score': 0.396081157304416, 'support': 82635}, 'weighted avg': {'precision': 0.4042196344480734, 'recall': 0.3999394929509288, 'f1-score': 0.3938345021756756, 'support': 82635}}
[[ 8433 11391  9586]
 [ 4865 13744  7317]
 [ 6422 10005 10872]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0741826
{'0': {'precision': 0.42647552917459963, 'recall': 0.266163416509401, 'f1-score': 0.3277672577035634, 'support': 28614}, '1': {'precision': 0.40510538641686183, 'recall': 0.6206451149940798, 'f1-score': 0.4902296977512009, 'support': 27871}, '2': {'precision': 0.3977442587308058, 'recall': 0.33579349904397704, 'f1-score': 0.36415286043087897, 'support': 26150}, 'accuracy': 0.40775700369093, 'macro avg': {'precision': 0.40977505810742243, 'recall': 0.407534010182486, 'f1-score': 0.3940499386285478, 'support': 82635}, 'weighted avg': {'precision': 0.4101757776055778, 'recall': 0.40775700369093, 'f1-score': 0.39407662029673834, 'support': 82635}}
[[ 7616 13536  7462]
 [ 4739 17298  5834]
 [ 5503 11866  8781]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.07863
{'0': {'precision': 0.42285683143495556, 'recall': 0.26842178094513247, 'f1-score': 0.3283885303142524, 'support': 28906}, '1': {'precision': 0.39219250607830214, 'recall': 0.6243669512371581, 'f1-score': 0.4817662903158277, 'support': 27644}, '2': {'precision': 0.39867830546925087, 'recall': 0.3099099099099099, 'f1-score': 0.3487338768819292, 'support': 26085}, 'accuracy': 0.4005929690808979, 'macro avg': {'precision': 0.4045758809941695, 'recall': 0.40089954736406685, 'f1-score': 0.38629623250400313, 'support': 82635}, 'weighted avg': {'precision': 0.40496633152602196, 'recall': 0.4005929690808979, 'f1-score': 0.3861205223600126, 'support': 82635}}
[[ 7759 14283  6864]
 [ 5055 17260  5329]
 [ 5535 12466  8084]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0861834
{'0': {'precision': 0.4157256811353983, 'recall': 0.2733465022818609, 'f1-score': 0.32982658009369603, 'support': 29362}, '1': {'precision': 0.3730470945262448, 'recall': 0.6095500459136822, 'f1-score': 0.4628364244875192, 'support': 27225}, '2': {'precision': 0.38112927191679047, 'recall': 0.27572174447174447, 'f1-score': 0.3199679230152366, 'support': 26048}, 'accuracy': 0.38486113632238156, 'macro avg': {'precision': 0.38996734919281123, 'recall': 0.38620609755576246, 'f1-score': 0.37087697586548396, 'support': 82635}, 'weighted avg': {'precision': 0.39075936192730854, 'recall': 0.38486113632238156, 'f1-score': 0.3705404993051939, 'support': 82635}}
[[ 8026 14878  6458]
 [ 5426 16595  5204]
 [ 5854 13012  7182]]
Evaluating performance on  val set...
112/112 - 1s - 1s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0918427
{'0': {'precision': 0.44806746310611384, 'recall': 0.2925575846563274, 'f1-score': 0.35398623140128804, 'support': 10897}, '1': {'precision': 0.31335377752996935, 'recall': 0.4540802585510369, 'f1-score': 0.37081431791939296, 'support': 7426}, '2': {'precision': 0.3977272727272727, 'recall': 0.41530703055473156, 'f1-score': 0.4063270933101147, 'support': 10113}, 'accuracy': 0.3783935855957237, 'macro avg': {'precision': 0.3863828377877853, 'recall': 0.38731495792069864, 'f1-score': 0.37704254754359856, 'support': 28436}, 'weighted avg': {'precision': 0.3949842525846035, 'recall': 0.3783935855957237, 'f1-score': 0.37699539256908277, 'support': 28436}}
[[3188 3840 3869]
 [1563 3372 2491]
 [2364 3549 4200]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0934399
{'0': {'precision': 0.4356807511737089, 'recall': 0.2630882630882631, 'f1-score': 0.3280697619608768, 'support': 10582}, '1': {'precision': 0.32670559538768573, 'recall': 0.5477075588599752, 'f1-score': 0.40927820732441317, 'support': 8070}, '2': {'precision': 0.3982622989315487, 'recall': 0.3466884709730172, 'f1-score': 0.3706901262226108, 'support': 9784}, 'accuracy': 0.3726262484174989, 'macro avg': {'precision': 0.38688288183098113, 'recall': 0.3858280976404185, 'f1-score': 0.3693460318359669, 'support': 28436}, 'weighted avg': {'precision': 0.3918795258280027, 'recall': 0.3726262484174989, 'f1-score': 0.36578075499859464, 'support': 28436}}
[[2784 4779 3019]
 [1544 4420 2106]
 [2062 4330 3392]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0972327
{'0': {'precision': 0.43659170873489367, 'recall': 0.27011167897028204, 'f1-score': 0.33374261825410745, 'support': 10566}, '1': {'precision': 0.3159727156458718, 'recall': 0.5591600653841318, 'f1-score': 0.4037771825486902, 'support': 7953}, '2': {'precision': 0.39859424920127795, 'recall': 0.31451043662397904, 'f1-score': 0.35159508510878146, 'support': 9917}, 'accuracy': 0.3664369109579406, 'macro avg': {'precision': 0.3837195578606811, 'recall': 0.3812607269927976, 'f1-score': 0.3630382953038597, 'support': 28436}, 'weighted avg': {'precision': 0.38960536542951113, 'recall': 0.3664369109579406, 'f1-score': 0.35955594655740675, 'support': 28436}}
[[2854 4945 2767]
 [1567 4447 1939]
 [2116 4682 3119]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1019996
{'0': {'precision': 0.41919191919191917, 'recall': 0.2768776210446054, 'f1-score': 0.33348639651015954, 'support': 10492}, '1': {'precision': 0.30911002102312546, 'recall': 0.54808648111332, 'f1-score': 0.39528631597813424, 'support': 8048}, '2': {'precision': 0.3862631288004422, 'recall': 0.2824373484236055, 'f1-score': 0.32628998365631573, 'support': 9896}, 'accuracy': 0.3555704037136025, 'macro avg': {'precision': 0.37152168967182897, 'recall': 0.36913381686051033, 'f1-score': 0.3516875653815365, 'support': 28436}, 'weighted avg': {'precision': 0.37657683879465836, 'recall': 0.3555704037136025, 'f1-score': 0.3484726832690786, 'support': 28436}}
[[2905 5006 2581]
 [1777 4411 1860]
 [2248 4853 2795]]
training model: results/CHTR/W9/deepVOL_L3/seq2seq
Epoch 1/50
323/323 - 21s - loss: 13.2770 - accuracy10: 0.3541 - accuracy20: 0.3565 - accuracy30: 0.3557 - accuracy50: 0.3545 - val_loss: 13.4759 - val_accuracy10: 0.2918 - val_accuracy20: 0.2946 - val_accuracy30: 0.2892 - val_accuracy50: 0.2919 - 21s/epoch - 65ms/step
Epoch 2/50
323/323 - 14s - loss: 13.1881 - accuracy10: 0.3564 - accuracy20: 0.3578 - accuracy30: 0.3558 - accuracy50: 0.3573 - val_loss: 13.6645 - val_accuracy10: 0.2611 - val_accuracy20: 0.2841 - val_accuracy30: 0.2799 - val_accuracy50: 0.2831 - 14s/epoch - 43ms/step
Epoch 3/50
323/323 - 14s - loss: 13.1877 - accuracy10: 0.3562 - accuracy20: 0.3555 - accuracy30: 0.3538 - accuracy50: 0.3560 - val_loss: 13.4183 - val_accuracy10: 0.2682 - val_accuracy20: 0.2895 - val_accuracy30: 0.2828 - val_accuracy50: 0.2855 - 14s/epoch - 44ms/step
Epoch 4/50
323/323 - 14s - loss: 13.1668 - accuracy10: 0.3621 - accuracy20: 0.3646 - accuracy30: 0.3595 - accuracy50: 0.3568 - val_loss: 13.4990 - val_accuracy10: 0.2621 - val_accuracy20: 0.2843 - val_accuracy30: 0.2807 - val_accuracy50: 0.2840 - 14s/epoch - 43ms/step
Epoch 5/50
323/323 - 14s - loss: 13.1666 - accuracy10: 0.3591 - accuracy20: 0.3608 - accuracy30: 0.3571 - accuracy50: 0.3505 - val_loss: 13.3350 - val_accuracy10: 0.2725 - val_accuracy20: 0.2890 - val_accuracy30: 0.2833 - val_accuracy50: 0.2844 - 14s/epoch - 42ms/step
Epoch 6/50
323/323 - 14s - loss: 13.1589 - accuracy10: 0.3575 - accuracy20: 0.3606 - accuracy30: 0.3548 - accuracy50: 0.3456 - val_loss: 13.3217 - val_accuracy10: 0.2871 - val_accuracy20: 0.2965 - val_accuracy30: 0.2891 - val_accuracy50: 0.2913 - 14s/epoch - 43ms/step
Epoch 7/50
323/323 - 14s - loss: 13.1345 - accuracy10: 0.3665 - accuracy20: 0.3648 - accuracy30: 0.3593 - accuracy50: 0.3494 - val_loss: 13.2510 - val_accuracy10: 0.3205 - val_accuracy20: 0.3292 - val_accuracy30: 0.3167 - val_accuracy50: 0.3126 - 14s/epoch - 42ms/step
Epoch 8/50
323/323 - 14s - loss: 13.1107 - accuracy10: 0.3695 - accuracy20: 0.3687 - accuracy30: 0.3612 - accuracy50: 0.3503 - val_loss: 13.2197 - val_accuracy10: 0.3419 - val_accuracy20: 0.3435 - val_accuracy30: 0.3338 - val_accuracy50: 0.3288 - 14s/epoch - 43ms/step
Epoch 9/50
323/323 - 14s - loss: 13.0809 - accuracy10: 0.3773 - accuracy20: 0.3755 - accuracy30: 0.3683 - accuracy50: 0.3575 - val_loss: 13.2305 - val_accuracy10: 0.3457 - val_accuracy20: 0.3438 - val_accuracy30: 0.3348 - val_accuracy50: 0.3262 - 14s/epoch - 42ms/step
Epoch 10/50
323/323 - 14s - loss: 13.0548 - accuracy10: 0.3797 - accuracy20: 0.3790 - accuracy30: 0.3739 - accuracy50: 0.3607 - val_loss: 13.2002 - val_accuracy10: 0.3606 - val_accuracy20: 0.3558 - val_accuracy30: 0.3444 - val_accuracy50: 0.3372 - 14s/epoch - 44ms/step
Epoch 11/50
323/323 - 14s - loss: 13.0516 - accuracy10: 0.3844 - accuracy20: 0.3828 - accuracy30: 0.3747 - accuracy50: 0.3631 - val_loss: 13.1871 - val_accuracy10: 0.3508 - val_accuracy20: 0.3541 - val_accuracy30: 0.3460 - val_accuracy50: 0.3363 - 14s/epoch - 43ms/step
Epoch 12/50
323/323 - 14s - loss: 13.0223 - accuracy10: 0.3868 - accuracy20: 0.3863 - accuracy30: 0.3814 - accuracy50: 0.3686 - val_loss: 13.1890 - val_accuracy10: 0.3613 - val_accuracy20: 0.3630 - val_accuracy30: 0.3537 - val_accuracy50: 0.3430 - 14s/epoch - 42ms/step
Epoch 13/50
323/323 - 14s - loss: 13.0140 - accuracy10: 0.3898 - accuracy20: 0.3890 - accuracy30: 0.3814 - accuracy50: 0.3710 - val_loss: 13.1994 - val_accuracy10: 0.3588 - val_accuracy20: 0.3606 - val_accuracy30: 0.3490 - val_accuracy50: 0.3391 - 14s/epoch - 42ms/step
Epoch 14/50
323/323 - 14s - loss: 12.9966 - accuracy10: 0.3941 - accuracy20: 0.3932 - accuracy30: 0.3856 - accuracy50: 0.3722 - val_loss: 13.1849 - val_accuracy10: 0.3608 - val_accuracy20: 0.3617 - val_accuracy30: 0.3508 - val_accuracy50: 0.3408 - 14s/epoch - 44ms/step
Epoch 15/50
323/323 - 14s - loss: 12.9836 - accuracy10: 0.3928 - accuracy20: 0.3947 - accuracy30: 0.3875 - accuracy50: 0.3733 - val_loss: 13.1901 - val_accuracy10: 0.3630 - val_accuracy20: 0.3661 - val_accuracy30: 0.3593 - val_accuracy50: 0.3444 - 14s/epoch - 43ms/step
Epoch 16/50
323/323 - 14s - loss: 12.9625 - accuracy10: 0.3970 - accuracy20: 0.3964 - accuracy30: 0.3888 - accuracy50: 0.3737 - val_loss: 13.1826 - val_accuracy10: 0.3627 - val_accuracy20: 0.3645 - val_accuracy30: 0.3570 - val_accuracy50: 0.3459 - 14s/epoch - 44ms/step
Epoch 17/50
323/323 - 14s - loss: 12.9634 - accuracy10: 0.3979 - accuracy20: 0.3974 - accuracy30: 0.3879 - accuracy50: 0.3743 - val_loss: 13.1909 - val_accuracy10: 0.3604 - val_accuracy20: 0.3669 - val_accuracy30: 0.3556 - val_accuracy50: 0.3468 - 14s/epoch - 43ms/step
Epoch 18/50
323/323 - 14s - loss: 12.9447 - accuracy10: 0.3972 - accuracy20: 0.3975 - accuracy30: 0.3890 - accuracy50: 0.3755 - val_loss: 13.1585 - val_accuracy10: 0.3685 - val_accuracy20: 0.3710 - val_accuracy30: 0.3635 - val_accuracy50: 0.3515 - 14s/epoch - 43ms/step
Epoch 19/50
323/323 - 14s - loss: 12.9250 - accuracy10: 0.4008 - accuracy20: 0.4008 - accuracy30: 0.3932 - accuracy50: 0.3791 - val_loss: 13.2163 - val_accuracy10: 0.3598 - val_accuracy20: 0.3644 - val_accuracy30: 0.3580 - val_accuracy50: 0.3454 - 14s/epoch - 43ms/step
Epoch 20/50
323/323 - 14s - loss: 12.9200 - accuracy10: 0.4018 - accuracy20: 0.4029 - accuracy30: 0.3940 - accuracy50: 0.3788 - val_loss: 13.2037 - val_accuracy10: 0.3652 - val_accuracy20: 0.3681 - val_accuracy30: 0.3587 - val_accuracy50: 0.3458 - 14s/epoch - 43ms/step
Epoch 21/50
323/323 - 14s - loss: 12.9026 - accuracy10: 0.4048 - accuracy20: 0.4063 - accuracy30: 0.3986 - accuracy50: 0.3835 - val_loss: 13.1326 - val_accuracy10: 0.3719 - val_accuracy20: 0.3722 - val_accuracy30: 0.3663 - val_accuracy50: 0.3561 - 14s/epoch - 43ms/step
Epoch 22/50
323/323 - 14s - loss: 12.8955 - accuracy10: 0.4052 - accuracy20: 0.4057 - accuracy30: 0.3989 - accuracy50: 0.3832 - val_loss: 13.1690 - val_accuracy10: 0.3659 - val_accuracy20: 0.3721 - val_accuracy30: 0.3623 - val_accuracy50: 0.3500 - 14s/epoch - 43ms/step
Epoch 23/50
323/323 - 14s - loss: 12.8717 - accuracy10: 0.4081 - accuracy20: 0.4103 - accuracy30: 0.4022 - accuracy50: 0.3864 - val_loss: 13.2007 - val_accuracy10: 0.3641 - val_accuracy20: 0.3676 - val_accuracy30: 0.3599 - val_accuracy50: 0.3487 - 14s/epoch - 42ms/step
Epoch 24/50
323/323 - 14s - loss: 12.8619 - accuracy10: 0.4082 - accuracy20: 0.4097 - accuracy30: 0.4029 - accuracy50: 0.3875 - val_loss: 13.1865 - val_accuracy10: 0.3636 - val_accuracy20: 0.3665 - val_accuracy30: 0.3601 - val_accuracy50: 0.3491 - 14s/epoch - 42ms/step
Epoch 25/50
323/323 - 14s - loss: 12.8534 - accuracy10: 0.4101 - accuracy20: 0.4117 - accuracy30: 0.4042 - accuracy50: 0.3898 - val_loss: 13.2044 - val_accuracy10: 0.3673 - val_accuracy20: 0.3711 - val_accuracy30: 0.3619 - val_accuracy50: 0.3513 - 14s/epoch - 44ms/step
Epoch 26/50
323/323 - 14s - loss: 12.8467 - accuracy10: 0.4130 - accuracy20: 0.4126 - accuracy30: 0.4054 - accuracy50: 0.3909 - val_loss: 13.1934 - val_accuracy10: 0.3632 - val_accuracy20: 0.3702 - val_accuracy30: 0.3634 - val_accuracy50: 0.3510 - 14s/epoch - 43ms/step
Epoch 27/50
323/323 - 14s - loss: 12.8274 - accuracy10: 0.4145 - accuracy20: 0.4146 - accuracy30: 0.4089 - accuracy50: 0.3934 - val_loss: 13.1919 - val_accuracy10: 0.3675 - val_accuracy20: 0.3691 - val_accuracy30: 0.3620 - val_accuracy50: 0.3532 - 14s/epoch - 44ms/step
Epoch 28/50
323/323 - 14s - loss: 12.8216 - accuracy10: 0.4140 - accuracy20: 0.4166 - accuracy30: 0.4097 - accuracy50: 0.3967 - val_loss: 13.1979 - val_accuracy10: 0.3671 - val_accuracy20: 0.3708 - val_accuracy30: 0.3639 - val_accuracy50: 0.3531 - 14s/epoch - 43ms/step
Epoch 29/50
323/323 - 14s - loss: 12.8201 - accuracy10: 0.4130 - accuracy20: 0.4155 - accuracy30: 0.4092 - accuracy50: 0.3959 - val_loss: 13.1939 - val_accuracy10: 0.3654 - val_accuracy20: 0.3708 - val_accuracy30: 0.3647 - val_accuracy50: 0.3545 - 14s/epoch - 43ms/step
Epoch 30/50
323/323 - 14s - loss: 12.8025 - accuracy10: 0.4178 - accuracy20: 0.4184 - accuracy30: 0.4121 - accuracy50: 0.3986 - val_loss: 13.2085 - val_accuracy10: 0.3705 - val_accuracy20: 0.3756 - val_accuracy30: 0.3680 - val_accuracy50: 0.3562 - 14s/epoch - 43ms/step
Epoch 31/50
323/323 - 14s - loss: 12.7959 - accuracy10: 0.4157 - accuracy20: 0.4187 - accuracy30: 0.4138 - accuracy50: 0.4000 - val_loss: 13.1938 - val_accuracy10: 0.3646 - val_accuracy20: 0.3677 - val_accuracy30: 0.3604 - val_accuracy50: 0.3494 - 14s/epoch - 43ms/step
testing model: results/CHTR/W9/deepVOL_L3/seq2seq
Evaluating performance on  test set...
604/604 - 12s - 12s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0818741
{'0': {'precision': 0.39770486350352824, 'recall': 0.3195929433328242, 'f1-score': 0.35439580797120623, 'support': 52376}, '1': {'precision': 0.41697466268869393, 'recall': 0.5223503161026404, 'f1-score': 0.46375184686878357, 'support': 53780}, '2': {'precision': 0.38414308595835556, 'recall': 0.3578415119363395, 'f1-score': 0.3705261350956999, 'support': 48256}, 'accuracy': 0.40216433955910164, 'macro avg': {'precision': 0.3996075373835259, 'recall': 0.39992825712393465, 'f1-score': 0.39622459664522985, 'support': 154412}, 'weighted avg': {'precision': 0.4001780693616116, 'recall': 0.40216433955910164, 'f1-score': 0.3975242749143925, 'support': 154412}}
[[16739 20992 14645]
 [12649 28092 13039]
 [12701 18287 17268]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0753675
{'0': {'precision': 0.37658920447559324, 'recall': 0.3133235125624028, 'f1-score': 0.3420555946437945, 'support': 48876}, '1': {'precision': 0.4475312469855444, 'recall': 0.5450456498388829, 'f1-score': 0.491498361722575, 'support': 59584}, '2': {'precision': 0.3700339970859641, 'recall': 0.33160689415041783, 'f1-score': 0.34976816783730436, 'support': 45952}, 'accuracy': 0.40818071134367795, 'macro avg': {'precision': 0.39805148284903397, 'recall': 0.3966586855172345, 'f1-score': 0.3944407080678913, 'support': 154412}, 'weighted avg': {'precision': 0.40201330215546716, 'recall': 0.40818071134367795, 'f1-score': 0.40201729449231804, 'support': 154412}}
[[15314 21176 12386]
 [13552 32476 13556]
 [11799 18915 15238]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0786786
{'0': {'precision': 0.37760189135015676, 'recall': 0.2993460590380345, 'f1-score': 0.3339507505596528, 'support': 49087}, '1': {'precision': 0.4349914191067889, 'recall': 0.5489020950846092, 'f1-score': 0.48535272943184776, 'support': 59568}, '2': {'precision': 0.35838436934368106, 'recall': 0.3158860939309832, 'f1-score': 0.33579592974630607, 'support': 45757}, 'accuracy': 0.40051938968473955, 'macro avg': {'precision': 0.39032589326687556, 'recall': 0.3880447493512089, 'f1-score': 0.3850331365792689, 'support': 154412}, 'weighted avg': {'precision': 0.39404648914668006, 'recall': 0.40051938968473955, 'f1-score': 0.39290434834675875, 'support': 154412}}
[[14694 22400 11993]
 [12987 32697 13884]
 [11233 20070 14454]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0863374
{'0': {'precision': 0.36547757284437365, 'recall': 0.27770026263952724, 'f1-score': 0.3155992398008558, 'support': 48736}, '1': {'precision': 0.42341279206986077, 'recall': 0.5380206597800733, 'f1-score': 0.4738857989815535, 'support': 60020}, '2': {'precision': 0.3468563784506871, 'recall': 0.31235763097949887, 'f1-score': 0.3287042906040037, 'support': 45656}, 'accuracy': 0.3891342641763593, 'macro avg': {'precision': 0.3785822477883072, 'recall': 0.37602618446636643, 'f1-score': 0.3727297764621376, 'support': 154412}, 'weighted avg': {'precision': 0.3824911638002293, 'recall': 0.3891342641763593, 'f1-score': 0.3810001379272578, 'support': 154412}}
[[13534 23191 12011]
 [12885 32292 14843]
 [10612 20783 14261]]
Evaluating performance on  train set...
323/323 - 6s - 6s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0758553
{'0': {'precision': 0.4083747927031509, 'recall': 0.33492009520571236, 'f1-score': 0.3680179338688586, 'support': 29410}, '1': {'precision': 0.3916611477439604, 'recall': 0.5246470724369359, 'f1-score': 0.4485038331547275, 'support': 25926}, '2': {'precision': 0.40132851257041957, 'recall': 0.3496831385765046, 'f1-score': 0.3737300577468924, 'support': 27299}, 'accuracy': 0.3993223210504024, 'macro avg': {'precision': 0.4004548176725103, 'recall': 0.4030834354063843, 'f1-score': 0.3967506082568262, 'support': 82635}, 'weighted avg': {'precision': 0.4008032508558053, 'recall': 0.3993223210504024, 'f1-score': 0.39515670914122364, 'support': 82635}}
[[ 9850 11303  8257]
 [ 6341 13602  5983]
 [ 7929  9824  9546]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0728966
{'0': {'precision': 0.4026908903933499, 'recall': 0.32844062347102815, 'f1-score': 0.3617955035417308, 'support': 28614}, '1': {'precision': 0.4100249967109591, 'recall': 0.5591116213985864, 'f1-score': 0.473100977594268, 'support': 27871}, '2': {'precision': 0.3961581814766109, 'recall': 0.3225621414913958, 'f1-score': 0.3555920913958096, 'support': 26150}, 'accuracy': 0.4043807103527561, 'macro avg': {'precision': 0.40295802286030663, 'recall': 0.40337146212033675, 'f1-score': 0.39682952417726947, 'support': 82635}, 'weighted avg': {'precision': 0.40309723805481734, 'recall': 0.4043807103527561, 'f1-score': 0.39737335360166215, 'support': 82635}}
[[ 9398 12048  7168]
 [ 6599 15583  5689]
 [ 7341 10374  8435]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0771321
{'0': {'precision': 0.405119469224907, 'recall': 0.3126340552134505, 'f1-score': 0.3529182043621737, 'support': 28906}, '1': {'precision': 0.3980967685238657, 'recall': 0.5735421791347127, 'f1-score': 0.4699796949800655, 'support': 27644}, '2': {'precision': 0.3909077605970441, 'recall': 0.30722637531148167, 'f1-score': 0.34405186107414243, 'support': 26085}, 'accuracy': 0.398208991347492, 'macro avg': {'precision': 0.39804133278193893, 'recall': 0.3978008698865483, 'f1-score': 0.3889832534721272, 'support': 82635}, 'weighted avg': {'precision': 0.39828401260558843, 'recall': 0.398208991347492, 'f1-score': 0.38928014884057516, 'support': 82635}}
[[ 9037 12896  6973]
 [ 6275 15855  5514]
 [ 6995 11076  8014]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0843264
{'0': {'precision': 0.4036274786204304, 'recall': 0.2925550030651863, 'f1-score': 0.339230708474844, 'support': 29362}, '1': {'precision': 0.3801752276241196, 'recall': 0.5689990817263545, 'f1-score': 0.4558053316071324, 'support': 27225}, '2': {'precision': 0.3775114044453072, 'recall': 0.2986409705159705, 'f1-score': 0.3334762292622283, 'support': 26048}, 'accuracy': 0.3855509166817934, 'macro avg': {'precision': 0.38710470356328575, 'recall': 0.3867316851025038, 'f1-score': 0.37617075644806824, 'support': 82635}, 'weighted avg': {'precision': 0.3876686351099546, 'recall': 0.3855509166817934, 'f1-score': 0.3758235739706549, 'support': 82635}}
[[ 8590 13615  7157]
 [ 6064 15491  5670]
 [ 6628 11641  7779]]
Evaluating performance on  val set...
112/112 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0934339
{'0': {'precision': 0.4306930693069307, 'recall': 0.3433054969257594, 'f1-score': 0.3820660777204719, 'support': 10897}, '1': {'precision': 0.30757828423198075, 'recall': 0.447077834635066, 'f1-score': 0.3644346871569704, 'support': 7426}, '2': {'precision': 0.3990620812862885, 'recall': 0.35340650647681204, 'f1-score': 0.3748492317373748, 'support': 10113}, 'accuracy': 0.3739977493318329, 'macro avg': {'precision': 0.37911114494173326, 'recall': 0.38126327934587917, 'f1-score': 0.37378333220493903, 'support': 28436}, 'weighted avg': {'precision': 0.38729264112366535, 'recall': 0.3739977493318329, 'f1-score': 0.3748950737202038, 'support': 28436}}
[[3741 3886 3270]
 [1994 3320 2112]
 [2951 3588 3574]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0933269
{'0': {'precision': 0.41740061890026187, 'recall': 0.3314118314118314, 'f1-score': 0.3694690265486726, 'support': 10582}, '1': {'precision': 0.32525807525807526, 'recall': 0.48413878562577445, 'f1-score': 0.389104670849517, 'support': 8070}, '2': {'precision': 0.39790575916230364, 'recall': 0.32624693376941943, 'f1-score': 0.35853083230371785, 'support': 9784}, 'accuracy': 0.3729779153186102, 'macro avg': {'precision': 0.38018815110688026, 'recall': 0.38059918360234174, 'f1-score': 0.37236817656730253, 'support': 28436}, 'weighted avg': {'precision': 0.38454339443589874, 'recall': 0.3729779153186102, 'f1-score': 0.3712780136430311, 'support': 28436}}
[[3507 4225 2850]
 [2183 3907 1980]
 [2712 3880 3192]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.094711
{'0': {'precision': 0.4152869413668617, 'recall': 0.31572969903463943, 'f1-score': 0.35872896392279163, 'support': 10566}, '1': {'precision': 0.3167677404111207, 'recall': 0.5057211115302401, 'f1-score': 0.3895399515738498, 'support': 7953}, '2': {'precision': 0.39475733194913054, 'recall': 0.30674599173137035, 'f1-score': 0.3452306644725643, 'support': 9917}, 'accuracy': 0.3657335771557181, 'macro avg': {'precision': 0.3756040045757043, 'recall': 0.3760656007654166, 'f1-score': 0.3644998599897353, 'support': 28436}, 'weighted avg': {'precision': 0.38057336203796005, 'recall': 0.3657335771557181, 'f1-score': 0.3626386962740703, 'support': 28436}}
[[3336 4496 2734]
 [2001 4022 1930]
 [2696 4179 3042]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0995998
{'0': {'precision': 0.4045003309066843, 'recall': 0.29126953869614947, 'f1-score': 0.33867124729872, 'support': 10492}, '1': {'precision': 0.3098213601165376, 'recall': 0.5021123260437376, 'f1-score': 0.3831966241524821, 'support': 8048}, '2': {'precision': 0.37917836182699666, 'recall': 0.3003233629749394, 'f1-score': 0.335175369347017, 'support': 9896}, 'accuracy': 0.35409340272893514, 'macro avg': {'precision': 0.3645000176167395, 'recall': 0.3645684092382755, 'f1-score': 0.3523477469327397, 'support': 28436}, 'weighted avg': {'precision': 0.36889185703793737, 'recall': 0.35409340272893514, 'f1-score': 0.35005628825768137, 'support': 28436}}
[[3056 4582 2854]
 [1995 4041 2012]
 [2504 4420 2972]]
training model: results/CHTR/W10/deepLOB_L1/seq2seq
Epoch 1/50
295/295 - 14s - loss: 13.1743 - accuracy10: 0.3747 - accuracy20: 0.3759 - accuracy30: 0.3766 - accuracy50: 0.3764 - val_loss: 13.9298 - val_accuracy10: 0.3451 - val_accuracy20: 0.3417 - val_accuracy30: 0.3433 - val_accuracy50: 0.3486 - 14s/epoch - 48ms/step
Epoch 2/50
295/295 - 7s - loss: 13.0872 - accuracy10: 0.3863 - accuracy20: 0.3883 - accuracy30: 0.3865 - accuracy50: 0.3815 - val_loss: 13.5756 - val_accuracy10: 0.3482 - val_accuracy20: 0.3414 - val_accuracy30: 0.3420 - val_accuracy50: 0.3475 - 7s/epoch - 24ms/step
Epoch 3/50
295/295 - 7s - loss: 13.0717 - accuracy10: 0.3908 - accuracy20: 0.3901 - accuracy30: 0.3888 - accuracy50: 0.3828 - val_loss: 13.6262 - val_accuracy10: 0.3464 - val_accuracy20: 0.3424 - val_accuracy30: 0.3439 - val_accuracy50: 0.3480 - 7s/epoch - 24ms/step
Epoch 4/50
295/295 - 7s - loss: 13.0496 - accuracy10: 0.3966 - accuracy20: 0.3943 - accuracy30: 0.3915 - accuracy50: 0.3863 - val_loss: 13.6268 - val_accuracy10: 0.3486 - val_accuracy20: 0.3436 - val_accuracy30: 0.3444 - val_accuracy50: 0.3484 - 7s/epoch - 25ms/step
Epoch 5/50
295/295 - 8s - loss: 13.0482 - accuracy10: 0.3971 - accuracy20: 0.3938 - accuracy30: 0.3903 - accuracy50: 0.3857 - val_loss: 13.3723 - val_accuracy10: 0.3524 - val_accuracy20: 0.3464 - val_accuracy30: 0.3459 - val_accuracy50: 0.3502 - 8s/epoch - 26ms/step
Epoch 6/50
295/295 - 7s - loss: 13.0252 - accuracy10: 0.4007 - accuracy20: 0.3971 - accuracy30: 0.3934 - accuracy50: 0.3876 - val_loss: 13.4849 - val_accuracy10: 0.3508 - val_accuracy20: 0.3472 - val_accuracy30: 0.3481 - val_accuracy50: 0.3515 - 7s/epoch - 23ms/step
Epoch 7/50
295/295 - 7s - loss: 13.0042 - accuracy10: 0.4033 - accuracy20: 0.4008 - accuracy30: 0.3970 - accuracy50: 0.3905 - val_loss: 13.4105 - val_accuracy10: 0.3494 - val_accuracy20: 0.3469 - val_accuracy30: 0.3471 - val_accuracy50: 0.3506 - 7s/epoch - 24ms/step
Epoch 8/50
295/295 - 7s - loss: 13.0011 - accuracy10: 0.4044 - accuracy20: 0.4019 - accuracy30: 0.3975 - accuracy50: 0.3907 - val_loss: 13.3056 - val_accuracy10: 0.3509 - val_accuracy20: 0.3486 - val_accuracy30: 0.3475 - val_accuracy50: 0.3504 - 7s/epoch - 25ms/step
Epoch 9/50
295/295 - 7s - loss: 12.9833 - accuracy10: 0.4057 - accuracy20: 0.4032 - accuracy30: 0.4008 - accuracy50: 0.3948 - val_loss: 13.4684 - val_accuracy10: 0.3476 - val_accuracy20: 0.3461 - val_accuracy30: 0.3456 - val_accuracy50: 0.3491 - 7s/epoch - 24ms/step
Epoch 10/50
295/295 - 7s - loss: 12.9644 - accuracy10: 0.4078 - accuracy20: 0.4059 - accuracy30: 0.4024 - accuracy50: 0.3985 - val_loss: 13.6536 - val_accuracy10: 0.3193 - val_accuracy20: 0.3256 - val_accuracy30: 0.3296 - val_accuracy50: 0.3344 - 7s/epoch - 25ms/step
Epoch 11/50
295/295 - 7s - loss: 12.9459 - accuracy10: 0.4124 - accuracy20: 0.4086 - accuracy30: 0.4058 - accuracy50: 0.3990 - val_loss: 13.5854 - val_accuracy10: 0.3368 - val_accuracy20: 0.3366 - val_accuracy30: 0.3385 - val_accuracy50: 0.3415 - 7s/epoch - 23ms/step
Epoch 12/50
295/295 - 7s - loss: 12.9393 - accuracy10: 0.4122 - accuracy20: 0.4106 - accuracy30: 0.4071 - accuracy50: 0.4007 - val_loss: 13.7482 - val_accuracy10: 0.3448 - val_accuracy20: 0.3436 - val_accuracy30: 0.3431 - val_accuracy50: 0.3476 - 7s/epoch - 24ms/step
Epoch 13/50
295/295 - 7s - loss: 12.9219 - accuracy10: 0.4161 - accuracy20: 0.4138 - accuracy30: 0.4100 - accuracy50: 0.4039 - val_loss: 13.6518 - val_accuracy10: 0.3440 - val_accuracy20: 0.3475 - val_accuracy30: 0.3460 - val_accuracy50: 0.3473 - 7s/epoch - 23ms/step
Epoch 14/50
295/295 - 7s - loss: 12.9149 - accuracy10: 0.4152 - accuracy20: 0.4146 - accuracy30: 0.4100 - accuracy50: 0.4052 - val_loss: 13.4919 - val_accuracy10: 0.3469 - val_accuracy20: 0.3458 - val_accuracy30: 0.3442 - val_accuracy50: 0.3452 - 7s/epoch - 24ms/step
Epoch 15/50
295/295 - 7s - loss: 12.9055 - accuracy10: 0.4163 - accuracy20: 0.4148 - accuracy30: 0.4110 - accuracy50: 0.4049 - val_loss: 13.6480 - val_accuracy10: 0.3421 - val_accuracy20: 0.3418 - val_accuracy30: 0.3391 - val_accuracy50: 0.3409 - 7s/epoch - 23ms/step
Epoch 16/50
295/295 - 7s - loss: 12.8851 - accuracy10: 0.4202 - accuracy20: 0.4187 - accuracy30: 0.4132 - accuracy50: 0.4075 - val_loss: 13.5752 - val_accuracy10: 0.3414 - val_accuracy20: 0.3430 - val_accuracy30: 0.3411 - val_accuracy50: 0.3410 - 7s/epoch - 24ms/step
Epoch 17/50
295/295 - 7s - loss: 12.8701 - accuracy10: 0.4225 - accuracy20: 0.4213 - accuracy30: 0.4167 - accuracy50: 0.4108 - val_loss: 13.5398 - val_accuracy10: 0.3113 - val_accuracy20: 0.3124 - val_accuracy30: 0.3092 - val_accuracy50: 0.3071 - 7s/epoch - 25ms/step
Epoch 18/50
295/295 - 7s - loss: 12.8486 - accuracy10: 0.4244 - accuracy20: 0.4231 - accuracy30: 0.4187 - accuracy50: 0.4112 - val_loss: 13.5650 - val_accuracy10: 0.3112 - val_accuracy20: 0.3193 - val_accuracy30: 0.3197 - val_accuracy50: 0.3184 - 7s/epoch - 24ms/step
testing model: results/CHTR/W10/deepLOB_L1/seq2seq
Evaluating performance on  test set...
1588/1588 - 18s - 18s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1218395
{'0': {'precision': 0.3959547480287967, 'recall': 0.0329646806992508, 'f1-score': 0.06086234833814171, 'support': 140150}, '1': {'precision': 0.3017877234654332, 'recall': 0.5347595275204317, 'f1-score': 0.38583322154642674, 'support': 126397}, '2': {'precision': 0.3633955674319937, 'recall': 0.4437701715340742, 'f1-score': 0.39958116532693266, 'support': 139739}, 'accuracy': 0.33036826275087006, 'macro avg': {'precision': 0.3537126796420746, 'recall': 0.33716479325125226, 'f1-score': 0.28209224507050035, 'support': 406286}, 'weighted avg': {'precision': 0.35546057214985405, 'recall': 0.33036826275087006, 'f1-score': 0.27846170501817563, 'support': 406286}}
[[ 4620 82033 53497]
 [ 3668 67592 55137]
 [ 3380 74347 62012]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1218532
{'0': {'precision': 0.40227416298168034, 'recall': 0.022635822041489527, 'f1-score': 0.04285993121411793, 'support': 140662}, '1': {'precision': 0.2982958953229783, 'recall': 0.5511247362344229, 'f1-score': 0.38708324361810115, 'support': 125585}, '2': {'precision': 0.3559993507391354, 'recall': 0.42286791536643364, 'f1-score': 0.386563179299045, 'support': 140039}, 'accuracy': 0.3239466779559227, 'macro avg': {'precision': 0.352189803014598, 'recall': 0.33220949121411536, 'f1-score': 0.27216878471042133, 'support': 406286}, 'weighted avg': {'precision': 0.3541839280842144, 'recall': 0.3239466779559227, 'f1-score': 0.26772897382651245, 'support': 406286}}
[[ 3184 84311 53167]
 [ 2414 69213 53958]
 [ 2317 78504 59218]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1231834
{'0': {'precision': 0.39406184118060433, 'recall': 0.015842521242257084, 'f1-score': 0.03046043741894305, 'support': 141581}, '1': {'precision': 0.2916756819732703, 'recall': 0.5669330184559145, 'f1-score': 0.3851826209276385, 'support': 123646}, '2': {'precision': 0.3527598557362319, 'recall': 0.4007826512310452, 'f1-score': 0.37524102203298143, 'support': 141059}, 'accuracy': 0.3172051215153857, 'macro avg': {'precision': 0.34616579296336886, 'recall': 0.3278527303097389, 'f1-score': 0.26362802679318764, 'support': 406286}, 'weighted avg': {'precision': 0.3485627203491021, 'recall': 0.3172051215153857, 'f1-score': 0.25811874606651597, 'support': 406286}}
[[ 2243 87413 51925]
 [ 1744 70099 51803]
 [ 1705 82820 56534]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1248624
{'0': {'precision': 0.39671903881700554, 'recall': 0.011892311208693785, 'f1-score': 0.023092389732830332, 'support': 144379}, '1': {'precision': 0.28440260063810463, 'recall': 0.5903248675924767, 'f1-score': 0.38386796725214706, 'support': 119895}, '2': {'precision': 0.350988921983592, 'recall': 0.37838351688589694, 'f1-score': 0.3641717608468764, 'support': 142012}, 'accuracy': 0.31069000654711215, 'macro avg': {'precision': 0.34403685381290067, 'recall': 0.3268668985623558, 'f1-score': 0.2570440392772846, 'support': 406286}, 'weighted avg': {'precision': 0.34759008850317236, 'recall': 0.31069000654711215, 'f1-score': 0.2487771327890183, 'support': 406286}}
[[ 1717 91113 51549]
 [ 1306 70777 47812]
 [ 1305 86972 53735]]
Evaluating performance on  train set...
295/295 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1148319
{'0': {'precision': 0.47678369195922987, 'recall': 0.016169918574281763, 'f1-score': 0.031279022251941006, 'support': 26036}, '1': {'precision': 0.3336259079903148, 'recall': 0.8861288637003095, 'f1-score': 0.4847458745148914, 'support': 24879}, '2': {'precision': 0.4349712677377741, 'recall': 0.15092573753814853, 'f1-score': 0.22409522083257807, 'support': 24575}, 'accuracy': 0.3467479136309445, 'macro avg': {'precision': 0.4151269558957729, 'recall': 0.3510748399375799, 'f1-score': 0.24670670586647014, 'support': 75490}, 'weighted avg': {'precision': 0.41599202640611144, 'recall': 0.3467479136309445, 'f1-score': 0.24349600327683302, 'support': 75490}}
[[  421 23350  2265]
 [  280 22046  2553]
 [  182 20684  3709]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1131285
{'0': {'precision': 0.5081168831168831, 'recall': 0.011953864955698137, 'f1-score': 0.02335820895522388, 'support': 26184}, '1': {'precision': 0.3323583835730914, 'recall': 0.895176848874598, 'f1-score': 0.48474295912593046, 'support': 24880}, '2': {'precision': 0.4217756296107861, 'recall': 0.13575698026692867, 'f1-score': 0.2054013875123885, 'support': 24426}, 'accuracy': 0.3431050470260962, 'macro avg': {'precision': 0.4207502987669202, 'recall': 0.34762923136574164, 'f1-score': 0.2378341851978476, 'support': 75490}, 'weighted avg': {'precision': 0.42225328625916064, 'recall': 0.3431050470260962, 'f1-score': 0.2343244198928909, 'support': 75490}}
[[  313 23760  2111]
 [  173 22272  2435]
 [  130 20980  3316]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1125922
{'0': {'precision': 0.47438752783964366, 'recall': 0.008111195734958112, 'f1-score': 0.015949679883185446, 'support': 26260}, '1': {'precision': 0.3310315317309253, 'recall': 0.9018370382280821, 'f1-score': 0.48429573664328124, 'support': 24877}, '2': {'precision': 0.4116675839295542, 'recall': 0.12285960661930768, 'f1-score': 0.18924132696625662, 'support': 24353}, 'accuracy': 0.33964763544840376, 'macro avg': {'precision': 0.4056955478333744, 'recall': 0.344269280194116, 'f1-score': 0.22982891449757445, 'support': 75490}, 'weighted avg': {'precision': 0.40691255222381384, 'recall': 0.33964763544840376, 'f1-score': 0.22619231248929136, 'support': 75490}}
[[  213 24087  1960]
 [  126 22435  2316]
 [  110 21251  2992]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1132462
{'0': {'precision': 0.45794392523364486, 'recall': 0.005590416428978893, 'f1-score': 0.011045987376014426, 'support': 26295}, '1': {'precision': 0.32991935012565016, 'recall': 0.9117742065735283, 'f1-score': 0.4845188284518829, 'support': 24766}, '2': {'precision': 0.4087732342007435, 'recall': 0.11253018952883867, 'f1-score': 0.17647814084868718, 'support': 24429}, 'accuracy': 0.33748840906080274, 'macro avg': {'precision': 0.3988788365200128, 'recall': 0.34329827084378195, 'f1-score': 0.2240143188921948, 'support': 75490}, 'weighted avg': {'precision': 0.4000309905619355, 'recall': 0.33748840906080274, 'f1-score': 0.21991299571180567, 'support': 75490}}
[[  147 24258  1890]
 [   99 22581  2086]
 [   75 21605  2749]]
Evaluating performance on  val set...
131/131 - 1s - 988ms/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1125441
{'0': {'precision': 0.4859154929577465, 'recall': 0.012203749557835162, 'f1-score': 0.02380952380952381, 'support': 11308}, '1': {'precision': 0.342010412494994, 'recall': 0.7413838006771422, 'f1-score': 0.4680862725752966, 'support': 11519}, '2': {'precision': 0.3602469135802469, 'recall': 0.27719198252113614, 'f1-score': 0.3133086379986042, 'support': 10527}, 'accuracy': 0.3476644480422138, 'macro avg': {'precision': 0.3960576063443291, 'recall': 0.34359317758537117, 'f1-score': 0.2684014781278082, 'support': 33354}, 'weighted avg': {'precision': 0.3965542242356327, 'recall': 0.3476644480422138, 'f1-score': 0.26861317686766933, 'support': 33354}}
[[ 138 8881 2289]
 [  86 8540 2893]
 [  60 7549 2918]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1112751
{'0': {'precision': 0.4673913043478261, 'recall': 0.007550482879719052, 'f1-score': 0.014860895109728703, 'support': 11390}, '1': {'precision': 0.3413928012519562, 'recall': 0.7698279664755183, 'f1-score': 0.4730180241225098, 'support': 11335}, '2': {'precision': 0.3649145860709593, 'recall': 0.26126634678709193, 'f1-score': 0.30451230878885904, 'support': 10629}, 'accuracy': 0.34745457816153985, 'macro avg': {'precision': 0.3912328972235805, 'recall': 0.3462149320474431, 'f1-score': 0.26413040934036586, 'support': 33354}, 'weighted avg': {'precision': 0.3919155571763773, 'recall': 0.34745457816153985, 'f1-score': 0.2628646108066571, 'support': 33354}}
[[  86 9016 2288]
 [  64 8726 2545]
 [  34 7818 2777]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.110706
{'0': {'precision': 0.5, 'recall': 0.005108781819783317, 'f1-score': 0.010114220943412678, 'support': 11353}, '1': {'precision': 0.34194580999199725, 'recall': 0.7895292564892213, 'f1-score': 0.47721108333776524, 'support': 11365}, '2': {'precision': 0.36258396455623837, 'recall': 0.2385295223768334, 'f1-score': 0.28775591221006064, 'support': 10636}, 'accuracy': 0.3468249685195179, 'macro avg': {'precision': 0.40150992484941184, 'recall': 0.34438918689527936, 'f1-score': 0.25836040549707956, 'support': 33354}, 'weighted avg': {'precision': 0.4023252736577082, 'recall': 0.3468249685195179, 'f1-score': 0.2578072373559534, 'support': 33354}}
[[  58 9196 2099]
 [  31 8973 2361]
 [  27 8072 2537]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1097248
{'0': {'precision': 0.4266666666666667, 'recall': 0.002845709204090707, 'f1-score': 0.005653710247349823, 'support': 11245}, '1': {'precision': 0.34793919797822126, 'recall': 0.8113354710113528, 'f1-score': 0.48702075638557973, 'support': 11539}, '2': {'precision': 0.35844318895166355, 'recall': 0.21608325449385052, 'f1-score': 0.2696257820800378, 'support': 10570}, 'accuracy': 0.3501229237872519, 'macro avg': {'precision': 0.3776830178655171, 'recall': 0.3434214782364313, 'f1-score': 0.25410008290432246, 'support': 33354}, 'weighted avg': {'precision': 0.37781020505356017, 'recall': 0.3501229237872519, 'f1-score': 0.2558389697262893, 'support': 33354}}
[[  32 9279 1934]
 [  23 9362 2154]
 [  20 8266 2284]]
training model: results/CHTR/W10/deepOF_L1/seq2seq
Epoch 1/50
295/295 - 12s - loss: 13.1325 - accuracy10: 0.3769 - accuracy20: 0.3851 - accuracy30: 0.3868 - accuracy50: 0.3833 - val_loss: 13.5296 - val_accuracy10: 0.3614 - val_accuracy20: 0.3560 - val_accuracy30: 0.3522 - val_accuracy50: 0.3556 - 12s/epoch - 41ms/step
Epoch 2/50
295/295 - 7s - loss: 13.0435 - accuracy10: 0.3978 - accuracy20: 0.4004 - accuracy30: 0.3989 - accuracy50: 0.3941 - val_loss: 13.1418 - val_accuracy10: 0.3688 - val_accuracy20: 0.3671 - val_accuracy30: 0.3663 - val_accuracy50: 0.3681 - 7s/epoch - 24ms/step
Epoch 3/50
295/295 - 7s - loss: 12.9971 - accuracy10: 0.4015 - accuracy20: 0.4044 - accuracy30: 0.4025 - accuracy50: 0.3989 - val_loss: 13.1098 - val_accuracy10: 0.3809 - val_accuracy20: 0.3751 - val_accuracy30: 0.3705 - val_accuracy50: 0.3715 - 7s/epoch - 23ms/step
Epoch 4/50
295/295 - 7s - loss: 12.9801 - accuracy10: 0.4033 - accuracy20: 0.4060 - accuracy30: 0.4055 - accuracy50: 0.3990 - val_loss: 13.0317 - val_accuracy10: 0.3891 - val_accuracy20: 0.3831 - val_accuracy30: 0.3782 - val_accuracy50: 0.3762 - 7s/epoch - 24ms/step
Epoch 5/50
295/295 - 6s - loss: 12.9479 - accuracy10: 0.4081 - accuracy20: 0.4105 - accuracy30: 0.4091 - accuracy50: 0.4017 - val_loss: 13.0428 - val_accuracy10: 0.3953 - val_accuracy20: 0.3864 - val_accuracy30: 0.3804 - val_accuracy50: 0.3786 - 6s/epoch - 21ms/step
Epoch 6/50
295/295 - 7s - loss: 12.9274 - accuracy10: 0.4122 - accuracy20: 0.4130 - accuracy30: 0.4109 - accuracy50: 0.4031 - val_loss: 13.0730 - val_accuracy10: 0.4001 - val_accuracy20: 0.3912 - val_accuracy30: 0.3854 - val_accuracy50: 0.3823 - 7s/epoch - 22ms/step
Epoch 7/50
295/295 - 7s - loss: 12.9048 - accuracy10: 0.4143 - accuracy20: 0.4155 - accuracy30: 0.4134 - accuracy50: 0.4041 - val_loss: 13.0727 - val_accuracy10: 0.4039 - val_accuracy20: 0.3956 - val_accuracy30: 0.3889 - val_accuracy50: 0.3848 - 7s/epoch - 22ms/step
Epoch 8/50
295/295 - 7s - loss: 12.8861 - accuracy10: 0.4155 - accuracy20: 0.4190 - accuracy30: 0.4174 - accuracy50: 0.4082 - val_loss: 13.1098 - val_accuracy10: 0.4062 - val_accuracy20: 0.3966 - val_accuracy30: 0.3881 - val_accuracy50: 0.3799 - 7s/epoch - 24ms/step
Epoch 9/50
295/295 - 7s - loss: 12.8622 - accuracy10: 0.4201 - accuracy20: 0.4211 - accuracy30: 0.4199 - accuracy50: 0.4104 - val_loss: 13.1314 - val_accuracy10: 0.4113 - val_accuracy20: 0.4027 - val_accuracy30: 0.3935 - val_accuracy50: 0.3793 - 7s/epoch - 23ms/step
Epoch 10/50
295/295 - 7s - loss: 12.8405 - accuracy10: 0.4220 - accuracy20: 0.4245 - accuracy30: 0.4231 - accuracy50: 0.4147 - val_loss: 13.1306 - val_accuracy10: 0.4128 - val_accuracy20: 0.4033 - val_accuracy30: 0.3925 - val_accuracy50: 0.3823 - 7s/epoch - 22ms/step
Epoch 11/50
295/295 - 6s - loss: 12.8254 - accuracy10: 0.4240 - accuracy20: 0.4276 - accuracy30: 0.4258 - accuracy50: 0.4177 - val_loss: 13.1305 - val_accuracy10: 0.4131 - val_accuracy20: 0.4031 - val_accuracy30: 0.3913 - val_accuracy50: 0.3761 - 6s/epoch - 21ms/step
Epoch 12/50
295/295 - 7s - loss: 12.8144 - accuracy10: 0.4278 - accuracy20: 0.4299 - accuracy30: 0.4261 - accuracy50: 0.4167 - val_loss: 13.0855 - val_accuracy10: 0.4143 - val_accuracy20: 0.4066 - val_accuracy30: 0.3965 - val_accuracy50: 0.3886 - 7s/epoch - 22ms/step
Epoch 13/50
295/295 - 7s - loss: 12.8046 - accuracy10: 0.4266 - accuracy20: 0.4301 - accuracy30: 0.4276 - accuracy50: 0.4169 - val_loss: 13.1189 - val_accuracy10: 0.4175 - val_accuracy20: 0.4049 - val_accuracy30: 0.3882 - val_accuracy50: 0.3685 - 7s/epoch - 23ms/step
Epoch 14/50
295/295 - 7s - loss: 12.7828 - accuracy10: 0.4292 - accuracy20: 0.4320 - accuracy30: 0.4302 - accuracy50: 0.4207 - val_loss: 13.1299 - val_accuracy10: 0.4164 - val_accuracy20: 0.4062 - val_accuracy30: 0.3892 - val_accuracy50: 0.3693 - 7s/epoch - 22ms/step
testing model: results/CHTR/W10/deepOF_L1/seq2seq
Evaluating performance on  test set...
1588/1588 - 15s - 15s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1001441
{'0': {'precision': 0.41324317427915286, 'recall': 0.023110952550838386, 'f1-score': 0.04377381949887828, 'support': 140150}, '1': {'precision': 0.32644912625047484, 'recall': 0.6526812981628874, 'f1-score': 0.43521727890941125, 'support': 126394}, '2': {'precision': 0.42153438681478533, 'recall': 0.4396401811975354, 'f1-score': 0.43039695105718173, 'support': 139737}, 'accuracy': 0.36223205121578417, 'macro avg': {'precision': 0.3870755624481377, 'recall': 0.37181081063708704, 'f1-score': 0.30312934982182377, 'support': 406281}, 'weighted avg': {'precision': 0.38909324420502917, 'recall': 0.36223205121578417, 'f1-score': 0.29852769955553254, 'support': 406281}}
[[ 3239 94320 42591]
 [ 2185 82495 41714]
 [ 2414 75889 61434]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1010882
{'0': {'precision': 0.3983865963388148, 'recall': 0.009128329814234223, 'f1-score': 0.017847710655806065, 'support': 140661}, '1': {'precision': 0.3178858953676845, 'recall': 0.6605910035593989, 'f1-score': 0.4292233426636382, 'support': 125583}, '2': {'precision': 0.4202566033486526, 'recall': 0.4264087348343652, 'f1-score': 0.423310317449065, 'support': 140037}, 'accuracy': 0.3543261929551222, 'macro avg': {'precision': 0.3788430316850506, 'recall': 0.36537602273599945, 'f1-score': 0.2901271235895031, 'support': 406281}, 'weighted avg': {'precision': 0.3810416814685137, 'recall': 0.3543261929551222, 'f1-score': 0.28476039685562143, 'support': 406281}}
[[ 1284 98734 40643]
 [  893 82959 41731]
 [ 1046 79278 59713]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1030817
{'0': {'precision': 0.38745874587458745, 'recall': 0.004146124397858424, 'f1-score': 0.008204454445710132, 'support': 141578}, '1': {'precision': 0.31095995315104286, 'recall': 0.6699502608273686, 'f1-score': 0.4247640584258255, 'support': 123645}, '2': {'precision': 0.42244431918368525, 'recall': 0.4144181825915581, 'f1-score': 0.4183927625645944, 'support': 141058}, 'accuracy': 0.3492164290232622, 'macro avg': {'precision': 0.37362100606977183, 'recall': 0.3628381892722617, 'f1-score': 0.2837870918120433, 'support': 406281}, 'weighted avg': {'precision': 0.37632433834268725, 'recall': 0.3492164290232622, 'f1-score': 0.27739217083105655, 'support': 406281}}
[[   587 101466  39525]
 [   413  82836  40396]
 [   515  82086  58457]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1069226
{'0': {'precision': 0.35860655737704916, 'recall': 0.002424175260945151, 'f1-score': 0.004815795810257645, 'support': 144379}, '1': {'precision': 0.2990769094053045, 'recall': 0.6736950973359801, 'f1-score': 0.41425256112728065, 'support': 119894}, '2': {'precision': 0.42300013310262213, 'recall': 0.4028223762041575, 'f1-score': 0.41266474776549006, 'support': 142008}, 'accuracy': 0.3404687888431898, 'macro avg': {'precision': 0.36022786662832523, 'recall': 0.3596472162670276, 'f1-score': 0.2772443682343428, 'support': 406281}, 'weighted avg': {'precision': 0.36354687033215366, 'recall': 0.3404687888431898, 'f1-score': 0.2681971144300745, 'support': 406281}}
[[   350 104835  39194]
 [   286  80772  38836]
 [   340  84464  57204]]
Evaluating performance on  train set...
295/295 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0924584
{'0': {'precision': 0.45006657789613846, 'recall': 0.026066167964833808, 'f1-score': 0.0492783204548768, 'support': 25934}, '1': {'precision': 0.3452267112917364, 'recall': 0.6959717257721194, 'f1-score': 0.46152207204208, 'support': 24899}, '2': {'precision': 0.42173182009247584, 'recall': 0.4069357128371527, 'f1-score': 0.41420167199917435, 'support': 24655}, 'accuracy': 0.3714232725731242, 'macro avg': {'precision': 0.40567503642678354, 'recall': 0.37632453552470196, 'f1-score': 0.3083340214987104, 'support': 75488}, 'weighted avg': {'precision': 0.4062317790906023, 'recall': 0.3714232725731242, 'f1-score': 0.3044399673801421, 'support': 75488}}
[[  676 18671  6587]
 [  400 17329  7170]
 [  426 14196 10033]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0930529
{'0': {'precision': 0.4634146341463415, 'recall': 0.010202516109235962, 'f1-score': 0.019965473241762368, 'support': 26072}, '1': {'precision': 0.33957245021878674, 'recall': 0.7068169963487542, 'f1-score': 0.45875, 'support': 24923}, '2': {'precision': 0.4151582237270478, 'recall': 0.39047891234230186, 'f1-score': 0.4024405638544077, 'support': 24493}, 'accuracy': 0.36358096651123356, 'macro avg': {'precision': 0.4060484360307253, 'recall': 0.3691661416000973, 'f1-score': 0.2937186790320567, 'support': 75488}, 'weighted avg': {'precision': 0.40686971296117025, 'recall': 0.36358096651123356, 'f1-score': 0.2889325826468477, 'support': 75488}}
[[  266 19490  6316]
 [  150 17616  7157]
 [  158 14771  9564]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0942391
{'0': {'precision': 0.4878048780487805, 'recall': 0.004590841271663032, 'f1-score': 0.009096077316657191, 'support': 26139}, '1': {'precision': 0.337395996453031, 'recall': 0.71652375991666, 'f1-score': 0.45876784546119215, 'support': 24958}, '2': {'precision': 0.40910112864787085, 'recall': 0.3730064368004592, 'f1-score': 0.39022088784044606, 'support': 24391}, 'accuracy': 0.3590107036880034, 'macro avg': {'precision': 0.4114340010498941, 'recall': 0.36470701266292743, 'f1-score': 0.2860282702060985, 'support': 75488}, 'weighted avg': {'precision': 0.41264633604867046, 'recall': 0.3590107036880034, 'f1-score': 0.28091309780782187, 'support': 75488}}
[[  120 19889  6130]
 [   64 17883  7011]
 [   62 15231  9098]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0981814
{'0': {'precision': 0.4479166666666667, 'recall': 0.0032811903853491036, 'f1-score': 0.006514657980456026, 'support': 26210}, '1': {'precision': 0.3350327478416195, 'recall': 0.7236265723586385, 'f1-score': 0.4580106070433821, 'support': 24883}, '2': {'precision': 0.4015404602821084, 'recall': 0.35474482475917196, 'f1-score': 0.376694887587873, 'support': 24395}, 'accuracy': 0.3543079694785926, 'macro avg': {'precision': 0.3948299582634649, 'recall': 0.36055086250105317, 'f1-score': 0.28040671753723706, 'support': 75488}, 'weighted avg': {'precision': 0.3957197862767378, 'recall': 0.3543079694785926, 'f1-score': 0.2749695170548218, 'support': 75488}}
[[   86 20062  6062]
 [   41 18006  6836]
 [   65 15676  8654]]
Evaluating performance on  val set...
131/131 - 1s - 969ms/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0843517
{'0': {'precision': 0.48792270531400966, 'recall': 0.02669838752312979, 'f1-score': 0.0506265664160401, 'support': 11349}, '1': {'precision': 0.3710492505353319, 'recall': 0.7558230829625753, 'f1-score': 0.4977450952230489, 'support': 11463}, '2': {'precision': 0.4289672812533305, 'recall': 0.38180610889774236, 'f1-score': 0.4040150564617315, 'support': 10542}, 'accuracy': 0.38951849853091086, 'macro avg': {'precision': 0.42931307903422405, 'recall': 0.38810919312781583, 'f1-score': 0.3174622393669402, 'support': 33354}, 'weighted avg': {'precision': 0.42912230678382846, 'recall': 0.38951849853091086, 'f1-score': 0.31598427936730294, 'support': 33354}}
[[ 303 8340 2706]
 [ 147 8664 2652]
 [ 171 6346 4025]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0860006
{'0': {'precision': 0.42641509433962266, 'recall': 0.009920983318700614, 'f1-score': 0.019390819390819387, 'support': 11390}, '1': {'precision': 0.3628760454375234, 'recall': 0.7691154422788605, 'f1-score': 0.493101888499378, 'support': 11339}, '2': {'precision': 0.4280035335689046, 'recall': 0.3648, 'f1-score': 0.393882424673543, 'support': 10625}, 'accuracy': 0.38106374048090186, 'macro avg': {'precision': 0.4057648911153502, 'recall': 0.38127880853252033, 'f1-score': 0.30212504418791347, 'support': 33354}, 'weighted avg': {'precision': 0.4053204097833541, 'recall': 0.38106374048090186, 'f1-score': 0.29972850358914294, 'support': 33354}}
[[ 113 8643 2634]
 [  72 8721 2546]
 [  80 6669 3876]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0885471
{'0': {'precision': 0.44761904761904764, 'recall': 0.004135503739551254, 'f1-score': 0.008195292066259808, 'support': 11365}, '1': {'precision': 0.36161261334858263, 'recall': 0.7775338134551203, 'f1-score': 0.4936433589829375, 'support': 11386}, '2': {'precision': 0.42591536443481237, 'recall': 0.352164481750448, 'f1-score': 0.3855446566855963, 'support': 10603}, 'accuracy': 0.3787851532050129, 'macro avg': {'precision': 0.41171567513414753, 'recall': 0.3779445996483732, 'f1-score': 0.2957944359115979, 'support': 33354}, 'weighted avg': {'precision': 0.4113597259962749, 'recall': 0.3787851532050129, 'f1-score': 0.2938685847139817, 'support': 33354}}
[[  47 8791 2527]
 [  27 8853 2506]
 [  31 6838 3734]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0919352
{'0': {'precision': 0.410958904109589, 'recall': 0.0026692766260343445, 'f1-score': 0.005304101838755304, 'support': 11239}, '1': {'precision': 0.36458038708634694, 'recall': 0.7816181566181566, 'f1-score': 0.49723087096685314, 'support': 11544}, '2': {'precision': 0.41139240506329117, 'recall': 0.3320404881278971, 'f1-score': 0.36748154740093186, 'support': 10571}, 'accuracy': 0.3766564729867482, 'macro avg': {'precision': 0.3956438987530757, 'recall': 0.37210930712402934, 'f1-score': 0.29000550673551345, 'support': 33354}, 'weighted avg': {'precision': 0.39504443921977905, 'recall': 0.3766564729867482, 'f1-score': 0.2903487861300706, 'support': 33354}}
[[  30 8688 2521]
 [  20 9023 2501]
 [  23 7038 3510]]
training model: results/CHTR/W10/deepLOB_L2/seq2seq
Epoch 1/50
295/295 - 20s - loss: 13.2173 - accuracy10: 0.3655 - accuracy20: 0.3646 - accuracy30: 0.3667 - accuracy50: 0.3667 - val_loss: 13.4493 - val_accuracy10: 0.3488 - val_accuracy20: 0.3445 - val_accuracy30: 0.3465 - val_accuracy50: 0.3463 - 20s/epoch - 69ms/step
Epoch 2/50
295/295 - 15s - loss: 13.1412 - accuracy10: 0.3726 - accuracy20: 0.3746 - accuracy30: 0.3761 - accuracy50: 0.3728 - val_loss: 13.7062 - val_accuracy10: 0.3411 - val_accuracy20: 0.3377 - val_accuracy30: 0.3381 - val_accuracy50: 0.3448 - 15s/epoch - 50ms/step
Epoch 3/50
295/295 - 15s - loss: 13.1137 - accuracy10: 0.3829 - accuracy20: 0.3859 - accuracy30: 0.3830 - accuracy50: 0.3798 - val_loss: 13.3713 - val_accuracy10: 0.3362 - val_accuracy20: 0.3303 - val_accuracy30: 0.3310 - val_accuracy50: 0.3292 - 15s/epoch - 50ms/step
Epoch 4/50
295/295 - 15s - loss: 13.0818 - accuracy10: 0.3856 - accuracy20: 0.3870 - accuracy30: 0.3852 - accuracy50: 0.3822 - val_loss: 13.7099 - val_accuracy10: 0.3497 - val_accuracy20: 0.3461 - val_accuracy30: 0.3473 - val_accuracy50: 0.3508 - 15s/epoch - 50ms/step
Epoch 5/50
295/295 - 15s - loss: 13.0480 - accuracy10: 0.3929 - accuracy20: 0.3934 - accuracy30: 0.3928 - accuracy50: 0.3917 - val_loss: 13.3823 - val_accuracy10: 0.3491 - val_accuracy20: 0.3446 - val_accuracy30: 0.3442 - val_accuracy50: 0.3448 - 15s/epoch - 51ms/step
Epoch 6/50
295/295 - 15s - loss: 13.0238 - accuracy10: 0.3957 - accuracy20: 0.3976 - accuracy30: 0.3961 - accuracy50: 0.3940 - val_loss: 13.2522 - val_accuracy10: 0.3537 - val_accuracy20: 0.3508 - val_accuracy30: 0.3531 - val_accuracy50: 0.3531 - 15s/epoch - 50ms/step
Epoch 7/50
295/295 - 15s - loss: 13.0024 - accuracy10: 0.4021 - accuracy20: 0.4024 - accuracy30: 0.4010 - accuracy50: 0.3987 - val_loss: 13.2252 - val_accuracy10: 0.3656 - val_accuracy20: 0.3651 - val_accuracy30: 0.3644 - val_accuracy50: 0.3634 - 15s/epoch - 50ms/step
Epoch 8/50
295/295 - 15s - loss: 12.9720 - accuracy10: 0.4059 - accuracy20: 0.4054 - accuracy30: 0.4033 - accuracy50: 0.4018 - val_loss: 13.3010 - val_accuracy10: 0.3432 - val_accuracy20: 0.3480 - val_accuracy30: 0.3490 - val_accuracy50: 0.3485 - 15s/epoch - 50ms/step
Epoch 9/50
295/295 - 15s - loss: 12.9515 - accuracy10: 0.4082 - accuracy20: 0.4079 - accuracy30: 0.4073 - accuracy50: 0.4051 - val_loss: 13.3299 - val_accuracy10: 0.3410 - val_accuracy20: 0.3412 - val_accuracy30: 0.3405 - val_accuracy50: 0.3369 - 15s/epoch - 49ms/step
Epoch 10/50
295/295 - 15s - loss: 12.9424 - accuracy10: 0.4106 - accuracy20: 0.4104 - accuracy30: 0.4098 - accuracy50: 0.4065 - val_loss: 13.2530 - val_accuracy10: 0.3594 - val_accuracy20: 0.3630 - val_accuracy30: 0.3629 - val_accuracy50: 0.3576 - 15s/epoch - 51ms/step
Epoch 11/50
295/295 - 15s - loss: 12.9138 - accuracy10: 0.4143 - accuracy20: 0.4142 - accuracy30: 0.4127 - accuracy50: 0.4077 - val_loss: 13.3355 - val_accuracy10: 0.3550 - val_accuracy20: 0.3562 - val_accuracy30: 0.3526 - val_accuracy50: 0.3472 - 15s/epoch - 50ms/step
Epoch 12/50
295/295 - 15s - loss: 12.8868 - accuracy10: 0.4176 - accuracy20: 0.4184 - accuracy30: 0.4171 - accuracy50: 0.4138 - val_loss: 13.4153 - val_accuracy10: 0.3429 - val_accuracy20: 0.3448 - val_accuracy30: 0.3430 - val_accuracy50: 0.3369 - 15s/epoch - 49ms/step
Epoch 13/50
295/295 - 15s - loss: 12.8516 - accuracy10: 0.4232 - accuracy20: 0.4230 - accuracy30: 0.4211 - accuracy50: 0.4156 - val_loss: 13.5036 - val_accuracy10: 0.3460 - val_accuracy20: 0.3444 - val_accuracy30: 0.3412 - val_accuracy50: 0.3379 - 15s/epoch - 49ms/step
Epoch 14/50
295/295 - 15s - loss: 12.8234 - accuracy10: 0.4268 - accuracy20: 0.4271 - accuracy30: 0.4245 - accuracy50: 0.4170 - val_loss: 13.6135 - val_accuracy10: 0.3401 - val_accuracy20: 0.3379 - val_accuracy30: 0.3372 - val_accuracy50: 0.3291 - 15s/epoch - 50ms/step
Epoch 15/50
295/295 - 15s - loss: 12.7973 - accuracy10: 0.4276 - accuracy20: 0.4296 - accuracy30: 0.4268 - accuracy50: 0.4212 - val_loss: 13.5795 - val_accuracy10: 0.3394 - val_accuracy20: 0.3399 - val_accuracy30: 0.3396 - val_accuracy50: 0.3323 - 15s/epoch - 50ms/step
Epoch 16/50
295/295 - 15s - loss: 12.7686 - accuracy10: 0.4321 - accuracy20: 0.4356 - accuracy30: 0.4319 - accuracy50: 0.4234 - val_loss: 13.7188 - val_accuracy10: 0.3442 - val_accuracy20: 0.3483 - val_accuracy30: 0.3457 - val_accuracy50: 0.3358 - 15s/epoch - 50ms/step
Epoch 17/50
295/295 - 15s - loss: 12.7352 - accuracy10: 0.4370 - accuracy20: 0.4371 - accuracy30: 0.4335 - accuracy50: 0.4264 - val_loss: 13.6082 - val_accuracy10: 0.3463 - val_accuracy20: 0.3502 - val_accuracy30: 0.3475 - val_accuracy50: 0.3399 - 15s/epoch - 50ms/step
testing model: results/CHTR/W10/deepLOB_L2/seq2seq
Evaluating performance on  test set...
1588/1588 - 27s - 27s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1265584
{'0': {'precision': 0.34859880421180367, 'recall': 0.19677488405280058, 'f1-score': 0.25155408394561735, 'support': 140150}, '1': {'precision': 0.31208550472160124, 'recall': 0.6604666249990111, 'f1-score': 0.42387868725104155, 'support': 126397}, '2': {'precision': 0.4089911362075032, 'recall': 0.17467564531018542, 'f1-score': 0.2447999197673253, 'support': 139739}, 'accuracy': 0.3334301452671271, 'macro avg': {'precision': 0.356558481713636, 'recall': 0.3439723847873324, 'f1-score': 0.3067442303213281, 'support': 406286}, 'weighted avg': {'precision': 0.3580108749331279, 'recall': 0.3334301452671271, 'f1-score': 0.3028418288737846, 'support': 406286}}
[[27578 94969 17603]
 [25247 83481 17669]
 [26286 89044 24409]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1261548
{'0': {'precision': 0.3449755598499488, 'recall': 0.17259814306635765, 'f1-score': 0.2300817862185957, 'support': 140662}, '1': {'precision': 0.3073358489479066, 'recall': 0.6796751204363578, 'f1-score': 0.4232749921277804, 'support': 125585}, '2': {'precision': 0.4131286740692358, 'recall': 0.17163076000257071, 'f1-score': 0.24251199443034654, 'support': 140039}, 'accuracy': 0.32900469127658843, 'macro avg': {'precision': 0.3551466942890304, 'recall': 0.3413013411684287, 'f1-score': 0.2986229242589075, 'support': 406286}, 'weighted avg': {'precision': 0.35683201286216626, 'recall': 0.32900469127658843, 'f1-score': 0.2940832105646729, 'support': 406286}}
[[24278 99737 16647]
 [22732 85357 17496]
 [23366 92638 24035]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1270078
{'0': {'precision': 0.34140451428019447, 'recall': 0.14977998460245373, 'f1-score': 0.20821326002111, 'support': 141581}, '1': {'precision': 0.30187078688948077, 'recall': 0.6993594616890154, 'f1-score': 0.4217135695179016, 'support': 123646}, '2': {'precision': 0.4126483583123971, 'recall': 0.16883715324793172, 'f1-score': 0.23962892531216357, 'support': 141059}, 'accuracy': 0.32365131951384, 'macro avg': {'precision': 0.3519745531606908, 'recall': 0.33932553317980035, 'f1-score': 0.2898519182837251, 'support': 406286}, 'weighted avg': {'precision': 0.3541083685562126, 'recall': 0.32365131951384, 'f1-score': 0.2840955734612261, 'support': 406286}}
[[ 21206 103599  16776]
 [ 20050  86473  17123]
 [ 20858  96385  23816]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1288974
{'0': {'precision': 0.3378155571025538, 'recall': 0.12771940517665312, 'f1-score': 0.18535923403613702, 'support': 144379}, '1': {'precision': 0.29195700153371623, 'recall': 0.71605988573335, 'f1-score': 0.4147920531849103, 'support': 119895}, '2': {'precision': 0.4171885571535139, 'recall': 0.1693378024392305, 'f1-score': 0.24089554481480555, 'support': 142012}, 'accuracy': 0.31588585380741646, 'macro avg': {'precision': 0.3489870385965947, 'recall': 0.3377056977830779, 'f1-score': 0.28034894401195093, 'support': 406286}, 'weighted avg': {'precision': 0.35202649955026594, 'recall': 0.31588585380741646, 'f1-score': 0.27247685664223825, 'support': 406286}}
[[ 18440 108880  17059]
 [ 17507  85852  16536]
 [ 18639  99325  24048]]
Evaluating performance on  train set...
295/295 - 5s - 5s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1071777
{'0': {'precision': 0.38211095439586273, 'recall': 0.1248655707481948, 'f1-score': 0.18822371468272348, 'support': 26036}, '1': {'precision': 0.3374185136897001, 'recall': 0.6761525784798424, 'f1-score': 0.4501833168303584, 'support': 24879}, '2': {'precision': 0.4039820166987797, 'recall': 0.2815462868769074, 'f1-score': 0.3318306076447172, 'support': 24575}, 'accuracy': 0.35755729235660355, 'macro avg': {'precision': 0.3745038282614475, 'recall': 0.36085481203498154, 'f1-score': 0.32341254638593303, 'support': 75490}, 'weighted avg': {'precision': 0.3745017097775764, 'recall': 0.35755729235660355, 'f1-score': 0.3213066705228613, 'support': 75490}}
[[ 3251 18039  4746]
 [ 2595 16822  5462]
 [ 2662 14994  6919]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.107802
{'0': {'precision': 0.383896381359327, 'recall': 0.10979987778796212, 'f1-score': 0.1707599560478722, 'support': 26184}, '1': {'precision': 0.3346347780023151, 'recall': 0.6855305466237942, 'f1-score': 0.4497356590067107, 'support': 24880}, '2': {'precision': 0.3974870831376233, 'recall': 0.27716367804798164, 'f1-score': 0.32659559071831734, 'support': 24426}, 'accuracy': 0.3537024771492913, 'macro avg': {'precision': 0.3720060808330885, 'recall': 0.35749803415324594, 'f1-score': 0.31569706859096675, 'support': 75490}, 'weighted avg': {'precision': 0.372058227830571, 'recall': 0.3537024771492913, 'f1-score': 0.3131279081220038, 'support': 75490}}
[[ 2875 18608  4701]
 [ 2263 17056  5561]
 [ 2351 15305  6770]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1087486
{'0': {'precision': 0.38291846772991506, 'recall': 0.09782939832444783, 'f1-score': 0.15584336801237528, 'support': 26260}, '1': {'precision': 0.3316596500714534, 'recall': 0.6903565542468947, 'f1-score': 0.4480621975241003, 'support': 24877}, '2': {'precision': 0.38561091828931116, 'recall': 0.2691660165072065, 'f1-score': 0.3170342426001161, 'support': 24353}, 'accuracy': 0.34836402172473174, 'macro avg': {'precision': 0.3667296786968932, 'recall': 0.3524506563595164, 'f1-score': 0.30697993604553053, 'support': 75490}, 'weighted avg': {'precision': 0.3668952016229264, 'recall': 0.34836402172473174, 'f1-score': 0.30414127754474296, 'support': 75490}}
[[ 2569 18898  4793]
 [ 2052 17174  5651]
 [ 2088 15710  6555]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1114565
{'0': {'precision': 0.38330550918196993, 'recall': 0.08731698041452747, 'f1-score': 0.14223323524856746, 'support': 26295}, '1': {'precision': 0.32854718456228665, 'recall': 0.695711863038036, 'f1-score': 0.44632102475100055, 'support': 24766}, '2': {'precision': 0.3753297766312951, 'recall': 0.2620655777968808, 'f1-score': 0.30863423805621176, 'support': 24429}, 'accuracy': 0.343462710292754, 'macro avg': {'precision': 0.36239415679185055, 'recall': 0.34836480708314815, 'f1-score': 0.29906283268525996, 'support': 75490}, 'weighted avg': {'precision': 0.362759955625055, 'recall': 0.343462710292754, 'f1-score': 0.2958436246035178, 'support': 75490}}
[[ 2296 19110  4889]
 [ 1770 17230  5766]
 [ 1924 16103  6402]]
Evaluating performance on  val set...
131/131 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1035926
{'0': {'precision': 0.3440917107583774, 'recall': 0.17253272019808985, 'f1-score': 0.22982683472729415, 'support': 11308}, '1': {'precision': 0.3610001024695153, 'recall': 0.6116850421043494, 'f1-score': 0.45403872796984246, 'support': 11519}, '2': {'precision': 0.38782757776144994, 'recall': 0.300845445046072, 'f1-score': 0.33884341732199225, 'support': 10527}, 'accuracy': 0.3646938897883312, 'macro avg': {'precision': 0.3643064636631142, 'recall': 0.361687735782837, 'f1-score': 0.34090299333970964, 'support': 33354}, 'weighted avg': {'precision': 0.36373478913164425, 'recall': 0.3646938897883312, 'f1-score': 0.3416669247685276, 'support': 33354}}
[[1951 6785 2572]
 [2046 7046 2427]
 [1673 5687 3167]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1024029
{'0': {'precision': 0.3445076955513388, 'recall': 0.143459174714662, 'f1-score': 0.20256616872249425, 'support': 11390}, '1': {'precision': 0.3587548638132296, 'recall': 0.6507278341420379, 'f1-score': 0.46251763599310236, 'support': 11335}, '2': {'precision': 0.398211402310272, 'recall': 0.3016276225421018, 'f1-score': 0.343254817987152, 'support': 10629}, 'accuracy': 0.36625292318762365, 'macro avg': {'precision': 0.3671579872249468, 'recall': 0.3652715437996006, 'f1-score': 0.33611287423424957, 'support': 33354}, 'weighted avg': {'precision': 0.3664633335974272, 'recall': 0.36625292318762365, 'f1-score': 0.3357414860621354, 'support': 33354}}
[[1634 7239 2517]
 [1631 7376 2328]
 [1478 5945 3206]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.101663
{'0': {'precision': 0.35215120616761997, 'recall': 0.12472474235884788, 'f1-score': 0.18420710290100167, 'support': 11353}, '1': {'precision': 0.3609572970436415, 'recall': 0.6768147822261329, 'f1-score': 0.47081866870696254, 'support': 11365}, '2': {'precision': 0.39985043001371057, 'recall': 0.3016171493042497, 'f1-score': 0.3438555120853207, 'support': 10636}, 'accuracy': 0.3692510643401091, 'macro avg': {'precision': 0.37098631107499064, 'recall': 0.36771889129641017, 'f1-score': 0.33296042789776165, 'support': 33354}, 'weighted avg': {'precision': 0.3703622203678059, 'recall': 0.3692510643401091, 'f1-score': 0.33277581806167694, 'support': 33354}}
[[1416 7440 2497]
 [1355 7692 2318]
 [1250 6178 3208]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1018969
{'0': {'precision': 0.3446408209806157, 'recall': 0.10751445086705202, 'f1-score': 0.16389886802684198, 'support': 11245}, '1': {'precision': 0.36031498946982876, 'recall': 0.6820348383742092, 'f1-score': 0.4715257182229412, 'support': 11539}, '2': {'precision': 0.3853073463268366, 'recall': 0.29176915799432357, 'f1-score': 0.33207709701733606, 'support': 10570}, 'accuracy': 0.3646639083768064, 'macro avg': {'precision': 0.3634210522590937, 'recall': 0.3604394824118616, 'f1-score': 0.32250056108903974, 'support': 33354}, 'weighted avg': {'precision': 0.36295075091725254, 'recall': 0.3646639083768064, 'f1-score': 0.3236203438570966, 'support': 33354}}
[[1209 7580 2456]
 [1205 7870 2464]
 [1094 6392 3084]]
training model: results/CHTR/W10/deepOF_L2/seq2seq
Epoch 1/50
295/295 - 14s - loss: 13.1914 - accuracy10: 0.3713 - accuracy20: 0.3742 - accuracy30: 0.3742 - accuracy50: 0.3721 - val_loss: 13.3096 - val_accuracy10: 0.3736 - val_accuracy20: 0.3686 - val_accuracy30: 0.3633 - val_accuracy50: 0.3613 - 14s/epoch - 48ms/step
Epoch 2/50
295/295 - 9s - loss: 13.0504 - accuracy10: 0.3965 - accuracy20: 0.3995 - accuracy30: 0.3983 - accuracy50: 0.3930 - val_loss: 13.2177 - val_accuracy10: 0.3782 - val_accuracy20: 0.3722 - val_accuracy30: 0.3662 - val_accuracy50: 0.3648 - 9s/epoch - 31ms/step
Epoch 3/50
295/295 - 9s - loss: 12.9835 - accuracy10: 0.4070 - accuracy20: 0.4062 - accuracy30: 0.4059 - accuracy50: 0.4006 - val_loss: 13.0031 - val_accuracy10: 0.3930 - val_accuracy20: 0.3842 - val_accuracy30: 0.3755 - val_accuracy50: 0.3700 - 9s/epoch - 31ms/step
Epoch 4/50
295/295 - 9s - loss: 12.9319 - accuracy10: 0.4128 - accuracy20: 0.4129 - accuracy30: 0.4106 - accuracy50: 0.4022 - val_loss: 12.9223 - val_accuracy10: 0.4029 - val_accuracy20: 0.3962 - val_accuracy30: 0.3857 - val_accuracy50: 0.3790 - 9s/epoch - 30ms/step
Epoch 5/50
295/295 - 9s - loss: 12.8995 - accuracy10: 0.4165 - accuracy20: 0.4151 - accuracy30: 0.4130 - accuracy50: 0.4037 - val_loss: 12.8773 - val_accuracy10: 0.4146 - val_accuracy20: 0.4063 - val_accuracy30: 0.3964 - val_accuracy50: 0.3861 - 9s/epoch - 31ms/step
Epoch 6/50
295/295 - 9s - loss: 12.8531 - accuracy10: 0.4230 - accuracy20: 0.4201 - accuracy30: 0.4186 - accuracy50: 0.4065 - val_loss: 12.8546 - val_accuracy10: 0.4163 - val_accuracy20: 0.4077 - val_accuracy30: 0.3958 - val_accuracy50: 0.3878 - 9s/epoch - 31ms/step
Epoch 7/50
295/295 - 9s - loss: 12.8184 - accuracy10: 0.4282 - accuracy20: 0.4256 - accuracy30: 0.4225 - accuracy50: 0.4116 - val_loss: 12.8493 - val_accuracy10: 0.4212 - val_accuracy20: 0.4122 - val_accuracy30: 0.4006 - val_accuracy50: 0.3914 - 9s/epoch - 30ms/step
Epoch 8/50
295/295 - 10s - loss: 12.7825 - accuracy10: 0.4341 - accuracy20: 0.4309 - accuracy30: 0.4274 - accuracy50: 0.4163 - val_loss: 12.8718 - val_accuracy10: 0.4208 - val_accuracy20: 0.4113 - val_accuracy30: 0.3999 - val_accuracy50: 0.3903 - 10s/epoch - 33ms/step
Epoch 9/50
295/295 - 9s - loss: 12.7480 - accuracy10: 0.4382 - accuracy20: 0.4355 - accuracy30: 0.4327 - accuracy50: 0.4187 - val_loss: 12.8455 - val_accuracy10: 0.4200 - val_accuracy20: 0.4131 - val_accuracy30: 0.4028 - val_accuracy50: 0.3943 - 9s/epoch - 32ms/step
Epoch 10/50
295/295 - 9s - loss: 12.7088 - accuracy10: 0.4419 - accuracy20: 0.4409 - accuracy30: 0.4380 - accuracy50: 0.4239 - val_loss: 12.8959 - val_accuracy10: 0.4199 - val_accuracy20: 0.4116 - val_accuracy30: 0.4022 - val_accuracy50: 0.3905 - 9s/epoch - 31ms/step
Epoch 11/50
295/295 - 9s - loss: 12.6750 - accuracy10: 0.4478 - accuracy20: 0.4464 - accuracy30: 0.4428 - accuracy50: 0.4279 - val_loss: 12.8697 - val_accuracy10: 0.4298 - val_accuracy20: 0.4206 - val_accuracy30: 0.4096 - val_accuracy50: 0.3980 - 9s/epoch - 30ms/step
Epoch 12/50
295/295 - 9s - loss: 12.6448 - accuracy10: 0.4494 - accuracy20: 0.4483 - accuracy30: 0.4466 - accuracy50: 0.4301 - val_loss: 12.8939 - val_accuracy10: 0.4295 - val_accuracy20: 0.4216 - val_accuracy30: 0.4102 - val_accuracy50: 0.4007 - 9s/epoch - 31ms/step
Epoch 13/50
295/295 - 9s - loss: 12.5982 - accuracy10: 0.4545 - accuracy20: 0.4537 - accuracy30: 0.4513 - accuracy50: 0.4359 - val_loss: 12.9165 - val_accuracy10: 0.4283 - val_accuracy20: 0.4213 - val_accuracy30: 0.4111 - val_accuracy50: 0.3991 - 9s/epoch - 31ms/step
Epoch 14/50
295/295 - 9s - loss: 12.5677 - accuracy10: 0.4575 - accuracy20: 0.4594 - accuracy30: 0.4547 - accuracy50: 0.4387 - val_loss: 12.9616 - val_accuracy10: 0.4256 - val_accuracy20: 0.4222 - val_accuracy30: 0.4134 - val_accuracy50: 0.4011 - 9s/epoch - 30ms/step
Epoch 15/50
295/295 - 9s - loss: 12.5317 - accuracy10: 0.4622 - accuracy20: 0.4620 - accuracy30: 0.4582 - accuracy50: 0.4419 - val_loss: 12.9570 - val_accuracy10: 0.4326 - val_accuracy20: 0.4253 - val_accuracy30: 0.4171 - val_accuracy50: 0.4076 - 9s/epoch - 31ms/step
Epoch 16/50
295/295 - 9s - loss: 12.4933 - accuracy10: 0.4656 - accuracy20: 0.4670 - accuracy30: 0.4620 - accuracy50: 0.4480 - val_loss: 13.0033 - val_accuracy10: 0.4259 - val_accuracy20: 0.4226 - val_accuracy30: 0.4136 - val_accuracy50: 0.4062 - 9s/epoch - 31ms/step
Epoch 17/50
295/295 - 9s - loss: 12.4465 - accuracy10: 0.4687 - accuracy20: 0.4719 - accuracy30: 0.4688 - accuracy50: 0.4498 - val_loss: 12.9889 - val_accuracy10: 0.4295 - val_accuracy20: 0.4236 - val_accuracy30: 0.4163 - val_accuracy50: 0.4071 - 9s/epoch - 30ms/step
Epoch 18/50
295/295 - 9s - loss: 12.4136 - accuracy10: 0.4730 - accuracy20: 0.4767 - accuracy30: 0.4721 - accuracy50: 0.4549 - val_loss: 13.0147 - val_accuracy10: 0.4289 - val_accuracy20: 0.4241 - val_accuracy30: 0.4155 - val_accuracy50: 0.4084 - 9s/epoch - 30ms/step
Epoch 19/50
295/295 - 9s - loss: 12.3691 - accuracy10: 0.4744 - accuracy20: 0.4785 - accuracy30: 0.4766 - accuracy50: 0.4596 - val_loss: 13.0528 - val_accuracy10: 0.4300 - val_accuracy20: 0.4256 - val_accuracy30: 0.4160 - val_accuracy50: 0.4095 - 9s/epoch - 31ms/step
testing model: results/CHTR/W10/deepOF_L2/seq2seq
Evaluating performance on  test set...
1588/1588 - 17s - 17s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0889297
{'0': {'precision': 0.44706584650522985, 'recall': 0.122904031394934, 'f1-score': 0.19280385495777344, 'support': 140150}, '1': {'precision': 0.3654354759985925, 'recall': 0.5094308274126936, 'f1-score': 0.42558296319796957, 'support': 126394}, '2': {'precision': 0.41633690760829845, 'recall': 0.570722142310197, 'f1-score': 0.4814558801778497, 'support': 139737}, 'accuracy': 0.39717584627388436, 'macro avg': {'precision': 0.4096127433707069, 'recall': 0.40101900037260824, 'f1-score': 0.36661423277786426, 'support': 406281}, 'weighted avg': {'precision': 0.41110167691704724, 'recall': 0.39717584627388436, 'f1-score': 0.3645009086105141, 'support': 406281}}
[[17225 63857 59068]
 [ 9270 64389 52735]
 [12034 47952 79751]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.093471
{'0': {'precision': 0.44569811948743554, 'recall': 0.09520051755639446, 'f1-score': 0.1568896230946774, 'support': 140661}, '1': {'precision': 0.3459177960640984, 'recall': 0.5215196324343263, 'f1-score': 0.4159445187144549, 'support': 125583}, '2': {'precision': 0.4127885201870499, 'recall': 0.5509329677156751, 'f1-score': 0.47195960102649115, 'support': 140037}, 'accuracy': 0.38405930870505883, 'macro avg': {'precision': 0.40146814524619456, 'recall': 0.38921770590213195, 'f1-score': 0.34826458094520785, 'support': 406281}, 'weighted avg': {'precision': 0.4035123566442284, 'recall': 0.38405930870505883, 'f1-score': 0.3455628454611084, 'support': 406281}}
[[13391 70464 56806]
 [ 7144 65494 52945]
 [ 9510 53376 77151]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0974368
{'0': {'precision': 0.4465392672395366, 'recall': 0.07377558660243823, 'f1-score': 0.12662985166910146, 'support': 141578}, '1': {'precision': 0.330838205862732, 'recall': 0.5454810141938614, 'f1-score': 0.41187265082791613, 'support': 123645}, '2': {'precision': 0.413146693776323, 'recall': 0.5243516851224319, 'f1-score': 0.46215368465777734, 'support': 141058}, 'accuracy': 0.3737684016727339, 'macro avg': {'precision': 0.3968413889595305, 'recall': 0.38120276197291053, 'f1-score': 0.3335520623849317, 'support': 406281}, 'weighted avg': {'precision': 0.3997338607314573, 'recall': 0.3737684016727339, 'f1-score': 0.32993044100433566, 'support': 406281}}
[[10445 76868 54265]
 [ 5402 67446 50797]
 [ 7544 59550 73964]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1041424
{'0': {'precision': 0.4529791433295994, 'recall': 0.05881741804556064, 'f1-score': 0.10411583683778182, 'support': 144379}, '1': {'precision': 0.3100638525271533, 'recall': 0.5662168248619615, 'f1-score': 0.4007012241910541, 'support': 119894}, '2': {'precision': 0.41321059124988135, 'recall': 0.49056391189228776, 'f1-score': 0.44857694784288477, 'support': 142008}, 'accuracy': 0.3594605703933977, 'macro avg': {'precision': 0.39208452903554464, 'recall': 0.3718660515999366, 'f1-score': 0.31779800295724026, 'support': 406281}, 'weighted avg': {'precision': 0.3969043123155843, 'recall': 0.3594605703933977, 'f1-score': 0.31203853537142207, 'support': 406281}}
[[ 8492 84654 51233]
 [ 4313 67886 47695]
 [ 5942 66402 69664]]
Evaluating performance on  train set...
295/295 - 3s - 3s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.069361
{'0': {'precision': 0.4883137254901961, 'recall': 0.12003547466646101, 'f1-score': 0.192701723977839, 'support': 25934}, '1': {'precision': 0.3868870288929872, 'recall': 0.657174986947267, 'f1-score': 0.48704478145044866, 'support': 24899}, '2': {'precision': 0.4447965994257802, 'recall': 0.4838369499087406, 'f1-score': 0.46349613397054823, 'support': 24655}, 'accuracy': 0.41602638830012717, 'macro avg': {'precision': 0.4399991179363211, 'recall': 0.4203491371741562, 'f1-score': 0.38108087979961197, 'support': 75488}, 'weighted avg': {'precision': 0.4406460423923252, 'recall': 0.41602638830012717, 'f1-score': 0.378231662065757, 'support': 75488}}
[[ 3113 14959  7862]
 [ 1508 16363  7028]
 [ 1754 10972 11929]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0733242
{'0': {'precision': 0.4896273917421954, 'recall': 0.09324179196072414, 'f1-score': 0.15665173824789766, 'support': 26072}, '1': {'precision': 0.37397644419517667, 'recall': 0.668860089074349, 'f1-score': 0.4797260352815908, 'support': 24923}, '2': {'precision': 0.44045783875443195, 'recall': 0.4666231168088842, 'f1-score': 0.45316310144525285, 'support': 24493}, 'accuracy': 0.404435142009326, 'macro avg': {'precision': 0.434687224897268, 'recall': 0.40957499928131913, 'f1-score': 0.3631802916582471, 'support': 75488}, 'weighted avg': {'precision': 0.4354905961317191, 'recall': 0.404435142009326, 'f1-score': 0.35952416199423554, 'support': 75488}}
[[ 2431 16207  7434]
 [ 1168 16670  7085]
 [ 1366 11698 11429]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0769606
{'0': {'precision': 0.49587628865979383, 'recall': 0.07360648838899729, 'f1-score': 0.12818548252773243, 'support': 26139}, '1': {'precision': 0.36555095101477, 'recall': 0.6891978523920186, 'f1-score': 0.47771930068182133, 'support': 24958}, '2': {'precision': 0.43725817619028223, 'recall': 0.440162354966996, 'f1-score': 0.4387054593004249, 'support': 24391}, 'accuracy': 0.39557280627384483, 'macro avg': {'precision': 0.4328951386216153, 'recall': 0.4009888985826706, 'f1-score': 0.34820341416999295, 'support': 75488}, 'weighted avg': {'precision': 0.43384769923911287, 'recall': 0.39557280627384483, 'f1-score': 0.34408148966731084, 'support': 75488}}
[[ 1924 17235  6980]
 [  920 17201  6837]
 [ 1036 12619 10736]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0871657
{'0': {'precision': 0.4714975845410628, 'recall': 0.055856543304082414, 'f1-score': 0.09988060719768035, 'support': 26210}, '1': {'precision': 0.35401039244626864, 'recall': 0.7036530964915806, 'f1-score': 0.47103925102902805, 'support': 24883}, '2': {'precision': 0.42396614901413365, 'recall': 0.3984013117442099, 'f1-score': 0.4107863648851413, 'support': 24395}, 'accuracy': 0.3800869012293345, 'macro avg': {'precision': 0.4164913753338217, 'recall': 0.3859703171799576, 'f1-score': 0.32723540770394993, 'support': 75488}, 'weighted avg': {'precision': 0.4174100054480388, 'recall': 0.3800869012293345, 'f1-score': 0.3226986245413778, 'support': 75488}}
[[ 1464 18129  6617]
 [  786 17509  6588]
 [  855 13821  9719]]
Evaluating performance on  val set...
131/131 - 1s - 1s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0637999
{'0': {'precision': 0.467296511627907, 'recall': 0.11331394836549476, 'f1-score': 0.18239841146018013, 'support': 11349}, '1': {'precision': 0.41241166781786304, 'recall': 0.6771351304196109, 'f1-score': 0.5126139215427288, 'support': 11463}, '2': {'precision': 0.4211017740429505, 'recall': 0.47059381521532917, 'f1-score': 0.4444743090086459, 'support': 10542}, 'accuracy': 0.420009594051688, 'macro avg': {'precision': 0.4336033178295735, 'recall': 0.42034763133347824, 'f1-score': 0.3798288806705183, 'support': 33354}, 'weighted avg': {'precision': 0.43383336213413876, 'recall': 0.420009594051688, 'f1-score': 0.3787186280468618, 'support': 33354}}
[[1286 6324 3739]
 [ 620 7762 3081]
 [ 846 4735 4961]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0700237
{'0': {'precision': 0.4701834862385321, 'recall': 0.08999122036874452, 'f1-score': 0.15106853352984526, 'support': 11390}, '1': {'precision': 0.3993527835364312, 'recall': 0.6965340858982274, 'f1-score': 0.5076487980460214, 'support': 11339}, '2': {'precision': 0.42011055540931824, 'recall': 0.4506352941176471, 'f1-score': 0.4348378893833439, 'support': 10625}, 'accuracy': 0.4110751334172813, 'macro avg': {'precision': 0.42988227506142723, 'recall': 0.41238686679487296, 'f1-score': 0.36451840698640353, 'support': 33354}, 'weighted avg': {'precision': 0.43015307825149846, 'recall': 0.4110751334172813, 'f1-score': 0.3626867210123764, 'support': 33354}}
[[1025 6721 3644]
 [ 476 7898 2965]
 [ 679 5158 4788]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0763793
{'0': {'precision': 0.46945701357466063, 'recall': 0.0730312362516498, 'f1-score': 0.1263991471864768, 'support': 11365}, '1': {'precision': 0.3882301908617698, 'recall': 0.7074477428420868, 'f1-score': 0.5013381465114831, 'support': 11386}, '2': {'precision': 0.41354493448975826, 'recall': 0.42271055361690085, 'f1-score': 0.41807751504127605, 'support': 10603}, 'accuracy': 0.4007615278527313, 'macro avg': {'precision': 0.4237440463087296, 'recall': 0.4010631775702125, 'f1-score': 0.34860493624641203, 'support': 33354}, 'weighted avg': {'precision': 0.42395469367461275, 'recall': 0.4007615278527313, 'f1-score': 0.3471139394356511, 'support': 33354}}
[[ 830 7116 3419]
 [ 394 8055 2937]
 [ 544 5577 4482]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0828912
{'0': {'precision': 0.46092184368737477, 'recall': 0.061393362398789925, 'f1-score': 0.10835427135678392, 'support': 11239}, '1': {'precision': 0.3830864083923806, 'recall': 0.7212404712404712, 'f1-score': 0.500390648476471, 'support': 11544}, '2': {'precision': 0.4066976192828213, 'recall': 0.3894617349352001, 'f1-score': 0.39789310911375275, 'support': 10571}, 'accuracy': 0.39374587755591534, 'macro avg': {'precision': 0.4169019571208589, 'recall': 0.3906985228581537, 'f1-score': 0.33554600964900255, 'support': 33354}, 'weighted avg': {'precision': 0.4167971047887135, 'recall': 0.39374587755591534, 'f1-score': 0.3358047418070623, 'support': 33354}}
[[ 690 7393 3156]
 [ 368 8326 2850]
 [ 439 6015 4117]]
training model: results/CHTR/W10/deepVOL_L2/seq2seq
Epoch 1/50
295/295 - 15s - loss: 13.1605 - accuracy10: 0.3679 - accuracy20: 0.3727 - accuracy30: 0.3759 - accuracy50: 0.3745 - val_loss: 14.0615 - val_accuracy10: 0.3433 - val_accuracy20: 0.3386 - val_accuracy30: 0.3416 - val_accuracy50: 0.3481 - 15s/epoch - 50ms/step
Epoch 2/50
295/295 - 9s - loss: 13.1145 - accuracy10: 0.3692 - accuracy20: 0.3722 - accuracy30: 0.3729 - accuracy50: 0.3724 - val_loss: 14.1069 - val_accuracy10: 0.3453 - val_accuracy20: 0.3394 - val_accuracy30: 0.3397 - val_accuracy50: 0.3459 - 9s/epoch - 31ms/step
Epoch 3/50
295/295 - 9s - loss: 13.0871 - accuracy10: 0.3711 - accuracy20: 0.3748 - accuracy30: 0.3769 - accuracy50: 0.3749 - val_loss: 14.0059 - val_accuracy10: 0.3449 - val_accuracy20: 0.3395 - val_accuracy30: 0.3403 - val_accuracy50: 0.3456 - 9s/epoch - 31ms/step
Epoch 4/50
295/295 - 9s - loss: 13.1133 - accuracy10: 0.3717 - accuracy20: 0.3743 - accuracy30: 0.3743 - accuracy50: 0.3749 - val_loss: 14.2135 - val_accuracy10: 0.3461 - val_accuracy20: 0.3392 - val_accuracy30: 0.3400 - val_accuracy50: 0.3450 - 9s/epoch - 31ms/step
Epoch 5/50
295/295 - 9s - loss: 13.1013 - accuracy10: 0.3738 - accuracy20: 0.3779 - accuracy30: 0.3771 - accuracy50: 0.3741 - val_loss: 14.0235 - val_accuracy10: 0.3455 - val_accuracy20: 0.3400 - val_accuracy30: 0.3410 - val_accuracy50: 0.3477 - 9s/epoch - 30ms/step
Epoch 6/50
295/295 - 9s - loss: 13.1001 - accuracy10: 0.3733 - accuracy20: 0.3760 - accuracy30: 0.3744 - accuracy50: 0.3725 - val_loss: 13.5678 - val_accuracy10: 0.3455 - val_accuracy20: 0.3394 - val_accuracy30: 0.3411 - val_accuracy50: 0.3463 - 9s/epoch - 31ms/step
Epoch 7/50
295/295 - 9s - loss: 13.0983 - accuracy10: 0.3721 - accuracy20: 0.3729 - accuracy30: 0.3725 - accuracy50: 0.3709 - val_loss: 13.9837 - val_accuracy10: 0.3447 - val_accuracy20: 0.3397 - val_accuracy30: 0.3404 - val_accuracy50: 0.3450 - 9s/epoch - 29ms/step
Epoch 8/50
295/295 - 9s - loss: 13.0791 - accuracy10: 0.3779 - accuracy20: 0.3810 - accuracy30: 0.3801 - accuracy50: 0.3754 - val_loss: 13.8184 - val_accuracy10: 0.3474 - val_accuracy20: 0.3416 - val_accuracy30: 0.3430 - val_accuracy50: 0.3477 - 9s/epoch - 30ms/step
Epoch 9/50
295/295 - 9s - loss: 13.0622 - accuracy10: 0.3826 - accuracy20: 0.3822 - accuracy30: 0.3794 - accuracy50: 0.3765 - val_loss: 13.9038 - val_accuracy10: 0.3460 - val_accuracy20: 0.3409 - val_accuracy30: 0.3415 - val_accuracy50: 0.3476 - 9s/epoch - 29ms/step
Epoch 10/50
295/295 - 9s - loss: 13.0731 - accuracy10: 0.3800 - accuracy20: 0.3829 - accuracy30: 0.3792 - accuracy50: 0.3775 - val_loss: 13.5281 - val_accuracy10: 0.3489 - val_accuracy20: 0.3442 - val_accuracy30: 0.3461 - val_accuracy50: 0.3506 - 9s/epoch - 30ms/step
Epoch 11/50
295/295 - 9s - loss: 13.0611 - accuracy10: 0.3811 - accuracy20: 0.3822 - accuracy30: 0.3797 - accuracy50: 0.3775 - val_loss: 14.0328 - val_accuracy10: 0.3454 - val_accuracy20: 0.3399 - val_accuracy30: 0.3408 - val_accuracy50: 0.3459 - 9s/epoch - 31ms/step
Epoch 12/50
295/295 - 9s - loss: 13.0576 - accuracy10: 0.3770 - accuracy20: 0.3792 - accuracy30: 0.3812 - accuracy50: 0.3788 - val_loss: 14.1854 - val_accuracy10: 0.3457 - val_accuracy20: 0.3400 - val_accuracy30: 0.3408 - val_accuracy50: 0.3463 - 9s/epoch - 31ms/step
Epoch 13/50
295/295 - 9s - loss: 13.0567 - accuracy10: 0.3790 - accuracy20: 0.3814 - accuracy30: 0.3788 - accuracy50: 0.3764 - val_loss: 13.8397 - val_accuracy10: 0.3484 - val_accuracy20: 0.3433 - val_accuracy30: 0.3440 - val_accuracy50: 0.3484 - 9s/epoch - 32ms/step
Epoch 14/50
295/295 - 9s - loss: 13.0598 - accuracy10: 0.3849 - accuracy20: 0.3845 - accuracy30: 0.3844 - accuracy50: 0.3788 - val_loss: 14.1461 - val_accuracy10: 0.3459 - val_accuracy20: 0.3405 - val_accuracy30: 0.3411 - val_accuracy50: 0.3462 - 9s/epoch - 31ms/step
Epoch 15/50
295/295 - 9s - loss: 13.0497 - accuracy10: 0.3850 - accuracy20: 0.3861 - accuracy30: 0.3820 - accuracy50: 0.3774 - val_loss: 13.4412 - val_accuracy10: 0.3576 - val_accuracy20: 0.3524 - val_accuracy30: 0.3514 - val_accuracy50: 0.3560 - 9s/epoch - 30ms/step
Epoch 16/50
295/295 - 9s - loss: 13.0695 - accuracy10: 0.3847 - accuracy20: 0.3830 - accuracy30: 0.3786 - accuracy50: 0.3765 - val_loss: 13.2701 - val_accuracy10: 0.3583 - val_accuracy20: 0.3525 - val_accuracy30: 0.3504 - val_accuracy50: 0.3532 - 9s/epoch - 32ms/step
Epoch 17/50
295/295 - 9s - loss: 13.0702 - accuracy10: 0.3848 - accuracy20: 0.3848 - accuracy30: 0.3803 - accuracy50: 0.3751 - val_loss: 13.0945 - val_accuracy10: 0.3797 - val_accuracy20: 0.3769 - val_accuracy30: 0.3737 - val_accuracy50: 0.3747 - 9s/epoch - 30ms/step
Epoch 18/50
295/295 - 9s - loss: 13.0575 - accuracy10: 0.3869 - accuracy20: 0.3881 - accuracy30: 0.3842 - accuracy50: 0.3798 - val_loss: 13.0446 - val_accuracy10: 0.3852 - val_accuracy20: 0.3819 - val_accuracy30: 0.3783 - val_accuracy50: 0.3766 - 9s/epoch - 30ms/step
Epoch 19/50
295/295 - 9s - loss: 13.0334 - accuracy10: 0.3899 - accuracy20: 0.3905 - accuracy30: 0.3865 - accuracy50: 0.3780 - val_loss: 13.1192 - val_accuracy10: 0.3825 - val_accuracy20: 0.3763 - val_accuracy30: 0.3706 - val_accuracy50: 0.3701 - 9s/epoch - 29ms/step
Epoch 20/50
295/295 - 9s - loss: 13.0332 - accuracy10: 0.3931 - accuracy20: 0.3934 - accuracy30: 0.3870 - accuracy50: 0.3799 - val_loss: 13.0382 - val_accuracy10: 0.3895 - val_accuracy20: 0.3857 - val_accuracy30: 0.3806 - val_accuracy50: 0.3794 - 9s/epoch - 29ms/step
Epoch 21/50
295/295 - 9s - loss: 13.0019 - accuracy10: 0.3963 - accuracy20: 0.3958 - accuracy30: 0.3907 - accuracy50: 0.3835 - val_loss: 13.4655 - val_accuracy10: 0.3592 - val_accuracy20: 0.3513 - val_accuracy30: 0.3488 - val_accuracy50: 0.3510 - 9s/epoch - 30ms/step
Epoch 22/50
295/295 - 9s - loss: 13.0206 - accuracy10: 0.3942 - accuracy20: 0.3937 - accuracy30: 0.3879 - accuracy50: 0.3831 - val_loss: 13.0838 - val_accuracy10: 0.3868 - val_accuracy20: 0.3779 - val_accuracy30: 0.3695 - val_accuracy50: 0.3683 - 9s/epoch - 30ms/step
Epoch 23/50
295/295 - 9s - loss: 13.0054 - accuracy10: 0.3970 - accuracy20: 0.3977 - accuracy30: 0.3919 - accuracy50: 0.3858 - val_loss: 13.0052 - val_accuracy10: 0.3913 - val_accuracy20: 0.3862 - val_accuracy30: 0.3779 - val_accuracy50: 0.3786 - 9s/epoch - 31ms/step
Epoch 24/50
295/295 - 9s - loss: 12.9979 - accuracy10: 0.3984 - accuracy20: 0.3982 - accuracy30: 0.3930 - accuracy50: 0.3867 - val_loss: 13.0505 - val_accuracy10: 0.3902 - val_accuracy20: 0.3841 - val_accuracy30: 0.3780 - val_accuracy50: 0.3760 - 9s/epoch - 30ms/step
Epoch 25/50
295/295 - 9s - loss: 12.9761 - accuracy10: 0.4009 - accuracy20: 0.4021 - accuracy30: 0.3981 - accuracy50: 0.3893 - val_loss: 13.0804 - val_accuracy10: 0.3887 - val_accuracy20: 0.3814 - val_accuracy30: 0.3712 - val_accuracy50: 0.3693 - 9s/epoch - 30ms/step
Epoch 26/50
295/295 - 9s - loss: 12.9843 - accuracy10: 0.4012 - accuracy20: 0.4000 - accuracy30: 0.3958 - accuracy50: 0.3868 - val_loss: 12.9860 - val_accuracy10: 0.3997 - val_accuracy20: 0.3931 - val_accuracy30: 0.3854 - val_accuracy50: 0.3837 - 9s/epoch - 32ms/step
Epoch 27/50
295/295 - 9s - loss: 12.9560 - accuracy10: 0.4041 - accuracy20: 0.4054 - accuracy30: 0.4003 - accuracy50: 0.3929 - val_loss: 13.0082 - val_accuracy10: 0.3899 - val_accuracy20: 0.3845 - val_accuracy30: 0.3798 - val_accuracy50: 0.3812 - 9s/epoch - 30ms/step
Epoch 28/50
295/295 - 9s - loss: 12.9481 - accuracy10: 0.4052 - accuracy20: 0.4062 - accuracy30: 0.4019 - accuracy50: 0.3927 - val_loss: 13.0752 - val_accuracy10: 0.3910 - val_accuracy20: 0.3835 - val_accuracy30: 0.3749 - val_accuracy50: 0.3757 - 9s/epoch - 30ms/step
Epoch 29/50
295/295 - 9s - loss: 12.9476 - accuracy10: 0.4057 - accuracy20: 0.4070 - accuracy30: 0.4027 - accuracy50: 0.3933 - val_loss: 12.9747 - val_accuracy10: 0.3974 - val_accuracy20: 0.3924 - val_accuracy30: 0.3873 - val_accuracy50: 0.3856 - 9s/epoch - 29ms/step
Epoch 30/50
295/295 - 9s - loss: 12.9185 - accuracy10: 0.4089 - accuracy20: 0.4114 - accuracy30: 0.4053 - accuracy50: 0.3977 - val_loss: 13.0268 - val_accuracy10: 0.3944 - val_accuracy20: 0.3868 - val_accuracy30: 0.3785 - val_accuracy50: 0.3788 - 9s/epoch - 29ms/step
Epoch 31/50
295/295 - 9s - loss: 12.9215 - accuracy10: 0.4086 - accuracy20: 0.4105 - accuracy30: 0.4061 - accuracy50: 0.3964 - val_loss: 12.9780 - val_accuracy10: 0.3964 - val_accuracy20: 0.3916 - val_accuracy30: 0.3871 - val_accuracy50: 0.3859 - 9s/epoch - 30ms/step
Epoch 32/50
295/295 - 9s - loss: 12.8993 - accuracy10: 0.4122 - accuracy20: 0.4134 - accuracy30: 0.4096 - accuracy50: 0.4012 - val_loss: 13.0048 - val_accuracy10: 0.3977 - val_accuracy20: 0.3946 - val_accuracy30: 0.3869 - val_accuracy50: 0.3864 - 9s/epoch - 30ms/step
Epoch 33/50
295/295 - 9s - loss: 12.8920 - accuracy10: 0.4133 - accuracy20: 0.4153 - accuracy30: 0.4106 - accuracy50: 0.4010 - val_loss: 13.0485 - val_accuracy10: 0.3915 - val_accuracy20: 0.3865 - val_accuracy30: 0.3801 - val_accuracy50: 0.3808 - 9s/epoch - 30ms/step
Epoch 34/50
295/295 - 9s - loss: 12.8763 - accuracy10: 0.4159 - accuracy20: 0.4179 - accuracy30: 0.4125 - accuracy50: 0.4044 - val_loss: 13.0781 - val_accuracy10: 0.3944 - val_accuracy20: 0.3889 - val_accuracy30: 0.3823 - val_accuracy50: 0.3835 - 9s/epoch - 30ms/step
Epoch 35/50
295/295 - 9s - loss: 12.8820 - accuracy10: 0.4143 - accuracy20: 0.4149 - accuracy30: 0.4106 - accuracy50: 0.4023 - val_loss: 13.0982 - val_accuracy10: 0.3909 - val_accuracy20: 0.3874 - val_accuracy30: 0.3775 - val_accuracy50: 0.3785 - 9s/epoch - 29ms/step
Epoch 36/50
295/295 - 9s - loss: 12.8883 - accuracy10: 0.4145 - accuracy20: 0.4156 - accuracy30: 0.4107 - accuracy50: 0.4016 - val_loss: 12.9807 - val_accuracy10: 0.3948 - val_accuracy20: 0.3911 - val_accuracy30: 0.3855 - val_accuracy50: 0.3857 - 9s/epoch - 30ms/step
Epoch 37/50
295/295 - 9s - loss: 12.8688 - accuracy10: 0.4154 - accuracy20: 0.4186 - accuracy30: 0.4138 - accuracy50: 0.4032 - val_loss: 13.0091 - val_accuracy10: 0.3955 - val_accuracy20: 0.3893 - val_accuracy30: 0.3827 - val_accuracy50: 0.3822 - 9s/epoch - 31ms/step
Epoch 38/50
295/295 - 9s - loss: 12.8551 - accuracy10: 0.4161 - accuracy20: 0.4167 - accuracy30: 0.4140 - accuracy50: 0.4022 - val_loss: 13.0107 - val_accuracy10: 0.3976 - val_accuracy20: 0.3914 - val_accuracy30: 0.3854 - val_accuracy50: 0.3844 - 9s/epoch - 30ms/step
Epoch 39/50
295/295 - 9s - loss: 12.8402 - accuracy10: 0.4167 - accuracy20: 0.4197 - accuracy30: 0.4161 - accuracy50: 0.4059 - val_loss: 13.0800 - val_accuracy10: 0.3885 - val_accuracy20: 0.3827 - val_accuracy30: 0.3780 - val_accuracy50: 0.3775 - 9s/epoch - 31ms/step
testing model: results/CHTR/W10/deepVOL_L2/seq2seq
Evaluating performance on  test set...
1588/1588 - 15s - 15s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0969945
{'0': {'precision': 0.42163464329250594, 'recall': 0.10365322868355334, 'f1-score': 0.16639939520285904, 'support': 140150}, '1': {'precision': 0.34698764937941606, 'recall': 0.8092992713434655, 'f1-score': 0.485721747388414, 'support': 126397}, '2': {'precision': 0.4185177011255501, 'recall': 0.23070152212338718, 'f1-score': 0.2974424269264836, 'support': 139739}, 'accuracy': 0.36687948883298954, 'macro avg': {'precision': 0.39571333126582403, 'recall': 0.3812180073834686, 'f1-score': 0.3165211898392522, 'support': 406286}, 'weighted avg': {'precision': 0.39733965288894524, 'recall': 0.36687948883298954, 'f1-score': 0.3108129599312158, 'support': 406286}}
[[ 14527  97259  28364]
 [  7677 102293  16427]
 [ 12250  95251  32238]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0997971
{'0': {'precision': 0.4129868158007946, 'recall': 0.11602280644381567, 'f1-score': 0.18115318655337195, 'support': 140662}, '1': {'precision': 0.34076489189536907, 'recall': 0.801441254926942, 'f1-score': 0.478202719107156, 'support': 125585}, '2': {'precision': 0.41476325850406826, 'recall': 0.2114910846264255, 'f1-score': 0.28013771837726886, 'support': 140039}, 'accuracy': 0.3607951049260866, 'macro avg': {'precision': 0.3895049887334106, 'recall': 0.37631838199906104, 'f1-score': 0.31316454134593225, 'support': 406286}, 'weighted avg': {'precision': 0.39127496982544935, 'recall': 0.3607951049260866, 'f1-score': 0.3070907290673982, 'support': 406286}}
[[ 16320  98447  25895]
 [  9041 100649  15895]
 [ 14156  96266  29617]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1031684
{'0': {'precision': 0.4036522394344348, 'recall': 0.1286472054866119, 'f1-score': 0.1951109778044391, 'support': 141581}, '1': {'precision': 0.33097952859203433, 'recall': 0.7998560406321272, 'f1-score': 0.46821303198225606, 'support': 123646}, '2': {'precision': 0.414843800115466, 'recall': 0.18338425765105382, 'f1-score': 0.25433719243910236, 'support': 141059}, 'accuracy': 0.351922045061853, 'macro avg': {'precision': 0.3831585227139784, 'recall': 0.3706291679232643, 'f1-score': 0.30588706740859917, 'support': 406286}, 'weighted avg': {'precision': 0.3854211912400253, 'recall': 0.351922045061853, 'f1-score': 0.29878761741550447, 'support': 406286}}
[[ 18214 101092  22275]
 [ 10534  98899  14213]
 [ 16375  98816  25868]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1087832
{'0': {'precision': 0.3920250896057348, 'recall': 0.1393900775043462, 'f1-score': 0.20565618373655573, 'support': 144379}, '1': {'precision': 0.3142407973185418, 'recall': 0.7952458401100964, 'f1-score': 0.45047624447216233, 'support': 119895}, '2': {'precision': 0.40042302990316886, 'recall': 0.1453046221446075, 'f1-score': 0.213232064894469, 'support': 142012}, 'accuracy': 0.3350004676508666, 'macro avg': {'precision': 0.3688963056091485, 'recall': 0.35998017991968334, 'f1-score': 0.28978816436772903, 'support': 406286}, 'weighted avg': {'precision': 0.3720063357568357, 'recall': 0.3350004676508666, 'f1-score': 0.28055063546980064, 'support': 406286}}
[[ 20125 105735  18519]
 [ 12170  95346  12379]
 [ 19041 102336  20635]]
Evaluating performance on  train set...
295/295 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0863419
{'0': {'precision': 0.4564328919404937, 'recall': 0.10723613458288524, 'f1-score': 0.1736696420240724, 'support': 26036}, '1': {'precision': 0.3702622330359557, 'recall': 0.8257566622452671, 'f1-score': 0.5112737046438705, 'support': 24879}, '2': {'precision': 0.4339717741935484, 'recall': 0.24524923702950152, 'f1-score': 0.3133920911005382, 'support': 24575}, 'accuracy': 0.38896542588422306, 'macro avg': {'precision': 0.4202222997233325, 'recall': 0.392747344619218, 'f1-score': 0.33277847925616033, 'support': 75490}, 'weighted avg': {'precision': 0.4207219131152561, 'recall': 0.38896542588422306, 'f1-score': 0.33041796180115685, 'support': 75490}}
[[ 2792 18339  4905]
 [ 1379 20544  2956]
 [ 1946 16602  6027]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0865543
{'0': {'precision': 0.46174824171092294, 'recall': 0.12286128933699969, 'f1-score': 0.19408162649693822, 'support': 26184}, '1': {'precision': 0.3681131330533721, 'recall': 0.8244372990353698, 'f1-score': 0.5089700007443984, 'support': 24880}, '2': {'precision': 0.42879462541988905, 'recall': 0.2247195611233931, 'f1-score': 0.2948934912832084, 'support': 24426}, 'accuracy': 0.38704464167439395, 'macro avg': {'precision': 0.41955200006139476, 'recall': 0.39067271649858754, 'f1-score': 0.332648372841515, 'support': 75490}, 'weighted avg': {'precision': 0.4202253044354606, 'recall': 0.38704464167439395, 'f1-score': 0.3304818564684079, 'support': 75490}}
[[ 3217 18515  4452]
 [ 1508 20512  2860]
 [ 2242 16695  5489]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0890954
{'0': {'precision': 0.45975134999372097, 'recall': 0.1394135567402894, 'f1-score': 0.21394968296175088, 'support': 26260}, '1': {'precision': 0.36296887470071826, 'recall': 0.82268762310568, 'f1-score': 0.503704068322217, 'support': 24877}, '2': {'precision': 0.42712259917429546, 'recall': 0.19541740237342423, 'f1-score': 0.2681504437244682, 'support': 24353}, 'accuracy': 0.38264670817326796, 'macro avg': {'precision': 0.41661427462291156, 'recall': 0.38583952740646454, 'f1-score': 0.3286013983361454, 'support': 75490}, 'weighted avg': {'precision': 0.4173316174918068, 'recall': 0.38264670817326796, 'f1-score': 0.32692055289772615, 'support': 75490}}
[[ 3661 18838  3761]
 [ 1789 20466  2622]
 [ 2513 17081  4759]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0937151
{'0': {'precision': 0.4358288770053476, 'recall': 0.14877353108956076, 'f1-score': 0.22182529556859742, 'support': 26295}, '1': {'precision': 0.3545038061560437, 'recall': 0.8217314059597836, 'f1-score': 0.49532084748031596, 'support': 24766}, '2': {'precision': 0.4104534973097617, 'recall': 0.1530148593884318, 'f1-score': 0.2229246183206107, 'support': 24429}, 'accuracy': 0.37092330109948335, 'macro avg': {'precision': 0.400262060157051, 'recall': 0.374506598812592, 'f1-score': 0.31335692045650804, 'support': 75490}, 'weighted avg': {'precision': 0.4009369462166693, 'recall': 0.37092330109948335, 'f1-score': 0.31190671289744304, 'support': 75490}}
[[ 3912 19238  3145]
 [ 2191 20351  2224]
 [ 2873 17818  3738]]
Evaluating performance on  val set...
131/131 - 1s - 1s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0785533
{'0': {'precision': 0.4444048467569494, 'recall': 0.11027591085956845, 'f1-score': 0.17670398186198102, 'support': 11308}, '1': {'precision': 0.3872003953545836, 'recall': 0.8162166854761698, 'f1-score': 0.5252367252311387, 'support': 11519}, '2': {'precision': 0.4000957548675391, 'recall': 0.23814952028118172, 'f1-score': 0.29857678794735903, 'support': 10527}, 'accuracy': 0.394435450020987, 'macro avg': {'precision': 0.41056699899302407, 'recall': 0.3882140388723066, 'f1-score': 0.33350583168015957, 'support': 33354}, 'weighted avg': {'precision': 0.41066436927227973, 'recall': 0.394435450020987, 'f1-score': 0.33553661664431905, 'support': 33354}}
[[1247 7771 2290]
 [ 648 9402 1469]
 [ 911 7109 2507]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0812125
{'0': {'precision': 0.43698281349458945, 'recall': 0.12054433713784021, 'f1-score': 0.1889622901183595, 'support': 11390}, '1': {'precision': 0.38010904767761244, 'recall': 0.8179973533303926, 'f1-score': 0.5190326914464845, 'support': 11335}, '2': {'precision': 0.39972503866643755, 'recall': 0.2188352620190046, 'f1-score': 0.28283073929961094, 'support': 10629}, 'accuracy': 0.3888888888888889, 'macro avg': {'precision': 0.4056056332795465, 'recall': 0.3857923174957458, 'f1-score': 0.33027524028815164, 'support': 33354}, 'weighted avg': {'precision': 0.40578184736807205, 'recall': 0.3888888888888889, 'f1-score': 0.3310464702887084, 'support': 33354}}
[[1373 7866 2151]
 [ 721 9272 1342]
 [1048 7255 2326]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0846547
{'0': {'precision': 0.43287292817679557, 'recall': 0.13802519157931825, 'f1-score': 0.2093100914980298, 'support': 11353}, '1': {'precision': 0.3763872012960713, 'recall': 0.8176858776946766, 'f1-score': 0.5154902232700042, 'support': 11365}, '2': {'precision': 0.3893735130848533, 'recall': 0.184655885671305, 'f1-score': 0.2505102040816326, 'support': 10636}, 'accuracy': 0.38448162139473524, 'macro avg': {'precision': 0.39954454751924007, 'recall': 0.38012231831509996, 'f1-score': 0.3251035062832222, 'support': 33354}, 'weighted avg': {'precision': 0.3997548594318976, 'recall': 0.38448162139473524, 'f1-score': 0.32677551078890005, 'support': 33354}}
[[1567 7933 1853]
 [ 845 9293 1227]
 [1208 7464 1964]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.085949
{'0': {'precision': 0.4179985247110893, 'recall': 0.1511783014673188, 'f1-score': 0.22204806687565312, 'support': 11245}, '1': {'precision': 0.37878064310729065, 'recall': 0.8248548401074617, 'f1-score': 0.5191589167371204, 'support': 11539}, '2': {'precision': 0.38855494109160854, 'recall': 0.15288552507095554, 'f1-score': 0.21943105438251073, 'support': 10570}, 'accuracy': 0.3847814355099838, 'macro avg': {'precision': 0.3951113696366628, 'recall': 0.37630622221524535, 'f1-score': 0.32021267933176145, 'support': 33354}, 'weighted avg': {'precision': 0.3951001072893664, 'recall': 0.3847814355099838, 'f1-score': 0.3240058612780923, 'support': 33354}}
[[1700 8057 1488]
 [ 966 9518 1055]
 [1401 7553 1616]]
training model: results/CHTR/W10/deepVOL_L3/seq2seq
Epoch 1/50
295/295 - 19s - loss: 13.1695 - accuracy10: 0.3655 - accuracy20: 0.3676 - accuracy30: 0.3708 - accuracy50: 0.3687 - val_loss: 14.1427 - val_accuracy10: 0.3457 - val_accuracy20: 0.3401 - val_accuracy30: 0.3409 - val_accuracy50: 0.3463 - 19s/epoch - 65ms/step
Epoch 2/50
295/295 - 13s - loss: 13.1194 - accuracy10: 0.3653 - accuracy20: 0.3681 - accuracy30: 0.3707 - accuracy50: 0.3710 - val_loss: 13.8564 - val_accuracy10: 0.3458 - val_accuracy20: 0.3406 - val_accuracy30: 0.3415 - val_accuracy50: 0.3462 - 13s/epoch - 45ms/step
Epoch 3/50
295/295 - 13s - loss: 13.0981 - accuracy10: 0.3673 - accuracy20: 0.3690 - accuracy30: 0.3715 - accuracy50: 0.3708 - val_loss: 14.1174 - val_accuracy10: 0.3455 - val_accuracy20: 0.3401 - val_accuracy30: 0.3409 - val_accuracy50: 0.3464 - 13s/epoch - 45ms/step
Epoch 4/50
295/295 - 13s - loss: 13.1237 - accuracy10: 0.3685 - accuracy20: 0.3726 - accuracy30: 0.3714 - accuracy50: 0.3706 - val_loss: 13.9347 - val_accuracy10: 0.3452 - val_accuracy20: 0.3398 - val_accuracy30: 0.3407 - val_accuracy50: 0.3460 - 13s/epoch - 45ms/step
Epoch 5/50
295/295 - 13s - loss: 13.1008 - accuracy10: 0.3678 - accuracy20: 0.3724 - accuracy30: 0.3745 - accuracy50: 0.3737 - val_loss: 14.0440 - val_accuracy10: 0.3454 - val_accuracy20: 0.3398 - val_accuracy30: 0.3407 - val_accuracy50: 0.3460 - 13s/epoch - 45ms/step
Epoch 6/50
295/295 - 13s - loss: 13.1095 - accuracy10: 0.3678 - accuracy20: 0.3706 - accuracy30: 0.3697 - accuracy50: 0.3681 - val_loss: 13.9007 - val_accuracy10: 0.3454 - val_accuracy20: 0.3399 - val_accuracy30: 0.3408 - val_accuracy50: 0.3460 - 13s/epoch - 44ms/step
Epoch 7/50
295/295 - 13s - loss: 13.1342 - accuracy10: 0.3663 - accuracy20: 0.3677 - accuracy30: 0.3685 - accuracy50: 0.3672 - val_loss: 13.3195 - val_accuracy10: 0.3468 - val_accuracy20: 0.3408 - val_accuracy30: 0.3411 - val_accuracy50: 0.3465 - 13s/epoch - 44ms/step
Epoch 8/50
295/295 - 13s - loss: 13.0992 - accuracy10: 0.3700 - accuracy20: 0.3729 - accuracy30: 0.3726 - accuracy50: 0.3705 - val_loss: 13.6643 - val_accuracy10: 0.3455 - val_accuracy20: 0.3410 - val_accuracy30: 0.3424 - val_accuracy50: 0.3478 - 13s/epoch - 44ms/step
Epoch 9/50
295/295 - 13s - loss: 13.1326 - accuracy10: 0.3655 - accuracy20: 0.3685 - accuracy30: 0.3690 - accuracy50: 0.3687 - val_loss: 13.1737 - val_accuracy10: 0.3715 - val_accuracy20: 0.3690 - val_accuracy30: 0.3657 - val_accuracy50: 0.3628 - 13s/epoch - 44ms/step
Epoch 10/50
295/295 - 13s - loss: 13.1274 - accuracy10: 0.3684 - accuracy20: 0.3679 - accuracy30: 0.3665 - accuracy50: 0.3646 - val_loss: 13.1931 - val_accuracy10: 0.3529 - val_accuracy20: 0.3430 - val_accuracy30: 0.3412 - val_accuracy50: 0.3466 - 13s/epoch - 45ms/step
Epoch 11/50
295/295 - 13s - loss: 13.0832 - accuracy10: 0.3736 - accuracy20: 0.3750 - accuracy30: 0.3740 - accuracy50: 0.3694 - val_loss: 13.4655 - val_accuracy10: 0.3476 - val_accuracy20: 0.3410 - val_accuracy30: 0.3407 - val_accuracy50: 0.3457 - 13s/epoch - 44ms/step
Epoch 12/50
295/295 - 14s - loss: 13.0960 - accuracy10: 0.3711 - accuracy20: 0.3719 - accuracy30: 0.3708 - accuracy50: 0.3682 - val_loss: 13.3010 - val_accuracy10: 0.3562 - val_accuracy20: 0.3431 - val_accuracy30: 0.3418 - val_accuracy50: 0.3462 - 14s/epoch - 46ms/step
Epoch 13/50
295/295 - 13s - loss: 13.1197 - accuracy10: 0.3689 - accuracy20: 0.3720 - accuracy30: 0.3702 - accuracy50: 0.3666 - val_loss: 13.0860 - val_accuracy10: 0.3838 - val_accuracy20: 0.3843 - val_accuracy30: 0.3823 - val_accuracy50: 0.3821 - 13s/epoch - 45ms/step
Epoch 14/50
295/295 - 13s - loss: 13.1003 - accuracy10: 0.3772 - accuracy20: 0.3767 - accuracy30: 0.3724 - accuracy50: 0.3670 - val_loss: 13.0791 - val_accuracy10: 0.3821 - val_accuracy20: 0.3822 - val_accuracy30: 0.3793 - val_accuracy50: 0.3794 - 13s/epoch - 45ms/step
Epoch 15/50
295/295 - 13s - loss: 13.0854 - accuracy10: 0.3793 - accuracy20: 0.3805 - accuracy30: 0.3785 - accuracy50: 0.3742 - val_loss: 13.0930 - val_accuracy10: 0.3781 - val_accuracy20: 0.3803 - val_accuracy30: 0.3770 - val_accuracy50: 0.3770 - 13s/epoch - 44ms/step
Epoch 16/50
295/295 - 13s - loss: 13.0873 - accuracy10: 0.3767 - accuracy20: 0.3778 - accuracy30: 0.3764 - accuracy50: 0.3746 - val_loss: 13.0922 - val_accuracy10: 0.3811 - val_accuracy20: 0.3770 - val_accuracy30: 0.3767 - val_accuracy50: 0.3778 - 13s/epoch - 45ms/step
Epoch 17/50
295/295 - 13s - loss: 13.0761 - accuracy10: 0.3782 - accuracy20: 0.3797 - accuracy30: 0.3777 - accuracy50: 0.3722 - val_loss: 13.0787 - val_accuracy10: 0.3834 - val_accuracy20: 0.3823 - val_accuracy30: 0.3803 - val_accuracy50: 0.3836 - 13s/epoch - 44ms/step
Epoch 18/50
295/295 - 13s - loss: 13.0508 - accuracy10: 0.3808 - accuracy20: 0.3820 - accuracy30: 0.3796 - accuracy50: 0.3750 - val_loss: 13.3593 - val_accuracy10: 0.3486 - val_accuracy20: 0.3440 - val_accuracy30: 0.3444 - val_accuracy50: 0.3493 - 13s/epoch - 44ms/step
Epoch 19/50
295/295 - 13s - loss: 13.0713 - accuracy10: 0.3762 - accuracy20: 0.3786 - accuracy30: 0.3764 - accuracy50: 0.3736 - val_loss: 13.1258 - val_accuracy10: 0.3709 - val_accuracy20: 0.3668 - val_accuracy30: 0.3660 - val_accuracy50: 0.3692 - 13s/epoch - 44ms/step
Epoch 20/50
295/295 - 13s - loss: 13.0703 - accuracy10: 0.3807 - accuracy20: 0.3799 - accuracy30: 0.3764 - accuracy50: 0.3727 - val_loss: 13.0508 - val_accuracy10: 0.3862 - val_accuracy20: 0.3863 - val_accuracy30: 0.3829 - val_accuracy50: 0.3835 - 13s/epoch - 45ms/step
Epoch 21/50
295/295 - 13s - loss: 13.0500 - accuracy10: 0.3832 - accuracy20: 0.3838 - accuracy30: 0.3832 - accuracy50: 0.3781 - val_loss: 13.0723 - val_accuracy10: 0.3816 - val_accuracy20: 0.3829 - val_accuracy30: 0.3804 - val_accuracy50: 0.3821 - 13s/epoch - 45ms/step
Epoch 22/50
295/295 - 13s - loss: 13.0385 - accuracy10: 0.3868 - accuracy20: 0.3887 - accuracy30: 0.3850 - accuracy50: 0.3809 - val_loss: 13.0876 - val_accuracy10: 0.3852 - val_accuracy20: 0.3815 - val_accuracy30: 0.3758 - val_accuracy50: 0.3760 - 13s/epoch - 44ms/step
Epoch 23/50
295/295 - 13s - loss: 13.0244 - accuracy10: 0.3879 - accuracy20: 0.3900 - accuracy30: 0.3861 - accuracy50: 0.3821 - val_loss: 13.0950 - val_accuracy10: 0.3857 - val_accuracy20: 0.3810 - val_accuracy30: 0.3778 - val_accuracy50: 0.3784 - 13s/epoch - 44ms/step
Epoch 24/50
295/295 - 13s - loss: 13.0273 - accuracy10: 0.3852 - accuracy20: 0.3881 - accuracy30: 0.3860 - accuracy50: 0.3810 - val_loss: 13.1252 - val_accuracy10: 0.3740 - val_accuracy20: 0.3702 - val_accuracy30: 0.3669 - val_accuracy50: 0.3669 - 13s/epoch - 45ms/step
Epoch 25/50
295/295 - 13s - loss: 13.0275 - accuracy10: 0.3854 - accuracy20: 0.3868 - accuracy30: 0.3851 - accuracy50: 0.3799 - val_loss: 13.1213 - val_accuracy10: 0.3808 - val_accuracy20: 0.3773 - val_accuracy30: 0.3727 - val_accuracy50: 0.3720 - 13s/epoch - 44ms/step
Epoch 26/50
295/295 - 13s - loss: 12.9964 - accuracy10: 0.3898 - accuracy20: 0.3940 - accuracy30: 0.3911 - accuracy50: 0.3852 - val_loss: 13.1415 - val_accuracy10: 0.3773 - val_accuracy20: 0.3741 - val_accuracy30: 0.3709 - val_accuracy50: 0.3725 - 13s/epoch - 44ms/step
Epoch 27/50
295/295 - 13s - loss: 13.0062 - accuracy10: 0.3885 - accuracy20: 0.3922 - accuracy30: 0.3893 - accuracy50: 0.3815 - val_loss: 13.1333 - val_accuracy10: 0.3757 - val_accuracy20: 0.3715 - val_accuracy30: 0.3675 - val_accuracy50: 0.3672 - 13s/epoch - 45ms/step
Epoch 28/50
295/295 - 13s - loss: 13.0045 - accuracy10: 0.3889 - accuracy20: 0.3904 - accuracy30: 0.3885 - accuracy50: 0.3819 - val_loss: 13.0889 - val_accuracy10: 0.3774 - val_accuracy20: 0.3779 - val_accuracy30: 0.3736 - val_accuracy50: 0.3731 - 13s/epoch - 45ms/step
Epoch 29/50
295/295 - 13s - loss: 12.9973 - accuracy10: 0.3899 - accuracy20: 0.3945 - accuracy30: 0.3908 - accuracy50: 0.3840 - val_loss: 13.1244 - val_accuracy10: 0.3797 - val_accuracy20: 0.3748 - val_accuracy30: 0.3708 - val_accuracy50: 0.3708 - 13s/epoch - 45ms/step
Epoch 30/50
295/295 - 13s - loss: 12.9927 - accuracy10: 0.3915 - accuracy20: 0.3949 - accuracy30: 0.3916 - accuracy50: 0.3835 - val_loss: 13.1026 - val_accuracy10: 0.3822 - val_accuracy20: 0.3813 - val_accuracy30: 0.3783 - val_accuracy50: 0.3785 - 13s/epoch - 45ms/step
testing model: results/CHTR/W10/deepVOL_L3/seq2seq
Evaluating performance on  test set...
1588/1588 - 28s - 28s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0940082
{'0': {'precision': 0.37065048640487686, 'recall': 0.1856796289689618, 'f1-score': 0.24741513317709246, 'support': 140150}, '1': {'precision': 0.35044282034433966, 'recall': 0.687785311360238, 'f1-score': 0.4643091762670042, 'support': 126397}, '2': {'precision': 0.38960094536860285, 'recall': 0.24537172872283328, 'f1-score': 0.30110605189091405, 'support': 139739}, 'accuracy': 0.36241711503719054, 'macro avg': {'precision': 0.37023141737260645, 'recall': 0.37294555635067766, 'f1-score': 0.33761012044500355, 'support': 406286}, 'weighted avg': {'precision': 0.3708816777776497, 'recall': 0.36241711503719054, 'f1-score': 0.33335821675512933, 'support': 406286}}
[[26023 80940 33187]
 [18930 86934 20533]
 [25256 80195 34288]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0951902
{'0': {'precision': 0.37122311797941, 'recall': 0.23635381268572891, 'f1-score': 0.28881939014855357, 'support': 140662}, '1': {'precision': 0.3445315998208917, 'recall': 0.686204562646813, 'f1-score': 0.45873845195667967, 'support': 125585}, '2': {'precision': 0.390015015015015, 'recall': 0.18548404373067504, 'f1-score': 0.2514046235221812, 'support': 140039}, 'accuracy': 0.3578710563494681, 'macro avg': {'precision': 0.3685899109384389, 'recall': 0.36934747302107235, 'f1-score': 0.33298748854247145, 'support': 406286}, 'weighted avg': {'precision': 0.36944984536118436, 'recall': 0.3578710563494681, 'f1-score': 0.3284460543052879, 'support': 406286}}
[[33246 82552 24864]
 [23647 86177 15761]
 [32665 81399 25975]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0973332
{'0': {'precision': 0.37136942881169543, 'recall': 0.2838445836658874, 'f1-score': 0.3217611311720858, 'support': 141581}, '1': {'precision': 0.33581875879840617, 'recall': 0.6829739740873138, 'f1-score': 0.4502495254750581, 'support': 123646}, '2': {'precision': 0.3887828008668226, 'recall': 0.12845688683458695, 'f1-score': 0.19310903413511235, 'support': 141059}, 'accuracy': 0.35136332534224657, 'macro avg': {'precision': 0.3653236628256414, 'recall': 0.36509181486259606, 'f1-score': 0.3217065635940854, 'support': 406286}, 'weighted avg': {'precision': 0.36659598031546625, 'recall': 0.35136332534224657, 'f1-score': 0.3161974145932396, 'support': 406286}}
[[40187 84161 17233]
 [27945 84447 11254]
 [40081 82858 18120]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1009316
{'0': {'precision': 0.3716299767652503, 'recall': 0.3268065300355315, 'f1-score': 0.34777993985494426, 'support': 144379}, '1': {'precision': 0.3182355149048814, 'recall': 0.6718128362317027, 'f1-score': 0.431887399463807, 'support': 119895}, '2': {'precision': 0.38835062557216965, 'recall': 0.07169112469368785, 'f1-score': 0.12103811493924911, 'support': 142012}, 'accuracy': 0.3394456122042108, 'macro avg': {'precision': 0.3594053724141004, 'recall': 0.35677016365364067, 'f1-score': 0.30023515141933343, 'support': 406286}, 'weighted avg': {'precision': 0.3617177567370418, 'recall': 0.3394456122042108, 'f1-score': 0.293345388405662, 'support': 406286}}
[[47184 87699  9496]
 [32809 80547  6539]
 [46972 84859 10181]]
Evaluating performance on  train set...
295/295 - 5s - 5s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0887686
{'0': {'precision': 0.3752634138434106, 'recall': 0.1778306959594408, 'f1-score': 0.24130921978422887, 'support': 26036}, '1': {'precision': 0.3762106096265595, 'recall': 0.7260340045821777, 'f1-score': 0.49560994347802234, 'support': 24879}, '2': {'precision': 0.39315674747341306, 'recall': 0.2421973550356053, 'f1-score': 0.2997431636198821, 'support': 24575}, 'accuracy': 0.37945423234865544, 'macro avg': {'precision': 0.38154359031446106, 'recall': 0.38202068519240795, 'f1-score': 0.3455541089607111, 'support': 75490}, 'weighted avg': {'precision': 0.38140057052437853, 'recall': 0.37945423234865544, 'f1-score': 0.34414087794476755, 'support': 75490}}
[[ 4630 15701  5705]
 [ 3334 18063  3482]
 [ 4374 14249  5952]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0889353
{'0': {'precision': 0.38103172060237106, 'recall': 0.2270852428964253, 'f1-score': 0.28457249515422717, 'support': 26184}, '1': {'precision': 0.37559422925881525, 'recall': 0.7303858520900322, 'f1-score': 0.49608255302885534, 'support': 24880}, '2': {'precision': 0.392680170390333, 'recall': 0.1849258986326046, 'f1-score': 0.25144034067188065, 'support': 24426}, 'accuracy': 0.3793217644721155, 'macro avg': {'precision': 0.3831020400838397, 'recall': 0.3807989978730207, 'f1-score': 0.3440317962849877, 'support': 75490}, 'weighted avg': {'precision': 0.38300867450213383, 'recall': 0.3793217644721155, 'f1-score': 0.3435615564144597, 'support': 75490}}
[[ 5946 15862  4376]
 [ 4098 18172  2610]
 [ 5561 14348  4517]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.090649
{'0': {'precision': 0.3832140185917299, 'recall': 0.27315308453922316, 'f1-score': 0.3189559340121837, 'support': 26260}, '1': {'precision': 0.3720303597507045, 'recall': 0.7270571210354946, 'f1-score': 0.4922034451791983, 'support': 24877}, '2': {'precision': 0.38553034947884735, 'recall': 0.1291011374368661, 'f1-score': 0.1934293097083795, 'support': 24353}, 'accuracy': 0.3762617565240429, 'macro avg': {'precision': 0.3802582426070939, 'recall': 0.37643711433719457, 'f1-score': 0.3348628962999205, 'support': 75490}, 'weighted avg': {'precision': 0.3802757979678828, 'recall': 0.3762617565240429, 'f1-score': 0.33555321118308423, 'support': 75490}}
[[ 7173 16006  3081]
 [ 4860 18087  1930]
 [ 6685 14524  3144]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0934035
{'0': {'precision': 0.3816469297242924, 'recall': 0.3174367750522913, 'f1-score': 0.3465930324295146, 'support': 26295}, '1': {'precision': 0.36402871811654974, 'recall': 0.7186061535976742, 'f1-score': 0.4832530038693911, 'support': 24766}, '2': {'precision': 0.38202959830866806, 'recall': 0.07396946252404929, 'f1-score': 0.12394115024520731, 'support': 24429}, 'accuracy': 0.3702609617167837, 'macro avg': {'precision': 0.37590174871650345, 'recall': 0.3700041303913382, 'f1-score': 0.317929062181371, 'support': 75490}, 'weighted avg': {'precision': 0.37599075780973895, 'recall': 0.3702609617167837, 'f1-score': 0.31937562645255785, 'support': 75490}}
[[ 8347 16197  1751]
 [ 5797 17797  1172]
 [ 7727 14895  1807]]
Evaluating performance on  val set...
131/131 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0861185
{'0': {'precision': 0.3619396476539334, 'recall': 0.18349840820657942, 'f1-score': 0.24353030925415178, 'support': 11308}, '1': {'precision': 0.3937397826714107, 'recall': 0.7109124055907631, 'f1-score': 0.506792090850017, 'support': 11519}, '2': {'precision': 0.37432214568371686, 'recall': 0.24261423007504512, 'f1-score': 0.2944092219020173, 'support': 10527}, 'accuracy': 0.3843017329255861, 'macro avg': {'precision': 0.3766671920030203, 'recall': 0.3790083479574626, 'f1-score': 0.34824387400206197, 'support': 33354}, 'weighted avg': {'precision': 0.376830104931197, 'recall': 0.3843017329255861, 'f1-score': 0.35050742671073426, 'support': 33354}}
[[2075 6604 2629]
 [1690 8189 1640]
 [1968 6005 2554]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0864575
{'0': {'precision': 0.37362637362637363, 'recall': 0.23880597014925373, 'f1-score': 0.29137653990358864, 'support': 11390}, '1': {'precision': 0.3887168247010054, 'recall': 0.7197176885752096, 'f1-score': 0.5047954953282594, 'support': 11335}, '2': {'precision': 0.38647532927069, 'recall': 0.18496565998682848, 'f1-score': 0.2501908882667345, 'support': 10629}, 'accuracy': 0.3850812496252324, 'macro avg': {'precision': 0.3829395091993563, 'recall': 0.38116310623709726, 'f1-score': 0.34878764116619415, 'support': 33354}, 'weighted avg': {'precision': 0.38284930978019, 'recall': 0.3850812496252324, 'f1-score': 0.35077995683980384, 'support': 33354}}
[[2720 6707 1963]
 [2019 8158 1158]
 [2541 6122 1966]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0884426
{'0': {'precision': 0.3818848047635406, 'recall': 0.29375495463754075, 'f1-score': 0.33207209001294435, 'support': 11353}, '1': {'precision': 0.3870036442803729, 'recall': 0.7194896612406512, 'f1-score': 0.5032929156151905, 'support': 11365}, '2': {'precision': 0.3768613974799542, 'recall': 0.12373072583678074, 'f1-score': 0.18629671574178933, 'support': 10636}, 'accuracy': 0.38460154704083466, 'macro avg': {'precision': 0.3819166155079559, 'recall': 0.37899178057165755, 'f1-score': 0.3405539071233081, 'support': 33354}, 'weighted avg': {'precision': 0.38202711606774925, 'recall': 0.38460154704083466, 'f1-score': 0.3439284731220624, 'support': 33354}}
[[3335 6689 1329]
 [2341 8177  847]
 [3057 6263 1316]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0891877
{'0': {'precision': 0.3745139096619803, 'recall': 0.33401511783014676, 'f1-score': 0.3531070790636458, 'support': 11245}, '1': {'precision': 0.3888392647266231, 'recall': 0.7167865499610018, 'f1-score': 0.5041755562328559, 'support': 11539}, '2': {'precision': 0.36368062317429406, 'recall': 0.0706717123935667, 'f1-score': 0.11834600760456274, 'support': 10570}, 'accuracy': 0.38298255081849253, 'macro avg': {'precision': 0.3756779325209658, 'recall': 0.3738244600615717, 'f1-score': 0.32520954763368815, 'support': 33354}, 'weighted avg': {'precision': 0.37603673852556696, 'recall': 0.38298255081849253, 'f1-score': 0.3309734409012967, 'support': 33354}}
[[3756 6663  826]
 [2787 8271  481]
 [3486 6337  747]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :       256            32
 Used       :        14 (peak)  11.57 (ave)

============================================
