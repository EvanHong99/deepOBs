This machine has 1 visible gpus.
This machine has 1 physical gpus.
training model: results/PCAR/W0/deepLOB_L1/seq2seq
Epoch 1/50
765/765 - 51s - loss: 12.9709 - accuracy10: 0.4194 - accuracy20: 0.4068 - accuracy30: 0.3956 - accuracy50: 0.3862 - val_loss: 13.1363 - val_accuracy10: 0.4000 - val_accuracy20: 0.3902 - val_accuracy30: 0.3791 - val_accuracy50: 0.3669 - 51s/epoch - 67ms/step
Epoch 2/50
765/765 - 23s - loss: 12.8928 - accuracy10: 0.4355 - accuracy20: 0.4178 - accuracy30: 0.4028 - accuracy50: 0.3893 - val_loss: 13.1251 - val_accuracy10: 0.3796 - val_accuracy20: 0.3712 - val_accuracy30: 0.3656 - val_accuracy50: 0.3531 - 23s/epoch - 30ms/step
Epoch 3/50
765/765 - 21s - loss: 12.8404 - accuracy10: 0.4412 - accuracy20: 0.4231 - accuracy30: 0.4076 - accuracy50: 0.3889 - val_loss: 13.0921 - val_accuracy10: 0.4111 - val_accuracy20: 0.3979 - val_accuracy30: 0.3844 - val_accuracy50: 0.3710 - 21s/epoch - 28ms/step
Epoch 4/50
765/765 - 21s - loss: 12.8068 - accuracy10: 0.4506 - accuracy20: 0.4301 - accuracy30: 0.4124 - accuracy50: 0.3919 - val_loss: 13.0617 - val_accuracy10: 0.4164 - val_accuracy20: 0.4000 - val_accuracy30: 0.3865 - val_accuracy50: 0.3695 - 21s/epoch - 28ms/step
Epoch 5/50
765/765 - 21s - loss: 12.7308 - accuracy10: 0.4630 - accuracy20: 0.4404 - accuracy30: 0.4219 - accuracy50: 0.4013 - val_loss: 13.0572 - val_accuracy10: 0.4174 - val_accuracy20: 0.4023 - val_accuracy30: 0.3856 - val_accuracy50: 0.3705 - 21s/epoch - 28ms/step
Epoch 6/50
765/765 - 21s - loss: 12.6879 - accuracy10: 0.4689 - accuracy20: 0.4449 - accuracy30: 0.4259 - accuracy50: 0.4054 - val_loss: 13.1066 - val_accuracy10: 0.4114 - val_accuracy20: 0.3955 - val_accuracy30: 0.3809 - val_accuracy50: 0.3656 - 21s/epoch - 28ms/step
Epoch 7/50
765/765 - 21s - loss: 12.6578 - accuracy10: 0.4720 - accuracy20: 0.4474 - accuracy30: 0.4283 - accuracy50: 0.4067 - val_loss: 13.0782 - val_accuracy10: 0.4173 - val_accuracy20: 0.4004 - val_accuracy30: 0.3829 - val_accuracy50: 0.3660 - 21s/epoch - 28ms/step
Epoch 8/50
765/765 - 21s - loss: 12.6270 - accuracy10: 0.4751 - accuracy20: 0.4510 - accuracy30: 0.4320 - accuracy50: 0.4089 - val_loss: 13.0035 - val_accuracy10: 0.4313 - val_accuracy20: 0.4106 - val_accuracy30: 0.3915 - val_accuracy50: 0.3719 - 21s/epoch - 28ms/step
Epoch 9/50
765/765 - 21s - loss: 12.5992 - accuracy10: 0.4775 - accuracy20: 0.4526 - accuracy30: 0.4341 - accuracy50: 0.4121 - val_loss: 12.9783 - val_accuracy10: 0.4357 - val_accuracy20: 0.4148 - val_accuracy30: 0.3961 - val_accuracy50: 0.3747 - 21s/epoch - 28ms/step
Epoch 10/50
765/765 - 21s - loss: 12.5874 - accuracy10: 0.4792 - accuracy20: 0.4540 - accuracy30: 0.4340 - accuracy50: 0.4108 - val_loss: 12.9465 - val_accuracy10: 0.4382 - val_accuracy20: 0.4176 - val_accuracy30: 0.3964 - val_accuracy50: 0.3758 - 21s/epoch - 28ms/step
Epoch 11/50
765/765 - 21s - loss: 12.5651 - accuracy10: 0.4818 - accuracy20: 0.4562 - accuracy30: 0.4367 - accuracy50: 0.4126 - val_loss: 12.9084 - val_accuracy10: 0.4429 - val_accuracy20: 0.4231 - val_accuracy30: 0.4017 - val_accuracy50: 0.3790 - 21s/epoch - 28ms/step
Epoch 12/50
765/765 - 21s - loss: 12.5553 - accuracy10: 0.4828 - accuracy20: 0.4563 - accuracy30: 0.4370 - accuracy50: 0.4128 - val_loss: 12.8913 - val_accuracy10: 0.4496 - val_accuracy20: 0.4252 - val_accuracy30: 0.4037 - val_accuracy50: 0.3802 - 21s/epoch - 28ms/step
Epoch 13/50
765/765 - 21s - loss: 12.5448 - accuracy10: 0.4836 - accuracy20: 0.4581 - accuracy30: 0.4381 - accuracy50: 0.4133 - val_loss: 12.8691 - val_accuracy10: 0.4502 - val_accuracy20: 0.4277 - val_accuracy30: 0.4048 - val_accuracy50: 0.3812 - 21s/epoch - 28ms/step
Epoch 14/50
765/765 - 21s - loss: 12.5324 - accuracy10: 0.4843 - accuracy20: 0.4592 - accuracy30: 0.4391 - accuracy50: 0.4138 - val_loss: 12.8984 - val_accuracy10: 0.4500 - val_accuracy20: 0.4275 - val_accuracy30: 0.4042 - val_accuracy50: 0.3794 - 21s/epoch - 27ms/step
Epoch 15/50
765/765 - 21s - loss: 12.5204 - accuracy10: 0.4859 - accuracy20: 0.4605 - accuracy30: 0.4405 - accuracy50: 0.4158 - val_loss: 12.9099 - val_accuracy10: 0.4472 - val_accuracy20: 0.4242 - val_accuracy30: 0.4025 - val_accuracy50: 0.3782 - 21s/epoch - 27ms/step
Epoch 16/50
765/765 - 21s - loss: 12.5099 - accuracy10: 0.4866 - accuracy20: 0.4613 - accuracy30: 0.4415 - accuracy50: 0.4158 - val_loss: 12.8996 - val_accuracy10: 0.4476 - val_accuracy20: 0.4243 - val_accuracy30: 0.4019 - val_accuracy50: 0.3791 - 21s/epoch - 27ms/step
Epoch 17/50
765/765 - 21s - loss: 12.5033 - accuracy10: 0.4872 - accuracy20: 0.4613 - accuracy30: 0.4407 - accuracy50: 0.4157 - val_loss: 12.8874 - val_accuracy10: 0.4508 - val_accuracy20: 0.4271 - val_accuracy30: 0.4042 - val_accuracy50: 0.3793 - 21s/epoch - 28ms/step
Epoch 18/50
765/765 - 21s - loss: 12.4914 - accuracy10: 0.4890 - accuracy20: 0.4628 - accuracy30: 0.4424 - accuracy50: 0.4168 - val_loss: 12.9095 - val_accuracy10: 0.4535 - val_accuracy20: 0.4280 - val_accuracy30: 0.4032 - val_accuracy50: 0.3773 - 21s/epoch - 28ms/step
Epoch 19/50
765/765 - 21s - loss: 12.4858 - accuracy10: 0.4899 - accuracy20: 0.4635 - accuracy30: 0.4428 - accuracy50: 0.4174 - val_loss: 12.9048 - val_accuracy10: 0.4478 - val_accuracy20: 0.4277 - val_accuracy30: 0.4033 - val_accuracy50: 0.3778 - 21s/epoch - 28ms/step
Epoch 20/50
765/765 - 21s - loss: 12.4764 - accuracy10: 0.4898 - accuracy20: 0.4636 - accuracy30: 0.4427 - accuracy50: 0.4176 - val_loss: 12.8827 - val_accuracy10: 0.4433 - val_accuracy20: 0.4256 - val_accuracy30: 0.4065 - val_accuracy50: 0.3824 - 21s/epoch - 28ms/step
Epoch 21/50
765/765 - 21s - loss: 12.4654 - accuracy10: 0.4912 - accuracy20: 0.4652 - accuracy30: 0.4444 - accuracy50: 0.4185 - val_loss: 12.8646 - val_accuracy10: 0.4438 - val_accuracy20: 0.4255 - val_accuracy30: 0.4036 - val_accuracy50: 0.3779 - 21s/epoch - 27ms/step
Epoch 22/50
765/765 - 21s - loss: 12.4533 - accuracy10: 0.4918 - accuracy20: 0.4660 - accuracy30: 0.4447 - accuracy50: 0.4193 - val_loss: 12.8744 - val_accuracy10: 0.4492 - val_accuracy20: 0.4267 - val_accuracy30: 0.4060 - val_accuracy50: 0.3809 - 21s/epoch - 27ms/step
Epoch 23/50
765/765 - 21s - loss: 12.4501 - accuracy10: 0.4927 - accuracy20: 0.4662 - accuracy30: 0.4446 - accuracy50: 0.4188 - val_loss: 12.8697 - val_accuracy10: 0.4493 - val_accuracy20: 0.4282 - val_accuracy30: 0.4040 - val_accuracy50: 0.3784 - 21s/epoch - 27ms/step
Epoch 24/50
765/765 - 21s - loss: 12.4356 - accuracy10: 0.4948 - accuracy20: 0.4675 - accuracy30: 0.4463 - accuracy50: 0.4207 - val_loss: 12.9221 - val_accuracy10: 0.4392 - val_accuracy20: 0.4224 - val_accuracy30: 0.4009 - val_accuracy50: 0.3760 - 21s/epoch - 28ms/step
Epoch 25/50
765/765 - 21s - loss: 12.4273 - accuracy10: 0.4942 - accuracy20: 0.4678 - accuracy30: 0.4459 - accuracy50: 0.4212 - val_loss: 12.8931 - val_accuracy10: 0.4477 - val_accuracy20: 0.4272 - val_accuracy30: 0.4024 - val_accuracy50: 0.3771 - 21s/epoch - 28ms/step
Epoch 26/50
765/765 - 21s - loss: 12.4210 - accuracy10: 0.4947 - accuracy20: 0.4688 - accuracy30: 0.4484 - accuracy50: 0.4221 - val_loss: 12.8620 - val_accuracy10: 0.4556 - val_accuracy20: 0.4308 - val_accuracy30: 0.4048 - val_accuracy50: 0.3775 - 21s/epoch - 28ms/step
Epoch 27/50
765/765 - 21s - loss: 12.4150 - accuracy10: 0.4953 - accuracy20: 0.4691 - accuracy30: 0.4480 - accuracy50: 0.4221 - val_loss: 12.8610 - val_accuracy10: 0.4517 - val_accuracy20: 0.4286 - val_accuracy30: 0.4039 - val_accuracy50: 0.3801 - 21s/epoch - 27ms/step
Epoch 28/50
765/765 - 21s - loss: 12.4027 - accuracy10: 0.4971 - accuracy20: 0.4711 - accuracy30: 0.4495 - accuracy50: 0.4235 - val_loss: 12.8314 - val_accuracy10: 0.4517 - val_accuracy20: 0.4302 - val_accuracy30: 0.4070 - val_accuracy50: 0.3792 - 21s/epoch - 28ms/step
Epoch 29/50
765/765 - 21s - loss: 12.3945 - accuracy10: 0.4970 - accuracy20: 0.4712 - accuracy30: 0.4496 - accuracy50: 0.4248 - val_loss: 12.8530 - val_accuracy10: 0.4493 - val_accuracy20: 0.4291 - val_accuracy30: 0.4063 - val_accuracy50: 0.3811 - 21s/epoch - 28ms/step
Epoch 30/50
765/765 - 21s - loss: 12.3860 - accuracy10: 0.4982 - accuracy20: 0.4729 - accuracy30: 0.4516 - accuracy50: 0.4249 - val_loss: 12.8520 - val_accuracy10: 0.4477 - val_accuracy20: 0.4273 - val_accuracy30: 0.4045 - val_accuracy50: 0.3793 - 21s/epoch - 28ms/step
Epoch 31/50
765/765 - 21s - loss: 12.3781 - accuracy10: 0.4983 - accuracy20: 0.4724 - accuracy30: 0.4517 - accuracy50: 0.4254 - val_loss: 12.8755 - val_accuracy10: 0.4407 - val_accuracy20: 0.4219 - val_accuracy30: 0.4012 - val_accuracy50: 0.3804 - 21s/epoch - 28ms/step
Epoch 32/50
765/765 - 21s - loss: 12.3670 - accuracy10: 0.4981 - accuracy20: 0.4740 - accuracy30: 0.4517 - accuracy50: 0.4264 - val_loss: 12.8440 - val_accuracy10: 0.4471 - val_accuracy20: 0.4279 - val_accuracy30: 0.4045 - val_accuracy50: 0.3783 - 21s/epoch - 27ms/step
Epoch 33/50
765/765 - 21s - loss: 12.3577 - accuracy10: 0.5000 - accuracy20: 0.4746 - accuracy30: 0.4533 - accuracy50: 0.4280 - val_loss: 12.9251 - val_accuracy10: 0.4302 - val_accuracy20: 0.4161 - val_accuracy30: 0.3979 - val_accuracy50: 0.3753 - 21s/epoch - 27ms/step
Epoch 34/50
765/765 - 21s - loss: 12.3499 - accuracy10: 0.5005 - accuracy20: 0.4748 - accuracy30: 0.4535 - accuracy50: 0.4285 - val_loss: 12.8450 - val_accuracy10: 0.4481 - val_accuracy20: 0.4276 - val_accuracy30: 0.4044 - val_accuracy50: 0.3804 - 21s/epoch - 27ms/step
Epoch 35/50
765/765 - 21s - loss: 12.3453 - accuracy10: 0.5005 - accuracy20: 0.4761 - accuracy30: 0.4553 - accuracy50: 0.4292 - val_loss: 12.8607 - val_accuracy10: 0.4547 - val_accuracy20: 0.4308 - val_accuracy30: 0.4067 - val_accuracy50: 0.3825 - 21s/epoch - 28ms/step
Epoch 36/50
765/765 - 21s - loss: 12.3331 - accuracy10: 0.5016 - accuracy20: 0.4766 - accuracy30: 0.4555 - accuracy50: 0.4295 - val_loss: 12.8741 - val_accuracy10: 0.4513 - val_accuracy20: 0.4269 - val_accuracy30: 0.4044 - val_accuracy50: 0.3792 - 21s/epoch - 27ms/step
Epoch 37/50
765/765 - 21s - loss: 12.3272 - accuracy10: 0.5023 - accuracy20: 0.4773 - accuracy30: 0.4555 - accuracy50: 0.4305 - val_loss: 12.8443 - val_accuracy10: 0.4532 - val_accuracy20: 0.4309 - val_accuracy30: 0.4066 - val_accuracy50: 0.3803 - 21s/epoch - 28ms/step
Epoch 38/50
765/765 - 21s - loss: 12.3243 - accuracy10: 0.5035 - accuracy20: 0.4786 - accuracy30: 0.4566 - accuracy50: 0.4303 - val_loss: 12.8507 - val_accuracy10: 0.4519 - val_accuracy20: 0.4280 - val_accuracy30: 0.4049 - val_accuracy50: 0.3820 - 21s/epoch - 27ms/step
testing model: results/PCAR/W0/deepLOB_L1/seq2seq
Evaluating performance on  test set...
1733/1733 - 24s - 24s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0717231
{'0': {'precision': 0.403847414301632, 'recall': 0.5978390441339543, 'f1-score': 0.4820585326053548, 'support': 144288}, '1': {'precision': 0.4366873529611091, 'recall': 0.2940984696838303, 'f1-score': 0.35148213951748647, 'support': 153367}, '2': {'precision': 0.4471786771964462, 'recall': 0.38821585525548996, 'f1-score': 0.4156164443889872, 'support': 145857}, 'accuracy': 0.42386677248868126, 'macro avg': {'precision': 0.4292378148197291, 'recall': 0.4267177896910915, 'f1-score': 0.4163857055039428, 'support': 443512}, 'weighted avg': {'precision': 0.429453780948841, 'recall': 0.42386677248868126, 'f1-score': 0.41505436284290903, 'support': 443512}}
[[86261 25720 32307]
 [70568 45105 37694]
 [56769 32464 56624]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0845273
{'0': {'precision': 0.38521947468054896, 'recall': 0.5503313636971878, 'f1-score': 0.45320542749182946, 'support': 141989}, '1': {'precision': 0.41988549894919924, 'recall': 0.2578762311081722, 'f1-score': 0.31951786347343125, 'support': 157277}, '2': {'precision': 0.4131365784925488, 'recall': 0.4126353590394188, 'f1-score': 0.4128858166531976, 'support': 144246}, 'accuracy': 0.4018380562419957, 'macro avg': {'precision': 0.40608051737409906, 'recall': 0.4069476512815929, 'f1-score': 0.3952030358728194, 'support': 443512}, 'weighted avg': {'precision': 0.4065922872659271, 'recall': 0.4018380562419957, 'f1-score': 0.39268413023008475, 'support': 443512}}
[[78141 25391 38457]
 [70626 40558 46093]
 [54081 30644 59521]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.090484
{'0': {'precision': 0.3744651396929273, 'recall': 0.5049032431400553, 'f1-score': 0.43001014629329115, 'support': 141437}, '1': {'precision': 0.40887308875317613, 'recall': 0.23359416285184925, 'f1-score': 0.29732368970197937, 'support': 157063}, '2': {'precision': 0.3943989305599843, 'recall': 0.443528811408711, 'f1-score': 0.4175235646958012, 'support': 145012}, 'accuracy': 0.38875611031945023, 'macro avg': {'precision': 0.3925790530020293, 'recall': 0.3940087391335385, 'f1-score': 0.38161913356369065, 'support': 443512}, 'weighted avg': {'precision': 0.3931678006907437, 'recall': 0.38875611031945023, 'f1-score': 0.3789386147401056, 'support': 443512}}
[[71412 24575 45450]
 [67065 36689 53309]
 [52227 28468 64317]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0997001
{'0': {'precision': 0.3364602075546321, 'recall': 0.4535052219811243, 'f1-score': 0.38631174329881746, 'support': 133187}, '1': {'precision': 0.43659485511875035, 'recall': 0.21640369106074822, 'f1-score': 0.28937503367690187, 'support': 173717}, '2': {'precision': 0.3572528782155064, 'recall': 0.46520701569454204, 'f1-score': 0.4041450447700447, 'support': 136608}, 'accuracy': 0.36424042641461785, 'macro avg': {'precision': 0.37676931362962957, 'recall': 0.37837197624547153, 'f1-score': 0.35994394058192136, 'support': 443512}, 'weighted avg': {'precision': 0.38208588560739426, 'recall': 0.36424042641461785, 'f1-score': 0.3538359980247124, 'support': 443512}}
[[60401 23458 49328]
 [71115 37593 65009]
 [48003 25054 63551]]
Evaluating performance on  train set...
765/765 - 10s - 10s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0478818
{'0': {'precision': 0.4289154325964272, 'recall': 0.6197673170956023, 'f1-score': 0.5069746155341146, 'support': 65239}, '1': {'precision': 0.4733661247987295, 'recall': 0.33286285944721905, 'f1-score': 0.39087158845652986, 'support': 64474}, '2': {'precision': 0.4559554123114728, 'recall': 0.3876701336845771, 'f1-score': 0.41904917764503724, 'support': 66051}, 'accuracy': 0.44696675588974477, 'macro avg': {'precision': 0.45274565656887655, 'recall': 0.4467667700757995, 'f1-score': 0.43896512721189396, 'support': 195764}, 'weighted avg': {'precision': 0.45267839018418454, 'recall': 0.44696675588974477, 'f1-score': 0.43907045713005843, 'support': 195764}}
[[40433 10326 14480]
 [26940 21461 16073]
 [26895 13550 25606]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0645587
{'0': {'precision': 0.4119299477680727, 'recall': 0.5760672743455176, 'f1-score': 0.48036443204647533, 'support': 65166}, '1': {'precision': 0.44837495549565126, 'recall': 0.27456629395458937, 'f1-score': 0.34057719054242, 'support': 64214}, '2': {'precision': 0.42962792834175473, 'recall': 0.422677151120752, 'f1-score': 0.4261241970021414, 'support': 66384}, 'accuracy': 0.4251547782023252, 'macro avg': {'precision': 0.4299776105351596, 'recall': 0.4244369064736196, 'f1-score': 0.41568860653034556, 'support': 195764}, 'weighted avg': {'precision': 0.4298859686331043, 'recall': 0.4251547782023252, 'f1-score': 0.41611880113821603, 'support': 195764}}
[[37540  9527 18099]
 [27431 17631 19152]
 [26161 12164 28059]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0777234
{'0': {'precision': 0.3962159283017994, 'recall': 0.5284878063848518, 'f1-score': 0.45289162128000315, 'support': 64747}, '1': {'precision': 0.42489244562110773, 'recall': 0.21827426858105498, 'f1-score': 0.28839517265320297, 'support': 64703}, '2': {'precision': 0.40557751139004505, 'recall': 0.4658141568899478, 'f1-score': 0.43361384644539114, 'support': 66314}, 'accuracy': 0.40472712041028996, 'macro avg': {'precision': 0.4088952951043174, 'recall': 0.4041920772852849, 'f1-score': 0.39163354679286577, 'support': 195764}, 'weighted avg': {'precision': 0.40886514225852855, 'recall': 0.40472712041028996, 'f1-score': 0.3919927835167662, 'support': 195764}}
[[34218  8571 21958]
 [27265 14123 23315]
 [24879 10545 30890]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0899042
{'0': {'precision': 0.3785560691069972, 'recall': 0.4732857451871079, 'f1-score': 0.4206536665751167, 'support': 64722}, '1': {'precision': 0.4004559270516717, 'recall': 0.17926833039552215, 'f1-score': 0.24766624655544398, 'support': 64674}, '2': {'precision': 0.38039909656087734, 'recall': 0.4923155737704918, 'f1-score': 0.4291812796364162, 'support': 66368}, 'accuracy': 0.38260354304162153, 'macro avg': {'precision': 0.38647036423984876, 'recall': 0.38162321645104064, 'f1-score': 0.36583373092232563, 'support': 195764}, 'weighted avg': {'precision': 0.38641588735127597, 'recall': 0.38260354304162153, 'f1-score': 0.36639533624522974, 'support': 195764}}
[[30632  8052 26038]
 [25898 11594 27182]
 [24388  9306 32674]]
Evaluating performance on  val set...
253/253 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0436995
{'0': {'precision': 0.4187200956937799, 'recall': 0.6521050670640834, 'f1-score': 0.5099796037296037, 'support': 21472}, '1': {'precision': 0.5336881031839091, 'recall': 0.281132702998052, 'f1-score': 0.36827036783469225, 'support': 21047}, '2': {'precision': 0.4620870684958645, 'recall': 0.42028920221631605, 'f1-score': 0.4401981599433829, 'support': 22199}, 'accuracy': 0.4519453629593003, 'macro avg': {'precision': 0.4714984224578512, 'recall': 0.4511756574261505, 'f1-score': 0.4394827105025596, 'support': 64718}, 'weighted avg': {'precision': 0.4709843047681986, 'recall': 0.4519453629593003, 'f1-score': 0.4399583954337584, 'support': 64718}}
[[14002  2291  5179]
 [ 9448  5917  5682]
 [ 9990  2879  9330]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0603102
{'0': {'precision': 0.4107900450977117, 'recall': 0.573447118074986, 'f1-score': 0.47867805912921624, 'support': 21444}, '1': {'precision': 0.5176136363636363, 'recall': 0.21305954441274147, 'f1-score': 0.30186553563736374, 'support': 21379}, '2': {'precision': 0.42497017280529575, 'recall': 0.504316053893583, 'f1-score': 0.4612556915493546, 'support': 21895}, 'accuracy': 0.4310083747952656, 'macro avg': {'precision': 0.45112461808888127, 'recall': 0.4302742387937702, 'f1-score': 0.41393309543864487, 'support': 64718}, 'weighted avg': {'precision': 0.450875577002773, 'recall': 0.4310083747952656, 'f1-score': 0.41437542805450156, 'support': 64718}}
[[12297  1938  7209]
 [ 9092  4555  7732]
 [ 8546  2307 11042]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.077759
{'0': {'precision': 0.3951898326898327, 'recall': 0.4649160160870594, 'f1-score': 0.4272266788408444, 'support': 21135}, '1': {'precision': 0.5090356871678057, 'recall': 0.15201124665548046, 'f1-score': 0.23411090934488057, 'support': 22051}, '2': {'precision': 0.39388018876431513, 'recall': 0.6085825747724317, 'f1-score': 0.47823944818525205, 'support': 21532}, 'accuracy': 0.406100312123366, 'macro avg': {'precision': 0.43270190287398447, 'recall': 0.4085032791716572, 'f1-score': 0.37985901212365897, 'support': 64718}, 'weighted avg': {'precision': 0.4335441650871493, 'recall': 0.406100312123366, 'f1-score': 0.3783996309773178, 'support': 64718}}
[[ 9826  1531  9778]
 [ 8312  3352 10387]
 [ 6726  1702 13104]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0911045
{'0': {'precision': 0.37917325286200126, 'recall': 0.3727456797099402, 'f1-score': 0.3759319941112219, 'support': 21237}, '1': {'precision': 0.47094068304373876, 'recall': 0.10659072416598861, 'f1-score': 0.1738361163330753, 'support': 22122}, '2': {'precision': 0.3706030797754545, 'recall': 0.6738143171496793, 'f1-score': 0.4781951389696476, 'support': 21359}, 'accuracy': 0.38113044284434006, 'macro avg': {'precision': 0.40690567189373156, 'recall': 0.38438357367520276, 'f1-score': 0.34265441647131495, 'support': 64718}, 'weighted avg': {'precision': 0.407712898146541, 'recall': 0.38113044284434006, 'f1-score': 0.34060138288749675, 'support': 64718}}
[[ 7916  1289 12032]
 [ 7354  2358 12410]
 [ 5607  1360 14392]]
training model: results/PCAR/W0/deepOF_L1/seq2seq
Epoch 1/50
765/765 - 25s - loss: 13.1535 - accuracy10: 0.3817 - accuracy20: 0.3744 - accuracy30: 0.3685 - accuracy50: 0.3611 - val_loss: 13.2091 - val_accuracy10: 0.3890 - val_accuracy20: 0.3773 - val_accuracy30: 0.3659 - val_accuracy50: 0.3561 - 25s/epoch - 33ms/step
Epoch 2/50
765/765 - 21s - loss: 13.0640 - accuracy10: 0.3963 - accuracy20: 0.3865 - accuracy30: 0.3779 - accuracy50: 0.3695 - val_loss: 13.1722 - val_accuracy10: 0.3915 - val_accuracy20: 0.3802 - val_accuracy30: 0.3694 - val_accuracy50: 0.3588 - 21s/epoch - 27ms/step
Epoch 3/50
765/765 - 20s - loss: 13.0403 - accuracy10: 0.4000 - accuracy20: 0.3901 - accuracy30: 0.3810 - accuracy50: 0.3717 - val_loss: 13.1644 - val_accuracy10: 0.3928 - val_accuracy20: 0.3810 - val_accuracy30: 0.3687 - val_accuracy50: 0.3595 - 20s/epoch - 26ms/step
Epoch 4/50
765/765 - 20s - loss: 13.0251 - accuracy10: 0.4034 - accuracy20: 0.3924 - accuracy30: 0.3848 - accuracy50: 0.3745 - val_loss: 13.1604 - val_accuracy10: 0.3930 - val_accuracy20: 0.3801 - val_accuracy30: 0.3701 - val_accuracy50: 0.3607 - 20s/epoch - 26ms/step
Epoch 5/50
765/765 - 20s - loss: 13.0107 - accuracy10: 0.4053 - accuracy20: 0.3945 - accuracy30: 0.3860 - accuracy50: 0.3760 - val_loss: 13.1538 - val_accuracy10: 0.3962 - val_accuracy20: 0.3831 - val_accuracy30: 0.3728 - val_accuracy50: 0.3616 - 20s/epoch - 26ms/step
Epoch 6/50
765/765 - 20s - loss: 12.9998 - accuracy10: 0.4076 - accuracy20: 0.3970 - accuracy30: 0.3878 - accuracy50: 0.3770 - val_loss: 13.1519 - val_accuracy10: 0.3966 - val_accuracy20: 0.3833 - val_accuracy30: 0.3726 - val_accuracy50: 0.3613 - 20s/epoch - 26ms/step
Epoch 7/50
765/765 - 20s - loss: 12.9887 - accuracy10: 0.4090 - accuracy20: 0.3982 - accuracy30: 0.3891 - accuracy50: 0.3791 - val_loss: 13.1479 - val_accuracy10: 0.3957 - val_accuracy20: 0.3830 - val_accuracy30: 0.3724 - val_accuracy50: 0.3623 - 20s/epoch - 26ms/step
Epoch 8/50
765/765 - 20s - loss: 12.9812 - accuracy10: 0.4111 - accuracy20: 0.4001 - accuracy30: 0.3911 - accuracy50: 0.3794 - val_loss: 13.1500 - val_accuracy10: 0.3970 - val_accuracy20: 0.3844 - val_accuracy30: 0.3733 - val_accuracy50: 0.3625 - 20s/epoch - 26ms/step
Epoch 9/50
765/765 - 20s - loss: 12.9692 - accuracy10: 0.4129 - accuracy20: 0.4011 - accuracy30: 0.3918 - accuracy50: 0.3822 - val_loss: 13.1432 - val_accuracy10: 0.3968 - val_accuracy20: 0.3829 - val_accuracy30: 0.3720 - val_accuracy50: 0.3639 - 20s/epoch - 26ms/step
Epoch 10/50
765/765 - 20s - loss: 12.9633 - accuracy10: 0.4148 - accuracy20: 0.4033 - accuracy30: 0.3933 - accuracy50: 0.3813 - val_loss: 13.1396 - val_accuracy10: 0.3972 - val_accuracy20: 0.3847 - val_accuracy30: 0.3733 - val_accuracy50: 0.3632 - 20s/epoch - 26ms/step
Epoch 11/50
765/765 - 19s - loss: 12.9516 - accuracy10: 0.4171 - accuracy20: 0.4042 - accuracy30: 0.3944 - accuracy50: 0.3830 - val_loss: 13.1405 - val_accuracy10: 0.3984 - val_accuracy20: 0.3849 - val_accuracy30: 0.3735 - val_accuracy50: 0.3631 - 19s/epoch - 25ms/step
Epoch 12/50
765/765 - 20s - loss: 12.9434 - accuracy10: 0.4192 - accuracy20: 0.4068 - accuracy30: 0.3963 - accuracy50: 0.3846 - val_loss: 13.1397 - val_accuracy10: 0.3983 - val_accuracy20: 0.3852 - val_accuracy30: 0.3743 - val_accuracy50: 0.3624 - 20s/epoch - 26ms/step
Epoch 13/50
765/765 - 19s - loss: 12.9328 - accuracy10: 0.4203 - accuracy20: 0.4075 - accuracy30: 0.3967 - accuracy50: 0.3862 - val_loss: 13.1424 - val_accuracy10: 0.3969 - val_accuracy20: 0.3833 - val_accuracy30: 0.3732 - val_accuracy50: 0.3630 - 19s/epoch - 25ms/step
Epoch 14/50
765/765 - 20s - loss: 12.9246 - accuracy10: 0.4230 - accuracy20: 0.4090 - accuracy30: 0.3991 - accuracy50: 0.3877 - val_loss: 13.1333 - val_accuracy10: 0.3993 - val_accuracy20: 0.3844 - val_accuracy30: 0.3739 - val_accuracy50: 0.3641 - 20s/epoch - 27ms/step
Epoch 15/50
765/765 - 20s - loss: 12.9175 - accuracy10: 0.4237 - accuracy20: 0.4103 - accuracy30: 0.3994 - accuracy50: 0.3868 - val_loss: 13.1342 - val_accuracy10: 0.3989 - val_accuracy20: 0.3841 - val_accuracy30: 0.3748 - val_accuracy50: 0.3644 - 20s/epoch - 27ms/step
Epoch 16/50
765/765 - 21s - loss: 12.9052 - accuracy10: 0.4259 - accuracy20: 0.4129 - accuracy30: 0.4021 - accuracy50: 0.3886 - val_loss: 13.1490 - val_accuracy10: 0.3985 - val_accuracy20: 0.3840 - val_accuracy30: 0.3736 - val_accuracy50: 0.3612 - 21s/epoch - 27ms/step
Epoch 17/50
765/765 - 20s - loss: 12.8935 - accuracy10: 0.4264 - accuracy20: 0.4148 - accuracy30: 0.4042 - accuracy50: 0.3907 - val_loss: 13.1475 - val_accuracy10: 0.3981 - val_accuracy20: 0.3842 - val_accuracy30: 0.3735 - val_accuracy50: 0.3638 - 20s/epoch - 26ms/step
Epoch 18/50
765/765 - 20s - loss: 12.8863 - accuracy10: 0.4291 - accuracy20: 0.4161 - accuracy30: 0.4039 - accuracy50: 0.3900 - val_loss: 13.1438 - val_accuracy10: 0.3999 - val_accuracy20: 0.3851 - val_accuracy30: 0.3757 - val_accuracy50: 0.3655 - 20s/epoch - 27ms/step
Epoch 19/50
765/765 - 20s - loss: 12.8750 - accuracy10: 0.4297 - accuracy20: 0.4168 - accuracy30: 0.4043 - accuracy50: 0.3908 - val_loss: 13.1521 - val_accuracy10: 0.3984 - val_accuracy20: 0.3849 - val_accuracy30: 0.3737 - val_accuracy50: 0.3637 - 20s/epoch - 27ms/step
Epoch 20/50
765/765 - 21s - loss: 12.8649 - accuracy10: 0.4316 - accuracy20: 0.4188 - accuracy30: 0.4078 - accuracy50: 0.3934 - val_loss: 13.1495 - val_accuracy10: 0.3996 - val_accuracy20: 0.3847 - val_accuracy30: 0.3754 - val_accuracy50: 0.3631 - 21s/epoch - 27ms/step
Epoch 21/50
765/765 - 20s - loss: 12.8563 - accuracy10: 0.4331 - accuracy20: 0.4196 - accuracy30: 0.4083 - accuracy50: 0.3943 - val_loss: 13.1590 - val_accuracy10: 0.3966 - val_accuracy20: 0.3828 - val_accuracy30: 0.3728 - val_accuracy50: 0.3641 - 20s/epoch - 26ms/step
Epoch 22/50
765/765 - 20s - loss: 12.8484 - accuracy10: 0.4348 - accuracy20: 0.4221 - accuracy30: 0.4100 - accuracy50: 0.3959 - val_loss: 13.1688 - val_accuracy10: 0.3979 - val_accuracy20: 0.3830 - val_accuracy30: 0.3730 - val_accuracy50: 0.3624 - 20s/epoch - 26ms/step
Epoch 23/50
765/765 - 19s - loss: 12.8347 - accuracy10: 0.4364 - accuracy20: 0.4236 - accuracy30: 0.4108 - accuracy50: 0.3965 - val_loss: 13.1647 - val_accuracy10: 0.3973 - val_accuracy20: 0.3834 - val_accuracy30: 0.3731 - val_accuracy50: 0.3633 - 19s/epoch - 25ms/step
Epoch 24/50
765/765 - 20s - loss: 12.8269 - accuracy10: 0.4374 - accuracy20: 0.4236 - accuracy30: 0.4110 - accuracy50: 0.3969 - val_loss: 13.1786 - val_accuracy10: 0.3957 - val_accuracy20: 0.3819 - val_accuracy30: 0.3703 - val_accuracy50: 0.3605 - 20s/epoch - 26ms/step
testing model: results/PCAR/W0/deepOF_L1/seq2seq
Evaluating performance on  test set...
1733/1733 - 22s - 22s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0877359
{'0': {'precision': 0.3891044368530341, 'recall': 0.523384112110669, 'f1-score': 0.4463641334062329, 'support': 144286}, '1': {'precision': 0.44975758783290165, 'recall': 0.08831162056779208, 'f1-score': 0.14763461957706564, 'support': 153366}, '2': {'precision': 0.38491842746017124, 'recall': 0.5787802954989545, 'f1-score': 0.46235030903499474, 'support': 145855}, 'accuracy': 0.3911527890202409, 'macro avg': {'precision': 0.4079268173820356, 'recall': 0.3968253427258052, 'f1-score': 0.3521163540060977, 'support': 443507}, 'weighted avg': {'precision': 0.40870182934781407, 'recall': 0.3911527890202409, 'f1-score': 0.34831993800099464, 'support': 443507}}
[[75517  8124 60645]
 [65571 13544 74251]
 [52991  8446 84418]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.09548
{'0': {'precision': 0.37778758995909334, 'recall': 0.5242559125547589, 'f1-score': 0.43913043478260866, 'support': 141986}, '1': {'precision': 0.45005375188131586, 'recall': 0.06654543604872962, 'f1-score': 0.11594684569409132, 'support': 157276}, '2': {'precision': 0.376385416946662, 'recall': 0.5824534645914936, 'f1-score': 0.45727597064194214, 'support': 144245}, 'accuracy': 0.38087110237267957, 'macro avg': {'precision': 0.4014089195956904, 'recall': 0.3910849377316607, 'f1-score': 0.33745108370621407, 'support': 443507}, 'weighted avg': {'precision': 0.4029585036905594, 'recall': 0.38087110237267957, 'f1-score': 0.3304250043441802, 'support': 443507}}
[[74437  6554 60995]
 [68603 10466 78207]
 [53994  6235 84016]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.096243
{'0': {'precision': 0.37421289659120266, 'recall': 0.5222930836998175, 'f1-score': 0.43602343323446513, 'support': 141434}, '1': {'precision': 0.442099077924426, 'recall': 0.062274373977321204, 'f1-score': 0.10917086619006959, 'support': 157063}, '2': {'precision': 0.37498548990543884, 'recall': 0.5792014343838356, 'f1-score': 0.45524022201023334, 'support': 145010}, 'accuracy': 0.37798952440434985, 'macro avg': {'precision': 0.39709915480702246, 'recall': 0.3879229640203248, 'f1-score': 0.33347817381158934, 'support': 443507}, 'weighted avg': {'precision': 0.39850663052378416, 'recall': 0.37798952440434985, 'f1-score': 0.326555446940405, 'support': 443507}}
[[73870  6441 61123]
 [68413  9781 78869]
 [55118  5902 83990]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1058923
{'0': {'precision': 0.3456549213892119, 'recall': 0.5133799855838539, 'f1-score': 0.41314344066659814, 'support': 133184}, '1': {'precision': 0.47846738442051934, 'recall': 0.06088673467038154, 'f1-score': 0.10802667728855796, 'support': 173716}, '2': {'precision': 0.3479209807192597, 'recall': 0.5694583732898021, 'f1-score': 0.43194021066191374, 'support': 136607}, 'accuracy': 0.3534171952190157, 'macro avg': {'precision': 0.3906810955096636, 'recall': 0.3812416978480125, 'f1-score': 0.31770344287235663, 'support': 443507}, 'weighted avg': {'precision': 0.398373839906499, 'recall': 0.3534171952190157, 'f1-score': 0.2994228154944373, 'support': 443507}}
[[68374  6235 58575]
 [75915 10577 87224]
 [53521  5294 77792]]
Evaluating performance on  train set...
765/765 - 10s - 10s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.073451
{'0': {'precision': 0.41211360504036226, 'recall': 0.5136897001303781, 'f1-score': 0.4573293549730641, 'support': 65195}, '1': {'precision': 0.5691631474618634, 'recall': 0.1027412178350291, 'f1-score': 0.1740620181600137, 'support': 64278}, '2': {'precision': 0.4040253846079089, 'recall': 0.6271288711891508, 'f1-score': 0.49144147339054783, 'support': 66291}, 'accuracy': 0.41717067489426046, 'macro avg': {'precision': 0.46176737903671156, 'recall': 0.414519929718186, 'f1-score': 0.37427761550787525, 'support': 195764}, 'weighted avg': {'precision': 0.46094104147955167, 'recall': 0.41717067489426046, 'f1-score': 0.3758714187148356, 'support': 195764}}
[[33490  2316 29389]
 [25739  6604 31935]
 [22035  2683 41573]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0795875
{'0': {'precision': 0.40565236130780125, 'recall': 0.5049512539088846, 'f1-score': 0.4498876680711003, 'support': 65236}, '1': {'precision': 0.5531089441124043, 'recall': 0.08240256189955479, 'f1-score': 0.14343593648031328, 'support': 64015}, '2': {'precision': 0.39676448744072673, 'recall': 0.6264790341737705, 'f1-score': 0.48583670970938875, 'support': 66513}, 'accuracy': 0.4080678776485973, 'macro avg': {'precision': 0.4518419309536441, 'recall': 0.40461094999407, 'f1-score': 0.3597201047536008, 'support': 195764}, 'weighted avg': {'precision': 0.45085103927574194, 'recall': 0.4080678776485973, 'f1-score': 0.3618917699933294, 'support': 195764}}
[[32941  2005 30290]
 [25677  5275 33063]
 [22587  2257 41669]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0843076
{'0': {'precision': 0.39706630595301623, 'recall': 0.4937197173101256, 'f1-score': 0.4401493943750129, 'support': 64806}, '1': {'precision': 0.5262296869887665, 'recall': 0.07481896137325746, 'f1-score': 0.1310108881587879, 'support': 64489}, '2': {'precision': 0.3881845793951742, 'recall': 0.6191307225924867, 'f1-score': 0.4771832586399819, 'support': 66469}, 'accuracy': 0.39830612369996526, 'macro avg': {'precision': 0.43716019077898566, 'recall': 0.39588980042528993, 'f1-score': 0.3494478470579276, 'support': 195764}, 'weighted avg': {'precision': 0.4365999168163072, 'recall': 0.39830612369996526, 'f1-score': 0.35088666372203325, 'support': 195764}}
[[31996  2055 30755]
 [25558  4825 34106]
 [23027  2289 41153]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0895916
{'0': {'precision': 0.38456373335322863, 'recall': 0.47814659637296886, 'f1-score': 0.42627944480434454, 'support': 64681}, '1': {'precision': 0.48929086671845523, 'recall': 0.06823281798907409, 'f1-score': 0.11976422013364482, 'support': 64617}, '2': {'precision': 0.38031824850468343, 'recall': 0.6084313784491319, 'f1-score': 0.4680609729279274, 'support': 66466}, 'accuracy': 0.3870783187920149, 'macro avg': {'precision': 0.4180576161921224, 'recall': 0.3849369309370583, 'f1-score': 0.33803487928863896, 'support': 195764}, 'weighted avg': {'precision': 0.4176902161627209, 'recall': 0.3870783187920149, 'f1-score': 0.3392918310230336, 'support': 195764}}
[[30927  2251 31503]
 [25819  4409 34389]
 [23675  2351 40440]]
Evaluating performance on  val set...
253/253 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.084618
{'0': {'precision': 0.394037303568806, 'recall': 0.5002097413190398, 'f1-score': 0.4408206855476371, 'support': 21455}, '1': {'precision': 0.5127970749542962, 'recall': 0.08001331178092612, 'f1-score': 0.13842737292317817, 'support': 21034}, '2': {'precision': 0.3954385964912281, 'recall': 0.6083944396958928, 'f1-score': 0.4793280051037587, 'support': 22229}, 'accuracy': 0.4008003955622856, 'macro avg': {'precision': 0.43409099167144344, 'recall': 0.3962058309319529, 'f1-score': 0.35285868785819136, 'support': 64718}, 'weighted avg': {'precision': 0.43311673080226376, 'recall': 0.4008003955622856, 'f1-score': 0.3557661144649423, 'support': 64718}}
[[10732   787  9936]
 [ 8611  1683 10740]
 [ 7893   812 13524]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0915302
{'0': {'precision': 0.3822644382409455, 'recall': 0.49296367291598486, 'f1-score': 0.43061341174548723, 'support': 21389}, '1': {'precision': 0.5050060072086504, 'recall': 0.0587221756542796, 'f1-score': 0.10521046264235952, 'support': 21474}, '2': {'precision': 0.38053582770367805, 'recall': 0.6031114161519103, 'f1-score': 0.46664188483528934, 'support': 21855}, 'accuracy': 0.3860749714144442, 'macro avg': {'precision': 0.4226020910510913, 'recall': 0.3849324215740582, 'f1-score': 0.3341552530743787, 'support': 64718}, 'weighted avg': {'precision': 0.4224074227077169, 'recall': 0.3860749714144442, 'f1-score': 0.33480852516581944, 'support': 64718}}
[[10544   646 10199]
 [ 8955  1261 11258]
 [ 8084   590 13181]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0957092
{'0': {'precision': 0.371717536572151, 'recall': 0.48613538665029055, 'f1-score': 0.421296106767102, 'support': 21169}, '1': {'precision': 0.48352588789045786, 'recall': 0.05132863956393368, 'f1-score': 0.09280551905387646, 'support': 22015}, '2': {'precision': 0.3695815079548075, 'recall': 0.5954769202191883, 'f1-score': 0.4560910545971902, 'support': 21534}, 'accuracy': 0.3746098457925152, 'macro avg': {'precision': 0.4082749774724721, 'recall': 0.37764698214447084, 'f1-score': 0.32339756013938953, 'support': 64718}, 'weighted avg': {'precision': 0.4090404392271566, 'recall': 0.3746098457925152, 'f1-score': 0.3211316103065571, 'support': 64718}}
[[10291   661 10217]
 [ 9229  1130 11656]
 [ 8165   546 12823]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.099844
{'0': {'precision': 0.36100914129417694, 'recall': 0.47338367154318073, 'f1-score': 0.4096292061417837, 'support': 21190}, '1': {'precision': 0.4355400696864111, 'recall': 0.04523454109558059, 'f1-score': 0.08195713641765358, 'support': 22107}, '2': {'precision': 0.36060746044577896, 'recall': 0.5830726856822744, 'f1-score': 0.44561785325650677, 'support': 21421}, 'accuracy': 0.3634383015544362, 'macro avg': {'precision': 0.38571889047545566, 'recall': 0.3672302994403453, 'f1-score': 0.3124013986053147, 'support': 64718}, 'weighted avg': {'precision': 0.3863351839486716, 'recall': 0.3634383015544362, 'f1-score': 0.3096116896000664, 'support': 64718}}
[[10031   711 10448]
 [ 9409  1000 11698]
 [ 8346   585 12490]]
training model: results/PCAR/W0/deepLOB_L2/seq2seq
Epoch 1/50
765/765 - 47s - loss: 12.9640 - accuracy10: 0.4175 - accuracy20: 0.4059 - accuracy30: 0.3945 - accuracy50: 0.3892 - val_loss: 13.2700 - val_accuracy10: 0.3872 - val_accuracy20: 0.3794 - val_accuracy30: 0.3690 - val_accuracy50: 0.3568 - 47s/epoch - 61ms/step
Epoch 2/50
765/765 - 40s - loss: 12.7131 - accuracy10: 0.4564 - accuracy20: 0.4362 - accuracy30: 0.4203 - accuracy50: 0.4055 - val_loss: 12.8498 - val_accuracy10: 0.4416 - val_accuracy20: 0.4242 - val_accuracy30: 0.4067 - val_accuracy50: 0.3855 - 40s/epoch - 53ms/step
Epoch 3/50
765/765 - 40s - loss: 12.6213 - accuracy10: 0.4672 - accuracy20: 0.4469 - accuracy30: 0.4294 - accuracy50: 0.4130 - val_loss: 12.8485 - val_accuracy10: 0.4452 - val_accuracy20: 0.4249 - val_accuracy30: 0.4062 - val_accuracy50: 0.3870 - 40s/epoch - 52ms/step
Epoch 4/50
765/765 - 40s - loss: 12.5583 - accuracy10: 0.4745 - accuracy20: 0.4536 - accuracy30: 0.4359 - accuracy50: 0.4181 - val_loss: 12.8630 - val_accuracy10: 0.4456 - val_accuracy20: 0.4266 - val_accuracy30: 0.4084 - val_accuracy50: 0.3865 - 40s/epoch - 52ms/step
Epoch 5/50
765/765 - 40s - loss: 12.5270 - accuracy10: 0.4787 - accuracy20: 0.4567 - accuracy30: 0.4382 - accuracy50: 0.4192 - val_loss: 12.9107 - val_accuracy10: 0.4421 - val_accuracy20: 0.4234 - val_accuracy30: 0.4049 - val_accuracy50: 0.3844 - 40s/epoch - 52ms/step
Epoch 6/50
765/765 - 40s - loss: 12.4953 - accuracy10: 0.4827 - accuracy20: 0.4602 - accuracy30: 0.4414 - accuracy50: 0.4212 - val_loss: 12.9868 - val_accuracy10: 0.4410 - val_accuracy20: 0.4214 - val_accuracy30: 0.4042 - val_accuracy50: 0.3835 - 40s/epoch - 52ms/step
Epoch 7/50
765/765 - 39s - loss: 12.4697 - accuracy10: 0.4845 - accuracy20: 0.4620 - accuracy30: 0.4425 - accuracy50: 0.4227 - val_loss: 12.9883 - val_accuracy10: 0.4443 - val_accuracy20: 0.4230 - val_accuracy30: 0.4046 - val_accuracy50: 0.3838 - 39s/epoch - 52ms/step
Epoch 8/50
765/765 - 40s - loss: 12.4472 - accuracy10: 0.4872 - accuracy20: 0.4635 - accuracy30: 0.4451 - accuracy50: 0.4241 - val_loss: 12.8868 - val_accuracy10: 0.4519 - val_accuracy20: 0.4301 - val_accuracy30: 0.4102 - val_accuracy50: 0.3886 - 40s/epoch - 52ms/step
Epoch 9/50
765/765 - 40s - loss: 12.4217 - accuracy10: 0.4904 - accuracy20: 0.4673 - accuracy30: 0.4475 - accuracy50: 0.4256 - val_loss: 12.9384 - val_accuracy10: 0.4504 - val_accuracy20: 0.4282 - val_accuracy30: 0.4076 - val_accuracy50: 0.3870 - 40s/epoch - 52ms/step
Epoch 10/50
765/765 - 40s - loss: 12.3999 - accuracy10: 0.4927 - accuracy20: 0.4692 - accuracy30: 0.4490 - accuracy50: 0.4258 - val_loss: 12.9644 - val_accuracy10: 0.4500 - val_accuracy20: 0.4286 - val_accuracy30: 0.4081 - val_accuracy50: 0.3868 - 40s/epoch - 52ms/step
Epoch 11/50
765/765 - 39s - loss: 12.3806 - accuracy10: 0.4946 - accuracy20: 0.4715 - accuracy30: 0.4510 - accuracy50: 0.4281 - val_loss: 12.8756 - val_accuracy10: 0.4552 - val_accuracy20: 0.4322 - val_accuracy30: 0.4113 - val_accuracy50: 0.3888 - 39s/epoch - 51ms/step
Epoch 12/50
765/765 - 39s - loss: 12.3547 - accuracy10: 0.4975 - accuracy20: 0.4741 - accuracy30: 0.4536 - accuracy50: 0.4302 - val_loss: 12.9014 - val_accuracy10: 0.4547 - val_accuracy20: 0.4326 - val_accuracy30: 0.4108 - val_accuracy50: 0.3883 - 39s/epoch - 52ms/step
Epoch 13/50
765/765 - 40s - loss: 12.3360 - accuracy10: 0.4997 - accuracy20: 0.4767 - accuracy30: 0.4564 - accuracy50: 0.4314 - val_loss: 12.8463 - val_accuracy10: 0.4554 - val_accuracy20: 0.4314 - val_accuracy30: 0.4117 - val_accuracy50: 0.3898 - 40s/epoch - 52ms/step
Epoch 14/50
765/765 - 40s - loss: 12.3157 - accuracy10: 0.5017 - accuracy20: 0.4780 - accuracy30: 0.4572 - accuracy50: 0.4320 - val_loss: 12.9605 - val_accuracy10: 0.4503 - val_accuracy20: 0.4277 - val_accuracy30: 0.4078 - val_accuracy50: 0.3861 - 40s/epoch - 52ms/step
Epoch 15/50
765/765 - 39s - loss: 12.2906 - accuracy10: 0.5039 - accuracy20: 0.4809 - accuracy30: 0.4605 - accuracy50: 0.4334 - val_loss: 12.9602 - val_accuracy10: 0.4530 - val_accuracy20: 0.4296 - val_accuracy30: 0.4095 - val_accuracy50: 0.3878 - 39s/epoch - 52ms/step
Epoch 16/50
765/765 - 39s - loss: 12.2715 - accuracy10: 0.5044 - accuracy20: 0.4823 - accuracy30: 0.4620 - accuracy50: 0.4356 - val_loss: 13.0194 - val_accuracy10: 0.4486 - val_accuracy20: 0.4267 - val_accuracy30: 0.4078 - val_accuracy50: 0.3851 - 39s/epoch - 52ms/step
Epoch 17/50
765/765 - 40s - loss: 12.2551 - accuracy10: 0.5075 - accuracy20: 0.4837 - accuracy30: 0.4628 - accuracy50: 0.4374 - val_loss: 13.0127 - val_accuracy10: 0.4476 - val_accuracy20: 0.4255 - val_accuracy30: 0.4061 - val_accuracy50: 0.3839 - 40s/epoch - 52ms/step
Epoch 18/50
765/765 - 39s - loss: 12.2370 - accuracy10: 0.5076 - accuracy20: 0.4855 - accuracy30: 0.4648 - accuracy50: 0.4384 - val_loss: 12.9465 - val_accuracy10: 0.4513 - val_accuracy20: 0.4296 - val_accuracy30: 0.4102 - val_accuracy50: 0.3913 - 39s/epoch - 52ms/step
Epoch 19/50
765/765 - 40s - loss: 12.2148 - accuracy10: 0.5098 - accuracy20: 0.4873 - accuracy30: 0.4659 - accuracy50: 0.4396 - val_loss: 13.0113 - val_accuracy10: 0.4494 - val_accuracy20: 0.4275 - val_accuracy30: 0.4070 - val_accuracy50: 0.3878 - 40s/epoch - 52ms/step
Epoch 20/50
765/765 - 40s - loss: 12.1946 - accuracy10: 0.5103 - accuracy20: 0.4887 - accuracy30: 0.4668 - accuracy50: 0.4411 - val_loss: 13.0022 - val_accuracy10: 0.4504 - val_accuracy20: 0.4286 - val_accuracy30: 0.4085 - val_accuracy50: 0.3898 - 40s/epoch - 52ms/step
Epoch 21/50
765/765 - 40s - loss: 12.1708 - accuracy10: 0.5138 - accuracy20: 0.4908 - accuracy30: 0.4691 - accuracy50: 0.4436 - val_loss: 13.1488 - val_accuracy10: 0.4451 - val_accuracy20: 0.4237 - val_accuracy30: 0.4040 - val_accuracy50: 0.3847 - 40s/epoch - 52ms/step
Epoch 22/50
765/765 - 40s - loss: 12.1491 - accuracy10: 0.5143 - accuracy20: 0.4931 - accuracy30: 0.4709 - accuracy50: 0.4443 - val_loss: 13.1183 - val_accuracy10: 0.4450 - val_accuracy20: 0.4229 - val_accuracy30: 0.4037 - val_accuracy50: 0.3862 - 40s/epoch - 52ms/step
Epoch 23/50
765/765 - 40s - loss: 12.1294 - accuracy10: 0.5167 - accuracy20: 0.4947 - accuracy30: 0.4733 - accuracy50: 0.4460 - val_loss: 13.0981 - val_accuracy10: 0.4462 - val_accuracy20: 0.4249 - val_accuracy30: 0.4045 - val_accuracy50: 0.3890 - 40s/epoch - 52ms/step
testing model: results/PCAR/W0/deepLOB_L2/seq2seq
Evaluating performance on  test set...
1733/1733 - 36s - 36s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0713707
{'0': {'precision': 0.4300643229521099, 'recall': 0.5036940008871147, 'f1-score': 0.46397620012832014, 'support': 144288}, '1': {'precision': 0.4519533538371412, 'recall': 0.3219401826990161, 'f1-score': 0.37602574110389736, 'support': 153367}, '2': {'precision': 0.4320608931888451, 'recall': 0.48957540604838984, 'f1-score': 0.4590235592839006, 'support': 145857}, 'accuracy': 0.43620014791031586, 'macro avg': {'precision': 0.4380261899926987, 'recall': 0.4384031965448402, 'f1-score': 0.4330085001720394, 'support': 443512}, 'weighted avg': {'precision': 0.43829018548742815, 'recall': 0.43620014791031586, 'f1-score': 0.4319340560942395, 'support': 443512}}
[[72677 27836 43775]
 [53902 49375 50090]
 [42412 32037 71408]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0789126
{'0': {'precision': 0.40829596029244997, 'recall': 0.504609512004451, 'f1-score': 0.4513720895071061, 'support': 141989}, '1': {'precision': 0.4443410040826618, 'recall': 0.291333125631847, 'f1-score': 0.35192552880996636, 'support': 157277}, '2': {'precision': 0.4148626523558305, 'recall': 0.4742939145626222, 'f1-score': 0.44259208943057876, 'support': 144246}, 'accuracy': 0.4191183102148307, 'macro avg': {'precision': 0.42249987224364743, 'recall': 0.42341218406630676, 'f1-score': 0.41529656924921704, 'support': 443512}, 'weighted avg': {'precision': 0.42321387776834135, 'recall': 0.4191183102148307, 'f1-score': 0.4132510541849439, 'support': 443512}}
[[71649 26648 43692]
 [58654 45820 52803]
 [45180 30651 68415]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0811622
{'0': {'precision': 0.3939314717988653, 'recall': 0.5007247042853001, 'f1-score': 0.44095424588362386, 'support': 141437}, '1': {'precision': 0.4328165898991539, 'recall': 0.2716171217918924, 'f1-score': 0.33377277225979834, 'support': 157063}, '2': {'precision': 0.4078866110458569, 'recall': 0.4645753454886492, 'f1-score': 0.4343892861518225, 'support': 145012}, 'accuracy': 0.4077702519886722, 'macro avg': {'precision': 0.4115448909146253, 'recall': 0.4123057238552806, 'f1-score': 0.40303876809841493, 'support': 443512}, 'weighted avg': {'precision': 0.4122648561417249, 'recall': 0.4077702519886722, 'f1-score': 0.40085106551329136, 'support': 443512}}
[[70821 25956 44660]
 [61265 42661 53137]
 [47694 29949 67369]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0865384
{'0': {'precision': 0.35590040647061727, 'recall': 0.48714213849700044, 'f1-score': 0.4113056598032255, 'support': 133187}, '1': {'precision': 0.4708905534748231, 'recall': 0.26055020521883293, 'f1-score': 0.33547660254153433, 'support': 173717}, '2': {'precision': 0.37533844970349683, 'recall': 0.4535971539002108, 'f1-score': 0.4107736518848256, 'support': 136608}, 'accuracy': 0.38805714388787677, 'macro avg': {'precision': 0.4007098032163124, 'recall': 0.4004298325386814, 'f1-score': 0.38585197140986177, 'support': 443512}, 'weighted avg': {'precision': 0.4069275163956855, 'recall': 0.38805714388787677, 'f1-score': 0.3814406891191268, 'support': 443512}}
[[64881 24457 43849]
 [69178 45262 59277]
 [48242 26401 61965]]
Evaluating performance on  train set...
765/765 - 16s - 16s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0399818
{'0': {'precision': 0.4738886656333123, 'recall': 0.3795888962123883, 'f1-score': 0.4215292435487165, 'support': 65239}, '1': {'precision': 0.4821382153069182, 'recall': 0.402751496727363, 'f1-score': 0.4388838184092215, 'support': 64474}, '2': {'precision': 0.4360673292507446, 'recall': 0.5918608348094654, 'f1-score': 0.5021579961464354, 'support': 66051}, 'accuracy': 0.4588381929261764, 'macro avg': {'precision': 0.46403140339699167, 'recall': 0.45806707591640555, 'f1-score': 0.45419035270145774, 'support': 195764}, 'weighted avg': {'precision': 0.4638446553773463, 'recall': 0.4588381929261764, 'f1-score': 0.45444912972486806, 'support': 195764}}
[[24764 14824 25651]
 [13602 25967 24905]
 [13891 13067 39093]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0565287
{'0': {'precision': 0.44810117355492385, 'recall': 0.3773440137495013, 'f1-score': 0.40968994185368457, 'support': 65166}, '1': {'precision': 0.4559446317935848, 'recall': 0.362148441149905, 'f1-score': 0.40366956551927646, 'support': 64214}, '2': {'precision': 0.42234435494637534, 'recall': 0.5718546637744034, 'f1-score': 0.485857629201116, 'support': 66384}, 'accuracy': 0.4383185876872152, 'macro avg': {'precision': 0.442130053431628, 'recall': 0.4371157062246032, 'f1-score': 0.4330723788580257, 'support': 195764}, 'weighted avg': {'precision': 0.44193977095192993, 'recall': 0.4383185876872152, 'f1-score': 0.43354378275872435, 'support': 195764}}
[[24590 14510 26066]
 [15103 23255 25856]
 [15183 13239 37962]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0668607
{'0': {'precision': 0.429844176423981, 'recall': 0.37705221863561245, 'f1-score': 0.40172121571144126, 'support': 64747}, '1': {'precision': 0.44002212298742266, 'recall': 0.33199387972736966, 'f1-score': 0.37844980223923325, 'support': 64703}, '2': {'precision': 0.40919124579871546, 'recall': 0.5562777090810387, 'f1-score': 0.47153037420509375, 'support': 66314}, 'accuracy': 0.4228714166036656, 'macro avg': {'precision': 0.42635251507003974, 'recall': 0.42177460248134024, 'f1-score': 0.41723379738525607, 'support': 195764}, 'weighted avg': {'precision': 0.42621207468418465, 'recall': 0.4228714166036656, 'f1-score': 0.41767713340037177, 'support': 195764}}
[[24413 14116 26218]
 [16178 21481 27044]
 [16204 13221 36889]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0774912
{'0': {'precision': 0.4058580277630021, 'recall': 0.3654553320354748, 'f1-score': 0.38459849919919353, 'support': 64722}, '1': {'precision': 0.4257857112643289, 'recall': 0.3112842873488573, 'f1-score': 0.3596412876487191, 'support': 64674}, '2': {'precision': 0.39604004301409046, 'recall': 0.538271456123433, 'f1-score': 0.4563297162309751, 'support': 66368}, 'accuracy': 0.4061471976461454, 'macro avg': {'precision': 0.4092279273471405, 'recall': 0.40500369183592166, 'f1-score': 0.4001898343596293, 'support': 195764}, 'weighted avg': {'precision': 0.4091129826625191, 'recall': 0.4061471976461454, 'f1-score': 0.40067180538495745, 'support': 195764}}
[[23653 13818 27251]
 [17314 20132 27228]
 [17312 13332 35724]]
Evaluating performance on  val set...
253/253 - 5s - 5s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0479778
{'0': {'precision': 0.47394933793897526, 'recall': 0.30672503725782413, 'f1-score': 0.37242705270300835, 'support': 21472}, '1': {'precision': 0.5365116669464496, 'recall': 0.30370124008172183, 'f1-score': 0.3878523103061194, 'support': 21047}, '2': {'precision': 0.4218412665775676, 'recall': 0.7393576287220145, 'f1-score': 0.5371888654327654, 'support': 22199}, 'accuracy': 0.45413949751228405, 'macro avg': {'precision': 0.47743409048766416, 'recall': 0.4499279686871868, 'f1-score': 0.4324894094806311, 'support': 64718}, 'weighted avg': {'precision': 0.4764216371829016, 'recall': 0.45413949751228405, 'f1-score': 0.4339586648906618, 'support': 64718}}
[[ 6586  2909 11977]
 [ 4137  6392 10518]
 [ 3173  2613 16413]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0638969
{'0': {'precision': 0.44966442953020136, 'recall': 0.303068457377355, 'f1-score': 0.36209153968298186, 'support': 21444}, '1': {'precision': 0.5050103818723481, 'recall': 0.26165863698021424, 'f1-score': 0.34471284200147895, 'support': 21379}, '2': {'precision': 0.4045881392262938, 'recall': 0.7241379310344828, 'f1-score': 0.5191297087569372, 'support': 21895}, 'accuracy': 0.4318427639914707, 'macro avg': {'precision': 0.45308765020961445, 'recall': 0.429621675130684, 'f1-score': 0.40864469681379934, 'support': 64718}, 'weighted avg': {'precision': 0.4526975229341802, 'recall': 0.4318427639914707, 'f1-score': 0.409478843588254, 'support': 64718}}
[[ 6499  2854 12091]
 [ 4543  5594 11242]
 [ 3411  2629 15855]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0766784
{'0': {'precision': 0.4295229765188724, 'recall': 0.30205819730305183, 'f1-score': 0.3546863714650815, 'support': 21135}, '1': {'precision': 0.4796174652241113, 'recall': 0.22515985669584146, 'f1-score': 0.3064531061938709, 'support': 22051}, '2': {'precision': 0.38683137989519784, 'recall': 0.7096879063719116, 'f1-score': 0.5007290898664701, 'support': 21532}, 'accuracy': 0.41147748694335423, 'macro avg': {'precision': 0.43199060721272714, 'recall': 0.41230198679026825, 'f1-score': 0.3872895225084741, 'support': 64718}, 'weighted avg': {'precision': 0.432387683585504, 'recall': 0.41147748694335423, 'f1-score': 0.38684126006057634, 'support': 64718}}
[[ 6384  2741 12010]
 [ 4874  4965 12212]
 [ 3605  2646 15281]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0870707
{'0': {'precision': 0.39857161577774863, 'recall': 0.28643405377407355, 'f1-score': 0.3333242006630318, 'support': 21237}, '1': {'precision': 0.43821475559153933, 'recall': 0.19573275472380436, 'f1-score': 0.2705996312845671, 'support': 22122}, '2': {'precision': 0.37205306380290587, 'recall': 0.6893581160166674, 'f1-score': 0.48327698821675913, 'support': 21359}, 'accuracy': 0.3884081708334621, 'macro avg': {'precision': 0.4029464783907313, 'recall': 0.3905083081715151, 'f1-score': 0.3624002733881193, 'support': 64718}, 'weighted avg': {'precision': 0.4033705246953606, 'recall': 0.3884081708334621, 'f1-score': 0.36137279094038377, 'support': 64718}}
[[ 6083  2789 12365]
 [ 5306  4330 12486]
 [ 3873  2762 14724]]
training model: results/PCAR/W0/deepOF_L2/seq2seq
Epoch 1/50
765/765 - 32s - loss: 12.9643 - accuracy10: 0.4223 - accuracy20: 0.4055 - accuracy30: 0.3903 - accuracy50: 0.3738 - val_loss: 12.9191 - val_accuracy10: 0.4329 - val_accuracy20: 0.4109 - val_accuracy30: 0.3931 - val_accuracy50: 0.3731 - 32s/epoch - 42ms/step
Epoch 2/50
765/765 - 27s - loss: 12.6444 - accuracy10: 0.4737 - accuracy20: 0.4476 - accuracy30: 0.4243 - accuracy50: 0.4010 - val_loss: 12.7873 - val_accuracy10: 0.4578 - val_accuracy20: 0.4271 - val_accuracy30: 0.4017 - val_accuracy50: 0.3797 - 27s/epoch - 36ms/step
Epoch 3/50
765/765 - 28s - loss: 12.5386 - accuracy10: 0.4871 - accuracy20: 0.4585 - accuracy30: 0.4349 - accuracy50: 0.4092 - val_loss: 12.7095 - val_accuracy10: 0.4747 - val_accuracy20: 0.4385 - val_accuracy30: 0.4107 - val_accuracy50: 0.3827 - 28s/epoch - 36ms/step
Epoch 4/50
765/765 - 27s - loss: 12.4618 - accuracy10: 0.4970 - accuracy20: 0.4679 - accuracy30: 0.4416 - accuracy50: 0.4147 - val_loss: 12.6512 - val_accuracy10: 0.4813 - val_accuracy20: 0.4475 - val_accuracy30: 0.4203 - val_accuracy50: 0.3894 - 27s/epoch - 35ms/step
Epoch 5/50
765/765 - 26s - loss: 12.4107 - accuracy10: 0.5024 - accuracy20: 0.4729 - accuracy30: 0.4471 - accuracy50: 0.4187 - val_loss: 12.6197 - val_accuracy10: 0.4858 - val_accuracy20: 0.4501 - val_accuracy30: 0.4221 - val_accuracy50: 0.3890 - 26s/epoch - 34ms/step
Epoch 6/50
765/765 - 27s - loss: 12.3708 - accuracy10: 0.5062 - accuracy20: 0.4770 - accuracy30: 0.4505 - accuracy50: 0.4219 - val_loss: 12.6060 - val_accuracy10: 0.4871 - val_accuracy20: 0.4526 - val_accuracy30: 0.4206 - val_accuracy50: 0.3902 - 27s/epoch - 35ms/step
Epoch 7/50
765/765 - 26s - loss: 12.3371 - accuracy10: 0.5089 - accuracy20: 0.4799 - accuracy30: 0.4539 - accuracy50: 0.4249 - val_loss: 12.5971 - val_accuracy10: 0.4877 - val_accuracy20: 0.4522 - val_accuracy30: 0.4222 - val_accuracy50: 0.3919 - 26s/epoch - 34ms/step
Epoch 8/50
765/765 - 26s - loss: 12.3126 - accuracy10: 0.5103 - accuracy20: 0.4819 - accuracy30: 0.4554 - accuracy50: 0.4278 - val_loss: 12.5810 - val_accuracy10: 0.4893 - val_accuracy20: 0.4523 - val_accuracy30: 0.4229 - val_accuracy50: 0.3942 - 26s/epoch - 34ms/step
Epoch 9/50
765/765 - 26s - loss: 12.2842 - accuracy10: 0.5133 - accuracy20: 0.4853 - accuracy30: 0.4589 - accuracy50: 0.4298 - val_loss: 12.5706 - val_accuracy10: 0.4914 - val_accuracy20: 0.4539 - val_accuracy30: 0.4232 - val_accuracy50: 0.3939 - 26s/epoch - 34ms/step
Epoch 10/50
765/765 - 26s - loss: 12.2609 - accuracy10: 0.5146 - accuracy20: 0.4867 - accuracy30: 0.4593 - accuracy50: 0.4307 - val_loss: 12.5758 - val_accuracy10: 0.4892 - val_accuracy20: 0.4531 - val_accuracy30: 0.4233 - val_accuracy50: 0.3930 - 26s/epoch - 33ms/step
Epoch 11/50
765/765 - 26s - loss: 12.2453 - accuracy10: 0.5167 - accuracy20: 0.4885 - accuracy30: 0.4619 - accuracy50: 0.4325 - val_loss: 12.5678 - val_accuracy10: 0.4910 - val_accuracy20: 0.4548 - val_accuracy30: 0.4267 - val_accuracy50: 0.3961 - 26s/epoch - 34ms/step
Epoch 12/50
765/765 - 26s - loss: 12.2201 - accuracy10: 0.5178 - accuracy20: 0.4896 - accuracy30: 0.4640 - accuracy50: 0.4362 - val_loss: 12.5769 - val_accuracy10: 0.4898 - val_accuracy20: 0.4521 - val_accuracy30: 0.4231 - val_accuracy50: 0.3939 - 26s/epoch - 34ms/step
Epoch 13/50
765/765 - 26s - loss: 12.1973 - accuracy10: 0.5195 - accuracy20: 0.4916 - accuracy30: 0.4656 - accuracy50: 0.4377 - val_loss: 12.5556 - val_accuracy10: 0.4912 - val_accuracy20: 0.4562 - val_accuracy30: 0.4252 - val_accuracy50: 0.3967 - 26s/epoch - 34ms/step
Epoch 14/50
765/765 - 26s - loss: 12.1798 - accuracy10: 0.5205 - accuracy20: 0.4932 - accuracy30: 0.4682 - accuracy50: 0.4388 - val_loss: 12.5671 - val_accuracy10: 0.4912 - val_accuracy20: 0.4545 - val_accuracy30: 0.4259 - val_accuracy50: 0.3972 - 26s/epoch - 34ms/step
Epoch 15/50
765/765 - 26s - loss: 12.1604 - accuracy10: 0.5216 - accuracy20: 0.4947 - accuracy30: 0.4688 - accuracy50: 0.4409 - val_loss: 12.5715 - val_accuracy10: 0.4903 - val_accuracy20: 0.4540 - val_accuracy30: 0.4268 - val_accuracy50: 0.3969 - 26s/epoch - 34ms/step
Epoch 16/50
765/765 - 26s - loss: 12.1386 - accuracy10: 0.5237 - accuracy20: 0.4963 - accuracy30: 0.4708 - accuracy50: 0.4429 - val_loss: 12.5918 - val_accuracy10: 0.4863 - val_accuracy20: 0.4536 - val_accuracy30: 0.4220 - val_accuracy50: 0.3941 - 26s/epoch - 34ms/step
Epoch 17/50
765/765 - 26s - loss: 12.1184 - accuracy10: 0.5244 - accuracy20: 0.4981 - accuracy30: 0.4735 - accuracy50: 0.4448 - val_loss: 12.5510 - val_accuracy10: 0.4907 - val_accuracy20: 0.4545 - val_accuracy30: 0.4270 - val_accuracy50: 0.3991 - 26s/epoch - 34ms/step
Epoch 18/50
765/765 - 26s - loss: 12.0945 - accuracy10: 0.5259 - accuracy20: 0.5007 - accuracy30: 0.4754 - accuracy50: 0.4465 - val_loss: 12.5753 - val_accuracy10: 0.4910 - val_accuracy20: 0.4533 - val_accuracy30: 0.4231 - val_accuracy50: 0.3958 - 26s/epoch - 34ms/step
Epoch 19/50
765/765 - 26s - loss: 12.0720 - accuracy10: 0.5280 - accuracy20: 0.5021 - accuracy30: 0.4773 - accuracy50: 0.4490 - val_loss: 12.6139 - val_accuracy10: 0.4859 - val_accuracy20: 0.4518 - val_accuracy30: 0.4217 - val_accuracy50: 0.3948 - 26s/epoch - 34ms/step
Epoch 20/50
765/765 - 26s - loss: 12.0543 - accuracy10: 0.5280 - accuracy20: 0.5032 - accuracy30: 0.4778 - accuracy50: 0.4507 - val_loss: 12.6039 - val_accuracy10: 0.4886 - val_accuracy20: 0.4522 - val_accuracy30: 0.4241 - val_accuracy50: 0.3956 - 26s/epoch - 34ms/step
Epoch 21/50
765/765 - 25s - loss: 12.0282 - accuracy10: 0.5297 - accuracy20: 0.5047 - accuracy30: 0.4816 - accuracy50: 0.4541 - val_loss: 12.6091 - val_accuracy10: 0.4890 - val_accuracy20: 0.4540 - val_accuracy30: 0.4236 - val_accuracy50: 0.3955 - 25s/epoch - 33ms/step
Epoch 22/50
765/765 - 26s - loss: 12.0085 - accuracy10: 0.5317 - accuracy20: 0.5079 - accuracy30: 0.4834 - accuracy50: 0.4559 - val_loss: 12.6290 - val_accuracy10: 0.4878 - val_accuracy20: 0.4519 - val_accuracy30: 0.4225 - val_accuracy50: 0.3942 - 26s/epoch - 34ms/step
Epoch 23/50
765/765 - 26s - loss: 11.9888 - accuracy10: 0.5326 - accuracy20: 0.5086 - accuracy30: 0.4844 - accuracy50: 0.4572 - val_loss: 12.6179 - val_accuracy10: 0.4870 - val_accuracy20: 0.4525 - val_accuracy30: 0.4234 - val_accuracy50: 0.3963 - 26s/epoch - 34ms/step
Epoch 24/50
765/765 - 26s - loss: 11.9633 - accuracy10: 0.5336 - accuracy20: 0.5103 - accuracy30: 0.4874 - accuracy50: 0.4602 - val_loss: 12.6069 - val_accuracy10: 0.4883 - val_accuracy20: 0.4521 - val_accuracy30: 0.4231 - val_accuracy50: 0.3953 - 26s/epoch - 34ms/step
Epoch 25/50
765/765 - 26s - loss: 11.9433 - accuracy10: 0.5344 - accuracy20: 0.5126 - accuracy30: 0.4899 - accuracy50: 0.4621 - val_loss: 12.6196 - val_accuracy10: 0.4902 - val_accuracy20: 0.4533 - val_accuracy30: 0.4225 - val_accuracy50: 0.3956 - 26s/epoch - 34ms/step
Epoch 26/50
765/765 - 26s - loss: 11.9181 - accuracy10: 0.5357 - accuracy20: 0.5140 - accuracy30: 0.4912 - accuracy50: 0.4660 - val_loss: 12.6568 - val_accuracy10: 0.4859 - val_accuracy20: 0.4491 - val_accuracy30: 0.4192 - val_accuracy50: 0.3940 - 26s/epoch - 34ms/step
Epoch 27/50
765/765 - 26s - loss: 11.8964 - accuracy10: 0.5360 - accuracy20: 0.5158 - accuracy30: 0.4939 - accuracy50: 0.4679 - val_loss: 12.6925 - val_accuracy10: 0.4845 - val_accuracy20: 0.4467 - val_accuracy30: 0.4155 - val_accuracy50: 0.3935 - 26s/epoch - 34ms/step
testing model: results/PCAR/W0/deepOF_L2/seq2seq
Evaluating performance on  test set...
1733/1733 - 25s - 25s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0262101
{'0': {'precision': 0.43456031649676596, 'recall': 0.5755305435038742, 'f1-score': 0.4952083917251579, 'support': 144286}, '1': {'precision': 0.5175968193196878, 'recall': 0.3667044846967385, 'f1-score': 0.42927693094472985, 'support': 153366}, '2': {'precision': 0.48303758373388794, 'recall': 0.47609612286174624, 'f1-score': 0.47954173486088375, 'support': 145855}, 'accuracy': 0.4706171492219965, 'macro avg': {'precision': 0.47839823985011387, 'recall': 0.4727770503541196, 'f1-score': 0.4680090191769238, 'support': 443507}, 'weighted avg': {'precision': 0.47921717220549354, 'recall': 0.4706171492219965, 'f1-score': 0.4672568494699289, 'support': 443507}}
[[83041 24412 36833]
 [59641 56240 37485]
 [48410 28004 69441]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0528175
{'0': {'precision': 0.40995283327544463, 'recall': 0.5735776766723479, 'f1-score': 0.4781545488972326, 'support': 141986}, '1': {'precision': 0.494733527342223, 'recall': 0.2896881914595997, 'f1-score': 0.36541176093163513, 'support': 157276}, '2': {'precision': 0.44878827950090994, 'recall': 0.47527470622898543, 'f1-score': 0.4616519025060353, 'support': 144245}, 'accuracy': 0.44093328853885055, 'macro avg': {'precision': 0.45115821337285916, 'recall': 0.44618019145364435, 'f1-score': 0.43507273744496766, 'support': 443507}, 'weighted avg': {'precision': 0.4526484105286534, 'recall': 0.44093328853885055, 'f1-score': 0.4328065409767814, 'support': 443507}}
[[81440 21881 38665]
 [66178 45561 45537]
 [51039 24650 68556]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0646751
{'0': {'precision': 0.39335078585173827, 'recall': 0.5694316783800217, 'f1-score': 0.46528973366456755, 'support': 141434}, '1': {'precision': 0.46620994101967217, 'recall': 0.24609869924807243, 'f1-score': 0.3221459170236528, 'support': 157063}, '2': {'precision': 0.4321471652593486, 'recall': 0.4644576236121647, 'f1-score': 0.44772021724245664, 'support': 145010}, 'accuracy': 0.42060440985147923, 'macro avg': {'precision': 0.43056929737691974, 'recall': 0.4266626670800863, 'f1-score': 0.41171862264355896, 'support': 443507}, 'weighted avg': {'precision': 0.43183798101672727, 'recall': 0.42060440985147923, 'f1-score': 0.40885239930582623, 'support': 443507}}
[[80537 21273 39624]
 [69533 38653 48877]
 [54676 22983 67351]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0765208
{'0': {'precision': 0.3547951552714573, 'recall': 0.5346888515136954, 'f1-score': 0.42655070276163015, 'support': 133184}, '1': {'precision': 0.48886677838290743, 'recall': 0.2686971839093693, 'f1-score': 0.34678821379218117, 'support': 173716}, '2': {'precision': 0.3933095293047504, 'recall': 0.4241363912537425, 'f1-score': 0.4081417013887666, 'support': 136607}, 'accuracy': 0.39645146525308506, 'macro avg': {'precision': 0.4123238209863717, 'recall': 0.4091741422256024, 'f1-score': 0.393826872647526, 'support': 443507}, 'weighted avg': {'precision': 0.4191723109285151, 'recall': 0.39645146525308506, 'f1-score': 0.38963850298945163, 'support': 443507}}
[[71212 24439 37533]
 [75198 46677 51841]
 [54303 24364 57940]]
Evaluating performance on  train set...
765/765 - 12s - 12s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.97994876
{'0': {'precision': 0.4833167838731178, 'recall': 0.5450111204846998, 'f1-score': 0.5123132821962051, 'support': 65195}, '1': {'precision': 0.5495282617934552, 'recall': 0.5029092379974486, 'f1-score': 0.5251862261683305, 'support': 64278}, '2': {'precision': 0.519993062344297, 'recall': 0.4974883468344119, 'f1-score': 0.5084918242581701, 'support': 66291}, 'accuracy': 0.5150947058703337, 'macro avg': {'precision': 0.51761270267029, 'recall': 0.5151362351055201, 'f1-score': 0.5153304442075686, 'support': 195764}, 'weighted avg': {'precision': 0.5174765300669859, 'recall': 0.5150947058703337, 'f1-score': 0.515245991092989, 'support': 195764}}
[[35532 12663 17000]
 [18509 32326 13443]
 [19476 13836 32979]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0149459
{'0': {'precision': 0.4605804763219842, 'recall': 0.5368661475259059, 'f1-score': 0.49580611139817515, 'support': 65236}, '1': {'precision': 0.5142050268285795, 'recall': 0.4266500039053347, 'f1-score': 0.4663536241782634, 'support': 64015}, '2': {'precision': 0.491487509007927, 'recall': 0.4921894967901012, 'f1-score': 0.4918382524169741, 'support': 66513}, 'accuracy': 0.4856459818965693, 'macro avg': {'precision': 0.4887576707194969, 'recall': 0.48523521607378056, 'f1-score': 0.4846659959978042, 'support': 195764}, 'weighted avg': {'precision': 0.4886167601418888, 'recall': 0.4856459818965693, 'f1-score': 0.48482699790540185, 'support': 195764}}
[[35023 12442 17771]
 [20603 27312 16100]
 [20415 13361 32737]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.039013
{'0': {'precision': 0.4363277268093782, 'recall': 0.5283924327994322, 'f1-score': 0.47796714263780127, 'support': 64806}, '1': {'precision': 0.4767740898497147, 'recall': 0.3679697312719999, 'f1-score': 0.4153648226428965, 'support': 64489}, '2': {'precision': 0.47265671288067307, 'recall': 0.48007341768343137, 'f1-score': 0.47633619692344437, 'support': 66469}, 'accuracy': 0.4591395762244335, 'macro avg': {'precision': 0.4619195098465887, 'recall': 0.4588118605849545, 'f1-score': 0.45655605406804733, 'support': 195764}, 'weighted avg': {'precision': 0.461986667581334, 'recall': 0.4591395762244335, 'f1-score': 0.4567907856730938, 'support': 195764}}
[[34243 12740 17823]
 [22980 23730 17779]
 [21257 13302 31910]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0643958
{'0': {'precision': 0.40801088858642814, 'recall': 0.48663440577603934, 'f1-score': 0.4438678380550816, 'support': 64681}, '1': {'precision': 0.42324176718447654, 'recall': 0.3621957070120866, 'f1-score': 0.3903464149307003, 'support': 64617}, '2': {'precision': 0.44919617194655886, 'recall': 0.4279481238527969, 'f1-score': 0.43831479027336884, 'support': 66466}, 'accuracy': 0.42563494820293823, 'macro avg': {'precision': 0.42681627590582116, 'recall': 0.4255927455469743, 'f1-score': 0.42417634775305024, 'support': 195764}, 'weighted avg': {'precision': 0.42702150711784626, 'recall': 0.42563494820293823, 'f1-score': 0.4243163236199073, 'support': 195764}}
[[31476 15933 17272]
 [23607 23404 17606]
 [22062 15960 28444]]
Evaluating performance on  val set...
253/253 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0040709
{'0': {'precision': 0.4482969244035642, 'recall': 0.5815427639244931, 'f1-score': 0.5062998356564612, 'support': 21455}, '1': {'precision': 0.5606563657259609, 'recall': 0.4174669582580584, 'f1-score': 0.4785807717462394, 'support': 21034}, '2': {'precision': 0.5000942329438371, 'recall': 0.47748436726798327, 'f1-score': 0.48852783467194444, 'support': 22229}, 'accuracy': 0.49247504558237276, 'macro avg': {'precision': 0.5030158410244541, 'recall': 0.4921646964835116, 'f1-score': 0.491136147358215, 'support': 64718}, 'weighted avg': {'precision': 0.5026059398292112, 'recall': 0.49247504558237276, 'f1-score': 0.491186627581854, 'support': 64718}}
[[12477  3077  5901]
 [ 7544  8781  4709]
 [ 7811  3804 10614]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0393766
{'0': {'precision': 0.4232047642130046, 'recall': 0.5714619664313432, 'f1-score': 0.48628433888325273, 'support': 21389}, '1': {'precision': 0.5259518143961928, 'recall': 0.3293750582099283, 'f1-score': 0.4050741652826299, 'support': 21474}, '2': {'precision': 0.45904055744148653, 'recall': 0.4702356440173873, 'f1-score': 0.46457066654612034, 'support': 21855}, 'accuracy': 0.4569516981365308, 'macro avg': {'precision': 0.469399045350228, 'recall': 0.4570242228862196, 'f1-score': 0.4519763902373343, 'support': 64718}, 'weighted avg': {'precision': 0.4693987352356298, 'recall': 0.4569516981365308, 'f1-score': 0.4520054740106083, 'support': 64718}}
[[12223  2918  6248]
 [ 8538  7073  5863]
 [ 8121  3457 10277]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0608059
{'0': {'precision': 0.39914996151400556, 'recall': 0.5634182058670698, 'f1-score': 0.4672673849167483, 'support': 21169}, '1': {'precision': 0.49357965371551654, 'recall': 0.27063365886895296, 'f1-score': 0.34958634043302234, 'support': 22015}, '2': {'precision': 0.43182816480716857, 'recall': 0.45653385344106995, 'f1-score': 0.44383747178329563, 'support': 21534}, 'accuracy': 0.4282579807781452, 'macro avg': {'precision': 0.44151926001223024, 'recall': 0.43019523939236426, 'f1-score': 0.42023039904435544, 'support': 64718}, 'weighted avg': {'precision': 0.4421451421983783, 'recall': 0.4282579807781452, 'f1-score': 0.4194400734466009, 'support': 64718}}
[[11927  2865  6377]
 [ 9499  5958  6558]
 [ 8455  3248  9831]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.079797
{'0': {'precision': 0.3764523101864361, 'recall': 0.5260028315243039, 'f1-score': 0.4388361746525454, 'support': 21190}, '1': {'precision': 0.4263668430335097, 'recall': 0.2624508074365586, 'f1-score': 0.3249055018899622, 'support': 22107}, '2': {'precision': 0.40824109385173474, 'recall': 0.4097847906260212, 'f1-score': 0.4090114856836661, 'support': 21421}, 'accuracy': 0.39750919373281, 'macro avg': {'precision': 0.4036867490238935, 'recall': 0.3994128098622946, 'f1-score': 0.39091772074205783, 'support': 64718}, 'weighted avg': {'precision': 0.40402436297769384, 'recall': 0.39750919373281, 'f1-score': 0.390046965388279, 'support': 64718}}
[[11146  3794  6250]
 [ 9831  5802  6474]
 [ 8631  4012  8778]]
training model: results/PCAR/W0/deepVOL_L2/seq2seq
Epoch 1/50
765/765 - 31s - loss: 13.0536 - accuracy10: 0.4057 - accuracy20: 0.3950 - accuracy30: 0.3859 - accuracy50: 0.3789 - val_loss: 13.1388 - val_accuracy10: 0.4043 - val_accuracy20: 0.3853 - val_accuracy30: 0.3609 - val_accuracy50: 0.3420 - 31s/epoch - 41ms/step
Epoch 2/50
765/765 - 25s - loss: 12.8409 - accuracy10: 0.4418 - accuracy20: 0.4238 - accuracy30: 0.4052 - accuracy50: 0.3890 - val_loss: 12.9827 - val_accuracy10: 0.4306 - val_accuracy20: 0.4081 - val_accuracy30: 0.3877 - val_accuracy50: 0.3712 - 25s/epoch - 33ms/step
Epoch 3/50
765/765 - 25s - loss: 12.6822 - accuracy10: 0.4699 - accuracy20: 0.4467 - accuracy30: 0.4251 - accuracy50: 0.4053 - val_loss: 12.9166 - val_accuracy10: 0.4395 - val_accuracy20: 0.4182 - val_accuracy30: 0.3933 - val_accuracy50: 0.3745 - 25s/epoch - 33ms/step
Epoch 4/50
765/765 - 25s - loss: 12.5968 - accuracy10: 0.4810 - accuracy20: 0.4556 - accuracy30: 0.4328 - accuracy50: 0.4118 - val_loss: 12.8284 - val_accuracy10: 0.4523 - val_accuracy20: 0.4247 - val_accuracy30: 0.3987 - val_accuracy50: 0.3846 - 25s/epoch - 32ms/step
Epoch 5/50
765/765 - 25s - loss: 12.5421 - accuracy10: 0.4886 - accuracy20: 0.4599 - accuracy30: 0.4357 - accuracy50: 0.4161 - val_loss: 12.7475 - val_accuracy10: 0.4653 - val_accuracy20: 0.4380 - val_accuracy30: 0.4096 - val_accuracy50: 0.3920 - 25s/epoch - 33ms/step
Epoch 6/50
765/765 - 25s - loss: 12.4981 - accuracy10: 0.4925 - accuracy20: 0.4633 - accuracy30: 0.4378 - accuracy50: 0.4198 - val_loss: 12.7391 - val_accuracy10: 0.4653 - val_accuracy20: 0.4360 - val_accuracy30: 0.4094 - val_accuracy50: 0.3966 - 25s/epoch - 33ms/step
Epoch 7/50
765/765 - 25s - loss: 12.4623 - accuracy10: 0.4972 - accuracy20: 0.4674 - accuracy30: 0.4411 - accuracy50: 0.4225 - val_loss: 12.7182 - val_accuracy10: 0.4736 - val_accuracy20: 0.4391 - val_accuracy30: 0.4087 - val_accuracy50: 0.3947 - 25s/epoch - 33ms/step
Epoch 8/50
765/765 - 26s - loss: 12.4303 - accuracy10: 0.5003 - accuracy20: 0.4698 - accuracy30: 0.4428 - accuracy50: 0.4243 - val_loss: 12.6989 - val_accuracy10: 0.4776 - val_accuracy20: 0.4405 - val_accuracy30: 0.4098 - val_accuracy50: 0.3968 - 26s/epoch - 33ms/step
Epoch 9/50
765/765 - 25s - loss: 12.4070 - accuracy10: 0.5021 - accuracy20: 0.4727 - accuracy30: 0.4450 - accuracy50: 0.4258 - val_loss: 12.6937 - val_accuracy10: 0.4756 - val_accuracy20: 0.4402 - val_accuracy30: 0.4087 - val_accuracy50: 0.3967 - 25s/epoch - 33ms/step
Epoch 10/50
765/765 - 25s - loss: 12.3828 - accuracy10: 0.5046 - accuracy20: 0.4746 - accuracy30: 0.4468 - accuracy50: 0.4278 - val_loss: 12.6722 - val_accuracy10: 0.4803 - val_accuracy20: 0.4446 - val_accuracy30: 0.4090 - val_accuracy50: 0.3948 - 25s/epoch - 33ms/step
Epoch 11/50
765/765 - 25s - loss: 12.3627 - accuracy10: 0.5061 - accuracy20: 0.4767 - accuracy30: 0.4483 - accuracy50: 0.4289 - val_loss: 12.6272 - val_accuracy10: 0.4870 - val_accuracy20: 0.4501 - val_accuracy30: 0.4169 - val_accuracy50: 0.3993 - 25s/epoch - 33ms/step
Epoch 12/50
765/765 - 25s - loss: 12.3430 - accuracy10: 0.5085 - accuracy20: 0.4791 - accuracy30: 0.4504 - accuracy50: 0.4293 - val_loss: 12.6270 - val_accuracy10: 0.4848 - val_accuracy20: 0.4478 - val_accuracy30: 0.4165 - val_accuracy50: 0.4007 - 25s/epoch - 33ms/step
Epoch 13/50
765/765 - 25s - loss: 12.3234 - accuracy10: 0.5102 - accuracy20: 0.4803 - accuracy30: 0.4520 - accuracy50: 0.4318 - val_loss: 12.6254 - val_accuracy10: 0.4863 - val_accuracy20: 0.4491 - val_accuracy30: 0.4160 - val_accuracy50: 0.3992 - 25s/epoch - 33ms/step
Epoch 14/50
765/765 - 25s - loss: 12.3072 - accuracy10: 0.5121 - accuracy20: 0.4820 - accuracy30: 0.4531 - accuracy50: 0.4319 - val_loss: 12.6527 - val_accuracy10: 0.4836 - val_accuracy20: 0.4464 - val_accuracy30: 0.4153 - val_accuracy50: 0.3986 - 25s/epoch - 33ms/step
Epoch 15/50
765/765 - 25s - loss: 12.2919 - accuracy10: 0.5132 - accuracy20: 0.4836 - accuracy30: 0.4542 - accuracy50: 0.4324 - val_loss: 12.6257 - val_accuracy10: 0.4872 - val_accuracy20: 0.4490 - val_accuracy30: 0.4161 - val_accuracy50: 0.3985 - 25s/epoch - 33ms/step
Epoch 16/50
765/765 - 25s - loss: 12.2816 - accuracy10: 0.5135 - accuracy20: 0.4841 - accuracy30: 0.4552 - accuracy50: 0.4335 - val_loss: 12.6281 - val_accuracy10: 0.4872 - val_accuracy20: 0.4475 - val_accuracy30: 0.4145 - val_accuracy50: 0.3994 - 25s/epoch - 33ms/step
Epoch 17/50
765/765 - 25s - loss: 12.2714 - accuracy10: 0.5156 - accuracy20: 0.4851 - accuracy30: 0.4569 - accuracy50: 0.4345 - val_loss: 12.6205 - val_accuracy10: 0.4895 - val_accuracy20: 0.4514 - val_accuracy30: 0.4176 - val_accuracy50: 0.3988 - 25s/epoch - 33ms/step
Epoch 18/50
765/765 - 25s - loss: 12.2538 - accuracy10: 0.5167 - accuracy20: 0.4865 - accuracy30: 0.4576 - accuracy50: 0.4343 - val_loss: 12.6114 - val_accuracy10: 0.4898 - val_accuracy20: 0.4496 - val_accuracy30: 0.4152 - val_accuracy50: 0.3977 - 25s/epoch - 33ms/step
Epoch 19/50
765/765 - 25s - loss: 12.2422 - accuracy10: 0.5177 - accuracy20: 0.4880 - accuracy30: 0.4591 - accuracy50: 0.4351 - val_loss: 12.6310 - val_accuracy10: 0.4865 - val_accuracy20: 0.4483 - val_accuracy30: 0.4159 - val_accuracy50: 0.3982 - 25s/epoch - 33ms/step
Epoch 20/50
765/765 - 25s - loss: 12.2315 - accuracy10: 0.5184 - accuracy20: 0.4883 - accuracy30: 0.4591 - accuracy50: 0.4370 - val_loss: 12.6103 - val_accuracy10: 0.4896 - val_accuracy20: 0.4504 - val_accuracy30: 0.4189 - val_accuracy50: 0.3985 - 25s/epoch - 33ms/step
Epoch 21/50
765/765 - 26s - loss: 12.2171 - accuracy10: 0.5195 - accuracy20: 0.4894 - accuracy30: 0.4606 - accuracy50: 0.4393 - val_loss: 12.6140 - val_accuracy10: 0.4877 - val_accuracy20: 0.4506 - val_accuracy30: 0.4185 - val_accuracy50: 0.4004 - 26s/epoch - 34ms/step
Epoch 22/50
765/765 - 26s - loss: 12.2025 - accuracy10: 0.5204 - accuracy20: 0.4899 - accuracy30: 0.4618 - accuracy50: 0.4383 - val_loss: 12.6268 - val_accuracy10: 0.4864 - val_accuracy20: 0.4479 - val_accuracy30: 0.4155 - val_accuracy50: 0.3988 - 26s/epoch - 33ms/step
Epoch 23/50
765/765 - 25s - loss: 12.1939 - accuracy10: 0.5207 - accuracy20: 0.4920 - accuracy30: 0.4638 - accuracy50: 0.4408 - val_loss: 12.6269 - val_accuracy10: 0.4855 - val_accuracy20: 0.4470 - val_accuracy30: 0.4154 - val_accuracy50: 0.3985 - 25s/epoch - 33ms/step
Epoch 24/50
765/765 - 25s - loss: 12.1781 - accuracy10: 0.5217 - accuracy20: 0.4922 - accuracy30: 0.4639 - accuracy50: 0.4416 - val_loss: 12.6162 - val_accuracy10: 0.4907 - val_accuracy20: 0.4488 - val_accuracy30: 0.4143 - val_accuracy50: 0.3971 - 25s/epoch - 32ms/step
Epoch 25/50
765/765 - 25s - loss: 12.1654 - accuracy10: 0.5224 - accuracy20: 0.4927 - accuracy30: 0.4651 - accuracy50: 0.4422 - val_loss: 12.6454 - val_accuracy10: 0.4851 - val_accuracy20: 0.4483 - val_accuracy30: 0.4126 - val_accuracy50: 0.3968 - 25s/epoch - 33ms/step
Epoch 26/50
765/765 - 25s - loss: 12.1514 - accuracy10: 0.5229 - accuracy20: 0.4940 - accuracy30: 0.4662 - accuracy50: 0.4432 - val_loss: 12.6530 - val_accuracy10: 0.4856 - val_accuracy20: 0.4452 - val_accuracy30: 0.4126 - val_accuracy50: 0.3949 - 25s/epoch - 33ms/step
Epoch 27/50
765/765 - 25s - loss: 12.1356 - accuracy10: 0.5247 - accuracy20: 0.4956 - accuracy30: 0.4675 - accuracy50: 0.4453 - val_loss: 12.6726 - val_accuracy10: 0.4801 - val_accuracy20: 0.4407 - val_accuracy30: 0.4078 - val_accuracy50: 0.3936 - 25s/epoch - 33ms/step
Epoch 28/50
765/765 - 26s - loss: 12.1264 - accuracy10: 0.5247 - accuracy20: 0.4959 - accuracy30: 0.4682 - accuracy50: 0.4452 - val_loss: 12.6726 - val_accuracy10: 0.4799 - val_accuracy20: 0.4424 - val_accuracy30: 0.4120 - val_accuracy50: 0.3934 - 26s/epoch - 34ms/step
Epoch 29/50
765/765 - 25s - loss: 12.1093 - accuracy10: 0.5256 - accuracy20: 0.4978 - accuracy30: 0.4699 - accuracy50: 0.4487 - val_loss: 12.6842 - val_accuracy10: 0.4799 - val_accuracy20: 0.4432 - val_accuracy30: 0.4080 - val_accuracy50: 0.3934 - 25s/epoch - 33ms/step
Epoch 30/50
765/765 - 26s - loss: 12.0966 - accuracy10: 0.5270 - accuracy20: 0.4984 - accuracy30: 0.4710 - accuracy50: 0.4489 - val_loss: 12.7282 - val_accuracy10: 0.4787 - val_accuracy20: 0.4413 - val_accuracy30: 0.4058 - val_accuracy50: 0.3900 - 26s/epoch - 34ms/step
testing model: results/PCAR/W0/deepVOL_L2/seq2seq
Evaluating performance on  test set...
1733/1733 - 23s - 23s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0323752
{'0': {'precision': 0.4459203250836196, 'recall': 0.546067587048126, 'f1-score': 0.49093871599876626, 'support': 144288}, '1': {'precision': 0.5582035206833301, 'recall': 0.2658916194487732, 'f1-score': 0.36020510465018707, 'support': 153367}, '2': {'precision': 0.4517895388744097, 'recall': 0.600183741609933, 'f1-score': 0.5155201959825925, 'support': 145857}, 'accuracy': 0.466979472934216, 'macro avg': {'precision': 0.4853044615471198, 'recall': 0.4707143160356108, 'f1-score': 0.45555467221051527, 'support': 443512}, 'weighted avg': {'precision': 0.4866781913317123, 'recall': 0.466979472934216, 'f1-score': 0.4538149384105689, 'support': 443512}}
[[78791 16269 49228]
 [55592 40779 56996]
 [42310 16006 87541]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0587375
{'0': {'precision': 0.41661256816411324, 'recall': 0.5423659579263183, 'f1-score': 0.4712440757931323, 'support': 141989}, '1': {'precision': 0.5087843313046326, 'recall': 0.18763074066773908, 'f1-score': 0.27415713635392375, 'support': 157277}, '2': {'precision': 0.4273184393734769, 'recall': 0.5944497594387366, 'f1-score': 0.4972152074895116, 'support': 144246}, 'accuracy': 0.4335102545139703, 'macro avg': {'precision': 0.45090511294740754, 'recall': 0.441482152677598, 'f1-score': 0.4142054732121892, 'support': 443512}, 'weighted avg': {'precision': 0.45278019720214907, 'recall': 0.4335102545139703, 'f1-score': 0.4098003928454229, 'support': 443512}}
[[77010 14555 50424]
 [63275 29510 64492]
 [44563 13936 85747]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0716091
{'0': {'precision': 0.3982293852120287, 'recall': 0.5314380254106068, 'f1-score': 0.4552902160909793, 'support': 141437}, '1': {'precision': 0.43590034341994427, 'recall': 0.17132615574642024, 'f1-score': 0.2459745423798533, 'support': 157063}, '2': {'precision': 0.41741265696879276, 'recall': 0.5556367748875956, 'f1-score': 0.4767071742140077, 'support': 145012}, 'accuracy': 0.41182200256137375, 'macro avg': {'precision': 0.41718079520025525, 'recall': 0.41946698534820753, 'f1-score': 0.39265731089494676, 'support': 443512}, 'weighted avg': {'precision': 0.4178421990998191, 'recall': 0.41182200256137375, 'f1-score': 0.3881668198158977, 'support': 443512}}
[[75165 17388 48884]
 [66580 26909 63574]
 [47003 17435 80574]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0809665
{'0': {'precision': 0.36545943171847495, 'recall': 0.497240721692057, 'f1-score': 0.4212849872773537, 'support': 133187}, '1': {'precision': 0.48628255653627767, 'recall': 0.25783889889878364, 'f1-score': 0.3369948763476861, 'support': 173717}, '2': {'precision': 0.3854926846465715, 'recall': 0.4802573787772312, 'f1-score': 0.4276885768486105, 'support': 136608}, 'accuracy': 0.3982395064846047, 'macro avg': {'precision': 0.41241155763377463, 'recall': 0.4117789997893573, 'f1-score': 0.3953228134912168, 'support': 443512}, 'weighted avg': {'precision': 0.4189545646347786, 'recall': 0.3982395064846047, 'f1-score': 0.39024221135196996, 'support': 443512}}
[[66226 23659 43302]
 [67645 44791 61281]
 [47342 23659 65607]]
Evaluating performance on  train set...
765/765 - 11s - 11s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0018148
{'0': {'precision': 0.47634021120587705, 'recall': 0.5247781235150754, 'f1-score': 0.4993873621564852, 'support': 65239}, '1': {'precision': 0.6186924493554328, 'recall': 0.3126376523870087, 'f1-score': 0.41537700661487414, 'support': 64474}, '2': {'precision': 0.4609411790474313, 'recall': 0.6372197241525488, 'f1-score': 0.5349321945577712, 'support': 66051}, 'accuracy': 0.4928485319057641, 'macro avg': {'precision': 0.5186579465362471, 'recall': 0.49154516668487763, 'f1-score': 0.48323218777637683, 'support': 195764}, 'weighted avg': {'precision': 0.518027634477556, 'recall': 0.4928485319057641, 'f1-score': 0.48371179393018987, 'support': 195764}}
[[34236  6035 24968]
 [20063 20157 24254]
 [17574  6388 42089]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.035709
{'0': {'precision': 0.4469492512038948, 'recall': 0.5184298560599085, 'f1-score': 0.4800431959304886, 'support': 65166}, '1': {'precision': 0.566171465182397, 'recall': 0.22018562930202137, 'f1-score': 0.31706414611995026, 'support': 64214}, '2': {'precision': 0.43952396458094806, 'recall': 0.6303326102675344, 'f1-score': 0.5179129509180813, 'support': 66384}, 'accuracy': 0.4585470260109111, 'macro avg': {'precision': 0.48421489365574666, 'recall': 0.4563160318764881, 'f1-score': 0.4383400976561734, 'support': 195764}, 'weighted avg': {'precision': 0.48353828198196347, 'recall': 0.4585470260109111, 'f1-score': 0.4394249469703245, 'support': 195764}}
[[33784  5268 26114]
 [22830 14139 27245]
 [18974  5566 41844]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.057972
{'0': {'precision': 0.4230650274491611, 'recall': 0.5070350749841691, 'f1-score': 0.4612596157223647, 'support': 64747}, '1': {'precision': 0.46199375684112376, 'recall': 0.17612784569494458, 'f1-score': 0.25502965200850397, 'support': 64703}, '2': {'precision': 0.4242826126482636, 'recall': 0.5982145549959285, 'f1-score': 0.4964552320524613, 'support': 66314}, 'accuracy': 0.4285517255470873, 'macro avg': {'precision': 0.43644713231284954, 'recall': 0.427125825225014, 'f1-score': 0.4042481665944433, 'support': 195764}, 'weighted avg': {'precision': 0.43634401910616366, 'recall': 0.4285517255470873, 'f1-score': 0.40501977979306253, 'support': 195764}}
[[32829  6513 25405]
 [24883 11396 28424]
 [19886  6758 39670]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0731075
{'0': {'precision': 0.402274456412926, 'recall': 0.46565310095485307, 'f1-score': 0.431649730380046, 'support': 64722}, '1': {'precision': 0.41608533970304823, 'recall': 0.23701951325107462, 'f1-score': 0.3020046298576565, 'support': 64674}, '2': {'precision': 0.41055187848197705, 'recall': 0.5196480231436837, 'f1-score': 0.4587024180033517, 'support': 66368}, 'accuracy': 0.4084254510533091, 'macro avg': {'precision': 0.4096372248659838, 'recall': 0.40744021244987044, 'f1-score': 0.3974522594136847, 'support': 195764}, 'weighted avg': {'precision': 0.4096433343158302, 'recall': 0.4084254510533091, 'f1-score': 0.3979906589521968, 'support': 195764}}
[[30138 10806 23778]
 [23607 15329 25738]
 [21174 10706 34488]]
Evaluating performance on  val set...
253/253 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0084467
{'0': {'precision': 0.4677660546647836, 'recall': 0.5244504470938898, 'f1-score': 0.4944890879550345, 'support': 21472}, '1': {'precision': 0.5886482828624598, 'recall': 0.3306409464531762, 'f1-score': 0.4234384982810551, 'support': 21047}, '2': {'precision': 0.46849628755811534, 'recall': 0.6082706428217487, 'f1-score': 0.5293114599870642, 'support': 22199}, 'accuracy': 0.490172749466918, 'macro avg': {'precision': 0.5083035416951196, 'recall': 0.48778734545627156, 'f1-score': 0.48241301540771797, 'support': 64718}, 'weighted avg': {'precision': 0.5073287527839401, 'recall': 0.490172749466918, 'f1-score': 0.483327124913389, 'support': 64718}}
[[11261  2225  7986]
 [ 6755  6959  7333]
 [ 6058  2638 13503]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0435367
{'0': {'precision': 0.4385236266750255, 'recall': 0.5219175526953926, 'f1-score': 0.4766000936847932, 'support': 21444}, '1': {'precision': 0.5347647124262989, 'recall': 0.2248468122924365, 'f1-score': 0.3165832455216017, 'support': 21379}, '2': {'precision': 0.4384414208627139, 'recall': 0.6048869604932633, 'f1-score': 0.5083873939580054, 'support': 21895}, 'accuracy': 0.4518526530486109, 'macro avg': {'precision': 0.4705765866546794, 'recall': 0.4505504418270308, 'f1-score': 0.43385691105480007, 'support': 64718}, 'weighted avg': {'precision': 0.47028817867007955, 'recall': 0.4518526530486109, 'f1-score': 0.43449407592468187, 'support': 64718}}
[[11192  1992  8260]
 [ 7869  4807  8703]
 [ 6461  2190 13244]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0666546
{'0': {'precision': 0.40637360153689683, 'recall': 0.5104329311568488, 'f1-score': 0.45249779791116146, 'support': 21135}, '1': {'precision': 0.4593948092333453, 'recall': 0.1741871116956147, 'f1-score': 0.25259765881888724, 'support': 22051}, '2': {'precision': 0.4170077155317008, 'recall': 0.5773267694594093, 'f1-score': 0.48424292002648905, 'support': 21532}, 'accuracy': 0.4181216972094317, 'macro avg': {'precision': 0.4275920421006476, 'recall': 0.420648937437291, 'f1-score': 0.39644612558551257, 'support': 64718}, 'weighted avg': {'precision': 0.4279772418448561, 'recall': 0.4181216972094317, 'f1-score': 0.39494870804842613, 'support': 64718}}
[[10788  2231  8116]
 [ 8947  3841  9263]
 [ 6812  2289 12431]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0797138
{'0': {'precision': 0.3921765683583936, 'recall': 0.47775109478739936, 'f1-score': 0.4307548611700773, 'support': 21237}, '1': {'precision': 0.42863105175292154, 'recall': 0.2321218696320405, 'f1-score': 0.30115535745704064, 'support': 22122}, '2': {'precision': 0.40104961476904755, 'recall': 0.5044711831078234, 'f1-score': 0.4468543938954091, 'support': 21359}, 'accuracy': 0.40260823882072994, 'macro avg': {'precision': 0.4072857449601209, 'recall': 0.4047813825090878, 'f1-score': 0.392921537507509, 'support': 64718}, 'weighted avg': {'precision': 0.40756588014087924, 'recall': 0.40260823882072994, 'f1-score': 0.39176833034929426, 'support': 64718}}
[[10146  3468  7623]
 [ 8518  5135  8469]
 [ 7207  3377 10775]]
training model: results/PCAR/W0/deepVOL_L3/seq2seq
Epoch 1/50
765/765 - 41s - loss: 13.1114 - accuracy10: 0.3925 - accuracy20: 0.3824 - accuracy30: 0.3755 - accuracy50: 0.3712 - val_loss: 13.2475 - val_accuracy10: 0.3641 - val_accuracy20: 0.3566 - val_accuracy30: 0.3476 - val_accuracy50: 0.3415 - 41s/epoch - 54ms/step
Epoch 2/50
765/765 - 35s - loss: 13.0341 - accuracy10: 0.4020 - accuracy20: 0.3899 - accuracy30: 0.3783 - accuracy50: 0.3694 - val_loss: 13.1003 - val_accuracy10: 0.4050 - val_accuracy20: 0.3913 - val_accuracy30: 0.3729 - val_accuracy50: 0.3587 - 35s/epoch - 46ms/step
Epoch 3/50
765/765 - 35s - loss: 12.8848 - accuracy10: 0.4280 - accuracy20: 0.4147 - accuracy30: 0.4006 - accuracy50: 0.3891 - val_loss: 12.9178 - val_accuracy10: 0.4275 - val_accuracy20: 0.4146 - val_accuracy30: 0.3973 - val_accuracy50: 0.3788 - 35s/epoch - 46ms/step
Epoch 4/50
765/765 - 35s - loss: 12.7015 - accuracy10: 0.4615 - accuracy20: 0.4408 - accuracy30: 0.4217 - accuracy50: 0.4022 - val_loss: 12.8223 - val_accuracy10: 0.4498 - val_accuracy20: 0.4290 - val_accuracy30: 0.4076 - val_accuracy50: 0.3837 - 35s/epoch - 46ms/step
Epoch 5/50
765/765 - 35s - loss: 12.5804 - accuracy10: 0.4771 - accuracy20: 0.4534 - accuracy30: 0.4314 - accuracy50: 0.4090 - val_loss: 12.7059 - val_accuracy10: 0.4633 - val_accuracy20: 0.4392 - val_accuracy30: 0.4152 - val_accuracy50: 0.3896 - 35s/epoch - 46ms/step
Epoch 6/50
765/765 - 34s - loss: 12.5138 - accuracy10: 0.4874 - accuracy20: 0.4612 - accuracy30: 0.4375 - accuracy50: 0.4147 - val_loss: 12.6430 - val_accuracy10: 0.4704 - val_accuracy20: 0.4463 - val_accuracy30: 0.4218 - val_accuracy50: 0.3986 - 34s/epoch - 45ms/step
Epoch 7/50
765/765 - 35s - loss: 12.4673 - accuracy10: 0.4939 - accuracy20: 0.4659 - accuracy30: 0.4408 - accuracy50: 0.4170 - val_loss: 12.6015 - val_accuracy10: 0.4827 - val_accuracy20: 0.4536 - val_accuracy30: 0.4260 - val_accuracy50: 0.4013 - 35s/epoch - 45ms/step
Epoch 8/50
765/765 - 35s - loss: 12.4333 - accuracy10: 0.4989 - accuracy20: 0.4693 - accuracy30: 0.4430 - accuracy50: 0.4200 - val_loss: 12.6013 - val_accuracy10: 0.4877 - val_accuracy20: 0.4587 - val_accuracy30: 0.4289 - val_accuracy50: 0.4051 - 35s/epoch - 45ms/step
Epoch 9/50
765/765 - 34s - loss: 12.4112 - accuracy10: 0.5015 - accuracy20: 0.4710 - accuracy30: 0.4453 - accuracy50: 0.4232 - val_loss: 12.5827 - val_accuracy10: 0.4897 - val_accuracy20: 0.4582 - val_accuracy30: 0.4289 - val_accuracy50: 0.4073 - 34s/epoch - 44ms/step
Epoch 10/50
765/765 - 37s - loss: 12.3832 - accuracy10: 0.5046 - accuracy20: 0.4746 - accuracy30: 0.4477 - accuracy50: 0.4248 - val_loss: 12.5854 - val_accuracy10: 0.4902 - val_accuracy20: 0.4578 - val_accuracy30: 0.4281 - val_accuracy50: 0.4056 - 37s/epoch - 48ms/step
Epoch 11/50
765/765 - 34s - loss: 12.3607 - accuracy10: 0.5063 - accuracy20: 0.4769 - accuracy30: 0.4496 - accuracy50: 0.4272 - val_loss: 12.5858 - val_accuracy10: 0.4916 - val_accuracy20: 0.4598 - val_accuracy30: 0.4286 - val_accuracy50: 0.4083 - 34s/epoch - 45ms/step
Epoch 12/50
765/765 - 34s - loss: 12.3422 - accuracy10: 0.5075 - accuracy20: 0.4782 - accuracy30: 0.4508 - accuracy50: 0.4286 - val_loss: 12.5658 - val_accuracy10: 0.4935 - val_accuracy20: 0.4612 - val_accuracy30: 0.4285 - val_accuracy50: 0.4070 - 34s/epoch - 45ms/step
Epoch 13/50
765/765 - 34s - loss: 12.3301 - accuracy10: 0.5093 - accuracy20: 0.4803 - accuracy30: 0.4522 - accuracy50: 0.4304 - val_loss: 12.5415 - val_accuracy10: 0.4966 - val_accuracy20: 0.4618 - val_accuracy30: 0.4301 - val_accuracy50: 0.4053 - 34s/epoch - 45ms/step
Epoch 14/50
765/765 - 34s - loss: 12.3111 - accuracy10: 0.5106 - accuracy20: 0.4817 - accuracy30: 0.4529 - accuracy50: 0.4316 - val_loss: 12.5408 - val_accuracy10: 0.4943 - val_accuracy20: 0.4625 - val_accuracy30: 0.4317 - val_accuracy50: 0.4089 - 34s/epoch - 44ms/step
Epoch 15/50
765/765 - 34s - loss: 12.2927 - accuracy10: 0.5133 - accuracy20: 0.4832 - accuracy30: 0.4544 - accuracy50: 0.4329 - val_loss: 12.5547 - val_accuracy10: 0.4968 - val_accuracy20: 0.4608 - val_accuracy30: 0.4260 - val_accuracy50: 0.4035 - 34s/epoch - 44ms/step
Epoch 16/50
765/765 - 34s - loss: 12.2773 - accuracy10: 0.5144 - accuracy20: 0.4855 - accuracy30: 0.4576 - accuracy50: 0.4346 - val_loss: 12.5542 - val_accuracy10: 0.4955 - val_accuracy20: 0.4616 - val_accuracy30: 0.4292 - val_accuracy50: 0.4077 - 34s/epoch - 45ms/step
Epoch 17/50
765/765 - 34s - loss: 12.2613 - accuracy10: 0.5152 - accuracy20: 0.4857 - accuracy30: 0.4575 - accuracy50: 0.4356 - val_loss: 12.5633 - val_accuracy10: 0.4933 - val_accuracy20: 0.4590 - val_accuracy30: 0.4270 - val_accuracy50: 0.4065 - 34s/epoch - 44ms/step
Epoch 18/50
765/765 - 34s - loss: 12.2497 - accuracy10: 0.5163 - accuracy20: 0.4865 - accuracy30: 0.4589 - accuracy50: 0.4368 - val_loss: 12.5476 - val_accuracy10: 0.4962 - val_accuracy20: 0.4611 - val_accuracy30: 0.4281 - val_accuracy50: 0.4065 - 34s/epoch - 45ms/step
Epoch 19/50
765/765 - 34s - loss: 12.2337 - accuracy10: 0.5170 - accuracy20: 0.4880 - accuracy30: 0.4598 - accuracy50: 0.4384 - val_loss: 12.5580 - val_accuracy10: 0.4917 - val_accuracy20: 0.4580 - val_accuracy30: 0.4267 - val_accuracy50: 0.4081 - 34s/epoch - 45ms/step
Epoch 20/50
765/765 - 35s - loss: 12.2227 - accuracy10: 0.5176 - accuracy20: 0.4894 - accuracy30: 0.4617 - accuracy50: 0.4376 - val_loss: 12.5541 - val_accuracy10: 0.4960 - val_accuracy20: 0.4603 - val_accuracy30: 0.4259 - val_accuracy50: 0.4059 - 35s/epoch - 45ms/step
Epoch 21/50
765/765 - 34s - loss: 12.2051 - accuracy10: 0.5192 - accuracy20: 0.4897 - accuracy30: 0.4628 - accuracy50: 0.4394 - val_loss: 12.5527 - val_accuracy10: 0.4938 - val_accuracy20: 0.4582 - val_accuracy30: 0.4271 - val_accuracy50: 0.4063 - 34s/epoch - 45ms/step
Epoch 22/50
765/765 - 34s - loss: 12.1931 - accuracy10: 0.5201 - accuracy20: 0.4906 - accuracy30: 0.4642 - accuracy50: 0.4403 - val_loss: 12.5637 - val_accuracy10: 0.4911 - val_accuracy20: 0.4574 - val_accuracy30: 0.4251 - val_accuracy50: 0.4090 - 34s/epoch - 45ms/step
Epoch 23/50
765/765 - 34s - loss: 12.1741 - accuracy10: 0.5211 - accuracy20: 0.4930 - accuracy30: 0.4655 - accuracy50: 0.4423 - val_loss: 12.5869 - val_accuracy10: 0.4891 - val_accuracy20: 0.4553 - val_accuracy30: 0.4228 - val_accuracy50: 0.4043 - 34s/epoch - 45ms/step
Epoch 24/50
765/765 - 34s - loss: 12.1646 - accuracy10: 0.5211 - accuracy20: 0.4932 - accuracy30: 0.4655 - accuracy50: 0.4426 - val_loss: 12.5842 - val_accuracy10: 0.4922 - val_accuracy20: 0.4556 - val_accuracy30: 0.4229 - val_accuracy50: 0.4063 - 34s/epoch - 44ms/step
testing model: results/PCAR/W0/deepVOL_L3/seq2seq
Evaluating performance on  test set...
1733/1733 - 36s - 36s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0297421
{'0': {'precision': 0.44394353420141386, 'recall': 0.5562278221335107, 'f1-score': 0.4937828775340696, 'support': 144288}, '1': {'precision': 0.5437232375457893, 'recall': 0.3551872306297965, 'f1-score': 0.4296836176909061, 'support': 153367}, '2': {'precision': 0.46315744141550236, 'recall': 0.5161425231562421, 'f1-score': 0.48821660181582366, 'support': 145857}, 'accuracy': 0.4735249553563376, 'macro avg': {'precision': 0.4836080710542352, 'recall': 0.47585252530651645, 'f1-score': 0.4705610323469331, 'support': 443512}, 'weighted avg': {'precision': 0.48476632282346277, 'recall': 0.4735249553563376, 'f1-score': 0.46978670277035933, 'support': 443512}}
[[80257 22338 41693]
 [53326 54474 45567]
 [47199 23375 75283]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0542384
{'0': {'precision': 0.41626733454412596, 'recall': 0.5536696504658811, 'f1-score': 0.4752362126185597, 'support': 141989}, '1': {'precision': 0.5114590397792381, 'recall': 0.27811440960852507, 'f1-score': 0.3603062615579141, 'support': 157277}, '2': {'precision': 0.4391632620482106, 'recall': 0.5149328230938813, 'f1-score': 0.47403942191404025, 'support': 144246}, 'accuracy': 0.4433544075470337, 'macro avg': {'precision': 0.4556298787905249, 'recall': 0.44890562772276255, 'f1-score': 0.43652729869683804, 'support': 443512}, 'weighted avg': {'precision': 0.45747053036073726, 'recall': 0.4433544075470337, 'f1-score': 0.43409083169328766, 'support': 443512}}
[[78615 20797 42577]
 [61257 43741 52279]
 [48985 20984 74277]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0669845
{'0': {'precision': 0.4008205234732032, 'recall': 0.5456987916881721, 'f1-score': 0.46217181591451423, 'support': 141437}, '1': {'precision': 0.46859011156313174, 'recall': 0.2390760395510082, 'f1-score': 0.31661445971070457, 'support': 157063}, '2': {'precision': 0.4267290332400567, 'recall': 0.5026687446556147, 'f1-score': 0.4615964284583478, 'support': 145012}, 'accuracy': 0.4230437958837641, 'macro avg': {'precision': 0.4320465560921305, 'recall': 0.4291478586315984, 'f1-score': 0.4134609013611889, 'support': 443512}, 'weighted avg': {'precision': 0.4332912111490257, 'recall': 0.4230437958837641, 'f1-score': 0.41043677126356326, 'support': 443512}}
[[77182 21123 43132]
 [64720 37550 54793]
 [50658 21461 72893]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0801405
{'0': {'precision': 0.36236014070774053, 'recall': 0.5050492915975283, 'f1-score': 0.4219685088764821, 'support': 133187}, '1': {'precision': 0.48612538540596095, 'recall': 0.253222194718997, 'f1-score': 0.3329901667638131, 'support': 173717}, '2': {'precision': 0.3893721249775972, 'recall': 0.47710968610915905, 'f1-score': 0.4287988736768005, 'support': 136608}, 'accuracy': 0.39780659824311404, 'macro avg': {'precision': 0.41261921703043286, 'recall': 0.41179372414189475, 'f1-score': 0.39458584977236527, 'support': 443512}, 'weighted avg': {'precision': 0.41915720631222775, 'recall': 0.39780659824311404, 'f1-score': 0.38922087593274074, 'support': 443512}}
[[67266 23430 42491]
 [70006 43989 59722]
 [48361 23070 65177]]
Evaluating performance on  train set...
765/765 - 16s - 16s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.99926186
{'0': {'precision': 0.47493853106413375, 'recall': 0.529989730069437, 'f1-score': 0.5009562445667922, 'support': 65239}, '1': {'precision': 0.5744444892527322, 'recall': 0.441868039830009, 'f1-score': 0.49950906476838375, 'support': 64474}, '2': {'precision': 0.4767681173247557, 'recall': 0.5295907707680428, 'f1-score': 0.5017931430210875, 'support': 66051}, 'accuracy': 0.5008326352138289, 'macro avg': {'precision': 0.5087170458805406, 'recall': 0.500482846889163, 'f1-score': 0.5007528174520878, 'support': 195764}, 'weighted avg': {'precision': 0.5083276789685086, 'recall': 0.5008326352138289, 'f1-score': 0.5007619928631188, 'support': 195764}}
[[34576  9909 20754]
 [18350 28489 17635]
 [19875 11196 34980]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0315188
{'0': {'precision': 0.4474454408168175, 'recall': 0.5137801921247276, 'f1-score': 0.4783239161958098, 'support': 65166}, '1': {'precision': 0.5298694505590306, 'recall': 0.37860902606908153, 'f1-score': 0.4416469113599826, 'support': 64214}, '2': {'precision': 0.4548724918058997, 'recall': 0.5142805495300072, 'f1-score': 0.48275569507487376, 'support': 66384}, 'accuracy': 0.46961136879099324, 'macro avg': {'precision': 0.47739579439391594, 'recall': 0.4688899225746055, 'f1-score': 0.4675755075435553, 'support': 195764}, 'weighted avg': {'precision': 0.47700048012151963, 'recall': 0.46961136879099324, 'f1-score': 0.4677960460081347, 'support': 195764}}
[[33481 10194 21491]
 [20479 24312 19423]
 [20867 11377 34140]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0527569
{'0': {'precision': 0.4261850101282917, 'recall': 0.4874202665760576, 'f1-score': 0.4547504629062588, 'support': 64747}, '1': {'precision': 0.47078693857124987, 'recall': 0.3489482713320866, 'f1-score': 0.4008130586449615, 'support': 64703}, '2': {'precision': 0.43730679537935896, 'recall': 0.48638296588955576, 'f1-score': 0.46054115799243234, 'support': 66314}, 'accuracy': 0.4413017715208108, 'macro avg': {'precision': 0.4447595813596335, 'recall': 0.4409171679325667, 'f1-score': 0.4387015598478842, 'support': 195764}, 'weighted avg': {'precision': 0.4446940753455125, 'recall': 0.4413017715208108, 'f1-score': 0.4388848915347389, 'support': 195764}}
[[31559 12106 21082]
 [21705 22578 20420]
 [20786 13274 32254]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0693935
{'0': {'precision': 0.4037161672130196, 'recall': 0.4300392447699391, 'f1-score': 0.41646217380895384, 'support': 64722}, '1': {'precision': 0.42373948068762135, 'recall': 0.36436589665089525, 'f1-score': 0.39181617145802505, 'support': 64674}, '2': {'precision': 0.4155736553854796, 'recall': 0.4458925988428158, 'f1-score': 0.430199595865618, 'support': 66368}, 'accuracy': 0.4137175374430437, 'macro avg': {'precision': 0.41434310109537353, 'recall': 0.41343258008788336, 'f1-score': 0.41282598037753226, 'support': 195764}, 'weighted avg': {'precision': 0.414351143769926, 'recall': 0.4137175374430437, 'f1-score': 0.41297721064418763, 'support': 195764}}
[[27833 15540 21349]
 [20841 23565 20268]
 [20268 16507 29593]]
Evaluating performance on  val set...
253/253 - 5s - 5s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.006684
{'0': {'precision': 0.4686696330162877, 'recall': 0.534696348733234, 'f1-score': 0.49951053971154474, 'support': 21472}, '1': {'precision': 0.5703013840382875, 'recall': 0.41896707369221264, 'f1-score': 0.48305897176038787, 'support': 21047}, '2': {'precision': 0.47522113170968133, 'recall': 0.530023874949322, 'f1-score': 0.5011286681715575, 'support': 22199}, 'accuracy': 0.4954572143762168, 'macro avg': {'precision': 0.5047307162547522, 'recall': 0.4945624324582562, 'f1-score': 0.4945660598811634, 'support': 64718}, 'weighted avg': {'precision': 0.5039686253098485, 'recall': 0.4954572143762168, 'f1-score': 0.49471534645798043, 'support': 64718}}
[[11481  2945  7046]
 [ 6282  8818  5947]
 [ 6734  3699 11766]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0387349
{'0': {'precision': 0.4418248261228339, 'recall': 0.5243424734191382, 'f1-score': 0.4795598490179771, 'support': 21444}, '1': {'precision': 0.5316664171283126, 'recall': 0.33219514476823053, 'f1-score': 0.40890117166134093, 'support': 21379}, '2': {'precision': 0.4461039712863263, 'recall': 0.5279287508563599, 'f1-score': 0.4835794670125089, 'support': 21895}, 'accuracy': 0.46208164652801387, 'macro avg': {'precision': 0.47319840484582426, 'recall': 0.4614887896812429, 'f1-score': 0.45734682923060893, 'support': 64718}, 'weighted avg': {'precision': 0.4729508692246108, 'recall': 0.46208164652801387, 'f1-score': 0.4575782932341573, 'support': 64718}}
[[11244  2887  7313]
 [ 7238  7102  7039]
 [ 6967  3369 11559]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0604911
{'0': {'precision': 0.4154932279476653, 'recall': 0.5123728412585759, 'f1-score': 0.45887537607525747, 'support': 21135}, '1': {'precision': 0.4895816507833953, 'recall': 0.27490816743004853, 'f1-score': 0.3521040861963814, 'support': 22051}, '2': {'precision': 0.4197084459330872, 'recall': 0.5121214935909344, 'f1-score': 0.46133249660077397, 'support': 21532}, 'accuracy': 0.4313792144380234, 'macro avg': {'precision': 0.4415944415547159, 'recall': 0.4331341674265196, 'f1-score': 0.42410398629080426, 'support': 64718}, 'weighted avg': {'precision': 0.44213938335439584, 'recall': 0.4313792144380234, 'f1-score': 0.4233132914316703, 'support': 64718}}
[[10829  2925  7381]
 [ 8124  6062  7865]
 [ 7110  3395 11027]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0733213
{'0': {'precision': 0.3974253306644688, 'recall': 0.4768093421858078, 'f1-score': 0.43351314324856577, 'support': 21237}, '1': {'precision': 0.4486324466092169, 'recall': 0.2706355664044842, 'f1-score': 0.33760960893224684, 'support': 22122}, '2': {'precision': 0.4001699235344095, 'recall': 0.48513507186666044, 'f1-score': 0.43857532855056824, 'support': 21359}, 'accuracy': 0.40908248091721006, 'macro avg': {'precision': 0.41540923360269844, 'recall': 0.4108599934856508, 'f1-score': 0.40323269357712693, 'support': 64718}, 'weighted avg': {'precision': 0.4158348238199863, 'recall': 0.40908248091721006, 'f1-score': 0.40240194126024514, 'support': 64718}}
[[10126  3512  7599]
 [ 8202  5987  7933]
 [ 7151  3846 10362]]
training model: results/PCAR/W1/deepLOB_L1/seq2seq
Epoch 1/50
722/722 - 27s - loss: 12.7573 - accuracy10: 0.4439 - accuracy20: 0.4394 - accuracy30: 0.4258 - accuracy50: 0.4040 - val_loss: 13.0796 - val_accuracy10: 0.4210 - val_accuracy20: 0.3949 - val_accuracy30: 0.3829 - val_accuracy50: 0.3704 - 27s/epoch - 37ms/step
Epoch 2/50
722/722 - 21s - loss: 12.5995 - accuracy10: 0.4627 - accuracy20: 0.4578 - accuracy30: 0.4407 - accuracy50: 0.4145 - val_loss: 13.0399 - val_accuracy10: 0.4383 - val_accuracy20: 0.4155 - val_accuracy30: 0.4035 - val_accuracy50: 0.3856 - 21s/epoch - 29ms/step
Epoch 3/50
722/722 - 20s - loss: 12.4526 - accuracy10: 0.4815 - accuracy20: 0.4724 - accuracy30: 0.4544 - accuracy50: 0.4256 - val_loss: 13.0388 - val_accuracy10: 0.4392 - val_accuracy20: 0.4053 - val_accuracy30: 0.3968 - val_accuracy50: 0.3805 - 20s/epoch - 28ms/step
Epoch 4/50
722/722 - 20s - loss: 12.3675 - accuracy10: 0.4910 - accuracy20: 0.4809 - accuracy30: 0.4609 - accuracy50: 0.4296 - val_loss: 12.9641 - val_accuracy10: 0.4525 - val_accuracy20: 0.4330 - val_accuracy30: 0.4179 - val_accuracy50: 0.3940 - 20s/epoch - 28ms/step
Epoch 5/50
722/722 - 20s - loss: 12.3101 - accuracy10: 0.4985 - accuracy20: 0.4863 - accuracy30: 0.4648 - accuracy50: 0.4319 - val_loss: 13.2307 - val_accuracy10: 0.4464 - val_accuracy20: 0.4249 - val_accuracy30: 0.4098 - val_accuracy50: 0.3876 - 20s/epoch - 28ms/step
Epoch 6/50
722/722 - 20s - loss: 12.2579 - accuracy10: 0.5045 - accuracy20: 0.4911 - accuracy30: 0.4686 - accuracy50: 0.4354 - val_loss: 12.9660 - val_accuracy10: 0.4611 - val_accuracy20: 0.4413 - val_accuracy30: 0.4221 - val_accuracy50: 0.3930 - 20s/epoch - 27ms/step
Epoch 7/50
722/722 - 20s - loss: 12.2079 - accuracy10: 0.5092 - accuracy20: 0.4944 - accuracy30: 0.4715 - accuracy50: 0.4372 - val_loss: 12.8831 - val_accuracy10: 0.4618 - val_accuracy20: 0.4438 - val_accuracy30: 0.4265 - val_accuracy50: 0.3947 - 20s/epoch - 28ms/step
Epoch 8/50
722/722 - 20s - loss: 12.1798 - accuracy10: 0.5119 - accuracy20: 0.4969 - accuracy30: 0.4736 - accuracy50: 0.4378 - val_loss: 12.8557 - val_accuracy10: 0.4555 - val_accuracy20: 0.4469 - val_accuracy30: 0.4258 - val_accuracy50: 0.3939 - 20s/epoch - 27ms/step
Epoch 9/50
722/722 - 20s - loss: 12.1479 - accuracy10: 0.5152 - accuracy20: 0.5001 - accuracy30: 0.4767 - accuracy50: 0.4390 - val_loss: 12.8607 - val_accuracy10: 0.4646 - val_accuracy20: 0.4521 - val_accuracy30: 0.4321 - val_accuracy50: 0.3994 - 20s/epoch - 27ms/step
Epoch 10/50
722/722 - 20s - loss: 12.1286 - accuracy10: 0.5176 - accuracy20: 0.5017 - accuracy30: 0.4769 - accuracy50: 0.4397 - val_loss: 12.8464 - val_accuracy10: 0.4728 - val_accuracy20: 0.4525 - val_accuracy30: 0.4343 - val_accuracy50: 0.4014 - 20s/epoch - 27ms/step
Epoch 11/50
722/722 - 19s - loss: 12.1031 - accuracy10: 0.5192 - accuracy20: 0.5038 - accuracy30: 0.4789 - accuracy50: 0.4410 - val_loss: 12.8762 - val_accuracy10: 0.4678 - val_accuracy20: 0.4540 - val_accuracy30: 0.4328 - val_accuracy50: 0.3994 - 19s/epoch - 27ms/step
Epoch 12/50
722/722 - 20s - loss: 12.0778 - accuracy10: 0.5211 - accuracy20: 0.5056 - accuracy30: 0.4817 - accuracy50: 0.4429 - val_loss: 12.8804 - val_accuracy10: 0.4681 - val_accuracy20: 0.4488 - val_accuracy30: 0.4257 - val_accuracy50: 0.3942 - 20s/epoch - 27ms/step
Epoch 13/50
722/722 - 19s - loss: 12.0567 - accuracy10: 0.5230 - accuracy20: 0.5070 - accuracy30: 0.4825 - accuracy50: 0.4427 - val_loss: 12.9065 - val_accuracy10: 0.4621 - val_accuracy20: 0.4441 - val_accuracy30: 0.4243 - val_accuracy50: 0.3950 - 19s/epoch - 27ms/step
Epoch 14/50
722/722 - 20s - loss: 12.0363 - accuracy10: 0.5246 - accuracy20: 0.5088 - accuracy30: 0.4831 - accuracy50: 0.4434 - val_loss: 13.0140 - val_accuracy10: 0.4548 - val_accuracy20: 0.4325 - val_accuracy30: 0.4114 - val_accuracy50: 0.3864 - 20s/epoch - 27ms/step
Epoch 15/50
722/722 - 20s - loss: 12.0175 - accuracy10: 0.5261 - accuracy20: 0.5100 - accuracy30: 0.4849 - accuracy50: 0.4454 - val_loss: 12.9471 - val_accuracy10: 0.4657 - val_accuracy20: 0.4437 - val_accuracy30: 0.4245 - val_accuracy50: 0.3915 - 20s/epoch - 27ms/step
Epoch 16/50
722/722 - 19s - loss: 11.9994 - accuracy10: 0.5287 - accuracy20: 0.5116 - accuracy30: 0.4865 - accuracy50: 0.4470 - val_loss: 12.9066 - val_accuracy10: 0.4564 - val_accuracy20: 0.4444 - val_accuracy30: 0.4211 - val_accuracy50: 0.3862 - 19s/epoch - 27ms/step
Epoch 17/50
722/722 - 19s - loss: 11.9847 - accuracy10: 0.5285 - accuracy20: 0.5126 - accuracy30: 0.4867 - accuracy50: 0.4470 - val_loss: 12.9851 - val_accuracy10: 0.4539 - val_accuracy20: 0.4346 - val_accuracy30: 0.4123 - val_accuracy50: 0.3818 - 19s/epoch - 27ms/step
Epoch 18/50
722/722 - 20s - loss: 11.9701 - accuracy10: 0.5301 - accuracy20: 0.5134 - accuracy30: 0.4890 - accuracy50: 0.4488 - val_loss: 12.9725 - val_accuracy10: 0.4539 - val_accuracy20: 0.4374 - val_accuracy30: 0.4134 - val_accuracy50: 0.3822 - 20s/epoch - 27ms/step
Epoch 19/50
722/722 - 19s - loss: 11.9544 - accuracy10: 0.5306 - accuracy20: 0.5148 - accuracy30: 0.4887 - accuracy50: 0.4488 - val_loss: 13.1438 - val_accuracy10: 0.4403 - val_accuracy20: 0.4154 - val_accuracy30: 0.3960 - val_accuracy50: 0.3711 - 19s/epoch - 27ms/step
Epoch 20/50
722/722 - 20s - loss: 11.9428 - accuracy10: 0.5319 - accuracy20: 0.5147 - accuracy30: 0.4895 - accuracy50: 0.4498 - val_loss: 13.0898 - val_accuracy10: 0.4427 - val_accuracy20: 0.4224 - val_accuracy30: 0.4012 - val_accuracy50: 0.3734 - 20s/epoch - 27ms/step
testing model: results/PCAR/W1/deepLOB_L1/seq2seq
Evaluating performance on  test set...
2607/2607 - 35s - 35s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0369273
{'0': {'precision': 0.48209384420928625, 'recall': 0.5119987836135367, 'f1-score': 0.4965965040165677, 'support': 230190}, '1': {'precision': 0.45686467301374134, 'recall': 0.44108671794325616, 'f1-score': 0.4488370778045838, 'support': 215953}, '2': {'precision': 0.4837553884337619, 'recall': 0.4688360484516365, 'f1-score': 0.4761788862432465, 'support': 221169}, 'accuracy': 0.4747449468914091, 'macro avg': {'precision': 0.47423796855226313, 'recall': 0.4739738500028097, 'f1-score': 0.4738708226881327, 'support': 667312}, 'weighted avg': {'precision': 0.47447996474569437, 'recall': 0.4747449468914091, 'f1-score': 0.4743737124676906, 'support': 667312}}
[[117857  54693  57640]
 [ 67683  95254  53016]
 [ 58929  58548 103692]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0689638
{'0': {'precision': 0.4945973721814824, 'recall': 0.4757847886880145, 'f1-score': 0.4850087227451854, 'support': 253890}, '1': {'precision': 0.35093928940497526, 'recall': 0.42451417321883644, 'f1-score': 0.38423634549951496, 'support': 165594}, '2': {'precision': 0.4961394814335991, 'recall': 0.44597059250770693, 'f1-score': 0.4697192496323811, 'support': 247828}, 'accuracy': 0.45198947418898505, 'macro avg': {'precision': 0.4472253810066856, 'recall': 0.4487565181381859, 'f1-score': 0.44632143929236046, 'support': 667312}, 'weighted avg': {'precision': 0.4595212178375483, 'recall': 0.45198947418898505, 'f1-score': 0.4543237349430485, 'support': 667312}}
[[120797  63460  69633]
 [ 52686  70297  42611]
 [ 70750  66554 110524]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0792234
{'0': {'precision': 0.46296631506195596, 'recall': 0.4570973651181777, 'f1-score': 0.46001312150885093, 'support': 246197}, '1': {'precision': 0.34387793077781914, 'recall': 0.37183098591549296, 'f1-score': 0.3573085846867749, 'support': 178920}, '2': {'precision': 0.46179345847849823, 'recall': 0.4400132124940647, 'f1-score': 0.45064031951489214, 'support': 242195}, 'accuracy': 0.4280351619632196, 'macro avg': {'precision': 0.42287923477275774, 'recall': 0.42298052117591184, 'f1-score': 0.42265400857017266, 'support': 667312}, 'weighted avg': {'precision': 0.4306106048149525, 'recall': 0.4280351619632196, 'f1-score': 0.42907415816466904, 'support': 667312}}
[[112536  62358  71303]
 [ 59492  66528  52900]
 [ 71048  64578 106569]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0915452
{'0': {'precision': 0.42171881221316454, 'recall': 0.4306035810880208, 'f1-score': 0.426114888399994, 'support': 233672}, '1': {'precision': 0.34491104168079323, 'recall': 0.32505849735532966, 'f1-score': 0.334690634118442, 'support': 203428}, '2': {'precision': 0.4143579270711145, 'recall': 0.42657202925998644, 'f1-score': 0.42037627619271845, 'support': 230212}, 'accuracy': 0.3970376675378234, 'macro avg': {'precision': 0.39366259365502404, 'recall': 0.3940780359011123, 'f1-score': 0.3937272662370515, 'support': 667312}, 'weighted avg': {'precision': 0.39576481283329296, 'recall': 0.3970376675378234, 'f1-score': 0.3962647574365933, 'support': 667312}}
[[100620  61928  71124]
 [ 69630  66126  67672]
 [ 68345  63665  98202]]
Evaluating performance on  train set...
722/722 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.016013
{'0': {'precision': 0.45987694003122415, 'recall': 0.4575239835541343, 'f1-score': 0.45869744435284415, 'support': 54725}, '1': {'precision': 0.567759227204199, 'recall': 0.4034760525375977, 'f1-score': 0.4717234980282997, 'support': 75603}, '2': {'precision': 0.41411355675223505, 'recall': 0.5829224315572564, 'f1-score': 0.48422741861531404, 'support': 54352}, 'accuracy': 0.4723034437946719, 'macro avg': {'precision': 0.4805832413292193, 'recall': 0.48130748921632954, 'f1-score': 0.4715494536654859, 'support': 184680}, 'weighted avg': {'precision': 0.4905727010728031, 'recall': 0.4723034437946719, 'f1-score': 0.471543523501313, 'support': 184680}}
[[25038 12180 17507]
 [17781 30504 27318]
 [11626 11043 31683]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.047059
{'0': {'precision': 0.485319617355388, 'recall': 0.40142456570084123, 'f1-score': 0.4394034273820128, 'support': 62054}, '1': {'precision': 0.46886845634974633, 'recall': 0.39873041063281095, 'f1-score': 0.4309643989815518, 'support': 60492}, '2': {'precision': 0.43914052008301796, 'recall': 0.5789100975311424, 'f1-score': 0.49943072949931966, 'support': 62134}, 'accuracy': 0.46025557721464155, 'macro avg': {'precision': 0.4644428645960508, 'recall': 0.4596883579549315, 'f1-score': 0.45659951862096143, 'support': 184680}, 'weighted avg': {'precision': 0.46439447298959463, 'recall': 0.46025557721464155, 'f1-score': 0.4568348909067911, 'support': 184680}}
[[24910 14509 22635]
 [13067 24120 23305]
 [13350 12814 35970]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0625408
{'0': {'precision': 0.46400166997181924, 'recall': 0.35914173075680217, 'f1-score': 0.4048926655555252, 'support': 61892}, '1': {'precision': 0.4499700179892065, 'recall': 0.37179190751445085, 'f1-score': 0.40716223548562125, 'support': 60550}, '2': {'precision': 0.42246815378407976, 'recall': 0.5888203348436647, 'f1-score': 0.4919621701804904, 'support': 62238}, 'accuracy': 0.44069200779727097, 'macro avg': {'precision': 0.44547994724836854, 'recall': 0.4399179910383059, 'f1-score': 0.4346723570738789, 'support': 184680}, 'weighted avg': {'precision': 0.4454042067487321, 'recall': 0.44069200779727097, 'f1-score': 0.4349795958572141, 'support': 184680}}
[[22228 14797 24867]
 [12807 22512 25231]
 [12870 12721 36647]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.084036
{'0': {'precision': 0.42725544339323707, 'recall': 0.30589360081671013, 'f1-score': 0.35652970451304616, 'support': 61711}, '1': {'precision': 0.4107653254981911, 'recall': 0.3391757851826179, 'f1-score': 0.37155357885411583, 'support': 60591}, '2': {'precision': 0.4030972619850332, 'recall': 0.5846131648978806, 'f1-score': 0.47717622427949885, 'support': 62378}, 'accuracy': 0.41095408273770845, 'macro avg': {'precision': 0.41370601029215376, 'recall': 0.4098941836324029, 'f1-score': 0.4017531692155536, 'support': 184680}, 'weighted avg': {'precision': 0.4136855290914195, 'recall': 0.41095408273770845, 'f1-score': 0.4022087178344212, 'support': 184680}}
[[18877 15829 27005]
 [13045 20551 26995]
 [12260 13651 36467]]
Evaluating performance on  val set...
227/227 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0314263
{'0': {'precision': 0.4809933041598566, 'recall': 0.48583448716583233, 'f1-score': 0.4834017750695456, 'support': 18778}, '1': {'precision': 0.4789518900343643, 'recall': 0.43313586481499466, 'f1-score': 0.4548931613034831, 'support': 20594}, '2': {'precision': 0.4536725642150412, 'recall': 0.49679760888129804, 'f1-score': 0.4742567447074109, 'support': 18736}, 'accuracy': 0.4706925036139602, 'macro avg': {'precision': 0.471205919469754, 'recall': 0.47192265362070834, 'f1-score': 0.47085056036014655, 'support': 58108}, 'weighted avg': {'precision': 0.4714606706824276, 'recall': 0.4706925036139602, 'f1-score': 0.4703493953496577, 'support': 58108}}
[[9123 4659 4996]
 [5461 8920 6213]
 [4383 5045 9308]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.064008
{'0': {'precision': 0.5056343343937025, 'recall': 0.4406126667919564, 'f1-score': 0.4708895081720268, 'support': 21284}, '1': {'precision': 0.37282447958139003, 'recall': 0.4179418515684774, 'f1-score': 0.39409607406962066, 'support': 15684}, '2': {'precision': 0.47395240911779424, 'recall': 0.49276253547776727, 'f1-score': 0.4831744706509891, 'support': 21140}, 'accuracy': 0.45346595993666966, 'macro avg': {'precision': 0.45080374103096227, 'recall': 0.45043901794606694, 'f1-score': 0.4493866842975455, 'support': 58108}, 'weighted avg': {'precision': 0.4582614139144396, 'recall': 0.45346595993666966, 'f1-score': 0.4546314350382608, 'support': 58108}}
[[ 9378  5429  6477]
 [ 4044  6555  5085]
 [ 5125  5598 10417]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0748996
{'0': {'precision': 0.4855216622458002, 'recall': 0.41547264387383553, 'f1-score': 0.44777412532171346, 'support': 21147}, '1': {'precision': 0.3625399505517699, 'recall': 0.374346201743462, 'f1-score': 0.3683484973807555, 'support': 16060}, '2': {'precision': 0.44854667292671474, 'recall': 0.5027989091431032, 'f1-score': 0.4741258741258741, 'support': 20901}, 'accuracy': 0.4355166242169753, 'macro avg': {'precision': 0.432202761908095, 'recall': 0.4308725849201336, 'f1-score': 0.4300828322761143, 'support': 58108}, 'weighted avg': {'precision': 0.43823212308485276, 'recall': 0.4355166242169753, 'f1-score': 0.4353008396643853, 'support': 58108}}
[[ 8786  5266  7095]
 [ 4223  6012  5825]
 [ 5087  5305 10509]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.091436
{'0': {'precision': 0.4391137573710425, 'recall': 0.37629397046558405, 'f1-score': 0.40528401585204754, 'support': 20383}, '1': {'precision': 0.3467515446545591, 'recall': 0.31757645041440413, 'f1-score': 0.33152336058237364, 'support': 17495}, '2': {'precision': 0.4103907709805833, 'recall': 0.49940682155215027, 'f1-score': 0.4505440599357831, 'support': 20230}, 'accuracy': 0.4014765608866249, 'macro avg': {'precision': 0.39875202433539503, 'recall': 0.3977590808107128, 'f1-score': 0.3957838121234014, 'support': 58108}, 'weighted avg': {'precision': 0.40130583202248693, 'recall': 0.4014765608866249, 'f1-score': 0.3988334071212536, 'support': 58108}}
[[ 7670  5319  7394]
 [ 4818  5556  7121]
 [ 4979  5148 10103]]
training model: results/PCAR/W1/deepOF_L1/seq2seq
Epoch 1/50
722/722 - 25s - loss: 13.0873 - accuracy10: 0.3929 - accuracy20: 0.3965 - accuracy30: 0.3909 - accuracy50: 0.3798 - val_loss: 13.1545 - val_accuracy10: 0.3923 - val_accuracy20: 0.3672 - val_accuracy30: 0.3596 - val_accuracy50: 0.3537 - 25s/epoch - 35ms/step
Epoch 2/50
722/722 - 19s - loss: 13.0110 - accuracy10: 0.3967 - accuracy20: 0.4017 - accuracy30: 0.3961 - accuracy50: 0.3825 - val_loss: 13.0870 - val_accuracy10: 0.4001 - val_accuracy20: 0.4079 - val_accuracy30: 0.4013 - val_accuracy50: 0.3841 - 19s/epoch - 27ms/step
Epoch 3/50
722/722 - 19s - loss: 12.9811 - accuracy10: 0.4014 - accuracy20: 0.4039 - accuracy30: 0.3970 - accuracy50: 0.3822 - val_loss: 13.0662 - val_accuracy10: 0.4053 - val_accuracy20: 0.4109 - val_accuracy30: 0.4016 - val_accuracy50: 0.3854 - 19s/epoch - 27ms/step
Epoch 4/50
722/722 - 19s - loss: 12.9628 - accuracy10: 0.4036 - accuracy20: 0.4057 - accuracy30: 0.3989 - accuracy50: 0.3834 - val_loss: 13.0607 - val_accuracy10: 0.4079 - val_accuracy20: 0.4150 - val_accuracy30: 0.4075 - val_accuracy50: 0.3895 - 19s/epoch - 26ms/step
Epoch 5/50
722/722 - 18s - loss: 12.9477 - accuracy10: 0.4081 - accuracy20: 0.4079 - accuracy30: 0.4000 - accuracy50: 0.3845 - val_loss: 13.0420 - val_accuracy10: 0.4064 - val_accuracy20: 0.4159 - val_accuracy30: 0.4071 - val_accuracy50: 0.3897 - 18s/epoch - 25ms/step
Epoch 6/50
722/722 - 18s - loss: 12.9325 - accuracy10: 0.4110 - accuracy20: 0.4105 - accuracy30: 0.4023 - accuracy50: 0.3861 - val_loss: 13.0370 - val_accuracy10: 0.4067 - val_accuracy20: 0.4193 - val_accuracy30: 0.4089 - val_accuracy50: 0.3894 - 18s/epoch - 25ms/step
Epoch 7/50
722/722 - 19s - loss: 12.9136 - accuracy10: 0.4138 - accuracy20: 0.4125 - accuracy30: 0.4042 - accuracy50: 0.3884 - val_loss: 13.0291 - val_accuracy10: 0.4081 - val_accuracy20: 0.4191 - val_accuracy30: 0.4087 - val_accuracy50: 0.3897 - 19s/epoch - 27ms/step
Epoch 8/50
722/722 - 19s - loss: 12.9029 - accuracy10: 0.4166 - accuracy20: 0.4139 - accuracy30: 0.4051 - accuracy50: 0.3891 - val_loss: 13.0251 - val_accuracy10: 0.4091 - val_accuracy20: 0.4190 - val_accuracy30: 0.4085 - val_accuracy50: 0.3905 - 19s/epoch - 26ms/step
Epoch 9/50
722/722 - 19s - loss: 12.8898 - accuracy10: 0.4194 - accuracy20: 0.4163 - accuracy30: 0.4067 - accuracy50: 0.3903 - val_loss: 13.0171 - val_accuracy10: 0.4107 - val_accuracy20: 0.4210 - val_accuracy30: 0.4092 - val_accuracy50: 0.3916 - 19s/epoch - 26ms/step
Epoch 10/50
722/722 - 19s - loss: 12.8762 - accuracy10: 0.4219 - accuracy20: 0.4188 - accuracy30: 0.4089 - accuracy50: 0.3914 - val_loss: 13.0070 - val_accuracy10: 0.4109 - val_accuracy20: 0.4227 - val_accuracy30: 0.4111 - val_accuracy50: 0.3919 - 19s/epoch - 26ms/step
Epoch 11/50
722/722 - 19s - loss: 12.8586 - accuracy10: 0.4254 - accuracy20: 0.4218 - accuracy30: 0.4118 - accuracy50: 0.3941 - val_loss: 13.0154 - val_accuracy10: 0.4128 - val_accuracy20: 0.4195 - val_accuracy30: 0.4071 - val_accuracy50: 0.3907 - 19s/epoch - 26ms/step
Epoch 12/50
722/722 - 19s - loss: 12.8468 - accuracy10: 0.4278 - accuracy20: 0.4221 - accuracy30: 0.4126 - accuracy50: 0.3944 - val_loss: 13.0085 - val_accuracy10: 0.4158 - val_accuracy20: 0.4216 - val_accuracy30: 0.4103 - val_accuracy50: 0.3917 - 19s/epoch - 26ms/step
Epoch 13/50
722/722 - 18s - loss: 12.8346 - accuracy10: 0.4302 - accuracy20: 0.4240 - accuracy30: 0.4148 - accuracy50: 0.3956 - val_loss: 13.0072 - val_accuracy10: 0.4156 - val_accuracy20: 0.4203 - val_accuracy30: 0.4096 - val_accuracy50: 0.3927 - 18s/epoch - 26ms/step
Epoch 14/50
722/722 - 19s - loss: 12.8184 - accuracy10: 0.4334 - accuracy20: 0.4274 - accuracy30: 0.4166 - accuracy50: 0.3971 - val_loss: 13.0097 - val_accuracy10: 0.4175 - val_accuracy20: 0.4210 - val_accuracy30: 0.4093 - val_accuracy50: 0.3901 - 19s/epoch - 26ms/step
Epoch 15/50
722/722 - 19s - loss: 12.8003 - accuracy10: 0.4347 - accuracy20: 0.4299 - accuracy30: 0.4184 - accuracy50: 0.3992 - val_loss: 13.0171 - val_accuracy10: 0.4183 - val_accuracy20: 0.4169 - val_accuracy30: 0.4064 - val_accuracy50: 0.3890 - 19s/epoch - 26ms/step
Epoch 16/50
722/722 - 19s - loss: 12.7847 - accuracy10: 0.4383 - accuracy20: 0.4327 - accuracy30: 0.4213 - accuracy50: 0.4000 - val_loss: 13.0163 - val_accuracy10: 0.4220 - val_accuracy20: 0.4191 - val_accuracy30: 0.4084 - val_accuracy50: 0.3887 - 19s/epoch - 26ms/step
Epoch 17/50
722/722 - 19s - loss: 12.7644 - accuracy10: 0.4405 - accuracy20: 0.4350 - accuracy30: 0.4224 - accuracy50: 0.4020 - val_loss: 13.0232 - val_accuracy10: 0.4216 - val_accuracy20: 0.4172 - val_accuracy30: 0.4038 - val_accuracy50: 0.3856 - 19s/epoch - 26ms/step
Epoch 18/50
722/722 - 18s - loss: 12.7462 - accuracy10: 0.4434 - accuracy20: 0.4378 - accuracy30: 0.4251 - accuracy50: 0.4048 - val_loss: 13.0048 - val_accuracy10: 0.4227 - val_accuracy20: 0.4202 - val_accuracy30: 0.4086 - val_accuracy50: 0.3885 - 18s/epoch - 26ms/step
Epoch 19/50
722/722 - 19s - loss: 12.7266 - accuracy10: 0.4444 - accuracy20: 0.4392 - accuracy30: 0.4273 - accuracy50: 0.4068 - val_loss: 13.0337 - val_accuracy10: 0.4248 - val_accuracy20: 0.4144 - val_accuracy30: 0.4042 - val_accuracy50: 0.3863 - 19s/epoch - 26ms/step
Epoch 20/50
722/722 - 19s - loss: 12.7073 - accuracy10: 0.4485 - accuracy20: 0.4427 - accuracy30: 0.4297 - accuracy50: 0.4080 - val_loss: 13.0405 - val_accuracy10: 0.4249 - val_accuracy20: 0.4139 - val_accuracy30: 0.4025 - val_accuracy50: 0.3869 - 19s/epoch - 26ms/step
Epoch 21/50
722/722 - 18s - loss: 12.6899 - accuracy10: 0.4503 - accuracy20: 0.4449 - accuracy30: 0.4312 - accuracy50: 0.4098 - val_loss: 13.0552 - val_accuracy10: 0.4249 - val_accuracy20: 0.4131 - val_accuracy30: 0.4027 - val_accuracy50: 0.3850 - 18s/epoch - 25ms/step
Epoch 22/50
722/722 - 18s - loss: 12.6721 - accuracy10: 0.4522 - accuracy20: 0.4469 - accuracy30: 0.4345 - accuracy50: 0.4124 - val_loss: 13.0645 - val_accuracy10: 0.4252 - val_accuracy20: 0.4123 - val_accuracy30: 0.3999 - val_accuracy50: 0.3818 - 18s/epoch - 25ms/step
Epoch 23/50
722/722 - 18s - loss: 12.6494 - accuracy10: 0.4544 - accuracy20: 0.4500 - accuracy30: 0.4364 - accuracy50: 0.4147 - val_loss: 13.0799 - val_accuracy10: 0.4231 - val_accuracy20: 0.4067 - val_accuracy30: 0.3979 - val_accuracy50: 0.3819 - 18s/epoch - 25ms/step
Epoch 24/50
722/722 - 18s - loss: 12.6356 - accuracy10: 0.4561 - accuracy20: 0.4516 - accuracy30: 0.4387 - accuracy50: 0.4153 - val_loss: 13.0546 - val_accuracy10: 0.4276 - val_accuracy20: 0.4132 - val_accuracy30: 0.4035 - val_accuracy50: 0.3848 - 18s/epoch - 26ms/step
Epoch 25/50
722/722 - 19s - loss: 12.6163 - accuracy10: 0.4578 - accuracy20: 0.4542 - accuracy30: 0.4410 - accuracy50: 0.4176 - val_loss: 13.0857 - val_accuracy10: 0.4246 - val_accuracy20: 0.4090 - val_accuracy30: 0.3979 - val_accuracy50: 0.3812 - 19s/epoch - 26ms/step
Epoch 26/50
722/722 - 18s - loss: 12.6015 - accuracy10: 0.4600 - accuracy20: 0.4563 - accuracy30: 0.4438 - accuracy50: 0.4181 - val_loss: 13.0588 - val_accuracy10: 0.4254 - val_accuracy20: 0.4120 - val_accuracy30: 0.4007 - val_accuracy50: 0.3835 - 18s/epoch - 25ms/step
Epoch 27/50
722/722 - 19s - loss: 12.5893 - accuracy10: 0.4617 - accuracy20: 0.4570 - accuracy30: 0.4435 - accuracy50: 0.4199 - val_loss: 13.0995 - val_accuracy10: 0.4247 - val_accuracy20: 0.4092 - val_accuracy30: 0.3972 - val_accuracy50: 0.3817 - 19s/epoch - 26ms/step
Epoch 28/50
722/722 - 19s - loss: 12.5767 - accuracy10: 0.4620 - accuracy20: 0.4582 - accuracy30: 0.4453 - accuracy50: 0.4220 - val_loss: 13.0858 - val_accuracy10: 0.4257 - val_accuracy20: 0.4085 - val_accuracy30: 0.3963 - val_accuracy50: 0.3781 - 19s/epoch - 26ms/step
testing model: results/PCAR/W1/deepOF_L1/seq2seq
Evaluating performance on  test set...
2607/2607 - 34s - 34s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0727152
{'0': {'precision': 0.41609242478540587, 'recall': 0.529623612004101, 'f1-score': 0.4660434303102356, 'support': 230188}, '1': {'precision': 0.40940015907257254, 'recall': 0.33131436615544196, 'f1-score': 0.3662413779865119, 'support': 215952}, '2': {'precision': 0.4289172083047272, 'recall': 0.3869926345250422, 'f1-score': 0.40687779880014074, 'support': 221167}, 'accuracy': 0.41817484306323777, 'macro avg': {'precision': 0.41813659738756853, 'recall': 0.4159768708948617, 'f1-score': 0.4130542023656294, 'support': 667307}, 'weighted avg': {'precision': 0.4181772384190108, 'recall': 0.41817484306323777, 'f1-score': 0.4141363799906586, 'support': 667307}}
[[121913  51297  56978]
 [ 87423  71548  56981]
 [ 83659  51918  85590]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0827782
{'0': {'precision': 0.43422250271951995, 'recall': 0.5392771615830603, 'f1-score': 0.48108137547193347, 'support': 253888}, '1': {'precision': 0.32171647026818057, 'recall': 0.2713778443403063, 'f1-score': 0.2944109226465405, 'support': 165592}, '2': {'precision': 0.4494282000075361, 'recall': 0.3850226165833424, 'f1-score': 0.4147398938146951, 'support': 247827}, 'accuracy': 0.41551040225863056, 'macro avg': {'precision': 0.4017890576650789, 'recall': 0.39855920750223633, 'f1-score': 0.39674406397772305, 'support': 667307}, 'weighted avg': {'precision': 0.4119513193153521, 'recall': 0.41551040225863056, 'f1-score': 0.4101210168979475, 'support': 667307}}
[[136916  47307  69665]
 [ 73426  44938  47228]
 [104971  47437  95419]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0881618
{'0': {'precision': 0.41058214368069096, 'recall': 0.5568837709945369, 'f1-score': 0.4726709830447704, 'support': 246195}, '1': {'precision': 0.322850513979915, 'recall': 0.21310082718533424, 'f1-score': 0.2567386488360975, 'support': 178920}, '2': {'precision': 0.42732990227044704, 'recall': 0.37985978066988174, 'f1-score': 0.4021990032351141, 'support': 242192}, 'accuracy': 0.4004588592656753, 'macro avg': {'precision': 0.386920853310351, 'recall': 0.38328145961658433, 'f1-score': 0.377202878371994, 'support': 667307}, 'weighted avg': {'precision': 0.3931377439700741, 'recall': 0.4004588592656753, 'f1-score': 0.38919761475899484, 'support': 667307}}
[[137102  40165  68928]
 [ 86431  38128  54361]
 [110388  39805  91999]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0938449
{'0': {'precision': 0.3815417594962079, 'recall': 0.5621279491250519, 'f1-score': 0.4545558362459771, 'support': 233671}, '1': {'precision': 0.33481754803001545, 'recall': 0.18556133434270938, 'f1-score': 0.23878444371346877, 'support': 203426}, '2': {'precision': 0.39255145128770874, 'recall': 0.35859432691890014, 'f1-score': 0.37480533749824063, 'support': 230210}, 'accuracy': 0.37711727885366103, 'macro avg': {'precision': 0.369636919604644, 'recall': 0.3687612034622205, 'f1-score': 0.35604853915256224, 'support': 667307}, 'weighted avg': {'precision': 0.3710962249905002, 'recall': 0.37711727885366103, 'f1-score': 0.3612661305872107, 'support': 667307}}
[[131353  37539  64779]
 [102713  37748  62965]
 [110203  37455  82552]]
Evaluating performance on  train set...
722/722 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0543864
{'0': {'precision': 0.3820995894516787, 'recall': 0.5549235496378667, 'f1-score': 0.4525737981235364, 'support': 54676}, '1': {'precision': 0.5148499126475726, 'recall': 0.38609144445179644, 'f1-score': 0.4412698892854982, 'support': 75565}, '2': {'precision': 0.41482533020614737, 'recall': 0.37038465777581836, 'f1-score': 0.3913473855828578, 'support': 54438}, 'accuracy': 0.4314459142620439, 'macro avg': {'precision': 0.43725827743513285, 'recall': 0.43713321728849386, 'f1-score': 0.42839702433063076, 'support': 184679}, 'weighted avg': {'precision': 0.4460635596241915, 'recall': 0.4314459142620439, 'f1-score': 0.4299008178862824, 'support': 184679}}
[[30341 12759 11576]
 [29523 29175 16867]
 [19542 14733 20163]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0658466
{'0': {'precision': 0.41240370865814846, 'recall': 0.5759610893688296, 'f1-score': 0.4806494318143636, 'support': 62091}, '1': {'precision': 0.4378666185362332, 'recall': 0.32174532915568377, 'f1-score': 0.3709302881169669, 'support': 60321}, '2': {'precision': 0.4439493652006935, 'recall': 0.3824337128816227, 'f1-score': 0.4109019377771643, 'support': 62267}, 'accuracy': 0.4276772128937237, 'macro avg': {'precision': 0.4314065641316917, 'recall': 0.42671337713537866, 'f1-score': 0.4208272192361649, 'support': 184679}, 'weighted avg': {'precision': 0.431356603046198, 'recall': 0.4276772128937237, 'f1-score': 0.42129598243362754, 'support': 184679}}
[[35762 11659 14670]
 [25757 19408 15156]
 [25197 13257 23813]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0724866
{'0': {'precision': 0.40065171182252723, 'recall': 0.600802537052618, 'f1-score': 0.4807260345798567, 'support': 61804}, '1': {'precision': 0.4313294702441436, 'recall': 0.2589697929033109, 'f1-score': 0.3236315306868876, 'support': 60648}, '2': {'precision': 0.43141381977800564, 'recall': 0.3853793369437704, 'f1-score': 0.4070993260563261, 'support': 62227}, 'accuracy': 0.41595958392670523, 'macro avg': {'precision': 0.4211316672815588, 'recall': 0.4150505556332331, 'f1-score': 0.4038189637743568, 'support': 184679}, 'weighted avg': {'precision': 0.4210913849012191, 'recall': 0.41595958392670523, 'f1-score': 0.40432841133414643, 'support': 184679}}
[[37132  9746 14926]
 [28262 15706 16680]
 [27285 10961 23981]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0810071
{'0': {'precision': 0.38794073518379596, 'recall': 0.603452188006483, 'f1-score': 0.4722722544965626, 'support': 61700}, '1': {'precision': 0.40417812981830276, 'recall': 0.220483219262802, 'f1-score': 0.2853209834386204, 'support': 60635}, '2': {'precision': 0.41590263545823897, 'recall': 0.371086231233158, 'f1-score': 0.3922183606001526, 'support': 62344}, 'accuracy': 0.3992711678100921, 'macro avg': {'precision': 0.4026738334867792, 'recall': 0.398340546167481, 'f1-score': 0.38327053284511187, 'support': 184679}, 'weighted avg': {'precision': 0.4027112891415995, 'recall': 0.3992711678100921, 'f1-score': 0.3838665869237681, 'support': 184679}}
[[37233  9380 15087]
 [29862 13369 17404]
 [28881 10328 23135]]
Evaluating performance on  val set...
227/227 - 3s - 3s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0653459
{'0': {'precision': 0.40713465573900304, 'recall': 0.5476672347677887, 'f1-score': 0.4670587968114823, 'support': 18776}, '1': {'precision': 0.4436295908270764, 'recall': 0.3707018141140995, 'f1-score': 0.40390016427322345, 'support': 20561}, '2': {'precision': 0.43148892718105814, 'recall': 0.3602024507192328, 'f1-score': 0.39263625540811287, 'support': 18770}, 'accuracy': 0.42449274614074034, 'macro avg': {'precision': 0.42741772458237914, 'recall': 0.42619049986704033, 'f1-score': 0.4211984054976062, 'support': 58107}, 'weighted avg': {'precision': 0.42791531960589085, 'recall': 0.42449274614074034, 'f1-score': 0.4206699667951266, 'support': 58107}}
[[10283  4399  4094]
 [ 8125  7622  4814]
 [ 6849  5160  6761]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0777687
{'0': {'precision': 0.43778886361969044, 'recall': 0.5593569855181141, 'f1-score': 0.4911623695960822, 'support': 21337}, '1': {'precision': 0.3473934674453818, 'recall': 0.30900461775269367, 'f1-score': 0.3270764739825532, 'support': 15592}, '2': {'precision': 0.4502827521206409, 'recall': 0.3609405987345358, 'f1-score': 0.40069193269381975, 'support': 21178}, 'accuracy': 0.4198633555337567, 'macro avg': {'precision': 0.41182169439523775, 'recall': 0.4097674006684478, 'f1-score': 0.406310258757485, 'support': 58107}, 'weighted avg': {'precision': 0.41808642765712667, 'recall': 0.4198633555337567, 'f1-score': 0.4141594233568639, 'support': 58107}}
[[11935  4189  5213]
 [ 6655  4818  4119]
 [ 8672  4862  7644]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0838814
{'0': {'precision': 0.42205994324081125, 'recall': 0.5776882993841781, 'f1-score': 0.4877609791216703, 'support': 21110}, '1': {'precision': 0.34190709873931807, 'recall': 0.2505269683818971, 'f1-score': 0.28916955883931444, 'support': 16130}, '2': {'precision': 0.429745889387145, 'recall': 0.35822111467867923, 'f1-score': 0.39073730430464443, 'support': 20867}, 'accuracy': 0.40805754900442287, 'macro avg': {'precision': 0.3979043104557581, 'recall': 0.39547879414825154, 'f1-score': 0.3892226140885431, 'support': 58107}, 'weighted avg': {'precision': 0.40257033366582823, 'recall': 0.40805754900442287, 'f1-score': 0.3977912227831693, 'support': 58107}}
[[12195  3624  5291]
 [ 7461  4041  4628]
 [ 9238  4154  7475]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0897313
{'0': {'precision': 0.3969332753021527, 'recall': 0.5811479829420126, 'f1-score': 0.47169285856375576, 'support': 20401}, '1': {'precision': 0.3437814127752901, 'recall': 0.21502057613168724, 'f1-score': 0.2645662646365906, 'support': 17496}, '2': {'precision': 0.40190806591500433, 'recall': 0.34393864423552695, 'f1-score': 0.3706705772563658, 'support': 20210}, 'accuracy': 0.38840415096287884, 'macro avg': {'precision': 0.3808742513308157, 'recall': 0.3800357344364089, 'f1-score': 0.36897656681890406, 'support': 58107}, 'weighted avg': {'precision': 0.3826595308568319, 'recall': 0.38840415096287884, 'f1-score': 0.37419088474696893, 'support': 58107}}
[[11856  3374  5171]
 [ 8561  3762  5173]
 [ 9452  3807  6951]]
training model: results/PCAR/W1/deepLOB_L2/seq2seq
Epoch 1/50
722/722 - 43s - loss: 12.8146 - accuracy10: 0.4324 - accuracy20: 0.4284 - accuracy30: 0.4182 - accuracy50: 0.4005 - val_loss: 13.8934 - val_accuracy10: 0.3690 - val_accuracy20: 0.3400 - val_accuracy30: 0.3409 - val_accuracy50: 0.3468 - 43s/epoch - 59ms/step
Epoch 2/50
722/722 - 37s - loss: 12.5105 - accuracy10: 0.4691 - accuracy20: 0.4615 - accuracy30: 0.4457 - accuracy50: 0.4199 - val_loss: 13.4167 - val_accuracy10: 0.4134 - val_accuracy20: 0.3924 - val_accuracy30: 0.3874 - val_accuracy50: 0.3793 - 37s/epoch - 52ms/step
Epoch 3/50
722/722 - 37s - loss: 12.3749 - accuracy10: 0.4852 - accuracy20: 0.4773 - accuracy30: 0.4589 - accuracy50: 0.4300 - val_loss: 12.9462 - val_accuracy10: 0.4606 - val_accuracy20: 0.4412 - val_accuracy30: 0.4278 - val_accuracy50: 0.4030 - 37s/epoch - 51ms/step
Epoch 4/50
722/722 - 37s - loss: 12.2625 - accuracy10: 0.4991 - accuracy20: 0.4871 - accuracy30: 0.4669 - accuracy50: 0.4347 - val_loss: 12.8568 - val_accuracy10: 0.4655 - val_accuracy20: 0.4487 - val_accuracy30: 0.4315 - val_accuracy50: 0.4054 - 37s/epoch - 52ms/step
Epoch 5/50
722/722 - 37s - loss: 12.1896 - accuracy10: 0.5072 - accuracy20: 0.4942 - accuracy30: 0.4726 - accuracy50: 0.4386 - val_loss: 12.7840 - val_accuracy10: 0.4734 - val_accuracy20: 0.4552 - val_accuracy30: 0.4355 - val_accuracy50: 0.4061 - 37s/epoch - 51ms/step
Epoch 6/50
722/722 - 37s - loss: 12.1347 - accuracy10: 0.5146 - accuracy20: 0.5001 - accuracy30: 0.4777 - accuracy50: 0.4411 - val_loss: 12.7730 - val_accuracy10: 0.4749 - val_accuracy20: 0.4583 - val_accuracy30: 0.4406 - val_accuracy50: 0.4095 - 37s/epoch - 51ms/step
Epoch 7/50
722/722 - 37s - loss: 12.0726 - accuracy10: 0.5210 - accuracy20: 0.5058 - accuracy30: 0.4822 - accuracy50: 0.4440 - val_loss: 12.8850 - val_accuracy10: 0.4715 - val_accuracy20: 0.4516 - val_accuracy30: 0.4340 - val_accuracy50: 0.4057 - 37s/epoch - 51ms/step
Epoch 8/50
722/722 - 37s - loss: 12.0229 - accuracy10: 0.5273 - accuracy20: 0.5107 - accuracy30: 0.4855 - accuracy50: 0.4462 - val_loss: 12.7201 - val_accuracy10: 0.4771 - val_accuracy20: 0.4657 - val_accuracy30: 0.4459 - val_accuracy50: 0.4119 - 37s/epoch - 51ms/step
Epoch 9/50
722/722 - 37s - loss: 11.9768 - accuracy10: 0.5308 - accuracy20: 0.5139 - accuracy30: 0.4894 - accuracy50: 0.4489 - val_loss: 12.7171 - val_accuracy10: 0.4808 - val_accuracy20: 0.4679 - val_accuracy30: 0.4475 - val_accuracy50: 0.4130 - 37s/epoch - 51ms/step
Epoch 10/50
722/722 - 37s - loss: 11.9373 - accuracy10: 0.5352 - accuracy20: 0.5179 - accuracy30: 0.4919 - accuracy50: 0.4505 - val_loss: 12.7583 - val_accuracy10: 0.4824 - val_accuracy20: 0.4685 - val_accuracy30: 0.4475 - val_accuracy50: 0.4122 - 37s/epoch - 52ms/step
Epoch 11/50
722/722 - 37s - loss: 11.9040 - accuracy10: 0.5383 - accuracy20: 0.5196 - accuracy30: 0.4936 - accuracy50: 0.4524 - val_loss: 12.7480 - val_accuracy10: 0.4808 - val_accuracy20: 0.4684 - val_accuracy30: 0.4474 - val_accuracy50: 0.4132 - 37s/epoch - 52ms/step
Epoch 12/50
722/722 - 37s - loss: 11.8717 - accuracy10: 0.5410 - accuracy20: 0.5235 - accuracy30: 0.4973 - accuracy50: 0.4549 - val_loss: 12.7428 - val_accuracy10: 0.4775 - val_accuracy20: 0.4689 - val_accuracy30: 0.4483 - val_accuracy50: 0.4133 - 37s/epoch - 52ms/step
Epoch 13/50
722/722 - 37s - loss: 11.8393 - accuracy10: 0.5440 - accuracy20: 0.5255 - accuracy30: 0.4986 - accuracy50: 0.4557 - val_loss: 12.6188 - val_accuracy10: 0.4852 - val_accuracy20: 0.4755 - val_accuracy30: 0.4530 - val_accuracy50: 0.4138 - 37s/epoch - 52ms/step
Epoch 14/50
722/722 - 37s - loss: 11.8018 - accuracy10: 0.5467 - accuracy20: 0.5282 - accuracy30: 0.5011 - accuracy50: 0.4572 - val_loss: 12.7285 - val_accuracy10: 0.4868 - val_accuracy20: 0.4733 - val_accuracy30: 0.4506 - val_accuracy50: 0.4133 - 37s/epoch - 51ms/step
Epoch 15/50
722/722 - 37s - loss: 11.7783 - accuracy10: 0.5472 - accuracy20: 0.5287 - accuracy30: 0.5026 - accuracy50: 0.4591 - val_loss: 12.7085 - val_accuracy10: 0.4824 - val_accuracy20: 0.4732 - val_accuracy30: 0.4520 - val_accuracy50: 0.4131 - 37s/epoch - 52ms/step
Epoch 16/50
722/722 - 37s - loss: 11.7404 - accuracy10: 0.5499 - accuracy20: 0.5329 - accuracy30: 0.5062 - accuracy50: 0.4624 - val_loss: 12.7465 - val_accuracy10: 0.4836 - val_accuracy20: 0.4768 - val_accuracy30: 0.4540 - val_accuracy50: 0.4164 - 37s/epoch - 51ms/step
Epoch 17/50
722/722 - 37s - loss: 11.7169 - accuracy10: 0.5526 - accuracy20: 0.5347 - accuracy30: 0.5074 - accuracy50: 0.4631 - val_loss: 12.7950 - val_accuracy10: 0.4822 - val_accuracy20: 0.4751 - val_accuracy30: 0.4514 - val_accuracy50: 0.4121 - 37s/epoch - 51ms/step
Epoch 18/50
722/722 - 37s - loss: 11.6830 - accuracy10: 0.5541 - accuracy20: 0.5374 - accuracy30: 0.5104 - accuracy50: 0.4661 - val_loss: 12.8761 - val_accuracy10: 0.4816 - val_accuracy20: 0.4722 - val_accuracy30: 0.4490 - val_accuracy50: 0.4102 - 37s/epoch - 52ms/step
Epoch 19/50
722/722 - 37s - loss: 11.6578 - accuracy10: 0.5559 - accuracy20: 0.5396 - accuracy30: 0.5129 - accuracy50: 0.4677 - val_loss: 12.7799 - val_accuracy10: 0.4795 - val_accuracy20: 0.4749 - val_accuracy30: 0.4518 - val_accuracy50: 0.4136 - 37s/epoch - 51ms/step
Epoch 20/50
722/722 - 37s - loss: 11.6276 - accuracy10: 0.5563 - accuracy20: 0.5403 - accuracy30: 0.5144 - accuracy50: 0.4693 - val_loss: 12.7846 - val_accuracy10: 0.4858 - val_accuracy20: 0.4774 - val_accuracy30: 0.4525 - val_accuracy50: 0.4130 - 37s/epoch - 51ms/step
Epoch 21/50
722/722 - 37s - loss: 11.6040 - accuracy10: 0.5590 - accuracy20: 0.5429 - accuracy30: 0.5156 - accuracy50: 0.4711 - val_loss: 12.8247 - val_accuracy10: 0.4792 - val_accuracy20: 0.4742 - val_accuracy30: 0.4508 - val_accuracy50: 0.4129 - 37s/epoch - 51ms/step
Epoch 22/50
722/722 - 37s - loss: 11.5848 - accuracy10: 0.5602 - accuracy20: 0.5444 - accuracy30: 0.5178 - accuracy50: 0.4725 - val_loss: 12.9109 - val_accuracy10: 0.4831 - val_accuracy20: 0.4743 - val_accuracy30: 0.4499 - val_accuracy50: 0.4098 - 37s/epoch - 51ms/step
Epoch 23/50
722/722 - 38s - loss: 11.5505 - accuracy10: 0.5630 - accuracy20: 0.5475 - accuracy30: 0.5208 - accuracy50: 0.4750 - val_loss: 12.9486 - val_accuracy10: 0.4769 - val_accuracy20: 0.4711 - val_accuracy30: 0.4486 - val_accuracy50: 0.4110 - 38s/epoch - 53ms/step
testing model: results/PCAR/W1/deepLOB_L2/seq2seq
Evaluating performance on  test set...
2607/2607 - 53s - 53s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0310411
{'0': {'precision': 0.49984468265081317, 'recall': 0.4543724749120292, 'f1-score': 0.47602511383832563, 'support': 230190}, '1': {'precision': 0.5314408864596789, 'recall': 0.3791056387269452, 'f1-score': 0.4425303510232322, 'support': 215953}, '2': {'precision': 0.45171572174782576, 'recall': 0.6209143234359246, 'f1-score': 0.522970175996466, 'support': 221169}, 'accuracy': 0.48521231447958374, 'macro avg': {'precision': 0.4943337636194393, 'recall': 0.4847974790249663, 'f1-score': 0.48050854695267464, 'support': 667312}, 'weighted avg': {'precision': 0.4941182171402022, 'recall': 0.48521231447958374, 'f1-score': 0.48074479209713983, 'support': 667312}}
[[104592  39518  86080]
 [ 53479  81869  80605]
 [ 51178  32664 137327]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0430843
{'0': {'precision': 0.5089122015785088, 'recall': 0.40888967663161213, 'f1-score': 0.45345068576919717, 'support': 253890}, '1': {'precision': 0.4112898008823796, 'recall': 0.3839390316074254, 'f1-score': 0.39714407076108144, 'support': 165594}, '2': {'precision': 0.4764883073135972, 'recall': 0.5936012072889262, 'f1-score': 0.5286362133647641, 'support': 247828}, 'accuracy': 0.4712967847123984, 'macro avg': {'precision': 0.4655634365914952, 'recall': 0.46214330517598795, 'f1-score': 0.4597436566316809, 'support': 667312}, 'weighted avg': {'precision': 0.4726454587524255, 'recall': 0.4712967847123984, 'f1-score': 0.46740074410367977, 'support': 667312}}
[[103813  49422 100655]
 [ 41042  63578  60974]
 [ 59135  41582 147111]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0669919
{'0': {'precision': 0.47419018081569775, 'recall': 0.38006555725699337, 'f1-score': 0.4219423933261935, 'support': 246197}, '1': {'precision': 0.389079459348761, 'recall': 0.3397943214844623, 'f1-score': 0.36277060410053225, 'support': 178920}, '2': {'precision': 0.45075351897184823, 'recall': 0.5838848861454613, 'f1-score': 0.5087539101638175, 'support': 242195}, 'accuracy': 0.44324244131680535, 'macro avg': {'precision': 0.43800771971210234, 'recall': 0.434581588295639, 'f1-score': 0.4311556358635144, 'support': 667312}, 'weighted avg': {'precision': 0.4428641255370043, 'recall': 0.44324244131680535, 'f1-score': 0.4375846997619133, 'support': 667312}}
[[ 93571  51514 101112]
 [ 46922  60796  71202]
 [ 56835  43946 141414]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0932263
{'0': {'precision': 0.43224015823390544, 'recall': 0.3478979081789859, 'f1-score': 0.3855098305149046, 'support': 233672}, '1': {'precision': 0.3675126088808499, 'recall': 0.29264899620504553, 'f1-score': 0.32583596274940685, 'support': 203428}, '2': {'precision': 0.40645616822223696, 'recall': 0.5601228432922697, 'f1-score': 0.47107454622172623, 'support': 230212}, 'accuracy': 0.4042696669623804, 'macro avg': {'precision': 0.40206964511233073, 'recall': 0.4002232492254338, 'f1-score': 0.3941401131620126, 'support': 667312}, 'weighted avg': {'precision': 0.4036130994992212, 'recall': 0.4042696669623804, 'f1-score': 0.3968368990533082, 'support': 667312}}
[[ 81294  54507  97871]
 [ 53466  59533  90429]
 [ 53316  47949 128947]]
Evaluating performance on  train set...
722/722 - 15s - 15s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0173469
{'0': {'precision': 0.4608259229318243, 'recall': 0.49999086340794885, 'f1-score': 0.4796101699371609, 'support': 54725}, '1': {'precision': 0.5944926621429698, 'recall': 0.49830033199740753, 'f1-score': 0.5421628661682485, 'support': 75603}, '2': {'precision': 0.44109858882035713, 'recall': 0.5026309979393583, 'f1-score': 0.46985879641573364, 'support': 54352}, 'accuracy': 0.500075806800953, 'macro avg': {'precision': 0.4988057246317171, 'recall': 0.5003073977815715, 'f1-score': 0.49721061084038104, 'support': 184680}, 'weighted avg': {'precision': 0.5097396462421653, 'recall': 0.500075806800953, 'f1-score': 0.502347688019911, 'support': 184680}}
[[27362 12651 14712]
 [18027 37673 19903]
 [13987 13046 27319]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0381718
{'0': {'precision': 0.48818412220015067, 'recall': 0.45940632352467203, 'f1-score': 0.47335823993358234, 'support': 62054}, '1': {'precision': 0.4922817850126298, 'recall': 0.5219202539178734, 'f1-score': 0.5066679505079197, 'support': 60492}, '2': {'precision': 0.47332260659694286, 'recall': 0.4734444909389384, 'f1-score': 0.47338354092240353, 'support': 62134}, 'accuracy': 0.4846058046350444, 'macro avg': {'precision': 0.4845961712699078, 'recall': 0.48492368946049463, 'f1-score': 0.4844699104546352, 'support': 184680}, 'weighted avg': {'precision': 0.48452628382221463, 'recall': 0.4846058046350444, 'f1-score': 0.48427735983667, 'support': 184680}}
[[28508 16232 17314]
 [13501 31572 15419]
 [16387 16330 29417]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0560507
{'0': {'precision': 0.4699410123273639, 'recall': 0.4299263232727978, 'f1-score': 0.44904399480230184, 'support': 61892}, '1': {'precision': 0.46303333642289984, 'recall': 0.495028901734104, 'f1-score': 0.4784968551451103, 'support': 60550}, '2': {'precision': 0.4538089823763502, 'recall': 0.46172756193965103, 'f1-score': 0.45773402781096184, 'support': 62238}, 'accuracy': 0.4619883040935672, 'macro avg': {'precision': 0.462261110375538, 'recall': 0.4622275956488509, 'f1-score': 0.4617582925861246, 'support': 184680}, 'weighted avg': {'precision': 0.4622396637454574, 'recall': 0.4619883040935672, 'f1-score': 0.4616291202525403, 'support': 184680}}
[[26609 17417 17866]
 [13855 29974 16721]
 [16158 17343 28737]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0880091
{'0': {'precision': 0.44046452281006715, 'recall': 0.3859765681969179, 'f1-score': 0.4114243272187101, 'support': 61711}, '1': {'precision': 0.41334224233496836, 'recall': 0.4492251324454127, 'f1-score': 0.4305373214596416, 'support': 60591}, '2': {'precision': 0.4261798863355572, 'recall': 0.4423995639488281, 'f1-score': 0.4341382836466609, 'support': 62378}, 'accuracy': 0.4257851418670132, 'macro avg': {'precision': 0.42666221716019753, 'recall': 0.42586708819705293, 'f1-score': 0.4253666441083375, 'support': 184680}, 'weighted avg': {'precision': 0.42674125472324836, 'recall': 0.4257851418670132, 'f1-score': 0.4253669664222784, 'support': 184680}}
[[23819 19508 18384]
 [14600 27219 18772]
 [15658 19124 27596]]
Evaluating performance on  val set...
227/227 - 5s - 5s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0302249
{'0': {'precision': 0.4929637526652452, 'recall': 0.4924912131217382, 'f1-score': 0.49272736959880653, 'support': 18778}, '1': {'precision': 0.5463442717328728, 'recall': 0.3686510634165291, 'f1-score': 0.44024354885474054, 'support': 20594}, '2': {'precision': 0.44397296872544395, 'recall': 0.6031169940222032, 'f1-score': 0.5114510726894179, 'support': 18736}, 'accuracy': 0.4842706684105459, 'macro avg': {'precision': 0.494426997707854, 'recall': 0.4880864235201568, 'f1-score': 0.481473997047655, 'support': 58108}, 'weighted avg': {'precision': 0.4960859919745074, 'recall': 0.4842706684105459, 'f1-score': 0.48016378965632706, 'support': 58108}}
[[ 9248  3134  6396]
 [ 5246  7592  7756]
 [ 4266  3170 11300]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0372303
{'0': {'precision': 0.5177998804282842, 'recall': 0.4476132305957527, 'f1-score': 0.48015523019932965, 'support': 21284}, '1': {'precision': 0.42722669899450905, 'recall': 0.3819816373374139, 'f1-score': 0.40333928030430544, 'support': 15684}, '2': {'precision': 0.4746165226193257, 'recall': 0.5766792809839167, 'f1-score': 0.5206936317430487, 'support': 21140}, 'accuracy': 0.47685344530873547, 'macro avg': {'precision': 0.473214367347373, 'recall': 0.4687580496390278, 'f1-score': 0.46806271408222794, 'support': 58108}, 'weighted avg': {'precision': 0.4776428287023822, 'recall': 0.47685344530873547, 'f1-score': 0.47416983146732483, 'support': 58108}}
[[ 9527  4109  7648]
 [ 3846  5991  5847]
 [ 5026  3923 12191]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0554029
{'0': {'precision': 0.4962921348314607, 'recall': 0.4177424693809997, 'f1-score': 0.45364212904716666, 'support': 21147}, '1': {'precision': 0.4032752613240418, 'recall': 0.3603362391033624, 'f1-score': 0.38059848733969087, 'support': 16060}, '2': {'precision': 0.45307804915632943, 'recall': 0.5627003492655854, 'f1-score': 0.5019740071277663, 'support': 20901}, 'accuracy': 0.454016658635644, 'macro avg': {'precision': 0.45088181510394393, 'recall': 0.4469263525833158, 'f1-score': 0.44540487450487465, 'support': 58108}, 'weighted avg': {'precision': 0.45504017996767143, 'recall': 0.454016658635644, 'f1-score': 0.4508387921217959, 'support': 58108}}
[[ 8834  4407  7906]
 [ 3982  5787  6291]
 [ 4984  4156 11761]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0839442
{'0': {'precision': 0.4527451677931934, 'recall': 0.37462591375165577, 'f1-score': 0.40999758382775375, 'support': 20383}, '1': {'precision': 0.3741160773849233, 'recall': 0.32054872820805946, 'f1-score': 0.345267046329075, 'support': 17495}, '2': {'precision': 0.41707298491543504, 'recall': 0.5412259021255561, 'f1-score': 0.4711070952196549, 'support': 20230}, 'accuracy': 0.41634542575893163, 'macro avg': {'precision': 0.4146447433645173, 'recall': 0.4121335146950904, 'f1-score': 0.40879057512549455, 'support': 58108}, 'weighted avg': {'precision': 0.4166526470334058, 'recall': 0.41634542575893163, 'f1-score': 0.4117836487743837, 'support': 58108}}
[[ 7636  4892  7855]
 [ 4439  5608  7448]
 [ 4791  4490 10949]]
training model: results/PCAR/W1/deepOF_L2/seq2seq
Epoch 1/50
722/722 - 30s - loss: 12.7180 - accuracy10: 0.4507 - accuracy20: 0.4393 - accuracy30: 0.4229 - accuracy50: 0.3990 - val_loss: 12.7530 - val_accuracy10: 0.4694 - val_accuracy20: 0.4353 - val_accuracy30: 0.4112 - val_accuracy50: 0.3795 - 30s/epoch - 42ms/step
Epoch 2/50
722/722 - 25s - loss: 12.2325 - accuracy10: 0.5143 - accuracy20: 0.4948 - accuracy30: 0.4676 - accuracy50: 0.4274 - val_loss: 12.6432 - val_accuracy10: 0.4878 - val_accuracy20: 0.4628 - val_accuracy30: 0.4354 - val_accuracy50: 0.3967 - 25s/epoch - 34ms/step
Epoch 3/50
722/722 - 25s - loss: 12.0457 - accuracy10: 0.5315 - accuracy20: 0.5116 - accuracy30: 0.4822 - accuracy50: 0.4383 - val_loss: 12.5946 - val_accuracy10: 0.4972 - val_accuracy20: 0.4715 - val_accuracy30: 0.4436 - val_accuracy50: 0.4023 - 25s/epoch - 34ms/step
Epoch 4/50
722/722 - 25s - loss: 11.9715 - accuracy10: 0.5371 - accuracy20: 0.5173 - accuracy30: 0.4881 - accuracy50: 0.4427 - val_loss: 12.5525 - val_accuracy10: 0.5032 - val_accuracy20: 0.4772 - val_accuracy30: 0.4491 - val_accuracy50: 0.4057 - 25s/epoch - 35ms/step
Epoch 5/50
722/722 - 25s - loss: 11.9138 - accuracy10: 0.5417 - accuracy20: 0.5215 - accuracy30: 0.4924 - accuracy50: 0.4460 - val_loss: 12.5695 - val_accuracy10: 0.5051 - val_accuracy20: 0.4772 - val_accuracy30: 0.4490 - val_accuracy50: 0.4068 - 25s/epoch - 34ms/step
Epoch 6/50
722/722 - 24s - loss: 11.8739 - accuracy10: 0.5444 - accuracy20: 0.5246 - accuracy30: 0.4959 - accuracy50: 0.4493 - val_loss: 12.5626 - val_accuracy10: 0.5076 - val_accuracy20: 0.4768 - val_accuracy30: 0.4496 - val_accuracy50: 0.4077 - 24s/epoch - 34ms/step
Epoch 7/50
722/722 - 24s - loss: 11.8337 - accuracy10: 0.5476 - accuracy20: 0.5271 - accuracy30: 0.4973 - accuracy50: 0.4517 - val_loss: 12.5603 - val_accuracy10: 0.5079 - val_accuracy20: 0.4774 - val_accuracy30: 0.4508 - val_accuracy50: 0.4087 - 24s/epoch - 34ms/step
Epoch 8/50
722/722 - 24s - loss: 11.8008 - accuracy10: 0.5499 - accuracy20: 0.5295 - accuracy30: 0.4994 - accuracy50: 0.4536 - val_loss: 12.4989 - val_accuracy10: 0.5098 - val_accuracy20: 0.4816 - val_accuracy30: 0.4537 - val_accuracy50: 0.4098 - 24s/epoch - 34ms/step
Epoch 9/50
722/722 - 25s - loss: 11.7701 - accuracy10: 0.5510 - accuracy20: 0.5317 - accuracy30: 0.5016 - accuracy50: 0.4542 - val_loss: 12.5308 - val_accuracy10: 0.5073 - val_accuracy20: 0.4806 - val_accuracy30: 0.4546 - val_accuracy50: 0.4109 - 25s/epoch - 34ms/step
Epoch 10/50
722/722 - 24s - loss: 11.7411 - accuracy10: 0.5538 - accuracy20: 0.5337 - accuracy30: 0.5041 - accuracy50: 0.4573 - val_loss: 12.5395 - val_accuracy10: 0.5092 - val_accuracy20: 0.4804 - val_accuracy30: 0.4534 - val_accuracy50: 0.4118 - 24s/epoch - 34ms/step
Epoch 11/50
722/722 - 24s - loss: 11.7193 - accuracy10: 0.5550 - accuracy20: 0.5359 - accuracy30: 0.5060 - accuracy50: 0.4604 - val_loss: 12.5456 - val_accuracy10: 0.5104 - val_accuracy20: 0.4826 - val_accuracy30: 0.4542 - val_accuracy50: 0.4107 - 24s/epoch - 34ms/step
Epoch 12/50
722/722 - 25s - loss: 11.6820 - accuracy10: 0.5568 - accuracy20: 0.5379 - accuracy30: 0.5082 - accuracy50: 0.4629 - val_loss: 12.5627 - val_accuracy10: 0.5110 - val_accuracy20: 0.4813 - val_accuracy30: 0.4541 - val_accuracy50: 0.4098 - 25s/epoch - 34ms/step
Epoch 13/50
722/722 - 25s - loss: 11.6595 - accuracy10: 0.5576 - accuracy20: 0.5391 - accuracy30: 0.5108 - accuracy50: 0.4657 - val_loss: 12.5407 - val_accuracy10: 0.5108 - val_accuracy20: 0.4829 - val_accuracy30: 0.4557 - val_accuracy50: 0.4111 - 25s/epoch - 34ms/step
Epoch 14/50
722/722 - 24s - loss: 11.6329 - accuracy10: 0.5597 - accuracy20: 0.5416 - accuracy30: 0.5128 - accuracy50: 0.4672 - val_loss: 12.5282 - val_accuracy10: 0.5117 - val_accuracy20: 0.4825 - val_accuracy30: 0.4547 - val_accuracy50: 0.4119 - 24s/epoch - 34ms/step
Epoch 15/50
722/722 - 25s - loss: 11.6048 - accuracy10: 0.5612 - accuracy20: 0.5431 - accuracy30: 0.5151 - accuracy50: 0.4694 - val_loss: 12.5853 - val_accuracy10: 0.5132 - val_accuracy20: 0.4832 - val_accuracy30: 0.4560 - val_accuracy50: 0.4112 - 25s/epoch - 35ms/step
Epoch 16/50
722/722 - 25s - loss: 11.5830 - accuracy10: 0.5622 - accuracy20: 0.5452 - accuracy30: 0.5168 - accuracy50: 0.4717 - val_loss: 12.5637 - val_accuracy10: 0.5099 - val_accuracy20: 0.4812 - val_accuracy30: 0.4543 - val_accuracy50: 0.4093 - 25s/epoch - 34ms/step
Epoch 17/50
722/722 - 25s - loss: 11.5564 - accuracy10: 0.5631 - accuracy20: 0.5469 - accuracy30: 0.5197 - accuracy50: 0.4731 - val_loss: 12.5732 - val_accuracy10: 0.5128 - val_accuracy20: 0.4841 - val_accuracy30: 0.4539 - val_accuracy50: 0.4088 - 25s/epoch - 34ms/step
Epoch 18/50
722/722 - 25s - loss: 11.5255 - accuracy10: 0.5642 - accuracy20: 0.5496 - accuracy30: 0.5212 - accuracy50: 0.4760 - val_loss: 12.5793 - val_accuracy10: 0.5126 - val_accuracy20: 0.4813 - val_accuracy30: 0.4539 - val_accuracy50: 0.4097 - 25s/epoch - 34ms/step
testing model: results/PCAR/W1/deepOF_L2/seq2seq
Evaluating performance on  test set...
2607/2607 - 39s - 39s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9959923
{'0': {'precision': 0.47846135775478266, 'recall': 0.5485776843275931, 'f1-score': 0.5111260875636752, 'support': 230188}, '1': {'precision': 0.5262531766039952, 'recall': 0.48138012150848336, 'f1-score': 0.5028174804711117, 'support': 215952}, '2': {'precision': 0.512319769927325, 'recall': 0.47683424742389235, 'f1-score': 0.49394049389365713, 'support': 221167}, 'accuracy': 0.5030533172887441, 'macro avg': {'precision': 0.505678101428701, 'recall': 0.502264017753323, 'f1-score': 0.5026280206428148, 'support': 667307}, 'weighted avg': {'precision': 0.5051493773755715, 'recall': 0.5030533172887441, 'f1-score': 0.5027414212645503, 'support': 667307}}
[[126276  48480  55432]
 [ 67041 103955  44956]
 [ 70604  45103 105460]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0229571
{'0': {'precision': 0.49090626986770003, 'recall': 0.5109378938744643, 'f1-score': 0.5007218182098908, 'support': 253888}, '1': {'precision': 0.40736191905280683, 'recall': 0.47871273974588147, 'f1-score': 0.44016458071895787, 'support': 165592}, '2': {'precision': 0.5244383895463464, 'recall': 0.44113837475335616, 'f1-score': 0.47919524863573604, 'support': 247827}, 'accuracy': 0.477018823420105, 'macro avg': {'precision': 0.47423552615561776, 'recall': 0.47692966945790066, 'f1-score': 0.4733605491881949, 'support': 667307}, 'weighted avg': {'precision': 0.48262805381940455, 'recall': 0.477018823420105, 'f1-score': 0.4776999418794273, 'support': 667307}}
[[129721  59782  64385]
 [ 51569  79271  34752]
 [ 82958  55543 109326]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0531162
{'0': {'precision': 0.4602392154809368, 'recall': 0.4998314344320559, 'f1-score': 0.4792189559728099, 'support': 246195}, '1': {'precision': 0.3842921603239443, 'recall': 0.4222166331321261, 'f1-score': 0.40236273525487554, 'support': 178920}, '2': {'precision': 0.4851295265445819, 'recall': 0.40733797978463365, 'f1-score': 0.4428434197886647, 'support': 242192}, 'accuracy': 0.44545164369622975, 'macro avg': {'precision': 0.44322030078315433, 'recall': 0.44312868244960524, 'f1-score': 0.44147503700545004, 'support': 667307}, 'weighted avg': {'precision': 0.4489097780682276, 'recall': 0.44545164369622975, 'f1-score': 0.44540996120673776, 'support': 667307}}
[[123056  61191  61948]
 [ 60623  75543  42754]
 [ 83695  59843  98654]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0844685
{'0': {'precision': 0.41674255691768824, 'recall': 0.48371856156733184, 'f1-score': 0.4477397325389783, 'support': 233671}, '1': {'precision': 0.35929795726696406, 'recall': 0.3610747888667132, 'f1-score': 0.36018418174953043, 'support': 203426}, '2': {'precision': 0.4285207409339943, 'recall': 0.35674384257851527, 'f1-score': 0.3893519176978144, 'support': 230210}, 'accuracy': 0.40252687293854256, 'macro avg': {'precision': 0.4015204183728822, 'recall': 0.4005123976708534, 'f1-score': 0.39909194399544107, 'support': 667307}, 'weighted avg': {'precision': 0.4032940701100354, 'recall': 0.40252687293854256, 'f1-score': 0.4009059149265772, 'support': 667307}}
[[113031  64987  55653]
 [ 76103  73452  53871]
 [ 82091  65993  82126]]
Evaluating performance on  train set...
722/722 - 11s - 11s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9527403
{'0': {'precision': 0.47213982336681726, 'recall': 0.5123454532153047, 'f1-score': 0.4914216546207284, 'support': 54676}, '1': {'precision': 0.6153078965456824, 'recall': 0.6041685965724872, 'f1-score': 0.6096873706280631, 'support': 75565}, '2': {'precision': 0.5023069403714565, 'recall': 0.4719681105110401, 'f1-score': 0.48666515134295557, 'support': 54438}, 'accuracy': 0.538014609132603, 'macro avg': {'precision': 0.5299182200946521, 'recall': 0.529494053432944, 'f1-score': 0.5292580588639157, 'support': 184679}, 'weighted avg': {'precision': 0.5396122104019403, 'recall': 0.538014609132603, 'f1-score': 0.5384102906034816, 'support': 184679}}
[[28013 14464 12199]
 [16653 45654 13258]
 [14666 14079 25693]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9911383
{'0': {'precision': 0.4968946190227728, 'recall': 0.47546343270361247, 'f1-score': 0.4859428496181196, 'support': 62091}, '1': {'precision': 0.5064566714392855, 'recall': 0.6157225510187165, 'f1-score': 0.5557700365116418, 'support': 60321}, '2': {'precision': 0.5223469603897479, 'recall': 0.43564006616666934, 'f1-score': 0.47506961593022645, 'support': 62267}, 'accuracy': 0.5078487537835921, 'macro avg': {'precision': 0.5085660836172687, 'recall': 0.5089420166296661, 'f1-score': 0.5055941673533293, 'support': 184679}, 'weighted avg': {'precision': 0.5085994338837688, 'recall': 0.5078487537835921, 'f1-score': 0.5050841818679158, 'support': 184679}}
[[29522 18288 14281]
 [12656 37141 10524]
 [17235 17906 27126]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0208952
{'0': {'precision': 0.474155069582505, 'recall': 0.46307682350656915, 'f1-score': 0.4685504731344749, 'support': 61804}, '1': {'precision': 0.4731379315047941, 'recall': 0.5719891834850284, 'f1-score': 0.5178887337926504, 'support': 60648}, '2': {'precision': 0.4933137254901961, 'recall': 0.4043100261944172, 'f1-score': 0.4443993040529202, 'support': 62227}, 'accuracy': 0.4790420134395356, 'macro avg': {'precision': 0.48020224219249835, 'recall': 0.4797920110620049, 'f1-score': 0.4769461703266818, 'support': 184679}, 'weighted avg': {'precision': 0.4802764926518896, 'recall': 0.4790420134395356, 'f1-score': 0.4766153426321391, 'support': 184679}}
[[28620 19196 13988]
 [14105 34690 11853]
 [17635 19433 25159]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0604558
{'0': {'precision': 0.4396833395646732, 'recall': 0.4383792544570502, 'f1-score': 0.4390303286072539, 'support': 61700}, '1': {'precision': 0.41611762815362363, 'recall': 0.5124762925702977, 'f1-score': 0.45929747027218776, 'support': 60635}, '2': {'precision': 0.4508517922699336, 'recall': 0.35063518542281535, 'f1-score': 0.3944780294144185, 'support': 62344}, 'accuracy': 0.4330865989094591, 'macro avg': {'precision': 0.4355509199960768, 'recall': 0.4338302441500544, 'f1-score': 0.4309352760979534, 'support': 184679}, 'weighted avg': {'precision': 0.435716343339048, 'recall': 0.4330865989094591, 'f1-score': 0.4306445868281406, 'support': 184679}}
[[27048 21460 13192]
 [16127 31074 13434]
 [18342 22142 21860]]
Evaluating performance on  val set...
227/227 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.99449813
{'0': {'precision': 0.4807692307692308, 'recall': 0.5166169578184917, 'f1-score': 0.49804888067364966, 'support': 18776}, '1': {'precision': 0.5463378545006166, 'recall': 0.5387383882106901, 'f1-score': 0.542511509452444, 'support': 20561}, '2': {'precision': 0.4997734481196194, 'recall': 0.47011188066062864, 'f1-score': 0.48448910119145666, 'support': 18770}, 'accuracy': 0.509422272703805, 'macro avg': {'precision': 0.5089601777964889, 'recall': 0.5084890755632702, 'f1-score': 0.5083498304391835, 'support': 58107}, 'weighted avg': {'precision': 0.5101093383674172, 'recall': 0.509422272703805, 'f1-score': 0.5094017133691945, 'support': 58107}}
[[ 9700  4465  4611]
 [ 5263 11077  4221]
 [ 5213  4733  8824]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0245905
{'0': {'precision': 0.5044656147662995, 'recall': 0.47649622721094814, 'f1-score': 0.4900821864982767, 'support': 21337}, '1': {'precision': 0.4248086671305039, 'recall': 0.5482298614674191, 'f1-score': 0.47869182953463624, 'support': 15592}, '2': {'precision': 0.5153945376030509, 'recall': 0.43394088204740766, 'f1-score': 0.4711733189776718, 'support': 21178}, 'accuracy': 0.48023473936014593, 'macro avg': {'precision': 0.4815562731666181, 'recall': 0.4862223235752583, 'f1-score': 0.4799824450035282, 'support': 58107}, 'weighted avg': {'precision': 0.4870742780994503, 'recall': 0.48023473936014593, 'f1-score': 0.48013415197354725, 'support': 58107}}
[[10167  5710  5460]
 [ 3863  8548  3181]
 [ 6124  5864  9190]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0503964
{'0': {'precision': 0.48109780047132755, 'recall': 0.46418758882046424, 'f1-score': 0.4724914412459617, 'support': 21110}, '1': {'precision': 0.39877754226844775, 'recall': 0.5015499070055797, 'f1-score': 0.444297992695719, 'support': 16130}, '2': {'precision': 0.48452899381159753, 'recall': 0.40523314324052334, 'f1-score': 0.4413476343328375, 'support': 20867}, 'accuracy': 0.4533877157657425, 'macro avg': {'precision': 0.4548014455171243, 'recall': 0.45699021302218906, 'f1-score': 0.45271235609150606, 'support': 58107}, 'weighted avg': {'precision': 0.4594785970469374, 'recall': 0.4533877157657425, 'f1-score': 0.45348102694180603, 'support': 58107}}
[[9799 5968 5343]
 [4387 8090 3653]
 [6182 6229 8456]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0825834
{'0': {'precision': 0.4384395997486344, 'recall': 0.4445860497034459, 'f1-score': 0.4414914330218069, 'support': 20401}, '1': {'precision': 0.36099585062240663, 'recall': 0.43261316872427985, 'f1-score': 0.3935730442243195, 'support': 17496}, '2': {'precision': 0.43584756579347234, 'recall': 0.3548243443839683, 'f1-score': 0.39118457300275483, 'support': 20210}, 'accuracy': 0.40976130242483694, 'macro avg': {'precision': 0.4117610053881711, 'recall': 0.41067452093723134, 'f1-score': 0.40874968341629375, 'support': 58107}, 'weighted avg': {'precision': 0.41421978387539526, 'recall': 0.40976130242483694, 'f1-score': 0.40956616117184247, 'support': 58107}}
[[9070 6518 4813]
 [5458 7569 4469]
 [6159 6880 7171]]
training model: results/PCAR/W1/deepVOL_L2/seq2seq
Epoch 1/50
722/722 - 30s - loss: 12.7592 - accuracy10: 0.4430 - accuracy20: 0.4374 - accuracy30: 0.4211 - accuracy50: 0.3968 - val_loss: 13.1308 - val_accuracy10: 0.4455 - val_accuracy20: 0.4172 - val_accuracy30: 0.3983 - val_accuracy50: 0.3689 - 30s/epoch - 42ms/step
Epoch 2/50
722/722 - 25s - loss: 12.3251 - accuracy10: 0.5026 - accuracy20: 0.4870 - accuracy30: 0.4618 - accuracy50: 0.4243 - val_loss: 12.8184 - val_accuracy10: 0.4878 - val_accuracy20: 0.4555 - val_accuracy30: 0.4329 - val_accuracy50: 0.3970 - 25s/epoch - 34ms/step
Epoch 3/50
722/722 - 25s - loss: 12.1688 - accuracy10: 0.5197 - accuracy20: 0.5018 - accuracy30: 0.4761 - accuracy50: 0.4334 - val_loss: 12.7494 - val_accuracy10: 0.5025 - val_accuracy20: 0.4704 - val_accuracy30: 0.4450 - val_accuracy50: 0.4043 - 25s/epoch - 34ms/step
Epoch 4/50
722/722 - 24s - loss: 12.0721 - accuracy10: 0.5307 - accuracy20: 0.5100 - accuracy30: 0.4822 - accuracy50: 0.4391 - val_loss: 12.7684 - val_accuracy10: 0.5056 - val_accuracy20: 0.4716 - val_accuracy30: 0.4461 - val_accuracy50: 0.4058 - 24s/epoch - 33ms/step
Epoch 5/50
722/722 - 24s - loss: 12.0144 - accuracy10: 0.5360 - accuracy20: 0.5142 - accuracy30: 0.4851 - accuracy50: 0.4411 - val_loss: 12.7463 - val_accuracy10: 0.5055 - val_accuracy20: 0.4705 - val_accuracy30: 0.4445 - val_accuracy50: 0.4067 - 24s/epoch - 34ms/step
Epoch 6/50
722/722 - 25s - loss: 11.9704 - accuracy10: 0.5401 - accuracy20: 0.5182 - accuracy30: 0.4890 - accuracy50: 0.4445 - val_loss: 12.8338 - val_accuracy10: 0.5008 - val_accuracy20: 0.4711 - val_accuracy30: 0.4459 - val_accuracy50: 0.4068 - 25s/epoch - 35ms/step
Epoch 7/50
722/722 - 25s - loss: 11.9290 - accuracy10: 0.5432 - accuracy20: 0.5206 - accuracy30: 0.4908 - accuracy50: 0.4463 - val_loss: 12.7455 - val_accuracy10: 0.5076 - val_accuracy20: 0.4759 - val_accuracy30: 0.4490 - val_accuracy50: 0.4073 - 25s/epoch - 35ms/step
Epoch 8/50
722/722 - 25s - loss: 11.8955 - accuracy10: 0.5441 - accuracy20: 0.5226 - accuracy30: 0.4930 - accuracy50: 0.4489 - val_loss: 12.8614 - val_accuracy10: 0.5019 - val_accuracy20: 0.4711 - val_accuracy30: 0.4442 - val_accuracy50: 0.4037 - 25s/epoch - 35ms/step
Epoch 9/50
722/722 - 24s - loss: 11.8686 - accuracy10: 0.5463 - accuracy20: 0.5244 - accuracy30: 0.4949 - accuracy50: 0.4495 - val_loss: 12.8712 - val_accuracy10: 0.4989 - val_accuracy20: 0.4676 - val_accuracy30: 0.4419 - val_accuracy50: 0.4016 - 24s/epoch - 34ms/step
Epoch 10/50
722/722 - 25s - loss: 11.8455 - accuracy10: 0.5491 - accuracy20: 0.5262 - accuracy30: 0.4963 - accuracy50: 0.4499 - val_loss: 12.9215 - val_accuracy10: 0.4974 - val_accuracy20: 0.4620 - val_accuracy30: 0.4364 - val_accuracy50: 0.3965 - 25s/epoch - 34ms/step
Epoch 11/50
722/722 - 24s - loss: 11.8166 - accuracy10: 0.5517 - accuracy20: 0.5283 - accuracy30: 0.4983 - accuracy50: 0.4519 - val_loss: 12.8350 - val_accuracy10: 0.5043 - val_accuracy20: 0.4715 - val_accuracy30: 0.4431 - val_accuracy50: 0.4023 - 24s/epoch - 34ms/step
Epoch 12/50
722/722 - 24s - loss: 11.7939 - accuracy10: 0.5524 - accuracy20: 0.5302 - accuracy30: 0.4992 - accuracy50: 0.4536 - val_loss: 12.8794 - val_accuracy10: 0.5034 - val_accuracy20: 0.4684 - val_accuracy30: 0.4390 - val_accuracy50: 0.3978 - 24s/epoch - 33ms/step
Epoch 13/50
722/722 - 24s - loss: 11.7740 - accuracy10: 0.5533 - accuracy20: 0.5316 - accuracy30: 0.5014 - accuracy50: 0.4549 - val_loss: 12.8281 - val_accuracy10: 0.5041 - val_accuracy20: 0.4699 - val_accuracy30: 0.4433 - val_accuracy50: 0.4016 - 24s/epoch - 34ms/step
Epoch 14/50
722/722 - 25s - loss: 11.7575 - accuracy10: 0.5542 - accuracy20: 0.5322 - accuracy30: 0.5026 - accuracy50: 0.4566 - val_loss: 12.8236 - val_accuracy10: 0.5043 - val_accuracy20: 0.4678 - val_accuracy30: 0.4385 - val_accuracy50: 0.3989 - 25s/epoch - 34ms/step
Epoch 15/50
722/722 - 25s - loss: 11.7342 - accuracy10: 0.5558 - accuracy20: 0.5337 - accuracy30: 0.5043 - accuracy50: 0.4575 - val_loss: 12.7215 - val_accuracy10: 0.5102 - val_accuracy20: 0.4757 - val_accuracy30: 0.4472 - val_accuracy50: 0.4038 - 25s/epoch - 34ms/step
Epoch 16/50
722/722 - 25s - loss: 11.7192 - accuracy10: 0.5565 - accuracy20: 0.5348 - accuracy30: 0.5049 - accuracy50: 0.4582 - val_loss: 12.6959 - val_accuracy10: 0.5130 - val_accuracy20: 0.4777 - val_accuracy30: 0.4479 - val_accuracy50: 0.4059 - 25s/epoch - 34ms/step
Epoch 17/50
722/722 - 24s - loss: 11.7026 - accuracy10: 0.5573 - accuracy20: 0.5362 - accuracy30: 0.5065 - accuracy50: 0.4590 - val_loss: 12.8129 - val_accuracy10: 0.5117 - val_accuracy20: 0.4748 - val_accuracy30: 0.4443 - val_accuracy50: 0.4032 - 24s/epoch - 34ms/step
Epoch 18/50
722/722 - 24s - loss: 11.6860 - accuracy10: 0.5587 - accuracy20: 0.5380 - accuracy30: 0.5080 - accuracy50: 0.4600 - val_loss: 12.7391 - val_accuracy10: 0.5140 - val_accuracy20: 0.4793 - val_accuracy30: 0.4486 - val_accuracy50: 0.4066 - 24s/epoch - 34ms/step
Epoch 19/50
722/722 - 25s - loss: 11.6677 - accuracy10: 0.5588 - accuracy20: 0.5392 - accuracy30: 0.5091 - accuracy50: 0.4610 - val_loss: 12.6807 - val_accuracy10: 0.5161 - val_accuracy20: 0.4818 - val_accuracy30: 0.4522 - val_accuracy50: 0.4088 - 25s/epoch - 34ms/step
Epoch 20/50
722/722 - 24s - loss: 11.6530 - accuracy10: 0.5600 - accuracy20: 0.5398 - accuracy30: 0.5099 - accuracy50: 0.4632 - val_loss: 12.7028 - val_accuracy10: 0.5155 - val_accuracy20: 0.4813 - val_accuracy30: 0.4522 - val_accuracy50: 0.4095 - 24s/epoch - 33ms/step
Epoch 21/50
722/722 - 24s - loss: 11.6349 - accuracy10: 0.5617 - accuracy20: 0.5419 - accuracy30: 0.5122 - accuracy50: 0.4639 - val_loss: 12.7134 - val_accuracy10: 0.5145 - val_accuracy20: 0.4803 - val_accuracy30: 0.4509 - val_accuracy50: 0.4083 - 24s/epoch - 33ms/step
Epoch 22/50
722/722 - 24s - loss: 11.6192 - accuracy10: 0.5622 - accuracy20: 0.5435 - accuracy30: 0.5131 - accuracy50: 0.4655 - val_loss: 12.6654 - val_accuracy10: 0.5142 - val_accuracy20: 0.4802 - val_accuracy30: 0.4518 - val_accuracy50: 0.4089 - 24s/epoch - 34ms/step
Epoch 23/50
722/722 - 24s - loss: 11.6000 - accuracy10: 0.5632 - accuracy20: 0.5434 - accuracy30: 0.5130 - accuracy50: 0.4662 - val_loss: 12.6865 - val_accuracy10: 0.5141 - val_accuracy20: 0.4823 - val_accuracy30: 0.4535 - val_accuracy50: 0.4107 - 24s/epoch - 33ms/step
Epoch 24/50
722/722 - 24s - loss: 11.5842 - accuracy10: 0.5640 - accuracy20: 0.5450 - accuracy30: 0.5154 - accuracy50: 0.4681 - val_loss: 12.6532 - val_accuracy10: 0.5160 - val_accuracy20: 0.4817 - val_accuracy30: 0.4523 - val_accuracy50: 0.4103 - 24s/epoch - 34ms/step
Epoch 25/50
722/722 - 24s - loss: 11.5709 - accuracy10: 0.5657 - accuracy20: 0.5463 - accuracy30: 0.5162 - accuracy50: 0.4691 - val_loss: 12.5719 - val_accuracy10: 0.5203 - val_accuracy20: 0.4890 - val_accuracy30: 0.4574 - val_accuracy50: 0.4138 - 24s/epoch - 34ms/step
Epoch 26/50
722/722 - 24s - loss: 11.5582 - accuracy10: 0.5656 - accuracy20: 0.5468 - accuracy30: 0.5174 - accuracy50: 0.4697 - val_loss: 12.6616 - val_accuracy10: 0.5172 - val_accuracy20: 0.4820 - val_accuracy30: 0.4536 - val_accuracy50: 0.4107 - 24s/epoch - 34ms/step
Epoch 27/50
722/722 - 24s - loss: 11.5416 - accuracy10: 0.5659 - accuracy20: 0.5480 - accuracy30: 0.5191 - accuracy50: 0.4710 - val_loss: 12.6070 - val_accuracy10: 0.5177 - val_accuracy20: 0.4848 - val_accuracy30: 0.4559 - val_accuracy50: 0.4132 - 24s/epoch - 34ms/step
Epoch 28/50
722/722 - 25s - loss: 11.5264 - accuracy10: 0.5674 - accuracy20: 0.5488 - accuracy30: 0.5190 - accuracy50: 0.4714 - val_loss: 12.5633 - val_accuracy10: 0.5184 - val_accuracy20: 0.4860 - val_accuracy30: 0.4556 - val_accuracy50: 0.4134 - 25s/epoch - 35ms/step
Epoch 29/50
722/722 - 24s - loss: 11.5133 - accuracy10: 0.5677 - accuracy20: 0.5502 - accuracy30: 0.5206 - accuracy50: 0.4733 - val_loss: 12.6610 - val_accuracy10: 0.5157 - val_accuracy20: 0.4849 - val_accuracy30: 0.4565 - val_accuracy50: 0.4134 - 24s/epoch - 34ms/step
Epoch 30/50
722/722 - 24s - loss: 11.5058 - accuracy10: 0.5675 - accuracy20: 0.5500 - accuracy30: 0.5207 - accuracy50: 0.4739 - val_loss: 12.6797 - val_accuracy10: 0.5170 - val_accuracy20: 0.4825 - val_accuracy30: 0.4519 - val_accuracy50: 0.4097 - 24s/epoch - 33ms/step
Epoch 31/50
722/722 - 25s - loss: 11.4822 - accuracy10: 0.5683 - accuracy20: 0.5517 - accuracy30: 0.5224 - accuracy50: 0.4755 - val_loss: 12.6000 - val_accuracy10: 0.5185 - val_accuracy20: 0.4855 - val_accuracy30: 0.4571 - val_accuracy50: 0.4145 - 25s/epoch - 35ms/step
Epoch 32/50
722/722 - 24s - loss: 11.4751 - accuracy10: 0.5693 - accuracy20: 0.5512 - accuracy30: 0.5230 - accuracy50: 0.4756 - val_loss: 12.5866 - val_accuracy10: 0.5219 - val_accuracy20: 0.4901 - val_accuracy30: 0.4601 - val_accuracy50: 0.4136 - 24s/epoch - 34ms/step
Epoch 33/50
722/722 - 24s - loss: 11.4636 - accuracy10: 0.5690 - accuracy20: 0.5527 - accuracy30: 0.5254 - accuracy50: 0.4777 - val_loss: 12.6346 - val_accuracy10: 0.5205 - val_accuracy20: 0.4871 - val_accuracy30: 0.4557 - val_accuracy50: 0.4119 - 24s/epoch - 34ms/step
Epoch 34/50
722/722 - 25s - loss: 11.4343 - accuracy10: 0.5714 - accuracy20: 0.5553 - accuracy30: 0.5265 - accuracy50: 0.4800 - val_loss: 12.6817 - val_accuracy10: 0.5199 - val_accuracy20: 0.4844 - val_accuracy30: 0.4534 - val_accuracy50: 0.4110 - 25s/epoch - 35ms/step
Epoch 35/50
722/722 - 25s - loss: 11.4220 - accuracy10: 0.5719 - accuracy20: 0.5568 - accuracy30: 0.5278 - accuracy50: 0.4814 - val_loss: 12.6091 - val_accuracy10: 0.5212 - val_accuracy20: 0.4907 - val_accuracy30: 0.4596 - val_accuracy50: 0.4148 - 25s/epoch - 34ms/step
Epoch 36/50
722/722 - 25s - loss: 11.4119 - accuracy10: 0.5722 - accuracy20: 0.5565 - accuracy30: 0.5277 - accuracy50: 0.4817 - val_loss: 12.6449 - val_accuracy10: 0.5207 - val_accuracy20: 0.4896 - val_accuracy30: 0.4576 - val_accuracy50: 0.4139 - 25s/epoch - 35ms/step
Epoch 37/50
722/722 - 25s - loss: 11.3978 - accuracy10: 0.5733 - accuracy20: 0.5576 - accuracy30: 0.5297 - accuracy50: 0.4834 - val_loss: 12.6666 - val_accuracy10: 0.5184 - val_accuracy20: 0.4860 - val_accuracy30: 0.4552 - val_accuracy50: 0.4108 - 25s/epoch - 35ms/step
Epoch 38/50
722/722 - 25s - loss: 11.3807 - accuracy10: 0.5735 - accuracy20: 0.5586 - accuracy30: 0.5311 - accuracy50: 0.4848 - val_loss: 12.6273 - val_accuracy10: 0.5202 - val_accuracy20: 0.4886 - val_accuracy30: 0.4579 - val_accuracy50: 0.4141 - 25s/epoch - 34ms/step
testing model: results/PCAR/W1/deepVOL_L2/seq2seq
Evaluating performance on  test set...
2607/2607 - 38s - 38s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0173819
{'0': {'precision': 0.5291049852612484, 'recall': 0.42575263912420175, 'f1-score': 0.47183546132070026, 'support': 230190}, '1': {'precision': 0.5015549320620148, 'recall': 0.6109014461480045, 'f1-score': 0.5508541985481861, 'support': 215953}, '2': {'precision': 0.5069983382941037, 'recall': 0.5021454182096045, 'f1-score': 0.5045602095311219, 'support': 221169}, 'accuracy': 0.5109888627808281, 'macro avg': {'precision': 0.5125527518724556, 'recall': 0.5129331678272702, 'f1-score': 0.5090832898000027, 'support': 667312}, 'weighted avg': {'precision': 0.5128624755482348, 'recall': 0.5109888627808281, 'f1-score': 0.5082532586890048, 'support': 667312}}
[[ 98004  67062  65124]
 [ 41158 131926  42869]
 [ 46064  64046 111059]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0537006
{'0': {'precision': 0.5300886745654094, 'recall': 0.39226436645791485, 'f1-score': 0.4508791945093352, 'support': 253890}, '1': {'precision': 0.38669146159301115, 'recall': 0.6190743625976787, 'f1-score': 0.4760367957427642, 'support': 165594}, '2': {'precision': 0.5224937711710198, 'recall': 0.4518617751020869, 'f1-score': 0.4846176815520367, 'support': 247828}, 'accuracy': 0.4706808809072818, 'macro avg': {'precision': 0.4797579691098135, 'recall': 0.4877335013858935, 'f1-score': 0.470511223934712, 'support': 667312}, 'weighted avg': {'precision': 0.49168392865438715, 'recall': 0.4706808809072818, 'f1-score': 0.4696519568535866, 'support': 667312}}
[[ 99592  83495  70803]
 [ 31540 102515  31539]
 [ 56746  79098 111984]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0778068
{'0': {'precision': 0.4902549283130322, 'recall': 0.37486240693428435, 'f1-score': 0.4248629288795385, 'support': 246197}, '1': {'precision': 0.37004858314901984, 'recall': 0.5470377822490499, 'f1-score': 0.4414645422459773, 'support': 178920}, '2': {'precision': 0.48333861526415867, 'recall': 0.42820454592373913, 'f1-score': 0.4541042072146825, 'support': 242195}, 'accuracy': 0.44038620615244445, 'macro avg': {'precision': 0.44788070890873694, 'recall': 0.4500349117023578, 'f1-score': 0.4401438927800661, 'support': 667312}, 'weighted avg': {'precision': 0.45551493305501645, 'recall': 0.44038620615244445, 'f1-score': 0.43992702493940766, 'support': 667312}}
[[ 92290  85070  68837]
 [ 39022  97876  42022]
 [ 56937  81549 103709]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1057456
{'0': {'precision': 0.4352372051529859, 'recall': 0.3507608956143654, 'f1-score': 0.388459442166876, 'support': 233672}, '1': {'precision': 0.35294367054941833, 'recall': 0.4501199441571465, 'f1-score': 0.3956523054188469, 'support': 203428}, '2': {'precision': 0.4224890233015723, 'recall': 0.40293294876027314, 'f1-score': 0.4124793226730225, 'support': 230212}, 'accuracy': 0.3990487208382286, 'macro avg': {'precision': 0.40355663300132555, 'recall': 0.40127126284392833, 'f1-score': 0.3988636900862485, 'support': 667312}, 'weighted avg': {'precision': 0.40575235609031024, 'recall': 0.3990487208382286, 'f1-score': 0.39893864007835206, 'support': 667312}}
[[81963 85487 66222]
 [51287 91567 60574]
 [55068 82384 92760]]
Evaluating performance on  train set...
722/722 - 11s - 11s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9595528
{'0': {'precision': 0.5230524997764064, 'recall': 0.42746459570580175, 'f1-score': 0.47045219157558144, 'support': 54725}, '1': {'precision': 0.615346100888722, 'recall': 0.6502387471396638, 'f1-score': 0.6323114223791425, 'support': 75603}, '2': {'precision': 0.48862917457463456, 'recall': 0.5399985281130409, 'f1-score': 0.5130311664248632, 'support': 54352}, 'accuracy': 0.5517814598223955, 'macro avg': {'precision': 0.5423425917465876, 'recall': 0.5392339569861688, 'f1-score': 0.538598260126529, 'support': 184680}, 'weighted avg': {'precision': 0.5507040947164524, 'recall': 0.5517814598223955, 'f1-score': 0.5492441336778654, 'support': 184680}}
[[23393 15723 15609]
 [11336 49160 15107]
 [ 9995 15007 29350]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.99527466
{'0': {'precision': 0.5351240570357128, 'recall': 0.3955264769394398, 'f1-score': 0.4548554484803558, 'support': 62054}, '1': {'precision': 0.5020825019952115, 'recall': 0.6655921444157905, 'f1-score': 0.5723891842711326, 'support': 60492}, '2': {'precision': 0.5161202279007882, 'recall': 0.48694756494029034, 'f1-score': 0.5011096757096957, 'support': 62134}, 'accuracy': 0.5147444227853585, 'macro avg': {'precision': 0.5177755956439042, 'recall': 0.5160220620985069, 'f1-score': 0.509451436153728, 'support': 184680}, 'weighted avg': {'precision': 0.5179076087631364, 'recall': 0.5147444227853585, 'f1-score': 0.5089155031702165, 'support': 184680}}
[[24544 20515 16995]
 [ 8858 40263 11371]
 [12464 19414 30256]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.025756
{'0': {'precision': 0.5061354307695614, 'recall': 0.3805338331286758, 'f1-score': 0.43443855199446624, 'support': 61892}, '1': {'precision': 0.4660655799896306, 'recall': 0.6086870355078448, 'f1-score': 0.5279132558422678, 'support': 60550}, '2': {'precision': 0.487387417891244, 'recall': 0.4625630643658215, 'f1-score': 0.47465088289120083, 'support': 62238}, 'accuracy': 0.48298137318605155, 'macro avg': {'precision': 0.486529476216812, 'recall': 0.4839279776674473, 'f1-score': 0.47900089690931164, 'support': 184680}, 'weighted avg': {'precision': 0.48667978700604864, 'recall': 0.48298137318605155, 'f1-score': 0.4786373194210167, 'support': 184680}}
[[23552 21709 16631]
 [10046 36856 13648]
 [12935 20514 28789]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0675462
{'0': {'precision': 0.460006349878294, 'recall': 0.35217384258884155, 'f1-score': 0.39893167884283565, 'support': 61711}, '1': {'precision': 0.40958725903733195, 'recall': 0.5144328365598851, 'f1-score': 0.4560618031779475, 'support': 60591}, '2': {'precision': 0.44652232040956075, 'recall': 0.4390490236942512, 'f1-score': 0.4427541386445939, 'support': 62378}, 'accuracy': 0.4347520034654538, 'macro avg': {'precision': 0.4387053097750622, 'recall': 0.4352185676143259, 'f1-score': 0.4325825402217924, 'support': 184680}, 'weighted avg': {'precision': 0.43891012980386596, 'recall': 0.4347520034654538, 'f1-score': 0.43247688547648755, 'support': 184680}}
[[21733 23114 16864]
 [12338 31170 17083]
 [13174 21817 27387]]
Evaluating performance on  val set...
227/227 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.005566
{'0': {'precision': 0.5217758710348414, 'recall': 0.4274683139844499, 'f1-score': 0.4699373572975821, 'support': 18778}, '1': {'precision': 0.5497503404448479, 'recall': 0.5880839079343498, 'f1-score': 0.5682713963963963, 'support': 20594}, '2': {'precision': 0.484971489320576, 'recall': 0.5356532877882152, 'f1-score': 0.5090540197818919, 'support': 18736}, 'accuracy': 0.5192744544641014, 'macro avg': {'precision': 0.5188325669334217, 'recall': 0.5170685032356717, 'f1-score': 0.5157542578252902, 'support': 58108}, 'weighted avg': {'precision': 0.5198232883823873, 'recall': 0.5192744544641014, 'f1-score': 0.5174003742575017, 'support': 58108}}
[[ 8027  4857  5894]
 [ 3719 12111  4764]
 [ 3638  5062 10036]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0269523
{'0': {'precision': 0.5422740524781341, 'recall': 0.4019921067468521, 'f1-score': 0.4617128055690465, 'support': 21284}, '1': {'precision': 0.4277885965309542, 'recall': 0.6022698291252232, 'f1-score': 0.5002515556732424, 'support': 15684}, '2': {'precision': 0.5098029532322584, 'recall': 0.48831598864711445, 'f1-score': 0.4988281910652589, 'support': 21140}, 'accuracy': 0.4874543952639912, 'macro avg': {'precision': 0.4932885340804489, 'recall': 0.4975259748397299, 'f1-score': 0.4869308507691826, 'support': 58108}, 'weighted avg': {'precision': 0.49955998678780955, 'recall': 0.4874543952639912, 'f1-score': 0.485617620844467, 'support': 58108}}
[[ 8556  6238  6490]
 [ 2802  9446  3436]
 [ 4420  6397 10323]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0529557
{'0': {'precision': 0.5093361643664522, 'recall': 0.38568118409230623, 'f1-score': 0.4389666307857912, 'support': 21147}, '1': {'precision': 0.3965580541532813, 'recall': 0.5380448318804483, 'f1-score': 0.4565918097754293, 'support': 16060}, '2': {'precision': 0.47815808914060576, 'recall': 0.46452322855365774, 'f1-score': 0.47124205212833087, 'support': 20901}, 'accuracy': 0.45615061609416946, 'macro avg': {'precision': 0.46135076922011314, 'recall': 0.46274974817547077, 'f1-score': 0.45560016422985045, 'support': 58108}, 'weighted avg': {'precision': 0.4669518214133487, 'recall': 0.45615061609416946, 'f1-score': 0.45544713185369945, 'support': 58108}}
[[8156 6530 6461]
 [3284 8641 4135]
 [4573 6619 9709]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0882174
{'0': {'precision': 0.4551349348483913, 'recall': 0.36157582298974633, 'f1-score': 0.40299650043744534, 'support': 20383}, '1': {'precision': 0.3609405987345358, 'recall': 0.43692483566733353, 'f1-score': 0.3953145605461174, 'support': 17495}, '2': {'precision': 0.42841298162704344, 'recall': 0.43914977755808204, 'f1-score': 0.4337149412942124, 'support': 20230}, 'accuracy': 0.4112686721277621, 'macro avg': {'precision': 0.41482950506999017, 'recall': 0.41255014540505397, 'f1-score': 0.4106753340925917, 'support': 58108}, 'weighted avg': {'precision': 0.41747204808615945, 'recall': 0.4112686721277621, 'f1-score': 0.4113781091683192, 'support': 58108}}
[[7370 6782 6231]
 [4229 7644 5622]
 [4594 6752 8884]]
training model: results/PCAR/W1/deepVOL_L3/seq2seq
Epoch 1/50
722/722 - 39s - loss: 13.0050 - accuracy10: 0.4131 - accuracy20: 0.4041 - accuracy30: 0.3930 - accuracy50: 0.3765 - val_loss: 12.8871 - val_accuracy10: 0.4165 - val_accuracy20: 0.4192 - val_accuracy30: 0.4028 - val_accuracy50: 0.3755 - 39s/epoch - 54ms/step
Epoch 2/50
722/722 - 34s - loss: 12.5768 - accuracy10: 0.4639 - accuracy20: 0.4553 - accuracy30: 0.4359 - accuracy50: 0.4056 - val_loss: 13.0085 - val_accuracy10: 0.4541 - val_accuracy20: 0.4303 - val_accuracy30: 0.4091 - val_accuracy50: 0.3760 - 34s/epoch - 47ms/step
Epoch 3/50
722/722 - 32s - loss: 12.2215 - accuracy10: 0.5100 - accuracy20: 0.4957 - accuracy30: 0.4704 - accuracy50: 0.4299 - val_loss: 12.6619 - val_accuracy10: 0.4942 - val_accuracy20: 0.4680 - val_accuracy30: 0.4412 - val_accuracy50: 0.4004 - 32s/epoch - 44ms/step
Epoch 4/50
722/722 - 33s - loss: 12.0767 - accuracy10: 0.5261 - accuracy20: 0.5081 - accuracy30: 0.4813 - accuracy50: 0.4389 - val_loss: 12.5121 - val_accuracy10: 0.5067 - val_accuracy20: 0.4791 - val_accuracy30: 0.4513 - val_accuracy50: 0.4092 - 33s/epoch - 46ms/step
Epoch 5/50
722/722 - 33s - loss: 11.9873 - accuracy10: 0.5361 - accuracy20: 0.5166 - accuracy30: 0.4882 - accuracy50: 0.4430 - val_loss: 12.6071 - val_accuracy10: 0.4992 - val_accuracy20: 0.4697 - val_accuracy30: 0.4435 - val_accuracy50: 0.4032 - 33s/epoch - 46ms/step
Epoch 6/50
722/722 - 33s - loss: 11.9272 - accuracy10: 0.5406 - accuracy20: 0.5199 - accuracy30: 0.4915 - accuracy50: 0.4471 - val_loss: 12.4715 - val_accuracy10: 0.5107 - val_accuracy20: 0.4753 - val_accuracy30: 0.4502 - val_accuracy50: 0.4102 - 33s/epoch - 45ms/step
Epoch 7/50
722/722 - 34s - loss: 11.8875 - accuracy10: 0.5449 - accuracy20: 0.5244 - accuracy30: 0.4949 - accuracy50: 0.4491 - val_loss: 12.5392 - val_accuracy10: 0.5070 - val_accuracy20: 0.4706 - val_accuracy30: 0.4466 - val_accuracy50: 0.4066 - 34s/epoch - 46ms/step
Epoch 8/50
722/722 - 34s - loss: 11.8573 - accuracy10: 0.5464 - accuracy20: 0.5261 - accuracy30: 0.4970 - accuracy50: 0.4506 - val_loss: 12.4719 - val_accuracy10: 0.5133 - val_accuracy20: 0.4803 - val_accuracy30: 0.4544 - val_accuracy50: 0.4119 - 34s/epoch - 47ms/step
Epoch 9/50
722/722 - 33s - loss: 11.8260 - accuracy10: 0.5490 - accuracy20: 0.5282 - accuracy30: 0.4983 - accuracy50: 0.4519 - val_loss: 12.4567 - val_accuracy10: 0.5170 - val_accuracy20: 0.4848 - val_accuracy30: 0.4579 - val_accuracy50: 0.4151 - 33s/epoch - 45ms/step
Epoch 10/50
722/722 - 32s - loss: 11.8028 - accuracy10: 0.5507 - accuracy20: 0.5289 - accuracy30: 0.5000 - accuracy50: 0.4535 - val_loss: 12.4128 - val_accuracy10: 0.5153 - val_accuracy20: 0.4863 - val_accuracy30: 0.4587 - val_accuracy50: 0.4160 - 32s/epoch - 45ms/step
Epoch 11/50
722/722 - 32s - loss: 11.7814 - accuracy10: 0.5507 - accuracy20: 0.5308 - accuracy30: 0.5015 - accuracy50: 0.4554 - val_loss: 12.5335 - val_accuracy10: 0.5155 - val_accuracy20: 0.4847 - val_accuracy30: 0.4592 - val_accuracy50: 0.4172 - 32s/epoch - 45ms/step
Epoch 12/50
722/722 - 32s - loss: 11.7650 - accuracy10: 0.5531 - accuracy20: 0.5326 - accuracy30: 0.5030 - accuracy50: 0.4566 - val_loss: 12.4540 - val_accuracy10: 0.5138 - val_accuracy20: 0.4842 - val_accuracy30: 0.4589 - val_accuracy50: 0.4165 - 32s/epoch - 45ms/step
Epoch 13/50
722/722 - 32s - loss: 11.7410 - accuracy10: 0.5543 - accuracy20: 0.5333 - accuracy30: 0.5041 - accuracy50: 0.4572 - val_loss: 12.5414 - val_accuracy10: 0.5136 - val_accuracy20: 0.4842 - val_accuracy30: 0.4563 - val_accuracy50: 0.4126 - 32s/epoch - 45ms/step
Epoch 14/50
722/722 - 32s - loss: 11.7214 - accuracy10: 0.5555 - accuracy20: 0.5351 - accuracy30: 0.5053 - accuracy50: 0.4592 - val_loss: 12.4576 - val_accuracy10: 0.5162 - val_accuracy20: 0.4896 - val_accuracy30: 0.4619 - val_accuracy50: 0.4183 - 32s/epoch - 44ms/step
Epoch 15/50
722/722 - 33s - loss: 11.7028 - accuracy10: 0.5569 - accuracy20: 0.5365 - accuracy30: 0.5066 - accuracy50: 0.4600 - val_loss: 12.4778 - val_accuracy10: 0.5149 - val_accuracy20: 0.4891 - val_accuracy30: 0.4621 - val_accuracy50: 0.4188 - 33s/epoch - 46ms/step
Epoch 16/50
722/722 - 32s - loss: 11.6833 - accuracy10: 0.5572 - accuracy20: 0.5380 - accuracy30: 0.5085 - accuracy50: 0.4614 - val_loss: 12.3912 - val_accuracy10: 0.5223 - val_accuracy20: 0.4972 - val_accuracy30: 0.4670 - val_accuracy50: 0.4215 - 32s/epoch - 44ms/step
Epoch 17/50
722/722 - 32s - loss: 11.6708 - accuracy10: 0.5587 - accuracy20: 0.5381 - accuracy30: 0.5082 - accuracy50: 0.4616 - val_loss: 12.4071 - val_accuracy10: 0.5191 - val_accuracy20: 0.4932 - val_accuracy30: 0.4641 - val_accuracy50: 0.4191 - 32s/epoch - 45ms/step
Epoch 18/50
722/722 - 32s - loss: 11.6470 - accuracy10: 0.5604 - accuracy20: 0.5400 - accuracy30: 0.5112 - accuracy50: 0.4640 - val_loss: 12.4511 - val_accuracy10: 0.5169 - val_accuracy20: 0.4933 - val_accuracy30: 0.4656 - val_accuracy50: 0.4226 - 32s/epoch - 45ms/step
Epoch 19/50
722/722 - 32s - loss: 11.6313 - accuracy10: 0.5606 - accuracy20: 0.5410 - accuracy30: 0.5115 - accuracy50: 0.4647 - val_loss: 12.3777 - val_accuracy10: 0.5216 - val_accuracy20: 0.4997 - val_accuracy30: 0.4710 - val_accuracy50: 0.4240 - 32s/epoch - 45ms/step
Epoch 20/50
722/722 - 32s - loss: 11.6195 - accuracy10: 0.5618 - accuracy20: 0.5425 - accuracy30: 0.5127 - accuracy50: 0.4653 - val_loss: 12.3900 - val_accuracy10: 0.5225 - val_accuracy20: 0.5003 - val_accuracy30: 0.4694 - val_accuracy50: 0.4251 - 32s/epoch - 45ms/step
Epoch 21/50
722/722 - 33s - loss: 11.6001 - accuracy10: 0.5617 - accuracy20: 0.5433 - accuracy30: 0.5136 - accuracy50: 0.4662 - val_loss: 12.3895 - val_accuracy10: 0.5212 - val_accuracy20: 0.4996 - val_accuracy30: 0.4703 - val_accuracy50: 0.4231 - 33s/epoch - 45ms/step
Epoch 22/50
722/722 - 34s - loss: 11.5890 - accuracy10: 0.5643 - accuracy20: 0.5449 - accuracy30: 0.5147 - accuracy50: 0.4668 - val_loss: 12.3882 - val_accuracy10: 0.5217 - val_accuracy20: 0.4996 - val_accuracy30: 0.4701 - val_accuracy50: 0.4248 - 34s/epoch - 48ms/step
Epoch 23/50
722/722 - 34s - loss: 11.5716 - accuracy10: 0.5650 - accuracy20: 0.5463 - accuracy30: 0.5158 - accuracy50: 0.4692 - val_loss: 12.3655 - val_accuracy10: 0.5202 - val_accuracy20: 0.5002 - val_accuracy30: 0.4739 - val_accuracy50: 0.4261 - 34s/epoch - 47ms/step
Epoch 24/50
722/722 - 34s - loss: 11.5560 - accuracy10: 0.5647 - accuracy20: 0.5460 - accuracy30: 0.5163 - accuracy50: 0.4698 - val_loss: 12.4410 - val_accuracy10: 0.5197 - val_accuracy20: 0.5004 - val_accuracy30: 0.4700 - val_accuracy50: 0.4231 - 34s/epoch - 46ms/step
Epoch 25/50
722/722 - 33s - loss: 11.5445 - accuracy10: 0.5659 - accuracy20: 0.5479 - accuracy30: 0.5176 - accuracy50: 0.4710 - val_loss: 12.4559 - val_accuracy10: 0.5210 - val_accuracy20: 0.4999 - val_accuracy30: 0.4692 - val_accuracy50: 0.4238 - 33s/epoch - 46ms/step
Epoch 26/50
722/722 - 33s - loss: 11.5264 - accuracy10: 0.5670 - accuracy20: 0.5493 - accuracy30: 0.5202 - accuracy50: 0.4731 - val_loss: 12.4121 - val_accuracy10: 0.5208 - val_accuracy20: 0.4987 - val_accuracy30: 0.4698 - val_accuracy50: 0.4245 - 33s/epoch - 45ms/step
Epoch 27/50
722/722 - 32s - loss: 11.5030 - accuracy10: 0.5682 - accuracy20: 0.5510 - accuracy30: 0.5205 - accuracy50: 0.4744 - val_loss: 12.4215 - val_accuracy10: 0.5212 - val_accuracy20: 0.5031 - val_accuracy30: 0.4727 - val_accuracy50: 0.4248 - 32s/epoch - 44ms/step
Epoch 28/50
722/722 - 34s - loss: 11.4875 - accuracy10: 0.5687 - accuracy20: 0.5517 - accuracy30: 0.5227 - accuracy50: 0.4746 - val_loss: 12.4837 - val_accuracy10: 0.5222 - val_accuracy20: 0.5015 - val_accuracy30: 0.4689 - val_accuracy50: 0.4233 - 34s/epoch - 46ms/step
Epoch 29/50
722/722 - 33s - loss: 11.4753 - accuracy10: 0.5687 - accuracy20: 0.5524 - accuracy30: 0.5227 - accuracy50: 0.4761 - val_loss: 12.5030 - val_accuracy10: 0.5140 - val_accuracy20: 0.4980 - val_accuracy30: 0.4684 - val_accuracy50: 0.4236 - 33s/epoch - 45ms/step
Epoch 30/50
722/722 - 33s - loss: 11.4579 - accuracy10: 0.5687 - accuracy20: 0.5536 - accuracy30: 0.5235 - accuracy50: 0.4756 - val_loss: 12.5104 - val_accuracy10: 0.5148 - val_accuracy20: 0.4980 - val_accuracy30: 0.4691 - val_accuracy50: 0.4222 - 33s/epoch - 45ms/step
Epoch 31/50
722/722 - 33s - loss: 11.4393 - accuracy10: 0.5703 - accuracy20: 0.5546 - accuracy30: 0.5256 - accuracy50: 0.4777 - val_loss: 12.5605 - val_accuracy10: 0.5154 - val_accuracy20: 0.4970 - val_accuracy30: 0.4683 - val_accuracy50: 0.4204 - 33s/epoch - 46ms/step
Epoch 32/50
722/722 - 32s - loss: 11.4283 - accuracy10: 0.5705 - accuracy20: 0.5549 - accuracy30: 0.5265 - accuracy50: 0.4796 - val_loss: 12.5851 - val_accuracy10: 0.5147 - val_accuracy20: 0.4972 - val_accuracy30: 0.4661 - val_accuracy50: 0.4201 - 32s/epoch - 45ms/step
Epoch 33/50
722/722 - 32s - loss: 11.4118 - accuracy10: 0.5721 - accuracy20: 0.5563 - accuracy30: 0.5278 - accuracy50: 0.4821 - val_loss: 12.6839 - val_accuracy10: 0.5140 - val_accuracy20: 0.4969 - val_accuracy30: 0.4665 - val_accuracy50: 0.4209 - 32s/epoch - 45ms/step
testing model: results/PCAR/W1/deepVOL_L3/seq2seq
Evaluating performance on  test set...
2607/2607 - 54s - 54s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9959616
{'0': {'precision': 0.4962904058828834, 'recall': 0.5259828837047656, 'f1-score': 0.5107054277953061, 'support': 230190}, '1': {'precision': 0.5770556108747473, 'recall': 0.4427861618037258, 'f1-score': 0.5010821206420407, 'support': 215953}, '2': {'precision': 0.4926041646451513, 'recall': 0.5738462442747402, 'f1-score': 0.530130697932809, 'support': 221169}, 'accuracy': 0.5149225549667922, 'macro avg': {'precision': 0.5219833938009274, 'recall': 0.5142050965944106, 'f1-score': 0.513972748790052, 'support': 667312}, 'weighted avg': {'precision': 0.5212055970158168, 'recall': 0.5149225549667922, 'f1-score': 0.5140293385317716, 'support': 667312}}
[[121076  37013  72101]
 [ 61705  95621  58627]
 [ 61181  33071 126917]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0125263
{'0': {'precision': 0.5034034030079525, 'recall': 0.50189452124936, 'f1-score': 0.5026478297657484, 'support': 253890}, '1': {'precision': 0.4500267204314135, 'recall': 0.4475101754894501, 'f1-score': 0.4487649199726278, 'support': 165594}, '2': {'precision': 0.5103019858525539, 'recall': 0.5137756831350776, 'f1-score': 0.5120329430594177, 'support': 247828}, 'accuracy': 0.4928114585081641, 'macro avg': {'precision': 0.48791070309730666, 'recall': 0.4877267932912959, 'f1-score': 0.487815230932598, 'support': 667312}, 'weighted avg': {'precision': 0.492719950012401, 'recall': 0.4928114585081641, 'f1-score': 0.4927622099852881, 'support': 667312}}
[[127426  47358  79106]
 [ 48408  74105  43081]
 [ 77295  43205 127328]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0492656
{'0': {'precision': 0.46807789356087603, 'recall': 0.49353160274089447, 'f1-score': 0.4804678695564492, 'support': 246197}, '1': {'precision': 0.4200630433176546, 'recall': 0.3813436172591102, 'f1-score': 0.3997679787196644, 'support': 178920}, '2': {'precision': 0.4745270058173902, 'recall': 0.48060860050785525, 'f1-score': 0.4775484416218457, 'support': 242195}, 'accuracy': 0.45876141894645983, 'macro avg': {'precision': 0.454222647565307, 'recall': 0.4518279401692866, 'f1-score': 0.45259476329931975, 'support': 667312}, 'weighted avg': {'precision': 0.45754477822269735, 'recall': 0.45876141894645983, 'f1-score': 0.4577709971532272, 'support': 667312}}
[[121506  48777  75914]
 [ 57706  68230  52984]
 [ 80373  45421 116401]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0908852
{'0': {'precision': 0.41916356667793936, 'recall': 0.4773871067136841, 'f1-score': 0.44638476836827384, 'support': 233672}, '1': {'precision': 0.3810427859940893, 'recall': 0.2959867864797373, 'f1-score': 0.3331719449877852, 'support': 203428}, '2': {'precision': 0.41957041161689895, 'recall': 0.44317411776970794, 'f1-score': 0.4310493794560338, 'support': 230212}, 'accuracy': 0.4102848442707459, 'macro avg': {'precision': 0.4065922547629759, 'recall': 0.4055160036543765, 'f1-score': 0.4035353642706976, 'support': 667312}, 'weighted avg': {'precision': 0.40768291956554437, 'recall': 0.4102848442707459, 'f1-score': 0.4065817245343391, 'support': 667312}}
[[111552  50282  71838]
 [ 73915  60212  69301]
 [ 80663  47525 102024]]
Evaluating performance on  train set...
722/722 - 16s - 16s/epoch - 23ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.95506847
{'0': {'precision': 0.5033316248077909, 'recall': 0.4844952032891731, 'f1-score': 0.49373382246140674, 'support': 54725}, '1': {'precision': 0.6659540518349832, 'recall': 0.5686017750618362, 'f1-score': 0.6134395022617978, 'support': 75603}, '2': {'precision': 0.47586431833007176, 'recall': 0.5905578451574919, 'f1-score': 0.5270434468490361, 'support': 54352}, 'accuracy': 0.5501407840589128, 'macro avg': {'precision': 0.5483833316576153, 'recall': 0.5478849411695004, 'f1-score': 0.5447389238574135, 'support': 184680}, 'weighted avg': {'precision': 0.5618211218234929, 'recall': 0.5501407840589128, 'f1-score': 0.5525412364459497, 'support': 184680}}
[[26514 11492 16719]
 [13980 42988 18635]
 [12183 10071 32098]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.97963184
{'0': {'precision': 0.5183742869679684, 'recall': 0.4569084990492152, 'f1-score': 0.4857044967880086, 'support': 62054}, '1': {'precision': 0.55214400793159, 'recall': 0.5892018779342723, 'f1-score': 0.5700713348901186, 'support': 60492}, '2': {'precision': 0.5050892529649101, 'recall': 0.5318987993691054, 'f1-score': 0.5181474687612686, 'support': 62134}, 'accuracy': 0.5254710851202079, 'macro avg': {'precision': 0.5252025159548229, 'recall': 0.5260030587841976, 'f1-score': 0.5246411001464653, 'support': 184680}, 'weighted avg': {'precision': 0.5249659355373066, 'recall': 0.5254710851202079, 'f1-score': 0.5242540440647, 'support': 184680}}
[[28353 15274 18427]
 [10894 35642 13956]
 [15449 13636 33049]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0150946
{'0': {'precision': 0.4900772852447366, 'recall': 0.4456795708653784, 'f1-score': 0.4668251859498887, 'support': 61892}, '1': {'precision': 0.5104526335614289, 'recall': 0.5371428571428571, 'f1-score': 0.5234577438720165, 'support': 60550}, '2': {'precision': 0.4798930100960126, 'recall': 0.4987146116520454, 'f1-score': 0.4891228125467826, 'support': 62238}, 'accuracy': 0.4935401776045051, 'macro avg': {'precision': 0.4934743096340594, 'recall': 0.4938456798867603, 'f1-score': 0.4931352474562292, 'support': 184680}, 'weighted avg': {'precision': 0.49332548983575586, 'recall': 0.4935401776045051, 'f1-score': 0.4929073879550995, 'support': 184680}}
[[27584 16350 17958]
 [12344 32524 15682]
 [16357 14842 31039]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0627816
{'0': {'precision': 0.4483563642605785, 'recall': 0.42324707102461473, 'f1-score': 0.43544004134504777, 'support': 61711}, '1': {'precision': 0.44119902746275474, 'recall': 0.44623789011569376, 'f1-score': 0.4437041534699772, 'support': 60591}, '2': {'precision': 0.4414049307666329, 'recall': 0.4609638013402161, 'f1-score': 0.45097239648682563, 'support': 62378}, 'accuracy': 0.4435293480615118, 'macro avg': {'precision': 0.44365344082998864, 'recall': 0.44348292082684154, 'f1-score': 0.4433721971006168, 'support': 184680}, 'weighted avg': {'precision': 0.44366020489084557, 'recall': 0.4435293480615118, 'f1-score': 0.443397633216368, 'support': 184680}}
[[26119 17864 17728]
 [14893 27038 18660]
 [17243 16381 28754]]
Evaluating performance on  val set...
227/227 - 5s - 5s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.99707186
{'0': {'precision': 0.5020492923110552, 'recall': 0.48924273085525616, 'f1-score': 0.49556328721309706, 'support': 18778}, '1': {'precision': 0.6015337423312883, 'recall': 0.4761095464698456, 'f1-score': 0.5315227408250665, 'support': 20594}, '2': {'precision': 0.476115530222468, 'recall': 0.5974060631938514, 'f1-score': 0.5299088649544325, 'support': 18736}, 'accuracy': 0.5194637571418738, 'macro avg': {'precision': 0.5265661882882705, 'recall': 0.5209194468396511, 'f1-score': 0.5189982976641986, 'support': 58108}, 'weighted avg': {'precision': 0.5289455509540116, 'recall': 0.5194637571418738, 'f1-score': 0.5193818273839266, 'support': 58108}}
[[ 9187  3300  6291]
 [ 4764  9805  6025]
 [ 4348  3195 11193]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0059054
{'0': {'precision': 0.5195314542697276, 'recall': 0.4667825596692351, 'f1-score': 0.49174647957037143, 'support': 21284}, '1': {'precision': 0.47582288643240905, 'recall': 0.4912649834225963, 'f1-score': 0.4834206481161966, 'support': 15684}, '2': {'precision': 0.5026763776763776, 'recall': 0.5419583727530748, 'f1-score': 0.5215788036055723, 'support': 21140}, 'accuracy': 0.5007400013767468, 'macro avg': {'precision': 0.4993435727928381, 'recall': 0.5000019719483021, 'f1-score': 0.4989153104307135, 'support': 58108}, 'weighted avg': {'precision': 0.5016020556130208, 'recall': 0.5007400013767468, 'f1-score': 0.5003524028438772, 'support': 58108}}
[[ 9935  4324  7025]
 [ 3669  7705  4310]
 [ 5519  4164 11457]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0376714
{'0': {'precision': 0.49274994930034477, 'recall': 0.45959237716933843, 'f1-score': 0.4755939419148051, 'support': 21147}, '1': {'precision': 0.4402211472011057, 'recall': 0.4363013698630137, 'f1-score': 0.4382524939800482, 'support': 16060}, '2': {'precision': 0.47589798370944053, 'recall': 0.5115544710779388, 'f1-score': 0.49308245711123416, 'support': 20901}, 'accuracy': 0.4718455290149377, 'macro avg': {'precision': 0.46962302673696366, 'recall': 0.46914940603676364, 'f1-score': 0.4689762976686958, 'support': 58108}, 'weighted avg': {'precision': 0.47217041645582647, 'recall': 0.4718455290149377, 'f1-score': 0.47156392543322545, 'support': 58108}}
[[ 9719  4531  6897]
 [ 4175  7007  4878]
 [ 5830  4379 10692]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0812985
{'0': {'precision': 0.4460915110188754, 'recall': 0.44291811803954273, 'f1-score': 0.44449915068560597, 'support': 20383}, '1': {'precision': 0.3944567051798001, 'recall': 0.34735638753929693, 'f1-score': 0.36941126409531627, 'support': 17495}, '2': {'precision': 0.43086716524216523, 'recall': 0.47844784972812654, 'f1-score': 0.4534126575162786, 'support': 20230}, 'accuracy': 0.4265161423556137, 'macro avg': {'precision': 0.4238051271469469, 'recall': 0.42290745176898875, 'f1-score': 0.422441024099067, 'support': 58108}, 'weighted avg': {'precision': 0.425245165537746, 'recall': 0.4265161423556137, 'f1-score': 0.4249950835569385, 'support': 58108}}
[[9028 4741 6614]
 [5247 6077 6171]
 [5963 4588 9679]]
training model: results/PCAR/W2/deepLOB_L1/seq2seq
Epoch 1/50
716/716 - 26s - loss: 12.7207 - accuracy10: 0.4456 - accuracy20: 0.4420 - accuracy30: 0.4291 - accuracy50: 0.4050 - val_loss: 13.4366 - val_accuracy10: 0.4001 - val_accuracy20: 0.3753 - val_accuracy30: 0.3646 - val_accuracy50: 0.3521 - 26s/epoch - 37ms/step
Epoch 2/50
716/716 - 21s - loss: 12.6071 - accuracy10: 0.4607 - accuracy20: 0.4609 - accuracy30: 0.4435 - accuracy50: 0.4168 - val_loss: 14.0492 - val_accuracy10: 0.3810 - val_accuracy20: 0.3267 - val_accuracy30: 0.3227 - val_accuracy50: 0.3167 - 21s/epoch - 29ms/step
Epoch 3/50
716/716 - 19s - loss: 12.5816 - accuracy10: 0.4625 - accuracy20: 0.4635 - accuracy30: 0.4447 - accuracy50: 0.4176 - val_loss: 13.5831 - val_accuracy10: 0.3922 - val_accuracy20: 0.3442 - val_accuracy30: 0.3383 - val_accuracy50: 0.3295 - 19s/epoch - 27ms/step
Epoch 4/50
716/716 - 20s - loss: 12.5158 - accuracy10: 0.4706 - accuracy20: 0.4708 - accuracy30: 0.4526 - accuracy50: 0.4228 - val_loss: 14.2207 - val_accuracy10: 0.3872 - val_accuracy20: 0.3515 - val_accuracy30: 0.3539 - val_accuracy50: 0.3480 - 20s/epoch - 27ms/step
Epoch 5/50
716/716 - 20s - loss: 12.4079 - accuracy10: 0.4798 - accuracy20: 0.4783 - accuracy30: 0.4596 - accuracy50: 0.4292 - val_loss: 14.1096 - val_accuracy10: 0.3929 - val_accuracy20: 0.3478 - val_accuracy30: 0.3445 - val_accuracy50: 0.3343 - 20s/epoch - 27ms/step
Epoch 6/50
716/716 - 19s - loss: 12.3191 - accuracy10: 0.4895 - accuracy20: 0.4854 - accuracy30: 0.4654 - accuracy50: 0.4335 - val_loss: 15.7685 - val_accuracy10: 0.3645 - val_accuracy20: 0.2960 - val_accuracy30: 0.3001 - val_accuracy50: 0.3052 - 19s/epoch - 27ms/step
Epoch 7/50
716/716 - 19s - loss: 12.2637 - accuracy10: 0.4951 - accuracy20: 0.4896 - accuracy30: 0.4697 - accuracy50: 0.4367 - val_loss: 15.2619 - val_accuracy10: 0.3776 - val_accuracy20: 0.3175 - val_accuracy30: 0.3167 - val_accuracy50: 0.3139 - 19s/epoch - 27ms/step
Epoch 8/50
716/716 - 19s - loss: 12.2091 - accuracy10: 0.5022 - accuracy20: 0.4943 - accuracy30: 0.4730 - accuracy50: 0.4394 - val_loss: 14.4693 - val_accuracy10: 0.3957 - val_accuracy20: 0.3459 - val_accuracy30: 0.3436 - val_accuracy50: 0.3373 - 19s/epoch - 27ms/step
Epoch 9/50
716/716 - 20s - loss: 12.1577 - accuracy10: 0.5066 - accuracy20: 0.4979 - accuracy30: 0.4758 - accuracy50: 0.4418 - val_loss: 14.1300 - val_accuracy10: 0.4027 - val_accuracy20: 0.3579 - val_accuracy30: 0.3529 - val_accuracy50: 0.3438 - 20s/epoch - 27ms/step
Epoch 10/50
716/716 - 19s - loss: 12.1237 - accuracy10: 0.5098 - accuracy20: 0.5009 - accuracy30: 0.4779 - accuracy50: 0.4420 - val_loss: 14.3326 - val_accuracy10: 0.3990 - val_accuracy20: 0.3519 - val_accuracy30: 0.3511 - val_accuracy50: 0.3412 - 19s/epoch - 27ms/step
Epoch 11/50
716/716 - 19s - loss: 12.0925 - accuracy10: 0.5134 - accuracy20: 0.5038 - accuracy30: 0.4812 - accuracy50: 0.4452 - val_loss: 14.3629 - val_accuracy10: 0.4077 - val_accuracy20: 0.3665 - val_accuracy30: 0.3621 - val_accuracy50: 0.3490 - 19s/epoch - 27ms/step
testing model: results/PCAR/W2/deepLOB_L1/seq2seq
Evaluating performance on  test set...
1914/1914 - 25s - 25s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0791032
{'0': {'precision': 0.4551288012647633, 'recall': 0.22506027579048332, 'f1-score': 0.301185117456745, 'support': 152217}, '1': {'precision': 0.4020288627330176, 'recall': 0.517399922911734, 'f1-score': 0.4524759412236328, 'support': 181610}, '2': {'precision': 0.3822607657485864, 'recall': 0.4430656279629962, 'f1-score': 0.4104233367852279, 'support': 156092}, 'accuracy': 0.40288700785231846, 'macro avg': {'precision': 0.4131394765821224, 'recall': 0.3951752755550711, 'f1-score': 0.38802813182186857, 'support': 489919}, 'weighted avg': {'precision': 0.4122286540229918, 'recall': 0.40288700785231846, 'f1-score': 0.39207185309207665, 'support': 489919}}
[[34258 67598 50361]
 [26244 93965 61401]
 [14769 72164 69159]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1006564
{'0': {'precision': 0.47849432137636344, 'recall': 0.20014227845422103, 'f1-score': 0.2822333594491633, 'support': 170089}, '1': {'precision': 0.31647505145095833, 'recall': 0.5360117589416953, 'f1-score': 0.39797530453581675, 'support': 142870}, '2': {'precision': 0.4233838809482061, 'recall': 0.4229938969258589, 'f1-score': 0.4231887990909013, 'support': 176960}, 'accuracy': 0.37858299024940856, 'macro avg': {'precision': 0.40611775125850924, 'recall': 0.3863826447739251, 'f1-score': 0.36779915435862715, 'support': 489919}, 'weighted avg': {'precision': 0.41134028850070575, 'recall': 0.37858299024940856, 'f1-score': 0.36689944974884986, 'support': 489919}}
[[34042 80308 55739]
 [20085 76580 46205]
 [17017 85090 74853]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0997831
{'0': {'precision': 0.4614816892260912, 'recall': 0.18677005609553565, 'f1-score': 0.26591817640554566, 'support': 167393}, '1': {'precision': 0.3208002006164101, 'recall': 0.5396501398215999, 'f1-score': 0.40239364198360783, 'support': 146973}, '2': {'precision': 0.4171401785816365, 'recall': 0.4156693420220674, 'f1-score': 0.416403461469327, 'support': 175553}, 'accuracy': 0.3746537692965572, 'macro avg': {'precision': 0.39980735614137924, 'recall': 0.380696512646401, 'f1-score': 0.3615717599528268, 'support': 489919}, 'weighted avg': {'precision': 0.403389095055225, 'recall': 0.3746537692965572, 'f1-score': 0.3607835558891062, 'support': 489919}}
[[31264 81756 54373]
 [20070 79314 47589]
 [16413 86168 72972]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1067033
{'0': {'precision': 0.43736334801219473, 'recall': 0.16860968978903754, 'f1-score': 0.24338937158329477, 'support': 168466}, '1': {'precision': 0.304060832868859, 'recall': 0.5384669618432556, 'f1-score': 0.3886559325828974, 'support': 141836}, '2': {'precision': 0.4157992554360647, 'recall': 0.40231715260804934, 'f1-score': 0.40894711524857813, 'support': 179617}, 'accuracy': 0.3613699407453069, 'macro avg': {'precision': 0.38574114543903953, 'recall': 0.36979793474678085, 'f1-score': 0.3469974731382568, 'support': 489919}, 'weighted avg': {'precision': 0.3908651041104132, 'recall': 0.3613699407453069, 'f1-score': 0.3461431190188236, 'support': 489919}}
[[28405 84829 55232]
 [19164 76374 46298]
 [17377 89977 72263]]
Evaluating performance on  train set...
716/716 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0582682
{'0': {'precision': 0.3802945583452107, 'recall': 0.3940994906171297, 'f1-score': 0.3870739759148184, 'support': 52809}, '1': {'precision': 0.45690043137986674, 'recall': 0.5446943822871275, 'f1-score': 0.4969496543737539, 'support': 76419}, '2': {'precision': 0.42561872550598595, 'recall': 0.2944202023953208, 'f1-score': 0.3480666015432065, 'support': 53855}, 'accuracy': 0.42763664567436627, 'macro avg': {'precision': 0.42093790507702117, 'recall': 0.41107135843319265, 'f1-score': 0.41069674394392625, 'support': 183083}, 'weighted avg': {'precision': 0.42560229982792036, 'recall': 0.42763664567436627, 'f1-score': 0.4214619164957038, 'support': 183083}}
[[20812 23342  8655]
 [22051 41625 12743]
 [11863 26136 15856]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0861858
{'0': {'precision': 0.4164304785376874, 'recall': 0.33368990997811165, 'f1-score': 0.37049692562104286, 'support': 60763}, '1': {'precision': 0.3605248146035368, 'recall': 0.5822105973120136, 'f1-score': 0.4453028177431632, 'support': 60789}, '2': {'precision': 0.4603174603174603, 'recall': 0.27100160894508457, 'f1-score': 0.3411555300953394, 'support': 61531}, 'accuracy': 0.3951377244200718, 'macro avg': {'precision': 0.4124242511528948, 'recall': 0.3956340387450699, 'f1-score': 0.38565175781984856, 'support': 183083}, 'weighted avg': {'precision': 0.412617784136777, 'recall': 0.3951377244200718, 'f1-score': 0.3854735753816406, 'support': 183083}}
[[20276 30547  9940]
 [15787 35392  9610]
 [12627 32229 16675]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0904586
{'0': {'precision': 0.4150443891640231, 'recall': 0.2927041251549146, 'f1-score': 0.3433004870313739, 'support': 62131}, '1': {'precision': 0.34439491497440977, 'recall': 0.599010151855543, 'f1-score': 0.4373435283961275, 'support': 59201}, '2': {'precision': 0.44865966884315506, 'recall': 0.2637204255801526, 'f1-score': 0.3321842362924282, 'support': 61751}, 'accuracy': 0.38197429581118947, 'macro avg': {'precision': 0.4026996576605293, 'recall': 0.38514490086353675, 'f1-score': 0.3709427505733099, 'support': 183083}, 'weighted avg': {'precision': 0.4035373547259091, 'recall': 0.38197429581118947, 'f1-score': 0.36996054008083307, 'support': 183083}}
[[18186 33745 10200]
 [13927 35462  9812]
 [11704 33762 16285]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.093924
{'0': {'precision': 0.40069183485553594, 'recall': 0.2594842868654311, 'f1-score': 0.3149863546995589, 'support': 62050}, '1': {'precision': 0.34387221410733637, 'recall': 0.6018274178651537, 'f1-score': 0.4376690435210228, 'support': 60632}, '2': {'precision': 0.4188663857550632, 'recall': 0.2550951143192994, 'f1-score': 0.3170827073858375, 'support': 60401}, 'accuracy': 0.37141078090265073, 'macro avg': {'precision': 0.3878101449059785, 'recall': 0.3721356063499614, 'f1-score': 0.35657936853547306, 'support': 183083}, 'weighted avg': {'precision': 0.38787073078622036, 'recall': 0.37141078090265073, 'f1-score': 0.3563070594467332, 'support': 183083}}
[[16101 35570 10379]
 [13144 36490 10998]
 [10938 34055 15408]]
Evaluating performance on  val set...
214/214 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0955485
{'0': {'precision': 0.41124843274225326, 'recall': 0.3788778877887789, 'f1-score': 0.39440006871081335, 'support': 18180}, '1': {'precision': 0.3733722219940024, 'recall': 0.4944510934609945, 'f1-score': 0.4254651843183148, 'support': 18382}, '2': {'precision': 0.42737059430762425, 'recall': 0.3203625912005306, 'f1-score': 0.36620964175143744, 'support': 18092}, 'accuracy': 0.39837889267025284, 'macro avg': {'precision': 0.40399708301462667, 'recall': 0.39789719081676794, 'f1-score': 0.3953582982601886, 'support': 54654}, 'weighted avg': {'precision': 0.40384625981925304, 'recall': 0.39837889267025284, 'f1-score': 0.39551650576113107, 'support': 54654}}
[[6888 7038 4254]
 [5781 9089 3512]
 [4080 8216 5796]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.117139
{'0': {'precision': 0.44658060972260366, 'recall': 0.3200629890261306, 'f1-score': 0.37288232764798623, 'support': 20321}, '1': {'precision': 0.2858325805480277, 'recall': 0.5477100613054454, 'f1-score': 0.37563376449929514, 'support': 13865}, '2': {'precision': 0.4679041561899127, 'recall': 0.30911666992378345, 'f1-score': 0.3722859664607237, 'support': 20468}, 'accuracy': 0.3737146411973506, 'macro avg': {'precision': 0.4001057821535147, 'recall': 0.39229657341845314, 'f1-score': 0.37360068620266834, 'support': 54654}, 'weighted avg': {'precision': 0.41378664998658043, 'recall': 0.3737146411973506, 'f1-score': 0.37335699283557555, 'support': 54654}}
[[6504 9016 4801]
 [3877 7594 2394]
 [4183 9958 6327]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1145557
{'0': {'precision': 0.43217023939915505, 'recall': 0.27597921662669866, 'f1-score': 0.3368498079151168, 'support': 20016}, '1': {'precision': 0.28667333238108844, 'recall': 0.5550715619166148, 'f1-score': 0.3780818046954106, 'support': 14463}, '2': {'precision': 0.4468560715315835, 'recall': 0.3071623296158612, 'f1-score': 0.3640689715947479, 'support': 20175}, 'accuracy': 0.36134592161598417, 'macro avg': {'precision': 0.388566547770609, 'recall': 0.37940436938639155, 'f1-score': 0.3596668614017584, 'support': 54654}, 'weighted avg': {'precision': 0.3990887613201389, 'recall': 0.36134592161598417, 'f1-score': 0.3578086580755798, 'support': 54654}}
[[ 5524  9711  4781]
 [ 3545  8028  2890]
 [ 3713 10265  6197]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.113076
{'0': {'precision': 0.4159010600706714, 'recall': 0.24003262975425715, 'f1-score': 0.3043899915950087, 'support': 19614}, '1': {'precision': 0.2912828268939915, 'recall': 0.5570968378147393, 'f1-score': 0.38254745728280254, 'support': 15211}, '2': {'precision': 0.4210785002106446, 'recall': 0.3024358263149932, 'f1-score': 0.3520295852778022, 'support': 19829}, 'accuracy': 0.3509166758151279, 'macro avg': {'precision': 0.37608746239176916, 'recall': 0.36652176462799657, 'f1-score': 0.3463223447185378, 'support': 54654}, 'weighted avg': {'precision': 0.383096425747201, 'recall': 0.3509166758151279, 'f1-score': 0.34342645212329836, 'support': 54654}}
[[ 4708 10197  4709]
 [ 3201  8474  3536]
 [ 3411 10421  5997]]
training model: results/PCAR/W2/deepOF_L1/seq2seq
Epoch 1/50
716/716 - 24s - loss: 13.1335 - accuracy10: 0.3866 - accuracy20: 0.3887 - accuracy30: 0.3813 - accuracy50: 0.3686 - val_loss: 13.1098 - val_accuracy10: 0.3832 - val_accuracy20: 0.4155 - val_accuracy30: 0.4074 - val_accuracy50: 0.3948 - 24s/epoch - 34ms/step
Epoch 2/50
716/716 - 19s - loss: 13.0203 - accuracy10: 0.3963 - accuracy20: 0.4033 - accuracy30: 0.3945 - accuracy50: 0.3812 - val_loss: 13.0888 - val_accuracy10: 0.3826 - val_accuracy20: 0.4149 - val_accuracy30: 0.4082 - val_accuracy50: 0.3970 - 19s/epoch - 27ms/step
Epoch 3/50
716/716 - 19s - loss: 12.9887 - accuracy10: 0.4023 - accuracy20: 0.4075 - accuracy30: 0.3993 - accuracy50: 0.3838 - val_loss: 13.0950 - val_accuracy10: 0.3841 - val_accuracy20: 0.4137 - val_accuracy30: 0.4092 - val_accuracy50: 0.3971 - 19s/epoch - 27ms/step
Epoch 4/50
716/716 - 19s - loss: 12.9685 - accuracy10: 0.4041 - accuracy20: 0.4095 - accuracy30: 0.4017 - accuracy50: 0.3859 - val_loss: 13.0925 - val_accuracy10: 0.3875 - val_accuracy20: 0.4103 - val_accuracy30: 0.4072 - val_accuracy50: 0.3958 - 19s/epoch - 26ms/step
Epoch 5/50
716/716 - 18s - loss: 12.9479 - accuracy10: 0.4076 - accuracy20: 0.4123 - accuracy30: 0.4042 - accuracy50: 0.3892 - val_loss: 13.0922 - val_accuracy10: 0.3895 - val_accuracy20: 0.4081 - val_accuracy30: 0.4061 - val_accuracy50: 0.3975 - 18s/epoch - 26ms/step
Epoch 6/50
716/716 - 19s - loss: 12.9316 - accuracy10: 0.4104 - accuracy20: 0.4152 - accuracy30: 0.4062 - accuracy50: 0.3908 - val_loss: 13.1046 - val_accuracy10: 0.3898 - val_accuracy20: 0.4063 - val_accuracy30: 0.4047 - val_accuracy50: 0.3942 - 19s/epoch - 27ms/step
Epoch 7/50
716/716 - 19s - loss: 12.9163 - accuracy10: 0.4148 - accuracy20: 0.4174 - accuracy30: 0.4081 - accuracy50: 0.3921 - val_loss: 13.1085 - val_accuracy10: 0.3921 - val_accuracy20: 0.4070 - val_accuracy30: 0.4059 - val_accuracy50: 0.3940 - 19s/epoch - 27ms/step
Epoch 8/50
716/716 - 19s - loss: 12.8994 - accuracy10: 0.4146 - accuracy20: 0.4180 - accuracy30: 0.4088 - accuracy50: 0.3926 - val_loss: 13.1191 - val_accuracy10: 0.3902 - val_accuracy20: 0.4060 - val_accuracy30: 0.4054 - val_accuracy50: 0.3944 - 19s/epoch - 27ms/step
Epoch 9/50
716/716 - 19s - loss: 12.8808 - accuracy10: 0.4178 - accuracy20: 0.4199 - accuracy30: 0.4111 - accuracy50: 0.3938 - val_loss: 13.1376 - val_accuracy10: 0.3905 - val_accuracy20: 0.4018 - val_accuracy30: 0.4040 - val_accuracy50: 0.3947 - 19s/epoch - 26ms/step
Epoch 10/50
716/716 - 19s - loss: 12.8645 - accuracy10: 0.4213 - accuracy20: 0.4225 - accuracy30: 0.4131 - accuracy50: 0.3958 - val_loss: 13.1045 - val_accuracy10: 0.3956 - val_accuracy20: 0.4070 - val_accuracy30: 0.4059 - val_accuracy50: 0.3973 - 19s/epoch - 26ms/step
Epoch 11/50
716/716 - 19s - loss: 12.8523 - accuracy10: 0.4222 - accuracy20: 0.4235 - accuracy30: 0.4136 - accuracy50: 0.3958 - val_loss: 13.1380 - val_accuracy10: 0.3938 - val_accuracy20: 0.4020 - val_accuracy30: 0.4021 - val_accuracy50: 0.3939 - 19s/epoch - 26ms/step
Epoch 12/50
716/716 - 19s - loss: 12.8301 - accuracy10: 0.4251 - accuracy20: 0.4268 - accuracy30: 0.4166 - accuracy50: 0.3982 - val_loss: 13.1396 - val_accuracy10: 0.3942 - val_accuracy20: 0.4024 - val_accuracy30: 0.4022 - val_accuracy50: 0.3931 - 19s/epoch - 27ms/step
testing model: results/PCAR/W2/deepOF_L1/seq2seq
Evaluating performance on  test set...
1914/1914 - 27s - 27s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0850345
{'0': {'precision': 0.3856159771379769, 'recall': 0.4627498127636091, 'f1-score': 0.4206763717805151, 'support': 152214}, '1': {'precision': 0.41408715644267946, 'recall': 0.1090915097820042, 'f1-score': 0.17268820765817985, 'support': 181609}, '2': {'precision': 0.3658830876457164, 'recall': 0.6080619638544182, 'f1-score': 0.45686271206428897, 'support': 156091}, 'accuracy': 0.37794796637777245, 'macro avg': {'precision': 0.38852874040879093, 'recall': 0.3933010954666772, 'f1-score': 0.350075763834328, 'support': 489914}, 'weighted avg': {'precision': 0.3898830443142799, 'recall': 0.37794796637777245, 'f1-score': 0.34027752533632566, 'support': 489914}}
[[70437 15191 66586]
 [63888 19812 97909]
 [48336 12842 94913]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0828623
{'0': {'precision': 0.4110490817692677, 'recall': 0.4783521277471397, 'f1-score': 0.44215411620532524, 'support': 170086}, '1': {'precision': 0.3541502957111543, 'recall': 0.05993602530989928, 'f1-score': 0.10252143096594991, 'support': 142869}, '2': {'precision': 0.40529499626587007, 'recall': 0.6133511152300816, 'f1-score': 0.4880755645192116, 'support': 176959}, 'accuracy': 0.40509558820527686, 'macro avg': {'precision': 0.390164791248764, 'recall': 0.3838797560957068, 'f1-score': 0.3442503705634956, 'support': 489914}, 'weighted avg': {'precision': 0.3923778254223735, 'recall': 0.40509558820527686, 'f1-score': 0.35969725941967046, 'support': 489914}}
[[ 81361   8344  80381]
 [ 55425   8563  78881]
 [ 61149   7272 108538]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0848618
{'0': {'precision': 0.4021571195244331, 'recall': 0.48983505487218393, 'f1-score': 0.4416869572712189, 'support': 167389}, '1': {'precision': 0.3844009042954032, 'recall': 0.03470705503731978, 'f1-score': 0.06366580755477617, 'support': 146973}, '2': {'precision': 0.401802310447608, 'recall': 0.6242936565803865, 'f1-score': 0.48892626357031804, 'support': 175552}, 'accuracy': 0.4014786268610409, 'macro avg': {'precision': 0.39612011142248144, 'recall': 0.3829452554966301, 'f1-score': 0.3314263427987711, 'support': 489914}, 'weighted avg': {'precision': 0.39670315890295466, 'recall': 0.4014786268610409, 'f1-score': 0.34520890655649084, 'support': 489914}}
[[ 81993   4315  81081]
 [ 59788   5101  82084]
 [ 62102   3854 109596]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0859632
{'0': {'precision': 0.3982718645000295, 'recall': 0.48127767686481226, 'f1-score': 0.4358580129773086, 'support': 168462}, '1': {'precision': 0.36823806115144697, 'recall': 0.02538847683239798, 'f1-score': 0.047501896250371003, 'support': 141836}, '2': {'precision': 0.4071658175533242, 'recall': 0.6269318991626581, 'f1-score': 0.49369655332665463, 'support': 179616}, 'accuracy': 0.4026931257322714, 'macro avg': {'precision': 0.39122524773493356, 'recall': 0.37786601761995614, 'f1-score': 0.3256854875181114, 'support': 489914}, 'weighted avg': {'precision': 0.39283748569042426, 'recall': 0.4026931257322714, 'f1-score': 0.3446294485584641, 'support': 489914}}
[[ 81077   3204  84181]
 [ 58460   3601  79775]
 [ 64035   2974 112607]]
Evaluating performance on  train set...
716/716 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0849825
{'0': {'precision': 0.3552791040635449, 'recall': 0.46131386861313867, 'f1-score': 0.4014121684043816, 'support': 52745}, '1': {'precision': 0.4867011150394343, 'recall': 0.11705453736771189, 'f1-score': 0.18872063103724637, 'support': 76443}, '2': {'precision': 0.34919084096413094, 'recall': 0.6233602374988403, 'f1-score': 0.44763034122553397, 'support': 53895}, 'accuracy': 0.3652769508911259, 'macro avg': {'precision': 0.39705702002237003, 'recall': 0.40057621449323033, 'f1-score': 0.34592104688905395, 'support': 183083}, 'weighted avg': {'precision': 0.40835976062525187, 'recall': 0.3652769508911259, 'f1-score': 0.32621211833550623, 'support': 183083}}
[[24332  5205 23208]
 [28088  8948 39407]
 [16067  4232 33596]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.083838
{'0': {'precision': 0.3904077445998311, 'recall': 0.4809150218845487, 'f1-score': 0.43096073294554715, 'support': 60545}, '1': {'precision': 0.42394617891306635, 'recall': 0.06615488082935551, 'f1-score': 0.11445030932516034, 'support': 60963}, '2': {'precision': 0.38720463889927165, 'recall': 0.6224766544863987, 'f1-score': 0.47742956079818644, 'support': 61575}, 'accuracy': 0.3904185533337339, 'macro avg': {'precision': 0.40051952080405634, 'recall': 0.3898488524001009, 'f1-score': 0.3409468676896313, 'support': 183083}, 'weighted avg': {'precision': 0.40049809890648874, 'recall': 0.3904185533337339, 'f1-score': 0.3411975824611036, 'support': 183083}}
[[29117  2983 28445]
 [24715  4033 32215]
 [20749  2497 38329]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0862613
{'0': {'precision': 0.39345352156740054, 'recall': 0.48650870406189556, 'f1-score': 0.4350608635488963, 'support': 62040}, '1': {'precision': 0.42753500927956806, 'recall': 0.04283661567069563, 'f1-score': 0.07787099351587229, 'support': 59155}, '2': {'precision': 0.3835906932289955, 'recall': 0.6225601085832472, 'f1-score': 0.4746967615550942, 'support': 61888}, 'accuracy': 0.38914590650142283, 'macro avg': {'precision': 0.4015264080253214, 'recall': 0.3839684761052795, 'f1-score': 0.32920953953995424, 'support': 183083}, 'weighted avg': {'precision': 0.40113145827045904, 'recall': 0.38914590650142283, 'f1-score': 0.33304931520199377, 'support': 183083}}
[[30183  1814 30043]
 [24750  2534 31871]
 [21780  1579 38529]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0905962
{'0': {'precision': 0.3855713615757386, 'recall': 0.4779344087584169, 'f1-score': 0.4268131773052714, 'support': 61929}, '1': {'precision': 0.43635589612601106, 'recall': 0.03375541321565593, 'f1-score': 0.06266334499992358, 'support': 60731}, '2': {'precision': 0.36755198236584957, 'recall': 0.6181586481968787, 'f1-score': 0.4609982473895979, 'support': 60423}, 'accuracy': 0.37687278447480105, 'macro avg': {'precision': 0.3964930800225331, 'recall': 0.3766161567236505, 'f1-score': 0.3168249232315976, 'support': 183083}, 'weighted avg': {'precision': 0.39647030149792406, 'recall': 0.37687278447480105, 'f1-score': 0.31730208683793787, 'support': 183083}}
[[29598  1416 30915]
 [25326  2050 33355]
 [21840  1232 37351]]
Evaluating performance on  val set...
214/214 - 3s - 3s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.086074
{'0': {'precision': 0.4036023689491459, 'recall': 0.45465071401003476, 'f1-score': 0.4276083800041485, 'support': 18137}, '1': {'precision': 0.3715705765407555, 'recall': 0.101317287363799, 'f1-score': 0.15921966179665203, 'support': 18447}, '2': {'precision': 0.3729661220155517, 'recall': 0.6025456557830658, 'f1-score': 0.4607409601591097, 'support': 18070}, 'accuracy': 0.38429026237786806, 'macro avg': {'precision': 0.38271302250181777, 'recall': 0.3861712190522999, 'f1-score': 0.3491896673199701, 'support': 54654}, 'weighted avg': {'precision': 0.38266177070111973, 'recall': 0.38429026237786806, 'f1-score': 0.34797539867847177, 'support': 54654}}
[[ 8246  1738  8153]
 [ 6426  1869 10152]
 [ 5759  1423 10888]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.083666
{'0': {'precision': 0.43037466547725245, 'recall': 0.47510955733911076, 'f1-score': 0.4516370614804933, 'support': 20309}, '1': {'precision': 0.30346420323325635, 'recall': 0.04748482220294883, 'f1-score': 0.08211986750828074, 'support': 13836}, '2': {'precision': 0.41291695766403935, 'recall': 0.6053927544005071, 'f1-score': 0.4909644509470521, 'support': 20509}, 'accuracy': 0.4157426720825557, 'macro avg': {'precision': 0.38225194212484936, 'recall': 0.3759957113141889, 'f1-score': 0.34157379331194204, 'support': 54654}, 'weighted avg': {'precision': 0.39169546020135104, 'recall': 0.4157426720825557, 'f1-score': 0.3728491508933473, 'support': 54654}}
[[ 9649   815  9845]
 [ 5371   657  7808]
 [ 7400   693 12416]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.085489
{'0': {'precision': 0.41799286894512566, 'recall': 0.4803137803537524, 'f1-score': 0.4469915372454199, 'support': 20014}, '1': {'precision': 0.34394904458598724, 'recall': 0.026209957010123422, 'f1-score': 0.04870820179112171, 'support': 14422}, '2': {'precision': 0.4076643649572929, 'recall': 0.6161341378969235, 'f1-score': 0.49067454455933035, 'support': 20218}, 'accuracy': 0.4107293153291616, 'macro avg': {'precision': 0.38986875949613525, 'recall': 0.37421929175359975, 'f1-score': 0.32879142786529064, 'support': 54654}, 'weighted avg': {'precision': 0.3946335223550591, 'recall': 0.4107293153291616, 'f1-score': 0.3580527729820678, 'support': 54654}}
[[ 9613   378 10023]
 [ 5967   378  8077]
 [ 7418   343 12457]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0889221
{'0': {'precision': 0.39898441907903304, 'recall': 0.4692939915258563, 'f1-score': 0.4312925170068027, 'support': 19589}, '1': {'precision': 0.3307291666666667, 'recall': 0.016651370132424282, 'f1-score': 0.031706403694919484, 'support': 15254}, '2': {'precision': 0.39734154644188685, 'recall': 0.6186462066528696, 'f1-score': 0.4838913455464308, 'support': 19811}, 'accuracy': 0.3970981080982179, 'macro avg': {'precision': 0.37568504406252884, 'recall': 0.3681971894370501, 'f1-score': 0.31563008874938436, 'support': 54654}, 'weighted avg': {'precision': 0.3793387834418841, 'recall': 0.3970981080982179, 'f1-score': 0.3388335720025781, 'support': 54654}}
[[ 9193   254 10142]
 [ 6553   254  8447]
 [ 7295   260 12256]]
training model: results/PCAR/W2/deepLOB_L2/seq2seq
Epoch 1/50
716/716 - 43s - loss: 12.9112 - accuracy10: 0.4201 - accuracy20: 0.4181 - accuracy30: 0.4060 - accuracy50: 0.3892 - val_loss: 13.1211 - val_accuracy10: 0.4072 - val_accuracy20: 0.3920 - val_accuracy30: 0.3848 - val_accuracy50: 0.3697 - 43s/epoch - 61ms/step
Epoch 2/50
716/716 - 37s - loss: 12.6436 - accuracy10: 0.4518 - accuracy20: 0.4556 - accuracy30: 0.4399 - accuracy50: 0.4123 - val_loss: 13.8225 - val_accuracy10: 0.3998 - val_accuracy20: 0.3704 - val_accuracy30: 0.3641 - val_accuracy50: 0.3453 - 37s/epoch - 51ms/step
Epoch 3/50
716/716 - 37s - loss: 12.3926 - accuracy10: 0.4793 - accuracy20: 0.4794 - accuracy30: 0.4620 - accuracy50: 0.4310 - val_loss: 13.3057 - val_accuracy10: 0.4308 - val_accuracy20: 0.4097 - val_accuracy30: 0.3996 - val_accuracy50: 0.3748 - 37s/epoch - 51ms/step
Epoch 4/50
716/716 - 37s - loss: 12.2354 - accuracy10: 0.4970 - accuracy20: 0.4914 - accuracy30: 0.4702 - accuracy50: 0.4362 - val_loss: 13.2698 - val_accuracy10: 0.4437 - val_accuracy20: 0.4190 - val_accuracy30: 0.4053 - val_accuracy50: 0.3803 - 37s/epoch - 51ms/step
Epoch 5/50
716/716 - 37s - loss: 12.1071 - accuracy10: 0.5086 - accuracy20: 0.5004 - accuracy30: 0.4790 - accuracy50: 0.4439 - val_loss: 13.1067 - val_accuracy10: 0.4692 - val_accuracy20: 0.4494 - val_accuracy30: 0.4297 - val_accuracy50: 0.4039 - 37s/epoch - 51ms/step
Epoch 6/50
716/716 - 37s - loss: 12.0252 - accuracy10: 0.5183 - accuracy20: 0.5073 - accuracy30: 0.4850 - accuracy50: 0.4462 - val_loss: 12.8348 - val_accuracy10: 0.4750 - val_accuracy20: 0.4620 - val_accuracy30: 0.4402 - val_accuracy50: 0.4121 - 37s/epoch - 52ms/step
Epoch 7/50
716/716 - 37s - loss: 11.9540 - accuracy10: 0.5247 - accuracy20: 0.5136 - accuracy30: 0.4902 - accuracy50: 0.4496 - val_loss: 12.8880 - val_accuracy10: 0.4746 - val_accuracy20: 0.4582 - val_accuracy30: 0.4375 - val_accuracy50: 0.4101 - 37s/epoch - 51ms/step
Epoch 8/50
716/716 - 37s - loss: 11.8879 - accuracy10: 0.5307 - accuracy20: 0.5189 - accuracy30: 0.4938 - accuracy50: 0.4518 - val_loss: 12.9417 - val_accuracy10: 0.4716 - val_accuracy20: 0.4534 - val_accuracy30: 0.4345 - val_accuracy50: 0.4079 - 37s/epoch - 51ms/step
Epoch 9/50
716/716 - 37s - loss: 11.8296 - accuracy10: 0.5373 - accuracy20: 0.5239 - accuracy30: 0.4982 - accuracy50: 0.4546 - val_loss: 12.8985 - val_accuracy10: 0.4784 - val_accuracy20: 0.4594 - val_accuracy30: 0.4394 - val_accuracy50: 0.4112 - 37s/epoch - 51ms/step
Epoch 10/50
716/716 - 36s - loss: 11.7755 - accuracy10: 0.5414 - accuracy20: 0.5269 - accuracy30: 0.5013 - accuracy50: 0.4572 - val_loss: 12.9604 - val_accuracy10: 0.4819 - val_accuracy20: 0.4582 - val_accuracy30: 0.4373 - val_accuracy50: 0.4110 - 36s/epoch - 51ms/step
Epoch 11/50
716/716 - 37s - loss: 11.7264 - accuracy10: 0.5444 - accuracy20: 0.5297 - accuracy30: 0.5038 - accuracy50: 0.4600 - val_loss: 12.8605 - val_accuracy10: 0.4845 - val_accuracy20: 0.4667 - val_accuracy30: 0.4447 - val_accuracy50: 0.4154 - 37s/epoch - 51ms/step
Epoch 12/50
716/716 - 37s - loss: 11.6848 - accuracy10: 0.5491 - accuracy20: 0.5328 - accuracy30: 0.5064 - accuracy50: 0.4616 - val_loss: 13.0277 - val_accuracy10: 0.4819 - val_accuracy20: 0.4561 - val_accuracy30: 0.4351 - val_accuracy50: 0.4074 - 37s/epoch - 52ms/step
Epoch 13/50
716/716 - 37s - loss: 11.6471 - accuracy10: 0.5512 - accuracy20: 0.5355 - accuracy30: 0.5092 - accuracy50: 0.4636 - val_loss: 12.8246 - val_accuracy10: 0.4840 - val_accuracy20: 0.4702 - val_accuracy30: 0.4468 - val_accuracy50: 0.4162 - 37s/epoch - 52ms/step
Epoch 14/50
716/716 - 37s - loss: 11.6056 - accuracy10: 0.5538 - accuracy20: 0.5377 - accuracy30: 0.5112 - accuracy50: 0.4658 - val_loss: 12.9072 - val_accuracy10: 0.4842 - val_accuracy20: 0.4674 - val_accuracy30: 0.4435 - val_accuracy50: 0.4130 - 37s/epoch - 51ms/step
Epoch 15/50
716/716 - 36s - loss: 11.5713 - accuracy10: 0.5566 - accuracy20: 0.5406 - accuracy30: 0.5136 - accuracy50: 0.4675 - val_loss: 12.9079 - val_accuracy10: 0.4825 - val_accuracy20: 0.4667 - val_accuracy30: 0.4442 - val_accuracy50: 0.4151 - 36s/epoch - 51ms/step
Epoch 16/50
716/716 - 36s - loss: 11.5377 - accuracy10: 0.5582 - accuracy20: 0.5429 - accuracy30: 0.5158 - accuracy50: 0.4696 - val_loss: 12.8330 - val_accuracy10: 0.4837 - val_accuracy20: 0.4734 - val_accuracy30: 0.4510 - val_accuracy50: 0.4194 - 36s/epoch - 50ms/step
Epoch 17/50
716/716 - 36s - loss: 11.5064 - accuracy10: 0.5611 - accuracy20: 0.5447 - accuracy30: 0.5186 - accuracy50: 0.4710 - val_loss: 12.8899 - val_accuracy10: 0.4797 - val_accuracy20: 0.4702 - val_accuracy30: 0.4469 - val_accuracy50: 0.4184 - 36s/epoch - 51ms/step
Epoch 18/50
716/716 - 37s - loss: 11.4780 - accuracy10: 0.5616 - accuracy20: 0.5458 - accuracy30: 0.5197 - accuracy50: 0.4739 - val_loss: 12.8478 - val_accuracy10: 0.4834 - val_accuracy20: 0.4697 - val_accuracy30: 0.4481 - val_accuracy50: 0.4193 - 37s/epoch - 51ms/step
Epoch 19/50
716/716 - 36s - loss: 11.4514 - accuracy10: 0.5633 - accuracy20: 0.5479 - accuracy30: 0.5213 - accuracy50: 0.4758 - val_loss: 13.0378 - val_accuracy10: 0.4832 - val_accuracy20: 0.4624 - val_accuracy30: 0.4404 - val_accuracy50: 0.4100 - 36s/epoch - 51ms/step
Epoch 20/50
716/716 - 36s - loss: 11.4195 - accuracy10: 0.5661 - accuracy20: 0.5514 - accuracy30: 0.5242 - accuracy50: 0.4768 - val_loss: 12.9162 - val_accuracy10: 0.4824 - val_accuracy20: 0.4706 - val_accuracy30: 0.4478 - val_accuracy50: 0.4155 - 36s/epoch - 51ms/step
Epoch 21/50
716/716 - 36s - loss: 11.3899 - accuracy10: 0.5676 - accuracy20: 0.5524 - accuracy30: 0.5249 - accuracy50: 0.4788 - val_loss: 12.9333 - val_accuracy10: 0.4760 - val_accuracy20: 0.4655 - val_accuracy30: 0.4443 - val_accuracy50: 0.4176 - 36s/epoch - 51ms/step
Epoch 22/50
716/716 - 36s - loss: 11.3675 - accuracy10: 0.5682 - accuracy20: 0.5540 - accuracy30: 0.5274 - accuracy50: 0.4812 - val_loss: 13.0712 - val_accuracy10: 0.4802 - val_accuracy20: 0.4641 - val_accuracy30: 0.4392 - val_accuracy50: 0.4097 - 36s/epoch - 51ms/step
Epoch 23/50
716/716 - 37s - loss: 11.3417 - accuracy10: 0.5693 - accuracy20: 0.5552 - accuracy30: 0.5293 - accuracy50: 0.4819 - val_loss: 12.9736 - val_accuracy10: 0.4792 - val_accuracy20: 0.4651 - val_accuracy30: 0.4423 - val_accuracy50: 0.4152 - 37s/epoch - 51ms/step
testing model: results/PCAR/W2/deepLOB_L2/seq2seq
Evaluating performance on  test set...
1914/1914 - 38s - 38s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0176638
{'0': {'precision': 0.5107034188110903, 'recall': 0.3738018749548342, 'f1-score': 0.43165800553806466, 'support': 152217}, '1': {'precision': 0.5322157513742992, 'recall': 0.538428500633225, 'f1-score': 0.5353041002901406, 'support': 181610}, '2': {'precision': 0.4556824249394176, 'recall': 0.5686133818517285, 'f1-score': 0.5059224551683253, 'support': 156092}, 'accuracy': 0.4968964257356828, 'macro avg': {'precision': 0.49953386504160235, 'recall': 0.49361458581326256, 'f1-score': 0.4909615203321769, 'support': 489919}, 'weighted avg': {'precision': 0.5011477937820288, 'recall': 0.4968964257356828, 'f1-score': 0.49374021451467337, 'support': 489919}}
[[56899 45691 49627]
 [27433 97784 56393]
 [27081 40255 88756]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0570924
{'0': {'precision': 0.518016587259573, 'recall': 0.34518399191011767, 'f1-score': 0.4142977606384668, 'support': 170089}, '1': {'precision': 0.4323638758702527, 'recall': 0.5559599636032757, 'f1-score': 0.4864336872016437, 'support': 142870}, '2': {'precision': 0.48710517037559364, 'recall': 0.5308939873417722, 'f1-score': 0.5080577998420888, 'support': 176960}, 'accuracy': 0.4737293307669227, 'macro avg': {'precision': 0.4791618778351398, 'recall': 0.4773459809517218, 'f1-score': 0.4695964158940664, 'support': 489919}, 'weighted avg': {'precision': 0.48187329171891996, 'recall': 0.4737293307669227, 'f1-score': 0.46920037998075403, 'support': 489919}}
[[58712 53726 57651]
 [22170 79430 41270]
 [32458 50555 93947]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0753859
{'0': {'precision': 0.48180554932986686, 'recall': 0.32105882563787014, 'f1-score': 0.38534011142261, 'support': 167393}, '1': {'precision': 0.4121832837529222, 'recall': 0.5194491505242459, 'f1-score': 0.4596410531195627, 'support': 146973}, '2': {'precision': 0.46650064974398536, 'recall': 0.5132694969610317, 'f1-score': 0.48876882936540234, 'support': 175553}, 'accuracy': 0.44944980700891374, 'macro avg': {'precision': 0.45349649427559147, 'recall': 0.4512591577077159, 'f1-score': 0.444583331302525, 'support': 489919}, 'weighted avg': {'precision': 0.45543503854004136, 'recall': 0.4494498070089137, 'f1-score': 0.4446916655061161, 'support': 489919}}
[[53743 55403 58247]
 [25828 76345 44800]
 [31974 53473 90106]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1056536
{'0': {'precision': 0.44451465422714515, 'recall': 0.2839504707181271, 'f1-score': 0.3465372355838887, 'support': 168466}, '1': {'precision': 0.360263340778033, 'recall': 0.47879240813333707, 'f1-score': 0.41115588020718236, 'support': 141836}, '2': {'precision': 0.4479474107861551, 'recall': 0.4833284154617881, 'f1-score': 0.4649658160628352, 'support': 179617}, 'accuracy': 0.41345610192705323, 'macro avg': {'precision': 0.41757513526377776, 'recall': 0.41535709810441745, 'f1-score': 0.4075529772846354, 'support': 489919}, 'weighted avg': {'precision': 0.4213816713064815, 'recall': 0.41345610192705323, 'f1-score': 0.4086639063573766, 'support': 489919}}
[[47836 60097 60533]
 [27469 67910 46457]
 [32309 60494 86814]]
Evaluating performance on  train set...
716/716 - 15s - 15s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.95676553
{'0': {'precision': 0.49868760848397614, 'recall': 0.44611713912401296, 'f1-score': 0.4709398206914474, 'support': 52809}, '1': {'precision': 0.5996675900277009, 'recall': 0.6373807560946885, 'f1-score': 0.6179493034939484, 'support': 76419}, '2': {'precision': 0.4772411015087154, 'recall': 0.4839847739299972, 'f1-score': 0.4805892819278885, 'support': 53855}, 'accuracy': 0.5370897352566869, 'macro avg': {'precision': 0.5251987666734642, 'recall': 0.5224942230495662, 'f1-score': 0.5231594687044281, 'support': 183083}, 'weighted avg': {'precision': 0.534528115666168, 'recall': 0.5370897352566869, 'f1-score': 0.5351401527876707, 'support': 183083}}
[[23559 16059 13191]
 [12351 48708 15360]
 [11332 16458 26065]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0064844
{'0': {'precision': 0.5237627208878515, 'recall': 0.42096341523624575, 'f1-score': 0.46677007299270074, 'support': 60763}, '1': {'precision': 0.49490014355151485, 'recall': 0.6465314448337692, 'f1-score': 0.5606442087544489, 'support': 60789}, '2': {'precision': 0.5015866647213306, 'recall': 0.4469779460759617, 'f1-score': 0.47271039763498707, 'support': 61531}, 'accuracy': 0.5046017380095367, 'macro avg': {'precision': 0.5067498430535656, 'recall': 0.5048242687153256, 'f1-score': 0.5000415597940456, 'support': 183083}, 'weighted avg': {'precision': 0.5067265016556958, 'recall': 0.5046017380095367, 'f1-score': 0.4999355168317542, 'support': 183083}}
[[25579 19390 15794]
 [ 9952 39302 11535]
 [13306 20722 27503]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0326769
{'0': {'precision': 0.506298053328971, 'recall': 0.3985128196874346, 'f1-score': 0.4459855000675462, 'support': 62131}, '1': {'precision': 0.4607362200162231, 'recall': 0.6044492491680884, 'f1-score': 0.5228979746909431, 'support': 59201}, '2': {'precision': 0.4766952151755379, 'recall': 0.4362520445013036, 'f1-score': 0.45557782231128924, 'support': 61751}, 'accuracy': 0.47783245850242784, 'macro avg': {'precision': 0.48124316284024404, 'recall': 0.47973803778560886, 'f1-score': 0.4748204323565928, 'support': 183083}, 'weighted avg': {'precision': 0.4815807887399014, 'recall': 0.47783245850242784, 'f1-score': 0.4740909544300653, 'support': 183083}}
[[24760 20326 17045]
 [10889 35784 12528]
 [13255 21557 26939]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0704176
{'0': {'precision': 0.47048293089092424, 'recall': 0.36425463336019337, 'f1-score': 0.41060950131710416, 'support': 62050}, '1': {'precision': 0.4239114777712303, 'recall': 0.5339094867396754, 'f1-score': 0.4725942903859209, 'support': 60632}, '2': {'precision': 0.43391049456355024, 'recall': 0.42153275608019736, 'f1-score': 0.42763207618471777, 'support': 60401}, 'accuracy': 0.4393362573259123, 'macro avg': {'precision': 0.44276830107523485, 'recall': 0.43989895872668877, 'f1-score': 0.4369452892959143, 'support': 183083}, 'weighted avg': {'precision': 0.4429941303350944, 'recall': 0.4393362573259123, 'f1-score': 0.43675306612322606, 'support': 183083}}
[[22602 21722 17726]
 [12769 32372 15491]
 [12669 22271 25461]]
Evaluating performance on  val set...
214/214 - 4s - 4s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0307943
{'0': {'precision': 0.48311369577975777, 'recall': 0.49807480748074806, 'f1-score': 0.4904801885003927, 'support': 18180}, '1': {'precision': 0.5088375039594552, 'recall': 0.43694918942443695, 'f1-score': 0.4701612667193491, 'support': 18382}, '2': {'precision': 0.46646129384875284, 'recall': 0.5189033827105903, 'f1-score': 0.491286828196138, 'support': 18092}, 'accuracy': 0.4844110220660885, 'macro avg': {'precision': 0.4861374978626553, 'recall': 0.48464245987192517, 'f1-score': 0.48397609447195994, 'support': 54654}, 'weighted avg': {'precision': 0.48625307782358723, 'recall': 0.4844110220660885, 'f1-score': 0.48391326394219536, 'support': 54654}}
[[9055 3759 5366]
 [4978 8032 5372]
 [4710 3994 9388]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0534829
{'0': {'precision': 0.500444537419591, 'recall': 0.470892180502928, 'f1-score': 0.48521880229197306, 'support': 20321}, '1': {'precision': 0.3984189723320158, 'recall': 0.43620627479264334, 'f1-score': 0.41645722155276294, 'support': 13865}, '2': {'precision': 0.4949638873876087, 'recall': 0.49218291967949973, 'f1-score': 0.49356948629381936, 'support': 20468}, 'accuracy': 0.47006623485929666, 'macro avg': {'precision': 0.46460913237973855, 'recall': 0.4664271249916904, 'f1-score': 0.4650818367128518, 'support': 54654}, 'weighted avg': {'precision': 0.47250948408783405, 'recall': 0.47006623485929666, 'f1-score': 0.4709022377806956, 'support': 54654}}
[[ 9569  4341  6411]
 [ 3949  6048  3868]
 [ 5603  4791 10074]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0716614
{'0': {'precision': 0.47708477831723844, 'recall': 0.44674260591526777, 'f1-score': 0.46141541319435486, 'support': 20016}, '1': {'precision': 0.3808133613958857, 'recall': 0.3878171886883772, 'f1-score': 0.3842833653055631, 'support': 14463}, '2': {'precision': 0.46832216032480406, 'recall': 0.49169764560099133, 'f1-score': 0.4797253185675943, 'support': 20175}, 'accuracy': 0.44774398946097266, 'macro avg': {'precision': 0.4420734333459761, 'recall': 0.44208581340154546, 'f1-score': 0.4418080323558374, 'support': 54654}, 'weighted avg': {'precision': 0.44837399189847876, 'recall': 0.44774398946097266, 'f1-score': 0.44776300956954257, 'support': 54654}}
[[8942 4309 6765]
 [4357 5609 4497]
 [5444 4811 9920]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0949742
{'0': {'precision': 0.45041437232326603, 'recall': 0.41286835933516874, 'f1-score': 0.4308248876120554, 'support': 19614}, '1': {'precision': 0.3471120005520668, 'recall': 0.3306817434751167, 'f1-score': 0.33869773079253923, 'support': 15211}, '2': {'precision': 0.4345023440317346, 'recall': 0.4861062080790761, 'f1-score': 0.4588579725323114, 'support': 19829}, 'accuracy': 0.41656603359314964, 'macro avg': {'precision': 0.41067623896902244, 'recall': 0.4098854369631206, 'f1-score': 0.4094601969789687, 'support': 54654}, 'weighted avg': {'precision': 0.41589078784629296, 'recall': 0.41656603359314964, 'f1-score': 0.41535523961743637, 'support': 54654}}
[[8098 4463 7053]
 [4689 5030 5492]
 [5192 4998 9639]]
training model: results/PCAR/W2/deepOF_L2/seq2seq
Epoch 1/50
716/716 - 30s - loss: 12.6431 - accuracy10: 0.4553 - accuracy20: 0.4446 - accuracy30: 0.4280 - accuracy50: 0.4011 - val_loss: 12.6706 - val_accuracy10: 0.4705 - val_accuracy20: 0.4556 - val_accuracy30: 0.4302 - val_accuracy50: 0.4018 - 30s/epoch - 42ms/step
Epoch 2/50
716/716 - 25s - loss: 12.0649 - accuracy10: 0.5281 - accuracy20: 0.5065 - accuracy30: 0.4784 - accuracy50: 0.4384 - val_loss: 12.7858 - val_accuracy10: 0.4857 - val_accuracy20: 0.4513 - val_accuracy30: 0.4220 - val_accuracy50: 0.3908 - 25s/epoch - 35ms/step
Epoch 3/50
716/716 - 24s - loss: 11.8740 - accuracy10: 0.5457 - accuracy20: 0.5238 - accuracy30: 0.4933 - accuracy50: 0.4474 - val_loss: 12.7616 - val_accuracy10: 0.4924 - val_accuracy20: 0.4628 - val_accuracy30: 0.4346 - val_accuracy50: 0.4012 - 24s/epoch - 34ms/step
Epoch 4/50
716/716 - 24s - loss: 11.7897 - accuracy10: 0.5513 - accuracy20: 0.5286 - accuracy30: 0.4980 - accuracy50: 0.4513 - val_loss: 12.7563 - val_accuracy10: 0.4929 - val_accuracy20: 0.4659 - val_accuracy30: 0.4372 - val_accuracy50: 0.4044 - 24s/epoch - 33ms/step
Epoch 5/50
716/716 - 24s - loss: 11.7327 - accuracy10: 0.5555 - accuracy20: 0.5327 - accuracy30: 0.5019 - accuracy50: 0.4553 - val_loss: 12.7850 - val_accuracy10: 0.4947 - val_accuracy20: 0.4713 - val_accuracy30: 0.4419 - val_accuracy50: 0.4054 - 24s/epoch - 33ms/step
Epoch 6/50
716/716 - 24s - loss: 11.6922 - accuracy10: 0.5589 - accuracy20: 0.5349 - accuracy30: 0.5034 - accuracy50: 0.4562 - val_loss: 12.7933 - val_accuracy10: 0.4920 - val_accuracy20: 0.4682 - val_accuracy30: 0.4405 - val_accuracy50: 0.4074 - 24s/epoch - 34ms/step
Epoch 7/50
716/716 - 24s - loss: 11.6530 - accuracy10: 0.5602 - accuracy20: 0.5367 - accuracy30: 0.5063 - accuracy50: 0.4593 - val_loss: 12.8380 - val_accuracy10: 0.4965 - val_accuracy20: 0.4692 - val_accuracy30: 0.4387 - val_accuracy50: 0.4047 - 24s/epoch - 33ms/step
Epoch 8/50
716/716 - 24s - loss: 11.6194 - accuracy10: 0.5631 - accuracy20: 0.5393 - accuracy30: 0.5093 - accuracy50: 0.4618 - val_loss: 12.8665 - val_accuracy10: 0.4948 - val_accuracy20: 0.4677 - val_accuracy30: 0.4387 - val_accuracy50: 0.4033 - 24s/epoch - 34ms/step
Epoch 9/50
716/716 - 24s - loss: 11.5890 - accuracy10: 0.5651 - accuracy20: 0.5414 - accuracy30: 0.5105 - accuracy50: 0.4626 - val_loss: 12.8835 - val_accuracy10: 0.4971 - val_accuracy20: 0.4703 - val_accuracy30: 0.4404 - val_accuracy50: 0.4061 - 24s/epoch - 34ms/step
Epoch 10/50
716/716 - 24s - loss: 11.5643 - accuracy10: 0.5654 - accuracy20: 0.5429 - accuracy30: 0.5114 - accuracy50: 0.4636 - val_loss: 12.8291 - val_accuracy10: 0.4959 - val_accuracy20: 0.4690 - val_accuracy30: 0.4398 - val_accuracy50: 0.4062 - 24s/epoch - 33ms/step
Epoch 11/50
716/716 - 24s - loss: 11.5336 - accuracy10: 0.5687 - accuracy20: 0.5458 - accuracy30: 0.5148 - accuracy50: 0.4663 - val_loss: 12.9147 - val_accuracy10: 0.4947 - val_accuracy20: 0.4708 - val_accuracy30: 0.4402 - val_accuracy50: 0.4076 - 24s/epoch - 33ms/step
testing model: results/PCAR/W2/deepOF_L2/seq2seq
Evaluating performance on  test set...
1914/1914 - 28s - 28s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0192267
{'0': {'precision': 0.4681963863261794, 'recall': 0.5057747644763294, 'f1-score': 0.4862606388858185, 'support': 152214}, '1': {'precision': 0.5372190559508034, 'recall': 0.4598615707371331, 'f1-score': 0.49553946248075303, 'support': 181609}, '2': {'precision': 0.4508219379503014, 'recall': 0.49106610887238855, 'f1-score': 0.4700842644948423, 'support': 156091}, 'accuracy': 0.4840686324538592, 'macro avg': {'precision': 0.4854124600757614, 'recall': 0.4855674813619504, 'f1-score': 0.4839614552871379, 'support': 489914}, 'weighted avg': {'precision': 0.48824713602187947, 'recall': 0.4840686324538592, 'f1-score': 0.4845463204935917, 'support': 489914}}
[[76986 35481 39747]
 [44467 83515 53627]
 [42978 36462 76651]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0314144
{'0': {'precision': 0.47901169274635824, 'recall': 0.4899051068283104, 'f1-score': 0.4843971631205674, 'support': 170086}, '1': {'precision': 0.4224571108696368, 'recall': 0.44899873310515226, 'f1-score': 0.43532373758966314, 'support': 142869}, '2': {'precision': 0.4801815799896414, 'recall': 0.4453291440390147, 'f1-score': 0.46209913391228885, 'support': 176959}, 'accuracy': 0.461874941316231, 'macro avg': {'precision': 0.4605501278685455, 'recall': 0.4614109946574924, 'f1-score': 0.46060667820750645, 'support': 489914}, 'weighted avg': {'precision': 0.4629417815344697, 'recall': 0.461874941316231, 'f1-score': 0.46203220073361273, 'support': 489914}}
[[83326 41870 44890]
 [38301 64148 40420]
 [52327 45827 78805]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0552335
{'0': {'precision': 0.44556629342678017, 'recall': 0.4861490301035313, 'f1-score': 0.46497383036591766, 'support': 167389}, '1': {'precision': 0.39977185948183414, 'recall': 0.39821599885693293, 'f1-score': 0.3989924124155515, 'support': 146973}, '2': {'precision': 0.45957184947600044, 'recall': 0.42115726394458625, 'f1-score': 0.43952679606456024, 'support': 175552}, 'accuracy': 0.43648068844736015, 'macro avg': {'precision': 0.4349700007948716, 'recall': 0.43517409763501685, 'f1-score': 0.4344976796153432, 'support': 489914}, 'weighted avg': {'precision': 0.43684671822656573, 'recall': 0.43648068844736015, 'f1-score': 0.436061072808283, 'support': 489914}}
[[81376 41856 44157]
 [45660 58527 42786]
 [55599 46018 73935]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0769614
{'0': {'precision': 0.41720860430215106, 'recall': 0.47031377996224666, 'f1-score': 0.44217240984800493, 'support': 168462}, '1': {'precision': 0.3507810886088573, 'recall': 0.3471826616655856, 'f1-score': 0.34897259909927464, 'support': 141836}, '2': {'precision': 0.4483173378104092, 'recall': 0.3984277569926955, 'f1-score': 0.42190281920977224, 'support': 179616}, 'accuracy': 0.40831043815853396, 'macro avg': {'precision': 0.4054356769071392, 'recall': 0.4053080662068426, 'f1-score': 0.4043492760523506, 'support': 489914}, 'weighted avg': {'precision': 0.40938235961827857, 'recall': 0.40831043815853396, 'f1-score': 0.40775855119233534, 'support': 489914}}
[[79230 43882 45350]
 [49879 49243 42714]
 [60796 47256 71564]]
Evaluating performance on  train set...
716/716 - 11s - 11s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.99818707
{'0': {'precision': 0.4622507898463885, 'recall': 0.4826618636837615, 'f1-score': 0.4722358767935151, 'support': 52745}, '1': {'precision': 0.5985625198182011, 'recall': 0.5185693915728059, 'f1-score': 0.5557019695801501, 'support': 76443}, '2': {'precision': 0.4335081415298954, 'recall': 0.49694776880972263, 'f1-score': 0.46306525929960146, 'support': 53895}, 'accuracy': 0.5018598122163171, 'macro avg': {'precision': 0.4981071503981616, 'recall': 0.4993930080220967, 'f1-score': 0.4970010352244221, 'support': 183083}, 'weighted avg': {'precision': 0.5107041828059635, 'recall': 0.5018598122163171, 'f1-score': 0.5043860387476794, 'support': 183083}}
[[25458 13504 13783]
 [15586 39641 21216]
 [14030 13082 26783]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0158796
{'0': {'precision': 0.4842849076941503, 'recall': 0.4675035097861095, 'f1-score': 0.47574626865671643, 'support': 60545}, '1': {'precision': 0.484648815365204, 'recall': 0.5103587421878845, 'f1-score': 0.4971716203259828, 'support': 60963}, '2': {'precision': 0.4628137460911001, 'recall': 0.45427527405602924, 'f1-score': 0.45850476174865185, 'support': 61575}, 'accuracy': 0.4773244921702179, 'macro avg': {'precision': 0.4772491563834848, 'recall': 0.477379175343341, 'f1-score': 0.477140883577117, 'support': 183083}, 'weighted avg': {'precision': 0.4771848390238894, 'recall': 0.4773244921702179, 'f1-score': 0.4770817718216711, 'support': 183083}}
[[28305 16358 15882]
 [13265 31113 16585]
 [16877 16726 27972]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0401593
{'0': {'precision': 0.46473520957500364, 'recall': 0.4612669245647969, 'f1-score': 0.46299457194398824, 'support': 62040}, '1': {'precision': 0.44334694807413794, 'recall': 0.46056968979798835, 'f1-score': 0.4517942425046432, 'support': 59155}, '2': {'precision': 0.4435914941801409, 'recall': 0.43043885729058945, 'f1-score': 0.43691621357869787, 'support': 61888}, 'accuracy': 0.4506207567059749, 'macro avg': {'precision': 0.45055788394309415, 'recall': 0.4507584905511249, 'f1-score': 0.45056834267577645, 'support': 183083}, 'weighted avg': {'precision': 0.450677296675166, 'recall': 0.4506207567059749, 'f1-score': 0.45056035942564654, 'support': 183083}}
[[28617 16992 16431]
 [14927 27245 16983]
 [18033 17216 26639]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.070565
{'0': {'precision': 0.42684724096740667, 'recall': 0.44429911673044936, 'f1-score': 0.43539837012421867, 'support': 61929}, '1': {'precision': 0.4078362293063347, 'recall': 0.39266601900182774, 'f1-score': 0.40010737984782263, 'support': 60731}, '2': {'precision': 0.4096591853699086, 'recall': 0.4078082849246148, 'f1-score': 0.40873163975351035, 'support': 60423}, 'accuracy': 0.415128657494142, 'macro avg': {'precision': 0.41478088521455, 'recall': 0.4149244735522973, 'f1-score': 0.4147457965751839, 'support': 183083}, 'weighted avg': {'precision': 0.4148684573962603, 'recall': 0.415128657494142, 'f1-score': 0.414891053881503, 'support': 183083}}
[[27515 17453 16961]
 [18336 23847 18548]
 [18610 17172 24641]]
Evaluating performance on  val set...
214/214 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0317272
{'0': {'precision': 0.47733628832251596, 'recall': 0.4987594420245906, 'f1-score': 0.4878127696289905, 'support': 18137}, '1': {'precision': 0.5007975499266254, 'recall': 0.4254892394427278, 'f1-score': 0.46008206330597895, 'support': 18447}, '2': {'precision': 0.4510234648027958, 'recall': 0.4999446596568899, 'f1-score': 0.4742257217847769, 'support': 18070}, 'accuracy': 0.47442090240421564, 'macro avg': {'precision': 0.47638576768397906, 'recall': 0.4747311137080694, 'f1-score': 0.4740401849065821, 'support': 54654}, 'weighted avg': {'precision': 0.47655532392484445, 'recall': 0.47442090240421564, 'f1-score': 0.4739607863508126, 'support': 54654}}
[[9046 4020 5071]
 [4673 7849 5925]
 [5232 3804 9034]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0347503
{'0': {'precision': 0.4923154193872426, 'recall': 0.48264316312964695, 'f1-score': 0.48743131355826846, 'support': 20309}, '1': {'precision': 0.37713876780951144, 'recall': 0.4189794738363689, 'f1-score': 0.39695963296470027, 'support': 13836}, '2': {'precision': 0.4809270634388066, 'recall': 0.45428836120727484, 'f1-score': 0.46722832355448574, 'support': 20509}, 'accuracy': 0.45588611995462364, 'macro avg': {'precision': 0.4501270835451869, 'recall': 0.4519703327244302, 'f1-score': 0.45053975669248486, 'support': 54654}, 'weighted avg': {'precision': 0.45888423514865145, 'recall': 0.45588611995462364, 'f1-score': 0.4569466409875474, 'support': 54654}}
[[9802 4718 5789]
 [3772 5797 4267]
 [6336 4856 9317]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0598161
{'0': {'precision': 0.45829145728643217, 'recall': 0.4784650744478865, 'f1-score': 0.46816104035786743, 'support': 20014}, '1': {'precision': 0.34861949664201886, 'recall': 0.35633060601858274, 'f1-score': 0.3524328772760004, 'support': 14422}, '2': {'precision': 0.45572615416973394, 'recall': 0.42867741616381444, 'f1-score': 0.44178815373636454, 'support': 20218}, 'accuracy': 0.42781864090459987, 'macro avg': {'precision': 0.4208790360327283, 'recall': 0.4211576988767612, 'f1-score': 0.4207940237900775, 'support': 54654}, 'weighted avg': {'precision': 0.4284024406576926, 'recall': 0.42781864090459987, 'f1-score': 0.42786685164926, 'support': 54654}}
[[9576 4674 5764]
 [4696 5139 4587]
 [6623 4928 8667]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0836201
{'0': {'precision': 0.42288236917134187, 'recall': 0.469447138700291, 'f1-score': 0.44494980041127374, 'support': 19589}, '1': {'precision': 0.32740719670032714, 'recall': 0.30182247279402125, 'f1-score': 0.314094692318188, 'support': 15254}, '2': {'precision': 0.4340974212034384, 'recall': 0.41295240018171725, 'f1-score': 0.42326098766070835, 'support': 19811}, 'accuracy': 0.40218465254144253, 'macro avg': {'precision': 0.3947956623583691, 'recall': 0.3947406705586765, 'f1-score': 0.39410182679672334, 'support': 54654}, 'weighted avg': {'precision': 0.40030036446784356, 'recall': 0.40218465254144253, 'f1-score': 0.4005662074765685, 'support': 54654}}
[[9196 4680 5713]
 [5698 4604 4952]
 [6852 4778 8181]]
training model: results/PCAR/W2/deepVOL_L2/seq2seq
Epoch 1/50
716/716 - 30s - loss: 12.6547 - accuracy10: 0.4517 - accuracy20: 0.4470 - accuracy30: 0.4321 - accuracy50: 0.4064 - val_loss: 12.9242 - val_accuracy10: 0.4433 - val_accuracy20: 0.4417 - val_accuracy30: 0.4188 - val_accuracy50: 0.3938 - 30s/epoch - 41ms/step
Epoch 2/50
716/716 - 23s - loss: 12.1671 - accuracy10: 0.5077 - accuracy20: 0.4955 - accuracy30: 0.4720 - accuracy50: 0.4341 - val_loss: 12.7639 - val_accuracy10: 0.4778 - val_accuracy20: 0.4607 - val_accuracy30: 0.4323 - val_accuracy50: 0.3949 - 23s/epoch - 32ms/step
Epoch 3/50
716/716 - 23s - loss: 11.9393 - accuracy10: 0.5346 - accuracy20: 0.5146 - accuracy30: 0.4884 - accuracy50: 0.4472 - val_loss: 12.6823 - val_accuracy10: 0.4894 - val_accuracy20: 0.4700 - val_accuracy30: 0.4392 - val_accuracy50: 0.3994 - 23s/epoch - 32ms/step
Epoch 4/50
716/716 - 23s - loss: 11.8521 - accuracy10: 0.5432 - accuracy20: 0.5235 - accuracy30: 0.4951 - accuracy50: 0.4521 - val_loss: 12.6722 - val_accuracy10: 0.4909 - val_accuracy20: 0.4696 - val_accuracy30: 0.4398 - val_accuracy50: 0.4004 - 23s/epoch - 33ms/step
Epoch 5/50
716/716 - 24s - loss: 11.7930 - accuracy10: 0.5478 - accuracy20: 0.5271 - accuracy30: 0.5006 - accuracy50: 0.4562 - val_loss: 12.6676 - val_accuracy10: 0.4943 - val_accuracy20: 0.4650 - val_accuracy30: 0.4336 - val_accuracy50: 0.3952 - 24s/epoch - 33ms/step
Epoch 6/50
716/716 - 24s - loss: 11.7439 - accuracy10: 0.5507 - accuracy20: 0.5298 - accuracy30: 0.5022 - accuracy50: 0.4579 - val_loss: 12.6672 - val_accuracy10: 0.4960 - val_accuracy20: 0.4669 - val_accuracy30: 0.4353 - val_accuracy50: 0.3939 - 24s/epoch - 34ms/step
Epoch 7/50
716/716 - 24s - loss: 11.6934 - accuracy10: 0.5538 - accuracy20: 0.5332 - accuracy30: 0.5052 - accuracy50: 0.4595 - val_loss: 12.6047 - val_accuracy10: 0.4994 - val_accuracy20: 0.4724 - val_accuracy30: 0.4411 - val_accuracy50: 0.4032 - 24s/epoch - 34ms/step
Epoch 8/50
716/716 - 24s - loss: 11.6561 - accuracy10: 0.5577 - accuracy20: 0.5365 - accuracy30: 0.5074 - accuracy50: 0.4612 - val_loss: 12.5644 - val_accuracy10: 0.4988 - val_accuracy20: 0.4773 - val_accuracy30: 0.4476 - val_accuracy50: 0.4054 - 24s/epoch - 33ms/step
Epoch 9/50
716/716 - 24s - loss: 11.6135 - accuracy10: 0.5601 - accuracy20: 0.5397 - accuracy30: 0.5105 - accuracy50: 0.4638 - val_loss: 12.5438 - val_accuracy10: 0.5001 - val_accuracy20: 0.4800 - val_accuracy30: 0.4487 - val_accuracy50: 0.4075 - 24s/epoch - 33ms/step
Epoch 10/50
716/716 - 24s - loss: 11.5789 - accuracy10: 0.5624 - accuracy20: 0.5414 - accuracy30: 0.5118 - accuracy50: 0.4648 - val_loss: 12.5616 - val_accuracy10: 0.5072 - val_accuracy20: 0.4824 - val_accuracy30: 0.4512 - val_accuracy50: 0.4105 - 24s/epoch - 33ms/step
Epoch 11/50
716/716 - 24s - loss: 11.5514 - accuracy10: 0.5655 - accuracy20: 0.5436 - accuracy30: 0.5144 - accuracy50: 0.4668 - val_loss: 12.6410 - val_accuracy10: 0.5028 - val_accuracy20: 0.4783 - val_accuracy30: 0.4480 - val_accuracy50: 0.4108 - 24s/epoch - 33ms/step
Epoch 12/50
716/716 - 23s - loss: 11.5251 - accuracy10: 0.5676 - accuracy20: 0.5457 - accuracy30: 0.5156 - accuracy50: 0.4680 - val_loss: 12.6369 - val_accuracy10: 0.5057 - val_accuracy20: 0.4800 - val_accuracy30: 0.4490 - val_accuracy50: 0.4116 - 23s/epoch - 33ms/step
Epoch 13/50
716/716 - 24s - loss: 11.5039 - accuracy10: 0.5680 - accuracy20: 0.5465 - accuracy30: 0.5169 - accuracy50: 0.4698 - val_loss: 12.6133 - val_accuracy10: 0.5039 - val_accuracy20: 0.4807 - val_accuracy30: 0.4476 - val_accuracy50: 0.4105 - 24s/epoch - 33ms/step
Epoch 14/50
716/716 - 24s - loss: 11.4799 - accuracy10: 0.5704 - accuracy20: 0.5484 - accuracy30: 0.5184 - accuracy50: 0.4710 - val_loss: 12.6069 - val_accuracy10: 0.5076 - val_accuracy20: 0.4839 - val_accuracy30: 0.4517 - val_accuracy50: 0.4127 - 24s/epoch - 33ms/step
Epoch 15/50
716/716 - 24s - loss: 11.4631 - accuracy10: 0.5717 - accuracy20: 0.5495 - accuracy30: 0.5189 - accuracy50: 0.4720 - val_loss: 12.6396 - val_accuracy10: 0.5082 - val_accuracy20: 0.4814 - val_accuracy30: 0.4478 - val_accuracy50: 0.4098 - 24s/epoch - 33ms/step
Epoch 16/50
716/716 - 23s - loss: 11.4421 - accuracy10: 0.5725 - accuracy20: 0.5507 - accuracy30: 0.5218 - accuracy50: 0.4740 - val_loss: 12.5813 - val_accuracy10: 0.5061 - val_accuracy20: 0.4850 - val_accuracy30: 0.4539 - val_accuracy50: 0.4164 - 23s/epoch - 33ms/step
Epoch 17/50
716/716 - 23s - loss: 11.4228 - accuracy10: 0.5732 - accuracy20: 0.5523 - accuracy30: 0.5222 - accuracy50: 0.4736 - val_loss: 12.5895 - val_accuracy10: 0.5094 - val_accuracy20: 0.4847 - val_accuracy30: 0.4522 - val_accuracy50: 0.4137 - 23s/epoch - 33ms/step
Epoch 18/50
716/716 - 23s - loss: 11.4069 - accuracy10: 0.5747 - accuracy20: 0.5537 - accuracy30: 0.5239 - accuracy50: 0.4756 - val_loss: 12.5635 - val_accuracy10: 0.5085 - val_accuracy20: 0.4851 - val_accuracy30: 0.4531 - val_accuracy50: 0.4160 - 23s/epoch - 32ms/step
Epoch 19/50
716/716 - 23s - loss: 11.3893 - accuracy10: 0.5742 - accuracy20: 0.5535 - accuracy30: 0.5246 - accuracy50: 0.4763 - val_loss: 12.5938 - val_accuracy10: 0.5072 - val_accuracy20: 0.4830 - val_accuracy30: 0.4510 - val_accuracy50: 0.4132 - 23s/epoch - 32ms/step
testing model: results/PCAR/W2/deepVOL_L2/seq2seq
Evaluating performance on  test set...
1914/1914 - 27s - 27s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9954555
{'0': {'precision': 0.5402123849740982, 'recall': 0.37062877339587563, 'f1-score': 0.4396337424508085, 'support': 152217}, '1': {'precision': 0.5984387679142663, 'recall': 0.49135510159132206, 'f1-score': 0.5396358886439709, 'support': 181610}, '2': {'precision': 0.4580133940847728, 'recall': 0.6935781462214592, 'f1-score': 0.5517026996037864, 'support': 156092}, 'accuracy': 0.5182754700266778, 'macro avg': {'precision': 0.5322215156577125, 'recall': 0.518520673736219, 'f1-score': 0.5103241102328553, 'support': 489919}, 'weighted avg': {'precision': 0.5356073145846406, 'recall': 0.5182754700266778, 'f1-score': 0.5124099716439258, 'support': 489919}}
[[ 56416  32599  63202]
 [ 27466  89235  64909]
 [ 20551  27279 108262]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0042074
{'0': {'precision': 0.5504055731426867, 'recall': 0.3363062867087231, 'f1-score': 0.4175084666588812, 'support': 170089}, '1': {'precision': 0.48336594911937375, 'recall': 0.4979071883530482, 'f1-score': 0.490528827257118, 'support': 142870}, '2': {'precision': 0.48634978059156536, 'recall': 0.656374321880651, 'f1-score': 0.5587131779962674, 'support': 176960}, 'accuracy': 0.49904167831825264, 'macro avg': {'precision': 0.5067071009512086, 'recall': 0.4968625989808075, 'f1-score': 0.48891682397075553, 'support': 489919}, 'weighted avg': {'precision': 0.5077183858034384, 'recall': 0.49904167831825264, 'f1-score': 0.4898061416560419, 'support': 489919}}
[[ 57202  40454  72433]
 [ 21495  71136  50239]
 [ 25230  35578 116152]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0400711
{'0': {'precision': 0.511568073664255, 'recall': 0.3159630331017426, 'f1-score': 0.39064779286582146, 'support': 167393}, '1': {'precision': 0.43788673661555017, 'recall': 0.4429725187619495, 'f1-score': 0.4404149458994158, 'support': 146973}, '2': {'precision': 0.46342458093512323, 'recall': 0.6278787602604342, 'f1-score': 0.5332604425694961, 'support': 175553}, 'accuracy': 0.4658341480938686, 'macro avg': {'precision': 0.4709597970716428, 'recall': 0.46227143737470877, 'f1-score': 0.45477439377824447, 'support': 489919}, 'weighted avg': {'precision': 0.47221278895568775, 'recall': 0.4658341480938686, 'f1-score': 0.45668014979877497, 'support': 489919}}
[[ 52890  43937  70566]
 [ 24809  65105  57059]
 [ 25689  39638 110226]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.073841
{'0': {'precision': 0.46725111037840145, 'recall': 0.28600429760307716, 'f1-score': 0.35482208082950395, 'support': 168466}, '1': {'precision': 0.3643143966822461, 'recall': 0.39019007868242195, 'f1-score': 0.37680853526516106, 'support': 141836}, '2': {'precision': 0.4464666590035378, 'recall': 0.5838589888484943, 'f1-score': 0.5060022966987369, 'support': 179617}, 'accuracy': 0.4253682751638536, 'macro avg': {'precision': 0.4260107220213951, 'recall': 0.4200177883779978, 'f1-score': 0.41254430426446725, 'support': 489919}, 'weighted avg': {'precision': 0.4298298784473949, 'recall': 0.4253682751638536, 'f1-score': 0.41661394353562453, 'support': 489919}}
[[ 48182  49500  70784]
 [ 27257  55343  59236]
 [ 27679  47067 104871]]
Evaluating performance on  train set...
716/716 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9366784
{'0': {'precision': 0.5422598963048308, 'recall': 0.3743111969550645, 'f1-score': 0.44289843382402366, 'support': 52809}, '1': {'precision': 0.6365070941794213, 'recall': 0.5964354414478075, 'f1-score': 0.6158200868760428, 'support': 76419}, '2': {'precision': 0.4626509557196556, 'recall': 0.6444898338130164, 'f1-score': 0.5386376157111045, 'support': 53855}, 'accuracy': 0.5465007674115019, 'macro avg': {'precision': 0.5471393154013026, 'recall': 0.5384121574052961, 'f1-score': 0.5324520454703903, 'support': 183083}, 'weighted avg': {'precision': 0.5581812932622967, 'recall': 0.5465007674115019, 'f1-score': 0.5432383531235272, 'support': 183083}}
[[19767 13761 19281]
 [ 9808 45579 21032]
 [ 6878 12268 34709]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.96733296
{'0': {'precision': 0.5663738542121345, 'recall': 0.3416717410266116, 'f1-score': 0.42622075775772694, 'support': 60763}, '1': {'precision': 0.5218231141789879, 'recall': 0.6043856618796164, 'f1-score': 0.5600780511600963, 'support': 60789}, '2': {'precision': 0.4865693238621415, 'recall': 0.6011441387268206, 'f1-score': 0.537822334988477, 'support': 61531}, 'accuracy': 0.5161047175324852, 'macro avg': {'precision': 0.5249220974177546, 'recall': 0.5157338472110161, 'f1-score': 0.5080403813021, 'support': 183083}, 'weighted avg': {'precision': 0.5247607743912862, 'recall': 0.5161047175324852, 'f1-score': 0.508172701178044, 'support': 183083}}
[[20761 17439 22563]
 [ 7581 36740 16468]
 [ 8314 16228 36989]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0058191
{'0': {'precision': 0.5437971101254456, 'recall': 0.32164298015483417, 'f1-score': 0.4042071197411004, 'support': 62131}, '1': {'precision': 0.47283548249964574, 'recall': 0.5636391277174372, 'f1-score': 0.5142597344553097, 'support': 59201}, '2': {'precision': 0.4657885011351037, 'recall': 0.5714887208304319, 'f1-score': 0.513253099661855, 'support': 61751}, 'accuracy': 0.4841629206425501, 'macro avg': {'precision': 0.4941403645867317, 'recall': 0.4855902762342344, 'f1-score': 0.4772399846194217, 'support': 183083}, 'weighted avg': {'precision': 0.49454016693116987, 'recall': 0.4841629206425501, 'f1-score': 0.4765727853123573, 'support': 183083}}
[[19984 19310 22837]
 [ 8196 33368 17637]
 [ 8569 17892 35290]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0571842
{'0': {'precision': 0.4953096699197102, 'recall': 0.29527800161160356, 'f1-score': 0.3699881867105542, 'support': 62050}, '1': {'precision': 0.4187394382916917, 'recall': 0.49450785063992614, 'f1-score': 0.45348054599765564, 'support': 60632}, '2': {'precision': 0.42450563170401, 'recall': 0.5235178225526067, 'f1-score': 0.4688412780784343, 'support': 60401}, 'accuracy': 0.43655609750768776, 'macro avg': {'precision': 0.44618491330513727, 'recall': 0.4377678916013788, 'f1-score': 0.430770003595548, 'support': 183083}, 'weighted avg': {'precision': 0.4465927437368504, 'recall': 0.43655609750768776, 'f1-score': 0.4302512056692061, 'support': 183083}}
[[18322 21633 22095]
 [ 9876 29983 20773]
 [ 8793 19987 31621]]
Evaluating performance on  val set...
214/214 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0113441
{'0': {'precision': 0.5370258425268248, 'recall': 0.3909240924092409, 'f1-score': 0.4524734194944928, 'support': 18180}, '1': {'precision': 0.5425621168118748, 'recall': 0.45734958111195734, 'f1-score': 0.4963249402249314, 'support': 18382}, '2': {'precision': 0.4559691417550627, 'recall': 0.6533827105903162, 'f1-score': 0.5371106617897631, 'support': 18092}, 'accuracy': 0.5001463753796611, 'macro avg': {'precision': 0.5118523670312541, 'recall': 0.5005521280371714, 'f1-score': 0.4953030071697291, 'support': 54654}, 'weighted avg': {'precision': 0.5120558488126423, 'recall': 0.5001463753796611, 'f1-score': 0.49523946848766714, 'support': 54654}}
[[ 7107  3699  7374]
 [ 3245  8407  6730]
 [ 2882  3389 11821]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0196788
{'0': {'precision': 0.5460391919497617, 'recall': 0.3551498449879435, 'f1-score': 0.4303774822589302, 'support': 20321}, '1': {'precision': 0.4125681266005647, 'recall': 0.45315542733501624, 'f1-score': 0.4319103595243005, 'support': 13865}, '2': {'precision': 0.4803113553113553, 'recall': 0.6150087942153606, 'f1-score': 0.5393778387179707, 'support': 20468}, 'accuracy': 0.4773301130749808, 'macro avg': {'precision': 0.4796395579538939, 'recall': 0.47443802217944014, 'f1-score': 0.4672218935004005, 'support': 54654}, 'weighted avg': {'precision': 0.487564173078654, 'recall': 0.4773301130749808, 'f1-score': 0.4715871400934529, 'support': 54654}}
[[ 7217  4509  8595]
 [ 2557  6283  5025]
 [ 3443  4437 12588]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0539906
{'0': {'precision': 0.5143599144515735, 'recall': 0.3364308553157474, 'f1-score': 0.40678989972212154, 'support': 20016}, '1': {'precision': 0.37415404447309053, 'recall': 0.4013690105787181, 'f1-score': 0.38728400827273335, 'support': 14463}, '2': {'precision': 0.45801819787307557, 'recall': 0.5913258983890954, 'f1-score': 0.5162044048288694, 'support': 20175}, 'accuracy': 0.4477073956160574, 'macro avg': {'precision': 0.4488440522659132, 'recall': 0.44304192142785365, 'f1-score': 0.4367594376079081, 'support': 54654}, 'weighted avg': {'precision': 0.4564594564893019, 'recall': 0.4477073956160574, 'f1-score': 0.44201740242084686, 'support': 54654}}
[[ 6734  4836  8446]
 [ 2987  5805  5671]
 [ 3371  4874 11930]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0873387
{'0': {'precision': 0.47279434368275436, 'recall': 0.3136535127969817, 'f1-score': 0.377122540305278, 'support': 19614}, '1': {'precision': 0.3281561876247505, 'recall': 0.34586812175399384, 'f1-score': 0.33677943859424514, 'support': 15211}, '2': {'precision': 0.42916829363529874, 'recall': 0.5542891724242272, 'f1-score': 0.48376944915160985, 'support': 19829}, 'accuracy': 0.40992425074102534, 'macro avg': {'precision': 0.4100396083142679, 'recall': 0.4046036023250676, 'f1-score': 0.39922380935037766, 'support': 54654}, 'weighted avg': {'precision': 0.4167114963488118, 'recall': 0.40992425074102534, 'f1-score': 0.40458700101057665, 'support': 54654}}
[[ 6152  5367  8095]
 [ 3426  5261  6524]
 [ 3434  5404 10991]]
training model: results/PCAR/W2/deepVOL_L3/seq2seq
Epoch 1/50
716/716 - 38s - loss: 12.8411 - accuracy10: 0.4283 - accuracy20: 0.4172 - accuracy30: 0.4049 - accuracy50: 0.3848 - val_loss: 13.1099 - val_accuracy10: 0.3977 - val_accuracy20: 0.4029 - val_accuracy30: 0.3771 - val_accuracy50: 0.3453 - 38s/epoch - 53ms/step
Epoch 2/50
716/716 - 33s - loss: 12.6915 - accuracy10: 0.4471 - accuracy20: 0.4378 - accuracy30: 0.4197 - accuracy50: 0.3945 - val_loss: 12.8154 - val_accuracy10: 0.4285 - val_accuracy20: 0.4382 - val_accuracy30: 0.4161 - val_accuracy50: 0.3870 - 33s/epoch - 46ms/step
Epoch 3/50
716/716 - 32s - loss: 12.3162 - accuracy10: 0.4898 - accuracy20: 0.4841 - accuracy30: 0.4636 - accuracy50: 0.4282 - val_loss: 12.7142 - val_accuracy10: 0.4278 - val_accuracy20: 0.4502 - val_accuracy30: 0.4308 - val_accuracy50: 0.4054 - 32s/epoch - 44ms/step
Epoch 4/50
716/716 - 32s - loss: 12.0855 - accuracy10: 0.5181 - accuracy20: 0.5055 - accuracy30: 0.4817 - accuracy50: 0.4406 - val_loss: 12.4979 - val_accuracy10: 0.4844 - val_accuracy20: 0.4788 - val_accuracy30: 0.4493 - val_accuracy50: 0.4103 - 32s/epoch - 45ms/step
Epoch 5/50
716/716 - 46s - loss: 11.9117 - accuracy10: 0.5328 - accuracy20: 0.5165 - accuracy30: 0.4915 - accuracy50: 0.4481 - val_loss: 12.5295 - val_accuracy10: 0.4873 - val_accuracy20: 0.4738 - val_accuracy30: 0.4417 - val_accuracy50: 0.4007 - 46s/epoch - 65ms/step
Epoch 6/50
716/716 - 48s - loss: 11.8063 - accuracy10: 0.5443 - accuracy20: 0.5252 - accuracy30: 0.4983 - accuracy50: 0.4542 - val_loss: 12.5647 - val_accuracy10: 0.4832 - val_accuracy20: 0.4728 - val_accuracy30: 0.4407 - val_accuracy50: 0.4030 - 48s/epoch - 67ms/step
Epoch 7/50
716/716 - 49s - loss: 11.7387 - accuracy10: 0.5503 - accuracy20: 0.5308 - accuracy30: 0.5035 - accuracy50: 0.4584 - val_loss: 12.5095 - val_accuracy10: 0.4922 - val_accuracy20: 0.4776 - val_accuracy30: 0.4466 - val_accuracy50: 0.4100 - 49s/epoch - 68ms/step
Epoch 8/50
716/716 - 48s - loss: 11.6914 - accuracy10: 0.5531 - accuracy20: 0.5328 - accuracy30: 0.5041 - accuracy50: 0.4593 - val_loss: 12.4462 - val_accuracy10: 0.4997 - val_accuracy20: 0.4864 - val_accuracy30: 0.4557 - val_accuracy50: 0.4152 - 48s/epoch - 67ms/step
Epoch 9/50
716/716 - 47s - loss: 11.6517 - accuracy10: 0.5554 - accuracy20: 0.5348 - accuracy30: 0.5058 - accuracy50: 0.4607 - val_loss: 12.4538 - val_accuracy10: 0.4972 - val_accuracy20: 0.4900 - val_accuracy30: 0.4616 - val_accuracy50: 0.4251 - 47s/epoch - 66ms/step
Epoch 10/50
716/716 - 47s - loss: 11.6188 - accuracy10: 0.5588 - accuracy20: 0.5372 - accuracy30: 0.5084 - accuracy50: 0.4626 - val_loss: 12.4648 - val_accuracy10: 0.4983 - val_accuracy20: 0.4893 - val_accuracy30: 0.4610 - val_accuracy50: 0.4233 - 47s/epoch - 65ms/step
Epoch 11/50
716/716 - 48s - loss: 11.5847 - accuracy10: 0.5609 - accuracy20: 0.5398 - accuracy30: 0.5096 - accuracy50: 0.4635 - val_loss: 12.4498 - val_accuracy10: 0.4941 - val_accuracy20: 0.4917 - val_accuracy30: 0.4642 - val_accuracy50: 0.4270 - 48s/epoch - 68ms/step
Epoch 12/50
716/716 - 48s - loss: 11.5541 - accuracy10: 0.5628 - accuracy20: 0.5411 - accuracy30: 0.5122 - accuracy50: 0.4656 - val_loss: 12.3873 - val_accuracy10: 0.4996 - val_accuracy20: 0.4951 - val_accuracy30: 0.4657 - val_accuracy50: 0.4296 - 48s/epoch - 67ms/step
Epoch 13/50
716/716 - 46s - loss: 11.5275 - accuracy10: 0.5649 - accuracy20: 0.5439 - accuracy30: 0.5142 - accuracy50: 0.4669 - val_loss: 12.3675 - val_accuracy10: 0.5024 - val_accuracy20: 0.4967 - val_accuracy30: 0.4664 - val_accuracy50: 0.4292 - 46s/epoch - 64ms/step
Epoch 14/50
716/716 - 32s - loss: 11.5134 - accuracy10: 0.5656 - accuracy20: 0.5435 - accuracy30: 0.5139 - accuracy50: 0.4674 - val_loss: 12.3750 - val_accuracy10: 0.4989 - val_accuracy20: 0.4949 - val_accuracy30: 0.4645 - val_accuracy50: 0.4293 - 32s/epoch - 45ms/step
Epoch 15/50
716/716 - 32s - loss: 11.4889 - accuracy10: 0.5671 - accuracy20: 0.5456 - accuracy30: 0.5155 - accuracy50: 0.4687 - val_loss: 12.3408 - val_accuracy10: 0.5007 - val_accuracy20: 0.4981 - val_accuracy30: 0.4684 - val_accuracy50: 0.4301 - 32s/epoch - 44ms/step
Epoch 16/50
716/716 - 32s - loss: 11.4703 - accuracy10: 0.5678 - accuracy20: 0.5464 - accuracy30: 0.5162 - accuracy50: 0.4700 - val_loss: 12.3306 - val_accuracy10: 0.5033 - val_accuracy20: 0.4970 - val_accuracy30: 0.4672 - val_accuracy50: 0.4300 - 32s/epoch - 45ms/step
Epoch 17/50
716/716 - 44s - loss: 11.4506 - accuracy10: 0.5713 - accuracy20: 0.5484 - accuracy30: 0.5186 - accuracy50: 0.4705 - val_loss: 12.3497 - val_accuracy10: 0.5003 - val_accuracy20: 0.4974 - val_accuracy30: 0.4669 - val_accuracy50: 0.4277 - 44s/epoch - 62ms/step
Epoch 18/50
716/716 - 47s - loss: 11.4353 - accuracy10: 0.5716 - accuracy20: 0.5494 - accuracy30: 0.5183 - accuracy50: 0.4713 - val_loss: 12.3248 - val_accuracy10: 0.5040 - val_accuracy20: 0.4997 - val_accuracy30: 0.4667 - val_accuracy50: 0.4292 - 47s/epoch - 66ms/step
Epoch 19/50
716/716 - 48s - loss: 11.4197 - accuracy10: 0.5719 - accuracy20: 0.5490 - accuracy30: 0.5192 - accuracy50: 0.4723 - val_loss: 12.3344 - val_accuracy10: 0.5029 - val_accuracy20: 0.4982 - val_accuracy30: 0.4684 - val_accuracy50: 0.4310 - 48s/epoch - 67ms/step
Epoch 20/50
716/716 - 47s - loss: 11.4028 - accuracy10: 0.5732 - accuracy20: 0.5502 - accuracy30: 0.5193 - accuracy50: 0.4725 - val_loss: 12.3841 - val_accuracy10: 0.5071 - val_accuracy20: 0.4975 - val_accuracy30: 0.4657 - val_accuracy50: 0.4264 - 47s/epoch - 66ms/step
Epoch 21/50
716/716 - 48s - loss: 11.3838 - accuracy10: 0.5736 - accuracy20: 0.5519 - accuracy30: 0.5222 - accuracy50: 0.4740 - val_loss: 12.3531 - val_accuracy10: 0.5022 - val_accuracy20: 0.4969 - val_accuracy30: 0.4676 - val_accuracy50: 0.4275 - 48s/epoch - 67ms/step
Epoch 22/50
716/716 - 47s - loss: 11.3706 - accuracy10: 0.5747 - accuracy20: 0.5526 - accuracy30: 0.5224 - accuracy50: 0.4755 - val_loss: 12.3514 - val_accuracy10: 0.5027 - val_accuracy20: 0.4985 - val_accuracy30: 0.4666 - val_accuracy50: 0.4286 - 47s/epoch - 66ms/step
Epoch 23/50
716/716 - 47s - loss: 11.3574 - accuracy10: 0.5758 - accuracy20: 0.5534 - accuracy30: 0.5233 - accuracy50: 0.4760 - val_loss: 12.3914 - val_accuracy10: 0.5028 - val_accuracy20: 0.4972 - val_accuracy30: 0.4674 - val_accuracy50: 0.4305 - 47s/epoch - 65ms/step
Epoch 24/50
716/716 - 48s - loss: 11.3432 - accuracy10: 0.5760 - accuracy20: 0.5544 - accuracy30: 0.5240 - accuracy50: 0.4758 - val_loss: 12.3815 - val_accuracy10: 0.5020 - val_accuracy20: 0.4992 - val_accuracy30: 0.4703 - val_accuracy50: 0.4325 - 48s/epoch - 66ms/step
Epoch 25/50
716/716 - 47s - loss: 11.3263 - accuracy10: 0.5774 - accuracy20: 0.5553 - accuracy30: 0.5249 - accuracy50: 0.4776 - val_loss: 12.3915 - val_accuracy10: 0.4994 - val_accuracy20: 0.4954 - val_accuracy30: 0.4661 - val_accuracy50: 0.4293 - 47s/epoch - 66ms/step
Epoch 26/50
716/716 - 41s - loss: 11.3118 - accuracy10: 0.5777 - accuracy20: 0.5565 - accuracy30: 0.5263 - accuracy50: 0.4799 - val_loss: 12.4072 - val_accuracy10: 0.5047 - val_accuracy20: 0.4971 - val_accuracy30: 0.4673 - val_accuracy50: 0.4295 - 41s/epoch - 58ms/step
Epoch 27/50
716/716 - 32s - loss: 11.2983 - accuracy10: 0.5781 - accuracy20: 0.5572 - accuracy30: 0.5265 - accuracy50: 0.4801 - val_loss: 12.4220 - val_accuracy10: 0.5058 - val_accuracy20: 0.4975 - val_accuracy30: 0.4653 - val_accuracy50: 0.4270 - 32s/epoch - 45ms/step
Epoch 28/50
716/716 - 32s - loss: 11.2864 - accuracy10: 0.5782 - accuracy20: 0.5581 - accuracy30: 0.5286 - accuracy50: 0.4812 - val_loss: 12.3980 - val_accuracy10: 0.5051 - val_accuracy20: 0.4961 - val_accuracy30: 0.4659 - val_accuracy50: 0.4262 - 32s/epoch - 45ms/step
testing model: results/PCAR/W2/deepVOL_L3/seq2seq
Evaluating performance on  test set...
1914/1914 - 40s - 40s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.99213785
{'0': {'precision': 0.4759372162407576, 'recall': 0.6025936656221053, 'f1-score': 0.5318285392906633, 'support': 152217}, '1': {'precision': 0.6548069836590511, 'recall': 0.42562634216177525, 'f1-score': 0.5159098569364308, 'support': 181610}, '2': {'precision': 0.4894360497245279, 'recall': 0.5617264177536325, 'f1-score': 0.523095463236676, 'support': 156092}, 'accuracy': 0.523972330119877, 'macro avg': {'precision': 0.5400600832081123, 'recall': 0.5299821418458377, 'f1-score': 0.5236112864879233, 'support': 489919}, 'weighted avg': {'precision': 0.5465439867007417, 'recall': 0.523972330119877, 'f1-score': 0.5231451544662921, 'support': 489919}}
[[91725 21100 39392]
 [52238 77298 52074]
 [48762 19649 87681]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.99253356
{'0': {'precision': 0.49358919928674533, 'recall': 0.5468196062061627, 'f1-score': 0.5188426898284898, 'support': 170089}, '1': {'precision': 0.5376390150281886, 'recall': 0.4392104710576048, 'f1-score': 0.4834658530571992, 'support': 142870}, '2': {'precision': 0.5135815297689598, 'recall': 0.5362567811934901, 'f1-score': 0.5246742763308849, 'support': 176960}, 'accuracy': 0.511623349982344, 'macro avg': {'precision': 0.5149365813612978, 'recall': 0.5074289528190858, 'f1-score': 0.5089942730721914, 'support': 489919}, 'weighted avg': {'precision': 0.5136562715519823, 'recall': 0.511623349982344, 'f1-score': 0.5106324936081953, 'support': 489919}}
[[93008 27730 49351]
 [39594 62750 40526]
 [55830 26234 94896]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0305096
{'0': {'precision': 0.46423730552600456, 'recall': 0.5135638885735962, 'f1-score': 0.4876564219506938, 'support': 167393}, '1': {'precision': 0.4900250231378329, 'recall': 0.38906465813448726, 'f1-score': 0.4337473688202833, 'support': 146973}, '2': {'precision': 0.4851527269633285, 'recall': 0.5196835143802726, 'f1-score': 0.5018248024620394, 'support': 175553}, 'accuracy': 0.47840765514299305, 'macro avg': {'precision': 0.4798050185423886, 'recall': 0.4741040203627853, 'f1-score': 0.47440953107767214, 'support': 489919}, 'weighted avg': {'precision': 0.4794681155173496, 'recall': 0.47840765514299305, 'f1-score': 0.4765609682903386, 'support': 489919}}
[[85967 30563 50863]
 [43838 57182 45953]
 [55374 28947 91232]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0656911
{'0': {'precision': 0.4311928580269169, 'recall': 0.475639001341517, 'f1-score': 0.4523267202375408, 'support': 168466}, '1': {'precision': 0.4018990826465182, 'recall': 0.3345201500324318, 'f1-score': 0.36512718695770946, 'support': 141836}, '2': {'precision': 0.4646268632647247, 'recall': 0.4812183701988119, 'f1-score': 0.4727770970988492, 'support': 179617}, 'accuracy': 0.43682935342372925, 'macro avg': {'precision': 0.43257293464605323, 'recall': 0.4304591738575869, 'f1-score': 0.43007700143136646, 'support': 489919}, 'weighted avg': {'precision': 0.4349698166546596, 'recall': 0.43682935342372925, 'f1-score': 0.434579301456925, 'support': 489919}}
[[80129 35854 52483]
 [47276 47447 47113]
 [58426 34756 86435]]
Evaluating performance on  train set...
716/716 - 16s - 16s/epoch - 23ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.93954396
{'0': {'precision': 0.48189568930763144, 'recall': 0.6111458274157814, 'f1-score': 0.538878963450268, 'support': 52809}, '1': {'precision': 0.719549560304007, 'recall': 0.4732592679830932, 'f1-score': 0.570977494651921, 'support': 76419}, '2': {'precision': 0.47526120762969265, 'recall': 0.5810973911428837, 'f1-score': 0.5228774550345439, 'support': 53855}, 'accuracy': 0.5447529262684138, 'macro avg': {'precision': 0.558902152413777, 'recall': 0.5551674955139195, 'f1-score': 0.5442446377122443, 'support': 183083}, 'weighted avg': {'precision': 0.579141043365117, 'recall': 0.5447529262684138, 'f1-score': 0.5475699747411595, 'support': 183083}}
[[32274  7166 13369]
 [19069 36166 21184]
 [15630  6930 31295]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.94612265
{'0': {'precision': 0.5149868322905725, 'recall': 0.5567532873623752, 'f1-score': 0.5350562259794075, 'support': 60763}, '1': {'precision': 0.6057653836920861, 'recall': 0.49813288588395926, 'f1-score': 0.546701932711664, 'support': 60789}, '2': {'precision': 0.5002670464660851, 'recall': 0.548016446994198, 'f1-score': 0.5230542521425524, 'support': 61531}, 'accuracy': 0.5343532714670396, 'macro avg': {'precision': 0.5403397541495812, 'recall': 0.5343008734135108, 'f1-score': 0.5349374702778746, 'support': 183083}, 'weighted avg': {'precision': 0.5401809476348703, 'recall': 0.5343532714670396, 'f1-score': 0.5348892930276403, 'support': 183083}}
[[33830  9801 17132]
 [13956 30281 16552]
 [17905  9906 33720]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9846187
{'0': {'precision': 0.4993184845574796, 'recall': 0.5188553218200255, 'f1-score': 0.508899465637407, 'support': 62131}, '1': {'precision': 0.5491719973695224, 'recall': 0.46549889359977026, 'f1-score': 0.5038854656159149, 'support': 59201}, '2': {'precision': 0.47635352648522095, 'recall': 0.5271817460445984, 'f1-score': 0.5004804329277198, 'support': 61751}, 'accuracy': 0.5044105678845114, 'macro avg': {'precision': 0.5082813361374077, 'recall': 0.5038453204881314, 'f1-score': 0.5044217880603473, 'support': 183083}, 'weighted avg': {'precision': 0.5076932035978367, 'recall': 0.5044105678845114, 'f1-score': 0.5044385517124208, 'support': 183083}}
[[32237 11306 18588]
 [14445 27558 17198]
 [17880 11317 32554]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0383991
{'0': {'precision': 0.4606419416332161, 'recall': 0.4790008058017728, 'f1-score': 0.46964202476041494, 'support': 62050}, '1': {'precision': 0.48121285580231465, 'recall': 0.4059737432378942, 'f1-score': 0.44040291991698277, 'support': 60632}, '2': {'precision': 0.4366247329693805, 'recall': 0.48727670071687557, 'f1-score': 0.4605622452252971, 'support': 60401}, 'accuracy': 0.4575465772354615, 'macro avg': {'precision': 0.45949317680163704, 'recall': 0.45741708325218083, 'f1-score': 0.45686906330089827, 'support': 183083}, 'weighted avg': {'precision': 0.45953092776189236, 'recall': 0.4575465772354615, 'f1-score': 0.4569633316618333, 'support': 183083}}
[[29722 13538 18790]
 [16831 24615 19186]
 [17970 12999 29432]]
Evaluating performance on  val set...
214/214 - 7s - 7s/epoch - 31ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0105762
{'0': {'precision': 0.47498793630368347, 'recall': 0.6497249724972497, 'f1-score': 0.5487827541349192, 'support': 18180}, '1': {'precision': 0.6222452146921883, 'recall': 0.32716788162332716, 'f1-score': 0.4288515705779585, 'support': 18382}, '2': {'precision': 0.4805427165647831, 'recall': 0.5344351094406368, 'f1-score': 0.5060581477507654, 'support': 18092}, 'accuracy': 0.5030738829728839, 'macro avg': {'precision': 0.525925289186885, 'recall': 0.5037759878537379, 'f1-score': 0.49456415748788096, 'support': 54654}, 'weighted avg': {'precision': 0.5263543573491936, 'recall': 0.5030738829728839, 'f1-score': 0.49430277838115616, 'support': 54654}}
[[11812  1764  4604]
 [ 6520  6014  5848]
 [ 6536  1887  9669]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9980272
{'0': {'precision': 0.4948483231394442, 'recall': 0.59322867969096, 'f1-score': 0.5395908867105322, 'support': 20321}, '1': {'precision': 0.492477219749947, 'recall': 0.3352326000721241, 'f1-score': 0.39891859417242415, 'support': 13865}, '2': {'precision': 0.4999280748022057, 'recall': 0.5093804963846004, 'f1-score': 0.5046100234736103, 'support': 20468}, 'accuracy': 0.49637720935338675, 'macro avg': {'precision': 0.49575120589719895, 'recall': 0.4792805920492282, 'f1-score': 0.4810398347855222, 'support': 54654}, 'weighted avg': {'precision': 0.4961491795916348, 'recall': 0.49637720935338675, 'f1-score': 0.49080379619978853, 'support': 54654}}
[[12055  2264  6002]
 [ 4790  4648  4427]
 [ 7516  2526 10426]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0365332
{'0': {'precision': 0.47004279600570614, 'recall': 0.5597022382094324, 'f1-score': 0.5109692132269099, 'support': 20016}, '1': {'precision': 0.4374074857263692, 'recall': 0.2860402406139805, 'f1-score': 0.34588854980979056, 'support': 14463}, '2': {'precision': 0.4742065349686359, 'recall': 0.5021065675340768, 'f1-score': 0.48775790259286894, 'support': 20175}, 'accuracy': 0.46602261499615766, 'macro avg': {'precision': 0.4605522722335704, 'recall': 0.44928301545249655, 'f1-score': 0.4482052218765231, 'support': 54654}, 'weighted avg': {'precision': 0.46294357071582903, 'recall': 0.46602261499615766, 'f1-score': 0.4587159503908216, 'support': 54654}}
[[11203  2549  6264]
 [ 5358  4137  4968]
 [ 7273  2772 10130]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0722791
{'0': {'precision': 0.4377347343545597, 'recall': 0.5288569389211788, 'f1-score': 0.4790007157535038, 'support': 19614}, '1': {'precision': 0.3722859483818107, 'recall': 0.2389717967260535, 'f1-score': 0.2910910910910911, 'support': 15211}, '2': {'precision': 0.44684565658472136, 'recall': 0.47758333753593224, 'f1-score': 0.4617034761835113, 'support': 19829}, 'accuracy': 0.42957514546053355, 'macro avg': {'precision': 0.4189554464403639, 'recall': 0.41513735772772153, 'f1-score': 0.41059842767603544, 'support': 54654}, 'weighted avg': {'precision': 0.42282491976588166, 'recall': 0.42957514546053355, 'f1-score': 0.4204271389947425, 'support': 54654}}
[[10373  2989  6252]
 [ 6105  3635  5471]
 [ 7219  3140  9470]]
training model: results/PCAR/W3/deepLOB_L1/seq2seq
Epoch 1/50
878/878 - 52s - loss: 12.8899 - accuracy10: 0.4287 - accuracy20: 0.4163 - accuracy30: 0.4065 - accuracy50: 0.3966 - val_loss: 12.9074 - val_accuracy10: 0.4125 - val_accuracy20: 0.4007 - val_accuracy30: 0.3942 - val_accuracy50: 0.4031 - 52s/epoch - 59ms/step
Epoch 2/50
878/878 - 43s - loss: 12.7613 - accuracy10: 0.4544 - accuracy20: 0.4352 - accuracy30: 0.4212 - accuracy50: 0.4031 - val_loss: 12.7947 - val_accuracy10: 0.4379 - val_accuracy20: 0.4227 - val_accuracy30: 0.4120 - val_accuracy50: 0.4082 - 43s/epoch - 48ms/step
Epoch 3/50
878/878 - 42s - loss: 12.6832 - accuracy10: 0.4662 - accuracy20: 0.4433 - accuracy30: 0.4258 - accuracy50: 0.4051 - val_loss: 12.8065 - val_accuracy10: 0.4404 - val_accuracy20: 0.4208 - val_accuracy30: 0.4088 - val_accuracy50: 0.4025 - 42s/epoch - 48ms/step
Epoch 4/50
878/878 - 42s - loss: 12.6180 - accuracy10: 0.4739 - accuracy20: 0.4491 - accuracy30: 0.4318 - accuracy50: 0.4110 - val_loss: 12.8514 - val_accuracy10: 0.4349 - val_accuracy20: 0.4141 - val_accuracy30: 0.4018 - val_accuracy50: 0.3975 - 42s/epoch - 48ms/step
Epoch 5/50
878/878 - 42s - loss: 12.5775 - accuracy10: 0.4792 - accuracy20: 0.4528 - accuracy30: 0.4354 - accuracy50: 0.4145 - val_loss: 12.8738 - val_accuracy10: 0.4399 - val_accuracy20: 0.4172 - val_accuracy30: 0.4037 - val_accuracy50: 0.3930 - 42s/epoch - 48ms/step
Epoch 6/50
878/878 - 43s - loss: 12.5454 - accuracy10: 0.4832 - accuracy20: 0.4563 - accuracy30: 0.4385 - accuracy50: 0.4171 - val_loss: 12.9054 - val_accuracy10: 0.4351 - val_accuracy20: 0.4130 - val_accuracy30: 0.4010 - val_accuracy50: 0.3909 - 43s/epoch - 49ms/step
Epoch 7/50
878/878 - 42s - loss: 12.5239 - accuracy10: 0.4845 - accuracy20: 0.4578 - accuracy30: 0.4401 - accuracy50: 0.4185 - val_loss: 12.8534 - val_accuracy10: 0.4419 - val_accuracy20: 0.4164 - val_accuracy30: 0.4033 - val_accuracy50: 0.3879 - 42s/epoch - 48ms/step
Epoch 8/50
878/878 - 39s - loss: 12.5004 - accuracy10: 0.4876 - accuracy20: 0.4604 - accuracy30: 0.4415 - accuracy50: 0.4202 - val_loss: 12.8563 - val_accuracy10: 0.4414 - val_accuracy20: 0.4171 - val_accuracy30: 0.4038 - val_accuracy50: 0.3905 - 39s/epoch - 44ms/step
Epoch 9/50
878/878 - 26s - loss: 12.4798 - accuracy10: 0.4902 - accuracy20: 0.4627 - accuracy30: 0.4435 - accuracy50: 0.4215 - val_loss: 12.9073 - val_accuracy10: 0.4349 - val_accuracy20: 0.4108 - val_accuracy30: 0.3986 - val_accuracy50: 0.3836 - 26s/epoch - 29ms/step
Epoch 10/50
878/878 - 25s - loss: 12.4622 - accuracy10: 0.4916 - accuracy20: 0.4643 - accuracy30: 0.4446 - accuracy50: 0.4230 - val_loss: 12.8940 - val_accuracy10: 0.4430 - val_accuracy20: 0.4184 - val_accuracy30: 0.4036 - val_accuracy50: 0.3876 - 25s/epoch - 28ms/step
Epoch 11/50
878/878 - 25s - loss: 12.4451 - accuracy10: 0.4939 - accuracy20: 0.4657 - accuracy30: 0.4461 - accuracy50: 0.4243 - val_loss: 12.9454 - val_accuracy10: 0.4362 - val_accuracy20: 0.4120 - val_accuracy30: 0.4001 - val_accuracy50: 0.3822 - 25s/epoch - 29ms/step
Epoch 12/50
878/878 - 24s - loss: 12.4299 - accuracy10: 0.4952 - accuracy20: 0.4676 - accuracy30: 0.4475 - accuracy50: 0.4257 - val_loss: 12.9375 - val_accuracy10: 0.4375 - val_accuracy20: 0.4159 - val_accuracy30: 0.4029 - val_accuracy50: 0.3883 - 24s/epoch - 28ms/step
testing model: results/PCAR/W3/deepLOB_L1/seq2seq
Evaluating performance on  test set...
2282/2282 - 45s - 45s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.064745
{'0': {'precision': 0.42100841799204336, 'recall': 0.5155339754078702, 'f1-score': 0.46350094760726174, 'support': 187621}, '1': {'precision': 0.39986099849415035, 'recall': 0.14995511193057312, 'f1-score': 0.21811365527118534, 'support': 207182}, '2': {'precision': 0.4116657988371084, 'recall': 0.6017537739439299, 'f1-score': 0.4888823044419251, 'support': 189192}, 'accuracy': 0.4137706658447418, 'macro avg': {'precision': 0.4108450717744341, 'recall': 0.4224142870941244, 'f1-score': 0.39016563577345736, 'support': 583995}, 'weighted avg': {'precision': 0.41047936642555233, 'recall': 0.4137706658447418, 'f1-score': 0.38466828578907947, 'support': 583995}}
[[ 96725  29502  61394]
 [ 74803  31068 101311]
 [ 58218  17127 113847]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0732386
{'0': {'precision': 0.4100681674867324, 'recall': 0.46722291563965135, 'f1-score': 0.43678375059138447, 'support': 190682}, '1': {'precision': 0.3663668715626011, 'recall': 0.14234716195628674, 'f1-score': 0.20503182914376344, 'support': 198887}, '2': {'precision': 0.40767149978753614, 'recall': 0.6069404297779104, 'f1-score': 0.4877378396195806, 'support': 194426}, 'accuracy': 0.4030976292605245, 'macro avg': {'precision': 0.39470217961228987, 'recall': 0.40550350245794947, 'f1-score': 0.3765178064515762, 'support': 583995}, 'weighted avg': {'precision': 0.3943872213201614, 'recall': 0.4030976292605245, 'f1-score': 0.3748214997372557, 'support': 583995}}
[[ 89091  30480  71111]
 [ 70231  28311 100345]
 [ 57937  18484 118005]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.078643
{'0': {'precision': 0.4084947223034348, 'recall': 0.41607878171754825, 'f1-score': 0.4122518746121054, 'support': 194766}, '1': {'precision': 0.34628358173249446, 'recall': 0.15192543845838974, 'f1-score': 0.2111936269860955, 'support': 190554}, '2': {'precision': 0.4041111085357818, 'recall': 0.6142997357493394, 'f1-score': 0.48751512924267904, 'support': 198675}, 'accuracy': 0.39732189487923697, 'macro avg': {'precision': 0.386296470857237, 'recall': 0.39410131864175907, 'f1-score': 0.3703202102802933, 'support': 583995}, 'weighted avg': {'precision': 0.38670430261552063, 'recall': 0.39732189487923697, 'f1-score': 0.3722523434442059, 'support': 583995}}
[[ 81038  33274  80454]
 [ 62093  28950  99511]
 [ 55251  21378 122046]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0854297
{'0': {'precision': 0.4249336326037667, 'recall': 0.35145284325689435, 'f1-score': 0.38471595788301005, 'support': 212239}, '1': {'precision': 0.28440964079465275, 'recall': 0.1749347092576236, 'f1-score': 0.21662666719124996, 'support': 157373}, '2': {'precision': 0.41966245267278446, 'recall': 0.6100856877644216, 'f1-score': 0.4972673336590355, 'support': 214383}, 'accuracy': 0.39882875709552307, 'macro avg': {'precision': 0.37633524202373464, 'recall': 0.3788244134263132, 'f1-score': 0.3662033195777652, 'support': 583995}, 'weighted avg': {'precision': 0.3851306659172036, 'recall': 0.39882875709552307, 'f1-score': 0.38073713212073007, 'support': 583995}}
[[ 74592  40458  97189]
 [ 46164  27530  83679]
 [ 54782  28809 130792]]
Evaluating performance on  train set...
878/878 - 20s - 20s/epoch - 23ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.056452
{'0': {'precision': 0.44977294033139753, 'recall': 0.49695983211816297, 'f1-score': 0.4721904457581083, 'support': 74338}, '1': {'precision': 0.43859471242807535, 'recall': 0.23315007949982483, 'f1-score': 0.3044560770685787, 'support': 74214}, '2': {'precision': 0.43011972274732196, 'recall': 0.5823391214185403, 'f1-score': 0.4947866135849141, 'support': 76191}, 'accuracy': 0.4387900846744949, 'macro avg': {'precision': 0.4394957918355982, 'recall': 0.43748301101217607, 'f1-score': 0.4238110454705337, 'support': 224743}, 'weighted avg': {'precision': 0.43941898356048387, 'recall': 0.4387900846744949, 'f1-score': 0.4244620901918278, 'support': 224743}}
[[36943 12858 24537]
 [22662 17303 34249]
 [22532  9290 44369]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0686631
{'0': {'precision': 0.43171417830150766, 'recall': 0.4480411150575826, 'f1-score': 0.4397261449688711, 'support': 74328}, '1': {'precision': 0.4085683403753562, 'recall': 0.22442315476993657, 'f1-score': 0.28971067254263266, 'support': 74110}, '2': {'precision': 0.41544117647058826, 'recall': 0.5819933162964419, 'f1-score': 0.48481176412792504, 'support': 76305}, 'accuracy': 0.419781706215544, 'macro avg': {'precision': 0.41857456504915075, 'recall': 0.418152528707987, 'f1-score': 0.40474952721314295, 'support': 224743}, 'weighted avg': {'precision': 0.4185567075308256, 'recall': 0.419781706215544, 'f1-score': 0.40556539917666884, 'support': 224743}}
[[33302 13890 27136]
 [22127 16632 35351]
 [21710 10186 44409]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0759052
{'0': {'precision': 0.4229679794102, 'recall': 0.39524634877127923, 'f1-score': 0.40863755070289487, 'support': 74427}, '1': {'precision': 0.3894809905512516, 'recall': 0.23488029814067163, 'f1-score': 0.2930399845014783, 'support': 74059}, '2': {'precision': 0.40394636847247856, 'recall': 0.5855069042841968, 'f1-score': 0.4780688370300178, 'support': 76257}, 'accuracy': 0.40695816999862067, 'macro avg': {'precision': 0.40546511281131004, 'recall': 0.4052111837320493, 'f1-score': 0.393248790744797, 'support': 224743}, 'weighted avg': {'precision': 0.4054789190471067, 'recall': 0.40695816999862067, 'f1-score': 0.39410353383089747, 'support': 224743}}
[[29417 15623 29387]
 [20168 17395 36496]
 [19964 11644 44649]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0841537
{'0': {'precision': 0.4052556724217768, 'recall': 0.32856012764302855, 'f1-score': 0.36289994150358007, 'support': 74583}, '1': {'precision': 0.3845821382263958, 'recall': 0.2638772814277627, 'f1-score': 0.31299565106165267, 'support': 74186}, '2': {'precision': 0.39023400633307753, 'recall': 0.5823307973780504, 'f1-score': 0.46731133844211953, 'support': 75974}, 'accuracy': 0.39299555492273397, 'macro avg': {'precision': 0.39335727232708334, 'recall': 0.39158940214961385, 'f1-score': 0.38106897700245074, 'support': 224743}, 'weighted avg': {'precision': 0.3933534424647086, 'recall': 0.39299555492273397, 'f1-score': 0.3817230050930301, 'support': 224743}}
[[24505 17737 32341]
 [17820 19576 36790]
 [18143 13589 44242]]
Evaluating performance on  val set...
303/303 - 7s - 7s/epoch - 23ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0523988
{'0': {'precision': 0.4426743100919877, 'recall': 0.5317266503863245, 'f1-score': 0.48313114962806686, 'support': 24979}, '1': {'precision': 0.4279326486410955, 'recall': 0.22673428592581624, 'f1-score': 0.2964163863817843, 'support': 27014}, '2': {'precision': 0.43416036308623296, 'recall': 0.5655001182312603, 'f1-score': 0.49120224565247156, 'support': 25374}, 'accuracy': 0.4363100546744736, 'macro avg': {'precision': 0.4349224406064387, 'recall': 0.441320351514467, 'f1-score': 0.4235832605541076, 'support': 77367}, 'weighted avg': {'precision': 0.4347346958668217, 'recall': 0.4363100546744736, 'f1-score': 0.4205835954536536, 'support': 77367}}
[[13282  4672  7025]
 [ 9213  6125 11676]
 [ 7509  3516 14349]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0638679
{'0': {'precision': 0.43140589569161, 'recall': 0.48304042527869245, 'f1-score': 0.4557653796485187, 'support': 25207}, '1': {'precision': 0.4060028391806936, 'recall': 0.22659875495189588, 'f1-score': 0.2908615429318611, 'support': 26505}, '2': {'precision': 0.4225909752547307, 'recall': 0.5658156304813876, 'f1-score': 0.48382634780434963, 'support': 25655}, 'accuracy': 0.4226349735675417, 'macro avg': {'precision': 0.4199999033756781, 'recall': 0.4251516035706587, 'f1-score': 0.4101510901282432, 'support': 77367}, 'weighted avg': {'precision': 0.4197800759411999, 'recall': 0.4226349735675417, 'f1-score': 0.4085763707152892, 'support': 77367}}
[[12176  4982  8049]
 [ 8714  6006 11785]
 [ 7334  3805 14516]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0701003
{'0': {'precision': 0.42243027111371173, 'recall': 0.42849794238683125, 'f1-score': 0.4254424735301629, 'support': 25272}, '1': {'precision': 0.3986188017171654, 'recall': 0.24224894131881428, 'f1-score': 0.30135697655276217, 'support': 26448}, '2': {'precision': 0.41355618497434027, 'recall': 0.5749990252271221, 'f1-score': 0.4810948357420155, 'support': 25647}, 'accuracy': 0.41339330722401024, 'macro avg': {'precision': 0.41153508593507243, 'recall': 0.4152486363109225, 'f1-score': 0.4026314286083135, 'support': 77367}, 'weighted avg': {'precision': 0.41134855113211344, 'recall': 0.41339330722401024, 'f1-score': 0.40147234297823625, 'support': 77367}}
[[10829  5481  8962]
 [ 8091  6407 11950]
 [ 6715  4185 14747]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0759869
{'0': {'precision': 0.42322279061562884, 'recall': 0.37663357011106313, 'f1-score': 0.39857133957680085, 'support': 25481}, '1': {'precision': 0.4118692055737523, 'recall': 0.28275783215184086, 'f1-score': 0.335314456170482, 'support': 26238}, '2': {'precision': 0.4006216260428595, 'recall': 0.5729101684341859, 'f1-score': 0.47152071366684845, 'support': 25648}, 'accuracy': 0.4098646709837528, 'macro avg': {'precision': 0.4119045407440802, 'recall': 0.41076719023236324, 'f1-score': 0.40180216980471045, 'support': 77367}, 'weighted avg': {'precision': 0.4118798403488336, 'recall': 0.4098646709837528, 'f1-score': 0.40130210902432434, 'support': 77367}}
[[ 9597  5926  9958]
 [ 6793  7419 12026]
 [ 6286  4668 14694]]
training model: results/PCAR/W3/deepOF_L1/seq2seq
Epoch 1/50
878/878 - 54s - loss: 13.0562 - accuracy10: 0.4062 - accuracy20: 0.3979 - accuracy30: 0.3930 - accuracy50: 0.3842 - val_loss: 12.9886 - val_accuracy10: 0.4061 - val_accuracy20: 0.3926 - val_accuracy30: 0.3848 - val_accuracy50: 0.3743 - 54s/epoch - 61ms/step
Epoch 2/50
878/878 - 41s - loss: 12.9875 - accuracy10: 0.4139 - accuracy20: 0.4048 - accuracy30: 0.3983 - accuracy50: 0.3861 - val_loss: 12.9447 - val_accuracy10: 0.4198 - val_accuracy20: 0.4090 - val_accuracy30: 0.3985 - val_accuracy50: 0.3861 - 41s/epoch - 47ms/step
Epoch 3/50
878/878 - 41s - loss: 12.9708 - accuracy10: 0.4153 - accuracy20: 0.4054 - accuracy30: 0.3980 - accuracy50: 0.3838 - val_loss: 12.9302 - val_accuracy10: 0.4220 - val_accuracy20: 0.4098 - val_accuracy30: 0.4027 - val_accuracy50: 0.3878 - 41s/epoch - 46ms/step
Epoch 4/50
878/878 - 41s - loss: 12.9566 - accuracy10: 0.4159 - accuracy20: 0.4073 - accuracy30: 0.3999 - accuracy50: 0.3840 - val_loss: 12.9208 - val_accuracy10: 0.4228 - val_accuracy20: 0.4109 - val_accuracy30: 0.4016 - val_accuracy50: 0.3892 - 41s/epoch - 46ms/step
Epoch 5/50
878/878 - 41s - loss: 12.9456 - accuracy10: 0.4173 - accuracy20: 0.4074 - accuracy30: 0.4014 - accuracy50: 0.3861 - val_loss: 12.9116 - val_accuracy10: 0.4230 - val_accuracy20: 0.4135 - val_accuracy30: 0.4026 - val_accuracy50: 0.3909 - 41s/epoch - 46ms/step
Epoch 6/50
878/878 - 39s - loss: 12.9367 - accuracy10: 0.4182 - accuracy20: 0.4084 - accuracy30: 0.4020 - accuracy50: 0.3873 - val_loss: 12.9090 - val_accuracy10: 0.4222 - val_accuracy20: 0.4119 - val_accuracy30: 0.4033 - val_accuracy50: 0.3914 - 39s/epoch - 44ms/step
Epoch 7/50
878/878 - 23s - loss: 12.9261 - accuracy10: 0.4201 - accuracy20: 0.4100 - accuracy30: 0.4030 - accuracy50: 0.3880 - val_loss: 12.9042 - val_accuracy10: 0.4254 - val_accuracy20: 0.4125 - val_accuracy30: 0.4040 - val_accuracy50: 0.3920 - 23s/epoch - 27ms/step
Epoch 8/50
878/878 - 23s - loss: 12.9198 - accuracy10: 0.4202 - accuracy20: 0.4112 - accuracy30: 0.4044 - accuracy50: 0.3881 - val_loss: 12.8975 - val_accuracy10: 0.4246 - val_accuracy20: 0.4138 - val_accuracy30: 0.4057 - val_accuracy50: 0.3918 - 23s/epoch - 26ms/step
Epoch 9/50
878/878 - 23s - loss: 12.9107 - accuracy10: 0.4217 - accuracy20: 0.4119 - accuracy30: 0.4053 - accuracy50: 0.3895 - val_loss: 12.8961 - val_accuracy10: 0.4241 - val_accuracy20: 0.4135 - val_accuracy30: 0.4051 - val_accuracy50: 0.3936 - 23s/epoch - 26ms/step
Epoch 10/50
878/878 - 23s - loss: 12.9028 - accuracy10: 0.4234 - accuracy20: 0.4133 - accuracy30: 0.4059 - accuracy50: 0.3903 - val_loss: 12.8922 - val_accuracy10: 0.4245 - val_accuracy20: 0.4139 - val_accuracy30: 0.4051 - val_accuracy50: 0.3931 - 23s/epoch - 26ms/step
Epoch 11/50
878/878 - 23s - loss: 12.8948 - accuracy10: 0.4238 - accuracy20: 0.4148 - accuracy30: 0.4081 - accuracy50: 0.3913 - val_loss: 12.8900 - val_accuracy10: 0.4245 - val_accuracy20: 0.4135 - val_accuracy30: 0.4063 - val_accuracy50: 0.3945 - 23s/epoch - 26ms/step
Epoch 12/50
878/878 - 23s - loss: 12.8863 - accuracy10: 0.4249 - accuracy20: 0.4157 - accuracy30: 0.4084 - accuracy50: 0.3925 - val_loss: 12.8890 - val_accuracy10: 0.4256 - val_accuracy20: 0.4131 - val_accuracy30: 0.4055 - val_accuracy50: 0.3930 - 23s/epoch - 26ms/step
Epoch 13/50
878/878 - 23s - loss: 12.8784 - accuracy10: 0.4262 - accuracy20: 0.4165 - accuracy30: 0.4098 - accuracy50: 0.3934 - val_loss: 12.8889 - val_accuracy10: 0.4240 - val_accuracy20: 0.4130 - val_accuracy30: 0.4052 - val_accuracy50: 0.3948 - 23s/epoch - 26ms/step
Epoch 14/50
878/878 - 23s - loss: 12.8700 - accuracy10: 0.4266 - accuracy20: 0.4170 - accuracy30: 0.4104 - accuracy50: 0.3942 - val_loss: 12.8891 - val_accuracy10: 0.4246 - val_accuracy20: 0.4126 - val_accuracy30: 0.4066 - val_accuracy50: 0.3943 - 23s/epoch - 26ms/step
Epoch 15/50
878/878 - 23s - loss: 12.8629 - accuracy10: 0.4267 - accuracy20: 0.4168 - accuracy30: 0.4111 - accuracy50: 0.3958 - val_loss: 12.8924 - val_accuracy10: 0.4237 - val_accuracy20: 0.4128 - val_accuracy30: 0.4054 - val_accuracy50: 0.3943 - 23s/epoch - 26ms/step
Epoch 16/50
878/878 - 23s - loss: 12.8545 - accuracy10: 0.4286 - accuracy20: 0.4185 - accuracy30: 0.4116 - accuracy50: 0.3959 - val_loss: 12.8899 - val_accuracy10: 0.4235 - val_accuracy20: 0.4128 - val_accuracy30: 0.4071 - val_accuracy50: 0.3936 - 23s/epoch - 26ms/step
Epoch 17/50
878/878 - 24s - loss: 12.8488 - accuracy10: 0.4304 - accuracy20: 0.4205 - accuracy30: 0.4130 - accuracy50: 0.3969 - val_loss: 12.8833 - val_accuracy10: 0.4238 - val_accuracy20: 0.4121 - val_accuracy30: 0.4061 - val_accuracy50: 0.3941 - 24s/epoch - 27ms/step
Epoch 18/50
878/878 - 23s - loss: 12.8428 - accuracy10: 0.4304 - accuracy20: 0.4206 - accuracy30: 0.4132 - accuracy50: 0.3973 - val_loss: 12.8881 - val_accuracy10: 0.4232 - val_accuracy20: 0.4126 - val_accuracy30: 0.4055 - val_accuracy50: 0.3953 - 23s/epoch - 26ms/step
Epoch 19/50
878/878 - 23s - loss: 12.8301 - accuracy10: 0.4323 - accuracy20: 0.4213 - accuracy30: 0.4143 - accuracy50: 0.3983 - val_loss: 12.8911 - val_accuracy10: 0.4262 - val_accuracy20: 0.4123 - val_accuracy30: 0.4063 - val_accuracy50: 0.3959 - 23s/epoch - 26ms/step
Epoch 20/50
878/878 - 23s - loss: 12.8249 - accuracy10: 0.4325 - accuracy20: 0.4220 - accuracy30: 0.4148 - accuracy50: 0.3993 - val_loss: 12.8905 - val_accuracy10: 0.4239 - val_accuracy20: 0.4133 - val_accuracy30: 0.4062 - val_accuracy50: 0.3941 - 23s/epoch - 26ms/step
Epoch 21/50
878/878 - 24s - loss: 12.8177 - accuracy10: 0.4335 - accuracy20: 0.4231 - accuracy30: 0.4158 - accuracy50: 0.3998 - val_loss: 12.8945 - val_accuracy10: 0.4230 - val_accuracy20: 0.4129 - val_accuracy30: 0.4063 - val_accuracy50: 0.3941 - 24s/epoch - 27ms/step
Epoch 22/50
878/878 - 24s - loss: 12.8075 - accuracy10: 0.4346 - accuracy20: 0.4227 - accuracy30: 0.4165 - accuracy50: 0.4013 - val_loss: 12.9039 - val_accuracy10: 0.4240 - val_accuracy20: 0.4113 - val_accuracy30: 0.4059 - val_accuracy50: 0.3930 - 24s/epoch - 27ms/step
Epoch 23/50
878/878 - 24s - loss: 12.8038 - accuracy10: 0.4353 - accuracy20: 0.4247 - accuracy30: 0.4171 - accuracy50: 0.4018 - val_loss: 12.8947 - val_accuracy10: 0.4231 - val_accuracy20: 0.4130 - val_accuracy30: 0.4070 - val_accuracy50: 0.3944 - 24s/epoch - 27ms/step
Epoch 24/50
878/878 - 24s - loss: 12.7901 - accuracy10: 0.4372 - accuracy20: 0.4263 - accuracy30: 0.4192 - accuracy50: 0.4028 - val_loss: 12.9093 - val_accuracy10: 0.4212 - val_accuracy20: 0.4103 - val_accuracy30: 0.4027 - val_accuracy50: 0.3940 - 24s/epoch - 27ms/step
Epoch 25/50
878/878 - 24s - loss: 12.7812 - accuracy10: 0.4380 - accuracy20: 0.4286 - accuracy30: 0.4212 - accuracy50: 0.4053 - val_loss: 12.9117 - val_accuracy10: 0.4220 - val_accuracy20: 0.4103 - val_accuracy30: 0.4034 - val_accuracy50: 0.3930 - 24s/epoch - 28ms/step
Epoch 26/50
878/878 - 25s - loss: 12.7755 - accuracy10: 0.4383 - accuracy20: 0.4289 - accuracy30: 0.4220 - accuracy50: 0.4063 - val_loss: 12.9089 - val_accuracy10: 0.4209 - val_accuracy20: 0.4082 - val_accuracy30: 0.4022 - val_accuracy50: 0.3935 - 25s/epoch - 28ms/step
Epoch 27/50
878/878 - 24s - loss: 12.7614 - accuracy10: 0.4402 - accuracy20: 0.4298 - accuracy30: 0.4232 - accuracy50: 0.4074 - val_loss: 12.9182 - val_accuracy10: 0.4211 - val_accuracy20: 0.4096 - val_accuracy30: 0.4025 - val_accuracy50: 0.3931 - 24s/epoch - 27ms/step
testing model: results/PCAR/W3/deepOF_L1/seq2seq
Evaluating performance on  test set...
2282/2282 - 29s - 29s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.074801
{'0': {'precision': 0.44030704117979524, 'recall': 0.35709412642575417, 'f1-score': 0.3943587358953682, 'support': 187620}, '1': {'precision': 0.38024320161146985, 'recall': 0.49565355896534913, 'f1-score': 0.43034500099529593, 'support': 207181}, '2': {'precision': 0.4291966741878651, 'recall': 0.36698028437020985, 'f1-score': 0.39565756293541915, 'support': 189190}, 'accuracy': 0.4094532278750871, 'macro avg': {'precision': 0.41658230565971005, 'recall': 0.40657598992043775, 'f1-score': 0.4067870999420278, 'support': 583991}, 'weighted avg': {'precision': 0.41539902602749246, 'recall': 0.4094532278750871, 'f1-score': 0.40754626015066553, 'support': 583991}}
[[ 66998  84181  36441]
 [ 48596 102690  55895]
 [ 36568  83193  69429]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0766973
{'0': {'precision': 0.4293650008590216, 'recall': 0.43251294046076955, 'f1-score': 0.43093322186226357, 'support': 190681}, '1': {'precision': 0.3553569635505573, 'recall': 0.3736744985846234, 'f1-score': 0.3642856092503909, 'support': 198887}, '2': {'precision': 0.43093892423935704, 'recall': 0.4051166785822665, 'f1-score': 0.4176290310607748, 'support': 194423}, 'accuracy': 0.4033538188088515, 'macro avg': {'precision': 0.405220296216312, 'recall': 0.4037680392092198, 'f1-score': 0.40428262072447646, 'support': 583991}, 'weighted avg': {'precision': 0.40468443281808675, 'recall': 0.4033538188088515, 'f1-score': 0.4038061181607761, 'support': 583991}}
[[82472 66706 41503]
 [62062 74319 62506]
 [47545 68114 78764]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0780332
{'0': {'precision': 0.42456242838205227, 'recall': 0.48509742510204606, 'f1-score': 0.45281572010543975, 'support': 194765}, '1': {'precision': 0.3399902000201025, 'recall': 0.28401922814530267, 'f1-score': 0.30949453590973813, 'support': 190554}, '2': {'precision': 0.4319975083056478, 'recall': 0.4398254409277603, 'f1-score': 0.4358763318568179, 'support': 198672}, 'accuracy': 0.4040849944605311, 'macro avg': {'precision': 0.39885004556926756, 'recall': 0.40298069805836967, 'f1-score': 0.39939552929066524, 'support': 583991}, 'weighted avg': {'precision': 0.3994962300935471, 'recall': 0.4040849944605311, 'f1-score': 0.4002878436906355, 'support': 583991}}
[[94480 51616 48669]
 [70211 54121 66222]
 [57844 53447 87381]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0850924
{'0': {'precision': 0.44120696420826533, 'recall': 0.503274625656103, 'f1-score': 0.4702013721213295, 'support': 212238}, '1': {'precision': 0.28979497994196646, 'recall': 0.2322713062044074, 'f1-score': 0.25786403109634365, 'support': 157372}, '2': {'precision': 0.4496157803505715, 'recall': 0.45251211627896126, 'f1-score': 0.4510592988843245, 'support': 214381}, 'accuracy': 0.41161079537184647, 'macro avg': {'precision': 0.3935392415002677, 'recall': 0.3960193493798239, 'f1-score': 0.3930415673673326, 'support': 583991}, 'weighted avg': {'precision': 0.4034918001482845, 'recall': 0.41161079537184647, 'f1-score': 0.40595440798248755, 'support': 583991}}
[[106814  44340  61084]
 [ 63151  36553  57668]
 [ 72130  45241  97010]]
Evaluating performance on  train set...
878/878 - 11s - 11s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0707821
{'0': {'precision': 0.4565814669885938, 'recall': 0.36864252967827804, 'f1-score': 0.40792644827278407, 'support': 74381}, '1': {'precision': 0.3754736266118791, 'recall': 0.48948827693881397, 'f1-score': 0.42496655117815807, 'support': 74298}, '2': {'precision': 0.4483465286685243, 'recall': 0.3998054218926665, 'f1-score': 0.4226869322880832, 'support': 76062}, 'accuracy': 0.4191402547821715, 'macro avg': {'precision': 0.4268005407563324, 'recall': 0.41931207616991956, 'f1-score': 0.4185266439130085, 'support': 224741}, 'weighted avg': {'precision': 0.4269806544852665, 'recall': 0.4191402547821715, 'f1-score': 0.4185553833617761, 'support': 224741}}
[[27420 29873 17088]
 [17601 36368 20329]
 [15034 30618 30410]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.073807
{'0': {'precision': 0.435941387890517, 'recall': 0.4240362506891127, 'f1-score': 0.4299064146519348, 'support': 74371}, '1': {'precision': 0.36455873015873014, 'recall': 0.3868772487770695, 'f1-score': 0.3753865465457612, 'support': 74207}, '2': {'precision': 0.44018411155313575, 'recall': 0.42566600580334285, 'f1-score': 0.43280334281175326, 'support': 76163}, 'accuracy': 0.41231906950667657, 'macro avg': {'precision': 0.4135614098674609, 'recall': 0.412193168423175, 'f1-score': 0.41269876800314975, 'support': 224741}, 'weighted avg': {'precision': 0.413809447924126, 'recall': 0.41231906950667657, 'f1-score': 0.4128863021085245, 'support': 224741}}
[[31536 24635 18200]
 [22467 28709 23031]
 [18337 25406 32420]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0754086
{'0': {'precision': 0.42095551812958193, 'recall': 0.45744852644327816, 'f1-score': 0.4384439772478106, 'support': 74310}, '1': {'precision': 0.36483661899821057, 'recall': 0.32619422148724775, 'f1-score': 0.344434980124929, 'support': 74379}, '2': {'precision': 0.4335510014453851, 'recall': 0.4417372324199232, 'f1-score': 0.4376058356128696, 'support': 76052}, 'accuracy': 0.408692672899026, 'macro avg': {'precision': 0.4064477128577259, 'recall': 0.40845999345014966, 'f1-score': 0.40682826432853636, 'support': 224741}, 'weighted avg': {'precision': 0.40664501892668253, 'recall': 0.408692672899026, 'f1-score': 0.407047669744403, 'support': 224741}}
[[33993 20976 19341]
 [25565 24262 24552]
 [21194 21263 33595]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0824229
{'0': {'precision': 0.40483536077515925, 'recall': 0.4624465675961783, 'f1-score': 0.4317274853947483, 'support': 74627}, '1': {'precision': 0.3692057378137867, 'recall': 0.29945328701085344, 'f1-score': 0.33069133195532885, 'support': 74262}, '2': {'precision': 0.41750145088440865, 'recall': 0.4362706322839213, 'f1-score': 0.42667973232590223, 'support': 75852}, 'accuracy': 0.39975349402200755, 'macro avg': {'precision': 0.3971808498244515, 'recall': 0.3993901622969844, 'f1-score': 0.39636618322532646, 'support': 224741}, 'weighted avg': {'precision': 0.3973370458553598, 'recall': 0.39975349402200755, 'f1-score': 0.39663807584110083, 'support': 224741}}
[[34511 18955 21161]
 [27015 22238 25009]
 [23721 19039 33092]]
Evaluating performance on  val set...
303/303 - 4s - 4s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.06567
{'0': {'precision': 0.45250859801739834, 'recall': 0.357294037778044, 'f1-score': 0.3993037734585946, 'support': 25041}, '1': {'precision': 0.3961928154743629, 'recall': 0.4793284053341258, 'f1-score': 0.4338135180111277, 'support': 26921}, '2': {'precision': 0.4368831168831169, 'recall': 0.4303483566227121, 'f1-score': 0.4335911163989689, 'support': 25405}, 'accuracy': 0.42374655861026017, 'macro avg': {'precision': 0.428528176791626, 'recall': 0.4223235999116273, 'f1-score': 0.4222361359562304, 'support': 77367}, 'weighted avg': {'precision': 0.42778174380232625, 'recall': 0.42374655861026017, 'f1-score': 0.4225708870923009, 'support': 77367}}
[[ 8947 10007  6087]
 [ 6012 12904  8005]
 [ 4813  9659 10933]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0718075
{'0': {'precision': 0.4377009129484377, 'recall': 0.40443564356435646, 'f1-score': 0.4204112718964204, 'support': 25250}, '1': {'precision': 0.3788296737651256, 'recall': 0.38894343327543235, 'f1-score': 0.38381994000484426, 'support': 26482}, '2': {'precision': 0.4288747346072187, 'recall': 0.4491515506143944, 'f1-score': 0.4387790099462673, 'support': 25635}, 'accuracy': 0.4139490997453695, 'macro avg': {'precision': 0.4151351071069273, 'recall': 0.41417687581806106, 'f1-score': 0.41433674061584397, 'support': 77367}, 'weighted avg': {'precision': 0.4146253479423031, 'recall': 0.4139490997453695, 'f1-score': 0.4139724195918862, 'support': 77367}}
[[10212  8498  6540]
 [ 7389 10300  8793]
 [ 5730  8391 11514]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0754511
{'0': {'precision': 0.42478809421506974, 'recall': 0.43028408641291443, 'f1-score': 0.4275184275184275, 'support': 25274}, '1': {'precision': 0.37186283442392115, 'recall': 0.3395348837209302, 'f1-score': 0.35496432171730147, 'support': 26445}, '2': {'precision': 0.41973207820419983, 'recall': 0.452004054897068, 'f1-score': 0.4352707066156041, 'support': 25648}, 'accuracy': 0.40646528881823, 'macro avg': {'precision': 0.4054610022810636, 'recall': 0.4072743416769709, 'f1-score': 0.405917818617111, 'support': 77367}, 'weighted avg': {'precision': 0.40502145994175276, 'recall': 0.40646528881823, 'f1-score': 0.40528849907831227, 'support': 77367}}
[[10875  7546  6853]
 [ 8292  8979  9174]
 [ 6434  7621 11593]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0825384
{'0': {'precision': 0.40489578647473384, 'recall': 0.4240508813945271, 'f1-score': 0.41425201833279, 'support': 25471}, '1': {'precision': 0.3663594470046083, 'recall': 0.3206498991666984, 'f1-score': 0.34198405129557863, 'support': 26281}, '2': {'precision': 0.40810430134710535, 'recall': 0.4411477649814562, 'f1-score': 0.4239831907549152, 'support': 25615}, 'accuracy': 0.3945868393501105, 'macro avg': {'precision': 0.39311984494214913, 'recall': 0.39528284851422724, 'f1-score': 0.39340642012776134, 'support': 77367}, 'weighted avg': {'precision': 0.3928675647631698, 'recall': 0.3945868393501105, 'f1-score': 0.3929249608003509, 'support': 77367}}
[[10801  7354  7316]
 [ 8781  8427  9073]
 [ 7094  7221 11300]]
training model: results/PCAR/W3/deepLOB_L2/seq2seq
Epoch 1/50
878/878 - 54s - loss: 12.9776 - accuracy10: 0.4137 - accuracy20: 0.4033 - accuracy30: 0.3960 - accuracy50: 0.3884 - val_loss: 13.0513 - val_accuracy10: 0.4009 - val_accuracy20: 0.3899 - val_accuracy30: 0.3803 - val_accuracy50: 0.3576 - 54s/epoch - 61ms/step
Epoch 2/50
878/878 - 47s - loss: 12.7193 - accuracy10: 0.4546 - accuracy20: 0.4377 - accuracy30: 0.4253 - accuracy50: 0.4108 - val_loss: 12.8501 - val_accuracy10: 0.4284 - val_accuracy20: 0.4142 - val_accuracy30: 0.4022 - val_accuracy50: 0.3836 - 47s/epoch - 54ms/step
Epoch 3/50
878/878 - 47s - loss: 12.6204 - accuracy10: 0.4664 - accuracy20: 0.4480 - accuracy30: 0.4332 - accuracy50: 0.4168 - val_loss: 12.8311 - val_accuracy10: 0.4375 - val_accuracy20: 0.4214 - val_accuracy30: 0.4093 - val_accuracy50: 0.3987 - 47s/epoch - 53ms/step
Epoch 4/50
878/878 - 47s - loss: 12.5179 - accuracy10: 0.4787 - accuracy20: 0.4580 - accuracy30: 0.4417 - accuracy50: 0.4257 - val_loss: 12.7209 - val_accuracy10: 0.4482 - val_accuracy20: 0.4327 - val_accuracy30: 0.4185 - val_accuracy50: 0.3991 - 47s/epoch - 54ms/step
Epoch 5/50
878/878 - 47s - loss: 12.4552 - accuracy10: 0.4860 - accuracy20: 0.4632 - accuracy30: 0.4462 - accuracy50: 0.4296 - val_loss: 12.7128 - val_accuracy10: 0.4540 - val_accuracy20: 0.4355 - val_accuracy30: 0.4190 - val_accuracy50: 0.3983 - 47s/epoch - 53ms/step
Epoch 6/50
878/878 - 47s - loss: 12.4043 - accuracy10: 0.4924 - accuracy20: 0.4678 - accuracy30: 0.4495 - accuracy50: 0.4340 - val_loss: 12.6939 - val_accuracy10: 0.4591 - val_accuracy20: 0.4375 - val_accuracy30: 0.4188 - val_accuracy50: 0.3930 - 47s/epoch - 53ms/step
Epoch 7/50
878/878 - 46s - loss: 12.3676 - accuracy10: 0.4961 - accuracy20: 0.4701 - accuracy30: 0.4522 - accuracy50: 0.4348 - val_loss: 12.7104 - val_accuracy10: 0.4600 - val_accuracy20: 0.4347 - val_accuracy30: 0.4180 - val_accuracy50: 0.3916 - 46s/epoch - 53ms/step
Epoch 8/50
878/878 - 48s - loss: 12.3323 - accuracy10: 0.4994 - accuracy20: 0.4743 - accuracy30: 0.4561 - accuracy50: 0.4377 - val_loss: 12.7451 - val_accuracy10: 0.4603 - val_accuracy20: 0.4303 - val_accuracy30: 0.4103 - val_accuracy50: 0.3783 - 48s/epoch - 54ms/step
Epoch 9/50
878/878 - 47s - loss: 12.3081 - accuracy10: 0.5013 - accuracy20: 0.4761 - accuracy30: 0.4580 - accuracy50: 0.4383 - val_loss: 12.7346 - val_accuracy10: 0.4654 - val_accuracy20: 0.4369 - val_accuracy30: 0.4153 - val_accuracy50: 0.3832 - 47s/epoch - 53ms/step
Epoch 10/50
878/878 - 46s - loss: 12.2788 - accuracy10: 0.5052 - accuracy20: 0.4798 - accuracy30: 0.4610 - accuracy50: 0.4408 - val_loss: 12.7354 - val_accuracy10: 0.4679 - val_accuracy20: 0.4391 - val_accuracy30: 0.4165 - val_accuracy50: 0.3839 - 46s/epoch - 53ms/step
Epoch 11/50
878/878 - 47s - loss: 12.2546 - accuracy10: 0.5073 - accuracy20: 0.4817 - accuracy30: 0.4623 - accuracy50: 0.4427 - val_loss: 12.7920 - val_accuracy10: 0.4631 - val_accuracy20: 0.4352 - val_accuracy30: 0.4154 - val_accuracy50: 0.3810 - 47s/epoch - 53ms/step
Epoch 12/50
878/878 - 46s - loss: 12.2340 - accuracy10: 0.5086 - accuracy20: 0.4836 - accuracy30: 0.4643 - accuracy50: 0.4436 - val_loss: 12.7685 - val_accuracy10: 0.4656 - val_accuracy20: 0.4389 - val_accuracy30: 0.4200 - val_accuracy50: 0.3885 - 46s/epoch - 53ms/step
Epoch 13/50
878/878 - 46s - loss: 12.2106 - accuracy10: 0.5111 - accuracy20: 0.4861 - accuracy30: 0.4667 - accuracy50: 0.4453 - val_loss: 12.7622 - val_accuracy10: 0.4665 - val_accuracy20: 0.4359 - val_accuracy30: 0.4149 - val_accuracy50: 0.3774 - 46s/epoch - 53ms/step
Epoch 14/50
878/878 - 46s - loss: 12.1874 - accuracy10: 0.5127 - accuracy20: 0.4866 - accuracy30: 0.4684 - accuracy50: 0.4466 - val_loss: 12.8309 - val_accuracy10: 0.4646 - val_accuracy20: 0.4330 - val_accuracy30: 0.4142 - val_accuracy50: 0.3810 - 46s/epoch - 53ms/step
Epoch 15/50
878/878 - 47s - loss: 12.1605 - accuracy10: 0.5150 - accuracy20: 0.4895 - accuracy30: 0.4701 - accuracy50: 0.4479 - val_loss: 12.8187 - val_accuracy10: 0.4639 - val_accuracy20: 0.4344 - val_accuracy30: 0.4124 - val_accuracy50: 0.3781 - 47s/epoch - 53ms/step
Epoch 16/50
878/878 - 48s - loss: 12.1435 - accuracy10: 0.5168 - accuracy20: 0.4912 - accuracy30: 0.4720 - accuracy50: 0.4497 - val_loss: 12.8343 - val_accuracy10: 0.4600 - val_accuracy20: 0.4280 - val_accuracy30: 0.4078 - val_accuracy50: 0.3730 - 48s/epoch - 54ms/step
testing model: results/PCAR/W3/deepLOB_L2/seq2seq
Evaluating performance on  test set...
2282/2282 - 46s - 46s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0478997
{'0': {'precision': 0.4390494340304589, 'recall': 0.5697549847831532, 'f1-score': 0.4959347896181138, 'support': 187621}, '1': {'precision': 0.4970732944458534, 'recall': 0.2365022057900783, 'f1-score': 0.32050942415055095, 'support': 207182}, '2': {'precision': 0.4442391627814701, 'recall': 0.568105416719523, 'f1-score': 0.4985944110443108, 'support': 189192}, 'accuracy': 0.4509935872738636, 'macro avg': {'precision': 0.4601206304192608, 'recall': 0.4581208690975848, 'f1-score': 0.43834620827099186, 'support': 583995}, 'weighted avg': {'precision': 0.46131564283437604, 'recall': 0.4509935872738636, 'f1-score': 0.43456132071609316, 'support': 583995}}
[[106898  28189  52534]
 [ 76254  48999  81929]
 [ 60324  21387 107481]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.055986
{'0': {'precision': 0.4345784312844342, 'recall': 0.5071532708908025, 'f1-score': 0.46806935006098627, 'support': 190682}, '1': {'precision': 0.4531654539012891, 'recall': 0.2508157898706301, 'f1-score': 0.3229093168827638, 'support': 198887}, '2': {'precision': 0.4369147539679383, 'recall': 0.56492444426157, 'f1-score': 0.49274140003947814, 'support': 194426}, 'accuracy': 0.43908766342177585, 'macro avg': {'precision': 0.4415528797178872, 'recall': 0.4409645016743342, 'f1-score': 0.4279066889944094, 'support': 583995}, 'weighted avg': {'precision': 0.44168629871696596, 'recall': 0.4390876634217759, 'f1-score': 0.42684715547096597, 'support': 583995}}
[[ 96705  33257  60720]
 [ 68169  49884  80834]
 [ 57652  26938 109836]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0636919
{'0': {'precision': 0.4359845307032801, 'recall': 0.43759177679882527, 'f1-score': 0.43678667520819986, 'support': 194766}, '1': {'precision': 0.4178380878441996, 'recall': 0.26549429558025545, 'f1-score': 0.32468424295322684, 'support': 190554}, '2': {'precision': 0.4287541178538176, 'recall': 0.5771385428463571, 'f1-score': 0.4920018536476525, 'support': 198675}, 'accuracy': 0.4289112064315619, 'macro avg': {'precision': 0.42752557880043246, 'recall': 0.4267415384084792, 'f1-score': 0.4178242572696931, 'support': 583995}, 'weighted avg': {'precision': 0.42760367205648314, 'recall': 0.4289112064315619, 'f1-score': 0.4189925309099509, 'support': 583995}}
[[ 85228  38556  70982]
 [ 58175  50591  81788]
 [ 52081  31931 114663]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0707628
{'0': {'precision': 0.4506939064742585, 'recall': 0.35361078783823896, 'f1-score': 0.3962931671771043, 'support': 212239}, '1': {'precision': 0.3310037437093409, 'recall': 0.27417028333958177, 'f1-score': 0.29991832478929537, 'support': 157373}, '2': {'precision': 0.4360655052556056, 'recall': 0.5840201881679051, 'f1-score': 0.4993130676663244, 'support': 214383}, 'accuracy': 0.4167861026207416, 'macro avg': {'precision': 0.4059210518130683, 'recall': 0.4039337531152419, 'f1-score': 0.3985081865442413, 'support': 583995}, 'weighted avg': {'precision': 0.4130701587996006, 'recall': 0.4167861026207416, 'f1-score': 0.4081407296656253, 'support': 583995}}
[[ 75050  47365  89824]
 [ 42132  43147  72094]
 [ 49339  39840 125204]]
Evaluating performance on  train set...
878/878 - 18s - 18s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0240438
{'0': {'precision': 0.48637445856401135, 'recall': 0.456173155048562, 'f1-score': 0.4707899486325143, 'support': 74338}, '1': {'precision': 0.4999687948573925, 'recall': 0.32383377799337054, 'f1-score': 0.3930718088368784, 'support': 74214}, '2': {'precision': 0.45695265165681803, 'recall': 0.6414405900959431, 'f1-score': 0.5337031718383995, 'support': 76191}, 'accuracy': 0.4752806539024575, 'macro avg': {'precision': 0.481098635026074, 'recall': 0.4738158410459586, 'f1-score': 0.46585497643593077, 'support': 224743}, 'weighted avg': {'precision': 0.4808891405946464, 'recall': 0.4752806539024575, 'f1-score': 0.46645454046623674, 'support': 224743}}
[[33911 13431 26996]
 [19097 24033 31084]
 [16714 10605 48872]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.044496
{'0': {'precision': 0.4680786878999095, 'recall': 0.39663383919922507, 'f1-score': 0.4294047818455914, 'support': 74328}, '1': {'precision': 0.4610235247133104, 'recall': 0.3271083524490622, 'f1-score': 0.3826888620523628, 'support': 74110}, '2': {'precision': 0.4410635939804171, 'recall': 0.6310726688945678, 'f1-score': 0.5192309765907204, 'support': 76305}, 'accuracy': 0.4533044410726919, 'macro avg': {'precision': 0.45672193553121226, 'recall': 0.45160495351428503, 'f1-score': 0.44377487349622485, 'support': 224743}, 'weighted avg': {'precision': 0.4565800210436082, 'recall': 0.4533044410726919, 'f1-score': 0.4444978925282418, 'support': 224743}}
[[29481 15676 29171]
 [18016 24242 31852]
 [15486 12665 48154]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0575476
{'0': {'precision': 0.4609593222220167, 'recall': 0.33481129160116624, 'f1-score': 0.3878866179972915, 'support': 74427}, '1': {'precision': 0.433713205321677, 'recall': 0.33762270622071594, 'f1-score': 0.3796826360944499, 'support': 74059}, '2': {'precision': 0.425919864110481, 'recall': 0.6313256487928977, 'f1-score': 0.5086692376776375, 'support': 76257}, 'accuracy': 0.4363472944652336, 'macro avg': {'precision': 0.44019746388472497, 'recall': 0.43458654887159326, 'f1-score': 0.4254128305897929, 'support': 224743}, 'weighted avg': {'precision': 0.44009182410757647, 'recall': 0.4363472944652336, 'f1-score': 0.426165636846473, 'support': 224743}}
[[24919 17939 31569]
 [15734 25004 33321]
 [13406 14708 48143]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0699314
{'0': {'precision': 0.44023908825300534, 'recall': 0.26465816607001597, 'f1-score': 0.33058114218723833, 'support': 74583}, '1': {'precision': 0.42190662853837996, 'recall': 0.354002102822635, 'f1-score': 0.3849829951917439, 'support': 74186}, '2': {'precision': 0.4068927417984022, 'recall': 0.6301497880853977, 'f1-score': 0.49448960409845377, 'support': 75974}, 'accuracy': 0.41770377720329444, 'macro avg': {'precision': 0.4230128195299292, 'recall': 0.4162700189926829, 'f1-score': 0.4033512471591454, 'support': 224743}, 'weighted avg': {'precision': 0.4229150017100152, 'recall': 0.41770377720329444, 'f1-score': 0.40394777586319236, 'support': 224743}}
[[19739 19524 35320]
 [13459 26262 34465]
 [11639 16460 47875]]
Evaluating performance on  val set...
303/303 - 6s - 6s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0330491
{'0': {'precision': 0.47789138832083616, 'recall': 0.42099363465310863, 'f1-score': 0.44764175038310916, 'support': 24979}, '1': {'precision': 0.4558740335659061, 'recall': 0.35796253794328864, 'f1-score': 0.4010284908555551, 'support': 27014}, '2': {'precision': 0.45162518301610544, 'recall': 0.6078269094348546, 'f1-score': 0.5182111417243465, 'support': 25374}, 'accuracy': 0.46026083472281465, 'macro avg': {'precision': 0.46179686830094924, 'recall': 0.46226102734375063, 'f1-score': 0.4556271276543369, 'support': 77367}, 'weighted avg': {'precision': 0.46158914686450575, 'recall': 0.46026083472281465, 'f1-score': 0.45451053349496834, 'support': 77367}}
[[10516  6627  7836]
 [ 6453  9670 10891]
 [ 5036  4915 15423]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0514925
{'0': {'precision': 0.46302706104468216, 'recall': 0.3502598484547943, 'f1-score': 0.39882552230378315, 'support': 25207}, '1': {'precision': 0.41286298651330444, 'recall': 0.3846066779852858, 'f1-score': 0.3982342370497695, 'support': 26505}, '2': {'precision': 0.4399250178528922, 'recall': 0.5763009160007796, 'f1-score': 0.49896225300777897, 'support': 25655}, 'accuracy': 0.43698217586309407, 'macro avg': {'precision': 0.4386050218036262, 'recall': 0.4370558141469532, 'f1-score': 0.43200733745377723, 'support': 77367}, 'weighted avg': {'precision': 0.4381807866183824, 'recall': 0.43698217586309407, 'f1-score': 0.43182842807178995, 'support': 77367}}
[[ 8829  8155  8223]
 [ 5711 10194 10600]
 [ 4528  6342 14785]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0634373
{'0': {'precision': 0.44624733742638767, 'recall': 0.28185343463121243, 'f1-score': 0.3454915846146384, 'support': 25272}, '1': {'precision': 0.3946321711398574, 'recall': 0.41640199637023595, 'f1-score': 0.4052249103118388, 'support': 26448}, '2': {'precision': 0.4257567615977073, 'recall': 0.5560884313954848, 'f1-score': 0.4822723814354552, 'support': 25647}, 'accuracy': 0.4187573513255005, 'macro avg': {'precision': 0.4222120900546508, 'recall': 0.4181146207989777, 'f1-score': 0.4109962921206442, 'support': 77367}, 'weighted avg': {'precision': 0.4218100487086615, 'recall': 0.4187573513255005, 'f1-score': 0.41125404269241117, 'support': 77367}}
[[ 7123  9411  8738]
 [ 4937 11013 10498]
 [ 3902  7483 14262]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0803801
{'0': {'precision': 0.4138140879354937, 'recall': 0.21349240610651074, 'f1-score': 0.2816682631320061, 'support': 25481}, '1': {'precision': 0.363516323903212, 'recall': 0.4196966232182331, 'f1-score': 0.3895915515380941, 'support': 26238}, '2': {'precision': 0.40662579580287667, 'recall': 0.5378976918278229, 'f1-score': 0.4631395192695045, 'support': 25648}, 'accuracy': 0.39096772525753876, 'macro avg': {'precision': 0.3946520692138608, 'recall': 0.39036224038418893, 'f1-score': 0.37813311131320154, 'support': 77367}, 'weighted avg': {'precision': 0.3943732662764353, 'recall': 0.39096772525753876, 'f1-score': 0.3784287167958873, 'support': 77367}}
[[ 5440 10575  9466]
 [ 4560 11012 10666]
 [ 3146  8706 13796]]
training model: results/PCAR/W3/deepOF_L2/seq2seq
Epoch 1/50
878/878 - 37s - loss: 12.8646 - accuracy10: 0.4379 - accuracy20: 0.4191 - accuracy30: 0.4062 - accuracy50: 0.3902 - val_loss: 12.6563 - val_accuracy10: 0.4726 - val_accuracy20: 0.4446 - val_accuracy30: 0.4209 - val_accuracy50: 0.3957 - 37s/epoch - 42ms/step
Epoch 2/50
878/878 - 31s - loss: 12.5973 - accuracy10: 0.4765 - accuracy20: 0.4490 - accuracy30: 0.4299 - accuracy50: 0.4086 - val_loss: 12.5769 - val_accuracy10: 0.4856 - val_accuracy20: 0.4491 - val_accuracy30: 0.4216 - val_accuracy50: 0.3915 - 31s/epoch - 35ms/step
Epoch 3/50
878/878 - 32s - loss: 12.4595 - accuracy10: 0.4941 - accuracy20: 0.4641 - accuracy30: 0.4425 - accuracy50: 0.4188 - val_loss: 12.5079 - val_accuracy10: 0.4942 - val_accuracy20: 0.4592 - val_accuracy30: 0.4314 - val_accuracy50: 0.3980 - 32s/epoch - 37ms/step
Epoch 4/50
878/878 - 31s - loss: 12.3696 - accuracy10: 0.5036 - accuracy20: 0.4735 - accuracy30: 0.4503 - accuracy50: 0.4251 - val_loss: 12.4821 - val_accuracy10: 0.4963 - val_accuracy20: 0.4637 - val_accuracy30: 0.4349 - val_accuracy50: 0.4016 - 31s/epoch - 36ms/step
Epoch 5/50
878/878 - 31s - loss: 12.3197 - accuracy10: 0.5085 - accuracy20: 0.4776 - accuracy30: 0.4553 - accuracy50: 0.4283 - val_loss: 12.4659 - val_accuracy10: 0.4970 - val_accuracy20: 0.4620 - val_accuracy30: 0.4349 - val_accuracy50: 0.4041 - 31s/epoch - 36ms/step
Epoch 6/50
878/878 - 31s - loss: 12.2809 - accuracy10: 0.5107 - accuracy20: 0.4802 - accuracy30: 0.4574 - accuracy50: 0.4325 - val_loss: 12.4647 - val_accuracy10: 0.4992 - val_accuracy20: 0.4638 - val_accuracy30: 0.4363 - val_accuracy50: 0.4066 - 31s/epoch - 36ms/step
Epoch 7/50
878/878 - 31s - loss: 12.2417 - accuracy10: 0.5136 - accuracy20: 0.4837 - accuracy30: 0.4606 - accuracy50: 0.4355 - val_loss: 12.4534 - val_accuracy10: 0.4999 - val_accuracy20: 0.4636 - val_accuracy30: 0.4369 - val_accuracy50: 0.4080 - 31s/epoch - 36ms/step
Epoch 8/50
878/878 - 31s - loss: 12.2141 - accuracy10: 0.5172 - accuracy20: 0.4859 - accuracy30: 0.4625 - accuracy50: 0.4374 - val_loss: 12.4567 - val_accuracy10: 0.4981 - val_accuracy20: 0.4641 - val_accuracy30: 0.4359 - val_accuracy50: 0.4068 - 31s/epoch - 35ms/step
Epoch 9/50
878/878 - 30s - loss: 12.1903 - accuracy10: 0.5186 - accuracy20: 0.4888 - accuracy30: 0.4644 - accuracy50: 0.4398 - val_loss: 12.4618 - val_accuracy10: 0.4986 - val_accuracy20: 0.4622 - val_accuracy30: 0.4340 - val_accuracy50: 0.4070 - 30s/epoch - 34ms/step
Epoch 10/50
878/878 - 30s - loss: 12.1690 - accuracy10: 0.5203 - accuracy20: 0.4892 - accuracy30: 0.4666 - accuracy50: 0.4410 - val_loss: 12.4680 - val_accuracy10: 0.5000 - val_accuracy20: 0.4623 - val_accuracy30: 0.4358 - val_accuracy50: 0.4069 - 30s/epoch - 34ms/step
Epoch 11/50
878/878 - 30s - loss: 12.1446 - accuracy10: 0.5228 - accuracy20: 0.4920 - accuracy30: 0.4686 - accuracy50: 0.4436 - val_loss: 12.4658 - val_accuracy10: 0.4991 - val_accuracy20: 0.4647 - val_accuracy30: 0.4378 - val_accuracy50: 0.4086 - 30s/epoch - 35ms/step
Epoch 12/50
878/878 - 30s - loss: 12.1202 - accuracy10: 0.5243 - accuracy20: 0.4928 - accuracy30: 0.4712 - accuracy50: 0.4450 - val_loss: 12.4657 - val_accuracy10: 0.5023 - val_accuracy20: 0.4659 - val_accuracy30: 0.4385 - val_accuracy50: 0.4095 - 30s/epoch - 34ms/step
Epoch 13/50
878/878 - 30s - loss: 12.1020 - accuracy10: 0.5254 - accuracy20: 0.4945 - accuracy30: 0.4714 - accuracy50: 0.4470 - val_loss: 12.4902 - val_accuracy10: 0.5002 - val_accuracy20: 0.4643 - val_accuracy30: 0.4373 - val_accuracy50: 0.4089 - 30s/epoch - 34ms/step
Epoch 14/50
878/878 - 30s - loss: 12.0813 - accuracy10: 0.5267 - accuracy20: 0.4965 - accuracy30: 0.4734 - accuracy50: 0.4491 - val_loss: 12.5013 - val_accuracy10: 0.4999 - val_accuracy20: 0.4627 - val_accuracy30: 0.4380 - val_accuracy50: 0.4089 - 30s/epoch - 34ms/step
Epoch 15/50
878/878 - 30s - loss: 12.0616 - accuracy10: 0.5278 - accuracy20: 0.4976 - accuracy30: 0.4750 - accuracy50: 0.4509 - val_loss: 12.4697 - val_accuracy10: 0.5037 - val_accuracy20: 0.4668 - val_accuracy30: 0.4410 - val_accuracy50: 0.4129 - 30s/epoch - 34ms/step
Epoch 16/50
878/878 - 30s - loss: 12.0474 - accuracy10: 0.5291 - accuracy20: 0.4987 - accuracy30: 0.4760 - accuracy50: 0.4512 - val_loss: 12.4764 - val_accuracy10: 0.5022 - val_accuracy20: 0.4666 - val_accuracy30: 0.4406 - val_accuracy50: 0.4121 - 30s/epoch - 34ms/step
Epoch 17/50
878/878 - 30s - loss: 12.0260 - accuracy10: 0.5301 - accuracy20: 0.4997 - accuracy30: 0.4780 - accuracy50: 0.4528 - val_loss: 12.5227 - val_accuracy10: 0.5005 - val_accuracy20: 0.4639 - val_accuracy30: 0.4389 - val_accuracy50: 0.4103 - 30s/epoch - 34ms/step
testing model: results/PCAR/W3/deepOF_L2/seq2seq
Evaluating performance on  test set...
2282/2282 - 36s - 36s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.99871767
{'0': {'precision': 0.4594919694358221, 'recall': 0.6067316917173009, 'f1-score': 0.5229453258330442, 'support': 187620}, '1': {'precision': 0.5363233802199008, 'recall': 0.37764563352817104, 'f1-score': 0.4432101737640378, 'support': 207181}, '2': {'precision': 0.5051584841830999, 'recall': 0.5082985358634178, 'f1-score': 0.5067236455226634, 'support': 189190}, 'accuracy': 0.4935709625662039, 'macro avg': {'precision': 0.5003246112796077, 'recall': 0.4975586203696299, 'f1-score': 0.49095971503991515, 'support': 583991}, 'weighted avg': {'precision': 0.501543399068631, 'recall': 0.4935709625662039, 'f1-score': 0.48940270576059486, 'support': 583991}}
[[113835  32864  40921]
 [ 75660  78241  53280]
 [ 58246  34779  96165]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0278809
{'0': {'precision': 0.4460324465263916, 'recall': 0.5777502740178623, 'f1-score': 0.5034180847758138, 'support': 190681}, '1': {'precision': 0.48221148684916804, 'recall': 0.33877025647729614, 'f1-score': 0.3979599069141082, 'support': 198887}, '2': {'precision': 0.47985299708528706, 'recall': 0.4868919829444047, 'f1-score': 0.48334686416576034, 'support': 194423}, 'accuracy': 0.46611334763720674, 'macro avg': {'precision': 0.46936564348694887, 'recall': 0.46780417114652106, 'f1-score': 0.46157495195189413, 'support': 583991}, 'weighted avg': {'precision': 0.469613347077921, 'recall': 0.46611334763720674, 'f1-score': 0.46082056607252986, 'support': 583991}}
[[110166  34442  46073]
 [ 74971  67377  56539]
 [ 61854  37906  94663]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0484184
{'0': {'precision': 0.4429749174484463, 'recall': 0.5200318332349242, 'f1-score': 0.4784204435417208, 'support': 194765}, '1': {'precision': 0.41367934503489323, 'recall': 0.3592997260619037, 'f1-score': 0.38457671340985616, 'support': 190554}, '2': {'precision': 0.47035677224624817, 'recall': 0.4494493436417814, 'f1-score': 0.45966544234041073, 'support': 198672}, 'accuracy': 0.443573616716696, 'macro avg': {'precision': 0.44233701157652927, 'recall': 0.4429269676462031, 'f1-score': 0.44088753309732925, 'support': 583991}, 'weighted avg': {'precision': 0.4427311112094746, 'recall': 0.443573616716696, 'f1-score': 0.4414192025119549, 'support': 583991}}
[[101284  47066  46415]
 [ 67955  68466  54133]
 [ 59406  49973  89293]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.074317
{'0': {'precision': 0.4599808184775408, 'recall': 0.43839463244093896, 'f1-score': 0.4489283887714829, 'support': 212238}, '1': {'precision': 0.3147842389002822, 'recall': 0.4203797371832346, 'f1-score': 0.35999836750241476, 'support': 157372}, '2': {'precision': 0.47799475371611777, 'recall': 0.38249658318600993, 'f1-score': 0.4249464282475365, 'support': 214381}, 'accuracy': 0.4130200636653647, 'macro avg': {'precision': 0.41758660369798023, 'recall': 0.4137569842700612, 'f1-score': 0.41129106150714473, 'support': 583991}, 'weighted avg': {'precision': 0.42746656625301854, 'recall': 0.4130200636653647, 'f1-score': 0.4161601235306831, 'support': 583991}}
[[93044 70589 48605]
 [50271 66156 40945]
 [58963 73418 82000]]
Evaluating performance on  train set...
878/878 - 13s - 13s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9893847
{'0': {'precision': 0.47956891661939877, 'recall': 0.5683440663610331, 'f1-score': 0.5201961471965348, 'support': 74381}, '1': {'precision': 0.536076101514475, 'recall': 0.420199736197475, 'f1-score': 0.47111728134242775, 'support': 74298}, '2': {'precision': 0.5062090794226131, 'recall': 0.5214561804843417, 'f1-score': 0.5137195220671567, 'support': 76062}, 'accuracy': 0.5034995839655425, 'macro avg': {'precision': 0.5072846991854957, 'recall': 0.50333332768095, 'f1-score': 0.5016776502020398, 'support': 224741}, 'weighted avg': {'precision': 0.5072660207814006, 'recall': 0.5034995839655425, 'f1-score': 0.5017790064175083, 'support': 224741}}
[[42274 12605 19502]
 [23890 31220 19188]
 [21986 14413 39663]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0240933
{'0': {'precision': 0.4596229224094816, 'recall': 0.5313495851877748, 'f1-score': 0.4928904632424476, 'support': 74371}, '1': {'precision': 0.483287950987066, 'recall': 0.38268626948940127, 'f1-score': 0.4271435769777463, 'support': 74207}, '2': {'precision': 0.4768136593170341, 'recall': 0.5008599976366477, 'f1-score': 0.4885411130392464, 'support': 76163}, 'accuracy': 0.4719299104302286, 'macro avg': {'precision': 0.4732415109045272, 'recall': 0.47163195077127457, 'f1-score': 0.46952505108648007, 'support': 224741}, 'weighted avg': {'precision': 0.473262662691614, 'recall': 0.4719299104302286, 'f1-score': 0.4697076049808438, 'support': 224741}}
[[39517 14403 20451]
 [24403 28398 21406]
 [22057 15959 38147]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0464513
{'0': {'precision': 0.44863691256198773, 'recall': 0.46993675144664243, 'f1-score': 0.45903988221994374, 'support': 74310}, '1': {'precision': 0.42424584792678793, 'recall': 0.4038774385243147, 'f1-score': 0.4138111538911886, 'support': 74379}, '2': {'precision': 0.4600433668440765, 'recall': 0.46030347656866355, 'f1-score': 0.4601733849500812, 'support': 76052}, 'accuracy': 0.4448142528510597, 'macro avg': {'precision': 0.4443087091109507, 'recall': 0.4447058888465402, 'f1-score': 0.44434147368707116, 'support': 224741}, 'weighted avg': {'precision': 0.44442451101780966, 'recall': 0.4448142528510597, 'f1-score': 0.44445481570011836, 'support': 224741}}
[[34921 19864 19525]
 [22776 30040 21563]
 [20141 20904 35007]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.068671
{'0': {'precision': 0.42877770665555176, 'recall': 0.38597290524877054, 'f1-score': 0.40625088149840627, 'support': 74627}, '1': {'precision': 0.3832231386683767, 'recall': 0.4667393821873906, 'f1-score': 0.4208781601379411, 'support': 74262}, '2': {'precision': 0.44129741649036025, 'recall': 0.39048410061699096, 'f1-score': 0.41433867244876543, 'support': 75852}, 'accuracy': 0.41418343782398404, 'macro avg': {'precision': 0.41776608727142955, 'recall': 0.41439879601771734, 'f1-score': 0.4138225713617043, 'support': 224741}, 'weighted avg': {'precision': 0.4179504508478723, 'recall': 0.41418343782398404, 'f1-score': 0.41381392556021873, 'support': 224741}}
[[28804 27803 18020]
 [20122 34661 19479]
 [18251 27982 29619]]
Evaluating performance on  val set...
303/303 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.99551284
{'0': {'precision': 0.48269511432344153, 'recall': 0.5547302424024599, 'f1-score': 0.5162117467808766, 'support': 25041}, '1': {'precision': 0.5165359849314468, 'recall': 0.4380223617250474, 'f1-score': 0.4740502512562814, 'support': 26921}, '2': {'precision': 0.5049689440993789, 'recall': 0.51202519189136, 'f1-score': 0.5084725886836705, 'support': 25405}, 'accuracy': 0.500096940556051, 'macro avg': {'precision': 0.5014000144514225, 'recall': 0.5015925986729558, 'f1-score': 0.49957819557360955, 'support': 77367}, 'weighted avg': {'precision': 0.5017846062656882, 'recall': 0.500096940556051, 'f1-score': 0.4989997192694422, 'support': 77367}}
[[13891  5293  5857]
 [ 8234 11792  6895]
 [ 6653  5744 13008]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0307782
{'0': {'precision': 0.45980661504977344, 'recall': 0.5103762376237624, 'f1-score': 0.4837734857443174, 'support': 25250}, '1': {'precision': 0.4556978233034571, 'recall': 0.40317951816328074, 'f1-score': 0.4278329860554576, 'support': 26482}, '2': {'precision': 0.4742570436125048, 'recall': 0.4793446459918081, 'f1-score': 0.47678727325637793, 'support': 25635}, 'accuracy': 0.463401708738868, 'macro avg': {'precision': 0.4632538273219118, 'recall': 0.4643001339262837, 'f1-score': 0.46279791501871764, 'support': 77367}, 'weighted avg': {'precision': 0.463188259848973, 'recall': 0.463401708738868, 'f1-score': 0.4623107449131011, 'support': 77367}}
[[12887  6157  6206]
 [ 8389 10677  7416]
 [ 6751  6596 12288]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.051013
{'0': {'precision': 0.4490024837753385, 'recall': 0.4434596818865237, 'f1-score': 0.4462138705310932, 'support': 25274}, '1': {'precision': 0.41002026810795433, 'recall': 0.43603705804499904, 'f1-score': 0.4226286468259786, 'support': 26445}, '2': {'precision': 0.4551519644180875, 'recall': 0.4309107922645041, 'f1-score': 0.4426997796915682, 'support': 25648}, 'accuracy': 0.4367624439360451, 'macro avg': {'precision': 0.4380582387671268, 'recall': 0.436802510732009, 'f1-score': 0.43718076568287995, 'support': 77367}, 'weighted avg': {'precision': 0.4377164986163075, 'recall': 0.4367624439360451, 'f1-score': 0.43698718935263353, 'support': 77367}}
[[11208  8106  5960]
 [ 7644 11531  7270]
 [ 6110  8486 11052]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0748034
{'0': {'precision': 0.4300407709414381, 'recall': 0.3644144320992501, 'f1-score': 0.39451705451067903, 'support': 25471}, '1': {'precision': 0.3752984838459104, 'recall': 0.4963661961112591, 'f1-score': 0.42742463958060295, 'support': 26281}, '2': {'precision': 0.4326959665144597, 'recall': 0.35514347062268203, 'f1-score': 0.3901027037457921, 'support': 25615}, 'accuracy': 0.40616800444634016, 'macro avg': {'precision': 0.4126784071006027, 'recall': 0.40530803294439705, 'f1-score': 0.4040147992790247, 'support': 77367}, 'weighted avg': {'precision': 0.41232431285782867, 'recall': 0.40616800444634016, 'f1-score': 0.40423399646758695, 'support': 77367}}
[[ 9282 10671  5518]
 [ 6827 13045  6409]
 [ 5475 11043  9097]]
training model: results/PCAR/W3/deepVOL_L2/seq2seq
Epoch 1/50
878/878 - 36s - loss: 12.9873 - accuracy10: 0.4118 - accuracy20: 0.4024 - accuracy30: 0.3961 - accuracy50: 0.3906 - val_loss: 12.9015 - val_accuracy10: 0.4200 - val_accuracy20: 0.4062 - val_accuracy30: 0.3951 - val_accuracy50: 0.3813 - 36s/epoch - 41ms/step
Epoch 2/50
878/878 - 30s - loss: 12.7259 - accuracy10: 0.4543 - accuracy20: 0.4350 - accuracy30: 0.4210 - accuracy50: 0.4051 - val_loss: 12.7206 - val_accuracy10: 0.4622 - val_accuracy20: 0.4403 - val_accuracy30: 0.4198 - val_accuracy50: 0.3993 - 30s/epoch - 34ms/step
Epoch 3/50
878/878 - 31s - loss: 12.5754 - accuracy10: 0.4785 - accuracy20: 0.4542 - accuracy30: 0.4347 - accuracy50: 0.4136 - val_loss: 12.7739 - val_accuracy10: 0.4577 - val_accuracy20: 0.4268 - val_accuracy30: 0.4089 - val_accuracy50: 0.3922 - 31s/epoch - 35ms/step
Epoch 4/50
878/878 - 31s - loss: 12.4874 - accuracy10: 0.4885 - accuracy20: 0.4627 - accuracy30: 0.4422 - accuracy50: 0.4222 - val_loss: 12.7643 - val_accuracy10: 0.4638 - val_accuracy20: 0.4328 - val_accuracy30: 0.4093 - val_accuracy50: 0.3925 - 31s/epoch - 35ms/step
Epoch 5/50
878/878 - 30s - loss: 12.4307 - accuracy10: 0.4951 - accuracy20: 0.4674 - accuracy30: 0.4465 - accuracy50: 0.4266 - val_loss: 12.6209 - val_accuracy10: 0.4831 - val_accuracy20: 0.4515 - val_accuracy30: 0.4262 - val_accuracy50: 0.4014 - 30s/epoch - 34ms/step
Epoch 6/50
878/878 - 30s - loss: 12.3850 - accuracy10: 0.5003 - accuracy20: 0.4712 - accuracy30: 0.4497 - accuracy50: 0.4300 - val_loss: 12.5965 - val_accuracy10: 0.4862 - val_accuracy20: 0.4531 - val_accuracy30: 0.4247 - val_accuracy50: 0.4034 - 30s/epoch - 34ms/step
Epoch 7/50
878/878 - 30s - loss: 12.3536 - accuracy10: 0.5047 - accuracy20: 0.4755 - accuracy30: 0.4520 - accuracy50: 0.4297 - val_loss: 12.5445 - val_accuracy10: 0.4915 - val_accuracy20: 0.4571 - val_accuracy30: 0.4288 - val_accuracy50: 0.4028 - 30s/epoch - 34ms/step
Epoch 8/50
878/878 - 29s - loss: 12.3223 - accuracy10: 0.5085 - accuracy20: 0.4780 - accuracy30: 0.4552 - accuracy50: 0.4328 - val_loss: 12.5937 - val_accuracy10: 0.4882 - val_accuracy20: 0.4560 - val_accuracy30: 0.4277 - val_accuracy50: 0.4025 - 29s/epoch - 33ms/step
Epoch 9/50
878/878 - 30s - loss: 12.2950 - accuracy10: 0.5111 - accuracy20: 0.4801 - accuracy30: 0.4574 - accuracy50: 0.4351 - val_loss: 12.5835 - val_accuracy10: 0.4892 - val_accuracy20: 0.4560 - val_accuracy30: 0.4267 - val_accuracy50: 0.4012 - 30s/epoch - 34ms/step
Epoch 10/50
878/878 - 29s - loss: 12.2691 - accuracy10: 0.5130 - accuracy20: 0.4827 - accuracy30: 0.4590 - accuracy50: 0.4358 - val_loss: 12.5775 - val_accuracy10: 0.4922 - val_accuracy20: 0.4570 - val_accuracy30: 0.4290 - val_accuracy50: 0.4030 - 29s/epoch - 33ms/step
Epoch 11/50
878/878 - 29s - loss: 12.2448 - accuracy10: 0.5152 - accuracy20: 0.4853 - accuracy30: 0.4620 - accuracy50: 0.4375 - val_loss: 12.6023 - val_accuracy10: 0.4899 - val_accuracy20: 0.4554 - val_accuracy30: 0.4256 - val_accuracy50: 0.3994 - 29s/epoch - 34ms/step
Epoch 12/50
878/878 - 29s - loss: 12.2275 - accuracy10: 0.5169 - accuracy20: 0.4862 - accuracy30: 0.4622 - accuracy50: 0.4399 - val_loss: 12.6052 - val_accuracy10: 0.4889 - val_accuracy20: 0.4555 - val_accuracy30: 0.4259 - val_accuracy50: 0.3987 - 29s/epoch - 33ms/step
Epoch 13/50
878/878 - 30s - loss: 12.2036 - accuracy10: 0.5194 - accuracy20: 0.4877 - accuracy30: 0.4644 - accuracy50: 0.4410 - val_loss: 12.5796 - val_accuracy10: 0.4910 - val_accuracy20: 0.4556 - val_accuracy30: 0.4272 - val_accuracy50: 0.3997 - 30s/epoch - 34ms/step
Epoch 14/50
878/878 - 30s - loss: 12.1890 - accuracy10: 0.5205 - accuracy20: 0.4897 - accuracy30: 0.4652 - accuracy50: 0.4418 - val_loss: 12.6194 - val_accuracy10: 0.4869 - val_accuracy20: 0.4530 - val_accuracy30: 0.4244 - val_accuracy50: 0.3988 - 30s/epoch - 34ms/step
Epoch 15/50
878/878 - 29s - loss: 12.1719 - accuracy10: 0.5215 - accuracy20: 0.4913 - accuracy30: 0.4665 - accuracy50: 0.4428 - val_loss: 12.6188 - val_accuracy10: 0.4907 - val_accuracy20: 0.4556 - val_accuracy30: 0.4249 - val_accuracy50: 0.3965 - 29s/epoch - 33ms/step
Epoch 16/50
878/878 - 29s - loss: 12.1582 - accuracy10: 0.5234 - accuracy20: 0.4920 - accuracy30: 0.4679 - accuracy50: 0.4446 - val_loss: 12.6542 - val_accuracy10: 0.4855 - val_accuracy20: 0.4520 - val_accuracy30: 0.4236 - val_accuracy50: 0.3963 - 29s/epoch - 33ms/step
Epoch 17/50
878/878 - 30s - loss: 12.1447 - accuracy10: 0.5247 - accuracy20: 0.4931 - accuracy30: 0.4694 - accuracy50: 0.4454 - val_loss: 12.6203 - val_accuracy10: 0.4885 - val_accuracy20: 0.4536 - val_accuracy30: 0.4245 - val_accuracy50: 0.3941 - 30s/epoch - 34ms/step
testing model: results/PCAR/W3/deepVOL_L2/seq2seq
Evaluating performance on  test set...
2282/2282 - 32s - 32s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0101357
{'0': {'precision': 0.4912282581329448, 'recall': 0.48876191897495486, 'f1-score': 0.48999198503873903, 'support': 187621}, '1': {'precision': 0.5076411886416713, 'recall': 0.44170825650877005, 'f1-score': 0.4723851802144765, 'support': 207182}, '2': {'precision': 0.47736162880166605, 'recall': 0.5476341494354942, 'f1-score': 0.5100889879010918, 'support': 189192}, 'accuracy': 0.4911411912773226, 'macro avg': {'precision': 0.49207702519209406, 'recall': 0.4927014416397397, 'f1-score': 0.4908220510514358, 'support': 583995}, 'weighted avg': {'precision': 0.4925587634150374, 'recall': 0.4911411912773226, 'f1-score': 0.4902563351246711, 'support': 583995}}
[[ 91702  45612  50307]
 [ 52540  91514  63128]
 [ 42437  43147 103608]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0368326
{'0': {'precision': 0.48027016787819954, 'recall': 0.42548850966530666, 'f1-score': 0.4512226998948873, 'support': 190682}, '1': {'precision': 0.4416185258964143, 'recall': 0.44586624565708166, 'f1-score': 0.44373222046251193, 'support': 198887}, '2': {'precision': 0.46458324582405736, 'recall': 0.5119839939102795, 'f1-score': 0.487133248019888, 'support': 194426}, 'accuracy': 0.46122483925376073, 'macro avg': {'precision': 0.46215731319955705, 'recall': 0.4611129164108893, 'f1-score': 0.4606960561257624, 'support': 583995}, 'weighted avg': {'precision': 0.4618843004887014, 'recall': 0.46122483925376073, 'f1-score': 0.46062720720553985, 'support': 583995}}
[[81133 56814 52735]
 [48225 88677 61985]
 [39574 55309 99543]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.059968
{'0': {'precision': 0.47939837749651737, 'recall': 0.33041187887002865, 'f1-score': 0.3912000802424294, 'support': 194766}, '1': {'precision': 0.37638027173486216, 'recall': 0.5030017737754128, 'f1-score': 0.43057495945769897, 'support': 190554}, '2': {'precision': 0.46109134896308523, 'recall': 0.4527897319743299, 'f1-score': 0.45690283488202593, 'support': 198675}, 'accuracy': 0.4283598318478754, 'macro avg': {'precision': 0.4389566660648216, 'recall': 0.4287344615399238, 'f1-score': 0.42622595819405146, 'support': 583995}, 'weighted avg': {'precision': 0.4395561510747396, 'recall': 0.4283598318478754, 'f1-score': 0.42639992872059845, 'support': 583995}}
[[64353 81450 48963]
 [38528 95849 56177]
 [31356 77361 89958]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0968544
{'0': {'precision': 0.490329448677723, 'recall': 0.20616851756745933, 'f1-score': 0.29028224188086066, 'support': 212239}, '1': {'precision': 0.28537566951735566, 'recall': 0.6127925374746621, 'f1-score': 0.3894060807223053, 'support': 157373}, '2': {'precision': 0.47883947074764865, 'recall': 0.35027963971023823, 'f1-score': 0.4045925734359173, 'support': 214383}, 'accuracy': 0.36864699184068356, 'macro avg': {'precision': 0.41818152964757577, 'recall': 0.38974689825078657, 'f1-score': 0.3614269653463611, 'support': 583995}, 'weighted avg': {'precision': 0.430881256439112, 'recall': 0.36864699184068356, 'f1-score': 0.3589568156353661, 'support': 583995}}
[[ 43757 124780  43702]
 [ 22907  96437  38029]
 [ 22576 116713  75094]]
Evaluating performance on  train set...
878/878 - 13s - 13s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0014035
{'0': {'precision': 0.508912810718523, 'recall': 0.47314966773386424, 'f1-score': 0.4903800574408164, 'support': 74338}, '1': {'precision': 0.5247090435261172, 'recall': 0.4367909019861482, 'f1-score': 0.4767304199480855, 'support': 74214}, '2': {'precision': 0.4773361747469366, 'recall': 0.5879697077082595, 'f1-score': 0.5269082162537271, 'support': 76191}, 'accuracy': 0.5000689676652887, 'macro avg': {'precision': 0.5036526763305257, 'recall': 0.499303425809424, 'f1-score': 0.49800623121420967, 'support': 224743}, 'weighted avg': {'precision': 0.5034240798137636, 'recall': 0.5000689676652887, 'f1-score': 0.4982562660489997, 'support': 224743}}
[[35173 14349 24816]
 [17562 32416 24236]
 [16379 15014 44798]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0340393
{'0': {'precision': 0.48573110206159326, 'recall': 0.4108142288235927, 'f1-score': 0.4451425739110152, 'support': 74328}, '1': {'precision': 0.45894222569128257, 'recall': 0.428430711105114, 'f1-score': 0.44316191300342656, 'support': 74110}, '2': {'precision': 0.4590165702942953, 'recall': 0.5576174562610576, 'f1-score': 0.5035354820385678, 'support': 76305}, 'accuracy': 0.46646614132587, 'macro avg': {'precision': 0.4678966326823904, 'recall': 0.46562079872992146, 'f1-score': 0.4639466563176698, 'support': 224743}, 'weighted avg': {'precision': 0.46782720305558456, 'recall': 0.46646614132587, 'f1-score': 0.46431506904906844, 'support': 224743}}
[[30535 18785 25008]
 [17220 31751 25139]
 [15109 18647 42549]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0565284
{'0': {'precision': 0.4781961659715287, 'recall': 0.3281201714431591, 'f1-score': 0.3891916873844585, 'support': 74427}, '1': {'precision': 0.3993358333709845, 'recall': 0.4773761460457203, 'f1-score': 0.43488261957918944, 'support': 74059}, '2': {'precision': 0.44754645180991753, 'recall': 0.4996918315695608, 'f1-score': 0.4721838425269054, 'support': 76257}, 'accuracy': 0.4355196824817681, 'macro avg': {'precision': 0.44169281705081026, 'recall': 0.4350627163528134, 'f1-score': 0.4320860498301844, 'support': 224743}, 'weighted avg': {'precision': 0.44180983747682273, 'recall': 0.4355196824817681, 'f1-score': 0.4324079723059339, 'support': 224743}}
[[24421 27207 22799]
 [14467 35354 24238]
 [12181 25971 38105]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0802866
{'0': {'precision': 0.4646758922068463, 'recall': 0.21385570438303636, 'f1-score': 0.2929077753700371, 'support': 74583}, '1': {'precision': 0.36228394247262174, 'recall': 0.592187205133044, 'f1-score': 0.4495471987720645, 'support': 74186}, '2': {'precision': 0.4359689967319316, 'recall': 0.3968331271224366, 'f1-score': 0.41548150598092715, 'support': 75974}, 'accuracy': 0.40059534668488006, 'macro avg': {'precision': 0.4209762771371332, 'recall': 0.40095867887950565, 'f1-score': 0.38597882670767625, 'support': 224743}, 'weighted avg': {'precision': 0.42117274924001596, 'recall': 0.40059534668488006, 'f1-score': 0.3860491362753136, 'support': 224743}}
[[15950 39659 18974]
 [10223 43932 20031]
 [ 8152 37673 30149]]
Evaluating performance on  val set...
303/303 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0077231
{'0': {'precision': 0.5001037129226301, 'recall': 0.48260538852636214, 'f1-score': 0.4911987613071469, 'support': 24979}, '1': {'precision': 0.5143875157856757, 'recall': 0.42218849485451987, 'f1-score': 0.46374984751758636, 'support': 27014}, '2': {'precision': 0.47076230299131555, 'recall': 0.5768109088042879, 'f1-score': 0.5184188155284783, 'support': 25374}, 'accuracy': 0.492406323109336, 'macro avg': {'precision': 0.4950845105665404, 'recall': 0.4938682640617233, 'f1-score': 0.49112247478440385, 'support': 77367}, 'weighted avg': {'precision': 0.4954680635494495, 'recall': 0.492406323109336, 'f1-score': 0.4905418494287087, 'support': 77367}}
[[12055  5396  7528]
 [ 6683 11405  8926]
 [ 5367  5371 14636]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0377703
{'0': {'precision': 0.4847927115446556, 'recall': 0.4179791327805768, 'f1-score': 0.4489135066041755, 'support': 25207}, '1': {'precision': 0.4467498201007436, 'recall': 0.42161856253537067, 'f1-score': 0.43382053223082745, 'support': 26505}, '2': {'precision': 0.4517635532331809, 'recall': 0.5391931397388423, 'f1-score': 0.49162150155486445, 'support': 25655}, 'accuracy': 0.45942068323703905, 'macro avg': {'precision': 0.46110202829286, 'recall': 0.45959694501826326, 'f1-score': 0.4581185134632891, 'support': 77367}, 'weighted avg': {'precision': 0.46080716351769624, 'recall': 0.45942068323703905, 'f1-score': 0.45790486370338235, 'support': 77367}}
[[10536  6988  7683]
 [ 6226 11175  9104]
 [ 4971  6851 13833]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0573425
{'0': {'precision': 0.4760359316140249, 'recall': 0.3250237416904084, 'f1-score': 0.38629576504338425, 'support': 25272}, '1': {'precision': 0.3978424625685855, 'recall': 0.4852540834845735, 'f1-score': 0.437222137053503, 'support': 26448}, '2': {'precision': 0.4441532330449144, 'recall': 0.48235661090965803, 'f1-score': 0.46246728971962614, 'support': 25647}, 'accuracy': 0.43195419235591404, 'macro avg': {'precision': 0.4393438757425083, 'recall': 0.4308781453615466, 'f1-score': 0.4286617306055045, 'support': 77367}, 'weighted avg': {'precision': 0.438736353764092, 'recall': 0.43195419235591404, 'f1-score': 0.42895570765839064, 'support': 77367}}
[[ 8214  9992  7066]
 [ 5198 12834  8416]
 [ 3843  9433 12371]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0766633
{'0': {'precision': 0.46741397288842546, 'recall': 0.2110984655233311, 'f1-score': 0.29084322366108845, 'support': 25481}, '1': {'precision': 0.36842469386343196, 'recall': 0.6088878725512615, 'f1-score': 0.45907386388126603, 'support': 26238}, '2': {'precision': 0.4423897581792319, 'recall': 0.3880224578914535, 'f1-score': 0.41342638750415417, 'support': 25648}, 'accuracy': 0.40465573177194414, 'macro avg': {'precision': 0.42607614164369645, 'recall': 0.40266959865534874, 'f1-score': 0.3877811583488362, 'support': 77367}, 'weighted avg': {'precision': 0.42554726276758353, 'recall': 0.40465573177194414, 'f1-score': 0.38853408054249744, 'support': 77367}}
[[ 5379 14282  5820]
 [ 3538 15976  6724]
 [ 2591 13105  9952]]
training model: results/PCAR/W3/deepVOL_L3/seq2seq
Epoch 1/50
878/878 - 47s - loss: 13.0771 - accuracy10: 0.3906 - accuracy20: 0.3853 - accuracy30: 0.3803 - accuracy50: 0.3796 - val_loss: 13.0630 - val_accuracy10: 0.3837 - val_accuracy20: 0.3767 - val_accuracy30: 0.3718 - val_accuracy50: 0.3638 - 47s/epoch - 54ms/step
Epoch 2/50
878/878 - 41s - loss: 12.8405 - accuracy10: 0.4308 - accuracy20: 0.4172 - accuracy30: 0.4056 - accuracy50: 0.3962 - val_loss: 12.9235 - val_accuracy10: 0.4268 - val_accuracy20: 0.4124 - val_accuracy30: 0.4007 - val_accuracy50: 0.3899 - 41s/epoch - 46ms/step
Epoch 3/50
878/878 - 41s - loss: 12.6316 - accuracy10: 0.4670 - accuracy20: 0.4452 - accuracy30: 0.4278 - accuracy50: 0.4104 - val_loss: 12.8578 - val_accuracy10: 0.4374 - val_accuracy20: 0.4203 - val_accuracy30: 0.4063 - val_accuracy50: 0.3922 - 41s/epoch - 47ms/step
Epoch 4/50
878/878 - 41s - loss: 12.5039 - accuracy10: 0.4830 - accuracy20: 0.4593 - accuracy30: 0.4413 - accuracy50: 0.4205 - val_loss: 13.0475 - val_accuracy10: 0.4338 - val_accuracy20: 0.4141 - val_accuracy30: 0.3979 - val_accuracy50: 0.3815 - 41s/epoch - 47ms/step
Epoch 5/50
878/878 - 40s - loss: 12.4339 - accuracy10: 0.4939 - accuracy20: 0.4672 - accuracy30: 0.4473 - accuracy50: 0.4257 - val_loss: 12.6316 - val_accuracy10: 0.4767 - val_accuracy20: 0.4496 - val_accuracy30: 0.4278 - val_accuracy50: 0.4021 - 40s/epoch - 45ms/step
Epoch 6/50
878/878 - 41s - loss: 12.3787 - accuracy10: 0.5010 - accuracy20: 0.4731 - accuracy30: 0.4517 - accuracy50: 0.4294 - val_loss: 12.6068 - val_accuracy10: 0.4803 - val_accuracy20: 0.4532 - val_accuracy30: 0.4297 - val_accuracy50: 0.4024 - 41s/epoch - 47ms/step
Epoch 7/50
878/878 - 41s - loss: 12.3368 - accuracy10: 0.5052 - accuracy20: 0.4757 - accuracy30: 0.4548 - accuracy50: 0.4323 - val_loss: 12.5715 - val_accuracy10: 0.4876 - val_accuracy20: 0.4562 - val_accuracy30: 0.4330 - val_accuracy50: 0.4064 - 41s/epoch - 46ms/step
Epoch 8/50
878/878 - 40s - loss: 12.3025 - accuracy10: 0.5100 - accuracy20: 0.4798 - accuracy30: 0.4569 - accuracy50: 0.4351 - val_loss: 12.5619 - val_accuracy10: 0.4914 - val_accuracy20: 0.4583 - val_accuracy30: 0.4331 - val_accuracy50: 0.4031 - 40s/epoch - 46ms/step
Epoch 9/50
878/878 - 40s - loss: 12.2700 - accuracy10: 0.5133 - accuracy20: 0.4828 - accuracy30: 0.4593 - accuracy50: 0.4370 - val_loss: 12.5551 - val_accuracy10: 0.4911 - val_accuracy20: 0.4591 - val_accuracy30: 0.4333 - val_accuracy50: 0.4048 - 40s/epoch - 46ms/step
Epoch 10/50
878/878 - 40s - loss: 12.2468 - accuracy10: 0.5154 - accuracy20: 0.4847 - accuracy30: 0.4611 - accuracy50: 0.4390 - val_loss: 12.5585 - val_accuracy10: 0.4926 - val_accuracy20: 0.4608 - val_accuracy30: 0.4347 - val_accuracy50: 0.4071 - 40s/epoch - 46ms/step
Epoch 11/50
878/878 - 40s - loss: 12.2261 - accuracy10: 0.5163 - accuracy20: 0.4862 - accuracy30: 0.4620 - accuracy50: 0.4405 - val_loss: 12.5463 - val_accuracy10: 0.4912 - val_accuracy20: 0.4619 - val_accuracy30: 0.4350 - val_accuracy50: 0.4071 - 40s/epoch - 46ms/step
Epoch 12/50
878/878 - 40s - loss: 12.2002 - accuracy10: 0.5200 - accuracy20: 0.4885 - accuracy30: 0.4641 - accuracy50: 0.4420 - val_loss: 12.5538 - val_accuracy10: 0.4944 - val_accuracy20: 0.4627 - val_accuracy30: 0.4365 - val_accuracy50: 0.4093 - 40s/epoch - 46ms/step
Epoch 13/50
878/878 - 40s - loss: 12.1812 - accuracy10: 0.5211 - accuracy20: 0.4899 - accuracy30: 0.4653 - accuracy50: 0.4432 - val_loss: 12.5697 - val_accuracy10: 0.4932 - val_accuracy20: 0.4602 - val_accuracy30: 0.4338 - val_accuracy50: 0.4073 - 40s/epoch - 45ms/step
Epoch 14/50
878/878 - 39s - loss: 12.1668 - accuracy10: 0.5220 - accuracy20: 0.4912 - accuracy30: 0.4667 - accuracy50: 0.4450 - val_loss: 12.5676 - val_accuracy10: 0.4939 - val_accuracy20: 0.4613 - val_accuracy30: 0.4331 - val_accuracy50: 0.4060 - 39s/epoch - 45ms/step
Epoch 15/50
878/878 - 40s - loss: 12.1451 - accuracy10: 0.5241 - accuracy20: 0.4928 - accuracy30: 0.4691 - accuracy50: 0.4458 - val_loss: 12.5855 - val_accuracy10: 0.4913 - val_accuracy20: 0.4581 - val_accuracy30: 0.4332 - val_accuracy50: 0.4076 - 40s/epoch - 46ms/step
Epoch 16/50
878/878 - 40s - loss: 12.1289 - accuracy10: 0.5255 - accuracy20: 0.4940 - accuracy30: 0.4690 - accuracy50: 0.4468 - val_loss: 12.5906 - val_accuracy10: 0.4919 - val_accuracy20: 0.4582 - val_accuracy30: 0.4334 - val_accuracy50: 0.4058 - 40s/epoch - 46ms/step
Epoch 17/50
878/878 - 40s - loss: 12.1124 - accuracy10: 0.5269 - accuracy20: 0.4962 - accuracy30: 0.4713 - accuracy50: 0.4483 - val_loss: 12.6018 - val_accuracy10: 0.4895 - val_accuracy20: 0.4564 - val_accuracy30: 0.4288 - val_accuracy50: 0.4028 - 40s/epoch - 46ms/step
Epoch 18/50
878/878 - 40s - loss: 12.0918 - accuracy10: 0.5279 - accuracy20: 0.4974 - accuracy30: 0.4727 - accuracy50: 0.4498 - val_loss: 12.6327 - val_accuracy10: 0.4872 - val_accuracy20: 0.4540 - val_accuracy30: 0.4276 - val_accuracy50: 0.4015 - 40s/epoch - 45ms/step
Epoch 19/50
878/878 - 40s - loss: 12.0791 - accuracy10: 0.5290 - accuracy20: 0.4989 - accuracy30: 0.4732 - accuracy50: 0.4512 - val_loss: 12.6311 - val_accuracy10: 0.4877 - val_accuracy20: 0.4552 - val_accuracy30: 0.4295 - val_accuracy50: 0.4035 - 40s/epoch - 46ms/step
Epoch 20/50
878/878 - 40s - loss: 12.0608 - accuracy10: 0.5302 - accuracy20: 0.4992 - accuracy30: 0.4746 - accuracy50: 0.4514 - val_loss: 12.5968 - val_accuracy10: 0.4903 - val_accuracy20: 0.4586 - val_accuracy30: 0.4341 - val_accuracy50: 0.4069 - 40s/epoch - 45ms/step
Epoch 21/50
878/878 - 40s - loss: 12.0457 - accuracy10: 0.5303 - accuracy20: 0.5003 - accuracy30: 0.4761 - accuracy50: 0.4531 - val_loss: 12.6446 - val_accuracy10: 0.4896 - val_accuracy20: 0.4569 - val_accuracy30: 0.4310 - val_accuracy50: 0.4062 - 40s/epoch - 46ms/step
testing model: results/PCAR/W3/deepVOL_L3/seq2seq
Evaluating performance on  test set...
2282/2282 - 49s - 49s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0150394
{'0': {'precision': 0.5083266613290632, 'recall': 0.4060739469462374, 'f1-score': 0.45148310671672087, 'support': 187621}, '1': {'precision': 0.5317428616386458, 'recall': 0.42408124257898855, 'f1-score': 0.47184868534112395, 'support': 207182}, '2': {'precision': 0.4555063392355726, 'recall': 0.6473688105205294, 'f1-score': 0.5347488282435332, 'support': 189192}, 'accuracy': 0.490632625279326, 'macro avg': {'precision': 0.4985252874010939, 'recall': 0.49250800001525175, 'f1-score': 0.4860268734337927, 'support': 583995}, 'weighted avg': {'precision': 0.49952219011788546, 'recall': 0.490632625279326, 'f1-score': 0.48568303941762025, 'support': 583995}}
[[ 76188  44000  67433]
 [ 40349  87862  78971]
 [ 33343  33372 122477]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.036443
{'0': {'precision': 0.49456979411679297, 'recall': 0.3572754638612979, 'f1-score': 0.41485856955820116, 'support': 190682}, '1': {'precision': 0.47048509643483344, 'recall': 0.4128474963170041, 'f1-score': 0.4397858648291819, 'support': 198887}, '2': {'precision': 0.44248044898334715, 'recall': 0.618399802495551, 'f1-score': 0.5158543047210025, 'support': 194426}, 'accuracy': 0.4631358145189599, 'macro avg': {'precision': 0.4691784465116579, 'recall': 0.4628409208912843, 'f1-score': 0.45683291303612855, 'support': 583995}, 'weighted avg': {'precision': 0.46902564342237396, 'recall': 0.4631358145189599, 'f1-score': 0.4569717927524448, 'support': 583995}}
[[ 68126  50267  72289]
 [ 37574  82110  79203]
 [ 32048  42145 120233]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0576874
{'0': {'precision': 0.4902442187162308, 'recall': 0.2911647823542097, 'f1-score': 0.3653447837109145, 'support': 194766}, '1': {'precision': 0.40274715957266405, 'recall': 0.43622805084123134, 'f1-score': 0.41881954608778454, 'support': 190554}, '2': {'precision': 0.43644172950272025, 'recall': 0.5753869384673461, 'f1-score': 0.4963742943986106, 'support': 198675}, 'accuracy': 0.4351903697805632, 'macro avg': {'precision': 0.4431443692638717, 'recall': 0.4342599238875957, 'f1-score': 0.42684620806576995, 'support': 583995}, 'weighted avg': {'precision': 0.44339086525851723, 'recall': 0.4351903697805632, 'f1-score': 0.4273694892406539, 'support': 583995}}
[[ 56709  66317  71740]
 [ 31559  83125  75870]
 [ 27407  56953 114315]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0935894
{'0': {'precision': 0.4973772568137554, 'recall': 0.1961279500939978, 'f1-score': 0.28132328591220895, 'support': 212239}, '1': {'precision': 0.2973076647307665, 'recall': 0.5269709543568465, 'f1-score': 0.3801445292714175, 'support': 157373}, '2': {'precision': 0.4534657848611337, 'recall': 0.4682320892981253, 'f1-score': 0.4607306533378314, 'support': 214383}, 'accuracy': 0.3851711059170027, 'macro avg': {'precision': 0.41605023546855185, 'recall': 0.3971103312496565, 'f1-score': 0.3740661561738193, 'support': 583995}, 'weighted avg': {'precision': 0.42734339521135284, 'recall': 0.3851711059170027, 'f1-score': 0.37381326473390425, 'support': 583995}}
[[ 41626 104104  66509]
 [ 19968  82931  54474]
 [ 22097  91905 100381]]
Evaluating performance on  train set...
878/878 - 18s - 18s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.99949926
{'0': {'precision': 0.5178251121076233, 'recall': 0.43494578815679735, 'f1-score': 0.4727807103481554, 'support': 74338}, '1': {'precision': 0.546545397631428, 'recall': 0.4234780499636187, 'f1-score': 0.47720491660150166, 'support': 74214}, '2': {'precision': 0.4670992366412214, 'recall': 0.6424905828772427, 'f1-score': 0.5409329745677962, 'support': 76191}, 'accuracy': 0.50151951339975, 'macro avg': {'precision': 0.5104899154600909, 'recall': 0.5003048069992196, 'f1-score': 0.49697286717248446, 'support': 224743}, 'weighted avg': {'precision': 0.5101122671789848, 'recall': 0.50151951339975, 'f1-score': 0.49734622387269, 'support': 224743}}
[[32333 13746 28259]
 [15197 31428 27589]
 [14910 12329 48952]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0307829
{'0': {'precision': 0.49206987602077396, 'recall': 0.3785921859864385, 'f1-score': 0.42793597688476603, 'support': 74328}, '1': {'precision': 0.4804283126293996, 'recall': 0.4007826204290919, 'f1-score': 0.43700619418247094, 'support': 74110}, '2': {'precision': 0.4470359020920819, 'recall': 0.619435161522836, 'f1-score': 0.5193010212209606, 'support': 76305}, 'accuracy': 0.4676808621403114, 'macro avg': {'precision': 0.4731780302474185, 'recall': 0.4662699893127888, 'f1-score': 0.46141439742939916, 'support': 224743}, 'weighted avg': {'precision': 0.4729410326594074, 'recall': 0.4676808621403114, 'f1-score': 0.4619472854105321, 'support': 224743}}
[[28140 17033 29155]
 [15097 29702 29311]
 [13950 15089 47266]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.05278
{'0': {'precision': 0.48156963387627544, 'recall': 0.3126284815994196, 'f1-score': 0.379130548132699, 'support': 74427}, '1': {'precision': 0.4206903055450773, 'recall': 0.4216503058372379, 'f1-score': 0.4211697586437112, 'support': 74059}, '2': {'precision': 0.4329732480087673, 'recall': 0.5802614841916152, 'f1-score': 0.4959121347118321, 'support': 76257}, 'accuracy': 0.43936407363076935, 'macro avg': {'precision': 0.44507772914337335, 'recall': 0.4381800905427575, 'f1-score': 0.4320708138294141, 'support': 224743}, 'weighted avg': {'precision': 0.44501909938141343, 'recall': 0.43936407363076935, 'f1-score': 0.43260850001106677, 'support': 224743}}
[[23268 22895 28264]
 [13147 31227 29685]
 [11902 20106 44249]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0765903
{'0': {'precision': 0.457457821549481, 'recall': 0.21921885684405293, 'f1-score': 0.29639969544251477, 'support': 74583}, '1': {'precision': 0.37500746372629024, 'recall': 0.5079529830426226, 'f1-score': 0.4314715581203627, 'support': 74186}, '2': {'precision': 0.4196755388856252, 'recall': 0.4889567483612815, 'f1-score': 0.45167487385251387, 'support': 75974}, 'accuracy': 0.4057123024966295, 'macro avg': {'precision': 0.4173802747204655, 'recall': 0.40537619608265235, 'f1-score': 0.3931820424717971, 'support': 224743}, 'weighted avg': {'precision': 0.4174693307463191, 'recall': 0.4057123024966295, 'f1-score': 0.393476434691969, 'support': 224743}}
[[16350 33138 25095]
 [10230 37683 26273]
 [ 9161 29665 37148]]
Evaluating performance on  val set...
303/303 - 6s - 6s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0121037
{'0': {'precision': 0.5103820991751209, 'recall': 0.43100204171504064, 'f1-score': 0.46734529985023765, 'support': 24979}, '1': {'precision': 0.5382826033160109, 'recall': 0.40260605611904937, 'f1-score': 0.46066202164382974, 'support': 27014}, '2': {'precision': 0.4561661306421204, 'recall': 0.6484196421533853, 'f1-score': 0.5355619934246932, 'support': 25374}, 'accuracy': 0.4923933977018626, 'macro avg': {'precision': 0.5016102777110841, 'recall': 0.49400924666249174, 'f1-score': 0.4878564383062535, 'support': 77367}, 'weighted avg': {'precision': 0.502342860653602, 'recall': 0.4923933977018626, 'f1-score': 0.48738470043821874, 'support': 77367}}
[[10766  5080  9133]
 [ 5656 10876 10482]
 [ 4672  4249 16453]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0380834
{'0': {'precision': 0.4922028297015388, 'recall': 0.378148926885389, 'f1-score': 0.42770286945011554, 'support': 25207}, '1': {'precision': 0.4739084132055378, 'recall': 0.38615355593284284, 'f1-score': 0.4255540310174213, 'support': 26505}, '2': {'precision': 0.43769915393912756, 'recall': 0.6210875073085168, 'f1-score': 0.5135113359867223, 'support': 25655}, 'accuracy': 0.4614499722103739, 'macro avg': {'precision': 0.4679367989487347, 'recall': 0.46179666337558284, 'f1-score': 0.4555894121514197, 'support': 77367}, 'weighted avg': {'precision': 0.4678618922099575, 'recall': 0.4614499722103739, 'f1-score': 0.45542090487010184, 'support': 77367}}
[[ 9532  6087  9588]
 [ 5388 10235 10882]
 [ 4446  5275 15934]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0549513
{'0': {'precision': 0.4831785472661295, 'recall': 0.31085786641342195, 'f1-score': 0.37831980929907777, 'support': 25272}, '1': {'precision': 0.4214597533889867, 'recall': 0.4161373260738052, 'f1-score': 0.418781629313953, 'support': 26448}, '2': {'precision': 0.42364405326627425, 'recall': 0.5780403166062308, 'f1-score': 0.4889431242888475, 'support': 25647}, 'accuracy': 0.4354182015588041, 'macro avg': {'precision': 0.4427607846404635, 'recall': 0.4350118363644859, 'f1-score': 0.4286815209672928, 'support': 77367}, 'weighted avg': {'precision': 0.4423443436899671, 'recall': 0.4354182015588041, 'f1-score': 0.42882312951694906, 'support': 77367}}
[[ 7856  8014  9402]
 [ 4675 11006 10767]
 [ 3728  7094 14825]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.075776
{'0': {'precision': 0.47480173957533894, 'recall': 0.21851575683842864, 'f1-score': 0.2992904751666308, 'support': 25481}, '1': {'precision': 0.38121500793849755, 'recall': 0.5216098788017379, 'f1-score': 0.4404963066673104, 'support': 26238}, '2': {'precision': 0.4146070816100071, 'recall': 0.48073923892701187, 'f1-score': 0.4452308303392494, 'support': 25648}, 'accuracy': 0.40823606964209547, 'macro avg': {'precision': 0.42354127637461453, 'recall': 0.40695495818905947, 'f1-score': 0.39500587072439686, 'support': 77367}, 'weighted avg': {'precision': 0.4231078487409744, 'recall': 0.40823606964209547, 'f1-score': 0.395559386154289, 'support': 77367}}
[[ 5568 11725  8188]
 [ 3331 13686  9221]
 [ 2828 10490 12330]]
training model: results/PCAR/W4/deepLOB_L1/seq2seq
Epoch 1/50
538/538 - 22s - loss: 12.9873 - accuracy10: 0.4146 - accuracy20: 0.4054 - accuracy30: 0.3944 - accuracy50: 0.3918 - val_loss: 13.2797 - val_accuracy10: 0.3750 - val_accuracy20: 0.3623 - val_accuracy30: 0.3560 - val_accuracy50: 0.3418 - 22s/epoch - 40ms/step
Epoch 2/50
538/538 - 16s - loss: 12.8694 - accuracy10: 0.4378 - accuracy20: 0.4212 - accuracy30: 0.4074 - accuracy50: 0.4017 - val_loss: 13.1526 - val_accuracy10: 0.3855 - val_accuracy20: 0.3784 - val_accuracy30: 0.3700 - val_accuracy50: 0.3543 - 16s/epoch - 29ms/step
Epoch 3/50
538/538 - 15s - loss: 12.8114 - accuracy10: 0.4454 - accuracy20: 0.4274 - accuracy30: 0.4126 - accuracy50: 0.4058 - val_loss: 12.9472 - val_accuracy10: 0.3976 - val_accuracy20: 0.3814 - val_accuracy30: 0.3740 - val_accuracy50: 0.3495 - 15s/epoch - 29ms/step
Epoch 4/50
538/538 - 16s - loss: 12.7758 - accuracy10: 0.4513 - accuracy20: 0.4321 - accuracy30: 0.4170 - accuracy50: 0.4087 - val_loss: 12.9251 - val_accuracy10: 0.3999 - val_accuracy20: 0.3885 - val_accuracy30: 0.3773 - val_accuracy50: 0.3545 - 16s/epoch - 29ms/step
Epoch 5/50
538/538 - 16s - loss: 12.7459 - accuracy10: 0.4545 - accuracy20: 0.4358 - accuracy30: 0.4199 - accuracy50: 0.4119 - val_loss: 12.9870 - val_accuracy10: 0.4072 - val_accuracy20: 0.3973 - val_accuracy30: 0.3886 - val_accuracy50: 0.3707 - 16s/epoch - 29ms/step
Epoch 6/50
538/538 - 15s - loss: 12.7313 - accuracy10: 0.4565 - accuracy20: 0.4363 - accuracy30: 0.4209 - accuracy50: 0.4125 - val_loss: 12.9961 - val_accuracy10: 0.4038 - val_accuracy20: 0.3937 - val_accuracy30: 0.3856 - val_accuracy50: 0.3689 - 15s/epoch - 29ms/step
Epoch 7/50
538/538 - 16s - loss: 12.7088 - accuracy10: 0.4597 - accuracy20: 0.4391 - accuracy30: 0.4224 - accuracy50: 0.4138 - val_loss: 13.0633 - val_accuracy10: 0.4035 - val_accuracy20: 0.3951 - val_accuracy30: 0.3846 - val_accuracy50: 0.3655 - 16s/epoch - 29ms/step
Epoch 8/50
538/538 - 16s - loss: 12.6959 - accuracy10: 0.4596 - accuracy20: 0.4403 - accuracy30: 0.4242 - accuracy50: 0.4163 - val_loss: 13.0770 - val_accuracy10: 0.4122 - val_accuracy20: 0.3986 - val_accuracy30: 0.3882 - val_accuracy50: 0.3696 - 16s/epoch - 29ms/step
Epoch 9/50
538/538 - 16s - loss: 12.6771 - accuracy10: 0.4624 - accuracy20: 0.4427 - accuracy30: 0.4264 - accuracy50: 0.4168 - val_loss: 13.1354 - val_accuracy10: 0.4102 - val_accuracy20: 0.3976 - val_accuracy30: 0.3842 - val_accuracy50: 0.3704 - 16s/epoch - 29ms/step
Epoch 10/50
538/538 - 16s - loss: 12.6618 - accuracy10: 0.4648 - accuracy20: 0.4450 - accuracy30: 0.4286 - accuracy50: 0.4183 - val_loss: 13.2631 - val_accuracy10: 0.4053 - val_accuracy20: 0.3902 - val_accuracy30: 0.3804 - val_accuracy50: 0.3649 - 16s/epoch - 30ms/step
Epoch 11/50
538/538 - 16s - loss: 12.6515 - accuracy10: 0.4672 - accuracy20: 0.4468 - accuracy30: 0.4294 - accuracy50: 0.4184 - val_loss: 13.3679 - val_accuracy10: 0.3955 - val_accuracy20: 0.3870 - val_accuracy30: 0.3796 - val_accuracy50: 0.3705 - 16s/epoch - 29ms/step
Epoch 12/50
538/538 - 15s - loss: 12.6282 - accuracy10: 0.4689 - accuracy20: 0.4484 - accuracy30: 0.4308 - accuracy50: 0.4200 - val_loss: 13.2751 - val_accuracy10: 0.4001 - val_accuracy20: 0.3933 - val_accuracy30: 0.3821 - val_accuracy50: 0.3764 - 15s/epoch - 29ms/step
Epoch 13/50
538/538 - 16s - loss: 12.6130 - accuracy10: 0.4704 - accuracy20: 0.4494 - accuracy30: 0.4324 - accuracy50: 0.4212 - val_loss: 13.3918 - val_accuracy10: 0.4028 - val_accuracy20: 0.3951 - val_accuracy30: 0.3823 - val_accuracy50: 0.3668 - 16s/epoch - 30ms/step
Epoch 14/50
538/538 - 16s - loss: 12.6079 - accuracy10: 0.4715 - accuracy20: 0.4514 - accuracy30: 0.4347 - accuracy50: 0.4219 - val_loss: 13.1749 - val_accuracy10: 0.4063 - val_accuracy20: 0.3973 - val_accuracy30: 0.3856 - val_accuracy50: 0.3798 - 16s/epoch - 30ms/step
testing model: results/PCAR/W4/deepLOB_L1/seq2seq
Evaluating performance on  test set...
1590/1590 - 24s - 24s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0485168
{'0': {'precision': 0.4405339805825243, 'recall': 0.4120284174424302, 'f1-score': 0.42580465493088493, 'support': 122460}, '1': {'precision': 0.4408437006765123, 'recall': 0.49934687735139205, 'f1-score': 0.46827511459344734, 'support': 166125}, '2': {'precision': 0.3892298250997238, 'recall': 0.3428088843847648, 'f1-score': 0.3645475037943762, 'support': 118410}, 'accuracy': 0.4275310507500092, 'macro avg': {'precision': 0.4235358354529201, 'recall': 0.418061393059529, 'f1-score': 0.4195424244395695, 'support': 406995}, 'weighted avg': {'precision': 0.42573411129640376, 'recall': 0.4275310507500092, 'f1-score': 0.4253180294081369, 'support': 406995}}
[[50457 47579 24424]
 [43899 82954 39272]
 [20180 57638 40592]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0594411
{'0': {'precision': 0.43385579387088846, 'recall': 0.3944892633998037, 'f1-score': 0.41323709496085964, 'support': 125319}, '1': {'precision': 0.4244617313864269, 'recall': 0.4958596630622354, 'f1-score': 0.45739119481010265, 'support': 161098}, '2': {'precision': 0.38022527205272244, 'recall': 0.3306324536814344, 'f1-score': 0.35369894734040425, 'support': 120578}, 'accuracy': 0.41569552451504316, 'macro avg': {'precision': 0.41284759910334595, 'recall': 0.4069937933811578, 'f1-score': 0.4081090790371222, 'support': 406995}, 'weighted avg': {'precision': 0.41424861015140146, 'recall': 0.41569552451504316, 'f1-score': 0.41307529054983266, 'support': 406995}}
[[49437 49496 26386]
 [42618 79882 38598]
 [21893 58818 39867]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0695863
{'0': {'precision': 0.4383131863061733, 'recall': 0.36580951720844984, 'f1-score': 0.3987927075506152, 'support': 129849}, '1': {'precision': 0.3944757917728431, 'recall': 0.5164251815275452, 'f1-score': 0.44728733055669423, 'support': 151079}, '2': {'precision': 0.3808173262859353, 'recall': 0.3046157995351678, 'f1-score': 0.3384807939781762, 'support': 126067}, 'accuracy': 0.4027641617218885, 'macro avg': {'precision': 0.4045354347883172, 'recall': 0.3956168327570542, 'f1-score': 0.3948536106951619, 'support': 406995}, 'weighted avg': {'precision': 0.4042310960744202, 'recall': 0.4027641617218885, 'f1-score': 0.39811254474959484, 'support': 406995}}
[[47500 55081 27268]
 [37887 78021 35171]
 [22983 64682 38402]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0713425
{'0': {'precision': 0.38405782222130963, 'recall': 0.31186067644288085, 'f1-score': 0.3442142505509471, 'support': 119951}, '1': {'precision': 0.42759138220947845, 'recall': 0.5452397547519758, 'f1-score': 0.4793017236231655, 'support': 169298}, '2': {'precision': 0.3364171841987323, 'recall': 0.2677543186180422, 'f1-score': 0.2981840537217441, 'support': 117746}, 'accuracy': 0.3961793142421897, 'macro avg': {'precision': 0.38268879620984014, 'recall': 0.3749515832709663, 'f1-score': 0.3739000092986189, 'support': 406995}, 'weighted avg': {'precision': 0.3883837969243665, 'recall': 0.3961793142421897, 'f1-score': 0.38708988160373425, 'support': 406995}}
[[37408 57602 24941]
 [39744 92308 37246]
 [20250 65969 31527]]
Evaluating performance on  train set...
538/538 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0561053
{'0': {'precision': 0.450880626223092, 'recall': 0.4997397188964081, 'f1-score': 0.47405456565573434, 'support': 46104}, '1': {'precision': 0.39329386855636694, 'recall': 0.4026364681942847, 'f1-score': 0.39791033683796373, 'support': 45212}, '2': {'precision': 0.4646128639872899, 'recall': 0.40377106120423706, 'f1-score': 0.43206057528048386, 'support': 46353}, 'accuracy': 0.4355374121988247, 'macro avg': {'precision': 0.43626245292224963, 'recall': 0.43538241609830997, 'f1-score': 0.43467515925806066, 'support': 137669}, 'weighted avg': {'precision': 0.43659213665358754, 'recall': 0.4355374121988247, 'f1-score': 0.4349086409437583, 'support': 137669}}
[[23040 12821 10243]
 [15684 18204 11324]
 [12376 15261 18716]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0669329
{'0': {'precision': 0.43512811874516955, 'recall': 0.4777415143603133, 'f1-score': 0.4554402049346097, 'support': 45960}, '1': {'precision': 0.38382857512785656, 'recall': 0.39043396184999013, 'f1-score': 0.38710309255914166, 'support': 45557}, '2': {'precision': 0.44177453691242324, 'recall': 0.391185647425897, 'f1-score': 0.41494386283455337, 'support': 46152}, 'accuracy': 0.419833077889721, 'macro avg': {'precision': 0.4202437435951498, 'recall': 0.41978704121206684, 'f1-score': 0.41916238677610157, 'support': 137669}, 'weighted avg': {'precision': 0.4203803700339939, 'recall': 0.419833077889721, 'f1-score': 0.41925035094358043, 'support': 137669}}
[[21957 13141 10862]
 [15819 17787 11951]
 [12685 15413 18054]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0752944
{'0': {'precision': 0.42788032306957624, 'recall': 0.4458772366342846, 'f1-score': 0.43669343730796123, 'support': 46219}, '1': {'precision': 0.37027226807933966, 'recall': 0.398827822625235, 'f1-score': 0.38401993249358474, 'support': 45215}, '2': {'precision': 0.42424762278208017, 'recall': 0.37441332323996973, 'f1-score': 0.39777570973931226, 'support': 46235}, 'accuracy': 0.40642410419193864, 'macro avg': {'precision': 0.40746673797699867, 'recall': 0.40637279416649646, 'f1-score': 0.4061630265136194, 'support': 137669}, 'weighted avg': {'precision': 0.4077399421256025, 'recall': 0.40642410419193864, 'f1-score': 0.40632353809812805, 'support': 137669}}
[[20608 14264 11347]
 [15036 18033 12146]
 [12519 16405 17311]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0833273
{'0': {'precision': 0.4122572843224496, 'recall': 0.3934411950438778, 'f1-score': 0.4026295264623955, 'support': 45923}, '1': {'precision': 0.3620577098837968, 'recall': 0.42722570705403323, 'f1-score': 0.3919513771100881, 'support': 45435}, '2': {'precision': 0.40525491560814336, 'recall': 0.35203299432100366, 'f1-score': 0.3767737462445112, 'support': 46311}, 'accuracy': 0.3906616594876116, 'macro avg': {'precision': 0.3931899699381299, 'recall': 0.3908999654729716, 'f1-score': 0.3904515499389983, 'support': 137669}, 'weighted avg': {'precision': 0.3933343288121428, 'recall': 0.3906616594876116, 'f1-score': 0.3904076845554119, 'support': 137669}}
[[18068 16120 11735]
 [13833 19411 12191]
 [11926 18082 16303]]
Evaluating performance on  val set...
209/209 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0651399
{'0': {'precision': 0.4762568442010951, 'recall': 0.28214201462609106, 'f1-score': 0.35435724602792495, 'support': 16956}, '1': {'precision': 0.3816207710464201, 'recall': 0.6108816120906801, 'f1-score': 0.469772397094431, 'support': 19850}, '2': {'precision': 0.3887080191912269, 'recall': 0.2719045906748172, 'f1-score': 0.319980252486071, 'support': 16686}, 'accuracy': 0.4009384580871906, 'macro avg': {'precision': 0.415528544812914, 'recall': 0.38830940579719614, 'f1-score': 0.3813699652028089, 'support': 53492}, 'weighted avg': {'precision': 0.4138294579333362, 'recall': 0.4009384580871906, 'f1-score': 0.38646253718231754, 'support': 53492}}
[[ 4784  9349  2823]
 [ 3412 12126  4312]
 [ 1849 10300  4537]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0747546
{'0': {'precision': 0.4603410668253024, 'recall': 0.2696753209037579, 'f1-score': 0.3401091455151449, 'support': 17217}, '1': {'precision': 0.36109530133434514, 'recall': 0.6006732589943193, 'f1-score': 0.4510446700106639, 'support': 19012}, '2': {'precision': 0.3954159592529711, 'recall': 0.269825638649134, 'f1-score': 0.3207657611128327, 'support': 17263}, 'accuracy': 0.38736633515292007, 'macro avg': {'precision': 0.4056174424708729, 'recall': 0.3800580728490704, 'f1-score': 0.3706398588795472, 'support': 53492}, 'weighted avg': {'precision': 0.40411466613855984, 'recall': 0.38736633515292007, 'f1-score': 0.3732950676487666, 'support': 53492}}
[[ 4643  9644  2930]
 [ 3400 11420  4192]
 [ 2043 10562  4658]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0815754
{'0': {'precision': 0.4593855218855219, 'recall': 0.2501289028931538, 'f1-score': 0.32389925442338363, 'support': 17455}, '1': {'precision': 0.3521246287203734, 'recall': 0.6286796536796537, 'f1-score': 0.4514123635233322, 'support': 18480}, '2': {'precision': 0.3886665453883937, 'recall': 0.24337870934669933, 'f1-score': 0.29932401667192043, 'support': 17557}, 'accuracy': 0.3786921408808794, 'macro avg': {'precision': 0.400058898664763, 'recall': 0.37406242197316897, 'f1-score': 0.3582118782062121, 'support': 53492}, 'weighted avg': {'precision': 0.3991186712152904, 'recall': 0.3786921408808794, 'f1-score': 0.35988547305354535, 'support': 53492}}
[[ 4366 10151  2938]
 [ 3079 11618  3783]
 [ 2059 11225  4273]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0869129
{'0': {'precision': 0.42091929062613104, 'recall': 0.1997709705124535, 'f1-score': 0.27094820222101423, 'support': 17465}, '1': {'precision': 0.3383177043732928, 'recall': 0.6436990998714102, 'f1-score': 0.4435256114443932, 'support': 18664}, '2': {'precision': 0.35163021048287246, 'recall': 0.19627944479640616, 'f1-score': 0.2519312511550545, 'support': 17363}, 'accuracy': 0.35352949973827863, 'macro avg': {'precision': 0.37028906849409876, 'recall': 0.3465831717267566, 'f1-score': 0.3221350216068206, 'support': 53492}, 'weighted avg': {'precision': 0.369608023439442, 'recall': 0.35352949973827863, 'f1-score': 0.32498980553341394, 'support': 53492}}
[[ 3489 11387  2589]
 [ 2955 12014  3695]
 [ 1845 12110  3408]]
training model: results/PCAR/W4/deepOF_L1/seq2seq
Epoch 1/50
538/538 - 21s - loss: 13.1207 - accuracy10: 0.3927 - accuracy20: 0.3868 - accuracy30: 0.3811 - accuracy50: 0.3834 - val_loss: 13.0056 - val_accuracy10: 0.4051 - val_accuracy20: 0.3900 - val_accuracy30: 0.3816 - val_accuracy50: 0.3730 - 21s/epoch - 40ms/step
Epoch 2/50
538/538 - 15s - loss: 13.0182 - accuracy10: 0.4051 - accuracy20: 0.3969 - accuracy30: 0.3908 - accuracy50: 0.3913 - val_loss: 12.9663 - val_accuracy10: 0.4129 - val_accuracy20: 0.3992 - val_accuracy30: 0.3916 - val_accuracy50: 0.3804 - 15s/epoch - 28ms/step
Epoch 3/50
538/538 - 15s - loss: 12.9958 - accuracy10: 0.4088 - accuracy20: 0.3979 - accuracy30: 0.3914 - accuracy50: 0.3940 - val_loss: 12.9604 - val_accuracy10: 0.4151 - val_accuracy20: 0.4020 - val_accuracy30: 0.3951 - val_accuracy50: 0.3828 - 15s/epoch - 28ms/step
Epoch 4/50
538/538 - 14s - loss: 12.9818 - accuracy10: 0.4103 - accuracy20: 0.3992 - accuracy30: 0.3933 - accuracy50: 0.3953 - val_loss: 12.9554 - val_accuracy10: 0.4138 - val_accuracy20: 0.4013 - val_accuracy30: 0.3942 - val_accuracy50: 0.3840 - 14s/epoch - 26ms/step
Epoch 5/50
538/538 - 15s - loss: 12.9728 - accuracy10: 0.4106 - accuracy20: 0.4003 - accuracy30: 0.3935 - accuracy50: 0.3948 - val_loss: 12.9492 - val_accuracy10: 0.4132 - val_accuracy20: 0.4001 - val_accuracy30: 0.3960 - val_accuracy50: 0.3832 - 15s/epoch - 27ms/step
Epoch 6/50
538/538 - 14s - loss: 12.9616 - accuracy10: 0.4134 - accuracy20: 0.4023 - accuracy30: 0.3945 - accuracy50: 0.3968 - val_loss: 12.9532 - val_accuracy10: 0.4114 - val_accuracy20: 0.4008 - val_accuracy30: 0.3956 - val_accuracy50: 0.3820 - 14s/epoch - 27ms/step
Epoch 7/50
538/538 - 15s - loss: 12.9536 - accuracy10: 0.4147 - accuracy20: 0.4026 - accuracy30: 0.3951 - accuracy50: 0.3966 - val_loss: 12.9420 - val_accuracy10: 0.4140 - val_accuracy20: 0.4019 - val_accuracy30: 0.3976 - val_accuracy50: 0.3851 - 15s/epoch - 29ms/step
Epoch 8/50
538/538 - 14s - loss: 12.9466 - accuracy10: 0.4167 - accuracy20: 0.4041 - accuracy30: 0.3965 - accuracy50: 0.3985 - val_loss: 12.9418 - val_accuracy10: 0.4134 - val_accuracy20: 0.4033 - val_accuracy30: 0.3987 - val_accuracy50: 0.3887 - 14s/epoch - 26ms/step
Epoch 9/50
538/538 - 14s - loss: 12.9397 - accuracy10: 0.4168 - accuracy20: 0.4061 - accuracy30: 0.3987 - accuracy50: 0.3983 - val_loss: 12.9427 - val_accuracy10: 0.4146 - val_accuracy20: 0.4023 - val_accuracy30: 0.3980 - val_accuracy50: 0.3848 - 14s/epoch - 26ms/step
Epoch 10/50
538/538 - 14s - loss: 12.9345 - accuracy10: 0.4181 - accuracy20: 0.4061 - accuracy30: 0.3993 - accuracy50: 0.4001 - val_loss: 12.9382 - val_accuracy10: 0.4134 - val_accuracy20: 0.4031 - val_accuracy30: 0.3974 - val_accuracy50: 0.3848 - 14s/epoch - 26ms/step
Epoch 11/50
538/538 - 14s - loss: 12.9262 - accuracy10: 0.4183 - accuracy20: 0.4073 - accuracy30: 0.3997 - accuracy50: 0.4012 - val_loss: 12.9326 - val_accuracy10: 0.4156 - val_accuracy20: 0.4041 - val_accuracy30: 0.3978 - val_accuracy50: 0.3875 - 14s/epoch - 27ms/step
Epoch 12/50
538/538 - 14s - loss: 12.9219 - accuracy10: 0.4190 - accuracy20: 0.4080 - accuracy30: 0.4010 - accuracy50: 0.4014 - val_loss: 12.9383 - val_accuracy10: 0.4151 - val_accuracy20: 0.4014 - val_accuracy30: 0.3985 - val_accuracy50: 0.3867 - 14s/epoch - 27ms/step
Epoch 13/50
538/538 - 14s - loss: 12.9174 - accuracy10: 0.4205 - accuracy20: 0.4092 - accuracy30: 0.4017 - accuracy50: 0.4003 - val_loss: 12.9384 - val_accuracy10: 0.4140 - val_accuracy20: 0.4031 - val_accuracy30: 0.3970 - val_accuracy50: 0.3849 - 14s/epoch - 26ms/step
Epoch 14/50
538/538 - 14s - loss: 12.9053 - accuracy10: 0.4221 - accuracy20: 0.4101 - accuracy30: 0.4036 - accuracy50: 0.4016 - val_loss: 12.9383 - val_accuracy10: 0.4147 - val_accuracy20: 0.4023 - val_accuracy30: 0.3992 - val_accuracy50: 0.3862 - 14s/epoch - 26ms/step
Epoch 15/50
538/538 - 14s - loss: 12.9019 - accuracy10: 0.4214 - accuracy20: 0.4098 - accuracy30: 0.4038 - accuracy50: 0.4029 - val_loss: 12.9367 - val_accuracy10: 0.4142 - val_accuracy20: 0.4019 - val_accuracy30: 0.3964 - val_accuracy50: 0.3857 - 14s/epoch - 27ms/step
Epoch 16/50
538/538 - 15s - loss: 12.8964 - accuracy10: 0.4228 - accuracy20: 0.4108 - accuracy30: 0.4041 - accuracy50: 0.4026 - val_loss: 12.9322 - val_accuracy10: 0.4185 - val_accuracy20: 0.4041 - val_accuracy30: 0.3984 - val_accuracy50: 0.3888 - 15s/epoch - 27ms/step
Epoch 17/50
538/538 - 14s - loss: 12.8841 - accuracy10: 0.4244 - accuracy20: 0.4134 - accuracy30: 0.4065 - accuracy50: 0.4050 - val_loss: 12.9358 - val_accuracy10: 0.4169 - val_accuracy20: 0.4039 - val_accuracy30: 0.3990 - val_accuracy50: 0.3873 - 14s/epoch - 27ms/step
Epoch 18/50
538/538 - 14s - loss: 12.8842 - accuracy10: 0.4228 - accuracy20: 0.4123 - accuracy30: 0.4058 - accuracy50: 0.4042 - val_loss: 12.9311 - val_accuracy10: 0.4186 - val_accuracy20: 0.4020 - val_accuracy30: 0.3999 - val_accuracy50: 0.3909 - 14s/epoch - 26ms/step
Epoch 19/50
538/538 - 14s - loss: 12.8744 - accuracy10: 0.4248 - accuracy20: 0.4141 - accuracy30: 0.4071 - accuracy50: 0.4063 - val_loss: 12.9411 - val_accuracy10: 0.4161 - val_accuracy20: 0.4005 - val_accuracy30: 0.3953 - val_accuracy50: 0.3858 - 14s/epoch - 26ms/step
Epoch 20/50
538/538 - 14s - loss: 12.8660 - accuracy10: 0.4259 - accuracy20: 0.4152 - accuracy30: 0.4084 - accuracy50: 0.4075 - val_loss: 12.9441 - val_accuracy10: 0.4159 - val_accuracy20: 0.4033 - val_accuracy30: 0.3981 - val_accuracy50: 0.3853 - 14s/epoch - 26ms/step
Epoch 21/50
538/538 - 14s - loss: 12.8574 - accuracy10: 0.4258 - accuracy20: 0.4163 - accuracy30: 0.4103 - accuracy50: 0.4084 - val_loss: 12.9423 - val_accuracy10: 0.4153 - val_accuracy20: 0.4009 - val_accuracy30: 0.3960 - val_accuracy50: 0.3857 - 14s/epoch - 26ms/step
Epoch 22/50
538/538 - 15s - loss: 12.8514 - accuracy10: 0.4278 - accuracy20: 0.4173 - accuracy30: 0.4107 - accuracy50: 0.4089 - val_loss: 12.9473 - val_accuracy10: 0.4173 - val_accuracy20: 0.4027 - val_accuracy30: 0.3960 - val_accuracy50: 0.3848 - 15s/epoch - 27ms/step
Epoch 23/50
538/538 - 15s - loss: 12.8440 - accuracy10: 0.4284 - accuracy20: 0.4183 - accuracy30: 0.4124 - accuracy50: 0.4101 - val_loss: 12.9475 - val_accuracy10: 0.4155 - val_accuracy20: 0.4032 - val_accuracy30: 0.3987 - val_accuracy50: 0.3867 - 15s/epoch - 27ms/step
Epoch 24/50
538/538 - 14s - loss: 12.8357 - accuracy10: 0.4283 - accuracy20: 0.4184 - accuracy30: 0.4127 - accuracy50: 0.4122 - val_loss: 12.9530 - val_accuracy10: 0.4160 - val_accuracy20: 0.4029 - val_accuracy30: 0.3972 - val_accuracy50: 0.3849 - 14s/epoch - 26ms/step
Epoch 25/50
538/538 - 14s - loss: 12.8252 - accuracy10: 0.4295 - accuracy20: 0.4206 - accuracy30: 0.4149 - accuracy50: 0.4120 - val_loss: 12.9507 - val_accuracy10: 0.4155 - val_accuracy20: 0.4020 - val_accuracy30: 0.3969 - val_accuracy50: 0.3862 - 14s/epoch - 27ms/step
Epoch 26/50
538/538 - 15s - loss: 12.8232 - accuracy10: 0.4291 - accuracy20: 0.4200 - accuracy30: 0.4148 - accuracy50: 0.4129 - val_loss: 12.9536 - val_accuracy10: 0.4160 - val_accuracy20: 0.4016 - val_accuracy30: 0.3952 - val_accuracy50: 0.3843 - 15s/epoch - 27ms/step
Epoch 27/50
538/538 - 15s - loss: 12.8100 - accuracy10: 0.4304 - accuracy20: 0.4232 - accuracy30: 0.4177 - accuracy50: 0.4160 - val_loss: 12.9637 - val_accuracy10: 0.4155 - val_accuracy20: 0.3990 - val_accuracy30: 0.3942 - val_accuracy50: 0.3831 - 15s/epoch - 27ms/step
Epoch 28/50
538/538 - 14s - loss: 12.8056 - accuracy10: 0.4301 - accuracy20: 0.4221 - accuracy30: 0.4178 - accuracy50: 0.4168 - val_loss: 12.9619 - val_accuracy10: 0.4168 - val_accuracy20: 0.4012 - val_accuracy30: 0.3963 - val_accuracy50: 0.3834 - 14s/epoch - 27ms/step
testing model: results/PCAR/W4/deepOF_L1/seq2seq
Evaluating performance on  test set...
1590/1590 - 20s - 20s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0679212
{'0': {'precision': 0.4027903481958367, 'recall': 0.385222809266775, 'f1-score': 0.39381075812786703, 'support': 122459}, '1': {'precision': 0.47128897940394904, 'recall': 0.40675639883460546, 'f1-score': 0.4366512547616971, 'support': 166124}, '2': {'precision': 0.37532082787243337, 'recall': 0.46435207080602664, 'f1-score': 0.41511641953311385, 'support': 118408}, 'accuracy': 0.4170337919020322, 'macro avg': {'precision': 0.41646671849073974, 'recall': 0.4187770929691357, 'f1-score': 0.4151928108075593, 'support': 406991}, 'weighted avg': {'precision': 0.4227580026362614, 'recall': 0.4170337919020322, 'f1-score': 0.4174957915032264, 'support': 406991}}
[[47174 40291 34994]
 [42033 67572 56519]
 [27911 35514 54983]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0750418
{'0': {'precision': 0.3980330712398033, 'recall': 0.38819952600205876, 'f1-score': 0.3930548037069056, 'support': 125317}, '1': {'precision': 0.4361324516191773, 'recall': 0.3340637376007151, 'f1-score': 0.37833486822217693, 'support': 161098}, '2': {'precision': 0.374019358756677, 'recall': 0.5005722531847133, 'f1-score': 0.4281397410888455, 'support': 120576}, 'accuracy': 0.40006290065382283, 'macro avg': {'precision': 0.40272829387188586, 'recall': 0.4076118389291625, 'f1-score': 0.3998431376726426, 'support': 406991}, 'weighted avg': {'precision': 0.40599947979427, 'recall': 0.40006290065382283, 'f1-score': 0.39762259327238975, 'support': 406991}}
[[48648 37375 39294]
 [45558 53817 61723]
 [28015 32204 60357]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0793172
{'0': {'precision': 0.408031139849576, 'recall': 0.39315502090922394, 'f1-score': 0.4004549733291497, 'support': 129847}, '1': {'precision': 0.3999765362019331, 'recall': 0.293363074947544, 'f1-score': 0.33847293499511244, 'support': 151079}, '2': {'precision': 0.3805774278215223, 'recall': 0.5164399317812239, 'f1-score': 0.4382197930899863, 'support': 126065}, 'accuracy': 0.3942986454245917, 'macro avg': {'precision': 0.39619503462434386, 'recall': 0.400986009212664, 'f1-score': 0.3923825671380828, 'support': 406991}, 'weighted avg': {'precision': 0.3965374368652377, 'recall': 0.3942986454245917, 'f1-score': 0.3891442505703709, 'support': 406991}}
[[51050 35198 43599]
 [44393 44321 62365]
 [29670 31290 65105]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0837972
{'0': {'precision': 0.3658981462402027, 'recall': 0.3997065395004502, 'f1-score': 0.3820558692161496, 'support': 119948}, '1': {'precision': 0.42620254899273674, 'recall': 0.23880967288449953, 'f1-score': 0.30610352098546706, 'support': 169298}, '2': {'precision': 0.33831219388290384, 'recall': 0.5203448129432248, 'f1-score': 0.4100333284255331, 'support': 117745}, 'accuracy': 0.36767889216223454, 'macro avg': {'precision': 0.3768042963719478, 'recall': 0.38628700844272484, 'f1-score': 0.36606423954238326, 'support': 406991}, 'weighted avg': {'precision': 0.38300247242158847, 'recall': 0.36767889216223454, 'f1-score': 0.3585556573781747, 'support': 406991}}
[[47944 28128 43876]
 [52913 40430 75955]
 [30174 26303 61268]]
Evaluating performance on  train set...
538/538 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0680906
{'0': {'precision': 0.44086114286946954, 'recall': 0.4431938932622037, 'f1-score': 0.4420244403590354, 'support': 46113}, '1': {'precision': 0.39196114733424564, 'recall': 0.32406051732552466, 'f1-score': 0.3547913099445031, 'support': 45078}, '2': {'precision': 0.4350955755815029, 'recall': 0.5059170324468543, 'f1-score': 0.4678412606822726, 'support': 46476}, 'accuracy': 0.42535974489165884, 'macro avg': {'precision': 0.4226392885950727, 'recall': 0.42439048101152754, 'f1-score': 0.42155233699527034, 'support': 137667}, 'weighted avg': {'precision': 0.4229027759114305, 'recall': 0.42535974489165884, 'f1-score': 0.4221763103679445, 'support': 137667}}
[[20437 11506 14170]
 [14112 14608 16358]
 [11808 11155 23513]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0719888
{'0': {'precision': 0.4338101099274224, 'recall': 0.44494264632261715, 'f1-score': 0.4393058614946542, 'support': 45943}, '1': {'precision': 0.3682404485431539, 'recall': 0.2640667911677469, 'f1-score': 0.30757222918852517, 'support': 45515}, '2': {'precision': 0.42384208890270436, 'recall': 0.5311302992923457, 'f1-score': 0.47145944388416655, 'support': 46209}, 'accuracy': 0.4140716366304198, 'macro avg': {'precision': 0.40863088245776025, 'recall': 0.4133799122609032, 'f1-score': 0.40611251152244865, 'support': 137667}, 'weighted avg': {'precision': 0.4087858454236838, 'recall': 0.4140716366304198, 'f1-score': 0.4065451317208051, 'support': 137667}}
[[20442 10598 14903]
 [15036 12019 18460]
 [11644 10022 24543]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0750822
{'0': {'precision': 0.43158612751262976, 'recall': 0.43797183586060695, 'f1-score': 0.43475553456013405, 'support': 46229}, '1': {'precision': 0.3554241759638918, 'recall': 0.2485772719189045, 'f1-score': 0.2925501994898293, 'support': 44984}, '2': {'precision': 0.41939183377464456, 'recall': 0.5353037413355147, 'f1-score': 0.47031121450253904, 'support': 46454}, 'accuracy': 0.4089287919399711, 'macro avg': {'precision': 0.40213404575038875, 'recall': 0.407284283038342, 'f1-score': 0.39920564951750076, 'support': 137667}, 'weighted avg': {'precision': 0.40258467509648943, 'recall': 0.4089287919399711, 'f1-score': 0.40028640806825067, 'support': 137667}}
[[20247 10505 15477]
 [14853 11182 18949]
 [11813  9774 24867]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.080507
{'0': {'precision': 0.418258887681854, 'recall': 0.42724107919930376, 'f1-score': 0.4227022721646377, 'support': 45960}, '1': {'precision': 0.3518683420731506, 'recall': 0.23516575559865985, 'f1-score': 0.28191679107928497, 'support': 45368}, '2': {'precision': 0.4051557144985844, 'recall': 0.5280864930188395, 'f1-score': 0.45852461166594843, 'support': 46339}, 'accuracy': 0.39788765644635243, 'macro avg': {'precision': 0.39176098141786303, 'recall': 0.39683110927226767, 'f1-score': 0.3877145583032904, 'support': 137667}, 'weighted avg': {'precision': 0.3919694049785541, 'recall': 0.39788765644635243, 'f1-score': 0.38836445470853675, 'support': 137667}}
[[19636 10105 16219]
 [14990 10669 19709]
 [12321  9547 24471]]
Evaluating performance on  val set...
209/209 - 3s - 3s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.06912
{'0': {'precision': 0.4282775388068076, 'recall': 0.40437930425569485, 'f1-score': 0.4159854677565849, 'support': 16989}, '1': {'precision': 0.4323308270676692, 'recall': 0.3662605530559628, 'f1-score': 0.3965625769725499, 'support': 19781}, '2': {'precision': 0.3958534699400735, 'recall': 0.48986304646851264, 'f1-score': 0.43786918985379414, 'support': 16721}, 'accuracy': 0.4170047297676245, 'macro avg': {'precision': 0.41882061193818343, 'recall': 0.42016763459339007, 'f1-score': 0.4168057448609763, 'support': 53491}, 'weighted avg': {'precision': 0.41964085674005697, 'recall': 0.4170047297676245, 'f1-score': 0.4156436067816253, 'support': 53491}}
[[6870 4777 5342]
 [5377 7245 7159]
 [3794 4736 8191]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0763816
{'0': {'precision': 0.4204984831360419, 'recall': 0.410272780034823, 'f1-score': 0.4153226990981464, 'support': 17230}, '1': {'precision': 0.39554437657204455, 'recall': 0.2891667542292739, 'f1-score': 0.3340920817020243, 'support': 19034}, '2': {'precision': 0.39336701076213487, 'recall': 0.5198235328263772, 'f1-score': 0.4478395679135827, 'support': 17227}, 'accuracy': 0.402460226954067, 'macro avg': {'precision': 0.40313662349007373, 'recall': 0.40642102236349137, 'f1-score': 0.3990847829045845, 'support': 53491}, 'weighted avg': {'precision': 0.402881120609179, 'recall': 0.402460226954067, 'f1-score': 0.3968901502126467, 'support': 53491}}
[[7069 4252 5909]
 [5629 5504 7901]
 [4113 4159 8955]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0794448
{'0': {'precision': 0.42081632653061224, 'recall': 0.4128482352268177, 'f1-score': 0.4167942017267766, 'support': 17481}, '1': {'precision': 0.3733138306517146, 'recall': 0.2497689338335236, 'f1-score': 0.2992931365842536, 'support': 18393}, '2': {'precision': 0.4, 'recall': 0.5457228813078276, 'f1-score': 0.46163449534236056, 'support': 17617}, 'accuracy': 0.40053466938363463, 'macro avg': {'precision': 0.3980433857274423, 'recall': 0.4027800167893896, 'f1-score': 0.39257394455113026, 'support': 53491}, 'weighted avg': {'precision': 0.39762673143629057, 'recall': 0.40053466938363463, 'f1-score': 0.39115912968585975, 'support': 53491}}
[[7217 3919 6345]
 [5723 4594 8076]
 [4210 3793 9614]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0835313
{'0': {'precision': 0.4072077185017026, 'recall': 0.4111276644510658, 'f1-score': 0.409158302919708, 'support': 17452}, '1': {'precision': 0.37655121318762735, 'recall': 0.21773588947199315, 'f1-score': 0.2759229098805646, 'support': 18674}, '2': {'precision': 0.3835600047860248, 'recall': 0.5538151454074287, 'f1-score': 0.4532258824638296, 'support': 17365}, 'accuracy': 0.38993475537940964, 'macro avg': {'precision': 0.38910631215845165, 'recall': 0.3942262331101625, 'f1-score': 0.3794356984213674, 'support': 53491}, 'weighted avg': {'precision': 0.38882851211356656, 'recall': 0.38993475537940964, 'f1-score': 0.3769509369921821, 'support': 53491}}
[[7175 3468 6809]
 [5961 4066 8647]
 [4484 3264 9617]]
training model: results/PCAR/W4/deepLOB_L2/seq2seq
Epoch 1/50
538/538 - 36s - loss: 13.0638 - accuracy10: 0.4033 - accuracy20: 0.3936 - accuracy30: 0.3849 - accuracy50: 0.3818 - val_loss: 13.2130 - val_accuracy10: 0.3834 - val_accuracy20: 0.3661 - val_accuracy30: 0.3621 - val_accuracy50: 0.3495 - 36s/epoch - 67ms/step
Epoch 2/50
538/538 - 29s - loss: 12.7928 - accuracy10: 0.4433 - accuracy20: 0.4299 - accuracy30: 0.4153 - accuracy50: 0.4103 - val_loss: 12.9894 - val_accuracy10: 0.4147 - val_accuracy20: 0.4075 - val_accuracy30: 0.3926 - val_accuracy50: 0.3728 - 29s/epoch - 54ms/step
Epoch 3/50
538/538 - 29s - loss: 12.7350 - accuracy10: 0.4519 - accuracy20: 0.4355 - accuracy30: 0.4207 - accuracy50: 0.4148 - val_loss: 12.8804 - val_accuracy10: 0.4270 - val_accuracy20: 0.4152 - val_accuracy30: 0.4026 - val_accuracy50: 0.3833 - 29s/epoch - 53ms/step
Epoch 4/50
538/538 - 29s - loss: 12.6709 - accuracy10: 0.4588 - accuracy20: 0.4435 - accuracy30: 0.4278 - accuracy50: 0.4203 - val_loss: 12.8721 - val_accuracy10: 0.4382 - val_accuracy20: 0.4157 - val_accuracy30: 0.3973 - val_accuracy50: 0.3795 - 29s/epoch - 53ms/step
Epoch 5/50
538/538 - 28s - loss: 12.6332 - accuracy10: 0.4625 - accuracy20: 0.4456 - accuracy30: 0.4293 - accuracy50: 0.4230 - val_loss: 12.8745 - val_accuracy10: 0.4350 - val_accuracy20: 0.4210 - val_accuracy30: 0.4106 - val_accuracy50: 0.3991 - 28s/epoch - 53ms/step
Epoch 6/50
538/538 - 29s - loss: 12.5993 - accuracy10: 0.4656 - accuracy20: 0.4478 - accuracy30: 0.4321 - accuracy50: 0.4248 - val_loss: 12.8633 - val_accuracy10: 0.4347 - val_accuracy20: 0.4201 - val_accuracy30: 0.4062 - val_accuracy50: 0.3934 - 29s/epoch - 53ms/step
Epoch 7/50
538/538 - 29s - loss: 12.5728 - accuracy10: 0.4685 - accuracy20: 0.4508 - accuracy30: 0.4357 - accuracy50: 0.4278 - val_loss: 12.8556 - val_accuracy10: 0.4350 - val_accuracy20: 0.4223 - val_accuracy30: 0.4075 - val_accuracy50: 0.3943 - 29s/epoch - 53ms/step
Epoch 8/50
538/538 - 28s - loss: 12.5511 - accuracy10: 0.4715 - accuracy20: 0.4535 - accuracy30: 0.4376 - accuracy50: 0.4300 - val_loss: 12.8510 - val_accuracy10: 0.4344 - val_accuracy20: 0.4194 - val_accuracy30: 0.4074 - val_accuracy50: 0.3900 - 28s/epoch - 53ms/step
Epoch 9/50
538/538 - 29s - loss: 12.5225 - accuracy10: 0.4737 - accuracy20: 0.4557 - accuracy30: 0.4405 - accuracy50: 0.4315 - val_loss: 12.8532 - val_accuracy10: 0.4292 - val_accuracy20: 0.4167 - val_accuracy30: 0.4040 - val_accuracy50: 0.3902 - 29s/epoch - 53ms/step
Epoch 10/50
538/538 - 29s - loss: 12.5122 - accuracy10: 0.4749 - accuracy20: 0.4572 - accuracy30: 0.4414 - accuracy50: 0.4323 - val_loss: 12.8831 - val_accuracy10: 0.4278 - val_accuracy20: 0.4142 - val_accuracy30: 0.4029 - val_accuracy50: 0.3908 - 29s/epoch - 53ms/step
Epoch 11/50
538/538 - 29s - loss: 12.4801 - accuracy10: 0.4773 - accuracy20: 0.4593 - accuracy30: 0.4450 - accuracy50: 0.4362 - val_loss: 12.8614 - val_accuracy10: 0.4264 - val_accuracy20: 0.4148 - val_accuracy30: 0.4004 - val_accuracy50: 0.3866 - 29s/epoch - 55ms/step
Epoch 12/50
538/538 - 31s - loss: 12.4589 - accuracy10: 0.4793 - accuracy20: 0.4611 - accuracy30: 0.4468 - accuracy50: 0.4366 - val_loss: 12.8702 - val_accuracy10: 0.4311 - val_accuracy20: 0.4183 - val_accuracy30: 0.4025 - val_accuracy50: 0.3829 - 31s/epoch - 57ms/step
Epoch 13/50
538/538 - 29s - loss: 12.4383 - accuracy10: 0.4809 - accuracy20: 0.4636 - accuracy30: 0.4484 - accuracy50: 0.4396 - val_loss: 12.8810 - val_accuracy10: 0.4284 - val_accuracy20: 0.4143 - val_accuracy30: 0.4013 - val_accuracy50: 0.3853 - 29s/epoch - 55ms/step
Epoch 14/50
538/538 - 29s - loss: 12.4057 - accuracy10: 0.4843 - accuracy20: 0.4663 - accuracy30: 0.4520 - accuracy50: 0.4421 - val_loss: 12.9377 - val_accuracy10: 0.4225 - val_accuracy20: 0.4110 - val_accuracy30: 0.3991 - val_accuracy50: 0.3868 - 29s/epoch - 54ms/step
Epoch 15/50
538/538 - 29s - loss: 12.3861 - accuracy10: 0.4852 - accuracy20: 0.4694 - accuracy30: 0.4534 - accuracy50: 0.4449 - val_loss: 12.9302 - val_accuracy10: 0.4289 - val_accuracy20: 0.4110 - val_accuracy30: 0.3969 - val_accuracy50: 0.3794 - 29s/epoch - 54ms/step
Epoch 16/50
538/538 - 29s - loss: 12.3676 - accuracy10: 0.4867 - accuracy20: 0.4711 - accuracy30: 0.4566 - accuracy50: 0.4464 - val_loss: 12.8745 - val_accuracy10: 0.4356 - val_accuracy20: 0.4177 - val_accuracy30: 0.4041 - val_accuracy50: 0.3881 - 29s/epoch - 54ms/step
Epoch 17/50
538/538 - 29s - loss: 12.3393 - accuracy10: 0.4878 - accuracy20: 0.4733 - accuracy30: 0.4579 - accuracy50: 0.4477 - val_loss: 12.9638 - val_accuracy10: 0.4249 - val_accuracy20: 0.4076 - val_accuracy30: 0.3957 - val_accuracy50: 0.3770 - 29s/epoch - 54ms/step
Epoch 18/50
538/538 - 29s - loss: 12.3207 - accuracy10: 0.4900 - accuracy20: 0.4752 - accuracy30: 0.4601 - accuracy50: 0.4508 - val_loss: 13.0034 - val_accuracy10: 0.4280 - val_accuracy20: 0.4080 - val_accuracy30: 0.3962 - val_accuracy50: 0.3759 - 29s/epoch - 54ms/step
testing model: results/PCAR/W4/deepLOB_L2/seq2seq
Evaluating performance on  test set...
1590/1590 - 33s - 33s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0423175
{'0': {'precision': 0.4576602696856735, 'recall': 0.32482443246774456, 'f1-score': 0.3799671404554486, 'support': 122460}, '1': {'precision': 0.472384, 'recall': 0.5331647855530474, 'f1-score': 0.5009374337221634, 'support': 166125}, '2': {'precision': 0.3919625280021723, 'recall': 0.43886496072966813, 'f1-score': 0.4140898605118153, 'support': 118410}, 'accuracy': 0.4430422978169265, 'macro avg': {'precision': 0.44066893256261525, 'recall': 0.4322847262501534, 'f1-score': 0.43166481156314246, 'support': 406995}, 'weighted avg': {'precision': 0.44455620232790277, 'recall': 0.4430422978169265, 'f1-score': 0.43927170500982243, 'support': 406995}}
[[39778 48163 34519]
 [31459 88572 46094]
 [15679 50765 51966]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0533595
{'0': {'precision': 0.45345747863759306, 'recall': 0.30234840686567876, 'f1-score': 0.3627972443112453, 'support': 125319}, '1': {'precision': 0.44970341833302757, 'recall': 0.547790785732908, 'f1-score': 0.49392445163348575, 'support': 161098}, '2': {'precision': 0.38531143623084724, 'recall': 0.4064754764550747, 'f1-score': 0.3956106046113674, 'support': 120578}, 'accuracy': 0.4303492671900146, 'macro avg': {'precision': 0.4294907777338226, 'recall': 0.4188715563512205, 'f1-score': 0.41744410018536615, 'support': 406995}, 'weighted avg': {'precision': 0.43178231037197434, 'recall': 0.4303492671900146, 'f1-score': 0.4244218347938468, 'support': 406995}}
[[37890 52452 34977]
 [29638 88248 43212]
 [16030 55536 49012]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0662844
{'0': {'precision': 0.45649792361978037, 'recall': 0.27598210228804226, 'f1-score': 0.34399642910281214, 'support': 129849}, '1': {'precision': 0.4150785228687861, 'recall': 0.5669947510904891, 'f1-score': 0.47928672940702527, 'support': 151079}, '2': {'precision': 0.3885276776940714, 'recall': 0.3763633623390737, 'f1-score': 0.3823487934501001, 'support': 126067}, 'accuracy': 0.41510092261575693, 'macro avg': {'precision': 0.4200347080608793, 'recall': 0.406446738572535, 'f1-score': 0.40187731731997917, 'support': 406995}, 'weighted avg': {'precision': 0.42006895854852444, 'recall': 0.41510092261575693, 'f1-score': 0.40609667798997234, 'support': 406995}}
[[35836 58450 35563]
 [26308 85661 39110]
 [16358 62262 47447]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0669925
{'0': {'precision': 0.3964847464073239, 'recall': 0.24334936765846055, 'f1-score': 0.3015916475954808, 'support': 119951}, '1': {'precision': 0.4553650516864771, 'recall': 0.5799773181018086, 'f1-score': 0.5101721114502825, 'support': 169298}, '2': {'precision': 0.35638577955939055, 'recall': 0.35638577955939055, 'f1-score': 0.35638577955939055, 'support': 117746}, 'accuracy': 0.41607882160714504, 'macro avg': {'precision': 0.4027451925510639, 'recall': 0.3932374884398866, 'f1-score': 0.3893831795350513, 'support': 406995}, 'weighted avg': {'precision': 0.4093763666303569, 'recall': 0.41607882160714504, 'f1-score': 0.40420726997883377, 'support': 406995}}
[[29190 56660 34101]
 [29427 98189 41682]
 [15005 60778 41963]]
Evaluating performance on  train set...
538/538 - 11s - 11s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0418432
{'0': {'precision': 0.4595704426719412, 'recall': 0.46364740586500086, 'f1-score': 0.4615999222604921, 'support': 46104}, '1': {'precision': 0.44194098360655737, 'recall': 0.37266654870388394, 'f1-score': 0.4043582082388375, 'support': 45212}, '2': {'precision': 0.46325734004638797, 'recall': 0.5299980583780985, 'f1-score': 0.49438541415117127, 'support': 46353}, 'accuracy': 0.45610849210788196, 'macro avg': {'precision': 0.4549229221082955, 'recall': 0.4554373376489944, 'f1-score': 0.4534478482168336, 'support': 137669}, 'weighted avg': {'precision': 0.4550221104456128, 'recall': 0.45610849210788196, 'f1-score': 0.4538399583707392, 'support': 137669}}
[[21376 10859 13869]
 [13768 16849 14595]
 [11369 10417 24567]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0527068
{'0': {'precision': 0.44694372256556963, 'recall': 0.44530026109660575, 'f1-score': 0.4461204782509182, 'support': 45960}, '1': {'precision': 0.42746340125196397, 'recall': 0.37623197313255924, 'f1-score': 0.40021481775515444, 'support': 45557}, '2': {'precision': 0.448040787161314, 'recall': 0.5026867741376322, 'f1-score': 0.47379330766952915, 'support': 46152}, 'accuracy': 0.4416825864936914, 'macro avg': {'precision': 0.44081597032628256, 'recall': 0.44140633612226576, 'f1-score': 0.44004286789186725, 'support': 137669}, 'weighted avg': {'precision': 0.44086513353782086, 'recall': 0.4416825864936914, 'f1-score': 0.4402065270209552, 'support': 137669}}
[[20466 11613 13881]
 [13717 17140 14700]
 [11608 11344 23200]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0629838
{'0': {'precision': 0.4399409962555316, 'recall': 0.4194378935069993, 'f1-score': 0.4294448628771432, 'support': 46219}, '1': {'precision': 0.403666946230547, 'recall': 0.3832135353311954, 'f1-score': 0.39317441768116274, 'support': 45215}, '2': {'precision': 0.4376282557221784, 'recall': 0.4797015248188602, 'f1-score': 0.45770004643244083, 'support': 46235}, 'accuracy': 0.42777967443651077, 'macro avg': {'precision': 0.42707873273608565, 'recall': 0.4274509845523517, 'f1-score': 0.42677310899691556, 'support': 137669}, 'weighted avg': {'precision': 0.4272506975649094, 'recall': 0.42777967443651077, 'f1-score': 0.42702173372056423, 'support': 137669}}
[[19386 12959 13874]
 [13261 17327 14627]
 [11418 12638 22179]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0709492
{'0': {'precision': 0.42648141550884694, 'recall': 0.39102410556801603, 'f1-score': 0.40798382332894084, 'support': 45923}, '1': {'precision': 0.40323319588978335, 'recall': 0.40680092439749094, 'f1-score': 0.4050092032605837, 'support': 45435}, '2': {'precision': 0.425965773121242, 'recall': 0.4573859342272894, 'f1-score': 0.44111705783127514, 'support': 46311}, 'accuracy': 0.41855464919480784, 'macro avg': {'precision': 0.41856012817329075, 'recall': 0.41840365473093216, 'f1-score': 0.41803669480693323, 'support': 137669}, 'weighted avg': {'precision': 0.41863532980324486, 'recall': 0.41855464919480784, 'f1-score': 0.41814792243790366, 'support': 137669}}
[[17957 13711 14255]
 [12662 18483 14290]
 [11486 13643 21182]]
Evaluating performance on  val set...
209/209 - 4s - 4s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0571357
{'0': {'precision': 0.5034465471863642, 'recall': 0.23690728945506015, 'f1-score': 0.322197714056547, 'support': 16956}, '1': {'precision': 0.44188376753507014, 'recall': 0.5109823677581864, 'f1-score': 0.4739276703111858, 'support': 19850}, '2': {'precision': 0.4022341415842901, 'recall': 0.5438091813496344, 'f1-score': 0.4624283348197223, 'support': 16686}, 'accuracy': 0.4343453226650714, 'macro avg': {'precision': 0.4491881521019081, 'recall': 0.4305662795209603, 'f1-score': 0.4195179063958184, 'support': 53492}, 'weighted avg': {'precision': 0.44902997319484406, 'recall': 0.4343453226650714, 'f1-score': 0.4222449691546724, 'support': 53492}}
[[ 4017  6782  6157]
 [ 2379 10143  7328]
 [ 1583  6029  9074]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0689306
{'0': {'precision': 0.4875473741201949, 'recall': 0.2092118255212871, 'f1-score': 0.29278601910180857, 'support': 17217}, '1': {'precision': 0.4060159657641346, 'recall': 0.5189880075741636, 'f1-score': 0.4556032691508519, 'support': 19012}, '2': {'precision': 0.4083111641133841, 'recall': 0.5156693506343046, 'f1-score': 0.45575323179316524, 'support': 17263}, 'accuracy': 0.41821206909444403, 'macro avg': {'precision': 0.43395816799923786, 'recall': 0.41462306124325177, 'f1-score': 0.40138084001527524, 'support': 53492}, 'weighted avg': {'precision': 0.4329984728076062, 'recall': 0.41821206909444403, 'f1-score': 0.4032471076874532, 'support': 53492}}
[[3602 7585 6030]
 [2275 9867 6870]
 [1511 6850 8902]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0763412
{'0': {'precision': 0.47761194029850745, 'recall': 0.1833285591521054, 'f1-score': 0.2649554957565721, 'support': 17455}, '1': {'precision': 0.38505992320521276, 'recall': 0.5372294372294373, 'f1-score': 0.4485913742855207, 'support': 18480}, '2': {'precision': 0.4062068637250702, 'recall': 0.48607393062596116, 'f1-score': 0.4425659907690712, 'support': 17557}, 'accuracy': 0.4049577506916922, 'macro avg': {'precision': 0.42295957574293014, 'recall': 0.40221064233583464, 'f1-score': 0.3853709536037213, 'support': 53492}, 'weighted avg': {'precision': 0.4222014077836655, 'recall': 0.4049577506916922, 'f1-score': 0.3866914281604721, 'support': 53492}}
[[3200 8293 5962]
 [2039 9928 6513]
 [1461 7562 8534]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0832388
{'0': {'precision': 0.4401455026455027, 'recall': 0.15241912396221013, 'f1-score': 0.22642793348360482, 'support': 17465}, '1': {'precision': 0.3774688293059693, 'recall': 0.5498821260180026, 'f1-score': 0.4476479183477636, 'support': 18664}, '2': {'precision': 0.39200197482103183, 'recall': 0.4572942463859932, 'f1-score': 0.4221383380296667, 'support': 17363}, 'accuracy': 0.3900583264787258, 'macro avg': {'precision': 0.4032054355908346, 'recall': 0.3865318321220686, 'f1-score': 0.3654047299536784, 'support': 53492}, 'weighted avg': {'precision': 0.4026499237771609, 'recall': 0.3900583264787258, 'f1-score': 0.3671399941961961, 'support': 53492}}
[[ 2662  8881  5922]
 [ 2008 10263  6393]
 [ 1378  8045  7940]]
training model: results/PCAR/W4/deepOF_L2/seq2seq
Epoch 1/50
538/538 - 26s - loss: 13.0183 - accuracy10: 0.4107 - accuracy20: 0.3968 - accuracy30: 0.3870 - accuracy50: 0.3849 - val_loss: 12.8098 - val_accuracy10: 0.4428 - val_accuracy20: 0.4181 - val_accuracy30: 0.4034 - val_accuracy50: 0.3921 - 26s/epoch - 48ms/step
Epoch 2/50
538/538 - 19s - loss: 12.7706 - accuracy10: 0.4509 - accuracy20: 0.4284 - accuracy30: 0.4139 - accuracy50: 0.4073 - val_loss: 12.7284 - val_accuracy10: 0.4554 - val_accuracy20: 0.4288 - val_accuracy30: 0.4113 - val_accuracy50: 0.3979 - 19s/epoch - 35ms/step
Epoch 3/50
538/538 - 19s - loss: 12.6688 - accuracy10: 0.4668 - accuracy20: 0.4410 - accuracy30: 0.4240 - accuracy50: 0.4163 - val_loss: 12.6782 - val_accuracy10: 0.4652 - val_accuracy20: 0.4349 - val_accuracy30: 0.4170 - val_accuracy50: 0.4020 - 19s/epoch - 35ms/step
Epoch 4/50
538/538 - 19s - loss: 12.6020 - accuracy10: 0.4773 - accuracy20: 0.4491 - accuracy30: 0.4300 - accuracy50: 0.4211 - val_loss: 12.6508 - val_accuracy10: 0.4677 - val_accuracy20: 0.4387 - val_accuracy30: 0.4207 - val_accuracy50: 0.4078 - 19s/epoch - 35ms/step
Epoch 5/50
538/538 - 19s - loss: 12.5467 - accuracy10: 0.4828 - accuracy20: 0.4558 - accuracy30: 0.4367 - accuracy50: 0.4244 - val_loss: 12.6243 - val_accuracy10: 0.4696 - val_accuracy20: 0.4426 - val_accuracy30: 0.4242 - val_accuracy50: 0.4103 - 19s/epoch - 35ms/step
Epoch 6/50
538/538 - 19s - loss: 12.5035 - accuracy10: 0.4875 - accuracy20: 0.4618 - accuracy30: 0.4408 - accuracy50: 0.4289 - val_loss: 12.5986 - val_accuracy10: 0.4724 - val_accuracy20: 0.4440 - val_accuracy30: 0.4263 - val_accuracy50: 0.4135 - 19s/epoch - 35ms/step
Epoch 7/50
538/538 - 18s - loss: 12.4725 - accuracy10: 0.4911 - accuracy20: 0.4641 - accuracy30: 0.4419 - accuracy50: 0.4301 - val_loss: 12.6021 - val_accuracy10: 0.4739 - val_accuracy20: 0.4428 - val_accuracy30: 0.4252 - val_accuracy50: 0.4119 - 18s/epoch - 34ms/step
Epoch 8/50
538/538 - 19s - loss: 12.4402 - accuracy10: 0.4935 - accuracy20: 0.4670 - accuracy30: 0.4462 - accuracy50: 0.4319 - val_loss: 12.5912 - val_accuracy10: 0.4730 - val_accuracy20: 0.4444 - val_accuracy30: 0.4274 - val_accuracy50: 0.4147 - 19s/epoch - 35ms/step
Epoch 9/50
538/538 - 19s - loss: 12.4087 - accuracy10: 0.4964 - accuracy20: 0.4690 - accuracy30: 0.4492 - accuracy50: 0.4352 - val_loss: 12.5921 - val_accuracy10: 0.4740 - val_accuracy20: 0.4436 - val_accuracy30: 0.4263 - val_accuracy50: 0.4151 - 19s/epoch - 35ms/step
Epoch 10/50
538/538 - 19s - loss: 12.3794 - accuracy10: 0.4995 - accuracy20: 0.4730 - accuracy30: 0.4522 - accuracy50: 0.4373 - val_loss: 12.5789 - val_accuracy10: 0.4757 - val_accuracy20: 0.4465 - val_accuracy30: 0.4273 - val_accuracy50: 0.4147 - 19s/epoch - 35ms/step
Epoch 11/50
538/538 - 19s - loss: 12.3481 - accuracy10: 0.5022 - accuracy20: 0.4755 - accuracy30: 0.4548 - accuracy50: 0.4393 - val_loss: 12.5888 - val_accuracy10: 0.4740 - val_accuracy20: 0.4450 - val_accuracy30: 0.4254 - val_accuracy50: 0.4127 - 19s/epoch - 35ms/step
Epoch 12/50
538/538 - 19s - loss: 12.3228 - accuracy10: 0.5023 - accuracy20: 0.4767 - accuracy30: 0.4562 - accuracy50: 0.4416 - val_loss: 12.5835 - val_accuracy10: 0.4775 - val_accuracy20: 0.4459 - val_accuracy30: 0.4270 - val_accuracy50: 0.4129 - 19s/epoch - 35ms/step
Epoch 13/50
538/538 - 19s - loss: 12.2930 - accuracy10: 0.5068 - accuracy20: 0.4810 - accuracy30: 0.4598 - accuracy50: 0.4431 - val_loss: 12.6019 - val_accuracy10: 0.4770 - val_accuracy20: 0.4470 - val_accuracy30: 0.4276 - val_accuracy50: 0.4151 - 19s/epoch - 35ms/step
Epoch 14/50
538/538 - 19s - loss: 12.2635 - accuracy10: 0.5089 - accuracy20: 0.4837 - accuracy30: 0.4641 - accuracy50: 0.4480 - val_loss: 12.6070 - val_accuracy10: 0.4748 - val_accuracy20: 0.4439 - val_accuracy30: 0.4242 - val_accuracy50: 0.4141 - 19s/epoch - 35ms/step
Epoch 15/50
538/538 - 19s - loss: 12.2378 - accuracy10: 0.5092 - accuracy20: 0.4844 - accuracy30: 0.4662 - accuracy50: 0.4495 - val_loss: 12.6023 - val_accuracy10: 0.4741 - val_accuracy20: 0.4473 - val_accuracy30: 0.4273 - val_accuracy50: 0.4154 - 19s/epoch - 35ms/step
Epoch 16/50
538/538 - 19s - loss: 12.2133 - accuracy10: 0.5112 - accuracy20: 0.4870 - accuracy30: 0.4678 - accuracy50: 0.4510 - val_loss: 12.6340 - val_accuracy10: 0.4749 - val_accuracy20: 0.4466 - val_accuracy30: 0.4262 - val_accuracy50: 0.4134 - 19s/epoch - 35ms/step
Epoch 17/50
538/538 - 19s - loss: 12.1861 - accuracy10: 0.5129 - accuracy20: 0.4882 - accuracy30: 0.4704 - accuracy50: 0.4568 - val_loss: 12.6813 - val_accuracy10: 0.4745 - val_accuracy20: 0.4445 - val_accuracy30: 0.4256 - val_accuracy50: 0.4147 - 19s/epoch - 35ms/step
Epoch 18/50
538/538 - 19s - loss: 12.1573 - accuracy10: 0.5139 - accuracy20: 0.4920 - accuracy30: 0.4733 - accuracy50: 0.4581 - val_loss: 12.6891 - val_accuracy10: 0.4740 - val_accuracy20: 0.4445 - val_accuracy30: 0.4243 - val_accuracy50: 0.4120 - 19s/epoch - 36ms/step
Epoch 19/50
538/538 - 19s - loss: 12.1279 - accuracy10: 0.5166 - accuracy20: 0.4932 - accuracy30: 0.4764 - accuracy50: 0.4596 - val_loss: 12.7201 - val_accuracy10: 0.4739 - val_accuracy20: 0.4453 - val_accuracy30: 0.4258 - val_accuracy50: 0.4127 - 19s/epoch - 36ms/step
Epoch 20/50
538/538 - 19s - loss: 12.1019 - accuracy10: 0.5163 - accuracy20: 0.4948 - accuracy30: 0.4806 - accuracy50: 0.4640 - val_loss: 12.7236 - val_accuracy10: 0.4722 - val_accuracy20: 0.4452 - val_accuracy30: 0.4234 - val_accuracy50: 0.4134 - 19s/epoch - 36ms/step
testing model: results/PCAR/W4/deepOF_L2/seq2seq
Evaluating performance on  test set...
1590/1590 - 25s - 25s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0069559
{'0': {'precision': 0.45644068194076404, 'recall': 0.476828979495178, 'f1-score': 0.46641212837675927, 'support': 122459}, '1': {'precision': 0.5162071871425992, 'recall': 0.6194709975680817, 'f1-score': 0.5631443581044105, 'support': 166124}, '2': {'precision': 0.47136978395603846, 'recall': 0.31730119586514427, 'f1-score': 0.37928667332949717, 'support': 118408}, 'accuracy': 0.4886397979316496, 'macro avg': {'precision': 0.4813392176798006, 'recall': 0.47120039097613464, 'f1-score': 0.46961438660355564, 'support': 406991}, 'weighted avg': {'precision': 0.4851793420624234, 'recall': 0.4886397979316496, 'f1-score': 0.48054805288133096, 'support': 406991}}
[[ 58392  46643  17424]
 [ 38504 102909  24711]
 [ 31033  49804  37571]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0344559
{'0': {'precision': 0.4434060724842053, 'recall': 0.44411372758683976, 'f1-score': 0.4437596179146367, 'support': 125317}, '1': {'precision': 0.47137242928059253, 'recall': 0.5941414542700716, 'f1-score': 0.5256841885575883, 'support': 161098}, '2': {'precision': 0.44811140299421054, 'recall': 0.2914344479830149, 'f1-score': 0.3531764776827442, 'support': 120576}, 'accuracy': 0.45826566189424334, 'macro avg': {'precision': 0.4542966349196695, 'recall': 0.4432298766133087, 'f1-score': 0.44087342805165636, 'support': 406991}, 'weighted avg': {'precision': 0.45586992077264116, 'recall': 0.45826566189424334, 'f1-score': 0.44935122009954376, 'support': 406991}}
[[55655 51912 17750]
 [39855 95715 25528]
 [30007 55429 35140]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.053907
{'0': {'precision': 0.44536191746162, 'recall': 0.40125686384745124, 'f1-score': 0.42216055259586366, 'support': 129847}, '1': {'precision': 0.42402219010768727, 'recall': 0.6020492589969486, 'f1-score': 0.49759155773286395, 'support': 151079}, '2': {'precision': 0.445643966990317, 'recall': 0.2668702653393091, 'f1-score': 0.3338294684408458, 'support': 126065}, 'accuracy': 0.4341668488983786, 'macro avg': {'precision': 0.43834269151987476, 'recall': 0.42339212939456966, 'f1-score': 0.4178605262565245, 'support': 406991}, 'weighted avg': {'precision': 0.43752776856135045, 'recall': 0.4341668488983786, 'f1-score': 0.4228008190909226, 'support': 406991}}
[[52102 59692 18053]
 [36325 90957 23797]
 [28561 63861 33643]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0624794
{'0': {'precision': 0.39490826287399444, 'recall': 0.35278620735652116, 'f1-score': 0.3726607427499538, 'support': 119948}, '1': {'precision': 0.44688784820702243, 'recall': 0.6002965185648974, 'f1-score': 0.5123552795093682, 'support': 169298}, '2': {'precision': 0.38208003092982795, 'recall': 0.23500785595991336, 'f1-score': 0.2910178947977304, 'support': 117745}, 'accuracy': 0.4216702580646747, 'macro avg': {'precision': 0.40795871400361494, 'recall': 0.396030193960444, 'f1-score': 0.39201130568568415, 'support': 406991}, 'weighted avg': {'precision': 0.412819174091798, 'recall': 0.4216702580646747, 'f1-score': 0.40715037164140544, 'support': 406991}}
[[ 42316  61012  16620]
 [ 39538 101629  28131]
 [ 25300  64774  27671]]
Evaluating performance on  train set...
538/538 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0054307
{'0': {'precision': 0.4869405131745484, 'recall': 0.5506473228807495, 'f1-score': 0.51683815223033, 'support': 46113}, '1': {'precision': 0.4678581491768305, 'recall': 0.5156839256400018, 'f1-score': 0.49060824785783635, 'support': 45078}, '2': {'precision': 0.5304590484163527, 'recall': 0.4090067992081935, 'f1-score': 0.4618823729513674, 'support': 46476}, 'accuracy': 0.49138137680054045, 'macro avg': {'precision': 0.49508590358924387, 'recall': 0.49177934924298156, 'f1-score': 0.4897762576798446, 'support': 137667}, 'weighted avg': {'precision': 0.49538387752191543, 'recall': 0.49138137680054045, 'f1-score': 0.4896964521346474, 'support': 137667}}
[[25392 12663  8058]
 [13064 23246  8768]
 [13690 13777 19009]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0322477
{'0': {'precision': 0.46539948825487215, 'recall': 0.5265437607470126, 'f1-score': 0.4940871305733135, 'support': 45943}, '1': {'precision': 0.43171955926170336, 'recall': 0.4743271448972866, 'f1-score': 0.45202152383744065, 'support': 45515}, '2': {'precision': 0.504358061713517, 'recall': 0.38944794304139885, 'f1-score': 0.4395164244718525, 'support': 46209}, 'accuracy': 0.4632628008164629, 'macro avg': {'precision': 0.46715903641003087, 'recall': 0.46343961622856605, 'f1-score': 0.46187502629420224, 'support': 137667}, 'weighted avg': {'precision': 0.4673410919276946, 'recall': 0.4632628008164629, 'f1-score': 0.46186245909194423, 'support': 137667}}
[[24191 13624  8128]
 [14369 21589  9557]
 [13419 14794 17996]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0493349
{'0': {'precision': 0.4583685971063555, 'recall': 0.49205044452616326, 'f1-score': 0.47461269625997604, 'support': 46229}, '1': {'precision': 0.39869698278289933, 'recall': 0.4720567312822337, 'f1-score': 0.43228663036286835, 'support': 44984}, '2': {'precision': 0.4897354801610121, 'recall': 0.3666637964437939, 'f1-score': 0.4193564271118005, 'support': 46454}, 'accuracy': 0.443207159304699, 'macro avg': {'precision': 0.4489336866834223, 'recall': 0.4435903240840637, 'f1-score': 0.4420852512448816, 'support': 137667}, 'weighted avg': {'precision': 0.44945469099010876, 'recall': 0.443207159304699, 'f1-score': 0.4421367181728176, 'support': 137667}}
[[22747 15411  8071]
 [14073 21235  9676]
 [12806 16615 17033]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0659201
{'0': {'precision': 0.4452488687782805, 'recall': 0.4496083550913838, 'f1-score': 0.4474179928548229, 'support': 45960}, '1': {'precision': 0.381391971787159, 'recall': 0.48628989596191147, 'f1-score': 0.427500145329122, 'support': 45368}, '2': {'precision': 0.4616144383586244, 'recall': 0.3328297977945143, 'f1-score': 0.3867836990595611, 'support': 46339}, 'accuracy': 0.4223888077752838, 'macro avg': {'precision': 0.42941842630802135, 'recall': 0.42290934961593657, 'f1-score': 0.4205672790811687, 'support': 137667}, 'weighted avg': {'precision': 0.4297135874551628, 'recall': 0.4223888077752838, 'f1-score': 0.4204444592794226, 'support': 137667}}
[[20664 17239  8057]
 [13375 22062  9931]
 [12371 18545 15423]]
Evaluating performance on  val set...
209/209 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0199417
{'0': {'precision': 0.46505000537692226, 'recall': 0.5090941197245277, 'f1-score': 0.4860763762047939, 'support': 16989}, '1': {'precision': 0.4877199767936569, 'recall': 0.5099843283959355, 'f1-score': 0.4986037316199185, 'support': 19781}, '2': {'precision': 0.47160250545428956, 'recall': 0.40075354344835834, 'f1-score': 0.433301002263175, 'support': 16721}, 'accuracy': 0.47555663569572454, 'macro avg': {'precision': 0.4747908292082896, 'recall': 0.4732773305229405, 'f1-score': 0.4726603700292958, 'support': 53491}, 'weighted avg': {'precision': 0.4754816491747217, 'recall': 0.47555663569572454, 'f1-score': 0.47421169971321153, 'support': 53491}}
[[ 8649  5160  3180]
 [ 5365 10088  4328]
 [ 4584  5436  6701]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0449163
{'0': {'precision': 0.4465537698198684, 'recall': 0.4805571677307023, 'f1-score': 0.46293190204629325, 'support': 17230}, '1': {'precision': 0.43687472548923917, 'recall': 0.47031627613743826, 'f1-score': 0.4529791271347249, 'support': 19034}, '2': {'precision': 0.4575321621247752, 'recall': 0.38399024786672087, 'f1-score': 0.4175477355215402, 'support': 17227}, 'accuracy': 0.4458133143893365, 'macro avg': {'precision': 0.44698688581129425, 'recall': 0.4449545639116204, 'f1-score': 0.4444862549008528, 'support': 53491}, 'weighted avg': {'precision': 0.4466452587516033, 'recall': 0.4458133143893365, 'f1-score': 0.4447741903865989, 'support': 53491}}
[[8280 5629 3321]
 [5560 8952 4522]
 [4702 5910 6615]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0592419
{'0': {'precision': 0.44001342356955087, 'recall': 0.45003146273096506, 'f1-score': 0.4449660633484163, 'support': 17481}, '1': {'precision': 0.4025686864885209, 'recall': 0.46523133800902516, 'f1-score': 0.43163762011652246, 'support': 18393}, '2': {'precision': 0.45061298411813877, 'recall': 0.3672021343020946, 'f1-score': 0.40465392675069595, 'support': 17617}, 'accuracy': 0.4279785384457198, 'macro avg': {'precision': 0.43106503139207014, 'recall': 0.4274883116806949, 'f1-score': 0.42708587007187826, 'support': 53491}, 'weighted avg': {'precision': 0.43062888054461373, 'recall': 0.4279785384457198, 'f1-score': 0.427106442724269, 'support': 53491}}
[[7867 6183 3431]
 [5380 8557 4456]
 [4632 6516 6469]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0697755
{'0': {'precision': 0.4270615632650624, 'recall': 0.40980976392390556, 'f1-score': 0.4182578437966022, 'support': 17452}, '1': {'precision': 0.3996222105078194, 'recall': 0.4871479061797151, 'f1-score': 0.43906559196872436, 'support': 18674}, '2': {'precision': 0.426967095851216, 'recall': 0.3437374028217679, 'f1-score': 0.3808581910990589, 'support': 17365}, 'accuracy': 0.41535959320259486, 'macro avg': {'precision': 0.4178836232080326, 'recall': 0.4135650243084628, 'f1-score': 0.41272720895479514, 'support': 53491}, 'weighted avg': {'precision': 0.4174516681419539, 'recall': 0.41535959320259486, 'f1-score': 0.4133807414854353, 'support': 53491}}
[[7152 6776 3524]
 [5090 9097 4487]
 [4505 6891 5969]]
training model: results/PCAR/W4/deepVOL_L2/seq2seq
Epoch 1/50
538/538 - 24s - loss: 13.1014 - accuracy10: 0.3947 - accuracy20: 0.3902 - accuracy30: 0.3844 - accuracy50: 0.3826 - val_loss: 12.9276 - val_accuracy10: 0.4060 - val_accuracy20: 0.4054 - val_accuracy30: 0.4020 - val_accuracy50: 0.3979 - 24s/epoch - 45ms/step
Epoch 2/50
538/538 - 20s - loss: 12.8666 - accuracy10: 0.4278 - accuracy20: 0.4194 - accuracy30: 0.4105 - accuracy50: 0.4067 - val_loss: 12.8408 - val_accuracy10: 0.4264 - val_accuracy20: 0.4199 - val_accuracy30: 0.4131 - val_accuracy50: 0.4078 - 20s/epoch - 36ms/step
Epoch 3/50
538/538 - 19s - loss: 12.7651 - accuracy10: 0.4478 - accuracy20: 0.4343 - accuracy30: 0.4215 - accuracy50: 0.4161 - val_loss: 12.7921 - val_accuracy10: 0.4345 - val_accuracy20: 0.4233 - val_accuracy30: 0.4151 - val_accuracy50: 0.4089 - 19s/epoch - 36ms/step
Epoch 4/50
538/538 - 19s - loss: 12.6855 - accuracy10: 0.4608 - accuracy20: 0.4424 - accuracy30: 0.4277 - accuracy50: 0.4218 - val_loss: 12.7779 - val_accuracy10: 0.4391 - val_accuracy20: 0.4280 - val_accuracy30: 0.4192 - val_accuracy50: 0.4094 - 19s/epoch - 35ms/step
Epoch 5/50
538/538 - 20s - loss: 12.6411 - accuracy10: 0.4665 - accuracy20: 0.4486 - accuracy30: 0.4310 - accuracy50: 0.4246 - val_loss: 12.8311 - val_accuracy10: 0.4378 - val_accuracy20: 0.4269 - val_accuracy30: 0.4171 - val_accuracy50: 0.4059 - 20s/epoch - 37ms/step
Epoch 6/50
538/538 - 19s - loss: 12.6083 - accuracy10: 0.4703 - accuracy20: 0.4513 - accuracy30: 0.4350 - accuracy50: 0.4264 - val_loss: 12.7879 - val_accuracy10: 0.4425 - val_accuracy20: 0.4280 - val_accuracy30: 0.4178 - val_accuracy50: 0.4050 - 19s/epoch - 35ms/step
Epoch 7/50
538/538 - 19s - loss: 12.5822 - accuracy10: 0.4739 - accuracy20: 0.4555 - accuracy30: 0.4360 - accuracy50: 0.4281 - val_loss: 12.7760 - val_accuracy10: 0.4427 - val_accuracy20: 0.4279 - val_accuracy30: 0.4156 - val_accuracy50: 0.4062 - 19s/epoch - 35ms/step
Epoch 8/50
538/538 - 18s - loss: 12.5556 - accuracy10: 0.4771 - accuracy20: 0.4566 - accuracy30: 0.4376 - accuracy50: 0.4305 - val_loss: 12.7204 - val_accuracy10: 0.4531 - val_accuracy20: 0.4351 - val_accuracy30: 0.4194 - val_accuracy50: 0.4096 - 18s/epoch - 34ms/step
Epoch 9/50
538/538 - 19s - loss: 12.5298 - accuracy10: 0.4799 - accuracy20: 0.4589 - accuracy30: 0.4400 - accuracy50: 0.4307 - val_loss: 12.6868 - val_accuracy10: 0.4559 - val_accuracy20: 0.4393 - val_accuracy30: 0.4221 - val_accuracy50: 0.4130 - 19s/epoch - 34ms/step
Epoch 10/50
538/538 - 19s - loss: 12.5070 - accuracy10: 0.4821 - accuracy20: 0.4608 - accuracy30: 0.4414 - accuracy50: 0.4342 - val_loss: 12.7176 - val_accuracy10: 0.4522 - val_accuracy20: 0.4331 - val_accuracy30: 0.4191 - val_accuracy50: 0.4045 - 19s/epoch - 35ms/step
Epoch 11/50
538/538 - 18s - loss: 12.4837 - accuracy10: 0.4858 - accuracy20: 0.4643 - accuracy30: 0.4454 - accuracy50: 0.4357 - val_loss: 12.6838 - val_accuracy10: 0.4557 - val_accuracy20: 0.4371 - val_accuracy30: 0.4176 - val_accuracy50: 0.4070 - 18s/epoch - 34ms/step
Epoch 12/50
538/538 - 18s - loss: 12.4662 - accuracy10: 0.4871 - accuracy20: 0.4654 - accuracy30: 0.4443 - accuracy50: 0.4359 - val_loss: 12.6917 - val_accuracy10: 0.4548 - val_accuracy20: 0.4360 - val_accuracy30: 0.4181 - val_accuracy50: 0.4062 - 18s/epoch - 34ms/step
Epoch 13/50
538/538 - 20s - loss: 12.4456 - accuracy10: 0.4889 - accuracy20: 0.4663 - accuracy30: 0.4479 - accuracy50: 0.4383 - val_loss: 12.6758 - val_accuracy10: 0.4569 - val_accuracy20: 0.4380 - val_accuracy30: 0.4187 - val_accuracy50: 0.4070 - 20s/epoch - 37ms/step
Epoch 14/50
538/538 - 19s - loss: 12.4287 - accuracy10: 0.4896 - accuracy20: 0.4688 - accuracy30: 0.4495 - accuracy50: 0.4391 - val_loss: 12.6998 - val_accuracy10: 0.4537 - val_accuracy20: 0.4358 - val_accuracy30: 0.4170 - val_accuracy50: 0.4042 - 19s/epoch - 36ms/step
Epoch 15/50
538/538 - 20s - loss: 12.4104 - accuracy10: 0.4917 - accuracy20: 0.4691 - accuracy30: 0.4496 - accuracy50: 0.4400 - val_loss: 12.6883 - val_accuracy10: 0.4557 - val_accuracy20: 0.4363 - val_accuracy30: 0.4153 - val_accuracy50: 0.4013 - 20s/epoch - 36ms/step
Epoch 16/50
538/538 - 19s - loss: 12.3887 - accuracy10: 0.4932 - accuracy20: 0.4715 - accuracy30: 0.4526 - accuracy50: 0.4421 - val_loss: 12.6994 - val_accuracy10: 0.4558 - val_accuracy20: 0.4350 - val_accuracy30: 0.4128 - val_accuracy50: 0.3998 - 19s/epoch - 35ms/step
Epoch 17/50
538/538 - 19s - loss: 12.3717 - accuracy10: 0.4944 - accuracy20: 0.4731 - accuracy30: 0.4528 - accuracy50: 0.4415 - val_loss: 12.6903 - val_accuracy10: 0.4570 - val_accuracy20: 0.4383 - val_accuracy30: 0.4170 - val_accuracy50: 0.4021 - 19s/epoch - 35ms/step
Epoch 18/50
538/538 - 19s - loss: 12.3557 - accuracy10: 0.4959 - accuracy20: 0.4746 - accuracy30: 0.4549 - accuracy50: 0.4445 - val_loss: 12.6997 - val_accuracy10: 0.4539 - val_accuracy20: 0.4352 - val_accuracy30: 0.4161 - val_accuracy50: 0.3970 - 19s/epoch - 35ms/step
Epoch 19/50
538/538 - 19s - loss: 12.3442 - accuracy10: 0.4985 - accuracy20: 0.4762 - accuracy30: 0.4572 - accuracy50: 0.4443 - val_loss: 12.7489 - val_accuracy10: 0.4496 - val_accuracy20: 0.4307 - val_accuracy30: 0.4118 - val_accuracy50: 0.3982 - 19s/epoch - 34ms/step
Epoch 20/50
538/538 - 19s - loss: 12.3388 - accuracy10: 0.4980 - accuracy20: 0.4766 - accuracy30: 0.4575 - accuracy50: 0.4452 - val_loss: 12.7048 - val_accuracy10: 0.4544 - val_accuracy20: 0.4351 - val_accuracy30: 0.4157 - val_accuracy50: 0.3997 - 19s/epoch - 35ms/step
Epoch 21/50
538/538 - 18s - loss: 12.3043 - accuracy10: 0.5004 - accuracy20: 0.4791 - accuracy30: 0.4611 - accuracy50: 0.4483 - val_loss: 12.7308 - val_accuracy10: 0.4495 - val_accuracy20: 0.4331 - val_accuracy30: 0.4162 - val_accuracy50: 0.4002 - 18s/epoch - 34ms/step
Epoch 22/50
538/538 - 18s - loss: 12.2869 - accuracy10: 0.5008 - accuracy20: 0.4800 - accuracy30: 0.4615 - accuracy50: 0.4510 - val_loss: 12.6945 - val_accuracy10: 0.4520 - val_accuracy20: 0.4361 - val_accuracy30: 0.4188 - val_accuracy50: 0.4025 - 18s/epoch - 34ms/step
Epoch 23/50
538/538 - 18s - loss: 12.2765 - accuracy10: 0.5027 - accuracy20: 0.4801 - accuracy30: 0.4625 - accuracy50: 0.4504 - val_loss: 12.7114 - val_accuracy10: 0.4495 - val_accuracy20: 0.4364 - val_accuracy30: 0.4182 - val_accuracy50: 0.4034 - 18s/epoch - 34ms/step
testing model: results/PCAR/W4/deepVOL_L2/seq2seq
Evaluating performance on  test set...
1590/1590 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0213816
{'0': {'precision': 0.4457069459539571, 'recall': 0.4788747346072187, 'f1-score': 0.46169592139603916, 'support': 122460}, '1': {'precision': 0.4955533790401567, 'recall': 0.5329902182091798, 'f1-score': 0.513590487238979, 'support': 166125}, '2': {'precision': 0.4429181266602582, 'recall': 0.3618866649776201, 'f1-score': 0.3983230850030443, 'support': 118410}, 'accuracy': 0.4669271121266846, 'macro avg': {'precision': 0.46139281721812403, 'recall': 0.4579172059313395, 'f1-score': 0.4578698312126875, 'support': 406995}, 'weighted avg': {'precision': 0.46524161985382817, 'recall': 0.4669271121266846, 'f1-score': 0.46444044453112404, 'support': 406995}}
[[58643 42585 21232]
 [44918 88543 32664]
 [28012 47547 42851]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0418454
{'0': {'precision': 0.44823844444055516, 'recall': 0.4087329136044814, 'f1-score': 0.4275750961004704, 'support': 125319}, '1': {'precision': 0.4453439058420478, 'recall': 0.6003426485741599, 'f1-score': 0.5113557955401636, 'support': 161098}, '2': {'precision': 0.4458532969796437, 'recall': 0.279371029541044, 'f1-score': 0.34350335488344585, 'support': 120578}, 'accuracy': 0.4462511824469588, 'macro avg': {'precision': 0.44647854908741563, 'recall': 0.42948219723989506, 'f1-score': 0.4274780821746933, 'support': 406995}, 'weighted avg': {'precision': 0.44638608583741723, 'recall': 0.4462511824469588, 'f1-score': 0.43582999040106213, 'support': 406995}}
[[51222 57449 16648]
 [39164 96714 25220]
 [23888 63004 33686]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0619955
{'0': {'precision': 0.4572888276319471, 'recall': 0.33983319086015296, 'f1-score': 0.38990748676804543, 'support': 129849}, '1': {'precision': 0.3980413441939288, 'recall': 0.6747198485560535, 'f1-score': 0.500701176158537, 'support': 151079}, '2': {'precision': 0.45573854863612967, 'recall': 0.19667319758541094, 'f1-score': 0.27476990763058884, 'support': 126067}, 'accuracy': 0.4198012260592882, 'macro avg': {'precision': 0.4370229068206685, 'recall': 0.4037420790005392, 'f1-score': 0.3884595235190571, 'support': 406995}, 'weighted avg': {'precision': 0.43481560419554593, 'recall': 0.4198012260592882, 'f1-score': 0.39537082319798766, 'support': 406995}}
[[ 44127  73306  12416]
 [ 31949 101936  17194]
 [ 20421  80852  24794]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0629389
{'0': {'precision': 0.4064027138587085, 'recall': 0.28564163700177575, 'f1-score': 0.3354858292657851, 'support': 119951}, '1': {'precision': 0.43313362576227665, 'recall': 0.7174036314664084, 'f1-score': 0.540150497656257, 'support': 169298}, '2': {'precision': 0.40648579605932306, 'recall': 0.14594975625498954, 'f1-score': 0.2147816251413859, 'support': 117746}, 'accuracy': 0.4248283148441627, 'macro avg': {'precision': 0.4153407118934361, 'recall': 0.3829983415743912, 'f1-score': 0.3634726506878094, 'support': 406995}, 'weighted avg': {'precision': 0.41754602647985584, 'recall': 0.4248283148441627, 'f1-score': 0.38569991496791556, 'support': 406995}}
[[ 34263  75913   9775]
 [ 32526 121455  15317]
 [ 17519  83042  17185]]
Evaluating performance on  train set...
538/538 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0277759
{'0': {'precision': 0.4778873077365655, 'recall': 0.5404737116085372, 'f1-score': 0.5072572929177778, 'support': 46104}, '1': {'precision': 0.45046716872019504, 'recall': 0.46173582234804916, 'f1-score': 0.45603189339741135, 'support': 45212}, '2': {'precision': 0.49839220089832587, 'recall': 0.4213103790477423, 'f1-score': 0.4566211113319382, 'support': 46353}, 'accuracy': 0.47449316839666156, 'macro avg': {'precision': 0.47558222578502884, 'recall': 0.4745066376681096, 'f1-score': 0.47330343254904245, 'support': 137669}, 'weighted avg': {'precision': 0.4757862100858158, 'recall': 0.47449316839666156, 'f1-score': 0.47338516710758644, 'support': 137669}}
[[24918 11976  9210]
 [13891 20876 10445]
 [13333 13491 19529]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0465019
{'0': {'precision': 0.46948914569607947, 'recall': 0.472911227154047, 'f1-score': 0.4711939732263834, 'support': 45960}, '1': {'precision': 0.40580085682697625, 'recall': 0.51563974800799, 'f1-score': 0.4541737155009909, 'support': 45557}, '2': {'precision': 0.49074239980887535, 'recall': 0.3560625758363668, 'f1-score': 0.4126924332605038, 'support': 46152}, 'accuracy': 0.44787860738437846, 'macro avg': {'precision': 0.4553441341106437, 'recall': 0.4482045169994679, 'f1-score': 0.446020040662626, 'support': 137669}, 'weighted avg': {'precision': 0.4555385308721468, 'recall': 0.44787860738437846, 'f1-score': 0.44594969198877016, 'support': 137669}}
[[21735 16308  7917]
 [12930 23491  9136]
 [11630 18089 16433]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0611813
{'0': {'precision': 0.4707743296173546, 'recall': 0.40567731885155456, 'f1-score': 0.43580833730403157, 'support': 46219}, '1': {'precision': 0.37671271497039754, 'recall': 0.5910427955324561, 'f1-score': 0.4601437734062245, 'support': 45215}, '2': {'precision': 0.4913200252778707, 'recall': 0.28586568616848707, 'f1-score': 0.3614362283964121, 'support': 46235}, 'accuracy': 0.4263196507565247, 'macro avg': {'precision': 0.44626902328854096, 'recall': 0.4275286001841659, 'f1-score': 0.41912944636888944, 'support': 137669}, 'weighted avg': {'precision': 0.44678152319471615, 'recall': 0.4263196507565247, 'f1-score': 0.41882362969387144, 'support': 137669}}
[[18750 21036  6433]
 [11240 26724  7251]
 [ 9838 23180 13217]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0759498
{'0': {'precision': 0.45641040395902865, 'recall': 0.3454260392395967, 'f1-score': 0.39323739758797205, 'support': 45923}, '1': {'precision': 0.3631842647022348, 'recall': 0.644547155276769, 'f1-score': 0.4645868532311671, 'support': 45435}, '2': {'precision': 0.47389918757574395, 'recall': 0.22798039342704757, 'f1-score': 0.3078582883802303, 'support': 46311}, 'accuracy': 0.4046372095388214, 'macro avg': {'precision': 0.4311646187456691, 'recall': 0.40598452931447104, 'f1-score': 0.3885608463997898, 'support': 137669}, 'weighted avg': {'precision': 0.4315260321755572, 'recall': 0.4046372095388214, 'f1-score': 0.38806390602944285, 'support': 137669}}
[[15863 24479  5581]
 [10010 29285  6140]
 [ 8883 26870 10558]]
Evaluating performance on  val set...
209/209 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0332569
{'0': {'precision': 0.46270776351777826, 'recall': 0.5188133993866478, 'f1-score': 0.4891570284697509, 'support': 16956}, '1': {'precision': 0.4680332739156269, 'recall': 0.39682619647355166, 'f1-score': 0.4294983642311887, 'support': 19850}, '2': {'precision': 0.438413597733711, 'recall': 0.4637420592113149, 'f1-score': 0.4507222739981361, 'support': 16686}, 'accuracy': 0.4563673072608988, 'macro avg': {'precision': 0.45638487838903874, 'recall': 0.4597938850238381, 'f1-score': 0.4564592222330252, 'support': 53492}, 'weighted avg': {'precision': 0.4571057843643413, 'recall': 0.4563673072608988, 'f1-score': 0.4550295552354575, 'support': 53492}}
[[8797 4276 3883]
 [5944 7877 6029]
 [4271 4677 7738]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0515506
{'0': {'precision': 0.4587342377338194, 'recall': 0.4458384155195446, 'f1-score': 0.4521944035346097, 'support': 17217}, '1': {'precision': 0.41112432531332904, 'recall': 0.4727540500736377, 'f1-score': 0.43979057591623033, 'support': 19012}, '2': {'precision': 0.45015774988252666, 'recall': 0.38846087006893354, 'f1-score': 0.4170398009950248, 'support': 17263}, 'accuracy': 0.43688775891722126, 'macro avg': {'precision': 0.44000543764322503, 'recall': 0.4356844452207053, 'f1-score': 0.43634159348195495, 'support': 53492}, 'weighted avg': {'precision': 0.43904502131425704, 'recall': 0.43688775891722126, 'f1-score': 0.4364407305681571, 'support': 53492}}
[[7676 6146 3395]
 [5228 8988 4796]
 [3829 6728 6706]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0642794
{'0': {'precision': 0.45892630689023534, 'recall': 0.37318819822400456, 'f1-score': 0.4116401782046826, 'support': 17455}, '1': {'precision': 0.3797303175293606, 'recall': 0.5668831168831169, 'f1-score': 0.45480593904662675, 'support': 18480}, '2': {'precision': 0.45755764304013663, 'recall': 0.305177422110839, 'f1-score': 0.36614617145590594, 'support': 17557}, 'accuracy': 0.41778209825768337, 'macro avg': {'precision': 0.43207142248657754, 'recall': 0.41508291240598677, 'f1-score': 0.41086409623573844, 'support': 53492}, 'weighted avg': {'precision': 0.4311170734608412, 'recall': 0.41778209825768337, 'f1-score': 0.41162082921550397, 'support': 53492}}
[[ 6514  8198  2743]
 [ 4395 10476  3609]
 [ 3285  8914  5358]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0753788
{'0': {'precision': 0.4514757583190254, 'recall': 0.31617520755797307, 'f1-score': 0.3719019396551724, 'support': 17465}, '1': {'precision': 0.37814675950723087, 'recall': 0.6430561508786969, 'f1-score': 0.4762414935618912, 'support': 18664}, '2': {'precision': 0.44612476370510395, 'recall': 0.24465818118988655, 'f1-score': 0.31601264645713223, 'support': 17363}, 'accuracy': 0.4070141329544605, 'macro avg': {'precision': 0.42524909384378673, 'recall': 0.4012965132088522, 'f1-score': 0.3880520265580653, 'support': 53492}, 'weighted avg': {'precision': 0.4241535091358793, 'recall': 0.4070141329544605, 'f1-score': 0.3901661218939638, 'support': 53492}}
[[ 5522  9588  2355]
 [ 3743 12002  2919]
 [ 2966 10149  4248]]
training model: results/PCAR/W4/deepVOL_L3/seq2seq
Epoch 1/50
538/538 - 31s - loss: 13.1890 - accuracy10: 0.3713 - accuracy20: 0.3655 - accuracy30: 0.3594 - accuracy50: 0.3680 - val_loss: 13.1574 - val_accuracy10: 0.3687 - val_accuracy20: 0.3688 - val_accuracy30: 0.3679 - val_accuracy50: 0.3659 - 31s/epoch - 58ms/step
Epoch 2/50
538/538 - 25s - loss: 13.0603 - accuracy10: 0.3929 - accuracy20: 0.3877 - accuracy30: 0.3802 - accuracy50: 0.3841 - val_loss: 12.9713 - val_accuracy10: 0.3970 - val_accuracy20: 0.3911 - val_accuracy30: 0.3882 - val_accuracy50: 0.3815 - 25s/epoch - 47ms/step
Epoch 3/50
538/538 - 25s - loss: 12.9098 - accuracy10: 0.4208 - accuracy20: 0.4117 - accuracy30: 0.4021 - accuracy50: 0.4035 - val_loss: 12.8477 - val_accuracy10: 0.4263 - val_accuracy20: 0.4134 - val_accuracy30: 0.4062 - val_accuracy50: 0.4023 - 25s/epoch - 47ms/step
Epoch 4/50
538/538 - 25s - loss: 12.7806 - accuracy10: 0.4456 - accuracy20: 0.4320 - accuracy30: 0.4192 - accuracy50: 0.4148 - val_loss: 12.7764 - val_accuracy10: 0.4333 - val_accuracy20: 0.4228 - val_accuracy30: 0.4149 - val_accuracy50: 0.4052 - 25s/epoch - 47ms/step
Epoch 5/50
538/538 - 25s - loss: 12.7087 - accuracy10: 0.4552 - accuracy20: 0.4410 - accuracy30: 0.4267 - accuracy50: 0.4196 - val_loss: 12.7643 - val_accuracy10: 0.4371 - val_accuracy20: 0.4218 - val_accuracy30: 0.4134 - val_accuracy50: 0.4004 - 25s/epoch - 47ms/step
Epoch 6/50
538/538 - 25s - loss: 12.6608 - accuracy10: 0.4609 - accuracy20: 0.4460 - accuracy30: 0.4297 - accuracy50: 0.4237 - val_loss: 12.8291 - val_accuracy10: 0.4336 - val_accuracy20: 0.4240 - val_accuracy30: 0.4155 - val_accuracy50: 0.4020 - 25s/epoch - 47ms/step
Epoch 7/50
538/538 - 25s - loss: 12.6277 - accuracy10: 0.4673 - accuracy20: 0.4502 - accuracy30: 0.4330 - accuracy50: 0.4252 - val_loss: 12.7517 - val_accuracy10: 0.4409 - val_accuracy20: 0.4254 - val_accuracy30: 0.4166 - val_accuracy50: 0.4005 - 25s/epoch - 47ms/step
Epoch 8/50
538/538 - 25s - loss: 12.5962 - accuracy10: 0.4707 - accuracy20: 0.4534 - accuracy30: 0.4360 - accuracy50: 0.4256 - val_loss: 12.7521 - val_accuracy10: 0.4426 - val_accuracy20: 0.4269 - val_accuracy30: 0.4174 - val_accuracy50: 0.4044 - 25s/epoch - 47ms/step
Epoch 9/50
538/538 - 27s - loss: 12.5673 - accuracy10: 0.4739 - accuracy20: 0.4562 - accuracy30: 0.4392 - accuracy50: 0.4283 - val_loss: 12.6872 - val_accuracy10: 0.4506 - val_accuracy20: 0.4349 - val_accuracy30: 0.4240 - val_accuracy50: 0.4111 - 27s/epoch - 49ms/step
Epoch 10/50
538/538 - 25s - loss: 12.5407 - accuracy10: 0.4783 - accuracy20: 0.4593 - accuracy30: 0.4408 - accuracy50: 0.4305 - val_loss: 12.6977 - val_accuracy10: 0.4465 - val_accuracy20: 0.4319 - val_accuracy30: 0.4214 - val_accuracy50: 0.4098 - 25s/epoch - 47ms/step
Epoch 11/50
538/538 - 25s - loss: 12.5110 - accuracy10: 0.4799 - accuracy20: 0.4601 - accuracy30: 0.4425 - accuracy50: 0.4317 - val_loss: 12.7003 - val_accuracy10: 0.4489 - val_accuracy20: 0.4355 - val_accuracy30: 0.4242 - val_accuracy50: 0.4107 - 25s/epoch - 47ms/step
Epoch 12/50
538/538 - 25s - loss: 12.4866 - accuracy10: 0.4832 - accuracy20: 0.4642 - accuracy30: 0.4463 - accuracy50: 0.4338 - val_loss: 12.7001 - val_accuracy10: 0.4511 - val_accuracy20: 0.4346 - val_accuracy30: 0.4235 - val_accuracy50: 0.4088 - 25s/epoch - 47ms/step
Epoch 13/50
538/538 - 25s - loss: 12.4695 - accuracy10: 0.4850 - accuracy20: 0.4656 - accuracy30: 0.4464 - accuracy50: 0.4365 - val_loss: 12.7008 - val_accuracy10: 0.4496 - val_accuracy20: 0.4339 - val_accuracy30: 0.4225 - val_accuracy50: 0.4119 - 25s/epoch - 46ms/step
Epoch 14/50
538/538 - 25s - loss: 12.4472 - accuracy10: 0.4883 - accuracy20: 0.4669 - accuracy30: 0.4495 - accuracy50: 0.4386 - val_loss: 12.6773 - val_accuracy10: 0.4530 - val_accuracy20: 0.4365 - val_accuracy30: 0.4248 - val_accuracy50: 0.4106 - 25s/epoch - 46ms/step
Epoch 15/50
538/538 - 25s - loss: 12.4311 - accuracy10: 0.4906 - accuracy20: 0.4681 - accuracy30: 0.4480 - accuracy50: 0.4392 - val_loss: 12.6843 - val_accuracy10: 0.4488 - val_accuracy20: 0.4357 - val_accuracy30: 0.4261 - val_accuracy50: 0.4110 - 25s/epoch - 46ms/step
Epoch 16/50
538/538 - 25s - loss: 12.4123 - accuracy10: 0.4895 - accuracy20: 0.4695 - accuracy30: 0.4501 - accuracy50: 0.4412 - val_loss: 12.6918 - val_accuracy10: 0.4465 - val_accuracy20: 0.4352 - val_accuracy30: 0.4260 - val_accuracy50: 0.4110 - 25s/epoch - 46ms/step
Epoch 17/50
538/538 - 25s - loss: 12.3979 - accuracy10: 0.4924 - accuracy20: 0.4707 - accuracy30: 0.4524 - accuracy50: 0.4425 - val_loss: 12.6662 - val_accuracy10: 0.4545 - val_accuracy20: 0.4388 - val_accuracy30: 0.4268 - val_accuracy50: 0.4111 - 25s/epoch - 46ms/step
Epoch 18/50
538/538 - 25s - loss: 12.3747 - accuracy10: 0.4946 - accuracy20: 0.4729 - accuracy30: 0.4534 - accuracy50: 0.4444 - val_loss: 12.6672 - val_accuracy10: 0.4522 - val_accuracy20: 0.4394 - val_accuracy30: 0.4282 - val_accuracy50: 0.4132 - 25s/epoch - 46ms/step
Epoch 19/50
538/538 - 25s - loss: 12.3600 - accuracy10: 0.4957 - accuracy20: 0.4741 - accuracy30: 0.4559 - accuracy50: 0.4445 - val_loss: 12.7046 - val_accuracy10: 0.4463 - val_accuracy20: 0.4368 - val_accuracy30: 0.4266 - val_accuracy50: 0.4096 - 25s/epoch - 46ms/step
Epoch 20/50
538/538 - 25s - loss: 12.3465 - accuracy10: 0.4962 - accuracy20: 0.4754 - accuracy30: 0.4561 - accuracy50: 0.4454 - val_loss: 12.6751 - val_accuracy10: 0.4520 - val_accuracy20: 0.4385 - val_accuracy30: 0.4280 - val_accuracy50: 0.4136 - 25s/epoch - 46ms/step
Epoch 21/50
538/538 - 25s - loss: 12.3269 - accuracy10: 0.4973 - accuracy20: 0.4762 - accuracy30: 0.4580 - accuracy50: 0.4471 - val_loss: 12.6752 - val_accuracy10: 0.4509 - val_accuracy20: 0.4398 - val_accuracy30: 0.4297 - val_accuracy50: 0.4148 - 25s/epoch - 47ms/step
Epoch 22/50
538/538 - 25s - loss: 12.3162 - accuracy10: 0.4998 - accuracy20: 0.4781 - accuracy30: 0.4592 - accuracy50: 0.4483 - val_loss: 12.6869 - val_accuracy10: 0.4511 - val_accuracy20: 0.4392 - val_accuracy30: 0.4295 - val_accuracy50: 0.4124 - 25s/epoch - 46ms/step
Epoch 23/50
538/538 - 25s - loss: 12.2988 - accuracy10: 0.5005 - accuracy20: 0.4808 - accuracy30: 0.4612 - accuracy50: 0.4510 - val_loss: 12.7064 - val_accuracy10: 0.4472 - val_accuracy20: 0.4338 - val_accuracy30: 0.4249 - val_accuracy50: 0.4144 - 25s/epoch - 47ms/step
Epoch 24/50
538/538 - 25s - loss: 12.2807 - accuracy10: 0.5013 - accuracy20: 0.4799 - accuracy30: 0.4620 - accuracy50: 0.4521 - val_loss: 12.7157 - val_accuracy10: 0.4461 - val_accuracy20: 0.4360 - val_accuracy30: 0.4255 - val_accuracy50: 0.4121 - 25s/epoch - 47ms/step
Epoch 25/50
538/538 - 25s - loss: 12.2738 - accuracy10: 0.5027 - accuracy20: 0.4822 - accuracy30: 0.4641 - accuracy50: 0.4533 - val_loss: 12.7143 - val_accuracy10: 0.4475 - val_accuracy20: 0.4380 - val_accuracy30: 0.4278 - val_accuracy50: 0.4132 - 25s/epoch - 47ms/step
Epoch 26/50
538/538 - 25s - loss: 12.2553 - accuracy10: 0.5020 - accuracy20: 0.4825 - accuracy30: 0.4657 - accuracy50: 0.4533 - val_loss: 12.7474 - val_accuracy10: 0.4429 - val_accuracy20: 0.4335 - val_accuracy30: 0.4249 - val_accuracy50: 0.4145 - 25s/epoch - 47ms/step
Epoch 27/50
538/538 - 25s - loss: 12.2391 - accuracy10: 0.5045 - accuracy20: 0.4835 - accuracy30: 0.4655 - accuracy50: 0.4547 - val_loss: 12.7591 - val_accuracy10: 0.4445 - val_accuracy20: 0.4341 - val_accuracy30: 0.4218 - val_accuracy50: 0.4124 - 25s/epoch - 47ms/step
testing model: results/PCAR/W4/deepVOL_L3/seq2seq
Evaluating performance on  test set...
1590/1590 - 33s - 33s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0209233
{'0': {'precision': 0.4423005646761288, 'recall': 0.49698677119059287, 'f1-score': 0.46805172632574665, 'support': 122460}, '1': {'precision': 0.5190664578697217, 'recall': 0.45492249811888635, 'f1-score': 0.4848823146339194, 'support': 166125}, '2': {'precision': 0.43083894731740413, 'recall': 0.4504433747149734, 'f1-score': 0.4404231074118113, 'support': 118410}, 'accuracy': 0.46627599847663975, 'macro avg': {'precision': 0.46406865662108493, 'recall': 0.4674508813414842, 'f1-score': 0.46445238279049245, 'support': 406995}, 'weighted avg': {'precision': 0.4702998371373115, 'recall': 0.46627599847663975, 'f1-score': 0.46688335009777354, 'support': 406995}}
[[60861 34134 27465]
 [47555 75574 42996]
 [29185 35888 53337]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0395792
{'0': {'precision': 0.4437388832554815, 'recall': 0.4260168051133507, 'f1-score': 0.4346972923019301, 'support': 125319}, '1': {'precision': 0.4662577752061334, 'recall': 0.5001986368545854, 'f1-score': 0.48263222359645785, 'support': 161098}, '2': {'precision': 0.42743465430016864, 'recall': 0.4036059646038249, 'f1-score': 0.41517868568552335, 'support': 120578}, 'accuracy': 0.44874015651297927, 'macro avg': {'precision': 0.44581043758726113, 'recall': 0.44327380219058704, 'f1-score': 0.44416940052797044, 'support': 406995}, 'weighted avg': {'precision': 0.44782202220434425, 'recall': 0.44874015651297927, 'f1-score': 0.44788838067670805, 'support': 406995}}
[[53388 45816 26115]
 [41442 80581 39075]
 [25484 46428 48666]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.056833
{'0': {'precision': 0.4525992397211663, 'recall': 0.3585164306232624, 'f1-score': 0.4001014155200124, 'support': 129849}, '1': {'precision': 0.4165450218960587, 'recall': 0.5515260228092588, 'f1-score': 0.4746251228230067, 'support': 151079}, '2': {'precision': 0.4342952104666577, 'recall': 0.3586267619599102, 'f1-score': 0.3928504707410642, 'support': 126067}, 'accuracy': 0.43019693116623053, 'macro avg': {'precision': 0.43447982402796087, 'recall': 0.42288973846414374, 'f1-score': 0.4225256696946944, 'support': 406995}, 'weighted avg': {'precision': 0.4335460099988661, 'recall': 0.43019693116623053, 'f1-score': 0.4255190799143696, 'support': 406995}}
[[46553 58389 24907]
 [33771 83324 33984]
 [22533 58323 45211]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0611225
{'0': {'precision': 0.4054496871598069, 'recall': 0.3073921851422664, 'f1-score': 0.3496766117254329, 'support': 119951}, '1': {'precision': 0.45141396113480203, 'recall': 0.5871303854741343, 'f1-score': 0.5104044981321968, 'support': 169298}, '2': {'precision': 0.3931585591036648, 'recall': 0.32007032086015663, 'f1-score': 0.35286957580183803, 'support': 117746}, 'accuracy': 0.42742294131377534, 'macro avg': {'precision': 0.4166740691327579, 'recall': 0.40486429715885247, 'f1-score': 0.4043168952198226, 'support': 406995}, 'weighted avg': {'precision': 0.42101358472935985, 'recall': 0.42742294131377534, 'f1-score': 0.41745844801588544, 'support': 406995}}
[[36872 60609 22470]
 [34198 99400 35700]
 [19871 60188 37687]]
Evaluating performance on  train set...
538/538 - 11s - 11s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0230882
{'0': {'precision': 0.47159375638003675, 'recall': 0.5511235467638382, 'f1-score': 0.5082664052888991, 'support': 46104}, '1': {'precision': 0.4732074648041035, 'recall': 0.38361496947713, 'f1-score': 0.4237271572363921, 'support': 45212}, '2': {'precision': 0.4861258432687004, 'recall': 0.4943585096973227, 'f1-score': 0.4902076135670813, 'support': 46353}, 'accuracy': 0.4769991791906675, 'macro avg': {'precision': 0.4769756881509469, 'recall': 0.47636567531276364, 'f1-score': 0.4740670586974575, 'support': 137669}, 'weighted avg': {'precision': 0.477016653392575, 'recall': 0.4769991791906675, 'f1-score': 0.47442241967389964, 'support': 137669}}
[[25409  9520 11175]
 [14820 17344 13048]
 [13650  9788 22915]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0410945
{'0': {'precision': 0.46623277829431153, 'recall': 0.4800696257615318, 'f1-score': 0.4730500407358175, 'support': 45960}, '1': {'precision': 0.42391399544578734, 'recall': 0.424984085870448, 'f1-score': 0.4244483661993445, 'support': 45557}, '2': {'precision': 0.47476104134488395, 'recall': 0.4595467152019414, 'f1-score': 0.4670300027525461, 'support': 46152}, 'accuracy': 0.45496081180222125, 'macro avg': {'precision': 0.45496927169499424, 'recall': 0.4548668089446404, 'f1-score': 0.45484280322923604, 'support': 137669}, 'weighted avg': {'precision': 0.4550877827330726, 'recall': 0.45496081180222125, 'f1-score': 0.4549487740754797, 'support': 137669}}
[[22064 13195 10701]
 [13433 19361 12763]
 [11827 13116 21209]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.055266
{'0': {'precision': 0.468730634806534, 'recall': 0.4091390986390878, 'f1-score': 0.4369122709734064, 'support': 46219}, '1': {'precision': 0.3930532797954517, 'recall': 0.4827822625234988, 'f1-score': 0.4333214228997935, 'support': 45215}, '2': {'precision': 0.46753930460168946, 'recall': 0.4225802963123175, 'f1-score': 0.4439243842588385, 'support': 46235}, 'accuracy': 0.437840036609549, 'macro avg': {'precision': 0.4431077397345584, 'recall': 0.4381672191583014, 'f1-score': 0.4380526927106794, 'support': 137669}, 'weighted avg': {'precision': 0.4434756190887829, 'recall': 0.437840036609549, 'f1-score': 0.43808787958611906, 'support': 137669}}
[[18910 17067 10242]
 [11377 21829 12009]
 [10056 16641 19538]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0711429
{'0': {'precision': 0.45476197227026566, 'recall': 0.34925854147159374, 'f1-score': 0.3950881860281801, 'support': 45923}, '1': {'precision': 0.3736281015126262, 'recall': 0.5229888852206449, 'f1-score': 0.43586803995120743, 'support': 45435}, '2': {'precision': 0.4484047214061131, 'recall': 0.3756990779728358, 'f1-score': 0.40884471232361685, 'support': 46311}, 'accuracy': 0.4154893258467774, 'macro avg': {'precision': 0.4255982650630017, 'recall': 0.4159821682216915, 'f1-score': 0.4132669794343348, 'support': 137669}, 'weighted avg': {'precision': 0.42584676214566886, 'recall': 0.4154893258467774, 'f1-score': 0.4131744011692846, 'support': 137669}}
[[16039 19963  9921]
 [10191 23762 11482]
 [ 9039 19873 17399]]
Evaluating performance on  val set...
209/209 - 4s - 4s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0355401
{'0': {'precision': 0.44958086180695134, 'recall': 0.5408704883227177, 'f1-score': 0.4910186052737251, 'support': 16956}, '1': {'precision': 0.48031847607708905, 'recall': 0.3251889168765743, 'f1-score': 0.38781579500735974, 'support': 19850}, '2': {'precision': 0.4349750686883077, 'recall': 0.5123456790123457, 'f1-score': 0.4705008255365988, 'support': 16686}, 'accuracy': 0.45193673820384356, 'macro avg': {'precision': 0.45495813552411607, 'recall': 0.45946836140387926, 'f1-score': 0.4497784086058945, 'support': 53492}, 'weighted avg': {'precision': 0.4564310334080234, 'recall': 0.45193673820384356, 'f1-score': 0.4463215392361673, 'support': 53492}}
[[9171 3531 4254]
 [6544 6455 6851]
 [4684 3453 8549]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.050568
{'0': {'precision': 0.44825457402626556, 'recall': 0.46390195736771794, 'f1-score': 0.45594405594405596, 'support': 17217}, '1': {'precision': 0.425076807141615, 'recall': 0.38570376604249945, 'f1-score': 0.4044342718473375, 'support': 19012}, '2': {'precision': 0.44401020463550994, 'recall': 0.4738457973700979, 'f1-score': 0.4584430869248445, 'support': 17263}, 'accuracy': 0.43931802886412924, 'macro avg': {'precision': 0.4391138619344635, 'recall': 0.44115050692677177, 'f1-score': 0.43960713823874603, 'support': 53492}, 'weighted avg': {'precision': 0.4386470392022996, 'recall': 0.43931802886412924, 'f1-score': 0.43844306059100396, 'support': 53492}}
[[7987 5043 4187]
 [5623 7333 6056]
 [4208 4875 8180]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0603511
{'0': {'precision': 0.4491424802110818, 'recall': 0.3900887997708393, 'f1-score': 0.41753794266441824, 'support': 17455}, '1': {'precision': 0.39514348785871967, 'recall': 0.45524891774891774, 'f1-score': 0.4230720877020945, 'support': 18480}, '2': {'precision': 0.44492694090722373, 'recall': 0.431850543942587, 'f1-score': 0.4382912307069773, 'support': 17557}, 'accuracy': 0.4263067374560682, 'macro avg': {'precision': 0.4297376363256751, 'recall': 0.425729420487448, 'f1-score': 0.42630042035783, 'support': 53492}, 'weighted avg': {'precision': 0.42910371549431126, 'recall': 0.4263067374560682, 'f1-score': 0.4262614242777336, 'support': 53492}}
[[6809 6563 4083]
 [4691 8413 5376]
 [3660 6315 7582]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0726408
{'0': {'precision': 0.44119204296195447, 'recall': 0.33398225021471517, 'f1-score': 0.3801733689630451, 'support': 17465}, '1': {'precision': 0.38987115392431815, 'recall': 0.513930561508787, 'f1-score': 0.44338641458848543, 'support': 18664}, '2': {'precision': 0.4293464386009701, 'recall': 0.38743304728445543, 'f1-score': 0.407314341073537, 'support': 17363}, 'accuracy': 0.41411799895311446, 'macro avg': {'precision': 0.4201365451624142, 'recall': 0.4117819530026525, 'f1-score': 0.4102913748750225, 'support': 53492}, 'weighted avg': {'precision': 0.4194405978576732, 'recall': 0.41411799895311446, 'f1-score': 0.41103886253792904, 'support': 53492}}
[[5833 7718 3914]
 [4045 9592 5027]
 [3343 7293 6727]]
training model: results/PCAR/W5/deepLOB_L1/seq2seq
Epoch 1/50
694/694 - 28s - loss: 12.9532 - accuracy10: 0.4094 - accuracy20: 0.4042 - accuracy30: 0.3966 - accuracy50: 0.3906 - val_loss: 13.1945 - val_accuracy10: 0.3618 - val_accuracy20: 0.3683 - val_accuracy30: 0.3611 - val_accuracy50: 0.3616 - 28s/epoch - 40ms/step
Epoch 2/50
694/694 - 20s - loss: 12.8434 - accuracy10: 0.4303 - accuracy20: 0.4167 - accuracy30: 0.4073 - accuracy50: 0.3961 - val_loss: 13.0390 - val_accuracy10: 0.3900 - val_accuracy20: 0.3886 - val_accuracy30: 0.3823 - val_accuracy50: 0.3679 - 20s/epoch - 29ms/step
Epoch 3/50
694/694 - 20s - loss: 12.7888 - accuracy10: 0.4414 - accuracy20: 0.4240 - accuracy30: 0.4131 - accuracy50: 0.4003 - val_loss: 12.8985 - val_accuracy10: 0.4296 - val_accuracy20: 0.4098 - val_accuracy30: 0.3998 - val_accuracy50: 0.3793 - 20s/epoch - 29ms/step
Epoch 4/50
694/694 - 19s - loss: 12.7526 - accuracy10: 0.4498 - accuracy20: 0.4300 - accuracy30: 0.4181 - accuracy50: 0.4034 - val_loss: 12.9650 - val_accuracy10: 0.4171 - val_accuracy20: 0.3991 - val_accuracy30: 0.3904 - val_accuracy50: 0.3737 - 19s/epoch - 28ms/step
Epoch 5/50
694/694 - 19s - loss: 12.7172 - accuracy10: 0.4554 - accuracy20: 0.4335 - accuracy30: 0.4209 - accuracy50: 0.4057 - val_loss: 12.9430 - val_accuracy10: 0.4262 - val_accuracy20: 0.4069 - val_accuracy30: 0.3979 - val_accuracy50: 0.3766 - 19s/epoch - 28ms/step
Epoch 6/50
694/694 - 19s - loss: 12.6980 - accuracy10: 0.4586 - accuracy20: 0.4349 - accuracy30: 0.4221 - accuracy50: 0.4065 - val_loss: 12.9559 - val_accuracy10: 0.4173 - val_accuracy20: 0.4025 - val_accuracy30: 0.3938 - val_accuracy50: 0.3768 - 19s/epoch - 28ms/step
Epoch 7/50
694/694 - 19s - loss: 12.6775 - accuracy10: 0.4625 - accuracy20: 0.4372 - accuracy30: 0.4244 - accuracy50: 0.4078 - val_loss: 12.9540 - val_accuracy10: 0.4232 - val_accuracy20: 0.4033 - val_accuracy30: 0.3932 - val_accuracy50: 0.3789 - 19s/epoch - 28ms/step
Epoch 8/50
694/694 - 19s - loss: 12.6587 - accuracy10: 0.4639 - accuracy20: 0.4402 - accuracy30: 0.4271 - accuracy50: 0.4106 - val_loss: 12.9521 - val_accuracy10: 0.4221 - val_accuracy20: 0.4049 - val_accuracy30: 0.3952 - val_accuracy50: 0.3818 - 19s/epoch - 28ms/step
Epoch 9/50
694/694 - 19s - loss: 12.6405 - accuracy10: 0.4665 - accuracy20: 0.4417 - accuracy30: 0.4278 - accuracy50: 0.4109 - val_loss: 12.9287 - val_accuracy10: 0.4203 - val_accuracy20: 0.4052 - val_accuracy30: 0.3964 - val_accuracy50: 0.3842 - 19s/epoch - 28ms/step
Epoch 10/50
694/694 - 19s - loss: 12.6224 - accuracy10: 0.4681 - accuracy20: 0.4434 - accuracy30: 0.4308 - accuracy50: 0.4134 - val_loss: 12.9807 - val_accuracy10: 0.4138 - val_accuracy20: 0.3983 - val_accuracy30: 0.3839 - val_accuracy50: 0.3673 - 19s/epoch - 28ms/step
Epoch 11/50
694/694 - 19s - loss: 12.6087 - accuracy10: 0.4713 - accuracy20: 0.4461 - accuracy30: 0.4319 - accuracy50: 0.4148 - val_loss: 12.9551 - val_accuracy10: 0.4154 - val_accuracy20: 0.4002 - val_accuracy30: 0.3882 - val_accuracy50: 0.3751 - 19s/epoch - 27ms/step
Epoch 12/50
694/694 - 19s - loss: 12.5961 - accuracy10: 0.4721 - accuracy20: 0.4466 - accuracy30: 0.4322 - accuracy50: 0.4155 - val_loss: 12.9774 - val_accuracy10: 0.4206 - val_accuracy20: 0.4013 - val_accuracy30: 0.3854 - val_accuracy50: 0.3655 - 19s/epoch - 28ms/step
Epoch 13/50
694/694 - 19s - loss: 12.5826 - accuracy10: 0.4733 - accuracy20: 0.4478 - accuracy30: 0.4338 - accuracy50: 0.4162 - val_loss: 13.0994 - val_accuracy10: 0.4044 - val_accuracy20: 0.3925 - val_accuracy30: 0.3754 - val_accuracy50: 0.3640 - 19s/epoch - 28ms/step
testing model: results/PCAR/W5/deepLOB_L1/seq2seq
Evaluating performance on  test set...
2900/2900 - 38s - 38s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.069963
{'0': {'precision': 0.4591407082913312, 'recall': 0.42308706770998583, 'f1-score': 0.4403771933314765, 'support': 261601}, '1': {'precision': 0.38517890485081735, 'recall': 0.18671783362426458, 'f1-score': 0.25151313456789354, 'support': 216546}, '2': {'precision': 0.43010695713388186, 'recall': 0.6451775285661838, 'f1-score': 0.5161338181906264, 'support': 264211}, 'accuracy': 0.433181834101606, 'macro avg': {'precision': 0.4248088567586768, 'recall': 0.4183274766334781, 'f1-score': 0.40267471536333216, 'support': 742358}, 'weighted avg': {'precision': 0.4272326947521892, 'recall': 0.433181834101606, 'f1-score': 0.4122478772085843, 'support': 742358}}
[[110680  31443 119478]
 [ 69727  40433 106386]
 [ 60652  33096 170463]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0790342
{'0': {'precision': 0.43947375789503157, 'recall': 0.4197199778427215, 'f1-score': 0.4293697876364887, 'support': 261765}, '1': {'precision': 0.3598060344827586, 'recall': 0.15456329735034346, 'f1-score': 0.21623686971388603, 'support': 216028}, '2': {'precision': 0.4175403382228907, 'recall': 0.6305898361461266, 'f1-score': 0.5024122001313007, 'support': 264565}, 'accuracy': 0.4177095148163016, 'macro avg': {'precision': 0.4056067102002269, 'recall': 0.40162437044639726, 'f1-score': 0.3826729524938918, 'support': 742358}, 'weighted avg': {'precision': 0.4084735206390628, 'recall': 0.4177095148163016, 'f1-score': 0.3933787804252859, 'support': 742358}}
[[109868  28462 123435]
 [ 73346  33390 109292]
 [ 66785  30948 166832]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0840912
{'0': {'precision': 0.42200843609294314, 'recall': 0.4186185773841536, 'f1-score': 0.4203066718748803, 'support': 262179}, '1': {'precision': 0.3444447467958312, 'recall': 0.11714404701309518, 'f1-score': 0.17482942460153036, 'support': 216110}, '2': {'precision': 0.4078162955279889, 'recall': 0.631312270656533, 'f1-score': 0.4955295040840834, 'support': 264069}, 'accuracy': 0.40651410774855257, 'macro avg': {'precision': 0.3914231594722544, 'recall': 0.3890249650179272, 'f1-score': 0.36355520018683135, 'support': 742358}, 'weighted avg': {'precision': 0.3943802657750564, 'recall': 0.40651410774855257, 'f1-score': 0.3756030789593441, 'support': 742358}}
[[109753  22862 129564]
 [ 78281  25316 112513]
 [ 72039  25320 166710]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0876405
{'0': {'precision': 0.435846585454789, 'recall': 0.4108813996885216, 'f1-score': 0.4229959520017911, 'support': 285092}, '1': {'precision': 0.2529543216422998, 'recall': 0.07787475440038713, 'f1-score': 0.11908720906906559, 'support': 171519}, '2': {'precision': 0.42428563280670734, 'recall': 0.6248044598893426, 'f1-score': 0.5053818685168122, 'support': 285747}, 'accuracy': 0.41628432643010516, 'macro avg': {'precision': 0.37102884663459873, 'recall': 0.3711868713260838, 'f1-score': 0.34915500986255626, 'support': 742358}, 'weighted avg': {'precision': 0.3891400021982124, 'recall': 0.41628432643010516, 'f1-score': 0.3844908167534872, 'support': 742358}}
[[117139  18854 149099]
 [ 65005  13357  93157]
 [ 86618  20593 178536]]
Evaluating performance on  train set...
694/694 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0616308
{'0': {'precision': 0.4482594861566225, 'recall': 0.4704367617497051, 'f1-score': 0.4590804448623585, 'support': 60193}, '1': {'precision': 0.4197694197694198, 'recall': 0.1925978598310758, 'f1-score': 0.2640464132011318, 'support': 57659}, '2': {'precision': 0.42590024552150585, 'recall': 0.6270962343096235, 'f1-score': 0.5072769857709544, 'support': 59750}, 'accuracy': 0.43293994436999583, 'macro avg': {'precision': 0.4313097171491827, 'recall': 0.4300436186301348, 'f1-score': 0.41013461461148154, 'support': 177602}, 'weighted avg': {'precision': 0.4314878655342875, 'recall': 0.43293994436999583, 'f1-score': 0.41197667400242416, 'support': 177602}}
[[28317  7499 24377]
 [20424 11105 26130]
 [14430  7851 37469]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0732771
{'0': {'precision': 0.4221991225522418, 'recall': 0.47035882763671044, 'f1-score': 0.44497969968421736, 'support': 58719}, '1': {'precision': 0.4105855759798695, 'recall': 0.15923450990770452, 'f1-score': 0.22947380966569333, 'support': 60458}, '2': {'precision': 0.402600915053303, 'recall': 0.611484809584938, 'f1-score': 0.4855296507953765, 'support': 58425}, 'accuracy': 0.4108737514217182, 'macro avg': {'precision': 0.4117952045284714, 'recall': 0.41369271570978433, 'f1-score': 0.38666105338176243, 'support': 177602}, 'weighted avg': {'precision': 0.4117985804874116, 'recall': 0.4108737514217182, 'f1-score': 0.38495827985183684, 'support': 177602}}
[[27619  6530 24570]
 [22389  9627 28442]
 [15409  7290 35726]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0789572
{'0': {'precision': 0.41357571126263815, 'recall': 0.47167566118057186, 'f1-score': 0.44071910675415377, 'support': 59666}, '1': {'precision': 0.3865282215122471, 'recall': 0.12305475504322766, 'f1-score': 0.1866786678667867, 'support': 58990}, '2': {'precision': 0.39395641923898916, 'recall': 0.6066739049299359, 'f1-score': 0.47770504942559444, 'support': 58946}, 'accuracy': 0.4006880553146924, 'macro avg': {'precision': 0.3980201173379581, 'recall': 0.4004681070512451, 'f1-score': 0.36836760801551166, 'support': 177602}, 'weighted avg': {'precision': 0.39808033278716165, 'recall': 0.4006880553146924, 'f1-score': 0.36861590908039427, 'support': 177602}}
[[28143  5402 26121]
 [22839  7259 28892]
 [17066  6119 35761]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.087613
{'0': {'precision': 0.39368319171043453, 'recall': 0.4656005386751957, 'f1-score': 0.4266323209575666, 'support': 59405}, '1': {'precision': 0.39023502874190497, 'recall': 0.08946683571333244, 'f1-score': 0.14556163230963398, 'support': 59944}, '2': {'precision': 0.3736138116706908, 'recall': 0.6003295967589652, 'f1-score': 0.46058410984162523, 'support': 58253}, 'accuracy': 0.38283915721669803, 'macro avg': {'precision': 0.38584401070767677, 'recall': 0.3851323237158311, 'f1-score': 0.3442593543696086, 'support': 177602}, 'weighted avg': {'precision': 0.38593666702917684, 'recall': 0.38283915721669803, 'f1-score': 0.34290180101720213, 'support': 177602}}
[[27659  3952 27794]
 [23744  5363 30837]
 [18854  4428 34971]]
Evaluating performance on  val set...
238/238 - 3s - 3s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0620496
{'0': {'precision': 0.4424059451927543, 'recall': 0.479607250755287, 'f1-score': 0.46025610050736887, 'support': 19860}, '1': {'precision': 0.4358130348913759, 'recall': 0.22027855682844513, 'f1-score': 0.292642879696874, 'support': 21037}, '2': {'precision': 0.41572603121516166, 'recall': 0.5975463194792189, 'f1-score': 0.4903233759296544, 'support': 19970}, 'accuracy': 0.4286723511919431, 'macro avg': {'precision': 0.4313150037664306, 'recall': 0.4324773756876503, 'f1-score': 0.4144074520446324, 'support': 60867}, 'weighted avg': {'precision': 0.431373810601882, 'recall': 0.4286723511919431, 'f1-score': 0.4121900575611527, 'support': 60867}}
[[ 9525  2880  7455]
 [ 7087  4634  9316]
 [ 4918  3119 11933]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0719931
{'0': {'precision': 0.42085011185682325, 'recall': 0.4791645440652063, 'f1-score': 0.4481181515007146, 'support': 19630}, '1': {'precision': 0.434368789875536, 'recall': 0.19051332629937154, 'f1-score': 0.26485969387755104, 'support': 21799}, '2': {'precision': 0.39325183036330985, 'recall': 0.5858112974585863, 'f1-score': 0.4705955283712857, 'support': 19438}, 'accuracy': 0.4098444148717696, 'macro avg': {'precision': 0.41615691069855637, 'recall': 0.41849638927438804, 'f1-score': 0.3945244579165171, 'support': 60867}, 'weighted avg': {'precision': 0.4168781445585994, 'recall': 0.4098444148717696, 'f1-score': 0.3896638845561111, 'support': 60867}}
[[ 9406  2591  7633]
 [ 7710  4153  9936]
 [ 5234  2817 11387]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0781659
{'0': {'precision': 0.40744401942665576, 'recall': 0.47705314009661837, 'f1-score': 0.43950949257052785, 'support': 19872}, '1': {'precision': 0.42402597402597403, 'recall': 0.1533872028563375, 'f1-score': 0.22528117022010624, 'support': 21286}, '2': {'precision': 0.3867892976588629, 'recall': 0.5867877619361713, 'f1-score': 0.4662460440645851, 'support': 19709}, 'accuracy': 0.39939540309198746, 'macro avg': {'precision': 0.4060864303704976, 'recall': 0.40574270162970905, 'f1-score': 0.3770122356184064, 'support': 60867}, 'weighted avg': {'precision': 0.40655486067527424, 'recall': 0.39939540309198746, 'f1-score': 0.37324840895946276, 'support': 60867}}
[[ 9480  2099  8293]
 [ 7979  3265 10042]
 [ 5808  2336 11565]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0858891
{'0': {'precision': 0.38631732168850075, 'recall': 0.4698295483283597, 'f1-score': 0.42400036516341066, 'support': 19771}, '1': {'precision': 0.4160752306600426, 'recall': 0.10947201344475048, 'f1-score': 0.17333776841482795, 'support': 21421}, '2': {'precision': 0.3696851151157571, 'recall': 0.5859720457433291, 'f1-score': 0.4533532569159081, 'support': 19675}, 'accuracy': 0.3805510375080093, 'macro avg': {'precision': 0.39069255582143353, 'recall': 0.38842453583881315, 'f1-score': 0.3502304634980489, 'support': 60867}, 'weighted avg': {'precision': 0.3914137697434511, 'recall': 0.3805510375080093, 'f1-score': 0.34527255962476083, 'support': 60867}}
[[ 9289  1588  8894]
 [ 8313  2345 10763]
 [ 6443  1703 11529]]
training model: results/PCAR/W5/deepOF_L1/seq2seq
Epoch 1/50
694/694 - 25s - loss: 12.9852 - accuracy10: 0.4165 - accuracy20: 0.4042 - accuracy30: 0.3964 - accuracy50: 0.3907 - val_loss: 13.0156 - val_accuracy10: 0.4149 - val_accuracy20: 0.3929 - val_accuracy30: 0.3833 - val_accuracy50: 0.3723 - 25s/epoch - 35ms/step
Epoch 2/50
694/694 - 18s - loss: 12.9142 - accuracy10: 0.4292 - accuracy20: 0.4135 - accuracy30: 0.4037 - accuracy50: 0.3958 - val_loss: 13.0929 - val_accuracy10: 0.3955 - val_accuracy20: 0.3817 - val_accuracy30: 0.3830 - val_accuracy50: 0.3729 - 18s/epoch - 26ms/step
Epoch 3/50
694/694 - 18s - loss: 12.8993 - accuracy10: 0.4317 - accuracy20: 0.4154 - accuracy30: 0.4066 - accuracy50: 0.3983 - val_loss: 13.0959 - val_accuracy10: 0.3978 - val_accuracy20: 0.3833 - val_accuracy30: 0.3848 - val_accuracy50: 0.3750 - 18s/epoch - 26ms/step
Epoch 4/50
694/694 - 18s - loss: 12.8921 - accuracy10: 0.4310 - accuracy20: 0.4156 - accuracy30: 0.4078 - accuracy50: 0.3990 - val_loss: 13.1041 - val_accuracy10: 0.3980 - val_accuracy20: 0.3844 - val_accuracy30: 0.3863 - val_accuracy50: 0.3765 - 18s/epoch - 26ms/step
Epoch 5/50
694/694 - 18s - loss: 12.8812 - accuracy10: 0.4327 - accuracy20: 0.4169 - accuracy30: 0.4085 - accuracy50: 0.3992 - val_loss: 13.0758 - val_accuracy10: 0.3961 - val_accuracy20: 0.3864 - val_accuracy30: 0.3877 - val_accuracy50: 0.3773 - 18s/epoch - 26ms/step
Epoch 6/50
694/694 - 18s - loss: 12.8767 - accuracy10: 0.4336 - accuracy20: 0.4167 - accuracy30: 0.4080 - accuracy50: 0.3990 - val_loss: 13.0709 - val_accuracy10: 0.3968 - val_accuracy20: 0.3857 - val_accuracy30: 0.3886 - val_accuracy50: 0.3773 - 18s/epoch - 26ms/step
Epoch 7/50
694/694 - 19s - loss: 12.8657 - accuracy10: 0.4338 - accuracy20: 0.4176 - accuracy30: 0.4093 - accuracy50: 0.3992 - val_loss: 13.0586 - val_accuracy10: 0.4014 - val_accuracy20: 0.3867 - val_accuracy30: 0.3892 - val_accuracy50: 0.3787 - 19s/epoch - 27ms/step
Epoch 8/50
694/694 - 18s - loss: 12.8576 - accuracy10: 0.4366 - accuracy20: 0.4197 - accuracy30: 0.4102 - accuracy50: 0.4007 - val_loss: 13.0489 - val_accuracy10: 0.4038 - val_accuracy20: 0.3868 - val_accuracy30: 0.3889 - val_accuracy50: 0.3789 - 18s/epoch - 26ms/step
Epoch 9/50
694/694 - 18s - loss: 12.8527 - accuracy10: 0.4368 - accuracy20: 0.4192 - accuracy30: 0.4111 - accuracy50: 0.4013 - val_loss: 13.0634 - val_accuracy10: 0.4016 - val_accuracy20: 0.3863 - val_accuracy30: 0.3879 - val_accuracy50: 0.3780 - 18s/epoch - 26ms/step
Epoch 10/50
694/694 - 18s - loss: 12.8451 - accuracy10: 0.4365 - accuracy20: 0.4194 - accuracy30: 0.4120 - accuracy50: 0.4025 - val_loss: 13.0793 - val_accuracy10: 0.3924 - val_accuracy20: 0.3834 - val_accuracy30: 0.3859 - val_accuracy50: 0.3761 - 18s/epoch - 27ms/step
Epoch 11/50
694/694 - 18s - loss: 12.8347 - accuracy10: 0.4383 - accuracy20: 0.4214 - accuracy30: 0.4131 - accuracy50: 0.4021 - val_loss: 13.0901 - val_accuracy10: 0.3932 - val_accuracy20: 0.3847 - val_accuracy30: 0.3864 - val_accuracy50: 0.3768 - 18s/epoch - 26ms/step
testing model: results/PCAR/W5/deepOF_L1/seq2seq
Evaluating performance on  test set...
2900/2900 - 39s - 39s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0801394
{'0': {'precision': 0.43495816871949805, 'recall': 0.45788815791988563, 'f1-score': 0.44612872048611435, 'support': 261601}, '1': {'precision': 0.3972384008272632, 'recall': 0.24126385983384363, 'f1-score': 0.30020025225463354, 'support': 216543}, '2': {'precision': 0.41364106569521497, 'recall': 0.5251637907868392, 'f1-score': 0.46277841147865756, 'support': 264209}, 'accuracy': 0.41864315224697685, 'macro avg': {'precision': 0.4152792117473254, 'recall': 0.40810526951352283, 'f1-score': 0.4030357947398018, 'support': 742353}, 'weighted avg': {'precision': 0.4163684652069764, 'recall': 0.41864315224697685, 'f1-score': 0.40948740552032215, 'support': 742353}}
[[119784  40727 101090]
 [ 68699  52244  95600]
 [ 86909  38547 138753]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0844165
{'0': {'precision': 0.4219505729993218, 'recall': 0.46825205814375487, 'f1-score': 0.4438971922340083, 'support': 261765}, '1': {'precision': 0.36438417661349953, 'recall': 0.12774910311306562, 'f1-score': 0.18917538670350045, 'support': 216025}, '2': {'precision': 0.40305427939424876, 'recall': 0.5730204147972316, 'f1-score': 0.47323904971351244, 'support': 264563}, 'accuracy': 0.4065033750789719, 'macro avg': {'precision': 0.39646300966902337, 'recall': 0.389673858684684, 'f1-score': 0.3687705428836738, 'support': 742353}, 'weighted avg': {'precision': 0.3984643866374613, 'recall': 0.4065033750789719, 'f1-score': 0.3802300309247957, 'support': 742353}}
[[122572  24552 114641]
 [ 78541  27597 109887]
 [ 89376  23587 151600]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0869882
{'0': {'precision': 0.4123879063647471, 'recall': 0.48534016835825905, 'f1-score': 0.44589986999288644, 'support': 262179}, '1': {'precision': 0.33741104981210523, 'recall': 0.03905472751923816, 'f1-score': 0.07000634536187225, 'support': 216107}, '2': {'precision': 0.3946377024316258, 'recall': 0.6109055656329644, 'f1-score': 0.4795146593504913, 'support': 264067}, 'accuracy': 0.40008729000893106, 'macro avg': {'precision': 0.38147888620282605, 'recall': 0.37843348717015385, 'f1-score': 0.3318069582350833, 'support': 742353}, 'weighted avg': {'precision': 0.38424729584518386, 'recall': 0.40008729000893106, 'f1-score': 0.3484305186921711, 'support': 742353}}
[[127246   8467 126466]
 [ 86673   8440 120994]
 [ 94640   8107 161320]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0847846
{'0': {'precision': 0.4305254122984489, 'recall': 0.4926339567578185, 'f1-score': 0.45949040751694714, 'support': 285092}, '1': {'precision': 0.2464136282127914, 'recall': 0.009614263392336574, 'f1-score': 0.018506464356257857, 'support': 171516}, '2': {'precision': 0.4196868413275661, 'recall': 0.6013648532782726, 'f1-score': 0.49436265977738336, 'support': 285745}, 'accuracy': 0.4228877636380536, 'macro avg': {'precision': 0.3655419606129355, 'recall': 0.36787102447614256, 'f1-score': 0.3241198438835295, 'support': 742353}, 'weighted avg': {'precision': 0.38381557988541826, 'recall': 0.4228877636380536, 'f1-score': 0.37102679213047945, 'support': 742353}}
[[140446   2526 142120]
 [ 74383   1649  95484]
 [111391   2517 171837]]
Evaluating performance on  train set...
694/694 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0778431
{'0': {'precision': 0.43218345746765974, 'recall': 0.4397905759162304, 'f1-score': 0.4359538343671997, 'support': 60165}, '1': {'precision': 0.4047859343461171, 'recall': 0.2643849636581262, 'f1-score': 0.3198564517990745, 'support': 57647}, '2': {'precision': 0.410817264944237, 'recall': 0.5409265763505603, 'f1-score': 0.46697854399491756, 'support': 59790}, 'accuracy': 0.4169040889179176, 'macro avg': {'precision': 0.4159288855860046, 'recall': 0.41503403864163896, 'f1-score': 0.4075962767203973, 'support': 177602}, 'weighted avg': {'precision': 0.4160976607628759, 'recall': 0.4169040889179176, 'f1-score': 0.4087148481831283, 'support': 177602}}
[[26460 12002 21703]
 [17725 15241 24681]
 [17039 10409 32342]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0830319
{'0': {'precision': 0.4111678183761649, 'recall': 0.46552576405815876, 'f1-score': 0.4366616036453754, 'support': 58667}, '1': {'precision': 0.38845503950312826, 'recall': 0.14047894302229563, 'f1-score': 0.20633861753611413, 'support': 60550}, '2': {'precision': 0.3875921238323514, 'recall': 0.5927036053780936, 'f1-score': 0.46868968693072927, 'support': 58385}, 'accuracy': 0.3965158050021959, 'macro avg': {'precision': 0.39573832723721486, 'recall': 0.3995694374861827, 'f1-score': 0.3705633027040729, 'support': 177602}, 'weighted avg': {'precision': 0.39567404191698696, 'recall': 0.3965158050021959, 'f1-score': 0.3686663267549103, 'support': 177602}}
[[27311  7165 24191]
 [21558  8506 30486]
 [17554  6226 34605]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0852118
{'0': {'precision': 0.40743093922651935, 'recall': 0.49477515557121055, 'f1-score': 0.4468750710125058, 'support': 59619}, '1': {'precision': 0.3612796469939327, 'recall': 0.044295665111246364, 'f1-score': 0.0789156626506024, 'support': 59148}, '2': {'precision': 0.3809800918836141, 'recall': 0.6342653182629387, 'f1-score': 0.4760276812195044, 'support': 58835}, 'accuracy': 0.3909584351527573, 'macro avg': {'precision': 0.3832302260346887, 'recall': 0.39111204631513186, 'f1-score': 0.3339394716275375, 'support': 177602}, 'weighted avg': {'precision': 0.3832983718207871, 'recall': 0.3909584351527573, 'f1-score': 0.3339885648680868, 'support': 177602}}
[[29498  2506 27615]
 [23510  2620 33018]
 [19392  2126 37317]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0898826
{'0': {'precision': 0.39090862343806243, 'recall': 0.5122986724172788, 'f1-score': 0.4434463046141282, 'support': 59356}, '1': {'precision': 0.3248554913294798, 'recall': 0.009368852732304204, 'f1-score': 0.018212457061377925, 'support': 59986}, '2': {'precision': 0.3711920394763672, 'recall': 0.6249227600411946, 'f1-score': 0.46574220948677275, 'support': 58260}, 'accuracy': 0.37937635837434264, 'macro avg': {'precision': 0.36231871808130317, 'recall': 0.38219676173025924, 'f1-score': 0.30913365705409296, 'support': 177602}, 'weighted avg': {'precision': 0.3621310682062868, 'recall': 0.37937635837434264, 'f1-score': 0.3071352373884269, 'support': 177602}}
[[30408   587 28361]
 [26109   562 33315]
 [21271   581 36408]]
Evaluating performance on  val set...
238/238 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0767517
{'0': {'precision': 0.4175793184488837, 'recall': 0.44841510195840906, 'f1-score': 0.4324482196315137, 'support': 19812}, '1': {'precision': 0.4367337315309651, 'recall': 0.26377747187544504, 'f1-score': 0.32890414607439855, 'support': 21067}, '2': {'precision': 0.40479380675896975, 'recall': 0.5441264758855313, 'f1-score': 0.4642308348984121, 'support': 19988}, 'accuracy': 0.4159396717433092, 'macro avg': {'precision': 0.4197022855796062, 'recall': 0.4187730165731285, 'f1-score': 0.4085277335347748, 'support': 60867}, 'weighted avg': {'precision': 0.42001034367999757, 'recall': 0.4159396717433092, 'f1-score': 0.40704706492250914, 'support': 60867}}
[[ 8884  3765  7163]
 [ 6681  5557  8829]
 [ 5710  3402 10876]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0829853
{'0': {'precision': 0.40260699543775796, 'recall': 0.4727792234297668, 'f1-score': 0.43488055568592476, 'support': 19599}, '1': {'precision': 0.4110779256041271, 'recall': 0.13885449626266794, 'f1-score': 0.20758920920028792, 'support': 21807}, '2': {'precision': 0.3800761005051499, 'recall': 0.5953959200452187, 'f1-score': 0.46397181011872585, 'support': 19461}, 'accuracy': 0.3923472489197759, 'macro avg': {'precision': 0.3979203405156783, 'recall': 0.40234321324588446, 'f1-score': 0.36881385833497954, 'support': 60867}, 'weighted avg': {'precision': 0.39843809977762235, 'recall': 0.3923472489197759, 'f1-score': 0.3627495571104152, 'support': 60867}}
[[ 9266  2290  8043]
 [ 7923  3028 10856]
 [ 5826  2048 11587]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0858704
{'0': {'precision': 0.39411952445543763, 'recall': 0.497858186766114, 'f1-score': 0.4399563561869558, 'support': 19843}, '1': {'precision': 0.36751054852320675, 'recall': 0.040918913840082685, 'f1-score': 0.07363882313155225, 'support': 21286}, '2': {'precision': 0.37632736083276, 'recall': 0.6373999392035667, 'f1-score': 0.47324568827700353, 'support': 19738}, 'accuracy': 0.383311153827197, 'macro avg': {'precision': 0.3793191446038015, 'recall': 0.39205901326992115, 'f1-score': 0.32894695586517053, 'support': 60867}, 'weighted avg': {'precision': 0.3790443542108408, 'recall': 0.383311153827197, 'f1-score': 0.3226453309709281, 'support': 60867}}
[[ 9879   797  9167]
 [ 8732   871 11683]
 [ 6455   702 12581]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0913924
{'0': {'precision': 0.3774685816876122, 'recall': 0.5108838716209375, 'f1-score': 0.4341578834157883, 'support': 19754}, '1': {'precision': 0.38870431893687707, 'recall': 0.010941737585336201, 'f1-score': 0.021284336911042392, 'support': 21386}, '2': {'precision': 0.36875540576814103, 'recall': 0.6267552085973539, 'f1-score': 0.46432326873967256, 'support': 19727}, 'accuracy': 0.37277999572839143, 'macro avg': {'precision': 0.3783094354642101, 'recall': 0.3828602726012092, 'f1-score': 0.30658849635550106, 'support': 60867}, 'weighted avg': {'precision': 0.37859238695893116, 'recall': 0.37277999572839143, 'f1-score': 0.2988687922947172, 'support': 60867}}
[[10092   184  9478]
 [ 9465   234 11687]
 [ 7179   184 12364]]
training model: results/PCAR/W5/deepLOB_L2/seq2seq
Epoch 1/50
694/694 - 44s - loss: 12.9978 - accuracy10: 0.3982 - accuracy20: 0.3954 - accuracy30: 0.3920 - accuracy50: 0.3899 - val_loss: 13.0929 - val_accuracy10: 0.3904 - val_accuracy20: 0.3945 - val_accuracy30: 0.3872 - val_accuracy50: 0.3871 - 44s/epoch - 63ms/step
Epoch 2/50
694/694 - 38s - loss: 12.7777 - accuracy10: 0.4358 - accuracy20: 0.4254 - accuracy30: 0.4162 - accuracy50: 0.4074 - val_loss: 12.9107 - val_accuracy10: 0.4127 - val_accuracy20: 0.4093 - val_accuracy30: 0.4004 - val_accuracy50: 0.3933 - 38s/epoch - 54ms/step
Epoch 3/50
694/694 - 36s - loss: 12.7191 - accuracy10: 0.4456 - accuracy20: 0.4328 - accuracy30: 0.4228 - accuracy50: 0.4128 - val_loss: 12.8115 - val_accuracy10: 0.4416 - val_accuracy20: 0.4308 - val_accuracy30: 0.4153 - val_accuracy50: 0.3955 - 36s/epoch - 52ms/step
Epoch 4/50
694/694 - 37s - loss: 12.6657 - accuracy10: 0.4529 - accuracy20: 0.4377 - accuracy30: 0.4281 - accuracy50: 0.4157 - val_loss: 13.0961 - val_accuracy10: 0.4097 - val_accuracy20: 0.4070 - val_accuracy30: 0.3936 - val_accuracy50: 0.3770 - 37s/epoch - 53ms/step
Epoch 5/50
694/694 - 37s - loss: 12.6272 - accuracy10: 0.4584 - accuracy20: 0.4420 - accuracy30: 0.4315 - accuracy50: 0.4191 - val_loss: 12.8467 - val_accuracy10: 0.4433 - val_accuracy20: 0.4342 - val_accuracy30: 0.4169 - val_accuracy50: 0.3952 - 37s/epoch - 53ms/step
Epoch 6/50
694/694 - 36s - loss: 12.5887 - accuracy10: 0.4634 - accuracy20: 0.4452 - accuracy30: 0.4333 - accuracy50: 0.4206 - val_loss: 12.8163 - val_accuracy10: 0.4444 - val_accuracy20: 0.4344 - val_accuracy30: 0.4177 - val_accuracy50: 0.3980 - 36s/epoch - 52ms/step
Epoch 7/50
694/694 - 36s - loss: 12.5504 - accuracy10: 0.4680 - accuracy20: 0.4494 - accuracy30: 0.4368 - accuracy50: 0.4256 - val_loss: 12.8392 - val_accuracy10: 0.4422 - val_accuracy20: 0.4321 - val_accuracy30: 0.4145 - val_accuracy50: 0.3938 - 36s/epoch - 52ms/step
Epoch 8/50
694/694 - 36s - loss: 12.5201 - accuracy10: 0.4714 - accuracy20: 0.4527 - accuracy30: 0.4396 - accuracy50: 0.4271 - val_loss: 12.8007 - val_accuracy10: 0.4454 - val_accuracy20: 0.4337 - val_accuracy30: 0.4170 - val_accuracy50: 0.3948 - 36s/epoch - 52ms/step
Epoch 9/50
694/694 - 36s - loss: 12.4965 - accuracy10: 0.4747 - accuracy20: 0.4562 - accuracy30: 0.4427 - accuracy50: 0.4294 - val_loss: 12.8055 - val_accuracy10: 0.4473 - val_accuracy20: 0.4329 - val_accuracy30: 0.4162 - val_accuracy50: 0.4022 - 36s/epoch - 52ms/step
Epoch 10/50
694/694 - 36s - loss: 12.4664 - accuracy10: 0.4772 - accuracy20: 0.4580 - accuracy30: 0.4455 - accuracy50: 0.4304 - val_loss: 12.7472 - val_accuracy10: 0.4542 - val_accuracy20: 0.4370 - val_accuracy30: 0.4212 - val_accuracy50: 0.4032 - 36s/epoch - 52ms/step
Epoch 11/50
694/694 - 36s - loss: 12.4395 - accuracy10: 0.4807 - accuracy20: 0.4614 - accuracy30: 0.4477 - accuracy50: 0.4339 - val_loss: 12.7346 - val_accuracy10: 0.4529 - val_accuracy20: 0.4383 - val_accuracy30: 0.4232 - val_accuracy50: 0.4101 - 36s/epoch - 52ms/step
Epoch 12/50
694/694 - 38s - loss: 12.4140 - accuracy10: 0.4832 - accuracy20: 0.4637 - accuracy30: 0.4514 - accuracy50: 0.4371 - val_loss: 12.7030 - val_accuracy10: 0.4561 - val_accuracy20: 0.4391 - val_accuracy30: 0.4241 - val_accuracy50: 0.4060 - 38s/epoch - 54ms/step
Epoch 13/50
694/694 - 37s - loss: 12.3952 - accuracy10: 0.4849 - accuracy20: 0.4650 - accuracy30: 0.4525 - accuracy50: 0.4371 - val_loss: 12.7582 - val_accuracy10: 0.4556 - val_accuracy20: 0.4360 - val_accuracy30: 0.4202 - val_accuracy50: 0.4039 - 37s/epoch - 54ms/step
Epoch 14/50
694/694 - 37s - loss: 12.3741 - accuracy10: 0.4872 - accuracy20: 0.4666 - accuracy30: 0.4547 - accuracy50: 0.4407 - val_loss: 12.7386 - val_accuracy10: 0.4601 - val_accuracy20: 0.4422 - val_accuracy30: 0.4246 - val_accuracy50: 0.4037 - 37s/epoch - 53ms/step
Epoch 15/50
694/694 - 37s - loss: 12.3561 - accuracy10: 0.4885 - accuracy20: 0.4688 - accuracy30: 0.4567 - accuracy50: 0.4426 - val_loss: 12.7482 - val_accuracy10: 0.4562 - val_accuracy20: 0.4374 - val_accuracy30: 0.4196 - val_accuracy50: 0.3995 - 37s/epoch - 53ms/step
Epoch 16/50
694/694 - 36s - loss: 12.3357 - accuracy10: 0.4897 - accuracy20: 0.4703 - accuracy30: 0.4577 - accuracy50: 0.4438 - val_loss: 12.7240 - val_accuracy10: 0.4605 - val_accuracy20: 0.4413 - val_accuracy30: 0.4245 - val_accuracy50: 0.4038 - 36s/epoch - 52ms/step
Epoch 17/50
694/694 - 37s - loss: 12.3107 - accuracy10: 0.4927 - accuracy20: 0.4724 - accuracy30: 0.4595 - accuracy50: 0.4456 - val_loss: 12.7481 - val_accuracy10: 0.4597 - val_accuracy20: 0.4401 - val_accuracy30: 0.4222 - val_accuracy50: 0.4029 - 37s/epoch - 53ms/step
Epoch 18/50
694/694 - 37s - loss: 12.2934 - accuracy10: 0.4947 - accuracy20: 0.4745 - accuracy30: 0.4632 - accuracy50: 0.4485 - val_loss: 12.7600 - val_accuracy10: 0.4580 - val_accuracy20: 0.4397 - val_accuracy30: 0.4206 - val_accuracy50: 0.4004 - 37s/epoch - 53ms/step
Epoch 19/50
694/694 - 37s - loss: 12.2612 - accuracy10: 0.4963 - accuracy20: 0.4765 - accuracy30: 0.4660 - accuracy50: 0.4499 - val_loss: 12.7466 - val_accuracy10: 0.4608 - val_accuracy20: 0.4407 - val_accuracy30: 0.4257 - val_accuracy50: 0.4057 - 37s/epoch - 53ms/step
Epoch 20/50
694/694 - 37s - loss: 12.2441 - accuracy10: 0.4976 - accuracy20: 0.4788 - accuracy30: 0.4668 - accuracy50: 0.4510 - val_loss: 12.7862 - val_accuracy10: 0.4563 - val_accuracy20: 0.4380 - val_accuracy30: 0.4222 - val_accuracy50: 0.4040 - 37s/epoch - 53ms/step
Epoch 21/50
694/694 - 36s - loss: 12.2193 - accuracy10: 0.4994 - accuracy20: 0.4810 - accuracy30: 0.4694 - accuracy50: 0.4542 - val_loss: 12.8128 - val_accuracy10: 0.4546 - val_accuracy20: 0.4369 - val_accuracy30: 0.4218 - val_accuracy50: 0.4014 - 36s/epoch - 52ms/step
Epoch 22/50
694/694 - 37s - loss: 12.1972 - accuracy10: 0.5011 - accuracy20: 0.4840 - accuracy30: 0.4726 - accuracy50: 0.4565 - val_loss: 12.8062 - val_accuracy10: 0.4542 - val_accuracy20: 0.4366 - val_accuracy30: 0.4219 - val_accuracy50: 0.4048 - 37s/epoch - 53ms/step
testing model: results/PCAR/W5/deepLOB_L2/seq2seq
Evaluating performance on  test set...
2900/2900 - 62s - 62s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.06926
{'0': {'precision': 0.4664820530165307, 'recall': 0.42177591064254344, 'f1-score': 0.4430039487604666, 'support': 261601}, '1': {'precision': 0.3913351475704186, 'recall': 0.2576588807920719, 'f1-score': 0.31073005830887557, 'support': 216546}, '2': {'precision': 0.44112902337771026, 'recall': 0.606488753307016, 'f1-score': 0.5107584032843371, 'support': 264211}, 'accuracy': 0.43964367596227155, 'macro avg': {'precision': 0.43298207465488653, 'recall': 0.42864118158054376, 'f1-score': 0.42149747011789307, 'support': 742358}, 'weighted avg': {'precision': 0.43553834243398665, 'recall': 0.43964367596227155, 'f1-score': 0.4285339629887448, 'support': 742358}}
[[110337  43164 108100]
 [ 65840  55795  94911]
 [ 60353  43617 160241]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0854868
{'0': {'precision': 0.45061566795725, 'recall': 0.3748132867266441, 'f1-score': 0.40923386222199976, 'support': 261765}, '1': {'precision': 0.34758863278718877, 'recall': 0.2607300905438184, 'f1-score': 0.29795833079854944, 'support': 216028}, '2': {'precision': 0.42533551031215006, 'recall': 0.582915351614915, 'f1-score': 0.4918113297201453, 'support': 264565}, 'accuracy': 0.41577917931779546, 'macro avg': {'precision': 0.40784660368552966, 'recall': 0.4061529096284591, 'f1-score': 0.39966784091356483, 'support': 742358}, 'weighted avg': {'precision': 0.41162508758889155, 'recall': 0.41577917931779546, 'f1-score': 0.40628175176626513, 'support': 742358}}
[[ 98113  52460 111192]
 [ 62532  56325  97171]
 [ 57086  53260 154219]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0937636
{'0': {'precision': 0.43882291418098, 'recall': 0.32966408446137946, 'f1-score': 0.37649083068345174, 'support': 262179}, '1': {'precision': 0.32357559560329857, 'recall': 0.28796446254222385, 'f1-score': 0.3047331772909342, 'support': 216110}, '2': {'precision': 0.413990387202574, 'recall': 0.553521996144947, 'f1-score': 0.4736947856240075, 'support': 264069}, 'accuracy': 0.39715474205167856, 'macro avg': {'precision': 0.3921296323289509, 'recall': 0.3903835143828502, 'f1-score': 0.38497293119946446, 'support': 742358}, 'weighted avg': {'precision': 0.3964395916001182, 'recall': 0.39715474205167856, 'f1-score': 0.39017830317319474, 'support': 742358}}
[[ 86431  65116 110632]
 [ 57607  62232  96271]
 [ 52923  64978 146168]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1070561
{'0': {'precision': 0.4546108432209729, 'recall': 0.27712106968978434, 'f1-score': 0.34433988990537784, 'support': 285092}, '1': {'precision': 0.24677139822217253, 'recall': 0.3345518572286452, 'f1-score': 0.284034154188838, 'support': 171519}, '2': {'precision': 0.4297689865224779, 'recall': 0.5054121303110793, 'f1-score': 0.46453131935643655, 'support': 285747}, 'accuracy': 0.37826358711026214, 'macro avg': {'precision': 0.37705040932187445, 'recall': 0.3723616857431697, 'f1-score': 0.3643017878168841, 'support': 742358}, 'weighted avg': {'precision': 0.39702824857960844, 'recall': 0.37826358711026214, 'f1-score': 0.37667033007977685, 'support': 742358}}
[[ 79005  87811 118276]
 [ 40792  57382  73345]
 [ 53989  87338 144420]]
Evaluating performance on  train set...
694/694 - 14s - 14s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0383278
{'0': {'precision': 0.47708161740762733, 'recall': 0.4137856561394182, 'f1-score': 0.4431850533807829, 'support': 60193}, '1': {'precision': 0.4552520110364124, 'recall': 0.40635460205692087, 'f1-score': 0.4294158075601374, 'support': 57659}, '2': {'precision': 0.45750652653221335, 'recall': 0.5660753138075314, 'f1-score': 0.5060331091644911, 'support': 59750}, 'accuracy': 0.46260740306978526, 'macro avg': {'precision': 0.463280051658751, 'recall': 0.46207185733462347, 'f1-score': 0.4595446567018038, 'support': 177602}, 'weighted avg': {'precision': 0.4634089957391559, 'recall': 0.46260740306978526, 'f1-score': 0.4598585727572762, 'support': 177602}}
[[24907 14361 20925]
 [15048 23430 19181]
 [12252 13675 33823]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0553001
{'0': {'precision': 0.4515052888527258, 'recall': 0.3780037125972854, 'f1-score': 0.41149806727908117, 'support': 58719}, '1': {'precision': 0.44297012136426267, 'recall': 0.3881868404512223, 'f1-score': 0.4137730410176394, 'support': 60458}, '2': {'precision': 0.4294668769298048, 'recall': 0.55469405220368, 'f1-score': 0.484113350163572, 'support': 58425}, 'accuracy': 0.43959527482798616, 'macro avg': {'precision': 0.4413140957155977, 'recall': 0.4402948684173959, 'f1-score': 0.43646148615343083, 'support': 177602}, 'weighted avg': {'precision': 0.4413499225133031, 'recall': 0.43959527482798616, 'f1-score': 0.43616044869827764, 'support': 177602}}
[[22196 15035 21488]
 [15424 23469 21565]
 [11540 14477 32408]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0635022
{'0': {'precision': 0.44792050853708804, 'recall': 0.34602621258338084, 'f1-score': 0.39043485660794824, 'support': 59666}, '1': {'precision': 0.4138583735781634, 'recall': 0.3965926428208171, 'f1-score': 0.4050415948891525, 'support': 58990}, '2': {'precision': 0.42023206188316886, 'recall': 0.5345400875377464, 'f1-score': 0.47054343443394114, 'support': 58946}, 'accuracy': 0.4253893537234941, 'macro avg': {'precision': 0.4273369813328068, 'recall': 0.4257196476473148, 'f1-score': 0.4220066286436806, 'support': 177602}, 'weighted avg': {'precision': 0.4274170878679014, 'recall': 0.4253893537234941, 'f1-score': 0.4218744334130473, 'support': 177602}}
[[20646 16857 22163]
 [14287 23395 21308]
 [11160 16277 31509]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.077065
{'0': {'precision': 0.42244720584435413, 'recall': 0.3027354599781163, 'f1-score': 0.35271044167255033, 'support': 59405}, '1': {'precision': 0.3978478917129224, 'recall': 0.4089316695582544, 'f1-score': 0.4033136445153754, 'support': 59944}, '2': {'precision': 0.39730580110873503, 'recall': 0.5007295761591678, 'f1-score': 0.4430622009569378, 'support': 58253}, 'accuracy': 0.4035202306280335, 'macro avg': {'precision': 0.4058669662220038, 'recall': 0.40413223523184616, 'f1-score': 0.39969542904828786, 'support': 177602}, 'weighted avg': {'precision': 0.4058981605838358, 'recall': 0.4035202306280335, 'f1-score': 0.3994251150703934, 'support': 177602}}
[[17984 18872 22549]
 [13732 24513 21699]
 [10855 18229 29169]]
Evaluating performance on  val set...
238/238 - 5s - 5s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0417161
{'0': {'precision': 0.4723758747084305, 'recall': 0.3568982880161128, 'f1-score': 0.40659687365552843, 'support': 19860}, '1': {'precision': 0.45450042775451394, 'recall': 0.4798212672909635, 'f1-score': 0.46681774036905144, 'support': 21037}, '2': {'precision': 0.44708916416522215, 'recall': 0.5295443164747121, 'f1-score': 0.4848359810191871, 'support': 19970}, 'accuracy': 0.45602707542675014, 'macro avg': {'precision': 0.45798848887605553, 'recall': 0.4554212905939295, 'f1-score': 0.45275019834792235, 'support': 60867}, 'weighted avg': {'precision': 0.4579013419219055, 'recall': 0.45602707542675014, 'f1-score': 0.45308021187007236, 'support': 60867}}
[[ 7088  6300  6472]
 [ 4337 10094  6606]
 [ 3580  5815 10575]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0524477
{'0': {'precision': 0.45311484876921965, 'recall': 0.3197656647987774, 'f1-score': 0.3749365349580384, 'support': 19630}, '1': {'precision': 0.44908933217692976, 'recall': 0.4750676636542961, 'f1-score': 0.46171336855480505, 'support': 21799}, '2': {'precision': 0.4211405193287134, 'recall': 0.5189834345097232, 'f1-score': 0.4649705014749263, 'support': 19438}, 'accuracy': 0.4390063581250924, 'macro avg': {'precision': 0.44111490009162097, 'recall': 0.43793892098759885, 'f1-score': 0.4338734683292566, 'support': 60867}, 'weighted avg': {'precision': 0.4414620771218592, 'recall': 0.4390063581250924, 'f1-score': 0.4347674521501324, 'support': 60867}}
[[ 6277  6641  6712]
 [ 4289 10356  7154]
 [ 3287  6063 10088]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0631211
{'0': {'precision': 0.4450298836111985, 'recall': 0.28477254428341386, 'f1-score': 0.3473057567202652, 'support': 19872}, '1': {'precision': 0.42508269694123413, 'recall': 0.489006858968336, 'f1-score': 0.4548096039149717, 'support': 21286}, '2': {'precision': 0.4114266396213658, 'recall': 0.4939875183926125, 'f1-score': 0.4489428907384779, 'support': 19709}, 'accuracy': 0.4239407232161927, 'macro avg': {'precision': 0.42717974005793274, 'recall': 0.4225889738814541, 'f1-score': 0.4170194171245716, 'support': 60867}, 'weighted avg': {'precision': 0.4271732100236638, 'recall': 0.4239407232161927, 'f1-score': 0.4178118300564158, 'support': 60867}}
[[ 5659  7279  6934]
 [ 3883 10409  6994]
 [ 3174  6799  9736]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.076264
{'0': {'precision': 0.4145420207743154, 'recall': 0.2442466238430024, 'f1-score': 0.30738383195416935, 'support': 19771}, '1': {'precision': 0.41023882984801735, 'recall': 0.5027776481023295, 'f1-score': 0.45181860133406043, 'support': 21421}, '2': {'precision': 0.3935554104071413, 'recall': 0.4593646759847522, 'f1-score': 0.4239212007504691, 'support': 19675}, 'accuracy': 0.4047677723561207, 'macro avg': {'precision': 0.4061120870098247, 'recall': 0.4021296493100281, 'f1-score': 0.3943745446795663, 'support': 60867}, 'weighted avg': {'precision': 0.4062437604393822, 'recall': 0.4047677723561207, 'f1-score': 0.3958851532933818, 'support': 60867}}
[[ 4829  7905  7037]
 [ 3761 10770  6890]
 [ 3059  7578  9038]]
training model: results/PCAR/W5/deepOF_L2/seq2seq
Epoch 1/50
694/694 - 31s - loss: 12.9158 - accuracy10: 0.4275 - accuracy20: 0.4102 - accuracy30: 0.3989 - accuracy50: 0.3881 - val_loss: 12.8142 - val_accuracy10: 0.4481 - val_accuracy20: 0.4172 - val_accuracy30: 0.4038 - val_accuracy50: 0.3844 - 31s/epoch - 45ms/step
Epoch 2/50
694/694 - 25s - loss: 12.6961 - accuracy10: 0.4606 - accuracy20: 0.4364 - accuracy30: 0.4219 - accuracy50: 0.4081 - val_loss: 12.7247 - val_accuracy10: 0.4662 - val_accuracy20: 0.4330 - val_accuracy30: 0.4179 - val_accuracy50: 0.3938 - 25s/epoch - 36ms/step
Epoch 3/50
694/694 - 24s - loss: 12.6126 - accuracy10: 0.4718 - accuracy20: 0.4472 - accuracy30: 0.4318 - accuracy50: 0.4155 - val_loss: 12.6335 - val_accuracy10: 0.4774 - val_accuracy20: 0.4483 - val_accuracy30: 0.4287 - val_accuracy50: 0.4027 - 24s/epoch - 34ms/step
Epoch 4/50
694/694 - 25s - loss: 12.5505 - accuracy10: 0.4797 - accuracy20: 0.4540 - accuracy30: 0.4381 - accuracy50: 0.4209 - val_loss: 12.5816 - val_accuracy10: 0.4800 - val_accuracy20: 0.4523 - val_accuracy30: 0.4345 - val_accuracy50: 0.4090 - 25s/epoch - 36ms/step
Epoch 5/50
694/694 - 25s - loss: 12.5007 - accuracy10: 0.4851 - accuracy20: 0.4589 - accuracy30: 0.4427 - accuracy50: 0.4243 - val_loss: 12.5392 - val_accuracy10: 0.4872 - val_accuracy20: 0.4574 - val_accuracy30: 0.4370 - val_accuracy50: 0.4101 - 25s/epoch - 35ms/step
Epoch 6/50
694/694 - 24s - loss: 12.4567 - accuracy10: 0.4889 - accuracy20: 0.4634 - accuracy30: 0.4465 - accuracy50: 0.4277 - val_loss: 12.5117 - val_accuracy10: 0.4882 - val_accuracy20: 0.4594 - val_accuracy30: 0.4415 - val_accuracy50: 0.4156 - 24s/epoch - 35ms/step
Epoch 7/50
694/694 - 25s - loss: 12.4213 - accuracy10: 0.4934 - accuracy20: 0.4667 - accuracy30: 0.4499 - accuracy50: 0.4298 - val_loss: 12.5074 - val_accuracy10: 0.4875 - val_accuracy20: 0.4591 - val_accuracy30: 0.4398 - val_accuracy50: 0.4140 - 25s/epoch - 36ms/step
Epoch 8/50
694/694 - 25s - loss: 12.3860 - accuracy10: 0.4962 - accuracy20: 0.4707 - accuracy30: 0.4532 - accuracy50: 0.4330 - val_loss: 12.5071 - val_accuracy10: 0.4878 - val_accuracy20: 0.4585 - val_accuracy30: 0.4391 - val_accuracy50: 0.4132 - 25s/epoch - 36ms/step
Epoch 9/50
694/694 - 25s - loss: 12.3574 - accuracy10: 0.4991 - accuracy20: 0.4732 - accuracy30: 0.4563 - accuracy50: 0.4354 - val_loss: 12.4793 - val_accuracy10: 0.4889 - val_accuracy20: 0.4582 - val_accuracy30: 0.4412 - val_accuracy50: 0.4166 - 25s/epoch - 36ms/step
Epoch 10/50
694/694 - 24s - loss: 12.3282 - accuracy10: 0.5018 - accuracy20: 0.4757 - accuracy30: 0.4587 - accuracy50: 0.4370 - val_loss: 12.4939 - val_accuracy10: 0.4832 - val_accuracy20: 0.4554 - val_accuracy30: 0.4395 - val_accuracy50: 0.4156 - 24s/epoch - 35ms/step
Epoch 11/50
694/694 - 25s - loss: 12.3031 - accuracy10: 0.5042 - accuracy20: 0.4785 - accuracy30: 0.4612 - accuracy50: 0.4398 - val_loss: 12.5142 - val_accuracy10: 0.4795 - val_accuracy20: 0.4542 - val_accuracy30: 0.4372 - val_accuracy50: 0.4163 - 25s/epoch - 35ms/step
Epoch 12/50
694/694 - 25s - loss: 12.2774 - accuracy10: 0.5059 - accuracy20: 0.4799 - accuracy30: 0.4638 - accuracy50: 0.4425 - val_loss: 12.4723 - val_accuracy10: 0.4865 - val_accuracy20: 0.4592 - val_accuracy30: 0.4395 - val_accuracy50: 0.4158 - 25s/epoch - 37ms/step
Epoch 13/50
694/694 - 24s - loss: 12.2538 - accuracy10: 0.5071 - accuracy20: 0.4825 - accuracy30: 0.4655 - accuracy50: 0.4457 - val_loss: 12.5010 - val_accuracy10: 0.4827 - val_accuracy20: 0.4547 - val_accuracy30: 0.4365 - val_accuracy50: 0.4154 - 24s/epoch - 35ms/step
Epoch 14/50
694/694 - 25s - loss: 12.2280 - accuracy10: 0.5099 - accuracy20: 0.4847 - accuracy30: 0.4683 - accuracy50: 0.4470 - val_loss: 12.4942 - val_accuracy10: 0.4832 - val_accuracy20: 0.4560 - val_accuracy30: 0.4383 - val_accuracy50: 0.4129 - 25s/epoch - 35ms/step
Epoch 15/50
694/694 - 25s - loss: 12.2014 - accuracy10: 0.5103 - accuracy20: 0.4852 - accuracy30: 0.4701 - accuracy50: 0.4500 - val_loss: 12.5125 - val_accuracy10: 0.4826 - val_accuracy20: 0.4534 - val_accuracy30: 0.4345 - val_accuracy50: 0.4105 - 25s/epoch - 36ms/step
Epoch 16/50
694/694 - 25s - loss: 12.1752 - accuracy10: 0.5116 - accuracy20: 0.4897 - accuracy30: 0.4740 - accuracy50: 0.4530 - val_loss: 12.5117 - val_accuracy10: 0.4828 - val_accuracy20: 0.4556 - val_accuracy30: 0.4362 - val_accuracy50: 0.4131 - 25s/epoch - 36ms/step
Epoch 17/50
694/694 - 25s - loss: 12.1578 - accuracy10: 0.5138 - accuracy20: 0.4903 - accuracy30: 0.4746 - accuracy50: 0.4557 - val_loss: 12.5244 - val_accuracy10: 0.4811 - val_accuracy20: 0.4532 - val_accuracy30: 0.4369 - val_accuracy50: 0.4136 - 25s/epoch - 36ms/step
Epoch 18/50
694/694 - 24s - loss: 12.1319 - accuracy10: 0.5136 - accuracy20: 0.4925 - accuracy30: 0.4765 - accuracy50: 0.4569 - val_loss: 12.5470 - val_accuracy10: 0.4809 - val_accuracy20: 0.4529 - val_accuracy30: 0.4326 - val_accuracy50: 0.4102 - 24s/epoch - 35ms/step
Epoch 19/50
694/694 - 25s - loss: 12.1014 - accuracy10: 0.5156 - accuracy20: 0.4944 - accuracy30: 0.4804 - accuracy50: 0.4605 - val_loss: 12.5761 - val_accuracy10: 0.4799 - val_accuracy20: 0.4496 - val_accuracy30: 0.4298 - val_accuracy50: 0.4054 - 25s/epoch - 36ms/step
Epoch 20/50
694/694 - 25s - loss: 12.0812 - accuracy10: 0.5175 - accuracy20: 0.4951 - accuracy30: 0.4821 - accuracy50: 0.4623 - val_loss: 12.6299 - val_accuracy10: 0.4770 - val_accuracy20: 0.4444 - val_accuracy30: 0.4267 - val_accuracy50: 0.4037 - 25s/epoch - 36ms/step
Epoch 21/50
694/694 - 25s - loss: 12.0489 - accuracy10: 0.5190 - accuracy20: 0.4977 - accuracy30: 0.4843 - accuracy50: 0.4651 - val_loss: 12.5629 - val_accuracy10: 0.4825 - val_accuracy20: 0.4518 - val_accuracy30: 0.4321 - val_accuracy50: 0.4086 - 25s/epoch - 36ms/step
Epoch 22/50
694/694 - 25s - loss: 12.0321 - accuracy10: 0.5207 - accuracy20: 0.4999 - accuracy30: 0.4873 - accuracy50: 0.4670 - val_loss: 12.5715 - val_accuracy10: 0.4840 - val_accuracy20: 0.4530 - val_accuracy30: 0.4312 - val_accuracy50: 0.4083 - 25s/epoch - 36ms/step
testing model: results/PCAR/W5/deepOF_L2/seq2seq
Evaluating performance on  test set...
2900/2900 - 46s - 46s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.058948
{'0': {'precision': 0.4563401099386214, 'recall': 0.5334536182965661, 'f1-score': 0.4918929588585286, 'support': 261601}, '1': {'precision': 0.4619259919750334, 'recall': 0.14354192931657916, 'f1-score': 0.21902315798374397, 'support': 216543}, '2': {'precision': 0.43248315531771997, 'recall': 0.6044343682463504, 'f1-score': 0.5042014949523652, 'support': 264209}, 'accuracy': 0.44497967947863076, 'macro avg': {'precision': 0.4502497524104583, 'recall': 0.4271433052864986, 'f1-score': 0.40503920393154597, 'support': 742353}, 'weighted avg': {'precision': 0.4494786323536679, 'recall': 0.44497967947863076, 'f1-score': 0.41667804186080376, 'support': 742353}}
[[139552  17755 104294]
 [ 80195  31083 105265]
 [ 86060  18452 159697]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0726897
{'0': {'precision': 0.44052495926144736, 'recall': 0.5184382938895574, 'f1-score': 0.47631649605933024, 'support': 261765}, '1': {'precision': 0.40795804826704757, 'recall': 0.10047448212012498, 'f1-score': 0.16123820242247308, 'support': 216025}, '2': {'precision': 0.42117941572396855, 'recall': 0.6066834742575492, 'f1-score': 0.49719197707736396, 'support': 264563}, 'accuracy': 0.4282598709778232, 'macro avg': {'precision': 0.4232208077508212, 'recall': 0.4085320834224106, 'f1-score': 0.37824889185305577, 'support': 742353}, 'weighted avg': {'precision': 0.42415352682637775, 'recall': 0.4282598709778232, 'f1-score': 0.3920682900194435, 'support': 742353}}
[[135709  15433 110623]
 [ 84362  21705 109958]
 [ 87991  16066 160506]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0782562
{'0': {'precision': 0.42976312474298806, 'recall': 0.5022599063998261, 'f1-score': 0.4631919589859036, 'support': 262179}, '1': {'precision': 0.3583670215794568, 'recall': 0.08737338448083588, 'f1-score': 0.14049316210062648, 'support': 216107}, '2': {'precision': 0.41307161233425005, 'recall': 0.599518304066771, 'f1-score': 0.4891298806627274, 'support': 264067}, 'accuracy': 0.4160783347006074, 'macro avg': {'precision': 0.40040058621889835, 'recall': 0.39638386498247763, 'f1-score': 0.3642716672497525, 'support': 742353}, 'weighted avg': {'precision': 0.40304150406711087, 'recall': 0.4160783347006074, 'f1-score': 0.3784773828542617, 'support': 742353}}
[[131682  16404 114093]
 [ 86373  18882 110852]
 [ 88351  17403 158313]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0748512
{'0': {'precision': 0.44630713696648505, 'recall': 0.4631767990683709, 'f1-score': 0.45458551363260813, 'support': 285092}, '1': {'precision': 0.2617918134995934, 'recall': 0.11261340049907881, 'f1-score': 0.15748320396582088, 'support': 171516}, '2': {'precision': 0.4326370722152909, 'recall': 0.5643003377136958, 'f1-score': 0.48977447034702715, 'support': 285745}, 'accuracy': 0.4211055926223778, 'macro avg': {'precision': 0.38024534089378975, 'recall': 0.3800301790937152, 'f1-score': 0.3672810626484854, 'support': 742353}, 'weighted avg': {'precision': 0.39841417651225725, 'recall': 0.4211055926223778, 'f1-score': 0.39948675157675734, 'support': 742353}}
[[132048  26636 126408]
 [ 67150  19315  85051]
 [ 96670  27829 161246]]
Evaluating performance on  train set...
694/694 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0023445
{'0': {'precision': 0.48643424829436455, 'recall': 0.560525222305327, 'f1-score': 0.5208581092560273, 'support': 60165}, '1': {'precision': 0.5367916700125807, 'recall': 0.3478758651794543, 'f1-score': 0.42216281076984613, 'support': 57647}, '2': {'precision': 0.4831486025326452, 'recall': 0.5730389697273791, 'f1-score': 0.5242685763251317, 'support': 59790}, 'accuracy': 0.49571513834303665, 'macro avg': {'precision': 0.5021248402798635, 'recall': 0.4938133524040535, 'f1-score': 0.4890964987836684, 'support': 177602}, 'weighted avg': {'precision': 0.5016734096196696, 'recall': 0.49571513834303665, 'f1-score': 0.4899712045715579, 'support': 177602}}
[[33724  8731 17710]
 [18651 20054 18942]
 [16954  8574 34262]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0289855
{'0': {'precision': 0.45884475008102815, 'recall': 0.555013891966523, 'f1-score': 0.5023682789477745, 'support': 58667}, '1': {'precision': 0.5237992809513566, 'recall': 0.2815194054500413, 'f1-score': 0.36621443073055976, 'support': 60550}, '2': {'precision': 0.4544644785143597, 'recall': 0.5767577288687162, 'f1-score': 0.5083596893139394, 'support': 58385}, 'accuracy': 0.46891926892715174, 'macro avg': {'precision': 0.4790361698489148, 'recall': 0.47109700876176014, 'f1-score': 0.45898079966409117, 'support': 177602}, 'weighted avg': {'precision': 0.4795497798035451, 'recall': 0.46891926892715174, 'f1-score': 0.4579188526162928, 'support': 177602}}
[[32561  7724 18382]
 [21464 17046 22040]
 [16938  7773 33674]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.042354
{'0': {'precision': 0.45360650424833376, 'recall': 0.5399620926214798, 'f1-score': 0.49303151897570985, 'support': 59619}, '1': {'precision': 0.4790828383470652, 'recall': 0.2536349496179076, 'f1-score': 0.33167517852800066, 'support': 59148}, '2': {'precision': 0.44298251437220354, 'recall': 0.5670944165887651, 'f1-score': 0.49741342039745357, 'support': 58835}, 'accuracy': 0.45359286494521456, 'macro avg': {'precision': 0.4585572856558675, 'recall': 0.45356381960938413, 'f1-score': 0.4407067059670547, 'support': 177602}, 'weighted avg': {'precision': 0.45857160466899144, 'recall': 0.45359286494521456, 'f1-score': 0.4407455331498024, 'support': 177602}}
[[32192  8020 19407]
 [21599 15002 22547]
 [17178  8292 33365]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0609545
{'0': {'precision': 0.435400422648109, 'recall': 0.5033189568030191, 'f1-score': 0.46690265763337, 'support': 59356}, '1': {'precision': 0.43022697080188815, 'recall': 0.2537425399259827, 'f1-score': 0.3192156451528338, 'support': 59986}, '2': {'precision': 0.4199951092272579, 'recall': 0.530638516992791, 'f1-score': 0.4688779688779689, 'support': 58260}, 'accuracy': 0.4279850452134548, 'macro avg': {'precision': 0.4285408342257517, 'recall': 0.4292333379072642, 'f1-score': 0.41833209055472426, 'support': 177602}, 'weighted avg': {'precision': 0.42859955192398325, 'recall': 0.4279850452134548, 'f1-score': 0.4176685752607215, 'support': 177602}}
[[29875  9892 19589]
 [21661 15221 23104]
 [17079 10266 30915]]
Evaluating performance on  val set...
238/238 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0081817
{'0': {'precision': 0.4622456797480208, 'recall': 0.548152634766808, 'f1-score': 0.5015471297279822, 'support': 19812}, '1': {'precision': 0.5493102738315833, 'recall': 0.37993069729909335, 'f1-score': 0.4491834558617206, 'support': 21067}, '2': {'precision': 0.47105517059907026, 'recall': 0.5373724234540724, 'f1-score': 0.5020331853236737, 'support': 19988}, 'accuracy': 0.48638835493781524, 'macro avg': {'precision': 0.4942037080595581, 'recall': 0.4884852518399912, 'f1-score': 0.48425459030445883, 'support': 60867}, 'weighted avg': {'precision': 0.49527300008069997, 'recall': 0.48638835493781524, 'f1-score': 0.4835828758943145, 'support': 60867}}
[[10860  3195  5757]
 [ 6759  8004  6304]
 [ 5875  3372 10741]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0345092
{'0': {'precision': 0.4412133366758586, 'recall': 0.538803000153069, 'f1-score': 0.48514919716077454, 'support': 19599}, '1': {'precision': 0.5271022337424716, 'recall': 0.3170541569220892, 'f1-score': 0.3959454816172259, 'support': 21807}, '2': {'precision': 0.4365552569701041, 'recall': 0.5342479831457787, 'f1-score': 0.48048617048316655, 'support': 19461}, 'accuracy': 0.45790001150048465, 'macro avg': {'precision': 0.46829027579614474, 'recall': 0.46336838007364567, 'f1-score': 0.4538602830870557, 'support': 60867}, 'weighted avg': {'precision': 0.4704956783253228, 'recall': 0.45790001150048465, 'f1-score': 0.45169900925877354, 'support': 60867}}
[[10560  3023  6016]
 [ 7490  6914  7403]
 [ 5884  3180 10397]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0484506
{'0': {'precision': 0.43117230988155525, 'recall': 0.5191755278939676, 'f1-score': 0.4710993232119992, 'support': 19843}, '1': {'precision': 0.4803414786967419, 'recall': 0.28812364934698864, 'f1-score': 0.36019263522640516, 'support': 21286}, '2': {'precision': 0.424812030075188, 'recall': 0.5209747694801905, 'f1-score': 0.4680047332969234, 'support': 19738}, 'accuracy': 0.43895707033367837, 'macro avg': {'precision': 0.4454419395511617, 'recall': 0.4427579822403822, 'f1-score': 0.43309889724510925, 'support': 60867}, 'weighted avg': {'precision': 0.44630490594480765, 'recall': 0.43895707033367837, 'f1-score': 0.43131026220677265, 'support': 60867}}
[[10302  3194  6347]
 [ 7577  6133  7576]
 [ 6014  3441 10283]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0664432
{'0': {'precision': 0.41000388752105743, 'recall': 0.4805102763997165, 'f1-score': 0.44246591306374555, 'support': 19754}, '1': {'precision': 0.44621854729488913, 'recall': 0.29271486018890863, 'f1-score': 0.35352251870676266, 'support': 21386}, '2': {'precision': 0.40499007894625744, 'recall': 0.4862878288639935, 'f1-score': 0.4419311742755793, 'support': 19727}, 'accuracy': 0.4163996911298405, 'macro avg': {'precision': 0.42040417125406804, 'recall': 0.4198376551508729, 'f1-score': 0.4126398686820292, 'support': 60867}, 'weighted avg': {'precision': 0.4211031582616572, 'recall': 0.4163996911298405, 'f1-score': 0.41104178794188, 'support': 60867}}
[[9492 3770 6492]
 [7524 6260 7602]
 [6135 3999 9593]]
training model: results/PCAR/W5/deepVOL_L2/seq2seq
Epoch 1/50
694/694 - 30s - loss: 13.0301 - accuracy10: 0.3906 - accuracy20: 0.3933 - accuracy30: 0.3898 - accuracy50: 0.3881 - val_loss: 12.9443 - val_accuracy10: 0.4144 - val_accuracy20: 0.4074 - val_accuracy30: 0.3990 - val_accuracy50: 0.3842 - 30s/epoch - 43ms/step
Epoch 2/50
694/694 - 24s - loss: 12.8546 - accuracy10: 0.4227 - accuracy20: 0.4172 - accuracy30: 0.4095 - accuracy50: 0.4019 - val_loss: 12.8427 - val_accuracy10: 0.4333 - val_accuracy20: 0.4207 - val_accuracy30: 0.4096 - val_accuracy50: 0.3953 - 24s/epoch - 35ms/step
Epoch 3/50
694/694 - 24s - loss: 12.7629 - accuracy10: 0.4406 - accuracy20: 0.4290 - accuracy30: 0.4196 - accuracy50: 0.4097 - val_loss: 12.7652 - val_accuracy10: 0.4463 - val_accuracy20: 0.4312 - val_accuracy30: 0.4169 - val_accuracy50: 0.3989 - 24s/epoch - 35ms/step
Epoch 4/50
694/694 - 23s - loss: 12.7227 - accuracy10: 0.4476 - accuracy20: 0.4350 - accuracy30: 0.4242 - accuracy50: 0.4103 - val_loss: 12.7315 - val_accuracy10: 0.4510 - val_accuracy20: 0.4332 - val_accuracy30: 0.4192 - val_accuracy50: 0.3941 - 23s/epoch - 33ms/step
Epoch 5/50
694/694 - 23s - loss: 12.6730 - accuracy10: 0.4564 - accuracy20: 0.4410 - accuracy30: 0.4306 - accuracy50: 0.4143 - val_loss: 12.7056 - val_accuracy10: 0.4586 - val_accuracy20: 0.4361 - val_accuracy30: 0.4190 - val_accuracy50: 0.3906 - 23s/epoch - 34ms/step
Epoch 6/50
694/694 - 23s - loss: 12.6310 - accuracy10: 0.4641 - accuracy20: 0.4464 - accuracy30: 0.4342 - accuracy50: 0.4178 - val_loss: 12.6570 - val_accuracy10: 0.4658 - val_accuracy20: 0.4448 - val_accuracy30: 0.4272 - val_accuracy50: 0.3980 - 23s/epoch - 34ms/step
Epoch 7/50
694/694 - 23s - loss: 12.5899 - accuracy10: 0.4709 - accuracy20: 0.4512 - accuracy30: 0.4371 - accuracy50: 0.4198 - val_loss: 12.6503 - val_accuracy10: 0.4678 - val_accuracy20: 0.4473 - val_accuracy30: 0.4261 - val_accuracy50: 0.3977 - 23s/epoch - 34ms/step
Epoch 8/50
694/694 - 23s - loss: 12.5615 - accuracy10: 0.4739 - accuracy20: 0.4537 - accuracy30: 0.4392 - accuracy50: 0.4219 - val_loss: 12.6256 - val_accuracy10: 0.4698 - val_accuracy20: 0.4480 - val_accuracy30: 0.4279 - val_accuracy50: 0.3980 - 23s/epoch - 33ms/step
Epoch 9/50
694/694 - 23s - loss: 12.5275 - accuracy10: 0.4788 - accuracy20: 0.4585 - accuracy30: 0.4434 - accuracy50: 0.4260 - val_loss: 12.6050 - val_accuracy10: 0.4714 - val_accuracy20: 0.4496 - val_accuracy30: 0.4294 - val_accuracy50: 0.3997 - 23s/epoch - 33ms/step
Epoch 10/50
694/694 - 23s - loss: 12.4958 - accuracy10: 0.4821 - accuracy20: 0.4606 - accuracy30: 0.4462 - accuracy50: 0.4281 - val_loss: 12.5897 - val_accuracy10: 0.4723 - val_accuracy20: 0.4511 - val_accuracy30: 0.4321 - val_accuracy50: 0.4032 - 23s/epoch - 34ms/step
Epoch 11/50
694/694 - 23s - loss: 12.4722 - accuracy10: 0.4847 - accuracy20: 0.4620 - accuracy30: 0.4474 - accuracy50: 0.4309 - val_loss: 12.5975 - val_accuracy10: 0.4726 - val_accuracy20: 0.4517 - val_accuracy30: 0.4306 - val_accuracy50: 0.4010 - 23s/epoch - 33ms/step
Epoch 12/50
694/694 - 24s - loss: 12.4503 - accuracy10: 0.4865 - accuracy20: 0.4641 - accuracy30: 0.4492 - accuracy50: 0.4324 - val_loss: 12.5921 - val_accuracy10: 0.4718 - val_accuracy20: 0.4512 - val_accuracy30: 0.4332 - val_accuracy50: 0.4048 - 24s/epoch - 35ms/step
Epoch 13/50
694/694 - 24s - loss: 12.4260 - accuracy10: 0.4897 - accuracy20: 0.4666 - accuracy30: 0.4519 - accuracy50: 0.4343 - val_loss: 12.6069 - val_accuracy10: 0.4683 - val_accuracy20: 0.4488 - val_accuracy30: 0.4282 - val_accuracy50: 0.4041 - 24s/epoch - 34ms/step
Epoch 14/50
694/694 - 24s - loss: 12.4057 - accuracy10: 0.4909 - accuracy20: 0.4683 - accuracy30: 0.4533 - accuracy50: 0.4363 - val_loss: 12.5980 - val_accuracy10: 0.4715 - val_accuracy20: 0.4525 - val_accuracy30: 0.4339 - val_accuracy50: 0.4087 - 24s/epoch - 34ms/step
Epoch 15/50
694/694 - 23s - loss: 12.3842 - accuracy10: 0.4929 - accuracy20: 0.4701 - accuracy30: 0.4558 - accuracy50: 0.4388 - val_loss: 12.6214 - val_accuracy10: 0.4703 - val_accuracy20: 0.4511 - val_accuracy30: 0.4308 - val_accuracy50: 0.4070 - 23s/epoch - 33ms/step
Epoch 16/50
694/694 - 23s - loss: 12.3707 - accuracy10: 0.4944 - accuracy20: 0.4720 - accuracy30: 0.4562 - accuracy50: 0.4397 - val_loss: 12.6129 - val_accuracy10: 0.4688 - val_accuracy20: 0.4484 - val_accuracy30: 0.4308 - val_accuracy50: 0.4040 - 23s/epoch - 33ms/step
Epoch 17/50
694/694 - 24s - loss: 12.3613 - accuracy10: 0.4949 - accuracy20: 0.4720 - accuracy30: 0.4574 - accuracy50: 0.4409 - val_loss: 12.6089 - val_accuracy10: 0.4709 - val_accuracy20: 0.4517 - val_accuracy30: 0.4310 - val_accuracy50: 0.4063 - 24s/epoch - 34ms/step
Epoch 18/50
694/694 - 23s - loss: 12.3400 - accuracy10: 0.4964 - accuracy20: 0.4741 - accuracy30: 0.4588 - accuracy50: 0.4420 - val_loss: 12.6058 - val_accuracy10: 0.4748 - val_accuracy20: 0.4537 - val_accuracy30: 0.4324 - val_accuracy50: 0.4076 - 23s/epoch - 34ms/step
Epoch 19/50
694/694 - 24s - loss: 12.3257 - accuracy10: 0.4972 - accuracy20: 0.4742 - accuracy30: 0.4594 - accuracy50: 0.4440 - val_loss: 12.6124 - val_accuracy10: 0.4695 - val_accuracy20: 0.4496 - val_accuracy30: 0.4317 - val_accuracy50: 0.4045 - 24s/epoch - 34ms/step
Epoch 20/50
694/694 - 24s - loss: 12.3168 - accuracy10: 0.4970 - accuracy20: 0.4754 - accuracy30: 0.4615 - accuracy50: 0.4456 - val_loss: 12.6206 - val_accuracy10: 0.4709 - val_accuracy20: 0.4490 - val_accuracy30: 0.4308 - val_accuracy50: 0.4045 - 24s/epoch - 34ms/step
testing model: results/PCAR/W5/deepVOL_L2/seq2seq
Evaluating performance on  test set...
2900/2900 - 41s - 41s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0549442
{'0': {'precision': 0.453065094081918, 'recall': 0.5389046677956124, 'f1-score': 0.4922708400987489, 'support': 261601}, '1': {'precision': 0.4417159123666763, 'recall': 0.1132184385765611, 'f1-score': 0.18023892666789193, 'support': 216546}, '2': {'precision': 0.4438192228146153, 'recall': 0.6310789482648338, 'f1-score': 0.5211376777621504, 'support': 264211}, 'accuracy': 0.4475374415039644, 'macro avg': {'precision': 0.44620007642106985, 'recall': 0.42773401821233575, 'f1-score': 0.3978824815095971, 'support': 742358}, 'weighted avg': {'precision': 0.4464638574856746, 'recall': 0.4475374415039644, 'f1-score': 0.4115249914921286, 'support': 742358}}
[[140978  16031 104592]
 [ 87670  24517 104359]
 [ 82517  14956 166738]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0654347
{'0': {'precision': 0.44153610438392726, 'recall': 0.5119248180620022, 'f1-score': 0.4741322577221102, 'support': 261765}, '1': {'precision': 0.37613309956354685, 'recall': 0.14002351547021682, 'f1-score': 0.20407557455076591, 'support': 216028}, '2': {'precision': 0.43865674223444795, 'recall': 0.5943076370646155, 'f1-score': 0.5047551632646182, 'support': 264565}, 'accuracy': 0.43306059879465164, 'macro avg': {'precision': 0.418775315393974, 'recall': 0.4154186568656115, 'f1-score': 0.3943209985124982, 'support': 742358}, 'weighted avg': {'precision': 0.4214775089725299, 'recall': 0.43306059879465164, 'f1-score': 0.40645863374650065, 'support': 742358}}
[[134004  25740 102021]
 [ 86591  30249  99188]
 [ 82900  24432 157233]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0751487
{'0': {'precision': 0.4330924529462839, 'recall': 0.4832423649491378, 'f1-score': 0.45679508650356854, 'support': 262179}, '1': {'precision': 0.33697297297297296, 'recall': 0.18750173522743047, 'f1-score': 0.2409382804138423, 'support': 216110}, '2': {'precision': 0.43233000576508784, 'recall': 0.5395673100591133, 'f1-score': 0.4800324776505587, 'support': 264069}, 'accuracy': 0.41718416181949947, 'macro avg': {'precision': 0.40079847722811496, 'recall': 0.4034371367452272, 'f1-score': 0.39258861485598984, 'support': 742358}, 'weighted avg': {'precision': 0.40483961606472074, 'recall': 0.41718416181949947, 'f1-score': 0.40222230663017033, 'support': 742358}}
[[126696  40020  95463]
 [ 83965  40521  91624]
 [ 81877  39709 142483]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0873389
{'0': {'precision': 0.45333593992062204, 'recall': 0.43109943456849015, 'f1-score': 0.441938151743977, 'support': 285092}, '1': {'precision': 0.25009749783809143, 'recall': 0.2579830805916546, 'f1-score': 0.2539790957565879, 'support': 171519}, '2': {'precision': 0.44909504184178606, 'recall': 0.4625735353302047, 'f1-score': 0.4557346527143275, 'support': 285747}, 'accuracy': 0.4032165073993949, 'macro avg': {'precision': 0.3841761598668332, 'recall': 0.3838853501634498, 'f1-score': 0.38388396673829744, 'support': 742358}, 'weighted avg': {'precision': 0.4047460705437355, 'recall': 0.4032165073993949, 'f1-score': 0.40382144718751467, 'support': 742358}}
[[122903  65067  97122]
 [ 62248  44249  65022]
 [ 85957  67611 132179]]
Evaluating performance on  train set...
694/694 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0242932
{'0': {'precision': 0.4648083723872229, 'recall': 0.5371554831957205, 'f1-score': 0.4983700050094409, 'support': 60193}, '1': {'precision': 0.5061454928550204, 'recall': 0.32496227822196017, 'f1-score': 0.3958047276030335, 'support': 57659}, '2': {'precision': 0.4686360372284254, 'recall': 0.5570376569037657, 'f1-score': 0.5090272308080538, 'support': 59750}, 'accuracy': 0.4749552369905744, 'macro avg': {'precision': 0.4798633008235562, 'recall': 0.47305180610714875, 'f1-score': 0.4677339878068427, 'support': 177602}, 'weighted avg': {'precision': 0.47951631488401114, 'recall': 0.4749552369905744, 'f1-score': 0.46865726478968595, 'support': 177602}}
[[32333  9585 18275]
 [19459 18737 19463]
 [17770  8697 33283]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0427632
{'0': {'precision': 0.44710790879559065, 'recall': 0.49457586130553993, 'f1-score': 0.46964551394009957, 'support': 58719}, '1': {'precision': 0.4625528101395468, 'recall': 0.35856296933408316, 'f1-score': 0.4039730162871306, 'support': 60458}, '2': {'precision': 0.4505115303345849, 'recall': 0.5072486093281986, 'f1-score': 0.4771995362617545, 'support': 58425}, 'accuracy': 0.4524442292316528, 'macro avg': {'precision': 0.4533907497565741, 'recall': 0.45346247998927386, 'f1-score': 0.45027268882966154, 'support': 177602}, 'weighted avg': {'precision': 0.4534852268092877, 'recall': 0.4524442292316528, 'f1-score': 0.44977476862776916, 'support': 177602}}
[[29041 12810 16868]
 [19501 21678 19279]
 [16411 12378 29636]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0576334
{'0': {'precision': 0.4442914014076227, 'recall': 0.4433010424697483, 'f1-score': 0.4437956694267569, 'support': 59666}, '1': {'precision': 0.4078105207013801, 'recall': 0.414765214443126, 'f1-score': 0.4112584673827173, 'support': 58990}, '2': {'precision': 0.44759182408348114, 'recall': 0.44096291521053166, 'f1-score': 0.4442526427332314, 'support': 58946}, 'accuracy': 0.43304692514723936, 'macro avg': {'precision': 0.4332312487308279, 'recall': 0.4330097240411353, 'f1-score': 0.4331022598475685, 'support': 177602}, 'weighted avg': {'precision': 0.4332697888255003, 'recall': 0.43304692514723936, 'f1-score': 0.4331401993303929, 'support': 177602}}
[[26450 18031 15185]
 [17628 24467 16895]
 [15455 17498 25993]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0747949
{'0': {'precision': 0.42595777655975353, 'recall': 0.37937884016496926, 'f1-score': 0.4013212956532578, 'support': 59405}, '1': {'precision': 0.38011657085197625, 'recall': 0.477612438275724, 'f1-score': 0.42332345135033234, 'support': 59944}, '2': {'precision': 0.42494025195446994, 'recall': 0.3601702916587987, 'f1-score': 0.3898835793992214, 'support': 58253}, 'accuracy': 0.4062341640296844, 'macro avg': {'precision': 0.41033819978873326, 'recall': 0.40572052336649733, 'f1-score': 0.40484277546760383, 'support': 177602}, 'weighted avg': {'precision': 0.41015176595301156, 'recall': 0.4062341640296844, 'f1-score': 0.4049958935528257, 'support': 177602}}
[[22537 23444 13424]
 [16345 28630 14969]
 [14027 23245 20981]]
Evaluating performance on  val set...
238/238 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0222723
{'0': {'precision': 0.4602518067360575, 'recall': 0.5098690835850956, 'f1-score': 0.48379159599627336, 'support': 19860}, '1': {'precision': 0.5382577764323015, 'recall': 0.338071017730665, 'f1-score': 0.4152992700729927, 'support': 21037}, '2': {'precision': 0.45101937395236424, 'recall': 0.5793690535803706, 'f1-score': 0.5072003156302742, 'support': 19970}, 'accuracy': 0.4732942316854782, 'macro avg': {'precision': 0.4831763190402411, 'recall': 0.4757697182987104, 'f1-score': 0.4687637272331801, 'support': 60867}, 'weighted avg': {'precision': 0.48418332795132246, 'recall': 0.4732942316854782, 'f1-score': 0.46779933534013696, 'support': 60867}}
[[10126  3225  6509]
 [ 6351  7112  7574]
 [ 5524  2876 11570]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0398378
{'0': {'precision': 0.4463038416763679, 'recall': 0.4687213448802853, 'f1-score': 0.45723798638373997, 'support': 19630}, '1': {'precision': 0.4890533268101761, 'recall': 0.3668516904445158, 'f1-score': 0.419228853765301, 'support': 21799}, '2': {'precision': 0.42955772208042176, 'recall': 0.5281407552217307, 'f1-score': 0.4737752959364977, 'support': 19438}, 'accuracy': 0.4512133011319763, 'macro avg': {'precision': 0.45497163018898856, 'recall': 0.4545712635155106, 'f1-score': 0.45008071202851285, 'support': 60867}, 'weighted avg': {'precision': 0.45626630004832447, 'recall': 0.4512133011319763, 'f1-score': 0.44890656116378747, 'support': 60867}}
[[ 9201  4330  6099]
 [ 6268  7997  7534]
 [ 5147  4025 10266]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.056498
{'0': {'precision': 0.43861303163628745, 'recall': 0.42139694041867953, 'f1-score': 0.4298326660507135, 'support': 19872}, '1': {'precision': 0.4326674156205734, 'recall': 0.41614206520717845, 'f1-score': 0.42424387557173304, 'support': 21286}, '2': {'precision': 0.42418552248615154, 'recall': 0.45847074940382565, 'f1-score': 0.4406622613445173, 'support': 19709}, 'accuracy': 0.4315639016215683, 'macro avg': {'precision': 0.43182198991433746, 'recall': 0.43200325167656123, 'f1-score': 0.4315796009889879, 'support': 60867}, 'weighted avg': {'precision': 0.4318620802118618, 'recall': 0.4315639016215683, 'f1-score': 0.43138486181377067, 'support': 60867}}
[[8374 5856 5642]
 [5804 8858 6624]
 [4914 5759 9036]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0761244
{'0': {'precision': 0.41716788321167886, 'recall': 0.36133731222497595, 'f1-score': 0.3872506504770164, 'support': 19771}, '1': {'precision': 0.39281888514183694, 'recall': 0.46220998085990384, 'f1-score': 0.42469866598035433, 'support': 21421}, '2': {'precision': 0.4023844203484922, 'recall': 0.3791105463786531, 'f1-score': 0.3904009211765937, 'support': 19675}, 'accuracy': 0.4025826802700971, 'macro avg': {'precision': 0.40412372956733594, 'recall': 0.40088594648784426, 'f1-score': 0.4007834125446548, 'support': 60867}, 'weighted avg': {'precision': 0.40382001787434857, 'recall': 0.4025826802700971, 'f1-score': 0.4014480894194842, 'support': 60867}}
[[7144 7567 5060]
 [5502 9901 6018]
 [4479 7737 7459]]
training model: results/PCAR/W5/deepVOL_L3/seq2seq
Epoch 1/50
694/694 - 39s - loss: 13.1356 - accuracy10: 0.3710 - accuracy20: 0.3740 - accuracy30: 0.3711 - accuracy50: 0.3753 - val_loss: 13.1393 - val_accuracy10: 0.3697 - val_accuracy20: 0.3745 - val_accuracy30: 0.3642 - val_accuracy50: 0.3622 - 39s/epoch - 56ms/step
Epoch 2/50
694/694 - 33s - loss: 12.9517 - accuracy10: 0.4026 - accuracy20: 0.4016 - accuracy30: 0.3970 - accuracy50: 0.3960 - val_loss: 12.9622 - val_accuracy10: 0.4131 - val_accuracy20: 0.4056 - val_accuracy30: 0.4013 - val_accuracy50: 0.3901 - 33s/epoch - 48ms/step
Epoch 3/50
694/694 - 33s - loss: 12.8097 - accuracy10: 0.4299 - accuracy20: 0.4222 - accuracy30: 0.4152 - accuracy50: 0.4096 - val_loss: 12.9023 - val_accuracy10: 0.4286 - val_accuracy20: 0.4134 - val_accuracy30: 0.4048 - val_accuracy50: 0.3891 - 33s/epoch - 47ms/step
Epoch 4/50
694/694 - 32s - loss: 12.7185 - accuracy10: 0.4461 - accuracy20: 0.4348 - accuracy30: 0.4257 - accuracy50: 0.4154 - val_loss: 12.7544 - val_accuracy10: 0.4455 - val_accuracy20: 0.4320 - val_accuracy30: 0.4186 - val_accuracy50: 0.4036 - 32s/epoch - 46ms/step
Epoch 5/50
694/694 - 32s - loss: 12.6569 - accuracy10: 0.4553 - accuracy20: 0.4420 - accuracy30: 0.4323 - accuracy50: 0.4194 - val_loss: 12.6639 - val_accuracy10: 0.4547 - val_accuracy20: 0.4422 - val_accuracy30: 0.4278 - val_accuracy50: 0.4104 - 32s/epoch - 46ms/step
Epoch 6/50
694/694 - 33s - loss: 12.6185 - accuracy10: 0.4611 - accuracy20: 0.4444 - accuracy30: 0.4345 - accuracy50: 0.4220 - val_loss: 12.6575 - val_accuracy10: 0.4570 - val_accuracy20: 0.4419 - val_accuracy30: 0.4268 - val_accuracy50: 0.4098 - 33s/epoch - 47ms/step
Epoch 7/50
694/694 - 33s - loss: 12.5791 - accuracy10: 0.4684 - accuracy20: 0.4493 - accuracy30: 0.4381 - accuracy50: 0.4244 - val_loss: 12.6608 - val_accuracy10: 0.4603 - val_accuracy20: 0.4455 - val_accuracy30: 0.4297 - val_accuracy50: 0.4117 - 33s/epoch - 47ms/step
Epoch 8/50
694/694 - 34s - loss: 12.5495 - accuracy10: 0.4734 - accuracy20: 0.4538 - accuracy30: 0.4412 - accuracy50: 0.4260 - val_loss: 12.6863 - val_accuracy10: 0.4566 - val_accuracy20: 0.4416 - val_accuracy30: 0.4256 - val_accuracy50: 0.4134 - 34s/epoch - 49ms/step
Epoch 9/50
694/694 - 34s - loss: 12.5179 - accuracy10: 0.4768 - accuracy20: 0.4562 - accuracy30: 0.4426 - accuracy50: 0.4285 - val_loss: 12.6660 - val_accuracy10: 0.4661 - val_accuracy20: 0.4461 - val_accuracy30: 0.4304 - val_accuracy50: 0.4148 - 34s/epoch - 49ms/step
Epoch 10/50
694/694 - 32s - loss: 12.4959 - accuracy10: 0.4801 - accuracy20: 0.4583 - accuracy30: 0.4441 - accuracy50: 0.4303 - val_loss: 12.6769 - val_accuracy10: 0.4668 - val_accuracy20: 0.4489 - val_accuracy30: 0.4330 - val_accuracy50: 0.4154 - 32s/epoch - 47ms/step
Epoch 11/50
694/694 - 34s - loss: 12.4689 - accuracy10: 0.4834 - accuracy20: 0.4610 - accuracy30: 0.4464 - accuracy50: 0.4316 - val_loss: 12.6771 - val_accuracy10: 0.4696 - val_accuracy20: 0.4503 - val_accuracy30: 0.4315 - val_accuracy50: 0.4146 - 34s/epoch - 48ms/step
Epoch 12/50
694/694 - 33s - loss: 12.4465 - accuracy10: 0.4865 - accuracy20: 0.4619 - accuracy30: 0.4480 - accuracy50: 0.4341 - val_loss: 12.6698 - val_accuracy10: 0.4730 - val_accuracy20: 0.4534 - val_accuracy30: 0.4342 - val_accuracy50: 0.4144 - 33s/epoch - 47ms/step
Epoch 13/50
694/694 - 32s - loss: 12.4274 - accuracy10: 0.4884 - accuracy20: 0.4654 - accuracy30: 0.4506 - accuracy50: 0.4359 - val_loss: 12.6656 - val_accuracy10: 0.4738 - val_accuracy20: 0.4533 - val_accuracy30: 0.4351 - val_accuracy50: 0.4174 - 32s/epoch - 45ms/step
Epoch 14/50
694/694 - 32s - loss: 12.4122 - accuracy10: 0.4890 - accuracy20: 0.4661 - accuracy30: 0.4504 - accuracy50: 0.4356 - val_loss: 12.6643 - val_accuracy10: 0.4758 - val_accuracy20: 0.4542 - val_accuracy30: 0.4364 - val_accuracy50: 0.4179 - 32s/epoch - 46ms/step
Epoch 15/50
694/694 - 32s - loss: 12.4032 - accuracy10: 0.4910 - accuracy20: 0.4675 - accuracy30: 0.4523 - accuracy50: 0.4370 - val_loss: 12.6780 - val_accuracy10: 0.4757 - val_accuracy20: 0.4549 - val_accuracy30: 0.4379 - val_accuracy50: 0.4172 - 32s/epoch - 46ms/step
Epoch 16/50
694/694 - 32s - loss: 12.3810 - accuracy10: 0.4930 - accuracy20: 0.4696 - accuracy30: 0.4523 - accuracy50: 0.4385 - val_loss: 12.6497 - val_accuracy10: 0.4742 - val_accuracy20: 0.4538 - val_accuracy30: 0.4371 - val_accuracy50: 0.4153 - 32s/epoch - 46ms/step
Epoch 17/50
694/694 - 32s - loss: 12.3698 - accuracy10: 0.4946 - accuracy20: 0.4706 - accuracy30: 0.4549 - accuracy50: 0.4386 - val_loss: 12.6584 - val_accuracy10: 0.4783 - val_accuracy20: 0.4571 - val_accuracy30: 0.4406 - val_accuracy50: 0.4163 - 32s/epoch - 46ms/step
Epoch 18/50
694/694 - 32s - loss: 12.3565 - accuracy10: 0.4962 - accuracy20: 0.4725 - accuracy30: 0.4559 - accuracy50: 0.4399 - val_loss: 12.6751 - val_accuracy10: 0.4752 - val_accuracy20: 0.4555 - val_accuracy30: 0.4390 - val_accuracy50: 0.4165 - 32s/epoch - 46ms/step
Epoch 19/50
694/694 - 32s - loss: 12.3454 - accuracy10: 0.4970 - accuracy20: 0.4728 - accuracy30: 0.4568 - accuracy50: 0.4407 - val_loss: 12.6759 - val_accuracy10: 0.4768 - val_accuracy20: 0.4572 - val_accuracy30: 0.4396 - val_accuracy50: 0.4179 - 32s/epoch - 46ms/step
Epoch 20/50
694/694 - 32s - loss: 12.3264 - accuracy10: 0.4976 - accuracy20: 0.4734 - accuracy30: 0.4582 - accuracy50: 0.4426 - val_loss: 12.7208 - val_accuracy10: 0.4759 - val_accuracy20: 0.4555 - val_accuracy30: 0.4376 - val_accuracy50: 0.4167 - 32s/epoch - 46ms/step
Epoch 21/50
694/694 - 32s - loss: 12.3159 - accuracy10: 0.4995 - accuracy20: 0.4753 - accuracy30: 0.4596 - accuracy50: 0.4434 - val_loss: 12.7121 - val_accuracy10: 0.4747 - val_accuracy20: 0.4556 - val_accuracy30: 0.4383 - val_accuracy50: 0.4160 - 32s/epoch - 46ms/step
Epoch 22/50
694/694 - 32s - loss: 12.3055 - accuracy10: 0.4998 - accuracy20: 0.4774 - accuracy30: 0.4597 - accuracy50: 0.4454 - val_loss: 12.7167 - val_accuracy10: 0.4768 - val_accuracy20: 0.4552 - val_accuracy30: 0.4371 - val_accuracy50: 0.4164 - 32s/epoch - 46ms/step
Epoch 23/50
694/694 - 32s - loss: 12.2820 - accuracy10: 0.5002 - accuracy20: 0.4777 - accuracy30: 0.4617 - accuracy50: 0.4466 - val_loss: 12.7583 - val_accuracy10: 0.4737 - val_accuracy20: 0.4515 - val_accuracy30: 0.4339 - val_accuracy50: 0.4128 - 32s/epoch - 47ms/step
Epoch 24/50
694/694 - 32s - loss: 12.2626 - accuracy10: 0.5040 - accuracy20: 0.4811 - accuracy30: 0.4637 - accuracy50: 0.4480 - val_loss: 12.7007 - val_accuracy10: 0.4757 - val_accuracy20: 0.4538 - val_accuracy30: 0.4363 - val_accuracy50: 0.4169 - 32s/epoch - 47ms/step
Epoch 25/50
694/694 - 32s - loss: 12.2577 - accuracy10: 0.5034 - accuracy20: 0.4798 - accuracy30: 0.4630 - accuracy50: 0.4484 - val_loss: 12.6941 - val_accuracy10: 0.4755 - val_accuracy20: 0.4537 - val_accuracy30: 0.4383 - val_accuracy50: 0.4147 - 32s/epoch - 46ms/step
Epoch 26/50
694/694 - 32s - loss: 12.2359 - accuracy10: 0.5051 - accuracy20: 0.4829 - accuracy30: 0.4672 - accuracy50: 0.4500 - val_loss: 12.7515 - val_accuracy10: 0.4743 - val_accuracy20: 0.4512 - val_accuracy30: 0.4350 - val_accuracy50: 0.4152 - 32s/epoch - 46ms/step
testing model: results/PCAR/W5/deepVOL_L3/seq2seq
Evaluating performance on  test set...
2900/2900 - 61s - 61s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0852218
{'0': {'precision': 0.44301924283622673, 'recall': 0.6477268817779749, 'f1-score': 0.5261636346981203, 'support': 261601}, '1': {'precision': 0.49698125198601845, 'recall': 0.03611241953210865, 'f1-score': 0.06733223983020566, 'support': 216546}, '2': {'precision': 0.44909238310818467, 'recall': 0.5849567201971152, 'f1-score': 0.5080989029413795, 'support': 264211}, 'accuracy': 0.4469784120330083, 'macro avg': {'precision': 0.4630309593101433, 'recall': 0.42293200716906626, 'f1-score': 0.3671982591565685, 'support': 742358}, 'weighted avg': {'precision': 0.4609214513363643, 'recall': 0.4469784120330083, 'f1-score': 0.3858930320033993, 'support': 742358}}
[[169446   3726  88429]
 [107564   7820 101162]
 [105470   4189 154552]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0774254
{'0': {'precision': 0.43068300456069014, 'recall': 0.6288006417970317, 'f1-score': 0.5112183668145056, 'support': 261765}, '1': {'precision': 0.4090807625340417, 'recall': 0.04241579795211732, 'f1-score': 0.07686210034937319, 'support': 216028}, '2': {'precision': 0.4445378648824679, 'recall': 0.5675580670156672, 'f1-score': 0.4985714167130133, 'support': 264565}, 'accuracy': 0.43633529914138464, 'macro avg': {'precision': 0.4281005439923999, 'recall': 0.41292483558827203, 'f1-score': 0.36221729462563074, 'support': 742358}, 'weighted avg': {'precision': 0.4293343587327989, 'recall': 0.43633529914138464, 'f1-score': 0.3803124482610167, 'support': 742358}}
[[164598   6152  91015]
 [110256   9163  96609]
 [107325   7084 150156]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0768169
{'0': {'precision': 0.4220594665500656, 'recall': 0.6185163571453092, 'f1-score': 0.5017427424407677, 'support': 262179}, '1': {'precision': 0.3513199883957064, 'recall': 0.06724353338577577, 'f1-score': 0.11288130063618075, 'support': 216110}, '2': {'precision': 0.4392350478884266, 'recall': 0.5269077400224941, 'f1-score': 0.4790934617894213, 'support': 264069}, 'accuracy': 0.4254470215179199, 'macro avg': {'precision': 0.4042048342780662, 'recall': 0.40422254351785963, 'f1-score': 0.36457250162212324, 'support': 742358}, 'weighted avg': {'precision': 0.40757592890987193, 'recall': 0.4254470215179199, 'f1-score': 0.38048343213400243, 'support': 742358}}
[[162162  12409  87608]
 [111548  14532  90030]
 [110506  14423 139140]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0732353
{'0': {'precision': 0.44210464366635366, 'recall': 0.5797005878804036, 'f1-score': 0.5016383042981396, 'support': 285092}, '1': {'precision': 0.2608506791580084, 'recall': 0.12954249966476017, 'f1-score': 0.17311393154601906, 'support': 171519}, '2': {'precision': 0.4581942277966389, 'recall': 0.4543634753820687, 'f1-score': 0.45627081118598506, 'support': 285747}, 'accuracy': 0.4274487511416325, 'macro avg': {'precision': 0.38704985020700033, 'recall': 0.3878688543090775, 'f1-score': 0.3770076823433812, 'support': 742358}, 'weighted avg': {'precision': 0.406419774180162, 'recall': 0.4274487511416325, 'f1-score': 0.40827122676359456, 'support': 742358}}
[[165268  29805  90019]
 [ 85794  22219  63506]
 [122759  33155 129833]]
Evaluating performance on  train set...
694/694 - 16s - 16s/epoch - 23ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0260539
{'0': {'precision': 0.46210872125457136, 'recall': 0.619274666489459, 'f1-score': 0.5292706129577304, 'support': 60193}, '1': {'precision': 0.5525616698292221, 'recall': 0.2777710331431346, 'f1-score': 0.36969668990351323, 'support': 57659}, '2': {'precision': 0.4716564633859195, 'recall': 0.5364016736401673, 'f1-score': 0.5019498519991855, 'support': 59750}, 'accuracy': 0.48052386797445973, 'macro avg': {'precision': 0.49544228482323766, 'recall': 0.47781579109092026, 'f1-score': 0.46697238495347637, 'support': 177602}, 'weighted avg': {'precision': 0.4946866435426865, 'recall': 0.48052386797445973, 'f1-score': 0.4682730549535628, 'support': 177602}}
[[37276  6273 16644]
 [22385 16016 19258]
 [21004  6696 32050]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0402242
{'0': {'precision': 0.4426501928151005, 'recall': 0.5942710196018325, 'f1-score': 0.5073754461981376, 'support': 58719}, '1': {'precision': 0.5023190835428891, 'recall': 0.2973634589301664, 'f1-score': 0.37357659379935165, 'support': 60458}, '2': {'precision': 0.45471578278818675, 'recall': 0.4901668806161746, 'f1-score': 0.4717762859849265, 'support': 58425}, 'accuracy': 0.45895316494183624, 'macro avg': {'precision': 0.46656168638205875, 'recall': 0.4606004530493912, 'f1-score': 0.45090944199413857, 'support': 177602}, 'weighted avg': {'precision': 0.466931416505139, 'recall': 0.45895316494183624, 'f1-score': 0.4501176903520173, 'support': 177602}}
[[34895  8271 15553]
 [23691 17978 18789]
 [20246  9541 28638]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0505807
{'0': {'precision': 0.43958548389259045, 'recall': 0.5495592129521, 'f1-score': 0.48845887426541235, 'support': 59666}, '1': {'precision': 0.4388333505101515, 'recall': 0.36090862858111544, 'f1-score': 0.39607460118134036, 'support': 58990}, '2': {'precision': 0.45300400044041544, 'recall': 0.41879007905540666, 'f1-score': 0.43522566995768686, 'support': 58946}, 'accuracy': 0.4434972579137622, 'macro avg': {'precision': 0.4438076116143858, 'recall': 0.4430859735295407, 'f1-score': 0.43991971513481315, 'support': 177602}, 'weighted avg': {'precision': 0.44378926272502484, 'recall': 0.4434972579137622, 'f1-score': 0.44010563088778937, 'support': 177602}}
[[32790 12744 14132]
 [22024 21290 15676]
 [19779 14481 24686]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0664152
{'0': {'precision': 0.42536946180115426, 'recall': 0.48016160255870716, 'f1-score': 0.451107842672107, 'support': 59405}, '1': {'precision': 0.41269697244654147, 'recall': 0.4552582410249566, 'f1-score': 0.4329340842389149, 'support': 59944}, '2': {'precision': 0.43332808032598663, 'recall': 0.3304207508626165, 'f1-score': 0.3749415614773258, 'support': 58253}, 'accuracy': 0.42264163691850315, 'macro avg': {'precision': 0.42379817152456084, 'recall': 0.42194686481542676, 'f1-score': 0.4196611627961159, 'support': 177602}, 'weighted avg': {'precision': 0.4237026658363236, 'recall': 0.42264163691850315, 'f1-score': 0.4199915142863971, 'support': 177602}}
[[28524 18678 12203]
 [19686 27290 12968]
 [18847 20158 19248]]
Evaluating performance on  val set...
238/238 - 5s - 5s/epoch - 22ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0385383
{'0': {'precision': 0.4463512852357834, 'recall': 0.5971802618328298, 'f1-score': 0.5108655854924511, 'support': 19860}, '1': {'precision': 0.5561641526923401, 'recall': 0.31373294671293434, 'f1-score': 0.4011670313639679, 'support': 21037}, '2': {'precision': 0.4615007356547327, 'recall': 0.5183274912368553, 'f1-score': 0.4882662326941673, 'support': 19970}, 'accuracy': 0.47334351947689224, 'macro avg': {'precision': 0.4880053911942854, 'recall': 0.4764135665942065, 'f1-score': 0.4667662831835288, 'support': 60867}, 'weighted avg': {'precision': 0.4892754940443332, 'recall': 0.47334351947689224, 'f1-score': 0.4655366295954523, 'support': 60867}}
[[11860  2500  5500]
 [ 7859  6600  6578]
 [ 6852  2767 10351]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0474719
{'0': {'precision': 0.4314785496389543, 'recall': 0.5692307692307692, 'f1-score': 0.4908735475651811, 'support': 19630}, '1': {'precision': 0.5119275146881858, 'recall': 0.3317583375384192, 'f1-score': 0.4026053554528754, 'support': 21799}, '2': {'precision': 0.4400518159573958, 'recall': 0.47185924477826935, 'f1-score': 0.45540080931456517, 'support': 19438}, 'accuracy': 0.4530862372057108, 'macro avg': {'precision': 0.461152626761512, 'recall': 0.4576161171824859, 'f1-score': 0.4496265707775406, 'support': 60867}, 'weighted avg': {'precision': 0.46302855440025453, 'recall': 0.4530862372057108, 'f1-score': 0.44793275196211835, 'support': 60867}}
[[11174  3240  5216]
 [ 8112  7232  6455]
 [ 6611  3655  9172]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0566611
{'0': {'precision': 0.42519907837826915, 'recall': 0.5293377616747182, 'f1-score': 0.47158772500056045, 'support': 19872}, '1': {'precision': 0.4514171167659669, 'recall': 0.3808606595884619, 'f1-score': 0.4131481717416231, 'support': 21286}, '2': {'precision': 0.4337608013649623, 'recall': 0.39986808057232737, 'f1-score': 0.41612545540947254, 'support': 19709}, 'accuracy': 0.435490495670889, 'macro avg': {'precision': 0.43679233216973284, 'recall': 0.43668883394516916, 'f1-score': 0.4336204507172187, 'support': 60867}, 'weighted avg': {'precision': 0.43714019858240716, 'recall': 0.435490495670889, 'f1-score': 0.43319171070643564, 'support': 60867}}
[[10519  4615  4738]
 [ 7629  8107  5550]
 [ 6591  5237  7881]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.072418
{'0': {'precision': 0.40554211568066856, 'recall': 0.46633958828587324, 'f1-score': 0.4338211076083376, 'support': 19771}, '1': {'precision': 0.41768345825344255, 'recall': 0.44745810186265816, 'f1-score': 0.4320584191665352, 'support': 21421}, '2': {'precision': 0.4229452054794521, 'recall': 0.3264040660736976, 'f1-score': 0.3684557789953814, 'support': 19675}, 'accuracy': 0.4144610380008872, 'macro avg': {'precision': 0.4153902598045211, 'recall': 0.41340058540740965, 'f1-score': 0.41144510192341804, 'support': 60867}, 'weighted avg': {'precision': 0.4154405087515026, 'recall': 0.4144610380008872, 'f1-score': 0.41207169676877325, 'support': 60867}}
[[9220 6370 4181]
 [7255 9585 4581]
 [6260 6993 6422]]
training model: results/PCAR/W6/deepLOB_L1/seq2seq
Epoch 1/50
618/618 - 26s - loss: 13.0406 - accuracy10: 0.3968 - accuracy20: 0.3924 - accuracy30: 0.3882 - accuracy50: 0.3940 - val_loss: 13.2253 - val_accuracy10: 0.3825 - val_accuracy20: 0.3758 - val_accuracy30: 0.3692 - val_accuracy50: 0.3623 - 26s/epoch - 43ms/step
Epoch 2/50
618/618 - 19s - loss: 12.9302 - accuracy10: 0.4197 - accuracy20: 0.4094 - accuracy30: 0.4013 - accuracy50: 0.4017 - val_loss: 13.0584 - val_accuracy10: 0.3981 - val_accuracy20: 0.3936 - val_accuracy30: 0.3836 - val_accuracy50: 0.3738 - 19s/epoch - 31ms/step
Epoch 3/50
618/618 - 18s - loss: 12.8945 - accuracy10: 0.4327 - accuracy20: 0.4167 - accuracy30: 0.4060 - accuracy50: 0.4032 - val_loss: 13.0440 - val_accuracy10: 0.4060 - val_accuracy20: 0.3985 - val_accuracy30: 0.3909 - val_accuracy50: 0.3755 - 18s/epoch - 29ms/step
Epoch 4/50
618/618 - 18s - loss: 12.8453 - accuracy10: 0.4438 - accuracy20: 0.4234 - accuracy30: 0.4110 - accuracy50: 0.4061 - val_loss: 13.0276 - val_accuracy10: 0.4093 - val_accuracy20: 0.4009 - val_accuracy30: 0.3930 - val_accuracy50: 0.3774 - 18s/epoch - 29ms/step
Epoch 5/50
618/618 - 18s - loss: 12.8290 - accuracy10: 0.4455 - accuracy20: 0.4256 - accuracy30: 0.4116 - accuracy50: 0.4060 - val_loss: 12.9322 - val_accuracy10: 0.4284 - val_accuracy20: 0.4155 - val_accuracy30: 0.4039 - val_accuracy50: 0.3822 - 18s/epoch - 30ms/step
Epoch 6/50
618/618 - 18s - loss: 12.8041 - accuracy10: 0.4520 - accuracy20: 0.4296 - accuracy30: 0.4146 - accuracy50: 0.4075 - val_loss: 12.9149 - val_accuracy10: 0.4373 - val_accuracy20: 0.4212 - val_accuracy30: 0.4084 - val_accuracy50: 0.3858 - 18s/epoch - 28ms/step
Epoch 7/50
618/618 - 18s - loss: 12.7780 - accuracy10: 0.4563 - accuracy20: 0.4325 - accuracy30: 0.4170 - accuracy50: 0.4087 - val_loss: 12.8860 - val_accuracy10: 0.4420 - val_accuracy20: 0.4237 - val_accuracy30: 0.4107 - val_accuracy50: 0.3926 - 18s/epoch - 29ms/step
Epoch 8/50
618/618 - 17s - loss: 12.7645 - accuracy10: 0.4581 - accuracy20: 0.4339 - accuracy30: 0.4184 - accuracy50: 0.4100 - val_loss: 12.9020 - val_accuracy10: 0.4402 - val_accuracy20: 0.4223 - val_accuracy30: 0.4088 - val_accuracy50: 0.3873 - 17s/epoch - 28ms/step
Epoch 9/50
618/618 - 17s - loss: 12.7369 - accuracy10: 0.4605 - accuracy20: 0.4359 - accuracy30: 0.4203 - accuracy50: 0.4119 - val_loss: 12.9041 - val_accuracy10: 0.4388 - val_accuracy20: 0.4219 - val_accuracy30: 0.4081 - val_accuracy50: 0.3913 - 17s/epoch - 28ms/step
Epoch 10/50
618/618 - 17s - loss: 12.7144 - accuracy10: 0.4626 - accuracy20: 0.4385 - accuracy30: 0.4229 - accuracy50: 0.4133 - val_loss: 12.9218 - val_accuracy10: 0.4369 - val_accuracy20: 0.4212 - val_accuracy30: 0.4059 - val_accuracy50: 0.3866 - 17s/epoch - 28ms/step
Epoch 11/50
618/618 - 17s - loss: 12.6966 - accuracy10: 0.4642 - accuracy20: 0.4394 - accuracy30: 0.4236 - accuracy50: 0.4140 - val_loss: 12.9627 - val_accuracy10: 0.4331 - val_accuracy20: 0.4191 - val_accuracy30: 0.4070 - val_accuracy50: 0.3867 - 17s/epoch - 28ms/step
Epoch 12/50
618/618 - 18s - loss: 12.6774 - accuracy10: 0.4652 - accuracy20: 0.4414 - accuracy30: 0.4262 - accuracy50: 0.4155 - val_loss: 12.9580 - val_accuracy10: 0.4369 - val_accuracy20: 0.4210 - val_accuracy30: 0.4081 - val_accuracy50: 0.3902 - 18s/epoch - 29ms/step
Epoch 13/50
618/618 - 18s - loss: 12.6652 - accuracy10: 0.4664 - accuracy20: 0.4426 - accuracy30: 0.4265 - accuracy50: 0.4165 - val_loss: 12.9369 - val_accuracy10: 0.4343 - val_accuracy20: 0.4204 - val_accuracy30: 0.4082 - val_accuracy50: 0.3885 - 18s/epoch - 28ms/step
Epoch 14/50
618/618 - 18s - loss: 12.6557 - accuracy10: 0.4667 - accuracy20: 0.4430 - accuracy30: 0.4266 - accuracy50: 0.4171 - val_loss: 12.9642 - val_accuracy10: 0.4318 - val_accuracy20: 0.4187 - val_accuracy30: 0.4056 - val_accuracy50: 0.3878 - 18s/epoch - 29ms/step
Epoch 15/50
618/618 - 18s - loss: 12.6370 - accuracy10: 0.4692 - accuracy20: 0.4453 - accuracy30: 0.4287 - accuracy50: 0.4186 - val_loss: 13.0201 - val_accuracy10: 0.4289 - val_accuracy20: 0.4159 - val_accuracy30: 0.4045 - val_accuracy50: 0.3919 - 18s/epoch - 29ms/step
Epoch 16/50
618/618 - 18s - loss: 12.6319 - accuracy10: 0.4696 - accuracy20: 0.4454 - accuracy30: 0.4298 - accuracy50: 0.4189 - val_loss: 13.0491 - val_accuracy10: 0.4268 - val_accuracy20: 0.4126 - val_accuracy30: 0.4018 - val_accuracy50: 0.3858 - 18s/epoch - 29ms/step
Epoch 17/50
618/618 - 18s - loss: 12.6187 - accuracy10: 0.4702 - accuracy20: 0.4464 - accuracy30: 0.4298 - accuracy50: 0.4198 - val_loss: 13.0468 - val_accuracy10: 0.4252 - val_accuracy20: 0.4136 - val_accuracy30: 0.4021 - val_accuracy50: 0.3890 - 18s/epoch - 29ms/step
testing model: results/PCAR/W6/deepLOB_L1/seq2seq
Evaluating performance on  test set...
1722/1722 - 24s - 24s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0637108
{'0': {'precision': 0.44931937764221813, 'recall': 0.6433899697013059, 'f1-score': 0.5291207245004989, 'support': 160733}, '1': {'precision': 0.36740784780023783, 'recall': 0.2664327041639002, 'f1-score': 0.30887725980017294, 'support': 115973}, '2': {'precision': 0.5024339744906829, 'recall': 0.38745711273485156, 'f1-score': 0.43751784884821165, 'support': 164093}, 'accuracy': 0.44893931247575425, 'macro avg': {'precision': 0.439720399977713, 'recall': 0.43242659553335255, 'f1-score': 0.42517194438296113, 'support': 440799}, 'weighted avg': {'precision': 0.4475412603830845, 'recall': 0.44893931247575425, 'f1-score': 0.4370749485207402, 'support': 440799}}
[[103414  24162  33157]
 [ 55268  30899  29806]
 [ 71475  29039  63579]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0772039
{'0': {'precision': 0.4378937145656891, 'recall': 0.6194245049504951, 'f1-score': 0.5130756140566696, 'support': 161600}, '1': {'precision': 0.32116459240452266, 'recall': 0.23735620089786758, 'f1-score': 0.2729724960294451, 'support': 114048}, '2': {'precision': 0.4843105065666041, 'recall': 0.37512942700922186, 'f1-score': 0.42278492242494137, 'support': 165151}, 'accuracy': 0.4290436230572211, 'macro avg': {'precision': 0.41445627117893863, 'recall': 0.4106367109525282, 'f1-score': 0.402944344170352, 'support': 440799}, 'weighted avg': {'precision': 0.4250830155657059, 'recall': 0.4290436230572211, 'f1-score': 0.4171251277387777, 'support': 440799}}
[[100099  27001  34500]
 [ 55511  27070  31467]
 [ 72982  30216  61953]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0842725
{'0': {'precision': 0.419517489013541, 'recall': 0.5943184334567081, 'f1-score': 0.49184877227613905, 'support': 158055}, '1': {'precision': 0.3168031036035516, 'recall': 0.22486293342949165, 'f1-score': 0.2630302449312179, 'support': 122021}, '2': {'precision': 0.45963247823884307, 'recall': 0.37256646528499343, 'f1-score': 0.41154497750866836, 'support': 160723}, 'accuracy': 0.41119194916503893, 'macro avg': {'precision': 0.3986510236186452, 'recall': 0.3972492773903977, 'f1-score': 0.3888079982386751, 'support': 440799}, 'weighted avg': {'precision': 0.40571094542144104, 'recall': 0.41119194916503893, 'f1-score': 0.39922757229254824, 'support': 440799}}
[[93935 28594 35526]
 [59711 27438 34872]
 [70266 30577 59880]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0931888
{'0': {'precision': 0.4009934468701185, 'recall': 0.5454292229160729, 'f1-score': 0.46218999418138706, 'support': 154372}, '1': {'precision': 0.3177234424644288, 'recall': 0.24850089136189293, 'f1-score': 0.27888083906756794, 'support': 129577}, '2': {'precision': 0.42504846420599796, 'recall': 0.35087025820847945, 'f1-score': 0.3844136249812277, 'support': 156850}, 'accuracy': 0.38891422167473155, 'macro avg': {'precision': 0.3812551178468484, 'recall': 0.38160012416214845, 'f1-score': 0.3751614860767276, 'support': 440799}, 'weighted avg': {'precision': 0.38507497180156497, 'recall': 0.38891422167473155, 'f1-score': 0.38062929667248085, 'support': 440799}}
[[84199 33592 36581]
 [59515 32200 37862]
 [66262 35554 55034]]
Evaluating performance on  train set...
618/618 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0606008
{'0': {'precision': 0.422005980030968, 'recall': 0.6111658837402617, 'f1-score': 0.4992696119072999, 'support': 51729}, '1': {'precision': 0.4941587650885085, 'recall': 0.284824293068716, 'f1-score': 0.36136452380107204, 'support': 53612}, '2': {'precision': 0.44483658124904096, 'recall': 0.4408119820573253, 'f1-score': 0.44281513728185745, 'support': 52612}, 'accuracy': 0.44365729045982033, 'macro avg': {'precision': 0.45366710878950584, 'recall': 0.445600719622101, 'f1-score': 0.43448309099674315, 'support': 157953}, 'weighted avg': {'precision': 0.45410045562681056, 'recall': 0.44365729045982033, 'f1-score': 0.433658003374731, 'support': 157953}}
[[31615  7444 12670]
 [22068 15270 16274]
 [21233  8187 23192]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0721979
{'0': {'precision': 0.41494991494991496, 'recall': 0.5849986677324807, 'f1-score': 0.48551525873507295, 'support': 52542}, '1': {'precision': 0.44891661195009847, 'recall': 0.2600212976344413, 'f1-score': 0.3293035353048839, 'support': 52588}, '2': {'precision': 0.42771298601621144, 'recall': 0.4325388561800731, 'f1-score': 0.4301123849325126, 'support': 52823}, 'accuracy': 0.4258165403632726, 'macro avg': {'precision': 0.4305265043054083, 'recall': 0.425852940515665, 'f1-score': 0.4149770596574898, 'support': 157953}, 'weighted avg': {'precision': 0.43052685470275676, 'recall': 0.4258165403632726, 'f1-score': 0.4149790352089644, 'support': 157953}}
[[30737  8196 13609]
 [21952 13674 16962]
 [21385  8590 22848]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0793171
{'0': {'precision': 0.405234393469524, 'recall': 0.5539923954372623, 'f1-score': 0.46807861279104324, 'support': 52600}, '1': {'precision': 0.4223645094900526, 'recall': 0.24701476853709328, 'f1-score': 0.3117224418941074, 'support': 52341}, '2': {'precision': 0.4147168654050836, 'recall': 0.433656530596846, 'f1-score': 0.42397528701184933, 'support': 53012}, 'accuracy': 0.41188201553626713, 'macro avg': {'precision': 0.4141052561215534, 'recall': 0.41155456485706715, 'f1-score': 0.40125878056566666, 'support': 157953}, 'weighted avg': {'precision': 0.41409330849410964, 'recall': 0.41188201553626713, 'f1-score': 0.40146484890480405, 'support': 157953}}
[[29140  8778 14682]
 [21650 12929 17762]
 [21119  8904 22989]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0871432
{'0': {'precision': 0.39120445854208047, 'recall': 0.5029537312295145, 'f1-score': 0.44009604642243755, 'support': 52476}, '1': {'precision': 0.40553132140419595, 'recall': 0.259553293322191, 'f1-score': 0.3165221016548737, 'support': 52652}, '2': {'precision': 0.40011974360780445, 'recall': 0.4301372456223379, 'f1-score': 0.4145858611661026, 'support': 52825}, 'accuracy': 0.3974663349224136, 'macro avg': {'precision': 0.39895184118469357, 'recall': 0.39754809005801445, 'f1-score': 0.39040133641447133, 'support': 157953}, 'weighted avg': {'precision': 0.3989617529082082, 'recall': 0.3974663349224136, 'f1-score': 0.3903724522136054, 'support': 157953}}
[[26393 10121 15962]
 [20882 13666 18104]
 [20191  9912 22722]]
Evaluating performance on  val set...
225/225 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0588601
{'0': {'precision': 0.4210796509102397, 'recall': 0.5755073402417962, 'f1-score': 0.4863287040204328, 'support': 18528}, '1': {'precision': 0.48708944432968393, 'recall': 0.33910167297828486, 'f1-score': 0.39984173637802395, 'support': 20861}, '2': {'precision': 0.4303409090909091, 'recall': 0.41944952096140004, 'f1-score': 0.4248254199736377, 'support': 18057}, 'accuracy': 0.4406050899975629, 'macro avg': {'precision': 0.4461700014436109, 'recall': 0.44468617806049365, 'f1-score': 0.43699862012403146, 'support': 57446}, 'weighted avg': {'precision': 0.44796160682520975, 'recall': 0.4406050899975629, 'f1-score': 0.43558941091001135, 'support': 57446}}
[[10663  3604  4261]
 [ 8022  7074  5765]
 [ 6638  3845  7574]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0712475
{'0': {'precision': 0.41652714661564216, 'recall': 0.5500631711939356, 'f1-score': 0.47407104940792155, 'support': 18996}, '1': {'precision': 0.4377211852057456, 'recall': 0.3175753914313044, 'f1-score': 0.3680924315807901, 'support': 19863}, '2': {'precision': 0.4226976433227478, 'recall': 0.4081885188572658, 'f1-score': 0.4153164002627545, 'support': 18587}, 'accuracy': 0.423771890122898, 'macro avg': {'precision': 0.42564865838137855, 'recall': 0.4252756938275019, 'f1-score': 0.41915996041715536, 'support': 57446}, 'weighted avg': {'precision': 0.42585187263329694, 'recall': 0.423771890122898, 'f1-score': 0.4184165921861562, 'support': 57446}}
[[10449  3996  4551]
 [ 7744  6308  5811]
 [ 6893  4107  7587]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0780262
{'0': {'precision': 0.41081125219450454, 'recall': 0.5260901390776953, 'f1-score': 0.46135858226919463, 'support': 19126}, '1': {'precision': 0.40575101956176124, 'recall': 0.30159790371474077, 'f1-score': 0.3460064839375184, 'support': 19463}, '2': {'precision': 0.41160878502650655, 'recall': 0.403510632656308, 'f1-score': 0.40751948156280965, 'support': 18857}, 'accuracy': 0.4097935452424886, 'macro avg': {'precision': 0.40939035226092413, 'recall': 0.4103995584829147, 'f1-score': 0.40496151592317425, 'support': 57446}, 'weighted avg': {'precision': 0.40935861439347365, 'recall': 0.4097935452424886, 'f1-score': 0.4046036852902976, 'support': 57446}}
[[10062  4218  4846]
 [ 7562  5870  6031]
 [ 6869  4379  7609]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.087551
{'0': {'precision': 0.3891719195233572, 'recall': 0.47572303145450706, 'f1-score': 0.4281168368558537, 'support': 18948}, '1': {'precision': 0.38579567525572966, 'recall': 0.3077995867768595, 'f1-score': 0.34241222777682007, 'support': 19360}, '2': {'precision': 0.40168807729058287, 'recall': 0.3953913679590344, 'f1-score': 0.39851485148514854, 'support': 19138}, 'accuracy': 0.3923684851860878, 'macro avg': {'precision': 0.3922185573565566, 'recall': 0.3929713287301337, 'f1-score': 0.3896813053726074, 'support': 57446}, 'weighted avg': {'precision': 0.3922038127505253, 'recall': 0.3923684851860878, 'f1-score': 0.38937151032668466, 'support': 57446}}
[[9014 4691 5243]
 [7373 5959 6028]
 [6775 4796 7567]]
training model: results/PCAR/W6/deepOF_L1/seq2seq
Epoch 1/50
617/617 - 23s - loss: 13.0360 - accuracy10: 0.4065 - accuracy20: 0.3939 - accuracy30: 0.3876 - accuracy50: 0.3903 - val_loss: 13.0805 - val_accuracy10: 0.4149 - val_accuracy20: 0.3885 - val_accuracy30: 0.3745 - val_accuracy50: 0.3615 - 23s/epoch - 38ms/step
Epoch 2/50
617/617 - 17s - loss: 12.9432 - accuracy10: 0.4218 - accuracy20: 0.4060 - accuracy30: 0.3996 - accuracy50: 0.3994 - val_loss: 13.0424 - val_accuracy10: 0.4196 - val_accuracy20: 0.3915 - val_accuracy30: 0.3795 - val_accuracy50: 0.3673 - 17s/epoch - 28ms/step
Epoch 3/50
617/617 - 17s - loss: 12.9102 - accuracy10: 0.4282 - accuracy20: 0.4106 - accuracy30: 0.4019 - accuracy50: 0.4030 - val_loss: 13.0219 - val_accuracy10: 0.4253 - val_accuracy20: 0.3957 - val_accuracy30: 0.3817 - val_accuracy50: 0.3712 - 17s/epoch - 28ms/step
Epoch 4/50
617/617 - 17s - loss: 12.8873 - accuracy10: 0.4306 - accuracy20: 0.4141 - accuracy30: 0.4046 - accuracy50: 0.4035 - val_loss: 13.0034 - val_accuracy10: 0.4277 - val_accuracy20: 0.3976 - val_accuracy30: 0.3831 - val_accuracy50: 0.3708 - 17s/epoch - 27ms/step
Epoch 5/50
617/617 - 17s - loss: 12.8589 - accuracy10: 0.4352 - accuracy20: 0.4164 - accuracy30: 0.4059 - accuracy50: 0.4058 - val_loss: 13.0017 - val_accuracy10: 0.4288 - val_accuracy20: 0.3994 - val_accuracy30: 0.3831 - val_accuracy50: 0.3731 - 17s/epoch - 28ms/step
Epoch 6/50
617/617 - 17s - loss: 12.8415 - accuracy10: 0.4364 - accuracy20: 0.4186 - accuracy30: 0.4088 - accuracy50: 0.4075 - val_loss: 12.9913 - val_accuracy10: 0.4311 - val_accuracy20: 0.4007 - val_accuracy30: 0.3860 - val_accuracy50: 0.3732 - 17s/epoch - 28ms/step
Epoch 7/50
617/617 - 17s - loss: 12.8251 - accuracy10: 0.4378 - accuracy20: 0.4194 - accuracy30: 0.4095 - accuracy50: 0.4073 - val_loss: 12.9844 - val_accuracy10: 0.4298 - val_accuracy20: 0.4010 - val_accuracy30: 0.3862 - val_accuracy50: 0.3737 - 17s/epoch - 28ms/step
Epoch 8/50
617/617 - 17s - loss: 12.8123 - accuracy10: 0.4380 - accuracy20: 0.4205 - accuracy30: 0.4099 - accuracy50: 0.4081 - val_loss: 12.9826 - val_accuracy10: 0.4295 - val_accuracy20: 0.3999 - val_accuracy30: 0.3863 - val_accuracy50: 0.3774 - 17s/epoch - 28ms/step
Epoch 9/50
617/617 - 18s - loss: 12.8000 - accuracy10: 0.4395 - accuracy20: 0.4207 - accuracy30: 0.4111 - accuracy50: 0.4098 - val_loss: 12.9776 - val_accuracy10: 0.4309 - val_accuracy20: 0.4016 - val_accuracy30: 0.3882 - val_accuracy50: 0.3760 - 18s/epoch - 29ms/step
Epoch 10/50
617/617 - 18s - loss: 12.7899 - accuracy10: 0.4403 - accuracy20: 0.4226 - accuracy30: 0.4136 - accuracy50: 0.4112 - val_loss: 12.9745 - val_accuracy10: 0.4306 - val_accuracy20: 0.4017 - val_accuracy30: 0.3872 - val_accuracy50: 0.3775 - 18s/epoch - 29ms/step
Epoch 11/50
617/617 - 17s - loss: 12.7761 - accuracy10: 0.4425 - accuracy20: 0.4242 - accuracy30: 0.4149 - accuracy50: 0.4122 - val_loss: 12.9689 - val_accuracy10: 0.4329 - val_accuracy20: 0.4038 - val_accuracy30: 0.3893 - val_accuracy50: 0.3754 - 17s/epoch - 27ms/step
Epoch 12/50
617/617 - 17s - loss: 12.7653 - accuracy10: 0.4425 - accuracy20: 0.4251 - accuracy30: 0.4147 - accuracy50: 0.4120 - val_loss: 12.9648 - val_accuracy10: 0.4323 - val_accuracy20: 0.4037 - val_accuracy30: 0.3912 - val_accuracy50: 0.3775 - 17s/epoch - 27ms/step
Epoch 13/50
617/617 - 17s - loss: 12.7578 - accuracy10: 0.4444 - accuracy20: 0.4261 - accuracy30: 0.4157 - accuracy50: 0.4130 - val_loss: 12.9589 - val_accuracy10: 0.4357 - val_accuracy20: 0.4055 - val_accuracy30: 0.3899 - val_accuracy50: 0.3769 - 17s/epoch - 27ms/step
Epoch 14/50
617/617 - 17s - loss: 12.7492 - accuracy10: 0.4452 - accuracy20: 0.4278 - accuracy30: 0.4172 - accuracy50: 0.4142 - val_loss: 12.9576 - val_accuracy10: 0.4330 - val_accuracy20: 0.4036 - val_accuracy30: 0.3900 - val_accuracy50: 0.3778 - 17s/epoch - 27ms/step
Epoch 15/50
617/617 - 17s - loss: 12.7436 - accuracy10: 0.4461 - accuracy20: 0.4273 - accuracy30: 0.4183 - accuracy50: 0.4138 - val_loss: 12.9538 - val_accuracy10: 0.4336 - val_accuracy20: 0.4043 - val_accuracy30: 0.3908 - val_accuracy50: 0.3781 - 17s/epoch - 27ms/step
Epoch 16/50
617/617 - 16s - loss: 12.7360 - accuracy10: 0.4460 - accuracy20: 0.4284 - accuracy30: 0.4191 - accuracy50: 0.4143 - val_loss: 12.9550 - val_accuracy10: 0.4341 - val_accuracy20: 0.4068 - val_accuracy30: 0.3901 - val_accuracy50: 0.3763 - 16s/epoch - 27ms/step
Epoch 17/50
617/617 - 16s - loss: 12.7258 - accuracy10: 0.4482 - accuracy20: 0.4290 - accuracy30: 0.4192 - accuracy50: 0.4164 - val_loss: 12.9599 - val_accuracy10: 0.4319 - val_accuracy20: 0.4037 - val_accuracy30: 0.3904 - val_accuracy50: 0.3771 - 16s/epoch - 26ms/step
Epoch 18/50
617/617 - 17s - loss: 12.7195 - accuracy10: 0.4482 - accuracy20: 0.4301 - accuracy30: 0.4197 - accuracy50: 0.4149 - val_loss: 12.9543 - val_accuracy10: 0.4338 - val_accuracy20: 0.4059 - val_accuracy30: 0.3913 - val_accuracy50: 0.3799 - 17s/epoch - 27ms/step
Epoch 19/50
617/617 - 17s - loss: 12.7119 - accuracy10: 0.4481 - accuracy20: 0.4307 - accuracy30: 0.4216 - accuracy50: 0.4178 - val_loss: 12.9556 - val_accuracy10: 0.4335 - val_accuracy20: 0.4063 - val_accuracy30: 0.3920 - val_accuracy50: 0.3791 - 17s/epoch - 27ms/step
Epoch 20/50
617/617 - 17s - loss: 12.7032 - accuracy10: 0.4501 - accuracy20: 0.4315 - accuracy30: 0.4224 - accuracy50: 0.4173 - val_loss: 12.9614 - val_accuracy10: 0.4346 - val_accuracy20: 0.4059 - val_accuracy30: 0.3922 - val_accuracy50: 0.3809 - 17s/epoch - 27ms/step
Epoch 21/50
617/617 - 17s - loss: 12.6960 - accuracy10: 0.4497 - accuracy20: 0.4322 - accuracy30: 0.4230 - accuracy50: 0.4173 - val_loss: 12.9561 - val_accuracy10: 0.4337 - val_accuracy20: 0.4055 - val_accuracy30: 0.3919 - val_accuracy50: 0.3802 - 17s/epoch - 27ms/step
Epoch 22/50
617/617 - 17s - loss: 12.6905 - accuracy10: 0.4513 - accuracy20: 0.4346 - accuracy30: 0.4240 - accuracy50: 0.4181 - val_loss: 12.9668 - val_accuracy10: 0.4331 - val_accuracy20: 0.4057 - val_accuracy30: 0.3916 - val_accuracy50: 0.3777 - 17s/epoch - 27ms/step
Epoch 23/50
617/617 - 17s - loss: 12.6820 - accuracy10: 0.4516 - accuracy20: 0.4346 - accuracy30: 0.4240 - accuracy50: 0.4189 - val_loss: 12.9626 - val_accuracy10: 0.4341 - val_accuracy20: 0.4053 - val_accuracy30: 0.3926 - val_accuracy50: 0.3799 - 17s/epoch - 27ms/step
Epoch 24/50
617/617 - 16s - loss: 12.6704 - accuracy10: 0.4543 - accuracy20: 0.4366 - accuracy30: 0.4257 - accuracy50: 0.4201 - val_loss: 12.9683 - val_accuracy10: 0.4346 - val_accuracy20: 0.4054 - val_accuracy30: 0.3908 - val_accuracy50: 0.3794 - 16s/epoch - 26ms/step
Epoch 25/50
617/617 - 16s - loss: 12.6646 - accuracy10: 0.4556 - accuracy20: 0.4378 - accuracy30: 0.4274 - accuracy50: 0.4213 - val_loss: 12.9764 - val_accuracy10: 0.4327 - val_accuracy20: 0.4053 - val_accuracy30: 0.3903 - val_accuracy50: 0.3782 - 16s/epoch - 27ms/step
testing model: results/PCAR/W6/deepOF_L1/seq2seq
Evaluating performance on  test set...
1722/1722 - 23s - 23s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1211829
{'0': {'precision': 0.4510397076044143, 'recall': 0.3163235467955777, 'f1-score': 0.37185642975992395, 'support': 160731}, '1': {'precision': 0.29330698382477577, 'recall': 0.6296519849618873, 'f1-score': 0.4001940082152066, 'support': 115972}, '2': {'precision': 0.4811715481171548, 'recall': 0.23197494073410485, 'f1-score': 0.3130345394736842, 'support': 164091}, 'accuracy': 0.367359809797774, 'macro avg': {'precision': 0.4085060798487816, 'recall': 0.39265015749718996, 'f1-score': 0.36169499248293824, 'support': 440794}, 'weighted avg': {'precision': 0.4207574995875263, 'recall': 0.367359809797774, 'f1-score': 0.35741481496856264, 'support': 440794}}
[[50843 85434 24454]
 [26360 73022 16590]
 [35521 90505 38065]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1144788
{'0': {'precision': 0.4421425859966239, 'recall': 0.3387603806977809, 'f1-score': 0.3836082001044109, 'support': 161598}, '1': {'precision': 0.2664307771487391, 'recall': 0.5446964847825896, 'f1-score': 0.3578326473832613, 'support': 114047}, '2': {'precision': 0.46960785483351425, 'recall': 0.2383484005352742, 'f1-score': 0.31620677190022894, 'support': 165149}, 'accuracy': 0.35442179340009167, 'macro avg': {'precision': 0.39272707265962575, 'recall': 0.3739350886718816, 'f1-score': 0.3525492064626337, 'support': 440794}, 'weighted avg': {'precision': 0.4069707302532809, 'recall': 0.35442179340009167, 'f1-score': 0.3516864794646531, 'support': 440794}}
[[54743 82506 24349]
 [31817 62121 20109]
 [37253 88533 39363]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1026715
{'0': {'precision': 0.42986220917099616, 'recall': 0.3732482142066269, 'f1-score': 0.3995597548172983, 'support': 158053}, '1': {'precision': 0.2751444318381414, 'recall': 0.47500020488276606, 'f1-score': 0.3484492325820473, 'support': 122021}, '2': {'precision': 0.45704167743046586, 'recall': 0.2641923842707815, 'f1-score': 0.33483424281613733, 'support': 160720}, 'accuracy': 0.3616519281115442, 'macro avg': {'precision': 0.38734943947986783, 'recall': 0.3708136011200582, 'f1-score': 0.36094774340516095, 'support': 440794}, 'weighted avg': {'precision': 0.39694312731128323, 'recall': 0.3616519281115442, 'f1-score': 0.3618114158596579, 'support': 440794}}
[[58993 74010 25050]
 [38668 57960 25393]
 [39576 78683 42461]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0993958
{'0': {'precision': 0.40859305253900785, 'recall': 0.39728574204832545, 'f1-score': 0.4028600706806626, 'support': 154370}, '1': {'precision': 0.2895282459281349, 'recall': 0.4105975597521165, 'f1-score': 0.33959494220298847, 'support': 129577}, '2': {'precision': 0.43841586010193107, 'recall': 0.2989027523637685, 'f1-score': 0.35546019061194467, 'support': 156847}, 'accuracy': 0.36619146358616494, 'macro avg': {'precision': 0.3788457195230246, 'recall': 0.3689286847214035, 'f1-score': 0.365971734498532, 'support': 440794}, 'weighted avg': {'precision': 0.3842042392874771, 'recall': 0.36619146358616494, 'f1-score': 0.36739626096027217, 'support': 440794}}
[[61329 64237 28804]
 [45124 53204 31249]
 [43645 66320 46882]]
Evaluating performance on  train set...
617/617 - 8s - 8s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0625561
{'0': {'precision': 0.4690394455599456, 'recall': 0.2793734688759862, 'f1-score': 0.35017347888635025, 'support': 51841}, '1': {'precision': 0.4184800450218074, 'recall': 0.6653059702883558, 'f1-score': 0.5137864273324648, 'support': 53649}, '2': {'precision': 0.4508400746733043, 'recall': 0.35905989096870117, 'f1-score': 0.3997495861805526, 'support': 52462}, 'accuracy': 0.43692387560777957, 'macro avg': {'precision': 0.4461198550850191, 'recall': 0.43457977671101444, 'f1-score': 0.4212364974664559, 'support': 157952}, 'weighted avg': {'precision': 0.4458220334668695, 'recall': 0.43692387560777957, 'f1-score': 0.4222113942787103, 'support': 157952}}
[[14483 24795 12563]
 [ 7574 35693 10382]
 [ 8821 24804 18837]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0739821
{'0': {'precision': 0.45880583923313073, 'recall': 0.2783511032556018, 'f1-score': 0.3464909686653497, 'support': 52617}, '1': {'precision': 0.38485781205930325, 'recall': 0.5961100136757331, 'f1-score': 0.4677372480345765, 'support': 52648}, '2': {'precision': 0.4343681855989929, 'recall': 0.36673183138155524, 'f1-score': 0.3976947617577442, 'support': 52687}, 'accuracy': 0.4137459481361426, 'macro avg': {'precision': 0.4260106122971423, 'recall': 0.41373098277096343, 'f1-score': 0.4039743261525568, 'support': 157952}, 'weighted avg': {'precision': 0.42600623940742743, 'recall': 0.4137459481361426, 'f1-score': 0.4039840574701134, 'support': 157952}}
[[14646 25277 12694]
 [ 8797 31384 12467]
 [ 8479 24886 19322]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0772492
{'0': {'precision': 0.44707659767336455, 'recall': 0.2805194805194805, 'f1-score': 0.3447343895619758, 'support': 52745}, '1': {'precision': 0.36922957056967365, 'recall': 0.5439519445985499, 'f1-score': 0.4398756207360653, 'support': 52273}, '2': {'precision': 0.42595301788998496, 'recall': 0.3850266369441191, 'f1-score': 0.4044571451251216, 'support': 52934}, 'accuracy': 0.40272361223662884, 'macro avg': {'precision': 0.41408639537767433, 'recall': 0.4031660206873832, 'f1-score': 0.39635571847438755, 'support': 157952}, 'weighted avg': {'precision': 0.4142346379638031, 'recall': 0.40272361223662884, 'f1-score': 0.3962353640361372, 'support': 157952}}
[[14796 24654 13295]
 [ 9667 28434 14172]
 [ 8632 23921 20381]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0818081
{'0': {'precision': 0.42780846583452864, 'recall': 0.26704512982683404, 'f1-score': 0.3288294628196106, 'support': 52493}, '1': {'precision': 0.3597752504738695, 'recall': 0.5039063981492017, 'f1-score': 0.4198145251749688, 'support': 52734}, '2': {'precision': 0.4107549926936191, 'recall': 0.39984826932195355, 'f1-score': 0.40522825564632386, 'support': 52725}, 'accuracy': 0.390454061993517, 'macro avg': {'precision': 0.3994462363340057, 'recall': 0.39026659909932976, 'f1-score': 0.3846240812136344, 'support': 157952}, 'weighted avg': {'precision': 0.39940231744651544, 'recall': 0.390454061993517, 'f1-score': 0.38470803751341576, 'support': 157952}}
[[14018 24219 14256]
 [10174 26573 15987]
 [ 8575 23068 21082]]
Evaluating performance on  val set...
225/225 - 3s - 3s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0648677
{'0': {'precision': 0.44030732860520094, 'recall': 0.2810260279139947, 'f1-score': 0.3430808197098779, 'support': 18557}, '1': {'precision': 0.4359609824293839, 'recall': 0.6568528890803772, 'f1-score': 0.5240823497956534, 'support': 20889}, '2': {'precision': 0.417044167610419, 'recall': 0.3273515195288627, 'f1-score': 0.36679428518068913, 'support': 17999}, 'accuracy': 0.43220471755592305, 'macro avg': {'precision': 0.43110415954833464, 'recall': 0.42174347884107827, 'f1-score': 0.4113191515620735, 'support': 57445}, 'weighted avg': {'precision': 0.4314378976710601, 'recall': 0.43220471755592305, 'f1-score': 0.4163293117800475, 'support': 57445}}
[[ 5215  9054  4288]
 [ 3220 13721  3948]
 [ 3409  8698  5892]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0795338
{'0': {'precision': 0.4261432618373128, 'recall': 0.27802714263082856, 'f1-score': 0.33650773360603353, 'support': 18937}, '1': {'precision': 0.39203451709259873, 'recall': 0.5929718875502008, 'f1-score': 0.472007992007992, 'support': 19920}, '2': {'precision': 0.4144385026737968, 'recall': 0.333548525930708, 'f1-score': 0.36961964945749376, 'support': 18588}, 'accuracy': 0.40520497867525457, 'macro avg': {'precision': 0.41087209386790285, 'recall': 0.40151585203724577, 'f1-score': 0.39271179169050646, 'support': 57445}, 'weighted avg': {'precision': 0.41052807759767246, 'recall': 0.40520497867525457, 'f1-score': 0.3942090033286196, 'support': 57445}}
[[ 5265  9385  4287]
 [ 3635 11812  4473]
 [ 3455  8933  6200]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0839187
{'0': {'precision': 0.42280648119841024, 'recall': 0.2891641837854791, 'f1-score': 0.34344249573180197, 'support': 19131}, '1': {'precision': 0.36704119850187267, 'recall': 0.5326633165829145, 'f1-score': 0.4346079825955987, 'support': 19502}, '2': {'precision': 0.40718600161902985, 'recall': 0.34759727833297893, 'f1-score': 0.37503943104585474, 'support': 18812}, 'accuracy': 0.3909652711289059, 'macro avg': {'precision': 0.3990112271064376, 'recall': 0.38980825956712417, 'f1-score': 0.38436330312441847, 'support': 57445}, 'weighted avg': {'precision': 0.39875935777609006, 'recall': 0.3909652711289059, 'f1-score': 0.3847395776701034, 'support': 57445}}
[[ 5532  9178  4421]
 [ 4015 10388  5099]
 [ 3537  8736  6539]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0883396
{'0': {'precision': 0.40906007386749077, 'recall': 0.28665751109233045, 'f1-score': 0.3370912140128576, 'support': 18932}, '1': {'precision': 0.35056548841028706, 'recall': 0.48489854922814807, 'f1-score': 0.40693240901213173, 'support': 19369}, '2': {'precision': 0.40208201529878645, 'recall': 0.36517969076473045, 'f1-score': 0.3827434233938299, 'support': 19144}, 'accuracy': 0.3796675080511794, 'macro avg': {'precision': 0.3872358591921881, 'recall': 0.378911917028403, 'f1-score': 0.3755890154729397, 'support': 57445}, 'weighted avg': {'precision': 0.3870116870808278, 'recall': 0.3796675080511794, 'f1-score': 0.375853856581058, 'support': 57445}}
[[5427 8839 4666]
 [4247 9392 5730]
 [3593 8560 6991]]
training model: results/PCAR/W6/deepLOB_L2/seq2seq
Epoch 1/50
618/618 - 39s - loss: 13.1069 - accuracy10: 0.3853 - accuracy20: 0.3817 - accuracy30: 0.3812 - accuracy50: 0.3914 - val_loss: 13.1974 - val_accuracy10: 0.3693 - val_accuracy20: 0.3660 - val_accuracy30: 0.3628 - val_accuracy50: 0.3578 - 39s/epoch - 63ms/step
Epoch 2/50
618/618 - 33s - loss: 12.9099 - accuracy10: 0.4191 - accuracy20: 0.4110 - accuracy30: 0.4051 - accuracy50: 0.4065 - val_loss: 13.1197 - val_accuracy10: 0.3829 - val_accuracy20: 0.3775 - val_accuracy30: 0.3733 - val_accuracy50: 0.3646 - 33s/epoch - 53ms/step
Epoch 3/50
618/618 - 33s - loss: 12.8328 - accuracy10: 0.4337 - accuracy20: 0.4219 - accuracy30: 0.4137 - accuracy50: 0.4146 - val_loss: 13.1435 - val_accuracy10: 0.3934 - val_accuracy20: 0.3903 - val_accuracy30: 0.3867 - val_accuracy50: 0.3746 - 33s/epoch - 53ms/step
Epoch 4/50
618/618 - 33s - loss: 12.7808 - accuracy10: 0.4431 - accuracy20: 0.4296 - accuracy30: 0.4204 - accuracy50: 0.4192 - val_loss: 13.0935 - val_accuracy10: 0.4089 - val_accuracy20: 0.4055 - val_accuracy30: 0.4008 - val_accuracy50: 0.3877 - 33s/epoch - 54ms/step
Epoch 5/50
618/618 - 33s - loss: 12.7326 - accuracy10: 0.4520 - accuracy20: 0.4359 - accuracy30: 0.4246 - accuracy50: 0.4233 - val_loss: 13.0702 - val_accuracy10: 0.4138 - val_accuracy20: 0.4086 - val_accuracy30: 0.4016 - val_accuracy50: 0.3901 - 33s/epoch - 53ms/step
Epoch 6/50
618/618 - 33s - loss: 12.6907 - accuracy10: 0.4582 - accuracy20: 0.4404 - accuracy30: 0.4273 - accuracy50: 0.4272 - val_loss: 13.0370 - val_accuracy10: 0.4164 - val_accuracy20: 0.4110 - val_accuracy30: 0.4021 - val_accuracy50: 0.3868 - 33s/epoch - 53ms/step
Epoch 7/50
618/618 - 33s - loss: 12.6544 - accuracy10: 0.4645 - accuracy20: 0.4434 - accuracy30: 0.4311 - accuracy50: 0.4306 - val_loss: 13.0243 - val_accuracy10: 0.4188 - val_accuracy20: 0.4115 - val_accuracy30: 0.4031 - val_accuracy50: 0.3898 - 33s/epoch - 53ms/step
Epoch 8/50
618/618 - 33s - loss: 12.6238 - accuracy10: 0.4680 - accuracy20: 0.4466 - accuracy30: 0.4342 - accuracy50: 0.4335 - val_loss: 13.1437 - val_accuracy10: 0.4156 - val_accuracy20: 0.4088 - val_accuracy30: 0.3997 - val_accuracy50: 0.3831 - 33s/epoch - 54ms/step
Epoch 9/50
618/618 - 32s - loss: 12.5924 - accuracy10: 0.4700 - accuracy20: 0.4491 - accuracy30: 0.4352 - accuracy50: 0.4347 - val_loss: 13.0557 - val_accuracy10: 0.4200 - val_accuracy20: 0.4095 - val_accuracy30: 0.3996 - val_accuracy50: 0.3836 - 32s/epoch - 53ms/step
Epoch 10/50
618/618 - 32s - loss: 12.5685 - accuracy10: 0.4721 - accuracy20: 0.4509 - accuracy30: 0.4373 - accuracy50: 0.4371 - val_loss: 13.0316 - val_accuracy10: 0.4223 - val_accuracy20: 0.4133 - val_accuracy30: 0.4041 - val_accuracy50: 0.3862 - 32s/epoch - 52ms/step
Epoch 11/50
618/618 - 33s - loss: 12.5352 - accuracy10: 0.4748 - accuracy20: 0.4546 - accuracy30: 0.4397 - accuracy50: 0.4399 - val_loss: 13.0907 - val_accuracy10: 0.4198 - val_accuracy20: 0.4109 - val_accuracy30: 0.4000 - val_accuracy50: 0.3857 - 33s/epoch - 53ms/step
Epoch 12/50
618/618 - 33s - loss: 12.5020 - accuracy10: 0.4770 - accuracy20: 0.4561 - accuracy30: 0.4422 - accuracy50: 0.4433 - val_loss: 13.0766 - val_accuracy10: 0.4212 - val_accuracy20: 0.4112 - val_accuracy30: 0.4023 - val_accuracy50: 0.3851 - 33s/epoch - 53ms/step
Epoch 13/50
618/618 - 33s - loss: 12.4719 - accuracy10: 0.4795 - accuracy20: 0.4580 - accuracy30: 0.4447 - accuracy50: 0.4449 - val_loss: 13.0691 - val_accuracy10: 0.4217 - val_accuracy20: 0.4125 - val_accuracy30: 0.4046 - val_accuracy50: 0.3911 - 33s/epoch - 54ms/step
Epoch 14/50
618/618 - 33s - loss: 12.4506 - accuracy10: 0.4824 - accuracy20: 0.4626 - accuracy30: 0.4474 - accuracy50: 0.4472 - val_loss: 13.0545 - val_accuracy10: 0.4250 - val_accuracy20: 0.4152 - val_accuracy30: 0.4034 - val_accuracy50: 0.3915 - 33s/epoch - 53ms/step
Epoch 15/50
618/618 - 32s - loss: 12.4266 - accuracy10: 0.4847 - accuracy20: 0.4635 - accuracy30: 0.4487 - accuracy50: 0.4494 - val_loss: 13.0368 - val_accuracy10: 0.4275 - val_accuracy20: 0.4151 - val_accuracy30: 0.4037 - val_accuracy50: 0.3921 - 32s/epoch - 53ms/step
Epoch 16/50
618/618 - 32s - loss: 12.3975 - accuracy10: 0.4867 - accuracy20: 0.4651 - accuracy30: 0.4498 - accuracy50: 0.4502 - val_loss: 13.0857 - val_accuracy10: 0.4255 - val_accuracy20: 0.4113 - val_accuracy30: 0.4013 - val_accuracy50: 0.3883 - 32s/epoch - 53ms/step
Epoch 17/50
618/618 - 33s - loss: 12.3730 - accuracy10: 0.4887 - accuracy20: 0.4697 - accuracy30: 0.4537 - accuracy50: 0.4536 - val_loss: 13.0688 - val_accuracy10: 0.4213 - val_accuracy20: 0.4119 - val_accuracy30: 0.4042 - val_accuracy50: 0.3896 - 33s/epoch - 53ms/step
testing model: results/PCAR/W6/deepLOB_L2/seq2seq
Evaluating performance on  test set...
1722/1722 - 35s - 35s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0726699
{'0': {'precision': 0.4326031664810523, 'recall': 0.7153415913346979, 'f1-score': 0.5391531873289928, 'support': 160733}, '1': {'precision': 0.37168008092926674, 'recall': 0.3611616496943254, 'f1-score': 0.36634538012105095, 'support': 115973}, '2': {'precision': 0.523602464540145, 'recall': 0.19886893408006434, 'f1-score': 0.288255740514184, 'support': 164093}, 'accuracy': 0.4298943509399976, 'macro avg': {'precision': 0.4426285706501547, 'recall': 0.42512405836969586, 'f1-score': 0.39791810265474253, 'support': 440799}, 'weighted avg': {'precision': 0.4504501099081324, 'recall': 0.4298943509399976, 'f1-score': 0.400288184083729, 'support': 440799}}
[[114979  30361  15393]
 [ 59790  41885  14298]
 [ 91015  40445  32633]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0782528
{'0': {'precision': 0.4215611669239831, 'recall': 0.7130383663366336, 'f1-score': 0.5298597028514671, 'support': 161600}, '1': {'precision': 0.34217150528612184, 'recall': 0.2860549943883277, 'f1-score': 0.3116069381829296, 'support': 114048}, '2': {'precision': 0.4967485198485878, 'recall': 0.21692875005298182, 'f1-score': 0.3019825348123672, 'support': 165151}, 'accuracy': 0.41669105419930624, 'macro avg': {'precision': 0.4201603973528976, 'recall': 0.40534070359264773, 'f1-score': 0.38114972528225466, 'support': 440799}, 'weighted avg': {'precision': 0.42919057259953275, 'recall': 0.41669105419930624, 'f1-score': 0.38801402379198024, 'support': 440799}}
[[115227  27699  18674]
 [ 63803  32624  17621]
 [ 94304  35021  35826]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0805265
{'0': {'precision': 0.40467905344932514, 'recall': 0.7151877510993009, 'f1-score': 0.5168855813528127, 'support': 158055}, '1': {'precision': 0.3513643701504973, 'recall': 0.22118323895067243, 'f1-score': 0.2714740510880991, 'support': 122021}, '2': {'precision': 0.46600989876796955, 'recall': 0.24545957952502132, 'f1-score': 0.32155024859401743, 'support': 160723}, 'accuracy': 0.40716743912758424, 'macro avg': {'precision': 0.40735110745593067, 'recall': 0.39394352319166487, 'f1-score': 0.3699699603449764, 'support': 440799}, 'weighted avg': {'precision': 0.4122828966552812, 'recall': 0.40716743912758424, 'f1-score': 0.37772863902439896, 'support': 440799}}
[[113039  22639  22377]
 [ 72203  26989  22829]
 [ 94088  27184  39451]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0863166
{'0': {'precision': 0.3877067971554208, 'recall': 0.708800818801337, 'f1-score': 0.5012402855748946, 'support': 154372}, '1': {'precision': 0.3672792500084611, 'recall': 0.1674988616806995, 'f1-score': 0.23007245416624708, 'support': 129577}, '2': {'precision': 0.4244200072373447, 'recall': 0.2691934969716289, 'f1-score': 0.3294373746752284, 'support': 156850}, 'accuracy': 0.39325406818073544, 'macro avg': {'precision': 0.3931353514670755, 'recall': 0.3818310591512218, 'f1-score': 0.35358337147212343, 'support': 440799}, 'weighted avg': {'precision': 0.3947656306026114, 'recall': 0.39325406818073544, 'f1-score': 0.36039513695828934, 'support': 440799}}
[[109419  17717  27236]
 [ 77848  21704  30025]
 [ 94954  19673  42223]]
Evaluating performance on  train set...
618/618 - 13s - 13s/epoch - 22ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.06308
{'0': {'precision': 0.4257650115473441, 'recall': 0.5702217324904792, 'f1-score': 0.48751745737920316, 'support': 51729}, '1': {'precision': 0.49427910748070514, 'recall': 0.30700216369469524, 'f1-score': 0.37875527838823625, 'support': 53612}, '2': {'precision': 0.42491060786650775, 'recall': 0.4472173648597278, 'f1-score': 0.4357787120552664, 'support': 52612}, 'accuracy': 0.4399093401201623, 'macro avg': {'precision': 0.4483182422981857, 'recall': 0.44148042034830076, 'f1-score': 0.43401714927423524, 'support': 157953}, 'weighted avg': {'precision': 0.44873529906782916, 'recall': 0.4399093401201623, 'f1-score': 0.4333682053292473, 'support': 157953}}
[[29497  7726 14506]
 [19814 16459 17339]
 [19969  9114 23529]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0726336
{'0': {'precision': 0.41748618189648984, 'recall': 0.5534619923109132, 'f1-score': 0.47595276479782644, 'support': 52542}, '1': {'precision': 0.46457506751575367, 'recall': 0.26496539134403285, 'f1-score': 0.3374626124653371, 'support': 52588}, '2': {'precision': 0.41200583140382474, 'recall': 0.454764023247449, 'f1-score': 0.43233028579655897, 'support': 52823}, 'accuracy': 0.4244047279887055, 'macro avg': {'precision': 0.431355693605356, 'recall': 0.4243971356341317, 'f1-score': 0.4152485543532409, 'support': 157953}, 'weighted avg': {'precision': 0.4313309443440015, 'recall': 0.4244047279887055, 'f1-score': 0.41525628964923855, 'support': 157953}}
[[29080  7540 15922]
 [20293 13934 18361]
 [20282  8519 24022]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0788984
{'0': {'precision': 0.4052118212257971, 'recall': 0.5291634980988593, 'f1-score': 0.4589661142715805, 'support': 52600}, '1': {'precision': 0.45374531835205995, 'recall': 0.2314629067079345, 'f1-score': 0.30654976531167366, 'support': 52341}, '2': {'precision': 0.40405671083547784, 'recall': 0.4768542971402701, 'f1-score': 0.4374475448842743, 'support': 53012}, 'accuracy': 0.41295828505947973, 'macro avg': {'precision': 0.42100461680444495, 'recall': 0.412493567315688, 'f1-score': 0.40098780815584284, 'support': 157953}, 'weighted avg': {'precision': 0.42090672452661515, 'recall': 0.41295828505947973, 'f1-score': 0.40123776139907813, 'support': 157953}}
[[27834  7004 17762]
 [20704 12115 19522]
 [20152  7581 25279]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.08103
{'0': {'precision': 0.38629311373672276, 'recall': 0.49344462230352926, 'f1-score': 0.43334337450212534, 'support': 52476}, '1': {'precision': 0.4634001610647226, 'recall': 0.20764643318392464, 'f1-score': 0.2867860187553283, 'support': 52652}, '2': {'precision': 0.39646209600760457, 'recall': 0.505309985802177, 'f1-score': 0.4443168293758791, 'support': 52825}, 'accuracy': 0.40214494184979077, 'macro avg': {'precision': 0.41538512360301666, 'recall': 0.40213368042987696, 'f1-score': 0.38814874087777756, 'support': 157953}, 'weighted avg': {'precision': 0.41539681385241023, 'recall': 0.40214494184979077, 'f1-score': 0.38815990131026246, 'support': 157953}}
[[25894  6196 20386]
 [21470 10933 20249]
 [19668  6464 26693]]
Evaluating performance on  val set...
225/225 - 5s - 5s/epoch - 22ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0811627
{'0': {'precision': 0.410058384450521, 'recall': 0.5989313471502591, 'f1-score': 0.4868172844922132, 'support': 18528}, '1': {'precision': 0.49342969776609724, 'recall': 0.2520013422175351, 'f1-score': 0.33361891162938284, 'support': 20861}, '2': {'precision': 0.39351241763811456, 'recall': 0.4299717561056654, 'f1-score': 0.410934977637812, 'support': 18057}, 'accuracy': 0.4198377606795948, 'macro avg': {'precision': 0.4323334999515776, 'recall': 0.42696814849115317, 'f1-score': 0.41045705791980264, 'support': 57446}, 'weighted avg': {'precision': 0.4351330361990259, 'recall': 0.4198377606795948, 'f1-score': 0.40733258457992294, 'support': 57446}}
[[11097  2558  4873]
 [ 8511  5257  7093]
 [ 7454  2839  7764]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0826278
{'0': {'precision': 0.4098520687842607, 'recall': 0.5746472941671931, 'f1-score': 0.4784571553802323, 'support': 18996}, '1': {'precision': 0.45881884274474655, 'recall': 0.23193878064743492, 'f1-score': 0.30811931514178703, 'support': 19863}, '2': {'precision': 0.3951663376823456, 'recall': 0.4415989670199602, 'f1-score': 0.4170943645510443, 'support': 18587}, 'accuracy': 0.413100999199248, 'macro avg': {'precision': 0.4212790830704509, 'recall': 0.41606168061152937, 'f1-score': 0.4012236116910212, 'support': 57446}, 'weighted avg': {'precision': 0.42203156513188866, 'recall': 0.413100999199248, 'f1-score': 0.39970544570856925, 'support': 57446}}
[[10916  2639  5441]
 [ 8134  4607  7122]
 [ 7584  2795  8208]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0854989
{'0': {'precision': 0.40548145863850127, 'recall': 0.5499843145456447, 'f1-score': 0.46680571580722463, 'support': 19126}, '1': {'precision': 0.4328310696095076, 'recall': 0.20957714638031136, 'f1-score': 0.28241077301208156, 'support': 19463}, '2': {'precision': 0.3909873188405797, 'recall': 0.4578140743490481, 'f1-score': 0.42177003688594666, 'support': 18857}, 'accuracy': 0.4043971729972496, 'macro avg': {'precision': 0.40976661569619616, 'recall': 0.405791845091668, 'f1-score': 0.390328841901751, 'support': 57446}, 'weighted avg': {'precision': 0.40998985755503664, 'recall': 0.4043971729972496, 'f1-score': 0.3895485252449503, 'support': 57446}}
[[10519  2572  6035]
 [ 7972  4079  7412]
 [ 7451  2773  8633]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0907878
{'0': {'precision': 0.38303918037379436, 'recall': 0.5051192738019844, 'f1-score': 0.4356890861499943, 'support': 18948}, '1': {'precision': 0.4220706618962433, 'recall': 0.1949896694214876, 'f1-score': 0.2667467495760316, 'support': 19360}, '2': {'precision': 0.3855836699978737, 'recall': 0.4737694638938238, 'f1-score': 0.4251518064379996, 'support': 19138}, 'accuracy': 0.3901577133307802, 'macro avg': {'precision': 0.3968978374226371, 'recall': 0.39129280237243186, 'f1-score': 0.37586254738800845, 'support': 57446}, 'weighted avg': {'precision': 0.39704095464354755, 'recall': 0.3901577133307802, 'f1-score': 0.3752429959922797, 'support': 57446}}
[[9571 2466 6911]
 [8048 3775 7537]
 [7368 2703 9067]]
training model: results/PCAR/W6/deepOF_L2/seq2seq
Epoch 1/50
617/617 - 28s - loss: 13.0142 - accuracy10: 0.4099 - accuracy20: 0.3943 - accuracy30: 0.3864 - accuracy50: 0.3865 - val_loss: 12.9666 - val_accuracy10: 0.4348 - val_accuracy20: 0.4054 - val_accuracy30: 0.3912 - val_accuracy50: 0.3745 - 28s/epoch - 46ms/step
Epoch 2/50
617/617 - 22s - loss: 12.7954 - accuracy10: 0.4500 - accuracy20: 0.4234 - accuracy30: 0.4111 - accuracy50: 0.4076 - val_loss: 12.8524 - val_accuracy10: 0.4511 - val_accuracy20: 0.4190 - val_accuracy30: 0.4040 - val_accuracy50: 0.3869 - 22s/epoch - 35ms/step
Epoch 3/50
617/617 - 22s - loss: 12.6944 - accuracy10: 0.4641 - accuracy20: 0.4359 - accuracy30: 0.4201 - accuracy50: 0.4137 - val_loss: 12.7987 - val_accuracy10: 0.4613 - val_accuracy20: 0.4269 - val_accuracy30: 0.4083 - val_accuracy50: 0.3907 - 22s/epoch - 35ms/step
Epoch 4/50
617/617 - 22s - loss: 12.6281 - accuracy10: 0.4726 - accuracy20: 0.4423 - accuracy30: 0.4253 - accuracy50: 0.4198 - val_loss: 12.7542 - val_accuracy10: 0.4675 - val_accuracy20: 0.4312 - val_accuracy30: 0.4127 - val_accuracy50: 0.3957 - 22s/epoch - 35ms/step
Epoch 5/50
617/617 - 21s - loss: 12.5834 - accuracy10: 0.4775 - accuracy20: 0.4474 - accuracy30: 0.4296 - accuracy50: 0.4237 - val_loss: 12.7187 - val_accuracy10: 0.4702 - val_accuracy20: 0.4353 - val_accuracy30: 0.4162 - val_accuracy50: 0.3978 - 21s/epoch - 34ms/step
Epoch 6/50
617/617 - 21s - loss: 12.5415 - accuracy10: 0.4802 - accuracy20: 0.4508 - accuracy30: 0.4334 - accuracy50: 0.4259 - val_loss: 12.7089 - val_accuracy10: 0.4702 - val_accuracy20: 0.4360 - val_accuracy30: 0.4154 - val_accuracy50: 0.3994 - 21s/epoch - 34ms/step
Epoch 7/50
617/617 - 22s - loss: 12.5006 - accuracy10: 0.4854 - accuracy20: 0.4555 - accuracy30: 0.4378 - accuracy50: 0.4286 - val_loss: 12.6855 - val_accuracy10: 0.4729 - val_accuracy20: 0.4396 - val_accuracy30: 0.4192 - val_accuracy50: 0.3990 - 22s/epoch - 35ms/step
Epoch 8/50
617/617 - 21s - loss: 12.4629 - accuracy10: 0.4895 - accuracy20: 0.4594 - accuracy30: 0.4415 - accuracy50: 0.4318 - val_loss: 12.6849 - val_accuracy10: 0.4728 - val_accuracy20: 0.4416 - val_accuracy30: 0.4192 - val_accuracy50: 0.4005 - 21s/epoch - 35ms/step
Epoch 9/50
617/617 - 21s - loss: 12.4242 - accuracy10: 0.4928 - accuracy20: 0.4636 - accuracy30: 0.4463 - accuracy50: 0.4358 - val_loss: 12.7051 - val_accuracy10: 0.4707 - val_accuracy20: 0.4377 - val_accuracy30: 0.4196 - val_accuracy50: 0.4012 - 21s/epoch - 34ms/step
Epoch 10/50
617/617 - 21s - loss: 12.3937 - accuracy10: 0.4952 - accuracy20: 0.4667 - accuracy30: 0.4498 - accuracy50: 0.4394 - val_loss: 12.6770 - val_accuracy10: 0.4742 - val_accuracy20: 0.4418 - val_accuracy30: 0.4237 - val_accuracy50: 0.4039 - 21s/epoch - 34ms/step
Epoch 11/50
617/617 - 21s - loss: 12.3591 - accuracy10: 0.4980 - accuracy20: 0.4691 - accuracy30: 0.4537 - accuracy50: 0.4431 - val_loss: 12.6718 - val_accuracy10: 0.4727 - val_accuracy20: 0.4434 - val_accuracy30: 0.4228 - val_accuracy50: 0.4048 - 21s/epoch - 34ms/step
Epoch 12/50
617/617 - 21s - loss: 12.3248 - accuracy10: 0.5007 - accuracy20: 0.4731 - accuracy30: 0.4570 - accuracy50: 0.4467 - val_loss: 12.6836 - val_accuracy10: 0.4725 - val_accuracy20: 0.4395 - val_accuracy30: 0.4233 - val_accuracy50: 0.4039 - 21s/epoch - 34ms/step
Epoch 13/50
617/617 - 22s - loss: 12.2964 - accuracy10: 0.5033 - accuracy20: 0.4769 - accuracy30: 0.4606 - accuracy50: 0.4486 - val_loss: 12.6632 - val_accuracy10: 0.4728 - val_accuracy20: 0.4423 - val_accuracy30: 0.4229 - val_accuracy50: 0.4039 - 22s/epoch - 35ms/step
Epoch 14/50
617/617 - 21s - loss: 12.2668 - accuracy10: 0.5054 - accuracy20: 0.4793 - accuracy30: 0.4650 - accuracy50: 0.4516 - val_loss: 12.6858 - val_accuracy10: 0.4719 - val_accuracy20: 0.4397 - val_accuracy30: 0.4210 - val_accuracy50: 0.4017 - 21s/epoch - 34ms/step
Epoch 15/50
617/617 - 21s - loss: 12.2380 - accuracy10: 0.5067 - accuracy20: 0.4820 - accuracy30: 0.4669 - accuracy50: 0.4542 - val_loss: 12.6885 - val_accuracy10: 0.4715 - val_accuracy20: 0.4412 - val_accuracy30: 0.4215 - val_accuracy50: 0.4008 - 21s/epoch - 34ms/step
Epoch 16/50
617/617 - 21s - loss: 12.2065 - accuracy10: 0.5099 - accuracy20: 0.4845 - accuracy30: 0.4697 - accuracy50: 0.4573 - val_loss: 12.6957 - val_accuracy10: 0.4738 - val_accuracy20: 0.4406 - val_accuracy30: 0.4218 - val_accuracy50: 0.4008 - 21s/epoch - 34ms/step
Epoch 17/50
617/617 - 21s - loss: 12.1728 - accuracy10: 0.5117 - accuracy20: 0.4888 - accuracy30: 0.4741 - accuracy50: 0.4622 - val_loss: 12.7057 - val_accuracy10: 0.4706 - val_accuracy20: 0.4396 - val_accuracy30: 0.4220 - val_accuracy50: 0.4015 - 21s/epoch - 35ms/step
Epoch 18/50
617/617 - 21s - loss: 12.1474 - accuracy10: 0.5124 - accuracy20: 0.4898 - accuracy30: 0.4762 - accuracy50: 0.4660 - val_loss: 12.7152 - val_accuracy10: 0.4742 - val_accuracy20: 0.4405 - val_accuracy30: 0.4219 - val_accuracy50: 0.4001 - 21s/epoch - 34ms/step
Epoch 19/50
617/617 - 21s - loss: 12.1101 - accuracy10: 0.5139 - accuracy20: 0.4938 - accuracy30: 0.4809 - accuracy50: 0.4687 - val_loss: 12.7537 - val_accuracy10: 0.4698 - val_accuracy20: 0.4379 - val_accuracy30: 0.4186 - val_accuracy50: 0.3993 - 21s/epoch - 34ms/step
Epoch 20/50
617/617 - 21s - loss: 12.0805 - accuracy10: 0.5155 - accuracy20: 0.4957 - accuracy30: 0.4831 - accuracy50: 0.4726 - val_loss: 12.7397 - val_accuracy10: 0.4704 - val_accuracy20: 0.4382 - val_accuracy30: 0.4209 - val_accuracy50: 0.4009 - 21s/epoch - 35ms/step
Epoch 21/50
617/617 - 21s - loss: 12.0583 - accuracy10: 0.5146 - accuracy20: 0.4959 - accuracy30: 0.4851 - accuracy50: 0.4743 - val_loss: 12.7709 - val_accuracy10: 0.4704 - val_accuracy20: 0.4362 - val_accuracy30: 0.4191 - val_accuracy50: 0.3980 - 21s/epoch - 35ms/step
Epoch 22/50
617/617 - 21s - loss: 12.0265 - accuracy10: 0.5172 - accuracy20: 0.4998 - accuracy30: 0.4888 - accuracy50: 0.4782 - val_loss: 12.8230 - val_accuracy10: 0.4660 - val_accuracy20: 0.4325 - val_accuracy30: 0.4164 - val_accuracy50: 0.3981 - 21s/epoch - 35ms/step
Epoch 23/50
617/617 - 22s - loss: 11.9891 - accuracy10: 0.5200 - accuracy20: 0.5030 - accuracy30: 0.4918 - accuracy50: 0.4814 - val_loss: 12.7921 - val_accuracy10: 0.4661 - val_accuracy20: 0.4361 - val_accuracy30: 0.4174 - val_accuracy50: 0.3997 - 22s/epoch - 35ms/step
testing model: results/PCAR/W6/deepOF_L2/seq2seq
Evaluating performance on  test set...
1722/1722 - 26s - 26s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0366608
{'0': {'precision': 0.48529134579137273, 'recall': 0.44851957618629884, 'f1-score': 0.4661814584054086, 'support': 160731}, '1': {'precision': 0.39406020201343406, 'recall': 0.4057013761942538, 'f1-score': 0.39979606576878957, 'support': 115972}, '2': {'precision': 0.4910150193237833, 'recall': 0.517206915674839, 'f1-score': 0.5037707569709291, 'support': 164091}, 'accuracy': 0.46282390413662616, 'macro avg': {'precision': 0.45678885570953004, 'recall': 0.45714262268513056, 'f1-score': 0.45658276038170903, 'support': 440794}, 'weighted avg': {'precision': 0.4634193264521614, 'recall': 0.46282390413662616, 'f1-score': 0.46270867709727115, 'support': 440794}}
[[72091 37201 51439]
 [32386 47050 36536]
 [44075 35147 84869]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0576286
{'0': {'precision': 0.46672550314446, 'recall': 0.46797608881298036, 'f1-score': 0.467349959367053, 'support': 161598}, '1': {'precision': 0.3469477602233273, 'recall': 0.30404131629942044, 'f1-score': 0.3240805645123604, 'support': 114047}, '2': {'precision': 0.47681467397382843, 'recall': 0.5162852938861271, 'f1-score': 0.49576560678433235, 'support': 165149}, 'accuracy': 0.44366075763281715, 'macro avg': {'precision': 0.43016264578053853, 'recall': 0.4294342329995093, 'f1-score': 0.4290653768879153, 'support': 440794}, 'weighted avg': {'precision': 0.4395153419951997, 'recall': 0.44366075763281715, 'f1-score': 0.44092802776254647, 'support': 440794}}
[[75624 33266 52708]
 [38524 34675 40848]
 [47883 32002 85264]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0652016
{'0': {'precision': 0.44540911184266635, 'recall': 0.49565019328959276, 'f1-score': 0.46918852228284635, 'support': 158053}, '1': {'precision': 0.3503378497895072, 'recall': 0.24347448390031223, 'f1-score': 0.2872905203508331, 'support': 122021}, '2': {'precision': 0.45978613307275473, 'recall': 0.5152625684420109, 'f1-score': 0.48594615529058305, 'support': 160720}, 'accuracy': 0.43299364328915546, 'macro avg': {'precision': 0.4185110315683094, 'recall': 0.4181290818773053, 'f1-score': 0.4141417326414208, 'support': 440794}, 'weighted avg': {'precision': 0.42433347194083304, 'recall': 0.43299364328915546, 'f1-score': 0.4249454306873556, 'support': 440794}}
[[78339 28047 51667]
 [46680 29709 45632]
 [50862 27045 82813]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0751461
{'0': {'precision': 0.4220485151840175, 'recall': 0.5047029863315411, 'f1-score': 0.45968988589028, 'support': 154370}, '1': {'precision': 0.36286283112897705, 'recall': 0.22083394429566974, 'f1-score': 0.2745686925483122, 'support': 129577}, '2': {'precision': 0.4403015795142472, 'recall': 0.49780996767550545, 'f1-score': 0.4672930755880065, 'support': 156847}, 'accuracy': 0.4188033412433019, 'macro avg': {'precision': 0.40840430860908056, 'recall': 0.40778229943423877, 'f1-score': 0.40051721800886625, 'support': 440794}, 'weighted avg': {'precision': 0.41114508863602356, 'recall': 0.4188033412433019, 'f1-score': 0.4079765881249909, 'support': 440794}}
[[77911 25520 50939]
 [52648 28615 48314]
 [54043 24724 78080]]
Evaluating performance on  train set...
617/617 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9978336
{'0': {'precision': 0.49644619115310645, 'recall': 0.4580930151810343, 'f1-score': 0.47649909206737767, 'support': 51841}, '1': {'precision': 0.5113884734844127, 'recall': 0.49717608902309457, 'f1-score': 0.5041821429584055, 'support': 53649}, '2': {'precision': 0.48685254839711517, 'recall': 0.5378559719415958, 'f1-score': 0.5110849483789169, 'support': 52462}, 'accuracy': 0.49786010940032416, 'macro avg': {'precision': 0.49822907101154473, 'recall': 0.49770835871524155, 'f1-score': 0.49725539446823336, 'support': 157952}, 'weighted avg': {'precision': 0.4983349726723492, 'recall': 0.49786010940032416, 'f1-score': 0.49738905351812684, 'support': 157952}}
[[23748 13397 14696]
 [11931 26673 15045]
 [12157 12088 28217]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0276463
{'0': {'precision': 0.47765748031496064, 'recall': 0.46116274207955604, 'f1-score': 0.4692652078478393, 'support': 52617}, '1': {'precision': 0.465343108631242, 'recall': 0.40869548700805347, 'f1-score': 0.43518359339448054, 'support': 52648}, '2': {'precision': 0.4667640733505163, 'recall': 0.5396397593334219, 'f1-score': 0.5005633802816901, 'support': 52687}, 'accuracy': 0.46985160048622365, 'macro avg': {'precision': 0.4699215540989063, 'recall': 0.46983266280701047, 'f1-score': 0.46833739384133666, 'support': 157952}, 'weighted avg': {'precision': 0.4699192562143471, 'recall': 0.46985160048622365, 'f1-score': 0.4683451686794962, 'support': 157952}}
[[24265 12984 15368]
 [14018 21517 17113]
 [12517 11738 28432]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0422338
{'0': {'precision': 0.46463803589971814, 'recall': 0.47505924732202104, 'f1-score': 0.46979085616791505, 'support': 52745}, '1': {'precision': 0.4454039531759739, 'recall': 0.35521205976316644, 'f1-score': 0.3952278072817445, 'support': 52273}, '2': {'precision': 0.4530929158110883, 'recall': 0.5335701061699475, 'f1-score': 0.4900494491194587, 'support': 52934}, 'accuracy': 0.4550053180713128, 'macro avg': {'precision': 0.45437830162892684, 'recall': 0.4546138044183783, 'f1-score': 0.45168937085637273, 'support': 157952}, 'weighted avg': {'precision': 0.4544035811730302, 'recall': 0.4550053180713128, 'f1-score': 0.45190399246799495, 'support': 157952}}
[[25057 11898 15790]
 [15403 18568 18302]
 [13468 11222 28244]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0552137
{'0': {'precision': 0.441562634524322, 'recall': 0.4689768159564132, 'f1-score': 0.4548570372765486, 'support': 52493}, '1': {'precision': 0.43517031840525655, 'recall': 0.334072894147988, 'f1-score': 0.37797826576697385, 'support': 52734}, '2': {'precision': 0.4365733914480613, 'recall': 0.5110289236605026, 'f1-score': 0.4708760769647507, 'support': 52725}, 'accuracy': 0.43797482779578606, 'macro avg': {'precision': 0.4377687814592133, 'recall': 0.43802621125496793, 'f1-score': 0.43457046000275773, 'support': 157952}, 'weighted avg': {'precision': 0.4377630609866735, 'recall': 0.43797482779578606, 'f1-score': 0.4345374384792845, 'support': 157952}}
[[24618 11566 16309]
 [16653 17617 18464]
 [14481 11300 26944]]
Evaluating performance on  val set...
225/225 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0242645
{'0': {'precision': 0.46201141853315764, 'recall': 0.45352158215228755, 'f1-score': 0.4577271367579474, 'support': 18557}, '1': {'precision': 0.5137040323375727, 'recall': 0.49887500598401074, 'f1-score': 0.506180935033394, 'support': 20889}, '2': {'precision': 0.4482922451565222, 'recall': 0.47180398911050614, 'f1-score': 0.45974771263061015, 'support': 17999}, 'accuracy': 0.4757420141004439, 'macro avg': {'precision': 0.4746692320090842, 'recall': 0.47473352574893485, 'f1-score': 0.4745519281406505, 'support': 57445}, 'weighted avg': {'precision': 0.47651008000333545, 'recall': 0.4757420141004439, 'f1-score': 0.47597972161838537, 'support': 57445}}
[[ 8416  5183  4958]
 [ 4975 10421  5493]
 [ 4825  4682  8492]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0532124
{'0': {'precision': 0.4390916050012758, 'recall': 0.4543486296667899, 'f1-score': 0.44658984739956403, 'support': 18937}, '1': {'precision': 0.45576858392196434, 'recall': 0.40813253012048195, 'f1-score': 0.4306372159542349, 'support': 19920}, '2': {'precision': 0.4359884069558265, 'recall': 0.469388853023456, 'f1-score': 0.4520725388601036, 'support': 18588}, 'accuracy': 0.4431891374358082, 'macro avg': {'precision': 0.44361619862635554, 'recall': 0.4439566709369093, 'f1-score': 0.4430998674046342, 'support': 57445}, 'weighted avg': {'precision': 0.4438704921947879, 'recall': 0.4431891374358082, 'f1-score': 0.44283209390452627, 'support': 57445}}
[[8604 5034 5299]
 [5802 8130 5988]
 [5189 4674 8725]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0654483
{'0': {'precision': 0.42703400774860095, 'recall': 0.46667712090324603, 'f1-score': 0.445976322493631, 'support': 19131}, '1': {'precision': 0.42072674964037776, 'recall': 0.3449389806173726, 'f1-score': 0.3790820207940041, 'support': 19502}, '2': {'precision': 0.42216166236799846, 'recall': 0.46114182436742507, 'f1-score': 0.4407916465536953, 'support': 18812}, 'accuracy': 0.4235355557489773, 'macro avg': {'precision': 0.4233074732523257, 'recall': 0.42425264196268125, 'f1-score': 0.4219499966137768, 'support': 57445}, 'weighted avg': {'precision': 0.4232971688779166, 'recall': 0.4235355557489773, 'f1-score': 0.4215685098810765, 'support': 57445}}
[[8928 4772 5431]
 [6332 6727 6443]
 [5647 4490 8675]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0783064
{'0': {'precision': 0.4000366333913362, 'recall': 0.46144094654553136, 'f1-score': 0.42855040470934513, 'support': 18932}, '1': {'precision': 0.3977944595761642, 'recall': 0.309153802467861, 'f1-score': 0.34791702980651906, 'support': 19369}, '2': {'precision': 0.4119879342220492, 'recall': 0.4423318010865023, 'f1-score': 0.42662098846289487, 'support': 19144}, 'accuracy': 0.4037253024632257, 'macro avg': {'precision': 0.40327300906318325, 'recall': 0.40430885003329825, 'f1-score': 0.401029474326253, 'support': 57445}, 'weighted avg': {'precision': 0.40326349453638105, 'recall': 0.4037253024632257, 'f1-score': 0.40071987841262857, 'support': 57445}}
[[8736 4613 5583]
 [6878 5988 6503]
 [6224 4452 8468]]
training model: results/PCAR/W6/deepVOL_L2/seq2seq
Epoch 1/50
618/618 - 28s - loss: 13.0749 - accuracy10: 0.3866 - accuracy20: 0.3861 - accuracy30: 0.3844 - accuracy50: 0.3954 - val_loss: 13.2004 - val_accuracy10: 0.3694 - val_accuracy20: 0.3583 - val_accuracy30: 0.3547 - val_accuracy50: 0.3600 - 28s/epoch - 45ms/step
Epoch 2/50
618/618 - 22s - loss: 12.9280 - accuracy10: 0.4131 - accuracy20: 0.4094 - accuracy30: 0.4048 - accuracy50: 0.4077 - val_loss: 12.9846 - val_accuracy10: 0.4005 - val_accuracy20: 0.3907 - val_accuracy30: 0.3808 - val_accuracy50: 0.3698 - 22s/epoch - 35ms/step
Epoch 3/50
618/618 - 22s - loss: 12.8421 - accuracy10: 0.4247 - accuracy20: 0.4190 - accuracy30: 0.4122 - accuracy50: 0.4118 - val_loss: 12.9364 - val_accuracy10: 0.4161 - val_accuracy20: 0.4018 - val_accuracy30: 0.3845 - val_accuracy50: 0.3692 - 22s/epoch - 35ms/step
Epoch 4/50
618/618 - 22s - loss: 12.7734 - accuracy10: 0.4394 - accuracy20: 0.4294 - accuracy30: 0.4211 - accuracy50: 0.4177 - val_loss: 12.9183 - val_accuracy10: 0.4184 - val_accuracy20: 0.4082 - val_accuracy30: 0.3973 - val_accuracy50: 0.3803 - 22s/epoch - 35ms/step
Epoch 5/50
618/618 - 21s - loss: 12.7552 - accuracy10: 0.4442 - accuracy20: 0.4322 - accuracy30: 0.4213 - accuracy50: 0.4180 - val_loss: 12.8432 - val_accuracy10: 0.4329 - val_accuracy20: 0.4211 - val_accuracy30: 0.4089 - val_accuracy50: 0.3927 - 21s/epoch - 34ms/step
Epoch 6/50
618/618 - 21s - loss: 12.7122 - accuracy10: 0.4515 - accuracy20: 0.4365 - accuracy30: 0.4252 - accuracy50: 0.4217 - val_loss: 12.8104 - val_accuracy10: 0.4365 - val_accuracy20: 0.4240 - val_accuracy30: 0.4148 - val_accuracy50: 0.3977 - 21s/epoch - 34ms/step
Epoch 7/50
618/618 - 22s - loss: 12.6710 - accuracy10: 0.4594 - accuracy20: 0.4425 - accuracy30: 0.4297 - accuracy50: 0.4233 - val_loss: 12.8120 - val_accuracy10: 0.4376 - val_accuracy20: 0.4253 - val_accuracy30: 0.4147 - val_accuracy50: 0.3983 - 22s/epoch - 35ms/step
Epoch 8/50
618/618 - 21s - loss: 12.6364 - accuracy10: 0.4635 - accuracy20: 0.4463 - accuracy30: 0.4328 - accuracy50: 0.4273 - val_loss: 12.8154 - val_accuracy10: 0.4399 - val_accuracy20: 0.4250 - val_accuracy30: 0.4152 - val_accuracy50: 0.4001 - 21s/epoch - 34ms/step
Epoch 9/50
618/618 - 22s - loss: 12.6070 - accuracy10: 0.4676 - accuracy20: 0.4481 - accuracy30: 0.4358 - accuracy50: 0.4296 - val_loss: 12.8083 - val_accuracy10: 0.4401 - val_accuracy20: 0.4256 - val_accuracy30: 0.4141 - val_accuracy50: 0.3979 - 22s/epoch - 35ms/step
Epoch 10/50
618/618 - 22s - loss: 12.5812 - accuracy10: 0.4702 - accuracy20: 0.4511 - accuracy30: 0.4378 - accuracy50: 0.4307 - val_loss: 12.8678 - val_accuracy10: 0.4361 - val_accuracy20: 0.4227 - val_accuracy30: 0.4121 - val_accuracy50: 0.3953 - 22s/epoch - 35ms/step
Epoch 11/50
618/618 - 21s - loss: 12.5585 - accuracy10: 0.4724 - accuracy20: 0.4531 - accuracy30: 0.4396 - accuracy50: 0.4331 - val_loss: 12.8294 - val_accuracy10: 0.4419 - val_accuracy20: 0.4280 - val_accuracy30: 0.4158 - val_accuracy50: 0.3977 - 21s/epoch - 35ms/step
Epoch 12/50
618/618 - 21s - loss: 12.5372 - accuracy10: 0.4742 - accuracy20: 0.4546 - accuracy30: 0.4414 - accuracy50: 0.4336 - val_loss: 12.8746 - val_accuracy10: 0.4395 - val_accuracy20: 0.4243 - val_accuracy30: 0.4121 - val_accuracy50: 0.3985 - 21s/epoch - 34ms/step
Epoch 13/50
618/618 - 21s - loss: 12.5129 - accuracy10: 0.4776 - accuracy20: 0.4571 - accuracy30: 0.4426 - accuracy50: 0.4357 - val_loss: 12.8705 - val_accuracy10: 0.4378 - val_accuracy20: 0.4228 - val_accuracy30: 0.4116 - val_accuracy50: 0.3967 - 21s/epoch - 35ms/step
Epoch 14/50
618/618 - 22s - loss: 12.4986 - accuracy10: 0.4780 - accuracy20: 0.4580 - accuracy30: 0.4441 - accuracy50: 0.4392 - val_loss: 12.8376 - val_accuracy10: 0.4453 - val_accuracy20: 0.4284 - val_accuracy30: 0.4148 - val_accuracy50: 0.4002 - 22s/epoch - 35ms/step
Epoch 15/50
618/618 - 22s - loss: 12.4825 - accuracy10: 0.4788 - accuracy20: 0.4589 - accuracy30: 0.4456 - accuracy50: 0.4405 - val_loss: 12.8281 - val_accuracy10: 0.4445 - val_accuracy20: 0.4285 - val_accuracy30: 0.4152 - val_accuracy50: 0.4004 - 22s/epoch - 35ms/step
Epoch 16/50
618/618 - 21s - loss: 12.4615 - accuracy10: 0.4817 - accuracy20: 0.4613 - accuracy30: 0.4476 - accuracy50: 0.4417 - val_loss: 12.8127 - val_accuracy10: 0.4451 - val_accuracy20: 0.4265 - val_accuracy30: 0.4145 - val_accuracy50: 0.3978 - 21s/epoch - 34ms/step
Epoch 17/50
618/618 - 22s - loss: 12.4391 - accuracy10: 0.4831 - accuracy20: 0.4631 - accuracy30: 0.4499 - accuracy50: 0.4432 - val_loss: 12.8415 - val_accuracy10: 0.4441 - val_accuracy20: 0.4271 - val_accuracy30: 0.4151 - val_accuracy50: 0.4012 - 22s/epoch - 35ms/step
Epoch 18/50
618/618 - 22s - loss: 12.4236 - accuracy10: 0.4840 - accuracy20: 0.4652 - accuracy30: 0.4513 - accuracy50: 0.4443 - val_loss: 12.8975 - val_accuracy10: 0.4410 - val_accuracy20: 0.4248 - val_accuracy30: 0.4132 - val_accuracy50: 0.3948 - 22s/epoch - 35ms/step
Epoch 19/50
618/618 - 22s - loss: 12.4119 - accuracy10: 0.4838 - accuracy20: 0.4655 - accuracy30: 0.4523 - accuracy50: 0.4461 - val_loss: 12.8338 - val_accuracy10: 0.4458 - val_accuracy20: 0.4292 - val_accuracy30: 0.4163 - val_accuracy50: 0.4000 - 22s/epoch - 35ms/step
testing model: results/PCAR/W6/deepVOL_L2/seq2seq
Evaluating performance on  test set...
1722/1722 - 26s - 26s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0417522
{'0': {'precision': 0.4397189948662524, 'recall': 0.7087405822077607, 'f1-score': 0.5427212287668263, 'support': 160733}, '1': {'precision': 0.4431299822024139, 'recall': 0.25548187940296446, 'f1-score': 0.3241046621015555, 'support': 115973}, '2': {'precision': 0.5028380896000557, 'recall': 0.3519894206334213, 'f1-score': 0.4141038647256407, 'support': 164093}, 'accuracy': 0.45668433912055156, 'macro avg': {'precision': 0.461895688889574, 'recall': 0.4387372940813821, 'f1-score': 0.42697658519800746, 'support': 440799}, 'weighted avg': {'precision': 0.4641132971366537, 'recall': 0.45668433912055156, 'f1-score': 0.4373243739566255, 'support': 440799}}
[[113918  17365  29450]
 [ 58687  29629  27657]
 [ 86465  19869  57759]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0562052
{'0': {'precision': 0.4358497154784486, 'recall': 0.6796720297029702, 'f1-score': 0.5311144530248887, 'support': 161600}, '1': {'precision': 0.38643135457254185, 'recall': 0.23653198653198654, 'f1-score': 0.29344704551388046, 'support': 114048}, '2': {'precision': 0.49185218801737973, 'recall': 0.35437266501565234, 'f1-score': 0.41194481593580623, 'support': 165151}, 'accuracy': 0.4431407512267496, 'macro avg': {'precision': 0.4380444193561234, 'recall': 0.4235255604168697, 'f1-score': 0.41216877149152514, 'support': 440799}, 'weighted avg': {'precision': 0.44404573932986424, 'recall': 0.4431407512267496, 'f1-score': 0.4249742911218115, 'support': 440799}}
[[109835  20130  31635]
 [ 58243  26976  28829]
 [ 83924  22702  58525]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0688838
{'0': {'precision': 0.4208052033591306, 'recall': 0.6467495492075543, 'f1-score': 0.5098671987031611, 'support': 158055}, '1': {'precision': 0.36677208301857805, 'recall': 0.23476286868653756, 'f1-score': 0.28628250484699486, 'support': 122021}, '2': {'precision': 0.4701860138925995, 'recall': 0.35039788953665624, 'f1-score': 0.40154866862270455, 'support': 160723}, 'accuracy': 0.4246493299667195, 'macro avg': {'precision': 0.41925443342343605, 'recall': 0.41063676914358266, 'f1-score': 0.3992327907242868, 'support': 440799}, 'weighted avg': {'precision': 0.42385297940738875, 'recall': 0.4246493299667195, 'f1-score': 0.40848015599402504, 'support': 440799}}
[[102222  23354  32479]
 [ 62395  28646  30980]
 [ 78303  26103  56317]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0803082
{'0': {'precision': 0.4037183265354094, 'recall': 0.6007890031871065, 'f1-score': 0.4829223715760781, 'support': 154372}, '1': {'precision': 0.3634996424214379, 'recall': 0.2667371524267424, 'f1-score': 0.30769025331499456, 'support': 129577}, '2': {'precision': 0.4423561058040487, 'recall': 0.32711507810009566, 'f1-score': 0.37610596764380333, 'support': 156850}, 'accuracy': 0.4052096306933546, 'macro avg': {'precision': 0.403191358253632, 'recall': 0.3982137445713148, 'f1-score': 0.3889061975116253, 'support': 440799}, 'weighted avg': {'precision': 0.4056441912647985, 'recall': 0.4052096306933546, 'f1-score': 0.3934026468382867, 'support': 440799}}
[[92745 28846 32781]
 [63115 34563 31899]
 [73867 31675 51308]]
Evaluating performance on  train set...
618/618 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0381871
{'0': {'precision': 0.4304471534104258, 'recall': 0.6375534033134219, 'f1-score': 0.5139192969060438, 'support': 51729}, '1': {'precision': 0.5215121072399157, 'recall': 0.31856673878982317, 'f1-score': 0.39552575815472263, 'support': 53612}, '2': {'precision': 0.46439303503066726, 'recall': 0.4288565346308827, 'f1-score': 0.4459179035158798, 'support': 52612}, 'accuracy': 0.4597696783220325, 'macro avg': {'precision': 0.4721174318936696, 'recall': 0.4616588922447093, 'f1-score': 0.45178765285888206, 'support': 157953}, 'weighted avg': {'precision': 0.4726630975742641, 'recall': 0.4597696783220325, 'f1-score': 0.45108412626300987, 'support': 157953}}
[[32980  7321 11428]
 [21938 17079 14595]
 [21700  8349 22563]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0517832
{'0': {'precision': 0.42973184840784995, 'recall': 0.6051349396673138, 'f1-score': 0.5025685608156168, 'support': 52542}, '1': {'precision': 0.4642463288641244, 'recall': 0.30419487335513806, 'f1-score': 0.36755278818096176, 'support': 52588}, '2': {'precision': 0.4521380814834266, 'recall': 0.42375480377865704, 'f1-score': 0.43748656308023065, 'support': 52823}, 'accuracy': 0.4442840591821618, 'macro avg': {'precision': 0.44870541958513366, 'recall': 0.44436153893370295, 'f1-score': 0.43586930402560314, 'support': 157953}, 'weighted avg': {'precision': 0.44871605224054545, 'recall': 0.4442840591821618, 'f1-score': 0.43585228560914696, 'support': 157953}}
[[31795  8774 11973]
 [21441 15997 15150]
 [20752  9687 22384]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0615194
{'0': {'precision': 0.422542606178428, 'recall': 0.5661026615969582, 'f1-score': 0.4838995376652502, 'support': 52600}, '1': {'precision': 0.4288258064516129, 'recall': 0.3174757838023729, 'f1-score': 0.36484394726152963, 'support': 52341}, '2': {'precision': 0.44601083476976117, 'recall': 0.410001509092281, 'f1-score': 0.42724878125491433, 'support': 53012}, 'accuracy': 0.431324507923243, 'macro avg': {'precision': 0.43245974913326735, 'recall': 0.43119331816387074, 'f1-score': 0.4253307553938981, 'support': 157953}, 'weighted avg': {'precision': 0.4325010540685125, 'recall': 0.431324507923243, 'f1-score': 0.4254349402461075, 'support': 157953}}
[[29777 10589 12234]
 [20961 16617 14763]
 [19733 11544 21735]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0710984
{'0': {'precision': 0.4138859976734219, 'recall': 0.5152831770714231, 'f1-score': 0.45905201684096153, 'support': 52476}, '1': {'precision': 0.4136317004360092, 'recall': 0.36756438501861277, 'f1-score': 0.3892397425583266, 'support': 52652}, '2': {'precision': 0.4313049549451269, 'recall': 0.3742167534311406, 'f1-score': 0.4007379026536115, 'support': 52825}, 'accuracy': 0.4188651054427583, 'macro avg': {'precision': 0.419607551018186, 'recall': 0.4190214385070588, 'f1-score': 0.41634322068429985, 'support': 157953}, 'weighted avg': {'precision': 0.4196267380185471, 'recall': 0.4188651054427583, 'f1-score': 0.4162785402531407, 'support': 157953}}
[[27040 13246 12190]
 [19424 19353 13875]
 [18868 14189 19768]]
Evaluating performance on  val set...
225/225 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0532374
{'0': {'precision': 0.4041954802633756, 'recall': 0.6593264248704663, 'f1-score': 0.5011589505856291, 'support': 18528}, '1': {'precision': 0.527214871880757, 'recall': 0.3018072000383491, 'f1-score': 0.3838673292076944, 'support': 20861}, '2': {'precision': 0.445716903344022, 'recall': 0.377194439829429, 'f1-score': 0.4086027956086148, 'support': 18057}, 'accuracy': 0.4408139818264109, 'macro avg': {'precision': 0.45904241849605154, 'recall': 0.4461093549127481, 'f1-score': 0.43120969180064606, 'support': 57446}, 'weighted avg': {'precision': 0.4619202977458361, 'recall': 0.4408139818264109, 'f1-score': 0.4294723752977928, 'support': 57446}}
[[12216  2695  3617]
 [ 9712  6296  4853]
 [ 8295  2951  6811]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0648048
{'0': {'precision': 0.4044489726608932, 'recall': 0.6269214571488735, 'f1-score': 0.49169092297846867, 'support': 18996}, '1': {'precision': 0.46133290144951006, 'recall': 0.28681468056184867, 'f1-score': 0.35371911089035135, 'support': 19863}, '2': {'precision': 0.4335548172757475, 'recall': 0.3650938828213267, 'f1-score': 0.39639008148602467, 'support': 18587}, 'accuracy': 0.42460745743828987, 'macro avg': {'precision': 0.4331122304620503, 'recall': 0.42627667351068294, 'f1-score': 0.4139333717849482, 'support': 57446}, 'weighted avg': {'precision': 0.43353499799572226, 'recall': 0.42460745743828987, 'f1-score': 0.4131494954756603, 'support': 57446}}
[[11909  3160  3927]
 [ 9227  5697  4939]
 [ 8309  3492  6786]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0719829
{'0': {'precision': 0.4022976316719689, 'recall': 0.5950538533932866, 'f1-score': 0.4800489286316855, 'support': 19126}, '1': {'precision': 0.4189376780886973, 'recall': 0.2946102861840415, 'f1-score': 0.34594268476621415, 'support': 19463}, '2': {'precision': 0.4309910142866378, 'recall': 0.35355570875536935, 'f1-score': 0.38845190234807436, 'support': 18857}, 'accuracy': 0.4139887894718518, 'macro avg': {'precision': 0.41740877468243465, 'recall': 0.4144066161108992, 'f1-score': 0.40481450524865803, 'support': 57446}, 'weighted avg': {'precision': 0.4173541428193699, 'recall': 0.4139887894718518, 'f1-score': 0.4045457613270216, 'support': 57446}}
[[11381  3770  3975]
 [ 8902  5734  4827]
 [ 8007  4183  6667]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.081171
{'0': {'precision': 0.388580015026296, 'recall': 0.545915136162128, 'f1-score': 0.45400280898876405, 'support': 18948}, '1': {'precision': 0.3975647830159226, 'recall': 0.32887396694214877, 'f1-score': 0.35997173144876327, 'support': 19360}, '2': {'precision': 0.4221862129498346, 'recall': 0.32673215592015886, 'f1-score': 0.3683760935520929, 'support': 19138}, 'accuracy': 0.39974932980538247, 'macro avg': {'precision': 0.40277700366401775, 'recall': 0.4005070863414785, 'f1-score': 0.3941168779965401, 'support': 57446}, 'weighted avg': {'precision': 0.4028038169296461, 'recall': 0.39974932980538247, 'f1-score': 0.39378685415811565, 'support': 57446}}
[[10344  4601  4003]
 [ 8438  6367  4555]
 [ 7838  5047  6253]]
training model: results/PCAR/W6/deepVOL_L3/seq2seq
Epoch 1/50
618/618 - 36s - loss: 13.1356 - accuracy10: 0.3738 - accuracy20: 0.3722 - accuracy30: 0.3720 - accuracy50: 0.3829 - val_loss: 13.2221 - val_accuracy10: 0.3627 - val_accuracy20: 0.3492 - val_accuracy30: 0.3434 - val_accuracy50: 0.3414 - 36s/epoch - 59ms/step
Epoch 2/50
618/618 - 29s - loss: 13.0497 - accuracy10: 0.3896 - accuracy20: 0.3854 - accuracy30: 0.3838 - accuracy50: 0.3919 - val_loss: 13.1036 - val_accuracy10: 0.3796 - val_accuracy20: 0.3729 - val_accuracy30: 0.3659 - val_accuracy50: 0.3610 - 29s/epoch - 46ms/step
Epoch 3/50
618/618 - 29s - loss: 12.9660 - accuracy10: 0.4066 - accuracy20: 0.4026 - accuracy30: 0.3977 - accuracy50: 0.4044 - val_loss: 13.0171 - val_accuracy10: 0.3945 - val_accuracy20: 0.3844 - val_accuracy30: 0.3761 - val_accuracy50: 0.3691 - 29s/epoch - 46ms/step
Epoch 4/50
618/618 - 28s - loss: 12.8782 - accuracy10: 0.4223 - accuracy20: 0.4151 - accuracy30: 0.4072 - accuracy50: 0.4085 - val_loss: 12.9507 - val_accuracy10: 0.4064 - val_accuracy20: 0.4002 - val_accuracy30: 0.3928 - val_accuracy50: 0.3792 - 28s/epoch - 46ms/step
Epoch 5/50
618/618 - 29s - loss: 12.8260 - accuracy10: 0.4314 - accuracy20: 0.4225 - accuracy30: 0.4134 - accuracy50: 0.4132 - val_loss: 12.9538 - val_accuracy10: 0.4053 - val_accuracy20: 0.4020 - val_accuracy30: 0.3957 - val_accuracy50: 0.3850 - 29s/epoch - 46ms/step
Epoch 6/50
618/618 - 29s - loss: 12.7806 - accuracy10: 0.4391 - accuracy20: 0.4277 - accuracy30: 0.4186 - accuracy50: 0.4175 - val_loss: 12.9666 - val_accuracy10: 0.4119 - val_accuracy20: 0.4054 - val_accuracy30: 0.3976 - val_accuracy50: 0.3872 - 29s/epoch - 47ms/step
Epoch 7/50
618/618 - 29s - loss: 12.7457 - accuracy10: 0.4448 - accuracy20: 0.4319 - accuracy30: 0.4227 - accuracy50: 0.4197 - val_loss: 12.9197 - val_accuracy10: 0.4134 - val_accuracy20: 0.4074 - val_accuracy30: 0.4016 - val_accuracy50: 0.3910 - 29s/epoch - 47ms/step
Epoch 8/50
618/618 - 29s - loss: 12.7188 - accuracy10: 0.4503 - accuracy20: 0.4361 - accuracy30: 0.4254 - accuracy50: 0.4203 - val_loss: 12.8767 - val_accuracy10: 0.4231 - val_accuracy20: 0.4143 - val_accuracy30: 0.4063 - val_accuracy50: 0.3945 - 29s/epoch - 47ms/step
Epoch 9/50
618/618 - 28s - loss: 12.6910 - accuracy10: 0.4543 - accuracy20: 0.4397 - accuracy30: 0.4290 - accuracy50: 0.4229 - val_loss: 12.9194 - val_accuracy10: 0.4177 - val_accuracy20: 0.4110 - val_accuracy30: 0.4037 - val_accuracy50: 0.3893 - 28s/epoch - 46ms/step
Epoch 10/50
618/618 - 28s - loss: 12.6535 - accuracy10: 0.4586 - accuracy20: 0.4431 - accuracy30: 0.4320 - accuracy50: 0.4259 - val_loss: 12.8653 - val_accuracy10: 0.4267 - val_accuracy20: 0.4171 - val_accuracy30: 0.4077 - val_accuracy50: 0.3939 - 28s/epoch - 46ms/step
Epoch 11/50
618/618 - 28s - loss: 12.6317 - accuracy10: 0.4613 - accuracy20: 0.4457 - accuracy30: 0.4354 - accuracy50: 0.4282 - val_loss: 12.8518 - val_accuracy10: 0.4237 - val_accuracy20: 0.4153 - val_accuracy30: 0.4050 - val_accuracy50: 0.3922 - 28s/epoch - 46ms/step
Epoch 12/50
618/618 - 28s - loss: 12.6016 - accuracy10: 0.4637 - accuracy20: 0.4481 - accuracy30: 0.4370 - accuracy50: 0.4304 - val_loss: 12.8279 - val_accuracy10: 0.4334 - val_accuracy20: 0.4216 - val_accuracy30: 0.4115 - val_accuracy50: 0.3974 - 28s/epoch - 45ms/step
Epoch 13/50
618/618 - 28s - loss: 12.5850 - accuracy10: 0.4662 - accuracy20: 0.4498 - accuracy30: 0.4385 - accuracy50: 0.4317 - val_loss: 12.8261 - val_accuracy10: 0.4295 - val_accuracy20: 0.4208 - val_accuracy30: 0.4133 - val_accuracy50: 0.3978 - 28s/epoch - 46ms/step
Epoch 14/50
618/618 - 28s - loss: 12.5701 - accuracy10: 0.4676 - accuracy20: 0.4505 - accuracy30: 0.4396 - accuracy50: 0.4313 - val_loss: 12.8160 - val_accuracy10: 0.4317 - val_accuracy20: 0.4222 - val_accuracy30: 0.4127 - val_accuracy50: 0.3994 - 28s/epoch - 46ms/step
Epoch 15/50
618/618 - 28s - loss: 12.5455 - accuracy10: 0.4716 - accuracy20: 0.4539 - accuracy30: 0.4428 - accuracy50: 0.4340 - val_loss: 12.8454 - val_accuracy10: 0.4307 - val_accuracy20: 0.4202 - val_accuracy30: 0.4118 - val_accuracy50: 0.3962 - 28s/epoch - 46ms/step
Epoch 16/50
618/618 - 29s - loss: 12.5242 - accuracy10: 0.4736 - accuracy20: 0.4556 - accuracy30: 0.4441 - accuracy50: 0.4352 - val_loss: 12.8153 - val_accuracy10: 0.4365 - val_accuracy20: 0.4251 - val_accuracy30: 0.4165 - val_accuracy50: 0.4016 - 29s/epoch - 46ms/step
Epoch 17/50
618/618 - 28s - loss: 12.5094 - accuracy10: 0.4758 - accuracy20: 0.4579 - accuracy30: 0.4453 - accuracy50: 0.4368 - val_loss: 12.8398 - val_accuracy10: 0.4345 - val_accuracy20: 0.4252 - val_accuracy30: 0.4152 - val_accuracy50: 0.4029 - 28s/epoch - 46ms/step
Epoch 18/50
618/618 - 29s - loss: 12.4956 - accuracy10: 0.4755 - accuracy20: 0.4573 - accuracy30: 0.4463 - accuracy50: 0.4381 - val_loss: 12.8320 - val_accuracy10: 0.4367 - val_accuracy20: 0.4272 - val_accuracy30: 0.4170 - val_accuracy50: 0.4017 - 29s/epoch - 47ms/step
Epoch 19/50
618/618 - 29s - loss: 12.4647 - accuracy10: 0.4793 - accuracy20: 0.4617 - accuracy30: 0.4490 - accuracy50: 0.4404 - val_loss: 12.8171 - val_accuracy10: 0.4406 - val_accuracy20: 0.4295 - val_accuracy30: 0.4172 - val_accuracy50: 0.4030 - 29s/epoch - 47ms/step
Epoch 20/50
618/618 - 29s - loss: 12.4539 - accuracy10: 0.4791 - accuracy20: 0.4638 - accuracy30: 0.4514 - accuracy50: 0.4424 - val_loss: 12.8187 - val_accuracy10: 0.4396 - val_accuracy20: 0.4282 - val_accuracy30: 0.4163 - val_accuracy50: 0.4008 - 29s/epoch - 46ms/step
Epoch 21/50
618/618 - 29s - loss: 12.4344 - accuracy10: 0.4813 - accuracy20: 0.4664 - accuracy30: 0.4533 - accuracy50: 0.4440 - val_loss: 12.8460 - val_accuracy10: 0.4384 - val_accuracy20: 0.4269 - val_accuracy30: 0.4178 - val_accuracy50: 0.4028 - 29s/epoch - 46ms/step
Epoch 22/50
618/618 - 28s - loss: 12.4217 - accuracy10: 0.4815 - accuracy20: 0.4652 - accuracy30: 0.4530 - accuracy50: 0.4440 - val_loss: 12.8246 - val_accuracy10: 0.4413 - val_accuracy20: 0.4261 - val_accuracy30: 0.4136 - val_accuracy50: 0.3989 - 28s/epoch - 46ms/step
Epoch 23/50
618/618 - 28s - loss: 12.4023 - accuracy10: 0.4832 - accuracy20: 0.4673 - accuracy30: 0.4549 - accuracy50: 0.4472 - val_loss: 12.8845 - val_accuracy10: 0.4351 - val_accuracy20: 0.4232 - val_accuracy30: 0.4124 - val_accuracy50: 0.3977 - 28s/epoch - 46ms/step
Epoch 24/50
618/618 - 28s - loss: 12.3789 - accuracy10: 0.4865 - accuracy20: 0.4706 - accuracy30: 0.4576 - accuracy50: 0.4480 - val_loss: 12.9330 - val_accuracy10: 0.4311 - val_accuracy20: 0.4226 - val_accuracy30: 0.4149 - val_accuracy50: 0.4000 - 28s/epoch - 46ms/step
Epoch 25/50
618/618 - 29s - loss: 12.3734 - accuracy10: 0.4853 - accuracy20: 0.4706 - accuracy30: 0.4590 - accuracy50: 0.4503 - val_loss: 12.8700 - val_accuracy10: 0.4395 - val_accuracy20: 0.4252 - val_accuracy30: 0.4112 - val_accuracy50: 0.3972 - 29s/epoch - 47ms/step
Epoch 26/50
618/618 - 29s - loss: 12.3541 - accuracy10: 0.4873 - accuracy20: 0.4729 - accuracy30: 0.4601 - accuracy50: 0.4513 - val_loss: 12.8862 - val_accuracy10: 0.4356 - val_accuracy20: 0.4239 - val_accuracy30: 0.4129 - val_accuracy50: 0.3984 - 29s/epoch - 46ms/step
testing model: results/PCAR/W6/deepVOL_L3/seq2seq
Evaluating performance on  test set...
1722/1722 - 36s - 36s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0361745
{'0': {'precision': 0.4601926060299664, 'recall': 0.5776536243335221, 'f1-score': 0.5122761329905211, 'support': 160733}, '1': {'precision': 0.44005547245076043, 'recall': 0.24351357643589455, 'f1-score': 0.3135293562550999, 'support': 115973}, '2': {'precision': 0.4810538475615335, 'recall': 0.512630032969109, 'f1-score': 0.49634024374773206, 'support': 164093}, 'accuracy': 0.46553644631680197, 'macro avg': {'precision': 0.4604339753474201, 'recall': 0.44459907791284187, 'f1-score': 0.4407152443311177, 'support': 440799}, 'weighted avg': {'precision': 0.46266044264951, 'recall': 0.46553644631680197, 'f1-score': 0.45405406848526136, 'support': 440799}}
[[92848 17713 50172]
 [47159 28241 40573]
 [61752 18222 84119]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0531908
{'0': {'precision': 0.45440162271805273, 'recall': 0.5545049504950496, 'f1-score': 0.4994871794871794, 'support': 161600}, '1': {'precision': 0.38216665172836184, 'recall': 0.22431783108866443, 'f1-score': 0.2827007016962263, 'support': 114048}, '2': {'precision': 0.4729447460332735, 'recall': 0.5058946055428063, 'f1-score': 0.48886509385385946, 'support': 165151}, 'accuracy': 0.4508630917946729, 'macro avg': {'precision': 0.43650434015989603, 'recall': 0.4282391290421734, 'f1-score': 0.42368432501242176, 'support': 440799}, 'weighted avg': {'precision': 0.44265967545229157, 'recall': 0.4508630917946729, 'f1-score': 0.43941827669127687, 'support': 440799}}
[[89608 20441 51551]
 [46908 25583 41557]
 [60684 20918 83549]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0651964
{'0': {'precision': 0.43915200577936425, 'recall': 0.5230647559393882, 'f1-score': 0.4774494601673062, 'support': 158055}, '1': {'precision': 0.3738078189889732, 'recall': 0.213922193720753, 'f1-score': 0.2721174244596067, 'support': 122021}, '2': {'precision': 0.4526990416664386, 'recall': 0.5146369841279718, 'f1-score': 0.48168508834251506, 'support': 160723}, 'accuracy': 0.4344156860609938, 'macro avg': {'precision': 0.421886288811592, 'recall': 0.417207977929371, 'f1-score': 0.41041732432314265, 'support': 440799}, 'weighted avg': {'precision': 0.42600305860055476, 'recall': 0.4344156860609938, 'f1-score': 0.4221542860360466, 'support': 440799}}
[[82673 21810 53572]
 [49491 26103 46427]
 [56092 21917 82714]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0779779
{'0': {'precision': 0.4192754192137289, 'recall': 0.48429119270334, 'f1-score': 0.4494442139941445, 'support': 154372}, '1': {'precision': 0.37201428628330924, 'recall': 0.21623436257977882, 'f1-score': 0.2734975157886517, 'support': 129577}, '2': {'precision': 0.42624965272583504, 'recall': 0.5086515779407077, 'f1-score': 0.4638191743551285, 'support': 156850}, 'accuracy': 0.4141615566278508, 'macro avg': {'precision': 0.4058464527409577, 'recall': 0.4030590444079422, 'f1-score': 0.39558696804597493, 'support': 440799}, 'weighted avg': {'precision': 0.4078642152514895, 'recall': 0.4141615566278508, 'f1-score': 0.4028380901582175, 'support': 440799}}
[[74761 23802 55809]
 [49977 28019 51581]
 [53572 23496 79782]]
Evaluating performance on  train set...
618/618 - 12s - 12s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0361075
{'0': {'precision': 0.4473930343526577, 'recall': 0.5455740493726923, 'f1-score': 0.49162964898528005, 'support': 51729}, '1': {'precision': 0.5244113162798577, 'recall': 0.2887040214877266, 'f1-score': 0.37239404766201106, 'support': 53612}, '2': {'precision': 0.44671573052618696, 'recall': 0.5549304341214932, 'f1-score': 0.49497749408742975, 'support': 52612}, 'accuracy': 0.4615043715535634, 'macro avg': {'precision': 0.4728400270529008, 'recall': 0.46306950166063743, 'f1-score': 0.4530003969115737, 'support': 157953}, 'weighted avg': {'precision': 0.4733087803135623, 'recall': 0.4615043715535634, 'f1-score': 0.45227413037133296, 'support': 157953}}
[[28222  7087 16420]
 [18393 15478 19741]
 [16466  6950 29196]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0487959
{'0': {'precision': 0.4465581486565993, 'recall': 0.5200411099691675, 'f1-score': 0.48050646267475605, 'support': 52542}, '1': {'precision': 0.47324403998974623, 'recall': 0.28084353844983645, 'f1-score': 0.35249892596305316, 'support': 52588}, '2': {'precision': 0.43922083072745854, 'recall': 0.545103458720633, 'f1-score': 0.48646730866700455, 'support': 52823}, 'accuracy': 0.4487853981880686, 'macro avg': {'precision': 0.45300767312460133, 'recall': 0.448662702379879, 'f1-score': 0.43982423243493796, 'support': 157953}, 'weighted avg': {'precision': 0.45298903954475295, 'recall': 0.4487853981880686, 'f1-score': 0.4398817795554326, 'support': 157953}}
[[27324  8343 16875]
 [17931 14769 19888]
 [15933  8096 28794]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0583547
{'0': {'precision': 0.4387823660137475, 'recall': 0.48422053231939166, 'f1-score': 0.46038301987401375, 'support': 52600}, '1': {'precision': 0.4481544439048082, 'recall': 0.28207332683746966, 'f1-score': 0.3462273553379844, 'support': 52341}, '2': {'precision': 0.42976613601744273, 'recall': 0.5428582207802007, 'f1-score': 0.47973727640988884, 'support': 53012}, 'accuracy': 0.43691477844675314, 'macro avg': {'precision': 0.43890098197866617, 'recall': 0.4363840266456873, 'f1-score': 0.428782550540629, 'support': 157953}, 'weighted avg': {'precision': 0.43886198174964297, 'recall': 0.43691477844675314, 'f1-score': 0.42905082744968187, 'support': 157953}}
[[25470  9219 17911]
 [17304 14764 20273]
 [15273  8961 28778]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0679122
{'0': {'precision': 0.4256991241438828, 'recall': 0.44180196661330895, 'f1-score': 0.4336010922318748, 'support': 52476}, '1': {'precision': 0.43969252271139064, 'recall': 0.29875408341563475, 'f1-score': 0.35577368903163065, 'support': 52652}, '2': {'precision': 0.4143125064607115, 'recall': 0.5311121628017037, 'f1-score': 0.46549750294503156, 'support': 52825}, 'accuracy': 0.4239868821738112, 'macro avg': {'precision': 0.4265680511053283, 'recall': 0.42388940427688243, 'f1-score': 0.41829076140284566, 'support': 157953}, 'weighted avg': {'precision': 0.42655559627333206, 'recall': 0.4239868821738112, 'f1-score': 0.4183254055568718, 'support': 157953}}
[[23184 10247 19045]
 [16306 15730 20616]
 [14971  9798 28056]]
Evaluating performance on  val set...
225/225 - 4s - 4s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0560443
{'0': {'precision': 0.42071729112402323, 'recall': 0.5666558721934369, 'f1-score': 0.48290136375135106, 'support': 18528}, '1': {'precision': 0.5169574593217017, 'recall': 0.2528162600067111, 'f1-score': 0.3395679747609696, 'support': 20861}, '2': {'precision': 0.4146888599757728, 'recall': 0.5118790496760259, 'f1-score': 0.45818668517325145, 'support': 18057}, 'accuracy': 0.4354698325383839, 'macro avg': {'precision': 0.45078787014049926, 'recall': 0.44378372729205795, 'f1-score': 0.42688534122852406, 'support': 57446}, 'weighted avg': {'precision': 0.45377112894611377, 'recall': 0.4354698325383839, 'f1-score': 0.423082563855569, 'support': 57446}}
[[10499  2420  5609]
 [ 8150  5274  7437]
 [ 6306  2508  9243]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0645455
{'0': {'precision': 0.4205031239723775, 'recall': 0.5385344283006949, 'f1-score': 0.4722555627365894, 'support': 18996}, '1': {'precision': 0.4579753455360478, 'recall': 0.246891204752555, 'f1-score': 0.32082692748029173, 'support': 19863}, '2': {'precision': 0.41258366800535473, 'recall': 0.4974444504223382, 'f1-score': 0.45105739444349585, 'support': 18587}, 'accuracy': 0.4243985656094419, 'macro avg': {'precision': 0.4303540458379267, 'recall': 0.4276233611585294, 'f1-score': 0.41471329488679237, 'support': 57446}, 'weighted avg': {'precision': 0.43089743878733644, 'recall': 0.4243985656094419, 'f1-score': 0.4130375608537852, 'support': 57446}}
[[10230  2870  5896]
 [ 7691  4904  7268]
 [ 6407  2934  9246]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0716559
{'0': {'precision': 0.4175895204033266, 'recall': 0.5066924605249399, 'f1-score': 0.457846124772636, 'support': 19126}, '1': {'precision': 0.4277852954442941, 'recall': 0.24364178184247032, 'f1-score': 0.3104622233861464, 'support': 19463}, '2': {'precision': 0.405718234430336, 'recall': 0.4981704406851567, 'f1-score': 0.4472162052795696, 'support': 18857}, 'accuracy': 0.4147721338300317, 'macro avg': {'precision': 0.4170310167593189, 'recall': 0.416168227684189, 'f1-score': 0.4051748511461173, 'support': 57446}, 'weighted avg': {'precision': 0.4171470793287464, 'recall': 0.4147721338300317, 'f1-score': 0.4044223656846926, 'support': 57446}}
[[9691 3094 6341]
 [7302 4742 7419]
 [6214 3249 9394]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0816153
{'0': {'precision': 0.3938759725192229, 'recall': 0.45688199282246145, 'f1-score': 0.42304591101229017, 'support': 18948}, '1': {'precision': 0.4078235890503549, 'recall': 0.2493285123966942, 'f1-score': 0.309462751634825, 'support': 19360}, '2': {'precision': 0.39816342939359317, 'recall': 0.4916396697669558, 'f1-score': 0.4399915826883958, 'support': 19138}, 'accuracy': 0.3985133864846987, 'macro avg': {'precision': 0.39995433032105704, 'recall': 0.39928339166203713, 'f1-score': 0.39083341511183695, 'support': 57446}, 'weighted avg': {'precision': 0.40000484495080063, 'recall': 0.3985133864846987, 'f1-score': 0.3904124169307107, 'support': 57446}}
[[8657 3416 6875]
 [7186 4827 7347]
 [6136 3593 9409]]
training model: results/PCAR/W7/deepLOB_L1/seq2seq
Epoch 1/50
526/526 - 22s - loss: 13.1708 - accuracy10: 0.3834 - accuracy20: 0.3755 - accuracy30: 0.3772 - accuracy50: 0.3656 - val_loss: 13.2481 - val_accuracy10: 0.3547 - val_accuracy20: 0.3489 - val_accuracy30: 0.3417 - val_accuracy50: 0.3427 - 22s/epoch - 42ms/step
Epoch 2/50
526/526 - 14s - loss: 13.0579 - accuracy10: 0.3985 - accuracy20: 0.3861 - accuracy30: 0.3867 - accuracy50: 0.3666 - val_loss: 13.0883 - val_accuracy10: 0.3823 - val_accuracy20: 0.3753 - val_accuracy30: 0.3694 - val_accuracy50: 0.3548 - 14s/epoch - 27ms/step
Epoch 3/50
526/526 - 14s - loss: 12.9926 - accuracy10: 0.4133 - accuracy20: 0.3981 - accuracy30: 0.3971 - accuracy50: 0.3758 - val_loss: 13.1491 - val_accuracy10: 0.3782 - val_accuracy20: 0.3664 - val_accuracy30: 0.3562 - val_accuracy50: 0.3523 - 14s/epoch - 27ms/step
Epoch 4/50
526/526 - 15s - loss: 12.9681 - accuracy10: 0.4195 - accuracy20: 0.4025 - accuracy30: 0.3989 - accuracy50: 0.3786 - val_loss: 13.0756 - val_accuracy10: 0.3983 - val_accuracy20: 0.3849 - val_accuracy30: 0.3746 - val_accuracy50: 0.3619 - 15s/epoch - 28ms/step
Epoch 5/50
526/526 - 14s - loss: 12.9491 - accuracy10: 0.4233 - accuracy20: 0.4064 - accuracy30: 0.4021 - accuracy50: 0.3814 - val_loss: 12.9910 - val_accuracy10: 0.4297 - val_accuracy20: 0.4059 - val_accuracy30: 0.3894 - val_accuracy50: 0.3741 - 14s/epoch - 27ms/step
Epoch 6/50
526/526 - 14s - loss: 12.9284 - accuracy10: 0.4262 - accuracy20: 0.4100 - accuracy30: 0.4059 - accuracy50: 0.3831 - val_loss: 12.9727 - val_accuracy10: 0.4328 - val_accuracy20: 0.4119 - val_accuracy30: 0.3910 - val_accuracy50: 0.3785 - 14s/epoch - 27ms/step
Epoch 7/50
526/526 - 14s - loss: 12.9158 - accuracy10: 0.4280 - accuracy20: 0.4119 - accuracy30: 0.4079 - accuracy50: 0.3851 - val_loss: 12.9565 - val_accuracy10: 0.4374 - val_accuracy20: 0.4143 - val_accuracy30: 0.3921 - val_accuracy50: 0.3765 - 14s/epoch - 27ms/step
Epoch 8/50
526/526 - 14s - loss: 12.8957 - accuracy10: 0.4307 - accuracy20: 0.4136 - accuracy30: 0.4094 - accuracy50: 0.3880 - val_loss: 12.9714 - val_accuracy10: 0.4334 - val_accuracy20: 0.4073 - val_accuracy30: 0.3911 - val_accuracy50: 0.3725 - 14s/epoch - 27ms/step
Epoch 9/50
526/526 - 14s - loss: 12.8890 - accuracy10: 0.4318 - accuracy20: 0.4145 - accuracy30: 0.4098 - accuracy50: 0.3895 - val_loss: 12.9926 - val_accuracy10: 0.4245 - val_accuracy20: 0.4055 - val_accuracy30: 0.3873 - val_accuracy50: 0.3678 - 14s/epoch - 27ms/step
Epoch 10/50
526/526 - 14s - loss: 12.8709 - accuracy10: 0.4325 - accuracy20: 0.4171 - accuracy30: 0.4114 - accuracy50: 0.3917 - val_loss: 13.0203 - val_accuracy10: 0.4167 - val_accuracy20: 0.3957 - val_accuracy30: 0.3818 - val_accuracy50: 0.3666 - 14s/epoch - 27ms/step
Epoch 11/50
526/526 - 14s - loss: 12.8616 - accuracy10: 0.4340 - accuracy20: 0.4178 - accuracy30: 0.4125 - accuracy50: 0.3924 - val_loss: 13.0292 - val_accuracy10: 0.4071 - val_accuracy20: 0.3844 - val_accuracy30: 0.3728 - val_accuracy50: 0.3641 - 14s/epoch - 27ms/step
Epoch 12/50
526/526 - 14s - loss: 12.8480 - accuracy10: 0.4361 - accuracy20: 0.4199 - accuracy30: 0.4132 - accuracy50: 0.3955 - val_loss: 13.1856 - val_accuracy10: 0.3515 - val_accuracy20: 0.3489 - val_accuracy30: 0.3492 - val_accuracy50: 0.3463 - 14s/epoch - 27ms/step
Epoch 13/50
526/526 - 14s - loss: 12.8379 - accuracy10: 0.4375 - accuracy20: 0.4220 - accuracy30: 0.4157 - accuracy50: 0.3952 - val_loss: 13.1329 - val_accuracy10: 0.3949 - val_accuracy20: 0.3749 - val_accuracy30: 0.3639 - val_accuracy50: 0.3567 - 14s/epoch - 27ms/step
Epoch 14/50
526/526 - 14s - loss: 12.8257 - accuracy10: 0.4390 - accuracy20: 0.4236 - accuracy30: 0.4172 - accuracy50: 0.3981 - val_loss: 13.2219 - val_accuracy10: 0.3990 - val_accuracy20: 0.3803 - val_accuracy30: 0.3708 - val_accuracy50: 0.3605 - 14s/epoch - 27ms/step
Epoch 15/50
526/526 - 14s - loss: 12.8174 - accuracy10: 0.4403 - accuracy20: 0.4246 - accuracy30: 0.4179 - accuracy50: 0.3994 - val_loss: 13.2284 - val_accuracy10: 0.3950 - val_accuracy20: 0.3773 - val_accuracy30: 0.3654 - val_accuracy50: 0.3559 - 14s/epoch - 27ms/step
Epoch 16/50
526/526 - 14s - loss: 12.8079 - accuracy10: 0.4410 - accuracy20: 0.4252 - accuracy30: 0.4196 - accuracy50: 0.4006 - val_loss: 13.2260 - val_accuracy10: 0.3871 - val_accuracy20: 0.3710 - val_accuracy30: 0.3644 - val_accuracy50: 0.3583 - 14s/epoch - 27ms/step
Epoch 17/50
526/526 - 14s - loss: 12.7980 - accuracy10: 0.4418 - accuracy20: 0.4259 - accuracy30: 0.4197 - accuracy50: 0.4021 - val_loss: 13.1953 - val_accuracy10: 0.3816 - val_accuracy20: 0.3646 - val_accuracy30: 0.3620 - val_accuracy50: 0.3537 - 14s/epoch - 27ms/step
testing model: results/PCAR/W7/deepLOB_L1/seq2seq
Evaluating performance on  test set...
1646/1646 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0811888
{'0': {'precision': 0.3751798888300405, 'recall': 0.5436525163570963, 'f1-score': 0.4439710430271242, 'support': 128996}, '1': {'precision': 0.5042921246016778, 'recall': 0.09611130046788337, 'f1-score': 0.1614520167188045, 'support': 161365}, '2': {'precision': 0.38397917587544816, 'recall': 0.5971556017231371, 'f1-score': 0.4674083949613492, 'support': 130924}, 'accuracy': 0.38885789904696344, 'macro avg': {'precision': 0.42115039643572216, 'recall': 0.41230647284937233, 'f1-score': 0.357610484902426, 'support': 421285}, 'weighted avg': {'precision': 0.42736839253281467, 'recall': 0.38885789904696344, 'f1-score': 0.34304133792106645, 'support': 421285}}
[[70129  7009 51858]
 [72286 15509 73570]
 [44506  8236 78182]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0840861
{'0': {'precision': 0.3658005431020712, 'recall': 0.5371504077436102, 'f1-score': 0.4352172411936308, 'support': 127899}, '1': {'precision': 0.4621990492255789, 'recall': 0.1110156173263923, 'f1-score': 0.179030006632941, 'support': 162896}, '2': {'precision': 0.3762200988942572, 'recall': 0.5603341252203234, 'f1-score': 0.4501799352910211, 'support': 130490}, 'accuracy': 0.3795601552393273, 'macro avg': {'precision': 0.4014065637406358, 'recall': 0.4028333834301086, 'f1-score': 0.3548090610391976, 'support': 421285}, 'weighted avg': {'precision': 0.4063018163228535, 'recall': 0.3795601552393273, 'f1-score': 0.3407932911165341, 'support': 421285}}
[[68701  9556 49642]
 [73223 18084 71589]
 [45886 11486 73118]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.090327
{'0': {'precision': 0.3094732060288463, 'recall': 0.5196792473391696, 'f1-score': 0.3879305961827223, 'support': 110116}, '1': {'precision': 0.508755385440358, 'recall': 0.14071641913178676, 'f1-score': 0.22045679442648303, 'support': 195528}, '2': {'precision': 0.32850411151278436, 'recall': 0.5178440172603143, 'f1-score': 0.40199507273422974, 'support': 115641}, 'accuracy': 0.3432901717364729, 'macro avg': {'precision': 0.38224423432732957, 'recall': 0.3927465612437569, 'f1-score': 0.3367941544478117, 'support': 421285}, 'weighted avg': {'precision': 0.407188526814163, 'recall': 0.3432901717364729, 'f1-score': 0.31406281694325, 'support': 421285}}
[[57225 11641 41250]
 [86855 27514 81159]
 [40831 14926 59884]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0913494
{'0': {'precision': 0.3321198700419959, 'recall': 0.4869753445773649, 'f1-score': 0.39490937138449667, 'support': 121961}, '1': {'precision': 0.4281051896422048, 'recall': 0.18698304687041709, 'f1-score': 0.2602826976311212, 'support': 170470}, '2': {'precision': 0.35081129986547777, 'recall': 0.4573936393127105, 'f1-score': 0.3970746759371547, 'support': 128854}, 'accuracy': 0.3565377357370901, 'macro avg': {'precision': 0.37034545318322615, 'recall': 0.37711734358683086, 'f1-score': 0.3507555816509242, 'support': 421285}, 'weighted avg': {'precision': 0.37667660225587146, 'recall': 0.3565377357370901, 'f1-score': 0.34109591749482643, 'support': 421285}}
[[59392 19062 43507]
 [73037 31875 65558]
 [46398 23519 58937]]
Evaluating performance on  train set...
526/526 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0720658
{'0': {'precision': 0.4320540760166956, 'recall': 0.5072749745213262, 'f1-score': 0.466652703390084, 'support': 46117}, '1': {'precision': 0.4266456237259157, 'recall': 0.15176963203817634, 'f1-score': 0.22389398854303263, 'support': 42749}, '2': {'precision': 0.41338299078884855, 'recall': 0.5897581667905716, 'f1-score': 0.48606518232850676, 'support': 45734}, 'accuracy': 0.4223922734026746, 'macro avg': {'precision': 0.4240275635104866, 'recall': 0.41626759111669137, 'f1-score': 0.3922039580872078, 'support': 134600}, 'weighted avg': {'precision': 0.4239923424447126, 'recall': 0.4223922734026746, 'f1-score': 0.3961483795473888, 'support': 134600}}
[[23394  4226 18497]
 [16483  6488 19778]
 [14269  4493 26972]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.080152
{'0': {'precision': 0.41569494335451784, 'recall': 0.4937855579868709, 'f1-score': 0.4513877081562235, 'support': 45700}, '1': {'precision': 0.3939936970895384, 'recall': 0.14637953992377978, 'f1-score': 0.21345474632162165, 'support': 43558}, '2': {'precision': 0.39961329757375413, 'recall': 0.5652154735124167, 'f1-score': 0.4682024955697243, 'support': 45342}, 'accuracy': 0.40542347696879644, 'macro avg': {'precision': 0.40310064600593676, 'recall': 0.4017935238076891, 'f1-score': 0.37768165001585646, 'support': 134600}, 'weighted avg': {'precision': 0.40325484775421055, 'recall': 0.40542347696879644, 'f1-score': 0.3800543659519989, 'support': 134600}}
[[22566  4713 18421]
 [17099  6376 20083]
 [14620  5094 25628]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0848398
{'0': {'precision': 0.4000666963094709, 'recall': 0.47717328854907853, 'f1-score': 0.4352312808626423, 'support': 45254}, '1': {'precision': 0.3899972214504029, 'recall': 0.15808086496227053, 'f1-score': 0.2249719506331143, 'support': 44395}, '2': {'precision': 0.390170687700586, 'recall': 0.5436141576383173, 'f1-score': 0.454285183119539, 'support': 44951}, 'accuracy': 0.39411589895988114, 'macro avg': {'precision': 0.3934115351534866, 'recall': 0.3929561037165555, 'f1-score': 0.3714961382050985, 'support': 134600}, 'weighted avg': {'precision': 0.39344062038564986, 'recall': 0.39411589895988114, 'f1-score': 0.3722448692341866, 'support': 134600}}
[[21594  5210 18450]
 [17634  7018 19743]
 [14748  5767 24436]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0914422
{'0': {'precision': 0.38831971072356775, 'recall': 0.4540029945393694, 'f1-score': 0.41860040197332354, 'support': 45416}, '1': {'precision': 0.37169974947003276, 'recall': 0.1738395673726904, 'f1-score': 0.23688897076885287, 'support': 44380}, '2': {'precision': 0.37546505119678664, 'recall': 0.5090616909204535, 'f1-score': 0.4321743249644718, 'support': 44804}, 'accuracy': 0.3799554234769688, 'macro avg': {'precision': 0.3784948371301291, 'recall': 0.37896808427750445, 'f1-score': 0.3625545659022161, 'support': 134600}, 'weighted avg': {'precision': 0.37856091394890373, 'recall': 0.3799554234769688, 'f1-score': 0.3632052513703592, 'support': 134600}}
[[20619  6312 18485]
 [17212  7715 19453]
 [15267  6729 22808]]
Evaluating performance on  val set...
146/146 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0651913
{'0': {'precision': 0.44502096808586256, 'recall': 0.4918303220738413, 'f1-score': 0.46725624090451134, 'support': 12730}, '1': {'precision': 0.4053473848555816, 'recall': 0.18067153792623522, 'f1-score': 0.2499398315282792, 'support': 11496}, '2': {'precision': 0.435386140795417, 'recall': 0.6023931102812285, 'f1-score': 0.5054516386890487, 'support': 13121}, 'accuracy': 0.43489436902562456, 'macro avg': {'precision': 0.42858483124562036, 'recall': 0.42496499009376837, 'f1-score': 0.40754923704061313, 'support': 37347}, 'weighted avg': {'precision': 0.4294238362762595, 'recall': 0.43489436902562456, 'f1-score': 0.4137818620291465, 'support': 37347}}
[[6261 1424 5045]
 [4214 2077 5205]
 [3594 1623 7904]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0769947
{'0': {'precision': 0.42185407120197393, 'recall': 0.4779934499560668, 'f1-score': 0.4481725584182145, 'support': 12519}, '1': {'precision': 0.37506369967725495, 'recall': 0.186297671279109, 'f1-score': 0.2489430069338745, 'support': 11852}, '2': {'precision': 0.42037626628075253, 'recall': 0.5596485819975339, 'f1-score': 0.48011635978975903, 'support': 12976}, 'accuracy': 0.4137949500629234, 'macro avg': {'precision': 0.40576467905332714, 'recall': 0.40797990107756993, 'f1-score': 0.3924106417139494, 'support': 37347}, 'weighted avg': {'precision': 0.40649178025574695, 'recall': 0.4137949500629234, 'f1-score': 0.39604612583741183, 'support': 37347}}
[[5984 1727 4808]
 [4439 2208 5205]
 [3762 1952 7262]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0845834
{'0': {'precision': 0.3978048265672272, 'recall': 0.46053596155412563, 'f1-score': 0.42687806719516797, 'support': 12277}, '1': {'precision': 0.3646659116647792, 'recall': 0.20880278836021723, 'f1-score': 0.2655533219937117, 'support': 12337}, '2': {'precision': 0.4012445550715619, 'recall': 0.5064006911175685, 'f1-score': 0.447731139117453, 'support': 12733}, 'accuracy': 0.3930168420488928, 'macro avg': {'precision': 0.38790509776785614, 'recall': 0.3919131470106371, 'f1-score': 0.38005417610211084, 'support': 37347}, 'weighted avg': {'precision': 0.3880306350630688, 'recall': 0.3930168420488928, 'f1-score': 0.38069654748103, 'support': 37347}}
[[5654 2061 4562]
 [4701 2576 5060]
 [3858 2427 6448]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0906498
{'0': {'precision': 0.3784070046603587, 'recall': 0.4413242197150622, 'f1-score': 0.4074510549325223, 'support': 12143}, '1': {'precision': 0.3647441104792851, 'recall': 0.24988074415646366, 'f1-score': 0.29657938192970035, 'support': 12578}, '2': {'precision': 0.3830313014827018, 'recall': 0.4419451924600032, 'f1-score': 0.4103846436713981, 'support': 12626}, 'accuracy': 0.3770583982649209, 'macro avg': {'precision': 0.37539413887411516, 'recall': 0.3777167187771764, 'f1-score': 0.37147169351120696, 'support': 37347}, 'weighted avg': {'precision': 0.375368862069772, 'recall': 0.3770583982649209, 'f1-score': 0.371102635739215, 'support': 37347}}
[[5359 2546 4238]
 [4685 3143 4750]
 [4118 2928 5580]]
training model: results/PCAR/W7/deepOF_L1/seq2seq
Epoch 1/50
526/526 - 21s - loss: 13.1784 - accuracy10: 0.3777 - accuracy20: 0.3708 - accuracy30: 0.3751 - accuracy50: 0.3582 - val_loss: 13.1223 - val_accuracy10: 0.3949 - val_accuracy20: 0.3880 - val_accuracy30: 0.3759 - val_accuracy50: 0.3658 - 21s/epoch - 40ms/step
Epoch 2/50
526/526 - 14s - loss: 13.0779 - accuracy10: 0.3953 - accuracy20: 0.3855 - accuracy30: 0.3875 - accuracy50: 0.3700 - val_loss: 13.0792 - val_accuracy10: 0.4030 - val_accuracy20: 0.3947 - val_accuracy30: 0.3811 - val_accuracy50: 0.3737 - 14s/epoch - 26ms/step
Epoch 3/50
526/526 - 14s - loss: 13.0503 - accuracy10: 0.4015 - accuracy20: 0.3912 - accuracy30: 0.3905 - accuracy50: 0.3728 - val_loss: 13.0697 - val_accuracy10: 0.4071 - val_accuracy20: 0.3975 - val_accuracy30: 0.3851 - val_accuracy50: 0.3734 - 14s/epoch - 26ms/step
Epoch 4/50
526/526 - 14s - loss: 13.0383 - accuracy10: 0.4032 - accuracy20: 0.3917 - accuracy30: 0.3909 - accuracy50: 0.3755 - val_loss: 13.0721 - val_accuracy10: 0.4063 - val_accuracy20: 0.3979 - val_accuracy30: 0.3821 - val_accuracy50: 0.3705 - 14s/epoch - 26ms/step
Epoch 5/50
526/526 - 14s - loss: 13.0252 - accuracy10: 0.4061 - accuracy20: 0.3959 - accuracy30: 0.3943 - accuracy50: 0.3776 - val_loss: 13.0653 - val_accuracy10: 0.4073 - val_accuracy20: 0.4001 - val_accuracy30: 0.3847 - val_accuracy50: 0.3729 - 14s/epoch - 26ms/step
Epoch 6/50
526/526 - 13s - loss: 13.0141 - accuracy10: 0.4066 - accuracy20: 0.3962 - accuracy30: 0.3954 - accuracy50: 0.3788 - val_loss: 13.0591 - val_accuracy10: 0.4070 - val_accuracy20: 0.4007 - val_accuracy30: 0.3858 - val_accuracy50: 0.3725 - 13s/epoch - 26ms/step
Epoch 7/50
526/526 - 14s - loss: 13.0076 - accuracy10: 0.4089 - accuracy20: 0.3978 - accuracy30: 0.3965 - accuracy50: 0.3789 - val_loss: 13.0606 - val_accuracy10: 0.4074 - val_accuracy20: 0.4016 - val_accuracy30: 0.3841 - val_accuracy50: 0.3723 - 14s/epoch - 26ms/step
Epoch 8/50
526/526 - 13s - loss: 13.0010 - accuracy10: 0.4105 - accuracy20: 0.3983 - accuracy30: 0.3975 - accuracy50: 0.3796 - val_loss: 13.0566 - val_accuracy10: 0.4108 - val_accuracy20: 0.4020 - val_accuracy30: 0.3859 - val_accuracy50: 0.3748 - 13s/epoch - 26ms/step
Epoch 9/50
526/526 - 13s - loss: 12.9924 - accuracy10: 0.4114 - accuracy20: 0.3991 - accuracy30: 0.3974 - accuracy50: 0.3818 - val_loss: 13.0602 - val_accuracy10: 0.4084 - val_accuracy20: 0.4011 - val_accuracy30: 0.3862 - val_accuracy50: 0.3740 - 13s/epoch - 25ms/step
Epoch 10/50
526/526 - 13s - loss: 12.9859 - accuracy10: 0.4131 - accuracy20: 0.3994 - accuracy30: 0.3984 - accuracy50: 0.3818 - val_loss: 13.0634 - val_accuracy10: 0.4081 - val_accuracy20: 0.4021 - val_accuracy30: 0.3864 - val_accuracy50: 0.3727 - 13s/epoch - 25ms/step
Epoch 11/50
526/526 - 13s - loss: 12.9786 - accuracy10: 0.4143 - accuracy20: 0.4007 - accuracy30: 0.4002 - accuracy50: 0.3839 - val_loss: 13.0583 - val_accuracy10: 0.4077 - val_accuracy20: 0.4013 - val_accuracy30: 0.3857 - val_accuracy50: 0.3751 - 13s/epoch - 26ms/step
Epoch 12/50
526/526 - 13s - loss: 12.9689 - accuracy10: 0.4150 - accuracy20: 0.4020 - accuracy30: 0.4015 - accuracy50: 0.3844 - val_loss: 13.0634 - val_accuracy10: 0.4056 - val_accuracy20: 0.3985 - val_accuracy30: 0.3841 - val_accuracy50: 0.3736 - 13s/epoch - 25ms/step
Epoch 13/50
526/526 - 13s - loss: 12.9672 - accuracy10: 0.4151 - accuracy20: 0.4018 - accuracy30: 0.4014 - accuracy50: 0.3844 - val_loss: 13.0697 - val_accuracy10: 0.4073 - val_accuracy20: 0.4000 - val_accuracy30: 0.3861 - val_accuracy50: 0.3710 - 13s/epoch - 25ms/step
Epoch 14/50
526/526 - 13s - loss: 12.9557 - accuracy10: 0.4158 - accuracy20: 0.4031 - accuracy30: 0.4036 - accuracy50: 0.3864 - val_loss: 13.0615 - val_accuracy10: 0.4072 - val_accuracy20: 0.4009 - val_accuracy30: 0.3876 - val_accuracy50: 0.3736 - 13s/epoch - 25ms/step
Epoch 15/50
526/526 - 13s - loss: 12.9471 - accuracy10: 0.4168 - accuracy20: 0.4040 - accuracy30: 0.4039 - accuracy50: 0.3865 - val_loss: 13.0700 - val_accuracy10: 0.4074 - val_accuracy20: 0.3990 - val_accuracy30: 0.3870 - val_accuracy50: 0.3742 - 13s/epoch - 25ms/step
Epoch 16/50
526/526 - 13s - loss: 12.9437 - accuracy10: 0.4170 - accuracy20: 0.4043 - accuracy30: 0.4052 - accuracy50: 0.3866 - val_loss: 13.0600 - val_accuracy10: 0.4061 - val_accuracy20: 0.4005 - val_accuracy30: 0.3870 - val_accuracy50: 0.3735 - 13s/epoch - 25ms/step
Epoch 17/50
526/526 - 14s - loss: 12.9362 - accuracy10: 0.4172 - accuracy20: 0.4058 - accuracy30: 0.4050 - accuracy50: 0.3873 - val_loss: 13.0667 - val_accuracy10: 0.4060 - val_accuracy20: 0.4001 - val_accuracy30: 0.3885 - val_accuracy50: 0.3773 - 14s/epoch - 26ms/step
Epoch 18/50
526/526 - 14s - loss: 12.9326 - accuracy10: 0.4178 - accuracy20: 0.4057 - accuracy30: 0.4061 - accuracy50: 0.3870 - val_loss: 13.0670 - val_accuracy10: 0.4074 - val_accuracy20: 0.4007 - val_accuracy30: 0.3871 - val_accuracy50: 0.3754 - 14s/epoch - 26ms/step
testing model: results/PCAR/W7/deepOF_L1/seq2seq
Evaluating performance on  test set...
1646/1646 - 22s - 22s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0839461
{'0': {'precision': 0.3660498287725031, 'recall': 0.5419237805823436, 'f1-score': 0.4369534643872863, 'support': 128996}, '1': {'precision': 0.4547457809308825, 'recall': 0.26217124017748694, 'f1-score': 0.33259432219313345, 'support': 161364}, '2': {'precision': 0.3933681051312684, 'recall': 0.41246562786434465, 'f1-score': 0.40269056958343896, 'support': 130920}, 'accuracy': 0.3945380744398025, 'macro avg': {'precision': 0.404721238278218, 'recall': 0.4055202162080584, 'f1-score': 0.3907461187212862, 'support': 421280}, 'weighted avg': {'precision': 0.4085128993312153, 'recall': 0.3945380744398025, 'f1-score': 0.38633272091800935, 'support': 421280}}
[[69906 23964 35126]
 [70909 42305 48150]
 [50159 26761 54000]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.088732
{'0': {'precision': 0.35354011327623325, 'recall': 0.5983518115998686, 'f1-score': 0.44446509466837025, 'support': 127898}, '1': {'precision': 0.4386038423665961, 'recall': 0.12851758176996367, 'f1-score': 0.19878742991164478, 'support': 162896}, '2': {'precision': 0.382692393387104, 'recall': 0.46070842849041277, 'f1-score': 0.418092101831535, 'support': 130486}, 'accuracy': 0.37404813900493733, 'macro avg': {'precision': 0.3916121163433111, 'recall': 0.395859273953415, 'f1-score': 0.3537815421371833, 'support': 421280}, 'weighted avg': {'precision': 0.3954611767885073, 'recall': 0.37404813900493733, 'f1-score': 0.3413004174429648, 'support': 421280}}
[[76528 12652 38718]
 [83708 20935 58253]
 [56226 14144 60116]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0977873
{'0': {'precision': 0.29821029359089957, 'recall': 0.6577790693450543, 'f1-score': 0.41037379073950797, 'support': 110116}, '1': {'precision': 0.5261590020480358, 'recall': 0.028906493732323412, 'f1-score': 0.05480222427994512, 'support': 195527}, '2': {'precision': 0.3337329778286778, 'recall': 0.48384167697190344, 'f1-score': 0.39500716590300966, 'support': 115637}, 'accuracy': 0.3181589441701481, 'macro avg': {'precision': 0.38603409115587106, 'recall': 0.39017574668309374, 'f1-score': 0.2867277269741542, 'support': 421280}, 'weighted avg': {'precision': 0.41375782434408614, 'recall': 0.3181589441701481, 'f1-score': 0.2411258034831533, 'support': 421280}}
[[ 72432   2364  35320]
 [113496   5652  76379]
 [ 56961   2726  55950]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0973461
{'0': {'precision': 0.32595873338061004, 'recall': 0.629394883568383, 'f1-score': 0.42948863207190874, 'support': 121960}, '1': {'precision': 0.42702044274970874, 'recall': 0.04729919984982519, 'f1-score': 0.08516503828888303, 'support': 170468}, '2': {'precision': 0.3588268775650819, 'recall': 0.4647968211591593, 'f1-score': 0.40499464087071474, 'support': 128852}, 'accuracy': 0.3435102544625902, 'macro avg': {'precision': 0.37060201789846686, 'recall': 0.3804969681924559, 'f1-score': 0.30654943707716886, 'support': 421280}, 'weighted avg': {'precision': 0.37690564181962705, 'recall': 0.3435102544625902, 'f1-score': 0.2826688111944375, 'support': 421280}}
[[76761  5352 39847]
 [95237  8063 67168]
 [63495  5467 59890]]
Evaluating performance on  train set...
526/526 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0767444
{'0': {'precision': 0.4183083286595625, 'recall': 0.5169374052414988, 'f1-score': 0.46242225795826625, 'support': 46170}, '1': {'precision': 0.3820896604211213, 'recall': 0.2468566344330235, 'f1-score': 0.2999345680066001, 'support': 42709}, '2': {'precision': 0.4239239239239239, 'recall': 0.46314523184601925, 'f1-score': 0.44266750287446427, 'support': 45720}, 'accuracy': 0.41296740689009576, 'macro avg': {'precision': 0.40810730433486925, 'recall': 0.40897975717351387, 'f1-score': 0.4016747762797768, 'support': 134599}, 'weighted avg': {'precision': 0.4087234276847485, 'recall': 0.41296740689009576, 'f1-score': 0.4041538150086371, 'support': 134599}}
[[23867  8475 13828]
 [17219 10543 14947]
 [15970  8575 21175]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0808555
{'0': {'precision': 0.4063692259183352, 'recall': 0.5629299613444277, 'f1-score': 0.4720057865389721, 'support': 45789}, '1': {'precision': 0.3550991994430908, 'recall': 0.11748042376784892, 'f1-score': 0.17655100804707105, 'support': 43420}, '2': {'precision': 0.4109569748609253, 'recall': 0.5142983035910994, 'f1-score': 0.45685656692173715, 'support': 45390}, 'accuracy': 0.4028336020327046, 'macro avg': {'precision': 0.3908084667407838, 'recall': 0.398236229567792, 'f1-score': 0.36847112050259345, 'support': 134599}, 'weighted avg': {'precision': 0.3913772376788167, 'recall': 0.40283360203270463, 'f1-score': 0.371586990258579, 'support': 134599}}
[[25776  4597 15416]
 [20275  5101 18044]
 [17379  4667 23344]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0842631
{'0': {'precision': 0.3889164763134373, 'recall': 0.6055491738093134, 'f1-score': 0.47363737678292195, 'support': 45268}, '1': {'precision': 0.384053738317757, 'recall': 0.029625791335300876, 'f1-score': 0.05500826169709899, 'support': 44387}, '2': {'precision': 0.40021749159691555, 'recall': 0.5404503381986472, 'f1-score': 0.45988110113976294, 'support': 44944}, 'accuracy': 0.3938885132876173, 'macro avg': {'precision': 0.39106256874270323, 'recall': 0.3918751011144204, 'f1-score': 0.32950891320659464, 'support': 134599}, 'weighted avg': {'precision': 0.39108640684402357, 'recall': 0.3938885132876173, 'f1-score': 0.33099179558380043, 'support': 134599}}
[[27412  1020 16836]
 [23506  1315 19566]
 [19565  1089 24290]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0897639
{'0': {'precision': 0.38319929814300335, 'recall': 0.5771322865511243, 'f1-score': 0.460584012161794, 'support': 45409}, '1': {'precision': 0.3679344033496162, 'recall': 0.047464722165957735, 'f1-score': 0.08408252765872622, 'support': 44433}, '2': {'precision': 0.3854523207169668, 'recall': 0.5208347297629421, 'f1-score': 0.44303171978638084, 'support': 44757}, 'accuracy': 0.3835615420619767, 'macro avg': {'precision': 0.3788620074031955, 'recall': 0.38181057949334135, 'f1-score': 0.32923275320230033, 'support': 134599}, 'weighted avg': {'precision': 0.378909321701784, 'recall': 0.3835615420619767, 'f1-score': 0.330459134482382, 'support': 134599}}
[[26207  1854 17348]
 [22506  2109 19818]
 [19677  1769 23311]]
Evaluating performance on  val set...
146/146 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0819622
{'0': {'precision': 0.40784463061690784, 'recall': 0.5046728971962616, 'f1-score': 0.45112148548562603, 'support': 12733}, '1': {'precision': 0.3682665492440922, 'recall': 0.21738000346560388, 'f1-score': 0.27338599836556793, 'support': 11542}, '2': {'precision': 0.4265989847715736, 'recall': 0.4822863264213023, 'f1-score': 0.4527366757649763, 'support': 13069}, 'accuracy': 0.40804413024850045, 'macro avg': {'precision': 0.4009033882108579, 'recall': 0.4014464090277226, 'f1-score': 0.3924147198720567, 'support': 37344}, 'weighted avg': {'precision': 0.40217545857433845, 'recall': 0.40804413024850045, 'f1-score': 0.39675360656052744, 'support': 37344}}
[[6426 2105 4202]
 [4763 2509 4270]
 [4567 2199 6303]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0848795
{'0': {'precision': 0.39802763603004415, 'recall': 0.5550935550935551, 'f1-score': 0.46361906033993383, 'support': 12506}, '1': {'precision': 0.375, 'recall': 0.10489157841654059, 'f1-score': 0.1639301195323788, 'support': 11898}, '2': {'precision': 0.4122473604826546, 'recall': 0.5280525502318393, 'f1-score': 0.4630188039979672, 'support': 12940}, 'accuracy': 0.40228684661525277, 'macro avg': {'precision': 0.3950916655042329, 'recall': 0.3960125612473117, 'f1-score': 0.36352266129009325, 'support': 37344}, 'weighted avg': {'precision': 0.3956181571560969, 'recall': 0.40228684661525277, 'f1-score': 0.3679285522317146, 'support': 37344}}
[[6942  977 4587]
 [5495 1248 5155]
 [5004 1103 6833]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0894693
{'0': {'precision': 0.37504614248800294, 'recall': 0.5812356979405034, 'f1-score': 0.45591204846309175, 'support': 12236}, '1': {'precision': 0.4289071680376028, 'recall': 0.02942599161560787, 'f1-score': 0.055073557148245945, 'support': 12404}, '2': {'precision': 0.3936679977181974, 'recall': 0.5432147355163728, 'f1-score': 0.4565059204868691, 'support': 12704}, 'accuracy': 0.38501499571550984, 'macro avg': {'precision': 0.3992071027479344, 'recall': 0.3846254750241614, 'f1-score': 0.3224971753660689, 'support': 37344}, 'weighted avg': {'precision': 0.3992712980621682, 'recall': 0.38501499571550984, 'f1-score': 0.3229735283238651, 'support': 37344}}
[[7112  259 4865]
 [6275  365 5764]
 [5576  227 6901]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0946966
{'0': {'precision': 0.366926625659051, 'recall': 0.5497408047395704, 'f1-score': 0.4401040808932512, 'support': 12153}, '1': {'precision': 0.3927938570584761, 'recall': 0.05300916699880431, 'f1-score': 0.09341199606686333, 'support': 12545}, '2': {'precision': 0.38112709969615316, 'recall': 0.5256998260319469, 'f1-score': 0.4418890624480707, 'support': 12646}, 'accuracy': 0.37473221936589546, 'macro avg': {'precision': 0.3802825274712267, 'recall': 0.3761499325901072, 'f1-score': 0.32513504646939506, 'support': 37344}, 'weighted avg': {'precision': 0.3804250086008618, 'recall': 0.37473221936589546, 'f1-score': 0.32424398750730465, 'support': 37344}}
[[6681  554 4918]
 [6003  665 5877]
 [5524  474 6648]]
training model: results/PCAR/W7/deepLOB_L2/seq2seq
Epoch 1/50
526/526 - 34s - loss: 13.1905 - accuracy10: 0.3728 - accuracy20: 0.3668 - accuracy30: 0.3704 - accuracy50: 0.3615 - val_loss: 13.2998 - val_accuracy10: 0.3171 - val_accuracy20: 0.3280 - val_accuracy30: 0.3379 - val_accuracy50: 0.3432 - 34s/epoch - 65ms/step
Epoch 2/50
526/526 - 27s - loss: 12.9895 - accuracy10: 0.4134 - accuracy20: 0.4004 - accuracy30: 0.3977 - accuracy50: 0.3808 - val_loss: 13.1983 - val_accuracy10: 0.3730 - val_accuracy20: 0.3659 - val_accuracy30: 0.3617 - val_accuracy50: 0.3599 - 27s/epoch - 52ms/step
Epoch 3/50
526/526 - 28s - loss: 12.8972 - accuracy10: 0.4288 - accuracy20: 0.4136 - accuracy30: 0.4107 - accuracy50: 0.3914 - val_loss: 13.0096 - val_accuracy10: 0.4101 - val_accuracy20: 0.3937 - val_accuracy30: 0.3812 - val_accuracy50: 0.3819 - 28s/epoch - 52ms/step
Epoch 4/50
526/526 - 27s - loss: 12.8456 - accuracy10: 0.4366 - accuracy20: 0.4207 - accuracy30: 0.4167 - accuracy50: 0.3973 - val_loss: 12.9253 - val_accuracy10: 0.4417 - val_accuracy20: 0.4188 - val_accuracy30: 0.3998 - val_accuracy50: 0.3895 - 27s/epoch - 52ms/step
Epoch 5/50
526/526 - 28s - loss: 12.8132 - accuracy10: 0.4420 - accuracy20: 0.4260 - accuracy30: 0.4223 - accuracy50: 0.4031 - val_loss: 12.9155 - val_accuracy10: 0.4442 - val_accuracy20: 0.4230 - val_accuracy30: 0.4033 - val_accuracy50: 0.3917 - 28s/epoch - 53ms/step
Epoch 6/50
526/526 - 27s - loss: 12.7910 - accuracy10: 0.4440 - accuracy20: 0.4288 - accuracy30: 0.4260 - accuracy50: 0.4062 - val_loss: 12.9832 - val_accuracy10: 0.4344 - val_accuracy20: 0.4177 - val_accuracy30: 0.3946 - val_accuracy50: 0.3874 - 27s/epoch - 52ms/step
Epoch 7/50
526/526 - 27s - loss: 12.7669 - accuracy10: 0.4465 - accuracy20: 0.4305 - accuracy30: 0.4272 - accuracy50: 0.4063 - val_loss: 12.9290 - val_accuracy10: 0.4454 - val_accuracy20: 0.4228 - val_accuracy30: 0.4001 - val_accuracy50: 0.3930 - 27s/epoch - 52ms/step
Epoch 8/50
526/526 - 27s - loss: 12.7451 - accuracy10: 0.4485 - accuracy20: 0.4326 - accuracy30: 0.4290 - accuracy50: 0.4096 - val_loss: 12.9543 - val_accuracy10: 0.4437 - val_accuracy20: 0.4202 - val_accuracy30: 0.3982 - val_accuracy50: 0.3918 - 27s/epoch - 51ms/step
Epoch 9/50
526/526 - 27s - loss: 12.7281 - accuracy10: 0.4502 - accuracy20: 0.4336 - accuracy30: 0.4315 - accuracy50: 0.4116 - val_loss: 12.9322 - val_accuracy10: 0.4414 - val_accuracy20: 0.4216 - val_accuracy30: 0.3994 - val_accuracy50: 0.3894 - 27s/epoch - 51ms/step
Epoch 10/50
526/526 - 27s - loss: 12.7070 - accuracy10: 0.4531 - accuracy20: 0.4365 - accuracy30: 0.4334 - accuracy50: 0.4138 - val_loss: 12.9020 - val_accuracy10: 0.4471 - val_accuracy20: 0.4258 - val_accuracy30: 0.4039 - val_accuracy50: 0.3940 - 27s/epoch - 51ms/step
Epoch 11/50
526/526 - 27s - loss: 12.6906 - accuracy10: 0.4549 - accuracy20: 0.4395 - accuracy30: 0.4357 - accuracy50: 0.4156 - val_loss: 12.9522 - val_accuracy10: 0.4429 - val_accuracy20: 0.4231 - val_accuracy30: 0.4015 - val_accuracy50: 0.3903 - 27s/epoch - 51ms/step
Epoch 12/50
526/526 - 27s - loss: 12.6655 - accuracy10: 0.4576 - accuracy20: 0.4410 - accuracy30: 0.4367 - accuracy50: 0.4182 - val_loss: 12.9947 - val_accuracy10: 0.4339 - val_accuracy20: 0.4145 - val_accuracy30: 0.3954 - val_accuracy50: 0.3823 - 27s/epoch - 51ms/step
Epoch 13/50
526/526 - 27s - loss: 12.6522 - accuracy10: 0.4584 - accuracy20: 0.4421 - accuracy30: 0.4380 - accuracy50: 0.4180 - val_loss: 12.9611 - val_accuracy10: 0.4352 - val_accuracy20: 0.4144 - val_accuracy30: 0.3928 - val_accuracy50: 0.3804 - 27s/epoch - 51ms/step
Epoch 14/50
526/526 - 27s - loss: 12.6319 - accuracy10: 0.4597 - accuracy20: 0.4454 - accuracy30: 0.4404 - accuracy50: 0.4218 - val_loss: 12.9294 - val_accuracy10: 0.4368 - val_accuracy20: 0.4152 - val_accuracy30: 0.3965 - val_accuracy50: 0.3838 - 27s/epoch - 51ms/step
Epoch 15/50
526/526 - 27s - loss: 12.6131 - accuracy10: 0.4619 - accuracy20: 0.4488 - accuracy30: 0.4425 - accuracy50: 0.4241 - val_loss: 13.0111 - val_accuracy10: 0.4298 - val_accuracy20: 0.4094 - val_accuracy30: 0.3915 - val_accuracy50: 0.3791 - 27s/epoch - 51ms/step
Epoch 16/50
526/526 - 27s - loss: 12.5957 - accuracy10: 0.4633 - accuracy20: 0.4492 - accuracy30: 0.4445 - accuracy50: 0.4252 - val_loss: 13.0886 - val_accuracy10: 0.4227 - val_accuracy20: 0.4048 - val_accuracy30: 0.3876 - val_accuracy50: 0.3755 - 27s/epoch - 51ms/step
Epoch 17/50
526/526 - 27s - loss: 12.5687 - accuracy10: 0.4661 - accuracy20: 0.4529 - accuracy30: 0.4471 - accuracy50: 0.4280 - val_loss: 13.0169 - val_accuracy10: 0.4311 - val_accuracy20: 0.4127 - val_accuracy30: 0.3940 - val_accuracy50: 0.3802 - 27s/epoch - 51ms/step
Epoch 18/50
526/526 - 27s - loss: 12.5509 - accuracy10: 0.4671 - accuracy20: 0.4537 - accuracy30: 0.4482 - accuracy50: 0.4301 - val_loss: 13.0942 - val_accuracy10: 0.4261 - val_accuracy20: 0.4071 - val_accuracy30: 0.3890 - val_accuracy50: 0.3744 - 27s/epoch - 52ms/step
Epoch 19/50
526/526 - 27s - loss: 12.5228 - accuracy10: 0.4682 - accuracy20: 0.4572 - accuracy30: 0.4527 - accuracy50: 0.4341 - val_loss: 13.0452 - val_accuracy10: 0.4291 - val_accuracy20: 0.4105 - val_accuracy30: 0.3939 - val_accuracy50: 0.3796 - 27s/epoch - 51ms/step
Epoch 20/50
526/526 - 27s - loss: 12.5003 - accuracy10: 0.4706 - accuracy20: 0.4605 - accuracy30: 0.4552 - accuracy50: 0.4343 - val_loss: 13.1520 - val_accuracy10: 0.4247 - val_accuracy20: 0.4057 - val_accuracy30: 0.3895 - val_accuracy50: 0.3744 - 27s/epoch - 51ms/step
testing model: results/PCAR/W7/deepLOB_L2/seq2seq
Evaluating performance on  test set...
1646/1646 - 33s - 33s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0736986
{'0': {'precision': 0.38825269363162473, 'recall': 0.5779636577878384, 'f1-score': 0.46448385318185925, 'support': 128996}, '1': {'precision': 0.593350751456171, 'recall': 0.15340377405261363, 'f1-score': 0.24378089854444465, 'support': 161365}, '2': {'precision': 0.3927716368328721, 'recall': 0.5626164797898017, 'f1-score': 0.46259691078712434, 'support': 130924}, 'accuracy': 0.41057478903829947, 'macro avg': {'precision': 0.45812502730688925, 'recall': 0.4313279705434179, 'f1-score': 0.3902872208378094, 'support': 421285}, 'weighted avg': {'precision': 0.46821586872814613, 'recall': 0.41057478903829947, 'f1-score': 0.3793614815779458, 'support': 421285}}
[[74555  8792 45649]
 [68381 24754 68230]
 [49091  8173 73660]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0771353
{'0': {'precision': 0.38278596896473166, 'recall': 0.564914502849905, 'f1-score': 0.45634955724265114, 'support': 127899}, '1': {'precision': 0.5636533570978329, 'recall': 0.15919359591395738, 'f1-score': 0.24826833506459936, 'support': 162896}, '2': {'precision': 0.381192869588527, 'recall': 0.5448846654916085, 'f1-score': 0.44857183414034035, 'support': 130490}, 'accuracy': 0.4018324886953013, 'macro avg': {'precision': 0.4425440652170305, 'recall': 0.4229975880851569, 'f1-score': 0.38439657548253026, 'support': 421285}, 'weighted avg': {'precision': 0.45222753588434356, 'recall': 0.4018324886953013, 'f1-score': 0.37348281891696555, 'support': 421285}}
[[72252 10230 45417]
 [66958 25932 70006]
 [49543  9845 71102]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0891058
{'0': {'precision': 0.33197846924256297, 'recall': 0.5466508046060518, 'f1-score': 0.413089576513701, 'support': 110116}, '1': {'precision': 0.6192784473013623, 'recall': 0.16530624769853933, 'f1-score': 0.260954864545194, 'support': 195528}, '2': {'precision': 0.3255631890078287, 'recall': 0.5286273899395543, 'f1-score': 0.40295836340805047, 'support': 115641}, 'accuracy': 0.3647127241653512, 'macro avg': {'precision': 0.4256067018505847, 'recall': 0.41352814741471516, 'f1-score': 0.35900093482231515, 'support': 421285}, 'weighted avg': {'precision': 0.463559989325775, 'recall': 0.36471272416535117, 'f1-score': 0.3396994022218825, 'support': 421285}}
[[60195  9743 40178]
 [76745 32322 86461]
 [44382 10128 61131]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0880543
{'0': {'precision': 0.3476809403470273, 'recall': 0.4884512262116578, 'f1-score': 0.40621611853993495, 'support': 121961}, '1': {'precision': 0.524605149560713, 'recall': 0.18179151756907375, 'f1-score': 0.27001476847475203, 'support': 170470}, '2': {'precision': 0.34914680595795067, 'recall': 0.5171899979822124, 'f1-score': 0.41687074829931975, 'support': 128854}, 'accuracy': 0.37315356587583226, 'macro avg': {'precision': 0.407144298621897, 'recall': 0.39581091392098133, 'f1-score': 0.3643672117713355, 'support': 421285}, 'weighted avg': {'precision': 0.4197204209648678, 'recall': 0.37315356587583226, 'f1-score': 0.35436202337254, 'support': 421285}}
[[59572 14035 48354]
 [63605 30990 75875]
 [48164 14048 66642]]
Evaluating performance on  train set...
526/526 - 11s - 11s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0688605
{'0': {'precision': 0.4409463349819148, 'recall': 0.5181169633757616, 'f1-score': 0.47642689796121823, 'support': 46117}, '1': {'precision': 0.47582511265375715, 'recall': 0.18278790147137944, 'f1-score': 0.2641158675702624, 'support': 42749}, '2': {'precision': 0.415721206438506, 'recall': 0.5816679057156601, 'f1-score': 0.4848893587546936, 'support': 45734}, 'accuracy': 0.43320950965824667, 'macro avg': {'precision': 0.444164218024726, 'recall': 0.42752425685426704, 'f1-score': 0.4084773747620581, 'support': 134600}, 'weighted avg': {'precision': 0.4434529236735146, 'recall': 0.43320950965824667, 'f1-score': 0.4118722021495231, 'support': 134600}}
[[23894  4696 17527]
 [15074  7814 19861]
 [15220  3912 26602]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0773408
{'0': {'precision': 0.42363865684464513, 'recall': 0.5071334792122538, 'f1-score': 0.46164112063899926, 'support': 45700}, '1': {'precision': 0.4460856720827179, 'recall': 0.18719867762523532, 'f1-score': 0.26372560117728866, 'support': 43558}, '2': {'precision': 0.4069854253903334, 'recall': 0.5530413303339068, 'f1-score': 0.4689031003403269, 'support': 45342}, 'accuracy': 0.4190638930163447, 'macro avg': {'precision': 0.4255699181058988, 'recall': 0.4157911623904653, 'f1-score': 0.3980899407188716, 'support': 134600}, 'weighted avg': {'precision': 0.4252928638961947, 'recall': 0.4190638930163447, 'f1-score': 0.4000398463960899, 'support': 134600}}
[[23176  5471 17053]
 [15919  8154 19485]
 [15612  4654 25076]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0829736
{'0': {'precision': 0.4089706344947542, 'recall': 0.48839881557431386, 'f1-score': 0.44516954187941227, 'support': 45254}, '1': {'precision': 0.42742325941706205, 'recall': 0.1988512219844577, 'f1-score': 0.27142615566726624, 'support': 44395}, '2': {'precision': 0.3982438275211592, 'recall': 0.5307112188827835, 'f1-score': 0.45503271215213537, 'support': 44951}, 'accuracy': 0.40702823179791975, 'macro avg': {'precision': 0.4115459071443252, 'recall': 0.4059870854805183, 'f1-score': 0.39054280323293794, 'support': 134600}, 'weighted avg': {'precision': 0.411474524414188, 'recall': 0.40702823179791975, 'f1-score': 0.3911578162927923, 'support': 134600}}
[[22102  6314 16838]
 [16358  8828 19209]
 [15583  5512 23856]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0896556
{'0': {'precision': 0.3991973066022483, 'recall': 0.4621058657741765, 'f1-score': 0.42835420302278826, 'support': 45416}, '1': {'precision': 0.41639400723265024, 'recall': 0.21793600721045517, 'f1-score': 0.28611998580049697, 'support': 44380}, '2': {'precision': 0.38618003707546045, 'recall': 0.5068074279082225, 'f1-score': 0.4383463799310831, 'support': 44804}, 'accuracy': 0.39647845468053494, 'macro avg': {'precision': 0.40059045030345297, 'recall': 0.3956164336309514, 'f1-score': 0.38427352291812283, 'support': 134600}, 'weighted avg': {'precision': 0.4005343335717805, 'recall': 0.39647845468053494, 'f1-score': 0.3847831401243778, 'support': 134600}}
[[20987  7229 17200]
 [15816  9672 18892]
 [15770  6327 22707]]
Evaluating performance on  val set...
146/146 - 3s - 3s/epoch - 22ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0552033
{'0': {'precision': 0.42826878157423, 'recall': 0.6193244304791831, 'f1-score': 0.5063746427309804, 'support': 12730}, '1': {'precision': 0.48235065942591154, 'recall': 0.21633611691022964, 'f1-score': 0.2987028585154936, 'support': 11496}, '2': {'precision': 0.45973008271658683, 'recall': 0.482890023626248, 'f1-score': 0.47102553618555554, 'support': 13121}, 'accuracy': 0.44734516828660936, 'macro avg': {'precision': 0.4567831745722428, 'recall': 0.4395168570052202, 'f1-score': 0.4253676791440098, 'support': 37347}, 'weighted avg': {'precision': 0.45596923944425427, 'recall': 0.44734516828660936, 'f1-score': 0.43003088129569095, 'support': 37347}}
[[7884 1378 3468]
 [5031 2487 3978]
 [5494 1291 6336]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0711356
{'0': {'precision': 0.4075594413050432, 'recall': 0.6106717788960779, 'f1-score': 0.4888576270102632, 'support': 12519}, '1': {'precision': 0.44585314315900687, 'recall': 0.21363482956463045, 'f1-score': 0.2888597341851577, 'support': 11852}, '2': {'precision': 0.4477924089852827, 'recall': 0.4455147965474723, 'f1-score': 0.44665069921965544, 'support': 12976}, 'accuracy': 0.4272900099070876, 'macro avg': {'precision': 0.43373499781644426, 'recall': 0.42327380166939355, 'f1-score': 0.40812268680502545, 'support': 37347}, 'weighted avg': {'precision': 0.4336905881974834, 'recall': 0.4272900099070876, 'f1-score': 0.4107241190772545, 'support': 37347}}
[[7645 1614 3260]
 [5451 2532 3869]
 [5662 1533 5781]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0837642
{'0': {'precision': 0.38759233486778716, 'recall': 0.5898020689093427, 'f1-score': 0.4677799670531994, 'support': 12277}, '1': {'precision': 0.4099653106275623, 'recall': 0.2107481559536354, 'f1-score': 0.27838749397719365, 'support': 12337}, '2': {'precision': 0.4240850442262436, 'recall': 0.41042959239770677, 'f1-score': 0.41714559386973177, 'support': 12733}, 'accuracy': 0.4034326719682973, 'macro avg': {'precision': 0.4072142299071977, 'recall': 0.40365993908689496, 'f1-score': 0.38777101830004157, 'support': 37347}, 'weighted avg': {'precision': 0.4074246392084188, 'recall': 0.4034326719682973, 'f1-score': 0.3879539458444336, 'support': 37347}}
[[7241 1879 3157]
 [5797 2600 3940]
 [5644 1863 5226]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0872353
{'0': {'precision': 0.37633058573066214, 'recall': 0.567734497241209, 'f1-score': 0.4526295056135513, 'support': 12143}, '1': {'precision': 0.4242766407904023, 'recall': 0.2389887104468119, 'f1-score': 0.3057519198494634, 'support': 12578}, '2': {'precision': 0.40157414384995394, 'recall': 0.37985110090289875, 'f1-score': 0.39041068012536123, 'support': 12626}, 'accuracy': 0.39349880847189866, 'macro avg': {'precision': 0.40072712345700606, 'recall': 0.3955247695303066, 'f1-score': 0.38293070186279204, 'support': 37347}, 'weighted avg': {'precision': 0.40101237129190104, 'recall': 0.39349880847189866, 'f1-score': 0.38212849711609276, 'support': 37347}}
[[6894 2000 3249]
 [5674 3006 3898]
 [5751 2079 4796]]
training model: results/PCAR/W7/deepOF_L2/seq2seq
Epoch 1/50
526/526 - 24s - loss: 13.1603 - accuracy10: 0.3811 - accuracy20: 0.3713 - accuracy30: 0.3720 - accuracy50: 0.3581 - val_loss: 13.0188 - val_accuracy10: 0.4123 - val_accuracy20: 0.3958 - val_accuracy30: 0.3828 - val_accuracy50: 0.3745 - 24s/epoch - 45ms/step
Epoch 2/50
526/526 - 19s - loss: 12.9543 - accuracy10: 0.4206 - accuracy20: 0.4033 - accuracy30: 0.4007 - accuracy50: 0.3803 - val_loss: 12.9443 - val_accuracy10: 0.4272 - val_accuracy20: 0.4097 - val_accuracy30: 0.3926 - val_accuracy50: 0.3834 - 19s/epoch - 35ms/step
Epoch 3/50
526/526 - 18s - loss: 12.8773 - accuracy10: 0.4328 - accuracy20: 0.4143 - accuracy30: 0.4110 - accuracy50: 0.3906 - val_loss: 12.8945 - val_accuracy10: 0.4389 - val_accuracy20: 0.4186 - val_accuracy30: 0.4034 - val_accuracy50: 0.3918 - 18s/epoch - 35ms/step
Epoch 4/50
526/526 - 18s - loss: 12.8215 - accuracy10: 0.4423 - accuracy20: 0.4236 - accuracy30: 0.4168 - accuracy50: 0.3965 - val_loss: 12.8799 - val_accuracy10: 0.4403 - val_accuracy20: 0.4222 - val_accuracy30: 0.4072 - val_accuracy50: 0.3950 - 18s/epoch - 33ms/step
Epoch 5/50
526/526 - 18s - loss: 12.7704 - accuracy10: 0.4489 - accuracy20: 0.4299 - accuracy30: 0.4225 - accuracy50: 0.4022 - val_loss: 12.8568 - val_accuracy10: 0.4438 - val_accuracy20: 0.4243 - val_accuracy30: 0.4102 - val_accuracy50: 0.3981 - 18s/epoch - 33ms/step
Epoch 6/50
526/526 - 18s - loss: 12.7287 - accuracy10: 0.4554 - accuracy20: 0.4347 - accuracy30: 0.4274 - accuracy50: 0.4067 - val_loss: 12.8270 - val_accuracy10: 0.4501 - val_accuracy20: 0.4278 - val_accuracy30: 0.4141 - val_accuracy50: 0.4027 - 18s/epoch - 33ms/step
Epoch 7/50
526/526 - 18s - loss: 12.6945 - accuracy10: 0.4606 - accuracy20: 0.4385 - accuracy30: 0.4310 - accuracy50: 0.4102 - val_loss: 12.8292 - val_accuracy10: 0.4505 - val_accuracy20: 0.4278 - val_accuracy30: 0.4133 - val_accuracy50: 0.4000 - 18s/epoch - 33ms/step
Epoch 8/50
526/526 - 18s - loss: 12.6601 - accuracy10: 0.4626 - accuracy20: 0.4432 - accuracy30: 0.4343 - accuracy50: 0.4128 - val_loss: 12.8295 - val_accuracy10: 0.4506 - val_accuracy20: 0.4288 - val_accuracy30: 0.4136 - val_accuracy50: 0.3982 - 18s/epoch - 34ms/step
Epoch 9/50
526/526 - 17s - loss: 12.6328 - accuracy10: 0.4654 - accuracy20: 0.4450 - accuracy30: 0.4373 - accuracy50: 0.4168 - val_loss: 12.8340 - val_accuracy10: 0.4491 - val_accuracy20: 0.4287 - val_accuracy30: 0.4150 - val_accuracy50: 0.4038 - 17s/epoch - 33ms/step
Epoch 10/50
526/526 - 17s - loss: 12.5993 - accuracy10: 0.4690 - accuracy20: 0.4500 - accuracy30: 0.4410 - accuracy50: 0.4190 - val_loss: 12.8333 - val_accuracy10: 0.4527 - val_accuracy20: 0.4324 - val_accuracy30: 0.4177 - val_accuracy50: 0.4031 - 17s/epoch - 33ms/step
Epoch 11/50
526/526 - 17s - loss: 12.5766 - accuracy10: 0.4722 - accuracy20: 0.4535 - accuracy30: 0.4435 - accuracy50: 0.4213 - val_loss: 12.8437 - val_accuracy10: 0.4546 - val_accuracy20: 0.4328 - val_accuracy30: 0.4180 - val_accuracy50: 0.4017 - 17s/epoch - 33ms/step
Epoch 12/50
526/526 - 18s - loss: 12.5456 - accuracy10: 0.4757 - accuracy20: 0.4571 - accuracy30: 0.4461 - accuracy50: 0.4249 - val_loss: 12.8480 - val_accuracy10: 0.4555 - val_accuracy20: 0.4352 - val_accuracy30: 0.4186 - val_accuracy50: 0.4023 - 18s/epoch - 34ms/step
Epoch 13/50
526/526 - 18s - loss: 12.5155 - accuracy10: 0.4771 - accuracy20: 0.4598 - accuracy30: 0.4491 - accuracy50: 0.4278 - val_loss: 12.8534 - val_accuracy10: 0.4551 - val_accuracy20: 0.4320 - val_accuracy30: 0.4176 - val_accuracy50: 0.4023 - 18s/epoch - 34ms/step
Epoch 14/50
526/526 - 17s - loss: 12.4877 - accuracy10: 0.4797 - accuracy20: 0.4632 - accuracy30: 0.4531 - accuracy50: 0.4317 - val_loss: 12.8897 - val_accuracy10: 0.4524 - val_accuracy20: 0.4326 - val_accuracy30: 0.4184 - val_accuracy50: 0.3993 - 17s/epoch - 33ms/step
Epoch 15/50
526/526 - 17s - loss: 12.4641 - accuracy10: 0.4799 - accuracy20: 0.4664 - accuracy30: 0.4562 - accuracy50: 0.4328 - val_loss: 12.8830 - val_accuracy10: 0.4578 - val_accuracy20: 0.4326 - val_accuracy30: 0.4145 - val_accuracy50: 0.3979 - 17s/epoch - 33ms/step
Epoch 16/50
526/526 - 18s - loss: 12.4321 - accuracy10: 0.4823 - accuracy20: 0.4682 - accuracy30: 0.4594 - accuracy50: 0.4378 - val_loss: 12.9085 - val_accuracy10: 0.4544 - val_accuracy20: 0.4338 - val_accuracy30: 0.4159 - val_accuracy50: 0.3981 - 18s/epoch - 34ms/step
testing model: results/PCAR/W7/deepOF_L2/seq2seq
Evaluating performance on  test set...
1646/1646 - 25s - 25s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0480783
{'0': {'precision': 0.41855205440862814, 'recall': 0.40313653136531363, 'f1-score': 0.4106996892288374, 'support': 128996}, '1': {'precision': 0.4937377858294224, 'recall': 0.42899903324161526, 'f1-score': 0.45909739032397123, 'support': 161364}, '2': {'precision': 0.41611564187745886, 'recall': 0.4984647112740605, 'f1-score': 0.45358281001845363, 'support': 130920}, 'accuracy': 0.44266758450436766, 'macro avg': {'precision': 0.44280182737183643, 'recall': 0.44353342529366313, 'f1-score': 0.44112662985708745, 'support': 421280}, 'weighted avg': {'precision': 0.4465934882208299, 'recall': 0.44266758450436766, 'f1-score': 0.44256425629418994, 'support': 421280}}
[[52003 35738 41255]
 [41824 69225 50315]
 [30418 35243 65259]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.062598
{'0': {'precision': 0.4022289441801128, 'recall': 0.3919607812475566, 'f1-score': 0.3970284836317125, 'support': 127898}, '1': {'precision': 0.4678912621359223, 'recall': 0.3698126411943817, 'f1-score': 0.41311041468081167, 'support': 162896}, '2': {'precision': 0.39975699387124247, 'recall': 0.5143693576322365, 'f1-score': 0.44987817670577745, 'support': 130486}, 'accuracy': 0.42131124192935815, 'macro avg': {'precision': 0.42329240006242586, 'recall': 0.42538092669139155, 'f1-score': 0.42000569167276725, 'support': 421280}, 'weighted avg': {'precision': 0.42685288559135065, 'recall': 0.42131124192935815, 'f1-score': 0.4196163759851034, 'support': 421280}}
[[50131 35033 42734]
 [44610 60241 58045]
 [29892 33476 67118]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0674528
{'0': {'precision': 0.3438458765570553, 'recall': 0.3898071124995459, 'f1-score': 0.36538682533804917, 'support': 110116}, '1': {'precision': 0.535083274213709, 'recall': 0.3240268607404604, 'f1-score': 0.40363009705954495, 'support': 195527}, '2': {'precision': 0.3465943237793542, 'recall': 0.5336354281069208, 'f1-score': 0.420242578606501, 'support': 115637}, 'accuracy': 0.39875617166729965, 'macro avg': {'precision': 0.40850782485003956, 'recall': 0.415823133782309, 'f1-score': 0.39641983366803174, 'support': 421280}, 'weighted avg': {'precision': 0.4333585447185097, 'recall': 0.39875617166729965, 'f1-score': 0.3981938585002996, 'support': 421280}}
[[42924 28273 38919]
 [54757 63356 77414]
 [27154 26775 61708]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0786847
{'0': {'precision': 0.362210079125697, 'recall': 0.3712118727451624, 'f1-score': 0.36665573332361484, 'support': 121960}, '1': {'precision': 0.4622421263955379, 'recall': 0.29850177159349556, 'f1-score': 0.36275044466068557, 'support': 170468}, '2': {'precision': 0.3662610227382576, 'recall': 0.5292894173159904, 'f1-score': 0.4329361577868202, 'support': 128852}, 'accuracy': 0.39013957462969995, 'macro avg': {'precision': 0.39690440941983085, 'recall': 0.3996676872182161, 'f1-score': 0.3874474452570402, 'support': 421280}, 'weighted avg': {'precision': 0.40392636098185186, 'recall': 0.39013957462969995, 'f1-score': 0.38534790600007873, 'support': 421280}}
[[45273 30478 46209]
 [47786 50885 71797]
 [31932 28720 68200]]
Evaluating performance on  train set...
526/526 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0452232
{'0': {'precision': 0.48156618330778317, 'recall': 0.41503140567468055, 'f1-score': 0.4458300857365549, 'support': 46170}, '1': {'precision': 0.4321636030874513, 'recall': 0.38148867920110513, 'f1-score': 0.4052481034697177, 'support': 42709}, '2': {'precision': 0.44617997793615494, 'recall': 0.5573053368328958, 'f1-score': 0.49558967975337215, 'support': 45720}, 'accuracy': 0.45271510189525926, 'macro avg': {'precision': 0.4533032547771298, 'recall': 0.4512751405695605, 'f1-score': 0.4488892896532149, 'support': 134599}, 'weighted avg': {'precision': 0.4538706424180218, 'recall': 0.45271510189525926, 'f1-score': 0.44985532186620325, 'support': 134599}}
[[19162 11101 15907]
 [10696 16293 15720]
 [ 9933 10307 25480]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0602977
{'0': {'precision': 0.4617643336286546, 'recall': 0.39839262705016487, 'f1-score': 0.42774403826763896, 'support': 45789}, '1': {'precision': 0.402093790334146, 'recall': 0.32286964532473517, 'f1-score': 0.35815290285495305, 'support': 43420}, '2': {'precision': 0.43007521293728934, 'recall': 0.5706763604318131, 'f1-score': 0.49049886857478286, 'support': 45390}, 'accuracy': 0.43212802472529516, 'macro avg': {'precision': 0.43131111230003, 'recall': 0.4306462109355711, 'f1-score': 0.425465269899125, 'support': 134599}, 'weighted avg': {'precision': 0.43182901332145596, 'recall': 0.43212802472529516, 'f1-score': 0.4264572133136827, 'support': 134599}}
[[18242 11048 16499]
 [11574 14019 17827]
 [ 9689  9798 25903]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0688823
{'0': {'precision': 0.4431733845169546, 'recall': 0.38254396041353717, 'f1-score': 0.41063277331847337, 'support': 45268}, '1': {'precision': 0.39508846857840146, 'recall': 0.29177461869466287, 'f1-score': 0.3356616170124535, 'support': 44387}, '2': {'precision': 0.4162947851587403, 'recall': 0.5811676753292987, 'f1-score': 0.4851051184904539, 'support': 44944}, 'accuracy': 0.41893327587872126, 'macro avg': {'precision': 0.41818554608469877, 'recall': 0.4184954181458329, 'f1-score': 0.4104665029404602, 'support': 134599}, 'weighted avg': {'precision': 0.4183412763042625, 'recall': 0.41893327587872126, 'f1-score': 0.41077646210111063, 'support': 134599}}
[[17317 10638 17313]
 [12125 12951 19311]
 [ 9633  9191 26120]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0780905
{'0': {'precision': 0.4282184655396619, 'recall': 0.36259331850514215, 'f1-score': 0.39268295591409386, 'support': 45409}, '1': {'precision': 0.39020846493998734, 'recall': 0.27803659442306394, 'f1-score': 0.324707923199243, 'support': 44433}, '2': {'precision': 0.3976802245344167, 'recall': 0.573005339946824, 'f1-score': 0.4695091811141827, 'support': 44757}, 'accuracy': 0.4046463941039681, 'macro avg': {'precision': 0.4053690516713553, 'recall': 0.4045450842916767, 'f1-score': 0.39563335340917316, 'support': 134599}, 'weighted avg': {'precision': 0.40551622845530694, 'recall': 0.4046463941039681, 'f1-score': 0.39578978978850154, 'support': 134599}}
[[16465 10388 18556]
 [11792 12354 20287]
 [10193  8918 25646]]
Evaluating performance on  val set...
146/146 - 3s - 3s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0517505
{'0': {'precision': 0.46988505747126436, 'recall': 0.40131940626717977, 'f1-score': 0.4329041003049813, 'support': 12733}, '1': {'precision': 0.4281342546890424, 'recall': 0.37575810084907296, 'f1-score': 0.40023994093761533, 'support': 11542}, '2': {'precision': 0.4466001591284656, 'recall': 0.5583441732343715, 'f1-score': 0.496259521218716, 'support': 13069}, 'accuracy': 0.44837189374464437, 'macro avg': {'precision': 0.4482064904295908, 'recall': 0.44514056011687475, 'f1-score': 0.4431345208204375, 'support': 37344}, 'weighted avg': {'precision': 0.448832194838594, 'recall': 0.44837189374464437, 'f1-score': 0.4449805320879574, 'support': 37344}}
[[5110 2865 4758]
 [2921 4337 4284]
 [2844 2928 7297]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0675552
{'0': {'precision': 0.44895324172277046, 'recall': 0.3892531584839277, 'f1-score': 0.416977172469913, 'support': 12506}, '1': {'precision': 0.4052238805970149, 'recall': 0.3194654563792234, 'f1-score': 0.35727042015226995, 'support': 11898}, '2': {'precision': 0.42538403130658253, 'recall': 0.5628284389489954, 'f1-score': 0.4845480855593626, 'support': 12940}, 'accuracy': 0.4271636675235647, 'macro avg': {'precision': 0.4265203845421226, 'recall': 0.42384901793738217, 'f1-score': 0.41959855939384855, 'support': 37344}, 'weighted avg': {'precision': 0.42685390792189987, 'recall': 0.4271636675235647, 'f1-score': 0.42136815030576774, 'support': 37344}}
[[4868 2796 4842]
 [3101 3801 4996]
 [2874 2783 7283]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0747793
{'0': {'precision': 0.4219491762077632, 'recall': 0.37046420398823143, 'f1-score': 0.39453413986683494, 'support': 12236}, '1': {'precision': 0.4127215615885125, 'recall': 0.29659787165430507, 'f1-score': 0.34515432967445353, 'support': 12404}, '2': {'precision': 0.4091140385593939, 'recall': 0.5695843828715366, 'f1-score': 0.47619360995031423, 'support': 12704}, 'accuracy': 0.4136675235646958, 'macro avg': {'precision': 0.41459492545188986, 'recall': 0.41221548617135767, 'f1-score': 0.4052940264972009, 'support': 37344}, 'weighted avg': {'precision': 0.414517810515227, 'recall': 0.4136675235646958, 'f1-score': 0.40591199821929375, 'support': 37344}}
[[4533 2654 5049]
 [3323 3679 5402]
 [2887 2581 7236]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0831494
{'0': {'precision': 0.4047009762107857, 'recall': 0.35135357524890976, 'f1-score': 0.3761451726568006, 'support': 12153}, '1': {'precision': 0.4133871898442008, 'recall': 0.2855320844958151, 'f1-score': 0.33776520509193775, 'support': 12545}, '2': {'precision': 0.3928729037952339, 'recall': 0.563182033844694, 'f1-score': 0.46285825697016963, 'support': 12646}, 'accuracy': 0.4009747215081405, 'macro avg': {'precision': 0.4036536899500735, 'recall': 0.4000225645298063, 'f1-score': 0.3922562115729693, 'support': 37344}, 'weighted avg': {'precision': 0.40361353903919517, 'recall': 0.4009747215081405, 'f1-score': 0.3926162783531818, 'support': 37344}}
[[4270 2578 5305]
 [3262 3582 5701]
 [3019 2505 7122]]
training model: results/PCAR/W7/deepVOL_L2/seq2seq
Epoch 1/50
526/526 - 23s - loss: 13.1615 - accuracy10: 0.3800 - accuracy20: 0.3743 - accuracy30: 0.3769 - accuracy50: 0.3662 - val_loss: 13.0170 - val_accuracy10: 0.4107 - val_accuracy20: 0.4030 - val_accuracy30: 0.3941 - val_accuracy50: 0.3805 - 23s/epoch - 44ms/step
Epoch 2/50
526/526 - 17s - loss: 12.9619 - accuracy10: 0.4126 - accuracy20: 0.4040 - accuracy30: 0.4044 - accuracy50: 0.3857 - val_loss: 12.9161 - val_accuracy10: 0.4310 - val_accuracy20: 0.4187 - val_accuracy30: 0.4085 - val_accuracy50: 0.3918 - 17s/epoch - 33ms/step
Epoch 3/50
526/526 - 18s - loss: 12.8700 - accuracy10: 0.4312 - accuracy20: 0.4186 - accuracy30: 0.4158 - accuracy50: 0.3990 - val_loss: 12.8507 - val_accuracy10: 0.4472 - val_accuracy20: 0.4316 - val_accuracy30: 0.4189 - val_accuracy50: 0.4020 - 18s/epoch - 34ms/step
Epoch 4/50
526/526 - 18s - loss: 12.8204 - accuracy10: 0.4392 - accuracy20: 0.4253 - accuracy30: 0.4229 - accuracy50: 0.4052 - val_loss: 12.8681 - val_accuracy10: 0.4426 - val_accuracy20: 0.4275 - val_accuracy30: 0.4112 - val_accuracy50: 0.3947 - 18s/epoch - 34ms/step
Epoch 5/50
526/526 - 17s - loss: 12.7889 - accuracy10: 0.4440 - accuracy20: 0.4296 - accuracy30: 0.4252 - accuracy50: 0.4087 - val_loss: 12.8332 - val_accuracy10: 0.4484 - val_accuracy20: 0.4308 - val_accuracy30: 0.4138 - val_accuracy50: 0.3964 - 17s/epoch - 33ms/step
Epoch 6/50
526/526 - 17s - loss: 12.7689 - accuracy10: 0.4459 - accuracy20: 0.4317 - accuracy30: 0.4287 - accuracy50: 0.4113 - val_loss: 12.8186 - val_accuracy10: 0.4518 - val_accuracy20: 0.4335 - val_accuracy30: 0.4164 - val_accuracy50: 0.3988 - 17s/epoch - 33ms/step
Epoch 7/50
526/526 - 18s - loss: 12.7423 - accuracy10: 0.4501 - accuracy20: 0.4345 - accuracy30: 0.4313 - accuracy50: 0.4135 - val_loss: 12.7743 - val_accuracy10: 0.4571 - val_accuracy20: 0.4386 - val_accuracy30: 0.4208 - val_accuracy50: 0.4031 - 18s/epoch - 34ms/step
Epoch 8/50
526/526 - 18s - loss: 12.7226 - accuracy10: 0.4519 - accuracy20: 0.4367 - accuracy30: 0.4332 - accuracy50: 0.4144 - val_loss: 12.7997 - val_accuracy10: 0.4533 - val_accuracy20: 0.4342 - val_accuracy30: 0.4178 - val_accuracy50: 0.4028 - 18s/epoch - 34ms/step
Epoch 9/50
526/526 - 17s - loss: 12.7090 - accuracy10: 0.4528 - accuracy20: 0.4380 - accuracy30: 0.4333 - accuracy50: 0.4162 - val_loss: 12.8053 - val_accuracy10: 0.4552 - val_accuracy20: 0.4360 - val_accuracy30: 0.4215 - val_accuracy50: 0.4036 - 17s/epoch - 32ms/step
Epoch 10/50
526/526 - 17s - loss: 12.6904 - accuracy10: 0.4551 - accuracy20: 0.4400 - accuracy30: 0.4359 - accuracy50: 0.4182 - val_loss: 12.7989 - val_accuracy10: 0.4547 - val_accuracy20: 0.4361 - val_accuracy30: 0.4217 - val_accuracy50: 0.4057 - 17s/epoch - 32ms/step
Epoch 11/50
526/526 - 17s - loss: 12.6758 - accuracy10: 0.4575 - accuracy20: 0.4422 - accuracy30: 0.4365 - accuracy50: 0.4192 - val_loss: 12.7823 - val_accuracy10: 0.4567 - val_accuracy20: 0.4371 - val_accuracy30: 0.4221 - val_accuracy50: 0.4059 - 17s/epoch - 33ms/step
Epoch 12/50
526/526 - 17s - loss: 12.6662 - accuracy10: 0.4581 - accuracy20: 0.4417 - accuracy30: 0.4366 - accuracy50: 0.4209 - val_loss: 12.7867 - val_accuracy10: 0.4575 - val_accuracy20: 0.4394 - val_accuracy30: 0.4203 - val_accuracy50: 0.4068 - 17s/epoch - 33ms/step
Epoch 13/50
526/526 - 17s - loss: 12.6497 - accuracy10: 0.4594 - accuracy20: 0.4441 - accuracy30: 0.4383 - accuracy50: 0.4224 - val_loss: 12.8135 - val_accuracy10: 0.4548 - val_accuracy20: 0.4376 - val_accuracy30: 0.4222 - val_accuracy50: 0.4038 - 17s/epoch - 33ms/step
Epoch 14/50
526/526 - 18s - loss: 12.6373 - accuracy10: 0.4605 - accuracy20: 0.4444 - accuracy30: 0.4394 - accuracy50: 0.4223 - val_loss: 12.8522 - val_accuracy10: 0.4544 - val_accuracy20: 0.4368 - val_accuracy30: 0.4197 - val_accuracy50: 0.4047 - 18s/epoch - 34ms/step
Epoch 15/50
526/526 - 17s - loss: 12.6205 - accuracy10: 0.4622 - accuracy20: 0.4471 - accuracy30: 0.4411 - accuracy50: 0.4249 - val_loss: 12.8160 - val_accuracy10: 0.4579 - val_accuracy20: 0.4378 - val_accuracy30: 0.4219 - val_accuracy50: 0.4062 - 17s/epoch - 33ms/step
Epoch 16/50
526/526 - 17s - loss: 12.6080 - accuracy10: 0.4642 - accuracy20: 0.4485 - accuracy30: 0.4420 - accuracy50: 0.4261 - val_loss: 12.7992 - val_accuracy10: 0.4592 - val_accuracy20: 0.4394 - val_accuracy30: 0.4241 - val_accuracy50: 0.4098 - 17s/epoch - 33ms/step
Epoch 17/50
526/526 - 17s - loss: 12.5899 - accuracy10: 0.4648 - accuracy20: 0.4492 - accuracy30: 0.4437 - accuracy50: 0.4277 - val_loss: 12.8565 - val_accuracy10: 0.4511 - val_accuracy20: 0.4347 - val_accuracy30: 0.4178 - val_accuracy50: 0.4029 - 17s/epoch - 33ms/step
testing model: results/PCAR/W7/deepVOL_L2/seq2seq
Evaluating performance on  test set...
1646/1646 - 25s - 25s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0550632
{'0': {'precision': 0.40365408869345876, 'recall': 0.45900648082111073, 'f1-score': 0.429554448801332, 'support': 128996}, '1': {'precision': 0.518742913044445, 'recall': 0.2891767111827224, 'f1-score': 0.3713447849147896, 'support': 161365}, '2': {'precision': 0.4109593492412508, 'recall': 0.5795881580153371, 'f1-score': 0.48092023956649876, 'support': 130924}, 'accuracy': 0.43143002955244075, 'macro avg': {'precision': 0.44445211699305154, 'recall': 0.44259045000639013, 'f1-score': 0.42727315776087343, 'support': 421285}, 'weighted avg': {'precision': 0.45000689516260917, 'recall': 0.43143002955244075, 'f1-score': 0.4232214732078187, 'support': 421285}}
[[59210 23130 46656]
 [52594 46663 62108]
 [34881 20161 75882]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0621918
{'0': {'precision': 0.39842442833240377, 'recall': 0.44683695728660894, 'f1-score': 0.4212442737682382, 'support': 127899}, '1': {'precision': 0.4954695312329425, 'recall': 0.2786194872802279, 'f1-score': 0.35667077933814806, 'support': 162896}, '2': {'precision': 0.4001438980256976, 'recall': 0.5711088972335044, 'f1-score': 0.4705793207528107, 'support': 130490}, 'accuracy': 0.4202855549093844, 'macro avg': {'precision': 0.43134595253034796, 'recall': 0.43218844726678035, 'f1-score': 0.416164791286399, 'support': 421285}, 'weighted avg': {'precision': 0.4364809285219763, 'recall': 0.4202855549093844, 'f1-score': 0.4115571648807462, 'support': 421285}}
[[57150 24861 45888]
 [51679 45386 65831]
 [34611 21355 74524]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0686969
{'0': {'precision': 0.3460418987387258, 'recall': 0.43726615569036287, 'f1-score': 0.3863420270319063, 'support': 110116}, '1': {'precision': 0.5652121649236687, 'recall': 0.26452477394541957, 'f1-score': 0.36038559488846383, 'support': 195528}, '2': {'precision': 0.3488781992435648, 'recall': 0.5751160920434794, 'f1-score': 0.4343002298610385, 'support': 115641}, 'accuracy': 0.39493217180768364, 'macro avg': {'precision': 0.42004408763531975, 'recall': 0.4256356738930873, 'f1-score': 0.39367595059380284, 'support': 421285}, 'weighted avg': {'precision': 0.44854238281314, 'recall': 0.39493217180768364, 'f1-score': 0.3874593829055326, 'support': 421285}}
[[48150 20956 41010]
 [60692 51722 83114]
 [30303 18831 66507]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0779442
{'0': {'precision': 0.36497021074784364, 'recall': 0.4038340125121965, 'f1-score': 0.3834198101273214, 'support': 121961}, '1': {'precision': 0.4842989680437168, 'recall': 0.25630316184665924, 'f1-score': 0.33520658874435627, 'support': 170470}, '2': {'precision': 0.36887619824597184, 'recall': 0.5614416316140749, 'f1-score': 0.4452294645110071, 'support': 128854}, 'accuracy': 0.39234247599605965, 'macro avg': {'precision': 0.4060484590125108, 'recall': 0.4071929353243102, 'f1-score': 0.3879519544608949, 'support': 421285}, 'weighted avg': {'precision': 0.4144504328523841, 'recall': 0.39234247599605965, 'f1-score': 0.38281573772218325, 'support': 421285}}
[[49252 24165 48544]
 [51546 43692 75232]
 [34150 22360 72344]]
Evaluating performance on  train set...
526/526 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0547665
{'0': {'precision': 0.458579945799458, 'recall': 0.4586594964980376, 'f1-score': 0.4586197176990958, 'support': 46117}, '1': {'precision': 0.4586502741906952, 'recall': 0.24260216613254112, 'f1-score': 0.31734520585670356, 'support': 42749}, '2': {'precision': 0.43191169548912134, 'recall': 0.6220098832378537, 'f1-score': 0.509816572130075, 'support': 45734}, 'accuracy': 0.44554234769687967, 'macro avg': {'precision': 0.44971397182642486, 'recall': 0.44109051528947746, 'f1-score': 0.4285938318952915, 'support': 134600}, 'weighted avg': {'precision': 0.44954102090127124, 'recall': 0.44554234769687967, 'f1-score': 0.4311464103721714, 'support': 134600}}
[[21152  6582 18383]
 [13345 10371 19033]
 [11628  5659 28447]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0643219
{'0': {'precision': 0.44941699056079953, 'recall': 0.4427789934354486, 'f1-score': 0.44607329842931936, 'support': 45700}, '1': {'precision': 0.42972128269897675, 'recall': 0.2304283943248083, 'f1-score': 0.299992527833819, 'support': 43558}, '2': {'precision': 0.4168655048476245, 'recall': 0.6087953773543293, 'f1-score': 0.4948727142344926, 'support': 45342}, 'accuracy': 0.4299851411589896, 'macro avg': {'precision': 0.43200125936913364, 'recall': 0.4273342550381954, 'f1-score': 0.413646180165877, 'support': 134600}, 'weighted avg': {'precision': 0.43207779956338455, 'recall': 0.4299851411589896, 'f1-score': 0.4152388029303547, 'support': 134600}}
[[20235  7052 18413]
 [13320 10037 20201]
 [11470  6268 27604]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.072671
{'0': {'precision': 0.43667810506436977, 'recall': 0.4189905864674946, 'f1-score': 0.42765153650972654, 'support': 45254}, '1': {'precision': 0.4196541543652467, 'recall': 0.22412433832638812, 'f1-score': 0.2921958740180604, 'support': 44395}, '2': {'precision': 0.40506010167632545, 'recall': 0.6079731262930747, 'f1-score': 0.4861946272905177, 'support': 44951}, 'accuracy': 0.41783060921248144, 'macro avg': {'precision': 0.4204641203686473, 'recall': 0.4170293503623192, 'f1-score': 0.4020140126061016, 'support': 134600}, 'weighted avg': {'precision': 0.4205039656766762, 'recall': 0.41783060921248144, 'f1-score': 0.40252535773832854, 'support': 134600}}
[[18961  7230 19063]
 [13368  9950 21077]
 [11092  6530 27329]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0820891
{'0': {'precision': 0.424279392417175, 'recall': 0.3905451823146028, 'f1-score': 0.40671397943155896, 'support': 45416}, '1': {'precision': 0.40522076498123394, 'recall': 0.2165164488508337, 'f1-score': 0.28223165376764137, 'support': 44380}, '2': {'precision': 0.3892765119712805, 'recall': 0.6002142665833408, 'f1-score': 0.4722617354196301, 'support': 44804}, 'accuracy': 0.4029569093610698, 'macro avg': {'precision': 0.40625888978989644, 'recall': 0.4024252992495924, 'f1-score': 0.3870691228729435, 'support': 134600}, 'weighted avg': {'precision': 0.40634409567791113, 'recall': 0.4029569093610698, 'f1-score': 0.38748869002832625, 'support': 134600}}
[[17737  7318 20361]
 [12942  9609 21829]
 [11126  6786 26892]]
Evaluating performance on  val set...
146/146 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0467187
{'0': {'precision': 0.4619233776387803, 'recall': 0.4641005498821681, 'f1-score': 0.46300940438871474, 'support': 12730}, '1': {'precision': 0.4542469025227646, 'recall': 0.26470076548364646, 'f1-score': 0.3344874965649904, 'support': 11496}, '2': {'precision': 0.4532422443722701, 'recall': 0.6168737138937581, 'f1-score': 0.5225475321992318, 'support': 13121}, 'accuracy': 0.45639542667416394, 'macro avg': {'precision': 0.4564708415112717, 'recall': 0.44855834308652426, 'f1-score': 0.44001481105097895, 'support': 37347}, 'weighted avg': {'precision': 0.456510522321791, 'recall': 0.45639542667416394, 'f1-score': 0.4443656558322111, 'support': 37347}}
[[5908 1994 4828]
 [3517 3043 4936]
 [3365 1662 8094]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0609478
{'0': {'precision': 0.4464513049013367, 'recall': 0.44819873791836407, 'f1-score': 0.4473233148642723, 'support': 12519}, '1': {'precision': 0.4233289646133683, 'recall': 0.24527505906176172, 'f1-score': 0.3105935146108232, 'support': 11852}, '2': {'precision': 0.4378070567217508, 'recall': 0.6043464858199753, 'f1-score': 0.5077700077700078, 'support': 12976}, 'accuracy': 0.4380539266875519, 'macro avg': {'precision': 0.43586244207881863, 'recall': 0.43260676093336703, 'f1-score': 0.4218956124150344, 'support': 37347}, 'weighted avg': {'precision': 0.43611007959619014, 'recall': 0.4380539266875519, 'f1-score': 0.4249342259023997, 'support': 37347}}
[[5611 2127 4781]
 [3656 2907 5289]
 [3301 1833 7842]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0706656
{'0': {'precision': 0.4227134522146438, 'recall': 0.41899486845320516, 'f1-score': 0.4208459461670621, 'support': 12277}, '1': {'precision': 0.4194616381171729, 'recall': 0.23620004863418984, 'f1-score': 0.30221945654428545, 'support': 12337}, '2': {'precision': 0.41785968953979485, 'recall': 0.5982879132961596, 'f1-score': 0.49205529001421006, 'support': 12733}, 'accuracy': 0.41973920261332903, 'macro avg': {'precision': 0.4200115932905372, 'recall': 0.4178276101278515, 'f1-score': 0.4050402309085192, 'support': 37347}, 'weighted avg': {'precision': 0.41998443540849206, 'recall': 0.41973920261332903, 'f1-score': 0.40593748157096443, 'support': 37347}}
[[5144 2136 4997]
 [3807 2914 5616]
 [3218 1897 7618]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0809574
{'0': {'precision': 0.4099320882852292, 'recall': 0.3976776743803014, 'f1-score': 0.4037119090415082, 'support': 12143}, '1': {'precision': 0.4152334152334152, 'recall': 0.22841469231992367, 'f1-score': 0.29471200697543215, 'support': 12578}, '2': {'precision': 0.3951630201630202, 'recall': 0.5836369396483447, 'f1-score': 0.47125407686896464, 'support': 12626}, 'accuracy': 0.4035397756178542, 'macro avg': {'precision': 0.40677617456055487, 'recall': 0.40324310211618997, 'f1-score': 0.3898926642953016, 'support': 37347}, 'weighted avg': {'precision': 0.40672449025173985, 'recall': 0.4035397756178542, 'f1-score': 0.38983627359026346, 'support': 37347}}
[[4829 2049 5265]
 [3691 2873 6014]
 [3260 1997 7369]]
training model: results/PCAR/W7/deepVOL_L3/seq2seq
Epoch 1/50
526/526 - 30s - loss: 13.2301 - accuracy10: 0.3628 - accuracy20: 0.3599 - accuracy30: 0.3632 - accuracy50: 0.3551 - val_loss: 13.1365 - val_accuracy10: 0.3732 - val_accuracy20: 0.3644 - val_accuracy30: 0.3580 - val_accuracy50: 0.3521 - 30s/epoch - 56ms/step
Epoch 2/50
526/526 - 24s - loss: 13.0835 - accuracy10: 0.3862 - accuracy20: 0.3803 - accuracy30: 0.3818 - accuracy50: 0.3702 - val_loss: 12.9681 - val_accuracy10: 0.4241 - val_accuracy20: 0.4097 - val_accuracy30: 0.3994 - val_accuracy50: 0.3876 - 24s/epoch - 46ms/step
Epoch 3/50
526/526 - 24s - loss: 12.9573 - accuracy10: 0.4157 - accuracy20: 0.4065 - accuracy30: 0.4041 - accuracy50: 0.3906 - val_loss: 12.8481 - val_accuracy10: 0.4472 - val_accuracy20: 0.4276 - val_accuracy30: 0.4133 - val_accuracy50: 0.3991 - 24s/epoch - 45ms/step
Epoch 4/50
526/526 - 23s - loss: 12.8656 - accuracy10: 0.4336 - accuracy20: 0.4184 - accuracy30: 0.4156 - accuracy50: 0.3998 - val_loss: 12.8626 - val_accuracy10: 0.4463 - val_accuracy20: 0.4270 - val_accuracy30: 0.4105 - val_accuracy50: 0.3945 - 23s/epoch - 44ms/step
Epoch 5/50
526/526 - 24s - loss: 12.8273 - accuracy10: 0.4382 - accuracy20: 0.4223 - accuracy30: 0.4195 - accuracy50: 0.4030 - val_loss: 12.8804 - val_accuracy10: 0.4414 - val_accuracy20: 0.4240 - val_accuracy30: 0.4083 - val_accuracy50: 0.3893 - 24s/epoch - 45ms/step
Epoch 6/50
526/526 - 24s - loss: 12.7865 - accuracy10: 0.4443 - accuracy20: 0.4282 - accuracy30: 0.4250 - accuracy50: 0.4092 - val_loss: 12.8788 - val_accuracy10: 0.4461 - val_accuracy20: 0.4269 - val_accuracy30: 0.4097 - val_accuracy50: 0.3918 - 24s/epoch - 45ms/step
Epoch 7/50
526/526 - 24s - loss: 12.7618 - accuracy10: 0.4461 - accuracy20: 0.4300 - accuracy30: 0.4273 - accuracy50: 0.4125 - val_loss: 12.8472 - val_accuracy10: 0.4469 - val_accuracy20: 0.4278 - val_accuracy30: 0.4122 - val_accuracy50: 0.3948 - 24s/epoch - 45ms/step
Epoch 8/50
526/526 - 23s - loss: 12.7322 - accuracy10: 0.4517 - accuracy20: 0.4350 - accuracy30: 0.4310 - accuracy50: 0.4137 - val_loss: 12.8056 - val_accuracy10: 0.4547 - val_accuracy20: 0.4336 - val_accuracy30: 0.4188 - val_accuracy50: 0.3994 - 23s/epoch - 44ms/step
Epoch 9/50
526/526 - 23s - loss: 12.7088 - accuracy10: 0.4529 - accuracy20: 0.4366 - accuracy30: 0.4319 - accuracy50: 0.4169 - val_loss: 12.8013 - val_accuracy10: 0.4558 - val_accuracy20: 0.4345 - val_accuracy30: 0.4162 - val_accuracy50: 0.3959 - 23s/epoch - 45ms/step
Epoch 10/50
526/526 - 23s - loss: 12.6886 - accuracy10: 0.4543 - accuracy20: 0.4385 - accuracy30: 0.4340 - accuracy50: 0.4194 - val_loss: 12.7961 - val_accuracy10: 0.4533 - val_accuracy20: 0.4344 - val_accuracy30: 0.4179 - val_accuracy50: 0.3985 - 23s/epoch - 44ms/step
Epoch 11/50
526/526 - 23s - loss: 12.6740 - accuracy10: 0.4563 - accuracy20: 0.4403 - accuracy30: 0.4362 - accuracy50: 0.4192 - val_loss: 12.8104 - val_accuracy10: 0.4565 - val_accuracy20: 0.4354 - val_accuracy30: 0.4163 - val_accuracy50: 0.3987 - 23s/epoch - 44ms/step
Epoch 12/50
526/526 - 23s - loss: 12.6593 - accuracy10: 0.4590 - accuracy20: 0.4420 - accuracy30: 0.4378 - accuracy50: 0.4223 - val_loss: 12.7930 - val_accuracy10: 0.4575 - val_accuracy20: 0.4378 - val_accuracy30: 0.4191 - val_accuracy50: 0.4000 - 23s/epoch - 45ms/step
Epoch 13/50
526/526 - 24s - loss: 12.6468 - accuracy10: 0.4595 - accuracy20: 0.4437 - accuracy30: 0.4395 - accuracy50: 0.4234 - val_loss: 12.8184 - val_accuracy10: 0.4555 - val_accuracy20: 0.4332 - val_accuracy30: 0.4168 - val_accuracy50: 0.3972 - 24s/epoch - 45ms/step
Epoch 14/50
526/526 - 23s - loss: 12.6346 - accuracy10: 0.4606 - accuracy20: 0.4444 - accuracy30: 0.4395 - accuracy50: 0.4231 - val_loss: 12.8408 - val_accuracy10: 0.4556 - val_accuracy20: 0.4351 - val_accuracy30: 0.4164 - val_accuracy50: 0.3992 - 23s/epoch - 44ms/step
Epoch 15/50
526/526 - 23s - loss: 12.6142 - accuracy10: 0.4622 - accuracy20: 0.4469 - accuracy30: 0.4422 - accuracy50: 0.4253 - val_loss: 12.8188 - val_accuracy10: 0.4561 - val_accuracy20: 0.4348 - val_accuracy30: 0.4197 - val_accuracy50: 0.4009 - 23s/epoch - 43ms/step
Epoch 16/50
526/526 - 23s - loss: 12.5992 - accuracy10: 0.4626 - accuracy20: 0.4466 - accuracy30: 0.4417 - accuracy50: 0.4262 - val_loss: 12.8377 - val_accuracy10: 0.4566 - val_accuracy20: 0.4377 - val_accuracy30: 0.4183 - val_accuracy50: 0.4003 - 23s/epoch - 44ms/step
Epoch 17/50
526/526 - 23s - loss: 12.5890 - accuracy10: 0.4650 - accuracy20: 0.4495 - accuracy30: 0.4433 - accuracy50: 0.4275 - val_loss: 12.8350 - val_accuracy10: 0.4580 - val_accuracy20: 0.4382 - val_accuracy30: 0.4190 - val_accuracy50: 0.4013 - 23s/epoch - 44ms/step
Epoch 18/50
526/526 - 23s - loss: 12.5720 - accuracy10: 0.4655 - accuracy20: 0.4510 - accuracy30: 0.4464 - accuracy50: 0.4301 - val_loss: 12.8536 - val_accuracy10: 0.4567 - val_accuracy20: 0.4371 - val_accuracy30: 0.4195 - val_accuracy50: 0.4018 - 23s/epoch - 44ms/step
Epoch 19/50
526/526 - 23s - loss: 12.5679 - accuracy10: 0.4657 - accuracy20: 0.4518 - accuracy30: 0.4471 - accuracy50: 0.4298 - val_loss: 12.8663 - val_accuracy10: 0.4533 - val_accuracy20: 0.4321 - val_accuracy30: 0.4151 - val_accuracy50: 0.3975 - 23s/epoch - 45ms/step
Epoch 20/50
526/526 - 23s - loss: 12.5514 - accuracy10: 0.4671 - accuracy20: 0.4522 - accuracy30: 0.4484 - accuracy50: 0.4305 - val_loss: 12.8505 - val_accuracy10: 0.4568 - val_accuracy20: 0.4353 - val_accuracy30: 0.4163 - val_accuracy50: 0.3988 - 23s/epoch - 44ms/step
Epoch 21/50
526/526 - 24s - loss: 12.5288 - accuracy10: 0.4692 - accuracy20: 0.4556 - accuracy30: 0.4506 - accuracy50: 0.4349 - val_loss: 12.8355 - val_accuracy10: 0.4584 - val_accuracy20: 0.4351 - val_accuracy30: 0.4147 - val_accuracy50: 0.4000 - 24s/epoch - 45ms/step
Epoch 22/50
526/526 - 24s - loss: 12.5270 - accuracy10: 0.4693 - accuracy20: 0.4560 - accuracy30: 0.4502 - accuracy50: 0.4327 - val_loss: 12.8705 - val_accuracy10: 0.4557 - val_accuracy20: 0.4352 - val_accuracy30: 0.4175 - val_accuracy50: 0.4010 - 24s/epoch - 45ms/step
testing model: results/PCAR/W7/deepVOL_L3/seq2seq
Evaluating performance on  test set...
1646/1646 - 35s - 35s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0539807
{'0': {'precision': 0.41577905420477357, 'recall': 0.46238643058699497, 'f1-score': 0.43784593249453113, 'support': 128996}, '1': {'precision': 0.5515378111293135, 'recall': 0.2587116165215505, 'f1-score': 0.3522106497593406, 'support': 161365}, '2': {'precision': 0.4082577657727185, 'recall': 0.630319880235862, 'f1-score': 0.49554886342141535, 'support': 130924}, 'accuracy': 0.43656194737529225, 'macro avg': {'precision': 0.45852487703560185, 'recall': 0.45047264244813584, 'f1-score': 0.428535148558429, 'support': 421285}, 'weighted avg': {'precision': 0.46544138408703856, 'recall': 0.43656194737529225, 'f1-score': 0.42297752068330446, 'support': 421285}}
[[59646 18220 51130]
 [51135 41747 68483]
 [32675 15725 82524]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0621516
{'0': {'precision': 0.41127126140104114, 'recall': 0.4435140227836027, 'f1-score': 0.4267845387002727, 'support': 127899}, '1': {'precision': 0.5368488187480494, 'recall': 0.24286661428150477, 'f1-score': 0.33443651226388377, 'support': 162896}, '2': {'precision': 0.39576278461934694, 'recall': 0.6358954709173117, 'f1-score': 0.4878820305977257, 'support': 130490}, 'accuracy': 0.4255195414030882, 'macro avg': {'precision': 0.4479609549228125, 'recall': 0.44075870266080636, 'f1-score': 0.4163676938539607, 'support': 421285}, 'weighted avg': {'precision': 0.455024019382823, 'recall': 0.4255195414030882, 'f1-score': 0.4100013339892496, 'support': 421285}}
[[56725 18405 52769]
 [49415 39562 73919]
 [31786 15726 82978]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0733954
{'0': {'precision': 0.3583851826028965, 'recall': 0.4294562098151041, 'f1-score': 0.39071504405768603, 'support': 110116}, '1': {'precision': 0.607839110673019, 'recall': 0.2270723374657338, 'f1-score': 0.3306301475954307, 'support': 195528}, '2': {'precision': 0.34403203136558663, 'recall': 0.6434569054228172, 'f1-score': 0.44834889388995836, 'support': 115641}, 'accuracy': 0.3942675386021339, 'macro avg': {'precision': 0.4367521082138341, 'recall': 0.43332848423455167, 'f1-score': 0.38989802851435834, 'support': 421285}, 'weighted avg': {'precision': 0.47022257269620904, 'recall': 0.3942675386021339, 'f1-score': 0.37864852470138793, 'support': 421285}}
[[47290 15216 47610]
 [56861 44399 94268]
 [27802 13429 74410]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0793316
{'0': {'precision': 0.37406519089372076, 'recall': 0.3900263198891449, 'f1-score': 0.38187904915584886, 'support': 121961}, '1': {'precision': 0.5217819210738549, 'recall': 0.22392209772980584, 'f1-score': 0.31336428228398333, 'support': 170470}, '2': {'precision': 0.3670524024384173, 'recall': 0.6294333121206948, 'f1-score': 0.463699591500699, 'support': 128854}, 'accuracy': 0.3960383113569199, 'macro avg': {'precision': 0.42096650480199765, 'recall': 0.41446057657988183, 'f1-score': 0.38631430764684377, 'support': 421285}, 'weighted avg': {'precision': 0.4316927948914605, 'recall': 0.3960383113569199, 'f1-score': 0.3791806190067963, 'support': 421285}}
[[47568 18613 55780]
 [48220 38172 84078]
 [31377 16372 81105]]
Evaluating performance on  train set...
526/526 - 11s - 11s/epoch - 22ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0528916
{'0': {'precision': 0.4657039711191336, 'recall': 0.46713793178220614, 'f1-score': 0.4664198493115095, 'support': 46117}, '1': {'precision': 0.4951817020782538, 'recall': 0.19953683127090693, 'f1-score': 0.2844518549395581, 'support': 42749}, '2': {'precision': 0.427476622372214, 'recall': 0.6647133423711025, 'f1-score': 0.5203296562229887, 'support': 45734}, 'accuracy': 0.4492793462109955, 'macro avg': {'precision': 0.46278743185653376, 'recall': 0.4437960351414052, 'f1-score': 0.4237337868246854, 'support': 134600}, 'weighted avg': {'precision': 0.46207732886935504, 'recall': 0.4492793462109955, 'f1-score': 0.42694407901346365, 'support': 134600}}
[[21543  4774 19800]
 [13304  8530 20915]
 [11412  3922 30400]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0645998
{'0': {'precision': 0.45620338983050845, 'recall': 0.44172866520787746, 'f1-score': 0.44884936075597553, 'support': 45700}, '1': {'precision': 0.4639980910338245, 'recall': 0.17856650902245283, 'f1-score': 0.257886971369838, 'support': 43558}, '2': {'precision': 0.4118254583010586, 'recall': 0.66836487142164, 'f1-score': 0.509631797122653, 'support': 45342}, 'accuracy': 0.43291233283803865, 'macro avg': {'precision': 0.4440089797217972, 'recall': 0.4295533485506568, 'f1-score': 0.40545604308282224, 'support': 134600}, 'weighted avg': {'precision': 0.44377647618716315, 'recall': 0.43291233283803865, 'f1-score': 0.4075273508960685, 'support': 134600}}
[[20187  4901 20612]
 [13110  7778 22670]
 [10953  4084 30305]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.072958
{'0': {'precision': 0.44332882337582186, 'recall': 0.412714898130552, 'f1-score': 0.42747445155236147, 'support': 45254}, '1': {'precision': 0.4524838012958963, 'recall': 0.16988399594548936, 'f1-score': 0.24702356582545895, 'support': 44395}, '2': {'precision': 0.3994828700711054, 'recall': 0.6736668817156459, 'f1-score': 0.50154860294483, 'support': 44951}, 'accuracy': 0.4197696879643388, 'macro avg': {'precision': 0.43176516491427447, 'recall': 0.4187552585972291, 'f1-score': 0.3920155401075502, 'support': 134600}, 'weighted avg': {'precision': 0.431705612363648, 'recall': 0.4197696879643388, 'f1-score': 0.3926942889030079, 'support': 134600}}
[[18677  4940 21637]
 [12969  7542 23884]
 [10483  4186 30282]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0821422
{'0': {'precision': 0.42619071097524897, 'recall': 0.38065879866126473, 'f1-score': 0.40214003256571296, 'support': 45416}, '1': {'precision': 0.43290687295447783, 'recall': 0.16392519152771517, 'f1-score': 0.23780338318215247, 'support': 44380}, '2': {'precision': 0.3852339086636195, 'recall': 0.6640478528702795, 'f1-score': 0.48759782029745563, 'support': 44804}, 'accuracy': 0.4035289747399703, 'macro avg': {'precision': 0.41477716419778216, 'recall': 0.4028772810197531, 'f1-score': 0.37584707868177364, 'support': 134600}, 'weighted avg': {'precision': 0.4147719494438072, 'recall': 0.4035289747399703, 'f1-score': 0.37640147552180947, 'support': 134600}}
[[17288  5138 22990]
 [12616  7275 24489]
 [10660  4392 29752]]
Evaluating performance on  val set...
146/146 - 3s - 3s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.045851
{'0': {'precision': 0.4672105428302479, 'recall': 0.4678711704634721, 'f1-score': 0.4675406232828323, 'support': 12730}, '1': {'precision': 0.48145330036142286, 'recall': 0.22016353514265832, 'f1-score': 0.3021548379394735, 'support': 11496}, '2': {'precision': 0.4473167200909937, 'recall': 0.6594009602926606, 'f1-score': 0.5330376120506423, 'support': 13121}, 'accuracy': 0.4589123624387501, 'macro avg': {'precision': 0.46532685442755484, 'recall': 0.4491452219662637, 'f1-score': 0.43424435775764936, 'support': 37347}, 'weighted avg': {'precision': 0.4646054578814336, 'recall': 0.4589123624387501, 'f1-score': 0.43964309473476104, 'support': 37347}}
[[5956 1532 5242]
 [3517 2531 5448]
 [3275 1194 8652]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0620543
{'0': {'precision': 0.4503403592225047, 'recall': 0.43861330777218627, 'f1-score': 0.44439948203302043, 'support': 12519}, '1': {'precision': 0.4539551357733176, 'recall': 0.19465069186635167, 'f1-score': 0.2724695878115035, 'support': 11852}, '2': {'precision': 0.42890593862096454, 'recall': 0.6634556103575833, 'f1-score': 0.5209997579278625, 'support': 12976}, 'accuracy': 0.43931239456984494, 'macro avg': {'precision': 0.4444004778722623, 'recall': 0.43223986999870706, 'f1-score': 0.41262294259079546, 'support': 37347}, 'weighted avg': {'precision': 0.4440402357843343, 'recall': 0.43931239456984494, 'f1-score': 0.41645217900193493, 'support': 37347}}
[[5491 1534 5494]
 [3576 2307 5969]
 [3126 1241 8609]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0727073
{'0': {'precision': 0.42892703862660947, 'recall': 0.4070212592652928, 'f1-score': 0.41768713169223054, 'support': 12277}, '1': {'precision': 0.45434432823813353, 'recall': 0.18310772473048553, 'f1-score': 0.2610202784678491, 'support': 12337}, '2': {'precision': 0.4083956574185766, 'recall': 0.6647294431791408, 'f1-score': 0.5059477553948234, 'support': 12733}, 'accuracy': 0.4209173427584545, 'macro avg': {'precision': 0.4305556747611065, 'recall': 0.41828614239163975, 'f1-score': 0.39488505518496764, 'support': 37347}, 'weighted avg': {'precision': 0.4303233227997824, 'recall': 0.4209173427584545, 'f1-score': 0.396026049232486, 'support': 37347}}
[[4997 1475 5805]
 [3622 2259 6456]
 [3031 1238 8464]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.082237
{'0': {'precision': 0.41080167274668566, 'recall': 0.3802190562463971, 'f1-score': 0.39491916859122406, 'support': 12143}, '1': {'precision': 0.4406060606060606, 'recall': 0.17339799650182858, 'f1-score': 0.24885896850753078, 'support': 12578}, '2': {'precision': 0.3881274222516306, 'recall': 0.6504039284017108, 'f1-score': 0.4861472886573526, 'support': 12626}, 'accuracy': 0.4019064449621121, 'macro avg': {'precision': 0.413178385201459, 'recall': 0.40134032704997885, 'f1-score': 0.37664180858536916, 'support': 37347}, 'weighted avg': {'precision': 0.41317387141711837, 'recall': 0.4019064449621121, 'f1-score': 0.3765696638733684, 'support': 37347}}
[[4617 1423 6103]
 [3554 2181 6843]
 [3068 1346 8212]]
training model: results/PCAR/W8/deepLOB_L1/seq2seq
Epoch 1/50
494/494 - 21s - loss: 13.0097 - accuracy10: 0.4052 - accuracy20: 0.3991 - accuracy30: 0.3932 - accuracy50: 0.3903 - val_loss: 13.5150 - val_accuracy10: 0.3339 - val_accuracy20: 0.3423 - val_accuracy30: 0.3351 - val_accuracy50: 0.3435 - 21s/epoch - 42ms/step
Epoch 2/50
494/494 - 14s - loss: 13.0123 - accuracy10: 0.4043 - accuracy20: 0.3994 - accuracy30: 0.3894 - accuracy50: 0.3834 - val_loss: 13.0990 - val_accuracy10: 0.3851 - val_accuracy20: 0.3789 - val_accuracy30: 0.3763 - val_accuracy50: 0.3641 - 14s/epoch - 29ms/step
Epoch 3/50
494/494 - 14s - loss: 12.9805 - accuracy10: 0.4126 - accuracy20: 0.4036 - accuracy30: 0.3928 - accuracy50: 0.3858 - val_loss: 13.0365 - val_accuracy10: 0.4031 - val_accuracy20: 0.3935 - val_accuracy30: 0.3793 - val_accuracy50: 0.3667 - 14s/epoch - 29ms/step
Epoch 4/50
494/494 - 15s - loss: 12.9210 - accuracy10: 0.4216 - accuracy20: 0.4095 - accuracy30: 0.3996 - accuracy50: 0.3896 - val_loss: 13.0073 - val_accuracy10: 0.4076 - val_accuracy20: 0.3988 - val_accuracy30: 0.3881 - val_accuracy50: 0.3746 - 15s/epoch - 29ms/step
Epoch 5/50
494/494 - 15s - loss: 12.8931 - accuracy10: 0.4295 - accuracy20: 0.4181 - accuracy30: 0.4056 - accuracy50: 0.3928 - val_loss: 13.0750 - val_accuracy10: 0.3899 - val_accuracy20: 0.3837 - val_accuracy30: 0.3732 - val_accuracy50: 0.3654 - 15s/epoch - 30ms/step
Epoch 6/50
494/494 - 14s - loss: 12.8382 - accuracy10: 0.4364 - accuracy20: 0.4242 - accuracy30: 0.4130 - accuracy50: 0.3992 - val_loss: 13.1210 - val_accuracy10: 0.3773 - val_accuracy20: 0.3692 - val_accuracy30: 0.3620 - val_accuracy50: 0.3538 - 14s/epoch - 28ms/step
Epoch 7/50
494/494 - 14s - loss: 12.8249 - accuracy10: 0.4360 - accuracy20: 0.4238 - accuracy30: 0.4134 - accuracy50: 0.3998 - val_loss: 13.1020 - val_accuracy10: 0.3842 - val_accuracy20: 0.3785 - val_accuracy30: 0.3671 - val_accuracy50: 0.3597 - 14s/epoch - 28ms/step
Epoch 8/50
494/494 - 14s - loss: 12.8008 - accuracy10: 0.4397 - accuracy20: 0.4290 - accuracy30: 0.4160 - accuracy50: 0.4016 - val_loss: 13.0986 - val_accuracy10: 0.3927 - val_accuracy20: 0.3840 - val_accuracy30: 0.3741 - val_accuracy50: 0.3631 - 14s/epoch - 28ms/step
Epoch 9/50
494/494 - 13s - loss: 12.7430 - accuracy10: 0.4454 - accuracy20: 0.4334 - accuracy30: 0.4221 - accuracy50: 0.4069 - val_loss: 13.1272 - val_accuracy10: 0.3851 - val_accuracy20: 0.3757 - val_accuracy30: 0.3662 - val_accuracy50: 0.3592 - 13s/epoch - 27ms/step
Epoch 10/50
494/494 - 14s - loss: 12.7012 - accuracy10: 0.4488 - accuracy20: 0.4366 - accuracy30: 0.4248 - accuracy50: 0.4125 - val_loss: 13.1602 - val_accuracy10: 0.3813 - val_accuracy20: 0.3707 - val_accuracy30: 0.3639 - val_accuracy50: 0.3551 - 14s/epoch - 28ms/step
Epoch 11/50
494/494 - 14s - loss: 12.6638 - accuracy10: 0.4529 - accuracy20: 0.4389 - accuracy30: 0.4267 - accuracy50: 0.4146 - val_loss: 13.1309 - val_accuracy10: 0.3853 - val_accuracy20: 0.3733 - val_accuracy30: 0.3636 - val_accuracy50: 0.3554 - 14s/epoch - 28ms/step
Epoch 12/50
494/494 - 14s - loss: 12.6272 - accuracy10: 0.4576 - accuracy20: 0.4440 - accuracy30: 0.4318 - accuracy50: 0.4197 - val_loss: 13.1405 - val_accuracy10: 0.3792 - val_accuracy20: 0.3708 - val_accuracy30: 0.3627 - val_accuracy50: 0.3515 - 14s/epoch - 28ms/step
Epoch 13/50
494/494 - 14s - loss: 12.6045 - accuracy10: 0.4576 - accuracy20: 0.4449 - accuracy30: 0.4321 - accuracy50: 0.4185 - val_loss: 13.1523 - val_accuracy10: 0.3784 - val_accuracy20: 0.3697 - val_accuracy30: 0.3645 - val_accuracy50: 0.3568 - 14s/epoch - 28ms/step
Epoch 14/50
494/494 - 14s - loss: 12.5824 - accuracy10: 0.4607 - accuracy20: 0.4470 - accuracy30: 0.4351 - accuracy50: 0.4220 - val_loss: 13.1437 - val_accuracy10: 0.3857 - val_accuracy20: 0.3746 - val_accuracy30: 0.3680 - val_accuracy50: 0.3555 - 14s/epoch - 28ms/step
testing model: results/PCAR/W8/deepLOB_L1/seq2seq
Evaluating performance on  test set...
1443/1443 - 20s - 20s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.073343
{'0': {'precision': 0.43513417987775965, 'recall': 0.4125002043051174, 'f1-score': 0.4235149999790239, 'support': 122366}, '1': {'precision': 0.41650399479450007, 'recall': 0.3144078783145045, 'f1-score': 0.35832537992805225, 'support': 124189}, '2': {'precision': 0.4146287922026606, 'recall': 0.5390762606823668, 'f1-score': 0.46873304948044997, 'support': 122632}, 'accuracy': 0.4215478876558492, 'macro avg': {'precision': 0.42208898895830677, 'recall': 0.42199478110066285, 'f1-score': 0.416857809795842, 'support': 369187}, 'weighted avg': {'precision': 0.4220560358567685, 'recall': 0.4215478876558492, 'f1-score': 0.4166061600739047, 'support': 369187}}
[[50476 24980 46910]
 [38722 39046 46421]
 [26803 29721 66108]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0776749
{'0': {'precision': 0.4194692377859049, 'recall': 0.41028441828081613, 'f1-score': 0.41482599312065827, 'support': 119929}, '1': {'precision': 0.4061868686868687, 'recall': 0.30277884532427707, 'f1-score': 0.3469414349844297, 'support': 127499}, '2': {'precision': 0.4000726836857004, 'recall': 0.5153541011342078, 'f1-score': 0.45045458950549705, 'support': 121759}, 'accuracy': 0.4078095924287692, 'macro avg': {'precision': 0.40857626338615805, 'recall': 0.4094724549131003, 'f1-score': 0.404074005870195, 'support': 369187}, 'weighted avg': {'precision': 0.40848511914563634, 'recall': 0.4078095924287692, 'f1-score': 0.40313243129267023, 'support': 369187}}
[[49205 25570 45154]
 [39954 38604 48941]
 [28144 30866 62749]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0839792
{'0': {'precision': 0.41210785695373287, 'recall': 0.3985495275226327, 'f1-score': 0.40521531000020994, 'support': 121064}, '1': {'precision': 0.37910418115006456, 'recall': 0.3091150557139155, 'f1-score': 0.3405508123009394, 'support': 123488}, '2': {'precision': 0.3971641041897818, 'recall': 0.4825049143499017, 'f1-score': 0.435694853487218, 'support': 124635}, 'accuracy': 0.39697768339621925, 'macro avg': {'precision': 0.3961253807645264, 'recall': 0.39672316586214995, 'f1-score': 0.39382032526278915, 'support': 369187}, 'weighted avg': {'precision': 0.3960236705024807, 'recall': 0.39697768339621925, 'f1-score': 0.3938756052181232, 'support': 369187}}
[[48250 28116 44698]
 [38735 38172 46581]
 [30096 34402 60137]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0913441
{'0': {'precision': 0.38520998387436023, 'recall': 0.36500581298787577, 'f1-score': 0.3748358376967815, 'support': 120420}, '1': {'precision': 0.36337577911524654, 'recall': 0.3250265577201096, 'f1-score': 0.34313299744924847, 'support': 125199}, '2': {'precision': 0.3801407436913422, 'recall': 0.4402191505891493, 'f1-score': 0.4079800498753117, 'support': 123568}, 'accuracy': 0.37662214541682126, 'macro avg': {'precision': 0.3762421688936497, 'recall': 0.3767505070990449, 'f1-score': 0.3753162950071139, 'support': 369187}, 'weighted avg': {'precision': 0.3761088603988006, 'recall': 0.37662214541682126, 'f1-score': 0.37517821192535866, 'support': 369187}}
[[43954 33201 43265]
 [39071 40693 45435]
 [31079 38092 54397]]
Evaluating performance on  train set...
494/494 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0779488
{'0': {'precision': 0.44385425403037926, 'recall': 0.3405142625646403, 'f1-score': 0.38537677328874265, 'support': 41963}, '1': {'precision': 0.3795434354358994, 'recall': 0.4717687728058383, 'f1-score': 0.4206605732388638, 'support': 41656}, '2': {'precision': 0.4216819073273316, 'recall': 0.418203547910857, 'f1-score': 0.4199355248605784, 'support': 42673}, 'accuracy': 0.41005764418965573, 'macro avg': {'precision': 0.41502653226453673, 'recall': 0.4101621944271119, 'f1-score': 0.4086576237960616, 'support': 126292}, 'weighted avg': {'precision': 0.41515020301977834, 'recall': 0.41005764418965573, 'f1-score': 0.4086918492757189, 'support': 126292}}
[[14289 15060 12614]
 [10143 19652 11861]
 [ 7761 17066 17846]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0827705
{'0': {'precision': 0.4272830107921367, 'recall': 0.3358323721645521, 'f1-score': 0.3760780356542213, 'support': 41616}, '1': {'precision': 0.3699619771863118, 'recall': 0.4644613108024249, 'f1-score': 0.41186056847763974, 'support': 41898}, '2': {'precision': 0.4085596466827709, 'recall': 0.3914161484875403, 'f1-score': 0.3998042048208593, 'support': 42778}, 'accuracy': 0.39733316441263106, 'macro avg': {'precision': 0.4019348782204064, 'recall': 0.3972366104848391, 'f1-score': 0.3959142696509068, 'support': 126292}, 'weighted avg': {'precision': 0.4019244391020272, 'recall': 0.39733316441263106, 'f1-score': 0.3959856673715591, 'support': 126292}}
[[13976 15374 12266]
 [10465 19460 11973]
 [ 8268 17766 16744]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.086423
{'0': {'precision': 0.41558678590983755, 'recall': 0.32848452790267124, 'f1-score': 0.3669374874101927, 'support': 41591}, '1': {'precision': 0.3612878525459882, 'recall': 0.4743405620182871, 'f1-score': 0.410166720135777, 'support': 41778}, '2': {'precision': 0.4020535691134908, 'recall': 0.3612515434615474, 'f1-score': 0.3805620321511841, 'support': 42923}, 'accuracy': 0.3878709656985399, 'macro avg': {'precision': 0.3929760691897722, 'recall': 0.3880255444608352, 'f1-score': 0.385888746565718, 'support': 126292}, 'weighted avg': {'precision': 0.39302488885678205, 'recall': 0.3878709656985399, 'f1-score': 0.38586851406846906, 'support': 126292}}
[[13662 16274 11655]
 [10555 19817 11406]
 [ 8657 18760 15506]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0912944
{'0': {'precision': 0.39468055426392634, 'recall': 0.3057930636948794, 'f1-score': 0.34459706340077134, 'support': 41636}, '1': {'precision': 0.357981220657277, 'recall': 0.50123850807412, 'f1-score': 0.41766725544287214, 'support': 41986}, '2': {'precision': 0.3880266704497092, 'recall': 0.3205062104523084, 'f1-score': 0.3510492203041776, 'support': 42670}, 'accuracy': 0.3757403477654958, 'macro avg': {'precision': 0.3802294817903042, 'recall': 0.3758459274071026, 'f1-score': 0.3711045130492738, 'support': 126292}, 'weighted avg': {'precision': 0.3802316624642761, 'recall': 0.3757403477654958, 'f1-score': 0.3710693547426457, 'support': 126292}}
[[12732 17814 11090]
 [10462 21045 10479]
 [ 9065 19929 13676]]
Evaluating performance on  val set...
150/150 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0780444
{'0': {'precision': 0.4373603455980932, 'recall': 0.45462991638278105, 'f1-score': 0.44582795535646497, 'support': 12916}, '1': {'precision': 0.37663509246729815, 'recall': 0.45871919635849945, 'f1-score': 0.4136442447188705, 'support': 12742}, '2': {'precision': 0.4156253395631859, 'recall': 0.30624499599679744, 'f1-score': 0.3526483197344766, 'support': 12490}, 'accuracy': 0.40741323267274826, 'macro avg': {'precision': 0.4098735925428591, 'recall': 0.4065313695793593, 'f1-score': 0.4040401732699373, 'support': 38148}, 'weighted avg': {'precision': 0.40996096946386384, 'recall': 0.40741323267274826, 'f1-score': 0.40457026190299783, 'support': 38148}}
[[5872 4470 2574]
 [4093 5845 2804]
 [3461 5204 3825]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0820521
{'0': {'precision': 0.4252729418707583, 'recall': 0.4509543178973717, 'f1-score': 0.43773728170083526, 'support': 12784}, '1': {'precision': 0.37723128290740976, 'recall': 0.4500191497510532, 'f1-score': 0.4104229976597157, 'support': 13055}, '2': {'precision': 0.4008649367930805, 'recall': 0.29368754569826955, 'f1-score': 0.3390068926712618, 'support': 12309}, 'accuracy': 0.3998899024850582, 'macro avg': {'precision': 0.40112305385708286, 'recall': 0.3982203377822315, 'f1-score': 0.3957223906772709, 'support': 38148}, 'weighted avg': {'precision': 0.4009565427864642, 'recall': 0.3998899024850582, 'f1-score': 0.39653301577020095, 'support': 38148}}
[[5765 4516 2503]
 [4280 5875 2900]
 [3511 5183 3615]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0874511
{'0': {'precision': 0.41579455206709715, 'recall': 0.4342299046585536, 'f1-score': 0.4248123151588686, 'support': 12901}, '1': {'precision': 0.3594852122262096, 'recall': 0.45618718592964824, 'f1-score': 0.40210395183057657, 'support': 12736}, '2': {'precision': 0.39257606014331026, 'recall': 0.26712493006154586, 'f1-score': 0.3179223744292238, 'support': 12511}, 'accuracy': 0.3867568417741428, 'macro avg': {'precision': 0.3892852748122057, 'recall': 0.38584734021658257, 'f1-score': 0.3816128804728896, 'support': 38148}, 'weighted avg': {'precision': 0.38938052499694825, 'recall': 0.3867568417741428, 'f1-score': 0.3821753810124464, 'support': 38148}}
[[5602 4827 2472]
 [4227 5810 2699]
 [3644 5525 3342]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0903633
{'0': {'precision': 0.3896472392638037, 'recall': 0.4041842335534166, 'f1-score': 0.39678263246261375, 'support': 12571}, '1': {'precision': 0.36307089788631, 'recall': 0.4767090139140956, 'f1-score': 0.4122012619740413, 'support': 13224}, '2': {'precision': 0.37430600387346674, 'recall': 0.23467983485792926, 'f1-score': 0.28848641655886154, 'support': 12353}, 'accuracy': 0.37443640557827407, 'macro avg': {'precision': 0.3756747136745268, 'recall': 0.3718576941084805, 'f1-score': 0.36582343699850545, 'support': 38148}, 'weighted avg': {'precision': 0.3754667889347482, 'recall': 0.37443640557827407, 'f1-score': 0.36705926037495695, 'support': 38148}}
[[5081 5225 2265]
 [4339 6304 2581]
 [3620 5834 2899]]
training model: results/PCAR/W8/deepOF_L1/seq2seq
Epoch 1/50
494/494 - 22s - loss: 13.0635 - accuracy10: 0.3951 - accuracy20: 0.3918 - accuracy30: 0.3856 - accuracy50: 0.3820 - val_loss: 13.0853 - val_accuracy10: 0.3962 - val_accuracy20: 0.3892 - val_accuracy30: 0.3826 - val_accuracy50: 0.3685 - 22s/epoch - 45ms/step
Epoch 2/50
494/494 - 13s - loss: 12.9710 - accuracy10: 0.4053 - accuracy20: 0.3996 - accuracy30: 0.3951 - accuracy50: 0.3888 - val_loss: 13.0468 - val_accuracy10: 0.4037 - val_accuracy20: 0.3951 - val_accuracy30: 0.3897 - val_accuracy50: 0.3752 - 13s/epoch - 27ms/step
Epoch 3/50
494/494 - 13s - loss: 12.9364 - accuracy10: 0.4103 - accuracy20: 0.4044 - accuracy30: 0.3998 - accuracy50: 0.3930 - val_loss: 13.0358 - val_accuracy10: 0.4057 - val_accuracy20: 0.3956 - val_accuracy30: 0.3923 - val_accuracy50: 0.3769 - 13s/epoch - 26ms/step
Epoch 4/50
494/494 - 13s - loss: 12.8852 - accuracy10: 0.4147 - accuracy20: 0.4078 - accuracy30: 0.4024 - accuracy50: 0.3960 - val_loss: 13.0240 - val_accuracy10: 0.4047 - val_accuracy20: 0.3967 - val_accuracy30: 0.3944 - val_accuracy50: 0.3760 - 13s/epoch - 27ms/step
Epoch 5/50
494/494 - 13s - loss: 12.8533 - accuracy10: 0.4179 - accuracy20: 0.4100 - accuracy30: 0.4049 - accuracy50: 0.3973 - val_loss: 13.0197 - val_accuracy10: 0.4073 - val_accuracy20: 0.3996 - val_accuracy30: 0.3950 - val_accuracy50: 0.3794 - 13s/epoch - 27ms/step
Epoch 6/50
494/494 - 13s - loss: 12.8594 - accuracy10: 0.4191 - accuracy20: 0.4117 - accuracy30: 0.4061 - accuracy50: 0.3978 - val_loss: 13.0161 - val_accuracy10: 0.4074 - val_accuracy20: 0.4014 - val_accuracy30: 0.3940 - val_accuracy50: 0.3781 - 13s/epoch - 27ms/step
Epoch 7/50
494/494 - 13s - loss: 12.8272 - accuracy10: 0.4216 - accuracy20: 0.4136 - accuracy30: 0.4082 - accuracy50: 0.4004 - val_loss: 13.0232 - val_accuracy10: 0.4085 - val_accuracy20: 0.4033 - val_accuracy30: 0.3948 - val_accuracy50: 0.3792 - 13s/epoch - 27ms/step
Epoch 8/50
494/494 - 14s - loss: 12.7977 - accuracy10: 0.4226 - accuracy20: 0.4155 - accuracy30: 0.4110 - accuracy50: 0.4029 - val_loss: 13.0044 - val_accuracy10: 0.4084 - val_accuracy20: 0.4000 - val_accuracy30: 0.3941 - val_accuracy50: 0.3783 - 14s/epoch - 28ms/step
Epoch 9/50
494/494 - 13s - loss: 12.7741 - accuracy10: 0.4250 - accuracy20: 0.4178 - accuracy30: 0.4141 - accuracy50: 0.4057 - val_loss: 13.0057 - val_accuracy10: 0.4075 - val_accuracy20: 0.4038 - val_accuracy30: 0.3986 - val_accuracy50: 0.3821 - 13s/epoch - 26ms/step
Epoch 10/50
494/494 - 13s - loss: 12.7583 - accuracy10: 0.4269 - accuracy20: 0.4188 - accuracy30: 0.4157 - accuracy50: 0.4073 - val_loss: 13.0119 - val_accuracy10: 0.4095 - val_accuracy20: 0.4035 - val_accuracy30: 0.3971 - val_accuracy50: 0.3800 - 13s/epoch - 26ms/step
Epoch 11/50
494/494 - 13s - loss: 12.7431 - accuracy10: 0.4289 - accuracy20: 0.4223 - accuracy30: 0.4180 - accuracy50: 0.4090 - val_loss: 13.0176 - val_accuracy10: 0.4057 - val_accuracy20: 0.3990 - val_accuracy30: 0.3949 - val_accuracy50: 0.3805 - 13s/epoch - 26ms/step
Epoch 12/50
494/494 - 13s - loss: 12.7319 - accuracy10: 0.4300 - accuracy20: 0.4235 - accuracy30: 0.4195 - accuracy50: 0.4098 - val_loss: 12.9995 - val_accuracy10: 0.4088 - val_accuracy20: 0.4016 - val_accuracy30: 0.3985 - val_accuracy50: 0.3814 - 13s/epoch - 27ms/step
Epoch 13/50
494/494 - 13s - loss: 12.7184 - accuracy10: 0.4307 - accuracy20: 0.4239 - accuracy30: 0.4193 - accuracy50: 0.4110 - val_loss: 12.9957 - val_accuracy10: 0.4055 - val_accuracy20: 0.4009 - val_accuracy30: 0.3988 - val_accuracy50: 0.3801 - 13s/epoch - 26ms/step
Epoch 14/50
494/494 - 13s - loss: 12.7073 - accuracy10: 0.4325 - accuracy20: 0.4246 - accuracy30: 0.4221 - accuracy50: 0.4117 - val_loss: 13.0009 - val_accuracy10: 0.4077 - val_accuracy20: 0.4010 - val_accuracy30: 0.3985 - val_accuracy50: 0.3840 - 13s/epoch - 26ms/step
Epoch 15/50
494/494 - 13s - loss: 12.7053 - accuracy10: 0.4322 - accuracy20: 0.4252 - accuracy30: 0.4210 - accuracy50: 0.4115 - val_loss: 13.0110 - val_accuracy10: 0.4095 - val_accuracy20: 0.4018 - val_accuracy30: 0.3987 - val_accuracy50: 0.3816 - 13s/epoch - 26ms/step
Epoch 16/50
494/494 - 13s - loss: 12.6848 - accuracy10: 0.4353 - accuracy20: 0.4283 - accuracy30: 0.4232 - accuracy50: 0.4131 - val_loss: 13.0115 - val_accuracy10: 0.4099 - val_accuracy20: 0.4020 - val_accuracy30: 0.3999 - val_accuracy50: 0.3826 - 13s/epoch - 27ms/step
Epoch 17/50
494/494 - 13s - loss: 12.6780 - accuracy10: 0.4358 - accuracy20: 0.4288 - accuracy30: 0.4254 - accuracy50: 0.4146 - val_loss: 13.0074 - val_accuracy10: 0.4082 - val_accuracy20: 0.4023 - val_accuracy30: 0.3997 - val_accuracy50: 0.3819 - 13s/epoch - 26ms/step
Epoch 18/50
494/494 - 13s - loss: 12.6693 - accuracy10: 0.4376 - accuracy20: 0.4304 - accuracy30: 0.4261 - accuracy50: 0.4164 - val_loss: 13.0096 - val_accuracy10: 0.4097 - val_accuracy20: 0.4023 - val_accuracy30: 0.3976 - val_accuracy50: 0.3808 - 13s/epoch - 26ms/step
Epoch 19/50
494/494 - 13s - loss: 12.6558 - accuracy10: 0.4382 - accuracy20: 0.4304 - accuracy30: 0.4268 - accuracy50: 0.4189 - val_loss: 13.0062 - val_accuracy10: 0.4124 - val_accuracy20: 0.4032 - val_accuracy30: 0.3988 - val_accuracy50: 0.3805 - 13s/epoch - 26ms/step
Epoch 20/50
494/494 - 13s - loss: 12.6456 - accuracy10: 0.4388 - accuracy20: 0.4319 - accuracy30: 0.4280 - accuracy50: 0.4188 - val_loss: 13.0571 - val_accuracy10: 0.4098 - val_accuracy20: 0.3977 - val_accuracy30: 0.3951 - val_accuracy50: 0.3771 - 13s/epoch - 26ms/step
Epoch 21/50
494/494 - 13s - loss: 12.6374 - accuracy10: 0.4398 - accuracy20: 0.4331 - accuracy30: 0.4291 - accuracy50: 0.4199 - val_loss: 13.0153 - val_accuracy10: 0.4090 - val_accuracy20: 0.4008 - val_accuracy30: 0.3966 - val_accuracy50: 0.3808 - 13s/epoch - 26ms/step
Epoch 22/50
494/494 - 13s - loss: 12.6325 - accuracy10: 0.4402 - accuracy20: 0.4334 - accuracy30: 0.4297 - accuracy50: 0.4199 - val_loss: 13.0447 - val_accuracy10: 0.4083 - val_accuracy20: 0.3994 - val_accuracy30: 0.3946 - val_accuracy50: 0.3783 - 13s/epoch - 26ms/step
Epoch 23/50
494/494 - 13s - loss: 12.6164 - accuracy10: 0.4418 - accuracy20: 0.4355 - accuracy30: 0.4312 - accuracy50: 0.4234 - val_loss: 13.0272 - val_accuracy10: 0.4113 - val_accuracy20: 0.4016 - val_accuracy30: 0.3991 - val_accuracy50: 0.3804 - 13s/epoch - 26ms/step
testing model: results/PCAR/W8/deepOF_L1/seq2seq
Evaluating performance on  test set...
1443/1443 - 20s - 20s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0836723
{'0': {'precision': 0.4136695027472946, 'recall': 0.44422742168792856, 'f1-score': 0.4284042322621323, 'support': 122363}, '1': {'precision': 0.39133099763876605, 'recall': 0.45240280864495763, 'f1-score': 0.4196566289583466, 'support': 124188}, '2': {'precision': 0.4179872838628186, 'recall': 0.32111782501977476, 'f1-score': 0.3632045452449249, 'support': 122631}, 'accuracy': 0.4060842619629343, 'macro avg': {'precision': 0.4076625947496264, 'recall': 0.405916018450887, 'f1-score': 0.4037551354884679, 'support': 369182}, 'weighted avg': {'precision': 0.4075893567584866, 'recall': 0.4060842619629343, 'f1-score': 0.4038043054572022, 'support': 369182}}
[[54357 41934 26072]
 [39245 56183 28760]
 [37800 45452 39379]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0859724
{'0': {'precision': 0.4003525935131464, 'recall': 0.4620349215349466, 'f1-score': 0.4289878410863666, 'support': 119926}, '1': {'precision': 0.3720032995927065, 'recall': 0.33955560435768123, 'f1-score': 0.35503963063347505, 'support': 127499}, '2': {'precision': 0.40398248267060605, 'recall': 0.37957571227937614, 'f1-score': 0.39139897864988693, 'support': 121757}, 'accuracy': 0.3925408064315162, 'macro avg': {'precision': 0.3921127919254863, 'recall': 0.393722079390668, 'f1-score': 0.3918088167899095, 'support': 369182}, 'weighted avg': {'precision': 0.3917591566407709, 'recall': 0.3925408064315162, 'f1-score': 0.39105254085988844, 'support': 369182}}
[[55410 34909 29607]
 [45628 43293 38578]
 [37365 38176 46216]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.08783
{'0': {'precision': 0.4004310284701977, 'recall': 0.4742406846022319, 'f1-score': 0.4342216222144071, 'support': 121063}, '1': {'precision': 0.350621629293216, 'recall': 0.2500769317979366, 'f1-score': 0.29193471386503184, 'support': 123486}, '2': {'precision': 0.40355335477640875, 'recall': 0.44595733072300275, 'f1-score': 0.4236970292954011, 'support': 124633}, 'accuracy': 0.38971293291655607, 'macro avg': {'precision': 0.3848686708466074, 'recall': 0.3900916490410571, 'f1-score': 0.38328445512494663, 'support': 369182}, 'weighted avg': {'precision': 0.3848245834857544, 'recall': 0.38971293291655607, 'f1-score': 0.3830757029829564, 'support': 369182}}
[[57413 27362 36288]
 [46745 30881 45860]
 [39220 29832 55581]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0936573
{'0': {'precision': 0.38196795841787057, 'recall': 0.46746333604610607, 'f1-score': 0.42041308642251923, 'support': 120418}, '1': {'precision': 0.34550442100777673, 'recall': 0.20723973226409367, 'f1-score': 0.2590791536441431, 'support': 125198}, '2': {'precision': 0.3916368469481648, 'recall': 0.46500655520126893, 'f1-score': 0.42517972036510143, 'support': 123566}, 'accuracy': 0.37839331278339683, 'macro avg': {'precision': 0.3730364087912707, 'recall': 0.37990320783715625, 'f1-score': 0.3682239868105879, 'support': 369182}, 'weighted avg': {'precision': 0.372838542366886, 'recall': 0.37839331278339683, 'f1-score': 0.3672964885758256, 'support': 369182}}
[[56291 23773 40354]
 [50350 25946 48902]
 [40730 25377 57459]]
Evaluating performance on  train set...
494/494 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0633256
{'0': {'precision': 0.43744653811374246, 'recall': 0.42425750788120126, 'f1-score': 0.4307510889707121, 'support': 42189}, '1': {'precision': 0.40449347232061533, 'recall': 0.4803037950344894, 'f1-score': 0.43915088120247875, 'support': 41607}, '2': {'precision': 0.44437957016153695, 'recall': 0.37613253947709036, 'f1-score': 0.4074177925057354, 'support': 42493}, 'accuracy': 0.4265296264916184, 'macro avg': {'precision': 0.4287731935319649, 'recall': 0.4268979474642604, 'f1-score': 0.4257732542263088, 'support': 126289}, 'weighted avg': {'precision': 0.4289226533918133, 'recall': 0.4265296264916184, 'f1-score': 0.42566741888623016, 'support': 126289}}
[[17899 14557  9733]
 [11372 19984 10251]
 [11646 14864 15983]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0663987
{'0': {'precision': 0.42562980671643474, 'recall': 0.4509330720890779, 'f1-score': 0.4379162315813899, 'support': 41851}, '1': {'precision': 0.3910525476860953, 'recall': 0.352667768753444, 'f1-score': 0.3708696035575263, 'support': 41739}, '2': {'precision': 0.4335108783966778, 'recall': 0.4498466006229654, 'f1-score': 0.4415276931741124, 'support': 42699}, 'accuracy': 0.41808866963868585, 'macro avg': {'precision': 0.41673107759973593, 'recall': 0.4178158138218291, 'f1-score': 0.4167711761043429, 'support': 126289}, 'weighted avg': {'precision': 0.41686652301799193, 'recall': 0.41808866963868585, 'f1-score': 0.41697811813888586, 'support': 126289}}
[[18872 11362 11617]
 [13536 14720 13483]
 [11931 11560 19208]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0681022
{'0': {'precision': 0.4203527525387493, 'recall': 0.47097995065513687, 'f1-score': 0.4442285533539685, 'support': 41747}, '1': {'precision': 0.3959327895350149, 'recall': 0.2518470697941324, 'f1-score': 0.30786543126881594, 'support': 41823}, '2': {'precision': 0.4223507399217554, 'recall': 0.523116177813151, 'f1-score': 0.4673637979713479, 'support': 42719}, 'accuracy': 0.41604573636658776, 'macro avg': {'precision': 0.4128787606651732, 'recall': 0.4153143994208068, 'f1-score': 0.40648592753137747, 'support': 126289}, 'weighted avg': {'precision': 0.4129414650181375, 'recall': 0.41604573636658776, 'f1-score': 0.40689513286479284, 'support': 126289}}
[[19662  8103 13982]
 [14708 10533 16582]
 [12405  7967 22347]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0739336
{'0': {'precision': 0.40368163921584793, 'recall': 0.4699544036477082, 'f1-score': 0.43430434348698727, 'support': 41670}, '1': {'precision': 0.407118920387646, 'recall': 0.21448680631769815, 'f1-score': 0.2809550596912307, 'support': 41914}, '2': {'precision': 0.4078389830508475, 'recall': 0.5319049291652032, 'f1-score': 0.46168229997662624, 'support': 42705}, 'accuracy': 0.406116130462669, 'macro avg': {'precision': 0.4062131808847805, 'recall': 0.40544871304353647, 'f1-score': 0.3923139010516148, 'support': 126289}, 'weighted avg': {'precision': 0.4062282550850717, 'recall': 0.406116130462669, 'f1-score': 0.39266725514892686, 'support': 126289}}
[[19583  6484 15603]
 [15546  8990 17378]
 [13382  6608 22715]]
Evaluating performance on  val set...
150/150 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0807496
{'0': {'precision': 0.41715499560503955, 'recall': 0.43875192604006163, 'f1-score': 0.4276809852808651, 'support': 12980}, '1': {'precision': 0.38078508208904804, 'recall': 0.44497078793620715, 'f1-score': 0.41038336913386975, 'support': 12666}, '2': {'precision': 0.4308406395048994, 'recall': 0.33410654295312747, 'f1-score': 0.37635716538270936, 'support': 12502}, 'accuracy': 0.4065219670756003, 'macro avg': {'precision': 0.4095935723996624, 'recall': 0.4059430856431321, 'f1-score': 0.4048071732658147, 'support': 38148}, 'weighted avg': {'precision': 0.4095644691145944, 'recall': 0.4065219670756003, 'f1-score': 0.40511775778572545, 'support': 38148}}
[[5695 4577 2708]
 [4220 5636 2810]
 [3737 4588 4177]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.079883
{'0': {'precision': 0.41101752479282705, 'recall': 0.4739191729323308, 'f1-score': 0.4402328119316115, 'support': 12768}, '1': {'precision': 0.3758602890571232, 'recall': 0.3346354166666667, 'f1-score': 0.35405186385737436, 'support': 13056}, '2': {'precision': 0.41874258600237246, 'recall': 0.4010061668289516, 'f1-score': 0.4096825002072453, 'support': 12324}, 'accuracy': 0.40269476774667085, 'macro avg': {'precision': 0.4018734666174409, 'recall': 0.4031869188093164, 'f1-score': 0.4013223919987437, 'support': 38148}, 'weighted avg': {'precision': 0.4014807413331723, 'recall': 0.40269476774667085, 'f1-score': 0.4008682187747401, 'support': 38148}}
[[6051 3596 3121]
 [4948 4369 3739]
 [3723 3659 4942]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0826231
{'0': {'precision': 0.41125316373547927, 'recall': 0.4923088875077688, 'f1-score': 0.4481453979703688, 'support': 12872}, '1': {'precision': 0.36209734305196334, 'recall': 0.2405686167304538, 'f1-score': 0.2890797315688207, 'support': 12803}, '2': {'precision': 0.4076442071242886, 'recall': 0.465164755872685, 'f1-score': 0.43450909907885865, 'support': 12473}, 'accuracy': 0.3989462094998427, 'macro avg': {'precision': 0.39366490463724374, 'recall': 0.39934742003696916, 'f1-score': 0.39057807620601603, 'support': 38148}, 'weighted avg': {'precision': 0.393575789088776, 'recall': 0.3989462094998427, 'f1-score': 0.3903021746555731, 'support': 38148}}
[[6337 2724 3811]
 [5103 3080 4620]
 [3969 2702 5802]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0877368
{'0': {'precision': 0.38514789175582126, 'recall': 0.48811612697399903, 'f1-score': 0.4305614183199662, 'support': 12538}, '1': {'precision': 0.36161843214386064, 'recall': 0.19331580923770184, 'f1-score': 0.25194538246953463, 'support': 13315}, '2': {'precision': 0.38507265521796563, 'recall': 0.4741764945099634, 'f1-score': 0.4250045562238017, 'support': 12295}, 'accuracy': 0.38072769214637725, 'macro avg': {'precision': 0.3772796597058825, 'recall': 0.38520281024055475, 'f1-score': 0.36917045233776746, 'support': 38148}, 'weighted avg': {'precision': 0.3769110303747216, 'recall': 0.38072769214637725, 'f1-score': 0.3664271481925457, 'support': 38148}}
[[6120 2245 4173]
 [5604 2574 5137]
 [4166 2299 5830]]
training model: results/PCAR/W8/deepLOB_L2/seq2seq
Epoch 1/50
494/494 - 32s - loss: 13.1061 - accuracy10: 0.3850 - accuracy20: 0.3794 - accuracy30: 0.3735 - accuracy50: 0.3744 - val_loss: 13.2987 - val_accuracy10: 0.3497 - val_accuracy20: 0.3547 - val_accuracy30: 0.3487 - val_accuracy50: 0.3583 - 32s/epoch - 65ms/step
Epoch 2/50
494/494 - 26s - loss: 13.0301 - accuracy10: 0.3990 - accuracy20: 0.3940 - accuracy30: 0.3865 - accuracy50: 0.3863 - val_loss: 13.0362 - val_accuracy10: 0.3976 - val_accuracy20: 0.3927 - val_accuracy30: 0.3880 - val_accuracy50: 0.3823 - 26s/epoch - 52ms/step
Epoch 3/50
494/494 - 27s - loss: 12.9142 - accuracy10: 0.4187 - accuracy20: 0.4095 - accuracy30: 0.3998 - accuracy50: 0.3958 - val_loss: 12.9782 - val_accuracy10: 0.4086 - val_accuracy20: 0.4043 - val_accuracy30: 0.3933 - val_accuracy50: 0.3913 - 27s/epoch - 54ms/step
Epoch 4/50
494/494 - 27s - loss: 12.8605 - accuracy10: 0.4303 - accuracy20: 0.4204 - accuracy30: 0.4086 - accuracy50: 0.4015 - val_loss: 12.8675 - val_accuracy10: 0.4321 - val_accuracy20: 0.4241 - val_accuracy30: 0.4080 - val_accuracy50: 0.4008 - 27s/epoch - 54ms/step
Epoch 5/50
494/494 - 27s - loss: 12.7919 - accuracy10: 0.4429 - accuracy20: 0.4312 - accuracy30: 0.4183 - accuracy50: 0.4103 - val_loss: 12.9706 - val_accuracy10: 0.4078 - val_accuracy20: 0.4007 - val_accuracy30: 0.3888 - val_accuracy50: 0.3854 - 27s/epoch - 54ms/step
Epoch 6/50
494/494 - 26s - loss: 12.7102 - accuracy10: 0.4512 - accuracy20: 0.4391 - accuracy30: 0.4259 - accuracy50: 0.4181 - val_loss: 12.8803 - val_accuracy10: 0.4246 - val_accuracy20: 0.4183 - val_accuracy30: 0.4015 - val_accuracy50: 0.4002 - 26s/epoch - 53ms/step
Epoch 7/50
494/494 - 26s - loss: 12.6502 - accuracy10: 0.4586 - accuracy20: 0.4442 - accuracy30: 0.4302 - accuracy50: 0.4218 - val_loss: 12.8610 - val_accuracy10: 0.4297 - val_accuracy20: 0.4237 - val_accuracy30: 0.4078 - val_accuracy50: 0.4067 - 26s/epoch - 53ms/step
Epoch 8/50
494/494 - 26s - loss: 12.5846 - accuracy10: 0.4644 - accuracy20: 0.4506 - accuracy30: 0.4360 - accuracy50: 0.4265 - val_loss: 12.8661 - val_accuracy10: 0.4304 - val_accuracy20: 0.4219 - val_accuracy30: 0.4078 - val_accuracy50: 0.4057 - 26s/epoch - 52ms/step
Epoch 9/50
494/494 - 27s - loss: 12.5470 - accuracy10: 0.4681 - accuracy20: 0.4535 - accuracy30: 0.4363 - accuracy50: 0.4289 - val_loss: 12.8874 - val_accuracy10: 0.4237 - val_accuracy20: 0.4177 - val_accuracy30: 0.4043 - val_accuracy50: 0.4036 - 27s/epoch - 54ms/step
Epoch 10/50
494/494 - 26s - loss: 12.4922 - accuracy10: 0.4705 - accuracy20: 0.4566 - accuracy30: 0.4409 - accuracy50: 0.4329 - val_loss: 12.8451 - val_accuracy10: 0.4346 - val_accuracy20: 0.4251 - val_accuracy30: 0.4088 - val_accuracy50: 0.4067 - 26s/epoch - 52ms/step
Epoch 11/50
494/494 - 26s - loss: 12.4520 - accuracy10: 0.4743 - accuracy20: 0.4591 - accuracy30: 0.4434 - accuracy50: 0.4343 - val_loss: 12.8543 - val_accuracy10: 0.4355 - val_accuracy20: 0.4282 - val_accuracy30: 0.4136 - val_accuracy50: 0.4099 - 26s/epoch - 53ms/step
Epoch 12/50
494/494 - 26s - loss: 12.4248 - accuracy10: 0.4765 - accuracy20: 0.4613 - accuracy30: 0.4462 - accuracy50: 0.4370 - val_loss: 12.7911 - val_accuracy10: 0.4410 - val_accuracy20: 0.4337 - val_accuracy30: 0.4202 - val_accuracy50: 0.4173 - 26s/epoch - 52ms/step
Epoch 13/50
494/494 - 26s - loss: 12.3974 - accuracy10: 0.4793 - accuracy20: 0.4642 - accuracy30: 0.4501 - accuracy50: 0.4385 - val_loss: 12.7895 - val_accuracy10: 0.4446 - val_accuracy20: 0.4361 - val_accuracy30: 0.4216 - val_accuracy50: 0.4161 - 26s/epoch - 52ms/step
Epoch 14/50
494/494 - 26s - loss: 12.3756 - accuracy10: 0.4799 - accuracy20: 0.4659 - accuracy30: 0.4516 - accuracy50: 0.4411 - val_loss: 12.8129 - val_accuracy10: 0.4413 - val_accuracy20: 0.4331 - val_accuracy30: 0.4190 - val_accuracy50: 0.4170 - 26s/epoch - 52ms/step
Epoch 15/50
494/494 - 26s - loss: 12.3614 - accuracy10: 0.4803 - accuracy20: 0.4657 - accuracy30: 0.4516 - accuracy50: 0.4422 - val_loss: 12.8108 - val_accuracy10: 0.4453 - val_accuracy20: 0.4367 - val_accuracy30: 0.4209 - val_accuracy50: 0.4166 - 26s/epoch - 52ms/step
Epoch 16/50
494/494 - 26s - loss: 12.3347 - accuracy10: 0.4830 - accuracy20: 0.4700 - accuracy30: 0.4552 - accuracy50: 0.4445 - val_loss: 12.8193 - val_accuracy10: 0.4464 - val_accuracy20: 0.4351 - val_accuracy30: 0.4196 - val_accuracy50: 0.4131 - 26s/epoch - 53ms/step
Epoch 17/50
494/494 - 26s - loss: 12.3089 - accuracy10: 0.4854 - accuracy20: 0.4711 - accuracy30: 0.4572 - accuracy50: 0.4459 - val_loss: 12.8271 - val_accuracy10: 0.4467 - val_accuracy20: 0.4362 - val_accuracy30: 0.4197 - val_accuracy50: 0.4165 - 26s/epoch - 53ms/step
Epoch 18/50
494/494 - 26s - loss: 12.2845 - accuracy10: 0.4865 - accuracy20: 0.4730 - accuracy30: 0.4590 - accuracy50: 0.4476 - val_loss: 12.8183 - val_accuracy10: 0.4437 - val_accuracy20: 0.4327 - val_accuracy30: 0.4207 - val_accuracy50: 0.4125 - 26s/epoch - 52ms/step
Epoch 19/50
494/494 - 26s - loss: 12.2659 - accuracy10: 0.4878 - accuracy20: 0.4755 - accuracy30: 0.4619 - accuracy50: 0.4506 - val_loss: 12.8390 - val_accuracy10: 0.4431 - val_accuracy20: 0.4330 - val_accuracy30: 0.4182 - val_accuracy50: 0.4122 - 26s/epoch - 52ms/step
Epoch 20/50
494/494 - 25s - loss: 12.2394 - accuracy10: 0.4905 - accuracy20: 0.4778 - accuracy30: 0.4631 - accuracy50: 0.4509 - val_loss: 12.8482 - val_accuracy10: 0.4460 - val_accuracy20: 0.4344 - val_accuracy30: 0.4192 - val_accuracy50: 0.4132 - 25s/epoch - 52ms/step
Epoch 21/50
494/494 - 26s - loss: 12.2195 - accuracy10: 0.4913 - accuracy20: 0.4790 - accuracy30: 0.4640 - accuracy50: 0.4513 - val_loss: 12.8796 - val_accuracy10: 0.4430 - val_accuracy20: 0.4319 - val_accuracy30: 0.4171 - val_accuracy50: 0.4063 - 26s/epoch - 53ms/step
Epoch 22/50
494/494 - 27s - loss: 12.1971 - accuracy10: 0.4921 - accuracy20: 0.4803 - accuracy30: 0.4658 - accuracy50: 0.4538 - val_loss: 12.8883 - val_accuracy10: 0.4389 - val_accuracy20: 0.4287 - val_accuracy30: 0.4142 - val_accuracy50: 0.4063 - 27s/epoch - 54ms/step
Epoch 23/50
494/494 - 27s - loss: 12.1779 - accuracy10: 0.4932 - accuracy20: 0.4822 - accuracy30: 0.4681 - accuracy50: 0.4542 - val_loss: 12.9442 - val_accuracy10: 0.4376 - val_accuracy20: 0.4264 - val_accuracy30: 0.4109 - val_accuracy50: 0.4041 - 27s/epoch - 54ms/step
testing model: results/PCAR/W8/deepLOB_L2/seq2seq
Evaluating performance on  test set...
1443/1443 - 32s - 32s/epoch - 22ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0720935
{'0': {'precision': 0.4709120820757283, 'recall': 0.29708415736397364, 'f1-score': 0.36432605242454763, 'support': 122366}, '1': {'precision': 0.40978268884968605, 'recall': 0.5817020831152517, 'f1-score': 0.48083732694355696, 'support': 124189}, '2': {'precision': 0.44028038271722314, 'recall': 0.41538913171113573, 'f1-score': 0.42747271651610574, 'support': 122632}, 'accuracy': 0.4321224745183335, 'macro avg': {'precision': 0.4403250512142125, 'recall': 0.43139179073012035, 'f1-score': 0.4242120319614034, 'support': 369187}, 'weighted avg': {'precision': 0.4401742046014912, 'recall': 0.4321224745183335, 'f1-score': 0.4244939900337191, 'support': 369187}}
[[36353 51291 34722]
 [21911 72241 30037]
 [18933 52759 50940]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0768055
{'0': {'precision': 0.45202490212438223, 'recall': 0.2936320656388363, 'f1-score': 0.35600553999818024, 'support': 119929}, '1': {'precision': 0.40437980241492866, 'recall': 0.577871198989796, 'f1-score': 0.4758039257472578, 'support': 127499}, '2': {'precision': 0.42676151885737335, 'recall': 0.3823290270123769, 'f1-score': 0.40332523251935315, 'support': 121759}, 'accuracy': 0.42104678658782674, 'macro avg': {'precision': 0.42772207446556143, 'recall': 0.4179440972136697, 'f1-score': 0.41171156608826376, 'support': 369187}, 'weighted avg': {'precision': 0.4272386912039995, 'recall': 0.42104678658782674, 'f1-score': 0.4129841790789365, 'support': 369187}}
[[35215 52724 31990]
 [23281 73678 30540]
 [19409 55798 46552]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0854874
{'0': {'precision': 0.44392875864626086, 'recall': 0.2867987180334369, 'f1-score': 0.34846971803068094, 'support': 121064}, '1': {'precision': 0.3819924391672435, 'recall': 0.5809633324695517, 'f1-score': 0.4609216891852823, 'support': 123488}, '2': {'precision': 0.423432592764918, 'recall': 0.3504874232759658, 'f1-score': 0.38352231572570555, 'support': 124635}, 'accuracy': 0.4066936268070111, 'macro avg': {'precision': 0.4164512635261408, 'recall': 0.40608315792631816, 'f1-score': 0.39763790764722295, 'support': 369187}, 'weighted avg': {'precision': 0.4162925421639739, 'recall': 0.4066936268070111, 'f1-score': 0.39791688038379414, 'support': 369187}}
[[34721 55564 30779]
 [23044 71742 28702]
 [20448 60504 43683]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0912807
{'0': {'precision': 0.4197120275451913, 'recall': 0.2672396611858495, 'f1-score': 0.32655484185211114, 'support': 120420}, '1': {'precision': 0.38325494656379044, 'recall': 0.597496785118092, 'f1-score': 0.466975669897155, 'support': 125199}, '2': {'precision': 0.40798545110812007, 'recall': 0.32134533212482197, 'f1-score': 0.3595192285927703, 'support': 123568}, 'accuracy': 0.3973460603975763, 'macro avg': {'precision': 0.4036508084057006, 'recall': 0.3953605928095878, 'f1-score': 0.3843499134473454, 'support': 369187}, 'weighted avg': {'precision': 0.40342375174196304, 'recall': 0.3973460603975763, 'f1-score': 0.38520774834985133, 'support': 369187}}
[[32181 57736 30503]
 [23277 74806 27116]
 [21216 62644 39708]]
Evaluating performance on  train set...
494/494 - 10s - 10s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0502219
{'0': {'precision': 0.4742092088295532, 'recall': 0.29795295855873033, 'f1-score': 0.36596467093035173, 'support': 41963}, '1': {'precision': 0.43230493767646855, 'recall': 0.6027943153447283, 'f1-score': 0.5035091237216763, 'support': 41656}, '2': {'precision': 0.4589885760718895, 'recall': 0.45005038314625173, 'f1-score': 0.45447553688694314, 'support': 42673}, 'accuracy': 0.44989389668387547, 'macro avg': {'precision': 0.4551675741926371, 'recall': 0.4502658856832367, 'f1-score': 0.44131644384632374, 'support': 126292}, 'weighted avg': {'precision': 0.4552446316526879, 'recall': 0.44989389668387547, 'f1-score': 0.4412392402493984, 'support': 126292}}
[[12503 16739 12721]
 [ 6630 25110  9916]
 [ 7233 16235 19205]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0607336
{'0': {'precision': 0.4594665566267772, 'recall': 0.29430988081507115, 'f1-score': 0.3587948383694872, 'support': 41616}, '1': {'precision': 0.4153358893148858, 'recall': 0.5946823237386033, 'f1-score': 0.4890860552763819, 'support': 41898}, '2': {'precision': 0.4521377222852819, 'recall': 0.41902379727897515, 'f1-score': 0.43495140919403563, 'support': 42778}, 'accuracy': 0.4362034016406423, 'macro avg': {'precision': 0.4423133894089816, 'recall': 0.43600533394421653, 'f1-score': 0.4276107676133016, 'support': 126292}, 'weighted avg': {'precision': 0.44234354349455896, 'recall': 0.4362034016406423, 'f1-score': 0.42781557755088906, 'support': 126292}}
[[12248 17563 11805]
 [ 7067 24916  9915]
 [ 7342 17511 17925]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0678802
{'0': {'precision': 0.4467691852728079, 'recall': 0.29059171455362937, 'f1-score': 0.3521407863875413, 'support': 41591}, '1': {'precision': 0.4010951624923047, 'recall': 0.5926085499545215, 'f1-score': 0.4783969701654042, 'support': 41778}, '2': {'precision': 0.4446340033054326, 'recall': 0.3886028469585071, 'f1-score': 0.41473451272424383, 'support': 42923}, 'accuracy': 0.4238114844962468, 'macro avg': {'precision': 0.43083278369018174, 'recall': 0.423934370488886, 'f1-score': 0.4150907564257298, 'support': 126292}, 'weighted avg': {'precision': 0.4309343126022546, 'recall': 0.4238114844962468, 'f1-score': 0.41518073635604164, 'support': 126292}}
[[12086 18411 11094]
 [ 7280 24758  9740]
 [ 7686 18557 16680]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0753348
{'0': {'precision': 0.4284274569818223, 'recall': 0.27567489672398887, 'f1-score': 0.3354816081371389, 'support': 41636}, '1': {'precision': 0.39815423119036447, 'recall': 0.6062497022817129, 'f1-score': 0.4806450394652366, 'support': 41986}, '2': {'precision': 0.42886058868179133, 'recall': 0.357511131942817, 'f1-score': 0.3899490037192776, 'support': 42670}, 'accuracy': 0.41322490735755235, 'macro avg': {'precision': 0.418480758951326, 'recall': 0.4131452436495063, 'f1-score': 0.40202521710721767, 'support': 126292}, 'weighted avg': {'precision': 0.4185094104828954, 'recall': 0.41322490735755235, 'f1-score': 0.402144228075309, 'support': 126292}}
[[11478 19166 10992]
 [ 7208 25454  9324]
 [ 8105 19310 15255]]
Evaluating performance on  val set...
150/150 - 3s - 3s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0555273
{'0': {'precision': 0.4721308302690149, 'recall': 0.3777485289563332, 'f1-score': 0.41969892473118275, 'support': 12916}, '1': {'precision': 0.427579306691778, 'recall': 0.5701616700674933, 'f1-score': 0.4886826085494232, 'support': 12742}, '2': {'precision': 0.4474729742215652, 'recall': 0.3877502001601281, 'f1-score': 0.4154763436709132, 'support': 12490}, 'accuracy': 0.4452920205515361, 'macro avg': {'precision': 0.4490610370607861, 'recall': 0.4452201330613182, 'f1-score': 0.44128595898383977, 'support': 38148}, 'weighted avg': {'precision': 0.44917675311021765, 'recall': 0.4452920205515361, 'f1-score': 0.44135799104578, 'support': 38148}}
[[4879 4798 3239]
 [2736 7265 2741]
 [2719 4928 4843]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0619872
{'0': {'precision': 0.4624655974186201, 'recall': 0.38117959949937424, 'f1-score': 0.41790660777839717, 'support': 12784}, '1': {'precision': 0.42421282463801424, 'recall': 0.5655304481041746, 'f1-score': 0.4847828228109918, 'support': 13055}, '2': {'precision': 0.43362398354070736, 'recall': 0.3595742952311317, 'f1-score': 0.39314265411263105, 'support': 12309}, 'accuracy': 0.43729684387123835, 'macro avg': {'precision': 0.4401008018657806, 'recall': 0.4354281142782268, 'f1-score': 0.4319440282340066, 'support': 38148}, 'weighted avg': {'precision': 0.4400685812218591, 'recall': 0.43729684387123835, 'f1-score': 0.4328025258233434, 'support': 38148}}
[[4873 4887 3024]
 [2915 7383 2757]
 [2749 5134 4426]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0731051
{'0': {'precision': 0.44879769752112153, 'recall': 0.37469963568715603, 'f1-score': 0.40841500506928013, 'support': 12901}, '1': {'precision': 0.4023529411764706, 'recall': 0.5639133165829145, 'f1-score': 0.46962662656117177, 'support': 12736}, '2': {'precision': 0.4302508659599034, 'recall': 0.32763168411797616, 'f1-score': 0.37199382884109267, 'support': 12511}, 'accuracy': 0.4224336793540946, 'macro avg': {'precision': 0.42713383488583184, 'recall': 0.42208154546268223, 'f1-score': 0.41667848682384817, 'support': 38148}, 'weighted avg': {'precision': 0.4272091522115935, 'recall': 0.4224336793540946, 'f1-score': 0.41690629886003927, 'support': 38148}}
[[4834 5223 2844]
 [2970 7182 2584]
 [2967 5445 4099]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0752561
{'0': {'precision': 0.43197912784196796, 'recall': 0.36878529949884653, 'f1-score': 0.3978886838604471, 'support': 12571}, '1': {'precision': 0.4149770208164369, 'recall': 0.580384150030248, 'f1-score': 0.4839370724171632, 'support': 13224}, '2': {'precision': 0.41038000224190113, 'recall': 0.2963652554035457, 'f1-score': 0.3441759894707154, 'support': 12353}, 'accuracy': 0.4186851211072664, 'macro avg': {'precision': 0.419112050300102, 'recall': 0.41517823497754675, 'f1-score': 0.4086672485827753, 'support': 38148}, 'weighted avg': {'precision': 0.41909116879186703, 'recall': 0.4186851211072664, 'f1-score': 0.4103242237702106, 'support': 38148}}
[[4636 5202 2733]
 [3022 7675 2527]
 [3074 5618 3661]]
training model: results/PCAR/W8/deepOF_L2/seq2seq
Epoch 1/50
494/494 - 25s - loss: 13.0285 - accuracy10: 0.3994 - accuracy20: 0.3913 - accuracy30: 0.3837 - accuracy50: 0.3794 - val_loss: 12.9294 - val_accuracy10: 0.4221 - val_accuracy20: 0.4099 - val_accuracy30: 0.3988 - val_accuracy50: 0.3878 - 25s/epoch - 50ms/step
Epoch 2/50
494/494 - 18s - loss: 12.8210 - accuracy10: 0.4301 - accuracy20: 0.4175 - accuracy30: 0.4070 - accuracy50: 0.3956 - val_loss: 12.8573 - val_accuracy10: 0.4334 - val_accuracy20: 0.4173 - val_accuracy30: 0.4054 - val_accuracy50: 0.3933 - 18s/epoch - 36ms/step
Epoch 3/50
494/494 - 18s - loss: 12.6558 - accuracy10: 0.4509 - accuracy20: 0.4335 - accuracy30: 0.4217 - accuracy50: 0.4110 - val_loss: 12.8171 - val_accuracy10: 0.4419 - val_accuracy20: 0.4236 - val_accuracy30: 0.4107 - val_accuracy50: 0.4012 - 18s/epoch - 35ms/step
Epoch 4/50
494/494 - 18s - loss: 12.5535 - accuracy10: 0.4618 - accuracy20: 0.4447 - accuracy30: 0.4319 - accuracy50: 0.4213 - val_loss: 12.7915 - val_accuracy10: 0.4454 - val_accuracy20: 0.4269 - val_accuracy30: 0.4102 - val_accuracy50: 0.4013 - 18s/epoch - 36ms/step
Epoch 5/50
494/494 - 18s - loss: 12.4736 - accuracy10: 0.4724 - accuracy20: 0.4529 - accuracy30: 0.4406 - accuracy50: 0.4293 - val_loss: 12.7910 - val_accuracy10: 0.4505 - val_accuracy20: 0.4273 - val_accuracy30: 0.4089 - val_accuracy50: 0.4026 - 18s/epoch - 36ms/step
Epoch 6/50
494/494 - 17s - loss: 12.4065 - accuracy10: 0.4800 - accuracy20: 0.4597 - accuracy30: 0.4460 - accuracy50: 0.4336 - val_loss: 12.7442 - val_accuracy10: 0.4559 - val_accuracy20: 0.4329 - val_accuracy30: 0.4138 - val_accuracy50: 0.4049 - 17s/epoch - 35ms/step
Epoch 7/50
494/494 - 17s - loss: 12.3549 - accuracy10: 0.4859 - accuracy20: 0.4660 - accuracy30: 0.4501 - accuracy50: 0.4384 - val_loss: 12.7526 - val_accuracy10: 0.4551 - val_accuracy20: 0.4337 - val_accuracy30: 0.4153 - val_accuracy50: 0.4031 - 17s/epoch - 34ms/step
Epoch 8/50
494/494 - 17s - loss: 12.3117 - accuracy10: 0.4903 - accuracy20: 0.4697 - accuracy30: 0.4552 - accuracy50: 0.4420 - val_loss: 12.7380 - val_accuracy10: 0.4586 - val_accuracy20: 0.4343 - val_accuracy30: 0.4159 - val_accuracy50: 0.4050 - 17s/epoch - 35ms/step
Epoch 9/50
494/494 - 17s - loss: 12.2684 - accuracy10: 0.4948 - accuracy20: 0.4740 - accuracy30: 0.4594 - accuracy50: 0.4475 - val_loss: 12.7408 - val_accuracy10: 0.4594 - val_accuracy20: 0.4343 - val_accuracy30: 0.4149 - val_accuracy50: 0.4025 - 17s/epoch - 35ms/step
Epoch 10/50
494/494 - 17s - loss: 12.2308 - accuracy10: 0.4991 - accuracy20: 0.4776 - accuracy30: 0.4631 - accuracy50: 0.4498 - val_loss: 12.7303 - val_accuracy10: 0.4625 - val_accuracy20: 0.4387 - val_accuracy30: 0.4189 - val_accuracy50: 0.4040 - 17s/epoch - 35ms/step
Epoch 11/50
494/494 - 17s - loss: 12.1950 - accuracy10: 0.5012 - accuracy20: 0.4807 - accuracy30: 0.4671 - accuracy50: 0.4538 - val_loss: 12.7392 - val_accuracy10: 0.4604 - val_accuracy20: 0.4374 - val_accuracy30: 0.4175 - val_accuracy50: 0.4057 - 17s/epoch - 34ms/step
Epoch 12/50
494/494 - 17s - loss: 12.1535 - accuracy10: 0.5064 - accuracy20: 0.4856 - accuracy30: 0.4715 - accuracy50: 0.4574 - val_loss: 12.7676 - val_accuracy10: 0.4609 - val_accuracy20: 0.4346 - val_accuracy30: 0.4159 - val_accuracy50: 0.4035 - 17s/epoch - 34ms/step
Epoch 13/50
494/494 - 17s - loss: 12.1159 - accuracy10: 0.5093 - accuracy20: 0.4892 - accuracy30: 0.4732 - accuracy50: 0.4595 - val_loss: 12.7899 - val_accuracy10: 0.4585 - val_accuracy20: 0.4331 - val_accuracy30: 0.4152 - val_accuracy50: 0.4041 - 17s/epoch - 34ms/step
Epoch 14/50
494/494 - 17s - loss: 12.0888 - accuracy10: 0.5112 - accuracy20: 0.4919 - accuracy30: 0.4767 - accuracy50: 0.4624 - val_loss: 12.8107 - val_accuracy10: 0.4588 - val_accuracy20: 0.4349 - val_accuracy30: 0.4158 - val_accuracy50: 0.4022 - 17s/epoch - 34ms/step
Epoch 15/50
494/494 - 18s - loss: 12.0571 - accuracy10: 0.5134 - accuracy20: 0.4935 - accuracy30: 0.4801 - accuracy50: 0.4652 - val_loss: 12.8124 - val_accuracy10: 0.4612 - val_accuracy20: 0.4362 - val_accuracy30: 0.4165 - val_accuracy50: 0.4015 - 18s/epoch - 36ms/step
Epoch 16/50
494/494 - 18s - loss: 12.0252 - accuracy10: 0.5154 - accuracy20: 0.4977 - accuracy30: 0.4835 - accuracy50: 0.4704 - val_loss: 12.8313 - val_accuracy10: 0.4584 - val_accuracy20: 0.4329 - val_accuracy30: 0.4146 - val_accuracy50: 0.4048 - 18s/epoch - 36ms/step
Epoch 17/50
494/494 - 18s - loss: 11.9836 - accuracy10: 0.5176 - accuracy20: 0.5017 - accuracy30: 0.4872 - accuracy50: 0.4720 - val_loss: 12.9161 - val_accuracy10: 0.4538 - val_accuracy20: 0.4299 - val_accuracy30: 0.4119 - val_accuracy50: 0.4014 - 18s/epoch - 35ms/step
Epoch 18/50
494/494 - 17s - loss: 11.9509 - accuracy10: 0.5198 - accuracy20: 0.5034 - accuracy30: 0.4895 - accuracy50: 0.4745 - val_loss: 12.8612 - val_accuracy10: 0.4571 - val_accuracy20: 0.4310 - val_accuracy30: 0.4138 - val_accuracy50: 0.4045 - 17s/epoch - 35ms/step
Epoch 19/50
494/494 - 17s - loss: 11.9126 - accuracy10: 0.5212 - accuracy20: 0.5067 - accuracy30: 0.4951 - accuracy50: 0.4792 - val_loss: 12.8981 - val_accuracy10: 0.4572 - val_accuracy20: 0.4300 - val_accuracy30: 0.4121 - val_accuracy50: 0.4010 - 17s/epoch - 34ms/step
Epoch 20/50
494/494 - 17s - loss: 11.8727 - accuracy10: 0.5244 - accuracy20: 0.5109 - accuracy30: 0.4986 - accuracy50: 0.4816 - val_loss: 12.9093 - val_accuracy10: 0.4563 - val_accuracy20: 0.4308 - val_accuracy30: 0.4110 - val_accuracy50: 0.4030 - 17s/epoch - 35ms/step
testing model: results/PCAR/W8/deepOF_L2/seq2seq
Evaluating performance on  test set...
1443/1443 - 23s - 23s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0529983
{'0': {'precision': 0.46836970155398744, 'recall': 0.39976953817739025, 'f1-score': 0.43135923528685566, 'support': 122363}, '1': {'precision': 0.42766688195278596, 'recall': 0.5705221116371952, 'f1-score': 0.4888721757820182, 'support': 124188}, '2': {'precision': 0.45710103966892096, 'recall': 0.36927856740954573, 'f1-score': 0.4085231911448302, 'support': 122631}, 'accuracy': 0.4470803018565369, 'macro avg': {'precision': 0.45104587439189814, 'recall': 0.4465234057413771, 'f1-score': 0.44291820073790134, 'support': 369182}, 'weighted avg': {'precision': 0.45093469920755236, 'recall': 0.4470803018565369, 'f1-score': 0.4431203994959247, 'support': 369182}}
[[48917 46678 26768]
 [26319 70852 27017]
 [29205 48141 45285]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0716305
{'0': {'precision': 0.4469890271433822, 'recall': 0.35496055901139034, 'f1-score': 0.39569438699392545, 'support': 119926}, '1': {'precision': 0.39686022026965945, 'recall': 0.5646789386583424, 'f1-score': 0.46612476652002344, 'support': 127499}, '2': {'precision': 0.437389904142306, 'recall': 0.3324079929696034, 'f1-score': 0.3777404451910962, 'support': 121757}, 'accuracy': 0.41995005173600014, 'macro avg': {'precision': 0.4270797171851159, 'recall': 0.4173491635464454, 'f1-score': 0.41318653290168167, 'support': 369182}, 'weighted avg': {'precision': 0.42651096167205693, 'recall': 0.41995005173600014, 'f1-score': 0.41409665164147297, 'support': 369182}}
[[42569 53462 23895]
 [27338 71996 28165]
 [25328 55956 40473]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0849861
{'0': {'precision': 0.4437616916483152, 'recall': 0.3095991343350157, 'f1-score': 0.3647342172485099, 'support': 121063}, '1': {'precision': 0.3650595997228387, 'recall': 0.5887792948188458, 'f1-score': 0.4506830973692693, 'support': 123486}, '2': {'precision': 0.434944715865261, 'recall': 0.29858063273771795, 'f1-score': 0.3540874728223378, 'support': 124633}, 'accuracy': 0.39926106906620584, 'macro avg': {'precision': 0.414588669078805, 'recall': 0.39898635396385984, 'f1-score': 0.38983492914670564, 'support': 369182}, 'weighted avg': {'precision': 0.41446044547087757, 'recall': 0.39926106906620584, 'f1-score': 0.3898886064455048, 'support': 369182}}
[[37481 61289 22293]
 [24728 72706 26052]
 [22253 65167 37213]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0939761
{'0': {'precision': 0.42706730704911233, 'recall': 0.26509325848295107, 'f1-score': 0.3271283273127866, 'support': 120418}, '1': {'precision': 0.36160047498446096, 'recall': 0.622661703861084, 'f1-score': 0.45750974224141977, 'support': 125198}, '2': {'precision': 0.41687275678829155, 'recall': 0.2660116860625091, 'f1-score': 0.32477830200331004, 'support': 123566}, 'accuracy': 0.3866602380397744, 'macro avg': {'precision': 0.4018468462739549, 'recall': 0.38458888280218134, 'f1-score': 0.36980545718583874, 'support': 369182}, 'weighted avg': {'precision': 0.4014538799633964, 'recall': 0.3866602380397744, 'f1-score': 0.37055706749742245, 'support': 369182}}
[[31922 66778 21718]
 [22981 77956 24261]
 [19844 70852 32870]]
Evaluating performance on  train set...
494/494 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0121604
{'0': {'precision': 0.5045156720382504, 'recall': 0.4051767048282728, 'f1-score': 0.4494222502661987, 'support': 42189}, '1': {'precision': 0.4612729782750854, 'recall': 0.6103299925493306, 'f1-score': 0.525434775861534, 'support': 41607}, '2': {'precision': 0.49765760942310266, 'recall': 0.437483820864613, 'f1-score': 0.4656347059412885, 'support': 42493}, 'accuracy': 0.4836367379581753, 'macro avg': {'precision': 0.4878154199121461, 'recall': 0.4843301727474055, 'f1-score': 0.48016391068967373, 'support': 126289}, 'weighted avg': {'precision': 0.48796143204815245, 'recall': 0.4836367379581753, 'f1-score': 0.47992030656125767, 'support': 126289}}
[[17094 15106  9989]
 [ 7437 25394  8776]
 [ 9351 14552 18590]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0366421
{'0': {'precision': 0.47920389426335575, 'recall': 0.37165181238202194, 'f1-score': 0.4186303139592782, 'support': 41851}, '1': {'precision': 0.4217329446873482, 'recall': 0.5823570281990464, 'f1-score': 0.4891974842767296, 'support': 41739}, '2': {'precision': 0.48611686697057604, 'recall': 0.4120705402936837, 'f1-score': 0.4460415240702715, 'support': 42699}, 'accuracy': 0.4549564886886427, 'macro avg': {'precision': 0.4623512353070933, 'recall': 0.45535979362491735, 'f1-score': 0.4512897741020931, 'support': 126289}, 'weighted avg': {'precision': 0.46254683828280807, 'recall': 0.4549564886886427, 'f1-score': 0.451220914743269, 'support': 126289}}
[[15554 16898  9399]
 [ 8231 24307  9201]
 [ 8673 16431 17595]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0489402
{'0': {'precision': 0.4721266792134467, 'recall': 0.3485280379428462, 'f1-score': 0.4010197753738028, 'support': 41747}, '1': {'precision': 0.3973736938846479, 'recall': 0.5737751954666093, 'f1-score': 0.46955347708683914, 'support': 41823}, '2': {'precision': 0.4732911464568725, 'recall': 0.38867951028816217, 'f1-score': 0.4268325599928021, 'support': 42719}, 'accuracy': 0.43670470112202964, 'macro avg': {'precision': 0.44759717318498904, 'recall': 0.4369942478992059, 'f1-score': 0.432468604151148, 'support': 126289}, 'weighted avg': {'precision': 0.4477647060468649, 'recall': 0.43670470112202964, 'f1-score': 0.43244754305652533, 'support': 126289}}
[[14550 18243  8954]
 [ 8302 23997  9524]
 [ 7966 18149 16604]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0641682
{'0': {'precision': 0.44941176470588234, 'recall': 0.31627069834413246, 'f1-score': 0.37126558208324534, 'support': 41670}, '1': {'precision': 0.3837524849326307, 'recall': 0.5803072958915876, 'f1-score': 0.4619928582282328, 'support': 41914}, '2': {'precision': 0.458668334226669, 'recall': 0.3606837606837607, 'f1-score': 0.40381716413019253, 'support': 42705}, 'accuracy': 0.41892009597035373, 'macro avg': {'precision': 0.43061086128839404, 'recall': 0.4190872516398269, 'f1-score': 0.41235853481389023, 'support': 126289}, 'weighted avg': {'precision': 0.4307502720103121, 'recall': 0.41892009597035373, 'f1-score': 0.41238443141815084, 'support': 126289}}
[[13179 19493  8998]
 [ 8410 24323  9181]
 [ 7736 19566 15403]]
Evaluating performance on  val set...
150/150 - 3s - 3s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0386198
{'0': {'precision': 0.4839225272658894, 'recall': 0.3965331278890601, 'f1-score': 0.43589092140921404, 'support': 12980}, '1': {'precision': 0.4357344242357234, 'recall': 0.622295910311069, 'f1-score': 0.5125670622662981, 'support': 12666}, '2': {'precision': 0.4813753581661891, 'recall': 0.3628219484882419, 'f1-score': 0.4137742303306727, 'support': 12502}, 'accuracy': 0.4604435357030513, 'macro avg': {'precision': 0.4670107698892673, 'recall': 0.4605503288961237, 'f1-score': 0.4540774046687283, 'support': 38148}, 'weighted avg': {'precision': 0.4670882182309587, 'recall': 0.4604435357030513, 'f1-score': 0.4541009751009385, 'support': 38148}}
[[5147 5199 2634]
 [2531 7882 2253]
 [2958 5008 4536]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0586318
{'0': {'precision': 0.46595017098192476, 'recall': 0.37351190476190477, 'f1-score': 0.41464156849106637, 'support': 12768}, '1': {'precision': 0.4102523408982701, 'recall': 0.5939797794117647, 'f1-score': 0.4853093025438844, 'support': 13056}, '2': {'precision': 0.45394006659267483, 'recall': 0.33187276858162934, 'f1-score': 0.383425517952564, 'support': 12324}, 'accuracy': 0.43551431267694246, 'macro avg': {'precision': 0.4433808594909565, 'recall': 0.4331214842517663, 'f1-score': 0.4277921296625049, 'support': 38148}, 'weighted avg': {'precision': 0.4430078569401582, 'recall': 0.43551431267694246, 'f1-score': 0.4287427357595231, 'support': 38148}}
[[4769 5571 2428]
 [2809 7755 2492]
 [2657 5577 4090]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0714228
{'0': {'precision': 0.45700473153672083, 'recall': 0.3451678060907396, 'f1-score': 0.3932902540497477, 'support': 12872}, '1': {'precision': 0.3838946568751583, 'recall': 0.592048738576896, 'f1-score': 0.4657736266437262, 'support': 12803}, '2': {'precision': 0.44626195138808894, 'recall': 0.3105908762927924, 'f1-score': 0.366266427153257, 'support': 12473}, 'accuracy': 0.4167190940547342, 'macro avg': {'precision': 0.4290537799333227, 'recall': 0.4159358069868093, 'f1-score': 0.40844343594891025, 'support': 38148}, 'weighted avg': {'precision': 0.42895547645949866, 'recall': 0.4167190940547342, 'f1-score': 0.40878088072587176, 'support': 38148}}
[[4443 6055 2374]
 [2790 7580 2433]
 [2489 6110 3874]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.079986
{'0': {'precision': 0.4356351236146633, 'recall': 0.3260488116126974, 'f1-score': 0.37295867165404617, 'support': 12538}, '1': {'precision': 0.38391984359726294, 'recall': 0.5899361622230567, 'f1-score': 0.46513693560325686, 'support': 13315}, '2': {'precision': 0.4136560693641618, 'recall': 0.2793818625457503, 'f1-score': 0.3335113355017234, 'support': 12295}, 'accuracy': 0.4031141868512111, 'macro avg': {'precision': 0.41107034552536265, 'recall': 0.3984556121271681, 'f1-score': 0.3905356475863422, 'support': 38148}, 'weighted avg': {'precision': 0.41050087213512043, 'recall': 0.4031141868512111, 'f1-score': 0.39241837036671606, 'support': 38148}}
[[4088 6152 2298]
 [2889 7855 2571]
 [2407 6453 3435]]
training model: results/PCAR/W8/deepVOL_L2/seq2seq
Epoch 1/50
494/494 - 24s - loss: 13.0535 - accuracy10: 0.3994 - accuracy20: 0.3945 - accuracy30: 0.3874 - accuracy50: 0.3851 - val_loss: 13.0235 - val_accuracy10: 0.3869 - val_accuracy20: 0.3859 - val_accuracy30: 0.3746 - val_accuracy50: 0.3812 - 24s/epoch - 48ms/step
Epoch 2/50
494/494 - 18s - loss: 12.8912 - accuracy10: 0.4180 - accuracy20: 0.4121 - accuracy30: 0.4007 - accuracy50: 0.3930 - val_loss: 12.9004 - val_accuracy10: 0.4165 - val_accuracy20: 0.4049 - val_accuracy30: 0.3914 - val_accuracy50: 0.3891 - 18s/epoch - 35ms/step
Epoch 3/50
494/494 - 17s - loss: 12.7686 - accuracy10: 0.4365 - accuracy20: 0.4269 - accuracy30: 0.4152 - accuracy50: 0.4064 - val_loss: 12.8078 - val_accuracy10: 0.4359 - val_accuracy20: 0.4223 - val_accuracy30: 0.4099 - val_accuracy50: 0.4013 - 17s/epoch - 35ms/step
Epoch 4/50
494/494 - 18s - loss: 12.6577 - accuracy10: 0.4523 - accuracy20: 0.4408 - accuracy30: 0.4275 - accuracy50: 0.4169 - val_loss: 12.7574 - val_accuracy10: 0.4428 - val_accuracy20: 0.4274 - val_accuracy30: 0.4158 - val_accuracy50: 0.4052 - 18s/epoch - 36ms/step
Epoch 5/50
494/494 - 18s - loss: 12.5995 - accuracy10: 0.4607 - accuracy20: 0.4480 - accuracy30: 0.4332 - accuracy50: 0.4218 - val_loss: 12.7752 - val_accuracy10: 0.4434 - val_accuracy20: 0.4286 - val_accuracy30: 0.4173 - val_accuracy50: 0.4035 - 18s/epoch - 36ms/step
Epoch 6/50
494/494 - 17s - loss: 12.5499 - accuracy10: 0.4668 - accuracy20: 0.4523 - accuracy30: 0.4379 - accuracy50: 0.4263 - val_loss: 12.7168 - val_accuracy10: 0.4505 - val_accuracy20: 0.4349 - val_accuracy30: 0.4235 - val_accuracy50: 0.4086 - 17s/epoch - 35ms/step
Epoch 7/50
494/494 - 17s - loss: 12.5097 - accuracy10: 0.4704 - accuracy20: 0.4561 - accuracy30: 0.4411 - accuracy50: 0.4300 - val_loss: 12.7873 - val_accuracy10: 0.4474 - val_accuracy20: 0.4315 - val_accuracy30: 0.4212 - val_accuracy50: 0.4047 - 17s/epoch - 35ms/step
Epoch 8/50
494/494 - 17s - loss: 12.4830 - accuracy10: 0.4750 - accuracy20: 0.4604 - accuracy30: 0.4443 - accuracy50: 0.4314 - val_loss: 12.7462 - val_accuracy10: 0.4516 - val_accuracy20: 0.4350 - val_accuracy30: 0.4206 - val_accuracy50: 0.4076 - 17s/epoch - 34ms/step
Epoch 9/50
494/494 - 17s - loss: 12.4627 - accuracy10: 0.4750 - accuracy20: 0.4607 - accuracy30: 0.4455 - accuracy50: 0.4335 - val_loss: 12.7431 - val_accuracy10: 0.4523 - val_accuracy20: 0.4358 - val_accuracy30: 0.4213 - val_accuracy50: 0.4094 - 17s/epoch - 34ms/step
Epoch 10/50
494/494 - 17s - loss: 12.4374 - accuracy10: 0.4777 - accuracy20: 0.4629 - accuracy30: 0.4470 - accuracy50: 0.4357 - val_loss: 12.7232 - val_accuracy10: 0.4559 - val_accuracy20: 0.4376 - val_accuracy30: 0.4222 - val_accuracy50: 0.4075 - 17s/epoch - 34ms/step
Epoch 11/50
494/494 - 17s - loss: 12.4181 - accuracy10: 0.4786 - accuracy20: 0.4640 - accuracy30: 0.4481 - accuracy50: 0.4366 - val_loss: 12.6900 - val_accuracy10: 0.4592 - val_accuracy20: 0.4415 - val_accuracy30: 0.4243 - val_accuracy50: 0.4100 - 17s/epoch - 34ms/step
Epoch 12/50
494/494 - 16s - loss: 12.3914 - accuracy10: 0.4838 - accuracy20: 0.4675 - accuracy30: 0.4504 - accuracy50: 0.4382 - val_loss: 12.7199 - val_accuracy10: 0.4599 - val_accuracy20: 0.4392 - val_accuracy30: 0.4230 - val_accuracy50: 0.4114 - 16s/epoch - 33ms/step
Epoch 13/50
494/494 - 16s - loss: 12.3628 - accuracy10: 0.4836 - accuracy20: 0.4689 - accuracy30: 0.4531 - accuracy50: 0.4415 - val_loss: 12.7500 - val_accuracy10: 0.4555 - val_accuracy20: 0.4366 - val_accuracy30: 0.4191 - val_accuracy50: 0.4084 - 16s/epoch - 33ms/step
Epoch 14/50
494/494 - 17s - loss: 12.3484 - accuracy10: 0.4865 - accuracy20: 0.4708 - accuracy30: 0.4539 - accuracy50: 0.4415 - val_loss: 12.6866 - val_accuracy10: 0.4584 - val_accuracy20: 0.4394 - val_accuracy30: 0.4230 - val_accuracy50: 0.4125 - 17s/epoch - 34ms/step
Epoch 15/50
494/494 - 17s - loss: 12.3301 - accuracy10: 0.4883 - accuracy20: 0.4722 - accuracy30: 0.4563 - accuracy50: 0.4435 - val_loss: 12.7134 - val_accuracy10: 0.4572 - val_accuracy20: 0.4385 - val_accuracy30: 0.4229 - val_accuracy50: 0.4099 - 17s/epoch - 34ms/step
Epoch 16/50
494/494 - 17s - loss: 12.3123 - accuracy10: 0.4889 - accuracy20: 0.4728 - accuracy30: 0.4570 - accuracy50: 0.4462 - val_loss: 12.7111 - val_accuracy10: 0.4548 - val_accuracy20: 0.4377 - val_accuracy30: 0.4199 - val_accuracy50: 0.4052 - 17s/epoch - 34ms/step
Epoch 17/50
494/494 - 16s - loss: 12.2997 - accuracy10: 0.4910 - accuracy20: 0.4743 - accuracy30: 0.4576 - accuracy50: 0.4467 - val_loss: 12.7073 - val_accuracy10: 0.4575 - val_accuracy20: 0.4381 - val_accuracy30: 0.4218 - val_accuracy50: 0.4077 - 16s/epoch - 33ms/step
Epoch 18/50
494/494 - 16s - loss: 12.2852 - accuracy10: 0.4914 - accuracy20: 0.4758 - accuracy30: 0.4598 - accuracy50: 0.4471 - val_loss: 12.7260 - val_accuracy10: 0.4599 - val_accuracy20: 0.4369 - val_accuracy30: 0.4204 - val_accuracy50: 0.4072 - 16s/epoch - 33ms/step
Epoch 19/50
494/494 - 16s - loss: 12.2755 - accuracy10: 0.4920 - accuracy20: 0.4758 - accuracy30: 0.4587 - accuracy50: 0.4486 - val_loss: 12.7303 - val_accuracy10: 0.4602 - val_accuracy20: 0.4376 - val_accuracy30: 0.4197 - val_accuracy50: 0.4069 - 16s/epoch - 33ms/step
Epoch 20/50
494/494 - 17s - loss: 12.2637 - accuracy10: 0.4930 - accuracy20: 0.4771 - accuracy30: 0.4599 - accuracy50: 0.4508 - val_loss: 12.7351 - val_accuracy10: 0.4583 - val_accuracy20: 0.4358 - val_accuracy30: 0.4164 - val_accuracy50: 0.4056 - 17s/epoch - 34ms/step
Epoch 21/50
494/494 - 17s - loss: 12.2438 - accuracy10: 0.4940 - accuracy20: 0.4789 - accuracy30: 0.4620 - accuracy50: 0.4514 - val_loss: 12.7679 - val_accuracy10: 0.4550 - val_accuracy20: 0.4338 - val_accuracy30: 0.4149 - val_accuracy50: 0.4043 - 17s/epoch - 34ms/step
Epoch 22/50
494/494 - 16s - loss: 12.2305 - accuracy10: 0.4959 - accuracy20: 0.4784 - accuracy30: 0.4622 - accuracy50: 0.4538 - val_loss: 12.7713 - val_accuracy10: 0.4573 - val_accuracy20: 0.4322 - val_accuracy30: 0.4127 - val_accuracy50: 0.3998 - 16s/epoch - 33ms/step
Epoch 23/50
494/494 - 16s - loss: 12.2199 - accuracy10: 0.4967 - accuracy20: 0.4797 - accuracy30: 0.4637 - accuracy50: 0.4542 - val_loss: 12.7276 - val_accuracy10: 0.4628 - val_accuracy20: 0.4389 - val_accuracy30: 0.4165 - val_accuracy50: 0.4033 - 16s/epoch - 33ms/step
Epoch 24/50
494/494 - 17s - loss: 12.2049 - accuracy10: 0.4975 - accuracy20: 0.4810 - accuracy30: 0.4657 - accuracy50: 0.4554 - val_loss: 12.7078 - val_accuracy10: 0.4622 - val_accuracy20: 0.4405 - val_accuracy30: 0.4206 - val_accuracy50: 0.4055 - 17s/epoch - 34ms/step
testing model: results/PCAR/W8/deepVOL_L2/seq2seq
Evaluating performance on  test set...
1443/1443 - 21s - 21s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0481442
{'0': {'precision': 0.45462239646668545, 'recall': 0.3819034699181145, 'f1-score': 0.41510221665578545, 'support': 122366}, '1': {'precision': 0.47643199252365565, 'recall': 0.3940848223272593, 'f1-score': 0.4313635622463235, 'support': 124189}, '2': {'precision': 0.43075090120364146, 'recall': 0.5748988844673495, 'f1-score': 0.49249393996549096, 'support': 122632}, 'accuracy': 0.45010793987870645, 'macro avg': {'precision': 0.45393509673132754, 'recall': 0.45029572557090775, 'f1-score': 0.4463199062892, 'support': 369187}, 'weighted avg': {'precision': 0.4540294793748633, 'recall': 0.45010793987870645, 'f1-score': 0.44627932218891403, 'support': 369187}}
[[46732 25500 50134]
 [32213 48941 43035]
 [23848 28283 70501]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0606034
{'0': {'precision': 0.4436852501310114, 'recall': 0.36710053448290236, 'f1-score': 0.4017758958189791, 'support': 119929}, '1': {'precision': 0.4456310129094449, 'recall': 0.3698381948093711, 'f1-score': 0.40421236707770253, 'support': 127499}, '2': {'precision': 0.4155045843613878, 'recall': 0.5601475044965876, 'f1-score': 0.47710420280933463, 'support': 121759}, 'accuracy': 0.43171346770065033, 'macro avg': {'precision': 0.4349402824672814, 'recall': 0.4323620779296203, 'f1-score': 0.4276974885686721, 'support': 369187}, 'weighted avg': {'precision': 0.435063151100016, 'recall': 0.43171346770065033, 'f1-score': 0.4274608386253473, 'support': 369187}}
[[44026 27575 48328]
 [32731 47154 47614]
 [22471 31085 68203]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.069951
{'0': {'precision': 0.43794588272819096, 'recall': 0.34024152514372563, 'f1-score': 0.3829601290448542, 'support': 121064}, '1': {'precision': 0.40681165791719465, 'recall': 0.3821666882612076, 'f1-score': 0.3941042610492912, 'support': 123488}, '2': {'precision': 0.41556637863315005, 'recall': 0.5305652505315521, 'f1-score': 0.4660769664505216, 'support': 124635}, 'accuracy': 0.4185169033579189, 'macro avg': {'precision': 0.4201079730928452, 'recall': 0.4176578213121618, 'f1-score': 0.41438045218155567, 'support': 369187}, 'weighted avg': {'precision': 0.4199767433859451, 'recall': 0.4185169033579189, 'f1-score': 0.4147473631647427, 'support': 369187}}
[[41191 32457 47416]
 [30713 47193 45582]
 [22151 36357 66127]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0820345
{'0': {'precision': 0.41601607085787334, 'recall': 0.3026739744228533, 'f1-score': 0.3504076295954468, 'support': 120420}, '1': {'precision': 0.39549456472913486, 'recall': 0.42194426473054897, 'f1-score': 0.40829150097963063, 'support': 125199}, '2': {'precision': 0.40382965210164656, 'recall': 0.4836850964651042, 'f1-score': 0.4401648187766735, 'support': 123568}, 'accuracy': 0.4037059809798286, 'macro avg': {'precision': 0.40511342922955157, 'recall': 0.40276777853950213, 'f1-score': 0.3996213164505837, 'support': 369187}, 'weighted avg': {'precision': 0.4049779697365409, 'recall': 0.4037059809798286, 'f1-score': 0.4000792571613531, 'support': 369187}}
[[36448 38721 45251]
 [29388 52827 42984]
 [21776 42024 59768]]
Evaluating performance on  train set...
494/494 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.018252
{'0': {'precision': 0.4780264378478664, 'recall': 0.39296523127517097, 'f1-score': 0.4313422880236466, 'support': 41963}, '1': {'precision': 0.49789432446990844, 'recall': 0.4881649702323795, 'f1-score': 0.4929816480399525, 'support': 41656}, '2': {'precision': 0.4587863563213879, 'recall': 0.547817120896117, 'f1-score': 0.49936449955675183, 'support': 42673}, 'accuracy': 0.4766889430842809, 'macro avg': {'precision': 0.4782357062130542, 'recall': 0.4763157741345558, 'f1-score': 0.47456281187345034, 'support': 126292}, 'weighted avg': {'precision': 0.47807857643264107, 'recall': 0.4766889430842809, 'f1-score': 0.4746574704072611, 'support': 126292}}
[[16490  9815 15658]
 [ 9402 20335 11919]
 [ 8604 10692 23377]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0398581
{'0': {'precision': 0.46753907887644486, 'recall': 0.3751682045367166, 'f1-score': 0.4162911611785095, 'support': 41616}, '1': {'precision': 0.4572912428499629, 'recall': 0.45603608764141484, 'f1-score': 0.4566628027867735, 'support': 41898}, '2': {'precision': 0.44247285532622516, 'recall': 0.5287063443826265, 'f1-score': 0.481761153653627, 'support': 42778}, 'accuracy': 0.45400342064422133, 'macro avg': {'precision': 0.455767725684211, 'recall': 0.4533035455202527, 'f1-score': 0.45157170587297, 'support': 126292}, 'weighted avg': {'precision': 0.4556488028109076, 'recall': 0.45400342064422133, 'f1-score': 0.45186084396287923, 'support': 126292}}
[[15613 10643 15360]
 [ 9653 19107 13138]
 [ 8128 12033 22617]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0547261
{'0': {'precision': 0.45579358874120407, 'recall': 0.35041234882546707, 'f1-score': 0.39621564309599544, 'support': 41591}, '1': {'precision': 0.42140646913470314, 'recall': 0.45310929197185124, 'f1-score': 0.4366832374075825, 'support': 41778}, '2': {'precision': 0.4338610413798688, 'recall': 0.499289425249866, 'f1-score': 0.4642814588546237, 'support': 42923}, 'accuracy': 0.4349840053210021, 'macro avg': {'precision': 0.43702036641859204, 'recall': 0.43427035534906144, 'f1-score': 0.43239344645273387, 'support': 126292}, 'weighted avg': {'precision': 0.4369639256326066, 'recall': 0.4349840053210021, 'f1-score': 0.4327361207585322, 'support': 126292}}
[[14574 12314 14703]
 [ 9586 18930 13262]
 [ 7815 13677 21431]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0693126
{'0': {'precision': 0.43281938325991187, 'recall': 0.3114852531463157, 'f1-score': 0.36226256983240224, 'support': 41636}, '1': {'precision': 0.4049540773726691, 'recall': 0.4851617205735245, 'f1-score': 0.4414441747572816, 'support': 41986}, '2': {'precision': 0.42373875635510366, 'recall': 0.4570658542301383, 'f1-score': 0.43977180481645173, 'support': 42670}, 'accuracy': 0.41841130079498307, 'macro avg': {'precision': 0.4205040723292282, 'recall': 0.4179042759833262, 'f1-score': 0.4144928498020452, 'support': 126292}, 'weighted avg': {'precision': 0.42048746134078835, 'recall': 0.41841130079498307, 'f1-score': 0.41477450979016184, 'support': 126292}}
[[12969 14532 14135]
 [ 9228 20370 12388]
 [ 7767 15400 19503]]
Evaluating performance on  val set...
150/150 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0349146
{'0': {'precision': 0.4816313491640933, 'recall': 0.3501858160421183, 'f1-score': 0.40552293002196615, 'support': 12916}, '1': {'precision': 0.4704180064308682, 'recall': 0.45926856066551563, 'f1-score': 0.4647764276070209, 'support': 12742}, '2': {'precision': 0.43298400441257584, 'recall': 0.5656525220176141, 'f1-score': 0.49050577984517646, 'support': 12490}, 'accuracy': 0.45716682394883085, 'macro avg': {'precision': 0.4616777866691791, 'recall': 0.45836896624174933, 'f1-score': 0.4536017124913878, 'support': 38148}, 'weighted avg': {'precision': 0.4619583453617129, 'recall': 0.45716682394883085, 'f1-score': 0.4531386336111625, 'support': 38148}}
[[4523 3320 5073]
 [2711 5852 4179]
 [2157 3268 7065]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0524721
{'0': {'precision': 0.4704780788719982, 'recall': 0.3340894868585732, 'f1-score': 0.39072363004299693, 'support': 12784}, '1': {'precision': 0.4451557498633773, 'recall': 0.4367675220222137, 'f1-score': 0.4409217445097433, 'support': 13055}, '2': {'precision': 0.4127052456798475, 'recall': 0.5452108213502316, 'f1-score': 0.4697934896744838, 'support': 12309}, 'accuracy': 0.43734927125930584, 'macro avg': {'precision': 0.442779691471741, 'recall': 0.4386892767436728, 'f1-score': 0.43381295474240805, 'support': 38148}, 'weighted avg': {'precision': 0.4431710428813898, 'recall': 0.43734927125930584, 'f1-score': 0.4334154431542307, 'support': 38148}}
[[4271 3549 4964]
 [2767 5702 4586]
 [2040 3558 6711]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0656897
{'0': {'precision': 0.4658601837850413, 'recall': 0.31044105108131154, 'f1-score': 0.37259279933017025, 'support': 12901}, '1': {'precision': 0.40677601890982024, 'recall': 0.44590138190954776, 'f1-score': 0.4254410607933476, 'support': 12736}, '2': {'precision': 0.41122514432328416, 'recall': 0.5124290624250659, 'f1-score': 0.45628269456602966, 'support': 12511}, 'accuracy': 0.4219094054734193, 'macro avg': {'precision': 0.4279537823393819, 'recall': 0.4229238318053084, 'f1-score': 0.41810551822984915, 'support': 38148}, 'weighted avg': {'precision': 0.4282164042276108, 'recall': 0.4219094054734193, 'f1-score': 0.4176834918249502, 'support': 38148}}
[[4005 4117 4779]
 [2657 5679 4400]
 [1935 4165 6411]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0765508
{'0': {'precision': 0.4374766238623613, 'recall': 0.27913451594940736, 'f1-score': 0.34081196581196577, 'support': 12571}, '1': {'precision': 0.40827235125676103, 'recall': 0.485178463399879, 'f1-score': 0.4434154601057397, 'support': 13224}, '2': {'precision': 0.399458784346378, 'recall': 0.4660406379017243, 'f1-score': 0.430188679245283, 'support': 12353}, 'accuracy': 0.41108314983747507, 'macro avg': {'precision': 0.41506925315516674, 'recall': 0.4101178724170036, 'f1-score': 0.40480536838766285, 'support': 38148}, 'weighted avg': {'precision': 0.4150421142556349, 'recall': 0.41108314983747507, 'f1-score': 0.4053212231670731, 'support': 38148}}
[[3509 4618 4444]
 [2597 6416 4211]
 [1915 4681 5757]]
training model: results/PCAR/W8/deepVOL_L3/seq2seq
Epoch 1/50
494/494 - 30s - loss: 13.1603 - accuracy10: 0.3754 - accuracy20: 0.3723 - accuracy30: 0.3677 - accuracy50: 0.3716 - val_loss: 13.1411 - val_accuracy10: 0.3677 - val_accuracy20: 0.3598 - val_accuracy30: 0.3461 - val_accuracy50: 0.3558 - 30s/epoch - 60ms/step
Epoch 2/50
494/494 - 23s - loss: 13.0725 - accuracy10: 0.3883 - accuracy20: 0.3813 - accuracy30: 0.3735 - accuracy50: 0.3733 - val_loss: 12.9474 - val_accuracy10: 0.4188 - val_accuracy20: 0.4131 - val_accuracy30: 0.4051 - val_accuracy50: 0.4015 - 23s/epoch - 47ms/step
Epoch 3/50
494/494 - 23s - loss: 12.9237 - accuracy10: 0.4132 - accuracy20: 0.4074 - accuracy30: 0.3979 - accuracy50: 0.3936 - val_loss: 12.8454 - val_accuracy10: 0.4265 - val_accuracy20: 0.4201 - val_accuracy30: 0.4095 - val_accuracy50: 0.4066 - 23s/epoch - 46ms/step
Epoch 4/50
494/494 - 23s - loss: 12.8227 - accuracy10: 0.4303 - accuracy20: 0.4208 - accuracy30: 0.4098 - accuracy50: 0.4003 - val_loss: 12.7657 - val_accuracy10: 0.4451 - val_accuracy20: 0.4357 - val_accuracy30: 0.4245 - val_accuracy50: 0.4148 - 23s/epoch - 46ms/step
Epoch 5/50
494/494 - 23s - loss: 12.7613 - accuracy10: 0.4381 - accuracy20: 0.4284 - accuracy30: 0.4175 - accuracy50: 0.4048 - val_loss: 12.7700 - val_accuracy10: 0.4439 - val_accuracy20: 0.4318 - val_accuracy30: 0.4205 - val_accuracy50: 0.4105 - 23s/epoch - 47ms/step
Epoch 6/50
494/494 - 23s - loss: 12.6942 - accuracy10: 0.4471 - accuracy20: 0.4355 - accuracy30: 0.4234 - accuracy50: 0.4098 - val_loss: 12.7360 - val_accuracy10: 0.4508 - val_accuracy20: 0.4395 - val_accuracy30: 0.4260 - val_accuracy50: 0.4154 - 23s/epoch - 47ms/step
Epoch 7/50
494/494 - 22s - loss: 12.6480 - accuracy10: 0.4558 - accuracy20: 0.4434 - accuracy30: 0.4287 - accuracy50: 0.4162 - val_loss: 12.6818 - val_accuracy10: 0.4533 - val_accuracy20: 0.4424 - val_accuracy30: 0.4293 - val_accuracy50: 0.4198 - 22s/epoch - 45ms/step
Epoch 8/50
494/494 - 22s - loss: 12.5907 - accuracy10: 0.4617 - accuracy20: 0.4478 - accuracy30: 0.4339 - accuracy50: 0.4206 - val_loss: 12.7034 - val_accuracy10: 0.4540 - val_accuracy20: 0.4415 - val_accuracy30: 0.4264 - val_accuracy50: 0.4168 - 22s/epoch - 45ms/step
Epoch 9/50
494/494 - 23s - loss: 12.5337 - accuracy10: 0.4698 - accuracy20: 0.4548 - accuracy30: 0.4401 - accuracy50: 0.4271 - val_loss: 12.6996 - val_accuracy10: 0.4530 - val_accuracy20: 0.4386 - val_accuracy30: 0.4244 - val_accuracy50: 0.4146 - 23s/epoch - 47ms/step
Epoch 10/50
494/494 - 22s - loss: 12.4934 - accuracy10: 0.4734 - accuracy20: 0.4575 - accuracy30: 0.4409 - accuracy50: 0.4296 - val_loss: 12.7498 - val_accuracy10: 0.4481 - val_accuracy20: 0.4325 - val_accuracy30: 0.4175 - val_accuracy50: 0.4143 - 22s/epoch - 45ms/step
Epoch 11/50
494/494 - 22s - loss: 12.4453 - accuracy10: 0.4762 - accuracy20: 0.4615 - accuracy30: 0.4458 - accuracy50: 0.4343 - val_loss: 12.6805 - val_accuracy10: 0.4535 - val_accuracy20: 0.4385 - val_accuracy30: 0.4237 - val_accuracy50: 0.4176 - 22s/epoch - 45ms/step
Epoch 12/50
494/494 - 22s - loss: 12.4174 - accuracy10: 0.4788 - accuracy20: 0.4643 - accuracy30: 0.4479 - accuracy50: 0.4367 - val_loss: 12.7282 - val_accuracy10: 0.4471 - val_accuracy20: 0.4280 - val_accuracy30: 0.4142 - val_accuracy50: 0.4125 - 22s/epoch - 45ms/step
Epoch 13/50
494/494 - 23s - loss: 12.3794 - accuracy10: 0.4832 - accuracy20: 0.4679 - accuracy30: 0.4515 - accuracy50: 0.4403 - val_loss: 12.7615 - val_accuracy10: 0.4447 - val_accuracy20: 0.4267 - val_accuracy30: 0.4095 - val_accuracy50: 0.4031 - 23s/epoch - 46ms/step
Epoch 14/50
494/494 - 22s - loss: 12.3473 - accuracy10: 0.4852 - accuracy20: 0.4698 - accuracy30: 0.4534 - accuracy50: 0.4429 - val_loss: 12.7315 - val_accuracy10: 0.4525 - val_accuracy20: 0.4312 - val_accuracy30: 0.4143 - val_accuracy50: 0.4101 - 22s/epoch - 45ms/step
Epoch 15/50
494/494 - 23s - loss: 12.3238 - accuracy10: 0.4876 - accuracy20: 0.4724 - accuracy30: 0.4561 - accuracy50: 0.4443 - val_loss: 12.6824 - val_accuracy10: 0.4572 - val_accuracy20: 0.4369 - val_accuracy30: 0.4227 - val_accuracy50: 0.4143 - 23s/epoch - 46ms/step
Epoch 16/50
494/494 - 23s - loss: 12.2998 - accuracy10: 0.4905 - accuracy20: 0.4761 - accuracy30: 0.4578 - accuracy50: 0.4459 - val_loss: 12.7699 - val_accuracy10: 0.4506 - val_accuracy20: 0.4314 - val_accuracy30: 0.4147 - val_accuracy50: 0.4052 - 23s/epoch - 46ms/step
Epoch 17/50
494/494 - 23s - loss: 12.2803 - accuracy10: 0.4906 - accuracy20: 0.4770 - accuracy30: 0.4593 - accuracy50: 0.4479 - val_loss: 12.7261 - val_accuracy10: 0.4561 - val_accuracy20: 0.4363 - val_accuracy30: 0.4180 - val_accuracy50: 0.4072 - 23s/epoch - 47ms/step
Epoch 18/50
494/494 - 23s - loss: 12.2597 - accuracy10: 0.4919 - accuracy20: 0.4768 - accuracy30: 0.4595 - accuracy50: 0.4481 - val_loss: 12.7261 - val_accuracy10: 0.4577 - val_accuracy20: 0.4370 - val_accuracy30: 0.4178 - val_accuracy50: 0.4121 - 23s/epoch - 46ms/step
Epoch 19/50
494/494 - 23s - loss: 12.2425 - accuracy10: 0.4942 - accuracy20: 0.4801 - accuracy30: 0.4615 - accuracy50: 0.4498 - val_loss: 12.7206 - val_accuracy10: 0.4570 - val_accuracy20: 0.4377 - val_accuracy30: 0.4197 - val_accuracy50: 0.4115 - 23s/epoch - 47ms/step
Epoch 20/50
494/494 - 23s - loss: 12.2221 - accuracy10: 0.4935 - accuracy20: 0.4798 - accuracy30: 0.4619 - accuracy50: 0.4519 - val_loss: 12.7019 - val_accuracy10: 0.4626 - val_accuracy20: 0.4416 - val_accuracy30: 0.4232 - val_accuracy50: 0.4164 - 23s/epoch - 47ms/step
Epoch 21/50
494/494 - 22s - loss: 12.2081 - accuracy10: 0.4952 - accuracy20: 0.4818 - accuracy30: 0.4646 - accuracy50: 0.4548 - val_loss: 12.6738 - val_accuracy10: 0.4631 - val_accuracy20: 0.4431 - val_accuracy30: 0.4248 - val_accuracy50: 0.4156 - 22s/epoch - 45ms/step
Epoch 22/50
494/494 - 22s - loss: 12.1919 - accuracy10: 0.4967 - accuracy20: 0.4830 - accuracy30: 0.4659 - accuracy50: 0.4557 - val_loss: 12.8032 - val_accuracy10: 0.4550 - val_accuracy20: 0.4329 - val_accuracy30: 0.4162 - val_accuracy50: 0.4071 - 22s/epoch - 45ms/step
Epoch 23/50
494/494 - 22s - loss: 12.1745 - accuracy10: 0.4974 - accuracy20: 0.4843 - accuracy30: 0.4666 - accuracy50: 0.4557 - val_loss: 12.7686 - val_accuracy10: 0.4603 - val_accuracy20: 0.4382 - val_accuracy30: 0.4187 - val_accuracy50: 0.4084 - 22s/epoch - 45ms/step
Epoch 24/50
494/494 - 23s - loss: 12.1621 - accuracy10: 0.4989 - accuracy20: 0.4852 - accuracy30: 0.4689 - accuracy50: 0.4573 - val_loss: 12.7882 - val_accuracy10: 0.4543 - val_accuracy20: 0.4336 - val_accuracy30: 0.4189 - val_accuracy50: 0.4100 - 23s/epoch - 46ms/step
Epoch 25/50
494/494 - 23s - loss: 12.1414 - accuracy10: 0.4994 - accuracy20: 0.4859 - accuracy30: 0.4695 - accuracy50: 0.4589 - val_loss: 12.7882 - val_accuracy10: 0.4565 - val_accuracy20: 0.4319 - val_accuracy30: 0.4162 - val_accuracy50: 0.4071 - 23s/epoch - 47ms/step
Epoch 26/50
494/494 - 23s - loss: 12.1245 - accuracy10: 0.5001 - accuracy20: 0.4876 - accuracy30: 0.4722 - accuracy50: 0.4604 - val_loss: 12.7915 - val_accuracy10: 0.4561 - val_accuracy20: 0.4348 - val_accuracy30: 0.4181 - val_accuracy50: 0.4068 - 23s/epoch - 46ms/step
Epoch 27/50
494/494 - 22s - loss: 12.1070 - accuracy10: 0.5030 - accuracy20: 0.4897 - accuracy30: 0.4743 - accuracy50: 0.4619 - val_loss: 12.8529 - val_accuracy10: 0.4560 - val_accuracy20: 0.4321 - val_accuracy30: 0.4166 - val_accuracy50: 0.4054 - 22s/epoch - 45ms/step
Epoch 28/50
494/494 - 23s - loss: 12.0900 - accuracy10: 0.5030 - accuracy20: 0.4906 - accuracy30: 0.4748 - accuracy50: 0.4640 - val_loss: 12.7990 - val_accuracy10: 0.4544 - val_accuracy20: 0.4312 - val_accuracy30: 0.4173 - val_accuracy50: 0.4072 - 23s/epoch - 46ms/step
Epoch 29/50
494/494 - 23s - loss: 12.0697 - accuracy10: 0.5048 - accuracy20: 0.4935 - accuracy30: 0.4767 - accuracy50: 0.4642 - val_loss: 12.8488 - val_accuracy10: 0.4524 - val_accuracy20: 0.4308 - val_accuracy30: 0.4185 - val_accuracy50: 0.4104 - 23s/epoch - 46ms/step
Epoch 30/50
494/494 - 22s - loss: 12.0500 - accuracy10: 0.5054 - accuracy20: 0.4936 - accuracy30: 0.4780 - accuracy50: 0.4666 - val_loss: 12.8553 - val_accuracy10: 0.4488 - val_accuracy20: 0.4276 - val_accuracy30: 0.4114 - val_accuracy50: 0.4078 - 22s/epoch - 45ms/step
Epoch 31/50
494/494 - 22s - loss: 12.0400 - accuracy10: 0.5064 - accuracy20: 0.4948 - accuracy30: 0.4789 - accuracy50: 0.4680 - val_loss: 12.8021 - val_accuracy10: 0.4493 - val_accuracy20: 0.4302 - val_accuracy30: 0.4156 - val_accuracy50: 0.4058 - 22s/epoch - 45ms/step
testing model: results/PCAR/W8/deepVOL_L3/seq2seq
Evaluating performance on  test set...
1443/1443 - 31s - 31s/epoch - 22ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0443006
{'0': {'precision': 0.4602328293086587, 'recall': 0.3999722145040289, 'f1-score': 0.4279917799833851, 'support': 122366}, '1': {'precision': 0.46327117230610904, 'recall': 0.4204800747248146, 'f1-score': 0.44083965437914446, 'support': 124189}, '2': {'precision': 0.43754870940882595, 'recall': 0.5356432252593124, 'f1-score': 0.48165216658050936, 'support': 122632}, 'accuracy': 0.4519362816133829, 'macro avg': {'precision': 0.4536842370078646, 'recall': 0.45203183816271864, 'f1-score': 0.4501612003143463, 'support': 369187}, 'weighted avg': {'precision': 0.4537199504341428, 'recall': 0.4519362816133829, 'f1-score': 0.45013786097354325, 'support': 369187}}
[[48943 30228 43195]
 [30727 52219 41243]
 [26674 30271 65687]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0580548
{'0': {'precision': 0.452180443061739, 'recall': 0.35145794595135454, 'f1-score': 0.39550726269564235, 'support': 119929}, '1': {'precision': 0.4333545064246302, 'recall': 0.44412897356057696, 'f1-score': 0.4386755910879737, 'support': 127499}, '2': {'precision': 0.4262541034940779, 'recall': 0.5086769766505966, 'f1-score': 0.4638323685136785, 'support': 121759}, 'accuracy': 0.43531326942714665, 'macro avg': {'precision': 0.437263017660149, 'recall': 0.434754632054176, 'f1-score': 0.4326717407657648, 'support': 369187}, 'weighted avg': {'precision': 0.4371283061373251, 'recall': 0.43531326942714665, 'f1-score': 0.4329493049695906, 'support': 369187}}
[[42150 36976 40803]
 [28309 56626 42564]
 [22756 37067 61936]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0704955
{'0': {'precision': 0.44527898243207104, 'recall': 0.316345073680037, 'f1-score': 0.3698985381966746, 'support': 121064}, '1': {'precision': 0.4028974130741034, 'recall': 0.4655108188649909, 'f1-score': 0.43194686042973024, 'support': 123488}, '2': {'precision': 0.4262165567014712, 'recall': 0.48046696353351787, 'f1-score': 0.45171875353594787, 'support': 124635}, 'accuracy': 0.42164539921503197, 'macro avg': {'precision': 0.42479765073588194, 'recall': 0.4207742853595153, 'f1-score': 0.41785471738745095, 'support': 369187}, 'weighted avg': {'precision': 0.42466758314712877, 'recall': 0.42164539921503197, 'f1-score': 0.41827479671803613, 'support': 369187}}
[[38298 42229 40537]
 [25924 57485 40079]
 [21787 42965 59883]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0804851
{'0': {'precision': 0.42720522340289335, 'recall': 0.27710513203786746, 'f1-score': 0.33616078174583186, 'support': 120420}, '1': {'precision': 0.40187574440488144, 'recall': 0.5147485203555939, 'f1-score': 0.4513625762531429, 'support': 125199}, '2': {'precision': 0.4141713970959499, 'recall': 0.43812313867668007, 'f1-score': 0.4258107140890822, 'support': 123568}, 'accuracy': 0.4115881653471005, 'macro avg': {'precision': 0.41441745496790827, 'recall': 0.4099922636900472, 'f1-score': 0.404444690696019, 'support': 369187}, 'weighted avg': {'precision': 0.41425300869823567, 'recall': 0.4115881653471005, 'f1-score': 0.4052342114990778, 'support': 369187}}
[[33369 47468 39583]
 [23760 64446 36993]
 [20981 48449 54138]]
Evaluating performance on  train set...
494/494 - 10s - 10s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0131321
{'0': {'precision': 0.48777938328158144, 'recall': 0.3780949884421991, 'f1-score': 0.4259900657806417, 'support': 41963}, '1': {'precision': 0.4800661669249131, 'recall': 0.550388899558287, 'f1-score': 0.5128279687744648, 'support': 41656}, '2': {'precision': 0.4728845610450584, 'recall': 0.5098305720244651, 'f1-score': 0.49066305818673883, 'support': 42673}, 'accuracy': 0.4794365438824312, 'macro avg': {'precision': 0.4802433704171843, 'recall': 0.47943815334165035, 'f1-score': 0.4764936975806151, 'support': 126292}, 'weighted avg': {'precision': 0.48020243074418767, 'recall': 0.4794365438824312, 'f1-score': 0.4764850321447509, 'support': 126292}}
[[15866 12754 13343]
 [ 7821 22927 10908]
 [ 8840 12077 21756]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0359119
{'0': {'precision': 0.4849549357746079, 'recall': 0.3284073433294887, 'f1-score': 0.39161580561047593, 'support': 41616}, '1': {'precision': 0.4411525897392322, 'recall': 0.5576161153277006, 'f1-score': 0.49259411535258335, 'support': 41898}, '2': {'precision': 0.46067639697902596, 'recall': 0.48623124035719295, 'f1-score': 0.47310898565888393, 'support': 42778}, 'accuracy': 0.4579070724986539, 'macro avg': {'precision': 0.462261307497622, 'recall': 0.45741823300479406, 'f1-score': 0.4524396355406477, 'support': 126292}, 'weighted avg': {'precision': 0.46219959080590384, 'recall': 0.4579070724986539, 'f1-score': 0.4527194739163513, 'support': 126292}}
[[13667 14993 12956]
 [ 7140 23363 11395]
 [ 7375 14603 20800]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0519346
{'0': {'precision': 0.4758511785549222, 'recall': 0.2970594599793224, 'f1-score': 0.3657760343423877, 'support': 41591}, '1': {'precision': 0.41347040056717477, 'recall': 0.5583800086169755, 'f1-score': 0.4751216929061692, 'support': 41778}, '2': {'precision': 0.4504646078163433, 'recall': 0.46080190107867575, 'f1-score': 0.4555746219668091, 'support': 42923}, 'accuracy': 0.4391568745447059, 'macro avg': {'precision': 0.44659539564614675, 'recall': 0.43874712322499115, 'f1-score': 0.4321574497384553, 'support': 126292}, 'weighted avg': {'precision': 0.44658715614191, 'recall': 0.4391568745447059, 'f1-score': 0.432468047297133, 'support': 126292}}
[[12355 16668 12568]
 [ 6889 23328 11561]
 [ 6720 16424 19779]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.065554
{'0': {'precision': 0.4616264779421113, 'recall': 0.2616245556729753, 'f1-score': 0.33397206935140195, 'support': 41636}, '1': {'precision': 0.40446447525269846, 'recall': 0.5899347401514791, 'f1-score': 0.4799031242431582, 'support': 41986}, '2': {'precision': 0.4356184870706291, 'recall': 0.4232247480665573, 'f1-score': 0.42933219218790863, 'support': 42670}, 'accuracy': 0.4253713616064359, 'macro avg': {'precision': 0.43390314675514635, 'recall': 0.4249280146303372, 'f1-score': 0.41440246192748953, 'support': 126292}, 'weighted avg': {'precision': 0.4338356058725912, 'recall': 0.4253713616064359, 'f1-score': 0.41470622283791747, 'support': 126292}}
[[10893 18234 12509]
 [ 6329 24769 10888]
 [ 6375 18236 18059]]
Evaluating performance on  val set...
150/150 - 3s - 3s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0306089
{'0': {'precision': 0.49481077681098645, 'recall': 0.36543821616599564, 'f1-score': 0.4203963482520597, 'support': 12916}, '1': {'precision': 0.4594983552631579, 'recall': 0.5262125255062, 'f1-score': 0.4905977902977976, 'support': 12742}, '2': {'precision': 0.4480987372476279, 'recall': 0.5028823058446757, 'f1-score': 0.4739125514015166, 'support': 12490}, 'accuracy': 0.4641396665618119, 'macro avg': {'precision': 0.4674692897739241, 'recall': 0.46484434917229045, 'f1-score': 0.4616355633171246, 'support': 38148}, 'weighted avg': {'precision': 0.46772195827505325, 'recall': 0.4641396665618119, 'f1-score': 0.46136636376751294, 'support': 38148}}
[[4720 4054 4142]
 [2443 6705 3594]
 [2376 3833 6281]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.051089
{'0': {'precision': 0.4892225720513442, 'recall': 0.3160200250312891, 'f1-score': 0.38399391692804863, 'support': 12784}, '1': {'precision': 0.43339016074037995, 'recall': 0.5452317119877441, 'f1-score': 0.4829200447776383, 'support': 13055}, '2': {'precision': 0.42908064755680975, 'recall': 0.46941262490860347, 'f1-score': 0.4483414161008729, 'support': 12309}, 'accuracy': 0.4439551221558142, 'macro avg': {'precision': 0.450564460116178, 'recall': 0.4435547873092123, 'f1-score': 0.4384184592688533, 'support': 38148}, 'weighted avg': {'precision': 0.4507099612128241, 'recall': 0.4439551221558142, 'f1-score': 0.4386110388320721, 'support': 38148}}
[[4040 4785 3959]
 [2208 7118 3729]
 [2010 4521 5778]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0670561
{'0': {'precision': 0.4759421045768679, 'recall': 0.2829238043562515, 'f1-score': 0.3548857559552747, 'support': 12901}, '1': {'precision': 0.4016117048636909, 'recall': 0.5517430904522613, 'f1-score': 0.4648562828697119, 'support': 12736}, '2': {'precision': 0.42689878293021105, 'recall': 0.44297018623611223, 'f1-score': 0.43478601969168007, 'support': 12511}, 'accuracy': 0.42515990353360594, 'macro avg': {'precision': 0.43481753079025665, 'recall': 0.42587902701487496, 'f1-score': 0.41817601950555555, 'support': 38148}, 'weighted avg': {'precision': 0.435042110661896, 'recall': 0.42515990353360594, 'f1-score': 0.41780430556176623, 'support': 38148}}
[[3650 5397 3854]
 [2123 7027 3586]
 [1896 5073 5542]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.077176
{'0': {'precision': 0.4468115733410105, 'recall': 0.24691750855142788, 'f1-score': 0.31806537555077363, 'support': 12571}, '1': {'precision': 0.40923350413050297, 'recall': 0.5918784029038112, 'f1-score': 0.4838948995363215, 'support': 13224}, '2': {'precision': 0.4087784679089027, 'recall': 0.3995790496235732, 'f1-score': 0.40412641231373836, 'support': 12353}, 'accuracy': 0.4159326832337213, 'macro avg': {'precision': 0.4216078484601387, 'recall': 0.41279165369293747, 'f1-score': 0.40202889580027784, 'support': 38148}, 'weighted avg': {'precision': 0.4214693446883268, 'recall': 0.4159326832337213, 'f1-score': 0.4034182541372733, 'support': 38148}}
[[3104 5724 3743]
 [2001 7827 3396]
 [1842 5575 4936]]
training model: results/PCAR/W9/deepLOB_L1/seq2seq
Epoch 1/50
477/477 - 22s - loss: 12.9652 - accuracy10: 0.4134 - accuracy20: 0.4061 - accuracy30: 0.4000 - accuracy50: 0.3920 - val_loss: 13.2432 - val_accuracy10: 0.3859 - val_accuracy20: 0.3711 - val_accuracy30: 0.3689 - val_accuracy50: 0.3560 - 22s/epoch - 45ms/step
Epoch 2/50
477/477 - 14s - loss: 12.8493 - accuracy10: 0.4314 - accuracy20: 0.4192 - accuracy30: 0.4108 - accuracy50: 0.3984 - val_loss: 13.0115 - val_accuracy10: 0.4131 - val_accuracy20: 0.3998 - val_accuracy30: 0.3973 - val_accuracy50: 0.3807 - 14s/epoch - 29ms/step
Epoch 3/50
477/477 - 14s - loss: 12.8142 - accuracy10: 0.4409 - accuracy20: 0.4254 - accuracy30: 0.4142 - accuracy50: 0.4021 - val_loss: 12.9020 - val_accuracy10: 0.4308 - val_accuracy20: 0.4129 - val_accuracy30: 0.4046 - val_accuracy50: 0.3905 - 14s/epoch - 29ms/step
Epoch 4/50
477/477 - 14s - loss: 12.7662 - accuracy10: 0.4481 - accuracy20: 0.4306 - accuracy30: 0.4188 - accuracy50: 0.4042 - val_loss: 12.8219 - val_accuracy10: 0.4480 - val_accuracy20: 0.4292 - val_accuracy30: 0.4161 - val_accuracy50: 0.4032 - 14s/epoch - 30ms/step
Epoch 5/50
477/477 - 14s - loss: 12.7218 - accuracy10: 0.4557 - accuracy20: 0.4366 - accuracy30: 0.4230 - accuracy50: 0.4087 - val_loss: 12.9889 - val_accuracy10: 0.4258 - val_accuracy20: 0.4069 - val_accuracy30: 0.3988 - val_accuracy50: 0.3847 - 14s/epoch - 29ms/step
Epoch 6/50
477/477 - 14s - loss: 12.6987 - accuracy10: 0.4565 - accuracy20: 0.4376 - accuracy30: 0.4253 - accuracy50: 0.4067 - val_loss: 12.9393 - val_accuracy10: 0.4247 - val_accuracy20: 0.4093 - val_accuracy30: 0.4023 - val_accuracy50: 0.3888 - 14s/epoch - 29ms/step
Epoch 7/50
477/477 - 14s - loss: 12.6564 - accuracy10: 0.4610 - accuracy20: 0.4415 - accuracy30: 0.4270 - accuracy50: 0.4102 - val_loss: 12.9707 - val_accuracy10: 0.4340 - val_accuracy20: 0.4170 - val_accuracy30: 0.4081 - val_accuracy50: 0.3885 - 14s/epoch - 30ms/step
Epoch 8/50
477/477 - 14s - loss: 12.6321 - accuracy10: 0.4641 - accuracy20: 0.4421 - accuracy30: 0.4286 - accuracy50: 0.4073 - val_loss: 13.0591 - val_accuracy10: 0.4355 - val_accuracy20: 0.4180 - val_accuracy30: 0.4054 - val_accuracy50: 0.3949 - 14s/epoch - 29ms/step
Epoch 9/50
477/477 - 14s - loss: 12.5829 - accuracy10: 0.4695 - accuracy20: 0.4470 - accuracy30: 0.4340 - accuracy50: 0.4152 - val_loss: 13.0359 - val_accuracy10: 0.4407 - val_accuracy20: 0.4253 - val_accuracy30: 0.4144 - val_accuracy50: 0.3982 - 14s/epoch - 29ms/step
Epoch 10/50
477/477 - 14s - loss: 12.5750 - accuracy10: 0.4688 - accuracy20: 0.4475 - accuracy30: 0.4340 - accuracy50: 0.4145 - val_loss: 12.9143 - val_accuracy10: 0.4353 - val_accuracy20: 0.4194 - val_accuracy30: 0.4051 - val_accuracy50: 0.3850 - 14s/epoch - 29ms/step
Epoch 11/50
477/477 - 14s - loss: 12.5467 - accuracy10: 0.4703 - accuracy20: 0.4494 - accuracy30: 0.4355 - accuracy50: 0.4160 - val_loss: 12.9830 - val_accuracy10: 0.4307 - val_accuracy20: 0.4179 - val_accuracy30: 0.4027 - val_accuracy50: 0.3856 - 14s/epoch - 29ms/step
Epoch 12/50
477/477 - 14s - loss: 12.5310 - accuracy10: 0.4718 - accuracy20: 0.4508 - accuracy30: 0.4363 - accuracy50: 0.4179 - val_loss: 12.9933 - val_accuracy10: 0.4339 - val_accuracy20: 0.4168 - val_accuracy30: 0.4021 - val_accuracy50: 0.3918 - 14s/epoch - 29ms/step
Epoch 13/50
477/477 - 14s - loss: 12.5059 - accuracy10: 0.4730 - accuracy20: 0.4528 - accuracy30: 0.4382 - accuracy50: 0.4209 - val_loss: 13.0123 - val_accuracy10: 0.4289 - val_accuracy20: 0.4109 - val_accuracy30: 0.3968 - val_accuracy50: 0.3914 - 14s/epoch - 30ms/step
Epoch 14/50
477/477 - 14s - loss: 12.4815 - accuracy10: 0.4756 - accuracy20: 0.4550 - accuracy30: 0.4410 - accuracy50: 0.4218 - val_loss: 12.9678 - val_accuracy10: 0.4398 - val_accuracy20: 0.4223 - val_accuracy30: 0.4062 - val_accuracy50: 0.3894 - 14s/epoch - 29ms/step
testing model: results/PCAR/W9/deepLOB_L1/seq2seq
Evaluating performance on  test set...
631/631 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0581005
{'0': {'precision': 0.4520850323492633, 'recall': 0.679812943523333, 'f1-score': 0.5430405621624447, 'support': 61158}, '1': {'precision': 0.3233316088980859, 'recall': 0.06255630067060354, 'f1-score': 0.10483059376048305, 'support': 39964}, '2': {'precision': 0.4629043514956745, 'recall': 0.4738643538364404, 'f1-score': 0.4683202377726874, 'support': 60186}, 'accuracy': 0.4500458749721031, 'macro avg': {'precision': 0.41277366424767453, 'recall': 0.405411199343459, 'f1-score': 0.3720637978985384, 'support': 161308}, 'weighted avg': {'precision': 0.4242232383114168, 'recall': 0.4500458749721031, 'f1-score': 0.40659512473257187, 'support': 161308}}
[[41576  2739 16843]
 [21216  2500 16248]
 [29173  2493 28520]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0722289
{'0': {'precision': 0.4308614007021763, 'recall': 0.6714632309880365, 'f1-score': 0.5249045152513996, 'support': 59765}, '1': {'precision': 0.3054226475279107, 'recall': 0.061619435059412996, 'f1-score': 0.10254939086197334, 'support': 43509}, '2': {'precision': 0.4439729925409574, 'recall': 0.45435434400523833, 'f1-score': 0.44910368320204386, 'support': 58034}, 'accuracy': 0.42886279663748855, 'macro avg': {'precision': 0.39341901359034814, 'recall': 0.39581233668422927, 'f1-score': 0.35885252977180554, 'support': 161308}, 'weighted avg': {'precision': 0.4017444530548972, 'recall': 0.42886279663748855, 'f1-score': 0.3837132873258667, 'support': 161308}}
[[40130  3104 16531]
 [24336  2681 16492]
 [28673  2993 26368]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0783677
{'0': {'precision': 0.42607188893349957, 'recall': 0.6704239401496259, 'f1-score': 0.5210212150184759, 'support': 60150}, '1': {'precision': 0.3006334841628959, 'recall': 0.07549485262368474, 'f1-score': 0.12068370479356257, 'support': 44003}, '2': {'precision': 0.4303927209954686, 'recall': 0.4187735106289913, 'f1-score': 0.4245036225136787, 'support': 57155}, 'accuracy': 0.41896868103255885, 'macro avg': {'precision': 0.385699364697288, 'recall': 0.3882307678007673, 'f1-score': 0.35540284744190576, 'support': 161308}, 'weighted avg': {'precision': 0.39338467584661585, 'recall': 0.41896868103255885, 'f1-score': 0.37761534263744984, 'support': 161308}}
[[40326  3877 15947]
 [24951  3322 15730]
 [29369  3851 23935]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0835075
{'0': {'precision': 0.4353382515831052, 'recall': 0.6562337560053556, 'f1-score': 0.5234352914570023, 'support': 63485}, '1': {'precision': 0.2480718085106383, 'recall': 0.09494121838261489, 'f1-score': 0.13732562847362803, 'support': 39298}, '2': {'precision': 0.4305121613604904, 'recall': 0.3719948739854763, 'f1-score': 0.3991200329987626, 'support': 58525}, 'accuracy': 0.41636496639968257, 'macro avg': {'precision': 0.3713074071514113, 'recall': 0.3743899494578156, 'f1-score': 0.3532936509764643, 'support': 161308}, 'weighted avg': {'precision': 0.3879652532808491, 'recall': 0.41636496639968257, 'f1-score': 0.3842674384231223, 'support': 161308}}
[[41661  5680 16144]
 [22912  3731 12655]
 [31125  5629 21771]]
Evaluating performance on  train set...
477/477 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0567639
{'0': {'precision': 0.414285500232248, 'recall': 0.6664497312411116, 'f1-score': 0.5109493097776875, 'support': 41487}, '1': {'precision': 0.4836309523809524, 'recall': 0.2247349280336014, 'f1-score': 0.30687183073963975, 'support': 39046}, '2': {'precision': 0.4649103865255884, 'recall': 0.4160587467993623, 'f1-score': 0.4391301022359329, 'support': 41398}, 'accuracy': 0.4399865497699519, 'macro avg': {'precision': 0.4542756130462629, 'recall': 0.4357478020246918, 'f1-score': 0.41898374758442003, 'support': 121931}, 'weighted avg': {'precision': 0.45368017072104916, 'recall': 0.4399865497699519, 'f1-score': 0.4212134690125567, 'support': 121931}}
[[27649  4890  8948]
 [19395  8775 10876]
 [19695  4479 17224]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0663873
{'0': {'precision': 0.3975256559853993, 'recall': 0.6557672375499729, 'f1-score': 0.49498919603606284, 'support': 40522}, '1': {'precision': 0.4703567963781395, 'recall': 0.21411222061385216, 'f1-score': 0.29426938445197515, 'support': 40759}, '2': {'precision': 0.4466617393446662, 'recall': 0.4014022140221402, 'f1-score': 0.4228242702219458, 'support': 40650}, 'accuracy': 0.423329588045698, 'macro avg': {'precision': 0.43818139723606836, 'recall': 0.42376055739532176, 'f1-score': 0.40402761690332795, 'support': 121931}, 'weighted avg': {'precision': 0.43825283971900186, 'recall': 0.423329588045698, 'f1-score': 0.4038340096216179, 'support': 121931}}
[[26573  5139  8810]
 [20628  8727 11404]
 [19645  4688 16317]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0727029
{'0': {'precision': 0.3931339479799115, 'recall': 0.6424459197922536, 'f1-score': 0.48777947248986275, 'support': 40819}, '1': {'precision': 0.4385699899295065, 'recall': 0.2186629176813195, 'f1-score': 0.2918265123213777, 'support': 39833}, '2': {'precision': 0.44050783238138325, 'recall': 0.3774073984350396, 'f1-score': 0.40652358275164724, 'support': 41279}, 'accuracy': 0.4142752868425585, 'macro avg': {'precision': 0.42407059009693376, 'recall': 0.41283874530287096, 'f1-score': 0.3953765225209625, 'support': 121931}, 'weighted avg': {'precision': 0.424015351668773, 'recall': 0.4142752868425585, 'f1-score': 0.39625593758163546, 'support': 121931}}
[[26224  5723  8872]
 [20208  8710 10915]
 [20273  5427 15579]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0812578
{'0': {'precision': 0.3803868549217226, 'recall': 0.6114541143929665, 'f1-score': 0.46900483988596436, 'support': 40492}, '1': {'precision': 0.40613075553294326, 'recall': 0.23778671432826928, 'f1-score': 0.29995302959135745, 'support': 40284}, '2': {'precision': 0.4191123406302622, 'recall': 0.33867087838658727, 'f1-score': 0.3746220316888632, 'support': 41155}, 'accuracy': 0.3959288450025014, 'macro avg': {'precision': 0.40187665036164266, 'recall': 0.395970569035941, 'f1-score': 0.3811933003887284, 'support': 121931}, 'weighted avg': {'precision': 0.40196311244899097, 'recall': 0.3959288450025014, 'f1-score': 0.38129615548856216, 'support': 121931}}
[[24759  7009  8724]
 [20111  9579 10594]
 [20219  6998 13938]]
Evaluating performance on  val set...
184/184 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.054281
{'0': {'precision': 0.4250779913454765, 'recall': 0.5391193363114231, 'f1-score': 0.475354490209318, 'support': 15670}, '1': {'precision': 0.49662795054327463, 'recall': 0.335103021109847, 'f1-score': 0.4001811457468488, 'support': 15822}, '2': {'precision': 0.4458805513016845, 'recall': 0.4731846843918611, 'f1-score': 0.459127034186956, 'support': 15383}, 'accuracy': 0.44861866666666667, 'macro avg': {'precision': 0.45586216439681193, 'recall': 0.4491356806043771, 'f1-score': 0.44488755671437424, 'support': 46875}, 'weighted avg': {'precision': 0.4560554683424666, 'recall': 0.44861866666666667, 'f1-score': 0.4446554051516714, 'support': 46875}}
[[8448 2900 4322]
 [5796 5302 4724]
 [5630 2474 7279]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0652008
{'0': {'precision': 0.4014014014014014, 'recall': 0.526246719160105, 'f1-score': 0.45542305508233966, 'support': 15240}, '1': {'precision': 0.4878696328847386, 'recall': 0.31959937627443924, 'f1-score': 0.38620139870275755, 'support': 16674}, '2': {'precision': 0.4229902329075883, 'recall': 0.45157409264086623, 'f1-score': 0.43681505188633496, 'support': 14961}, 'accuracy': 0.42890666666666666, 'macro avg': {'precision': 0.43742042239790946, 'recall': 0.43247339602513685, 'f1-score': 0.42614650189047737, 'support': 46875}, 'weighted avg': {'precision': 0.4390496531329689, 'recall': 0.42890666666666666, 'f1-score': 0.42486100208418337, 'support': 46875}}
[[8020 2953 4267]
 [6396 5329 4949]
 [5564 2641 6756]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0717126
{'0': {'precision': 0.39752365613046103, 'recall': 0.5121919584954604, 'f1-score': 0.44763092269326676, 'support': 15420}, '1': {'precision': 0.44890731623045693, 'recall': 0.31689024390243903, 'f1-score': 0.37151946241555567, 'support': 16400}, '2': {'precision': 0.41788723266364225, 'recall': 0.4282962470939887, 'f1-score': 0.4230277185501066, 'support': 15055}, 'accuracy': 0.4169173333333333, 'macro avg': {'precision': 0.42143940167485344, 'recall': 0.4191261498306294, 'f1-score': 0.41405936788630965, 'support': 46875}, 'weighted avg': {'precision': 0.42204132376452985, 'recall': 0.4169173333333333, 'f1-score': 0.41310016670543237, 'support': 46875}}
[[7898 3327 4195]
 [6416 5197 4787]
 [5554 3053 6448]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0783281
{'0': {'precision': 0.3772507913445073, 'recall': 0.4808201058201058, 'f1-score': 0.4227850309674042, 'support': 15120}, '1': {'precision': 0.44041101027525686, 'recall': 0.3457982450974619, 'f1-score': 0.3874117569439863, 'support': 16981}, '2': {'precision': 0.39906103286384975, 'recall': 0.38547448219845676, 'f1-score': 0.3921501118953348, 'support': 14774}, 'accuracy': 0.401856, 'macro avg': {'precision': 0.4055742781612046, 'recall': 0.4040309443720082, 'f1-score': 0.40078229993557507, 'support': 46875}, 'weighted avg': {'precision': 0.40700541930973017, 'recall': 0.401856, 'f1-score': 0.4003151886087394, 'support': 46875}}
[[7270 3781 4069]
 [6602 5872 4507]
 [5399 3680 5695]]
training model: results/PCAR/W9/deepOF_L1/seq2seq
Epoch 1/50
477/477 - 20s - loss: 13.1540 - accuracy10: 0.3905 - accuracy20: 0.3839 - accuracy30: 0.3807 - accuracy50: 0.3770 - val_loss: 13.1181 - val_accuracy10: 0.3862 - val_accuracy20: 0.3714 - val_accuracy30: 0.3719 - val_accuracy50: 0.3633 - 20s/epoch - 43ms/step
Epoch 2/50
477/477 - 13s - loss: 13.0866 - accuracy10: 0.4003 - accuracy20: 0.3901 - accuracy30: 0.3871 - accuracy50: 0.3819 - val_loss: 13.0773 - val_accuracy10: 0.3956 - val_accuracy20: 0.3852 - val_accuracy30: 0.3791 - val_accuracy50: 0.3689 - 13s/epoch - 28ms/step
Epoch 3/50
477/477 - 13s - loss: 13.0725 - accuracy10: 0.4012 - accuracy20: 0.3905 - accuracy30: 0.3863 - accuracy50: 0.3819 - val_loss: 13.0508 - val_accuracy10: 0.4054 - val_accuracy20: 0.3891 - val_accuracy30: 0.3865 - val_accuracy50: 0.3742 - 13s/epoch - 28ms/step
Epoch 4/50
477/477 - 13s - loss: 13.0416 - accuracy10: 0.4047 - accuracy20: 0.3958 - accuracy30: 0.3932 - accuracy50: 0.3882 - val_loss: 13.0510 - val_accuracy10: 0.3992 - val_accuracy20: 0.3833 - val_accuracy30: 0.3796 - val_accuracy50: 0.3729 - 13s/epoch - 27ms/step
Epoch 5/50
477/477 - 14s - loss: 13.0239 - accuracy10: 0.4059 - accuracy20: 0.3970 - accuracy30: 0.3953 - accuracy50: 0.3852 - val_loss: 13.0224 - val_accuracy10: 0.4106 - val_accuracy20: 0.3964 - val_accuracy30: 0.3937 - val_accuracy50: 0.3814 - 14s/epoch - 28ms/step
Epoch 6/50
477/477 - 13s - loss: 12.9743 - accuracy10: 0.4109 - accuracy20: 0.4007 - accuracy30: 0.3964 - accuracy50: 0.3865 - val_loss: 12.9783 - val_accuracy10: 0.4129 - val_accuracy20: 0.3989 - val_accuracy30: 0.3978 - val_accuracy50: 0.3865 - 13s/epoch - 28ms/step
Epoch 7/50
477/477 - 13s - loss: 12.9239 - accuracy10: 0.4132 - accuracy20: 0.4027 - accuracy30: 0.3996 - accuracy50: 0.3885 - val_loss: 12.9591 - val_accuracy10: 0.4130 - val_accuracy20: 0.3976 - val_accuracy30: 0.3970 - val_accuracy50: 0.3862 - 13s/epoch - 28ms/step
Epoch 8/50
477/477 - 13s - loss: 12.8792 - accuracy10: 0.4156 - accuracy20: 0.4037 - accuracy30: 0.4007 - accuracy50: 0.3910 - val_loss: 12.9480 - val_accuracy10: 0.4117 - val_accuracy20: 0.3972 - val_accuracy30: 0.3969 - val_accuracy50: 0.3901 - 13s/epoch - 27ms/step
Epoch 9/50
477/477 - 13s - loss: 12.8556 - accuracy10: 0.4172 - accuracy20: 0.4055 - accuracy30: 0.4035 - accuracy50: 0.3931 - val_loss: 12.9443 - val_accuracy10: 0.4127 - val_accuracy20: 0.3961 - val_accuracy30: 0.3950 - val_accuracy50: 0.3883 - 13s/epoch - 27ms/step
Epoch 10/50
477/477 - 13s - loss: 12.8401 - accuracy10: 0.4185 - accuracy20: 0.4062 - accuracy30: 0.4039 - accuracy50: 0.3947 - val_loss: 12.9083 - val_accuracy10: 0.4142 - val_accuracy20: 0.3969 - val_accuracy30: 0.3979 - val_accuracy50: 0.3920 - 13s/epoch - 27ms/step
Epoch 11/50
477/477 - 13s - loss: 12.8258 - accuracy10: 0.4194 - accuracy20: 0.4069 - accuracy30: 0.4057 - accuracy50: 0.3946 - val_loss: 12.9039 - val_accuracy10: 0.4167 - val_accuracy20: 0.4016 - val_accuracy30: 0.3994 - val_accuracy50: 0.3947 - 13s/epoch - 28ms/step
Epoch 12/50
477/477 - 13s - loss: 12.8186 - accuracy10: 0.4211 - accuracy20: 0.4083 - accuracy30: 0.4056 - accuracy50: 0.3977 - val_loss: 12.8995 - val_accuracy10: 0.4151 - val_accuracy20: 0.4002 - val_accuracy30: 0.3992 - val_accuracy50: 0.3929 - 13s/epoch - 28ms/step
Epoch 13/50
477/477 - 14s - loss: 12.8038 - accuracy10: 0.4223 - accuracy20: 0.4108 - accuracy30: 0.4086 - accuracy50: 0.3983 - val_loss: 12.8930 - val_accuracy10: 0.4164 - val_accuracy20: 0.3999 - val_accuracy30: 0.3982 - val_accuracy50: 0.3946 - 14s/epoch - 29ms/step
Epoch 14/50
477/477 - 13s - loss: 12.7973 - accuracy10: 0.4249 - accuracy20: 0.4109 - accuracy30: 0.4088 - accuracy50: 0.3992 - val_loss: 12.8937 - val_accuracy10: 0.4141 - val_accuracy20: 0.3980 - val_accuracy30: 0.3973 - val_accuracy50: 0.3918 - 13s/epoch - 28ms/step
Epoch 15/50
477/477 - 13s - loss: 12.7859 - accuracy10: 0.4234 - accuracy20: 0.4120 - accuracy30: 0.4103 - accuracy50: 0.4007 - val_loss: 12.9056 - val_accuracy10: 0.4151 - val_accuracy20: 0.3987 - val_accuracy30: 0.3973 - val_accuracy50: 0.3923 - 13s/epoch - 28ms/step
Epoch 16/50
477/477 - 13s - loss: 12.7751 - accuracy10: 0.4266 - accuracy20: 0.4143 - accuracy30: 0.4108 - accuracy50: 0.4008 - val_loss: 12.9274 - val_accuracy10: 0.4139 - val_accuracy20: 0.3987 - val_accuracy30: 0.3964 - val_accuracy50: 0.3901 - 13s/epoch - 28ms/step
Epoch 17/50
477/477 - 13s - loss: 12.7773 - accuracy10: 0.4262 - accuracy20: 0.4148 - accuracy30: 0.4115 - accuracy50: 0.4019 - val_loss: 12.9072 - val_accuracy10: 0.4149 - val_accuracy20: 0.3975 - val_accuracy30: 0.3972 - val_accuracy50: 0.3928 - 13s/epoch - 27ms/step
Epoch 18/50
477/477 - 13s - loss: 12.7588 - accuracy10: 0.4276 - accuracy20: 0.4162 - accuracy30: 0.4135 - accuracy50: 0.4028 - val_loss: 12.9373 - val_accuracy10: 0.4144 - val_accuracy20: 0.3974 - val_accuracy30: 0.3974 - val_accuracy50: 0.3899 - 13s/epoch - 28ms/step
Epoch 19/50
477/477 - 13s - loss: 12.7622 - accuracy10: 0.4286 - accuracy20: 0.4156 - accuracy30: 0.4123 - accuracy50: 0.4020 - val_loss: 12.9583 - val_accuracy10: 0.4106 - val_accuracy20: 0.3949 - val_accuracy30: 0.3954 - val_accuracy50: 0.3917 - 13s/epoch - 27ms/step
Epoch 20/50
477/477 - 14s - loss: 12.7519 - accuracy10: 0.4293 - accuracy20: 0.4164 - accuracy30: 0.4135 - accuracy50: 0.4036 - val_loss: 12.9977 - val_accuracy10: 0.4093 - val_accuracy20: 0.3930 - val_accuracy30: 0.3905 - val_accuracy50: 0.3841 - 14s/epoch - 28ms/step
Epoch 21/50
477/477 - 13s - loss: 12.7372 - accuracy10: 0.4327 - accuracy20: 0.4212 - accuracy30: 0.4167 - accuracy50: 0.4066 - val_loss: 12.8951 - val_accuracy10: 0.4140 - val_accuracy20: 0.3994 - val_accuracy30: 0.3969 - val_accuracy50: 0.3898 - 13s/epoch - 28ms/step
Epoch 22/50
477/477 - 13s - loss: 12.7320 - accuracy10: 0.4317 - accuracy20: 0.4209 - accuracy30: 0.4169 - accuracy50: 0.4062 - val_loss: 12.9178 - val_accuracy10: 0.4151 - val_accuracy20: 0.3991 - val_accuracy30: 0.3955 - val_accuracy50: 0.3897 - 13s/epoch - 27ms/step
Epoch 23/50
477/477 - 13s - loss: 12.7489 - accuracy10: 0.4290 - accuracy20: 0.4186 - accuracy30: 0.4152 - accuracy50: 0.4046 - val_loss: 12.9256 - val_accuracy10: 0.4140 - val_accuracy20: 0.3965 - val_accuracy30: 0.3935 - val_accuracy50: 0.3889 - 13s/epoch - 27ms/step
testing model: results/PCAR/W9/deepOF_L1/seq2seq
Evaluating performance on  test set...
631/631 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0831422
{'0': {'precision': 0.4470980050876958, 'recall': 0.4368265284431872, 'f1-score': 0.44190258789668263, 'support': 61157}, '1': {'precision': 0.30833168848827774, 'recall': 0.3518004153842304, 'f1-score': 0.328634876110332, 'support': 39963}, '2': {'precision': 0.43445625949423644, 'recall': 0.4039279542735611, 'f1-score': 0.4186362892740596, 'support': 60184}, 'accuracy': 0.40348658433764817, 'macro avg': {'precision': 0.39662865102340333, 'recall': 0.39751829936699296, 'f1-score': 0.3963912510936914, 'support': 161304}, 'weighted avg': {'precision': 0.40800195584490395, 'recall': 0.40348658433764817, 'f1-score': 0.4051596895034507, 'support': 161304}}
[[26715 15441 19001]
 [13260 14059 12644]
 [19777 16097 24310]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0864934
{'0': {'precision': 0.4348895108788099, 'recall': 0.4705675657586507, 'f1-score': 0.45202562062508544, 'support': 59764}, '1': {'precision': 0.2972322145256711, 'recall': 0.22979153738307018, 'f1-score': 0.2591968475358411, 'support': 43509}, '2': {'precision': 0.411015873015873, 'recall': 0.44620978442556564, 'f1-score': 0.42789037519313233, 'support': 58031}, 'accuracy': 0.3968593463274314, 'macro avg': {'precision': 0.381045866140118, 'recall': 0.38218962918909555, 'f1-score': 0.3797042811180196, 'support': 161304}, 'weighted avg': {'precision': 0.3891699851023084, 'recall': 0.3968593463274314, 'f1-score': 0.39133041457934814, 'support': 161304}}
[[28123 11334 20307]
 [16712  9998 16799]
 [19832 12305 25894]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0867953
{'0': {'precision': 0.4338716972323135, 'recall': 0.4944055595271742, 'f1-score': 0.46216489237703007, 'support': 60149}, '1': {'precision': 0.29666236217343794, 'recall': 0.13574074494920801, 'f1-score': 0.18625754244819684, 'support': 44003}, '2': {'precision': 0.40566440402594006, 'recall': 0.5155200167973124, 'f1-score': 0.4540418088934436, 'support': 57152}, 'accuracy': 0.40404453702326043, 'macro avg': {'precision': 0.37873282114389717, 'recall': 0.3818887737578982, 'f1-score': 0.36748808123955684, 'support': 161304}, 'weighted avg': {'precision': 0.3864474201410674, 'recall': 0.40404453702326043, 'f1-score': 0.3840205091864558, 'support': 161304}}
[[29738  7014 23397]
 [18261  5973 19769]
 [20542  7147 29463]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0855176
{'0': {'precision': 0.4499571803619312, 'recall': 0.5048516161552518, 'f1-score': 0.47582638646604264, 'support': 63484}, '1': {'precision': 0.26789913240898405, 'recall': 0.0840755254720342, 'f1-score': 0.12798512521547134, 'support': 39298}, '2': {'precision': 0.4136502791283991, 'recall': 0.5495027511021496, 'f1-score': 0.47199553807315214, 'support': 58522}, 'accuracy': 0.41853890790061005, 'macro avg': {'precision': 0.3771688639664381, 'recall': 0.3794766309098119, 'f1-score': 0.35860234991822204, 'support': 161304}, 'weighted avg': {'precision': 0.3924305868339115, 'recall': 0.41853890790061005, 'f1-score': 0.38969303085010204, 'support': 161304}}
[[32050  4702 26732]
 [17142  3304 18852]
 [22037  4327 32158]]
Evaluating performance on  train set...
477/477 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0618821
{'0': {'precision': 0.4192819873841601, 'recall': 0.5178167828805001, 'f1-score': 0.4633689782042731, 'support': 41590}, '1': {'precision': 0.42382768678483285, 'recall': 0.3394429469901168, 'f1-score': 0.37697066453801636, 'support': 38955}, '2': {'precision': 0.43045112781954886, 'recall': 0.40946213695452566, 'f1-score': 0.41969438046412555, 'support': 41386}, 'accuracy': 0.4240513077068178, 'macro avg': {'precision': 0.4245202673295139, 'recall': 0.4222406222750475, 'f1-score': 0.42001134106880506, 'support': 121931}, 'weighted avg': {'precision': 0.42452531161025686, 'recall': 0.4240513077068178, 'f1-score': 0.4209420054824651, 'support': 121931}}
[[21536  8752 11302]
 [14612 13223 11120]
 [15216  9224 16946]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0679146
{'0': {'precision': 0.40614833497825054, 'recall': 0.549030265596047, 'f1-score': 0.46690268833583715, 'support': 40475}, '1': {'precision': 0.42314277362508873, 'recall': 0.24802956870808243, 'f1-score': 0.31274208731346737, 'support': 40854}, '2': {'precision': 0.414120637855327, 'recall': 0.4413329392640757, 'f1-score': 0.4272939717665013, 'support': 40602}, 'accuracy': 0.4123151618538354, 'macro avg': {'precision': 0.41447058215288873, 'recall': 0.41279759118940174, 'f1-score': 0.40231291580526857, 'support': 121931}, 'weighted avg': {'precision': 0.41449717356641097, 'recall': 0.4123151618538354, 'f1-score': 0.40206052100910267, 'support': 121931}}
[[22222  6455 11798]
 [17168 10133 13553]
 [15324  7359 17919]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0696474
{'0': {'precision': 0.40372540077875607, 'recall': 0.5636693113919091, 'f1-score': 0.47047521716913643, 'support': 40836}, '1': {'precision': 0.42308619650391804, 'recall': 0.17685892105727316, 'f1-score': 0.24944471098317253, 'support': 39687}, '2': {'precision': 0.4179444203033501, 'recall': 0.4877801391035549, 'f1-score': 0.45016994483757733, 'support': 41408}, 'accuracy': 0.4119953088222027, 'macro avg': {'precision': 0.4149186725286748, 'recall': 0.4094361238509124, 'f1-score': 0.39002995766329546, 'support': 121931}, 'weighted avg': {'precision': 0.4148559013111793, 'recall': 0.4119953088222027, 'f1-score': 0.3916368707625003, 'support': 121931}}
[[23018  4569 13249]
 [17788  7019 14880]
 [16208  5002 20198]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0743136
{'0': {'precision': 0.3943001878112239, 'recall': 0.5644377574427152, 'f1-score': 0.46427267194157035, 'support': 40543}, '1': {'precision': 0.4473763798578557, 'recall': 0.14698795180722893, 'f1-score': 0.22127484527215274, 'support': 40255}, '2': {'precision': 0.4047130338675298, 'recall': 0.49852916150049836, 'f1-score': 0.4467489460899119, 'support': 41133}, 'accuracy': 0.4043844469413029, 'macro avg': {'precision': 0.41546320051220315, 'recall': 0.4033182902501475, 'f1-score': 0.377432154434545, 'support': 121931}, 'weighted avg': {'precision': 0.4153358039192784, 'recall': 0.4043844469413029, 'f1-score': 0.37813640693895684, 'support': 121931}}
[[22884  3573 14086]
 [18262  5917 16076]
 [16891  3736 20506]]
Evaluating performance on  val set...
184/184 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0680255
{'0': {'precision': 0.40077282702032246, 'recall': 0.5378361075544175, 'f1-score': 0.45929692198348915, 'support': 15620}, '1': {'precision': 0.4387707298791343, 'recall': 0.2974844365391945, 'f1-score': 0.35457126632595115, 'support': 15742}, '2': {'precision': 0.42073490813648295, 'recall': 0.4133307548507703, 'f1-score': 0.41699996748284723, 'support': 15513}, 'accuracy': 0.41591466666666665, 'macro avg': {'precision': 0.42009282167864653, 'recall': 0.4162170996481274, 'f1-score': 0.41028938526409586, 'support': 46875}, 'weighted avg': {'precision': 0.4201399683783686, 'recall': 0.41591466666666665, 'f1-score': 0.41012905155086143, 'support': 46875}}
[[8401 2973 4246]
 [6477 4683 4582]
 [6084 3017 6412]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0738415
{'0': {'precision': 0.38491935854431836, 'recall': 0.5513360537054101, 'f1-score': 0.4533376626890711, 'support': 15194}, '1': {'precision': 0.43125594671741196, 'recall': 0.21742519637824548, 'f1-score': 0.28909706996212875, 'support': 16677}, '2': {'precision': 0.39840756704980845, 'recall': 0.4435483870967742, 'f1-score': 0.4197678819225432, 'support': 15004}, 'accuracy': 0.39803733333333335, 'macro avg': {'precision': 0.4048609574371796, 'recall': 0.40410321239347663, 'f1-score': 0.3874008715245811, 'support': 46875}, 'weighted avg': {'precision': 0.40572218225373824, 'recall': 0.39803733333333335, 'f1-score': 0.3841596071044695, 'support': 46875}}
[[8377 2345 4472]
 [7474 3626 5577]
 [5912 2437 6655]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0746639
{'0': {'precision': 0.38935309973045823, 'recall': 0.564993481095176, 'f1-score': 0.46101063829787237, 'support': 15340}, '1': {'precision': 0.426296705029166, 'recall': 0.16450690515300845, 'f1-score': 0.23740122914837578, 'support': 16437}, '2': {'precision': 0.39847854640980734, 'recall': 0.48224930454364817, 'f1-score': 0.43637998201977823, 'support': 15098}, 'accuracy': 0.39790933333333334, 'macro avg': {'precision': 0.40470945038981054, 'recall': 0.4039165635972775, 'f1-score': 0.3782639498220088, 'support': 46875}, 'weighted avg': {'precision': 0.4052468177946646, 'recall': 0.39790933333333334, 'f1-score': 0.3746673528220976, 'support': 46875}}
[[8667 1748 4925]
 [7667 2704 6066]
 [5926 1891 7281]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0773242
{'0': {'precision': 0.3821818507248971, 'recall': 0.5662666578266923, 'f1-score': 0.45635970185140656, 'support': 15083}, '1': {'precision': 0.4534313725490196, 'recall': 0.1527302747965562, 'f1-score': 0.2284958094397883, 'support': 16958}, '2': {'precision': 0.38889184161573215, 'recall': 0.4932587299447216, 'f1-score': 0.4349014829564029, 'support': 14834}, 'accuracy': 0.3935573333333333, 'macro avg': {'precision': 0.40816835496321624, 'recall': 0.40408522085599, 'f1-score': 0.37325233141586595, 'support': 46875}, 'weighted avg': {'precision': 0.41008127250555026, 'recall': 0.3935573333333333, 'f1-score': 0.3671345902438395, 'support': 46875}}
[[8541 1504 5038]
 [7908 2590 6460]
 [5899 1618 7317]]
training model: results/PCAR/W9/deepLOB_L2/seq2seq
Epoch 1/50
477/477 - 32s - loss: 13.1006 - accuracy10: 0.3927 - accuracy20: 0.3885 - accuracy30: 0.3809 - accuracy50: 0.3752 - val_loss: 13.1510 - val_accuracy10: 0.3937 - val_accuracy20: 0.3842 - val_accuracy30: 0.3818 - val_accuracy50: 0.3668 - 32s/epoch - 68ms/step
Epoch 2/50
477/477 - 26s - loss: 12.8673 - accuracy10: 0.4292 - accuracy20: 0.4209 - accuracy30: 0.4133 - accuracy50: 0.4050 - val_loss: 13.0693 - val_accuracy10: 0.4088 - val_accuracy20: 0.3978 - val_accuracy30: 0.3905 - val_accuracy50: 0.3729 - 26s/epoch - 54ms/step
Epoch 3/50
477/477 - 26s - loss: 12.7287 - accuracy10: 0.4507 - accuracy20: 0.4378 - accuracy30: 0.4270 - accuracy50: 0.4132 - val_loss: 12.8933 - val_accuracy10: 0.4302 - val_accuracy20: 0.4157 - val_accuracy30: 0.4083 - val_accuracy50: 0.3937 - 26s/epoch - 54ms/step
Epoch 4/50
477/477 - 26s - loss: 12.6175 - accuracy10: 0.4668 - accuracy20: 0.4506 - accuracy30: 0.4381 - accuracy50: 0.4236 - val_loss: 12.8777 - val_accuracy10: 0.4319 - val_accuracy20: 0.4150 - val_accuracy30: 0.4074 - val_accuracy50: 0.3908 - 26s/epoch - 55ms/step
Epoch 5/50
477/477 - 26s - loss: 12.5529 - accuracy10: 0.4728 - accuracy20: 0.4564 - accuracy30: 0.4429 - accuracy50: 0.4278 - val_loss: 12.9278 - val_accuracy10: 0.4330 - val_accuracy20: 0.4154 - val_accuracy30: 0.4080 - val_accuracy50: 0.3884 - 26s/epoch - 56ms/step
Epoch 6/50
477/477 - 26s - loss: 12.4707 - accuracy10: 0.4791 - accuracy20: 0.4612 - accuracy30: 0.4482 - accuracy50: 0.4314 - val_loss: 12.7588 - val_accuracy10: 0.4509 - val_accuracy20: 0.4320 - val_accuracy30: 0.4234 - val_accuracy50: 0.4033 - 26s/epoch - 54ms/step
Epoch 7/50
477/477 - 26s - loss: 12.4135 - accuracy10: 0.4839 - accuracy20: 0.4652 - accuracy30: 0.4506 - accuracy50: 0.4356 - val_loss: 12.7562 - val_accuracy10: 0.4525 - val_accuracy20: 0.4310 - val_accuracy30: 0.4247 - val_accuracy50: 0.4060 - 26s/epoch - 54ms/step
Epoch 8/50
477/477 - 26s - loss: 12.3717 - accuracy10: 0.4869 - accuracy20: 0.4680 - accuracy30: 0.4528 - accuracy50: 0.4368 - val_loss: 12.7225 - val_accuracy10: 0.4574 - val_accuracy20: 0.4357 - val_accuracy30: 0.4273 - val_accuracy50: 0.4089 - 26s/epoch - 54ms/step
Epoch 9/50
477/477 - 26s - loss: 12.3338 - accuracy10: 0.4898 - accuracy20: 0.4687 - accuracy30: 0.4538 - accuracy50: 0.4388 - val_loss: 12.7239 - val_accuracy10: 0.4542 - val_accuracy20: 0.4328 - val_accuracy30: 0.4251 - val_accuracy50: 0.4042 - 26s/epoch - 54ms/step
Epoch 10/50
477/477 - 25s - loss: 12.2982 - accuracy10: 0.4930 - accuracy20: 0.4712 - accuracy30: 0.4565 - accuracy50: 0.4400 - val_loss: 12.8245 - val_accuracy10: 0.4429 - val_accuracy20: 0.4243 - val_accuracy30: 0.4153 - val_accuracy50: 0.3936 - 25s/epoch - 53ms/step
Epoch 11/50
477/477 - 25s - loss: 12.2638 - accuracy10: 0.4952 - accuracy20: 0.4750 - accuracy30: 0.4588 - accuracy50: 0.4435 - val_loss: 12.8799 - val_accuracy10: 0.4406 - val_accuracy20: 0.4204 - val_accuracy30: 0.4107 - val_accuracy50: 0.3908 - 25s/epoch - 53ms/step
Epoch 12/50
477/477 - 25s - loss: 12.2286 - accuracy10: 0.4971 - accuracy20: 0.4765 - accuracy30: 0.4605 - accuracy50: 0.4456 - val_loss: 12.8488 - val_accuracy10: 0.4427 - val_accuracy20: 0.4226 - val_accuracy30: 0.4147 - val_accuracy50: 0.3933 - 25s/epoch - 53ms/step
Epoch 13/50
477/477 - 26s - loss: 12.2065 - accuracy10: 0.4993 - accuracy20: 0.4795 - accuracy30: 0.4632 - accuracy50: 0.4465 - val_loss: 12.9827 - val_accuracy10: 0.4336 - val_accuracy20: 0.4143 - val_accuracy30: 0.4066 - val_accuracy50: 0.3890 - 26s/epoch - 54ms/step
Epoch 14/50
477/477 - 26s - loss: 12.1832 - accuracy10: 0.5002 - accuracy20: 0.4797 - accuracy30: 0.4657 - accuracy50: 0.4483 - val_loss: 13.0424 - val_accuracy10: 0.4295 - val_accuracy20: 0.4109 - val_accuracy30: 0.4008 - val_accuracy50: 0.3793 - 26s/epoch - 54ms/step
Epoch 15/50
477/477 - 26s - loss: 12.1543 - accuracy10: 0.5039 - accuracy20: 0.4830 - accuracy30: 0.4673 - accuracy50: 0.4511 - val_loss: 13.0750 - val_accuracy10: 0.4234 - val_accuracy20: 0.4059 - val_accuracy30: 0.3996 - val_accuracy50: 0.3785 - 26s/epoch - 54ms/step
Epoch 16/50
477/477 - 26s - loss: 12.1313 - accuracy10: 0.5042 - accuracy20: 0.4831 - accuracy30: 0.4687 - accuracy50: 0.4528 - val_loss: 13.0958 - val_accuracy10: 0.4246 - val_accuracy20: 0.4059 - val_accuracy30: 0.3989 - val_accuracy50: 0.3733 - 26s/epoch - 54ms/step
Epoch 17/50
477/477 - 26s - loss: 12.0991 - accuracy10: 0.5050 - accuracy20: 0.4863 - accuracy30: 0.4716 - accuracy50: 0.4549 - val_loss: 13.1253 - val_accuracy10: 0.4265 - val_accuracy20: 0.4053 - val_accuracy30: 0.3981 - val_accuracy50: 0.3754 - 26s/epoch - 54ms/step
Epoch 18/50
477/477 - 26s - loss: 12.0835 - accuracy10: 0.5075 - accuracy20: 0.4881 - accuracy30: 0.4739 - accuracy50: 0.4579 - val_loss: 13.1314 - val_accuracy10: 0.4249 - val_accuracy20: 0.4048 - val_accuracy30: 0.3977 - val_accuracy50: 0.3739 - 26s/epoch - 55ms/step
testing model: results/PCAR/W9/deepLOB_L2/seq2seq
Evaluating performance on  test set...
631/631 - 14s - 14s/epoch - 22ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.056975
{'0': {'precision': 0.45896656534954405, 'recall': 0.6616959351188725, 'f1-score': 0.5419942409428782, 'support': 61158}, '1': {'precision': 0.5671641791044776, 'recall': 0.00475427885096587, 'f1-score': 0.00942951438000943, 'support': 39964}, '2': {'precision': 0.44241150533646517, 'recall': 0.5351410627056126, 'f1-score': 0.48437817230255586, 'support': 60186}, 'accuracy': 0.4517196915218092, 'macro avg': {'precision': 0.48951408326349566, 'recall': 0.40053042555848367, 'f1-score': 0.3452673092084811, 'support': 161308}, 'weighted avg': {'precision': 0.4795955892922809, 'recall': 0.4517196915218092, 'f1-score': 0.3885542538402861, 'support': 161308}}
[[40468    81 20609]
 [19790   190 19984]
 [27914    64 32208]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0706626
{'0': {'precision': 0.4401288541187299, 'recall': 0.6401070860871748, 'f1-score': 0.5216075263319359, 'support': 59765}, '1': {'precision': 0.49266862170087977, 'recall': 0.0038612700820519893, 'f1-score': 0.00766248574686431, 'support': 43509}, '2': {'precision': 0.422110281307818, 'recall': 0.5385808319261123, 'f1-score': 0.47328533248536886, 'support': 58034}, 'accuracy': 0.43196865623527664, 'macro avg': {'precision': 0.4516359190424759, 'recall': 0.3941830626984464, 'f1-score': 0.334185114854723, 'support': 161308}, 'weighted avg': {'precision': 0.44781764136563207, 'recall': 0.43196865623527664, 'f1-score': 0.36559812215788656, 'support': 161308}}
[[38256    93 21416]
 [21966   168 21375]
 [26698    80 31256]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.07216
{'0': {'precision': 0.4386777137772219, 'recall': 0.6064837905236907, 'f1-score': 0.5091096860629828, 'support': 60150}, '1': {'precision': 0.44227005870841485, 'recall': 0.005136013453628162, 'f1-score': 0.010154108819697175, 'support': 44003}, '2': {'precision': 0.40875602153584584, 'recall': 0.5552445105415099, 'f1-score': 0.470870149043348, 'support': 57155}, 'accuracy': 0.4242876980682917, 'macro avg': {'precision': 0.42990126467382755, 'recall': 0.3889547715062762, 'f1-score': 0.33004464797534266, 'support': 161308}, 'weighted avg': {'precision': 0.42905574607538094, 'recall': 0.4242876980682917, 'f1-score': 0.3594511260176439, 'support': 161308}}
[[36480   148 23522]
 [21396   226 22381]
 [25283   137 31735]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0677994
{'0': {'precision': 0.45345727416716436, 'recall': 0.5501772072143026, 'f1-score': 0.49715680622869385, 'support': 63485}, '1': {'precision': 0.2884784520668426, 'recall': 0.008346480736933178, 'f1-score': 0.01622356869049091, 'support': 39298}, '2': {'precision': 0.4084911900896025, 'recall': 0.580333190944041, 'f1-score': 0.47948048281216915, 'support': 58525}, 'accuracy': 0.4291169687802217, 'macro avg': {'precision': 0.38347563877453644, 'recall': 0.37961895963175896, 'f1-score': 0.33095361924378464, 'support': 161308}, 'weighted avg': {'precision': 0.39695060480459243, 'recall': 0.4291169687802217, 'f1-score': 0.3735781790265191, 'support': 161308}}
[[34928   441 28116]
 [17905   328 21065]
 [24193   368 33964]]
Evaluating performance on  train set...
477/477 - 10s - 10s/epoch - 22ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0442783
{'0': {'precision': 0.42898739744309133, 'recall': 0.6818280425193434, 'f1-score': 0.5266322864111109, 'support': 41487}, '1': {'precision': 0.6177336999214454, 'recall': 0.16111765609793577, 'f1-score': 0.2555758683729433, 'support': 39046}, '2': {'precision': 0.45633950401676565, 'recall': 0.5049519300449297, 'f1-score': 0.47941655390684124, 'support': 41398}, 'accuracy': 0.4550278436164716, 'macro avg': {'precision': 0.5010202004604342, 'recall': 0.4492992095540696, 'f1-score': 0.42054156956363187, 'support': 121931}, 'weighted avg': {'precision': 0.4987162656924027, 'recall': 0.4550278436164716, 'f1-score': 0.4238011295032692, 'support': 121931}}
[[28287  1967 11233]
 [19084  6291 13671]
 [18568  1926 20904]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0558485
{'0': {'precision': 0.41485224314806307, 'recall': 0.668624450915552, 'f1-score': 0.5120190490588857, 'support': 40522}, '1': {'precision': 0.5876447876447877, 'recall': 0.14936578424397065, 'f1-score': 0.23818932295232695, 'support': 40759}, '2': {'precision': 0.44021962344091137, 'recall': 0.5009840098400984, 'f1-score': 0.46864033321443777, 'support': 40650}, 'accuracy': 0.4391582124316212, 'macro avg': {'precision': 0.4809055514112541, 'recall': 0.4396580816665403, 'f1-score': 0.4062829017418835, 'support': 121931}, 'weighted avg': {'precision': 0.4810703118102268, 'recall': 0.4391582124316212, 'f1-score': 0.40602163572303146, 'support': 121931}}
[[27094  2159 11269]
 [20044  6088 14627]
 [18172  2113 20365]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0603434
{'0': {'precision': 0.4113333752041201, 'recall': 0.6417844631176658, 'f1-score': 0.5013444075516473, 'support': 40819}, '1': {'precision': 0.532272810385811, 'recall': 0.1461602189139658, 'f1-score': 0.22934352287723306, 'support': 39833}, '2': {'precision': 0.435831307472783, 'recall': 0.49945492865621743, 'f1-score': 0.4654790932899846, 'support': 41279}, 'accuracy': 0.431686773667074, 'macro avg': {'precision': 0.4598124976875713, 'recall': 0.4291332035626163, 'f1-score': 0.3987223412396217, 'support': 121931}, 'weighted avg': {'precision': 0.45913607236653514, 'recall': 0.431686773667074, 'f1-score': 0.4003438781814042, 'support': 121931}}
[[26197  2570 12052]
 [19375  5822 14636]
 [18116  2546 20617]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0706431
{'0': {'precision': 0.3987141444114738, 'recall': 0.5973031709967401, 'f1-score': 0.478211009174312, 'support': 40492}, '1': {'precision': 0.477169856269356, 'recall': 0.1491659219541257, 'f1-score': 0.22728218317983243, 'support': 40284}, '2': {'precision': 0.4164509634742594, 'recall': 0.49257684363989795, 'f1-score': 0.45132635000500937, 'support': 41155}, 'accuracy': 0.41389802429242767, 'macro avg': {'precision': 0.43077832138502975, 'recall': 0.4130153121969213, 'f1-score': 0.38560651411971797, 'support': 121931}, 'weighted avg': {'precision': 0.4306212778312921, 'recall': 0.41389802429242767, 'f1-score': 0.3862339485869776, 'support': 121931}}
[[24186  3233 13073]
 [18942  6009 15333]
 [17532  3351 20272]]
Evaluating performance on  val set...
184/184 - 4s - 4s/epoch - 22ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0416646
{'0': {'precision': 0.4282726377952756, 'recall': 0.6664326738991704, 'f1-score': 0.5214460478354221, 'support': 15670}, '1': {'precision': 0.6262567672080434, 'recall': 0.20471495386171154, 'f1-score': 0.3085643517195389, 'support': 15822}, '2': {'precision': 0.4455799988451989, 'recall': 0.5016576740557759, 'f1-score': 0.4719589015962326, 'support': 15383}, 'accuracy': 0.456512, 'macro avg': {'precision': 0.500036467949506, 'recall': 0.4576017672722193, 'f1-score': 0.4339897670503979, 'support': 46875}, 'weighted avg': {'precision': 0.5007791771147376, 'recall': 0.456512, 'f1-score': 0.43335058188250575, 'support': 46875}}
[[10443   889  4338]
 [ 7319  3239  5264]
 [ 6622  1044  7717]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.056642
{'0': {'precision': 0.4082557468896762, 'recall': 0.6502624671916011, 'f1-score': 0.5015943716151238, 'support': 15240}, '1': {'precision': 0.6007604562737643, 'recall': 0.18951661269041623, 'f1-score': 0.2881371386887937, 'support': 16674}, '2': {'precision': 0.4266189954443227, 'recall': 0.49448566272308003, 'f1-score': 0.458052132994861, 'support': 14961}, 'accuracy': 0.4366506666666667, 'macro avg': {'precision': 0.4785450662025877, 'recall': 0.4447549142016991, 'f1-score': 0.41592788109959283, 'support': 46875}, 'weighted avg': {'precision': 0.4825929433887984, 'recall': 0.4366506666666667, 'f1-score': 0.41176778316048107, 'support': 46875}}
[[9910  975 4355]
 [7926 3160 5588]
 [6438 1125 7398]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0622382
{'0': {'precision': 0.4066351899051519, 'recall': 0.6311284046692607, 'f1-score': 0.4946001575483445, 'support': 15420}, '1': {'precision': 0.5538932948810382, 'recall': 0.1873780487804878, 'f1-score': 0.2800255148532896, 'support': 16400}, '2': {'precision': 0.4211797171438427, 'recall': 0.48661574227831284, 'f1-score': 0.45153933865450396, 'support': 15055}, 'accuracy': 0.4294613333333333, 'macro avg': {'precision': 0.4605694006433443, 'recall': 0.4350407319093537, 'f1-score': 0.408721670352046, 'support': 46875}, 'weighted avg': {'precision': 0.46282720652772313, 'recall': 0.4294613333333333, 'f1-score': 0.4056976558172369, 'support': 46875}}
[[9732 1140 4548]
 [7807 3073 5520]
 [6394 1335 7326]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0727259
{'0': {'precision': 0.39084108897973385, 'recall': 0.5943783068783068, 'f1-score': 0.47158524426719844, 'support': 15120}, '1': {'precision': 0.5279975182255312, 'recall': 0.20045933690595372, 'f1-score': 0.290592453474475, 'support': 16981}, '2': {'precision': 0.3964093151313525, 'recall': 0.4677812373087857, 'f1-score': 0.42914803775459515, 'support': 14774}, 'accuracy': 0.411776, 'macro avg': {'precision': 0.43841597411220584, 'recall': 0.4208729603643488, 'f1-score': 0.3971085784987562, 'support': 46875}, 'weighted avg': {'precision': 0.44228254600772104, 'recall': 0.411776, 'f1-score': 0.39264325238520514, 'support': 46875}}
[[8987 1439 4694]
 [7748 3404 5829]
 [6259 1604 6911]]
training model: results/PCAR/W9/deepOF_L2/seq2seq
Epoch 1/50
477/477 - 24s - loss: 13.0231 - accuracy10: 0.4128 - accuracy20: 0.3958 - accuracy30: 0.3872 - accuracy50: 0.3796 - val_loss: 12.9404 - val_accuracy10: 0.4103 - val_accuracy20: 0.3933 - val_accuracy30: 0.3899 - val_accuracy50: 0.3731 - 24s/epoch - 50ms/step
Epoch 2/50
477/477 - 17s - loss: 12.7810 - accuracy10: 0.4504 - accuracy20: 0.4258 - accuracy30: 0.4160 - accuracy50: 0.4029 - val_loss: 12.8270 - val_accuracy10: 0.4358 - val_accuracy20: 0.4103 - val_accuracy30: 0.4030 - val_accuracy50: 0.3836 - 17s/epoch - 36ms/step
Epoch 3/50
477/477 - 17s - loss: 12.6168 - accuracy10: 0.4687 - accuracy20: 0.4426 - accuracy30: 0.4316 - accuracy50: 0.4166 - val_loss: 12.7920 - val_accuracy10: 0.4374 - val_accuracy20: 0.4135 - val_accuracy30: 0.4071 - val_accuracy50: 0.3882 - 17s/epoch - 36ms/step
Epoch 4/50
477/477 - 17s - loss: 12.4790 - accuracy10: 0.4840 - accuracy20: 0.4560 - accuracy30: 0.4410 - accuracy50: 0.4253 - val_loss: 12.6583 - val_accuracy10: 0.4628 - val_accuracy20: 0.4361 - val_accuracy30: 0.4256 - val_accuracy50: 0.4041 - 17s/epoch - 36ms/step
Epoch 5/50
477/477 - 16s - loss: 12.3928 - accuracy10: 0.4916 - accuracy20: 0.4640 - accuracy30: 0.4471 - accuracy50: 0.4305 - val_loss: 12.5773 - val_accuracy10: 0.4725 - val_accuracy20: 0.4430 - val_accuracy30: 0.4336 - val_accuracy50: 0.4097 - 16s/epoch - 35ms/step
Epoch 6/50
477/477 - 16s - loss: 12.3295 - accuracy10: 0.4978 - accuracy20: 0.4686 - accuracy30: 0.4533 - accuracy50: 0.4359 - val_loss: 12.6018 - val_accuracy10: 0.4703 - val_accuracy20: 0.4438 - val_accuracy30: 0.4325 - val_accuracy50: 0.4101 - 16s/epoch - 34ms/step
Epoch 7/50
477/477 - 17s - loss: 12.2819 - accuracy10: 0.5012 - accuracy20: 0.4735 - accuracy30: 0.4581 - accuracy50: 0.4397 - val_loss: 12.5324 - val_accuracy10: 0.4752 - val_accuracy20: 0.4470 - val_accuracy30: 0.4354 - val_accuracy50: 0.4143 - 17s/epoch - 36ms/step
Epoch 8/50
477/477 - 17s - loss: 12.2368 - accuracy10: 0.5066 - accuracy20: 0.4775 - accuracy30: 0.4620 - accuracy50: 0.4438 - val_loss: 12.5150 - val_accuracy10: 0.4796 - val_accuracy20: 0.4509 - val_accuracy30: 0.4387 - val_accuracy50: 0.4168 - 17s/epoch - 36ms/step
Epoch 9/50
477/477 - 17s - loss: 12.2060 - accuracy10: 0.5102 - accuracy20: 0.4828 - accuracy30: 0.4654 - accuracy50: 0.4451 - val_loss: 12.4987 - val_accuracy10: 0.4840 - val_accuracy20: 0.4540 - val_accuracy30: 0.4383 - val_accuracy50: 0.4169 - 17s/epoch - 35ms/step
Epoch 10/50
477/477 - 17s - loss: 12.1690 - accuracy10: 0.5134 - accuracy20: 0.4848 - accuracy30: 0.4693 - accuracy50: 0.4474 - val_loss: 12.4400 - val_accuracy10: 0.4867 - val_accuracy20: 0.4572 - val_accuracy30: 0.4432 - val_accuracy50: 0.4202 - 17s/epoch - 35ms/step
Epoch 11/50
477/477 - 17s - loss: 12.1306 - accuracy10: 0.5151 - accuracy20: 0.4879 - accuracy30: 0.4723 - accuracy50: 0.4517 - val_loss: 12.4611 - val_accuracy10: 0.4873 - val_accuracy20: 0.4564 - val_accuracy30: 0.4411 - val_accuracy50: 0.4177 - 17s/epoch - 35ms/step
Epoch 12/50
477/477 - 17s - loss: 12.0999 - accuracy10: 0.5164 - accuracy20: 0.4917 - accuracy30: 0.4763 - accuracy50: 0.4547 - val_loss: 12.4728 - val_accuracy10: 0.4865 - val_accuracy20: 0.4556 - val_accuracy30: 0.4400 - val_accuracy50: 0.4173 - 17s/epoch - 35ms/step
Epoch 13/50
477/477 - 17s - loss: 12.0667 - accuracy10: 0.5215 - accuracy20: 0.4938 - accuracy30: 0.4780 - accuracy50: 0.4563 - val_loss: 12.4855 - val_accuracy10: 0.4832 - val_accuracy20: 0.4576 - val_accuracy30: 0.4437 - val_accuracy50: 0.4207 - 17s/epoch - 35ms/step
Epoch 14/50
477/477 - 17s - loss: 12.0302 - accuracy10: 0.5246 - accuracy20: 0.4977 - accuracy30: 0.4832 - accuracy50: 0.4600 - val_loss: 12.4650 - val_accuracy10: 0.4869 - val_accuracy20: 0.4587 - val_accuracy30: 0.4433 - val_accuracy50: 0.4195 - 17s/epoch - 35ms/step
Epoch 15/50
477/477 - 17s - loss: 12.0013 - accuracy10: 0.5256 - accuracy20: 0.5007 - accuracy30: 0.4858 - accuracy50: 0.4637 - val_loss: 12.5108 - val_accuracy10: 0.4802 - val_accuracy20: 0.4543 - val_accuracy30: 0.4417 - val_accuracy50: 0.4175 - 17s/epoch - 35ms/step
Epoch 16/50
477/477 - 17s - loss: 11.9687 - accuracy10: 0.5263 - accuracy20: 0.5012 - accuracy30: 0.4884 - accuracy50: 0.4649 - val_loss: 12.4995 - val_accuracy10: 0.4864 - val_accuracy20: 0.4577 - val_accuracy30: 0.4420 - val_accuracy50: 0.4166 - 17s/epoch - 35ms/step
Epoch 17/50
477/477 - 17s - loss: 11.9327 - accuracy10: 0.5289 - accuracy20: 0.5053 - accuracy30: 0.4927 - accuracy50: 0.4698 - val_loss: 12.5612 - val_accuracy10: 0.4818 - val_accuracy20: 0.4524 - val_accuracy30: 0.4369 - val_accuracy50: 0.4129 - 17s/epoch - 35ms/step
Epoch 18/50
477/477 - 17s - loss: 11.8921 - accuracy10: 0.5301 - accuracy20: 0.5079 - accuracy30: 0.4962 - accuracy50: 0.4713 - val_loss: 12.5115 - val_accuracy10: 0.4871 - val_accuracy20: 0.4563 - val_accuracy30: 0.4401 - val_accuracy50: 0.4148 - 17s/epoch - 35ms/step
Epoch 19/50
477/477 - 16s - loss: 11.8647 - accuracy10: 0.5323 - accuracy20: 0.5108 - accuracy30: 0.4997 - accuracy50: 0.4756 - val_loss: 12.5439 - val_accuracy10: 0.4831 - val_accuracy20: 0.4541 - val_accuracy30: 0.4388 - val_accuracy50: 0.4152 - 16s/epoch - 34ms/step
Epoch 20/50
477/477 - 17s - loss: 11.8266 - accuracy10: 0.5346 - accuracy20: 0.5126 - accuracy30: 0.5029 - accuracy50: 0.4797 - val_loss: 12.6997 - val_accuracy10: 0.4783 - val_accuracy20: 0.4483 - val_accuracy30: 0.4335 - val_accuracy50: 0.4083 - 17s/epoch - 35ms/step
testing model: results/PCAR/W9/deepOF_L2/seq2seq
Evaluating performance on  test set...
631/631 - 10s - 10s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0325713
{'0': {'precision': 0.4595772499455219, 'recall': 0.5862452376669882, 'f1-score': 0.5152403535244665, 'support': 61157}, '1': {'precision': 0.4497758592063756, 'recall': 0.13557540725170783, 'f1-score': 0.20834855505777844, 'support': 39963}, '2': {'precision': 0.47836339392238053, 'recall': 0.5662800744383889, 'f1-score': 0.518622221884059, 'support': 60184}, 'accuracy': 0.46714278629172246, 'macro avg': {'precision': 0.462572167691426, 'recall': 0.4293669064523617, 'f1-score': 0.4140703768221013, 'support': 161304}, 'weighted avg': {'precision': 0.4641582418055796, 'recall': 0.46714278629172246, 'f1-score': 0.44046984208785894, 'support': 161304}}
[[35853  3050 22254]
 [19635  5418 14910]
 [22525  3578 34081]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0575792
{'0': {'precision': 0.44422229057725826, 'recall': 0.579947794658992, 'f1-score': 0.5030917060992249, 'support': 59764}, '1': {'precision': 0.41594988780852654, 'recall': 0.1022547059229125, 'f1-score': 0.16415459828429113, 'support': 43509}, '2': {'precision': 0.44547007604981814, 'recall': 0.5571849528700178, 'f1-score': 0.49510393140144704, 'support': 58031}, 'accuracy': 0.4429090413132966, 'macro avg': {'precision': 0.4352140848118677, 'recall': 0.4131291511506408, 'f1-score': 0.3874500785949877, 'support': 161304}, 'weighted avg': {'precision': 0.4370451980482036, 'recall': 0.4429090413132966, 'f1-score': 0.4087955127165022, 'support': 161304}}
[[34660  3092 22012]
 [20822  4449 18238]
 [22542  3155 32334]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0655113
{'0': {'precision': 0.44156481111010726, 'recall': 0.5687875110143145, 'f1-score': 0.4971662743046473, 'support': 60149}, '1': {'precision': 0.37298271483574996, 'recall': 0.10347021793968593, 'f1-score': 0.161999644191425, 'support': 44003}, '2': {'precision': 0.429487000474741, 'recall': 0.5381963885778276, 'f1-score': 0.47773549739846244, 'support': 57152}, 'accuracy': 0.4310122501611863, 'macro avg': {'precision': 0.41467817547353275, 'recall': 0.40348470584394264, 'f1-score': 0.3789671386315116, 'support': 161304}, 'weighted avg': {'precision': 0.4185766086117626, 'recall': 0.4310122501611863, 'f1-score': 0.3988497726269803, 'support': 161304}}
[[34212  3852 22085]
 [20676  4553 18774]
 [22591  3802 30759]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0711666
{'0': {'precision': 0.45881305006780293, 'recall': 0.5436172893957533, 'f1-score': 0.4976280082478983, 'support': 63484}, '1': {'precision': 0.3004051604648683, 'recall': 0.1433915211970075, 'f1-score': 0.19412291580542926, 'support': 39298}, '2': {'precision': 0.43044498574144485, 'recall': 0.49521547452240183, 'f1-score': 0.4605641636869288, 'support': 58522}, 'accuracy': 0.4285510588702078, 'macro avg': {'precision': 0.39655439875803866, 'recall': 0.3940747617050542, 'f1-score': 0.3841050292467521, 'support': 161304}, 'weighted avg': {'precision': 0.4099285270173934, 'recall': 0.4285510588702078, 'f1-score': 0.4102390195420931, 'support': 161304}}
[[34511  6542 22431]
 [17747  5635 15916]
 [22960  6581 28981]]
Evaluating performance on  train set...
477/477 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.99966586
{'0': {'precision': 0.4499748869914616, 'recall': 0.6462370762202453, 'f1-score': 0.5305369127516778, 'support': 41590}, '1': {'precision': 0.6449343634193831, 'recall': 0.2635861891926582, 'f1-score': 0.3742255266418835, 'support': 38955}, '2': {'precision': 0.49392826274848745, 'recall': 0.5523365389262069, 'f1-score': 0.521502064654484, 'support': 41386}, 'accuracy': 0.4921143925662875, 'macro avg': {'precision': 0.529612504386444, 'recall': 0.48738660144637014, 'f1-score': 0.4754215013493484, 'support': 121931}, 'weighted avg': {'precision': 0.5271800342741867, 'recall': 0.4921143925662875, 'f1-score': 0.4775313090146668, 'support': 121931}}
[[26877  2325 12388]
 [17654 10268 11033]
 [15199  3328 22859]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0258093
{'0': {'precision': 0.4342523948354852, 'recall': 0.6440024706609018, 'f1-score': 0.5187263681592039, 'support': 40475}, '1': {'precision': 0.6080990178931791, 'recall': 0.22127576247123903, 'f1-score': 0.32447954055994255, 'support': 40854}, '2': {'precision': 0.46237244897959184, 'recall': 0.5356878971479238, 'f1-score': 0.4963373724926405, 'support': 40602}, 'accuracy': 0.46629651196168326, 'macro avg': {'precision': 0.5015746205694187, 'recall': 0.4669887100933548, 'f1-score': 0.44651442707059563, 'support': 121931}, 'weighted avg': {'precision': 0.5018649000782704, 'recall': 0.46629651196168326, 'f1-score': 0.4461869983779831, 'support': 121931}}
[[26066  2466 11943]
 [18467  9040 13347]
 [15492  3360 21750]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0358834
{'0': {'precision': 0.43027915052758114, 'recall': 0.6311098050739543, 'f1-score': 0.5116943970138585, 'support': 40836}, '1': {'precision': 0.5439476692493331, 'recall': 0.21581374253533903, 'f1-score': 0.3090217018743348, 'support': 39687}, '2': {'precision': 0.45907234980232886, 'recall': 0.513185857805255, 'f1-score': 0.4846231912152069, 'support': 41408}, 'accuracy': 0.4558889863939441, 'macro avg': {'precision': 0.47776638985974773, 'recall': 0.4533698018048495, 'f1-score': 0.43511309670113346, 'support': 121931}, 'weighted avg': {'precision': 0.47705504261473636, 'recall': 0.4558889863939441, 'f1-score': 0.4365335622654119, 'support': 121931}}
[[25772  3228 11836]
 [17919  8565 13203]
 [16205  3953 21250]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0535461
{'0': {'precision': 0.4150526878567856, 'recall': 0.5935919887526824, 'f1-score': 0.4885207965410146, 'support': 40543}, '1': {'precision': 0.46938484228555116, 'recall': 0.24508756676189294, 'f1-score': 0.3220289192806084, 'support': 40255}, '2': {'precision': 0.43993570779659436, 'recall': 0.45914472564607495, 'f1-score': 0.44933501463205733, 'support': 41133}, 'accuracy': 0.4331794211480263, 'macro avg': {'precision': 0.44145774597964377, 'recall': 0.43260809372021675, 'f1-score': 0.4199615768178935, 'support': 121931}, 'weighted avg': {'precision': 0.4413844175704278, 'recall': 0.4331794211480263, 'f1-score': 0.42033502519181876, 'support': 121931}}
[[24066  5330 11147]
 [17493  9866 12896]
 [16424  5823 18886]]
Evaluating performance on  val set...
184/184 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0009098
{'0': {'precision': 0.4403787809138549, 'recall': 0.6133162612035852, 'f1-score': 0.5126558570128966, 'support': 15620}, '1': {'precision': 0.6337496747332813, 'recall': 0.30942701054503874, 'f1-score': 0.4158272152979341, 'support': 15742}, '2': {'precision': 0.48379696013765416, 'recall': 0.5437375104750855, 'f1-score': 0.512018938934078, 'support': 15513}, 'accuracy': 0.48823466666666665, 'macro avg': {'precision': 0.5193084719282635, 'recall': 0.4888269274079031, 'f1-score': 0.4801673370816362, 'support': 46875}, 'weighted avg': {'precision': 0.5196873851763446, 'recall': 0.48823466666666665, 'f1-score': 0.479927174601512, 'support': 46875}}
[[9580 1296 4744]
 [6615 4871 4256]
 [5559 1519 8435]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0320083
{'0': {'precision': 0.41964122277137106, 'recall': 0.6035277083059102, 'f1-score': 0.49506019543270535, 'support': 15194}, '1': {'precision': 0.5979953948259515, 'recall': 0.264735863764466, 'f1-score': 0.3669991687448046, 'support': 16677}, '2': {'precision': 0.44835600907029477, 'recall': 0.5271260997067448, 'f1-score': 0.4845607155985786, 'support': 15004}, 'accuracy': 0.45853866666666665, 'macro avg': {'precision': 0.48866420888920575, 'recall': 0.4651298905923737, 'f1-score': 0.44887335992536287, 'support': 46875}, 'weighted avg': {'precision': 0.4922865386323479, 'recall': 0.45853866666666665, 'f1-score': 0.4461384260992577, 'support': 46875}}
[[9170 1384 4640]
 [7171 4415 5091]
 [5511 1584 7909]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.045468
{'0': {'precision': 0.41532779316712837, 'recall': 0.5864406779661017, 'f1-score': 0.4862702702702703, 'support': 15340}, '1': {'precision': 0.5316963167126033, 'recall': 0.2581979679990266, 'f1-score': 0.34759818174372414, 'support': 16437}, '2': {'precision': 0.43677827424128124, 'recall': 0.49854285335806064, 'f1-score': 0.46562123039807, 'support': 15098}, 'accuracy': 0.44302933333333333, 'macro avg': {'precision': 0.461267461373671, 'recall': 0.447727166441063, 'f1-score': 0.4331632274706882, 'support': 46875}, 'weighted avg': {'precision': 0.46304211390898503, 'recall': 0.44302933333333333, 'f1-score': 0.4309932073774422, 'support': 46875}}
[[8996 1777 4567]
 [7054 4244 5139]
 [5610 1961 7527]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0624094
{'0': {'precision': 0.3976376070010999, 'recall': 0.5512829012795862, 'f1-score': 0.46202144801911427, 'support': 15083}, '1': {'precision': 0.4719166747785457, 'recall': 0.28588276919448047, 'f1-score': 0.35606477911204143, 'support': 16958}, '2': {'precision': 0.41832897839525846, 'recall': 0.44249696642847514, 'f1-score': 0.43007371007371004, 'support': 14834}, 'accuracy': 0.42084266666666664, 'macro avg': {'precision': 0.4292944200583013, 'recall': 0.4265542123008473, 'f1-score': 0.4160533124016219, 'support': 46875}, 'weighted avg': {'precision': 0.4310575586732252, 'recall': 0.42084266666666664, 'f1-score': 0.41357929471760463, 'support': 46875}}
[[8315 2628 4140]
 [7123 4848 4987]
 [5473 2797 6564]]
training model: results/PCAR/W9/deepVOL_L2/seq2seq
Epoch 1/50
477/477 - 22s - loss: 13.0655 - accuracy10: 0.3964 - accuracy20: 0.3917 - accuracy30: 0.3878 - accuracy50: 0.3853 - val_loss: 13.1354 - val_accuracy10: 0.3882 - val_accuracy20: 0.3754 - val_accuracy30: 0.3738 - val_accuracy50: 0.3588 - 22s/epoch - 46ms/step
Epoch 2/50
477/477 - 16s - loss: 12.8914 - accuracy10: 0.4213 - accuracy20: 0.4110 - accuracy30: 0.4031 - accuracy50: 0.3988 - val_loss: 12.9201 - val_accuracy10: 0.4271 - val_accuracy20: 0.4101 - val_accuracy30: 0.4026 - val_accuracy50: 0.3840 - 16s/epoch - 34ms/step
Epoch 3/50
477/477 - 16s - loss: 12.7676 - accuracy10: 0.4447 - accuracy20: 0.4272 - accuracy30: 0.4170 - accuracy50: 0.4077 - val_loss: 12.8122 - val_accuracy10: 0.4491 - val_accuracy20: 0.4249 - val_accuracy30: 0.4103 - val_accuracy50: 0.3865 - 16s/epoch - 34ms/step
Epoch 4/50
477/477 - 16s - loss: 12.6535 - accuracy10: 0.4617 - accuracy20: 0.4424 - accuracy30: 0.4293 - accuracy50: 0.4174 - val_loss: 12.8009 - val_accuracy10: 0.4503 - val_accuracy20: 0.4247 - val_accuracy30: 0.4129 - val_accuracy50: 0.3933 - 16s/epoch - 34ms/step
Epoch 5/50
477/477 - 16s - loss: 12.5595 - accuracy10: 0.4732 - accuracy20: 0.4527 - accuracy30: 0.4381 - accuracy50: 0.4269 - val_loss: 12.7508 - val_accuracy10: 0.4600 - val_accuracy20: 0.4343 - val_accuracy30: 0.4199 - val_accuracy50: 0.3996 - 16s/epoch - 34ms/step
Epoch 6/50
477/477 - 16s - loss: 12.4754 - accuracy10: 0.4817 - accuracy20: 0.4614 - accuracy30: 0.4459 - accuracy50: 0.4341 - val_loss: 12.7183 - val_accuracy10: 0.4691 - val_accuracy20: 0.4413 - val_accuracy30: 0.4227 - val_accuracy50: 0.3974 - 16s/epoch - 34ms/step
Epoch 7/50
477/477 - 16s - loss: 12.4189 - accuracy10: 0.4888 - accuracy20: 0.4658 - accuracy30: 0.4498 - accuracy50: 0.4371 - val_loss: 12.7251 - val_accuracy10: 0.4694 - val_accuracy20: 0.4381 - val_accuracy30: 0.4226 - val_accuracy50: 0.3970 - 16s/epoch - 34ms/step
Epoch 8/50
477/477 - 16s - loss: 12.3858 - accuracy10: 0.4921 - accuracy20: 0.4692 - accuracy30: 0.4526 - accuracy50: 0.4387 - val_loss: 12.6850 - val_accuracy10: 0.4721 - val_accuracy20: 0.4436 - val_accuracy30: 0.4264 - val_accuracy50: 0.4030 - 16s/epoch - 34ms/step
Epoch 9/50
477/477 - 16s - loss: 12.3416 - accuracy10: 0.4979 - accuracy20: 0.4725 - accuracy30: 0.4564 - accuracy50: 0.4422 - val_loss: 12.7122 - val_accuracy10: 0.4672 - val_accuracy20: 0.4386 - val_accuracy30: 0.4204 - val_accuracy50: 0.4000 - 16s/epoch - 34ms/step
Epoch 10/50
477/477 - 17s - loss: 12.3120 - accuracy10: 0.5000 - accuracy20: 0.4760 - accuracy30: 0.4579 - accuracy50: 0.4428 - val_loss: 12.7143 - val_accuracy10: 0.4729 - val_accuracy20: 0.4397 - val_accuracy30: 0.4174 - val_accuracy50: 0.3959 - 17s/epoch - 35ms/step
Epoch 11/50
477/477 - 16s - loss: 12.2840 - accuracy10: 0.5030 - accuracy20: 0.4774 - accuracy30: 0.4587 - accuracy50: 0.4447 - val_loss: 12.6641 - val_accuracy10: 0.4770 - val_accuracy20: 0.4432 - val_accuracy30: 0.4236 - val_accuracy50: 0.3963 - 16s/epoch - 35ms/step
Epoch 12/50
477/477 - 16s - loss: 12.2635 - accuracy10: 0.5039 - accuracy20: 0.4790 - accuracy30: 0.4610 - accuracy50: 0.4461 - val_loss: 12.6718 - val_accuracy10: 0.4774 - val_accuracy20: 0.4457 - val_accuracy30: 0.4260 - val_accuracy50: 0.3990 - 16s/epoch - 34ms/step
Epoch 13/50
477/477 - 16s - loss: 12.2376 - accuracy10: 0.5066 - accuracy20: 0.4815 - accuracy30: 0.4629 - accuracy50: 0.4485 - val_loss: 12.6906 - val_accuracy10: 0.4763 - val_accuracy20: 0.4443 - val_accuracy30: 0.4210 - val_accuracy50: 0.3955 - 16s/epoch - 34ms/step
Epoch 14/50
477/477 - 17s - loss: 12.2183 - accuracy10: 0.5097 - accuracy20: 0.4834 - accuracy30: 0.4660 - accuracy50: 0.4500 - val_loss: 12.6450 - val_accuracy10: 0.4780 - val_accuracy20: 0.4465 - val_accuracy30: 0.4259 - val_accuracy50: 0.4002 - 17s/epoch - 35ms/step
Epoch 15/50
477/477 - 17s - loss: 12.1868 - accuracy10: 0.5109 - accuracy20: 0.4860 - accuracy30: 0.4678 - accuracy50: 0.4520 - val_loss: 12.6382 - val_accuracy10: 0.4834 - val_accuracy20: 0.4479 - val_accuracy30: 0.4249 - val_accuracy50: 0.3980 - 17s/epoch - 35ms/step
Epoch 16/50
477/477 - 16s - loss: 12.1661 - accuracy10: 0.5118 - accuracy20: 0.4867 - accuracy30: 0.4688 - accuracy50: 0.4550 - val_loss: 12.6695 - val_accuracy10: 0.4780 - val_accuracy20: 0.4454 - val_accuracy30: 0.4234 - val_accuracy50: 0.3962 - 16s/epoch - 34ms/step
Epoch 17/50
477/477 - 16s - loss: 12.1510 - accuracy10: 0.5123 - accuracy20: 0.4866 - accuracy30: 0.4692 - accuracy50: 0.4552 - val_loss: 12.6184 - val_accuracy10: 0.4855 - val_accuracy20: 0.4495 - val_accuracy30: 0.4251 - val_accuracy50: 0.4000 - 16s/epoch - 34ms/step
Epoch 18/50
477/477 - 16s - loss: 12.1307 - accuracy10: 0.5154 - accuracy20: 0.4889 - accuracy30: 0.4711 - accuracy50: 0.4564 - val_loss: 12.6172 - val_accuracy10: 0.4880 - val_accuracy20: 0.4496 - val_accuracy30: 0.4250 - val_accuracy50: 0.3980 - 16s/epoch - 34ms/step
Epoch 19/50
477/477 - 16s - loss: 12.1037 - accuracy10: 0.5166 - accuracy20: 0.4918 - accuracy30: 0.4732 - accuracy50: 0.4574 - val_loss: 12.6485 - val_accuracy10: 0.4863 - val_accuracy20: 0.4498 - val_accuracy30: 0.4257 - val_accuracy50: 0.4013 - 16s/epoch - 34ms/step
Epoch 20/50
477/477 - 16s - loss: 12.0910 - accuracy10: 0.5156 - accuracy20: 0.4909 - accuracy30: 0.4729 - accuracy50: 0.4591 - val_loss: 12.6170 - val_accuracy10: 0.4903 - val_accuracy20: 0.4492 - val_accuracy30: 0.4262 - val_accuracy50: 0.4037 - 16s/epoch - 34ms/step
Epoch 21/50
477/477 - 16s - loss: 12.0722 - accuracy10: 0.5169 - accuracy20: 0.4919 - accuracy30: 0.4759 - accuracy50: 0.4620 - val_loss: 12.6367 - val_accuracy10: 0.4889 - val_accuracy20: 0.4522 - val_accuracy30: 0.4272 - val_accuracy50: 0.3992 - 16s/epoch - 34ms/step
Epoch 22/50
477/477 - 16s - loss: 12.0578 - accuracy10: 0.5189 - accuracy20: 0.4935 - accuracy30: 0.4762 - accuracy50: 0.4616 - val_loss: 12.6671 - val_accuracy10: 0.4848 - val_accuracy20: 0.4484 - val_accuracy30: 0.4255 - val_accuracy50: 0.4004 - 16s/epoch - 34ms/step
Epoch 23/50
477/477 - 17s - loss: 12.0370 - accuracy10: 0.5198 - accuracy20: 0.4949 - accuracy30: 0.4784 - accuracy50: 0.4643 - val_loss: 12.6967 - val_accuracy10: 0.4852 - val_accuracy20: 0.4455 - val_accuracy30: 0.4244 - val_accuracy50: 0.4001 - 17s/epoch - 35ms/step
Epoch 24/50
477/477 - 17s - loss: 12.0202 - accuracy10: 0.5220 - accuracy20: 0.4982 - accuracy30: 0.4801 - accuracy50: 0.4654 - val_loss: 12.6597 - val_accuracy10: 0.4854 - val_accuracy20: 0.4477 - val_accuracy30: 0.4241 - val_accuracy50: 0.4022 - 17s/epoch - 35ms/step
Epoch 25/50
477/477 - 17s - loss: 12.0062 - accuracy10: 0.5226 - accuracy20: 0.4987 - accuracy30: 0.4812 - accuracy50: 0.4669 - val_loss: 12.6863 - val_accuracy10: 0.4831 - val_accuracy20: 0.4462 - val_accuracy30: 0.4218 - val_accuracy50: 0.4003 - 17s/epoch - 35ms/step
Epoch 26/50
477/477 - 16s - loss: 11.9898 - accuracy10: 0.5225 - accuracy20: 0.4986 - accuracy30: 0.4814 - accuracy50: 0.4668 - val_loss: 12.7331 - val_accuracy10: 0.4791 - val_accuracy20: 0.4413 - val_accuracy30: 0.4168 - val_accuracy50: 0.3974 - 16s/epoch - 34ms/step
Epoch 27/50
477/477 - 16s - loss: 11.9703 - accuracy10: 0.5250 - accuracy20: 0.5015 - accuracy30: 0.4844 - accuracy50: 0.4695 - val_loss: 12.6944 - val_accuracy10: 0.4848 - val_accuracy20: 0.4465 - val_accuracy30: 0.4224 - val_accuracy50: 0.3970 - 16s/epoch - 34ms/step
Epoch 28/50
477/477 - 16s - loss: 11.9535 - accuracy10: 0.5253 - accuracy20: 0.5023 - accuracy30: 0.4847 - accuracy50: 0.4693 - val_loss: 12.7268 - val_accuracy10: 0.4838 - val_accuracy20: 0.4465 - val_accuracy30: 0.4221 - val_accuracy50: 0.3987 - 16s/epoch - 34ms/step
Epoch 29/50
477/477 - 16s - loss: 11.9426 - accuracy10: 0.5258 - accuracy20: 0.5021 - accuracy30: 0.4859 - accuracy50: 0.4718 - val_loss: 12.7030 - val_accuracy10: 0.4853 - val_accuracy20: 0.4466 - val_accuracy30: 0.4222 - val_accuracy50: 0.3983 - 16s/epoch - 34ms/step
Epoch 30/50
477/477 - 16s - loss: 11.9163 - accuracy10: 0.5287 - accuracy20: 0.5054 - accuracy30: 0.4876 - accuracy50: 0.4724 - val_loss: 12.7586 - val_accuracy10: 0.4819 - val_accuracy20: 0.4440 - val_accuracy30: 0.4195 - val_accuracy50: 0.3971 - 16s/epoch - 34ms/step
testing model: results/PCAR/W9/deepVOL_L2/seq2seq
Evaluating performance on  test set...
631/631 - 10s - 10s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0324807
{'0': {'precision': 0.47865433798937634, 'recall': 0.5967330520945747, 'f1-score': 0.5312111089277527, 'support': 61158}, '1': {'precision': 0.4741525112140599, 'recall': 0.16134521068962066, 'f1-score': 0.24076321341224352, 'support': 39964}, '2': {'precision': 0.46837568565991267, 'recall': 0.5561426245306217, 'f1-score': 0.5084998101025446, 'support': 60186}, 'accuracy': 0.4737210801696134, 'macro avg': {'precision': 0.4737275116211163, 'recall': 0.43807362910493897, 'f1-score': 0.4268247108141803, 'support': 161308}, 'weighted avg': {'precision': 0.47370392031418446, 'recall': 0.4737210801696134, 'f1-score': 0.450778880349655, 'support': 161308}}
[[36495  3514 21149]
 [16673  6448 16843]
 [23077  3637 33472]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0551264
{'0': {'precision': 0.4601958390691151, 'recall': 0.5929222789257926, 'f1-score': 0.5181951786615192, 'support': 59765}, '1': {'precision': 0.42458611543034847, 'recall': 0.10669056976717461, 'f1-score': 0.17053010543330518, 'support': 43509}, '2': {'precision': 0.44491843048532836, 'recall': 0.5625150773684392, 'f1-score': 0.4968532878765971, 'support': 58034}, 'accuracy': 0.45083318868252037, 'macro avg': {'precision': 0.4432334616615973, 'recall': 0.42070930868713546, 'f1-score': 0.3951928573238071, 'support': 161308}, 'weighted avg': {'precision': 0.44509458807381064, 'recall': 0.45083318868252037, 'f1-score': 0.4167425851082018, 'support': 161308}}
[[35436  3210 21119]
 [19258  4642 19609]
 [22308  3081 32645]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0610358
{'0': {'precision': 0.45589432733194607, 'recall': 0.5864172901080632, 'f1-score': 0.5129834716152442, 'support': 60150}, '1': {'precision': 0.38112648221343876, 'recall': 0.08765311456037088, 'f1-score': 0.14252720654804796, 'support': 44003}, '2': {'precision': 0.43481853773521006, 'recall': 0.561578164640014, 'f1-score': 0.4901352960938216, 'support': 57155}, 'accuracy': 0.4415590051330374, 'macro avg': {'precision': 0.42394644909353163, 'recall': 0.41188285643614936, 'f1-score': 0.3818819914190379, 'support': 161308}, 'weighted avg': {'precision': 0.4280308844577481, 'recall': 0.4415590051330374, 'f1-score': 0.40383157274055265, 'support': 161308}}
[[35273  3273 21604]
 [20030  3857 20116]
 [22068  2990 32097]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0644921
{'0': {'precision': 0.46464886564720176, 'recall': 0.5542411593289753, 'f1-score': 0.5055060304142633, 'support': 63485}, '1': {'precision': 0.3119013252853956, 'recall': 0.12097307751030587, 'f1-score': 0.17433076640997433, 'support': 39298}, '2': {'precision': 0.4351720216093261, 'recall': 0.5230243485689876, 'f1-score': 0.4750708105381601, 'support': 58525}, 'accuracy': 0.4373620651176631, 'macro avg': {'precision': 0.4039074041806412, 'recall': 0.3994128618027563, 'f1-score': 0.38496920245413263, 'support': 161308}, 'weighted avg': {'precision': 0.4167417244114607, 'recall': 0.4373620651176631, 'f1-score': 0.41378245335615405, 'support': 161308}}
[[35186  5533 22766]
 [17580  4754 16964]
 [22960  4955 30610]]
Evaluating performance on  train set...
477/477 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0104802
{'0': {'precision': 0.4455768771398997, 'recall': 0.6744281341143009, 'f1-score': 0.5366218522851499, 'support': 41487}, '1': {'precision': 0.6287079762689519, 'recall': 0.2931158121190391, 'f1-score': 0.3998253275109171, 'support': 39046}, '2': {'precision': 0.4964086778070947, 'recall': 0.4908208125996425, 'f1-score': 0.49359893113081504, 'support': 41398}, 'accuracy': 0.4899820390220699, 'macro avg': {'precision': 0.5235645104053154, 'recall': 0.48612158627766083, 'f1-score': 0.47668203697562733, 'support': 121931}, 'weighted avg': {'precision': 0.5214794103809419, 'recall': 0.4899820390220699, 'f1-score': 0.47820832335254165, 'support': 121931}}
[[27980  3061 10446]
 [17434 11445 10167]
 [17381  3698 20319]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0367068
{'0': {'precision': 0.424936660268714, 'recall': 0.6829376634914367, 'f1-score': 0.5238956146412108, 'support': 40522}, '1': {'precision': 0.5915044247787611, 'recall': 0.20498540199710494, 'f1-score': 0.3044603163034765, 'support': 40759}, '2': {'precision': 0.4723413228368595, 'recall': 0.4959409594095941, 'f1-score': 0.48385354789934115, 'support': 40650}, 'accuracy': 0.4608262049847865, 'macro avg': {'precision': 0.4962608026281116, 'recall': 0.4612880082993786, 'f1-score': 0.43740315961467613, 'support': 121931}, 'weighted avg': {'precision': 0.4964208197282454, 'recall': 0.4608262049847865, 'f1-score': 0.43719351806195933, 'support': 121931}}
[[27674  2536 10312]
 [20195  8355 12209]
 [17256  3234 20160]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0509815
{'0': {'precision': 0.41497077776112695, 'recall': 0.6783850657781916, 'f1-score': 0.5149466754688561, 'support': 40819}, '1': {'precision': 0.5174711661683041, 'recall': 0.1520598498732207, 'f1-score': 0.235049866118204, 'support': 39833}, '2': {'precision': 0.46406566121022624, 'recall': 0.4889895588555924, 'f1-score': 0.4762017104099086, 'support': 41279}, 'accuracy': 0.4423239373088058, 'macro avg': {'precision': 0.4655025350465525, 'recall': 0.43981149150233484, 'f1-score': 0.40873275066565623, 'support': 121931}, 'weighted avg': {'precision': 0.46507686780646784, 'recall': 0.4423239373088058, 'f1-score': 0.41039177950693645, 'support': 121931}}
[[27691  2559 10569]
 [21034  6057 12742]
 [18005  3089 20185]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0657817
{'0': {'precision': 0.40019474196689386, 'recall': 0.6496097994665613, 'f1-score': 0.49527395970627, 'support': 40492}, '1': {'precision': 0.4554865424430642, 'recall': 0.16929798431138915, 'f1-score': 0.24684655337785258, 'support': 40284}, '2': {'precision': 0.4461314576764492, 'recall': 0.44694447819220023, 'f1-score': 0.4465375978636888, 'support': 41155}, 'accuracy': 0.4225176534269382, 'macro avg': {'precision': 0.43393758069546906, 'recall': 0.4219507539900502, 'f1-score': 0.3962193703159371, 'support': 121931}, 'weighted avg': {'precision': 0.433967124916339, 'recall': 0.4225176534269382, 'f1-score': 0.3967477882800912, 'support': 121931}}
[[26304  3810 10378]
 [21006  6820 12458]
 [18418  4343 18394]]
Evaluating performance on  val set...
184/184 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0137541
{'0': {'precision': 0.4384133611691023, 'recall': 0.6566687938736439, 'f1-score': 0.5257913696635241, 'support': 15670}, '1': {'precision': 0.6412195414716121, 'recall': 0.33763114650486664, 'f1-score': 0.44234670641328205, 'support': 15822}, '2': {'precision': 0.4819876600544019, 'recall': 0.4722745888318273, 'f1-score': 0.4770816916206987, 'support': 15383}, 'accuracy': 0.4884693333333333, 'macro avg': {'precision': 0.5205401875650387, 'recall': 0.4888581764034459, 'f1-score': 0.481739922565835, 'support': 46875}, 'weighted avg': {'precision': 0.5211675547584116, 'recall': 0.4884693333333333, 'f1-score': 0.4816407042922577, 'support': 46875}}
[[10290  1411  3969]
 [ 6641  5342  3839]
 [ 6540  1578  7265]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0468177
{'0': {'precision': 0.40954209386871454, 'recall': 0.6578740157480315, 'f1-score': 0.5048211273633595, 'support': 15240}, '1': {'precision': 0.5978581406177247, 'recall': 0.23101835192515294, 'f1-score': 0.33326123631959165, 'support': 16674}, '2': {'precision': 0.45263619835746977, 'recall': 0.4825880622953011, 'f1-score': 0.4671325051759834, 'support': 14961}, 'accuracy': 0.45009066666666664, 'macro avg': {'precision': 0.48667881094796966, 'recall': 0.4571601433228285, 'f1-score': 0.43507162295297813, 'support': 46875}, 'weighted avg': {'precision': 0.4902826306313655, 'recall': 0.45009066666666664, 'f1-score': 0.4317662132340983, 'support': 46875}}
[[10026  1204  4010]
 [ 8101  3852  4721]
 [ 6354  1387  7220]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0620157
{'0': {'precision': 0.4005022721836881, 'recall': 0.651556420233463, 'f1-score': 0.4960746556065768, 'support': 15420}, '1': {'precision': 0.5091581868640148, 'recall': 0.1678048780487805, 'f1-score': 0.25241916991515706, 'support': 16400}, '2': {'precision': 0.4400634765625, 'recall': 0.4789106609099967, 'f1-score': 0.4586659881039473, 'support': 15055}, 'accuracy': 0.42685866666666666, 'macro avg': {'precision': 0.4499079785367343, 'recall': 0.43275731973074677, 'f1-score': 0.4023866045418938, 'support': 46875}, 'weighted avg': {'precision': 0.451223358747536, 'recall': 0.42685866666666666, 'f1-score': 0.39881305657529426, 'support': 46875}}
[[10047  1281  4092]
 [ 8566  2752  5082]
 [ 6473  1372  7210]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.078158
{'0': {'precision': 0.3830313014827018, 'recall': 0.6150793650793651, 'f1-score': 0.4720812182741117, 'support': 15120}, '1': {'precision': 0.45211486773235254, 'recall': 0.18821035274718803, 'f1-score': 0.2657796257796258, 'support': 16981}, '2': {'precision': 0.41498132165399976, 'recall': 0.43610396642750776, 'f1-score': 0.4252805280528053, 'support': 14774}, 'accuracy': 0.404032, 'macro avg': {'precision': 0.416709163623018, 'recall': 0.413131228084687, 'f1-score': 0.387713790702181, 'support': 46875}, 'weighted avg': {'precision': 0.41812757106128473, 'recall': 0.404032, 'f1-score': 0.38259554916523814, 'support': 46875}}
[[9300 1878 3942]
 [8644 3196 5141]
 [6336 1995 6443]]
training model: results/PCAR/W9/deepVOL_L3/seq2seq
Epoch 1/50
477/477 - 29s - loss: 13.0956 - accuracy10: 0.3918 - accuracy20: 0.3833 - accuracy30: 0.3772 - accuracy50: 0.3760 - val_loss: 13.1207 - val_accuracy10: 0.3783 - val_accuracy20: 0.3697 - val_accuracy30: 0.3698 - val_accuracy50: 0.3625 - 29s/epoch - 60ms/step
Epoch 2/50
477/477 - 22s - loss: 12.9528 - accuracy10: 0.4164 - accuracy20: 0.4064 - accuracy30: 0.3966 - accuracy50: 0.3901 - val_loss: 12.8779 - val_accuracy10: 0.4280 - val_accuracy20: 0.4151 - val_accuracy30: 0.4100 - val_accuracy50: 0.3975 - 22s/epoch - 47ms/step
Epoch 3/50
477/477 - 22s - loss: 12.8902 - accuracy10: 0.4215 - accuracy20: 0.4113 - accuracy30: 0.4023 - accuracy50: 0.3948 - val_loss: 12.7651 - val_accuracy10: 0.4506 - val_accuracy20: 0.4341 - val_accuracy30: 0.4219 - val_accuracy50: 0.4061 - 22s/epoch - 47ms/step
Epoch 4/50
477/477 - 22s - loss: 12.7774 - accuracy10: 0.4418 - accuracy20: 0.4286 - accuracy30: 0.4163 - accuracy50: 0.4013 - val_loss: 12.6661 - val_accuracy10: 0.4640 - val_accuracy20: 0.4439 - val_accuracy30: 0.4283 - val_accuracy50: 0.4102 - 22s/epoch - 46ms/step
Epoch 5/50
477/477 - 22s - loss: 12.6777 - accuracy10: 0.4562 - accuracy20: 0.4404 - accuracy30: 0.4293 - accuracy50: 0.4122 - val_loss: 12.6611 - val_accuracy10: 0.4625 - val_accuracy20: 0.4411 - val_accuracy30: 0.4285 - val_accuracy50: 0.4108 - 22s/epoch - 47ms/step
Epoch 6/50
477/477 - 22s - loss: 12.5986 - accuracy10: 0.4673 - accuracy20: 0.4503 - accuracy30: 0.4373 - accuracy50: 0.4172 - val_loss: 12.6214 - val_accuracy10: 0.4717 - val_accuracy20: 0.4465 - val_accuracy30: 0.4291 - val_accuracy50: 0.4074 - 22s/epoch - 46ms/step
Epoch 7/50
477/477 - 22s - loss: 12.5167 - accuracy10: 0.4765 - accuracy20: 0.4579 - accuracy30: 0.4442 - accuracy50: 0.4248 - val_loss: 12.6394 - val_accuracy10: 0.4673 - val_accuracy20: 0.4421 - val_accuracy30: 0.4281 - val_accuracy50: 0.4027 - 22s/epoch - 47ms/step
Epoch 8/50
477/477 - 22s - loss: 12.4553 - accuracy10: 0.4846 - accuracy20: 0.4657 - accuracy30: 0.4510 - accuracy50: 0.4324 - val_loss: 12.6602 - val_accuracy10: 0.4670 - val_accuracy20: 0.4429 - val_accuracy30: 0.4273 - val_accuracy50: 0.4012 - 22s/epoch - 46ms/step
Epoch 9/50
477/477 - 22s - loss: 12.4080 - accuracy10: 0.4884 - accuracy20: 0.4674 - accuracy30: 0.4527 - accuracy50: 0.4349 - val_loss: 12.6654 - val_accuracy10: 0.4688 - val_accuracy20: 0.4449 - val_accuracy30: 0.4310 - val_accuracy50: 0.4015 - 22s/epoch - 46ms/step
Epoch 10/50
477/477 - 22s - loss: 12.3757 - accuracy10: 0.4932 - accuracy20: 0.4713 - accuracy30: 0.4575 - accuracy50: 0.4372 - val_loss: 12.6488 - val_accuracy10: 0.4702 - val_accuracy20: 0.4474 - val_accuracy30: 0.4310 - val_accuracy50: 0.4042 - 22s/epoch - 46ms/step
Epoch 11/50
477/477 - 22s - loss: 12.3403 - accuracy10: 0.4960 - accuracy20: 0.4740 - accuracy30: 0.4578 - accuracy50: 0.4367 - val_loss: 12.6278 - val_accuracy10: 0.4737 - val_accuracy20: 0.4487 - val_accuracy30: 0.4323 - val_accuracy50: 0.4052 - 22s/epoch - 47ms/step
Epoch 12/50
477/477 - 22s - loss: 12.3213 - accuracy10: 0.4963 - accuracy20: 0.4743 - accuracy30: 0.4584 - accuracy50: 0.4384 - val_loss: 12.6592 - val_accuracy10: 0.4742 - val_accuracy20: 0.4459 - val_accuracy30: 0.4312 - val_accuracy50: 0.4034 - 22s/epoch - 47ms/step
Epoch 13/50
477/477 - 22s - loss: 12.2909 - accuracy10: 0.5000 - accuracy20: 0.4773 - accuracy30: 0.4613 - accuracy50: 0.4423 - val_loss: 12.6585 - val_accuracy10: 0.4754 - val_accuracy20: 0.4456 - val_accuracy30: 0.4298 - val_accuracy50: 0.4015 - 22s/epoch - 47ms/step
Epoch 14/50
477/477 - 22s - loss: 12.2557 - accuracy10: 0.5031 - accuracy20: 0.4810 - accuracy30: 0.4641 - accuracy50: 0.4423 - val_loss: 12.6549 - val_accuracy10: 0.4711 - val_accuracy20: 0.4451 - val_accuracy30: 0.4279 - val_accuracy50: 0.4048 - 22s/epoch - 46ms/step
Epoch 15/50
477/477 - 22s - loss: 12.2311 - accuracy10: 0.5043 - accuracy20: 0.4808 - accuracy30: 0.4651 - accuracy50: 0.4442 - val_loss: 12.7325 - val_accuracy10: 0.4705 - val_accuracy20: 0.4425 - val_accuracy30: 0.4283 - val_accuracy50: 0.4028 - 22s/epoch - 46ms/step
Epoch 16/50
477/477 - 22s - loss: 12.2041 - accuracy10: 0.5065 - accuracy20: 0.4848 - accuracy30: 0.4689 - accuracy50: 0.4474 - val_loss: 12.6267 - val_accuracy10: 0.4801 - val_accuracy20: 0.4508 - val_accuracy30: 0.4325 - val_accuracy50: 0.4052 - 22s/epoch - 47ms/step
testing model: results/PCAR/W9/deepVOL_L3/seq2seq
Evaluating performance on  test set...
631/631 - 14s - 14s/epoch - 22ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0418826
{'0': {'precision': 0.45923858209457186, 'recall': 0.6698224271558914, 'f1-score': 0.5448922585794095, 'support': 61158}, '1': {'precision': 0.40275319567354967, 'recall': 0.15373836452807527, 'f1-score': 0.2225320994585197, 'support': 39964}, '2': {'precision': 0.4720585389878806, 'recall': 0.44590104010899545, 'f1-score': 0.4586071071541478, 'support': 60186}, 'accuracy': 0.45841495772063384, 'macro avg': {'precision': 0.44468343891866735, 'recall': 0.42315394393098743, 'f1-score': 0.40867715506402563, 'support': 161308}, 'weighted avg': {'precision': 0.4500276312592193, 'recall': 0.45841495772063384, 'f1-score': 0.4328335911680719, 'support': 161308}}
[[40965  5231 14962]
 [18768  6144 15052]
 [29469  3880 26837]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0588583
{'0': {'precision': 0.441241809532358, 'recall': 0.6580272734878273, 'f1-score': 0.5282585480848664, 'support': 59765}, '1': {'precision': 0.38578145834795424, 'recall': 0.12634167643476063, 'f1-score': 0.19034592610547457, 'support': 43509}, '2': {'precision': 0.4509502684227788, 'recall': 0.4501499121204811, 'f1-score': 0.4505497348337861, 'support': 58034}, 'accuracy': 0.43982939469834104, 'macro avg': {'precision': 0.42599117876769704, 'recall': 0.4115062873476896, 'f1-score': 0.38971806967470907, 'support': 161308}, 'weighted avg': {'precision': 0.4297755231954401, 'recall': 0.43982939469834104, 'f1-score': 0.4091572416529811, 'support': 161308}}
[[39327  4948 15490]
 [21695  5497 16317]
 [28106  3804 26124]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0664179
{'0': {'precision': 0.4377136667757331, 'recall': 0.6449709060681629, 'f1-score': 0.5215047620327865, 'support': 60150}, '1': {'precision': 0.3665537173609727, 'recall': 0.12537781514896712, 'f1-score': 0.18684593761641888, 'support': 44003}, '2': {'precision': 0.4404435497865547, 'recall': 0.4440731344589275, 'f1-score': 0.4422508951830007, 'support': 57155}, 'accuracy': 0.4320492474024847, 'macro avg': {'precision': 0.4149036446410868, 'recall': 0.40480728522535253, 'f1-score': 0.3835338649440687, 'support': 161308}, 'weighted avg': {'precision': 0.4192692945771181, 'recall': 0.4320492474024847, 'f1-score': 0.4021322137983968, 'support': 161308}}
[[38795  5193 16162]
 [22403  5517 16083]
 [27433  4341 25381]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0714066
{'0': {'precision': 0.44806505825691695, 'recall': 0.6257383633929274, 'f1-score': 0.522202650120938, 'support': 63485}, '1': {'precision': 0.30645897523679105, 'recall': 0.1366736220672808, 'f1-score': 0.18903984232014642, 'support': 39298}, '2': {'precision': 0.43831068700905246, 'recall': 0.4128321230243486, 'f1-score': 0.4251900605378009, 'support': 58525}, 'accuracy': 0.429346343640737, 'macro avg': {'precision': 0.3976115735009202, 'recall': 0.39174803616151893, 'f1-score': 0.3788108509929618, 'support': 161308}, 'weighted avg': {'precision': 0.4100278224855592, 'recall': 0.429346343640737, 'f1-score': 0.4058395817901137, 'support': 161308}}
[[39725  6411 17349]
 [20314  5371 13613]
 [28620  5744 24161]]
Evaluating performance on  train set...
477/477 - 9s - 9s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0316309
{'0': {'precision': 0.4182861597183023, 'recall': 0.750186805505339, 'f1-score': 0.5370988756870562, 'support': 41487}, '1': {'precision': 0.6072109654350417, 'recall': 0.2609486246990729, 'f1-score': 0.36502704832873567, 'support': 39046}, '2': {'precision': 0.4865506586436819, 'recall': 0.36134595874196823, 'f1-score': 0.41470412929875383, 'support': 41398}, 'accuracy': 0.4614987164871936, 'macro avg': {'precision': 0.504015927932342, 'recall': 0.4574937963154601, 'f1-score': 0.43894335110484856, 'support': 121931}, 'weighted avg': {'precision': 0.5019627611611567, 'recall': 0.4614987164871936, 'f1-score': 0.440440812667677, 'support': 121931}}
[[31123  3412  6952]
 [20023 10189  8834]
 [23260  3179 14959]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.049298
{'0': {'precision': 0.40174580081999733, 'recall': 0.7496174917328858, 'f1-score': 0.5231288533737471, 'support': 40522}, '1': {'precision': 0.5701868188894655, 'recall': 0.21565789150862386, 'f1-score': 0.31295060080106807, 'support': 40759}, '2': {'precision': 0.4744216146254651, 'recall': 0.36068880688806887, 'f1-score': 0.4098106351757389, 'support': 40650}, 'accuracy': 0.4414627945313333, 'macro avg': {'precision': 0.4821180781116427, 'recall': 0.44198806337652624, 'f1-score': 0.41529669645018474, 'support': 121931}, 'weighted avg': {'precision': 0.48228117973664464, 'recall': 0.4414627945313333, 'f1-score': 0.4150920049401342, 'support': 121931}}
[[30376  3286  6860]
 [22586  8790  9383]
 [22648  3340 14662]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0597615
{'0': {'precision': 0.39670475614406503, 'recall': 0.7390920894681399, 'f1-score': 0.5162918848615532, 'support': 40819}, '1': {'precision': 0.5137194137775195, 'recall': 0.1997589937991113, 'f1-score': 0.28766132822385304, 'support': 39833}, '2': {'precision': 0.47149014575724674, 'recall': 0.3471498825068437, 'f1-score': 0.399877218439558, 'support': 41279}, 'accuracy': 0.43021052890569256, 'macro avg': {'precision': 0.4606381052262771, 'recall': 0.428666988591365, 'f1-score': 0.40127681050832137, 'support': 121931}, 'weighted avg': {'precision': 0.46024980174654445, 'recall': 0.43021052890569256, 'f1-score': 0.40219028659874023, 'support': 121931}}
[[30169  3616  7034]
 [22847  7957  9029]
 [23033  3916 14330]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0714833
{'0': {'precision': 0.38406840919805146, 'recall': 0.7243159142546676, 'f1-score': 0.5019682344081604, 'support': 40492}, '1': {'precision': 0.46356680400235434, 'recall': 0.1955118657531526, 'f1-score': 0.2750288088836121, 'support': 40284}, '2': {'precision': 0.45130699513594846, 'recall': 0.31337626047867817, 'f1-score': 0.3699019101703666, 'support': 41155}, 'accuracy': 0.41090452797073757, 'macro avg': {'precision': 0.43298073611211807, 'recall': 0.41106801349549943, 'f1-score': 0.3822996511540464, 'support': 121931}, 'weighted avg': {'precision': 0.4330282089255259, 'recall': 0.41090452797073757, 'f1-score': 0.3824152299069482, 'support': 121931}}
[[29329  4213  6950]
 [23678  7876  8730]
 [23357  4901 12897]]
Evaluating performance on  val set...
184/184 - 4s - 4s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0257566
{'0': {'precision': 0.4217815075452527, 'recall': 0.7152520740268028, 'f1-score': 0.5306441303884666, 'support': 15670}, '1': {'precision': 0.5997312129017807, 'recall': 0.338452787258248, 'f1-score': 0.4327097895034544, 'support': 15822}, '2': {'precision': 0.4848324980216302, 'recall': 0.3584476370018852, 'f1-score': 0.41216923306921815, 'support': 15383}, 'accuracy': 0.470976, 'macro avg': {'precision': 0.5021150728228879, 'recall': 0.47071749942897867, 'f1-score': 0.45850771765371306, 'support': 46875}, 'weighted avg': {'precision': 0.5025374248711002, 'recall': 0.470976, 'f1-score': 0.4587077786669805, 'support': 46875}}
[[11208  1841  2621]
 [ 7229  5355  3238]
 [ 8136  1733  5514]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.048045
{'0': {'precision': 0.4006323064480553, 'recall': 0.7150918635170603, 'f1-score': 0.5135479006644361, 'support': 15240}, '1': {'precision': 0.5696480938416423, 'recall': 0.2795969773299748, 'f1-score': 0.3750905141202027, 'support': 16674}, '2': {'precision': 0.4621812168160849, 'recall': 0.35492279927812315, 'f1-score': 0.40151228733459365, 'support': 14961}, 'accuracy': 0.44522666666666666, 'macro avg': {'precision': 0.4774872057019275, 'recall': 0.4498705467083861, 'f1-score': 0.43005023403974424, 'support': 46875}, 'weighted avg': {'precision': 0.4803976928377462, 'recall': 0.44522666666666666, 'f1-score': 0.42853876414675457, 'support': 46875}}
[[10898  1721  2621]
 [ 8454  4662  3558]
 [ 7850  1801  5310]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0591494
{'0': {'precision': 0.3942265795206972, 'recall': 0.7040856031128405, 'f1-score': 0.5054469273743017, 'support': 15420}, '1': {'precision': 0.5101179391682185, 'recall': 0.2505487804878049, 'f1-score': 0.33604579840523413, 'support': 16400}, '2': {'precision': 0.4523049645390071, 'recall': 0.33889073397542346, 'f1-score': 0.38746914752230865, 'support': 15055}, 'accuracy': 0.42811733333333335, 'macro avg': {'precision': 0.4522164944093076, 'recall': 0.431175039192023, 'f1-score': 0.40965395776728153, 'support': 46875}, 'weighted avg': {'precision': 0.45342633172699065, 'recall': 0.42811733333333335, 'f1-score': 0.4082878022379931, 'support': 46875}}
[[10857  1862  2701]
 [ 8814  4109  3477]
 [ 7869  2084  5102]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.072597
{'0': {'precision': 0.3736739554016021, 'recall': 0.6849206349206349, 'f1-score': 0.4835411122005883, 'support': 15120}, '1': {'precision': 0.47798079175450925, 'recall': 0.24032742476885932, 'f1-score': 0.31984011912692506, 'support': 16981}, '2': {'precision': 0.42746869999058645, 'recall': 0.3073642886151347, 'f1-score': 0.35760129149112097, 'support': 14774}, 'accuracy': 0.404864, 'macro avg': {'precision': 0.4263744823822326, 'recall': 0.41087078276820965, 'f1-score': 0.38699417427287813, 'support': 46875}, 'weighted avg': {'precision': 0.42841524488781796, 'recall': 0.404864, 'f1-score': 0.3845450274102833, 'support': 46875}}
[[10356  2142  2622]
 [ 9440  4081  3460]
 [ 7918  2315  4541]]
training model: results/PCAR/W10/deepLOB_L1/seq2seq
Epoch 1/50
428/428 - 20s - loss: 13.0449 - accuracy10: 0.4054 - accuracy20: 0.3947 - accuracy30: 0.3884 - accuracy50: 0.3855 - val_loss: 13.4137 - val_accuracy10: 0.3352 - val_accuracy20: 0.3391 - val_accuracy30: 0.3368 - val_accuracy50: 0.3297 - 20s/epoch - 46ms/step
Epoch 2/50
428/428 - 13s - loss: 12.9629 - accuracy10: 0.4167 - accuracy20: 0.4058 - accuracy30: 0.3967 - accuracy50: 0.3870 - val_loss: 13.0498 - val_accuracy10: 0.4019 - val_accuracy20: 0.3911 - val_accuracy30: 0.3714 - val_accuracy50: 0.3458 - 13s/epoch - 30ms/step
Epoch 3/50
428/428 - 13s - loss: 12.9182 - accuracy10: 0.4236 - accuracy20: 0.4101 - accuracy30: 0.3976 - accuracy50: 0.3832 - val_loss: 13.0578 - val_accuracy10: 0.3996 - val_accuracy20: 0.3839 - val_accuracy30: 0.3697 - val_accuracy50: 0.3469 - 13s/epoch - 29ms/step
Epoch 4/50
428/428 - 13s - loss: 12.8886 - accuracy10: 0.4293 - accuracy20: 0.4139 - accuracy30: 0.4004 - accuracy50: 0.3862 - val_loss: 13.0128 - val_accuracy10: 0.4211 - val_accuracy20: 0.3979 - val_accuracy30: 0.3798 - val_accuracy50: 0.3556 - 13s/epoch - 30ms/step
Epoch 5/50
428/428 - 13s - loss: 12.8558 - accuracy10: 0.4380 - accuracy20: 0.4209 - accuracy30: 0.4066 - accuracy50: 0.3922 - val_loss: 12.9828 - val_accuracy10: 0.4211 - val_accuracy20: 0.4013 - val_accuracy30: 0.3854 - val_accuracy50: 0.3642 - 13s/epoch - 30ms/step
Epoch 6/50
428/428 - 13s - loss: 12.8243 - accuracy10: 0.4425 - accuracy20: 0.4252 - accuracy30: 0.4111 - accuracy50: 0.3977 - val_loss: 12.9897 - val_accuracy10: 0.4224 - val_accuracy20: 0.4029 - val_accuracy30: 0.3879 - val_accuracy50: 0.3687 - 13s/epoch - 30ms/step
Epoch 7/50
428/428 - 13s - loss: 12.7960 - accuracy10: 0.4461 - accuracy20: 0.4286 - accuracy30: 0.4145 - accuracy50: 0.4007 - val_loss: 12.9814 - val_accuracy10: 0.4231 - val_accuracy20: 0.4015 - val_accuracy30: 0.3857 - val_accuracy50: 0.3613 - 13s/epoch - 29ms/step
Epoch 8/50
428/428 - 12s - loss: 12.7787 - accuracy10: 0.4487 - accuracy20: 0.4302 - accuracy30: 0.4133 - accuracy50: 0.4006 - val_loss: 12.9947 - val_accuracy10: 0.4188 - val_accuracy20: 0.4014 - val_accuracy30: 0.3853 - val_accuracy50: 0.3628 - 12s/epoch - 29ms/step
Epoch 9/50
428/428 - 13s - loss: 12.7656 - accuracy10: 0.4508 - accuracy20: 0.4316 - accuracy30: 0.4157 - accuracy50: 0.4041 - val_loss: 12.9808 - val_accuracy10: 0.4249 - val_accuracy20: 0.4066 - val_accuracy30: 0.3905 - val_accuracy50: 0.3702 - 13s/epoch - 30ms/step
Epoch 10/50
428/428 - 13s - loss: 12.7508 - accuracy10: 0.4534 - accuracy20: 0.4341 - accuracy30: 0.4186 - accuracy50: 0.4059 - val_loss: 13.0399 - val_accuracy10: 0.4115 - val_accuracy20: 0.3978 - val_accuracy30: 0.3863 - val_accuracy50: 0.3622 - 13s/epoch - 30ms/step
Epoch 11/50
428/428 - 12s - loss: 12.7411 - accuracy10: 0.4516 - accuracy20: 0.4343 - accuracy30: 0.4189 - accuracy50: 0.4078 - val_loss: 13.0479 - val_accuracy10: 0.4102 - val_accuracy20: 0.3939 - val_accuracy30: 0.3799 - val_accuracy50: 0.3612 - 12s/epoch - 29ms/step
Epoch 12/50
428/428 - 12s - loss: 12.7278 - accuracy10: 0.4546 - accuracy20: 0.4362 - accuracy30: 0.4198 - accuracy50: 0.4086 - val_loss: 13.0875 - val_accuracy10: 0.4047 - val_accuracy20: 0.3890 - val_accuracy30: 0.3794 - val_accuracy50: 0.3618 - 12s/epoch - 28ms/step
Epoch 13/50
428/428 - 12s - loss: 12.7166 - accuracy10: 0.4564 - accuracy20: 0.4368 - accuracy30: 0.4211 - accuracy50: 0.4122 - val_loss: 13.1309 - val_accuracy10: 0.4025 - val_accuracy20: 0.3853 - val_accuracy30: 0.3732 - val_accuracy50: 0.3542 - 12s/epoch - 28ms/step
Epoch 14/50
428/428 - 12s - loss: 12.7034 - accuracy10: 0.4578 - accuracy20: 0.4382 - accuracy30: 0.4225 - accuracy50: 0.4119 - val_loss: 13.1056 - val_accuracy10: 0.4043 - val_accuracy20: 0.3876 - val_accuracy30: 0.3790 - val_accuracy50: 0.3585 - 12s/epoch - 27ms/step
Epoch 15/50
428/428 - 11s - loss: 12.6905 - accuracy10: 0.4587 - accuracy20: 0.4396 - accuracy30: 0.4239 - accuracy50: 0.4132 - val_loss: 13.1048 - val_accuracy10: 0.3975 - val_accuracy20: 0.3839 - val_accuracy30: 0.3721 - val_accuracy50: 0.3539 - 11s/epoch - 27ms/step
Epoch 16/50
428/428 - 12s - loss: 12.6803 - accuracy10: 0.4591 - accuracy20: 0.4395 - accuracy30: 0.4226 - accuracy50: 0.4141 - val_loss: 13.1087 - val_accuracy10: 0.4009 - val_accuracy20: 0.3872 - val_accuracy30: 0.3738 - val_accuracy50: 0.3546 - 12s/epoch - 28ms/step
Epoch 17/50
428/428 - 12s - loss: 12.6724 - accuracy10: 0.4586 - accuracy20: 0.4398 - accuracy30: 0.4235 - accuracy50: 0.4146 - val_loss: 13.1259 - val_accuracy10: 0.3935 - val_accuracy20: 0.3794 - val_accuracy30: 0.3703 - val_accuracy50: 0.3532 - 12s/epoch - 29ms/step
Epoch 18/50
428/428 - 12s - loss: 12.6585 - accuracy10: 0.4626 - accuracy20: 0.4429 - accuracy30: 0.4259 - accuracy50: 0.4165 - val_loss: 13.1132 - val_accuracy10: 0.3959 - val_accuracy20: 0.3845 - val_accuracy30: 0.3752 - val_accuracy50: 0.3584 - 12s/epoch - 29ms/step
Epoch 19/50
428/428 - 12s - loss: 12.6494 - accuracy10: 0.4620 - accuracy20: 0.4424 - accuracy30: 0.4256 - accuracy50: 0.4182 - val_loss: 13.0854 - val_accuracy10: 0.4028 - val_accuracy20: 0.3892 - val_accuracy30: 0.3798 - val_accuracy50: 0.3606 - 12s/epoch - 28ms/step
testing model: results/PCAR/W10/deepLOB_L1/seq2seq
Evaluating performance on  test set...
2104/2104 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.09538
{'0': {'precision': 0.5033213383067282, 'recall': 0.48727907801741, 'f1-score': 0.49517031011692936, 'support': 219874}, '1': {'precision': 0.22330102881149597, 'recall': 0.36915108765352933, 'f1-score': 0.27827335026418826, 'support': 101365}, '2': {'precision': 0.5140238927923199, 'recall': 0.37400263203909406, 'f1-score': 0.4329742039446523, 'support': 217322}, 'accuracy': 0.4193359712270291, 'macro avg': {'precision': 0.4135487533035147, 'recall': 0.41014426590334446, 'f1-score': 0.40213928810858995, 'support': 538561}, 'weighted avg': {'precision': 0.4549361820736061, 'recall': 0.4193359712270291, 'f1-score': 0.42924956479551785, 'support': 538561}}
[[107140  64226  48508]
 [ 35610  37419  28336]
 [ 70116  65927  81279]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1023399
{'0': {'precision': 0.47274634151122785, 'recall': 0.4542209749114744, 'f1-score': 0.46329854423722544, 'support': 212368}, '1': {'precision': 0.2280589331581786, 'recall': 0.3650795007693623, 'f1-score': 0.2807426958056553, 'support': 116980}, '2': {'precision': 0.4794841496210578, 'recall': 0.3374790285498511, 'f1-score': 0.3961398734798648, 'support': 209213}, 'accuracy': 0.3895083379598597, 'macro avg': {'precision': 0.39342980809682143, 'recall': 0.38559316807689586, 'f1-score': 0.3800603711742485, 'support': 538561}, 'weighted avg': {'precision': 0.42221558272799287, 'recall': 0.3895083379598597, 'f1-score': 0.39755696596719703, 'support': 538561}}
[[96462 71355 44551]
 [42177 42707 32096]
 [65407 73201 70605]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1086676
{'0': {'precision': 0.46215843784049393, 'recall': 0.40860666962590786, 'f1-score': 0.43373584565181433, 'support': 211766}, '1': {'precision': 0.21685763299604613, 'recall': 0.4028734065035108, 'f1-score': 0.28194867696785003, 'support': 117352}, '2': {'precision': 0.466272624307113, 'recall': 0.2968015164030309, 'f1-score': 0.36271815428781484, 'support': 209443}, 'accuracy': 0.3638770724207657, 'macro avg': {'precision': 0.38176289838121774, 'recall': 0.36942719751081654, 'f1-score': 0.3594675589691598, 'support': 538561}, 'weighted avg': {'precision': 0.4103075750896124, 'recall': 0.3638770724207657, 'f1-score': 0.37304321073812635, 'support': 538561}}
[[86529 83929 41308]
 [40226 47278 29848]
 [60473 86807 62163]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1218023
{'0': {'precision': 0.46785179663217885, 'recall': 0.35193827897469293, 'f1-score': 0.401700291382661, 'support': 221124}, '1': {'precision': 0.17600764315996895, 'recall': 0.4557580505504474, 'f1-score': 0.25394509745359933, 'support': 97012}, '2': {'precision': 0.4678516241519787, 'recall': 0.25685834183962797, 'f1-score': 0.3316405128835937, 'support': 220425}, 'accuracy': 0.3317247257042378, 'macro avg': {'precision': 0.37057035464804217, 'recall': 0.3548515571215894, 'f1-score': 0.3290953005732847, 'support': 538561}, 'weighted avg': {'precision': 0.4152812929462562, 'recall': 0.3317247257042378, 'f1-score': 0.34641044761546835, 'support': 538561}}
[[ 77822 101529  41773]
 [ 30172  44214  22626]
 [ 58345 105462  56618]]
Evaluating performance on  train set...
428/428 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.064594
{'0': {'precision': 0.4392584673696487, 'recall': 0.4986072423398329, 'f1-score': 0.46705503959078754, 'support': 36259}, '1': {'precision': 0.39035630260253706, 'recall': 0.4450282048445968, 'f1-score': 0.4159032470636879, 'support': 36164}, '2': {'precision': 0.47799461393735937, 'recall': 0.3495184915432548, 'f1-score': 0.40378322789741034, 'support': 37071}, 'accuracy': 0.430434544358595, 'macro avg': {'precision': 0.43586979463651504, 'recall': 0.43105131290922816, 'f1-score': 0.4289138381839619, 'support': 109494}, 'weighted avg': {'precision': 0.4362216781645213, 'recall': 0.430434544358595, 'f1-score': 0.4287387596463594, 'support': 109494}}
[[18079 11801  6379]
 [12299 16094  7771]
 [10780 13334 12957]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0756918
{'0': {'precision': 0.42615198786975406, 'recall': 0.45681699220364197, 'f1-score': 0.44095200106368837, 'support': 36299}, '1': {'precision': 0.36672633554036277, 'recall': 0.4701263512953081, 'f1-score': 0.41203838325094505, 'support': 36169}, '2': {'precision': 0.46357779980178393, 'recall': 0.30319235132069355, 'f1-score': 0.36661114921132554, 'support': 37026}, 'accuracy': 0.4092644345808903, 'macro avg': {'precision': 0.41881870773730023, 'recall': 0.4100452316065479, 'f1-score': 0.406533844508653, 'support': 109494}, 'weighted avg': {'precision': 0.4191777399063367, 'recall': 0.4092644345808903, 'f1-score': 0.4062622370277166, 'support': 109494}}
[[16582 13776  5941]
 [12116 17004  7049]
 [10213 15587 11226]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0832937
{'0': {'precision': 0.4174258549737477, 'recall': 0.40659036877315197, 'f1-score': 0.41193687070257246, 'support': 36174}, '1': {'precision': 0.3514477862880628, 'recall': 0.5180503923998347, 'f1-score': 0.4187879125159998, 'support': 36315}, '2': {'precision': 0.452409667615418, 'recall': 0.25342521280907987, 'f1-score': 0.32486922783801575, 'support': 37005}, 'accuracy': 0.3917931576159424, 'macro avg': {'precision': 0.40709443629240943, 'recall': 0.39268865799402225, 'f1-score': 0.3851980036855293, 'support': 109494}, 'weighted avg': {'precision': 0.40736669577310075, 'recall': 0.3917931576159424, 'f1-score': 0.38478339616745355, 'support': 109494}}
[[14708 16259  5207]
 [11358 18813  6144]
 [ 9169 18458  9378]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0893611
{'0': {'precision': 0.4098481450631127, 'recall': 0.3499466586426676, 'f1-score': 0.37753611426716444, 'support': 36557}, '1': {'precision': 0.3448332674311322, 'recall': 0.5778894472361809, 'f1-score': 0.4319293394143261, 'support': 36218}, '2': {'precision': 0.4355095541401274, 'recall': 0.20855687791061847, 'f1-score': 0.28204703239231715, 'support': 36719}, 'accuracy': 0.3779293842584982, 'macro avg': {'precision': 0.3967303222114575, 'recall': 0.3787976612631556, 'f1-score': 0.3638374953579359, 'support': 109494}, 'weighted avg': {'precision': 0.39694837376809955, 'recall': 0.3779293842584982, 'f1-score': 0.3635056672199964, 'support': 109494}}
[[12793 19028  4736]
 [10098 20930  5190]
 [ 8323 20738  7658]]
Evaluating performance on  val set...
141/141 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0697737
{'0': {'precision': 0.4368034613871771, 'recall': 0.5478089287182438, 'f1-score': 0.48604880183827553, 'support': 12163}, '1': {'precision': 0.37174558797833307, 'recall': 0.3758833922261484, 'f1-score': 0.37380303962048667, 'support': 11320}, '2': {'precision': 0.47118202539889287, 'recall': 0.34923572003218023, 'f1-score': 0.4011458670239801, 'support': 12430}, 'accuracy': 0.4248879235931278, 'macro avg': {'precision': 0.4265770249214677, 'recall': 0.4243093469921908, 'f1-score': 0.4203325694942474, 'support': 35913}, 'weighted avg': {'precision': 0.4281957266860246, 'recall': 0.4248879235931278, 'f1-score': 0.42128212937852383, 'support': 35913}}
[[6663 3263 2237]
 [4430 4255 2635]
 [4161 3928 4341]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0785476
{'0': {'precision': 0.419891425389755, 'recall': 0.5075292336165559, 'f1-score': 0.45956960578937345, 'support': 11887}, '1': {'precision': 0.3582122905027933, 'recall': 0.4129669386002576, 'f1-score': 0.3836457917830076, 'support': 11645}, '2': {'precision': 0.46293103448275863, 'recall': 0.3036103707293433, 'f1-score': 0.36671381883810544, 'support': 12381}, 'accuracy': 0.4065658675131568, 'macro avg': {'precision': 0.41367825012510234, 'recall': 0.4080355143153856, 'f1-score': 0.40330973880349547, 'support': 35913}, 'weighted avg': {'precision': 0.414729502810795, 'recall': 0.4065658675131568, 'f1-score': 0.4029388505657002, 'support': 35913}}
[[6033 3907 1947]
 [4422 4809 2414]
 [3913 4709 3759]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0857458
{'0': {'precision': 0.4142492457646786, 'recall': 0.4490942636699094, 'f1-score': 0.43096857269325173, 'support': 11924}, '1': {'precision': 0.34459543697793293, 'recall': 0.4786147186147186, 'f1-score': 0.4006958538706872, 'support': 11550}, '2': {'precision': 0.4544930875576037, 'recall': 0.25371814454538144, 'f1-score': 0.32564618480111435, 'support': 12439}, 'accuracy': 0.39091693815609946, 'macro avg': {'precision': 0.4044459234334051, 'recall': 0.3938090422766698, 'f1-score': 0.3857702037883511, 'support': 35913}, 'weighted avg': {'precision': 0.4057868966592093, 'recall': 0.39091693815609946, 'f1-score': 0.38475257610731023, 'support': 35913}}
[[5355 4804 1765]
 [3999 5528 2023]
 [3573 5710 3156]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0942065
{'0': {'precision': 0.4109977827050998, 'recall': 0.38446859702978514, 'f1-score': 0.39729080932784644, 'support': 12053}, '1': {'precision': 0.3278417573043293, 'recall': 0.5438224108959052, 'f1-score': 0.40907427735089646, 'support': 11307}, '2': {'precision': 0.435056103366202, 'recall': 0.20385565203537004, 'f1-score': 0.2776240846216436, 'support': 12553}, 'accuracy': 0.3715089243449447, 'macro avg': {'precision': 0.39129854779187706, 'recall': 0.3773822199870201, 'f1-score': 0.36132972376679545, 'support': 35913}, 'weighted avg': {'precision': 0.39322591513770927, 'recall': 0.3715089243449447, 'f1-score': 0.3591725590479941, 'support': 35913}}
[[4634 5817 1602]
 [3437 6149 1721]
 [3204 6790 2559]]
training model: results/PCAR/W10/deepOF_L1/seq2seq
Epoch 1/50
428/428 - 20s - loss: 13.1810 - accuracy10: 0.3780 - accuracy20: 0.3743 - accuracy30: 0.3697 - accuracy50: 0.3681 - val_loss: 13.1693 - val_accuracy10: 0.3734 - val_accuracy20: 0.3593 - val_accuracy30: 0.3527 - val_accuracy50: 0.3414 - 20s/epoch - 46ms/step
Epoch 2/50
428/428 - 12s - loss: 13.0954 - accuracy10: 0.3888 - accuracy20: 0.3816 - accuracy30: 0.3748 - accuracy50: 0.3707 - val_loss: 13.1395 - val_accuracy10: 0.3842 - val_accuracy20: 0.3654 - val_accuracy30: 0.3558 - val_accuracy50: 0.3381 - 12s/epoch - 29ms/step
Epoch 3/50
428/428 - 12s - loss: 13.0674 - accuracy10: 0.3924 - accuracy20: 0.3835 - accuracy30: 0.3774 - accuracy50: 0.3723 - val_loss: 13.1093 - val_accuracy10: 0.3891 - val_accuracy20: 0.3716 - val_accuracy30: 0.3595 - val_accuracy50: 0.3498 - 12s/epoch - 28ms/step
Epoch 4/50
428/428 - 12s - loss: 13.0493 - accuracy10: 0.3974 - accuracy20: 0.3875 - accuracy30: 0.3804 - accuracy50: 0.3776 - val_loss: 13.1020 - val_accuracy10: 0.3875 - val_accuracy20: 0.3724 - val_accuracy30: 0.3628 - val_accuracy50: 0.3517 - 12s/epoch - 28ms/step
Epoch 5/50
428/428 - 12s - loss: 13.0358 - accuracy10: 0.4005 - accuracy20: 0.3904 - accuracy30: 0.3834 - accuracy50: 0.3796 - val_loss: 13.0973 - val_accuracy10: 0.3941 - val_accuracy20: 0.3718 - val_accuracy30: 0.3659 - val_accuracy50: 0.3521 - 12s/epoch - 29ms/step
Epoch 6/50
428/428 - 12s - loss: 13.0287 - accuracy10: 0.4021 - accuracy20: 0.3895 - accuracy30: 0.3840 - accuracy50: 0.3801 - val_loss: 13.0877 - val_accuracy10: 0.3926 - val_accuracy20: 0.3720 - val_accuracy30: 0.3649 - val_accuracy50: 0.3547 - 12s/epoch - 28ms/step
Epoch 7/50
428/428 - 11s - loss: 13.0157 - accuracy10: 0.4036 - accuracy20: 0.3917 - accuracy30: 0.3861 - accuracy50: 0.3821 - val_loss: 13.0908 - val_accuracy10: 0.3915 - val_accuracy20: 0.3718 - val_accuracy30: 0.3632 - val_accuracy50: 0.3563 - 11s/epoch - 26ms/step
Epoch 8/50
428/428 - 12s - loss: 13.0100 - accuracy10: 0.4045 - accuracy20: 0.3935 - accuracy30: 0.3862 - accuracy50: 0.3831 - val_loss: 13.0880 - val_accuracy10: 0.3909 - val_accuracy20: 0.3738 - val_accuracy30: 0.3639 - val_accuracy50: 0.3582 - 12s/epoch - 27ms/step
Epoch 9/50
428/428 - 12s - loss: 12.9997 - accuracy10: 0.4061 - accuracy20: 0.3962 - accuracy30: 0.3884 - accuracy50: 0.3839 - val_loss: 13.0795 - val_accuracy10: 0.3942 - val_accuracy20: 0.3784 - val_accuracy30: 0.3696 - val_accuracy50: 0.3593 - 12s/epoch - 27ms/step
Epoch 10/50
428/428 - 11s - loss: 12.9928 - accuracy10: 0.4062 - accuracy20: 0.3947 - accuracy30: 0.3879 - accuracy50: 0.3846 - val_loss: 13.0889 - val_accuracy10: 0.3925 - val_accuracy20: 0.3760 - val_accuracy30: 0.3673 - val_accuracy50: 0.3586 - 11s/epoch - 27ms/step
Epoch 11/50
428/428 - 11s - loss: 12.9880 - accuracy10: 0.4071 - accuracy20: 0.3951 - accuracy30: 0.3893 - accuracy50: 0.3850 - val_loss: 13.0854 - val_accuracy10: 0.3920 - val_accuracy20: 0.3749 - val_accuracy30: 0.3673 - val_accuracy50: 0.3583 - 11s/epoch - 26ms/step
Epoch 12/50
428/428 - 11s - loss: 12.9800 - accuracy10: 0.4088 - accuracy20: 0.3965 - accuracy30: 0.3904 - accuracy50: 0.3869 - val_loss: 13.0883 - val_accuracy10: 0.3927 - val_accuracy20: 0.3720 - val_accuracy30: 0.3671 - val_accuracy50: 0.3577 - 11s/epoch - 26ms/step
Epoch 13/50
428/428 - 11s - loss: 12.9806 - accuracy10: 0.4079 - accuracy20: 0.3973 - accuracy30: 0.3897 - accuracy50: 0.3869 - val_loss: 13.0853 - val_accuracy10: 0.3917 - val_accuracy20: 0.3765 - val_accuracy30: 0.3663 - val_accuracy50: 0.3570 - 11s/epoch - 26ms/step
Epoch 14/50
428/428 - 11s - loss: 12.9693 - accuracy10: 0.4095 - accuracy20: 0.3991 - accuracy30: 0.3909 - accuracy50: 0.3883 - val_loss: 13.0856 - val_accuracy10: 0.3929 - val_accuracy20: 0.3787 - val_accuracy30: 0.3696 - val_accuracy50: 0.3624 - 11s/epoch - 27ms/step
Epoch 15/50
428/428 - 11s - loss: 12.9638 - accuracy10: 0.4105 - accuracy20: 0.3988 - accuracy30: 0.3912 - accuracy50: 0.3877 - val_loss: 13.0902 - val_accuracy10: 0.3923 - val_accuracy20: 0.3766 - val_accuracy30: 0.3669 - val_accuracy50: 0.3562 - 11s/epoch - 26ms/step
Epoch 16/50
428/428 - 11s - loss: 12.9535 - accuracy10: 0.4119 - accuracy20: 0.4015 - accuracy30: 0.3940 - accuracy50: 0.3906 - val_loss: 13.0840 - val_accuracy10: 0.3926 - val_accuracy20: 0.3765 - val_accuracy30: 0.3704 - val_accuracy50: 0.3643 - 11s/epoch - 26ms/step
Epoch 17/50
428/428 - 11s - loss: 12.9431 - accuracy10: 0.4126 - accuracy20: 0.4019 - accuracy30: 0.3962 - accuracy50: 0.3916 - val_loss: 13.0839 - val_accuracy10: 0.3921 - val_accuracy20: 0.3774 - val_accuracy30: 0.3699 - val_accuracy50: 0.3672 - 11s/epoch - 26ms/step
Epoch 18/50
428/428 - 11s - loss: 12.9375 - accuracy10: 0.4122 - accuracy20: 0.4014 - accuracy30: 0.3959 - accuracy50: 0.3931 - val_loss: 13.0895 - val_accuracy10: 0.3917 - val_accuracy20: 0.3747 - val_accuracy30: 0.3717 - val_accuracy50: 0.3613 - 11s/epoch - 26ms/step
Epoch 19/50
428/428 - 11s - loss: 12.9291 - accuracy10: 0.4157 - accuracy20: 0.4042 - accuracy30: 0.3971 - accuracy50: 0.3926 - val_loss: 13.0876 - val_accuracy10: 0.3922 - val_accuracy20: 0.3761 - val_accuracy30: 0.3700 - val_accuracy50: 0.3625 - 11s/epoch - 26ms/step
testing model: results/PCAR/W10/deepOF_L1/seq2seq
Evaluating performance on  test set...
2104/2104 - 28s - 28s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0945309
{'0': {'precision': 0.47572622970828754, 'recall': 0.42544491997580397, 'f1-score': 0.44918283901916667, 'support': 219871}, '1': {'precision': 0.22106626840003168, 'recall': 0.38550781828047154, 'f1-score': 0.28099708410784846, 'support': 101365}, '2': {'precision': 0.4740854212330011, 'recall': 0.3602935762930241, 'f1-score': 0.4094300848676264, 'support': 217320}, 'accuracy': 0.3916380097891399, 'macro avg': {'precision': 0.3902926397804401, 'recall': 0.3904154381830999, 'f1-score': 0.3798700026648805, 'support': 538556}, 'weighted avg': {'precision': 0.4271329776121998, 'recall': 0.3916380097891399, 'f1-score': 0.4014863736956005, 'support': 538556}}
[[93543 67003 59325]
 [34754 39077 27534]
 [68335 70686 78299]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0979235
{'0': {'precision': 0.47032232704402516, 'recall': 0.40565815620202855, 'f1-score': 0.43560351322515883, 'support': 212366}, '1': {'precision': 0.22207758138521924, 'recall': 0.38354747433299996, 'f1-score': 0.28128722430504177, 'support': 116979}, '2': {'precision': 0.45828958951452514, 'recall': 0.33593357901831167, 'f1-score': 0.3876866556709675, 'support': 209211}, 'accuracy': 0.37376985865908097, 'macro avg': {'precision': 0.38356316598125656, 'recall': 0.37504640318444676, 'f1-score': 0.36819246440038933, 'support': 538556}, 'weighted avg': {'precision': 0.4117271147472432, 'recall': 0.37376985865908097, 'f1-score': 0.3834705895415376, 'support': 538556}}
[[86148 76202 50016]
 [39054 44867 33058]
 [57966 80964 70281]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1011834
{'0': {'precision': 0.48058201058201055, 'recall': 0.3431366993445534, 'f1-score': 0.4003923254096825, 'support': 211764}, '1': {'precision': 0.2168325710362113, 'recall': 0.4924542611481794, 'f1-score': 0.30109151535676143, 'support': 117351}, '2': {'precision': 0.47095674338158017, 'recall': 0.27171852693598675, 'f1-score': 0.34461272019329175, 'support': 209441}, 'accuracy': 0.34789882574885433, 'macro avg': {'precision': 0.38945710833326735, 'recall': 0.3691031624762398, 'f1-score': 0.3486988536532452, 'support': 538556}, 'weighted avg': {'precision': 0.4193679751467644, 'recall': 0.34789882574885433, 'f1-score': 0.3570624104952698, 'support': 538556}}
[[ 72664 101773  37327]
 [ 32960  57790  26601]
 [ 45576 106956  56909]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1116544
{'0': {'precision': 0.49014724821176436, 'recall': 0.2857201002161703, 'f1-score': 0.36100222844408897, 'support': 221122}, '1': {'precision': 0.1824629166272481, 'recall': 0.5765472312703583, 'f1-score': 0.2771991644178803, 'support': 97012}, '2': {'precision': 0.48753382014953595, 'recall': 0.228080681601655, 'f1-score': 0.31077359592756404, 'support': 220422}, 'accuracy': 0.31451696759482767, 'macro avg': {'precision': 0.38671466166284946, 'recall': 0.3634493376960612, 'f1-score': 0.3163249962631777, 'support': 538556}, 'weighted avg': {'precision': 0.4336533470835444, 'recall': 0.31451696759482767, 'f1-score': 0.32534874304263023, 'support': 538556}}
[[ 63179 123476  34467]
 [ 22702  55932  18378]
 [ 43017 127131  50274]]
Evaluating performance on  train set...
428/428 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0779282
{'0': {'precision': 0.41641649549691895, 'recall': 0.4374515879163439, 'f1-score': 0.42667494131297057, 'support': 36148}, '1': {'precision': 0.3895915739122436, 'recall': 0.46773792760705707, 'f1-score': 0.42510319561371596, 'support': 36219}, '2': {'precision': 0.4256108435883717, 'recall': 0.32139201637666326, 'f1-score': 0.3662313346940655, 'support': 37126}, 'accuracy': 0.4081174138986054, 'macro avg': {'precision': 0.4105396376658447, 'recall': 0.40886051063335477, 'f1-score': 0.4060031572069174, 'support': 109493}, 'weighted avg': {'precision': 0.41066067121927485, 'recall': 0.4081174138986054, 'f1-score': 0.4056602974835498, 'support': 109493}}
[[15813 12430  7905]
 [11080 16941  8198]
 [11081 14113 11932]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0835412
{'0': {'precision': 0.4140892506314903, 'recall': 0.4053296703296703, 'f1-score': 0.40966264056643065, 'support': 36400}, '1': {'precision': 0.35618313537191476, 'recall': 0.4688288288288288, 'f1-score': 0.4048157589248315, 'support': 36075}, '2': {'precision': 0.42226771295348575, 'recall': 0.30090766654060186, 'f1-score': 0.3514046405981356, 'support': 37018}, 'accuracy': 0.39094736649831496, 'macro avg': {'precision': 0.3975133663189636, 'recall': 0.39168872189970033, 'f1-score': 0.3886276800297992, 'support': 109493}, 'weighted avg': {'precision': 0.3977757621915575, 'recall': 0.39094736649831496, 'f1-score': 0.388369536002239, 'support': 109493}}
[[14754 14541  7105]
 [11027 16913  8135]
 [ 9849 16030 11139]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0853335
{'0': {'precision': 0.4177997112834458, 'recall': 0.3441077254880274, 'f1-score': 0.37738995951662546, 'support': 36166}, '1': {'precision': 0.34169610083800817, 'recall': 0.5438287084240403, 'f1-score': 0.4196927003030464, 'support': 36289}, '2': {'precision': 0.43211845102505697, 'recall': 0.25608834170311573, 'f1-score': 0.321590832033634, 'support': 37038}, 'accuracy': 0.3805266090069685, 'macro avg': {'precision': 0.39720475438217023, 'recall': 0.3813415918717278, 'f1-score': 0.37289116395110194, 'support': 109493}, 'weighted avg': {'precision': 0.3974204501717337, 'recall': 0.3805266090069685, 'f1-score': 0.3725351841125667, 'support': 109493}}
[[12445 18271  5450]
 [ 9539 19735  7015]
 [ 7803 19750  9485]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0882922
{'0': {'precision': 0.4123564873478478, 'recall': 0.2940419473194239, 'f1-score': 0.3432909773835211, 'support': 36522}, '1': {'precision': 0.3385759896824523, 'recall': 0.5931610272236305, 'f1-score': 0.43108748110099826, 'support': 36292}, '2': {'precision': 0.4284563893502441, 'recall': 0.23209465906922216, 'f1-score': 0.3010893400297093, 'support': 36679}, 'accuracy': 0.3724347675193848, 'macro avg': {'precision': 0.39312962212684804, 'recall': 0.37309921120409223, 'f1-score': 0.3584892661714096, 'support': 109493}, 'weighted avg': {'precision': 0.3932948713931599, 'recall': 0.3724347675193848, 'f1-score': 0.35825446232241415, 'support': 109493}}
[[10739 20654  5129]
 [ 8538 21527  6227]
 [ 6766 21400  8513]]
Evaluating performance on  val set...
141/141 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0866956
{'0': {'precision': 0.40792712949286064, 'recall': 0.41113224712596147, 'f1-score': 0.4095234172261812, 'support': 12091}, '1': {'precision': 0.367189063021007, 'recall': 0.4851956291857596, 'f1-score': 0.4180237634286148, 'support': 11348}, '2': {'precision': 0.40941365093907467, 'recall': 0.2865961199294533, 'f1-score': 0.3371687258323116, 'support': 12474}, 'accuracy': 0.391278924066494, 'macro avg': {'precision': 0.3948432811509808, 'recall': 0.39430799874705813, 'f1-score': 0.3882386354957026, 'support': 35913}, 'weighted avg': {'precision': 0.3955708042122514, 'recall': 0.391278924066494, 'f1-score': 0.3870777710328275, 'support': 35913}}
[[4971 4502 2618]
 [3303 5506 2539]
 [3912 4987 3575]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0908184
{'0': {'precision': 0.39965111208024423, 'recall': 0.3852038671710803, 'f1-score': 0.39229452054794517, 'support': 11895}, '1': {'precision': 0.34142146323484246, 'recall': 0.47650891632373116, 'f1-score': 0.39780982714812296, 'support': 11664}, '2': {'precision': 0.4048231117639858, 'recall': 0.2676865792455885, 'f1-score': 0.3222725722360279, 'support': 12354}, 'accuracy': 0.3744326566981316, 'macro avg': {'precision': 0.3819652290263575, 'recall': 0.3764664542468, 'f1-score': 0.370792306644032, 'support': 35913}, 'weighted avg': {'precision': 0.3825181591094586, 'recall': 0.3744326566981316, 'f1-score': 0.36999839899694825, 'support': 35913}}
[[4582 5089 2224]
 [3468 5558 2638]
 [3415 5632 3307]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0919148
{'0': {'precision': 0.40392604902368096, 'recall': 0.3255483006864222, 'f1-score': 0.36052655974784464, 'support': 11946}, '1': {'precision': 0.3301814464605162, 'recall': 0.5597920277296361, 'f1-score': 0.4153673042919145, 'support': 11540}, '2': {'precision': 0.42083333333333334, 'recall': 0.22756900297738794, 'f1-score': 0.2953987569854285, 'support': 12427}, 'accuracy': 0.3669144877899368, 'macro avg': {'precision': 0.38498027627251014, 'recall': 0.3709697771311488, 'f1-score': 0.3570975403417292, 'support': 35913}, 'weighted avg': {'precision': 0.3860799795930327, 'recall': 0.3669144877899368, 'f1-score': 0.35561243358489586, 'support': 35913}}
[[3889 6293 1764]
 [2952 6460 2128]
 [2787 6812 2828]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0934585
{'0': {'precision': 0.4117647058823529, 'recall': 0.29263245033112584, 'f1-score': 0.3421243648681345, 'support': 12080}, '1': {'precision': 0.31869688385269124, 'recall': 0.5972922750199098, 'f1-score': 0.41562759767248547, 'support': 11301}, '2': {'precision': 0.4194860117111256, 'recall': 0.20579316948611553, 'f1-score': 0.27612419700214136, 'support': 12532}, 'accuracy': 0.3581989808704369, 'macro avg': {'precision': 0.3833158671487233, 'recall': 0.3652392982790504, 'f1-score': 0.34462538651425373, 'support': 35913}, 'weighted avg': {'precision': 0.3851727739326125, 'recall': 0.3581989808704369, 'f1-score': 0.34222310154358193, 'support': 35913}}
[[3535 6934 1611]
 [2593 6750 1958]
 [2457 7496 2579]]
training model: results/PCAR/W10/deepLOB_L2/seq2seq
Epoch 1/50
428/428 - 30s - loss: 13.1423 - accuracy10: 0.3830 - accuracy20: 0.3775 - accuracy30: 0.3742 - accuracy50: 0.3781 - val_loss: 13.2935 - val_accuracy10: 0.3392 - val_accuracy20: 0.3494 - val_accuracy30: 0.3507 - val_accuracy50: 0.3429 - 30s/epoch - 70ms/step
Epoch 2/50
428/428 - 22s - loss: 12.9531 - accuracy10: 0.4145 - accuracy20: 0.4056 - accuracy30: 0.3959 - accuracy50: 0.3918 - val_loss: 13.0990 - val_accuracy10: 0.4014 - val_accuracy20: 0.3870 - val_accuracy30: 0.3800 - val_accuracy50: 0.3629 - 22s/epoch - 52ms/step
Epoch 3/50
428/428 - 22s - loss: 12.8106 - accuracy10: 0.4387 - accuracy20: 0.4256 - accuracy30: 0.4123 - accuracy50: 0.4059 - val_loss: 13.1411 - val_accuracy10: 0.4039 - val_accuracy20: 0.3898 - val_accuracy30: 0.3809 - val_accuracy50: 0.3689 - 22s/epoch - 52ms/step
Epoch 4/50
428/428 - 23s - loss: 12.7219 - accuracy10: 0.4521 - accuracy20: 0.4360 - accuracy30: 0.4230 - accuracy50: 0.4159 - val_loss: 13.2256 - val_accuracy10: 0.4010 - val_accuracy20: 0.3833 - val_accuracy30: 0.3706 - val_accuracy50: 0.3564 - 23s/epoch - 53ms/step
Epoch 5/50
428/428 - 22s - loss: 12.6722 - accuracy10: 0.4586 - accuracy20: 0.4416 - accuracy30: 0.4292 - accuracy50: 0.4227 - val_loss: 13.2813 - val_accuracy10: 0.3895 - val_accuracy20: 0.3741 - val_accuracy30: 0.3634 - val_accuracy50: 0.3508 - 22s/epoch - 52ms/step
Epoch 6/50
428/428 - 22s - loss: 12.6320 - accuracy10: 0.4640 - accuracy20: 0.4458 - accuracy30: 0.4320 - accuracy50: 0.4256 - val_loss: 13.3075 - val_accuracy10: 0.3869 - val_accuracy20: 0.3730 - val_accuracy30: 0.3654 - val_accuracy50: 0.3546 - 22s/epoch - 52ms/step
Epoch 7/50
428/428 - 22s - loss: 12.6042 - accuracy10: 0.4657 - accuracy20: 0.4479 - accuracy30: 0.4352 - accuracy50: 0.4304 - val_loss: 13.5130 - val_accuracy10: 0.3787 - val_accuracy20: 0.3692 - val_accuracy30: 0.3622 - val_accuracy50: 0.3491 - 22s/epoch - 52ms/step
Epoch 8/50
428/428 - 22s - loss: 12.5677 - accuracy10: 0.4683 - accuracy20: 0.4513 - accuracy30: 0.4372 - accuracy50: 0.4341 - val_loss: 13.4412 - val_accuracy10: 0.3824 - val_accuracy20: 0.3715 - val_accuracy30: 0.3642 - val_accuracy50: 0.3515 - 22s/epoch - 52ms/step
Epoch 9/50
428/428 - 22s - loss: 12.5400 - accuracy10: 0.4725 - accuracy20: 0.4548 - accuracy30: 0.4390 - accuracy50: 0.4334 - val_loss: 13.4614 - val_accuracy10: 0.3822 - val_accuracy20: 0.3714 - val_accuracy30: 0.3634 - val_accuracy50: 0.3510 - 22s/epoch - 52ms/step
Epoch 10/50
428/428 - 22s - loss: 12.5129 - accuracy10: 0.4735 - accuracy20: 0.4557 - accuracy30: 0.4424 - accuracy50: 0.4364 - val_loss: 13.6201 - val_accuracy10: 0.3709 - val_accuracy20: 0.3652 - val_accuracy30: 0.3595 - val_accuracy50: 0.3493 - 22s/epoch - 52ms/step
Epoch 11/50
428/428 - 22s - loss: 12.4977 - accuracy10: 0.4741 - accuracy20: 0.4569 - accuracy30: 0.4432 - accuracy50: 0.4374 - val_loss: 13.4241 - val_accuracy10: 0.3855 - val_accuracy20: 0.3727 - val_accuracy30: 0.3666 - val_accuracy50: 0.3511 - 22s/epoch - 52ms/step
Epoch 12/50
428/428 - 22s - loss: 12.4745 - accuracy10: 0.4766 - accuracy20: 0.4599 - accuracy30: 0.4465 - accuracy50: 0.4403 - val_loss: 13.3805 - val_accuracy10: 0.3851 - val_accuracy20: 0.3740 - val_accuracy30: 0.3674 - val_accuracy50: 0.3531 - 22s/epoch - 52ms/step
testing model: results/PCAR/W10/deepLOB_L2/seq2seq
Evaluating performance on  test set...
2104/2104 - 43s - 43s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1205662
{'0': {'precision': 0.4785722097822395, 'recall': 0.3781211057241875, 'f1-score': 0.4224574882430506, 'support': 219874}, '1': {'precision': 0.20484423369746632, 'recall': 0.4419474177477433, 'f1-score': 0.279936761461985, 'support': 101365}, '2': {'precision': 0.4928529884703548, 'recall': 0.3314344613062644, 'f1-score': 0.3963385947004817, 'support': 217322}, 'accuracy': 0.3712949879400848, 'macro avg': {'precision': 0.3920898106500202, 'recall': 0.3838343282593984, 'f1-score': 0.3662442814685058, 'support': 538561}, 'weighted avg': {'precision': 0.43281525948362076, 'recall': 0.3712949879400848, 'f1-score': 0.3850934317060551, 'support': 538561}}
[[83139 89834 46901]
 [29351 44798 27216]
 [61233 84061 72028]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1200106
{'0': {'precision': 0.45618812617058596, 'recall': 0.3612785353725608, 'f1-score': 0.4032237296776008, 'support': 212368}, '1': {'precision': 0.23254412687979034, 'recall': 0.47178150111130107, 'f1-score': 0.3115320894026931, 'support': 116980}, '2': {'precision': 0.4691279152793332, 'recall': 0.2983418812406495, 'f1-score': 0.36473228111797396, 'support': 209213}, 'accuracy': 0.36083192061809155, 'macro avg': {'precision': 0.38595338944323654, 'recall': 0.3771339725748371, 'f1-score': 0.35982936673275595, 'support': 538561}, 'weighted avg': {'precision': 0.41263743657696716, 'recall': 0.36083192061809155, 'f1-score': 0.368354885652757, 'support': 538561}}
[[76724 93273 42371]
 [33530 55189 28261]
 [57931 88865 62417]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1253198
{'0': {'precision': 0.4476282808567466, 'recall': 0.32922659917078284, 'f1-score': 0.3794045461718882, 'support': 211766}, '1': {'precision': 0.22989793616134424, 'recall': 0.5122963392187606, 'f1-score': 0.31737208166712855, 'support': 117352}, '2': {'precision': 0.4621782929121395, 'recall': 0.2676861962443242, 'f1-score': 0.3390184097306416, 'support': 209443}, 'accuracy': 0.3451846680320335, 'macro avg': {'precision': 0.3799015033100768, 'recall': 0.36973637821128924, 'f1-score': 0.34526501252321945, 'support': 538561}, 'weighted avg': {'precision': 0.4058434259642141, 'recall': 0.3451846680320335, 'f1-score': 0.3501818075234778, 'support': 538561}}
[[ 69719 102601  39446]
 [ 31438  60119  25795]
 [ 54595  98783  56065]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1412461
{'0': {'precision': 0.44966921119592873, 'recall': 0.2797163582424341, 'f1-score': 0.3448925765458327, 'support': 221124}, '1': {'precision': 0.18748095198514947, 'recall': 0.5580134416360862, 'f1-score': 0.2806644614730555, 'support': 97012}, '2': {'precision': 0.46900692100082836, 'recall': 0.23887490075989565, 'f1-score': 0.3165330095102978, 'support': 220425}, 'accuracy': 0.3131307317091286, 'macro avg': {'precision': 0.36871902806063556, 'recall': 0.35886823354613867, 'f1-score': 0.314030015843062, 'support': 538561}, 'weighted avg': {'precision': 0.4103553865431761, 'recall': 0.3131307317091286, 'f1-score': 0.3217158974635226, 'support': 538561}}
[[ 61852 119160  40112]
 [ 23377  54134  19501]
 [ 52321 115450  52654]]
Evaluating performance on  train set...
428/428 - 9s - 9s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0767648
{'0': {'precision': 0.430939226519337, 'recall': 0.3398880277999945, 'f1-score': 0.3800360793746242, 'support': 36259}, '1': {'precision': 0.38460594371876916, 'recall': 0.6065700696825572, 'f1-score': 0.4707346645350272, 'support': 36164}, '2': {'precision': 0.4527890700305939, 'recall': 0.29144074883331983, 'f1-score': 0.35462482767675435, 'support': 37071}, 'accuracy': 0.41156593055327234, 'macro avg': {'precision': 0.4227780800895667, 'recall': 0.41263294877195716, 'f1-score': 0.40179852386213527, 'support': 109494}, 'weighted avg': {'precision': 0.42303375872754995, 'recall': 0.41156593055327234, 'f1-score': 0.40138887607626156, 'support': 109494}}
[[12324 17745  6190]
 [ 7361 21936  6867]
 [ 8913 17354 10804]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0838224
{'0': {'precision': 0.4195310224293621, 'recall': 0.3174192126504862, 'f1-score': 0.3614008123833571, 'support': 36299}, '1': {'precision': 0.3724308300395257, 'recall': 0.6252315518814454, 'f1-score': 0.4668022169699347, 'support': 36169}, '2': {'precision': 0.45138432660722666, 'recall': 0.2597904175444282, 'f1-score': 0.32977921009325284, 'support': 37026}, 'accuracy': 0.3996109375856211, 'macro avg': {'precision': 0.41444872635870483, 'recall': 0.4008137273587866, 'f1-score': 0.38599407981551487, 'support': 109494}, 'weighted avg': {'precision': 0.41474385219119037, 'recall': 0.3996109375856211, 'f1-score': 0.3855248918406655, 'support': 109494}}
[[11522 19110  5667]
 [ 7531 22614  6024]
 [ 8411 18996  9619]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0892308
{'0': {'precision': 0.4105346534653465, 'recall': 0.28655940730911705, 'f1-score': 0.3375227923938526, 'support': 36174}, '1': {'precision': 0.36405996137457464, 'recall': 0.6540547982927165, 'f1-score': 0.46775702314956136, 'support': 36315}, '2': {'precision': 0.43853278602252393, 'recall': 0.22518578570463452, 'f1-score': 0.29756994661381614, 'support': 37005}, 'accuracy': 0.38770160922059654, 'macro avg': {'precision': 0.4043758002874817, 'recall': 0.38859999710215604, 'f1-score': 0.3676165873857434, 'support': 109494}, 'weighted avg': {'precision': 0.40458311686975196, 'recall': 0.38770160922059654, 'f1-score': 0.3672139264450638, 'support': 109494}}
[[10366 20606  5202]
 [ 7096 23752  5467]
 [ 7788 20884  8333]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0920454
{'0': {'precision': 0.4154267296569385, 'recall': 0.2573788877643133, 'f1-score': 0.3178394081680911, 'support': 36557}, '1': {'precision': 0.3639574449756644, 'recall': 0.6999282124910265, 'f1-score': 0.47889372715336886, 'support': 36218}, '2': {'precision': 0.42840525764801674, 'recall': 0.20060459162831232, 'f1-score': 0.27325505907666053, 'support': 36719}, 'accuracy': 0.38472427712934043, 'macro avg': {'precision': 0.40259647742687327, 'recall': 0.38597056396121737, 'f1-score': 0.35666273146604016, 'support': 109494}, 'weighted avg': {'precision': 0.40275429113718414, 'recall': 0.38472427712934043, 'f1-score': 0.3561608925482448, 'support': 109494}}
[[ 9409 22157  4991]
 [ 6031 25350  4837]
 [ 7209 22144  7366]]
Evaluating performance on  val set...
141/141 - 3s - 3s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0832227
{'0': {'precision': 0.41217501585288524, 'recall': 0.4809668667269588, 'f1-score': 0.4439216876612536, 'support': 12163}, '1': {'precision': 0.37064095804775177, 'recall': 0.4347173144876325, 'f1-score': 0.40013009716632114, 'support': 11320}, '2': {'precision': 0.4513798412886415, 'recall': 0.30659694288012873, 'f1-score': 0.36516073396253534, 'support': 12430}, 'accuracy': 0.4060368111825801, 'macro avg': {'precision': 0.41139860506309284, 'recall': 0.40742704136490665, 'f1-score': 0.40307083959670337, 'support': 35913}, 'weighted avg': {'precision': 0.4126525712175816, 'recall': 0.4060368111825801, 'f1-score': 0.4028580210536824, 'support': 35913}}
[[5850 4177 2136]
 [3903 4921 2496]
 [4440 4179 3811]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0904747
{'0': {'precision': 0.39096462565705353, 'recall': 0.4630268360393707, 'f1-score': 0.42395532447525514, 'support': 11887}, '1': {'precision': 0.3573171581956355, 'recall': 0.44010304851867754, 'f1-score': 0.3944128059104202, 'support': 11645}, '2': {'precision': 0.44767752269087024, 'recall': 0.27089895808093045, 'f1-score': 0.3375434005937704, 'support': 12381}, 'accuracy': 0.3893576142343998, 'macro avg': {'precision': 0.3986531021811864, 'recall': 0.3913429475463262, 'f1-score': 0.3853038436598153, 'support': 35913}, 'weighted avg': {'precision': 0.3996059984075192, 'recall': 0.3893576142343998, 'f1-score': 0.3845854957707703, 'support': 35913}}
[[5504 4551 1832]
 [4214 5125 2306]
 [4360 4667 3354]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0941163
{'0': {'precision': 0.38226527570789864, 'recall': 0.43022475679302247, 'f1-score': 0.40482954545454547, 'support': 11924}, '1': {'precision': 0.3495524296675192, 'recall': 0.47333333333333333, 'f1-score': 0.4021331371827878, 'support': 11550}, '2': {'precision': 0.4447687144316358, 'recall': 0.24503577457995016, 'f1-score': 0.31598590089156126, 'support': 12439}, 'accuracy': 0.37994598056414114, 'macro avg': {'precision': 0.3921954732690178, 'recall': 0.3828646215687686, 'f1-score': 0.37431619450963155, 'support': 35913}, 'weighted avg': {'precision': 0.39339347169593036, 'recall': 0.37994598056414114, 'f1-score': 0.3731900385835583, 'support': 35913}}
[[5130 5026 1768]
 [4046 5467 2037]
 [4244 5147 3048]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1016788
{'0': {'precision': 0.37983179686236457, 'recall': 0.38969551149091514, 'f1-score': 0.38470043818338184, 'support': 12053}, '1': {'precision': 0.3343872592072135, 'recall': 0.5050853453612806, 'f1-score': 0.40238145564714994, 'support': 11307}, '2': {'precision': 0.4231601731601732, 'recall': 0.21803552935553255, 'f1-score': 0.2877871825876662, 'support': 12553}, 'accuracy': 0.36602344554896554, 'macro avg': {'precision': 0.37912640974325046, 'recall': 0.37093879540257607, 'f1-score': 0.3582896921393994, 'support': 35913}, 'weighted avg': {'precision': 0.3806688118819842, 'recall': 0.36602344554896554, 'f1-score': 0.3563922257525019, 'support': 35913}}
[[4697 5625 1731]
 [3596 5711 2000]
 [4073 5743 2737]]
training model: results/PCAR/W10/deepOF_L2/seq2seq
Epoch 1/50
428/428 - 23s - loss: 13.1521 - accuracy10: 0.3868 - accuracy20: 0.3760 - accuracy30: 0.3682 - accuracy50: 0.3670 - val_loss: 13.1134 - val_accuracy10: 0.3999 - val_accuracy20: 0.3829 - val_accuracy30: 0.3695 - val_accuracy50: 0.3614 - 23s/epoch - 55ms/step
Epoch 2/50
428/428 - 15s - loss: 12.9203 - accuracy10: 0.4261 - accuracy20: 0.4071 - accuracy30: 0.3943 - accuracy50: 0.3878 - val_loss: 12.9697 - val_accuracy10: 0.4286 - val_accuracy20: 0.4037 - val_accuracy30: 0.3870 - val_accuracy50: 0.3774 - 15s/epoch - 36ms/step
Epoch 3/50
428/428 - 15s - loss: 12.8283 - accuracy10: 0.4421 - accuracy20: 0.4202 - accuracy30: 0.4081 - accuracy50: 0.3980 - val_loss: 12.9122 - val_accuracy10: 0.4367 - val_accuracy20: 0.4117 - val_accuracy30: 0.3975 - val_accuracy50: 0.3845 - 15s/epoch - 36ms/step
Epoch 4/50
428/428 - 15s - loss: 12.7565 - accuracy10: 0.4529 - accuracy20: 0.4313 - accuracy30: 0.4172 - accuracy50: 0.4062 - val_loss: 12.8531 - val_accuracy10: 0.4455 - val_accuracy20: 0.4153 - val_accuracy30: 0.4030 - val_accuracy50: 0.3902 - 15s/epoch - 36ms/step
Epoch 5/50
428/428 - 15s - loss: 12.7024 - accuracy10: 0.4608 - accuracy20: 0.4368 - accuracy30: 0.4221 - accuracy50: 0.4108 - val_loss: 12.8297 - val_accuracy10: 0.4498 - val_accuracy20: 0.4197 - val_accuracy30: 0.4036 - val_accuracy50: 0.3936 - 15s/epoch - 36ms/step
Epoch 6/50
428/428 - 15s - loss: 12.6501 - accuracy10: 0.4641 - accuracy20: 0.4405 - accuracy30: 0.4254 - accuracy50: 0.4151 - val_loss: 12.7944 - val_accuracy10: 0.4557 - val_accuracy20: 0.4256 - val_accuracy30: 0.4100 - val_accuracy50: 0.3994 - 15s/epoch - 34ms/step
Epoch 7/50
428/428 - 15s - loss: 12.6031 - accuracy10: 0.4713 - accuracy20: 0.4464 - accuracy30: 0.4303 - accuracy50: 0.4194 - val_loss: 12.7943 - val_accuracy10: 0.4554 - val_accuracy20: 0.4263 - val_accuracy30: 0.4107 - val_accuracy50: 0.4003 - 15s/epoch - 34ms/step
Epoch 8/50
428/428 - 15s - loss: 12.5566 - accuracy10: 0.4754 - accuracy20: 0.4503 - accuracy30: 0.4332 - accuracy50: 0.4243 - val_loss: 12.7734 - val_accuracy10: 0.4602 - val_accuracy20: 0.4307 - val_accuracy30: 0.4161 - val_accuracy50: 0.4008 - 15s/epoch - 35ms/step
Epoch 9/50
428/428 - 15s - loss: 12.5174 - accuracy10: 0.4789 - accuracy20: 0.4537 - accuracy30: 0.4384 - accuracy50: 0.4259 - val_loss: 12.7812 - val_accuracy10: 0.4583 - val_accuracy20: 0.4282 - val_accuracy30: 0.4136 - val_accuracy50: 0.4027 - 15s/epoch - 34ms/step
Epoch 10/50
428/428 - 15s - loss: 12.4800 - accuracy10: 0.4817 - accuracy20: 0.4590 - accuracy30: 0.4416 - accuracy50: 0.4311 - val_loss: 12.7890 - val_accuracy10: 0.4614 - val_accuracy20: 0.4281 - val_accuracy30: 0.4140 - val_accuracy50: 0.4036 - 15s/epoch - 35ms/step
Epoch 11/50
428/428 - 15s - loss: 12.4417 - accuracy10: 0.4849 - accuracy20: 0.4623 - accuracy30: 0.4467 - accuracy50: 0.4362 - val_loss: 12.8081 - val_accuracy10: 0.4601 - val_accuracy20: 0.4283 - val_accuracy30: 0.4131 - val_accuracy50: 0.4027 - 15s/epoch - 35ms/step
Epoch 12/50
428/428 - 15s - loss: 12.4032 - accuracy10: 0.4896 - accuracy20: 0.4657 - accuracy30: 0.4515 - accuracy50: 0.4401 - val_loss: 12.7950 - val_accuracy10: 0.4630 - val_accuracy20: 0.4333 - val_accuracy30: 0.4175 - val_accuracy50: 0.4043 - 15s/epoch - 35ms/step
Epoch 13/50
428/428 - 15s - loss: 12.3705 - accuracy10: 0.4909 - accuracy20: 0.4692 - accuracy30: 0.4534 - accuracy50: 0.4423 - val_loss: 12.8087 - val_accuracy10: 0.4597 - val_accuracy20: 0.4304 - val_accuracy30: 0.4161 - val_accuracy50: 0.4042 - 15s/epoch - 35ms/step
Epoch 14/50
428/428 - 15s - loss: 12.3401 - accuracy10: 0.4933 - accuracy20: 0.4725 - accuracy30: 0.4569 - accuracy50: 0.4440 - val_loss: 12.8320 - val_accuracy10: 0.4573 - val_accuracy20: 0.4258 - val_accuracy30: 0.4124 - val_accuracy50: 0.4005 - 15s/epoch - 34ms/step
Epoch 15/50
428/428 - 15s - loss: 12.3049 - accuracy10: 0.4944 - accuracy20: 0.4748 - accuracy30: 0.4607 - accuracy50: 0.4483 - val_loss: 12.8496 - val_accuracy10: 0.4586 - val_accuracy20: 0.4295 - val_accuracy30: 0.4155 - val_accuracy50: 0.4015 - 15s/epoch - 34ms/step
Epoch 16/50
428/428 - 15s - loss: 12.2732 - accuracy10: 0.4977 - accuracy20: 0.4788 - accuracy30: 0.4634 - accuracy50: 0.4508 - val_loss: 12.8571 - val_accuracy10: 0.4554 - val_accuracy20: 0.4258 - val_accuracy30: 0.4127 - val_accuracy50: 0.4005 - 15s/epoch - 34ms/step
Epoch 17/50
428/428 - 15s - loss: 12.2330 - accuracy10: 0.4988 - accuracy20: 0.4812 - accuracy30: 0.4676 - accuracy50: 0.4550 - val_loss: 12.9321 - val_accuracy10: 0.4531 - val_accuracy20: 0.4225 - val_accuracy30: 0.4071 - val_accuracy50: 0.3991 - 15s/epoch - 34ms/step
Epoch 18/50
428/428 - 14s - loss: 12.2004 - accuracy10: 0.5020 - accuracy20: 0.4846 - accuracy30: 0.4717 - accuracy50: 0.4597 - val_loss: 12.9408 - val_accuracy10: 0.4516 - val_accuracy20: 0.4221 - val_accuracy30: 0.4099 - val_accuracy50: 0.3983 - 14s/epoch - 34ms/step
testing model: results/PCAR/W10/deepOF_L2/seq2seq
Evaluating performance on  test set...
2104/2104 - 33s - 33s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0395564
{'0': {'precision': 0.5077413660816846, 'recall': 0.5206871301808788, 'f1-score': 0.5141327680824883, 'support': 219871}, '1': {'precision': 0.28789635324506274, 'recall': 0.27928772258669166, 'f1-score': 0.2835267076950811, 'support': 101365}, '2': {'precision': 0.5047521478963422, 'recall': 0.498771397018222, 'f1-score': 0.501743950562994, 'support': 217320}, 'accuracy': 0.46640832151159767, 'macro avg': {'precision': 0.4334632890743632, 'recall': 0.43291541659526417, 'f1-score': 0.4331344754468545, 'support': 538556}, 'weighted avg': {'precision': 0.4651567386293439, 'recall': 0.46640832151159767, 'f1-score': 0.4657297772430844, 'support': 538556}}
[[114484  34622  70765]
 [ 37468  28310  35587]
 [ 73525  35402 108393]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0666797
{'0': {'precision': 0.4753833343667786, 'recall': 0.5054151794543382, 'f1-score': 0.48993947250700676, 'support': 212366}, '1': {'precision': 0.26381507713397373, 'recall': 0.22703220236110755, 'f1-score': 0.24404543115489233, 'support': 116979}, '2': {'precision': 0.47124301643054145, 'recall': 0.4777616855710264, 'f1-score': 0.47447996278327903, 'support': 209211}, 'accuracy': 0.4342055422277349, 'macro avg': {'precision': 0.40348047597709796, 'recall': 0.4034030224621574, 'f1-score': 0.4028216221483927, 'support': 538556}, 'weighted avg': {'precision': 0.42782051226732304, 'recall': 0.4342055422277349, 'f1-score': 0.4305236669971994, 'support': 538556}}
[[107333  36896  68137]
 [ 46406  26558  44015]
 [ 72043  37215  99953]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0775255
{'0': {'precision': 0.4652640186181086, 'recall': 0.48902551897395213, 'f1-score': 0.47684894196522104, 'support': 211764}, '1': {'precision': 0.2478489155235451, 'recall': 0.2304880231101567, 'f1-score': 0.23885341881474023, 'support': 117351}, '2': {'precision': 0.4636444504607292, 'recall': 0.4578998381405742, 'f1-score': 0.4607542392628163, 'support': 209441}, 'accuracy': 0.42058578866450286, 'macro avg': {'precision': 0.3922524615341277, 'recall': 0.392471126741561, 'f1-score': 0.3921522000142592, 'support': 538556}, 'weighted avg': {'precision': 0.41725957017133647, 'recall': 0.42058578866450286, 'f1-score': 0.4187307457777745, 'support': 538556}}
[[103558  40846  67360]
 [ 46720  27048  43583]
 [ 72301  41237  95903]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0888377
{'0': {'precision': 0.470727488771339, 'recall': 0.46401533994808297, 'f1-score': 0.4673473152490031, 'support': 221122}, '1': {'precision': 0.2002120345680599, 'recall': 0.25695790211520225, 'f1-score': 0.22506319971108707, 'support': 97012}, '2': {'precision': 0.47399772540659635, 'recall': 0.42165028899111706, 'f1-score': 0.44629424659244515, 'support': 220422}, 'accuracy': 0.40937804053803134, 'macro avg': {'precision': 0.38164574958199843, 'recall': 0.38087451035146747, 'f1-score': 0.3795682538508451, 'support': 538556}, 'weighted avg': {'precision': 0.42333703514432186, 'recall': 0.40937804053803134, 'f1-score': 0.41508714895992616, 'support': 538556}}
[[102604  49704  68814]
 [ 37760  24928  34324]
 [ 77605  49876  92941]]
Evaluating performance on  train set...
428/428 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0216463
{'0': {'precision': 0.47756377420346274, 'recall': 0.5158238353435874, 'f1-score': 0.4959570167039047, 'support': 36148}, '1': {'precision': 0.4622876493800901, 'recall': 0.4560589745713576, 'f1-score': 0.45915218902015287, 'support': 36219}, '2': {'precision': 0.4921078403133821, 'recall': 0.4601896245218984, 'f1-score': 0.475613829964924, 'support': 37126}, 'accuracy': 0.47719032266902905, 'macro avg': {'precision': 0.47731975463231163, 'recall': 0.47735747814561447, 'f1-score': 0.4769076785629938, 'support': 109493}, 'weighted avg': {'precision': 0.4774420954972361, 'recall': 0.47719032266902905, 'f1-score': 0.4768846083787222, 'support': 109493}}
[[18646  9085  8417]
 [10485 16518  9216]
 [ 9913 10128 17085]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0455441
{'0': {'precision': 0.46058135225287233, 'recall': 0.47796703296703297, 'f1-score': 0.4691131663386092, 'support': 36400}, '1': {'precision': 0.4153575369095781, 'recall': 0.4382813582813583, 'f1-score': 0.426511646727182, 'support': 36075}, '2': {'precision': 0.4724095920125992, 'recall': 0.4294667459073964, 'f1-score': 0.4499158070495677, 'support': 37018}, 'accuracy': 0.4484944243010969, 'macro avg': {'precision': 0.4494494937250166, 'recall': 0.44857171238526256, 'f1-score': 0.44851354003845295, 'support': 109493}, 'weighted avg': {'precision': 0.44968027767199714, 'recall': 0.4484944243010969, 'f1-score': 0.4485867613068357, 'support': 109493}}
[[17398 10740  8262]
 [10771 15811  9493]
 [ 9605 11515 15898]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0580343
{'0': {'precision': 0.4461017137460767, 'recall': 0.44409113532046673, 'f1-score': 0.44509415399963975, 'support': 36166}, '1': {'precision': 0.3899048307432839, 'recall': 0.4459478078756648, 'f1-score': 0.4160475100907525, 'support': 36289}, '2': {'precision': 0.45993434422385493, 'recall': 0.3971866731464982, 'f1-score': 0.42626370919838313, 'support': 37038}, 'accuracy': 0.4288401998301261, 'macro avg': {'precision': 0.43198029623773854, 'recall': 0.42907520544754324, 'f1-score': 0.4291351244295918, 'support': 109493}, 'weighted avg': {'precision': 0.43215565582774046, 'recall': 0.4288401998301261, 'f1-score': 0.4290975544420557, 'support': 109493}}
[[16061 12177  7928]
 [10760 16183  9346]
 [ 9182 13145 14711]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0674096
{'0': {'precision': 0.44110740687056094, 'recall': 0.4166255955314605, 'f1-score': 0.4285171156202036, 'support': 36522}, '1': {'precision': 0.38530810930412657, 'recall': 0.47983026562327785, 'f1-score': 0.42740559843901477, 'support': 36292}, '2': {'precision': 0.44502231318994734, 'recall': 0.36159655388642004, 'f1-score': 0.39899521675039856, 'support': 36679}, 'accuracy': 0.4191409496497493, 'macro avg': {'precision': 0.4238126097882116, 'recall': 0.4193508050137195, 'f1-score': 0.418305976936539, 'support': 109493}, 'weighted avg': {'precision': 0.42392390419557474, 'recall': 0.4191409496497493, 'f1-score': 0.4182591730103081, 'support': 109493}}
[[15216 13522  7784]
 [10122 17414  8756]
 [ 9157 14259 13263]]
Evaluating performance on  val set...
141/141 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0417702
{'0': {'precision': 0.4518626734842951, 'recall': 0.5116202133818543, 'f1-score': 0.4798882898258407, 'support': 12091}, '1': {'precision': 0.44079260741164145, 'recall': 0.4077370461755375, 'f1-score': 0.4236209658960861, 'support': 11348}, '2': {'precision': 0.4797885041787481, 'recall': 0.45101811768478434, 'f1-score': 0.46495867768595034, 'support': 12474}, 'accuracy': 0.45774510622894216, 'macro avg': {'precision': 0.4574812616915615, 'recall': 0.4567917924140587, 'f1-score': 0.4561559778026257, 'support': 35913}, 'weighted avg': {'precision': 0.45806443057198293, 'recall': 0.45774510622894216, 'f1-score': 0.4569229688059357, 'support': 35913}}
[[6186 2869 3036]
 [3657 4627 3064]
 [3847 3001 5626]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0641228
{'0': {'precision': 0.43015685113939034, 'recall': 0.4887767969735183, 'f1-score': 0.457597103616544, 'support': 11895}, '1': {'precision': 0.3993365889615774, 'recall': 0.37157064471879286, 'f1-score': 0.3849535906204201, 'support': 11664}, '2': {'precision': 0.4553014553014553, 'recall': 0.4254492472073822, 'f1-score': 0.4398694451418529, 'support': 12354}, 'accuracy': 0.42892545874752874, 'macro avg': {'precision': 0.42826496513414103, 'recall': 0.4285988962998977, 'f1-score': 0.42747337979293903, 'support': 35913}, 'weighted avg': {'precision': 0.4287965888882874, 'recall': 0.42892545874752874, 'f1-score': 0.4279053087683519, 'support': 35913}}
[[5814 3176 2905]
 [3947 4334 3383]
 [3755 3343 5256]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0733072
{'0': {'precision': 0.41884935654806965, 'recall': 0.4631675874769797, 'f1-score': 0.43989505485768804, 'support': 11946}, '1': {'precision': 0.3756737958615893, 'recall': 0.3744367417677643, 'f1-score': 0.37505424876312826, 'support': 11540}, '2': {'precision': 0.4460316043210428, 'recall': 0.4020278426007886, 'f1-score': 0.42288809886575246, 'support': 12427}, 'accuracy': 0.4134992899507142, 'macro avg': {'precision': 0.41351825224356725, 'recall': 0.41321072394851094, 'f1-score': 0.41261246749552294, 'support': 35913}, 'weighted avg': {'precision': 0.41438155443609775, 'recall': 0.4134992899507142, 'f1-score': 0.4131746933049633, 'support': 35913}}
[[5533 3510 2903]
 [3917 4321 3302]
 [3760 3671 4996]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0809878
{'0': {'precision': 0.41090852179356757, 'recall': 0.43468543046357616, 'f1-score': 0.4224626895691701, 'support': 12080}, '1': {'precision': 0.3621198818740522, 'recall': 0.40146889655782675, 'f1-score': 0.3807805287452791, 'support': 11301}, '2': {'precision': 0.43234323432343236, 'recall': 0.36586338972231086, 'f1-score': 0.39633487487574015, 'support': 12532}, 'accuracy': 0.40021719154623675, 'macro avg': {'precision': 0.4017905459970174, 'recall': 0.4006725722479046, 'f1-score': 0.3998593643967298, 'support': 35913}, 'weighted avg': {'precision': 0.4030355899219284, 'recall': 0.40021719154623675, 'f1-score': 0.40022885020156346, 'support': 35913}}
[[5251 3888 2941]
 [3685 4537 3079]
 [3843 4104 4585]]
training model: results/PCAR/W10/deepVOL_L2/seq2seq
Epoch 1/50
428/428 - 21s - loss: 13.1172 - accuracy10: 0.3910 - accuracy20: 0.3859 - accuracy30: 0.3810 - accuracy50: 0.3823 - val_loss: 13.1435 - val_accuracy10: 0.3663 - val_accuracy20: 0.3634 - val_accuracy30: 0.3572 - val_accuracy50: 0.3460 - 21s/epoch - 50ms/step
Epoch 2/50
428/428 - 14s - loss: 12.9310 - accuracy10: 0.4152 - accuracy20: 0.4081 - accuracy30: 0.3979 - accuracy50: 0.3921 - val_loss: 12.9807 - val_accuracy10: 0.4137 - val_accuracy20: 0.4046 - val_accuracy30: 0.3958 - val_accuracy50: 0.3866 - 14s/epoch - 34ms/step
Epoch 3/50
428/428 - 14s - loss: 12.8036 - accuracy10: 0.4364 - accuracy20: 0.4260 - accuracy30: 0.4151 - accuracy50: 0.4072 - val_loss: 12.9401 - val_accuracy10: 0.4247 - val_accuracy20: 0.4119 - val_accuracy30: 0.4026 - val_accuracy50: 0.3950 - 14s/epoch - 34ms/step
Epoch 4/50
428/428 - 14s - loss: 12.7427 - accuracy10: 0.4470 - accuracy20: 0.4356 - accuracy30: 0.4226 - accuracy50: 0.4145 - val_loss: 12.8222 - val_accuracy10: 0.4394 - val_accuracy20: 0.4254 - val_accuracy30: 0.4189 - val_accuracy50: 0.4117 - 14s/epoch - 34ms/step
Epoch 5/50
428/428 - 15s - loss: 12.6835 - accuracy10: 0.4551 - accuracy20: 0.4448 - accuracy30: 0.4302 - accuracy50: 0.4209 - val_loss: 12.8763 - val_accuracy10: 0.4310 - val_accuracy20: 0.4172 - val_accuracy30: 0.4078 - val_accuracy50: 0.4003 - 15s/epoch - 34ms/step
Epoch 6/50
428/428 - 14s - loss: 12.6467 - accuracy10: 0.4611 - accuracy20: 0.4480 - accuracy30: 0.4320 - accuracy50: 0.4243 - val_loss: 12.8060 - val_accuracy10: 0.4437 - val_accuracy20: 0.4281 - val_accuracy30: 0.4191 - val_accuracy50: 0.4122 - 14s/epoch - 33ms/step
Epoch 7/50
428/428 - 14s - loss: 12.6064 - accuracy10: 0.4655 - accuracy20: 0.4509 - accuracy30: 0.4355 - accuracy50: 0.4274 - val_loss: 12.8047 - val_accuracy10: 0.4474 - val_accuracy20: 0.4305 - val_accuracy30: 0.4195 - val_accuracy50: 0.4097 - 14s/epoch - 33ms/step
Epoch 8/50
428/428 - 14s - loss: 12.5885 - accuracy10: 0.4669 - accuracy20: 0.4530 - accuracy30: 0.4372 - accuracy50: 0.4293 - val_loss: 12.8082 - val_accuracy10: 0.4500 - val_accuracy20: 0.4326 - val_accuracy30: 0.4240 - val_accuracy50: 0.4133 - 14s/epoch - 33ms/step
Epoch 9/50
428/428 - 14s - loss: 12.5688 - accuracy10: 0.4691 - accuracy20: 0.4547 - accuracy30: 0.4383 - accuracy50: 0.4307 - val_loss: 12.7855 - val_accuracy10: 0.4507 - val_accuracy20: 0.4334 - val_accuracy30: 0.4241 - val_accuracy50: 0.4150 - 14s/epoch - 33ms/step
Epoch 10/50
428/428 - 15s - loss: 12.5414 - accuracy10: 0.4714 - accuracy20: 0.4563 - accuracy30: 0.4416 - accuracy50: 0.4306 - val_loss: 12.7847 - val_accuracy10: 0.4521 - val_accuracy20: 0.4334 - val_accuracy30: 0.4205 - val_accuracy50: 0.4123 - 15s/epoch - 34ms/step
Epoch 11/50
428/428 - 14s - loss: 12.5164 - accuracy10: 0.4739 - accuracy20: 0.4576 - accuracy30: 0.4434 - accuracy50: 0.4347 - val_loss: 12.7654 - val_accuracy10: 0.4548 - val_accuracy20: 0.4348 - val_accuracy30: 0.4236 - val_accuracy50: 0.4097 - 14s/epoch - 33ms/step
Epoch 12/50
428/428 - 15s - loss: 12.5005 - accuracy10: 0.4745 - accuracy20: 0.4594 - accuracy30: 0.4440 - accuracy50: 0.4353 - val_loss: 12.7734 - val_accuracy10: 0.4527 - val_accuracy20: 0.4325 - val_accuracy30: 0.4221 - val_accuracy50: 0.4134 - 15s/epoch - 34ms/step
Epoch 13/50
428/428 - 15s - loss: 12.4733 - accuracy10: 0.4775 - accuracy20: 0.4627 - accuracy30: 0.4459 - accuracy50: 0.4369 - val_loss: 12.8011 - val_accuracy10: 0.4550 - val_accuracy20: 0.4328 - val_accuracy30: 0.4227 - val_accuracy50: 0.4130 - 15s/epoch - 35ms/step
Epoch 14/50
428/428 - 15s - loss: 12.4662 - accuracy10: 0.4782 - accuracy20: 0.4628 - accuracy30: 0.4465 - accuracy50: 0.4389 - val_loss: 12.8277 - val_accuracy10: 0.4554 - val_accuracy20: 0.4332 - val_accuracy30: 0.4218 - val_accuracy50: 0.4108 - 15s/epoch - 34ms/step
Epoch 15/50
428/428 - 14s - loss: 12.4456 - accuracy10: 0.4804 - accuracy20: 0.4649 - accuracy30: 0.4484 - accuracy50: 0.4391 - val_loss: 12.8107 - val_accuracy10: 0.4507 - val_accuracy20: 0.4315 - val_accuracy30: 0.4213 - val_accuracy50: 0.4094 - 14s/epoch - 34ms/step
Epoch 16/50
428/428 - 15s - loss: 12.4284 - accuracy10: 0.4816 - accuracy20: 0.4661 - accuracy30: 0.4499 - accuracy50: 0.4407 - val_loss: 12.8576 - val_accuracy10: 0.4470 - val_accuracy20: 0.4272 - val_accuracy30: 0.4163 - val_accuracy50: 0.4076 - 15s/epoch - 34ms/step
Epoch 17/50
428/428 - 15s - loss: 12.4137 - accuracy10: 0.4841 - accuracy20: 0.4679 - accuracy30: 0.4510 - accuracy50: 0.4429 - val_loss: 12.8517 - val_accuracy10: 0.4484 - val_accuracy20: 0.4305 - val_accuracy30: 0.4192 - val_accuracy50: 0.4108 - 15s/epoch - 34ms/step
Epoch 18/50
428/428 - 15s - loss: 12.3918 - accuracy10: 0.4837 - accuracy20: 0.4690 - accuracy30: 0.4532 - accuracy50: 0.4453 - val_loss: 12.8352 - val_accuracy10: 0.4511 - val_accuracy20: 0.4320 - val_accuracy30: 0.4214 - val_accuracy50: 0.4101 - 15s/epoch - 34ms/step
Epoch 19/50
428/428 - 14s - loss: 12.3770 - accuracy10: 0.4860 - accuracy20: 0.4714 - accuracy30: 0.4565 - accuracy50: 0.4464 - val_loss: 12.8712 - val_accuracy10: 0.4480 - val_accuracy20: 0.4330 - val_accuracy30: 0.4221 - val_accuracy50: 0.4124 - 14s/epoch - 33ms/step
Epoch 20/50
428/428 - 14s - loss: 12.3564 - accuracy10: 0.4871 - accuracy20: 0.4725 - accuracy30: 0.4582 - accuracy50: 0.4485 - val_loss: 12.8804 - val_accuracy10: 0.4498 - val_accuracy20: 0.4294 - val_accuracy30: 0.4181 - val_accuracy50: 0.4088 - 14s/epoch - 33ms/step
Epoch 21/50
428/428 - 14s - loss: 12.3434 - accuracy10: 0.4879 - accuracy20: 0.4736 - accuracy30: 0.4584 - accuracy50: 0.4505 - val_loss: 12.8731 - val_accuracy10: 0.4433 - val_accuracy20: 0.4272 - val_accuracy30: 0.4189 - val_accuracy50: 0.4086 - 14s/epoch - 33ms/step
testing model: results/PCAR/W10/deepVOL_L2/seq2seq
Evaluating performance on  test set...
2104/2104 - 32s - 32s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0454997
{'0': {'precision': 0.5100158748025353, 'recall': 0.5976195457398328, 'f1-score': 0.5503533920400405, 'support': 219874}, '1': {'precision': 0.2873664178012004, 'recall': 0.23238790509544716, 'f1-score': 0.2569694060664241, 'support': 101365}, '2': {'precision': 0.5214528419486499, 'recall': 0.4773653840844461, 'f1-score': 0.4984361111778413, 'support': 217322}, 'accuracy': 0.48035227207317277, 'macro avg': {'precision': 0.43961171151746187, 'recall': 0.435790944973242, 'f1-score': 0.4352529697614353, 'support': 538561}, 'weighted avg': {'precision': 0.472725098762658, 'recall': 0.48035227207317277, 'f1-score': 0.4741844250154129, 'support': 538561}}
[[131401  27124  61349]
 [ 43952  23556  33857]
 [ 82288  31292 103742]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0632269
{'0': {'precision': 0.48437657455137395, 'recall': 0.5884784901680102, 'f1-score': 0.531376892626781, 'support': 212368}, '1': {'precision': 0.2859206631142688, 'recall': 0.20641135236792615, 'f1-score': 0.23974581740555032, 'support': 116980}, '2': {'precision': 0.49399544112472654, 'recall': 0.4630352798344271, 'f1-score': 0.4780145763531484, 'support': 209213}, 'accuracy': 0.4567597728019667, 'macro avg': {'precision': 0.4214308929301231, 'recall': 0.4193083741234545, 'f1-score': 0.41637909546182655, 'support': 538561}, 'weighted avg': {'precision': 0.44500688274765676, 'recall': 0.4567597728019667, 'f1-score': 0.44730267734952356, 'support': 538561}}
[[124974  28055  59339]
 [ 52945  24146  39889]
 [ 80091  32249  96873]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0751834
{'0': {'precision': 0.4697643578100826, 'recall': 0.5720842817071673, 'f1-score': 0.5158999014174174, 'support': 211766}, '1': {'precision': 0.26654897507112096, 'recall': 0.2019991137773536, 'f1-score': 0.22982766560826043, 'support': 117352}, '2': {'precision': 0.48233257013513303, 'recall': 0.4415568913737867, 'f1-score': 0.4610449174933945, 'support': 209443}, 'accuracy': 0.4406817426438231, 'macro avg': {'precision': 0.4062153010054455, 'recall': 0.4052134289527692, 'f1-score': 0.4022574948396908, 'support': 538561}, 'weighted avg': {'precision': 0.43037159171452966, 'recall': 0.4406817426438231, 'f1-score': 0.43223223626031293, 'support': 538561}}
[[121148  30902  59716]
 [ 54107  23705  39540]
 [ 82636  34326  92481]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0890232
{'0': {'precision': 0.46864328753073903, 'recall': 0.5455445813208878, 'f1-score': 0.5041783952203923, 'support': 221124}, '1': {'precision': 0.21110538981305366, 'recall': 0.20707747495155238, 'f1-score': 0.20907203405265046, 'support': 97012}, '2': {'precision': 0.4849912092520606, 'recall': 0.40922762844504934, 'f1-score': 0.4438998464627377, 'support': 220425}, 'accuracy': 0.4287833690148377, 'macro avg': {'precision': 0.3882466288652844, 'recall': 0.38728322823916317, 'f1-score': 0.3857167585785935, 'support': 538561}, 'weighted avg': {'precision': 0.4289434654345126, 'recall': 0.4287833690148377, 'f1-score': 0.4263492218871747, 'support': 538561}}
[[120633  36544  63947]
 [ 45083  20089  31840]
 [ 91693  38528  90204]]
Evaluating performance on  train set...
428/428 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0249989
{'0': {'precision': 0.473088620128722, 'recall': 0.5534350092390855, 'f1-score': 0.5101174436931212, 'support': 36259}, '1': {'precision': 0.4729025710419486, 'recall': 0.38654463001880324, 'f1-score': 0.4253849430953685, 'support': 36164}, '2': {'precision': 0.47578431111229574, 'recall': 0.4815084567451647, 'f1-score': 0.4786292701238805, 'support': 37071}, 'accuracy': 0.47396204358229677, 'macro avg': {'precision': 0.47392516742765545, 'recall': 0.4738293653343511, 'f1-score': 0.4713772189707901, 'support': 109494}, 'weighted avg': {'precision': 0.4739398419425017, 'recall': 0.47396204358229677, 'f1-score': 0.4714709038461666, 'support': 109494}}
[[20067  7013  9179]
 [11697 13979 10488]
 [10653  8568 17850]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0409223
{'0': {'precision': 0.460556293905449, 'recall': 0.5346152786578142, 'f1-score': 0.4948301141072225, 'support': 36299}, '1': {'precision': 0.43831732052308514, 'recall': 0.36326688600735435, 'f1-score': 0.3972787058734598, 'support': 36169}, '2': {'precision': 0.46803274303140546, 'recall': 0.4725328147788041, 'f1-score': 0.47027201376196104, 'support': 37026}, 'accuracy': 0.45702047600781776, 'macro avg': {'precision': 0.45563545248664655, 'recall': 0.4568049931479909, 'f1-score': 0.4541269445808811, 'support': 109494}, 'weighted avg': {'precision': 0.4557383274147824, 'recall': 0.45702047600781776, 'f1-score': 0.4543016366765814, 'support': 109494}}
[[19406  7726  9167]
 [12311 13139 10719]
 [10419  9111 17496]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0541642
{'0': {'precision': 0.4469151794281328, 'recall': 0.5150384253884005, 'f1-score': 0.4785646400041098, 'support': 36174}, '1': {'precision': 0.41406604814117953, 'recall': 0.35148010463995594, 'f1-score': 0.3802147718979461, 'support': 36315}, '2': {'precision': 0.45562466197944834, 'recall': 0.4553168490744494, 'f1-score': 0.45547070352098395, 'support': 37005}, 'accuracy': 0.4406086178238077, 'macro avg': {'precision': 0.4388686298495869, 'recall': 0.4406117930342686, 'f1-score': 0.43808337180768, 'support': 109494}, 'weighted avg': {'precision': 0.4389638597131321, 'recall': 0.4406086178238077, 'f1-score': 0.43814081239863917, 'support': 109494}}
[[18631  8412  9131]
 [12551 12764 11000]
 [10506  9650 16849]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.063616
{'0': {'precision': 0.43618700667880994, 'recall': 0.4912875783023771, 'f1-score': 0.4621005506097875, 'support': 36557}, '1': {'precision': 0.4082481318200294, 'recall': 0.3605113479485339, 'f1-score': 0.3828976114719726, 'support': 36218}, '2': {'precision': 0.4395915896081022, 'recall': 0.4350063999564258, 'f1-score': 0.43728697556635415, 'support': 36719}, 'accuracy': 0.42915593548504943, 'macro avg': {'precision': 0.4280089093689805, 'recall': 0.42893510873577895, 'f1-score': 0.4274283792160381, 'support': 109494}, 'weighted avg': {'precision': 0.4280872268821578, 'recall': 0.42915593548504943, 'f1-score': 0.4275808352672737, 'support': 109494}}
[[17960  9107  9490]
 [12288 13057 10873]
 [10927  9819 15973]]
Evaluating performance on  val set...
141/141 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0461168
{'0': {'precision': 0.44618491097105795, 'recall': 0.5995231439611938, 'f1-score': 0.511611590542342, 'support': 12163}, '1': {'precision': 0.4646691235378946, 'recall': 0.25618374558303886, 'f1-score': 0.33027731905927904, 'support': 11320}, '2': {'precision': 0.46155000375121913, 'recall': 0.49493161705551086, 'f1-score': 0.47765829418843897, 'support': 12430}, 'accuracy': 0.4550998245760588, 'macro avg': {'precision': 0.45746801275339055, 'recall': 0.4502128355332478, 'f1-score': 0.43984906793002, 'support': 35913}, 'weighted avg': {'precision': 0.4573293263502798, 'recall': 0.4550998245760588, 'f1-score': 0.4427021865140712, 'support': 35913}}
[[7292 1491 3380]
 [4623 2900 3797]
 [4428 1850 6152]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0614464
{'0': {'precision': 0.4258044744100521, 'recall': 0.5844199545722217, 'f1-score': 0.4926600950287214, 'support': 11887}, '1': {'precision': 0.42544886807181886, 'recall': 0.23400601116358952, 'f1-score': 0.30193905817174516, 'support': 11645}, '2': {'precision': 0.44887440309254906, 'recall': 0.47831354494790407, 'f1-score': 0.4631266129662939, 'support': 12381}, 'accuracy': 0.43421602205329546, 'macro avg': {'precision': 0.43337591519147334, 'recall': 0.43224650356123845, 'f1-score': 0.4192419220555868, 'support': 35913}, 'weighted avg': {'precision': 0.4336425205551602, 'recall': 0.43421602205329546, 'f1-score': 0.420636022530896, 'support': 35913}}
[[6947 1649 3291]
 [4940 2725 3980]
 [4428 2031 5922]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0701522
{'0': {'precision': 0.4189686924493554, 'recall': 0.5723750419322375, 'f1-score': 0.4838023676189126, 'support': 11924}, '1': {'precision': 0.40832834032354703, 'recall': 0.23601731601731601, 'f1-score': 0.2991331065510809, 'support': 11550}, '2': {'precision': 0.440797095852321, 'recall': 0.4587989388214487, 'f1-score': 0.4496178996297172, 'support': 12439}, 'accuracy': 0.4248600785230975, 'macro avg': {'precision': 0.42269804287507445, 'recall': 0.4223970989236674, 'f1-score': 0.4108511245999035, 'support': 35913}, 'weighted avg': {'precision': 0.42310723400468087, 'recall': 0.4248600785230975, 'f1-score': 0.41257048605371177, 'support': 35913}}
[[6825 1798 3301]
 [4885 2726 3939]
 [4580 2152 5707]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0790315
{'0': {'precision': 0.4105651105651106, 'recall': 0.5545507342570315, 'f1-score': 0.4718173154978294, 'support': 12053}, '1': {'precision': 0.3936862967157418, 'recall': 0.24595383390819847, 'f1-score': 0.3027597844428719, 'support': 11307}, '2': {'precision': 0.42819635611424933, 'recall': 0.4287421333545766, 'f1-score': 0.4284690709338429, 'support': 12553}, 'accuracy': 0.4134157547406232, 'macro avg': {'precision': 0.4108159211317006, 'recall': 0.4097489005066022, 'f1-score': 0.4010153902915148, 'support': 35913}, 'weighted avg': {'precision': 0.41141372463755027, 'recall': 0.4134157547406232, 'f1-score': 0.4034386220539476, 'support': 35913}}
[[6684 1968 3401]
 [4740 2781 3786]
 [4856 2315 5382]]
training model: results/PCAR/W10/deepVOL_L3/seq2seq
Epoch 1/50
428/428 - 26s - loss: 13.2168 - accuracy10: 0.3732 - accuracy20: 0.3645 - accuracy30: 0.3597 - accuracy50: 0.3642 - val_loss: 13.3133 - val_accuracy10: 0.3313 - val_accuracy20: 0.3313 - val_accuracy30: 0.3251 - val_accuracy50: 0.3175 - 26s/epoch - 62ms/step
Epoch 2/50
428/428 - 20s - loss: 13.1104 - accuracy10: 0.3756 - accuracy20: 0.3697 - accuracy30: 0.3641 - accuracy50: 0.3674 - val_loss: 13.1358 - val_accuracy10: 0.3894 - val_accuracy20: 0.3771 - val_accuracy30: 0.3694 - val_accuracy50: 0.3630 - 20s/epoch - 47ms/step
Epoch 3/50
428/428 - 20s - loss: 12.9552 - accuracy10: 0.4080 - accuracy20: 0.4008 - accuracy30: 0.3933 - accuracy50: 0.3907 - val_loss: 12.9666 - val_accuracy10: 0.4083 - val_accuracy20: 0.3981 - val_accuracy30: 0.3926 - val_accuracy50: 0.3898 - 20s/epoch - 46ms/step
Epoch 4/50
428/428 - 20s - loss: 12.8494 - accuracy10: 0.4259 - accuracy20: 0.4173 - accuracy30: 0.4094 - accuracy50: 0.4023 - val_loss: 12.8237 - val_accuracy10: 0.4413 - val_accuracy20: 0.4266 - val_accuracy30: 0.4168 - val_accuracy50: 0.4092 - 20s/epoch - 47ms/step
Epoch 5/50
428/428 - 20s - loss: 12.7710 - accuracy10: 0.4414 - accuracy20: 0.4303 - accuracy30: 0.4192 - accuracy50: 0.4113 - val_loss: 12.7832 - val_accuracy10: 0.4484 - val_accuracy20: 0.4316 - val_accuracy30: 0.4241 - val_accuracy50: 0.4127 - 20s/epoch - 46ms/step
Epoch 6/50
428/428 - 20s - loss: 12.7229 - accuracy10: 0.4512 - accuracy20: 0.4379 - accuracy30: 0.4244 - accuracy50: 0.4143 - val_loss: 12.7486 - val_accuracy10: 0.4572 - val_accuracy20: 0.4385 - val_accuracy30: 0.4257 - val_accuracy50: 0.4158 - 20s/epoch - 46ms/step
Epoch 7/50
428/428 - 20s - loss: 12.6729 - accuracy10: 0.4603 - accuracy20: 0.4447 - accuracy30: 0.4296 - accuracy50: 0.4180 - val_loss: 12.7090 - val_accuracy10: 0.4593 - val_accuracy20: 0.4401 - val_accuracy30: 0.4280 - val_accuracy50: 0.4184 - 20s/epoch - 46ms/step
Epoch 8/50
428/428 - 20s - loss: 12.6300 - accuracy10: 0.4648 - accuracy20: 0.4491 - accuracy30: 0.4334 - accuracy50: 0.4208 - val_loss: 12.7054 - val_accuracy10: 0.4615 - val_accuracy20: 0.4397 - val_accuracy30: 0.4278 - val_accuracy50: 0.4176 - 20s/epoch - 46ms/step
Epoch 9/50
428/428 - 19s - loss: 12.5914 - accuracy10: 0.4703 - accuracy20: 0.4540 - accuracy30: 0.4372 - accuracy50: 0.4259 - val_loss: 12.7001 - val_accuracy10: 0.4606 - val_accuracy20: 0.4404 - val_accuracy30: 0.4292 - val_accuracy50: 0.4170 - 19s/epoch - 46ms/step
Epoch 10/50
428/428 - 20s - loss: 12.5719 - accuracy10: 0.4721 - accuracy20: 0.4551 - accuracy30: 0.4387 - accuracy50: 0.4257 - val_loss: 12.6900 - val_accuracy10: 0.4604 - val_accuracy20: 0.4393 - val_accuracy30: 0.4272 - val_accuracy50: 0.4176 - 20s/epoch - 47ms/step
Epoch 11/50
428/428 - 20s - loss: 12.5381 - accuracy10: 0.4749 - accuracy20: 0.4587 - accuracy30: 0.4408 - accuracy50: 0.4279 - val_loss: 12.7018 - val_accuracy10: 0.4586 - val_accuracy20: 0.4390 - val_accuracy30: 0.4277 - val_accuracy50: 0.4185 - 20s/epoch - 47ms/step
Epoch 12/50
428/428 - 20s - loss: 12.5106 - accuracy10: 0.4788 - accuracy20: 0.4616 - accuracy30: 0.4443 - accuracy50: 0.4320 - val_loss: 12.6930 - val_accuracy10: 0.4594 - val_accuracy20: 0.4411 - val_accuracy30: 0.4298 - val_accuracy50: 0.4228 - 20s/epoch - 47ms/step
Epoch 13/50
428/428 - 20s - loss: 12.4935 - accuracy10: 0.4796 - accuracy20: 0.4639 - accuracy30: 0.4456 - accuracy50: 0.4336 - val_loss: 12.7027 - val_accuracy10: 0.4577 - val_accuracy20: 0.4398 - val_accuracy30: 0.4304 - val_accuracy50: 0.4213 - 20s/epoch - 47ms/step
Epoch 14/50
428/428 - 20s - loss: 12.4792 - accuracy10: 0.4799 - accuracy20: 0.4629 - accuracy30: 0.4455 - accuracy50: 0.4348 - val_loss: 12.7061 - val_accuracy10: 0.4574 - val_accuracy20: 0.4407 - val_accuracy30: 0.4301 - val_accuracy50: 0.4222 - 20s/epoch - 46ms/step
Epoch 15/50
428/428 - 20s - loss: 12.4512 - accuracy10: 0.4831 - accuracy20: 0.4672 - accuracy30: 0.4493 - accuracy50: 0.4375 - val_loss: 12.7101 - val_accuracy10: 0.4604 - val_accuracy20: 0.4440 - val_accuracy30: 0.4312 - val_accuracy50: 0.4222 - 20s/epoch - 47ms/step
Epoch 16/50
428/428 - 20s - loss: 12.4377 - accuracy10: 0.4835 - accuracy20: 0.4681 - accuracy30: 0.4519 - accuracy50: 0.4411 - val_loss: 12.7233 - val_accuracy10: 0.4592 - val_accuracy20: 0.4427 - val_accuracy30: 0.4310 - val_accuracy50: 0.4223 - 20s/epoch - 47ms/step
Epoch 17/50
428/428 - 19s - loss: 12.4125 - accuracy10: 0.4847 - accuracy20: 0.4692 - accuracy30: 0.4530 - accuracy50: 0.4423 - val_loss: 12.7164 - val_accuracy10: 0.4575 - val_accuracy20: 0.4423 - val_accuracy30: 0.4300 - val_accuracy50: 0.4209 - 19s/epoch - 45ms/step
Epoch 18/50
428/428 - 20s - loss: 12.4038 - accuracy10: 0.4833 - accuracy20: 0.4705 - accuracy30: 0.4537 - accuracy50: 0.4445 - val_loss: 12.7149 - val_accuracy10: 0.4597 - val_accuracy20: 0.4433 - val_accuracy30: 0.4315 - val_accuracy50: 0.4242 - 20s/epoch - 46ms/step
Epoch 19/50
428/428 - 20s - loss: 12.3856 - accuracy10: 0.4856 - accuracy20: 0.4717 - accuracy30: 0.4553 - accuracy50: 0.4447 - val_loss: 12.7311 - val_accuracy10: 0.4581 - val_accuracy20: 0.4418 - val_accuracy30: 0.4288 - val_accuracy50: 0.4199 - 20s/epoch - 46ms/step
Epoch 20/50
428/428 - 20s - loss: 12.3740 - accuracy10: 0.4862 - accuracy20: 0.4712 - accuracy30: 0.4545 - accuracy50: 0.4446 - val_loss: 12.7322 - val_accuracy10: 0.4571 - val_accuracy20: 0.4407 - val_accuracy30: 0.4316 - val_accuracy50: 0.4212 - 20s/epoch - 46ms/step
testing model: results/PCAR/W10/deepVOL_L3/seq2seq
Evaluating performance on  test set...
2104/2104 - 42s - 42s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.030838
{'0': {'precision': 0.5197517744453628, 'recall': 0.5405277568061708, 'f1-score': 0.5299362148496111, 'support': 219874}, '1': {'precision': 0.2971635485817743, 'recall': 0.24288462487051743, 'f1-score': 0.2672963656596911, 'support': 101365}, '2': {'precision': 0.5157103343786336, 'recall': 0.5387903663687984, 'f1-score': 0.5269977721268312, 'support': 217322}, 'accuracy': 0.4838059198493764, 'macro avg': {'precision': 0.4442085524685902, 'recall': 0.4407342493484956, 'f1-score': 0.44141011754537773, 'support': 538561}, 'weighted avg': {'precision': 0.47622662250743125, 'recall': 0.4838059198493764, 'f1-score': 0.4793178511683638, 'support': 538561}}
[[118848  29450  71576]
 [ 38364  24620  38381]
 [ 71451  28780 117091]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0513878
{'0': {'precision': 0.489121765425938, 'recall': 0.5400013184660589, 'f1-score': 0.5133038066186689, 'support': 212368}, '1': {'precision': 0.29584169562876306, 'recall': 0.20665925799281928, 'f1-score': 0.24333655433425938, 'support': 116980}, '2': {'precision': 0.48867284811094225, 'recall': 0.5194419084856103, 'f1-score': 0.5035878211024586, 'support': 209213}, 'accuracy': 0.45960996061727455, 'macro avg': {'precision': 0.42454543638854775, 'recall': 0.4220341616481629, 'f1-score': 0.420076060685129, 'support': 538561}, 'weighted avg': {'precision': 0.446965311648008, 'recall': 0.45960996061727455, 'f1-score': 0.45089030164888255, 'support': 538561}}
[[114679  29545  68144]
 [ 47237  24175  45568]
 [ 72543  27996 108674]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0642046
{'0': {'precision': 0.4717235416772619, 'recall': 0.5256084546149996, 'f1-score': 0.4972103224768941, 'support': 211766}, '1': {'precision': 0.2731130131173775, 'recall': 0.1919694594041857, 'f1-score': 0.2254626247260281, 'support': 117352}, '2': {'precision': 0.47767344027548736, 'recall': 0.5020220298601529, 'f1-score': 0.4895451646095325, 'support': 209443}, 'accuracy': 0.44373617844589563, 'macro avg': {'precision': 0.40750333169004227, 'recall': 0.4065333146264461, 'f1-score': 0.4040727039374849, 'support': 538561}, 'weighted avg': {'precision': 0.4307603487697706, 'recall': 0.44373617844589563, 'f1-score': 0.4350157902221014, 'support': 538561}}
[[111306  31332  69128]
 [ 48978  22528  45846]
 [ 75672  28626 105145]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0753967
{'0': {'precision': 0.46858222352996365, 'recall': 0.49692932472277995, 'f1-score': 0.48233964334705076, 'support': 221124}, '1': {'precision': 0.2136296261714966, 'recall': 0.18867768935801757, 'f1-score': 0.20037987224469467, 'support': 97012}, '2': {'precision': 0.47926769515383805, 'recall': 0.47481909946693884, 'f1-score': 0.47703302613467513, 'support': 220425}, 'accuracy': 0.4323539951834611, 'macro avg': {'precision': 0.38715984828509936, 'recall': 0.3868087045159121, 'f1-score': 0.3865841805754735, 'support': 538561}, 'weighted avg': {'precision': 0.4270305398910684, 'recall': 0.4323539951834611, 'f1-score': 0.429377783106113, 'support': 538561}}
[[109883  35607  75634]
 [ 40625  18304  38083]
 [ 83993  31770 104662]]
Evaluating performance on  train set...
428/428 - 9s - 9s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0242821
{'0': {'precision': 0.4891543352944672, 'recall': 0.4540114178548774, 'f1-score': 0.4709281535622845, 'support': 36259}, '1': {'precision': 0.4669602204648934, 'recall': 0.4310640415883199, 'f1-score': 0.4482947029389774, 'support': 36164}, '2': {'precision': 0.46791972866026005, 'recall': 0.535890588330501, 'f1-score': 0.49960390810668076, 'support': 37071}, 'accuracy': 0.4741538349133286, 'macro avg': {'precision': 0.4746780948065403, 'recall': 0.4736553492578994, 'f1-score': 0.47294225486931424, 'support': 109494}, 'weighted avg': {'precision': 0.4746346714660072, 'recall': 0.4741538349133286, 'f1-score': 0.4731613607551356, 'support': 109494}}
[[16462  9007 10790]
 [ 8775 15589 11800]
 [ 8417  8788 19866]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0403776
{'0': {'precision': 0.4728013977868375, 'recall': 0.4472850491749084, 'f1-score': 0.4596894067016804, 'support': 36299}, '1': {'precision': 0.43699822271250843, 'recall': 0.3942879261245818, 'f1-score': 0.41454587735999887, 'support': 36169}, '2': {'precision': 0.45750235183443083, 'recall': 0.5253875654945174, 'f1-score': 0.48910064616699767, 'support': 37026}, 'accuracy': 0.45618938024001315, 'macro avg': {'precision': 0.4557673241112589, 'recall': 0.4556535135980025, 'f1-score': 0.45444531007622563, 'support': 109494}, 'weighted avg': {'precision': 0.4558011282314535, 'recall': 0.45618938024001315, 'f1-score': 0.4547227805822908, 'support': 109494}}
[[16236  9406 10657]
 [ 9498 14261 12410]
 [ 8606  8967 19453]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0540493
{'0': {'precision': 0.45396333440542674, 'recall': 0.4292032951843866, 'f1-score': 0.4412362344582593, 'support': 36174}, '1': {'precision': 0.41482209191661806, 'recall': 0.3720776538620405, 'f1-score': 0.39228893276042276, 'support': 36315}, '2': {'precision': 0.4427434456928839, 'recall': 0.5111201189028509, 'f1-score': 0.4744810285355911, 'support': 37005}, 'accuracy': 0.43794180503041263, 'macro avg': {'precision': 0.43717629067164293, 'recall': 0.4374670226497594, 'f1-score': 0.43600206525142443, 'support': 109494}, 'weighted avg': {'precision': 0.4371897559190372, 'recall': 0.43794180503041263, 'f1-score': 0.4362378084593437, 'support': 109494}}
[[15526  9791 10857]
 [ 9854 13512 12949]
 [ 8821  9270 18914]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0619596
{'0': {'precision': 0.4455483832584704, 'recall': 0.4097163333971606, 'f1-score': 0.42688175107589704, 'support': 36557}, '1': {'precision': 0.4181407942238267, 'recall': 0.38375945662377825, 'f1-score': 0.40021307840709497, 'support': 36218}, '2': {'precision': 0.4281727138400919, 'recall': 0.49718129578692233, 'f1-score': 0.46010383587882453, 'support': 36719}, 'accuracy': 0.43046194312017094, 'macro avg': {'precision': 0.4306206304407964, 'recall': 0.4302190286026204, 'f1-score': 0.4290662217872722, 'support': 109494}, 'weighted avg': {'precision': 0.43065564698954095, 'recall': 0.43046194312017094, 'f1-score': 0.4292014740302143, 'support': 109494}}
[[14978  9959 11620]
 [ 9558 13899 12761]
 [ 9081  9382 18256]]
Evaluating performance on  val set...
141/141 - 3s - 3s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0386764
{'0': {'precision': 0.4607698001480385, 'recall': 0.5117980761325331, 'f1-score': 0.48494527324426445, 'support': 12163}, '1': {'precision': 0.45828295042321643, 'recall': 0.3013250883392226, 'f1-score': 0.3635879123807493, 'support': 11320}, '2': {'precision': 0.45822192513368987, 'recall': 0.5514883346741754, 'f1-score': 0.5005476451259585, 'support': 12430}, 'accuracy': 0.4591930498705204, 'macro avg': {'precision': 0.4590915585683149, 'recall': 0.4548704997153104, 'f1-score': 0.4496936102503241, 'support': 35913}, 'weighted avg': {'precision': 0.4591040739398871, 'recall': 0.4591930498705204, 'f1-score': 0.45209288434649664, 'support': 35913}}
[[6225 2009 3929]
 [3733 3411 4176]
 [3552 2023 6855]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0549954
{'0': {'precision': 0.4397214565501233, 'recall': 0.5099688735593505, 'f1-score': 0.4722471078565029, 'support': 11887}, '1': {'precision': 0.42242432469119046, 'recall': 0.26723915843709745, 'f1-score': 0.3273721859877971, 'support': 11645}, '2': {'precision': 0.44654471544715446, 'recall': 0.5323479525078749, 'f1-score': 0.4856858627169227, 'support': 12381}, 'accuracy': 0.4389775290284855, 'macro avg': {'precision': 0.43623016556282274, 'recall': 0.436518661501441, 'f1-score': 0.4284350521870743, 'support': 35913}, 'weighted avg': {'precision': 0.4364650777431974, 'recall': 0.4389775290284854, 'f1-score': 0.42990357651035466, 'support': 35913}}
[[6062 2109 3716]
 [4080 3112 4453]
 [3644 2146 6591]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0641599
{'0': {'precision': 0.43022582513028373, 'recall': 0.49849043944984905, 'f1-score': 0.46184926184926184, 'support': 11924}, '1': {'precision': 0.40472334682861, 'recall': 0.25965367965367964, 'f1-score': 0.3163502109704641, 'support': 11550}, '2': {'precision': 0.43644038946006675, 'recall': 0.5153147359112469, 'f1-score': 0.472609304726093, 'support': 12439}, 'accuracy': 0.42750536017598084, 'macro avg': {'precision': 0.4237965204729868, 'recall': 0.4244862850049252, 'f1-score': 0.41693625918193966, 'support': 35913}, 'weighted avg': {'precision': 0.4241764653250277, 'recall': 0.42750536017598084, 'f1-score': 0.4187821311638496, 'support': 35913}}
[[5944 2181 3799]
 [4073 2999 4478]
 [3799 2230 6410]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0707251
{'0': {'precision': 0.4228575606902603, 'recall': 0.4797975607732515, 'f1-score': 0.4495316568852268, 'support': 12053}, '1': {'precision': 0.40151812589975133, 'recall': 0.27133634032015563, 'f1-score': 0.32383364998944475, 'support': 11307}, '2': {'precision': 0.4227185530282269, 'recall': 0.49151597227754323, 'f1-score': 0.454528711923091, 'support': 12553}, 'accuracy': 0.4182607969259043, 'macro avg': {'precision': 0.41569807987274615, 'recall': 0.41421662445698343, 'f1-score': 0.40929800626592083, 'support': 35913}, 'weighted avg': {'precision': 0.4160903746473847, 'recall': 0.4182607969259043, 'f1-score': 0.41170303404446446, 'support': 35913}}
[[5783 2229 4041]
 [3854 3068 4385]
 [4039 2344 6170]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :       256            32
 Used       :        17 (peak)  14.07 (ave)

============================================
