This machine has 1 visible gpus.
This machine has 1 physical gpus.
training model: results/LILAK/W0/deepLOB_L1/seq2seq
Epoch 1/50
318/318 - 42s - loss: 13.1277 - accuracy10: 0.3789 - accuracy20: 0.3810 - accuracy30: 0.3819 - accuracy50: 0.3742 - val_loss: 12.9665 - val_accuracy10: 0.3600 - val_accuracy20: 0.3889 - val_accuracy30: 0.3921 - val_accuracy50: 0.3844 - 42s/epoch - 133ms/step
Epoch 2/50
318/318 - 7s - loss: 12.9888 - accuracy10: 0.3790 - accuracy20: 0.3974 - accuracy30: 0.3980 - accuracy50: 0.3884 - val_loss: 13.0326 - val_accuracy10: 0.3533 - val_accuracy20: 0.3669 - val_accuracy30: 0.3700 - val_accuracy50: 0.3664 - 7s/epoch - 23ms/step
Epoch 3/50
318/318 - 7s - loss: 12.9226 - accuracy10: 0.3893 - accuracy20: 0.4049 - accuracy30: 0.4062 - accuracy50: 0.3950 - val_loss: 12.9252 - val_accuracy10: 0.3482 - val_accuracy20: 0.3817 - val_accuracy30: 0.3879 - val_accuracy50: 0.3808 - 7s/epoch - 22ms/step
Epoch 4/50
318/318 - 7s - loss: 12.8815 - accuracy10: 0.3927 - accuracy20: 0.4107 - accuracy30: 0.4109 - accuracy50: 0.3992 - val_loss: 12.8583 - val_accuracy10: 0.4129 - val_accuracy20: 0.4018 - val_accuracy30: 0.3978 - val_accuracy50: 0.3872 - 7s/epoch - 21ms/step
Epoch 5/50
318/318 - 7s - loss: 12.8401 - accuracy10: 0.4079 - accuracy20: 0.4180 - accuracy30: 0.4168 - accuracy50: 0.4029 - val_loss: 12.9385 - val_accuracy10: 0.3437 - val_accuracy20: 0.3832 - val_accuracy30: 0.3905 - val_accuracy50: 0.3836 - 7s/epoch - 21ms/step
Epoch 6/50
318/318 - 7s - loss: 12.8101 - accuracy10: 0.4142 - accuracy20: 0.4249 - accuracy30: 0.4217 - accuracy50: 0.4068 - val_loss: 12.8591 - val_accuracy10: 0.4396 - val_accuracy20: 0.4200 - val_accuracy30: 0.4081 - val_accuracy50: 0.3920 - 7s/epoch - 21ms/step
Epoch 7/50
318/318 - 7s - loss: 12.7823 - accuracy10: 0.4258 - accuracy20: 0.4297 - accuracy30: 0.4265 - accuracy50: 0.4083 - val_loss: 12.7873 - val_accuracy10: 0.4408 - val_accuracy20: 0.4249 - val_accuracy30: 0.4153 - val_accuracy50: 0.3983 - 7s/epoch - 21ms/step
Epoch 8/50
318/318 - 7s - loss: 12.7561 - accuracy10: 0.4313 - accuracy20: 0.4361 - accuracy30: 0.4308 - accuracy50: 0.4105 - val_loss: 12.7965 - val_accuracy10: 0.4365 - val_accuracy20: 0.4215 - val_accuracy30: 0.4089 - val_accuracy50: 0.3930 - 7s/epoch - 21ms/step
Epoch 9/50
318/318 - 7s - loss: 12.7281 - accuracy10: 0.4373 - accuracy20: 0.4398 - accuracy30: 0.4344 - accuracy50: 0.4122 - val_loss: 12.7753 - val_accuracy10: 0.4365 - val_accuracy20: 0.4286 - val_accuracy30: 0.4172 - val_accuracy50: 0.4021 - 7s/epoch - 21ms/step
Epoch 10/50
318/318 - 7s - loss: 12.7056 - accuracy10: 0.4414 - accuracy20: 0.4433 - accuracy30: 0.4358 - accuracy50: 0.4163 - val_loss: 12.7234 - val_accuracy10: 0.4704 - val_accuracy20: 0.4445 - val_accuracy30: 0.4265 - val_accuracy50: 0.4070 - 7s/epoch - 21ms/step
Epoch 11/50
318/318 - 7s - loss: 12.6884 - accuracy10: 0.4453 - accuracy20: 0.4438 - accuracy30: 0.4364 - accuracy50: 0.4165 - val_loss: 12.7279 - val_accuracy10: 0.4315 - val_accuracy20: 0.4312 - val_accuracy30: 0.4237 - val_accuracy50: 0.4048 - 7s/epoch - 21ms/step
Epoch 12/50
318/318 - 7s - loss: 12.6783 - accuracy10: 0.4459 - accuracy20: 0.4455 - accuracy30: 0.4381 - accuracy50: 0.4189 - val_loss: 12.8505 - val_accuracy10: 0.3613 - val_accuracy20: 0.3932 - val_accuracy30: 0.3971 - val_accuracy50: 0.3868 - 7s/epoch - 21ms/step
Epoch 13/50
318/318 - 7s - loss: 12.6588 - accuracy10: 0.4487 - accuracy20: 0.4483 - accuracy30: 0.4410 - accuracy50: 0.4209 - val_loss: 12.7744 - val_accuracy10: 0.4289 - val_accuracy20: 0.4263 - val_accuracy30: 0.4158 - val_accuracy50: 0.4016 - 7s/epoch - 21ms/step
Epoch 14/50
318/318 - 7s - loss: 12.6392 - accuracy10: 0.4532 - accuracy20: 0.4506 - accuracy30: 0.4427 - accuracy50: 0.4224 - val_loss: 12.9274 - val_accuracy10: 0.3684 - val_accuracy20: 0.3983 - val_accuracy30: 0.4025 - val_accuracy50: 0.3916 - 7s/epoch - 21ms/step
Epoch 15/50
318/318 - 7s - loss: 12.6271 - accuracy10: 0.4545 - accuracy20: 0.4512 - accuracy30: 0.4435 - accuracy50: 0.4238 - val_loss: 12.7747 - val_accuracy10: 0.4509 - val_accuracy20: 0.4318 - val_accuracy30: 0.4188 - val_accuracy50: 0.4041 - 7s/epoch - 21ms/step
Epoch 16/50
318/318 - 7s - loss: 12.6126 - accuracy10: 0.4557 - accuracy20: 0.4533 - accuracy30: 0.4456 - accuracy50: 0.4253 - val_loss: 12.8704 - val_accuracy10: 0.3973 - val_accuracy20: 0.4080 - val_accuracy30: 0.4055 - val_accuracy50: 0.3956 - 7s/epoch - 21ms/step
Epoch 17/50
318/318 - 7s - loss: 12.6018 - accuracy10: 0.4537 - accuracy20: 0.4541 - accuracy30: 0.4478 - accuracy50: 0.4272 - val_loss: 12.9243 - val_accuracy10: 0.3611 - val_accuracy20: 0.3893 - val_accuracy30: 0.3958 - val_accuracy50: 0.3862 - 7s/epoch - 21ms/step
Epoch 18/50
318/318 - 7s - loss: 12.5907 - accuracy10: 0.4560 - accuracy20: 0.4560 - accuracy30: 0.4496 - accuracy50: 0.4283 - val_loss: 13.0499 - val_accuracy10: 0.3468 - val_accuracy20: 0.3775 - val_accuracy30: 0.3846 - val_accuracy50: 0.3765 - 7s/epoch - 21ms/step
Epoch 19/50
318/318 - 7s - loss: 12.5800 - accuracy10: 0.4574 - accuracy20: 0.4566 - accuracy30: 0.4506 - accuracy50: 0.4304 - val_loss: 12.8946 - val_accuracy10: 0.3670 - val_accuracy20: 0.3961 - val_accuracy30: 0.4009 - val_accuracy50: 0.3867 - 7s/epoch - 21ms/step
Epoch 20/50
318/318 - 7s - loss: 12.5663 - accuracy10: 0.4570 - accuracy20: 0.4577 - accuracy30: 0.4515 - accuracy50: 0.4308 - val_loss: 12.9184 - val_accuracy10: 0.3644 - val_accuracy20: 0.3893 - val_accuracy30: 0.3927 - val_accuracy50: 0.3826 - 7s/epoch - 21ms/step
testing model: results/LILAK/W0/deepLOB_L1/seq2seq
Evaluating performance on  test set...
876/876 - 8s - 8s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.99957407
{'0': {'precision': 0.29257917294599245, 'recall': 0.6110949882799419, 'f1-score': 0.3957038364798057, 'support': 44795}, '1': {'precision': 0.7032058888387185, 'recall': 0.5025590610272266, 'f1-score': 0.5861880314946845, 'support': 133252}, '2': {'precision': 0.37658004128608996, 'recall': 0.28882189641710765, 'f1-score': 0.32691387119343074, 'support': 46108}, 'accuracy': 0.48028373223885257, 'macro avg': {'precision': 0.45745503435693363, 'recall': 0.46749198190809205, 'f1-score': 0.43626857972264027, 'support': 224155}, 'weighted avg': {'precision': 0.553960552721428, 'recall': 0.48028373223885257, 'f1-score': 0.4947898806666338, 'support': 224155}}
[[27374 12302  5119]
 [49358 66967 16927]
 [16829 15962 13317]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0289643
{'0': {'precision': 0.33564948851573057, 'recall': 0.5641321390595996, 'f1-score': 0.42088137416383753, 'support': 55487}, '1': {'precision': 0.5970747051114024, 'recall': 0.5097937406001576, 'f1-score': 0.5499929978414035, 'support': 111704}, '2': {'precision': 0.4227520972918192, 'recall': 0.26362263885963066, 'f1-score': 0.3247410418874208, 'support': 56964}, 'accuracy': 0.4606856862438937, 'macro avg': {'precision': 0.45182543030631733, 'recall': 0.4458495061731293, 'f1-score': 0.4318718046308873, 'support': 224155}, 'weighted avg': {'precision': 0.4880616827604454, 'recall': 0.4606856862438937, 'f1-score': 0.4607901289249851, 'support': 224155}}
[[31302 17447  6738]
 [40991 56946 13767]
 [20965 20982 15017]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0439881
{'0': {'precision': 0.3439306991414053, 'recall': 0.5328299966067187, 'f1-score': 0.41803104118414397, 'support': 58940}, '1': {'precision': 0.5469323866717137, 'recall': 0.5096037442687332, 'f1-score': 0.5276086334343265, 'support': 104907}, '2': {'precision': 0.42466377934807387, 'recall': 0.24713139218677455, 'f1-score': 0.3124397299903568, 'support': 60308}, 'accuracy': 0.4450937967031741, 'macro avg': {'precision': 0.43850895505373094, 'recall': 0.42985504435407557, 'f1-score': 0.4193598015362758, 'support': 224155}, 'weighted avg': {'precision': 0.4606586268469922, 'recall': 0.4450937967031741, 'f1-score': 0.4409056398980472, 'support': 224155}}
[[31405 20634  6901]
 [38155 53461 13291]
 [21752 23652 14904]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0608703
{'0': {'precision': 0.3383600806405686, 'recall': 0.48672073400507904, 'f1-score': 0.3992017845624597, 'support': 61035}, '1': {'precision': 0.5019104536102674, 'recall': 0.5102335541058712, 'f1-score': 0.5060377824422769, 'support': 100405}, '2': {'precision': 0.40775198320111994, 'recall': 0.22292912381407956, 'f1-score': 0.2882591260064122, 'support': 62715}, 'accuracy': 0.4234480604938547, 'macro avg': {'precision': 0.4160075058173187, 'recall': 0.40662780397500997, 'f1-score': 0.39783289767038293, 'support': 224155}, 'weighted avg': {'precision': 0.43103340207933905, 'recall': 0.4234480604938547, 'f1-score': 0.41601648660247903, 'support': 224155}}
[[29707 24308  7020]
 [35888 51230 13287]
 [22202 26532 13981]]
Evaluating performance on  train set...
318/318 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.041198
{'0': {'precision': 0.36778507742843736, 'recall': 0.44258823529411767, 'f1-score': 0.40173422749989324, 'support': 21250}, '1': {'precision': 0.5862204081632653, 'recall': 0.4580664914653127, 'f1-score': 0.514279985104128, 'support': 39193}, '2': {'precision': 0.3604730134633055, 'recall': 0.43411113783978833, 'f1-score': 0.3938798672952681, 'support': 20785}, 'accuracy': 0.44788742798049935, 'macro avg': {'precision': 0.43815949968500273, 'recall': 0.44492195486640623, 'f1-score': 0.43663135996642977, 'support': 81228}, 'weighted avg': {'precision': 0.47131039712084444, 'recall': 0.44788742798049935, 'f1-score': 0.45402842409379723, 'support': 81228}}
[[ 9405  6206  5639]
 [10871 17953 10369]
 [ 5296  6466  9023]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0629998
{'0': {'precision': 0.4252945307014122, 'recall': 0.42108922363847046, 'f1-score': 0.42318143001319775, 'support': 25890}, '1': {'precision': 0.45763156170129105, 'recall': 0.4655022998466769, 'f1-score': 0.4615333773959022, 'support': 30002}, '2': {'precision': 0.41497846546498646, 'recall': 0.41071992421850334, 'f1-score': 0.41283821312385943, 'support': 25336}, 'accuracy': 0.4342591224700842, 'macro avg': {'precision': 0.43263485262256324, 'recall': 0.43243714923455023, 'f1-score': 0.4325176735109865, 'support': 81228}, 'weighted avg': {'precision': 0.434020681477355, 'recall': 0.4342591224700842, 'f1-score': 0.4341207536733595, 'support': 81228}}
[[10902  8102  6886]
 [ 8252 13966  7784]
 [ 6480  8450 10406]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0746677
{'0': {'precision': 0.44278113087674714, 'recall': 0.40345164441549985, 'f1-score': 0.4222024496904758, 'support': 27639}, '1': {'precision': 0.4033012024887972, 'recall': 0.46940077295411053, 'f1-score': 0.43384775446505985, 'support': 26651}, '2': {'precision': 0.42925074925074924, 'recall': 0.39876754027767464, 'f1-score': 0.4134480303292728, 'support': 26938}, 'accuracy': 0.4235362190377702, 'macro avg': {'precision': 0.42511102753876456, 'recall': 0.4238733192157617, 'f1-score': 0.42316607816160284, 'support': 81228}, 'weighted avg': {'precision': 0.42534058092219473, 'recall': 0.4235362190377702, 'f1-score': 0.42312002083337424, 'support': 81228}}
[[11151  9129  7359]
 [ 7217 12510  6924]
 [ 6816  9380 10742]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0850965
{'0': {'precision': 0.43236942206225204, 'recall': 0.3819830888198309, 'f1-score': 0.4056174817259175, 'support': 27674}, '1': {'precision': 0.37888451197398865, 'recall': 0.45250541408408634, 'f1-score': 0.4124353389599782, 'support': 26782}, '2': {'precision': 0.4072520469487355, 'recall': 0.37714776632302405, 'f1-score': 0.3916222243769999, 'support': 26772}, 'accuracy': 0.4036416014182302, 'macro avg': {'precision': 0.40616866032832544, 'recall': 0.40387875640898047, 'f1-score': 0.40322501502096514, 'support': 81228}, 'weighted avg': {'precision': 0.4064562489135479, 'recall': 0.4036416014182302, 'f1-score': 0.40325271616105557, 'support': 81228}}
[[10571  9842  7261]
 [ 7228 12119  7435]
 [ 6650 10025 10097]]
Evaluating performance on  val set...
104/104 - 1s - 820ms/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0250989
{'0': {'precision': 0.3360082304526749, 'recall': 0.5235652452709202, 'f1-score': 0.40932447675147265, 'support': 6238}, '1': {'precision': 0.6147499579053712, 'recall': 0.5325262543757293, 'f1-score': 0.5706916764361079, 'support': 13712}, '2': {'precision': 0.3893769152196119, 'recall': 0.29130368332569156, 'f1-score': 0.33327504808532954, 'support': 6543}, 'accuracy': 0.47084135432000906, 'macro avg': {'precision': 0.4467117011925527, 'recall': 0.44913172765744697, 'f1-score': 0.4377637337576367, 'support': 26493}, 'weighted avg': {'precision': 0.4934572876097142, 'recall': 0.47084135432000906, 'f1-score': 0.4740614121801951, 'support': 26493}}
[[3266 2044  928]
 [4349 7302 2061]
 [2105 2532 1906]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0558988
{'0': {'precision': 0.3826695933939584, 'recall': 0.48228164932156503, 'f1-score': 0.4267397132532929, 'support': 7591}, '1': {'precision': 0.4920502788645634, 'recall': 0.5436902133922001, 'f1-score': 0.5165829145728643, 'support': 10872}, '2': {'precision': 0.4528801139833096, 'recall': 0.2770859277708593, 'f1-score': 0.3438151896778181, 'support': 8030}, 'accuracy': 0.4452874344166384, 'macro avg': {'precision': 0.4425333287472771, 'recall': 0.4343525968282081, 'f1-score': 0.4290459391679918, 'support': 26493}, 'weighted avg': {'precision': 0.4488371581381892, 'recall': 0.4452874344166384, 'f1-score': 0.4384745624751748, 'support': 26493}}
[[3661 2807 1123]
 [3396 5911 1565]
 [2510 3295 2225]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0676848
{'0': {'precision': 0.39670223084384093, 'recall': 0.45461281956280103, 'f1-score': 0.4236878453038674, 'support': 8097}, '1': {'precision': 0.4399028733306354, 'recall': 0.5406884202148826, 'f1-score': 0.4851162583121346, 'support': 10052}, '2': {'precision': 0.4575015435274748, 'recall': 0.2664189837008629, 'f1-score': 0.3367416496250852, 'support': 8344}, 'accuracy': 0.4279998490167214, 'macro avg': {'precision': 0.43136888256731704, 'recall': 0.42057340782618224, 'f1-score': 0.41518191774702906, 'support': 26493}, 'weighted avg': {'precision': 0.4322422724891623, 'recall': 0.4279998490167214, 'f1-score': 0.4196112722776093, 'support': 26493}}
[[3681 3279 1137]
 [3118 5435 1499]
 [2480 3641 2223]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0796894
{'0': {'precision': 0.38330532212885154, 'recall': 0.4156238610132426, 'f1-score': 0.3988109116344136, 'support': 8231}, '1': {'precision': 0.4113287040649138, 'recall': 0.5347398316259255, 'f1-score': 0.46498500617392835, 'support': 9859}, '2': {'precision': 0.44285413597137446, 'recall': 0.25038676663096515, 'f1-score': 0.3199026911965942, 'support': 8403}, 'accuracy': 0.40754161476616463, 'macro avg': {'precision': 0.41249605405504663, 'recall': 0.4002501530900444, 'f1-score': 0.3945662030016454, 'support': 26493}, 'weighted avg': {'precision': 0.41262141336904173, 'recall': 0.40754161476616463, 'f1-score': 0.3984087156477787, 'support': 26493}}
[[3421 3677 1133]
 [3073 5272 1514]
 [2431 3868 2104]]
training model: results/LILAK/W0/deepOF_L1/seq2seq
Epoch 1/50
318/318 - 12s - loss: 13.1605 - accuracy10: 0.3965 - accuracy20: 0.3804 - accuracy30: 0.3705 - accuracy50: 0.3619 - val_loss: 12.9844 - val_accuracy10: 0.4620 - val_accuracy20: 0.4108 - val_accuracy30: 0.3870 - val_accuracy50: 0.3696 - 12s/epoch - 37ms/step
Epoch 2/50
318/318 - 7s - loss: 13.0872 - accuracy10: 0.4186 - accuracy20: 0.3939 - accuracy30: 0.3819 - accuracy50: 0.3697 - val_loss: 12.9664 - val_accuracy10: 0.4677 - val_accuracy20: 0.4180 - val_accuracy30: 0.3906 - val_accuracy50: 0.3727 - 7s/epoch - 21ms/step
Epoch 3/50
318/318 - 7s - loss: 13.0560 - accuracy10: 0.4173 - accuracy20: 0.3968 - accuracy30: 0.3846 - accuracy50: 0.3739 - val_loss: 12.9457 - val_accuracy10: 0.4640 - val_accuracy20: 0.4173 - val_accuracy30: 0.3917 - val_accuracy50: 0.3720 - 7s/epoch - 22ms/step
Epoch 4/50
318/318 - 6s - loss: 13.0323 - accuracy10: 0.4174 - accuracy20: 0.3984 - accuracy30: 0.3876 - accuracy50: 0.3768 - val_loss: 12.9378 - val_accuracy10: 0.4628 - val_accuracy20: 0.4148 - val_accuracy30: 0.3901 - val_accuracy50: 0.3749 - 6s/epoch - 20ms/step
Epoch 5/50
318/318 - 6s - loss: 13.0121 - accuracy10: 0.4208 - accuracy20: 0.4021 - accuracy30: 0.3925 - accuracy50: 0.3801 - val_loss: 12.9274 - val_accuracy10: 0.4722 - val_accuracy20: 0.4169 - val_accuracy30: 0.3915 - val_accuracy50: 0.3776 - 6s/epoch - 20ms/step
Epoch 6/50
318/318 - 6s - loss: 13.0003 - accuracy10: 0.4191 - accuracy20: 0.4030 - accuracy30: 0.3944 - accuracy50: 0.3813 - val_loss: 12.9326 - val_accuracy10: 0.4711 - val_accuracy20: 0.4175 - val_accuracy30: 0.3903 - val_accuracy50: 0.3776 - 6s/epoch - 19ms/step
Epoch 7/50
318/318 - 6s - loss: 12.9871 - accuracy10: 0.4244 - accuracy20: 0.4056 - accuracy30: 0.3965 - accuracy50: 0.3827 - val_loss: 12.9079 - val_accuracy10: 0.4741 - val_accuracy20: 0.4220 - val_accuracy30: 0.3974 - val_accuracy50: 0.3806 - 6s/epoch - 19ms/step
Epoch 8/50
318/318 - 6s - loss: 12.9683 - accuracy10: 0.4222 - accuracy20: 0.4066 - accuracy30: 0.3987 - accuracy50: 0.3851 - val_loss: 12.9158 - val_accuracy10: 0.4769 - val_accuracy20: 0.4212 - val_accuracy30: 0.3950 - val_accuracy50: 0.3784 - 6s/epoch - 19ms/step
Epoch 9/50
318/318 - 6s - loss: 12.9587 - accuracy10: 0.4249 - accuracy20: 0.4095 - accuracy30: 0.3991 - accuracy50: 0.3863 - val_loss: 12.9143 - val_accuracy10: 0.4731 - val_accuracy20: 0.4216 - val_accuracy30: 0.3966 - val_accuracy50: 0.3809 - 6s/epoch - 19ms/step
Epoch 10/50
318/318 - 6s - loss: 12.9390 - accuracy10: 0.4249 - accuracy20: 0.4109 - accuracy30: 0.4029 - accuracy50: 0.3889 - val_loss: 12.9103 - val_accuracy10: 0.4726 - val_accuracy20: 0.4228 - val_accuracy30: 0.3973 - val_accuracy50: 0.3809 - 6s/epoch - 19ms/step
Epoch 11/50
318/318 - 6s - loss: 12.9350 - accuracy10: 0.4267 - accuracy20: 0.4131 - accuracy30: 0.4049 - accuracy50: 0.3905 - val_loss: 12.9067 - val_accuracy10: 0.4728 - val_accuracy20: 0.4226 - val_accuracy30: 0.3981 - val_accuracy50: 0.3847 - 6s/epoch - 19ms/step
Epoch 12/50
318/318 - 6s - loss: 12.9190 - accuracy10: 0.4269 - accuracy20: 0.4147 - accuracy30: 0.4058 - accuracy50: 0.3912 - val_loss: 12.9063 - val_accuracy10: 0.4726 - val_accuracy20: 0.4234 - val_accuracy30: 0.4002 - val_accuracy50: 0.3873 - 6s/epoch - 19ms/step
Epoch 13/50
318/318 - 6s - loss: 12.9054 - accuracy10: 0.4316 - accuracy20: 0.4161 - accuracy30: 0.4071 - accuracy50: 0.3930 - val_loss: 12.9005 - val_accuracy10: 0.4716 - val_accuracy20: 0.4226 - val_accuracy30: 0.3966 - val_accuracy50: 0.3844 - 6s/epoch - 20ms/step
Epoch 14/50
318/318 - 6s - loss: 12.8956 - accuracy10: 0.4327 - accuracy20: 0.4177 - accuracy30: 0.4093 - accuracy50: 0.3948 - val_loss: 12.9006 - val_accuracy10: 0.4688 - val_accuracy20: 0.4255 - val_accuracy30: 0.3997 - val_accuracy50: 0.3855 - 6s/epoch - 20ms/step
Epoch 15/50
318/318 - 6s - loss: 12.8841 - accuracy10: 0.4360 - accuracy20: 0.4200 - accuracy30: 0.4119 - accuracy50: 0.3976 - val_loss: 12.9047 - val_accuracy10: 0.4684 - val_accuracy20: 0.4229 - val_accuracy30: 0.3977 - val_accuracy50: 0.3844 - 6s/epoch - 20ms/step
Epoch 16/50
318/318 - 6s - loss: 12.8770 - accuracy10: 0.4375 - accuracy20: 0.4230 - accuracy30: 0.4145 - accuracy50: 0.3992 - val_loss: 12.9218 - val_accuracy10: 0.4672 - val_accuracy20: 0.4192 - val_accuracy30: 0.3960 - val_accuracy50: 0.3827 - 6s/epoch - 20ms/step
Epoch 17/50
318/318 - 7s - loss: 12.8541 - accuracy10: 0.4367 - accuracy20: 0.4230 - accuracy30: 0.4160 - accuracy50: 0.4014 - val_loss: 12.9123 - val_accuracy10: 0.4685 - val_accuracy20: 0.4216 - val_accuracy30: 0.3960 - val_accuracy50: 0.3823 - 7s/epoch - 21ms/step
Epoch 18/50
318/318 - 6s - loss: 12.8445 - accuracy10: 0.4386 - accuracy20: 0.4253 - accuracy30: 0.4179 - accuracy50: 0.4014 - val_loss: 12.9208 - val_accuracy10: 0.4574 - val_accuracy20: 0.4194 - val_accuracy30: 0.3965 - val_accuracy50: 0.3838 - 6s/epoch - 19ms/step
Epoch 19/50
318/318 - 6s - loss: 12.8317 - accuracy10: 0.4380 - accuracy20: 0.4257 - accuracy30: 0.4190 - accuracy50: 0.4055 - val_loss: 12.9204 - val_accuracy10: 0.4582 - val_accuracy20: 0.4178 - val_accuracy30: 0.3961 - val_accuracy50: 0.3829 - 6s/epoch - 19ms/step
Epoch 20/50
318/318 - 6s - loss: 12.8131 - accuracy10: 0.4394 - accuracy20: 0.4286 - accuracy30: 0.4225 - accuracy50: 0.4079 - val_loss: 12.9126 - val_accuracy10: 0.4593 - val_accuracy20: 0.4176 - val_accuracy30: 0.3998 - val_accuracy50: 0.3833 - 6s/epoch - 20ms/step
Epoch 21/50
318/318 - 6s - loss: 12.7948 - accuracy10: 0.4406 - accuracy20: 0.4326 - accuracy30: 0.4260 - accuracy50: 0.4119 - val_loss: 12.9372 - val_accuracy10: 0.4581 - val_accuracy20: 0.4179 - val_accuracy30: 0.3974 - val_accuracy50: 0.3826 - 6s/epoch - 19ms/step
Epoch 22/50
318/318 - 6s - loss: 12.7922 - accuracy10: 0.4423 - accuracy20: 0.4319 - accuracy30: 0.4255 - accuracy50: 0.4121 - val_loss: 12.9353 - val_accuracy10: 0.4540 - val_accuracy20: 0.4167 - val_accuracy30: 0.3974 - val_accuracy50: 0.3827 - 6s/epoch - 19ms/step
Epoch 23/50
318/318 - 7s - loss: 12.7714 - accuracy10: 0.4401 - accuracy20: 0.4325 - accuracy30: 0.4291 - accuracy50: 0.4155 - val_loss: 12.9408 - val_accuracy10: 0.4473 - val_accuracy20: 0.4124 - val_accuracy30: 0.3960 - val_accuracy50: 0.3819 - 7s/epoch - 21ms/step
testing model: results/LILAK/W0/deepOF_L1/seq2seq
Evaluating performance on  test set...
876/876 - 8s - 8s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0062236
{'0': {'precision': 0.2860306008209976, 'recall': 0.25666383890699646, 'f1-score': 0.2705526597559684, 'support': 44794}, '1': {'precision': 0.6884424103495593, 'recall': 0.6513621013133208, 'f1-score': 0.6693891401842491, 'support': 133250}, '2': {'precision': 0.29902214850903563, 'recall': 0.37539582700733093, 'f1-score': 0.3328845636034927, 'support': 46106}, 'accuracy': 0.515721614989962, 'macro avg': {'precision': 0.4244983865598642, 'recall': 0.4278072557425494, 'f1-score': 0.4242754545145701, 'support': 224150}, 'weighted avg': {'precision': 0.5279238058952137, 'recall': 0.515721614989962, 'f1-score': 0.5204693930857135, 'support': 224150}}
[[11497 19671 13626]
 [19508 86794 26948]
 [ 9190 19608 17308]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0376534
{'0': {'precision': 0.3315137466038535, 'recall': 0.23970010453087265, 'f1-score': 0.2782281261440301, 'support': 55486}, '1': {'precision': 0.5813316877116365, 'recall': 0.6578037993948184, 'f1-score': 0.6172080403867315, 'support': 111702}, '2': {'precision': 0.3455365663225471, 'recall': 0.3496190442751308, 'f1-score': 0.3475658176043003, 'support': 56962}, 'accuracy': 0.4759892928842293, 'macro avg': {'precision': 0.4194606668793457, 'recall': 0.415707649400274, 'f1-score': 0.4143339947116873, 'support': 224150}, 'weighted avg': {'precision': 0.45957054568677924, 'recall': 0.4759892928842293, 'f1-score': 0.46477440301977463, 'support': 224150}}
[[13300 26573 15613]
 [16117 73478 22107]
 [10702 26345 19915]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0558202
{'0': {'precision': 0.337849629162829, 'recall': 0.23649875294796316, 'f1-score': 0.27823188319011544, 'support': 58939}, '1': {'precision': 0.5338725188793769, 'recall': 0.6455936323340165, 'f1-score': 0.5844418651812411, 'support': 104905}, '2': {'precision': 0.35067994431952026, 'recall': 0.3258382250522336, 'f1-score': 0.3378029912325941, 'support': 60306}, 'accuracy': 0.4519964309614098, 'macro avg': {'precision': 0.40746736412057544, 'recall': 0.402643536778071, 'f1-score': 0.40015891320131686, 'support': 224150}, 'weighted avg': {'precision': 0.4330426973383984, 'recall': 0.4519964309614098, 'f1-score': 0.4375691725159631, 'support': 224150}}
[[13939 29732 15268]
 [16063 67726 21116]
 [11256 29400 19650]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0699766
{'0': {'precision': 0.3312869222749913, 'recall': 0.23429563849657567, 'f1-score': 0.2744748030211422, 'support': 61034}, '1': {'precision': 0.49066064936692994, 'recall': 0.6237263826778084, 'f1-score': 0.5492490187909751, 'support': 100403}, '2': {'precision': 0.35135793676081944, 'recall': 0.2989172898761022, 'f1-score': 0.3230231075422605, 'support': 62713}, 'accuracy': 0.42681240240910107, 'macro avg': {'precision': 0.39110183613424687, 'recall': 0.3856464370168287, 'f1-score': 0.3822489764514592, 'support': 224150}, 'weighted avg': {'precision': 0.40829033004952475, 'recall': 0.42681240240910107, 'f1-score': 0.4111367053515969, 'support': 224150}}
[[14300 32911 13823]
 [16995 62624 20784]
 [11870 32097 18746]]
Evaluating performance on  train set...
318/318 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0414345
{'0': {'precision': 0.35027736895731915, 'recall': 0.29100827689992476, 'f1-score': 0.3179039301310044, 'support': 21264}, '1': {'precision': 0.5614587106120971, 'recall': 0.6333597201297209, 'f1-score': 0.5952458091843958, 'support': 39161}, '2': {'precision': 0.3592323169787959, 'recall': 0.3347596153846154, 'f1-score': 0.34656446756090886, 'support': 20800}, 'accuracy': 0.46726992920898736, 'macro avg': {'precision': 0.4236561321827374, 'recall': 0.419709204138087, 'f1-score': 0.4199047356254364, 'support': 81225}, 'weighted avg': {'precision': 0.45438737744472424, 'recall': 0.46726992920898736, 'f1-score': 0.4589580945403842, 'support': 81225}}
[[ 6188 10033  5043]
 [ 6981 24803  7377]
 [ 4497  9340  6963]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0716916
{'0': {'precision': 0.4045527156549521, 'recall': 0.27328785601418276, 'f1-score': 0.32621046578493385, 'support': 25947}, '1': {'precision': 0.43044441430444413, 'recall': 0.6354747205072585, 'f1-score': 0.5132407045537242, 'support': 29965}, '2': {'precision': 0.405519296983401, 'recall': 0.3117370521076127, 'f1-score': 0.35249709639953547, 'support': 25313}, 'accuracy': 0.41888581101877503, 'macro avg': {'precision': 0.4135054756475991, 'recall': 0.406833209543018, 'f1-score': 0.3973160889127312, 'support': 81225}, 'weighted avg': {'precision': 0.4144057390245927, 'recall': 0.41888581101877503, 'f1-score': 0.40340042682469024, 'support': 81225}}
[[ 7091 12928  5928]
 [ 5283 19042  5640]
 [ 5154 12268  7891]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0836287
{'0': {'precision': 0.42175466011831675, 'recall': 0.273368542902619, 'f1-score': 0.33172380492515696, 'support': 27644}, '1': {'precision': 0.37606798969305183, 'recall': 0.6242215052149771, 'f1-score': 0.4693635748138117, 'support': 26654}, '2': {'precision': 0.41751901389981644, 'recall': 0.29561406766442605, 'f1-score': 0.34614715602713514, 'support': 26927}, 'accuracy': 0.3958756540473992, 'macro avg': {'precision': 0.4051138879037283, 'recall': 0.39773470526067406, 'f1-score': 0.3824115119220346, 'support': 81225}, 'weighted avg': {'precision': 0.4053584057724803, 'recall': 0.3958756540473992, 'f1-score': 0.38167182587603626, 'support': 81225}}
[[ 7557 14100  5987]
 [ 4898 16638  5118]
 [ 5463 13504  7960]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.089052
{'0': {'precision': 0.411086069972097, 'recall': 0.27658038196324775, 'f1-score': 0.3306787525628574, 'support': 27699}, '1': {'precision': 0.3608844075690096, 'recall': 0.5950792171481827, 'f1-score': 0.44929494215992566, 'support': 26825}, '2': {'precision': 0.4076051427326215, 'recall': 0.28021422418636005, 'f1-score': 0.33211265730075235, 'support': 26701}, 'accuracy': 0.3829609110495537, 'macro avg': {'precision': 0.39319187342457607, 'recall': 0.3839579410992635, 'f1-score': 0.37069545067451176, 'support': 81225}, 'weighted avg': {'precision': 0.3933624155284644, 'recall': 0.3829609110495537, 'f1-score': 0.3703237630442103, 'support': 81225}}
[[ 7661 14496  5542]
 [ 5530 15963  5332]
 [ 5445 13774  7482]]
Evaluating performance on  val set...
104/104 - 1s - 1s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0417382
{'0': {'precision': 0.3001949317738791, 'recall': 0.27553675992192583, 'f1-score': 0.28733780001696213, 'support': 6148}, '1': {'precision': 0.5974017232094776, 'recall': 0.6457833078658226, 'f1-score': 0.6206510717157943, 'support': 13743}, '2': {'precision': 0.3251584918251585, 'recall': 0.2952135716449561, 'f1-score': 0.3094633216894252, 'support': 6602}, 'accuracy': 0.4725021703846299, 'macro avg': {'precision': 0.4075850489361717, 'recall': 0.4055112131442349, 'f1-score': 0.40581739780739384, 'support': 26493}, 'weighted avg': {'precision': 0.46058908714163577, 'recall': 0.4725021703846299, 'f1-score': 0.46575462661412553, 'support': 26493}}
[[1694 2905 1549]
 [2372 8875 2496]
 [1577 3076 1949]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.072578
{'0': {'precision': 0.34706927175843694, 'recall': 0.25921995224197397, 'f1-score': 0.29678007290400965, 'support': 7538}, '1': {'precision': 0.4717310924369748, 'recall': 0.6438796109377868, 'f1-score': 0.5445233383773718, 'support': 10898}, '2': {'precision': 0.3754175016700067, 'recall': 0.27901203922055356, 'f1-score': 0.32011391954432183, 'support': 8057}, 'accuracy': 0.42347035065866456, 'macro avg': {'precision': 0.39807262195513954, 'recall': 0.39403720080010474, 'f1-score': 0.3871391102752344, 'support': 26493}, 'weighted avg': {'precision': 0.40697061211823854, 'recall': 0.42347035065866456, 'f1-score': 0.40578648627771946, 'support': 26493}}
[[1954 3802 1782]
 [1923 7017 1958]
 [1753 4056 2248]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0841554
{'0': {'precision': 0.3503472222222222, 'recall': 0.25099502487562186, 'f1-score': 0.29246376811594205, 'support': 8040}, '1': {'precision': 0.42005511123059347, 'recall': 0.6215813028344107, 'f1-score': 0.501323494024224, 'support': 10055}, '2': {'precision': 0.3836692859583191, 'recall': 0.26744462967373184, 'f1-score': 0.31518383384788107, 'support': 8398}, 'accuracy': 0.3968595478050806, 'macro avg': {'precision': 0.38469053980371154, 'recall': 0.3800069857945882, 'f1-score': 0.36965703199601574, 'support': 26493}, 'weighted avg': {'precision': 0.3873664920382081, 'recall': 0.3968595478050806, 'f1-score': 0.37893520041974305, 'support': 26493}}
[[2018 4213 1809]
 [2006 6250 1799]
 [1736 4416 2246]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0879284
{'0': {'precision': 0.3566644340254521, 'recall': 0.2591240875912409, 'f1-score': 0.3001691093573845, 'support': 8220}, '1': {'precision': 0.39632387468974306, 'recall': 0.5996751928542428, 'f1-score': 0.47724059937800395, 'support': 9852}, '2': {'precision': 0.39134307089419307, 'recall': 0.2608953805961287, 'f1-score': 0.31307445671535444, 'support': 8421}, 'accuracy': 0.3863284641225984, 'macro avg': {'precision': 0.3814437932031294, 'recall': 0.37323155368053745, 'f1-score': 0.3634947218169143, 'support': 26493}, 'weighted avg': {'precision': 0.38243552867295383, 'recall': 0.3863284641225984, 'f1-score': 0.3701190678288527, 'support': 26493}}
[[2130 4414 1676]
 [2203 5908 1741]
 [1639 4585 2197]]
training model: results/LILAK/W0/deepLOB_L2/seq2seq
Epoch 1/50
318/318 - 22s - loss: 13.2341 - accuracy10: 0.3586 - accuracy20: 0.3641 - accuracy30: 0.3644 - accuracy50: 0.3638 - val_loss: 13.0865 - val_accuracy10: 0.3669 - val_accuracy20: 0.3698 - val_accuracy30: 0.3682 - val_accuracy50: 0.3680 - 22s/epoch - 68ms/step
Epoch 2/50
318/318 - 15s - loss: 13.0266 - accuracy10: 0.3691 - accuracy20: 0.3870 - accuracy30: 0.3900 - accuracy50: 0.3848 - val_loss: 12.9675 - val_accuracy10: 0.3750 - val_accuracy20: 0.3810 - val_accuracy30: 0.3827 - val_accuracy50: 0.3810 - 15s/epoch - 47ms/step
Epoch 3/50
318/318 - 15s - loss: 12.9293 - accuracy10: 0.3695 - accuracy20: 0.3948 - accuracy30: 0.4012 - accuracy50: 0.3966 - val_loss: 13.0043 - val_accuracy10: 0.3661 - val_accuracy20: 0.3803 - val_accuracy30: 0.3856 - val_accuracy50: 0.3833 - 15s/epoch - 46ms/step
Epoch 4/50
318/318 - 15s - loss: 12.8633 - accuracy10: 0.3782 - accuracy20: 0.4055 - accuracy30: 0.4127 - accuracy50: 0.4042 - val_loss: 12.9137 - val_accuracy10: 0.3942 - val_accuracy20: 0.3938 - val_accuracy30: 0.3915 - val_accuracy50: 0.3860 - 15s/epoch - 46ms/step
Epoch 5/50
318/318 - 15s - loss: 12.8118 - accuracy10: 0.3918 - accuracy20: 0.4153 - accuracy30: 0.4206 - accuracy50: 0.4107 - val_loss: 12.8721 - val_accuracy10: 0.3793 - val_accuracy20: 0.3977 - val_accuracy30: 0.4013 - val_accuracy50: 0.3950 - 15s/epoch - 47ms/step
Epoch 6/50
318/318 - 15s - loss: 12.7589 - accuracy10: 0.4069 - accuracy20: 0.4256 - accuracy30: 0.4278 - accuracy50: 0.4179 - val_loss: 12.8335 - val_accuracy10: 0.4208 - val_accuracy20: 0.4123 - val_accuracy30: 0.4090 - val_accuracy50: 0.4024 - 15s/epoch - 47ms/step
Epoch 7/50
318/318 - 15s - loss: 12.7150 - accuracy10: 0.4184 - accuracy20: 0.4328 - accuracy30: 0.4317 - accuracy50: 0.4203 - val_loss: 12.8449 - val_accuracy10: 0.4298 - val_accuracy20: 0.4164 - val_accuracy30: 0.4090 - val_accuracy50: 0.3991 - 15s/epoch - 47ms/step
Epoch 8/50
318/318 - 15s - loss: 12.6778 - accuracy10: 0.4271 - accuracy20: 0.4393 - accuracy30: 0.4363 - accuracy50: 0.4234 - val_loss: 12.8316 - val_accuracy10: 0.4471 - val_accuracy20: 0.4231 - val_accuracy30: 0.4152 - val_accuracy50: 0.4035 - 15s/epoch - 46ms/step
Epoch 9/50
318/318 - 15s - loss: 12.6425 - accuracy10: 0.4320 - accuracy20: 0.4432 - accuracy30: 0.4403 - accuracy50: 0.4262 - val_loss: 12.8375 - val_accuracy10: 0.4207 - val_accuracy20: 0.4198 - val_accuracy30: 0.4142 - val_accuracy50: 0.4051 - 15s/epoch - 46ms/step
Epoch 10/50
318/318 - 15s - loss: 12.6022 - accuracy10: 0.4414 - accuracy20: 0.4492 - accuracy30: 0.4451 - accuracy50: 0.4286 - val_loss: 12.8407 - val_accuracy10: 0.4277 - val_accuracy20: 0.4234 - val_accuracy30: 0.4167 - val_accuracy50: 0.4042 - 15s/epoch - 46ms/step
Epoch 11/50
318/318 - 15s - loss: 12.5585 - accuracy10: 0.4478 - accuracy20: 0.4547 - accuracy30: 0.4501 - accuracy50: 0.4339 - val_loss: 12.8600 - val_accuracy10: 0.4124 - val_accuracy20: 0.4186 - val_accuracy30: 0.4116 - val_accuracy50: 0.4031 - 15s/epoch - 46ms/step
Epoch 12/50
318/318 - 15s - loss: 12.5273 - accuracy10: 0.4485 - accuracy20: 0.4563 - accuracy30: 0.4527 - accuracy50: 0.4364 - val_loss: 12.9470 - val_accuracy10: 0.3897 - val_accuracy20: 0.4071 - val_accuracy30: 0.4051 - val_accuracy50: 0.3986 - 15s/epoch - 46ms/step
Epoch 13/50
318/318 - 14s - loss: 12.4790 - accuracy10: 0.4580 - accuracy20: 0.4629 - accuracy30: 0.4588 - accuracy50: 0.4407 - val_loss: 12.9441 - val_accuracy10: 0.3976 - val_accuracy20: 0.4172 - val_accuracy30: 0.4132 - val_accuracy50: 0.4049 - 14s/epoch - 46ms/step
Epoch 14/50
318/318 - 14s - loss: 12.4418 - accuracy10: 0.4616 - accuracy20: 0.4667 - accuracy30: 0.4607 - accuracy50: 0.4422 - val_loss: 12.8752 - val_accuracy10: 0.4387 - val_accuracy20: 0.4322 - val_accuracy30: 0.4219 - val_accuracy50: 0.4063 - 14s/epoch - 45ms/step
Epoch 15/50
318/318 - 15s - loss: 12.4033 - accuracy10: 0.4643 - accuracy20: 0.4700 - accuracy30: 0.4658 - accuracy50: 0.4456 - val_loss: 13.0416 - val_accuracy10: 0.4146 - val_accuracy20: 0.4206 - val_accuracy30: 0.4146 - val_accuracy50: 0.4055 - 15s/epoch - 46ms/step
Epoch 16/50
318/318 - 15s - loss: 12.3627 - accuracy10: 0.4673 - accuracy20: 0.4760 - accuracy30: 0.4701 - accuracy50: 0.4490 - val_loss: 13.3737 - val_accuracy10: 0.3528 - val_accuracy20: 0.3914 - val_accuracy30: 0.3983 - val_accuracy50: 0.3882 - 15s/epoch - 46ms/step
Epoch 17/50
318/318 - 15s - loss: 12.3248 - accuracy10: 0.4738 - accuracy20: 0.4801 - accuracy30: 0.4737 - accuracy50: 0.4527 - val_loss: 13.2702 - val_accuracy10: 0.3576 - val_accuracy20: 0.3945 - val_accuracy30: 0.3985 - val_accuracy50: 0.3882 - 15s/epoch - 46ms/step
Epoch 18/50
318/318 - 14s - loss: 12.2967 - accuracy10: 0.4725 - accuracy20: 0.4799 - accuracy30: 0.4736 - accuracy50: 0.4532 - val_loss: 13.3063 - val_accuracy10: 0.3675 - val_accuracy20: 0.3983 - val_accuracy30: 0.4000 - val_accuracy50: 0.3921 - 14s/epoch - 45ms/step
testing model: results/LILAK/W0/deepLOB_L2/seq2seq
Evaluating performance on  test set...
876/876 - 14s - 14s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0169575
{'0': {'precision': 0.28779688981370893, 'recall': 0.5217993079584775, 'f1-score': 0.37098054153572674, 'support': 44795}, '1': {'precision': 0.6669215209964482, 'recall': 0.517147960255756, 'f1-score': 0.5825622730673474, 'support': 133252}, '2': {'precision': 0.33293782030244123, 'recall': 0.28602411728984123, 'f1-score': 0.3077030763308018, 'support': 46108}, 'accuracy': 0.4705360130267003, 'macro avg': {'precision': 0.4292187437041995, 'recall': 0.44165712850135824, 'f1-score': 0.42041529697795865, 'support': 224155}, 'weighted avg': {'precision': 0.522458054531591, 'recall': 0.4705360130267003, 'f1-score': 0.48374220879446667, 'support': 224155}}
[[23374 15078  6343]
 [44261 68911 20080]
 [13582 19338 13188]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.04006
{'0': {'precision': 0.33630438830612625, 'recall': 0.4882404887631337, 'f1-score': 0.3982740624218991, 'support': 55487}, '1': {'precision': 0.5697721782787856, 'recall': 0.5384587839289551, 'f1-score': 0.5536730964840819, 'support': 111704}, '2': {'precision': 0.3853555935322729, 'recall': 0.257302857945369, 'f1-score': 0.30857166917546497, 'support': 56964}, 'accuracy': 0.4545783051906047, 'macro avg': {'precision': 0.43047738670572827, 'recall': 0.4280007102124859, 'f1-score': 0.4201729426938153, 'support': 224155}, 'weighted avg': {'precision': 0.4651145369336748, 'recall': 0.4545783051906047, 'f1-score': 0.45291877956848153, 'support': 224155}}
[[27091 20376  8020]
 [36198 60148 15358]
 [17266 25041 14657]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0500424
{'0': {'precision': 0.35109056186551413, 'recall': 0.47410926365795725, 'f1-score': 0.40343025438165914, 'support': 58940}, '1': {'precision': 0.5345590011333866, 'recall': 0.548495333962462, 'f1-score': 0.541437503822648, 'support': 104907}, '2': {'precision': 0.3971452560873216, 'recall': 0.24313523910592294, 'f1-score': 0.301617830071275, 'support': 60308}, 'accuracy': 0.4467801298208829, 'macro avg': {'precision': 0.4275982730287408, 'recall': 0.4219132789087807, 'f1-score': 0.4154951960918607, 'support': 224155}, 'weighted avg': {'precision': 0.4493466349283656, 'recall': 0.4467801298208829, 'f1-score': 0.440626938960612, 'support': 224155}}
[[27944 22803  8193]
 [33301 57541 14065]
 [18347 27298 14663]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0620153
{'0': {'precision': 0.3528527954976635, 'recall': 0.45403457032850003, 'f1-score': 0.39709970481185336, 'support': 61035}, '1': {'precision': 0.5034009251979302, 'recall': 0.5484089437777003, 'f1-score': 0.524941964945397, 'support': 100405}, '2': {'precision': 0.39491113809471245, 'recall': 0.22817507773259985, 'f1-score': 0.2892340653454741, 'support': 62715}, 'accuracy': 0.4331154781289733, 'macro avg': {'precision': 0.41705495293010203, 'recall': 0.41020619727960006, 'f1-score': 0.40375857836757484, 'support': 224155}, 'weighted avg': {'precision': 0.4320545706912983, 'recall': 0.4331154781289733, 'f1-score': 0.42418457264694276, 'support': 224155}}
[[27712 25102  8221]
 [31637 55063 13705]
 [19188 29217 14310]]
Evaluating performance on  train set...
318/318 - 6s - 6s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0489869
{'0': {'precision': 0.35294968189705034, 'recall': 0.45948235294117645, 'f1-score': 0.3992313039211678, 'support': 21250}, '1': {'precision': 0.5588824895790244, 'recall': 0.44814124971295893, 'f1-score': 0.49742282639478896, 'support': 39193}, '2': {'precision': 0.37064642905542755, 'recall': 0.3947558335337984, 'f1-score': 0.38232142025068727, 'support': 20785}, 'accuracy': 0.4374476781405427, 'macro avg': {'precision': 0.4274928668438341, 'recall': 0.43412647872931126, 'f1-score': 0.42632518352221466, 'support': 81228}, 'weighted avg': {'precision': 0.4568418301854051, 'recall': 0.4374476781405427, 'f1-score': 0.4422823258374737, 'support': 81228}}
[[ 9764  6677  4809]
 [12506 17564  9123]
 [ 5394  7186  8205]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0644937
{'0': {'precision': 0.41849130719429695, 'recall': 0.4444186944766319, 'f1-score': 0.43106548778660275, 'support': 25890}, '1': {'precision': 0.4400447566357929, 'recall': 0.4719018732084528, 'f1-score': 0.455416881111683, 'support': 30002}, '2': {'precision': 0.4305658627087198, 'recall': 0.36639564256394064, 'f1-score': 0.39589730467417267, 'support': 25336}, 'accuracy': 0.4302334170483085, 'macro avg': {'precision': 0.42970064217960324, 'recall': 0.4275720700830085, 'f1-score': 0.42745989119081945, 'support': 81228}, 'weighted avg': {'precision': 0.43021839057265393, 'recall': 0.4302334170483085, 'f1-score': 0.429090422725325, 'support': 81228}}
[[11506  8618  5766]
 [ 9333 14158  6511]
 [ 6655  9398  9283]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0738775
{'0': {'precision': 0.4394039250146456, 'recall': 0.43420528962697635, 'f1-score': 0.4367891394151153, 'support': 27639}, '1': {'precision': 0.39077662519392814, 'recall': 0.4820081798056358, 'f1-score': 0.4316242188024999, 'support': 26651}, '2': {'precision': 0.4453737584945112, 'recall': 0.3479100155913579, 'f1-score': 0.3906546341260082, 'support': 26938}, 'accuracy': 0.4212709902989117, 'macro avg': {'precision': 0.42518476956769496, 'recall': 0.42137449500799, 'f1-score': 0.4196893307812078, 'support': 81228}, 'weighted avg': {'precision': 0.42542905436362227, 'recall': 0.4212709902989117, 'f1-score': 0.41979473351167335, 'support': 81228}}
[[12001  9603  6035]
 [ 8169 12846  5636]
 [ 7142 10424  9372]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0820131
{'0': {'precision': 0.433461339635182, 'recall': 0.4241887692418877, 'f1-score': 0.4287749287749288, 'support': 27674}, '1': {'precision': 0.3755451992591265, 'recall': 0.46938242102904937, 'f1-score': 0.41725305363781195, 'support': 26782}, '2': {'precision': 0.42700270897832815, 'recall': 0.32971014492753625, 'f1-score': 0.3721018463873198, 'support': 26772}, 'accuracy': 0.4079504604323632, 'macro avg': {'precision': 0.41200308262421226, 'recall': 0.40776044506615783, 'f1-score': 0.40604327626668685, 'support': 81228}, 'weighted avg': {'precision': 0.412236878470352, 'recall': 0.4079504604323632, 'f1-score': 0.40629708096871253, 'support': 81228}}
[[11739 10023  5912]
 [ 8278 12571  5933]
 [ 7065 10880  8827]]
Evaluating performance on  val set...
104/104 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0414028
{'0': {'precision': 0.3291619797525309, 'recall': 0.3752805386341776, 'f1-score': 0.35071161048689137, 'support': 6238}, '1': {'precision': 0.5755925688661114, 'recall': 0.5242123687281214, 'f1-score': 0.548702290076336, 'support': 13712}, '2': {'precision': 0.33483243870593354, 'recall': 0.35274338988231696, 'f1-score': 0.3435546293539744, 'support': 6543}, 'accuracy': 0.44679726720265733, 'macro avg': {'precision': 0.41319566244152534, 'recall': 0.41741209908153865, 'f1-score': 0.41432284330573393, 'support': 26493}, 'weighted avg': {'precision': 0.4581076654377131, 'recall': 0.44679726720265733, 'f1-score': 0.451418214909863, 'support': 26493}}
[[2341 2433 1464]
 [3403 7188 3121]
 [1368 2867 2308]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.067457
{'0': {'precision': 0.38011777902411664, 'recall': 0.3571334475036227, 'f1-score': 0.3682673368199416, 'support': 7591}, '1': {'precision': 0.4643870154427986, 'recall': 0.5421265636497424, 'f1-score': 0.5002546257002206, 'support': 10872}, '2': {'precision': 0.3937621832358674, 'recall': 0.32702366127023663, 'f1-score': 0.35730321790598, 'support': 8030}, 'accuracy': 0.42392330049447025, 'macro avg': {'precision': 0.4127556592342609, 'recall': 0.4087612241412006, 'f1-score': 0.40860839347538075, 'support': 26493}, 'weighted avg': {'precision': 0.4188351649058314, 'recall': 0.42392330049447025, 'f1-score': 0.41910808455810955, 'support': 26493}}
[[2711 3100 1780]
 [2715 5894 2263]
 [1706 3698 2626]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0742568
{'0': {'precision': 0.39873595505617976, 'recall': 0.3506236877855996, 'f1-score': 0.37313530919366494, 'support': 8097}, '1': {'precision': 0.42803883495145634, 'recall': 0.5482491046557899, 'f1-score': 0.4807432285078728, 'support': 10052}, '2': {'precision': 0.40920283164050475, 'recall': 0.31867209971236815, 'f1-score': 0.35830750572699094, 'support': 8344}, 'accuracy': 0.41554372853206506, 'macro avg': {'precision': 0.4119925405493803, 'recall': 0.4058482973845859, 'f1-score': 0.40406201447617623, 'support': 26493}, 'weighted avg': {'precision': 0.4131506369316536, 'recall': 0.41554372853206506, 'f1-score': 0.4092939780050676, 'support': 26493}}
[[2839 3425 1833]
 [2535 5511 2006]
 [1746 3939 2659]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0841551
{'0': {'precision': 0.3885770418186921, 'recall': 0.3364111286599441, 'f1-score': 0.36061730806798203, 'support': 8231}, '1': {'precision': 0.4084355000385535, 'recall': 0.5372755857592048, 'f1-score': 0.46407920098125116, 'support': 9859}, '2': {'precision': 0.40059393560487655, 'recall': 0.3050101154349637, 'f1-score': 0.3463279508141342, 'support': 8403}, 'accuracy': 0.40120031706488507, 'macro avg': {'precision': 0.3992021591540407, 'recall': 0.39289894328470415, 'f1-score': 0.3903414866211225, 'support': 26493}, 'weighted avg': {'precision': 0.39977858555005213, 'recall': 0.40120031706488507, 'f1-score': 0.39458693526112126, 'support': 26493}}
[[2769 3613 1849]
 [2576 5297 1986]
 [1781 4059 2563]]
training model: results/LILAK/W0/deepOF_L2/seq2seq
Epoch 1/50
318/318 - 14s - loss: 13.1997 - accuracy10: 0.3808 - accuracy20: 0.3722 - accuracy30: 0.3654 - accuracy50: 0.3570 - val_loss: 12.9761 - val_accuracy10: 0.4905 - val_accuracy20: 0.4248 - val_accuracy30: 0.3921 - val_accuracy50: 0.3724 - 14s/epoch - 45ms/step
Epoch 2/50
318/318 - 9s - loss: 13.0104 - accuracy10: 0.4213 - accuracy20: 0.4038 - accuracy30: 0.3940 - accuracy50: 0.3802 - val_loss: 12.8201 - val_accuracy10: 0.5048 - val_accuracy20: 0.4426 - val_accuracy30: 0.4080 - val_accuracy50: 0.3810 - 9s/epoch - 29ms/step
Epoch 3/50
318/318 - 9s - loss: 12.8848 - accuracy10: 0.4399 - accuracy20: 0.4230 - accuracy30: 0.4119 - accuracy50: 0.3937 - val_loss: 12.7496 - val_accuracy10: 0.5100 - val_accuracy20: 0.4519 - val_accuracy30: 0.4193 - val_accuracy50: 0.3942 - 9s/epoch - 28ms/step
Epoch 4/50
318/318 - 9s - loss: 12.7920 - accuracy10: 0.4550 - accuracy20: 0.4365 - accuracy30: 0.4237 - accuracy50: 0.4040 - val_loss: 12.7279 - val_accuracy10: 0.5181 - val_accuracy20: 0.4573 - val_accuracy30: 0.4238 - val_accuracy50: 0.3982 - 9s/epoch - 29ms/step
Epoch 5/50
318/318 - 9s - loss: 12.7276 - accuracy10: 0.4589 - accuracy20: 0.4416 - accuracy30: 0.4301 - accuracy50: 0.4087 - val_loss: 12.6552 - val_accuracy10: 0.5107 - val_accuracy20: 0.4582 - val_accuracy30: 0.4296 - val_accuracy50: 0.4026 - 9s/epoch - 28ms/step
Epoch 6/50
318/318 - 9s - loss: 12.6512 - accuracy10: 0.4620 - accuracy20: 0.4501 - accuracy30: 0.4379 - accuracy50: 0.4168 - val_loss: 12.6201 - val_accuracy10: 0.5077 - val_accuracy20: 0.4617 - val_accuracy30: 0.4335 - val_accuracy50: 0.4069 - 9s/epoch - 28ms/step
Epoch 7/50
318/318 - 9s - loss: 12.6009 - accuracy10: 0.4641 - accuracy20: 0.4548 - accuracy30: 0.4434 - accuracy50: 0.4225 - val_loss: 12.6239 - val_accuracy10: 0.5110 - val_accuracy20: 0.4630 - val_accuracy30: 0.4343 - val_accuracy50: 0.4058 - 9s/epoch - 28ms/step
Epoch 8/50
318/318 - 9s - loss: 12.5397 - accuracy10: 0.4679 - accuracy20: 0.4604 - accuracy30: 0.4511 - accuracy50: 0.4285 - val_loss: 12.6569 - val_accuracy10: 0.5026 - val_accuracy20: 0.4594 - val_accuracy30: 0.4326 - val_accuracy50: 0.4079 - 9s/epoch - 28ms/step
Epoch 9/50
318/318 - 9s - loss: 12.4814 - accuracy10: 0.4685 - accuracy20: 0.4658 - accuracy30: 0.4576 - accuracy50: 0.4344 - val_loss: 12.6690 - val_accuracy10: 0.4978 - val_accuracy20: 0.4601 - val_accuracy30: 0.4347 - val_accuracy50: 0.4084 - 9s/epoch - 27ms/step
Epoch 10/50
318/318 - 9s - loss: 12.4319 - accuracy10: 0.4702 - accuracy20: 0.4707 - accuracy30: 0.4633 - accuracy50: 0.4394 - val_loss: 12.6973 - val_accuracy10: 0.4962 - val_accuracy20: 0.4586 - val_accuracy30: 0.4322 - val_accuracy50: 0.4094 - 9s/epoch - 27ms/step
Epoch 11/50
318/318 - 9s - loss: 12.3762 - accuracy10: 0.4717 - accuracy20: 0.4729 - accuracy30: 0.4670 - accuracy50: 0.4445 - val_loss: 12.7632 - val_accuracy10: 0.4964 - val_accuracy20: 0.4576 - val_accuracy30: 0.4311 - val_accuracy50: 0.4078 - 9s/epoch - 27ms/step
Epoch 12/50
318/318 - 9s - loss: 12.3214 - accuracy10: 0.4746 - accuracy20: 0.4803 - accuracy30: 0.4732 - accuracy50: 0.4496 - val_loss: 12.7870 - val_accuracy10: 0.4816 - val_accuracy20: 0.4496 - val_accuracy30: 0.4262 - val_accuracy50: 0.4074 - 9s/epoch - 28ms/step
Epoch 13/50
318/318 - 9s - loss: 12.2639 - accuracy10: 0.4741 - accuracy20: 0.4831 - accuracy30: 0.4775 - accuracy50: 0.4558 - val_loss: 12.8051 - val_accuracy10: 0.4895 - val_accuracy20: 0.4526 - val_accuracy30: 0.4322 - val_accuracy50: 0.4154 - 9s/epoch - 28ms/step
Epoch 14/50
318/318 - 9s - loss: 12.2230 - accuracy10: 0.4738 - accuracy20: 0.4851 - accuracy30: 0.4811 - accuracy50: 0.4584 - val_loss: 12.7818 - val_accuracy10: 0.4821 - val_accuracy20: 0.4494 - val_accuracy30: 0.4283 - val_accuracy50: 0.4129 - 9s/epoch - 28ms/step
Epoch 15/50
318/318 - 9s - loss: 12.1598 - accuracy10: 0.4742 - accuracy20: 0.4882 - accuracy30: 0.4870 - accuracy50: 0.4665 - val_loss: 12.7999 - val_accuracy10: 0.4693 - val_accuracy20: 0.4431 - val_accuracy30: 0.4235 - val_accuracy50: 0.4109 - 9s/epoch - 27ms/step
Epoch 16/50
318/318 - 9s - loss: 12.0965 - accuracy10: 0.4796 - accuracy20: 0.4944 - accuracy30: 0.4927 - accuracy50: 0.4707 - val_loss: 12.9143 - val_accuracy10: 0.4599 - val_accuracy20: 0.4375 - val_accuracy30: 0.4196 - val_accuracy50: 0.4063 - 9s/epoch - 28ms/step
testing model: results/LILAK/W0/deepOF_L2/seq2seq
Evaluating performance on  test set...
876/876 - 8s - 8s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.942713
{'0': {'precision': 0.3748808563677689, 'recall': 0.342434254587668, 'f1-score': 0.3579237204092824, 'support': 44794}, '1': {'precision': 0.7151573015392497, 'recall': 0.6914296435272045, 'f1-score': 0.7030933420838754, 'support': 133250}, '2': {'precision': 0.365561355782663, 'recall': 0.43135383681082723, 'f1-score': 0.3957417172420654, 'support': 46106}, 'accuracy': 0.5681909435645773, 'macro avg': {'precision': 0.48519983789656057, 'recall': 0.4884059116418999, 'f1-score': 0.4855862599117411, 'support': 224150}, 'weighted avg': {'precision': 0.5752473583759016, 'recall': 0.5681909435645773, 'f1-score': 0.5708948944004125, 'support': 224150}}
[[15339 18627 10828]
 [17429 92133 23688]
 [ 8149 18069 19888]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.99153554
{'0': {'precision': 0.40503153669724773, 'recall': 0.30553653173773565, 'f1-score': 0.34831830042530465, 'support': 55486}, '1': {'precision': 0.6086605305060391, 'recall': 0.7015272779359367, 'f1-score': 0.6518026841674048, 'support': 111702}, '2': {'precision': 0.4130049113895684, 'recall': 0.3882588392261508, 'f1-score': 0.4002497488937753, 'support': 56962}, 'accuracy': 0.5238947133615882, 'macro avg': {'precision': 0.4755656595309517, 'recall': 0.4651075496332744, 'f1-score': 0.46679024449549494, 'support': 224150}, 'weighted avg': {'precision': 0.5085334114938285, 'recall': 0.5238947133615882, 'f1-score': 0.512752526615004, 'support': 224150}}
[[16953 25561 12972]
 [14879 78362 18461]
 [10024 24822 22116]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0193573
{'0': {'precision': 0.39844263064077307, 'recall': 0.28823020410933337, 'f1-score': 0.3344917548609402, 'support': 58939}, '1': {'precision': 0.5590662323561346, 'recall': 0.6871550450407512, 'f1-score': 0.616528042079155, 'support': 104905}, '2': {'precision': 0.4132651120325636, 'recall': 0.36027924252976484, 'f1-score': 0.38495747696669025, 'support': 60306}, 'accuracy': 0.4943163060450591, 'macro avg': {'precision': 0.45692465834315715, 'recall': 0.4452214972266164, 'f1-score': 0.4453257579689285, 'support': 224150}, 'weighted avg': {'precision': 0.4776043683198421, 'recall': 0.4943163060450591, 'f1-score': 0.4800657122463347, 'support': 224150}}
[[16988 28957 12994]
 [14966 72086 17853]
 [10682 27897 21727]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.047284
{'0': {'precision': 0.366041054361158, 'recall': 0.259150637349674, 'f1-score': 0.30345819943402563, 'support': 61034}, '1': {'precision': 0.5070932898401317, 'recall': 0.6564843679969722, 'f1-score': 0.5721987108535711, 'support': 100403}, '2': {'precision': 0.39680514943972367, 'recall': 0.3224211885892877, 'f1-score': 0.35576669305885456, 'support': 62713}, 'accuracy': 0.45482935534240465, 'macro avg': {'precision': 0.42331316454700446, 'recall': 0.4126853979786446, 'f1-score': 0.41047453444881715, 'support': 224150}, 'weighted avg': {'precision': 0.4378294830627305, 'recall': 0.45482935534240465, 'f1-score': 0.43846946924776875, 'support': 224150}}
[[15817 32859 12358]
 [16111 65913 18379]
 [11283 31210 20220]]
Evaluating performance on  train set...
318/318 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0025055
{'0': {'precision': 0.4114707799261351, 'recall': 0.35628291948833707, 'f1-score': 0.3818933360217764, 'support': 21264}, '1': {'precision': 0.5886548428510294, 'recall': 0.6322616889252062, 'f1-score': 0.6096795242726815, 'support': 39161}, '2': {'precision': 0.40904052816731723, 'recall': 0.40807692307692306, 'f1-score': 0.4085581574450675, 'support': 20800}, 'accuracy': 0.5026038781163434, 'macro avg': {'precision': 0.46972205031482733, 'recall': 0.46554051049682205, 'f1-score': 0.46671033924650845, 'support': 81225}, 'weighted avg': {'precision': 0.4962741760679434, 'recall': 0.5026038781163434, 'f1-score': 0.4985441603209225, 'support': 81225}}
[[ 7576  9072  4616]
 [ 6754 24760  7647]
 [ 4082  8230  8488]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0407379
{'0': {'precision': 0.4645154373927959, 'recall': 0.33398851504990945, 'f1-score': 0.3885837275519584, 'support': 25947}, '1': {'precision': 0.45792354906746924, 'recall': 0.6448523277156682, 'f1-score': 0.5355450236966824, 'support': 29965}, '2': {'precision': 0.4639210681327312, 'recall': 0.3733654643858887, 'f1-score': 0.413746306227427, 'support': 25313}, 'accuracy': 0.46094182825484764, 'macro avg': {'precision': 0.46212001819766546, 'recall': 0.4507354357171554, 'f1-score': 0.4459583524920226, 'support': 81225}, 'weighted avg': {'precision': 0.4618983711847512, 'recall': 0.46094182825484764, 'f1-score': 0.45064141413846254, 'support': 81225}}
[[ 8666 11863  5418]
 [ 5139 19323  5503]
 [ 4851 11011  9451]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0614638
{'0': {'precision': 0.4713311842731068, 'recall': 0.32263782375922445, 'f1-score': 0.3830609659200722, 'support': 27644}, '1': {'precision': 0.39879915234283025, 'recall': 0.6354393336834997, 'f1-score': 0.4900468722874833, 'support': 26654}, '2': {'precision': 0.4723174667204518, 'recall': 0.3478664537453114, 'f1-score': 0.4006501422186103, 'support': 26927}, 'accuracy': 0.43364727608494924, 'macro avg': {'precision': 0.44748260111212956, 'recall': 0.43531453706267853, 'f1-score': 0.4245859934753886, 'support': 81225}, 'weighted avg': {'precision': 0.44785674719573, 'recall': 0.43364727608494924, 'f1-score': 0.42399942204205077, 'support': 81225}}
[[ 8919 13224  5501]
 [ 4753 16937  4964]
 [ 5251 12309  9367]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0766746
{'0': {'precision': 0.44475861346737877, 'recall': 0.3066536698075743, 'f1-score': 0.36301472316601496, 'support': 27699}, '1': {'precision': 0.37348865327380953, 'recall': 0.598807082945014, 'f1-score': 0.4600403820543296, 'support': 26825}, '2': {'precision': 0.44474083372561324, 'recall': 0.31845249241601437, 'f1-score': 0.37114797031863817, 'support': 26701}, 'accuracy': 0.4070175438596491, 'macro avg': {'precision': 0.42099603348893383, 'recall': 0.4079710817228675, 'f1-score': 0.39806769184632756, 'support': 81225}, 'weighted avg': {'precision': 0.4212154750361399, 'recall': 0.4070175438596491, 'f1-score': 0.39773160998535917, 'support': 81225}}
[[ 8494 13943  5262]
 [ 5408 16063  5354]
 [ 5196 13002  8503]]
Evaluating performance on  val set...
104/104 - 1s - 1s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.99859
{'0': {'precision': 0.3624281609195402, 'recall': 0.3282368249837345, 'f1-score': 0.34448617275520654, 'support': 6148}, '1': {'precision': 0.6280748475716589, 'recall': 0.6521138033908171, 'f1-score': 0.6398686277309724, 'support': 13743}, '2': {'precision': 0.3740985576923077, 'recall': 0.37715843683732203, 'f1-score': 0.3756222658017801, 'support': 6602}, 'accuracy': 0.5084361906918808, 'macro avg': {'precision': 0.45486718872783555, 'recall': 0.45250302173729123, 'f1-score': 0.45332568876265306, 'support': 26493}, 'weighted avg': {'precision': 0.5031381739099104, 'recall': 0.5084361906918808, 'f1-score': 0.5054721526376446, 'support': 26493}}
[[2018 2622 1508]
 [2123 8962 2658]
 [1427 2685 2490]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0417833
{'0': {'precision': 0.40579964850615113, 'recall': 0.30631467232687715, 'f1-score': 0.349107952827336, 'support': 7538}, '1': {'precision': 0.5014991981033401, 'recall': 0.6599376032299504, 'f1-score': 0.569911644676889, 'support': 10898}, '2': {'precision': 0.4226245744351594, 'recall': 0.33895991063671344, 'f1-score': 0.37619670776224257, 'support': 8057}, 'accuracy': 0.4617068659645944, 'macro avg': {'precision': 0.44330780701488354, 'recall': 0.43507072873118036, 'f1-score': 0.43173876842215586, 'support': 26493}, 'weighted avg': {'precision': 0.45028279951661376, 'recall': 0.4617068659645944, 'f1-score': 0.4481746018397911, 'support': 26493}}
[[2309 3507 1722]
 [1697 7192 2009]
 [1684 3642 2731]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0642797
{'0': {'precision': 0.4048275862068966, 'recall': 0.29203980099502486, 'f1-score': 0.3393063583815029, 'support': 8040}, '1': {'precision': 0.4441129535835704, 'recall': 0.6365987071108901, 'f1-score': 0.5232139937878044, 'support': 10055}, '2': {'precision': 0.4296178343949045, 'recall': 0.3212669683257919, 'f1-score': 0.3676250170322933, 'support': 8398}, 'accuracy': 0.43207639753897253, 'macro avg': {'precision': 0.4261861247284571, 'recall': 0.41663515881056895, 'f1-score': 0.41004845640053356, 'support': 26493}, 'weighted avg': {'precision': 0.4275959730734404, 'recall': 0.43207639753897253, 'f1-score': 0.41808231313784233, 'support': 26493}}
[[2348 3995 1697]
 [1769 6401 1885]
 [1683 4017 2698]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0780351
{'0': {'precision': 0.38663933025798736, 'recall': 0.27530413625304134, 'f1-score': 0.32160875435230585, 'support': 8220}, '1': {'precision': 0.4103986847513358, 'recall': 0.6080998781973204, 'f1-score': 0.49006134969325144, 'support': 9852}, '2': {'precision': 0.4170804369414101, 'recall': 0.29925187032418954, 'f1-score': 0.34847542003733667, 'support': 8421}, 'accuracy': 0.40667346091420375, 'macro avg': {'precision': 0.40470615065024446, 'recall': 0.3942186282581837, 'f1-score': 0.386715174694298, 'support': 26493}, 'weighted avg': {'precision': 0.40515070004810444, 'recall': 0.40667346091420375, 'f1-score': 0.39279129921444456, 'support': 26493}}
[[2263 4319 1638]
 [1977 5991 1884]
 [1613 4288 2520]]
training model: results/LILAK/W0/deepVOL_L2/seq2seq
Epoch 1/50
318/318 - 14s - loss: 13.2187 - accuracy10: 0.3590 - accuracy20: 0.3686 - accuracy30: 0.3706 - accuracy50: 0.3679 - val_loss: 13.1247 - val_accuracy10: 0.3868 - val_accuracy20: 0.3773 - val_accuracy30: 0.3707 - val_accuracy50: 0.3654 - 14s/epoch - 45ms/step
Epoch 2/50
318/318 - 9s - loss: 13.0914 - accuracy10: 0.3567 - accuracy20: 0.3765 - accuracy30: 0.3806 - accuracy50: 0.3804 - val_loss: 13.0534 - val_accuracy10: 0.3963 - val_accuracy20: 0.3869 - val_accuracy30: 0.3783 - val_accuracy50: 0.3741 - 9s/epoch - 27ms/step
Epoch 3/50
318/318 - 9s - loss: 13.0236 - accuracy10: 0.3665 - accuracy20: 0.3864 - accuracy30: 0.3916 - accuracy50: 0.3890 - val_loss: 13.0279 - val_accuracy10: 0.4001 - val_accuracy20: 0.3955 - val_accuracy30: 0.3910 - val_accuracy50: 0.3865 - 9s/epoch - 27ms/step
Epoch 4/50
318/318 - 9s - loss: 12.9364 - accuracy10: 0.3723 - accuracy20: 0.3986 - accuracy30: 0.4055 - accuracy50: 0.4020 - val_loss: 13.0618 - val_accuracy10: 0.3722 - val_accuracy20: 0.3830 - val_accuracy30: 0.3789 - val_accuracy50: 0.3767 - 9s/epoch - 27ms/step
Epoch 5/50
318/318 - 9s - loss: 12.8586 - accuracy10: 0.3897 - accuracy20: 0.4123 - accuracy30: 0.4150 - accuracy50: 0.4129 - val_loss: 13.0448 - val_accuracy10: 0.3748 - val_accuracy20: 0.3863 - val_accuracy30: 0.3822 - val_accuracy50: 0.3781 - 9s/epoch - 27ms/step
Epoch 6/50
318/318 - 9s - loss: 12.7912 - accuracy10: 0.3976 - accuracy20: 0.4197 - accuracy30: 0.4259 - accuracy50: 0.4209 - val_loss: 13.1546 - val_accuracy10: 0.3612 - val_accuracy20: 0.3799 - val_accuracy30: 0.3784 - val_accuracy50: 0.3756 - 9s/epoch - 27ms/step
Epoch 7/50
318/318 - 8s - loss: 12.7477 - accuracy10: 0.4044 - accuracy20: 0.4263 - accuracy30: 0.4306 - accuracy50: 0.4263 - val_loss: 13.1247 - val_accuracy10: 0.3516 - val_accuracy20: 0.3783 - val_accuracy30: 0.3803 - val_accuracy50: 0.3786 - 8s/epoch - 26ms/step
Epoch 8/50
318/318 - 9s - loss: 12.7055 - accuracy10: 0.4139 - accuracy20: 0.4340 - accuracy30: 0.4363 - accuracy50: 0.4301 - val_loss: 12.9851 - val_accuracy10: 0.3733 - val_accuracy20: 0.3909 - val_accuracy30: 0.3908 - val_accuracy50: 0.3897 - 9s/epoch - 27ms/step
Epoch 9/50
318/318 - 9s - loss: 12.6653 - accuracy10: 0.4210 - accuracy20: 0.4374 - accuracy30: 0.4392 - accuracy50: 0.4316 - val_loss: 13.0390 - val_accuracy10: 0.3724 - val_accuracy20: 0.3924 - val_accuracy30: 0.3903 - val_accuracy50: 0.3878 - 9s/epoch - 27ms/step
Epoch 10/50
318/318 - 9s - loss: 12.6289 - accuracy10: 0.4243 - accuracy20: 0.4412 - accuracy30: 0.4438 - accuracy50: 0.4336 - val_loss: 13.0028 - val_accuracy10: 0.3739 - val_accuracy20: 0.3937 - val_accuracy30: 0.3926 - val_accuracy50: 0.3894 - 9s/epoch - 28ms/step
Epoch 11/50
318/318 - 9s - loss: 12.6050 - accuracy10: 0.4288 - accuracy20: 0.4444 - accuracy30: 0.4462 - accuracy50: 0.4378 - val_loss: 12.9299 - val_accuracy10: 0.3861 - val_accuracy20: 0.4014 - val_accuracy30: 0.3988 - val_accuracy50: 0.3933 - 9s/epoch - 28ms/step
Epoch 12/50
318/318 - 9s - loss: 12.5642 - accuracy10: 0.4371 - accuracy20: 0.4492 - accuracy30: 0.4498 - accuracy50: 0.4390 - val_loss: 13.0853 - val_accuracy10: 0.3781 - val_accuracy20: 0.3957 - val_accuracy30: 0.3933 - val_accuracy50: 0.3870 - 9s/epoch - 27ms/step
Epoch 13/50
318/318 - 9s - loss: 12.5428 - accuracy10: 0.4416 - accuracy20: 0.4530 - accuracy30: 0.4518 - accuracy50: 0.4411 - val_loss: 12.9464 - val_accuracy10: 0.4037 - val_accuracy20: 0.4124 - val_accuracy30: 0.4081 - val_accuracy50: 0.3994 - 9s/epoch - 28ms/step
Epoch 14/50
318/318 - 9s - loss: 12.5097 - accuracy10: 0.4448 - accuracy20: 0.4571 - accuracy30: 0.4574 - accuracy50: 0.4451 - val_loss: 12.9271 - val_accuracy10: 0.4077 - val_accuracy20: 0.4117 - val_accuracy30: 0.4066 - val_accuracy50: 0.4006 - 9s/epoch - 27ms/step
Epoch 15/50
318/318 - 9s - loss: 12.4737 - accuracy10: 0.4490 - accuracy20: 0.4597 - accuracy30: 0.4594 - accuracy50: 0.4472 - val_loss: 12.9073 - val_accuracy10: 0.4125 - val_accuracy20: 0.4166 - val_accuracy30: 0.4126 - val_accuracy50: 0.4052 - 9s/epoch - 27ms/step
Epoch 16/50
318/318 - 9s - loss: 12.4554 - accuracy10: 0.4510 - accuracy20: 0.4623 - accuracy30: 0.4609 - accuracy50: 0.4484 - val_loss: 12.8919 - val_accuracy10: 0.4177 - val_accuracy20: 0.4205 - val_accuracy30: 0.4145 - val_accuracy50: 0.4049 - 9s/epoch - 28ms/step
Epoch 17/50
318/318 - 9s - loss: 12.4164 - accuracy10: 0.4560 - accuracy20: 0.4663 - accuracy30: 0.4656 - accuracy50: 0.4518 - val_loss: 12.8555 - val_accuracy10: 0.4176 - val_accuracy20: 0.4197 - val_accuracy30: 0.4125 - val_accuracy50: 0.4076 - 9s/epoch - 28ms/step
Epoch 18/50
318/318 - 9s - loss: 12.3958 - accuracy10: 0.4599 - accuracy20: 0.4692 - accuracy30: 0.4682 - accuracy50: 0.4548 - val_loss: 12.8638 - val_accuracy10: 0.4155 - val_accuracy20: 0.4184 - val_accuracy30: 0.4144 - val_accuracy50: 0.4081 - 9s/epoch - 27ms/step
Epoch 19/50
318/318 - 9s - loss: 12.3729 - accuracy10: 0.4612 - accuracy20: 0.4716 - accuracy30: 0.4691 - accuracy50: 0.4546 - val_loss: 12.8088 - val_accuracy10: 0.4343 - val_accuracy20: 0.4261 - val_accuracy30: 0.4170 - val_accuracy50: 0.4091 - 9s/epoch - 27ms/step
Epoch 20/50
318/318 - 9s - loss: 12.3482 - accuracy10: 0.4644 - accuracy20: 0.4727 - accuracy30: 0.4718 - accuracy50: 0.4567 - val_loss: 12.8537 - val_accuracy10: 0.4259 - val_accuracy20: 0.4247 - val_accuracy30: 0.4149 - val_accuracy50: 0.4070 - 9s/epoch - 27ms/step
Epoch 21/50
318/318 - 9s - loss: 12.3395 - accuracy10: 0.4646 - accuracy20: 0.4723 - accuracy30: 0.4712 - accuracy50: 0.4560 - val_loss: 12.8063 - val_accuracy10: 0.4318 - val_accuracy20: 0.4284 - val_accuracy30: 0.4211 - val_accuracy50: 0.4080 - 9s/epoch - 28ms/step
Epoch 22/50
318/318 - 9s - loss: 12.3025 - accuracy10: 0.4685 - accuracy20: 0.4779 - accuracy30: 0.4755 - accuracy50: 0.4621 - val_loss: 12.8654 - val_accuracy10: 0.4192 - val_accuracy20: 0.4221 - val_accuracy30: 0.4161 - val_accuracy50: 0.4106 - 9s/epoch - 27ms/step
Epoch 23/50
318/318 - 9s - loss: 12.2919 - accuracy10: 0.4692 - accuracy20: 0.4792 - accuracy30: 0.4782 - accuracy50: 0.4611 - val_loss: 12.8558 - val_accuracy10: 0.4234 - val_accuracy20: 0.4229 - val_accuracy30: 0.4157 - val_accuracy50: 0.4049 - 9s/epoch - 27ms/step
Epoch 24/50
318/318 - 9s - loss: 12.2569 - accuracy10: 0.4706 - accuracy20: 0.4806 - accuracy30: 0.4795 - accuracy50: 0.4628 - val_loss: 12.8767 - val_accuracy10: 0.4183 - val_accuracy20: 0.4201 - val_accuracy30: 0.4141 - val_accuracy50: 0.4047 - 9s/epoch - 28ms/step
Epoch 25/50
318/318 - 9s - loss: 12.2379 - accuracy10: 0.4721 - accuracy20: 0.4837 - accuracy30: 0.4808 - accuracy50: 0.4647 - val_loss: 12.8726 - val_accuracy10: 0.4241 - val_accuracy20: 0.4287 - val_accuracy30: 0.4212 - val_accuracy50: 0.4093 - 9s/epoch - 27ms/step
Epoch 26/50
318/318 - 9s - loss: 12.2181 - accuracy10: 0.4730 - accuracy20: 0.4852 - accuracy30: 0.4825 - accuracy50: 0.4650 - val_loss: 12.8565 - val_accuracy10: 0.4327 - val_accuracy20: 0.4270 - val_accuracy30: 0.4209 - val_accuracy50: 0.4077 - 9s/epoch - 28ms/step
Epoch 27/50
318/318 - 9s - loss: 12.2021 - accuracy10: 0.4744 - accuracy20: 0.4860 - accuracy30: 0.4850 - accuracy50: 0.4672 - val_loss: 12.8736 - val_accuracy10: 0.4333 - val_accuracy20: 0.4297 - val_accuracy30: 0.4198 - val_accuracy50: 0.4055 - 9s/epoch - 27ms/step
Epoch 28/50
318/318 - 9s - loss: 12.1775 - accuracy10: 0.4743 - accuracy20: 0.4878 - accuracy30: 0.4863 - accuracy50: 0.4689 - val_loss: 12.9318 - val_accuracy10: 0.4191 - val_accuracy20: 0.4242 - val_accuracy30: 0.4144 - val_accuracy50: 0.4031 - 9s/epoch - 27ms/step
Epoch 29/50
318/318 - 9s - loss: 12.1615 - accuracy10: 0.4760 - accuracy20: 0.4876 - accuracy30: 0.4864 - accuracy50: 0.4708 - val_loss: 12.9186 - val_accuracy10: 0.4247 - val_accuracy20: 0.4251 - val_accuracy30: 0.4178 - val_accuracy50: 0.4059 - 9s/epoch - 27ms/step
Epoch 30/50
318/318 - 9s - loss: 12.1324 - accuracy10: 0.4767 - accuracy20: 0.4904 - accuracy30: 0.4902 - accuracy50: 0.4733 - val_loss: 12.9781 - val_accuracy10: 0.4117 - val_accuracy20: 0.4199 - val_accuracy30: 0.4136 - val_accuracy50: 0.4024 - 9s/epoch - 27ms/step
Epoch 31/50
318/318 - 9s - loss: 12.1218 - accuracy10: 0.4763 - accuracy20: 0.4900 - accuracy30: 0.4908 - accuracy50: 0.4744 - val_loss: 12.9416 - val_accuracy10: 0.4211 - val_accuracy20: 0.4210 - val_accuracy30: 0.4135 - val_accuracy50: 0.4033 - 9s/epoch - 27ms/step
testing model: results/LILAK/W0/deepVOL_L2/seq2seq
Evaluating performance on  test set...
876/876 - 8s - 8s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0296437
{'0': {'precision': 0.3121752738654147, 'recall': 0.3339881683223574, 'f1-score': 0.3227135461604832, 'support': 44795}, '1': {'precision': 0.7015459294043159, 'recall': 0.4989193407978867, 'f1-score': 0.5831319594591631, 'support': 133252}, '2': {'precision': 0.296814582949733, 'recall': 0.5244209247852867, 'f1-score': 0.37907707743801583, 'support': 46108}, 'accuracy': 0.47120519283531487, 'macro avg': {'precision': 0.4368452620731546, 'recall': 0.45244281130184355, 'f1-score': 0.42830752768588737, 'support': 224155}, 'weighted avg': {'precision': 0.5404823286049003, 'recall': 0.47120519283531487, 'f1-score': 0.4891166337963609, 'support': 224155}}
[[14961 14101 15733]
 [25218 66482 41552]
 [ 7746 14182 24180]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0435177
{'0': {'precision': 0.3607989019077364, 'recall': 0.32686935678627427, 'f1-score': 0.34299708763568976, 'support': 55487}, '1': {'precision': 0.6085598923283984, 'recall': 0.5059800902384874, 'f1-score': 0.5525493819013682, 'support': 111704}, '2': {'precision': 0.34750836306180644, 'recall': 0.49420686749526016, 'f1-score': 0.4080739264359486, 'support': 56964}, 'accuracy': 0.4586513796257054, 'macro avg': {'precision': 0.4389557190993137, 'recall': 0.44235210484000725, 'f1-score': 0.4345401319910021, 'support': 224155}, 'weighted avg': {'precision': 0.48088906906497164, 'recall': 0.4586513796257054, 'f1-score': 0.4639618955769415, 'support': 224155}}
[[18137 18077 19273]
 [21598 56520 33586]
 [10534 18278 28152]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0549117
{'0': {'precision': 0.36626096801585056, 'recall': 0.329317950458093, 'f1-score': 0.3468084155983383, 'support': 58940}, '1': {'precision': 0.5714617580034956, 'recall': 0.4924266254873364, 'f1-score': 0.5290084739253987, 'support': 104907}, '2': {'precision': 0.3568386122186177, 'recall': 0.47786363334880944, 'f1-score': 0.40857730204862835, 'support': 60308}, 'accuracy': 0.4456202181526176, 'macro avg': {'precision': 0.4315204460793212, 'recall': 0.433202736431413, 'f1-score': 0.42813139719078847, 'support': 224155}, 'weighted avg': {'precision': 0.45976214283601685, 'recall': 0.4456202181526176, 'f1-score': 0.4486987125935471, 'support': 224155}}
[[19410 19423 20107]
 [21412 51659 31836]
 [12173 19316 28819]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0727208
{'0': {'precision': 0.3655249454964775, 'recall': 0.3323830589006308, 'f1-score': 0.34816708999794055, 'support': 61035}, '1': {'precision': 0.5328500485187511, 'recall': 0.46486728748568296, 'f1-score': 0.4965425531914893, 'support': 100405}, '2': {'precision': 0.35295278747578923, 'recall': 0.45619070397831457, 'f1-score': 0.3979857276002615, 'support': 62715}, 'accuracy': 0.42636568445941425, 'macro avg': {'precision': 0.4171092604970059, 'recall': 0.4178136834548761, 'f1-score': 0.4142317902632304, 'support': 224155}, 'weighted avg': {'precision': 0.4369568300347832, 'recall': 0.42636568445941425, 'f1-score': 0.4285668769274216, 'support': 224155}}
[[20287 20391 20357]
 [21638 46675 32092]
 [13576 20529 28610]]
Evaluating performance on  train set...
318/318 - 3s - 3s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0618554
{'0': {'precision': 0.39318635114010025, 'recall': 0.3432470588235294, 'f1-score': 0.3665234541845683, 'support': 21250}, '1': {'precision': 0.6043131555171466, 'recall': 0.3925190722833159, 'f1-score': 0.47591647331786546, 'support': 39193}, '2': {'precision': 0.3429339065018807, 'recall': 0.6140967043541015, 'f1-score': 0.44009999138005346, 'support': 20785}, 'accuracy': 0.43632737479686806, 'macro avg': {'precision': 0.4468111377197092, 'recall': 0.4499542784869823, 'f1-score': 0.42751330629416234, 'support': 81228}, 'weighted avg': {'precision': 0.4821974776253539, 'recall': 0.43632737479686806, 'f1-score': 0.4381333537819913, 'support': 81228}}
[[ 7294  5178  8778]
 [ 8131 15384 15678]
 [ 3126  4895 12764]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0529068
{'0': {'precision': 0.4590714722052535, 'recall': 0.34831981460023176, 'f1-score': 0.39609961786796677, 'support': 25890}, '1': {'precision': 0.49139525532770406, 'recall': 0.4073395106992867, 'f1-score': 0.44543665257326137, 'support': 30002}, '2': {'precision': 0.40507708231192463, 'recall': 0.5869908430691506, 'f1-score': 0.4793553585817889, 'support': 25336}, 'accuracy': 0.44456345102673955, 'macro avg': {'precision': 0.45184793661496075, 'recall': 0.44755005612288973, 'f1-score': 0.440297209674339, 'support': 81228}, 'weighted avg': {'precision': 0.4541689297187018, 'recall': 0.44456345102673955, 'f1-score': 0.44029099475713857, 'support': 81228}}
[[ 9018  6426 10446]
 [ 6385 12221 11396]
 [ 4241  6223 14872]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0557116
{'0': {'precision': 0.47852819675281005, 'recall': 0.360432721878505, 'f1-score': 0.4111686650019605, 'support': 27639}, '1': {'precision': 0.44156701030927836, 'recall': 0.40178604930396605, 'f1-score': 0.42073829590774253, 'support': 26651}, '2': {'precision': 0.4221515486725664, 'recall': 0.5666716163041057, 'f1-score': 0.48385051824146563, 'support': 26938}, 'accuracy': 0.4423967104939184, 'macro avg': {'precision': 0.44741558524488495, 'recall': 0.4429634624955256, 'f1-score': 0.43858582638372284, 'support': 81228}, 'weighted avg': {'precision': 0.4477047525477063, 'recall': 0.4423967104939184, 'f1-score': 0.43841227552832807, 'support': 81228}}
[[ 9962  6851 10826]
 [ 5874 10708 10069]
 [ 4982  6691 15265]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0693557
{'0': {'precision': 0.4682528829937554, 'recall': 0.3712148587121486, 'f1-score': 0.41412533005462276, 'support': 27674}, '1': {'precision': 0.4222193964055612, 'recall': 0.3719289074751699, 'f1-score': 0.39548179616468815, 'support': 26782}, '2': {'precision': 0.4095582261814718, 'recall': 0.5460929329149858, 'f1-score': 0.4680721637932415, 'support': 26772}, 'accuracy': 0.4290884916531245, 'macro avg': {'precision': 0.43334350186026277, 'recall': 0.4297455663674348, 'f1-score': 0.4258930966708508, 'support': 81228}, 'weighted avg': {'precision': 0.4337297851705483, 'recall': 0.4290884916531245, 'f1-score': 0.4257586770311588, 'support': 81228}}
[[10273  6810 10591]
 [ 6335  9961 10486]
 [ 5331  6821 14620]]
Evaluating performance on  val set...
104/104 - 1s - 1s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.066945
{'0': {'precision': 0.33396084337349397, 'recall': 0.2843860211606284, 'f1-score': 0.3071861471861472, 'support': 6238}, '1': {'precision': 0.6139305527018697, 'recall': 0.43582263710618435, 'f1-score': 0.5097671244561972, 'support': 13712}, '2': {'precision': 0.323054075303573, 'recall': 0.5651841662845789, 'f1-score': 0.41111728738187886, 'support': 6543}, 'accuracy': 0.432114143358623, 'macro avg': {'precision': 0.42364849045964553, 'recall': 0.4284642748504639, 'f1-score': 0.40935685300807445, 'support': 26493}, 'weighted avg': {'precision': 0.4761713016390432, 'recall': 0.432114143358623, 'f1-score': 0.4377040881753745, 'support': 26493}}
[[1774 1876 2588]
 [2575 5976 5161]
 [ 963 1882 3698]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0701944
{'0': {'precision': 0.3825263534036091, 'recall': 0.2820445264128573, 'f1-score': 0.3246891113133151, 'support': 7591}, '1': {'precision': 0.5055381400208987, 'recall': 0.44499632082413537, 'f1-score': 0.47333920360043047, 'support': 10872}, '2': {'precision': 0.38186473600565074, 'recall': 0.5386052303860523, 'f1-score': 0.44688985327547015, 'support': 8030}, 'accuracy': 0.42667874532895483, 'macro avg': {'precision': 0.42330974314338615, 'recall': 0.42188202587434837, 'f1-score': 0.41497272272973856, 'support': 26493}, 'weighted avg': {'precision': 0.43280647858375354, 'recall': 0.42667874532895483, 'f1-score': 0.42272994328031105, 'support': 26493}}
[[2141 2329 3121]
 [2154 4838 3880]
 [1302 2403 4325]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.076829
{'0': {'precision': 0.39619464556322614, 'recall': 0.29060145732987525, 'f1-score': 0.335280706754061, 'support': 8097}, '1': {'precision': 0.46380697050938335, 'recall': 0.43026263430163153, 'f1-score': 0.44640553233214636, 'support': 10052}, '2': {'precision': 0.39184255053878353, 'recall': 0.5273250239693192, 'f1-score': 0.4495989373116027, 'support': 8344}, 'accuracy': 0.41814819008794774, 'macro avg': {'precision': 0.41728138887046434, 'recall': 0.41606303853360865, 'f1-score': 0.41042839213260335, 'support': 26493}, 'weighted avg': {'precision': 0.42047748289666603, 'recall': 0.41814819008794774, 'f1-score': 0.4134484515350613, 'support': 26493}}
[[2353 2484 3260]
 [2158 4325 3569]
 [1428 2516 4400]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0851685
{'0': {'precision': 0.39330143540669854, 'recall': 0.299599076661402, 'f1-score': 0.3401144748638025, 'support': 8231}, '1': {'precision': 0.4413161090868941, 'recall': 0.4054163708286844, 'f1-score': 0.422605201945443, 'support': 9859}, '2': {'precision': 0.3881425756761598, 'recall': 0.5157681780316553, 'f1-score': 0.44294547498594716, 'support': 8403}, 'accuracy': 0.40754161476616463, 'macro avg': {'precision': 0.4075867067232508, 'recall': 0.406927875173914, 'f1-score': 0.4018883839317309, 'support': 26493}, 'weighted avg': {'precision': 0.4095331482930206, 'recall': 0.40754161476616463, 'f1-score': 0.4034279905971764, 'support': 26493}}
[[2466 2535 3230]
 [2260 3997 3602]
 [1544 2525 4334]]
training model: results/LILAK/W0/deepVOL_L3/seq2seq
Epoch 1/50
318/318 - 18s - loss: 13.2730 - accuracy10: 0.3586 - accuracy20: 0.3583 - accuracy30: 0.3594 - accuracy50: 0.3546 - val_loss: 13.1341 - val_accuracy10: 0.3217 - val_accuracy20: 0.3447 - val_accuracy30: 0.3467 - val_accuracy50: 0.3502 - 18s/epoch - 57ms/step
Epoch 2/50
318/318 - 13s - loss: 13.1324 - accuracy10: 0.3578 - accuracy20: 0.3741 - accuracy30: 0.3753 - accuracy50: 0.3724 - val_loss: 13.0934 - val_accuracy10: 0.3266 - val_accuracy20: 0.3615 - val_accuracy30: 0.3655 - val_accuracy50: 0.3696 - 13s/epoch - 40ms/step
Epoch 3/50
318/318 - 12s - loss: 13.0577 - accuracy10: 0.3659 - accuracy20: 0.3838 - accuracy30: 0.3858 - accuracy50: 0.3842 - val_loss: 13.0977 - val_accuracy10: 0.3632 - val_accuracy20: 0.3793 - val_accuracy30: 0.3787 - val_accuracy50: 0.3787 - 12s/epoch - 39ms/step
Epoch 4/50
318/318 - 13s - loss: 12.9797 - accuracy10: 0.3641 - accuracy20: 0.3908 - accuracy30: 0.3982 - accuracy50: 0.3950 - val_loss: 13.0897 - val_accuracy10: 0.3876 - val_accuracy20: 0.3898 - val_accuracy30: 0.3866 - val_accuracy50: 0.3832 - 13s/epoch - 39ms/step
Epoch 5/50
318/318 - 13s - loss: 12.9187 - accuracy10: 0.3736 - accuracy20: 0.4000 - accuracy30: 0.4090 - accuracy50: 0.4049 - val_loss: 13.1055 - val_accuracy10: 0.3819 - val_accuracy20: 0.3838 - val_accuracy30: 0.3805 - val_accuracy50: 0.3788 - 13s/epoch - 39ms/step
Epoch 6/50
318/318 - 12s - loss: 12.8552 - accuracy10: 0.3796 - accuracy20: 0.4067 - accuracy30: 0.4154 - accuracy50: 0.4126 - val_loss: 13.2053 - val_accuracy10: 0.3798 - val_accuracy20: 0.3859 - val_accuracy30: 0.3824 - val_accuracy50: 0.3805 - 12s/epoch - 39ms/step
Epoch 7/50
318/318 - 12s - loss: 12.7960 - accuracy10: 0.3934 - accuracy20: 0.4177 - accuracy30: 0.4227 - accuracy50: 0.4189 - val_loss: 13.4270 - val_accuracy10: 0.3402 - val_accuracy20: 0.3670 - val_accuracy30: 0.3693 - val_accuracy50: 0.3704 - 12s/epoch - 39ms/step
Epoch 8/50
318/318 - 13s - loss: 12.7567 - accuracy10: 0.4006 - accuracy20: 0.4235 - accuracy30: 0.4286 - accuracy50: 0.4223 - val_loss: 13.0639 - val_accuracy10: 0.3707 - val_accuracy20: 0.3824 - val_accuracy30: 0.3824 - val_accuracy50: 0.3832 - 13s/epoch - 39ms/step
Epoch 9/50
318/318 - 12s - loss: 12.6945 - accuracy10: 0.4099 - accuracy20: 0.4317 - accuracy30: 0.4368 - accuracy50: 0.4307 - val_loss: 13.2170 - val_accuracy10: 0.3823 - val_accuracy20: 0.3910 - val_accuracy30: 0.3897 - val_accuracy50: 0.3856 - 12s/epoch - 39ms/step
Epoch 10/50
318/318 - 12s - loss: 12.6541 - accuracy10: 0.4211 - accuracy20: 0.4401 - accuracy30: 0.4420 - accuracy50: 0.4354 - val_loss: 13.4800 - val_accuracy10: 0.3607 - val_accuracy20: 0.3749 - val_accuracy30: 0.3758 - val_accuracy50: 0.3746 - 12s/epoch - 39ms/step
Epoch 11/50
318/318 - 12s - loss: 12.6370 - accuracy10: 0.4227 - accuracy20: 0.4413 - accuracy30: 0.4425 - accuracy50: 0.4343 - val_loss: 13.2413 - val_accuracy10: 0.3629 - val_accuracy20: 0.3785 - val_accuracy30: 0.3809 - val_accuracy50: 0.3789 - 12s/epoch - 39ms/step
Epoch 12/50
318/318 - 12s - loss: 12.5883 - accuracy10: 0.4304 - accuracy20: 0.4482 - accuracy30: 0.4493 - accuracy50: 0.4406 - val_loss: 13.0721 - val_accuracy10: 0.3867 - val_accuracy20: 0.3926 - val_accuracy30: 0.3902 - val_accuracy50: 0.3879 - 12s/epoch - 39ms/step
Epoch 13/50
318/318 - 13s - loss: 12.5630 - accuracy10: 0.4345 - accuracy20: 0.4526 - accuracy30: 0.4535 - accuracy50: 0.4421 - val_loss: 13.0520 - val_accuracy10: 0.3830 - val_accuracy20: 0.3953 - val_accuracy30: 0.3927 - val_accuracy50: 0.3872 - 13s/epoch - 39ms/step
Epoch 14/50
318/318 - 12s - loss: 12.5342 - accuracy10: 0.4383 - accuracy20: 0.4538 - accuracy30: 0.4546 - accuracy50: 0.4447 - val_loss: 13.0587 - val_accuracy10: 0.3779 - val_accuracy20: 0.3906 - val_accuracy30: 0.3907 - val_accuracy50: 0.3881 - 12s/epoch - 39ms/step
Epoch 15/50
318/318 - 12s - loss: 12.5039 - accuracy10: 0.4451 - accuracy20: 0.4583 - accuracy30: 0.4571 - accuracy50: 0.4441 - val_loss: 13.0358 - val_accuracy10: 0.3876 - val_accuracy20: 0.3960 - val_accuracy30: 0.3904 - val_accuracy50: 0.3823 - 12s/epoch - 39ms/step
Epoch 16/50
318/318 - 12s - loss: 12.4750 - accuracy10: 0.4478 - accuracy20: 0.4627 - accuracy30: 0.4634 - accuracy50: 0.4491 - val_loss: 12.9722 - val_accuracy10: 0.3816 - val_accuracy20: 0.3975 - val_accuracy30: 0.3941 - val_accuracy50: 0.3885 - 12s/epoch - 39ms/step
Epoch 17/50
318/318 - 13s - loss: 12.4632 - accuracy10: 0.4488 - accuracy20: 0.4623 - accuracy30: 0.4617 - accuracy50: 0.4493 - val_loss: 12.9054 - val_accuracy10: 0.4038 - val_accuracy20: 0.4066 - val_accuracy30: 0.3996 - val_accuracy50: 0.3901 - 13s/epoch - 40ms/step
Epoch 18/50
318/318 - 13s - loss: 12.4283 - accuracy10: 0.4528 - accuracy20: 0.4668 - accuracy30: 0.4649 - accuracy50: 0.4516 - val_loss: 12.9386 - val_accuracy10: 0.4014 - val_accuracy20: 0.4069 - val_accuracy30: 0.4008 - val_accuracy50: 0.3907 - 13s/epoch - 41ms/step
Epoch 19/50
318/318 - 13s - loss: 12.3901 - accuracy10: 0.4570 - accuracy20: 0.4704 - accuracy30: 0.4696 - accuracy50: 0.4550 - val_loss: 12.9387 - val_accuracy10: 0.4099 - val_accuracy20: 0.4107 - val_accuracy30: 0.4046 - val_accuracy50: 0.3963 - 13s/epoch - 41ms/step
Epoch 20/50
318/318 - 13s - loss: 12.3677 - accuracy10: 0.4609 - accuracy20: 0.4715 - accuracy30: 0.4697 - accuracy50: 0.4567 - val_loss: 12.8844 - val_accuracy10: 0.4066 - val_accuracy20: 0.4117 - val_accuracy30: 0.4062 - val_accuracy50: 0.3963 - 13s/epoch - 41ms/step
Epoch 21/50
318/318 - 13s - loss: 12.3329 - accuracy10: 0.4633 - accuracy20: 0.4765 - accuracy30: 0.4742 - accuracy50: 0.4600 - val_loss: 12.9355 - val_accuracy10: 0.3915 - val_accuracy20: 0.4035 - val_accuracy30: 0.4055 - val_accuracy50: 0.3994 - 13s/epoch - 40ms/step
Epoch 22/50
318/318 - 12s - loss: 12.3133 - accuracy10: 0.4663 - accuracy20: 0.4787 - accuracy30: 0.4764 - accuracy50: 0.4614 - val_loss: 12.9089 - val_accuracy10: 0.4020 - val_accuracy20: 0.4094 - val_accuracy30: 0.4046 - val_accuracy50: 0.3981 - 12s/epoch - 39ms/step
Epoch 23/50
318/318 - 13s - loss: 12.2793 - accuracy10: 0.4676 - accuracy20: 0.4795 - accuracy30: 0.4788 - accuracy50: 0.4639 - val_loss: 12.8838 - val_accuracy10: 0.4072 - val_accuracy20: 0.4126 - val_accuracy30: 0.4096 - val_accuracy50: 0.4021 - 13s/epoch - 40ms/step
Epoch 24/50
318/318 - 12s - loss: 12.2628 - accuracy10: 0.4670 - accuracy20: 0.4815 - accuracy30: 0.4807 - accuracy50: 0.4668 - val_loss: 12.9096 - val_accuracy10: 0.4059 - val_accuracy20: 0.4145 - val_accuracy30: 0.4084 - val_accuracy50: 0.4020 - 12s/epoch - 39ms/step
Epoch 25/50
318/318 - 12s - loss: 12.2489 - accuracy10: 0.4695 - accuracy20: 0.4831 - accuracy30: 0.4823 - accuracy50: 0.4669 - val_loss: 12.8821 - val_accuracy10: 0.4130 - val_accuracy20: 0.4166 - val_accuracy30: 0.4119 - val_accuracy50: 0.4043 - 12s/epoch - 39ms/step
Epoch 26/50
318/318 - 12s - loss: 12.2253 - accuracy10: 0.4718 - accuracy20: 0.4850 - accuracy30: 0.4852 - accuracy50: 0.4685 - val_loss: 12.8693 - val_accuracy10: 0.4054 - val_accuracy20: 0.4161 - val_accuracy30: 0.4128 - val_accuracy50: 0.4047 - 12s/epoch - 39ms/step
Epoch 27/50
318/318 - 12s - loss: 12.2052 - accuracy10: 0.4731 - accuracy20: 0.4868 - accuracy30: 0.4882 - accuracy50: 0.4703 - val_loss: 12.8867 - val_accuracy10: 0.4183 - val_accuracy20: 0.4183 - val_accuracy30: 0.4127 - val_accuracy50: 0.4065 - 12s/epoch - 39ms/step
Epoch 28/50
318/318 - 13s - loss: 12.1785 - accuracy10: 0.4739 - accuracy20: 0.4885 - accuracy30: 0.4893 - accuracy50: 0.4709 - val_loss: 12.9527 - val_accuracy10: 0.4029 - val_accuracy20: 0.4074 - val_accuracy30: 0.4040 - val_accuracy50: 0.3922 - 13s/epoch - 40ms/step
Epoch 29/50
318/318 - 13s - loss: 12.1703 - accuracy10: 0.4741 - accuracy20: 0.4887 - accuracy30: 0.4898 - accuracy50: 0.4719 - val_loss: 12.9141 - val_accuracy10: 0.4186 - val_accuracy20: 0.4169 - val_accuracy30: 0.4091 - val_accuracy50: 0.3997 - 13s/epoch - 40ms/step
Epoch 30/50
318/318 - 12s - loss: 12.1476 - accuracy10: 0.4753 - accuracy20: 0.4903 - accuracy30: 0.4915 - accuracy50: 0.4734 - val_loss: 12.8999 - val_accuracy10: 0.4076 - val_accuracy20: 0.4150 - val_accuracy30: 0.4130 - val_accuracy50: 0.4023 - 12s/epoch - 39ms/step
Epoch 31/50
318/318 - 12s - loss: 12.1218 - accuracy10: 0.4770 - accuracy20: 0.4942 - accuracy30: 0.4948 - accuracy50: 0.4754 - val_loss: 12.9657 - val_accuracy10: 0.4072 - val_accuracy20: 0.4137 - val_accuracy30: 0.4086 - val_accuracy50: 0.3983 - 12s/epoch - 39ms/step
Epoch 32/50
318/318 - 12s - loss: 12.1051 - accuracy10: 0.4765 - accuracy20: 0.4938 - accuracy30: 0.4960 - accuracy50: 0.4794 - val_loss: 12.9503 - val_accuracy10: 0.4030 - val_accuracy20: 0.4136 - val_accuracy30: 0.4115 - val_accuracy50: 0.4041 - 12s/epoch - 39ms/step
Epoch 33/50
318/318 - 12s - loss: 12.0574 - accuracy10: 0.4811 - accuracy20: 0.4982 - accuracy30: 0.5001 - accuracy50: 0.4816 - val_loss: 12.9675 - val_accuracy10: 0.4110 - val_accuracy20: 0.4114 - val_accuracy30: 0.4046 - val_accuracy50: 0.3970 - 12s/epoch - 39ms/step
Epoch 34/50
318/318 - 12s - loss: 12.0460 - accuracy10: 0.4813 - accuracy20: 0.5005 - accuracy30: 0.5036 - accuracy50: 0.4846 - val_loss: 12.9654 - val_accuracy10: 0.4031 - val_accuracy20: 0.4098 - val_accuracy30: 0.4081 - val_accuracy50: 0.4014 - 12s/epoch - 38ms/step
Epoch 35/50
318/318 - 12s - loss: 12.0215 - accuracy10: 0.4828 - accuracy20: 0.5023 - accuracy30: 0.5029 - accuracy50: 0.4847 - val_loss: 13.0058 - val_accuracy10: 0.4006 - val_accuracy20: 0.4055 - val_accuracy30: 0.4058 - val_accuracy50: 0.3992 - 12s/epoch - 38ms/step
Epoch 36/50
318/318 - 13s - loss: 12.0100 - accuracy10: 0.4823 - accuracy20: 0.5004 - accuracy30: 0.5035 - accuracy50: 0.4860 - val_loss: 12.9737 - val_accuracy10: 0.4078 - val_accuracy20: 0.4089 - val_accuracy30: 0.4060 - val_accuracy50: 0.4006 - 13s/epoch - 40ms/step
testing model: results/LILAK/W0/deepVOL_L3/seq2seq
Evaluating performance on  test set...
876/876 - 15s - 15s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0625972
{'0': {'precision': 0.29888686631119415, 'recall': 0.4141980131711128, 'f1-score': 0.34721910322628935, 'support': 44795}, '1': {'precision': 0.7121595516012298, 'recall': 0.3928496382793504, 'f1-score': 0.50636976561971, 'support': 133252}, '2': {'precision': 0.2880368513751524, 'recall': 0.5533096208900842, 'f1-score': 0.37885357885357884, 'support': 46108}, 'accuracy': 0.43012201378510406, 'macro avg': {'precision': 0.43302775642919206, 'recall': 0.45345242411351583, 'f1-score': 0.4108141492331927, 'support': 224155}, 'weighted avg': {'precision': 0.5423306412508422, 'recall': 0.43012201378510406, 'f1-score': 0.4483355024476815, 'support': 224155}}
[[18554 10158 16083]
 [33927 52348 46977]
 [ 9596 11000 25512]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0654306
{'0': {'precision': 0.34695613180560064, 'recall': 0.4043830086326527, 'f1-score': 0.3734749246825014, 'support': 55487}, '1': {'precision': 0.6208730078458004, 'recall': 0.38467736159851035, 'f1-score': 0.4750349615561071, 'support': 111704}, '2': {'precision': 0.33891996676820824, 'recall': 0.5371111579243031, 'f1-score': 0.41559641127690355, 'support': 56964}, 'accuracy': 0.42829292230822424, 'macro avg': {'precision': 0.43558303547320304, 'recall': 0.442057176051822, 'f1-score': 0.42136876583850397, 'support': 224155}, 'weighted avg': {'precision': 0.48141594138381416, 'recall': 0.42829292230822424, 'f1-score': 0.43478995544823396, 'support': 224155}}
[[22438 12705 20344]
 [29399 42970 39335]
 [12834 13534 30596]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0704632
{'0': {'precision': 0.35907230144115904, 'recall': 0.4003223617237869, 'f1-score': 0.3785769869475576, 'support': 58940}, '1': {'precision': 0.5829470638599392, 'recall': 0.3764286463248401, 'f1-score': 0.45745993315918426, 'support': 104907}, '2': {'precision': 0.34890079601331836, 'recall': 0.5247396696955627, 'f1-score': 0.41912456128733194, 'support': 60308}, 'accuracy': 0.42261381633244854, 'macro avg': {'precision': 0.43030672043813883, 'recall': 0.4338302259147299, 'f1-score': 0.4183871604646913, 'support': 224155}, 'weighted avg': {'precision': 0.46111154460648995, 'recall': 0.42261381633244854, 'f1-score': 0.4264042330563048, 'support': 224155}}
[[23595 13800 21545]
 [27906 39490 37511]
 [14210 14452 31646]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0825015
{'0': {'precision': 0.3605408575926898, 'recall': 0.38269845170803635, 'f1-score': 0.37128937140858836, 'support': 61035}, '1': {'precision': 0.5436165177779092, 'recall': 0.36606742692097005, 'f1-score': 0.4375152514328907, 'support': 100405}, '2': {'precision': 0.3485510642239829, 'recall': 0.5099577453559755, 'f1-score': 0.4140815163913201, 'support': 62715}, 'accuracy': 0.4108540964957284, 'macro avg': {'precision': 0.4175694798648606, 'recall': 0.4195745413283272, 'f1-score': 0.40762871307759974, 'support': 224155}, 'weighted avg': {'precision': 0.43919077291814984, 'recall': 0.4108540964957284, 'f1-score': 0.41292626934275045, 'support': 224155}}
[[23358 15090 22587]
 [26462 36755 37188]
 [14966 15767 31982]]
Evaluating performance on  train set...
318/318 - 5s - 5s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0660555
{'0': {'precision': 0.3773741690408357, 'recall': 0.4488, 'f1-score': 0.40999957009586857, 'support': 21250}, '1': {'precision': 0.635493670886076, 'recall': 0.32023575638506874, 'f1-score': 0.42586905993926333, 'support': 39193}, '2': {'precision': 0.3509639286306137, 'recall': 0.6113543420736107, 'f1-score': 0.4459300591321437, 'support': 20785}, 'accuracy': 0.4283621411335993, 'macro avg': {'precision': 0.45461058951917516, 'recall': 0.46013003281955983, 'f1-score': 0.4272662297224252, 'support': 81228}, 'weighted avg': {'precision': 0.49516041010172646, 'recall': 0.4283621411335993, 'f1-score': 0.4268507560176092, 'support': 81228}}
[[ 9537  3486  8227]
 [11370 12551 15272]
 [ 4365  3713 12707]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0466719
{'0': {'precision': 0.4472854374833783, 'recall': 0.45473155658555425, 'f1-score': 0.4509777633065829, 'support': 25890}, '1': {'precision': 0.5294436906377205, 'recall': 0.32514499033397776, 'f1-score': 0.4028744295537613, 'support': 30002}, '2': {'precision': 0.4143413190066334, 'recall': 0.5966214082728134, 'f1-score': 0.4890484972014623, 'support': 25336}, 'accuracy': 0.45112522775397645, 'macro avg': {'precision': 0.4636901490425774, 'recall': 0.45883265173078175, 'f1-score': 0.4476335633539355, 'support': 81228}, 'weighted avg': {'precision': 0.4673553607291773, 'recall': 0.45112522775397645, 'f1-score': 0.4450852618872264, 'support': 81228}}
[[11773  4216  9901]
 [ 8782  9755 11465]
 [ 5766  4454 15116]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0450965
{'0': {'precision': 0.47336859356376637, 'recall': 0.4598212670501827, 'f1-score': 0.466496595518197, 'support': 27639}, '1': {'precision': 0.477930575579461, 'recall': 0.32340249896814377, 'f1-score': 0.3857670359180933, 'support': 26651}, '2': {'precision': 0.4327023606449128, 'recall': 0.5838221100304403, 'f1-score': 0.49702926490108085, 'support': 26938}, 'accuracy': 0.45618505933914416, 'macro avg': {'precision': 0.4613338432627134, 'recall': 0.45568195868292233, 'f1-score': 0.4497642987791237, 'support': 81228}, 'weighted avg': {'precision': 0.46137906286415786, 'recall': 0.45618505933914416, 'f1-score': 0.4501348182361484, 'support': 81228}}
[[12709  4546 10384]
 [ 7797  8619 10235]
 [ 6342  4869 15727]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0603304
{'0': {'precision': 0.463678979936246, 'recall': 0.4467731444677314, 'f1-score': 0.4550691032223633, 'support': 27674}, '1': {'precision': 0.44511352963924644, 'recall': 0.30083638264506013, 'f1-score': 0.3590223469910657, 'support': 26782}, '2': {'precision': 0.4152268114749602, 'recall': 0.5655162109666816, 'f1-score': 0.47885631147800234, 'support': 26772}, 'accuracy': 0.4377923868616733, 'macro avg': {'precision': 0.44133977368348426, 'recall': 0.4377085793598244, 'f1-score': 0.43098258723047717, 'support': 81228}, 'weighted avg': {'precision': 0.44158830499780377, 'recall': 0.4377923868616733, 'f1-score': 0.4312411979930502, 'support': 81228}}
[[12364  4871 10439]
 [ 7842  8057 10883]
 [ 6459  5173 15140]]
Evaluating performance on  val set...
104/104 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0857556
{'0': {'precision': 0.3173500734606651, 'recall': 0.38089131131773, 'f1-score': 0.34622950819672127, 'support': 6238}, '1': {'precision': 0.638283378746594, 'recall': 0.341671528588098, 'f1-score': 0.4450883526505795, 'support': 13712}, '2': {'precision': 0.31604663123607063, 'recall': 0.5635029802842733, 'f1-score': 0.40496457795595586, 'support': 6543}, 'accuracy': 0.40569206960329146, 'macro avg': {'precision': 0.4238933611477766, 'recall': 0.4286886067300338, 'f1-score': 0.3987608129344189, 'support': 26493}, 'weighted avg': {'precision': 0.48313382990973225, 'recall': 0.40569206960329146, 'f1-score': 0.41190180037148355, 'support': 26493}}
[[2376 1244 2618]
 [3666 4685 5361]
 [1445 1411 3687]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.078151
{'0': {'precision': 0.3705466237942122, 'recall': 0.37952838888157026, 'f1-score': 0.37498373031367954, 'support': 7591}, '1': {'precision': 0.5353783822891043, 'recall': 0.34032376747608534, 'f1-score': 0.41612776246977445, 'support': 10872}, '2': {'precision': 0.3761328025747438, 'recall': 0.5530510585305106, 'f1-score': 0.44774915561828904, 'support': 8030}, 'accuracy': 0.41603442418752123, 'macro avg': {'precision': 0.4273526028860201, 'recall': 0.42430107162938874, 'f1-score': 0.41295354946724766, 'support': 26493}, 'weighted avg': {'precision': 0.4398822178743139, 'recall': 0.41603442418752123, 'f1-score': 0.4139232344391873, 'support': 26493}}
[[2881 1500 3210]
 [3016 3700 4156]
 [1878 1711 4441]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0808008
{'0': {'precision': 0.3844106463878327, 'recall': 0.37458317895516857, 'f1-score': 0.3794332895477575, 'support': 8097}, '1': {'precision': 0.4909869976359338, 'recall': 0.3305809789096697, 'f1-score': 0.39512485136741976, 'support': 10052}, '2': {'precision': 0.3874947190536544, 'recall': 0.5496164908916586, 'f1-score': 0.45453193914465534, 'support': 8344}, 'accuracy': 0.4130147586154833, 'macro avg': {'precision': 0.420964121025807, 'recall': 0.4182602162521656, 'f1-score': 0.4096966933532775, 'support': 26493}, 'weighted avg': {'precision': 0.42581928206780584, 'recall': 0.4130147586154833, 'f1-score': 0.4090394010356132, 'support': 26493}}
[[3033 1666 3398]
 [2878 3323 3851]
 [1979 1779 4586]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0884213
{'0': {'precision': 0.3812773628637651, 'recall': 0.3597375774510995, 'f1-score': 0.3701944114521472, 'support': 8231}, '1': {'precision': 0.463493462612017, 'recall': 0.32001217161983975, 'f1-score': 0.37861514460578427, 'support': 9859}, '2': {'precision': 0.38859060402684564, 'recall': 0.5512317029632274, 'f1-score': 0.4558382128622743, 'support': 8403}, 'accuracy': 0.40569206960329146, 'macro avg': {'precision': 0.41112047650087596, 'recall': 0.41032715067805553, 'f1-score': 0.40154925630673527, 'support': 26493}, 'weighted avg': {'precision': 0.41419253641569886, 'recall': 0.40569206960329146, 'f1-score': 0.40049240984459067, 'support': 26493}}
[[2961 1795 3475]
 [2891 3155 3813]
 [1914 1857 4632]]
training model: results/LILAK/W1/deepLOB_L1/seq2seq
Epoch 1/50
260/260 - 11s - loss: 13.1672 - accuracy10: 0.3721 - accuracy20: 0.3762 - accuracy30: 0.3794 - accuracy50: 0.3734 - val_loss: 13.5075 - val_accuracy10: 0.4932 - val_accuracy20: 0.4018 - val_accuracy30: 0.3465 - val_accuracy50: 0.3869 - 11s/epoch - 43ms/step
Epoch 2/50
260/260 - 5s - loss: 13.0618 - accuracy10: 0.3732 - accuracy20: 0.3888 - accuracy30: 0.3914 - accuracy50: 0.3868 - val_loss: 13.2580 - val_accuracy10: 0.4593 - val_accuracy20: 0.3946 - val_accuracy30: 0.3533 - val_accuracy50: 0.3840 - 5s/epoch - 21ms/step
Epoch 3/50
260/260 - 5s - loss: 12.9814 - accuracy10: 0.3874 - accuracy20: 0.3985 - accuracy30: 0.4034 - accuracy50: 0.3978 - val_loss: 13.1537 - val_accuracy10: 0.4781 - val_accuracy20: 0.4055 - val_accuracy30: 0.3556 - val_accuracy50: 0.3877 - 5s/epoch - 21ms/step
Epoch 4/50
260/260 - 5s - loss: 12.9470 - accuracy10: 0.3812 - accuracy20: 0.4010 - accuracy30: 0.4071 - accuracy50: 0.3962 - val_loss: 13.1042 - val_accuracy10: 0.4515 - val_accuracy20: 0.4067 - val_accuracy30: 0.3660 - val_accuracy50: 0.3802 - 5s/epoch - 21ms/step
Epoch 5/50
260/260 - 5s - loss: 12.8978 - accuracy10: 0.3962 - accuracy20: 0.4138 - accuracy30: 0.4141 - accuracy50: 0.4019 - val_loss: 13.1325 - val_accuracy10: 0.4097 - val_accuracy20: 0.3925 - val_accuracy30: 0.3675 - val_accuracy50: 0.3778 - 5s/epoch - 21ms/step
Epoch 6/50
260/260 - 5s - loss: 12.8453 - accuracy10: 0.4139 - accuracy20: 0.4204 - accuracy30: 0.4194 - accuracy50: 0.4055 - val_loss: 13.1644 - val_accuracy10: 0.4835 - val_accuracy20: 0.4242 - val_accuracy30: 0.3775 - val_accuracy50: 0.3937 - 5s/epoch - 20ms/step
Epoch 7/50
260/260 - 5s - loss: 12.8110 - accuracy10: 0.4267 - accuracy20: 0.4311 - accuracy30: 0.4290 - accuracy50: 0.4111 - val_loss: 13.0899 - val_accuracy10: 0.4620 - val_accuracy20: 0.4178 - val_accuracy30: 0.3799 - val_accuracy50: 0.3846 - 5s/epoch - 21ms/step
Epoch 8/50
260/260 - 5s - loss: 12.7920 - accuracy10: 0.4312 - accuracy20: 0.4330 - accuracy30: 0.4294 - accuracy50: 0.4125 - val_loss: 13.1811 - val_accuracy10: 0.4513 - val_accuracy20: 0.4074 - val_accuracy30: 0.3728 - val_accuracy50: 0.3757 - 5s/epoch - 20ms/step
Epoch 9/50
260/260 - 5s - loss: 12.7736 - accuracy10: 0.4334 - accuracy20: 0.4346 - accuracy30: 0.4310 - accuracy50: 0.4129 - val_loss: 13.0929 - val_accuracy10: 0.4569 - val_accuracy20: 0.4217 - val_accuracy30: 0.3904 - val_accuracy50: 0.3915 - 5s/epoch - 20ms/step
Epoch 10/50
260/260 - 5s - loss: 12.7424 - accuracy10: 0.4384 - accuracy20: 0.4380 - accuracy30: 0.4342 - accuracy50: 0.4158 - val_loss: 13.1806 - val_accuracy10: 0.4541 - val_accuracy20: 0.4142 - val_accuracy30: 0.3827 - val_accuracy50: 0.3903 - 5s/epoch - 20ms/step
Epoch 11/50
260/260 - 5s - loss: 12.7228 - accuracy10: 0.4443 - accuracy20: 0.4452 - accuracy30: 0.4394 - accuracy50: 0.4184 - val_loss: 13.1207 - val_accuracy10: 0.4773 - val_accuracy20: 0.4272 - val_accuracy30: 0.3888 - val_accuracy50: 0.3945 - 5s/epoch - 20ms/step
Epoch 12/50
260/260 - 5s - loss: 12.7210 - accuracy10: 0.4439 - accuracy20: 0.4421 - accuracy30: 0.4369 - accuracy50: 0.4169 - val_loss: 12.9909 - val_accuracy10: 0.4689 - val_accuracy20: 0.4331 - val_accuracy30: 0.4014 - val_accuracy50: 0.3983 - 5s/epoch - 20ms/step
Epoch 13/50
260/260 - 5s - loss: 12.6859 - accuracy10: 0.4483 - accuracy20: 0.4449 - accuracy30: 0.4406 - accuracy50: 0.4200 - val_loss: 13.1879 - val_accuracy10: 0.4721 - val_accuracy20: 0.4234 - val_accuracy30: 0.3799 - val_accuracy50: 0.3902 - 5s/epoch - 20ms/step
Epoch 14/50
260/260 - 5s - loss: 12.6757 - accuracy10: 0.4481 - accuracy20: 0.4476 - accuracy30: 0.4428 - accuracy50: 0.4223 - val_loss: 13.0795 - val_accuracy10: 0.4590 - val_accuracy20: 0.4226 - val_accuracy30: 0.3895 - val_accuracy50: 0.3948 - 5s/epoch - 20ms/step
Epoch 15/50
260/260 - 5s - loss: 12.6640 - accuracy10: 0.4491 - accuracy20: 0.4487 - accuracy30: 0.4432 - accuracy50: 0.4230 - val_loss: 13.1235 - val_accuracy10: 0.4684 - val_accuracy20: 0.4226 - val_accuracy30: 0.3907 - val_accuracy50: 0.3985 - 5s/epoch - 20ms/step
Epoch 16/50
260/260 - 5s - loss: 12.6522 - accuracy10: 0.4525 - accuracy20: 0.4501 - accuracy30: 0.4446 - accuracy50: 0.4247 - val_loss: 13.1881 - val_accuracy10: 0.4396 - val_accuracy20: 0.4126 - val_accuracy30: 0.3898 - val_accuracy50: 0.3873 - 5s/epoch - 20ms/step
Epoch 17/50
260/260 - 5s - loss: 12.6261 - accuracy10: 0.4535 - accuracy20: 0.4525 - accuracy30: 0.4462 - accuracy50: 0.4270 - val_loss: 13.2589 - val_accuracy10: 0.4666 - val_accuracy20: 0.4192 - val_accuracy30: 0.3884 - val_accuracy50: 0.3931 - 5s/epoch - 20ms/step
Epoch 18/50
260/260 - 5s - loss: 12.6266 - accuracy10: 0.4522 - accuracy20: 0.4532 - accuracy30: 0.4474 - accuracy50: 0.4260 - val_loss: 13.2511 - val_accuracy10: 0.4616 - val_accuracy20: 0.4160 - val_accuracy30: 0.3830 - val_accuracy50: 0.3932 - 5s/epoch - 20ms/step
Epoch 19/50
260/260 - 5s - loss: 12.6107 - accuracy10: 0.4560 - accuracy20: 0.4552 - accuracy30: 0.4508 - accuracy50: 0.4314 - val_loss: 13.4378 - val_accuracy10: 0.4524 - val_accuracy20: 0.4105 - val_accuracy30: 0.3774 - val_accuracy50: 0.3917 - 5s/epoch - 20ms/step
Epoch 20/50
260/260 - 5s - loss: 12.5985 - accuracy10: 0.4528 - accuracy20: 0.4537 - accuracy30: 0.4487 - accuracy50: 0.4297 - val_loss: 13.3527 - val_accuracy10: 0.4453 - val_accuracy20: 0.4151 - val_accuracy30: 0.3871 - val_accuracy50: 0.3982 - 5s/epoch - 20ms/step
Epoch 21/50
260/260 - 5s - loss: 12.5813 - accuracy10: 0.4589 - accuracy20: 0.4585 - accuracy30: 0.4531 - accuracy50: 0.4325 - val_loss: 13.3578 - val_accuracy10: 0.4357 - val_accuracy20: 0.4124 - val_accuracy30: 0.3889 - val_accuracy50: 0.3908 - 5s/epoch - 20ms/step
Epoch 22/50
260/260 - 5s - loss: 12.5606 - accuracy10: 0.4583 - accuracy20: 0.4604 - accuracy30: 0.4561 - accuracy50: 0.4334 - val_loss: 13.3898 - val_accuracy10: 0.4513 - val_accuracy20: 0.4115 - val_accuracy30: 0.3837 - val_accuracy50: 0.3893 - 5s/epoch - 20ms/step
testing model: results/LILAK/W1/deepLOB_L1/seq2seq
Evaluating performance on  test set...
663/663 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0898646
{'0': {'precision': 0.39477462905807986, 'recall': 0.462176105733001, 'f1-score': 0.42582471382029874, 'support': 51753}, '1': {'precision': 0.4505873763854782, 'recall': 0.5102823126183819, 'f1-score': 0.47858054237718267, 'support': 66522}, '2': {'precision': 0.3957765667574932, 'recall': 0.2599148075389493, 'f1-score': 0.3137701492186858, 'support': 51413}, 'accuracy': 0.41975272264391117, 'macro avg': {'precision': 0.4137128574003504, 'recall': 0.4107910752967774, 'f1-score': 0.4060584684720557, 'support': 169688}, 'weighted avg': {'precision': 0.416958214230002, 'recall': 0.41975272264391117, 'f1-score': 0.41255543076786316, 'support': 169688}}
[[23919 19707  8127]
 [20303 33945 12274]
 [16367 21683 13363]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1172873
{'0': {'precision': 0.43551155115511553, 'recall': 0.43739538275410594, 'f1-score': 0.4364514341940979, 'support': 60339}, '1': {'precision': 0.3349172893913266, 'recall': 0.5307489878542511, 'f1-score': 0.4106825390609704, 'support': 49400}, '2': {'precision': 0.4479109177677499, 'recall': 0.2301456237802132, 'f1-score': 0.30405941466854725, 'support': 59949}, 'accuracy': 0.3913535429729857, 'macro avg': {'precision': 0.4061132527713973, 'recall': 0.39942999812952334, 'f1-score': 0.38373112930787184, 'support': 169688}, 'weighted avg': {'precision': 0.4106068619486285, 'recall': 0.3913535429729857, 'f1-score': 0.3821768090107394, 'support': 169688}}
[[26392 25019  8928]
 [15103 26219  8078]
 [19105 27047 13797]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1314993
{'0': {'precision': 0.4557717861167645, 'recall': 0.4158469022881785, 'f1-score': 0.43489495562296365, 'support': 65161}, '1': {'precision': 0.2701696467299629, 'recall': 0.5647115118241116, 'f1-score': 0.3654841364921803, 'support': 39707}, '2': {'precision': 0.47769741914167185, 'recall': 0.20074051218759642, 'f1-score': 0.282688275996915, 'support': 64820}, 'accuracy': 0.3685116213285559, 'macro avg': {'precision': 0.4012129506627997, 'recall': 0.3937663087666288, 'f1-score': 0.36102245603735295, 'support': 169688}, 'weighted avg': {'precision': 0.42071636312894434, 'recall': 0.3685116213285559, 'f1-score': 0.3605106009921914, 'support': 169688}}
[[27097 29367  8697]
 [11754 22423  5530]
 [20602 31206 13012]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.131337
{'0': {'precision': 0.39829068719228905, 'recall': 0.378638056626784, 'f1-score': 0.3882158125073926, 'support': 60678}, '1': {'precision': 0.2992775346588103, 'recall': 0.5378359410477646, 'f1-score': 0.384564862850438, 'support': 48446}, '2': {'precision': 0.43258089090253, 'recall': 0.17814213063866324, 'f1-score': 0.25235951113969946, 'support': 60564}, 'accuracy': 0.35252934797982177, 'macro avg': {'precision': 0.37671637091787646, 'recall': 0.3648720427710706, 'f1-score': 0.3417133954991767, 'support': 169688}, 'weighted avg': {'precision': 0.3822610369510824, 'recall': 0.35252934797982177, 'f1-score': 0.33868446707864225, 'support': 169688}}
[[22975 30257  7446]
 [15684 26056  6706]
 [19025 30750 10789]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.028027
{'0': {'precision': 0.3357969017495511, 'recall': 0.5026878359794974, 'f1-score': 0.40263348937341975, 'support': 15998}, '1': {'precision': 0.5814567153437884, 'recall': 0.5743609490240218, 'f1-score': 0.5778870511101177, 'support': 33761}, '2': {'precision': 0.40075880758807586, 'recall': 0.22053209257933667, 'f1-score': 0.2845049828773712, 'support': 16764}, 'accuracy': 0.4679584504607429, 'macro avg': {'precision': 0.4393374748938051, 'recall': 0.43252695919428524, 'f1-score': 0.4216751744536362, 'support': 66523}, 'weighted avg': {'precision': 0.4768419892566099, 'recall': 0.4679584504607429, 'f1-score': 0.46180744747652547, 'support': 66523}}
[[ 8042  6233  1723]
 [10565 19391  3805]
 [ 5342  7725  3697]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0645496
{'0': {'precision': 0.3888193052772211, 'recall': 0.47590576932904083, 'f1-score': 0.4279772983157556, 'support': 19569}, '1': {'precision': 0.458557941448015, 'recall': 0.5861504492157759, 'f1-score': 0.51456262010193, 'support': 26268}, '2': {'precision': 0.4557482766288637, 'recall': 0.19815334042347482, 'f1-score': 0.2762129380053909, 'support': 20686}, 'accuracy': 0.4330682621048359, 'macro avg': {'precision': 0.4343751744513666, 'recall': 0.42006985298943045, 'f1-score': 0.4062509521410255, 'support': 66523}, 'weighted avg': {'precision': 0.43716930747667826, 'recall': 0.4330682621048359, 'f1-score': 0.41497466276563044, 'support': 66523}}
[[ 9313  8208  2048]
 [ 8024 15397  2847]
 [ 6615  9972  4099]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0870562
{'0': {'precision': 0.41776189868572156, 'recall': 0.4492727106394657, 'f1-score': 0.43294470279681746, 'support': 21862}, '1': {'precision': 0.3796439741603578, 'recall': 0.6004623208506704, 'f1-score': 0.46517791586826884, 'support': 21630}, '2': {'precision': 0.48642199750028403, 'recall': 0.18587990100299595, 'f1-score': 0.26897461673787376, 'support': 23031}, 'accuracy': 0.4072426078198518, 'macro avg': {'precision': 0.4279426234487878, 'recall': 0.4118716441643773, 'f1-score': 0.3890324118009867, 'support': 66523}, 'weighted avg': {'precision': 0.42913871615208016, 'recall': 0.4072426078198518, 'f1-score': 0.3866570931988132, 'support': 66523}}
[[ 9822  9727  2313]
 [ 6435 12988  2207]
 [ 7254 11496  4281]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0938524
{'0': {'precision': 0.4003782547501759, 'recall': 0.41756880733944957, 'f1-score': 0.40879288665349384, 'support': 21800}, '1': {'precision': 0.3680029611069985, 'recall': 0.5882219087061393, 'f1-score': 0.45275418162711273, 'support': 21973}, '2': {'precision': 0.4598961338718984, 'recall': 0.17516483516483516, 'f1-score': 0.2537004615629476, 'support': 22750}, 'accuracy': 0.3910376862137907, 'macro avg': {'precision': 0.4094257832430242, 'recall': 0.39365185040347467, 'f1-score': 0.37174917661451806, 'support': 66523}, 'weighted avg': {'precision': 0.410038814598614, 'recall': 0.3910376862137907, 'f1-score': 0.37027401143207267, 'support': 66523}}
[[ 9103 10381  2316]
 [ 6684 12925  2364]
 [ 6949 11816  3985]]
Evaluating performance on  val set...
51/51 - 0s - 460ms/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0273955
{'0': {'precision': 0.3369706417251234, 'recall': 0.40940656565656564, 'f1-score': 0.3696736497078523, 'support': 3168}, '1': {'precision': 0.5634777793160737, 'recall': 0.621089577292843, 'f1-score': 0.5908826945412312, 'support': 6553}, '2': {'precision': 0.3526760563380282, 'recall': 0.20025591810620602, 'f1-score': 0.25545806978167723, 'support': 3126}, 'accuracy': 0.4664902311823772, 'macro avg': {'precision': 0.41770815912640846, 'recall': 0.41025068701853823, 'f1-score': 0.4053381380102536, 'support': 12847}, 'weighted avg': {'precision': 0.45632896652573346, 'recall': 0.4664902311823772, 'f1-score': 0.45471645876396727, 'support': 12847}}
[[1297 1511  360]
 [1694 4070  789]
 [ 858 1642  626]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0647029
{'0': {'precision': 0.40225662555759645, 'recall': 0.3916709248850281, 'f1-score': 0.39689320388349514, 'support': 3914}, '1': {'precision': 0.45130705675199784, 'recall': 0.6454862456412244, 'f1-score': 0.5312076524511758, 'support': 5162}, '2': {'precision': 0.38838475499092556, 'recall': 0.17024661893396978, 'f1-score': 0.23672566371681417, 'support': 3771}, 'accuracy': 0.42866038763913755, 'macro avg': {'precision': 0.4139828124335066, 'recall': 0.402467929820074, 'f1-score': 0.3882755066838284, 'support': 12847}, 'weighted avg': {'precision': 0.417893544832025, 'recall': 0.42866038763913755, 'f1-score': 0.403847309086096, 'support': 12847}}
[[1533 1945  436]
 [1255 3332  575]
 [1023 2106  642]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0879971
{'0': {'precision': 0.43539630836047777, 'recall': 0.3699261992619926, 'f1-score': 0.4, 'support': 4336}, '1': {'precision': 0.3781315240083507, 'recall': 0.6705229060620084, 'f1-score': 0.48356415818454856, 'support': 4322}, '2': {'precision': 0.4202801867911941, 'recall': 0.15039388875626641, 'f1-score': 0.22151898734177217, 'support': 4189}, 'accuracy': 0.3994706935471316, 'macro avg': {'precision': 0.4112693397200075, 'recall': 0.39694766469342246, 'f1-score': 0.3683610485087736, 'support': 12847}, 'weighted avg': {'precision': 0.41120234625075386, 'recall': 0.3994706935471316, 'f1-score': 0.36991572582301724, 'support': 12847}}
[[1604 2291  441]
 [ 996 2898  428]
 [1084 2475  630]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0827543
{'0': {'precision': 0.4033898305084746, 'recall': 0.3492296404988995, 'f1-score': 0.3743609909555643, 'support': 4089}, '1': {'precision': 0.4084114517354953, 'recall': 0.6617405582922824, 'f1-score': 0.505091649694501, 'support': 4872}, '2': {'precision': 0.38145789101203115, 'recall': 0.1387030365414308, 'f1-score': 0.2034346103038309, 'support': 3886}, 'accuracy': 0.4040632054176072, 'macro avg': {'precision': 0.39775305775200037, 'recall': 0.3832244117775376, 'f1-score': 0.3609624169846321, 'support': 12847}, 'weighted avg': {'precision': 0.3986601521193461, 'recall': 0.4040632054176072, 'f1-score': 0.37223596987386925, 'support': 12847}}
[[1428 2275  386]
 [1160 3224  488]
 [ 952 2395  539]]
training model: results/LILAK/W1/deepOF_L1/seq2seq
Epoch 1/50
260/260 - 10s - loss: 13.1385 - accuracy10: 0.3918 - accuracy20: 0.3857 - accuracy30: 0.3777 - accuracy50: 0.3692 - val_loss: 13.3193 - val_accuracy10: 0.4808 - val_accuracy20: 0.4011 - val_accuracy30: 0.3560 - val_accuracy50: 0.3734 - 10s/epoch - 39ms/step
Epoch 2/50
260/260 - 5s - loss: 13.0800 - accuracy10: 0.4042 - accuracy20: 0.3955 - accuracy30: 0.3880 - accuracy50: 0.3783 - val_loss: 13.2329 - val_accuracy10: 0.4756 - val_accuracy20: 0.4058 - val_accuracy30: 0.3635 - val_accuracy50: 0.3798 - 5s/epoch - 20ms/step
Epoch 3/50
260/260 - 5s - loss: 13.0501 - accuracy10: 0.4155 - accuracy20: 0.3999 - accuracy30: 0.3913 - accuracy50: 0.3824 - val_loss: 13.1160 - val_accuracy10: 0.4508 - val_accuracy20: 0.4066 - val_accuracy30: 0.3706 - val_accuracy50: 0.3725 - 5s/epoch - 20ms/step
Epoch 4/50
260/260 - 5s - loss: 13.0140 - accuracy10: 0.4164 - accuracy20: 0.4045 - accuracy30: 0.3971 - accuracy50: 0.3874 - val_loss: 13.1107 - val_accuracy10: 0.4502 - val_accuracy20: 0.4072 - val_accuracy30: 0.3760 - val_accuracy50: 0.3787 - 5s/epoch - 19ms/step
Epoch 5/50
260/260 - 5s - loss: 12.9971 - accuracy10: 0.4194 - accuracy20: 0.4055 - accuracy30: 0.3999 - accuracy50: 0.3885 - val_loss: 13.0723 - val_accuracy10: 0.4460 - val_accuracy20: 0.4047 - val_accuracy30: 0.3784 - val_accuracy50: 0.3787 - 5s/epoch - 19ms/step
Epoch 6/50
260/260 - 5s - loss: 12.9746 - accuracy10: 0.4201 - accuracy20: 0.4088 - accuracy30: 0.4020 - accuracy50: 0.3934 - val_loss: 13.0823 - val_accuracy10: 0.4442 - val_accuracy20: 0.4092 - val_accuracy30: 0.3809 - val_accuracy50: 0.3806 - 5s/epoch - 19ms/step
Epoch 7/50
260/260 - 5s - loss: 12.9573 - accuracy10: 0.4208 - accuracy20: 0.4111 - accuracy30: 0.4047 - accuracy50: 0.3938 - val_loss: 13.0533 - val_accuracy10: 0.4501 - val_accuracy20: 0.4114 - val_accuracy30: 0.3855 - val_accuracy50: 0.3780 - 5s/epoch - 19ms/step
Epoch 8/50
260/260 - 5s - loss: 12.9454 - accuracy10: 0.4212 - accuracy20: 0.4102 - accuracy30: 0.4052 - accuracy50: 0.3963 - val_loss: 13.0600 - val_accuracy10: 0.4439 - val_accuracy20: 0.4069 - val_accuracy30: 0.3820 - val_accuracy50: 0.3723 - 5s/epoch - 19ms/step
Epoch 9/50
260/260 - 5s - loss: 12.9286 - accuracy10: 0.4200 - accuracy20: 0.4122 - accuracy30: 0.4077 - accuracy50: 0.3978 - val_loss: 13.0777 - val_accuracy10: 0.4454 - val_accuracy20: 0.4081 - val_accuracy30: 0.3844 - val_accuracy50: 0.3812 - 5s/epoch - 19ms/step
Epoch 10/50
260/260 - 5s - loss: 12.9183 - accuracy10: 0.4236 - accuracy20: 0.4146 - accuracy30: 0.4104 - accuracy50: 0.4002 - val_loss: 13.0629 - val_accuracy10: 0.4410 - val_accuracy20: 0.4082 - val_accuracy30: 0.3837 - val_accuracy50: 0.3779 - 5s/epoch - 19ms/step
Epoch 11/50
260/260 - 5s - loss: 12.9008 - accuracy10: 0.4226 - accuracy20: 0.4150 - accuracy30: 0.4126 - accuracy50: 0.4023 - val_loss: 13.0521 - val_accuracy10: 0.4370 - val_accuracy20: 0.4137 - val_accuracy30: 0.3847 - val_accuracy50: 0.3795 - 5s/epoch - 19ms/step
Epoch 12/50
260/260 - 5s - loss: 12.8869 - accuracy10: 0.4235 - accuracy20: 0.4185 - accuracy30: 0.4151 - accuracy50: 0.4030 - val_loss: 13.0353 - val_accuracy10: 0.4332 - val_accuracy20: 0.4112 - val_accuracy30: 0.3858 - val_accuracy50: 0.3760 - 5s/epoch - 19ms/step
Epoch 13/50
260/260 - 5s - loss: 12.8706 - accuracy10: 0.4266 - accuracy20: 0.4190 - accuracy30: 0.4145 - accuracy50: 0.4028 - val_loss: 13.0291 - val_accuracy10: 0.4391 - val_accuracy20: 0.4125 - val_accuracy30: 0.3876 - val_accuracy50: 0.3794 - 5s/epoch - 19ms/step
Epoch 14/50
260/260 - 5s - loss: 12.8583 - accuracy10: 0.4282 - accuracy20: 0.4217 - accuracy30: 0.4179 - accuracy50: 0.4048 - val_loss: 13.0375 - val_accuracy10: 0.4485 - val_accuracy20: 0.4137 - val_accuracy30: 0.3870 - val_accuracy50: 0.3773 - 5s/epoch - 19ms/step
Epoch 15/50
260/260 - 5s - loss: 12.8468 - accuracy10: 0.4272 - accuracy20: 0.4206 - accuracy30: 0.4199 - accuracy50: 0.4070 - val_loss: 13.0197 - val_accuracy10: 0.4425 - val_accuracy20: 0.4119 - val_accuracy30: 0.3835 - val_accuracy50: 0.3760 - 5s/epoch - 19ms/step
Epoch 16/50
260/260 - 5s - loss: 12.8324 - accuracy10: 0.4291 - accuracy20: 0.4249 - accuracy30: 0.4216 - accuracy50: 0.4095 - val_loss: 13.0360 - val_accuracy10: 0.4410 - val_accuracy20: 0.4109 - val_accuracy30: 0.3872 - val_accuracy50: 0.3791 - 5s/epoch - 19ms/step
Epoch 17/50
260/260 - 5s - loss: 12.8158 - accuracy10: 0.4273 - accuracy20: 0.4234 - accuracy30: 0.4237 - accuracy50: 0.4134 - val_loss: 13.0645 - val_accuracy10: 0.4452 - val_accuracy20: 0.4122 - val_accuracy30: 0.3876 - val_accuracy50: 0.3806 - 5s/epoch - 19ms/step
Epoch 18/50
260/260 - 5s - loss: 12.8051 - accuracy10: 0.4297 - accuracy20: 0.4261 - accuracy30: 0.4236 - accuracy50: 0.4126 - val_loss: 13.0254 - val_accuracy10: 0.4385 - val_accuracy20: 0.4147 - val_accuracy30: 0.3937 - val_accuracy50: 0.3802 - 5s/epoch - 19ms/step
Epoch 19/50
260/260 - 5s - loss: 12.7904 - accuracy10: 0.4313 - accuracy20: 0.4280 - accuracy30: 0.4279 - accuracy50: 0.4144 - val_loss: 13.1160 - val_accuracy10: 0.4511 - val_accuracy20: 0.4153 - val_accuracy30: 0.3871 - val_accuracy50: 0.3812 - 5s/epoch - 19ms/step
Epoch 20/50
260/260 - 5s - loss: 12.7782 - accuracy10: 0.4303 - accuracy20: 0.4288 - accuracy30: 0.4297 - accuracy50: 0.4152 - val_loss: 13.0693 - val_accuracy10: 0.4449 - val_accuracy20: 0.4109 - val_accuracy30: 0.3876 - val_accuracy50: 0.3803 - 5s/epoch - 19ms/step
Epoch 21/50
260/260 - 5s - loss: 12.7625 - accuracy10: 0.4321 - accuracy20: 0.4303 - accuracy30: 0.4309 - accuracy50: 0.4187 - val_loss: 13.1168 - val_accuracy10: 0.4494 - val_accuracy20: 0.4164 - val_accuracy30: 0.3855 - val_accuracy50: 0.3813 - 5s/epoch - 18ms/step
Epoch 22/50
260/260 - 5s - loss: 12.7523 - accuracy10: 0.4338 - accuracy20: 0.4325 - accuracy30: 0.4349 - accuracy50: 0.4208 - val_loss: 13.1523 - val_accuracy10: 0.4467 - val_accuracy20: 0.4143 - val_accuracy30: 0.3884 - val_accuracy50: 0.3817 - 5s/epoch - 18ms/step
Epoch 23/50
260/260 - 5s - loss: 12.7356 - accuracy10: 0.4319 - accuracy20: 0.4319 - accuracy30: 0.4352 - accuracy50: 0.4212 - val_loss: 13.1303 - val_accuracy10: 0.4551 - val_accuracy20: 0.4176 - val_accuracy30: 0.3898 - val_accuracy50: 0.3817 - 5s/epoch - 19ms/step
Epoch 24/50
260/260 - 5s - loss: 12.7234 - accuracy10: 0.4372 - accuracy20: 0.4362 - accuracy30: 0.4386 - accuracy50: 0.4245 - val_loss: 13.1714 - val_accuracy10: 0.4533 - val_accuracy20: 0.4138 - val_accuracy30: 0.3862 - val_accuracy50: 0.3795 - 5s/epoch - 18ms/step
Epoch 25/50
260/260 - 5s - loss: 12.7110 - accuracy10: 0.4363 - accuracy20: 0.4365 - accuracy30: 0.4380 - accuracy50: 0.4251 - val_loss: 13.1989 - val_accuracy10: 0.4480 - val_accuracy20: 0.4153 - val_accuracy30: 0.3916 - val_accuracy50: 0.3771 - 5s/epoch - 18ms/step
testing model: results/LILAK/W1/deepOF_L1/seq2seq
Evaluating performance on  test set...
663/663 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0639739
{'0': {'precision': 0.3648929144258892, 'recall': 0.4483884680785284, 'f1-score': 0.4023546546911033, 'support': 51752}, '1': {'precision': 0.5101456340259583, 'recall': 0.5034275405892965, 'f1-score': 0.5067643231137072, 'support': 66520}, '2': {'precision': 0.37794535789343553, 'recall': 0.2973293653109257, 'f1-score': 0.3328252917610173, 'support': 51411}, 'accuracy': 0.42419688477926487, 'macro avg': {'precision': 0.41766130211509434, 'recall': 0.4163817913262502, 'f1-score': 0.41398142318860925, 'support': 169683}, 'weighted avg': {'precision': 0.4257902941215961, 'recall': 0.42419688477926487, 'f1-score': 0.4222196798608195, 'support': 169683}}
[[23205 16432 12115]
 [19988 33488 13044]
 [20401 15724 15286]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0823917
{'0': {'precision': 0.4117056277056277, 'recall': 0.39405340006960904, 'f1-score': 0.4026861551229179, 'support': 60337}, '1': {'precision': 0.38031098634161953, 'recall': 0.529281969270633, 'f1-score': 0.44259742018485293, 'support': 49399}, '2': {'precision': 0.41915987402741756, 'recall': 0.30195005588269636, 'f1-score': 0.3510292734483327, 'support': 59947}, 'accuracy': 0.4008828226752238, 'macro avg': {'precision': 0.4037254960248882, 'recall': 0.4084284750743128, 'f1-score': 0.3987709495853678, 'support': 169683}, 'weighted avg': {'precision': 0.405199353155506, 'recall': 0.4008828226752238, 'f1-score': 0.39605556453369073, 'support': 169683}}
[[23776 21821 14740]
 [12910 26146 10343]
 [21064 20782 18101]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0976332
{'0': {'precision': 0.4346774347155292, 'recall': 0.35023557758713303, 'f1-score': 0.3879143294237634, 'support': 65159}, '1': {'precision': 0.30052755547597076, 'recall': 0.5494887422555785, 'f1-score': 0.3885490405591915, 'support': 39706}, '2': {'precision': 0.4421416234887737, 'recall': 0.3041130550155821, 'f1-score': 0.3603623367245272, 'support': 64818}, 'accuracy': 0.3792424697818874, 'macro avg': {'precision': 0.3924488712267579, 'recall': 0.4012791249527646, 'f1-score': 0.37894190223582735, 'support': 169683}, 'weighted avg': {'precision': 0.4061375025055745, 'recall': 0.3792424697818874, 'f1-score': 0.37753813839439815, 'support': 169683}}
[[22821 26101 16237]
 [ 9254 21818  8634]
 [20426 24680 19712]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1021897
{'0': {'precision': 0.4022543881540637, 'recall': 0.318769879855629, 'f1-score': 0.35567896580575753, 'support': 60677}, '1': {'precision': 0.3116285717998363, 'recall': 0.4950458261084964, 'f1-score': 0.3824849881579892, 'support': 48444}, '2': {'precision': 0.40280453384704984, 'recall': 0.29691886001122814, 'f1-score': 0.34185011976730917, 'support': 60562}, 'accuracy': 0.36129724250514195, 'macro avg': {'precision': 0.37222916460031663, 'recall': 0.37024485532511786, 'f1-score': 0.36000469124368534, 'support': 169683}, 'weighted avg': {'precision': 0.3765773366874727, 'recall': 0.36129724250514195, 'f1-score': 0.35839631741464584, 'support': 169683}}
[[19342 27160 14175]
 [11977 23982 12485]
 [16765 25815 17982]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.034863
{'0': {'precision': 0.3157971225112629, 'recall': 0.4089198343996989, 'f1-score': 0.35637556375563756, 'support': 15942}, '1': {'precision': 0.5923784415350969, 'recall': 0.5853290311121636, 'f1-score': 0.5888326384752829, 'support': 33781}, '2': {'precision': 0.35453163746900246, 'recall': 0.2638095238095238, 'f1-score': 0.30251527251629634, 'support': 16800}, 'accuracy': 0.46185529816755105, 'macro avg': {'precision': 0.42090240050512073, 'recall': 0.41935279644046214, 'f1-score': 0.4159078249157389, 'support': 66523}, 'weighted avg': {'precision': 0.4660298749312404, 'recall': 0.46185529816755105, 'f1-score': 0.46081732898395567, 'support': 66523}}
[[ 6519  6605  2818]
 [ 8757 19773  5251]
 [ 5367  7001  4432]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0637368
{'0': {'precision': 0.37686235558575987, 'recall': 0.3684076042518397, 'f1-score': 0.3725870222497868, 'support': 19568}, '1': {'precision': 0.4633763059104269, 'recall': 0.6070067093626106, 'f1-score': 0.5255549137717633, 'support': 26232}, '2': {'precision': 0.41524058015501497, 'recall': 0.2611108430246586, 'f1-score': 0.32061385317295726, 'support': 20723}, 'accuracy': 0.4290696450851585, 'macro avg': {'precision': 0.4184930805504006, 'recall': 0.4121750522130363, 'f1-score': 0.4062519297315024, 'support': 66523}, 'weighted avg': {'precision': 0.42293282583913594, 'recall': 0.4290696450851585, 'f1-score': 0.41671632711615403, 'support': 66523}}
[[ 7209  8923  3436]
 [ 6125 15923  4184]
 [ 5795  9517  5411]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.082589
{'0': {'precision': 0.4186216185879448, 'recall': 0.3413105152374851, 'f1-score': 0.37603347449082475, 'support': 21854}, '1': {'precision': 0.38267046255320347, 'recall': 0.6283730617912521, 'f1-score': 0.47566658491293223, 'support': 21605}, '2': {'precision': 0.4538100997883278, 'recall': 0.2602757544224766, 'f1-score': 0.33081670891656567, 'support': 23064}, 'accuracy': 0.4064458908948785, 'macro avg': {'precision': 0.41836739364315867, 'recall': 0.4099864438170713, 'f1-score': 0.3941722561067742, 'support': 66523}, 'weighted avg': {'precision': 0.4191456840130616, 'recall': 0.4064458908948785, 'f1-score': 0.39271483085576503, 'support': 66523}}
[[ 7459 10604  3791]
 [ 4595 13576  3434]
 [ 5764 11297  6003]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0877402
{'0': {'precision': 0.4145360700996279, 'recall': 0.31699481389692047, 'f1-score': 0.3592624379079868, 'support': 21789}, '1': {'precision': 0.36557819788853424, 'recall': 0.6108578721852493, 'f1-score': 0.4574110418977729, 'support': 21938}, '2': {'precision': 0.43517116025446834, 'recall': 0.25206176522196877, 'f1-score': 0.31922222222222224, 'support': 22796}, 'accuracy': 0.39165401440103426, 'macro avg': {'precision': 0.4050951427475435, 'recall': 0.39330481710137954, 'f1-score': 0.37863190067599395, 'support': 66523}, 'weighted avg': {'precision': 0.4054619110058223, 'recall': 0.39165401440103426, 'f1-score': 0.37790903107960017, 'support': 66523}}
[[ 6907 11273  3609]
 [ 4688 13401  3849]
 [ 5067 11983  5746]]
Evaluating performance on  val set...
51/51 - 0s - 448ms/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0458947
{'0': {'precision': 0.2937426210153483, 'recall': 0.3961783439490446, 'f1-score': 0.33735593220338983, 'support': 3140}, '1': {'precision': 0.5971175892564691, 'recall': 0.5528430629264595, 'f1-score': 0.5741280214156366, 'support': 6595}, '2': {'precision': 0.3320031923383879, 'recall': 0.26735218508997427, 'f1-score': 0.296190815236739, 'support': 3112}, 'accuracy': 0.4453958122518876, 'macro avg': {'precision': 0.40762113420340174, 'recall': 0.40545786398849276, 'f1-score': 0.40255825628525516, 'support': 12847}, 'weighted avg': {'precision': 0.4587480552418206, 'recall': 0.4453958122518876, 'f1-score': 0.4489310925018681, 'support': 12847}}
[[1244 1269  627]
 [1902 3646 1047]
 [1089 1191  832]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0732168
{'0': {'precision': 0.3542520491803279, 'recall': 0.3570875290472502, 'f1-score': 0.35566413784235573, 'support': 3873}, '1': {'precision': 0.465646421170094, 'recall': 0.5624879645676872, 'f1-score': 0.5095063666492237, 'support': 5193}, '2': {'precision': 0.37940074906367044, 'recall': 0.26791854006876487, 'f1-score': 0.31405983568439, 'support': 3781}, 'accuracy': 0.4138709426325212, 'macro avg': {'precision': 0.39976640647136413, 'recall': 0.3958313445612341, 'f1-score': 0.3930767800586565, 'support': 12847}, 'weighted avg': {'precision': 0.4066812706329451, 'recall': 0.4138709426325212, 'f1-score': 0.40560551152763613, 'support': 12847}}
[[1383 1732  758]
 [1373 2921  899]
 [1148 1620 1013]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0922004
{'0': {'precision': 0.38248215266337177, 'recall': 0.32433061699650756, 'f1-score': 0.3510142371172987, 'support': 4295}, '1': {'precision': 0.38313290163428926, 'recall': 0.5720534069981584, 'f1-score': 0.4589104339796861, 'support': 4344}, '2': {'precision': 0.4023538065465245, 'recall': 0.2599809885931559, 'f1-score': 0.31586545402049954, 'support': 4208}, 'accuracy': 0.3870164240678758, 'macro avg': {'precision': 0.38932295361472846, 'recall': 0.38545500419594064, 'f1-score': 0.3752633750391614, 'support': 12847}, 'weighted avg': {'precision': 0.38921109895978123, 'recall': 0.3870164240678758, 'f1-score': 0.37598465821941435, 'support': 12847}}
[[1393 2059  843]
 [1077 2485  782]
 [1172 1942 1094]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.092274
{'0': {'precision': 0.35787923416789397, 'recall': 0.2969934001466634, 'f1-score': 0.3246059310713331, 'support': 4091}, '1': {'precision': 0.3990228013029316, 'recall': 0.5553266021017927, 'f1-score': 0.4643749461531834, 'support': 4853}, '2': {'precision': 0.3543365455893254, 'recall': 0.24493978990520113, 'f1-score': 0.2896530828662324, 'support': 3903}, 'accuracy': 0.37876547053786874, 'macro avg': {'precision': 0.37041286035338367, 'recall': 0.3657532640512191, 'f1-score': 0.35954465336358304, 'support': 12847}, 'weighted avg': {'precision': 0.3723450719342351, 'recall': 0.37876547053786874, 'f1-score': 0.36678527750612033, 'support': 12847}}
[[1215 2072  804]
 [1220 2695  938]
 [ 960 1987  956]]
training model: results/LILAK/W1/deepLOB_L2/seq2seq
Epoch 1/50
260/260 - 17s - loss: 13.2665 - accuracy10: 0.3526 - accuracy20: 0.3615 - accuracy30: 0.3640 - accuracy50: 0.3599 - val_loss: 13.4193 - val_accuracy10: 0.4743 - val_accuracy20: 0.3937 - val_accuracy30: 0.3481 - val_accuracy50: 0.3629 - 17s/epoch - 67ms/step
Epoch 2/50
260/260 - 12s - loss: 13.0739 - accuracy10: 0.3753 - accuracy20: 0.3839 - accuracy30: 0.3865 - accuracy50: 0.3808 - val_loss: 13.3222 - val_accuracy10: 0.4849 - val_accuracy20: 0.3981 - val_accuracy30: 0.3444 - val_accuracy50: 0.3839 - 12s/epoch - 46ms/step
Epoch 3/50
260/260 - 12s - loss: 12.9849 - accuracy10: 0.3744 - accuracy20: 0.3943 - accuracy30: 0.4032 - accuracy50: 0.3944 - val_loss: 13.1010 - val_accuracy10: 0.4703 - val_accuracy20: 0.4056 - val_accuracy30: 0.3591 - val_accuracy50: 0.3893 - 12s/epoch - 46ms/step
Epoch 4/50
260/260 - 12s - loss: 12.9107 - accuracy10: 0.3861 - accuracy20: 0.4053 - accuracy30: 0.4130 - accuracy50: 0.4038 - val_loss: 13.1760 - val_accuracy10: 0.4647 - val_accuracy20: 0.3988 - val_accuracy30: 0.3582 - val_accuracy50: 0.3869 - 12s/epoch - 46ms/step
Epoch 5/50
260/260 - 12s - loss: 12.8515 - accuracy10: 0.3930 - accuracy20: 0.4127 - accuracy30: 0.4187 - accuracy50: 0.4071 - val_loss: 13.1769 - val_accuracy10: 0.4420 - val_accuracy20: 0.3981 - val_accuracy30: 0.3670 - val_accuracy50: 0.3820 - 12s/epoch - 46ms/step
Epoch 6/50
260/260 - 12s - loss: 12.7811 - accuracy10: 0.4020 - accuracy20: 0.4218 - accuracy30: 0.4273 - accuracy50: 0.4149 - val_loss: 13.2128 - val_accuracy10: 0.4267 - val_accuracy20: 0.3917 - val_accuracy30: 0.3693 - val_accuracy50: 0.3863 - 12s/epoch - 46ms/step
Epoch 7/50
260/260 - 12s - loss: 12.7252 - accuracy10: 0.4147 - accuracy20: 0.4327 - accuracy30: 0.4377 - accuracy50: 0.4213 - val_loss: 13.1564 - val_accuracy10: 0.4562 - val_accuracy20: 0.4112 - val_accuracy30: 0.3745 - val_accuracy50: 0.3918 - 12s/epoch - 46ms/step
Epoch 8/50
260/260 - 12s - loss: 12.6640 - accuracy10: 0.4238 - accuracy20: 0.4403 - accuracy30: 0.4443 - accuracy50: 0.4289 - val_loss: 13.2292 - val_accuracy10: 0.4721 - val_accuracy20: 0.4194 - val_accuracy30: 0.3769 - val_accuracy50: 0.3929 - 12s/epoch - 46ms/step
Epoch 9/50
260/260 - 12s - loss: 12.6095 - accuracy10: 0.4311 - accuracy20: 0.4466 - accuracy30: 0.4499 - accuracy50: 0.4343 - val_loss: 13.3592 - val_accuracy10: 0.4320 - val_accuracy20: 0.4012 - val_accuracy30: 0.3763 - val_accuracy50: 0.3844 - 12s/epoch - 46ms/step
Epoch 10/50
260/260 - 12s - loss: 12.5591 - accuracy10: 0.4400 - accuracy20: 0.4528 - accuracy30: 0.4556 - accuracy50: 0.4376 - val_loss: 13.2174 - val_accuracy10: 0.4510 - val_accuracy20: 0.4164 - val_accuracy30: 0.3851 - val_accuracy50: 0.3935 - 12s/epoch - 45ms/step
Epoch 11/50
260/260 - 12s - loss: 12.5002 - accuracy10: 0.4445 - accuracy20: 0.4592 - accuracy30: 0.4617 - accuracy50: 0.4439 - val_loss: 13.2290 - val_accuracy10: 0.4278 - val_accuracy20: 0.4050 - val_accuracy30: 0.3863 - val_accuracy50: 0.3951 - 12s/epoch - 46ms/step
Epoch 12/50
260/260 - 12s - loss: 12.4578 - accuracy10: 0.4482 - accuracy20: 0.4624 - accuracy30: 0.4663 - accuracy50: 0.4480 - val_loss: 13.2605 - val_accuracy10: 0.4492 - val_accuracy20: 0.4097 - val_accuracy30: 0.3821 - val_accuracy50: 0.3949 - 12s/epoch - 46ms/step
Epoch 13/50
260/260 - 12s - loss: 12.4137 - accuracy10: 0.4539 - accuracy20: 0.4691 - accuracy30: 0.4709 - accuracy50: 0.4536 - val_loss: 13.3616 - val_accuracy10: 0.4469 - val_accuracy20: 0.4067 - val_accuracy30: 0.3792 - val_accuracy50: 0.3946 - 12s/epoch - 45ms/step
testing model: results/LILAK/W1/deepLOB_L2/seq2seq
Evaluating performance on  test set...
663/663 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0790688
{'0': {'precision': 0.39043596535185054, 'recall': 0.21077039012231175, 'f1-score': 0.2737573879108055, 'support': 51753}, '1': {'precision': 0.3967172001350417, 'recall': 0.7419199663269295, 'f1-score': 0.5169906980641917, 'support': 66522}, '2': {'precision': 0.39137453874538747, 'recall': 0.13202886429502267, 'f1-score': 0.19744898701223149, 'support': 51413}, 'accuracy': 0.39513695723916836, 'macro avg': {'precision': 0.39284256807742657, 'recall': 0.3615730735814213, 'f1-score': 0.32939902432907625, 'support': 169688}, 'weighted avg': {'precision': 0.39318274281477866, 'recall': 0.39513695723916836, 'f1-score': 0.34599067749301027, 'support': 169688}}
[[10908 36872  3973]
 [10585 49354  6583]
 [ 6445 38180  6788]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.113191
{'0': {'precision': 0.43835790543975595, 'recall': 0.1714811316064237, 'f1-score': 0.2465244272899467, 'support': 60339}, '1': {'precision': 0.29416939397779884, 'recall': 0.7987651821862348, 'f1-score': 0.42998414488631725, 'support': 49400}, '2': {'precision': 0.46061772829999165, 'recall': 0.09179469215499841, 'f1-score': 0.15308222988761544, 'support': 59949}, 'accuracy': 0.3259452642496818, 'macro avg': {'precision': 0.3977150092391821, 'recall': 0.35401366864921896, 'f1-score': 0.27653026735462644, 'support': 169688}, 'weighted avg': {'precision': 0.40424554424996995, 'recall': 0.3259452642496818, 'f1-score': 0.2669215311345813, 'support': 169688}}
[[10347 46817  3175]
 [ 6672 39459  3269]
 [ 6585 47861  5503]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1361375
{'0': {'precision': 0.46326844008520335, 'recall': 0.1435214315311306, 'f1-score': 0.21914983362234616, 'support': 65161}, '1': {'precision': 0.23600139116609528, 'recall': 0.8373838366031179, 'f1-score': 0.3682252098606835, 'support': 39707}, '2': {'precision': 0.4882721783557826, 'recall': 0.06487195310089479, 'f1-score': 0.11452772633184444, 'support': 64820}, 'accuracy': 0.2758415444816369, 'macro avg': {'precision': 0.39584733653569376, 'recall': 0.3485924070783811, 'f1-score': 0.23396758993829136, 'support': 169688}, 'weighted avg': {'precision': 0.41963924770429206, 'recall': 0.2758415444816369, 'f1-score': 0.21406833681482493, 'support': 169688}}
[[ 9352 53335  2474]
 [ 4524 33250  1933]
 [ 6311 54304  4205]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1264793
{'0': {'precision': 0.4139284249985357, 'recall': 0.11646725337024952, 'f1-score': 0.1817854432740415, 'support': 60678}, '1': {'precision': 0.28491424811153915, 'recall': 0.8579655699128927, 'f1-score': 0.4277730893522425, 'support': 48446}, '2': {'precision': 0.4437509288155744, 'recall': 0.04930321643220395, 'f1-score': 0.08874622917688317, 'support': 60564}, 'accuracy': 0.30419357880345105, 'macro avg': {'precision': 0.3808645339752164, 'recall': 0.3412453465717821, 'f1-score': 0.23276825393438905, 'support': 169688}, 'weighted avg': {'precision': 0.38773888482897567, 'recall': 0.30419357880345105, 'f1-score': 0.21880804086093172, 'support': 169688}}
[[ 7067 51806  1805]
 [ 4943 41565  1938]
 [ 5063 52515  2986]]
Evaluating performance on  train set...
260/260 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0289668
{'0': {'precision': 0.3484989993328886, 'recall': 0.16327040880110014, 'f1-score': 0.2223641084578385, 'support': 15998}, '1': {'precision': 0.5201564728099588, 'recall': 0.7995320043837564, 'f1-score': 0.6302726052186095, 'support': 33761}, '2': {'precision': 0.34791141014858423, 'recall': 0.14805535671677403, 'f1-score': 0.20771612687254162, 'support': 16764}, 'accuracy': 0.4823444522946951, 'macro avg': {'precision': 0.4055222940971439, 'recall': 0.3702859233005435, 'f1-score': 0.3534509468496632, 'support': 66523}, 'weighted avg': {'precision': 0.4354685830403836, 'recall': 0.4823444522946951, 'f1-score': 0.4256898754233162, 'support': 66523}}
[[ 2612 11972  1414]
 [ 3530 26993  3238]
 [ 1353 12929  2482]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0731403
{'0': {'precision': 0.41895030190431953, 'recall': 0.13827993254637436, 'f1-score': 0.20792992162286766, 'support': 19569}, '1': {'precision': 0.4062224345780653, 'recall': 0.8415181970458352, 'f1-score': 0.5479401120420405, 'support': 26268}, '2': {'precision': 0.42333569405099153, 'recall': 0.11558542009088273, 'f1-score': 0.18159033948507633, 'support': 20686}, 'accuracy': 0.4089112036438525, 'macro avg': {'precision': 0.4161694768444588, 'recall': 0.36512784989436414, 'f1-score': 0.3124867910499948, 'support': 66523}, 'weighted avg': {'precision': 0.4152881189453431, 'recall': 0.4089112036438525, 'f1-score': 0.3339995078686546, 'support': 66523}}
[[ 2706 15517  1346]
 [ 2252 22105  1911]
 [ 1501 16794  2391]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1039331
{'0': {'precision': 0.45571630204657726, 'recall': 0.11815021498490531, 'f1-score': 0.1876498365419542, 'support': 21862}, '1': {'precision': 0.33485813961767114, 'recall': 0.8697642163661581, 'f1-score': 0.48355009510101266, 'support': 21630}, '2': {'precision': 0.4585919109779585, 'recall': 0.09304849984803092, 'f1-score': 0.15470690153046493, 'support': 23031}, 'accuracy': 0.3538475414518287, 'macro avg': {'precision': 0.41638878421406894, 'recall': 0.36032097706636473, 'f1-score': 0.2753022777244773, 'support': 66523}, 'weighted avg': {'precision': 0.4174147536492019, 'recall': 0.3538475414518287, 'f1-score': 0.27245680340127837, 'support': 66523}}
[[ 2583 18016  1263]
 [ 1550 18813  1267]
 [ 1535 19353  2143]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1055624
{'0': {'precision': 0.44428772919605075, 'recall': 0.10114678899082569, 'f1-score': 0.16477973321376524, 'support': 21800}, '1': {'precision': 0.3384880023630393, 'recall': 0.8865880853775088, 'f1-score': 0.48992782234740834, 'support': 21973}, '2': {'precision': 0.4504616920389319, 'recall': 0.07934065934065934, 'f1-score': 0.13491796539223383, 'support': 22750}, 'accuracy': 0.3531259865009095, 'macro avg': {'precision': 0.41107914119934064, 'recall': 0.35569184456966463, 'f1-score': 0.2632085069844691, 'support': 66523}, 'weighted avg': {'precision': 0.41145277372161004, 'recall': 0.3531259865009095, 'f1-score': 0.2619660258432873, 'support': 66523}}
[[ 2205 18491  1104]
 [ 1394 19481  1098]
 [ 1364 19581  1805]]
Evaluating performance on  val set...
51/51 - 1s - 917ms/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0414625
{'0': {'precision': 0.3083961248654467, 'recall': 0.18087121212121213, 'f1-score': 0.22801432550736175, 'support': 3168}, '1': {'precision': 0.5118936324919497, 'recall': 0.752021974668091, 'f1-score': 0.6091470951792336, 'support': 6553}, '2': {'precision': 0.33186490455212925, 'recall': 0.14459373000639794, 'f1-score': 0.20142602495543668, 'support': 3126}, 'accuracy': 0.46337666381256326, 'macro avg': {'precision': 0.3840515539698419, 'recall': 0.35916230559856704, 'f1-score': 0.3461958152140107, 'support': 12847}, 'weighted avg': {'precision': 0.4179067166594098, 'recall': 0.46337666381256326, 'f1-score': 0.4159529891747127, 'support': 12847}}
[[ 573 2348  247]
 [ 962 4928  663]
 [ 323 2351  452]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0758564
{'0': {'precision': 0.3954659949622166, 'recall': 0.1604496678589678, 'f1-score': 0.2282806252271901, 'support': 3914}, '1': {'precision': 0.40751557632398755, 'recall': 0.8109259976753197, 'f1-score': 0.5424387715433459, 'support': 5162}, '2': {'precision': 0.4012158054711246, 'recall': 0.10501193317422435, 'f1-score': 0.1664564943253468, 'support': 3771}, 'accuracy': 0.40554214991826887, 'macro avg': {'precision': 0.4013991255857763, 'recall': 0.3587958662361706, 'f1-score': 0.3123919636986276, 'support': 12847}, 'weighted avg': {'precision': 0.4019953383434382, 'recall': 0.40554214991826887, 'f1-score': 0.3363638784110576, 'support': 12847}}
[[ 628 3056  230]
 [ 615 4186  361]
 [ 345 3030  396]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0971208
{'0': {'precision': 0.4344978165938865, 'recall': 0.13768450184501846, 'f1-score': 0.20910683012259193, 'support': 4336}, '1': {'precision': 0.34312080536912754, 'recall': 0.8516890328551596, 'f1-score': 0.4891694352159469, 'support': 4322}, '2': {'precision': 0.43355704697986575, 'recall': 0.07710670804487944, 'f1-score': 0.13092825293879207, 'support': 4189}, 'accuracy': 0.35813808671285124, 'macro avg': {'precision': 0.40372522298095986, 'recall': 0.3554934142483525, 'f1-score': 0.2764015060924436, 'support': 12847}, 'weighted avg': {'precision': 0.4034499200867999, 'recall': 0.35813808671285124, 'f1-score': 0.2778341998891166, 'support': 12847}}
[[ 597 3535  204]
 [ 423 3681  218]
 [ 354 3512  323]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.083912
{'0': {'precision': 0.4193817878028404, 'recall': 0.12276840303252629, 'f1-score': 0.18993567915247822, 'support': 4089}, '1': {'precision': 0.38321399438049486, 'recall': 0.867816091954023, 'f1-score': 0.5316567117258724, 'support': 4872}, '2': {'precision': 0.3727714748784441, 'recall': 0.05918682449819866, 'f1-score': 0.10215411947590494, 'support': 3886}, 'accuracy': 0.38608235385693157, 'macro avg': {'precision': 0.39178908568725984, 'recall': 0.3499237731615826, 'f1-score': 0.27458217011808517, 'support': 12847}, 'weighted avg': {'precision': 0.39156695433371363, 'recall': 0.38608235385693157, 'f1-score': 0.2929749669079396, 'support': 12847}}
[[ 502 3431  156]
 [ 413 4228  231]
 [ 282 3374  230]]
training model: results/LILAK/W1/deepOF_L2/seq2seq
Epoch 1/50
260/260 - 12s - loss: 13.2348 - accuracy10: 0.3678 - accuracy20: 0.3657 - accuracy30: 0.3588 - accuracy50: 0.3490 - val_loss: 13.3838 - val_accuracy10: 0.4582 - val_accuracy20: 0.3992 - val_accuracy30: 0.3592 - val_accuracy50: 0.3769 - 12s/epoch - 47ms/step
Epoch 2/50
260/260 - 7s - loss: 13.1249 - accuracy10: 0.3980 - accuracy20: 0.3844 - accuracy30: 0.3773 - accuracy50: 0.3659 - val_loss: 13.1532 - val_accuracy10: 0.4674 - val_accuracy20: 0.4121 - val_accuracy30: 0.3753 - val_accuracy50: 0.3824 - 7s/epoch - 28ms/step
Epoch 3/50
260/260 - 7s - loss: 12.9982 - accuracy10: 0.4165 - accuracy20: 0.4033 - accuracy30: 0.3948 - accuracy50: 0.3832 - val_loss: 13.0583 - val_accuracy10: 0.4770 - val_accuracy20: 0.4241 - val_accuracy30: 0.3855 - val_accuracy50: 0.3843 - 7s/epoch - 28ms/step
Epoch 4/50
260/260 - 7s - loss: 12.9081 - accuracy10: 0.4264 - accuracy20: 0.4139 - accuracy30: 0.4073 - accuracy50: 0.3933 - val_loss: 12.9597 - val_accuracy10: 0.4708 - val_accuracy20: 0.4287 - val_accuracy30: 0.3992 - val_accuracy50: 0.3911 - 7s/epoch - 28ms/step
Epoch 5/50
260/260 - 7s - loss: 12.8186 - accuracy10: 0.4374 - accuracy20: 0.4252 - accuracy30: 0.4172 - accuracy50: 0.4020 - val_loss: 12.8859 - val_accuracy10: 0.4715 - val_accuracy20: 0.4347 - val_accuracy30: 0.4071 - val_accuracy50: 0.3966 - 7s/epoch - 28ms/step
Epoch 6/50
260/260 - 7s - loss: 12.7445 - accuracy10: 0.4457 - accuracy20: 0.4347 - accuracy30: 0.4277 - accuracy50: 0.4098 - val_loss: 12.8892 - val_accuracy10: 0.4743 - val_accuracy20: 0.4387 - val_accuracy30: 0.4132 - val_accuracy50: 0.3954 - 7s/epoch - 27ms/step
Epoch 7/50
260/260 - 7s - loss: 12.6658 - accuracy10: 0.4515 - accuracy20: 0.4423 - accuracy30: 0.4371 - accuracy50: 0.4186 - val_loss: 12.8341 - val_accuracy10: 0.4693 - val_accuracy20: 0.4431 - val_accuracy30: 0.4140 - val_accuracy50: 0.3968 - 7s/epoch - 27ms/step
Epoch 8/50
260/260 - 7s - loss: 12.5952 - accuracy10: 0.4549 - accuracy20: 0.4511 - accuracy30: 0.4458 - accuracy50: 0.4261 - val_loss: 12.8562 - val_accuracy10: 0.4682 - val_accuracy20: 0.4399 - val_accuracy30: 0.4141 - val_accuracy50: 0.3984 - 7s/epoch - 27ms/step
Epoch 9/50
260/260 - 7s - loss: 12.5264 - accuracy10: 0.4579 - accuracy20: 0.4563 - accuracy30: 0.4536 - accuracy50: 0.4334 - val_loss: 12.8508 - val_accuracy10: 0.4761 - val_accuracy20: 0.4491 - val_accuracy30: 0.4206 - val_accuracy50: 0.3981 - 7s/epoch - 27ms/step
Epoch 10/50
260/260 - 7s - loss: 12.4694 - accuracy10: 0.4598 - accuracy20: 0.4616 - accuracy30: 0.4608 - accuracy50: 0.4381 - val_loss: 12.8195 - val_accuracy10: 0.4677 - val_accuracy20: 0.4410 - val_accuracy30: 0.4177 - val_accuracy50: 0.3981 - 7s/epoch - 27ms/step
Epoch 11/50
260/260 - 7s - loss: 12.3979 - accuracy10: 0.4633 - accuracy20: 0.4672 - accuracy30: 0.4670 - accuracy50: 0.4463 - val_loss: 12.8948 - val_accuracy10: 0.4635 - val_accuracy20: 0.4420 - val_accuracy30: 0.4192 - val_accuracy50: 0.3966 - 7s/epoch - 27ms/step
Epoch 12/50
260/260 - 7s - loss: 12.3270 - accuracy10: 0.4665 - accuracy20: 0.4738 - accuracy30: 0.4765 - accuracy50: 0.4532 - val_loss: 12.8789 - val_accuracy10: 0.4687 - val_accuracy20: 0.4404 - val_accuracy30: 0.4207 - val_accuracy50: 0.4002 - 7s/epoch - 27ms/step
Epoch 13/50
260/260 - 7s - loss: 12.2509 - accuracy10: 0.4644 - accuracy20: 0.4771 - accuracy30: 0.4824 - accuracy50: 0.4587 - val_loss: 12.9178 - val_accuracy10: 0.4532 - val_accuracy20: 0.4404 - val_accuracy30: 0.4244 - val_accuracy50: 0.4005 - 7s/epoch - 28ms/step
Epoch 14/50
260/260 - 7s - loss: 12.1953 - accuracy10: 0.4678 - accuracy20: 0.4822 - accuracy30: 0.4896 - accuracy50: 0.4666 - val_loss: 12.9175 - val_accuracy10: 0.4467 - val_accuracy20: 0.4356 - val_accuracy30: 0.4227 - val_accuracy50: 0.3968 - 7s/epoch - 28ms/step
Epoch 15/50
260/260 - 7s - loss: 12.1305 - accuracy10: 0.4700 - accuracy20: 0.4855 - accuracy30: 0.4922 - accuracy50: 0.4704 - val_loss: 12.9194 - val_accuracy10: 0.4573 - val_accuracy20: 0.4430 - val_accuracy30: 0.4245 - val_accuracy50: 0.4005 - 7s/epoch - 27ms/step
Epoch 16/50
260/260 - 7s - loss: 12.0739 - accuracy10: 0.4699 - accuracy20: 0.4883 - accuracy30: 0.4974 - accuracy50: 0.4760 - val_loss: 12.9501 - val_accuracy10: 0.4512 - val_accuracy20: 0.4400 - val_accuracy30: 0.4240 - val_accuracy50: 0.4003 - 7s/epoch - 27ms/step
Epoch 17/50
260/260 - 7s - loss: 11.9834 - accuracy10: 0.4737 - accuracy20: 0.4962 - accuracy30: 0.5065 - accuracy50: 0.4863 - val_loss: 13.0663 - val_accuracy10: 0.4318 - val_accuracy20: 0.4305 - val_accuracy30: 0.4250 - val_accuracy50: 0.3905 - 7s/epoch - 27ms/step
Epoch 18/50
260/260 - 7s - loss: 11.9317 - accuracy10: 0.4772 - accuracy20: 0.5011 - accuracy30: 0.5113 - accuracy50: 0.4898 - val_loss: 12.9937 - val_accuracy10: 0.4535 - val_accuracy20: 0.4446 - val_accuracy30: 0.4305 - val_accuracy50: 0.4027 - 7s/epoch - 27ms/step
Epoch 19/50
260/260 - 7s - loss: 11.8508 - accuracy10: 0.4792 - accuracy20: 0.5048 - accuracy30: 0.5192 - accuracy50: 0.4976 - val_loss: 13.1906 - val_accuracy10: 0.4533 - val_accuracy20: 0.4403 - val_accuracy30: 0.4269 - val_accuracy50: 0.4031 - 7s/epoch - 27ms/step
Epoch 20/50
260/260 - 7s - loss: 11.8005 - accuracy10: 0.4779 - accuracy20: 0.5073 - accuracy30: 0.5220 - accuracy50: 0.5027 - val_loss: 13.2913 - val_accuracy10: 0.4446 - val_accuracy20: 0.4333 - val_accuracy30: 0.4195 - val_accuracy50: 0.3919 - 7s/epoch - 26ms/step
testing model: results/LILAK/W1/deepOF_L2/seq2seq
Evaluating performance on  test set...
663/663 - 7s - 7s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0412061
{'0': {'precision': 0.416012815483196, 'recall': 0.49176843407018084, 'f1-score': 0.45072966846132045, 'support': 51752}, '1': {'precision': 0.5437072597913932, 'recall': 0.4733162958508719, 'f1-score': 0.5060758028739512, 'support': 66520}, '2': {'precision': 0.42425739639123305, 'recall': 0.4175565540448542, 'f1-score': 0.42088030585236735, 'support': 51411}, 'accuracy': 0.46204982231572994, 'macro avg': {'precision': 0.4613258238886074, 'recall': 0.46088042798863565, 'f1-score': 0.45922859239587965, 'support': 169683}, 'weighted avg': {'precision': 0.46857021124142967, 'recall': 0.46204982231572994, 'f1-score': 0.4633829058512729, 'support': 169683}}
[[25450 13367 12935]
 [18838 31485 16197]
 [16888 13056 21467]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0603582
{'0': {'precision': 0.45923417556655377, 'recall': 0.4675074995442266, 'f1-score': 0.4633339082300572, 'support': 60337}, '1': {'precision': 0.4174371140494714, 'recall': 0.48442276159436426, 'f1-score': 0.44844225814007965, 'support': 49399}, '2': {'precision': 0.4660239923036146, 'recall': 0.3959497556174621, 'f1-score': 0.42813852813852815, 'support': 59947}, 'accuracy': 0.4471514530035419, 'macro avg': {'precision': 0.4475650939732132, 'recall': 0.44929333891868434, 'f1-score': 0.44663823150288834, 'support': 169683}, 'weighted avg': {'precision': 0.44946475907848027, 'recall': 0.4471514530035419, 'f1-score': 0.4465644612427827, 'support': 169683}}
[[28208 16925 15204]
 [13476 23930 11993]
 [19740 16471 23736]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0782111
{'0': {'precision': 0.4765345331537982, 'recall': 0.4453720898110775, 'f1-score': 0.46042663239645554, 'support': 65159}, '1': {'precision': 0.33472442331396374, 'recall': 0.47874376668513574, 'f1-score': 0.3939852429116233, 'support': 39706}, '2': {'precision': 0.4819694201365516, 'recall': 0.3866210003394119, 'f1-score': 0.4290618338712301, 'support': 64818}, 'accuracy': 0.43073849472251197, 'macro avg': {'precision': 0.4310761255347712, 'recall': 0.43691228561187506, 'f1-score': 0.4278245697264363, 'support': 169683}, 'weighted avg': {'precision': 0.44542691649890426, 'recall': 0.43073849472251197, 'f1-score': 0.43289809199056445, 'support': 169683}}
[[29020 19267 16872]
 [10634 19009 10063]
 [21244 18514 25060]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0957377
{'0': {'precision': 0.4266477082636333, 'recall': 0.4203404914547522, 'f1-score': 0.423470616070465, 'support': 60677}, '1': {'precision': 0.3398399547775089, 'recall': 0.39711832218644205, 'f1-score': 0.3662532245628397, 'support': 48444}, '2': {'precision': 0.4306863812061395, 'recall': 0.3790000330240085, 'f1-score': 0.40319350758853284, 'support': 60562}, 'accuracy': 0.39895569974599693, 'macro avg': {'precision': 0.39905801474909386, 'recall': 0.39881961555506756, 'f1-score': 0.39763911607394586, 'support': 169683}, 'weighted avg': {'precision': 0.4033058018903505, 'recall': 0.39895569974599693, 'f1-score': 0.3998980627912433, 'support': 169683}}
[[25505 19061 16111]
 [14976 19238 14230]
 [19299 18310 22953]]
Evaluating performance on  train set...
260/260 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0052513
{'0': {'precision': 0.38050960649337306, 'recall': 0.4646217538577343, 'f1-score': 0.41838002711251693, 'support': 15942}, '1': {'precision': 0.6348922177566679, 'recall': 0.5144015866907433, 'f1-score': 0.5683308531340453, 'support': 33781}, '2': {'precision': 0.3879717580129019, 'recall': 0.4546428571428571, 'f1-score': 0.41866966316770354, 'support': 16800}, 'accuracy': 0.48738030455631887, 'macro avg': {'precision': 0.4677911940876476, 'recall': 0.47788873256377823, 'f1-score': 0.4684601811380886, 'support': 66523}, 'weighted avg': {'precision': 0.5115719929854652, 'recall': 0.48738030455631887, 'f1-score': 0.4945996013884874, 'support': 66523}}
[[ 7407  4849  3686]
 [ 8041 17377  8363]
 [ 4018  5144  7638]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0225532
{'0': {'precision': 0.4411373631993454, 'recall': 0.44082174979558464, 'f1-score': 0.440979500025561, 'support': 19568}, '1': {'precision': 0.5118543292456336, 'recall': 0.5250838670326319, 'f1-score': 0.5183847051296526, 'support': 26232}, '2': {'precision': 0.45705169749239744, 'recall': 0.44240698740529844, 'f1-score': 0.4496101221126968, 'support': 20723}, 'accuracy': 0.4745426393878809, 'macro avg': {'precision': 0.4700144633124588, 'recall': 0.469437534744505, 'f1-score': 0.46965810908930344, 'support': 66523}, 'weighted avg': {'precision': 0.473980743727601, 'recall': 0.4745426393878809, 'f1-score': 0.4741912571892825, 'support': 66523}}
[[ 8626  6453  4489]
 [ 6056 13774  6402]
 [ 4872  6683  9168]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0417093
{'0': {'precision': 0.4708021719086159, 'recall': 0.4205637411915439, 'f1-score': 0.4442672080433101, 'support': 21854}, '1': {'precision': 0.42593644661591484, 'recall': 0.5205276556352696, 'f1-score': 0.46850524912514585, 'support': 21605}, '2': {'precision': 0.49169822312845907, 'recall': 0.43912591050988553, 'f1-score': 0.4639274426274564, 'support': 23064}, 'accuracy': 0.4594651473926311, 'macro avg': {'precision': 0.4628122805509966, 'recall': 0.46007243577889967, 'f1-score': 0.45889996659863747, 'support': 66523}, 'weighted avg': {'precision': 0.463475721363476, 'recall': 0.4594651473926311, 'f1-score': 0.45895545914476094, 'support': 66523}}
[[ 9191  7556  5107]
 [ 4996 11246  5363]
 [ 5335  7601 10128]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0607847
{'0': {'precision': 0.44619694925806785, 'recall': 0.39469457065491764, 'f1-score': 0.41886856781043763, 'support': 21789}, '1': {'precision': 0.4011964566476205, 'recall': 0.4768894156258547, 'f1-score': 0.43578048526502133, 'support': 21938}, '2': {'precision': 0.46367844322690344, 'recall': 0.43064572732058254, 'f1-score': 0.4465520378457059, 'support': 22796}, 'accuracy': 0.43412052974159315, 'macro avg': {'precision': 0.43702394971086395, 'recall': 0.4340765712004517, 'f1-score': 0.4337336969737216, 'support': 66523}, 'weighted avg': {'precision': 0.43734718796686906, 'recall': 0.43412052974159315, 'f1-score': 0.4339323206183783, 'support': 66523}}
[[ 8600  7930  5259]
 [ 5380 10462  6096]
 [ 5294  7685  9817]]
Evaluating performance on  val set...
51/51 - 1s - 665ms/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0266408
{'0': {'precision': 0.33186490455212925, 'recall': 0.4318471337579618, 'f1-score': 0.3753113755881539, 'support': 3140}, '1': {'precision': 0.625022502250225, 'recall': 0.5264594389689159, 'f1-score': 0.571522633744856, 'support': 6595}, '2': {'precision': 0.38053649407361195, 'recall': 0.39203084832904883, 'f1-score': 0.3861981639759417, 'support': 3112}, 'accuracy': 0.4707713863158714, 'macro avg': {'precision': 0.44580796695865543, 'recall': 0.4501124736853088, 'f1-score': 0.4443440577696505, 'support': 12847}, 'weighted avg': {'precision': 0.49414717616494125, 'recall': 0.4707713863158714, 'f1-score': 0.4786734782585241, 'support': 12847}}
[[1356 1094  690]
 [1827 3472 1296]
 [ 903  989 1220]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0490735
{'0': {'precision': 0.3896198830409357, 'recall': 0.412858249419055, 'f1-score': 0.40090259496051145, 'support': 3873}, '1': {'precision': 0.5017345262004748, 'recall': 0.5291738879260544, 'f1-score': 0.5150890346766636, 'support': 5193}, '2': {'precision': 0.4265156154317208, 'recall': 0.3684210526315789, 'f1-score': 0.39534553710798925, 'support': 3781}, 'accuracy': 0.44679691756830386, 'macro avg': {'precision': 0.4392900082243771, 'recall': 0.4368177299922294, 'f1-score': 0.4371123889150548, 'support': 12847}, 'weighted avg': {'precision': 0.44579752031789094, 'recall': 0.44679691756830386, 'f1-score': 0.4454234127160646, 'support': 12847}}
[[1599 1420  854]
 [1426 2748 1019]
 [1079 1309 1393]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0724394
{'0': {'precision': 0.4118937362905191, 'recall': 0.39348079161816063, 'f1-score': 0.4024767801857585, 'support': 4295}, '1': {'precision': 0.4153444091842449, 'recall': 0.5122007366482505, 'f1-score': 0.45871559633027525, 'support': 4344}, '2': {'precision': 0.4470032477118394, 'recall': 0.3597908745247148, 'f1-score': 0.39868334430546415, 'support': 4208}, 'accuracy': 0.4225889312680003, 'macro avg': {'precision': 0.42474713106220113, 'recall': 0.4218241342637086, 'f1-score': 0.419958573607166, 'support': 12847}, 'weighted avg': {'precision': 0.42456054932945897, 'recall': 0.4225889312680003, 'f1-score': 0.42025047358869316, 'support': 12847}}
[[1690 1639  966]
 [1212 2225  907]
 [1201 1493 1514]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0831115
{'0': {'precision': 0.38557457212713936, 'recall': 0.38548032265949644, 'f1-score': 0.3855274416330522, 'support': 4091}, '1': {'precision': 0.423904833836858, 'recall': 0.46260045332783845, 'f1-score': 0.44240811902650506, 'support': 4853}, '2': {'precision': 0.3822594625830685, 'recall': 0.3389700230591852, 'f1-score': 0.3593155893536122, 'support': 3903}, 'accuracy': 0.4004826029423212, 'macro avg': {'precision': 0.3972462895156886, 'recall': 0.3956835996821734, 'f1-score': 0.39575038333772317, 'support': 12847}, 'weighted avg': {'precision': 0.39904681370313033, 'recall': 0.4004826029423212, 'f1-score': 0.3990509932749743, 'support': 12847}}
[[1577 1590  924]
 [1394 2245 1214]
 [1119 1461 1323]]
training model: results/LILAK/W1/deepVOL_L2/seq2seq
Epoch 1/50
260/260 - 12s - loss: 13.2624 - accuracy10: 0.3516 - accuracy20: 0.3637 - accuracy30: 0.3667 - accuracy50: 0.3638 - val_loss: 13.7599 - val_accuracy10: 0.5051 - val_accuracy20: 0.4002 - val_accuracy30: 0.3369 - val_accuracy50: 0.3794 - 12s/epoch - 48ms/step
Epoch 2/50
260/260 - 8s - loss: 13.1414 - accuracy10: 0.3665 - accuracy20: 0.3731 - accuracy30: 0.3748 - accuracy50: 0.3733 - val_loss: 13.6370 - val_accuracy10: 0.5066 - val_accuracy20: 0.4009 - val_accuracy30: 0.3374 - val_accuracy50: 0.3800 - 8s/epoch - 31ms/step
Epoch 3/50
260/260 - 7s - loss: 13.0929 - accuracy10: 0.3576 - accuracy20: 0.3717 - accuracy30: 0.3822 - accuracy50: 0.3799 - val_loss: 13.5116 - val_accuracy10: 0.4800 - val_accuracy20: 0.3965 - val_accuracy30: 0.3374 - val_accuracy50: 0.3792 - 7s/epoch - 27ms/step
Epoch 4/50
260/260 - 7s - loss: 13.0437 - accuracy10: 0.3613 - accuracy20: 0.3810 - accuracy30: 0.3879 - accuracy50: 0.3831 - val_loss: 13.4884 - val_accuracy10: 0.4732 - val_accuracy20: 0.3949 - val_accuracy30: 0.3416 - val_accuracy50: 0.3791 - 7s/epoch - 27ms/step
Epoch 5/50
260/260 - 7s - loss: 12.9890 - accuracy10: 0.3621 - accuracy20: 0.3863 - accuracy30: 0.3952 - accuracy50: 0.3897 - val_loss: 13.3604 - val_accuracy10: 0.4498 - val_accuracy20: 0.3869 - val_accuracy30: 0.3404 - val_accuracy50: 0.3782 - 7s/epoch - 27ms/step
Epoch 6/50
260/260 - 7s - loss: 12.9356 - accuracy10: 0.3714 - accuracy20: 0.3958 - accuracy30: 0.4055 - accuracy50: 0.4018 - val_loss: 13.4087 - val_accuracy10: 0.4840 - val_accuracy20: 0.3989 - val_accuracy30: 0.3451 - val_accuracy50: 0.3816 - 7s/epoch - 27ms/step
Epoch 7/50
260/260 - 7s - loss: 12.8864 - accuracy10: 0.3789 - accuracy20: 0.4023 - accuracy30: 0.4135 - accuracy50: 0.4103 - val_loss: 13.3527 - val_accuracy10: 0.4768 - val_accuracy20: 0.3981 - val_accuracy30: 0.3475 - val_accuracy50: 0.3822 - 7s/epoch - 27ms/step
Epoch 8/50
260/260 - 7s - loss: 12.8469 - accuracy10: 0.3853 - accuracy20: 0.4081 - accuracy30: 0.4182 - accuracy50: 0.4101 - val_loss: 13.3084 - val_accuracy10: 0.4526 - val_accuracy20: 0.3953 - val_accuracy30: 0.3502 - val_accuracy50: 0.3767 - 7s/epoch - 27ms/step
Epoch 9/50
260/260 - 7s - loss: 12.8219 - accuracy10: 0.3901 - accuracy20: 0.4129 - accuracy30: 0.4223 - accuracy50: 0.4140 - val_loss: 13.3963 - val_accuracy10: 0.4509 - val_accuracy20: 0.3933 - val_accuracy30: 0.3465 - val_accuracy50: 0.3755 - 7s/epoch - 27ms/step
Epoch 10/50
260/260 - 7s - loss: 12.7625 - accuracy10: 0.3996 - accuracy20: 0.4226 - accuracy30: 0.4300 - accuracy50: 0.4199 - val_loss: 13.2891 - val_accuracy10: 0.4480 - val_accuracy20: 0.3922 - val_accuracy30: 0.3546 - val_accuracy50: 0.3802 - 7s/epoch - 27ms/step
Epoch 11/50
260/260 - 7s - loss: 12.7297 - accuracy10: 0.4053 - accuracy20: 0.4261 - accuracy30: 0.4340 - accuracy50: 0.4245 - val_loss: 13.4323 - val_accuracy10: 0.4522 - val_accuracy20: 0.3918 - val_accuracy30: 0.3538 - val_accuracy50: 0.3816 - 7s/epoch - 27ms/step
Epoch 12/50
260/260 - 7s - loss: 12.7095 - accuracy10: 0.4108 - accuracy20: 0.4294 - accuracy30: 0.4348 - accuracy50: 0.4243 - val_loss: 13.2946 - val_accuracy10: 0.4454 - val_accuracy20: 0.3978 - val_accuracy30: 0.3668 - val_accuracy50: 0.3795 - 7s/epoch - 27ms/step
Epoch 13/50
260/260 - 7s - loss: 12.6597 - accuracy10: 0.4183 - accuracy20: 0.4362 - accuracy30: 0.4418 - accuracy50: 0.4300 - val_loss: 13.3955 - val_accuracy10: 0.4651 - val_accuracy20: 0.4012 - val_accuracy30: 0.3566 - val_accuracy50: 0.3820 - 7s/epoch - 27ms/step
Epoch 14/50
260/260 - 7s - loss: 12.6308 - accuracy10: 0.4216 - accuracy20: 0.4395 - accuracy30: 0.4443 - accuracy50: 0.4316 - val_loss: 13.2884 - val_accuracy10: 0.4651 - val_accuracy20: 0.4046 - val_accuracy30: 0.3642 - val_accuracy50: 0.3871 - 7s/epoch - 26ms/step
Epoch 15/50
260/260 - 7s - loss: 12.5826 - accuracy10: 0.4280 - accuracy20: 0.4457 - accuracy30: 0.4491 - accuracy50: 0.4367 - val_loss: 13.3125 - val_accuracy10: 0.4701 - val_accuracy20: 0.4112 - val_accuracy30: 0.3730 - val_accuracy50: 0.3886 - 7s/epoch - 26ms/step
Epoch 16/50
260/260 - 7s - loss: 12.5574 - accuracy10: 0.4302 - accuracy20: 0.4495 - accuracy30: 0.4517 - accuracy50: 0.4374 - val_loss: 13.3595 - val_accuracy10: 0.4612 - val_accuracy20: 0.4097 - val_accuracy30: 0.3727 - val_accuracy50: 0.3848 - 7s/epoch - 26ms/step
Epoch 17/50
260/260 - 7s - loss: 12.5371 - accuracy10: 0.4356 - accuracy20: 0.4532 - accuracy30: 0.4553 - accuracy50: 0.4397 - val_loss: 13.3722 - val_accuracy10: 0.4647 - val_accuracy20: 0.4108 - val_accuracy30: 0.3721 - val_accuracy50: 0.3862 - 7s/epoch - 26ms/step
Epoch 18/50
260/260 - 7s - loss: 12.4978 - accuracy10: 0.4397 - accuracy20: 0.4568 - accuracy30: 0.4599 - accuracy50: 0.4470 - val_loss: 13.4412 - val_accuracy10: 0.4579 - val_accuracy20: 0.4087 - val_accuracy30: 0.3704 - val_accuracy50: 0.3837 - 7s/epoch - 27ms/step
Epoch 19/50
260/260 - 7s - loss: 12.4570 - accuracy10: 0.4469 - accuracy20: 0.4628 - accuracy30: 0.4648 - accuracy50: 0.4483 - val_loss: 13.5211 - val_accuracy10: 0.4631 - val_accuracy20: 0.4116 - val_accuracy30: 0.3714 - val_accuracy50: 0.3868 - 7s/epoch - 26ms/step
Epoch 20/50
260/260 - 7s - loss: 12.4361 - accuracy10: 0.4472 - accuracy20: 0.4648 - accuracy30: 0.4688 - accuracy50: 0.4498 - val_loss: 13.4555 - val_accuracy10: 0.4429 - val_accuracy20: 0.4029 - val_accuracy30: 0.3698 - val_accuracy50: 0.3813 - 7s/epoch - 26ms/step
Epoch 21/50
260/260 - 7s - loss: 12.4074 - accuracy10: 0.4495 - accuracy20: 0.4673 - accuracy30: 0.4690 - accuracy50: 0.4516 - val_loss: 13.4479 - val_accuracy10: 0.4708 - val_accuracy20: 0.4104 - val_accuracy30: 0.3711 - val_accuracy50: 0.3847 - 7s/epoch - 27ms/step
Epoch 22/50
260/260 - 7s - loss: 12.3798 - accuracy10: 0.4507 - accuracy20: 0.4704 - accuracy30: 0.4744 - accuracy50: 0.4553 - val_loss: 13.6132 - val_accuracy10: 0.4610 - val_accuracy20: 0.4041 - val_accuracy30: 0.3677 - val_accuracy50: 0.3786 - 7s/epoch - 26ms/step
Epoch 23/50
260/260 - 7s - loss: 12.3427 - accuracy10: 0.4565 - accuracy20: 0.4738 - accuracy30: 0.4747 - accuracy50: 0.4581 - val_loss: 13.5359 - val_accuracy10: 0.4607 - val_accuracy20: 0.4062 - val_accuracy30: 0.3696 - val_accuracy50: 0.3831 - 7s/epoch - 26ms/step
Epoch 24/50
260/260 - 7s - loss: 12.3008 - accuracy10: 0.4564 - accuracy20: 0.4751 - accuracy30: 0.4791 - accuracy50: 0.4604 - val_loss: 13.5551 - val_accuracy10: 0.4572 - val_accuracy20: 0.4129 - val_accuracy30: 0.3785 - val_accuracy50: 0.3890 - 7s/epoch - 27ms/step
testing model: results/LILAK/W1/deepVOL_L2/seq2seq
Evaluating performance on  test set...
663/663 - 7s - 7s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0846498
{'0': {'precision': 0.4143858965617999, 'recall': 0.1644155894344289, 'f1-score': 0.23542269011025493, 'support': 51753}, '1': {'precision': 0.4078607261629639, 'recall': 0.7614172754878086, 'f1-score': 0.5311862575966526, 'support': 66522}, '2': {'precision': 0.3967637281211199, 'recall': 0.19267500437632507, 'f1-score': 0.2593872741555381, 'support': 51413}, 'accuracy': 0.4070175852152185, 'macro avg': {'precision': 0.4063367836152945, 'recall': 0.3728359564328542, 'f1-score': 0.3419987406208152, 'support': 169688}, 'weighted avg': {'precision': 0.40648860310962864, 'recall': 0.4070175852152185, 'f1-score': 0.358630431352124, 'support': 169688}}
[[ 8509 36754  6490]
 [ 7300 50651  8571]
 [ 4725 36782  9906]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1340016
{'0': {'precision': 0.46738782905254184, 'recall': 0.1453620378196523, 'f1-score': 0.22175589406485052, 'support': 60339}, '1': {'precision': 0.3036742955005449, 'recall': 0.7896761133603238, 'f1-score': 0.4386596199257843, 'support': 49400}, '2': {'precision': 0.4587303000623275, 'recall': 0.17187943084955545, 'f1-score': 0.25006370508791304, 'support': 59949}, 'accuracy': 0.3423047003913064, 'macro avg': {'precision': 0.40993080820513805, 'recall': 0.3689725273431772, 'f1-score': 0.3034930730261826, 'support': 169688}, 'weighted avg': {'precision': 0.41666851617889716, 'recall': 0.3423047003913064, 'f1-score': 0.29490230996079897, 'support': 169688}}
[[ 8771 44822  6746]
 [ 4978 39010  5412]
 [ 5017 44628 10304]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1624241
{'0': {'precision': 0.4894864656755316, 'recall': 0.12682432743512223, 'f1-score': 0.2014528789430062, 'support': 65161}, '1': {'precision': 0.2432102253204957, 'recall': 0.8022011232276425, 'f1-score': 0.3732569312615716, 'support': 39707}, '2': {'precision': 0.4880472614031874, 'recall': 0.164409132983647, 'f1-score': 0.24596104135893646, 'support': 64820}, 'accuracy': 0.29921974447220784, 'macro avg': {'precision': 0.40691465079973826, 'recall': 0.36447819454880387, 'f1-score': 0.2735569505211714, 'support': 169688}, 'weighted avg': {'precision': 0.4313080447105207, 'recall': 0.29921974447220784, 'f1-score': 0.25865693929620664, 'support': 169688}}
[[ 8264 49894  7003]
 [ 3678 31853  4176]
 [ 4941 49222 10657]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1408141
{'0': {'precision': 0.4520601958336071, 'recall': 0.11336893107880945, 'f1-score': 0.18127676395019435, 'support': 60678}, '1': {'precision': 0.29105735295229024, 'recall': 0.794967592783718, 'f1-score': 0.42610653493170764, 'support': 48446}, '2': {'precision': 0.4455530474040632, 'recall': 0.16295158840235124, 'f1-score': 0.23862949440239867, 'support': 60564}, 'accuracy': 0.3256623921550139, 'macro avg': {'precision': 0.3962235320633202, 'recall': 0.35709603742162627, 'f1-score': 0.2820042644281002, 'support': 169688}, 'weighted avg': {'precision': 0.40377132058187937, 'recall': 0.3256623921550139, 'f1-score': 0.2716457579396202, 'support': 169688}}
[[ 6879 47189  6610]
 [ 4262 38513  5671]
 [ 4076 46619  9869]]
Evaluating performance on  train set...
260/260 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0120556
{'0': {'precision': 0.39758448212760766, 'recall': 0.20371296412051507, 'f1-score': 0.2693945029964869, 'support': 15998}, '1': {'precision': 0.5346464930988692, 'recall': 0.7870916145848761, 'f1-score': 0.6367611995734637, 'support': 33761}, '2': {'precision': 0.3596938775510204, 'recall': 0.18503937007874016, 'f1-score': 0.24436741767764295, 'support': 16764}, 'accuracy': 0.4950768906994573, 'macro avg': {'precision': 0.43064161759249914, 'recall': 0.3919479829280437, 'f1-score': 0.3835077067491978, 'support': 66523}, 'weighted avg': {'precision': 0.45759609401039786, 'recall': 0.4950768906994573, 'f1-score': 0.4495293884473867, 'support': 66523}}
[[ 3259 10952  1787]
 [ 3453 26573  3735]
 [ 1485 12177  3102]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0691754
{'0': {'precision': 0.46042894769848236, 'recall': 0.18759262098216567, 'f1-score': 0.2665746859342096, 'support': 19569}, '1': {'precision': 0.4187133810735634, 'recall': 0.8080173595248972, 'f1-score': 0.5515924063462362, 'support': 26268}, '2': {'precision': 0.4302074055223311, 'recall': 0.1634438750845983, 'f1-score': 0.2368891224382554, 'support': 20686}, 'accuracy': 0.42507102806548114, 'macro avg': {'precision': 0.4364499114314589, 'recall': 0.3863512851972204, 'f1-score': 0.35168540490623373, 'support': 66523}, 'weighted avg': {'precision': 0.4345589880520558, 'recall': 0.42507102806548114, 'f1-score': 0.3698888767149291, 'support': 66523}}
[[ 3671 13934  1964]
 [ 2529 21225  2514]
 [ 1773 15532  3381]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1051589
{'0': {'precision': 0.4923499411533935, 'recall': 0.17221663159820694, 'f1-score': 0.25517638686502425, 'support': 21862}, '1': {'precision': 0.3464790927867191, 'recall': 0.8220989366620435, 'f1-score': 0.48749862923566173, 'support': 21630}, '2': {'precision': 0.4618745035742653, 'recall': 0.1514914680213625, 'f1-score': 0.2281510544384502, 'support': 23031}, 'accuracy': 0.3763510364836222, 'macro avg': {'precision': 0.43356784583812596, 'recall': 0.3819356787605377, 'f1-score': 0.32360869017971206, 'support': 66523}, 'weighted avg': {'precision': 0.4343689984259749, 'recall': 0.3763510364836222, 'f1-score': 0.32135965688231843, 'support': 66523}}
[[ 3765 15961  2136]
 [ 1919 17782  1929]
 [ 1963 17579  3489]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1079286
{'0': {'precision': 0.47959738846572364, 'recall': 0.16174311926605506, 'f1-score': 0.24190450054884743, 'support': 21800}, '1': {'precision': 0.346491737296335, 'recall': 0.8149092067537432, 'f1-score': 0.48623915493340214, 'support': 21973}, '2': {'precision': 0.4413452555718671, 'recall': 0.14536263736263735, 'f1-score': 0.21869523526105214, 'support': 22750}, 'accuracy': 0.3718864152248095, 'macro avg': {'precision': 0.42247812711130855, 'recall': 0.3740049877941452, 'f1-score': 0.3156129635811006, 'support': 66523}, 'weighted avg': {'precision': 0.42254995379680893, 'recall': 0.3718864152248095, 'f1-score': 0.3146726345099508, 'support': 66523}}
[[ 3526 16204  2070]
 [ 1951 17906  2116]
 [ 1875 17568  3307]]
Evaluating performance on  val set...
51/51 - 1s - 567ms/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0347185
{'0': {'precision': 0.31732616212063003, 'recall': 0.26073232323232326, 'f1-score': 0.28625888060994625, 'support': 3168}, '1': {'precision': 0.5304199772985244, 'recall': 0.7131084999236991, 'f1-score': 0.6083447243376945, 'support': 6553}, '2': {'precision': 0.3521617852161785, 'recall': 0.16154830454254637, 'f1-score': 0.2214912280701754, 'support': 3126}, 'accuracy': 0.46734646220907605, 'macro avg': {'precision': 0.3999693082117777, 'recall': 0.3784630425661895, 'f1-score': 0.3720316110059387, 'support': 12847}, 'weighted avg': {'precision': 0.43449748061190635, 'recall': 0.46734646220907605, 'f1-score': 0.43478887610372774, 'support': 12847}}
[[ 826 2036  306]
 [1257 4673  623]
 [ 520 2101  505]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0851002
{'0': {'precision': 0.3798904538341158, 'recall': 0.2480838017373531, 'f1-score': 0.3001545595054096, 'support': 3914}, '1': {'precision': 0.4150587713461965, 'recall': 0.7251065478496707, 'f1-score': 0.5279266572637518, 'support': 5162}, '2': {'precision': 0.40926944226237233, 'recall': 0.13815963935295678, 'f1-score': 0.20658207771609835, 'support': 3771}, 'accuracy': 0.4074881295244026, 'macro avg': {'precision': 0.4014062224808949, 'recall': 0.3704499963133268, 'f1-score': 0.3448877648284199, 'support': 12847}, 'weighted avg': {'precision': 0.40264495063183636, 'recall': 0.4074881295244026, 'f1-score': 0.36420824828886633, 'support': 12847}}
[[ 971 2641  302]
 [ 969 3743  450]
 [ 616 2634  521]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1146222
{'0': {'precision': 0.4146639511201629, 'recall': 0.23477859778597787, 'f1-score': 0.29980857016639667, 'support': 4336}, '1': {'precision': 0.3438382960226038, 'recall': 0.7320684868116613, 'f1-score': 0.4679089026915114, 'support': 4322}, '2': {'precision': 0.42436974789915966, 'recall': 0.12055383146335641, 'f1-score': 0.18776724298196693, 'support': 4189}, 'accuracy': 0.36483225655795126, 'macro avg': {'precision': 0.39429066501397547, 'recall': 0.3624669720203319, 'f1-score': 0.31849490527995833, 'support': 12847}, 'weighted avg': {'precision': 0.3940014697140422, 'recall': 0.36483225655795126, 'f1-score': 0.31982791457349324, 'support': 12847}}
[[1018 3010  308]
 [ 781 3164  377]
 [ 656 3028  505]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0966234
{'0': {'precision': 0.40791152700978306, 'recall': 0.23453167033504524, 'f1-score': 0.2978260869565217, 'support': 4089}, '1': {'precision': 0.3861906293556342, 'recall': 0.7393267651888341, 'f1-score': 0.5073596732164237, 'support': 4872}, '2': {'precision': 0.3763900769888794, 'recall': 0.11322696860524961, 'f1-score': 0.17408506429277942, 'support': 3886}, 'accuracy': 0.3892737604109909, 'macro avg': {'precision': 0.39016407778476553, 'recall': 0.3623618013763763, 'f1-score': 0.32642360815524163, 'support': 12847}, 'weighted avg': {'precision': 0.39013955159511465, 'recall': 0.3892737604109909, 'f1-score': 0.33985846947282433, 'support': 12847}}
[[ 959 2842  288]
 [ 829 3602  441]
 [ 563 2883  440]]
training model: results/LILAK/W1/deepVOL_L3/seq2seq
Epoch 1/50
260/260 - 15s - loss: 13.2847 - accuracy10: 0.3684 - accuracy20: 0.3630 - accuracy30: 0.3578 - accuracy50: 0.3531 - val_loss: 14.0324 - val_accuracy10: 0.5086 - val_accuracy20: 0.4013 - val_accuracy30: 0.3363 - val_accuracy50: 0.3793 - 15s/epoch - 59ms/step
Epoch 2/50
260/260 - 10s - loss: 13.1848 - accuracy10: 0.3662 - accuracy20: 0.3645 - accuracy30: 0.3645 - accuracy50: 0.3608 - val_loss: 13.8008 - val_accuracy10: 0.5096 - val_accuracy20: 0.4017 - val_accuracy30: 0.3363 - val_accuracy50: 0.3792 - 10s/epoch - 37ms/step
Epoch 3/50
260/260 - 10s - loss: 13.1677 - accuracy10: 0.3529 - accuracy20: 0.3650 - accuracy30: 0.3709 - accuracy50: 0.3672 - val_loss: 13.3269 - val_accuracy10: 0.5004 - val_accuracy20: 0.4001 - val_accuracy30: 0.3367 - val_accuracy50: 0.3796 - 10s/epoch - 37ms/step
Epoch 4/50
260/260 - 10s - loss: 13.1050 - accuracy10: 0.3582 - accuracy20: 0.3686 - accuracy30: 0.3740 - accuracy50: 0.3751 - val_loss: 13.3258 - val_accuracy10: 0.4644 - val_accuracy20: 0.3887 - val_accuracy30: 0.3371 - val_accuracy50: 0.3787 - 10s/epoch - 37ms/step
Epoch 5/50
260/260 - 10s - loss: 13.0417 - accuracy10: 0.3614 - accuracy20: 0.3764 - accuracy30: 0.3825 - accuracy50: 0.3796 - val_loss: 13.3835 - val_accuracy10: 0.4501 - val_accuracy20: 0.3867 - val_accuracy30: 0.3371 - val_accuracy50: 0.3755 - 10s/epoch - 37ms/step
Epoch 6/50
260/260 - 10s - loss: 12.9972 - accuracy10: 0.3622 - accuracy20: 0.3822 - accuracy30: 0.3923 - accuracy50: 0.3896 - val_loss: 13.4234 - val_accuracy10: 0.4764 - val_accuracy20: 0.3978 - val_accuracy30: 0.3398 - val_accuracy50: 0.3800 - 10s/epoch - 37ms/step
Epoch 7/50
260/260 - 10s - loss: 12.9482 - accuracy10: 0.3683 - accuracy20: 0.3912 - accuracy30: 0.4038 - accuracy50: 0.3972 - val_loss: 13.3143 - val_accuracy10: 0.4758 - val_accuracy20: 0.3911 - val_accuracy30: 0.3390 - val_accuracy50: 0.3785 - 10s/epoch - 37ms/step
Epoch 8/50
260/260 - 10s - loss: 12.8962 - accuracy10: 0.3750 - accuracy20: 0.3987 - accuracy30: 0.4115 - accuracy50: 0.4014 - val_loss: 13.3775 - val_accuracy10: 0.4761 - val_accuracy20: 0.3944 - val_accuracy30: 0.3377 - val_accuracy50: 0.3808 - 10s/epoch - 37ms/step
Epoch 9/50
260/260 - 10s - loss: 12.8464 - accuracy10: 0.3875 - accuracy20: 0.4087 - accuracy30: 0.4200 - accuracy50: 0.4081 - val_loss: 13.3458 - val_accuracy10: 0.4609 - val_accuracy20: 0.3930 - val_accuracy30: 0.3455 - val_accuracy50: 0.3795 - 10s/epoch - 39ms/step
Epoch 10/50
260/260 - 10s - loss: 12.8089 - accuracy10: 0.3887 - accuracy20: 0.4138 - accuracy30: 0.4231 - accuracy50: 0.4133 - val_loss: 13.3457 - val_accuracy10: 0.4635 - val_accuracy20: 0.3925 - val_accuracy30: 0.3430 - val_accuracy50: 0.3789 - 10s/epoch - 38ms/step
Epoch 11/50
260/260 - 10s - loss: 12.7698 - accuracy10: 0.3967 - accuracy20: 0.4199 - accuracy30: 0.4300 - accuracy50: 0.4196 - val_loss: 13.3732 - val_accuracy10: 0.4667 - val_accuracy20: 0.3934 - val_accuracy30: 0.3468 - val_accuracy50: 0.3813 - 10s/epoch - 39ms/step
Epoch 12/50
260/260 - 10s - loss: 12.7284 - accuracy10: 0.4049 - accuracy20: 0.4270 - accuracy30: 0.4350 - accuracy50: 0.4230 - val_loss: 13.4390 - val_accuracy10: 0.4508 - val_accuracy20: 0.3908 - val_accuracy30: 0.3539 - val_accuracy50: 0.3748 - 10s/epoch - 39ms/step
Epoch 13/50
260/260 - 10s - loss: 12.6910 - accuracy10: 0.4099 - accuracy20: 0.4324 - accuracy30: 0.4397 - accuracy50: 0.4285 - val_loss: 13.3641 - val_accuracy10: 0.4621 - val_accuracy20: 0.3962 - val_accuracy30: 0.3549 - val_accuracy50: 0.3869 - 10s/epoch - 39ms/step
Epoch 14/50
260/260 - 10s - loss: 12.6398 - accuracy10: 0.4184 - accuracy20: 0.4380 - accuracy30: 0.4457 - accuracy50: 0.4329 - val_loss: 13.3802 - val_accuracy10: 0.4484 - val_accuracy20: 0.3940 - val_accuracy30: 0.3601 - val_accuracy50: 0.3840 - 10s/epoch - 39ms/step
Epoch 15/50
260/260 - 10s - loss: 12.6169 - accuracy10: 0.4205 - accuracy20: 0.4399 - accuracy30: 0.4485 - accuracy50: 0.4346 - val_loss: 13.4157 - val_accuracy10: 0.4324 - val_accuracy20: 0.3911 - val_accuracy30: 0.3549 - val_accuracy50: 0.3809 - 10s/epoch - 38ms/step
Epoch 16/50
260/260 - 10s - loss: 12.5838 - accuracy10: 0.4247 - accuracy20: 0.4460 - accuracy30: 0.4524 - accuracy50: 0.4391 - val_loss: 13.5401 - val_accuracy10: 0.4490 - val_accuracy20: 0.3947 - val_accuracy30: 0.3571 - val_accuracy50: 0.3880 - 10s/epoch - 37ms/step
Epoch 17/50
260/260 - 10s - loss: 12.5423 - accuracy10: 0.4334 - accuracy20: 0.4504 - accuracy30: 0.4570 - accuracy50: 0.4426 - val_loss: 13.4984 - val_accuracy10: 0.4398 - val_accuracy20: 0.3946 - val_accuracy30: 0.3607 - val_accuracy50: 0.3883 - 10s/epoch - 39ms/step
testing model: results/LILAK/W1/deepVOL_L3/seq2seq
Evaluating performance on  test set...
663/663 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0977135
{'0': {'precision': 0.3882716049382716, 'recall': 0.012153884798948853, 'f1-score': 0.02356996983493527, 'support': 51753}, '1': {'precision': 0.3909974788447617, 'recall': 0.9418688554162533, 'f1-score': 0.5525960681936446, 'support': 66522}, '2': {'precision': 0.3407464212678937, 'recall': 0.0518545893062066, 'f1-score': 0.090011310498506, 'support': 51413}, 'accuracy': 0.3886544717363632, 'macro avg': {'precision': 0.37333850168364235, 'recall': 0.3352924431738029, 'f1-score': 0.2220591161756953, 'support': 169688}, 'weighted avg': {'precision': 0.3749407760992399, 'recall': 0.3886544717363632, 'f1-score': 0.2510923801559611, 'support': 169688}}
[[  629 49137  1987]
 [  696 62655  3171]
 [  295 48452  2666]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1348026
{'0': {'precision': 0.43561442236938924, 'recall': 0.009811233199091798, 'f1-score': 0.019190249278744857, 'support': 60339}, '1': {'precision': 0.29032793129292656, 'recall': 0.9566599190283401, 'f1-score': 0.44546559963803983, 'support': 49400}, '2': {'precision': 0.3999279409115475, 'recall': 0.03703147675524195, 'f1-score': 0.06778625954198474, 'support': 59949}, 'accuracy': 0.29507684691905145, 'macro avg': {'precision': 0.3752900981912877, 'recall': 0.33450087632755793, 'f1-score': 0.1774807028195898, 'support': 169688}, 'weighted avg': {'precision': 0.38071058982911876, 'recall': 0.29507684691905145, 'f1-score': 0.16045707148785887, 'support': 169688}}
[[  592 58122  1625]
 [  435 47259  1706]
 [  332 57397  2220]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1501707
{'0': {'precision': 0.4741000877963126, 'recall': 0.008287165635886497, 'f1-score': 0.016289592760180997, 'support': 65161}, '1': {'precision': 0.2334151585846465, 'recall': 0.9650691313874128, 'f1-score': 0.3759110840796947, 'support': 39707}, '2': {'precision': 0.4280493375970763, 'recall': 0.028910829990743597, 'f1-score': 0.05416341512760485, 'support': 64820}, 'accuracy': 0.24005233133751355, 'macro avg': {'precision': 0.3785215279926784, 'recall': 0.3340890423380143, 'f1-score': 0.14878803065582685, 'support': 169688}, 'weighted avg': {'precision': 0.40018863788752634, 'recall': 0.24005233133751355, 'f1-score': 0.11490865669917695, 'support': 169688}}
[[  540 63200  1421]
 [  304 38320  1083]
 [  295 62651  1874]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1261551
{'0': {'precision': 0.44600431965442766, 'recall': 0.006806420778535878, 'f1-score': 0.013408220245438607, 'support': 60678}, '1': {'precision': 0.2854345790414574, 'recall': 0.968955125294142, 'f1-score': 0.4409686995077594, 'support': 48446}, '2': {'precision': 0.40404275092936803, 'recall': 0.028713427118420183, 'f1-score': 0.05361657519886539, 'support': 60564}, 'accuracy': 0.2893192211588327, 'macro avg': {'precision': 0.3784938832084177, 'recall': 0.33482499106369934, 'f1-score': 0.16933116498402112, 'support': 169688}, 'weighted avg': {'precision': 0.3851849210994298, 'recall': 0.2893192211588327, 'f1-score': 0.14982784796066734, 'support': 169688}}
[[  413 58914  1351]
 [  290 46942  1214]
 [  223 58602  1739]]
Evaluating performance on  train set...
260/260 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.031477
{'0': {'precision': 0.37298128684952575, 'recall': 0.09094886860857607, 'f1-score': 0.14623850444745967, 'support': 15998}, '1': {'precision': 0.5114155251141552, 'recall': 0.9156126891975949, 'f1-score': 0.6562708985722626, 'support': 33761}, '2': {'precision': 0.3314967860422406, 'recall': 0.04306848007635409, 'f1-score': 0.07623271037905184, 'support': 16764}, 'accuracy': 0.49740691189513403, 'macro avg': {'precision': 0.40529786600197387, 'recall': 0.349876679294175, 'f1-score': 0.2929140377995914, 'support': 66523}, 'weighted avg': {'precision': 0.43278364312508194, 'recall': 0.49740691189513403, 'f1-score': 0.3874426973774941, 'support': 66523}}
[[ 1455 14093   450]
 [ 1843 30912  1006]
 [  603 15439   722]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.07887
{'0': {'precision': 0.4434065934065934, 'recall': 0.08247738770504369, 'f1-score': 0.13908397604377615, 'support': 19569}, '1': {'precision': 0.39877460565767175, 'recall': 0.9316278361504492, 'f1-score': 0.5584919439499748, 'support': 26268}, '2': {'precision': 0.4171617161716172, 'recall': 0.030552064198008315, 'f1-score': 0.05693437232557092, 'support': 20686}, 'accuracy': 0.4016355245554169, 'macro avg': {'precision': 0.4197809717452941, 'recall': 0.34821909601783374, 'f1-score': 0.25150343077310733, 'support': 66523}, 'weighted avg': {'precision': 0.41762160799295617, 'recall': 0.4016355245554169, 'f1-score': 0.279150746911675, 'support': 66523}}
[[ 1614 17590   365]
 [ 1278 24472   518]
 [  748 19306   632]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1052752
{'0': {'precision': 0.48349687778768957, 'recall': 0.07437562894520172, 'f1-score': 0.1289197224975223, 'support': 21862}, '1': {'precision': 0.32842251339314527, 'recall': 0.9409616273693944, 'f1-score': 0.48690222721944443, 'support': 21630}, '2': {'precision': 0.4444444444444444, 'recall': 0.022925621987755634, 'f1-score': 0.0436021305586523, 'support': 23031}, 'accuracy': 0.3383341100070652, 'macro avg': {'precision': 0.41878794520842644, 'recall': 0.3460876261007839, 'f1-score': 0.21980802675853964, 'support': 66523}, 'weighted avg': {'precision': 0.41955395437500115, 'recall': 0.3383341100070652, 'f1-score': 0.2157800883437869, 'support': 66523}}
[[ 1626 19934   302]
 [  919 20353   358]
 [  818 21685   528]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.102946
{'0': {'precision': 0.49272486772486773, 'recall': 0.06834862385321101, 'f1-score': 0.12004511762810184, 'support': 21800}, '1': {'precision': 0.33359493873628576, 'recall': 0.9478905930005006, 'f1-score': 0.4935077243863142, 'support': 21973}, '2': {'precision': 0.42199248120300753, 'recall': 0.019736263736263738, 'f1-score': 0.03770891072478374, 'support': 22750}, 'accuracy': 0.34224253265787774, 'macro avg': {'precision': 0.4161040958880537, 'recall': 0.34532516019665843, 'f1-score': 0.2170872509130666, 'support': 66523}, 'weighted avg': {'precision': 0.415973612925198, 'recall': 0.34224253265787774, 'f1-score': 0.21524444945690857, 'support': 66523}}
[[ 1490 20044   266]
 [  796 20828   349]
 [  738 21563   449]]
Evaluating performance on  val set...
51/51 - 1s - 894ms/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0469856
{'0': {'precision': 0.25963149078726966, 'recall': 0.09785353535353536, 'f1-score': 0.14213663457129758, 'support': 3168}, '1': {'precision': 0.5037653938158944, 'recall': 0.8676941858690677, 'f1-score': 0.6374439461883408, 'support': 6553}, '2': {'precision': 0.2896174863387978, 'recall': 0.03390914907229686, 'f1-score': 0.06071019473081328, 'support': 3126}, 'accuracy': 0.4749747022651203, 'macro avg': {'precision': 0.35100479031398724, 'recall': 0.33315229009829994, 'f1-score': 0.2800969251634839, 'support': 12847}, 'weighted avg': {'precision': 0.3914557056732862, 'recall': 0.4749747022651203, 'f1-score': 0.3749699623587289, 'support': 12847}}
[[ 310 2768   90]
 [ 697 5686  170]
 [ 187 2833  106]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0900875
{'0': {'precision': 0.33421052631578946, 'recall': 0.09734287174246295, 'f1-score': 0.15077166600712305, 'support': 3914}, '1': {'precision': 0.39726146869004014, 'recall': 0.8824099186361876, 'f1-score': 0.547871060861198, 'support': 5162}, '2': {'precision': 0.3651452282157676, 'recall': 0.023335985149827633, 'f1-score': 0.04386839481555334, 'support': 3771}, 'accuracy': 0.39106406164863394, 'macro avg': {'precision': 0.36553907440719907, 'recall': 0.33436292517615934, 'f1-score': 0.24750370722795814, 'support': 12847}, 'weighted avg': {'precision': 0.36862507643649467, 'recall': 0.39106406164863394, 'f1-score': 0.2789490490983759, 'support': 12847}}
[[ 381 3454   79]
 [ 533 4555   74]
 [ 226 3457   88]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1122966
{'0': {'precision': 0.3844714686623012, 'recall': 0.09478782287822879, 'f1-score': 0.15208140610545792, 'support': 4336}, '1': {'precision': 0.33198170994737297, 'recall': 0.8903285515964832, 'f1-score': 0.4836297366932697, 'support': 4322}, '2': {'precision': 0.40106951871657753, 'recall': 0.017904034375746003, 'f1-score': 0.03427787934186472, 'support': 4189}, 'accuracy': 0.337355024519343, 'macro avg': {'precision': 0.37250756577541727, 'recall': 0.33434013628348597, 'f1-score': 0.22332967404686413, 'support': 12847}, 'weighted avg': {'precision': 0.37222491261897933, 'recall': 0.3373550245193431, 'f1-score': 0.225209211132922, 'support': 12847}}
[[ 411 3864   61]
 [ 423 3848   51]
 [ 235 3879   75]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0952935
{'0': {'precision': 0.39056224899598396, 'recall': 0.09513328442161897, 'f1-score': 0.15299901671583088, 'support': 4089}, '1': {'precision': 0.37727934252204437, 'recall': 0.9045566502463054, 'f1-score': 0.5324714553253187, 'support': 4872}, '2': {'precision': 0.38235294117647056, 'recall': 0.016726711271230058, 'f1-score': 0.032051282051282055, 'support': 3886}, 'accuracy': 0.378376274616642, 'macro avg': {'precision': 0.38339817756483296, 'recall': 0.3388055486463848, 'f1-score': 0.23917391803081053, 'support': 12847}, 'weighted avg': {'precision': 0.3830417624600096, 'recall': 0.378376274616642, 'f1-score': 0.2603226583441478, 'support': 12847}}
[[ 389 3652   48]
 [ 408 4407   57]
 [ 199 3622   65]]
training model: results/LILAK/W2/deepLOB_L1/seq2seq
Epoch 1/50
237/237 - 12s - loss: 13.2514 - accuracy10: 0.3601 - accuracy20: 0.3604 - accuracy30: 0.3590 - accuracy50: 0.3543 - val_loss: 13.1602 - val_accuracy10: 0.4152 - val_accuracy20: 0.3660 - val_accuracy30: 0.3639 - val_accuracy50: 0.3575 - 12s/epoch - 49ms/step
Epoch 2/50
237/237 - 5s - loss: 13.1091 - accuracy10: 0.3740 - accuracy20: 0.3795 - accuracy30: 0.3774 - accuracy50: 0.3738 - val_loss: 13.0801 - val_accuracy10: 0.4137 - val_accuracy20: 0.3650 - val_accuracy30: 0.3645 - val_accuracy50: 0.3617 - 5s/epoch - 22ms/step
Epoch 3/50
237/237 - 5s - loss: 13.0512 - accuracy10: 0.3788 - accuracy20: 0.3885 - accuracy30: 0.3839 - accuracy50: 0.3772 - val_loss: 12.9642 - val_accuracy10: 0.3879 - val_accuracy20: 0.3963 - val_accuracy30: 0.3902 - val_accuracy50: 0.3811 - 5s/epoch - 21ms/step
Epoch 4/50
237/237 - 5s - loss: 13.0192 - accuracy10: 0.3834 - accuracy20: 0.3945 - accuracy30: 0.3906 - accuracy50: 0.3799 - val_loss: 12.9497 - val_accuracy10: 0.4352 - val_accuracy20: 0.3945 - val_accuracy30: 0.3925 - val_accuracy50: 0.3727 - 5s/epoch - 21ms/step
Epoch 5/50
237/237 - 5s - loss: 12.9882 - accuracy10: 0.3930 - accuracy20: 0.4015 - accuracy30: 0.3946 - accuracy50: 0.3877 - val_loss: 12.9073 - val_accuracy10: 0.4227 - val_accuracy20: 0.3988 - val_accuracy30: 0.3950 - val_accuracy50: 0.3831 - 5s/epoch - 22ms/step
Epoch 6/50
237/237 - 5s - loss: 12.9442 - accuracy10: 0.4048 - accuracy20: 0.4113 - accuracy30: 0.4036 - accuracy50: 0.3922 - val_loss: 12.8733 - val_accuracy10: 0.4168 - val_accuracy20: 0.4131 - val_accuracy30: 0.4095 - val_accuracy50: 0.3978 - 5s/epoch - 23ms/step
Epoch 7/50
237/237 - 5s - loss: 12.9316 - accuracy10: 0.4095 - accuracy20: 0.4139 - accuracy30: 0.4049 - accuracy50: 0.3896 - val_loss: 12.8646 - val_accuracy10: 0.4300 - val_accuracy20: 0.4154 - val_accuracy30: 0.4111 - val_accuracy50: 0.3947 - 5s/epoch - 22ms/step
Epoch 8/50
237/237 - 5s - loss: 12.8921 - accuracy10: 0.4221 - accuracy20: 0.4211 - accuracy30: 0.4123 - accuracy50: 0.3942 - val_loss: 12.9001 - val_accuracy10: 0.4188 - val_accuracy20: 0.4098 - val_accuracy30: 0.4029 - val_accuracy50: 0.3880 - 5s/epoch - 22ms/step
Epoch 9/50
237/237 - 5s - loss: 12.8673 - accuracy10: 0.4251 - accuracy20: 0.4246 - accuracy30: 0.4139 - accuracy50: 0.3963 - val_loss: 12.9553 - val_accuracy10: 0.4232 - val_accuracy20: 0.4078 - val_accuracy30: 0.4037 - val_accuracy50: 0.3858 - 5s/epoch - 22ms/step
Epoch 10/50
237/237 - 5s - loss: 12.8503 - accuracy10: 0.4321 - accuracy20: 0.4281 - accuracy30: 0.4195 - accuracy50: 0.3993 - val_loss: 12.8693 - val_accuracy10: 0.4325 - val_accuracy20: 0.4141 - val_accuracy30: 0.4066 - val_accuracy50: 0.3909 - 5s/epoch - 22ms/step
Epoch 11/50
237/237 - 5s - loss: 12.8245 - accuracy10: 0.4373 - accuracy20: 0.4310 - accuracy30: 0.4199 - accuracy50: 0.3975 - val_loss: 12.8421 - val_accuracy10: 0.4376 - val_accuracy20: 0.4221 - val_accuracy30: 0.4125 - val_accuracy50: 0.3951 - 5s/epoch - 22ms/step
Epoch 12/50
237/237 - 5s - loss: 12.8133 - accuracy10: 0.4391 - accuracy20: 0.4341 - accuracy30: 0.4214 - accuracy50: 0.4013 - val_loss: 12.8577 - val_accuracy10: 0.4381 - val_accuracy20: 0.4170 - val_accuracy30: 0.4116 - val_accuracy50: 0.3943 - 5s/epoch - 22ms/step
Epoch 13/50
237/237 - 5s - loss: 12.7982 - accuracy10: 0.4435 - accuracy20: 0.4336 - accuracy30: 0.4229 - accuracy50: 0.3992 - val_loss: 12.8479 - val_accuracy10: 0.4280 - val_accuracy20: 0.4161 - val_accuracy30: 0.4110 - val_accuracy50: 0.4006 - 5s/epoch - 22ms/step
Epoch 14/50
237/237 - 5s - loss: 12.7745 - accuracy10: 0.4444 - accuracy20: 0.4369 - accuracy30: 0.4259 - accuracy50: 0.4035 - val_loss: 12.8086 - val_accuracy10: 0.4460 - val_accuracy20: 0.4188 - val_accuracy30: 0.4125 - val_accuracy50: 0.3974 - 5s/epoch - 22ms/step
Epoch 15/50
237/237 - 5s - loss: 12.7709 - accuracy10: 0.4425 - accuracy20: 0.4352 - accuracy30: 0.4250 - accuracy50: 0.4028 - val_loss: 12.8611 - val_accuracy10: 0.4524 - val_accuracy20: 0.4201 - val_accuracy30: 0.4135 - val_accuracy50: 0.3951 - 5s/epoch - 21ms/step
Epoch 16/50
237/237 - 5s - loss: 12.7561 - accuracy10: 0.4479 - accuracy20: 0.4393 - accuracy30: 0.4278 - accuracy50: 0.4055 - val_loss: 12.8829 - val_accuracy10: 0.4384 - val_accuracy20: 0.4156 - val_accuracy30: 0.4073 - val_accuracy50: 0.3935 - 5s/epoch - 21ms/step
Epoch 17/50
237/237 - 5s - loss: 12.7398 - accuracy10: 0.4484 - accuracy20: 0.4415 - accuracy30: 0.4286 - accuracy50: 0.4078 - val_loss: 12.8175 - val_accuracy10: 0.4545 - val_accuracy20: 0.4248 - val_accuracy30: 0.4190 - val_accuracy50: 0.4031 - 5s/epoch - 22ms/step
Epoch 18/50
237/237 - 5s - loss: 12.7288 - accuracy10: 0.4491 - accuracy20: 0.4426 - accuracy30: 0.4313 - accuracy50: 0.4077 - val_loss: 12.8604 - val_accuracy10: 0.4425 - val_accuracy20: 0.4158 - val_accuracy30: 0.4091 - val_accuracy50: 0.3980 - 5s/epoch - 21ms/step
Epoch 19/50
237/237 - 5s - loss: 12.7335 - accuracy10: 0.4481 - accuracy20: 0.4413 - accuracy30: 0.4302 - accuracy50: 0.4096 - val_loss: 12.8633 - val_accuracy10: 0.4354 - val_accuracy20: 0.4138 - val_accuracy30: 0.4076 - val_accuracy50: 0.3955 - 5s/epoch - 21ms/step
Epoch 20/50
237/237 - 5s - loss: 12.7109 - accuracy10: 0.4496 - accuracy20: 0.4443 - accuracy30: 0.4325 - accuracy50: 0.4089 - val_loss: 12.8579 - val_accuracy10: 0.4320 - val_accuracy20: 0.4135 - val_accuracy30: 0.4092 - val_accuracy50: 0.4010 - 5s/epoch - 22ms/step
Epoch 21/50
237/237 - 5s - loss: 12.7009 - accuracy10: 0.4506 - accuracy20: 0.4473 - accuracy30: 0.4334 - accuracy50: 0.4120 - val_loss: 12.8553 - val_accuracy10: 0.4279 - val_accuracy20: 0.4145 - val_accuracy30: 0.4085 - val_accuracy50: 0.4023 - 5s/epoch - 21ms/step
Epoch 22/50
237/237 - 5s - loss: 12.6886 - accuracy10: 0.4507 - accuracy20: 0.4454 - accuracy30: 0.4341 - accuracy50: 0.4129 - val_loss: 12.8930 - val_accuracy10: 0.4278 - val_accuracy20: 0.4141 - val_accuracy30: 0.4050 - val_accuracy50: 0.3998 - 5s/epoch - 21ms/step
Epoch 23/50
237/237 - 5s - loss: 12.6805 - accuracy10: 0.4536 - accuracy20: 0.4484 - accuracy30: 0.4358 - accuracy50: 0.4136 - val_loss: 12.8533 - val_accuracy10: 0.4381 - val_accuracy20: 0.4199 - val_accuracy30: 0.4119 - val_accuracy50: 0.4058 - 5s/epoch - 21ms/step
Epoch 24/50
237/237 - 5s - loss: 12.6680 - accuracy10: 0.4529 - accuracy20: 0.4492 - accuracy30: 0.4384 - accuracy50: 0.4166 - val_loss: 12.8804 - val_accuracy10: 0.4387 - val_accuracy20: 0.4163 - val_accuracy30: 0.4121 - val_accuracy50: 0.4054 - 5s/epoch - 21ms/step
testing model: results/LILAK/W2/deepLOB_L1/seq2seq
Evaluating performance on  test set...
987/987 - 7s - 7s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0468476
{'0': {'precision': 0.3685649049006265, 'recall': 0.4681142857142857, 'f1-score': 0.4124173258572624, 'support': 70000}, '1': {'precision': 0.5108903040364745, 'recall': 0.546804692403575, 'f1-score': 0.5282377556684744, 'support': 113119}, '2': {'precision': 0.4116471058635369, 'recall': 0.2522774446494465, 'f1-score': 0.3128345830391535, 'support': 69376}, 'accuracy': 0.4440642388958197, 'macro avg': {'precision': 0.43036743826687934, 'recall': 0.42239880758910237, 'f1-score': 0.41782988818829675, 'support': 252495}, 'weighted avg': {'precision': 0.4441647290510091, 'recall': 0.4440642388958197, 'f1-score': 0.4369439059244533, 'support': 252495}}
[[32768 27987  9245]
 [35495 61854 15770]
 [20644 31230 17502]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.073616
{'0': {'precision': 0.39759641696357767, 'recall': 0.44418656884030844, 'f1-score': 0.41960218063945776, 'support': 80142}, '1': {'precision': 0.4065648526564853, 'recall': 0.5209238231727483, 'f1-score': 0.4566941310073212, 'support': 90710}, '2': {'precision': 0.4580525065793697, 'recall': 0.26221476427862767, 'f1-score': 0.33350989250662094, 'support': 81643}, 'accuracy': 0.41291510722984615, 'macro avg': {'precision': 0.4207379253998109, 'recall': 0.4091083854305615, 'f1-score': 0.40326873471779995, 'support': 252495}, 'weighted avg': {'precision': 0.4203665443966189, 'recall': 0.41291510722984615, 'f1-score': 0.4050901235208602, 'support': 252495}}
[[35598 32764 11780]
 [29908 47253 13549]
 [24027 36208 21408]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0906376
{'0': {'precision': 0.3638414001533673, 'recall': 0.40891232161415425, 'f1-score': 0.38506247836828217, 'support': 78902}, '1': {'precision': 0.3811058808983406, 'recall': 0.4840004935003757, 'f1-score': 0.4264341123573299, 'support': 89159}, '2': {'precision': 0.4562149126275006, 'recall': 0.27333775493284695, 'f1-score': 0.34185540134200354, 'support': 84434}, 'accuracy': 0.3900908928889681, 'macro avg': {'precision': 0.4003873978930695, 'recall': 0.38875019001579236, 'f1-score': 0.3844506640225385, 'support': 252495}, 'weighted avg': {'precision': 0.4008272770657103, 'recall': 0.3900908928889681, 'f1-score': 0.38522290599335474, 'support': 252495}}
[[32264 33291 13347]
 [31844 43153 14162]
 [24568 36787 23079]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.101838
{'0': {'precision': 0.3401773322168821, 'recall': 0.3782877114212097, 'f1-score': 0.3582217551742673, 'support': 78398}, '1': {'precision': 0.3481733204734133, 'recall': 0.4368962787015044, 'f1-score': 0.3875213820987314, 'support': 88410}, '2': {'precision': 0.4480551724137931, 'recall': 0.2843255102874415, 'f1-score': 0.34788879210635293, 'support': 85687}, 'accuracy': 0.3669221172696489, 'macro avg': {'precision': 0.37880194170136283, 'recall': 0.3665031668033852, 'f1-score': 0.3645439764597838, 'support': 252495}, 'weighted avg': {'precision': 0.37958664255852304, 'recall': 0.3669221172696489, 'f1-score': 0.36497428259061804, 'support': 252495}}
[[29657 34507 14234]
 [34006 38626 15778]
 [23518 37806 24363]]
Evaluating performance on  train set...
237/237 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0586568
{'0': {'precision': 0.3827960228984634, 'recall': 0.44081420227837853, 'f1-score': 0.40976160399924744, 'support': 17293}, '1': {'precision': 0.48077984817115255, 'recall': 0.5418659821879983, 'f1-score': 0.5094984732963999, 'support': 25713}, '2': {'precision': 0.41056247316444827, 'recall': 0.27268579250556096, 'f1-score': 0.3277126602234561, 'support': 17533}, 'accuracy': 0.43504187383339665, 'macro avg': {'precision': 0.4247127814113547, 'recall': 0.41845532565731264, 'f1-score': 0.4156575791730344, 'support': 60539}, 'weighted avg': {'precision': 0.43245471021986226, 'recall': 0.43504187383339665, 'f1-score': 0.4283606887052506, 'support': 60539}}
[[ 7623  6936  2734]
 [ 7650 13933  4130]
 [ 4641  8111  4781]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0811391
{'0': {'precision': 0.41907797940166747, 'recall': 0.427763315979175, 'f1-score': 0.4233761086062528, 'support': 19976}, '1': {'precision': 0.3775049647950894, 'recall': 0.523194715508182, 'f1-score': 0.43856705398716384, 'support': 19983}, '2': {'precision': 0.4490926609924522, 'recall': 0.2717687074829932, 'f1-score': 0.3386208149179633, 'support': 20580}, 'accuracy': 0.406233997918697, 'macro avg': {'precision': 0.41522520172973637, 'recall': 0.4075755796567833, 'f1-score': 0.4001879925037933, 'support': 60539}, 'weighted avg': {'precision': 0.41555873719837866, 'recall': 0.406233997918697, 'f1-score': 0.39957817202721696, 'support': 60539}}
[[ 8545  8024  3407]
 [ 6074 10455  3454]
 [ 5771  9216  5593]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.085512
{'0': {'precision': 0.40821877884101615, 'recall': 0.4223327805417358, 'f1-score': 0.41515585634540336, 'support': 19899}, '1': {'precision': 0.36754229741763134, 'recall': 0.4956221544003602, 'f1-score': 0.42207972048829334, 'support': 19987}, '2': {'precision': 0.4347692307692308, 'recall': 0.273664842879969, 'f1-score': 0.33589873116809793, 'support': 20653}, 'accuracy': 0.39581096483258726, 'macro avg': {'precision': 0.40351010234262613, 'recall': 0.39720659260735497, 'f1-score': 0.39104476933393156, 'support': 60539}, 'weighted avg': {'precision': 0.40384714484415835, 'recall': 0.39581096483258726, 'f1-score': 0.3904030501599205, 'support': 60539}}
[[8404 7932 3563]
 [6296 9906 3785]
 [5887 9114 5652]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0925134
{'0': {'precision': 0.3888055730250109, 'recall': 0.4087164361269325, 'f1-score': 0.39851245816288583, 'support': 19664}, '1': {'precision': 0.3570613300867448, 'recall': 0.46789310998105493, 'f1-score': 0.4050321522592896, 'support': 20058}, '2': {'precision': 0.42417550058892817, 'recall': 0.27679300571648174, 'f1-score': 0.334990261910991, 'support': 20817}, 'accuracy': 0.3829597449577958, 'macro avg': {'precision': 0.39001413456689465, 'recall': 0.3844675172748231, 'f1-score': 0.3795116241110555, 'support': 60539}, 'weighted avg': {'precision': 0.39045029390316094, 'recall': 0.3829597449577958, 'f1-score': 0.37882978195102196, 'support': 60539}}
[[8037 7874 3753]
 [6604 9385 4069]
 [6030 9025 5762]]
Evaluating performance on  val set...
85/85 - 1s - 678ms/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0472041
{'0': {'precision': 0.3619466515323496, 'recall': 0.44551170101292353, 'f1-score': 0.3994050414905276, 'support': 5726}, '1': {'precision': 0.5211075363166618, 'recall': 0.5357321840232535, 'f1-score': 0.5283186715429475, 'support': 9977}, '2': {'precision': 0.40651920838183936, 'recall': 0.29608275394268274, 'f1-score': 0.3426216640502355, 'support': 5897}, 'accuracy': 0.4463888888888889, 'macro avg': {'precision': 0.42985779874361696, 'recall': 0.4257755463262866, 'f1-score': 0.4234484590279035, 'support': 21600}, 'weighted avg': {'precision': 0.4476314902006146, 'recall': 0.4463888888888889, 'f1-score': 0.44344762066958276, 'support': 21600}}
[[2551 2299  876]
 [2959 5345 1673]
 [1538 2613 1746]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0685008
{'0': {'precision': 0.40102720710716266, 'recall': 0.43177402480944554, 'f1-score': 0.4158330334652753, 'support': 6691}, '1': {'precision': 0.4241357896915752, 'recall': 0.5162509448223734, 'f1-score': 0.46568181818181814, 'support': 7938}, '2': {'precision': 0.44465568229826785, 'recall': 0.30196528475111173, 'f1-score': 0.3596753524134985, 'support': 6971}, 'accuracy': 0.4209259259259259, 'macro avg': {'precision': 0.4232728930323353, 'recall': 0.41666341812764357, 'f1-score': 0.41373006802019735, 'support': 21600}, 'weighted avg': {'precision': 0.4235998936401378, 'recall': 0.4209259259259259, 'f1-score': 0.41602861024620036, 'support': 21600}}
[[2889 2650 1152]
 [2363 4098 1477]
 [1952 2914 2105]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.072373
{'0': {'precision': 0.39657316567638523, 'recall': 0.42474470919046914, 'f1-score': 0.4101757896241246, 'support': 6757}, '1': {'precision': 0.41580718705895126, 'recall': 0.4892067952484353, 'f1-score': 0.4495305164319248, 'support': 7829}, '2': {'precision': 0.437694099378882, 'recall': 0.32149985742800113, 'f1-score': 0.3707052441229657, 'support': 7014}, 'accuracy': 0.41458333333333336, 'macro avg': {'precision': 0.4166914840380728, 'recall': 0.41181712062230186, 'f1-score': 0.41013718339300503, 'support': 21600}, 'weighted avg': {'precision': 0.41689748893533995, 'recall': 0.41458333333333336, 'f1-score': 0.41162309286639953, 'support': 21600}}
[[2870 2606 1281]
 [2383 3830 1616]
 [1984 2775 2255]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0824115
{'0': {'precision': 0.3892533147243545, 'recall': 0.40094882116158714, 'f1-score': 0.3950145173854543, 'support': 6956}, '1': {'precision': 0.37862440997977076, 'recall': 0.45993174061433445, 'f1-score': 0.41533625100166427, 'support': 7325}, '2': {'precision': 0.44934079826620915, 'recall': 0.3399371498838639, 'f1-score': 0.387056627255756, 'support': 7319}, 'accuracy': 0.4002777777777778, 'macro avg': {'precision': 0.4057395076567782, 'recall': 0.4002725705532619, 'f1-score': 0.3991357985476249, 'support': 21600}, 'weighted avg': {'precision': 0.4060090353164267, 'recall': 0.4002777777777778, 'f1-score': 0.3992095590928374, 'support': 21600}}
[[2789 2760 1407]
 [2314 3369 1642]
 [2062 2769 2488]]
training model: results/LILAK/W2/deepOF_L1/seq2seq
Epoch 1/50
237/237 - 10s - loss: 13.1889 - accuracy10: 0.3959 - accuracy20: 0.3752 - accuracy30: 0.3655 - accuracy50: 0.3552 - val_loss: 13.0458 - val_accuracy10: 0.4187 - val_accuracy20: 0.3968 - val_accuracy30: 0.3837 - val_accuracy50: 0.3718 - 10s/epoch - 44ms/step
Epoch 2/50
237/237 - 5s - loss: 13.0919 - accuracy10: 0.4160 - accuracy20: 0.3903 - accuracy30: 0.3775 - accuracy50: 0.3615 - val_loss: 13.0037 - val_accuracy10: 0.4275 - val_accuracy20: 0.4041 - val_accuracy30: 0.3909 - val_accuracy50: 0.3768 - 5s/epoch - 21ms/step
Epoch 3/50
237/237 - 5s - loss: 13.0585 - accuracy10: 0.4203 - accuracy20: 0.3957 - accuracy30: 0.3828 - accuracy50: 0.3666 - val_loss: 12.9744 - val_accuracy10: 0.4221 - val_accuracy20: 0.4045 - val_accuracy30: 0.3915 - val_accuracy50: 0.3791 - 5s/epoch - 21ms/step
Epoch 4/50
237/237 - 5s - loss: 13.0274 - accuracy10: 0.4231 - accuracy20: 0.4005 - accuracy30: 0.3879 - accuracy50: 0.3727 - val_loss: 12.9725 - val_accuracy10: 0.4238 - val_accuracy20: 0.4046 - val_accuracy30: 0.3919 - val_accuracy50: 0.3787 - 5s/epoch - 21ms/step
Epoch 5/50
237/237 - 5s - loss: 13.0058 - accuracy10: 0.4281 - accuracy20: 0.4055 - accuracy30: 0.3912 - accuracy50: 0.3738 - val_loss: 12.9493 - val_accuracy10: 0.4249 - val_accuracy20: 0.4034 - val_accuracy30: 0.3900 - val_accuracy50: 0.3832 - 5s/epoch - 21ms/step
Epoch 6/50
237/237 - 5s - loss: 12.9968 - accuracy10: 0.4266 - accuracy20: 0.4059 - accuracy30: 0.3915 - accuracy50: 0.3738 - val_loss: 12.9604 - val_accuracy10: 0.4194 - val_accuracy20: 0.4033 - val_accuracy30: 0.3907 - val_accuracy50: 0.3850 - 5s/epoch - 20ms/step
Epoch 7/50
237/237 - 5s - loss: 12.9820 - accuracy10: 0.4285 - accuracy20: 0.4096 - accuracy30: 0.3944 - accuracy50: 0.3782 - val_loss: 12.9586 - val_accuracy10: 0.4195 - val_accuracy20: 0.4019 - val_accuracy30: 0.3901 - val_accuracy50: 0.3813 - 5s/epoch - 20ms/step
Epoch 8/50
237/237 - 5s - loss: 12.9662 - accuracy10: 0.4305 - accuracy20: 0.4127 - accuracy30: 0.3980 - accuracy50: 0.3809 - val_loss: 12.9418 - val_accuracy10: 0.4217 - val_accuracy20: 0.4042 - val_accuracy30: 0.3907 - val_accuracy50: 0.3828 - 5s/epoch - 20ms/step
Epoch 9/50
237/237 - 5s - loss: 12.9529 - accuracy10: 0.4326 - accuracy20: 0.4140 - accuracy30: 0.3989 - accuracy50: 0.3788 - val_loss: 12.9218 - val_accuracy10: 0.4348 - val_accuracy20: 0.4090 - val_accuracy30: 0.3962 - val_accuracy50: 0.3844 - 5s/epoch - 20ms/step
Epoch 10/50
237/237 - 5s - loss: 12.9381 - accuracy10: 0.4320 - accuracy20: 0.4162 - accuracy30: 0.4014 - accuracy50: 0.3848 - val_loss: 12.9089 - val_accuracy10: 0.4244 - val_accuracy20: 0.4084 - val_accuracy30: 0.3940 - val_accuracy50: 0.3851 - 5s/epoch - 20ms/step
Epoch 11/50
237/237 - 5s - loss: 12.9266 - accuracy10: 0.4356 - accuracy20: 0.4169 - accuracy30: 0.4047 - accuracy50: 0.3863 - val_loss: 12.9157 - val_accuracy10: 0.4258 - val_accuracy20: 0.4102 - val_accuracy30: 0.3942 - val_accuracy50: 0.3892 - 5s/epoch - 20ms/step
Epoch 12/50
237/237 - 5s - loss: 12.9149 - accuracy10: 0.4340 - accuracy20: 0.4189 - accuracy30: 0.4057 - accuracy50: 0.3889 - val_loss: 12.9327 - val_accuracy10: 0.4197 - val_accuracy20: 0.4073 - val_accuracy30: 0.3926 - val_accuracy50: 0.3857 - 5s/epoch - 20ms/step
Epoch 13/50
237/237 - 5s - loss: 12.8957 - accuracy10: 0.4374 - accuracy20: 0.4209 - accuracy30: 0.4062 - accuracy50: 0.3891 - val_loss: 12.9170 - val_accuracy10: 0.4244 - val_accuracy20: 0.4076 - val_accuracy30: 0.3929 - val_accuracy50: 0.3905 - 5s/epoch - 20ms/step
Epoch 14/50
237/237 - 5s - loss: 12.8843 - accuracy10: 0.4369 - accuracy20: 0.4224 - accuracy30: 0.4093 - accuracy50: 0.3913 - val_loss: 12.9333 - val_accuracy10: 0.4288 - val_accuracy20: 0.4093 - val_accuracy30: 0.3944 - val_accuracy50: 0.3860 - 5s/epoch - 20ms/step
Epoch 15/50
237/237 - 5s - loss: 12.8631 - accuracy10: 0.4404 - accuracy20: 0.4274 - accuracy30: 0.4125 - accuracy50: 0.3931 - val_loss: 12.9331 - val_accuracy10: 0.4243 - val_accuracy20: 0.4094 - val_accuracy30: 0.3948 - val_accuracy50: 0.3894 - 5s/epoch - 20ms/step
Epoch 16/50
237/237 - 5s - loss: 12.8493 - accuracy10: 0.4418 - accuracy20: 0.4278 - accuracy30: 0.4132 - accuracy50: 0.3956 - val_loss: 12.8948 - val_accuracy10: 0.4371 - val_accuracy20: 0.4157 - val_accuracy30: 0.4013 - val_accuracy50: 0.3926 - 5s/epoch - 20ms/step
Epoch 17/50
237/237 - 5s - loss: 12.8399 - accuracy10: 0.4458 - accuracy20: 0.4300 - accuracy30: 0.4171 - accuracy50: 0.3984 - val_loss: 12.9309 - val_accuracy10: 0.4236 - val_accuracy20: 0.4075 - val_accuracy30: 0.3947 - val_accuracy50: 0.3910 - 5s/epoch - 20ms/step
Epoch 18/50
237/237 - 5s - loss: 12.8262 - accuracy10: 0.4463 - accuracy20: 0.4336 - accuracy30: 0.4169 - accuracy50: 0.3991 - val_loss: 12.9230 - val_accuracy10: 0.4255 - val_accuracy20: 0.4097 - val_accuracy30: 0.3951 - val_accuracy50: 0.3881 - 5s/epoch - 20ms/step
Epoch 19/50
237/237 - 5s - loss: 12.8112 - accuracy10: 0.4463 - accuracy20: 0.4327 - accuracy30: 0.4201 - accuracy50: 0.3991 - val_loss: 12.9140 - val_accuracy10: 0.4274 - val_accuracy20: 0.4085 - val_accuracy30: 0.3970 - val_accuracy50: 0.3897 - 5s/epoch - 20ms/step
Epoch 20/50
237/237 - 5s - loss: 12.7936 - accuracy10: 0.4506 - accuracy20: 0.4362 - accuracy30: 0.4209 - accuracy50: 0.4035 - val_loss: 12.9354 - val_accuracy10: 0.4253 - val_accuracy20: 0.4123 - val_accuracy30: 0.4006 - val_accuracy50: 0.3916 - 5s/epoch - 20ms/step
Epoch 21/50
237/237 - 5s - loss: 12.7832 - accuracy10: 0.4494 - accuracy20: 0.4374 - accuracy30: 0.4230 - accuracy50: 0.4020 - val_loss: 12.9357 - val_accuracy10: 0.4246 - val_accuracy20: 0.4103 - val_accuracy30: 0.3961 - val_accuracy50: 0.3926 - 5s/epoch - 20ms/step
Epoch 22/50
237/237 - 5s - loss: 12.7670 - accuracy10: 0.4524 - accuracy20: 0.4409 - accuracy30: 0.4255 - accuracy50: 0.4084 - val_loss: 12.9308 - val_accuracy10: 0.4308 - val_accuracy20: 0.4095 - val_accuracy30: 0.3926 - val_accuracy50: 0.3895 - 5s/epoch - 21ms/step
Epoch 23/50
237/237 - 5s - loss: 12.7509 - accuracy10: 0.4530 - accuracy20: 0.4427 - accuracy30: 0.4278 - accuracy50: 0.4077 - val_loss: 12.9378 - val_accuracy10: 0.4273 - val_accuracy20: 0.4090 - val_accuracy30: 0.3971 - val_accuracy50: 0.3905 - 5s/epoch - 20ms/step
Epoch 24/50
237/237 - 5s - loss: 12.7424 - accuracy10: 0.4535 - accuracy20: 0.4442 - accuracy30: 0.4294 - accuracy50: 0.4104 - val_loss: 12.9292 - val_accuracy10: 0.4269 - val_accuracy20: 0.4102 - val_accuracy30: 0.3985 - val_accuracy50: 0.3908 - 5s/epoch - 20ms/step
Epoch 25/50
237/237 - 5s - loss: 12.7126 - accuracy10: 0.4558 - accuracy20: 0.4465 - accuracy30: 0.4327 - accuracy50: 0.4148 - val_loss: 12.9565 - val_accuracy10: 0.4208 - val_accuracy20: 0.4092 - val_accuracy30: 0.3962 - val_accuracy50: 0.3894 - 5s/epoch - 20ms/step
Epoch 26/50
237/237 - 5s - loss: 12.7072 - accuracy10: 0.4556 - accuracy20: 0.4463 - accuracy30: 0.4337 - accuracy50: 0.4138 - val_loss: 12.9692 - val_accuracy10: 0.4296 - val_accuracy20: 0.4103 - val_accuracy30: 0.3958 - val_accuracy50: 0.3831 - 5s/epoch - 20ms/step
testing model: results/LILAK/W2/deepOF_L1/seq2seq
Evaluating performance on  test set...
987/987 - 9s - 9s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0682577
{'0': {'precision': 0.3620984738115108, 'recall': 0.36572473499242836, 'f1-score': 0.3639025707726533, 'support': 69998}, '1': {'precision': 0.5541017018241109, 'recall': 0.48067963825705673, 'f1-score': 0.5147858688088465, 'support': 113119}, '2': {'precision': 0.32845650900658613, 'recall': 0.39610511294019285, 'f1-score': 0.3591228093103493, 'support': 69373}, 'accuracy': 0.42557329003128835, 'macro avg': {'precision': 0.4148855615474026, 'recall': 0.41416982872989266, 'f1-score': 0.41260374963061636, 'support': 252490}, 'weighted avg': {'precision': 0.4388752535855425, 'recall': 0.42557329003128835, 'f1-score': 0.43018710243185454, 'support': 252490}}
[[25600 21088 23310]
 [25873 54374 32872]
 [19226 22668 27479]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0772067
{'0': {'precision': 0.3905775819872736, 'recall': 0.39827304376037237, 'f1-score': 0.3943877771668283, 'support': 80141}, '1': {'precision': 0.45405097569763253, 'recall': 0.4306849375475421, 'f1-score': 0.442059405940594, 'support': 90709}, '2': {'precision': 0.37897296085165644, 'recall': 0.39331210191082805, 'f1-score': 0.3860094128112809, 'support': 81640}, 'accuracy': 0.40831320052279296, 'macro avg': {'precision': 0.4078671728455208, 'recall': 0.40742336107291416, 'f1-score': 0.4074855319729011, 'support': 252490}, 'weighted avg': {'precision': 0.4096286604480489, 'recall': 0.40831320052279296, 'f1-score': 0.4088051248180328, 'support': 252490}}
[[31918 22122 26101]
 [25124 39067 26518]
 [24678 24852 32110]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0870817
{'0': {'precision': 0.36354078164825826, 'recall': 0.43384198119185824, 'f1-score': 0.39559233107210134, 'support': 78902}, '1': {'precision': 0.4295797994308921, 'recall': 0.3488077345835483, 'f1-score': 0.38500297117955834, 'support': 89158}, '2': {'precision': 0.39073263824241294, 'recall': 0.39770223854080305, 'f1-score': 0.39418663348320676, 'support': 84430}, 'accuracy': 0.39173036555903207, 'macro avg': {'precision': 0.39461773977385445, 'recall': 0.39345065143873653, 'f1-score': 0.39159397857828876, 'support': 252490}, 'weighted avg': {'precision': 0.39595281855945685, 'recall': 0.39173036555903207, 'f1-score': 0.39138301903309103, 'support': 252490}}
[[34231 18899 25772]
 [31473 31099 26586]
 [28456 22396 33578]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.094365
{'0': {'precision': 0.3500627596742335, 'recall': 0.4589137200877596, 'f1-score': 0.39716507791068006, 'support': 78396}, '1': {'precision': 0.3934796854521625, 'recall': 0.2716691739528781, 'f1-score': 0.32142068531739926, 'support': 88409}, '2': {'precision': 0.4016712338035793, 'recall': 0.4156970298185213, 'f1-score': 0.4085637925694819, 'support': 85685}, 'accuracy': 0.37868430432888434, 'macro avg': {'precision': 0.38173789297665844, 'recall': 0.382093307953053, 'f1-score': 0.3757165185991871, 'support': 252490}, 'weighted avg': {'precision': 0.3827789824825582, 'recall': 0.37868430432888434, 'f1-score': 0.3745115584079674, 'support': 252490}}
[[35977 16580 25839]
 [37172 24018 27219]
 [29624 20442 35619]]
Evaluating performance on  train set...
237/237 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0619444
{'0': {'precision': 0.3841049055001062, 'recall': 0.4177010565209861, 'f1-score': 0.40019913156511877, 'support': 17321}, '1': {'precision': 0.547156822249759, 'recall': 0.4621109345323462, 'f1-score': 0.5010506850466503, 'support': 25799}, '2': {'precision': 0.37141565811279065, 'recall': 0.4246182110460443, 'f1-score': 0.3962390506549517, 'support': 17418}, 'accuracy': 0.43861706696620306, 'macro avg': {'precision': 0.4342257952875519, 'recall': 0.43481006736645883, 'f1-score': 0.43249628908890686, 'support': 60538}, 'weighted avg': {'precision': 0.4499404978426354, 'recall': 0.43861706696620306, 'f1-score': 0.44203884445581126, 'support': 60538}}
[[ 7235  4856  5230]
 [ 6590 11922  7287]
 [ 5011  5011  7396]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0682082
{'0': {'precision': 0.41868346937801326, 'recall': 0.43894505054549093, 'f1-score': 0.42857491876572773, 'support': 19982}, '1': {'precision': 0.43766452563967567, 'recall': 0.4137879542060727, 'f1-score': 0.4253914645379183, 'support': 20090}, '2': {'precision': 0.419179412478757, 'recall': 0.4218215577054627, 'f1-score': 0.42049633472151193, 'support': 20466}, 'accuracy': 0.4248075588886319, 'macro avg': {'precision': 0.42517580249881526, 'recall': 0.42485152081900873, 'f1-score': 0.424820906008386, 'support': 60538}, 'weighted avg': {'precision': 0.42515014141535545, 'recall': 0.4248075588886319, 'f1-score': 0.42478734903290516, 'support': 60538}}
[[8771 5233 5978]
 [5793 8313 5984]
 [6385 5448 8633]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0767623
{'0': {'precision': 0.4042461934377011, 'recall': 0.4729288975864318, 'f1-score': 0.4358986217741189, 'support': 19929}, '1': {'precision': 0.4221706980824665, 'recall': 0.3359094535301157, 'f1-score': 0.37413228189037595, 'support': 20056}, '2': {'precision': 0.41152127909710795, 'recall': 0.4257772587943366, 'f1-score': 0.4185279066430723, 'support': 20553}, 'accuracy': 0.4115266444216856, 'macro avg': {'precision': 0.4126460568724251, 'recall': 0.41153853663696144, 'f1-score': 0.4095196034358557, 'support': 60538}, 'weighted avg': {'precision': 0.412654444465373, 'recall': 0.4115266444216856, 'f1-score': 0.40953821969944265, 'support': 60538}}
[[9425 4437 6067]
 [6872 6737 6447]
 [7018 4784 8751]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0858003
{'0': {'precision': 0.3852678750050014, 'recall': 0.4887321084153893, 'f1-score': 0.4308759369056942, 'support': 19702}, '1': {'precision': 0.38564323361294633, 'recall': 0.2591927356184204, 'f1-score': 0.3100196932625171, 'support': 20043}, '2': {'precision': 0.40409531575609314, 'recall': 0.42899052565767326, 'f1-score': 0.41617094734877647, 'support': 20793}, 'accuracy': 0.39221645908355085, 'macro avg': {'precision': 0.39166880812468036, 'recall': 0.3923051232304943, 'f1-score': 0.38568885917232926, 'support': 60538}, 'weighted avg': {'precision': 0.39185881438384595, 'recall': 0.39221645908355085, 'f1-score': 0.3858119681720527, 'support': 60538}}
[[9629 3962 6111]
 [7805 5195 7043]
 [7559 4314 8920]]
Evaluating performance on  val set...
85/85 - 1s - 667ms/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0656044
{'0': {'precision': 0.354422508938287, 'recall': 0.3962460896767466, 'f1-score': 0.3741691966849922, 'support': 5754}, '1': {'precision': 0.5779276517473942, 'recall': 0.4717245520968872, 'f1-score': 0.5194533230464013, 'support': 9991}, '2': {'precision': 0.3398487658724497, 'recall': 0.40704032809295965, 'f1-score': 0.3704222066713319, 'support': 5852}, 'accuracy': 0.43408806778719267, 'macro avg': {'precision': 0.42406630885271035, 'recall': 0.4250036566221978, 'f1-score': 0.4213482421342418, 'support': 21597}, 'weighted avg': {'precision': 0.4538693921806128, 'recall': 0.43408806778719267, 'f1-score': 0.44036386820959744, 'support': 21597}}
[[2280 1666 1808]
 [2459 4713 2819]
 [1694 1776 2382]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0755633
{'0': {'precision': 0.3860182370820669, 'recall': 0.41515601783060924, 'f1-score': 0.400057273768614, 'support': 6730}, '1': {'precision': 0.4687719298245614, 'recall': 0.4210791729702471, 'f1-score': 0.44364747293617585, 'support': 7932}, '2': {'precision': 0.38042576721039534, 'recall': 0.3968276856524874, 'f1-score': 0.38845366645493684, 'support': 6935}, 'accuracy': 0.4114460341714127, 'macro avg': {'precision': 0.4117386447056745, 'recall': 0.41102095881778117, 'f1-score': 0.4107194710532422, 'support': 21597}, 'weighted avg': {'precision': 0.4146156585884532, 'recall': 0.4114460341714127, 'f1-score': 0.4123407595803818, 'support': 21597}}
[[2794 1795 2141]
 [2251 3340 2341]
 [2193 1990 2752]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0824802
{'0': {'precision': 0.3803126526624328, 'recall': 0.45794117647058824, 'f1-score': 0.41553242594075257, 'support': 6800}, '1': {'precision': 0.4513728084684089, 'recall': 0.3491555783009212, 'f1-score': 0.3937382773048622, 'support': 7816}, '2': {'precision': 0.37932907782154013, 'recall': 0.40008594757198107, 'f1-score': 0.389431121026213, 'support': 6981}, 'accuracy': 0.39987035236375423, 'macro avg': {'precision': 0.4036715129841273, 'recall': 0.4023942341144968, 'f1-score': 0.399567274757276, 'support': 21597}, 'weighted avg': {'precision': 0.40571154333313875, 'recall': 0.39987035236375423, 'f1-score': 0.3992081088899344, 'support': 21597}}
[[3114 1541 2145]
 [2662 2729 2425]
 [2412 1776 2793]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0869321
{'0': {'precision': 0.3793373628833669, 'recall': 0.4867154961941692, 'f1-score': 0.42636975529974214, 'support': 6963}, '1': {'precision': 0.4127676447264076, 'recall': 0.2842320819112628, 'f1-score': 0.3366480717923842, 'support': 7325}, '2': {'precision': 0.4012337577109857, 'recall': 0.4182514707894377, 'f1-score': 0.40956591639871387, 'support': 7309}, 'accuracy': 0.3948696578228458, 'macro avg': {'precision': 0.39777958844025335, 'recall': 0.3963996829649566, 'f1-score': 0.39086124783028015, 'support': 21597}, 'weighted avg': {'precision': 0.3980861504138266, 'recall': 0.3948696578228458, 'f1-score': 0.39025221164928087, 'support': 21597}}
[[3389 1378 2196]
 [2877 2082 2366]
 [2668 1584 3057]]
training model: results/LILAK/W2/deepLOB_L2/seq2seq
Epoch 1/50
237/237 - 16s - loss: 13.3024 - accuracy10: 0.3424 - accuracy20: 0.3467 - accuracy30: 0.3460 - accuracy50: 0.3441 - val_loss: 13.2132 - val_accuracy10: 0.4214 - val_accuracy20: 0.3601 - val_accuracy30: 0.3565 - val_accuracy50: 0.3415 - 16s/epoch - 70ms/step
Epoch 2/50
237/237 - 11s - loss: 13.2097 - accuracy10: 0.3550 - accuracy20: 0.3581 - accuracy30: 0.3564 - accuracy50: 0.3554 - val_loss: 13.1068 - val_accuracy10: 0.4015 - val_accuracy20: 0.3671 - val_accuracy30: 0.3635 - val_accuracy50: 0.3454 - 11s/epoch - 47ms/step
Epoch 3/50
237/237 - 11s - loss: 13.0887 - accuracy10: 0.3727 - accuracy20: 0.3853 - accuracy30: 0.3776 - accuracy50: 0.3754 - val_loss: 13.0911 - val_accuracy10: 0.4174 - val_accuracy20: 0.3819 - val_accuracy30: 0.3801 - val_accuracy50: 0.3684 - 11s/epoch - 47ms/step
Epoch 4/50
237/237 - 11s - loss: 13.0215 - accuracy10: 0.3811 - accuracy20: 0.3943 - accuracy30: 0.3881 - accuracy50: 0.3829 - val_loss: 13.0532 - val_accuracy10: 0.4297 - val_accuracy20: 0.3962 - val_accuracy30: 0.3887 - val_accuracy50: 0.3748 - 11s/epoch - 47ms/step
Epoch 5/50
237/237 - 11s - loss: 12.9586 - accuracy10: 0.3920 - accuracy20: 0.4034 - accuracy30: 0.3980 - accuracy50: 0.3911 - val_loss: 12.9470 - val_accuracy10: 0.4281 - val_accuracy20: 0.4016 - val_accuracy30: 0.3957 - val_accuracy50: 0.3808 - 11s/epoch - 47ms/step
Epoch 6/50
237/237 - 11s - loss: 12.8851 - accuracy10: 0.4057 - accuracy20: 0.4157 - accuracy30: 0.4079 - accuracy50: 0.4019 - val_loss: 12.9387 - val_accuracy10: 0.4471 - val_accuracy20: 0.4006 - val_accuracy30: 0.3933 - val_accuracy50: 0.3752 - 11s/epoch - 47ms/step
Epoch 7/50
237/237 - 11s - loss: 12.8322 - accuracy10: 0.4140 - accuracy20: 0.4241 - accuracy30: 0.4156 - accuracy50: 0.4047 - val_loss: 13.0013 - val_accuracy10: 0.4469 - val_accuracy20: 0.3988 - val_accuracy30: 0.3916 - val_accuracy50: 0.3686 - 11s/epoch - 47ms/step
Epoch 8/50
237/237 - 11s - loss: 12.7781 - accuracy10: 0.4211 - accuracy20: 0.4318 - accuracy30: 0.4232 - accuracy50: 0.4123 - val_loss: 12.9657 - val_accuracy10: 0.4379 - val_accuracy20: 0.3983 - val_accuracy30: 0.3940 - val_accuracy50: 0.3759 - 11s/epoch - 47ms/step
Epoch 9/50
237/237 - 11s - loss: 12.7273 - accuracy10: 0.4307 - accuracy20: 0.4382 - accuracy30: 0.4287 - accuracy50: 0.4164 - val_loss: 12.9616 - val_accuracy10: 0.4445 - val_accuracy20: 0.4022 - val_accuracy30: 0.3931 - val_accuracy50: 0.3738 - 11s/epoch - 47ms/step
Epoch 10/50
237/237 - 11s - loss: 12.6772 - accuracy10: 0.4354 - accuracy20: 0.4457 - accuracy30: 0.4360 - accuracy50: 0.4188 - val_loss: 13.0012 - val_accuracy10: 0.4525 - val_accuracy20: 0.3988 - val_accuracy30: 0.3914 - val_accuracy50: 0.3686 - 11s/epoch - 47ms/step
Epoch 11/50
237/237 - 11s - loss: 12.6384 - accuracy10: 0.4412 - accuracy20: 0.4507 - accuracy30: 0.4392 - accuracy50: 0.4231 - val_loss: 13.0074 - val_accuracy10: 0.4438 - val_accuracy20: 0.4021 - val_accuracy30: 0.3943 - val_accuracy50: 0.3758 - 11s/epoch - 46ms/step
Epoch 12/50
237/237 - 11s - loss: 12.6062 - accuracy10: 0.4439 - accuracy20: 0.4536 - accuracy30: 0.4443 - accuracy50: 0.4249 - val_loss: 13.0269 - val_accuracy10: 0.4369 - val_accuracy20: 0.4048 - val_accuracy30: 0.3967 - val_accuracy50: 0.3768 - 11s/epoch - 47ms/step
Epoch 13/50
237/237 - 11s - loss: 12.5640 - accuracy10: 0.4473 - accuracy20: 0.4574 - accuracy30: 0.4462 - accuracy50: 0.4283 - val_loss: 12.9746 - val_accuracy10: 0.4435 - val_accuracy20: 0.4119 - val_accuracy30: 0.4043 - val_accuracy50: 0.3833 - 11s/epoch - 47ms/step
Epoch 14/50
237/237 - 11s - loss: 12.5111 - accuracy10: 0.4553 - accuracy20: 0.4651 - accuracy30: 0.4530 - accuracy50: 0.4327 - val_loss: 13.0476 - val_accuracy10: 0.4430 - val_accuracy20: 0.4141 - val_accuracy30: 0.4022 - val_accuracy50: 0.3790 - 11s/epoch - 46ms/step
Epoch 15/50
237/237 - 11s - loss: 12.4574 - accuracy10: 0.4621 - accuracy20: 0.4692 - accuracy30: 0.4583 - accuracy50: 0.4367 - val_loss: 13.1100 - val_accuracy10: 0.4297 - val_accuracy20: 0.4106 - val_accuracy30: 0.3988 - val_accuracy50: 0.3850 - 11s/epoch - 46ms/step
Epoch 16/50
237/237 - 11s - loss: 12.4095 - accuracy10: 0.4617 - accuracy20: 0.4743 - accuracy30: 0.4641 - accuracy50: 0.4421 - val_loss: 13.0896 - val_accuracy10: 0.4367 - val_accuracy20: 0.4089 - val_accuracy30: 0.3977 - val_accuracy50: 0.3841 - 11s/epoch - 47ms/step
testing model: results/LILAK/W2/deepLOB_L2/seq2seq
Evaluating performance on  test set...
987/987 - 16s - 16s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0662938
{'0': {'precision': 0.35871020138063797, 'recall': 0.34072857142857144, 'f1-score': 0.3494882446461672, 'support': 70000}, '1': {'precision': 0.46399551126914806, 'recall': 0.6067680937773495, 'f1-score': 0.5258633568924898, 'support': 113119}, '2': {'precision': 0.3675087977309733, 'recall': 0.20171240774907748, 'f1-score': 0.26046494313845925, 'support': 69376}, 'accuracy': 0.42171924196518745, 'macro avg': {'precision': 0.39673817012691975, 'recall': 0.3830696909849995, 'f1-score': 0.378605514892372, 'support': 252495}, 'weighted avg': {'precision': 0.4082960561091642, 'recall': 0.42171924196518745, 'f1-score': 0.40404495173657695, 'support': 252495}}
[[23851 38345  7804]
 [28202 68637 16280]
 [14438 40944 13994]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0929383
{'0': {'precision': 0.38441361534379503, 'recall': 0.31636345486761, 'f1-score': 0.3470844712759331, 'support': 80142}, '1': {'precision': 0.36388025120419487, 'recall': 0.5921287619887554, 'f1-score': 0.4507571784037362, 'support': 90710}, '2': {'precision': 0.423955202794688, 'recall': 0.20216062614063668, 'f1-score': 0.2737737820757377, 'support': 81643}, 'accuracy': 0.3785065050793085, 'macro avg': {'precision': 0.39074968978089264, 'recall': 0.37021761433233397, 'f1-score': 0.35720514391846897, 'support': 252495}, 'weighted avg': {'precision': 0.3898224842843686, 'recall': 0.3785065050793085, 'f1-score': 0.36062472619263036, 'support': 252495}}
[[25354 45326  9462]
 [24034 53712 12964]
 [16567 48571 16505]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.102615
{'0': {'precision': 0.34241232947515154, 'recall': 0.2770778940964741, 'f1-score': 0.3062998690008336, 'support': 78902}, '1': {'precision': 0.3442446864216759, 'recall': 0.5751298242465708, 'f1-score': 0.4306958344007357, 'support': 89159}, '2': {'precision': 0.4326026706979088, 'recall': 0.20335409905962054, 'f1-score': 0.2766588250459218, 'support': 84434}, 'accuracy': 0.3576704489197806, 'macro avg': {'precision': 0.3730865621982454, 'recall': 0.35185393913422186, 'f1-score': 0.33788484281583037, 'support': 252495}, 'weighted avg': {'precision': 0.37321888954088533, 'recall': 0.3576704489197806, 'f1-score': 0.3403136434272613, 'support': 252495}}
[[21862 47006 10034]
 [25395 51278 12486]
 [16590 50674 17170]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1054468
{'0': {'precision': 0.31997921369297977, 'recall': 0.251332942166892, 'f1-score': 0.28153196596583724, 'support': 78398}, '1': {'precision': 0.3306820520651445, 'recall': 0.5633638728650605, 'f1-score': 0.4167444117659363, 'support': 88410}, '2': {'precision': 0.4386678909099933, 'recall': 0.20629733798592553, 'f1-score': 0.2806229362458725, 'support': 85687}, 'accuracy': 0.34530584764054734, 'macro avg': {'precision': 0.36310971888937255, 'recall': 0.3403313843392926, 'f1-score': 0.326299771325882, 'support': 252495}, 'weighted avg': {'precision': 0.3640050939091319, 'recall': 0.34530584764054734, 'f1-score': 0.3285675124264489, 'support': 252495}}
[[19704 48020 10674]
 [26657 49807 11946]
 [15218 52792 17677]]
Evaluating performance on  train set...
237/237 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0615436
{'0': {'precision': 0.3843653250773994, 'recall': 0.2871682183542474, 'f1-score': 0.3287326647469632, 'support': 17293}, '1': {'precision': 0.4475274386484153, 'recall': 0.7056741725975187, 'f1-score': 0.547707446647952, 'support': 25713}, '2': {'precision': 0.4215436810856658, 'recall': 0.17007927907374665, 'f1-score': 0.24237005730076805, 'support': 17533}, 'accuracy': 0.43101141412973454, 'macro avg': {'precision': 0.4178121482704935, 'recall': 0.3876405566751709, 'f1-score': 0.3729367228985611, 'support': 60539}, 'weighted avg': {'precision': 0.42195985987553725, 'recall': 0.43101141412973454, 'f1-score': 0.39672689938357736, 'support': 60539}}
[[ 4966 10824  1503]
 [ 4979 18145  2589]
 [ 2975 11576  2982]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0923313
{'0': {'precision': 0.43240830899058746, 'recall': 0.26677012414897877, 'f1-score': 0.329969040247678, 'support': 19976}, '1': {'precision': 0.34887060656216534, 'recall': 0.7172596707201121, 'f1-score': 0.469418835050027, 'support': 19983}, '2': {'precision': 0.46879820502033376, 'recall': 0.16243926141885326, 'f1-score': 0.24127602757027897, 'support': 20580}, 'accuracy': 0.3800029732899453, 'macro avg': {'precision': 0.4166923735243622, 'recall': 0.38215635209598137, 'f1-score': 0.34688796762266133, 'support': 60539}, 'weighted avg': {'precision': 0.41720439337693377, 'recall': 0.3800029732899453, 'f1-score': 0.3458484411071978, 'support': 60539}}
[[ 5329 12885  1762]
 [ 3624 14333  2026]
 [ 3371 13866  3343]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0940996
{'0': {'precision': 0.42297834732655765, 'recall': 0.24051459872355394, 'f1-score': 0.3066572691740886, 'support': 19899}, '1': {'precision': 0.345767063690179, 'recall': 0.7276729874418372, 'f1-score': 0.4687832393231265, 'support': 19987}, '2': {'precision': 0.46250523669878507, 'recall': 0.16036411175131943, 'f1-score': 0.2381534479039333, 'support': 20653}, 'accuracy': 0.3740068385668742, 'macro avg': {'precision': 0.4104168825718406, 'recall': 0.37618389930557017, 'f1-score': 0.33786465213371614, 'support': 60539}, 'weighted avg': {'precision': 0.4109716561054327, 'recall': 0.3740068385668742, 'f1-score': 0.33681307526068244, 'support': 60539}}
[[ 4786 13339  1774]
 [ 3368 14544  2075]
 [ 3161 14180  3312]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0965596
{'0': {'precision': 0.41450174486234975, 'recall': 0.217453213995118, 'f1-score': 0.28525683789192796, 'support': 19664}, '1': {'precision': 0.3458260768605596, 'recall': 0.7424967593977465, 'f1-score': 0.471872376154492, 'support': 20058}, '2': {'precision': 0.4566918133556859, 'recall': 0.15703511553057597, 'f1-score': 0.23370866845397675, 'support': 20817}, 'accuracy': 0.37063710996217314, 'macro avg': {'precision': 0.40567321169286513, 'recall': 0.3723283629744802, 'f1-score': 0.3302792941667989, 'support': 60539}, 'weighted avg': {'precision': 0.40625539304031555, 'recall': 0.37063710996217314, 'f1-score': 0.3293615674593255, 'support': 60539}}
[[ 4276 13584  1804]
 [ 3080 14893  2085]
 [ 2960 14588  3269]]
Evaluating performance on  val set...
85/85 - 1s - 1s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0509132
{'0': {'precision': 0.34970986460348163, 'recall': 0.31575270695075097, 'f1-score': 0.33186490455212925, 'support': 5726}, '1': {'precision': 0.48856458287954696, 'recall': 0.6744512378470482, 'f1-score': 0.5666526315789473, 'support': 9977}, '2': {'precision': 0.39141889348889725, 'recall': 0.17636086145497712, 'f1-score': 0.24316109422492405, 'support': 5897}, 'accuracy': 0.4433796296296296, 'macro avg': {'precision': 0.40989778032397534, 'recall': 0.3888549354175921, 'f1-score': 0.38055954345200016, 'support': 21600}, 'weighted avg': {'precision': 0.4252335529172594, 'recall': 0.4433796296296296, 'f1-score': 0.4160959593228253, 'support': 21600}}
[[1808 3362  556]
 [2187 6729 1061]
 [1175 3682 1040]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0794502
{'0': {'precision': 0.395697651470298, 'recall': 0.29965625467045287, 'f1-score': 0.34104439530532404, 'support': 6691}, '1': {'precision': 0.3943651770840878, 'recall': 0.6859410430839002, 'f1-score': 0.5008047827086687, 'support': 7938}, '2': {'precision': 0.4402054292002935, 'recall': 0.17214173002438674, 'f1-score': 0.247499226564917, 'support': 6971}, 'accuracy': 0.40046296296296297, 'macro avg': {'precision': 0.4100894192515598, 'recall': 0.38591300925957994, 'f1-score': 0.36311613485963656, 'support': 21600}, 'weighted avg': {'precision': 0.4095720281776157, 'recall': 0.40046296296296297, 'f1-score': 0.36956636678302646, 'support': 21600}}
[[2005 3962  724]
 [1691 5445  802]
 [1371 4400 1200]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0828522
{'0': {'precision': 0.3920148944973107, 'recall': 0.2804499038034631, 'f1-score': 0.32697782762488137, 'support': 6757}, '1': {'precision': 0.38403367339658984, 'recall': 0.6875718482564823, 'f1-score': 0.4928133296713356, 'support': 7829}, '2': {'precision': 0.4328846853401237, 'recall': 0.16966067864271456, 'f1-score': 0.24377752739936495, 'support': 7014}, 'accuracy': 0.392037037037037, 'macro avg': {'precision': 0.4029777510780081, 'recall': 0.3792274769008867, 'f1-score': 0.3545228948985273, 'support': 21600}, 'weighted avg': {'precision': 0.4023934006535119, 'recall': 0.392037037037037, 'f1-score': 0.3600685331683961, 'support': 21600}}
[[1895 4134  728]
 [1615 5383  831]
 [1324 4500 1190]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0936357
{'0': {'precision': 0.38588028941021707, 'recall': 0.25301897642323173, 'f1-score': 0.30563514804202485, 'support': 6956}, '1': {'precision': 0.354795768233728, 'recall': 0.6913310580204778, 'f1-score': 0.4689323085470876, 'support': 7325}, '2': {'precision': 0.44143167028199565, 'recall': 0.16682606913512774, 'f1-score': 0.2421417947446703, 'support': 7319}, 'accuracy': 0.37245370370370373, 'macro avg': {'precision': 0.3940359093086469, 'recall': 0.37039203452627906, 'f1-score': 0.3389030837779276, 'support': 21600}, 'weighted avg': {'precision': 0.3941620689927525, 'recall': 0.37245370370370373, 'f1-score': 0.3394982891492585, 'support': 21600}}
[[1760 4402  794]
 [1510 5064  751]
 [1291 4807 1221]]
training model: results/LILAK/W2/deepOF_L2/seq2seq
Epoch 1/50
237/237 - 12s - loss: 13.2652 - accuracy10: 0.3624 - accuracy20: 0.3572 - accuracy30: 0.3514 - accuracy50: 0.3439 - val_loss: 13.1508 - val_accuracy10: 0.4418 - val_accuracy20: 0.3782 - val_accuracy30: 0.3667 - val_accuracy50: 0.3458 - 12s/epoch - 51ms/step
Epoch 2/50
237/237 - 7s - loss: 13.1018 - accuracy10: 0.4017 - accuracy20: 0.3865 - accuracy30: 0.3729 - accuracy50: 0.3584 - val_loss: 13.0641 - val_accuracy10: 0.4592 - val_accuracy20: 0.3966 - val_accuracy30: 0.3782 - val_accuracy50: 0.3542 - 7s/epoch - 30ms/step
Epoch 3/50
237/237 - 7s - loss: 13.0107 - accuracy10: 0.4298 - accuracy20: 0.4049 - accuracy30: 0.3879 - accuracy50: 0.3665 - val_loss: 12.9610 - val_accuracy10: 0.4716 - val_accuracy20: 0.4159 - val_accuracy30: 0.3940 - val_accuracy50: 0.3703 - 7s/epoch - 30ms/step
Epoch 4/50
237/237 - 7s - loss: 12.9222 - accuracy10: 0.4466 - accuracy20: 0.4192 - accuracy30: 0.3995 - accuracy50: 0.3775 - val_loss: 12.8626 - val_accuracy10: 0.4753 - val_accuracy20: 0.4282 - val_accuracy30: 0.4050 - val_accuracy50: 0.3754 - 7s/epoch - 30ms/step
Epoch 5/50
237/237 - 7s - loss: 12.8501 - accuracy10: 0.4586 - accuracy20: 0.4313 - accuracy30: 0.4091 - accuracy50: 0.3876 - val_loss: 12.8285 - val_accuracy10: 0.4730 - val_accuracy20: 0.4268 - val_accuracy30: 0.4050 - val_accuracy50: 0.3831 - 7s/epoch - 30ms/step
Epoch 6/50
237/237 - 7s - loss: 12.7788 - accuracy10: 0.4669 - accuracy20: 0.4413 - accuracy30: 0.4200 - accuracy50: 0.3940 - val_loss: 12.8076 - val_accuracy10: 0.4709 - val_accuracy20: 0.4357 - val_accuracy30: 0.4143 - val_accuracy50: 0.3897 - 7s/epoch - 29ms/step
Epoch 7/50
237/237 - 7s - loss: 12.7108 - accuracy10: 0.4733 - accuracy20: 0.4483 - accuracy30: 0.4278 - accuracy50: 0.4038 - val_loss: 12.7647 - val_accuracy10: 0.4722 - val_accuracy20: 0.4415 - val_accuracy30: 0.4171 - val_accuracy50: 0.3902 - 7s/epoch - 30ms/step
Epoch 8/50
237/237 - 7s - loss: 12.6443 - accuracy10: 0.4784 - accuracy20: 0.4570 - accuracy30: 0.4353 - accuracy50: 0.4079 - val_loss: 12.7299 - val_accuracy10: 0.4697 - val_accuracy20: 0.4424 - val_accuracy30: 0.4227 - val_accuracy50: 0.3975 - 7s/epoch - 30ms/step
Epoch 9/50
237/237 - 7s - loss: 12.5761 - accuracy10: 0.4813 - accuracy20: 0.4649 - accuracy30: 0.4427 - accuracy50: 0.4134 - val_loss: 12.7230 - val_accuracy10: 0.4693 - val_accuracy20: 0.4448 - val_accuracy30: 0.4210 - val_accuracy50: 0.3967 - 7s/epoch - 29ms/step
Epoch 10/50
237/237 - 7s - loss: 12.5159 - accuracy10: 0.4838 - accuracy20: 0.4695 - accuracy30: 0.4486 - accuracy50: 0.4215 - val_loss: 12.7270 - val_accuracy10: 0.4703 - val_accuracy20: 0.4433 - val_accuracy30: 0.4233 - val_accuracy50: 0.4003 - 7s/epoch - 29ms/step
Epoch 11/50
237/237 - 7s - loss: 12.4567 - accuracy10: 0.4864 - accuracy20: 0.4758 - accuracy30: 0.4560 - accuracy50: 0.4279 - val_loss: 12.7513 - val_accuracy10: 0.4668 - val_accuracy20: 0.4399 - val_accuracy30: 0.4170 - val_accuracy50: 0.3979 - 7s/epoch - 29ms/step
Epoch 12/50
237/237 - 7s - loss: 12.3855 - accuracy10: 0.4907 - accuracy20: 0.4823 - accuracy30: 0.4648 - accuracy50: 0.4376 - val_loss: 12.7598 - val_accuracy10: 0.4595 - val_accuracy20: 0.4413 - val_accuracy30: 0.4215 - val_accuracy50: 0.4040 - 7s/epoch - 29ms/step
Epoch 13/50
237/237 - 7s - loss: 12.3250 - accuracy10: 0.4926 - accuracy20: 0.4893 - accuracy30: 0.4709 - accuracy50: 0.4405 - val_loss: 12.7626 - val_accuracy10: 0.4585 - val_accuracy20: 0.4421 - val_accuracy30: 0.4219 - val_accuracy50: 0.4088 - 7s/epoch - 29ms/step
Epoch 14/50
237/237 - 7s - loss: 12.2527 - accuracy10: 0.4942 - accuracy20: 0.4945 - accuracy30: 0.4756 - accuracy50: 0.4488 - val_loss: 12.8376 - val_accuracy10: 0.4654 - val_accuracy20: 0.4431 - val_accuracy30: 0.4177 - val_accuracy50: 0.4010 - 7s/epoch - 29ms/step
Epoch 15/50
237/237 - 7s - loss: 12.1796 - accuracy10: 0.4981 - accuracy20: 0.5009 - accuracy30: 0.4836 - accuracy50: 0.4541 - val_loss: 12.8580 - val_accuracy10: 0.4565 - val_accuracy20: 0.4404 - val_accuracy30: 0.4178 - val_accuracy50: 0.3990 - 7s/epoch - 29ms/step
Epoch 16/50
237/237 - 7s - loss: 12.1272 - accuracy10: 0.4980 - accuracy20: 0.5031 - accuracy30: 0.4889 - accuracy50: 0.4599 - val_loss: 12.8954 - val_accuracy10: 0.4458 - val_accuracy20: 0.4364 - val_accuracy30: 0.4149 - val_accuracy50: 0.4019 - 7s/epoch - 29ms/step
Epoch 17/50
237/237 - 7s - loss: 12.0730 - accuracy10: 0.5005 - accuracy20: 0.5101 - accuracy30: 0.4925 - accuracy50: 0.4672 - val_loss: 12.9716 - val_accuracy10: 0.4510 - val_accuracy20: 0.4375 - val_accuracy30: 0.4159 - val_accuracy50: 0.3983 - 7s/epoch - 29ms/step
Epoch 18/50
237/237 - 7s - loss: 12.0033 - accuracy10: 0.5008 - accuracy20: 0.5122 - accuracy30: 0.5003 - accuracy50: 0.4729 - val_loss: 13.0259 - val_accuracy10: 0.4510 - val_accuracy20: 0.4376 - val_accuracy30: 0.4150 - val_accuracy50: 0.3974 - 7s/epoch - 28ms/step
Epoch 19/50
237/237 - 7s - loss: 11.9284 - accuracy10: 0.5000 - accuracy20: 0.5165 - accuracy30: 0.5051 - accuracy50: 0.4785 - val_loss: 13.0890 - val_accuracy10: 0.4318 - val_accuracy20: 0.4235 - val_accuracy30: 0.4034 - val_accuracy50: 0.3912 - 7s/epoch - 28ms/step
testing model: results/LILAK/W2/deepOF_L2/seq2seq
Evaluating performance on  test set...
987/987 - 10s - 10s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0322242
{'0': {'precision': 0.42160244267903085, 'recall': 0.4260836023886397, 'f1-score': 0.4238311780588319, 'support': 69998}, '1': {'precision': 0.5735424498191362, 'recall': 0.571884475640697, 'f1-score': 0.572712262793755, 'support': 113119}, '2': {'precision': 0.3823597656476594, 'recall': 0.38006140717570236, 'f1-score': 0.3812071221508143, 'support': 69373}, 'accuracy': 0.4787595548338548, 'macro avg': {'precision': 0.45916821938194213, 'recall': 0.459343161735013, 'f1-score': 0.45925018766780035, 'support': 252490}, 'weighted avg': {'precision': 0.47889152119296896, 'recall': 0.4787595548338548, 'f1-score': 0.47882076494790815, 'support': 252490}}
[[29825 22638 17535]
 [23373 64691 25055]
 [17544 25463 26366]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0542538
{'0': {'precision': 0.4485602499507417, 'recall': 0.39769905541483136, 'f1-score': 0.421601243427362, 'support': 80141}, '1': {'precision': 0.4674139147877122, 'recall': 0.5548843003450594, 'f1-score': 0.5074070153684858, 'support': 90709}, '2': {'precision': 0.4239885020067252, 'recall': 0.38302302792748655, 'f1-score': 0.40246602141680393, 'support': 81640}, 'accuracy': 0.44942373955404175, 'macro avg': {'precision': 0.44665422224839296, 'recall': 0.44520212789579244, 'f1-score': 0.44382476007088384, 'support': 252490}, 'weighted avg': {'precision': 0.4473885583255179, 'recall': 0.44942373955404175, 'f1-score': 0.44624046178082327, 'support': 252490}}
[[31872 27016 21253]
 [19147 50333 21229]
 [20035 30335 31270]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0760404
{'0': {'precision': 0.4041508436617563, 'recall': 0.3682289422321361, 'f1-score': 0.38535456360127596, 'support': 78902}, '1': {'precision': 0.43398373340193536, 'recall': 0.49194688081832255, 'f1-score': 0.46115106400874756, 'support': 89158}, '2': {'precision': 0.41845728295718865, 'recall': 0.3941963756958427, 'f1-score': 0.40596468758576526, 'support': 84430}, 'accuracy': 0.4205988355974494, 'macro avg': {'precision': 0.4188639533402934, 'recall': 0.4181240662487671, 'f1-score': 0.4174901050652629, 'support': 252490}, 'weighted avg': {'precision': 0.4194692065797659, 'recall': 0.4205988355974494, 'f1-score': 0.4190112515942253, 'support': 252490}}
[[29054 26751 23097]
 [22141 43861 23156]
 [20694 30454 33282]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0911589
{'0': {'precision': 0.3699587912087912, 'recall': 0.34355069136180416, 'f1-score': 0.3562660387840948, 'support': 78396}, '1': {'precision': 0.3982454837648906, 'recall': 0.4246513364024025, 'f1-score': 0.4110247427195096, 'support': 88409}, '2': {'precision': 0.4055889204977815, 'recall': 0.40432981268600104, 'f1-score': 0.4049583878810548, 'support': 85685}, 'accuracy': 0.3925739633252802, 'macro avg': {'precision': 0.3912643984904878, 'recall': 0.3908439468167359, 'f1-score': 0.39074972312821976, 'support': 252490}, 'weighted avg': {'precision': 0.3919547745361282, 'recall': 0.3925739633252802, 'f1-score': 0.39196395231967684, 'support': 252490}}
[[26933 26321 25142]
 [25234 37543 25632]
 [20633 30407 34645]]
Evaluating performance on  train set...
237/237 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.013896
{'0': {'precision': 0.4457262434941246, 'recall': 0.47959124761849775, 'f1-score': 0.46203904555314534, 'support': 17321}, '1': {'precision': 0.564212154516221, 'recall': 0.5372688863909454, 'f1-score': 0.5504109915419133, 'support': 25799}, '2': {'precision': 0.44334833275643243, 'recall': 0.4412102422781031, 'f1-score': 0.4422767034990792, 'support': 17418}, 'accuracy': 0.4931282830618785, 'macro avg': {'precision': 0.4844289102555927, 'recall': 0.4860234587625154, 'f1-score': 0.4849089135313793, 'support': 60538}, 'weighted avg': {'precision': 0.49553627304960945, 'recall': 0.4931282830618785, 'f1-score': 0.49401379464737544, 'support': 60538}}
[[ 8307  5220  3794]
 [ 6083 13861  5855]
 [ 4247  5486  7685]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.032121
{'0': {'precision': 0.4858282371709652, 'recall': 0.4572114903413072, 'f1-score': 0.4710856730347797, 'support': 19982}, '1': {'precision': 0.44399691490273374, 'recall': 0.5157789945246392, 'f1-score': 0.4772036474164134, 'support': 20090}, '2': {'precision': 0.48991573797227506, 'recall': 0.44034007622398125, 'f1-score': 0.46380690152080495, 'support': 20466}, 'accuracy': 0.47094386996597176, 'macro avg': {'precision': 0.47324696334865796, 'recall': 0.47111018702997587, 'f1-score': 0.4706987406573327, 'support': 60538}, 'weighted avg': {'precision': 0.4733280476541466, 'recall': 0.47094386996597176, 'f1-score': 0.47065524532857894, 'support': 60538}}
[[ 9136  6386  4460]
 [ 4805 10362  4923]
 [ 4864  6590  9012]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.05006
{'0': {'precision': 0.4644900530155897, 'recall': 0.44402629334136184, 'f1-score': 0.4540277065161621, 'support': 19929}, '1': {'precision': 0.4180327868852459, 'recall': 0.4551755085759872, 'f1-score': 0.43581419773714614, 'support': 20056}, '2': {'precision': 0.4689806097002392, 'recall': 0.44835303848586583, 'f1-score': 0.4584349037361326, 'support': 20553}, 'accuracy': 0.4491889391786977, 'macro avg': {'precision': 0.4505011498670249, 'recall': 0.4491849468010716, 'f1-score': 0.44942560266314696, 'support': 60538}, 'weighted avg': {'precision': 0.4506235143461495, 'recall': 0.4491889391786977, 'f1-score': 0.44948991194729804, 'support': 60538}}
[[8849 6244 4836]
 [5329 9129 5598]
 [4873 6465 9215]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0696446
{'0': {'precision': 0.4304828086915936, 'recall': 0.4213277839813217, 'f1-score': 0.4258560984994228, 'support': 19702}, '1': {'precision': 0.381737040851356, 'recall': 0.38836501521728284, 'f1-score': 0.3850225058119404, 'support': 20043}, '2': {'precision': 0.4465586656441718, 'recall': 0.4480834896359352, 'f1-score': 0.44731977818853974, 'support': 20793}, 'accuracy': 0.41960421553404476, 'macro avg': {'precision': 0.4195928383957071, 'recall': 0.41925876294484654, 'f1-score': 0.419399460833301, 'support': 60538}, 'weighted avg': {'precision': 0.4198655743725391, 'recall': 0.41960421553404476, 'f1-score': 0.419708994094596, 'support': 60538}}
[[8301 6203 5198]
 [5910 7784 6349]
 [5072 6404 9317]]
Evaluating performance on  val set...
85/85 - 1s - 896ms/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0360069
{'0': {'precision': 0.38477962482842765, 'recall': 0.43847758081334726, 'f1-score': 0.40987734546340676, 'support': 5754}, '1': {'precision': 0.5858046227649367, 'recall': 0.5377840056050446, 'f1-score': 0.5607681469498513, 'support': 9991}, '2': {'precision': 0.37491479209270623, 'recall': 0.37593984962406013, 'f1-score': 0.3754266211604096, 'support': 5852}, 'accuracy': 0.46747233412047967, 'macro avg': {'precision': 0.4484996798953569, 'recall': 0.45073381201415064, 'f1-score': 0.4486907045245559, 'support': 21597}, 'weighted avg': {'precision': 0.47510289904309727, 'recall': 0.46747233412047967, 'f1-score': 0.4703461308979546, 'support': 21597}}
[[2523 1802 1429]
 [2379 5373 2239]
 [1655 1997 2200]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0530684
{'0': {'precision': 0.418442932728647, 'recall': 0.4112927191679049, 'f1-score': 0.4148370176095916, 'support': 6730}, '1': {'precision': 0.4760864566567027, 'recall': 0.5220625315179022, 'f1-score': 0.4980156343956705, 'support': 7932}, '2': {'precision': 0.42409293443666457, 'recall': 0.384282624369142, 'f1-score': 0.4032075043497996, 'support': 6935}, 'accuracy': 0.4433023105060888, 'macro avg': {'precision': 0.4395407746073381, 'recall': 0.43921262501831637, 'f1-score': 0.4386867187850205, 'support': 21597}, 'weighted avg': {'precision': 0.44142812482210625, 'recall': 0.4433023105060888, 'f1-score': 0.4416519508822924, 'support': 21597}}
[[2768 2184 1778]
 [1950 4141 1841]
 [1897 2373 2665]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0702093
{'0': {'precision': 0.3995243757431629, 'recall': 0.3952941176470588, 'f1-score': 0.397397989355411, 'support': 6800}, '1': {'precision': 0.44898715415019763, 'recall': 0.46507164790174, 'f1-score': 0.4568878833584716, 'support': 7816}, '2': {'precision': 0.4076480141739259, 'recall': 0.3955020770663229, 'f1-score': 0.40148320488585143, 'support': 6981}, 'accuracy': 0.4206139741630782, 'macro avg': {'precision': 0.4187198480224288, 'recall': 0.4186226142050406, 'f1-score': 0.4185896925332447, 'support': 21597}, 'weighted avg': {'precision': 0.42005093942860716, 'recall': 0.4206139741630782, 'f1-score': 0.42024801024469777, 'support': 21597}}
[[2688 2150 1962]
 [2131 3635 2050]
 [1909 2311 2761]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0843458
{'0': {'precision': 0.39195687017339353, 'recall': 0.3863277322992963, 'f1-score': 0.38912194416317086, 'support': 6963}, '1': {'precision': 0.39899056979678577, 'recall': 0.4101023890784983, 'f1-score': 0.4044701763834657, 'support': 7325}, '2': {'precision': 0.4087439278278973, 'recall': 0.4029278971131482, 'f1-score': 0.40581507509990355, 'support': 7309}, 'accuracy': 0.4000092605454461, 'macro avg': {'precision': 0.39989712259935883, 'recall': 0.39978600616364757, 'f1-score': 0.39980239854884675, 'support': 21597}, 'weighted avg': {'precision': 0.4000236597338935, 'recall': 0.4000092605454461, 'f1-score': 0.39997696546382555, 'support': 21597}}
[[2690 2190 2083]
 [2144 3004 2177]
 [2029 2335 2945]]
training model: results/LILAK/W2/deepVOL_L2/seq2seq
Epoch 1/50
237/237 - 12s - loss: 13.3150 - accuracy10: 0.3436 - accuracy20: 0.3518 - accuracy30: 0.3520 - accuracy50: 0.3522 - val_loss: 13.2080 - val_accuracy10: 0.3583 - val_accuracy20: 0.3609 - val_accuracy30: 0.3594 - val_accuracy50: 0.3526 - 12s/epoch - 50ms/step
Epoch 2/50
237/237 - 7s - loss: 13.1910 - accuracy10: 0.3605 - accuracy20: 0.3647 - accuracy30: 0.3647 - accuracy50: 0.3614 - val_loss: 13.1565 - val_accuracy10: 0.3769 - val_accuracy20: 0.3611 - val_accuracy30: 0.3582 - val_accuracy50: 0.3460 - 7s/epoch - 30ms/step
Epoch 3/50
237/237 - 7s - loss: 13.1046 - accuracy10: 0.3767 - accuracy20: 0.3821 - accuracy30: 0.3790 - accuracy50: 0.3741 - val_loss: 13.0738 - val_accuracy10: 0.4063 - val_accuracy20: 0.3774 - val_accuracy30: 0.3732 - val_accuracy50: 0.3573 - 7s/epoch - 28ms/step
Epoch 4/50
237/237 - 7s - loss: 13.0535 - accuracy10: 0.3808 - accuracy20: 0.3898 - accuracy30: 0.3877 - accuracy50: 0.3854 - val_loss: 13.0774 - val_accuracy10: 0.3982 - val_accuracy20: 0.3708 - val_accuracy30: 0.3670 - val_accuracy50: 0.3503 - 7s/epoch - 28ms/step
Epoch 5/50
237/237 - 7s - loss: 12.9818 - accuracy10: 0.3878 - accuracy20: 0.4031 - accuracy30: 0.3988 - accuracy50: 0.3946 - val_loss: 12.9551 - val_accuracy10: 0.3946 - val_accuracy20: 0.3879 - val_accuracy30: 0.3869 - val_accuracy50: 0.3725 - 7s/epoch - 29ms/step
Epoch 6/50
237/237 - 7s - loss: 12.9230 - accuracy10: 0.3992 - accuracy20: 0.4139 - accuracy30: 0.4074 - accuracy50: 0.3999 - val_loss: 12.9471 - val_accuracy10: 0.3911 - val_accuracy20: 0.3925 - val_accuracy30: 0.3893 - val_accuracy50: 0.3811 - 7s/epoch - 28ms/step
Epoch 7/50
237/237 - 7s - loss: 12.8644 - accuracy10: 0.4044 - accuracy20: 0.4210 - accuracy30: 0.4160 - accuracy50: 0.4063 - val_loss: 12.9008 - val_accuracy10: 0.4081 - val_accuracy20: 0.3959 - val_accuracy30: 0.3895 - val_accuracy50: 0.3783 - 7s/epoch - 28ms/step
Epoch 8/50
237/237 - 7s - loss: 12.8285 - accuracy10: 0.4068 - accuracy20: 0.4228 - accuracy30: 0.4173 - accuracy50: 0.4065 - val_loss: 12.8585 - val_accuracy10: 0.4159 - val_accuracy20: 0.4062 - val_accuracy30: 0.3995 - val_accuracy50: 0.3891 - 7s/epoch - 29ms/step
Epoch 9/50
237/237 - 7s - loss: 12.7867 - accuracy10: 0.4171 - accuracy20: 0.4321 - accuracy30: 0.4249 - accuracy50: 0.4132 - val_loss: 12.8290 - val_accuracy10: 0.4232 - val_accuracy20: 0.4137 - val_accuracy30: 0.4079 - val_accuracy50: 0.3895 - 7s/epoch - 29ms/step
Epoch 10/50
237/237 - 6s - loss: 12.7502 - accuracy10: 0.4231 - accuracy20: 0.4343 - accuracy30: 0.4262 - accuracy50: 0.4154 - val_loss: 12.8379 - val_accuracy10: 0.4192 - val_accuracy20: 0.4119 - val_accuracy30: 0.4038 - val_accuracy50: 0.3906 - 6s/epoch - 27ms/step
Epoch 11/50
237/237 - 7s - loss: 12.7118 - accuracy10: 0.4291 - accuracy20: 0.4389 - accuracy30: 0.4306 - accuracy50: 0.4193 - val_loss: 12.8559 - val_accuracy10: 0.4364 - val_accuracy20: 0.4115 - val_accuracy30: 0.4023 - val_accuracy50: 0.3826 - 7s/epoch - 28ms/step
Epoch 12/50
237/237 - 7s - loss: 12.6755 - accuracy10: 0.4353 - accuracy20: 0.4442 - accuracy30: 0.4356 - accuracy50: 0.4232 - val_loss: 12.8128 - val_accuracy10: 0.4295 - val_accuracy20: 0.4146 - val_accuracy30: 0.4065 - val_accuracy50: 0.3943 - 7s/epoch - 29ms/step
Epoch 13/50
237/237 - 7s - loss: 12.6430 - accuracy10: 0.4381 - accuracy20: 0.4467 - accuracy30: 0.4385 - accuracy50: 0.4258 - val_loss: 12.9085 - val_accuracy10: 0.4245 - val_accuracy20: 0.4109 - val_accuracy30: 0.4041 - val_accuracy50: 0.3874 - 7s/epoch - 29ms/step
Epoch 14/50
237/237 - 7s - loss: 12.6137 - accuracy10: 0.4422 - accuracy20: 0.4512 - accuracy30: 0.4429 - accuracy50: 0.4284 - val_loss: 12.8991 - val_accuracy10: 0.4316 - val_accuracy20: 0.4116 - val_accuracy30: 0.3999 - val_accuracy50: 0.3845 - 7s/epoch - 28ms/step
Epoch 15/50
237/237 - 7s - loss: 12.5734 - accuracy10: 0.4480 - accuracy20: 0.4562 - accuracy30: 0.4469 - accuracy50: 0.4331 - val_loss: 12.8932 - val_accuracy10: 0.4286 - val_accuracy20: 0.4135 - val_accuracy30: 0.4033 - val_accuracy50: 0.3870 - 7s/epoch - 28ms/step
Epoch 16/50
237/237 - 7s - loss: 12.5398 - accuracy10: 0.4504 - accuracy20: 0.4589 - accuracy30: 0.4484 - accuracy50: 0.4338 - val_loss: 12.9078 - val_accuracy10: 0.4334 - val_accuracy20: 0.4149 - val_accuracy30: 0.4057 - val_accuracy50: 0.3863 - 7s/epoch - 28ms/step
Epoch 17/50
237/237 - 7s - loss: 12.5223 - accuracy10: 0.4517 - accuracy20: 0.4596 - accuracy30: 0.4522 - accuracy50: 0.4354 - val_loss: 12.8323 - val_accuracy10: 0.4351 - val_accuracy20: 0.4190 - val_accuracy30: 0.4125 - val_accuracy50: 0.3977 - 7s/epoch - 28ms/step
Epoch 18/50
237/237 - 7s - loss: 12.4921 - accuracy10: 0.4560 - accuracy20: 0.4633 - accuracy30: 0.4559 - accuracy50: 0.4392 - val_loss: 12.8214 - val_accuracy10: 0.4385 - val_accuracy20: 0.4201 - val_accuracy30: 0.4123 - val_accuracy50: 0.3990 - 7s/epoch - 29ms/step
Epoch 19/50
237/237 - 7s - loss: 12.4873 - accuracy10: 0.4573 - accuracy20: 0.4648 - accuracy30: 0.4542 - accuracy50: 0.4378 - val_loss: 12.8837 - val_accuracy10: 0.4233 - val_accuracy20: 0.4121 - val_accuracy30: 0.4054 - val_accuracy50: 0.3936 - 7s/epoch - 28ms/step
Epoch 20/50
237/237 - 7s - loss: 12.4417 - accuracy10: 0.4599 - accuracy20: 0.4673 - accuracy30: 0.4594 - accuracy50: 0.4409 - val_loss: 12.9187 - val_accuracy10: 0.4249 - val_accuracy20: 0.4128 - val_accuracy30: 0.4033 - val_accuracy50: 0.3916 - 7s/epoch - 28ms/step
Epoch 21/50
237/237 - 7s - loss: 12.4199 - accuracy10: 0.4637 - accuracy20: 0.4710 - accuracy30: 0.4618 - accuracy50: 0.4437 - val_loss: 12.9274 - val_accuracy10: 0.4108 - val_accuracy20: 0.4101 - val_accuracy30: 0.4038 - val_accuracy50: 0.3946 - 7s/epoch - 29ms/step
Epoch 22/50
237/237 - 7s - loss: 12.4113 - accuracy10: 0.4638 - accuracy20: 0.4703 - accuracy30: 0.4612 - accuracy50: 0.4440 - val_loss: 12.9012 - val_accuracy10: 0.4271 - val_accuracy20: 0.4160 - val_accuracy30: 0.4109 - val_accuracy50: 0.3955 - 7s/epoch - 28ms/step
testing model: results/LILAK/W2/deepVOL_L2/seq2seq
Evaluating performance on  test set...
987/987 - 9s - 9s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0674721
{'0': {'precision': 0.34756341437743393, 'recall': 0.47174285714285713, 'f1-score': 0.40024240955093626, 'support': 70000}, '1': {'precision': 0.5058592166085476, 'recall': 0.4411460497352346, 'f1-score': 0.47129156100808905, 'support': 113119}, '2': {'precision': 0.39568638781718984, 'recall': 0.33557714483394835, 'f1-score': 0.36316130189606355, 'support': 69376}, 'accuracy': 0.4206221905384265, 'macro avg': {'precision': 0.4163696729343905, 'recall': 0.41615535057068004, 'f1-score': 0.41156509081836296, 'support': 252495}, 'weighted avg': {'precision': 0.43170306964956945, 'recall': 0.4206221905384265, 'f1-score': 0.421884303604352, 'support': 252495}}
[[33022 23038 13940]
 [41601 49902 21616]
 [20387 25708 23281]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0798342
{'0': {'precision': 0.38706874895327414, 'recall': 0.4614184821941055, 'f1-score': 0.42098612233745825, 'support': 80142}, '1': {'precision': 0.40933965334852307, 'recall': 0.44364458163377796, 'f1-score': 0.42580228756441046, 'support': 90710}, '2': {'precision': 0.4463825941650894, 'recall': 0.32065210734539396, 'f1-score': 0.373212630978687, 'support': 81643}, 'accuracy': 0.40951702013901264, 'macro avg': {'precision': 0.4142636654889622, 'recall': 0.4085717237244258, 'f1-score': 0.4066670136268519, 'support': 252495}, 'weighted avg': {'precision': 0.4142485109379521, 'recall': 0.40951702013901264, 'f1-score': 0.40726903167321804, 'support': 252495}}
[[36979 26960 16203]
 [34202 40243 16265]
 [24355 31109 26179]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0847207
{'0': {'precision': 0.3765380356606956, 'recall': 0.46115434336265243, 'f1-score': 0.41457259236049787, 'support': 78902}, '1': {'precision': 0.39860397519087876, 'recall': 0.43681512802969974, 'f1-score': 0.4168356835148369, 'support': 89159}, '2': {'precision': 0.45028887818969665, 'recall': 0.3101475708837672, 'f1-score': 0.36730486008836527, 'support': 84434}, 'accuracy': 0.4020634071961821, 'macro avg': {'precision': 0.408476963013757, 'recall': 0.40270568075870644, 'f1-score': 0.39957104532123333, 'support': 252495}, 'weighted avg': {'precision': 0.40899196837486923, 'recall': 0.4020634071961821, 'f1-score': 0.3995654486054313, 'support': 252495}}
[[36386 26331 16185]
 [34429 38946 15784]
 [25818 32429 26187]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0942901
{'0': {'precision': 0.3657353959824521, 'recall': 0.464705732289089, 'f1-score': 0.40932301936397186, 'support': 78398}, '1': {'precision': 0.3813011632916846, 'recall': 0.4104173736002715, 'f1-score': 0.39532388013357234, 'support': 88410}, '2': {'precision': 0.43140278234957813, 'recall': 0.29060417566258595, 'f1-score': 0.3472749079549258, 'support': 85687}, 'accuracy': 0.3866135963088378, 'macro avg': {'precision': 0.39281311387457163, 'recall': 0.38857576051731546, 'f1-score': 0.38397393581749, 'support': 252495}, 'weighted avg': {'precision': 0.3934706415257269, 'recall': 0.3866135963088378, 'f1-score': 0.3833645630711085, 'support': 252495}}
[[36432 25753 16213]
 [35518 36285 16607]
 [27663 33123 24901]]
Evaluating performance on  train set...
237/237 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0568327
{'0': {'precision': 0.37964474315890545, 'recall': 0.4572948591915804, 'f1-score': 0.4148676651889936, 'support': 17293}, '1': {'precision': 0.48818541083484274, 'recall': 0.46120639365301597, 'f1-score': 0.4743125687431257, 'support': 25713}, '2': {'precision': 0.41188298631380943, 'recall': 0.36217418582102323, 'f1-score': 0.3854324734446131, 'support': 17533}, 'accuracy': 0.43140785278911115, 'macro avg': {'precision': 0.4265710467691859, 'recall': 0.4268918128885399, 'f1-score': 0.4248709024589108, 'support': 60539}, 'weighted avg': {'precision': 0.43508238344345435, 'recall': 0.43140785278911115, 'f1-score': 0.43159109286756736, 'support': 60539}}
[[ 7908  5860  3525]
 [ 8312 11859  5542]
 [ 4610  6573  6350]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0704633
{'0': {'precision': 0.42919109585776255, 'recall': 0.45074088906688026, 'f1-score': 0.4397021120742278, 'support': 19976}, '1': {'precision': 0.3876103274766972, 'recall': 0.4702997547915728, 'f1-score': 0.42497004227995205, 'support': 19983}, '2': {'precision': 0.4655217448086718, 'recall': 0.34640427599611273, 'f1-score': 0.39722516297988525, 'support': 20580}, 'accuracy': 0.4217281421893325, 'macro avg': {'precision': 0.4274410560477106, 'recall': 0.42248163995152194, 'f1-score': 0.420632439111355, 'support': 60539}, 'weighted avg': {'precision': 0.42781638304207154, 'recall': 0.4217281421893325, 'f1-score': 0.42039940533872533, 'support': 60539}}
[[9004 6856 4116]
 [6516 9398 4069]
 [5459 7992 7129]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0747843
{'0': {'precision': 0.4196306268008124, 'recall': 0.4464545957083271, 'f1-score': 0.432627221816411, 'support': 19899}, '1': {'precision': 0.3740805025208695, 'recall': 0.45289438134787613, 'f1-score': 0.40973180943759197, 'support': 19987}, '2': {'precision': 0.4619644034278181, 'recall': 0.33932116399554546, 'f1-score': 0.39125701365044807, 'support': 20653}, 'accuracy': 0.41203191331207983, 'macro avg': {'precision': 0.4185585109165, 'recall': 0.4128900470172496, 'f1-score': 0.4112053483014837, 'support': 60539}, 'weighted avg': {'precision': 0.4190344682037812, 'recall': 0.41203191331207983, 'f1-score': 0.4109547542092967, 'support': 60539}}
[[8884 6969 4046]
 [6819 9052 4116]
 [5468 8177 7008]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0833207
{'0': {'precision': 0.40287015945330296, 'recall': 0.44970504475183076, 'f1-score': 0.4250012015187196, 'support': 19664}, '1': {'precision': 0.3615181461918555, 'recall': 0.4231229434639545, 'f1-score': 0.38990214544953367, 'support': 20058}, '2': {'precision': 0.453781512605042, 'recall': 0.32944228274967574, 'f1-score': 0.3817422766490398, 'support': 20817}, 'accuracy': 0.39954409554171694, 'macro avg': {'precision': 0.40605660608340016, 'recall': 0.40075675698848695, 'f1-score': 0.3988818745390977, 'support': 60539}, 'weighted avg': {'precision': 0.4066756890550744, 'recall': 0.39954409554171694, 'f1-score': 0.39849699917563736, 'support': 60539}}
[[8843 6804 4017]
 [7333 8487 4238]
 [5774 8185 6858]]
Evaluating performance on  val set...
85/85 - 1s - 882ms/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0521041
{'0': {'precision': 0.3466026080988332, 'recall': 0.44097100943066714, 'f1-score': 0.38813311813081236, 'support': 5726}, '1': {'precision': 0.5150912106135986, 'recall': 0.46697404029267314, 'f1-score': 0.4898538534328672, 'support': 9977}, '2': {'precision': 0.40018975332068313, 'recall': 0.3576394777005257, 'f1-score': 0.37772006805766994, 'support': 5897}, 'accuracy': 0.4302314814814815, 'macro avg': {'precision': 0.42062785734437164, 'recall': 0.42186150914128867, 'f1-score': 0.4185690132071165, 'support': 21600}, 'weighted avg': {'precision': 0.4390569684073084, 'recall': 0.4302314814814815, 'f1-score': 0.43227487830800126, 'support': 21600}}
[[2525 2086 1115]
 [3272 4659 2046]
 [1488 2300 2109]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0694693
{'0': {'precision': 0.3938727847231763, 'recall': 0.42848602600508146, 'f1-score': 0.41045096635647815, 'support': 6691}, '1': {'precision': 0.4092358438702584, 'recall': 0.46888384983623077, 'f1-score': 0.4370339928374332, 'support': 7938}, '2': {'precision': 0.44776119402985076, 'recall': 0.33567637354755414, 'f1-score': 0.3837009100598508, 'support': 6971}, 'accuracy': 0.41337962962962965, 'macro avg': {'precision': 0.41695660754109515, 'recall': 0.4110154164629554, 'f1-score': 0.410395289751254, 'support': 21600}, 'weighted avg': {'precision': 0.4169101951299524, 'recall': 0.41337962962962965, 'f1-score': 0.41158714328990553, 'support': 21600}}
[[2867 2528 1296]
 [2626 3722 1590]
 [1786 2845 2340]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0741545
{'0': {'precision': 0.3949659863945578, 'recall': 0.4296285333727986, 'f1-score': 0.4115687247465797, 'support': 6757}, '1': {'precision': 0.3931133428981349, 'recall': 0.4549750926044195, 'f1-score': 0.4217880402605092, 'support': 7829}, '2': {'precision': 0.4409327423395645, 'recall': 0.32620473339036216, 'f1-score': 0.3749897566172253, 'support': 7014}, 'accuracy': 0.40523148148148147, 'macro avg': {'precision': 0.40967069054408567, 'recall': 0.40360278645586006, 'f1-score': 0.4027821738747714, 'support': 21600}, 'weighted avg': {'precision': 0.4092209160364459, 'recall': 0.40523148148148147, 'f1-score': 0.40339474968636035, 'support': 21600}}
[[2903 2565 1289]
 [2655 3562 1612]
 [1792 2934 2288]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0843514
{'0': {'precision': 0.3904549626327521, 'recall': 0.4281196089706728, 'f1-score': 0.40842076390317494, 'support': 6956}, '1': {'precision': 0.35869194958555695, 'recall': 0.43126279863481226, 'f1-score': 0.39164393751549714, 'support': 7325}, '2': {'precision': 0.44889663182346107, 'recall': 0.3168465637382156, 'f1-score': 0.37148578293952744, 'support': 7319}, 'accuracy': 0.3914814814814815, 'macro avg': {'precision': 0.39934784801392337, 'recall': 0.3920763237812335, 'f1-score': 0.39051682811939986, 'support': 21600}, 'weighted avg': {'precision': 0.39948600458812683, 'recall': 0.3914814814814815, 'f1-score': 0.3902162556178658, 'support': 21600}}
[[2978 2621 1357]
 [2676 3159 1490]
 [1973 3027 2319]]
training model: results/LILAK/W2/deepVOL_L3/seq2seq
Epoch 1/50
237/237 - 15s - loss: 13.3294 - accuracy10: 0.3396 - accuracy20: 0.3441 - accuracy30: 0.3474 - accuracy50: 0.3471 - val_loss: 13.1672 - val_accuracy10: 0.3865 - val_accuracy20: 0.3537 - val_accuracy30: 0.3543 - val_accuracy50: 0.3437 - 15s/epoch - 64ms/step
Epoch 2/50
237/237 - 10s - loss: 13.2116 - accuracy10: 0.3523 - accuracy20: 0.3557 - accuracy30: 0.3544 - accuracy50: 0.3512 - val_loss: 13.1298 - val_accuracy10: 0.3851 - val_accuracy20: 0.3545 - val_accuracy30: 0.3509 - val_accuracy50: 0.3484 - 10s/epoch - 42ms/step
Epoch 3/50
237/237 - 10s - loss: 13.1441 - accuracy10: 0.3637 - accuracy20: 0.3682 - accuracy30: 0.3678 - accuracy50: 0.3653 - val_loss: 13.1528 - val_accuracy10: 0.4266 - val_accuracy20: 0.3634 - val_accuracy30: 0.3605 - val_accuracy50: 0.3504 - 10s/epoch - 42ms/step
Epoch 4/50
237/237 - 10s - loss: 13.1023 - accuracy10: 0.3696 - accuracy20: 0.3791 - accuracy30: 0.3777 - accuracy50: 0.3760 - val_loss: 13.1566 - val_accuracy10: 0.4099 - val_accuracy20: 0.3595 - val_accuracy30: 0.3525 - val_accuracy50: 0.3466 - 10s/epoch - 43ms/step
Epoch 5/50
237/237 - 10s - loss: 13.0530 - accuracy10: 0.3766 - accuracy20: 0.3888 - accuracy30: 0.3884 - accuracy50: 0.3848 - val_loss: 13.1333 - val_accuracy10: 0.3893 - val_accuracy20: 0.3512 - val_accuracy30: 0.3481 - val_accuracy50: 0.3411 - 10s/epoch - 42ms/step
Epoch 6/50
237/237 - 10s - loss: 12.9997 - accuracy10: 0.3805 - accuracy20: 0.3988 - accuracy30: 0.3990 - accuracy50: 0.3916 - val_loss: 13.1166 - val_accuracy10: 0.3666 - val_accuracy20: 0.3546 - val_accuracy30: 0.3532 - val_accuracy50: 0.3486 - 10s/epoch - 43ms/step
Epoch 7/50
237/237 - 10s - loss: 12.9362 - accuracy10: 0.3929 - accuracy20: 0.4076 - accuracy30: 0.4084 - accuracy50: 0.3991 - val_loss: 13.0192 - val_accuracy10: 0.4045 - val_accuracy20: 0.3712 - val_accuracy30: 0.3701 - val_accuracy50: 0.3588 - 10s/epoch - 42ms/step
Epoch 8/50
237/237 - 10s - loss: 12.8790 - accuracy10: 0.4010 - accuracy20: 0.4201 - accuracy30: 0.4172 - accuracy50: 0.4081 - val_loss: 12.9992 - val_accuracy10: 0.4116 - val_accuracy20: 0.3706 - val_accuracy30: 0.3696 - val_accuracy50: 0.3547 - 10s/epoch - 42ms/step
Epoch 9/50
237/237 - 10s - loss: 12.8241 - accuracy10: 0.4081 - accuracy20: 0.4229 - accuracy30: 0.4208 - accuracy50: 0.4120 - val_loss: 12.9657 - val_accuracy10: 0.4153 - val_accuracy20: 0.3763 - val_accuracy30: 0.3759 - val_accuracy50: 0.3594 - 10s/epoch - 41ms/step
Epoch 10/50
237/237 - 10s - loss: 12.7745 - accuracy10: 0.4155 - accuracy20: 0.4309 - accuracy30: 0.4294 - accuracy50: 0.4180 - val_loss: 13.0034 - val_accuracy10: 0.4159 - val_accuracy20: 0.3723 - val_accuracy30: 0.3707 - val_accuracy50: 0.3570 - 10s/epoch - 42ms/step
Epoch 11/50
237/237 - 10s - loss: 12.7205 - accuracy10: 0.4218 - accuracy20: 0.4366 - accuracy30: 0.4354 - accuracy50: 0.4241 - val_loss: 12.8887 - val_accuracy10: 0.4338 - val_accuracy20: 0.3978 - val_accuracy30: 0.3943 - val_accuracy50: 0.3803 - 10s/epoch - 41ms/step
Epoch 12/50
237/237 - 10s - loss: 12.6849 - accuracy10: 0.4269 - accuracy20: 0.4429 - accuracy30: 0.4397 - accuracy50: 0.4265 - val_loss: 12.8463 - val_accuracy10: 0.4344 - val_accuracy20: 0.4078 - val_accuracy30: 0.4043 - val_accuracy50: 0.3863 - 10s/epoch - 42ms/step
Epoch 13/50
237/237 - 10s - loss: 12.6639 - accuracy10: 0.4300 - accuracy20: 0.4456 - accuracy30: 0.4443 - accuracy50: 0.4307 - val_loss: 12.8080 - val_accuracy10: 0.4238 - val_accuracy20: 0.4170 - val_accuracy30: 0.4098 - val_accuracy50: 0.3976 - 10s/epoch - 43ms/step
Epoch 14/50
237/237 - 10s - loss: 12.6167 - accuracy10: 0.4349 - accuracy20: 0.4521 - accuracy30: 0.4480 - accuracy50: 0.4352 - val_loss: 12.7888 - val_accuracy10: 0.4318 - val_accuracy20: 0.4156 - val_accuracy30: 0.4090 - val_accuracy50: 0.4005 - 10s/epoch - 43ms/step
Epoch 15/50
237/237 - 10s - loss: 12.5956 - accuracy10: 0.4391 - accuracy20: 0.4526 - accuracy30: 0.4501 - accuracy50: 0.4323 - val_loss: 12.8174 - val_accuracy10: 0.4329 - val_accuracy20: 0.4141 - val_accuracy30: 0.4072 - val_accuracy50: 0.3919 - 10s/epoch - 42ms/step
Epoch 16/50
237/237 - 10s - loss: 12.5514 - accuracy10: 0.4466 - accuracy20: 0.4614 - accuracy30: 0.4560 - accuracy50: 0.4380 - val_loss: 12.8287 - val_accuracy10: 0.4323 - val_accuracy20: 0.4166 - val_accuracy30: 0.4065 - val_accuracy50: 0.3994 - 10s/epoch - 41ms/step
Epoch 17/50
237/237 - 10s - loss: 12.5296 - accuracy10: 0.4473 - accuracy20: 0.4614 - accuracy30: 0.4553 - accuracy50: 0.4376 - val_loss: 12.8094 - val_accuracy10: 0.4137 - val_accuracy20: 0.4104 - val_accuracy30: 0.4053 - val_accuracy50: 0.4009 - 10s/epoch - 42ms/step
Epoch 18/50
237/237 - 10s - loss: 12.4978 - accuracy10: 0.4520 - accuracy20: 0.4645 - accuracy30: 0.4579 - accuracy50: 0.4414 - val_loss: 12.8139 - val_accuracy10: 0.4245 - val_accuracy20: 0.4128 - val_accuracy30: 0.4042 - val_accuracy50: 0.3948 - 10s/epoch - 42ms/step
Epoch 19/50
237/237 - 10s - loss: 12.4782 - accuracy10: 0.4543 - accuracy20: 0.4666 - accuracy30: 0.4586 - accuracy50: 0.4414 - val_loss: 12.8426 - val_accuracy10: 0.4400 - val_accuracy20: 0.4162 - val_accuracy30: 0.4058 - val_accuracy50: 0.3952 - 10s/epoch - 41ms/step
Epoch 20/50
237/237 - 10s - loss: 12.4413 - accuracy10: 0.4559 - accuracy20: 0.4700 - accuracy30: 0.4634 - accuracy50: 0.4458 - val_loss: 12.8451 - val_accuracy10: 0.4399 - val_accuracy20: 0.4155 - val_accuracy30: 0.4071 - val_accuracy50: 0.3952 - 10s/epoch - 41ms/step
Epoch 21/50
237/237 - 10s - loss: 12.4220 - accuracy10: 0.4596 - accuracy20: 0.4737 - accuracy30: 0.4670 - accuracy50: 0.4486 - val_loss: 12.8516 - val_accuracy10: 0.4457 - val_accuracy20: 0.4161 - val_accuracy30: 0.4102 - val_accuracy50: 0.3946 - 10s/epoch - 41ms/step
Epoch 22/50
237/237 - 9s - loss: 12.3842 - accuracy10: 0.4598 - accuracy20: 0.4764 - accuracy30: 0.4694 - accuracy50: 0.4503 - val_loss: 12.8434 - val_accuracy10: 0.4380 - val_accuracy20: 0.4216 - val_accuracy30: 0.4127 - val_accuracy50: 0.3985 - 9s/epoch - 40ms/step
Epoch 23/50
237/237 - 9s - loss: 12.3434 - accuracy10: 0.4652 - accuracy20: 0.4796 - accuracy30: 0.4734 - accuracy50: 0.4546 - val_loss: 12.8790 - val_accuracy10: 0.4355 - val_accuracy20: 0.4185 - val_accuracy30: 0.4118 - val_accuracy50: 0.3977 - 9s/epoch - 39ms/step
Epoch 24/50
237/237 - 9s - loss: 12.3236 - accuracy10: 0.4686 - accuracy20: 0.4831 - accuracy30: 0.4769 - accuracy50: 0.4554 - val_loss: 12.8893 - val_accuracy10: 0.4319 - val_accuracy20: 0.4160 - val_accuracy30: 0.4100 - val_accuracy50: 0.3986 - 9s/epoch - 40ms/step
testing model: results/LILAK/W2/deepVOL_L3/seq2seq
Evaluating performance on  test set...
987/987 - 16s - 16s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0697091
{'0': {'precision': 0.3472324200383867, 'recall': 0.3850857142857143, 'f1-score': 0.36518075471953726, 'support': 70000}, '1': {'precision': 0.4896057142311475, 'recall': 0.4532571893315889, 'f1-score': 0.4707308116048476, 'support': 113119}, '2': {'precision': 0.3689035256547339, 'recall': 0.3729820110701107, 'f1-score': 0.3709315577089859, 'support': 69376}, 'accuracy': 0.4123012336877958, 'macro avg': {'precision': 0.4019138866414227, 'recall': 0.4037749715624713, 'f1-score': 0.4022810413444569, 'support': 252495}, 'weighted avg': {'precision': 0.41697074867471856, 'recall': 0.4123012336877958, 'f1-score': 0.41404779997986085, 'support': 252495}}
[[26956 25686 17358]
 [34938 51272 26909]
 [15737 27763 25876]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0856663
{'0': {'precision': 0.3825859795694552, 'recall': 0.38741234309101347, 'f1-score': 0.38498403546297155, 'support': 80142}, '1': {'precision': 0.38757312890861406, 'recall': 0.42359166574798807, 'f1-score': 0.40478272320252834, 'support': 90710}, '2': {'precision': 0.41955901498573445, 'recall': 0.3710422203985645, 'f1-score': 0.3938119535896519, 'support': 81643}, 'accuracy': 0.39511673498485117, 'macro avg': {'precision': 0.3965727078212679, 'recall': 0.3940154097458553, 'f1-score': 0.39452623741838394, 'support': 252495}, 'weighted avg': {'precision': 0.396332682858813, 'recall': 0.39511673498485117, 'f1-score': 0.3949512692080824, 'support': 252495}}
[[31048 28680 20414]
 [30791 38424 21495]
 [19314 32036 30293]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0915365
{'0': {'precision': 0.36277060410053225, 'recall': 0.38526273098273806, 'f1-score': 0.3736785169887397, 'support': 78902}, '1': {'precision': 0.36764705882352944, 'recall': 0.3925571170605323, 'f1-score': 0.37969396666286975, 'support': 89159}, '2': {'precision': 0.42852478197575544, 'recall': 0.3730369282516522, 'f1-score': 0.3988602906258904, 'support': 84434}, 'accuracy': 0.38375017327075783, 'macro avg': {'precision': 0.38631414829993904, 'recall': 0.38361892543164083, 'f1-score': 0.38407759142583325, 'support': 252495}, 'weighted avg': {'precision': 0.38648065016625355, 'recall': 0.38375017327075783, 'f1-score': 0.3842233965022942, 'support': 252495}}
[[30398 28033 20471]
 [32626 35000 21533]
 [20770 32167 31497]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0991173
{'0': {'precision': 0.35207198282978375, 'recall': 0.3808132860532156, 'f1-score': 0.3658790656633741, 'support': 78398}, '1': {'precision': 0.34854677810730655, 'recall': 0.3655581947743468, 'f1-score': 0.3568498633615812, 'support': 88410}, '2': {'precision': 0.4161553646694766, 'recall': 0.36411591023142365, 'f1-score': 0.38840027636173513, 'support': 85687}, 'accuracy': 0.36980534268005305, 'macro avg': {'precision': 0.37225804186885564, 'recall': 0.3701624636863287, 'f1-score': 0.37037640179556347, 'support': 252495}, 'weighted avg': {'precision': 0.37258505988154145, 'recall': 0.36980534268005305, 'f1-score': 0.3703603552160739, 'support': 252495}}
[[29855 27287 21256]
 [33575 32319 22516]
 [21368 33119 31200]]
Evaluating performance on  train set...
237/237 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0492074
{'0': {'precision': 0.39540134276038263, 'recall': 0.38483779563985426, 'f1-score': 0.39004806001641074, 'support': 17293}, '1': {'precision': 0.4904971044346846, 'recall': 0.49080231789367246, 'f1-score': 0.490649663698923, 'support': 25713}, '2': {'precision': 0.4027476500361533, 'recall': 0.41299264244567385, 'f1-score': 0.40780581211984684, 'support': 17533}, 'accuracy': 0.4379986455012471, 'macro avg': {'precision': 0.42954869907707355, 'recall': 0.42954425199306684, 'f1-score': 0.4295011786117269, 'support': 60539}, 'weighted avg': {'precision': 0.4379193910498723, 'recall': 0.4379986455012471, 'f1-score': 0.43791993935234264, 'support': 60539}}
[[ 6655  6367  4271]
 [ 6626 12620  6467]
 [ 3550  6742  7241]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0646443
{'0': {'precision': 0.4429407042091983, 'recall': 0.3866639967961554, 'f1-score': 0.4128935692521516, 'support': 19976}, '1': {'precision': 0.3942272110521771, 'recall': 0.479807836661162, 'f1-score': 0.43282773564463706, 'support': 19983}, '2': {'precision': 0.45340788072417465, 'recall': 0.4137512147716229, 'f1-score': 0.4326727642276423, 'support': 20580}, 'accuracy': 0.4266175523216439, 'macro avg': {'precision': 0.4301919319951833, 'recall': 0.42674101607631343, 'f1-score': 0.4261313563748103, 'support': 60539}, 'weighted avg': {'precision': 0.4304193999081933, 'recall': 0.4266175523216439, 'f1-score': 0.42619739454851646, 'support': 60539}}
[[7724 7104 5148]
 [5278 9588 5117]
 [4436 7629 8515]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0664128
{'0': {'precision': 0.43770987239758224, 'recall': 0.39303482587064675, 'f1-score': 0.41417110175550087, 'support': 19899}, '1': {'precision': 0.391468058705233, 'recall': 0.4577475358983339, 'f1-score': 0.4220213109460768, 'support': 19987}, '2': {'precision': 0.4513989637305699, 'recall': 0.42182733743281847, 'f1-score': 0.43611243210772654, 'support': 20653}, 'accuracy': 0.4242224020879103, 'macro avg': {'precision': 0.4268589649444617, 'recall': 0.4242032330672664, 'f1-score': 0.4241016149364347, 'support': 60539}, 'weighted avg': {'precision': 0.4271131607411494, 'recall': 0.4242224020879103, 'f1-score': 0.42424818308912965, 'support': 60539}}
[[7821 6819 5259]
 [5509 9149 5329]
 [4538 7403 8712]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0744561
{'0': {'precision': 0.416328572222531, 'recall': 0.3809499593165175, 'f1-score': 0.3978543165945243, 'support': 19664}, '1': {'precision': 0.37635307577224325, 'recall': 0.42641340113670356, 'f1-score': 0.3998223635003739, 'support': 20058}, '2': {'precision': 0.44318869828456103, 'recall': 0.4219628188499784, 'f1-score': 0.43231537761153627, 'support': 20817}, 'accuracy': 0.41011579312509294, 'macro avg': {'precision': 0.41195678209311176, 'recall': 0.40977539310106653, 'f1-score': 0.4099973525688115, 'support': 60539}, 'weighted avg': {'precision': 0.412319895773191, 'recall': 0.41011579312509294, 'f1-score': 0.410356191287345, 'support': 60539}}
[[7491 6799 5374]
 [5843 8553 5662]
 [4659 7374 8784]]
Evaluating performance on  val set...
85/85 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0504398
{'0': {'precision': 0.34641582873824195, 'recall': 0.37303527768075445, 'f1-score': 0.3592330978809284, 'support': 5726}, '1': {'precision': 0.513175087108014, 'recall': 0.4723864889245264, 'f1-score': 0.4919367465163614, 'support': 9977}, '2': {'precision': 0.38688, 'recall': 0.4100390028828218, 'f1-score': 0.3981229933316868, 'support': 5897}, 'accuracy': 0.4290277777777778, 'macro avg': {'precision': 0.4154903052820853, 'recall': 0.41848692316270086, 'f1-score': 0.41643094590965885, 'support': 21600}, 'weighted avg': {'precision': 0.4344887147885106, 'recall': 0.4290277777777778, 'f1-score': 0.431145968987819, 'support': 21600}}
[[2136 2184 1406]
 [2838 4713 2426]
 [1192 2287 2418]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0671958
{'0': {'precision': 0.3968472604836241, 'recall': 0.387535495441638, 'f1-score': 0.3921361058601135, 'support': 6691}, '1': {'precision': 0.4138979878334113, 'recall': 0.4457042076089695, 'f1-score': 0.42921266529176266, 'support': 7938}, '2': {'precision': 0.43571647744706965, 'recall': 0.40740209439104863, 'f1-score': 0.4210838460968197, 'support': 6971}, 'accuracy': 0.41532407407407407, 'macro avg': {'precision': 0.4154872419213684, 'recall': 0.4135472658138854, 'f1-score': 0.41414420574956523, 'support': 21600}, 'weighted avg': {'precision': 0.41565772275930885, 'recall': 0.41532407407407407, 'f1-score': 0.4151040885433779, 'support': 21600}}
[[2593 2381 1717]
 [2439 3538 1961]
 [1502 2629 2840]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0699159
{'0': {'precision': 0.39799528301886794, 'recall': 0.39958561491786293, 'f1-score': 0.39878886345173914, 'support': 6757}, '1': {'precision': 0.40439371624938636, 'recall': 0.42087112019414996, 'f1-score': 0.4124679226387933, 'support': 7829}, '2': {'precision': 0.4317636472705459, 'recall': 0.4104647847162817, 'f1-score': 0.4208449057155387, 'support': 7014}, 'accuracy': 0.41083333333333333, 'macro avg': {'precision': 0.4113842155129334, 'recall': 0.41030717327609817, 'f1-score': 0.4107005639353571, 'support': 21600}, 'weighted avg': {'precision': 0.4112797571217845, 'recall': 0.41083333333333333, 'f1-score': 0.4109089761745973, 'support': 21600}}
[[2700 2286 1771]
 [2516 3295 2018]
 [1568 2567 2879]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0775269
{'0': {'precision': 0.3952913820665601, 'recall': 0.39102932719954, 'f1-score': 0.39314880393148804, 'support': 6956}, '1': {'precision': 0.3700597280467658, 'recall': 0.39754266211604095, 'f1-score': 0.3833092010003949, 'support': 7325}, '2': {'precision': 0.43372262773722625, 'recall': 0.4059297718267523, 'f1-score': 0.4193662220340179, 'support': 7319}, 'accuracy': 0.39828703703703705, 'macro avg': {'precision': 0.399691245950184, 'recall': 0.39816725371411105, 'f1-score': 0.3986080756553003, 'support': 21600}, 'weighted avg': {'precision': 0.39975695712992176, 'recall': 0.39828703703703705, 'f1-score': 0.3986955720621435, 'support': 21600}}
[[2720 2345 1891]
 [2425 2912 1988]
 [1736 2612 2971]]
training model: results/LILAK/W3/deepLOB_L1/seq2seq
Epoch 1/50
260/260 - 12s - loss: 13.2491 - accuracy10: 0.3691 - accuracy20: 0.3623 - accuracy30: 0.3603 - accuracy50: 0.3545 - val_loss: 13.3785 - val_accuracy10: 0.3318 - val_accuracy20: 0.3406 - val_accuracy30: 0.3407 - val_accuracy50: 0.3416 - 12s/epoch - 45ms/step
Epoch 2/50
260/260 - 6s - loss: 13.1029 - accuracy10: 0.3822 - accuracy20: 0.3822 - accuracy30: 0.3811 - accuracy50: 0.3727 - val_loss: 13.2683 - val_accuracy10: 0.3755 - val_accuracy20: 0.3372 - val_accuracy30: 0.3426 - val_accuracy50: 0.3466 - 6s/epoch - 23ms/step
Epoch 3/50
260/260 - 6s - loss: 13.0627 - accuracy10: 0.3827 - accuracy20: 0.3895 - accuracy30: 0.3828 - accuracy50: 0.3729 - val_loss: 13.1494 - val_accuracy10: 0.3512 - val_accuracy20: 0.3744 - val_accuracy30: 0.3694 - val_accuracy50: 0.3633 - 6s/epoch - 22ms/step
Epoch 4/50
260/260 - 6s - loss: 13.0231 - accuracy10: 0.3889 - accuracy20: 0.3966 - accuracy30: 0.3904 - accuracy50: 0.3773 - val_loss: 13.1600 - val_accuracy10: 0.3515 - val_accuracy20: 0.3782 - val_accuracy30: 0.3719 - val_accuracy50: 0.3675 - 6s/epoch - 23ms/step
Epoch 5/50
260/260 - 6s - loss: 12.9892 - accuracy10: 0.4028 - accuracy20: 0.4078 - accuracy30: 0.4000 - accuracy50: 0.3835 - val_loss: 13.0860 - val_accuracy10: 0.3506 - val_accuracy20: 0.3881 - val_accuracy30: 0.3831 - val_accuracy50: 0.3759 - 6s/epoch - 23ms/step
Epoch 6/50
260/260 - 6s - loss: 12.9659 - accuracy10: 0.4054 - accuracy20: 0.4107 - accuracy30: 0.4023 - accuracy50: 0.3865 - val_loss: 13.0801 - val_accuracy10: 0.3594 - val_accuracy20: 0.3928 - val_accuracy30: 0.3855 - val_accuracy50: 0.3764 - 6s/epoch - 23ms/step
Epoch 7/50
260/260 - 6s - loss: 12.9398 - accuracy10: 0.4111 - accuracy20: 0.4154 - accuracy30: 0.4075 - accuracy50: 0.3915 - val_loss: 13.0950 - val_accuracy10: 0.3767 - val_accuracy20: 0.3858 - val_accuracy30: 0.3787 - val_accuracy50: 0.3727 - 6s/epoch - 22ms/step
Epoch 8/50
260/260 - 6s - loss: 12.9352 - accuracy10: 0.4169 - accuracy20: 0.4167 - accuracy30: 0.4077 - accuracy50: 0.3920 - val_loss: 13.0289 - val_accuracy10: 0.3872 - val_accuracy20: 0.4014 - val_accuracy30: 0.3912 - val_accuracy50: 0.3825 - 6s/epoch - 22ms/step
Epoch 9/50
260/260 - 6s - loss: 12.8993 - accuracy10: 0.4244 - accuracy20: 0.4220 - accuracy30: 0.4130 - accuracy50: 0.3934 - val_loss: 13.0317 - val_accuracy10: 0.3803 - val_accuracy20: 0.3936 - val_accuracy30: 0.3899 - val_accuracy50: 0.3818 - 6s/epoch - 22ms/step
Epoch 10/50
260/260 - 6s - loss: 12.8801 - accuracy10: 0.4273 - accuracy20: 0.4246 - accuracy30: 0.4157 - accuracy50: 0.3953 - val_loss: 13.0600 - val_accuracy10: 0.3924 - val_accuracy20: 0.3857 - val_accuracy30: 0.3819 - val_accuracy50: 0.3753 - 6s/epoch - 22ms/step
Epoch 11/50
260/260 - 6s - loss: 12.8783 - accuracy10: 0.4301 - accuracy20: 0.4273 - accuracy30: 0.4170 - accuracy50: 0.3942 - val_loss: 13.0164 - val_accuracy10: 0.3945 - val_accuracy20: 0.3968 - val_accuracy30: 0.3889 - val_accuracy50: 0.3800 - 6s/epoch - 22ms/step
Epoch 12/50
260/260 - 6s - loss: 12.8532 - accuracy10: 0.4327 - accuracy20: 0.4294 - accuracy30: 0.4191 - accuracy50: 0.3972 - val_loss: 13.0401 - val_accuracy10: 0.4018 - val_accuracy20: 0.3918 - val_accuracy30: 0.3852 - val_accuracy50: 0.3819 - 6s/epoch - 22ms/step
Epoch 13/50
260/260 - 6s - loss: 12.8467 - accuracy10: 0.4331 - accuracy20: 0.4296 - accuracy30: 0.4187 - accuracy50: 0.3981 - val_loss: 13.0092 - val_accuracy10: 0.3994 - val_accuracy20: 0.3991 - val_accuracy30: 0.3928 - val_accuracy50: 0.3824 - 6s/epoch - 22ms/step
Epoch 14/50
260/260 - 6s - loss: 12.8294 - accuracy10: 0.4402 - accuracy20: 0.4351 - accuracy30: 0.4235 - accuracy50: 0.4027 - val_loss: 13.0078 - val_accuracy10: 0.4117 - val_accuracy20: 0.4061 - val_accuracy30: 0.3962 - val_accuracy50: 0.3840 - 6s/epoch - 22ms/step
Epoch 15/50
260/260 - 6s - loss: 12.8024 - accuracy10: 0.4423 - accuracy20: 0.4361 - accuracy30: 0.4234 - accuracy50: 0.4013 - val_loss: 13.0176 - val_accuracy10: 0.4059 - val_accuracy20: 0.4042 - val_accuracy30: 0.3954 - val_accuracy50: 0.3852 - 6s/epoch - 21ms/step
Epoch 16/50
260/260 - 6s - loss: 12.7899 - accuracy10: 0.4435 - accuracy20: 0.4388 - accuracy30: 0.4263 - accuracy50: 0.4030 - val_loss: 13.0310 - val_accuracy10: 0.4087 - val_accuracy20: 0.4041 - val_accuracy30: 0.3925 - val_accuracy50: 0.3853 - 6s/epoch - 21ms/step
Epoch 17/50
260/260 - 6s - loss: 12.7791 - accuracy10: 0.4424 - accuracy20: 0.4394 - accuracy30: 0.4266 - accuracy50: 0.4045 - val_loss: 13.0286 - val_accuracy10: 0.4049 - val_accuracy20: 0.4003 - val_accuracy30: 0.3929 - val_accuracy50: 0.3830 - 6s/epoch - 21ms/step
Epoch 18/50
260/260 - 6s - loss: 12.7750 - accuracy10: 0.4436 - accuracy20: 0.4390 - accuracy30: 0.4275 - accuracy50: 0.4056 - val_loss: 13.0622 - val_accuracy10: 0.4027 - val_accuracy20: 0.3958 - val_accuracy30: 0.3906 - val_accuracy50: 0.3811 - 6s/epoch - 22ms/step
Epoch 19/50
260/260 - 6s - loss: 12.7677 - accuracy10: 0.4456 - accuracy20: 0.4399 - accuracy30: 0.4272 - accuracy50: 0.4046 - val_loss: 13.0065 - val_accuracy10: 0.4165 - val_accuracy20: 0.4064 - val_accuracy30: 0.4010 - val_accuracy50: 0.3874 - 6s/epoch - 22ms/step
Epoch 20/50
260/260 - 6s - loss: 12.7425 - accuracy10: 0.4490 - accuracy20: 0.4431 - accuracy30: 0.4314 - accuracy50: 0.4073 - val_loss: 13.0146 - val_accuracy10: 0.4074 - val_accuracy20: 0.4052 - val_accuracy30: 0.3979 - val_accuracy50: 0.3830 - 6s/epoch - 22ms/step
Epoch 21/50
260/260 - 6s - loss: 12.7400 - accuracy10: 0.4492 - accuracy20: 0.4442 - accuracy30: 0.4318 - accuracy50: 0.4110 - val_loss: 13.0076 - val_accuracy10: 0.3988 - val_accuracy20: 0.4074 - val_accuracy30: 0.3966 - val_accuracy50: 0.3844 - 6s/epoch - 21ms/step
Epoch 22/50
260/260 - 6s - loss: 12.7168 - accuracy10: 0.4492 - accuracy20: 0.4461 - accuracy30: 0.4323 - accuracy50: 0.4094 - val_loss: 13.0644 - val_accuracy10: 0.3950 - val_accuracy20: 0.4011 - val_accuracy30: 0.3944 - val_accuracy50: 0.3802 - 6s/epoch - 21ms/step
Epoch 23/50
260/260 - 6s - loss: 12.7159 - accuracy10: 0.4503 - accuracy20: 0.4464 - accuracy30: 0.4334 - accuracy50: 0.4080 - val_loss: 13.0447 - val_accuracy10: 0.3985 - val_accuracy20: 0.4042 - val_accuracy30: 0.3925 - val_accuracy50: 0.3785 - 6s/epoch - 21ms/step
Epoch 24/50
260/260 - 6s - loss: 12.7070 - accuracy10: 0.4493 - accuracy20: 0.4460 - accuracy30: 0.4339 - accuracy50: 0.4117 - val_loss: 13.0808 - val_accuracy10: 0.3929 - val_accuracy20: 0.3989 - val_accuracy30: 0.3888 - val_accuracy50: 0.3774 - 6s/epoch - 22ms/step
Epoch 25/50
260/260 - 6s - loss: 12.6961 - accuracy10: 0.4516 - accuracy20: 0.4453 - accuracy30: 0.4338 - accuracy50: 0.4103 - val_loss: 13.0609 - val_accuracy10: 0.4036 - val_accuracy20: 0.4043 - val_accuracy30: 0.3964 - val_accuracy50: 0.3823 - 6s/epoch - 21ms/step
Epoch 26/50
260/260 - 6s - loss: 12.6849 - accuracy10: 0.4537 - accuracy20: 0.4509 - accuracy30: 0.4376 - accuracy50: 0.4142 - val_loss: 13.0567 - val_accuracy10: 0.4086 - val_accuracy20: 0.4044 - val_accuracy30: 0.3938 - val_accuracy50: 0.3822 - 6s/epoch - 21ms/step
Epoch 27/50
260/260 - 5s - loss: 12.6680 - accuracy10: 0.4544 - accuracy20: 0.4508 - accuracy30: 0.4373 - accuracy50: 0.4158 - val_loss: 13.0627 - val_accuracy10: 0.4103 - val_accuracy20: 0.4064 - val_accuracy30: 0.3950 - val_accuracy50: 0.3824 - 5s/epoch - 21ms/step
Epoch 28/50
260/260 - 5s - loss: 12.6482 - accuracy10: 0.4538 - accuracy20: 0.4522 - accuracy30: 0.4394 - accuracy50: 0.4163 - val_loss: 13.1169 - val_accuracy10: 0.4062 - val_accuracy20: 0.4001 - val_accuracy30: 0.3909 - val_accuracy50: 0.3764 - 5s/epoch - 21ms/step
Epoch 29/50
260/260 - 6s - loss: 12.6518 - accuracy10: 0.4550 - accuracy20: 0.4523 - accuracy30: 0.4386 - accuracy50: 0.4150 - val_loss: 13.1540 - val_accuracy10: 0.3856 - val_accuracy20: 0.3989 - val_accuracy30: 0.3891 - val_accuracy50: 0.3773 - 6s/epoch - 22ms/step
testing model: results/LILAK/W3/deepLOB_L1/seq2seq
Evaluating performance on  test set...
678/678 - 7s - 7s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0603304
{'0': {'precision': 0.39961640283105515, 'recall': 0.30365793579111583, 'f1-score': 0.3450906291552943, 'support': 48716}, '1': {'precision': 0.4915627970846097, 'recall': 0.4951125769686008, 'f1-score': 0.49333130147287796, 'support': 75193}, '2': {'precision': 0.3801576569148059, 'recall': 0.465856960976497, 'f1-score': 0.4186667393140273, 'support': 49483}, 'accuracy': 0.4329726861677586, 'macro avg': {'precision': 0.4237789522768236, 'recall': 0.4215424912454046, 'f1-score': 0.4190295566473998, 'support': 173392}, 'weighted avg': {'precision': 0.433936602718788, 'recall': 0.4329726861677586, 'f1-score': 0.4303738459851403, 'support': 173392}}
[[14793 19612 14311]
 [14689 37229 23275]
 [ 7536 18895 23052]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0765123
{'0': {'precision': 0.4596223068496009, 'recall': 0.29855475169854795, 'f1-score': 0.3619798888649226, 'support': 59021}, '1': {'precision': 0.3731110101124872, 'recall': 0.47387978930658775, 'f1-score': 0.4175010330250151, 'support': 55436}, '2': {'precision': 0.4289824583114191, 'recall': 0.47055230338508525, 'f1-score': 0.4488068554227591, 'support': 58935}, 'accuracy': 0.41306980714219804, 'macro avg': {'precision': 0.4205719250911691, 'recall': 0.41432894813007365, 'f1-score': 0.4094292591042323, 'support': 173392}, 'weighted avg': {'precision': 0.4215490409577698, 'recall': 0.41306980714219804, 'f1-score': 0.4092428388380758, 'support': 173392}}
[[17621 22614 18786]
 [11038 26270 18128]
 [ 9679 21524 27732]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0808611
{'0': {'precision': 0.4374145526355765, 'recall': 0.2947991673207521, 'f1-score': 0.35221805430971215, 'support': 58606}, '1': {'precision': 0.37588158731119653, 'recall': 0.4370611526616806, 'f1-score': 0.4041692772113687, 'support': 56825}, '2': {'precision': 0.41206133883810087, 'recall': 0.48215179172202, 'f1-score': 0.4443596409632616, 'support': 57961}, 'accuracy': 0.40404978315031836, 'macro avg': {'precision': 0.40845249292829133, 'recall': 0.40467070390148424, 'f1-score': 0.40024899082811416, 'support': 173392}, 'weighted avg': {'precision': 0.40877362122309274, 'recall': 0.40404978315031836, 'f1-score': 0.40004463653618744, 'support': 173392}}
[[17277 21271 20058]
 [12173 24836 19816]
 [10048 19967 27946]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0860714
{'0': {'precision': 0.4068251341457299, 'recall': 0.2841754969787197, 'f1-score': 0.3346154242758592, 'support': 57095}, '1': {'precision': 0.3836194012239825, 'recall': 0.409292332482879, 'f1-score': 0.39604024720031833, 'support': 59576}, '2': {'precision': 0.39229702489027407, 'recall': 0.4837714426755523, 'f1-score': 0.43325859727792343, 'support': 56721}, 'accuracy': 0.3924575528282735, 'macro avg': {'precision': 0.3942471867533288, 'recall': 0.39241309071238367, 'f1-score': 0.3879714229180337, 'support': 173392}, 'weighted avg': {'precision': 0.3940993242489369, 'recall': 0.3924575528282735, 'f1-score': 0.3879891939215041, 'support': 173392}}
[[16225 20193 20677]
 [13362 24384 21830]
 [10295 18986 27440]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0588161
{'0': {'precision': 0.39108388975350167, 'recall': 0.41004316243815137, 'f1-score': 0.4003391833902922, 'support': 18998}, '1': {'precision': 0.522415407793477, 'recall': 0.4446215691710563, 'f1-score': 0.4803894037255452, 'support': 28856}, '2': {'precision': 0.36657361219166174, 'recall': 0.4335588633288227, 'f1-score': 0.3972623121559292, 'support': 18475}, 'accuracy': 0.4316362375431561, 'macro avg': {'precision': 0.4266909699128802, 'recall': 0.4294078649793434, 'f1-score': 0.42599696642392226, 'support': 66329}, 'weighted avg': {'precision': 0.4413918230346688, 'recall': 0.4316362375431561, 'f1-score': 0.4343074923040283, 'support': 66329}}
[[ 7790  5957  5251]
 [ 7436 12830  8590]
 [ 4693  5772  8010]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0729452
{'0': {'precision': 0.43594787312515365, 'recall': 0.3915981977206467, 'f1-score': 0.41258464617317847, 'support': 22638}, '1': {'precision': 0.40152685230131063, 'recall': 0.42512731860019626, 'f1-score': 0.41299019607843135, 'support': 21403}, '2': {'precision': 0.42322033171902457, 'recall': 0.4430635319454415, 'f1-score': 0.43291466649130883, 'support': 22288}, 'accuracy': 0.4197108353812058, 'macro avg': {'precision': 0.42023168571516295, 'recall': 0.41992968275542814, 'f1-score': 0.41949650291430624, 'support': 66329}, 'weighted avg': {'precision': 0.4205641864790032, 'recall': 0.4197108353812058, 'f1-score': 0.41954684185640323, 'support': 66329}}
[[8865 6942 6831]
 [5677 9099 6627]
 [5793 6620 9875]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0785964
{'0': {'precision': 0.4182634297022057, 'recall': 0.38765376873182733, 'f1-score': 0.40237730417421186, 'support': 22355}, '1': {'precision': 0.3982906790065162, 'recall': 0.3853533738407419, 'f1-score': 0.3917152344022105, 'support': 21889}, '2': {'precision': 0.4108955468238376, 'recall': 0.4545619198551053, 'f1-score': 0.43162714706451405, 'support': 22085}, 'accuracy': 0.4091724585023142, 'macro avg': {'precision': 0.4091498851775199, 'recall': 0.4091896874758915, 'f1-score': 0.4085732285469788, 'support': 66329}, 'weighted avg': {'precision': 0.4092190715278521, 'recall': 0.4091724585023142, 'f1-score': 0.4085978221225148, 'support': 66329}}
[[ 8666  6511  7178]
 [ 6239  8435  7215]
 [ 5814  6232 10039]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0874224
{'0': {'precision': 0.402402113860197, 'recall': 0.37476510067114094, 'f1-score': 0.3880922043322136, 'support': 22350}, '1': {'precision': 0.37613726265822783, 'recall': 0.35246965063478825, 'f1-score': 0.3639190546811462, 'support': 21582}, '2': {'precision': 0.39786476868327403, 'recall': 0.44925659686565167, 'f1-score': 0.4220018034265104, 'support': 22397}, 'accuracy': 0.3926638423615613, 'macro avg': {'precision': 0.39213471506723296, 'recall': 0.39216378272386027, 'f1-score': 0.39133768747995673, 'support': 66329}, 'weighted avg': {'precision': 0.39232400415601876, 'recall': 0.3926638423615613, 'f1-score': 0.3916768863739393, 'support': 66329}}
[[ 8376  6374  7600]
 [ 6347  7607  7628]
 [ 6092  6243 10062]]
Evaluating performance on  val set...
86/86 - 1s - 735ms/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0729215
{'0': {'precision': 0.40419278996865204, 'recall': 0.32234375, 'f1-score': 0.35865785813630036, 'support': 6400}, '1': {'precision': 0.4980586423885393, 'recall': 0.3998280309544282, 'f1-score': 0.4435700232516544, 'support': 9304}, '2': {'precision': 0.3533810490332229, 'recall': 0.5309791332263243, 'f1-score': 0.42434737989865945, 'support': 6230}, 'accuracy': 0.4144706847816176, 'macro avg': {'precision': 0.4185441604634714, 'recall': 0.41771697139358416, 'f1-score': 0.4088584204288714, 'support': 21934}, 'weighted avg': {'precision': 0.4295767028384846, 'recall': 0.4144706847816176, 'f1-score': 0.41333409160091017, 'support': 21934}}
[[2063 1959 2378]
 [1909 3720 3675]
 [1132 1790 3308]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0825443
{'0': {'precision': 0.4575729068673565, 'recall': 0.31720359984348506, 'f1-score': 0.3746726236327222, 'support': 7667}, '1': {'precision': 0.3737264587835752, 'recall': 0.354154476301931, 'f1-score': 0.3636773321315908, 'support': 6836}, '2': {'precision': 0.3971994872300562, 'recall': 0.5420535594132687, 'f1-score': 0.45845663555656724, 'support': 7431}, 'accuracy': 0.40489650770493296, 'macro avg': {'precision': 0.409499617626996, 'recall': 0.40447054518622827, 'f1-score': 0.39893553044029345, 'support': 21934}, 'weighted avg': {'precision': 0.41098727723183603, 'recall': 0.40489650770493296, 'f1-score': 0.39963091577753657, 'support': 21934}}
[[2432 2096 3139]
 [1441 2421 2974]
 [1442 1961 4028]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0859699
{'0': {'precision': 0.44278331487633815, 'recall': 0.31678330912452135, 'f1-score': 0.3693326148872296, 'support': 7573}, '1': {'precision': 0.3777893098079917, 'recall': 0.31137724550898205, 'f1-score': 0.3413833528722157, 'support': 7014}, '2': {'precision': 0.38928737773637634, 'recall': 0.5688035933033891, 'f1-score': 0.46222762968698156, 'support': 7347}, 'accuracy': 0.3994711406948117, 'macro avg': {'precision': 0.4032866674735687, 'recall': 0.3989880493122975, 'f1-score': 0.39098119914880897, 'support': 21934}, 'weighted avg': {'precision': 0.4040807252111297, 'recall': 0.3994711406948117, 'f1-score': 0.3915111299761541, 'support': 21934}}
[[2399 1872 3302]
 [1576 2184 3254]
 [1443 1725 4179]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.091696
{'0': {'precision': 0.41790225151015925, 'recall': 0.30492854280753307, 'f1-score': 0.35258687258687255, 'support': 7487}, '1': {'precision': 0.36309189593861124, 'recall': 0.2698191933240612, 'f1-score': 0.30958270166759755, 'support': 7190}, '2': {'precision': 0.37634795111430625, 'recall': 0.5770979743695742, 'f1-score': 0.4555887952134893, 'support': 7257}, 'accuracy': 0.3834685875809246, 'macro avg': {'precision': 0.38578069952102556, 'recall': 0.38394857016705614, 'f1-score': 0.37258612315598644, 'support': 21934}, 'weighted avg': {'precision': 0.3861868318633946, 'recall': 0.3834685875809246, 'f1-score': 0.3725688623558052, 'support': 21934}}
[[2283 1781 3423]
 [1733 1940 3517]
 [1447 1622 4188]]
training model: results/LILAK/W3/deepOF_L1/seq2seq
Epoch 1/50
260/260 - 10s - loss: 13.1718 - accuracy10: 0.3970 - accuracy20: 0.3777 - accuracy30: 0.3683 - accuracy50: 0.3587 - val_loss: 13.1504 - val_accuracy10: 0.4208 - val_accuracy20: 0.3772 - val_accuracy30: 0.3688 - val_accuracy50: 0.3576 - 10s/epoch - 40ms/step
Epoch 2/50
260/260 - 5s - loss: 13.0996 - accuracy10: 0.4091 - accuracy20: 0.3885 - accuracy30: 0.3792 - accuracy50: 0.3667 - val_loss: 13.1224 - val_accuracy10: 0.4180 - val_accuracy20: 0.3797 - val_accuracy30: 0.3686 - val_accuracy50: 0.3567 - 5s/epoch - 21ms/step
Epoch 3/50
260/260 - 5s - loss: 13.0616 - accuracy10: 0.4108 - accuracy20: 0.3935 - accuracy30: 0.3830 - accuracy50: 0.3729 - val_loss: 13.0988 - val_accuracy10: 0.4177 - val_accuracy20: 0.3810 - val_accuracy30: 0.3719 - val_accuracy50: 0.3599 - 5s/epoch - 20ms/step
Epoch 4/50
260/260 - 5s - loss: 13.0442 - accuracy10: 0.4126 - accuracy20: 0.3983 - accuracy30: 0.3872 - accuracy50: 0.3773 - val_loss: 13.0941 - val_accuracy10: 0.4166 - val_accuracy20: 0.3812 - val_accuracy30: 0.3749 - val_accuracy50: 0.3614 - 5s/epoch - 20ms/step
Epoch 5/50
260/260 - 5s - loss: 13.0220 - accuracy10: 0.4194 - accuracy20: 0.4001 - accuracy30: 0.3901 - accuracy50: 0.3790 - val_loss: 13.0878 - val_accuracy10: 0.4141 - val_accuracy20: 0.3886 - val_accuracy30: 0.3773 - val_accuracy50: 0.3656 - 5s/epoch - 20ms/step
Epoch 6/50
260/260 - 5s - loss: 13.0076 - accuracy10: 0.4183 - accuracy20: 0.4027 - accuracy30: 0.3927 - accuracy50: 0.3817 - val_loss: 13.0870 - val_accuracy10: 0.4145 - val_accuracy20: 0.3852 - val_accuracy30: 0.3730 - val_accuracy50: 0.3628 - 5s/epoch - 20ms/step
Epoch 7/50
260/260 - 5s - loss: 12.9924 - accuracy10: 0.4205 - accuracy20: 0.4049 - accuracy30: 0.3928 - accuracy50: 0.3851 - val_loss: 13.0858 - val_accuracy10: 0.4141 - val_accuracy20: 0.3854 - val_accuracy30: 0.3776 - val_accuracy50: 0.3683 - 5s/epoch - 20ms/step
Epoch 8/50
260/260 - 5s - loss: 12.9756 - accuracy10: 0.4236 - accuracy20: 0.4068 - accuracy30: 0.3977 - accuracy50: 0.3877 - val_loss: 13.0729 - val_accuracy10: 0.4146 - val_accuracy20: 0.3853 - val_accuracy30: 0.3810 - val_accuracy50: 0.3701 - 5s/epoch - 20ms/step
Epoch 9/50
260/260 - 5s - loss: 12.9617 - accuracy10: 0.4261 - accuracy20: 0.4080 - accuracy30: 0.3979 - accuracy50: 0.3892 - val_loss: 13.0789 - val_accuracy10: 0.4108 - val_accuracy20: 0.3872 - val_accuracy30: 0.3815 - val_accuracy50: 0.3684 - 5s/epoch - 20ms/step
Epoch 10/50
260/260 - 5s - loss: 12.9498 - accuracy10: 0.4274 - accuracy20: 0.4126 - accuracy30: 0.4038 - accuracy50: 0.3933 - val_loss: 13.0769 - val_accuracy10: 0.4166 - val_accuracy20: 0.3878 - val_accuracy30: 0.3800 - val_accuracy50: 0.3663 - 5s/epoch - 20ms/step
Epoch 11/50
260/260 - 5s - loss: 12.9292 - accuracy10: 0.4302 - accuracy20: 0.4161 - accuracy30: 0.4062 - accuracy50: 0.3954 - val_loss: 13.0872 - val_accuracy10: 0.4184 - val_accuracy20: 0.3858 - val_accuracy30: 0.3793 - val_accuracy50: 0.3691 - 5s/epoch - 20ms/step
Epoch 12/50
260/260 - 5s - loss: 12.9141 - accuracy10: 0.4312 - accuracy20: 0.4161 - accuracy30: 0.4077 - accuracy50: 0.3980 - val_loss: 13.0889 - val_accuracy10: 0.4187 - val_accuracy20: 0.3861 - val_accuracy30: 0.3769 - val_accuracy50: 0.3651 - 5s/epoch - 20ms/step
Epoch 13/50
260/260 - 5s - loss: 12.9042 - accuracy10: 0.4311 - accuracy20: 0.4180 - accuracy30: 0.4071 - accuracy50: 0.3973 - val_loss: 13.0974 - val_accuracy10: 0.4154 - val_accuracy20: 0.3893 - val_accuracy30: 0.3780 - val_accuracy50: 0.3672 - 5s/epoch - 20ms/step
Epoch 14/50
260/260 - 5s - loss: 12.8939 - accuracy10: 0.4341 - accuracy20: 0.4194 - accuracy30: 0.4109 - accuracy50: 0.4026 - val_loss: 13.1106 - val_accuracy10: 0.4169 - val_accuracy20: 0.3912 - val_accuracy30: 0.3811 - val_accuracy50: 0.3698 - 5s/epoch - 20ms/step
Epoch 15/50
260/260 - 5s - loss: 12.8865 - accuracy10: 0.4326 - accuracy20: 0.4211 - accuracy30: 0.4112 - accuracy50: 0.4032 - val_loss: 13.1002 - val_accuracy10: 0.4171 - val_accuracy20: 0.3943 - val_accuracy30: 0.3831 - val_accuracy50: 0.3668 - 5s/epoch - 20ms/step
Epoch 16/50
260/260 - 5s - loss: 12.8629 - accuracy10: 0.4369 - accuracy20: 0.4226 - accuracy30: 0.4142 - accuracy50: 0.4038 - val_loss: 13.1123 - val_accuracy10: 0.4176 - val_accuracy20: 0.3942 - val_accuracy30: 0.3825 - val_accuracy50: 0.3703 - 5s/epoch - 21ms/step
Epoch 17/50
260/260 - 5s - loss: 12.8456 - accuracy10: 0.4386 - accuracy20: 0.4270 - accuracy30: 0.4172 - accuracy50: 0.4082 - val_loss: 13.0995 - val_accuracy10: 0.4193 - val_accuracy20: 0.3928 - val_accuracy30: 0.3831 - val_accuracy50: 0.3703 - 5s/epoch - 21ms/step
Epoch 18/50
260/260 - 5s - loss: 12.8274 - accuracy10: 0.4404 - accuracy20: 0.4270 - accuracy30: 0.4179 - accuracy50: 0.4087 - val_loss: 13.1214 - val_accuracy10: 0.4164 - val_accuracy20: 0.3916 - val_accuracy30: 0.3785 - val_accuracy50: 0.3686 - 5s/epoch - 20ms/step
testing model: results/LILAK/W3/deepOF_L1/seq2seq
Evaluating performance on  test set...
678/678 - 7s - 7s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0814801
{'0': {'precision': 0.3347708033860406, 'recall': 0.2581545725135995, 'f1-score': 0.29151261575549664, 'support': 48715}, '1': {'precision': 0.5153231922201901, 'recall': 0.46089396619366163, 'f1-score': 0.4865912218134846, 'support': 75193}, '2': {'precision': 0.32627495588514094, 'recall': 0.45216248989490704, 'f1-score': 0.3790395676444926, 'support': 49480}, 'accuracy': 0.4014406994717051, 'macro avg': {'precision': 0.3921229838304572, 'recall': 0.39040367620072275, 'f1-score': 0.3857144684044913, 'support': 173388}, 'weighted avg': {'precision': 0.41064630364708343, 'recall': 0.4014406994717051, 'f1-score': 0.4010898598830361, 'support': 173388}}
[[12576 16273 19866]
 [14205 34656 26332]
 [10785 16322 22373]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0903572
{'0': {'precision': 0.38532736307541093, 'recall': 0.23911827993426069, 'f1-score': 0.29510596254979243, 'support': 59021}, '1': {'precision': 0.3875936450529579, 'recall': 0.4330399018688217, 'f1-score': 0.409058378488907, 'support': 55436}, '2': {'precision': 0.37056638066982067, 'recall': 0.47051636659822504, 'f1-score': 0.41460260023774453, 'support': 58931}, 'accuracy': 0.3797667658661499, 'macro avg': {'precision': 0.3811624629327299, 'recall': 0.38089151613376915, 'f1-score': 0.3729223137588147, 'support': 173388}, 'weighted avg': {'precision': 0.3810349907864604, 'recall': 0.3797667658661499, 'f1-score': 0.37215352342822383, 'support': 173388}}
[[14113 19243 25665]
 [ 9997 24006 21433]
 [12516 18687 27728]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0958579
{'0': {'precision': 0.3772641434156981, 'recall': 0.24202300105791216, 'f1-score': 0.29487645915408045, 'support': 58606}, '1': {'precision': 0.38100833155308694, 'recall': 0.3766366324088413, 'f1-score': 0.3788098693759071, 'support': 56824}, '2': {'precision': 0.35678669664276114, 'recall': 0.4901307843610891, 'f1-score': 0.4129614688501712, 'support': 57958}, 'accuracy': 0.36907398435877914, 'macro avg': {'precision': 0.37168639053718205, 'recall': 0.3695968059426142, 'f1-score': 0.3622159324600529, 'support': 173388}, 'weighted avg': {'precision': 0.3716462683992789, 'recall': 0.36907398435877914, 'f1-score': 0.3618557373879323, 'support': 173388}}
[[14184 17582 26840]
 [11050 21402 24372]
 [12363 17188 28407]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0989429
{'0': {'precision': 0.3598754791736345, 'recall': 0.2449951834661529, 'f1-score': 0.29152598891250886, 'support': 57095}, '1': {'precision': 0.36707957088832294, 'recall': 0.31934536298783045, 'f1-score': 0.3415527409495256, 'support': 59575}, '2': {'precision': 0.3448501046063054, 'recall': 0.5027680806798547, 'f1-score': 0.4090984082806705, 'support': 56718}, 'accuracy': 0.3548630816434817, 'macro avg': {'precision': 0.357268384889421, 'recall': 0.3557028757112793, 'f1-score': 0.3473923793809017, 'support': 173388}, 'weighted avg': {'precision': 0.35743571730541285, 'recall': 0.3548630816434817, 'f1-score': 0.3471746856754259, 'support': 173388}}
[[13988 16850 26257]
 [12632 19025 27918]
 [12249 15953 28516]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0663145
{'0': {'precision': 0.36907486106570775, 'recall': 0.29743400600663894, 'f1-score': 0.32940421310614465, 'support': 18979}, '1': {'precision': 0.5378329852332271, 'recall': 0.508557965490957, 'f1-score': 0.5227859597884353, 'support': 28862}, '2': {'precision': 0.3458152563076534, 'recall': 0.4441198744996213, 'f1-score': 0.3888507353115305, 'support': 18486}, 'accuracy': 0.43018680175494145, 'macro avg': {'precision': 0.4175743675355294, 'recall': 0.41670394866573907, 'f1-score': 0.41368030273537015, 'support': 66327}, 'weighted avg': {'precision': 0.43602677998508527, 'recall': 0.43018680175494145, 'f1-score': 0.43012205625046046, 'support': 66327}}
[[ 5645  6404  6930]
 [ 5583 14678  8601]
 [ 4067  6209  8210]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0785422
{'0': {'precision': 0.4291763149189547, 'recall': 0.28609861515392077, 'f1-score': 0.34332742332424776, 'support': 22674}, '1': {'precision': 0.4077716098334655, 'recall': 0.47988800746616894, 'f1-score': 0.4409003215434083, 'support': 21430}, '2': {'precision': 0.3971606648199446, 'recall': 0.46451874184403547, 'f1-score': 0.42820698952608105, 'support': 22223}, 'accuracy': 0.4084912629849081, 'macro avg': {'precision': 0.4113695298574549, 'recall': 0.4101684548213751, 'f1-score': 0.404144911464579, 'support': 66327}, 'weighted avg': {'precision': 0.4115336260873727, 'recall': 0.4084912629849081, 'f1-score': 0.4032919296118825, 'support': 66327}}
[[ 6487  7567  8620]
 [ 4097 10284  7049]
 [ 4531  7369 10323]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0838306
{'0': {'precision': 0.41945701357466064, 'recall': 0.29045253122062575, 'f1-score': 0.3432334505831637, 'support': 22341}, '1': {'precision': 0.3975694444444444, 'recall': 0.4184750331216593, 'f1-score': 0.4077544570322063, 'support': 21889}, '2': {'precision': 0.38692166660675126, 'recall': 0.48707969407611895, 'f1-score': 0.4312617702448211, 'support': 22097}, 'accuracy': 0.39820887421412093, 'macro avg': {'precision': 0.4013160415419521, 'recall': 0.39866908613946794, 'f1-score': 0.39408322595339706, 'support': 66327}, 'weighted avg': {'precision': 0.4013945267647462, 'recall': 0.39820887421412093, 'f1-score': 0.3938532900109493, 'support': 66327}}
[[ 6489  6989  8863]
 [ 4538  9160  8191]
 [ 4443  6891 10763]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0872715
{'0': {'precision': 0.41745268286588794, 'recall': 0.2992432722876461, 'f1-score': 0.3485994470815294, 'support': 22333}, '1': {'precision': 0.3713012895662368, 'recall': 0.3646999216986781, 'f1-score': 0.3679710010223998, 'support': 21711}, '2': {'precision': 0.3920946435346463, 'recall': 0.5101646995467397, 'f1-score': 0.44340432170996175, 'support': 22283}, 'accuracy': 0.39152984455802314, 'macro avg': {'precision': 0.393616205322257, 'recall': 0.3913692978443546, 'f1-score': 0.3866582566046303, 'support': 66327}, 'weighted avg': {'precision': 0.39382661670358926, 'recall': 0.39152984455802314, 'f1-score': 0.38679072407213044, 'support': 66327}}
[[ 6683  6852  8798]
 [ 4966  7918  8827]
 [ 4360  6555 11368]]
Evaluating performance on  val set...
86/86 - 1s - 672ms/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0722123
{'0': {'precision': 0.352991636285653, 'recall': 0.25582841156356856, 'f1-score': 0.2966567540776786, 'support': 6434}, '1': {'precision': 0.5197270206867136, 'recall': 0.5224568549683781, 'f1-score': 0.5210883626449992, 'support': 9329}, '2': {'precision': 0.3320663879386798, 'recall': 0.42472856911359586, 'f1-score': 0.37272468714448237, 'support': 6171}, 'accuracy': 0.41675025075225675, 'macro avg': {'precision': 0.40159501497034883, 'recall': 0.4010046118818475, 'f1-score': 0.39682326795572004, 'support': 21934}, 'weighted avg': {'precision': 0.418020572801032, 'recall': 0.41675025075225675, 'f1-score': 0.4135135832597603, 'support': 21934}}
[[1646 2309 2479]
 [1662 4874 2793]
 [1355 2195 2621]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0873187
{'0': {'precision': 0.3989558407657168, 'recall': 0.23920699100039128, 'f1-score': 0.2990867579908676, 'support': 7667}, '1': {'precision': 0.39103077451092555, 'recall': 0.49978066968855095, 'f1-score': 0.43876765083440306, 'support': 6839}, '2': {'precision': 0.3765704979060028, 'recall': 0.43578352180936997, 'f1-score': 0.40401897154268596, 'support': 7428}, 'accuracy': 0.3870247104951217, 'macro avg': {'precision': 0.3888523710608817, 'recall': 0.3915903941661041, 'f1-score': 0.3806244601226522, 'support': 21934}, 'weighted avg': {'precision': 0.3889039644605069, 'recall': 0.3870247104951217, 'f1-score': 0.37817466299769925, 'support': 21934}}
[[1834 2713 3120]
 [1182 3418 2239]
 [1581 2610 3237]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0926307
{'0': {'precision': 0.3952070632751734, 'recall': 0.24841437632135308, 'f1-score': 0.3050709939148073, 'support': 7568}, '1': {'precision': 0.3813443072702332, 'recall': 0.436794743608056, 'f1-score': 0.4071904127829561, 'support': 7001}, '2': {'precision': 0.3707141297226469, 'recall': 0.4609640190088255, 'f1-score': 0.4109423228227319, 'support': 7365}, 'accuracy': 0.37991246466672746, 'macro avg': {'precision': 0.3824218334226845, 'recall': 0.38205771297941155, 'f1-score': 0.37440124317349843, 'support': 21934}, 'weighted avg': {'precision': 0.3825580430141656, 'recall': 0.37991246466672746, 'f1-score': 0.3732154449452976, 'support': 21934}}
[[1880 2519 3169]
 [1349 3058 2594]
 [1528 2442 3395]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0969605
{'0': {'precision': 0.3900020238818053, 'recall': 0.25720768820074746, 'f1-score': 0.30998150084452664, 'support': 7492}, '1': {'precision': 0.3652, 'recall': 0.38200836820083683, 'f1-score': 0.3734151329243354, 'support': 7170}, '2': {'precision': 0.35541978299799853, 'recall': 0.46397139713971397, 'f1-score': 0.4025052192066806, 'support': 7272}, 'accuracy': 0.3665542080787818, 'macro avg': {'precision': 0.37020726895993467, 'recall': 0.36772915118043276, 'f1-score': 0.3619672843251809, 'support': 21934}, 'weighted avg': {'precision': 0.3704290975145405, 'recall': 0.3665542080787818, 'f1-score': 0.36139262612681955, 'support': 21934}}
[[1927 2387 3178]
 [1490 2739 2941]
 [1524 2374 3374]]
training model: results/LILAK/W3/deepLOB_L2/seq2seq
Epoch 1/50
260/260 - 18s - loss: 13.3346 - accuracy10: 0.3477 - accuracy20: 0.3486 - accuracy30: 0.3448 - accuracy50: 0.3403 - val_loss: 13.3356 - val_accuracy10: 0.3573 - val_accuracy20: 0.3366 - val_accuracy30: 0.3402 - val_accuracy50: 0.3380 - 18s/epoch - 67ms/step
Epoch 2/50
260/260 - 12s - loss: 13.1983 - accuracy10: 0.3660 - accuracy20: 0.3568 - accuracy30: 0.3550 - accuracy50: 0.3474 - val_loss: 13.2278 - val_accuracy10: 0.3945 - val_accuracy20: 0.3449 - val_accuracy30: 0.3489 - val_accuracy50: 0.3449 - 12s/epoch - 47ms/step
Epoch 3/50
260/260 - 12s - loss: 13.1131 - accuracy10: 0.3830 - accuracy20: 0.3778 - accuracy30: 0.3713 - accuracy50: 0.3623 - val_loss: 13.1770 - val_accuracy10: 0.3687 - val_accuracy20: 0.3646 - val_accuracy30: 0.3654 - val_accuracy50: 0.3588 - 12s/epoch - 47ms/step
Epoch 4/50
260/260 - 12s - loss: 13.0595 - accuracy10: 0.3881 - accuracy20: 0.3911 - accuracy30: 0.3834 - accuracy50: 0.3741 - val_loss: 13.1656 - val_accuracy10: 0.3745 - val_accuracy20: 0.3738 - val_accuracy30: 0.3692 - val_accuracy50: 0.3650 - 12s/epoch - 47ms/step
Epoch 5/50
260/260 - 12s - loss: 12.9928 - accuracy10: 0.3978 - accuracy20: 0.4017 - accuracy30: 0.3948 - accuracy50: 0.3851 - val_loss: 13.1339 - val_accuracy10: 0.3715 - val_accuracy20: 0.3792 - val_accuracy30: 0.3754 - val_accuracy50: 0.3692 - 12s/epoch - 47ms/step
Epoch 6/50
260/260 - 12s - loss: 12.9403 - accuracy10: 0.4053 - accuracy20: 0.4113 - accuracy30: 0.4019 - accuracy50: 0.3909 - val_loss: 13.1022 - val_accuracy10: 0.3687 - val_accuracy20: 0.3842 - val_accuracy30: 0.3805 - val_accuracy50: 0.3738 - 12s/epoch - 46ms/step
Epoch 7/50
260/260 - 12s - loss: 12.8856 - accuracy10: 0.4171 - accuracy20: 0.4216 - accuracy30: 0.4125 - accuracy50: 0.4003 - val_loss: 13.1165 - val_accuracy10: 0.3729 - val_accuracy20: 0.3863 - val_accuracy30: 0.3792 - val_accuracy50: 0.3729 - 12s/epoch - 46ms/step
Epoch 8/50
260/260 - 12s - loss: 12.8453 - accuracy10: 0.4220 - accuracy20: 0.4262 - accuracy30: 0.4192 - accuracy50: 0.4042 - val_loss: 13.0992 - val_accuracy10: 0.3827 - val_accuracy20: 0.3876 - val_accuracy30: 0.3842 - val_accuracy50: 0.3773 - 12s/epoch - 47ms/step
Epoch 9/50
260/260 - 12s - loss: 12.8026 - accuracy10: 0.4295 - accuracy20: 0.4336 - accuracy30: 0.4249 - accuracy50: 0.4100 - val_loss: 13.1089 - val_accuracy10: 0.3982 - val_accuracy20: 0.3836 - val_accuracy30: 0.3835 - val_accuracy50: 0.3759 - 12s/epoch - 46ms/step
Epoch 10/50
260/260 - 12s - loss: 12.7608 - accuracy10: 0.4332 - accuracy20: 0.4368 - accuracy30: 0.4294 - accuracy50: 0.4132 - val_loss: 13.1432 - val_accuracy10: 0.3932 - val_accuracy20: 0.3829 - val_accuracy30: 0.3805 - val_accuracy50: 0.3738 - 12s/epoch - 46ms/step
Epoch 11/50
260/260 - 12s - loss: 12.7169 - accuracy10: 0.4377 - accuracy20: 0.4439 - accuracy30: 0.4360 - accuracy50: 0.4189 - val_loss: 13.1775 - val_accuracy10: 0.3888 - val_accuracy20: 0.3824 - val_accuracy30: 0.3791 - val_accuracy50: 0.3736 - 12s/epoch - 46ms/step
Epoch 12/50
260/260 - 12s - loss: 12.6732 - accuracy10: 0.4429 - accuracy20: 0.4488 - accuracy30: 0.4403 - accuracy50: 0.4235 - val_loss: 13.1576 - val_accuracy10: 0.3905 - val_accuracy20: 0.3934 - val_accuracy30: 0.3869 - val_accuracy50: 0.3802 - 12s/epoch - 46ms/step
Epoch 13/50
260/260 - 12s - loss: 12.6156 - accuracy10: 0.4475 - accuracy20: 0.4541 - accuracy30: 0.4461 - accuracy50: 0.4287 - val_loss: 13.2116 - val_accuracy10: 0.3916 - val_accuracy20: 0.3914 - val_accuracy30: 0.3885 - val_accuracy50: 0.3798 - 12s/epoch - 46ms/step
Epoch 14/50
260/260 - 12s - loss: 12.5797 - accuracy10: 0.4508 - accuracy20: 0.4596 - accuracy30: 0.4507 - accuracy50: 0.4328 - val_loss: 13.2573 - val_accuracy10: 0.3817 - val_accuracy20: 0.3887 - val_accuracy30: 0.3855 - val_accuracy50: 0.3744 - 12s/epoch - 46ms/step
Epoch 15/50
260/260 - 12s - loss: 12.5378 - accuracy10: 0.4538 - accuracy20: 0.4644 - accuracy30: 0.4561 - accuracy50: 0.4381 - val_loss: 13.2872 - val_accuracy10: 0.3799 - val_accuracy20: 0.3881 - val_accuracy30: 0.3824 - val_accuracy50: 0.3750 - 12s/epoch - 46ms/step
Epoch 16/50
260/260 - 12s - loss: 12.4977 - accuracy10: 0.4568 - accuracy20: 0.4683 - accuracy30: 0.4603 - accuracy50: 0.4415 - val_loss: 13.3120 - val_accuracy10: 0.3802 - val_accuracy20: 0.3839 - val_accuracy30: 0.3816 - val_accuracy50: 0.3757 - 12s/epoch - 46ms/step
Epoch 17/50
260/260 - 12s - loss: 12.4683 - accuracy10: 0.4593 - accuracy20: 0.4734 - accuracy30: 0.4638 - accuracy50: 0.4460 - val_loss: 13.3856 - val_accuracy10: 0.3842 - val_accuracy20: 0.3856 - val_accuracy30: 0.3796 - val_accuracy50: 0.3750 - 12s/epoch - 46ms/step
Epoch 18/50
260/260 - 12s - loss: 12.4275 - accuracy10: 0.4608 - accuracy20: 0.4763 - accuracy30: 0.4666 - accuracy50: 0.4457 - val_loss: 13.4632 - val_accuracy10: 0.3848 - val_accuracy20: 0.3833 - val_accuracy30: 0.3790 - val_accuracy50: 0.3773 - 12s/epoch - 46ms/step
testing model: results/LILAK/W3/deepLOB_L2/seq2seq
Evaluating performance on  test set...
678/678 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1202898
{'0': {'precision': 0.31098102543399275, 'recall': 0.6324821413909187, 'f1-score': 0.4169530975127879, 'support': 48716}, '1': {'precision': 0.45566753763842227, 'recall': 0.24352000851143057, 'f1-score': 0.3174088647749137, 'support': 75193}, '2': {'precision': 0.35397192838514957, 'recall': 0.24412424469009558, 'f1-score': 0.2889606506398756, 'support': 49483}, 'accuracy': 0.3529747623881148, 'macro avg': {'precision': 0.3735401638191882, 'recall': 0.3733754648641483, 'f1-score': 0.3411075376425257, 'support': 173392}, 'weighted avg': {'precision': 0.38599447336077, 'recall': 0.3529747623881148, 'f1-score': 0.3372580727084642, 'support': 173392}}
[[30812  9944  7960]
 [42795 18311 14087]
 [25473 11930 12080]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1098858
{'0': {'precision': 0.37231450042315417, 'recall': 0.618661154504329, 'f1-score': 0.4648681681031739, 'support': 59021}, '1': {'precision': 0.33939811172305273, 'recall': 0.2490078649253193, 'f1-score': 0.2872601656469805, 'support': 55436}, '2': {'precision': 0.4077120674228649, 'recall': 0.23968779163485196, 'f1-score': 0.3018956636960099, 'support': 58935}, 'accuracy': 0.3716665128725662, 'macro avg': {'precision': 0.3731415598563573, 'recall': 0.36911893702150006, 'f1-score': 0.35134133248205474, 'support': 173392}, 'weighted avg': {'precision': 0.37382208259043487, 'recall': 0.3716665128725662, 'f1-score': 0.35269077946126565, 'support': 173392}}
[[36514 12555  9952]
 [31063 13804 10569]
 [30496 14313 14126]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1077538
{'0': {'precision': 0.3671189558423843, 'recall': 0.6061666041019691, 'f1-score': 0.45728665855714956, 'support': 58606}, '1': {'precision': 0.34768148538067667, 'recall': 0.25571491421029474, 'f1-score': 0.2946896642634786, 'support': 56825}, '2': {'precision': 0.3954236168929976, 'recall': 0.23762529977053537, 'f1-score': 0.2968574877144582, 'support': 57961}, 'accuracy': 0.3681196364307465, 'macro avg': {'precision': 0.37007468603868615, 'recall': 0.3665022726942664, 'f1-score': 0.3496112701783621, 'support': 173392}, 'weighted avg': {'precision': 0.3702104029689418, 'recall': 0.3681196364307465, 'f1-score': 0.35037163726463844, 'support': 173392}}
[[35525 12812 10269]
 [31505 14531 10789]
 [29737 14451 13773]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1070484
{'0': {'precision': 0.3559640145954788, 'recall': 0.5946054820912514, 'f1-score': 0.44532915319380584, 'support': 57095}, '1': {'precision': 0.3617021276595745, 'recall': 0.2622364710621727, 'f1-score': 0.3040411018887018, 'support': 59576}, '2': {'precision': 0.37941826743618456, 'recall': 0.2329648631018494, 'f1-score': 0.2886791628435356, 'support': 56721}, 'accuracy': 0.36210436467657103, 'macro avg': {'precision': 0.3656948032304126, 'recall': 0.36326893875175786, 'f1-score': 0.34601647264201446, 'support': 173392}, 'weighted avg': {'precision': 0.365608072564037, 'recall': 0.36210436467657103, 'f1-score': 0.3455395374836776, 'support': 173392}}
[[33949 12845 10301]
 [32641 15623 11312]
 [28782 14725 13214]]
Evaluating performance on  train set...
260/260 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0820761
{'0': {'precision': 0.3433013934224843, 'recall': 0.5148436677545005, 'f1-score': 0.41192697256206706, 'support': 18998}, '1': {'precision': 0.4904682345885276, 'recall': 0.3967632381480455, 'f1-score': 0.4386674074215981, 'support': 28856}, '2': {'precision': 0.3772335288030355, 'recall': 0.29596752368064955, 'f1-score': 0.3316954807400667, 'support': 18475}, 'accuracy': 0.40250870659892357, 'macro avg': {'precision': 0.4036677189380158, 'recall': 0.4025248098610652, 'f1-score': 0.3940966202412439, 'support': 66329}, 'weighted avg': {'precision': 0.4167766843185181, 'recall': 0.40250870659892357, 'f1-score': 0.401212883353654, 'support': 66329}}
[[ 9781  5855  3362]
 [11742 11449  5665]
 [ 6968  6039  5468]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0867621
{'0': {'precision': 0.398219773233019, 'recall': 0.4980121918897429, 'f1-score': 0.4425602072660896, 'support': 22638}, '1': {'precision': 0.37267080745341613, 'recall': 0.4064850721861421, 'f1-score': 0.3888441941539287, 'support': 21403}, '2': {'precision': 0.43038233490083827, 'recall': 0.28333632447954055, 'f1-score': 0.34171153377884794, 'support': 22288}, 'accuracy': 0.39634247463402134, 'macro avg': {'precision': 0.40042430519575783, 'recall': 0.3959445295184752, 'f1-score': 0.39103864506628877, 'support': 66329}, 'weighted avg': {'precision': 0.4007829757518496, 'recall': 0.39634247463402134, 'f1-score': 0.3913397899022936, 'support': 66329}}
[[11274  7111  4253]
 [ 8598  8700  4105]
 [ 8439  7534  6315]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0880613
{'0': {'precision': 0.3918769800306126, 'recall': 0.4924625363453366, 'f1-score': 0.43644941325721537, 'support': 22355}, '1': {'precision': 0.3736873306233062, 'recall': 0.4031705422815113, 'f1-score': 0.38786946489396773, 'support': 21889}, '2': {'precision': 0.42277701778385773, 'recall': 0.27987321711568935, 'f1-score': 0.3367933524043045, 'support': 22085}, 'accuracy': 0.39221155150839, 'macro avg': {'precision': 0.3961137761459255, 'recall': 0.391835431914179, 'f1-score': 0.3870374101851626, 'support': 66329}, 'weighted avg': {'precision': 0.3961627991731278, 'recall': 0.39221155150839, 'f1-score': 0.3872360888642701, 'support': 66329}}
[[11009  7147  4199]
 [ 8824  8825  4240]
 [ 8260  7644  6181]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0938367
{'0': {'precision': 0.38494846836530205, 'recall': 0.48129753914988815, 'f1-score': 0.4277647433093411, 'support': 22350}, '1': {'precision': 0.3559541188738269, 'recall': 0.39542211101844127, 'f1-score': 0.3746515354391202, 'support': 21582}, '2': {'precision': 0.4122831367106176, 'recall': 0.26525874000982275, 'f1-score': 0.32281902898905096, 'support': 22397}, 'accuracy': 0.38040676024061876, 'macro avg': {'precision': 0.38439524131658215, 'recall': 0.3806594633927174, 'f1-score': 0.3750784359125041, 'support': 66329}, 'weighted avg': {'precision': 0.3847443120566741, 'recall': 0.38040676024061876, 'f1-score': 0.37504634840082984, 'support': 66329}}
[[10757  7422  4171]
 [ 8750  8534  4298]
 [ 8437  8019  5941]]
Evaluating performance on  val set...
86/86 - 1s - 1s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.089763
{'0': {'precision': 0.3574578469520104, 'recall': 0.430625, 'f1-score': 0.39064493267186395, 'support': 6400}, '1': {'precision': 0.46868869775162214, 'recall': 0.33383490971625107, 'f1-score': 0.3899315799384847, 'support': 9304}, '2': {'precision': 0.3439515598262472, 'recall': 0.41942215088282503, 'f1-score': 0.3779561727055761, 'support': 6230}, 'accuracy': 0.3863864320233428, 'macro avg': {'precision': 0.3900327015099599, 'recall': 0.39462735353302536, 'f1-score': 0.38617756177197493, 'support': 21934}, 'weighted avg': {'precision': 0.4008036875212674, 'recall': 0.3863864320233428, 'f1-score': 0.3867383033100816, 'support': 21934}}
[[2756 1713 1931]
 [3145 3106 3053]
 [1809 1808 2613]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0900875
{'0': {'precision': 0.4169054441260745, 'recall': 0.41750358680057387, 'f1-score': 0.41720430107526885, 'support': 7667}, '1': {'precision': 0.35227963525835865, 'recall': 0.3390871854885898, 'f1-score': 0.3455575432319618, 'support': 6836}, '2': {'precision': 0.3953882230328296, 'recall': 0.408424169021666, 'f1-score': 0.4018004898391474, 'support': 7431}, 'accuracy': 0.38998814625695266, 'macro avg': {'precision': 0.3881911008057542, 'recall': 0.3883383137702765, 'f1-score': 0.38818744471545935, 'support': 21934}, 'weighted avg': {'precision': 0.38947421866042264, 'recall': 0.38998814625695266, 'f1-score': 0.3896560673781564, 'support': 21934}}
[[3201 2103 2363]
 [2240 2318 2278]
 [2237 2159 3035]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0905842
{'0': {'precision': 0.41060033858575334, 'recall': 0.41634755050838507, 'f1-score': 0.4134539732494099, 'support': 7573}, '1': {'precision': 0.3543880959611297, 'recall': 0.33276304533789564, 'f1-score': 0.3432352941176471, 'support': 7014}, '2': {'precision': 0.3894901551701656, 'recall': 0.40656050088471485, 'f1-score': 0.39784230154501865, 'support': 7347}, 'accuracy': 0.38634084070393, 'macro avg': {'precision': 0.38482619657234957, 'recall': 0.38522369891033187, 'f1-score': 0.38484385630402523, 'support': 21934}, 'weighted avg': {'precision': 0.38555387249094925, 'recall': 0.38634084070393, 'f1-score': 0.38577034201742544, 'support': 21934}}
[[3153 2085 2335]
 [2333 2334 2347]
 [2193 2167 2987]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0935339
{'0': {'precision': 0.3965022187418429, 'recall': 0.40577000133564844, 'f1-score': 0.4010825797082316, 'support': 7487}, '1': {'precision': 0.3593493508431577, 'recall': 0.3349095966620306, 'f1-score': 0.3466993017061406, 'support': 7190}, '2': {'precision': 0.37392682604675737, 'recall': 0.390106104450875, 'f1-score': 0.38184515780954953, 'support': 7257}, 'accuracy': 0.3773593507796116, 'macro avg': {'precision': 0.3765927985439193, 'recall': 0.3769285674828513, 'f1-score': 0.37654234640797385, 'support': 21934}, 'weighted avg': {'precision': 0.3768542409457372, 'recall': 0.3773593507796116, 'f1-score': 0.3768908344928687, 'support': 21934}}
[[3038 2095 2354]
 [2396 2408 2386]
 [2228 2198 2831]]
training model: results/LILAK/W3/deepOF_L2/seq2seq
Epoch 1/50
260/260 - 12s - loss: 13.2778 - accuracy10: 0.3619 - accuracy20: 0.3565 - accuracy30: 0.3495 - accuracy50: 0.3419 - val_loss: 13.2108 - val_accuracy10: 0.3759 - val_accuracy20: 0.3632 - val_accuracy30: 0.3537 - val_accuracy50: 0.3457 - 12s/epoch - 46ms/step
Epoch 2/50
260/260 - 7s - loss: 13.1279 - accuracy10: 0.3956 - accuracy20: 0.3822 - accuracy30: 0.3732 - accuracy50: 0.3603 - val_loss: 13.1450 - val_accuracy10: 0.3941 - val_accuracy20: 0.3721 - val_accuracy30: 0.3658 - val_accuracy50: 0.3564 - 7s/epoch - 29ms/step
Epoch 3/50
260/260 - 8s - loss: 13.0427 - accuracy10: 0.4136 - accuracy20: 0.3993 - accuracy30: 0.3865 - accuracy50: 0.3728 - val_loss: 13.0817 - val_accuracy10: 0.4103 - val_accuracy20: 0.3896 - val_accuracy30: 0.3752 - val_accuracy50: 0.3616 - 8s/epoch - 29ms/step
Epoch 4/50
260/260 - 7s - loss: 12.9512 - accuracy10: 0.4302 - accuracy20: 0.4164 - accuracy30: 0.4017 - accuracy50: 0.3863 - val_loss: 13.0235 - val_accuracy10: 0.4192 - val_accuracy20: 0.4020 - val_accuracy30: 0.3887 - val_accuracy50: 0.3702 - 7s/epoch - 29ms/step
Epoch 5/50
260/260 - 8s - loss: 12.8872 - accuracy10: 0.4412 - accuracy20: 0.4259 - accuracy30: 0.4115 - accuracy50: 0.3940 - val_loss: 12.9859 - val_accuracy10: 0.4212 - val_accuracy20: 0.4059 - val_accuracy30: 0.3961 - val_accuracy50: 0.3776 - 8s/epoch - 29ms/step
Epoch 6/50
260/260 - 8s - loss: 12.8289 - accuracy10: 0.4463 - accuracy20: 0.4308 - accuracy30: 0.4162 - accuracy50: 0.3997 - val_loss: 12.9628 - val_accuracy10: 0.4246 - val_accuracy20: 0.4116 - val_accuracy30: 0.3997 - val_accuracy50: 0.3769 - 8s/epoch - 29ms/step
Epoch 7/50
260/260 - 8s - loss: 12.7830 - accuracy10: 0.4501 - accuracy20: 0.4374 - accuracy30: 0.4224 - accuracy50: 0.4061 - val_loss: 12.9484 - val_accuracy10: 0.4204 - val_accuracy20: 0.4136 - val_accuracy30: 0.4009 - val_accuracy50: 0.3779 - 8s/epoch - 29ms/step
Epoch 8/50
260/260 - 8s - loss: 12.7319 - accuracy10: 0.4539 - accuracy20: 0.4427 - accuracy30: 0.4286 - accuracy50: 0.4107 - val_loss: 12.9315 - val_accuracy10: 0.4306 - val_accuracy20: 0.4201 - val_accuracy30: 0.4044 - val_accuracy50: 0.3864 - 8s/epoch - 29ms/step
Epoch 9/50
260/260 - 8s - loss: 12.6864 - accuracy10: 0.4558 - accuracy20: 0.4483 - accuracy30: 0.4350 - accuracy50: 0.4173 - val_loss: 12.9248 - val_accuracy10: 0.4244 - val_accuracy20: 0.4189 - val_accuracy30: 0.4018 - val_accuracy50: 0.3872 - 8s/epoch - 29ms/step
Epoch 10/50
260/260 - 7s - loss: 12.6338 - accuracy10: 0.4599 - accuracy20: 0.4523 - accuracy30: 0.4395 - accuracy50: 0.4214 - val_loss: 12.9442 - val_accuracy10: 0.4386 - val_accuracy20: 0.4213 - val_accuracy30: 0.4070 - val_accuracy50: 0.3862 - 7s/epoch - 28ms/step
Epoch 11/50
260/260 - 7s - loss: 12.5722 - accuracy10: 0.4644 - accuracy20: 0.4602 - accuracy30: 0.4461 - accuracy50: 0.4285 - val_loss: 12.9532 - val_accuracy10: 0.4370 - val_accuracy20: 0.4174 - val_accuracy30: 0.4013 - val_accuracy50: 0.3873 - 7s/epoch - 28ms/step
Epoch 12/50
260/260 - 7s - loss: 12.5209 - accuracy10: 0.4648 - accuracy20: 0.4651 - accuracy30: 0.4525 - accuracy50: 0.4350 - val_loss: 12.9825 - val_accuracy10: 0.4190 - val_accuracy20: 0.4166 - val_accuracy30: 0.4023 - val_accuracy50: 0.3876 - 7s/epoch - 28ms/step
Epoch 13/50
260/260 - 7s - loss: 12.4600 - accuracy10: 0.4704 - accuracy20: 0.4729 - accuracy30: 0.4601 - accuracy50: 0.4416 - val_loss: 13.0396 - val_accuracy10: 0.4230 - val_accuracy20: 0.4183 - val_accuracy30: 0.4019 - val_accuracy50: 0.3827 - 7s/epoch - 28ms/step
Epoch 14/50
260/260 - 7s - loss: 12.4020 - accuracy10: 0.4712 - accuracy20: 0.4759 - accuracy30: 0.4628 - accuracy50: 0.4446 - val_loss: 13.0660 - val_accuracy10: 0.4110 - val_accuracy20: 0.4140 - val_accuracy30: 0.3988 - val_accuracy50: 0.3842 - 7s/epoch - 28ms/step
Epoch 15/50
260/260 - 7s - loss: 12.3527 - accuracy10: 0.4752 - accuracy20: 0.4822 - accuracy30: 0.4699 - accuracy50: 0.4516 - val_loss: 13.1315 - val_accuracy10: 0.4206 - val_accuracy20: 0.4132 - val_accuracy30: 0.3974 - val_accuracy50: 0.3825 - 7s/epoch - 28ms/step
Epoch 16/50
260/260 - 7s - loss: 12.3239 - accuracy10: 0.4737 - accuracy20: 0.4836 - accuracy30: 0.4722 - accuracy50: 0.4546 - val_loss: 13.0825 - val_accuracy10: 0.4080 - val_accuracy20: 0.4134 - val_accuracy30: 0.3989 - val_accuracy50: 0.3811 - 7s/epoch - 28ms/step
Epoch 17/50
260/260 - 7s - loss: 12.2565 - accuracy10: 0.4781 - accuracy20: 0.4908 - accuracy30: 0.4798 - accuracy50: 0.4604 - val_loss: 13.1112 - val_accuracy10: 0.4033 - val_accuracy20: 0.4099 - val_accuracy30: 0.3976 - val_accuracy50: 0.3855 - 7s/epoch - 28ms/step
Epoch 18/50
260/260 - 7s - loss: 12.1932 - accuracy10: 0.4797 - accuracy20: 0.4945 - accuracy30: 0.4854 - accuracy50: 0.4688 - val_loss: 13.1700 - val_accuracy10: 0.3992 - val_accuracy20: 0.4106 - val_accuracy30: 0.3950 - val_accuracy50: 0.3775 - 7s/epoch - 28ms/step
Epoch 19/50
260/260 - 7s - loss: 12.1105 - accuracy10: 0.4838 - accuracy20: 0.5048 - accuracy30: 0.4952 - accuracy50: 0.4764 - val_loss: 13.1980 - val_accuracy10: 0.4108 - val_accuracy20: 0.4099 - val_accuracy30: 0.3952 - val_accuracy50: 0.3790 - 7s/epoch - 28ms/step
testing model: results/LILAK/W3/deepOF_L2/seq2seq
Evaluating performance on  test set...
678/678 - 7s - 7s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0713736
{'0': {'precision': 0.3534390550155792, 'recall': 0.4680283280303808, 'f1-score': 0.4027414682399491, 'support': 48715}, '1': {'precision': 0.5357380413918926, 'recall': 0.3749019190616148, 'f1-score': 0.4411166400650956, 'support': 75193}, '2': {'precision': 0.38437611091361534, 'recall': 0.4370452708164915, 'f1-score': 0.40902212975222246, 'support': 49480}, 'accuracy': 0.4188006090386878, 'macro avg': {'precision': 0.4245177357736957, 'recall': 0.42665850596949567, 'f1-score': 0.41762674601908906, 'support': 173388}, 'weighted avg': {'precision': 0.44132502871865525, 'recall': 0.4188006090386878, 'f1-score': 0.421175912530647, 'support': 173388}}
[[22800 12463 13452]
 [25820 28190 21183]
 [15889 11966 21625]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0765935
{'0': {'precision': 0.4077312202111173, 'recall': 0.47250978465292015, 'f1-score': 0.4377369152167259, 'support': 59021}, '1': {'precision': 0.41134489436236643, 'recall': 0.3410238833970705, 'f1-score': 0.37289807189703633, 'support': 55436}, '2': {'precision': 0.4279107587538751, 'recall': 0.4286368804194736, 'f1-score': 0.4282735118088876, 'support': 58931}, 'accuracy': 0.4155593235979422, 'macro avg': {'precision': 0.4156622911091196, 'recall': 0.4140568494898214, 'f1-score': 0.41296949964088325, 'support': 173388}, 'weighted avg': {'precision': 0.415745200567958, 'recall': 0.4155593235979422, 'f1-score': 0.4137900795389533, 'support': 173388}}
[[27888 13847 17286]
 [20046 18905 16485]
 [20464 13207 25260]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0846893
{'0': {'precision': 0.39615144147273357, 'recall': 0.48652015152032213, 'f1-score': 0.4367097816680834, 'support': 58606}, '1': {'precision': 0.4043634341187178, 'recall': 0.281483176122765, 'f1-score': 0.33191533513177, 'support': 56824}, '2': {'precision': 0.40593627237014407, 'recall': 0.4332447634493944, 'f1-score': 0.41914618369987067, 'support': 57958}, 'accuracy': 0.4015156758253166, 'macro avg': {'precision': 0.4021503826538651, 'recall': 0.40041603036416046, 'f1-score': 0.3959237668332414, 'support': 173388}, 'weighted avg': {'precision': 0.4021134890150522, 'recall': 0.4015156758253166, 'f1-score': 0.39649482653265794, 'support': 173388}}
[[28513 11849 18244]
 [22326 15995 18503]
 [21136 11712 25110]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0951453
{'0': {'precision': 0.3768100411235985, 'recall': 0.4926876258866801, 'f1-score': 0.4270273552539697, 'support': 57095}, '1': {'precision': 0.39090491502067065, 'recall': 0.22855224506924046, 'f1-score': 0.2884531867340346, 'support': 59575}, '2': {'precision': 0.3778539348700374, 'recall': 0.4257202299093762, 'f1-score': 0.40036146276353207, 'support': 56718}, 'accuracy': 0.3800262993978822, 'macro avg': {'precision': 0.3818562970047688, 'recall': 0.3823200336217656, 'f1-score': 0.37194733491717874, 'support': 173388}, 'weighted avg': {'precision': 0.38199442342184625, 'recall': 0.3800262993978822, 'f1-score': 0.3706913217346502, 'support': 173388}}
[[28130 10598 18367]
 [24569 13616 21390]
 [21954 10618 24146]]
Evaluating performance on  train set...
260/260 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0491335
{'0': {'precision': 0.3910996178933961, 'recall': 0.533905895990305, 'f1-score': 0.451479237212618, 'support': 18979}, '1': {'precision': 0.5992040604452648, 'recall': 0.35995426512369205, 'f1-score': 0.4497402597402598, 'support': 28862}, '2': {'precision': 0.394844020797227, 'recall': 0.4929676511954993, 'f1-score': 0.4384833758360199, 'support': 18486}, 'accuracy': 0.44680145340509897, 'macro avg': {'precision': 0.4617158997119626, 'recall': 0.4622759374364988, 'f1-score': 0.44656762426296587, 'support': 66327}, 'weighted avg': {'precision': 0.48269925986442225, 'recall': 0.44680145340509897, 'f1-score': 0.44710044937033666, 'support': 66327}}
[[10133  3370  5476]
 [ 9982 10389  8491]
 [ 5794  3579  9113]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0487549
{'0': {'precision': 0.44537753222836096, 'recall': 0.5332980506306783, 'f1-score': 0.4853885677585099, 'support': 22674}, '1': {'precision': 0.46790205162144277, 'recall': 0.3299113392440504, 'f1-score': 0.38697318007662834, 'support': 21430}, '2': {'precision': 0.44949515934682344, 'recall': 0.4867929622463214, 'f1-score': 0.46740116655865194, 'support': 22223}, 'accuracy': 0.45200295505601035, 'macro avg': {'precision': 0.4542582477322091, 'recall': 0.45000078404035, 'f1-score': 0.4465876381312634, 'support': 66327}, 'weighted avg': {'precision': 0.4540347378617732, 'recall': 0.45200295505601035, 'f1-score': 0.4475642160633154, 'support': 66327}}
[[12092  3880  6702]
 [ 7813  7070  6547]
 [ 7245  4160 10818]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.059676
{'0': {'precision': 0.429077762812788, 'recall': 0.5418736851528579, 'f1-score': 0.47892394421916723, 'support': 22341}, '1': {'precision': 0.45092919674397175, 'recall': 0.26826259765178856, 'f1-score': 0.3363982698862823, 'support': 21889}, '2': {'precision': 0.43696943127017657, 'recall': 0.49617595148662713, 'f1-score': 0.4646944138340256, 'support': 22097}, 'accuracy': 0.4363532196541378, 'macro avg': {'precision': 0.43899213027564543, 'recall': 0.4354374114304245, 'f1-score': 0.42667220931315836, 'support': 66327}, 'weighted avg': {'precision': 0.43891822348826853, 'recall': 0.4363532196541378, 'f1-score': 0.4271475270980402, 'support': 66327}}
[[12106  3439  6796]
 [ 8686  5872  7331]
 [ 7422  3711 10964]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0713644
{'0': {'precision': 0.4172517552657974, 'recall': 0.5401871669726414, 'f1-score': 0.47082699137493655, 'support': 22333}, '1': {'precision': 0.4108953428424128, 'recall': 0.2202570125742711, 'f1-score': 0.28678521095085313, 'support': 21711}, '2': {'precision': 0.4238826815642458, 'recall': 0.4903289503208724, 'f1-score': 0.45469110884537756, 'support': 22283}, 'accuracy': 0.41871334449017744, 'macro avg': {'precision': 0.41734325989081866, 'recall': 0.41692437662259496, 'f1-score': 0.4041011037237224, 'support': 66327}, 'weighted avg': {'precision': 0.4173987973540001, 'recall': 0.41871334449017744, 'f1-score': 0.4051631295208886, 'support': 66327}}
[[12064  3317  6952]
 [ 9031  4782  7898]
 [ 7818  3539 10926]]
Evaluating performance on  val set...
86/86 - 1s - 911ms/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0648054
{'0': {'precision': 0.3704965920155794, 'recall': 0.4731115946534038, 'f1-score': 0.4155631399317406, 'support': 6434}, '1': {'precision': 0.5575522098105876, 'recall': 0.3691714010076107, 'f1-score': 0.444215142525474, 'support': 9329}, '2': {'precision': 0.37435353401405647, 'recall': 0.4574623237724842, 'f1-score': 0.4117561260210035, 'support': 6171}, 'accuracy': 0.42450077505243, 'macro avg': {'precision': 0.4341341119467412, 'recall': 0.43324843981116623, 'f1-score': 0.4238448028260727, 'support': 21934}, 'weighted avg': {'precision': 0.45114048038442384, 'recall': 0.42450077505243, 'f1-score': 0.4266783696825284, 'support': 21934}}
[[3044 1365 2025]
 [3192 3444 2693]
 [1980 1368 2823]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0719393
{'0': {'precision': 0.41875430935417146, 'recall': 0.4752836833181166, 'f1-score': 0.4452318406744456, 'support': 7667}, '1': {'precision': 0.4223463687150838, 'recall': 0.33162743091095187, 'f1-score': 0.37152919977066096, 'support': 6839}, '2': {'precision': 0.4225387941999491, 'recall': 0.4472267097469036, 'f1-score': 0.4345323741007194, 'support': 7428}, 'accuracy': 0.4209902434576457, 'macro avg': {'precision': 0.42121315742306814, 'recall': 0.41804594132532397, 'f1-score': 0.41709780484860864, 'support': 21934}, 'weighted avg': {'precision': 0.4211559345663405, 'recall': 0.4209902434576457, 'f1-score': 0.4186280292925444, 'support': 21934}}
[[3644 1571 2452]
 [2483 2268 2088]
 [2575 1531 3322]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0816202
{'0': {'precision': 0.40784571553802323, 'recall': 0.4918076109936575, 'f1-score': 0.44590870971606567, 'support': 7568}, '1': {'precision': 0.4, 'recall': 0.26253392372518214, 'f1-score': 0.3170058640910659, 'support': 7001}, '2': {'precision': 0.4120297089979301, 'recall': 0.4594704684317719, 'f1-score': 0.43445885222750036, 'support': 7365}, 'accuracy': 0.40776876082793834, 'macro avg': {'precision': 0.4066251415119844, 'recall': 0.40460400105020383, 'f1-score': 0.39912447534487727, 'support': 21934}, 'weighted avg': {'precision': 0.4067463837859722, 'recall': 0.40776876082793834, 'f1-score': 0.40092024328842335, 'support': 21934}}
[[3722 1406 2440]
 [2774 1838 2389]
 [2630 1351 3384]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0912073
{'0': {'precision': 0.3896823704966958, 'recall': 0.48798718633208754, 'f1-score': 0.4333293824819248, 'support': 7492}, '1': {'precision': 0.3802160039273441, 'recall': 0.21603905160390516, 'f1-score': 0.2755247242974031, 'support': 7170}, '2': {'precision': 0.3899504600141543, 'recall': 0.4546204620462046, 'f1-score': 0.41980952380952385, 'support': 7272}, 'accuracy': 0.388027719522203, 'macro avg': {'precision': 0.38661627814606475, 'recall': 0.3862155666607325, 'f1-score': 0.3762212101962839, 'support': 21934}, 'weighted avg': {'precision': 0.38667679461763615, 'recall': 0.388027719522203, 'f1-score': 0.37726228065605083, 'support': 21934}}
[[3656 1287 2549]
 [2998 1549 2623]
 [2728 1238 3306]]
training model: results/LILAK/W3/deepVOL_L2/seq2seq
Epoch 1/50
260/260 - 12s - loss: 13.2921 - accuracy10: 0.3509 - accuracy20: 0.3574 - accuracy30: 0.3514 - accuracy50: 0.3456 - val_loss: 13.2485 - val_accuracy10: 0.3515 - val_accuracy20: 0.3542 - val_accuracy30: 0.3514 - val_accuracy50: 0.3466 - 12s/epoch - 48ms/step
Epoch 2/50
260/260 - 7s - loss: 13.1722 - accuracy10: 0.3690 - accuracy20: 0.3680 - accuracy30: 0.3638 - accuracy50: 0.3561 - val_loss: 13.2181 - val_accuracy10: 0.3767 - val_accuracy20: 0.3490 - val_accuracy30: 0.3485 - val_accuracy50: 0.3503 - 7s/epoch - 28ms/step
Epoch 3/50
260/260 - 7s - loss: 13.1252 - accuracy10: 0.3783 - accuracy20: 0.3751 - accuracy30: 0.3687 - accuracy50: 0.3653 - val_loss: 13.1829 - val_accuracy10: 0.3706 - val_accuracy20: 0.3659 - val_accuracy30: 0.3614 - val_accuracy50: 0.3569 - 7s/epoch - 28ms/step
Epoch 4/50
260/260 - 7s - loss: 13.0546 - accuracy10: 0.3899 - accuracy20: 0.3912 - accuracy30: 0.3840 - accuracy50: 0.3765 - val_loss: 13.2769 - val_accuracy10: 0.3427 - val_accuracy20: 0.3718 - val_accuracy30: 0.3686 - val_accuracy50: 0.3633 - 7s/epoch - 27ms/step
Epoch 5/50
260/260 - 7s - loss: 13.0033 - accuracy10: 0.3973 - accuracy20: 0.3999 - accuracy30: 0.3943 - accuracy50: 0.3866 - val_loss: 13.3273 - val_accuracy10: 0.3427 - val_accuracy20: 0.3757 - val_accuracy30: 0.3726 - val_accuracy50: 0.3661 - 7s/epoch - 29ms/step
Epoch 6/50
260/260 - 7s - loss: 12.9606 - accuracy10: 0.3971 - accuracy20: 0.4079 - accuracy30: 0.3997 - accuracy50: 0.3914 - val_loss: 13.3161 - val_accuracy10: 0.3378 - val_accuracy20: 0.3775 - val_accuracy30: 0.3764 - val_accuracy50: 0.3673 - 7s/epoch - 28ms/step
Epoch 7/50
260/260 - 7s - loss: 12.9251 - accuracy10: 0.4026 - accuracy20: 0.4112 - accuracy30: 0.4048 - accuracy50: 0.3963 - val_loss: 13.2750 - val_accuracy10: 0.3490 - val_accuracy20: 0.3823 - val_accuracy30: 0.3789 - val_accuracy50: 0.3712 - 7s/epoch - 29ms/step
Epoch 8/50
260/260 - 7s - loss: 12.9140 - accuracy10: 0.4023 - accuracy20: 0.4125 - accuracy30: 0.4068 - accuracy50: 0.3986 - val_loss: 13.3540 - val_accuracy10: 0.3497 - val_accuracy20: 0.3830 - val_accuracy30: 0.3777 - val_accuracy50: 0.3697 - 7s/epoch - 29ms/step
Epoch 9/50
260/260 - 7s - loss: 12.8616 - accuracy10: 0.4108 - accuracy20: 0.4211 - accuracy30: 0.4146 - accuracy50: 0.4030 - val_loss: 13.3608 - val_accuracy10: 0.3554 - val_accuracy20: 0.3840 - val_accuracy30: 0.3811 - val_accuracy50: 0.3723 - 7s/epoch - 27ms/step
Epoch 10/50
260/260 - 7s - loss: 12.8471 - accuracy10: 0.4139 - accuracy20: 0.4228 - accuracy30: 0.4173 - accuracy50: 0.4053 - val_loss: 13.3177 - val_accuracy10: 0.3476 - val_accuracy20: 0.3873 - val_accuracy30: 0.3855 - val_accuracy50: 0.3758 - 7s/epoch - 28ms/step
Epoch 11/50
260/260 - 7s - loss: 12.8042 - accuracy10: 0.4175 - accuracy20: 0.4296 - accuracy30: 0.4231 - accuracy50: 0.4096 - val_loss: 13.4476 - val_accuracy10: 0.3389 - val_accuracy20: 0.3845 - val_accuracy30: 0.3819 - val_accuracy50: 0.3758 - 7s/epoch - 28ms/step
Epoch 12/50
260/260 - 7s - loss: 12.7626 - accuracy10: 0.4254 - accuracy20: 0.4329 - accuracy30: 0.4265 - accuracy50: 0.4163 - val_loss: 13.3906 - val_accuracy10: 0.3439 - val_accuracy20: 0.3887 - val_accuracy30: 0.3866 - val_accuracy50: 0.3763 - 7s/epoch - 28ms/step
Epoch 13/50
260/260 - 7s - loss: 12.7576 - accuracy10: 0.4255 - accuracy20: 0.4353 - accuracy30: 0.4282 - accuracy50: 0.4143 - val_loss: 13.3120 - val_accuracy10: 0.3558 - val_accuracy20: 0.3897 - val_accuracy30: 0.3884 - val_accuracy50: 0.3803 - 7s/epoch - 27ms/step
testing model: results/LILAK/W3/deepVOL_L2/seq2seq
Evaluating performance on  test set...
678/678 - 7s - 7s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1011279
{'0': {'precision': 0.3069849092461065, 'recall': 0.39126775597339686, 'f1-score': 0.34403963648505964, 'support': 48716}, '1': {'precision': 0.46662788693553947, 'recall': 0.288045429760749, 'f1-score': 0.35620718861268486, 'support': 75193}, '2': {'precision': 0.3215843415273176, 'recall': 0.4216801729887032, 'f1-score': 0.3648922775601567, 'support': 49483}, 'accuracy': 0.3551836301559472, 'macro avg': {'precision': 0.36506571256965453, 'recall': 0.3669977862409497, 'f1-score': 0.3550463675526337, 'support': 173392}, 'weighted avg': {'precision': 0.3803819409948187, 'recall': 0.3551836301559472, 'f1-score': 0.35526717861763524, 'support': 173392}}
[[19061 12377 17278]
 [26793 21659 26741]
 [16237 12380 20866]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0953377
{'0': {'precision': 0.3738589066489455, 'recall': 0.36221006082580776, 'f1-score': 0.3679423078578006, 'support': 59021}, '1': {'precision': 0.35371491006891914, 'recall': 0.30366548813045674, 'f1-score': 0.3267849516636254, 'support': 55436}, '2': {'precision': 0.38076015039785477, 'recall': 0.4433189106642912, 'f1-score': 0.4096650019991689, 'support': 58935}, 'accuracy': 0.3710609486020116, 'macro avg': {'precision': 0.3694446557052398, 'recall': 0.36973148654018523, 'f1-score': 0.3681307538401983, 'support': 173392}, 'weighted avg': {'precision': 0.36976426679204105, 'recall': 0.3710609486020116, 'f1-score': 0.3689650066053855, 'support': 173392}}
[[21378 15541 22102]
 [18213 16834 20389]
 [17591 15217 26127]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0955819
{'0': {'precision': 0.3758542586011637, 'recall': 0.3284475992219227, 'f1-score': 0.3505554543798944, 'support': 58606}, '1': {'precision': 0.3565613548578786, 'recall': 0.31677958644962606, 'f1-score': 0.33549529400801414, 'support': 56825}, '2': {'precision': 0.3744717057453308, 'recall': 0.4631907662048619, 'f1-score': 0.4141330001388311, 'support': 57961}, 'accuracy': 0.36966526714035247, 'macro avg': {'precision': 0.36896243973479104, 'recall': 0.36947265062547024, 'f1-score': 0.36672791617557987, 'support': 173392}, 'weighted avg': {'precision': 0.3690693238793248, 'recall': 0.36966526714035247, 'f1-score': 0.36687238086209445, 'support': 173392}}
[[19249 16595 22762]
 [16740 18001 22084]
 [15225 15889 26847]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.096063
{'0': {'precision': 0.37562504023864196, 'recall': 0.3065592433663193, 'f1-score': 0.33759595725803343, 'support': 57095}, '1': {'precision': 0.36193853873870474, 'recall': 0.322042433194575, 'f1-score': 0.3408269307634232, 'support': 59576}, '2': {'precision': 0.3673325563114954, 'recall': 0.47784771072442306, 'f1-score': 0.4153646930815972, 'support': 56721}, 'accuracy': 0.36791201439512783, 'macro avg': {'precision': 0.3682987117629473, 'recall': 0.36881646242843913, 'f1-score': 0.36459586036768465, 'support': 173392}, 'weighted avg': {'precision': 0.36820979043362245, 'recall': 0.36791201439512783, 'f1-score': 0.36414625336284484, 'support': 173392}}
[[17503 17253 22339]
 [16047 19186 24343]
 [13047 16570 27104]]
Evaluating performance on  train set...
260/260 - 3s - 3s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0959579
{'0': {'precision': 0.32445125568518884, 'recall': 0.34545741657016527, 'f1-score': 0.3346249936266762, 'support': 18998}, '1': {'precision': 0.4813848828884116, 'recall': 0.3262059883559745, 'f1-score': 0.388886593678992, 'support': 28856}, '2': {'precision': 0.3111839379214224, 'recall': 0.4471447902571042, 'f1-score': 0.36697614499577985, 'support': 18475}, 'accuracy': 0.3654057802771035, 'macro avg': {'precision': 0.37234002549834094, 'recall': 0.3729360650610813, 'f1-score': 0.3634959107671493, 'support': 66329}, 'weighted avg': {'precision': 0.3890287866428485, 'recall': 0.3654057802771035, 'f1-score': 0.36724210307584343, 'support': 66329}}
[[ 6563  5332  7103]
 [ 8260  9413 11183]
 [ 5405  4809  8261]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0933088
{'0': {'precision': 0.3808567240349639, 'recall': 0.30987719763229965, 'f1-score': 0.3417200477385099, 'support': 22638}, '1': {'precision': 0.37026078234704113, 'recall': 0.34495164229313646, 'f1-score': 0.3571584065017052, 'support': 21403}, '2': {'precision': 0.37186271004647836, 'recall': 0.46666367552045945, 'f1-score': 0.4139042540491066, 'support': 22288}, 'accuracy': 0.37387869559317943, 'macro avg': {'precision': 0.37432673880949446, 'recall': 0.37383083848196513, 'f1-score': 0.37092756942977384, 'support': 66329}, 'weighted avg': {'precision': 0.3744154461064262, 'recall': 0.37387869559317943, 'f1-score': 0.3709571654827733, 'support': 66329}}
[[ 7015  6541  9082]
 [ 5533  7383  8487]
 [ 5871  6016 10401]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0937846
{'0': {'precision': 0.37433510638297873, 'recall': 0.27702974726012075, 'f1-score': 0.31841435512481037, 'support': 22355}, '1': {'precision': 0.37182907309501867, 'recall': 0.3502215724793275, 'f1-score': 0.36070201853855927, 'support': 21889}, '2': {'precision': 0.3676289083927592, 'recall': 0.4855331673081277, 'f1-score': 0.4184340428852945, 'support': 22085}, 'accuracy': 0.37060712508857363, 'macro avg': {'precision': 0.3712643626235856, 'recall': 0.370928162349192, 'f1-score': 0.3658501388495547, 'support': 66329}, 'weighted avg': {'precision': 0.37127519374666346, 'recall': 0.37060712508857363, 'f1-score': 0.3656722584348835, 'support': 66329}}
[[ 6193  6684  9478]
 [ 5256  7666  8967]
 [ 5095  6267 10723]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0952986
{'0': {'precision': 0.3688486992988664, 'recall': 0.2518568232662192, 'f1-score': 0.29932732445295257, 'support': 22350}, '1': {'precision': 0.3627827571489543, 'recall': 0.35446205170975814, 'f1-score': 0.35857414047669267, 'support': 21582}, '2': {'precision': 0.3697008105133251, 'recall': 0.49488770817520206, 'f1-score': 0.42323112757264497, 'support': 22397}, 'accuracy': 0.36730540186042304, 'macro avg': {'precision': 0.36711075565371526, 'recall': 0.36706886105039316, 'f1-score': 0.3603775308340968, 'support': 66329}, 'weighted avg': {'precision': 0.36716270329999456, 'recall': 0.36730540186042304, 'f1-score': 0.36044294901982543, 'support': 66329}}
[[ 5629  6853  9868]
 [ 4903  7650  9029]
 [ 4729  6584 11084]]
Evaluating performance on  val set...
86/86 - 1s - 899ms/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0945772
{'0': {'precision': 0.31742627345844504, 'recall': 0.2775, 'f1-score': 0.2961233847436432, 'support': 6400}, '1': {'precision': 0.44621798689696246, 'recall': 0.4026225279449699, 'f1-score': 0.42330075145488444, 'support': 9304}, '2': {'precision': 0.32678751258811684, 'recall': 0.41669341894060996, 'f1-score': 0.3663045011993792, 'support': 6230}, 'accuracy': 0.37011033099297896, 'macro avg': {'precision': 0.3634772576478414, 'recall': 0.3656053156285266, 'f1-score': 0.3619095457993023, 'support': 21934}, 'weighted avg': {'precision': 0.3747162625899223, 'recall': 0.37011033099297896, 'f1-score': 0.3700035058068612, 'support': 21934}}
[[1776 2427 2197]
 [2407 3746 3151]
 [1412 2222 2596]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0991298
{'0': {'precision': 0.3740037950664137, 'recall': 0.2570757793139429, 'f1-score': 0.30470742830640796, 'support': 7667}, '1': {'precision': 0.33381277717847296, 'recall': 0.40740198946752487, 'f1-score': 0.36695434481849926, 'support': 6836}, '2': {'precision': 0.3812041821896407, 'recall': 0.426860449468443, 'f1-score': 0.40274250888776025, 'support': 7431}, 'accuracy': 0.36144798030455, 'macro avg': {'precision': 0.3630069181448425, 'recall': 0.36377940608330356, 'f1-score': 0.3581347606708892, 'support': 21934}, 'weighted avg': {'precision': 0.36391718425355407, 'recall': 0.36144798030455, 'f1-score': 0.3573206591387543, 'support': 21934}}
[[1971 2939 2757]
 [1659 2785 2392]
 [1640 2619 3172]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0979148
{'0': {'precision': 0.37010457248308387, 'recall': 0.23834675821999207, 'f1-score': 0.28995983935742975, 'support': 7573}, '1': {'precision': 0.3335325762104005, 'recall': 0.397775876817793, 'f1-score': 0.362832433838351, 'support': 7014}, '2': {'precision': 0.37563276576161986, 'recall': 0.4443990744521573, 'f1-score': 0.4071326142527588, 'support': 7347}, 'accuracy': 0.3583477705844807, 'macro avg': {'precision': 0.3597566381517014, 'recall': 0.36017390316331416, 'f1-score': 0.3533082958161799, 'support': 21934}, 'weighted avg': {'precision': 0.3602613908545985, 'recall': 0.3583477705844807, 'f1-score': 0.35251098164087846, 'support': 21934}}
[[1805 2989 2779]
 [1576 2790 2648]
 [1496 2586 3265]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0988548
{'0': {'precision': 0.36171122994652405, 'recall': 0.22585815413383198, 'f1-score': 0.27807926327906596, 'support': 7487}, '1': {'precision': 0.33688367640019146, 'recall': 0.39151599443671764, 'f1-score': 0.36215103563617645, 'support': 7190}, '2': {'precision': 0.3670672806919016, 'recall': 0.45032382527215103, 'f1-score': 0.4044554455445545, 'support': 7257}, 'accuracy': 0.3544269171149813, 'macro avg': {'precision': 0.3552207290128724, 'recall': 0.3558993246142335, 'f1-score': 0.3482285814865989, 'support': 21934}, 'weighted avg': {'precision': 0.3553448011264764, 'recall': 0.3544269171149813, 'f1-score': 0.347450467708184, 'support': 21934}}
[[1691 2986 2810]
 [1550 2815 2825]
 [1434 2555 3268]]
training model: results/LILAK/W3/deepVOL_L3/seq2seq
Epoch 1/50
260/260 - 16s - loss: 13.3125 - accuracy10: 0.3568 - accuracy20: 0.3516 - accuracy30: 0.3509 - accuracy50: 0.3455 - val_loss: 13.4037 - val_accuracy10: 0.3822 - val_accuracy20: 0.3201 - val_accuracy30: 0.3258 - val_accuracy50: 0.3312 - 16s/epoch - 63ms/step
Epoch 2/50
260/260 - 11s - loss: 13.1818 - accuracy10: 0.3602 - accuracy20: 0.3597 - accuracy30: 0.3543 - accuracy50: 0.3491 - val_loss: 13.1990 - val_accuracy10: 0.3771 - val_accuracy20: 0.3557 - val_accuracy30: 0.3514 - val_accuracy50: 0.3529 - 11s/epoch - 42ms/step
Epoch 3/50
260/260 - 11s - loss: 13.1373 - accuracy10: 0.3669 - accuracy20: 0.3719 - accuracy30: 0.3685 - accuracy50: 0.3614 - val_loss: 13.1835 - val_accuracy10: 0.3684 - val_accuracy20: 0.3653 - val_accuracy30: 0.3611 - val_accuracy50: 0.3550 - 11s/epoch - 41ms/step
Epoch 4/50
260/260 - 11s - loss: 13.1056 - accuracy10: 0.3753 - accuracy20: 0.3795 - accuracy30: 0.3757 - accuracy50: 0.3671 - val_loss: 13.1507 - val_accuracy10: 0.3676 - val_accuracy20: 0.3739 - val_accuracy30: 0.3727 - val_accuracy50: 0.3690 - 11s/epoch - 41ms/step
Epoch 5/50
260/260 - 11s - loss: 13.0606 - accuracy10: 0.3781 - accuracy20: 0.3857 - accuracy30: 0.3814 - accuracy50: 0.3764 - val_loss: 13.1677 - val_accuracy10: 0.3691 - val_accuracy20: 0.3687 - val_accuracy30: 0.3680 - val_accuracy50: 0.3640 - 11s/epoch - 41ms/step
Epoch 6/50
260/260 - 10s - loss: 13.0235 - accuracy10: 0.3862 - accuracy20: 0.3934 - accuracy30: 0.3885 - accuracy50: 0.3820 - val_loss: 13.1544 - val_accuracy10: 0.3512 - val_accuracy20: 0.3796 - val_accuracy30: 0.3806 - val_accuracy50: 0.3744 - 10s/epoch - 40ms/step
Epoch 7/50
260/260 - 11s - loss: 12.9961 - accuracy10: 0.3896 - accuracy20: 0.3989 - accuracy30: 0.3947 - accuracy50: 0.3860 - val_loss: 13.1745 - val_accuracy10: 0.3761 - val_accuracy20: 0.3705 - val_accuracy30: 0.3724 - val_accuracy50: 0.3691 - 11s/epoch - 40ms/step
Epoch 8/50
260/260 - 11s - loss: 12.9639 - accuracy10: 0.3934 - accuracy20: 0.4030 - accuracy30: 0.3979 - accuracy50: 0.3906 - val_loss: 13.1646 - val_accuracy10: 0.3647 - val_accuracy20: 0.3785 - val_accuracy30: 0.3766 - val_accuracy50: 0.3729 - 11s/epoch - 40ms/step
Epoch 9/50
260/260 - 11s - loss: 12.9420 - accuracy10: 0.3960 - accuracy20: 0.4058 - accuracy30: 0.4016 - accuracy50: 0.3931 - val_loss: 13.1612 - val_accuracy10: 0.3696 - val_accuracy20: 0.3847 - val_accuracy30: 0.3838 - val_accuracy50: 0.3791 - 11s/epoch - 41ms/step
Epoch 10/50
260/260 - 10s - loss: 12.8953 - accuracy10: 0.4023 - accuracy20: 0.4135 - accuracy30: 0.4090 - accuracy50: 0.4017 - val_loss: 13.2805 - val_accuracy10: 0.3542 - val_accuracy20: 0.3749 - val_accuracy30: 0.3749 - val_accuracy50: 0.3713 - 10s/epoch - 40ms/step
Epoch 11/50
260/260 - 10s - loss: 12.8519 - accuracy10: 0.4073 - accuracy20: 0.4213 - accuracy30: 0.4159 - accuracy50: 0.4069 - val_loss: 13.2671 - val_accuracy10: 0.3754 - val_accuracy20: 0.3769 - val_accuracy30: 0.3762 - val_accuracy50: 0.3718 - 10s/epoch - 40ms/step
Epoch 12/50
260/260 - 10s - loss: 12.8363 - accuracy10: 0.4096 - accuracy20: 0.4224 - accuracy30: 0.4154 - accuracy50: 0.4069 - val_loss: 13.3676 - val_accuracy10: 0.3476 - val_accuracy20: 0.3699 - val_accuracy30: 0.3723 - val_accuracy50: 0.3633 - 10s/epoch - 40ms/step
Epoch 13/50
260/260 - 10s - loss: 12.8231 - accuracy10: 0.4119 - accuracy20: 0.4251 - accuracy30: 0.4205 - accuracy50: 0.4121 - val_loss: 13.2265 - val_accuracy10: 0.3506 - val_accuracy20: 0.3859 - val_accuracy30: 0.3858 - val_accuracy50: 0.3746 - 10s/epoch - 39ms/step
Epoch 14/50
260/260 - 10s - loss: 12.7778 - accuracy10: 0.4141 - accuracy20: 0.4306 - accuracy30: 0.4239 - accuracy50: 0.4167 - val_loss: 13.2496 - val_accuracy10: 0.3579 - val_accuracy20: 0.3833 - val_accuracy30: 0.3815 - val_accuracy50: 0.3733 - 10s/epoch - 39ms/step
testing model: results/LILAK/W3/deepVOL_L3/seq2seq
Evaluating performance on  test set...
678/678 - 11s - 11s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1018322
{'0': {'precision': 0.3006070003592837, 'recall': 0.3263198949010592, 'f1-score': 0.3129361509463676, 'support': 48716}, '1': {'precision': 0.4637911892242914, 'recall': 0.2944423018100089, 'f1-score': 0.360204994712438, 'support': 75193}, '2': {'precision': 0.31617929973066566, 'recall': 0.4649879756684114, 'f1-score': 0.37640996278270833, 'support': 49483}, 'accuracy': 0.3520692996216665, 'macro avg': {'precision': 0.36019249643808027, 'recall': 0.3619167241264932, 'f1-score': 0.3498503694805047, 'support': 173392}, 'weighted avg': {'precision': 0.3758173491823011, 'recall': 0.3520692996216665, 'f1-score': 0.35154900967341257, 'support': 173392}}
[[15897 13214 19605]
 [22895 22140 30158]
 [14091 12383 23009]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0979854
{'0': {'precision': 0.3614508468877401, 'recall': 0.2914216973619559, 'f1-score': 0.3226804994043543, 'support': 59021}, '1': {'precision': 0.3485604217356042, 'recall': 0.31010534670611156, 'f1-score': 0.32821031730879374, 'support': 55436}, '2': {'precision': 0.37387234265094266, 'recall': 0.48521252227029776, 'f1-score': 0.4223274085998479, 'support': 58935}, 'accuracy': 0.3632635877087755, 'macro avg': {'precision': 0.36129453709142895, 'recall': 0.3622465221127884, 'f1-score': 0.3577394084376653, 'support': 173392}, 'weighted avg': {'precision': 0.3615515853535894, 'recall': 0.3632635877087755, 'f1-score': 0.358317908159008, 'support': 173392}}
[[17200 16948 24873]
 [15228 17191 23017]
 [15158 15181 28596]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0975821
{'0': {'precision': 0.35666880263639694, 'recall': 0.26592840323516365, 'f1-score': 0.304686125393443, 'support': 58606}, '1': {'precision': 0.3522120481927711, 'recall': 0.32153101627804664, 'f1-score': 0.33617295308187667, 'support': 56825}, '2': {'precision': 0.36783130517469576, 'recall': 0.49386656544918134, 'f1-score': 0.4216317332194252, 'support': 57961}, 'accuracy': 0.3603453446525791, 'macro avg': {'precision': 0.3589040520012879, 'recall': 0.36044199498746393, 'f1-score': 0.3541636038982483, 'support': 173392}, 'weighted avg': {'precision': 0.3589395806328633, 'recall': 0.3603453446525791, 'f1-score': 0.35409742094685376, 'support': 173392}}
[[15585 18019 25002]
 [14360 18271 24194]
 [13751 15585 28625]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0978956
{'0': {'precision': 0.3489074216139969, 'recall': 0.2469393116735266, 'f1-score': 0.2891983918608468, 'support': 57095}, '1': {'precision': 0.3611374747058718, 'recall': 0.338508795488116, 'f1-score': 0.34945719508919676, 'support': 59576}, '2': {'precision': 0.3612911589318123, 'recall': 0.49135240916062833, 'f1-score': 0.4164020887338358, 'support': 56721}, 'accuracy': 0.3583556334778998, 'macro avg': {'precision': 0.357112018417227, 'recall': 0.358933505440757, 'f1-score': 0.3516858918946264, 'support': 173392}, 'weighted avg': {'precision': 0.35716060288767354, 'recall': 0.3583556334778998, 'f1-score': 0.35151441192789135, 'support': 173392}}
[[14099 19182 23814]
 [13953 20167 25456]
 [12357 16494 27870]]
Evaluating performance on  train set...
260/260 - 5s - 5s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0941753
{'0': {'precision': 0.32380249913224574, 'recall': 0.39283082429729443, 'f1-score': 0.3549921514531703, 'support': 18998}, '1': {'precision': 0.4986589781413437, 'recall': 0.2577280288328251, 'f1-score': 0.3398217957505141, 'support': 28856}, '2': {'precision': 0.31645926604857755, 'recall': 0.4858998646820027, 'f1-score': 0.3832885017719141, 'support': 18475}, 'accuracy': 0.3599782900390478, 'macro avg': {'precision': 0.3796402477740557, 'recall': 0.3788195726040407, 'f1-score': 0.3593674829918661, 'support': 66329}, 'weighted avg': {'precision': 0.3978273197546848, 'recall': 0.3599782900390478, 'f1-score': 0.3562739329964311, 'support': 66329}}
[[ 7463  4068  7467]
 [ 9496  7437 11923]
 [ 6089  3409  8977]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0893708
{'0': {'precision': 0.3829637616614317, 'recall': 0.3608534322820037, 'f1-score': 0.3715799768018376, 'support': 22638}, '1': {'precision': 0.3905391258832766, 'recall': 0.2788861374573658, 'f1-score': 0.32540136833210676, 'support': 21403}, '2': {'precision': 0.38079693073971865, 'recall': 0.5076722900215362, 'f1-score': 0.43517557017037806, 'support': 22288}, 'accuracy': 0.3837386361923141, 'macro avg': {'precision': 0.38476660609480895, 'recall': 0.3824706199203019, 'f1-score': 0.3773856384347742, 'support': 66329}, 'weighted avg': {'precision': 0.38468007266954285, 'recall': 0.3837386361923141, 'f1-score': 0.3780486078368355, 'support': 66329}}
[[ 8169  5041  9428]
 [ 6463  5969  8971]
 [ 6699  4274 11315]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.089888
{'0': {'precision': 0.3797840523140873, 'recall': 0.33513755312010735, 'f1-score': 0.3560667268665938, 'support': 22355}, '1': {'precision': 0.3880760790051207, 'recall': 0.2908310110100964, 'f1-score': 0.3324889666518685, 'support': 21889}, '2': {'precision': 0.3776409033710842, 'recall': 0.5163685759565316, 'f1-score': 0.4362412256373965, 'support': 22085}, 'accuracy': 0.38085905109379004, 'macro avg': {'precision': 0.38183367823009734, 'recall': 0.3807790466955785, 'f1-score': 0.37493230638528624, 'support': 66329}, 'weighted avg': {'precision': 0.38180688889889647, 'recall': 0.38085905109379004, 'f1-score': 0.3749809304881327, 'support': 66329}}
[[ 7492  5389  9474]
 [ 6203  6366  9320]
 [ 6032  4649 11404]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0914817
{'0': {'precision': 0.3714049130554789, 'recall': 0.3010290827740492, 'f1-score': 0.3325342888916348, 'support': 22350}, '1': {'precision': 0.3680305510092744, 'recall': 0.31257529422667035, 'f1-score': 0.33804369613148927, 'support': 21582}, '2': {'precision': 0.3809396332485611, 'recall': 0.5082823592445417, 'f1-score': 0.43549281765842274, 'support': 22397}, 'accuracy': 0.3747682009377497, 'macro avg': {'precision': 0.3734583657711048, 'recall': 0.37396224541508705, 'f1-score': 0.36869026756051565, 'support': 66329}, 'weighted avg': {'precision': 0.37352651365978884, 'recall': 0.3747682009377497, 'f1-score': 0.36909244890973075, 'support': 66329}}
[[ 6728  6149  9473]
 [ 5809  6746  9027]
 [ 5578  5435 11384]]
Evaluating performance on  val set...
86/86 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0948749
{'0': {'precision': 0.31595526854622774, 'recall': 0.3134375, 'f1-score': 0.31469134834104634, 'support': 6400}, '1': {'precision': 0.4629396984924623, 'recall': 0.3168529664660361, 'f1-score': 0.3762123532414497, 'support': 9304}, '2': {'precision': 0.3308017793208202, 'recall': 0.4894060995184591, 'f1-score': 0.39476921085000327, 'support': 6230}, 'accuracy': 0.3648673292605088, 'macro avg': {'precision': 0.36989891545317005, 'recall': 0.3732321886614984, 'f1-score': 0.3618909708108331, 'support': 21934}, 'weighted avg': {'precision': 0.38252027713314657, 'recall': 0.3648673292605088, 'f1-score': 0.3635322580257438, 'support': 21934}}
[[2006 1843 2551]
 [2739 2948 3617]
 [1604 1577 3049]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0955375
{'0': {'precision': 0.37661235573659196, 'recall': 0.2894221990348246, 'f1-score': 0.3273102736189984, 'support': 7667}, '1': {'precision': 0.35033598045204645, 'recall': 0.3355763604447045, 'f1-score': 0.34279736999402277, 'support': 6836}, '2': {'precision': 0.38613861386138615, 'recall': 0.4933387161889382, 'f1-score': 0.43320531757754804, 'support': 7431}, 'accuracy': 0.37289140147715877, 'macro avg': {'precision': 0.37102898335000817, 'recall': 0.3727790918894891, 'f1-score': 0.36777098706352307, 'support': 21934}, 'weighted avg': {'precision': 0.3716503936083979, 'recall': 0.37289140147715877, 'f1-score': 0.36801310312914925, 'support': 21934}}
[[2219 2310 3138]
 [1852 2294 2690]
 [1821 1944 3666]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0942626
{'0': {'precision': 0.37971175166297116, 'recall': 0.2713587745939522, 'f1-score': 0.3165190604543704, 'support': 7573}, '1': {'precision': 0.35226944203527033, 'recall': 0.3474479612204163, 'f1-score': 0.3498420901521677, 'support': 7014}, '2': {'precision': 0.38494377342773844, 'recall': 0.5031985844562407, 'f1-score': 0.4361984543684739, 'support': 7347}, 'accuracy': 0.37334731467128657, 'macro avg': {'precision': 0.3723083223753266, 'recall': 0.3740017734235364, 'f1-score': 0.367519868325004, 'support': 21934}, 'weighted avg': {'precision': 0.3726888330971396, 'recall': 0.37334731467128657, 'f1-score': 0.3672627568794305, 'support': 21934}}
[[2055 2434 3084]
 [1754 2437 2823]
 [1603 2047 3697]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0947176
{'0': {'precision': 0.378129381133587, 'recall': 0.2521704287431548, 'f1-score': 0.3025641025641026, 'support': 7487}, '1': {'precision': 0.35320916521506096, 'recall': 0.3666203059805285, 'f1-score': 0.3597898041356719, 'support': 7190}, '2': {'precision': 0.37982696771470775, 'recall': 0.49607275733774286, 'f1-score': 0.4302360322677024, 'support': 7257}, 'accuracy': 0.3703838789094556, 'macro avg': {'precision': 0.3703885046877852, 'recall': 0.3716211640204754, 'f1-score': 0.3641966463224923, 'support': 21934}, 'weighted avg': {'precision': 0.3705221518714821, 'recall': 0.3703838789094556, 'f1-score': 0.3635638284763214, 'support': 21934}}
[[1888 2614 2985]
 [1661 2636 2893]
 [1444 2213 3600]]
training model: results/LILAK/W4/deepLOB_L1/seq2seq
Epoch 1/50
254/254 - 12s - loss: 13.2514 - accuracy10: 0.3691 - accuracy20: 0.3671 - accuracy30: 0.3622 - accuracy50: 0.3637 - val_loss: 13.5028 - val_accuracy10: 0.3996 - val_accuracy20: 0.3471 - val_accuracy30: 0.3324 - val_accuracy50: 0.3236 - 12s/epoch - 46ms/step
Epoch 2/50
254/254 - 6s - loss: 13.1420 - accuracy10: 0.3694 - accuracy20: 0.3754 - accuracy30: 0.3752 - accuracy50: 0.3706 - val_loss: 13.4982 - val_accuracy10: 0.3488 - val_accuracy20: 0.3568 - val_accuracy30: 0.3592 - val_accuracy50: 0.3525 - 6s/epoch - 22ms/step
Epoch 3/50
254/254 - 6s - loss: 13.0369 - accuracy10: 0.3873 - accuracy20: 0.3913 - accuracy30: 0.3872 - accuracy50: 0.3817 - val_loss: 13.4707 - val_accuracy10: 0.4140 - val_accuracy20: 0.3533 - val_accuracy30: 0.3374 - val_accuracy50: 0.3245 - 6s/epoch - 22ms/step
Epoch 4/50
254/254 - 5s - loss: 13.0268 - accuracy10: 0.3876 - accuracy20: 0.3969 - accuracy30: 0.3938 - accuracy50: 0.3858 - val_loss: 13.3461 - val_accuracy10: 0.4095 - val_accuracy20: 0.3760 - val_accuracy30: 0.3606 - val_accuracy50: 0.3499 - 5s/epoch - 22ms/step
Epoch 5/50
254/254 - 5s - loss: 12.9733 - accuracy10: 0.3982 - accuracy20: 0.4072 - accuracy30: 0.3991 - accuracy50: 0.3914 - val_loss: 13.1759 - val_accuracy10: 0.4061 - val_accuracy20: 0.3912 - val_accuracy30: 0.3836 - val_accuracy50: 0.3694 - 5s/epoch - 21ms/step
Epoch 6/50
254/254 - 5s - loss: 12.9335 - accuracy10: 0.4115 - accuracy20: 0.4157 - accuracy30: 0.4088 - accuracy50: 0.3948 - val_loss: 13.6998 - val_accuracy10: 0.4376 - val_accuracy20: 0.3589 - val_accuracy30: 0.3370 - val_accuracy50: 0.3197 - 5s/epoch - 21ms/step
Epoch 7/50
254/254 - 5s - loss: 12.9017 - accuracy10: 0.4162 - accuracy20: 0.4178 - accuracy30: 0.4111 - accuracy50: 0.3975 - val_loss: 13.3784 - val_accuracy10: 0.4506 - val_accuracy20: 0.3788 - val_accuracy30: 0.3562 - val_accuracy50: 0.3387 - 5s/epoch - 21ms/step
Epoch 8/50
254/254 - 5s - loss: 12.8625 - accuracy10: 0.4262 - accuracy20: 0.4272 - accuracy30: 0.4184 - accuracy50: 0.4030 - val_loss: 13.4340 - val_accuracy10: 0.4351 - val_accuracy20: 0.3752 - val_accuracy30: 0.3559 - val_accuracy50: 0.3379 - 5s/epoch - 21ms/step
Epoch 9/50
254/254 - 5s - loss: 12.8375 - accuracy10: 0.4285 - accuracy20: 0.4318 - accuracy30: 0.4218 - accuracy50: 0.4045 - val_loss: 13.5445 - val_accuracy10: 0.4432 - val_accuracy20: 0.3708 - val_accuracy30: 0.3476 - val_accuracy50: 0.3273 - 5s/epoch - 21ms/step
Epoch 10/50
254/254 - 5s - loss: 12.8226 - accuracy10: 0.4359 - accuracy20: 0.4355 - accuracy30: 0.4244 - accuracy50: 0.4063 - val_loss: 13.4737 - val_accuracy10: 0.4471 - val_accuracy20: 0.3757 - val_accuracy30: 0.3512 - val_accuracy50: 0.3294 - 5s/epoch - 22ms/step
Epoch 11/50
254/254 - 5s - loss: 12.7823 - accuracy10: 0.4386 - accuracy20: 0.4385 - accuracy30: 0.4271 - accuracy50: 0.4100 - val_loss: 13.7074 - val_accuracy10: 0.4404 - val_accuracy20: 0.3612 - val_accuracy30: 0.3389 - val_accuracy50: 0.3216 - 5s/epoch - 21ms/step
Epoch 12/50
254/254 - 5s - loss: 12.7792 - accuracy10: 0.4410 - accuracy20: 0.4394 - accuracy30: 0.4272 - accuracy50: 0.4083 - val_loss: 13.4394 - val_accuracy10: 0.4460 - val_accuracy20: 0.3679 - val_accuracy30: 0.3442 - val_accuracy50: 0.3231 - 5s/epoch - 21ms/step
Epoch 13/50
254/254 - 5s - loss: 12.7508 - accuracy10: 0.4421 - accuracy20: 0.4403 - accuracy30: 0.4293 - accuracy50: 0.4103 - val_loss: 13.4615 - val_accuracy10: 0.4440 - val_accuracy20: 0.3682 - val_accuracy30: 0.3464 - val_accuracy50: 0.3258 - 5s/epoch - 22ms/step
Epoch 14/50
254/254 - 5s - loss: 12.7437 - accuracy10: 0.4421 - accuracy20: 0.4432 - accuracy30: 0.4320 - accuracy50: 0.4137 - val_loss: 13.5280 - val_accuracy10: 0.4389 - val_accuracy20: 0.3706 - val_accuracy30: 0.3513 - val_accuracy50: 0.3323 - 5s/epoch - 21ms/step
Epoch 15/50
254/254 - 5s - loss: 12.7183 - accuracy10: 0.4445 - accuracy20: 0.4452 - accuracy30: 0.4346 - accuracy50: 0.4129 - val_loss: 13.2779 - val_accuracy10: 0.4310 - val_accuracy20: 0.3935 - val_accuracy30: 0.3766 - val_accuracy50: 0.3544 - 5s/epoch - 21ms/step
testing model: results/LILAK/W4/deepLOB_L1/seq2seq
Evaluating performance on  test set...
534/534 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.082645
{'0': {'precision': 0.4478473146915224, 'recall': 0.24138231008460015, 'f1-score': 0.3136905771296139, 'support': 45981}, '1': {'precision': 0.37499523173755483, 'recall': 0.4337112856260478, 'f1-score': 0.4022217221415274, 'support': 45332}, '2': {'precision': 0.3976716407866624, 'recall': 0.5213383030810966, 'f1-score': 0.45118436372659426, 'support': 45341}, 'accuracy': 0.3980710407306043, 'macro avg': {'precision': 0.4068380624052465, 'recall': 0.39881063293058155, 'f1-score': 0.38903222099924517, 'support': 136654}, 'weighted avg': {'precision': 0.4070322206950824, 'recall': 0.3980710407306043, 'f1-score': 0.3886785002330265, 'support': 136654}}
[[11099 17713 17169]
 [ 7037 19661 18634]
 [ 6647 15056 23638]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0947438
{'0': {'precision': 0.4894535539818987, 'recall': 0.24514917588149385, 'f1-score': 0.3266776191077973, 'support': 52723}, '1': {'precision': 0.26236335242061426, 'recall': 0.4277631082610336, 'f1-score': 0.32524289248198474, 'support': 31812}, '2': {'precision': 0.4392942788626242, 'recall': 0.49206623304361174, 'f1-score': 0.46418519624611987, 'support': 52119}, 'accuracy': 0.38183295037101, 'macro avg': {'precision': 0.3970370617550458, 'recall': 0.38832617239537975, 'f1-score': 0.3720352359453007, 'support': 136654}, 'weighted avg': {'precision': 0.4174582611107859, 'recall': 0.38183295037101, 'f1-score': 0.3787881748870053, 'support': 136654}}
[[12925 20196 19602]
 [ 5072 13608 13132]
 [ 8410 18063 25646]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.09676
{'0': {'precision': 0.47879464285714285, 'recall': 0.2554356177012907, 'f1-score': 0.33314128256513026, 'support': 52064}, '1': {'precision': 0.26017411269492013, 'recall': 0.40980049424386716, 'f1-score': 0.31827916720306154, 'support': 33182}, '2': {'precision': 0.4238072527511349, 'recall': 0.4667172424525366, 'f1-score': 0.4442284370631637, 'support': 51408}, 'accuracy': 0.37240036881467065, 'macro avg': {'precision': 0.38759200276773265, 'recall': 0.3773177847992315, 'f1-score': 0.3652162956104518, 'support': 136654}, 'weighted avg': {'precision': 0.4050239652157088, 'recall': 0.37240036881467065, 'f1-score': 0.37132248272385765, 'support': 136654}}
[[13299 20039 18726]
 [ 5690 13598 13894]
 [ 8787 18628 23993]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0988404
{'0': {'precision': 0.446585672392124, 'recall': 0.25520708642566436, 'f1-score': 0.32480195003046924, 'support': 50124}, '1': {'precision': 0.2717729320190731, 'recall': 0.38969813258384456, 'f1-score': 0.3202238457951189, 'support': 37003}, '2': {'precision': 0.39404196465942387, 'recall': 0.4371958729581844, 'f1-score': 0.4144987461475143, 'support': 49527}, 'accuracy': 0.35758192222693813, 'macro avg': {'precision': 0.37080018969020695, 'recall': 0.36070036398923105, 'f1-score': 0.3531748473243675, 'support': 136654}, 'weighted avg': {'precision': 0.38020687598000696, 'recall': 0.35758192222693813, 'f1-score': 0.356070772240344, 'support': 136654}}
[[12792 19557 17775]
 [ 7060 14420 15523]
 [ 8792 19082 21653]]
Evaluating performance on  train set...
254/254 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0596257
{'0': {'precision': 0.3620521172638437, 'recall': 0.25787367322081084, 'f1-score': 0.3012093086277566, 'support': 17241}, '1': {'precision': 0.5089548780084087, 'recall': 0.5120058613914144, 'f1-score': 0.510475811003752, 'support': 30027}, '2': {'precision': 0.34473695933003695, 'recall': 0.43802354539280053, 'f1-score': 0.38582147219383306, 'support': 17668}, 'accuracy': 0.4244024886041641, 'macro avg': {'precision': 0.40524798486742974, 'recall': 0.40263436000167524, 'f1-score': 0.3991688639417805, 'support': 64936}, 'weighted avg': {'precision': 0.42527013171657496, 'recall': 0.4244024886041641, 'f1-score': 0.420997607456287, 'support': 64936}}
[[ 4446  7585  5210]
 [ 5153 15374  9500]
 [ 2681  7248  7739]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0829345
{'0': {'precision': 0.4133172884075411, 'recall': 0.2490814155869271, 'f1-score': 0.3108389393345199, 'support': 20684}, '1': {'precision': 0.3960624218081254, 'recall': 0.5241373300801673, 'f1-score': 0.4511870382177549, 'support': 22952}, '2': {'precision': 0.3983346155586731, 'recall': 0.4132394366197183, 'f1-score': 0.40565016014931904, 'support': 21300}, 'accuracy': 0.40014783787113467, 'macro avg': {'precision': 0.4025714419247799, 'recall': 0.39548606076227094, 'f1-score': 0.38922537923386463, 'support': 64936}, 'weighted avg': {'precision': 0.40230391170015734, 'recall': 0.40014783787113467, 'f1-score': 0.3915453051242703, 'support': 64936}}
[[ 5152  9261  6271]
 [ 3898 12030  7024]
 [ 3415  9083  8802]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0896739
{'0': {'precision': 0.42036827653044745, 'recall': 0.24393101509044895, 'f1-score': 0.3087188612099644, 'support': 21338}, '1': {'precision': 0.3674947908318641, 'recall': 0.5291972487651756, 'f1-score': 0.43376593893072, 'support': 21663}, '2': {'precision': 0.40081464488037827, 'recall': 0.3902894916799635, 'f1-score': 0.39548205294036126, 'support': 21935}, 'accuracy': 0.3885364050757669, 'macro avg': {'precision': 0.3962259040808966, 'recall': 0.3878059185118627, 'f1-score': 0.37932228436034854, 'support': 64936}, 'weighted avg': {'precision': 0.39612429428742846, 'recall': 0.3885364050757669, 'f1-score': 0.37974333846866504, 'support': 64936}}
[[ 5205  9886  6247]
 [ 3648 11464  6551]
 [ 3529  9845  8561]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0936283
{'0': {'precision': 0.4050590780495923, 'recall': 0.2281055245771051, 'f1-score': 0.29185527144099044, 'support': 21341}, '1': {'precision': 0.3584659373446047, 'recall': 0.5282344859171055, 'f1-score': 0.42709818370331976, 'support': 21835}, '2': {'precision': 0.385739080127278, 'recall': 0.36769301470588234, 'f1-score': 0.3764999294150863, 'support': 21760}, 'accuracy': 0.37580078846864606, 'macro avg': {'precision': 0.38308803184049167, 'recall': 0.37467767506669764, 'f1-score': 0.3651511281864655, 'support': 64936}, 'weighted avg': {'precision': 0.38291782539955277, 'recall': 0.37580078846864606, 'f1-score': 0.3656956180401694, 'support': 64936}}
[[ 4868 10369  6104]
 [ 3664 11534  6637]
 [ 3486 10273  8001]]
Evaluating performance on  val set...
81/81 - 1s - 675ms/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0737144
{'0': {'precision': 0.3788348845225784, 'recall': 0.1887991753994159, 'f1-score': 0.2520064205457464, 'support': 5821}, '1': {'precision': 0.4890617403986388, 'recall': 0.4492575639164899, 'f1-score': 0.46831539132964795, 'support': 8957}, '2': {'precision': 0.3436973018549747, 'recall': 0.5584860421305018, 'f1-score': 0.42552358582892935, 'support': 5839}, 'accuracy': 0.4066547024300335, 'macro avg': {'precision': 0.40386464225873064, 'recall': 0.3988475938154692, 'f1-score': 0.3819484659014412, 'support': 20617}, 'weighted avg': {'precision': 0.4167712284565035, 'recall': 0.4066547024300335, 'f1-score': 0.395123565591093, 'support': 20617}}
[[1099 2269 2453]
 [1159 4024 3774]
 [ 643 1935 3261]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0885779
{'0': {'precision': 0.43393300248138955, 'recall': 0.2003723861357777, 'f1-score': 0.2741524593376445, 'support': 6982}, '1': {'precision': 0.37526545908806996, 'recall': 0.4464922711058264, 'f1-score': 0.40779203149392523, 'support': 6728}, '2': {'precision': 0.3942266723476779, 'recall': 0.5358332126827856, 'f1-score': 0.45424976986805765, 'support': 6907}, 'accuracy': 0.39307367706261825, 'macro avg': {'precision': 0.40114171130571247, 'recall': 0.3942326233081299, 'f1-score': 0.3787314202332091, 'support': 20617}, 'weighted avg': {'precision': 0.4014856602791389, 'recall': 0.39307367706261825, 'f1-score': 0.378098676794162, 'support': 20617}}
[[1399 2653 2930]
 [ 967 3004 2757]
 [ 858 2348 3701]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0930355
{'0': {'precision': 0.42941341566095986, 'recall': 0.213657310431504, 'f1-score': 0.2853412905632227, 'support': 7161}, '1': {'precision': 0.34663812641651975, 'recall': 0.4360842705528275, 'f1-score': 0.38625043844265167, 'support': 6313}, '2': {'precision': 0.40111940298507465, 'recall': 0.5116897662046759, 'f1-score': 0.4497077822208551, 'support': 7143}, 'accuracy': 0.38502206916622206, 'macro avg': {'precision': 0.3923903150208514, 'recall': 0.38714378239633573, 'f1-score': 0.37376650374224313, 'support': 20617}, 'weighted avg': {'precision': 0.3942645320433628, 'recall': 0.38502206916622206, 'f1-score': 0.37318672396639985, 'support': 20617}}
[[1530 2726 2905]
 [1008 2753 2552]
 [1025 2463 3655]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0976166
{'0': {'precision': 0.4177918983320095, 'recall': 0.21672847136382364, 'f1-score': 0.28540423223005973, 'support': 7281}, '1': {'precision': 0.3218204488778055, 'recall': 0.42056379338438976, 'f1-score': 0.3646252737161828, 'support': 6137}, '2': {'precision': 0.39625850340136054, 'recall': 0.4854840950131963, 'f1-score': 0.4363568262688058, 'support': 7199}, 'accuracy': 0.3712470291507009, 'macro avg': {'precision': 0.37862361687039187, 'recall': 0.37425878658713657, 'f1-score': 0.36212877740501614, 'support': 20617}, 'weighted avg': {'precision': 0.38170538257286935, 'recall': 0.3712470291507009, 'f1-score': 0.36169502410498194, 'support': 20617}}
[[1578 2853 2850]
 [1081 2581 2475]
 [1118 2586 3495]]
training model: results/LILAK/W4/deepOF_L1/seq2seq
Epoch 1/50
254/254 - 11s - loss: 13.1994 - accuracy10: 0.3803 - accuracy20: 0.3713 - accuracy30: 0.3639 - accuracy50: 0.3550 - val_loss: 13.1948 - val_accuracy10: 0.3884 - val_accuracy20: 0.3826 - val_accuracy30: 0.3706 - val_accuracy50: 0.3566 - 11s/epoch - 43ms/step
Epoch 2/50
254/254 - 5s - loss: 13.1225 - accuracy10: 0.3988 - accuracy20: 0.3848 - accuracy30: 0.3766 - accuracy50: 0.3637 - val_loss: 13.1727 - val_accuracy10: 0.3868 - val_accuracy20: 0.3849 - val_accuracy30: 0.3721 - val_accuracy50: 0.3576 - 5s/epoch - 21ms/step
Epoch 3/50
254/254 - 5s - loss: 13.0926 - accuracy10: 0.4063 - accuracy20: 0.3919 - accuracy30: 0.3812 - accuracy50: 0.3651 - val_loss: 13.1543 - val_accuracy10: 0.3945 - val_accuracy20: 0.3875 - val_accuracy30: 0.3724 - val_accuracy50: 0.3612 - 5s/epoch - 21ms/step
Epoch 4/50
254/254 - 5s - loss: 13.0637 - accuracy10: 0.4107 - accuracy20: 0.3973 - accuracy30: 0.3852 - accuracy50: 0.3691 - val_loss: 13.1516 - val_accuracy10: 0.3965 - val_accuracy20: 0.3888 - val_accuracy30: 0.3763 - val_accuracy50: 0.3621 - 5s/epoch - 21ms/step
Epoch 5/50
254/254 - 5s - loss: 13.0490 - accuracy10: 0.4090 - accuracy20: 0.3992 - accuracy30: 0.3898 - accuracy50: 0.3732 - val_loss: 13.1364 - val_accuracy10: 0.3896 - val_accuracy20: 0.3868 - val_accuracy30: 0.3756 - val_accuracy50: 0.3642 - 5s/epoch - 21ms/step
Epoch 6/50
254/254 - 5s - loss: 13.0285 - accuracy10: 0.4136 - accuracy20: 0.4036 - accuracy30: 0.3936 - accuracy50: 0.3743 - val_loss: 13.1396 - val_accuracy10: 0.4014 - val_accuracy20: 0.3880 - val_accuracy30: 0.3743 - val_accuracy50: 0.3597 - 5s/epoch - 21ms/step
Epoch 7/50
254/254 - 5s - loss: 13.0115 - accuracy10: 0.4149 - accuracy20: 0.4055 - accuracy30: 0.3933 - accuracy50: 0.3768 - val_loss: 13.1243 - val_accuracy10: 0.3886 - val_accuracy20: 0.3881 - val_accuracy30: 0.3766 - val_accuracy50: 0.3680 - 5s/epoch - 21ms/step
Epoch 8/50
254/254 - 5s - loss: 12.9964 - accuracy10: 0.4154 - accuracy20: 0.4064 - accuracy30: 0.3962 - accuracy50: 0.3779 - val_loss: 13.1162 - val_accuracy10: 0.3983 - val_accuracy20: 0.3933 - val_accuracy30: 0.3803 - val_accuracy50: 0.3686 - 5s/epoch - 20ms/step
Epoch 9/50
254/254 - 5s - loss: 12.9874 - accuracy10: 0.4189 - accuracy20: 0.4065 - accuracy30: 0.3949 - accuracy50: 0.3782 - val_loss: 13.1381 - val_accuracy10: 0.4015 - val_accuracy20: 0.3888 - val_accuracy30: 0.3748 - val_accuracy50: 0.3620 - 5s/epoch - 20ms/step
Epoch 10/50
254/254 - 5s - loss: 12.9768 - accuracy10: 0.4183 - accuracy20: 0.4083 - accuracy30: 0.3976 - accuracy50: 0.3804 - val_loss: 13.1221 - val_accuracy10: 0.4009 - val_accuracy20: 0.3896 - val_accuracy30: 0.3790 - val_accuracy50: 0.3625 - 5s/epoch - 20ms/step
Epoch 11/50
254/254 - 5s - loss: 12.9587 - accuracy10: 0.4202 - accuracy20: 0.4123 - accuracy30: 0.3991 - accuracy50: 0.3819 - val_loss: 13.1360 - val_accuracy10: 0.3976 - val_accuracy20: 0.3905 - val_accuracy30: 0.3771 - val_accuracy50: 0.3653 - 5s/epoch - 20ms/step
Epoch 12/50
254/254 - 5s - loss: 12.9532 - accuracy10: 0.4232 - accuracy20: 0.4117 - accuracy30: 0.3990 - accuracy50: 0.3803 - val_loss: 13.1206 - val_accuracy10: 0.4061 - val_accuracy20: 0.3912 - val_accuracy30: 0.3760 - val_accuracy50: 0.3625 - 5s/epoch - 19ms/step
Epoch 13/50
254/254 - 5s - loss: 12.9412 - accuracy10: 0.4230 - accuracy20: 0.4126 - accuracy30: 0.4023 - accuracy50: 0.3818 - val_loss: 13.1199 - val_accuracy10: 0.3871 - val_accuracy20: 0.3877 - val_accuracy30: 0.3777 - val_accuracy50: 0.3638 - 5s/epoch - 20ms/step
Epoch 14/50
254/254 - 5s - loss: 12.9243 - accuracy10: 0.4247 - accuracy20: 0.4147 - accuracy30: 0.4048 - accuracy50: 0.3861 - val_loss: 13.1315 - val_accuracy10: 0.4042 - val_accuracy20: 0.3932 - val_accuracy30: 0.3783 - val_accuracy50: 0.3637 - 5s/epoch - 20ms/step
Epoch 15/50
254/254 - 5s - loss: 12.9089 - accuracy10: 0.4273 - accuracy20: 0.4178 - accuracy30: 0.4060 - accuracy50: 0.3863 - val_loss: 13.1430 - val_accuracy10: 0.4061 - val_accuracy20: 0.3904 - val_accuracy30: 0.3737 - val_accuracy50: 0.3594 - 5s/epoch - 20ms/step
Epoch 16/50
254/254 - 5s - loss: 12.8936 - accuracy10: 0.4282 - accuracy20: 0.4196 - accuracy30: 0.4075 - accuracy50: 0.3882 - val_loss: 13.1591 - val_accuracy10: 0.4084 - val_accuracy20: 0.3929 - val_accuracy30: 0.3740 - val_accuracy50: 0.3598 - 5s/epoch - 20ms/step
Epoch 17/50
254/254 - 5s - loss: 12.9014 - accuracy10: 0.4270 - accuracy20: 0.4185 - accuracy30: 0.4072 - accuracy50: 0.3877 - val_loss: 13.1479 - val_accuracy10: 0.4103 - val_accuracy20: 0.3890 - val_accuracy30: 0.3745 - val_accuracy50: 0.3587 - 5s/epoch - 20ms/step
Epoch 18/50
254/254 - 5s - loss: 12.8788 - accuracy10: 0.4301 - accuracy20: 0.4212 - accuracy30: 0.4102 - accuracy50: 0.3916 - val_loss: 13.1741 - val_accuracy10: 0.4061 - val_accuracy20: 0.3878 - val_accuracy30: 0.3726 - val_accuracy50: 0.3624 - 5s/epoch - 20ms/step
testing model: results/LILAK/W4/deepOF_L1/seq2seq
Evaluating performance on  test set...
534/534 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0949341
{'0': {'precision': 0.37327471628667824, 'recall': 0.47643489419082624, 'f1-score': 0.41859265274924756, 'support': 45979}, '1': {'precision': 0.4324557990749146, 'recall': 0.22068296126356657, 'f1-score': 0.29223690936975094, 'support': 45332}, '2': {'precision': 0.37427732487096715, 'recall': 0.452634597145945, 'f1-score': 0.4097434361585305, 'support': 45339}, 'accuracy': 0.3836955726308086, 'macro avg': {'precision': 0.39333594674418665, 'recall': 0.383250817533446, 'f1-score': 0.37352433275917635, 'support': 136650}, 'weighted avg': {'precision': 0.393239986067574, 'recall': 0.3836955726308086, 'f1-score': 0.37373957415513226, 'support': 136650}}
[[21906  6508 17565]
 [18584 10004 16744]
 [18196  6621 20522]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0814525
{'0': {'precision': 0.420889330165597, 'recall': 0.45027598110809736, 'f1-score': 0.4350870119039983, 'support': 52721}, '1': {'precision': 0.29522893252284954, 'recall': 0.21221551615742487, 'f1-score': 0.24693209458841603, 'support': 31812}, '2': {'precision': 0.41853575225248774, 'recall': 0.46080933284724757, 'f1-score': 0.43865641381577747, 'support': 52117}, 'accuracy': 0.3988730332967435, 'macro avg': {'precision': 0.37821800498031144, 'recall': 0.37443361003758996, 'f1-score': 0.37355850676939734, 'support': 136650}, 'weighted avg': {'precision': 0.39073806789037857, 'recall': 0.3988730332967435, 'f1-score': 0.3926460480532327, 'support': 136650}}
[[23739  8023 20959]
 [12655  6751 12406]
 [20008  8093 24016]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0890595
{'0': {'precision': 0.41310453548843024, 'recall': 0.4379093755402316, 'f1-score': 0.4251454572579442, 'support': 52061}, '1': {'precision': 0.2743843234177774, 'recall': 0.1873606172020975, 'f1-score': 0.22267191977077364, 'support': 33182}, '2': {'precision': 0.4071932658787518, 'recall': 0.46579259633902, 'f1-score': 0.4345261858962727, 'support': 51407}, 'accuracy': 0.3875594584705452, 'macro avg': {'precision': 0.36489404159498645, 'recall': 0.363687529693783, 'f1-score': 0.3607811876416635, 'support': 136650}, 'weighted avg': {'precision': 0.3771960487430725, 'recall': 0.3875594584705452, 'f1-score': 0.3795088542298524, 'support': 136650}}
[[22798  8200 21063]
 [13168  6217 13797]
 [19221  8241 23945]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.094615
{'0': {'precision': 0.39662408423222767, 'recall': 0.42989964286426846, 'f1-score': 0.4125920323226134, 'support': 50121}, '1': {'precision': 0.2912175220098776, 'recall': 0.18325541172337378, 'f1-score': 0.22495355626326963, 'support': 37003}, '2': {'precision': 0.38472873863039686, 'recall': 0.4586277914630699, 'f1-score': 0.41844056555980286, 'support': 49526}, 'accuracy': 0.37352360043907795, 'macro avg': {'precision': 0.35752344829083404, 'recall': 0.3572609486835707, 'f1-score': 0.3519953847152286, 'support': 136650}, 'weighted avg': {'precision': 0.3637701661335091, 'recall': 0.37352360043907795, 'f1-score': 0.3639017134604191, 'support': 136650}}
[[21547  8141 20433]
 [14330  6781 15892]
 [18449  8363 22714]]
Evaluating performance on  train set...
254/254 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0783662
{'0': {'precision': 0.3321164466910044, 'recall': 0.4092272202998847, 'f1-score': 0.36666149950912, 'support': 17340}, '1': {'precision': 0.5684943739953563, 'recall': 0.42526470489996326, 'f1-score': 0.48655775293780457, 'support': 29939}, '2': {'precision': 0.3368600037785755, 'recall': 0.40396488246955536, 'f1-score': 0.3673732196667268, 'support': 17655}, 'accuracy': 0.4151908091292697, 'macro avg': {'precision': 0.4124902748216454, 'recall': 0.4128189358898011, 'f1-score': 0.4068641573712171, 'support': 64934}, 'weighted avg': {'precision': 0.4423925157141057, 'recall': 0.4151908091292697, 'f1-score': 0.42213535528242724, 'support': 64934}}
[[ 7096  4745  5499]
 [ 8666 12732  8541]
 [ 5604  4919  7132]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0788337
{'0': {'precision': 0.38560007847368677, 'recall': 0.3778536069591964, 'f1-score': 0.38168754247985237, 'support': 20807}, '1': {'precision': 0.44441405715848487, 'recall': 0.4258199764161244, 'f1-score': 0.43491836916763316, 'support': 22897}, '2': {'precision': 0.3876846854817305, 'recall': 0.41281205840791335, 'f1-score': 0.3998540012774888, 'support': 21230}, 'accuracy': 0.40619706163181074, 'macro avg': {'precision': 0.4058996070379674, 'recall': 0.40549521392774474, 'f1-score': 0.4054866376416581, 'support': 64934}, 'weighted avg': {'precision': 0.40702059587176154, 'recall': 0.40619706163181074, 'f1-score': 0.4063972501667951, 'support': 64934}}
[[7862 5998 6947]
 [6252 9750 6895]
 [6275 6191 8764]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0837262
{'0': {'precision': 0.3905325443786982, 'recall': 0.36730112706355517, 'f1-score': 0.3785607557719189, 'support': 21383}, '1': {'precision': 0.4088011709712451, 'recall': 0.3996307408262174, 'f1-score': 0.4041639436093735, 'support': 21665}, '2': {'precision': 0.38973946878700727, 'recall': 0.42104541716165583, 'f1-score': 0.40478805183395566, 'support': 21886}, 'accuracy': 0.39620229771768256, 'macro avg': {'precision': 0.3963577280456502, 'recall': 0.3959924283504761, 'f1-score': 0.39583758373841604, 'support': 64934}, 'weighted avg': {'precision': 0.3963605011151965, 'recall': 0.39620229771768256, 'f1-score': 0.3959430773001197, 'support': 64934}}
[[7854 6160 7369]
 [5947 8658 7060]
 [6310 6361 9215]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0906765
{'0': {'precision': 0.3774015787122077, 'recall': 0.3551506657323055, 'f1-score': 0.3659381919707327, 'support': 21405}, '1': {'precision': 0.38466885115678684, 'recall': 0.35552700408388016, 'f1-score': 0.3695242637415047, 'support': 21793}, '2': {'precision': 0.3735242809038906, 'recall': 0.423582995951417, 'f1-score': 0.3969817829039561, 'support': 21736}, 'accuracy': 0.3781840022176364, 'macro avg': {'precision': 0.3785315702576284, 'recall': 0.37808688858920086, 'f1-score': 0.3774814128720645, 'support': 64934}, 'weighted avg': {'precision': 0.37854271776452436, 'recall': 0.3781840022176364, 'f1-score': 0.3775332693512264, 'support': 64934}}
[[7602 6150 7653]
 [6256 7748 7789]
 [6285 6244 9207]]
Evaluating performance on  val set...
81/81 - 1s - 656ms/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0878549
{'0': {'precision': 0.32782101167315175, 'recall': 0.40700483091787437, 'f1-score': 0.3631465517241379, 'support': 5796}, '1': {'precision': 0.5435393258426966, 'recall': 0.3875598086124402, 'f1-score': 0.45248457291328353, 'support': 8987}, '2': {'precision': 0.32943525385054195, 'recall': 0.3960226298645637, 'f1-score': 0.3596730245231608, 'support': 5833}, 'accuracy': 0.3954210322079938, 'macro avg': {'precision': 0.4002651971221301, 'recall': 0.39686242313162606, 'f1-score': 0.3917680497201941, 'support': 20616}, 'weighted avg': {'precision': 0.4223144325143633, 'recall': 0.3954210322079938, 'f1-score': 0.40110831502756983, 'support': 20616}}
[[2359 1489 1948]
 [2750 3483 2754]
 [2087 1436 2310]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0862364
{'0': {'precision': 0.38077203204661325, 'recall': 0.37584471603163194, 'f1-score': 0.3782923299565847, 'support': 6955}, '1': {'precision': 0.4090328758378551, 'recall': 0.3811719214753123, 'f1-score': 0.39461123941493453, 'support': 6724}, '2': {'precision': 0.3730126920507682, 'recall': 0.40247945797895346, 'f1-score': 0.38718624323949524, 'support': 6937}, 'accuracy': 0.3865444315095072, 'macro avg': {'precision': 0.38760586664507884, 'recall': 0.3864986984952992, 'f1-score': 0.38669660420367147, 'support': 20616}, 'weighted avg': {'precision': 0.3873785207981234, 'recall': 0.3865444315095072, 'f1-score': 0.3866074940835489, 'support': 20616}}
[[2614 1879 2462]
 [1930 2563 2231]
 [2321 1824 2792]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0912595
{'0': {'precision': 0.38304529201430276, 'recall': 0.35827759197324416, 'f1-score': 0.37024769585253453, 'support': 7176}, '1': {'precision': 0.3662320514936458, 'recall': 0.35267005721551176, 'f1-score': 0.3593231317302242, 'support': 6292}, '2': {'precision': 0.3751434034416826, 'recall': 0.411723559037493, 'f1-score': 0.39258320549589815, 'support': 7148}, 'accuracy': 0.37509701202949164, 'macro avg': {'precision': 0.37480691564987706, 'recall': 0.3742237360754163, 'f1-score': 0.3740513443595523, 'support': 20616}, 'weighted avg': {'precision': 0.3751741429614767, 'recall': 0.37509701202949164, 'f1-score': 0.3746577106698214, 'support': 20616}}
[[2571 1938 2667]
 [1838 2219 2235]
 [2303 1902 2943]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0962622
{'0': {'precision': 0.3798112924966302, 'recall': 0.3481125600549073, 'f1-score': 0.3632717375734135, 'support': 7285}, '1': {'precision': 0.33671016483516486, 'recall': 0.31901740686513747, 'f1-score': 0.3276250939771113, 'support': 6147}, '2': {'precision': 0.3731361675908811, 'recall': 0.4214922048997773, 'f1-score': 0.39584286554676773, 'support': 7184}, 'accuracy': 0.3650077609623593, 'macro avg': {'precision': 0.3632192083075587, 'recall': 0.36287405727327404, 'f1-score': 0.36224656569909747, 'support': 20616}, 'weighted avg': {'precision': 0.3646339191430248, 'recall': 0.3650077609623593, 'f1-score': 0.363993073680035, 'support': 20616}}
[[2536 1963 2786]
 [1885 1961 2301]
 [2256 1900 3028]]
training model: results/LILAK/W4/deepLOB_L2/seq2seq
Epoch 1/50
254/254 - 17s - loss: 13.3040 - accuracy10: 0.3734 - accuracy20: 0.3590 - accuracy30: 0.3543 - accuracy50: 0.3529 - val_loss: 13.6323 - val_accuracy10: 0.3287 - val_accuracy20: 0.3387 - val_accuracy30: 0.3423 - val_accuracy50: 0.3416 - 17s/epoch - 69ms/step
Epoch 2/50
254/254 - 12s - loss: 13.1587 - accuracy10: 0.3758 - accuracy20: 0.3707 - accuracy30: 0.3663 - accuracy50: 0.3636 - val_loss: 13.6160 - val_accuracy10: 0.4007 - val_accuracy20: 0.3340 - val_accuracy30: 0.3204 - val_accuracy50: 0.3148 - 12s/epoch - 46ms/step
Epoch 3/50
254/254 - 12s - loss: 13.0871 - accuracy10: 0.3884 - accuracy20: 0.3882 - accuracy30: 0.3823 - accuracy50: 0.3801 - val_loss: 13.5644 - val_accuracy10: 0.4045 - val_accuracy20: 0.3425 - val_accuracy30: 0.3279 - val_accuracy50: 0.3209 - 12s/epoch - 46ms/step
Epoch 4/50
254/254 - 12s - loss: 13.0107 - accuracy10: 0.3973 - accuracy20: 0.4002 - accuracy30: 0.3945 - accuracy50: 0.3895 - val_loss: 13.3817 - val_accuracy10: 0.3780 - val_accuracy20: 0.3469 - val_accuracy30: 0.3370 - val_accuracy50: 0.3326 - 12s/epoch - 46ms/step
Epoch 5/50
254/254 - 12s - loss: 12.9739 - accuracy10: 0.4063 - accuracy20: 0.4084 - accuracy30: 0.4050 - accuracy50: 0.3952 - val_loss: 13.4376 - val_accuracy10: 0.3922 - val_accuracy20: 0.3500 - val_accuracy30: 0.3369 - val_accuracy50: 0.3306 - 12s/epoch - 46ms/step
Epoch 6/50
254/254 - 12s - loss: 12.8856 - accuracy10: 0.4136 - accuracy20: 0.4204 - accuracy30: 0.4180 - accuracy50: 0.4068 - val_loss: 13.4656 - val_accuracy10: 0.3930 - val_accuracy20: 0.3534 - val_accuracy30: 0.3411 - val_accuracy50: 0.3333 - 12s/epoch - 46ms/step
Epoch 7/50
254/254 - 12s - loss: 12.8042 - accuracy10: 0.4241 - accuracy20: 0.4318 - accuracy30: 0.4271 - accuracy50: 0.4130 - val_loss: 13.4826 - val_accuracy10: 0.3921 - val_accuracy20: 0.3582 - val_accuracy30: 0.3401 - val_accuracy50: 0.3308 - 12s/epoch - 46ms/step
Epoch 8/50
254/254 - 12s - loss: 12.7623 - accuracy10: 0.4324 - accuracy20: 0.4356 - accuracy30: 0.4299 - accuracy50: 0.4158 - val_loss: 13.4822 - val_accuracy10: 0.3876 - val_accuracy20: 0.3556 - val_accuracy30: 0.3433 - val_accuracy50: 0.3321 - 12s/epoch - 46ms/step
Epoch 9/50
254/254 - 12s - loss: 12.7066 - accuracy10: 0.4406 - accuracy20: 0.4452 - accuracy30: 0.4385 - accuracy50: 0.4236 - val_loss: 13.4020 - val_accuracy10: 0.3824 - val_accuracy20: 0.3813 - val_accuracy30: 0.3701 - val_accuracy50: 0.3602 - 12s/epoch - 46ms/step
Epoch 10/50
254/254 - 12s - loss: 12.6545 - accuracy10: 0.4452 - accuracy20: 0.4515 - accuracy30: 0.4446 - accuracy50: 0.4265 - val_loss: 13.3196 - val_accuracy10: 0.3753 - val_accuracy20: 0.3806 - val_accuracy30: 0.3711 - val_accuracy50: 0.3637 - 12s/epoch - 46ms/step
Epoch 11/50
254/254 - 12s - loss: 12.6034 - accuracy10: 0.4517 - accuracy20: 0.4582 - accuracy30: 0.4485 - accuracy50: 0.4309 - val_loss: 13.3473 - val_accuracy10: 0.3817 - val_accuracy20: 0.3802 - val_accuracy30: 0.3702 - val_accuracy50: 0.3599 - 12s/epoch - 46ms/step
Epoch 12/50
254/254 - 12s - loss: 12.5433 - accuracy10: 0.4559 - accuracy20: 0.4619 - accuracy30: 0.4541 - accuracy50: 0.4344 - val_loss: 13.2038 - val_accuracy10: 0.3588 - val_accuracy20: 0.3818 - val_accuracy30: 0.3814 - val_accuracy50: 0.3711 - 12s/epoch - 46ms/step
Epoch 13/50
254/254 - 12s - loss: 12.4987 - accuracy10: 0.4608 - accuracy20: 0.4683 - accuracy30: 0.4584 - accuracy50: 0.4365 - val_loss: 13.2843 - val_accuracy10: 0.3630 - val_accuracy20: 0.3818 - val_accuracy30: 0.3787 - val_accuracy50: 0.3656 - 12s/epoch - 46ms/step
Epoch 14/50
254/254 - 12s - loss: 12.4511 - accuracy10: 0.4641 - accuracy20: 0.4708 - accuracy30: 0.4621 - accuracy50: 0.4393 - val_loss: 13.2666 - val_accuracy10: 0.3653 - val_accuracy20: 0.3914 - val_accuracy30: 0.3856 - val_accuracy50: 0.3728 - 12s/epoch - 46ms/step
Epoch 15/50
254/254 - 12s - loss: 12.3864 - accuracy10: 0.4668 - accuracy20: 0.4768 - accuracy30: 0.4701 - accuracy50: 0.4481 - val_loss: 13.3451 - val_accuracy10: 0.3534 - val_accuracy20: 0.3831 - val_accuracy30: 0.3848 - val_accuracy50: 0.3775 - 12s/epoch - 48ms/step
Epoch 16/50
254/254 - 12s - loss: 12.3541 - accuracy10: 0.4689 - accuracy20: 0.4799 - accuracy30: 0.4720 - accuracy50: 0.4502 - val_loss: 13.3391 - val_accuracy10: 0.3693 - val_accuracy20: 0.3870 - val_accuracy30: 0.3826 - val_accuracy50: 0.3754 - 12s/epoch - 46ms/step
Epoch 17/50
254/254 - 12s - loss: 12.3055 - accuracy10: 0.4729 - accuracy20: 0.4834 - accuracy30: 0.4762 - accuracy50: 0.4537 - val_loss: 13.3713 - val_accuracy10: 0.3744 - val_accuracy20: 0.3833 - val_accuracy30: 0.3797 - val_accuracy50: 0.3712 - 12s/epoch - 46ms/step
Epoch 18/50
254/254 - 12s - loss: 12.2429 - accuracy10: 0.4801 - accuracy20: 0.4880 - accuracy30: 0.4804 - accuracy50: 0.4566 - val_loss: 13.3928 - val_accuracy10: 0.3761 - val_accuracy20: 0.3850 - val_accuracy30: 0.3826 - val_accuracy50: 0.3675 - 12s/epoch - 46ms/step
Epoch 19/50
254/254 - 12s - loss: 12.2030 - accuracy10: 0.4831 - accuracy20: 0.4943 - accuracy30: 0.4859 - accuracy50: 0.4616 - val_loss: 13.4899 - val_accuracy10: 0.3515 - val_accuracy20: 0.3801 - val_accuracy30: 0.3804 - val_accuracy50: 0.3763 - 12s/epoch - 46ms/step
Epoch 20/50
254/254 - 12s - loss: 12.1534 - accuracy10: 0.4826 - accuracy20: 0.4955 - accuracy30: 0.4886 - accuracy50: 0.4643 - val_loss: 13.3936 - val_accuracy10: 0.3557 - val_accuracy20: 0.3855 - val_accuracy30: 0.3830 - val_accuracy50: 0.3771 - 12s/epoch - 46ms/step
Epoch 21/50
254/254 - 12s - loss: 12.0973 - accuracy10: 0.4900 - accuracy20: 0.5023 - accuracy30: 0.4956 - accuracy50: 0.4679 - val_loss: 13.6429 - val_accuracy10: 0.3495 - val_accuracy20: 0.3792 - val_accuracy30: 0.3788 - val_accuracy50: 0.3736 - 12s/epoch - 46ms/step
Epoch 22/50
254/254 - 12s - loss: 12.0336 - accuracy10: 0.4954 - accuracy20: 0.5077 - accuracy30: 0.4994 - accuracy50: 0.4711 - val_loss: 13.6261 - val_accuracy10: 0.3582 - val_accuracy20: 0.3823 - val_accuracy30: 0.3816 - val_accuracy50: 0.3706 - 12s/epoch - 46ms/step
testing model: results/LILAK/W4/deepLOB_L2/seq2seq
Evaluating performance on  test set...
534/534 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1023145
{'0': {'precision': 0.4354548548645889, 'recall': 0.3895522063460995, 'f1-score': 0.4112265396315216, 'support': 45981}, '1': {'precision': 0.3637323646194137, 'recall': 0.18995411629753817, 'f1-score': 0.24957250094194708, 'support': 45332}, '2': {'precision': 0.3836260891350945, 'recall': 0.607882490461172, 'f1-score': 0.470393473678821, 'support': 45341}, 'accuracy': 0.39578058454198195, 'macro avg': {'precision': 0.39427110287303235, 'recall': 0.39579627103493653, 'f1-score': 0.37706417141742987, 'support': 136654}, 'weighted avg': {'precision': 0.39446599252074754, 'recall': 0.39578058454198195, 'f1-score': 0.3772325626880206, 'support': 136654}}
[[17912  7290 20779]
 [13216  8611 23505]
 [10006  7773 27562]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0820997
{'0': {'precision': 0.48522550544323484, 'recall': 0.37873413880090284, 'f1-score': 0.4254167776298269, 'support': 52723}, '1': {'precision': 0.2559276164317163, 'recall': 0.1991701244813278, 'f1-score': 0.2240096165744489, 'support': 31812}, '2': {'precision': 0.4320022616439324, 'recall': 0.5863888409217368, 'f1-score': 0.49749316317228803, 'support': 52119}, 'accuracy': 0.4161312511891346, 'macro avg': {'precision': 0.39105179450629457, 'recall': 0.3880977014013225, 'f1-score': 0.38230651912552127, 'support': 136654}, 'weighted avg': {'precision': 0.4115477009968939, 'recall': 0.4161312511891346, 'f1-score': 0.40602023256414166, 'support': 136654}}
[[19968  8848 23907]
 [ 9200  6336 16276]
 [11984  9573 30562]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0881622
{'0': {'precision': 0.47078879914881266, 'recall': 0.37394360786724035, 'f1-score': 0.41681474662270657, 'support': 52064}, '1': {'precision': 0.2515826494724502, 'recall': 0.19402085468024832, 'f1-score': 0.2190839175117403, 'support': 33182}, '2': {'precision': 0.4180605365083919, 'recall': 0.5668962029256147, 'f1-score': 0.48123317756237716, 'support': 51408}, 'accuracy': 0.4028422146442841, 'macro avg': {'precision': 0.3801439950432182, 'recall': 0.3782868884910345, 'f1-score': 0.372377280565608, 'support': 136654}, 'weighted avg': {'precision': 0.3977257861058003, 'recall': 0.4028422146442841, 'f1-score': 0.3930358475504987, 'support': 136654}}
[[19469  9182 23413]
 [ 9590  6438 17154]
 [12295  9970 29143]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0967939
{'0': {'precision': 0.4418386941910706, 'recall': 0.36722927140691086, 'f1-score': 0.40109387257038265, 'support': 50124}, '1': {'precision': 0.276748697272831, 'recall': 0.19663270545631437, 'f1-score': 0.2299112080133978, 'support': 37003}, '2': {'precision': 0.3984978821885507, 'recall': 0.55278938760676, 'f1-score': 0.46313118497843186, 'support': 49527}, 'accuracy': 0.38828720710700015, 'macro avg': {'precision': 0.37236175788415077, 'recall': 0.37221712148999514, 'f1-score': 0.3647120885207375, 'support': 136654}, 'weighted avg': {'precision': 0.38142798135416556, 'recall': 0.38828720710700015, 'f1-score': 0.37722519572983165, 'support': 136654}}
[[18407  9228 22489]
 [10891  7276 18836]
 [12362  9787 27378]]
Evaluating performance on  train set...
254/254 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0890521
{'0': {'precision': 0.3777634339196385, 'recall': 0.407342961545154, 'f1-score': 0.39199598124581375, 'support': 17241}, '1': {'precision': 0.584085142373837, 'recall': 0.2759849468811403, 'f1-score': 0.37485016397150284, 'support': 30027}, '2': {'precision': 0.3413253723917032, 'recall': 0.6212361331220285, 'f1-score': 0.4405820371299548, 'support': 17668}, 'accuracy': 0.404798570900579, 'macro avg': {'precision': 0.43439131622839294, 'recall': 0.43485468051610754, 'f1-score': 0.40247606078242376, 'support': 64936}, 'weighted avg': {'precision': 0.46325429058895384, 'recall': 0.404798570900579, 'f1-score': 0.39728705214739796, 'support': 64936}}
[[ 7023  3148  7070]
 [ 7629  8287 14111]
 [ 3939  2753 10976]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0665032
{'0': {'precision': 0.4337362400172674, 'recall': 0.388609553277896, 'f1-score': 0.4099347205222358, 'support': 20684}, '1': {'precision': 0.4746580321152448, 'recall': 0.31295747647263855, 'f1-score': 0.37720887488512544, 'support': 22952}, '2': {'precision': 0.4026414249624253, 'recall': 0.5911267605633803, 'f1-score': 0.47900933975005233, 'support': 21300}, 'accuracy': 0.428298632499692, 'macro avg': {'precision': 0.43701189903164583, 'recall': 0.4308979301046383, 'f1-score': 0.4220509783858046, 'support': 64936}, 'weighted avg': {'precision': 0.43800070674704195, 'recall': 0.428298632499692, 'f1-score': 0.4210251138401108, 'support': 64936}}
[[ 8038  4155  8491]
 [ 5580  7183 10189]
 [ 4914  3795 12591]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0673522
{'0': {'precision': 0.4350892421201107, 'recall': 0.3758552816571375, 'f1-score': 0.403308943702698, 'support': 21338}, '1': {'precision': 0.43979122654405367, 'recall': 0.3267322162212067, 'f1-score': 0.3749238551791721, 'support': 21663}, '2': {'precision': 0.4090894143181295, 'recall': 0.5671301572828812, 'f1-score': 0.47531713281369403, 'support': 21935}, 'accuracy': 0.424079093261057, 'macro avg': {'precision': 0.427989960994098, 'recall': 0.42323921838707507, 'f1-score': 0.4178499772318547, 'support': 64936}, 'weighted avg': {'precision': 0.4278752601338383, 'recall': 0.424079093261057, 'f1-score': 0.4181634690116877, 'support': 64936}}
[[ 8020  4657  8661]
 [ 5277  7078  9308]
 [ 5136  4359 12440]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0800978
{'0': {'precision': 0.4166848776223776, 'recall': 0.3573871889789607, 'f1-score': 0.3847647874889646, 'support': 21341}, '1': {'precision': 0.41745966073645013, 'recall': 0.3234714907258988, 'f1-score': 0.36450430923259536, 'support': 21835}, '2': {'precision': 0.39558442432605256, 'recall': 0.5401654411764706, 'f1-score': 0.45670545723000405, 'support': 21760}, 'accuracy': 0.4072317358630036, 'macro avg': {'precision': 0.40990965422829345, 'recall': 0.40700804029377674, 'f1-score': 0.4019915179838547, 'support': 64936}, 'weighted avg': {'precision': 0.4098746571832951, 'recall': 0.4072317358630036, 'f1-score': 0.4020593764817759, 'support': 64936}}
[[ 7627  5094  8620]
 [ 5433  7063  9339]
 [ 5244  4762 11754]]
Evaluating performance on  val set...
81/81 - 1s - 1s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1152593
{'0': {'precision': 0.335302079488126, 'recall': 0.4681326232606081, 'f1-score': 0.3907370232291368, 'support': 5821}, '1': {'precision': 0.4681025081788441, 'recall': 0.19169364742659373, 'f1-score': 0.272, 'support': 8957}, '2': {'precision': 0.33609158920879617, 'recall': 0.5077924302106525, 'f1-score': 0.40447445603983356, 'support': 5839}, 'accuracy': 0.35926662463015957, 'macro avg': {'precision': 0.3798320589585888, 'recall': 0.3892062336326181, 'f1-score': 0.3557371597563234, 'support': 20617}, 'weighted avg': {'precision': 0.3932204665978779, 'recall': 0.35926662463015957, 'f1-score': 0.3430426619310954, 'support': 20617}}
[[2725  966 2130]
 [3513 1717 3727]
 [1889  985 2965]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0977653
{'0': {'precision': 0.38391984359726294, 'recall': 0.45001432254368373, 'f1-score': 0.41434788342344714, 'support': 6982}, '1': {'precision': 0.35955920041004613, 'recall': 0.20853151010701546, 'f1-score': 0.26396989651928504, 'support': 6728}, '2': {'precision': 0.38717618098698864, 'recall': 0.47821051107572027, 'f1-score': 0.42790516906335013, 'support': 6907}, 'accuracy': 0.38065673958383855, 'macro avg': {'precision': 0.37688507499809926, 'recall': 0.3789187812421398, 'f1-score': 0.36874098300202746, 'support': 20617}, 'weighted avg': {'precision': 0.3770610918383863, 'recall': 0.38065673958383855, 'f1-score': 0.3698165294933704, 'support': 20617}}
[[3142 1256 2584]
 [2681 1403 2644]
 [2361 1243 3303]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0971284
{'0': {'precision': 0.38850491087668243, 'recall': 0.4474235441977377, 'f1-score': 0.4158878504672897, 'support': 7161}, '1': {'precision': 0.33886960832920177, 'recall': 0.2165373039759227, 'f1-score': 0.26423117811926167, 'support': 6313}, '2': {'precision': 0.39239443378119004, 'recall': 0.45793084138317236, 'f1-score': 0.4226371212610634, 'support': 7143}, 'accuracy': 0.3803657176116797, 'macro avg': {'precision': 0.37325631766235806, 'recall': 0.37396389651894424, 'f1-score': 0.36758538328253826, 'support': 20617}, 'weighted avg': {'precision': 0.3746539721913574, 'recall': 0.3803657176116797, 'f1-score': 0.37178839219241094, 'support': 20617}}
[[3204 1301 2656]
 [2537 1367 2409]
 [2506 1366 3271]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0993867
{'0': {'precision': 0.38743833473709544, 'recall': 0.442246944101085, 'f1-score': 0.4130323242688559, 'support': 7281}, '1': {'precision': 0.3216190014541929, 'recall': 0.21622942805931236, 'f1-score': 0.2585988502387216, 'support': 6137}, '2': {'precision': 0.3831295843520782, 'recall': 0.4353382414224198, 'f1-score': 0.4075687625983484, 'support': 7199}, 'accuracy': 0.3725566280254159, 'macro avg': {'precision': 0.3640623068477889, 'recall': 0.3646048711942724, 'f1-score': 0.3597333123686419, 'support': 20617}, 'weighted avg': {'precision': 0.3663415727261864, 'recall': 0.3725566280254159, 'f1-score': 0.3651548246040687, 'support': 20617}}
[[3220 1365 2696]
 [2460 1327 2350]
 [2631 1434 3134]]
training model: results/LILAK/W4/deepOF_L2/seq2seq
Epoch 1/50
254/254 - 13s - loss: 13.2379 - accuracy10: 0.3696 - accuracy20: 0.3695 - accuracy30: 0.3598 - accuracy50: 0.3539 - val_loss: 13.2736 - val_accuracy10: 0.3880 - val_accuracy20: 0.3645 - val_accuracy30: 0.3521 - val_accuracy50: 0.3391 - 13s/epoch - 50ms/step
Epoch 2/50
254/254 - 7s - loss: 13.0981 - accuracy10: 0.3982 - accuracy20: 0.3879 - accuracy30: 0.3793 - accuracy50: 0.3639 - val_loss: 13.2246 - val_accuracy10: 0.3970 - val_accuracy20: 0.3810 - val_accuracy30: 0.3643 - val_accuracy50: 0.3513 - 7s/epoch - 29ms/step
Epoch 3/50
254/254 - 7s - loss: 12.9995 - accuracy10: 0.4161 - accuracy20: 0.4079 - accuracy30: 0.3937 - accuracy50: 0.3769 - val_loss: 13.1507 - val_accuracy10: 0.4026 - val_accuracy20: 0.3948 - val_accuracy30: 0.3827 - val_accuracy50: 0.3625 - 7s/epoch - 29ms/step
Epoch 4/50
254/254 - 7s - loss: 12.9096 - accuracy10: 0.4321 - accuracy20: 0.4216 - accuracy30: 0.4089 - accuracy50: 0.3854 - val_loss: 13.1042 - val_accuracy10: 0.4117 - val_accuracy20: 0.4048 - val_accuracy30: 0.3913 - val_accuracy50: 0.3752 - 7s/epoch - 28ms/step
Epoch 5/50
254/254 - 7s - loss: 12.8175 - accuracy10: 0.4455 - accuracy20: 0.4348 - accuracy30: 0.4208 - accuracy50: 0.3966 - val_loss: 13.0578 - val_accuracy10: 0.4240 - val_accuracy20: 0.4140 - val_accuracy30: 0.4004 - val_accuracy50: 0.3812 - 7s/epoch - 29ms/step
Epoch 6/50
254/254 - 7s - loss: 12.7455 - accuracy10: 0.4567 - accuracy20: 0.4451 - accuracy30: 0.4302 - accuracy50: 0.4033 - val_loss: 13.0260 - val_accuracy10: 0.4217 - val_accuracy20: 0.4185 - val_accuracy30: 0.4075 - val_accuracy50: 0.3898 - 7s/epoch - 29ms/step
Epoch 7/50
254/254 - 7s - loss: 12.6679 - accuracy10: 0.4641 - accuracy20: 0.4541 - accuracy30: 0.4407 - accuracy50: 0.4125 - val_loss: 13.0518 - val_accuracy10: 0.4189 - val_accuracy20: 0.4171 - val_accuracy30: 0.4079 - val_accuracy50: 0.3918 - 7s/epoch - 29ms/step
Epoch 8/50
254/254 - 7s - loss: 12.5998 - accuracy10: 0.4714 - accuracy20: 0.4633 - accuracy30: 0.4475 - accuracy50: 0.4181 - val_loss: 13.0374 - val_accuracy10: 0.4148 - val_accuracy20: 0.4228 - val_accuracy30: 0.4122 - val_accuracy50: 0.3939 - 7s/epoch - 28ms/step
Epoch 9/50
254/254 - 7s - loss: 12.5374 - accuracy10: 0.4746 - accuracy20: 0.4685 - accuracy30: 0.4550 - accuracy50: 0.4233 - val_loss: 13.0303 - val_accuracy10: 0.4180 - val_accuracy20: 0.4263 - val_accuracy30: 0.4133 - val_accuracy50: 0.3946 - 7s/epoch - 29ms/step
Epoch 10/50
254/254 - 7s - loss: 12.4744 - accuracy10: 0.4767 - accuracy20: 0.4744 - accuracy30: 0.4595 - accuracy50: 0.4307 - val_loss: 13.0420 - val_accuracy10: 0.4111 - val_accuracy20: 0.4273 - val_accuracy30: 0.4158 - val_accuracy50: 0.3985 - 7s/epoch - 28ms/step
Epoch 11/50
254/254 - 7s - loss: 12.4064 - accuracy10: 0.4783 - accuracy20: 0.4809 - accuracy30: 0.4671 - accuracy50: 0.4377 - val_loss: 13.0430 - val_accuracy10: 0.4141 - val_accuracy20: 0.4271 - val_accuracy30: 0.4112 - val_accuracy50: 0.3956 - 7s/epoch - 29ms/step
Epoch 12/50
254/254 - 7s - loss: 12.3432 - accuracy10: 0.4836 - accuracy20: 0.4873 - accuracy30: 0.4742 - accuracy50: 0.4450 - val_loss: 13.0673 - val_accuracy10: 0.4060 - val_accuracy20: 0.4269 - val_accuracy30: 0.4156 - val_accuracy50: 0.4000 - 7s/epoch - 29ms/step
Epoch 13/50
254/254 - 7s - loss: 12.2908 - accuracy10: 0.4858 - accuracy20: 0.4905 - accuracy30: 0.4785 - accuracy50: 0.4488 - val_loss: 13.0630 - val_accuracy10: 0.4049 - val_accuracy20: 0.4261 - val_accuracy30: 0.4149 - val_accuracy50: 0.4009 - 7s/epoch - 29ms/step
Epoch 14/50
254/254 - 7s - loss: 12.2233 - accuracy10: 0.4861 - accuracy20: 0.4963 - accuracy30: 0.4848 - accuracy50: 0.4561 - val_loss: 13.0857 - val_accuracy10: 0.4073 - val_accuracy20: 0.4265 - val_accuracy30: 0.4164 - val_accuracy50: 0.3992 - 7s/epoch - 29ms/step
Epoch 15/50
254/254 - 7s - loss: 12.1533 - accuracy10: 0.4876 - accuracy20: 0.4990 - accuracy30: 0.4895 - accuracy50: 0.4608 - val_loss: 13.1556 - val_accuracy10: 0.4006 - val_accuracy20: 0.4226 - val_accuracy30: 0.4127 - val_accuracy50: 0.3972 - 7s/epoch - 28ms/step
Epoch 16/50
254/254 - 7s - loss: 12.0794 - accuracy10: 0.4915 - accuracy20: 0.5065 - accuracy30: 0.4978 - accuracy50: 0.4685 - val_loss: 13.1867 - val_accuracy10: 0.4019 - val_accuracy20: 0.4237 - val_accuracy30: 0.4147 - val_accuracy50: 0.3995 - 7s/epoch - 28ms/step
testing model: results/LILAK/W4/deepOF_L2/seq2seq
Evaluating performance on  test set...
534/534 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0638031
{'0': {'precision': 0.43785003265322275, 'recall': 0.48119793818917334, 'f1-score': 0.45850170966739195, 'support': 45979}, '1': {'precision': 0.4489790130459444, 'recall': 0.34922350657372275, 'f1-score': 0.39286777843954734, 'support': 45332}, '2': {'precision': 0.4438152539373562, 'recall': 0.4978495335141931, 'f1-score': 0.4692821056570822, 'support': 45339}, 'accuracy': 0.4429418221734358, 'macro avg': {'precision': 0.4435480998788412, 'recall': 0.44275699275902974, 'f1-score': 0.4402171979213405, 'support': 136650}, 'weighted avg': {'precision': 0.44352113478980665, 'recall': 0.4429418221734358, 'f1-score': 0.4403052589052691, 'support': 136650}}
[[22125 10163 13691]
 [14905 15831 14596]
 [13501  9266 22572]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.058481
{'0': {'precision': 0.48261397937982675, 'recall': 0.4670245253314618, 'f1-score': 0.47469129257077863, 'support': 52721}, '1': {'precision': 0.3218042071197411, 'recall': 0.3500880171004652, 'f1-score': 0.335350797952424, 'support': 31812}, '2': {'precision': 0.48649655064283476, 'recall': 0.4762937237369764, 'f1-score': 0.4813410767783908, 'support': 52117}, 'accuracy': 0.4433369923161361, 'macro avg': {'precision': 0.4303049123808009, 'recall': 0.4311354220563011, 'f1-score': 0.4304610557671978, 'support': 136650}, 'weighted avg': {'precision': 0.44665838107303085, 'recall': 0.4433369923161361, 'f1-score': 0.4447891117346939, 'support': 136650}}
[[24622 12209 15890]
 [10364 11137 10311]
 [16032 11262 24823]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0753466
{'0': {'precision': 0.46160064672594986, 'recall': 0.46065192754653195, 'f1-score': 0.46112579916358215, 'support': 52061}, '1': {'precision': 0.3029813701743369, 'recall': 0.3053462720752215, 'f1-score': 0.3041592242919112, 'support': 33182}, '2': {'precision': 0.4584333235781875, 'recall': 0.45707782986752776, 'f1-score': 0.45775457325982355, 'support': 51407}, 'accuracy': 0.42159531650201243, 'macro avg': {'precision': 0.4076717801594914, 'recall': 0.40769200982976045, 'f1-score': 0.4076798655717723, 'support': 136650}, 'weighted avg': {'precision': 0.42189243292724776, 'recall': 0.42159531650201243, 'f1-score': 0.4217421950843556, 'support': 136650}}
[[23982 12094 15985]
 [11277 10132 11773]
 [16695 11215 23497]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0907793
{'0': {'precision': 0.42322660700520787, 'recall': 0.44913309790307454, 'f1-score': 0.4357951795566741, 'support': 50121}, '1': {'precision': 0.3099375213701781, 'recall': 0.2694646380023241, 'f1-score': 0.2882875068667418, 'support': 37003}, '2': {'precision': 0.42347436147397155, 'recall': 0.43855752534022535, 'f1-score': 0.43088398666878275, 'support': 49526}, 'accuracy': 0.3966483717526528, 'macro avg': {'precision': 0.3855461632831192, 'recall': 0.385718420415208, 'f1-score': 0.38498889103073286, 'support': 136650}, 'weighted avg': {'precision': 0.39263922502252935, 'recall': 0.3966483717526528, 'f1-score': 0.39407210490236544, 'support': 136650}}
[[22511 11526 16084]
 [13546  9971 13486]
 [17132 10674 21720]]
Evaluating performance on  train set...
254/254 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0550457
{'0': {'precision': 0.39682623925273325, 'recall': 0.431199538638985, 'f1-score': 0.41329943065612734, 'support': 17340}, '1': {'precision': 0.6141994995338796, 'recall': 0.4181168375697251, 'f1-score': 0.4975357710651829, 'support': 29939}, '2': {'precision': 0.3792540157909066, 'recall': 0.5523081280090626, 'f1-score': 0.44970714384540883, 'support': 17655}, 'accuracy': 0.45809591277296946, 'macro avg': {'precision': 0.46342658485917315, 'recall': 0.46720816807259097, 'f1-score': 0.45351411518890633, 'support': 64934}, 'weighted avg': {'precision': 0.492272391258442, 'recall': 0.45809591277296946, 'f1-score': 0.46203707152013507, 'support': 64934}}
[[ 7477  4063  5800]
 [ 7261 12518 10160]
 [ 4104  3800  9751]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0482366
{'0': {'precision': 0.45090622537431047, 'recall': 0.4125054068342385, 'f1-score': 0.43085186486622157, 'support': 20807}, '1': {'precision': 0.4902951475737869, 'recall': 0.42804734244660875, 'f1-score': 0.4570615804322989, 'support': 22897}, '2': {'precision': 0.43309274769385153, 'recall': 0.5285445124823364, 'f1-score': 0.4760813763550351, 'support': 21230}, 'accuracy': 0.4559244771614254, 'macro avg': {'precision': 0.4580980402139829, 'recall': 0.4563657539210612, 'f1-score': 0.45466494055118517, 'support': 64934}, 'weighted avg': {'precision': 0.45897146115903453, 'recall': 0.4559244771614254, 'f1-score': 0.45488159330161726, 'support': 64934}}
[[ 8583  5186  7038]
 [ 5446  9801  7650]
 [ 5006  5003 11221]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.057773
{'0': {'precision': 0.44535966438145913, 'recall': 0.40709909741383343, 'f1-score': 0.4253707640059616, 'support': 21383}, '1': {'precision': 0.45635227918021787, 'recall': 0.40803138702977154, 'f1-score': 0.43084121259382013, 'support': 21665}, '2': {'precision': 0.43156397739939273, 'recall': 0.5130220232111853, 'f1-score': 0.4687806609189404, 'support': 21886}, 'accuracy': 0.44311146702805926, 'macro avg': {'precision': 0.4444253069870232, 'recall': 0.44271750255159675, 'f1-score': 0.4416642125062407, 'support': 64934}, 'weighted avg': {'precision': 0.4443774762261877, 'recall': 0.44311146702805926, 'f1-score': 0.44182726248893517, 'support': 64934}}
[[ 8705  5314  7364]
 [ 5400  8840  7425]
 [ 5441  5217 11228]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0755314
{'0': {'precision': 0.41805272826572665, 'recall': 0.39336603597290354, 'f1-score': 0.4053338468203919, 'support': 21405}, '1': {'precision': 0.4239719477207523, 'recall': 0.36617262423714037, 'f1-score': 0.39295826665025235, 'support': 21793}, '2': {'precision': 0.40826306264679835, 'recall': 0.4878082443871918, 'f1-score': 0.4445049992663551, 'support': 21736}, 'accuracy': 0.41585301998952784, 'macro avg': {'precision': 0.4167625795444258, 'recall': 0.41578230153241186, 'f1-score': 0.4142657042456664, 'support': 64934}, 'weighted avg': {'precision': 0.41676233151965136, 'recall': 0.41585301998952784, 'f1-score': 0.4142925302669315, 'support': 64934}}
[[ 8420  5488  7497]
 [ 5942  7980  7871]
 [ 5779  5354 10603]]
Evaluating performance on  val set...
81/81 - 1s - 895ms/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0876504
{'0': {'precision': 0.3762722163147501, 'recall': 0.42736369910282956, 'f1-score': 0.40019387672671464, 'support': 5796}, '1': {'precision': 0.5630861794372677, 'recall': 0.35406698564593303, 'f1-score': 0.43475884683699956, 'support': 8987}, '2': {'precision': 0.3626819374850871, 'recall': 0.5211726384364821, 'f1-score': 0.4277172001406964, 'support': 5833}, 'accuracy': 0.421953822273962, 'macro avg': {'precision': 0.4340134444123683, 'recall': 0.4342011077284149, 'f1-score': 0.42088997456813687, 'support': 20616}, 'weighted avg': {'precision': 0.45386364967566595, 'recall': 0.421953822273962, 'f1-score': 0.4230488889431915, 'support': 20616}}
[[2477 1262 2057]
 [2520 3182 3285]
 [1586 1207 3040]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0760921
{'0': {'precision': 0.4234410217881292, 'recall': 0.405176132278936, 'f1-score': 0.41410727406318876, 'support': 6955}, '1': {'precision': 0.43532608695652175, 'recall': 0.35737656157049374, 'f1-score': 0.3925187847108788, 'support': 6724}, '2': {'precision': 0.41203648856770525, 'recall': 0.5013694680697708, 'f1-score': 0.45233450383664975, 'support': 6937}, 'accuracy': 0.421953822273962, 'macro avg': {'precision': 0.4236011991041187, 'recall': 0.4213073873064002, 'f1-score': 0.41965352087023905, 'support': 20616}, 'weighted avg': {'precision': 0.42347992027678805, 'recall': 0.421953822273962, 'f1-score': 0.41992902855162334, 'support': 20616}}
[[2818 1601 2536]
 [1894 2403 2427]
 [1943 1516 3478]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0843741
{'0': {'precision': 0.4160434081243584, 'recall': 0.39534559643255296, 'f1-score': 0.40543051089674886, 'support': 7176}, '1': {'precision': 0.3938542252201611, 'recall': 0.3340750158931977, 'f1-score': 0.3615100180583025, 'support': 6292}, '2': {'precision': 0.41205673758865247, 'recall': 0.4876888640179071, 'f1-score': 0.446694003075346, 'support': 7148}, 'accuracy': 0.408663174233605, 'macro avg': {'precision': 0.40731812364439063, 'recall': 0.40570315878121926, 'f1-score': 0.40454484401013246, 'support': 20616}, 'weighted avg': {'precision': 0.4078890105776745, 'recall': 0.408663174233605, 'f1-score': 0.40633290229920854, 'support': 20616}}
[[2837 1670 2669]
 [1885 2102 2305]
 [2097 1565 3486]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0935146
{'0': {'precision': 0.405320813771518, 'recall': 0.3910775566231984, 'f1-score': 0.3980718178007545, 'support': 7285}, '1': {'precision': 0.35214534209509085, 'recall': 0.2964047502846917, 'f1-score': 0.3218796926066602, 'support': 6147}, '2': {'precision': 0.4024723641982646, 'recall': 0.4713251670378619, 'f1-score': 0.43418606142206834, 'support': 7184}, 'accuracy': 0.39081296080714006, 'macro avg': {'precision': 0.3866461733549578, 'recall': 0.38626915798191735, 'f1-score': 0.384712523943161, 'support': 20616}, 'weighted avg': {'precision': 0.38847307967522143, 'recall': 0.39081296080714006, 'f1-score': 0.3879385103020846, 'support': 20616}}
[[2849 1750 2686]
 [1984 1822 2341]
 [2196 1602 3386]]
training model: results/LILAK/W4/deepVOL_L2/seq2seq
Epoch 1/50
254/254 - 12s - loss: 13.2982 - accuracy10: 0.3529 - accuracy20: 0.3581 - accuracy30: 0.3559 - accuracy50: 0.3539 - val_loss: 13.2814 - val_accuracy10: 0.3115 - val_accuracy20: 0.3482 - val_accuracy30: 0.3560 - val_accuracy50: 0.3561 - 12s/epoch - 49ms/step
Epoch 2/50
254/254 - 7s - loss: 13.1454 - accuracy10: 0.3674 - accuracy20: 0.3771 - accuracy30: 0.3708 - accuracy50: 0.3682 - val_loss: 13.2358 - val_accuracy10: 0.3254 - val_accuracy20: 0.3644 - val_accuracy30: 0.3682 - val_accuracy50: 0.3667 - 7s/epoch - 29ms/step
Epoch 3/50
254/254 - 7s - loss: 13.0876 - accuracy10: 0.3794 - accuracy20: 0.3879 - accuracy30: 0.3844 - accuracy50: 0.3784 - val_loss: 13.1877 - val_accuracy10: 0.3464 - val_accuracy20: 0.3767 - val_accuracy30: 0.3783 - val_accuracy50: 0.3706 - 7s/epoch - 27ms/step
Epoch 4/50
254/254 - 7s - loss: 13.0012 - accuracy10: 0.3956 - accuracy20: 0.4018 - accuracy30: 0.3978 - accuracy50: 0.3904 - val_loss: 13.1448 - val_accuracy10: 0.3603 - val_accuracy20: 0.3862 - val_accuracy30: 0.3856 - val_accuracy50: 0.3806 - 7s/epoch - 28ms/step
Epoch 5/50
254/254 - 7s - loss: 12.9233 - accuracy10: 0.4073 - accuracy20: 0.4157 - accuracy30: 0.4109 - accuracy50: 0.4012 - val_loss: 13.1078 - val_accuracy10: 0.3611 - val_accuracy20: 0.3913 - val_accuracy30: 0.3913 - val_accuracy50: 0.3832 - 7s/epoch - 28ms/step
Epoch 6/50
254/254 - 7s - loss: 12.8556 - accuracy10: 0.4147 - accuracy20: 0.4244 - accuracy30: 0.4210 - accuracy50: 0.4083 - val_loss: 13.0823 - val_accuracy10: 0.3681 - val_accuracy20: 0.3991 - val_accuracy30: 0.3984 - val_accuracy50: 0.3869 - 7s/epoch - 28ms/step
Epoch 7/50
254/254 - 7s - loss: 12.7954 - accuracy10: 0.4244 - accuracy20: 0.4323 - accuracy30: 0.4282 - accuracy50: 0.4135 - val_loss: 13.0563 - val_accuracy10: 0.3836 - val_accuracy20: 0.4054 - val_accuracy30: 0.4028 - val_accuracy50: 0.3891 - 7s/epoch - 28ms/step
Epoch 8/50
254/254 - 7s - loss: 12.7375 - accuracy10: 0.4298 - accuracy20: 0.4377 - accuracy30: 0.4324 - accuracy50: 0.4192 - val_loss: 13.0099 - val_accuracy10: 0.3857 - val_accuracy20: 0.4064 - val_accuracy30: 0.4051 - val_accuracy50: 0.3928 - 7s/epoch - 27ms/step
Epoch 9/50
254/254 - 7s - loss: 12.6800 - accuracy10: 0.4375 - accuracy20: 0.4476 - accuracy30: 0.4409 - accuracy50: 0.4271 - val_loss: 13.0253 - val_accuracy10: 0.3856 - val_accuracy20: 0.4087 - val_accuracy30: 0.4055 - val_accuracy50: 0.3961 - 7s/epoch - 28ms/step
Epoch 10/50
254/254 - 7s - loss: 12.6341 - accuracy10: 0.4418 - accuracy20: 0.4500 - accuracy30: 0.4458 - accuracy50: 0.4323 - val_loss: 12.9976 - val_accuracy10: 0.4002 - val_accuracy20: 0.4138 - val_accuracy30: 0.4101 - val_accuracy50: 0.3980 - 7s/epoch - 28ms/step
Epoch 11/50
254/254 - 7s - loss: 12.5934 - accuracy10: 0.4503 - accuracy20: 0.4565 - accuracy30: 0.4508 - accuracy50: 0.4321 - val_loss: 13.0434 - val_accuracy10: 0.3819 - val_accuracy20: 0.4085 - val_accuracy30: 0.4079 - val_accuracy50: 0.3957 - 7s/epoch - 28ms/step
Epoch 12/50
254/254 - 7s - loss: 12.5652 - accuracy10: 0.4536 - accuracy20: 0.4598 - accuracy30: 0.4527 - accuracy50: 0.4357 - val_loss: 13.0345 - val_accuracy10: 0.3917 - val_accuracy20: 0.4150 - val_accuracy30: 0.4109 - val_accuracy50: 0.3960 - 7s/epoch - 28ms/step
Epoch 13/50
254/254 - 7s - loss: 12.5077 - accuracy10: 0.4567 - accuracy20: 0.4654 - accuracy30: 0.4582 - accuracy50: 0.4410 - val_loss: 13.0099 - val_accuracy10: 0.3974 - val_accuracy20: 0.4115 - val_accuracy30: 0.4088 - val_accuracy50: 0.3925 - 7s/epoch - 28ms/step
Epoch 14/50
254/254 - 7s - loss: 12.4770 - accuracy10: 0.4602 - accuracy20: 0.4689 - accuracy30: 0.4608 - accuracy50: 0.4430 - val_loss: 12.9975 - val_accuracy10: 0.4002 - val_accuracy20: 0.4157 - val_accuracy30: 0.4098 - val_accuracy50: 0.3950 - 7s/epoch - 28ms/step
Epoch 15/50
254/254 - 7s - loss: 12.4343 - accuracy10: 0.4648 - accuracy20: 0.4726 - accuracy30: 0.4645 - accuracy50: 0.4460 - val_loss: 13.0009 - val_accuracy10: 0.4027 - val_accuracy20: 0.4134 - val_accuracy30: 0.4064 - val_accuracy50: 0.3882 - 7s/epoch - 28ms/step
Epoch 16/50
254/254 - 7s - loss: 12.4268 - accuracy10: 0.4619 - accuracy20: 0.4727 - accuracy30: 0.4653 - accuracy50: 0.4454 - val_loss: 13.0133 - val_accuracy10: 0.3979 - val_accuracy20: 0.4149 - val_accuracy30: 0.4096 - val_accuracy50: 0.3894 - 7s/epoch - 28ms/step
Epoch 17/50
254/254 - 7s - loss: 12.3906 - accuracy10: 0.4678 - accuracy20: 0.4747 - accuracy30: 0.4663 - accuracy50: 0.4467 - val_loss: 13.0201 - val_accuracy10: 0.4003 - val_accuracy20: 0.4159 - val_accuracy30: 0.4086 - val_accuracy50: 0.3922 - 7s/epoch - 28ms/step
Epoch 18/50
254/254 - 7s - loss: 12.3510 - accuracy10: 0.4729 - accuracy20: 0.4813 - accuracy30: 0.4730 - accuracy50: 0.4513 - val_loss: 13.0513 - val_accuracy10: 0.3988 - val_accuracy20: 0.4112 - val_accuracy30: 0.4033 - val_accuracy50: 0.3870 - 7s/epoch - 28ms/step
Epoch 19/50
254/254 - 7s - loss: 12.3520 - accuracy10: 0.4696 - accuracy20: 0.4791 - accuracy30: 0.4724 - accuracy50: 0.4510 - val_loss: 13.0649 - val_accuracy10: 0.4001 - val_accuracy20: 0.4144 - val_accuracy30: 0.4103 - val_accuracy50: 0.3932 - 7s/epoch - 28ms/step
Epoch 20/50
254/254 - 7s - loss: 12.2957 - accuracy10: 0.4744 - accuracy20: 0.4830 - accuracy30: 0.4757 - accuracy50: 0.4541 - val_loss: 13.0493 - val_accuracy10: 0.3915 - val_accuracy20: 0.4124 - val_accuracy30: 0.4099 - val_accuracy50: 0.3973 - 7s/epoch - 29ms/step
Epoch 21/50
254/254 - 7s - loss: 12.2732 - accuracy10: 0.4745 - accuracy20: 0.4852 - accuracy30: 0.4801 - accuracy50: 0.4599 - val_loss: 13.0561 - val_accuracy10: 0.4059 - val_accuracy20: 0.4187 - val_accuracy30: 0.4107 - val_accuracy50: 0.3913 - 7s/epoch - 28ms/step
Epoch 22/50
254/254 - 7s - loss: 12.2418 - accuracy10: 0.4761 - accuracy20: 0.4894 - accuracy30: 0.4819 - accuracy50: 0.4614 - val_loss: 13.1212 - val_accuracy10: 0.3986 - val_accuracy20: 0.4117 - val_accuracy30: 0.4082 - val_accuracy50: 0.3943 - 7s/epoch - 28ms/step
Epoch 23/50
254/254 - 7s - loss: 12.2127 - accuracy10: 0.4800 - accuracy20: 0.4925 - accuracy30: 0.4849 - accuracy50: 0.4614 - val_loss: 13.1210 - val_accuracy10: 0.3986 - val_accuracy20: 0.4162 - val_accuracy30: 0.4113 - val_accuracy50: 0.3967 - 7s/epoch - 28ms/step
Epoch 24/50
254/254 - 7s - loss: 12.1749 - accuracy10: 0.4810 - accuracy20: 0.4944 - accuracy30: 0.4860 - accuracy50: 0.4668 - val_loss: 13.0841 - val_accuracy10: 0.4034 - val_accuracy20: 0.4138 - val_accuracy30: 0.4086 - val_accuracy50: 0.3957 - 7s/epoch - 28ms/step
testing model: results/LILAK/W4/deepVOL_L2/seq2seq
Evaluating performance on  test set...
534/534 - 6s - 6s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.088675
{'0': {'precision': 0.45841336359932483, 'recall': 0.34257628150757924, 'f1-score': 0.3921187906849383, 'support': 45981}, '1': {'precision': 0.4028977761942935, 'recall': 0.2993470396188123, 'f1-score': 0.3434877804918178, 'support': 45332}, '2': {'precision': 0.3940184518517439, 'recall': 0.5962374010277673, 'f1-score': 0.47448048301039036, 'support': 45341}, 'accuracy': 0.4123991979744464, 'macro avg': {'precision': 0.41844319721512074, 'recall': 0.41272024071805297, 'f1-score': 0.40336235139571547, 'support': 136654}, 'weighted avg': {'precision': 0.41863141574714374, 'recall': 0.4123991979744464, 'f1-score': 0.40331363706816736, 'support': 136654}}
[[15752 10320 19909]
 [10094 13570 21668]
 [ 8516  9791 27034]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0810252
{'0': {'precision': 0.5068851516458244, 'recall': 0.33442710012707927, 'f1-score': 0.4029802989440965, 'support': 52723}, '1': {'precision': 0.29451401311866426, 'recall': 0.31051175656984786, 'f1-score': 0.302301383278247, 'support': 31812}, '2': {'precision': 0.4438964422134087, 'recall': 0.5819566760682284, 'f1-score': 0.5036364240170031, 'support': 52119}, 'accuracy': 0.42326605880545026, 'macro avg': {'precision': 0.4150985356592991, 'recall': 0.4089651775883852, 'f1-score': 0.40297270207978225, 'support': 136654}, 'weighted avg': {'precision': 0.43342327562511446, 'recall': 0.42326605880545026, 'f1-score': 0.4179326524611017, 'support': 136654}}
[[17632 12160 22931]
 [ 6867  9878 15067]
 [10286 11502 30331]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0871662
{'0': {'precision': 0.49034145787171185, 'recall': 0.33153426551936077, 'f1-score': 0.395595077120528, 'support': 52064}, '1': {'precision': 0.2942462192816635, 'recall': 0.30022301247664396, 'f1-score': 0.2972045705420806, 'support': 33182}, '2': {'precision': 0.43256997455470736, 'recall': 0.5687830687830688, 'f1-score': 0.4914120533763571, 'support': 51408}, 'accuracy': 0.4131821973743908, 'macro avg': {'precision': 0.40571921723602755, 'recall': 0.4001801155930245, 'f1-score': 0.39473723367965524, 'support': 136654}, 'weighted avg': {'precision': 0.42099296736828307, 'recall': 0.4131821973743908, 'f1-score': 0.40774960846299596, 'support': 136654}}
[[17261 12128 22675]
 [ 7539  9962 15681]
 [10402 11766 29240]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1008335
{'0': {'precision': 0.45479212006444136, 'recall': 0.3210238608251536, 'f1-score': 0.3763756505467516, 'support': 50124}, '1': {'precision': 0.3024018100597552, 'recall': 0.2817339134664757, 'f1-score': 0.29170222589084605, 'support': 37003}, '2': {'precision': 0.40931750475306516, 'recall': 0.5520625113574414, 'f1-score': 0.4700926705981466, 'support': 49527}, 'accuracy': 0.3941194549738756, 'macro avg': {'precision': 0.3888371449590872, 'recall': 0.38494009521635686, 'f1-score': 0.3793901823452481, 'support': 136654}, 'weighted avg': {'precision': 0.3970468662582598, 'recall': 0.3941194549738756, 'f1-score': 0.38741339638326544, 'support': 136654}}
[[16091 12177 21856]
 [ 8977 10425 17601]
 [10313 11872 27342]]
Evaluating performance on  train set...
254/254 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0568132
{'0': {'precision': 0.38621204844992263, 'recall': 0.41981323589118963, 'f1-score': 0.4023122672447335, 'support': 17241}, '1': {'precision': 0.6076372865712967, 'recall': 0.35081759749558733, 'f1-score': 0.44481979604332494, 'support': 30027}, '2': {'precision': 0.3650854152950553, 'recall': 0.5963323522753, 'f1-score': 0.4528983171061965, 'support': 17668}, 'accuracy': 0.4359369225083159, 'macro avg': {'precision': 0.45297825010542486, 'recall': 0.45565439522069234, 'f1-score': 0.43334346013141833, 'support': 64936}, 'weighted avg': {'precision': 0.48285289898722555, 'recall': 0.4359369225083159, 'f1-score': 0.4357317556053907, 'support': 64936}}
[[ 7238  3663  6340]
 [ 7510 10534 11983]
 [ 3993  3139 10536]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0468384
{'0': {'precision': 0.4439930354033662, 'recall': 0.40683620189518466, 'f1-score': 0.42460327471806647, 'support': 20684}, '1': {'precision': 0.49649465578669116, 'recall': 0.37643778319972115, 'f1-score': 0.42821033850423745, 'support': 22952}, '2': {'precision': 0.4271369091354396, 'recall': 0.5731455399061033, 'f1-score': 0.4894849742386881, 'support': 21300}, 'accuracy': 0.45064371073056547, 'macro avg': {'precision': 0.4558748667751657, 'recall': 0.45213984166700305, 'f1-score': 0.44743286248699726, 'support': 64936}, 'weighted avg': {'precision': 0.4570209660047466, 'recall': 0.45064371073056547, 'f1-score': 0.4471604006237188, 'support': 64936}}
[[ 8415  4570  7699]
 [ 5638  8640  8674]
 [ 4900  4192 12208]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0532366
{'0': {'precision': 0.4488147681980281, 'recall': 0.4010685162620677, 'f1-score': 0.42360045537791413, 'support': 21338}, '1': {'precision': 0.4594227504244482, 'recall': 0.37474034067303696, 'f1-score': 0.4127831591793151, 'support': 21663}, '2': {'precision': 0.43137811192283143, 'recall': 0.554547526783679, 'f1-score': 0.48526918397063806, 'support': 21935}, 'accuracy': 0.4441296045336947, 'macro avg': {'precision': 0.4465385435151026, 'recall': 0.44345212790626126, 'f1-score': 0.4405509328426224, 'support': 64936}, 'weighted avg': {'precision': 0.4464636480732052, 'recall': 0.4441296045336947, 'f1-score': 0.44082308187371233, 'support': 64936}}
[[ 8558  4976  7804]
 [ 5315  8118  8230]
 [ 5195  4576 12164]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0683384
{'0': {'precision': 0.43092243186582807, 'recall': 0.3852677943863924, 'f1-score': 0.4068182380445808, 'support': 21341}, '1': {'precision': 0.4246370386789316, 'recall': 0.3509503091367071, 'f1-score': 0.38429327248564477, 'support': 21835}, '2': {'precision': 0.41373606616325065, 'recall': 0.5287683823529412, 'f1-score': 0.46423239862820254, 'support': 21760}, 'accuracy': 0.42181532585930764, 'macro avg': {'precision': 0.4230985122360034, 'recall': 0.4216621619586802, 'f1-score': 0.418447969719476, 'support': 64936}, 'weighted avg': {'precision': 0.42304980531162134, 'recall': 0.42181532585930764, 'f1-score': 0.41848356253823976, 'support': 64936}}
[[ 8222  5440  7679]
 [ 5547  7663  8625]
 [ 5311  4943 11506]]
Evaluating performance on  val set...
81/81 - 1s - 878ms/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0867383
{'0': {'precision': 0.366869918699187, 'recall': 0.43411784916680984, 'f1-score': 0.39767094185223073, 'support': 5821}, '1': {'precision': 0.5310699588477367, 'recall': 0.2881545160209892, 'f1-score': 0.37359774191213724, 'support': 8957}, '2': {'precision': 0.3558462058856692, 'recall': 0.5405035108751498, 'f1-score': 0.4291542017949415, 'support': 5839}, 'accuracy': 0.4008342629868555, 'macro avg': {'precision': 0.4179286944775309, 'recall': 0.42092529202098294, 'f1-score': 0.40014096185310316, 'support': 20617}, 'weighted avg': {'precision': 0.4350841254456791, 'recall': 0.4008342629868555, 'f1-score': 0.3961288699184901, 'support': 20617}}
[[2527 1164 2130]
 [2793 2581 3583]
 [1568 1115 3156]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.074512
{'0': {'precision': 0.42603382123063804, 'recall': 0.4293898596390719, 'f1-score': 0.4277052571510093, 'support': 6982}, '1': {'precision': 0.4220087700981416, 'recall': 0.30038644470868014, 'f1-score': 0.35095945124598416, 'support': 6728}, '2': {'precision': 0.4054146285974292, 'recall': 0.5159982626321123, 'f1-score': 0.4540705822397758, 'support': 6907}, 'accuracy': 0.4163069311733036, 'macro avg': {'precision': 0.4178190733087363, 'recall': 0.4152581889932881, 'f1-score': 0.4109117635455897, 'support': 20617}, 'weighted avg': {'precision': 0.4178125811114641, 'recall': 0.4163069311733036, 'f1-score': 0.41149336978907985, 'support': 20617}}
[[2998 1385 2599]
 [2079 2021 2628]
 [1960 1383 3564]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0777318
{'0': {'precision': 0.42792538157150933, 'recall': 0.422845971233068, 'f1-score': 0.4253705134508675, 'support': 7161}, '1': {'precision': 0.3820618556701031, 'recall': 0.29352130524314907, 'f1-score': 0.33198960852817344, 'support': 6313}, '2': {'precision': 0.41134506961224254, 'recall': 0.500489990200196, 'f1-score': 0.45155993431855507, 'support': 7143}, 'accuracy': 0.41014696609594026, 'macro avg': {'precision': 0.40711076895128495, 'recall': 0.40561908889213766, 'f1-score': 0.40297335209919866, 'support': 20617}, 'weighted avg': {'precision': 0.40813736161998293, 'recall': 0.41014696609594026, 'f1-score': 0.40585057264866176, 'support': 20617}}
[[3028 1474 2659]
 [2003 1853 2457]
 [2045 1523 3575]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0896721
{'0': {'precision': 0.4122546943385571, 'recall': 0.40104381266309574, 'f1-score': 0.4065719855193539, 'support': 7281}, '1': {'precision': 0.3408308004052685, 'recall': 0.2740752810819619, 'f1-score': 0.3038294797687861, 'support': 6137}, '2': {'precision': 0.4024886614722642, 'recall': 0.48076121683567163, 'f1-score': 0.43815672869983535, 'support': 7199}, 'accuracy': 0.39108502691953245, 'macro avg': {'precision': 0.38519138540536324, 'recall': 0.38529343686024314, 'f1-score': 0.3828527313293251, 'support': 20617}, 'weighted avg': {'precision': 0.38758407748484247, 'recall': 0.39108502691953245, 'f1-score': 0.3870176278710565, 'support': 20617}}
[[2920 1649 2712]
 [2029 1682 2426]
 [2134 1604 3461]]
training model: results/LILAK/W4/deepVOL_L3/seq2seq
Epoch 1/50
254/254 - 15s - loss: 13.3010 - accuracy10: 0.3588 - accuracy20: 0.3531 - accuracy30: 0.3512 - accuracy50: 0.3474 - val_loss: 13.2976 - val_accuracy10: 0.3198 - val_accuracy20: 0.3467 - val_accuracy30: 0.3480 - val_accuracy50: 0.3431 - 15s/epoch - 61ms/step
Epoch 2/50
254/254 - 10s - loss: 13.2023 - accuracy10: 0.3583 - accuracy20: 0.3586 - accuracy30: 0.3536 - accuracy50: 0.3553 - val_loss: 13.2450 - val_accuracy10: 0.3211 - val_accuracy20: 0.3567 - val_accuracy30: 0.3560 - val_accuracy50: 0.3502 - 10s/epoch - 40ms/step
Epoch 3/50
254/254 - 10s - loss: 13.1402 - accuracy10: 0.3773 - accuracy20: 0.3710 - accuracy30: 0.3661 - accuracy50: 0.3673 - val_loss: 13.2158 - val_accuracy10: 0.3318 - val_accuracy20: 0.3601 - val_accuracy30: 0.3649 - val_accuracy50: 0.3633 - 10s/epoch - 39ms/step
Epoch 4/50
254/254 - 10s - loss: 13.0664 - accuracy10: 0.3874 - accuracy20: 0.3865 - accuracy30: 0.3815 - accuracy50: 0.3775 - val_loss: 13.1864 - val_accuracy10: 0.3485 - val_accuracy20: 0.3655 - val_accuracy30: 0.3692 - val_accuracy50: 0.3662 - 10s/epoch - 39ms/step
Epoch 5/50
254/254 - 10s - loss: 13.0163 - accuracy10: 0.3948 - accuracy20: 0.3986 - accuracy30: 0.3955 - accuracy50: 0.3884 - val_loss: 13.2068 - val_accuracy10: 0.3454 - val_accuracy20: 0.3724 - val_accuracy30: 0.3731 - val_accuracy50: 0.3704 - 10s/epoch - 39ms/step
Epoch 6/50
254/254 - 10s - loss: 12.9526 - accuracy10: 0.4050 - accuracy20: 0.4076 - accuracy30: 0.4041 - accuracy50: 0.3962 - val_loss: 13.1919 - val_accuracy10: 0.3437 - val_accuracy20: 0.3709 - val_accuracy30: 0.3733 - val_accuracy50: 0.3701 - 10s/epoch - 39ms/step
Epoch 7/50
254/254 - 10s - loss: 12.8782 - accuracy10: 0.4123 - accuracy20: 0.4191 - accuracy30: 0.4144 - accuracy50: 0.4048 - val_loss: 13.1593 - val_accuracy10: 0.3613 - val_accuracy20: 0.3863 - val_accuracy30: 0.3864 - val_accuracy50: 0.3797 - 10s/epoch - 39ms/step
Epoch 8/50
254/254 - 10s - loss: 12.8165 - accuracy10: 0.4181 - accuracy20: 0.4273 - accuracy30: 0.4231 - accuracy50: 0.4144 - val_loss: 13.1609 - val_accuracy10: 0.3640 - val_accuracy20: 0.3891 - val_accuracy30: 0.3879 - val_accuracy50: 0.3813 - 10s/epoch - 40ms/step
Epoch 9/50
254/254 - 10s - loss: 12.7593 - accuracy10: 0.4269 - accuracy20: 0.4356 - accuracy30: 0.4324 - accuracy50: 0.4206 - val_loss: 13.2127 - val_accuracy10: 0.3515 - val_accuracy20: 0.3813 - val_accuracy30: 0.3848 - val_accuracy50: 0.3799 - 10s/epoch - 39ms/step
Epoch 10/50
254/254 - 10s - loss: 12.7174 - accuracy10: 0.4299 - accuracy20: 0.4408 - accuracy30: 0.4342 - accuracy50: 0.4230 - val_loss: 13.2105 - val_accuracy10: 0.3486 - val_accuracy20: 0.3866 - val_accuracy30: 0.3886 - val_accuracy50: 0.3800 - 10s/epoch - 40ms/step
Epoch 11/50
254/254 - 10s - loss: 12.6695 - accuracy10: 0.4366 - accuracy20: 0.4456 - accuracy30: 0.4415 - accuracy50: 0.4258 - val_loss: 13.2290 - val_accuracy10: 0.3572 - val_accuracy20: 0.3906 - val_accuracy30: 0.3910 - val_accuracy50: 0.3825 - 10s/epoch - 39ms/step
Epoch 12/50
254/254 - 10s - loss: 12.6088 - accuracy10: 0.4430 - accuracy20: 0.4525 - accuracy30: 0.4474 - accuracy50: 0.4318 - val_loss: 13.2420 - val_accuracy10: 0.3539 - val_accuracy20: 0.3906 - val_accuracy30: 0.3925 - val_accuracy50: 0.3843 - 10s/epoch - 39ms/step
Epoch 13/50
254/254 - 10s - loss: 12.5495 - accuracy10: 0.4474 - accuracy20: 0.4591 - accuracy30: 0.4533 - accuracy50: 0.4365 - val_loss: 13.1895 - val_accuracy10: 0.3696 - val_accuracy20: 0.3988 - val_accuracy30: 0.3993 - val_accuracy50: 0.3902 - 10s/epoch - 39ms/step
Epoch 14/50
254/254 - 10s - loss: 12.5212 - accuracy10: 0.4481 - accuracy20: 0.4602 - accuracy30: 0.4539 - accuracy50: 0.4388 - val_loss: 13.1588 - val_accuracy10: 0.3798 - val_accuracy20: 0.4000 - val_accuracy30: 0.3971 - val_accuracy50: 0.3889 - 10s/epoch - 39ms/step
Epoch 15/50
254/254 - 10s - loss: 12.4600 - accuracy10: 0.4512 - accuracy20: 0.4659 - accuracy30: 0.4605 - accuracy50: 0.4431 - val_loss: 13.1806 - val_accuracy10: 0.3848 - val_accuracy20: 0.4033 - val_accuracy30: 0.3994 - val_accuracy50: 0.3893 - 10s/epoch - 39ms/step
Epoch 16/50
254/254 - 10s - loss: 12.4378 - accuracy10: 0.4551 - accuracy20: 0.4695 - accuracy30: 0.4622 - accuracy50: 0.4434 - val_loss: 13.1573 - val_accuracy10: 0.3865 - val_accuracy20: 0.4062 - val_accuracy30: 0.4040 - val_accuracy50: 0.3904 - 10s/epoch - 39ms/step
Epoch 17/50
254/254 - 10s - loss: 12.3724 - accuracy10: 0.4572 - accuracy20: 0.4735 - accuracy30: 0.4663 - accuracy50: 0.4479 - val_loss: 13.1590 - val_accuracy10: 0.3795 - val_accuracy20: 0.4036 - val_accuracy30: 0.3994 - val_accuracy50: 0.3910 - 10s/epoch - 39ms/step
Epoch 18/50
254/254 - 10s - loss: 12.3143 - accuracy10: 0.4635 - accuracy20: 0.4806 - accuracy30: 0.4750 - accuracy50: 0.4560 - val_loss: 13.1847 - val_accuracy10: 0.3765 - val_accuracy20: 0.4043 - val_accuracy30: 0.4022 - val_accuracy50: 0.3919 - 10s/epoch - 39ms/step
Epoch 19/50
254/254 - 10s - loss: 12.2819 - accuracy10: 0.4669 - accuracy20: 0.4825 - accuracy30: 0.4765 - accuracy50: 0.4577 - val_loss: 13.2285 - val_accuracy10: 0.3789 - val_accuracy20: 0.4035 - val_accuracy30: 0.4004 - val_accuracy50: 0.3906 - 10s/epoch - 39ms/step
Epoch 20/50
254/254 - 10s - loss: 12.2436 - accuracy10: 0.4701 - accuracy20: 0.4871 - accuracy30: 0.4802 - accuracy50: 0.4594 - val_loss: 13.2181 - val_accuracy10: 0.3664 - val_accuracy20: 0.4003 - val_accuracy30: 0.3975 - val_accuracy50: 0.3893 - 10s/epoch - 39ms/step
Epoch 21/50
254/254 - 10s - loss: 12.2146 - accuracy10: 0.4708 - accuracy20: 0.4876 - accuracy30: 0.4820 - accuracy50: 0.4625 - val_loss: 13.2964 - val_accuracy10: 0.3660 - val_accuracy20: 0.4010 - val_accuracy30: 0.3989 - val_accuracy50: 0.3926 - 10s/epoch - 40ms/step
Epoch 22/50
254/254 - 10s - loss: 12.1735 - accuracy10: 0.4749 - accuracy20: 0.4922 - accuracy30: 0.4855 - accuracy50: 0.4647 - val_loss: 13.3570 - val_accuracy10: 0.3579 - val_accuracy20: 0.3942 - val_accuracy30: 0.3955 - val_accuracy50: 0.3906 - 10s/epoch - 41ms/step
Epoch 23/50
254/254 - 10s - loss: 12.1246 - accuracy10: 0.4785 - accuracy20: 0.4966 - accuracy30: 0.4898 - accuracy50: 0.4688 - val_loss: 13.3331 - val_accuracy10: 0.3594 - val_accuracy20: 0.3985 - val_accuracy30: 0.3983 - val_accuracy50: 0.3937 - 10s/epoch - 41ms/step
Epoch 24/50
254/254 - 10s - loss: 12.0851 - accuracy10: 0.4783 - accuracy20: 0.4976 - accuracy30: 0.4924 - accuracy50: 0.4709 - val_loss: 13.3175 - val_accuracy10: 0.3684 - val_accuracy20: 0.4027 - val_accuracy30: 0.4005 - val_accuracy50: 0.3938 - 10s/epoch - 41ms/step
Epoch 25/50
254/254 - 10s - loss: 12.0619 - accuracy10: 0.4813 - accuracy20: 0.5024 - accuracy30: 0.4953 - accuracy50: 0.4727 - val_loss: 13.2944 - val_accuracy10: 0.3710 - val_accuracy20: 0.4012 - val_accuracy30: 0.4006 - val_accuracy50: 0.3961 - 10s/epoch - 41ms/step
Epoch 26/50
254/254 - 10s - loss: 12.0031 - accuracy10: 0.4874 - accuracy20: 0.5070 - accuracy30: 0.5007 - accuracy50: 0.4803 - val_loss: 13.2851 - val_accuracy10: 0.3712 - val_accuracy20: 0.4027 - val_accuracy30: 0.3996 - val_accuracy50: 0.3928 - 10s/epoch - 40ms/step
testing model: results/LILAK/W4/deepVOL_L3/seq2seq
Evaluating performance on  test set...
534/534 - 10s - 10s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1171386
{'0': {'precision': 0.4240330303638501, 'recall': 0.3216328483504056, 'f1-score': 0.36580177595290514, 'support': 45981}, '1': {'precision': 0.4061373754504982, 'recall': 0.3380834730433248, 'f1-score': 0.36899889247363604, 'support': 45332}, '2': {'precision': 0.38311394263050236, 'recall': 0.5411217220617102, 'f1-score': 0.44861128887751184, 'support': 45341}, 'accuracy': 0.39991511408374436, 'macro avg': {'precision': 0.4044281161482835, 'recall': 0.40027934781848024, 'f1-score': 0.3944706524346843, 'support': 136654}, 'weighted avg': {'precision': 0.40451982046549523, 'recall': 0.39991511408374436, 'f1-score': 0.394338063303677, 'support': 136654}}
[[14789 11516 19676]
 [10176 15326 19830]
 [ 9912 10894 24535]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1064504
{'0': {'precision': 0.4690988835725678, 'recall': 0.31240635016975515, 'f1-score': 0.3750441168099277, 'support': 52723}, '1': {'precision': 0.2985649001843983, 'recall': 0.35118823085628065, 'f1-score': 0.32274559084803045, 'support': 31812}, '2': {'precision': 0.4281147170282114, 'recall': 0.526717703716495, 'f1-score': 0.47232497720273225, 'support': 52119}, 'accuracy': 0.4031715134573448, 'macro avg': {'precision': 0.3985928335950592, 'recall': 0.39677076158084357, 'f1-score': 0.3900382282868968, 'support': 136654}, 'weighted avg': {'precision': 0.41376877354527436, 'recall': 0.4031715134573448, 'f1-score': 0.3999717475775065, 'support': 136654}}
[[16471 13420 22832]
 [ 6801 11172 13839]
 [11840 12827 27452]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.113213
{'0': {'precision': 0.4564801871451802, 'recall': 0.3073332821143208, 'f1-score': 0.36734506468312733, 'support': 52064}, '1': {'precision': 0.29489623325368486, 'recall': 0.33102284371044544, 'f1-score': 0.3119169660225191, 'support': 33182}, '2': {'precision': 0.41461292227367375, 'recall': 0.5190242763772176, 'f1-score': 0.460980287140858, 'support': 51408}, 'accuracy': 0.39272176445621787, 'macro avg': {'precision': 0.38866311422417965, 'recall': 0.38579346740066134, 'f1-score': 0.3800807726155015, 'support': 136654}, 'weighted avg': {'precision': 0.4014946681662846, 'recall': 0.39272176445621787, 'f1-score': 0.38911086990178695, 'support': 136654}}
[[16001 13261 22802]
 [ 7328 10984 14870]
 [11724 13002 26682]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1254985
{'0': {'precision': 0.42574655821573304, 'recall': 0.29552709280983164, 'f1-score': 0.34888184933523325, 'support': 50124}, '1': {'precision': 0.3031737493275955, 'recall': 0.3046239494095073, 'f1-score': 0.3038971192860898, 'support': 37003}, '2': {'precision': 0.3917842952335307, 'recall': 0.5116603064994851, 'f1-score': 0.4437692630989073, 'support': 49527}, 'accuracy': 0.3763226835657939, 'macro avg': {'precision': 0.37356820092561976, 'recall': 0.3706037829062747, 'f1-score': 0.3655160772400768, 'support': 136654}, 'weighted avg': {'precision': 0.3802476291978683, 'recall': 0.3763226835657939, 'f1-score': 0.37109063192092434, 'support': 136654}}
[[14813 12855 22456]
 [ 8847 11272 16884]
 [11133 13053 25341]]
Evaluating performance on  train set...
254/254 - 5s - 5s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0560762
{'0': {'precision': 0.35543328748280606, 'recall': 0.4496258917696189, 'f1-score': 0.3970192824767612, 'support': 17241}, '1': {'precision': 0.5946126218573627, 'recall': 0.38595264262164053, 'f1-score': 0.46808166892178443, 'support': 30027}, '2': {'precision': 0.37937891352174646, 'recall': 0.507527733755943, 'f1-score': 0.43419523532829746, 'support': 17668}, 'accuracy': 0.4359369225083159, 'macro avg': {'precision': 0.4431416076206384, 'recall': 0.4477020893824008, 'f1-score': 0.4330987289089477, 'support': 64936}, 'weighted avg': {'precision': 0.47254720263188843, 'recall': 0.4359369225083159, 'f1-score': 0.4399941348354783, 'support': 64936}}
[[ 7752  3967  5522]
 [ 9291 11589  9147]
 [ 4767  3934  8967]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0493432
{'0': {'precision': 0.4154176567355145, 'recall': 0.43951846838135755, 'f1-score': 0.4271283593309528, 'support': 20684}, '1': {'precision': 0.4943202448259765, 'recall': 0.4152143604043221, 'f1-score': 0.45132722407709974, 'support': 22952}, '2': {'precision': 0.44361250157741977, 'recall': 0.4951173708920188, 'f1-score': 0.4679519889956293, 'support': 21300}, 'accuracy': 0.44916533201921893, 'macro avg': {'precision': 0.4511168010463036, 'recall': 0.4499500665592328, 'f1-score': 0.4488025241345606, 'support': 64936}, 'weighted avg': {'precision': 0.4525545668775754, 'recall': 0.44916533201921893, 'f1-score': 0.449072360432209, 'support': 64936}}
[[ 9091  4897  6696]
 [ 6891  9530  6531]
 [ 5902  4852 10546]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0552076
{'0': {'precision': 0.4208483630884434, 'recall': 0.4319523854156903, 'f1-score': 0.4263280834431878, 'support': 21338}, '1': {'precision': 0.46262093227792433, 'recall': 0.41277754696948715, 'f1-score': 0.43628024980484, 'support': 21663}, '2': {'precision': 0.44541466295452625, 'recall': 0.481376795076362, 'f1-score': 0.46269801275169253, 'support': 21935}, 'accuracy': 0.44225083158802514, 'macro avg': {'precision': 0.442961319440298, 'recall': 0.44203557582051317, 'f1-score': 0.44176878199990677, 'support': 64936}, 'weighted avg': {'precision': 0.4430822696104689, 'recall': 0.44225083158802514, 'f1-score': 0.441933728682724, 'support': 64936}}
[[ 9217  5218  6903]
 [ 6477  8942  6244]
 [ 6207  5169 10559]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0703033
{'0': {'precision': 0.41014837882396044, 'recall': 0.41966168408228294, 'f1-score': 0.41485049910832156, 'support': 21341}, '1': {'precision': 0.4402969684471025, 'recall': 0.391115182047172, 'f1-score': 0.4142514127719435, 'support': 21835}, '2': {'precision': 0.42511812352345596, 'recall': 0.4630974264705882, 'f1-score': 0.4432957944747492, 'support': 21760}, 'accuracy': 0.4246180854995688, 'macro avg': {'precision': 0.425187823598173, 'recall': 0.42462476420001444, 'f1-score': 0.42413256878500477, 'support': 64936}, 'weighted avg': {'precision': 0.4253023165331253, 'recall': 0.4246180854995688, 'f1-score': 0.4241810488344927, 'support': 64936}}
[[ 8956  5478  6907]
 [ 6575  8540  6720]
 [ 6305  5378 10077]]
Evaluating performance on  val set...
81/81 - 1s - 1s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.106378
{'0': {'precision': 0.337867919861489, 'recall': 0.46933516577907575, 'f1-score': 0.3928956640540735, 'support': 5821}, '1': {'precision': 0.5290251916757941, 'recall': 0.2696215250641956, 'f1-score': 0.3571956811122615, 'support': 8957}, '2': {'precision': 0.35136831534019586, 'recall': 0.47936290460695324, 'f1-score': 0.4055052517203912, 'support': 5839}, 'accuracy': 0.3854100984624339, 'macro avg': {'precision': 0.406087142292493, 'recall': 0.40610653181674156, 'f1-score': 0.38519886562890876, 'support': 20617}, 'weighted avg': {'precision': 0.4247391665433971, 'recall': 0.3854100984624339, 'f1-score': 0.38095710049845527, 'support': 20617}}
[[2732 1046 2043]
 [3418 2415 3124]
 [1936 1104 2799]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0889596
{'0': {'precision': 0.39992600813910467, 'recall': 0.46448009166427956, 'f1-score': 0.4297925916108939, 'support': 6982}, '1': {'precision': 0.4172773706417944, 'recall': 0.2792806183115339, 'f1-score': 0.3346095628172024, 'support': 6728}, '2': {'precision': 0.4057464084946908, 'recall': 0.47024757492399016, 'f1-score': 0.4356223175965665, 'support': 6907}, 'accuracy': 0.40597565116166273, 'macro avg': {'precision': 0.4076499290918633, 'recall': 0.4046694282999345, 'f1-score': 0.4000081573415543, 'support': 20617}, 'weighted avg': {'precision': 0.4075382442633773, 'recall': 0.40597565116166273, 'f1-score': 0.40068430716888415, 'support': 20617}}
[[3243 1279 2460]
 [2552 1879 2297]
 [2314 1345 3248]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0919484
{'0': {'precision': 0.4073618121383725, 'recall': 0.46208630079597823, 'f1-score': 0.43300183198115677, 'support': 7161}, '1': {'precision': 0.3795620437956204, 'recall': 0.2718200538571202, 'f1-score': 0.3167805058150267, 'support': 6313}, '2': {'precision': 0.4107613194531544, 'recall': 0.4584908301833963, 'f1-score': 0.4333156919820058, 'support': 7143}, 'accuracy': 0.4025803948198089, 'macro avg': {'precision': 0.3992283917957158, 'recall': 0.3974657282788316, 'f1-score': 0.3943660099260631, 'support': 20617}, 'weighted avg': {'precision': 0.40002722142205555, 'recall': 0.4025803948198089, 'f1-score': 0.3975231818331859, 'support': 20617}}
[[3309 1360 2492]
 [2391 1716 2206]
 [2423 1445 3275]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1009973
{'0': {'precision': 0.40509774808215787, 'recall': 0.4496635077599231, 'f1-score': 0.42621883746664063, 'support': 7281}, '1': {'precision': 0.3380900109769484, 'recall': 0.25093693987290205, 'f1-score': 0.2880658436213992, 'support': 6137}, '2': {'precision': 0.4012531328320802, 'recall': 0.4447839977774691, 'f1-score': 0.42189867580209495, 'support': 7199}, 'accuracy': 0.38880535480428774, 'macro avg': {'precision': 0.3814802972970622, 'recall': 0.3817948151367647, 'f1-score': 0.3787277856300449, 'support': 20617}, 'weighted avg': {'precision': 0.3838093032162715, 'recall': 0.38880535480428774, 'f1-score': 0.383586749041976, 'support': 20617}}
[[3274 1462 2545]
 [2364 1540 2233]
 [2444 1553 3202]]
training model: results/LILAK/W5/deepLOB_L1/seq2seq
Epoch 1/50
273/273 - 11s - loss: 12.9906 - accuracy10: 0.3972 - accuracy20: 0.4036 - accuracy30: 0.4031 - accuracy50: 0.3950 - val_loss: 13.6479 - val_accuracy10: 0.4351 - val_accuracy20: 0.3666 - val_accuracy30: 0.3413 - val_accuracy50: 0.3417 - 11s/epoch - 42ms/step
Epoch 2/50
273/273 - 6s - loss: 12.8569 - accuracy10: 0.4102 - accuracy20: 0.4209 - accuracy30: 0.4231 - accuracy50: 0.4133 - val_loss: 13.4187 - val_accuracy10: 0.4359 - val_accuracy20: 0.3841 - val_accuracy30: 0.3524 - val_accuracy50: 0.3481 - 6s/epoch - 22ms/step
Epoch 3/50
273/273 - 6s - loss: 12.7483 - accuracy10: 0.4189 - accuracy20: 0.4335 - accuracy30: 0.4366 - accuracy50: 0.4255 - val_loss: 13.1785 - val_accuracy10: 0.4386 - val_accuracy20: 0.4038 - val_accuracy30: 0.3818 - val_accuracy50: 0.3783 - 6s/epoch - 22ms/step
Epoch 4/50
273/273 - 6s - loss: 12.6859 - accuracy10: 0.4236 - accuracy20: 0.4397 - accuracy30: 0.4442 - accuracy50: 0.4301 - val_loss: 13.3035 - val_accuracy10: 0.4337 - val_accuracy20: 0.4028 - val_accuracy30: 0.3779 - val_accuracy50: 0.3701 - 6s/epoch - 22ms/step
Epoch 5/50
273/273 - 6s - loss: 12.6426 - accuracy10: 0.4341 - accuracy20: 0.4468 - accuracy30: 0.4469 - accuracy50: 0.4308 - val_loss: 13.2125 - val_accuracy10: 0.4227 - val_accuracy20: 0.4004 - val_accuracy30: 0.3792 - val_accuracy50: 0.3722 - 6s/epoch - 22ms/step
Epoch 6/50
273/273 - 6s - loss: 12.6128 - accuracy10: 0.4368 - accuracy20: 0.4486 - accuracy30: 0.4483 - accuracy50: 0.4325 - val_loss: 13.1390 - val_accuracy10: 0.4197 - val_accuracy20: 0.4097 - val_accuracy30: 0.3914 - val_accuracy50: 0.3819 - 6s/epoch - 23ms/step
Epoch 7/50
273/273 - 6s - loss: 12.5935 - accuracy10: 0.4389 - accuracy20: 0.4511 - accuracy30: 0.4508 - accuracy50: 0.4338 - val_loss: 13.1828 - val_accuracy10: 0.4070 - val_accuracy20: 0.4000 - val_accuracy30: 0.3905 - val_accuracy50: 0.3869 - 6s/epoch - 21ms/step
Epoch 8/50
273/273 - 6s - loss: 12.5665 - accuracy10: 0.4441 - accuracy20: 0.4540 - accuracy30: 0.4532 - accuracy50: 0.4355 - val_loss: 13.1645 - val_accuracy10: 0.4131 - val_accuracy20: 0.4160 - val_accuracy30: 0.4030 - val_accuracy50: 0.3935 - 6s/epoch - 21ms/step
Epoch 9/50
273/273 - 6s - loss: 12.5290 - accuracy10: 0.4485 - accuracy20: 0.4576 - accuracy30: 0.4561 - accuracy50: 0.4365 - val_loss: 13.1004 - val_accuracy10: 0.4220 - val_accuracy20: 0.4232 - val_accuracy30: 0.4123 - val_accuracy50: 0.4016 - 6s/epoch - 22ms/step
Epoch 10/50
273/273 - 6s - loss: 12.5126 - accuracy10: 0.4492 - accuracy20: 0.4601 - accuracy30: 0.4576 - accuracy50: 0.4385 - val_loss: 13.1224 - val_accuracy10: 0.4305 - val_accuracy20: 0.4259 - val_accuracy30: 0.4114 - val_accuracy50: 0.4001 - 6s/epoch - 21ms/step
Epoch 11/50
273/273 - 6s - loss: 12.5045 - accuracy10: 0.4517 - accuracy20: 0.4601 - accuracy30: 0.4585 - accuracy50: 0.4375 - val_loss: 13.1396 - val_accuracy10: 0.4268 - val_accuracy20: 0.4261 - val_accuracy30: 0.4139 - val_accuracy50: 0.4009 - 6s/epoch - 21ms/step
Epoch 12/50
273/273 - 6s - loss: 12.4770 - accuracy10: 0.4559 - accuracy20: 0.4638 - accuracy30: 0.4605 - accuracy50: 0.4409 - val_loss: 13.1275 - val_accuracy10: 0.4159 - val_accuracy20: 0.4218 - val_accuracy30: 0.4130 - val_accuracy50: 0.4008 - 6s/epoch - 21ms/step
Epoch 13/50
273/273 - 6s - loss: 12.4656 - accuracy10: 0.4569 - accuracy20: 0.4625 - accuracy30: 0.4608 - accuracy50: 0.4405 - val_loss: 13.1559 - val_accuracy10: 0.4187 - val_accuracy20: 0.4244 - val_accuracy30: 0.4146 - val_accuracy50: 0.4047 - 6s/epoch - 21ms/step
Epoch 14/50
273/273 - 6s - loss: 12.4440 - accuracy10: 0.4621 - accuracy20: 0.4676 - accuracy30: 0.4631 - accuracy50: 0.4424 - val_loss: 13.0606 - val_accuracy10: 0.4401 - val_accuracy20: 0.4269 - val_accuracy30: 0.4112 - val_accuracy50: 0.3985 - 6s/epoch - 22ms/step
Epoch 15/50
273/273 - 6s - loss: 12.4157 - accuracy10: 0.4624 - accuracy20: 0.4686 - accuracy30: 0.4638 - accuracy50: 0.4437 - val_loss: 13.1289 - val_accuracy10: 0.4277 - val_accuracy20: 0.4291 - val_accuracy30: 0.4162 - val_accuracy50: 0.3998 - 6s/epoch - 22ms/step
Epoch 16/50
273/273 - 6s - loss: 12.3854 - accuracy10: 0.4687 - accuracy20: 0.4712 - accuracy30: 0.4654 - accuracy50: 0.4438 - val_loss: 13.1051 - val_accuracy10: 0.4175 - val_accuracy20: 0.4228 - val_accuracy30: 0.4119 - val_accuracy50: 0.4050 - 6s/epoch - 21ms/step
Epoch 17/50
273/273 - 6s - loss: 12.3601 - accuracy10: 0.4722 - accuracy20: 0.4749 - accuracy30: 0.4691 - accuracy50: 0.4463 - val_loss: 13.1537 - val_accuracy10: 0.4441 - val_accuracy20: 0.4354 - val_accuracy30: 0.4202 - val_accuracy50: 0.4062 - 6s/epoch - 21ms/step
Epoch 18/50
273/273 - 6s - loss: 12.3415 - accuracy10: 0.4702 - accuracy20: 0.4735 - accuracy30: 0.4693 - accuracy50: 0.4459 - val_loss: 13.1320 - val_accuracy10: 0.4299 - val_accuracy20: 0.4367 - val_accuracy30: 0.4256 - val_accuracy50: 0.4122 - 6s/epoch - 21ms/step
Epoch 19/50
273/273 - 6s - loss: 12.3168 - accuracy10: 0.4739 - accuracy20: 0.4789 - accuracy30: 0.4727 - accuracy50: 0.4498 - val_loss: 13.3122 - val_accuracy10: 0.4083 - val_accuracy20: 0.4197 - val_accuracy30: 0.4133 - val_accuracy50: 0.4035 - 6s/epoch - 21ms/step
Epoch 20/50
273/273 - 6s - loss: 12.3162 - accuracy10: 0.4741 - accuracy20: 0.4783 - accuracy30: 0.4732 - accuracy50: 0.4490 - val_loss: 13.1363 - val_accuracy10: 0.4045 - val_accuracy20: 0.4205 - val_accuracy30: 0.4171 - val_accuracy50: 0.4076 - 6s/epoch - 21ms/step
Epoch 21/50
273/273 - 6s - loss: 12.2877 - accuracy10: 0.4760 - accuracy20: 0.4795 - accuracy30: 0.4738 - accuracy50: 0.4496 - val_loss: 13.3167 - val_accuracy10: 0.3961 - val_accuracy20: 0.4183 - val_accuracy30: 0.4146 - val_accuracy50: 0.4076 - 6s/epoch - 21ms/step
Epoch 22/50
273/273 - 6s - loss: 12.2721 - accuracy10: 0.4786 - accuracy20: 0.4832 - accuracy30: 0.4777 - accuracy50: 0.4533 - val_loss: 13.4173 - val_accuracy10: 0.3921 - val_accuracy20: 0.4159 - val_accuracy30: 0.4158 - val_accuracy50: 0.4081 - 6s/epoch - 21ms/step
Epoch 23/50
273/273 - 6s - loss: 12.2620 - accuracy10: 0.4790 - accuracy20: 0.4837 - accuracy30: 0.4795 - accuracy50: 0.4536 - val_loss: 13.5371 - val_accuracy10: 0.3923 - val_accuracy20: 0.4188 - val_accuracy30: 0.4212 - val_accuracy50: 0.4095 - 6s/epoch - 22ms/step
Epoch 24/50
273/273 - 6s - loss: 12.2217 - accuracy10: 0.4831 - accuracy20: 0.4891 - accuracy30: 0.4831 - accuracy50: 0.4551 - val_loss: 13.5655 - val_accuracy10: 0.3929 - val_accuracy20: 0.4166 - val_accuracy30: 0.4182 - val_accuracy50: 0.4077 - 6s/epoch - 22ms/step
testing model: results/LILAK/W5/deepLOB_L1/seq2seq
Evaluating performance on  test set...
1060/1060 - 10s - 10s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1083941
{'0': {'precision': 0.3952438984223181, 'recall': 0.6729626057112094, 'f1-score': 0.49800176790627615, 'support': 89158}, '1': {'precision': 0.4014914872660757, 'recall': 0.2938529190653224, 'f1-score': 0.3393410357191702, 'support': 97103}, '2': {'precision': 0.42437816080090823, 'recall': 0.24170281804394597, 'f1-score': 0.30799077181208057, 'support': 85059}, 'accuracy': 0.4020824119121333, 'macro avg': {'precision': 0.4070378488297674, 'recall': 0.40283944760682594, 'f1-score': 0.3817778584791756, 'support': 271320}, 'weighted avg': {'precision': 0.4066134651448446, 'recall': 0.4020824119121333, 'f1-score': 0.3816499383531996, 'support': 271320}}
[[60000 18237 10921]
 [51604 28534 16965]
 [40201 24299 20559]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1240805
{'0': {'precision': 0.4427576929544308, 'recall': 0.6404339154545897, 'f1-score': 0.5235584188340093, 'support': 102785}, '1': {'precision': 0.29205240859877607, 'recall': 0.3113022147267482, 'f1-score': 0.3013702326899334, 'support': 71747}, '2': {'precision': 0.465485498927852, 'recall': 0.2220419886762822, 'f1-score': 0.30066383597865093, 'support': 96788}, 'accuracy': 0.40414639540026537, 'macro avg': {'precision': 0.40009853349368635, 'recall': 0.39125937295254, 'f1-score': 0.37519749583419787, 'support': 271320}, 'weighted avg': {'precision': 0.4110133572913405, 'recall': 0.40414639540026537, 'f1-score': 0.38529048179772946, 'support': 271320}}
[[65827 24378 12580]
 [37314 22335 12098]
 [45534 29763 21491]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1334717
{'0': {'precision': 0.45191156797859605, 'recall': 0.6049595656845558, 'f1-score': 0.5173539463502708, 'support': 106098}, '1': {'precision': 0.25643116786280173, 'recall': 0.33972340556893255, 'f1-score': 0.2922586641880228, 'support': 64788}, '2': {'precision': 0.4700170279350177, 'recall': 0.20337734233426927, 'f1-score': 0.2839073749756762, 'support': 100434}, 'accuracy': 0.3929713990859502, 'macro avg': {'precision': 0.3927865879254719, 'recall': 0.3826867711959192, 'f1-score': 0.3645066618379899, 'support': 271320}, 'weighted avg': {'precision': 0.4119352286101793, 'recall': 0.3929713990859502, 'f1-score': 0.3771893949343643, 'support': 271320}}
[[64185 29387 12526]
 [32272 22010 10506]
 [45573 34435 20426]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.140828
{'0': {'precision': 0.42620937123118385, 'recall': 0.5625970401525128, 'f1-score': 0.4849971197180713, 'support': 101762}, '1': {'precision': 0.2665459352005079, 'recall': 0.3643062391533187, 'f1-score': 0.3078513514325726, 'support': 70298}, '2': {'precision': 0.4452130129787598, 'recall': 0.18350795889582913, 'f1-score': 0.2598931320582423, 'support': 99260}, 'accuracy': 0.3725342768686422, 'macro avg': {'precision': 0.3793227731368172, 'recall': 0.37013707940055357, 'f1-score': 0.35091386773629535, 'support': 271320}, 'weighted avg': {'precision': 0.3917934831793629, 'recall': 0.3725342768686422, 'f1-score': 0.35674702745045883, 'support': 271320}}
[[57251 32777 11734]
 [33724 25610 10964]
 [43351 37694 18215]]
Evaluating performance on  train set...
273/273 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0316818
{'0': {'precision': 0.36561743341404357, 'recall': 0.5203478831637677, 'f1-score': 0.429471118033453, 'support': 18282}, '1': {'precision': 0.5550858396798761, 'recall': 0.5233039245512625, 'f1-score': 0.5387265495317737, 'support': 32870}, '2': {'precision': 0.4257621228873796, 'recall': 0.2911378733056111, 'f1-score': 0.3458096795920331, 'support': 18517}, 'accuracy': 0.4608218863483041, 'macro avg': {'precision': 0.4488217986604331, 'recall': 0.44492989367354707, 'f1-score': 0.4380024490524199, 'support': 69669}, 'weighted avg': {'precision': 0.4709946561233645, 'recall': 0.4608218863483041, 'f1-score': 0.4587821053840685, 'support': 69669}}
[[ 9513  6664  2105]
 [10503 17201  5166]
 [ 6003  7123  5391]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0644108
{'0': {'precision': 0.41850725038523845, 'recall': 0.483189635509329, 'f1-score': 0.44852847766250264, 'support': 21921}, '1': {'precision': 0.4391006782075501, 'recall': 0.5547990765739328, 'f1-score': 0.49021573779560224, 'support': 25557}, '2': {'precision': 0.482475764354959, 'recall': 0.2624036771664188, 'f1-score': 0.3399299474605955, 'support': 22191}, 'accuracy': 0.43913361753434094, 'macro avg': {'precision': 0.44669456431591587, 'recall': 0.43346412974989357, 'f1-score': 0.42622472097290015, 'support': 69669}, 'weighted avg': {'precision': 0.44643691104287514, 'recall': 0.43913361753434094, 'f1-score': 0.4292299564193544, 'support': 69669}}
[[10592  8809  2520]
 [ 7652 14179  3726]
 [ 7065  9303  5823]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0820379
{'0': {'precision': 0.4371825546740545, 'recall': 0.44512351483032736, 'f1-score': 0.4411172995065754, 'support': 23398}, '1': {'precision': 0.38430530986283096, 'recall': 0.5819682930042598, 'f1-score': 0.4629196213365005, 'support': 22771}, '2': {'precision': 0.4962597905482707, 'recall': 0.23995744680851064, 'f1-score': 0.32349482259128587, 'support': 23500}, 'accuracy': 0.4206461984526834, 'macro avg': {'precision': 0.4392492183617187, 'recall': 0.42234975154769927, 'f1-score': 0.4091772478114539, 'support': 69669}, 'weighted avg': {'precision': 0.4398271642055206, 'recall': 0.4206461984526834, 'f1-score': 0.40856813794088515, 'support': 69669}}
[[10415 10390  2593]
 [ 6388 13252  3131]
 [ 7020 10841  5639]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0935681
{'0': {'precision': 0.4262680095749966, 'recall': 0.40309216707952505, 'f1-score': 0.4143562726374712, 'support': 23414}, '1': {'precision': 0.3718464549804263, 'recall': 0.595472355245973, 'f1-score': 0.4578103557920809, 'support': 22970}, '2': {'precision': 0.47728965003723006, 'recall': 0.2202276143439983, 'f1-score': 0.30138999089012314, 'support': 23285}, 'accuracy': 0.405402689862062, 'macro avg': {'precision': 0.4251347048642176, 'recall': 0.40626404555649875, 'f1-score': 0.3911855397732251, 'support': 69669}, 'weighted avg': {'precision': 0.42537773971502774, 'recall': 0.405402689862062, 'f1-score': 0.3909272069062906, 'support': 69669}}
[[ 9438 11445  2531]
 [ 6207 13678  3085]
 [ 6496 11661  5128]]
Evaluating performance on  val set...
96/96 - 1s - 739ms/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0541952
{'0': {'precision': 0.3602408505033399, 'recall': 0.5647492625368732, 'f1-score': 0.4398874145556896, 'support': 6780}, '1': {'precision': 0.5388782664117272, 'recall': 0.45009315943572, 'f1-score': 0.4905003625815809, 'support': 11271}, '2': {'precision': 0.41633019291161955, 'recall': 0.2877519379844961, 'f1-score': 0.34030069673634034, 'support': 6450}, 'accuracy': 0.4390841190155504, 'macro avg': {'precision': 0.4384831032755622, 'recall': 0.4341981199856964, 'f1-score': 0.4235628246245369, 'support': 24501}, 'weighted avg': {'precision': 0.457183774189591, 'recall': 0.4390841190155504, 'f1-score': 0.43695382846797953, 'support': 24501}}
[[3829 2168  783]
 [4379 5073 1819]
 [2421 2173 1856]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0750258
{'0': {'precision': 0.41241086914627095, 'recall': 0.5354685349680971, 'f1-score': 0.46595177181427244, 'support': 7993}, '1': {'precision': 0.4282977006857604, 'recall': 0.4795618789521229, 'f1-score': 0.452482420626465, 'support': 8856}, '2': {'precision': 0.46874257190396956, 'recall': 0.25771040250914795, 'f1-score': 0.3325744160553166, 'support': 7652}, 'accuracy': 0.4285131219133913, 'macro avg': {'precision': 0.4364837139120003, 'recall': 0.4242469388097893, 'f1-score': 0.4170028694986847, 'support': 24501}, 'weighted avg': {'precision': 0.43574640523115027, 'recall': 0.4285131219133913, 'f1-score': 0.41942762584526083, 'support': 24501}}
[[4280 2841  872]
 [3246 4247 1363]
 [2852 2828 1972]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0904827
{'0': {'precision': 0.42067162678463704, 'recall': 0.49750297265160526, 'f1-score': 0.4558727391588582, 'support': 8410}, '1': {'precision': 0.37714930000939584, 'recall': 0.5035122930255895, 'f1-score': 0.4312651087832393, 'support': 7972}, '2': {'precision': 0.47418200408997957, 'recall': 0.22847641335139796, 'f1-score': 0.3083700440528635, 'support': 8119}, 'accuracy': 0.4103097832741521, 'macro avg': {'precision': 0.4240009769613375, 'recall': 0.4098305596761975, 'f1-score': 0.39850263066498703, 'support': 24501}, 'weighted avg': {'precision': 0.4242425326370452, 'recall': 0.4103097832741521, 'f1-score': 0.3989874523983176, 'support': 24501}}
[[4184 3316  910]
 [2811 4014 1147]
 [2951 3313 1855]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1013432
{'0': {'precision': 0.4086078639744952, 'recall': 0.4619173474291206, 'f1-score': 0.43363031464982515, 'support': 8324}, '1': {'precision': 0.365381259815041, 'recall': 0.5242864296444667, 'f1-score': 0.4306426735218509, 'support': 7988}, '2': {'precision': 0.46459079636263434, 'recall': 0.2058859445597753, 'f1-score': 0.2853274665764089, 'support': 8189}, 'accuracy': 0.3966776866250357, 'macro avg': {'precision': 0.41285997338405683, 'recall': 0.3973632405444542, 'f1-score': 0.383200151582695, 'support': 24501}, 'weighted avg': {'precision': 0.4132260476935577, 'recall': 0.3966776866250357, 'f1-score': 0.38308881429459624, 'support': 24501}}
[[3845 3636  843]
 [2700 4188 1100]
 [2865 3638 1686]]
training model: results/LILAK/W5/deepOF_L1/seq2seq
Epoch 1/50
273/273 - 11s - loss: 13.1532 - accuracy10: 0.3750 - accuracy20: 0.3742 - accuracy30: 0.3737 - accuracy50: 0.3691 - val_loss: 14.5692 - val_accuracy10: 0.4521 - val_accuracy20: 0.3586 - val_accuracy30: 0.3273 - val_accuracy50: 0.3299 - 11s/epoch - 41ms/step
Epoch 2/50
273/273 - 6s - loss: 13.1105 - accuracy10: 0.3873 - accuracy20: 0.3767 - accuracy30: 0.3765 - accuracy50: 0.3731 - val_loss: 14.4675 - val_accuracy10: 0.4515 - val_accuracy20: 0.3598 - val_accuracy30: 0.3284 - val_accuracy50: 0.3308 - 6s/epoch - 20ms/step
Epoch 3/50
273/273 - 5s - loss: 13.0713 - accuracy10: 0.3930 - accuracy20: 0.3813 - accuracy30: 0.3810 - accuracy50: 0.3754 - val_loss: 14.4644 - val_accuracy10: 0.4522 - val_accuracy20: 0.3624 - val_accuracy30: 0.3301 - val_accuracy50: 0.3330 - 5s/epoch - 20ms/step
Epoch 4/50
273/273 - 5s - loss: 13.0348 - accuracy10: 0.4051 - accuracy20: 0.3891 - accuracy30: 0.3851 - accuracy50: 0.3812 - val_loss: 14.4638 - val_accuracy10: 0.4532 - val_accuracy20: 0.3612 - val_accuracy30: 0.3289 - val_accuracy50: 0.3321 - 5s/epoch - 20ms/step
Epoch 5/50
273/273 - 5s - loss: 13.0150 - accuracy10: 0.4103 - accuracy20: 0.3924 - accuracy30: 0.3889 - accuracy50: 0.3843 - val_loss: 14.4528 - val_accuracy10: 0.4557 - val_accuracy20: 0.3653 - val_accuracy30: 0.3327 - val_accuracy50: 0.3349 - 5s/epoch - 20ms/step
Epoch 6/50
273/273 - 5s - loss: 12.9988 - accuracy10: 0.4137 - accuracy20: 0.3963 - accuracy30: 0.3908 - accuracy50: 0.3830 - val_loss: 14.4368 - val_accuracy10: 0.4561 - val_accuracy20: 0.3657 - val_accuracy30: 0.3337 - val_accuracy50: 0.3343 - 5s/epoch - 20ms/step
Epoch 7/50
273/273 - 5s - loss: 12.9732 - accuracy10: 0.4193 - accuracy20: 0.4023 - accuracy30: 0.3982 - accuracy50: 0.3890 - val_loss: 14.4844 - val_accuracy10: 0.4546 - val_accuracy20: 0.3653 - val_accuracy30: 0.3345 - val_accuracy50: 0.3338 - 5s/epoch - 20ms/step
Epoch 8/50
273/273 - 5s - loss: 12.9535 - accuracy10: 0.4200 - accuracy20: 0.4025 - accuracy30: 0.3984 - accuracy50: 0.3876 - val_loss: 14.3810 - val_accuracy10: 0.4543 - val_accuracy20: 0.3656 - val_accuracy30: 0.3346 - val_accuracy50: 0.3344 - 5s/epoch - 20ms/step
Epoch 9/50
273/273 - 5s - loss: 12.9408 - accuracy10: 0.4249 - accuracy20: 0.4066 - accuracy30: 0.4022 - accuracy50: 0.3908 - val_loss: 14.3122 - val_accuracy10: 0.4548 - val_accuracy20: 0.3680 - val_accuracy30: 0.3372 - val_accuracy50: 0.3360 - 5s/epoch - 20ms/step
Epoch 10/50
273/273 - 6s - loss: 12.9195 - accuracy10: 0.4252 - accuracy20: 0.4102 - accuracy30: 0.4056 - accuracy50: 0.3950 - val_loss: 14.3691 - val_accuracy10: 0.4543 - val_accuracy20: 0.3697 - val_accuracy30: 0.3372 - val_accuracy50: 0.3376 - 6s/epoch - 20ms/step
Epoch 11/50
273/273 - 5s - loss: 12.9003 - accuracy10: 0.4250 - accuracy20: 0.4138 - accuracy30: 0.4082 - accuracy50: 0.3969 - val_loss: 14.3703 - val_accuracy10: 0.4556 - val_accuracy20: 0.3686 - val_accuracy30: 0.3381 - val_accuracy50: 0.3382 - 5s/epoch - 20ms/step
Epoch 12/50
273/273 - 5s - loss: 12.8762 - accuracy10: 0.4283 - accuracy20: 0.4175 - accuracy30: 0.4117 - accuracy50: 0.4005 - val_loss: 14.4673 - val_accuracy10: 0.4548 - val_accuracy20: 0.3677 - val_accuracy30: 0.3373 - val_accuracy50: 0.3371 - 5s/epoch - 20ms/step
Epoch 13/50
273/273 - 5s - loss: 12.8638 - accuracy10: 0.4286 - accuracy20: 0.4185 - accuracy30: 0.4135 - accuracy50: 0.4027 - val_loss: 14.5056 - val_accuracy10: 0.4563 - val_accuracy20: 0.3688 - val_accuracy30: 0.3376 - val_accuracy50: 0.3357 - 5s/epoch - 20ms/step
Epoch 14/50
273/273 - 5s - loss: 12.8437 - accuracy10: 0.4276 - accuracy20: 0.4203 - accuracy30: 0.4156 - accuracy50: 0.4040 - val_loss: 14.5293 - val_accuracy10: 0.4543 - val_accuracy20: 0.3672 - val_accuracy30: 0.3376 - val_accuracy50: 0.3378 - 5s/epoch - 20ms/step
Epoch 15/50
273/273 - 5s - loss: 12.8262 - accuracy10: 0.4297 - accuracy20: 0.4225 - accuracy30: 0.4179 - accuracy50: 0.4072 - val_loss: 14.6824 - val_accuracy10: 0.4539 - val_accuracy20: 0.3661 - val_accuracy30: 0.3346 - val_accuracy50: 0.3362 - 5s/epoch - 20ms/step
Epoch 16/50
273/273 - 5s - loss: 12.7964 - accuracy10: 0.4318 - accuracy20: 0.4267 - accuracy30: 0.4217 - accuracy50: 0.4100 - val_loss: 14.7218 - val_accuracy10: 0.4548 - val_accuracy20: 0.3669 - val_accuracy30: 0.3356 - val_accuracy50: 0.3375 - 5s/epoch - 20ms/step
Epoch 17/50
273/273 - 5s - loss: 12.7902 - accuracy10: 0.4315 - accuracy20: 0.4270 - accuracy30: 0.4250 - accuracy50: 0.4123 - val_loss: 14.6641 - val_accuracy10: 0.4539 - val_accuracy20: 0.3686 - val_accuracy30: 0.3367 - val_accuracy50: 0.3364 - 5s/epoch - 20ms/step
Epoch 18/50
273/273 - 5s - loss: 12.7729 - accuracy10: 0.4323 - accuracy20: 0.4289 - accuracy30: 0.4284 - accuracy50: 0.4152 - val_loss: 14.5107 - val_accuracy10: 0.4561 - val_accuracy20: 0.3695 - val_accuracy30: 0.3390 - val_accuracy50: 0.3370 - 5s/epoch - 20ms/step
Epoch 19/50
273/273 - 5s - loss: 12.7415 - accuracy10: 0.4372 - accuracy20: 0.4356 - accuracy30: 0.4343 - accuracy50: 0.4222 - val_loss: 14.5167 - val_accuracy10: 0.4554 - val_accuracy20: 0.3733 - val_accuracy30: 0.3418 - val_accuracy50: 0.3397 - 5s/epoch - 20ms/step
testing model: results/LILAK/W5/deepOF_L1/seq2seq
Evaluating performance on  test set...
1060/1060 - 10s - 10s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1717359
{'0': {'precision': 0.429020841525757, 'recall': 0.02447395576293239, 'f1-score': 0.0463063177776363, 'support': 89156}, '1': {'precision': 0.37063040486412097, 'recall': 0.9291047466040514, 'f1-score': 0.5298840583115038, 'support': 97101}, '2': {'precision': 0.41746296133952837, 'recall': 0.11197065531754803, 'f1-score': 0.17657964995550282, 'support': 85058}, 'accuracy': 0.3756629747710226, 'macro avg': {'precision': 0.4057047359098021, 'recall': 0.3551831192281773, 'f1-score': 0.2509233420148809, 'support': 271315}, 'weighted avg': {'precision': 0.40450004480179497, 'recall': 0.3756629747710226, 'f1-score': 0.2602151369434179, 'support': 271315}}
[[ 2182 79124  7850]
 [ 1444 90217  5440]
 [ 1460 74074  9524]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2614796
{'0': {'precision': 0.48485523385300666, 'recall': 0.021180751493452162, 'f1-score': 0.04058841076888658, 'support': 102782}, '1': {'precision': 0.2728090689125492, 'recall': 0.9381977838176876, 'f1-score': 0.4227042370273614, 'support': 71745}, '2': {'precision': 0.4467947441767868, 'recall': 0.09274910112823903, 'f1-score': 0.15361054072553043, 'support': 96788}, 'accuracy': 0.2892025873984114, 'macro avg': {'precision': 0.4014863489807809, 'recall': 0.3507092121464596, 'f1-score': 0.20563439617392612, 'support': 271315}, 'weighted avg': {'precision': 0.4152053774925582, 'recall': 0.2892025873984114, 'f1-score': 0.18195208719355133, 'support': 271315}}
[[ 2177 93081  7524]
 [  843 67311  3591]
 [ 1470 86341  8977]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2763267
{'0': {'precision': 0.4941429595983744, 'recall': 0.019482539233705642, 'f1-score': 0.037487078111681386, 'support': 106095}, '1': {'precision': 0.24437796120743172, 'recall': 0.9418392862655512, 'f1-score': 0.3880651121081937, 'support': 64786}, '2': {'precision': 0.45428489538549727, 'recall': 0.07890754127088437, 'f1-score': 0.13445991228293422, 'support': 100434}, 'accuracy': 0.261725300849566, 'macro avg': {'precision': 0.3976019387304344, 'recall': 0.3467431222567137, 'f1-score': 0.18667070083426976, 'support': 271315}, 'weighted avg': {'precision': 0.419748326028864, 'recall': 0.261725300849566, 'f1-score': 0.15709682374923795, 'support': 271315}}
[[ 2067 97500  6528]
 [  776 61018  2992]
 [ 1340 91169  7925]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2476652
{'0': {'precision': 0.49431674665319525, 'recall': 0.019231714148134318, 'f1-score': 0.037023023515390004, 'support': 101759}, '1': {'precision': 0.2619777761027647, 'recall': 0.9393866112833935, 'f1-score': 0.40969820299098236, 'support': 70298}, '2': {'precision': 0.43735688583578675, 'recall': 0.06734973503395192, 'f1-score': 0.1167247234662965, 'support': 99258}, 'accuracy': 0.275248327589702, 'macro avg': {'precision': 0.39788380286391556, 'recall': 0.34198935348849324, 'f1-score': 0.18781531665755627, 'support': 271315}, 'weighted avg': {'precision': 0.4132792558518444, 'recall': 0.275248327589702, 'f1-score': 0.16274165720870687, 'support': 271315}}
[[ 1957 94618  5184]
 [  845 66037  3416]
 [ 1157 91416  6685]]
Evaluating performance on  train set...
273/273 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0620718
{'0': {'precision': 0.3959683225341973, 'recall': 0.030044794056593466, 'f1-score': 0.05585173902005584, 'support': 18306}, '1': {'precision': 0.48459818951440303, 'recall': 0.9294836708629812, 'f1-score': 0.6370580327834686, 'support': 32886}, '2': {'precision': 0.3675509419454056, 'recall': 0.10348560294436025, 'f1-score': 0.16150012669989017, 'support': 18476}, 'accuracy': 0.47409140494918756, 'macro avg': {'precision': 0.41603915133133534, 'recall': 0.3543380226213116, 'f1-score': 0.2848032995011382, 'support': 69668}, 'weighted avg': {'precision': 0.43026875145066584, 'recall': 0.47409140494918756, 'f1-score': 0.35822169061154996, 'support': 69668}}
[[  550 16270  1486]
 [  515 30567  1804]
 [  324 16240  1912]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1620327
{'0': {'precision': 0.459983831851253, 'recall': 0.025917828186207525, 'f1-score': 0.04907076020870166, 'support': 21954}, '1': {'precision': 0.37634341218862605, 'recall': 0.9389095172952903, 'f1-score': 0.5373147682156237, 'support': 25585}, '2': {'precision': 0.408389480547707, 'recall': 0.08491120249446428, 'f1-score': 0.14059109614665172, 'support': 22129}, 'accuracy': 0.37994488143767585, 'macro avg': {'precision': 0.4149055748625287, 'recall': 0.3499128493253207, 'f1-score': 0.242325541523659, 'support': 69668}, 'weighted avg': {'precision': 0.41287940030356285, 'recall': 0.37994488143767585, 'f1-score': 0.257444424715046, 'support': 69668}}
[[  569 19881  1504]
 [  345 24022  1218]
 [  323 19927  1879]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1922767
{'0': {'precision': 0.497789566755084, 'recall': 0.02413201885983712, 'f1-score': 0.04603245983402151, 'support': 23330}, '1': {'precision': 0.33429935219911355, 'recall': 0.9435307497156854, 'f1-score': 0.49368334325078955, 'support': 22862}, '2': {'precision': 0.4268262278733483, 'recall': 0.0729255409780201, 'f1-score': 0.1245679775894059, 'support': 23476}, 'accuracy': 0.34228053051616236, 'macro avg': {'precision': 0.41963838227584865, 'recall': 0.34686276985118086, 'f1-score': 0.22142792689140564, 'support': 69668}, 'weighted avg': {'precision': 0.4202267168273378, 'recall': 0.34228053051616236, 'f1-score': 0.21939604586346909, 'support': 69668}}
[[  563 21482  1285]
 [  277 21571  1014]
 [  291 21473  1712]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1854419
{'0': {'precision': 0.4905838041431262, 'recall': 0.022284003421727972, 'f1-score': 0.04263153588086081, 'support': 23380}, '1': {'precision': 0.3333743123213572, 'recall': 0.9435866208516376, 'f1-score': 0.4926815420428093, 'support': 22991}, '2': {'precision': 0.41336353340883353, 'recall': 0.06266901317766237, 'f1-score': 0.10883745201088374, 'support': 23297}, 'accuracy': 0.33982603203766437, 'macro avg': {'precision': 0.4124405499577723, 'recall': 0.3428465458170093, 'f1-score': 0.21471684331151794, 'support': 69668}, 'weighted avg': {'precision': 0.41288092658425973, 'recall': 0.33982603203766437, 'f1-score': 0.21329093359215584, 'support': 69668}}
[[  521 21802  1057]
 [  282 21694  1015]
 [  259 21578  1460]]
Evaluating performance on  val set...
96/96 - 1s - 719ms/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0789489
{'0': {'precision': 0.3450087565674256, 'recall': 0.02909896602658789, 'f1-score': 0.05367116196703447, 'support': 6770}, '1': {'precision': 0.4709534979991721, 'recall': 0.9111862596778499, 'f1-score': 0.6209594274971193, 'support': 11237}, '2': {'precision': 0.33896756509821835, 'recall': 0.11425931629196182, 'f1-score': 0.1709086721179316, 'support': 6494}, 'accuracy': 0.4562262764785111, 'macro avg': {'precision': 0.3849766065549387, 'recall': 0.35151484733213323, 'f1-score': 0.2818464205273618, 'support': 24501}, 'weighted avg': {'precision': 0.40117011986147494, 'recall': 0.4562262764785111, 'f1-score': 0.3449228917201666, 'support': 24501}}
[[  197  5904   669]
 [  220 10239   778]
 [  154  5598   742]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1677967
{'0': {'precision': 0.3996101364522417, 'recall': 0.025593008739076155, 'f1-score': 0.04810512730259298, 'support': 8010}, '1': {'precision': 0.3676023763094644, 'recall': 0.9173834314169307, 'f1-score': 0.5248810179039725, 'support': 8836}, '2': {'precision': 0.3706763035622096, 'recall': 0.0937949052906597, 'f1-score': 0.14970809007506256, 'support': 7655}, 'accuracy': 0.3685155707930289, 'macro avg': {'precision': 0.37929627210797195, 'recall': 0.34559044848222215, 'f1-score': 0.24089807842720934, 'support': 24501}, 'weighted avg': {'precision': 0.3790269333423778, 'recall': 0.3685155707930289, 'f1-score': 0.25179324000725983, 'support': 24501}}
[[ 205 7154  651]
 [ 162 8106  568]
 [ 146 6791  718]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1904564
{'0': {'precision': 0.4180327868852459, 'recall': 0.024320457796852647, 'f1-score': 0.04596665164488508, 'support': 8388}, '1': {'precision': 0.33151102348091055, 'recall': 0.9239415511427501, 'f1-score': 0.4879464432938693, 'support': 8007}, '2': {'precision': 0.38361814967589863, 'recall': 0.08031088082901554, 'f1-score': 0.13281648474956645, 'support': 8106}, 'accuracy': 0.3368433941471777, 'macro avg': {'precision': 0.37772065334735166, 'recall': 0.3428576299228728, 'f1-score': 0.22224319322944028, 'support': 24501}, 'weighted avg': {'precision': 0.37837135229900526, 'recall': 0.3368433941471777, 'f1-score': 0.21914068286320124, 'support': 24501}}
[[ 204 7596  588]
 [ 151 7398  458]
 [ 133 7322  651]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1808443
{'0': {'precision': 0.43844492440604754, 'recall': 0.024457831325301205, 'f1-score': 0.04633116512609836, 'support': 8300}, '1': {'precision': 0.3307883522727273, 'recall': 0.9275578790141897, 'f1-score': 0.48766441986780973, 'support': 8034}, '2': {'precision': 0.39536423841059604, 'recall': 0.07309905718133954, 'f1-score': 0.12338534669835693, 'support': 8167}, 'accuracy': 0.33680257948655157, 'macro avg': {'precision': 0.38819917169645696, 'recall': 0.3417049225069435, 'f1-score': 0.219126977230755, 'support': 24501}, 'weighted avg': {'precision': 0.38878356923507706, 'recall': 0.33680257948655157, 'f1-score': 0.21673126591772093, 'support': 24501}}
[[ 203 7614  483]
 [ 152 7452  430]
 [ 108 7462  597]]
training model: results/LILAK/W5/deepLOB_L2/seq2seq
Epoch 1/50
273/273 - 18s - loss: 13.2030 - accuracy10: 0.3727 - accuracy20: 0.3752 - accuracy30: 0.3748 - accuracy50: 0.3697 - val_loss: 14.0842 - val_accuracy10: 0.4528 - val_accuracy20: 0.3591 - val_accuracy30: 0.3238 - val_accuracy50: 0.3248 - 18s/epoch - 68ms/step
Epoch 2/50
273/273 - 13s - loss: 13.0108 - accuracy10: 0.3869 - accuracy20: 0.3959 - accuracy30: 0.3999 - accuracy50: 0.3954 - val_loss: 13.9926 - val_accuracy10: 0.4440 - val_accuracy20: 0.3629 - val_accuracy30: 0.3333 - val_accuracy50: 0.3337 - 13s/epoch - 47ms/step
Epoch 3/50
273/273 - 13s - loss: 12.8767 - accuracy10: 0.4021 - accuracy20: 0.4176 - accuracy30: 0.4229 - accuracy50: 0.4137 - val_loss: 13.7883 - val_accuracy10: 0.4528 - val_accuracy20: 0.3757 - val_accuracy30: 0.3408 - val_accuracy50: 0.3406 - 13s/epoch - 47ms/step
Epoch 4/50
273/273 - 13s - loss: 12.7235 - accuracy10: 0.4210 - accuracy20: 0.4370 - accuracy30: 0.4391 - accuracy50: 0.4250 - val_loss: 13.3859 - val_accuracy10: 0.4298 - val_accuracy20: 0.3912 - val_accuracy30: 0.3722 - val_accuracy50: 0.3670 - 13s/epoch - 47ms/step
Epoch 5/50
273/273 - 13s - loss: 12.6350 - accuracy10: 0.4322 - accuracy20: 0.4478 - accuracy30: 0.4492 - accuracy50: 0.4299 - val_loss: 13.3044 - val_accuracy10: 0.4190 - val_accuracy20: 0.3946 - val_accuracy30: 0.3806 - val_accuracy50: 0.3828 - 13s/epoch - 47ms/step
Epoch 6/50
273/273 - 13s - loss: 12.5616 - accuracy10: 0.4397 - accuracy20: 0.4557 - accuracy30: 0.4567 - accuracy50: 0.4351 - val_loss: 13.2460 - val_accuracy10: 0.4149 - val_accuracy20: 0.4083 - val_accuracy30: 0.3976 - val_accuracy50: 0.3923 - 13s/epoch - 47ms/step
Epoch 7/50
273/273 - 13s - loss: 12.4788 - accuracy10: 0.4490 - accuracy20: 0.4634 - accuracy30: 0.4630 - accuracy50: 0.4409 - val_loss: 13.2475 - val_accuracy10: 0.4148 - val_accuracy20: 0.4066 - val_accuracy30: 0.3967 - val_accuracy50: 0.3873 - 13s/epoch - 47ms/step
Epoch 8/50
273/273 - 13s - loss: 12.4125 - accuracy10: 0.4567 - accuracy20: 0.4693 - accuracy30: 0.4672 - accuracy50: 0.4456 - val_loss: 13.1798 - val_accuracy10: 0.4064 - val_accuracy20: 0.4079 - val_accuracy30: 0.4009 - val_accuracy50: 0.3925 - 13s/epoch - 47ms/step
Epoch 9/50
273/273 - 13s - loss: 12.3673 - accuracy10: 0.4603 - accuracy20: 0.4715 - accuracy30: 0.4698 - accuracy50: 0.4484 - val_loss: 13.2101 - val_accuracy10: 0.4126 - val_accuracy20: 0.4154 - val_accuracy30: 0.4065 - val_accuracy50: 0.3956 - 13s/epoch - 47ms/step
Epoch 10/50
273/273 - 13s - loss: 12.3167 - accuracy10: 0.4659 - accuracy20: 0.4780 - accuracy30: 0.4753 - accuracy50: 0.4519 - val_loss: 13.1662 - val_accuracy10: 0.4093 - val_accuracy20: 0.4166 - val_accuracy30: 0.4095 - val_accuracy50: 0.3966 - 13s/epoch - 47ms/step
Epoch 11/50
273/273 - 13s - loss: 12.2522 - accuracy10: 0.4719 - accuracy20: 0.4818 - accuracy30: 0.4779 - accuracy50: 0.4556 - val_loss: 13.2367 - val_accuracy10: 0.4011 - val_accuracy20: 0.4135 - val_accuracy30: 0.4117 - val_accuracy50: 0.3997 - 13s/epoch - 47ms/step
Epoch 12/50
273/273 - 13s - loss: 12.1903 - accuracy10: 0.4740 - accuracy20: 0.4860 - accuracy30: 0.4833 - accuracy50: 0.4586 - val_loss: 13.2978 - val_accuracy10: 0.3892 - val_accuracy20: 0.4081 - val_accuracy30: 0.4081 - val_accuracy50: 0.3948 - 13s/epoch - 48ms/step
Epoch 13/50
273/273 - 13s - loss: 12.1541 - accuracy10: 0.4778 - accuracy20: 0.4879 - accuracy30: 0.4858 - accuracy50: 0.4624 - val_loss: 13.2352 - val_accuracy10: 0.3921 - val_accuracy20: 0.4148 - val_accuracy30: 0.4159 - val_accuracy50: 0.4052 - 13s/epoch - 48ms/step
Epoch 14/50
273/273 - 13s - loss: 12.0872 - accuracy10: 0.4817 - accuracy20: 0.4942 - accuracy30: 0.4908 - accuracy50: 0.4675 - val_loss: 13.3796 - val_accuracy10: 0.3819 - val_accuracy20: 0.4050 - val_accuracy30: 0.4088 - val_accuracy50: 0.3973 - 13s/epoch - 47ms/step
Epoch 15/50
273/273 - 13s - loss: 12.0535 - accuracy10: 0.4835 - accuracy20: 0.4960 - accuracy30: 0.4944 - accuracy50: 0.4685 - val_loss: 13.3516 - val_accuracy10: 0.3997 - val_accuracy20: 0.4157 - val_accuracy30: 0.4151 - val_accuracy50: 0.4021 - 13s/epoch - 47ms/step
Epoch 16/50
273/273 - 13s - loss: 12.0224 - accuracy10: 0.4840 - accuracy20: 0.4982 - accuracy30: 0.4960 - accuracy50: 0.4712 - val_loss: 13.3681 - val_accuracy10: 0.4178 - val_accuracy20: 0.4257 - val_accuracy30: 0.4206 - val_accuracy50: 0.4057 - 13s/epoch - 46ms/step
Epoch 17/50
273/273 - 13s - loss: 11.9771 - accuracy10: 0.4889 - accuracy20: 0.5032 - accuracy30: 0.5008 - accuracy50: 0.4745 - val_loss: 13.2138 - val_accuracy10: 0.4003 - val_accuracy20: 0.4239 - val_accuracy30: 0.4219 - val_accuracy50: 0.4066 - 13s/epoch - 47ms/step
Epoch 18/50
273/273 - 13s - loss: 11.9383 - accuracy10: 0.4915 - accuracy20: 0.5054 - accuracy30: 0.5032 - accuracy50: 0.4783 - val_loss: 13.3621 - val_accuracy10: 0.4113 - val_accuracy20: 0.4234 - val_accuracy30: 0.4183 - val_accuracy50: 0.4054 - 13s/epoch - 46ms/step
Epoch 19/50
273/273 - 13s - loss: 11.9184 - accuracy10: 0.4904 - accuracy20: 0.5077 - accuracy30: 0.5067 - accuracy50: 0.4818 - val_loss: 13.3421 - val_accuracy10: 0.4197 - val_accuracy20: 0.4290 - val_accuracy30: 0.4190 - val_accuracy50: 0.4062 - 13s/epoch - 47ms/step
Epoch 20/50
273/273 - 13s - loss: 11.8685 - accuracy10: 0.4981 - accuracy20: 0.5128 - accuracy30: 0.5129 - accuracy50: 0.4859 - val_loss: 13.7850 - val_accuracy10: 0.4188 - val_accuracy20: 0.4192 - val_accuracy30: 0.4106 - val_accuracy50: 0.3966 - 13s/epoch - 47ms/step
testing model: results/LILAK/W5/deepLOB_L2/seq2seq
Evaluating performance on  test set...
1060/1060 - 18s - 18s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1245103
{'0': {'precision': 0.36628134846101773, 'recall': 0.8071064851163103, 'f1-score': 0.5038880466635624, 'support': 89158}, '1': {'precision': 0.4998601985181043, 'recall': 0.14728690153754262, 'f1-score': 0.22753052539474208, 'support': 97103}, '2': {'precision': 0.4321793846087314, 'recall': 0.23497807404272328, 'f1-score': 0.3044339177189161, 'support': 85059}, 'accuracy': 0.39160032434026243, 'macro avg': {'precision': 0.4327736438626178, 'recall': 0.3964571535655254, 'f1-score': 0.3452841632590735, 'support': 271320}, 'weighted avg': {'precision': 0.43474710157093094, 'recall': 0.39160032434026243, 'f1-score': 0.34245316113478114, 'support': 271320}}
[[71960  6523 10675]
 [67216 14302 15585]
 [57285  7787 19987]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1040597
{'0': {'precision': 0.4137352584926793, 'recall': 0.7942501337743835, 'f1-score': 0.5440616856935309, 'support': 102785}, '1': {'precision': 0.3770580115147638, 'recall': 0.15609015011080601, 'f1-score': 0.2207830612727703, 'support': 71747}, '2': {'precision': 0.47142341203557403, 'recall': 0.2157808819275117, 'f1-score': 0.2960521652845702, 'support': 96788}, 'accuracy': 0.41913976116762497, 'macro avg': {'precision': 0.42073889401433906, 'recall': 0.38870705527090044, 'f1-score': 0.3536323040836238, 'support': 271320}, 'weighted avg': {'precision': 0.4246155421657782, 'recall': 0.41913976116762497, 'f1-score': 0.37010246069110275, 'support': 271320}}
[[81637  8818 12330]
 [49461 11199 11087]
 [66219  9684 20885]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.103285
{'0': {'precision': 0.42174084723797184, 'recall': 0.7852080152312013, 'f1-score': 0.5487461878445761, 'support': 106098}, '1': {'precision': 0.32206932030094526, 'recall': 0.1546119651787368, 'f1-score': 0.20892689540098028, 'support': 64788}, '2': {'precision': 0.47108851506489857, 'recall': 0.20020112710834975, 'f1-score': 0.28098884820704884, 'support': 100434}, 'accuracy': 0.418078283945157, 'macro avg': {'precision': 0.40496622753460515, 'recall': 0.38000703583942924, 'f1-score': 0.34622064381753503, 'support': 271320}, 'weighted avg': {'precision': 0.4162073988498452, 'recall': 0.418078283945157, 'f1-score': 0.3684861518428397, 'support': 271320}}
[[83309 10113 12676]
 [44872 10017  9899]
 [69355 10972 20107]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1184392
{'0': {'precision': 0.39799300592975523, 'recall': 0.7716829464829701, 'f1-score': 0.5251444468221699, 'support': 101762}, '1': {'precision': 0.2952929639617553, 'recall': 0.13707360095593046, 'f1-score': 0.18723404255319148, 'support': 70298}, '2': {'precision': 0.44204649813910774, 'recall': 0.18427362482369536, 'f1-score': 0.26011462051508133, 'support': 99260}, 'accuracy': 0.39235957540911104, 'macro avg': {'precision': 0.3784441560102061, 'recall': 0.36434339075419864, 'f1-score': 0.32416436996348086, 'support': 271320}, 'weighted avg': {'precision': 0.3875003849892933, 'recall': 0.39235957540911104, 'f1-score': 0.34063432534737165, 'support': 271320}}
[[78528 10942 12292]
 [49867  9636 10795]
 [68915 12054 18291]]
Evaluating performance on  train set...
273/273 - 5s - 5s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0485578
{'0': {'precision': 0.3448671151467616, 'recall': 0.625314517011268, 'f1-score': 0.4445567848184947, 'support': 18282}, '1': {'precision': 0.6004889524424558, 'recall': 0.3960450258594463, 'f1-score': 0.47729564244990746, 'support': 32870}, '2': {'precision': 0.4042180446061586, 'recall': 0.3239725657503915, 'f1-score': 0.3596738413573955, 'support': 18517}, 'accuracy': 0.4370523475290301, 'macro avg': {'precision': 0.4498580373984587, 'recall': 0.44844403620703527, 'f1-score': 0.42717542287526583, 'support': 69669}, 'weighted avg': {'precision': 0.48124471426127624, 'recall': 0.4370523475290301, 'f1-score': 0.43744241237559134, 'support': 69669}}
[[11432  3997  2853]
 [13863 13018  5989]
 [ 7854  4664  5999]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0567297
{'0': {'precision': 0.4001266318931468, 'recall': 0.6054012134482916, 'f1-score': 0.48181092070868425, 'support': 21921}, '1': {'precision': 0.4934116170670491, 'recall': 0.43076260906992214, 'f1-score': 0.4599636507969667, 'support': 25557}, '2': {'precision': 0.4656095842142354, 'recall': 0.29773331530800773, 'f1-score': 0.3632115664770072, 'support': 22191}, 'accuracy': 0.44333921830369316, 'macro avg': {'precision': 0.45304927772481046, 'recall': 0.44463237927540716, 'f1-score': 0.4349953793275527, 'support': 69669}, 'weighted avg': {'precision': 0.4552044507372051, 'recall': 0.44333921830369316, 'f1-score': 0.43602026852638065, 'support': 69669}}
[[13271  5307  3343]
 [10308 11009  4240]
 [ 9588  5996  6607]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0642871
{'0': {'precision': 0.41878533208379937, 'recall': 0.5920591503547312, 'f1-score': 0.4905713830408839, 'support': 23398}, '1': {'precision': 0.43887758195124066, 'recall': 0.445083659040007, 'f1-score': 0.44195883481597775, 'support': 22771}, '2': {'precision': 0.48344076461435875, 'recall': 0.2776595744680851, 'f1-score': 0.35273130253804363, 'support': 23500}, 'accuracy': 0.4379709770486156, 'macro avg': {'precision': 0.4470345595497996, 'recall': 0.4382674612876077, 'f1-score': 0.42842050679830174, 'support': 69669}, 'weighted avg': {'precision': 0.44716127096909486, 'recall': 0.4379709770486156, 'f1-score': 0.42818785195179, 'support': 69669}}
[[13853  6134  3411]
 [ 9075 10135  3561]
 [10151  6824  6525]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0771965
{'0': {'precision': 0.4069919440644475, 'recall': 0.5717946527718459, 'f1-score': 0.4755190111705056, 'support': 23414}, '1': {'precision': 0.4184696349511319, 'recall': 0.43617762298650414, 'f1-score': 0.4271401773533424, 'support': 22970}, '2': {'precision': 0.4686720698254364, 'recall': 0.2582778612840885, 'f1-score': 0.33302876761635797, 'support': 23285}, 'accuracy': 0.4222968608706885, 'macro avg': {'precision': 0.43137788294700524, 'recall': 0.4220833790141462, 'f1-score': 0.4118959853800686, 'support': 69669}, 'weighted avg': {'precision': 0.4313910927247091, 'recall': 0.4222968608706885, 'f1-score': 0.4119448657982659, 'support': 69669}}
[[13388  6698  3328]
 [ 9461 10019  3490]
 [10046  7225  6014]]
Evaluating performance on  val set...
96/96 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0846761
{'0': {'precision': 0.35272373540856033, 'recall': 0.5348082595870206, 'f1-score': 0.4250879249706917, 'support': 6780}, '1': {'precision': 0.5389928057553957, 'recall': 0.3323573773400763, 'f1-score': 0.41117392020196475, 'support': 11271}, '2': {'precision': 0.36391142896437906, 'recall': 0.4102325581395349, 'f1-score': 0.3856861744770789, 'support': 6450}, 'accuracy': 0.4088812701522387, 'macro avg': {'precision': 0.418542656709445, 'recall': 0.4257993983555439, 'f1-score': 0.4073160065499118, 'support': 24501}, 'weighted avg': {'precision': 0.4413568244789742, 'recall': 0.4088812701522387, 'f1-score': 0.408314485583233, 'support': 24501}}
[[3626 1621 1533]
 [4433 3746 3092]
 [2221 1583 2646]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0896251
{'0': {'precision': 0.40313831848120885, 'recall': 0.5207056174152384, 'f1-score': 0.4544412294589726, 'support': 7993}, '1': {'precision': 0.43321751216122306, 'recall': 0.35196476964769646, 'f1-score': 0.38838701638527195, 'support': 8856}, '2': {'precision': 0.4220853623603552, 'recall': 0.38512807109252484, 'f1-score': 0.40276069427360944, 'support': 7652}, 'accuracy': 0.41737071956246685, 'macro avg': {'precision': 0.41948039766759565, 'recall': 0.4192661527184866, 'f1-score': 0.415196313372618, 'support': 24501}, 'weighted avg': {'precision': 0.4199280053916792, 'recall': 0.41737071956246685, 'f1-score': 0.4144250845579852, 'support': 24501}}
[[4162 2059 1772]
 [3476 3117 2263]
 [2686 2019 2947]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0960408
{'0': {'precision': 0.412340178225494, 'recall': 0.5061831153388823, 'f1-score': 0.4544678125333618, 'support': 8410}, '1': {'precision': 0.3863696632193052, 'recall': 0.365529352734571, 'f1-score': 0.3756606935671007, 'support': 7972}, '2': {'precision': 0.44024114544084403, 'recall': 0.3597733711048159, 'f1-score': 0.3959604175138946, 'support': 8119}, 'accuracy': 0.41190155503856984, 'macro avg': {'precision': 0.4129836622952145, 'recall': 0.41049527972608973, 'f1-score': 0.40869630787145234, 'support': 24501}, 'weighted avg': {'precision': 0.41313569706930003, 'recall': 0.41190155503856984, 'f1-score': 0.40943814466012857, 'support': 24501}}
[[4257 2319 1834]
 [3178 2914 1880]
 [2889 2309 2921]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1023574
{'0': {'precision': 0.3955477787498785, 'recall': 0.48882748678519944, 'f1-score': 0.43726828219869973, 'support': 8324}, '1': {'precision': 0.3732997481108312, 'recall': 0.37105658487731596, 'f1-score': 0.3721747865394274, 'support': 7988}, '2': {'precision': 0.43018807778131973, 'recall': 0.3295884723409452, 'f1-score': 0.37322823757173484, 'support': 8189}, 'accuracy': 0.397208277213175, 'macro avg': {'precision': 0.39967853488067656, 'recall': 0.39649084800115353, 'f1-score': 0.39422376876995396, 'support': 24501}, 'weighted avg': {'precision': 0.39987217938755704, 'recall': 0.397208277213175, 'f1-score': 0.39464182741005915, 'support': 24501}}
[[4069 2500 1755]
 [3204 2964 1820]
 [3014 2476 2699]]
training model: results/LILAK/W5/deepOF_L2/seq2seq
Epoch 1/50
273/273 - 13s - loss: 13.1144 - accuracy10: 0.3918 - accuracy20: 0.3893 - accuracy30: 0.3827 - accuracy50: 0.3677 - val_loss: 13.6424 - val_accuracy10: 0.4647 - val_accuracy20: 0.3926 - val_accuracy30: 0.3594 - val_accuracy50: 0.3458 - 13s/epoch - 46ms/step
Epoch 2/50
273/273 - 8s - loss: 12.9350 - accuracy10: 0.4201 - accuracy20: 0.4144 - accuracy30: 0.4055 - accuracy50: 0.3867 - val_loss: 13.4298 - val_accuracy10: 0.4804 - val_accuracy20: 0.4161 - val_accuracy30: 0.3815 - val_accuracy50: 0.3595 - 8s/epoch - 29ms/step
Epoch 3/50
273/273 - 8s - loss: 12.8034 - accuracy10: 0.4381 - accuracy20: 0.4298 - accuracy30: 0.4206 - accuracy50: 0.4023 - val_loss: 13.2258 - val_accuracy10: 0.4929 - val_accuracy20: 0.4347 - val_accuracy30: 0.4017 - val_accuracy50: 0.3719 - 8s/epoch - 29ms/step
Epoch 4/50
273/273 - 8s - loss: 12.7015 - accuracy10: 0.4483 - accuracy20: 0.4412 - accuracy30: 0.4313 - accuracy50: 0.4106 - val_loss: 13.1131 - val_accuracy10: 0.5030 - val_accuracy20: 0.4444 - val_accuracy30: 0.4108 - val_accuracy50: 0.3803 - 8s/epoch - 28ms/step
Epoch 5/50
273/273 - 8s - loss: 12.5918 - accuracy10: 0.4646 - accuracy20: 0.4545 - accuracy30: 0.4438 - accuracy50: 0.4194 - val_loss: 13.0695 - val_accuracy10: 0.5101 - val_accuracy20: 0.4513 - val_accuracy30: 0.4171 - val_accuracy50: 0.3849 - 8s/epoch - 29ms/step
Epoch 6/50
273/273 - 8s - loss: 12.4894 - accuracy10: 0.4767 - accuracy20: 0.4661 - accuracy30: 0.4541 - accuracy50: 0.4273 - val_loss: 13.0266 - val_accuracy10: 0.5151 - val_accuracy20: 0.4583 - val_accuracy30: 0.4233 - val_accuracy50: 0.3904 - 8s/epoch - 29ms/step
Epoch 7/50
273/273 - 8s - loss: 12.4022 - accuracy10: 0.4854 - accuracy20: 0.4747 - accuracy30: 0.4631 - accuracy50: 0.4348 - val_loss: 12.9443 - val_accuracy10: 0.5119 - val_accuracy20: 0.4636 - val_accuracy30: 0.4316 - val_accuracy50: 0.3971 - 8s/epoch - 29ms/step
Epoch 8/50
273/273 - 8s - loss: 12.3257 - accuracy10: 0.4919 - accuracy20: 0.4815 - accuracy30: 0.4700 - accuracy50: 0.4405 - val_loss: 12.8724 - val_accuracy10: 0.5081 - val_accuracy20: 0.4668 - val_accuracy30: 0.4361 - val_accuracy50: 0.4005 - 8s/epoch - 29ms/step
Epoch 9/50
273/273 - 8s - loss: 12.2422 - accuracy10: 0.4993 - accuracy20: 0.4914 - accuracy30: 0.4811 - accuracy50: 0.4502 - val_loss: 12.8927 - val_accuracy10: 0.5131 - val_accuracy20: 0.4734 - val_accuracy30: 0.4415 - val_accuracy50: 0.4063 - 8s/epoch - 28ms/step
Epoch 10/50
273/273 - 8s - loss: 12.1712 - accuracy10: 0.5027 - accuracy20: 0.4973 - accuracy30: 0.4858 - accuracy50: 0.4566 - val_loss: 12.8958 - val_accuracy10: 0.5081 - val_accuracy20: 0.4721 - val_accuracy30: 0.4434 - val_accuracy50: 0.4072 - 8s/epoch - 28ms/step
Epoch 11/50
273/273 - 8s - loss: 12.0966 - accuracy10: 0.5076 - accuracy20: 0.5037 - accuracy30: 0.4949 - accuracy50: 0.4639 - val_loss: 12.8845 - val_accuracy10: 0.5069 - val_accuracy20: 0.4760 - val_accuracy30: 0.4487 - val_accuracy50: 0.4104 - 8s/epoch - 28ms/step
Epoch 12/50
273/273 - 8s - loss: 12.0165 - accuracy10: 0.5110 - accuracy20: 0.5099 - accuracy30: 0.5000 - accuracy50: 0.4695 - val_loss: 12.9511 - val_accuracy10: 0.5097 - val_accuracy20: 0.4787 - val_accuracy30: 0.4530 - val_accuracy50: 0.4115 - 8s/epoch - 28ms/step
Epoch 13/50
273/273 - 8s - loss: 11.9437 - accuracy10: 0.5140 - accuracy20: 0.5156 - accuracy30: 0.5071 - accuracy50: 0.4773 - val_loss: 12.8414 - val_accuracy10: 0.4963 - val_accuracy20: 0.4761 - val_accuracy30: 0.4555 - val_accuracy50: 0.4161 - 8s/epoch - 29ms/step
Epoch 14/50
273/273 - 8s - loss: 11.8779 - accuracy10: 0.5187 - accuracy20: 0.5212 - accuracy30: 0.5128 - accuracy50: 0.4823 - val_loss: 12.9567 - val_accuracy10: 0.4990 - val_accuracy20: 0.4776 - val_accuracy30: 0.4521 - val_accuracy50: 0.4154 - 8s/epoch - 28ms/step
Epoch 15/50
273/273 - 8s - loss: 11.8110 - accuracy10: 0.5185 - accuracy20: 0.5230 - accuracy30: 0.5192 - accuracy50: 0.4876 - val_loss: 13.0405 - val_accuracy10: 0.5048 - val_accuracy20: 0.4772 - val_accuracy30: 0.4541 - val_accuracy50: 0.4180 - 8s/epoch - 28ms/step
Epoch 16/50
273/273 - 8s - loss: 11.7509 - accuracy10: 0.5223 - accuracy20: 0.5291 - accuracy30: 0.5235 - accuracy50: 0.4935 - val_loss: 13.2302 - val_accuracy10: 0.4959 - val_accuracy20: 0.4671 - val_accuracy30: 0.4451 - val_accuracy50: 0.4088 - 8s/epoch - 28ms/step
Epoch 17/50
273/273 - 8s - loss: 11.6903 - accuracy10: 0.5236 - accuracy20: 0.5333 - accuracy30: 0.5285 - accuracy50: 0.4982 - val_loss: 13.1899 - val_accuracy10: 0.5015 - val_accuracy20: 0.4745 - val_accuracy30: 0.4500 - val_accuracy50: 0.4118 - 8s/epoch - 28ms/step
Epoch 18/50
273/273 - 8s - loss: 11.6347 - accuracy10: 0.5272 - accuracy20: 0.5382 - accuracy30: 0.5340 - accuracy50: 0.5018 - val_loss: 13.0767 - val_accuracy10: 0.5003 - val_accuracy20: 0.4748 - val_accuracy30: 0.4486 - val_accuracy50: 0.4128 - 8s/epoch - 28ms/step
Epoch 19/50
273/273 - 8s - loss: 11.5597 - accuracy10: 0.5280 - accuracy20: 0.5417 - accuracy30: 0.5397 - accuracy50: 0.5102 - val_loss: 13.2333 - val_accuracy10: 0.5004 - val_accuracy20: 0.4732 - val_accuracy30: 0.4486 - val_accuracy50: 0.4120 - 8s/epoch - 29ms/step
Epoch 20/50
273/273 - 8s - loss: 11.5082 - accuracy10: 0.5300 - accuracy20: 0.5459 - accuracy30: 0.5438 - accuracy50: 0.5150 - val_loss: 13.2508 - val_accuracy10: 0.4911 - val_accuracy20: 0.4667 - val_accuracy30: 0.4424 - val_accuracy50: 0.4054 - 8s/epoch - 29ms/step
Epoch 21/50
273/273 - 8s - loss: 11.4369 - accuracy10: 0.5331 - accuracy20: 0.5481 - accuracy30: 0.5461 - accuracy50: 0.5182 - val_loss: 13.4012 - val_accuracy10: 0.4949 - val_accuracy20: 0.4660 - val_accuracy30: 0.4449 - val_accuracy50: 0.4076 - 8s/epoch - 29ms/step
Epoch 22/50
273/273 - 8s - loss: 11.3821 - accuracy10: 0.5343 - accuracy20: 0.5511 - accuracy30: 0.5502 - accuracy50: 0.5230 - val_loss: 13.3935 - val_accuracy10: 0.5021 - val_accuracy20: 0.4697 - val_accuracy30: 0.4445 - val_accuracy50: 0.4104 - 8s/epoch - 29ms/step
Epoch 23/50
273/273 - 8s - loss: 11.2927 - accuracy10: 0.5398 - accuracy20: 0.5575 - accuracy30: 0.5585 - accuracy50: 0.5299 - val_loss: 13.4574 - val_accuracy10: 0.4908 - val_accuracy20: 0.4679 - val_accuracy30: 0.4463 - val_accuracy50: 0.4121 - 8s/epoch - 29ms/step
testing model: results/LILAK/W5/deepOF_L2/seq2seq
Evaluating performance on  test set...
1060/1060 - 11s - 11s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.064599
{'0': {'precision': 0.4341654254078208, 'recall': 0.5427116514872807, 'f1-score': 0.4824079520642865, 'support': 89156}, '1': {'precision': 0.5490644490644491, 'recall': 0.4079772607903111, 'f1-score': 0.4681213109523725, 'support': 97101}, '2': {'precision': 0.45021033071512445, 'recall': 0.4642949516800301, 'f1-score': 0.45714418007026403, 'support': 85058}, 'accuracy': 0.4699076718942926, 'macro avg': {'precision': 0.4778134017291314, 'recall': 0.471661287985874, 'f1-score': 0.46922448102897435, 'support': 271315}, 'weighted avg': {'precision': 0.4803167906169352, 'recall': 0.4699076718942926, 'f1-score': 0.46937464002154833, 'support': 271315}}
[[48386 16409 24361]
 [33620 39615 23866]
 [29440 16126 39492]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0813655
{'0': {'precision': 0.4754507824152935, 'recall': 0.5241190091650288, 'f1-score': 0.49860008792836147, 'support': 102782}, '1': {'precision': 0.4179268513237156, 'recall': 0.41871907449996515, 'f1-score': 0.41832258783228665, 'support': 71745}, '2': {'precision': 0.481266907385262, 'recall': 0.42827623259081704, 'f1-score': 0.45322793148880103, 'support': 96788}, 'accuracy': 0.4620570185946225, 'macro avg': {'precision': 0.45821484704142373, 'recall': 0.4570381054186037, 'f1-score': 0.45671686908314973, 'support': 271315}, 'weighted avg': {'precision': 0.4623143051376939, 'recall': 0.4620570185946225, 'f1-score': 0.46118605065852725, 'support': 271315}}
[[53870 21065 27847]
 [24872 30041 16832]
 [34561 20775 41452]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1024094
{'0': {'precision': 0.4714046443463545, 'recall': 0.5093453979923653, 'f1-score': 0.48964114366485595, 'support': 106095}, '1': {'precision': 0.3584064728469556, 'recall': 0.4034050566480412, 'f1-score': 0.37957677951578006, 'support': 64786}, '2': {'precision': 0.4759494275378756, 'recall': 0.3969372921520601, 'f1-score': 0.43286734167594126, 'support': 100434}, 'accuracy': 0.44243775685089287, 'macro avg': {'precision': 0.43525351491039527, 'recall': 0.4365625822641556, 'f1-score': 0.4340284216188591, 'support': 271315}, 'weighted avg': {'precision': 0.4461047207015032, 'recall': 0.44243775685089287, 'f1-score': 0.4423431692634528, 'support': 271315}}
[[54039 23290 28766]
 [23522 26135 15129]
 [37073 23495 39866]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1366217
{'0': {'precision': 0.4272106835232009, 'recall': 0.4835051445081025, 'f1-score': 0.4536180374042881, 'support': 101759}, '1': {'precision': 0.3221704728889359, 'recall': 0.3463683177330792, 'f1-score': 0.3338314733060956, 'support': 70298}, '2': {'precision': 0.43185344239099405, 'recall': 0.35054101432630114, 'f1-score': 0.38697192301489763, 'support': 99258}, 'accuracy': 0.3993291930044413, 'macro avg': {'precision': 0.3937448662677103, 'recall': 0.3934714921891609, 'f1-score': 0.3914738112417604, 'support': 271315}, 'weighted avg': {'precision': 0.40169316415468775, 'recall': 0.3993291930044413, 'f1-score': 0.39819936941675754, 'support': 271315}}
[[49201 24717 27841]
 [28015 24349 17934]
 [37952 26512 34794]]
Evaluating performance on  train set...
273/273 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9814002
{'0': {'precision': 0.4227306337262407, 'recall': 0.530918824429149, 'f1-score': 0.47068794343414777, 'support': 18306}, '1': {'precision': 0.6492496238946172, 'recall': 0.5380405035577449, 'f1-score': 0.5884367881075508, 'support': 32886}, '2': {'precision': 0.43966227347611203, 'recall': 0.4622212600129898, 'f1-score': 0.45065963060686015, 'support': 18476}, 'accuracy': 0.5160618935522765, 'macro avg': {'precision': 0.50388084369899, 'recall': 0.5103935293332945, 'f1-score': 0.5032614540495196, 'support': 69668}, 'weighted avg': {'precision': 0.5341466710273811, 'recall': 0.5160618935522765, 'f1-score': 0.5209584463642243, 'support': 69668}}
[[ 9719  4464  4123]
 [ 8431 17694  6761]
 [ 4841  5095  8540]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0075942
{'0': {'precision': 0.47448152257403775, 'recall': 0.5064680696000728, 'f1-score': 0.48995329161893014, 'support': 21954}, '1': {'precision': 0.5309078845515869, 'recall': 0.5629470392808286, 'f1-score': 0.5464582463861594, 'support': 25585}, '2': {'precision': 0.49049986914420307, 'recall': 0.4234714627863889, 'f1-score': 0.4545278168501722, 'support': 22129}, 'accuracy': 0.5008468737440431, 'macro avg': {'precision': 0.49862975875660925, 'recall': 0.4976288572224301, 'f1-score': 0.4969797849517539, 'support': 69668}, 'weighted avg': {'precision': 0.5002916285401453, 'recall': 0.5008468737440431, 'f1-score': 0.49945189839049986, 'support': 69668}}
[[11119  5986  4849]
 [ 6297 14403  4885]
 [ 6018  6740  9371]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0332702
{'0': {'precision': 0.4820653319283456, 'recall': 0.49022717531075866, 'f1-score': 0.48611199659972376, 'support': 23330}, '1': {'precision': 0.4701391679146729, 'recall': 0.5629866153442393, 'f1-score': 0.5123907721093175, 'support': 22862}, '2': {'precision': 0.49935365722288055, 'recall': 0.39491395467711704, 'f1-score': 0.44103515532086957, 'support': 23476}, 'accuracy': 0.4819859906987426, 'macro avg': {'precision': 0.48385271902196636, 'recall': 0.4827092484440383, 'f1-score': 0.479845974676637, 'support': 69668}, 'weighted avg': {'precision': 0.4839773254251291, 'recall': 0.4819859906987426, 'f1-score': 0.47954601852999235, 'support': 69668}}
[[11437  6832  5061]
 [ 5757 12871  4234]
 [ 6531  7674  9271]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0699766
{'0': {'precision': 0.4521403714728942, 'recall': 0.46124893071000855, 'f1-score': 0.4566492346128602, 'support': 23380}, '1': {'precision': 0.42690037560364874, 'recall': 0.5190726806141533, 'f1-score': 0.46849605464609584, 'support': 22991}, '2': {'precision': 0.4600828574627701, 'recall': 0.3527492810233077, 'f1-score': 0.39932942977234626, 'support': 23297}, 'accuracy': 0.4440489177240627, 'macro avg': {'precision': 0.4463745348464377, 'recall': 0.4443569641158232, 'f1-score': 0.44149157301043407, 'support': 69668}, 'weighted avg': {'precision': 0.4464669396401491, 'recall': 0.4440489177240627, 'f1-score': 0.441391020598028, 'support': 69668}}
[[10784  7598  4998]
 [ 6411 11934  4646]
 [ 6656  8423  8218]]
Evaluating performance on  val set...
96/96 - 1s - 1s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0102357
{'0': {'precision': 0.41689667586703466, 'recall': 0.5131462333825701, 'f1-score': 0.46004105144673246, 'support': 6770}, '1': {'precision': 0.6269694664783223, 'recall': 0.5134822461511079, 'f1-score': 0.5645792563600782, 'support': 11237}, '2': {'precision': 0.42282842785355346, 'recall': 0.4534955343393902, 'f1-score': 0.4376253807860911, 'support': 6494}, 'accuracy': 0.49748989837149504, 'macro avg': {'precision': 0.4888981900663035, 'recall': 0.4933746712910228, 'f1-score': 0.4874152295309673, 'support': 24501}, 'weighted avg': {'precision': 0.5148154851196975, 'recall': 0.49748989837149504, 'f1-score': 0.5020445796023613, 'support': 24501}}
[[3474 1686 1610]
 [3057 5770 2410]
 [1802 1747 2945]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0483191
{'0': {'precision': 0.46145685997171143, 'recall': 0.4887640449438202, 'f1-score': 0.4747180793015642, 'support': 8010}, '1': {'precision': 0.5087013269523603, 'recall': 0.5293119058397465, 'f1-score': 0.5188019966722129, 'support': 8836}, '2': {'precision': 0.4575699838780595, 'recall': 0.407838014369693, 'f1-score': 0.4312750379886725, 'support': 7655}, 'accuracy': 0.478102934574099, 'macro avg': {'precision': 0.47590939026737705, 'recall': 0.4753046550510865, 'f1-score': 0.4749317046541499, 'support': 24501}, 'weighted avg': {'precision': 0.4772806252769687, 'recall': 0.478102934574099, 'f1-score': 0.4770432502185417, 'support': 24501}}
[[3915 2194 1901]
 [2359 4677 1800]
 [2210 2323 3122]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0768633
{'0': {'precision': 0.4540603248259861, 'recall': 0.466618979494516, 'f1-score': 0.46025399811853246, 'support': 8388}, '1': {'precision': 0.4476211026000647, 'recall': 0.5181715998501312, 'f1-score': 0.4803195184070387, 'support': 8007}, '2': {'precision': 0.45825771324863884, 'recall': 0.3737971872686899, 'f1-score': 0.4117407256420709, 'support': 8106}, 'accuracy': 0.45275703032529285, 'macro avg': {'precision': 0.45331304689156315, 'recall': 0.45286258887111236, 'f1-score': 0.45077141405588067, 'support': 24501}, 'weighted avg': {'precision': 0.45334464702471555, 'recall': 0.45275703032529285, 'f1-score': 0.4507611624896141, 'support': 24501}}
[[3914 2489 1985]
 [2261 4149 1597]
 [2445 2631 3030]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1098493
{'0': {'precision': 0.42115561694290976, 'recall': 0.4408433734939759, 'f1-score': 0.43077466446903695, 'support': 8300}, '1': {'precision': 0.4074973600844773, 'recall': 0.48033358227532985, 'f1-score': 0.4409277879341864, 'support': 8034}, '2': {'precision': 0.41872930789847074, 'recall': 0.3252112158687401, 'f1-score': 0.36609235010337704, 'support': 8167}, 'accuracy': 0.4152483572099098, 'macro avg': {'precision': 0.4157940949752859, 'recall': 0.4154627238793486, 'f1-score': 0.41259826750220013, 'support': 24501}, 'weighted avg': {'precision': 0.4158682367720359, 'recall': 0.4152483572099098, 'f1-score': 0.4125431527958263, 'support': 24501}}
[[3659 2695 1946]
 [2434 3859 1741]
 [2595 2916 2656]]
training model: results/LILAK/W5/deepVOL_L2/seq2seq
Epoch 1/50
273/273 - 13s - loss: 13.0857 - accuracy10: 0.3754 - accuracy20: 0.3876 - accuracy30: 0.3898 - accuracy50: 0.3847 - val_loss: 12.9033 - val_accuracy10: 0.4494 - val_accuracy20: 0.4377 - val_accuracy30: 0.4226 - val_accuracy50: 0.4034 - 13s/epoch - 49ms/step
Epoch 2/50
273/273 - 8s - loss: 12.7348 - accuracy10: 0.4342 - accuracy20: 0.4337 - accuracy30: 0.4291 - accuracy50: 0.4128 - val_loss: 12.7602 - val_accuracy10: 0.4761 - val_accuracy20: 0.4614 - val_accuracy30: 0.4420 - val_accuracy50: 0.4158 - 8s/epoch - 29ms/step
Epoch 3/50
273/273 - 8s - loss: 12.5716 - accuracy10: 0.4475 - accuracy20: 0.4501 - accuracy30: 0.4450 - accuracy50: 0.4252 - val_loss: 12.8009 - val_accuracy10: 0.4813 - val_accuracy20: 0.4639 - val_accuracy30: 0.4441 - val_accuracy50: 0.4159 - 8s/epoch - 29ms/step
Epoch 4/50
273/273 - 8s - loss: 12.4357 - accuracy10: 0.4582 - accuracy20: 0.4631 - accuracy30: 0.4578 - accuracy50: 0.4355 - val_loss: 12.7179 - val_accuracy10: 0.4890 - val_accuracy20: 0.4678 - val_accuracy30: 0.4489 - val_accuracy50: 0.4211 - 8s/epoch - 30ms/step
Epoch 5/50
273/273 - 8s - loss: 12.3505 - accuracy10: 0.4672 - accuracy20: 0.4715 - accuracy30: 0.4640 - accuracy50: 0.4413 - val_loss: 12.6289 - val_accuracy10: 0.4902 - val_accuracy20: 0.4733 - val_accuracy30: 0.4528 - val_accuracy50: 0.4255 - 8s/epoch - 30ms/step
Epoch 6/50
273/273 - 8s - loss: 12.2733 - accuracy10: 0.4722 - accuracy20: 0.4765 - accuracy30: 0.4715 - accuracy50: 0.4482 - val_loss: 12.6147 - val_accuracy10: 0.4927 - val_accuracy20: 0.4763 - val_accuracy30: 0.4581 - val_accuracy50: 0.4270 - 8s/epoch - 29ms/step
Epoch 7/50
273/273 - 8s - loss: 12.1968 - accuracy10: 0.4797 - accuracy20: 0.4848 - accuracy30: 0.4775 - accuracy50: 0.4528 - val_loss: 12.6585 - val_accuracy10: 0.4964 - val_accuracy20: 0.4783 - val_accuracy30: 0.4579 - val_accuracy50: 0.4306 - 8s/epoch - 29ms/step
Epoch 8/50
273/273 - 8s - loss: 12.1748 - accuracy10: 0.4845 - accuracy20: 0.4867 - accuracy30: 0.4795 - accuracy50: 0.4556 - val_loss: 12.6706 - val_accuracy10: 0.4953 - val_accuracy20: 0.4772 - val_accuracy30: 0.4538 - val_accuracy50: 0.4256 - 8s/epoch - 29ms/step
Epoch 9/50
273/273 - 8s - loss: 12.1328 - accuracy10: 0.4858 - accuracy20: 0.4917 - accuracy30: 0.4852 - accuracy50: 0.4598 - val_loss: 12.5260 - val_accuracy10: 0.4881 - val_accuracy20: 0.4779 - val_accuracy30: 0.4604 - val_accuracy50: 0.4286 - 8s/epoch - 29ms/step
Epoch 10/50
273/273 - 8s - loss: 12.0984 - accuracy10: 0.4894 - accuracy20: 0.4948 - accuracy30: 0.4876 - accuracy50: 0.4628 - val_loss: 12.9105 - val_accuracy10: 0.4945 - val_accuracy20: 0.4697 - val_accuracy30: 0.4466 - val_accuracy50: 0.4160 - 8s/epoch - 29ms/step
Epoch 11/50
273/273 - 8s - loss: 12.0468 - accuracy10: 0.4955 - accuracy20: 0.4994 - accuracy30: 0.4926 - accuracy50: 0.4653 - val_loss: 12.9420 - val_accuracy10: 0.4917 - val_accuracy20: 0.4750 - val_accuracy30: 0.4511 - val_accuracy50: 0.4201 - 8s/epoch - 29ms/step
Epoch 12/50
273/273 - 8s - loss: 12.0039 - accuracy10: 0.4984 - accuracy20: 0.5029 - accuracy30: 0.4947 - accuracy50: 0.4683 - val_loss: 13.0632 - val_accuracy10: 0.4966 - val_accuracy20: 0.4712 - val_accuracy30: 0.4495 - val_accuracy50: 0.4201 - 8s/epoch - 29ms/step
Epoch 13/50
273/273 - 8s - loss: 11.9781 - accuracy10: 0.5006 - accuracy20: 0.5045 - accuracy30: 0.4957 - accuracy50: 0.4696 - val_loss: 13.0034 - val_accuracy10: 0.5031 - val_accuracy20: 0.4730 - val_accuracy30: 0.4484 - val_accuracy50: 0.4179 - 8s/epoch - 29ms/step
Epoch 14/50
273/273 - 8s - loss: 11.9389 - accuracy10: 0.5032 - accuracy20: 0.5081 - accuracy30: 0.5002 - accuracy50: 0.4734 - val_loss: 12.8412 - val_accuracy10: 0.5001 - val_accuracy20: 0.4769 - val_accuracy30: 0.4534 - val_accuracy50: 0.4220 - 8s/epoch - 29ms/step
Epoch 15/50
273/273 - 8s - loss: 11.8976 - accuracy10: 0.5068 - accuracy20: 0.5121 - accuracy30: 0.5051 - accuracy50: 0.4763 - val_loss: 13.0297 - val_accuracy10: 0.4978 - val_accuracy20: 0.4737 - val_accuracy30: 0.4502 - val_accuracy50: 0.4192 - 8s/epoch - 29ms/step
Epoch 16/50
273/273 - 8s - loss: 11.8777 - accuracy10: 0.5087 - accuracy20: 0.5131 - accuracy30: 0.5056 - accuracy50: 0.4762 - val_loss: 13.0936 - val_accuracy10: 0.4943 - val_accuracy20: 0.4684 - val_accuracy30: 0.4455 - val_accuracy50: 0.4163 - 8s/epoch - 30ms/step
Epoch 17/50
273/273 - 8s - loss: 11.8692 - accuracy10: 0.5053 - accuracy20: 0.5116 - accuracy30: 0.5054 - accuracy50: 0.4767 - val_loss: 13.0466 - val_accuracy10: 0.4898 - val_accuracy20: 0.4697 - val_accuracy30: 0.4508 - val_accuracy50: 0.4212 - 8s/epoch - 28ms/step
Epoch 18/50
273/273 - 8s - loss: 11.8203 - accuracy10: 0.5103 - accuracy20: 0.5163 - accuracy30: 0.5082 - accuracy50: 0.4792 - val_loss: 13.1277 - val_accuracy10: 0.4934 - val_accuracy20: 0.4688 - val_accuracy30: 0.4469 - val_accuracy50: 0.4187 - 8s/epoch - 29ms/step
Epoch 19/50
273/273 - 8s - loss: 11.7870 - accuracy10: 0.5120 - accuracy20: 0.5185 - accuracy30: 0.5123 - accuracy50: 0.4832 - val_loss: 13.1976 - val_accuracy10: 0.4920 - val_accuracy20: 0.4657 - val_accuracy30: 0.4473 - val_accuracy50: 0.4182 - 8s/epoch - 28ms/step
testing model: results/LILAK/W5/deepVOL_L2/seq2seq
Evaluating performance on  test set...
1060/1060 - 11s - 11s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0545743
{'0': {'precision': 0.38647245534753605, 'recall': 0.6445860158370533, 'f1-score': 0.4832213636478294, 'support': 89158}, '1': {'precision': 0.5788106704182674, 'recall': 0.44064550013902765, 'f1-score': 0.5003654393750695, 'support': 97103}, '2': {'precision': 0.42483364823790354, 'recall': 0.2431958993169447, 'f1-score': 0.3093210518052202, 'support': 85059}, 'accuracy': 0.44576146247972875, 'macro avg': {'precision': 0.46337225800123566, 'recall': 0.4428091384310086, 'f1-score': 0.4309692849427063, 'support': 271320}, 'weighted avg': {'precision': 0.46733484073775783, 'recall': 0.44576146247972875, 'f1-score': 0.4348392117988013, 'support': 271320}}
[[57470 17562 14126]
 [40435 42788 13880]
 [50799 13574 20686]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0492251
{'0': {'precision': 0.4323647689638858, 'recall': 0.6401615021647128, 'f1-score': 0.5161333338562728, 'support': 102785}, '1': {'precision': 0.4605103927018365, 'recall': 0.48265432701018857, 'f1-score': 0.47132240853658536, 'support': 71747}, '2': {'precision': 0.46639659527981975, 'recall': 0.21173079307352152, 'f1-score': 0.29124475047432263, 'support': 96788}, 'accuracy': 0.4456766917293233, 'macro avg': {'precision': 0.45309058564851407, 'recall': 0.4448488740828076, 'f1-score': 0.4262334976223936, 'support': 271320}, 'weighted avg': {'precision': 0.45194768386803363, 'recall': 0.4456766917293233, 'f1-score': 0.4240591569902703, 'support': 271320}}
[[65799 22486 14500]
 [28172 34629  8946]
 [58213 18082 20493]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.060891
{'0': {'precision': 0.4397615091388916, 'recall': 0.6360911610020924, 'f1-score': 0.5200124825186948, 'support': 106098}, '1': {'precision': 0.40424595469255664, 'recall': 0.4820028400321047, 'f1-score': 0.4397133161548318, 'support': 64788}, '2': {'precision': 0.4733407215860116, 'recall': 0.19136945655853596, 'f1-score': 0.27254872765688926, 'support': 100434}, 'accuracy': 0.4346749226006192, 'macro avg': {'precision': 0.43911606180582, 'recall': 0.4364878191975777, 'f1-score': 0.41075817544347193, 'support': 271320}, 'weighted avg': {'precision': 0.44371076787929004, 'recall': 0.4346749226006192, 'f1-score': 0.40923481354415353, 'support': 271320}}
[[67488 25032 13578]
 [25753 31228  7807]
 [60224 20990 19220]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1005242
{'0': {'precision': 0.41227813631252963, 'recall': 0.623376112890863, 'f1-score': 0.496313016128843, 'support': 101762}, '1': {'precision': 0.36836302810654636, 'recall': 0.41351105294602974, 'f1-score': 0.38963354153821406, 'support': 70298}, '2': {'precision': 0.4567321414670853, 'recall': 0.1773322587144872, 'f1-score': 0.2554735520577072, 'support': 99260}, 'accuracy': 0.4058196962995725, 'macro avg': {'precision': 0.41245776862872047, 'recall': 0.40473980818379335, 'f1-score': 0.38047336990825475, 'support': 271320}, 'weighted avg': {'precision': 0.4171629965328487, 'recall': 0.4058196962995725, 'f1-score': 0.3805637941456756, 'support': 271320}}
[[63436 25930 12396]
 [32688 29069  8541]
 [57743 23915 17602]]
Evaluating performance on  train set...
273/273 - 3s - 3s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0341939
{'0': {'precision': 0.3494430809892392, 'recall': 0.6074827699376436, 'f1-score': 0.4436720997123682, 'support': 18282}, '1': {'precision': 0.6691909630190584, 'recall': 0.4839062975357469, 'f1-score': 0.5616624587298504, 'support': 32870}, '2': {'precision': 0.39601926618501204, 'recall': 0.3019387589782362, 'f1-score': 0.34263827179408607, 'support': 18517}, 'accuracy': 0.46796997229757853, 'macro avg': {'precision': 0.4715511033977699, 'recall': 0.46444260881720884, 'f1-score': 0.4493242767454349, 'support': 69669}, 'weighted avg': {'precision': 0.5126801606601156, 'recall': 0.46796997229757853, 'f1-score': 0.4724869199242531, 'support': 69669}}
[[11106  4306  2870]
 [11307 15906  5657]
 [ 9369  3557  5591]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0309414
{'0': {'precision': 0.40325318682675393, 'recall': 0.5960038319419735, 'f1-score': 0.4810382916053019, 'support': 21921}, '1': {'precision': 0.5609878400401154, 'recall': 0.5252963962906444, 'f1-score': 0.5425557710960232, 'support': 25557}, '2': {'precision': 0.4624784466601694, 'recall': 0.2779955837952323, 'f1-score': 0.3472558401350971, 'support': 22191}, 'accuracy': 0.46877377312721585, 'macro avg': {'precision': 0.4755731578423463, 'recall': 0.46643193734261673, 'f1-score': 0.45694996761214074, 'support': 69669}, 'weighted avg': {'precision': 0.4799801711833143, 'recall': 0.46877377312721585, 'f1-score': 0.4609925875298745, 'support': 69669}}
[[13065  5725  3131]
 [ 8093 13425  4039]
 [11241  4781  6169]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0408887
{'0': {'precision': 0.41886005276397326, 'recall': 0.5835541499273442, 'f1-score': 0.48767769126366173, 'support': 23398}, '1': {'precision': 0.5024760647078244, 'recall': 0.5347152079399236, 'f1-score': 0.51809458970704, 'support': 22771}, '2': {'precision': 0.47745151491549187, 'recall': 0.26085106382978723, 'f1-score': 0.3373785739838741, 'support': 23500}, 'accuracy': 0.4587406163429933, 'macro avg': {'precision': 0.46626254412909646, 'recall': 0.45970680723235163, 'f1-score': 0.4477169516515253, 'support': 69669}, 'weighted avg': {'precision': 0.46595301474898987, 'recall': 0.4587406163429933, 'f1-score': 0.4469220314778052, 'support': 69669}}
[[13654  6565  3179]
 [ 7065 12176  3530]
 [11879  5491  6130]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0760885
{'0': {'precision': 0.39782968548832076, 'recall': 0.5542837618518834, 'f1-score': 0.4632022271396959, 'support': 23414}, '1': {'precision': 0.46061475409836067, 'recall': 0.48929037875489767, 'f1-score': 0.47451973823094784, 'support': 22970}, '2': {'precision': 0.4629556416541472, 'recall': 0.25144943096414, 'f1-score': 0.32589335411332515, 'support': 23285}, 'accuracy': 0.431641045515222, 'macro avg': {'precision': 0.44046669374694286, 'recall': 0.4316745238569737, 'f1-score': 0.42120510649465626, 'support': 69669}, 'weighted avg': {'precision': 0.44029664949374475, 'recall': 0.431641045515222, 'f1-score': 0.42104181320160305, 'support': 69669}}
[[12978  7290  3146]
 [ 8085 11239  3646]
 [11559  5871  5855]]
Evaluating performance on  val set...
96/96 - 1s - 1s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0081426
{'0': {'precision': 0.3832049156344485, 'recall': 0.5794985250737463, 'f1-score': 0.46133975224564083, 'support': 6780}, '1': {'precision': 0.6594516594516594, 'recall': 0.5271049596309112, 'f1-score': 0.5858974358974359, 'support': 11271}, '2': {'precision': 0.39931284596297, 'recall': 0.32434108527131783, 'f1-score': 0.3579433655573616, 'support': 6450}, 'accuracy': 0.4882249704093711, 'macro avg': {'precision': 0.48065647368302594, 'recall': 0.4769815233253251, 'f1-score': 0.4683935179001461, 'support': 24501}, 'weighted avg': {'precision': 0.5145249923734693, 'recall': 0.4882249704093711, 'f1-score': 0.4914194615758715, 'support': 24501}}
[[3929 1764 1087]
 [3270 5941 2060]
 [3054 1304 2092]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0213507
{'0': {'precision': 0.4306478005582828, 'recall': 0.5597397723007632, 'f1-score': 0.48678054618648675, 'support': 7993}, '1': {'precision': 0.5511189118034225, 'recall': 0.5672990063233966, 'f1-score': 0.5590919207656355, 'support': 8856}, '2': {'precision': 0.44915932746196957, 'recall': 0.2932566649242028, 'f1-score': 0.3548387096774193, 'support': 7652}, 'accuracy': 0.4792457450716297, 'macro avg': {'precision': 0.47697534660789165, 'recall': 0.4734318145161209, 'f1-score': 0.4669037255431805, 'support': 24501}, 'weighted avg': {'precision': 0.479974047040221, 'recall': 0.4792457450716297, 'f1-score': 0.4717105735447807, 'support': 24501}}
[[4474 2307 1212]
 [2292 5024 1540]
 [3623 1785 2244]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0446684
{'0': {'precision': 0.434640522875817, 'recall': 0.53769322235434, 'f1-score': 0.48070585734027854, 'support': 8410}, '1': {'precision': 0.491376505043931, 'recall': 0.5682388359257401, 'f1-score': 0.5270199523006224, 'support': 7972}, '2': {'precision': 0.4534645346453465, 'recall': 0.27244734573223306, 'f1-score': 0.34038624297914905, 'support': 8119}, 'accuracy': 0.4597363372923554, 'macro avg': {'precision': 0.45982718752169816, 'recall': 0.45945980133743775, 'f1-score': 0.44937068420668336, 'support': 24501}, 'weighted avg': {'precision': 0.4593387556581938, 'recall': 0.4597363372923554, 'f1-score': 0.44927697754050916, 'support': 24501}}
[[4522 2620 1268]
 [2044 4530 1398]
 [3838 2069 2212]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0818793
{'0': {'precision': 0.4096094354215004, 'recall': 0.5090100913022585, 'f1-score': 0.4539318620098564, 'support': 8324}, '1': {'precision': 0.4438824921984289, 'recall': 0.5163995993990986, 'f1-score': 0.47740292807129214, 'support': 7988}, '2': {'precision': 0.4401726973684211, 'recall': 0.26144828428379535, 'f1-score': 0.32804719221634876, 'support': 8189}, 'accuracy': 0.4286763805558957, 'macro avg': {'precision': 0.4312215416627834, 'recall': 0.4289526583283842, 'f1-score': 0.4197939940991658, 'support': 24501}, 'weighted avg': {'precision': 0.4309985921749977, 'recall': 0.4286763805558957, 'f1-score': 0.41950948393384785, 'support': 24501}}
[[4237 2827 1260]
 [2400 4125 1463]
 [3707 2341 2141]]
training model: results/LILAK/W5/deepVOL_L3/seq2seq
Epoch 1/50
273/273 - 17s - loss: 13.2160 - accuracy10: 0.3689 - accuracy20: 0.3724 - accuracy30: 0.3740 - accuracy50: 0.3705 - val_loss: 14.1477 - val_accuracy10: 0.4602 - val_accuracy20: 0.3636 - val_accuracy30: 0.3272 - val_accuracy50: 0.3265 - 17s/epoch - 62ms/step
Epoch 2/50
273/273 - 11s - loss: 13.0673 - accuracy10: 0.3849 - accuracy20: 0.3857 - accuracy30: 0.3825 - accuracy50: 0.3762 - val_loss: 13.2404 - val_accuracy10: 0.4678 - val_accuracy20: 0.4172 - val_accuracy30: 0.3914 - val_accuracy50: 0.3700 - 11s/epoch - 41ms/step
Epoch 3/50
273/273 - 11s - loss: 12.8687 - accuracy10: 0.4122 - accuracy20: 0.4108 - accuracy30: 0.4044 - accuracy50: 0.3903 - val_loss: 12.7675 - val_accuracy10: 0.4433 - val_accuracy20: 0.4428 - val_accuracy30: 0.4304 - val_accuracy50: 0.4039 - 11s/epoch - 41ms/step
Epoch 4/50
273/273 - 11s - loss: 12.6571 - accuracy10: 0.4297 - accuracy20: 0.4352 - accuracy30: 0.4311 - accuracy50: 0.4146 - val_loss: 12.7132 - val_accuracy10: 0.4746 - val_accuracy20: 0.4558 - val_accuracy30: 0.4316 - val_accuracy50: 0.4036 - 11s/epoch - 41ms/step
Epoch 5/50
273/273 - 11s - loss: 12.5381 - accuracy10: 0.4403 - accuracy20: 0.4464 - accuracy30: 0.4446 - accuracy50: 0.4269 - val_loss: 12.7672 - val_accuracy10: 0.4885 - val_accuracy20: 0.4653 - val_accuracy30: 0.4427 - val_accuracy50: 0.4162 - 11s/epoch - 40ms/step
Epoch 6/50
273/273 - 11s - loss: 12.4231 - accuracy10: 0.4500 - accuracy20: 0.4580 - accuracy30: 0.4554 - accuracy50: 0.4356 - val_loss: 12.5547 - val_accuracy10: 0.4851 - val_accuracy20: 0.4737 - val_accuracy30: 0.4562 - val_accuracy50: 0.4292 - 11s/epoch - 40ms/step
Epoch 7/50
273/273 - 11s - loss: 12.3197 - accuracy10: 0.4596 - accuracy20: 0.4695 - accuracy30: 0.4644 - accuracy50: 0.4428 - val_loss: 12.5034 - val_accuracy10: 0.4943 - val_accuracy20: 0.4815 - val_accuracy30: 0.4601 - val_accuracy50: 0.4321 - 11s/epoch - 40ms/step
Epoch 8/50
273/273 - 11s - loss: 12.2592 - accuracy10: 0.4673 - accuracy20: 0.4765 - accuracy30: 0.4733 - accuracy50: 0.4490 - val_loss: 12.5620 - val_accuracy10: 0.5017 - val_accuracy20: 0.4819 - val_accuracy30: 0.4592 - val_accuracy50: 0.4274 - 11s/epoch - 42ms/step
Epoch 9/50
273/273 - 12s - loss: 12.1943 - accuracy10: 0.4749 - accuracy20: 0.4828 - accuracy30: 0.4788 - accuracy50: 0.4560 - val_loss: 12.4668 - val_accuracy10: 0.4932 - val_accuracy20: 0.4836 - val_accuracy30: 0.4666 - val_accuracy50: 0.4355 - 12s/epoch - 43ms/step
Epoch 10/50
273/273 - 12s - loss: 12.1344 - accuracy10: 0.4818 - accuracy20: 0.4884 - accuracy30: 0.4830 - accuracy50: 0.4579 - val_loss: 12.5695 - val_accuracy10: 0.4982 - val_accuracy20: 0.4852 - val_accuracy30: 0.4637 - val_accuracy50: 0.4332 - 12s/epoch - 43ms/step
Epoch 11/50
273/273 - 12s - loss: 12.0862 - accuracy10: 0.4874 - accuracy20: 0.4930 - accuracy30: 0.4868 - accuracy50: 0.4618 - val_loss: 12.4476 - val_accuracy10: 0.4900 - val_accuracy20: 0.4851 - val_accuracy30: 0.4661 - val_accuracy50: 0.4354 - 12s/epoch - 42ms/step
Epoch 12/50
273/273 - 11s - loss: 12.0536 - accuracy10: 0.4904 - accuracy20: 0.4944 - accuracy30: 0.4888 - accuracy50: 0.4620 - val_loss: 12.5694 - val_accuracy10: 0.4981 - val_accuracy20: 0.4852 - val_accuracy30: 0.4642 - val_accuracy50: 0.4355 - 11s/epoch - 41ms/step
Epoch 13/50
273/273 - 11s - loss: 12.0208 - accuracy10: 0.4929 - accuracy20: 0.4964 - accuracy30: 0.4909 - accuracy50: 0.4646 - val_loss: 12.4007 - val_accuracy10: 0.4976 - val_accuracy20: 0.4870 - val_accuracy30: 0.4695 - val_accuracy50: 0.4395 - 11s/epoch - 42ms/step
Epoch 14/50
273/273 - 11s - loss: 11.9924 - accuracy10: 0.4960 - accuracy20: 0.5021 - accuracy30: 0.4951 - accuracy50: 0.4677 - val_loss: 12.9530 - val_accuracy10: 0.5114 - val_accuracy20: 0.4840 - val_accuracy30: 0.4581 - val_accuracy50: 0.4287 - 11s/epoch - 41ms/step
Epoch 15/50
273/273 - 11s - loss: 11.9481 - accuracy10: 0.4993 - accuracy20: 0.5045 - accuracy30: 0.4992 - accuracy50: 0.4713 - val_loss: 12.6110 - val_accuracy10: 0.4859 - val_accuracy20: 0.4825 - val_accuracy30: 0.4663 - val_accuracy50: 0.4377 - 11s/epoch - 40ms/step
Epoch 16/50
273/273 - 11s - loss: 11.9302 - accuracy10: 0.5000 - accuracy20: 0.5066 - accuracy30: 0.4997 - accuracy50: 0.4713 - val_loss: 12.6729 - val_accuracy10: 0.5041 - val_accuracy20: 0.4857 - val_accuracy30: 0.4640 - val_accuracy50: 0.4323 - 11s/epoch - 41ms/step
Epoch 17/50
273/273 - 11s - loss: 11.8701 - accuracy10: 0.5043 - accuracy20: 0.5109 - accuracy30: 0.5046 - accuracy50: 0.4764 - val_loss: 12.5870 - val_accuracy10: 0.5017 - val_accuracy20: 0.4848 - val_accuracy30: 0.4635 - val_accuracy50: 0.4329 - 11s/epoch - 42ms/step
Epoch 18/50
273/273 - 11s - loss: 11.8481 - accuracy10: 0.5041 - accuracy20: 0.5120 - accuracy30: 0.5051 - accuracy50: 0.4751 - val_loss: 12.8559 - val_accuracy10: 0.5023 - val_accuracy20: 0.4809 - val_accuracy30: 0.4568 - val_accuracy50: 0.4286 - 11s/epoch - 42ms/step
Epoch 19/50
273/273 - 12s - loss: 11.8269 - accuracy10: 0.5047 - accuracy20: 0.5116 - accuracy30: 0.5075 - accuracy50: 0.4792 - val_loss: 12.7271 - val_accuracy10: 0.4867 - val_accuracy20: 0.4768 - val_accuracy30: 0.4590 - val_accuracy50: 0.4311 - 12s/epoch - 43ms/step
Epoch 20/50
273/273 - 12s - loss: 11.8045 - accuracy10: 0.5070 - accuracy20: 0.5156 - accuracy30: 0.5107 - accuracy50: 0.4828 - val_loss: 12.7350 - val_accuracy10: 0.4868 - val_accuracy20: 0.4741 - val_accuracy30: 0.4523 - val_accuracy50: 0.4265 - 12s/epoch - 42ms/step
Epoch 21/50
273/273 - 12s - loss: 11.7867 - accuracy10: 0.5075 - accuracy20: 0.5172 - accuracy30: 0.5122 - accuracy50: 0.4822 - val_loss: 12.8057 - val_accuracy10: 0.4979 - val_accuracy20: 0.4831 - val_accuracy30: 0.4575 - val_accuracy50: 0.4290 - 12s/epoch - 43ms/step
Epoch 22/50
273/273 - 11s - loss: 11.7562 - accuracy10: 0.5087 - accuracy20: 0.5183 - accuracy30: 0.5133 - accuracy50: 0.4844 - val_loss: 12.8150 - val_accuracy10: 0.4936 - val_accuracy20: 0.4727 - val_accuracy30: 0.4485 - val_accuracy50: 0.4230 - 11s/epoch - 41ms/step
Epoch 23/50
273/273 - 11s - loss: 11.7304 - accuracy10: 0.5127 - accuracy20: 0.5217 - accuracy30: 0.5160 - accuracy50: 0.4867 - val_loss: 13.0127 - val_accuracy10: 0.4893 - val_accuracy20: 0.4654 - val_accuracy30: 0.4386 - val_accuracy50: 0.4182 - 11s/epoch - 41ms/step
testing model: results/LILAK/W5/deepVOL_L3/seq2seq
Evaluating performance on  test set...
1060/1060 - 17s - 17s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0364661
{'0': {'precision': 0.4033891439373481, 'recall': 0.6701585948540792, 'f1-score': 0.5036286549954062, 'support': 89158}, '1': {'precision': 0.5900460589959428, 'recall': 0.4208520848995397, 'f1-score': 0.49129007826306487, 'support': 97103}, '2': {'precision': 0.4467473721288074, 'recall': 0.28330923241514716, 'f1-score': 0.34673381294964034, 'support': 85059}, 'accuracy': 0.459656494176618, 'macro avg': {'precision': 0.4800608583540327, 'recall': 0.45810663738958873, 'f1-score': 0.4472175154027038, 'support': 271320}, 'weighted avg': {'precision': 0.4837848167763281, 'recall': 0.459656494176618, 'f1-score': 0.45002615172984767, 'support': 271320}}
[[59750 16025 13383]
 [39777 40866 16460]
 [48593 12368 24098]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0385921
{'0': {'precision': 0.44857642475677356, 'recall': 0.646397820693681, 'f1-score': 0.5296176135321924, 'support': 102785}, '1': {'precision': 0.4660855078916, 'recall': 0.4523394706398874, 'f1-score': 0.45910962101599967, 'support': 71747}, '2': {'precision': 0.48378005076900105, 'recall': 0.2677914617514568, 'f1-score': 0.3447500731558086, 'support': 96788}, 'accuracy': 0.46002137697184137, 'macro avg': {'precision': 0.46614732780579154, 'recall': 0.45550958436167505, 'f1-score': 0.4444924359013336, 'support': 271320}, 'weighted avg': {'precision': 0.46576466278620693, 'recall': 0.46002137697184137, 'f1-score': 0.44502489483468133, 'support': 271320}}
[[66440 20742 15603]
 [27239 32454 12054]
 [54434 16435 25919]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0514671
{'0': {'precision': 0.455763050701746, 'recall': 0.6295877396369395, 'f1-score': 0.5287559219665876, 'support': 106098}, '1': {'precision': 0.40898221385819195, 'recall': 0.4461319997530407, 'f1-score': 0.42675013472512385, 'support': 64788}, '2': {'precision': 0.48561496930700393, 'recall': 0.2615050680048589, 'f1-score': 0.33994744948808553, 'support': 100434}, 'accuracy': 0.4495282323455698, 'macro avg': {'precision': 0.4501200779556473, 'recall': 0.4457416024649464, 'f1-score': 0.4318178353932656, 'support': 271320}, 'weighted avg': {'precision': 0.4556425683774805, 'recall': 0.4495282323455698, 'f1-score': 0.43450728173105085, 'support': 271320}}
[[66798 22871 16429]
 [24493 28904 11391]
 [55272 18898 26264]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0873607
{'0': {'precision': 0.42337786585574194, 'recall': 0.608822546726676, 'f1-score': 0.49944175060560986, 'support': 101762}, '1': {'precision': 0.3681491307686937, 'recall': 0.37504623175623775, 'f1-score': 0.37156567756301395, 'support': 70298}, '2': {'precision': 0.45754169008806445, 'recall': 0.24601047753374974, 'f1-score': 0.3199764135491057, 'support': 99260}, 'accuracy': 0.4155204186937933, 'macro avg': {'precision': 0.4163562289041667, 'recall': 0.4099597520055545, 'f1-score': 0.3969946139059098, 'support': 271320}, 'weighted avg': {'precision': 0.42156683671727446, 'recall': 0.4155204186937933, 'f1-score': 0.40065374552313526, 'support': 271320}}
[[61955 23546 16261]
 [31243 26365 12690]
 [53137 21704 24419]]
Evaluating performance on  train set...
273/273 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0005859
{'0': {'precision': 0.36533578773644787, 'recall': 0.6296357072530357, 'f1-score': 0.4623820044185579, 'support': 18282}, '1': {'precision': 0.6905722999641192, 'recall': 0.46842105263157896, 'f1-score': 0.5582061414639452, 'support': 32870}, '2': {'precision': 0.41859439016703437, 'recall': 0.3586434087595183, 'f1-score': 0.3863067884358094, 'support': 18517}, 'accuracy': 0.48154846488395125, 'macro avg': {'precision': 0.49150082595586714, 'recall': 0.48556672288137764, 'f1-score': 0.4689649781061041, 'support': 69669}, 'weighted avg': {'precision': 0.5329385048434929, 'recall': 0.48154846488395125, 'f1-score': 0.48737238192260307, 'support': 69669}}
[[11511  3738  3033]
 [11282 15397  6191]
 [ 8715  3161  6641]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0051229
{'0': {'precision': 0.42044042193823894, 'recall': 0.6018429816158022, 'f1-score': 0.495046904315197, 'support': 21921}, '1': {'precision': 0.5826024700196886, 'recall': 0.5094494658997535, 'f1-score': 0.5435758271579167, 'support': 25557}, '2': {'precision': 0.47679086689248523, 'recall': 0.34252624938037946, 'f1-score': 0.39865733092072486, 'support': 22191}, 'accuracy': 0.48535216523848485, 'macro avg': {'precision': 0.49327791961680423, 'recall': 0.4846062322986451, 'f1-score': 0.47909335413127957, 'support': 69669}, 'weighted avg': {'precision': 0.4978758406581471, 'recall': 0.48535216523848485, 'f1-score': 0.48214694390087587, 'support': 69669}}
[[13193  5077  3651]
 [ 7847 13020  4690]
 [10339  4251  7601]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0165612
{'0': {'precision': 0.43957146556188503, 'recall': 0.5804342251474485, 'f1-score': 0.5002762736213946, 'support': 23398}, '1': {'precision': 0.5236108645481982, 'recall': 0.5181151464582144, 'f1-score': 0.5208485089287685, 'support': 22771}, '2': {'precision': 0.49128748229788805, 'recall': 0.339531914893617, 'f1-score': 0.40155003648624843, 'support': 23500}, 'accuracy': 0.47880692991143836, 'macro avg': {'precision': 0.48482327080265714, 'recall': 0.47936042883309327, 'f1-score': 0.4742249396788039, 'support': 69669}, 'weighted avg': {'precision': 0.4844836581814634, 'recall': 0.47880692991143836, 'f1-score': 0.4736989407690252, 'support': 69669}}
[[13581  5847  3970]
 [ 6681 11798  4292]
 [10634  4887  7979]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0506375
{'0': {'precision': 0.4171907073734971, 'recall': 0.5468523105834117, 'f1-score': 0.4733019129470474, 'support': 23414}, '1': {'precision': 0.47880014074595356, 'recall': 0.473922507618633, 'f1-score': 0.47634883822692864, 'support': 22970}, '2': {'precision': 0.4668760004925502, 'recall': 0.3256602963281082, 'f1-score': 0.3836870999569914, 'support': 23285}, 'accuracy': 0.44887970259369303, 'macro avg': {'precision': 0.4542889495373337, 'recall': 0.44881170484338434, 'f1-score': 0.44444595037698914, 'support': 69669}, 'weighted avg': {'precision': 0.4541094335622249, 'recall': 0.44887970259369303, 'f1-score': 0.44435513537316834, 'support': 69669}}
[[12804  6545  4065]
 [ 7490 10886  4594]
 [10397  5305  7583]]
Evaluating performance on  val set...
96/96 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9852917
{'0': {'precision': 0.40299887028858994, 'recall': 0.5787610619469027, 'f1-score': 0.4751468184294969, 'support': 6780}, '1': {'precision': 0.6670083134039403, 'recall': 0.5196522047733121, 'f1-score': 0.5841811290644324, 'support': 11271}, '2': {'precision': 0.40982784556242685, 'recall': 0.3801550387596899, 'f1-score': 0.39443416713584806, 'support': 6450}, 'accuracy': 0.4992857434390433, 'macro avg': {'precision': 0.4932783430849857, 'recall': 0.49285610182663486, 'f1-score': 0.4845873715432591, 'support': 24501}, 'weighted avg': {'precision': 0.5262467917558509, 'recall': 0.49928574343904336, 'f1-score': 0.5040570308421464, 'support': 24501}}
[[3924 1649 1207]
 [3090 5857 2324]
 [2723 1275 2452]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.012174
{'0': {'precision': 0.45087900723888313, 'recall': 0.5454772926310522, 'f1-score': 0.49368736907660077, 'support': 7993}, '1': {'precision': 0.5551136363636363, 'recall': 0.5516034327009937, 'f1-score': 0.553352967829633, 'support': 8856}, '2': {'precision': 0.4543193500248715, 'recall': 0.35807631991636174, 'f1-score': 0.40049696703939197, 'support': 7652}, 'accuracy': 0.48916370760377126, 'macro avg': {'precision': 0.48677066454246365, 'recall': 0.4850523484161358, 'f1-score': 0.4825124346485419, 'support': 24501}, 'weighted avg': {'precision': 0.48962956348259556, 'recall': 0.48916370760377126, 'f1-score': 0.4861491292565172, 'support': 24501}}
[[4360 2166 1467]
 [2147 4885 1824]
 [3163 1749 2740]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0360988
{'0': {'precision': 0.45548089038219236, 'recall': 0.5158145065398335, 'f1-score': 0.48377383740381397, 'support': 8410}, '1': {'precision': 0.49463337475991415, 'recall': 0.5491721023582539, 'f1-score': 0.5204779171372527, 'support': 7972}, '2': {'precision': 0.4596800522363696, 'recall': 0.346840743933982, 'f1-score': 0.39536679536679536, 'support': 8119}, 'accuracy': 0.4706746663401494, 'macro avg': {'precision': 0.4699314391261587, 'recall': 0.47060911761068974, 'f1-score': 0.466539516635954, 'support': 24501}, 'weighted avg': {'precision': 0.46961160343689473, 'recall': 0.4706746663401494, 'f1-score': 0.46642059261121044, 'support': 24501}}
[[4338 2457 1615]
 [1899 4378 1695]
 [3287 2016 2816]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0709453
{'0': {'precision': 0.4280118568706331, 'recall': 0.4857039884670831, 'f1-score': 0.4550365785030951, 'support': 8324}, '1': {'precision': 0.4502130522538686, 'recall': 0.5026289434151227, 'f1-score': 0.4749792972909026, 'support': 7988}, '2': {'precision': 0.4404432132963989, 'recall': 0.3300769324703871, 'f1-score': 0.3773558564847131, 'support': 8189}, 'accuracy': 0.43920656299742866, 'macro avg': {'precision': 0.4395560408069669, 'recall': 0.43946995478419765, 'f1-score': 0.43579057742623695, 'support': 24501}, 'weighted avg': {'precision': 0.43940500517037107, 'recall': 0.43920656299742866, 'f1-score': 0.4355751281569246, 'support': 24501}}
[[4043 2644 1637]
 [2176 4015 1797]
 [3227 2259 2703]]
training model: results/LILAK/W6/deepLOB_L1/seq2seq
Epoch 1/50
211/211 - 11s - loss: 13.2427 - accuracy10: 0.3760 - accuracy20: 0.3698 - accuracy30: 0.3683 - accuracy50: 0.3598 - val_loss: 13.4433 - val_accuracy10: 0.3995 - val_accuracy20: 0.3449 - val_accuracy30: 0.3486 - val_accuracy50: 0.3473 - 11s/epoch - 53ms/step
Epoch 2/50
211/211 - 5s - loss: 13.1208 - accuracy10: 0.3828 - accuracy20: 0.3819 - accuracy30: 0.3796 - accuracy50: 0.3731 - val_loss: 13.2372 - val_accuracy10: 0.3990 - val_accuracy20: 0.3633 - val_accuracy30: 0.3672 - val_accuracy50: 0.3639 - 5s/epoch - 24ms/step
Epoch 3/50
211/211 - 5s - loss: 13.0722 - accuracy10: 0.3797 - accuracy20: 0.3901 - accuracy30: 0.3847 - accuracy50: 0.3755 - val_loss: 13.1380 - val_accuracy10: 0.3932 - val_accuracy20: 0.3807 - val_accuracy30: 0.3765 - val_accuracy50: 0.3715 - 5s/epoch - 24ms/step
Epoch 4/50
211/211 - 5s - loss: 13.0260 - accuracy10: 0.3894 - accuracy20: 0.4001 - accuracy30: 0.3937 - accuracy50: 0.3846 - val_loss: 13.1309 - val_accuracy10: 0.4064 - val_accuracy20: 0.3686 - val_accuracy30: 0.3664 - val_accuracy50: 0.3597 - 5s/epoch - 23ms/step
Epoch 5/50
211/211 - 5s - loss: 12.9618 - accuracy10: 0.3983 - accuracy20: 0.4093 - accuracy30: 0.4048 - accuracy50: 0.3944 - val_loss: 13.1040 - val_accuracy10: 0.4243 - val_accuracy20: 0.3800 - val_accuracy30: 0.3670 - val_accuracy50: 0.3564 - 5s/epoch - 23ms/step
Epoch 6/50
211/211 - 5s - loss: 12.9167 - accuracy10: 0.4065 - accuracy20: 0.4187 - accuracy30: 0.4116 - accuracy50: 0.3981 - val_loss: 13.1065 - val_accuracy10: 0.4096 - val_accuracy20: 0.3741 - val_accuracy30: 0.3708 - val_accuracy50: 0.3636 - 5s/epoch - 22ms/step
Epoch 7/50
211/211 - 5s - loss: 12.8906 - accuracy10: 0.4120 - accuracy20: 0.4209 - accuracy30: 0.4145 - accuracy50: 0.4012 - val_loss: 13.1079 - val_accuracy10: 0.4170 - val_accuracy20: 0.3859 - val_accuracy30: 0.3807 - val_accuracy50: 0.3734 - 5s/epoch - 22ms/step
Epoch 8/50
211/211 - 5s - loss: 12.8562 - accuracy10: 0.4173 - accuracy20: 0.4265 - accuracy30: 0.4205 - accuracy50: 0.4053 - val_loss: 13.1432 - val_accuracy10: 0.4235 - val_accuracy20: 0.3788 - val_accuracy30: 0.3739 - val_accuracy50: 0.3658 - 5s/epoch - 22ms/step
Epoch 9/50
211/211 - 5s - loss: 12.8231 - accuracy10: 0.4187 - accuracy20: 0.4288 - accuracy30: 0.4210 - accuracy50: 0.4074 - val_loss: 13.0820 - val_accuracy10: 0.4167 - val_accuracy20: 0.3892 - val_accuracy30: 0.3875 - val_accuracy50: 0.3735 - 5s/epoch - 22ms/step
Epoch 10/50
211/211 - 5s - loss: 12.8317 - accuracy10: 0.4206 - accuracy20: 0.4280 - accuracy30: 0.4209 - accuracy50: 0.4048 - val_loss: 13.1163 - val_accuracy10: 0.4198 - val_accuracy20: 0.3825 - val_accuracy30: 0.3795 - val_accuracy50: 0.3663 - 5s/epoch - 22ms/step
Epoch 11/50
211/211 - 5s - loss: 12.7898 - accuracy10: 0.4300 - accuracy20: 0.4359 - accuracy30: 0.4277 - accuracy50: 0.4126 - val_loss: 13.1220 - val_accuracy10: 0.4216 - val_accuracy20: 0.3893 - val_accuracy30: 0.3888 - val_accuracy50: 0.3743 - 5s/epoch - 22ms/step
Epoch 12/50
211/211 - 5s - loss: 12.7867 - accuracy10: 0.4319 - accuracy20: 0.4356 - accuracy30: 0.4281 - accuracy50: 0.4101 - val_loss: 13.1320 - val_accuracy10: 0.4192 - val_accuracy20: 0.3784 - val_accuracy30: 0.3794 - val_accuracy50: 0.3714 - 5s/epoch - 22ms/step
Epoch 13/50
211/211 - 5s - loss: 12.7443 - accuracy10: 0.4341 - accuracy20: 0.4381 - accuracy30: 0.4301 - accuracy50: 0.4122 - val_loss: 13.0821 - val_accuracy10: 0.4157 - val_accuracy20: 0.3921 - val_accuracy30: 0.3907 - val_accuracy50: 0.3779 - 5s/epoch - 22ms/step
Epoch 14/50
211/211 - 5s - loss: 12.7303 - accuracy10: 0.4404 - accuracy20: 0.4441 - accuracy30: 0.4337 - accuracy50: 0.4160 - val_loss: 13.1189 - val_accuracy10: 0.4069 - val_accuracy20: 0.3944 - val_accuracy30: 0.3937 - val_accuracy50: 0.3828 - 5s/epoch - 22ms/step
Epoch 15/50
211/211 - 5s - loss: 12.7135 - accuracy10: 0.4428 - accuracy20: 0.4450 - accuracy30: 0.4358 - accuracy50: 0.4182 - val_loss: 13.1169 - val_accuracy10: 0.4150 - val_accuracy20: 0.3924 - val_accuracy30: 0.3925 - val_accuracy50: 0.3773 - 5s/epoch - 22ms/step
Epoch 16/50
211/211 - 5s - loss: 12.6968 - accuracy10: 0.4420 - accuracy20: 0.4442 - accuracy30: 0.4353 - accuracy50: 0.4174 - val_loss: 13.1593 - val_accuracy10: 0.4085 - val_accuracy20: 0.3892 - val_accuracy30: 0.3864 - val_accuracy50: 0.3761 - 5s/epoch - 22ms/step
Epoch 17/50
211/211 - 5s - loss: 12.6646 - accuracy10: 0.4481 - accuracy20: 0.4510 - accuracy30: 0.4406 - accuracy50: 0.4188 - val_loss: 13.1751 - val_accuracy10: 0.3844 - val_accuracy20: 0.3895 - val_accuracy30: 0.3917 - val_accuracy50: 0.3871 - 5s/epoch - 22ms/step
Epoch 18/50
211/211 - 5s - loss: 12.6531 - accuracy10: 0.4510 - accuracy20: 0.4521 - accuracy30: 0.4401 - accuracy50: 0.4219 - val_loss: 13.2287 - val_accuracy10: 0.3922 - val_accuracy20: 0.3806 - val_accuracy30: 0.3818 - val_accuracy50: 0.3752 - 5s/epoch - 22ms/step
Epoch 19/50
211/211 - 5s - loss: 12.6353 - accuracy10: 0.4484 - accuracy20: 0.4520 - accuracy30: 0.4419 - accuracy50: 0.4211 - val_loss: 13.1840 - val_accuracy10: 0.3938 - val_accuracy20: 0.3838 - val_accuracy30: 0.3875 - val_accuracy50: 0.3796 - 5s/epoch - 22ms/step
testing model: results/LILAK/W6/deepLOB_L1/seq2seq
Evaluating performance on  test set...
1059/1059 - 10s - 10s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0886623
{'0': {'precision': 0.4422184140831905, 'recall': 0.17149589173513774, 'f1-score': 0.24714640198511162, 'support': 82760}, '1': {'precision': 0.37338591083982997, 'recall': 0.7370540107961945, 'f1-score': 0.4956694690043623, 'support': 100591}, '2': {'precision': 0.42026331419520885, 'recall': 0.19360207943818689, 'f1-score': 0.2650869470200743, 'support': 87716}, 'accuracy': 0.3885238704822055, 'macro avg': {'precision': 0.41195587970607644, 'recall': 0.36738399398983973, 'f1-score': 0.3359676060031827, 'support': 271067}, 'weighted avg': {'precision': 0.4095706042224288, 'recall': 0.3885238704822055, 'f1-score': 0.3451769873489524, 'support': 271067}}
[[14193 60246  8321]
 [11345 74141 15105]
 [ 6557 64177 16982]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1231133
{'0': {'precision': 0.48745068892573323, 'recall': 0.17633919338159254, 'f1-score': 0.25898756094227, 'support': 96700}, '1': {'precision': 0.266577074615925, 'recall': 0.7291156159501002, 'f1-score': 0.3904126439780818, 'support': 71824}, '2': {'precision': 0.4758192689018391, 'recall': 0.1839325941312425, 'f1-score': 0.2653078448748787, 'support': 102543}, 'accuracy': 0.3256796290216072, 'macro avg': {'precision': 0.40994901081449914, 'recall': 0.36312913448764506, 'f1-score': 0.3049026832650768, 'support': 271067}, 'weighted avg': {'precision': 0.424526219411931, 'recall': 0.3256796290216072, 'f1-score': 0.2962018881723114, 'support': 271067}}
[[17052 69310 10338]
 [ 9016 52368 10440]
 [ 8914 74768 18861]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1155196
{'0': {'precision': 0.4604574555694286, 'recall': 0.1835034301685441, 'f1-score': 0.26242439382584276, 'support': 94456}, '1': {'precision': 0.28175646812387095, 'recall': 0.7203099918423199, 'f1-score': 0.4050669438884799, 'support': 76002}, '2': {'precision': 0.459220447284345, 'recall': 0.17858243298313273, 'f1-score': 0.25716003263343207, 'support': 100609}, 'accuracy': 0.3321872452198165, 'macro avg': {'precision': 0.4004781236592148, 'recall': 0.36079861833133225, 'f1-score': 0.3082171234492516, 'support': 271067}, 'weighted avg': {'precision': 0.40989399113299313, 'recall': 0.3321872452198165, 'f1-score': 0.30046471955584053, 'support': 271067}}
[[17333 66719 10404]
 [10503 54745 10754]
 [ 9807 72835 17967]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1119916
{'0': {'precision': 0.41895299198641933, 'recall': 0.1838297312988137, 'f1-score': 0.255534914882602, 'support': 91291}, '1': {'precision': 0.30001148729087906, 'recall': 0.7055739073839844, 'f1-score': 0.4210090529732661, 'support': 81433}, '2': {'precision': 0.434901504025928, 'recall': 0.17465401706272943, 'f1-score': 0.24922190703512118, 'support': 98343}, 'accuracy': 0.33724134623543256, 'macro avg': {'precision': 0.38462199443440886, 'recall': 0.35468588524850925, 'f1-score': 0.30858862496366307, 'support': 271067}, 'weighted avg': {'precision': 0.38900711501736546, 'recall': 0.33724134623543256, 'f1-score': 0.3029557199101127, 'support': 271067}}
[[16782 63604 10905]
 [12563 57457 11413]
 [10712 70455 17176]]
Evaluating performance on  train set...
211/211 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0698267
{'0': {'precision': 0.39765877522494975, 'recall': 0.2975357866527224, 'f1-score': 0.3403873476407687, 'support': 15299}, '1': {'precision': 0.48885932823412037, 'recall': 0.48643282594308407, 'f1-score': 0.48764305855034007, 'support': 24176}, '2': {'precision': 0.326506285218899, 'recall': 0.416045291355979, 'f1-score': 0.3658773527625987, 'support': 14484}, 'accuracy': 0.41398098556311275, 'macro avg': {'precision': 0.40434146289265643, 'recall': 0.4000046346505952, 'f1-score': 0.39796925298456914, 'support': 53959}, 'weighted avg': {'precision': 0.4194214451095301, 'recall': 0.41398098556311275, 'f1-score': 0.41320654927783357, 'support': 53959}}
[[ 4552  6285  4462]
 [ 4448 11760  7968]
 [ 2447  6011  6026]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0892469
{'0': {'precision': 0.4484467944481163, 'recall': 0.2963205590129927, 'f1-score': 0.35684701860495693, 'support': 18318}, '1': {'precision': 0.37633140905764695, 'recall': 0.5027153252959704, 'f1-score': 0.43043801729749837, 'support': 18414}, '2': {'precision': 0.38198991713507563, 'recall': 0.38265513438207466, 'f1-score': 0.3823222363994896, 'support': 17227}, 'accuracy': 0.39431790804129063, 'macro avg': {'precision': 0.402256040213613, 'recall': 0.39389700623034596, 'f1-score': 0.38986909076731496, 'support': 53959}, 'weighted avg': {'precision': 0.4026196788223291, 'recall': 0.39431790804129063, 'f1-score': 0.3900938583697945, 'support': 53959}}
[[5428 7889 5001]
 [3493 9257 5664]
 [3183 7452 6592]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0911452
{'0': {'precision': 0.44062250598563446, 'recall': 0.29749973057441537, 'f1-score': 0.35518528049408127, 'support': 18558}, '1': {'precision': 0.3611940298507463, 'recall': 0.5159914712153518, 'f1-score': 0.4249341527655839, 'support': 17822}, '2': {'precision': 0.39188427578433216, 'recall': 0.3559929461289038, 'f1-score': 0.37307738166209614, 'support': 17579}, 'accuracy': 0.3887210659945514, 'macro avg': {'precision': 0.39790027054023763, 'recall': 0.38982804930622367, 'f1-score': 0.38439893830725375, 'support': 53959}, 'weighted avg': {'precision': 0.39851009377664853, 'recall': 0.3887210659945514, 'f1-score': 0.3840514501424301, 'support': 53959}}
[[5521 8309 4728]
 [3643 9196 4983]
 [3366 7955 6258]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.094074
{'0': {'precision': 0.4227011939835633, 'recall': 0.29498971972730226, 'f1-score': 0.34748247291268325, 'support': 18482}, '1': {'precision': 0.35293209280778287, 'recall': 0.5099001617491216, 'f1-score': 0.4171381638985216, 'support': 17929}, '2': {'precision': 0.3844174693231297, 'recall': 0.3320606336904491, 'f1-score': 0.3563260563810922, 'support': 17548}, 'accuracy': 0.37845401137900997, 'macro avg': {'precision': 0.386683585371492, 'recall': 0.3789835050556243, 'f1-score': 0.3736488977307657, 'support': 53959}, 'weighted avg': {'precision': 0.3870687134831489, 'recall': 0.37845401137900997, 'f1-score': 0.3735030456881004, 'support': 53959}}
[[5452 8541 4489]
 [3945 9142 4842]
 [3501 8220 5827]]
Evaluating performance on  val set...
81/81 - 1s - 673ms/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0669843
{'0': {'precision': 0.39272616136919314, 'recall': 0.22208779813342552, 'f1-score': 0.2837270920733054, 'support': 5786}, '1': {'precision': 0.45909358446144793, 'recall': 0.5176991150442478, 'f1-score': 0.4866382447748779, 'support': 9040}, '2': {'precision': 0.36424487519174453, 'recall': 0.4494923421097918, 'f1-score': 0.4024033276844862, 'support': 5811}, 'accuracy': 0.4156127344090711, 'macro avg': {'precision': 0.4053548736741286, 'recall': 0.39642641842915505, 'f1-score': 0.39092288817755655, 'support': 20637}, 'weighted avg': {'precision': 0.41377848248063515, 'recall': 0.4156127344090711, 'f1-score': 0.4060289976583607, 'support': 20637}}
[[1285 2902 1599]
 [1400 4680 2960]
 [ 587 2612 2612]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0885496
{'0': {'precision': 0.45768025078369906, 'recall': 0.22913397060921672, 'f1-score': 0.30538125118843884, 'support': 7009}, '1': {'precision': 0.3404192208819458, 'recall': 0.5130382953360155, 'f1-score': 0.40927191679049035, 'support': 6711}, '2': {'precision': 0.4215854006273168, 'recall': 0.4274974700014457, 'f1-score': 0.4245208527743881, 'support': 6917}, 'accuracy': 0.387943984106217, 'macro avg': {'precision': 0.4065616240976539, 'recall': 0.38988991198222595, 'f1-score': 0.3797246735844391, 'support': 20637}, 'weighted avg': {'precision': 0.4074497497320752, 'recall': 0.387943984106217, 'f1-score': 0.37909830701173575, 'support': 20637}}
[[1606 3502 1901]
 [1112 3443 2156]
 [ 791 3169 2957]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.089151
{'0': {'precision': 0.46060769023931164, 'recall': 0.23921240050272308, 'f1-score': 0.31488970588235293, 'support': 7161}, '1': {'precision': 0.33287210911247284, 'recall': 0.5166436570026077, 'f1-score': 0.40488068762397067, 'support': 6519}, '2': {'precision': 0.42220588235294115, 'recall': 0.4126778783958603, 'f1-score': 0.4173875118121683, 'support': 6957}, 'accuracy': 0.38532732470804865, 'macro avg': {'precision': 0.4052285605682419, 'recall': 0.3895113119670637, 'f1-score': 0.379052635106164, 'support': 20637}, 'weighted avg': {'precision': 0.40731168641940846, 'recall': 0.38532732470804865, 'f1-score': 0.3778701994534791, 'support': 20637}}
[[1713 3557 1891]
 [1113 3368 2038]
 [ 893 3193 2871]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0945468
{'0': {'precision': 0.4496024621697871, 'recall': 0.242797783933518, 'f1-score': 0.3153161255508589, 'support': 7220}, '1': {'precision': 0.3211555643800258, 'recall': 0.5013172167983884, 'f1-score': 0.3915042962604381, 'support': 6453}, '2': {'precision': 0.4078019504876219, 'recall': 0.39029293509477314, 'f1-score': 0.39885538190622943, 'support': 6964}, 'accuracy': 0.3734069874497262, 'macro avg': {'precision': 0.39285332567914494, 'recall': 0.3781359786088932, 'f1-score': 0.3685586012391755, 'support': 20637}, 'weighted avg': {'precision': 0.395332626690215, 'recall': 0.3734069874497262, 'f1-score': 0.36732996704175946, 'support': 20637}}
[[1753 3589 1878]
 [1149 3235 2069]
 [ 997 3249 2718]]
training model: results/LILAK/W6/deepOF_L1/seq2seq
Epoch 1/50
211/211 - 9s - loss: 13.2329 - accuracy10: 0.3608 - accuracy20: 0.3593 - accuracy30: 0.3561 - accuracy50: 0.3486 - val_loss: 13.2228 - val_accuracy10: 0.3909 - val_accuracy20: 0.3570 - val_accuracy30: 0.3501 - val_accuracy50: 0.3434 - 9s/epoch - 43ms/step
Epoch 2/50
211/211 - 4s - loss: 13.1707 - accuracy10: 0.3722 - accuracy20: 0.3691 - accuracy30: 0.3618 - accuracy50: 0.3543 - val_loss: 13.1833 - val_accuracy10: 0.3858 - val_accuracy20: 0.3636 - val_accuracy30: 0.3562 - val_accuracy50: 0.3519 - 4s/epoch - 21ms/step
Epoch 3/50
211/211 - 4s - loss: 13.1322 - accuracy10: 0.3859 - accuracy20: 0.3759 - accuracy30: 0.3676 - accuracy50: 0.3600 - val_loss: 13.1596 - val_accuracy10: 0.3932 - val_accuracy20: 0.3692 - val_accuracy30: 0.3660 - val_accuracy50: 0.3607 - 4s/epoch - 21ms/step
Epoch 4/50
211/211 - 4s - loss: 13.1196 - accuracy10: 0.3954 - accuracy20: 0.3789 - accuracy30: 0.3711 - accuracy50: 0.3621 - val_loss: 13.1634 - val_accuracy10: 0.3981 - val_accuracy20: 0.3660 - val_accuracy30: 0.3571 - val_accuracy50: 0.3525 - 4s/epoch - 20ms/step
Epoch 5/50
211/211 - 4s - loss: 13.1018 - accuracy10: 0.4003 - accuracy20: 0.3814 - accuracy30: 0.3703 - accuracy50: 0.3620 - val_loss: 13.1577 - val_accuracy10: 0.3986 - val_accuracy20: 0.3653 - val_accuracy30: 0.3615 - val_accuracy50: 0.3512 - 4s/epoch - 21ms/step
Epoch 6/50
211/211 - 4s - loss: 13.0985 - accuracy10: 0.3980 - accuracy20: 0.3798 - accuracy30: 0.3698 - accuracy50: 0.3603 - val_loss: 13.1576 - val_accuracy10: 0.4060 - val_accuracy20: 0.3724 - val_accuracy30: 0.3644 - val_accuracy50: 0.3543 - 4s/epoch - 21ms/step
Epoch 7/50
211/211 - 4s - loss: 13.0878 - accuracy10: 0.4017 - accuracy20: 0.3834 - accuracy30: 0.3721 - accuracy50: 0.3635 - val_loss: 13.1581 - val_accuracy10: 0.4063 - val_accuracy20: 0.3683 - val_accuracy30: 0.3605 - val_accuracy50: 0.3549 - 4s/epoch - 21ms/step
Epoch 8/50
211/211 - 4s - loss: 13.0808 - accuracy10: 0.4055 - accuracy20: 0.3839 - accuracy30: 0.3719 - accuracy50: 0.3610 - val_loss: 13.1502 - val_accuracy10: 0.4114 - val_accuracy20: 0.3701 - val_accuracy30: 0.3637 - val_accuracy50: 0.3523 - 4s/epoch - 21ms/step
Epoch 9/50
211/211 - 4s - loss: 13.0648 - accuracy10: 0.4114 - accuracy20: 0.3889 - accuracy30: 0.3750 - accuracy50: 0.3657 - val_loss: 13.1449 - val_accuracy10: 0.4104 - val_accuracy20: 0.3755 - val_accuracy30: 0.3654 - val_accuracy50: 0.3561 - 4s/epoch - 21ms/step
Epoch 10/50
211/211 - 4s - loss: 13.0641 - accuracy10: 0.4105 - accuracy20: 0.3866 - accuracy30: 0.3748 - accuracy50: 0.3679 - val_loss: 13.1358 - val_accuracy10: 0.4098 - val_accuracy20: 0.3721 - val_accuracy30: 0.3681 - val_accuracy50: 0.3580 - 4s/epoch - 21ms/step
Epoch 11/50
211/211 - 4s - loss: 13.0502 - accuracy10: 0.4130 - accuracy20: 0.3894 - accuracy30: 0.3768 - accuracy50: 0.3693 - val_loss: 13.1284 - val_accuracy10: 0.4073 - val_accuracy20: 0.3758 - val_accuracy30: 0.3686 - val_accuracy50: 0.3580 - 4s/epoch - 21ms/step
Epoch 12/50
211/211 - 4s - loss: 13.0313 - accuracy10: 0.4189 - accuracy20: 0.3943 - accuracy30: 0.3822 - accuracy50: 0.3728 - val_loss: 13.1237 - val_accuracy10: 0.4127 - val_accuracy20: 0.3764 - val_accuracy30: 0.3695 - val_accuracy50: 0.3638 - 4s/epoch - 21ms/step
Epoch 13/50
211/211 - 4s - loss: 13.0176 - accuracy10: 0.4198 - accuracy20: 0.3969 - accuracy30: 0.3853 - accuracy50: 0.3747 - val_loss: 13.1243 - val_accuracy10: 0.4098 - val_accuracy20: 0.3771 - val_accuracy30: 0.3703 - val_accuracy50: 0.3632 - 4s/epoch - 20ms/step
Epoch 14/50
211/211 - 4s - loss: 13.0115 - accuracy10: 0.4210 - accuracy20: 0.3977 - accuracy30: 0.3850 - accuracy50: 0.3749 - val_loss: 13.1270 - val_accuracy10: 0.4083 - val_accuracy20: 0.3744 - val_accuracy30: 0.3714 - val_accuracy50: 0.3605 - 4s/epoch - 21ms/step
Epoch 15/50
211/211 - 4s - loss: 13.0024 - accuracy10: 0.4230 - accuracy20: 0.4002 - accuracy30: 0.3876 - accuracy50: 0.3749 - val_loss: 13.1181 - val_accuracy10: 0.4149 - val_accuracy20: 0.3767 - val_accuracy30: 0.3717 - val_accuracy50: 0.3659 - 4s/epoch - 21ms/step
Epoch 16/50
211/211 - 5s - loss: 12.9985 - accuracy10: 0.4220 - accuracy20: 0.3997 - accuracy30: 0.3884 - accuracy50: 0.3779 - val_loss: 13.1113 - val_accuracy10: 0.4122 - val_accuracy20: 0.3812 - val_accuracy30: 0.3744 - val_accuracy50: 0.3654 - 5s/epoch - 21ms/step
Epoch 17/50
211/211 - 4s - loss: 12.9665 - accuracy10: 0.4257 - accuracy20: 0.4054 - accuracy30: 0.3940 - accuracy50: 0.3803 - val_loss: 13.1258 - val_accuracy10: 0.4151 - val_accuracy20: 0.3798 - val_accuracy30: 0.3747 - val_accuracy50: 0.3619 - 4s/epoch - 21ms/step
Epoch 18/50
211/211 - 4s - loss: 12.9624 - accuracy10: 0.4271 - accuracy20: 0.4073 - accuracy30: 0.3963 - accuracy50: 0.3813 - val_loss: 13.1254 - val_accuracy10: 0.4102 - val_accuracy20: 0.3822 - val_accuracy30: 0.3748 - val_accuracy50: 0.3676 - 4s/epoch - 21ms/step
Epoch 19/50
211/211 - 4s - loss: 12.9649 - accuracy10: 0.4273 - accuracy20: 0.4073 - accuracy30: 0.3952 - accuracy50: 0.3804 - val_loss: 13.1095 - val_accuracy10: 0.4107 - val_accuracy20: 0.3833 - val_accuracy30: 0.3778 - val_accuracy50: 0.3685 - 4s/epoch - 21ms/step
Epoch 20/50
211/211 - 4s - loss: 12.9304 - accuracy10: 0.4305 - accuracy20: 0.4128 - accuracy30: 0.4007 - accuracy50: 0.3886 - val_loss: 13.1144 - val_accuracy10: 0.4078 - val_accuracy20: 0.3854 - val_accuracy30: 0.3802 - val_accuracy50: 0.3672 - 4s/epoch - 21ms/step
Epoch 21/50
211/211 - 4s - loss: 12.9230 - accuracy10: 0.4329 - accuracy20: 0.4156 - accuracy30: 0.4018 - accuracy50: 0.3879 - val_loss: 13.1290 - val_accuracy10: 0.4136 - val_accuracy20: 0.3856 - val_accuracy30: 0.3778 - val_accuracy50: 0.3713 - 4s/epoch - 21ms/step
Epoch 22/50
211/211 - 4s - loss: 12.9310 - accuracy10: 0.4295 - accuracy20: 0.4117 - accuracy30: 0.4016 - accuracy50: 0.3873 - val_loss: 13.1567 - val_accuracy10: 0.4174 - val_accuracy20: 0.3822 - val_accuracy30: 0.3741 - val_accuracy50: 0.3682 - 4s/epoch - 21ms/step
Epoch 23/50
211/211 - 4s - loss: 12.9031 - accuracy10: 0.4378 - accuracy20: 0.4207 - accuracy30: 0.4079 - accuracy50: 0.3932 - val_loss: 13.1404 - val_accuracy10: 0.4148 - val_accuracy20: 0.3857 - val_accuracy30: 0.3808 - val_accuracy50: 0.3726 - 4s/epoch - 21ms/step
Epoch 24/50
211/211 - 4s - loss: 12.8864 - accuracy10: 0.4338 - accuracy20: 0.4191 - accuracy30: 0.4099 - accuracy50: 0.3955 - val_loss: 13.1908 - val_accuracy10: 0.4189 - val_accuracy20: 0.3817 - val_accuracy30: 0.3754 - val_accuracy50: 0.3666 - 4s/epoch - 21ms/step
Epoch 25/50
211/211 - 5s - loss: 12.8628 - accuracy10: 0.4344 - accuracy20: 0.4231 - accuracy30: 0.4128 - accuracy50: 0.3975 - val_loss: 13.2051 - val_accuracy10: 0.4124 - val_accuracy20: 0.3828 - val_accuracy30: 0.3736 - val_accuracy50: 0.3658 - 5s/epoch - 21ms/step
Epoch 26/50
211/211 - 4s - loss: 12.8510 - accuracy10: 0.4361 - accuracy20: 0.4256 - accuracy30: 0.4139 - accuracy50: 0.3997 - val_loss: 13.1958 - val_accuracy10: 0.4168 - val_accuracy20: 0.3884 - val_accuracy30: 0.3787 - val_accuracy50: 0.3682 - 4s/epoch - 21ms/step
Epoch 27/50
211/211 - 4s - loss: 12.8643 - accuracy10: 0.4376 - accuracy20: 0.4261 - accuracy30: 0.4124 - accuracy50: 0.3963 - val_loss: 13.1959 - val_accuracy10: 0.4172 - val_accuracy20: 0.3852 - val_accuracy30: 0.3805 - val_accuracy50: 0.3678 - 4s/epoch - 21ms/step
Epoch 28/50
211/211 - 4s - loss: 12.8387 - accuracy10: 0.4392 - accuracy20: 0.4298 - accuracy30: 0.4193 - accuracy50: 0.4009 - val_loss: 13.2110 - val_accuracy10: 0.4171 - val_accuracy20: 0.3868 - val_accuracy30: 0.3819 - val_accuracy50: 0.3712 - 4s/epoch - 21ms/step
Epoch 29/50
211/211 - 4s - loss: 12.8183 - accuracy10: 0.4405 - accuracy20: 0.4317 - accuracy30: 0.4202 - accuracy50: 0.4021 - val_loss: 13.2111 - val_accuracy10: 0.4123 - val_accuracy20: 0.3858 - val_accuracy30: 0.3830 - val_accuracy50: 0.3716 - 4s/epoch - 20ms/step
testing model: results/LILAK/W6/deepOF_L1/seq2seq
Evaluating performance on  test set...
1059/1059 - 11s - 11s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0960348
{'0': {'precision': 0.350608920877643, 'recall': 0.34021677400645245, 'f1-score': 0.3453346824885782, 'support': 82759}, '1': {'precision': 0.43640935995338426, 'recall': 0.42440450153099774, 'f1-score': 0.4303232212248437, 'support': 100588}, '2': {'precision': 0.3682466239845053, 'recall': 0.3901613179045773, 'f1-score': 0.37888735123166345, 'support': 87715}, 'accuracy': 0.38761980653872546, 'macro avg': {'precision': 0.38508830160517754, 'recall': 0.3849275311473425, 'f1-score': 0.3848484183150285, 'support': 271062}, 'weighted avg': {'precision': 0.3881559975382191, 'recall': 0.38761980653872546, 'f1-score': 0.38773051618420207, 'support': 271062}}
[[28156 27523 27080]
 [26266 42690 31632]
 [25884 27608 34223]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0957849
{'0': {'precision': 0.3937513965379004, 'recall': 0.3097995822043889, 'f1-score': 0.3467666788209215, 'support': 96698}, '1': {'precision': 0.31411189135615025, 'recall': 0.41478934031355297, 'f1-score': 0.3574977199635195, 'support': 71822}, '2': {'precision': 0.41607166039205506, 'recall': 0.40632131224278834, 'f1-score': 0.4111386859153054, 'support': 102542}, 'accuracy': 0.3741321173753606, 'macro avg': {'precision': 0.3746449827620353, 'recall': 0.3769700782535767, 'f1-score': 0.37180102823324884, 'support': 271062}, 'weighted avg': {'precision': 0.3810933919299844, 'recall': 0.3741321173753606, 'f1-score': 0.37396178248139766, 'support': 271062}}
[[29957 32742 33999]
 [17556 29791 24475]
 [28568 32309 41665]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0991185
{'0': {'precision': 0.380568403531033, 'recall': 0.2953077688610329, 'f1-score': 0.3325603438511568, 'support': 94454}, '1': {'precision': 0.3112727434001175, 'recall': 0.3693947368421053, 'f1-score': 0.3378522302651768, 'support': 76000}, '2': {'precision': 0.40500845897860155, 'recall': 0.43306695292620867, 'f1-score': 0.4185680112975897, 'support': 100608}, 'accuracy': 0.36721119153551585, 'macro avg': {'precision': 0.3656165353032507, 'recall': 0.365923152876449, 'f1-score': 0.3629935284713078, 'support': 271062}, 'weighted avg': {'precision': 0.37021060689601737, 'recall': 0.36721119153551585, 'f1-score': 0.36596688100470925, 'support': 271062}}
[[27893 31346 35215]
 [19133 28074 28793]
 [26267 30771 43570]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1011096
{'0': {'precision': 0.36848271821909784, 'recall': 0.2893886448531586, 'f1-score': 0.32418104955731575, 'support': 91289}, '1': {'precision': 0.30885009030704397, 'recall': 0.32129436325678495, 'f1-score': 0.31494935025069065, 'support': 81430}, '2': {'precision': 0.3923354003680543, 'recall': 0.45741944012283536, 'f1-score': 0.42238497652582163, 'support': 98343}, 'accuracy': 0.35993610317934643, 'macro avg': {'precision': 0.35655606963139874, 'recall': 0.3560341494109263, 'f1-score': 0.3538384587779427, 'support': 271062}, 'weighted avg': {'precision': 0.3592223255033955, 'recall': 0.35993610317934643, 'f1-score': 0.35703674867901225, 'support': 271062}}
[[26418 29474 35397]
 [20991 26163 34276]
 [24285 29074 44984]]
Evaluating performance on  train set...
211/211 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0676596
{'0': {'precision': 0.37924628450106157, 'recall': 0.28137306379627197, 'f1-score': 0.32305953278070837, 'support': 15236}, '1': {'precision': 0.5289608510305448, 'recall': 0.5566530847429724, 'f1-score': 0.5424537761200016, 'support': 24297}, '2': {'precision': 0.33471848296851225, 'recall': 0.3964369887702759, 'f1-score': 0.36297283574511297, 'support': 14426}, 'accuracy': 0.4360903649066884, 'macro avg': {'precision': 0.4143085395000396, 'recall': 0.4114877124365068, 'f1-score': 0.4094953815486076, 'support': 53959}, 'weighted avg': {'precision': 0.4347561486211953, 'recall': 0.4360903649066884, 'f1-score': 0.4325206280378352, 'support': 53959}}
[[ 4287  6242  4707]
 [ 4112 13525  6660]
 [ 2905  5802  5719]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0796367
{'0': {'precision': 0.4340161981896141, 'recall': 0.2490023506259225, 'f1-score': 0.31645129915242465, 'support': 18293}, '1': {'precision': 0.4081990049751244, 'recall': 0.5567861020629751, 'f1-score': 0.4710529337466989, 'support': 18420}, '2': {'precision': 0.3792464147445335, 'recall': 0.40328192044532063, 'f1-score': 0.3908950400449628, 'support': 17246}, 'accuracy': 0.403380344335514, 'macro avg': {'precision': 0.40715387263642405, 'recall': 0.4030234577114061, 'f1-score': 0.3927997576480287, 'support': 53959}, 'weighted avg': {'precision': 0.40769783824401173, 'recall': 0.403380344335514, 'f1-score': 0.39302089578429783, 'support': 53959}}
[[ 4555  7701  6037]
 [ 2817 10256  5347]
 [ 3123  7168  6955]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0863868
{'0': {'precision': 0.4316265060240964, 'recall': 0.23175202156334232, 'f1-score': 0.30157839354612415, 'support': 18550}, '1': {'precision': 0.38275918770040285, 'recall': 0.5218877865590493, 'f1-score': 0.4416249673915621, 'support': 17841}, '2': {'precision': 0.37650587099069793, 'recall': 0.42161885245901637, 'f1-score': 0.3977873848715126, 'support': 17568}, 'accuracy': 0.38949943475601845, 'macro avg': {'precision': 0.39696385490506575, 'recall': 0.39175288686046933, 'f1-score': 0.38033024860306625, 'support': 53959}, 'weighted avg': {'precision': 0.3975228135449963, 'recall': 0.38949943475601845, 'f1-score': 0.3792071576740895, 'support': 53959}}
[[4299 7803 6448]
 [2712 9311 5818]
 [2949 7212 7407]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0917118
{'0': {'precision': 0.425531914893617, 'recall': 0.22405022188548543, 'f1-score': 0.2935441557060304, 'support': 18478}, '1': {'precision': 0.3681804459395351, 'recall': 0.47599665458600504, 'f1-score': 0.4152035406838189, 'support': 17935}, '2': {'precision': 0.36929145083875875, 'recall': 0.44289296705801895, 'f1-score': 0.4027572624322994, 'support': 17546}, 'accuracy': 0.37895439129709596, 'macro avg': {'precision': 0.38766793722397025, 'recall': 0.38097994784316985, 'f1-score': 0.3705016529407162, 'support': 53959}, 'weighted avg': {'precision': 0.38818144920674363, 'recall': 0.37895439129709596, 'f1-score': 0.36949467814335785, 'support': 53959}}
[[4140 7602 6736]
 [2862 8537 6536]
 [2727 7048 7771]]
Evaluating performance on  val set...
81/81 - 1s - 664ms/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0824983
{'0': {'precision': 0.34481344813448134, 'recall': 0.2888545423321312, 'f1-score': 0.31436314363143636, 'support': 5823}, '1': {'precision': 0.5020865363496596, 'recall': 0.5085085085085085, 'f1-score': 0.5052771177543238, 'support': 8991}, '2': {'precision': 0.3356885147324113, 'recall': 0.3835451734799038, 'f1-score': 0.35802469135802467, 'support': 5822}, 'accuracy': 0.4112715642566389, 'macro avg': {'precision': 0.3941961664055174, 'recall': 0.39363607477351453, 'f1-score': 0.3925549842479283, 'support': 20636}, 'weighted avg': {'precision': 0.4107621287836292, 'recall': 0.4112715642566389, 'f1-score': 0.40986154798320407, 'support': 20636}}
[[1682 2326 1815]
 [1815 4572 2604]
 [1381 2208 2233]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0896891
{'0': {'precision': 0.39584235599826767, 'recall': 0.2595853450724226, 'f1-score': 0.31355060034305315, 'support': 7042}, '1': {'precision': 0.37064034989346195, 'recall': 0.4983413751507841, 'f1-score': 0.4251077239693872, 'support': 6632}, '2': {'precision': 0.39205745669624, 'recall': 0.39988509049123816, 'f1-score': 0.3959325890635, 'support': 6962}, 'accuracy': 0.38364993215739485, 'macro avg': {'precision': 0.3861800541959899, 'recall': 0.3859372702381483, 'f1-score': 0.3781969711253134, 'support': 20636}, 'weighted avg': {'precision': 0.38646601497152855, 'recall': 0.38364993215739485, 'f1-score': 0.3771961832739311, 'support': 20636}}
[[1828 2937 2277]
 [1287 3305 2040]
 [1503 2675 2784]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0924369
{'0': {'precision': 0.3982782057091074, 'recall': 0.2449150181108944, 'f1-score': 0.3033126293995859, 'support': 7178}, '1': {'precision': 0.347297766462215, 'recall': 0.46570453134698947, 'f1-score': 0.3978786874378522, 'support': 6444}, '2': {'precision': 0.394275161588181, 'recall': 0.42614770459081835, 'f1-score': 0.40959232613908875, 'support': 7014}, 'accuracy': 0.3754603605349874, 'macro avg': {'precision': 0.3799503779198345, 'recall': 0.37892241801623405, 'f1-score': 0.370261214325509, 'support': 20636}, 'weighted avg': {'precision': 0.380997952657588, 'recall': 0.3754603605349874, 'f1-score': 0.3689663157210368, 'support': 20636}}
[[1758 2994 2426]
 [1277 3001 2166]
 [1379 2646 2989]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0963027
{'0': {'precision': 0.395632183908046, 'recall': 0.23829963998892273, 'f1-score': 0.29744210162461115, 'support': 7222}, '1': {'precision': 0.33041042503958107, 'recall': 0.42146962870902593, 'f1-score': 0.3704259967231021, 'support': 6437}, '2': {'precision': 0.38613003095975235, 'recall': 0.4468969471119392, 'f1-score': 0.41429710337496684, 'support': 6977}, 'accuracy': 0.3659623958131421, 'macro avg': {'precision': 0.3707242133024598, 'recall': 0.36888873860329596, 'f1-score': 0.36072173390756007, 'support': 20636}, 'weighted avg': {'precision': 0.3720748577325976, 'recall': 0.3659623958131421, 'f1-score': 0.3597165094537068, 'support': 20636}}
[[1721 2941 2560]
 [1327 2713 2397]
 [1302 2557 3118]]
training model: results/LILAK/W6/deepLOB_L2/seq2seq
Epoch 1/50
211/211 - 16s - loss: 13.3065 - accuracy10: 0.3520 - accuracy20: 0.3522 - accuracy30: 0.3501 - accuracy50: 0.3470 - val_loss: 13.3905 - val_accuracy10: 0.3835 - val_accuracy20: 0.3376 - val_accuracy30: 0.3353 - val_accuracy50: 0.3303 - 16s/epoch - 76ms/step
Epoch 2/50
211/211 - 10s - loss: 13.1756 - accuracy10: 0.3681 - accuracy20: 0.3694 - accuracy30: 0.3649 - accuracy50: 0.3583 - val_loss: 13.3953 - val_accuracy10: 0.4113 - val_accuracy20: 0.3404 - val_accuracy30: 0.3407 - val_accuracy50: 0.3383 - 10s/epoch - 49ms/step
Epoch 3/50
211/211 - 10s - loss: 13.0875 - accuracy10: 0.3841 - accuracy20: 0.3860 - accuracy30: 0.3801 - accuracy50: 0.3716 - val_loss: 13.2183 - val_accuracy10: 0.3967 - val_accuracy20: 0.3625 - val_accuracy30: 0.3635 - val_accuracy50: 0.3582 - 10s/epoch - 49ms/step
Epoch 4/50
211/211 - 10s - loss: 12.9996 - accuracy10: 0.3995 - accuracy20: 0.4028 - accuracy30: 0.3977 - accuracy50: 0.3857 - val_loss: 13.3078 - val_accuracy10: 0.3953 - val_accuracy20: 0.3631 - val_accuracy30: 0.3601 - val_accuracy50: 0.3527 - 10s/epoch - 49ms/step
Epoch 5/50
211/211 - 10s - loss: 12.9276 - accuracy10: 0.4125 - accuracy20: 0.4141 - accuracy30: 0.4094 - accuracy50: 0.3953 - val_loss: 13.4184 - val_accuracy10: 0.4009 - val_accuracy20: 0.3703 - val_accuracy30: 0.3659 - val_accuracy50: 0.3598 - 10s/epoch - 49ms/step
Epoch 6/50
211/211 - 10s - loss: 12.8612 - accuracy10: 0.4179 - accuracy20: 0.4231 - accuracy30: 0.4176 - accuracy50: 0.4023 - val_loss: 13.5018 - val_accuracy10: 0.4196 - val_accuracy20: 0.3650 - val_accuracy30: 0.3632 - val_accuracy50: 0.3525 - 10s/epoch - 49ms/step
Epoch 7/50
211/211 - 10s - loss: 12.7823 - accuracy10: 0.4260 - accuracy20: 0.4329 - accuracy30: 0.4255 - accuracy50: 0.4087 - val_loss: 13.6488 - val_accuracy10: 0.4168 - val_accuracy20: 0.3726 - val_accuracy30: 0.3640 - val_accuracy50: 0.3544 - 10s/epoch - 49ms/step
Epoch 8/50
211/211 - 10s - loss: 12.7373 - accuracy10: 0.4335 - accuracy20: 0.4386 - accuracy30: 0.4307 - accuracy50: 0.4119 - val_loss: 13.6241 - val_accuracy10: 0.4088 - val_accuracy20: 0.3787 - val_accuracy30: 0.3700 - val_accuracy50: 0.3603 - 10s/epoch - 49ms/step
Epoch 9/50
211/211 - 10s - loss: 12.6609 - accuracy10: 0.4411 - accuracy20: 0.4480 - accuracy30: 0.4383 - accuracy50: 0.4218 - val_loss: 13.7856 - val_accuracy10: 0.4084 - val_accuracy20: 0.3753 - val_accuracy30: 0.3698 - val_accuracy50: 0.3587 - 10s/epoch - 49ms/step
Epoch 10/50
211/211 - 10s - loss: 12.6091 - accuracy10: 0.4503 - accuracy20: 0.4545 - accuracy30: 0.4447 - accuracy50: 0.4246 - val_loss: 13.6583 - val_accuracy10: 0.4135 - val_accuracy20: 0.3788 - val_accuracy30: 0.3715 - val_accuracy50: 0.3580 - 10s/epoch - 49ms/step
Epoch 11/50
211/211 - 10s - loss: 12.5661 - accuracy10: 0.4525 - accuracy20: 0.4588 - accuracy30: 0.4497 - accuracy50: 0.4295 - val_loss: 13.7712 - val_accuracy10: 0.4063 - val_accuracy20: 0.3808 - val_accuracy30: 0.3748 - val_accuracy50: 0.3666 - 10s/epoch - 49ms/step
Epoch 12/50
211/211 - 10s - loss: 12.4896 - accuracy10: 0.4619 - accuracy20: 0.4654 - accuracy30: 0.4562 - accuracy50: 0.4339 - val_loss: 13.9186 - val_accuracy10: 0.3979 - val_accuracy20: 0.3804 - val_accuracy30: 0.3751 - val_accuracy50: 0.3665 - 10s/epoch - 49ms/step
Epoch 13/50
211/211 - 11s - loss: 12.4324 - accuracy10: 0.4659 - accuracy20: 0.4724 - accuracy30: 0.4635 - accuracy50: 0.4402 - val_loss: 13.9041 - val_accuracy10: 0.3910 - val_accuracy20: 0.3820 - val_accuracy30: 0.3744 - val_accuracy50: 0.3656 - 11s/epoch - 50ms/step
testing model: results/LILAK/W6/deepLOB_L2/seq2seq
Evaluating performance on  test set...
1059/1059 - 18s - 18s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1024895
{'0': {'precision': 0.33040873668027354, 'recall': 0.15061623972933785, 'f1-score': 0.20691200637418455, 'support': 82760}, '1': {'precision': 0.3828745804089106, 'recall': 0.6236542036563907, 'f1-score': 0.4744650035357603, 'support': 100591}, '2': {'precision': 0.3410369688161057, 'recall': 0.2701787587213279, 'f1-score': 0.3015005693130713, 'support': 87716}, 'accuracy': 0.36484706733021727, 'macro avg': {'precision': 0.3514400953017633, 'recall': 0.34814973403568555, 'f1-score': 0.3276258597410054, 'support': 271067}, 'weighted avg': {'precision': 0.35331767689259735, 'recall': 0.36484706733021727, 'f1-score': 0.33680739727100145, 'support': 271067}}
[[12465 49521 20774]
 [12839 62734 25018]
 [12422 51595 23699]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1210351
{'0': {'precision': 0.3816509057764612, 'recall': 0.13856256463288522, 'f1-score': 0.2033108764263171, 'support': 96700}, '1': {'precision': 0.27587627064703935, 'recall': 0.6155324125640455, 'f1-score': 0.3809942389810278, 'support': 71824}, '2': {'precision': 0.39526589702269305, 'recall': 0.29181904176784373, 'f1-score': 0.3357550392989582, 'support': 102543}, 'accuracy': 0.32292016364957743, 'macro avg': {'precision': 0.35093102448206454, 'recall': 0.3486380063215915, 'f1-score': 0.30668671823543436, 'support': 271067}, 'weighted avg': {'precision': 0.3587745123159026, 'recall': 0.32292016364957743, 'f1-score': 0.30049405116016065, 'support': 271067}}
[[13399 56787 26514]
 [ 8346 44210 19268]
 [13363 59256 29924]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1150527
{'0': {'precision': 0.3682454969979987, 'recall': 0.14025578046921316, 'f1-score': 0.20314033366045142, 'support': 94456}, '1': {'precision': 0.2938404251192739, 'recall': 0.5980500513144391, 'f1-score': 0.39406471077819394, 'support': 76002}, '2': {'precision': 0.38977675517691684, 'recall': 0.3115029470524506, 'f1-score': 0.3462715591059255, 'support': 100609}, 'accuracy': 0.3321724887205008, 'macro avg': {'precision': 0.3506208924313965, 'recall': 0.3499362596120343, 'f1-score': 0.31449220118152366, 'support': 271067}, 'weighted avg': {'precision': 0.3553752622633978, 'recall': 0.3321724887205008, 'f1-score': 0.3097963411071209, 'support': 271067}}
[[13248 53390 27818]
 [ 9302 45453 21247]
 [13426 55843 31340]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.109923
{'0': {'precision': 0.35260146373918827, 'recall': 0.14512931176129082, 'f1-score': 0.20562444710008848, 'support': 91291}, '1': {'precision': 0.3134744966579031, 'recall': 0.5695725320201884, 'f1-score': 0.4043872115225333, 'support': 81433}, '2': {'precision': 0.381931697279349, 'recall': 0.33217412525548334, 'f1-score': 0.3553194035045738, 'support': 98343}, 'accuracy': 0.34049884345936615, 'macro avg': {'precision': 0.34933588589214676, 'recall': 0.3489586563456542, 'f1-score': 0.3217770207090652, 'support': 271067}, 'weighted avg': {'precision': 0.3514880742329397, 'recall': 0.34049884345936615, 'f1-score': 0.3196453323162869, 'support': 271067}}
[[13249 49471 28571]
 [10758 46382 24293]
 [13568 52108 32667]]
Evaluating performance on  train set...
211/211 - 4s - 4s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0736277
{'0': {'precision': 0.34339948231233824, 'recall': 0.1821034054513367, 'f1-score': 0.23799760806424056, 'support': 15299}, '1': {'precision': 0.49170943545203316, 'recall': 0.6182164129715421, 'f1-score': 0.5477534266656894, 'support': 24176}, '2': {'precision': 0.32297734627831715, 'recall': 0.3445180889257111, 'f1-score': 0.3334001469900447, 'support': 14484}, 'accuracy': 0.4210974999536685, 'macro avg': {'precision': 0.3860287546808962, 'recall': 0.3816126357828633, 'f1-score': 0.37305039390665823, 'support': 53959}, 'weighted avg': {'precision': 0.4043670170848229, 'recall': 0.4210974999536685, 'f1-score': 0.4023903329907584, 'support': 53959}}
[[ 2786  8182  4331]
 [ 3101 14946  6129]
 [ 2226  7268  4990]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.093496
{'0': {'precision': 0.39692531170560463, 'recall': 0.17900425810678022, 'f1-score': 0.24673614507694044, 'support': 18318}, '1': {'precision': 0.3846721696530434, 'recall': 0.6225697838601064, 'f1-score': 0.4755267960842874, 'support': 18414}, '2': {'precision': 0.3746854554604932, 'recall': 0.3457363441109886, 'f1-score': 0.3596292606346043, 'support': 17227}, 'accuracy': 0.38360607127633944, 'macro avg': {'precision': 0.3854276456063804, 'recall': 0.38243679535929176, 'f1-score': 0.36063073393194406, 'support': 53959}, 'weighted avg': {'precision': 0.3856434984531278, 'recall': 0.38360607127633944, 'f1-score': 0.36085539764576424, 'support': 53959}}
[[ 3279  9755  5284]
 [ 2294 11464  4656]
 [ 2688  8583  5956]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0964671
{'0': {'precision': 0.3928185420919899, 'recall': 0.17625821748033194, 'f1-score': 0.2433327134089641, 'support': 18558}, '1': {'precision': 0.36863252519749384, 'recall': 0.6074514644821007, 'f1-score': 0.4588260224623861, 'support': 17822}, '2': {'precision': 0.37764387604525335, 'recall': 0.3493941634905285, 'f1-score': 0.3629701858582277, 'support': 17579}, 'accuracy': 0.3750810800793195, 'macro avg': {'precision': 0.37969831444491237, 'recall': 0.3777012818176537, 'f1-score': 0.3550429739098593, 'support': 53959}, 'weighted avg': {'precision': 0.3798865261626863, 'recall': 0.3750810800793195, 'f1-score': 0.35348354797105186, 'support': 53959}}
[[ 3271  9870  5417]
 [ 2291 10826  4705]
 [ 2765  8672  6142]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0998195
{'0': {'precision': 0.3826313298627544, 'recall': 0.17498106265555677, 'f1-score': 0.24014257072844733, 'support': 18482}, '1': {'precision': 0.36326431519439534, 'recall': 0.5841932065368955, 'f1-score': 0.4479705743980156, 'support': 17929}, '2': {'precision': 0.36739834472831956, 'recall': 0.349099612491452, 'f1-score': 0.3580153117877388, 'support': 17548}, 'accuracy': 0.3675753813080302, 'macro avg': {'precision': 0.3710979965951564, 'recall': 0.36942462722796815, 'f1-score': 0.34870948563806725, 'support': 53959}, 'weighted avg': {'precision': 0.3712423191485441, 'recall': 0.3675753813080302, 'f1-score': 0.34753112755678245, 'support': 53959}}
[[ 3234  9737  5511]
 [ 2418 10474  5037]
 [ 2800  8622  6126]]
Evaluating performance on  val set...
81/81 - 1s - 1s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0860236
{'0': {'precision': 0.3252126836813612, 'recall': 0.14535084687175942, 'f1-score': 0.2009077878643096, 'support': 5786}, '1': {'precision': 0.45561762880198636, 'recall': 0.5683628318584071, 'f1-score': 0.5057833341536644, 'support': 9040}, '2': {'precision': 0.3224092116917626, 'recall': 0.37583892617449666, 'f1-score': 0.3470798569725864, 'support': 5811}, 'accuracy': 0.39555167902311383, 'macro avg': {'precision': 0.3677465080583701, 'recall': 0.3631842016348877, 'f1-score': 0.3512569929968535, 'support': 20637}, 'weighted avg': {'precision': 0.3815469245186386, 'recall': 0.39555167902311383, 'f1-score': 0.37561733053252516, 'support': 20637}}
[[ 841 3158 1787]
 [1099 5138 2803]
 [ 646 2981 2184]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1010283
{'0': {'precision': 0.3936617029400535, 'recall': 0.14709659009844486, 'f1-score': 0.21416701287910264, 'support': 7009}, '1': {'precision': 0.34520749173705473, 'recall': 0.5602741767247802, 'f1-score': 0.4271999091064023, 'support': 6711}, '2': {'precision': 0.37692955374684256, 'recall': 0.3883186352464941, 'f1-score': 0.3825393434451328, 'support': 6917}, 'accuracy': 0.3623104133352716, 'macro avg': {'precision': 0.3719329161413169, 'recall': 0.3652298006899064, 'f1-score': 0.3413020884768792, 'support': 20637}, 'weighted avg': {'precision': 0.3722965584252129, 'recall': 0.3623104133352716, 'f1-score': 0.33987788059760043, 'support': 20637}}
[[1031 3670 2308]
 [ 819 3760 2132]
 [ 769 3462 2686]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1006466
{'0': {'precision': 0.40622763063707945, 'recall': 0.1584974165619327, 'f1-score': 0.22802611752887997, 'support': 7161}, '1': {'precision': 0.33877901977644026, 'recall': 0.543948458352508, 'f1-score': 0.4175203108442247, 'support': 6519}, '2': {'precision': 0.3794739696312364, 'recall': 0.4023285899094437, 'f1-score': 0.39056722249354636, 'support': 6957}, 'accuracy': 0.36245578330183653, 'macro avg': {'precision': 0.37482687334825204, 'recall': 0.3682581549412948, 'f1-score': 0.34537121695555034, 'support': 20637}, 'weighted avg': {'precision': 0.3759023549759777, 'recall': 0.36245578330183653, 'f1-score': 0.34267994867981844, 'support': 20637}}
[[1135 3600 2426]
 [ 822 3546 2151]
 [ 837 3321 2799]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1012208
{'0': {'precision': 0.3983361064891847, 'recall': 0.16578947368421051, 'f1-score': 0.2341320293398533, 'support': 7220}, '1': {'precision': 0.32922268270494287, 'recall': 0.5047264838059817, 'f1-score': 0.39850728006851827, 'support': 6453}, '2': {'precision': 0.3745962010595684, 'recall': 0.41628374497415277, 'f1-score': 0.394341290893015, 'support': 6964}, 'accuracy': 0.35630178805058876, 'macro avg': {'precision': 0.367384996751232, 'recall': 0.362266567488115, 'f1-score': 0.34232686676712887, 'support': 20637}, 'weighted avg': {'precision': 0.3687138927424405, 'recall': 0.35630178805058876, 'f1-score': 0.33959361728423926, 'support': 20637}}
[[1197 3476 2547]
 [ 903 3257 2293]
 [ 905 3160 2899]]
training model: results/LILAK/W6/deepOF_L2/seq2seq
Epoch 1/50
211/211 - 12s - loss: 13.2147 - accuracy10: 0.3813 - accuracy20: 0.3741 - accuracy30: 0.3662 - accuracy50: 0.3516 - val_loss: 13.1679 - val_accuracy10: 0.4025 - val_accuracy20: 0.3808 - val_accuracy30: 0.3726 - val_accuracy50: 0.3539 - 12s/epoch - 56ms/step
Epoch 2/50
211/211 - 6s - loss: 13.0611 - accuracy10: 0.4100 - accuracy20: 0.3983 - accuracy30: 0.3884 - accuracy50: 0.3672 - val_loss: 13.0854 - val_accuracy10: 0.4172 - val_accuracy20: 0.3958 - val_accuracy30: 0.3813 - val_accuracy50: 0.3641 - 6s/epoch - 30ms/step
Epoch 3/50
211/211 - 6s - loss: 12.9606 - accuracy10: 0.4247 - accuracy20: 0.4134 - accuracy30: 0.4007 - accuracy50: 0.3780 - val_loss: 13.0109 - val_accuracy10: 0.4266 - val_accuracy20: 0.4117 - val_accuracy30: 0.3951 - val_accuracy50: 0.3716 - 6s/epoch - 30ms/step
Epoch 4/50
211/211 - 6s - loss: 12.8876 - accuracy10: 0.4320 - accuracy20: 0.4235 - accuracy30: 0.4071 - accuracy50: 0.3870 - val_loss: 12.9695 - val_accuracy10: 0.4306 - val_accuracy20: 0.4157 - val_accuracy30: 0.4035 - val_accuracy50: 0.3827 - 6s/epoch - 30ms/step
Epoch 5/50
211/211 - 6s - loss: 12.8213 - accuracy10: 0.4406 - accuracy20: 0.4328 - accuracy30: 0.4161 - accuracy50: 0.3944 - val_loss: 12.9378 - val_accuracy10: 0.4350 - val_accuracy20: 0.4197 - val_accuracy30: 0.4052 - val_accuracy50: 0.3857 - 6s/epoch - 30ms/step
Epoch 6/50
211/211 - 6s - loss: 12.7647 - accuracy10: 0.4510 - accuracy20: 0.4385 - accuracy30: 0.4208 - accuracy50: 0.3994 - val_loss: 12.9193 - val_accuracy10: 0.4397 - val_accuracy20: 0.4239 - val_accuracy30: 0.4104 - val_accuracy50: 0.3894 - 6s/epoch - 29ms/step
Epoch 7/50
211/211 - 6s - loss: 12.7050 - accuracy10: 0.4567 - accuracy20: 0.4483 - accuracy30: 0.4293 - accuracy50: 0.4052 - val_loss: 12.9034 - val_accuracy10: 0.4430 - val_accuracy20: 0.4269 - val_accuracy30: 0.4140 - val_accuracy50: 0.3898 - 6s/epoch - 29ms/step
Epoch 8/50
211/211 - 6s - loss: 12.6409 - accuracy10: 0.4664 - accuracy20: 0.4550 - accuracy30: 0.4360 - accuracy50: 0.4098 - val_loss: 12.9091 - val_accuracy10: 0.4450 - val_accuracy20: 0.4274 - val_accuracy30: 0.4106 - val_accuracy50: 0.3875 - 6s/epoch - 29ms/step
Epoch 9/50
211/211 - 6s - loss: 12.5967 - accuracy10: 0.4739 - accuracy20: 0.4614 - accuracy30: 0.4393 - accuracy50: 0.4155 - val_loss: 12.9026 - val_accuracy10: 0.4423 - val_accuracy20: 0.4312 - val_accuracy30: 0.4144 - val_accuracy50: 0.3962 - 6s/epoch - 29ms/step
Epoch 10/50
211/211 - 6s - loss: 12.5257 - accuracy10: 0.4809 - accuracy20: 0.4702 - accuracy30: 0.4488 - accuracy50: 0.4218 - val_loss: 12.8894 - val_accuracy10: 0.4467 - val_accuracy20: 0.4350 - val_accuracy30: 0.4179 - val_accuracy50: 0.3958 - 6s/epoch - 29ms/step
Epoch 11/50
211/211 - 6s - loss: 12.4702 - accuracy10: 0.4842 - accuracy20: 0.4759 - accuracy30: 0.4545 - accuracy50: 0.4254 - val_loss: 12.9142 - val_accuracy10: 0.4469 - val_accuracy20: 0.4337 - val_accuracy30: 0.4193 - val_accuracy50: 0.3993 - 6s/epoch - 29ms/step
Epoch 12/50
211/211 - 6s - loss: 12.3989 - accuracy10: 0.4902 - accuracy20: 0.4827 - accuracy30: 0.4618 - accuracy50: 0.4309 - val_loss: 12.9064 - val_accuracy10: 0.4451 - val_accuracy20: 0.4375 - val_accuracy30: 0.4193 - val_accuracy50: 0.4000 - 6s/epoch - 29ms/step
Epoch 13/50
211/211 - 6s - loss: 12.3356 - accuracy10: 0.4942 - accuracy20: 0.4881 - accuracy30: 0.4664 - accuracy50: 0.4370 - val_loss: 12.9430 - val_accuracy10: 0.4442 - val_accuracy20: 0.4403 - val_accuracy30: 0.4259 - val_accuracy50: 0.4021 - 6s/epoch - 29ms/step
Epoch 14/50
211/211 - 6s - loss: 12.2509 - accuracy10: 0.4975 - accuracy20: 0.4936 - accuracy30: 0.4737 - accuracy50: 0.4442 - val_loss: 12.9537 - val_accuracy10: 0.4418 - val_accuracy20: 0.4440 - val_accuracy30: 0.4278 - val_accuracy50: 0.4081 - 6s/epoch - 29ms/step
Epoch 15/50
211/211 - 6s - loss: 12.1869 - accuracy10: 0.5036 - accuracy20: 0.5028 - accuracy30: 0.4828 - accuracy50: 0.4507 - val_loss: 13.0055 - val_accuracy10: 0.4380 - val_accuracy20: 0.4384 - val_accuracy30: 0.4241 - val_accuracy50: 0.4055 - 6s/epoch - 29ms/step
Epoch 16/50
211/211 - 6s - loss: 12.1194 - accuracy10: 0.5058 - accuracy20: 0.5082 - accuracy30: 0.4890 - accuracy50: 0.4560 - val_loss: 13.0874 - val_accuracy10: 0.4378 - val_accuracy20: 0.4435 - val_accuracy30: 0.4265 - val_accuracy50: 0.4077 - 6s/epoch - 29ms/step
Epoch 17/50
211/211 - 6s - loss: 12.0665 - accuracy10: 0.5080 - accuracy20: 0.5119 - accuracy30: 0.4916 - accuracy50: 0.4611 - val_loss: 13.1130 - val_accuracy10: 0.4416 - val_accuracy20: 0.4368 - val_accuracy30: 0.4251 - val_accuracy50: 0.4077 - 6s/epoch - 29ms/step
Epoch 18/50
211/211 - 6s - loss: 11.9783 - accuracy10: 0.5135 - accuracy20: 0.5173 - accuracy30: 0.4990 - accuracy50: 0.4684 - val_loss: 13.1543 - val_accuracy10: 0.4381 - val_accuracy20: 0.4418 - val_accuracy30: 0.4264 - val_accuracy50: 0.4089 - 6s/epoch - 29ms/step
Epoch 19/50
211/211 - 6s - loss: 11.9569 - accuracy10: 0.5136 - accuracy20: 0.5210 - accuracy30: 0.5039 - accuracy50: 0.4715 - val_loss: 13.1287 - val_accuracy10: 0.4269 - val_accuracy20: 0.4369 - val_accuracy30: 0.4263 - val_accuracy50: 0.4062 - 6s/epoch - 29ms/step
Epoch 20/50
211/211 - 6s - loss: 11.8589 - accuracy10: 0.5171 - accuracy20: 0.5270 - accuracy30: 0.5107 - accuracy50: 0.4806 - val_loss: 13.2716 - val_accuracy10: 0.4313 - val_accuracy20: 0.4334 - val_accuracy30: 0.4198 - val_accuracy50: 0.3994 - 6s/epoch - 29ms/step
testing model: results/LILAK/W6/deepOF_L2/seq2seq
Evaluating performance on  test set...
1059/1059 - 10s - 10s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0763178
{'0': {'precision': 0.4044142461808446, 'recall': 0.4343938423615558, 'f1-score': 0.4188682982528706, 'support': 82759}, '1': {'precision': 0.4868821459431706, 'recall': 0.38651727840299044, 'f1-score': 0.4309331027870606, 'support': 100588}, '2': {'precision': 0.4126960856179446, 'recall': 0.481388588040814, 'f1-score': 0.44440351523443666, 'support': 87715}, 'accuracy': 0.43183478318613455, 'macro avg': {'precision': 0.43466415924731994, 'recall': 0.4340999029351201, 'f1-score': 0.4314016387581226, 'support': 271062}, 'weighted avg': {'precision': 0.4376971211228065, 'recall': 0.43183478318613455, 'f1-score': 0.4316085426103355, 'support': 271062}}
[[35950 19476 27333]
 [28952 38879 32757]
 [23992 21498 42225]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0766748
{'0': {'precision': 0.44914286980707646, 'recall': 0.4191606858466566, 'f1-score': 0.43363414125312266, 'support': 96698}, '1': {'precision': 0.3590740620326419, 'recall': 0.38443652362785774, 'f1-score': 0.37132271361041436, 'support': 71822}, '2': {'precision': 0.4544474808513914, 'recall': 0.4605722533205906, 'f1-score': 0.45748936870961804, 'support': 102542}, 'accuracy': 0.4256258715718175, 'macro avg': {'precision': 0.42088813756370325, 'recall': 0.4213898209317016, 'f1-score': 0.42081540785771837, 'support': 271062}, 'weighted avg': {'precision': 0.42728448874935054, 'recall': 0.4256258715718175, 'f1-score': 0.4261481468226579, 'support': 271062}}
[[40532 22968 33198]
 [20713 27611 23498]
 [28998 26316 47228]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0870951
{'0': {'precision': 0.427695675971538, 'recall': 0.41364050225506593, 'f1-score': 0.4205506878215754, 'support': 94454}, '1': {'precision': 0.35047027917296203, 'recall': 0.33878947368421053, 'f1-score': 0.3445308997972797, 'support': 76000}, '2': {'precision': 0.4327921313944186, 'recall': 0.45704118956743, 'f1-score': 0.44458625207272795, 'support': 100608}, 'accuracy': 0.40876257092473306, 'macro avg': {'precision': 0.4036526955129729, 'recall': 0.40315705516890216, 'f1-score': 0.40322261323052766, 'support': 271062}, 'weighted avg': {'precision': 0.4079349349989686, 'recall': 0.40876257092473306, 'f1-score': 0.40815745733679143, 'support': 271062}}
[[39070 22104 33280]
 [23269 25748 26983]
 [29011 25615 45982]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0992714
{'0': {'precision': 0.39576672555246073, 'recall': 0.400015335911227, 'f1-score': 0.39787968925353295, 'support': 91289}, '1': {'precision': 0.34013974048196205, 'recall': 0.2929387203733268, 'f1-score': 0.3147796252309316, 'support': 81430}, '2': {'precision': 0.4104893109890211, 'recall': 0.45356558168857974, 'f1-score': 0.43095369216351215, 'support': 98343}, 'accuracy': 0.38727671160103594, 'macro avg': {'precision': 0.3821319256744813, 'recall': 0.38217321265771115, 'f1-score': 0.3812043355493256, 'support': 271062}, 'weighted avg': {'precision': 0.3843972153492487, 'recall': 0.38727671160103594, 'f1-score': 0.38491497437212446, 'support': 271062}}
[[36517 21705 33067]
 [26585 23854 30991]
 [29167 24571 44605]]
Evaluating performance on  train set...
211/211 - 2s - 2s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0199205
{'0': {'precision': 0.44263059701492535, 'recall': 0.43600682593856654, 'f1-score': 0.43929374421372835, 'support': 15236}, '1': {'precision': 0.5959125859975718, 'recall': 0.48483351854138373, 'f1-score': 0.5346646998751844, 'support': 24297}, '2': {'precision': 0.3989991137986759, 'recall': 0.5305698045196173, 'f1-score': 0.4554732363355054, 'support': 14426}, 'accuracy': 0.48327433792323804, 'macro avg': {'precision': 0.47918076560372436, 'recall': 0.4838033829998558, 'f1-score': 0.4764772268081394, 'support': 53959}, 'weighted avg': {'precision': 0.49998645441468714, 'recall': 0.48327433792323804, 'f1-score': 0.48656358729931465, 'support': 53959}}
[[ 6643  4117  4476]
 [ 5464 11780  7053]
 [ 2901  3871  7654]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0305952
{'0': {'precision': 0.49860579728941057, 'recall': 0.42032471437161756, 'f1-score': 0.45613098416088277, 'support': 18293}, '1': {'precision': 0.4734434160706773, 'recall': 0.48876221498371336, 'f1-score': 0.4809808740250026, 'support': 18420}, '2': {'precision': 0.4495953283475054, 'recall': 0.50892960686536, 'f1-score': 0.4774260226283725, 'support': 17246}, 'accuracy': 0.47200652347152466, 'macro avg': {'precision': 0.473881513902531, 'recall': 0.4726721787402304, 'f1-score': 0.471512626938086, 'support': 53959}, 'weighted avg': {'precision': 0.47435172272499754, 'recall': 0.47200652347152466, 'f1-score': 0.4714201704821159, 'support': 53959}}
[[7689 5093 5511]
 [4183 9003 5234]
 [3549 4920 8777]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0488533
{'0': {'precision': 0.4841944902881808, 'recall': 0.4112129380053908, 'f1-score': 0.44472947761194037, 'support': 18550}, '1': {'precision': 0.4351673720661793, 'recall': 0.4437531528501766, 'f1-score': 0.4394183271354831, 'support': 17841}, '2': {'precision': 0.43578852688386965, 'recall': 0.4964139344262295, 'f1-score': 0.46412985630654596, 'support': 17568}, 'accuracy': 0.4497118182323616, 'macro avg': {'precision': 0.45171679641274326, 'recall': 0.45046000842726563, 'f1-score': 0.44942588701798986, 'support': 53959}, 'weighted avg': {'precision': 0.45222412795222816, 'recall': 0.4497118182323616, 'f1-score': 0.44928978483142845, 'support': 53959}}
[[7628 5179 5743]
 [4376 7917 5548]
 [3750 5097 8721]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0676417
{'0': {'precision': 0.4590408658331778, 'recall': 0.39939387379586533, 'f1-score': 0.42714513095065837, 'support': 18478}, '1': {'precision': 0.40488847798451405, 'recall': 0.3906885977139671, 'f1-score': 0.39766181436395104, 'support': 17935}, '2': {'precision': 0.4149494556765163, 'recall': 0.4866066339906531, 'f1-score': 0.4479303289439169, 'support': 17546}, 'accuracy': 0.4248596156340925, 'macro avg': {'precision': 0.42629293316473604, 'recall': 0.42556303516682853, 'f1-score': 0.42424575808617543, 'support': 53959}, 'weighted avg': {'precision': 0.42670425917488974, 'recall': 0.4248596156340925, 'f1-score': 0.42410418877246964, 'support': 53959}}
[[7380 5169 5929]
 [4819 7007 6109]
 [3878 5130 8538]]
Evaluating performance on  val set...
81/81 - 1s - 918ms/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0595139
{'0': {'precision': 0.3943447341686421, 'recall': 0.3999656534432423, 'f1-score': 0.39713530565265576, 'support': 5823}, '1': {'precision': 0.5641095517100423, 'recall': 0.46046046046046046, 'f1-score': 0.5070422535211268, 'support': 8991}, '2': {'precision': 0.3799215261804898, 'recall': 0.48230848505668156, 'f1-score': 0.42503594944372963, 'support': 5822}, 'accuracy': 0.44955417716611745, 'macro avg': {'precision': 0.4461252706863914, 'recall': 0.4475781996534615, 'f1-score': 0.4430711695391707, 'support': 20636}, 'weighted avg': {'precision': 0.4642412042988857, 'recall': 0.44955417716611745, 'f1-score': 0.4528927642898458, 'support': 20636}}
[[2329 1595 1899]
 [2167 4140 2684]
 [1410 1604 2808]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0671684
{'0': {'precision': 0.4423963133640553, 'recall': 0.3817097415506958, 'f1-score': 0.4098185699039487, 'support': 7042}, '1': {'precision': 0.43249718151071026, 'recall': 0.46275633293124246, 'f1-score': 0.44711538461538464, 'support': 6632}, '2': {'precision': 0.42483922829581994, 'recall': 0.4554725653547831, 'f1-score': 0.43962290309164004, 'support': 6962}, 'accuracy': 0.43264198488079086, 'macro avg': {'precision': 0.4332442410568618, 'recall': 0.4333128799455738, 'f1-score': 0.4321856192036578, 'support': 20636}, 'weighted avg': {'precision': 0.43329166766254146, 'recall': 0.43264198488079086, 'f1-score': 0.43186015949587303, 'support': 20636}}
[[2688 2011 2343]
 [1613 3069 1950]
 [1775 2016 3171]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0779691
{'0': {'precision': 0.43287890938251805, 'recall': 0.3760100306492059, 'f1-score': 0.4024453888019086, 'support': 7178}, '1': {'precision': 0.39724607639917087, 'recall': 0.4163563004345127, 'f1-score': 0.4065767540536445, 'support': 6444}, '2': {'precision': 0.41571858245063426, 'recall': 0.4532363843741089, 'f1-score': 0.4336675533728941, 'support': 7014}, 'accuracy': 0.41485753052917235, 'macro avg': {'precision': 0.4152811894107744, 'recall': 0.41520090515260916, 'f1-score': 0.41422989874281574, 'support': 20636}, 'weighted avg': {'precision': 0.4159192026154643, 'recall': 0.41485753052917235, 'f1-score': 0.4143476363296794, 'support': 20636}}
[[2699 2053 2426]
 [1719 2683 2042]
 [1817 2018 3179]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0907984
{'0': {'precision': 0.4181647647334688, 'recall': 0.3703960121849903, 'f1-score': 0.39283354137601884, 'support': 7222}, '1': {'precision': 0.36369317294172787, 'recall': 0.3616591579928538, 'f1-score': 0.36267331360024924, 'support': 6437}, '2': {'precision': 0.39512630773156415, 'recall': 0.44388705747455925, 'f1-score': 0.41808977387782653, 'support': 6977}, 'accuracy': 0.3925179298313627, 'macro avg': {'precision': 0.3923280818022536, 'recall': 0.3919807425508011, 'f1-score': 0.3911988762846981, 'support': 20636}, 'weighted avg': {'precision': 0.3933841410241392, 'recall': 0.3925179298313627, 'f1-score': 0.39196473676138827, 'support': 20636}}
[[2675 2035 2512]
 [1880 2328 2229]
 [1842 2038 3097]]
training model: results/LILAK/W6/deepVOL_L2/seq2seq
Epoch 1/50
211/211 - 12s - loss: 13.2515 - accuracy10: 0.3722 - accuracy20: 0.3673 - accuracy30: 0.3645 - accuracy50: 0.3552 - val_loss: 13.1728 - val_accuracy10: 0.4155 - val_accuracy20: 0.3856 - val_accuracy30: 0.3797 - val_accuracy50: 0.3710 - 12s/epoch - 57ms/step
Epoch 2/50
211/211 - 6s - loss: 13.0348 - accuracy10: 0.4009 - accuracy20: 0.4005 - accuracy30: 0.3946 - accuracy50: 0.3813 - val_loss: 13.0252 - val_accuracy10: 0.4258 - val_accuracy20: 0.4032 - val_accuracy30: 0.3966 - val_accuracy50: 0.3849 - 6s/epoch - 30ms/step
Epoch 3/50
211/211 - 6s - loss: 12.9455 - accuracy10: 0.4187 - accuracy20: 0.4207 - accuracy30: 0.4101 - accuracy50: 0.3859 - val_loss: 12.9288 - val_accuracy10: 0.4327 - val_accuracy20: 0.4192 - val_accuracy30: 0.4099 - val_accuracy50: 0.3921 - 6s/epoch - 29ms/step
Epoch 4/50
211/211 - 6s - loss: 12.8521 - accuracy10: 0.4293 - accuracy20: 0.4324 - accuracy30: 0.4235 - accuracy50: 0.3968 - val_loss: 13.1228 - val_accuracy10: 0.4404 - val_accuracy20: 0.4108 - val_accuracy30: 0.3992 - val_accuracy50: 0.3804 - 6s/epoch - 30ms/step
Epoch 5/50
211/211 - 6s - loss: 12.7667 - accuracy10: 0.4391 - accuracy20: 0.4446 - accuracy30: 0.4341 - accuracy50: 0.4050 - val_loss: 12.8800 - val_accuracy10: 0.4374 - val_accuracy20: 0.4404 - val_accuracy30: 0.4296 - val_accuracy50: 0.4053 - 6s/epoch - 30ms/step
Epoch 6/50
211/211 - 6s - loss: 12.6767 - accuracy10: 0.4469 - accuracy20: 0.4530 - accuracy30: 0.4409 - accuracy50: 0.4120 - val_loss: 12.8163 - val_accuracy10: 0.4374 - val_accuracy20: 0.4444 - val_accuracy30: 0.4292 - val_accuracy50: 0.4049 - 6s/epoch - 30ms/step
Epoch 7/50
211/211 - 6s - loss: 12.5954 - accuracy10: 0.4515 - accuracy20: 0.4604 - accuracy30: 0.4481 - accuracy50: 0.4220 - val_loss: 12.7467 - val_accuracy10: 0.4491 - val_accuracy20: 0.4551 - val_accuracy30: 0.4417 - val_accuracy50: 0.4169 - 6s/epoch - 29ms/step
Epoch 8/50
211/211 - 6s - loss: 12.5363 - accuracy10: 0.4574 - accuracy20: 0.4653 - accuracy30: 0.4546 - accuracy50: 0.4266 - val_loss: 12.7321 - val_accuracy10: 0.4458 - val_accuracy20: 0.4485 - val_accuracy30: 0.4349 - val_accuracy50: 0.4116 - 6s/epoch - 29ms/step
Epoch 9/50
211/211 - 6s - loss: 12.4629 - accuracy10: 0.4657 - accuracy20: 0.4736 - accuracy30: 0.4606 - accuracy50: 0.4326 - val_loss: 12.6971 - val_accuracy10: 0.4576 - val_accuracy20: 0.4582 - val_accuracy30: 0.4449 - val_accuracy50: 0.4185 - 6s/epoch - 29ms/step
Epoch 10/50
211/211 - 6s - loss: 12.4471 - accuracy10: 0.4676 - accuracy20: 0.4753 - accuracy30: 0.4620 - accuracy50: 0.4326 - val_loss: 12.8288 - val_accuracy10: 0.4503 - val_accuracy20: 0.4456 - val_accuracy30: 0.4312 - val_accuracy50: 0.4040 - 6s/epoch - 29ms/step
Epoch 11/50
211/211 - 6s - loss: 12.3845 - accuracy10: 0.4732 - accuracy20: 0.4819 - accuracy30: 0.4651 - accuracy50: 0.4386 - val_loss: 12.7908 - val_accuracy10: 0.4495 - val_accuracy20: 0.4514 - val_accuracy30: 0.4406 - val_accuracy50: 0.4146 - 6s/epoch - 29ms/step
Epoch 12/50
211/211 - 6s - loss: 12.3429 - accuracy10: 0.4749 - accuracy20: 0.4851 - accuracy30: 0.4713 - accuracy50: 0.4416 - val_loss: 12.8070 - val_accuracy10: 0.4597 - val_accuracy20: 0.4515 - val_accuracy30: 0.4388 - val_accuracy50: 0.4145 - 6s/epoch - 29ms/step
Epoch 13/50
211/211 - 6s - loss: 12.3038 - accuracy10: 0.4760 - accuracy20: 0.4892 - accuracy30: 0.4766 - accuracy50: 0.4473 - val_loss: 13.0687 - val_accuracy10: 0.4625 - val_accuracy20: 0.4300 - val_accuracy30: 0.4207 - val_accuracy50: 0.3968 - 6s/epoch - 29ms/step
Epoch 14/50
211/211 - 6s - loss: 12.2703 - accuracy10: 0.4792 - accuracy20: 0.4925 - accuracy30: 0.4789 - accuracy50: 0.4492 - val_loss: 12.7860 - val_accuracy10: 0.4631 - val_accuracy20: 0.4560 - val_accuracy30: 0.4403 - val_accuracy50: 0.4152 - 6s/epoch - 28ms/step
Epoch 15/50
211/211 - 6s - loss: 12.2198 - accuracy10: 0.4835 - accuracy20: 0.4959 - accuracy30: 0.4835 - accuracy50: 0.4540 - val_loss: 12.9077 - val_accuracy10: 0.4534 - val_accuracy20: 0.4535 - val_accuracy30: 0.4384 - val_accuracy50: 0.4101 - 6s/epoch - 29ms/step
Epoch 16/50
211/211 - 6s - loss: 12.1998 - accuracy10: 0.4852 - accuracy20: 0.4979 - accuracy30: 0.4834 - accuracy50: 0.4521 - val_loss: 12.8921 - val_accuracy10: 0.4656 - val_accuracy20: 0.4529 - val_accuracy30: 0.4381 - val_accuracy50: 0.4146 - 6s/epoch - 30ms/step
Epoch 17/50
211/211 - 6s - loss: 12.1595 - accuracy10: 0.4874 - accuracy20: 0.5015 - accuracy30: 0.4879 - accuracy50: 0.4576 - val_loss: 12.7714 - val_accuracy10: 0.4588 - val_accuracy20: 0.4620 - val_accuracy30: 0.4467 - val_accuracy50: 0.4190 - 6s/epoch - 29ms/step
Epoch 18/50
211/211 - 6s - loss: 12.1367 - accuracy10: 0.4887 - accuracy20: 0.5031 - accuracy30: 0.4907 - accuracy50: 0.4608 - val_loss: 12.7928 - val_accuracy10: 0.4559 - val_accuracy20: 0.4560 - val_accuracy30: 0.4422 - val_accuracy50: 0.4167 - 6s/epoch - 30ms/step
Epoch 19/50
211/211 - 6s - loss: 12.0865 - accuracy10: 0.4931 - accuracy20: 0.5080 - accuracy30: 0.4937 - accuracy50: 0.4624 - val_loss: 12.9022 - val_accuracy10: 0.4535 - val_accuracy20: 0.4526 - val_accuracy30: 0.4383 - val_accuracy50: 0.4121 - 6s/epoch - 29ms/step
testing model: results/LILAK/W6/deepVOL_L2/seq2seq
Evaluating performance on  test set...
1059/1059 - 11s - 11s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0609752
{'0': {'precision': 0.4257246376811594, 'recall': 0.3265466408893185, 'f1-score': 0.3695979212253829, 'support': 82760}, '1': {'precision': 0.5331405755197577, 'recall': 0.38494497519658816, 'f1-score': 0.44708205125244627, 'support': 100591}, '2': {'precision': 0.3959335195654912, 'recall': 0.6091705048109809, 'f1-score': 0.4799324570109533, 'support': 87716}, 'accuracy': 0.4396735862351374, 'macro avg': {'precision': 0.4515995775888028, 'recall': 0.4402207069656292, 'f1-score': 0.4322041431629275, 'support': 271067}, 'weighted avg': {'precision': 0.45594564904177687, 'recall': 0.4396735862351374, 'f1-score': 0.43405545484075997, 'support': 271067}}
[[27025 15656 40079]
 [20425 38722 41444]
 [16030 18252 53434]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0570493
{'0': {'precision': 0.47604550552796027, 'recall': 0.30723888314374354, 'f1-score': 0.37345232857771354, 'support': 96700}, '1': {'precision': 0.42597161805605077, 'recall': 0.415835932278904, 'f1-score': 0.42084275639535296, 'support': 71824}, '2': {'precision': 0.44384374413535244, 'recall': 0.5996606301746584, 'f1-score': 0.510118837754319, 'support': 102543}, 'accuracy': 0.4466349647873035, 'macro avg': {'precision': 0.44862028923978786, 'recall': 0.440911815199102, 'f1-score': 0.43480464090912846, 'support': 271067}, 'weighted avg': {'precision': 0.4505958118645316, 'recall': 0.4466349647873035, 'f1-score': 0.4377093718108286, 'support': 271067}}
[[29710 18224 48766]
 [13672 29867 28285]
 [19028 22024 61491]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0692283
{'0': {'precision': 0.4527249274427604, 'recall': 0.2972600999407131, 'f1-score': 0.3588793169559549, 'support': 94456}, '1': {'precision': 0.4175973326645324, 'recall': 0.372437567432436, 'f1-score': 0.3937267447925723, 'support': 76002}, '2': {'precision': 0.42720013591573225, 'recall': 0.5998270532457335, 'f1-score': 0.4990056765327259, 'support': 100609}, 'accuracy': 0.4306389195291201, 'macro avg': {'precision': 0.43250746534100837, 'recall': 0.4231749068729609, 'f1-score': 0.4172039127604177, 'support': 271067}, 'weighted avg': {'precision': 0.4334020618446697, 'recall': 0.4306389195291201, 'f1-score': 0.42065905082654015, 'support': 271067}}
[[28078 17654 48724]
 [15504 28306 32192]
 [18438 21823 60348]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0897163
{'0': {'precision': 0.4180531433116367, 'recall': 0.28211981465861913, 'f1-score': 0.33689126084056037, 'support': 91291}, '1': {'precision': 0.3931926854977925, 'recall': 0.31606351233529406, 'f1-score': 0.35043433270702284, 'support': 81433}, '2': {'precision': 0.40391386170929366, 'recall': 0.5914401635093499, 'f1-score': 0.480011883933582, 'support': 98343}, 'accuracy': 0.40453836136453347, 'macro avg': {'precision': 0.4050532301729077, 'recall': 0.39654116350108765, 'f1-score': 0.38911249249372176, 'support': 271067}, 'weighted avg': {'precision': 0.40545492577953585, 'recall': 0.40453836136453347, 'f1-score': 0.39288392836607494, 'support': 271067}}
[[25755 17439 48097]
 [17955 25738 37740]
 [17897 22282 58164]]
Evaluating performance on  train set...
211/211 - 2s - 2s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0263507
{'0': {'precision': 0.44315403422982885, 'recall': 0.2843323093012615, 'f1-score': 0.346406529962174, 'support': 15299}, '1': {'precision': 0.605242642759696, 'recall': 0.5138153540701522, 'f1-score': 0.5557941834451902, 'support': 24176}, '2': {'precision': 0.3615733096236081, 'recall': 0.5896161281413974, 'f1-score': 0.44825866729653835, 'support': 14484}, 'accuracy': 0.46909690691080264, 'macro avg': {'precision': 0.4699899955377109, 'recall': 0.4625879305042704, 'f1-score': 0.4501531269013008, 'support': 53959}, 'weighted avg': {'precision': 0.4938784543380882, 'recall': 0.46909690691080264, 'f1-score': 0.4675611523190808, 'support': 53959}}
[[ 4350  4106  6843]
 [ 3518 12422  8236]
 [ 1948  3996  8540]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0411443
{'0': {'precision': 0.5063600284929276, 'recall': 0.27164537613276557, 'f1-score': 0.3535974418191508, 'support': 18318}, '1': {'precision': 0.5020309914247029, 'recall': 0.543662430759205, 'f1-score': 0.5220179898318341, 'support': 18414}, '2': {'precision': 0.4149477078252243, 'recall': 0.5826899634295002, 'f1-score': 0.4847167898015356, 'support': 17227}, 'accuracy': 0.4637780537074445, 'macro avg': {'precision': 0.4744462425809515, 'recall': 0.4659992567738236, 'f1-score': 0.4534440738175069, 'support': 53959}, 'weighted avg': {'precision': 0.47569832355553415, 'recall': 0.4637780537074445, 'f1-score': 0.4529337708615366, 'support': 53959}}
[[ 4976  5080  8262]
 [ 2512 10011  5891]
 [ 2339  4850 10038]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0524175
{'0': {'precision': 0.49989913253984264, 'recall': 0.2670546395085677, 'f1-score': 0.34813149761168866, 'support': 18558}, '1': {'precision': 0.47368693670361545, 'recall': 0.5131298395241836, 'f1-score': 0.49262012497306606, 'support': 17822}, '2': {'precision': 0.41303205465055176, 'recall': 0.5812617327493032, 'f1-score': 0.48291507160073727, 'support': 17579}, 'accuracy': 0.4506940454789748, 'macro avg': {'precision': 0.4622060412980033, 'recall': 0.4538154039273515, 'f1-score': 0.441222231395164, 'support': 53959}, 'weighted avg': {'precision': 0.462941625610339, 'recall': 0.4506940454789748, 'f1-score': 0.43976471475781725, 'support': 53959}}
[[ 4956  5240  8362]
 [ 2518  9145  6159]
 [ 2440  4921 10218]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0762708
{'0': {'precision': 0.4731193580742227, 'recall': 0.2552212963964939, 'f1-score': 0.3315759876282863, 'support': 18482}, '1': {'precision': 0.4284793468335392, 'recall': 0.4449216353393943, 'f1-score': 0.4365457231981612, 'support': 17929}, '2': {'precision': 0.39350465079615327, 'recall': 0.5689537269204468, 'f1-score': 0.465237651444548, 'support': 17548}, 'accuracy': 0.420282066013084, 'macro avg': {'precision': 0.4317011185679717, 'recall': 0.4230322195521117, 'f1-score': 0.4111197874236652, 'support': 53959}, 'weighted avg': {'precision': 0.4323952963820161, 'recall': 0.420282066013084, 'f1-score': 0.4099224593138262, 'support': 53959}}
[[4717 5520 8245]
 [2809 7977 7143]
 [2444 5120 9984]]
Evaluating performance on  val set...
81/81 - 1s - 947ms/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0398864
{'0': {'precision': 0.4063364344983656, 'recall': 0.279294849637055, 'f1-score': 0.33104578510703675, 'support': 5786}, '1': {'precision': 0.5931474545706755, 'recall': 0.47300884955752215, 'f1-score': 0.5263093113422365, 'support': 9040}, '2': {'precision': 0.36821500370331184, 'recall': 0.5988642230252968, 'f1-score': 0.4560345957279518, 'support': 5811}, 'accuracy': 0.4541357755487716, 'macro avg': {'precision': 0.45589963092411767, 'recall': 0.4503893074066247, 'f1-score': 0.437796564059075, 'support': 20637}, 'weighted avg': {'precision': 0.47743436477425955, 'recall': 0.4541357755487716, 'f1-score': 0.4517751670755566, 'support': 20637}}
[[1616 1467 2703]
 [1496 4276 3268]
 [ 865 1466 3480]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0482969
{'0': {'precision': 0.48238897396630936, 'recall': 0.2696533028962762, 'f1-score': 0.34593209481101855, 'support': 7009}, '1': {'precision': 0.4869851258581236, 'recall': 0.5073759499329459, 'f1-score': 0.4969714661023134, 'support': 6711}, '2': {'precision': 0.4241801171995476, 'recall': 0.5965013734277866, 'f1-score': 0.49579428022110067, 'support': 6917}, 'accuracy': 0.4565101516693318, 'macro avg': {'precision': 0.46451807234132686, 'recall': 0.4578435420856695, 'f1-score': 0.44623261371147754, 'support': 20637}, 'weighted avg': {'precision': 0.46437347331651896, 'recall': 0.4565101516693318, 'f1-score': 0.4452789939347971, 'support': 20637}}
[[1890 1815 3304]
 [1009 3405 2297]
 [1019 1772 4126]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0582223
{'0': {'precision': 0.47589900535577656, 'recall': 0.2605781315458735, 'f1-score': 0.33676231727125067, 'support': 7161}, '1': {'precision': 0.4571513441259468, 'recall': 0.47215830648872525, 'f1-score': 0.4645336552973136, 'support': 6519}, '2': {'precision': 0.4162075528398277, 'recall': 0.5972401897369556, 'f1-score': 0.4905548996458087, 'support': 6957}, 'accuracy': 0.440907108591365, 'macro avg': {'precision': 0.44975263410718364, 'recall': 0.4433255425905181, 'f1-score': 0.43061695740479095, 'support': 20637}, 'weighted avg': {'precision': 0.449854064777654, 'recall': 0.440907108591365, 'f1-score': 0.4289693409748754, 'support': 20637}}
[[1866 1869 3426]
 [1039 3078 2402]
 [1016 1786 4155]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.075892
{'0': {'precision': 0.4669191919191919, 'recall': 0.25609418282548474, 'f1-score': 0.3307692307692307, 'support': 7220}, '1': {'precision': 0.4165245698341342, 'recall': 0.4163954749728808, 'f1-score': 0.416460012399256, 'support': 6453}, '2': {'precision': 0.3982006649716409, 'recall': 0.5847214244686961, 'f1-score': 0.47376381617219315, 'support': 6964}, 'accuracy': 0.41711489073024177, 'macro avg': {'precision': 0.42721480890832236, 'recall': 0.4190703607556872, 'f1-score': 0.4069976864468933, 'support': 20637}, 'weighted avg': {'precision': 0.42797204272223394, 'recall': 0.41711489073024177, 'f1-score': 0.4058177798124436, 'support': 20637}}
[[1849 1930 3441]
 [1053 2687 2713]
 [1058 1834 4072]]
training model: results/LILAK/W6/deepVOL_L3/seq2seq
Epoch 1/50
211/211 - 15s - loss: 13.2881 - accuracy10: 0.3569 - accuracy20: 0.3618 - accuracy30: 0.3600 - accuracy50: 0.3523 - val_loss: 13.1707 - val_accuracy10: 0.3971 - val_accuracy20: 0.3714 - val_accuracy30: 0.3604 - val_accuracy50: 0.3569 - 15s/epoch - 70ms/step
Epoch 2/50
211/211 - 9s - loss: 13.1346 - accuracy10: 0.3776 - accuracy20: 0.3796 - accuracy30: 0.3740 - accuracy50: 0.3626 - val_loss: 13.1135 - val_accuracy10: 0.3995 - val_accuracy20: 0.3871 - val_accuracy30: 0.3837 - val_accuracy50: 0.3726 - 9s/epoch - 43ms/step
Epoch 3/50
211/211 - 9s - loss: 13.0445 - accuracy10: 0.3983 - accuracy20: 0.4009 - accuracy30: 0.3938 - accuracy50: 0.3805 - val_loss: 12.9527 - val_accuracy10: 0.4050 - val_accuracy20: 0.4079 - val_accuracy30: 0.4014 - val_accuracy50: 0.3882 - 9s/epoch - 43ms/step
Epoch 4/50
211/211 - 9s - loss: 12.9584 - accuracy10: 0.4156 - accuracy20: 0.4156 - accuracy30: 0.4073 - accuracy50: 0.3861 - val_loss: 12.9301 - val_accuracy10: 0.4361 - val_accuracy20: 0.4213 - val_accuracy30: 0.4103 - val_accuracy50: 0.3907 - 9s/epoch - 44ms/step
Epoch 5/50
211/211 - 9s - loss: 12.8569 - accuracy10: 0.4287 - accuracy20: 0.4329 - accuracy30: 0.4217 - accuracy50: 0.3998 - val_loss: 12.9023 - val_accuracy10: 0.4452 - val_accuracy20: 0.4301 - val_accuracy30: 0.4185 - val_accuracy50: 0.3939 - 9s/epoch - 43ms/step
Epoch 6/50
211/211 - 9s - loss: 12.7878 - accuracy10: 0.4377 - accuracy20: 0.4436 - accuracy30: 0.4346 - accuracy50: 0.4086 - val_loss: 12.8490 - val_accuracy10: 0.4227 - val_accuracy20: 0.4314 - val_accuracy30: 0.4199 - val_accuracy50: 0.3972 - 9s/epoch - 42ms/step
Epoch 7/50
211/211 - 9s - loss: 12.7245 - accuracy10: 0.4446 - accuracy20: 0.4513 - accuracy30: 0.4405 - accuracy50: 0.4117 - val_loss: 12.7850 - val_accuracy10: 0.4315 - val_accuracy20: 0.4483 - val_accuracy30: 0.4385 - val_accuracy50: 0.4181 - 9s/epoch - 43ms/step
Epoch 8/50
211/211 - 9s - loss: 12.6424 - accuracy10: 0.4502 - accuracy20: 0.4589 - accuracy30: 0.4477 - accuracy50: 0.4198 - val_loss: 12.7214 - val_accuracy10: 0.4269 - val_accuracy20: 0.4514 - val_accuracy30: 0.4419 - val_accuracy50: 0.4237 - 9s/epoch - 43ms/step
Epoch 9/50
211/211 - 9s - loss: 12.5582 - accuracy10: 0.4556 - accuracy20: 0.4656 - accuracy30: 0.4531 - accuracy50: 0.4266 - val_loss: 12.6758 - val_accuracy10: 0.4309 - val_accuracy20: 0.4571 - val_accuracy30: 0.4482 - val_accuracy50: 0.4290 - 9s/epoch - 43ms/step
Epoch 10/50
211/211 - 9s - loss: 12.5094 - accuracy10: 0.4607 - accuracy20: 0.4715 - accuracy30: 0.4584 - accuracy50: 0.4278 - val_loss: 12.6889 - val_accuracy10: 0.4377 - val_accuracy20: 0.4585 - val_accuracy30: 0.4468 - val_accuracy50: 0.4225 - 9s/epoch - 43ms/step
Epoch 11/50
211/211 - 9s - loss: 12.4550 - accuracy10: 0.4618 - accuracy20: 0.4729 - accuracy30: 0.4627 - accuracy50: 0.4341 - val_loss: 12.6495 - val_accuracy10: 0.4623 - val_accuracy20: 0.4615 - val_accuracy30: 0.4473 - val_accuracy50: 0.4244 - 9s/epoch - 43ms/step
Epoch 12/50
211/211 - 9s - loss: 12.4253 - accuracy10: 0.4652 - accuracy20: 0.4761 - accuracy30: 0.4653 - accuracy50: 0.4364 - val_loss: 12.6242 - val_accuracy10: 0.4492 - val_accuracy20: 0.4606 - val_accuracy30: 0.4492 - val_accuracy50: 0.4262 - 9s/epoch - 43ms/step
Epoch 13/50
211/211 - 9s - loss: 12.3856 - accuracy10: 0.4651 - accuracy20: 0.4788 - accuracy30: 0.4677 - accuracy50: 0.4390 - val_loss: 12.7214 - val_accuracy10: 0.4654 - val_accuracy20: 0.4569 - val_accuracy30: 0.4413 - val_accuracy50: 0.4148 - 9s/epoch - 43ms/step
Epoch 14/50
211/211 - 9s - loss: 12.3523 - accuracy10: 0.4691 - accuracy20: 0.4820 - accuracy30: 0.4716 - accuracy50: 0.4445 - val_loss: 12.7603 - val_accuracy10: 0.4562 - val_accuracy20: 0.4589 - val_accuracy30: 0.4462 - val_accuracy50: 0.4195 - 9s/epoch - 44ms/step
Epoch 15/50
211/211 - 9s - loss: 12.3117 - accuracy10: 0.4744 - accuracy20: 0.4873 - accuracy30: 0.4735 - accuracy50: 0.4449 - val_loss: 12.7607 - val_accuracy10: 0.4498 - val_accuracy20: 0.4566 - val_accuracy30: 0.4421 - val_accuracy50: 0.4160 - 9s/epoch - 43ms/step
Epoch 16/50
211/211 - 9s - loss: 12.2551 - accuracy10: 0.4766 - accuracy20: 0.4891 - accuracy30: 0.4798 - accuracy50: 0.4488 - val_loss: 12.7159 - val_accuracy10: 0.4576 - val_accuracy20: 0.4564 - val_accuracy30: 0.4417 - val_accuracy50: 0.4177 - 9s/epoch - 42ms/step
Epoch 17/50
211/211 - 9s - loss: 12.2189 - accuracy10: 0.4824 - accuracy20: 0.4940 - accuracy30: 0.4822 - accuracy50: 0.4534 - val_loss: 12.6839 - val_accuracy10: 0.4575 - val_accuracy20: 0.4572 - val_accuracy30: 0.4458 - val_accuracy50: 0.4206 - 9s/epoch - 43ms/step
Epoch 18/50
211/211 - 9s - loss: 12.1768 - accuracy10: 0.4851 - accuracy20: 0.4967 - accuracy30: 0.4840 - accuracy50: 0.4556 - val_loss: 12.7523 - val_accuracy10: 0.4654 - val_accuracy20: 0.4615 - val_accuracy30: 0.4465 - val_accuracy50: 0.4219 - 9s/epoch - 43ms/step
Epoch 19/50
211/211 - 9s - loss: 12.1585 - accuracy10: 0.4869 - accuracy20: 0.4994 - accuracy30: 0.4878 - accuracy50: 0.4577 - val_loss: 12.8781 - val_accuracy10: 0.4705 - val_accuracy20: 0.4583 - val_accuracy30: 0.4441 - val_accuracy50: 0.4156 - 9s/epoch - 42ms/step
Epoch 20/50
211/211 - 9s - loss: 12.1140 - accuracy10: 0.4881 - accuracy20: 0.5027 - accuracy30: 0.4919 - accuracy50: 0.4616 - val_loss: 12.8947 - val_accuracy10: 0.4690 - val_accuracy20: 0.4504 - val_accuracy30: 0.4356 - val_accuracy50: 0.4149 - 9s/epoch - 42ms/step
Epoch 21/50
211/211 - 9s - loss: 12.0679 - accuracy10: 0.4928 - accuracy20: 0.5061 - accuracy30: 0.4945 - accuracy50: 0.4639 - val_loss: 12.8273 - val_accuracy10: 0.4630 - val_accuracy20: 0.4568 - val_accuracy30: 0.4417 - val_accuracy50: 0.4196 - 9s/epoch - 42ms/step
Epoch 22/50
211/211 - 9s - loss: 12.0381 - accuracy10: 0.4933 - accuracy20: 0.5066 - accuracy30: 0.4949 - accuracy50: 0.4652 - val_loss: 12.8376 - val_accuracy10: 0.4645 - val_accuracy20: 0.4529 - val_accuracy30: 0.4411 - val_accuracy50: 0.4177 - 9s/epoch - 42ms/step
testing model: results/LILAK/W6/deepVOL_L3/seq2seq
Evaluating performance on  test set...
1059/1059 - 16s - 16s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0665854
{'0': {'precision': 0.40807673962584134, 'recall': 0.3721604639922668, 'f1-score': 0.3892919436790616, 'support': 82760}, '1': {'precision': 0.5717899301373163, 'recall': 0.33033770416836494, 'f1-score': 0.41875177215588666, 'support': 100591}, '2': {'precision': 0.3959062243138852, 'recall': 0.6205025308951616, 'f1-score': 0.48338980341307236, 'support': 87716}, 'accuracy': 0.43700265985900166, 'macro avg': {'precision': 0.4585909646923476, 'recall': 0.44100023301859775, 'f1-score': 0.43047783974934023, 'support': 271067}, 'weighted avg': {'precision': 0.4648911974006211, 'recall': 0.43700265985900166, 'f1-score': 0.43067389526572025, 'support': 271067}}
[[30800 11390 40570]
 [24883 33229 42479]
 [19793 13495 54428]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0512421
{'0': {'precision': 0.4646489301114637, 'recall': 0.35435367114788, 'f1-score': 0.4020745573378079, 'support': 96700}, '1': {'precision': 0.4602773838757652, 'recall': 0.37057251058142127, 'f1-score': 0.4105823370613189, 'support': 71824}, '2': {'precision': 0.4463170722964981, 'recall': 0.6071501711477136, 'f1-score': 0.5144564076715226, 'support': 102543}, 'accuracy': 0.4542825205576481, 'macro avg': {'precision': 0.45708112876124235, 'recall': 0.444025450959005, 'f1-score': 0.44237110069021646, 'support': 271067}, 'weighted avg': {'precision': 0.4565557810643542, 'recall': 0.4542825205576481, 'f1-score': 0.4468422157013548, 'support': 271067}}
[[34266 14002 48432]
 [16404 26616 28804]
 [23076 17208 62259]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0643265
{'0': {'precision': 0.44583987441130296, 'recall': 0.3337426950114339, 'f1-score': 0.38173198597748886, 'support': 94456}, '1': {'precision': 0.44151227182607505, 'recall': 0.3398857924791453, 'f1-score': 0.38409040220057994, 'support': 76002}, '2': {'precision': 0.4309350590756563, 'recall': 0.6075897782504547, 'f1-score': 0.5042377949443416, 'support': 100609}, 'accuracy': 0.4371059553542113, 'macro avg': {'precision': 0.4394290684376781, 'recall': 0.42707275524701127, 'f1-score': 0.4233533943741368, 'support': 271067}, 'weighted avg': {'precision': 0.43909443871538073, 'recall': 0.4371059553542113, 'f1-score': 0.42786239389927005, 'support': 271067}}
[[31524 14579 48353]
 [17800 25832 32370]
 [21383 18097 61129]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0857073
{'0': {'precision': 0.4136038681735932, 'recall': 0.3054627509831199, 'f1-score': 0.3514015865115019, 'support': 91291}, '1': {'precision': 0.40531834577636106, 'recall': 0.2966733388184151, 'f1-score': 0.3425885222422326, 'support': 81433}, '2': {'precision': 0.40850458206053875, 'recall': 0.598324232533073, 'f1-score': 0.48552084923447597, 'support': 98343}, 'accuracy': 0.4090722957792723, 'macro avg': {'precision': 0.409142265336831, 'recall': 0.40015344077820264, 'f1-score': 0.39317031932940344, 'support': 271067}, 'weighted avg': {'precision': 0.40926474153851794, 'recall': 0.4090722957792723, 'f1-score': 0.3974124118474005, 'support': 271067}}
[[27886 15804 47601]
 [19676 24159 37598]
 [19860 19642 58841]]
Evaluating performance on  train set...
211/211 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0245144
{'0': {'precision': 0.4181434928565852, 'recall': 0.35008824106150727, 'f1-score': 0.38110146577486836, 'support': 15299}, '1': {'precision': 0.6307862068965517, 'recall': 0.47290701522170747, 'f1-score': 0.5405545968180422, 'support': 24176}, '2': {'precision': 0.36373507057546145, 'recall': 0.5782242474454571, 'f1-score': 0.44655949238849346, 'support': 14484}, 'accuracy': 0.46635408365610925, 'macro avg': {'precision': 0.47088825677619944, 'recall': 0.4670731679095573, 'f1-score': 0.45607185166046804, 'support': 53959}, 'weighted avg': {'precision': 0.4988121239711432, 'recall': 0.46635408365610925, 'f1-score': 0.47011410414050747, 'support': 53959}}
[[ 5356  3423  6520]
 [ 4613 11433  8130]
 [ 2840  3269  8375]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0300834
{'0': {'precision': 0.47733227471218737, 'recall': 0.32820176875204715, 'f1-score': 0.3889625723805519, 'support': 18318}, '1': {'precision': 0.5225820787734015, 'recall': 0.5108613011838818, 'f1-score': 0.5166552244954002, 'support': 18414}, '2': {'precision': 0.4178829773573599, 'recall': 0.5667266500261218, 'f1-score': 0.48105444690810545, 'support': 17227}, 'accuracy': 0.46668767026816654, 'macro avg': {'precision': 0.47259911028098295, 'recall': 0.4685965733206836, 'f1-score': 0.4622240812613525, 'support': 53959}, 'weighted avg': {'precision': 0.4737943449220056, 'recall': 0.46668767026816654, 'f1-score': 0.46194018906227285, 'support': 53959}}
[[6012 4461 7845]
 [3252 9407 5755]
 [3331 4133 9763]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0432358
{'0': {'precision': 0.47619047619047616, 'recall': 0.31361138053669574, 'f1-score': 0.37816764132553604, 'support': 18558}, '1': {'precision': 0.48788180610889775, 'recall': 0.49472562002019976, 'f1-score': 0.4912798796456232, 'support': 17822}, '2': {'precision': 0.41563490386646945, 'recall': 0.5595312588884465, 'f1-score': 0.4769663466201144, 'support': 17579}, 'accuracy': 0.45354806427102057, 'macro avg': {'precision': 0.4599023953886145, 'recall': 0.45595608648178065, 'f1-score': 0.4488046225304245, 'support': 53959}, 'weighted avg': {'precision': 0.46032391965537345, 'recall': 0.45354806427102057, 'f1-score': 0.44771431105095694, 'support': 53959}}
[[5820 4776 7962]
 [3138 8817 5867]
 [3264 4479 9836]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0701574
{'0': {'precision': 0.45980049450080995, 'recall': 0.2917974245211557, 'f1-score': 0.3570222766541988, 'support': 18482}, '1': {'precision': 0.43219875232570865, 'recall': 0.4405153661665458, 'f1-score': 0.43631743225699526, 'support': 17929}, '2': {'precision': 0.3952245783937218, 'recall': 0.5395486665147026, 'f1-score': 0.4562451811873554, 'support': 17548}, 'accuracy': 0.42178320576734185, 'macro avg': {'precision': 0.42907460840674677, 'recall': 0.42395381906746804, 'f1-score': 0.41652829669951646, 'support': 53959}, 'weighted avg': {'precision': 0.42962851556671966, 'recall': 0.42178320576734185, 'f1-score': 0.41563801033255404, 'support': 53959}}
[[5393 5363 7726]
 [3269 7898 6762]
 [3067 5013 9468]]
Evaluating performance on  val set...
81/81 - 1s - 1s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0441033
{'0': {'precision': 0.3916601714731099, 'recall': 0.34739025233321813, 'f1-score': 0.3681993039018135, 'support': 5786}, '1': {'precision': 0.6206952303961196, 'recall': 0.4246681415929204, 'f1-score': 0.5043021346469622, 'support': 9040}, '2': {'precision': 0.37199570815450644, 'recall': 0.5966270865599724, 'f1-score': 0.458264490119622, 'support': 5811}, 'accuracy': 0.45142220283956, 'macro avg': {'precision': 0.461450370007912, 'recall': 0.45622849349537037, 'f1-score': 0.4435886428894659, 'support': 20637}, 'weighted avg': {'precision': 0.4864514074240525, 'recall': 0.45142220283956, 'f1-score': 0.4531796007980595, 'support': 20637}}
[[2010 1139 2637]
 [1985 3839 3216]
 [1137 1207 3467]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0399576
{'0': {'precision': 0.46500099147332935, 'recall': 0.3345698387787131, 'f1-score': 0.3891470295386658, 'support': 7009}, '1': {'precision': 0.5113821138211382, 'recall': 0.46863358664878557, 'f1-score': 0.4890754995723505, 'support': 6711}, '2': {'precision': 0.42672596357475645, 'recall': 0.5826225242157005, 'f1-score': 0.49263492451561636, 'support': 6917}, 'accuracy': 0.4613073605659737, 'macro avg': {'precision': 0.46770302295640803, 'recall': 0.4619419832143998, 'f1-score': 0.4569524845422109, 'support': 20637}, 'weighted avg': {'precision': 0.46725496947893663, 'recall': 0.4613073605659737, 'f1-score': 0.456329552771288, 'support': 20637}}
[[2345 1474 3190]
 [1342 3145 2224]
 [1356 1531 4030]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0508995
{'0': {'precision': 0.4734486266531027, 'recall': 0.32495461527719594, 'f1-score': 0.3853925140775091, 'support': 7161}, '1': {'precision': 0.4804541768045418, 'recall': 0.4543641662831723, 'f1-score': 0.467045096184169, 'support': 6519}, '2': {'precision': 0.4211572669247672, 'recall': 0.578553974414259, 'f1-score': 0.48746518105849584, 'support': 6957}, 'accuracy': 0.45132528952851675, 'macro avg': {'precision': 0.4583533567941372, 'recall': 0.45262425199154244, 'f1-score': 0.4466342637733913, 'support': 20637}, 'weighted avg': {'precision': 0.4580335077795843, 'recall': 0.45132528952851675, 'f1-score': 0.44559567960253893, 'support': 20637}}
[[2327 1566 3268]
 [1293 2962 2264]
 [1295 1637 4025]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0705488
{'0': {'precision': 0.4706998313659359, 'recall': 0.3092797783933518, 'f1-score': 0.3732865262454028, 'support': 7220}, '1': {'precision': 0.4271083373339734, 'recall': 0.4136060746939408, 'f1-score': 0.4202487797197291, 'support': 6453}, '2': {'precision': 0.4035669846536707, 'recall': 0.5588742102240092, 'f1-score': 0.4686897880539499, 'support': 6964}, 'accuracy': 0.42612782865726606, 'macro avg': {'precision': 0.4337917177845267, 'recall': 0.4272533544371006, 'f1-score': 0.4207416980063606, 'support': 20637}, 'weighted avg': {'precision': 0.43441504891245586, 'recall': 0.42612782865726606, 'f1-score': 0.42016522648790655, 'support': 20637}}
[[2233 1769 3218]
 [1250 2669 2534]
 [1261 1811 3892]]
training model: results/LILAK/W7/deepLOB_L1/seq2seq
Epoch 1/50
282/282 - 11s - loss: 13.2241 - accuracy10: 0.3685 - accuracy20: 0.3691 - accuracy30: 0.3632 - accuracy50: 0.3583 - val_loss: 13.6563 - val_accuracy10: 0.3454 - val_accuracy20: 0.3362 - val_accuracy30: 0.3384 - val_accuracy50: 0.3359 - 11s/epoch - 41ms/step
Epoch 2/50
282/282 - 6s - loss: 13.1024 - accuracy10: 0.3808 - accuracy20: 0.3789 - accuracy30: 0.3771 - accuracy50: 0.3702 - val_loss: 13.2363 - val_accuracy10: 0.3698 - val_accuracy20: 0.3782 - val_accuracy30: 0.3824 - val_accuracy50: 0.3747 - 6s/epoch - 22ms/step
Epoch 3/50
282/282 - 6s - loss: 13.0420 - accuracy10: 0.3900 - accuracy20: 0.3897 - accuracy30: 0.3868 - accuracy50: 0.3781 - val_loss: 13.4245 - val_accuracy10: 0.3705 - val_accuracy20: 0.3790 - val_accuracy30: 0.3790 - val_accuracy50: 0.3737 - 6s/epoch - 21ms/step
Epoch 4/50
282/282 - 6s - loss: 12.9984 - accuracy10: 0.4037 - accuracy20: 0.3985 - accuracy30: 0.3917 - accuracy50: 0.3780 - val_loss: 13.3066 - val_accuracy10: 0.3924 - val_accuracy20: 0.3893 - val_accuracy30: 0.3883 - val_accuracy50: 0.3774 - 6s/epoch - 21ms/step
Epoch 5/50
282/282 - 6s - loss: 12.9479 - accuracy10: 0.4168 - accuracy20: 0.4091 - accuracy30: 0.3997 - accuracy50: 0.3845 - val_loss: 13.3055 - val_accuracy10: 0.3880 - val_accuracy20: 0.3784 - val_accuracy30: 0.3762 - val_accuracy50: 0.3694 - 6s/epoch - 22ms/step
Epoch 6/50
282/282 - 6s - loss: 12.9166 - accuracy10: 0.4244 - accuracy20: 0.4141 - accuracy30: 0.4024 - accuracy50: 0.3859 - val_loss: 13.3657 - val_accuracy10: 0.3870 - val_accuracy20: 0.3762 - val_accuracy30: 0.3694 - val_accuracy50: 0.3659 - 6s/epoch - 22ms/step
Epoch 7/50
282/282 - 7s - loss: 12.8881 - accuracy10: 0.4327 - accuracy20: 0.4181 - accuracy30: 0.4057 - accuracy50: 0.3866 - val_loss: 13.1231 - val_accuracy10: 0.3976 - val_accuracy20: 0.3843 - val_accuracy30: 0.3787 - val_accuracy50: 0.3679 - 7s/epoch - 24ms/step
Epoch 8/50
282/282 - 6s - loss: 12.8626 - accuracy10: 0.4368 - accuracy20: 0.4232 - accuracy30: 0.4110 - accuracy50: 0.3910 - val_loss: 13.5258 - val_accuracy10: 0.3812 - val_accuracy20: 0.3615 - val_accuracy30: 0.3560 - val_accuracy50: 0.3484 - 6s/epoch - 21ms/step
Epoch 9/50
282/282 - 6s - loss: 12.8527 - accuracy10: 0.4398 - accuracy20: 0.4261 - accuracy30: 0.4121 - accuracy50: 0.3934 - val_loss: 13.3585 - val_accuracy10: 0.3889 - val_accuracy20: 0.3708 - val_accuracy30: 0.3617 - val_accuracy50: 0.3545 - 6s/epoch - 21ms/step
Epoch 10/50
282/282 - 6s - loss: 12.8331 - accuracy10: 0.4421 - accuracy20: 0.4245 - accuracy30: 0.4128 - accuracy50: 0.3927 - val_loss: 13.1669 - val_accuracy10: 0.4057 - val_accuracy20: 0.3916 - val_accuracy30: 0.3859 - val_accuracy50: 0.3749 - 6s/epoch - 21ms/step
Epoch 11/50
282/282 - 6s - loss: 12.8094 - accuracy10: 0.4484 - accuracy20: 0.4315 - accuracy30: 0.4166 - accuracy50: 0.3947 - val_loss: 13.1200 - val_accuracy10: 0.4137 - val_accuracy20: 0.3969 - val_accuracy30: 0.3881 - val_accuracy50: 0.3758 - 6s/epoch - 21ms/step
Epoch 12/50
282/282 - 6s - loss: 12.7926 - accuracy10: 0.4500 - accuracy20: 0.4326 - accuracy30: 0.4184 - accuracy50: 0.3964 - val_loss: 13.1651 - val_accuracy10: 0.4051 - val_accuracy20: 0.3871 - val_accuracy30: 0.3787 - val_accuracy50: 0.3679 - 6s/epoch - 21ms/step
Epoch 13/50
282/282 - 6s - loss: 12.8045 - accuracy10: 0.4499 - accuracy20: 0.4328 - accuracy30: 0.4174 - accuracy50: 0.3967 - val_loss: 13.1073 - val_accuracy10: 0.4130 - val_accuracy20: 0.3939 - val_accuracy30: 0.3835 - val_accuracy50: 0.3643 - 6s/epoch - 21ms/step
Epoch 14/50
282/282 - 6s - loss: 12.7663 - accuracy10: 0.4581 - accuracy20: 0.4373 - accuracy30: 0.4206 - accuracy50: 0.4005 - val_loss: 13.2331 - val_accuracy10: 0.4070 - val_accuracy20: 0.3928 - val_accuracy30: 0.3854 - val_accuracy50: 0.3729 - 6s/epoch - 21ms/step
Epoch 15/50
282/282 - 6s - loss: 12.7605 - accuracy10: 0.4575 - accuracy20: 0.4362 - accuracy30: 0.4193 - accuracy50: 0.3980 - val_loss: 13.2023 - val_accuracy10: 0.4190 - val_accuracy20: 0.4027 - val_accuracy30: 0.3941 - val_accuracy50: 0.3775 - 6s/epoch - 21ms/step
Epoch 16/50
282/282 - 6s - loss: 12.7409 - accuracy10: 0.4603 - accuracy20: 0.4409 - accuracy30: 0.4232 - accuracy50: 0.4003 - val_loss: 13.1562 - val_accuracy10: 0.4173 - val_accuracy20: 0.4011 - val_accuracy30: 0.3888 - val_accuracy50: 0.3805 - 6s/epoch - 21ms/step
Epoch 17/50
282/282 - 6s - loss: 12.7253 - accuracy10: 0.4617 - accuracy20: 0.4440 - accuracy30: 0.4258 - accuracy50: 0.4015 - val_loss: 13.4052 - val_accuracy10: 0.4059 - val_accuracy20: 0.3932 - val_accuracy30: 0.3813 - val_accuracy50: 0.3723 - 6s/epoch - 21ms/step
Epoch 18/50
282/282 - 6s - loss: 12.7207 - accuracy10: 0.4633 - accuracy20: 0.4420 - accuracy30: 0.4241 - accuracy50: 0.4004 - val_loss: 13.4796 - val_accuracy10: 0.4087 - val_accuracy20: 0.3943 - val_accuracy30: 0.3872 - val_accuracy50: 0.3750 - 6s/epoch - 21ms/step
Epoch 19/50
282/282 - 6s - loss: 12.7031 - accuracy10: 0.4641 - accuracy20: 0.4434 - accuracy30: 0.4277 - accuracy50: 0.4037 - val_loss: 13.3043 - val_accuracy10: 0.4104 - val_accuracy20: 0.3962 - val_accuracy30: 0.3897 - val_accuracy50: 0.3766 - 6s/epoch - 21ms/step
Epoch 20/50
282/282 - 6s - loss: 12.6818 - accuracy10: 0.4664 - accuracy20: 0.4448 - accuracy30: 0.4268 - accuracy50: 0.4058 - val_loss: 13.6811 - val_accuracy10: 0.3878 - val_accuracy20: 0.3787 - val_accuracy30: 0.3736 - val_accuracy50: 0.3669 - 6s/epoch - 21ms/step
Epoch 21/50
282/282 - 6s - loss: 12.6714 - accuracy10: 0.4698 - accuracy20: 0.4492 - accuracy30: 0.4302 - accuracy50: 0.4059 - val_loss: 13.4697 - val_accuracy10: 0.4050 - val_accuracy20: 0.3937 - val_accuracy30: 0.3859 - val_accuracy50: 0.3759 - 6s/epoch - 21ms/step
Epoch 22/50
282/282 - 6s - loss: 12.6526 - accuracy10: 0.4718 - accuracy20: 0.4510 - accuracy30: 0.4314 - accuracy50: 0.4075 - val_loss: 13.6952 - val_accuracy10: 0.3946 - val_accuracy20: 0.3825 - val_accuracy30: 0.3765 - val_accuracy50: 0.3643 - 6s/epoch - 21ms/step
Epoch 23/50
282/282 - 6s - loss: 12.6511 - accuracy10: 0.4717 - accuracy20: 0.4502 - accuracy30: 0.4308 - accuracy50: 0.4081 - val_loss: 13.5415 - val_accuracy10: 0.3966 - val_accuracy20: 0.3884 - val_accuracy30: 0.3802 - val_accuracy50: 0.3668 - 6s/epoch - 21ms/step
testing model: results/LILAK/W7/deepLOB_L1/seq2seq
Evaluating performance on  test set...
696/696 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0765663
{'0': {'precision': 0.40779167938154814, 'recall': 0.3035511471189521, 'f1-score': 0.3480336834794687, 'support': 52828}, '1': {'precision': 0.442412615480904, 'recall': 0.4470352090407908, 'f1-score': 0.44471190010531064, 'support': 72737}, '2': {'precision': 0.3629172234766447, 'recall': 0.4512500238736416, 'f1-score': 0.4022918050092796, 'support': 52359}, 'accuracy': 0.4056732087857737, 'macro avg': {'precision': 0.4043738394463656, 'recall': 0.40061212667779483, 'f1-score': 0.3983457961980197, 'support': 177924}, 'weighted avg': {'precision': 0.4087395076246969, 'recall': 0.4056732087857737, 'f1-score': 0.40352358044611303, 'support': 177924}}
[[16036 21178 15614]
 [14359 32516 25862]
 [ 8929 19803 23627]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0814911
{'0': {'precision': 0.40128999908833984, 'recall': 0.321765350877193, 'f1-score': 0.3571544484563269, 'support': 54720}, '1': {'precision': 0.4041080721957701, 'recall': 0.4287854310471435, 'f1-score': 0.41608117544784734, 'support': 68090}, '2': {'precision': 0.3717637540453074, 'recall': 0.4168632289436441, 'f1-score': 0.39302393212104625, 'support': 55114}, 'accuracy': 0.3921786830332052, 'macro avg': {'precision': 0.3923872751098058, 'recall': 0.38913800362266016, 'f1-score': 0.38875318534174014, 'support': 177924}, 'weighted avg': {'precision': 0.39322235857094606, 'recall': 0.3921786830332052, 'f1-score': 0.39081618921951783, 'support': 177924}}
[[17607 21636 15477]
 [15546 29196 23348]
 [10723 21416 22975]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0843426
{'0': {'precision': 0.3787370717517776, 'recall': 0.3476285830830274, 'f1-score': 0.3625166766565479, 'support': 53934}, '1': {'precision': 0.39899620070378106, 'recall': 0.41171790235081374, 'f1-score': 0.4052572372449343, 'support': 69125}, '2': {'precision': 0.36256152458355956, 'recall': 0.3772714845529937, 'f1-score': 0.36977026689056414, 'support': 54865}, 'accuracy': 0.38166857759492817, 'macro avg': {'precision': 0.38009826567970606, 'recall': 0.37887265666227826, 'f1-score': 0.37918139359734876, 'support': 177924}, 'weighted avg': {'precision': 0.3816199930744938, 'recall': 0.38166857759492817, 'f1-score': 0.38135848258976385, 'support': 177924}}
[[18749 20856 14329]
 [18602 28460 22063]
 [12153 22013 20699]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0894828
{'0': {'precision': 0.35764722749919353, 'recall': 0.3695418688196733, 'f1-score': 0.3634972677595628, 'support': 54002}, '1': {'precision': 0.38968905264333165, 'recall': 0.408323827907929, 'f1-score': 0.39878886556122084, 'support': 68382}, '2': {'precision': 0.35846178230376036, 'recall': 0.3257652142599928, 'f1-score': 0.3413322768690928, 'support': 55540}, 'accuracy': 0.3707819068815899, 'macro avg': {'precision': 0.3685993541487618, 'recall': 0.36787697032919836, 'f1-score': 0.3678728033966255, 'support': 177924}, 'weighted avg': {'precision': 0.37021621459959647, 'recall': 0.3707819068815899, 'f1-score': 0.370142051188534, 'support': 177924}}
[[19956 20757 13289]
 [21368 27922 19092]
 [14474 22973 18093]]
Evaluating performance on  train set...
282/282 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0738348
{'0': {'precision': 0.44489437478655414, 'recall': 0.3903848623656835, 'f1-score': 0.41586099963516965, 'support': 23359}, '1': {'precision': 0.40554933817003047, 'recall': 0.4098673946957878, 'f1-score': 0.4076969332531569, 'support': 25640}, '2': {'precision': 0.3978347533807551, 'recall': 0.4426229508196721, 'f1-score': 0.41903546508037787, 'support': 22997}, 'accuracy': 0.4140091116173121, 'macro avg': {'precision': 0.4160928221124465, 'recall': 0.4142917359603811, 'f1-score': 0.4141977993229015, 'support': 71996}, 'weighted avg': {'precision': 0.415850582738151, 'recall': 0.4140091116173121, 'f1-score': 0.4139675127721307, 'support': 71996}}
[[ 9119  7391  6849]
 [ 6573 10509  8558]
 [ 4805  8013 10179]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0809529
{'0': {'precision': 0.4359869333691323, 'recall': 0.40207164080554636, 'f1-score': 0.41834303012086993, 'support': 24232}, '1': {'precision': 0.37052087181381604, 'recall': 0.3745487739097963, 'f1-score': 0.3725239352921757, 'support': 24101}, '2': {'precision': 0.39610851854781304, 'recall': 0.42327684570849006, 'f1-score': 0.4092422725694089, 'support': 23663}, 'accuracy': 0.39982776820934496, 'macro avg': {'precision': 0.4008721079102538, 'recall': 0.3999657534746109, 'f1-score': 0.4000364126608182, 'support': 71996}, 'weighted avg': {'precision': 0.4009649810459261, 'recall': 0.39982776820934496, 'f1-score': 0.4000137169589362, 'support': 71996}}
[[ 9743  7338  7151]
 [ 6955  9027  8119]
 [ 5649  7998 10016]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0851607
{'0': {'precision': 0.41671088615861873, 'recall': 0.4168640261331156, 'f1-score': 0.416787442078834, 'support': 24490}, '1': {'precision': 0.35506708036533674, 'recall': 0.3430296377607025, 'f1-score': 0.3489445768644377, 'support': 23686}, '2': {'precision': 0.3912001300073129, 'recall': 0.40424013434089, 'f1-score': 0.39761324689267874, 'support': 23820}, 'accuracy': 0.38839657758764373, 'macro avg': {'precision': 0.3876593655104228, 'recall': 0.3880445994115694, 'f1-score': 0.38778175527865016, 'support': 71996}, 'weighted avg': {'precision': 0.3879903823036298, 'recall': 0.38839657758764373, 'f1-score': 0.38812396862471976, 'support': 71996}}
[[10209  7077  7204]
 [ 7780  8125  7781]
 [ 6510  7681  9629]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0912844
{'0': {'precision': 0.3972592481653437, 'recall': 0.4305831743841565, 'f1-score': 0.41325050147033043, 'support': 24641}, '1': {'precision': 0.3439981638742254, 'recall': 0.3143324524977979, 'f1-score': 0.32849690965677464, 'support': 23841}, '2': {'precision': 0.37412245245287834, 'recall': 0.3739474355702985, 'f1-score': 0.37403492353829465, 'support': 23514}, 'accuracy': 0.3735901994555253, 'macro avg': {'precision': 0.3717932881641491, 'recall': 0.37295435415075096, 'f1-score': 0.3719274448884666, 'support': 71996}, 'weighted avg': {'precision': 0.3720656801203487, 'recall': 0.3735901994555253, 'f1-score': 0.37237704347376294, 'support': 71996}}
[[10610  6913  7118]
 [ 8755  7494  7592]
 [ 7343  7378  8793]]
Evaluating performance on  val set...
73/73 - 1s - 630ms/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0778614
{'0': {'precision': 0.41343370005790386, 'recall': 0.4866246379280968, 'f1-score': 0.44705329889645457, 'support': 5869}, '1': {'precision': 0.40341053703232377, 'recall': 0.49215960254618846, 'f1-score': 0.44338764948597803, 'support': 6441}, '2': {'precision': 0.43319080705505075, 'recall': 0.26153597934817685, 'f1-score': 0.3261569416498994, 'support': 6198}, 'accuracy': 0.4131726820834234, 'macro avg': {'precision': 0.41667834804842613, 'recall': 0.41344007327415405, 'f1-score': 0.40553263001077733, 'support': 18508}, 'weighted avg': {'precision': 0.41656182606398534, 'recall': 0.4131726820834234, 'f1-score': 0.4052915704510781, 'support': 18508}}
[[2856 2063  950]
 [2100 3170 1171]
 [1952 2625 1621]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0881224
{'0': {'precision': 0.41334214002642006, 'recall': 0.5045960328979197, 'f1-score': 0.4544332292498729, 'support': 6201}, '1': {'precision': 0.3573051731051998, 'recall': 0.45220774826594484, 'f1-score': 0.39919354838709675, 'support': 5911}, '2': {'precision': 0.42956320509111945, 'recall': 0.2321763602251407, 'f1-score': 0.3014310362326195, 'support': 6396}, 'accuracy': 0.39372163388804843, 'macro avg': {'precision': 0.40007017274091305, 'recall': 0.3963267137963351, 'f1-score': 0.3850192712898631, 'support': 18508}, 'weighted avg': {'precision': 0.40105099137083783, 'recall': 0.39372163388804843, 'f1-score': 0.38391649161651314, 'support': 18508}}
[[3129 2155  917]
 [2183 2673 1055]
 [2258 2653 1485]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.092177
{'0': {'precision': 0.4053430479659988, 'recall': 0.5248427672955975, 'f1-score': 0.457416923603974, 'support': 6360}, '1': {'precision': 0.3317555338994849, 'recall': 0.4234938688466323, 'f1-score': 0.3720530835284934, 'support': 5627}, '2': {'precision': 0.43333333333333335, 'recall': 0.2053366048152124, 'f1-score': 0.27863905941109146, 'support': 6521}, 'accuracy': 0.38145666738707584, 'macro avg': {'precision': 0.39014397173293897, 'recall': 0.3845577469858141, 'f1-score': 0.369369688847853, 'support': 18508}, 'weighted avg': {'precision': 0.3928321180561282, 'recall': 0.38145666738707584, 'f1-score': 0.3684741539634663, 'support': 18508}}
[[3338 2192  830]
 [2323 2383  921]
 [2574 2608 1339]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0995165
{'0': {'precision': 0.3834290217268941, 'recall': 0.5350298460571787, 'f1-score': 0.44671781756180734, 'support': 6366}, '1': {'precision': 0.31681286549707605, 'recall': 0.38524444444444444, 'f1-score': 0.3476935419173686, 'support': 5625}, '2': {'precision': 0.42621184919210053, 'recall': 0.1821390210219426, 'f1-score': 0.2552139324876371, 'support': 6517}, 'accuracy': 0.3652474605575967, 'macro avg': {'precision': 0.3754845788053569, 'recall': 0.36747110384118864, 'f1-score': 0.349875097322271, 'support': 18508}, 'weighted avg': {'precision': 0.3782474682255986, 'recall': 0.3652474605575967, 'f1-score': 0.3491901338829476, 'support': 18508}}
[[3406 2197  763]
 [2623 2167  835]
 [2854 2476 1187]]
training model: results/LILAK/W7/deepOF_L1/seq2seq
Epoch 1/50
282/282 - 11s - loss: 13.2463 - accuracy10: 0.3727 - accuracy20: 0.3615 - accuracy30: 0.3497 - accuracy50: 0.3396 - val_loss: 13.1960 - val_accuracy10: 0.3722 - val_accuracy20: 0.3640 - val_accuracy30: 0.3622 - val_accuracy50: 0.3544 - 11s/epoch - 39ms/step
Epoch 2/50
282/282 - 6s - loss: 13.1485 - accuracy10: 0.3906 - accuracy20: 0.3702 - accuracy30: 0.3592 - accuracy50: 0.3490 - val_loss: 13.1670 - val_accuracy10: 0.3783 - val_accuracy20: 0.3687 - val_accuracy30: 0.3648 - val_accuracy50: 0.3615 - 6s/epoch - 20ms/step
Epoch 3/50
282/282 - 5s - loss: 13.1171 - accuracy10: 0.3984 - accuracy20: 0.3747 - accuracy30: 0.3615 - accuracy50: 0.3505 - val_loss: 13.1278 - val_accuracy10: 0.3871 - val_accuracy20: 0.3717 - val_accuracy30: 0.3667 - val_accuracy50: 0.3644 - 5s/epoch - 19ms/step
Epoch 4/50
282/282 - 5s - loss: 13.0878 - accuracy10: 0.4043 - accuracy20: 0.3814 - accuracy30: 0.3663 - accuracy50: 0.3523 - val_loss: 13.1154 - val_accuracy10: 0.3910 - val_accuracy20: 0.3734 - val_accuracy30: 0.3748 - val_accuracy50: 0.3674 - 5s/epoch - 19ms/step
Epoch 5/50
282/282 - 5s - loss: 13.0655 - accuracy10: 0.4124 - accuracy20: 0.3846 - accuracy30: 0.3694 - accuracy50: 0.3535 - val_loss: 13.1054 - val_accuracy10: 0.3936 - val_accuracy20: 0.3769 - val_accuracy30: 0.3750 - val_accuracy50: 0.3655 - 5s/epoch - 19ms/step
Epoch 6/50
282/282 - 5s - loss: 13.0476 - accuracy10: 0.4159 - accuracy20: 0.3879 - accuracy30: 0.3692 - accuracy50: 0.3560 - val_loss: 13.0862 - val_accuracy10: 0.3906 - val_accuracy20: 0.3744 - val_accuracy30: 0.3733 - val_accuracy50: 0.3688 - 5s/epoch - 19ms/step
Epoch 7/50
282/282 - 5s - loss: 13.0313 - accuracy10: 0.4198 - accuracy20: 0.3910 - accuracy30: 0.3729 - accuracy50: 0.3574 - val_loss: 13.0997 - val_accuracy10: 0.3919 - val_accuracy20: 0.3788 - val_accuracy30: 0.3752 - val_accuracy50: 0.3691 - 5s/epoch - 19ms/step
Epoch 8/50
282/282 - 5s - loss: 13.0197 - accuracy10: 0.4242 - accuracy20: 0.3943 - accuracy30: 0.3771 - accuracy50: 0.3614 - val_loss: 13.0938 - val_accuracy10: 0.3945 - val_accuracy20: 0.3812 - val_accuracy30: 0.3746 - val_accuracy50: 0.3708 - 5s/epoch - 19ms/step
Epoch 9/50
282/282 - 5s - loss: 13.0010 - accuracy10: 0.4242 - accuracy20: 0.3958 - accuracy30: 0.3793 - accuracy50: 0.3633 - val_loss: 13.1026 - val_accuracy10: 0.3979 - val_accuracy20: 0.3793 - val_accuracy30: 0.3745 - val_accuracy50: 0.3685 - 5s/epoch - 19ms/step
Epoch 10/50
282/282 - 5s - loss: 12.9889 - accuracy10: 0.4281 - accuracy20: 0.3986 - accuracy30: 0.3804 - accuracy50: 0.3647 - val_loss: 13.1000 - val_accuracy10: 0.3976 - val_accuracy20: 0.3792 - val_accuracy30: 0.3772 - val_accuracy50: 0.3724 - 5s/epoch - 19ms/step
Epoch 11/50
282/282 - 5s - loss: 12.9812 - accuracy10: 0.4286 - accuracy20: 0.4007 - accuracy30: 0.3829 - accuracy50: 0.3664 - val_loss: 13.0972 - val_accuracy10: 0.3988 - val_accuracy20: 0.3825 - val_accuracy30: 0.3775 - val_accuracy50: 0.3711 - 5s/epoch - 19ms/step
Epoch 12/50
282/282 - 6s - loss: 12.9720 - accuracy10: 0.4304 - accuracy20: 0.4022 - accuracy30: 0.3848 - accuracy50: 0.3665 - val_loss: 13.0997 - val_accuracy10: 0.4013 - val_accuracy20: 0.3878 - val_accuracy30: 0.3796 - val_accuracy50: 0.3712 - 6s/epoch - 20ms/step
Epoch 13/50
282/282 - 6s - loss: 12.9550 - accuracy10: 0.4334 - accuracy20: 0.4043 - accuracy30: 0.3858 - accuracy50: 0.3702 - val_loss: 13.0892 - val_accuracy10: 0.4038 - val_accuracy20: 0.3882 - val_accuracy30: 0.3830 - val_accuracy50: 0.3708 - 6s/epoch - 20ms/step
Epoch 14/50
282/282 - 6s - loss: 12.9464 - accuracy10: 0.4357 - accuracy20: 0.4056 - accuracy30: 0.3880 - accuracy50: 0.3709 - val_loss: 13.0808 - val_accuracy10: 0.4085 - val_accuracy20: 0.3893 - val_accuracy30: 0.3819 - val_accuracy50: 0.3693 - 6s/epoch - 20ms/step
Epoch 15/50
282/282 - 5s - loss: 12.9307 - accuracy10: 0.4391 - accuracy20: 0.4128 - accuracy30: 0.3907 - accuracy50: 0.3739 - val_loss: 13.0819 - val_accuracy10: 0.4037 - val_accuracy20: 0.3882 - val_accuracy30: 0.3819 - val_accuracy50: 0.3726 - 5s/epoch - 19ms/step
Epoch 16/50
282/282 - 5s - loss: 12.9125 - accuracy10: 0.4394 - accuracy20: 0.4135 - accuracy30: 0.3916 - accuracy50: 0.3756 - val_loss: 13.0945 - val_accuracy10: 0.4061 - val_accuracy20: 0.3871 - val_accuracy30: 0.3805 - val_accuracy50: 0.3730 - 5s/epoch - 19ms/step
Epoch 17/50
282/282 - 5s - loss: 12.9040 - accuracy10: 0.4428 - accuracy20: 0.4158 - accuracy30: 0.3958 - accuracy50: 0.3779 - val_loss: 13.0917 - val_accuracy10: 0.4038 - val_accuracy20: 0.3886 - val_accuracy30: 0.3825 - val_accuracy50: 0.3757 - 5s/epoch - 19ms/step
Epoch 18/50
282/282 - 5s - loss: 12.8898 - accuracy10: 0.4417 - accuracy20: 0.4143 - accuracy30: 0.3956 - accuracy50: 0.3774 - val_loss: 13.0988 - val_accuracy10: 0.4037 - val_accuracy20: 0.3873 - val_accuracy30: 0.3817 - val_accuracy50: 0.3766 - 5s/epoch - 19ms/step
Epoch 19/50
282/282 - 5s - loss: 12.8716 - accuracy10: 0.4444 - accuracy20: 0.4189 - accuracy30: 0.4000 - accuracy50: 0.3804 - val_loss: 13.0935 - val_accuracy10: 0.4050 - val_accuracy20: 0.3903 - val_accuracy30: 0.3837 - val_accuracy50: 0.3790 - 5s/epoch - 19ms/step
Epoch 20/50
282/282 - 5s - loss: 12.8590 - accuracy10: 0.4479 - accuracy20: 0.4235 - accuracy30: 0.4019 - accuracy50: 0.3828 - val_loss: 13.1026 - val_accuracy10: 0.4059 - val_accuracy20: 0.3897 - val_accuracy30: 0.3843 - val_accuracy50: 0.3783 - 5s/epoch - 19ms/step
Epoch 21/50
282/282 - 6s - loss: 12.8443 - accuracy10: 0.4484 - accuracy20: 0.4230 - accuracy30: 0.4042 - accuracy50: 0.3844 - val_loss: 13.0985 - val_accuracy10: 0.4078 - val_accuracy20: 0.3923 - val_accuracy30: 0.3889 - val_accuracy50: 0.3785 - 6s/epoch - 20ms/step
Epoch 22/50
282/282 - 6s - loss: 12.8353 - accuracy10: 0.4507 - accuracy20: 0.4255 - accuracy30: 0.4060 - accuracy50: 0.3868 - val_loss: 13.1074 - val_accuracy10: 0.4044 - val_accuracy20: 0.3899 - val_accuracy30: 0.3820 - val_accuracy50: 0.3745 - 6s/epoch - 20ms/step
Epoch 23/50
282/282 - 6s - loss: 12.8185 - accuracy10: 0.4527 - accuracy20: 0.4296 - accuracy30: 0.4064 - accuracy50: 0.3872 - val_loss: 13.1066 - val_accuracy10: 0.4061 - val_accuracy20: 0.3911 - val_accuracy30: 0.3856 - val_accuracy50: 0.3775 - 6s/epoch - 20ms/step
Epoch 24/50
282/282 - 6s - loss: 12.7987 - accuracy10: 0.4534 - accuracy20: 0.4314 - accuracy30: 0.4100 - accuracy50: 0.3904 - val_loss: 13.1261 - val_accuracy10: 0.3992 - val_accuracy20: 0.3878 - val_accuracy30: 0.3837 - val_accuracy50: 0.3772 - 6s/epoch - 20ms/step
testing model: results/LILAK/W7/deepOF_L1/seq2seq
Evaluating performance on  test set...
695/695 - 7s - 7s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0579549
{'0': {'precision': 0.4069525395503747, 'recall': 0.3700829137167304, 'f1-score': 0.3876430115202348, 'support': 52826}, '1': {'precision': 0.5167788814079062, 'recall': 0.5328924756313843, 'f1-score': 0.5247119979423589, 'support': 72737}, '2': {'precision': 0.39428508947771257, 'recall': 0.4132477652991061, 'f1-score': 0.4035437843886972, 'support': 52356}, 'accuracy': 0.4493449266239131, 'macro avg': {'precision': 0.43933883681199787, 'recall': 0.43874105154907356, 'f1-score': 0.43863293128376357, 'support': 177919}, 'weighted avg': {'precision': 0.4481242053740752, 'recall': 0.4493449266239131, 'f1-score': 0.44835877391597256, 'support': 177919}}
[[19550 18296 14980]
 [15718 38761 18258]
 [12772 17948 21636]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0790577
{'0': {'precision': 0.38582985117638585, 'recall': 0.34255637998464855, 'f1-score': 0.36290767577614497, 'support': 54718}, '1': {'precision': 0.4662999274928281, 'recall': 0.43447546593429187, 'f1-score': 0.44982551641818275, 'support': 68089}, '2': {'precision': 0.3752731577030472, 'recall': 0.4487044563797358, 'f1-score': 0.4087167790559302, 'support': 55112}, 'accuracy': 0.41061381864781166, 'macro avg': {'precision': 0.4091343121240871, 'recall': 0.40857876743289206, 'f1-score': 0.4071499904167526, 'support': 177919}, 'weighted avg': {'precision': 0.4133554472937629, 'recall': 0.41061381864781166, 'f1-score': 0.4103606186964133, 'support': 177919}}
[[18744 17180 18794]
 [16133 29583 22373]
 [13704 16679 24729]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0892097
{'0': {'precision': 0.35767694957720014, 'recall': 0.3388155455017429, 'f1-score': 0.3479908588840221, 'support': 53932}, '1': {'precision': 0.46324661988704435, 'recall': 0.31326312134714424, 'f1-score': 0.37377015224220667, 'support': 69124}, '2': {'precision': 0.3529286900495711, 'recall': 0.5151923883127062, 'f1-score': 0.418895887365691, 'support': 54863}, 'accuracy': 0.38327553549648996, 'macro avg': {'precision': 0.3912840865046052, 'recall': 0.38909035172053114, 'f1-score': 0.3802189661639732, 'support': 177919}, 'weighted avg': {'precision': 0.3972280606335424, 'recall': 0.38327553549648996, 'f1-score': 0.3798707056214754, 'support': 177919}}
[[18273 12744 22915]
 [18563 21654 28907]
 [14252 12346 28265]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0971947
{'0': {'precision': 0.33843823628407943, 'recall': 0.33515425354616496, 'f1-score': 0.33678823967249727, 'support': 54002}, '1': {'precision': 0.43274502175220175, 'recall': 0.17892920341040378, 'f1-score': 0.25317634399702027, 'support': 68379}, '2': {'precision': 0.335652191997338, 'recall': 0.5812056609888725, 'f1-score': 0.4255467812743069, 'support': 55538}, 'accuracy': 0.3519185696862055, 'macro avg': {'precision': 0.36894515001120637, 'recall': 0.3650963726484804, 'f1-score': 0.3385037883146082, 'support': 177919}, 'weighted avg': {'precision': 0.37381316732532677, 'recall': 0.3519185696862055, 'f1-score': 0.3323602363062905, 'support': 177919}}
[[18099  7861 28042]
 [20297 12235 35847]
 [15082  8177 32279]]
Evaluating performance on  train set...
282/282 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0627172
{'0': {'precision': 0.432667789271109, 'recall': 0.38356222809860957, 'f1-score': 0.40663787841106913, 'support': 23446}, '1': {'precision': 0.45541436261764384, 'recall': 0.48513692751813997, 'f1-score': 0.46980601046447934, 'support': 25634}, '2': {'precision': 0.40825035561877665, 'recall': 0.4258531901894039, 'f1-score': 0.416866028708134, 'support': 22914}, 'accuracy': 0.43318887685084867, 'macro avg': {'precision': 0.43211083583584314, 'recall': 0.43151744860205116, 'f1-score': 0.43110330586122747, 'support': 71994}, 'weighted avg': {'precision': 0.43299538027113027, 'recall': 0.43318887685084867, 'f1-score': 0.43238474249646597, 'support': 71994}}
[[ 8993  7551  6902]
 [ 5956 12436  7242]
 [ 5836  7320  9758]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0774045
{'0': {'precision': 0.4185780363358924, 'recall': 0.361815259057747, 'f1-score': 0.3881322957198443, 'support': 24261}, '1': {'precision': 0.41189779079052435, 'recall': 0.3845994532350261, 'f1-score': 0.39778082426527295, 'support': 24142}, '2': {'precision': 0.3957375092166708, 'recall': 0.4777669450214065, 'f1-score': 0.43290059917037954, 'support': 23591}, 'accuracy': 0.4074506208850738, 'macro avg': {'precision': 0.4087377787810292, 'recall': 0.4080605524380599, 'f1-score': 0.40627123971849893, 'support': 71994}, 'weighted avg': {'precision': 0.40885354036086896, 'recall': 0.4074506208850738, 'f1-score': 0.4060374520223877, 'support': 71994}}
[[ 8778  6883  8600]
 [ 6247  9285  8610]
 [ 5946  6374 11271]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0860451
{'0': {'precision': 0.40743453579930416, 'recall': 0.3633839621100768, 'f1-score': 0.38415055248618785, 'support': 24492}, '1': {'precision': 0.38985766220962476, 'recall': 0.2666582374510052, 'f1-score': 0.31669836820502556, 'support': 23727}, '2': {'precision': 0.379086701453377, 'recall': 0.5408622502628812, 'f1-score': 0.44575013865779256, 'support': 23775}, 'accuracy': 0.3901158429869156, 'macro avg': {'precision': 0.39212629982076863, 'recall': 0.39030148327465436, 'f1-score': 0.3821996864496686, 'support': 71994}, 'weighted avg': {'precision': 0.39228026959327666, 'recall': 0.3901158429869156, 'f1-score': 0.38226278662779356, 'support': 71994}}
[[ 8900  5209 10383]
 [ 6721  6327 10679]
 [ 6223  4693 12859]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0931771
{'0': {'precision': 0.3910579059538385, 'recall': 0.35054060645475976, 'f1-score': 0.3696924231057765, 'support': 24602}, '1': {'precision': 0.3688064192577733, 'recall': 0.15381075880532083, 'f1-score': 0.2170858424843547, 'support': 23906}, '2': {'precision': 0.3567836681594156, 'recall': 0.6072128076300775, 'f1-score': 0.4494697196526782, 'support': 23486}, 'accuracy': 0.368947412284357, 'macro avg': {'precision': 0.3722159977903425, 'recall': 0.37052139096338604, 'f1-score': 0.3454159950809365, 'support': 71994}, 'weighted avg': {'precision': 0.37248818084069085, 'recall': 0.368947412284357, 'f1-score': 0.3450436561302622, 'support': 71994}}
[[ 8624  3334 12644]
 [ 7163  3677 13066]
 [ 6266  2959 14261]]
Evaluating performance on  val set...
73/73 - 1s - 603ms/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0816076
{'0': {'precision': 0.38985793921956485, 'recall': 0.3703450632046464, 'f1-score': 0.3798510731493649, 'support': 5854}, '1': {'precision': 0.4248426224474129, 'recall': 0.42859355638166047, 'f1-score': 0.4267098465571748, 'support': 6456}, '2': {'precision': 0.40969847684177807, 'recall': 0.42529848338173604, 'f1-score': 0.4173527549081697, 'support': 6198}, 'accuracy': 0.409066349686622, 'macro avg': {'precision': 0.4081330128362519, 'recall': 0.408079034322681, 'f1-score': 0.40797122487156984, 'support': 18508}, 'weighted avg': {'precision': 0.4087056141223887, 'recall': 0.409066349686622, 'f1-score': 0.40875509652638525, 'support': 18508}}
[[2168 1841 1845]
 [1736 2767 1953]
 [1657 1905 2636]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0899451
{'0': {'precision': 0.39351851851851855, 'recall': 0.3588244844942361, 'f1-score': 0.3753715498938429, 'support': 6159}, '1': {'precision': 0.37927774626583477, 'recall': 0.33833698768763704, 'f1-score': 0.35763950793367805, 'support': 5929}, '2': {'precision': 0.3999736945942391, 'recall': 0.47367601246105917, 'f1-score': 0.4337160379376738, 'support': 6420}, 'accuracy': 0.3921007132051005, 'macro avg': {'precision': 0.39092331979286415, 'recall': 0.390279161547644, 'f1-score': 0.3889090319217316, 'support': 18508}, 'weighted avg': {'precision': 0.39119566849258186, 'recall': 0.3921007132051005, 'f1-score': 0.38992948897205654, 'support': 18508}}
[[2210 1658 2291]
 [1652 2006 2271]
 [1754 1625 3041]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0911288
{'0': {'precision': 0.389326334208224, 'recall': 0.3495679497250589, 'f1-score': 0.36837748344370863, 'support': 6365}, '1': {'precision': 0.3576089793787523, 'recall': 0.24525599713569637, 'f1-score': 0.2909631517468408, 'support': 5586}, '2': {'precision': 0.39064940861414865, 'recall': 0.5339332011590666, 'f1-score': 0.451188865261937, 'support': 6557}, 'accuracy': 0.38340177220661337, 'macro avg': {'precision': 0.37919490740037504, 'recall': 0.376252382673274, 'f1-score': 0.3701765001508288, 'support': 18508}, 'weighted avg': {'precision': 0.38022228486751836, 'recall': 0.38340177220661337, 'f1-score': 0.3743509961800075, 'support': 18508}}
[[2225 1270 2870]
 [1625 1370 2591]
 [1865 1191 3501]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0953218
{'0': {'precision': 0.3867153538515041, 'recall': 0.350788643533123, 'f1-score': 0.3678769332561409, 'support': 6340}, '1': {'precision': 0.3489736070381232, 'recall': 0.14759036144578314, 'f1-score': 0.2074461461835388, 'support': 5644}, '2': {'precision': 0.37444551591128256, 'recall': 0.5951870018393624, 'f1-score': 0.4596898307091275, 'support': 6524}, 'accuracy': 0.3749729846552842, 'macro avg': {'precision': 0.3700448256003033, 'recall': 0.36452200227275616, 'f1-score': 0.34500430338293575, 'support': 18508}, 'weighted avg': {'precision': 0.3708809664656857, 'recall': 0.3749729846552842, 'f1-score': 0.35131739039605436, 'support': 18508}}
[[2224  777 3339]
 [1663  833 3148]
 [1864  777 3883]]
training model: results/LILAK/W7/deepLOB_L2/seq2seq
Epoch 1/50
282/282 - 18s - loss: 13.3119 - accuracy10: 0.3420 - accuracy20: 0.3456 - accuracy30: 0.3468 - accuracy50: 0.3445 - val_loss: 13.5571 - val_accuracy10: 0.3428 - val_accuracy20: 0.3273 - val_accuracy30: 0.3195 - val_accuracy50: 0.3190 - 18s/epoch - 65ms/step
Epoch 2/50
282/282 - 13s - loss: 13.2090 - accuracy10: 0.3543 - accuracy20: 0.3543 - accuracy30: 0.3548 - accuracy50: 0.3532 - val_loss: 13.4163 - val_accuracy10: 0.3453 - val_accuracy20: 0.3379 - val_accuracy30: 0.3328 - val_accuracy50: 0.3299 - 13s/epoch - 45ms/step
Epoch 3/50
282/282 - 13s - loss: 13.1489 - accuracy10: 0.3689 - accuracy20: 0.3671 - accuracy30: 0.3624 - accuracy50: 0.3580 - val_loss: 13.6813 - val_accuracy10: 0.3312 - val_accuracy20: 0.3407 - val_accuracy30: 0.3457 - val_accuracy50: 0.3472 - 13s/epoch - 45ms/step
Epoch 4/50
282/282 - 13s - loss: 13.0471 - accuracy10: 0.3906 - accuracy20: 0.3906 - accuracy30: 0.3852 - accuracy50: 0.3733 - val_loss: 13.6159 - val_accuracy10: 0.3609 - val_accuracy20: 0.3689 - val_accuracy30: 0.3696 - val_accuracy50: 0.3629 - 13s/epoch - 45ms/step
Epoch 5/50
282/282 - 13s - loss: 12.9645 - accuracy10: 0.4100 - accuracy20: 0.4063 - accuracy30: 0.3967 - accuracy50: 0.3851 - val_loss: 13.6809 - val_accuracy10: 0.3756 - val_accuracy20: 0.3788 - val_accuracy30: 0.3755 - val_accuracy50: 0.3677 - 13s/epoch - 45ms/step
Epoch 6/50
282/282 - 13s - loss: 12.8793 - accuracy10: 0.4293 - accuracy20: 0.4229 - accuracy30: 0.4130 - accuracy50: 0.3942 - val_loss: 13.6275 - val_accuracy10: 0.3839 - val_accuracy20: 0.3790 - val_accuracy30: 0.3705 - val_accuracy50: 0.3679 - 13s/epoch - 45ms/step
Epoch 7/50
282/282 - 13s - loss: 12.7947 - accuracy10: 0.4455 - accuracy20: 0.4351 - accuracy30: 0.4205 - accuracy50: 0.4003 - val_loss: 13.2289 - val_accuracy10: 0.3970 - val_accuracy20: 0.3889 - val_accuracy30: 0.3786 - val_accuracy50: 0.3677 - 13s/epoch - 45ms/step
Epoch 8/50
282/282 - 13s - loss: 12.7369 - accuracy10: 0.4545 - accuracy20: 0.4417 - accuracy30: 0.4269 - accuracy50: 0.4040 - val_loss: 13.3149 - val_accuracy10: 0.4067 - val_accuracy20: 0.3959 - val_accuracy30: 0.3900 - val_accuracy50: 0.3785 - 13s/epoch - 45ms/step
Epoch 9/50
282/282 - 13s - loss: 12.6835 - accuracy10: 0.4635 - accuracy20: 0.4479 - accuracy30: 0.4318 - accuracy50: 0.4087 - val_loss: 13.1341 - val_accuracy10: 0.4136 - val_accuracy20: 0.3961 - val_accuracy30: 0.3856 - val_accuracy50: 0.3718 - 13s/epoch - 45ms/step
Epoch 10/50
282/282 - 13s - loss: 12.6444 - accuracy10: 0.4714 - accuracy20: 0.4541 - accuracy30: 0.4362 - accuracy50: 0.4125 - val_loss: 13.1620 - val_accuracy10: 0.4121 - val_accuracy20: 0.3910 - val_accuracy30: 0.3836 - val_accuracy50: 0.3702 - 13s/epoch - 45ms/step
Epoch 11/50
282/282 - 13s - loss: 12.6180 - accuracy10: 0.4730 - accuracy20: 0.4564 - accuracy30: 0.4392 - accuracy50: 0.4150 - val_loss: 13.1547 - val_accuracy10: 0.4215 - val_accuracy20: 0.4026 - val_accuracy30: 0.3884 - val_accuracy50: 0.3690 - 13s/epoch - 45ms/step
Epoch 12/50
282/282 - 13s - loss: 12.5705 - accuracy10: 0.4786 - accuracy20: 0.4615 - accuracy30: 0.4441 - accuracy50: 0.4173 - val_loss: 13.1162 - val_accuracy10: 0.4268 - val_accuracy20: 0.4089 - val_accuracy30: 0.3973 - val_accuracy50: 0.3742 - 13s/epoch - 45ms/step
Epoch 13/50
282/282 - 13s - loss: 12.5358 - accuracy10: 0.4823 - accuracy20: 0.4665 - accuracy30: 0.4476 - accuracy50: 0.4221 - val_loss: 13.1887 - val_accuracy10: 0.4120 - val_accuracy20: 0.3952 - val_accuracy30: 0.3837 - val_accuracy50: 0.3667 - 13s/epoch - 45ms/step
Epoch 14/50
282/282 - 13s - loss: 12.5022 - accuracy10: 0.4835 - accuracy20: 0.4683 - accuracy30: 0.4513 - accuracy50: 0.4256 - val_loss: 13.2629 - val_accuracy10: 0.4211 - val_accuracy20: 0.3966 - val_accuracy30: 0.3855 - val_accuracy50: 0.3676 - 13s/epoch - 45ms/step
Epoch 15/50
282/282 - 13s - loss: 12.4644 - accuracy10: 0.4885 - accuracy20: 0.4712 - accuracy30: 0.4552 - accuracy50: 0.4281 - val_loss: 13.2547 - val_accuracy10: 0.4251 - val_accuracy20: 0.4021 - val_accuracy30: 0.3888 - val_accuracy50: 0.3657 - 13s/epoch - 45ms/step
Epoch 16/50
282/282 - 13s - loss: 12.4201 - accuracy10: 0.4931 - accuracy20: 0.4773 - accuracy30: 0.4587 - accuracy50: 0.4315 - val_loss: 13.2552 - val_accuracy10: 0.4261 - val_accuracy20: 0.3984 - val_accuracy30: 0.3835 - val_accuracy50: 0.3617 - 13s/epoch - 45ms/step
Epoch 17/50
282/282 - 13s - loss: 12.3852 - accuracy10: 0.4962 - accuracy20: 0.4793 - accuracy30: 0.4621 - accuracy50: 0.4322 - val_loss: 13.5048 - val_accuracy10: 0.4049 - val_accuracy20: 0.3778 - val_accuracy30: 0.3630 - val_accuracy50: 0.3476 - 13s/epoch - 45ms/step
Epoch 18/50
282/282 - 13s - loss: 12.3525 - accuracy10: 0.4963 - accuracy20: 0.4821 - accuracy30: 0.4635 - accuracy50: 0.4349 - val_loss: 13.4610 - val_accuracy10: 0.4220 - val_accuracy20: 0.3936 - val_accuracy30: 0.3781 - val_accuracy50: 0.3550 - 13s/epoch - 45ms/step
Epoch 19/50
282/282 - 13s - loss: 12.3049 - accuracy10: 0.5027 - accuracy20: 0.4872 - accuracy30: 0.4700 - accuracy50: 0.4406 - val_loss: 13.5647 - val_accuracy10: 0.4112 - val_accuracy20: 0.3809 - val_accuracy30: 0.3608 - val_accuracy50: 0.3457 - 13s/epoch - 45ms/step
Epoch 20/50
282/282 - 13s - loss: 12.2684 - accuracy10: 0.5055 - accuracy20: 0.4921 - accuracy30: 0.4737 - accuracy50: 0.4440 - val_loss: 13.5643 - val_accuracy10: 0.4165 - val_accuracy20: 0.3878 - val_accuracy30: 0.3742 - val_accuracy50: 0.3537 - 13s/epoch - 45ms/step
Epoch 21/50
282/282 - 13s - loss: 12.2205 - accuracy10: 0.5062 - accuracy20: 0.4935 - accuracy30: 0.4779 - accuracy50: 0.4476 - val_loss: 13.5370 - val_accuracy10: 0.4172 - val_accuracy20: 0.3919 - val_accuracy30: 0.3766 - val_accuracy50: 0.3573 - 13s/epoch - 45ms/step
Epoch 22/50
282/282 - 13s - loss: 12.1821 - accuracy10: 0.5101 - accuracy20: 0.4972 - accuracy30: 0.4800 - accuracy50: 0.4516 - val_loss: 13.4450 - val_accuracy10: 0.4178 - val_accuracy20: 0.3982 - val_accuracy30: 0.3841 - val_accuracy50: 0.3621 - 13s/epoch - 46ms/step
testing model: results/LILAK/W7/deepLOB_L2/seq2seq
Evaluating performance on  test set...
696/696 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0898284
{'0': {'precision': 0.412305957080526, 'recall': 0.26294767926099794, 'f1-score': 0.32110865821380274, 'support': 52828}, '1': {'precision': 0.43937461277743356, 'recall': 0.3314956624551466, 'f1-score': 0.37788661207538293, 'support': 72737}, '2': {'precision': 0.3604498908846735, 'recall': 0.6151377986592563, 'f1-score': 0.4545493035268216, 'support': 52359}, 'accuracy': 0.3946123063780041, 'macro avg': {'precision': 0.40404348691421105, 'recall': 0.40319371345846694, 'f1-score': 0.3845148579386691, 'support': 177924}, 'weighted avg': {'precision': 0.4081118126114118, 'recall': 0.3946123063780041, 'f1-score': 0.38358857535805596, 'support': 177924}}
[[13891 16972 21965]
 [13443 24112 35182]
 [ 6357 13794 32208]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.092646
{'0': {'precision': 0.40752460209473784, 'recall': 0.23536184210526315, 'f1-score': 0.2983909270993826, 'support': 54720}, '1': {'precision': 0.40626417049944935, 'recall': 0.36842414451461303, 'f1-score': 0.38642000030807616, 'support': 68090}, '2': {'precision': 0.3747176995022052, 'recall': 0.5750081648945822, 'f1-score': 0.45374301116066634, 'support': 55114}, 'accuracy': 0.3914929970099593, 'macro avg': {'precision': 0.39616882403213083, 'recall': 0.39293138383815274, 'f1-score': 0.3795179795227084, 'support': 177924}, 'weighted avg': {'precision': 0.3968799312419691, 'recall': 0.3914929970099593, 'f1-score': 0.3802009940703001, 'support': 177924}}
[[12879 20029 21812]
 [11934 25086 31070]
 [ 6790 16633 31691]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0939841
{'0': {'precision': 0.37980507088331517, 'recall': 0.20664145066192013, 'f1-score': 0.2676577247292202, 'support': 53934}, '1': {'precision': 0.3997915653442646, 'recall': 0.41621699819168173, 'f1-score': 0.4078389680345878, 'support': 69125}, '2': {'precision': 0.36928799843372706, 'recall': 0.5156839515173608, 'f1-score': 0.43037724368725283, 'support': 54865}, 'accuracy': 0.383360311144084, 'macro avg': {'precision': 0.38296154488710227, 'recall': 0.3795141334569876, 'f1-score': 0.36862464548368695, 'support': 177924}, 'weighted avg': {'precision': 0.38432692993362016, 'recall': 0.383360311144084, 'f1-score': 0.3722958559038565, 'support': 177924}}
[[11145 23269 19520]
 [11552 28771 28802]
 [ 6647 19925 28293]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0993549
{'0': {'precision': 0.3538057159780838, 'recall': 0.17697492685456095, 'f1-score': 0.23593452983434962, 'support': 54002}, '1': {'precision': 0.3885774900854639, 'recall': 0.471410605130005, 'f1-score': 0.4260048499745608, 'support': 68382}, '2': {'precision': 0.36379556458140183, 'recall': 0.4451026287360461, 'f1-score': 0.40036277359850353, 'support': 55540}, 'accuracy': 0.37383377172275806, 'macro avg': {'precision': 0.36872625688164984, 'recall': 0.36449605357353737, 'f1-score': 0.3541007178024713, 'support': 177924}, 'weighted avg': {'precision': 0.37028803229538304, 'recall': 0.37383377172275806, 'f1-score': 0.3603119791412955, 'support': 177924}}
[[ 9557 26527 17918]
 [10832 32236 25314]
 [ 6623 24196 24721]]
Evaluating performance on  train set...
282/282 - 5s - 5s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0499822
{'0': {'precision': 0.47541253220766405, 'recall': 0.37124876921101074, 'f1-score': 0.4169230769230769, 'support': 23359}, '1': {'precision': 0.45364225708696154, 'recall': 0.4612324492979719, 'f1-score': 0.45740586745054057, 'support': 25640}, '2': {'precision': 0.4237881962002456, 'recall': 0.5101969822150715, 'f1-score': 0.4629954817197088, 'support': 22997}, 'accuracy': 0.4476776487582643, 'macro avg': {'precision': 0.4509476618316237, 'recall': 0.4475594002413514, 'f1-score': 0.44577480869777547, 'support': 71996}, 'weighted avg': {'precision': 0.4511695921935326, 'recall': 0.4476776487582643, 'f1-score': 0.4460567210454214, 'support': 71996}}
[[ 8672  7240  7447]
 [ 5308 11826  8506]
 [ 4261  7003 11733]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0643963
{'0': {'precision': 0.468801996672213, 'recall': 0.37206999009574115, 'f1-score': 0.4148720780415977, 'support': 24232}, '1': {'precision': 0.4134202640317486, 'recall': 0.42359238205883576, 'f1-score': 0.4184445127574547, 'support': 24101}, '2': {'precision': 0.4223726398289989, 'recall': 0.5010353716773022, 'f1-score': 0.4583534687723504, 'support': 23663}, 'accuracy': 0.4317045391410634, 'macro avg': {'precision': 0.43486496684432013, 'recall': 0.4322325812772931, 'f1-score': 0.4305566865238009, 'support': 71996}, 'weighted avg': {'precision': 0.43500271602677704, 'recall': 0.4317045391410634, 'f1-score': 0.4303590411777258, 'support': 71996}}
[[ 9016  7319  7897]
 [ 5575 10209  8317]
 [ 4641  7166 11856]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.075965
{'0': {'precision': 0.44805226946493093, 'recall': 0.369620253164557, 'f1-score': 0.40507462018660645, 'support': 24490}, '1': {'precision': 0.38761296741563717, 'recall': 0.3947479523769315, 'f1-score': 0.3911479250334671, 'support': 23686}, '2': {'precision': 0.41173069278305807, 'recall': 0.4782955499580185, 'f1-score': 0.44252393622186403, 'support': 23820}, 'accuracy': 0.4138424356908717, 'macro avg': {'precision': 0.4157986432212087, 'recall': 0.41422125183316894, 'f1-score': 0.4129154938139792, 'support': 71996}, 'weighted avg': {'precision': 0.4161512573961801, 'recall': 0.4138424356908717, 'f1-score': 0.4128830401899758, 'support': 71996}}
[[ 9052  7464  7974]
 [ 6032  9350  8304]
 [ 5119  7308 11393]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0874401
{'0': {'precision': 0.4233447815302423, 'recall': 0.3601720709386794, 'f1-score': 0.3892117092424076, 'support': 24641}, '1': {'precision': 0.3672443170012052, 'recall': 0.3706639822155111, 'f1-score': 0.36894622578490316, 'support': 23841}, '2': {'precision': 0.3918202380510957, 'recall': 0.4493918516628392, 'f1-score': 0.41863597646732564, 'support': 23514}, 'accuracy': 0.39278571031723986, 'macro avg': {'precision': 0.3941364455275144, 'recall': 0.39340930160567655, 'f1-score': 0.3922646371648788, 'support': 71996}, 'weighted avg': {'precision': 0.3944715206517848, 'recall': 0.39278571031723986, 'f1-score': 0.39211093737197533, 'support': 71996}}
[[ 8875  7754  8012]
 [ 6614  8837  8390]
 [ 5475  7472 10567]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0768317
{'0': {'precision': 0.4297372286600294, 'recall': 0.4486283864372125, 'f1-score': 0.4389796598866289, 'support': 5869}, '1': {'precision': 0.4279204010329637, 'recall': 0.43735444806707036, 'f1-score': 0.43258599508599505, 'support': 6441}, '2': {'precision': 0.4265263884097965, 'recall': 0.398999677315263, 'f1-score': 0.41230410136712237, 'support': 6198}, 'accuracy': 0.4280851523665442, 'macro avg': {'precision': 0.42806133936759655, 'recall': 0.4283275039398486, 'f1-score': 0.4279565854465821, 'support': 18508}, 'weighted avg': {'precision': 0.4280296981533905, 'recall': 0.4280851523665442, 'f1-score': 0.4278214198453071, 'support': 18508}}
[[2633 1762 1474]
 [1773 2817 1851]
 [1721 2004 2473]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0894631
{'0': {'precision': 0.4340328615584838, 'recall': 0.4302531849701661, 'f1-score': 0.43213475866537093, 'support': 6201}, '1': {'precision': 0.3689943300507311, 'recall': 0.41837252579935713, 'f1-score': 0.39213509870768254, 'support': 5911}, '2': {'precision': 0.42427990811097366, 'recall': 0.37539086929330834, 'f1-score': 0.39834093737038573, 'support': 6396}, 'accuracy': 0.4074994596931057, 'macro avg': {'precision': 0.40910236657339616, 'recall': 0.40800552668761053, 'f1-score': 0.4075369315811464, 'support': 18508}, 'weighted avg': {'precision': 0.4098907257257303, 'recall': 0.4074994596931057, 'f1-score': 0.40768137250735165, 'support': 18508}}
[[2668 2014 1519]
 [1699 2473 1739]
 [1780 2215 2401]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0962903
{'0': {'precision': 0.4288267793305167, 'recall': 0.414937106918239, 'f1-score': 0.4217676202653028, 'support': 6360}, '1': {'precision': 0.3411214953271028, 'recall': 0.42811444819619693, 'f1-score': 0.3796989518480574, 'support': 5627}, '2': {'precision': 0.42857142857142855, 'recall': 0.3477994172672903, 'f1-score': 0.3839837467197156, 'support': 6521}, 'accuracy': 0.3952885238815647, 'macro avg': {'precision': 0.399506567743016, 'recall': 0.39695032412724207, 'f1-score': 0.3951501062776919, 'support': 18508}, 'weighted avg': {'precision': 0.40207171258169333, 'recall': 0.3952885238815647, 'f1-score': 0.39566490594854176, 'support': 18508}}
[[2639 2263 1458]
 [1652 2409 1566]
 [1863 2390 2268]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1076136
{'0': {'precision': 0.40193506067563134, 'recall': 0.38501413760603204, 'f1-score': 0.39329268292682923, 'support': 6366}, '1': {'precision': 0.32771212322400745, 'recall': 0.43875555555555557, 'f1-score': 0.37519002736394047, 'support': 5625}, '2': {'precision': 0.406025824964132, 'recall': 0.3039742212674543, 'f1-score': 0.3476658476658476, 'support': 6517}, 'accuracy': 0.37281175707802033, 'macro avg': {'precision': 0.3785576696212569, 'recall': 0.375914638143014, 'f1-score': 0.3720495193188724, 'support': 18508}, 'weighted avg': {'precision': 0.3808174622156559, 'recall': 0.37281175707802033, 'f1-score': 0.3717248461569424, 'support': 18508}}
[[2451 2470 1445]
 [1704 2468 1453]
 [1943 2593 1981]]
training model: results/LILAK/W7/deepOF_L2/seq2seq
Epoch 1/50
282/282 - 13s - loss: 13.1775 - accuracy10: 0.4031 - accuracy20: 0.3849 - accuracy30: 0.3667 - accuracy50: 0.3504 - val_loss: 13.0641 - val_accuracy10: 0.4214 - val_accuracy20: 0.4019 - val_accuracy30: 0.3803 - val_accuracy50: 0.3677 - 13s/epoch - 47ms/step
Epoch 2/50
282/282 - 8s - loss: 12.9592 - accuracy10: 0.4442 - accuracy20: 0.4175 - accuracy30: 0.3947 - accuracy50: 0.3683 - val_loss: 12.9348 - val_accuracy10: 0.4451 - val_accuracy20: 0.4258 - val_accuracy30: 0.4043 - val_accuracy50: 0.3832 - 8s/epoch - 28ms/step
Epoch 3/50
282/282 - 8s - loss: 12.8187 - accuracy10: 0.4679 - accuracy20: 0.4377 - accuracy30: 0.4107 - accuracy50: 0.3808 - val_loss: 12.8295 - val_accuracy10: 0.4604 - val_accuracy20: 0.4335 - val_accuracy30: 0.4136 - val_accuracy50: 0.3880 - 8s/epoch - 28ms/step
Epoch 4/50
282/282 - 8s - loss: 12.7202 - accuracy10: 0.4837 - accuracy20: 0.4485 - accuracy30: 0.4181 - accuracy50: 0.3868 - val_loss: 12.7841 - val_accuracy10: 0.4681 - val_accuracy20: 0.4387 - val_accuracy30: 0.4227 - val_accuracy50: 0.4004 - 8s/epoch - 28ms/step
Epoch 5/50
282/282 - 8s - loss: 12.6466 - accuracy10: 0.4917 - accuracy20: 0.4540 - accuracy30: 0.4265 - accuracy50: 0.3952 - val_loss: 12.7501 - val_accuracy10: 0.4695 - val_accuracy20: 0.4411 - val_accuracy30: 0.4278 - val_accuracy50: 0.3999 - 8s/epoch - 28ms/step
Epoch 6/50
282/282 - 8s - loss: 12.5756 - accuracy10: 0.4974 - accuracy20: 0.4609 - accuracy30: 0.4311 - accuracy50: 0.3987 - val_loss: 12.7374 - val_accuracy10: 0.4720 - val_accuracy20: 0.4416 - val_accuracy30: 0.4284 - val_accuracy50: 0.4014 - 8s/epoch - 28ms/step
Epoch 7/50
282/282 - 8s - loss: 12.5249 - accuracy10: 0.5023 - accuracy20: 0.4664 - accuracy30: 0.4379 - accuracy50: 0.4063 - val_loss: 12.7296 - val_accuracy10: 0.4714 - val_accuracy20: 0.4415 - val_accuracy30: 0.4300 - val_accuracy50: 0.4075 - 8s/epoch - 28ms/step
Epoch 8/50
282/282 - 8s - loss: 12.4663 - accuracy10: 0.5077 - accuracy20: 0.4709 - accuracy30: 0.4436 - accuracy50: 0.4111 - val_loss: 12.7004 - val_accuracy10: 0.4744 - val_accuracy20: 0.4502 - val_accuracy30: 0.4320 - val_accuracy50: 0.4118 - 8s/epoch - 28ms/step
Epoch 9/50
282/282 - 8s - loss: 12.4166 - accuracy10: 0.5123 - accuracy20: 0.4783 - accuracy30: 0.4496 - accuracy50: 0.4158 - val_loss: 12.6901 - val_accuracy10: 0.4767 - val_accuracy20: 0.4496 - val_accuracy30: 0.4352 - val_accuracy50: 0.4121 - 8s/epoch - 27ms/step
Epoch 10/50
282/282 - 8s - loss: 12.3627 - accuracy10: 0.5137 - accuracy20: 0.4814 - accuracy30: 0.4526 - accuracy50: 0.4191 - val_loss: 12.7052 - val_accuracy10: 0.4758 - val_accuracy20: 0.4492 - val_accuracy30: 0.4332 - val_accuracy50: 0.4097 - 8s/epoch - 28ms/step
Epoch 11/50
282/282 - 8s - loss: 12.3112 - accuracy10: 0.5186 - accuracy20: 0.4868 - accuracy30: 0.4591 - accuracy50: 0.4257 - val_loss: 12.7344 - val_accuracy10: 0.4737 - val_accuracy20: 0.4434 - val_accuracy30: 0.4306 - val_accuracy50: 0.4117 - 8s/epoch - 29ms/step
Epoch 12/50
282/282 - 8s - loss: 12.2626 - accuracy10: 0.5217 - accuracy20: 0.4907 - accuracy30: 0.4630 - accuracy50: 0.4300 - val_loss: 12.7294 - val_accuracy10: 0.4756 - val_accuracy20: 0.4453 - val_accuracy30: 0.4334 - val_accuracy50: 0.4125 - 8s/epoch - 28ms/step
Epoch 13/50
282/282 - 8s - loss: 12.1993 - accuracy10: 0.5252 - accuracy20: 0.4975 - accuracy30: 0.4695 - accuracy50: 0.4338 - val_loss: 12.7497 - val_accuracy10: 0.4747 - val_accuracy20: 0.4449 - val_accuracy30: 0.4275 - val_accuracy50: 0.4067 - 8s/epoch - 27ms/step
Epoch 14/50
282/282 - 8s - loss: 12.1517 - accuracy10: 0.5277 - accuracy20: 0.5009 - accuracy30: 0.4742 - accuracy50: 0.4403 - val_loss: 12.7861 - val_accuracy10: 0.4729 - val_accuracy20: 0.4418 - val_accuracy30: 0.4291 - val_accuracy50: 0.4068 - 8s/epoch - 27ms/step
Epoch 15/50
282/282 - 8s - loss: 12.1063 - accuracy10: 0.5303 - accuracy20: 0.5037 - accuracy30: 0.4783 - accuracy50: 0.4464 - val_loss: 12.8114 - val_accuracy10: 0.4735 - val_accuracy20: 0.4480 - val_accuracy30: 0.4328 - val_accuracy50: 0.4063 - 8s/epoch - 27ms/step
Epoch 16/50
282/282 - 8s - loss: 12.0507 - accuracy10: 0.5316 - accuracy20: 0.5082 - accuracy30: 0.4830 - accuracy50: 0.4502 - val_loss: 12.8884 - val_accuracy10: 0.4696 - val_accuracy20: 0.4428 - val_accuracy30: 0.4276 - val_accuracy50: 0.4071 - 8s/epoch - 28ms/step
Epoch 17/50
282/282 - 8s - loss: 12.0004 - accuracy10: 0.5346 - accuracy20: 0.5098 - accuracy30: 0.4868 - accuracy50: 0.4545 - val_loss: 12.9087 - val_accuracy10: 0.4676 - val_accuracy20: 0.4426 - val_accuracy30: 0.4306 - val_accuracy50: 0.4088 - 8s/epoch - 27ms/step
Epoch 18/50
282/282 - 8s - loss: 11.9449 - accuracy10: 0.5352 - accuracy20: 0.5164 - accuracy30: 0.4925 - accuracy50: 0.4634 - val_loss: 12.8987 - val_accuracy10: 0.4655 - val_accuracy20: 0.4417 - val_accuracy30: 0.4291 - val_accuracy50: 0.4091 - 8s/epoch - 27ms/step
Epoch 19/50
282/282 - 8s - loss: 11.8887 - accuracy10: 0.5383 - accuracy20: 0.5190 - accuracy30: 0.4973 - accuracy50: 0.4667 - val_loss: 12.9387 - val_accuracy10: 0.4674 - val_accuracy20: 0.4448 - val_accuracy30: 0.4326 - val_accuracy50: 0.4058 - 8s/epoch - 27ms/step
testing model: results/LILAK/W7/deepOF_L2/seq2seq
Evaluating performance on  test set...
695/695 - 7s - 7s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9890411
{'0': {'precision': 0.46740149678880416, 'recall': 0.5000946503615644, 'f1-score': 0.48319569809871327, 'support': 52826}, '1': {'precision': 0.6107103537801732, 'recall': 0.5109641585437947, 'f1-score': 0.556402233633247, 'support': 72737}, '2': {'precision': 0.46619646190185166, 'recall': 0.5390786156314462, 'f1-score': 0.49999557118435384, 'support': 52356}, 'accuracy': 0.5160100944811965, 'macro avg': {'precision': 0.5147694374902764, 'recall': 0.5167124748456018, 'f1-score': 0.5131978343054381, 'support': 177919}, 'weighted avg': {'precision': 0.5256345439869108, 'recall': 0.5160100944811965, 'f1-score': 0.5180677349831786, 'support': 177919}}
[[26418 12196 14212]
 [17466 37166 18105]
 [12637 11495 28224]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0304114
{'0': {'precision': 0.43648877461432334, 'recall': 0.5088088014912826, 'f1-score': 0.4698823648546016, 'support': 54718}, '1': {'precision': 0.5618528610354223, 'recall': 0.39369061081819384, 'f1-score': 0.462974637086676, 'support': 68089}, '2': {'precision': 0.4438690252164095, 'recall': 0.5349833067208594, 'f1-score': 0.48518558134559847, 'support': 55112}, 'accuracy': 0.4728612458478296, 'macro avg': {'precision': 0.480736886955385, 'recall': 0.47916090634344527, 'f1-score': 0.4726808610956254, 'support': 177919}, 'weighted avg': {'precision': 0.48675128537207474, 'recall': 0.4728612458478296, 'f1-score': 0.4719791088294527, 'support': 177919}}
[[27841 10483 16394]
 [20736 26806 20547]
 [15207 10421 29484]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0596689
{'0': {'precision': 0.3979559290538198, 'recall': 0.532095972706371, 'f1-score': 0.4553525384194283, 'support': 53932}, '1': {'precision': 0.549298773995315, 'recall': 0.26121173543197734, 'f1-score': 0.35405657140055885, 'support': 69124}, '2': {'precision': 0.41188971304002087, 'recall': 0.5475821591965441, 'f1-score': 0.47014084507042253, 'support': 54863}, 'accuracy': 0.4316289997133527, 'macro avg': {'precision': 0.4530481386963852, 'recall': 0.44696328911163086, 'f1-score': 0.4265166516301366, 'support': 177919}, 'weighted avg': {'precision': 0.461051337664316, 'recall': 0.4316289997133527, 'f1-score': 0.42055776351388796, 'support': 177919}}
[[28697  7093 18142]
 [26315 18056 24753]
 [17099  7722 30042]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0829307
{'0': {'precision': 0.3678073894609328, 'recall': 0.539757786748639, 'f1-score': 0.43749343339587243, 'support': 54002}, '1': {'precision': 0.5020388349514563, 'recall': 0.15124526535924773, 'f1-score': 0.23245934433967566, 'support': 68379}, '2': {'precision': 0.3861997412611597, 'recall': 0.5428895530987792, 'f1-score': 0.4513318713559715, 'support': 55538}, 'accuracy': 0.3914196909829754, 'macro avg': {'precision': 0.4186819885578496, 'recall': 0.4112975350688886, 'f1-score': 0.3737615496971732, 'support': 177919}, 'weighted avg': {'precision': 0.4251373342418584, 'recall': 0.3914196909829754, 'f1-score': 0.3630130979165493, 'support': 177919}}
[[29148  4840 20014]
 [30131 10342 27906]
 [19969  5418 30151]]
Evaluating performance on  train set...
282/282 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.99324185
{'0': {'precision': 0.5159118727050184, 'recall': 0.5033694446813956, 'f1-score': 0.5095634903501576, 'support': 23446}, '1': {'precision': 0.5474335248855556, 'recall': 0.43851915424826404, 'f1-score': 0.48696066539594524, 'support': 25634}, '2': {'precision': 0.4741113909879653, 'recall': 0.5914288208082396, 'f1-score': 0.526311701425298, 'support': 22914}, 'accuracy': 0.5083062477428675, 'macro avg': {'precision': 0.5124855961928464, 'recall': 0.5111058065792997, 'f1-score': 0.507611952390467, 'support': 71994}, 'weighted avg': {'precision': 0.5138312797935444, 'recall': 0.5083062477428675, 'f1-score': 0.5068461485397219, 'support': 71994}}
[[11802  4864  6780]
 [ 6141 11241  8252]
 [ 4933  4429 13552]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0250288
{'0': {'precision': 0.4898326294384483, 'recall': 0.516301883681629, 'f1-score': 0.5027190817329881, 'support': 24261}, '1': {'precision': 0.4993841166936791, 'recall': 0.3190704995443625, 'f1-score': 0.3893648747693785, 'support': 24142}, '2': {'precision': 0.45794754331064297, 'recall': 0.6017125174854817, 'f1-score': 0.5200776727485894, 'support': 23591}, 'accuracy': 0.47815095702419647, 'macro avg': {'precision': 0.48238809648092346, 'recall': 0.47902830023715776, 'f1-score': 0.470720543083652, 'support': 71994}, 'weighted avg': {'precision': 0.4825874553749809, 'recall': 0.47815095702419647, 'f1-score': 0.470395683340533, 'support': 71994}}
[[12526  3966  7769]
 [ 7406  7703  9033]
 [ 5640  3756 14195]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0479025
{'0': {'precision': 0.4581508601058053, 'recall': 0.5339294463498285, 'f1-score': 0.4931460356368436, 'support': 24492}, '1': {'precision': 0.47523281157123043, 'recall': 0.20217473764066254, 'f1-score': 0.28366990922799445, 'support': 23727}, '2': {'precision': 0.43684983661600263, 'recall': 0.612912723449001, 'f1-score': 0.5101169222152209, 'support': 23775}, 'accuracy': 0.45067644525932715, 'macro avg': {'precision': 0.45674450276434614, 'recall': 0.44967230247983075, 'f1-score': 0.4289776223600197, 'support': 71994}, 'weighted avg': {'precision': 0.45674618234029823, 'recall': 0.45067644525932715, 'f1-score': 0.4297135659462882, 'support': 71994}}
[[13077  2705  8710]
 [ 8855  4797 10075]
 [ 6611  2592 14572]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0700525
{'0': {'precision': 0.43014967925873127, 'recall': 0.539671571416958, 'f1-score': 0.478726472921324, 'support': 24602}, '1': {'precision': 0.420844327176781, 'recall': 0.10675144315234669, 'f1-score': 0.17030363697030368, 'support': 23906}, '2': {'precision': 0.40734086242299794, 'recall': 0.6081495358937239, 'f1-score': 0.4878906917164816, 'support': 23486}, 'accuracy': 0.4182570769786371, 'macro avg': {'precision': 0.41944495628617, 'recall': 0.4181908501543428, 'f1-score': 0.3789736005360364, 'support': 71994}, 'weighted avg': {'precision': 0.41961905699749924, 'recall': 0.4182570769786371, 'f1-score': 0.37930255601683166, 'support': 71994}}
[[13277  1783  9542]
 [10115  2552 11239]
 [ 7474  1729 14283]]
Evaluating performance on  val set...
73/73 - 1s - 817ms/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0293448
{'0': {'precision': 0.4534543775965533, 'recall': 0.5034164673727366, 'f1-score': 0.4771310612806606, 'support': 5854}, '1': {'precision': 0.5233193277310925, 'recall': 0.38584262701363076, 'f1-score': 0.4441868758915835, 'support': 6456}, '2': {'precision': 0.46544350944957924, 'recall': 0.5443691513391417, 'f1-score': 0.5018219677251432, 'support': 6198}, 'accuracy': 0.47611843527123404, 'macro avg': {'precision': 0.4807390715924083, 'recall': 0.477876081908503, 'f1-score': 0.47437996829912904, 'support': 18508}, 'weighted avg': {'precision': 0.4818397653906769, 'recall': 0.47611843527123404, 'f1-score': 0.47390794572365935, 'support': 18508}}
[[2947 1131 1776]
 [1866 2491 2099]
 [1686 1138 3374]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0534055
{'0': {'precision': 0.4430344442894994, 'recall': 0.515830491962981, 'f1-score': 0.476669167291823, 'support': 6159}, '1': {'precision': 0.4742326105322444, 'recall': 0.2840276606510373, 'f1-score': 0.3552742616033755, 'support': 5929}, '2': {'precision': 0.4501669663498587, 'recall': 0.5459501557632399, 'f1-score': 0.49345347036463466, 'support': 6420}, 'accuracy': 0.4520207477847417, 'macro avg': {'precision': 0.45581134039053417, 'recall': 0.4486027694590861, 'f1-score': 0.4417989664199444, 'support': 18508}, 'weighted avg': {'precision': 0.45550282116872687, 'recall': 0.4520207477847417, 'f1-score': 0.44360264632254737, 'support': 18508}}
[[3177  944 2038]
 [2002 1684 2243]
 [1992  923 3505]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0674982
{'0': {'precision': 0.43204504735090865, 'recall': 0.5304006284367635, 'f1-score': 0.47619719303194863, 'support': 6365}, '1': {'precision': 0.43658434491419, 'recall': 0.18671679197994986, 'f1-score': 0.2615673981191222, 'support': 5586}, '2': {'precision': 0.4362432269717038, 'recall': 0.552539271008083, 'f1-score': 0.48755214641367245, 'support': 6557}, 'accuracy': 0.4345148044089043, 'macro avg': {'precision': 0.43495753974560086, 'recall': 0.4232188971415988, 'f1-score': 0.4084389125215811, 'support': 18508}, 'weighted avg': {'precision': 0.4349024052481446, 'recall': 0.4345148044089043, 'f1-score': 0.4154414330871093, 'support': 18508}}
[[3376  680 2309]
 [2170 1043 2373]
 [2268  666 3623]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0821149
{'0': {'precision': 0.4129750665698378, 'recall': 0.5381703470031546, 'f1-score': 0.46733324202164084, 'support': 6340}, '1': {'precision': 0.41324921135646686, 'recall': 0.11605244507441531, 'f1-score': 0.18121455249688756, 'support': 5644}, '2': {'precision': 0.41461724974021474, 'recall': 0.5504291845493562, 'f1-score': 0.4729667434968719, 'support': 6524}, 'accuracy': 0.41376701966717094, 'macro avg': {'precision': 0.4136138425555065, 'recall': 0.40155065887564206, 'f1-score': 0.3738381793384668, 'support': 18508}, 'weighted avg': {'precision': 0.4136375301628394, 'recall': 0.41376701966717094, 'f1-score': 0.38206736131852326, 'support': 18508}}
[[3412  428 2500]
 [2419  655 2570]
 [2431  502 3591]]
training model: results/LILAK/W7/deepVOL_L2/seq2seq
Epoch 1/50
282/282 - 13s - loss: 13.3025 - accuracy10: 0.3525 - accuracy20: 0.3538 - accuracy30: 0.3550 - accuracy50: 0.3517 - val_loss: 13.2840 - val_accuracy10: 0.3561 - val_accuracy20: 0.3580 - val_accuracy30: 0.3553 - val_accuracy50: 0.3487 - 13s/epoch - 47ms/step
Epoch 2/50
282/282 - 8s - loss: 13.1483 - accuracy10: 0.3763 - accuracy20: 0.3750 - accuracy30: 0.3695 - accuracy50: 0.3603 - val_loss: 13.1429 - val_accuracy10: 0.3865 - val_accuracy20: 0.3781 - val_accuracy30: 0.3702 - val_accuracy50: 0.3602 - 8s/epoch - 27ms/step
Epoch 3/50
282/282 - 8s - loss: 13.0555 - accuracy10: 0.3964 - accuracy20: 0.3913 - accuracy30: 0.3862 - accuracy50: 0.3722 - val_loss: 13.1168 - val_accuracy10: 0.3992 - val_accuracy20: 0.3954 - val_accuracy30: 0.3868 - val_accuracy50: 0.3756 - 8s/epoch - 27ms/step
Epoch 4/50
282/282 - 8s - loss: 12.9931 - accuracy10: 0.4109 - accuracy20: 0.4027 - accuracy30: 0.3963 - accuracy50: 0.3785 - val_loss: 13.0094 - val_accuracy10: 0.4104 - val_accuracy20: 0.4060 - val_accuracy30: 0.4032 - val_accuracy50: 0.3809 - 8s/epoch - 27ms/step
Epoch 5/50
282/282 - 8s - loss: 12.9204 - accuracy10: 0.4224 - accuracy20: 0.4157 - accuracy30: 0.4059 - accuracy50: 0.3871 - val_loss: 13.1182 - val_accuracy10: 0.4053 - val_accuracy20: 0.4031 - val_accuracy30: 0.4000 - val_accuracy50: 0.3832 - 8s/epoch - 28ms/step
Epoch 6/50
282/282 - 8s - loss: 12.8556 - accuracy10: 0.4340 - accuracy20: 0.4255 - accuracy30: 0.4157 - accuracy50: 0.3939 - val_loss: 13.1652 - val_accuracy10: 0.4058 - val_accuracy20: 0.4058 - val_accuracy30: 0.4016 - val_accuracy50: 0.3852 - 8s/epoch - 27ms/step
Epoch 7/50
282/282 - 8s - loss: 12.7878 - accuracy10: 0.4469 - accuracy20: 0.4350 - accuracy30: 0.4219 - accuracy50: 0.4013 - val_loss: 13.2578 - val_accuracy10: 0.4072 - val_accuracy20: 0.4078 - val_accuracy30: 0.4051 - val_accuracy50: 0.3875 - 8s/epoch - 27ms/step
Epoch 8/50
282/282 - 8s - loss: 12.7111 - accuracy10: 0.4589 - accuracy20: 0.4465 - accuracy30: 0.4314 - accuracy50: 0.4076 - val_loss: 13.1738 - val_accuracy10: 0.4221 - val_accuracy20: 0.4204 - val_accuracy30: 0.4150 - val_accuracy50: 0.3989 - 8s/epoch - 27ms/step
Epoch 9/50
282/282 - 8s - loss: 12.6444 - accuracy10: 0.4656 - accuracy20: 0.4513 - accuracy30: 0.4365 - accuracy50: 0.4110 - val_loss: 13.2799 - val_accuracy10: 0.4229 - val_accuracy20: 0.4205 - val_accuracy30: 0.4139 - val_accuracy50: 0.3968 - 8s/epoch - 28ms/step
Epoch 10/50
282/282 - 8s - loss: 12.5958 - accuracy10: 0.4715 - accuracy20: 0.4587 - accuracy30: 0.4411 - accuracy50: 0.4156 - val_loss: 13.2044 - val_accuracy10: 0.4378 - val_accuracy20: 0.4295 - val_accuracy30: 0.4218 - val_accuracy50: 0.4039 - 8s/epoch - 28ms/step
Epoch 11/50
282/282 - 7s - loss: 12.5492 - accuracy10: 0.4765 - accuracy20: 0.4617 - accuracy30: 0.4457 - accuracy50: 0.4216 - val_loss: 13.2465 - val_accuracy10: 0.4309 - val_accuracy20: 0.4275 - val_accuracy30: 0.4214 - val_accuracy50: 0.4016 - 7s/epoch - 26ms/step
Epoch 12/50
282/282 - 8s - loss: 12.5065 - accuracy10: 0.4796 - accuracy20: 0.4633 - accuracy30: 0.4486 - accuracy50: 0.4225 - val_loss: 13.2465 - val_accuracy10: 0.4342 - val_accuracy20: 0.4267 - val_accuracy30: 0.4180 - val_accuracy50: 0.4003 - 8s/epoch - 27ms/step
Epoch 13/50
282/282 - 8s - loss: 12.4706 - accuracy10: 0.4857 - accuracy20: 0.4702 - accuracy30: 0.4519 - accuracy50: 0.4271 - val_loss: 13.2080 - val_accuracy10: 0.4379 - val_accuracy20: 0.4287 - val_accuracy30: 0.4221 - val_accuracy50: 0.4005 - 8s/epoch - 28ms/step
Epoch 14/50
282/282 - 8s - loss: 12.4403 - accuracy10: 0.4852 - accuracy20: 0.4709 - accuracy30: 0.4551 - accuracy50: 0.4287 - val_loss: 13.3394 - val_accuracy10: 0.4351 - val_accuracy20: 0.4259 - val_accuracy30: 0.4177 - val_accuracy50: 0.3961 - 8s/epoch - 28ms/step
testing model: results/LILAK/W7/deepVOL_L2/seq2seq
Evaluating performance on  test set...
696/696 - 7s - 7s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0551422
{'0': {'precision': 0.40522964829253344, 'recall': 0.22529719088362232, 'f1-score': 0.2895898976873198, 'support': 52828}, '1': {'precision': 0.517769382897339, 'recall': 0.6010971032624387, 'f1-score': 0.5563303219239089, 'support': 72737}, '2': {'precision': 0.38136016222118235, 'recall': 0.4669493305830898, 'f1-score': 0.41983703818183377, 'support': 52359}, 'accuracy': 0.45004046671612596, 'macro avg': {'precision': 0.43478639780368494, 'recall': 0.43111454157638357, 'f1-score': 0.42191908593102084, 'support': 177924}, 'weighted avg': {'precision': 0.44421269866651264, 'recall': 0.45004046671612596, 'f1-score': 0.4369646659414566, 'support': 177924}}
[[11902 20743 20183]
 [ 9537 43722 19478]
 [ 7932 19978 24449]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0625701
{'0': {'precision': 0.41761484852794767, 'recall': 0.21463815789473684, 'f1-score': 0.2835449760996572, 'support': 54720}, '1': {'precision': 0.4840520758485465, 'recall': 0.5837274195917168, 'f1-score': 0.5292374884321676, 'support': 68090}, '2': {'precision': 0.39318057586904814, 'recall': 0.4828900097978735, 'f1-score': 0.433442179751309, 'support': 55114}, 'accuracy': 0.4389795643083564, 'macro avg': {'precision': 0.4316158334151807, 'recall': 0.4270851957614424, 'f1-score': 0.41540821476104456, 'support': 177924}, 'weighted avg': {'precision': 0.4354710135474896, 'recall': 0.4389795643083564, 'f1-score': 0.42400178713570497, 'support': 177924}}
[[11745 21549 21426]
 [ 8695 39746 19649]
 [ 7684 20816 26614]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0705853
{'0': {'precision': 0.3922242885715288, 'recall': 0.207253309600623, 'f1-score': 0.27120206713330824, 'support': 53934}, '1': {'precision': 0.4790918553213635, 'recall': 0.5327016274864376, 'f1-score': 0.5044764873103401, 'support': 69125}, '2': {'precision': 0.38309102184248606, 'recall': 0.5066800328078009, 'f1-score': 0.436302283606686, 'support': 54865}, 'accuracy': 0.426024594770801, 'macro avg': {'precision': 0.41813572191179277, 'recall': 0.41554498996495387, 'f1-score': 0.40399361268344486, 'support': 177924}, 'weighted avg': {'precision': 0.4231567309204721, 'recall': 0.426024594770801, 'f1-score': 0.41274181259513015, 'support': 177924}}
[[11178 20394 22362]
 [ 9898 36823 22404]
 [ 7423 19643 27799]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0820259
{'0': {'precision': 0.3624178541219338, 'recall': 0.20628865597570462, 'f1-score': 0.26292187868775074, 'support': 54002}, '1': {'precision': 0.4592556274965031, 'recall': 0.46573659735017986, 'f1-score': 0.46247340792425706, 'support': 68382}, '2': {'precision': 0.36987885250324387, 'recall': 0.5183831472812388, 'f1-score': 0.4317171368806184, 'support': 55540}, 'accuracy': 0.4034250578898856, 'macro avg': {'precision': 0.3971841113738936, 'recall': 0.3968028002023744, 'f1-score': 0.38570414116420876, 'support': 177924}, 'weighted avg': {'precision': 0.40196476442632084, 'recall': 0.4034250578898856, 'f1-score': 0.3923064547555249, 'support': 177924}}
[[11140 19081 23781]
 [11267 31848 25267]
 [ 8331 18418 28791]]
Evaluating performance on  train set...
282/282 - 3s - 3s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0782231
{'0': {'precision': 0.38514881865602946, 'recall': 0.268675885097821, 'f1-score': 0.316538054168558, 'support': 23359}, '1': {'precision': 0.46086082059533384, 'recall': 0.4468408736349454, 'f1-score': 0.45374257425742576, 'support': 25640}, '2': {'precision': 0.3792030089815505, 'recall': 0.5085445927729704, 'f1-score': 0.43445150265611643, 'support': 22997}, 'accuracy': 0.40874493027390413, 'macro avg': {'precision': 0.40840421607763794, 'recall': 0.40802045050191227, 'f1-score': 0.40157737702736673, 'support': 71996}, 'weighted avg': {'precision': 0.4102129881187742, 'recall': 0.40874493027390413, 'f1-score': 0.40306479829249475, 'support': 71996}}
[[ 6276  6954 10129]
 [ 5166 11457  9017]
 [ 4853  6449 11695]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0798311
{'0': {'precision': 0.4012791813239527, 'recall': 0.2589138329481677, 'f1-score': 0.3147465322196303, 'support': 24232}, '1': {'precision': 0.42694244454617336, 'recall': 0.4256669847724161, 'f1-score': 0.4263037606482443, 'support': 24101}, '2': {'precision': 0.38806754917728564, 'recall': 0.5302370789840679, 'f1-score': 0.448147155996071, 'support': 23663}, 'accuracy': 0.40391132840713373, 'macro avg': {'precision': 0.4054297250158039, 'recall': 0.4049392989015506, 'f1-score': 0.3963991496213152, 'support': 71996}, 'weighted avg': {'precision': 0.40552779868369704, 'recall': 0.40391132840713373, 'f1-score': 0.3959357611042898, 'support': 71996}}
[[ 6274  7225 10733]
 [ 4790 10259  9052]
 [ 4571  6545 12547]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0845406
{'0': {'precision': 0.39723986004924194, 'recall': 0.25034708044099635, 'f1-score': 0.30713355375212903, 'support': 24490}, '1': {'precision': 0.40602717610655187, 'recall': 0.382251118804357, 'f1-score': 0.39378058062411664, 'support': 23686}, '2': {'precision': 0.3848758135598167, 'recall': 0.5536104114189756, 'f1-score': 0.4540743418900539, 'support': 23820}, 'accuracy': 0.3940774487471526, 'macro avg': {'precision': 0.3960476165718702, 'recall': 0.395402870221443, 'f1-score': 0.3849961587554332, 'support': 71996}, 'weighted avg': {'precision': 0.3960401375751508, 'recall': 0.3940774487471526, 'f1-score': 0.3842552140101332, 'support': 71996}}
[[ 6131  7007 11352]
 [ 4908  9054  9724]
 [ 4395  6238 13187]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0922914
{'0': {'precision': 0.3854330461035285, 'recall': 0.24869120571405381, 'f1-score': 0.3023186975826344, 'support': 24641}, '1': {'precision': 0.380930794802055, 'recall': 0.31722662639989935, 'f1-score': 0.3461723309303124, 'support': 23841}, '2': {'precision': 0.3696989763540546, 'recall': 0.5698307391341328, 'f1-score': 0.44844955402714326, 'support': 23514}, 'accuracy': 0.3762709039391077, 'macro avg': {'precision': 0.3786876057532127, 'recall': 0.3785828570826954, 'f1-score': 0.3656468608466967, 'support': 71996}, 'weighted avg': {'precision': 0.37880338488113335, 'recall': 0.3762709039391077, 'f1-score': 0.36456709236954166, 'support': 71996}}
[[ 6128  6560 11953]
 [ 5387  7563 10891]
 [ 4384  5731 13399]]
Evaluating performance on  val set...
73/73 - 1s - 790ms/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.079026
{'0': {'precision': 0.36854266380590855, 'recall': 0.3804736752428012, 'f1-score': 0.3744131455399062, 'support': 5869}, '1': {'precision': 0.4537345025703054, 'recall': 0.46592144077006675, 'f1-score': 0.4597472232860973, 'support': 6441}, '2': {'precision': 0.40102827763496146, 'recall': 0.377541142303969, 'f1-score': 0.38893044128646226, 'support': 6198}, 'accuracy': 0.4092284417549168, 'macro avg': {'precision': 0.4077684813370585, 'recall': 0.40797875277227896, 'f1-score': 0.40769693670415524, 'support': 18508}, 'weighted avg': {'precision': 0.40906927219114464, 'recall': 0.4092284417549168, 'f1-score': 0.408971984625727, 'support': 18508}}
[[2233 1729 1907]
 [1852 3001 1588]
 [1974 1884 2340]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0811216
{'0': {'precision': 0.3804757998359311, 'recall': 0.3739719400096759, 'f1-score': 0.37719583604424206, 'support': 6201}, '1': {'precision': 0.4217557251908397, 'recall': 0.44865504990695315, 'f1-score': 0.4347897368636774, 'support': 5911}, '2': {'precision': 0.39853061224489794, 'recall': 0.3816447779862414, 'f1-score': 0.3899049596677581, 'support': 6396}, 'accuracy': 0.4004754700669981, 'macro avg': {'precision': 0.40025404575722295, 'recall': 0.40142392263429016, 'f1-score': 0.4006301775252259, 'support': 18508}, 'weighted avg': {'precision': 0.39989898002507185, 'recall': 0.4004754700669981, 'f1-score': 0.3999819340796695, 'support': 18508}}
[[2319 1776 2106]
 [1681 2652 1578]
 [2095 1860 2441]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0845364
{'0': {'precision': 0.3834055528807575, 'recall': 0.37562893081761006, 'f1-score': 0.3794774044952744, 'support': 6360}, '1': {'precision': 0.40250914793518033, 'recall': 0.41052070374977784, 'f1-score': 0.406475453105754, 'support': 5627}, '2': {'precision': 0.4039461609054757, 'recall': 0.4049992332464346, 'f1-score': 0.4044720116394824, 'support': 6521}, 'accuracy': 0.3965852604279231, 'macro avg': {'precision': 0.39662028724047116, 'recall': 0.3970496226046076, 'f1-score': 0.39680828974683696, 'support': 18508}, 'weighted avg': {'precision': 0.3964507892272252, 'recall': 0.3965852604279231, 'f1-score': 0.39649209288508147, 'support': 18508}}
[[2389 1705 2266]
 [1686 2310 1631]
 [2156 1724 2641]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.09371
{'0': {'precision': 0.36683493957472846, 'recall': 0.37668865849827204, 'f1-score': 0.37169650468883203, 'support': 6366}, '1': {'precision': 0.381066030230708, 'recall': 0.3406222222222222, 'f1-score': 0.3597108795644419, 'support': 5625}, '2': {'precision': 0.3847040184358346, 'recall': 0.40985115850851617, 'f1-score': 0.39687964338781573, 'support': 6517}, 'accuracy': 0.3774043656797061, 'macro avg': {'precision': 0.3775349960804237, 'recall': 0.3757206797430035, 'f1-score': 0.37609567588036324, 'support': 18508}, 'weighted avg': {'precision': 0.3774521144114323, 'recall': 0.3774043656797061, 'f1-score': 0.37692123851077836, 'support': 18508}}
[[2398 1569 2399]
 [1836 1916 1873]
 [2303 1543 2671]]
training model: results/LILAK/W7/deepVOL_L3/seq2seq
Epoch 1/50
282/282 - 17s - loss: 13.3092 - accuracy10: 0.3450 - accuracy20: 0.3453 - accuracy30: 0.3452 - accuracy50: 0.3438 - val_loss: 13.2430 - val_accuracy10: 0.3512 - val_accuracy20: 0.3473 - val_accuracy30: 0.3416 - val_accuracy50: 0.3434 - 17s/epoch - 59ms/step
Epoch 2/50
282/282 - 11s - loss: 13.2110 - accuracy10: 0.3539 - accuracy20: 0.3542 - accuracy30: 0.3513 - accuracy50: 0.3496 - val_loss: 13.2026 - val_accuracy10: 0.3696 - val_accuracy20: 0.3598 - val_accuracy30: 0.3588 - val_accuracy50: 0.3533 - 11s/epoch - 39ms/step
Epoch 3/50
282/282 - 11s - loss: 13.1433 - accuracy10: 0.3733 - accuracy20: 0.3704 - accuracy30: 0.3651 - accuracy50: 0.3567 - val_loss: 13.1979 - val_accuracy10: 0.3950 - val_accuracy20: 0.3849 - val_accuracy30: 0.3757 - val_accuracy50: 0.3708 - 11s/epoch - 39ms/step
Epoch 4/50
282/282 - 11s - loss: 13.0800 - accuracy10: 0.3888 - accuracy20: 0.3851 - accuracy30: 0.3781 - accuracy50: 0.3639 - val_loss: 13.1541 - val_accuracy10: 0.4000 - val_accuracy20: 0.3930 - val_accuracy30: 0.3835 - val_accuracy50: 0.3750 - 11s/epoch - 38ms/step
Epoch 5/50
282/282 - 11s - loss: 13.0251 - accuracy10: 0.4053 - accuracy20: 0.3986 - accuracy30: 0.3890 - accuracy50: 0.3747 - val_loss: 13.1972 - val_accuracy10: 0.4083 - val_accuracy20: 0.4037 - val_accuracy30: 0.3923 - val_accuracy50: 0.3795 - 11s/epoch - 38ms/step
Epoch 6/50
282/282 - 11s - loss: 12.9579 - accuracy10: 0.4194 - accuracy20: 0.4097 - accuracy30: 0.3995 - accuracy50: 0.3800 - val_loss: 13.1684 - val_accuracy10: 0.4100 - val_accuracy20: 0.4011 - val_accuracy30: 0.3962 - val_accuracy50: 0.3776 - 11s/epoch - 38ms/step
Epoch 7/50
282/282 - 11s - loss: 12.9061 - accuracy10: 0.4288 - accuracy20: 0.4198 - accuracy30: 0.4086 - accuracy50: 0.3894 - val_loss: 13.2498 - val_accuracy10: 0.4091 - val_accuracy20: 0.3950 - val_accuracy30: 0.3855 - val_accuracy50: 0.3709 - 11s/epoch - 39ms/step
Epoch 8/50
282/282 - 11s - loss: 12.8188 - accuracy10: 0.4425 - accuracy20: 0.4316 - accuracy30: 0.4211 - accuracy50: 0.3992 - val_loss: 13.1708 - val_accuracy10: 0.4191 - val_accuracy20: 0.4105 - val_accuracy30: 0.4028 - val_accuracy50: 0.3877 - 11s/epoch - 38ms/step
Epoch 9/50
282/282 - 11s - loss: 12.7308 - accuracy10: 0.4563 - accuracy20: 0.4445 - accuracy30: 0.4318 - accuracy50: 0.4084 - val_loss: 13.1373 - val_accuracy10: 0.4306 - val_accuracy20: 0.4233 - val_accuracy30: 0.4156 - val_accuracy50: 0.3954 - 11s/epoch - 38ms/step
Epoch 10/50
282/282 - 11s - loss: 12.6765 - accuracy10: 0.4616 - accuracy20: 0.4481 - accuracy30: 0.4347 - accuracy50: 0.4116 - val_loss: 13.0706 - val_accuracy10: 0.4310 - val_accuracy20: 0.4288 - val_accuracy30: 0.4214 - val_accuracy50: 0.4014 - 11s/epoch - 38ms/step
Epoch 11/50
282/282 - 11s - loss: 12.6120 - accuracy10: 0.4707 - accuracy20: 0.4565 - accuracy30: 0.4432 - accuracy50: 0.4185 - val_loss: 12.9718 - val_accuracy10: 0.4430 - val_accuracy20: 0.4337 - val_accuracy30: 0.4225 - val_accuracy50: 0.4014 - 11s/epoch - 38ms/step
Epoch 12/50
282/282 - 11s - loss: 12.5668 - accuracy10: 0.4739 - accuracy20: 0.4597 - accuracy30: 0.4454 - accuracy50: 0.4193 - val_loss: 12.8971 - val_accuracy10: 0.4459 - val_accuracy20: 0.4363 - val_accuracy30: 0.4268 - val_accuracy50: 0.4023 - 11s/epoch - 38ms/step
Epoch 13/50
282/282 - 11s - loss: 12.5070 - accuracy10: 0.4807 - accuracy20: 0.4666 - accuracy30: 0.4516 - accuracy50: 0.4264 - val_loss: 13.0178 - val_accuracy10: 0.4436 - val_accuracy20: 0.4367 - val_accuracy30: 0.4272 - val_accuracy50: 0.4017 - 11s/epoch - 38ms/step
Epoch 14/50
282/282 - 11s - loss: 12.4583 - accuracy10: 0.4869 - accuracy20: 0.4725 - accuracy30: 0.4557 - accuracy50: 0.4303 - val_loss: 13.0275 - val_accuracy10: 0.4433 - val_accuracy20: 0.4346 - val_accuracy30: 0.4211 - val_accuracy50: 0.3953 - 11s/epoch - 38ms/step
Epoch 15/50
282/282 - 11s - loss: 12.4296 - accuracy10: 0.4894 - accuracy20: 0.4729 - accuracy30: 0.4569 - accuracy50: 0.4318 - val_loss: 13.2188 - val_accuracy10: 0.4373 - val_accuracy20: 0.4291 - val_accuracy30: 0.4179 - val_accuracy50: 0.3932 - 11s/epoch - 38ms/step
Epoch 16/50
282/282 - 11s - loss: 12.3958 - accuracy10: 0.4920 - accuracy20: 0.4751 - accuracy30: 0.4607 - accuracy50: 0.4342 - val_loss: 13.1160 - val_accuracy10: 0.4413 - val_accuracy20: 0.4354 - val_accuracy30: 0.4254 - val_accuracy50: 0.3994 - 11s/epoch - 38ms/step
Epoch 17/50
282/282 - 11s - loss: 12.3469 - accuracy10: 0.4956 - accuracy20: 0.4816 - accuracy30: 0.4655 - accuracy50: 0.4381 - val_loss: 13.2078 - val_accuracy10: 0.4385 - val_accuracy20: 0.4285 - val_accuracy30: 0.4187 - val_accuracy50: 0.3955 - 11s/epoch - 38ms/step
Epoch 18/50
282/282 - 11s - loss: 12.3270 - accuracy10: 0.4975 - accuracy20: 0.4836 - accuracy30: 0.4690 - accuracy50: 0.4407 - val_loss: 13.1886 - val_accuracy10: 0.4379 - val_accuracy20: 0.4337 - val_accuracy30: 0.4227 - val_accuracy50: 0.4014 - 11s/epoch - 38ms/step
Epoch 19/50
282/282 - 11s - loss: 12.2809 - accuracy10: 0.5002 - accuracy20: 0.4864 - accuracy30: 0.4718 - accuracy50: 0.4457 - val_loss: 13.3087 - val_accuracy10: 0.4337 - val_accuracy20: 0.4313 - val_accuracy30: 0.4253 - val_accuracy50: 0.4022 - 11s/epoch - 38ms/step
Epoch 20/50
282/282 - 11s - loss: 12.2429 - accuracy10: 0.5048 - accuracy20: 0.4914 - accuracy30: 0.4736 - accuracy50: 0.4472 - val_loss: 13.3685 - val_accuracy10: 0.4340 - val_accuracy20: 0.4334 - val_accuracy30: 0.4233 - val_accuracy50: 0.4033 - 11s/epoch - 38ms/step
Epoch 21/50
282/282 - 11s - loss: 12.2013 - accuracy10: 0.5051 - accuracy20: 0.4918 - accuracy30: 0.4773 - accuracy50: 0.4497 - val_loss: 13.4125 - val_accuracy10: 0.4301 - val_accuracy20: 0.4306 - val_accuracy30: 0.4230 - val_accuracy50: 0.4036 - 11s/epoch - 37ms/step
Epoch 22/50
282/282 - 11s - loss: 12.1619 - accuracy10: 0.5088 - accuracy20: 0.4952 - accuracy30: 0.4814 - accuracy50: 0.4551 - val_loss: 13.3368 - val_accuracy10: 0.4362 - val_accuracy20: 0.4310 - val_accuracy30: 0.4226 - val_accuracy50: 0.4009 - 11s/epoch - 38ms/step
testing model: results/LILAK/W7/deepVOL_L3/seq2seq
Evaluating performance on  test set...
696/696 - 12s - 12s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0214964
{'0': {'precision': 0.44862573334404887, 'recall': 0.4226735821912622, 'f1-score': 0.4352631578947369, 'support': 52828}, '1': {'precision': 0.5613292134521478, 'recall': 0.5594539230377937, 'f1-score': 0.5603899993802977, 'support': 72737}, '2': {'precision': 0.42179021883646556, 'recall': 0.44836608796959454, 'f1-score': 0.4346723200977624, 'support': 52359}, 'accuracy': 0.4861513904813291, 'macro avg': {'precision': 0.4772483885442207, 'recall': 0.47683119773288346, 'f1-score': 0.47677515912426566, 'support': 177924}, 'weighted avg': {'precision': 0.48680288948105255, 'recall': 0.4861513904813291, 'f1-score': 0.4862423141239327, 'support': 177924}}
[[22329 15489 15010]
 [14872 40693 17172]
 [12571 16312 23476]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0376565
{'0': {'precision': 0.44608054586094664, 'recall': 0.41577119883040936, 'f1-score': 0.43039291727360435, 'support': 54720}, '1': {'precision': 0.5203646013614861, 'recall': 0.529886914378029, 'f1-score': 0.5250825899029296, 'support': 68090}, '2': {'precision': 0.42803806480741846, 'recall': 0.44723663678920056, 'f1-score': 0.4374267968056788, 'support': 55114}, 'accuracy': 0.46918909197185316, 'macro avg': {'precision': 0.4648277373432837, 'recall': 0.464298249999213, 'f1-score': 0.46430076799407094, 'support': 177924}, 'weighted avg': {'precision': 0.468919555990258, 'recall': 0.46918909197185316, 'f1-score': 0.4688086736969171, 'support': 177924}}
[[22751 16001 15968]
 [15041 36080 16969]
 [13210 17255 24649]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0535231
{'0': {'precision': 0.4179794359022734, 'recall': 0.41077984202914675, 'f1-score': 0.4143483668259475, 'support': 53934}, '1': {'precision': 0.5023135464231354, 'recall': 0.4774249547920434, 'f1-score': 0.48955312442054516, 'support': 69125}, '2': {'precision': 0.4138198888870126, 'recall': 0.44665998359609954, 'f1-score': 0.42961326741699096, 'support': 54865}, 'accuracy': 0.44773611204784064, 'macro avg': {'precision': 0.4447042904041405, 'recall': 0.44495492680576326, 'f1-score': 0.44450491955449456, 'support': 177924}, 'weighted avg': {'precision': 0.44946131492231745, 'recall': 0.44773611204784064, 'f1-score': 0.448273175393955, 'support': 177924}}
[[22155 15526 16253]
 [17663 33002 18460]
 [13187 17172 24506]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0734658
{'0': {'precision': 0.3866771777690185, 'recall': 0.39965186474575015, 'f1-score': 0.39305747796313834, 'support': 54002}, '1': {'precision': 0.4675483913157206, 'recall': 0.4182240940598403, 'f1-score': 0.4415129293708993, 'support': 68382}, '2': {'precision': 0.393193528272784, 'recall': 0.4314368023046453, 'f1-score': 0.4114283751996016, 'support': 55540}, 'accuracy': 0.4167116296845844, 'macro avg': {'precision': 0.41580636578584107, 'recall': 0.4164375870367452, 'f1-score': 0.41533292751121315, 'support': 177924}, 'weighted avg': {'precision': 0.4197927407719283, 'recall': 0.4167116296845844, 'f1-score': 0.41741507059076965, 'support': 177924}}
[[21582 15154 17266]
 [20069 28599 19714]
 [14163 17415 23962]]
Evaluating performance on  train set...
282/282 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0432901
{'0': {'precision': 0.4428802119995031, 'recall': 0.45789631405454, 'f1-score': 0.45026310250473583, 'support': 23359}, '1': {'precision': 0.5162009512485137, 'recall': 0.4063572542901716, 'f1-score': 0.45473987430167595, 'support': 25640}, '2': {'precision': 0.43082318065145875, 'recall': 0.5181980258294561, 'f1-score': 0.47048837301117297, 'support': 22997}, 'accuracy': 0.45880326684815825, 'macro avg': {'precision': 0.46330144796649186, 'recall': 0.46081719805805593, 'f1-score': 0.4584971166058616, 'support': 71996}, 'weighted avg': {'precision': 0.4651407293120435, 'recall': 0.45880326684815825, 'f1-score': 0.4583177857470004, 'support': 71996}}
[[10696  4914  7749]
 [ 7226 10419  7995]
 [ 6229  4851 11917]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0502237
{'0': {'precision': 0.445992319633957, 'recall': 0.4505199735886431, 'f1-score': 0.4482447136111681, 'support': 24232}, '1': {'precision': 0.4722294790741418, 'recall': 0.37500518650678394, 'f1-score': 0.41803885291396853, 'support': 24101}, '2': {'precision': 0.4332781281933824, 'recall': 0.519629801800279, 'f1-score': 0.47254140886207296, 'support': 23663}, 'accuracy': 0.4479554419689983, 'macro avg': {'precision': 0.4504999756338271, 'recall': 0.4483849872985686, 'f1-score': 0.4462749917957365, 'support': 71996}, 'weighted avg': {'precision': 0.45059654580776637, 'recall': 0.4479554419689983, 'f1-score': 0.4461187795462055, 'support': 71996}}
[[10917  5112  8203]
 [ 7183  9038  7880]
 [ 6378  4989 12296]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0613501
{'0': {'precision': 0.43668104664758295, 'recall': 0.4422621478154349, 'f1-score': 0.4394538778325523, 'support': 24490}, '1': {'precision': 0.44308048001761535, 'recall': 0.33982099130287935, 'f1-score': 0.3846411163146325, 'support': 23686}, '2': {'precision': 0.4238123126744066, 'recall': 0.5164567590260285, 'f1-score': 0.4655704202698355, 'support': 23820}, 'accuracy': 0.4331073948552697, 'macro avg': {'precision': 0.4345246131132017, 'recall': 0.4328466327147809, 'f1-score': 0.4298884714723401, 'support': 71996}, 'weighted avg': {'precision': 0.43452875673649793, 'recall': 0.4331073948552697, 'f1-score': 0.43006170287203555, 'support': 71996}}
[[10831  5045  8614]
 [ 7526  8049  8111]
 [ 6446  5072 12302]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.075191
{'0': {'precision': 0.4215553609806575, 'recall': 0.42985268455014003, 'f1-score': 0.4256635923403059, 'support': 24641}, '1': {'precision': 0.4106249272663796, 'recall': 0.2960026844511556, 'f1-score': 0.3440173544251347, 'support': 23841}, '2': {'precision': 0.40456137986794233, 'recall': 0.5107170196478693, 'f1-score': 0.451483138463852, 'support': 23514}, 'accuracy': 0.4119395521973443, 'macro avg': {'precision': 0.41224722270499314, 'recall': 0.4121907962163884, 'f1-score': 0.4070546950764309, 'support': 71996}, 'weighted avg': {'precision': 0.41238556068527327, 'recall': 0.4119395521973443, 'f1-score': 0.40705968169823503, 'support': 71996}}
[[10592  5081  8968]
 [ 8077  7057  8707]
 [ 6457  5048 12009]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0600967
{'0': {'precision': 0.40492170022371365, 'recall': 0.5551201226784801, 'f1-score': 0.46827164929931725, 'support': 5869}, '1': {'precision': 0.5180577849117175, 'recall': 0.4008694302126999, 'f1-score': 0.4519912472647702, 'support': 6441}, '2': {'precision': 0.44231471339905076, 'recall': 0.39093255888996453, 'f1-score': 0.41503939705378556, 'support': 6198}, 'accuracy': 0.4464555867732872, 'macro avg': {'precision': 0.4550980661781607, 'recall': 0.4489740372603815, 'f1-score': 0.44510076453929104, 'support': 18508}, 'weighted avg': {'precision': 0.4568166330709241, 'recall': 0.4464555867732872, 'f1-score': 0.44477934494864063, 'support': 18508}}
[[3258 1083 1528]
 [2332 2582 1527]
 [2456 1319 2423]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0667793
{'0': {'precision': 0.414305160252444, 'recall': 0.5399129172714079, 'f1-score': 0.46884189889371236, 'support': 6201}, '1': {'precision': 0.4697442295695571, 'recall': 0.3821688377601083, 'f1-score': 0.42145522388059703, 'support': 5911}, '2': {'precision': 0.4425062299750801, 'recall': 0.3886804252657911, 'f1-score': 0.4138505077409689, 'support': 6396}, 'accuracy': 0.4372703695699157, 'macro avg': {'precision': 0.44218520659902705, 'recall': 0.4369207267657691, 'f1-score': 0.43471587683842605, 'support': 18508}, 'weighted avg': {'precision': 0.44175676932308566, 'recall': 0.4372703695699157, 'f1-score': 0.43470381947856906, 'support': 18508}}
[[3348 1167 1686]
 [2206 2259 1446]
 [2527 1383 2486]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0754763
{'0': {'precision': 0.4137509175434304, 'recall': 0.5317610062893082, 'f1-score': 0.46539149580294487, 'support': 6360}, '1': {'precision': 0.430952380952381, 'recall': 0.35382974942242756, 'f1-score': 0.38860154191470675, 'support': 5627}, '2': {'precision': 0.440322016100805, 'recall': 0.38583039411133263, 'f1-score': 0.41127911728647326, 'support': 6521}, 'accuracy': 0.4262481089258699, 'macro avg': {'precision': 0.4283417715322055, 'recall': 0.42380704994102275, 'f1-score': 0.421757385001375, 'support': 18508}, 'weighted avg': {'precision': 0.42834259510420436, 'recall': 0.4262481089258699, 'f1-score': 0.42297935560221933, 'support': 18508}}
[[3382 1226 1752]
 [2190 1991 1446]
 [2602 1403 2516]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0915833
{'0': {'precision': 0.3976210705182668, 'recall': 0.5146088595664468, 'f1-score': 0.4486134885313249, 'support': 6366}, '1': {'precision': 0.4021423789332738, 'recall': 0.32035555555555556, 'f1-score': 0.35661982980407675, 'support': 5625}, '2': {'precision': 0.4127505183137526, 'recall': 0.36657971459260397, 'f1-score': 0.3882974400650142, 'support': 6517}, 'accuracy': 0.4034471579857359, 'macro avg': {'precision': 0.4041713225884311, 'recall': 0.40051470990486876, 'f1-score': 0.3978435861334719, 'support': 18508}, 'weighted avg': {'precision': 0.40432254939862095, 'recall': 0.4034471579857359, 'f1-score': 0.39941616747039355, 'support': 18508}}
[[3276 1241 1849]
 [2273 1802 1550]
 [2690 1438 2389]]
training model: results/LILAK/W8/deepLOB_L1/seq2seq
Epoch 1/50
224/224 - 11s - loss: 13.1400 - accuracy10: 0.3944 - accuracy20: 0.3929 - accuracy30: 0.3914 - accuracy50: 0.3856 - val_loss: 13.4910 - val_accuracy10: 0.3302 - val_accuracy20: 0.3546 - val_accuracy30: 0.3503 - val_accuracy50: 0.3521 - 11s/epoch - 48ms/step
Epoch 2/50
224/224 - 5s - loss: 12.9892 - accuracy10: 0.4084 - accuracy20: 0.4105 - accuracy30: 0.4051 - accuracy50: 0.3982 - val_loss: 13.3064 - val_accuracy10: 0.3544 - val_accuracy20: 0.3886 - val_accuracy30: 0.3831 - val_accuracy50: 0.3746 - 5s/epoch - 21ms/step
Epoch 3/50
224/224 - 5s - loss: 12.9715 - accuracy10: 0.4126 - accuracy20: 0.4152 - accuracy30: 0.4088 - accuracy50: 0.3988 - val_loss: 13.4564 - val_accuracy10: 0.3534 - val_accuracy20: 0.3879 - val_accuracy30: 0.3802 - val_accuracy50: 0.3763 - 5s/epoch - 22ms/step
Epoch 4/50
224/224 - 5s - loss: 12.8879 - accuracy10: 0.4213 - accuracy20: 0.4226 - accuracy30: 0.4141 - accuracy50: 0.4021 - val_loss: 13.3108 - val_accuracy10: 0.3695 - val_accuracy20: 0.3964 - val_accuracy30: 0.3856 - val_accuracy50: 0.3777 - 5s/epoch - 21ms/step
Epoch 5/50
224/224 - 5s - loss: 12.8649 - accuracy10: 0.4260 - accuracy20: 0.4267 - accuracy30: 0.4186 - accuracy50: 0.4045 - val_loss: 13.2817 - val_accuracy10: 0.3663 - val_accuracy20: 0.3880 - val_accuracy30: 0.3771 - val_accuracy50: 0.3660 - 5s/epoch - 21ms/step
Epoch 6/50
224/224 - 5s - loss: 12.8358 - accuracy10: 0.4301 - accuracy20: 0.4306 - accuracy30: 0.4218 - accuracy50: 0.4042 - val_loss: 13.2070 - val_accuracy10: 0.3749 - val_accuracy20: 0.4025 - val_accuracy30: 0.3892 - val_accuracy50: 0.3806 - 5s/epoch - 22ms/step
Epoch 7/50
224/224 - 5s - loss: 12.8160 - accuracy10: 0.4286 - accuracy20: 0.4303 - accuracy30: 0.4189 - accuracy50: 0.3991 - val_loss: 13.2929 - val_accuracy10: 0.3655 - val_accuracy20: 0.3882 - val_accuracy30: 0.3787 - val_accuracy50: 0.3697 - 5s/epoch - 21ms/step
Epoch 8/50
224/224 - 5s - loss: 12.7853 - accuracy10: 0.4344 - accuracy20: 0.4324 - accuracy30: 0.4222 - accuracy50: 0.4037 - val_loss: 13.3114 - val_accuracy10: 0.3663 - val_accuracy20: 0.3826 - val_accuracy30: 0.3756 - val_accuracy50: 0.3644 - 5s/epoch - 21ms/step
Epoch 9/50
224/224 - 5s - loss: 12.6976 - accuracy10: 0.4506 - accuracy20: 0.4517 - accuracy30: 0.4356 - accuracy50: 0.4121 - val_loss: 13.3831 - val_accuracy10: 0.3691 - val_accuracy20: 0.3924 - val_accuracy30: 0.3817 - val_accuracy50: 0.3733 - 5s/epoch - 21ms/step
Epoch 10/50
224/224 - 5s - loss: 12.6825 - accuracy10: 0.4516 - accuracy20: 0.4491 - accuracy30: 0.4355 - accuracy50: 0.4092 - val_loss: 13.2784 - val_accuracy10: 0.3823 - val_accuracy20: 0.3925 - val_accuracy30: 0.3832 - val_accuracy50: 0.3689 - 5s/epoch - 21ms/step
Epoch 11/50
224/224 - 5s - loss: 12.6549 - accuracy10: 0.4609 - accuracy20: 0.4571 - accuracy30: 0.4419 - accuracy50: 0.4175 - val_loss: 13.2535 - val_accuracy10: 0.3890 - val_accuracy20: 0.3948 - val_accuracy30: 0.3814 - val_accuracy50: 0.3694 - 5s/epoch - 21ms/step
Epoch 12/50
224/224 - 5s - loss: 12.5776 - accuracy10: 0.4653 - accuracy20: 0.4635 - accuracy30: 0.4468 - accuracy50: 0.4197 - val_loss: 13.3483 - val_accuracy10: 0.3845 - val_accuracy20: 0.3912 - val_accuracy30: 0.3818 - val_accuracy50: 0.3670 - 5s/epoch - 21ms/step
Epoch 13/50
224/224 - 5s - loss: 12.5417 - accuracy10: 0.4703 - accuracy20: 0.4661 - accuracy30: 0.4486 - accuracy50: 0.4224 - val_loss: 13.1868 - val_accuracy10: 0.4002 - val_accuracy20: 0.4073 - val_accuracy30: 0.3942 - val_accuracy50: 0.3765 - 5s/epoch - 21ms/step
Epoch 14/50
224/224 - 5s - loss: 12.5114 - accuracy10: 0.4727 - accuracy20: 0.4694 - accuracy30: 0.4519 - accuracy50: 0.4257 - val_loss: 13.1784 - val_accuracy10: 0.4022 - val_accuracy20: 0.4053 - val_accuracy30: 0.3893 - val_accuracy50: 0.3670 - 5s/epoch - 21ms/step
Epoch 15/50
224/224 - 5s - loss: 12.4959 - accuracy10: 0.4766 - accuracy20: 0.4706 - accuracy30: 0.4525 - accuracy50: 0.4215 - val_loss: 13.2262 - val_accuracy10: 0.4040 - val_accuracy20: 0.4092 - val_accuracy30: 0.3937 - val_accuracy50: 0.3740 - 5s/epoch - 21ms/step
Epoch 16/50
224/224 - 5s - loss: 12.4595 - accuracy10: 0.4783 - accuracy20: 0.4713 - accuracy30: 0.4523 - accuracy50: 0.4246 - val_loss: 13.1266 - val_accuracy10: 0.4133 - val_accuracy20: 0.4180 - val_accuracy30: 0.3980 - val_accuracy50: 0.3773 - 5s/epoch - 21ms/step
Epoch 17/50
224/224 - 5s - loss: 12.3747 - accuracy10: 0.4820 - accuracy20: 0.4766 - accuracy30: 0.4606 - accuracy50: 0.4321 - val_loss: 13.3494 - val_accuracy10: 0.3995 - val_accuracy20: 0.3937 - val_accuracy30: 0.3776 - val_accuracy50: 0.3580 - 5s/epoch - 21ms/step
Epoch 18/50
224/224 - 5s - loss: 12.3229 - accuracy10: 0.4861 - accuracy20: 0.4793 - accuracy30: 0.4610 - accuracy50: 0.4296 - val_loss: 13.2569 - val_accuracy10: 0.4095 - val_accuracy20: 0.4038 - val_accuracy30: 0.3838 - val_accuracy50: 0.3658 - 5s/epoch - 21ms/step
Epoch 19/50
224/224 - 5s - loss: 12.2965 - accuracy10: 0.4865 - accuracy20: 0.4814 - accuracy30: 0.4626 - accuracy50: 0.4331 - val_loss: 13.2558 - val_accuracy10: 0.4077 - val_accuracy20: 0.4018 - val_accuracy30: 0.3837 - val_accuracy50: 0.3655 - 5s/epoch - 21ms/step
Epoch 20/50
224/224 - 5s - loss: 12.2676 - accuracy10: 0.4899 - accuracy20: 0.4836 - accuracy30: 0.4642 - accuracy50: 0.4352 - val_loss: 13.2673 - val_accuracy10: 0.4103 - val_accuracy20: 0.3989 - val_accuracy30: 0.3816 - val_accuracy50: 0.3617 - 5s/epoch - 21ms/step
Epoch 21/50
224/224 - 5s - loss: 12.2388 - accuracy10: 0.4921 - accuracy20: 0.4839 - accuracy30: 0.4634 - accuracy50: 0.4346 - val_loss: 13.2083 - val_accuracy10: 0.4172 - val_accuracy20: 0.4066 - val_accuracy30: 0.3892 - val_accuracy50: 0.3673 - 5s/epoch - 21ms/step
Epoch 22/50
224/224 - 5s - loss: 12.2140 - accuracy10: 0.4936 - accuracy20: 0.4864 - accuracy30: 0.4654 - accuracy50: 0.4362 - val_loss: 13.3278 - val_accuracy10: 0.4161 - val_accuracy20: 0.3970 - val_accuracy30: 0.3803 - val_accuracy50: 0.3595 - 5s/epoch - 21ms/step
Epoch 23/50
224/224 - 5s - loss: 12.1888 - accuracy10: 0.4942 - accuracy20: 0.4882 - accuracy30: 0.4675 - accuracy50: 0.4380 - val_loss: 13.2713 - val_accuracy10: 0.4170 - val_accuracy20: 0.4002 - val_accuracy30: 0.3820 - val_accuracy50: 0.3576 - 5s/epoch - 21ms/step
Epoch 24/50
224/224 - 5s - loss: 12.1638 - accuracy10: 0.4966 - accuracy20: 0.4893 - accuracy30: 0.4697 - accuracy50: 0.4402 - val_loss: 13.3030 - val_accuracy10: 0.4146 - val_accuracy20: 0.3968 - val_accuracy30: 0.3794 - val_accuracy50: 0.3592 - 5s/epoch - 21ms/step
Epoch 25/50
224/224 - 5s - loss: 12.1413 - accuracy10: 0.4977 - accuracy20: 0.4920 - accuracy30: 0.4728 - accuracy50: 0.4426 - val_loss: 13.1990 - val_accuracy10: 0.4251 - val_accuracy20: 0.4055 - val_accuracy30: 0.3864 - val_accuracy50: 0.3602 - 5s/epoch - 21ms/step
Epoch 26/50
224/224 - 5s - loss: 12.1219 - accuracy10: 0.5001 - accuracy20: 0.4930 - accuracy30: 0.4737 - accuracy50: 0.4438 - val_loss: 13.2446 - val_accuracy10: 0.4117 - val_accuracy20: 0.3980 - val_accuracy30: 0.3784 - val_accuracy50: 0.3571 - 5s/epoch - 21ms/step
testing model: results/LILAK/W8/deepLOB_L1/seq2seq
Evaluating performance on  test set...
645/645 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0820293
{'0': {'precision': 0.3946143265262935, 'recall': 0.46661523062807575, 'f1-score': 0.42760505245456804, 'support': 47956}, '1': {'precision': 0.5558205072620854, 'recall': 0.40212153183723515, 'f1-score': 0.4666407458574962, 'support': 70138}, '2': {'precision': 0.37675511091779035, 'recall': 0.4623959000640615, 'f1-score': 0.4152054072192129, 'support': 46830}, 'accuracy': 0.4379896194610851, 'macro avg': {'precision': 0.4423966482353898, 'recall': 0.4437108875097908, 'f1-score': 0.4364837351770923, 'support': 164924}, 'weighted avg': {'precision': 0.4581001262734544, 'recall': 0.4379896194610851, 'f1-score': 0.44068507766328785, 'support': 164924}}
[[22377 11144 14435]
 [20548 28204 21386]
 [13781 11395 21654]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0700595
{'0': {'precision': 0.4305226833366457, 'recall': 0.4359893879791419, 'f1-score': 0.4332387913166794, 'support': 54655}, '1': {'precision': 0.4741524508745411, 'recall': 0.38559336915674497, 'f1-score': 0.42531184628496166, 'support': 56946}, '2': {'precision': 0.408077135857109, 'recall': 0.484162556495321, 'f1-score': 0.44287576766047965, 'support': 53323}, 'accuracy': 0.43416361475588755, 'macro avg': {'precision': 0.4375840900227652, 'recall': 0.4352484378770693, 'f1-score': 0.43380880175404024, 'support': 164924}, 'weighted avg': {'precision': 0.4383303815125427, 'recall': 0.43416361475588755, 'f1-score': 0.4336175395752971, 'support': 164924}}
[[23829 12248 18578]
 [16118 21958 18870]
 [15402 12104 25817]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0847045
{'0': {'precision': 0.4135676877284202, 'recall': 0.4042090920807939, 'f1-score': 0.4088348402596072, 'support': 54311}, '1': {'precision': 0.4593642117376295, 'recall': 0.331671599937685, 'f1-score': 0.38521154368082994, 'support': 57771}, '2': {'precision': 0.3921146442321403, 'recall': 0.5204004390446992, 'f1-score': 0.4472400221188563, 'support': 52842}, 'accuracy': 0.4160279886493173, 'macro avg': {'precision': 0.42168218123273, 'recall': 0.41876037702105934, 'f1-score': 0.4137621353530978, 'support': 164924}, 'weighted avg': {'precision': 0.42273608810741664, 'recall': 0.4160279886493173, 'f1-score': 0.41286497021736895, 'support': 164924}}
[[21953 11737 20621]
 [16600 19161 22010]
 [14529 10814 27499]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0878617
{'0': {'precision': 0.4061926469717601, 'recall': 0.36719293550976717, 'f1-score': 0.38570946705644255, 'support': 56055}, '1': {'precision': 0.4272290443139349, 'recall': 0.2926954168038334, 'f1-score': 0.34739195554494356, 'support': 54678}, '2': {'precision': 0.39219439778098997, 'recall': 0.5557564909302283, 'f1-score': 0.45986471423554387, 'support': 54191}, 'accuracy': 0.4044529601513424, 'macro avg': {'precision': 0.40853869635556167, 'recall': 0.4052149477479429, 'f1-score': 0.39765537894564335, 'support': 164924}, 'weighted avg': {'precision': 0.40856737115974007, 'recall': 0.4044529601513424, 'f1-score': 0.39737194253276464, 'support': 164924}}
[[20583 11607 23865]
 [15865 16004 22809]
 [14225  9849 30117]]
Evaluating performance on  train set...
224/224 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0958519
{'0': {'precision': 0.3883731211317418, 'recall': 0.6162749912311469, 'f1-score': 0.47647457627118645, 'support': 17106}, '1': {'precision': 0.6361005130903828, 'recall': 0.21221032303370788, 'f1-score': 0.318249136086885, 'support': 22784}, '2': {'precision': 0.4068008389486367, 'recall': 0.5280352177942539, 'f1-score': 0.45955687747334456, 'support': 17264}, 'accuracy': 0.4285439339328831, 'macro avg': {'precision': 0.47709149105692045, 'recall': 0.4521735106863696, 'f1-score': 0.41809352994380533, 'support': 57154}, 'weighted avg': {'precision': 0.4926940263838073, 'recall': 0.4285439339328831, 'f1-score': 0.40828904977776403, 'support': 57154}}
[[10542  1228  5336]
 [ 9992  4835  7957]
 [ 6610  1538  9116]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0738043
{'0': {'precision': 0.412926992632284, 'recall': 0.5871117930268239, 'f1-score': 0.48484980884762424, 'support': 18901}, '1': {'precision': 0.5584435096153846, 'recall': 0.1967395331604298, 'f1-score': 0.2909702923793495, 'support': 18893}, '2': {'precision': 0.43125634947511005, 'recall': 0.5262396694214876, 'f1-score': 0.474036850921273, 'support': 19360}, 'accuracy': 0.4374496973090247, 'macro avg': {'precision': 0.4675422839075929, 'recall': 0.43669699853624716, 'f1-score': 0.4166189840494156, 'support': 57154}, 'weighted avg': {'precision': 0.4672381502737235, 'recall': 0.4374496973090247, 'f1-score': 0.4170976905341331, 'support': 57154}}
[[11097  1328  6476]
 [ 8216  3717  6960]
 [ 7561  1611 10188]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0867146
{'0': {'precision': 0.4051062855398237, 'recall': 0.5594497733740909, 'f1-score': 0.4699293888483077, 'support': 18974}, '1': {'precision': 0.53288335064036, 'recall': 0.1636112439555768, 'f1-score': 0.25035573443915926, 'support': 18819}, '2': {'precision': 0.4135780399634529, 'recall': 0.5377304891276277, 'f1-score': 0.467552880944896, 'support': 19361}, 'accuracy': 0.42175525772474365, 'macro avg': {'precision': 0.45052255871454544, 'recall': 0.4202638354857651, 'f1-score': 0.3959460014107877, 'support': 57154}, 'weighted avg': {'precision': 0.4500490406492277, 'recall': 0.42175525772474365, 'f1-score': 0.39682570106016135, 'support': 57154}}
[[10615  1255  7104]
 [ 8082  3079  7658]
 [ 7506  1444 10411]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1038285
{'0': {'precision': 0.38703856262994785, 'recall': 0.5241181470463239, 'f1-score': 0.4452668396705405, 'support': 18824}, '1': {'precision': 0.48613344051446944, 'recall': 0.1272086663862011, 'f1-score': 0.20165055018339445, 'support': 19016}, '2': {'precision': 0.3900026229999625, 'recall': 0.5388837112975045, 'f1-score': 0.45251190191517576, 'support': 19314}, 'accuracy': 0.3970500752353291, 'macro avg': {'precision': 0.4210582087147932, 'recall': 0.3967368415766765, 'f1-score': 0.36647643058970353, 'support': 57154}, 'weighted avg': {'precision': 0.4210105691358534, 'recall': 0.3970500752353291, 'f1-score': 0.36666033393700154, 'support': 57154}}
[[ 9866  1183  7775]
 [ 8093  2419  8504]
 [ 7532  1374 10408]]
Evaluating performance on  val set...
68/68 - 1s - 578ms/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.103555
{'0': {'precision': 0.39439628093981655, 'recall': 0.5931594860166288, 'f1-score': 0.47377556410836913, 'support': 5292}, '1': {'precision': 0.4892744479495268, 'recall': 0.23657718120805368, 'f1-score': 0.3189389265885256, 'support': 6556}, '2': {'precision': 0.40913555992141454, 'recall': 0.4637223974763407, 'f1-score': 0.43472210141776113, 'support': 5389}, 'accuracy': 0.4170679352555549, 'macro avg': {'precision': 0.43093542960358594, 'recall': 0.4311530215670077, 'f1-score': 0.4091455307048853, 'support': 17237}, 'weighted avg': {'precision': 0.4350907891110466, 'recall': 0.4170679352555549, 'f1-score': 0.40267455430273125, 'support': 17237}}
[[3139  836 1317]
 [2713 1551 2292]
 [2107  783 2499]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0852265
{'0': {'precision': 0.42168376808010877, 'recall': 0.5702106318956871, 'f1-score': 0.4848269490441333, 'support': 5982}, '1': {'precision': 0.3906469760900141, 'recall': 0.2111364500190042, 'f1-score': 0.2741179373303726, 'support': 5262}, '2': {'precision': 0.4316307106598985, 'recall': 0.4540297013182046, 'f1-score': 0.44254696267382293, 'support': 5993}, 'accuracy': 0.42020073098567035, 'macro avg': {'precision': 0.41465381827667375, 'recall': 0.41179226107763195, 'f1-score': 0.4004972830161096, 'support': 17237}, 'weighted avg': {'precision': 0.41566743272179824, 'recall': 0.42020073098567035, 'f1-score': 0.4058030598548847, 'support': 17237}}
[[3411  902 1669]
 [2237 1111 1914]
 [2441  831 2721]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0983874
{'0': {'precision': 0.4074529578157668, 'recall': 0.5539207490386223, 'f1-score': 0.4695294784580499, 'support': 5981}, '1': {'precision': 0.36252945797329145, 'recall': 0.17086264346538318, 'f1-score': 0.2322596879718168, 'support': 5402}, '2': {'precision': 0.4032012195121951, 'recall': 0.4518278100444141, 'f1-score': 0.42613178669244406, 'support': 5854}, 'accuracy': 0.39919939664674825, 'macro avg': {'precision': 0.3910612117670844, 'recall': 0.3922037341828066, 'f1-score': 0.37597365104077024, 'support': 17237}, 'weighted avg': {'precision': 0.3919301625394333, 'recall': 0.39919939664674825, 'f1-score': 0.3804315208202656, 'support': 17237}}
[[3313  831 1837]
 [2401  923 2078]
 [2417  792 2645]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1083633
{'0': {'precision': 0.3921978833374354, 'recall': 0.5235748316083456, 'f1-score': 0.44846267501583054, 'support': 6087}, '1': {'precision': 0.30369718309859156, 'recall': 0.13110393311799354, 'f1-score': 0.1831453218314532, 'support': 5263}, '2': {'precision': 0.3855826875274163, 'recall': 0.44793613045693903, 'f1-score': 0.4144271570014144, 'support': 5887}, 'accuracy': 0.3779079886291118, 'macro avg': {'precision': 0.3604925846544811, 'recall': 0.36753829839442603, 'f1-score': 0.3486783846162327, 'support': 17237}, 'weighted avg': {'precision': 0.3629165209721388, 'recall': 0.3779079886291118, 'f1-score': 0.35582867116595845, 'support': 17237}}
[[3187  816 2084]
 [2455  690 2118]
 [2484  766 2637]]
training model: results/LILAK/W8/deepOF_L1/seq2seq
Epoch 1/50
224/224 - 10s - loss: 13.0744 - accuracy10: 0.3859 - accuracy20: 0.3853 - accuracy30: 0.3845 - accuracy50: 0.3787 - val_loss: 13.2047 - val_accuracy10: 0.3391 - val_accuracy20: 0.3542 - val_accuracy30: 0.3492 - val_accuracy50: 0.3543 - 10s/epoch - 45ms/step
Epoch 2/50
224/224 - 4s - loss: 13.0091 - accuracy10: 0.3951 - accuracy20: 0.3916 - accuracy30: 0.3841 - accuracy50: 0.3797 - val_loss: 13.1149 - val_accuracy10: 0.3973 - val_accuracy20: 0.3781 - val_accuracy30: 0.3619 - val_accuracy50: 0.3516 - 4s/epoch - 20ms/step
Epoch 3/50
224/224 - 4s - loss: 12.9697 - accuracy10: 0.4049 - accuracy20: 0.3990 - accuracy30: 0.3910 - accuracy50: 0.3819 - val_loss: 13.2793 - val_accuracy10: 0.3289 - val_accuracy20: 0.3658 - val_accuracy30: 0.3571 - val_accuracy50: 0.3571 - 4s/epoch - 20ms/step
Epoch 4/50
224/224 - 4s - loss: 12.9133 - accuracy10: 0.4109 - accuracy20: 0.4030 - accuracy30: 0.3967 - accuracy50: 0.3858 - val_loss: 13.2300 - val_accuracy10: 0.3444 - val_accuracy20: 0.3680 - val_accuracy30: 0.3563 - val_accuracy50: 0.3565 - 4s/epoch - 19ms/step
Epoch 5/50
224/224 - 4s - loss: 12.8581 - accuracy10: 0.4239 - accuracy20: 0.4123 - accuracy30: 0.4047 - accuracy50: 0.3925 - val_loss: 13.2317 - val_accuracy10: 0.3493 - val_accuracy20: 0.3685 - val_accuracy30: 0.3587 - val_accuracy50: 0.3628 - 4s/epoch - 20ms/step
Epoch 6/50
224/224 - 4s - loss: 12.8226 - accuracy10: 0.4187 - accuracy20: 0.4136 - accuracy30: 0.4029 - accuracy50: 0.3905 - val_loss: 13.1943 - val_accuracy10: 0.3805 - val_accuracy20: 0.3887 - val_accuracy30: 0.3644 - val_accuracy50: 0.3566 - 4s/epoch - 20ms/step
Epoch 7/50
224/224 - 4s - loss: 12.8332 - accuracy10: 0.4275 - accuracy20: 0.4162 - accuracy30: 0.4038 - accuracy50: 0.3887 - val_loss: 13.2322 - val_accuracy10: 0.3514 - val_accuracy20: 0.3688 - val_accuracy30: 0.3592 - val_accuracy50: 0.3573 - 4s/epoch - 20ms/step
Epoch 8/50
224/224 - 4s - loss: 12.7739 - accuracy10: 0.4345 - accuracy20: 0.4230 - accuracy30: 0.4076 - accuracy50: 0.3954 - val_loss: 13.2578 - val_accuracy10: 0.3586 - val_accuracy20: 0.3716 - val_accuracy30: 0.3618 - val_accuracy50: 0.3615 - 4s/epoch - 20ms/step
Epoch 9/50
224/224 - 4s - loss: 12.7551 - accuracy10: 0.4378 - accuracy20: 0.4243 - accuracy30: 0.4130 - accuracy50: 0.3980 - val_loss: 13.2255 - val_accuracy10: 0.3739 - val_accuracy20: 0.3792 - val_accuracy30: 0.3626 - val_accuracy50: 0.3586 - 4s/epoch - 20ms/step
Epoch 10/50
224/224 - 4s - loss: 12.7130 - accuracy10: 0.4390 - accuracy20: 0.4284 - accuracy30: 0.4151 - accuracy50: 0.4003 - val_loss: 13.1844 - val_accuracy10: 0.3920 - val_accuracy20: 0.3877 - val_accuracy30: 0.3695 - val_accuracy50: 0.3631 - 4s/epoch - 20ms/step
Epoch 11/50
224/224 - 4s - loss: 12.6791 - accuracy10: 0.4454 - accuracy20: 0.4316 - accuracy30: 0.4166 - accuracy50: 0.4033 - val_loss: 13.3084 - val_accuracy10: 0.3648 - val_accuracy20: 0.3760 - val_accuracy30: 0.3645 - val_accuracy50: 0.3650 - 4s/epoch - 20ms/step
Epoch 12/50
224/224 - 4s - loss: 12.6252 - accuracy10: 0.4472 - accuracy20: 0.4352 - accuracy30: 0.4202 - accuracy50: 0.4044 - val_loss: 13.2875 - val_accuracy10: 0.3684 - val_accuracy20: 0.3833 - val_accuracy30: 0.3694 - val_accuracy50: 0.3654 - 4s/epoch - 20ms/step
testing model: results/LILAK/W8/deepOF_L1/seq2seq
Evaluating performance on  test set...
645/645 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.093488
{'0': {'precision': 0.31349158725967885, 'recall': 0.27235950370138673, 'f1-score': 0.29148162199558125, 'support': 47955}, '1': {'precision': 0.5056806722689076, 'recall': 0.4289828623570675, 'f1-score': 0.464184884061772, 'support': 70138}, '2': {'precision': 0.3164251207729469, 'recall': 0.4308290266091488, 'f1-score': 0.364869508599953, 'support': 46826}, 'accuracy': 0.38396424911623284, 'macro avg': {'precision': 0.3785324601005111, 'recall': 0.3773904642225343, 'f1-score': 0.37351200488576874, 'support': 164919}, 'weighted avg': {'precision': 0.39606014324576644, 'recall': 0.38396424911623284, 'f1-score': 0.385767438505109, 'support': 164919}}
[[13061 14980 19914]
 [16382 30088 23668]
 [12220 14432 20174]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0947101
{'0': {'precision': 0.34592475886715596, 'recall': 0.3294238193694765, 'f1-score': 0.33747270358672526, 'support': 54653}, '1': {'precision': 0.4107691685538661, 'recall': 0.3567414743792365, 'f1-score': 0.38185372455404976, 'support': 56946}, '2': {'precision': 0.3464055379472381, 'recall': 0.41200300075018753, 'f1-score': 0.3763673899449189, 'support': 53320}, 'accuracy': 0.36555521195253426, 'macro avg': {'precision': 0.36769982178942007, 'recall': 0.3660560981663002, 'f1-score': 0.3652312726952313, 'support': 164919}, 'weighted avg': {'precision': 0.3684707656618211, 'recall': 0.36555521195253426, 'f1-score': 0.3653723773455047, 'support': 164919}}
[[18004 14700 21949]
 [17131 20315 19500]
 [16911 14441 21968]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.101544
{'0': {'precision': 0.33537302544404246, 'recall': 0.4147747150564363, 'f1-score': 0.37087161249958833, 'support': 54309}, '1': {'precision': 0.39581922567348743, 'recall': 0.23271191428225235, 'f1-score': 0.29310194471090956, 'support': 57771}, '2': {'precision': 0.3334221706617336, 'recall': 0.4025057249380193, 'f1-score': 0.36472141717970263, 'support': 52839}, 'accuracy': 0.3470673482133653, 'macro avg': {'precision': 0.35487147392642115, 'recall': 0.3499974514255693, 'f1-score': 0.3428983247967335, 'support': 164919}, 'weighted avg': {'precision': 0.35592224183277177, 'recall': 0.3470673482133653, 'f1-score': 0.3416584736354963, 'support': 164919}}
[[22526 10287 21496]
 [23304 13444 21023]
 [21337 10234 21268]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1048537
{'0': {'precision': 0.3424708523948465, 'recall': 0.5088307703286117, 'f1-score': 0.40939592498761995, 'support': 56054}, '1': {'precision': 0.34858595487766125, 'recall': 0.12037748271699769, 'f1-score': 0.1789559543230016, 'support': 54678}, '2': {'precision': 0.33299869331038656, 'recall': 0.38564600365401297, 'f1-score': 0.35739389948777583, 'support': 54187}, 'accuracy': 0.339566696378222, 'macro avg': {'precision': 0.3413518335276315, 'recall': 0.3382847522332075, 'f1-score': 0.3152485929327991, 'support': 164919}, 'weighted avg': {'precision': 0.3413860391789388, 'recall': 0.339566696378222, 'f1-score': 0.3159086344282541, 'support': 164919}}
[[28522  6217 21315]
 [27554  6582 20542]
 [27207  6083 20897]]
Evaluating performance on  train set...
224/224 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.085638
{'0': {'precision': 0.33704303726139323, 'recall': 0.28077690411923484, 'f1-score': 0.3063478344377221, 'support': 17042}, '1': {'precision': 0.485772273536843, 'recall': 0.5128339673794219, 'f1-score': 0.49893644175955076, 'support': 22869}, '2': {'precision': 0.34442436483469757, 'recall': 0.3758046743606101, 'f1-score': 0.3594309010733006, 'support': 17243}, 'accuracy': 0.4022990516849214, 'macro avg': {'precision': 0.3890798918776446, 'recall': 0.38980518195308894, 'f1-score': 0.3882383924235245, 'support': 57154}, 'weighted avg': {'precision': 0.39878088825571995, 'recall': 0.4022990516849214, 'f1-score': 0.3994230379027496, 'support': 57154}}
[[ 4785  6184  6073]
 [ 4880 11728  6261]
 [ 4532  6231  6480]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0894076
{'0': {'precision': 0.35879668751056276, 'recall': 0.33739471314297825, 'f1-score': 0.34776673583051215, 'support': 18877}, '1': {'precision': 0.4070917817611911, 'recall': 0.4374046203231069, 'f1-score': 0.42170416782932957, 'support': 19003}, '2': {'precision': 0.3723465894126942, 'recall': 0.36676351561689324, 'f1-score': 0.3695339658642411, 'support': 19274}, 'accuracy': 0.3805507925954439, 'macro avg': {'precision': 0.37941168622814936, 'recall': 0.3805209496943262, 'f1-score': 0.379668289841361, 'support': 57154}, 'weighted avg': {'precision': 0.3794236337489078, 'recall': 0.3805507925954439, 'f1-score': 0.3796905663925658, 'support': 57154}}
[[6369 5999 6509]
 [5284 8312 5407]
 [6098 6107 7069]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0939415
{'0': {'precision': 0.3486029604975037, 'recall': 0.4208077817720448, 'f1-score': 0.3813173652694611, 'support': 18916}, '1': {'precision': 0.4066461116820829, 'recall': 0.31462044105173875, 'f1-score': 0.3547625452045788, 'support': 18864}, '2': {'precision': 0.36932826362484156, 'recall': 0.37601940745328793, 'f1-score': 0.3726438016317553, 'support': 19374}, 'accuracy': 0.37057773734121846, 'macro avg': {'precision': 0.3748591119348094, 'recall': 0.3704825434256905, 'f1-score': 0.3695745707019317, 'support': 57154}, 'weighted avg': {'precision': 0.3747858702979541, 'recall': 0.37057773734121846, 'f1-score': 0.3696126421071128, 'support': 57154}}
[[7960 4275 6681]
 [7170 5935 5759]
 [7704 4385 7285]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0987303
{'0': {'precision': 0.33937517394934597, 'recall': 0.5175890062078845, 'f1-score': 0.40995146141077093, 'support': 18847}, '1': {'precision': 0.40461739854813755, 'recall': 0.1789850494841019, 'f1-score': 0.24818424030074088, 'support': 18996}, '2': {'precision': 0.35517568850902187, 'recall': 0.36797680078711614, 'f1-score': 0.3614629431812401, 'support': 19311}, 'accuracy': 0.3544983728173006, 'macro avg': {'precision': 0.3663894203355018, 'recall': 0.35485028549303416, 'f1-score': 0.3398662149642506, 'support': 57154}, 'weighted avg': {'precision': 0.3663980426049177, 'recall': 0.3544983728173006, 'f1-score': 0.3398025320666025, 'support': 57154}}
[[9755 2491 6601]
 [9296 3400 6300]
 [9693 2512 7106]]
Evaluating performance on  val set...
68/68 - 1s - 563ms/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0872414
{'0': {'precision': 0.34471838950463696, 'recall': 0.2898440471662229, 'f1-score': 0.31490856493439406, 'support': 5258}, '1': {'precision': 0.47353468899521534, 'recall': 0.48181956488665756, 'f1-score': 0.47764120352914563, 'support': 6573}, '2': {'precision': 0.36989879203395365, 'recall': 0.41931902294596596, 'f1-score': 0.39306157849089335, 'support': 5404}, 'accuracy': 0.40365535248041773, 'macro avg': {'precision': 0.39605062351126863, 'recall': 0.3969942116662821, 'f1-score': 0.3952037823181443, 'support': 17235}, 'weighted avg': {'precision': 0.40174098491049703, 'recall': 0.40365535248041773, 'f1-score': 0.40147546477440704, 'support': 17235}}
[[1524 1775 1959]
 [1505 3167 1901]
 [1392 1746 2266]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0900598
{'0': {'precision': 0.3683142751752121, 'recall': 0.3339464882943144, 'f1-score': 0.3502894229082617, 'support': 5980}, '1': {'precision': 0.36817777777777777, 'recall': 0.3940258751902588, 'f1-score': 0.3806635419538646, 'support': 5256}, '2': {'precision': 0.38526179702650293, 'recall': 0.39739956659443243, 'f1-score': 0.39123656355132513, 'support': 5999}, 'accuracy': 0.3743545111691326, 'macro avg': {'precision': 0.37391794999316424, 'recall': 0.3751239766930019, 'f1-score': 0.3740631761378171, 'support': 17235}, 'weighted avg': {'precision': 0.3741715860696118, 'recall': 0.3743545111691326, 'f1-score': 0.37380484306616285, 'support': 17235}}
[[1997 1816 2167]
 [1548 2071 1637]
 [1877 1738 2384]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0944498
{'0': {'precision': 0.3601773709054499, 'recall': 0.41980660220073357, 'f1-score': 0.3877126799599661, 'support': 5998}, '1': {'precision': 0.3681462140992167, 'recall': 0.2615470228158041, 'f1-score': 0.3058236633770741, 'support': 5391}, '2': {'precision': 0.36607421265980666, 'recall': 0.4016421484775915, 'f1-score': 0.3830342577487765, 'support': 5846}, 'accuracy': 0.3641427328111401, 'macro avg': {'precision': 0.36479926588815775, 'recall': 0.3609985911647097, 'f1-score': 0.3588568670286056, 'support': 17235}, 'weighted avg': {'precision': 0.36467014552416566, 'recall': 0.3641427328111401, 'f1-score': 0.3605114183037441, 'support': 17235}}
[[2518 1258 2222]
 [2137 1410 1844]
 [2336 1162 2348]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0982671
{'0': {'precision': 0.3579019540623929, 'recall': 0.514708299096138, 'f1-score': 0.42221623078997034, 'support': 6085}, '1': {'precision': 0.3262310606060606, 'recall': 0.13098859315589353, 'f1-score': 0.18692349430276722, 'support': 5260}, '2': {'precision': 0.3611111111111111, 'recall': 0.39066213921901527, 'f1-score': 0.37530582286739517, 'support': 5890}, 'accuracy': 0.35520742674789674, 'macro avg': {'precision': 0.3484147085931882, 'recall': 0.3454530104903489, 'f1-score': 0.32814851598671085, 'support': 17235}, 'weighted avg': {'precision': 0.3493329395823605, 'recall': 0.35520742674789674, 'f1-score': 0.33437508796509907, 'support': 17235}}
[[3132  746 2207]
 [2707  689 1864]
 [2912  677 2301]]
training model: results/LILAK/W8/deepLOB_L2/seq2seq
Epoch 1/50
224/224 - 16s - loss: 13.2324 - accuracy10: 0.3696 - accuracy20: 0.3711 - accuracy30: 0.3722 - accuracy50: 0.3708 - val_loss: 13.4676 - val_accuracy10: 0.3331 - val_accuracy20: 0.3276 - val_accuracy30: 0.3363 - val_accuracy50: 0.3392 - 16s/epoch - 72ms/step
Epoch 2/50
224/224 - 10s - loss: 13.0989 - accuracy10: 0.3811 - accuracy20: 0.3787 - accuracy30: 0.3775 - accuracy50: 0.3752 - val_loss: 13.4868 - val_accuracy10: 0.3436 - val_accuracy20: 0.3229 - val_accuracy30: 0.3309 - val_accuracy50: 0.3300 - 10s/epoch - 46ms/step
Epoch 3/50
224/224 - 10s - loss: 13.0989 - accuracy10: 0.3790 - accuracy20: 0.3769 - accuracy30: 0.3777 - accuracy50: 0.3802 - val_loss: 13.5039 - val_accuracy10: 0.3137 - val_accuracy20: 0.3467 - val_accuracy30: 0.3477 - val_accuracy50: 0.3513 - 10s/epoch - 46ms/step
Epoch 4/50
224/224 - 10s - loss: 13.0884 - accuracy10: 0.3850 - accuracy20: 0.3843 - accuracy30: 0.3821 - accuracy50: 0.3785 - val_loss: 13.3573 - val_accuracy10: 0.3259 - val_accuracy20: 0.3515 - val_accuracy30: 0.3475 - val_accuracy50: 0.3472 - 10s/epoch - 46ms/step
Epoch 5/50
224/224 - 10s - loss: 12.9886 - accuracy10: 0.4030 - accuracy20: 0.4045 - accuracy30: 0.3971 - accuracy50: 0.3896 - val_loss: 13.3982 - val_accuracy10: 0.3206 - val_accuracy20: 0.3551 - val_accuracy30: 0.3524 - val_accuracy50: 0.3520 - 10s/epoch - 46ms/step
Epoch 6/50
224/224 - 10s - loss: 12.9649 - accuracy10: 0.4040 - accuracy20: 0.4088 - accuracy30: 0.4054 - accuracy50: 0.3986 - val_loss: 13.6865 - val_accuracy10: 0.3196 - val_accuracy20: 0.3358 - val_accuracy30: 0.3459 - val_accuracy50: 0.3448 - 10s/epoch - 46ms/step
Epoch 7/50
224/224 - 10s - loss: 12.8727 - accuracy10: 0.4178 - accuracy20: 0.4214 - accuracy30: 0.4158 - accuracy50: 0.4057 - val_loss: 13.7310 - val_accuracy10: 0.3268 - val_accuracy20: 0.3483 - val_accuracy30: 0.3533 - val_accuracy50: 0.3479 - 10s/epoch - 46ms/step
Epoch 8/50
224/224 - 10s - loss: 12.8758 - accuracy10: 0.4230 - accuracy20: 0.4283 - accuracy30: 0.4199 - accuracy50: 0.4093 - val_loss: 13.6029 - val_accuracy10: 0.3302 - val_accuracy20: 0.3647 - val_accuracy30: 0.3664 - val_accuracy50: 0.3656 - 10s/epoch - 46ms/step
Epoch 9/50
224/224 - 10s - loss: 12.6921 - accuracy10: 0.4350 - accuracy20: 0.4437 - accuracy30: 0.4349 - accuracy50: 0.4220 - val_loss: 13.6035 - val_accuracy10: 0.3397 - val_accuracy20: 0.3592 - val_accuracy30: 0.3580 - val_accuracy50: 0.3552 - 10s/epoch - 46ms/step
Epoch 10/50
224/224 - 11s - loss: 12.5724 - accuracy10: 0.4510 - accuracy20: 0.4568 - accuracy30: 0.4462 - accuracy50: 0.4298 - val_loss: 13.4822 - val_accuracy10: 0.3487 - val_accuracy20: 0.3658 - val_accuracy30: 0.3602 - val_accuracy50: 0.3582 - 11s/epoch - 47ms/step
Epoch 11/50
224/224 - 10s - loss: 12.4860 - accuracy10: 0.4595 - accuracy20: 0.4636 - accuracy30: 0.4512 - accuracy50: 0.4302 - val_loss: 13.4796 - val_accuracy10: 0.3399 - val_accuracy20: 0.3656 - val_accuracy30: 0.3634 - val_accuracy50: 0.3562 - 10s/epoch - 47ms/step
Epoch 12/50
224/224 - 10s - loss: 12.4467 - accuracy10: 0.4612 - accuracy20: 0.4661 - accuracy30: 0.4523 - accuracy50: 0.4327 - val_loss: 13.6375 - val_accuracy10: 0.3552 - val_accuracy20: 0.3578 - val_accuracy30: 0.3638 - val_accuracy50: 0.3612 - 10s/epoch - 47ms/step
Epoch 13/50
224/224 - 10s - loss: 12.3644 - accuracy10: 0.4727 - accuracy20: 0.4750 - accuracy30: 0.4609 - accuracy50: 0.4365 - val_loss: 13.5580 - val_accuracy10: 0.3597 - val_accuracy20: 0.3563 - val_accuracy30: 0.3642 - val_accuracy50: 0.3567 - 10s/epoch - 46ms/step
Epoch 14/50
224/224 - 10s - loss: 12.2718 - accuracy10: 0.4831 - accuracy20: 0.4827 - accuracy30: 0.4669 - accuracy50: 0.4426 - val_loss: 13.5368 - val_accuracy10: 0.3625 - val_accuracy20: 0.3591 - val_accuracy30: 0.3604 - val_accuracy50: 0.3587 - 10s/epoch - 46ms/step
testing model: results/LILAK/W8/deepLOB_L2/seq2seq
Evaluating performance on  test set...
645/645 - 10s - 10s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1411473
{'0': {'precision': 0.30426764687558405, 'recall': 0.5091959296021353, 'f1-score': 0.38091895391191083, 'support': 47956}, '1': {'precision': 0.4482344553266539, 'recall': 0.1703071088425675, 'f1-score': 0.24683066940808168, 'support': 70138}, '2': {'precision': 0.28147190623922785, 'recall': 0.34872944693572494, 'f1-score': 0.3115116833571769, 'support': 46830}, 'accuracy': 0.3195108049768378, 'macro avg': {'precision': 0.344658002813822, 'recall': 0.34274416179347594, 'f1-score': 0.3130871022257231, 'support': 164924}, 'weighted avg': {'precision': 0.35902025703020424, 'recall': 0.3195108049768378, 'f1-score': 0.30418647968979784, 'support': 164924}}
[[24419  7219 16318]
 [32822 11945 25371]
 [23014  7485 16331]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1159455
{'0': {'precision': 0.34110174697167006, 'recall': 0.5080047571127985, 'f1-score': 0.408149765165046, 'support': 54655}, '1': {'precision': 0.36394087844910605, 'recall': 0.15263583043585152, 'f1-score': 0.21507132341115195, 'support': 56946}, '2': {'precision': 0.32139563737571886, 'recall': 0.35948840087767003, 'f1-score': 0.3393764495511924, 'support': 53323}, 'accuracy': 0.33728262714947493, 'macro avg': {'precision': 0.34214608759883164, 'recall': 0.3400429961421067, 'f1-score': 0.32086584604246343, 'support': 164924}, 'weighted avg': {'precision': 0.34261643433754263, 'recall': 0.33728262714947493, 'f1-score': 0.3192467282959744, 'support': 164924}}
[[27765  7447 19443]
 [27223  8692 21031]
 [26410  7744 19169]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1151873
{'0': {'precision': 0.33409915356711006, 'recall': 0.508736720001473, 'f1-score': 0.4033252804519345, 'support': 54311}, '1': {'precision': 0.3599833533709424, 'recall': 0.13475619255335722, 'f1-score': 0.196103127322191, 'support': 57771}, '2': {'precision': 0.32162777649427376, 'recall': 0.3688353960864464, 'f1-score': 0.34361777150916784, 'support': 52842}, 'accuracy': 0.33291091654337757, 'macro avg': {'precision': 0.33857009447744213, 'recall': 0.33744276954709224, 'f1-score': 0.31434872642776446, 'support': 164924}, 'weighted avg': {'precision': 0.339170238427921, 'recall': 0.33291091654337757, 'f1-score': 0.31160730613641896, 'support': 164924}}
[[27630  6963 19718]
 [28596  7785 21390]
 [26474  6878 19490]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1083497
{'0': {'precision': 0.33786104794619964, 'recall': 0.4983141557398983, 'f1-score': 0.4026929813812342, 'support': 56055}, '1': {'precision': 0.35211124127744103, 'recall': 0.12643110574636965, 'f1-score': 0.18605590020320006, 'support': 54678}, '2': {'precision': 0.3285315020362533, 'recall': 0.37960177889317415, 'f1-score': 0.35222505693200695, 'support': 54191}, 'accuracy': 0.3360153767796076, 'macro avg': {'precision': 0.339501263753298, 'recall': 0.3347823467931474, 'f1-score': 0.3136579795054804, 'support': 164924}, 'weighted avg': {'precision': 0.33951996143701796, 'recall': 0.3360153767796076, 'f1-score': 0.31428747570297866, 'support': 164924}}
[[27933  6611 21511]
 [27232  6913 20533]
 [27511  6109 20571]]
Evaluating performance on  train set...
224/224 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.140381
{'0': {'precision': 0.3281454877144975, 'recall': 0.6729802408511634, 'f1-score': 0.44117421629493375, 'support': 17106}, '1': {'precision': 0.46264150943396226, 'recall': 0.053809691011235956, 'f1-score': 0.09640638515373123, 'support': 22784}, '2': {'precision': 0.29935125115848005, 'recall': 0.3367701575532901, 'f1-score': 0.3169601482854495, 'support': 17264}, 'accuracy': 0.32459670364278964, 'macro avg': {'precision': 0.36337941610231334, 'recall': 0.3545200298052298, 'f1-score': 0.2848469165780382, 'support': 57154}, 'weighted avg': {'precision': 0.37306366770108107, 'recall': 0.32459670364278964, 'f1-score': 0.2662149494923146, 'support': 57154}}
[[11512   674  4920]
 [12870  1226  8688]
 [10700   750  5814]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1117952
{'0': {'precision': 0.3598109936811497, 'recall': 0.6808634463784985, 'f1-score': 0.4708142023524247, 'support': 18901}, '1': {'precision': 0.4068647969861867, 'recall': 0.05144762610490658, 'f1-score': 0.09134479842120101, 'support': 18893}, '2': {'precision': 0.3395441865361335, 'recall': 0.33321280991735536, 'f1-score': 0.3363487056492609, 'support': 19360}, 'accuracy': 0.35504076705042514, 'macro avg': {'precision': 0.3687399924011567, 'recall': 0.35517462746692013, 'f1-score': 0.2995025688076289, 'support': 57154}, 'weighted avg': {'precision': 0.368500186380078, 'recall': 0.35504076705042514, 'f1-score': 0.2998276141058302, 'support': 57154}}
[[12869   683  5349]
 [10722   972  7199]
 [12175   734  6451]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1098713
{'0': {'precision': 0.3585923947462621, 'recall': 0.6863602824918309, 'f1-score': 0.4710712412508365, 'support': 18974}, '1': {'precision': 0.38660907127429806, 'recall': 0.047558318720442104, 'f1-score': 0.08469764360745718, 'support': 18819}, '2': {'precision': 0.33657272432782637, 'recall': 0.3219875006456278, 'f1-score': 0.3291186020114563, 'support': 19361}, 'accuracy': 0.3525912447072821, 'macro avg': {'precision': 0.36059139678279556, 'recall': 0.35196870061930025, 'f1-score': 0.29496249562325, 'support': 57154}, 'weighted avg': {'precision': 0.3603582028543521, 'recall': 0.3525912447072821, 'f1-score': 0.29576400497053423, 'support': 57154}}
[[13023   685  5266]
 [10902   895  7022]
 [12392   735  6234]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1103201
{'0': {'precision': 0.35131255693267455, 'recall': 0.6761049723756906, 'f1-score': 0.46237125574467314, 'support': 18824}, '1': {'precision': 0.385146804835924, 'recall': 0.046907867059318466, 'f1-score': 0.08363022688918056, 'support': 19016}, '2': {'precision': 0.3383482886464994, 'recall': 0.3260329294812053, 'f1-score': 0.3320764667106131, 'support': 19314}, 'accuracy': 0.34846204990026947, 'macro avg': {'precision': 0.3582692168050327, 'recall': 0.3496819229720714, 'f1-score': 0.29269264978148896, 'support': 57154}, 'weighted avg': {'precision': 0.35818871923888246, 'recall': 0.34846204990026947, 'f1-score': 0.2923279873799063, 'support': 57154}}
[[12727   682  5415]
 [11225   892  6899]
 [12275   742  6297]]
Evaluating performance on  val set...
68/68 - 1s - 1s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1379749
{'0': {'precision': 0.3120320390040049, 'recall': 0.6772486772486772, 'f1-score': 0.42722612945523897, 'support': 5292}, '1': {'precision': 0.4279100529100529, 'recall': 0.0986882245271507, 'f1-score': 0.16038671294000992, 'support': 6556}, '2': {'precision': 0.31634819532908703, 'recall': 0.2488402300983485, 'f1-score': 0.2785625259659327, 'support': 5389}, 'accuracy': 0.32325810755932005, 'macro avg': {'precision': 0.3520967624143816, 'recall': 0.3415923772913922, 'f1-score': 0.28872512278706053, 'support': 17237}, 'weighted avg': {'precision': 0.3574550259277108, 'recall': 0.32325810755932005, 'f1-score': 0.2792567975600302, 'support': 17237}}
[[3584  440 1268]
 [4279  647 1630]
 [3623  425 1341]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.110919
{'0': {'precision': 0.3485827517877143, 'recall': 0.6763624205951186, 'f1-score': 0.4600602649383137, 'support': 5982}, '1': {'precision': 0.34332833583208394, 'recall': 0.0870391486126948, 'f1-score': 0.13887204366282596, 'support': 5262}, '2': {'precision': 0.3605679702048417, 'recall': 0.25846821291506755, 'f1-score': 0.30109826027796677, 'support': 5993}, 'accuracy': 0.3511631954516447, 'macro avg': {'precision': 0.3508263526082133, 'recall': 0.340623260707627, 'f1-score': 0.3000101896263688, 'support': 17237}, 'weighted avg': {'precision': 0.3511457660718309, 'recall': 0.3511631954516447, 'f1-score': 0.30674172260025745, 'support': 17237}}
[[4046  475 1461]
 [3518  458 1286]
 [4043  401 1549]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1123657
{'0': {'precision': 0.34725915758771553, 'recall': 0.6768098980103662, 'f1-score': 0.45900895793173835, 'support': 5981}, '1': {'precision': 0.3145025295109612, 'recall': 0.06904850055534988, 'f1-score': 0.11323618700667881, 'support': 5402}, '2': {'precision': 0.35639508420573507, 'recall': 0.267509395285275, 'f1-score': 0.30562060889929743, 'support': 5854}, 'accuracy': 0.34733422289261473, 'macro avg': {'precision': 0.33938559043480393, 'recall': 0.33778926461699704, 'f1-score': 0.29262191794590486, 'support': 17237}, 'weighted avg': {'precision': 0.3400961019255504, 'recall': 0.34733422289261473, 'f1-score': 0.2985518073966638, 'support': 17237}}
[[4048  427 1506]
 [3707  373 1322]
 [3902  386 1566]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1096356
{'0': {'precision': 0.34868764123066226, 'recall': 0.65910957778873, 'f1-score': 0.45609049053600864, 'support': 6087}, '1': {'precision': 0.2830188679245283, 'recall': 0.05985179555386662, 'f1-score': 0.09880803011292347, 'support': 5263}, '2': {'precision': 0.36444348202685145, 'recall': 0.28588415152029895, 'f1-score': 0.32041884816753924, 'support': 5887}, 'accuracy': 0.34866856181470096, 'macro avg': {'precision': 0.33204999706068067, 'recall': 0.33494850828763184, 'f1-score': 0.2917724562721571, 'support': 17237}, 'weighted avg': {'precision': 0.3340180282386673, 'recall': 0.34866856181470096, 'f1-score': 0.30066457257871465, 'support': 17237}}
[[4012  416 1659]
 [3672  315 1276]
 [3822  382 1683]]
training model: results/LILAK/W8/deepOF_L2/seq2seq
Epoch 1/50
224/224 - 12s - loss: 13.0011 - accuracy10: 0.4231 - accuracy20: 0.4140 - accuracy30: 0.4003 - accuracy50: 0.3816 - val_loss: 13.2237 - val_accuracy10: 0.3680 - val_accuracy20: 0.3815 - val_accuracy30: 0.3599 - val_accuracy50: 0.3561 - 12s/epoch - 52ms/step
Epoch 2/50
224/224 - 6s - loss: 12.7730 - accuracy10: 0.4618 - accuracy20: 0.4450 - accuracy30: 0.4250 - accuracy50: 0.4003 - val_loss: 13.3056 - val_accuracy10: 0.3626 - val_accuracy20: 0.3890 - val_accuracy30: 0.3759 - val_accuracy50: 0.3681 - 6s/epoch - 28ms/step
Epoch 3/50
224/224 - 6s - loss: 12.6230 - accuracy10: 0.4777 - accuracy20: 0.4617 - accuracy30: 0.4403 - accuracy50: 0.4085 - val_loss: 13.1172 - val_accuracy10: 0.3943 - val_accuracy20: 0.4070 - val_accuracy30: 0.3880 - val_accuracy50: 0.3739 - 6s/epoch - 28ms/step
Epoch 4/50
224/224 - 6s - loss: 12.4716 - accuracy10: 0.4900 - accuracy20: 0.4721 - accuracy30: 0.4499 - accuracy50: 0.4184 - val_loss: 13.0889 - val_accuracy10: 0.4049 - val_accuracy20: 0.4183 - val_accuracy30: 0.3932 - val_accuracy50: 0.3810 - 6s/epoch - 28ms/step
Epoch 5/50
224/224 - 6s - loss: 12.3586 - accuracy10: 0.4977 - accuracy20: 0.4815 - accuracy30: 0.4579 - accuracy50: 0.4253 - val_loss: 13.0467 - val_accuracy10: 0.4050 - val_accuracy20: 0.4161 - val_accuracy30: 0.3963 - val_accuracy50: 0.3796 - 6s/epoch - 28ms/step
Epoch 6/50
224/224 - 6s - loss: 12.2975 - accuracy10: 0.5042 - accuracy20: 0.4860 - accuracy30: 0.4607 - accuracy50: 0.4291 - val_loss: 12.9692 - val_accuracy10: 0.4198 - val_accuracy20: 0.4223 - val_accuracy30: 0.4029 - val_accuracy50: 0.3909 - 6s/epoch - 28ms/step
Epoch 7/50
224/224 - 6s - loss: 12.1778 - accuracy10: 0.5132 - accuracy20: 0.4944 - accuracy30: 0.4694 - accuracy50: 0.4347 - val_loss: 12.9780 - val_accuracy10: 0.4154 - val_accuracy20: 0.4342 - val_accuracy30: 0.4097 - val_accuracy50: 0.3940 - 6s/epoch - 28ms/step
Epoch 8/50
224/224 - 6s - loss: 12.0999 - accuracy10: 0.5171 - accuracy20: 0.4994 - accuracy30: 0.4750 - accuracy50: 0.4416 - val_loss: 12.9402 - val_accuracy10: 0.4261 - val_accuracy20: 0.4302 - val_accuracy30: 0.4042 - val_accuracy50: 0.3860 - 6s/epoch - 28ms/step
Epoch 9/50
224/224 - 6s - loss: 12.0076 - accuracy10: 0.5250 - accuracy20: 0.5092 - accuracy30: 0.4840 - accuracy50: 0.4484 - val_loss: 12.9277 - val_accuracy10: 0.4272 - val_accuracy20: 0.4353 - val_accuracy30: 0.4107 - val_accuracy50: 0.3933 - 6s/epoch - 28ms/step
Epoch 10/50
224/224 - 6s - loss: 11.9240 - accuracy10: 0.5315 - accuracy20: 0.5147 - accuracy30: 0.4891 - accuracy50: 0.4548 - val_loss: 12.9042 - val_accuracy10: 0.4326 - val_accuracy20: 0.4382 - val_accuracy30: 0.4111 - val_accuracy50: 0.3929 - 6s/epoch - 28ms/step
Epoch 11/50
224/224 - 6s - loss: 11.8325 - accuracy10: 0.5375 - accuracy20: 0.5210 - accuracy30: 0.4973 - accuracy50: 0.4592 - val_loss: 12.8944 - val_accuracy10: 0.4368 - val_accuracy20: 0.4376 - val_accuracy30: 0.4125 - val_accuracy50: 0.3912 - 6s/epoch - 28ms/step
Epoch 12/50
224/224 - 6s - loss: 11.7438 - accuracy10: 0.5417 - accuracy20: 0.5282 - accuracy30: 0.5039 - accuracy50: 0.4675 - val_loss: 12.8466 - val_accuracy10: 0.4414 - val_accuracy20: 0.4451 - val_accuracy30: 0.4164 - val_accuracy50: 0.3955 - 6s/epoch - 28ms/step
Epoch 13/50
224/224 - 6s - loss: 11.6784 - accuracy10: 0.5462 - accuracy20: 0.5336 - accuracy30: 0.5097 - accuracy50: 0.4750 - val_loss: 12.8809 - val_accuracy10: 0.4389 - val_accuracy20: 0.4474 - val_accuracy30: 0.4205 - val_accuracy50: 0.3999 - 6s/epoch - 28ms/step
Epoch 14/50
224/224 - 6s - loss: 11.5976 - accuracy10: 0.5508 - accuracy20: 0.5394 - accuracy30: 0.5145 - accuracy50: 0.4792 - val_loss: 12.9039 - val_accuracy10: 0.4399 - val_accuracy20: 0.4415 - val_accuracy30: 0.4164 - val_accuracy50: 0.3942 - 6s/epoch - 28ms/step
Epoch 15/50
224/224 - 6s - loss: 11.5303 - accuracy10: 0.5527 - accuracy20: 0.5434 - accuracy30: 0.5200 - accuracy50: 0.4866 - val_loss: 12.9213 - val_accuracy10: 0.4419 - val_accuracy20: 0.4439 - val_accuracy30: 0.4148 - val_accuracy50: 0.3952 - 6s/epoch - 28ms/step
Epoch 16/50
224/224 - 6s - loss: 11.4587 - accuracy10: 0.5585 - accuracy20: 0.5483 - accuracy30: 0.5268 - accuracy50: 0.4927 - val_loss: 12.9151 - val_accuracy10: 0.4381 - val_accuracy20: 0.4465 - val_accuracy30: 0.4176 - val_accuracy50: 0.3963 - 6s/epoch - 28ms/step
Epoch 17/50
224/224 - 6s - loss: 11.3886 - accuracy10: 0.5580 - accuracy20: 0.5516 - accuracy30: 0.5300 - accuracy50: 0.4954 - val_loss: 12.8974 - val_accuracy10: 0.4487 - val_accuracy20: 0.4499 - val_accuracy30: 0.4188 - val_accuracy50: 0.3914 - 6s/epoch - 28ms/step
Epoch 18/50
224/224 - 6s - loss: 11.3092 - accuracy10: 0.5653 - accuracy20: 0.5604 - accuracy30: 0.5376 - accuracy50: 0.5035 - val_loss: 12.9128 - val_accuracy10: 0.4415 - val_accuracy20: 0.4452 - val_accuracy30: 0.4175 - val_accuracy50: 0.3973 - 6s/epoch - 28ms/step
Epoch 19/50
224/224 - 6s - loss: 11.2423 - accuracy10: 0.5688 - accuracy20: 0.5647 - accuracy30: 0.5422 - accuracy50: 0.5085 - val_loss: 12.9959 - val_accuracy10: 0.4347 - val_accuracy20: 0.4428 - val_accuracy30: 0.4150 - val_accuracy50: 0.3969 - 6s/epoch - 28ms/step
Epoch 20/50
224/224 - 6s - loss: 11.1857 - accuracy10: 0.5688 - accuracy20: 0.5669 - accuracy30: 0.5469 - accuracy50: 0.5130 - val_loss: 13.0337 - val_accuracy10: 0.4361 - val_accuracy20: 0.4462 - val_accuracy30: 0.4218 - val_accuracy50: 0.4016 - 6s/epoch - 28ms/step
Epoch 21/50
224/224 - 6s - loss: 11.1071 - accuracy10: 0.5743 - accuracy20: 0.5739 - accuracy30: 0.5547 - accuracy50: 0.5220 - val_loss: 13.1023 - val_accuracy10: 0.4294 - val_accuracy20: 0.4371 - val_accuracy30: 0.4133 - val_accuracy50: 0.3951 - 6s/epoch - 28ms/step
Epoch 22/50
224/224 - 6s - loss: 11.0277 - accuracy10: 0.5774 - accuracy20: 0.5785 - accuracy30: 0.5602 - accuracy50: 0.5264 - val_loss: 13.1829 - val_accuracy10: 0.4338 - val_accuracy20: 0.4397 - val_accuracy30: 0.4123 - val_accuracy50: 0.3934 - 6s/epoch - 28ms/step
testing model: results/LILAK/W8/deepOF_L2/seq2seq
Evaluating performance on  test set...
645/645 - 6s - 6s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0580243
{'0': {'precision': 0.44419606699711667, 'recall': 0.5718277551871547, 'f1-score': 0.49999544165777793, 'support': 47955}, '1': {'precision': 0.7337599483759948, 'recall': 0.19454503977872195, 'f1-score': 0.3075484030923885, 'support': 70138}, '2': {'precision': 0.35910106515031504, 'recall': 0.6486994404817836, 'f1-score': 0.46229121485370767, 'support': 46826}, 'accuracy': 0.4332005408715794, 'macro avg': {'precision': 0.5123523601744755, 'recall': 0.4716907451492201, 'f1-score': 0.42327835320129137, 'support': 164919}, 'weighted avg': {'precision': 0.5431826783376743, 'recall': 0.4332005408715794, 'f1-score': 0.4074446226786022, 'support': 164919}}
[[27422  2604 17929]
 [20209 13645 36284]
 [14103  2347 30376]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0493108
{'0': {'precision': 0.4701834862385321, 'recall': 0.5326331582895724, 'f1-score': 0.4994638184703814, 'support': 54653}, '1': {'precision': 0.6724123504309263, 'recall': 0.1411161451199382, 'f1-score': 0.23327575946703052, 'support': 56946}, '2': {'precision': 0.38063389562467054, 'recall': 0.6500187546886722, 'f1-score': 0.48012134980883253, 'support': 53320}, 'accuracy': 0.4353955578192931, 'macro avg': {'precision': 0.5077432440980431, 'recall': 0.4412560193660609, 'f1-score': 0.40428697591541485, 'support': 164919}, 'weighted avg': {'precision': 0.5110601634483684, 'recall': 0.4353955578192931, 'f1-score': 0.401296320261936, 'support': 164919}}
[[29110  2047 23496]
 [16009  8036 32901]
 [16793  1868 34659]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0811787
{'0': {'precision': 0.45013140604467805, 'recall': 0.5045940820121895, 'f1-score': 0.4758093220706838, 'support': 54309}, '1': {'precision': 0.6588491295938105, 'recall': 0.09433798964878572, 'f1-score': 0.16504398649364807, 'support': 57771}, '2': {'precision': 0.3660551129303414, 'recall': 0.6634493461269139, 'f1-score': 0.4717979085635843, 'support': 52839}, 'accuracy': 0.41177790309182083, 'macro avg': {'precision': 0.49167854952294326, 'recall': 0.4207938059292964, 'f1-score': 0.3708837390426387, 'support': 164919}, 'weighted avg': {'precision': 0.49630755527726184, 'recall': 0.41177790309182083, 'f1-score': 0.36566323047467264, 'support': 164919}}
[[27404  1583 25322]
 [16932  5450 35389]
 [16544  1239 35056]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0943873
{'0': {'precision': 0.44143765346967606, 'recall': 0.4682449066971135, 'f1-score': 0.454446291294411, 'support': 56054}, '1': {'precision': 0.5982070089649552, 'recall': 0.06712023117158637, 'f1-score': 0.12069787709864666, 'support': 54678}, '2': {'precision': 0.3674566578740712, 'recall': 0.6735563880635577, 'f1-score': 0.47550370326943, 'support': 54187}, 'accuracy': 0.40271284691272685, 'macro avg': {'precision': 0.46903377343623415, 'recall': 0.40297384197741914, 'f1-score': 0.3502159572208292, 'support': 164919}, 'weighted avg': {'precision': 0.46910594282039875, 'recall': 0.40271284691272685, 'f1-score': 0.35071259288061, 'support': 164919}}
[[26247  1382 28425]
 [16605  3670 34403]
 [16606  1083 36498]]
Evaluating performance on  train set...
224/224 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0162796
{'0': {'precision': 0.4730430039094463, 'recall': 0.6106090834409107, 'f1-score': 0.5330942622950819, 'support': 17042}, '1': {'precision': 0.7745162564170067, 'recall': 0.2572915300188027, 'f1-score': 0.3862666579137399, 'support': 22869}, '2': {'precision': 0.4239268478536957, 'recall': 0.6775503102708346, 'f1-score': 0.521539216999241, 'support': 17243}, 'accuracy': 0.4894320607481541, 'macro avg': {'precision': 0.5571620360600497, 'recall': 0.5151503079101826, 'f1-score': 0.4803000457360209, 'support': 57154}, 'weighted avg': {'precision': 0.5788533047234942, 'recall': 0.4894320607481541, 'f1-score': 0.4708581260555694, 'support': 57154}}
[[10406   926  5710]
 [ 6819  5884 10166]
 [ 4773   787 11683]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0106695
{'0': {'precision': 0.490018798675141, 'recall': 0.5799650368172908, 'f1-score': 0.5312113345787137, 'support': 18877}, '1': {'precision': 0.753918791312559, 'recall': 0.21007209387991368, 'f1-score': 0.3285867149559634, 'support': 19003}, '2': {'precision': 0.4419487075244774, 'recall': 0.6768185119850576, 'f1-score': 0.534729765735484, 'support': 19274}, 'accuracy': 0.4896420198061378, 'macro avg': {'precision': 0.5619620991707258, 'recall': 0.48895188089408737, 'f1-score': 0.46484260509005376, 'support': 57154}, 'weighted avg': {'precision': 0.5615516506758927, 'recall': 0.4896420198061378, 'f1-score': 0.465027665814051, 'support': 57154}}
[[10948   692  7237]
 [ 5776  3992  9235]
 [ 5618   611 13045]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0403982
{'0': {'precision': 0.46926798673953946, 'recall': 0.5537640093042927, 'f1-score': 0.5080265774285853, 'support': 18916}, '1': {'precision': 0.7637021716649431, 'recall': 0.15659457167090754, 'f1-score': 0.2598979412282245, 'support': 18864}, '2': {'precision': 0.4238147526159411, 'recall': 0.6773510890884691, 'f1-score': 0.5213953673169375, 'support': 19374}, 'accuracy': 0.4645694089652518, 'macro avg': {'precision': 0.5522616370068079, 'recall': 0.4625698900212231, 'f1-score': 0.42977329532458236, 'support': 57154}, 'weighted avg': {'precision': 0.5510399625683917, 'recall': 0.4645694089652518, 'f1-score': 0.4306620594948156, 'support': 57154}}
[[10475   489  7952]
 [ 6021  2954  9889]
 [ 5826   425 13123]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0747373
{'0': {'precision': 0.43788270512994965, 'recall': 0.5122300631400223, 'f1-score': 0.47214750330121774, 'support': 18847}, '1': {'precision': 0.7343596462495906, 'recall': 0.11802484733628132, 'f1-score': 0.20336523198330989, 'support': 18996}, '2': {'precision': 0.40085480751232294, 'recall': 0.6653720677334162, 'f1-score': 0.5003017619001265, 'support': 19311}, 'accuracy': 0.43295307415054063, 'macro avg': {'precision': 0.5243657196306212, 'recall': 0.43187565940323996, 'f1-score': 0.3919381657282181, 'support': 57154}, 'weighted avg': {'precision': 0.5239104589637095, 'recall': 0.43295307415054063, 'f1-score': 0.39232629851850004, 'support': 57154}}
[[ 9654   448  8745]
 [ 6294  2242 10460]
 [ 6099   363 12849]]
Evaluating performance on  val set...
68/68 - 1s - 766ms/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0613738
{'0': {'precision': 0.4460678985818651, 'recall': 0.5922403955876759, 'f1-score': 0.5088651033581175, 'support': 5258}, '1': {'precision': 0.6501210653753027, 'recall': 0.16339570972158832, 'f1-score': 0.2611550151975684, 'support': 6573}, '2': {'precision': 0.40304580330155776, 'recall': 0.6415618060695781, 'f1-score': 0.49507353991146646, 'support': 5404}, 'accuracy': 0.44415433710472874, 'macro avg': {'precision': 0.4997449224195752, 'recall': 0.4657326371262808, 'f1-score': 0.42169788615571746, 'support': 17235}, 'weighted avg': {'precision': 0.510399204786593, 'recall': 0.44415433710472874, 'f1-score': 0.410070324225829, 'support': 17235}}
[[3114  302 1842]
 [2206 1074 3293]
 [1661  276 3467]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.051304
{'0': {'precision': 0.46607669616519176, 'recall': 0.5548494983277592, 'f1-score': 0.5066035575234751, 'support': 5980}, '1': {'precision': 0.5474452554744526, 'recall': 0.09988584474885845, 'f1-score': 0.16894609814963799, 'support': 5256}, '2': {'precision': 0.4174948127115868, 'recall': 0.6372728788131355, 'f1-score': 0.5044866719451042, 'support': 5999}, 'accuracy': 0.44479257325210325, 'macro avg': {'precision': 0.477005588117077, 'recall': 0.43066940729658443, 'f1-score': 0.3933454425394058, 'support': 17235}, 'weighted avg': {'precision': 0.4739809856279883, 'recall': 0.44479257325210325, 'f1-score': 0.40289443056939706, 'support': 17235}}
[[3318  215 2447]
 [1844  525 2887]
 [1957  219 3823]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0877627
{'0': {'precision': 0.44364202775417727, 'recall': 0.5223407802600867, 'f1-score': 0.4797856049004594, 'support': 5998}, '1': {'precision': 0.5215231788079471, 'recall': 0.05843071786310518, 'f1-score': 0.10508757297748124, 'support': 5391}, '2': {'precision': 0.39094994252272963, 'recall': 0.6399247348614437, 'f1-score': 0.48537139150178393, 'support': 5846}, 'accuracy': 0.417116333043226, 'macro avg': {'precision': 0.45203838302828464, 'recall': 0.4068987443282119, 'f1-score': 0.3567481897932416, 'support': 17235}, 'weighted avg': {'precision': 0.45012995087966784, 'recall': 0.417116333043226, 'f1-score': 0.36447707100864435, 'support': 17235}}
[[3133  154 2711]
 [1959  315 3117]
 [1970  135 3741]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.108752
{'0': {'precision': 0.41714531878230904, 'recall': 0.4774034511092851, 'f1-score': 0.44524484634837924, 'support': 6085}, '1': {'precision': 0.42995169082125606, 'recall': 0.03384030418250951, 'f1-score': 0.06274233345082834, 'support': 5260}, '2': {'precision': 0.3785127320685807, 'recall': 0.633446519524618, 'f1-score': 0.4738680383565123, 'support': 5890}, 'accuracy': 0.39535828256454886, 'macro avg': {'precision': 0.40853658055738196, 'recall': 0.3815634249388042, 'f1-score': 0.32728507271857327, 'support': 17235}, 'weighted avg': {'precision': 0.40785118366081213, 'recall': 0.39535828256454886, 'f1-score': 0.33828966114888903, 'support': 17235}}
[[2905  127 3053]
 [2009  178 3073]
 [2050  109 3731]]
training model: results/LILAK/W8/deepVOL_L2/seq2seq
Epoch 1/50
224/224 - 11s - loss: 13.0784 - accuracy10: 0.3870 - accuracy20: 0.3936 - accuracy30: 0.3915 - accuracy50: 0.3833 - val_loss: 13.3218 - val_accuracy10: 0.3356 - val_accuracy20: 0.3599 - val_accuracy30: 0.3501 - val_accuracy50: 0.3505 - 11s/epoch - 51ms/step
Epoch 2/50
224/224 - 6s - loss: 12.8734 - accuracy10: 0.4175 - accuracy20: 0.4152 - accuracy30: 0.4111 - accuracy50: 0.3978 - val_loss: 13.3715 - val_accuracy10: 0.3416 - val_accuracy20: 0.3716 - val_accuracy30: 0.3575 - val_accuracy50: 0.3539 - 6s/epoch - 29ms/step
Epoch 3/50
224/224 - 7s - loss: 12.7623 - accuracy10: 0.4236 - accuracy20: 0.4252 - accuracy30: 0.4190 - accuracy50: 0.4055 - val_loss: 13.0314 - val_accuracy10: 0.3795 - val_accuracy20: 0.3947 - val_accuracy30: 0.3806 - val_accuracy50: 0.3649 - 7s/epoch - 29ms/step
Epoch 4/50
224/224 - 7s - loss: 12.7239 - accuracy10: 0.4303 - accuracy20: 0.4307 - accuracy30: 0.4218 - accuracy50: 0.4022 - val_loss: 13.1934 - val_accuracy10: 0.3711 - val_accuracy20: 0.3892 - val_accuracy30: 0.3740 - val_accuracy50: 0.3602 - 7s/epoch - 30ms/step
Epoch 5/50
224/224 - 6s - loss: 12.6962 - accuracy10: 0.4356 - accuracy20: 0.4312 - accuracy30: 0.4220 - accuracy50: 0.4041 - val_loss: 13.0558 - val_accuracy10: 0.3764 - val_accuracy20: 0.3937 - val_accuracy30: 0.3808 - val_accuracy50: 0.3730 - 6s/epoch - 29ms/step
Epoch 6/50
224/224 - 6s - loss: 12.6843 - accuracy10: 0.4412 - accuracy20: 0.4364 - accuracy30: 0.4253 - accuracy50: 0.4095 - val_loss: 13.1717 - val_accuracy10: 0.3682 - val_accuracy20: 0.3854 - val_accuracy30: 0.3694 - val_accuracy50: 0.3621 - 6s/epoch - 28ms/step
Epoch 7/50
224/224 - 6s - loss: 12.6400 - accuracy10: 0.4429 - accuracy20: 0.4410 - accuracy30: 0.4290 - accuracy50: 0.4104 - val_loss: 13.4501 - val_accuracy10: 0.3513 - val_accuracy20: 0.3765 - val_accuracy30: 0.3603 - val_accuracy50: 0.3568 - 6s/epoch - 29ms/step
Epoch 8/50
224/224 - 6s - loss: 12.5728 - accuracy10: 0.4513 - accuracy20: 0.4471 - accuracy30: 0.4369 - accuracy50: 0.4137 - val_loss: 13.3807 - val_accuracy10: 0.3641 - val_accuracy20: 0.3843 - val_accuracy30: 0.3680 - val_accuracy50: 0.3574 - 6s/epoch - 28ms/step
Epoch 9/50
224/224 - 7s - loss: 12.5111 - accuracy10: 0.4607 - accuracy20: 0.4549 - accuracy30: 0.4416 - accuracy50: 0.4187 - val_loss: 13.2900 - val_accuracy10: 0.3896 - val_accuracy20: 0.4005 - val_accuracy30: 0.3831 - val_accuracy50: 0.3712 - 7s/epoch - 30ms/step
Epoch 10/50
224/224 - 6s - loss: 12.4428 - accuracy10: 0.4650 - accuracy20: 0.4639 - accuracy30: 0.4515 - accuracy50: 0.4261 - val_loss: 13.3508 - val_accuracy10: 0.3849 - val_accuracy20: 0.4016 - val_accuracy30: 0.3852 - val_accuracy50: 0.3720 - 6s/epoch - 28ms/step
Epoch 11/50
224/224 - 6s - loss: 12.3542 - accuracy10: 0.4710 - accuracy20: 0.4693 - accuracy30: 0.4557 - accuracy50: 0.4331 - val_loss: 13.2009 - val_accuracy10: 0.4039 - val_accuracy20: 0.4115 - val_accuracy30: 0.3960 - val_accuracy50: 0.3785 - 6s/epoch - 28ms/step
Epoch 12/50
224/224 - 6s - loss: 12.3100 - accuracy10: 0.4744 - accuracy20: 0.4727 - accuracy30: 0.4589 - accuracy50: 0.4343 - val_loss: 13.1243 - val_accuracy10: 0.4122 - val_accuracy20: 0.4114 - val_accuracy30: 0.3935 - val_accuracy50: 0.3780 - 6s/epoch - 28ms/step
Epoch 13/50
224/224 - 6s - loss: 12.2537 - accuracy10: 0.4783 - accuracy20: 0.4747 - accuracy30: 0.4629 - accuracy50: 0.4376 - val_loss: 13.1352 - val_accuracy10: 0.4026 - val_accuracy20: 0.4162 - val_accuracy30: 0.3971 - val_accuracy50: 0.3803 - 6s/epoch - 28ms/step
testing model: results/LILAK/W8/deepVOL_L2/seq2seq
Evaluating performance on  test set...
645/645 - 6s - 6s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0881952
{'0': {'precision': 0.3376721962981982, 'recall': 0.3153724247226624, 'f1-score': 0.3261415709741765, 'support': 47956}, '1': {'precision': 0.7346709417247876, 'recall': 0.3168895605805697, 'f1-score': 0.4427886961978663, 'support': 70138}, '2': {'precision': 0.3145123606506308, 'recall': 0.6036515054452274, 'f1-score': 0.4135555035402891, 'support': 46830}, 'accuracy': 0.3978741723460503, 'macro avg': {'precision': 0.4622851662245389, 'recall': 0.4119711635828198, 'f1-score': 0.39416192357077734, 'support': 164924}, 'weighted avg': {'precision': 0.4999294960444725, 'recall': 0.3978741723460503, 'f1-score': 0.40056973504374915, 'support': 164924}}
[[15124  4163 28669]
 [14968 22226 32944]
 [14697  3864 28269]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0595403
{'0': {'precision': 0.3790429119845822, 'recall': 0.44621718049583753, 'f1-score': 0.4098961309623853, 'support': 54655}, '1': {'precision': 0.6475730247160577, 'recall': 0.3694552734169213, 'f1-score': 0.47048694582657796, 'support': 56946}, '2': {'precision': 0.35265955884512584, 'recall': 0.4503497552650826, 'f1-score': 0.3955624006522974, 'support': 53323}, 'accuracy': 0.4210484829375955, 'macro avg': {'precision': 0.4597584985152552, 'recall': 0.4220074030592805, 'f1-score': 0.42531515914708695, 'support': 164924}, 'weighted avg': {'precision': 0.46323245541156294, 'recall': 0.4210484829375955, 'f1-score': 0.4261829481747467, 'support': 164924}}
[[24388  5959 24308]
 [16135 21039 19772]
 [23818  5491 24014]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0681708
{'0': {'precision': 0.3683080465122295, 'recall': 0.5242952624698496, 'f1-score': 0.43267185315747886, 'support': 54311}, '1': {'precision': 0.6145220319133362, 'recall': 0.36331377334648873, 'f1-score': 0.45664991406131017, 'support': 57771}, '2': {'precision': 0.3494088596228674, 'recall': 0.35346883161121834, 'f1-score': 0.3514271199834428, 'support': 52842}, 'accuracy': 0.4131721277679416, 'macro avg': {'precision': 0.4440796460161443, 'recall': 0.4136926224758522, 'f1-score': 0.4135829624007439, 'support': 164924}, 'weighted avg': {'precision': 0.4484986635055092, 'recall': 0.4131721277679416, 'f1-score': 0.4150401098459707, 'support': 164924}}
[[28475  6935 18901]
 [20905 20989 15877]
 [27933  6231 18678]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0721428
{'0': {'precision': 0.36908974328528343, 'recall': 0.5545268040317545, 'f1-score': 0.443192916669637, 'support': 56055}, '1': {'precision': 0.5555396302135588, 'recall': 0.35443871392516185, 'f1-score': 0.43276799571251523, 'support': 54678}, '2': {'precision': 0.352654896226621, 'recall': 0.2981860456533373, 'f1-score': 0.32314122305323356, 'support': 54191}, 'accuracy': 0.4039618248405326, 'macro avg': {'precision': 0.42576142324182104, 'recall': 0.40238385453675124, 'f1-score': 0.3997007118117953, 'support': 164924}, 'weighted avg': {'precision': 0.42550412882352084, 'recall': 0.4039618248405326, 'f1-score': 0.40028991191071756, 'support': 164924}}
[[31084  8259 16712]
 [22348 19380 12950]
 [30786  7246 16159]]
Evaluating performance on  train set...
224/224 - 2s - 2s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0860708
{'0': {'precision': 0.35458884281355135, 'recall': 0.26493627966795275, 'f1-score': 0.30327567169672426, 'support': 17106}, '1': {'precision': 0.6785955435516543, 'recall': 0.3087693117977528, 'f1-score': 0.4244215860758348, 'support': 22784}, '2': {'precision': 0.3314709168970182, 'recall': 0.6529193697868396, 'f1-score': 0.4397113321630583, 'support': 17264}, 'accuracy': 0.39960457710746405, 'macro avg': {'precision': 0.454885101087408, 'recall': 0.40887498708418174, 'f1-score': 0.3891361966452058, 'support': 57154}, 'weighted avg': {'precision': 0.4767685817048609, 'recall': 0.39960457710746405, 'f1-score': 0.39278145878956894, 'support': 57154}}
[[ 4532  1779 10795]
 [ 3810  7035 11939]
 [ 4439  1553 11272]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.063734
{'0': {'precision': 0.3801963651556298, 'recall': 0.3851648060949156, 'f1-score': 0.38266445898709556, 'support': 18901}, '1': {'precision': 0.5989135355364418, 'recall': 0.350129677658392, 'f1-score': 0.4419132874607522, 'support': 18893}, '2': {'precision': 0.36949668039019323, 'recall': 0.5145661157024793, 'f1-score': 0.4301288832279096, 'support': 19360}, 'accuracy': 0.41741610385974737, 'macro avg': {'precision': 0.44953552702742156, 'recall': 0.4166201998185956, 'f1-score': 0.41823554322525247, 'support': 57154}, 'weighted avg': {'precision': 0.4488718314912464, 'recall': 0.41741610385974737, 'f1-score': 0.41832774361555475, 'support': 57154}}
[[7280 2310 9311]
 [4590 6615 7688]
 [7278 2120 9962]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.069642
{'0': {'precision': 0.370233139050791, 'recall': 0.4686940023189628, 'f1-score': 0.41368563055310037, 'support': 18974}, '1': {'precision': 0.5613211647109952, 'recall': 0.3431638237951007, 'f1-score': 0.42593325418810185, 'support': 18819}, '2': {'precision': 0.36672985343751446, 'recall': 0.4096895821496824, 'f1-score': 0.38702122468894856, 'support': 19361}, 'accuracy': 0.4073730622528607, 'macro avg': {'precision': 0.43276138573310025, 'recall': 0.40718246942124864, 'f1-score': 0.40888003647671695, 'support': 57154}, 'weighted avg': {'precision': 0.4319656239536978, 'recall': 0.4073730622528607, 'f1-score': 0.4086857787011084, 'support': 57154}}
[[8893 2575 7506]
 [6170 6458 6191]
 [8957 2472 7932]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0820221
{'0': {'precision': 0.3586827237585489, 'recall': 0.5126434339141521, 'f1-score': 0.42206088173547934, 'support': 18824}, '1': {'precision': 0.5031345306675703, 'recall': 0.3123159444678166, 'f1-score': 0.3853990914990266, 'support': 19016}, '2': {'precision': 0.35975279193321047, 'recall': 0.34358496427461943, 'f1-score': 0.3514830508474576, 'support': 19314}, 'accuracy': 0.3888616719739651, 'macro avg': {'precision': 0.4071900154531099, 'recall': 0.3895147808855293, 'f1-score': 0.3863143413606545, 'support': 57154}, 'weighted avg': {'precision': 0.40710563128745964, 'recall': 0.3888616719739651, 'f1-score': 0.3860126466354402, 'support': 57154}}
[[9650 2954 6220]
 [7487 5939 5590]
 [9767 2911 6636]]
Evaluating performance on  val set...
68/68 - 1s - 757ms/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1000342
{'0': {'precision': 0.3542398394380331, 'recall': 0.2668178382464097, 'f1-score': 0.3043759430911835, 'support': 5292}, '1': {'precision': 0.6228594185583433, 'recall': 0.23856009762050032, 'f1-score': 0.3449873166427705, 'support': 6556}, '2': {'precision': 0.33696461824953444, 'recall': 0.6715531638522917, 'f1-score': 0.44875689751379505, 'support': 5389}, 'accuracy': 0.38260718222428497, 'macro avg': {'precision': 0.4380212920819703, 'recall': 0.3923103665730672, 'f1-score': 0.36604005241591636, 'support': 17237}, 'weighted avg': {'precision': 0.4510068983072061, 'recall': 0.38260718222428497, 'f1-score': 0.3649617253263554, 'support': 17237}}
[[1412  516 3364]
 [1235 1564 3757]
 [1339  431 3619]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0757326
{'0': {'precision': 0.3792536577346704, 'recall': 0.3856569709127382, 'f1-score': 0.38242851222544555, 'support': 5982}, '1': {'precision': 0.5209558823529412, 'recall': 0.2692892436335994, 'f1-score': 0.3550488599348534, 'support': 5262}, '2': {'precision': 0.36862698600901117, 'recall': 0.5187719005506424, 'f1-score': 0.43099743536424756, 'support': 5993}, 'accuracy': 0.3964146893310901, 'macro avg': {'precision': 0.42294550869887426, 'recall': 0.3912393716989933, 'f1-score': 0.3894916025081822, 'support': 17237}, 'weighted avg': {'precision': 0.41881689160886343, 'recall': 0.3964146893310901, 'f1-score': 0.39095678431558556, 'support': 17237}}
[[2307  712 2963]
 [1483 1417 2362]
 [2293  591 3109]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0850197
{'0': {'precision': 0.36970873786407765, 'recall': 0.4775121217187761, 'f1-score': 0.4167517875383044, 'support': 5981}, '1': {'precision': 0.4806041881222108, 'recall': 0.259163272861903, 'f1-score': 0.3367408298256163, 'support': 5402}, '2': {'precision': 0.35869071071374453, 'recall': 0.4043389135633755, 'f1-score': 0.3801493615996146, 'support': 5854}, 'accuracy': 0.38423159482508557, 'macro avg': {'precision': 0.40300121223334434, 'recall': 0.3803381027146848, 'f1-score': 0.37788065965451173, 'support': 17237}, 'weighted avg': {'precision': 0.4007209610674416, 'recall': 0.38423159482508557, 'f1-score': 0.37924585292038765, 'support': 17237}}
[[2856  824 2301]
 [2071 1400 1931]
 [2798  689 2367]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0922428
{'0': {'precision': 0.3671497584541063, 'recall': 0.5243962543124692, 'f1-score': 0.4319058250456667, 'support': 6087}, '1': {'precision': 0.41014588859416445, 'recall': 0.23503705111153333, 'f1-score': 0.29882836091315373, 'support': 5263}, '2': {'precision': 0.3567939207526687, 'recall': 0.33497536945812806, 'f1-score': 0.3455405642193796, 'support': 5887}, 'accuracy': 0.3713523234901665, 'macro avg': {'precision': 0.3780298559336465, 'recall': 0.3648028916273769, 'f1-score': 0.35875825005940004, 'support': 17237}, 'weighted avg': {'precision': 0.3767409759733244, 'recall': 0.3713523234901665, 'f1-score': 0.3617765111155299, 'support': 17237}}
[[3192  958 1937]
 [2408 1237 1618]
 [3094  821 1972]]
training model: results/LILAK/W8/deepVOL_L3/seq2seq
Epoch 1/50
224/224 - 15s - loss: 13.1289 - accuracy10: 0.3781 - accuracy20: 0.3769 - accuracy30: 0.3756 - accuracy50: 0.3720 - val_loss: 13.2244 - val_accuracy10: 0.3309 - val_accuracy20: 0.3531 - val_accuracy30: 0.3513 - val_accuracy50: 0.3529 - 15s/epoch - 66ms/step
Epoch 2/50
224/224 - 9s - loss: 13.0173 - accuracy10: 0.3942 - accuracy20: 0.3939 - accuracy30: 0.3907 - accuracy50: 0.3864 - val_loss: 13.2063 - val_accuracy10: 0.3455 - val_accuracy20: 0.3535 - val_accuracy30: 0.3492 - val_accuracy50: 0.3481 - 9s/epoch - 40ms/step
Epoch 3/50
224/224 - 9s - loss: 12.8990 - accuracy10: 0.4090 - accuracy20: 0.4046 - accuracy30: 0.4007 - accuracy50: 0.3909 - val_loss: 13.0622 - val_accuracy10: 0.3853 - val_accuracy20: 0.3856 - val_accuracy30: 0.3716 - val_accuracy50: 0.3588 - 9s/epoch - 40ms/step
Epoch 4/50
224/224 - 9s - loss: 12.7541 - accuracy10: 0.4242 - accuracy20: 0.4211 - accuracy30: 0.4135 - accuracy50: 0.4023 - val_loss: 13.0305 - val_accuracy10: 0.3928 - val_accuracy20: 0.3925 - val_accuracy30: 0.3840 - val_accuracy50: 0.3680 - 9s/epoch - 40ms/step
Epoch 5/50
224/224 - 9s - loss: 12.7522 - accuracy10: 0.4224 - accuracy20: 0.4190 - accuracy30: 0.4111 - accuracy50: 0.3971 - val_loss: 13.2156 - val_accuracy10: 0.3592 - val_accuracy20: 0.3763 - val_accuracy30: 0.3590 - val_accuracy50: 0.3481 - 9s/epoch - 40ms/step
Epoch 6/50
224/224 - 9s - loss: 12.7523 - accuracy10: 0.4243 - accuracy20: 0.4195 - accuracy30: 0.4125 - accuracy50: 0.3953 - val_loss: 13.4175 - val_accuracy10: 0.3422 - val_accuracy20: 0.3643 - val_accuracy30: 0.3541 - val_accuracy50: 0.3467 - 9s/epoch - 40ms/step
Epoch 7/50
224/224 - 9s - loss: 12.7203 - accuracy10: 0.4281 - accuracy20: 0.4236 - accuracy30: 0.4170 - accuracy50: 0.4011 - val_loss: 13.2969 - val_accuracy10: 0.3520 - val_accuracy20: 0.3724 - val_accuracy30: 0.3640 - val_accuracy50: 0.3568 - 9s/epoch - 39ms/step
Epoch 8/50
224/224 - 9s - loss: 12.6994 - accuracy10: 0.4326 - accuracy20: 0.4287 - accuracy30: 0.4191 - accuracy50: 0.3997 - val_loss: 13.6063 - val_accuracy10: 0.3381 - val_accuracy20: 0.3635 - val_accuracy30: 0.3540 - val_accuracy50: 0.3488 - 9s/epoch - 39ms/step
Epoch 9/50
224/224 - 9s - loss: 12.6556 - accuracy10: 0.4332 - accuracy20: 0.4294 - accuracy30: 0.4209 - accuracy50: 0.4013 - val_loss: 13.3585 - val_accuracy10: 0.3534 - val_accuracy20: 0.3734 - val_accuracy30: 0.3610 - val_accuracy50: 0.3538 - 9s/epoch - 39ms/step
Epoch 10/50
224/224 - 9s - loss: 12.6377 - accuracy10: 0.4353 - accuracy20: 0.4285 - accuracy30: 0.4197 - accuracy50: 0.4019 - val_loss: 13.2088 - val_accuracy10: 0.3676 - val_accuracy20: 0.3858 - val_accuracy30: 0.3704 - val_accuracy50: 0.3622 - 9s/epoch - 38ms/step
Epoch 11/50
224/224 - 9s - loss: 12.5783 - accuracy10: 0.4441 - accuracy20: 0.4391 - accuracy30: 0.4253 - accuracy50: 0.4072 - val_loss: 13.2297 - val_accuracy10: 0.3680 - val_accuracy20: 0.3836 - val_accuracy30: 0.3657 - val_accuracy50: 0.3575 - 9s/epoch - 38ms/step
Epoch 12/50
224/224 - 9s - loss: 12.5205 - accuracy10: 0.4486 - accuracy20: 0.4428 - accuracy30: 0.4289 - accuracy50: 0.4074 - val_loss: 13.0992 - val_accuracy10: 0.3955 - val_accuracy20: 0.4002 - val_accuracy30: 0.3811 - val_accuracy50: 0.3671 - 9s/epoch - 39ms/step
Epoch 13/50
224/224 - 9s - loss: 12.4694 - accuracy10: 0.4491 - accuracy20: 0.4447 - accuracy30: 0.4325 - accuracy50: 0.4097 - val_loss: 12.9167 - val_accuracy10: 0.4175 - val_accuracy20: 0.4103 - val_accuracy30: 0.3895 - val_accuracy50: 0.3643 - 9s/epoch - 39ms/step
Epoch 14/50
224/224 - 9s - loss: 12.5265 - accuracy10: 0.4482 - accuracy20: 0.4398 - accuracy30: 0.4287 - accuracy50: 0.4066 - val_loss: 13.0541 - val_accuracy10: 0.3993 - val_accuracy20: 0.4044 - val_accuracy30: 0.3867 - val_accuracy50: 0.3681 - 9s/epoch - 39ms/step
Epoch 15/50
224/224 - 9s - loss: 12.4509 - accuracy10: 0.4512 - accuracy20: 0.4493 - accuracy30: 0.4352 - accuracy50: 0.4143 - val_loss: 13.0311 - val_accuracy10: 0.4020 - val_accuracy20: 0.4106 - val_accuracy30: 0.3937 - val_accuracy50: 0.3754 - 9s/epoch - 39ms/step
Epoch 16/50
224/224 - 9s - loss: 12.3873 - accuracy10: 0.4612 - accuracy20: 0.4531 - accuracy30: 0.4407 - accuracy50: 0.4180 - val_loss: 13.0317 - val_accuracy10: 0.3975 - val_accuracy20: 0.4037 - val_accuracy30: 0.3883 - val_accuracy50: 0.3701 - 9s/epoch - 38ms/step
Epoch 17/50
224/224 - 9s - loss: 12.3457 - accuracy10: 0.4623 - accuracy20: 0.4565 - accuracy30: 0.4418 - accuracy50: 0.4213 - val_loss: 12.8597 - val_accuracy10: 0.4214 - val_accuracy20: 0.4231 - val_accuracy30: 0.4059 - val_accuracy50: 0.3843 - 9s/epoch - 39ms/step
Epoch 18/50
224/224 - 9s - loss: 12.3133 - accuracy10: 0.4633 - accuracy20: 0.4572 - accuracy30: 0.4426 - accuracy50: 0.4192 - val_loss: 12.9644 - val_accuracy10: 0.4149 - val_accuracy20: 0.4172 - val_accuracy30: 0.3958 - val_accuracy50: 0.3708 - 9s/epoch - 38ms/step
Epoch 19/50
224/224 - 9s - loss: 12.3104 - accuracy10: 0.4622 - accuracy20: 0.4551 - accuracy30: 0.4446 - accuracy50: 0.4237 - val_loss: 13.0106 - val_accuracy10: 0.4056 - val_accuracy20: 0.4112 - val_accuracy30: 0.3871 - val_accuracy50: 0.3687 - 9s/epoch - 39ms/step
Epoch 20/50
224/224 - 9s - loss: 12.2579 - accuracy10: 0.4652 - accuracy20: 0.4617 - accuracy30: 0.4489 - accuracy50: 0.4247 - val_loss: 12.8499 - val_accuracy10: 0.4207 - val_accuracy20: 0.4214 - val_accuracy30: 0.4036 - val_accuracy50: 0.3798 - 9s/epoch - 39ms/step
Epoch 21/50
224/224 - 9s - loss: 12.2030 - accuracy10: 0.4703 - accuracy20: 0.4638 - accuracy30: 0.4528 - accuracy50: 0.4321 - val_loss: 12.8790 - val_accuracy10: 0.4191 - val_accuracy20: 0.4227 - val_accuracy30: 0.4045 - val_accuracy50: 0.3816 - 9s/epoch - 39ms/step
Epoch 22/50
224/224 - 9s - loss: 12.1617 - accuracy10: 0.4761 - accuracy20: 0.4700 - accuracy30: 0.4585 - accuracy50: 0.4331 - val_loss: 12.8615 - val_accuracy10: 0.4234 - val_accuracy20: 0.4243 - val_accuracy30: 0.4053 - val_accuracy50: 0.3856 - 9s/epoch - 39ms/step
Epoch 23/50
224/224 - 9s - loss: 12.1119 - accuracy10: 0.4804 - accuracy20: 0.4740 - accuracy30: 0.4619 - accuracy50: 0.4392 - val_loss: 12.8602 - val_accuracy10: 0.4327 - val_accuracy20: 0.4275 - val_accuracy30: 0.4070 - val_accuracy50: 0.3813 - 9s/epoch - 39ms/step
Epoch 24/50
224/224 - 9s - loss: 12.0494 - accuracy10: 0.4846 - accuracy20: 0.4784 - accuracy30: 0.4672 - accuracy50: 0.4432 - val_loss: 12.8873 - val_accuracy10: 0.4265 - val_accuracy20: 0.4244 - val_accuracy30: 0.4024 - val_accuracy50: 0.3790 - 9s/epoch - 39ms/step
Epoch 25/50
224/224 - 9s - loss: 12.0182 - accuracy10: 0.4865 - accuracy20: 0.4819 - accuracy30: 0.4705 - accuracy50: 0.4473 - val_loss: 12.9116 - val_accuracy10: 0.4277 - val_accuracy20: 0.4270 - val_accuracy30: 0.4072 - val_accuracy50: 0.3817 - 9s/epoch - 39ms/step
Epoch 26/50
224/224 - 9s - loss: 11.9862 - accuracy10: 0.4897 - accuracy20: 0.4852 - accuracy30: 0.4749 - accuracy50: 0.4510 - val_loss: 12.9589 - val_accuracy10: 0.4262 - val_accuracy20: 0.4197 - val_accuracy30: 0.3971 - val_accuracy50: 0.3749 - 9s/epoch - 39ms/step
Epoch 27/50
224/224 - 9s - loss: 11.9427 - accuracy10: 0.4935 - accuracy20: 0.4904 - accuracy30: 0.4772 - accuracy50: 0.4544 - val_loss: 12.9572 - val_accuracy10: 0.4208 - val_accuracy20: 0.4163 - val_accuracy30: 0.3980 - val_accuracy50: 0.3792 - 9s/epoch - 40ms/step
Epoch 28/50
224/224 - 9s - loss: 11.9074 - accuracy10: 0.4946 - accuracy20: 0.4910 - accuracy30: 0.4824 - accuracy50: 0.4563 - val_loss: 12.9592 - val_accuracy10: 0.4138 - val_accuracy20: 0.4142 - val_accuracy30: 0.3929 - val_accuracy50: 0.3773 - 9s/epoch - 38ms/step
Epoch 29/50
224/224 - 9s - loss: 11.8724 - accuracy10: 0.4982 - accuracy20: 0.4946 - accuracy30: 0.4845 - accuracy50: 0.4610 - val_loss: 12.9637 - val_accuracy10: 0.4230 - val_accuracy20: 0.4176 - val_accuracy30: 0.3955 - val_accuracy50: 0.3826 - 9s/epoch - 39ms/step
Epoch 30/50
224/224 - 9s - loss: 11.8307 - accuracy10: 0.5000 - accuracy20: 0.5009 - accuracy30: 0.4912 - accuracy50: 0.4663 - val_loss: 12.9677 - val_accuracy10: 0.4199 - val_accuracy20: 0.4165 - val_accuracy30: 0.3956 - val_accuracy50: 0.3765 - 9s/epoch - 39ms/step
testing model: results/LILAK/W8/deepVOL_L3/seq2seq
Evaluating performance on  test set...
645/645 - 10s - 10s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0453188
{'0': {'precision': 0.359704033525406, 'recall': 0.5727541913420635, 'f1-score': 0.4418900222014865, 'support': 47956}, '1': {'precision': 0.7093510049403782, 'recall': 0.5097379451937609, 'f1-score': 0.5932022001178042, 'support': 70138}, '2': {'precision': 0.33959594371511675, 'recall': 0.2767456758488149, 'f1-score': 0.3049662913416399, 'support': 46830}, 'accuracy': 0.46190366471829447, 'macro avg': {'precision': 0.46955032739363367, 'recall': 0.4530792707948798, 'f1-score': 0.44668617122031024, 'support': 164924}, 'weighted avg': {'precision': 0.5026903632002107, 'recall': 0.46190366471829447, 'f1-score': 0.4673599066241786, 'support': 164924}}
[[27467  7285 13204]
 [22387 35752 11999]
 [26506  7364 12960]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0366246
{'0': {'precision': 0.3956574792749047, 'recall': 0.5754642759125423, 'f1-score': 0.46891492977905, 'support': 54655}, '1': {'precision': 0.6214332036316472, 'recall': 0.5384750465353142, 'f1-score': 0.5769874870636936, 'support': 56946}, '2': {'precision': 0.3746778618339014, 'recall': 0.25356787877651293, 'f1-score': 0.30244939044849567, 'support': 53323}, 'accuracy': 0.45861730251509786, 'macro avg': {'precision': 0.4639228482468177, 'recall': 0.45583573374145653, 'f1-score': 0.4494506024304132, 'support': 164924}, 'weighted avg': {'precision': 0.46683164591173404, 'recall': 0.45861730251509786, 'f1-score': 0.45240949632732774, 'support': 164924}}
[[31452  9293 13910]
 [17626 30664  8656]
 [30415  9387 13521]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.05609
{'0': {'precision': 0.38202247191011235, 'recall': 0.5734381616983668, 'f1-score': 0.45855633673206464, 'support': 54311}, '1': {'precision': 0.5911889508278559, 'recall': 0.4919769434491354, 'f1-score': 0.5370393114589928, 'support': 57771}, '2': {'precision': 0.3610576378666063, 'recall': 0.2413610385678059, 'f1-score': 0.2893178776399066, 'support': 52842}, 'accuracy': 0.43850500836749046, 'macro avg': {'precision': 0.4447563535348582, 'recall': 0.43559204790510275, 'f1-score': 0.4283045086103214, 'support': 164924}, 'weighted avg': {'precision': 0.4485739313279655, 'recall': 0.43850500836749046, 'f1-score': 0.4318236676093266, 'support': 164924}}
[[31144  9814 13353]
 [20132 28422  9217]
 [30248  9840 12754]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0674431
{'0': {'precision': 0.3792374382839999, 'recall': 0.5727767371331728, 'f1-score': 0.4563343448197446, 'support': 56055}, '1': {'precision': 0.5303883133664776, 'recall': 0.4429020812758331, 'f1-score': 0.4827132563261808, 'support': 54678}, '2': {'precision': 0.3614715487096494, 'recall': 0.23081323466996365, 'f1-score': 0.2817307475730342, 'support': 54191}, 'accuracy': 0.41735587300817345, 'macro avg': {'precision': 0.4236991001200423, 'recall': 0.4154973510263231, 'f1-score': 0.4069261162396532, 'support': 164924}, 'weighted avg': {'precision': 0.42351162655154184, 'recall': 0.41735587300817345, 'f1-score': 0.40770832668383006, 'support': 164924}}
[[32107 10841 13107]
 [21473 24217  8988]
 [31082 10601 12508]]
Evaluating performance on  train set...
224/224 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0324306
{'0': {'precision': 0.36993478028440074, 'recall': 0.606804629954402, 'f1-score': 0.4596479574892062, 'support': 17106}, '1': {'precision': 0.6757921573388369, 'recall': 0.4886323735955056, 'f1-score': 0.5671710224667583, 'support': 22784}, '2': {'precision': 0.3888756833848348, 'recall': 0.28429101019462466, 'f1-score': 0.3284590931905638, 'support': 17264}, 'accuracy': 0.46227735591559643, 'macro avg': {'precision': 0.4782008736693575, 'recall': 0.45990933791484406, 'f1-score': 0.45175935771550946, 'support': 57154}, 'weighted avg': {'precision': 0.49758376775569174, 'recall': 0.46227735591559643, 'f1-score': 0.4628841432189327, 'support': 57154}}
[[10380  2598  4128]
 [ 8066 11133  3585]
 [ 9613  2743  4908]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0299284
{'0': {'precision': 0.39626734616576564, 'recall': 0.6088566742500396, 'f1-score': 0.48008009678361346, 'support': 18901}, '1': {'precision': 0.5938331991827132, 'recall': 0.5076483353623035, 'f1-score': 0.5473690218011643, 'support': 18893}, '2': {'precision': 0.4240929610433038, 'recall': 0.2620351239669422, 'f1-score': 0.32392567524423727, 'support': 19360}, 'accuracy': 0.45792070546243485, 'macro avg': {'precision': 0.4713978354639275, 'recall': 0.4595133778597617, 'f1-score': 0.4504582646096717, 'support': 57154}, 'weighted avg': {'precision': 0.47100079553200996, 'recall': 0.45792070546243485, 'f1-score': 0.4494285248788345, 'support': 57154}}
[[11508  3149  4244]
 [ 6657  9591  2645]
 [10876  3411  5073]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0457983
{'0': {'precision': 0.3889243161604296, 'recall': 0.6107304732792243, 'f1-score': 0.47521991428981525, 'support': 18974}, '1': {'precision': 0.5582888380371218, 'recall': 0.4667091768956905, 'f1-score': 0.508407860843391, 'support': 18819}, '2': {'precision': 0.4194547174679625, 'recall': 0.25189814575693403, 'f1-score': 0.31476700658319345, 'support': 19361}, 'accuracy': 0.44175385799769046, 'macro avg': {'precision': 0.455555957221838, 'recall': 0.44311259864394964, 'f1-score': 0.4327982605721332, 'support': 57154}, 'weighted avg': {'precision': 0.45503290063242835, 'recall': 0.44175385799769046, 'f1-score': 0.43179399869482343, 'support': 57154}}
[[11588  3308  4078]
 [ 7364  8783  2672]
 [10843  3641  4877]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0670794
{'0': {'precision': 0.3703427236141763, 'recall': 0.6061942201444964, 'f1-score': 0.4597872511886534, 'support': 18824}, '1': {'precision': 0.5072801010571105, 'recall': 0.4012410601598654, 'f1-score': 0.44807234929676715, 'support': 19016}, '2': {'precision': 0.40907884258030264, 'recall': 0.2393600497048773, 'f1-score': 0.30200881920627143, 'support': 19314}, 'accuracy': 0.414039262343843, 'macro avg': {'precision': 0.4289005557505298, 'recall': 0.41559844333641305, 'f1-score': 0.4032894732305639, 'support': 57154}, 'weighted avg': {'precision': 0.42899392162597944, 'recall': 0.414039262343843, 'f1-score': 0.4025716020707643, 'support': 57154}}
[[11411  3529  3884]
 [ 8592  7630  2794]
 [10809  3882  4623]]
Evaluating performance on  val set...
68/68 - 1s - 1s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.066678
{'0': {'precision': 0.35294117647058826, 'recall': 0.6099773242630385, 'f1-score': 0.44715334533868956, 'support': 5292}, '1': {'precision': 0.6270156578639869, 'recall': 0.4092434411226358, 'f1-score': 0.4952468850946009, 'support': 6556}, '2': {'precision': 0.36070304302203565, 'recall': 0.25514937836333274, 'f1-score': 0.2988805564612542, 'support': 5389}, 'accuracy': 0.42269536462261414, 'macro avg': {'precision': 0.446886625785537, 'recall': 0.4247900479163356, 'f1-score': 0.4137602622981816, 'support': 17237}, 'weighted avg': {'precision': 0.45961060844023915, 'recall': 0.42269536462261414, 'f1-score': 0.41908924992645163, 'support': 17237}}
[[3228  793 1271]
 [2707 2683 1166]
 [3211  803 1375]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0588408
{'0': {'precision': 0.3849825007954184, 'recall': 0.6068204613841525, 'f1-score': 0.47109207708779444, 'support': 5982}, '1': {'precision': 0.5248091603053435, 'recall': 0.41809198023565186, 'f1-score': 0.46541146604611805, 'support': 5262}, '2': {'precision': 0.39767699115044247, 'recall': 0.23994660437176707, 'f1-score': 0.2993027370173795, 'support': 5993}, 'accuracy': 0.42165109937924233, 'macro avg': {'precision': 0.4358228840837348, 'recall': 0.42161968199719047, 'f1-score': 0.4119354267170974, 'support': 17237}, 'weighted avg': {'precision': 0.43208152980504216, 'recall': 0.42165109937924233, 'f1-score': 0.40962982203509984, 'support': 17237}}
[[3630 1010 1342]
 [2226 2200  836]
 [3573  982 1438]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0738261
{'0': {'precision': 0.37593129139072845, 'recall': 0.6074235077746196, 'f1-score': 0.46442953020134226, 'support': 5981}, '1': {'precision': 0.491839762611276, 'recall': 0.36819696408737507, 'f1-score': 0.42113063730679656, 'support': 5402}, '2': {'precision': 0.3901955228109946, 'recall': 0.23522377861291424, 'f1-score': 0.2935095385271235, 'support': 5854}, 'accuracy': 0.40604513546440796, 'macro avg': {'precision': 0.4193221922709997, 'recall': 0.403614750158303, 'f1-score': 0.3930232353450875, 'support': 17237}, 'weighted avg': {'precision': 0.41710089006031337, 'recall': 0.40604513546440796, 'f1-score': 0.3928122968848015, 'support': 17237}}
[[3633 1058 1290]
 [2551 1989  862]
 [3480  997 1377]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0872627
{'0': {'precision': 0.3643379773479002, 'recall': 0.5971743058978151, 'f1-score': 0.4525647410358566, 'support': 6087}, '1': {'precision': 0.4166881942650478, 'recall': 0.30647919437583127, 'f1-score': 0.35318589883950074, 'support': 5263}, '2': {'precision': 0.38270876364709355, 'recall': 0.22031595039918464, 'f1-score': 0.2796463993100474, 'support': 5887}, 'accuracy': 0.37970644543714105, 'macro avg': {'precision': 0.38791164508668047, 'recall': 0.37465648355761033, 'f1-score': 0.36179901306180157, 'support': 17237}, 'weighted avg': {'precision': 0.38659637559459625, 'recall': 0.37970644543714105, 'f1-score': 0.3631639680347972, 'support': 17237}}
[[3635 1192 1260]
 [2818 1613  832]
 [3524 1066 1297]]
training model: results/LILAK/W9/deepLOB_L1/seq2seq
Epoch 1/50
200/200 - 11s - loss: 13.2522 - accuracy10: 0.3740 - accuracy20: 0.3744 - accuracy30: 0.3750 - accuracy50: 0.3701 - val_loss: 13.2327 - val_accuracy10: 0.3370 - val_accuracy20: 0.3683 - val_accuracy30: 0.3766 - val_accuracy50: 0.3669 - 11s/epoch - 53ms/step
Epoch 2/50
200/200 - 4s - loss: 13.0932 - accuracy10: 0.3861 - accuracy20: 0.3872 - accuracy30: 0.3867 - accuracy50: 0.3850 - val_loss: 13.2047 - val_accuracy10: 0.3520 - val_accuracy20: 0.3749 - val_accuracy30: 0.3817 - val_accuracy50: 0.3682 - 4s/epoch - 22ms/step
Epoch 3/50
200/200 - 4s - loss: 13.0249 - accuracy10: 0.3908 - accuracy20: 0.3994 - accuracy30: 0.3994 - accuracy50: 0.3947 - val_loss: 12.9913 - val_accuracy10: 0.3777 - val_accuracy20: 0.3995 - val_accuracy30: 0.4044 - val_accuracy50: 0.3862 - 4s/epoch - 22ms/step
Epoch 4/50
200/200 - 4s - loss: 12.9083 - accuracy10: 0.4084 - accuracy20: 0.4169 - accuracy30: 0.4135 - accuracy50: 0.4025 - val_loss: 13.1299 - val_accuracy10: 0.3602 - val_accuracy20: 0.3949 - val_accuracy30: 0.4001 - val_accuracy50: 0.3864 - 4s/epoch - 22ms/step
Epoch 5/50
200/200 - 5s - loss: 12.8438 - accuracy10: 0.4215 - accuracy20: 0.4233 - accuracy30: 0.4210 - accuracy50: 0.4050 - val_loss: 12.8760 - val_accuracy10: 0.4058 - val_accuracy20: 0.4240 - val_accuracy30: 0.4203 - val_accuracy50: 0.3960 - 5s/epoch - 23ms/step
Epoch 6/50
200/200 - 4s - loss: 12.7608 - accuracy10: 0.4469 - accuracy20: 0.4442 - accuracy30: 0.4378 - accuracy50: 0.4159 - val_loss: 12.9908 - val_accuracy10: 0.3961 - val_accuracy20: 0.4190 - val_accuracy30: 0.4169 - val_accuracy50: 0.3953 - 4s/epoch - 22ms/step
Epoch 7/50
200/200 - 5s - loss: 12.6792 - accuracy10: 0.4528 - accuracy20: 0.4540 - accuracy30: 0.4466 - accuracy50: 0.4196 - val_loss: 12.9499 - val_accuracy10: 0.3983 - val_accuracy20: 0.4154 - val_accuracy30: 0.4116 - val_accuracy50: 0.3925 - 5s/epoch - 23ms/step
Epoch 8/50
200/200 - 4s - loss: 12.6254 - accuracy10: 0.4623 - accuracy20: 0.4608 - accuracy30: 0.4536 - accuracy50: 0.4242 - val_loss: 13.0051 - val_accuracy10: 0.3799 - val_accuracy20: 0.4109 - val_accuracy30: 0.4136 - val_accuracy50: 0.3940 - 4s/epoch - 22ms/step
Epoch 9/50
200/200 - 4s - loss: 12.6105 - accuracy10: 0.4631 - accuracy20: 0.4613 - accuracy30: 0.4517 - accuracy50: 0.4225 - val_loss: 12.8854 - val_accuracy10: 0.4194 - val_accuracy20: 0.4336 - val_accuracy30: 0.4302 - val_accuracy50: 0.4030 - 4s/epoch - 22ms/step
Epoch 10/50
200/200 - 4s - loss: 12.5573 - accuracy10: 0.4703 - accuracy20: 0.4669 - accuracy30: 0.4567 - accuracy50: 0.4282 - val_loss: 13.0481 - val_accuracy10: 0.3749 - val_accuracy20: 0.4054 - val_accuracy30: 0.4082 - val_accuracy50: 0.3883 - 4s/epoch - 22ms/step
Epoch 11/50
200/200 - 4s - loss: 12.5200 - accuracy10: 0.4733 - accuracy20: 0.4699 - accuracy30: 0.4611 - accuracy50: 0.4311 - val_loss: 12.9710 - val_accuracy10: 0.4154 - val_accuracy20: 0.4285 - val_accuracy30: 0.4256 - val_accuracy50: 0.3990 - 4s/epoch - 22ms/step
Epoch 12/50
200/200 - 4s - loss: 12.4642 - accuracy10: 0.4782 - accuracy20: 0.4716 - accuracy30: 0.4621 - accuracy50: 0.4319 - val_loss: 12.7568 - val_accuracy10: 0.4400 - val_accuracy20: 0.4424 - val_accuracy30: 0.4320 - val_accuracy50: 0.4081 - 4s/epoch - 22ms/step
Epoch 13/50
200/200 - 4s - loss: 12.4393 - accuracy10: 0.4781 - accuracy20: 0.4727 - accuracy30: 0.4638 - accuracy50: 0.4334 - val_loss: 12.9783 - val_accuracy10: 0.3938 - val_accuracy20: 0.4129 - val_accuracy30: 0.4130 - val_accuracy50: 0.3912 - 4s/epoch - 22ms/step
Epoch 14/50
200/200 - 4s - loss: 12.3868 - accuracy10: 0.4800 - accuracy20: 0.4748 - accuracy30: 0.4662 - accuracy50: 0.4357 - val_loss: 13.0636 - val_accuracy10: 0.3875 - val_accuracy20: 0.4116 - val_accuracy30: 0.4115 - val_accuracy50: 0.3921 - 4s/epoch - 21ms/step
Epoch 15/50
200/200 - 4s - loss: 12.3573 - accuracy10: 0.4814 - accuracy20: 0.4776 - accuracy30: 0.4690 - accuracy50: 0.4357 - val_loss: 12.9257 - val_accuracy10: 0.4292 - val_accuracy20: 0.4318 - val_accuracy30: 0.4234 - val_accuracy50: 0.4003 - 4s/epoch - 21ms/step
Epoch 16/50
200/200 - 4s - loss: 12.3122 - accuracy10: 0.4901 - accuracy20: 0.4822 - accuracy30: 0.4724 - accuracy50: 0.4382 - val_loss: 12.9336 - val_accuracy10: 0.4292 - val_accuracy20: 0.4367 - val_accuracy30: 0.4293 - val_accuracy50: 0.4030 - 4s/epoch - 22ms/step
Epoch 17/50
200/200 - 4s - loss: 12.2693 - accuracy10: 0.4910 - accuracy20: 0.4850 - accuracy30: 0.4743 - accuracy50: 0.4416 - val_loss: 12.8902 - val_accuracy10: 0.4366 - val_accuracy20: 0.4356 - val_accuracy30: 0.4255 - val_accuracy50: 0.4020 - 4s/epoch - 22ms/step
Epoch 18/50
200/200 - 4s - loss: 12.2514 - accuracy10: 0.4956 - accuracy20: 0.4877 - accuracy30: 0.4775 - accuracy50: 0.4442 - val_loss: 12.8970 - val_accuracy10: 0.4277 - val_accuracy20: 0.4370 - val_accuracy30: 0.4272 - val_accuracy50: 0.4001 - 4s/epoch - 22ms/step
Epoch 19/50
200/200 - 4s - loss: 12.2054 - accuracy10: 0.4969 - accuracy20: 0.4898 - accuracy30: 0.4797 - accuracy50: 0.4447 - val_loss: 12.9521 - val_accuracy10: 0.4338 - val_accuracy20: 0.4366 - val_accuracy30: 0.4260 - val_accuracy50: 0.4007 - 4s/epoch - 22ms/step
Epoch 20/50
200/200 - 4s - loss: 12.1789 - accuracy10: 0.4993 - accuracy20: 0.4921 - accuracy30: 0.4820 - accuracy50: 0.4482 - val_loss: 12.8767 - val_accuracy10: 0.4318 - val_accuracy20: 0.4372 - val_accuracy30: 0.4312 - val_accuracy50: 0.4050 - 4s/epoch - 22ms/step
Epoch 21/50
200/200 - 4s - loss: 12.1527 - accuracy10: 0.5003 - accuracy20: 0.4942 - accuracy30: 0.4833 - accuracy50: 0.4494 - val_loss: 12.9122 - val_accuracy10: 0.4281 - val_accuracy20: 0.4354 - val_accuracy30: 0.4254 - val_accuracy50: 0.4030 - 4s/epoch - 22ms/step
Epoch 22/50
200/200 - 4s - loss: 12.1295 - accuracy10: 0.5039 - accuracy20: 0.4975 - accuracy30: 0.4858 - accuracy50: 0.4510 - val_loss: 12.9534 - val_accuracy10: 0.4341 - val_accuracy20: 0.4355 - val_accuracy30: 0.4276 - val_accuracy50: 0.4056 - 4s/epoch - 21ms/step
testing model: results/LILAK/W9/deepLOB_L1/seq2seq
Evaluating performance on  test set...
295/295 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.100611
{'0': {'precision': 0.3589393869342087, 'recall': 0.726375374251497, 'f1-score': 0.48045920103970047, 'support': 21376}, '1': {'precision': 0.5853313196148764, 'recall': 0.20105048147067406, 'f1-score': 0.29929772908270386, 'support': 30843}, '2': {'precision': 0.4512127125731809, 'recall': 0.4193910602461671, 'f1-score': 0.4347203258947557, 'support': 23155}, 'accuracy': 0.41710669461618066, 'macro avg': {'precision': 0.465161139707422, 'recall': 0.44893897198944605, 'f1-score': 0.40482575200571996, 'support': 75374}, 'weighted avg': {'precision': 0.47992534011223076, 'recall': 0.41710669461618066, 'f1-score': 0.39227697728149674, 'support': 75374}}
[[15527  1675  4174]
 [17005  6201  7637]
 [10726  2718  9711]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0833075
{'0': {'precision': 0.387154225939536, 'recall': 0.7111562034122909, 'f1-score': 0.501364863878549, 'support': 24148}, '1': {'precision': 0.4879690949227373, 'recall': 0.17944554937695337, 'f1-score': 0.2623972460456421, 'support': 24637}, '2': {'precision': 0.4898210137996994, 'recall': 0.4044905788107864, 'f1-score': 0.44308490915832405, 'support': 26589}, 'accuracy': 0.42917982328123755, 'macro avg': {'precision': 0.4549814448873242, 'recall': 0.4316974438666769, 'f1-score': 0.4022823396941717, 'support': 75374}, 'weighted avg': {'precision': 0.456323742610444, 'recall': 0.42917982328123755, 'f1-score': 0.402696212664531, 'support': 75374}}
[[17173  1827  5148]
 [14162  4421  6054]
 [13022  2812 10755]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.080428
{'0': {'precision': 0.39381506970178226, 'recall': 0.708070592901051, 'f1-score': 0.5061303170755908, 'support': 25215}, '1': {'precision': 0.4394188250157928, 'recall': 0.15413250609350765, 'f1-score': 0.22821522309711287, 'support': 22565}, '2': {'precision': 0.49328752881616417, 'recall': 0.39548452562151193, 'f1-score': 0.4390047669811131, 'support': 27594}, 'accuracy': 0.4278000371480882, 'macro avg': {'precision': 0.44217380784457977, 'recall': 0.41922920820535686, 'f1-score': 0.39111676905127224, 'support': 75374}, 'weighted avg': {'precision': 0.443883949892072, 'recall': 0.4278000371480882, 'f1-score': 0.39835553366312265, 'support': 75374}}
[[17854  1822  5539]
 [13416  3478  5671]
 [14066  2615 10913]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1024102
{'0': {'precision': 0.37214690978387976, 'recall': 0.6995156103716368, 'f1-score': 0.48582938723584707, 'support': 24567}, '1': {'precision': 0.3829424307036247, 'recall': 0.11445808726685644, 'f1-score': 0.1762396964542719, 'support': 23537}, '2': {'precision': 0.46360723794052616, 'recall': 0.37675100843417675, 'f1-score': 0.4156905585563715, 'support': 27270}, 'accuracy': 0.4000451083928145, 'macro avg': {'precision': 0.4062321928093436, 'recall': 0.39690823535755665, 'f1-score': 0.35925321408216354, 'support': 75374}, 'weighted avg': {'precision': 0.4086079882024297, 'recall': 0.4000451083928145, 'f1-score': 0.3637780378313411, 'support': 75374}}
[[17185  1944  5438]
 [14394  2694  6449]
 [14599  2397 10274]]
Evaluating performance on  train set...
200/200 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0773104
{'0': {'precision': 0.39410760034158837, 'recall': 0.5649483133841132, 'f1-score': 0.46431166508300264, 'support': 14704}, '1': {'precision': 0.619800163132137, 'recall': 0.2747694811064907, 'f1-score': 0.38074658649630466, 'support': 22124}, '2': {'precision': 0.37449982710072616, 'recall': 0.5301027900146843, 'f1-score': 0.438918480778138, 'support': 14301}, 'accuracy': 0.4296387568698781, 'macro avg': {'precision': 0.4628025301914838, 'recall': 0.4566068615017627, 'f1-score': 0.42799224411914844, 'support': 51129}, 'weighted avg': {'precision': 0.48628252052505616, 'recall': 0.4296387568698781, 'f1-score': 0.4210496860222744, 'support': 51129}}
[[8307 1623 4774]
 [8157 6079 7888]
 [4614 2106 7581]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0615447
{'0': {'precision': 0.42609539656128675, 'recall': 0.54907683144729, 'f1-score': 0.47983136418050276, 'support': 16790}, '1': {'precision': 0.5254349262277032, 'recall': 0.26745880506669656, 'f1-score': 0.3544792749962858, 'support': 17842}, '2': {'precision': 0.41144480917152515, 'recall': 0.5090622537431048, 'f1-score': 0.45507748997507314, 'support': 16497}, 'accuracy': 0.4378923898374699, 'macro avg': {'precision': 0.4543250439868383, 'recall': 0.44186596341903045, 'f1-score': 0.4297960430506205, 'support': 51129}, 'weighted avg': {'precision': 0.45603388837883263, 'recall': 0.4378923898374699, 'f1-score': 0.4281014919359494, 'support': 51129}}
[[9219 1926 5645]
 [6702 4772 6368]
 [5715 2384 8398]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0621967
{'0': {'precision': 0.4318963955805108, 'recall': 0.5445618041678562, 'f1-score': 0.4817293365994091, 'support': 17515}, '1': {'precision': 0.4860131640808651, 'recall': 0.2511845462276759, 'f1-score': 0.3311974369243092, 'support': 16462}, '2': {'precision': 0.4199737059940595, 'recall': 0.5028568097014925, 'f1-score': 0.4576932261402531, 'support': 17152}, 'accuracy': 0.4361125779890082, 'macro avg': {'precision': 0.44596108855181177, 'recall': 0.4328677200323415, 'f1-score': 0.42353999988799046, 'support': 51129}, 'weighted avg': {'precision': 0.44532071976572896, 'recall': 0.4361125779890082, 'f1-score': 0.42519931451708914, 'support': 51129}}
[[9538 2013 5964]
 [6379 4135 5948]
 [6167 2360 8625]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.080764
{'0': {'precision': 0.4049324142869931, 'recall': 0.5212606591380502, 'f1-score': 0.4557912237392312, 'support': 17356}, '1': {'precision': 0.4426867851058652, 'recall': 0.2168057210965435, 'f1-score': 0.29106328506280504, 'support': 16780}, '2': {'precision': 0.3990471097282318, 'recall': 0.4830224209968811, 'f1-score': 0.4370374314466748, 'support': 16993}, 'accuracy': 0.4086330653836375, 'macro avg': {'precision': 0.4155554363736967, 'recall': 0.40702960041049163, 'f1-score': 0.3946306467495703, 'support': 51129}, 'weighted avg': {'precision': 0.4153669888332123, 'recall': 0.4086330653836375, 'f1-score': 0.39549632253995404, 'support': 51129}}
[[9047 2183 6126]
 [6907 3638 6235]
 [6388 2397 8208]]
Evaluating performance on  val set...
53/53 - 1s - 556ms/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0643448
{'0': {'precision': 0.3592822636300897, 'recall': 0.714717188358045, 'f1-score': 0.4781849912739965, 'support': 3642}, '1': {'precision': 0.6265843353916152, 'recall': 0.3177323665128543, 'f1-score': 0.4216511755057408, 'support': 6068}, '2': {'precision': 0.45250158328055734, 'recall': 0.37904509283819626, 'f1-score': 0.4125288683602772, 'support': 3770}, 'accuracy': 0.4421364985163205, 'macro avg': {'precision': 0.47945606076742076, 'recall': 0.4704982159030318, 'f1-score': 0.43745501171333817, 'support': 13480}, 'weighted avg': {'precision': 0.5056788368148968, 'recall': 0.4421364985163205, 'f1-score': 0.43437410273790616, 'support': 13480}}
[[2603  440  599]
 [3010 1928 1130]
 [1632  709 1429]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.058724
{'0': {'precision': 0.3963285789751717, 'recall': 0.7131653992395437, 'f1-score': 0.5095076400679117, 'support': 4208}, '1': {'precision': 0.5485474006116208, 'recall': 0.28786359077231694, 'f1-score': 0.37758189711880014, 'support': 4985}, '2': {'precision': 0.4726609963547995, 'recall': 0.3629577793328668, 'f1-score': 0.4106082596648635, 'support': 4287}, 'accuracy': 0.44451038575667656, 'macro avg': {'precision': 0.47251232531386406, 'recall': 0.45466225644824254, 'f1-score': 0.4325659322838584, 'support': 13480}, 'weighted avg': {'precision': 0.47689593054521345, 'recall': 0.44451038575667656, 'f1-score': 0.42926791659690366, 'support': 13480}}
[[3001  464  743]
 [2557 1435  993]
 [2014  717 1556]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.065984
{'0': {'precision': 0.3991150442477876, 'recall': 0.7139303482587065, 'f1-score': 0.5120012974375608, 'support': 4422}, '1': {'precision': 0.5071726052753355, 'recall': 0.23299319727891157, 'f1-score': 0.31930080116533144, 'support': 4704}, '2': {'precision': 0.44881196831915515, 'recall': 0.35140101056499773, 'f1-score': 0.3941775086950921, 'support': 4354}, 'accuracy': 0.4290059347181009, 'macro avg': {'precision': 0.4516998726140928, 'recall': 0.43277485203420524, 'f1-score': 0.40849320243266146, 'support': 13480}, 'weighted avg': {'precision': 0.4528749236602742, 'recall': 0.4290059347181009, 'f1-score': 0.40669952365052253, 'support': 13480}}
[[3157  418  847]
 [2576 1096 1032]
 [2177  647 1530]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0861151
{'0': {'precision': 0.3800860479409957, 'recall': 0.706904435299497, 'f1-score': 0.49436405787832766, 'support': 4374}, '1': {'precision': 0.4807897545357524, 'recall': 0.18596491228070175, 'f1-score': 0.2681946718261646, 'support': 4845}, '2': {'precision': 0.41659464131374246, 'recall': 0.33935695846045527, 'f1-score': 0.37403000517330576, 'support': 4261}, 'accuracy': 0.403486646884273, 'macro avg': {'precision': 0.4258234812634969, 'recall': 0.4107421020135513, 'f1-score': 0.3788629116259326, 'support': 13480}, 'weighted avg': {'precision': 0.4278214021556003, 'recall': 0.403486646884273, 'f1-score': 0.3750366043175837, 'support': 13480}}
[[3092  395  887]
 [2806  901 1138]
 [2237  578 1446]]
training model: results/LILAK/W9/deepOF_L1/seq2seq
Epoch 1/50
200/200 - 10s - loss: 13.2186 - accuracy10: 0.3647 - accuracy20: 0.3606 - accuracy30: 0.3557 - accuracy50: 0.3543 - val_loss: 13.4128 - val_accuracy10: 0.3117 - val_accuracy20: 0.3386 - val_accuracy30: 0.3455 - val_accuracy50: 0.3339 - 10s/epoch - 51ms/step
Epoch 2/50
200/200 - 4s - loss: 13.1229 - accuracy10: 0.3880 - accuracy20: 0.3808 - accuracy30: 0.3740 - accuracy50: 0.3659 - val_loss: 13.3990 - val_accuracy10: 0.3399 - val_accuracy20: 0.3453 - val_accuracy30: 0.3477 - val_accuracy50: 0.3390 - 4s/epoch - 20ms/step
Epoch 3/50
200/200 - 4s - loss: 13.0565 - accuracy10: 0.4047 - accuracy20: 0.3887 - accuracy30: 0.3815 - accuracy50: 0.3700 - val_loss: 13.2809 - val_accuracy10: 0.3575 - val_accuracy20: 0.3596 - val_accuracy30: 0.3570 - val_accuracy50: 0.3447 - 4s/epoch - 22ms/step
Epoch 4/50
200/200 - 4s - loss: 12.9817 - accuracy10: 0.4145 - accuracy20: 0.3995 - accuracy30: 0.3905 - accuracy50: 0.3790 - val_loss: 13.2765 - val_accuracy10: 0.3467 - val_accuracy20: 0.3597 - val_accuracy30: 0.3650 - val_accuracy50: 0.3542 - 4s/epoch - 20ms/step
Epoch 5/50
200/200 - 4s - loss: 12.9327 - accuracy10: 0.4188 - accuracy20: 0.4037 - accuracy30: 0.3927 - accuracy50: 0.3808 - val_loss: 13.2209 - val_accuracy10: 0.3580 - val_accuracy20: 0.3722 - val_accuracy30: 0.3723 - val_accuracy50: 0.3619 - 4s/epoch - 21ms/step
Epoch 6/50
200/200 - 4s - loss: 12.8782 - accuracy10: 0.4253 - accuracy20: 0.4090 - accuracy30: 0.3977 - accuracy50: 0.3810 - val_loss: 13.1914 - val_accuracy10: 0.3669 - val_accuracy20: 0.3737 - val_accuracy30: 0.3720 - val_accuracy50: 0.3648 - 4s/epoch - 21ms/step
Epoch 7/50
200/200 - 4s - loss: 12.8306 - accuracy10: 0.4311 - accuracy20: 0.4128 - accuracy30: 0.4024 - accuracy50: 0.3834 - val_loss: 13.1932 - val_accuracy10: 0.3669 - val_accuracy20: 0.3743 - val_accuracy30: 0.3747 - val_accuracy50: 0.3633 - 4s/epoch - 20ms/step
Epoch 8/50
200/200 - 4s - loss: 12.7905 - accuracy10: 0.4378 - accuracy20: 0.4212 - accuracy30: 0.4081 - accuracy50: 0.3910 - val_loss: 13.1469 - val_accuracy10: 0.3743 - val_accuracy20: 0.3806 - val_accuracy30: 0.3720 - val_accuracy50: 0.3631 - 4s/epoch - 20ms/step
Epoch 9/50
200/200 - 4s - loss: 12.7650 - accuracy10: 0.4404 - accuracy20: 0.4238 - accuracy30: 0.4129 - accuracy50: 0.3938 - val_loss: 13.1671 - val_accuracy10: 0.3742 - val_accuracy20: 0.3768 - val_accuracy30: 0.3780 - val_accuracy50: 0.3617 - 4s/epoch - 20ms/step
Epoch 10/50
200/200 - 4s - loss: 12.7273 - accuracy10: 0.4454 - accuracy20: 0.4284 - accuracy30: 0.4183 - accuracy50: 0.3963 - val_loss: 13.1843 - val_accuracy10: 0.3908 - val_accuracy20: 0.3852 - val_accuracy30: 0.3796 - val_accuracy50: 0.3599 - 4s/epoch - 20ms/step
Epoch 11/50
200/200 - 4s - loss: 12.7136 - accuracy10: 0.4491 - accuracy20: 0.4334 - accuracy30: 0.4203 - accuracy50: 0.3995 - val_loss: 13.1364 - val_accuracy10: 0.3823 - val_accuracy20: 0.3856 - val_accuracy30: 0.3818 - val_accuracy50: 0.3653 - 4s/epoch - 20ms/step
Epoch 12/50
200/200 - 4s - loss: 12.6681 - accuracy10: 0.4484 - accuracy20: 0.4350 - accuracy30: 0.4239 - accuracy50: 0.4023 - val_loss: 13.0855 - val_accuracy10: 0.3970 - val_accuracy20: 0.3938 - val_accuracy30: 0.3914 - val_accuracy50: 0.3711 - 4s/epoch - 20ms/step
Epoch 13/50
200/200 - 4s - loss: 12.6484 - accuracy10: 0.4529 - accuracy20: 0.4379 - accuracy30: 0.4293 - accuracy50: 0.4077 - val_loss: 13.1535 - val_accuracy10: 0.3841 - val_accuracy20: 0.3901 - val_accuracy30: 0.3898 - val_accuracy50: 0.3711 - 4s/epoch - 20ms/step
Epoch 14/50
200/200 - 4s - loss: 12.6358 - accuracy10: 0.4554 - accuracy20: 0.4407 - accuracy30: 0.4298 - accuracy50: 0.4079 - val_loss: 13.0984 - val_accuracy10: 0.3930 - val_accuracy20: 0.3919 - val_accuracy30: 0.3890 - val_accuracy50: 0.3668 - 4s/epoch - 20ms/step
Epoch 15/50
200/200 - 4s - loss: 12.6053 - accuracy10: 0.4581 - accuracy20: 0.4444 - accuracy30: 0.4335 - accuracy50: 0.4104 - val_loss: 13.1589 - val_accuracy10: 0.3951 - val_accuracy20: 0.3973 - val_accuracy30: 0.3902 - val_accuracy50: 0.3716 - 4s/epoch - 20ms/step
Epoch 16/50
200/200 - 4s - loss: 12.5799 - accuracy10: 0.4607 - accuracy20: 0.4460 - accuracy30: 0.4333 - accuracy50: 0.4115 - val_loss: 13.1186 - val_accuracy10: 0.4041 - val_accuracy20: 0.4033 - val_accuracy30: 0.3967 - val_accuracy50: 0.3709 - 4s/epoch - 20ms/step
Epoch 17/50
200/200 - 4s - loss: 12.5501 - accuracy10: 0.4637 - accuracy20: 0.4495 - accuracy30: 0.4393 - accuracy50: 0.4148 - val_loss: 13.1422 - val_accuracy10: 0.3925 - val_accuracy20: 0.3990 - val_accuracy30: 0.3901 - val_accuracy50: 0.3714 - 4s/epoch - 21ms/step
Epoch 18/50
200/200 - 4s - loss: 12.5342 - accuracy10: 0.4625 - accuracy20: 0.4517 - accuracy30: 0.4408 - accuracy50: 0.4175 - val_loss: 13.0846 - val_accuracy10: 0.4073 - val_accuracy20: 0.4073 - val_accuracy30: 0.4019 - val_accuracy50: 0.3787 - 4s/epoch - 20ms/step
Epoch 19/50
200/200 - 4s - loss: 12.5076 - accuracy10: 0.4688 - accuracy20: 0.4557 - accuracy30: 0.4434 - accuracy50: 0.4185 - val_loss: 13.0569 - val_accuracy10: 0.4056 - val_accuracy20: 0.4076 - val_accuracy30: 0.3993 - val_accuracy50: 0.3811 - 4s/epoch - 20ms/step
Epoch 20/50
200/200 - 4s - loss: 12.4651 - accuracy10: 0.4712 - accuracy20: 0.4616 - accuracy30: 0.4482 - accuracy50: 0.4248 - val_loss: 13.0570 - val_accuracy10: 0.4047 - val_accuracy20: 0.4096 - val_accuracy30: 0.4054 - val_accuracy50: 0.3812 - 4s/epoch - 20ms/step
Epoch 21/50
200/200 - 4s - loss: 12.4633 - accuracy10: 0.4701 - accuracy20: 0.4611 - accuracy30: 0.4493 - accuracy50: 0.4248 - val_loss: 12.9588 - val_accuracy10: 0.4119 - val_accuracy20: 0.4127 - val_accuracy30: 0.4091 - val_accuracy50: 0.3895 - 4s/epoch - 20ms/step
Epoch 22/50
200/200 - 4s - loss: 12.4345 - accuracy10: 0.4726 - accuracy20: 0.4610 - accuracy30: 0.4523 - accuracy50: 0.4273 - val_loss: 13.0606 - val_accuracy10: 0.4004 - val_accuracy20: 0.4033 - val_accuracy30: 0.3996 - val_accuracy50: 0.3798 - 4s/epoch - 20ms/step
Epoch 23/50
200/200 - 4s - loss: 12.4197 - accuracy10: 0.4743 - accuracy20: 0.4652 - accuracy30: 0.4554 - accuracy50: 0.4301 - val_loss: 13.1495 - val_accuracy10: 0.3981 - val_accuracy20: 0.4007 - val_accuracy30: 0.3895 - val_accuracy50: 0.3656 - 4s/epoch - 20ms/step
Epoch 24/50
200/200 - 4s - loss: 12.4060 - accuracy10: 0.4745 - accuracy20: 0.4660 - accuracy30: 0.4564 - accuracy50: 0.4297 - val_loss: 13.0254 - val_accuracy10: 0.4079 - val_accuracy20: 0.4102 - val_accuracy30: 0.4014 - val_accuracy50: 0.3818 - 4s/epoch - 19ms/step
Epoch 25/50
200/200 - 4s - loss: 12.3815 - accuracy10: 0.4781 - accuracy20: 0.4682 - accuracy30: 0.4572 - accuracy50: 0.4317 - val_loss: 13.0146 - val_accuracy10: 0.4063 - val_accuracy20: 0.4085 - val_accuracy30: 0.4042 - val_accuracy50: 0.3838 - 4s/epoch - 19ms/step
Epoch 26/50
200/200 - 4s - loss: 12.3538 - accuracy10: 0.4765 - accuracy20: 0.4686 - accuracy30: 0.4578 - accuracy50: 0.4314 - val_loss: 13.0384 - val_accuracy10: 0.4093 - val_accuracy20: 0.4142 - val_accuracy30: 0.4063 - val_accuracy50: 0.3852 - 4s/epoch - 20ms/step
Epoch 27/50
200/200 - 4s - loss: 12.3274 - accuracy10: 0.4813 - accuracy20: 0.4734 - accuracy30: 0.4629 - accuracy50: 0.4402 - val_loss: 13.0878 - val_accuracy10: 0.4000 - val_accuracy20: 0.4051 - val_accuracy30: 0.3967 - val_accuracy50: 0.3829 - 4s/epoch - 20ms/step
Epoch 28/50
200/200 - 4s - loss: 12.3008 - accuracy10: 0.4853 - accuracy20: 0.4764 - accuracy30: 0.4651 - accuracy50: 0.4405 - val_loss: 13.0507 - val_accuracy10: 0.4031 - val_accuracy20: 0.4079 - val_accuracy30: 0.4019 - val_accuracy50: 0.3828 - 4s/epoch - 20ms/step
Epoch 29/50
200/200 - 4s - loss: 12.2983 - accuracy10: 0.4811 - accuracy20: 0.4762 - accuracy30: 0.4666 - accuracy50: 0.4409 - val_loss: 13.1154 - val_accuracy10: 0.3988 - val_accuracy20: 0.3998 - val_accuracy30: 0.3983 - val_accuracy50: 0.3763 - 4s/epoch - 20ms/step
Epoch 30/50
200/200 - 4s - loss: 12.2548 - accuracy10: 0.4858 - accuracy20: 0.4801 - accuracy30: 0.4693 - accuracy50: 0.4436 - val_loss: 13.2070 - val_accuracy10: 0.3884 - val_accuracy20: 0.3936 - val_accuracy30: 0.3871 - val_accuracy50: 0.3714 - 4s/epoch - 20ms/step
Epoch 31/50
200/200 - 4s - loss: 12.2300 - accuracy10: 0.4897 - accuracy20: 0.4826 - accuracy30: 0.4739 - accuracy50: 0.4480 - val_loss: 13.0453 - val_accuracy10: 0.4078 - val_accuracy20: 0.4098 - val_accuracy30: 0.4013 - val_accuracy50: 0.3842 - 4s/epoch - 20ms/step
testing model: results/LILAK/W9/deepOF_L1/seq2seq
Evaluating performance on  test set...
295/295 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0990945
{'0': {'precision': 0.3390911160990209, 'recall': 0.4876497005988024, 'f1-score': 0.4000230251165646, 'support': 21376}, '1': {'precision': 0.6102092580849715, 'recall': 0.3120197140170552, 'f1-score': 0.41290682456930766, 'support': 30841}, '2': {'precision': 0.3773519525971101, 'recall': 0.47034941476266573, 'f1-score': 0.4187495193416904, 'support': 23153}, 'accuracy': 0.41046835610985805, 'macro avg': {'precision': 0.44221744226036747, 'recall': 0.4233396097928411, 'f1-score': 0.4105597896758542, 'support': 75370}, 'weighted avg': {'precision': 0.461784598445166, 'recall': 0.41046835610985805, 'f1-score': 0.41104762084054475, 'support': 75370}}
[[10424  2818  8134]
 [11383  9623  9835]
 [ 8934  3329 10890]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0820383
{'0': {'precision': 0.3652545175741904, 'recall': 0.5031269413957341, 'f1-score': 0.42324576684551596, 'support': 24145}, '1': {'precision': 0.5050474837358857, 'recall': 0.27414052035556274, 'f1-score': 0.35538016311496967, 'support': 24637}, '2': {'precision': 0.4133203424037859, 'recall': 0.44674289153001356, 'f1-score': 0.429382207280483, 'support': 26588}, 'accuracy': 0.4083852991906594, 'macro avg': {'precision': 0.4278741145712874, 'recall': 0.4080034510937702, 'f1-score': 0.40266937908032285, 'support': 75370}, 'weighted avg': {'precision': 0.42790614896459733, 'recall': 0.4083852991906594, 'f1-score': 0.40322653902510247, 'support': 75370}}
[[12148  2983  9014]
 [10037  6754  7846]
 [11074  3636 11878]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0795413
{'0': {'precision': 0.36914623370885796, 'recall': 0.5302423353032166, 'f1-score': 0.43526673069722766, 'support': 25213}, '1': {'precision': 0.44975899147200593, 'recall': 0.2150232661200975, 'f1-score': 0.29094834047911733, 'support': 22565}, '2': {'precision': 0.41877599943594446, 'recall': 0.4305233400985793, 'f1-score': 0.4245684263197398, 'support': 27592}, 'accuracy': 0.3993631418336208, 'macro avg': {'precision': 0.41256040820560286, 'recall': 0.39192964717396445, 'f1-score': 0.38359449916536165, 'support': 75370}, 'weighted avg': {'precision': 0.4114496883309517, 'recall': 0.3993631418336208, 'f1-score': 0.38814278098706045, 'support': 75370}}
[[13369  2625  9219]
 [10445  4852  7268]
 [12402  3311 11879]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0996423
{'0': {'precision': 0.34980600367571985, 'recall': 0.5578668837777325, 'f1-score': 0.4299901162517062, 'support': 24565}, '1': {'precision': 0.3953655040611562, 'recall': 0.1406296469388622, 'f1-score': 0.20746497853270235, 'support': 23537}, '2': {'precision': 0.4000431313349148, 'recall': 0.4081707495965967, 'f1-score': 0.40406607369758574, 'support': 27268}, 'accuracy': 0.37341117155366854, 'macro avg': {'precision': 0.38173821302393035, 'recall': 0.36888909343773046, 'f1-score': 0.34717372282733144, 'support': 75370}, 'weighted avg': {'precision': 0.38220881590317035, 'recall': 0.37341117155366854, 'f1-score': 0.3511195980235259, 'support': 75370}}
[[13704  2354  8507]
 [12042  3310  8185]
 [13430  2708 11130]]
Evaluating performance on  train set...
200/200 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0688541
{'0': {'precision': 0.3737528423592742, 'recall': 0.5494610451630509, 'f1-score': 0.4448863479437678, 'support': 14658}, '1': {'precision': 0.640120878144165, 'recall': 0.32539646681425927, 'f1-score': 0.4314641744548287, 'support': 22133}, '2': {'precision': 0.3811732605729877, 'recall': 0.4873029161434352, 'f1-score': 0.4277534523408555, 'support': 14334}, 'accuracy': 0.4350317848410758, 'macro avg': {'precision': 0.465015660358809, 'recall': 0.4540534760402484, 'f1-score': 0.43470132491315067, 'support': 51125}, 'weighted avg': {'precision': 0.4911491848668998, 'recall': 0.4350317848410758, 'f1-score': 0.4342720517794092, 'support': 51125}}
[[8054 2021 4583]
 [8174 7202 6757]
 [5321 2028 6985]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0499643
{'0': {'precision': 0.4102934102934103, 'recall': 0.5572183621355188, 'f1-score': 0.47259997985292646, 'support': 16839}, '1': {'precision': 0.5555, 'recall': 0.31151861821444593, 'f1-score': 0.39918079908019544, 'support': 17832}, '2': {'precision': 0.4224364592462752, 'recall': 0.46870061991005224, 'f1-score': 0.44436761740132524, 'support': 16454}, 'accuracy': 0.4430317848410758, 'macro avg': {'precision': 0.4627432898465618, 'recall': 0.44581253342000565, 'f1-score': 0.43871613211148236, 'support': 51125}, 'weighted avg': {'precision': 0.46484843494120187, 'recall': 0.4430317848410758, 'f1-score': 0.43790567915233014, 'support': 51125}}
[[9383 2225 5231]
 [6964 5555 5313]
 [6522 2220 7712]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0505549
{'0': {'precision': 0.4133982250214715, 'recall': 0.5771382893685052, 'f1-score': 0.4817347789824854, 'support': 17514}, '1': {'precision': 0.5240529862886358, 'recall': 0.2730354764499334, 'f1-score': 0.35901926444833626, 'support': 16518}, '2': {'precision': 0.43026344919194154, 'recall': 0.45480606096062715, 'f1-score': 0.44219447683512975, 'support': 17093}, 'accuracy': 0.4379853300733496, 'macro avg': {'precision': 0.4559048868340163, 'recall': 0.4349932755930219, 'f1-score': 0.42764950675531715, 'support': 51125}, 'weighted avg': {'precision': 0.4547883985834639, 'recall': 0.4379853300733496, 'f1-score': 0.4288667642405817, 'support': 51125}}
[[10108  2080  5326]
 [ 7040  4510  4968]
 [ 7303  2016  7774]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0692191
{'0': {'precision': 0.39178061204948483, 'recall': 0.5885500575373993, 'f1-score': 0.47041780680172, 'support': 17380}, '1': {'precision': 0.49558885310180645, 'recall': 0.21090584028605483, 'f1-score': 0.29589064002341037, 'support': 16780}, '2': {'precision': 0.4107972027972028, 'recall': 0.43283230179781906, 'f1-score': 0.4215269804822043, 'support': 16965}, 'accuracy': 0.4129290953545232, 'macro avg': {'precision': 0.432722222649498, 'recall': 0.4107627332070911, 'f1-score': 0.3959451424357783, 'support': 51125}, 'weighted avg': {'precision': 0.43216239682978785, 'recall': 0.4129290953545232, 'f1-score': 0.3969117192310478, 'support': 51125}}
[[10229  1839  5312]
 [ 8021  3539  5220]
 [ 7859  1763  7343]]
Evaluating performance on  val set...
53/53 - 0s - 484ms/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0994649
{'0': {'precision': 0.33052926743778477, 'recall': 0.515019115237575, 'f1-score': 0.40264730999146026, 'support': 3662}, '1': {'precision': 0.6364221364221364, 'recall': 0.3266182298546896, 'f1-score': 0.4316892186817984, 'support': 6056}, '2': {'precision': 0.35212173167595373, 'recall': 0.436735778841042, 'f1-score': 0.389890840056953, 'support': 3762}, 'accuracy': 0.4085311572700297, 'macro avg': {'precision': 0.43969104517862495, 'recall': 0.4261243746444355, 'f1-score': 0.40807578957673724, 'support': 13480}, 'weighted avg': {'precision': 0.47398016246992314, 'recall': 0.4085311572700297, 'f1-score': 0.4121345473160205, 'support': 13480}}
[[1886  577 1199]
 [2254 1978 1824]
 [1566  553 1643]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0820339
{'0': {'precision': 0.3662895556648631, 'recall': 0.5272598536700496, 'f1-score': 0.43227554179566563, 'support': 4237}, '1': {'precision': 0.5414831130690162, 'recall': 0.29701973419250904, 'f1-score': 0.3836150845253576, 'support': 4966}, '2': {'precision': 0.3912389950611982, 'recall': 0.4259995323825111, 'f1-score': 0.4078800089545556, 'support': 4277}, 'accuracy': 0.4103115727002967, 'macro avg': {'precision': 0.4330038879316925, 'recall': 0.4167597067483566, 'f1-score': 0.40792354509185963, 'support': 13480}, 'weighted avg': {'precision': 0.4387465258701413, 'recall': 0.4103115727002967, 'f1-score': 0.40660881147179495, 'support': 13480}}
[[2234  647 1356]
 [2012 1475 1479]
 [1853  602 1822]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0816507
{'0': {'precision': 0.3772546621828187, 'recall': 0.5574881409532415, 'f1-score': 0.4499954416993345, 'support': 4427}, '1': {'precision': 0.5144086021505376, 'recall': 0.2542517006802721, 'f1-score': 0.3403044529805093, 'support': 4704}, '2': {'precision': 0.3919358335139822, 'recall': 0.4157277535065532, 'f1-score': 0.40348136576656995, 'support': 4349}, 'accuracy': 0.4059347181008902, 'macro avg': {'precision': 0.42786636594911287, 'recall': 0.40915586504668894, 'f1-score': 0.39792708681547123, 'support': 13480}, 'weighted avg': {'precision': 0.42985262566407834, 'recall': 0.4059347181008902, 'f1-score': 0.39671086253279536, 'support': 13480}}
[[2468  581 1378]
 [2081 1196 1427]
 [1993  548 1808]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0943937
{'0': {'precision': 0.3647142857142857, 'recall': 0.582212086659065, 'f1-score': 0.4484848484848485, 'support': 4385}, '1': {'precision': 0.5015657620041754, 'recall': 0.20016663195167672, 'f1-score': 0.2861396456751526, 'support': 4801}, '2': {'precision': 0.3726993865030675, 'recall': 0.39613414066138797, 'f1-score': 0.38405960713479337, 'support': 4294}, 'accuracy': 0.38686943620178044, 'macro avg': {'precision': 0.4129931447405095, 'recall': 0.3928376197573766, 'f1-score': 0.3728947004315981, 'support': 13480}, 'weighted avg': {'precision': 0.4159985557776974, 'recall': 0.38686943620178044, 'f1-score': 0.3701420217009845, 'support': 13480}}
[[2553  490 1342]
 [2319  961 1521]
 [2128  465 1701]]
training model: results/LILAK/W9/deepLOB_L2/seq2seq
Epoch 1/50
200/200 - 15s - loss: 13.2941 - accuracy10: 0.3696 - accuracy20: 0.3675 - accuracy30: 0.3683 - accuracy50: 0.3661 - val_loss: 13.4875 - val_accuracy10: 0.3006 - val_accuracy20: 0.3329 - val_accuracy30: 0.3434 - val_accuracy50: 0.3429 - 15s/epoch - 76ms/step
Epoch 2/50
200/200 - 9s - loss: 13.2132 - accuracy10: 0.3753 - accuracy20: 0.3724 - accuracy30: 0.3698 - accuracy50: 0.3666 - val_loss: 13.3768 - val_accuracy10: 0.3045 - val_accuracy20: 0.3412 - val_accuracy30: 0.3504 - val_accuracy50: 0.3476 - 9s/epoch - 46ms/step
Epoch 3/50
200/200 - 9s - loss: 13.1200 - accuracy10: 0.3818 - accuracy20: 0.3830 - accuracy30: 0.3794 - accuracy50: 0.3724 - val_loss: 13.3670 - val_accuracy10: 0.3073 - val_accuracy20: 0.3375 - val_accuracy30: 0.3484 - val_accuracy50: 0.3435 - 9s/epoch - 46ms/step
Epoch 4/50
200/200 - 9s - loss: 12.9938 - accuracy10: 0.3928 - accuracy20: 0.3982 - accuracy30: 0.3949 - accuracy50: 0.3865 - val_loss: 13.0671 - val_accuracy10: 0.3404 - val_accuracy20: 0.3686 - val_accuracy30: 0.3768 - val_accuracy50: 0.3688 - 9s/epoch - 46ms/step
Epoch 5/50
200/200 - 9s - loss: 12.8472 - accuracy10: 0.4105 - accuracy20: 0.4161 - accuracy30: 0.4121 - accuracy50: 0.3985 - val_loss: 13.2203 - val_accuracy10: 0.3473 - val_accuracy20: 0.3677 - val_accuracy30: 0.3692 - val_accuracy50: 0.3594 - 9s/epoch - 45ms/step
Epoch 6/50
200/200 - 9s - loss: 12.7519 - accuracy10: 0.4274 - accuracy20: 0.4300 - accuracy30: 0.4258 - accuracy50: 0.4112 - val_loss: 13.1621 - val_accuracy10: 0.3514 - val_accuracy20: 0.3751 - val_accuracy30: 0.3793 - val_accuracy50: 0.3618 - 9s/epoch - 46ms/step
Epoch 7/50
200/200 - 9s - loss: 12.6371 - accuracy10: 0.4432 - accuracy20: 0.4469 - accuracy30: 0.4362 - accuracy50: 0.4175 - val_loss: 12.8761 - val_accuracy10: 0.3881 - val_accuracy20: 0.4185 - val_accuracy30: 0.4197 - val_accuracy50: 0.4014 - 9s/epoch - 46ms/step
Epoch 8/50
200/200 - 9s - loss: 12.4423 - accuracy10: 0.4660 - accuracy20: 0.4713 - accuracy30: 0.4614 - accuracy50: 0.4365 - val_loss: 12.8081 - val_accuracy10: 0.4010 - val_accuracy20: 0.4239 - val_accuracy30: 0.4231 - val_accuracy50: 0.4065 - 9s/epoch - 46ms/step
Epoch 9/50
200/200 - 9s - loss: 12.3622 - accuracy10: 0.4792 - accuracy20: 0.4809 - accuracy30: 0.4717 - accuracy50: 0.4429 - val_loss: 12.8896 - val_accuracy10: 0.3881 - val_accuracy20: 0.4145 - val_accuracy30: 0.4125 - val_accuracy50: 0.3956 - 9s/epoch - 45ms/step
Epoch 10/50
200/200 - 9s - loss: 12.2511 - accuracy10: 0.4873 - accuracy20: 0.4907 - accuracy30: 0.4794 - accuracy50: 0.4488 - val_loss: 12.9005 - val_accuracy10: 0.3922 - val_accuracy20: 0.4180 - val_accuracy30: 0.4182 - val_accuracy50: 0.4042 - 9s/epoch - 45ms/step
Epoch 11/50
200/200 - 9s - loss: 12.1395 - accuracy10: 0.4947 - accuracy20: 0.4952 - accuracy30: 0.4855 - accuracy50: 0.4551 - val_loss: 12.7730 - val_accuracy10: 0.4288 - val_accuracy20: 0.4350 - val_accuracy30: 0.4246 - val_accuracy50: 0.4070 - 9s/epoch - 45ms/step
Epoch 12/50
200/200 - 9s - loss: 12.0529 - accuracy10: 0.5059 - accuracy20: 0.5036 - accuracy30: 0.4922 - accuracy50: 0.4608 - val_loss: 12.8171 - val_accuracy10: 0.4327 - val_accuracy20: 0.4314 - val_accuracy30: 0.4216 - val_accuracy50: 0.4005 - 9s/epoch - 45ms/step
Epoch 13/50
200/200 - 9s - loss: 11.9643 - accuracy10: 0.5108 - accuracy20: 0.5099 - accuracy30: 0.5004 - accuracy50: 0.4689 - val_loss: 12.9149 - val_accuracy10: 0.4265 - val_accuracy20: 0.4285 - val_accuracy30: 0.4165 - val_accuracy50: 0.3965 - 9s/epoch - 45ms/step
Epoch 14/50
200/200 - 9s - loss: 11.9117 - accuracy10: 0.5164 - accuracy20: 0.5152 - accuracy30: 0.5054 - accuracy50: 0.4726 - val_loss: 12.7816 - val_accuracy10: 0.4410 - val_accuracy20: 0.4438 - val_accuracy30: 0.4318 - val_accuracy50: 0.4138 - 9s/epoch - 45ms/step
Epoch 15/50
200/200 - 9s - loss: 11.8125 - accuracy10: 0.5208 - accuracy20: 0.5239 - accuracy30: 0.5133 - accuracy50: 0.4796 - val_loss: 12.9286 - val_accuracy10: 0.4329 - val_accuracy20: 0.4340 - val_accuracy30: 0.4220 - val_accuracy50: 0.3988 - 9s/epoch - 45ms/step
Epoch 16/50
200/200 - 9s - loss: 11.7610 - accuracy10: 0.5240 - accuracy20: 0.5254 - accuracy30: 0.5148 - accuracy50: 0.4845 - val_loss: 13.0652 - val_accuracy10: 0.4299 - val_accuracy20: 0.4240 - val_accuracy30: 0.4116 - val_accuracy50: 0.3932 - 9s/epoch - 45ms/step
Epoch 17/50
200/200 - 9s - loss: 11.6785 - accuracy10: 0.5289 - accuracy20: 0.5314 - accuracy30: 0.5217 - accuracy50: 0.4886 - val_loss: 13.1560 - val_accuracy10: 0.4203 - val_accuracy20: 0.4241 - val_accuracy30: 0.4125 - val_accuracy50: 0.3918 - 9s/epoch - 46ms/step
Epoch 18/50
200/200 - 9s - loss: 11.6158 - accuracy10: 0.5324 - accuracy20: 0.5365 - accuracy30: 0.5252 - accuracy50: 0.4913 - val_loss: 13.1737 - val_accuracy10: 0.4162 - val_accuracy20: 0.4182 - val_accuracy30: 0.4086 - val_accuracy50: 0.3935 - 9s/epoch - 45ms/step
Epoch 19/50
200/200 - 9s - loss: 11.5460 - accuracy10: 0.5374 - accuracy20: 0.5398 - accuracy30: 0.5292 - accuracy50: 0.4986 - val_loss: 13.2400 - val_accuracy10: 0.4132 - val_accuracy20: 0.4145 - val_accuracy30: 0.4030 - val_accuracy50: 0.3889 - 9s/epoch - 45ms/step
Epoch 20/50
200/200 - 9s - loss: 11.4614 - accuracy10: 0.5419 - accuracy20: 0.5468 - accuracy30: 0.5375 - accuracy50: 0.5054 - val_loss: 13.1304 - val_accuracy10: 0.4245 - val_accuracy20: 0.4249 - val_accuracy30: 0.4157 - val_accuracy50: 0.3929 - 9s/epoch - 45ms/step
Epoch 21/50
200/200 - 9s - loss: 11.4160 - accuracy10: 0.5437 - accuracy20: 0.5489 - accuracy30: 0.5399 - accuracy50: 0.5090 - val_loss: 13.0906 - val_accuracy10: 0.4335 - val_accuracy20: 0.4306 - val_accuracy30: 0.4194 - val_accuracy50: 0.3970 - 9s/epoch - 45ms/step
testing model: results/LILAK/W9/deepLOB_L2/seq2seq
Evaluating performance on  test set...
295/295 - 5s - 5s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0863078
{'0': {'precision': 0.35607260324034595, 'recall': 0.6837107035928144, 'f1-score': 0.46827189567613464, 'support': 21376}, '1': {'precision': 0.576987896430213, 'recall': 0.2442045196641053, 'f1-score': 0.34316695901770056, 'support': 30843}, '2': {'precision': 0.4352526439482961, 'recall': 0.39991362556683224, 'f1-score': 0.41683547152824674, 'support': 23155}, 'accuracy': 0.41668214503675005, 'macro avg': {'precision': 0.45610438120628505, 'recall': 0.442609616274584, 'f1-score': 0.4094247754073606, 'support': 75374}, 'weighted avg': {'precision': 0.4707952427506234, 'recall': 0.41668214503675005, 'f1-score': 0.40127768066166775, 'support': 75374}}
[[14615  2436  4325]
 [15621  7532  7690]
 [10809  3086  9260]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0800753
{'0': {'precision': 0.3828398675560248, 'recall': 0.6607586549610733, 'f1-score': 0.4847932427916022, 'support': 24148}, '1': {'precision': 0.47694311767260095, 'recall': 0.22291675122782806, 'f1-score': 0.30382828059305156, 'support': 24637}, '2': {'precision': 0.47238627654298726, 'recall': 0.39407273684606414, 'f1-score': 0.429690383432438, 'support': 26589}, 'accuracy': 0.4235678085281397, 'macro avg': {'precision': 0.4440564205905377, 'recall': 0.42591604767832186, 'f1-score': 0.4061039689390306, 'support': 75374}, 'weighted avg': {'precision': 0.4451872451885829, 'recall': 0.4235678085281397, 'f1-score': 0.4062042903519478, 'support': 75374}}
[[15956  2759  5433]
 [12875  5492  6270]
 [12847  3264 10478]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0803413
{'0': {'precision': 0.3907608953947056, 'recall': 0.6521514971247273, 'f1-score': 0.488699347667801, 'support': 25215}, '1': {'precision': 0.4357650725625791, 'recall': 0.1982716596499003, 'f1-score': 0.27253898635477586, 'support': 22565}, '2': {'precision': 0.47583061889250816, 'recall': 0.39704283539899976, 'f1-score': 0.4328809340366265, 'support': 27594}, 'accuracy': 0.422877915461565, 'macro avg': {'precision': 0.4341188622832643, 'recall': 0.4158219973912091, 'f1-score': 0.3980397560197344, 'support': 75374}, 'weighted avg': {'precision': 0.43537751661676405, 'recall': 0.422877915461565, 'f1-score': 0.40355179202836244, 'support': 75374}}
[[16444  2777  5994]
 [12016  4474  6075]
 [13622  3016 10956]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1003532
{'0': {'precision': 0.36972769067546857, 'recall': 0.6383359791590345, 'f1-score': 0.4682452002030396, 'support': 24567}, '1': {'precision': 0.40584415584415584, 'recall': 0.15932361813315205, 'f1-score': 0.22881898892516092, 'support': 23537}, '2': {'precision': 0.4442851722247987, 'recall': 0.38643197653098643, 'f1-score': 0.4133440546000117, 'support': 27270}, 'accuracy': 0.39761721548544593, 'macro avg': {'precision': 0.406619006248141, 'recall': 0.394697191274391, 'f1-score': 0.37013608124273745, 'support': 75374}, 'weighted avg': {'precision': 0.40798034759331325, 'recall': 0.39761721548544593, 'f1-score': 0.373616694678031, 'support': 75374}}
[[15682  2609  6276]
 [12882  3750  6905]
 [13851  2881 10538]]
Evaluating performance on  train set...
200/200 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0261728
{'0': {'precision': 0.40916434790413786, 'recall': 0.6200353645266594, 'f1-score': 0.4929973503487806, 'support': 14704}, '1': {'precision': 0.6185537309132815, 'recall': 0.38817573675646355, 'f1-score': 0.4770051099755609, 'support': 22124}, '2': {'precision': 0.4228430127648199, 'recall': 0.4424166142227816, 'f1-score': 0.4324084199015855, 'support': 14301}, 'accuracy': 0.4700267949695867, 'macro avg': {'precision': 0.4835203638607464, 'recall': 0.4835425718353015, 'f1-score': 0.4674702934086423, 'support': 51129}, 'weighted avg': {'precision': 0.5035950877165126, 'recall': 0.4700267949695867, 'f1-score': 0.4691303742619718, 'support': 51129}}
[[9117 2436 3151]
 [8051 8588 5485]
 [5114 2860 6327]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0294216
{'0': {'precision': 0.44491394867731854, 'recall': 0.6020250148898154, 'f1-score': 0.511680882836822, 'support': 16790}, '1': {'precision': 0.5390882030393233, 'recall': 0.38571908978814035, 'f1-score': 0.4496863565081025, 'support': 17842}, '2': {'precision': 0.46017642546663257, 'recall': 0.43638237255258533, 'f1-score': 0.4479636601225849, 'support': 16497}, 'accuracy': 0.47309745936748226, 'macro avg': {'precision': 0.4813928590610914, 'recall': 0.4747088257435137, 'f1-score': 0.4697769664891698, 'support': 51129}, 'weighted avg': {'precision': 0.4827015472206149, 'recall': 0.47309745936748226, 'f1-score': 0.4694885974044102, 'support': 51129}}
[[10108  2792  3890]
 [ 6405  6882  4555]
 [ 6206  3092  7199]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0368111
{'0': {'precision': 0.450417333390996, 'recall': 0.5946331715672281, 'f1-score': 0.5125744377183917, 'support': 17515}, '1': {'precision': 0.5090274229262477, 'recall': 0.3630786052727494, 'f1-score': 0.4238405899872359, 'support': 16462}, '2': {'precision': 0.46095671421544515, 'recall': 0.4370918843283582, 'f1-score': 0.44870720612880055, 'support': 17152}, 'accuracy': 0.46722994777914684, 'macro avg': {'precision': 0.47346715684422963, 'recall': 0.46493455372277853, 'f1-score': 0.46170741127814274, 'support': 51129}, 'weighted avg': {'precision': 0.472823614637065, 'recall': 0.46722994777914684, 'f1-score': 0.4625795745766335, 'support': 51129}}
[[10415  2746  4354]
 [ 6072  5977  4413]
 [ 6636  3019  7497]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0594809
{'0': {'precision': 0.4234663490172722, 'recall': 0.5735192440654528, 'f1-score': 0.48720082227986883, 'support': 17356}, '1': {'precision': 0.48268238761974946, 'recall': 0.31227651966626935, 'f1-score': 0.3792155159936315, 'support': 16780}, '2': {'precision': 0.4331723027375201, 'recall': 0.4274112870005296, 'f1-score': 0.4302725118483412, 'support': 16993}, 'accuracy': 0.43922235913082597, 'macro avg': {'precision': 0.4464403464581806, 'recall': 0.43773568357741727, 'f1-score': 0.43222961670728055, 'support': 51129}, 'weighted avg': {'precision': 0.4461262562972452, 'recall': 0.43922235913082597, 'f1-score': 0.43284074837570463, 'support': 51129}}
[[9954 2742 4660]
 [6696 5240 4844]
 [6856 2874 7263]]
Evaluating performance on  val set...
53/53 - 1s - 955ms/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0701021
{'0': {'precision': 0.35305975521958244, 'recall': 0.6732564524986271, 'f1-score': 0.46320959667516765, 'support': 3642}, '1': {'precision': 0.607457627118644, 'recall': 0.2953197099538563, 'f1-score': 0.3974273674872478, 'support': 6068}, '2': {'precision': 0.4292887029288703, 'recall': 0.40822281167108754, 'f1-score': 0.41849082256968045, 'support': 3770}, 'accuracy': 0.4290059347181009, 'macro avg': {'precision': 0.4632686950890323, 'recall': 0.45893299137452365, 'f1-score': 0.4263759289106986, 'support': 13480}, 'weighted avg': {'precision': 0.48889576557177244, 'recall': 0.4290059347181009, 'f1-score': 0.4210911734489076, 'support': 13480}}
[[2452  485  705]
 [2935 1792 1341]
 [1558  673 1539]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.062732
{'0': {'precision': 0.38602375960866525, 'recall': 0.6563688212927756, 'f1-score': 0.4861392237965326, 'support': 4208}, '1': {'precision': 0.5156847742922723, 'recall': 0.2704112337011033, 'f1-score': 0.3547835241479142, 'support': 4985}, '2': {'precision': 0.46160064672594986, 'recall': 0.3995801259622113, 'f1-score': 0.4283570892723181, 'support': 4287}, 'accuracy': 0.431973293768546, 'macro avg': {'precision': 0.45443639354229587, 'recall': 0.4421200603186968, 'f1-score': 0.42309327907225497, 'support': 13480}, 'weighted avg': {'precision': 0.4580087947176845, 'recall': 0.431973293768546, 'f1-score': 0.4191866886738568, 'support': 13480}}
[[2762  577  869]
 [2508 1348 1129]
 [1885  689 1713]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0681728
{'0': {'precision': 0.39484860939854777, 'recall': 0.6517412935323383, 'f1-score': 0.49176691408582884, 'support': 4422}, '1': {'precision': 0.48132427843803055, 'recall': 0.24107142857142858, 'f1-score': 0.3212464589235128, 'support': 4704}, '2': {'precision': 0.44915032679738565, 'recall': 0.3945796968305007, 'f1-score': 0.42010025675510454, 'support': 4354}, 'accuracy': 0.42537091988130565, 'macro avg': {'precision': 0.44177440487798797, 'recall': 0.42913080631142253, 'f1-score': 0.4110378765881488, 'support': 13480}, 'weighted avg': {'precision': 0.44256457562379015, 'recall': 0.42537091988130565, 'f1-score': 0.4091137355174677, 'support': 13480}}
[[2882  565  975]
 [2438 1134 1132]
 [1979  657 1718]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.082836
{'0': {'precision': 0.3820799138974842, 'recall': 0.6492912665752172, 'f1-score': 0.4810705513678327, 'support': 4374}, '1': {'precision': 0.46019783325482805, 'recall': 0.20165118679050567, 'f1-score': 0.28042479908151546, 'support': 4845}, '2': {'precision': 0.42329255861365955, 'recall': 0.38981459751232106, 'f1-score': 0.4058643860720831, 'support': 4261}, 'accuracy': 0.40637982195845695, 'macro avg': {'precision': 0.4218567685886572, 'recall': 0.4135856836260146, 'f1-score': 0.3891199121738104, 'support': 13480}, 'weighted avg': {'precision': 0.4231843944925847, 'recall': 0.40637982195845695, 'f1-score': 0.3851816685672098, 'support': 13480}}
[[2840  544  990]
 [2595  977 1273]
 [1998  602 1661]]
training model: results/LILAK/W9/deepOF_L2/seq2seq
Epoch 1/50
200/200 - 11s - loss: 13.0361 - accuracy10: 0.4245 - accuracy20: 0.4121 - accuracy30: 0.3971 - accuracy50: 0.3777 - val_loss: 12.9635 - val_accuracy10: 0.4136 - val_accuracy20: 0.4129 - val_accuracy30: 0.4034 - val_accuracy50: 0.3758 - 11s/epoch - 55ms/step
Epoch 2/50
200/200 - 6s - loss: 12.7741 - accuracy10: 0.4754 - accuracy20: 0.4519 - accuracy30: 0.4280 - accuracy50: 0.3980 - val_loss: 12.6313 - val_accuracy10: 0.4950 - val_accuracy20: 0.4738 - val_accuracy30: 0.4516 - val_accuracy50: 0.4132 - 6s/epoch - 28ms/step
Epoch 3/50
200/200 - 6s - loss: 12.5569 - accuracy10: 0.4920 - accuracy20: 0.4718 - accuracy30: 0.4499 - accuracy50: 0.4134 - val_loss: 12.6183 - val_accuracy10: 0.4734 - val_accuracy20: 0.4580 - val_accuracy30: 0.4358 - val_accuracy50: 0.4016 - 6s/epoch - 28ms/step
Epoch 4/50
200/200 - 5s - loss: 12.4116 - accuracy10: 0.5035 - accuracy20: 0.4822 - accuracy30: 0.4598 - accuracy50: 0.4247 - val_loss: 12.5185 - val_accuracy10: 0.4783 - val_accuracy20: 0.4666 - val_accuracy30: 0.4461 - val_accuracy50: 0.4128 - 5s/epoch - 27ms/step
Epoch 5/50
200/200 - 6s - loss: 12.2956 - accuracy10: 0.5128 - accuracy20: 0.4934 - accuracy30: 0.4707 - accuracy50: 0.4327 - val_loss: 12.4032 - val_accuracy10: 0.5003 - val_accuracy20: 0.4818 - val_accuracy30: 0.4602 - val_accuracy50: 0.4226 - 6s/epoch - 28ms/step
Epoch 6/50
200/200 - 6s - loss: 12.1820 - accuracy10: 0.5192 - accuracy20: 0.4985 - accuracy30: 0.4755 - accuracy50: 0.4361 - val_loss: 12.3547 - val_accuracy10: 0.4970 - val_accuracy20: 0.4849 - val_accuracy30: 0.4622 - val_accuracy50: 0.4256 - 6s/epoch - 28ms/step
Epoch 7/50
200/200 - 6s - loss: 12.0839 - accuracy10: 0.5256 - accuracy20: 0.5056 - accuracy30: 0.4840 - accuracy50: 0.4453 - val_loss: 12.3203 - val_accuracy10: 0.4940 - val_accuracy20: 0.4829 - val_accuracy30: 0.4651 - val_accuracy50: 0.4335 - 6s/epoch - 28ms/step
Epoch 8/50
200/200 - 6s - loss: 12.0023 - accuracy10: 0.5322 - accuracy20: 0.5133 - accuracy30: 0.4899 - accuracy50: 0.4525 - val_loss: 12.2867 - val_accuracy10: 0.5080 - val_accuracy20: 0.4933 - val_accuracy30: 0.4683 - val_accuracy50: 0.4332 - 6s/epoch - 29ms/step
Epoch 9/50
200/200 - 6s - loss: 11.9162 - accuracy10: 0.5360 - accuracy20: 0.5171 - accuracy30: 0.4950 - accuracy50: 0.4571 - val_loss: 12.2507 - val_accuracy10: 0.5105 - val_accuracy20: 0.4937 - val_accuracy30: 0.4703 - val_accuracy50: 0.4378 - 6s/epoch - 29ms/step
Epoch 10/50
200/200 - 6s - loss: 11.8535 - accuracy10: 0.5396 - accuracy20: 0.5231 - accuracy30: 0.5028 - accuracy50: 0.4627 - val_loss: 12.2802 - val_accuracy10: 0.5009 - val_accuracy20: 0.4876 - val_accuracy30: 0.4679 - val_accuracy50: 0.4329 - 6s/epoch - 29ms/step
Epoch 11/50
200/200 - 6s - loss: 11.7820 - accuracy10: 0.5424 - accuracy20: 0.5290 - accuracy30: 0.5083 - accuracy50: 0.4677 - val_loss: 12.3855 - val_accuracy10: 0.4877 - val_accuracy20: 0.4783 - val_accuracy30: 0.4599 - val_accuracy50: 0.4292 - 6s/epoch - 28ms/step
Epoch 12/50
200/200 - 6s - loss: 11.7201 - accuracy10: 0.5465 - accuracy20: 0.5350 - accuracy30: 0.5150 - accuracy50: 0.4744 - val_loss: 12.3090 - val_accuracy10: 0.4995 - val_accuracy20: 0.4813 - val_accuracy30: 0.4652 - val_accuracy50: 0.4364 - 6s/epoch - 28ms/step
Epoch 13/50
200/200 - 6s - loss: 11.6539 - accuracy10: 0.5500 - accuracy20: 0.5393 - accuracy30: 0.5199 - accuracy50: 0.4794 - val_loss: 12.3342 - val_accuracy10: 0.4957 - val_accuracy20: 0.4878 - val_accuracy30: 0.4668 - val_accuracy50: 0.4330 - 6s/epoch - 29ms/step
Epoch 14/50
200/200 - 6s - loss: 11.5587 - accuracy10: 0.5542 - accuracy20: 0.5453 - accuracy30: 0.5272 - accuracy50: 0.4857 - val_loss: 12.2686 - val_accuracy10: 0.5046 - val_accuracy20: 0.4901 - val_accuracy30: 0.4735 - val_accuracy50: 0.4352 - 6s/epoch - 28ms/step
Epoch 15/50
200/200 - 6s - loss: 11.4935 - accuracy10: 0.5606 - accuracy20: 0.5522 - accuracy30: 0.5337 - accuracy50: 0.4905 - val_loss: 12.3167 - val_accuracy10: 0.5002 - val_accuracy20: 0.4858 - val_accuracy30: 0.4691 - val_accuracy50: 0.4335 - 6s/epoch - 29ms/step
Epoch 16/50
200/200 - 6s - loss: 11.4309 - accuracy10: 0.5599 - accuracy20: 0.5563 - accuracy30: 0.5395 - accuracy50: 0.4960 - val_loss: 12.2696 - val_accuracy10: 0.5116 - val_accuracy20: 0.4871 - val_accuracy30: 0.4677 - val_accuracy50: 0.4358 - 6s/epoch - 28ms/step
Epoch 17/50
200/200 - 6s - loss: 11.3591 - accuracy10: 0.5630 - accuracy20: 0.5614 - accuracy30: 0.5451 - accuracy50: 0.5031 - val_loss: 12.4277 - val_accuracy10: 0.4936 - val_accuracy20: 0.4797 - val_accuracy30: 0.4611 - val_accuracy50: 0.4289 - 6s/epoch - 28ms/step
Epoch 18/50
200/200 - 6s - loss: 11.2824 - accuracy10: 0.5613 - accuracy20: 0.5647 - accuracy30: 0.5492 - accuracy50: 0.5084 - val_loss: 12.4107 - val_accuracy10: 0.4985 - val_accuracy20: 0.4835 - val_accuracy30: 0.4639 - val_accuracy50: 0.4346 - 6s/epoch - 28ms/step
Epoch 19/50
200/200 - 6s - loss: 11.2245 - accuracy10: 0.5657 - accuracy20: 0.5683 - accuracy30: 0.5544 - accuracy50: 0.5126 - val_loss: 12.4261 - val_accuracy10: 0.5068 - val_accuracy20: 0.4861 - val_accuracy30: 0.4646 - val_accuracy50: 0.4327 - 6s/epoch - 28ms/step
testing model: results/LILAK/W9/deepOF_L2/seq2seq
Evaluating performance on  test set...
295/295 - 4s - 4s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0346922
{'0': {'precision': 0.412949689166695, 'recall': 0.5686751497005988, 'f1-score': 0.47846023655363784, 'support': 21376}, '1': {'precision': 0.641475982048867, 'recall': 0.3754093576732272, 'f1-score': 0.47363469012067905, 'support': 30841}, '2': {'precision': 0.445380863577679, 'recall': 0.5363883729970198, 'f1-score': 0.48666653604247895, 'support': 23153}, 'accuracy': 0.47967361018973065, 'macro avg': {'precision': 0.499935511597747, 'recall': 0.49349096012361526, 'f1-score': 0.4795871542389319, 'support': 75370}, 'weighted avg': {'precision': 0.5164239943267929, 'recall': 0.47967361018973065, 'f1-score': 0.4790065517258052, 'support': 75370}}
[[12156  3073  6147]
 [ 9945 11578  9318]
 [ 7336  3398 12419]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0384752
{'0': {'precision': 0.42571752878222796, 'recall': 0.5436736384344585, 'f1-score': 0.47751909785376506, 'support': 24145}, '1': {'precision': 0.531058282208589, 'recall': 0.337297560579616, 'f1-score': 0.4125605063919573, 'support': 24637}, '2': {'precision': 0.4717693079932149, 'recall': 0.5125620580713104, 'f1-score': 0.49132041460117165, 'support': 26588}, 'accuracy': 0.4652381584184689, 'macro avg': {'precision': 0.47618170632801055, 'recall': 0.4645110856951283, 'f1-score': 0.46046667294896465, 'support': 75370}, 'weighted avg': {'precision': 0.47639690848007826, 'recall': 0.4652381584184689, 'f1-score': 0.4611540267622895, 'support': 75370}}
[[13127  3576  7442]
 [ 8510  8310  7817]
 [ 9198  3762 13628]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0505366
{'0': {'precision': 0.4217197354253192, 'recall': 0.5436877801134335, 'f1-score': 0.4749991337191172, 'support': 25213}, '1': {'precision': 0.4840088542859324, 'recall': 0.2810104143585198, 'f1-score': 0.35557673975214493, 'support': 22565}, '2': {'precision': 0.47080365542265823, 'recall': 0.5078645984343287, 'f1-score': 0.48863240114373385, 'support': 27592}, 'accuracy': 0.4519304763168369, 'macro avg': {'precision': 0.45884408171130325, 'recall': 0.4441875976354274, 'f1-score': 0.43973609153833193, 'support': 75370}, 'weighted avg': {'precision': 0.45833745451323626, 'recall': 0.4519304763168369, 'f1-score': 0.4442362677899052, 'support': 75370}}
[[13708  3424  8081]
 [ 8554  6341  7670]
 [10243  3336 14013]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0896968
{'0': {'precision': 0.3769093723531645, 'recall': 0.5253409322206392, 'f1-score': 0.43891572001904633, 'support': 24565}, '1': {'precision': 0.4319869588842601, 'recall': 0.20265964226536942, 'f1-score': 0.27588999103502126, 'support': 23537}, '2': {'precision': 0.4367376782212769, 'recall': 0.48192019950124687, 'f1-score': 0.45821782868699545, 'support': 27268}, 'accuracy': 0.40886294281544383, 'macro avg': {'precision': 0.4152113364862338, 'recall': 0.4033069246624185, 'f1-score': 0.39100784658035437, 'support': 75370}, 'weighted avg': {'precision': 0.41575452823208303, 'recall': 0.40886294281544383, 'f1-score': 0.39498833931134614, 'support': 75370}}
[[12905  3421  8239]
 [10058  4770  8709]
 [11276  2851 13141]]
Evaluating performance on  train set...
200/200 - 2s - 2s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9805793
{'0': {'precision': 0.4630768435739755, 'recall': 0.611338518215309, 'f1-score': 0.5269781528418949, 'support': 14658}, '1': {'precision': 0.7038714059316278, 'recall': 0.4214069488998328, 'f1-score': 0.5271874293465972, 'support': 22133}, '2': {'precision': 0.4511688171462506, 'recall': 0.5830193944467699, 'f1-score': 0.5086891682137749, 'support': 14334}, 'accuracy': 0.5211735941320293, 'macro avg': {'precision': 0.539372355550618, 'recall': 0.5385882871873039, 'f1-score': 0.5209515834674223, 'support': 51125}, 'weighted avg': {'precision': 0.56398278778614, 'recall': 0.5211735941320293, 'f1-score': 0.5219410401029042, 'support': 51125}}
[[8961 2092 3605]
 [6245 9327 6561]
 [4145 1832 8357]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.98158514
{'0': {'precision': 0.49181222707423583, 'recall': 0.5885741433576815, 'f1-score': 0.5358600740720716, 'support': 16839}, '1': {'precision': 0.6180061037639878, 'recall': 0.4088156123822342, 'f1-score': 0.4921020656136088, 'support': 17832}, '2': {'precision': 0.483287271210304, 'recall': 0.5632672906284186, 'f1-score': 0.5202211557351745, 'support': 16454}, 'accuracy': 0.5177310513447433, 'macro avg': {'precision': 0.5310352006828426, 'recall': 0.5202190154561115, 'f1-score': 0.5160610984736183, 'support': 51125}, 'weighted avg': {'precision': 0.5330840038047302, 'recall': 0.5177310513447433, 'f1-score': 0.5155644150178592, 'support': 51125}}
[[9911 2401 4527]
 [5160 7290 5382]
 [5081 2105 9268]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0014824
{'0': {'precision': 0.4827667946712179, 'recall': 0.5814205778234556, 'f1-score': 0.527520915896081, 'support': 17514}, '1': {'precision': 0.5799960544486092, 'recall': 0.3559752996730839, 'f1-score': 0.4411764705882353, 'support': 16518}, '2': {'precision': 0.4733085352367548, 'recall': 0.5508687766922132, 'f1-score': 0.5091518641684917, 'support': 17093}, 'accuracy': 0.49836674816625914, 'macro avg': {'precision': 0.5120237947855273, 'recall': 0.49608821806291753, 'f1-score': 0.49261641688426927, 'support': 51125}, 'weighted avg': {'precision': 0.5110183914338521, 'recall': 0.49836674816625914, 'f1-score': 0.4934823878026887, 'support': 51125}}
[[10183  2328  5003]
 [ 5163  5880  5475]
 [ 5747  1930  9416]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0413086
{'0': {'precision': 0.44402867318876516, 'recall': 0.5666858457997699, 'f1-score': 0.49791461287631766, 'support': 17380}, '1': {'precision': 0.533106960950764, 'recall': 0.2806912991656734, 'f1-score': 0.36775326956861215, 'support': 16780}, '2': {'precision': 0.44164304540255606, 'recall': 0.5234895372826407, 'f1-score': 0.4790958623293952, 'support': 16965}, 'accuracy': 0.4584841075794621, 'macro avg': {'precision': 0.47292622651402844, 'recall': 0.45695556074936133, 'f1-score': 0.44825458159144166, 'support': 51125}, 'weighted avg': {'precision': 0.4724738857707369, 'recall': 0.4584841075794621, 'f1-score': 0.4489489905050348, 'support': 51125}}
[[9849 2252 5279]
 [6121 4710 5949]
 [6211 1873 8881]]
Evaluating performance on  val set...
53/53 - 1s - 678ms/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0025196
{'0': {'precision': 0.42907144327774344, 'recall': 0.5690879300928454, 'f1-score': 0.48925930273506274, 'support': 3662}, '1': {'precision': 0.697148728487028, 'recall': 0.44815059445178335, 'f1-score': 0.5455824706000603, 'support': 6056}, '2': {'precision': 0.43995771670190276, 'recall': 0.5531632110579479, 'f1-score': 0.4901083372585963, 'support': 3762}, 'accuracy': 0.5103115727002967, 'macro avg': {'precision': 0.522059296155558, 'recall': 0.5234672452008589, 'f1-score': 0.5083167035312398, 'support': 13480}, 'weighted avg': {'precision': 0.5525454937116541, 'recall': 0.5103115727002967, 'f1-score': 0.5147998941644365, 'support': 13480}}
[[2084  629  949]
 [1642 2714 1700]
 [1131  550 2081]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0134054
{'0': {'precision': 0.45126282557221786, 'recall': 0.5397687042718905, 'f1-score': 0.49156367544331003, 'support': 4237}, '1': {'precision': 0.6112078977932637, 'recall': 0.4238824003221909, 'f1-score': 0.5005945303210463, 'support': 4966}, '2': {'precision': 0.4553140096618358, 'recall': 0.5288753799392097, 'f1-score': 0.4893455922120065, 'support': 4277}, 'accuracy': 0.493620178041543, 'macro avg': {'precision': 0.5059282443424391, 'recall': 0.4975088281777637, 'f1-score': 0.49383459932545426, 'support': 13480}, 'weighted avg': {'precision': 0.5114715898898001, 'recall': 0.493620178041543, 'f1-score': 0.49418685670017604, 'support': 13480}}
[[2287  717 1233]
 [1388 2105 1473]
 [1393  622 2262]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0299838
{'0': {'precision': 0.44160177975528364, 'recall': 0.5380618929297493, 'f1-score': 0.48508298543936457, 'support': 4427}, '1': {'precision': 0.5829918032786885, 'recall': 0.36288265306122447, 'f1-score': 0.44732704402515716, 'support': 4704}, '2': {'precision': 0.4398991857309035, 'recall': 0.5217291331340538, 'f1-score': 0.47733249184811194, 'support': 4349}, 'accuracy': 0.4716617210682493, 'macro avg': {'precision': 0.4881642562549586, 'recall': 0.4742245597083425, 'f1-score': 0.46991417377087785, 'support': 13480}, 'weighted avg': {'precision': 0.49039214245870105, 'recall': 0.4716617210682493, 'f1-score': 0.4694071067271398, 'support': 13480}}
[[2382  693 1352]
 [1460 1707 1537]
 [1552  528 2269]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0628594
{'0': {'precision': 0.4084630180101416, 'recall': 0.5327251995438996, 'f1-score': 0.4623911322248614, 'support': 4385}, '1': {'precision': 0.5525997581620314, 'recall': 0.28556550718600293, 'f1-score': 0.37654490524581163, 'support': 4801}, '2': {'precision': 0.4100378787878788, 'recall': 0.5041918956683745, 'f1-score': 0.45226655525381243, 'support': 4294}, 'accuracy': 0.4356083086053412, 'macro avg': {'precision': 0.4570335516533506, 'recall': 0.440827534132759, 'f1-score': 0.43040086424149515, 'support': 13480}, 'weighted avg': {'precision': 0.4603000314855738, 'recall': 0.4356083086053412, 'f1-score': 0.42859123094592205, 'support': 13480}}
[[2336  619 1430]
 [1745 1371 1685]
 [1638  491 2165]]
training model: results/LILAK/W9/deepVOL_L2/seq2seq
Epoch 1/50
200/200 - 11s - loss: 13.1587 - accuracy10: 0.3768 - accuracy20: 0.3839 - accuracy30: 0.3795 - accuracy50: 0.3701 - val_loss: 13.1168 - val_accuracy10: 0.3481 - val_accuracy20: 0.3741 - val_accuracy30: 0.3861 - val_accuracy50: 0.3804 - 11s/epoch - 54ms/step
Epoch 2/50
200/200 - 6s - loss: 12.9417 - accuracy10: 0.4028 - accuracy20: 0.4021 - accuracy30: 0.3994 - accuracy50: 0.3890 - val_loss: 12.8429 - val_accuracy10: 0.4302 - val_accuracy20: 0.4200 - val_accuracy30: 0.4190 - val_accuracy50: 0.4006 - 6s/epoch - 29ms/step
Epoch 3/50
200/200 - 6s - loss: 12.8312 - accuracy10: 0.4169 - accuracy20: 0.4183 - accuracy30: 0.4132 - accuracy50: 0.4021 - val_loss: 12.7481 - val_accuracy10: 0.4319 - val_accuracy20: 0.4308 - val_accuracy30: 0.4297 - val_accuracy50: 0.4084 - 6s/epoch - 28ms/step
Epoch 4/50
200/200 - 6s - loss: 12.7302 - accuracy10: 0.4295 - accuracy20: 0.4290 - accuracy30: 0.4249 - accuracy50: 0.4100 - val_loss: 12.6081 - val_accuracy10: 0.4562 - val_accuracy20: 0.4515 - val_accuracy30: 0.4473 - val_accuracy50: 0.4246 - 6s/epoch - 28ms/step
Epoch 5/50
200/200 - 6s - loss: 12.6081 - accuracy10: 0.4426 - accuracy20: 0.4471 - accuracy30: 0.4393 - accuracy50: 0.4180 - val_loss: 12.6721 - val_accuracy10: 0.4599 - val_accuracy20: 0.4504 - val_accuracy30: 0.4403 - val_accuracy50: 0.4191 - 6s/epoch - 28ms/step
Epoch 6/50
200/200 - 6s - loss: 12.5264 - accuracy10: 0.4482 - accuracy20: 0.4534 - accuracy30: 0.4462 - accuracy50: 0.4257 - val_loss: 12.5779 - val_accuracy10: 0.4563 - val_accuracy20: 0.4552 - val_accuracy30: 0.4485 - val_accuracy50: 0.4278 - 6s/epoch - 29ms/step
Epoch 7/50
200/200 - 6s - loss: 12.4143 - accuracy10: 0.4614 - accuracy20: 0.4687 - accuracy30: 0.4600 - accuracy50: 0.4350 - val_loss: 12.5455 - val_accuracy10: 0.4651 - val_accuracy20: 0.4602 - val_accuracy30: 0.4522 - val_accuracy50: 0.4302 - 6s/epoch - 30ms/step
Epoch 8/50
200/200 - 6s - loss: 12.3359 - accuracy10: 0.4704 - accuracy20: 0.4745 - accuracy30: 0.4678 - accuracy50: 0.4454 - val_loss: 12.5130 - val_accuracy10: 0.4676 - val_accuracy20: 0.4619 - val_accuracy30: 0.4513 - val_accuracy50: 0.4317 - 6s/epoch - 29ms/step
Epoch 9/50
200/200 - 6s - loss: 12.2685 - accuracy10: 0.4801 - accuracy20: 0.4818 - accuracy30: 0.4725 - accuracy50: 0.4462 - val_loss: 12.4889 - val_accuracy10: 0.4706 - val_accuracy20: 0.4565 - val_accuracy30: 0.4458 - val_accuracy50: 0.4281 - 6s/epoch - 29ms/step
Epoch 10/50
200/200 - 6s - loss: 12.1670 - accuracy10: 0.4870 - accuracy20: 0.4907 - accuracy30: 0.4815 - accuracy50: 0.4534 - val_loss: 12.4500 - val_accuracy10: 0.4780 - val_accuracy20: 0.4657 - val_accuracy30: 0.4555 - val_accuracy50: 0.4298 - 6s/epoch - 29ms/step
Epoch 11/50
200/200 - 6s - loss: 12.0964 - accuracy10: 0.4951 - accuracy20: 0.4957 - accuracy30: 0.4859 - accuracy50: 0.4588 - val_loss: 12.4936 - val_accuracy10: 0.4705 - val_accuracy20: 0.4585 - val_accuracy30: 0.4467 - val_accuracy50: 0.4254 - 6s/epoch - 28ms/step
Epoch 12/50
200/200 - 6s - loss: 12.0399 - accuracy10: 0.4970 - accuracy20: 0.5002 - accuracy30: 0.4894 - accuracy50: 0.4627 - val_loss: 12.4908 - val_accuracy10: 0.4680 - val_accuracy20: 0.4603 - val_accuracy30: 0.4538 - val_accuracy50: 0.4294 - 6s/epoch - 28ms/step
Epoch 13/50
200/200 - 6s - loss: 11.9692 - accuracy10: 0.5027 - accuracy20: 0.5050 - accuracy30: 0.4955 - accuracy50: 0.4663 - val_loss: 12.4644 - val_accuracy10: 0.4744 - val_accuracy20: 0.4665 - val_accuracy30: 0.4546 - val_accuracy50: 0.4309 - 6s/epoch - 28ms/step
Epoch 14/50
200/200 - 6s - loss: 11.9128 - accuracy10: 0.5093 - accuracy20: 0.5117 - accuracy30: 0.5025 - accuracy50: 0.4710 - val_loss: 12.5346 - val_accuracy10: 0.4711 - val_accuracy20: 0.4594 - val_accuracy30: 0.4491 - val_accuracy50: 0.4248 - 6s/epoch - 28ms/step
Epoch 15/50
200/200 - 6s - loss: 11.8787 - accuracy10: 0.5115 - accuracy20: 0.5118 - accuracy30: 0.5027 - accuracy50: 0.4712 - val_loss: 12.5465 - val_accuracy10: 0.4685 - val_accuracy20: 0.4522 - val_accuracy30: 0.4350 - val_accuracy50: 0.4116 - 6s/epoch - 28ms/step
Epoch 16/50
200/200 - 6s - loss: 11.8187 - accuracy10: 0.5172 - accuracy20: 0.5181 - accuracy30: 0.5085 - accuracy50: 0.4756 - val_loss: 12.6757 - val_accuracy10: 0.4539 - val_accuracy20: 0.4432 - val_accuracy30: 0.4275 - val_accuracy50: 0.4035 - 6s/epoch - 28ms/step
Epoch 17/50
200/200 - 6s - loss: 11.7731 - accuracy10: 0.5175 - accuracy20: 0.5179 - accuracy30: 0.5095 - accuracy50: 0.4762 - val_loss: 12.6380 - val_accuracy10: 0.4659 - val_accuracy20: 0.4541 - val_accuracy30: 0.4368 - val_accuracy50: 0.4046 - 6s/epoch - 28ms/step
Epoch 18/50
200/200 - 6s - loss: 11.7369 - accuracy10: 0.5199 - accuracy20: 0.5243 - accuracy30: 0.5152 - accuracy50: 0.4827 - val_loss: 12.5589 - val_accuracy10: 0.4827 - val_accuracy20: 0.4636 - val_accuracy30: 0.4427 - val_accuracy50: 0.4081 - 6s/epoch - 28ms/step
Epoch 19/50
200/200 - 6s - loss: 11.6903 - accuracy10: 0.5234 - accuracy20: 0.5268 - accuracy30: 0.5172 - accuracy50: 0.4862 - val_loss: 12.7302 - val_accuracy10: 0.4448 - val_accuracy20: 0.4389 - val_accuracy30: 0.4243 - val_accuracy50: 0.4000 - 6s/epoch - 28ms/step
Epoch 20/50
200/200 - 6s - loss: 11.6517 - accuracy10: 0.5279 - accuracy20: 0.5328 - accuracy30: 0.5226 - accuracy50: 0.4896 - val_loss: 12.6765 - val_accuracy10: 0.4628 - val_accuracy20: 0.4447 - val_accuracy30: 0.4316 - val_accuracy50: 0.4036 - 6s/epoch - 28ms/step
testing model: results/LILAK/W9/deepVOL_L2/seq2seq
Evaluating performance on  test set...
295/295 - 3s - 3s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0541811
{'0': {'precision': 0.3494026902455084, 'recall': 0.6950785928143712, 'f1-score': 0.46503912363067285, 'support': 21376}, '1': {'precision': 0.5810186204164283, 'recall': 0.42794151022922544, 'f1-score': 0.4928678117998507, 'support': 30843}, '2': {'precision': 0.4648179216421593, 'recall': 0.2034117901101274, 'f1-score': 0.282984859408796, 'support': 23155}, 'accuracy': 0.4347255021625494, 'macro avg': {'precision': 0.4650797441013654, 'recall': 0.44214396438457465, 'f1-score': 0.41363059827977317, 'support': 75374}, 'weighted avg': {'precision': 0.47963552673091625, 'recall': 0.4347255021625494, 'f1-score': 0.42049927887179567, 'support': 75374}}
[[14858  4428  2090]
 [14311 13199  3333]
 [13355  5090  4710]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0576262
{'0': {'precision': 0.3813619415787909, 'recall': 0.690409143614378, 'f1-score': 0.49132837250423633, 'support': 24148}, '1': {'precision': 0.4938177304625961, 'recall': 0.4198563136745545, 'f1-score': 0.4538434538434538, 'support': 24637}, '2': {'precision': 0.4887021475256769, 'recall': 0.1968483207341382, 'f1-score': 0.28065095578969945, 'support': 26589}, 'accuracy': 0.42786637301987424, 'macro avg': {'precision': 0.4546272731890213, 'recall': 0.43570459267435696, 'f1-score': 0.4086075940457965, 'support': 75374}, 'weighted avg': {'precision': 0.45598504777790533, 'recall': 0.42786637301987424, 'f1-score': 0.40475717057693356, 'support': 75374}}
[[16672  4931  2545]
 [11362 10344  2931]
 [15683  5672  5234]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0651602
{'0': {'precision': 0.389621198488393, 'recall': 0.6869323815189371, 'f1-score': 0.497222660791434, 'support': 25215}, '1': {'precision': 0.44643414888079125, 'recall': 0.3800576113450033, 'f1-score': 0.41058049072411723, 'support': 22565}, '2': {'precision': 0.4819781346088145, 'recall': 0.2045009784735812, 'f1-score': 0.2871609587298356, 'support': 27594}, 'accuracy': 0.4184466792262584, 'macro avg': {'precision': 0.4393444939926663, 'recall': 0.42383032377917385, 'f1-score': 0.3983213700817956, 'support': 75374}, 'weighted avg': {'precision': 0.4404408646983776, 'recall': 0.4184466792262584, 'f1-score': 0.3943818513046514, 'support': 75374}}
[[17321  4933  2961]
 [10885  8576  3104]
 [16250  5701  5643]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0925181
{'0': {'precision': 0.36422829047903793, 'recall': 0.6694346074001709, 'f1-score': 0.47177280550774525, 'support': 24567}, '1': {'precision': 0.41722082091263474, 'recall': 0.3092152780728215, 'f1-score': 0.3551889900197652, 'support': 23537}, '2': {'precision': 0.4457227831259294, 'recall': 0.20883755042170885, 'f1-score': 0.2844158114215797, 'support': 27270}, 'accuracy': 0.39030700241462574, 'macro avg': {'precision': 0.409057298172534, 'recall': 0.3958291452982337, 'f1-score': 0.37045920231636337, 'support': 75374}, 'weighted avg': {'precision': 0.4102606093595047, 'recall': 0.39030700241462574, 'f1-score': 0.3675822557973634, 'support': 75374}}
[[16446  4757  3364]
 [12541  7278  3718]
 [16166  5409  5695]]
Evaluating performance on  train set...
200/200 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0021602
{'0': {'precision': 0.39393453145057766, 'recall': 0.6678454842219804, 'f1-score': 0.49555914412595875, 'support': 14704}, '1': {'precision': 0.6144946740736965, 'recall': 0.5449737841258362, 'f1-score': 0.5776500179662235, 'support': 22124}, '2': {'precision': 0.4440729483282675, 'recall': 0.20432137612754353, 'f1-score': 0.2798716536564341, 'support': 14301}, 'accuracy': 0.4850280662637642, 'macro avg': {'precision': 0.48416738461751385, 'recall': 0.47238021482512, 'f1-score': 0.4510269385828721, 'support': 51129}, 'weighted avg': {'precision': 0.5033969127833189, 'recall': 0.4850280662637642, 'f1-score': 0.470751924967308, 'support': 51129}}
[[ 9820  3574  1310]
 [ 7719 12057  2348]
 [ 7389  3990  2922]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0135325
{'0': {'precision': 0.43081908331381275, 'recall': 0.6572364502680167, 'f1-score': 0.520469767003113, 'support': 16790}, '1': {'precision': 0.5368970580238186, 'recall': 0.5533572469454097, 'f1-score': 0.5450028980707128, 'support': 17842}, '2': {'precision': 0.4825989334830199, 'recall': 0.2084621446323574, 'f1-score': 0.2911569233374254, 'support': 16497}, 'accuracy': 0.47618768213733886, 'macro avg': {'precision': 0.4834383582735504, 'recall': 0.47301861394859457, 'f1-score': 0.45220986280375036, 'support': 51129}, 'weighted avg': {'precision': 0.4845431032050161, 'recall': 0.47618768213733886, 'f1-score': 0.45504204775484425, 'support': 51129}}
[[11035  4090  1665]
 [ 5947  9873  2022]
 [ 8632  4426  3439]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0253147
{'0': {'precision': 0.4378384606521489, 'recall': 0.650870682272338, 'f1-score': 0.5235121234386481, 'support': 17515}, '1': {'precision': 0.5010217784784259, 'recall': 0.5212610861377719, 'f1-score': 0.5109410819018131, 'support': 16462}, '2': {'precision': 0.4873822975517891, 'recall': 0.22632929104477612, 'f1-score': 0.3091133495242266, 'support': 17152}, 'accuracy': 0.4667214301081578, 'macro avg': {'precision': 0.47541417889412124, 'recall': 0.466153686484962, 'f1-score': 0.4478555182882293, 'support': 51129}, 'weighted avg': {'precision': 0.4748018213390155, 'recall': 0.4667214301081578, 'f1-score': 0.4475412995234622, 'support': 51129}}
[[11400  4209  1906]
 [ 5704  8581  2177]
 [ 8933  4337  3882]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0471859
{'0': {'precision': 0.4159067690794203, 'recall': 0.6333256510716755, 'f1-score': 0.5020897567660157, 'support': 17356}, '1': {'precision': 0.47762326169405817, 'recall': 0.4502979737783075, 'f1-score': 0.46355828220858897, 'support': 16780}, '2': {'precision': 0.46306306306306305, 'recall': 0.24198199258518213, 'f1-score': 0.3178603177057164, 'support': 16993}, 'accuracy': 0.4431927086389329, 'macro avg': {'precision': 0.45219769794551384, 'recall': 0.44186853914505503, 'f1-score': 0.42783611889344036, 'support': 51129}, 'weighted avg': {'precision': 0.45183412243539567, 'recall': 0.4431927086389329, 'f1-score': 0.4282144804839588, 'support': 51129}}
[[10992  4208  2156]
 [ 6612  7556  2612]
 [ 8825  4056  4112]]
Evaluating performance on  val set...
53/53 - 1s - 621ms/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0141473
{'0': {'precision': 0.36429953848444246, 'recall': 0.671883580450302, 'f1-score': 0.4724394246548895, 'support': 3642}, '1': {'precision': 0.6352104555064386, 'recall': 0.5446605141727093, 'f1-score': 0.5864608286753616, 'support': 6068}, '2': {'precision': 0.4307692307692308, 'recall': 0.17824933687002653, 'f1-score': 0.25215759849906194, 'support': 3770}, 'accuracy': 0.47655786350148366, 'macro avg': {'precision': 0.476759741586704, 'recall': 0.4649311438310127, 'f1-score': 0.4370192839431044, 'support': 13480}, 'weighted avg': {'precision': 0.504839463143428, 'recall': 0.47655786350148366, 'f1-score': 0.4621589643424826, 'support': 13480}}
[[2447  897  298]
 [2173 3305  590]
 [2097 1001  672]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0284384
{'0': {'precision': 0.4008097165991903, 'recall': 0.658745247148289, 'f1-score': 0.49838187702265374, 'support': 4208}, '1': {'precision': 0.5595556469862168, 'recall': 0.5456369107321966, 'f1-score': 0.5525086329473898, 'support': 4985}, '2': {'precision': 0.44216089254257196, 'recall': 0.17564730580825752, 'f1-score': 0.25141903171953256, 'support': 4287}, 'accuracy': 0.46327893175074186, 'macro avg': {'precision': 0.46750875204265974, 'recall': 0.46000982122958095, 'f1-score': 0.4341031805631921, 'support': 13480}, 'weighted avg': {'precision': 0.4726658704751995, 'recall': 0.46327893175074186, 'f1-score': 0.43985755658276715, 'support': 13480}}
[[2772 1040  396]
 [1711 2720  554]
 [2433 1101  753]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0405256
{'0': {'precision': 0.4137293916998295, 'recall': 0.6582994120307553, 'f1-score': 0.5081165997556293, 'support': 4422}, '1': {'precision': 0.5262110152621101, 'recall': 0.5057397959183674, 'f1-score': 0.5157723577235772, 'support': 4704}, '2': {'precision': 0.421736869474779, 'recall': 0.18626550298576022, 'f1-score': 0.25840369603313684, 'support': 4354}, 'accuracy': 0.45259643916913944, 'macro avg': {'precision': 0.45389242547890624, 'recall': 0.4501015703116276, 'f1-score': 0.42743088450411443, 'support': 13480}, 'weighted avg': {'precision': 0.4555675308295845, 'recall': 0.45259643916913944, 'f1-score': 0.43013163704594787, 'support': 13480}}
[[2911 1048  463]
 [1676 2379  649]
 [2449 1094  811]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0603529
{'0': {'precision': 0.39351139700741156, 'recall': 0.6433470507544582, 'f1-score': 0.4883297180043384, 'support': 4374}, '1': {'precision': 0.5031340405014465, 'recall': 0.4307533539731682, 'f1-score': 0.4641387746024686, 'support': 4845}, '2': {'precision': 0.4103622191655204, 'recall': 0.21004459047172025, 'f1-score': 0.27786401738590505, 'support': 4261}, 'accuracy': 0.42997032640949556, 'macro avg': {'precision': 0.4356692188914595, 'recall': 0.4280483317331156, 'f1-score': 0.41011083666423737, 'support': 13480}, 'weighted avg': {'precision': 0.43823862704779, 'recall': 0.42997032640949556, 'f1-score': 0.41310720531018386, 'support': 13480}}
[[2814 1040  520]
 [1992 2087  766]
 [2345 1021  895]]
training model: results/LILAK/W9/deepVOL_L3/seq2seq
Epoch 1/50
200/200 - 14s - loss: 13.2542 - accuracy10: 0.3637 - accuracy20: 0.3650 - accuracy30: 0.3660 - accuracy50: 0.3666 - val_loss: 13.2515 - val_accuracy10: 0.3345 - val_accuracy20: 0.3616 - val_accuracy30: 0.3694 - val_accuracy50: 0.3597 - 14s/epoch - 69ms/step
Epoch 2/50
200/200 - 8s - loss: 13.0625 - accuracy10: 0.3865 - accuracy20: 0.3861 - accuracy30: 0.3849 - accuracy50: 0.3793 - val_loss: 12.8519 - val_accuracy10: 0.4117 - val_accuracy20: 0.4180 - val_accuracy30: 0.4189 - val_accuracy50: 0.4019 - 8s/epoch - 38ms/step
Epoch 3/50
200/200 - 8s - loss: 12.9423 - accuracy10: 0.3941 - accuracy20: 0.3968 - accuracy30: 0.3952 - accuracy50: 0.3859 - val_loss: 12.9723 - val_accuracy10: 0.3939 - val_accuracy20: 0.4004 - val_accuracy30: 0.3947 - val_accuracy50: 0.3754 - 8s/epoch - 38ms/step
Epoch 4/50
200/200 - 8s - loss: 12.9094 - accuracy10: 0.4031 - accuracy20: 0.4027 - accuracy30: 0.3968 - accuracy50: 0.3831 - val_loss: 12.8001 - val_accuracy10: 0.4211 - val_accuracy20: 0.4230 - val_accuracy30: 0.4174 - val_accuracy50: 0.3973 - 8s/epoch - 38ms/step
Epoch 5/50
200/200 - 8s - loss: 12.8025 - accuracy10: 0.4199 - accuracy20: 0.4210 - accuracy30: 0.4135 - accuracy50: 0.4007 - val_loss: 12.7177 - val_accuracy10: 0.4380 - val_accuracy20: 0.4411 - val_accuracy30: 0.4355 - val_accuracy50: 0.4123 - 8s/epoch - 38ms/step
Epoch 6/50
200/200 - 8s - loss: 12.7470 - accuracy10: 0.4233 - accuracy20: 0.4250 - accuracy30: 0.4195 - accuracy50: 0.4034 - val_loss: 12.7672 - val_accuracy10: 0.4314 - val_accuracy20: 0.4343 - val_accuracy30: 0.4340 - val_accuracy50: 0.4088 - 8s/epoch - 39ms/step
Epoch 7/50
200/200 - 8s - loss: 12.6961 - accuracy10: 0.4302 - accuracy20: 0.4315 - accuracy30: 0.4257 - accuracy50: 0.4106 - val_loss: 12.7194 - val_accuracy10: 0.4401 - val_accuracy20: 0.4372 - val_accuracy30: 0.4340 - val_accuracy50: 0.4149 - 8s/epoch - 38ms/step
Epoch 8/50
200/200 - 8s - loss: 12.6148 - accuracy10: 0.4343 - accuracy20: 0.4366 - accuracy30: 0.4286 - accuracy50: 0.4142 - val_loss: 12.7649 - val_accuracy10: 0.4430 - val_accuracy20: 0.4330 - val_accuracy30: 0.4277 - val_accuracy50: 0.4017 - 8s/epoch - 39ms/step
Epoch 9/50
200/200 - 8s - loss: 12.5159 - accuracy10: 0.4455 - accuracy20: 0.4489 - accuracy30: 0.4428 - accuracy50: 0.4271 - val_loss: 12.7548 - val_accuracy10: 0.4409 - val_accuracy20: 0.4367 - val_accuracy30: 0.4286 - val_accuracy50: 0.4033 - 8s/epoch - 39ms/step
Epoch 10/50
200/200 - 8s - loss: 12.4529 - accuracy10: 0.4518 - accuracy20: 0.4552 - accuracy30: 0.4503 - accuracy50: 0.4327 - val_loss: 12.7681 - val_accuracy10: 0.4422 - val_accuracy20: 0.4358 - val_accuracy30: 0.4251 - val_accuracy50: 0.4023 - 8s/epoch - 39ms/step
Epoch 11/50
200/200 - 8s - loss: 12.4080 - accuracy10: 0.4557 - accuracy20: 0.4574 - accuracy30: 0.4519 - accuracy50: 0.4351 - val_loss: 12.7481 - val_accuracy10: 0.4467 - val_accuracy20: 0.4366 - val_accuracy30: 0.4276 - val_accuracy50: 0.3982 - 8s/epoch - 40ms/step
Epoch 12/50
200/200 - 8s - loss: 12.3287 - accuracy10: 0.4600 - accuracy20: 0.4644 - accuracy30: 0.4612 - accuracy50: 0.4424 - val_loss: 12.7760 - val_accuracy10: 0.4441 - val_accuracy20: 0.4392 - val_accuracy30: 0.4257 - val_accuracy50: 0.3962 - 8s/epoch - 38ms/step
Epoch 13/50
200/200 - 8s - loss: 12.2585 - accuracy10: 0.4688 - accuracy20: 0.4726 - accuracy30: 0.4669 - accuracy50: 0.4480 - val_loss: 12.7638 - val_accuracy10: 0.4421 - val_accuracy20: 0.4306 - val_accuracy30: 0.4182 - val_accuracy50: 0.3935 - 8s/epoch - 39ms/step
Epoch 14/50
200/200 - 8s - loss: 12.1770 - accuracy10: 0.4785 - accuracy20: 0.4812 - accuracy30: 0.4745 - accuracy50: 0.4506 - val_loss: 12.8381 - val_accuracy10: 0.4290 - val_accuracy20: 0.4292 - val_accuracy30: 0.4274 - val_accuracy50: 0.3999 - 8s/epoch - 38ms/step
Epoch 15/50
200/200 - 8s - loss: 12.1540 - accuracy10: 0.4851 - accuracy20: 0.4871 - accuracy30: 0.4783 - accuracy50: 0.4547 - val_loss: 12.7271 - val_accuracy10: 0.4545 - val_accuracy20: 0.4430 - val_accuracy30: 0.4286 - val_accuracy50: 0.4016 - 8s/epoch - 38ms/step
testing model: results/LILAK/W9/deepVOL_L3/seq2seq
Evaluating performance on  test set...
295/295 - 5s - 5s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0860689
{'0': {'precision': 0.3162716861322145, 'recall': 0.6524139221556886, 'f1-score': 0.42602068091215956, 'support': 21376}, '1': {'precision': 0.6019406949639508, 'recall': 0.36001685957915897, 'f1-score': 0.4505579224994928, 'support': 30843}, '2': {'precision': 0.2940305486284289, 'recall': 0.16294536817102137, 'f1-score': 0.20968683135576735, 'support': 23155}, 'accuracy': 0.38239976649773133, 'macro avg': {'precision': 0.40408097657486475, 'recall': 0.391792049968623, 'f1-score': 0.36208847825580653, 'support': 75374}, 'weighted avg': {'precision': 0.4263347808399, 'recall': 0.38239976649773133, 'f1-score': 0.36960324062505595, 'support': 75374}}
[[13946  3450  3980]
 [14660 11104  5079]
 [15489  3893  3773]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0709159
{'0': {'precision': 0.35088566827697265, 'recall': 0.6316465131687925, 'f1-score': 0.45115206010233966, 'support': 24148}, '1': {'precision': 0.5132546224103364, 'recall': 0.37407151844786296, 'f1-score': 0.4327471650271171, 'support': 24637}, '2': {'precision': 0.33560367077717235, 'recall': 0.17605024634247246, 'f1-score': 0.2309495029232553, 'support': 26589}, 'accuracy': 0.38673813251253747, 'macro avg': {'precision': 0.39991465382149377, 'recall': 0.39392275931970927, 'f1-score': 0.3716162426842373, 'support': 75374}, 'weighted avg': {'precision': 0.39856724138522603, 'recall': 0.38673813251253747, 'f1-score': 0.36745732195917447, 'support': 75374}}
[[15253  4117  4778]
 [10932  9216  4489]
 [17285  4623  4681]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0713742
{'0': {'precision': 0.36296399990667505, 'recall': 0.6169740233987706, 'f1-score': 0.45704800517069155, 'support': 25215}, '1': {'precision': 0.47215982976711196, 'recall': 0.3539995568358077, 'f1-score': 0.4046298406909303, 'support': 22565}, '2': {'precision': 0.3519076627124078, 'recall': 0.19888381532217148, 'f1-score': 0.2541387853388594, 'support': 27594}, 'accuracy': 0.38518587311274444, 'macro avg': {'precision': 0.3956771641287316, 'recall': 0.38995246518558324, 'f1-score': 0.3719388770668271, 'support': 75374}, 'weighted avg': {'precision': 0.391606706042241, 'recall': 0.3851858731127445, 'f1-score': 0.36707144968039795, 'support': 75374}}
[[15557  4218  5440]
 [ 9910  7988  4667]
 [17394  4712  5488]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0884211
{'0': {'precision': 0.34657553751957854, 'recall': 0.594455977530834, 'f1-score': 0.43786822577018214, 'support': 24567}, '1': {'precision': 0.43727575602255253, 'recall': 0.28996898500233675, 'f1-score': 0.3487035381274748, 'support': 23537}, '2': {'precision': 0.34916042659405494, 'recall': 0.2257059039237257, 'f1-score': 0.2741770234754332, 'support': 27270}, 'accuracy': 0.36596173746915384, 'macro avg': {'precision': 0.37767057337872867, 'recall': 0.37004362215229886, 'f1-score': 0.35358292912436334, 'support': 75374}, 'weighted avg': {'precision': 0.37583364997169033, 'recall': 0.36596173746915384, 'f1-score': 0.3508020180642861, 'support': 75374}}
[[14604  4123  5840]
 [11079  6825  5633]
 [16455  4660  6155]]
Evaluating performance on  train set...
200/200 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0590428
{'0': {'precision': 0.3474364791288566, 'recall': 0.6249319912948857, 'f1-score': 0.44658825816485226, 'support': 14704}, '1': {'precision': 0.6211518202036755, 'recall': 0.4797052974145724, 'f1-score': 0.5413414945167049, 'support': 22124}, '2': {'precision': 0.3065174456879526, 'recall': 0.16278581917348436, 'f1-score': 0.21264157837047862, 'support': 14301}, 'accuracy': 0.43282677149954035, 'macro avg': {'precision': 0.4250352483401616, 'recall': 0.4224743692943142, 'f1-score': 0.40019044368401196, 'support': 51129}, 'weighted avg': {'precision': 0.45443045727630577, 'recall': 0.43282677149954035, 'f1-score': 0.4221529892041655, 'support': 51129}}
[[ 9189  3124  2391]
 [ 8635 10613  2876]
 [ 8624  3349  2328]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0514573
{'0': {'precision': 0.38758822848767693, 'recall': 0.5985110184633711, 'f1-score': 0.47049184165554697, 'support': 16790}, '1': {'precision': 0.5405260332796564, 'recall': 0.5079587490191683, 'f1-score': 0.5237366003062788, 'support': 17842}, '2': {'precision': 0.35257854179016007, 'recall': 0.1802752015517973, 'f1-score': 0.23856890742820475, 'support': 16497}, 'accuracy': 0.4319662031332512, 'macro avg': {'precision': 0.42689760118583114, 'recall': 0.4289149896781122, 'f1-score': 0.4109324497966768, 'support': 51129}, 'weighted avg': {'precision': 0.4296614454809599, 'recall': 0.4319662031332512, 'f1-score': 0.414241188169226, 'support': 51129}}
[[10049  3729  3012]
 [ 6330  9063  2449]
 [ 9548  3975  2974]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.056392
{'0': {'precision': 0.39996867290597954, 'recall': 0.5831572937482158, 'f1-score': 0.4744959583759174, 'support': 17515}, '1': {'precision': 0.5015212666873642, 'recall': 0.4906451220993804, 'f1-score': 0.4960235821537139, 'support': 16462}, '2': {'precision': 0.3681880468008854, 'recall': 0.20364972014925373, 'f1-score': 0.2622470813468974, 'support': 17152}, 'accuracy': 0.42605957480099355, 'macro avg': {'precision': 0.42322599546474304, 'recall': 0.4258173786656166, 'f1-score': 0.41092220729217627, 'support': 51129}, 'weighted avg': {'precision': 0.42200425936130975, 'recall': 0.42605957480099355, 'f1-score': 0.4102250945575039, 'support': 51129}}
[[10214  3923  3378]
 [ 5769  8077  2616]
 [ 9554  4105  3493]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0702524
{'0': {'precision': 0.388362760834671, 'recall': 0.5576169624337405, 'f1-score': 0.45784842463809255, 'support': 17356}, '1': {'precision': 0.4771074867360975, 'recall': 0.434088200238379, 'f1-score': 0.4545823321995819, 'support': 16780}, '2': {'precision': 0.3666605739352952, 'recall': 0.23609721650091214, 'f1-score': 0.28723823160909256, 'support': 16993}, 'accuracy': 0.41021729351248803, 'macro avg': {'precision': 0.4107102738353546, 'recall': 0.4092674597243439, 'f1-score': 0.399889662815589, 'support': 51129}, 'weighted avg': {'precision': 0.4102750070871861, 'recall': 0.41021729351248803, 'f1-score': 0.4000733059919229, 'support': 51129}}
[[9678 3977 3701]
 [6267 7284 3229]
 [8975 4006 4012]]
Evaluating performance on  val set...
53/53 - 1s - 917ms/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0591673
{'0': {'precision': 0.32748538011695905, 'recall': 0.5996705107084019, 'f1-score': 0.42362525458248473, 'support': 3642}, '1': {'precision': 0.6475533520155206, 'recall': 0.4950560316413975, 'f1-score': 0.5611282338656953, 'support': 6068}, '2': {'precision': 0.32734806629834257, 'recall': 0.18859416445623342, 'f1-score': 0.23931336250420732, 'support': 3770}, 'accuracy': 0.4376112759643917, 'macro avg': {'precision': 0.43412893281027404, 'recall': 0.4277735689353443, 'f1-score': 0.4080222836507958, 'support': 13480}, 'weighted avg': {'precision': 0.47152505225229197, 'recall': 0.4376112759643917, 'f1-score': 0.43397482766523077, 'support': 13480}}
[[2184  844  614]
 [2217 3004  847]
 [2268  791  711]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0528765
{'0': {'precision': 0.3743752839618355, 'recall': 0.5874524714828897, 'f1-score': 0.45731199704005177, 'support': 4208}, '1': {'precision': 0.5723423026025585, 'recall': 0.5205616850551655, 'f1-score': 0.545225338796092, 'support': 4985}, '2': {'precision': 0.36833119931711483, 'recall': 0.2013062747842314, 'f1-score': 0.2603318250377074, 'support': 4287}, 'accuracy': 0.43991097922848665, 'macro avg': {'precision': 0.43834959529383627, 'recall': 0.4364401437740955, 'f1-score': 0.4209563869579504, 'support': 13480}, 'weighted avg': {'precision': 0.44566271697756893, 'recall': 0.43991097922848665, 'f1-score': 0.4271780216157054, 'support': 13480}}
[[2472  989  747]
 [1657 2595  733]
 [2474  950  863]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0586066
{'0': {'precision': 0.3908936038407929, 'recall': 0.5707824513794663, 'f1-score': 0.46401323651070864, 'support': 4422}, '1': {'precision': 0.5435838150289017, 'recall': 0.4997874149659864, 'f1-score': 0.5207664193155388, 'support': 4704}, '2': {'precision': 0.3732394366197183, 'recall': 0.23128158015617822, 'f1-score': 0.2855927396483267, 'support': 4354}, 'accuracy': 0.4363501483679525, 'macro avg': {'precision': 0.43590561849647097, 'recall': 0.43395048216721027, 'f1-score': 0.4234574651581913, 'support': 13480}, 'weighted avg': {'precision': 0.4384743537924476, 'recall': 0.4363501483679525, 'f1-score': 0.4261886169688029, 'support': 13480}}
[[2524 1013  885]
 [1547 2351  806]
 [2386  961 1007]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0763572
{'0': {'precision': 0.37024166798294106, 'recall': 0.535893918609968, 'f1-score': 0.4379262027090145, 'support': 4374}, '1': {'precision': 0.5156405163853028, 'recall': 0.42868937048503614, 'f1-score': 0.4681618392877268, 'support': 4845}, '2': {'precision': 0.3418776033322653, 'recall': 0.25041070171321284, 'f1-score': 0.28908154971552424, 'support': 4261}, 'accuracy': 0.40712166172106823, 'macro avg': {'precision': 0.40925326256683636, 'recall': 0.40499799693607236, 'f1-score': 0.39838986390408854, 'support': 13480}, 'weighted avg': {'precision': 0.41353529862336486, 'recall': 0.40712166172106823, 'f1-score': 0.40174405084095804, 'support': 13480}}
[[2344  998 1032]
 [1746 2077 1022]
 [2241  953 1067]]
training model: results/LILAK/W10/deepLOB_L1/seq2seq
Epoch 1/50
135/135 - 9s - loss: 13.2999 - accuracy10: 0.3629 - accuracy20: 0.3606 - accuracy30: 0.3621 - accuracy50: 0.3615 - val_loss: 13.2304 - val_accuracy10: 0.3573 - val_accuracy20: 0.3656 - val_accuracy30: 0.3570 - val_accuracy50: 0.3568 - 9s/epoch - 66ms/step
Epoch 2/50
135/135 - 3s - loss: 13.1460 - accuracy10: 0.3804 - accuracy20: 0.3824 - accuracy30: 0.3822 - accuracy50: 0.3755 - val_loss: 13.2361 - val_accuracy10: 0.3623 - val_accuracy20: 0.3716 - val_accuracy30: 0.3573 - val_accuracy50: 0.3560 - 3s/epoch - 23ms/step
Epoch 3/50
135/135 - 3s - loss: 13.0395 - accuracy10: 0.3988 - accuracy20: 0.3993 - accuracy30: 0.4000 - accuracy50: 0.3924 - val_loss: 13.2048 - val_accuracy10: 0.3807 - val_accuracy20: 0.3866 - val_accuracy30: 0.3722 - val_accuracy50: 0.3698 - 3s/epoch - 23ms/step
Epoch 4/50
135/135 - 3s - loss: 12.9746 - accuracy10: 0.4136 - accuracy20: 0.4126 - accuracy30: 0.4046 - accuracy50: 0.3962 - val_loss: 13.0182 - val_accuracy10: 0.4134 - val_accuracy20: 0.4152 - val_accuracy30: 0.4020 - val_accuracy50: 0.3882 - 3s/epoch - 23ms/step
Epoch 5/50
135/135 - 3s - loss: 12.9266 - accuracy10: 0.4199 - accuracy20: 0.4132 - accuracy30: 0.4072 - accuracy50: 0.3947 - val_loss: 13.1659 - val_accuracy10: 0.3900 - val_accuracy20: 0.3938 - val_accuracy30: 0.3793 - val_accuracy50: 0.3716 - 3s/epoch - 22ms/step
Epoch 6/50
135/135 - 3s - loss: 12.8899 - accuracy10: 0.4303 - accuracy20: 0.4218 - accuracy30: 0.4119 - accuracy50: 0.3983 - val_loss: 13.0169 - val_accuracy10: 0.4010 - val_accuracy20: 0.4035 - val_accuracy30: 0.3947 - val_accuracy50: 0.3843 - 3s/epoch - 23ms/step
Epoch 7/50
135/135 - 3s - loss: 12.8275 - accuracy10: 0.4370 - accuracy20: 0.4289 - accuracy30: 0.4184 - accuracy50: 0.4022 - val_loss: 12.9417 - val_accuracy10: 0.4273 - val_accuracy20: 0.4157 - val_accuracy30: 0.3980 - val_accuracy50: 0.3854 - 3s/epoch - 23ms/step
Epoch 8/50
135/135 - 3s - loss: 12.7966 - accuracy10: 0.4410 - accuracy20: 0.4314 - accuracy30: 0.4221 - accuracy50: 0.4042 - val_loss: 13.0255 - val_accuracy10: 0.4209 - val_accuracy20: 0.4165 - val_accuracy30: 0.3959 - val_accuracy50: 0.3863 - 3s/epoch - 22ms/step
Epoch 9/50
135/135 - 3s - loss: 12.7328 - accuracy10: 0.4519 - accuracy20: 0.4425 - accuracy30: 0.4343 - accuracy50: 0.4146 - val_loss: 12.9420 - val_accuracy10: 0.4370 - val_accuracy20: 0.4180 - val_accuracy30: 0.4020 - val_accuracy50: 0.3902 - 3s/epoch - 22ms/step
Epoch 10/50
135/135 - 3s - loss: 12.7222 - accuracy10: 0.4517 - accuracy20: 0.4376 - accuracy30: 0.4254 - accuracy50: 0.4101 - val_loss: 12.9308 - val_accuracy10: 0.4347 - val_accuracy20: 0.4247 - val_accuracy30: 0.4062 - val_accuracy50: 0.3897 - 3s/epoch - 22ms/step
Epoch 11/50
135/135 - 3s - loss: 12.6722 - accuracy10: 0.4627 - accuracy20: 0.4476 - accuracy30: 0.4314 - accuracy50: 0.4128 - val_loss: 12.9242 - val_accuracy10: 0.4405 - val_accuracy20: 0.4273 - val_accuracy30: 0.4027 - val_accuracy50: 0.3832 - 3s/epoch - 23ms/step
Epoch 12/50
135/135 - 3s - loss: 12.6423 - accuracy10: 0.4689 - accuracy20: 0.4507 - accuracy30: 0.4343 - accuracy50: 0.4133 - val_loss: 12.9344 - val_accuracy10: 0.4351 - val_accuracy20: 0.4230 - val_accuracy30: 0.3974 - val_accuracy50: 0.3782 - 3s/epoch - 23ms/step
Epoch 13/50
135/135 - 3s - loss: 12.6222 - accuracy10: 0.4713 - accuracy20: 0.4533 - accuracy30: 0.4361 - accuracy50: 0.4165 - val_loss: 12.9978 - val_accuracy10: 0.4286 - val_accuracy20: 0.4166 - val_accuracy30: 0.3935 - val_accuracy50: 0.3779 - 3s/epoch - 23ms/step
Epoch 14/50
135/135 - 3s - loss: 12.5903 - accuracy10: 0.4767 - accuracy20: 0.4575 - accuracy30: 0.4407 - accuracy50: 0.4182 - val_loss: 13.0773 - val_accuracy10: 0.4186 - val_accuracy20: 0.4127 - val_accuracy30: 0.3890 - val_accuracy50: 0.3779 - 3s/epoch - 23ms/step
Epoch 15/50
135/135 - 3s - loss: 12.5558 - accuracy10: 0.4822 - accuracy20: 0.4598 - accuracy30: 0.4404 - accuracy50: 0.4197 - val_loss: 13.0874 - val_accuracy10: 0.4247 - val_accuracy20: 0.4191 - val_accuracy30: 0.3921 - val_accuracy50: 0.3771 - 3s/epoch - 23ms/step
Epoch 16/50
135/135 - 3s - loss: 12.5550 - accuracy10: 0.4813 - accuracy20: 0.4611 - accuracy30: 0.4411 - accuracy50: 0.4197 - val_loss: 13.0601 - val_accuracy10: 0.4175 - val_accuracy20: 0.4052 - val_accuracy30: 0.3887 - val_accuracy50: 0.3760 - 3s/epoch - 22ms/step
Epoch 17/50
135/135 - 3s - loss: 12.4907 - accuracy10: 0.4915 - accuracy20: 0.4697 - accuracy30: 0.4473 - accuracy50: 0.4234 - val_loss: 13.0661 - val_accuracy10: 0.4243 - val_accuracy20: 0.4100 - val_accuracy30: 0.3856 - val_accuracy50: 0.3713 - 3s/epoch - 23ms/step
Epoch 18/50
135/135 - 3s - loss: 12.4726 - accuracy10: 0.4932 - accuracy20: 0.4707 - accuracy30: 0.4490 - accuracy50: 0.4220 - val_loss: 13.0925 - val_accuracy10: 0.4235 - val_accuracy20: 0.4071 - val_accuracy30: 0.3837 - val_accuracy50: 0.3719 - 3s/epoch - 22ms/step
Epoch 19/50
135/135 - 3s - loss: 12.4407 - accuracy10: 0.4965 - accuracy20: 0.4721 - accuracy30: 0.4538 - accuracy50: 0.4277 - val_loss: 13.2004 - val_accuracy10: 0.3960 - val_accuracy20: 0.3840 - val_accuracy30: 0.3745 - val_accuracy50: 0.3641 - 3s/epoch - 22ms/step
Epoch 20/50
135/135 - 3s - loss: 12.4575 - accuracy10: 0.4930 - accuracy20: 0.4706 - accuracy30: 0.4494 - accuracy50: 0.4217 - val_loss: 13.0764 - val_accuracy10: 0.4155 - val_accuracy20: 0.4100 - val_accuracy30: 0.3931 - val_accuracy50: 0.3747 - 3s/epoch - 22ms/step
Epoch 21/50
135/135 - 3s - loss: 12.3855 - accuracy10: 0.5016 - accuracy20: 0.4752 - accuracy30: 0.4565 - accuracy50: 0.4273 - val_loss: 13.1335 - val_accuracy10: 0.4060 - val_accuracy20: 0.4039 - val_accuracy30: 0.3806 - val_accuracy50: 0.3790 - 3s/epoch - 22ms/step
testing model: results/LILAK/W10/deepLOB_L1/seq2seq
Evaluating performance on  test set...
519/519 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0706072
{'0': {'precision': 0.5053526211547622, 'recall': 0.39635441245870695, 'f1-score': 0.4442656733852749, 'support': 50856}, '1': {'precision': 0.3714410100130605, 'recall': 0.24408525246745816, 'f1-score': 0.29458782908933967, 'support': 34955}, '2': {'precision': 0.4310208879904807, 'recall': 0.6424282570140387, 'f1-score': 0.5159070629418628, 'support': 46799}, 'accuracy': 0.44305859286629967, 'macro avg': {'precision': 0.43593817305276783, 'recall': 0.42762264064673455, 'f1-score': 0.4182535218054924, 'support': 132610}, 'weighted avg': {'precision': 0.44382233574782914, 'recall': 0.44305859286629967, 'f1-score': 0.4300944671602115, 'support': 132610}}
[[20157  8576 22123]
 [ 8858  8532 17565]
 [10872  5862 30065]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0794979
{'0': {'precision': 0.5051024227151376, 'recall': 0.3785340314136126, 'f1-score': 0.4327536634636967, 'support': 53480}, '1': {'precision': 0.2951061943165984, 'recall': 0.2342550695491872, 'f1-score': 0.26118315333158937, 'support': 29835}, '2': {'precision': 0.43808099000697187, 'recall': 0.6118470433106806, 'f1-score': 0.5105846304901687, 'support': 49295}, 'accuracy': 0.432802956036498, 'macro avg': {'precision': 0.4127632023462359, 'recall': 0.4082120480911602, 'f1-score': 0.40150714909515156, 'support': 132610}, 'weighted avg': {'precision': 0.43294301543348884, 'recall': 0.432802956036498, 'f1-score': 0.42308524743005305, 'support': 132610}}
[[20244  9511 23725]
 [ 7884  6989 14962]
 [11951  7183 30161]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0902576
{'0': {'precision': 0.4747096384936397, 'recall': 0.3655387355298308, 'f1-score': 0.4130320661446257, 'support': 51658}, '1': {'precision': 0.2882245271507016, 'recall': 0.2150335326070464, 'f1-score': 0.24630678855712743, 'support': 32953}, '2': {'precision': 0.4174982050493062, 'recall': 0.593616533677785, 'f1-score': 0.4902190182888013, 'support': 47999}, 'accuracy': 0.410693009576955, 'macro avg': {'precision': 0.3934774568978825, 'recall': 0.3913962672715541, 'f1-score': 0.38318595766351815, 'support': 132610}, 'weighted avg': {'precision': 0.4076608829851682, 'recall': 0.410693009576955, 'f1-score': 0.39953985924942514, 'support': 132610}}
[[18883  9673 23102]
 [ 9215  7086 16652]
 [11680  7826 28493]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1001756
{'0': {'precision': 0.4527916946438717, 'recall': 0.3396091192593023, 'f1-score': 0.3881171900076371, 'support': 51627}, '1': {'precision': 0.25723084119435563, 'recall': 0.20055921952405556, 'f1-score': 0.22538722953703227, 'support': 32903}, '2': {'precision': 0.40556027786733884, 'recall': 0.5755615640599002, 'f1-score': 0.4758326598689754, 'support': 48080}, 'accuracy': 0.39065681321167334, 'macro avg': {'precision': 0.37186093790185537, 'recall': 0.37190996761441936, 'f1-score': 0.36311235980454826, 'support': 132610}, 'weighted avg': {'precision': 0.3871448710282686, 'recall': 0.39065681321167334, 'f1-score': 0.37954359753021333, 'support': 132610}}
[[17533 10430 23664]
 [ 9407  6599 16897]
 [11782  8625 27673]]
Evaluating performance on  train set...
135/135 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0525812
{'0': {'precision': 0.46457840101985065, 'recall': 0.45877169319305816, 'f1-score': 0.4616567886712211, 'support': 11121}, '1': {'precision': 0.4232858748594979, 'recall': 0.39244463742943986, 'f1-score': 0.4072822315353071, 'support': 11515}, '2': {'precision': 0.4518752467429925, 'recall': 0.4896893984769402, 'f1-score': 0.4700229960578187, 'support': 11687}, 'accuracy': 0.44704716953646245, 'macro avg': {'precision': 0.44657984087411373, 'recall': 0.4469685763664794, 'f1-score': 0.44632067208811566, 'support': 34323}, 'weighted avg': {'precision': 0.44639976853521635, 'recall': 0.44704716953646245, 'f1-score': 0.446263403486567, 'support': 34323}}
[[5102 2958 3061]
 [3115 4519 3881]
 [2765 3199 5723]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0603788
{'0': {'precision': 0.4580275639878289, 'recall': 0.44812188074599424, 'f1-score': 0.45302057977428634, 'support': 11421}, '1': {'precision': 0.4094023601065855, 'recall': 0.3767405201856555, 'f1-score': 0.39239294021069915, 'support': 11419}, '2': {'precision': 0.43627877541333754, 'recall': 0.4802751894104328, 'f1-score': 0.45722102470568726, 'support': 11483}, 'accuracy': 0.43513096174576815, 'macro avg': {'precision': 0.43456956650258394, 'recall': 0.43504586344736085, 'f1-score': 0.43421151489689097, 'support': 34323}, 'weighted avg': {'precision': 0.4345741204566457, 'recall': 0.43513096174576815, 'f1-score': 0.4342555153268509, 'support': 34323}}
[[5118 3077 3226]
 [3217 4302 3900]
 [2839 3129 5515]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.070173
{'0': {'precision': 0.4442871050535446, 'recall': 0.43842794759825326, 'f1-score': 0.4413380807947602, 'support': 11450}, '1': {'precision': 0.3873575533261907, 'recall': 0.349257925704751, 'f1-score': 0.36732243465410547, 'support': 11387}, '2': {'precision': 0.42055342165085835, 'recall': 0.46709037088629635, 'f1-score': 0.44260198820278013, 'support': 11486}, 'accuracy': 0.4184366168458468, 'macro avg': {'precision': 0.4173993600101979, 'recall': 0.4182587480631002, 'f1-score': 0.4170875012172153, 'support': 34323}, 'weighted avg': {'precision': 0.4174578100303056, 'recall': 0.4184366168458468, 'f1-score': 0.4172056062990833, 'support': 34323}}
[[5020 3125 3305]
 [3323 3977 4087]
 [2956 3165 5365]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0823737
{'0': {'precision': 0.4291289693099166, 'recall': 0.41854831732848863, 'f1-score': 0.42377260981912146, 'support': 11559}, '1': {'precision': 0.36270205547794854, 'recall': 0.3272416276557436, 'f1-score': 0.34406057737813533, 'support': 11108}, '2': {'precision': 0.40408382590005376, 'recall': 0.45161290322580644, 'f1-score': 0.42652837985658154, 'support': 11656}, 'accuracy': 0.40022725286251204, 'macro avg': {'precision': 0.39863828356263964, 'recall': 0.39913428273667956, 'f1-score': 0.3981205223512794, 'support': 34323}, 'weighted avg': {'precision': 0.399125870791988, 'recall': 0.40022725286251204, 'f1-score': 0.3989111466370617, 'support': 34323}}
[[4838 3145 3576]
 [3286 3635 4187]
 [3150 3242 5264]]
Evaluating performance on  val set...
46/46 - 0s - 430ms/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0626749
{'0': {'precision': 0.45775462962962965, 'recall': 0.41807610993657507, 'f1-score': 0.43701657458563536, 'support': 3784}, '1': {'precision': 0.41049301344582123, 'recall': 0.38077769625825386, 'f1-score': 0.39507739152499366, 'support': 4089}, '2': {'precision': 0.4389803744642454, 'recall': 0.5108952480966132, 'f1-score': 0.472215481679204, 'support': 3809}, 'accuracy': 0.4352850539291217, 'macro avg': {'precision': 0.43574267251323207, 'recall': 0.43658301809714734, 'f1-score': 0.4347698159299444, 'support': 11682}, 'weighted avg': {'precision': 0.4350903695285733, 'recall': 0.4352850539291217, 'f1-score': 0.4338136399498229, 'support': 11682}}
[[1582 1135 1067]
 [1112 1557 1420]
 [ 762 1101 1946]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0703212
{'0': {'precision': 0.4640156818818258, 'recall': 0.4146646646646647, 'f1-score': 0.43795427514206414, 'support': 3996}, '1': {'precision': 0.3823609226594301, 'recall': 0.37513312034078805, 'f1-score': 0.3787125386372799, 'support': 3756}, '2': {'precision': 0.4374152733845459, 'recall': 0.4926208651399491, 'f1-score': 0.46337960746768786, 'support': 3930}, 'accuracy': 0.42818010614620783, 'macro avg': {'precision': 0.42793062597526726, 'recall': 0.4274728833818006, 'f1-score': 0.4266821404156773, 'support': 11682}, 'weighted avg': {'precision': 0.4288132438546362, 'recall': 0.42818010614620783, 'f1-score': 0.42746031809085133, 'support': 11682}}
[[1657 1161 1178]
 [1035 1409 1312]
 [ 879 1115 1936]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0825605
{'0': {'precision': 0.45302656806354424, 'recall': 0.41298377028714106, 'f1-score': 0.4320794148380355, 'support': 4005}, '1': {'precision': 0.3500560538116592, 'recall': 0.32807985290254793, 'f1-score': 0.33871186440677964, 'support': 3807}, '2': {'precision': 0.4075733811337665, 'recall': 0.47002583979328166, 'f1-score': 0.43657746309852385, 'support': 3870}, 'accuracy': 0.4042116076014381, 'macro avg': {'precision': 0.40355200100299, 'recall': 0.40369648766099026, 'f1-score': 0.4024562474477797, 'support': 11682}, 'weighted avg': {'precision': 0.40441223993692504, 'recall': 0.4042116076014381, 'f1-score': 0.4031423477498913, 'support': 11682}}
[[1654 1174 1177]
 [1091 1249 1467]
 [ 906 1145 1819]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.092503
{'0': {'precision': 0.4326585695006748, 'recall': 0.4008502125531383, 'f1-score': 0.4161474558670821, 'support': 3999}, '1': {'precision': 0.33140543666859457, 'recall': 0.3039787798408488, 'f1-score': 0.3171001660210293, 'support': 3770}, '2': {'precision': 0.3888028324850631, 'recall': 0.4490161001788909, 'f1-score': 0.4167457305502846, 'support': 3913}, 'accuracy': 0.3857216230097586, 'macro avg': {'precision': 0.3842889462181109, 'recall': 0.384615030857626, 'f1-score': 0.38333111747946536, 'support': 11682}, 'weighted avg': {'precision': 0.38529238137201266, 'recall': 0.3857216230097586, 'f1-score': 0.3843834399550595, 'support': 11682}}
[[1603 1165 1231]
 [1093 1146 1531]
 [1009 1147 1757]]
training model: results/LILAK/W10/deepOF_L1/seq2seq
Epoch 1/50
135/135 - 8s - loss: 13.2727 - accuracy10: 0.3571 - accuracy20: 0.3576 - accuracy30: 0.3540 - accuracy50: 0.3462 - val_loss: 13.2014 - val_accuracy10: 0.3736 - val_accuracy20: 0.3580 - val_accuracy30: 0.3478 - val_accuracy50: 0.3396 - 8s/epoch - 63ms/step
Epoch 2/50
135/135 - 3s - loss: 13.1469 - accuracy10: 0.3834 - accuracy20: 0.3795 - accuracy30: 0.3705 - accuracy50: 0.3664 - val_loss: 13.1702 - val_accuracy10: 0.3891 - val_accuracy20: 0.3658 - val_accuracy30: 0.3563 - val_accuracy50: 0.3542 - 3s/epoch - 21ms/step
Epoch 3/50
135/135 - 3s - loss: 13.0891 - accuracy10: 0.3973 - accuracy20: 0.3881 - accuracy30: 0.3764 - accuracy50: 0.3688 - val_loss: 13.1545 - val_accuracy10: 0.4009 - val_accuracy20: 0.3678 - val_accuracy30: 0.3588 - val_accuracy50: 0.3562 - 3s/epoch - 21ms/step
Epoch 4/50
135/135 - 3s - loss: 13.0433 - accuracy10: 0.4119 - accuracy20: 0.3963 - accuracy30: 0.3843 - accuracy50: 0.3778 - val_loss: 13.1058 - val_accuracy10: 0.4079 - val_accuracy20: 0.3823 - val_accuracy30: 0.3677 - val_accuracy50: 0.3637 - 3s/epoch - 21ms/step
Epoch 5/50
135/135 - 3s - loss: 13.0019 - accuracy10: 0.4192 - accuracy20: 0.4019 - accuracy30: 0.3868 - accuracy50: 0.3817 - val_loss: 13.0831 - val_accuracy10: 0.4119 - val_accuracy20: 0.3842 - val_accuracy30: 0.3694 - val_accuracy50: 0.3689 - 3s/epoch - 21ms/step
Epoch 6/50
135/135 - 3s - loss: 12.9658 - accuracy10: 0.4272 - accuracy20: 0.4073 - accuracy30: 0.3924 - accuracy50: 0.3824 - val_loss: 13.0723 - val_accuracy10: 0.4183 - val_accuracy20: 0.3885 - val_accuracy30: 0.3687 - val_accuracy50: 0.3684 - 3s/epoch - 21ms/step
Epoch 7/50
135/135 - 3s - loss: 12.9296 - accuracy10: 0.4348 - accuracy20: 0.4123 - accuracy30: 0.3979 - accuracy50: 0.3887 - val_loss: 13.0517 - val_accuracy10: 0.4149 - val_accuracy20: 0.3920 - val_accuracy30: 0.3773 - val_accuracy50: 0.3710 - 3s/epoch - 21ms/step
Epoch 8/50
135/135 - 3s - loss: 12.9042 - accuracy10: 0.4391 - accuracy20: 0.4160 - accuracy30: 0.4035 - accuracy50: 0.3894 - val_loss: 13.0462 - val_accuracy10: 0.4214 - val_accuracy20: 0.3945 - val_accuracy30: 0.3783 - val_accuracy50: 0.3756 - 3s/epoch - 21ms/step
Epoch 9/50
135/135 - 3s - loss: 12.8794 - accuracy10: 0.4412 - accuracy20: 0.4184 - accuracy30: 0.4028 - accuracy50: 0.3904 - val_loss: 13.0474 - val_accuracy10: 0.4142 - val_accuracy20: 0.3861 - val_accuracy30: 0.3711 - val_accuracy50: 0.3694 - 3s/epoch - 20ms/step
Epoch 10/50
135/135 - 3s - loss: 12.8602 - accuracy10: 0.4414 - accuracy20: 0.4213 - accuracy30: 0.4044 - accuracy50: 0.3918 - val_loss: 13.0496 - val_accuracy10: 0.4172 - val_accuracy20: 0.3879 - val_accuracy30: 0.3753 - val_accuracy50: 0.3741 - 3s/epoch - 21ms/step
Epoch 11/50
135/135 - 3s - loss: 12.8489 - accuracy10: 0.4482 - accuracy20: 0.4230 - accuracy30: 0.4074 - accuracy50: 0.3938 - val_loss: 13.0384 - val_accuracy10: 0.4217 - val_accuracy20: 0.3921 - val_accuracy30: 0.3809 - val_accuracy50: 0.3747 - 3s/epoch - 21ms/step
Epoch 12/50
135/135 - 3s - loss: 12.8143 - accuracy10: 0.4528 - accuracy20: 0.4274 - accuracy30: 0.4094 - accuracy50: 0.3979 - val_loss: 13.0526 - val_accuracy10: 0.4214 - val_accuracy20: 0.3899 - val_accuracy30: 0.3798 - val_accuracy50: 0.3721 - 3s/epoch - 21ms/step
Epoch 13/50
135/135 - 3s - loss: 12.8055 - accuracy10: 0.4530 - accuracy20: 0.4276 - accuracy30: 0.4109 - accuracy50: 0.3982 - val_loss: 13.0469 - val_accuracy10: 0.4242 - val_accuracy20: 0.3921 - val_accuracy30: 0.3802 - val_accuracy50: 0.3746 - 3s/epoch - 21ms/step
Epoch 14/50
135/135 - 3s - loss: 12.7860 - accuracy10: 0.4548 - accuracy20: 0.4324 - accuracy30: 0.4143 - accuracy50: 0.4016 - val_loss: 13.0231 - val_accuracy10: 0.4283 - val_accuracy20: 0.3986 - val_accuracy30: 0.3823 - val_accuracy50: 0.3793 - 3s/epoch - 21ms/step
Epoch 15/50
135/135 - 3s - loss: 12.7645 - accuracy10: 0.4586 - accuracy20: 0.4341 - accuracy30: 0.4174 - accuracy50: 0.4045 - val_loss: 13.0212 - val_accuracy10: 0.4282 - val_accuracy20: 0.3974 - val_accuracy30: 0.3833 - val_accuracy50: 0.3758 - 3s/epoch - 21ms/step
Epoch 16/50
135/135 - 3s - loss: 12.7359 - accuracy10: 0.4600 - accuracy20: 0.4360 - accuracy30: 0.4211 - accuracy50: 0.4047 - val_loss: 13.0293 - val_accuracy10: 0.4307 - val_accuracy20: 0.3949 - val_accuracy30: 0.3787 - val_accuracy50: 0.3744 - 3s/epoch - 21ms/step
Epoch 17/50
135/135 - 3s - loss: 12.7027 - accuracy10: 0.4633 - accuracy20: 0.4415 - accuracy30: 0.4226 - accuracy50: 0.4102 - val_loss: 13.0397 - val_accuracy10: 0.4317 - val_accuracy20: 0.3986 - val_accuracy30: 0.3858 - val_accuracy50: 0.3723 - 3s/epoch - 21ms/step
Epoch 18/50
135/135 - 3s - loss: 12.6881 - accuracy10: 0.4670 - accuracy20: 0.4418 - accuracy30: 0.4236 - accuracy50: 0.4097 - val_loss: 13.0447 - val_accuracy10: 0.4266 - val_accuracy20: 0.3953 - val_accuracy30: 0.3808 - val_accuracy50: 0.3731 - 3s/epoch - 21ms/step
Epoch 19/50
135/135 - 3s - loss: 12.6716 - accuracy10: 0.4672 - accuracy20: 0.4452 - accuracy30: 0.4276 - accuracy50: 0.4135 - val_loss: 13.0343 - val_accuracy10: 0.4307 - val_accuracy20: 0.3986 - val_accuracy30: 0.3851 - val_accuracy50: 0.3722 - 3s/epoch - 21ms/step
Epoch 20/50
135/135 - 3s - loss: 12.6483 - accuracy10: 0.4711 - accuracy20: 0.4461 - accuracy30: 0.4269 - accuracy50: 0.4103 - val_loss: 13.0417 - val_accuracy10: 0.4308 - val_accuracy20: 0.3992 - val_accuracy30: 0.3823 - val_accuracy50: 0.3784 - 3s/epoch - 21ms/step
Epoch 21/50
135/135 - 3s - loss: 12.6323 - accuracy10: 0.4711 - accuracy20: 0.4519 - accuracy30: 0.4298 - accuracy50: 0.4200 - val_loss: 13.0196 - val_accuracy10: 0.4364 - val_accuracy20: 0.4021 - val_accuracy30: 0.3846 - val_accuracy50: 0.3826 - 3s/epoch - 21ms/step
Epoch 22/50
135/135 - 3s - loss: 12.6013 - accuracy10: 0.4715 - accuracy20: 0.4523 - accuracy30: 0.4354 - accuracy50: 0.4229 - val_loss: 13.0468 - val_accuracy10: 0.4335 - val_accuracy20: 0.3963 - val_accuracy30: 0.3866 - val_accuracy50: 0.3754 - 3s/epoch - 20ms/step
Epoch 23/50
135/135 - 3s - loss: 12.5801 - accuracy10: 0.4762 - accuracy20: 0.4524 - accuracy30: 0.4348 - accuracy50: 0.4194 - val_loss: 13.0137 - val_accuracy10: 0.4438 - val_accuracy20: 0.4066 - val_accuracy30: 0.3867 - val_accuracy50: 0.3790 - 3s/epoch - 21ms/step
Epoch 24/50
135/135 - 3s - loss: 12.5492 - accuracy10: 0.4784 - accuracy20: 0.4583 - accuracy30: 0.4386 - accuracy50: 0.4258 - val_loss: 13.0506 - val_accuracy10: 0.4385 - val_accuracy20: 0.4010 - val_accuracy30: 0.3863 - val_accuracy50: 0.3784 - 3s/epoch - 20ms/step
Epoch 25/50
135/135 - 3s - loss: 12.5324 - accuracy10: 0.4817 - accuracy20: 0.4581 - accuracy30: 0.4405 - accuracy50: 0.4262 - val_loss: 13.0496 - val_accuracy10: 0.4334 - val_accuracy20: 0.4001 - val_accuracy30: 0.3881 - val_accuracy50: 0.3744 - 3s/epoch - 20ms/step
Epoch 26/50
135/135 - 3s - loss: 12.5111 - accuracy10: 0.4819 - accuracy20: 0.4603 - accuracy30: 0.4414 - accuracy50: 0.4289 - val_loss: 13.0357 - val_accuracy10: 0.4384 - val_accuracy20: 0.4028 - val_accuracy30: 0.3873 - val_accuracy50: 0.3817 - 3s/epoch - 20ms/step
Epoch 27/50
135/135 - 3s - loss: 12.4805 - accuracy10: 0.4869 - accuracy20: 0.4670 - accuracy30: 0.4477 - accuracy50: 0.4312 - val_loss: 13.0748 - val_accuracy10: 0.4337 - val_accuracy20: 0.4004 - val_accuracy30: 0.3876 - val_accuracy50: 0.3773 - 3s/epoch - 20ms/step
Epoch 28/50
135/135 - 3s - loss: 12.4654 - accuracy10: 0.4868 - accuracy20: 0.4656 - accuracy30: 0.4505 - accuracy50: 0.4343 - val_loss: 13.0497 - val_accuracy10: 0.4391 - val_accuracy20: 0.4033 - val_accuracy30: 0.3920 - val_accuracy50: 0.3860 - 3s/epoch - 21ms/step
Epoch 29/50
135/135 - 3s - loss: 12.4302 - accuracy10: 0.4854 - accuracy20: 0.4683 - accuracy30: 0.4524 - accuracy50: 0.4362 - val_loss: 13.1219 - val_accuracy10: 0.4367 - val_accuracy20: 0.4030 - val_accuracy30: 0.3903 - val_accuracy50: 0.3796 - 3s/epoch - 21ms/step
Epoch 30/50
135/135 - 3s - loss: 12.4040 - accuracy10: 0.4899 - accuracy20: 0.4723 - accuracy30: 0.4557 - accuracy50: 0.4371 - val_loss: 13.0990 - val_accuracy10: 0.4431 - val_accuracy20: 0.4077 - val_accuracy30: 0.3965 - val_accuracy50: 0.3897 - 3s/epoch - 20ms/step
Epoch 31/50
135/135 - 3s - loss: 12.3554 - accuracy10: 0.4944 - accuracy20: 0.4752 - accuracy30: 0.4592 - accuracy50: 0.4426 - val_loss: 13.0912 - val_accuracy10: 0.4400 - val_accuracy20: 0.4089 - val_accuracy30: 0.3932 - val_accuracy50: 0.3783 - 3s/epoch - 21ms/step
Epoch 32/50
135/135 - 3s - loss: 12.3386 - accuracy10: 0.4962 - accuracy20: 0.4783 - accuracy30: 0.4598 - accuracy50: 0.4427 - val_loss: 13.1134 - val_accuracy10: 0.4459 - val_accuracy20: 0.4122 - val_accuracy30: 0.3941 - val_accuracy50: 0.3844 - 3s/epoch - 21ms/step
Epoch 33/50
135/135 - 3s - loss: 12.3071 - accuracy10: 0.5002 - accuracy20: 0.4829 - accuracy30: 0.4653 - accuracy50: 0.4482 - val_loss: 13.1556 - val_accuracy10: 0.4388 - val_accuracy20: 0.4041 - val_accuracy30: 0.3960 - val_accuracy50: 0.3861 - 3s/epoch - 21ms/step
testing model: results/LILAK/W10/deepOF_L1/seq2seq
Evaluating performance on  test set...
518/518 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1066221
{'0': {'precision': 0.46577862569413686, 'recall': 0.2688375019663363, 'f1-score': 0.3409093742597464, 'support': 50856}, '1': {'precision': 0.32148568105829334, 'recall': 0.5061654221383, 'f1-score': 0.39322109240428954, 'support': 34953}, '2': {'precision': 0.41688096225632515, 'recall': 0.4295666296264638, 'f1-score': 0.42312873621284836, 'support': 46796}, 'accuracy': 0.38811507861694505, 'macro avg': {'precision': 0.4013817563362518, 'recall': 0.40152318457703334, 'f1-score': 0.38575306762562805, 'support': 132605}, 'weighted avg': {'precision': 0.4104889582450024, 'recall': 0.38811507861694505, 'f1-score': 0.3837131052371875, 'support': 132605}}
[[13672 19933 17251]
 [ 6394 17692 10867]
 [ 9287 17407 20102]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1129872
{'0': {'precision': 0.47291659600447716, 'recall': 0.26071428571428573, 'f1-score': 0.3361257428010077, 'support': 53480}, '1': {'precision': 0.26356416386401393, 'recall': 0.4360607381088057, 'f1-score': 0.328547435946004, 'support': 29833}, '2': {'precision': 0.41418049252287775, 'recall': 0.451756877383754, 'f1-score': 0.43215339233038347, 'support': 49292}, 'accuracy': 0.3711775574073376, 'macro avg': {'precision': 0.38355375079712295, 'recall': 0.38284396706894847, 'f1-score': 0.36560885702579843, 'support': 132605}, 'weighted avg': {'precision': 0.40398381729431215, 'recall': 0.3711775574073376, 'f1-score': 0.3701162504907378, 'support': 132605}}
[[13943 19170 20367]
 [ 5695 13009 11129]
 [ 9845 17179 22268]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1134764
{'0': {'precision': 0.44360415602112074, 'recall': 0.25208099423129043, 'f1-score': 0.32147926875933497, 'support': 51658}, '1': {'precision': 0.2699435748518545, 'recall': 0.3469895605729546, 'f1-score': 0.30365560557171123, 'support': 32952}, '2': {'precision': 0.3938383722266927, 'recall': 0.49967704969267634, 'f1-score': 0.4404893101168173, 'support': 47995}, 'accuracy': 0.36528034387843594, 'macro avg': {'precision': 0.36912870103322265, 'recall': 0.3662492014989738, 'f1-score': 0.3552080614826212, 'support': 132605}, 'weighted avg': {'precision': 0.38243774250803125, 'recall': 0.36528034387843594, 'f1-score': 0.36012458066758724, 'support': 132605}}
[[13022 16358 22278]
 [ 6885 11434 14633]
 [ 9448 14565 23982]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1166004
{'0': {'precision': 0.4323357413140695, 'recall': 0.2434432262813311, 'f1-score': 0.3114900366808764, 'support': 51626}, '1': {'precision': 0.259240896821462, 'recall': 0.28606163759042, 'f1-score': 0.2719916772627442, 'support': 32902}, '2': {'precision': 0.3869312350325009, 'recall': 0.5410695342887452, 'f1-score': 0.45119941720292095, 'support': 48077}, 'accuracy': 0.3619245126503525, 'macro avg': {'precision': 0.35950262438934416, 'recall': 0.3568581327201654, 'f1-score': 0.34489371038218053, 'support': 132605}, 'weighted avg': {'precision': 0.3729256208661622, 'recall': 0.3619245126503525, 'f1-score': 0.3523424394242341, 'support': 132605}}
[[12568 14201 24857]
 [ 7131  9412 16359]
 [ 9371 12693 26013]]
Evaluating performance on  train set...
135/135 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0311549
{'0': {'precision': 0.5243686006825938, 'recall': 0.3430689531975706, 'f1-score': 0.4147724204956536, 'support': 11196}, '1': {'precision': 0.4504739662041489, 'recall': 0.5699634973057536, 'f1-score': 0.5032228360957643, 'support': 11506}, '2': {'precision': 0.46341855603794824, 'recall': 0.4960840003442637, 'f1-score': 0.4791952446273434, 'support': 11619}, 'accuracy': 0.47093616153375484, 'macro avg': {'precision': 0.47942037430823037, 'recall': 0.46970548361586256, 'f1-score': 0.4657301670729204, 'support': 34321}, 'weighted avg': {'precision': 0.47896170015419653, 'recall': 0.47093616153375484, 'f1-score': 0.4662347693631394, 'support': 34321}}
[[3841 3884 3471]
 [1745 6558 3203]
 [1739 4116 5764]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0534999
{'0': {'precision': 0.5078209277238404, 'recall': 0.3281059418017076, 'f1-score': 0.3986450725097915, 'support': 11478}, '1': {'precision': 0.4204450520239994, 'recall': 0.4835779175401817, 'f1-score': 0.4498070282348162, 'support': 11448}, '2': {'precision': 0.42713640995778135, 'recall': 0.5149627029398859, 'f1-score': 0.4669557951696972, 'support': 11395}, 'accuracy': 0.44200343812825965, 'macro avg': {'precision': 0.4518007965685404, 'recall': 0.44221552076059173, 'f1-score': 0.43846929863810163, 'support': 34321}, 'weighted avg': {'precision': 0.4518878516201132, 'recall': 0.44200343812825965, 'f1-score': 0.43839049816317305, 'support': 34321}}
[[3766 3814 3898]
 [1940 5536 3972]
 [1710 3817 5868]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0632838
{'0': {'precision': 0.489238082662089, 'recall': 0.3222299530353105, 'f1-score': 0.3885480572597137, 'support': 11498}, '1': {'precision': 0.4016770354341358, 'recall': 0.39178612259256, 'f1-score': 0.3966699314397649, 'support': 11371}, '2': {'precision': 0.4114453599029188, 'recall': 0.5625218302479916, 'f1-score': 0.4752665166549855, 'support': 11452}, 'accuracy': 0.42545380379359576, 'macro avg': {'precision': 0.4341201593330479, 'recall': 0.42551263529195404, 'f1-score': 0.4201615017848213, 'support': 34321}, 'weighted avg': {'precision': 0.43427060126390504, 'recall': 0.42545380379359576, 'f1-score': 0.4201745724631173, 'support': 34321}}
[[3705 3393 4400]
 [2101 4455 4815]
 [1767 3243 6442]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0718522
{'0': {'precision': 0.4679604063558218, 'recall': 0.31019597686264355, 'f1-score': 0.37308550957894193, 'support': 11583}, '1': {'precision': 0.3883463184461758, 'recall': 0.3170294723640598, 'f1-score': 0.3490826593016374, 'support': 11163}, '2': {'precision': 0.39806046776953796, 'recall': 0.6028509719222462, 'f1-score': 0.4795052396495448, 'support': 11575}, 'accuracy': 0.4111185571515982, 'macro avg': {'precision': 0.4181223975238451, 'recall': 0.4100254737163165, 'f1-score': 0.4005578028433747, 'support': 34321}, 'weighted avg': {'precision': 0.4184914557870268, 'recall': 0.4111185571515982, 'f1-score': 0.40116932292708674, 'support': 34321}}
[[3593 2842 5148]
 [2220 3539 5404]
 [1865 2732 6978]]
Evaluating performance on  val set...
46/46 - 0s - 413ms/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0620339
{'0': {'precision': 0.4670977558006847, 'recall': 0.32452431289640593, 'f1-score': 0.38297208794635895, 'support': 3784}, '1': {'precision': 0.4422731804586241, 'recall': 0.5436274509803921, 'f1-score': 0.48774051676745467, 'support': 4080}, '2': {'precision': 0.41654284299158, 'recall': 0.4405447878470403, 'f1-score': 0.42820773930753564, 'support': 3818}, 'accuracy': 0.43896593049135424, 'macro avg': {'precision': 0.4419712597502963, 'recall': 0.43623218390794616, 'f1-score': 0.4329734480071164, 'support': 11682}, 'weighted avg': {'precision': 0.4419049014520484, 'recall': 0.43896593049135424, 'f1-score': 0.4343472725454895, 'support': 11682}}
[[1228 1343 1213]
 [ 719 2218 1143]
 [ 682 1454 1682]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0841051
{'0': {'precision': 0.4453096032628847, 'recall': 0.2996506986027944, 'f1-score': 0.35824011931394484, 'support': 4008}, '1': {'precision': 0.38506261180679785, 'recall': 0.4578569529380484, 'f1-score': 0.41831653103364513, 'support': 3761}, '2': {'precision': 0.4043873255040993, 'recall': 0.46639407104523384, 'f1-score': 0.4331830049845715, 'support': 3913}, 'accuracy': 0.406437253894881, 'macro avg': {'precision': 0.41158651352459397, 'recall': 0.40796724086202557, 'f1-score': 0.40324655177738716, 'support': 11682}, 'weighted avg': {'precision': 0.41220587036299855, 'recall': 0.406437253894881, 'f1-score': 0.40268446926317913, 'support': 11682}}
[[1201 1395 1412]
 [ 763 1722 1276]
 [ 733 1355 1825]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0907648
{'0': {'precision': 0.4179856115107914, 'recall': 0.29042739315171207, 'f1-score': 0.3427223123433122, 'support': 4001}, '1': {'precision': 0.37642384105960264, 'recall': 0.37034141256189734, 'f1-score': 0.37335785601681554, 'support': 3837}, '2': {'precision': 0.3822898381119563, 'recall': 0.5098855359001041, 'f1-score': 0.43696354921413444, 'support': 3844}, 'accuracy': 0.3888888888888889, 'macro avg': {'precision': 0.3922330968941168, 'recall': 0.3902181138712379, 'f1-score': 0.38434790585808737, 'support': 11682}, 'weighted avg': {'precision': 0.392588670390578, 'recall': 0.3888888888888889, 'f1-score': 0.383795064920497, 'support': 11682}}
[[1162 1232 1607]
 [ 856 1421 1560]
 [ 762 1122 1960]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0957725
{'0': {'precision': 0.4124113475177305, 'recall': 0.2890159045725646, 'f1-score': 0.33985973115137347, 'support': 4024}, '1': {'precision': 0.37209302325581395, 'recall': 0.3050039714058777, 'f1-score': 0.3352247926669577, 'support': 3777}, '2': {'precision': 0.3792924037460978, 'recall': 0.5635145581035815, 'f1-score': 0.45340520369026643, 'support': 3881}, 'accuracy': 0.3853792158876905, 'macro avg': {'precision': 0.3879322581732141, 'recall': 0.38584481136067456, 'f1-score': 0.37616324250286587, 'support': 11682}, 'weighted avg': {'precision': 0.38837291818071923, 'recall': 0.3853792158876905, 'f1-score': 0.3760833072742809, 'support': 11682}}
[[1163 1032 1829]
 [ 875 1152 1750]
 [ 782  912 2187]]
training model: results/LILAK/W10/deepLOB_L2/seq2seq
Epoch 1/50
135/135 - 12s - loss: 13.4030 - accuracy10: 0.3452 - accuracy20: 0.3480 - accuracy30: 0.3476 - accuracy50: 0.3469 - val_loss: 13.5030 - val_accuracy10: 0.3302 - val_accuracy20: 0.3314 - val_accuracy30: 0.3389 - val_accuracy50: 0.3416 - 12s/epoch - 90ms/step
Epoch 2/50
135/135 - 7s - loss: 13.2409 - accuracy10: 0.3620 - accuracy20: 0.3598 - accuracy30: 0.3584 - accuracy50: 0.3559 - val_loss: 13.4741 - val_accuracy10: 0.3395 - val_accuracy20: 0.3534 - val_accuracy30: 0.3428 - val_accuracy50: 0.3515 - 7s/epoch - 50ms/step
Epoch 3/50
135/135 - 7s - loss: 13.1608 - accuracy10: 0.3716 - accuracy20: 0.3765 - accuracy30: 0.3718 - accuracy50: 0.3697 - val_loss: 13.2359 - val_accuracy10: 0.3611 - val_accuracy20: 0.3731 - val_accuracy30: 0.3618 - val_accuracy50: 0.3546 - 7s/epoch - 50ms/step
Epoch 4/50
135/135 - 7s - loss: 13.0665 - accuracy10: 0.3927 - accuracy20: 0.3903 - accuracy30: 0.3866 - accuracy50: 0.3810 - val_loss: 13.1993 - val_accuracy10: 0.3676 - val_accuracy20: 0.3828 - val_accuracy30: 0.3701 - val_accuracy50: 0.3666 - 7s/epoch - 50ms/step
Epoch 5/50
135/135 - 7s - loss: 12.8861 - accuracy10: 0.4250 - accuracy20: 0.4196 - accuracy30: 0.4140 - accuracy50: 0.4025 - val_loss: 13.1923 - val_accuracy10: 0.3783 - val_accuracy20: 0.3931 - val_accuracy30: 0.3798 - val_accuracy50: 0.3750 - 7s/epoch - 50ms/step
Epoch 6/50
135/135 - 7s - loss: 12.7945 - accuracy10: 0.4423 - accuracy20: 0.4352 - accuracy30: 0.4262 - accuracy50: 0.4106 - val_loss: 13.1473 - val_accuracy10: 0.3835 - val_accuracy20: 0.3891 - val_accuracy30: 0.3776 - val_accuracy50: 0.3732 - 7s/epoch - 50ms/step
Epoch 7/50
135/135 - 7s - loss: 12.6528 - accuracy10: 0.4609 - accuracy20: 0.4519 - accuracy30: 0.4376 - accuracy50: 0.4174 - val_loss: 13.0905 - val_accuracy10: 0.3966 - val_accuracy20: 0.4064 - val_accuracy30: 0.3956 - val_accuracy50: 0.3920 - 7s/epoch - 50ms/step
Epoch 8/50
135/135 - 7s - loss: 12.5510 - accuracy10: 0.4747 - accuracy20: 0.4621 - accuracy30: 0.4455 - accuracy50: 0.4197 - val_loss: 13.1904 - val_accuracy10: 0.3972 - val_accuracy20: 0.4098 - val_accuracy30: 0.3921 - val_accuracy50: 0.3844 - 7s/epoch - 50ms/step
Epoch 9/50
135/135 - 7s - loss: 12.4586 - accuracy10: 0.4878 - accuracy20: 0.4716 - accuracy30: 0.4535 - accuracy50: 0.4313 - val_loss: 13.2106 - val_accuracy10: 0.3890 - val_accuracy20: 0.4067 - val_accuracy30: 0.3918 - val_accuracy50: 0.3867 - 7s/epoch - 50ms/step
Epoch 10/50
135/135 - 7s - loss: 12.4099 - accuracy10: 0.4949 - accuracy20: 0.4785 - accuracy30: 0.4600 - accuracy50: 0.4356 - val_loss: 13.1104 - val_accuracy10: 0.4058 - val_accuracy20: 0.4123 - val_accuracy30: 0.3939 - val_accuracy50: 0.3857 - 7s/epoch - 50ms/step
Epoch 11/50
135/135 - 7s - loss: 12.3165 - accuracy10: 0.5058 - accuracy20: 0.4880 - accuracy30: 0.4664 - accuracy50: 0.4409 - val_loss: 13.1499 - val_accuracy10: 0.4078 - val_accuracy20: 0.4054 - val_accuracy30: 0.3933 - val_accuracy50: 0.3866 - 7s/epoch - 50ms/step
Epoch 12/50
135/135 - 7s - loss: 12.2244 - accuracy10: 0.5142 - accuracy20: 0.4937 - accuracy30: 0.4738 - accuracy50: 0.4442 - val_loss: 13.1454 - val_accuracy10: 0.4133 - val_accuracy20: 0.4127 - val_accuracy30: 0.3987 - val_accuracy50: 0.3893 - 7s/epoch - 49ms/step
Epoch 13/50
135/135 - 6s - loss: 12.1690 - accuracy10: 0.5190 - accuracy20: 0.4969 - accuracy30: 0.4781 - accuracy50: 0.4500 - val_loss: 13.1207 - val_accuracy10: 0.4147 - val_accuracy20: 0.4122 - val_accuracy30: 0.4005 - val_accuracy50: 0.3830 - 6s/epoch - 48ms/step
Epoch 14/50
135/135 - 6s - loss: 12.0896 - accuracy10: 0.5247 - accuracy20: 0.5038 - accuracy30: 0.4824 - accuracy50: 0.4553 - val_loss: 13.1649 - val_accuracy10: 0.4149 - val_accuracy20: 0.4172 - val_accuracy30: 0.4032 - val_accuracy50: 0.3896 - 6s/epoch - 47ms/step
Epoch 15/50
135/135 - 6s - loss: 12.0080 - accuracy10: 0.5327 - accuracy20: 0.5128 - accuracy30: 0.4905 - accuracy50: 0.4636 - val_loss: 13.2686 - val_accuracy10: 0.4116 - val_accuracy20: 0.4130 - val_accuracy30: 0.4011 - val_accuracy50: 0.3862 - 6s/epoch - 47ms/step
Epoch 16/50
135/135 - 6s - loss: 11.9075 - accuracy10: 0.5360 - accuracy20: 0.5169 - accuracy30: 0.4965 - accuracy50: 0.4689 - val_loss: 13.4227 - val_accuracy10: 0.4048 - val_accuracy20: 0.4105 - val_accuracy30: 0.3980 - val_accuracy50: 0.3846 - 6s/epoch - 47ms/step
Epoch 17/50
135/135 - 6s - loss: 11.8139 - accuracy10: 0.5435 - accuracy20: 0.5252 - accuracy30: 0.5074 - accuracy50: 0.4783 - val_loss: 13.4922 - val_accuracy10: 0.3981 - val_accuracy20: 0.3998 - val_accuracy30: 0.3873 - val_accuracy50: 0.3812 - 6s/epoch - 47ms/step
testing model: results/LILAK/W10/deepLOB_L2/seq2seq
Evaluating performance on  test set...
519/519 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0913829
{'0': {'precision': 0.5201165766278077, 'recall': 0.28775365738555925, 'f1-score': 0.370518533522382, 'support': 50856}, '1': {'precision': 0.3693731594446782, 'recall': 0.10047203547418108, 'f1-score': 0.1579740458358635, 'support': 34955}, '2': {'precision': 0.38701219383779456, 'recall': 0.7853372935319131, 'f1-score': 0.5185059782033647, 'support': 46799}, 'accuracy': 0.41398838699947216, 'macro avg': {'precision': 0.4255006433034268, 'recall': 0.3911876621305512, 'f1-score': 0.34899951918720346, 'support': 132610}, 'weighted avg': {'precision': 0.4334082728963688, 'recall': 0.41398838699947216, 'f1-score': 0.3667192111224352, 'support': 132610}}
[[14634  3105 33117]
 [ 6347  3512 25096]
 [ 7155  2891 36753]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0879096
{'0': {'precision': 0.5284094959720539, 'recall': 0.2771877337322364, 'f1-score': 0.363627443765791, 'support': 53480}, '1': {'precision': 0.29783457578984734, 'recall': 0.08436400201106084, 'f1-score': 0.13148409340228806, 'support': 29835}, '2': {'precision': 0.4005306695801467, 'recall': 0.7808702708185414, 'f1-score': 0.5294773039889958, 'support': 49295}, 'accuracy': 0.4210391373199608, 'macro avg': {'precision': 0.4089249137806827, 'recall': 0.3808073355206129, 'f1-score': 0.34152961371902496, 'support': 132610}, 'weighted avg': {'precision': 0.42899776615812435, 'recall': 0.4210391373199608, 'f1-score': 0.37305035306077455, 'support': 132610}}
[[14824  2983 35673]
 [ 5379  2517 21939]
 [ 7851  2951 38493]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.098338
{'0': {'precision': 0.496152595643221, 'recall': 0.2658639513724883, 'f1-score': 0.34621056479159057, 'support': 51658}, '1': {'precision': 0.29022879534824925, 'recall': 0.06967499165478105, 'f1-score': 0.11237274862960063, 'support': 32953}, '2': {'precision': 0.38656744109340535, 'recall': 0.7813496114502385, 'f1-score': 0.5172359102725888, 'support': 47999}, 'accuracy': 0.4036950456225021, 'macro avg': {'precision': 0.39098294402829187, 'recall': 0.37229618482583593, 'f1-score': 0.3252730745645933, 'support': 132610}, 'weighted avg': {'precision': 0.4053164232251771, 'recall': 0.4036950456225021, 'f1-score': 0.3500065681228354, 'support': 132610}}
[[13734  2792 35132]
 [ 6275  2296 24382]
 [ 7672  2823 37504]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1046134
{'0': {'precision': 0.46622071106511936, 'recall': 0.24434888721018072, 'f1-score': 0.3206456122513821, 'support': 51627}, '1': {'precision': 0.28848390849166344, 'recall': 0.06783575965717412, 'f1-score': 0.10984251968503937, 'support': 32903}, '2': {'precision': 0.3840617492204672, 'recall': 0.7813435940099833, 'f1-score': 0.5149868055793551, 'support': 48080}, 'accuracy': 0.39524922705678306, 'macro avg': {'precision': 0.37958878959241665, 'recall': 0.3645094136257794, 'f1-score': 0.31515831250525883, 'support': 132610}, 'weighted avg': {'precision': 0.3923327923518602, 'recall': 0.39524922705678306, 'f1-score': 0.33880314502039327, 'support': 132610}}
[[12615  2785 36227]
 [ 6650  2232 24021]
 [ 7793  2720 37567]]
Evaluating performance on  train set...
135/135 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0431672
{'0': {'precision': 0.47112822031388807, 'recall': 0.42918802265983275, 'f1-score': 0.44918125352907967, 'support': 11121}, '1': {'precision': 0.4714892665474061, 'recall': 0.3662179765523231, 'f1-score': 0.41223911237108357, 'support': 11515}, '2': {'precision': 0.43513903462749215, 'recall': 0.5677248224522974, 'f1-score': 0.49266753294969373, 'support': 11687}, 'accuracy': 0.45523409958336974, 'macro avg': {'precision': 0.45925217382959543, 'recall': 0.45437694055481775, 'f1-score': 0.4513626329499523, 'support': 34323}, 'weighted avg': {'precision': 0.458995010345705, 'recall': 0.45523409958336974, 'f1-score': 0.45159466121938624, 'support': 34323}}
[[4773 2187 4161]
 [2846 4217 4452]
 [2512 2540 6635]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0503827
{'0': {'precision': 0.4718673817649927, 'recall': 0.4236931967428421, 'f1-score': 0.4464845912529987, 'support': 11421}, '1': {'precision': 0.46230866612958915, 'recall': 0.35178211752342586, 'f1-score': 0.3995424706584444, 'support': 11419}, '2': {'precision': 0.423564601079394, 'recall': 0.5672733606200471, 'f1-score': 0.4849973940883032, 'support': 11483}, 'accuracy': 0.4478046790781692, 'macro avg': {'precision': 0.4525802163246586, 'recall': 0.4475828916287717, 'f1-score': 0.44367481866658215, 'support': 34323}, 'weighted avg': {'precision': 0.4525272365430307, 'recall': 0.4478046790781692, 'f1-score': 0.44375203407234975, 'support': 34323}}
[[4839 2233 4349]
 [2886 4017 4516]
 [2530 2439 6514]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0627456
{'0': {'precision': 0.45758429695850744, 'recall': 0.41126637554585155, 'f1-score': 0.4331907455958788, 'support': 11450}, '1': {'precision': 0.4372583479789104, 'recall': 0.3277421621146922, 'f1-score': 0.3746611785965265, 'support': 11387}, '2': {'precision': 0.4076272826998774, 'recall': 0.5499738812467352, 'f1-score': 0.46822073157173033, 'support': 11486}, 'accuracy': 0.42997406986568776, 'macro avg': {'precision': 0.4341566425457651, 'recall': 0.4296608063024263, 'f1-score': 0.42535755192137853, 'support': 34323}, 'weighted avg': {'precision': 0.4341231237858449, 'recall': 0.42997406986568776, 'f1-score': 0.42549556275920963, 'support': 34323}}
[[4709 2329 4412]
 [2887 3732 4768]
 [2695 2474 6317]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0771494
{'0': {'precision': 0.4396720031237798, 'recall': 0.3896530841768319, 'f1-score': 0.41315415309819753, 'support': 11559}, '1': {'precision': 0.40146071386500176, 'recall': 0.306805905653583, 'f1-score': 0.3478083380109201, 'support': 11108}, '2': {'precision': 0.3983322642719692, 'recall': 0.5327728208647907, 'f1-score': 0.4558467297951993, 'support': 11656}, 'accuracy': 0.41144422107624623, 'macro avg': {'precision': 0.4131549937535836, 'recall': 0.4097439368984019, 'f1-score': 0.40560307363477227, 'support': 34323}, 'weighted avg': {'precision': 0.4132667647371816, 'recall': 0.41144422107624623, 'f1-score': 0.40650448261457944, 'support': 34323}}
[[4504 2499 4556]
 [2876 3408 4824]
 [2864 2582 6210]]
Evaluating performance on  val set...
46/46 - 1s - 809ms/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0905184
{'0': {'precision': 0.40420769919427035, 'recall': 0.4772727272727273, 'f1-score': 0.43771206980126026, 'support': 3784}, '1': {'precision': 0.3701527614571093, 'recall': 0.23110785033015407, 'f1-score': 0.2845528455284553, 'support': 4089}, '2': {'precision': 0.3994850890366874, 'recall': 0.48884221580467313, 'f1-score': 0.43966942148760335, 'support': 3809}, 'accuracy': 0.3948810135250813, 'macro avg': {'precision': 0.3912818498960224, 'recall': 0.39907426446918476, 'f1-score': 0.38731144560577296, 'support': 11682}, 'weighted avg': {'precision': 0.39074775547765633, 'recall': 0.3948810135250813, 'f1-score': 0.3847406166700997, 'support': 11682}}
[[1806  753 1225]
 [1570  945 1574]
 [1092  855 1862]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0855832
{'0': {'precision': 0.4194255645691734, 'recall': 0.47872872872872874, 'f1-score': 0.4471193175178217, 'support': 3996}, '1': {'precision': 0.36318407960199006, 'recall': 0.23322683706070288, 'f1-score': 0.2840466926070039, 'support': 3756}, '2': {'precision': 0.40751751964323635, 'recall': 0.48829516539440204, 'f1-score': 0.44426438245167266, 'support': 3930}, 'accuracy': 0.4030131826741996, 'macro avg': {'precision': 0.39670905460479994, 'recall': 0.4000835770612779, 'f1-score': 0.3918101308588328, 'support': 11682}, 'weighted avg': {'precision': 0.39733674124305857, 'recall': 0.4030131826741996, 'f1-score': 0.39372771728027695, 'support': 11682}}
[[1913  741 1342]
 [1432  876 1448]
 [1216  795 1919]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0930966
{'0': {'precision': 0.4181858115528223, 'recall': 0.47540574282147313, 'f1-score': 0.4449637765833138, 'support': 4005}, '1': {'precision': 0.3477523324851569, 'recall': 0.2153926976622012, 'f1-score': 0.2660178426601784, 'support': 3807}, '2': {'precision': 0.38545378327394675, 'recall': 0.4751937984496124, 'f1-score': 0.4256451799560236, 'support': 3870}, 'accuracy': 0.39060092449922956, 'macro avg': {'precision': 0.3837973091039753, 'recall': 0.3886640796444289, 'f1-score': 0.3788755997331719, 'support': 11682}, 'weighted avg': {'precision': 0.38438909829739937, 'recall': 0.39060092449922956, 'f1-score': 0.38024796256234233, 'support': 11682}}
[[1904  756 1345]
 [1400  820 1587]
 [1249  782 1839]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0963687
{'0': {'precision': 0.41383119752540876, 'recall': 0.4683670917729432, 'f1-score': 0.43941348973607036, 'support': 3999}, '1': {'precision': 0.3466101694915254, 'recall': 0.21697612732095492, 'f1-score': 0.266884176182708, 'support': 3770}, '2': {'precision': 0.378023352793995, 'recall': 0.46332737030411447, 'f1-score': 0.4163509013664026, 'support': 3913}, 'accuracy': 0.38555041944872454, 'macro avg': {'precision': 0.37948823993697633, 'recall': 0.38289019646600425, 'f1-score': 0.3742161890950603, 'support': 11682}, 'weighted avg': {'precision': 0.38014352656823, 'recall': 0.38555041944872454, 'f1-score': 0.3760100125586448, 'support': 11682}}
[[1873  735 1391]
 [1360  818 1592]
 [1293  807 1813]]
training model: results/LILAK/W10/deepOF_L2/seq2seq
Epoch 1/50
135/135 - 10s - loss: 13.1580 - accuracy10: 0.4078 - accuracy20: 0.3911 - accuracy30: 0.3717 - accuracy50: 0.3535 - val_loss: 13.0566 - val_accuracy10: 0.4515 - val_accuracy20: 0.4083 - val_accuracy30: 0.3816 - val_accuracy50: 0.3573 - 10s/epoch - 72ms/step
Epoch 2/50
135/135 - 4s - loss: 12.9008 - accuracy10: 0.4644 - accuracy20: 0.4270 - accuracy30: 0.3948 - accuracy50: 0.3670 - val_loss: 12.9621 - val_accuracy10: 0.4708 - val_accuracy20: 0.4244 - val_accuracy30: 0.3934 - val_accuracy50: 0.3606 - 4s/epoch - 30ms/step
Epoch 3/50
135/135 - 4s - loss: 12.7170 - accuracy10: 0.4900 - accuracy20: 0.4461 - accuracy30: 0.4154 - accuracy50: 0.3846 - val_loss: 12.8295 - val_accuracy10: 0.4895 - val_accuracy20: 0.4401 - val_accuracy30: 0.4066 - val_accuracy50: 0.3777 - 4s/epoch - 30ms/step
Epoch 4/50
135/135 - 4s - loss: 12.5774 - accuracy10: 0.5097 - accuracy20: 0.4667 - accuracy30: 0.4305 - accuracy50: 0.3999 - val_loss: 12.7793 - val_accuracy10: 0.4981 - val_accuracy20: 0.4461 - val_accuracy30: 0.4117 - val_accuracy50: 0.3789 - 4s/epoch - 30ms/step
Epoch 5/50
135/135 - 4s - loss: 12.4913 - accuracy10: 0.5166 - accuracy20: 0.4713 - accuracy30: 0.4378 - accuracy50: 0.4080 - val_loss: 12.7040 - val_accuracy10: 0.5023 - val_accuracy20: 0.4499 - val_accuracy30: 0.4129 - val_accuracy50: 0.3783 - 4s/epoch - 31ms/step
Epoch 6/50
135/135 - 4s - loss: 12.4108 - accuracy10: 0.5257 - accuracy20: 0.4822 - accuracy30: 0.4462 - accuracy50: 0.4177 - val_loss: 12.6929 - val_accuracy10: 0.5071 - val_accuracy20: 0.4555 - val_accuracy30: 0.4165 - val_accuracy50: 0.3862 - 4s/epoch - 31ms/step
Epoch 7/50
135/135 - 4s - loss: 12.3235 - accuracy10: 0.5345 - accuracy20: 0.4895 - accuracy30: 0.4552 - accuracy50: 0.4226 - val_loss: 12.6749 - val_accuracy10: 0.5080 - val_accuracy20: 0.4555 - val_accuracy30: 0.4218 - val_accuracy50: 0.3897 - 4s/epoch - 30ms/step
Epoch 8/50
135/135 - 4s - loss: 12.2613 - accuracy10: 0.5355 - accuracy20: 0.4911 - accuracy30: 0.4572 - accuracy50: 0.4254 - val_loss: 12.6532 - val_accuracy10: 0.5086 - val_accuracy20: 0.4566 - val_accuracy30: 0.4252 - val_accuracy50: 0.3943 - 4s/epoch - 30ms/step
Epoch 9/50
135/135 - 4s - loss: 12.1948 - accuracy10: 0.5421 - accuracy20: 0.4983 - accuracy30: 0.4658 - accuracy50: 0.4337 - val_loss: 12.6917 - val_accuracy10: 0.5100 - val_accuracy20: 0.4554 - val_accuracy30: 0.4206 - val_accuracy50: 0.3906 - 4s/epoch - 29ms/step
Epoch 10/50
135/135 - 4s - loss: 12.1466 - accuracy10: 0.5460 - accuracy20: 0.5018 - accuracy30: 0.4692 - accuracy50: 0.4372 - val_loss: 12.6519 - val_accuracy10: 0.5116 - val_accuracy20: 0.4622 - val_accuracy30: 0.4244 - val_accuracy50: 0.3976 - 4s/epoch - 30ms/step
Epoch 11/50
135/135 - 4s - loss: 12.0682 - accuracy10: 0.5525 - accuracy20: 0.5096 - accuracy30: 0.4765 - accuracy50: 0.4432 - val_loss: 12.6417 - val_accuracy10: 0.5076 - val_accuracy20: 0.4527 - val_accuracy30: 0.4213 - val_accuracy50: 0.3962 - 4s/epoch - 30ms/step
Epoch 12/50
135/135 - 4s - loss: 11.9818 - accuracy10: 0.5559 - accuracy20: 0.5137 - accuracy30: 0.4825 - accuracy50: 0.4520 - val_loss: 12.6388 - val_accuracy10: 0.5033 - val_accuracy20: 0.4569 - val_accuracy30: 0.4243 - val_accuracy50: 0.3956 - 4s/epoch - 31ms/step
Epoch 13/50
135/135 - 4s - loss: 11.9311 - accuracy10: 0.5619 - accuracy20: 0.5221 - accuracy30: 0.4864 - accuracy50: 0.4518 - val_loss: 12.6896 - val_accuracy10: 0.5052 - val_accuracy20: 0.4529 - val_accuracy30: 0.4235 - val_accuracy50: 0.3983 - 4s/epoch - 30ms/step
Epoch 14/50
135/135 - 4s - loss: 11.8443 - accuracy10: 0.5643 - accuracy20: 0.5273 - accuracy30: 0.4972 - accuracy50: 0.4635 - val_loss: 12.7441 - val_accuracy10: 0.5042 - val_accuracy20: 0.4504 - val_accuracy30: 0.4229 - val_accuracy50: 0.3947 - 4s/epoch - 30ms/step
Epoch 15/50
135/135 - 4s - loss: 11.7816 - accuracy10: 0.5647 - accuracy20: 0.5296 - accuracy30: 0.5004 - accuracy50: 0.4676 - val_loss: 12.6475 - val_accuracy10: 0.5027 - val_accuracy20: 0.4579 - val_accuracy30: 0.4311 - val_accuracy50: 0.4045 - 4s/epoch - 29ms/step
Epoch 16/50
135/135 - 4s - loss: 11.7169 - accuracy10: 0.5699 - accuracy20: 0.5372 - accuracy30: 0.5102 - accuracy50: 0.4725 - val_loss: 12.7903 - val_accuracy10: 0.5022 - val_accuracy20: 0.4523 - val_accuracy30: 0.4220 - val_accuracy50: 0.3961 - 4s/epoch - 30ms/step
Epoch 17/50
135/135 - 4s - loss: 11.6402 - accuracy10: 0.5725 - accuracy20: 0.5422 - accuracy30: 0.5139 - accuracy50: 0.4804 - val_loss: 12.9290 - val_accuracy10: 0.4926 - val_accuracy20: 0.4460 - val_accuracy30: 0.4236 - val_accuracy50: 0.3972 - 4s/epoch - 30ms/step
Epoch 18/50
135/135 - 4s - loss: 11.5786 - accuracy10: 0.5748 - accuracy20: 0.5465 - accuracy30: 0.5183 - accuracy50: 0.4870 - val_loss: 12.8588 - val_accuracy10: 0.4963 - val_accuracy20: 0.4480 - val_accuracy30: 0.4224 - val_accuracy50: 0.3961 - 4s/epoch - 30ms/step
Epoch 19/50
135/135 - 4s - loss: 11.4833 - accuracy10: 0.5794 - accuracy20: 0.5500 - accuracy30: 0.5255 - accuracy50: 0.4949 - val_loss: 12.9342 - val_accuracy10: 0.4934 - val_accuracy20: 0.4455 - val_accuracy30: 0.4188 - val_accuracy50: 0.4020 - 4s/epoch - 30ms/step
Epoch 20/50
135/135 - 4s - loss: 11.4176 - accuracy10: 0.5793 - accuracy20: 0.5543 - accuracy30: 0.5319 - accuracy50: 0.5010 - val_loss: 13.0187 - val_accuracy10: 0.4854 - val_accuracy20: 0.4403 - val_accuracy30: 0.4115 - val_accuracy50: 0.3999 - 4s/epoch - 29ms/step
Epoch 21/50
135/135 - 4s - loss: 11.3546 - accuracy10: 0.5829 - accuracy20: 0.5605 - accuracy30: 0.5368 - accuracy50: 0.5035 - val_loss: 13.0493 - val_accuracy10: 0.4909 - val_accuracy20: 0.4423 - val_accuracy30: 0.4166 - val_accuracy50: 0.4029 - 4s/epoch - 29ms/step
Epoch 22/50
135/135 - 4s - loss: 11.2311 - accuracy10: 0.5864 - accuracy20: 0.5643 - accuracy30: 0.5444 - accuracy50: 0.5152 - val_loss: 13.1815 - val_accuracy10: 0.4816 - val_accuracy20: 0.4363 - val_accuracy30: 0.4153 - val_accuracy50: 0.3939 - 4s/epoch - 29ms/step
testing model: results/LILAK/W10/deepOF_L2/seq2seq
Evaluating performance on  test set...
518/518 - 6s - 6s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0418909
{'0': {'precision': 0.5281886878864209, 'recall': 0.4535551360704735, 'f1-score': 0.48803503797896874, 'support': 50856}, '1': {'precision': 0.4217002237136465, 'recall': 0.4745801504877979, 'f1-score': 0.44658024741213365, 'support': 34953}, '2': {'precision': 0.4860581866569891, 'recall': 0.5151722369433285, 'f1-score': 0.5001919186679807, 'support': 46796}, 'accuracy': 0.4808415972248407, 'macro avg': {'precision': 0.4786490327523522, 'recall': 0.4811025078338666, 'f1-score': 0.4782690680196944, 'support': 132605}, 'weighted avg': {'precision': 0.48525191910874677, 'recall': 0.4808415972248407, 'f1-score': 0.4813982150389621, 'support': 132605}}
[[23066 12531 15259]
 [ 8133 16588 10232]
 [12471 10217 24108]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0726233
{'0': {'precision': 0.5192298960177996, 'recall': 0.4276364996260284, 'f1-score': 0.4690031376248385, 'support': 53480}, '1': {'precision': 0.32834350455652556, 'recall': 0.4021720913082828, 'f1-score': 0.3615271039865008, 'support': 29833}, '2': {'precision': 0.46778038371333003, 'recall': 0.49365008520652437, 'f1-score': 0.4803671898134439, 'support': 49292}, 'accuracy': 0.44644621243542854, 'macro avg': {'precision': 0.4384512614292184, 'recall': 0.4411528920469452, 'f1-score': 0.4369658104749277, 'support': 132605}, 'weighted avg': {'precision': 0.45716011677134505, 'recall': 0.44644621243542854, 'f1-score': 0.4490478142882237, 'support': 132605}}
[[22870 12953 17657]
 [ 7807 11998 10028]
 [13369 11590 24333]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.092537
{'0': {'precision': 0.4764998266096405, 'recall': 0.39898950791745713, 'f1-score': 0.43431352923203353, 'support': 51658}, '1': {'precision': 0.30645902769796574, 'recall': 0.3236829327506676, 'f1-score': 0.31483558651632326, 'support': 32952}, '2': {'precision': 0.4288857111428886, 'recall': 0.4874257735180748, 'f1-score': 0.4562857783715782, 'support': 47995}, 'accuracy': 0.41228460465291655, 'macro avg': {'precision': 0.4039481884834983, 'recall': 0.40336607139539987, 'f1-score': 0.4018116313733116, 'support': 132605}, 'weighted avg': {'precision': 0.41701169360135076, 'recall': 0.41228460465291655, 'f1-score': 0.41257619601748174, 'support': 132605}}
[[20611 12447 18600]
 [ 9734 10666 12552]
 [12910 11691 23394]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1093961
{'0': {'precision': 0.4535335860795178, 'recall': 0.3614845233022121, 'f1-score': 0.40231099230387823, 'support': 51626}, '1': {'precision': 0.2762624184351302, 'recall': 0.28566652483131727, 'f1-score': 0.28088578088578087, 'support': 32902}, '2': {'precision': 0.40691216157395316, 'recall': 0.48611602221436445, 'f1-score': 0.44300174387747365, 'support': 48077}, 'accuracy': 0.387858678028732, 'macro avg': {'precision': 0.37890272202953373, 'recall': 0.3777556901159646, 'f1-score': 0.37539950568904423, 'support': 132605}, 'weighted avg': {'precision': 0.39264603143384325, 'recall': 0.387858678028732, 'f1-score': 0.3869356818504678, 'support': 132605}}
[[18662 12627 20337]
 [ 9776  9399 13727]
 [12710 11996 23371]]
Evaluating performance on  train set...
135/135 - 2s - 2s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9362367
{'0': {'precision': 0.5928997673712957, 'recall': 0.5235798499464094, 'f1-score': 0.5560878432860599, 'support': 11196}, '1': {'precision': 0.5356466876971608, 'recall': 0.5903007126716495, 'f1-score': 0.5616472339369883, 'support': 11506}, '2': {'precision': 0.5573421813850604, 'recall': 0.5638178844995266, 'f1-score': 0.5605613314508193, 'support': 11619}, 'accuracy': 0.5595699426007401, 'macro avg': {'precision': 0.5619628788178389, 'recall': 0.5592328157058618, 'f1-score': 0.5594321362246225, 'support': 34321}, 'weighted avg': {'precision': 0.5616682319759208, 'recall': 0.5595699426007401, 'f1-score': 0.5594660609316973, 'support': 34321}}
[[5862 2885 2449]
 [1960 6792 2754]
 [2065 3003 6551]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.983277
{'0': {'precision': 0.5693939393939393, 'recall': 0.4911134343962363, 'f1-score': 0.5273645804097671, 'support': 11478}, '1': {'precision': 0.4867544416243655, 'recall': 0.5360761705101328, 'f1-score': 0.5102261390089791, 'support': 11448}, '2': {'precision': 0.5107085414373995, 'recall': 0.5294427380430013, 'f1-score': 0.5199069286452948, 'support': 11395}, 'accuracy': 0.5188368637277468, 'macro avg': {'precision': 0.5222856408185681, 'recall': 0.5188774476497902, 'f1-score': 0.5191658826880136, 'support': 34321}, 'weighted avg': {'precision': 0.5223446960682538, 'recall': 0.5188368637277468, 'f1-score': 0.5191719048172032, 'support': 34321}}
[[5637 3193 2648]
 [2179 6137 3132]
 [2084 3278 6033]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0165946
{'0': {'precision': 0.5421699184474037, 'recall': 0.4567750913202296, 'f1-score': 0.49582251593108323, 'support': 11498}, '1': {'precision': 0.44325715622806333, 'recall': 0.49978014246768093, 'f1-score': 0.46982473544973546, 'support': 11371}, '2': {'precision': 0.4826039109455684, 'recall': 0.4978169752008383, 'f1-score': 0.4900924134966688, 'support': 11452}, 'accuracy': 0.4847178112525859, 'macro avg': {'precision': 0.48934366187367845, 'recall': 0.4847907363295829, 'f1-score': 0.4852465549591625, 'support': 34321}, 'weighted avg': {'precision': 0.48952323166359385, 'recall': 0.4847178112525859, 'f1-score': 0.4852971263756415, 'support': 34321}}
[[5252 3451 2795]
 [2371 5683 3317]
 [2064 3687 5701]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0522306
{'0': {'precision': 0.49725894872621734, 'recall': 0.39937839937839936, 'f1-score': 0.4429761562769319, 'support': 11583}, '1': {'precision': 0.4035239518603005, 'recall': 0.4595538833646869, 'f1-score': 0.4297202211425699, 'support': 11163}, '2': {'precision': 0.45493701747257215, 'recall': 0.48362850971922244, 'f1-score': 0.46884422110552765, 'support': 11575}, 'accuracy': 0.4473645872789254, 'macro avg': {'precision': 0.45190663935303, 'recall': 0.44752026415410295, 'f1-score': 0.44718019950834315, 'support': 34321}, 'weighted avg': {'precision': 0.45249801156601877, 'recall': 0.4473645872789254, 'f1-score': 0.4473888146052473, 'support': 34321}}
[[4626 3773 3184]
 [2510 5130 3523]
 [2167 3810 5598]]
Evaluating performance on  val set...
46/46 - 1s - 546ms/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0059217
{'0': {'precision': 0.4905607213299521, 'recall': 0.46009513742071884, 'f1-score': 0.4748397654438838, 'support': 3784}, '1': {'precision': 0.5137861466039004, 'recall': 0.5617647058823529, 'f1-score': 0.5367053038285915, 'support': 4080}, '2': {'precision': 0.5, 'recall': 0.4808800419067575, 'f1-score': 0.49025367156208277, 'support': 3818}, 'accuracy': 0.502396849854477, 'macro avg': {'precision': 0.5014489559779508, 'recall': 0.5009132950699432, 'f1-score': 0.5005995802781861, 'support': 11682}, 'weighted avg': {'precision': 0.5017573401520674, 'recall': 0.502396849854477, 'f1-score': 0.5014843203290825, 'support': 11682}}
[[1741 1112  931]
 [ 883 2292  905]
 [ 925 1057 1836]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0537094
{'0': {'precision': 0.4633406835722161, 'recall': 0.4194111776447106, 'f1-score': 0.4402828706128863, 'support': 4008}, '1': {'precision': 0.42718227046585255, 'recall': 0.5022600372241425, 'f1-score': 0.4616888671636319, 'support': 3761}, '2': {'precision': 0.47604625550660795, 'recall': 0.4418604651162791, 'f1-score': 0.4583167660702452, 'support': 3913}, 'accuracy': 0.45360383495976714, 'macro avg': {'precision': 0.4555230698482255, 'recall': 0.4545105599950441, 'f1-score': 0.45342950128225445, 'support': 11682}, 'weighted avg': {'precision': 0.45595539948440944, 'recall': 0.45360383495976714, 'f1-score': 0.4532151241612512, 'support': 11682}}
[[1681 1316 1011]
 [ 980 1889  892]
 [ 967 1217 1729]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0710027
{'0': {'precision': 0.4476403239318626, 'recall': 0.40064983754061484, 'f1-score': 0.42284357689264046, 'support': 4001}, '1': {'precision': 0.3949372759856631, 'recall': 0.45947354704195986, 'f1-score': 0.4247681002288881, 'support': 3837}, '2': {'precision': 0.43524883145449544, 'recall': 0.4118106139438085, 'f1-score': 0.4232054538163347, 'support': 3844}, 'accuracy': 0.423643211778805, 'macro avg': {'precision': 0.4259421437906737, 'recall': 0.4239779995087944, 'f1-score': 0.4236057103126211, 'support': 11682}, 'weighted avg': {'precision': 0.4262523345419835, 'recall': 0.423643211778805, 'f1-score': 0.42359477111759025, 'support': 11682}}
[[1603 1372 1026]
 [1046 1763 1028]
 [ 932 1329 1583]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0923119
{'0': {'precision': 0.4260919872722013, 'recall': 0.36605367793240556, 'f1-score': 0.393797620638952, 'support': 4024}, '1': {'precision': 0.36792883211678834, 'recall': 0.42705851204659784, 'f1-score': 0.3952946942776621, 'support': 3777}, '2': {'precision': 0.41864097891174173, 'recall': 0.4143262045864468, 'f1-score': 0.4164724164724165, 'support': 3881}, 'accuracy': 0.4018147577469611, 'macro avg': {'precision': 0.4042205994335772, 'recall': 0.4024794648551501, 'f1-score': 0.4018549104630102, 'support': 11682}, 'weighted avg': {'precision': 0.4048114188362368, 'recall': 0.4018147577469611, 'f1-score': 0.401814683621582, 'support': 11682}}
[[1473 1423 1128]
 [1059 1613 1105]
 [ 925 1348 1608]]
training model: results/LILAK/W10/deepVOL_L2/seq2seq
Epoch 1/50
135/135 - 10s - loss: 13.3029 - accuracy10: 0.3645 - accuracy20: 0.3604 - accuracy30: 0.3568 - accuracy50: 0.3522 - val_loss: 13.4351 - val_accuracy10: 0.3442 - val_accuracy20: 0.3477 - val_accuracy30: 0.3442 - val_accuracy50: 0.3479 - 10s/epoch - 73ms/step
Epoch 2/50
135/135 - 4s - loss: 13.1559 - accuracy10: 0.3804 - accuracy20: 0.3739 - accuracy30: 0.3678 - accuracy50: 0.3591 - val_loss: 13.2028 - val_accuracy10: 0.3679 - val_accuracy20: 0.3655 - val_accuracy30: 0.3658 - val_accuracy50: 0.3614 - 4s/epoch - 30ms/step
Epoch 3/50
135/135 - 4s - loss: 13.0483 - accuracy10: 0.4074 - accuracy20: 0.3971 - accuracy30: 0.3850 - accuracy50: 0.3733 - val_loss: 13.2090 - val_accuracy10: 0.3746 - val_accuracy20: 0.3779 - val_accuracy30: 0.3772 - val_accuracy50: 0.3653 - 4s/epoch - 30ms/step
Epoch 4/50
135/135 - 4s - loss: 12.9264 - accuracy10: 0.4298 - accuracy20: 0.4135 - accuracy30: 0.4015 - accuracy50: 0.3796 - val_loss: 13.0910 - val_accuracy10: 0.3938 - val_accuracy20: 0.3937 - val_accuracy30: 0.3838 - val_accuracy50: 0.3733 - 4s/epoch - 30ms/step
Epoch 5/50
135/135 - 4s - loss: 12.8213 - accuracy10: 0.4458 - accuracy20: 0.4311 - accuracy30: 0.4157 - accuracy50: 0.3938 - val_loss: 13.0334 - val_accuracy10: 0.4093 - val_accuracy20: 0.4044 - val_accuracy30: 0.3935 - val_accuracy50: 0.3824 - 4s/epoch - 30ms/step
Epoch 6/50
135/135 - 4s - loss: 12.6967 - accuracy10: 0.4612 - accuracy20: 0.4470 - accuracy30: 0.4324 - accuracy50: 0.4078 - val_loss: 12.9340 - val_accuracy10: 0.4295 - val_accuracy20: 0.4208 - val_accuracy30: 0.4090 - val_accuracy50: 0.3836 - 4s/epoch - 30ms/step
Epoch 7/50
135/135 - 4s - loss: 12.6316 - accuracy10: 0.4709 - accuracy20: 0.4547 - accuracy30: 0.4392 - accuracy50: 0.4147 - val_loss: 12.8981 - val_accuracy10: 0.4376 - val_accuracy20: 0.4253 - val_accuracy30: 0.4111 - val_accuracy50: 0.3888 - 4s/epoch - 30ms/step
Epoch 8/50
135/135 - 4s - loss: 12.5485 - accuracy10: 0.4844 - accuracy20: 0.4697 - accuracy30: 0.4546 - accuracy50: 0.4263 - val_loss: 12.8991 - val_accuracy10: 0.4353 - val_accuracy20: 0.4277 - val_accuracy30: 0.4145 - val_accuracy50: 0.3911 - 4s/epoch - 30ms/step
Epoch 9/50
135/135 - 4s - loss: 12.4431 - accuracy10: 0.4919 - accuracy20: 0.4740 - accuracy30: 0.4588 - accuracy50: 0.4299 - val_loss: 12.9348 - val_accuracy10: 0.4342 - val_accuracy20: 0.4287 - val_accuracy30: 0.4096 - val_accuracy50: 0.3903 - 4s/epoch - 30ms/step
Epoch 10/50
135/135 - 4s - loss: 12.4012 - accuracy10: 0.4984 - accuracy20: 0.4801 - accuracy30: 0.4637 - accuracy50: 0.4330 - val_loss: 12.9799 - val_accuracy10: 0.4255 - val_accuracy20: 0.4214 - val_accuracy30: 0.4066 - val_accuracy50: 0.3844 - 4s/epoch - 30ms/step
Epoch 11/50
135/135 - 4s - loss: 12.3474 - accuracy10: 0.5006 - accuracy20: 0.4838 - accuracy30: 0.4689 - accuracy50: 0.4391 - val_loss: 13.0191 - val_accuracy10: 0.4157 - val_accuracy20: 0.4165 - val_accuracy30: 0.3992 - val_accuracy50: 0.3715 - 4s/epoch - 30ms/step
Epoch 12/50
135/135 - 4s - loss: 12.3145 - accuracy10: 0.5043 - accuracy20: 0.4841 - accuracy30: 0.4720 - accuracy50: 0.4427 - val_loss: 12.9300 - val_accuracy10: 0.4292 - val_accuracy20: 0.4247 - val_accuracy30: 0.4095 - val_accuracy50: 0.3899 - 4s/epoch - 30ms/step
Epoch 13/50
135/135 - 4s - loss: 12.2744 - accuracy10: 0.5055 - accuracy20: 0.4892 - accuracy30: 0.4745 - accuracy50: 0.4428 - val_loss: 12.9055 - val_accuracy10: 0.4386 - val_accuracy20: 0.4306 - val_accuracy30: 0.4119 - val_accuracy50: 0.3890 - 4s/epoch - 31ms/step
Epoch 14/50
135/135 - 4s - loss: 12.2232 - accuracy10: 0.5128 - accuracy20: 0.4950 - accuracy30: 0.4810 - accuracy50: 0.4467 - val_loss: 12.9014 - val_accuracy10: 0.4511 - val_accuracy20: 0.4414 - val_accuracy30: 0.4220 - val_accuracy50: 0.3955 - 4s/epoch - 30ms/step
Epoch 15/50
135/135 - 4s - loss: 12.1773 - accuracy10: 0.5137 - accuracy20: 0.4977 - accuracy30: 0.4811 - accuracy50: 0.4515 - val_loss: 12.9549 - val_accuracy10: 0.4443 - val_accuracy20: 0.4357 - val_accuracy30: 0.4188 - val_accuracy50: 0.3905 - 4s/epoch - 30ms/step
Epoch 16/50
135/135 - 4s - loss: 12.1546 - accuracy10: 0.5187 - accuracy20: 0.5020 - accuracy30: 0.4861 - accuracy50: 0.4521 - val_loss: 12.9654 - val_accuracy10: 0.4471 - val_accuracy20: 0.4379 - val_accuracy30: 0.4176 - val_accuracy50: 0.3919 - 4s/epoch - 29ms/step
Epoch 17/50
135/135 - 4s - loss: 12.0954 - accuracy10: 0.5243 - accuracy20: 0.5049 - accuracy30: 0.4882 - accuracy50: 0.4571 - val_loss: 12.9274 - val_accuracy10: 0.4554 - val_accuracy20: 0.4404 - val_accuracy30: 0.4196 - val_accuracy50: 0.3918 - 4s/epoch - 30ms/step
testing model: results/LILAK/W10/deepVOL_L2/seq2seq
Evaluating performance on  test set...
519/519 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0591068
{'0': {'precision': 0.4803574497336312, 'recall': 0.549630328771433, 'f1-score': 0.5126643801698366, 'support': 50856}, '1': {'precision': 0.382771743239497, 'recall': 0.4345015019310542, 'f1-score': 0.40699949084867487, 'support': 34955}, '2': {'precision': 0.47310094700785815, 'recall': 0.3512040855573837, 'f1-score': 0.403139563404464, 'support': 46799}, 'accuracy': 0.44925722042078275, 'macro avg': {'precision': 0.4454100466603288, 'recall': 0.4451119720866236, 'f1-score': 0.4409344781409918, 'support': 132610}, 'weighted avg': {'precision': 0.4520737196863806, 'recall': 0.44925722042078275, 'f1-score': 0.44615983220193167, 'support': 132610}}
[[27952 12152 10752]
 [12214 15188  7553]
 [18024 12339 16436]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0719126
{'0': {'precision': 0.49008875228787513, 'recall': 0.5307217651458489, 'f1-score': 0.5095965671400614, 'support': 53480}, '1': {'precision': 0.32771109542114485, 'recall': 0.4200435729847495, 'f1-score': 0.3681767436394618, 'support': 29835}, '2': {'precision': 0.47848031820052117, 'recall': 0.3538492747743179, 'f1-score': 0.4068338192419825, 'support': 49295}, 'accuracy': 0.4400723927305633, 'macro avg': {'precision': 0.4320933886365137, 'recall': 0.4348715376349721, 'f1-score': 0.4282023766738352, 'support': 132610}, 'weighted avg': {'precision': 0.44924134145192746, 'recall': 0.4400723927305633, 'f1-score': 0.4395795994017597, 'support': 132610}}
[[28383 12685 12412]
 [10703 12532  6600]
 [18828 13024 17443]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0808944
{'0': {'precision': 0.46225690443769424, 'recall': 0.5125827558171048, 'f1-score': 0.48612080044060946, 'support': 51658}, '1': {'precision': 0.32753365164144477, 'recall': 0.3684641762510242, 'f1-score': 0.34679538443962066, 'support': 32953}, '2': {'precision': 0.4494602295004836, 'recall': 0.3582366299297902, 'f1-score': 0.39869690224448157, 'support': 47999}, 'accuracy': 0.4209034009501546, 'macro avg': {'precision': 0.4130835951932075, 'recall': 0.4130945206659731, 'f1-score': 0.4105376957082372, 'support': 132610}, 'weighted avg': {'precision': 0.42414693573468554, 'recall': 0.4209034009501546, 'f1-score': 0.41985543491013266, 'support': 132610}}
[[26479 12174 13005]
 [12754 12142  8057]
 [18049 12755 17195]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0942849
{'0': {'precision': 0.4428107728748136, 'recall': 0.4888527320975459, 'f1-score': 0.4646940767063763, 'support': 51627}, '1': {'precision': 0.2904392333583688, 'recall': 0.31732668753609095, 'f1-score': 0.3032882123976065, 'support': 32903}, '2': {'precision': 0.42716684314022085, 'recall': 0.3524126455906822, 'f1-score': 0.3862056390034873, 'support': 48080}, 'accuracy': 0.3968252771284217, 'macro avg': {'precision': 0.3868056164578011, 'recall': 0.386197355074773, 'f1-score': 0.38472930936915667, 'support': 132610}, 'weighted avg': {'precision': 0.39933259697292983, 'recall': 0.3968252771284217, 'f1-score': 0.39618897725606067, 'support': 132610}}
[[25238 12532 13857]
 [13597 10441  8865]
 [18160 12976 16944]]
Evaluating performance on  train set...
135/135 - 2s - 2s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0256869
{'0': {'precision': 0.45660749506903353, 'recall': 0.5412283068069418, 'f1-score': 0.49532979467555444, 'support': 11121}, '1': {'precision': 0.48612652608213097, 'recall': 0.5325227963525836, 'f1-score': 0.5082680591818972, 'support': 11515}, '2': {'precision': 0.5040459716195614, 'recall': 0.3677590485154445, 'f1-score': 0.42524982685267637, 'support': 11687}, 'accuracy': 0.47924132505899836, 'macro avg': {'precision': 0.48225999759024196, 'recall': 0.48050338389165664, 'f1-score': 0.47628256023670934, 'support': 34323}, 'weighted avg': {'precision': 0.482663641605229, 'recall': 0.47924132505899836, 'f1-score': 0.4758081774464241, 'support': 34323}}
[[6019 2911 2191]
 [3345 6132 2038]
 [3818 3571 4298]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.039554
{'0': {'precision': 0.45729142769748415, 'recall': 0.5235968829349444, 'f1-score': 0.48820311862192833, 'support': 11421}, '1': {'precision': 0.4661660206718346, 'recall': 0.5055609072598302, 'f1-score': 0.48506490778473305, 'support': 11419}, '2': {'precision': 0.47980139923267884, 'recall': 0.3702865104937734, 'f1-score': 0.41798967805357584, 'support': 11483}, 'accuracy': 0.4663053928852373, 'macro avg': {'precision': 0.46775294920066585, 'recall': 0.4664814335628493, 'f1-score': 0.4637525681534124, 'support': 34323}, 'weighted avg': {'precision': 0.4677748056164525, 'recall': 0.46630539288523737, 'f1-score': 0.46366866162235587, 'support': 34323}}
[[5980 3077 2364]
 [3400 5773 2246]
 [3697 3534 4252]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0522367
{'0': {'precision': 0.4447518057476564, 'recall': 0.5055021834061135, 'f1-score': 0.47318508829300193, 'support': 11450}, '1': {'precision': 0.44816494845360827, 'recall': 0.47721085448318257, 'f1-score': 0.4622320517182715, 'support': 11387}, '2': {'precision': 0.4566637630662021, 'recall': 0.36514017064252136, 'f1-score': 0.4058055152394775, 'support': 11486}, 'accuracy': 0.4491448882673426, 'macro avg': {'precision': 0.4498601724224889, 'recall': 0.4492844028439391, 'f1-score': 0.44707421841691697, 'support': 34323}, 'weighted avg': {'precision': 0.4498704200224427, 'recall': 0.4491448882673426, 'f1-score': 0.44700311108910834, 'support': 34323}}
[[5788 3091 2571]
 [3534 5434 2419]
 [3692 3600 4194]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0712752
{'0': {'precision': 0.4272098385857033, 'recall': 0.4808374426853534, 'f1-score': 0.4524400667507835, 'support': 11559}, '1': {'precision': 0.4054755525787006, 'recall': 0.4359920777817789, 'f1-score': 0.42018046156515704, 'support': 11108}, '2': {'precision': 0.43537197139502615, 'recall': 0.34994852436513385, 'f1-score': 0.38801426872770506, 'support': 11656}, 'accuracy': 0.4218745447659004, 'macro avg': {'precision': 0.42268578751981, 'recall': 0.422259348277422, 'f1-score': 0.4202115990145485, 'support': 34323}, 'weighted avg': {'precision': 0.42294778023007246, 'recall': 0.4218745447659004, 'f1-score': 0.42012101549771874, 'support': 34323}}
[[5558 3306 2695]
 [3670 4843 2595]
 [3782 3795 4079]]
Evaluating performance on  val set...
46/46 - 1s - 506ms/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0622022
{'0': {'precision': 0.40822407628128726, 'recall': 0.5430761099365751, 'f1-score': 0.46609208437287375, 'support': 3784}, '1': {'precision': 0.46345766129032256, 'recall': 0.44974321349963314, 'f1-score': 0.45649745562864585, 'support': 4089}, '2': {'precision': 0.44328358208955226, 'recall': 0.3118928852717249, 'f1-score': 0.3661581137309293, 'support': 3809}, 'accuracy': 0.4350282485875706, 'macro avg': {'precision': 0.4383217732203874, 'recall': 0.434904069569311, 'f1-score': 0.4295825512441496, 'support': 11682}, 'weighted avg': {'precision': 0.43898865312819935, 'recall': 0.4350282485875706, 'f1-score': 0.43014952906468046, 'support': 11682}}
[[2055 1016  713]
 [1471 1839  779]
 [1508 1113 1188]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0709974
{'0': {'precision': 0.41274776525456663, 'recall': 0.5315315315315315, 'f1-score': 0.464668562677751, 'support': 3996}, '1': {'precision': 0.4263607257203842, 'recall': 0.42545260915867944, 'f1-score': 0.42590618336886993, 'support': 3756}, '2': {'precision': 0.4411764705882353, 'recall': 0.31297709923664124, 'f1-score': 0.36618041083655856, 'support': 3930}, 'accuracy': 0.4239000171203561, 'macro avg': {'precision': 0.4267616538543954, 'recall': 0.42332041330895076, 'f1-score': 0.4189183856277265, 'support': 11682}, 'weighted avg': {'precision': 0.42668845105074266, 'recall': 0.4239000171203561, 'f1-score': 0.41907277998471526, 'support': 11682}}
[[2124 1040  832]
 [1432 1598  726]
 [1590 1110 1230]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0783367
{'0': {'precision': 0.39796895957079903, 'recall': 0.5186017478152309, 'f1-score': 0.4503469210754553, 'support': 4005}, '1': {'precision': 0.4142735285754905, 'recall': 0.38271604938271603, 'f1-score': 0.3978700163844893, 'support': 3807}, '2': {'precision': 0.41276306856754924, 'recall': 0.31421188630490954, 'f1-score': 0.3568075117370892, 'support': 3870}, 'accuracy': 0.40660845745591506, 'macro avg': {'precision': 0.40833518557127957, 'recall': 0.4051765611676188, 'f1-score': 0.4016748163990113, 'support': 11682}, 'weighted avg': {'precision': 0.40818336600961797, 'recall': 0.40660845745591506, 'f1-score': 0.40225780189226884, 'support': 11682}}
[[2077 1026  902]
 [1522 1457  828]
 [1620 1034 1216]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0904056
{'0': {'precision': 0.3832109919066441, 'recall': 0.5091272818204551, 'f1-score': 0.4372852233676976, 'support': 3999}, '1': {'precision': 0.38382308391396547, 'recall': 0.33607427055702915, 'f1-score': 0.35836515344364306, 'support': 3770}, '2': {'precision': 0.3898305084745763, 'recall': 0.30564784053156147, 'f1-score': 0.34264432029795155, 'support': 3913}, 'accuracy': 0.3851224105461394, 'macro avg': {'precision': 0.3856215280983953, 'recall': 0.38361646430301527, 'f1-score': 0.3794315657030974, 'support': 11682}, 'weighted avg': {'precision': 0.38562579717953577, 'recall': 0.3851224105461394, 'f1-score': 0.3801153451511592, 'support': 11682}}
[[2036  992  971]
 [1602 1267  901]
 [1675 1042 1196]]
training model: results/LILAK/W10/deepVOL_L3/seq2seq
Epoch 1/50
135/135 - 12s - loss: 13.3367 - accuracy10: 0.3603 - accuracy20: 0.3560 - accuracy30: 0.3575 - accuracy50: 0.3501 - val_loss: 13.2824 - val_accuracy10: 0.3459 - val_accuracy20: 0.3453 - val_accuracy30: 0.3392 - val_accuracy50: 0.3368 - 12s/epoch - 86ms/step
Epoch 2/50
135/135 - 5s - loss: 13.2047 - accuracy10: 0.3733 - accuracy20: 0.3662 - accuracy30: 0.3579 - accuracy50: 0.3518 - val_loss: 13.2829 - val_accuracy10: 0.3499 - val_accuracy20: 0.3487 - val_accuracy30: 0.3411 - val_accuracy50: 0.3421 - 5s/epoch - 40ms/step
Epoch 3/50
135/135 - 5s - loss: 13.1311 - accuracy10: 0.3789 - accuracy20: 0.3744 - accuracy30: 0.3695 - accuracy50: 0.3559 - val_loss: 13.2366 - val_accuracy10: 0.3500 - val_accuracy20: 0.3464 - val_accuracy30: 0.3407 - val_accuracy50: 0.3427 - 5s/epoch - 40ms/step
Epoch 4/50
135/135 - 5s - loss: 13.0981 - accuracy10: 0.3870 - accuracy20: 0.3785 - accuracy30: 0.3711 - accuracy50: 0.3587 - val_loss: 13.3079 - val_accuracy10: 0.3426 - val_accuracy20: 0.3481 - val_accuracy30: 0.3436 - val_accuracy50: 0.3458 - 5s/epoch - 40ms/step
Epoch 5/50
135/135 - 5s - loss: 13.0525 - accuracy10: 0.3930 - accuracy20: 0.3849 - accuracy30: 0.3757 - accuracy50: 0.3613 - val_loss: 13.1582 - val_accuracy10: 0.3645 - val_accuracy20: 0.3574 - val_accuracy30: 0.3527 - val_accuracy50: 0.3534 - 5s/epoch - 40ms/step
Epoch 6/50
135/135 - 5s - loss: 12.9825 - accuracy10: 0.4015 - accuracy20: 0.3943 - accuracy30: 0.3823 - accuracy50: 0.3687 - val_loss: 13.2112 - val_accuracy10: 0.3598 - val_accuracy20: 0.3651 - val_accuracy30: 0.3697 - val_accuracy50: 0.3581 - 5s/epoch - 40ms/step
Epoch 7/50
135/135 - 5s - loss: 12.9397 - accuracy10: 0.4092 - accuracy20: 0.3985 - accuracy30: 0.3875 - accuracy50: 0.3702 - val_loss: 13.1279 - val_accuracy10: 0.3681 - val_accuracy20: 0.3731 - val_accuracy30: 0.3621 - val_accuracy50: 0.3576 - 5s/epoch - 40ms/step
Epoch 8/50
135/135 - 5s - loss: 12.9103 - accuracy10: 0.4088 - accuracy20: 0.4015 - accuracy30: 0.3934 - accuracy50: 0.3776 - val_loss: 13.1898 - val_accuracy10: 0.3639 - val_accuracy20: 0.3668 - val_accuracy30: 0.3694 - val_accuracy50: 0.3602 - 5s/epoch - 40ms/step
Epoch 9/50
135/135 - 5s - loss: 12.8915 - accuracy10: 0.4145 - accuracy20: 0.4029 - accuracy30: 0.3898 - accuracy50: 0.3785 - val_loss: 13.0938 - val_accuracy10: 0.3740 - val_accuracy20: 0.3769 - val_accuracy30: 0.3735 - val_accuracy50: 0.3655 - 5s/epoch - 40ms/step
Epoch 10/50
135/135 - 5s - loss: 12.8345 - accuracy10: 0.4232 - accuracy20: 0.4141 - accuracy30: 0.4029 - accuracy50: 0.3854 - val_loss: 13.2124 - val_accuracy10: 0.3703 - val_accuracy20: 0.3725 - val_accuracy30: 0.3681 - val_accuracy50: 0.3612 - 5s/epoch - 40ms/step
Epoch 11/50
135/135 - 5s - loss: 12.8185 - accuracy10: 0.4283 - accuracy20: 0.4165 - accuracy30: 0.4100 - accuracy50: 0.3913 - val_loss: 13.2131 - val_accuracy10: 0.3764 - val_accuracy20: 0.3784 - val_accuracy30: 0.3753 - val_accuracy50: 0.3648 - 5s/epoch - 40ms/step
Epoch 12/50
135/135 - 5s - loss: 12.7747 - accuracy10: 0.4328 - accuracy20: 0.4209 - accuracy30: 0.4094 - accuracy50: 0.3930 - val_loss: 13.2005 - val_accuracy10: 0.3799 - val_accuracy20: 0.3721 - val_accuracy30: 0.3676 - val_accuracy50: 0.3565 - 5s/epoch - 40ms/step
Epoch 13/50
135/135 - 5s - loss: 12.7590 - accuracy10: 0.4372 - accuracy20: 0.4268 - accuracy30: 0.4164 - accuracy50: 0.3963 - val_loss: 13.1687 - val_accuracy10: 0.3890 - val_accuracy20: 0.3823 - val_accuracy30: 0.3835 - val_accuracy50: 0.3577 - 5s/epoch - 40ms/step
Epoch 14/50
135/135 - 5s - loss: 12.7242 - accuracy10: 0.4417 - accuracy20: 0.4333 - accuracy30: 0.4219 - accuracy50: 0.4024 - val_loss: 13.1961 - val_accuracy10: 0.3849 - val_accuracy20: 0.3811 - val_accuracy30: 0.3773 - val_accuracy50: 0.3638 - 5s/epoch - 40ms/step
Epoch 15/50
135/135 - 5s - loss: 12.7050 - accuracy10: 0.4488 - accuracy20: 0.4371 - accuracy30: 0.4277 - accuracy50: 0.4075 - val_loss: 13.2167 - val_accuracy10: 0.3845 - val_accuracy20: 0.3813 - val_accuracy30: 0.3801 - val_accuracy50: 0.3660 - 5s/epoch - 40ms/step
Epoch 16/50
135/135 - 5s - loss: 12.6636 - accuracy10: 0.4507 - accuracy20: 0.4462 - accuracy30: 0.4340 - accuracy50: 0.4127 - val_loss: 13.1988 - val_accuracy10: 0.3951 - val_accuracy20: 0.3845 - val_accuracy30: 0.3757 - val_accuracy50: 0.3594 - 5s/epoch - 40ms/step
Epoch 17/50
135/135 - 5s - loss: 12.5893 - accuracy10: 0.4549 - accuracy20: 0.4484 - accuracy30: 0.4392 - accuracy50: 0.4207 - val_loss: 13.1386 - val_accuracy10: 0.4026 - val_accuracy20: 0.3970 - val_accuracy30: 0.3905 - val_accuracy50: 0.3706 - 5s/epoch - 40ms/step
Epoch 18/50
135/135 - 5s - loss: 12.5363 - accuracy10: 0.4613 - accuracy20: 0.4562 - accuracy30: 0.4463 - accuracy50: 0.4284 - val_loss: 13.1950 - val_accuracy10: 0.4019 - val_accuracy20: 0.3922 - val_accuracy30: 0.3860 - val_accuracy50: 0.3714 - 5s/epoch - 40ms/step
Epoch 19/50
135/135 - 5s - loss: 12.4659 - accuracy10: 0.4681 - accuracy20: 0.4604 - accuracy30: 0.4523 - accuracy50: 0.4309 - val_loss: 13.1563 - val_accuracy10: 0.4076 - val_accuracy20: 0.4041 - val_accuracy30: 0.3945 - val_accuracy50: 0.3733 - 5s/epoch - 40ms/step
testing model: results/LILAK/W10/deepVOL_L3/seq2seq
Evaluating performance on  test set...
519/519 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0670389
{'0': {'precision': 0.4165281373484126, 'recall': 0.6010893503224791, 'f1-score': 0.4920721793860567, 'support': 50856}, '1': {'precision': 0.4077376127951586, 'recall': 0.431755113717637, 'f1-score': 0.4194027984271005, 'support': 34955}, '2': {'precision': 0.3749437089075025, 'recall': 0.1779097843971025, 'f1-score': 0.24131584667777697, 'support': 46799}, 'accuracy': 0.40711107759595805, 'macro avg': {'precision': 0.3997364863503579, 'recall': 0.4035847494790728, 'f1-score': 0.38426360816364474, 'support': 132610}, 'weighted avg': {'precision': 0.39953558435568853, 'recall': 0.40711107759595805, 'f1-score': 0.38442340609720144, 'support': 132610}}
[[30569 11323  8964]
 [14947 15092  4916]
 [27874 10599  8326]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0740983
{'0': {'precision': 0.4315186246418338, 'recall': 0.5632011967090501, 'f1-score': 0.4886437378325763, 'support': 53480}, '1': {'precision': 0.3444831712011653, 'recall': 0.4439081615552204, 'f1-score': 0.387926363117119, 'support': 29835}, '2': {'precision': 0.38540469545230666, 'recall': 0.1904858504919363, 'f1-score': 0.2549586608561072, 'support': 49295}, 'accuracy': 0.3978131362642335, 'macro avg': {'precision': 0.38713549709843526, 'recall': 0.3991984029187356, 'f1-score': 0.3771762539352675, 'support': 132610}, 'weighted avg': {'precision': 0.39479523354915536, 'recall': 0.3978131362642335, 'f1-score': 0.37911648691491767, 'support': 132610}}
[[30120 12886 10474]
 [12091 13244  4500]
 [27589 12316  9390]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0844659
{'0': {'precision': 0.4101831093992146, 'recall': 0.527740137055248, 'f1-score': 0.46159446669093557, 'support': 51658}, '1': {'precision': 0.3434990773527505, 'recall': 0.4180196036779656, 'f1-score': 0.3771131339401821, 'support': 32953}, '2': {'precision': 0.37105010558648494, 'recall': 0.20133752786516385, 'f1-score': 0.26103397979579707, 'support': 47999}, 'accuracy': 0.38233164919689316, 'macro avg': {'precision': 0.37491076411281665, 'recall': 0.3823657561994592, 'f1-score': 0.3665805268089715, 'support': 132610}, 'weighted avg': {'precision': 0.3794479917004412, 'recall': 0.38233164919689316, 'f1-score': 0.36800713414727115, 'support': 132610}}
[[27262 13553 10843]
 [13640 13775  5538]
 [25561 12774  9664]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0953773
{'0': {'precision': 0.40038533230995754, 'recall': 0.49510914831386676, 'f1-score': 0.4427373817854297, 'support': 51627}, '1': {'precision': 0.2985494799122054, 'recall': 0.3803300610886545, 'f1-score': 0.3345139603576632, 'support': 32903}, '2': {'precision': 0.36878561054630765, 'recall': 0.2059692179700499, 'f1-score': 0.26431612240267977, 'support': 48080}, 'accuracy': 0.36179775280898874, 'macro avg': {'precision': 0.35590680758949017, 'recall': 0.3604694757908571, 'f1-score': 0.34718915484859086, 'support': 132610}, 'weighted avg': {'precision': 0.363660955009305, 'recall': 0.36179775280898874, 'f1-score': 0.35119549666092614, 'support': 132610}}
[[25561 15095 10971]
 [14410 12514  5979]
 [23870 14307  9903]]
Evaluating performance on  train set...
135/135 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0516436
{'0': {'precision': 0.3792869269949066, 'recall': 0.5022030392950274, 'f1-score': 0.43217519151899714, 'support': 11121}, '1': {'precision': 0.4916317991631799, 'recall': 0.5306122448979592, 'f1-score': 0.5103788163555111, 'support': 11515}, '2': {'precision': 0.403068340306834, 'recall': 0.2472833062377, 'f1-score': 0.30651747361722437, 'support': 11687}, 'accuracy': 0.42493371791510065, 'macro avg': {'precision': 0.4246623554883069, 'recall': 0.42669953014356227, 'f1-score': 0.4163571604972442, 'support': 34323}, 'weighted avg': {'precision': 0.4250750160428967, 'recall': 0.42493371791510065, 'f1-score': 0.4156251519208979, 'support': 34323}}
[[5585 3024 2512]
 [3637 6110 1768]
 [5503 3294 2890]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0629678
{'0': {'precision': 0.38365164247517186, 'recall': 0.4397163120567376, 'f1-score': 0.40977520297009506, 'support': 11421}, '1': {'precision': 0.4566669167854731, 'recall': 0.5329713635169454, 'f1-score': 0.4918774751474986, 'support': 11419}, '2': {'precision': 0.3880597014925373, 'recall': 0.2671775668379343, 'f1-score': 0.3164681004693382, 'support': 11483}, 'accuracy': 0.41301751012440635, 'macro avg': {'precision': 0.4094594202510608, 'recall': 0.4132884141372058, 'f1-score': 0.4060402595289773, 'support': 34323}, 'weighted avg': {'precision': 0.4094180136853148, 'recall': 0.41301751012440635, 'f1-score': 0.4058734574343779, 'support': 34323}}
[[5022 3607 2792]
 [3287 6086 2046]
 [4781 3634 3068]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0715363
{'0': {'precision': 0.37818212169268006, 'recall': 0.39572052401746727, 'f1-score': 0.38675259271904744, 'support': 11450}, '1': {'precision': 0.43028996592726515, 'recall': 0.543426714674629, 'f1-score': 0.48028562558211735, 'support': 11387}, '2': {'precision': 0.38776535611104135, 'recall': 0.2687619710952464, 'f1-score': 0.31747827428395126, 'support': 11486}, 'accuracy': 0.4022375666462722, 'macro avg': {'precision': 0.39874581457699554, 'recall': 0.4026364032624476, 'f1-score': 0.3948388308617054, 'support': 34323}, 'weighted avg': {'precision': 0.3986763982078017, 'recall': 0.4022375666462722, 'f1-score': 0.39460085259336675, 'support': 34323}}
[[4531 4100 2819]
 [3144 6188 2055]
 [4306 4093 3087]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0835737
{'0': {'precision': 0.3722751134442566, 'recall': 0.36196902846266976, 'f1-score': 0.3670497412053689, 'support': 11559}, '1': {'precision': 0.3978307185744722, 'recall': 0.5547353258912495, 'f1-score': 0.4633605293830131, 'support': 11108}, '2': {'precision': 0.3856484529295589, 'recall': 0.25128689087165407, 'f1-score': 0.30429588073346836, 'support': 11656}, 'accuracy': 0.38676689100603096, 'macro avg': {'precision': 0.38525142831609593, 'recall': 0.3893304150751911, 'f1-score': 0.3782353837739501, 'support': 34323}, 'weighted avg': {'precision': 0.385087260017316, 'recall': 0.38676689100603096, 'f1-score': 0.3769078898933274, 'support': 34323}}
[[4184 4709 2666]
 [2946 6162 2000]
 [4109 4618 2929]]
Evaluating performance on  val set...
46/46 - 1s - 813ms/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0911498
{'0': {'precision': 0.34514637904468415, 'recall': 0.5919661733615222, 'f1-score': 0.4360521705275453, 'support': 3784}, '1': {'precision': 0.47885906040268456, 'recall': 0.3489850819271215, 'f1-score': 0.4037346159287028, 'support': 4089}, '2': {'precision': 0.3688969258589512, 'recall': 0.21422945655027567, 'f1-score': 0.27105132037867463, 'support': 3809}, 'accuracy': 0.3837527820578668, 'macro avg': {'precision': 0.39763412176877333, 'recall': 0.38506023727963984, 'f1-score': 0.3702793689449742, 'support': 11682}, 'weighted avg': {'precision': 0.39969328769803175, 'recall': 0.3837527820578668, 'f1-score': 0.3709404842604921, 'support': 11682}}
[[2240  789  755]
 [2021 1427  641]
 [2229  764  816]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0869689
{'0': {'precision': 0.36161381371409596, 'recall': 0.545045045045045, 'f1-score': 0.43477392953388566, 'support': 3996}, '1': {'precision': 0.4291485394655065, 'recall': 0.36767838125665603, 'f1-score': 0.3960424433610553, 'support': 3756}, '2': {'precision': 0.3768947152806227, 'recall': 0.2340966921119593, 'f1-score': 0.2888086642599278, 'support': 3930}, 'accuracy': 0.38341037493579866, 'macro avg': {'precision': 0.3892190228200751, 'recall': 0.3822733728045535, 'f1-score': 0.37320834571828954, 'support': 11682}, 'weighted avg': {'precision': 0.3884683226234221, 'recall': 0.38341037493579866, 'f1-score': 0.3732160666172785, 'support': 11682}}
[[2178  949  869]
 [1723 1381  652]
 [2122  888  920]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0893159
{'0': {'precision': 0.3610269210197896, 'recall': 0.5056179775280899, 'f1-score': 0.4212606615352611, 'support': 4005}, '1': {'precision': 0.41898016997167137, 'recall': 0.38849487785658, 'f1-score': 0.4031620553359684, 'support': 3807}, '2': {'precision': 0.35902477388910736, 'recall': 0.2359173126614987, 'f1-score': 0.28473413379073753, 'support': 3870}, 'accuracy': 0.3781030645437425, 'macro avg': {'precision': 0.3796772882935227, 'recall': 0.3766767226820562, 'f1-score': 0.3697189502206557, 'support': 11682}, 'weighted avg': {'precision': 0.37924980317730317, 'recall': 0.3781030645437425, 'f1-score': 0.3701342228970131, 'support': 11682}}
[[2025 1072  908]
 [1606 1479  722]
 [1978  979  913]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0942241
{'0': {'precision': 0.3591003591003591, 'recall': 0.4751187796949237, 'f1-score': 0.4090419806243272, 'support': 3999}, '1': {'precision': 0.38731479074603586, 'recall': 0.3952254641909814, 'f1-score': 0.3912301431009583, 'support': 3770}, '2': {'precision': 0.3490566037735849, 'recall': 0.22693585484283157, 'f1-score': 0.27505033297196835, 'support': 3913}, 'accuracy': 0.3662044170518747, 'macro avg': {'precision': 0.3651572512066599, 'recall': 0.3657600329095789, 'f1-score': 0.3584408188990846, 'support': 11682}, 'weighted avg': {'precision': 0.3648414302106599, 'recall': 0.3662044170518747, 'f1-score': 0.35841195625120775, 'support': 11682}}
[[1900 1193  906]
 [1530 1490  750]
 [1861 1164  888]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :       256            32
 Used       :        13 (peak)   9.27 (ave)

============================================
