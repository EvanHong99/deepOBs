This machine has 1 visible gpus.
This machine has 1 physical gpus.
training model: results/ATVI/W0/deepLOB_L1/seq2seq
Epoch 1/50
2538/2538 - 75s - loss: 12.2430 - accuracy10: 0.4460 - accuracy20: 0.4647 - accuracy30: 0.4684 - accuracy50: 0.4609 - val_loss: 13.2576 - val_accuracy10: 0.5768 - val_accuracy20: 0.5019 - val_accuracy30: 0.4411 - val_accuracy50: 0.3539 - 75s/epoch - 30ms/step
Epoch 2/50
2538/2538 - 59s - loss: 12.0619 - accuracy10: 0.4609 - accuracy20: 0.4821 - accuracy30: 0.4852 - accuracy50: 0.4725 - val_loss: 12.8037 - val_accuracy10: 0.4735 - val_accuracy20: 0.4712 - val_accuracy30: 0.4553 - val_accuracy50: 0.4072 - 59s/epoch - 23ms/step
Epoch 3/50
2538/2538 - 59s - loss: 11.8601 - accuracy10: 0.4826 - accuracy20: 0.4991 - accuracy30: 0.4984 - accuracy50: 0.4810 - val_loss: 12.7321 - val_accuracy10: 0.4354 - val_accuracy20: 0.4477 - val_accuracy30: 0.4467 - val_accuracy50: 0.4319 - 59s/epoch - 23ms/step
Epoch 4/50
2538/2538 - 63s - loss: 11.6613 - accuracy10: 0.5082 - accuracy20: 0.5176 - accuracy30: 0.5122 - accuracy50: 0.4897 - val_loss: 12.8631 - val_accuracy10: 0.5478 - val_accuracy20: 0.5134 - val_accuracy30: 0.4788 - val_accuracy50: 0.4227 - 63s/epoch - 25ms/step
Epoch 5/50
2538/2538 - 61s - loss: 11.5428 - accuracy10: 0.5207 - accuracy20: 0.5263 - accuracy30: 0.5184 - accuracy50: 0.4952 - val_loss: 12.7681 - val_accuracy10: 0.5635 - val_accuracy20: 0.5232 - val_accuracy30: 0.4842 - val_accuracy50: 0.4246 - 61s/epoch - 24ms/step
Epoch 6/50
2538/2538 - 62s - loss: 11.4601 - accuracy10: 0.5283 - accuracy20: 0.5329 - accuracy30: 0.5237 - accuracy50: 0.4997 - val_loss: 12.8514 - val_accuracy10: 0.5806 - val_accuracy20: 0.5298 - val_accuracy30: 0.4857 - val_accuracy50: 0.4185 - 62s/epoch - 25ms/step
Epoch 7/50
2538/2538 - 60s - loss: 11.3943 - accuracy10: 0.5348 - accuracy20: 0.5378 - accuracy30: 0.5275 - accuracy50: 0.5030 - val_loss: 12.9089 - val_accuracy10: 0.5918 - val_accuracy20: 0.5347 - val_accuracy30: 0.4841 - val_accuracy50: 0.4094 - 60s/epoch - 24ms/step
Epoch 8/50
2538/2538 - 61s - loss: 11.3315 - accuracy10: 0.5414 - accuracy20: 0.5439 - accuracy30: 0.5326 - accuracy50: 0.5065 - val_loss: 13.0091 - val_accuracy10: 0.5961 - val_accuracy20: 0.5361 - val_accuracy30: 0.4831 - val_accuracy50: 0.4051 - 61s/epoch - 24ms/step
Epoch 9/50
2538/2538 - 56s - loss: 11.2807 - accuracy10: 0.5461 - accuracy20: 0.5478 - accuracy30: 0.5362 - accuracy50: 0.5096 - val_loss: 13.2186 - val_accuracy10: 0.5995 - val_accuracy20: 0.5345 - val_accuracy30: 0.4783 - val_accuracy50: 0.3964 - 56s/epoch - 22ms/step
Epoch 10/50
2538/2538 - 62s - loss: 11.2405 - accuracy10: 0.5500 - accuracy20: 0.5512 - accuracy30: 0.5393 - accuracy50: 0.5115 - val_loss: 13.4417 - val_accuracy10: 0.6007 - val_accuracy20: 0.5326 - val_accuracy30: 0.4743 - val_accuracy50: 0.3885 - 62s/epoch - 25ms/step
Epoch 11/50
2538/2538 - 59s - loss: 11.2042 - accuracy10: 0.5532 - accuracy20: 0.5546 - accuracy30: 0.5418 - accuracy50: 0.5134 - val_loss: 13.6783 - val_accuracy10: 0.5986 - val_accuracy20: 0.5305 - val_accuracy30: 0.4720 - val_accuracy50: 0.3860 - 59s/epoch - 23ms/step
Epoch 12/50
2538/2538 - 60s - loss: 11.1791 - accuracy10: 0.5558 - accuracy20: 0.5569 - accuracy30: 0.5438 - accuracy50: 0.5143 - val_loss: 13.8510 - val_accuracy10: 0.5995 - val_accuracy20: 0.5296 - val_accuracy30: 0.4703 - val_accuracy50: 0.3851 - 60s/epoch - 24ms/step
Epoch 13/50
2538/2538 - 57s - loss: 11.1486 - accuracy10: 0.5587 - accuracy20: 0.5590 - accuracy30: 0.5458 - accuracy50: 0.5157 - val_loss: 13.8097 - val_accuracy10: 0.6084 - val_accuracy20: 0.5325 - val_accuracy30: 0.4704 - val_accuracy50: 0.3827 - 57s/epoch - 22ms/step
testing model: results/ATVI/W0/deepLOB_L1/seq2seq
Evaluating performance on  test set...
11876/11876 - 112s - 112s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0509216
{'0': {'precision': 0.3262183444433855, 'recall': 0.4620170635425952, 'f1-score': 0.38241987113611237, 'support': 785300}, '1': {'precision': 0.5854819085934057, 'recall': 0.40325066103352136, 'f1-score': 0.4775729533265873, 'support': 1459457}, '2': {'precision': 0.37756406921903174, 'recall': 0.4380149911617019, 'f1-score': 0.405549211537499, 'support': 795402}, 'accuracy': 0.42752599452857565, 'macro avg': {'precision': 0.4297547740852743, 'recall': 0.4344275719126061, 'f1-score': 0.42184734533339957, 'support': 3040159}, 'weighted avg': {'precision': 0.4641139333654434, 'recall': 0.42752599452857565, 'f1-score': 0.4341503745368909, 'support': 3040159}}
[[362822 229602 192876]
 [489452 588527 381478]
 [259932 187072 348398]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0850507
{'0': {'precision': 0.39260438049680785, 'recall': 0.4250002548342049, 'f1-score': 0.408160508269661, 'support': 981030}, '1': {'precision': 0.43962793649720633, 'recall': 0.43922091712207595, 'f1-score': 0.4394243325586383, 'support': 1066074}, '2': {'precision': 0.4430626924778664, 'recall': 0.4073862978384883, 'f1-score': 0.42447618153269395, 'support': 993055}, 'accuracy': 0.42423340358185213, 'macro avg': {'precision': 0.4250983364906269, 'recall': 0.4238691565982564, 'f1-score': 0.4240203407869978, 'support': 3040159}, 'weighted avg': {'precision': 0.42557583674101046, 'recall': 0.42423340358185213, 'f1-score': 0.4244530479451412, 'support': 3040159}}
[[416938 318248 245844]
 [335141 468242 262691]
 [309901 278597 404557]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1076579
{'0': {'precision': 0.42413313273431136, 'recall': 0.3934518019450967, 'f1-score': 0.4082167815491101, 'support': 1087658}, '1': {'precision': 0.3480126601572657, 'recall': 0.4586432670867783, 'f1-score': 0.3957416242818974, 'support': 846283}, '2': {'precision': 0.4688345847832282, 'recall': 0.3881621886463608, 'f1-score': 0.42470138554732256, 'support': 1106218}, 'accuracy': 0.409674296640406, 'macro avg': {'precision': 0.4136601258916017, 'recall': 0.4134190858927453, 'f1-score': 0.40955326379277673, 'support': 3040159}, 'weighted avg': {'precision': 0.4192090774427062, 'recall': 0.409674296640406, 'f1-score': 0.410742324505293, 'support': 3040159}}
[[427941 378748 280969]
 [252631 388142 205510]
 [328406 348420 429392]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1413862
{'0': {'precision': 0.4516007721814125, 'recall': 0.34531304958083914, 'f1-score': 0.3913688922854421, 'support': 1199778}, '1': {'precision': 0.23750884817357235, 'recall': 0.4742245507702724, 'f1-score': 0.3165020132432026, 'support': 608486}, '2': {'precision': 0.4871659297348147, 'recall': 0.35900624647392837, 'f1-score': 0.41338067301549325, 'support': 1231895}, 'accuracy': 0.3766631942605633, 'macro avg': {'precision': 0.39209185002993313, 'recall': 0.39284794894168, 'f1-score': 0.37375052618137933, 'support': 3040159}, 'weighted avg': {'precision': 0.42316166794127696, 'recall': 0.3766631942605633, 'f1-score': 0.3853036683486513, 'support': 3040159}}
[[414299 471653 313826]
 [168193 288559 151734]
 [334909 454728 442258]]
Evaluating performance on  train set...
2538/2538 - 22s - 22s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.98969895
{'0': {'precision': 0.3300223196618809, 'recall': 0.3396959624596735, 'f1-score': 0.33478927633744693, 'support': 122748}, '1': {'precision': 0.7167444974069862, 'recall': 0.4417255065699381, 'f1-score': 0.5465904600230342, 'support': 402363}, '2': {'precision': 0.2885563284357349, 'recall': 0.6380085773487318, 'f1-score': 0.39738481662952485, 'support': 124514}, 'accuracy': 0.4600685010583029, 'macro avg': {'precision': 0.44510771516820063, 'recall': 0.47314334879278114, 'f1-score': 0.42625485099666865, 'support': 649625}, 'weighted avg': {'precision': 0.5616014602006864, 'recall': 0.4600685010583029, 'f1-score': 0.47797185209301635, 'support': 649625}}
[[ 41697  40366  40685]
 [ 69450 177734 155179]
 [ 15199  29874  79441]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0240365
{'0': {'precision': 0.4005580143987644, 'recall': 0.2992338947303123, 'f1-score': 0.3425605044881263, 'support': 161205}, '1': {'precision': 0.596999370848274, 'recall': 0.47589012098014843, 'f1-score': 0.5296092560919446, 'support': 325012}, '2': {'precision': 0.35953413125326245, 'recall': 0.5943221874082052, 'f1-score': 0.44803207182020954, 'support': 163408}, 'accuracy': 0.46184337117567825, 'macro avg': {'precision': 0.4523638388334336, 'recall': 0.45648206770622196, 'f1-score': 0.44006727746676016, 'support': 649625}, 'weighted avg': {'precision': 0.4885197884150474, 'recall': 0.46184337117567825, 'f1-score': 0.46267285658489177, 'support': 649625}}
[[ 48238  58039  54928]
 [ 52268 154670 118074]
 [ 19921  46370  97117]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0517805
{'0': {'precision': 0.43758663005765036, 'recall': 0.26620513343824354, 'f1-score': 0.33102918586789554, 'support': 186191}, '1': {'precision': 0.5095071072549382, 'recall': 0.5008838058458221, 'f1-score': 0.5051586582546768, 'support': 275513}, '2': {'precision': 0.39563701008640106, 'recall': 0.5589795712027926, 'f1-score': 0.46333367885017873, 'support': 187921}, 'accuracy': 0.45042755435828363, 'macro avg': {'precision': 0.4475769157996632, 'recall': 0.44202283682895277, 'f1-score': 0.433173840990917, 'support': 649625}, 'weighted avg': {'precision': 0.4559538602280398, 'recall': 0.45042755435828363, 'f1-score': 0.4431519119813038, 'support': 649625}}
[[ 49565  72357  64269]
 [ 41320 138000  96193]
 [ 22384  60493 105044]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0952816
{'0': {'precision': 0.47051970369219714, 'recall': 0.22268988650461793, 'f1-score': 0.302303894508017, 'support': 217630}, '1': {'precision': 0.3923776571860196, 'recall': 0.5280972570330983, 'f1-score': 0.4502318559258061, 'support': 213455}, '2': {'precision': 0.4320478759297748, 'recall': 0.512702480095177, 'f1-score': 0.46893238218202593, 'support': 218540}, 'accuracy': 0.42060419472772753, 'macro avg': {'precision': 0.4316484122693305, 'recall': 0.42116320787763106, 'f1-score': 0.407156044205283, 'support': 649625}, 'weighted avg': {'precision': 0.4319013565285629, 'recall': 0.42060419472772753, 'f1-score': 0.40696574203653285, 'support': 649625}}
[[ 48464  93592  75574]
 [ 29013 112725  71717]
 [ 25524  80970 112046]]
Evaluating performance on  val set...
795/795 - 7s - 7s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.99767584
{'0': {'precision': 0.2843472428966352, 'recall': 0.45251731139688656, 'f1-score': 0.34924206656152373, 'support': 38414}, '1': {'precision': 0.7300042902672224, 'recall': 0.3780740388049042, 'f1-score': 0.49815191421954325, 'support': 126015}, '2': {'precision': 0.30432920101252675, 'recall': 0.6010819680537395, 'f1-score': 0.40407452731001914, 'support': 39003}, 'accuracy': 0.4348873333595501, 'macro avg': {'precision': 0.4395602447254614, 'recall': 0.4772244394185101, 'f1-score': 0.4171561693636954, 'support': 203432}, 'weighted avg': {'precision': 0.5642384553745081, 'recall': 0.4348873333595501, 'f1-score': 0.45199632803070694, 'support': 203432}}
[[17383  9597 11434]
 [36215 47643 42157]
 [ 7535  8024 23444]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0237014
{'0': {'precision': 0.35419798334656377, 'recall': 0.4168521905064801, 'f1-score': 0.38297950052504226, 'support': 50308}, '1': {'precision': 0.6109729745730101, 'recall': 0.40579382476973136, 'f1-score': 0.4876812664284238, 'support': 101729}, '2': {'precision': 0.37516795157776645, 'recall': 0.5595875085125012, 'f1-score': 0.44918549986724343, 'support': 51395}, 'accuracy': 0.44738290927680996, 'macro avg': {'precision': 0.44677963649911345, 'recall': 0.4607445079295709, 'f1-score': 0.4399487556069032, 'support': 203432}, 'weighted avg': {'precision': 0.4878997342988123, 'recall': 0.44738290927680996, 'f1-score': 0.45206333826825634, 'support': 203432}}
[[20971 14030 15307]
 [27856 41281 32592]
 [10380 12255 28760]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.045815
{'0': {'precision': 0.3966474538628312, 'recall': 0.3878824441954667, 'f1-score': 0.3922159863352738, 'support': 58015}, '1': {'precision': 0.5260296587254149, 'recall': 0.4296957648891524, 'f1-score': 0.4730076462872317, 'support': 86019}, '2': {'precision': 0.4104902332762027, 'recall': 0.5282164382639146, 'f1-score': 0.46197112588437106, 'support': 59398}, 'accuracy': 0.44653741790868695, 'macro avg': {'precision': 0.44438911528814956, 'recall': 0.44859821578284453, 'f1-score': 0.44239825283562556, 'support': 203432}, 'weighted avg': {'precision': 0.4553971161169015, 'recall': 0.44653741790868695, 'f1-score': 0.4467449374164446, 'support': 203432}}
[[22503 17479 18033]
 [22032 36962 27025]
 [12198 15825 31375]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0806606
{'0': {'precision': 0.4376682464454976, 'recall': 0.34239485080382037, 'f1-score': 0.3842134167651317, 'support': 67428}, '1': {'precision': 0.4128273407287471, 'recall': 0.4628668307027546, 'f1-score': 0.4364173910583309, 'support': 66652}, '2': {'precision': 0.4460112440915854, 'recall': 0.4884502249394394, 'f1-score': 0.4662670419743571, 'support': 69352}, 'accuracy': 0.43165775295921976, 'macro avg': {'precision': 0.4321689437552767, 'recall': 0.43123730214867145, 'f1-score': 0.42896594993260656, 'support': 203432}, 'weighted avg': {'precision': 0.43237363952484903, 'recall': 0.43165775295921976, 'f1-score': 0.4292903088475008, 'support': 203432}}
[[23087 22741 21600]
 [15325 30851 20476]
 [14338 21139 33875]]
training model: results/ATVI/W0/deepOF_L1/seq2seq
Epoch 1/50
2538/2538 - 60s - loss: 12.6533 - accuracy10: 0.4216 - accuracy20: 0.4377 - accuracy30: 0.4402 - accuracy50: 0.4329 - val_loss: 12.9593 - val_accuracy10: 0.5198 - val_accuracy20: 0.4889 - val_accuracy30: 0.4418 - val_accuracy50: 0.3570 - 60s/epoch - 24ms/step
Epoch 2/50
2538/2538 - 56s - loss: 12.6448 - accuracy10: 0.4057 - accuracy20: 0.4297 - accuracy30: 0.4361 - accuracy50: 0.4302 - val_loss: 12.9252 - val_accuracy10: 0.5412 - val_accuracy20: 0.4924 - val_accuracy30: 0.4469 - val_accuracy50: 0.3709 - 56s/epoch - 22ms/step
Epoch 3/50
2538/2538 - 59s - loss: 12.6042 - accuracy10: 0.4194 - accuracy20: 0.4379 - accuracy30: 0.4417 - accuracy50: 0.4310 - val_loss: 12.8511 - val_accuracy10: 0.5429 - val_accuracy20: 0.4945 - val_accuracy30: 0.4525 - val_accuracy50: 0.3809 - 59s/epoch - 23ms/step
Epoch 4/50
2538/2538 - 61s - loss: 12.5414 - accuracy10: 0.4334 - accuracy20: 0.4481 - accuracy30: 0.4495 - accuracy50: 0.4362 - val_loss: 12.8599 - val_accuracy10: 0.5543 - val_accuracy20: 0.5002 - val_accuracy30: 0.4554 - val_accuracy50: 0.3830 - 61s/epoch - 24ms/step
Epoch 5/50
2538/2538 - 60s - loss: 12.4784 - accuracy10: 0.4422 - accuracy20: 0.4553 - accuracy30: 0.4556 - accuracy50: 0.4411 - val_loss: 12.9026 - val_accuracy10: 0.5608 - val_accuracy20: 0.5018 - val_accuracy30: 0.4549 - val_accuracy50: 0.3818 - 60s/epoch - 24ms/step
Epoch 6/50
2538/2538 - 59s - loss: 12.4155 - accuracy10: 0.4498 - accuracy20: 0.4611 - accuracy30: 0.4606 - accuracy50: 0.4455 - val_loss: 13.0673 - val_accuracy10: 0.5654 - val_accuracy20: 0.4990 - val_accuracy30: 0.4507 - val_accuracy50: 0.3785 - 59s/epoch - 23ms/step
Epoch 7/50
2538/2538 - 59s - loss: 12.3694 - accuracy10: 0.4563 - accuracy20: 0.4662 - accuracy30: 0.4648 - accuracy50: 0.4496 - val_loss: 13.1117 - val_accuracy10: 0.5683 - val_accuracy20: 0.4997 - val_accuracy30: 0.4512 - val_accuracy50: 0.3801 - 59s/epoch - 23ms/step
Epoch 8/50
2538/2538 - 58s - loss: 12.3231 - accuracy10: 0.4600 - accuracy20: 0.4695 - accuracy30: 0.4676 - accuracy50: 0.4526 - val_loss: 13.0802 - val_accuracy10: 0.5601 - val_accuracy20: 0.4975 - val_accuracy30: 0.4523 - val_accuracy50: 0.3858 - 58s/epoch - 23ms/step
Epoch 9/50
2538/2538 - 59s - loss: 12.2905 - accuracy10: 0.4615 - accuracy20: 0.4709 - accuracy30: 0.4691 - accuracy50: 0.4542 - val_loss: 13.1017 - val_accuracy10: 0.5544 - val_accuracy20: 0.4951 - val_accuracy30: 0.4528 - val_accuracy50: 0.3893 - 59s/epoch - 23ms/step
Epoch 10/50
2538/2538 - 53s - loss: 12.2600 - accuracy10: 0.4651 - accuracy20: 0.4736 - accuracy30: 0.4714 - accuracy50: 0.4565 - val_loss: 13.0914 - val_accuracy10: 0.5604 - val_accuracy20: 0.4987 - val_accuracy30: 0.4559 - val_accuracy50: 0.3921 - 53s/epoch - 21ms/step
Epoch 11/50
2538/2538 - 59s - loss: 12.2263 - accuracy10: 0.4686 - accuracy20: 0.4770 - accuracy30: 0.4739 - accuracy50: 0.4587 - val_loss: 13.0680 - val_accuracy10: 0.5556 - val_accuracy20: 0.4986 - val_accuracy30: 0.4573 - val_accuracy50: 0.3953 - 59s/epoch - 23ms/step
Epoch 12/50
2538/2538 - 56s - loss: 12.1971 - accuracy10: 0.4712 - accuracy20: 0.4793 - accuracy30: 0.4767 - accuracy50: 0.4610 - val_loss: 13.0786 - val_accuracy10: 0.5590 - val_accuracy20: 0.5007 - val_accuracy30: 0.4584 - val_accuracy50: 0.3965 - 56s/epoch - 22ms/step
Epoch 13/50
2538/2538 - 57s - loss: 12.1718 - accuracy10: 0.4743 - accuracy20: 0.4819 - accuracy30: 0.4787 - accuracy50: 0.4627 - val_loss: 13.0517 - val_accuracy10: 0.5584 - val_accuracy20: 0.4999 - val_accuracy30: 0.4584 - val_accuracy50: 0.3973 - 57s/epoch - 23ms/step
testing model: results/ATVI/W0/deepOF_L1/seq2seq
Evaluating performance on  test set...
11876/11876 - 111s - 111s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0300859
{'0': {'precision': 0.43536330004799545, 'recall': 0.2610512187730008, 'f1-score': 0.3263921616079275, 'support': 785298}, '1': {'precision': 0.5137872456602028, 'recall': 0.6498848544355881, 'f1-score': 0.5738773823472377, 'support': 1459457}, '2': {'precision': 0.3847960930392051, 'recall': 0.3498784886578937, 'f1-score': 0.36650750911517754, 'support': 795399}, 'accuracy': 0.47095476084435195, 'macro avg': {'precision': 0.44464887958246785, 'recall': 0.42027152062216083, 'f1-score': 0.42225901769011426, 'support': 3040154}, 'weighted avg': {'precision': 0.45978155994659614, 'recall': 0.47095476084435195, 'f1-score': 0.455695395949494, 'support': 3040154}}
[[205003 450209 130086]
 [196135 948479 314843]
 [ 69740 447366 278293]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0734413
{'0': {'precision': 0.5180202119971637, 'recall': 0.2330868914170733, 'f1-score': 0.3215086646279307, 'support': 981029}, '1': {'precision': 0.37902561660853284, 'recall': 0.6877205522318338, 'f1-score': 0.48870802441670363, 'support': 1066074}, '2': {'precision': 0.4529938200065623, 'recall': 0.3030760756496897, 'f1-score': 0.3631716857129584, 'support': 993051}, 'accuracy': 0.41537237916237135, 'macro avg': {'precision': 0.45001321620408624, 'recall': 0.4079611730995323, 'f1-score': 0.39112945825253087, 'support': 3040154}, 'weighted avg': {'precision': 0.44803920186511187, 'recall': 0.41537237916237135, 'f1-score': 0.3937485561067716, 'support': 3040154}}
[[228665 595376 156988]
 [126469 733161 206444]
 [ 86287 605794 300970]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1009543
{'0': {'precision': 0.5522825132890925, 'recall': 0.19611163823856073, 'f1-score': 0.28944381307777123, 'support': 1087656}, '1': {'precision': 0.2986231786549526, 'recall': 0.7316296459099921, 'f1-score': 0.4241319514015401, 'support': 846282}, '2': {'precision': 0.48364442515192857, 'recall': 0.25381390252898167, 'f1-score': 0.3329155679080268, 'support': 1106216}, 'accuracy': 0.3661788185730065, 'macro avg': {'precision': 0.4448500390319912, 'recall': 0.39385172889251147, 'f1-score': 0.34883044412911274, 'support': 3040154}, 'weighted avg': {'precision': 0.4566966053582475, 'recall': 0.3661788185730065, 'f1-score': 0.34275469726923713, 'support': 3040154}}
[[213302 716436 157918]
 [ 85272 619165 141845]
 [ 87645 737798 280773]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1333466
{'0': {'precision': 0.5700964279594348, 'recall': 0.15251288992760303, 'f1-score': 0.24064747468171724, 'support': 1199774}, '1': {'precision': 0.21124504416186293, 'recall': 0.7769624559356434, 'f1-score': 0.33217612353688847, 'support': 608485}, '2': {'precision': 0.507508749470044, 'recall': 0.19823036865966662, 'f1-score': 0.2851015167532852, 'support': 1231895}, 'accuracy': 0.29602118840032443, 'macro avg': {'precision': 0.42961674053044724, 'recall': 0.375901904840971, 'f1-score': 0.28597503832396365, 'support': 3040154}, 'weighted avg': {'precision': 0.47291150493818207, 'recall': 0.29602118840032443, 'f1-score': 0.27698001640703546, 'support': 3040154}}
[[182981 865871 150922]
 [ 49664 472770  86051]
 [ 88320 899376 244199]]
Evaluating performance on  train set...
2538/2538 - 21s - 21s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.978514
{'0': {'precision': 0.3479838709677419, 'recall': 0.28780706035464454, 'f1-score': 0.3150476360074793, 'support': 122940}, '1': {'precision': 0.6616791965229649, 'recall': 0.6720504675406022, 'f1-score': 0.6668245077946388, 'support': 402318}, '2': {'precision': 0.3248636233132357, 'recall': 0.3639258318189859, 'f1-score': 0.34328709146484837, 'support': 124366}, 'accuracy': 0.5403448764208219, 'macro avg': {'precision': 0.4448422302679808, 'recall': 0.4412611199047442, 'f1-score': 0.44171974508898887, 'support': 649624}, 'weighted avg': {'precision': 0.5378320035289248, 'recall': 0.5403448764208219, 'f1-score': 0.5383124716987062, 'support': 649624}}
[[ 35383  70760  16797]
 [ 54677 270378  77263]
 [ 11620  67486  45260]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.018431
{'0': {'precision': 0.42734477510103397, 'recall': 0.25233361018482936, 'f1-score': 0.3173072801175356, 'support': 161338}, '1': {'precision': 0.5400100253444455, 'recall': 0.7093800386475808, 'f1-score': 0.6132149497410581, 'support': 324988}, '2': {'precision': 0.4008756993432255, 'recall': 0.3128513515168587, 'f1-score': 0.35143547993217283, 'support': 163298}, 'accuracy': 0.49619318251788724, 'macro avg': {'precision': 0.45607683326290166, 'recall': 0.424855000116423, 'f1-score': 0.4273192365969221, 'support': 649624}, 'weighted avg': {'precision': 0.47705431048305064, 'recall': 0.49619318251788724, 'f1-score': 0.4739201954484654, 'support': 649624}}
[[ 40711  98989  21638]
 [ 39733 230540  54715]
 [ 14821  97389  51088]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0479822
{'0': {'precision': 0.47050297665392954, 'recall': 0.21082830581617537, 'f1-score': 0.2911809511807288, 'support': 186308}, '1': {'precision': 0.4568467101936732, 'recall': 0.7544125227795808, 'f1-score': 0.5690786411010521, 'support': 275466}, '2': {'precision': 0.4409578340868846, 'recall': 0.26114985360660103, 'f1-score': 0.3280296622211227, 'support': 187850}, 'accuracy': 0.45588063248894745, 'macro avg': {'precision': 0.4561025069781624, 'recall': 0.4087968940674524, 'f1-score': 0.3960964181676345, 'support': 649624}, 'weighted avg': {'precision': 0.45616869693526096, 'recall': 0.45588063248894745, 'f1-score': 0.4196758888993626, 'support': 649624}}
[[ 39279 123925  23104]
 [ 28561 207815  39090]
 [ 15643 123150  49057]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0870881
{'0': {'precision': 0.5076119616540278, 'recall': 0.16307665434754628, 'f1-score': 0.24684975542551785, 'support': 217548}, '1': {'precision': 0.35184029303427633, 'recall': 0.8023307534916823, 'f1-score': 0.48916889445220746, 'support': 213579}, '2': {'precision': 0.47475510292150347, 'recall': 0.20140322292754592, 'f1-score': 0.2828249070500564, 'support': 218497}, 'accuracy': 0.38613721167937143, 'macro avg': {'precision': 0.4447357858699359, 'recall': 0.38893687692225815, 'f1-score': 0.3396145189759272, 'support': 649624}, 'weighted avg': {'precision': 0.4453472019243715, 'recall': 0.38613721167937143, 'f1-score': 0.3386178275698477, 'support': 649624}}
[[ 35477 157658  24413]
 [ 17945 171361  24273]
 [ 16468 158023  44006]]
Evaluating performance on  val set...
795/795 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.978192
{'0': {'precision': 0.34676185619581845, 'recall': 0.28424380176084857, 'f1-score': 0.31240578295263666, 'support': 38277}, '1': {'precision': 0.6585123037405195, 'recall': 0.6868886246531907, 'f1-score': 0.6724012167489214, 'support': 126150}, '2': {'precision': 0.32065727699530516, 'recall': 0.3327009357774644, 'f1-score': 0.3265681031770997, 'support': 39005}, 'accuracy': 0.5432183727240553, 'macro avg': {'precision': 0.441977145643881, 'recall': 0.43461112073050123, 'f1-score': 0.4371250342928859, 'support': 203432}, 'weighted avg': {'precision': 0.5350759358197126, 'recall': 0.5432183727240553, 'f1-score': 0.5383575765434017, 'support': 203432}}
[[10880 22242  5155]
 [17161 86651 22338]
 [ 3335 22693 12977]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0204542
{'0': {'precision': 0.4271559382260489, 'recall': 0.24882077818688428, 'f1-score': 0.31446430143498544, 'support': 50245}, '1': {'precision': 0.5360921650926898, 'recall': 0.7229729065733743, 'f1-score': 0.6156633513395902, 'support': 101759}, '2': {'precision': 0.3937777537095202, 'recall': 0.28278369759663996, 'f1-score': 0.3291760977818017, 'support': 51428}, 'accuracy': 0.4945829564670258, 'macro avg': {'precision': 0.45234195234275293, 'recall': 0.4181924607856329, 'f1-score': 0.4197679168521258, 'support': 203432}, 'weighted avg': {'precision': 0.47320900871843197, 'recall': 0.4945829564670258, 'f1-score': 0.46884666203590725, 'support': 203432}}
[[12502 31119  6624]
 [12425 73569 15765]
 [ 4341 32544 14543]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0510373
{'0': {'precision': 0.47120028269661157, 'recall': 0.20713163844733254, 'f1-score': 0.2877661615192787, 'support': 57939}, '1': {'precision': 0.4532380018782947, 'recall': 0.768444909344491, 'f1-score': 0.5701781240702493, 'support': 86040}, '2': {'precision': 0.43299258243470673, 'recall': 0.23368038618740855, 'f1-score': 0.30354275226952443, 'support': 59453}, 'accuracy': 0.45229364111840814, 'macro avg': {'precision': 0.45247695566987095, 'recall': 0.403085644659744, 'f1-score': 0.3871623459530175, 'support': 203432}, 'weighted avg': {'precision': 0.4524370741292328, 'recall': 0.45229364111840814, 'f1-score': 0.4118208378128799, 'support': 203432}}
[[12001 38816  7122]
 [ 8852 66117 11071]
 [ 4616 40944 13893]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0901347
{'0': {'precision': 0.5104107782174486, 'recall': 0.1607996200765783, 'f1-score': 0.2445547906556822, 'support': 67382}, '1': {'precision': 0.3489187609585038, 'recall': 0.8148398128149748, 'f1-score': 0.48861147711277897, 'support': 66672}, '2': {'precision': 0.4650039618156435, 'recall': 0.17763556170543976, 'f1-score': 0.2570686580240089, 'support': 69378}, 'accuracy': 0.3808938613394156, 'macro avg': {'precision': 0.441444500330532, 'recall': 0.3844249981989976, 'f1-score': 0.33007830859749004, 'support': 203432}, 'weighted avg': {'precision': 0.44199858208796655, 'recall': 0.3808938613394156, 'f1-score': 0.3288086665933288, 'support': 203432}}
[[10835 49254  7293]
 [ 5459 54327  6886]
 [ 4934 52120 12324]]
training model: results/ATVI/W0/deepLOB_L2/seq2seq
Epoch 1/50
2538/2538 - 126s - loss: 12.3026 - accuracy10: 0.4392 - accuracy20: 0.4563 - accuracy30: 0.4620 - accuracy50: 0.4570 - val_loss: 13.1723 - val_accuracy10: 0.4835 - val_accuracy20: 0.4625 - val_accuracy30: 0.4387 - val_accuracy50: 0.3970 - 126s/epoch - 50ms/step
Epoch 2/50
2538/2538 - 119s - loss: 12.0699 - accuracy10: 0.4535 - accuracy20: 0.4759 - accuracy30: 0.4810 - accuracy50: 0.4727 - val_loss: 13.1327 - val_accuracy10: 0.4800 - val_accuracy20: 0.4751 - val_accuracy30: 0.4623 - val_accuracy50: 0.4327 - 119s/epoch - 47ms/step
Epoch 3/50
2538/2538 - 118s - loss: 11.7884 - accuracy10: 0.4948 - accuracy20: 0.5080 - accuracy30: 0.5059 - accuracy50: 0.4874 - val_loss: 12.4352 - val_accuracy10: 0.5727 - val_accuracy20: 0.5299 - val_accuracy30: 0.4899 - val_accuracy50: 0.4281 - 118s/epoch - 47ms/step
Epoch 4/50
2538/2538 - 119s - loss: 11.3678 - accuracy10: 0.5506 - accuracy20: 0.5492 - accuracy30: 0.5371 - accuracy50: 0.5061 - val_loss: 11.8813 - val_accuracy10: 0.5486 - val_accuracy20: 0.5338 - val_accuracy30: 0.5135 - val_accuracy50: 0.4758 - 119s/epoch - 47ms/step
Epoch 5/50
2538/2538 - 119s - loss: 11.0616 - accuracy10: 0.5798 - accuracy20: 0.5722 - accuracy30: 0.5547 - accuracy50: 0.5182 - val_loss: 11.7788 - val_accuracy10: 0.5425 - val_accuracy20: 0.5354 - val_accuracy30: 0.5195 - val_accuracy50: 0.4872 - 119s/epoch - 47ms/step
Epoch 6/50
2538/2538 - 119s - loss: 10.9368 - accuracy10: 0.5882 - accuracy20: 0.5791 - accuracy30: 0.5609 - accuracy50: 0.5234 - val_loss: 11.7031 - val_accuracy10: 0.5406 - val_accuracy20: 0.5375 - val_accuracy30: 0.5235 - val_accuracy50: 0.4916 - 119s/epoch - 47ms/step
Epoch 7/50
2538/2538 - 120s - loss: 10.8636 - accuracy10: 0.5918 - accuracy20: 0.5825 - accuracy30: 0.5644 - accuracy50: 0.5260 - val_loss: 11.6063 - val_accuracy10: 0.5468 - val_accuracy20: 0.5427 - val_accuracy30: 0.5271 - val_accuracy50: 0.4965 - 120s/epoch - 47ms/step
Epoch 8/50
2538/2538 - 119s - loss: 10.8145 - accuracy10: 0.5954 - accuracy20: 0.5852 - accuracy30: 0.5665 - accuracy50: 0.5279 - val_loss: 11.5717 - val_accuracy10: 0.5496 - val_accuracy20: 0.5442 - val_accuracy30: 0.5280 - val_accuracy50: 0.4952 - 119s/epoch - 47ms/step
Epoch 9/50
2538/2538 - 118s - loss: 10.7729 - accuracy10: 0.5962 - accuracy20: 0.5866 - accuracy30: 0.5683 - accuracy50: 0.5297 - val_loss: 11.5840 - val_accuracy10: 0.5406 - val_accuracy20: 0.5388 - val_accuracy30: 0.5259 - val_accuracy50: 0.4959 - 118s/epoch - 46ms/step
Epoch 10/50
2538/2538 - 118s - loss: 10.7415 - accuracy10: 0.5979 - accuracy20: 0.5888 - accuracy30: 0.5705 - accuracy50: 0.5313 - val_loss: 11.5572 - val_accuracy10: 0.5444 - val_accuracy20: 0.5406 - val_accuracy30: 0.5265 - val_accuracy50: 0.4952 - 118s/epoch - 47ms/step
Epoch 11/50
2538/2538 - 118s - loss: 10.7144 - accuracy10: 0.5991 - accuracy20: 0.5908 - accuracy30: 0.5718 - accuracy50: 0.5324 - val_loss: 11.5748 - val_accuracy10: 0.5394 - val_accuracy20: 0.5387 - val_accuracy30: 0.5255 - val_accuracy50: 0.4951 - 118s/epoch - 46ms/step
Epoch 12/50
2538/2538 - 119s - loss: 10.6899 - accuracy10: 0.6007 - accuracy20: 0.5914 - accuracy30: 0.5724 - accuracy50: 0.5333 - val_loss: 11.5885 - val_accuracy10: 0.5468 - val_accuracy20: 0.5426 - val_accuracy30: 0.5268 - val_accuracy50: 0.4918 - 119s/epoch - 47ms/step
Epoch 13/50
2538/2538 - 118s - loss: 10.6652 - accuracy10: 0.6016 - accuracy20: 0.5926 - accuracy30: 0.5735 - accuracy50: 0.5348 - val_loss: 11.5732 - val_accuracy10: 0.5465 - val_accuracy20: 0.5416 - val_accuracy30: 0.5263 - val_accuracy50: 0.4930 - 118s/epoch - 47ms/step
Epoch 14/50
2538/2538 - 118s - loss: 10.6442 - accuracy10: 0.6023 - accuracy20: 0.5938 - accuracy30: 0.5753 - accuracy50: 0.5359 - val_loss: 11.5347 - val_accuracy10: 0.5468 - val_accuracy20: 0.5425 - val_accuracy30: 0.5269 - val_accuracy50: 0.4935 - 118s/epoch - 46ms/step
Epoch 15/50
2538/2538 - 117s - loss: 10.6246 - accuracy10: 0.6025 - accuracy20: 0.5946 - accuracy30: 0.5760 - accuracy50: 0.5372 - val_loss: 11.5653 - val_accuracy10: 0.5373 - val_accuracy20: 0.5365 - val_accuracy30: 0.5230 - val_accuracy50: 0.4933 - 117s/epoch - 46ms/step
Epoch 16/50
2538/2538 - 118s - loss: 10.6091 - accuracy10: 0.6032 - accuracy20: 0.5955 - accuracy30: 0.5769 - accuracy50: 0.5375 - val_loss: 11.6346 - val_accuracy10: 0.5363 - val_accuracy20: 0.5335 - val_accuracy30: 0.5194 - val_accuracy50: 0.4884 - 118s/epoch - 46ms/step
Epoch 17/50
2538/2538 - 119s - loss: 10.5915 - accuracy10: 0.6035 - accuracy20: 0.5962 - accuracy30: 0.5781 - accuracy50: 0.5392 - val_loss: 11.6071 - val_accuracy10: 0.5338 - val_accuracy20: 0.5344 - val_accuracy30: 0.5235 - val_accuracy50: 0.4940 - 119s/epoch - 47ms/step
Epoch 18/50
2538/2538 - 119s - loss: 10.5765 - accuracy10: 0.6042 - accuracy20: 0.5975 - accuracy30: 0.5793 - accuracy50: 0.5400 - val_loss: 11.6293 - val_accuracy10: 0.5424 - val_accuracy20: 0.5395 - val_accuracy30: 0.5248 - val_accuracy50: 0.4903 - 119s/epoch - 47ms/step
Epoch 19/50
2538/2538 - 118s - loss: 10.5552 - accuracy10: 0.6042 - accuracy20: 0.5982 - accuracy30: 0.5799 - accuracy50: 0.5410 - val_loss: 11.6554 - val_accuracy10: 0.5365 - val_accuracy20: 0.5348 - val_accuracy30: 0.5207 - val_accuracy50: 0.4896 - 118s/epoch - 47ms/step
Epoch 20/50
2538/2538 - 119s - loss: 10.5394 - accuracy10: 0.6048 - accuracy20: 0.5991 - accuracy30: 0.5807 - accuracy50: 0.5420 - val_loss: 11.5720 - val_accuracy10: 0.5501 - val_accuracy20: 0.5453 - val_accuracy30: 0.5288 - val_accuracy50: 0.4934 - 119s/epoch - 47ms/step
Epoch 21/50
2538/2538 - 119s - loss: 10.5245 - accuracy10: 0.6053 - accuracy20: 0.5990 - accuracy30: 0.5811 - accuracy50: 0.5427 - val_loss: 11.6863 - val_accuracy10: 0.5342 - val_accuracy20: 0.5329 - val_accuracy30: 0.5199 - val_accuracy50: 0.4889 - 119s/epoch - 47ms/step
Epoch 22/50
2538/2538 - 118s - loss: 10.5092 - accuracy10: 0.6060 - accuracy20: 0.6006 - accuracy30: 0.5822 - accuracy50: 0.5437 - val_loss: 11.7145 - val_accuracy10: 0.5319 - val_accuracy20: 0.5309 - val_accuracy30: 0.5185 - val_accuracy50: 0.4894 - 118s/epoch - 47ms/step
Epoch 23/50
2538/2538 - 118s - loss: 10.4960 - accuracy10: 0.6059 - accuracy20: 0.6003 - accuracy30: 0.5830 - accuracy50: 0.5443 - val_loss: 11.6722 - val_accuracy10: 0.5509 - val_accuracy20: 0.5436 - val_accuracy30: 0.5266 - val_accuracy50: 0.4898 - 118s/epoch - 47ms/step
Epoch 24/50
2538/2538 - 118s - loss: 10.4806 - accuracy10: 0.6066 - accuracy20: 0.6014 - accuracy30: 0.5836 - accuracy50: 0.5458 - val_loss: 11.6731 - val_accuracy10: 0.5370 - val_accuracy20: 0.5366 - val_accuracy30: 0.5234 - val_accuracy50: 0.4920 - 118s/epoch - 46ms/step
testing model: results/ATVI/W0/deepLOB_L2/seq2seq
Evaluating performance on  test set...
11876/11876 - 191s - 191s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.98391664
{'0': {'precision': 0.5095012388236562, 'recall': 0.36136763020501717, 'f1-score': 0.42283577197008076, 'support': 785300}, '1': {'precision': 0.643989955188619, 'recall': 0.5698400158415082, 'f1-score': 0.6046501652204576, 'support': 1459457}, '2': {'precision': 0.41553207592765695, 'recall': 0.6225996414391717, 'f1-score': 0.49841482954636956, 'support': 795402}, 'accuracy': 0.5297933430455447, 'macro avg': {'precision': 0.5230077566466441, 'recall': 0.5179357624952323, 'f1-score': 0.5086335889123026, 'support': 3040159}, 'weighted avg': {'precision': 0.5494785026490205, 'recall': 0.5297933430455447, 'f1-score': 0.5298913642875583, 'support': 3040159}}
[[283782 253587 247931]
 [179182 831657 448618]
 [ 94016 206169 495217]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.99700737
{'0': {'precision': 0.5710974995719316, 'recall': 0.34338093636280237, 'f1-score': 0.4288870824100239, 'support': 981030}, '1': {'precision': 0.509331531180424, 'recall': 0.5761663824462467, 'f1-score': 0.5406914229905384, 'support': 1066074}, '2': {'precision': 0.47642395335661214, 'recall': 0.5969770053018212, 'f1-score': 0.5299308569359834, 'support': 993055}, 'accuracy': 0.5078464646092523, 'macro avg': {'precision': 0.5189509947029892, 'recall': 0.5055081080369567, 'f1-score': 0.49983645411218197, 'support': 3040159}, 'weighted avg': {'precision': 0.5185136934539416, 'recall': 0.5078464646092523, 'f1-score': 0.501098347048455, 'support': 3040159}}
[[336867 319014 325149]
 [125483 614236 326355]
 [127509 272715 592831]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0139805
{'0': {'precision': 0.580349173421265, 'recall': 0.3246020348308016, 'f1-score': 0.4163374133038209, 'support': 1087658}, '1': {'precision': 0.4189318505336506, 'recall': 0.5602369420158505, 'f1-score': 0.4793884377072784, 'support': 846283}, '2': {'precision': 0.49583370190181336, 'recall': 0.5827251048165913, 'f1-score': 0.5357793086710555, 'support': 1106218}, 'accuracy': 0.48411810040198555, 'macro avg': {'precision': 0.49837157528557635, 'recall': 0.4891880272210811, 'f1-score': 0.4771683865607182, 'support': 3040159}, 'weighted avg': {'precision': 0.5046632398439082, 'recall': 0.48411810040198555, 'f1-score': 0.47734994083760535, 'support': 3040159}}
[[353056 348487 386115]
 [102825 474119 269339]
 [152470 309127 644621]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0452209
{'0': {'precision': 0.5682802957248473, 'recall': 0.2947078542863763, 'f1-score': 0.3881320191572017, 'support': 1199778}, '1': {'precision': 0.30129918706600334, 'recall': 0.532174939111171, 'f1-score': 0.38476029787878696, 'support': 608486}, '2': {'precision': 0.505403473768063, 'recall': 0.5510721287122685, 'f1-score': 0.5272507334652372, 'support': 1231895}, 'accuracy': 0.44611745635672345, 'macro avg': {'precision': 0.4583276521863045, 'recall': 0.45931830736993867, 'f1-score': 0.43338101683374197, 'support': 3040159}, 'weighted avg': {'precision': 0.48936603187620054, 'recall': 0.44611745635672345, 'f1-score': 0.4438291071610462, 'support': 3040159}}
[[353584 387833 458361]
 [ 78679 323821 205986]
 [189937 363095 678863]]
Evaluating performance on  train set...
2538/2538 - 45s - 45s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9036923
{'0': {'precision': 0.45230667051184575, 'recall': 0.4216524912829537, 'f1-score': 0.4364419821483533, 'support': 122748}, '1': {'precision': 0.7753190275011942, 'recall': 0.6212102007391336, 'f1-score': 0.6897615588293327, 'support': 402363}, '2': {'precision': 0.3674122456651473, 'recall': 0.6279534831424579, 'f1-score': 0.46358397267908596, 'support': 124514}, 'accuracy': 0.5847958437560131, 'macro avg': {'precision': 0.5316793145593958, 'recall': 0.5569387250548483, 'f1-score': 0.529929171218924, 'support': 649625}, 'weighted avg': {'precision': 0.6361014391552067, 'recall': 0.5847958437560131, 'f1-score': 0.5985447070142876, 'support': 649625}}
[[ 51757  41076  29915]
 [ 47705 249952 104706]
 [ 14967  31358  78189]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.93002695
{'0': {'precision': 0.5255332021098017, 'recall': 0.38258738872863746, 'f1-score': 0.4428098592054911, 'support': 161205}, '1': {'precision': 0.6665247822928302, 'recall': 0.6407855709943018, 'f1-score': 0.6534017911346834, 'support': 325012}, '2': {'precision': 0.43702884803486697, 'recall': 0.5878659551551944, 'f1-score': 0.5013478073666219, 'support': 163408}, 'accuracy': 0.5634019626707716, 'macro avg': {'precision': 0.543028944145833, 'recall': 0.5370796382927112, 'f1-score': 0.5325198192355988, 'support': 649625}, 'weighted avg': {'precision': 0.5738097246693854, 'recall': 0.5634019626707716, 'f1-score': 0.5628952531070262, 'support': 649625}}
[[ 61675  57542  41988]
 [ 34992 208263  81757]
 [ 20690  46656  96062]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9596185
{'0': {'precision': 0.5532516014083909, 'recall': 0.3502263804372929, 'f1-score': 0.42892756597468884, 'support': 186191}, '1': {'precision': 0.5820253701859501, 'recall': 0.6469894342553709, 'f1-score': 0.6127904458401658, 'support': 275513}, '2': {'precision': 0.4656599924610302, 'recall': 0.5587667158007886, 'f1-score': 0.5079822745128394, 'support': 187921}, 'accuracy': 0.536412545699442, 'macro avg': {'precision': 0.5336456546851238, 'recall': 0.5186608434978175, 'f1-score': 0.5165667621092314, 'support': 649625}, 'weighted avg': {'precision': 0.5401167076038339, 'recall': 0.536412545699442, 'f1-score': 0.5297744445639903, 'support': 649625}}
[[ 65209  69506  51476]
 [ 28244 178254  69015]
 [ 24412  58505 105004]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0108354
{'0': {'precision': 0.5633844215830359, 'recall': 0.3082525387124937, 'f1-score': 0.3984793810605723, 'support': 217630}, '1': {'precision': 0.4588950655592674, 'recall': 0.6512567051603383, 'f1-score': 0.538410145878963, 'support': 213455}, '2': {'precision': 0.4856733650238558, 'recall': 0.5058478996979958, 'f1-score': 0.4955553862084732, 'support': 218540}, 'accuracy': 0.4874304406388301, 'macro avg': {'precision': 0.502650950722053, 'recall': 0.4884523811902759, 'f1-score': 0.47748163771600277, 'support': 649625}, 'weighted avg': {'precision': 0.5029083780340704, 'recall': 0.4874304406388301, 'f1-score': 0.4771153811672982, 'support': 649625}}
[[ 67085  86397  64148]
 [ 21519 139014  52922]
 [ 30471  77521 110548]]
Evaluating performance on  val set...
795/795 - 14s - 14s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9641534
{'0': {'precision': 0.3963475236044393, 'recall': 0.4983079085749987, 'f1-score': 0.441517702687118, 'support': 38414}, '1': {'precision': 0.8166084332068477, 'recall': 0.5174542713169067, 'f1-score': 0.6334897457569487, 'support': 126015}, '2': {'precision': 0.3556352527063824, 'recall': 0.6864600158962131, 'f1-score': 0.4685356292874142, 'support': 39003}, 'accuracy': 0.5462414959298438, 'macro avg': {'precision': 0.5228637365058898, 'recall': 0.5674073985960395, 'f1-score': 0.5145143592438269, 'support': 203432}, 'weighted avg': {'precision': 0.6488706164399352, 'recall': 0.5462414959298438, 'f1-score': 0.5656138979692569, 'support': 203432}}
[[19142  8096 11176]
 [23473 65207 37335]
 [ 5681  6548 26774]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.96524024
{'0': {'precision': 0.4671483681342233, 'recall': 0.45493758447960564, 'f1-score': 0.4609621252555362, 'support': 50308}, '1': {'precision': 0.7096315617867623, 'recall': 0.5348622320085717, 'f1-score': 0.6099751126656353, 'support': 101729}, '2': {'precision': 0.4242580114191657, 'recall': 0.6419301488471642, 'f1-score': 0.5108741938231173, 'support': 51395}, 'accuracy': 0.5421467615714342, 'macro avg': {'precision': 0.5336793137800504, 'recall': 0.5439099884451138, 'f1-score': 0.5272704772480963, 'support': 203432}, 'weighted avg': {'precision': 0.5775696534959596, 'recall': 0.5421467615714342, 'f1-score': 0.5480879115638495, 'support': 203432}}
[[22887 12013 15408]
 [17954 54411 29364]
 [ 8152 10251 32992]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.97778314
{'0': {'precision': 0.4983582334592021, 'recall': 0.4185814013617168, 'f1-score': 0.4549993910607721, 'support': 58015}, '1': {'precision': 0.6232834542388307, 'recall': 0.5413687673653496, 'f1-score': 0.5794454156893731, 'support': 86019}, '2': {'precision': 0.4531316414551819, 'recall': 0.6102225664163776, 'f1-score': 0.5200734639997705, 'support': 59398}, 'accuracy': 0.5264560147862677, 'macro avg': {'precision': 0.5249244430510717, 'recall': 0.5233909117144814, 'f1-score': 0.5181727569166386, 'support': 203432}, 'weighted avg': {'precision': 0.5379762554733792, 'recall': 0.5264560147862677, 'f1-score': 0.5266203375045875, 'support': 203432}}
[[24284 14907 18824]
 [14531 46568 24920]
 [ 9913 13239 36246]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0046922
{'0': {'precision': 0.5177484369858506, 'recall': 0.3733612149255502, 'f1-score': 0.4338572364112639, 'support': 67428}, '1': {'precision': 0.49712149736705685, 'recall': 0.5467202784612615, 'f1-score': 0.5207425296883262, 'support': 66652}, '2': {'precision': 0.4771795941403087, 'recall': 0.5608057446072211, 'f1-score': 0.5156239642577789, 'support': 69352}, 'accuracy': 0.4940618978331826, 'macro avg': {'precision': 0.4973498428310721, 'recall': 0.49362907933134426, 'f1-score': 0.4900745767857897, 'support': 203432}, 'weighted avg': {'precision': 0.4971599495871333, 'recall': 0.4940618978331826, 'f1-score': 0.49019923116682973, 'support': 203432}}
[[25175 18832 23421]
 [11020 36440 19192]
 [12429 18030 38893]]
training model: results/ATVI/W0/deepOF_L2/seq2seq
Epoch 1/50
2538/2538 - 80s - loss: 11.5777 - accuracy10: 0.5352 - accuracy20: 0.5368 - accuracy30: 0.5243 - accuracy50: 0.4932 - val_loss: 12.4330 - val_accuracy10: 0.6237 - val_accuracy20: 0.5742 - val_accuracy30: 0.5278 - val_accuracy50: 0.4555 - 80s/epoch - 31ms/step
Epoch 2/50
2538/2538 - 72s - loss: 11.0797 - accuracy10: 0.5828 - accuracy20: 0.5736 - accuracy30: 0.5552 - accuracy50: 0.5158 - val_loss: 12.2884 - val_accuracy10: 0.6219 - val_accuracy20: 0.5799 - val_accuracy30: 0.5353 - val_accuracy50: 0.4642 - 72s/epoch - 28ms/step
Epoch 3/50
2538/2538 - 73s - loss: 10.9874 - accuracy10: 0.5878 - accuracy20: 0.5782 - accuracy30: 0.5593 - accuracy50: 0.5195 - val_loss: 12.2480 - val_accuracy10: 0.6198 - val_accuracy20: 0.5802 - val_accuracy30: 0.5361 - val_accuracy50: 0.4652 - 73s/epoch - 29ms/step
Epoch 4/50
2538/2538 - 72s - loss: 10.9372 - accuracy10: 0.5903 - accuracy20: 0.5804 - accuracy30: 0.5613 - accuracy50: 0.5211 - val_loss: 12.2380 - val_accuracy10: 0.6202 - val_accuracy20: 0.5815 - val_accuracy30: 0.5372 - val_accuracy50: 0.4652 - 72s/epoch - 28ms/step
Epoch 5/50
2538/2538 - 71s - loss: 10.8951 - accuracy10: 0.5921 - accuracy20: 0.5823 - accuracy30: 0.5634 - accuracy50: 0.5232 - val_loss: 12.2693 - val_accuracy10: 0.6210 - val_accuracy20: 0.5829 - val_accuracy30: 0.5387 - val_accuracy50: 0.4651 - 71s/epoch - 28ms/step
Epoch 6/50
2538/2538 - 73s - loss: 10.8604 - accuracy10: 0.5926 - accuracy20: 0.5836 - accuracy30: 0.5646 - accuracy50: 0.5250 - val_loss: 12.1945 - val_accuracy10: 0.6206 - val_accuracy20: 0.5838 - val_accuracy30: 0.5414 - val_accuracy50: 0.4687 - 73s/epoch - 29ms/step
Epoch 7/50
2538/2538 - 73s - loss: 10.8331 - accuracy10: 0.5935 - accuracy20: 0.5848 - accuracy30: 0.5661 - accuracy50: 0.5266 - val_loss: 12.1543 - val_accuracy10: 0.6221 - val_accuracy20: 0.5852 - val_accuracy30: 0.5417 - val_accuracy50: 0.4684 - 73s/epoch - 29ms/step
Epoch 8/50
2538/2538 - 74s - loss: 10.8089 - accuracy10: 0.5938 - accuracy20: 0.5855 - accuracy30: 0.5672 - accuracy50: 0.5277 - val_loss: 12.1414 - val_accuracy10: 0.6236 - val_accuracy20: 0.5864 - val_accuracy30: 0.5435 - val_accuracy50: 0.4710 - 74s/epoch - 29ms/step
Epoch 9/50
2538/2538 - 74s - loss: 10.7860 - accuracy10: 0.5951 - accuracy20: 0.5869 - accuracy30: 0.5683 - accuracy50: 0.5286 - val_loss: 12.1114 - val_accuracy10: 0.6197 - val_accuracy20: 0.5860 - val_accuracy30: 0.5440 - val_accuracy50: 0.4723 - 74s/epoch - 29ms/step
Epoch 10/50
2538/2538 - 73s - loss: 10.7633 - accuracy10: 0.5955 - accuracy20: 0.5879 - accuracy30: 0.5692 - accuracy50: 0.5299 - val_loss: 12.0475 - val_accuracy10: 0.6168 - val_accuracy20: 0.5851 - val_accuracy30: 0.5453 - val_accuracy50: 0.4744 - 73s/epoch - 29ms/step
Epoch 11/50
2538/2538 - 73s - loss: 10.7471 - accuracy10: 0.5960 - accuracy20: 0.5889 - accuracy30: 0.5702 - accuracy50: 0.5308 - val_loss: 12.0728 - val_accuracy10: 0.6179 - val_accuracy20: 0.5853 - val_accuracy30: 0.5439 - val_accuracy50: 0.4728 - 73s/epoch - 29ms/step
Epoch 12/50
2538/2538 - 77s - loss: 10.7277 - accuracy10: 0.5967 - accuracy20: 0.5892 - accuracy30: 0.5706 - accuracy50: 0.5316 - val_loss: 12.1238 - val_accuracy10: 0.6188 - val_accuracy20: 0.5856 - val_accuracy30: 0.5451 - val_accuracy50: 0.4731 - 77s/epoch - 30ms/step
Epoch 13/50
2538/2538 - 74s - loss: 10.7082 - accuracy10: 0.5977 - accuracy20: 0.5908 - accuracy30: 0.5722 - accuracy50: 0.5325 - val_loss: 12.1049 - val_accuracy10: 0.6167 - val_accuracy20: 0.5853 - val_accuracy30: 0.5450 - val_accuracy50: 0.4756 - 74s/epoch - 29ms/step
Epoch 14/50
2538/2538 - 72s - loss: 10.6915 - accuracy10: 0.5981 - accuracy20: 0.5911 - accuracy30: 0.5722 - accuracy50: 0.5334 - val_loss: 12.1517 - val_accuracy10: 0.6169 - val_accuracy20: 0.5857 - val_accuracy30: 0.5449 - val_accuracy50: 0.4742 - 72s/epoch - 28ms/step
Epoch 15/50
2538/2538 - 71s - loss: 10.6737 - accuracy10: 0.5992 - accuracy20: 0.5921 - accuracy30: 0.5732 - accuracy50: 0.5345 - val_loss: 12.1114 - val_accuracy10: 0.6134 - val_accuracy20: 0.5844 - val_accuracy30: 0.5453 - val_accuracy50: 0.4753 - 71s/epoch - 28ms/step
Epoch 16/50
2538/2538 - 71s - loss: 10.6549 - accuracy10: 0.5994 - accuracy20: 0.5925 - accuracy30: 0.5738 - accuracy50: 0.5350 - val_loss: 12.1390 - val_accuracy10: 0.6150 - val_accuracy20: 0.5845 - val_accuracy30: 0.5448 - val_accuracy50: 0.4747 - 71s/epoch - 28ms/step
Epoch 17/50
2538/2538 - 71s - loss: 10.6408 - accuracy10: 0.6006 - accuracy20: 0.5938 - accuracy30: 0.5749 - accuracy50: 0.5365 - val_loss: 12.1347 - val_accuracy10: 0.6150 - val_accuracy20: 0.5847 - val_accuracy30: 0.5453 - val_accuracy50: 0.4765 - 71s/epoch - 28ms/step
Epoch 18/50
2538/2538 - 70s - loss: 10.6247 - accuracy10: 0.6006 - accuracy20: 0.5943 - accuracy30: 0.5754 - accuracy50: 0.5372 - val_loss: 12.0988 - val_accuracy10: 0.6163 - val_accuracy20: 0.5844 - val_accuracy30: 0.5455 - val_accuracy50: 0.4772 - 70s/epoch - 28ms/step
Epoch 19/50
2538/2538 - 71s - loss: 10.6099 - accuracy10: 0.6015 - accuracy20: 0.5949 - accuracy30: 0.5760 - accuracy50: 0.5381 - val_loss: 12.0619 - val_accuracy10: 0.6101 - val_accuracy20: 0.5817 - val_accuracy30: 0.5446 - val_accuracy50: 0.4793 - 71s/epoch - 28ms/step
Epoch 20/50
2538/2538 - 72s - loss: 10.5974 - accuracy10: 0.6017 - accuracy20: 0.5953 - accuracy30: 0.5767 - accuracy50: 0.5390 - val_loss: 12.0803 - val_accuracy10: 0.6133 - val_accuracy20: 0.5832 - val_accuracy30: 0.5448 - val_accuracy50: 0.4795 - 72s/epoch - 28ms/step
testing model: results/ATVI/W0/deepOF_L2/seq2seq
Evaluating performance on  test set...
11876/11876 - 115s - 115s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0422344
{'0': {'precision': 0.5189114595420009, 'recall': 0.3730112645135987, 'f1-score': 0.4340282279483508, 'support': 785298}, '1': {'precision': 0.7102345717142423, 'recall': 0.4648146536691386, 'f1-score': 0.5618955007906066, 'support': 1459457}, '2': {'precision': 0.38525757804947025, 'recall': 0.736470626691761, 'f1-score': 0.5058817077873095, 'support': 795399}, 'accuracy': 0.5121747122020792, 'macro avg': {'precision': 0.5381345364352378, 'recall': 0.5247655149581661, 'f1-score': 0.5006018121754222, 'support': 3040154}, 'weighted avg': {'precision': 0.5757900557039998, 'recall': 0.5121747122020792, 'f1-score': 0.5142113280251784, 'support': 3040154}}
[[292925 150734 341639]
 [187997 678377 593083]
 [ 83577 126034 585788]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0145534
{'0': {'precision': 0.5916071950626761, 'recall': 0.3362285926307989, 'f1-score': 0.4287725419185768, 'support': 981029}, '1': {'precision': 0.5730061662714201, 'recall': 0.5056525156790241, 'f1-score': 0.5372264912396971, 'support': 1066074}, '2': {'precision': 0.4506577197923004, 'recall': 0.6997052517947215, 'f1-score': 0.5482227454965555, 'support': 993051}, 'accuracy': 0.5143673642848355, 'macro avg': {'precision': 0.5384236937087988, 'recall': 0.5138621200348482, 'f1-score': 0.5047405928849432, 'support': 3040154}, 'weighted avg': {'precision': 0.5390440385468116, 'recall': 0.5143673642848355, 'f1-score': 0.5058212965809653, 'support': 3040154}}
[[329850 212486 438693]
 [118705 539063 408306]
 [108994 189214 694843]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0148851
{'0': {'precision': 0.6101938740604458, 'recall': 0.30340659179005125, 'f1-score': 0.40529060695584995, 'support': 1087656}, '1': {'precision': 0.4711486786704187, 'recall': 0.5262524784882581, 'f1-score': 0.4971784083208767, 'support': 846282}, '2': {'precision': 0.4759893158584602, 'recall': 0.6686985181917455, 'f1-score': 0.5561225352827411, 'support': 1106216}, 'accuracy': 0.4983579779182239, 'macro avg': {'precision': 0.5191106228631083, 'recall': 0.4994525294900183, 'f1-score': 0.4861971835198226, 'support': 3040154}, 'weighted avg': {'precision': 0.5226553231840657, 'recall': 0.4983579779182239, 'f1-score': 0.4857522167101116, 'support': 3040154}}
[[330002 258585 499069]
 [ 85639 445358 315285]
 [125174 241317 739725]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0369912
{'0': {'precision': 0.5997077990734155, 'recall': 0.2600173032587804, 'f1-score': 0.3627541041556684, 'support': 1199774}, '1': {'precision': 0.3347116529348749, 'recall': 0.5350468787233867, 'f1-score': 0.411807228458474, 'support': 608485}, '2': {'precision': 0.4927860596840136, 'recall': 0.6189480434614963, 'f1-score': 0.5487084845621564, 'support': 1231895}, 'accuracy': 0.4605059480539473, 'macro avg': {'precision': 0.47573517056410136, 'recall': 0.47133740848122113, 'f1-score': 0.4410899390587663, 'support': 3040154}, 'weighted avg': {'precision': 0.5033434253843796, 'recall': 0.4605059480539473, 'f1-score': 0.447922277146985, 'support': 3040154}}
[[311962 326896 560916]
 [ 59030 325568 223887]
 [149198 320218 762479]]
Evaluating performance on  train set...
2538/2538 - 25s - 25s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8599079
{'0': {'precision': 0.47167685133438997, 'recall': 0.41877338539124775, 'f1-score': 0.44365356691987196, 'support': 122940}, '1': {'precision': 0.773318734329874, 'recall': 0.7267832908296422, 'f1-score': 0.7493292125070152, 'support': 402318}, '2': {'precision': 0.41499707449265544, 'recall': 0.5417959892575142, 'f1-score': 0.4699945244846215, 'support': 124366}, 'accuracy': 0.6330785192665296, 'macro avg': {'precision': 0.5533308867189731, 'recall': 0.5624508884928013, 'f1-score': 0.5543257679705029, 'support': 649624}, 'weighted avg': {'precision': 0.6476354396197335, 'recall': 0.6330785192665296, 'f1-score': 0.6380040433644397, 'support': 649624}}
[[ 51484  43303  28153]
 [ 43089 292398  66831]
 [ 14578  42407  67381]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.90605617
{'0': {'precision': 0.5573761143530575, 'recall': 0.3634977500650808, 'f1-score': 0.4400276114587554, 'support': 161338}, '1': {'precision': 0.6565196280803973, 'recall': 0.7780287272145433, 'f1-score': 0.7121281464530892, 'support': 324988}, '2': {'precision': 0.49015188140818367, 'recall': 0.478058518781614, 'f1-score': 0.48402967445522943, 'support': 163298}, 'accuracy': 0.5996730416363928, 'macro avg': {'precision': 0.5680158746138795, 'recall': 0.539861665353746, 'f1-score': 0.545395144122358, 'support': 649624}, 'weighted avg': {'precision': 0.5900763678039594, 'recall': 0.5996730416363928, 'f1-score': 0.587212533121035, 'support': 649624}}
[[ 58646  66164  36528]
 [ 27463 252850  44675]
 [ 19109  66123  78066]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9533868
{'0': {'precision': 0.591566866267465, 'recall': 0.3181559568027138, 'f1-score': 0.4137755315732894, 'support': 186308}, '1': {'precision': 0.5649586392411464, 'recall': 0.8112289719965441, 'f1-score': 0.6660586280383304, 'support': 275466}, '2': {'precision': 0.5155640759033012, 'recall': 0.42233164759116315, 'f1-score': 0.4643139320516197, 'support': 187850}, 'accuracy': 0.5573624127187419, 'macro avg': {'precision': 0.5573631938039708, 'recall': 0.517238858796807, 'f1-score': 0.5147160305544132, 'support': 649624}, 'weighted avg': {'precision': 0.5583064170908028, 'recall': 0.5573624127187419, 'f1-score': 0.5353674893530102, 'support': 649624}}
[[ 59275  85476  41557]
 [ 19012 223466  32988]
 [ 21913  86602  79335]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0354313
{'0': {'precision': 0.5994441239708427, 'recall': 0.2627190321216467, 'f1-score': 0.3653261658138725, 'support': 217548}, '1': {'precision': 0.4370902629639212, 'recall': 0.8384813113648814, 'f1-score': 0.5746318344662944, 'support': 213579}, '2': {'precision': 0.5239373292290666, 'recall': 0.34665464514386923, 'f1-score': 0.41724553932937075, 'support': 218497}, 'accuracy': 0.4802454958560644, 'macro avg': {'precision': 0.5201572387212768, 'recall': 0.4826183295434658, 'f1-score': 0.4524011798698459, 'support': 649624}, 'weighted avg': {'precision': 0.5206702741581954, 'recall': 0.4802454958560644, 'f1-score': 0.4516030317549884, 'support': 649624}}
[[ 57154 113541  46853]
 [ 12528 179082  21969]
 [ 25663 117091  75743]]
Evaluating performance on  val set...
795/795 - 7s - 7s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8848398
{'0': {'precision': 0.4489543512480324, 'recall': 0.4172740810408339, 'f1-score': 0.4325349004102745, 'support': 38277}, '1': {'precision': 0.7747123603616293, 'recall': 0.6976218787158145, 'f1-score': 0.7341489153148946, 'support': 126150}, '2': {'precision': 0.39670838017656057, 'recall': 0.5518523266247917, 'f1-score': 0.46159289758106026, 'support': 39005}, 'accuracy': 0.6169235911754296, 'macro avg': {'precision': 0.5401250305954074, 'recall': 0.5555827621271466, 'f1-score': 0.5427589044354098, 'support': 203432}, 'weighted avg': {'precision': 0.6409424295643125, 'recall': 0.6169235911754296, 'f1-score': 0.6251398748482406, 'support': 203432}}
[[15972 12781  9524]
 [14935 88005 23210]
 [ 4669 12811 21525]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.92977476
{'0': {'precision': 0.5269561690663113, 'recall': 0.36202607224599465, 'f1-score': 0.42919163795951115, 'support': 50245}, '1': {'precision': 0.6560282766327936, 'recall': 0.7441700488408888, 'f1-score': 0.6973249228785856, 'support': 101759}, '2': {'precision': 0.4697842264687184, 'recall': 0.48854709496772186, 'f1-score': 0.47898198455819274, 'support': 51428}, 'accuracy': 0.5851635927484369, 'macro avg': {'precision': 0.5509228907226078, 'recall': 0.5315810720182017, 'f1-score': 0.5351661817987631, 'support': 203432}, 'weighted avg': {'precision': 0.5770663283821941, 'recall': 0.5851635927484369, 'f1-score': 0.5759020516847712, 'support': 203432}}
[[18190 19705 12350]
 [10026 75726 16007]
 [ 6303 20000 25125]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.97427654
{'0': {'precision': 0.5600134347042839, 'recall': 0.31655706864115707, 'f1-score': 0.40447678906163853, 'support': 57939}, '1': {'precision': 0.5623182525191046, 'recall': 0.7731287773128778, 'f1-score': 0.6510844882937906, 'support': 86040}, '2': {'precision': 0.4939581941395438, 'recall': 0.4352345550266597, 'f1-score': 0.46274075001341225, 'support': 59453}, 'accuracy': 0.5443440559990562, 'macro avg': {'precision': 0.538763293787644, 'recall': 0.5083068003268981, 'f1-score': 0.5061006757896138, 'support': 203432}, 'weighted avg': {'precision': 0.5416835962692869, 'recall': 0.5443440559990562, 'f1-score': 0.5258052610444149, 'support': 203432}}
[[18341 25404 14194]
 [ 7205 66520 12315]
 [ 7205 26372 25876]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0467606
{'0': {'precision': 0.5728521671826625, 'recall': 0.2636163960701671, 'f1-score': 0.3610732798048582, 'support': 67382}, '1': {'precision': 0.4357893016223285, 'recall': 0.7997510199184066, 'f1-score': 0.5641627915588779, 'support': 66672}, '2': {'precision': 0.505921827877529, 'recall': 0.3651157427426562, 'f1-score': 0.42413790216581415, 'support': 69378}, 'accuracy': 0.47394215266034845, 'macro avg': {'precision': 0.5048544322275067, 'recall': 0.47616105291040994, 'f1-score': 0.4497913245098501, 'support': 203432}, 'weighted avg': {'precision': 0.5051059500046859, 'recall': 0.47394215266034845, 'f1-score': 0.44914045359178656, 'support': 203432}}
[[17763 33378 16241]
 [ 4854 53321  8497]
 [ 8391 35656 25331]]
training model: results/ATVI/W0/deepVOL_L2/seq2seq
Epoch 1/50
2538/2538 - 76s - loss: 11.8701 - accuracy10: 0.5062 - accuracy20: 0.5124 - accuracy30: 0.5052 - accuracy50: 0.4835 - val_loss: 12.2053 - val_accuracy10: 0.5295 - val_accuracy20: 0.5281 - val_accuracy30: 0.5119 - val_accuracy50: 0.4693 - 76s/epoch - 30ms/step
Epoch 2/50
2538/2538 - 69s - loss: 11.5529 - accuracy10: 0.5406 - accuracy20: 0.5402 - accuracy30: 0.5286 - accuracy50: 0.4966 - val_loss: 11.9745 - val_accuracy10: 0.5707 - val_accuracy20: 0.5573 - val_accuracy30: 0.5304 - val_accuracy50: 0.4707 - 69s/epoch - 27ms/step
Epoch 3/50
2538/2538 - 70s - loss: 11.3242 - accuracy10: 0.5632 - accuracy20: 0.5553 - accuracy30: 0.5396 - accuracy50: 0.5056 - val_loss: 12.1082 - val_accuracy10: 0.5849 - val_accuracy20: 0.5679 - val_accuracy30: 0.5378 - val_accuracy50: 0.4780 - 70s/epoch - 27ms/step
Epoch 4/50
2538/2538 - 69s - loss: 11.1821 - accuracy10: 0.5720 - accuracy20: 0.5650 - accuracy30: 0.5486 - accuracy50: 0.5134 - val_loss: 11.9156 - val_accuracy10: 0.5681 - val_accuracy20: 0.5625 - val_accuracy30: 0.5383 - val_accuracy50: 0.4858 - 69s/epoch - 27ms/step
Epoch 5/50
2538/2538 - 70s - loss: 11.0645 - accuracy10: 0.5814 - accuracy20: 0.5746 - accuracy30: 0.5566 - accuracy50: 0.5184 - val_loss: 11.8538 - val_accuracy10: 0.5751 - val_accuracy20: 0.5663 - val_accuracy30: 0.5411 - val_accuracy50: 0.4862 - 70s/epoch - 28ms/step
Epoch 6/50
2538/2538 - 70s - loss: 10.9942 - accuracy10: 0.5856 - accuracy20: 0.5785 - accuracy30: 0.5603 - accuracy50: 0.5205 - val_loss: 11.8355 - val_accuracy10: 0.5917 - val_accuracy20: 0.5754 - val_accuracy30: 0.5465 - val_accuracy50: 0.4878 - 70s/epoch - 28ms/step
Epoch 7/50
2538/2538 - 69s - loss: 10.9444 - accuracy10: 0.5890 - accuracy20: 0.5819 - accuracy30: 0.5631 - accuracy50: 0.5222 - val_loss: 11.8029 - val_accuracy10: 0.5995 - val_accuracy20: 0.5812 - val_accuracy30: 0.5494 - val_accuracy50: 0.4867 - 69s/epoch - 27ms/step
Epoch 8/50
2538/2538 - 70s - loss: 10.9078 - accuracy10: 0.5922 - accuracy20: 0.5839 - accuracy30: 0.5645 - accuracy50: 0.5235 - val_loss: 11.8099 - val_accuracy10: 0.6048 - val_accuracy20: 0.5832 - val_accuracy30: 0.5498 - val_accuracy50: 0.4856 - 70s/epoch - 27ms/step
Epoch 9/50
2538/2538 - 69s - loss: 10.8725 - accuracy10: 0.5932 - accuracy20: 0.5857 - accuracy30: 0.5662 - accuracy50: 0.5250 - val_loss: 11.7559 - val_accuracy10: 0.6030 - val_accuracy20: 0.5827 - val_accuracy30: 0.5505 - val_accuracy50: 0.4865 - 69s/epoch - 27ms/step
Epoch 10/50
2538/2538 - 70s - loss: 10.8453 - accuracy10: 0.5944 - accuracy20: 0.5867 - accuracy30: 0.5675 - accuracy50: 0.5259 - val_loss: 11.7273 - val_accuracy10: 0.6031 - val_accuracy20: 0.5840 - val_accuracy30: 0.5524 - val_accuracy50: 0.4897 - 70s/epoch - 28ms/step
Epoch 11/50
2538/2538 - 70s - loss: 10.8202 - accuracy10: 0.5956 - accuracy20: 0.5878 - accuracy30: 0.5688 - accuracy50: 0.5276 - val_loss: 11.8346 - val_accuracy10: 0.6094 - val_accuracy20: 0.5867 - val_accuracy30: 0.5520 - val_accuracy50: 0.4847 - 70s/epoch - 28ms/step
Epoch 12/50
2538/2538 - 70s - loss: 10.7969 - accuracy10: 0.5969 - accuracy20: 0.5893 - accuracy30: 0.5694 - accuracy50: 0.5286 - val_loss: 11.7839 - val_accuracy10: 0.6070 - val_accuracy20: 0.5862 - val_accuracy30: 0.5529 - val_accuracy50: 0.4871 - 70s/epoch - 27ms/step
Epoch 13/50
2538/2538 - 70s - loss: 10.7769 - accuracy10: 0.5978 - accuracy20: 0.5904 - accuracy30: 0.5705 - accuracy50: 0.5294 - val_loss: 11.7392 - val_accuracy10: 0.6064 - val_accuracy20: 0.5863 - val_accuracy30: 0.5530 - val_accuracy50: 0.4872 - 70s/epoch - 28ms/step
Epoch 14/50
2538/2538 - 71s - loss: 10.7590 - accuracy10: 0.5988 - accuracy20: 0.5914 - accuracy30: 0.5714 - accuracy50: 0.5305 - val_loss: 11.7263 - val_accuracy10: 0.6010 - val_accuracy20: 0.5835 - val_accuracy30: 0.5527 - val_accuracy50: 0.4902 - 71s/epoch - 28ms/step
Epoch 15/50
2538/2538 - 70s - loss: 10.7424 - accuracy10: 0.5999 - accuracy20: 0.5920 - accuracy30: 0.5723 - accuracy50: 0.5315 - val_loss: 11.7546 - val_accuracy10: 0.6033 - val_accuracy20: 0.5860 - val_accuracy30: 0.5541 - val_accuracy50: 0.4876 - 70s/epoch - 28ms/step
Epoch 16/50
2538/2538 - 70s - loss: 10.7244 - accuracy10: 0.6001 - accuracy20: 0.5924 - accuracy30: 0.5729 - accuracy50: 0.5321 - val_loss: 11.7461 - val_accuracy10: 0.6016 - val_accuracy20: 0.5855 - val_accuracy30: 0.5537 - val_accuracy50: 0.4884 - 70s/epoch - 28ms/step
Epoch 17/50
2538/2538 - 70s - loss: 10.7104 - accuracy10: 0.6005 - accuracy20: 0.5929 - accuracy30: 0.5732 - accuracy50: 0.5327 - val_loss: 11.6880 - val_accuracy10: 0.6001 - val_accuracy20: 0.5843 - val_accuracy30: 0.5541 - val_accuracy50: 0.4914 - 70s/epoch - 28ms/step
Epoch 18/50
2538/2538 - 70s - loss: 10.6969 - accuracy10: 0.6011 - accuracy20: 0.5936 - accuracy30: 0.5746 - accuracy50: 0.5332 - val_loss: 11.6851 - val_accuracy10: 0.5984 - val_accuracy20: 0.5845 - val_accuracy30: 0.5544 - val_accuracy50: 0.4908 - 70s/epoch - 27ms/step
Epoch 19/50
2538/2538 - 68s - loss: 10.6842 - accuracy10: 0.6012 - accuracy20: 0.5944 - accuracy30: 0.5750 - accuracy50: 0.5341 - val_loss: 11.6556 - val_accuracy10: 0.5927 - val_accuracy20: 0.5823 - val_accuracy30: 0.5542 - val_accuracy50: 0.4937 - 68s/epoch - 27ms/step
Epoch 20/50
2538/2538 - 69s - loss: 10.6683 - accuracy10: 0.6031 - accuracy20: 0.5951 - accuracy30: 0.5755 - accuracy50: 0.5341 - val_loss: 11.6779 - val_accuracy10: 0.5964 - val_accuracy20: 0.5839 - val_accuracy30: 0.5551 - val_accuracy50: 0.4920 - 69s/epoch - 27ms/step
Epoch 21/50
2538/2538 - 69s - loss: 10.6577 - accuracy10: 0.6025 - accuracy20: 0.5953 - accuracy30: 0.5755 - accuracy50: 0.5346 - val_loss: 11.6720 - val_accuracy10: 0.5916 - val_accuracy20: 0.5810 - val_accuracy30: 0.5535 - val_accuracy50: 0.4930 - 69s/epoch - 27ms/step
Epoch 22/50
2538/2538 - 69s - loss: 10.6444 - accuracy10: 0.6035 - accuracy20: 0.5963 - accuracy30: 0.5768 - accuracy50: 0.5359 - val_loss: 11.6680 - val_accuracy10: 0.5912 - val_accuracy20: 0.5809 - val_accuracy30: 0.5531 - val_accuracy50: 0.4934 - 69s/epoch - 27ms/step
Epoch 23/50
2538/2538 - 69s - loss: 10.6328 - accuracy10: 0.6041 - accuracy20: 0.5966 - accuracy30: 0.5770 - accuracy50: 0.5359 - val_loss: 11.6852 - val_accuracy10: 0.5900 - val_accuracy20: 0.5802 - val_accuracy30: 0.5534 - val_accuracy50: 0.4935 - 69s/epoch - 27ms/step
Epoch 24/50
2538/2538 - 69s - loss: 10.6174 - accuracy10: 0.6044 - accuracy20: 0.5972 - accuracy30: 0.5777 - accuracy50: 0.5371 - val_loss: 11.7026 - val_accuracy10: 0.5910 - val_accuracy20: 0.5798 - val_accuracy30: 0.5531 - val_accuracy50: 0.4936 - 69s/epoch - 27ms/step
Epoch 25/50
2538/2538 - 69s - loss: 10.6095 - accuracy10: 0.6046 - accuracy20: 0.5981 - accuracy30: 0.5783 - accuracy50: 0.5372 - val_loss: 11.7433 - val_accuracy10: 0.5933 - val_accuracy20: 0.5819 - val_accuracy30: 0.5531 - val_accuracy50: 0.4908 - 69s/epoch - 27ms/step
Epoch 26/50
2538/2538 - 71s - loss: 10.5964 - accuracy10: 0.6049 - accuracy20: 0.5987 - accuracy30: 0.5791 - accuracy50: 0.5380 - val_loss: 11.6969 - val_accuracy10: 0.5918 - val_accuracy20: 0.5810 - val_accuracy30: 0.5530 - val_accuracy50: 0.4914 - 71s/epoch - 28ms/step
Epoch 27/50
2538/2538 - 71s - loss: 10.5907 - accuracy10: 0.6049 - accuracy20: 0.5986 - accuracy30: 0.5794 - accuracy50: 0.5386 - val_loss: 11.6855 - val_accuracy10: 0.5894 - val_accuracy20: 0.5788 - val_accuracy30: 0.5530 - val_accuracy50: 0.4940 - 71s/epoch - 28ms/step
Epoch 28/50
2538/2538 - 69s - loss: 10.5758 - accuracy10: 0.6059 - accuracy20: 0.5991 - accuracy30: 0.5795 - accuracy50: 0.5391 - val_loss: 11.6955 - val_accuracy10: 0.5883 - val_accuracy20: 0.5779 - val_accuracy30: 0.5525 - val_accuracy50: 0.4953 - 69s/epoch - 27ms/step
Epoch 29/50
2538/2538 - 72s - loss: 10.5661 - accuracy10: 0.6061 - accuracy20: 0.5992 - accuracy30: 0.5803 - accuracy50: 0.5396 - val_loss: 11.6801 - val_accuracy10: 0.5828 - val_accuracy20: 0.5755 - val_accuracy30: 0.5520 - val_accuracy50: 0.4969 - 72s/epoch - 28ms/step
testing model: results/ATVI/W0/deepVOL_L2/seq2seq
Evaluating performance on  test set...
11876/11876 - 107s - 107s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0105796
{'0': {'precision': 0.4706217070337072, 'recall': 0.47920412581179167, 'f1-score': 0.4748741419919352, 'support': 785300}, '1': {'precision': 0.7312510033587761, 'recall': 0.4806397173743385, 'f1-score': 0.5800329511087408, 'support': 1459457}, '2': {'precision': 0.4217730983563055, 'recall': 0.6794061367710919, 'f1-score': 0.5204515708382009, 'support': 795402}, 'accuracy': 0.5322724896954403, 'macro avg': {'precision': 0.5412152695829296, 'recall': 0.5464166599857406, 'f1-score': 0.5251195546462922, 'support': 3040159}, 'weighted avg': {'precision': 0.582958913702001, 'recall': 0.5322724896954403, 'f1-score': 0.5372811207507314, 'support': 3040159}}
[[376319 134834 274147]
 [291272 701473 466712]
 [132030 122971 540401]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9989438
{'0': {'precision': 0.5491946542981184, 'recall': 0.42823053321509025, 'f1-score': 0.4812274589471477, 'support': 981030}, '1': {'precision': 0.5805354506916264, 'recall': 0.5411875723448841, 'f1-score': 0.5601713877093497, 'support': 1066074}, '2': {'precision': 0.48812969655632044, 'recall': 0.6298593733479012, 'f1-score': 0.5500108597873944, 'support': 993055}, 'accuracy': 0.5337016912602268, 'macro avg': {'precision': 0.539286600515355, 'recall': 0.5330924929692918, 'f1-score': 0.530469902147964, 'support': 3040159}, 'weighted avg': {'precision': 0.5402381314860324, 'recall': 0.5337016912602268, 'f1-score': 0.5313780497658012, 'support': 3040159}}
[[420107 216385 344538]
 [177760 576946 311368]
 [167084 200486 625485]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0109144
{'0': {'precision': 0.5716785135804452, 'recall': 0.39264272409158024, 'f1-score': 0.4655407349914536, 'support': 1087658}, '1': {'precision': 0.4687180641920565, 'recall': 0.5755627845531578, 'f1-score': 0.5166745603367212, 'support': 846283}, '2': {'precision': 0.5133208659141024, 'recall': 0.5818663229128436, 'f1-score': 0.5454485365991104, 'support': 1106218}, 'accuracy': 0.5124143178037728, 'macro avg': {'precision': 0.5179058145622014, 'recall': 0.5166906105191938, 'f1-score': 0.509221277309095, 'support': 3040159}, 'weighted avg': {'precision': 0.5217831106505589, 'recall': 0.5124143178037728, 'f1-score': 0.5088506854228251, 'support': 3040159}}
[[427061 283189 377408]
 [126338 487089 232856]
 [193631 268916 643671]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.050329
{'0': {'precision': 0.5701264105088121, 'recall': 0.3417798959474169, 'f1-score': 0.4273635216271622, 'support': 1199778}, '1': {'precision': 0.3266526722493599, 'recall': 0.5935600819082115, 'f1-score': 0.4213981734547141, 'support': 608486}, '2': {'precision': 0.5242306844102709, 'recall': 0.5171414771551147, 'f1-score': 0.5206619506679455, 'support': 1231895}, 'accuracy': 0.463231363885902, 'macro avg': {'precision': 0.4736699223894809, 'recall': 0.484160485003581, 'f1-score': 0.45647454858327396, 'support': 3040159}, 'weighted avg': {'precision': 0.5027979988695842, 'recall': 0.463231363885902, 'f1-score': 0.46397477695793116, 'support': 3040159}}
[[410060 375283 414435]
 [ 83576 361173 163737]
 [225608 369223 637064]]
Evaluating performance on  train set...
2538/2538 - 23s - 23s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.89845914
{'0': {'precision': 0.4443755229220161, 'recall': 0.501922638250725, 'f1-score': 0.4713992777131664, 'support': 122748}, '1': {'precision': 0.8174428518951636, 'recall': 0.6028362448833516, 'f1-score': 0.6939258352262649, 'support': 402363}, '2': {'precision': 0.3846778559826746, 'recall': 0.6619175353775479, 'f1-score': 0.48657775573699835, 'support': 124514}, 'accuracy': 0.5950925533961902, 'macro avg': {'precision': 0.5488320769332848, 'recall': 0.5888921395038749, 'f1-score': 0.5506342895588099, 'support': 649625}, 'weighted avg': {'precision': 0.6640026838015041, 'recall': 0.5950925533961902, 'f1-score': 0.6121364511182883, 'support': 649625}}
[[ 61610  29383  31755]
 [ 59725 242559 100079]
 [ 17309  24787  82418]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9086025
{'0': {'precision': 0.5360904345677487, 'recall': 0.4306814304767222, 'f1-score': 0.4776394588477295, 'support': 161205}, '1': {'precision': 0.7005794059947991, 'recall': 0.6614648074532633, 'f1-score': 0.6804604686347682, 'support': 325012}, '2': {'precision': 0.4613155389658196, 'recall': 0.6020268285518456, 'f1-score': 0.5223610746059433, 'support': 163408}, 'accuracy': 0.5892445641716375, 'macro avg': {'precision': 0.5659951265094558, 'recall': 0.5647243554939437, 'f1-score': 0.5601536673628137, 'support': 649625}, 'weighted avg': {'precision': 0.5995764048443367, 'recall': 0.5892445641716375, 'f1-score': 0.5903616167399338, 'support': 649625}}
[[ 69428  48993  42784]
 [ 37937 214984  72091]
 [ 22143  42889  98376]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.936581
{'0': {'precision': 0.5755984794836105, 'recall': 0.37979279342180877, 'f1-score': 0.4576306286483478, 'support': 186191}, '1': {'precision': 0.6043418748805843, 'recall': 0.7003081524283791, 'f1-score': 0.6487955129325998, 'support': 275513}, '2': {'precision': 0.495000216858064, 'recall': 0.546596708191208, 'f1-score': 0.5195205219634322, 'support': 187921}, 'accuracy': 0.5639792187800654, 'macro avg': {'precision': 0.5583135237407529, 'recall': 0.5422325513471319, 'f1-score': 0.54198222118146, 'support': 649625}, 'weighted avg': {'precision': 0.5644737120949649, 'recall': 0.5639792187800654, 'f1-score': 0.556608995252883, 'support': 649625}}
[[ 70714  66298  49179]
 [ 26956 192944  55613]
 [ 25183  60021 102717]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0008972
{'0': {'precision': 0.5910607825074305, 'recall': 0.312507466801452, 'f1-score': 0.40884771683458776, 'support': 217630}, '1': {'precision': 0.4669190693074616, 'recall': 0.7343374481740882, 'f1-score': 0.5708625141579352, 'support': 213455}, '2': {'precision': 0.5132208878965261, 'recall': 0.4669854488880754, 'f1-score': 0.48901272664545564, 'support': 218540}, 'accuracy': 0.5030810082740043, 'macro avg': {'precision': 0.5237335799038061, 'recall': 0.5046101212878719, 'f1-score': 0.48957431921265954, 'support': 649625}, 'weighted avg': {'precision': 0.5240839882655735, 'recall': 0.5030810082740043, 'f1-score': 0.48905111080298835, 'support': 649625}}
[[ 68011  91991  57628]
 [ 17538 156748  39169]
 [ 29517  86968 102055]]
Evaluating performance on  val set...
795/795 - 7s - 7s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9117549
{'0': {'precision': 0.4289118715439254, 'recall': 0.4825844744103712, 'f1-score': 0.4541679426716482, 'support': 38414}, '1': {'precision': 0.8079561186390904, 'recall': 0.6113319842875848, 'f1-score': 0.6960241774822351, 'support': 126015}, '2': {'precision': 0.385042319966699, 'recall': 0.6403353588185524, 'f1-score': 0.48090809311998156, 'support': 39003}, 'accuracy': 0.5925813048094695, 'macro avg': {'precision': 0.540636770049905, 'recall': 0.5780839391721696, 'f1-score': 0.5437000710912884, 'support': 203432}, 'weighted avg': {'precision': 0.6552981661167098, 'recall': 0.5925813048094695, 'f1-score': 0.6091114103541784, 'support': 203432}}
[[18538  9690 10186]
 [19276 77037 29702]
 [ 5407  8621 24975]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9311302
{'0': {'precision': 0.5181705503222608, 'recall': 0.4155005168164109, 'f1-score': 0.46119053922866476, 'support': 50308}, '1': {'precision': 0.6885693133068973, 'recall': 0.6674104729231586, 'f1-score': 0.6778248108140488, 'support': 101729}, '2': {'precision': 0.46108638682566017, 'recall': 0.5785582255083179, 'f1-score': 0.5131855993924959, 'support': 51395}, 'accuracy': 0.5826664438239805, 'macro avg': {'precision': 0.5559420834849395, 'recall': 0.5538230717492958, 'f1-score': 0.5507336498117364, 'support': 203432}, 'weighted avg': {'precision': 0.5889590947830944, 'recall': 0.5826664438239805, 'f1-score': 0.582657535233372, 'support': 203432}}
[[20903 16064 13341]
 [12421 67895 21413]
 [ 7016 14644 29735]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.95986974
{'0': {'precision': 0.5550775203966526, 'recall': 0.3647160217185211, 'f1-score': 0.4401980568789398, 'support': 58015}, '1': {'precision': 0.5912334750224233, 'recall': 0.7050070333298457, 'f1-score': 0.6431271905870376, 'support': 86019}, '2': {'precision': 0.4941744632696323, 'recall': 0.5219872722987305, 'f1-score': 0.5077002431655735, 'support': 59398}, 'accuracy': 0.5545243619489559, 'macro avg': {'precision': 0.5468284862295694, 'recall': 0.5305701091156991, 'f1-score': 0.530341830210517, 'support': 203432}, 'weighted avg': {'precision': 0.5525832189776203, 'recall': 0.5545243619489559, 'f1-score': 0.5457136887042688, 'support': 203432}}
[[21159 21679 15177]
 [ 8816 60644 16559]
 [ 8144 20249 31005]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0203508
{'0': {'precision': 0.5717793465219454, 'recall': 0.30390935516402684, 'f1-score': 0.3968741224205216, 'support': 67428}, '1': {'precision': 0.45660876203243406, 'recall': 0.7358818940166837, 'f1-score': 0.5635434020796232, 'support': 66652}, '2': {'precision': 0.5125051931865393, 'recall': 0.44468796862383203, 'f1-score': 0.47619415257050657, 'support': 69352}, 'accuracy': 0.4934326949545794, 'macro avg': {'precision': 0.5136311005803061, 'recall': 0.4948264059348475, 'f1-score': 0.4788705590235504, 'support': 203432}, 'weighted avg': {'precision': 0.5138379662105292, 'recall': 0.4934326949545794, 'f1-score': 0.47852225820447, 'support': 203432}}
[[20492 29335 17601]
 [ 5870 49048 11734]
 [ 9477 29035 30840]]
training model: results/ATVI/W0/deepVOL_L3/seq2seq
Epoch 1/50
2538/2538 - 108s - loss: 12.2577 - accuracy10: 0.4664 - accuracy20: 0.4735 - accuracy30: 0.4710 - accuracy50: 0.4565 - val_loss: 12.4922 - val_accuracy10: 0.5072 - val_accuracy20: 0.5053 - val_accuracy30: 0.4892 - val_accuracy50: 0.4469 - 108s/epoch - 43ms/step
Epoch 2/50
2538/2538 - 103s - loss: 11.5566 - accuracy10: 0.5374 - accuracy20: 0.5395 - accuracy30: 0.5292 - accuracy50: 0.4976 - val_loss: 11.8624 - val_accuracy10: 0.5617 - val_accuracy20: 0.5511 - val_accuracy30: 0.5267 - val_accuracy50: 0.4768 - 103s/epoch - 41ms/step
Epoch 3/50
2538/2538 - 103s - loss: 11.3355 - accuracy10: 0.5584 - accuracy20: 0.5537 - accuracy30: 0.5390 - accuracy50: 0.5059 - val_loss: 11.8472 - val_accuracy10: 0.5732 - val_accuracy20: 0.5579 - val_accuracy30: 0.5310 - val_accuracy50: 0.4794 - 103s/epoch - 41ms/step
Epoch 4/50
2538/2538 - 104s - loss: 11.1727 - accuracy10: 0.5696 - accuracy20: 0.5644 - accuracy30: 0.5483 - accuracy50: 0.5131 - val_loss: 11.8162 - val_accuracy10: 0.5819 - val_accuracy20: 0.5674 - val_accuracy30: 0.5374 - val_accuracy50: 0.4804 - 104s/epoch - 41ms/step
Epoch 5/50
2538/2538 - 103s - loss: 11.0753 - accuracy10: 0.5759 - accuracy20: 0.5711 - accuracy30: 0.5540 - accuracy50: 0.5172 - val_loss: 11.6343 - val_accuracy10: 0.5825 - val_accuracy20: 0.5715 - val_accuracy30: 0.5438 - val_accuracy50: 0.4884 - 103s/epoch - 41ms/step
Epoch 6/50
2538/2538 - 104s - loss: 10.9899 - accuracy10: 0.5793 - accuracy20: 0.5756 - accuracy30: 0.5581 - accuracy50: 0.5206 - val_loss: 11.5998 - val_accuracy10: 0.5636 - val_accuracy20: 0.5622 - val_accuracy30: 0.5411 - val_accuracy50: 0.4953 - 104s/epoch - 41ms/step
Epoch 7/50
2538/2538 - 102s - loss: 10.9192 - accuracy10: 0.5837 - accuracy20: 0.5799 - accuracy30: 0.5620 - accuracy50: 0.5235 - val_loss: 11.5418 - val_accuracy10: 0.5744 - val_accuracy20: 0.5691 - val_accuracy30: 0.5451 - val_accuracy50: 0.4941 - 102s/epoch - 40ms/step
Epoch 8/50
2538/2538 - 104s - loss: 10.8706 - accuracy10: 0.5872 - accuracy20: 0.5827 - accuracy30: 0.5644 - accuracy50: 0.5258 - val_loss: 11.4492 - val_accuracy10: 0.5745 - val_accuracy20: 0.5694 - val_accuracy30: 0.5463 - val_accuracy50: 0.4966 - 104s/epoch - 41ms/step
Epoch 9/50
2538/2538 - 103s - loss: 10.8316 - accuracy10: 0.5891 - accuracy20: 0.5847 - accuracy30: 0.5664 - accuracy50: 0.5276 - val_loss: 11.5056 - val_accuracy10: 0.5660 - val_accuracy20: 0.5632 - val_accuracy30: 0.5436 - val_accuracy50: 0.4967 - 103s/epoch - 40ms/step
Epoch 10/50
2538/2538 - 103s - loss: 10.7998 - accuracy10: 0.5919 - accuracy20: 0.5875 - accuracy30: 0.5686 - accuracy50: 0.5286 - val_loss: 11.3771 - val_accuracy10: 0.5603 - val_accuracy20: 0.5610 - val_accuracy30: 0.5435 - val_accuracy50: 0.5015 - 103s/epoch - 41ms/step
Epoch 11/50
2538/2538 - 102s - loss: 10.7711 - accuracy10: 0.5941 - accuracy20: 0.5888 - accuracy30: 0.5697 - accuracy50: 0.5301 - val_loss: 11.4333 - val_accuracy10: 0.5689 - val_accuracy20: 0.5658 - val_accuracy30: 0.5462 - val_accuracy50: 0.5002 - 102s/epoch - 40ms/step
Epoch 12/50
2538/2538 - 103s - loss: 10.7478 - accuracy10: 0.5949 - accuracy20: 0.5901 - accuracy30: 0.5711 - accuracy50: 0.5307 - val_loss: 11.4194 - val_accuracy10: 0.5796 - val_accuracy20: 0.5717 - val_accuracy30: 0.5491 - val_accuracy50: 0.4963 - 103s/epoch - 41ms/step
Epoch 13/50
2538/2538 - 103s - loss: 10.7241 - accuracy10: 0.5965 - accuracy20: 0.5915 - accuracy30: 0.5725 - accuracy50: 0.5320 - val_loss: 11.4211 - val_accuracy10: 0.5703 - val_accuracy20: 0.5665 - val_accuracy30: 0.5461 - val_accuracy50: 0.4992 - 103s/epoch - 40ms/step
Epoch 14/50
2538/2538 - 103s - loss: 10.7046 - accuracy10: 0.5981 - accuracy20: 0.5927 - accuracy30: 0.5733 - accuracy50: 0.5328 - val_loss: 11.4416 - val_accuracy10: 0.5696 - val_accuracy20: 0.5661 - val_accuracy30: 0.5465 - val_accuracy50: 0.4989 - 103s/epoch - 41ms/step
Epoch 15/50
2538/2538 - 102s - loss: 10.6883 - accuracy10: 0.5987 - accuracy20: 0.5931 - accuracy30: 0.5739 - accuracy50: 0.5335 - val_loss: 11.4449 - val_accuracy10: 0.5830 - val_accuracy20: 0.5738 - val_accuracy30: 0.5504 - val_accuracy50: 0.4981 - 102s/epoch - 40ms/step
Epoch 16/50
2538/2538 - 104s - loss: 10.6716 - accuracy10: 0.5993 - accuracy20: 0.5933 - accuracy30: 0.5748 - accuracy50: 0.5341 - val_loss: 11.3511 - val_accuracy10: 0.5777 - val_accuracy20: 0.5726 - val_accuracy30: 0.5510 - val_accuracy50: 0.4993 - 104s/epoch - 41ms/step
Epoch 17/50
2538/2538 - 104s - loss: 10.6589 - accuracy10: 0.6001 - accuracy20: 0.5940 - accuracy30: 0.5751 - accuracy50: 0.5345 - val_loss: 11.4159 - val_accuracy10: 0.5888 - val_accuracy20: 0.5784 - val_accuracy30: 0.5520 - val_accuracy50: 0.4964 - 104s/epoch - 41ms/step
Epoch 18/50
2538/2538 - 101s - loss: 10.6399 - accuracy10: 0.6009 - accuracy20: 0.5949 - accuracy30: 0.5760 - accuracy50: 0.5356 - val_loss: 11.3878 - val_accuracy10: 0.5790 - val_accuracy20: 0.5726 - val_accuracy30: 0.5503 - val_accuracy50: 0.4995 - 101s/epoch - 40ms/step
Epoch 19/50
2538/2538 - 102s - loss: 10.6282 - accuracy10: 0.6014 - accuracy20: 0.5953 - accuracy30: 0.5767 - accuracy50: 0.5362 - val_loss: 11.4336 - val_accuracy10: 0.5815 - val_accuracy20: 0.5732 - val_accuracy30: 0.5503 - val_accuracy50: 0.4974 - 102s/epoch - 40ms/step
Epoch 20/50
2538/2538 - 102s - loss: 10.6135 - accuracy10: 0.6028 - accuracy20: 0.5968 - accuracy30: 0.5777 - accuracy50: 0.5365 - val_loss: 11.4213 - val_accuracy10: 0.5813 - val_accuracy20: 0.5738 - val_accuracy30: 0.5506 - val_accuracy50: 0.4970 - 102s/epoch - 40ms/step
Epoch 21/50
2538/2538 - 104s - loss: 10.5999 - accuracy10: 0.6030 - accuracy20: 0.5971 - accuracy30: 0.5786 - accuracy50: 0.5376 - val_loss: 11.4320 - val_accuracy10: 0.5803 - val_accuracy20: 0.5732 - val_accuracy30: 0.5513 - val_accuracy50: 0.4984 - 104s/epoch - 41ms/step
Epoch 22/50
2538/2538 - 103s - loss: 10.5893 - accuracy10: 0.6035 - accuracy20: 0.5971 - accuracy30: 0.5785 - accuracy50: 0.5374 - val_loss: 11.4214 - val_accuracy10: 0.5711 - val_accuracy20: 0.5680 - val_accuracy30: 0.5492 - val_accuracy50: 0.5013 - 103s/epoch - 41ms/step
Epoch 23/50
2538/2538 - 102s - loss: 10.5736 - accuracy10: 0.6037 - accuracy20: 0.5977 - accuracy30: 0.5791 - accuracy50: 0.5382 - val_loss: 11.4024 - val_accuracy10: 0.5731 - val_accuracy20: 0.5696 - val_accuracy30: 0.5499 - val_accuracy50: 0.5000 - 102s/epoch - 40ms/step
Epoch 24/50
2538/2538 - 102s - loss: 10.5715 - accuracy10: 0.6046 - accuracy20: 0.5980 - accuracy30: 0.5796 - accuracy50: 0.5388 - val_loss: 11.4468 - val_accuracy10: 0.5737 - val_accuracy20: 0.5684 - val_accuracy30: 0.5480 - val_accuracy50: 0.5001 - 102s/epoch - 40ms/step
Epoch 25/50
2538/2538 - 104s - loss: 10.5543 - accuracy10: 0.6053 - accuracy20: 0.5989 - accuracy30: 0.5801 - accuracy50: 0.5400 - val_loss: 11.4831 - val_accuracy10: 0.5790 - val_accuracy20: 0.5729 - val_accuracy30: 0.5513 - val_accuracy50: 0.4994 - 104s/epoch - 41ms/step
Epoch 26/50
2538/2538 - 102s - loss: 10.5435 - accuracy10: 0.6056 - accuracy20: 0.5991 - accuracy30: 0.5804 - accuracy50: 0.5401 - val_loss: 11.4025 - val_accuracy10: 0.5711 - val_accuracy20: 0.5680 - val_accuracy30: 0.5489 - val_accuracy50: 0.5017 - 102s/epoch - 40ms/step
testing model: results/ATVI/W0/deepVOL_L3/seq2seq
Evaluating performance on  test set...
11876/11876 - 196s - 196s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.029131
{'0': {'precision': 0.4652192001487294, 'recall': 0.5225875461607029, 'f1-score': 0.4922374971438236, 'support': 785300}, '1': {'precision': 0.7627942661848016, 'recall': 0.4046477559804777, 'f1-score': 0.5287851254728203, 'support': 1459457}, '2': {'precision': 0.4062448059915913, 'recall': 0.7067671441610657, 'f1-score': 0.5159342293163387, 'support': 795402}, 'accuracy': 0.5141566608851708, 'macro avg': {'precision': 0.5447527574417075, 'recall': 0.5446674821007488, 'f1-score': 0.5123189506443275, 'support': 3040159}, 'weighted avg': {'precision': 0.592643345428773, 'recall': 0.5141566608851708, 'f1-score': 0.5159823473841023, 'support': 3040159}}
[[410388 106286 268626]
 [315875 590566 553016]
 [155876  77362 562164]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9868262
{'0': {'precision': 0.5398232513040547, 'recall': 0.4619430598452647, 'f1-score': 0.49785584064394545, 'support': 981030}, '1': {'precision': 0.6163205075057144, 'recall': 0.45602181462074864, 'f1-score': 0.5241900658427827, 'support': 1066074}, '2': {'precision': 0.47348574188855436, 'recall': 0.6731721807956256, 'f1-score': 0.5559416163045892, 'support': 993055}, 'accuracy': 0.5288637864006455, 'macro avg': {'precision': 0.5432098335661079, 'recall': 0.5303790184205464, 'f1-score': 0.5259958409304392, 'support': 3040159}, 'weighted avg': {'precision': 0.5449792120598305, 'recall': 0.5288637864006455, 'f1-score': 0.5260637740919348, 'support': 3040159}}
[[453180 168054 359796]
 [196351 486153 383570]
 [189966 134592 668497]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9827799
{'0': {'precision': 0.5584223514299236, 'recall': 0.4252614332814175, 'f1-score': 0.48282891969222647, 'support': 1087658}, '1': {'precision': 0.5050193790487146, 'recall': 0.47930184110988877, 'f1-score': 0.4918246467046991, 'support': 846283}, '2': {'precision': 0.4991303891029591, 'recall': 0.6356007586208143, 'f1-score': 0.5591591534275401, 'support': 1106218}, 'accuracy': 0.5168404020973904, 'macro avg': {'precision': 0.5208573731938657, 'recall': 0.5133880110040402, 'f1-score': 0.5112709066081552, 'support': 3040159}, 'weighted avg': {'precision': 0.5219821969323803, 'recall': 0.5168404020973904, 'f1-score': 0.5131072075533244, 'support': 3040159}}
[[462539 214318 410801]
 [145896 405625 294762]
 [219861 183244 703113]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0009439
{'0': {'precision': 0.5574491177759191, 'recall': 0.37329239242593215, 'f1-score': 0.44715210947273415, 'support': 1199778}, '1': {'precision': 0.35950598267226447, 'recall': 0.47101330186725743, 'f1-score': 0.4077740350927115, 'support': 608486}, '2': {'precision': 0.5103680681562414, 'recall': 0.59638443211475, 'f1-score': 0.5500336713444692, 'support': 1231895}, 'accuracy': 0.48324972476768485, 'macro avg': {'precision': 0.47577438953480833, 'recall': 0.4802300421359799, 'f1-score': 0.46831993863663834, 'support': 3040159}, 'weighted avg': {'precision': 0.4987533271518382, 'recall': 0.48324972476768485, 'f1-score': 0.48095898427592, 'support': 3040159}}
[[447868 267182 484728]
 [101776 286605 220105]
 [253780 243432 734683]]
Evaluating performance on  train set...
2538/2538 - 43s - 43s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.90842456
{'0': {'precision': 0.44566316831541114, 'recall': 0.5061182259588751, 'f1-score': 0.4739707110895795, 'support': 122748}, '1': {'precision': 0.8256199180404612, 'recall': 0.5698163101478019, 'f1-score': 0.6742718667884204, 'support': 402363}, '2': {'precision': 0.36952539049060756, 'recall': 0.6900830428706812, 'f1-score': 0.48131592361682946, 'support': 124514}, 'accuracy': 0.5808320184721955, 'macro avg': {'precision': 0.5469361589488266, 'recall': 0.588672526325786, 'f1-score': 0.5431861671649431, 'support': 649625}, 'weighted avg': {'precision': 0.6664063946714516, 'recall': 0.5808320184721955, 'f1-score': 0.5994405678578238, 'support': 649625}}
[[ 62125  28328  32295]
 [ 58782 229273 114308]
 [ 18492  20097  85925]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9084592
{'0': {'precision': 0.532564086857983, 'recall': 0.4314692472317856, 'f1-score': 0.4767159340527537, 'support': 161205}, '1': {'precision': 0.7104578154971751, 'recall': 0.6256322843464242, 'f1-score': 0.6653523532481811, 'support': 325012}, '2': {'precision': 0.4463649093267587, 'recall': 0.6359541760501322, 'f1-score': 0.5245544164634978, 'support': 163408}, 'accuracy': 0.5800469501635559, 'macro avg': {'precision': 0.5631289372273056, 'recall': 0.5643519025427807, 'f1-score': 0.5555409012548108, 'support': 649625}, 'weighted avg': {'precision': 0.5998828651230725, 'recall': 0.5800469501635559, 'f1-score': 0.5831254635648863, 'support': 649625}}
[[ 69555  46430  45220]
 [ 38000 203338  83674]
 [ 23049  36439 103920]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.93034863
{'0': {'precision': 0.5675022579980669, 'recall': 0.38470710184702805, 'f1-score': 0.4585591324193605, 'support': 186191}, '1': {'precision': 0.6157767578335307, 'recall': 0.664211852072316, 'f1-score': 0.6390779068163445, 'support': 275513}, '2': {'precision': 0.48148066288573665, 'recall': 0.5796159024270837, 'f1-score': 0.5260102766187607, 'support': 187921}, 'accuracy': 0.559630556090052, 'macro avg': {'precision': 0.554919892905778, 'recall': 0.5428449521154759, 'f1-score': 0.5412157719514886, 'support': 649625}, 'weighted avg': {'precision': 0.5630920030018213, 'recall': 0.559630556090052, 'f1-score': 0.5546311055723822, 'support': 649625}}
[[ 71629  61887  52675]
 [ 27888 182999  64626]
 [ 26701  52298 108922]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9830533
{'0': {'precision': 0.5794822501006417, 'recall': 0.32410053760970453, 'f1-score': 0.4157018290904055, 'support': 217630}, '1': {'precision': 0.48204973394726713, 'recall': 0.6807570682345225, 'f1-score': 0.5644252562152966, 'support': 213455}, '2': {'precision': 0.5003355971421254, 'recall': 0.518472590830054, 'f1-score': 0.5092426550891906, 'support': 218540}, 'accuracy': 0.5066800076967481, 'macro avg': {'precision': 0.5206225270633448, 'recall': 0.5077767322247604, 'f1-score': 0.4964565801316309, 'support': 649625}, 'weighted avg': {'precision': 0.5208420080023962, 'recall': 0.5066800076967481, 'f1-score': 0.496037670923337, 'support': 649625}}
[[ 70534  82128  64968]
 [ 19957 145311  48187]
 [ 31228  74005 113307]]
Evaluating performance on  val set...
795/795 - 13s - 13s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9225257
{'0': {'precision': 0.42928842293107294, 'recall': 0.5009892226792315, 'f1-score': 0.4623756667147182, 'support': 38414}, '1': {'precision': 0.8202889962621934, 'recall': 0.5712177121771218, 'f1-score': 0.6734622275655269, 'support': 126015}, '2': {'precision': 0.3710232886379675, 'recall': 0.6739737968874189, 'f1-score': 0.47858501816063287, 'support': 39003}, 'accuracy': 0.5776573990326006, 'macro avg': {'precision': 0.5402002359437446, 'recall': 0.5820602439145907, 'f1-score': 0.5381409708136259, 'support': 203432}, 'weighted avg': {'precision': 0.6603210147331845, 'recall': 0.5776573990326006, 'f1-score': 0.5962399864877119, 'support': 203432}}
[[19245  8896 10273]
 [19743 71982 34290]
 [ 5842  6874 26287]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9284881
{'0': {'precision': 0.5084669386206242, 'recall': 0.4261548859028385, 'f1-score': 0.46368630504368885, 'support': 50308}, '1': {'precision': 0.7019946941357991, 'recall': 0.6216713031682215, 'f1-score': 0.659395885683304, 'support': 101729}, '2': {'precision': 0.44631141207378583, 'recall': 0.6181146025878004, 'f1-score': 0.5183480999233117, 'support': 51395}, 'accuracy': 0.5724222344567227, 'macro avg': {'precision': 0.5522576816100697, 'recall': 0.5553135972196201, 'f1-score': 0.5471434302167681, 'support': 203432}, 'weighted avg': {'precision': 0.5895402297150856, 'recall': 0.5724222344567227, 'f1-score': 0.5753633414820349, 'support': 203432}}
[[21439 14693 14176]
 [13252 63242 25235]
 [ 7473 12154 31768]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.94969386
{'0': {'precision': 0.540123912081428, 'recall': 0.3786779281220374, 'f1-score': 0.4452167921450212, 'support': 58015}, '1': {'precision': 0.6045861237610501, 'recall': 0.6559364791499552, 'f1-score': 0.6292153626550093, 'support': 86019}, '2': {'precision': 0.48020393760891794, 'recall': 0.561332031381528, 'f1-score': 0.5176083396077031, 'support': 59398}, 'accuracy': 0.5492449565456762, 'macro avg': {'precision': 0.5416379911504654, 'recall': 0.5319821462178401, 'f1-score': 0.5306801648025778, 'support': 203432}, 'weighted avg': {'precision': 0.5498856425011814, 'recall': 0.5492449565456762, 'f1-score': 0.5441554358829143, 'support': 203432}}
[[21969 19606 16440]
 [ 9945 56423 19651]
 [ 8760 17296 33342]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.99725646
{'0': {'precision': 0.5523143438453713, 'recall': 0.32207688200747464, 'f1-score': 0.40688350133023565, 'support': 67428}, '1': {'precision': 0.4745402438637493, 'recall': 0.6732431134849667, 'f1-score': 0.5566920781822806, 'support': 66652}, '2': {'precision': 0.4989432215208983, 'recall': 0.5003748990656361, 'f1-score': 0.49965803474367004, 'support': 69352}, 'accuracy': 0.497915765464627, 'macro avg': {'precision': 0.5085992697433396, 'recall': 0.49856496485269247, 'f1-score': 0.4877445380853955, 'support': 203432}, 'weighted avg': {'precision': 0.508637865280436, 'recall': 0.497915765464627, 'f1-score': 0.4875942091128412, 'support': 203432}}
[[21717 25433 20278]
 [ 7208 44873 14571]
 [10395 24255 34702]]
training model: results/ATVI/W1/deepLOB_L1/seq2seq
Epoch 1/50
2948/2948 - 74s - loss: 11.7115 - accuracy10: 0.4779 - accuracy20: 0.4946 - accuracy30: 0.4980 - accuracy50: 0.4911 - val_loss: 12.8986 - val_accuracy10: 0.6344 - val_accuracy20: 0.5879 - val_accuracy30: 0.5414 - val_accuracy50: 0.4561 - 74s/epoch - 25ms/step
Epoch 2/50
2948/2948 - 72s - loss: 11.3518 - accuracy10: 0.5069 - accuracy20: 0.5247 - accuracy30: 0.5268 - accuracy50: 0.5119 - val_loss: 11.6163 - val_accuracy10: 0.6616 - val_accuracy20: 0.6139 - val_accuracy30: 0.5707 - val_accuracy50: 0.4884 - 72s/epoch - 24ms/step
Epoch 3/50
2948/2948 - 65s - loss: 11.0753 - accuracy10: 0.5440 - accuracy20: 0.5508 - accuracy30: 0.5449 - accuracy50: 0.5230 - val_loss: 11.2148 - val_accuracy10: 0.6558 - val_accuracy20: 0.6152 - val_accuracy30: 0.5750 - val_accuracy50: 0.5030 - 65s/epoch - 22ms/step
Epoch 4/50
2948/2948 - 71s - loss: 10.9245 - accuracy10: 0.5607 - accuracy20: 0.5624 - accuracy30: 0.5521 - accuracy50: 0.5271 - val_loss: 11.2017 - val_accuracy10: 0.7063 - val_accuracy20: 0.6481 - val_accuracy30: 0.5956 - val_accuracy50: 0.5083 - 71s/epoch - 24ms/step
Epoch 5/50
2948/2948 - 73s - loss: 10.8350 - accuracy10: 0.5672 - accuracy20: 0.5673 - accuracy30: 0.5559 - accuracy50: 0.5300 - val_loss: 11.0789 - val_accuracy10: 0.7152 - val_accuracy20: 0.6572 - val_accuracy30: 0.6038 - val_accuracy50: 0.5138 - 73s/epoch - 25ms/step
Epoch 6/50
2948/2948 - 73s - loss: 10.7617 - accuracy10: 0.5727 - accuracy20: 0.5717 - accuracy30: 0.5595 - accuracy50: 0.5330 - val_loss: 10.9150 - val_accuracy10: 0.7068 - val_accuracy20: 0.6536 - val_accuracy30: 0.6040 - val_accuracy50: 0.5183 - 73s/epoch - 25ms/step
Epoch 7/50
2948/2948 - 70s - loss: 10.6976 - accuracy10: 0.5773 - accuracy20: 0.5760 - accuracy30: 0.5633 - accuracy50: 0.5358 - val_loss: 11.0926 - val_accuracy10: 0.7079 - val_accuracy20: 0.6525 - val_accuracy30: 0.6018 - val_accuracy50: 0.5160 - 70s/epoch - 24ms/step
Epoch 8/50
2948/2948 - 74s - loss: 10.6578 - accuracy10: 0.5805 - accuracy20: 0.5785 - accuracy30: 0.5652 - accuracy50: 0.5371 - val_loss: 11.1898 - val_accuracy10: 0.7131 - val_accuracy20: 0.6566 - val_accuracy30: 0.6046 - val_accuracy50: 0.5168 - 74s/epoch - 25ms/step
Epoch 9/50
2948/2948 - 71s - loss: 10.6163 - accuracy10: 0.5838 - accuracy20: 0.5812 - accuracy30: 0.5679 - accuracy50: 0.5393 - val_loss: 11.2126 - val_accuracy10: 0.7164 - val_accuracy20: 0.6591 - val_accuracy30: 0.6065 - val_accuracy50: 0.5169 - 71s/epoch - 24ms/step
Epoch 10/50
2948/2948 - 64s - loss: 10.5840 - accuracy10: 0.5867 - accuracy20: 0.5835 - accuracy30: 0.5696 - accuracy50: 0.5404 - val_loss: 11.3059 - val_accuracy10: 0.7155 - val_accuracy20: 0.6570 - val_accuracy30: 0.6046 - val_accuracy50: 0.5165 - 64s/epoch - 22ms/step
Epoch 11/50
2948/2948 - 69s - loss: 10.5499 - accuracy10: 0.5890 - accuracy20: 0.5857 - accuracy30: 0.5715 - accuracy50: 0.5415 - val_loss: 11.3060 - val_accuracy10: 0.7176 - val_accuracy20: 0.6591 - val_accuracy30: 0.6067 - val_accuracy50: 0.5179 - 69s/epoch - 23ms/step
Epoch 12/50
2948/2948 - 67s - loss: 10.5206 - accuracy10: 0.5910 - accuracy20: 0.5882 - accuracy30: 0.5734 - accuracy50: 0.5432 - val_loss: 11.3244 - val_accuracy10: 0.7080 - val_accuracy20: 0.6530 - val_accuracy30: 0.6026 - val_accuracy50: 0.5175 - 67s/epoch - 23ms/step
Epoch 13/50
2948/2948 - 68s - loss: 10.4986 - accuracy10: 0.5922 - accuracy20: 0.5894 - accuracy30: 0.5749 - accuracy50: 0.5441 - val_loss: 11.3504 - val_accuracy10: 0.7136 - val_accuracy20: 0.6570 - val_accuracy30: 0.6054 - val_accuracy50: 0.5172 - 68s/epoch - 23ms/step
Epoch 14/50
2948/2948 - 67s - loss: 10.4770 - accuracy10: 0.5944 - accuracy20: 0.5905 - accuracy30: 0.5754 - accuracy50: 0.5446 - val_loss: 11.4245 - val_accuracy10: 0.7120 - val_accuracy20: 0.6543 - val_accuracy30: 0.6030 - val_accuracy50: 0.5155 - 67s/epoch - 23ms/step
Epoch 15/50
2948/2948 - 70s - loss: 10.4529 - accuracy10: 0.5956 - accuracy20: 0.5919 - accuracy30: 0.5772 - accuracy50: 0.5459 - val_loss: 11.4481 - val_accuracy10: 0.7175 - val_accuracy20: 0.6564 - val_accuracy30: 0.6045 - val_accuracy50: 0.5158 - 70s/epoch - 24ms/step
Epoch 16/50
2948/2948 - 72s - loss: 10.4343 - accuracy10: 0.5968 - accuracy20: 0.5936 - accuracy30: 0.5785 - accuracy50: 0.5472 - val_loss: 11.5089 - val_accuracy10: 0.7152 - val_accuracy20: 0.6551 - val_accuracy30: 0.6040 - val_accuracy50: 0.5147 - 72s/epoch - 24ms/step
testing model: results/ATVI/W1/deepLOB_L1/seq2seq
Evaluating performance on  test set...
12066/12066 - 114s - 114s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7535251
{'0': {'precision': 0.4472222785781342, 'recall': 0.4591840019694545, 'f1-score': 0.45312421163574257, 'support': 528065}, '1': {'precision': 0.7554768024762125, 'recall': 0.7988582339052324, 'f1-score': 0.7765621311445641, 'support': 2034217}, '2': {'precision': 0.47888409760733625, 'recall': 0.35980515041020966, 'f1-score': 0.41089107837247585, 'support': 526560}, 'accuracy': 0.6659417995481802, 'macro avg': {'precision': 0.560527726220561, 'recall': 0.5392824620949656, 'f1-score': 0.5468591403842608, 'support': 3088842}, 'weighted avg': {'precision': 0.6556267357398776, 'recall': 0.6659417995481802, 'f1-score': 0.6589309947791895, 'support': 3088842}}
[[ 242479  241102   44484]
 [ 247483 1625051  161683]
 [  52227  284874  189459]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8443301
{'0': {'precision': 0.5251739832262325, 'recall': 0.37045819871723457, 'f1-score': 0.43445291886893295, 'support': 691163}, '1': {'precision': 0.6393881513734685, 'recall': 0.8261386238206437, 'f1-score': 0.7208646834759309, 'support': 1709937}, '2': {'precision': 0.5466734706895452, 'recall': 0.3115339764039422, 'f1-score': 0.3968908932105918, 'support': 687742}, 'accuracy': 0.6095964118592017, 'macro avg': {'precision': 0.5704118684297487, 'recall': 0.5027102663139401, 'f1-score': 0.5174028318518186, 'support': 3088842}, 'weighted avg': {'precision': 0.5931881880791107, 'recall': 0.6095964118592017, 'f1-score': 0.5846428900252684, 'support': 3088842}}
[[ 256047  383158   51958]
 [ 171580 1412645  125712]
 [  59920  413567  214255]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9194049
{'0': {'precision': 0.5654959773722847, 'recall': 0.3018195845506552, 'f1-score': 0.39357707493949984, 'support': 808811}, '1': {'precision': 0.5494661790158472, 'recall': 0.8450975150003553, 'f1-score': 0.665946639017605, 'support': 1477465}, '2': {'precision': 0.5779976505322688, 'recall': 0.27710493591804286, 'f1-score': 0.37461236686559973, 'support': 802566}, 'accuracy': 0.555260515105661, 'macro avg': {'precision': 0.5643199356401336, 'recall': 0.47467401182301777, 'f1-score': 0.4780453602742349, 'support': 3088842}, 'weighted avg': {'precision': 0.5610768299353558, 'recall': 0.555260515105661, 'f1-score': 0.5189302228475573, 'support': 3088842}}
[[ 244115  506798   57898]
 [ 124388 1248602  104475]
 [  63180  516991  222395]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0358294
{'0': {'precision': 0.5873915564702271, 'recall': 0.2132050923580581, 'f1-score': 0.31285384776682745, 'support': 969217}, '1': {'precision': 0.42192230875096504, 'recall': 0.868734227848145, 'f1-score': 0.5679874400520337, 'support': 1157499}, '2': {'precision': 0.6049394232345675, 'recall': 0.22243136553840143, 'f1-score': 0.32526529532818804, 'support': 962126}, 'accuracy': 0.4617290233686281, 'macro avg': {'precision': 0.5380844294852533, 'recall': 0.4347902285815348, 'f1-score': 0.40203552771568307, 'support': 3088842}, 'weighted avg': {'precision': 0.5308502280671265, 'recall': 0.4617290233686281, 'f1-score': 0.41232745448836117, 'support': 3088842}}
[[ 206642  697485   65090]
 [  77271 1005559   74669]
 [  67883  680236  214007]]
Evaluating performance on  train set...
2948/2948 - 21s - 21s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.78830135
{'0': {'precision': 0.494423109689765, 'recall': 0.2953292831866721, 'f1-score': 0.36978076645966995, 'support': 127732}, '1': {'precision': 0.7362913796062023, 'recall': 0.8055394115873082, 'f1-score': 0.7693603319799674, 'support': 500703}, '2': {'precision': 0.3982099991563835, 'recall': 0.4119336437995351, 'f1-score': 0.4049555838058323, 'support': 126047}, 'accuracy': 0.6534045875183239, 'macro avg': {'precision': 0.5429748294841169, 'recall': 0.5042674461911718, 'f1-score': 0.5146988940818232, 'support': 754482}, 'weighted avg': {'precision': 0.6388623334334311, 'recall': 0.6534045875183239, 'f1-score': 0.640833445511975, 'support': 754482}}
[[ 37723  76993  13016]
 [ 31915 403336  65452]
 [  6659  67465  51923]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.88842297
{'0': {'precision': 0.5801129566257686, 'recall': 0.24465825755353476, 'f1-score': 0.34416677670672124, 'support': 170450}, '1': {'precision': 0.6213759521901054, 'recall': 0.8224742456538789, 'f1-score': 0.7079206946927898, 'support': 415658}, '2': {'precision': 0.47434997016999325, 'recall': 0.37305047097532873, 'f1-score': 0.4176454747648699, 'support': 168374}, 'accuracy': 0.5916403572252221, 'macro avg': {'precision': 0.5586129596619558, 'recall': 0.4800609913942475, 'f1-score': 0.4899109820547937, 'support': 754482}, 'weighted avg': {'precision': 0.5792428989289334, 'recall': 0.5916403572252221, 'f1-score': 0.5609633713890279, 'support': 754482}}
[[ 41702 111096  17652]
 [ 21837 341868  51953]
 [  8347  97215  62812]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9613453
{'0': {'precision': 0.6160631383472609, 'recall': 0.2064447165569295, 'f1-score': 0.3092565723693607, 'support': 199264}, '1': {'precision': 0.5360462425256858, 'recall': 0.8348546952665946, 'f1-score': 0.6528855734438093, 'support': 357903}, '2': {'precision': 0.5116462904550304, 'recall': 0.3378709170615513, 'f1-score': 0.40698504947895997, 'support': 197315}, 'accuracy': 0.5389141159099886, 'macro avg': {'precision': 0.5545852237759924, 'recall': 0.4597234429616918, 'f1-score': 0.45637573176404334, 'support': 754482}, 'weighted avg': {'precision': 0.550798099012877, 'recall': 0.5389141159099886, 'f1-score': 0.4978218990868025, 'support': 754482}}
[[ 41137 137291  20836]
 [ 16310 298797  42796]
 [  9327 121321  66667]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0694008
{'0': {'precision': 0.6339840434561195, 'recall': 0.15730109927136418, 'f1-score': 0.25206182088142, 'support': 237430}, '1': {'precision': 0.41659012198926687, 'recall': 0.8522335054340074, 'f1-score': 0.5596239734486856, 'support': 280456}, '2': {'precision': 0.5417169404020257, 'recall': 0.27895230688599976, 'f1-score': 0.3682681925848633, 'support': 236596}, 'accuracy': 0.45376960616688006, 'macro avg': {'precision': 0.5307637019491374, 'recall': 0.42949563719712386, 'f1-score': 0.39331799563832304, 'support': 754482}, 'weighted avg': {'precision': 0.5242405941053147, 'recall': 0.45376960616688006, 'f1-score': 0.40282965070367277, 'support': 754482}}
[[ 37348 175080  25002]
 [ 10610 239014  30832]
 [ 10952 159645  65999]]
Evaluating performance on  val set...
697/697 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6965312
{'0': {'precision': 0.4616509824954898, 'recall': 0.36840466926070037, 'f1-score': 0.409790300590794, 'support': 25700}, '1': {'precision': 0.7996486121688773, 'recall': 0.83158464289075, 'f1-score': 0.8153040082109317, 'support': 127524}, '2': {'precision': 0.4217377542138166, 'recall': 0.42337940896091514, 'f1-score': 0.4225569871159564, 'support': 25176}, 'accuracy': 0.7072533632286996, 'macro avg': {'precision': 0.5610124496260612, 'recall': 0.5411229070374551, 'f1-score': 0.5492170986392274, 'support': 178400}, 'weighted avg': {'precision': 0.6976260626033916, 'recall': 0.7072533632286996, 'f1-score': 0.7014615121967802, 'support': 178400}}
[[  9468  13535   2697]
 [  9559 106047  11918]
 [  1482  13035  10659]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.78647757
{'0': {'precision': 0.5463590405507153, 'recall': 0.2939015217265521, 'f1-score': 0.38220466516177576, 'support': 34566}, '1': {'precision': 0.6994187387896965, 'recall': 0.8539623978845402, 'f1-score': 0.769002904954789, 'support': 110047}, '2': {'precision': 0.49117635498958456, 'recall': 0.36987598780596087, 'f1-score': 0.421982103663684, 'support': 33787}, 'accuracy': 0.6537668161434977, 'macro avg': {'precision': 0.5789847114433321, 'recall': 0.5059133024723511, 'f1-score': 0.5243965579267496, 'support': 178400}, 'weighted avg': {'precision': 0.6303237446709578, 'recall': 0.6537668161434977, 'f1-score': 0.6283366506391619, 'support': 178400}}
[[10159 20948  3459]
 [ 6584 93976  9487]
 [ 1851 19439 12497]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.86142963
{'0': {'precision': 0.5901894938834252, 'recall': 0.23995513945777258, 'f1-score': 0.3411911530194828, 'support': 41016}, '1': {'precision': 0.6200410821716533, 'recall': 0.8710489022161063, 'f1-score': 0.7244178548704612, 'support': 97378}, '2': {'precision': 0.5254964894684052, 'recall': 0.32740088986652, 'f1-score': 0.4034436555728388, 'support': 40006}, 'accuracy': 0.6040414798206278, 'macro avg': {'precision': 0.5785756885078279, 'recall': 0.4794683105134663, 'f1-score': 0.48968422115426097, 'support': 178400}, 'weighted avg': {'precision': 0.5919763752158456, 'recall': 0.6040414798206278, 'f1-score': 0.5643319791965798, 'support': 178400}}
[[ 9842 27183  3991]
 [ 4721 84821  7836]
 [ 2113 24795 13098]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9750163
{'0': {'precision': 0.6192252510760402, 'recall': 0.17212019700504477, 'f1-score': 0.2693669938056826, 'support': 50151}, '1': {'precision': 0.5028195355559019, 'recall': 0.8928036830651958, 'f1-score': 0.643324254385766, 'support': 79499}, '2': {'precision': 0.554845077675736, 'recall': 0.2652102564102564, 'f1-score': 0.35887969799589187, 'support': 48750}, 'accuracy': 0.5187107623318385, 'macro avg': {'precision': 0.5589632881025594, 'recall': 0.44337804549349896, 'f1-score': 0.4238569820624469, 'support': 178400}, 'weighted avg': {'precision': 0.5497596040390429, 'recall': 0.5187107623318385, 'f1-score': 0.4604711002413819, 'support': 178400}}
[[ 8632 36832  4687]
 [ 2836 70977  5686]
 [ 2472 33349 12929]]
training model: results/ATVI/W1/deepOF_L1/seq2seq
Epoch 1/50
2948/2948 - 67s - loss: 12.3350 - accuracy10: 0.4392 - accuracy20: 0.4578 - accuracy30: 0.4619 - accuracy50: 0.4570 - val_loss: 12.5568 - val_accuracy10: 0.7051 - val_accuracy20: 0.6144 - val_accuracy30: 0.5460 - val_accuracy50: 0.4472 - 67s/epoch - 23ms/step
Epoch 2/50
2948/2948 - 63s - loss: 12.3552 - accuracy10: 0.4148 - accuracy20: 0.4433 - accuracy30: 0.4553 - accuracy50: 0.4552 - val_loss: 11.9606 - val_accuracy10: 0.6814 - val_accuracy20: 0.6141 - val_accuracy30: 0.5534 - val_accuracy50: 0.4586 - 63s/epoch - 21ms/step
Epoch 3/50
2948/2948 - 65s - loss: 12.3201 - accuracy10: 0.4379 - accuracy20: 0.4598 - accuracy30: 0.4663 - accuracy50: 0.4595 - val_loss: 11.9777 - val_accuracy10: 0.6952 - val_accuracy20: 0.6190 - val_accuracy30: 0.5564 - val_accuracy50: 0.4589 - 65s/epoch - 22ms/step
Epoch 4/50
2948/2948 - 60s - loss: 12.2519 - accuracy10: 0.4529 - accuracy20: 0.4707 - accuracy30: 0.4742 - accuracy50: 0.4637 - val_loss: 11.9432 - val_accuracy10: 0.6967 - val_accuracy20: 0.6206 - val_accuracy30: 0.5586 - val_accuracy50: 0.4628 - 60s/epoch - 20ms/step
Epoch 5/50
2948/2948 - 60s - loss: 12.1914 - accuracy10: 0.4620 - accuracy20: 0.4767 - accuracy30: 0.4782 - accuracy50: 0.4672 - val_loss: 11.9318 - val_accuracy10: 0.6998 - val_accuracy20: 0.6227 - val_accuracy30: 0.5604 - val_accuracy50: 0.4642 - 60s/epoch - 20ms/step
Epoch 6/50
2948/2948 - 67s - loss: 12.1234 - accuracy10: 0.4699 - accuracy20: 0.4825 - accuracy30: 0.4828 - accuracy50: 0.4710 - val_loss: 11.9554 - val_accuracy10: 0.6997 - val_accuracy20: 0.6225 - val_accuracy30: 0.5613 - val_accuracy50: 0.4657 - 67s/epoch - 23ms/step
Epoch 7/50
2948/2948 - 63s - loss: 12.0604 - accuracy10: 0.4748 - accuracy20: 0.4866 - accuracy30: 0.4866 - accuracy50: 0.4746 - val_loss: 11.9477 - val_accuracy10: 0.6971 - val_accuracy20: 0.6216 - val_accuracy30: 0.5619 - val_accuracy50: 0.4678 - 63s/epoch - 21ms/step
Epoch 8/50
2948/2948 - 64s - loss: 11.9980 - accuracy10: 0.4798 - accuracy20: 0.4909 - accuracy30: 0.4901 - accuracy50: 0.4780 - val_loss: 12.0093 - val_accuracy10: 0.6966 - val_accuracy20: 0.6220 - val_accuracy30: 0.5622 - val_accuracy50: 0.4683 - 64s/epoch - 22ms/step
Epoch 9/50
2948/2948 - 62s - loss: 11.9331 - accuracy10: 0.4853 - accuracy20: 0.4961 - accuracy30: 0.4941 - accuracy50: 0.4811 - val_loss: 11.9927 - val_accuracy10: 0.6971 - val_accuracy20: 0.6227 - val_accuracy30: 0.5637 - val_accuracy50: 0.4716 - 62s/epoch - 21ms/step
Epoch 10/50
2948/2948 - 66s - loss: 11.8778 - accuracy10: 0.4904 - accuracy20: 0.5000 - accuracy30: 0.4973 - accuracy50: 0.4836 - val_loss: 11.9704 - val_accuracy10: 0.6934 - val_accuracy20: 0.6217 - val_accuracy30: 0.5647 - val_accuracy50: 0.4756 - 66s/epoch - 22ms/step
Epoch 11/50
2948/2948 - 66s - loss: 11.8253 - accuracy10: 0.4938 - accuracy20: 0.5036 - accuracy30: 0.5007 - accuracy50: 0.4867 - val_loss: 11.9663 - val_accuracy10: 0.6927 - val_accuracy20: 0.6211 - val_accuracy30: 0.5644 - val_accuracy50: 0.4763 - 66s/epoch - 22ms/step
Epoch 12/50
2948/2948 - 68s - loss: 11.7833 - accuracy10: 0.4966 - accuracy20: 0.5065 - accuracy30: 0.5033 - accuracy50: 0.4893 - val_loss: 11.9453 - val_accuracy10: 0.6870 - val_accuracy20: 0.6180 - val_accuracy30: 0.5634 - val_accuracy50: 0.4788 - 68s/epoch - 23ms/step
Epoch 13/50
2948/2948 - 60s - loss: 11.7494 - accuracy10: 0.5009 - accuracy20: 0.5096 - accuracy30: 0.5053 - accuracy50: 0.4908 - val_loss: 11.9445 - val_accuracy10: 0.6891 - val_accuracy20: 0.6197 - val_accuracy30: 0.5655 - val_accuracy50: 0.4790 - 60s/epoch - 20ms/step
Epoch 14/50
2948/2948 - 60s - loss: 11.7143 - accuracy10: 0.5029 - accuracy20: 0.5119 - accuracy30: 0.5079 - accuracy50: 0.4930 - val_loss: 11.9166 - val_accuracy10: 0.6849 - val_accuracy20: 0.6165 - val_accuracy30: 0.5643 - val_accuracy50: 0.4806 - 60s/epoch - 20ms/step
Epoch 15/50
2948/2948 - 65s - loss: 11.6831 - accuracy10: 0.5056 - accuracy20: 0.5140 - accuracy30: 0.5097 - accuracy50: 0.4947 - val_loss: 11.8434 - val_accuracy10: 0.6884 - val_accuracy20: 0.6198 - val_accuracy30: 0.5665 - val_accuracy50: 0.4814 - 65s/epoch - 22ms/step
Epoch 16/50
2948/2948 - 61s - loss: 11.6576 - accuracy10: 0.5080 - accuracy20: 0.5164 - accuracy30: 0.5124 - accuracy50: 0.4965 - val_loss: 11.9641 - val_accuracy10: 0.6813 - val_accuracy20: 0.6133 - val_accuracy30: 0.5611 - val_accuracy50: 0.4801 - 61s/epoch - 21ms/step
Epoch 17/50
2948/2948 - 64s - loss: 11.6386 - accuracy10: 0.5085 - accuracy20: 0.5166 - accuracy30: 0.5124 - accuracy50: 0.4967 - val_loss: 11.8515 - val_accuracy10: 0.6813 - val_accuracy20: 0.6147 - val_accuracy30: 0.5636 - val_accuracy50: 0.4830 - 64s/epoch - 22ms/step
Epoch 18/50
2948/2948 - 65s - loss: 11.6118 - accuracy10: 0.5114 - accuracy20: 0.5193 - accuracy30: 0.5147 - accuracy50: 0.4986 - val_loss: 11.8867 - val_accuracy10: 0.6795 - val_accuracy20: 0.6135 - val_accuracy30: 0.5631 - val_accuracy50: 0.4836 - 65s/epoch - 22ms/step
Epoch 19/50
2948/2948 - 60s - loss: 11.5901 - accuracy10: 0.5128 - accuracy20: 0.5208 - accuracy30: 0.5160 - accuracy50: 0.4999 - val_loss: 11.9040 - val_accuracy10: 0.6814 - val_accuracy20: 0.6140 - val_accuracy30: 0.5629 - val_accuracy50: 0.4825 - 60s/epoch - 20ms/step
Epoch 20/50
2948/2948 - 62s - loss: 11.5683 - accuracy10: 0.5139 - accuracy20: 0.5218 - accuracy30: 0.5177 - accuracy50: 0.5016 - val_loss: 11.8864 - val_accuracy10: 0.6751 - val_accuracy20: 0.6112 - val_accuracy30: 0.5619 - val_accuracy50: 0.4845 - 62s/epoch - 21ms/step
Epoch 21/50
2948/2948 - 65s - loss: 11.5470 - accuracy10: 0.5154 - accuracy20: 0.5229 - accuracy30: 0.5185 - accuracy50: 0.5026 - val_loss: 11.8975 - val_accuracy10: 0.6805 - val_accuracy20: 0.6143 - val_accuracy30: 0.5639 - val_accuracy50: 0.4844 - 65s/epoch - 22ms/step
Epoch 22/50
2948/2948 - 65s - loss: 11.5279 - accuracy10: 0.5162 - accuracy20: 0.5243 - accuracy30: 0.5202 - accuracy50: 0.5038 - val_loss: 11.8962 - val_accuracy10: 0.6783 - val_accuracy20: 0.6119 - val_accuracy30: 0.5629 - val_accuracy50: 0.4846 - 65s/epoch - 22ms/step
Epoch 23/50
2948/2948 - 66s - loss: 11.5074 - accuracy10: 0.5185 - accuracy20: 0.5257 - accuracy30: 0.5212 - accuracy50: 0.5045 - val_loss: 11.9246 - val_accuracy10: 0.6794 - val_accuracy20: 0.6137 - val_accuracy30: 0.5642 - val_accuracy50: 0.4847 - 66s/epoch - 22ms/step
Epoch 24/50
2948/2948 - 66s - loss: 11.4881 - accuracy10: 0.5193 - accuracy20: 0.5267 - accuracy30: 0.5227 - accuracy50: 0.5060 - val_loss: 11.8620 - val_accuracy10: 0.6786 - val_accuracy20: 0.6124 - val_accuracy30: 0.5643 - val_accuracy50: 0.4851 - 66s/epoch - 22ms/step
Epoch 25/50
2948/2948 - 64s - loss: 11.4692 - accuracy10: 0.5203 - accuracy20: 0.5280 - accuracy30: 0.5237 - accuracy50: 0.5071 - val_loss: 11.9124 - val_accuracy10: 0.6774 - val_accuracy20: 0.6132 - val_accuracy30: 0.5635 - val_accuracy50: 0.4844 - 64s/epoch - 22ms/step
testing model: results/ATVI/W1/deepOF_L1/seq2seq
Evaluating performance on  test set...
12066/12066 - 92s - 92s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8558862
{'0': {'precision': 0.36980218205182064, 'recall': 0.28338610471458003, 'f1-score': 0.3208777683550098, 'support': 528064}, '1': {'precision': 0.7017695415093921, 'recall': 0.822656001132623, 'f1-score': 0.7574196424631323, 'support': 2034216}, '2': {'precision': 0.4011744557542657, 'recall': 0.2282165083742121, 'f1-score': 0.29093088003873624, 'support': 526557}, 'accuracy': 0.6291283742068616, 'macro avg': {'precision': 0.49091539310515947, 'recall': 0.4447528714071383, 'f1-score': 0.45640943028562614, 'support': 3088837}, 'weighted avg': {'precision': 0.5937740537984624, 'recall': 0.6291283742068616, 'f1-score': 0.603266162857399, 'support': 3088837}}
[[ 149646  353146   25272]
 [ 206654 1673460  154102]
 [  48365  358023  120169]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.93478405
{'0': {'precision': 0.43134376090243054, 'recall': 0.2575926593080339, 'f1-score': 0.32255802767065883, 'support': 691161}, '1': {'precision': 0.5955113914711648, 'recall': 0.8289111405339147, 'f1-score': 0.6930893265363505, 'support': 1709936}, '2': {'precision': 0.4755972713542881, 'recall': 0.20467473173001424, 'f1-score': 0.28618771163481954, 'support': 687740}, 'accuracy': 0.5620840465197743, 'macro avg': {'precision': 0.5008174745759612, 'recall': 0.43039284385732096, 'f1-score': 0.43394502194727624, 'support': 3088837}, 'weighted avg': {'precision': 0.5320778076722471, 'recall': 0.5620840465197743, 'f1-score': 0.5195808831682838, 'support': 3088837}}
[[ 178038  480287   32836]
 [ 170179 1417385  122372]
 [  64535  482442  140763]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9942242
{'0': {'precision': 0.4649519166456101, 'recall': 0.23205602311546977, 'f1-score': 0.30959444379838724, 'support': 808809}, '1': {'precision': 0.5154149767332474, 'recall': 0.8395630353341703, 'f1-score': 0.6387164344646584, 'support': 1477465}, '2': {'precision': 0.5145129438799325, 'recall': 0.17854922292704747, 'f1-score': 0.2651014316332015, 'support': 802563}, 'accuracy': 0.5087387259347127, 'macro avg': {'precision': 0.4982932790862633, 'recall': 0.4167227604588959, 'f1-score': 0.4044707699654157, 'support': 3088837}, 'weighted avg': {'precision': 0.5019669005287482, 'recall': 0.5087387259347127, 'f1-score': 0.45546092254667164, 'support': 3088837}}
[[ 187689  583464   37656]
 [ 139483 1240425   97557]
 [  76502  582764  143297]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.077033
{'0': {'precision': 0.49589275189852716, 'recall': 0.1814373679344955, 'f1-score': 0.26567097209391216, 'support': 969216}, '1': {'precision': 0.40056510756258473, 'recall': 0.8608852887866761, 'f1-score': 0.5467366918269291, 'support': 1157498}, '2': {'precision': 0.5493445601739186, 'recall': 0.14077410060875792, 'f1-score': 0.22411649119904026, 'support': 962123}, 'accuracy': 0.42338491801283135, 'macro avg': {'precision': 0.4819341398783435, 'recall': 0.3943655857766432, 'f1-score': 0.3455080517066272, 'support': 3088837}, 'weighted avg': {'precision': 0.47681944258171305, 'recall': 0.42338491801283135, 'f1-score': 0.35805282540553424, 'support': 3088837}}
[[175852 749377  43987]
 [ 93902 996473  67123]
 [ 84863 741818 135442]]
Evaluating performance on  train set...
2948/2948 - 24s - 24s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.84309375
{'0': {'precision': 0.39709630943145297, 'recall': 0.25205571535767884, 'f1-score': 0.3083727401825545, 'support': 127936}, '1': {'precision': 0.7023685939553219, 'recall': 0.8542830828367021, 'f1-score': 0.7709131293500003, 'support': 500539}, '2': {'precision': 0.4179268841220356, 'recall': 0.21384072060632514, 'f1-score': 0.28291981226178353, 'support': 126005}, 'accuracy': 0.6452046442582972, 'macro avg': {'precision': 0.5057972625029369, 'recall': 0.4400598396002353, 'f1-score': 0.4540685605981128, 'support': 754480}, 'weighted avg': {'precision': 0.603099703275133, 'recall': 0.6452046442582972, 'f1-score': 0.6109815670180272, 'support': 754480}}
[[ 32247  90132   5557]
 [ 40966 427602  31971]
 [  7994  91066  26945]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.93046296
{'0': {'precision': 0.4739397225165726, 'recall': 0.22534551142721557, 'f1-score': 0.30545529627114876, 'support': 170689}, '1': {'precision': 0.5900783848410991, 'recall': 0.8630257663100381, 'f1-score': 0.7009172052217362, 'support': 415465}, '2': {'precision': 0.5002968985520486, 'recall': 0.19521048441714292, 'f1-score': 0.280840152988184, 'support': 168326}, 'accuracy': 0.5697699077510339, 'macro avg': {'precision': 0.5214383353032401, 'recall': 0.4278605873847989, 'f1-score': 0.4290708848270229, 'support': 754480}, 'weighted avg': {'precision': 0.543773445552315, 'recall': 0.5697699077510339, 'f1-score': 0.5177302583561708, 'support': 754480}}
[[ 38464 124581   7644]
 [ 31732 358557  25176]
 [ 10962 124505  32859]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9937543
{'0': {'precision': 0.5074721410657497, 'recall': 0.196860660464883, 'f1-score': 0.2836764116072106, 'support': 199405}, '1': {'precision': 0.508295432603768, 'recall': 0.875508652685239, 'f1-score': 0.6431792680710925, 'support': 357808}, '2': {'precision': 0.5410453282475379, 'recall': 0.166819589693157, 'f1-score': 0.25501181758301367, 'support': 197267}, 'accuracy': 0.5108511822712332, 'macro avg': {'precision': 0.5189376339723518, 'recall': 0.41306296761442635, 'f1-score': 0.3939558324204389, 'support': 754480}, 'weighted avg': {'precision': 0.5166406574139962, 'recall': 0.5108511822712332, 'f1-score': 0.44667399881463477, 'support': 754480}}
[[ 39255 151620   8530]
 [ 25159 313264  19385]
 [ 12940 151419  32908]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0788047
{'0': {'precision': 0.5400271780160049, 'recall': 0.1505246013408583, 'f1-score': 0.23542731512412823, 'support': 237609}, '1': {'precision': 0.39523310880926776, 'recall': 0.8968478512942184, 'f1-score': 0.5486714460486065, 'support': 280285}, '2': {'precision': 0.5729545541559784, 'recall': 0.12650790832931788, 'f1-score': 0.2072542447996011, 'support': 236586}, 'accuracy': 0.4202483829922596, 'macro avg': {'precision': 0.5027382803270837, 'recall': 0.39129345365479823, 'f1-score': 0.33045100199077865, 'support': 754480}, 'weighted avg': {'precision': 0.4965622094599682, 'recall': 0.4202483829922596, 'f1-score': 0.34296134812747997, 'support': 754480}}
[[ 35766 192301   9542]
 [ 16146 251373  12766]
 [ 14318 192338  29930]]
Evaluating performance on  val set...
697/697 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8023625
{'0': {'precision': 0.3645448867185282, 'recall': 0.250370485921535, 'f1-score': 0.29685802140891965, 'support': 25642}, '1': {'precision': 0.7559062131718146, 'recall': 0.8643903126983257, 'f1-score': 0.8065165820475987, 'support': 127631}, '2': {'precision': 0.4049592345529277, 'recall': 0.2391849405022486, 'f1-score': 0.30074059247397916, 'support': 25127}, 'accuracy': 0.6880773542600896, 'macro avg': {'precision': 0.5084701114810901, 'recall': 0.4513152463740364, 'f1-score': 0.4680383986434992, 'support': 178400}, 'weighted avg': {'precision': 0.6502249807465236, 'recall': 0.6880773542600896, 'f1-score': 0.6620250007588467, 'support': 178400}}
[[  6420  18097   1125]
 [  9602 110323   7706]
 [  1589  17528   6010]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.88154304
{'0': {'precision': 0.4293434975537604, 'recall': 0.2189567134733666, 'f1-score': 0.29001268108980516, 'support': 34468}, '1': {'precision': 0.6583522817044604, 'recall': 0.8701064061592098, 'f1-score': 0.749561034745713, 'support': 110144}, '2': {'precision': 0.47393613533538786, 'recall': 0.21392210252160532, 'f1-score': 0.29478578274434636, 'support': 33788}, 'accuracy': 0.6200224215246637, 'macro avg': {'precision': 0.5205439715312029, 'recall': 0.4343284073847273, 'f1-score': 0.4447864995266215, 'support': 178400}, 'weighted avg': {'precision': 0.579178921134816, 'recall': 0.6200224215246637, 'f1-score': 0.574641422254491, 'support': 178400}}
[[ 7547 25392  1529]
 [ 7813 95837  6494]
 [ 2218 24342  7228]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.94406545
{'0': {'precision': 0.465039108793553, 'recall': 0.19179823060755657, 'f1-score': 0.27158528566979273, 'support': 40918}, '1': {'precision': 0.5835612348075109, 'recall': 0.8823505268882299, 'f1-score': 0.7025055347237539, 'support': 97459}, '2': {'precision': 0.5157783268619838, 'recall': 0.18254503660395272, 'f1-score': 0.2696537978888315, 'support': 40023}, 'accuracy': 0.5669674887892376, 'macro avg': {'precision': 0.5214595568210159, 'recall': 0.4188979313665797, 'f1-score': 0.4145815394274594, 'support': 178400}, 'weighted avg': {'precision': 0.5411701828067096, 'recall': 0.5669674887892376, 'f1-score': 0.5065614774696391, 'support': 178400}}
[[ 7848 31345  1725]
 [ 6332 85993  5134]
 [ 2696 30021  7306]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0291417
{'0': {'precision': 0.5048817381738174, 'recall': 0.1465844212879786, 'f1-score': 0.22720381199913361, 'support': 50094}, '1': {'precision': 0.4743097072723797, 'recall': 0.9042335289460788, 'f1-score': 0.6222318301699166, 'support': 79579}, '2': {'precision': 0.5544668587896253, 'recall': 0.1381985346932912, 'f1-score': 0.2212511499540018, 'support': 48727}, 'accuracy': 0.48225896860986545, 'macro avg': {'precision': 0.5112194347452742, 'recall': 0.3963388283091162, 'f1-score': 0.35689559737435067, 'support': 178400}, 'weighted avg': {'precision': 0.5047878061398542, 'recall': 0.48225896860986545, 'f1-score': 0.4017883371927412, 'support': 178400}}
[[ 7343 40801  1950]
 [ 4160 71958  3461]
 [ 3041 38952  6734]]
training model: results/ATVI/W1/deepLOB_L2/seq2seq
Epoch 1/50
2948/2948 - 139s - loss: 11.8930 - accuracy10: 0.4491 - accuracy20: 0.4727 - accuracy30: 0.4810 - accuracy50: 0.4791 - val_loss: 12.3012 - val_accuracy10: 0.6515 - val_accuracy20: 0.5896 - val_accuracy30: 0.5383 - val_accuracy50: 0.4492 - 139s/epoch - 47ms/step
Epoch 2/50
2948/2948 - 133s - loss: 11.2928 - accuracy10: 0.5196 - accuracy20: 0.5339 - accuracy30: 0.5331 - accuracy50: 0.5156 - val_loss: 11.3560 - val_accuracy10: 0.6781 - val_accuracy20: 0.6314 - val_accuracy30: 0.5894 - val_accuracy50: 0.5128 - 133s/epoch - 45ms/step
Epoch 3/50
2948/2948 - 133s - loss: 10.6201 - accuracy10: 0.6012 - accuracy20: 0.5932 - accuracy30: 0.5764 - accuracy50: 0.5417 - val_loss: 10.6798 - val_accuracy10: 0.6702 - val_accuracy20: 0.6377 - val_accuracy30: 0.6057 - val_accuracy50: 0.5364 - 133s/epoch - 45ms/step
Epoch 4/50
2948/2948 - 133s - loss: 10.4000 - accuracy10: 0.6131 - accuracy20: 0.6029 - accuracy30: 0.5849 - accuracy50: 0.5483 - val_loss: 10.4469 - val_accuracy10: 0.6680 - val_accuracy20: 0.6430 - val_accuracy30: 0.6135 - val_accuracy50: 0.5457 - 133s/epoch - 45ms/step
Epoch 5/50
2948/2948 - 134s - loss: 10.2966 - accuracy10: 0.6171 - accuracy20: 0.6074 - accuracy30: 0.5890 - accuracy50: 0.5518 - val_loss: 10.4234 - val_accuracy10: 0.6764 - val_accuracy20: 0.6489 - val_accuracy30: 0.6167 - val_accuracy50: 0.5471 - 134s/epoch - 45ms/step
Epoch 6/50
2948/2948 - 133s - loss: 10.2324 - accuracy10: 0.6183 - accuracy20: 0.6091 - accuracy30: 0.5913 - accuracy50: 0.5542 - val_loss: 10.2487 - val_accuracy10: 0.6459 - val_accuracy20: 0.6323 - val_accuracy30: 0.6094 - val_accuracy50: 0.5511 - 133s/epoch - 45ms/step
Epoch 7/50
2948/2948 - 132s - loss: 10.1854 - accuracy10: 0.6193 - accuracy20: 0.6106 - accuracy30: 0.5931 - accuracy50: 0.5558 - val_loss: 10.3707 - val_accuracy10: 0.6603 - val_accuracy20: 0.6398 - val_accuracy30: 0.6132 - val_accuracy50: 0.5496 - 132s/epoch - 45ms/step
Epoch 8/50
2948/2948 - 132s - loss: 10.1488 - accuracy10: 0.6205 - accuracy20: 0.6127 - accuracy30: 0.5951 - accuracy50: 0.5571 - val_loss: 10.4780 - val_accuracy10: 0.6481 - val_accuracy20: 0.6304 - val_accuracy30: 0.6054 - val_accuracy50: 0.5466 - 132s/epoch - 45ms/step
Epoch 9/50
2948/2948 - 131s - loss: 10.1167 - accuracy10: 0.6214 - accuracy20: 0.6135 - accuracy30: 0.5958 - accuracy50: 0.5586 - val_loss: 10.4511 - val_accuracy10: 0.6452 - val_accuracy20: 0.6286 - val_accuracy30: 0.6052 - val_accuracy50: 0.5475 - 131s/epoch - 45ms/step
Epoch 10/50
2948/2948 - 132s - loss: 10.0893 - accuracy10: 0.6226 - accuracy20: 0.6148 - accuracy30: 0.5967 - accuracy50: 0.5596 - val_loss: 10.4848 - val_accuracy10: 0.6472 - val_accuracy20: 0.6295 - val_accuracy30: 0.6064 - val_accuracy50: 0.5469 - 132s/epoch - 45ms/step
Epoch 11/50
2948/2948 - 132s - loss: 10.0668 - accuracy10: 0.6231 - accuracy20: 0.6151 - accuracy30: 0.5979 - accuracy50: 0.5608 - val_loss: 10.4429 - val_accuracy10: 0.6401 - val_accuracy20: 0.6262 - val_accuracy30: 0.6046 - val_accuracy50: 0.5480 - 132s/epoch - 45ms/step
Epoch 12/50
2948/2948 - 134s - loss: 10.0406 - accuracy10: 0.6242 - accuracy20: 0.6170 - accuracy30: 0.5994 - accuracy50: 0.5618 - val_loss: 10.4950 - val_accuracy10: 0.6553 - val_accuracy20: 0.6343 - val_accuracy30: 0.6083 - val_accuracy50: 0.5481 - 134s/epoch - 46ms/step
Epoch 13/50
2948/2948 - 132s - loss: 10.0243 - accuracy10: 0.6244 - accuracy20: 0.6177 - accuracy30: 0.5999 - accuracy50: 0.5626 - val_loss: 10.4299 - val_accuracy10: 0.6428 - val_accuracy20: 0.6263 - val_accuracy30: 0.6050 - val_accuracy50: 0.5498 - 132s/epoch - 45ms/step
Epoch 14/50
2948/2948 - 133s - loss: 10.0029 - accuracy10: 0.6254 - accuracy20: 0.6186 - accuracy30: 0.6011 - accuracy50: 0.5635 - val_loss: 10.5821 - val_accuracy10: 0.6543 - val_accuracy20: 0.6345 - val_accuracy30: 0.6078 - val_accuracy50: 0.5478 - 133s/epoch - 45ms/step
Epoch 15/50
2948/2948 - 132s - loss: 9.9849 - accuracy10: 0.6258 - accuracy20: 0.6189 - accuracy30: 0.6016 - accuracy50: 0.5641 - val_loss: 10.5890 - val_accuracy10: 0.6544 - val_accuracy20: 0.6330 - val_accuracy30: 0.6064 - val_accuracy50: 0.5481 - 132s/epoch - 45ms/step
Epoch 16/50
2948/2948 - 136s - loss: 9.9664 - accuracy10: 0.6264 - accuracy20: 0.6201 - accuracy30: 0.6026 - accuracy50: 0.5654 - val_loss: 10.5210 - val_accuracy10: 0.6585 - val_accuracy20: 0.6360 - val_accuracy30: 0.6086 - val_accuracy50: 0.5486 - 136s/epoch - 46ms/step
testing model: results/ATVI/W1/deepLOB_L2/seq2seq
Evaluating performance on  test set...
12066/12066 - 200s - 200s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7814692
{'0': {'precision': 0.3557746476178999, 'recall': 0.7044057076306894, 'f1-score': 0.47276803644146637, 'support': 528065}, '1': {'precision': 0.8554687254058778, 'recall': 0.6679370981561947, 'f1-score': 0.7501603173275495, 'support': 2034217}, '2': {'precision': 0.48978856292675854, 'recall': 0.42325281069583714, 'f1-score': 0.45409636823558536, 'support': 526560}, 'accuracy': 0.6324599963351961, 'macro avg': {'precision': 0.5670106453168454, 'recall': 0.5985318721609071, 'f1-score': 0.5590082406682004, 'support': 3088842}, 'weighted avg': {'precision': 0.7077034789018115, 'recall': 0.6324599963351961, 'f1-score': 0.6522671302237824, 'support': 3088842}}
[[ 371972   96766   59327]
 [ 502654 1358729  172834]
 [ 170901  132791  222868]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8224321
{'0': {'precision': 0.43048635356527476, 'recall': 0.6474015536132577, 'f1-score': 0.5171178417558847, 'support': 691163}, '1': {'precision': 0.756250936613744, 'recall': 0.7053476239183081, 'f1-score': 0.7299128716058991, 'support': 1709937}, '2': {'precision': 0.5596979136418433, 'recall': 0.3699395994428143, 'f1-score': 0.4454519510397316, 'support': 687742}, 'accuracy': 0.6177017147526485, 'macro avg': {'precision': 0.5821450679402873, 'recall': 0.5742295923247933, 'f1-score': 0.5641608881338386, 'support': 3088842}, 'weighted avg': {'precision': 0.639594210358963, 'recall': 0.6177017147526485, 'f1-score': 0.6189613325992932, 'support': 3088842}}
[[ 447460  175180   68523]
 [ 372211 1206100  131626]
 [ 219758  213561  254423]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8710869
{'0': {'precision': 0.47176025601411614, 'recall': 0.5870716397279463, 'f1-score': 0.5231369930777968, 'support': 808811}, '1': {'precision': 0.6627722902840814, 'recall': 0.7415837261796387, 'f1-score': 0.6999665880666373, 'support': 1477465}, '2': {'precision': 0.5972571077072197, 'recall': 0.31939055479549344, 'f1-score': 0.4162085101822775, 'support': 802566}, 'accuracy': 0.5914274669924846, 'macro avg': {'precision': 0.5772632180018057, 'recall': 0.5493486402343595, 'f1-score': 0.5464373637755705, 'support': 3088842}, 'weighted avg': {'precision': 0.5957332858708072, 'recall': 0.5914274669924846, 'f1-score': 0.5799357457354795, 'support': 3088842}}
[[ 474830  262521   71460]
 [ 280411 1095664  101390]
 [ 251266  294968  256332]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9718853
{'0': {'precision': 0.49969172272901535, 'recall': 0.49084879856626534, 'f1-score': 0.49523078860885594, 'support': 969217}, '1': {'precision': 0.5159970558481718, 'recall': 0.7764516427228015, 'f1-score': 0.619980912350992, 'support': 1157499}, '2': {'precision': 0.6227421972107671, 'recall': 0.2556785701664855, 'f1-score': 0.3625183749709869, 'support': 962126}, 'accuracy': 0.5246224960681057, 'macro avg': {'precision': 0.5461436585959847, 'recall': 0.5076596704851841, 'f1-score': 0.4925766919769449, 'support': 3088842}, 'weighted avg': {'precision': 0.544130210547855, 'recall': 0.5246224960681057, 'f1-score': 0.5006412562849787, 'support': 3088842}}
[[475739 414419  79059]
 [188792 898742  69965]
 [287534 428597 245995]]
Evaluating performance on  train set...
2948/2948 - 51s - 51s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7856234
{'0': {'precision': 0.39646134067521, 'recall': 0.5287320326934519, 'f1-score': 0.4531416168197021, 'support': 127732}, '1': {'precision': 0.8192186846888312, 'recall': 0.6967423802134199, 'f1-score': 0.753033029014116, 'support': 500703}, '2': {'precision': 0.41498145796612523, 'recall': 0.5211310066879815, 'f1-score': 0.46203787068819985, 'support': 126047}, 'accuracy': 0.6389602402708083, 'macro avg': {'precision': 0.5435538277767221, 'recall': 0.5822018065316178, 'f1-score': 0.5560708388406727, 'support': 754482}, 'weighted avg': {'precision': 0.6801132709317571, 'recall': 0.6389602402708083, 'f1-score': 0.6536472297718231, 'support': 754482}}
[[ 67536  41639  18557]
 [ 77797 348861  74045]
 [ 25014  35346  65687]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.83707446
{'0': {'precision': 0.47613943545014986, 'recall': 0.474320915224406, 'f1-score': 0.4752284356456595, 'support': 170450}, '1': {'precision': 0.7149520765274654, 'recall': 0.7334443220147333, 'f1-score': 0.7240801503918336, 'support': 415658}, '2': {'precision': 0.49693569379683333, 'recall': 0.46712675353676936, 'f1-score': 0.4815703754500257, 'support': 168374}, 'accuracy': 0.6154712769820884, 'macro avg': {'precision': 0.5626757352581495, 'recall': 0.5582973302586361, 'f1-score': 0.5602929871625063, 'support': 754482}, 'weighted avg': {'precision': 0.6123467060911716, 'recall': 0.6154712769820884, 'f1-score': 0.6137407180070487, 'support': 754482}}
[[ 80848  65400  24202]
 [ 55376 304862  55420]
 [ 33575  56147  78652]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.88967615
{'0': {'precision': 0.5137807649533388, 'recall': 0.42658985065039345, 'f1-score': 0.4661431485665402, 'support': 199264}, '1': {'precision': 0.6251499809115203, 'recall': 0.768646812125073, 'f1-score': 0.6895116165116252, 'support': 357903}, '2': {'precision': 0.5406570097598303, 'recall': 0.4082102222334845, 'f1-score': 0.46518988255610133, 'support': 197315}, 'accuracy': 0.5840444172293043, 'macro avg': {'precision': 0.5598625852082297, 'recall': 0.5344822950029836, 'f1-score': 0.5402815492114222, 'support': 754482}, 'weighted avg': {'precision': 0.57363966515649, 'recall': 0.5840444172293043, 'f1-score': 0.5718529615244372, 'support': 754482}}
[[ 85004  87676  26584]
 [ 40954 275101  41848]
 [ 39490  77279  80546]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9891391
{'0': {'precision': 0.53795649090817, 'recall': 0.3578612643726572, 'f1-score': 0.4298057029546708, 'support': 237430}, '1': {'precision': 0.49046670089546, 'recall': 0.8038480189405824, 'f1-score': 0.6092191950364, 'support': 280456}, '2': {'precision': 0.5717458322984089, 'recall': 0.33079172936144313, 'f1-score': 0.41910453515832086, 'support': 236596}, 'accuracy': 0.5151547684371529, 'macro avg': {'precision': 0.5333896747006796, 'recall': 0.4975003375582276, 'f1-score': 0.48604314438313057, 'support': 754482}, 'weighted avg': {'precision': 0.5308994987834544, 'recall': 0.5151547684371529, 'f1-score': 0.4931415238746241, 'support': 754482}}
[[ 84967 122325  30138]
 [ 26528 225444  28484]
 [ 46449 111883  78264]]
Evaluating performance on  val set...
697/697 - 12s - 12s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.75686115
{'0': {'precision': 0.33776734480959836, 'recall': 0.6046692607003891, 'f1-score': 0.4334244435767278, 'support': 25700}, '1': {'precision': 0.8666619941125818, 'recall': 0.6787506665412001, 'f1-score': 0.7612819813718678, 'support': 127524}, '2': {'precision': 0.4031305738360293, 'recall': 0.5206943120432158, 'f1-score': 0.45443200332790246, 'support': 25176}, 'accuracy': 0.6457735426008968, 'macro avg': {'precision': 0.5358533042527366, 'recall': 0.601371413094935, 'f1-score': 0.5497128094254994, 'support': 178400}, 'weighted avg': {'precision': 0.7250562792921269, 'recall': 0.6457735426008968, 'f1-score': 0.6707483840144128, 'support': 178400}}
[[15540  6492  3668]
 [25226 86557 15741]
 [ 5242  6825 13109]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7971417
{'0': {'precision': 0.41646665051857396, 'recall': 0.5471561650176474, 'f1-score': 0.4729491491516523, 'support': 34566}, '1': {'precision': 0.7794558026165249, 'recall': 0.7119412614610121, 'f1-score': 0.7441703631234504, 'support': 110047}, '2': {'precision': 0.4775190933727519, 'recall': 0.4589339094918164, 'f1-score': 0.46804207730270597, 'support': 33787}, 'accuracy': 0.6320964125560539, 'macro avg': {'precision': 0.5578138488359503, 'recall': 0.5726771119901587, 'f1-score': 0.5617205298592696, 'support': 178400}, 'weighted avg': {'precision': 0.6519411242160926, 'recall': 0.6320964125560539, 'f1-score': 0.6393240689800948, 'support': 178400}}
[[18913 11051  4602]
 [19336 78347 12364]
 [ 7164 11117 15506]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8405445
{'0': {'precision': 0.45986325652063814, 'recall': 0.4870294519212015, 'f1-score': 0.47305665739151026, 'support': 41016}, '1': {'precision': 0.6984603902130958, 'recall': 0.7495943642301136, 'f1-score': 0.7231245511058276, 'support': 97378}, '2': {'precision': 0.5202600643593617, 'recall': 0.39604059391091334, 'f1-score': 0.4497303434572807, 'support': 40006}, 'accuracy': 0.6099439461883408, 'macro avg': {'precision': 0.5595279036976986, 'recall': 0.5442214700207428, 'f1-score': 0.5486371839848728, 'support': 178400}, 'weighted avg': {'precision': 0.6036432250133518, 'recall': 0.6099439461883408, 'f1-score': 0.6043230185958824, 'support': 178400}}
[[19976 15997  5043]
 [14817 72994  9567]
 [ 8646 15516 15844]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9302898
{'0': {'precision': 0.49575070821529743, 'recall': 0.4012881099080776, 'f1-score': 0.44354572102351614, 'support': 50151}, '1': {'precision': 0.5701322907669227, 'recall': 0.7887646385489125, 'f1-score': 0.661860632032256, 'support': 79499}, '2': {'precision': 0.5587347232207045, 'recall': 0.31885128205128205, 'f1-score': 0.40600757476818594, 'support': 48750}, 'accuracy': 0.5514293721973094, 'macro avg': {'precision': 0.5415392407343083, 'recall': 0.5029680101694242, 'f1-score': 0.503804642607986, 'support': 178400}, 'weighted avg': {'precision': 0.5461079512802371, 'recall': 0.5514293721973094, 'f1-score': 0.5305739299940121, 'support': 178400}}
[[20125 24319  5707]
 [10224 62706  6569]
 [10246 22960 15544]]
training model: results/ATVI/W1/deepOF_L2/seq2seq
Epoch 1/50
2948/2948 - 86s - loss: 11.0491 - accuracy10: 0.5627 - accuracy20: 0.5648 - accuracy30: 0.5531 - accuracy50: 0.5233 - val_loss: 10.6272 - val_accuracy10: 0.6845 - val_accuracy20: 0.6561 - val_accuracy30: 0.6189 - val_accuracy50: 0.5439 - 86s/epoch - 29ms/step
Epoch 2/50
2948/2948 - 85s - loss: 10.5195 - accuracy10: 0.6039 - accuracy20: 0.5978 - accuracy30: 0.5799 - accuracy50: 0.5434 - val_loss: 10.4018 - val_accuracy10: 0.6800 - val_accuracy20: 0.6553 - val_accuracy30: 0.6223 - val_accuracy50: 0.5501 - 85s/epoch - 29ms/step
Epoch 3/50
2948/2948 - 84s - loss: 10.4142 - accuracy10: 0.6095 - accuracy20: 0.6022 - accuracy30: 0.5841 - accuracy50: 0.5481 - val_loss: 10.4109 - val_accuracy10: 0.6568 - val_accuracy20: 0.6387 - val_accuracy30: 0.6130 - val_accuracy50: 0.5491 - 84s/epoch - 29ms/step
Epoch 4/50
2948/2948 - 81s - loss: 10.3508 - accuracy10: 0.6119 - accuracy20: 0.6045 - accuracy30: 0.5867 - accuracy50: 0.5499 - val_loss: 10.3302 - val_accuracy10: 0.6660 - val_accuracy20: 0.6446 - val_accuracy30: 0.6169 - val_accuracy50: 0.5515 - 81s/epoch - 27ms/step
Epoch 5/50
2948/2948 - 82s - loss: 10.3067 - accuracy10: 0.6134 - accuracy20: 0.6062 - accuracy30: 0.5883 - accuracy50: 0.5514 - val_loss: 10.2476 - val_accuracy10: 0.6631 - val_accuracy20: 0.6421 - val_accuracy30: 0.6150 - val_accuracy50: 0.5514 - 82s/epoch - 28ms/step
Epoch 6/50
2948/2948 - 80s - loss: 10.2667 - accuracy10: 0.6149 - accuracy20: 0.6076 - accuracy30: 0.5898 - accuracy50: 0.5530 - val_loss: 10.2000 - val_accuracy10: 0.6665 - val_accuracy20: 0.6462 - val_accuracy30: 0.6182 - val_accuracy50: 0.5528 - 80s/epoch - 27ms/step
Epoch 7/50
2948/2948 - 79s - loss: 10.2373 - accuracy10: 0.6155 - accuracy20: 0.6089 - accuracy30: 0.5909 - accuracy50: 0.5542 - val_loss: 10.1482 - val_accuracy10: 0.6775 - val_accuracy20: 0.6517 - val_accuracy30: 0.6209 - val_accuracy50: 0.5533 - 79s/epoch - 27ms/step
Epoch 8/50
2948/2948 - 80s - loss: 10.2061 - accuracy10: 0.6165 - accuracy20: 0.6097 - accuracy30: 0.5920 - accuracy50: 0.5551 - val_loss: 10.0881 - val_accuracy10: 0.6769 - val_accuracy20: 0.6530 - val_accuracy30: 0.6216 - val_accuracy50: 0.5531 - 80s/epoch - 27ms/step
Epoch 9/50
2948/2948 - 86s - loss: 10.1789 - accuracy10: 0.6177 - accuracy20: 0.6111 - accuracy30: 0.5932 - accuracy50: 0.5566 - val_loss: 10.0419 - val_accuracy10: 0.6730 - val_accuracy20: 0.6513 - val_accuracy30: 0.6210 - val_accuracy50: 0.5536 - 86s/epoch - 29ms/step
Epoch 10/50
2948/2948 - 83s - loss: 10.1526 - accuracy10: 0.6178 - accuracy20: 0.6119 - accuracy30: 0.5942 - accuracy50: 0.5573 - val_loss: 10.0167 - val_accuracy10: 0.6719 - val_accuracy20: 0.6502 - val_accuracy30: 0.6210 - val_accuracy50: 0.5542 - 83s/epoch - 28ms/step
Epoch 11/50
2948/2948 - 80s - loss: 10.1291 - accuracy10: 0.6189 - accuracy20: 0.6130 - accuracy30: 0.5949 - accuracy50: 0.5583 - val_loss: 10.0023 - val_accuracy10: 0.6790 - val_accuracy20: 0.6552 - val_accuracy30: 0.6241 - val_accuracy50: 0.5539 - 80s/epoch - 27ms/step
Epoch 12/50
2948/2948 - 81s - loss: 10.1080 - accuracy10: 0.6198 - accuracy20: 0.6138 - accuracy30: 0.5959 - accuracy50: 0.5597 - val_loss: 9.9890 - val_accuracy10: 0.6730 - val_accuracy20: 0.6510 - val_accuracy30: 0.6205 - val_accuracy50: 0.5541 - 81s/epoch - 27ms/step
Epoch 13/50
2948/2948 - 82s - loss: 10.0880 - accuracy10: 0.6198 - accuracy20: 0.6145 - accuracy30: 0.5965 - accuracy50: 0.5603 - val_loss: 9.9838 - val_accuracy10: 0.6759 - val_accuracy20: 0.6537 - val_accuracy30: 0.6232 - val_accuracy50: 0.5548 - 82s/epoch - 28ms/step
Epoch 14/50
2948/2948 - 81s - loss: 10.0679 - accuracy10: 0.6200 - accuracy20: 0.6151 - accuracy30: 0.5973 - accuracy50: 0.5609 - val_loss: 9.9861 - val_accuracy10: 0.6726 - val_accuracy20: 0.6508 - val_accuracy30: 0.6212 - val_accuracy50: 0.5552 - 81s/epoch - 27ms/step
Epoch 15/50
2948/2948 - 80s - loss: 10.0507 - accuracy10: 0.6214 - accuracy20: 0.6161 - accuracy30: 0.5981 - accuracy50: 0.5620 - val_loss: 9.9873 - val_accuracy10: 0.6790 - val_accuracy20: 0.6551 - val_accuracy30: 0.6236 - val_accuracy50: 0.5551 - 80s/epoch - 27ms/step
Epoch 16/50
2948/2948 - 81s - loss: 10.0319 - accuracy10: 0.6218 - accuracy20: 0.6164 - accuracy30: 0.5989 - accuracy50: 0.5629 - val_loss: 9.9682 - val_accuracy10: 0.6736 - val_accuracy20: 0.6515 - val_accuracy30: 0.6219 - val_accuracy50: 0.5548 - 81s/epoch - 28ms/step
Epoch 17/50
2948/2948 - 80s - loss: 10.0171 - accuracy10: 0.6218 - accuracy20: 0.6168 - accuracy30: 0.5989 - accuracy50: 0.5633 - val_loss: 9.9959 - val_accuracy10: 0.6770 - val_accuracy20: 0.6535 - val_accuracy30: 0.6213 - val_accuracy50: 0.5544 - 80s/epoch - 27ms/step
Epoch 18/50
2948/2948 - 83s - loss: 9.9981 - accuracy10: 0.6223 - accuracy20: 0.6178 - accuracy30: 0.6002 - accuracy50: 0.5644 - val_loss: 9.9721 - val_accuracy10: 0.6730 - val_accuracy20: 0.6506 - val_accuracy30: 0.6205 - val_accuracy50: 0.5550 - 83s/epoch - 28ms/step
Epoch 19/50
2948/2948 - 80s - loss: 9.9843 - accuracy10: 0.6230 - accuracy20: 0.6181 - accuracy30: 0.6007 - accuracy50: 0.5654 - val_loss: 9.9799 - val_accuracy10: 0.6719 - val_accuracy20: 0.6492 - val_accuracy30: 0.6201 - val_accuracy50: 0.5542 - 80s/epoch - 27ms/step
Epoch 20/50
2948/2948 - 80s - loss: 9.9650 - accuracy10: 0.6236 - accuracy20: 0.6193 - accuracy30: 0.6015 - accuracy50: 0.5661 - val_loss: 10.0529 - val_accuracy10: 0.6762 - val_accuracy20: 0.6510 - val_accuracy30: 0.6197 - val_accuracy50: 0.5536 - 80s/epoch - 27ms/step
Epoch 21/50
2948/2948 - 82s - loss: 9.9510 - accuracy10: 0.6245 - accuracy20: 0.6198 - accuracy30: 0.6023 - accuracy50: 0.5667 - val_loss: 10.0269 - val_accuracy10: 0.6714 - val_accuracy20: 0.6498 - val_accuracy30: 0.6203 - val_accuracy50: 0.5555 - 82s/epoch - 28ms/step
Epoch 22/50
2948/2948 - 81s - loss: 9.9379 - accuracy10: 0.6249 - accuracy20: 0.6201 - accuracy30: 0.6028 - accuracy50: 0.5673 - val_loss: 10.0320 - val_accuracy10: 0.6732 - val_accuracy20: 0.6487 - val_accuracy30: 0.6191 - val_accuracy50: 0.5541 - 81s/epoch - 27ms/step
Epoch 23/50
2948/2948 - 82s - loss: 9.9237 - accuracy10: 0.6244 - accuracy20: 0.6205 - accuracy30: 0.6036 - accuracy50: 0.5684 - val_loss: 10.0439 - val_accuracy10: 0.6772 - val_accuracy20: 0.6517 - val_accuracy30: 0.6201 - val_accuracy50: 0.5540 - 82s/epoch - 28ms/step
Epoch 24/50
2948/2948 - 81s - loss: 9.9103 - accuracy10: 0.6254 - accuracy20: 0.6215 - accuracy30: 0.6042 - accuracy50: 0.5687 - val_loss: 10.0457 - val_accuracy10: 0.6754 - val_accuracy20: 0.6507 - val_accuracy30: 0.6193 - val_accuracy50: 0.5535 - 81s/epoch - 27ms/step
Epoch 25/50
2948/2948 - 81s - loss: 9.8949 - accuracy10: 0.6258 - accuracy20: 0.6216 - accuracy30: 0.6050 - accuracy50: 0.5694 - val_loss: 10.0391 - val_accuracy10: 0.6679 - val_accuracy20: 0.6449 - val_accuracy30: 0.6156 - val_accuracy50: 0.5539 - 81s/epoch - 27ms/step
Epoch 26/50
2948/2948 - 80s - loss: 9.8832 - accuracy10: 0.6258 - accuracy20: 0.6220 - accuracy30: 0.6054 - accuracy50: 0.5701 - val_loss: 10.0380 - val_accuracy10: 0.6662 - val_accuracy20: 0.6422 - val_accuracy30: 0.6132 - val_accuracy50: 0.5515 - 80s/epoch - 27ms/step
testing model: results/ATVI/W1/deepOF_L2/seq2seq
Evaluating performance on  test set...
12066/12066 - 122s - 122s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.735696
{'0': {'precision': 0.42003221158821175, 'recall': 0.5995599018300812, 'f1-score': 0.4939906227814921, 'support': 528064}, '1': {'precision': 0.8335631489393236, 'recall': 0.7188636801598257, 'f1-score': 0.7719761880691699, 'support': 2034216}, '2': {'precision': 0.4713085821139667, 'recall': 0.5198297620200663, 'f1-score': 0.49438149483032506, 'support': 526557}, 'accuracy': 0.6645381417018768, 'macro avg': {'precision': 0.5749679808805007, 'recall': 0.6127511146699911, 'f1-score': 0.586782768560329, 'support': 3088837}, 'weighted avg': {'precision': 0.7011124955557889, 'recall': 0.6645381417018768, 'f1-score': 0.677130264365252, 'support': 3088837}}
[[ 316606  135218   76240]
 [ 341086 1462324  230806]
 [  96074  156763  273720]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.79459083
{'0': {'precision': 0.49466882154737285, 'recall': 0.5322985527250524, 'f1-score': 0.5127942802942925, 'support': 691161}, '1': {'precision': 0.7290768669471956, 'recall': 0.7491093233898812, 'f1-score': 0.7389573547206331, 'support': 1709936}, '2': {'precision': 0.5393586997177735, 'recall': 0.46127897170442317, 'f1-score': 0.49727255627312056, 'support': 687740}, 'accuracy': 0.6365091456752169, 'macro avg': {'precision': 0.5877014627374474, 'recall': 0.5808956159397857, 'f1-score': 0.5830080637626821, 'support': 3088837}, 'weighted avg': {'precision': 0.6343841164404678, 'recall': 0.6365091456752169, 'f1-score': 0.6345389603644802, 'support': 3088837}}
[[ 367904  229665   93592]
 [ 251659 1280929  177348]
 [ 124175  246325  317240]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.85482514
{'0': {'precision': 0.533889506389369, 'recall': 0.46856798082118273, 'f1-score': 0.4991005228293363, 'support': 808809}, '1': {'precision': 0.6364795598334656, 'recall': 0.7726260858971279, 'f1-score': 0.6979756451301267, 'support': 1477465}, '2': {'precision': 0.5681292198065528, 'recall': 0.4144596748168057, 'f1-score': 0.47927806427164515, 'support': 802563}, 'accuracy': 0.5999474883265126, 'macro avg': {'precision': 0.5794994286764625, 'recall': 0.5518845805117054, 'f1-score': 0.558784744077036, 'support': 3088837}, 'weighted avg': {'precision': 0.5918571946911529, 'recall': 0.5999474883265126, 'f1-score': 0.589076866923473, 'support': 3088837}}
[[ 378982  322897  106930]
 [ 190014 1141528  145923]
 [ 140855  329078  332630]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.95472544
{'0': {'precision': 0.5544063488925531, 'recall': 0.38193859779450606, 'f1-score': 0.4522888370436483, 'support': 969216}, '1': {'precision': 0.49521260849614385, 'recall': 0.7934363601492184, 'f1-score': 0.6098164808966099, 'support': 1157498}, '2': {'precision': 0.5874850636548641, 'recall': 0.3459557665703865, 'f1-score': 0.4354723705332787, 'support': 962123}, 'accuracy': 0.5249334943863985, 'macro avg': {'precision': 0.5457013403478537, 'recall': 0.5071102415047036, 'f1-score': 0.49919256282451235, 'support': 3088837}, 'weighted avg': {'precision': 0.5425278186113813, 'recall': 0.5249334943863985, 'f1-score': 0.506082036068446, 'support': 3088837}}
[[370181 472618 126417]
 [131795 918401 107302]
 [165731 463540 332852]]
Evaluating performance on  train set...
2948/2948 - 31s - 31s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.78562015
{'0': {'precision': 0.3947884272428481, 'recall': 0.6281109304652326, 'f1-score': 0.48483934319407024, 'support': 127936}, '1': {'precision': 0.8382376129849387, 'recall': 0.6584701691576481, 'f1-score': 0.7375580850209178, 'support': 500539}, '2': {'precision': 0.43383056821711813, 'recall': 0.5430895599380977, 'f1-score': 0.4823502875831736, 'support': 126005}, 'accuracy': 0.6340525925140494, 'macro avg': {'precision': 0.555618869481635, 'recall': 0.6098902198536594, 'f1-score': 0.5682492385993873, 'support': 754480}, 'weighted avg': {'precision': 0.6955029815791105, 'recall': 0.6340525925140494, 'f1-score': 0.6520829452286071, 'support': 754480}}
[[ 80358  30497  17081]
 [ 98723 329590  72226]
 [ 24466  33107  68432]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8186016
{'0': {'precision': 0.47836147900152626, 'recall': 0.5692223869142125, 'f1-score': 0.5198515779871001, 'support': 170689}, '1': {'precision': 0.7376301136812894, 'recall': 0.6960778886308112, 'f1-score': 0.716251860621206, 'support': 415465}, '2': {'precision': 0.5159972129634861, 'recall': 0.4883559283770778, 'f1-score': 0.5017962061440322, 'support': 168326}, 'accuracy': 0.6210356802035839, 'macro avg': {'precision': 0.5773296018821005, 'recall': 0.5845520679740338, 'f1-score': 0.5792998815841127, 'support': 754480}, 'weighted avg': {'precision': 0.6295279988060388, 'recall': 0.6210356802035839, 'f1-score': 0.6239739601625356, 'support': 754480}}
[[ 97160  50318  23211]
 [ 72374 289196  53895]
 [ 33576  52547  82203]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.862027
{'0': {'precision': 0.5205668645242532, 'recall': 0.5141395652064893, 'f1-score': 0.5173332525962033, 'support': 199405}, '1': {'precision': 0.6491348406865199, 'recall': 0.7247071054867414, 'f1-score': 0.684842434422506, 'support': 357808}, '2': {'precision': 0.5511440916538561, 'recall': 0.44164001074685577, 'f1-score': 0.4903529014465019, 'support': 197267}, 'accuracy': 0.5950442689004347, 'macro avg': {'precision': 0.5736152656215431, 'recall': 0.5601622271466956, 'f1-score': 0.5641761961550705, 'support': 754480}, 'weighted avg': {'precision': 0.5895342702591219, 'recall': 0.5950442689004347, 'f1-score': 0.5897192567323734, 'support': 754480}}
[[102522  69127  27756]
 [ 55306 259306  43196]
 [ 39115  71031  87121]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.94125366
{'0': {'precision': 0.5512478901049905, 'recall': 0.43707940355794606, 'f1-score': 0.48756945308410427, 'support': 237609}, '1': {'precision': 0.5122524564103431, 'recall': 0.7564800114169506, 'f1-score': 0.6108596633256602, 'support': 280285}, '2': {'precision': 0.5724049551473729, 'recall': 0.36815365237165343, 'f1-score': 0.44810174121738594, 'support': 236586}, 'accuracy': 0.5341215141554448, 'macro avg': {'precision': 0.5453017672209022, 'recall': 0.5205710224488501, 'f1-score': 0.5155102858757168, 'support': 754480}, 'weighted avg': {'precision': 0.5433956345872999, 'recall': 0.5341215141554448, 'f1-score': 0.5209949759579446, 'support': 754480}}
[[103854  99338  34417]
 [ 37607 212030  30648]
 [ 46937 102549  87100]]
Evaluating performance on  val set...
697/697 - 7s - 7s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7202849
{'0': {'precision': 0.3831848608384921, 'recall': 0.5938304344434912, 'f1-score': 0.4657999388192108, 'support': 25642}, '1': {'precision': 0.8572138230966061, 'recall': 0.7165735597151163, 'f1-score': 0.7806095885149495, 'support': 127631}, '2': {'precision': 0.42253917612836633, 'recall': 0.5376288454650376, 'f1-score': 0.473186451364321, 'support': 25127}, 'accuracy': 0.6737275784753364, 'macro avg': {'precision': 0.5543126200211549, 'recall': 0.616010946541215, 'f1-score': 0.5731986595661605, 'support': 178400}, 'weighted avg': {'precision': 0.7278577664565079, 'recall': 0.6737275784753364, 'f1-score': 0.6920615492510371, 'support': 178400}}
[[15227  7294  3121]
 [20833 91457 15341]
 [ 3678  7940 13509]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7720885
{'0': {'precision': 0.4628358400822728, 'recall': 0.522281536497621, 'f1-score': 0.49076509957335446, 'support': 34468}, '1': {'precision': 0.765537670467248, 'recall': 0.7461323358512493, 'f1-score': 0.7557104498473535, 'support': 110144}, '2': {'precision': 0.4961278885329518, 'recall': 0.47212027938913226, 'f1-score': 0.4838264509182451, 'support': 33788}, 'accuracy': 0.6509865470852018, 'macro avg': {'precision': 0.5748337996941576, 'recall': 0.5801780505793341, 'f1-score': 0.5767673334463176, 'support': 178400}, 'weighted avg': {'precision': 0.6560290135070164, 'recall': 0.6509865470852018, 'f1-score': 0.6530279784961152, 'support': 178400}}
[[18002 12302  4164]
 [15925 82182 12037]
 [ 4968 12868 15952]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.82754004
{'0': {'precision': 0.5087986509641799, 'recall': 0.45718265799892466, 'f1-score': 0.48161163673810903, 'support': 40918}, '1': {'precision': 0.6841722894739232, 'recall': 0.7730327624949979, 'f1-score': 0.7258931668400971, 'support': 97459}, '2': {'precision': 0.5302068790455642, 'recall': 0.4175099317892212, 'f1-score': 0.4671577740812704, 'support': 40023}, 'accuracy': 0.6208295964125561, 'macro avg': {'precision': 0.5743926064945558, 'recall': 0.5492417840943813, 'f1-score': 0.5582208592198256, 'support': 178400}, 'weighted avg': {'precision': 0.6094071764575786, 'recall': 0.6208295964125561, 'f1-score': 0.6118187370581483, 'support': 178400}}
[[18707 17321  4890]
 [12204 75339  9916]
 [ 5856 17457 16710]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9175034
{'0': {'precision': 0.542485944827988, 'recall': 0.3717610891523935, 'f1-score': 0.441183089916255, 'support': 50094}, '1': {'precision': 0.5576492798210041, 'recall': 0.801769310999133, 'f1-score': 0.6577901492306503, 'support': 79579}, '2': {'precision': 0.5609509357612544, 'recall': 0.3413918361483366, 'f1-score': 0.4244596973795004, 'support': 48727}, 'accuracy': 0.555280269058296, 'macro avg': {'precision': 0.5536953868034155, 'recall': 0.504974078766621, 'f1-score': 0.5078109788421353, 'support': 178400}, 'weighted avg': {'precision': 0.5542932690915221, 'recall': 0.555280269058296, 'f1-score': 0.5332374196530365, 'support': 178400}}
[[18623 25557  5914]
 [ 8669 63804  7106]
 [ 7037 25055 16635]]
training model: results/ATVI/W1/deepVOL_L2/seq2seq
Epoch 1/50
2948/2948 - 83s - loss: 11.2377 - accuracy10: 0.5477 - accuracy20: 0.5536 - accuracy30: 0.5441 - accuracy50: 0.5165 - val_loss: 10.9151 - val_accuracy10: 0.6946 - val_accuracy20: 0.6559 - val_accuracy30: 0.6119 - val_accuracy50: 0.5329 - 83s/epoch - 28ms/step
Epoch 2/50
2948/2948 - 79s - loss: 10.8155 - accuracy10: 0.5818 - accuracy20: 0.5797 - accuracy30: 0.5656 - accuracy50: 0.5325 - val_loss: 10.4886 - val_accuracy10: 0.6775 - val_accuracy20: 0.6501 - val_accuracy30: 0.6152 - val_accuracy50: 0.5447 - 79s/epoch - 27ms/step
Epoch 3/50
2948/2948 - 80s - loss: 10.6148 - accuracy10: 0.5968 - accuracy20: 0.5923 - accuracy30: 0.5751 - accuracy50: 0.5401 - val_loss: 10.3404 - val_accuracy10: 0.6786 - val_accuracy20: 0.6536 - val_accuracy30: 0.6194 - val_accuracy50: 0.5500 - 80s/epoch - 27ms/step
Epoch 4/50
2948/2948 - 80s - loss: 10.4965 - accuracy10: 0.6032 - accuracy20: 0.5984 - accuracy30: 0.5807 - accuracy50: 0.5448 - val_loss: 10.3250 - val_accuracy10: 0.6839 - val_accuracy20: 0.6575 - val_accuracy30: 0.6213 - val_accuracy50: 0.5480 - 80s/epoch - 27ms/step
Epoch 5/50
2948/2948 - 79s - loss: 10.4230 - accuracy10: 0.6069 - accuracy20: 0.6027 - accuracy30: 0.5847 - accuracy50: 0.5478 - val_loss: 10.2557 - val_accuracy10: 0.6787 - val_accuracy20: 0.6553 - val_accuracy30: 0.6213 - val_accuracy50: 0.5498 - 79s/epoch - 27ms/step
Epoch 6/50
2948/2948 - 77s - loss: 10.3677 - accuracy10: 0.6103 - accuracy20: 0.6058 - accuracy30: 0.5870 - accuracy50: 0.5496 - val_loss: 10.2840 - val_accuracy10: 0.6839 - val_accuracy20: 0.6588 - val_accuracy30: 0.6239 - val_accuracy50: 0.5498 - 77s/epoch - 26ms/step
Epoch 7/50
2948/2948 - 79s - loss: 10.3224 - accuracy10: 0.6124 - accuracy20: 0.6076 - accuracy30: 0.5888 - accuracy50: 0.5509 - val_loss: 10.2885 - val_accuracy10: 0.6875 - val_accuracy20: 0.6599 - val_accuracy30: 0.6238 - val_accuracy50: 0.5487 - 79s/epoch - 27ms/step
Epoch 8/50
2948/2948 - 78s - loss: 10.2821 - accuracy10: 0.6144 - accuracy20: 0.6094 - accuracy30: 0.5903 - accuracy50: 0.5524 - val_loss: 10.2548 - val_accuracy10: 0.6883 - val_accuracy20: 0.6612 - val_accuracy30: 0.6251 - val_accuracy50: 0.5495 - 78s/epoch - 26ms/step
Epoch 9/50
2948/2948 - 80s - loss: 10.2474 - accuracy10: 0.6161 - accuracy20: 0.6108 - accuracy30: 0.5916 - accuracy50: 0.5538 - val_loss: 10.2032 - val_accuracy10: 0.6823 - val_accuracy20: 0.6587 - val_accuracy30: 0.6241 - val_accuracy50: 0.5512 - 80s/epoch - 27ms/step
Epoch 10/50
2948/2948 - 78s - loss: 10.2168 - accuracy10: 0.6175 - accuracy20: 0.6120 - accuracy30: 0.5932 - accuracy50: 0.5551 - val_loss: 10.2209 - val_accuracy10: 0.6909 - val_accuracy20: 0.6630 - val_accuracy30: 0.6262 - val_accuracy50: 0.5497 - 78s/epoch - 26ms/step
Epoch 11/50
2948/2948 - 79s - loss: 10.1906 - accuracy10: 0.6186 - accuracy20: 0.6129 - accuracy30: 0.5939 - accuracy50: 0.5559 - val_loss: 10.2227 - val_accuracy10: 0.6752 - val_accuracy20: 0.6524 - val_accuracy30: 0.6204 - val_accuracy50: 0.5481 - 79s/epoch - 27ms/step
Epoch 12/50
2948/2948 - 79s - loss: 10.1669 - accuracy10: 0.6198 - accuracy20: 0.6139 - accuracy30: 0.5949 - accuracy50: 0.5570 - val_loss: 10.2067 - val_accuracy10: 0.6893 - val_accuracy20: 0.6629 - val_accuracy30: 0.6267 - val_accuracy50: 0.5499 - 79s/epoch - 27ms/step
Epoch 13/50
2948/2948 - 78s - loss: 10.1453 - accuracy10: 0.6207 - accuracy20: 0.6150 - accuracy30: 0.5960 - accuracy50: 0.5582 - val_loss: 10.1620 - val_accuracy10: 0.6919 - val_accuracy20: 0.6633 - val_accuracy30: 0.6268 - val_accuracy50: 0.5510 - 78s/epoch - 26ms/step
Epoch 14/50
2948/2948 - 78s - loss: 10.1259 - accuracy10: 0.6216 - accuracy20: 0.6158 - accuracy30: 0.5966 - accuracy50: 0.5588 - val_loss: 10.1373 - val_accuracy10: 0.6926 - val_accuracy20: 0.6648 - val_accuracy30: 0.6284 - val_accuracy50: 0.5521 - 78s/epoch - 26ms/step
Epoch 15/50
2948/2948 - 77s - loss: 10.1099 - accuracy10: 0.6218 - accuracy20: 0.6163 - accuracy30: 0.5974 - accuracy50: 0.5597 - val_loss: 10.1343 - val_accuracy10: 0.6919 - val_accuracy20: 0.6643 - val_accuracy30: 0.6283 - val_accuracy50: 0.5515 - 77s/epoch - 26ms/step
Epoch 16/50
2948/2948 - 78s - loss: 10.0908 - accuracy10: 0.6229 - accuracy20: 0.6167 - accuracy30: 0.5979 - accuracy50: 0.5602 - val_loss: 10.1353 - val_accuracy10: 0.6954 - val_accuracy20: 0.6664 - val_accuracy30: 0.6290 - val_accuracy50: 0.5517 - 78s/epoch - 26ms/step
Epoch 17/50
2948/2948 - 80s - loss: 10.0748 - accuracy10: 0.6231 - accuracy20: 0.6174 - accuracy30: 0.5989 - accuracy50: 0.5617 - val_loss: 10.0850 - val_accuracy10: 0.6908 - val_accuracy20: 0.6648 - val_accuracy30: 0.6293 - val_accuracy50: 0.5533 - 80s/epoch - 27ms/step
Epoch 18/50
2948/2948 - 80s - loss: 10.0601 - accuracy10: 0.6242 - accuracy20: 0.6181 - accuracy30: 0.5996 - accuracy50: 0.5618 - val_loss: 10.1293 - val_accuracy10: 0.6972 - val_accuracy20: 0.6673 - val_accuracy30: 0.6302 - val_accuracy50: 0.5519 - 80s/epoch - 27ms/step
Epoch 19/50
2948/2948 - 78s - loss: 10.0460 - accuracy10: 0.6238 - accuracy20: 0.6183 - accuracy30: 0.6000 - accuracy50: 0.5621 - val_loss: 10.0723 - val_accuracy10: 0.6957 - val_accuracy20: 0.6670 - val_accuracy30: 0.6312 - val_accuracy50: 0.5539 - 78s/epoch - 27ms/step
Epoch 20/50
2948/2948 - 77s - loss: 10.0287 - accuracy10: 0.6245 - accuracy20: 0.6188 - accuracy30: 0.6002 - accuracy50: 0.5630 - val_loss: 10.0960 - val_accuracy10: 0.6938 - val_accuracy20: 0.6651 - val_accuracy30: 0.6294 - val_accuracy50: 0.5534 - 77s/epoch - 26ms/step
Epoch 21/50
2948/2948 - 78s - loss: 10.0173 - accuracy10: 0.6250 - accuracy20: 0.6197 - accuracy30: 0.6013 - accuracy50: 0.5638 - val_loss: 10.0489 - val_accuracy10: 0.6825 - val_accuracy20: 0.6586 - val_accuracy30: 0.6267 - val_accuracy50: 0.5542 - 78s/epoch - 26ms/step
Epoch 22/50
2948/2948 - 78s - loss: 10.0050 - accuracy10: 0.6255 - accuracy20: 0.6204 - accuracy30: 0.6016 - accuracy50: 0.5639 - val_loss: 10.0599 - val_accuracy10: 0.6863 - val_accuracy20: 0.6624 - val_accuracy30: 0.6278 - val_accuracy50: 0.5547 - 78s/epoch - 27ms/step
Epoch 23/50
2948/2948 - 79s - loss: 9.9889 - accuracy10: 0.6262 - accuracy20: 0.6206 - accuracy30: 0.6023 - accuracy50: 0.5650 - val_loss: 10.0572 - val_accuracy10: 0.6908 - val_accuracy20: 0.6643 - val_accuracy30: 0.6295 - val_accuracy50: 0.5552 - 79s/epoch - 27ms/step
Epoch 24/50
2948/2948 - 81s - loss: 9.9778 - accuracy10: 0.6262 - accuracy20: 0.6213 - accuracy30: 0.6027 - accuracy50: 0.5655 - val_loss: 10.0429 - val_accuracy10: 0.6859 - val_accuracy20: 0.6622 - val_accuracy30: 0.6297 - val_accuracy50: 0.5573 - 81s/epoch - 28ms/step
Epoch 25/50
2948/2948 - 79s - loss: 9.9694 - accuracy10: 0.6261 - accuracy20: 0.6210 - accuracy30: 0.6030 - accuracy50: 0.5658 - val_loss: 10.0483 - val_accuracy10: 0.6878 - val_accuracy20: 0.6628 - val_accuracy30: 0.6296 - val_accuracy50: 0.5569 - 79s/epoch - 27ms/step
Epoch 26/50
2948/2948 - 80s - loss: 9.9552 - accuracy10: 0.6267 - accuracy20: 0.6215 - accuracy30: 0.6034 - accuracy50: 0.5668 - val_loss: 10.0486 - val_accuracy10: 0.6803 - val_accuracy20: 0.6585 - val_accuracy30: 0.6269 - val_accuracy50: 0.5569 - 80s/epoch - 27ms/step
Epoch 27/50
2948/2948 - 79s - loss: 9.9461 - accuracy10: 0.6268 - accuracy20: 0.6220 - accuracy30: 0.6040 - accuracy50: 0.5672 - val_loss: 10.0548 - val_accuracy10: 0.6814 - val_accuracy20: 0.6579 - val_accuracy30: 0.6263 - val_accuracy50: 0.5569 - 79s/epoch - 27ms/step
Epoch 28/50
2948/2948 - 78s - loss: 9.9360 - accuracy10: 0.6274 - accuracy20: 0.6221 - accuracy30: 0.6045 - accuracy50: 0.5675 - val_loss: 10.0853 - val_accuracy10: 0.6780 - val_accuracy20: 0.6570 - val_accuracy30: 0.6248 - val_accuracy50: 0.5554 - 78s/epoch - 27ms/step
Epoch 29/50
2948/2948 - 77s - loss: 9.9212 - accuracy10: 0.6279 - accuracy20: 0.6226 - accuracy30: 0.6046 - accuracy50: 0.5682 - val_loss: 10.0440 - val_accuracy10: 0.6770 - val_accuracy20: 0.6552 - val_accuracy30: 0.6237 - val_accuracy50: 0.5549 - 77s/epoch - 26ms/step
Epoch 30/50
2948/2948 - 81s - loss: 9.9111 - accuracy10: 0.6278 - accuracy20: 0.6232 - accuracy30: 0.6053 - accuracy50: 0.5687 - val_loss: 10.0873 - val_accuracy10: 0.6836 - val_accuracy20: 0.6611 - val_accuracy30: 0.6280 - val_accuracy50: 0.5563 - 81s/epoch - 28ms/step
Epoch 31/50
2948/2948 - 80s - loss: 9.9004 - accuracy10: 0.6281 - accuracy20: 0.6234 - accuracy30: 0.6057 - accuracy50: 0.5694 - val_loss: 10.0874 - val_accuracy10: 0.6845 - val_accuracy20: 0.6605 - val_accuracy30: 0.6264 - val_accuracy50: 0.5557 - 80s/epoch - 27ms/step
Epoch 32/50
2948/2948 - 81s - loss: 9.8911 - accuracy10: 0.6286 - accuracy20: 0.6239 - accuracy30: 0.6059 - accuracy50: 0.5692 - val_loss: 10.0974 - val_accuracy10: 0.6861 - val_accuracy20: 0.6625 - val_accuracy30: 0.6280 - val_accuracy50: 0.5564 - 81s/epoch - 27ms/step
Epoch 33/50
2948/2948 - 80s - loss: 9.8802 - accuracy10: 0.6285 - accuracy20: 0.6242 - accuracy30: 0.6066 - accuracy50: 0.5701 - val_loss: 10.1410 - val_accuracy10: 0.6800 - val_accuracy20: 0.6571 - val_accuracy30: 0.6251 - val_accuracy50: 0.5550 - 80s/epoch - 27ms/step
Epoch 34/50
2948/2948 - 82s - loss: 9.8702 - accuracy10: 0.6291 - accuracy20: 0.6243 - accuracy30: 0.6066 - accuracy50: 0.5705 - val_loss: 10.0755 - val_accuracy10: 0.6717 - val_accuracy20: 0.6534 - val_accuracy30: 0.6235 - val_accuracy50: 0.5561 - 82s/epoch - 28ms/step
testing model: results/ATVI/W1/deepVOL_L2/seq2seq
Evaluating performance on  test set...
12066/12066 - 114s - 114s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7193947
{'0': {'precision': 0.45372581828719394, 'recall': 0.5515002887902057, 'f1-score': 0.4978579805183926, 'support': 528065}, '1': {'precision': 0.8325392382931844, 'recall': 0.7340853999352085, 'f1-score': 0.7802186749664892, 'support': 2034217}, '2': {'precision': 0.4606452817654865, 'recall': 0.5715436037678517, 'f1-score': 0.5101369876945843, 'support': 526560}, 'accuracy': 0.6751620833956544, 'macro avg': {'precision': 0.5823034461152883, 'recall': 0.6190430974977553, 'f1-score': 0.5960712143931554, 'support': 3088842}, 'weighted avg': {'precision': 0.7043803391378738, 'recall': 0.6751620833956544, 'f1-score': 0.6859053325023462, 'support': 3088842}}
[[ 291228  144964   91873]
 [ 280426 1493289  260502]
 [  70205  155403  300952]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7916276
{'0': {'precision': 0.5276084440279998, 'recall': 0.48473948981643983, 'f1-score': 0.5052663011021228, 'support': 691163}, '1': {'precision': 0.7235610413045498, 'recall': 0.7653983743260717, 'f1-score': 0.7438919273775167, 'support': 1709937}, '2': {'precision': 0.5303125905967019, 'recall': 0.4973769233229903, 'f1-score': 0.5133169914411404, 'support': 687742}, 'accuracy': 0.6429218457920476, 'macro avg': {'precision': 0.5938273586430839, 'recall': 0.5825049291551673, 'f1-score': 0.5874917399735934, 'support': 3088842}, 'weighted avg': {'precision': 0.6366869762089027, 'recall': 0.6429218457920476, 'f1-score': 0.639158415166748, 'support': 3088842}}
[[ 335034  245755  110374]
 [ 208566 1308783  192588]
 [  91405  254270  342067]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8604981
{'0': {'precision': 0.5658544605461134, 'recall': 0.42126899856703237, 'f1-score': 0.4829729042061523, 'support': 808811}, '1': {'precision': 0.6275973966901018, 'recall': 0.7937853011746471, 'f1-score': 0.7009760134219402, 'support': 1477465}, '2': {'precision': 0.564814125612057, 'recall': 0.43492248612575163, 'f1-score': 0.4914301643572553, 'support': 802566}, 'accuracy': 0.6029997649604609, 'macro avg': {'precision': 0.5860886609494241, 'recall': 0.5499922619558103, 'f1-score': 0.558459693995116, 'support': 3088842}, 'weighted avg': {'precision': 0.5951172359497411, 'recall': 0.6029997649604609, 'f1-score': 0.5894462923587137, 'support': 3088842}}
[[ 340727  346847  121237]
 [ 156968 1172790  147707]
 [ 104451  349061  349054]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9754245
{'0': {'precision': 0.5827494001180806, 'recall': 0.3330121118387317, 'f1-score': 0.42382783262292884, 'support': 969217}, '1': {'precision': 0.48422130037579036, 'recall': 0.81865556687306, 'f1-score': 0.6085156212623709, 'support': 1157499}, '2': {'precision': 0.5866002584591751, 'recall': 0.3524268131201111, 'f1-score': 0.44031458926207356, 'support': 962126}, 'accuracy': 0.5210473698557583, 'macro avg': {'precision': 0.5511903196510154, 'recall': 0.5013648306106343, 'f1-score': 0.49088601438245777, 'support': 3088842}, 'weighted avg': {'precision': 0.5470268976426166, 'recall': 0.5210473698557583, 'f1-score': 0.49817228529501734, 'support': 3088842}}
[[322761 509413 137043]
 [107987 947593 101919]
 [123111 499936 339079]]
Evaluating performance on  train set...
2948/2948 - 29s - 29s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7625659
{'0': {'precision': 0.4247951286137036, 'recall': 0.5843876240879341, 'f1-score': 0.49197237124817106, 'support': 127732}, '1': {'precision': 0.8349417144078873, 'recall': 0.6863489933153986, 'f1-score': 0.7533884250414065, 'support': 500703}, '2': {'precision': 0.4328699272588055, 'recall': 0.5740874435726356, 'f1-score': 0.4935763859284143, 'support': 126047}, 'accuracy': 0.6503322809556755, 'macro avg': {'precision': 0.5642022567601321, 'recall': 0.6149413536586561, 'f1-score': 0.5796457274059973, 'support': 754482}, 'weighted avg': {'precision': 0.6983330395137971, 'recall': 0.6503322809556755, 'f1-score': 0.6657259977373848, 'support': 754482}}
[[ 74645  33500  19587]
 [ 81827 343657  75219]
 [ 19248  34437  72362]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.80960447
{'0': {'precision': 0.5116005670619965, 'recall': 0.5208330888823702, 'f1-score': 0.5161755471311953, 'support': 170450}, '1': {'precision': 0.7283844766426741, 'recall': 0.7296479317130911, 'f1-score': 0.729015656755649, 'support': 415658}, '2': {'precision': 0.5178730928380029, 'recall': 0.5061945431004787, 'f1-score': 0.5119672264086907, 'support': 168374}, 'accuracy': 0.6326062119440888, 'macro avg': {'precision': 0.5859527121808912, 'recall': 0.58555852123198, 'f1-score': 0.5857194767651784, 'support': 754482}, 'weighted avg': {'precision': 0.6324306154176824, 'recall': 0.6326062119440888, 'f1-score': 0.632493925161354, 'support': 754482}}
[[ 88776  56269  25405]
 [ 58432 303284  53942]
 [ 26318  56826  85230]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.862714
{'0': {'precision': 0.5522380886584685, 'recall': 0.46132266741609124, 'f1-score': 0.5027028652832882, 'support': 199264}, '1': {'precision': 0.6353663162647167, 'recall': 0.7628184172806598, 'f1-score': 0.6932833925850685, 'support': 357903}, '2': {'precision': 0.5573058120586638, 'recall': 0.44718343765045737, 'f1-score': 0.4962082549537315, 'support': 197315}, 'accuracy': 0.6006452108864094, 'macro avg': {'precision': 0.5816367389939496, 'recall': 0.5571081741157361, 'f1-score': 0.5640648376073628, 'support': 754482}, 'weighted avg': {'precision': 0.5929968872615744, 'recall': 0.6006452108864094, 'f1-score': 0.5914098966315677, 'support': 754482}}
[[ 91925  78255  29084]
 [ 43882 273015  41006]
 [ 30652  78427  88236]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9617618
{'0': {'precision': 0.5783868301154095, 'recall': 0.38014993892936866, 'f1-score': 0.45876950211317896, 'support': 237430}, '1': {'precision': 0.4957413407261432, 'recall': 0.7938143594717175, 'f1-score': 0.6103289602640566, 'support': 280456}, '2': {'precision': 0.5800366938075852, 'recall': 0.3661304502189386, 'f1-score': 0.44890397471109494, 'support': 236596}, 'accuracy': 0.5295209163373016, 'macro avg': {'precision': 0.5513882882163793, 'recall': 0.513364916206675, 'f1-score': 0.5060008123627768, 'support': 754482}, 'weighted avg': {'precision': 0.548183230530473, 'recall': 0.5295209163373016, 'f1-score': 0.5120134695954238, 'support': 754482}}
[[ 90259 112951  34220]
 [ 29327 222630  28499]
 [ 36467 113504  86625]]
Evaluating performance on  val set...
697/697 - 7s - 7s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7002349
{'0': {'precision': 0.41679712413753117, 'recall': 0.5594163424124514, 'f1-score': 0.4776888061933083, 'support': 25700}, '1': {'precision': 0.8592868645042558, 'recall': 0.7322778457388414, 'f1-score': 0.7907146092913179, 'support': 127524}, '2': {'precision': 0.41358462717493116, 'recall': 0.578765490943756, 'f1-score': 0.4824275332329035, 'support': 25176}, 'accuracy': 0.6857118834080718, 'macro avg': {'precision': 0.5632228719389061, 'recall': 0.6234865596983497, 'f1-score': 0.5836103162391766, 'support': 178400}, 'weighted avg': {'precision': 0.7326445671139649, 'recall': 0.6857118834080718, 'f1-score': 0.7021148415420718, 'support': 178400}}
[[14377  7690  3633]
 [17114 93383 17027]
 [ 3003  7602 14571]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7587492
{'0': {'precision': 0.5002672843905915, 'recall': 0.48732858878666896, 'f1-score': 0.4937131803394003, 'support': 34566}, '1': {'precision': 0.7657177611154482, 'recall': 0.7665179423337302, 'f1-score': 0.766117642784809, 'support': 110047}, '2': {'precision': 0.4896430017936701, 'recall': 0.5009323112439695, 'f1-score': 0.495223325969599, 'support': 33787}, 'accuracy': 0.6621244394618834, 'macro avg': {'precision': 0.5852093490999033, 'recall': 0.5849262807881228, 'f1-score': 0.5850180496979361, 'support': 178400}, 'weighted avg': {'precision': 0.661999716991702, 'recall': 0.6621244394618834, 'f1-score': 0.6620333438435339, 'support': 178400}}
[[16845 13069  4652]
 [12705 84353 12989]
 [ 4122 12740 16925]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.81863284
{'0': {'precision': 0.5440943885620295, 'recall': 0.41937292763799494, 'f1-score': 0.473661021616412, 'support': 41016}, '1': {'precision': 0.6814832359597873, 'recall': 0.7977674628766251, 'f1-score': 0.7350547849289404, 'support': 97378}, '2': {'precision': 0.5290009758477677, 'recall': 0.4336099585062241, 'f1-score': 0.47657902689634335, 'support': 40006}, 'accuracy': 0.6291087443946188, 'macro avg': {'precision': 0.5848595334565282, 'recall': 0.5502501163402814, 'f1-score': 0.5617649444805654, 'support': 178400}, 'weighted avg': {'precision': 0.6157021470421422, 'recall': 0.6291087443946188, 'f1-score': 0.6169947637861223, 'support': 178400}}
[[17201 18508  5307]
 [ 9555 77685 10138]
 [ 4858 17801 17347]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9231154
{'0': {'precision': 0.5687338054931768, 'recall': 0.3282486889593428, 'f1-score': 0.4162536664306665, 'support': 50151}, '1': {'precision': 0.5528527720808257, 'recall': 0.8273563189474081, 'f1-score': 0.662807160743887, 'support': 79499}, '2': {'precision': 0.5603451103893974, 'recall': 0.3503794871794872, 'f1-score': 0.4311587343657315, 'support': 48750}, 'accuracy': 0.5567096412556054, 'macro avg': {'precision': 0.5606438959878001, 'recall': 0.5019948316954127, 'f1-score': 0.5034065205134283, 'support': 178400}, 'weighted avg': {'precision': 0.5593645501032791, 'recall': 0.5567096412556054, 'f1-score': 0.5301963699409867, 'support': 178400}}
[[16462 27417  6272]
 [ 6595 65774  7130]
 [ 5888 25781 17081]]
training model: results/ATVI/W1/deepVOL_L3/seq2seq
Epoch 1/50
2948/2948 - 125s - loss: 11.5446 - accuracy10: 0.5003 - accuracy20: 0.5143 - accuracy30: 0.5149 - accuracy50: 0.5002 - val_loss: 10.8550 - val_accuracy10: 0.6708 - val_accuracy20: 0.6405 - val_accuracy30: 0.6032 - val_accuracy50: 0.5305 - 125s/epoch - 43ms/step
Epoch 2/50
2948/2948 - 119s - loss: 10.8684 - accuracy10: 0.5754 - accuracy20: 0.5729 - accuracy30: 0.5601 - accuracy50: 0.5288 - val_loss: 10.5377 - val_accuracy10: 0.6952 - val_accuracy20: 0.6612 - val_accuracy30: 0.6194 - val_accuracy50: 0.5388 - 119s/epoch - 40ms/step
Epoch 3/50
2948/2948 - 118s - loss: 10.6417 - accuracy10: 0.5933 - accuracy20: 0.5866 - accuracy30: 0.5708 - accuracy50: 0.5374 - val_loss: 10.3721 - val_accuracy10: 0.6799 - val_accuracy20: 0.6534 - val_accuracy30: 0.6190 - val_accuracy50: 0.5474 - 118s/epoch - 40ms/step
Epoch 4/50
2948/2948 - 119s - loss: 10.4745 - accuracy10: 0.6025 - accuracy20: 0.5953 - accuracy30: 0.5784 - accuracy50: 0.5436 - val_loss: 10.3257 - val_accuracy10: 0.6940 - val_accuracy20: 0.6640 - val_accuracy30: 0.6238 - val_accuracy50: 0.5454 - 119s/epoch - 40ms/step
Epoch 5/50
2948/2948 - 118s - loss: 10.3740 - accuracy10: 0.6067 - accuracy20: 0.6012 - accuracy30: 0.5838 - accuracy50: 0.5477 - val_loss: 10.2705 - val_accuracy10: 0.6963 - val_accuracy20: 0.6662 - val_accuracy30: 0.6261 - val_accuracy50: 0.5473 - 118s/epoch - 40ms/step
Epoch 6/50
2948/2948 - 119s - loss: 10.3065 - accuracy10: 0.6101 - accuracy20: 0.6054 - accuracy30: 0.5871 - accuracy50: 0.5501 - val_loss: 10.3053 - val_accuracy10: 0.6959 - val_accuracy20: 0.6653 - val_accuracy30: 0.6251 - val_accuracy50: 0.5453 - 119s/epoch - 40ms/step
Epoch 7/50
2948/2948 - 119s - loss: 10.2642 - accuracy10: 0.6128 - accuracy20: 0.6081 - accuracy30: 0.5890 - accuracy50: 0.5519 - val_loss: 10.1759 - val_accuracy10: 0.6909 - val_accuracy20: 0.6638 - val_accuracy30: 0.6272 - val_accuracy50: 0.5510 - 119s/epoch - 40ms/step
Epoch 8/50
2948/2948 - 119s - loss: 10.2242 - accuracy10: 0.6151 - accuracy20: 0.6103 - accuracy30: 0.5910 - accuracy50: 0.5529 - val_loss: 10.2808 - val_accuracy10: 0.7019 - val_accuracy20: 0.6685 - val_accuracy30: 0.6276 - val_accuracy50: 0.5473 - 119s/epoch - 40ms/step
Epoch 9/50
2948/2948 - 118s - loss: 10.1961 - accuracy10: 0.6164 - accuracy20: 0.6112 - accuracy30: 0.5924 - accuracy50: 0.5542 - val_loss: 10.2737 - val_accuracy10: 0.6955 - val_accuracy20: 0.6628 - val_accuracy30: 0.6252 - val_accuracy50: 0.5485 - 118s/epoch - 40ms/step
Epoch 10/50
2948/2948 - 120s - loss: 10.1661 - accuracy10: 0.6182 - accuracy20: 0.6128 - accuracy30: 0.5938 - accuracy50: 0.5554 - val_loss: 10.2628 - val_accuracy10: 0.6999 - val_accuracy20: 0.6667 - val_accuracy30: 0.6284 - val_accuracy50: 0.5499 - 120s/epoch - 41ms/step
Epoch 11/50
2948/2948 - 117s - loss: 10.1368 - accuracy10: 0.6199 - accuracy20: 0.6142 - accuracy30: 0.5954 - accuracy50: 0.5568 - val_loss: 10.1896 - val_accuracy10: 0.6904 - val_accuracy20: 0.6609 - val_accuracy30: 0.6256 - val_accuracy50: 0.5507 - 117s/epoch - 40ms/step
Epoch 12/50
2948/2948 - 118s - loss: 10.1219 - accuracy10: 0.6210 - accuracy20: 0.6146 - accuracy30: 0.5960 - accuracy50: 0.5578 - val_loss: 10.1697 - val_accuracy10: 0.6988 - val_accuracy20: 0.6650 - val_accuracy30: 0.6266 - val_accuracy50: 0.5497 - 118s/epoch - 40ms/step
Epoch 13/50
2948/2948 - 118s - loss: 10.0995 - accuracy10: 0.6219 - accuracy20: 0.6156 - accuracy30: 0.5973 - accuracy50: 0.5590 - val_loss: 10.0902 - val_accuracy10: 0.6891 - val_accuracy20: 0.6605 - val_accuracy30: 0.6266 - val_accuracy50: 0.5526 - 118s/epoch - 40ms/step
Epoch 14/50
2948/2948 - 117s - loss: 10.0776 - accuracy10: 0.6232 - accuracy20: 0.6167 - accuracy30: 0.5982 - accuracy50: 0.5596 - val_loss: 10.0433 - val_accuracy10: 0.6859 - val_accuracy20: 0.6591 - val_accuracy30: 0.6267 - val_accuracy50: 0.5556 - 117s/epoch - 40ms/step
Epoch 15/50
2948/2948 - 118s - loss: 10.0616 - accuracy10: 0.6246 - accuracy20: 0.6177 - accuracy30: 0.5988 - accuracy50: 0.5606 - val_loss: 10.1521 - val_accuracy10: 0.6900 - val_accuracy20: 0.6611 - val_accuracy30: 0.6261 - val_accuracy50: 0.5521 - 118s/epoch - 40ms/step
Epoch 16/50
2948/2948 - 120s - loss: 10.0431 - accuracy10: 0.6247 - accuracy20: 0.6183 - accuracy30: 0.5997 - accuracy50: 0.5612 - val_loss: 10.1062 - val_accuracy10: 0.6945 - val_accuracy20: 0.6641 - val_accuracy30: 0.6286 - val_accuracy50: 0.5532 - 120s/epoch - 41ms/step
Epoch 17/50
2948/2948 - 120s - loss: 10.0276 - accuracy10: 0.6252 - accuracy20: 0.6191 - accuracy30: 0.6005 - accuracy50: 0.5617 - val_loss: 10.0720 - val_accuracy10: 0.6837 - val_accuracy20: 0.6579 - val_accuracy30: 0.6251 - val_accuracy50: 0.5549 - 120s/epoch - 41ms/step
Epoch 18/50
2948/2948 - 118s - loss: 10.0116 - accuracy10: 0.6262 - accuracy20: 0.6192 - accuracy30: 0.6006 - accuracy50: 0.5621 - val_loss: 10.0967 - val_accuracy10: 0.6864 - val_accuracy20: 0.6592 - val_accuracy30: 0.6256 - val_accuracy50: 0.5547 - 118s/epoch - 40ms/step
Epoch 19/50
2948/2948 - 119s - loss: 9.9985 - accuracy10: 0.6265 - accuracy20: 0.6197 - accuracy30: 0.6010 - accuracy50: 0.5627 - val_loss: 10.1172 - val_accuracy10: 0.6848 - val_accuracy20: 0.6577 - val_accuracy30: 0.6251 - val_accuracy50: 0.5543 - 119s/epoch - 40ms/step
Epoch 20/50
2948/2948 - 119s - loss: 9.9853 - accuracy10: 0.6268 - accuracy20: 0.6201 - accuracy30: 0.6019 - accuracy50: 0.5633 - val_loss: 10.0358 - val_accuracy10: 0.6811 - val_accuracy20: 0.6549 - val_accuracy30: 0.6233 - val_accuracy50: 0.5542 - 119s/epoch - 40ms/step
Epoch 21/50
2948/2948 - 118s - loss: 9.9729 - accuracy10: 0.6272 - accuracy20: 0.6203 - accuracy30: 0.6018 - accuracy50: 0.5639 - val_loss: 10.0866 - val_accuracy10: 0.6816 - val_accuracy20: 0.6576 - val_accuracy30: 0.6259 - val_accuracy50: 0.5572 - 118s/epoch - 40ms/step
Epoch 22/50
2948/2948 - 119s - loss: 9.9570 - accuracy10: 0.6275 - accuracy20: 0.6212 - accuracy30: 0.6030 - accuracy50: 0.5644 - val_loss: 10.0899 - val_accuracy10: 0.6817 - val_accuracy20: 0.6556 - val_accuracy30: 0.6230 - val_accuracy50: 0.5532 - 119s/epoch - 40ms/step
Epoch 23/50
2948/2948 - 117s - loss: 9.9454 - accuracy10: 0.6282 - accuracy20: 0.6216 - accuracy30: 0.6030 - accuracy50: 0.5652 - val_loss: 10.0839 - val_accuracy10: 0.6830 - val_accuracy20: 0.6564 - val_accuracy30: 0.6244 - val_accuracy50: 0.5539 - 117s/epoch - 40ms/step
Epoch 24/50
2948/2948 - 120s - loss: 9.9334 - accuracy10: 0.6280 - accuracy20: 0.6217 - accuracy30: 0.6037 - accuracy50: 0.5657 - val_loss: 10.1455 - val_accuracy10: 0.6930 - val_accuracy20: 0.6627 - val_accuracy30: 0.6267 - val_accuracy50: 0.5531 - 120s/epoch - 41ms/step
Epoch 25/50
2948/2948 - 116s - loss: 9.9209 - accuracy10: 0.6283 - accuracy20: 0.6220 - accuracy30: 0.6042 - accuracy50: 0.5665 - val_loss: 10.1262 - val_accuracy10: 0.6849 - val_accuracy20: 0.6579 - val_accuracy30: 0.6247 - val_accuracy50: 0.5536 - 116s/epoch - 40ms/step
Epoch 26/50
2948/2948 - 119s - loss: 9.9071 - accuracy10: 0.6290 - accuracy20: 0.6227 - accuracy30: 0.6046 - accuracy50: 0.5671 - val_loss: 10.1534 - val_accuracy10: 0.6885 - val_accuracy20: 0.6591 - val_accuracy30: 0.6251 - val_accuracy50: 0.5544 - 119s/epoch - 40ms/step
Epoch 27/50
2948/2948 - 120s - loss: 9.8960 - accuracy10: 0.6288 - accuracy20: 0.6229 - accuracy30: 0.6048 - accuracy50: 0.5677 - val_loss: 10.1415 - val_accuracy10: 0.6816 - val_accuracy20: 0.6544 - val_accuracy30: 0.6213 - val_accuracy50: 0.5519 - 120s/epoch - 41ms/step
Epoch 28/50
2948/2948 - 119s - loss: 9.8869 - accuracy10: 0.6286 - accuracy20: 0.6232 - accuracy30: 0.6054 - accuracy50: 0.5682 - val_loss: 10.2114 - val_accuracy10: 0.6897 - val_accuracy20: 0.6610 - val_accuracy30: 0.6258 - val_accuracy50: 0.5537 - 119s/epoch - 40ms/step
Epoch 29/50
2948/2948 - 119s - loss: 9.8738 - accuracy10: 0.6292 - accuracy20: 0.6235 - accuracy30: 0.6059 - accuracy50: 0.5690 - val_loss: 10.1612 - val_accuracy10: 0.6851 - val_accuracy20: 0.6573 - val_accuracy30: 0.6234 - val_accuracy50: 0.5538 - 119s/epoch - 40ms/step
Epoch 30/50
2948/2948 - 118s - loss: 9.8624 - accuracy10: 0.6296 - accuracy20: 0.6242 - accuracy30: 0.6070 - accuracy50: 0.5694 - val_loss: 10.2376 - val_accuracy10: 0.6866 - val_accuracy20: 0.6568 - val_accuracy30: 0.6221 - val_accuracy50: 0.5518 - 118s/epoch - 40ms/step
testing model: results/ATVI/W1/deepVOL_L3/seq2seq
Evaluating performance on  test set...
12066/12066 - 211s - 211s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7045815
{'0': {'precision': 0.4799255288263532, 'recall': 0.5384356092526488, 'f1-score': 0.5074997166466311, 'support': 528065}, '1': {'precision': 0.8315610343706723, 'recall': 0.7482780843931597, 'f1-score': 0.7877243834065344, 'support': 2034217}, '2': {'precision': 0.4494521056053869, 'recall': 0.5683986630203586, 'f1-score': 0.5019753067784344, 'support': 526560}, 'accuracy': 0.6817393055390985, 'macro avg': {'precision': 0.5869795562674708, 'recall': 0.618370785555389, 'f1-score': 0.5990664689438666, 'support': 3088842}, 'weighted avg': {'precision': 0.7063070781094231, 'recall': 0.6817393055390985, 'f1-score': 0.6911053681115271, 'support': 3088842}}
[[ 284329  164436   79300]
 [ 224740 1522160  287317]
 [  83375  143889  299296]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7822352
{'0': {'precision': 0.5460192259455355, 'recall': 0.4661288292342038, 'f1-score': 0.5029210918834623, 'support': 691163}, '1': {'precision': 0.7219318620182268, 'recall': 0.7781584935585346, 'f1-score': 0.7489914298982564, 'support': 1709937}, '2': {'precision': 0.5190691375384516, 'recall': 0.49488034757220006, 'f1-score': 0.5066862185368105, 'support': 687742}, 'accuracy': 0.6452654425185879, 'macro avg': {'precision': 0.5956734085007379, 'recall': 0.5797225567883129, 'f1-score': 0.5861995801061765, 'support': 3088842}, 'weighted avg': {'precision': 0.6374013094211438, 'recall': 0.6452654425185879, 'f1-score': 0.6399802911914327, 'support': 3088842}}
[[ 322171  273038   95954]
 [ 159946 1330602  219389]
 [ 107919  239473  340350]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.85471904
{'0': {'precision': 0.5736592571331564, 'recall': 0.405259077831533, 'f1-score': 0.4749744963019638, 'support': 808811}, '1': {'precision': 0.6263595935766362, 'recall': 0.805068140362039, 'f1-score': 0.7045583108986605, 'support': 1477465}, '2': {'precision': 0.5580574850919063, 'recall': 0.43003815262545386, 'f1-score': 0.4857546188588214, 'support': 802566}, 'accuracy': 0.6029353395220604, 'macro avg': {'precision': 0.586025445267233, 'recall': 0.5467884569396753, 'f1-score': 0.5550958086864819, 'support': 3088842}, 'weighted avg': {'precision': 0.5948132853428894, 'recall': 0.6029353395220604, 'f1-score': 0.5875907487593817, 'support': 3088842}}
[[ 327778  377002  104031]
 [ 118714 1189460  169291]
 [ 124889  332543  345134]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.972789
{'0': {'precision': 0.5781251740384723, 'recall': 0.32131194562208465, 'f1-score': 0.41305505504045054, 'support': 969217}, '1': {'precision': 0.4855524064944522, 'recall': 0.8266374312202429, 'f1-score': 0.6117648262333989, 'support': 1157499}, '2': {'precision': 0.5854583539666955, 'recall': 0.35266690641350507, 'f1-score': 0.44017956929056373, 'support': 962126}, 'accuracy': 0.5204419649823462, 'macro avg': {'precision': 0.54971197816654, 'recall': 0.5002054277519442, 'f1-score': 0.48833315018813767, 'support': 3088842}, 'weighted avg': {'precision': 0.5457190351722518, 'recall': 0.5204419649823462, 'f1-score': 0.4959675386972614, 'support': 3088842}}
[[311421 538413 119383]
 [ 79797 956832 120870]
 [147456 475360 339310]]
Evaluating performance on  train set...
2948/2948 - 50s - 50s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.75591624
{'0': {'precision': 0.4373171627207372, 'recall': 0.5781479973694924, 'f1-score': 0.49796694515809276, 'support': 127732}, '1': {'precision': 0.8381892134334411, 'recall': 0.6811522998663878, 'f1-score': 0.7515552039559364, 'support': 500703}, '2': {'precision': 0.41592761902630354, 'recall': 0.5897403349544218, 'f1-score': 0.4878136812263755, 'support': 126047}, 'accuracy': 0.6484422424922, 'macro avg': {'precision': 0.5638113317268273, 'recall': 0.6163468773967673, 'f1-score': 0.5791119434468016, 'support': 754482}, 'weighted avg': {'precision': 0.6997776993458, 'recall': 0.6484422424922, 'f1-score': 0.6645615272502507, 'support': 754482}}
[[ 73848  36353  17531]
 [ 72793 341055  86855]
 [ 22225  29487  74335]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8056872
{'0': {'precision': 0.518461227258124, 'recall': 0.5112584335582282, 'f1-score': 0.5148346389706142, 'support': 170450}, '1': {'precision': 0.7315266662593928, 'recall': 0.7202050724393612, 'f1-score': 0.7258217225958106, 'support': 415658}, '2': {'precision': 0.49909411598701847, 'recall': 0.5251820352310926, 'f1-score': 0.5118058509791664, 'support': 168374}, 'accuracy': 0.6294782380494167, 'macro avg': {'precision': 0.5830273365015118, 'recall': 0.5855485137428941, 'f1-score': 0.5841540708485304, 'support': 754482}, 'weighted avg': {'precision': 0.6315208313987506, 'recall': 0.6294782380494167, 'f1-score': 0.630395381382242, 'support': 754482}}
[[ 87144  60148  23158]
 [ 50709 299359  65590]
 [ 30229  49718  88427]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8604506
{'0': {'precision': 0.5510647729273817, 'recall': 0.45543098602858517, 'f1-score': 0.4987044816965107, 'support': 199264}, '1': {'precision': 0.6386726712491112, 'recall': 0.752874382165, 'f1-score': 0.6910873643727967, 'support': 357903}, '2': {'precision': 0.5427310466411355, 'recall': 0.4618199325950891, 'f1-score': 0.499017014681803, 'support': 197315}, 'accuracy': 0.5981998245153629, 'macro avg': {'precision': 0.5774894969392095, 'recall': 0.5567084335962248, 'f1-score': 0.5629362869170368, 'support': 754482}, 'weighted avg': {'precision': 0.5904437911556115, 'recall': 0.5981998245153629, 'f1-score': 0.5900467248573599, 'support': 754482}}
[[ 90751  82149  26364]
 [ 38036 269456  50411]
 [ 35896  70295  91124]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9597688
{'0': {'precision': 0.570027975584944, 'recall': 0.3776018194836373, 'f1-score': 0.4542778242253807, 'support': 237430}, '1': {'precision': 0.4992240159110872, 'recall': 0.7822260889408678, 'f1-score': 0.6094752312133107, 'support': 280456}, '2': {'precision': 0.5728701825557809, 'recall': 0.38198447987286344, 'f1-score': 0.45834728012252884, 'support': 236596}, 'accuracy': 0.5293830734199093, 'macro avg': {'precision': 0.5473740580172707, 'recall': 0.5139374627657896, 'f1-score': 0.5073667785204067, 'support': 754482}, 'weighted avg': {'precision': 0.5446000124077985, 'recall': 0.5293830734199093, 'f1-score': 0.5132439240947594, 'support': 754482}}
[[ 89654 116393  31383]
 [ 25075 219380  36001]
 [ 42551 103669  90376]]
Evaluating performance on  val set...
697/697 - 12s - 12s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6977963
{'0': {'precision': 0.4388050112431738, 'recall': 0.5315175097276265, 'f1-score': 0.4807320077423896, 'support': 25700}, '1': {'precision': 0.8597693263364794, 'recall': 0.7271807659734638, 'f1-score': 0.7879362058271236, 'support': 127524}, '2': {'precision': 0.38957677864609763, 'recall': 0.6098665395614872, 'f1-score': 0.47544435498854276, 'support': 25176}, 'accuracy': 0.6824383408071749, 'macro avg': {'precision': 0.5627170387419169, 'recall': 0.6228549384208591, 'f1-score': 0.5813708561860187, 'support': 178400}, 'weighted avg': {'precision': 0.7327718460755432, 'recall': 0.6824383408071749, 'f1-score': 0.699581706233571, 'support': 178400}}
[[13660  8528  3512]
 [14245 92733 20546]
 [ 3225  6597 15354]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7595598
{'0': {'precision': 0.5165347147558075, 'recall': 0.4586587976624429, 'f1-score': 0.48587934231293767, 'support': 34566}, '1': {'precision': 0.7656871775976418, 'recall': 0.7553408997973593, 'f1-score': 0.7604788501740567, 'support': 110047}, '2': {'precision': 0.46059723605895725, 'recall': 0.5336667949211235, 'f1-score': 0.494447034304988, 'support': 33787}, 'accuracy': 0.6558744394618834, 'macro avg': {'precision': 0.5809397094708021, 'recall': 0.5825554974603085, 'f1-score': 0.5802684089306608, 'support': 178400}, 'weighted avg': {'precision': 0.6596318082850948, 'recall': 0.6558744394618834, 'f1-score': 0.656890153136525, 'support': 178400}}
[[15854 14139  4573]
 [10381 83123 16543]
 [ 4458 11298 18031]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.81940615
{'0': {'precision': 0.5490692027519223, 'recall': 0.39694265652428323, 'f1-score': 0.46077432501273563, 'support': 41016}, '1': {'precision': 0.681803562813801, 'recall': 0.7837191152005587, 'f1-score': 0.729217627274117, 'support': 97378}, '2': {'precision': 0.5055685337100017, 'recall': 0.46523021546767984, 'f1-score': 0.4845613121582921, 'support': 40006}, 'accuracy': 0.6233744394618834, 'macro avg': {'precision': 0.5788137664252416, 'recall': 0.5486306623975072, 'f1-score': 0.5581844214817149, 'support': 178400}, 'weighted avg': {'precision': 0.6117660567228558, 'recall': 0.6233744394618834, 'f1-score': 0.6126358390001456, 'support': 178400}}
[[16281 19599  5136]
 [ 7995 76317 13066]
 [ 5376 16018 18612]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.92393017
{'0': {'precision': 0.5697510568341945, 'recall': 0.31443042013120376, 'f1-score': 0.40522691062342603, 'support': 50151}, '1': {'precision': 0.555056720936433, 'recall': 0.8117963747971673, 'f1-score': 0.6593145017111918, 'support': 79499}, '2': {'precision': 0.5431615000580517, 'recall': 0.38385641025641026, 'f1-score': 0.4498209177663998, 'support': 48750}, 'accuracy': 0.5550392376681614, 'macro avg': {'precision': 0.5559897592762265, 'recall': 0.5033610683949271, 'f1-score': 0.5047874433670059, 'support': 178400}, 'weighted avg': {'precision': 0.5559370102962287, 'recall': 0.5550392376681614, 'f1-score': 0.5306398436509274, 'support': 178400}}
[[15769 28184  6198]
 [ 5421 64537  9541]
 [ 6487 23550 18713]]
training model: results/ATVI/W2/deepLOB_L1/seq2seq
Epoch 1/50
2058/2058 - 56s - loss: 12.0090 - accuracy10: 0.4555 - accuracy20: 0.4718 - accuracy30: 0.4744 - accuracy50: 0.4653 - val_loss: 14.9459 - val_accuracy10: 0.5309 - val_accuracy20: 0.4756 - val_accuracy30: 0.4283 - val_accuracy50: 0.3598 - 56s/epoch - 27ms/step
Epoch 2/50
2058/2058 - 50s - loss: 11.9785 - accuracy10: 0.4429 - accuracy20: 0.4684 - accuracy30: 0.4781 - accuracy50: 0.4676 - val_loss: 13.7493 - val_accuracy10: 0.4990 - val_accuracy20: 0.4727 - val_accuracy30: 0.4484 - val_accuracy50: 0.4008 - 50s/epoch - 24ms/step
Epoch 3/50
2058/2058 - 49s - loss: 11.6453 - accuracy10: 0.4932 - accuracy20: 0.5050 - accuracy30: 0.5033 - accuracy50: 0.4835 - val_loss: 13.5934 - val_accuracy10: 0.4612 - val_accuracy20: 0.4619 - val_accuracy30: 0.4583 - val_accuracy50: 0.4379 - 49s/epoch - 24ms/step
Epoch 4/50
2058/2058 - 48s - loss: 11.4059 - accuracy10: 0.5261 - accuracy20: 0.5290 - accuracy30: 0.5217 - accuracy50: 0.4981 - val_loss: 13.6177 - val_accuracy10: 0.4773 - val_accuracy20: 0.4738 - val_accuracy30: 0.4656 - val_accuracy50: 0.4376 - 48s/epoch - 23ms/step
Epoch 5/50
2058/2058 - 53s - loss: 11.2578 - accuracy10: 0.5440 - accuracy20: 0.5422 - accuracy30: 0.5316 - accuracy50: 0.5049 - val_loss: 13.4672 - val_accuracy10: 0.4808 - val_accuracy20: 0.4804 - val_accuracy30: 0.4728 - val_accuracy50: 0.4456 - 53s/epoch - 26ms/step
Epoch 6/50
2058/2058 - 53s - loss: 11.1713 - accuracy10: 0.5535 - accuracy20: 0.5490 - accuracy30: 0.5373 - accuracy50: 0.5093 - val_loss: 13.3220 - val_accuracy10: 0.5149 - val_accuracy20: 0.5030 - val_accuracy30: 0.4861 - val_accuracy50: 0.4461 - 53s/epoch - 26ms/step
Epoch 7/50
2058/2058 - 47s - loss: 11.0873 - accuracy10: 0.5604 - accuracy20: 0.5548 - accuracy30: 0.5418 - accuracy50: 0.5127 - val_loss: 13.6269 - val_accuracy10: 0.4920 - val_accuracy20: 0.4880 - val_accuracy30: 0.4782 - val_accuracy50: 0.4489 - 47s/epoch - 23ms/step
Epoch 8/50
2058/2058 - 53s - loss: 11.0317 - accuracy10: 0.5655 - accuracy20: 0.5588 - accuracy30: 0.5450 - accuracy50: 0.5143 - val_loss: 13.8995 - val_accuracy10: 0.4835 - val_accuracy20: 0.4831 - val_accuracy30: 0.4758 - val_accuracy50: 0.4472 - 53s/epoch - 26ms/step
Epoch 9/50
2058/2058 - 52s - loss: 10.9858 - accuracy10: 0.5683 - accuracy20: 0.5618 - accuracy30: 0.5478 - accuracy50: 0.5163 - val_loss: 13.6091 - val_accuracy10: 0.4977 - val_accuracy20: 0.4954 - val_accuracy30: 0.4838 - val_accuracy50: 0.4486 - 52s/epoch - 25ms/step
Epoch 10/50
2058/2058 - 52s - loss: 10.9502 - accuracy10: 0.5718 - accuracy20: 0.5644 - accuracy30: 0.5498 - accuracy50: 0.5173 - val_loss: 13.8743 - val_accuracy10: 0.4722 - val_accuracy20: 0.4773 - val_accuracy30: 0.4741 - val_accuracy50: 0.4501 - 52s/epoch - 25ms/step
Epoch 11/50
2058/2058 - 53s - loss: 10.9058 - accuracy10: 0.5757 - accuracy20: 0.5678 - accuracy30: 0.5518 - accuracy50: 0.5195 - val_loss: 14.0382 - val_accuracy10: 0.4620 - val_accuracy20: 0.4711 - val_accuracy30: 0.4701 - val_accuracy50: 0.4490 - 53s/epoch - 26ms/step
Epoch 12/50
2058/2058 - 52s - loss: 10.8777 - accuracy10: 0.5773 - accuracy20: 0.5691 - accuracy30: 0.5533 - accuracy50: 0.5202 - val_loss: 13.7705 - val_accuracy10: 0.4615 - val_accuracy20: 0.4730 - val_accuracy30: 0.4742 - val_accuracy50: 0.4544 - 52s/epoch - 25ms/step
Epoch 13/50
2058/2058 - 51s - loss: 10.8466 - accuracy10: 0.5789 - accuracy20: 0.5705 - accuracy30: 0.5546 - accuracy50: 0.5214 - val_loss: 13.7879 - val_accuracy10: 0.4603 - val_accuracy20: 0.4719 - val_accuracy30: 0.4732 - val_accuracy50: 0.4542 - 51s/epoch - 25ms/step
Epoch 14/50
2058/2058 - 52s - loss: 10.8217 - accuracy10: 0.5810 - accuracy20: 0.5720 - accuracy30: 0.5558 - accuracy50: 0.5218 - val_loss: 13.9410 - val_accuracy10: 0.4449 - val_accuracy20: 0.4629 - val_accuracy30: 0.4689 - val_accuracy50: 0.4542 - 52s/epoch - 25ms/step
Epoch 15/50
2058/2058 - 48s - loss: 10.8006 - accuracy10: 0.5820 - accuracy20: 0.5727 - accuracy30: 0.5573 - accuracy50: 0.5234 - val_loss: 13.9990 - val_accuracy10: 0.4404 - val_accuracy20: 0.4608 - val_accuracy30: 0.4692 - val_accuracy50: 0.4571 - 48s/epoch - 23ms/step
Epoch 16/50
2058/2058 - 53s - loss: 10.7802 - accuracy10: 0.5837 - accuracy20: 0.5743 - accuracy30: 0.5579 - accuracy50: 0.5238 - val_loss: 13.8015 - val_accuracy10: 0.4402 - val_accuracy20: 0.4621 - val_accuracy30: 0.4704 - val_accuracy50: 0.4575 - 53s/epoch - 26ms/step
testing model: results/ATVI/W2/deepLOB_L1/seq2seq
Evaluating performance on  test set...
5497/5497 - 54s - 54s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9302033
{'0': {'precision': 0.40111962209491997, 'recall': 0.45051039475901894, 'f1-score': 0.424382785292463, 'support': 272926}, '1': {'precision': 0.7959063113992534, 'recall': 0.49015594149171937, 'f1-score': 0.6066863505652945, 'support': 868595}, '2': {'precision': 0.3203935321026323, 'recall': 0.6822568503462813, 'f1-score': 0.43602572922730537, 'support': 265680}, 'accuracy': 0.5187354187497024, 'macro avg': {'precision': 0.5058064885322685, 'recall': 0.54097439553234, 'f1-score': 0.48903162169502096, 'support': 1407201}, 'weighted avg': {'precision': 0.6295606456637964, 'recall': 0.5187354187497024, 'f1-score': 0.5391078761805195, 'support': 1407201}}
[[122956  64599  85371]
 [143733 425747 299115]
 [ 39843  44575 181262]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.96549356
{'0': {'precision': 0.45487498779639024, 'recall': 0.41836282480933606, 'f1-score': 0.4358555758407894, 'support': 345241}, '1': {'precision': 0.6930467978424372, 'recall': 0.5065733213389307, 'f1-score': 0.585316989291466, 'support': 720336}, '2': {'precision': 0.38781181634798423, 'recall': 0.6392905650656863, 'f1-score': 0.4827647948221438, 'support': 341624}, 'accuracy': 0.5171514232863678, 'macro avg': {'precision': 0.5119112006622706, 'recall': 0.5214089037379844, 'f1-score': 0.5013124533181331, 'support': 1407201}, 'weighted avg': {'precision': 0.5605125904405321, 'recall': 0.5171514232863678, 'f1-score': 0.5237518690815509, 'support': 1407201}}
[[144436  90637 110168]
 [120846 364903 234587]
 [ 52247  70980 218397]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.99144834
{'0': {'precision': 0.4823068547247856, 'recall': 0.3862685276993873, 'f1-score': 0.4289782152331017, 'support': 393330}, '1': {'precision': 0.608020611249557, 'recall': 0.522324492024781, 'f1-score': 0.5619240637068397, 'support': 620798}, '2': {'precision': 0.4248878582764797, 'recall': 0.6041269687818802, 'f1-score': 0.49889701711409257, 'support': 393073}, 'accuracy': 0.5071450347178548, 'macro avg': {'precision': 0.5050717747502741, 'recall': 0.5042399961686829, 'f1-score': 0.4965997653513446, 'support': 1407201}, 'weighted avg': {'precision': 0.5217276563246566, 'recall': 0.5071450347178548, 'f1-score': 0.5071587381666175, 'support': 1407201}}
[[151931 113273 128126]
 [103241 324258 193299]
 [ 59837  95770 237466]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0370162
{'0': {'precision': 0.5087428215184571, 'recall': 0.3373233629979244, 'f1-score': 0.40566764774732833, 'support': 457223}, '1': {'precision': 0.4833484285182128, 'recall': 0.5398120541486354, 'f1-score': 0.5100222545496585, 'support': 490354}, '2': {'precision': 0.45777872832951716, 'recall': 0.5541681896506709, 'f1-score': 0.5013828386281454, 'support': 459624}, 'accuracy': 0.47870915384511525, 'macro avg': {'precision': 0.48328999278872903, 'recall': 0.47710120226574365, 'f1-score': 0.47235758030837743, 'support': 1407201}, 'weighted avg': {'precision': 0.4832478406641831, 'recall': 0.47870915384511525, 'f1-score': 0.47329387723220967, 'support': 1407201}}
[[154232 148683 154308]
 [ 78270 264699 147385]
 [ 70661 134254 254709]]
Evaluating performance on  train set...
2058/2058 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.89630157
{'0': {'precision': 0.4541563565839631, 'recall': 0.2838334865836329, 'f1-score': 0.34934026080917724, 'support': 95704}, '1': {'precision': 0.7451189272911046, 'recall': 0.6135971688283692, 'f1-score': 0.6729924897953822, 'support': 333996}, '2': {'precision': 0.33830806896910975, 'recall': 0.6686812734236646, 'f1-score': 0.4493002276076294, 'support': 97124}, 'accuracy': 0.5638467495786069, 'macro avg': {'precision': 0.5125277842813926, 'recall': 0.522037309611889, 'f1-score': 0.4905443260707296, 'support': 526824}, 'weighted avg': {'precision': 0.6172633632495619, 'recall': 0.5638467495786069, 'f1-score': 0.5729577529655888, 'support': 526824}}
[[ 27164  44941  23599]
 [ 25631 204939 103426]
 [  7017  25162  64945]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.95750624
{'0': {'precision': 0.5177186262834337, 'recall': 0.25885306447589695, 'f1-score': 0.34514019644131166, 'support': 124279}, '1': {'precision': 0.6360291462657249, 'recall': 0.6360773777927035, 'f1-score': 0.6360532611148725, 'support': 276927}, '2': {'precision': 0.4065346386986119, 'recall': 0.6075721632250155, 'f1-score': 0.4871264631920244, 'support': 125618}, 'accuracy': 0.5402923936646774, 'macro avg': {'precision': 0.5200941370825901, 'recall': 0.5008342018312053, 'f1-score': 0.48943997358273617, 'support': 526824}, 'weighted avg': {'precision': 0.5533978421405431, 'recall': 0.5402923936646774, 'f1-score': 0.5319155011304416, 'support': 526824}}
[[ 32170  60889  31220]
 [ 20584 176147  80196]
 [  9384  39912  76322]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.99851245
{'0': {'precision': 0.5478370957399582, 'recall': 0.2318171065996911, 'f1-score': 0.32578035247244014, 'support': 143734}, '1': {'precision': 0.5503483416972721, 'recall': 0.6597530594497402, 'f1-score': 0.600105085166751, 'support': 238033}, '2': {'precision': 0.44455330997337406, 'recall': 0.5536375355894579, 'f1-score': 0.4931349552359783, 'support': 145057}, 'accuracy': 0.5137806933624892, 'macro avg': {'precision': 0.5142462491368681, 'recall': 0.4817359005462964, 'f1-score': 0.4730067976250565, 'support': 526824}, 'weighted avg': {'precision': 0.5205333345161224, 'recall': 0.5137806933624892, 'f1-score': 0.4958073362668296, 'support': 526824}}
[[ 33320  74341  36073]
 [ 16721 157043  64269]
 [ 10780  53968  80309]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0606374
{'0': {'precision': 0.5651671423818446, 'recall': 0.19114825168198615, 'f1-score': 0.2856763514859153, 'support': 168848}, '1': {'precision': 0.42993239194390936, 'recall': 0.6779395906513918, 'f1-score': 0.526176660085643, 'support': 187322}, '2': {'precision': 0.47780174144477966, 'recall': 0.4881163055070494, 'f1-score': 0.4829039513959744, 'support': 170654}, 'accuracy': 0.46043270617891363, 'macro avg': {'precision': 0.49096709192351123, 'recall': 0.4524013826134758, 'f1-score': 0.43158565432251095, 'support': 526824}, 'weighted avg': {'precision': 0.4887816719912611, 'recall': 0.46043270617891363, 'f1-score': 0.43507857621859536, 'support': 526824}}
[[ 32275  93607  42966]
 [ 12256 126993  48073]
 [ 12576  74779  83299]]
Evaluating performance on  val set...
681/681 - 7s - 7s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9585306
{'0': {'precision': 0.467085161935448, 'recall': 0.23697190045376398, 'f1-score': 0.3144235443700685, 'support': 35481}, '1': {'precision': 0.7140591425355571, 'recall': 0.5386255535509267, 'f1-score': 0.6140579542767264, 'support': 103649}, '2': {'precision': 0.3250633689223443, 'recall': 0.721999488185618, 'f1-score': 0.44829321257381954, 'support': 35169}, 'accuracy': 0.5142198176696366, 'macro avg': {'precision': 0.5020692244644498, 'recall': 0.4991989807301029, 'f1-score': 0.4589249037402048, 'support': 174299}, 'weighted avg': {'precision': 0.5852949145831561, 'recall': 0.5142198176696366, 'f1-score': 0.5196161691899062, 'support': 174299}}
[[ 8408 14893 12180]
 [ 7279 55828 40542]
 [ 2314  7463 25392]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0061594
{'0': {'precision': 0.523404929020001, 'recall': 0.22057155565439787, 'f1-score': 0.31035453891166254, 'support': 44965}, '1': {'precision': 0.6050167138737911, 'recall': 0.5599773269407903, 'f1-score': 0.5816263951919539, 'support': 84682}, '2': {'precision': 0.3918567790884997, 'recall': 0.6754904595538833, 'f1-score': 0.4959876340196014, 'support': 44652}, 'accuracy': 0.5020109122829162, 'macro avg': {'precision': 0.5067594739940973, 'recall': 0.4853464473830238, 'f1-score': 0.46265618937440595, 'support': 174299}, 'weighted avg': {'precision': 0.5293554001887815, 'recall': 0.5020109122829162, 'f1-score': 0.4897057244967051, 'support': 174299}}
[[ 9918 19421 15626]
 [ 6078 47420 31184]
 [ 2953 11537 30162]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0334731
{'0': {'precision': 0.5531590413943355, 'recall': 0.19846791213945125, 'f1-score': 0.29212448944370933, 'support': 51172}, '1': {'precision': 0.5217761437102107, 'recall': 0.584881131840624, 'f1-score': 0.5515294179017859, 'support': 72307}, '2': {'precision': 0.42816510208714464, 'recall': 0.6309327036599763, 'f1-score': 0.5101386557630044, 'support': 50820}, 'accuracy': 0.4848622195193317, 'macro avg': {'precision': 0.501033429063897, 'recall': 0.4714272492133505, 'f1-score': 0.4512641877028332, 'support': 174299}, 'weighted avg': {'precision': 0.503695790438005, 'recall': 0.4848622195193317, 'f1-score': 0.46330316570900476, 'support': 174299}}
[[10156 23280 17736]
 [ 4929 42291 25087]
 [ 3275 15481 32064]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.079757
{'0': {'precision': 0.5741777883698761, 'recall': 0.16361352099285242, 'f1-score': 0.2546607650128824, 'support': 58901}, '1': {'precision': 0.4101763236056763, 'recall': 0.6083027442754764, 'f1-score': 0.48996860348881416, 'support': 57210}, '2': {'precision': 0.459027672661722, 'recall': 0.5732797140303842, 'f1-score': 0.5098311923520736, 'support': 58188}, 'accuracy': 0.4463364677938485, 'macro avg': {'precision': 0.4811272615457581, 'recall': 0.4483986597662377, 'f1-score': 0.41815352028459, 'support': 174299}, 'weighted avg': {'precision': 0.48190600980553583, 'recall': 0.4463364677938485, 'f1-score': 0.41708176722873513, 'support': 174299}}
[[ 9637 28826 20438]
 [ 3534 34801 18875]
 [ 3613 21217 33358]]
training model: results/ATVI/W2/deepOF_L1/seq2seq
Epoch 1/50
2058/2058 - 57s - loss: 12.6622 - accuracy10: 0.4346 - accuracy20: 0.4411 - accuracy30: 0.4404 - accuracy50: 0.4303 - val_loss: 13.7991 - val_accuracy10: 0.5626 - val_accuracy20: 0.4821 - val_accuracy30: 0.4238 - val_accuracy50: 0.3416 - 57s/epoch - 28ms/step
Epoch 2/50
2058/2058 - 43s - loss: 12.6627 - accuracy10: 0.4048 - accuracy20: 0.4206 - accuracy30: 0.4269 - accuracy50: 0.4248 - val_loss: 13.6223 - val_accuracy10: 0.5553 - val_accuracy20: 0.4831 - val_accuracy30: 0.4311 - val_accuracy50: 0.3558 - 43s/epoch - 21ms/step
Epoch 3/50
2058/2058 - 48s - loss: 12.6015 - accuracy10: 0.4081 - accuracy20: 0.4244 - accuracy30: 0.4304 - accuracy50: 0.4271 - val_loss: 13.6185 - val_accuracy10: 0.5502 - val_accuracy20: 0.4803 - val_accuracy30: 0.4324 - val_accuracy50: 0.3626 - 48s/epoch - 23ms/step
Epoch 4/50
2058/2058 - 47s - loss: 12.5239 - accuracy10: 0.4274 - accuracy20: 0.4374 - accuracy30: 0.4402 - accuracy50: 0.4333 - val_loss: 13.6598 - val_accuracy10: 0.5509 - val_accuracy20: 0.4805 - val_accuracy30: 0.4333 - val_accuracy50: 0.3665 - 47s/epoch - 23ms/step
Epoch 5/50
2058/2058 - 48s - loss: 12.4614 - accuracy10: 0.4400 - accuracy20: 0.4478 - accuracy30: 0.4477 - accuracy50: 0.4384 - val_loss: 13.6917 - val_accuracy10: 0.5589 - val_accuracy20: 0.4861 - val_accuracy30: 0.4365 - val_accuracy50: 0.3684 - 48s/epoch - 23ms/step
Epoch 6/50
2058/2058 - 45s - loss: 12.4011 - accuracy10: 0.4501 - accuracy20: 0.4557 - accuracy30: 0.4542 - accuracy50: 0.4433 - val_loss: 13.7261 - val_accuracy10: 0.5583 - val_accuracy20: 0.4845 - val_accuracy30: 0.4373 - val_accuracy50: 0.3724 - 45s/epoch - 22ms/step
Epoch 7/50
2058/2058 - 45s - loss: 12.3492 - accuracy10: 0.4584 - accuracy20: 0.4623 - accuracy30: 0.4601 - accuracy50: 0.4478 - val_loss: 13.7163 - val_accuracy10: 0.5605 - val_accuracy20: 0.4871 - val_accuracy30: 0.4397 - val_accuracy50: 0.3742 - 45s/epoch - 22ms/step
Epoch 8/50
2058/2058 - 50s - loss: 12.2948 - accuracy10: 0.4673 - accuracy20: 0.4694 - accuracy30: 0.4658 - accuracy50: 0.4519 - val_loss: 13.7257 - val_accuracy10: 0.5635 - val_accuracy20: 0.4893 - val_accuracy30: 0.4415 - val_accuracy50: 0.3745 - 50s/epoch - 24ms/step
Epoch 9/50
2058/2058 - 49s - loss: 12.2517 - accuracy10: 0.4728 - accuracy20: 0.4744 - accuracy30: 0.4697 - accuracy50: 0.4551 - val_loss: 13.7140 - val_accuracy10: 0.5598 - val_accuracy20: 0.4893 - val_accuracy30: 0.4433 - val_accuracy50: 0.3787 - 49s/epoch - 24ms/step
Epoch 10/50
2058/2058 - 46s - loss: 12.2163 - accuracy10: 0.4768 - accuracy20: 0.4781 - accuracy30: 0.4734 - accuracy50: 0.4580 - val_loss: 13.7249 - val_accuracy10: 0.5576 - val_accuracy20: 0.4884 - val_accuracy30: 0.4439 - val_accuracy50: 0.3820 - 46s/epoch - 22ms/step
Epoch 11/50
2058/2058 - 49s - loss: 12.1804 - accuracy10: 0.4817 - accuracy20: 0.4820 - accuracy30: 0.4762 - accuracy50: 0.4602 - val_loss: 13.7771 - val_accuracy10: 0.5613 - val_accuracy20: 0.4910 - val_accuracy30: 0.4464 - val_accuracy50: 0.3819 - 49s/epoch - 24ms/step
Epoch 12/50
2058/2058 - 45s - loss: 12.1483 - accuracy10: 0.4833 - accuracy20: 0.4838 - accuracy30: 0.4780 - accuracy50: 0.4620 - val_loss: 13.7646 - val_accuracy10: 0.5626 - val_accuracy20: 0.4915 - val_accuracy30: 0.4453 - val_accuracy50: 0.3828 - 45s/epoch - 22ms/step
Epoch 13/50
2058/2058 - 48s - loss: 12.1136 - accuracy10: 0.4866 - accuracy20: 0.4861 - accuracy30: 0.4806 - accuracy50: 0.4642 - val_loss: 13.7627 - val_accuracy10: 0.5611 - val_accuracy20: 0.4908 - val_accuracy30: 0.4462 - val_accuracy50: 0.3855 - 48s/epoch - 23ms/step
testing model: results/ATVI/W2/deepOF_L1/seq2seq
Evaluating performance on  test set...
5497/5497 - 47s - 47s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9698497
{'0': {'precision': 0.384289369868856, 'recall': 0.21129614362920215, 'f1-score': 0.2726690292182539, 'support': 272925}, '1': {'precision': 0.6464510238814709, 'recall': 0.7499694909244135, 'f1-score': 0.6943732781745146, 'support': 868594}, '2': {'precision': 0.3239245210405417, 'recall': 0.30413622556713604, 'f1-score': 0.31371863861905097, 'support': 265677}, 'accuracy': 0.5613212374111354, 'macro avg': {'precision': 0.4515549715969562, 'recall': 0.4218006200402506, 'f1-score': 0.42692031533727315, 'support': 1407196}, 'weighted avg': {'precision': 0.5347122589072509, 'recall': 0.5613212374111354, 'f1-score': 0.5407167762944891, 'support': 1407196}}
[[ 57668 186683  28574]
 [ 77104 651419 140071]
 [ 15292 169583  80802]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0154293
{'0': {'precision': 0.4433018744715805, 'recall': 0.18680338315374811, 'f1-score': 0.26284589410275905, 'support': 345240}, '1': {'precision': 0.536191070556404, 'recall': 0.7681176119444425, 'f1-score': 0.6315342528764495, 'support': 720335}, '2': {'precision': 0.3919574592150668, 'recall': 0.2636635335649741, 'f1-score': 0.3152580220641765, 'support': 341621}, 'accuracy': 0.5030336925346576, 'macro avg': {'precision': 0.4571501347476838, 'recall': 0.40619484288772156, 'f1-score': 0.4032127230144617, 'support': 1407196}, 'weighted avg': {'precision': 0.4783865453897866, 'recall': 0.5030336925346576, 'f1-score': 0.464299147582412, 'support': 1407196}}
[[ 64492 246935  33813]
 [ 61116 553302 105917]
 [ 19873 231675  90073]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0460194
{'0': {'precision': 0.4760402287517255, 'recall': 0.1595724666053096, 'f1-score': 0.23902264400996248, 'support': 393326}, '1': {'precision': 0.45999105612282926, 'recall': 0.795324727205951, 'f1-score': 0.5828688941645349, 'support': 620798}, '2': {'precision': 0.4364572503589287, 'recall': 0.2242846094354215, 'f1-score': 0.2963052589478071, 'support': 393072}, 'accuracy': 0.4581167086887683, 'macro avg': {'precision': 0.45749617841116114, 'recall': 0.39306060108222746, 'f1-score': 0.3727322657074348, 'support': 1407196}, 'weighted avg': {'precision': 0.4579032707497934, 'recall': 0.4581167086887683, 'f1-score': 0.4067144626495171, 'support': 1407196}}
[[ 62764 296519  34043]
 [ 47275 493736  79787]
 [ 21807 283105  88160]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0840226
{'0': {'precision': 0.5149605874580933, 'recall': 0.12530920495777753, 'f1-score': 0.2015690965381368, 'support': 457221}, '1': {'precision': 0.3615886996231497, 'recall': 0.8333815977844578, 'f1-score': 0.5043495539369989, 'support': 490354}, '2': {'precision': 0.4877005670165279, 'recall': 0.17590797635443114, 'f1-score': 0.2585573096301413, 'support': 459621}, 'accuracy': 0.38857202550319925, 'macro avg': {'precision': 0.45474995136592367, 'recall': 0.37819959303222217, 'f1-score': 0.321491986701759, 'support': 1407196}, 'weighted avg': {'precision': 0.4526126298581651, 'recall': 0.38857202550319925, 'f1-score': 0.32569010590493563, 'support': 1407196}}
[[ 57294 365820  34107]
 [ 30880 408652  50822]
 [ 23085 355685  80851]]
Evaluating performance on  train set...
2058/2058 - 19s - 19s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.95656735
{'0': {'precision': 0.3574117020872144, 'recall': 0.19646607663451793, 'f1-score': 0.25355512551666476, 'support': 95701}, '1': {'precision': 0.657758582017017, 'recall': 0.790030143653818, 'f1-score': 0.7178521255574156, 'support': 334067}, '2': {'precision': 0.3230828262895357, 'recall': 0.2429113089350478, 'f1-score': 0.27731902980685535, 'support': 97056}, 'accuracy': 0.5814104900308262, 'macro avg': {'precision': 0.44608437013125574, 'recall': 0.4098025097411279, 'f1-score': 0.41624209362697856, 'support': 526824}, 'weighted avg': {'precision': 0.5415418058184222, 'recall': 0.5814104900308262, 'f1-score': 0.5523508056819615, 'support': 526824}}
[[ 18802  68725   8174]
 [ 28922 263923  41222]
 [  4882  68598  23576]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0083394
{'0': {'precision': 0.4254225406963159, 'recall': 0.17573013102544097, 'f1-score': 0.2487207071828236, 'support': 124327}, '1': {'precision': 0.5459790141149218, 'recall': 0.8036938570571959, 'f1-score': 0.6502316066340323, 'support': 276838}, '2': {'precision': 0.39084113249749836, 'recall': 0.2113656801343318, 'f1-score': 0.2743589081424476, 'support': 125659}, 'accuracy': 0.5142153736352179, 'macro avg': {'precision': 0.4540808957695787, 'recall': 0.39692988940565627, 'f1-score': 0.3911037406531012, 'support': 526824}, 'weighted avg': {'precision': 0.4805247148861873, 'recall': 0.5142153736352179, 'f1-score': 0.4658238480356684, 'support': 526824}}
[[ 21848  92556   9923]
 [ 22872 222493  31473]
 [  6636  92463  26560]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0424149
{'0': {'precision': 0.46453383278524296, 'recall': 0.1484290734490797, 'f1-score': 0.2249738954340741, 'support': 143705}, '1': {'precision': 0.4682238997293833, 'recall': 0.8283873568914685, 'f1-score': 0.5982838059590577, 'support': 238106}, '2': {'precision': 0.43314835616208697, 'recall': 0.17816333708012386, 'f1-score': 0.2524772793902082, 'support': 145013}, 'accuracy': 0.46393102819917087, 'macro avg': {'precision': 0.45530202955890436, 'recall': 0.3849932558068907, 'f1-score': 0.35857832692778, 'support': 526824}, 'weighted avg': {'precision': 0.45756248174248054, 'recall': 0.46393102819917087, 'f1-score': 0.401267454142661, 'support': 526824}}
[[ 21330 112122  10253]
 [ 17304 197244  23558]
 [  7283 111894  25836]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0849704
{'0': {'precision': 0.5094692351458994, 'recall': 0.1113136957757151, 'f1-score': 0.1827076764624436, 'support': 168928}, '1': {'precision': 0.3667578216157309, 'recall': 0.8642981851964568, 'f1-score': 0.514985699878791, 'support': 187293}, '2': {'precision': 0.4757323554859709, 'recall': 0.1353610428890465, 'f1-score': 0.21075543589860593, 'support': 170603}, 'accuracy': 0.3867971087118279, 'macro avg': {'precision': 0.4506531374158671, 'recall': 0.3703243079537395, 'f1-score': 0.3028162707466135, 'support': 526824}, 'weighted avg': {'precision': 0.4478082978026337, 'recall': 0.3867971087118279, 'f1-score': 0.3099197619839945, 'support': 526824}}
[[ 18804 139580  10544]
 [ 10511 161877  14905]
 [  7594 139916  23093]]
Evaluating performance on  val set...
681/681 - 6s - 6s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9846514
{'0': {'precision': 0.3618931500775881, 'recall': 0.18401623175336754, 'f1-score': 0.24397534093031947, 'support': 35486}, '1': {'precision': 0.6143096618030655, 'recall': 0.7889041201683593, 'f1-score': 0.6907449591533997, 'support': 103588}, '2': {'precision': 0.3328597261689486, 'recall': 0.2194748048261178, 'f1-score': 0.26452926382782155, 'support': 35225}, 'accuracy': 0.5506744158027298, 'macro avg': {'precision': 0.43635417934986737, 'recall': 0.3974650522492816, 'f1-score': 0.39974985463718027, 'support': 174299}, 'weighted avg': {'precision': 0.5060398133369122, 'recall': 0.5506744158027298, 'f1-score': 0.5136497690484207, 'support': 174299}}
[[ 6530 25829  3127]
 [ 9499 81721 12368]
 [ 2015 25479  7731]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.035181
{'0': {'precision': 0.4251434245366284, 'recall': 0.17128569841093455, 'f1-score': 0.24418991492799774, 'support': 44995}, '1': {'precision': 0.5019905818738208, 'recall': 0.7986599387873273, 'f1-score': 0.6164911496554273, 'support': 84623}, '2': {'precision': 0.4000092863444305, 'recall': 0.1928112620576979, 'f1-score': 0.2602011537648374, 'support': 44681}, 'accuracy': 0.48139690990768735, 'macro avg': {'precision': 0.44238109758495986, 'recall': 0.38758563308531996, 'f1-score': 0.3736274061160875, 'support': 174299}, 'weighted avg': {'precision': 0.4560100305801492, 'recall': 0.48139690990768735, 'f1-score': 0.42904837968573073, 'support': 174299}}
[[ 7707 33677  3611]
 [ 7727 67585  9311]
 [ 2694 33372  8615]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0657817
{'0': {'precision': 0.4608747753145596, 'recall': 0.15033420630887698, 'f1-score': 0.2267153973119547, 'support': 51166}, '1': {'precision': 0.4283601898469395, 'recall': 0.8212720056422951, 'f1-score': 0.5630460443045475, 'support': 72311}, '2': {'precision': 0.44473143218596806, 'recall': 0.16601078273188777, 'f1-score': 0.2417720974882868, 'support': 50822}, 'accuracy': 0.43325549773664795, 'macro avg': {'precision': 0.44465546578248905, 'recall': 0.3792056648943533, 'f1-score': 0.3438445130349297, 'support': 174299}, 'weighted avg': {'precision': 0.4426784622305468, 'recall': 0.43325549773664795, 'f1-score': 0.3706382943511972, 'support': 174299}}
[[ 7692 39891  3583]
 [ 5973 59387  6951]
 [ 3025 39360  8437]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1015959
{'0': {'precision': 0.4986912898066017, 'recall': 0.11643777479756226, 'f1-score': 0.18879453902368534, 'support': 58907}, '1': {'precision': 0.3375327360441075, 'recall': 0.8563135993286008, 'f1-score': 0.4842061553975896, 'support': 57194}, '2': {'precision': 0.48475234703787634, 'recall': 0.12864703254407367, 'f1-score': 0.20333229227489372, 'support': 58198}, 'accuracy': 0.36329525700090076, 'macro avg': {'precision': 0.4403254576295285, 'recall': 0.3671328022234122, 'f1-score': 0.29211099556538955, 'support': 174299}, 'weighted avg': {'precision': 0.4411549819956196, 'recall': 0.36329525700090076, 'f1-score': 0.29058422313319204, 'support': 174299}}
[[ 6859 48522  3526]
 [ 3786 48976  4432]
 [ 3109 47602  7487]]
training model: results/ATVI/W2/deepLOB_L2/seq2seq
Epoch 1/50
2058/2058 - 106s - loss: 11.9904 - accuracy10: 0.4609 - accuracy20: 0.4744 - accuracy30: 0.4757 - accuracy50: 0.4656 - val_loss: 13.9184 - val_accuracy10: 0.3599 - val_accuracy20: 0.3876 - val_accuracy30: 0.4021 - val_accuracy50: 0.4076 - 106s/epoch - 52ms/step
Epoch 2/50
2058/2058 - 96s - loss: 11.3399 - accuracy10: 0.5415 - accuracy20: 0.5407 - accuracy30: 0.5298 - accuracy50: 0.5022 - val_loss: 14.7506 - val_accuracy10: 0.2910 - val_accuracy20: 0.3370 - val_accuracy30: 0.3631 - val_accuracy50: 0.3882 - 96s/epoch - 47ms/step
Epoch 3/50
2058/2058 - 98s - loss: 10.9435 - accuracy10: 0.5838 - accuracy20: 0.5728 - accuracy30: 0.5542 - accuracy50: 0.5191 - val_loss: 14.0688 - val_accuracy10: 0.3452 - val_accuracy20: 0.3767 - val_accuracy30: 0.3927 - val_accuracy50: 0.4082 - 98s/epoch - 48ms/step
Epoch 4/50
2058/2058 - 97s - loss: 10.7783 - accuracy10: 0.5946 - accuracy20: 0.5818 - accuracy30: 0.5624 - accuracy50: 0.5252 - val_loss: 13.4677 - val_accuracy10: 0.3810 - val_accuracy20: 0.4068 - val_accuracy30: 0.4191 - val_accuracy50: 0.4284 - 97s/epoch - 47ms/step
Epoch 5/50
2058/2058 - 100s - loss: 10.6705 - accuracy10: 0.5987 - accuracy20: 0.5868 - accuracy30: 0.5670 - accuracy50: 0.5290 - val_loss: 13.5098 - val_accuracy10: 0.4064 - val_accuracy20: 0.4243 - val_accuracy30: 0.4305 - val_accuracy50: 0.4339 - 100s/epoch - 49ms/step
Epoch 6/50
2058/2058 - 97s - loss: 10.5999 - accuracy10: 0.6017 - accuracy20: 0.5898 - accuracy30: 0.5699 - accuracy50: 0.5316 - val_loss: 13.1476 - val_accuracy10: 0.4216 - val_accuracy20: 0.4367 - val_accuracy30: 0.4410 - val_accuracy50: 0.4418 - 97s/epoch - 47ms/step
Epoch 7/50
2058/2058 - 100s - loss: 10.5505 - accuracy10: 0.6034 - accuracy20: 0.5917 - accuracy30: 0.5714 - accuracy50: 0.5331 - val_loss: 12.7872 - val_accuracy10: 0.4331 - val_accuracy20: 0.4478 - val_accuracy30: 0.4518 - val_accuracy50: 0.4492 - 100s/epoch - 49ms/step
Epoch 8/50
2058/2058 - 102s - loss: 10.5089 - accuracy10: 0.6065 - accuracy20: 0.5934 - accuracy30: 0.5734 - accuracy50: 0.5349 - val_loss: 12.7931 - val_accuracy10: 0.4442 - val_accuracy20: 0.4567 - val_accuracy30: 0.4596 - val_accuracy50: 0.4545 - 102s/epoch - 49ms/step
Epoch 9/50
2058/2058 - 105s - loss: 10.4804 - accuracy10: 0.6075 - accuracy20: 0.5943 - accuracy30: 0.5749 - accuracy50: 0.5363 - val_loss: 12.4228 - val_accuracy10: 0.4659 - val_accuracy20: 0.4732 - val_accuracy30: 0.4733 - val_accuracy50: 0.4655 - 105s/epoch - 51ms/step
Epoch 10/50
2058/2058 - 100s - loss: 10.4495 - accuracy10: 0.6088 - accuracy20: 0.5960 - accuracy30: 0.5765 - accuracy50: 0.5379 - val_loss: 12.2872 - val_accuracy10: 0.4616 - val_accuracy20: 0.4709 - val_accuracy30: 0.4711 - val_accuracy50: 0.4655 - 100s/epoch - 48ms/step
Epoch 11/50
2058/2058 - 100s - loss: 10.4219 - accuracy10: 0.6106 - accuracy20: 0.5972 - accuracy30: 0.5777 - accuracy50: 0.5387 - val_loss: 12.2612 - val_accuracy10: 0.4656 - val_accuracy20: 0.4737 - val_accuracy30: 0.4756 - val_accuracy50: 0.4696 - 100s/epoch - 49ms/step
Epoch 12/50
2058/2058 - 95s - loss: 10.4008 - accuracy10: 0.6113 - accuracy20: 0.5977 - accuracy30: 0.5785 - accuracy50: 0.5399 - val_loss: 12.0835 - val_accuracy10: 0.4750 - val_accuracy20: 0.4834 - val_accuracy30: 0.4855 - val_accuracy50: 0.4767 - 95s/epoch - 46ms/step
Epoch 13/50
2058/2058 - 96s - loss: 10.3788 - accuracy10: 0.6126 - accuracy20: 0.5986 - accuracy30: 0.5792 - accuracy50: 0.5409 - val_loss: 12.1511 - val_accuracy10: 0.4808 - val_accuracy20: 0.4866 - val_accuracy30: 0.4860 - val_accuracy50: 0.4754 - 96s/epoch - 47ms/step
Epoch 14/50
2058/2058 - 98s - loss: 10.3555 - accuracy10: 0.6131 - accuracy20: 0.5996 - accuracy30: 0.5805 - accuracy50: 0.5419 - val_loss: 12.0647 - val_accuracy10: 0.4945 - val_accuracy20: 0.4962 - val_accuracy30: 0.4941 - val_accuracy50: 0.4802 - 98s/epoch - 47ms/step
Epoch 15/50
2058/2058 - 99s - loss: 10.3367 - accuracy10: 0.6139 - accuracy20: 0.6002 - accuracy30: 0.5809 - accuracy50: 0.5425 - val_loss: 12.0547 - val_accuracy10: 0.4922 - val_accuracy20: 0.4943 - val_accuracy30: 0.4924 - val_accuracy50: 0.4794 - 99s/epoch - 48ms/step
Epoch 16/50
2058/2058 - 96s - loss: 10.3148 - accuracy10: 0.6148 - accuracy20: 0.6018 - accuracy30: 0.5827 - accuracy50: 0.5444 - val_loss: 12.1071 - val_accuracy10: 0.4875 - val_accuracy20: 0.4896 - val_accuracy30: 0.4872 - val_accuracy50: 0.4758 - 96s/epoch - 46ms/step
Epoch 17/50
2058/2058 - 98s - loss: 10.2970 - accuracy10: 0.6150 - accuracy20: 0.6027 - accuracy30: 0.5835 - accuracy50: 0.5456 - val_loss: 12.0589 - val_accuracy10: 0.4960 - val_accuracy20: 0.4972 - val_accuracy30: 0.4935 - val_accuracy50: 0.4782 - 98s/epoch - 47ms/step
Epoch 18/50
2058/2058 - 96s - loss: 10.2798 - accuracy10: 0.6156 - accuracy20: 0.6028 - accuracy30: 0.5844 - accuracy50: 0.5463 - val_loss: 12.1406 - val_accuracy10: 0.5021 - val_accuracy20: 0.4986 - val_accuracy30: 0.4931 - val_accuracy50: 0.4770 - 96s/epoch - 47ms/step
Epoch 19/50
2058/2058 - 95s - loss: 10.2627 - accuracy10: 0.6160 - accuracy20: 0.6037 - accuracy30: 0.5855 - accuracy50: 0.5473 - val_loss: 12.1440 - val_accuracy10: 0.4973 - val_accuracy20: 0.4937 - val_accuracy30: 0.4869 - val_accuracy50: 0.4722 - 95s/epoch - 46ms/step
Epoch 20/50
2058/2058 - 96s - loss: 10.2451 - accuracy10: 0.6164 - accuracy20: 0.6039 - accuracy30: 0.5859 - accuracy50: 0.5482 - val_loss: 12.0426 - val_accuracy10: 0.5147 - val_accuracy20: 0.5073 - val_accuracy30: 0.4982 - val_accuracy50: 0.4808 - 96s/epoch - 47ms/step
Epoch 21/50
2058/2058 - 98s - loss: 10.2245 - accuracy10: 0.6174 - accuracy20: 0.6053 - accuracy30: 0.5872 - accuracy50: 0.5493 - val_loss: 12.2347 - val_accuracy10: 0.4863 - val_accuracy20: 0.4858 - val_accuracy30: 0.4812 - val_accuracy50: 0.4704 - 98s/epoch - 48ms/step
Epoch 22/50
2058/2058 - 96s - loss: 10.2071 - accuracy10: 0.6174 - accuracy20: 0.6060 - accuracy30: 0.5877 - accuracy50: 0.5503 - val_loss: 12.3125 - val_accuracy10: 0.4900 - val_accuracy20: 0.4844 - val_accuracy30: 0.4774 - val_accuracy50: 0.4657 - 96s/epoch - 47ms/step
Epoch 23/50
2058/2058 - 98s - loss: 10.1902 - accuracy10: 0.6175 - accuracy20: 0.6059 - accuracy30: 0.5881 - accuracy50: 0.5509 - val_loss: 12.4867 - val_accuracy10: 0.4732 - val_accuracy20: 0.4721 - val_accuracy30: 0.4691 - val_accuracy50: 0.4605 - 98s/epoch - 48ms/step
Epoch 24/50
2058/2058 - 96s - loss: 10.1729 - accuracy10: 0.6181 - accuracy20: 0.6072 - accuracy30: 0.5893 - accuracy50: 0.5523 - val_loss: 12.3945 - val_accuracy10: 0.4907 - val_accuracy20: 0.4843 - val_accuracy30: 0.4787 - val_accuracy50: 0.4661 - 96s/epoch - 47ms/step
Epoch 25/50
2058/2058 - 98s - loss: 10.1539 - accuracy10: 0.6190 - accuracy20: 0.6075 - accuracy30: 0.5906 - accuracy50: 0.5530 - val_loss: 12.6080 - val_accuracy10: 0.4788 - val_accuracy20: 0.4766 - val_accuracy30: 0.4743 - val_accuracy50: 0.4634 - 98s/epoch - 47ms/step
Epoch 26/50
2058/2058 - 97s - loss: 10.1392 - accuracy10: 0.6197 - accuracy20: 0.6089 - accuracy30: 0.5916 - accuracy50: 0.5540 - val_loss: 12.6313 - val_accuracy10: 0.4865 - val_accuracy20: 0.4828 - val_accuracy30: 0.4768 - val_accuracy50: 0.4638 - 97s/epoch - 47ms/step
Epoch 27/50
2058/2058 - 96s - loss: 10.1228 - accuracy10: 0.6196 - accuracy20: 0.6088 - accuracy30: 0.5923 - accuracy50: 0.5552 - val_loss: 12.5088 - val_accuracy10: 0.4813 - val_accuracy20: 0.4775 - val_accuracy30: 0.4729 - val_accuracy50: 0.4633 - 96s/epoch - 47ms/step
Epoch 28/50
2058/2058 - 96s - loss: 10.1049 - accuracy10: 0.6201 - accuracy20: 0.6099 - accuracy30: 0.5931 - accuracy50: 0.5566 - val_loss: 12.5492 - val_accuracy10: 0.4844 - val_accuracy20: 0.4827 - val_accuracy30: 0.4787 - val_accuracy50: 0.4671 - 96s/epoch - 47ms/step
Epoch 29/50
2058/2058 - 100s - loss: 10.0918 - accuracy10: 0.6201 - accuracy20: 0.6099 - accuracy30: 0.5929 - accuracy50: 0.5570 - val_loss: 12.5039 - val_accuracy10: 0.4968 - val_accuracy20: 0.4911 - val_accuracy30: 0.4856 - val_accuracy50: 0.4707 - 100s/epoch - 48ms/step
Epoch 30/50
2058/2058 - 97s - loss: 10.0737 - accuracy10: 0.6205 - accuracy20: 0.6112 - accuracy30: 0.5948 - accuracy50: 0.5580 - val_loss: 12.7790 - val_accuracy10: 0.4825 - val_accuracy20: 0.4789 - val_accuracy30: 0.4744 - val_accuracy50: 0.4628 - 97s/epoch - 47ms/step
testing model: results/ATVI/W2/deepLOB_L2/seq2seq
Evaluating performance on  test set...
5497/5497 - 91s - 91s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9140662
{'0': {'precision': 0.4018421911899826, 'recall': 0.5816851454240344, 'f1-score': 0.4753210708399264, 'support': 272926}, '1': {'precision': 0.813303584739794, 'recall': 0.5464100069652715, 'f1-score': 0.6536629774293601, 'support': 868595}, '2': {'precision': 0.34185234185234187, 'recall': 0.5514453477868112, 'f1-score': 0.4220606092032997, 'support': 265680}, 'accuracy': 0.5542022781393703, 'macro avg': {'precision': 0.5189993725940395, 'recall': 0.5598468333920391, 'f1-score': 0.5170148858241954, 'support': 1407201}, 'weighted avg': {'precision': 0.6444906870042794, 'recall': 0.5542022781393703, 'f1-score': 0.5753470436088699, 'support': 1407201}}
[[158757  66611  47558]
 [159481 474609 234505]
 [ 76835  42337 146508]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.94449717
{'0': {'precision': 0.44936746564488955, 'recall': 0.5462329213505928, 'f1-score': 0.4930880034305048, 'support': 345241}, '1': {'precision': 0.7225173658930465, 'recall': 0.5316671664334421, 'f1-score': 0.612571357279842, 'support': 720336}, '2': {'precision': 0.4023188000297282, 'recall': 0.5387560592932581, 'f1-score': 0.46064707634319524, 'support': 341624}, 'accuracy': 0.5369616707208139, 'macro avg': {'precision': 0.524734543855888, 'recall': 0.5388853823590977, 'f1-score': 0.5221021456845141, 'support': 1407201}, 'weighted avg': {'precision': 0.5777689898074239, 'recall': 0.5369616707208139, 'f1-score': 0.5463750334305838, 'support': 1407201}}
[[188582  86253  70406]
 [134337 382979 203020]
 [ 96742  60830 184052]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.96348983
{'0': {'precision': 0.47243965965503815, 'recall': 0.5151145348689395, 'f1-score': 0.4928550491432019, 'support': 393330}, '1': {'precision': 0.6482581416193606, 'recall': 0.5242574879429379, 'f1-score': 0.5797009034170253, 'support': 620798}, '2': {'precision': 0.43593635836839584, 'recall': 0.5282301251930303, 'f1-score': 0.4776658825694616, 'support': 393073}, 'accuracy': 0.5228115955005717, 'macro avg': {'precision': 0.5188780532142648, 'recall': 0.5225340493349693, 'f1-score': 0.5167406117098962, 'support': 1407201}, 'weighted avg': {'precision': 0.5398069368384988, 'recall': 0.5228115955005717, 'f1-score': 0.526925008849627, 'support': 1407201}}
[[202610  99926  90794]
 [117475 325458 177865]
 [108774  76666 207633]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.99849683
{'0': {'precision': 0.4928113115098346, 'recall': 0.46194963945383327, 'f1-score': 0.47688168947622134, 'support': 457223}, '1': {'precision': 0.5261644952304678, 'recall': 0.5252062795449818, 'f1-score': 0.5256849507304951, 'support': 490354}, '2': {'precision': 0.4681038536236328, 'recall': 0.4981745948862549, 'f1-score': 0.48267132109438077, 'support': 459624}, 'accuracy': 0.49582397965891156, 'macro avg': {'precision': 0.49569322012131173, 'recall': 0.49511017129502327, 'f1-score': 0.495079320433699, 'support': 1407201}, 'weighted avg': {'precision': 0.49636355914656866, 'recall': 0.49582397965891156, 'f1-score': 0.4957787255158085, 'support': 1407201}}
[[211214 126257 119752]
 [ 92392 257537 140425]
 [124984 105667 228973]]
Evaluating performance on  train set...
2058/2058 - 33s - 33s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.93168586
{'0': {'precision': 0.44603139312552803, 'recall': 0.524053331104238, 'f1-score': 0.4819047893576236, 'support': 95704}, '1': {'precision': 0.8255455425634914, 'recall': 0.4978173391298099, 'f1-score': 0.6211008197593952, 'support': 333996}, '2': {'precision': 0.3122446871449097, 'recall': 0.6846917342778304, 'f1-score': 0.42889667137485565, 'support': 97124}, 'accuracy': 0.5370351388699072, 'macro avg': {'precision': 0.527940540944643, 'recall': 0.5688541348372927, 'f1-score': 0.5106340934972915, 'support': 526824}, 'weighted avg': {'precision': 0.6619712664494853, 'recall': 0.5370351388699072, 'f1-score': 0.560379871964171, 'support': 526824}}
[[ 50154  22813  22737]
 [ 43990 166269 123737]
 [ 18301  12323  66500]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.95611894
{'0': {'precision': 0.5042117322012197, 'recall': 0.48164211170028726, 'f1-score': 0.4926685734274368, 'support': 124279}, '1': {'precision': 0.7360807298189368, 'recall': 0.47754462367338685, 'f1-score': 0.5792749699948312, 'support': 276927}, '2': {'precision': 0.3693504401458544, 'recall': 0.6716951392316388, 'f1-score': 0.4766186999562228, 'support': 125618}, 'accuracy': 0.5248052480524805, 'macro avg': {'precision': 0.5365476340553369, 'recall': 0.5436272915351043, 'f1-score': 0.5161874144594969, 'support': 526824}, 'weighted avg': {'precision': 0.5939376750547547, 'recall': 0.5248052480524805, 'f1-score': 0.5343665533533928, 'support': 526824}}
[[ 59858  29926  34495]
 [ 35107 132245 109575]
 [ 23751  17490  84377]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9735378
{'0': {'precision': 0.5276946353978226, 'recall': 0.44647752097624777, 'f1-score': 0.48370052685927045, 'support': 143734}, '1': {'precision': 0.6595285984415084, 'recall': 0.46010427125650644, 'f1-score': 0.542056121022245, 'support': 238033}, '2': {'precision': 0.40041981317477443, 'recall': 0.6601680718614062, 'f1-score': 0.4984865087152633, 'support': 145057}, 'accuracy': 0.5114725221326287, 'macro avg': {'precision': 0.5292143490047018, 'recall': 0.5222499546980535, 'f1-score': 0.5080810521989262, 'support': 526824}, 'weighted avg': {'precision': 0.5522165437352728, 'recall': 0.5114725221326287, 'f1-score': 0.5141383340120957, 'support': 526824}}
[[ 64174  34764  44796]
 [ 29917 109520  98596]
 [ 27521  21774  95762]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0049462
{'0': {'precision': 0.5406971495169856, 'recall': 0.39016156543163083, 'f1-score': 0.4532572836074541, 'support': 168848}, '1': {'precision': 0.5330258140032472, 'recall': 0.4521679247498959, 'f1-score': 0.48927874117633474, 'support': 187322}, '2': {'precision': 0.4364980351838231, 'recall': 0.629419761622933, 'f1-score': 0.5155003323470903, 'support': 170654}, 'accuracy': 0.4897119341563786, 'macro avg': {'precision': 0.5034069995680186, 'recall': 0.49058308393482, 'f1-score': 0.48601211904362634, 'support': 526824}, 'weighted avg': {'precision': 0.5042162648790115, 'recall': 0.4897119341563786, 'f1-score': 0.48622775707550364, 'support': 526824}}
[[ 65878  43655  59315]
 [ 23270  84701  79351]
 [ 32691  30550 107413]]
Evaluating performance on  val set...
681/681 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9745439
{'0': {'precision': 0.445383032796805, 'recall': 0.5186155970801274, 'f1-score': 0.47921766758685347, 'support': 35481}, '1': {'precision': 0.805039479795634, 'recall': 0.4682244884176403, 'f1-score': 0.5920833511251548, 'support': 103649}, '2': {'precision': 0.31121045392022006, 'recall': 0.6433222440217237, 'f1-score': 0.41949030768802903, 'support': 35169}, 'accuracy': 0.5138124716722414, 'macro avg': {'precision': 0.5205443221708864, 'recall': 0.5433874431731638, 'f1-score': 0.49693044213334575, 'support': 174299}, 'weighted avg': {'precision': 0.6321845385339061, 'recall': 0.5138124716722414, 'f1-score': 0.5342831797973632, 'support': 174299}}
[[18401  8063  9017]
 [14060 48531 41058]
 [ 8854  3690 22625]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.98390347
{'0': {'precision': 0.49764018691588785, 'recall': 0.4736795285221839, 'f1-score': 0.48536432518657785, 'support': 44965}, '1': {'precision': 0.7091379215492105, 'recall': 0.45664958314635934, 'f1-score': 0.5555515648682234, 'support': 84682}, '2': {'precision': 0.3700498908637356, 'recall': 0.6378661650094061, 'f1-score': 0.46837691169215584, 'support': 44652}, 'accuracy': 0.5074670537409853, 'macro avg': {'precision': 0.5256093331096113, 'recall': 0.5227317588926498, 'f1-score': 0.503097600582319, 'support': 174299}, 'weighted avg': {'precision': 0.5677088004185376, 'recall': 0.5074670537409853, 'f1-score': 0.5151124811907327, 'support': 174299}}
[[21299 10491 13175]
 [10701 38670 35311]
 [10800  5370 28482]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.98922306
{'0': {'precision': 0.5178417834809494, 'recall': 0.43531618854060816, 'f1-score': 0.4730064020214675, 'support': 51172}, '1': {'precision': 0.6318820279366562, 'recall': 0.4491957901724591, 'f1-score': 0.525103266536792, 'support': 72307}, '2': {'precision': 0.40284176264396593, 'recall': 0.6331955922865014, 'f1-score': 0.49241009946442227, 'support': 50820}, 'accuracy': 0.4987693561064607, 'macro avg': {'precision': 0.5175218580205239, 'recall': 0.5059025236665229, 'f1-score': 0.4968399226742273, 'support': 174299}, 'weighted avg': {'precision': 0.5316204448440284, 'recall': 0.4987693561064607, 'f1-score': 0.5002760013109673, 'support': 174299}}
[[22276 12131 16765]
 [ 8891 32480 30936]
 [11850  6791 32179]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0130194
{'0': {'precision': 0.5253488535165837, 'recall': 0.3815894466986978, 'f1-score': 0.4420754494315723, 'support': 58901}, '1': {'precision': 0.5134653147918086, 'recall': 0.4479112043349065, 'f1-score': 0.47845326561858176, 'support': 57210}, '2': {'precision': 0.43476289670383533, 'recall': 0.6097648999793772, 'f1-score': 0.5076038283809496, 'support': 58188}, 'accuracy': 0.4795322979477794, 'macro avg': {'precision': 0.4911923550040758, 'recall': 0.47975518367099385, 'f1-score': 0.47604418114370123, 'support': 174299}, 'weighted avg': {'precision': 0.49120710338913265, 'recall': 0.4795322979477794, 'f1-score': 0.475891708723738, 'support': 174299}}
[[22476 14793 21632]
 [ 7088 25625 24497]
 [13219  9488 35481]]
training model: results/ATVI/W2/deepOF_L2/seq2seq
Epoch 1/50
2058/2058 - 67s - loss: 11.4672 - accuracy10: 0.5494 - accuracy20: 0.5434 - accuracy30: 0.5281 - accuracy50: 0.4952 - val_loss: 11.8021 - val_accuracy10: 0.6062 - val_accuracy20: 0.5786 - val_accuracy30: 0.5479 - val_accuracy50: 0.4922 - 67s/epoch - 32ms/step
Epoch 2/50
2058/2058 - 61s - loss: 10.9130 - accuracy10: 0.5897 - accuracy20: 0.5775 - accuracy30: 0.5581 - accuracy50: 0.5198 - val_loss: 11.5690 - val_accuracy10: 0.6037 - val_accuracy20: 0.5793 - val_accuracy30: 0.5507 - val_accuracy50: 0.4975 - 61s/epoch - 30ms/step
Epoch 3/50
2058/2058 - 62s - loss: 10.8024 - accuracy10: 0.5966 - accuracy20: 0.5823 - accuracy30: 0.5622 - accuracy50: 0.5235 - val_loss: 11.5132 - val_accuracy10: 0.5988 - val_accuracy20: 0.5777 - val_accuracy30: 0.5500 - val_accuracy50: 0.4981 - 62s/epoch - 30ms/step
Epoch 4/50
2058/2058 - 60s - loss: 10.7334 - accuracy10: 0.5994 - accuracy20: 0.5859 - accuracy30: 0.5655 - accuracy50: 0.5268 - val_loss: 11.5144 - val_accuracy10: 0.6077 - val_accuracy20: 0.5835 - val_accuracy30: 0.5541 - val_accuracy50: 0.5000 - 60s/epoch - 29ms/step
Epoch 5/50
2058/2058 - 60s - loss: 10.6849 - accuracy10: 0.6004 - accuracy20: 0.5866 - accuracy30: 0.5665 - accuracy50: 0.5280 - val_loss: 11.5574 - val_accuracy10: 0.5893 - val_accuracy20: 0.5715 - val_accuracy30: 0.5465 - val_accuracy50: 0.5000 - 60s/epoch - 29ms/step
Epoch 6/50
2058/2058 - 60s - loss: 10.6418 - accuracy10: 0.6023 - accuracy20: 0.5891 - accuracy30: 0.5686 - accuracy50: 0.5300 - val_loss: 11.5221 - val_accuracy10: 0.5858 - val_accuracy20: 0.5701 - val_accuracy30: 0.5450 - val_accuracy50: 0.5006 - 60s/epoch - 29ms/step
Epoch 7/50
2058/2058 - 59s - loss: 10.6043 - accuracy10: 0.6025 - accuracy20: 0.5902 - accuracy30: 0.5697 - accuracy50: 0.5315 - val_loss: 11.4683 - val_accuracy10: 0.5963 - val_accuracy20: 0.5768 - val_accuracy30: 0.5506 - val_accuracy50: 0.5027 - 59s/epoch - 29ms/step
Epoch 8/50
2058/2058 - 57s - loss: 10.5697 - accuracy10: 0.6036 - accuracy20: 0.5917 - accuracy30: 0.5709 - accuracy50: 0.5327 - val_loss: 11.5017 - val_accuracy10: 0.5791 - val_accuracy20: 0.5650 - val_accuracy30: 0.5424 - val_accuracy50: 0.5013 - 57s/epoch - 28ms/step
Epoch 9/50
2058/2058 - 59s - loss: 10.5415 - accuracy10: 0.6045 - accuracy20: 0.5926 - accuracy30: 0.5722 - accuracy50: 0.5341 - val_loss: 11.5354 - val_accuracy10: 0.5817 - val_accuracy20: 0.5656 - val_accuracy30: 0.5429 - val_accuracy50: 0.5022 - 59s/epoch - 29ms/step
Epoch 10/50
2058/2058 - 60s - loss: 10.5158 - accuracy10: 0.6057 - accuracy20: 0.5938 - accuracy30: 0.5739 - accuracy50: 0.5356 - val_loss: 11.4182 - val_accuracy10: 0.5880 - val_accuracy20: 0.5707 - val_accuracy30: 0.5467 - val_accuracy50: 0.5053 - 60s/epoch - 29ms/step
Epoch 11/50
2058/2058 - 59s - loss: 10.4956 - accuracy10: 0.6052 - accuracy20: 0.5947 - accuracy30: 0.5747 - accuracy50: 0.5365 - val_loss: 11.4440 - val_accuracy10: 0.5907 - val_accuracy20: 0.5736 - val_accuracy30: 0.5503 - val_accuracy50: 0.5051 - 59s/epoch - 29ms/step
Epoch 12/50
2058/2058 - 59s - loss: 10.4723 - accuracy10: 0.6059 - accuracy20: 0.5948 - accuracy30: 0.5749 - accuracy50: 0.5370 - val_loss: 11.4537 - val_accuracy10: 0.5846 - val_accuracy20: 0.5696 - val_accuracy30: 0.5470 - val_accuracy50: 0.5057 - 59s/epoch - 29ms/step
Epoch 13/50
2058/2058 - 59s - loss: 10.4519 - accuracy10: 0.6055 - accuracy20: 0.5957 - accuracy30: 0.5762 - accuracy50: 0.5381 - val_loss: 11.4272 - val_accuracy10: 0.5897 - val_accuracy20: 0.5733 - val_accuracy30: 0.5497 - val_accuracy50: 0.5071 - 59s/epoch - 29ms/step
Epoch 14/50
2058/2058 - 58s - loss: 10.4313 - accuracy10: 0.6067 - accuracy20: 0.5966 - accuracy30: 0.5770 - accuracy50: 0.5391 - val_loss: 11.4586 - val_accuracy10: 0.5777 - val_accuracy20: 0.5641 - val_accuracy30: 0.5433 - val_accuracy50: 0.5041 - 58s/epoch - 28ms/step
Epoch 15/50
2058/2058 - 60s - loss: 10.4124 - accuracy10: 0.6069 - accuracy20: 0.5973 - accuracy30: 0.5777 - accuracy50: 0.5405 - val_loss: 11.4243 - val_accuracy10: 0.5739 - val_accuracy20: 0.5632 - val_accuracy30: 0.5439 - val_accuracy50: 0.5063 - 60s/epoch - 29ms/step
Epoch 16/50
2058/2058 - 59s - loss: 10.3904 - accuracy10: 0.6068 - accuracy20: 0.5979 - accuracy30: 0.5788 - accuracy50: 0.5413 - val_loss: 11.4318 - val_accuracy10: 0.5852 - val_accuracy20: 0.5697 - val_accuracy30: 0.5479 - val_accuracy50: 0.5069 - 59s/epoch - 29ms/step
Epoch 17/50
2058/2058 - 61s - loss: 10.3761 - accuracy10: 0.6075 - accuracy20: 0.5989 - accuracy30: 0.5799 - accuracy50: 0.5423 - val_loss: 11.3547 - val_accuracy10: 0.5803 - val_accuracy20: 0.5663 - val_accuracy30: 0.5460 - val_accuracy50: 0.5075 - 61s/epoch - 29ms/step
Epoch 18/50
2058/2058 - 58s - loss: 10.3611 - accuracy10: 0.6078 - accuracy20: 0.5990 - accuracy30: 0.5805 - accuracy50: 0.5432 - val_loss: 11.3479 - val_accuracy10: 0.5869 - val_accuracy20: 0.5707 - val_accuracy30: 0.5489 - val_accuracy50: 0.5090 - 58s/epoch - 28ms/step
Epoch 19/50
2058/2058 - 59s - loss: 10.3381 - accuracy10: 0.6090 - accuracy20: 0.6001 - accuracy30: 0.5816 - accuracy50: 0.5442 - val_loss: 11.3434 - val_accuracy10: 0.5842 - val_accuracy20: 0.5680 - val_accuracy30: 0.5469 - val_accuracy50: 0.5074 - 59s/epoch - 29ms/step
Epoch 20/50
2058/2058 - 58s - loss: 10.3234 - accuracy10: 0.6092 - accuracy20: 0.6009 - accuracy30: 0.5825 - accuracy50: 0.5450 - val_loss: 11.4277 - val_accuracy10: 0.5850 - val_accuracy20: 0.5677 - val_accuracy30: 0.5460 - val_accuracy50: 0.5065 - 58s/epoch - 28ms/step
Epoch 21/50
2058/2058 - 60s - loss: 10.3098 - accuracy10: 0.6101 - accuracy20: 0.6014 - accuracy30: 0.5827 - accuracy50: 0.5463 - val_loss: 11.4030 - val_accuracy10: 0.5944 - val_accuracy20: 0.5741 - val_accuracy30: 0.5502 - val_accuracy50: 0.5073 - 60s/epoch - 29ms/step
Epoch 22/50
2058/2058 - 59s - loss: 10.2923 - accuracy10: 0.6104 - accuracy20: 0.6023 - accuracy30: 0.5840 - accuracy50: 0.5469 - val_loss: 11.3706 - val_accuracy10: 0.5929 - val_accuracy20: 0.5742 - val_accuracy30: 0.5510 - val_accuracy50: 0.5078 - 59s/epoch - 29ms/step
Epoch 23/50
2058/2058 - 60s - loss: 10.2752 - accuracy10: 0.6106 - accuracy20: 0.6024 - accuracy30: 0.5846 - accuracy50: 0.5481 - val_loss: 11.4083 - val_accuracy10: 0.5910 - val_accuracy20: 0.5719 - val_accuracy30: 0.5489 - val_accuracy50: 0.5065 - 60s/epoch - 29ms/step
Epoch 24/50
2058/2058 - 58s - loss: 10.2608 - accuracy10: 0.6114 - accuracy20: 0.6032 - accuracy30: 0.5850 - accuracy50: 0.5482 - val_loss: 11.3744 - val_accuracy10: 0.5891 - val_accuracy20: 0.5719 - val_accuracy30: 0.5488 - val_accuracy50: 0.5071 - 58s/epoch - 28ms/step
Epoch 25/50
2058/2058 - 59s - loss: 10.2453 - accuracy10: 0.6122 - accuracy20: 0.6044 - accuracy30: 0.5866 - accuracy50: 0.5499 - val_loss: 11.3462 - val_accuracy10: 0.5864 - val_accuracy20: 0.5712 - val_accuracy30: 0.5490 - val_accuracy50: 0.5084 - 59s/epoch - 28ms/step
Epoch 26/50
2058/2058 - 59s - loss: 10.2321 - accuracy10: 0.6121 - accuracy20: 0.6048 - accuracy30: 0.5873 - accuracy50: 0.5512 - val_loss: 11.4126 - val_accuracy10: 0.5926 - val_accuracy20: 0.5724 - val_accuracy30: 0.5494 - val_accuracy50: 0.5074 - 59s/epoch - 29ms/step
Epoch 27/50
2058/2058 - 59s - loss: 10.2162 - accuracy10: 0.6130 - accuracy20: 0.6051 - accuracy30: 0.5876 - accuracy50: 0.5515 - val_loss: 11.3573 - val_accuracy10: 0.5921 - val_accuracy20: 0.5719 - val_accuracy30: 0.5487 - val_accuracy50: 0.5080 - 59s/epoch - 29ms/step
Epoch 28/50
2058/2058 - 58s - loss: 10.2028 - accuracy10: 0.6141 - accuracy20: 0.6061 - accuracy30: 0.5888 - accuracy50: 0.5525 - val_loss: 11.4206 - val_accuracy10: 0.5964 - val_accuracy20: 0.5739 - val_accuracy30: 0.5497 - val_accuracy50: 0.5059 - 58s/epoch - 28ms/step
Epoch 29/50
2058/2058 - 58s - loss: 10.1848 - accuracy10: 0.6139 - accuracy20: 0.6069 - accuracy30: 0.5902 - accuracy50: 0.5537 - val_loss: 11.4389 - val_accuracy10: 0.5833 - val_accuracy20: 0.5654 - val_accuracy30: 0.5425 - val_accuracy50: 0.5058 - 58s/epoch - 28ms/step
testing model: results/ATVI/W2/deepOF_L2/seq2seq
Evaluating performance on  test set...
5497/5497 - 55s - 55s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8509144
{'0': {'precision': 0.42385166411274716, 'recall': 0.5857873042044518, 'f1-score': 0.4918330838933556, 'support': 272925}, '1': {'precision': 0.8226973931806207, 'recall': 0.6040152246043606, 'f1-score': 0.6965968402170608, 'support': 868594}, '2': {'precision': 0.3956271699729279, 'recall': 0.5841642294967198, 'f1-score': 0.47175601059634054, 'support': 265677}, 'accuracy': 0.5967320828086493, 'macro avg': {'precision': 0.5473920757554319, 'recall': 0.5913222527685108, 'f1-score': 0.553395311568919, 'support': 1407196}, 'weighted avg': {'precision': 0.6647110811835717, 'recall': 0.5967320828086493, 'f1-score': 0.6144333141085505, 'support': 1407196}}
[[159876  65459  47590]
 [154453 524644 189497]
 [ 62869  47609 155199]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.88571626
{'0': {'precision': 0.4715899011095398, 'recall': 0.5389844745684161, 'f1-score': 0.5030399368493332, 'support': 345240}, '1': {'precision': 0.7264047913797589, 'recall': 0.6085015999500233, 'f1-score': 0.6622464026494389, 'support': 720335}, '2': {'precision': 0.4585032783399845, 'recall': 0.5492051132687978, 'f1-score': 0.4997722496144226, 'support': 341621}, 'accuracy': 0.577051100202104, 'macro avg': {'precision': 0.5521659902764278, 'recall': 0.5655637292624124, 'f1-score': 0.5550195297043983, 'support': 1407196}, 'weighted avg': {'precision': 0.5988510778224071, 'recall': 0.577051100202104, 'f1-score': 0.5837434628409093, 'support': 1407196}}
[[186079  92011  67150]
 [127579 438325 154431]
 [ 80920  73081 187620]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9179877
{'0': {'precision': 0.4898458921685069, 'recall': 0.5096078062472351, 'f1-score': 0.4995314758510691, 'support': 393326}, '1': {'precision': 0.6487065191573173, 'recall': 0.602706516451406, 'f1-score': 0.6248610734192012, 'support': 620798}, '2': {'precision': 0.4870579856371298, 'recall': 0.5219425448772744, 'f1-score': 0.50389722668756, 'support': 393072}, 'accuracy': 0.5541246564089153, 'macro avg': {'precision': 0.5418701323209846, 'recall': 0.5447522891919719, 'f1-score': 0.54276325865261, 'support': 1407196}, 'weighted avg': {'precision': 0.5591500342477184, 'recall': 0.5541246564089153, 'f1-score': 0.5560413138010792, 'support': 1407196}}
[[200442 110070  82814]
 [113389 374159 133250]
 [ 95363  92548 205161]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9675515
{'0': {'precision': 0.5029080753461287, 'recall': 0.4627652710614779, 'f1-score': 0.4820023099370576, 'support': 457221}, '1': {'precision': 0.525426880509217, 'recall': 0.5992935715829788, 'f1-score': 0.5599346063998841, 'support': 490354}, '2': {'precision': 0.5108232809979845, 'recall': 0.4747694295952535, 'f1-score': 0.4921369144408786, 'support': 459621}, 'accuracy': 0.5142609842552139, 'macro avg': {'precision': 0.5130527456177767, 'recall': 0.5122760907465701, 'f1-score': 0.5113579435926067, 'support': 1407196}, 'weighted avg': {'precision': 0.5133402972426183, 'recall': 0.5142609842552139, 'f1-score': 0.5124689189640756, 'support': 1407196}}
[[211586 139797 105838]
 [ 93359 293866 103129]
 [115780 125627 218214]]
Evaluating performance on  train set...
2058/2058 - 20s - 20s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8245334
{'0': {'precision': 0.43945565707009104, 'recall': 0.5986039853293069, 'f1-score': 0.5068300451207643, 'support': 95701}, '1': {'precision': 0.8332030012471778, 'recall': 0.6219411076221237, 'f1-score': 0.7122362579915329, 'support': 334067}, '2': {'precision': 0.4019659827874536, 'recall': 0.6092359050445104, 'f1-score': 0.48435848917504243, 'support': 97056}, 'accuracy': 0.6153611073147769, 'macro avg': {'precision': 0.5582082137015741, 'recall': 0.6099269993319804, 'f1-score': 0.5678082640957799, 'support': 526824}, 'weighted avg': {'precision': 0.6822300868607445, 'recall': 0.6153611073147769, 'f1-score': 0.632941304253285, 'support': 526824}}
[[ 57287  22267  16147]
 [ 54472 207770  71825]
 [ 18600  19326  59130]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.85678
{'0': {'precision': 0.5017249301640325, 'recall': 0.5532989616093045, 'f1-score': 0.5262513674579435, 'support': 124327}, '1': {'precision': 0.7380421534528375, 'recall': 0.6277642520174254, 'f1-score': 0.6784511751650854, 'support': 276838}, '2': {'precision': 0.46587225435025026, 'recall': 0.5718492109598198, 'f1-score': 0.5134493020796491, 'support': 125659}, 'accuracy': 0.5968539777990373, 'macro avg': {'precision': 0.56854644598904, 'recall': 0.5843041415288499, 'f1-score': 0.5727172815675593, 'support': 526824}, 'weighted avg': {'precision': 0.6173543928892351, 'recall': 0.5968539777990373, 'f1-score': 0.6031764802710626, 'support': 526824}}
[[ 68790  32514  23023]
 [ 43686 173789  59363]
 [ 24631  29170  71858]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8926558
{'0': {'precision': 0.525116519937856, 'recall': 0.5221530218155248, 'f1-score': 0.5236305779154847, 'support': 143705}, '1': {'precision': 0.6583714229818415, 'recall': 0.6218784910922026, 'f1-score': 0.6396048499613404, 'support': 238106}, '2': {'precision': 0.49517676799436555, 'recall': 0.5430133850068615, 'f1-score': 0.5179929942276382, 'support': 145013}, 'accuracy': 0.5729674426373893, 'macro avg': {'precision': 0.559554903638021, 'recall': 0.562348299304863, 'f1-score': 0.5604094740348211, 'support': 526824}, 'weighted avg': {'precision': 0.5771018863896689, 'recall': 0.5729674426373893, 'f1-score': 0.57449509262329, 'support': 526824}}
[[ 75036  40062  28607]
 [ 38362 148073  51671]
 [ 29496  36773  78744]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9500191
{'0': {'precision': 0.538168042396888, 'recall': 0.4700878480772874, 'f1-score': 0.5018294648104497, 'support': 168928}, '1': {'precision': 0.5289221653154498, 'recall': 0.6148067466482997, 'f1-score': 0.5686398451350376, 'support': 187293}, '2': {'precision': 0.5184914676190417, 'recall': 0.491011295229275, 'f1-score': 0.5043773557640202, 'support': 170603}, 'accuracy': 0.5283130609083868, 'macro avg': {'precision': 0.5285272251104599, 'recall': 0.5253019633182873, 'f1-score': 0.5249488885698358, 'support': 526824}, 'weighted avg': {'precision': 0.5285090846746909, 'recall': 0.5283130609083868, 'f1-score': 0.526406542548907, 'support': 526824}}
[[ 79411  52671  36846]
 [ 31197 115149  40947]
 [ 36950  49885  83768]]
Evaluating performance on  val set...
681/681 - 8s - 8s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.87649405
{'0': {'precision': 0.4335748792270531, 'recall': 0.6069999436397453, 'f1-score': 0.5058356621186859, 'support': 35486}, '1': {'precision': 0.8171340239735315, 'recall': 0.5817469204927211, 'f1-score': 0.6796363964451663, 'support': 103588}, '2': {'precision': 0.3968272689744648, 'recall': 0.5730872959545777, 'f1-score': 0.4689416465341014, 'support': 35225}, 'accuracy': 0.585138182089398, 'macro avg': {'precision': 0.5491787240583498, 'recall': 0.5872780533623482, 'f1-score': 0.5514712350326513, 'support': 174299}, 'weighted avg': {'precision': 0.6541021921482447, 'recall': 0.585138182089398, 'f1-score': 0.6016714315060286, 'support': 174299}}
[[21540  7302  6644]
 [19286 60262 24040]
 [ 8854  6184 20187]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.89904577
{'0': {'precision': 0.48626220228353584, 'recall': 0.5612845871763529, 'f1-score': 0.5210869475508604, 'support': 44995}, '1': {'precision': 0.7171063068780017, 'recall': 0.5875707549956868, 'f1-score': 0.6459080280592362, 'support': 84623}, '2': {'precision': 0.456030174446016, 'recall': 0.5411920055504577, 'f1-score': 0.49497472007860316, 'support': 44681}, 'accuracy': 0.5688959776017074, 'macro avg': {'precision': 0.5531328945358512, 'recall': 0.5633491159074991, 'f1-score': 0.5539898985628999, 'support': 174299}, 'weighted avg': {'precision': 0.5905882364391493, 'recall': 0.5688959776017074, 'f1-score': 0.5749943931482094, 'support': 174299}}
[[25255 10492  9248]
 [15305 49722 19596]
 [11377  9123 24181]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9258606
{'0': {'precision': 0.5045476572110188, 'recall': 0.5290818121408748, 'f1-score': 0.5165235642053043, 'support': 51166}, '1': {'precision': 0.6367747025977178, 'recall': 0.5803543029414612, 'f1-score': 0.6072568100423253, 'support': 72311}, '2': {'precision': 0.48267295080469846, 'recall': 0.5198929597418441, 'f1-score': 0.5005920635071001, 'support': 50822}, 'accuracy': 0.5476738248641702, 'macro avg': {'precision': 0.5413317702044784, 'recall': 0.54310969160806, 'f1-score': 0.5414574792515766, 'support': 174299}, 'weighted avg': {'precision': 0.5530261542188937, 'recall': 0.5476738248641702, 'f1-score': 0.5495205464670311, 'support': 174299}}
[[27071 12670 11425]
 [13451 41966 16894]
 [13132 11268 26422]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9719657
{'0': {'precision': 0.5135263494383049, 'recall': 0.47724379106048515, 'f1-score': 0.49472072642804343, 'support': 58907}, '1': {'precision': 0.5107594341102293, 'recall': 0.5693779067734378, 'f1-score': 0.5384780739466896, 'support': 57194}, '2': {'precision': 0.5004839056563194, 'recall': 0.4798274854806007, 'f1-score': 0.4899380669158026, 'support': 58198}, 'accuracy': 0.5083391184114654, 'macro avg': {'precision': 0.5082565630682846, 'recall': 0.5088163944381745, 'f1-score': 0.5077122890968452, 'support': 174299}, 'weighted avg': {'precision': 0.508263582018538, 'recall': 0.5083391184114654, 'f1-score': 0.5074822254365751, 'support': 174299}}
[[28113 16388 14406]
 [11164 32565 13465]
 [15468 14805 27925]]
training model: results/ATVI/W2/deepVOL_L2/seq2seq
Epoch 1/50
2058/2058 - 64s - loss: 11.6651 - accuracy10: 0.5170 - accuracy20: 0.5205 - accuracy30: 0.5111 - accuracy50: 0.4853 - val_loss: 12.2090 - val_accuracy10: 0.5620 - val_accuracy20: 0.5521 - val_accuracy30: 0.5295 - val_accuracy50: 0.4799 - 64s/epoch - 31ms/step
Epoch 2/50
2058/2058 - 58s - loss: 11.1670 - accuracy10: 0.5661 - accuracy20: 0.5608 - accuracy30: 0.5447 - accuracy50: 0.5103 - val_loss: 12.0094 - val_accuracy10: 0.5737 - val_accuracy20: 0.5588 - val_accuracy30: 0.5356 - val_accuracy50: 0.4877 - 58s/epoch - 28ms/step
Epoch 3/50
2058/2058 - 57s - loss: 10.9821 - accuracy10: 0.5824 - accuracy20: 0.5727 - accuracy30: 0.5545 - accuracy50: 0.5168 - val_loss: 12.0699 - val_accuracy10: 0.5804 - val_accuracy20: 0.5631 - val_accuracy30: 0.5388 - val_accuracy50: 0.4901 - 57s/epoch - 28ms/step
Epoch 4/50
2058/2058 - 57s - loss: 10.8738 - accuracy10: 0.5892 - accuracy20: 0.5784 - accuracy30: 0.5593 - accuracy50: 0.5207 - val_loss: 11.9190 - val_accuracy10: 0.5718 - val_accuracy20: 0.5577 - val_accuracy30: 0.5369 - val_accuracy50: 0.4928 - 57s/epoch - 28ms/step
Epoch 5/50
2058/2058 - 58s - loss: 10.8018 - accuracy10: 0.5938 - accuracy20: 0.5826 - accuracy30: 0.5628 - accuracy50: 0.5236 - val_loss: 11.8665 - val_accuracy10: 0.5754 - val_accuracy20: 0.5616 - val_accuracy30: 0.5409 - val_accuracy50: 0.4948 - 58s/epoch - 28ms/step
Epoch 6/50
2058/2058 - 57s - loss: 10.7501 - accuracy10: 0.5968 - accuracy20: 0.5862 - accuracy30: 0.5656 - accuracy50: 0.5256 - val_loss: 11.8147 - val_accuracy10: 0.5759 - val_accuracy20: 0.5620 - val_accuracy30: 0.5420 - val_accuracy50: 0.4955 - 57s/epoch - 28ms/step
Epoch 7/50
2058/2058 - 57s - loss: 10.7109 - accuracy10: 0.5991 - accuracy20: 0.5877 - accuracy30: 0.5675 - accuracy50: 0.5267 - val_loss: 11.7979 - val_accuracy10: 0.5787 - val_accuracy20: 0.5640 - val_accuracy30: 0.5429 - val_accuracy50: 0.4973 - 57s/epoch - 28ms/step
Epoch 8/50
2058/2058 - 57s - loss: 10.6723 - accuracy10: 0.6010 - accuracy20: 0.5897 - accuracy30: 0.5694 - accuracy50: 0.5284 - val_loss: 11.7291 - val_accuracy10: 0.5716 - val_accuracy20: 0.5616 - val_accuracy30: 0.5434 - val_accuracy50: 0.4996 - 57s/epoch - 28ms/step
Epoch 9/50
2058/2058 - 58s - loss: 10.6407 - accuracy10: 0.6024 - accuracy20: 0.5912 - accuracy30: 0.5712 - accuracy50: 0.5300 - val_loss: 11.7545 - val_accuracy10: 0.5752 - val_accuracy20: 0.5633 - val_accuracy30: 0.5446 - val_accuracy50: 0.4983 - 58s/epoch - 28ms/step
Epoch 10/50
2058/2058 - 57s - loss: 10.6079 - accuracy10: 0.6039 - accuracy20: 0.5929 - accuracy30: 0.5724 - accuracy50: 0.5311 - val_loss: 11.7076 - val_accuracy10: 0.5712 - val_accuracy20: 0.5619 - val_accuracy30: 0.5437 - val_accuracy50: 0.5006 - 57s/epoch - 28ms/step
Epoch 11/50
2058/2058 - 57s - loss: 10.5842 - accuracy10: 0.6050 - accuracy20: 0.5937 - accuracy30: 0.5734 - accuracy50: 0.5318 - val_loss: 11.6798 - val_accuracy10: 0.5723 - val_accuracy20: 0.5617 - val_accuracy30: 0.5439 - val_accuracy50: 0.5006 - 57s/epoch - 28ms/step
Epoch 12/50
2058/2058 - 57s - loss: 10.5611 - accuracy10: 0.6062 - accuracy20: 0.5949 - accuracy30: 0.5748 - accuracy50: 0.5331 - val_loss: 11.7173 - val_accuracy10: 0.5745 - val_accuracy20: 0.5621 - val_accuracy30: 0.5436 - val_accuracy50: 0.5002 - 57s/epoch - 28ms/step
Epoch 13/50
2058/2058 - 58s - loss: 10.5371 - accuracy10: 0.6068 - accuracy20: 0.5956 - accuracy30: 0.5755 - accuracy50: 0.5345 - val_loss: 11.6954 - val_accuracy10: 0.5600 - val_accuracy20: 0.5546 - val_accuracy30: 0.5406 - val_accuracy50: 0.5014 - 58s/epoch - 28ms/step
Epoch 14/50
2058/2058 - 57s - loss: 10.5219 - accuracy10: 0.6072 - accuracy20: 0.5959 - accuracy30: 0.5761 - accuracy50: 0.5347 - val_loss: 11.6859 - val_accuracy10: 0.5650 - val_accuracy20: 0.5567 - val_accuracy30: 0.5413 - val_accuracy50: 0.5003 - 57s/epoch - 28ms/step
Epoch 15/50
2058/2058 - 57s - loss: 10.5021 - accuracy10: 0.6084 - accuracy20: 0.5969 - accuracy30: 0.5770 - accuracy50: 0.5353 - val_loss: 11.6821 - val_accuracy10: 0.5590 - val_accuracy20: 0.5525 - val_accuracy30: 0.5383 - val_accuracy50: 0.5001 - 57s/epoch - 28ms/step
Epoch 16/50
2058/2058 - 58s - loss: 10.4846 - accuracy10: 0.6086 - accuracy20: 0.5974 - accuracy30: 0.5776 - accuracy50: 0.5364 - val_loss: 11.6791 - val_accuracy10: 0.5675 - val_accuracy20: 0.5580 - val_accuracy30: 0.5414 - val_accuracy50: 0.5018 - 58s/epoch - 28ms/step
Epoch 17/50
2058/2058 - 58s - loss: 10.4702 - accuracy10: 0.6102 - accuracy20: 0.5982 - accuracy30: 0.5777 - accuracy50: 0.5368 - val_loss: 11.6608 - val_accuracy10: 0.5636 - val_accuracy20: 0.5556 - val_accuracy30: 0.5405 - val_accuracy50: 0.5025 - 58s/epoch - 28ms/step
Epoch 18/50
2058/2058 - 59s - loss: 10.4508 - accuracy10: 0.6103 - accuracy20: 0.5988 - accuracy30: 0.5787 - accuracy50: 0.5380 - val_loss: 11.7052 - val_accuracy10: 0.5683 - val_accuracy20: 0.5574 - val_accuracy30: 0.5402 - val_accuracy50: 0.4997 - 59s/epoch - 29ms/step
Epoch 19/50
2058/2058 - 58s - loss: 10.4348 - accuracy10: 0.6108 - accuracy20: 0.5993 - accuracy30: 0.5791 - accuracy50: 0.5384 - val_loss: 11.7041 - val_accuracy10: 0.5660 - val_accuracy20: 0.5571 - val_accuracy30: 0.5399 - val_accuracy50: 0.5000 - 58s/epoch - 28ms/step
Epoch 20/50
2058/2058 - 57s - loss: 10.4232 - accuracy10: 0.6105 - accuracy20: 0.5995 - accuracy30: 0.5798 - accuracy50: 0.5389 - val_loss: 11.6754 - val_accuracy10: 0.5709 - val_accuracy20: 0.5603 - val_accuracy30: 0.5425 - val_accuracy50: 0.5019 - 57s/epoch - 28ms/step
Epoch 21/50
2058/2058 - 58s - loss: 10.4071 - accuracy10: 0.6116 - accuracy20: 0.6001 - accuracy30: 0.5804 - accuracy50: 0.5396 - val_loss: 11.6897 - val_accuracy10: 0.5655 - val_accuracy20: 0.5550 - val_accuracy30: 0.5387 - val_accuracy50: 0.4998 - 58s/epoch - 28ms/step
Epoch 22/50
2058/2058 - 58s - loss: 10.3911 - accuracy10: 0.6111 - accuracy20: 0.6002 - accuracy30: 0.5805 - accuracy50: 0.5404 - val_loss: 11.6504 - val_accuracy10: 0.5689 - val_accuracy20: 0.5592 - val_accuracy30: 0.5423 - val_accuracy50: 0.5024 - 58s/epoch - 28ms/step
Epoch 23/50
2058/2058 - 56s - loss: 10.3767 - accuracy10: 0.6126 - accuracy20: 0.6012 - accuracy30: 0.5814 - accuracy50: 0.5418 - val_loss: 11.7536 - val_accuracy10: 0.5650 - val_accuracy20: 0.5549 - val_accuracy30: 0.5376 - val_accuracy50: 0.4991 - 56s/epoch - 27ms/step
Epoch 24/50
2058/2058 - 56s - loss: 10.3645 - accuracy10: 0.6124 - accuracy20: 0.6018 - accuracy30: 0.5816 - accuracy50: 0.5421 - val_loss: 11.7340 - val_accuracy10: 0.5727 - val_accuracy20: 0.5604 - val_accuracy30: 0.5404 - val_accuracy50: 0.4995 - 56s/epoch - 27ms/step
Epoch 25/50
2058/2058 - 57s - loss: 10.3490 - accuracy10: 0.6137 - accuracy20: 0.6025 - accuracy30: 0.5830 - accuracy50: 0.5429 - val_loss: 11.6763 - val_accuracy10: 0.5745 - val_accuracy20: 0.5607 - val_accuracy30: 0.5406 - val_accuracy50: 0.4998 - 57s/epoch - 28ms/step
Epoch 26/50
2058/2058 - 57s - loss: 10.3343 - accuracy10: 0.6145 - accuracy20: 0.6025 - accuracy30: 0.5829 - accuracy50: 0.5430 - val_loss: 11.6884 - val_accuracy10: 0.5640 - val_accuracy20: 0.5540 - val_accuracy30: 0.5363 - val_accuracy50: 0.5006 - 57s/epoch - 28ms/step
Epoch 27/50
2058/2058 - 58s - loss: 10.3216 - accuracy10: 0.6148 - accuracy20: 0.6033 - accuracy30: 0.5839 - accuracy50: 0.5441 - val_loss: 11.7626 - val_accuracy10: 0.5748 - val_accuracy20: 0.5581 - val_accuracy30: 0.5368 - val_accuracy50: 0.4970 - 58s/epoch - 28ms/step
Epoch 28/50
2058/2058 - 58s - loss: 10.3067 - accuracy10: 0.6151 - accuracy20: 0.6043 - accuracy30: 0.5851 - accuracy50: 0.5452 - val_loss: 11.7833 - val_accuracy10: 0.5696 - val_accuracy20: 0.5560 - val_accuracy30: 0.5354 - val_accuracy50: 0.4972 - 58s/epoch - 28ms/step
Epoch 29/50
2058/2058 - 58s - loss: 10.2945 - accuracy10: 0.6158 - accuracy20: 0.6041 - accuracy30: 0.5847 - accuracy50: 0.5461 - val_loss: 11.6917 - val_accuracy10: 0.5694 - val_accuracy20: 0.5566 - val_accuracy30: 0.5374 - val_accuracy50: 0.4997 - 58s/epoch - 28ms/step
Epoch 30/50
2058/2058 - 56s - loss: 10.2846 - accuracy10: 0.6154 - accuracy20: 0.6049 - accuracy30: 0.5853 - accuracy50: 0.5463 - val_loss: 11.8177 - val_accuracy10: 0.5669 - val_accuracy20: 0.5538 - val_accuracy30: 0.5336 - val_accuracy50: 0.4971 - 56s/epoch - 27ms/step
Epoch 31/50
2058/2058 - 57s - loss: 10.2706 - accuracy10: 0.6155 - accuracy20: 0.6049 - accuracy30: 0.5857 - accuracy50: 0.5474 - val_loss: 11.7254 - val_accuracy10: 0.5696 - val_accuracy20: 0.5558 - val_accuracy30: 0.5357 - val_accuracy50: 0.4969 - 57s/epoch - 28ms/step
Epoch 32/50
2058/2058 - 58s - loss: 10.2594 - accuracy10: 0.6159 - accuracy20: 0.6056 - accuracy30: 0.5863 - accuracy50: 0.5478 - val_loss: 11.7826 - val_accuracy10: 0.5704 - val_accuracy20: 0.5545 - val_accuracy30: 0.5338 - val_accuracy50: 0.4964 - 58s/epoch - 28ms/step
testing model: results/ATVI/W2/deepVOL_L2/seq2seq
Evaluating performance on  test set...
5497/5497 - 50s - 50s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.87534046
{'0': {'precision': 0.43356042757163915, 'recall': 0.5474890629694495, 'f1-score': 0.4839095163301326, 'support': 272926}, '1': {'precision': 0.8203572235150872, 'recall': 0.577111311946304, 'f1-score': 0.6775643551374962, 'support': 868595}, '2': {'precision': 0.3652513449284735, 'recall': 0.620727943390545, 'f1-score': 0.4598914375668406, 'support': 265680}, 'accuracy': 0.5796009241039481, 'macro avg': {'precision': 0.5397229986717332, 'recall': 0.5817761061020995, 'f1-score': 0.5404551030114898, 'support': 1407201}, 'weighted avg': {'precision': 0.6594140233947398, 'recall': 0.5796009241039481, 'f1-score': 0.59890836976191, 'support': 1407201}}
[[149424  69258  54244]
 [134967 501276 232352]
 [ 60253  40512 164915]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9056653
{'0': {'precision': 0.49041841445410445, 'recall': 0.48493950602622515, 'f1-score': 0.4876635718186783, 'support': 345241}, '1': {'precision': 0.7185441063829431, 'recall': 0.595152817574021, 'f1-score': 0.6510535903165822, 'support': 720336}, '2': {'precision': 0.4323266123875698, 'recall': 0.5937492682012974, 'f1-score': 0.500340402859384, 'support': 341624}, 'accuracy': 0.5677724788427524, 'macro avg': {'precision': 0.5470963777415391, 'recall': 0.5579471972671812, 'f1-score': 0.5463525216648816, 'support': 1407201}, 'weighted avg': {'precision': 0.593091447398278, 'recall': 0.5677724788427524, 'f1-score': 0.5743792734790353, 'support': 1407201}}
[[167421 100116  77704]
 [102989 428710 188637]
 [ 70974  67811 202839]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9312275
{'0': {'precision': 0.5144886279393885, 'recall': 0.44110797549131775, 'f1-score': 0.47498083661848445, 'support': 393330}, '1': {'precision': 0.6360465507382866, 'recall': 0.6092255451853904, 'f1-score': 0.6223472089437544, 'support': 620798}, '2': {'precision': 0.4675155832216615, 'recall': 0.5653758970979945, 'f1-score': 0.5118098993118568, 'support': 393073}, 'accuracy': 0.5499861071730335, 'macro avg': {'precision': 0.5393502539664455, 'recall': 0.5385698059249009, 'f1-score': 0.5363793149580319, 'support': 1407201}, 'weighted avg': {'precision': 0.5549939144985789, 'recall': 0.5499861071730335, 'f1-score': 0.550280143090591, 'support': 1407201}}
[[173501 123231  96598]
 [ 86073 378206 156519]
 [ 77656  93183 222234]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9830299
{'0': {'precision': 0.5280054727147799, 'recall': 0.3831981330772949, 'f1-score': 0.44409550206513904, 'support': 457223}, '1': {'precision': 0.5096586367737743, 'recall': 0.6254848537994999, 'f1-score': 0.5616624868264071, 'support': 490354}, '2': {'precision': 0.4976730436251531, 'recall': 0.5127843628705202, 'f1-score': 0.5051157088910891, 'support': 459624}, 'accuracy': 0.5099513147020219, 'macro avg': {'precision': 0.5117790510379024, 'recall': 0.507155783249105, 'f1-score': 0.503624565927545, 'support': 1407201}, 'weighted avg': {'precision': 0.5117050602087437, 'recall': 0.5099513147020219, 'f1-score': 0.5049935491726932, 'support': 1407201}}
[[175207 160007 122009]
 [ 67762 306709 115883]
 [ 88859 135077 235688]]
Evaluating performance on  train set...
2058/2058 - 19s - 19s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8437327
{'0': {'precision': 0.44707175582319003, 'recall': 0.5822013708935886, 'f1-score': 0.5057662196201238, 'support': 95704}, '1': {'precision': 0.8336486786959385, 'recall': 0.5949502389250171, 'f1-score': 0.6943579117302252, 'support': 333996}, '2': {'precision': 0.3816272965879265, 'recall': 0.6437337836168198, 'f1-score': 0.47918023866275283, 'support': 97124}, 'accuracy': 0.6016278681305331, 'macro avg': {'precision': 0.5541159103690183, 'recall': 0.6069617978118085, 'f1-score': 0.5597681233377007, 'support': 526824}, 'weighted avg': {'precision': 0.6800886993812679, 'recall': 0.6016278681305331, 'f1-score': 0.6204282964873541, 'support': 526824}}
[[ 55719  23005  16980]
 [ 50957 198711  84328]
 [ 17955  16647  62522]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8757226
{'0': {'precision': 0.5171734530921943, 'recall': 0.51334497380893, 'f1-score': 0.5152521018583578, 'support': 124279}, '1': {'precision': 0.7309016685177164, 'recall': 0.6154943360524615, 'f1-score': 0.6682518897217953, 'support': 276927}, '2': {'precision': 0.4486973171075506, 'recall': 0.6081692114187457, 'f1-score': 0.5164018088291954, 'support': 125618}, 'accuracy': 0.5896504335413725, 'macro avg': {'precision': 0.5655908129058204, 'recall': 0.5790028404267124, 'f1-score': 0.5666352668031162, 'support': 526824}, 'weighted avg': {'precision': 0.6131927655438378, 'recall': 0.5896504335413725, 'f1-score': 0.595951151529445, 'support': 526824}}
[[ 63798  35391  25090]
 [ 37703 170447  68777]
 [ 21858  27363  76397]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9077165
{'0': {'precision': 0.5462992551805511, 'recall': 0.4638568466751082, 'f1-score': 0.5017138428080684, 'support': 143734}, '1': {'precision': 0.6431994576899479, 'recall': 0.6298076317149303, 'f1-score': 0.6364331047950584, 'support': 238033}, '2': {'precision': 0.4837976983646275, 'recall': 0.5726714326092501, 'f1-score': 0.5244963868658074, 'support': 145057}, 'accuracy': 0.5687990676203059, 'macro avg': {'precision': 0.5577654704117089, 'recall': 0.5554453036664295, 'f1-score': 0.5542144448229781, 'support': 526824}, 'weighted avg': {'precision': 0.5728719959381321, 'recall': 0.5687990676203059, 'f1-score': 0.5688565652009978, 'support': 526824}}
[[ 66672  45575  31487]
 [ 30971 149915  57147]
 [ 24400  37587  83070]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.969522
{'0': {'precision': 0.5603052926831298, 'recall': 0.39869586847341987, 'f1-score': 0.46588349279399294, 'support': 168848}, '1': {'precision': 0.5078953830001609, 'recall': 0.6404586754358804, 'f1-score': 0.566525631823505, 'support': 187322}, '2': {'precision': 0.512568709925321, 'recall': 0.5119950308811982, 'f1-score': 0.5122817097945865, 'support': 170654}, 'accuracy': 0.5213600747118582, 'macro avg': {'precision': 0.5269231285362039, 'recall': 0.5170498582634995, 'f1-score': 0.5148969448040281, 'support': 526824}, 'weighted avg': {'precision': 0.5262066793026001, 'recall': 0.5213600747118582, 'f1-score': 0.5166984292648172, 'support': 526824}}
[[ 67319  61617  39912]
 [ 24173 119972  43177]
 [ 28655  54625  87374]]
Evaluating performance on  val set...
681/681 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8945945
{'0': {'precision': 0.4507527870359729, 'recall': 0.5526901722048421, 'f1-score': 0.49654369128706355, 'support': 35481}, '1': {'precision': 0.8081408419041196, 'recall': 0.5549209350789684, 'f1-score': 0.6580101932834155, 'support': 103649}, '2': {'precision': 0.3718258361007682, 'recall': 0.6303562796781256, 'f1-score': 0.46774482809549434, 'support': 35169}, 'accuracy': 0.5696877205262222, 'macro avg': {'precision': 0.5435731550136202, 'recall': 0.5793224623206453, 'f1-score': 0.5407662375553245, 'support': 174299}, 'weighted avg': {'precision': 0.6473524953624022, 'recall': 0.5696877205262222, 'f1-score': 0.5867508310057974, 'support': 174299}}
[[19610  8522  7349]
 [16028 57517 30104]
 [ 7867  5133 22169]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9192767
{'0': {'precision': 0.5098711045847609, 'recall': 0.48648949182697654, 'f1-score': 0.4979059498338416, 'support': 44965}, '1': {'precision': 0.7001395502740653, 'recall': 0.5746911976571172, 'f1-score': 0.631243068661595, 'support': 84682}, '2': {'precision': 0.43566500234297995, 'recall': 0.6038251366120219, 'f1-score': 0.5061432902505186, 'support': 44652}, 'accuracy': 0.5594007997750992, 'macro avg': {'precision': 0.5485585524006021, 'recall': 0.5550019420320385, 'f1-score': 0.5450974362486517, 'support': 174299}, 'weighted avg': {'precision': 0.583301598394603, 'recall': 0.5594007997750992, 'f1-score': 0.5647971403791533, 'support': 174299}}
[[21875 12432 10658]
 [11749 48666 24267]
 [ 9279  8411 26962]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.94150174
{'0': {'precision': 0.5334787039890024, 'recall': 0.43984991792386463, 'f1-score': 0.4821610273877232, 'support': 51172}, '1': {'precision': 0.6143460280407499, 'recall': 0.5896386241995935, 'f1-score': 0.6017388113417923, 'support': 72307}, '2': {'precision': 0.4691192651772473, 'recall': 0.578866587957497, 'f1-score': 0.51824643923579, 'support': 50820}, 'accuracy': 0.5425217585872553, 'macro avg': {'precision': 0.5389813324023333, 'recall': 0.5361183766936517, 'f1-score': 0.5340487593217685, 'support': 174299}, 'weighted avg': {'precision': 0.5482609283264702, 'recall': 0.5425217585872553, 'f1-score': 0.5422885751905541, 'support': 174299}}
[[22508 15448 13216]
 [ 9597 42635 20075]
 [10086 11316 29418]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9896313
{'0': {'precision': 0.5429588205388917, 'recall': 0.38077451995721634, 'f1-score': 0.44762893182181057, 'support': 58901}, '1': {'precision': 0.48666269807523316, 'recall': 0.6001747946163258, 'f1-score': 0.5374909990294606, 'support': 57210}, '2': {'precision': 0.49285691405874626, 'recall': 0.5288547466831649, 'f1-score': 0.5102216769187405, 'support': 58188}, 'accuracy': 0.5022231911829672, 'macro avg': {'precision': 0.507492810890957, 'recall': 0.5032680204189024, 'f1-score': 0.49844720259000397, 'support': 174299}, 'weighted avg': {'precision': 0.507754769451894, 'recall': 0.5022231911829672, 'f1-score': 0.49802024512050885, 'support': 174299}}
[[22428 20073 16400]
 [ 7609 34336 15265]
 [11270 16145 30773]]
training model: results/ATVI/W2/deepVOL_L3/seq2seq
Epoch 1/50
2058/2058 - 92s - loss: 12.4289 - accuracy10: 0.4191 - accuracy20: 0.4335 - accuracy30: 0.4393 - accuracy50: 0.4338 - val_loss: 13.0741 - val_accuracy10: 0.4702 - val_accuracy20: 0.4385 - val_accuracy30: 0.4124 - val_accuracy50: 0.3619 - 92s/epoch - 45ms/step
Epoch 2/50
2058/2058 - 85s - loss: 11.5086 - accuracy10: 0.5086 - accuracy20: 0.5172 - accuracy30: 0.5134 - accuracy50: 0.4921 - val_loss: 12.6057 - val_accuracy10: 0.6030 - val_accuracy20: 0.5639 - val_accuracy30: 0.5274 - val_accuracy50: 0.4658 - 85s/epoch - 41ms/step
Epoch 3/50
2058/2058 - 84s - loss: 11.1041 - accuracy10: 0.5689 - accuracy20: 0.5622 - accuracy30: 0.5469 - accuracy50: 0.5129 - val_loss: 12.0584 - val_accuracy10: 0.5856 - val_accuracy20: 0.5643 - val_accuracy30: 0.5361 - val_accuracy50: 0.4815 - 84s/epoch - 41ms/step
Epoch 4/50
2058/2058 - 84s - loss: 10.9382 - accuracy10: 0.5826 - accuracy20: 0.5734 - accuracy30: 0.5554 - accuracy50: 0.5194 - val_loss: 11.8932 - val_accuracy10: 0.5852 - val_accuracy20: 0.5657 - val_accuracy30: 0.5380 - val_accuracy50: 0.4859 - 84s/epoch - 41ms/step
Epoch 5/50
2058/2058 - 82s - loss: 10.8258 - accuracy10: 0.5887 - accuracy20: 0.5791 - accuracy30: 0.5603 - accuracy50: 0.5236 - val_loss: 11.7429 - val_accuracy10: 0.5936 - val_accuracy20: 0.5719 - val_accuracy30: 0.5437 - val_accuracy50: 0.4902 - 82s/epoch - 40ms/step
Epoch 6/50
2058/2058 - 83s - loss: 10.7467 - accuracy10: 0.5931 - accuracy20: 0.5829 - accuracy30: 0.5633 - accuracy50: 0.5265 - val_loss: 11.6522 - val_accuracy10: 0.5810 - val_accuracy20: 0.5664 - val_accuracy30: 0.5440 - val_accuracy50: 0.4944 - 83s/epoch - 40ms/step
Epoch 7/50
2058/2058 - 83s - loss: 10.6856 - accuracy10: 0.5962 - accuracy20: 0.5858 - accuracy30: 0.5663 - accuracy50: 0.5286 - val_loss: 11.5440 - val_accuracy10: 0.5814 - val_accuracy20: 0.5682 - val_accuracy30: 0.5476 - val_accuracy50: 0.5012 - 83s/epoch - 40ms/step
Epoch 8/50
2058/2058 - 83s - loss: 10.6425 - accuracy10: 0.5991 - accuracy20: 0.5888 - accuracy30: 0.5695 - accuracy50: 0.5306 - val_loss: 11.5014 - val_accuracy10: 0.5793 - val_accuracy20: 0.5681 - val_accuracy30: 0.5479 - val_accuracy50: 0.5007 - 83s/epoch - 40ms/step
Epoch 9/50
2058/2058 - 83s - loss: 10.6069 - accuracy10: 0.6010 - accuracy20: 0.5905 - accuracy30: 0.5706 - accuracy50: 0.5315 - val_loss: 11.4818 - val_accuracy10: 0.5759 - val_accuracy20: 0.5658 - val_accuracy30: 0.5463 - val_accuracy50: 0.5026 - 83s/epoch - 40ms/step
Epoch 10/50
2058/2058 - 85s - loss: 10.5792 - accuracy10: 0.6035 - accuracy20: 0.5920 - accuracy30: 0.5721 - accuracy50: 0.5328 - val_loss: 11.4927 - val_accuracy10: 0.5733 - val_accuracy20: 0.5638 - val_accuracy30: 0.5447 - val_accuracy50: 0.5022 - 85s/epoch - 41ms/step
Epoch 11/50
2058/2058 - 82s - loss: 10.5508 - accuracy10: 0.6051 - accuracy20: 0.5935 - accuracy30: 0.5733 - accuracy50: 0.5344 - val_loss: 11.4042 - val_accuracy10: 0.5690 - val_accuracy20: 0.5616 - val_accuracy30: 0.5436 - val_accuracy50: 0.5045 - 82s/epoch - 40ms/step
Epoch 12/50
2058/2058 - 84s - loss: 10.5239 - accuracy10: 0.6065 - accuracy20: 0.5946 - accuracy30: 0.5747 - accuracy50: 0.5352 - val_loss: 11.3759 - val_accuracy10: 0.5691 - val_accuracy20: 0.5617 - val_accuracy30: 0.5449 - val_accuracy50: 0.5064 - 84s/epoch - 41ms/step
Epoch 13/50
2058/2058 - 85s - loss: 10.5079 - accuracy10: 0.6075 - accuracy20: 0.5952 - accuracy30: 0.5751 - accuracy50: 0.5357 - val_loss: 11.3444 - val_accuracy10: 0.5751 - val_accuracy20: 0.5657 - val_accuracy30: 0.5483 - val_accuracy50: 0.5070 - 85s/epoch - 41ms/step
Epoch 14/50
2058/2058 - 84s - loss: 10.4846 - accuracy10: 0.6088 - accuracy20: 0.5966 - accuracy30: 0.5768 - accuracy50: 0.5371 - val_loss: 11.3132 - val_accuracy10: 0.5709 - val_accuracy20: 0.5634 - val_accuracy30: 0.5468 - val_accuracy50: 0.5083 - 84s/epoch - 41ms/step
Epoch 15/50
2058/2058 - 83s - loss: 10.4678 - accuracy10: 0.6094 - accuracy20: 0.5971 - accuracy30: 0.5771 - accuracy50: 0.5378 - val_loss: 11.3384 - val_accuracy10: 0.5668 - val_accuracy20: 0.5608 - val_accuracy30: 0.5455 - val_accuracy50: 0.5075 - 83s/epoch - 40ms/step
Epoch 16/50
2058/2058 - 83s - loss: 10.4494 - accuracy10: 0.6104 - accuracy20: 0.5977 - accuracy30: 0.5776 - accuracy50: 0.5378 - val_loss: 11.3500 - val_accuracy10: 0.5749 - val_accuracy20: 0.5658 - val_accuracy30: 0.5480 - val_accuracy50: 0.5070 - 83s/epoch - 40ms/step
Epoch 17/50
2058/2058 - 83s - loss: 10.4317 - accuracy10: 0.6115 - accuracy20: 0.5989 - accuracy30: 0.5788 - accuracy50: 0.5394 - val_loss: 11.3239 - val_accuracy10: 0.5666 - val_accuracy20: 0.5606 - val_accuracy30: 0.5458 - val_accuracy50: 0.5079 - 83s/epoch - 41ms/step
Epoch 18/50
2058/2058 - 84s - loss: 10.4143 - accuracy10: 0.6118 - accuracy20: 0.5995 - accuracy30: 0.5797 - accuracy50: 0.5404 - val_loss: 11.2980 - val_accuracy10: 0.5582 - val_accuracy20: 0.5568 - val_accuracy30: 0.5443 - val_accuracy50: 0.5094 - 84s/epoch - 41ms/step
Epoch 19/50
2058/2058 - 82s - loss: 10.3999 - accuracy10: 0.6123 - accuracy20: 0.5996 - accuracy30: 0.5805 - accuracy50: 0.5407 - val_loss: 11.3223 - val_accuracy10: 0.5502 - val_accuracy20: 0.5510 - val_accuracy30: 0.5410 - val_accuracy50: 0.5078 - 82s/epoch - 40ms/step
Epoch 20/50
2058/2058 - 84s - loss: 10.3872 - accuracy10: 0.6130 - accuracy20: 0.6008 - accuracy30: 0.5808 - accuracy50: 0.5415 - val_loss: 11.3809 - val_accuracy10: 0.5539 - val_accuracy20: 0.5506 - val_accuracy30: 0.5395 - val_accuracy50: 0.5052 - 84s/epoch - 41ms/step
Epoch 21/50
2058/2058 - 82s - loss: 10.3716 - accuracy10: 0.6131 - accuracy20: 0.6013 - accuracy30: 0.5820 - accuracy50: 0.5425 - val_loss: 11.3531 - val_accuracy10: 0.5547 - val_accuracy20: 0.5529 - val_accuracy30: 0.5411 - val_accuracy50: 0.5068 - 82s/epoch - 40ms/step
Epoch 22/50
2058/2058 - 83s - loss: 10.3564 - accuracy10: 0.6138 - accuracy20: 0.6020 - accuracy30: 0.5827 - accuracy50: 0.5432 - val_loss: 11.3735 - val_accuracy10: 0.5578 - val_accuracy20: 0.5555 - val_accuracy30: 0.5429 - val_accuracy50: 0.5079 - 83s/epoch - 40ms/step
Epoch 23/50
2058/2058 - 84s - loss: 10.3467 - accuracy10: 0.6148 - accuracy20: 0.6025 - accuracy30: 0.5829 - accuracy50: 0.5436 - val_loss: 11.3804 - val_accuracy10: 0.5556 - val_accuracy20: 0.5539 - val_accuracy30: 0.5419 - val_accuracy50: 0.5077 - 84s/epoch - 41ms/step
Epoch 24/50
2058/2058 - 84s - loss: 10.3298 - accuracy10: 0.6143 - accuracy20: 0.6026 - accuracy30: 0.5836 - accuracy50: 0.5446 - val_loss: 11.4112 - val_accuracy10: 0.5617 - val_accuracy20: 0.5571 - val_accuracy30: 0.5430 - val_accuracy50: 0.5077 - 84s/epoch - 41ms/step
Epoch 25/50
2058/2058 - 82s - loss: 10.3183 - accuracy10: 0.6155 - accuracy20: 0.6036 - accuracy30: 0.5844 - accuracy50: 0.5453 - val_loss: 11.3969 - val_accuracy10: 0.5564 - val_accuracy20: 0.5547 - val_accuracy30: 0.5420 - val_accuracy50: 0.5081 - 82s/epoch - 40ms/step
Epoch 26/50
2058/2058 - 83s - loss: 10.3078 - accuracy10: 0.6154 - accuracy20: 0.6038 - accuracy30: 0.5843 - accuracy50: 0.5451 - val_loss: 11.4240 - val_accuracy10: 0.5547 - val_accuracy20: 0.5529 - val_accuracy30: 0.5412 - val_accuracy50: 0.5074 - 83s/epoch - 40ms/step
Epoch 27/50
2058/2058 - 84s - loss: 10.2937 - accuracy10: 0.6154 - accuracy20: 0.6042 - accuracy30: 0.5850 - accuracy50: 0.5465 - val_loss: 11.4079 - val_accuracy10: 0.5565 - val_accuracy20: 0.5537 - val_accuracy30: 0.5403 - val_accuracy50: 0.5075 - 84s/epoch - 41ms/step
Epoch 28/50
2058/2058 - 84s - loss: 10.2827 - accuracy10: 0.6164 - accuracy20: 0.6050 - accuracy30: 0.5858 - accuracy50: 0.5471 - val_loss: 11.4378 - val_accuracy10: 0.5543 - val_accuracy20: 0.5518 - val_accuracy30: 0.5386 - val_accuracy50: 0.5055 - 84s/epoch - 41ms/step
testing model: results/ATVI/W2/deepVOL_L3/seq2seq
Evaluating performance on  test set...
5497/5497 - 91s - 91s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8696766
{'0': {'precision': 0.4110751576708163, 'recall': 0.6032514307907638, 'f1-score': 0.4889582504261676, 'support': 272926}, '1': {'precision': 0.8412041675903348, 'recall': 0.5460934037151952, 'f1-score': 0.6622602916640488, 'support': 868595}, '2': {'precision': 0.3734440208848982, 'recall': 0.6224179464016862, 'f1-score': 0.46680818870608953, 'support': 265680}, 'accuracy': 0.5715892754482125, 'macro avg': {'precision': 0.5419077820486831, 'recall': 0.5905875936358819, 'f1-score': 0.5393422435987686, 'support': 1407201}, 'weighted avg': {'precision': 0.6694675742124202, 'recall': 0.5715892754482125, 'f1-score': 0.5917470191317236, 'support': 1407201}}
[[164643  51260  57023]
 [173840 474334 220421]
 [ 62035  38281 165364]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.89293754
{'0': {'precision': 0.47018123415818597, 'recall': 0.5367641734324718, 'f1-score': 0.5012713491990499, 'support': 345241}, '1': {'precision': 0.7431380035403792, 'recall': 0.5647267386330823, 'f1-score': 0.641763460029107, 'support': 720336}, '2': {'precision': 0.4396258302535481, 'recall': 0.5992582488349765, 'f1-score': 0.5071776735889607, 'support': 341624}, 'accuracy': 0.5662495976054593, 'macro avg': {'precision': 0.550981689317371, 'recall': 0.5669163869668435, 'f1-score': 0.5500708276057059, 'support': 1407201}, 'weighted avg': {'precision': 0.6024879395443914, 'recall': 0.5662495976054593, 'f1-score': 0.5746221123880036, 'support': 1407201}}
[[185313  77596  82332]
 [134925 406793 178618]
 [ 73893  63010 204721]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9191298
{'0': {'precision': 0.49564875854845664, 'recall': 0.49087788879566774, 'f1-score': 0.4932517876439887, 'support': 393330}, '1': {'precision': 0.6589095916030675, 'recall': 0.576596574086901, 'f1-score': 0.6150111164182798, 'support': 620798}, '2': {'precision': 0.4726914004945079, 'recall': 0.5705047154090971, 'f1-score': 0.5170124175200926, 'support': 393073}, 'accuracy': 0.5509355095682849, 'macro avg': {'precision': 0.5424165835486774, 'recall': 0.5459930594305553, 'f1-score': 0.5417584405274537, 'support': 1407201}, 'weighted avg': {'precision': 0.5612599122047549, 'recall': 0.5509355095682849, 'f1-score': 0.5536039405004123, 'support': 1407201}}
[[193077  99352 100901]
 [113588 357950 149260]
 [ 82879  85944 224250]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.966837
{'0': {'precision': 0.5148615592796919, 'recall': 0.4327232007138748, 'f1-score': 0.47023242935556975, 'support': 457223}, '1': {'precision': 0.5284601142923786, 'recall': 0.5914135502106641, 'f1-score': 0.5581673759192857, 'support': 490354}, '2': {'precision': 0.5015111156103621, 'recall': 0.5173641933406437, 'f1-score': 0.5093143223703305, 'support': 459624}, 'accuracy': 0.5156662054674492, 'macro avg': {'precision': 0.5149442630608109, 'recall': 0.5138336480883942, 'f1-score': 0.5125713758817286, 'support': 1407201}, 'weighted avg': {'precision': 0.5152395589567947, 'recall': 0.5156662054674492, 'f1-score': 0.5136393262966042, 'support': 1407201}}
[[197851 134686 124686]
 [ 88678 290002 111674]
 [ 97751 124080 237793]]
Evaluating performance on  train set...
2058/2058 - 34s - 34s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8402809
{'0': {'precision': 0.4342881369799841, 'recall': 0.6100789935634874, 'f1-score': 0.5073887558821102, 'support': 95704}, '1': {'precision': 0.8504772193601957, 'recall': 0.5704020407430029, 'f1-score': 0.6828362622356192, 'support': 333996}, '2': {'precision': 0.3799613956941351, 'recall': 0.6587043367241876, 'f1-score': 0.4819302520913449, 'support': 97124}, 'accuracy': 0.5938890407422592, 'macro avg': {'precision': 0.5549089173447715, 'recall': 0.6130617903435593, 'f1-score': 0.5573850900696914, 'support': 526824}, 'weighted avg': {'precision': 0.6881282398189101, 'recall': 0.5938890407422592, 'f1-score': 0.6139255378242242, 'support': 526824}}
[[ 58387  18434  18883]
 [ 57968 190512  85516]
 [ 18088  15060  63976]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8640536
{'0': {'precision': 0.5061185641769398, 'recall': 0.5391256769043845, 'f1-score': 0.5221009650787218, 'support': 124279}, '1': {'precision': 0.7519142910822217, 'recall': 0.5925316058022512, 'f1-score': 0.6627756213218515, 'support': 276927}, '2': {'precision': 0.4468455789300449, 'recall': 0.6268209969908771, 'f1-score': 0.5217489257233352, 'support': 125618}, 'accuracy': 0.5881091218319591, 'macro avg': {'precision': 0.5682928113964022, 'recall': 0.5861594265658375, 'f1-score': 0.5688751707079696, 'support': 526824}, 'weighted avg': {'precision': 0.621188719302664, 'recall': 0.5881091218319591, 'f1-score': 0.5959631810174342, 'support': 526824}}
[[ 67002  29377  27900]
 [ 43266 164088  69573]
 [ 22116  24762  78740]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8959866
{'0': {'precision': 0.5379609876203366, 'recall': 0.48947361097583036, 'f1-score': 0.5125731750408906, 'support': 143734}, '1': {'precision': 0.6642258260246015, 'recall': 0.6070628862384627, 'f1-score': 0.6343592028640351, 'support': 238033}, '2': {'precision': 0.48095486198647597, 'recall': 0.5918294187802037, 'f1-score': 0.5306625787349253, 'support': 145057}, 'accuracy': 0.5707864486052268, 'macro avg': {'precision': 0.5610472252104713, 'recall': 0.5627886386648323, 'f1-score': 0.5591983188799503, 'support': 526824}, 'weighted avg': {'precision': 0.5793145719555444, 'recall': 0.5707864486052268, 'f1-score': 0.5725800999199245, 'support': 526824}}
[[ 70354  39074  34306]
 [ 35190 144501  58342]
 [ 25235  33973  85849]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9535652
{'0': {'precision': 0.5540301837677027, 'recall': 0.42352885435421206, 'f1-score': 0.48006874236382435, 'support': 168848}, '1': {'precision': 0.5260152053999129, 'recall': 0.6190356711971898, 'f1-score': 0.5687470878191137, 'support': 187322}, '2': {'precision': 0.5100056401579244, 'recall': 0.5298674510998863, 'f1-score': 0.5197468630910982, 'support': 170654}, 'accuracy': 0.527491154541175, 'macro avg': {'precision': 0.5300170097751801, 'recall': 0.5241439922170961, 'f1-score': 0.5228542310913454, 'support': 526824}, 'weighted avg': {'precision': 0.5298080787705989, 'recall': 0.527491154541175, 'f1-score': 0.5244528916090522, 'support': 526824}}
[[ 71512  54706  42630]
 [ 27117 115959  44246]
 [ 30447  49783  90424]]
Evaluating performance on  val set...
681/681 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8919798
{'0': {'precision': 0.43152769324406576, 'recall': 0.599475775767312, 'f1-score': 0.5018225572424532, 'support': 35481}, '1': {'precision': 0.8346708718461154, 'recall': 0.515769568447356, 'f1-score': 0.6375665635044158, 'support': 103649}, '2': {'precision': 0.37177867817128984, 'recall': 0.6444311751826893, 'f1-score': 0.4715281389784667, 'support': 35169}, 'accuracy': 0.5587697003425148, 'macro avg': {'precision': 0.5459924144204904, 'recall': 0.5865588397991192, 'f1-score': 0.5369724199084452, 'support': 174299}, 'weighted avg': {'precision': 0.6592058452003557, 'recall': 0.5587697003425148, 'f1-score': 0.5764317409389748, 'support': 174299}}
[[21270  6116  8095]
 [19988 53459 30202]
 [ 8032  4473 22664]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.90492827
{'0': {'precision': 0.49271849688231517, 'recall': 0.5289669743133548, 'f1-score': 0.5101997039833545, 'support': 44965}, '1': {'precision': 0.731226251046564, 'recall': 0.5363005125056092, 'f1-score': 0.6187751209210436, 'support': 84682}, '2': {'precision': 0.4345411308238681, 'recall': 0.6220326077219386, 'f1-score': 0.5116514690982775, 'support': 44652}, 'accuracy': 0.5563715224986948, 'macro avg': {'precision': 0.5528286262509158, 'recall': 0.5624333648469676, 'f1-score': 0.5468754313342252, 'support': 174299}, 'weighted avg': {'precision': 0.5936919843314408, 'recall': 0.5563715224986948, 'f1-score': 0.5633222558799742, 'support': 174299}}
[[23785  9398 11782]
 [14906 45415 24361]
 [ 9582  7295 27775]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9260793
{'0': {'precision': 0.518694337086204, 'recall': 0.4825685921988587, 'f1-score': 0.4999797529864345, 'support': 51172}, '1': {'precision': 0.6443899052201573, 'recall': 0.5519382632386906, 'f1-score': 0.5945917759237187, 'support': 72307}, '2': {'precision': 0.46687667932919485, 'recall': 0.5949232585596222, 'f1-score': 0.5231791517416811, 'support': 50820}, 'accuracy': 0.5441052444362848, 'macro avg': {'precision': 0.543320307211852, 'recall': 0.5431433713323904, 'f1-score': 0.5392502268839447, 'support': 174299}, 'weighted avg': {'precision': 0.5557300979216107, 'recall': 0.5441052444362848, 'f1-score': 0.5459932412294413, 'support': 174299}}
[[24694 12152 14326]
 [12200 39909 20198]
 [10714  9872 30234]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.97058797
{'0': {'precision': 0.530766615672276, 'recall': 0.42410145837931446, 'f1-score': 0.4714764308969943, 'support': 58901}, '1': {'precision': 0.5125211343988261, 'recall': 0.5616500611781157, 'f1-score': 0.535962103015746, 'support': 57210}, '2': {'precision': 0.4912691157558761, 'recall': 0.5449061662198391, 'f1-score': 0.516699394601113, 'support': 58188}, 'accuracy': 0.509578368206358, 'macro avg': {'precision': 0.5115189552756594, 'recall': 0.5102192285924231, 'f1-score': 0.5080459761712844, 'support': 174299}, 'weighted avg': {'precision': 0.5115920678619641, 'recall': 0.509578368206358, 'f1-score': 0.5077397434457125, 'support': 174299}}
[[24980 16507 17414]
 [ 9658 32132 15420]
 [12426 14055 31707]]
training model: results/ATVI/W3/deepLOB_L1/seq2seq
Epoch 1/50
2440/2440 - 66s - loss: 12.2024 - accuracy10: 0.4682 - accuracy20: 0.4783 - accuracy30: 0.4746 - accuracy50: 0.4526 - val_loss: 14.1190 - val_accuracy10: 0.6254 - val_accuracy20: 0.5141 - val_accuracy30: 0.4391 - val_accuracy50: 0.3961 - 66s/epoch - 27ms/step
Epoch 2/50
2440/2440 - 60s - loss: 12.2087 - accuracy10: 0.4603 - accuracy20: 0.4762 - accuracy30: 0.4761 - accuracy50: 0.4540 - val_loss: 12.7525 - val_accuracy10: 0.6233 - val_accuracy20: 0.5165 - val_accuracy30: 0.4434 - val_accuracy50: 0.3997 - 60s/epoch - 25ms/step
Epoch 3/50
2440/2440 - 62s - loss: 12.1336 - accuracy10: 0.4734 - accuracy20: 0.4851 - accuracy30: 0.4826 - accuracy50: 0.4574 - val_loss: 12.6735 - val_accuracy10: 0.5250 - val_accuracy20: 0.4791 - val_accuracy30: 0.4447 - val_accuracy50: 0.4111 - 62s/epoch - 25ms/step
Epoch 4/50
2440/2440 - 56s - loss: 11.9375 - accuracy10: 0.4969 - accuracy20: 0.5029 - accuracy30: 0.4965 - accuracy50: 0.4684 - val_loss: 12.2406 - val_accuracy10: 0.5880 - val_accuracy20: 0.5224 - val_accuracy30: 0.4714 - val_accuracy50: 0.4255 - 56s/epoch - 23ms/step
Epoch 5/50
2440/2440 - 57s - loss: 11.7929 - accuracy10: 0.5150 - accuracy20: 0.5158 - accuracy30: 0.5065 - accuracy50: 0.4752 - val_loss: 11.9273 - val_accuracy10: 0.5988 - val_accuracy20: 0.5340 - val_accuracy30: 0.4825 - val_accuracy50: 0.4335 - 57s/epoch - 23ms/step
Epoch 6/50
2440/2440 - 59s - loss: 11.6840 - accuracy10: 0.5296 - accuracy20: 0.5260 - accuracy30: 0.5148 - accuracy50: 0.4810 - val_loss: 12.1041 - val_accuracy10: 0.6241 - val_accuracy20: 0.5382 - val_accuracy30: 0.4741 - val_accuracy50: 0.4242 - 59s/epoch - 24ms/step
Epoch 7/50
2440/2440 - 59s - loss: 11.6179 - accuracy10: 0.5352 - accuracy20: 0.5309 - accuracy30: 0.5189 - accuracy50: 0.4830 - val_loss: 12.2871 - val_accuracy10: 0.6226 - val_accuracy20: 0.5352 - val_accuracy30: 0.4716 - val_accuracy50: 0.4213 - 59s/epoch - 24ms/step
Epoch 8/50
2440/2440 - 56s - loss: 11.5788 - accuracy10: 0.5376 - accuracy20: 0.5335 - accuracy30: 0.5210 - accuracy50: 0.4851 - val_loss: 11.7097 - val_accuracy10: 0.5874 - val_accuracy20: 0.5305 - val_accuracy30: 0.4875 - val_accuracy50: 0.4413 - 56s/epoch - 23ms/step
Epoch 9/50
2440/2440 - 58s - loss: 11.5149 - accuracy10: 0.5435 - accuracy20: 0.5391 - accuracy30: 0.5257 - accuracy50: 0.4888 - val_loss: 11.8417 - val_accuracy10: 0.5910 - val_accuracy20: 0.5247 - val_accuracy30: 0.4794 - val_accuracy50: 0.4388 - 58s/epoch - 24ms/step
Epoch 10/50
2440/2440 - 61s - loss: 11.4655 - accuracy10: 0.5477 - accuracy20: 0.5419 - accuracy30: 0.5285 - accuracy50: 0.4907 - val_loss: 11.7754 - val_accuracy10: 0.5654 - val_accuracy20: 0.5168 - val_accuracy30: 0.4823 - val_accuracy50: 0.4431 - 61s/epoch - 25ms/step
Epoch 11/50
2440/2440 - 60s - loss: 11.4275 - accuracy10: 0.5511 - accuracy20: 0.5449 - accuracy30: 0.5307 - accuracy50: 0.4923 - val_loss: 11.8903 - val_accuracy10: 0.5882 - val_accuracy20: 0.5245 - val_accuracy30: 0.4785 - val_accuracy50: 0.4346 - 60s/epoch - 24ms/step
Epoch 12/50
2440/2440 - 61s - loss: 11.3925 - accuracy10: 0.5543 - accuracy20: 0.5471 - accuracy30: 0.5322 - accuracy50: 0.4932 - val_loss: 11.7871 - val_accuracy10: 0.5793 - val_accuracy20: 0.5217 - val_accuracy30: 0.4784 - val_accuracy50: 0.4340 - 61s/epoch - 25ms/step
Epoch 13/50
2440/2440 - 58s - loss: 11.3632 - accuracy10: 0.5563 - accuracy20: 0.5487 - accuracy30: 0.5339 - accuracy50: 0.4950 - val_loss: 11.9214 - val_accuracy10: 0.5427 - val_accuracy20: 0.4975 - val_accuracy30: 0.4622 - val_accuracy50: 0.4265 - 58s/epoch - 24ms/step
Epoch 14/50
2440/2440 - 59s - loss: 11.3345 - accuracy10: 0.5591 - accuracy20: 0.5504 - accuracy30: 0.5353 - accuracy50: 0.4962 - val_loss: 11.8908 - val_accuracy10: 0.5623 - val_accuracy20: 0.5113 - val_accuracy30: 0.4704 - val_accuracy50: 0.4290 - 59s/epoch - 24ms/step
Epoch 15/50
2440/2440 - 59s - loss: 11.3102 - accuracy10: 0.5612 - accuracy20: 0.5522 - accuracy30: 0.5365 - accuracy50: 0.4970 - val_loss: 11.8795 - val_accuracy10: 0.5593 - val_accuracy20: 0.5111 - val_accuracy30: 0.4711 - val_accuracy50: 0.4293 - 59s/epoch - 24ms/step
Epoch 16/50
2440/2440 - 61s - loss: 11.2876 - accuracy10: 0.5628 - accuracy20: 0.5535 - accuracy30: 0.5376 - accuracy50: 0.4979 - val_loss: 12.1367 - val_accuracy10: 0.5494 - val_accuracy20: 0.4987 - val_accuracy30: 0.4586 - val_accuracy50: 0.4204 - 61s/epoch - 25ms/step
Epoch 17/50
2440/2440 - 57s - loss: 11.2709 - accuracy10: 0.5638 - accuracy20: 0.5545 - accuracy30: 0.5384 - accuracy50: 0.4985 - val_loss: 12.1381 - val_accuracy10: 0.5475 - val_accuracy20: 0.4964 - val_accuracy30: 0.4593 - val_accuracy50: 0.4222 - 57s/epoch - 23ms/step
Epoch 18/50
2440/2440 - 61s - loss: 11.2505 - accuracy10: 0.5649 - accuracy20: 0.5551 - accuracy30: 0.5391 - accuracy50: 0.4991 - val_loss: 12.3319 - val_accuracy10: 0.5637 - val_accuracy20: 0.5042 - val_accuracy30: 0.4594 - val_accuracy50: 0.4200 - 61s/epoch - 25ms/step
testing model: results/ATVI/W3/deepLOB_L1/seq2seq
Evaluating performance on  test set...
6082/6082 - 56s - 56s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.82768434
{'0': {'precision': 0.45986423519950803, 'recall': 0.3520857931374182, 'f1-score': 0.3988217460066748, 'support': 276106}, '1': {'precision': 0.7764491041464763, 'recall': 0.6746593864581759, 'f1-score': 0.7219841653620087, 'support': 1005832}, '2': {'precision': 0.35224780352877794, 'recall': 0.6041598451609148, 'f1-score': 0.44502776348512135, 'support': 274866}, 'accuracy': 0.6050022995829918, 'macro avg': {'precision': 0.529520380958254, 'recall': 0.5436350082521697, 'f1-score': 0.5219445582846016, 'support': 1556804}, 'weighted avg': {'precision': 0.6454053140990099, 'recall': 0.6050022995829918, 'f1-score': 0.6157710638303989, 'support': 1556804}}
[[ 97213 106682  72211]
 [ 94074 678594 233164]
 [ 20108  88695 166063]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.88835984
{'0': {'precision': 0.5223367051479713, 'recall': 0.31128391589586146, 'f1-score': 0.39009355308654975, 'support': 356986}, '1': {'precision': 0.6794291275488499, 'recall': 0.6890087653772328, 'f1-score': 0.6841854157264996, 'support': 846056}, '2': {'precision': 0.40797407807437125, 'recall': 0.5605633165800736, 'f1-score': 0.47224878160881223, 'support': 353762}, 'accuracy': 0.5732063895005408, 'macro avg': {'precision': 0.5365799702570642, 'recall': 0.5202853326177227, 'f1-score': 0.5155092501406205, 'support': 1556804}, 'weighted avg': {'precision': 0.5817223663153288, 'recall': 0.5732063895005408, 'f1-score': 0.5685884586046484, 'support': 1556804}}
[[111124 146660  99202]
 [ 74549 582940 188567]
 [ 27071 128385 198306]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9375758
{'0': {'precision': 0.5538878529432744, 'recall': 0.2642143150516807, 'f1-score': 0.3577672946143708, 'support': 411469}, '1': {'precision': 0.5997412378941203, 'recall': 0.7092497067740273, 'f1-score': 0.6499148047575453, 'support': 739191}, '2': {'precision': 0.4345860302160522, 'recall': 0.5204237905767413, 'f1-score': 0.47364729503825176, 'support': 406144}, 'accuracy': 0.5423637143789456, 'macro avg': {'precision': 0.5294050403511489, 'recall': 0.4979626041341498, 'f1-score': 0.49377646480338927, 'support': 1556804}, 'weighted avg': {'precision': 0.5445358021940958, 'recall': 0.5423637143789456, 'f1-score': 0.526713916708353, 'support': 1556804}}
[[108716 185514 117239]
 [ 57162 524271 157758]
 [ 30400 164377 211367]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.98898804
{'0': {'precision': 0.5342983797734551, 'recall': 0.20486172354788537, 'f1-score': 0.296166653144285, 'support': 436553}, '1': {'precision': 0.5314919183383771, 'recall': 0.7172677322750257, 'f1-score': 0.6105610520035796, 'support': 684867}, '2': {'precision': 0.42727450571515174, 'recall': 0.4565027653749334, 'f1-score': 0.4414053174112294, 'support': 435384}, 'accuracy': 0.5006539037669482, 'macro avg': {'precision': 0.49768826794232796, 'recall': 0.45954407373261486, 'f1-score': 0.44937767418636465, 'support': 1556804}, 'weighted avg': {'precision': 0.5031329053742, 'recall': 0.5006539037669482, 'f1-score': 0.4750927988676823, 'support': 1556804}}
[[ 89433 225500 121620]
 [ 48841 491233 144793]
 [ 29110 207520 198754]]
Evaluating performance on  train set...
2440/2440 - 22s - 22s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9412352
{'0': {'precision': 0.4433645934236718, 'recall': 0.29041277367173335, 'f1-score': 0.35094770457063656, 'support': 143420}, '1': {'precision': 0.6316830685802388, 'recall': 0.6682819970101094, 'f1-score': 0.6494673337341876, 'support': 337805}, '2': {'precision': 0.3940219430128068, 'recall': 0.4762140595136787, 'f1-score': 0.4312365576115896, 'support': 143362}, 'accuracy': 0.5374287329067048, 'macro avg': {'precision': 0.48968986833890576, 'recall': 0.4783029433985071, 'f1-score': 0.4772171986388046, 'support': 624587}, 'weighted avg': {'precision': 0.533890111008991, 'recall': 0.5374287329067048, 'f1-score': 0.5308294406286245, 'support': 624587}}
[[ 41651  69230  32539]
 [ 39599 225749  72457]
 [ 12693  62398  68271]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0064102
{'0': {'precision': 0.49451148149642843, 'recall': 0.27300982554642067, 'f1-score': 0.35179868507938333, 'support': 179532}, '1': {'precision': 0.5128623621992751, 'recall': 0.6692152841796324, 'f1-score': 0.5806984549883112, 'support': 265765}, '2': {'precision': 0.44701819972689216, 'recall': 0.4455072787104691, 'f1-score': 0.4462614603295211, 'support': 179290}, 'accuracy': 0.49111332768693555, 'macro avg': {'precision': 0.48479734780753186, 'recall': 0.462577462812174, 'f1-score': 0.45958620013240514, 'support': 624587}, 'weighted avg': {'precision': 0.488686754631367, 'recall': 0.49111332768693555, 'f1-score': 0.4763126091995514, 'support': 624587}}
[[ 49014  87291  43227]
 [ 32329 177854  55582]
 [ 17773  81642  79875]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.046679
{'0': {'precision': 0.5202947101312172, 'recall': 0.23171976921704304, 'f1-score': 0.3206389596672142, 'support': 201748}, '1': {'precision': 0.4276675872457946, 'recall': 0.6925985660653539, 'f1-score': 0.5288064033776059, 'support': 221349}, '2': {'precision': 0.470215469801323, 'recall': 0.4113504392277532, 'f1-score': 0.4388176494880293, 'support': 201490}, 'accuracy': 0.45300014249416015, 'macro avg': {'precision': 0.4727259223927783, 'recall': 0.4452229248367167, 'f1-score': 0.42942100417761647, 'support': 624587}, 'weighted avg': {'precision': 0.47131292351440357, 'recall': 0.45300014249416015, 'f1-score': 0.4325360688126935, 'support': 624587}}
[[ 46749 105763  49236]
 [ 23896 153306  44147]
 [ 19206  99401  82883]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0784073
{'0': {'precision': 0.5050450958286359, 'recall': 0.17132858775104337, 'f1-score': 0.2558605253857934, 'support': 209177}, '1': {'precision': 0.376190561375084, 'recall': 0.7128378214782065, 'f1-score': 0.49248093888734623, 'support': 206507}, '2': {'precision': 0.45385657959586, 'recall': 0.3526517091664552, 'f1-score': 0.3969042866417221, 'support': 208903}, 'accuracy': 0.4110139980499114, 'macro avg': {'precision': 0.44503074559985994, 'recall': 0.41227270613190165, 'f1-score': 0.38174858363828723, 'support': 624587}, 'weighted avg': {'precision': 0.44532115352279983, 'recall': 0.4110139980499114, 'f1-score': 0.3812685735658107, 'support': 624587}}
[[ 35838 125272  48067]
 [ 18718 147206  40583]
 [ 16404 118829  73670]]
Evaluating performance on  val set...
826/826 - 7s - 7s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8746712
{'0': {'precision': 0.38242609236334857, 'recall': 0.3388255915863278, 'f1-score': 0.35930799155569126, 'support': 39935}, '1': {'precision': 0.6992782973709404, 'recall': 0.7174266178081674, 'f1-score': 0.7082362154804304, 'support': 132355}, '2': {'precision': 0.3815626086524611, 'recall': 0.39245938489833454, 'f1-score': 0.38693429370136245, 'support': 39148}, 'accuracy': 0.5857509057028538, 'macro avg': {'precision': 0.4877556661289167, 'recall': 0.48290386476427666, 'f1-score': 0.4848261669124947, 'support': 211438}, 'weighted avg': {'precision': 0.5806079231291806, 'recall': 0.5857509057028538, 'f1-score': 0.5828435412390858, 'support': 211438}}
[[13531 20728  5676]
 [18174 94955 19226]
 [ 3677 20107 15364]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9491065
{'0': {'precision': 0.4342436219906576, 'recall': 0.326073968431399, 'f1-score': 0.37246419883543025, 'support': 51887}, '1': {'precision': 0.5861586777617313, 'recall': 0.7063015615792575, 'f1-score': 0.6406460745708356, 'support': 108608}, '2': {'precision': 0.4375946355180619, 'recall': 0.357399446440139, 'f1-score': 0.393452188006483, 'support': 50943}, 'accuracy': 0.5289304666143266, 'macro avg': {'precision': 0.48599897842348366, 'recall': 0.46325832548359847, 'f1-score': 0.4688541538042496, 'support': 211438}, 'weighted avg': {'precision': 0.5130842327574607, 'recall': 0.5289304666143266, 'f1-score': 0.5152762207624814, 'support': 211438}}
[[16919 27156  7812]
 [16310 76710 15588]
 [ 5733 27003 18207]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0001273
{'0': {'precision': 0.46606187359100415, 'recall': 0.2859976332149941, 'f1-score': 0.35447352655607656, 'support': 59997}, '1': {'precision': 0.49987666963157856, 'recall': 0.7211080200987686, 'f1-score': 0.5904497878858779, 'support': 92742}, '2': {'precision': 0.4620169466620953, 'recall': 0.32140240889964056, 'f1-score': 0.3790903519435765, 'support': 58699}, 'accuracy': 0.48667694548756607, 'macro avg': {'precision': 0.47598516329489265, 'recall': 0.4428360207378011, 'f1-score': 0.44133788879517694, 'support': 211438}, 'weighted avg': {'precision': 0.47977094503792916, 'recall': 0.48667694548756607, 'f1-score': 0.4648126967225996, 'support': 211438}}
[[17159 33700  9138]
 [13035 66877 12830]
 [ 6623 33210 18866]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0453016
{'0': {'precision': 0.4715029387069689, 'recall': 0.21614090188289994, 'f1-score': 0.29640655350054895, 'support': 64953}, '1': {'precision': 0.4333970946994899, 'recall': 0.7472010132511262, 'f1-score': 0.5485943880796039, 'support': 83691}, '2': {'precision': 0.44893645484949835, 'recall': 0.2672070579991719, 'f1-score': 0.3350138266329903, 'support': 62794}, 'accuracy': 0.44151004076845224, 'macro avg': {'precision': 0.4512788294186523, 'recall': 0.4101829910443993, 'f1-score': 0.3933382560710477, 'support': 211438}, 'weighted avg': {'precision': 0.4497180373260633, 'recall': 0.44151004076845224, 'f1-score': 0.40769287465774023, 'support': 211438}}
[[14039 41718  9196]
 [ 9757 62534 11400]
 [ 5979 40036 16779]]
training model: results/ATVI/W3/deepOF_L1/seq2seq
Epoch 1/50
2440/2440 - 66s - loss: 12.6328 - accuracy10: 0.4506 - accuracy20: 0.4509 - accuracy30: 0.4454 - accuracy50: 0.4294 - val_loss: 14.2927 - val_accuracy10: 0.6223 - val_accuracy20: 0.5131 - val_accuracy30: 0.4390 - val_accuracy50: 0.3968 - 66s/epoch - 27ms/step
Epoch 2/50
2440/2440 - 56s - loss: 12.6616 - accuracy10: 0.4260 - accuracy20: 0.4393 - accuracy30: 0.4406 - accuracy50: 0.4278 - val_loss: 12.4490 - val_accuracy10: 0.6168 - val_accuracy20: 0.5145 - val_accuracy30: 0.4411 - val_accuracy50: 0.3984 - 56s/epoch - 23ms/step
Epoch 3/50
2440/2440 - 58s - loss: 12.6955 - accuracy10: 0.4173 - accuracy20: 0.4306 - accuracy30: 0.4320 - accuracy50: 0.4204 - val_loss: 12.4377 - val_accuracy10: 0.6199 - val_accuracy20: 0.5177 - val_accuracy30: 0.4434 - val_accuracy50: 0.3997 - 58s/epoch - 24ms/step
Epoch 4/50
2440/2440 - 56s - loss: 12.6729 - accuracy10: 0.4295 - accuracy20: 0.4369 - accuracy30: 0.4354 - accuracy50: 0.4223 - val_loss: 12.4126 - val_accuracy10: 0.6216 - val_accuracy20: 0.5201 - val_accuracy30: 0.4455 - val_accuracy50: 0.4012 - 56s/epoch - 23ms/step
Epoch 5/50
2440/2440 - 53s - loss: 12.6499 - accuracy10: 0.4380 - accuracy20: 0.4416 - accuracy30: 0.4379 - accuracy50: 0.4245 - val_loss: 12.3747 - val_accuracy10: 0.6212 - val_accuracy20: 0.5215 - val_accuracy30: 0.4479 - val_accuracy50: 0.4030 - 53s/epoch - 22ms/step
Epoch 6/50
2440/2440 - 54s - loss: 12.6241 - accuracy10: 0.4448 - accuracy20: 0.4460 - accuracy30: 0.4414 - accuracy50: 0.4263 - val_loss: 12.3875 - val_accuracy10: 0.6210 - val_accuracy20: 0.5233 - val_accuracy30: 0.4500 - val_accuracy50: 0.4051 - 54s/epoch - 22ms/step
Epoch 7/50
2440/2440 - 57s - loss: 12.6004 - accuracy10: 0.4502 - accuracy20: 0.4493 - accuracy30: 0.4441 - accuracy50: 0.4290 - val_loss: 12.3599 - val_accuracy10: 0.6192 - val_accuracy20: 0.5246 - val_accuracy30: 0.4530 - val_accuracy50: 0.4081 - 57s/epoch - 23ms/step
Epoch 8/50
2440/2440 - 54s - loss: 12.5741 - accuracy10: 0.4543 - accuracy20: 0.4528 - accuracy30: 0.4464 - accuracy50: 0.4302 - val_loss: 12.3715 - val_accuracy10: 0.6208 - val_accuracy20: 0.5241 - val_accuracy30: 0.4537 - val_accuracy50: 0.4091 - 54s/epoch - 22ms/step
Epoch 9/50
2440/2440 - 56s - loss: 12.5416 - accuracy10: 0.4577 - accuracy20: 0.4561 - accuracy30: 0.4498 - accuracy50: 0.4327 - val_loss: 12.3930 - val_accuracy10: 0.6212 - val_accuracy20: 0.5252 - val_accuracy30: 0.4548 - val_accuracy50: 0.4104 - 56s/epoch - 23ms/step
Epoch 10/50
2440/2440 - 56s - loss: 12.5063 - accuracy10: 0.4608 - accuracy20: 0.4594 - accuracy30: 0.4527 - accuracy50: 0.4346 - val_loss: 12.3937 - val_accuracy10: 0.6208 - val_accuracy20: 0.5254 - val_accuracy30: 0.4561 - val_accuracy50: 0.4120 - 56s/epoch - 23ms/step
Epoch 11/50
2440/2440 - 57s - loss: 12.4772 - accuracy10: 0.4631 - accuracy20: 0.4615 - accuracy30: 0.4552 - accuracy50: 0.4371 - val_loss: 12.4040 - val_accuracy10: 0.6182 - val_accuracy20: 0.5246 - val_accuracy30: 0.4559 - val_accuracy50: 0.4120 - 57s/epoch - 23ms/step
Epoch 12/50
2440/2440 - 57s - loss: 12.4407 - accuracy10: 0.4670 - accuracy20: 0.4653 - accuracy30: 0.4580 - accuracy50: 0.4390 - val_loss: 12.4626 - val_accuracy10: 0.6196 - val_accuracy20: 0.5246 - val_accuracy30: 0.4555 - val_accuracy50: 0.4123 - 57s/epoch - 23ms/step
Epoch 13/50
2440/2440 - 57s - loss: 12.4104 - accuracy10: 0.4686 - accuracy20: 0.4670 - accuracy30: 0.4608 - accuracy50: 0.4415 - val_loss: 12.4667 - val_accuracy10: 0.6197 - val_accuracy20: 0.5253 - val_accuracy30: 0.4561 - val_accuracy50: 0.4125 - 57s/epoch - 23ms/step
Epoch 14/50
2440/2440 - 56s - loss: 12.3816 - accuracy10: 0.4700 - accuracy20: 0.4693 - accuracy30: 0.4631 - accuracy50: 0.4433 - val_loss: 12.5222 - val_accuracy10: 0.6180 - val_accuracy20: 0.5244 - val_accuracy30: 0.4557 - val_accuracy50: 0.4125 - 56s/epoch - 23ms/step
Epoch 15/50
2440/2440 - 57s - loss: 12.3555 - accuracy10: 0.4715 - accuracy20: 0.4707 - accuracy30: 0.4649 - accuracy50: 0.4448 - val_loss: 12.5525 - val_accuracy10: 0.6197 - val_accuracy20: 0.5261 - val_accuracy30: 0.4575 - val_accuracy50: 0.4135 - 57s/epoch - 23ms/step
Epoch 16/50
2440/2440 - 55s - loss: 12.3259 - accuracy10: 0.4740 - accuracy20: 0.4738 - accuracy30: 0.4677 - accuracy50: 0.4471 - val_loss: 12.5999 - val_accuracy10: 0.6186 - val_accuracy20: 0.5260 - val_accuracy30: 0.4579 - val_accuracy50: 0.4137 - 55s/epoch - 23ms/step
Epoch 17/50
2440/2440 - 55s - loss: 12.3018 - accuracy10: 0.4766 - accuracy20: 0.4767 - accuracy30: 0.4711 - accuracy50: 0.4495 - val_loss: 12.5142 - val_accuracy10: 0.6197 - val_accuracy20: 0.5268 - val_accuracy30: 0.4579 - val_accuracy50: 0.4139 - 55s/epoch - 23ms/step
testing model: results/ATVI/W3/deepOF_L1/seq2seq
Evaluating performance on  test set...
6082/6082 - 56s - 56s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.90331584
{'0': {'precision': 0.40482076637824477, 'recall': 0.10675247912033785, 'f1-score': 0.168951839411205, 'support': 276106}, '1': {'precision': 0.6628524328552728, 'recall': 0.9258532016873644, 'f1-score': 0.7725837107413402, 'support': 1005829}, '2': {'precision': 0.4199830544911921, 'recall': 0.12082658759754789, 'f1-score': 0.18766351549123866, 'support': 274865}, 'accuracy': 0.638448098663926, 'macro avg': {'precision': 0.49588541790823654, 'recall': 0.38447742280175, 'f1-score': 0.376399688547928, 'support': 1556800}, 'weighted avg': {'precision': 0.574208815827813, 'recall': 0.638448098663926, 'f1-score': 0.5622545284874235, 'support': 1556800}}
[[ 29475 239993   6638]
 [ 35351 931250  39228]
 [  7984 233670  33211]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.97516286
{'0': {'precision': 0.4899961320721544, 'recall': 0.07807050716416657, 'f1-score': 0.13468224992328381, 'support': 356985}, '1': {'precision': 0.5573612858804815, 'recall': 0.9433984788222988, 'f1-score': 0.7007301256616805, 'support': 846055}, '2': {'precision': 0.5107107077612116, 'recall': 0.09799016282225237, 'f1-score': 0.16443093094517544, 'support': 353760}, 'accuracy': 0.5528661356628982, 'macro avg': {'precision': 0.5193560419046158, 'recall': 0.3731530496029059, 'f1-score': 0.33328110217671325, 'support': 1556800}, 'weighted avg': {'precision': 0.5313133298503309, 'recall': 0.5528661356628982, 'f1-score': 0.44906529778181, 'support': 1556800}}
[[ 27870 322046   7069]
 [ 21746 798167  26142]
 [  7262 311833  34665]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.023534
{'0': {'precision': 0.5340863441952787, 'recall': 0.05493028602536777, 'f1-score': 0.09961523713821054, 'support': 411467}, '1': {'precision': 0.48507618537013564, 'recall': 0.9583868829394337, 'f1-score': 0.6441323834207491, 'support': 739190}, '2': {'precision': 0.5522117342217286, 'recall': 0.07346181024909945, 'f1-score': 0.1296729708174969, 'support': 406143}, 'accuracy': 0.48873843782117166, 'macro avg': {'precision': 0.523791421262381, 'recall': 0.362259659737967, 'f1-score': 0.2911401971254855, 'support': 1556800}, 'weighted avg': {'precision': 0.515544258493554, 'recall': 0.48873843782117166, 'f1-score': 0.3660010076227276, 'support': 1556800}}
[[ 22602 382018   6847]
 [ 13413 708430  17347]
 [  6304 370003  29836]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0498341
{'0': {'precision': 0.5346059683716006, 'recall': 0.037015063497590206, 'f1-score': 0.069236339330474, 'support': 436552}, '1': {'precision': 0.4467373158993097, 'recall': 0.9686566423212716, 'f1-score': 0.611469429984953, 'support': 684866}, '2': {'precision': 0.5576770470121438, 'recall': 0.05326586767482349, 'f1-score': 0.09724362482100439, 'support': 435382}, 'accuracy': 0.45140673175745116, 'macro avg': {'precision': 0.5130067770943514, 'recall': 0.3529791911645617, 'f1-score': 0.2593164647121438, 'support': 1556800}, 'weighted avg': {'precision': 0.5024030391684846, 'recall': 0.45140673175745116, 'f1-score': 0.31560766245201083, 'support': 1556800}}
[[ 16159 414415   5978]
 [  9050 663400  12416]
 [  5017 407174  23191]]
Evaluating performance on  train set...
2440/2440 - 21s - 21s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9840168
{'0': {'precision': 0.44046463245492373, 'recall': 0.08861651365906745, 'f1-score': 0.14754802889864568, 'support': 143348}, '1': {'precision': 0.5517830804284961, 'recall': 0.9267967820419472, 'f1-score': 0.6917323795711384, 'support': 337854}, '2': {'precision': 0.44729767968307865, 'recall': 0.08819734557095332, 'f1-score': 0.14734205237249134, 'support': 143383}, 'accuracy': 0.5419134305178639, 'macro avg': {'precision': 0.4798484641888328, 'recall': 0.36787021375732265, 'f1-score': 0.32887415361409184, 'support': 624585}, 'weighted avg': {'precision': 0.5022482579540597, 'recall': 0.5419134305178639, 'f1-score': 0.4418639764155646, 'support': 624585}}
[[ 12703 127325   3320]
 [ 12426 313122  12306]
 [  3711 127026  12646]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0624745
{'0': {'precision': 0.527097219030108, 'recall': 0.0638990276113789, 'f1-score': 0.113980418468267, 'support': 179455}, '1': {'precision': 0.4337197471813554, 'recall': 0.9445430880117971, 'f1-score': 0.5944686004349262, 'support': 265828}, '2': {'precision': 0.5244386837814107, 'recall': 0.06995460173338836, 'f1-score': 0.12344318198593633, 'support': 179302}, 'accuracy': 0.4404460561813044, 'macro avg': {'precision': 0.4950852166642914, 'recall': 0.3594655724521881, 'f1-score': 0.2772974002963765, 'support': 624585}, 'weighted avg': {'precision': 0.4865918798468549, 'recall': 0.4404460561813044, 'f1-score': 0.32119625756155007, 'support': 624585}}
[[ 11467 164423   3565]
 [  6933 251086   7809]
 [  3355 163404  12543]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1092318
{'0': {'precision': 0.5649779030295267, 'recall': 0.043746497453369636, 'f1-score': 0.08120523631543093, 'support': 201639}, '1': {'precision': 0.36024482855565376, 'recall': 0.9599386240043324, 'f1-score': 0.5238861680288754, 'support': 221585}, '2': {'precision': 0.5629657630413651, 'recall': 0.0517726868658777, 'f1-score': 0.09482488095725376, 'support': 201361}, 'accuracy': 0.37137299166646653, 'macro avg': {'precision': 0.49606283154218184, 'recall': 0.35181926944119324, 'f1-score': 0.23330542843385338, 'support': 624585}, 'weighted avg': {'precision': 0.4916957319440069, 'recall': 0.37137299166646653, 'f1-score': 0.24264670467993807, 'support': 624585}}
[[  8821 189580   3238]
 [  4022 212708   4855]
 [  2770 188166  10425]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1260972
{'0': {'precision': 0.5601891252955082, 'recall': 0.028307251224465417, 'f1-score': 0.053891289515578804, 'support': 209275}, '1': {'precision': 0.3337703290461111, 'recall': 0.9706996618446423, 'f1-score': 0.49673928538225537, 'support': 206414}, '2': {'precision': 0.5590189064895248, 'recall': 0.03665939031862745, 'f1-score': 0.06880657696713763, 'support': 208896}, 'accuracy': 0.3425442493815894, 'macro avg': {'precision': 0.4843261202770481, 'recall': 0.34522210112924506, 'f1-score': 0.20647905062165728, 'support': 624585}, 'weighted avg': {'precision': 0.48497043858878647, 'recall': 0.3425442493815894, 'f1-score': 0.2052330125897881, 'support': 624585}}
[[  5924 200798   2553]
 [  2560 200366   3488]
 [  2091 199147   7658]]
Evaluating performance on  val set...
826/826 - 7s - 7s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9182093
{'0': {'precision': 0.42530178657653306, 'recall': 0.11020469445973675, 'f1-score': 0.17505018184708945, 'support': 39962}, '1': {'precision': 0.639167369374434, 'recall': 0.9279161502886679, 'f1-score': 0.7569395215228422, 'support': 132332}, '2': {'precision': 0.41320102575537965, 'recall': 0.09467606785203352, 'f1-score': 0.15405399787999086, 'support': 39144}, 'accuracy': 0.6191082019315355, 'macro avg': {'precision': 0.4925567272354489, 'recall': 0.37759897086681277, 'f1-score': 0.3620145670833075, 'support': 211438}, 'weighted avg': {'precision': 0.5569128882764574, 'recall': 0.6191082019315355, 'f1-score': 0.5353482620065858, 'support': 211438}}
[[  4404  34669    889]
 [  5165 122793   4374]
 [   786  34652   3706]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.99601716
{'0': {'precision': 0.5322435319860986, 'recall': 0.07984012666293372, 'f1-score': 0.13885157824042985, 'support': 51791}, '1': {'precision': 0.5245616001467277, 'recall': 0.9479886935945715, 'f1-score': 0.6753975985017695, 'support': 108611}, '2': {'precision': 0.5104914038175172, 'recall': 0.07388901951563602, 'f1-score': 0.1290929941974907, 'support': 51036}, 'accuracy': 0.5243522923977715, 'macro avg': {'precision': 0.5224321786501145, 'recall': 0.36723927992438044, 'f1-score': 0.31444739031323005, 'support': 211438}, 'weighted avg': {'precision': 0.5230470587304983, 'recall': 0.5243522923977715, 'f1-score': 0.4121078553116702, 'support': 211438}}
[[  4135  46801    855]
 [  2888 102962   2761]
 [   746  46519   3771]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0476032
{'0': {'precision': 0.5908590308370044, 'recall': 0.05364731763411829, 'f1-score': 0.0983636613649906, 'support': 60003}, '1': {'precision': 0.446203368683718, 'recall': 0.9640300181143794, 'f1-score': 0.6100457493372998, 'support': 92744}, '2': {'precision': 0.5650934995547641, 'recall': 0.05406280349627711, 'f1-score': 0.09868441514011134, 'support': 58691}, 'accuracy': 0.45308790283676537, 'macro avg': {'precision': 0.5340519663584955, 'recall': 0.35724671308159156, 'f1-score': 0.2690312752808006, 'support': 211438}, 'weighted avg': {'precision': 0.5202560667187742, 'recall': 0.45308790283676537, 'f1-score': 0.32289410966056403, 'support': 211438}}
[[ 3219 56033   751]
 [ 1645 89408  1691]
 [  584 54934  3173]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0790472
{'0': {'precision': 0.6005449591280654, 'recall': 0.03397721491667566, 'f1-score': 0.06431562513678742, 'support': 64867}, '1': {'precision': 0.4010122381656006, 'recall': 0.9744950910804395, 'f1-score': 0.5682041080359193, 'support': 83827}, '2': {'precision': 0.5759665107116474, 'recall': 0.03727846487313528, 'f1-score': 0.07002469875009355, 'support': 62744}, 'accuracy': 0.4078358667789139, 'macro avg': {'precision': 0.5258412360017711, 'recall': 0.3485835902900835, 'f1-score': 0.23418147730760008, 'support': 211438}, 'weighted avg': {'precision': 0.5141443141751229, 'recall': 0.4078358667789139, 'f1-score': 0.26578210689871673, 'support': 211438}}
[[ 2204 62061   602]
 [ 1018 81689  1120]
 [  448 59957  2339]]
training model: results/ATVI/W3/deepLOB_L2/seq2seq
Epoch 1/50
2440/2440 - 121s - loss: 12.2838 - accuracy10: 0.4620 - accuracy20: 0.4694 - accuracy30: 0.4667 - accuracy50: 0.4459 - val_loss: 12.6843 - val_accuracy10: 0.6222 - val_accuracy20: 0.5294 - val_accuracy30: 0.4617 - val_accuracy50: 0.4163 - 121s/epoch - 49ms/step
Epoch 2/50
2440/2440 - 113s - loss: 11.9884 - accuracy10: 0.4871 - accuracy20: 0.4957 - accuracy30: 0.4910 - accuracy50: 0.4642 - val_loss: 13.2120 - val_accuracy10: 0.6309 - val_accuracy20: 0.5376 - val_accuracy30: 0.4697 - val_accuracy50: 0.4207 - 113s/epoch - 46ms/step
Epoch 3/50
2440/2440 - 114s - loss: 11.6114 - accuracy10: 0.5373 - accuracy20: 0.5317 - accuracy30: 0.5184 - accuracy50: 0.4841 - val_loss: 12.7848 - val_accuracy10: 0.6297 - val_accuracy20: 0.5573 - val_accuracy30: 0.4999 - val_accuracy50: 0.4478 - 114s/epoch - 47ms/step
Epoch 4/50
2440/2440 - 115s - loss: 11.3895 - accuracy10: 0.5576 - accuracy20: 0.5472 - accuracy30: 0.5305 - accuracy50: 0.4935 - val_loss: 11.5075 - val_accuracy10: 0.5810 - val_accuracy20: 0.5572 - val_accuracy30: 0.5283 - val_accuracy50: 0.4840 - 115s/epoch - 47ms/step
Epoch 5/50
2440/2440 - 115s - loss: 11.2731 - accuracy10: 0.5663 - accuracy20: 0.5540 - accuracy30: 0.5359 - accuracy50: 0.4974 - val_loss: 11.7184 - val_accuracy10: 0.5234 - val_accuracy20: 0.5181 - val_accuracy30: 0.5021 - val_accuracy50: 0.4681 - 115s/epoch - 47ms/step
Epoch 6/50
2440/2440 - 114s - loss: 11.2057 - accuracy10: 0.5720 - accuracy20: 0.5590 - accuracy30: 0.5401 - accuracy50: 0.5005 - val_loss: 11.9327 - val_accuracy10: 0.5195 - val_accuracy20: 0.5126 - val_accuracy30: 0.4968 - val_accuracy50: 0.4639 - 114s/epoch - 47ms/step
Epoch 7/50
2440/2440 - 114s - loss: 11.1520 - accuracy10: 0.5758 - accuracy20: 0.5624 - accuracy30: 0.5428 - accuracy50: 0.5026 - val_loss: 11.9843 - val_accuracy10: 0.5247 - val_accuracy20: 0.5188 - val_accuracy30: 0.5022 - val_accuracy50: 0.4682 - 114s/epoch - 47ms/step
Epoch 8/50
2440/2440 - 116s - loss: 11.1092 - accuracy10: 0.5786 - accuracy20: 0.5648 - accuracy30: 0.5450 - accuracy50: 0.5045 - val_loss: 12.0734 - val_accuracy10: 0.5308 - val_accuracy20: 0.5223 - val_accuracy30: 0.5046 - val_accuracy50: 0.4695 - 116s/epoch - 48ms/step
Epoch 9/50
2440/2440 - 115s - loss: 11.0738 - accuracy10: 0.5810 - accuracy20: 0.5670 - accuracy30: 0.5469 - accuracy50: 0.5063 - val_loss: 11.8367 - val_accuracy10: 0.5317 - val_accuracy20: 0.5274 - val_accuracy30: 0.5113 - val_accuracy50: 0.4755 - 115s/epoch - 47ms/step
Epoch 10/50
2440/2440 - 114s - loss: 11.0447 - accuracy10: 0.5817 - accuracy20: 0.5685 - accuracy30: 0.5483 - accuracy50: 0.5073 - val_loss: 11.5894 - val_accuracy10: 0.5523 - val_accuracy20: 0.5445 - val_accuracy30: 0.5243 - val_accuracy50: 0.4841 - 114s/epoch - 47ms/step
Epoch 11/50
2440/2440 - 115s - loss: 11.0177 - accuracy10: 0.5834 - accuracy20: 0.5699 - accuracy30: 0.5498 - accuracy50: 0.5092 - val_loss: 11.5119 - val_accuracy10: 0.5560 - val_accuracy20: 0.5483 - val_accuracy30: 0.5279 - val_accuracy50: 0.4866 - 115s/epoch - 47ms/step
Epoch 12/50
2440/2440 - 113s - loss: 10.9979 - accuracy10: 0.5847 - accuracy20: 0.5709 - accuracy30: 0.5511 - accuracy50: 0.5097 - val_loss: 11.6982 - val_accuracy10: 0.5455 - val_accuracy20: 0.5387 - val_accuracy30: 0.5195 - val_accuracy50: 0.4816 - 113s/epoch - 46ms/step
Epoch 13/50
2440/2440 - 113s - loss: 10.9707 - accuracy10: 0.5864 - accuracy20: 0.5729 - accuracy30: 0.5527 - accuracy50: 0.5116 - val_loss: 11.6769 - val_accuracy10: 0.5397 - val_accuracy20: 0.5370 - val_accuracy30: 0.5199 - val_accuracy50: 0.4830 - 113s/epoch - 47ms/step
Epoch 14/50
2440/2440 - 115s - loss: 10.9517 - accuracy10: 0.5865 - accuracy20: 0.5736 - accuracy30: 0.5536 - accuracy50: 0.5125 - val_loss: 11.8914 - val_accuracy10: 0.5320 - val_accuracy20: 0.5284 - val_accuracy30: 0.5126 - val_accuracy50: 0.4769 - 115s/epoch - 47ms/step
testing model: results/ATVI/W3/deepLOB_L2/seq2seq
Evaluating performance on  test set...
6082/6082 - 99s - 99s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.87196285
{'0': {'precision': 0.37099014787329326, 'recall': 0.5880784915938082, 'f1-score': 0.4549649891142624, 'support': 276106}, '1': {'precision': 0.8151824792387816, 'recall': 0.5649631349966993, 'f1-score': 0.6673905192536371, 'support': 1005832}, '2': {'precision': 0.3635564485746578, 'recall': 0.5582174586889612, 'f1-score': 0.4403326134839038, 'support': 274866}, 'accuracy': 0.5678717423644852, 'macro avg': {'precision': 0.5165763585622443, 'recall': 0.5704196950931563, 'f1-score': 0.5208960406172678, 'support': 1556804}, 'weighted avg': {'precision': 0.6566648955297697, 'recall': 0.5678717423644852, 'f1-score': 0.5896270617137248, 'support': 1556804}}
[[162372  67276  46458]
 [215428 568258 222146]
 [ 59872  61559 153435]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9049601
{'0': {'precision': 0.43672347039186293, 'recall': 0.5320992980116868, 'f1-score': 0.479716744072107, 'support': 356986}, '1': {'precision': 0.7186430069254355, 'recall': 0.5889645602655144, 'f1-score': 0.6473735288500639, 'support': 846056}, '2': {'precision': 0.42701239293299414, 'recall': 0.5171895228995765, 'f1-score': 0.4677947207478088, 'support': 353762}, 'accuracy': 0.5596150832089332, 'macro avg': {'precision': 0.5274596234167642, 'recall': 0.5460844603922593, 'f1-score': 0.5316283312233266, 'support': 1556804}, 'weighted avg': {'precision': 0.5877279033310409, 'recall': 0.5596150832089332, 'f1-score': 0.5681218804199379, 'support': 1556804}}
[[189952 100365  66669]
 [168920 498297 178839]
 [ 76076  94724 182962]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9394725
{'0': {'precision': 0.47009640393531604, 'recall': 0.48494297261762126, 'f1-score': 0.4774042895782318, 'support': 411469}, '1': {'precision': 0.6390067718807876, 'recall': 0.6086613608661361, 'f1-score': 0.62346504036988, 'support': 739191}, '2': {'precision': 0.4566586962816286, 'recall': 0.48151640797352663, 'f1-score': 0.4687582394929986, 'support': 406144}, 'accuracy': 0.5427921562380363, 'macro avg': {'precision': 0.5219206240325774, 'recall': 0.5250402471524279, 'f1-score': 0.5232091898137035, 'support': 1556804}, 'weighted avg': {'precision': 0.5467915945018111, 'recall': 0.5427921562380363, 'f1-score': 0.5445002445427696, 'support': 1556804}}
[[199539 130297  81633]
 [138220 449917 151054]
 [ 86705 123874 195565]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9850872
{'0': {'precision': 0.46224836166989414, 'recall': 0.427045513374092, 'f1-score': 0.4439501821732193, 'support': 436553}, '1': {'precision': 0.5722005724305301, 'recall': 0.6103842059845196, 'f1-score': 0.5906759471993083, 'support': 684867}, '2': {'precision': 0.4505849695456437, 'recall': 0.437694081546405, 'f1-score': 0.44404598793911776, 'support': 435384}, 'accuracy': 0.510677644713143, 'macro avg': {'precision': 0.495011301215356, 'recall': 0.4917079336350056, 'f1-score': 0.49289070577054844, 'support': 1556804}, 'weighted avg': {'precision': 0.5073565361159901, 'recall': 0.510677644713143, 'f1-score': 0.5085243654446538, 'support': 1556804}}
[[186428 158077  92048]
 [126520 418032 140315]
 [ 90359 154460 190565]]
Evaluating performance on  train set...
2440/2440 - 41s - 41s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9350672
{'0': {'precision': 0.43639885682325097, 'recall': 0.4461023567145447, 'f1-score': 0.4411972595843864, 'support': 143420}, '1': {'precision': 0.709284434163225, 'recall': 0.5963381240656592, 'f1-score': 0.6479259204461757, 'support': 337805}, '2': {'precision': 0.40500090222462815, 'recall': 0.547955525174035, 'f1-score': 0.46575577999982215, 'support': 143362}, 'accuracy': 0.5507351257711095, 'macro avg': {'precision': 0.516894731070368, 'recall': 0.5301320019847463, 'f1-score': 0.5182929866767948, 'support': 624587}, 'weighted avg': {'precision': 0.5767809635372271, 'recall': 0.5507351257711095, 'f1-score': 0.5586424415785913, 'support': 624587}}
[[ 63980  44796  34644]
 [ 55594 201446  80765]
 [ 27035  37771  78556]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.98698467
{'0': {'precision': 0.493670797695933, 'recall': 0.3938350823251565, 'f1-score': 0.43813767013573673, 'support': 179532}, '1': {'precision': 0.5857579594663607, 'recall': 0.6301055443719075, 'f1-score': 0.6071229817402669, 'support': 265765}, '2': {'precision': 0.46409277865313386, 'recall': 0.5059902950527079, 'f1-score': 0.48413676800990485, 'support': 179290}, 'accuracy': 0.5265639534604467, 'macro avg': {'precision': 0.5145071786051425, 'recall': 0.5099769739165906, 'f1-score': 0.5097991399619696, 'support': 624587}, 'weighted avg': {'precision': 0.5243638821080874, 'recall': 0.5265639534604467, 'f1-score': 0.5232460050777665, 'support': 624587}}
[[ 70706  63137  45689]
 [ 39237 167460  59068]
 [ 33282  55289  90719]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0245438
{'0': {'precision': 0.5171446633193579, 'recall': 0.3527717746892163, 'f1-score': 0.41942888461300465, 'support': 201748}, '1': {'precision': 0.4975871991688482, 'recall': 0.6577712119774655, 'f1-score': 0.5665748946892238, 'support': 221349}, '2': {'precision': 0.48870126261846697, 'recall': 0.47140304729763266, 'f1-score': 0.4798963238414745, 'support': 201490}, 'accuracy': 0.49913142604633143, 'macro avg': {'precision': 0.5011443750355576, 'recall': 0.49398201132143815, 'f1-score': 0.4886333677145676, 'support': 624587}, 'weighted avg': {'precision': 0.501037882455405, 'recall': 0.49913142604633143, 'f1-score': 0.49108296405190655, 'support': 624587}}
[[ 71171  77397  53180]
 [ 29557 145597  46195]
 [ 36895  69612  94983]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0652233
{'0': {'precision': 0.4933506098507185, 'recall': 0.3039770146813464, 'f1-score': 0.37617471403089975, 'support': 209177}, '1': {'precision': 0.44037257897590065, 'recall': 0.6490530587340865, 'f1-score': 0.5247263502403733, 'support': 206507}, '2': {'precision': 0.4706226677398112, 'recall': 0.43105173214362646, 'f1-score': 0.4499688937415207, 'support': 208903}, 'accuracy': 0.4605715456773836, 'macro avg': {'precision': 0.4681152855221435, 'recall': 0.4613606018530198, 'f1-score': 0.4502899860042646, 'support': 624587}, 'weighted avg': {'precision': 0.4682327807690039, 'recall': 0.4605715456773836, 'f1-score': 0.4499719244480196, 'support': 624587}}
[[ 63585  88873  56719]
 [ 27902 134034  44571]
 [ 37397  81458  90048]]
Evaluating performance on  val set...
826/826 - 14s - 14s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.87241256
{'0': {'precision': 0.43829863973619126, 'recall': 0.4260172780768749, 'f1-score': 0.4320707038640779, 'support': 39935}, '1': {'precision': 0.7744545300783673, 'recall': 0.6227116467077178, 'f1-score': 0.6903428722196862, 'support': 132355}, '2': {'precision': 0.35119335347432024, 'recall': 0.5938745274343517, 'f1-score': 0.4413752515472529, 'support': 39148}, 'accuracy': 0.5802220982037287, 'macro avg': {'precision': 0.5213155077629597, 'recall': 0.5475344840729814, 'f1-score': 0.5212629425436723, 'support': 211438}, 'weighted avg': {'precision': 0.6325963304051295, 'recall': 0.5802220982037287, 'f1-score': 0.5954654922909807, 'support': 211438}}
[[17013 13694  9228]
 [16213 82419 33723]
 [ 5590 10309 23249]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9307901
{'0': {'precision': 0.5027563105003561, 'recall': 0.3673559851215141, 'f1-score': 0.42452115812917596, 'support': 51887}, '1': {'precision': 0.6609617330128176, 'recall': 0.6556975545079552, 'f1-score': 0.6583191203183716, 'support': 108608}, '2': {'precision': 0.4179410781064729, 'recall': 0.5396816049310014, 'f1-score': 0.47107303491111585, 'support': 50943}, 'accuracy': 0.5569859722471836, 'macro avg': {'precision': 0.5272197072065489, 'recall': 0.5209117148534902, 'f1-score': 0.5179711044528877, 'support': 211438}, 'weighted avg': {'precision': 0.5635856417671663, 'recall': 0.5569859722471836, 'f1-score': 0.555830673619989, 'support': 211438}}
[[19061 20085 12741]
 [11846 71214 25548]
 [ 7006 16444 27493]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.97877157
{'0': {'precision': 0.5331315263274827, 'recall': 0.319965998299915, 'f1-score': 0.39991667100671835, 'support': 59997}, '1': {'precision': 0.5720192845921886, 'recall': 0.6831640464945764, 'f1-score': 0.6226708074534162, 'support': 92742}, '2': {'precision': 0.4499907218407868, 'recall': 0.4957495016950885, 'f1-score': 0.471763113312312, 'support': 58699}, 'accuracy': 0.528074423708132, 'macro avg': {'precision': 0.5183805109201528, 'recall': 0.49962651549652665, 'f1-score': 0.49811686392414883, 'support': 211438}, 'weighted avg': {'precision': 0.5271072846794383, 'recall': 0.528074423708132, 'f1-score': 0.5175680791700366, 'support': 211438}}
[[19197 25601 15199]
 [ 9015 63358 20369]
 [ 7796 21803 29100]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.036652
{'0': {'precision': 0.516117381489842, 'recall': 0.26400628146505933, 'f1-score': 0.34932469596039845, 'support': 64953}, '1': {'precision': 0.49697831496622824, 'recall': 0.6848765100189984, 'f1-score': 0.5759908352761476, 'support': 83691}, '2': {'precision': 0.4440362595419847, 'recall': 0.4446443927763799, 'f1-score': 0.44434011808329493, 'support': 62794}, 'accuracy': 0.48424124329590706, 'macro avg': {'precision': 0.48571065199935165, 'recall': 0.4645090614201459, 'f1-score': 0.4565518831066136, 'support': 211438}, 'weighted avg': {'precision': 0.48713475023140457, 'recall': 0.48424124329590706, 'f1-score': 0.4672614636287434, 'support': 211438}}
[[17148 31149 16656]
 [ 8070 57318 18303]
 [ 8007 26866 27921]]
training model: results/ATVI/W3/deepOF_L2/seq2seq
Epoch 1/50
2440/2440 - 78s - loss: 11.7661 - accuracy10: 0.5334 - accuracy20: 0.5259 - accuracy30: 0.5093 - accuracy50: 0.4763 - val_loss: 11.9903 - val_accuracy10: 0.6589 - val_accuracy20: 0.5931 - val_accuracy30: 0.5368 - val_accuracy50: 0.4807 - 78s/epoch - 32ms/step
Epoch 2/50
2440/2440 - 70s - loss: 11.3088 - accuracy10: 0.5709 - accuracy20: 0.5577 - accuracy30: 0.5376 - accuracy50: 0.4979 - val_loss: 11.9613 - val_accuracy10: 0.6722 - val_accuracy20: 0.6033 - val_accuracy30: 0.5442 - val_accuracy50: 0.4863 - 70s/epoch - 29ms/step
Epoch 3/50
2440/2440 - 71s - loss: 11.2065 - accuracy10: 0.5775 - accuracy20: 0.5632 - accuracy30: 0.5427 - accuracy50: 0.5020 - val_loss: 12.0437 - val_accuracy10: 0.6749 - val_accuracy20: 0.6052 - val_accuracy30: 0.5461 - val_accuracy50: 0.4878 - 71s/epoch - 29ms/step
Epoch 4/50
2440/2440 - 71s - loss: 11.1505 - accuracy10: 0.5804 - accuracy20: 0.5656 - accuracy30: 0.5454 - accuracy50: 0.5043 - val_loss: 12.0165 - val_accuracy10: 0.6743 - val_accuracy20: 0.6065 - val_accuracy30: 0.5478 - val_accuracy50: 0.4893 - 71s/epoch - 29ms/step
Epoch 5/50
2440/2440 - 69s - loss: 11.1068 - accuracy10: 0.5823 - accuracy20: 0.5678 - accuracy30: 0.5475 - accuracy50: 0.5062 - val_loss: 12.0105 - val_accuracy10: 0.6749 - val_accuracy20: 0.6072 - val_accuracy30: 0.5485 - val_accuracy50: 0.4896 - 69s/epoch - 28ms/step
Epoch 6/50
2440/2440 - 69s - loss: 11.0710 - accuracy10: 0.5836 - accuracy20: 0.5692 - accuracy30: 0.5490 - accuracy50: 0.5075 - val_loss: 12.0564 - val_accuracy10: 0.6757 - val_accuracy20: 0.6081 - val_accuracy30: 0.5492 - val_accuracy50: 0.4900 - 69s/epoch - 28ms/step
Epoch 7/50
2440/2440 - 72s - loss: 11.0430 - accuracy10: 0.5850 - accuracy20: 0.5707 - accuracy30: 0.5506 - accuracy50: 0.5090 - val_loss: 11.9472 - val_accuracy10: 0.6743 - val_accuracy20: 0.6088 - val_accuracy30: 0.5505 - val_accuracy50: 0.4919 - 72s/epoch - 29ms/step
Epoch 8/50
2440/2440 - 69s - loss: 11.0162 - accuracy10: 0.5858 - accuracy20: 0.5721 - accuracy30: 0.5518 - accuracy50: 0.5099 - val_loss: 11.8742 - val_accuracy10: 0.6739 - val_accuracy20: 0.6112 - val_accuracy30: 0.5541 - val_accuracy50: 0.4949 - 69s/epoch - 28ms/step
Epoch 9/50
2440/2440 - 70s - loss: 10.9932 - accuracy10: 0.5870 - accuracy20: 0.5735 - accuracy30: 0.5533 - accuracy50: 0.5116 - val_loss: 11.7957 - val_accuracy10: 0.6717 - val_accuracy20: 0.6105 - val_accuracy30: 0.5546 - val_accuracy50: 0.4948 - 70s/epoch - 29ms/step
Epoch 10/50
2440/2440 - 69s - loss: 10.9757 - accuracy10: 0.5871 - accuracy20: 0.5738 - accuracy30: 0.5535 - accuracy50: 0.5121 - val_loss: 11.8237 - val_accuracy10: 0.6720 - val_accuracy20: 0.6109 - val_accuracy30: 0.5540 - val_accuracy50: 0.4943 - 69s/epoch - 28ms/step
Epoch 11/50
2440/2440 - 69s - loss: 10.9554 - accuracy10: 0.5878 - accuracy20: 0.5751 - accuracy30: 0.5552 - accuracy50: 0.5137 - val_loss: 11.7239 - val_accuracy10: 0.6723 - val_accuracy20: 0.6113 - val_accuracy30: 0.5549 - val_accuracy50: 0.4951 - 69s/epoch - 28ms/step
Epoch 12/50
2440/2440 - 69s - loss: 10.9376 - accuracy10: 0.5890 - accuracy20: 0.5759 - accuracy30: 0.5559 - accuracy50: 0.5137 - val_loss: 11.6779 - val_accuracy10: 0.6713 - val_accuracy20: 0.6110 - val_accuracy30: 0.5553 - val_accuracy50: 0.4954 - 69s/epoch - 28ms/step
Epoch 13/50
2440/2440 - 69s - loss: 10.9215 - accuracy10: 0.5902 - accuracy20: 0.5767 - accuracy30: 0.5566 - accuracy50: 0.5146 - val_loss: 11.7243 - val_accuracy10: 0.6717 - val_accuracy20: 0.6105 - val_accuracy30: 0.5545 - val_accuracy50: 0.4950 - 69s/epoch - 28ms/step
Epoch 14/50
2440/2440 - 70s - loss: 10.9035 - accuracy10: 0.5899 - accuracy20: 0.5777 - accuracy30: 0.5577 - accuracy50: 0.5158 - val_loss: 11.6192 - val_accuracy10: 0.6707 - val_accuracy20: 0.6120 - val_accuracy30: 0.5566 - val_accuracy50: 0.4970 - 70s/epoch - 29ms/step
Epoch 15/50
2440/2440 - 71s - loss: 10.8911 - accuracy10: 0.5905 - accuracy20: 0.5782 - accuracy30: 0.5585 - accuracy50: 0.5166 - val_loss: 11.5793 - val_accuracy10: 0.6736 - val_accuracy20: 0.6128 - val_accuracy30: 0.5567 - val_accuracy50: 0.4977 - 71s/epoch - 29ms/step
Epoch 16/50
2440/2440 - 72s - loss: 10.8771 - accuracy10: 0.5909 - accuracy20: 0.5788 - accuracy30: 0.5589 - accuracy50: 0.5176 - val_loss: 11.4478 - val_accuracy10: 0.6709 - val_accuracy20: 0.6120 - val_accuracy30: 0.5577 - val_accuracy50: 0.4986 - 72s/epoch - 29ms/step
Epoch 17/50
2440/2440 - 69s - loss: 10.8607 - accuracy10: 0.5921 - accuracy20: 0.5798 - accuracy30: 0.5601 - accuracy50: 0.5184 - val_loss: 11.5706 - val_accuracy10: 0.6714 - val_accuracy20: 0.6126 - val_accuracy30: 0.5578 - val_accuracy50: 0.4983 - 69s/epoch - 28ms/step
Epoch 18/50
2440/2440 - 70s - loss: 10.8498 - accuracy10: 0.5918 - accuracy20: 0.5804 - accuracy30: 0.5607 - accuracy50: 0.5194 - val_loss: 11.4290 - val_accuracy10: 0.6700 - val_accuracy20: 0.6139 - val_accuracy30: 0.5600 - val_accuracy50: 0.5006 - 70s/epoch - 29ms/step
Epoch 19/50
2440/2440 - 68s - loss: 10.8347 - accuracy10: 0.5927 - accuracy20: 0.5812 - accuracy30: 0.5621 - accuracy50: 0.5205 - val_loss: 11.4579 - val_accuracy10: 0.6694 - val_accuracy20: 0.6124 - val_accuracy30: 0.5579 - val_accuracy50: 0.4993 - 68s/epoch - 28ms/step
Epoch 20/50
2440/2440 - 70s - loss: 10.8232 - accuracy10: 0.5927 - accuracy20: 0.5812 - accuracy30: 0.5623 - accuracy50: 0.5211 - val_loss: 11.4888 - val_accuracy10: 0.6696 - val_accuracy20: 0.6133 - val_accuracy30: 0.5580 - val_accuracy50: 0.4990 - 70s/epoch - 29ms/step
Epoch 21/50
2440/2440 - 70s - loss: 10.8103 - accuracy10: 0.5935 - accuracy20: 0.5823 - accuracy30: 0.5630 - accuracy50: 0.5218 - val_loss: 11.5316 - val_accuracy10: 0.6708 - val_accuracy20: 0.6126 - val_accuracy30: 0.5585 - val_accuracy50: 0.4996 - 70s/epoch - 29ms/step
Epoch 22/50
2440/2440 - 72s - loss: 10.7965 - accuracy10: 0.5939 - accuracy20: 0.5831 - accuracy30: 0.5642 - accuracy50: 0.5227 - val_loss: 11.4680 - val_accuracy10: 0.6714 - val_accuracy20: 0.6136 - val_accuracy30: 0.5588 - val_accuracy50: 0.5001 - 72s/epoch - 29ms/step
Epoch 23/50
2440/2440 - 74s - loss: 10.7855 - accuracy10: 0.5942 - accuracy20: 0.5837 - accuracy30: 0.5646 - accuracy50: 0.5234 - val_loss: 11.4533 - val_accuracy10: 0.6694 - val_accuracy20: 0.6129 - val_accuracy30: 0.5588 - val_accuracy50: 0.4998 - 74s/epoch - 30ms/step
Epoch 24/50
2440/2440 - 69s - loss: 10.7748 - accuracy10: 0.5941 - accuracy20: 0.5844 - accuracy30: 0.5654 - accuracy50: 0.5243 - val_loss: 11.4045 - val_accuracy10: 0.6689 - val_accuracy20: 0.6136 - val_accuracy30: 0.5600 - val_accuracy50: 0.5002 - 69s/epoch - 28ms/step
Epoch 25/50
2440/2440 - 71s - loss: 10.7611 - accuracy10: 0.5948 - accuracy20: 0.5846 - accuracy30: 0.5662 - accuracy50: 0.5257 - val_loss: 11.4442 - val_accuracy10: 0.6682 - val_accuracy20: 0.6121 - val_accuracy30: 0.5582 - val_accuracy50: 0.5003 - 71s/epoch - 29ms/step
Epoch 26/50
2440/2440 - 71s - loss: 10.7468 - accuracy10: 0.5948 - accuracy20: 0.5859 - accuracy30: 0.5672 - accuracy50: 0.5263 - val_loss: 11.3846 - val_accuracy10: 0.6681 - val_accuracy20: 0.6120 - val_accuracy30: 0.5589 - val_accuracy50: 0.5003 - 71s/epoch - 29ms/step
Epoch 27/50
2440/2440 - 71s - loss: 10.7361 - accuracy10: 0.5959 - accuracy20: 0.5860 - accuracy30: 0.5678 - accuracy50: 0.5271 - val_loss: 11.4638 - val_accuracy10: 0.6660 - val_accuracy20: 0.6123 - val_accuracy30: 0.5607 - val_accuracy50: 0.5021 - 71s/epoch - 29ms/step
Epoch 28/50
2440/2440 - 69s - loss: 10.7272 - accuracy10: 0.5960 - accuracy20: 0.5864 - accuracy30: 0.5679 - accuracy50: 0.5274 - val_loss: 11.4665 - val_accuracy10: 0.6654 - val_accuracy20: 0.6116 - val_accuracy30: 0.5597 - val_accuracy50: 0.5010 - 69s/epoch - 28ms/step
Epoch 29/50
2440/2440 - 69s - loss: 10.7116 - accuracy10: 0.5958 - accuracy20: 0.5869 - accuracy30: 0.5688 - accuracy50: 0.5283 - val_loss: 11.4657 - val_accuracy10: 0.6682 - val_accuracy20: 0.6106 - val_accuracy30: 0.5571 - val_accuracy50: 0.4987 - 69s/epoch - 28ms/step
Epoch 30/50
2440/2440 - 70s - loss: 10.7014 - accuracy10: 0.5962 - accuracy20: 0.5878 - accuracy30: 0.5699 - accuracy50: 0.5296 - val_loss: 11.3640 - val_accuracy10: 0.6643 - val_accuracy20: 0.6110 - val_accuracy30: 0.5594 - val_accuracy50: 0.5015 - 70s/epoch - 29ms/step
Epoch 31/50
2440/2440 - 72s - loss: 10.6872 - accuracy10: 0.5964 - accuracy20: 0.5879 - accuracy30: 0.5704 - accuracy50: 0.5306 - val_loss: 11.4330 - val_accuracy10: 0.6674 - val_accuracy20: 0.6104 - val_accuracy30: 0.5577 - val_accuracy50: 0.5000 - 72s/epoch - 29ms/step
Epoch 32/50
2440/2440 - 70s - loss: 10.6772 - accuracy10: 0.5968 - accuracy20: 0.5888 - accuracy30: 0.5715 - accuracy50: 0.5310 - val_loss: 11.3656 - val_accuracy10: 0.6631 - val_accuracy20: 0.6110 - val_accuracy30: 0.5595 - val_accuracy50: 0.5021 - 70s/epoch - 29ms/step
Epoch 33/50
2440/2440 - 70s - loss: 10.6643 - accuracy10: 0.5980 - accuracy20: 0.5900 - accuracy30: 0.5722 - accuracy50: 0.5319 - val_loss: 11.5006 - val_accuracy10: 0.6680 - val_accuracy20: 0.6098 - val_accuracy30: 0.5572 - val_accuracy50: 0.4990 - 70s/epoch - 29ms/step
Epoch 34/50
2440/2440 - 71s - loss: 10.6494 - accuracy10: 0.5973 - accuracy20: 0.5897 - accuracy30: 0.5729 - accuracy50: 0.5336 - val_loss: 11.5503 - val_accuracy10: 0.6642 - val_accuracy20: 0.6097 - val_accuracy30: 0.5578 - val_accuracy50: 0.5011 - 71s/epoch - 29ms/step
Epoch 35/50
2440/2440 - 70s - loss: 10.6425 - accuracy10: 0.5978 - accuracy20: 0.5902 - accuracy30: 0.5734 - accuracy50: 0.5337 - val_loss: 11.5519 - val_accuracy10: 0.6629 - val_accuracy20: 0.6077 - val_accuracy30: 0.5573 - val_accuracy50: 0.5009 - 70s/epoch - 29ms/step
Epoch 36/50
2440/2440 - 70s - loss: 10.6283 - accuracy10: 0.5975 - accuracy20: 0.5911 - accuracy30: 0.5744 - accuracy50: 0.5346 - val_loss: 11.5758 - val_accuracy10: 0.6680 - val_accuracy20: 0.6111 - val_accuracy30: 0.5569 - val_accuracy50: 0.4993 - 70s/epoch - 29ms/step
Epoch 37/50
2440/2440 - 70s - loss: 10.6230 - accuracy10: 0.5981 - accuracy20: 0.5912 - accuracy30: 0.5749 - accuracy50: 0.5352 - val_loss: 11.6044 - val_accuracy10: 0.6662 - val_accuracy20: 0.6106 - val_accuracy30: 0.5575 - val_accuracy50: 0.4996 - 70s/epoch - 29ms/step
Epoch 38/50
2440/2440 - 70s - loss: 10.6055 - accuracy10: 0.5988 - accuracy20: 0.5920 - accuracy30: 0.5760 - accuracy50: 0.5365 - val_loss: 11.6473 - val_accuracy10: 0.6667 - val_accuracy20: 0.6096 - val_accuracy30: 0.5557 - val_accuracy50: 0.4986 - 70s/epoch - 29ms/step
Epoch 39/50
2440/2440 - 71s - loss: 10.5958 - accuracy10: 0.5993 - accuracy20: 0.5926 - accuracy30: 0.5768 - accuracy50: 0.5374 - val_loss: 11.6279 - val_accuracy10: 0.6661 - val_accuracy20: 0.6111 - val_accuracy30: 0.5589 - val_accuracy50: 0.5014 - 71s/epoch - 29ms/step
Epoch 40/50
2440/2440 - 70s - loss: 10.5870 - accuracy10: 0.5995 - accuracy20: 0.5928 - accuracy30: 0.5774 - accuracy50: 0.5389 - val_loss: 11.6361 - val_accuracy10: 0.6630 - val_accuracy20: 0.6085 - val_accuracy30: 0.5574 - val_accuracy50: 0.5012 - 70s/epoch - 29ms/step
testing model: results/ATVI/W3/deepOF_L2/seq2seq
Evaluating performance on  test set...
6082/6082 - 66s - 66s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.76354194
{'0': {'precision': 0.44979864953544163, 'recall': 0.45429653828602057, 'f1-score': 0.4520364053746759, 'support': 276106}, '1': {'precision': 0.7846112229467643, 'recall': 0.8160860345048712, 'f1-score': 0.8000391811528909, 'support': 1005829}, '2': {'precision': 0.48954715108627644, 'recall': 0.4127662670765649, 'f1-score': 0.4478899372310607, 'support': 274865}, 'accuracy': 0.6807117163412127, 'macro avg': {'precision': 0.574652341189494, 'recall': 0.5610496132891521, 'f1-score': 0.5666551745862092, 'support': 1556800}, 'weighted avg': {'precision': 0.6731347670717388, 'recall': 0.6807117163412127, 'f1-score': 0.6761445534938507, 'support': 1556800}}
[[125434 109087  41585]
 [108271 820843  76715]
 [ 45162 116248 113455]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8580766
{'0': {'precision': 0.5120321377494349, 'recall': 0.40417384483941904, 'f1-score': 0.45175430356997487, 'support': 356985}, '1': {'precision': 0.684009543809345, 'recall': 0.84813044069239, 'f1-score': 0.7572797808256186, 'support': 846055}, '2': {'precision': 0.5552231407884721, 'recall': 0.35463591135232925, 'f1-score': 0.43281882852983183, 'support': 353760}, 'accuracy': 0.6341887204522096, 'macro avg': {'precision': 0.5837549407824173, 'recall': 0.5356467322947127, 'f1-score': 0.5472843043084751, 'support': 1556800}, 'weighted avg': {'precision': 0.615309112003743, 'recall': 0.6341887204522096, 'f1-score': 0.6134916776766827, 'support': 1556800}}
[[144284 161109  51592]
 [ 79582 717565  48908]
 [ 57921 170383 125456]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.93210196
{'0': {'precision': 0.5349909084007822, 'recall': 0.35967404433405353, 'f1-score': 0.4301550946379575, 'support': 411467}, '1': {'precision': 0.6023426083493928, 'recall': 0.8676686643488143, 'f1-score': 0.7110609505838738, 'support': 739190}, '2': {'precision': 0.5787440510737086, 'recall': 0.30690421846492494, 'f1-score': 0.40110503637867284, 'support': 406143}, 'accuracy': 0.5871100976361767, 'macro avg': {'precision': 0.5720258559412946, 'recall': 0.5114156423825976, 'f1-score': 0.514107027200168, 'support': 1556800}, 'weighted avg': {'precision': 0.5783848804650318, 'recall': 0.5871100976361767, 'f1-score': 0.5559543763986597, 'support': 1556800}}
[[147994 207751  55722]
 [ 62812 641372  35006]
 [ 65823 215673 124647]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0108424
{'0': {'precision': 0.5083802408994371, 'recall': 0.3136373215561949, 'f1-score': 0.3879406581325898, 'support': 436552}, '1': {'precision': 0.5390993878130418, 'recall': 0.8567398586000765, 'f1-score': 0.6617781158871885, 'support': 684866}, '2': {'precision': 0.5542663110361005, 'recall': 0.2534441019610365, 'f1-score': 0.34783636607220253, 'support': 435382}, 'accuracy': 0.5357245632065776, 'macro avg': {'precision': 0.5339153132495266, 'recall': 0.4746070940391027, 'f1-score': 0.46585171336399367, 'support': 1556800}, 'weighted avg': {'precision': 0.5347268931722876, 'recall': 0.5357245632065776, 'f1-score': 0.49719122176101055, 'support': 1556800}}
[[136919 245365  54268]
 [ 63644 586752  34470]
 [ 68761 256276 110345]]
Evaluating performance on  train set...
2440/2440 - 25s - 25s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.885628
{'0': {'precision': 0.4591644179999877, 'recall': 0.5211164438987639, 'f1-score': 0.4881828014259714, 'support': 143348}, '1': {'precision': 0.7192553344002621, 'recall': 0.7276367898559732, 'f1-score': 0.7234217863737686, 'support': 337854}, '2': {'precision': 0.49312684734190915, 'recall': 0.4130684948703821, 'f1-score': 0.44956127034248233, 'support': 143383}, 'accuracy': 0.6080245282867824, 'macro avg': {'precision': 0.5571821999140529, 'recall': 0.553940576208373, 'f1-score': 0.5537219527140741, 'support': 624585}, 'weighted avg': {'precision': 0.6076508393450906, 'recall': 0.6080245282867824, 'f1-score': 0.6065634238059664, 'support': 624585}}
[[ 74701  45003  23644]
 [ 54785 245835  37234]
 [ 33203  50953  59227]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9529163
{'0': {'precision': 0.516623686493782, 'recall': 0.47779666211585076, 'f1-score': 0.496452176027653, 'support': 179455}, '1': {'precision': 0.5988887651578645, 'recall': 0.7687903456370284, 'f1-score': 0.6732864414317953, 'support': 265828}, '2': {'precision': 0.5515399361022364, 'recall': 0.3610500719456559, 'f1-score': 0.4364140125456304, 'support': 179302}, 'accuracy': 0.5681308388770143, 'macro avg': {'precision': 0.5556841292512943, 'recall': 0.5358790265661784, 'f1-score': 0.5353842100016929, 'support': 624585}, 'weighted avg': {'precision': 0.5616598540585023, 'recall': 0.5681308388770143, 'f1-score': 0.5544787637862426, 'support': 624585}}
[[ 85743  64946  28766]
 [ 37590 204366  23872]
 [ 42635  71930  64737]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.001671
{'0': {'precision': 0.5374851273583761, 'recall': 0.43910652205178563, 'f1-score': 0.48334065742102955, 'support': 201639}, '1': {'precision': 0.5069037938632307, 'recall': 0.7984069318771577, 'f1-score': 0.6201059944338901, 'support': 221585}, '2': {'precision': 0.5721026325760993, 'recall': 0.3149219560888156, 'f1-score': 0.40622928030800476, 'support': 201361}, 'accuracy': 0.5265400225749898, 'macro avg': {'precision': 0.5388305179325686, 'recall': 0.5174784700059197, 'f1-score': 0.5032253107209749, 'support': 624585}, 'weighted avg': {'precision': 0.5377961349644252, 'recall': 0.5265400225749898, 'f1-score': 0.5070010450306246, 'support': 624585}}
[[ 88541  82347  30751]
 [ 27992 176915  16678]
 [ 48199  89749  63413]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0643247
{'0': {'precision': 0.5101036156710156, 'recall': 0.3921490861306893, 'f1-score': 0.4434160547658027, 'support': 209275}, '1': {'precision': 0.44350094380637384, 'recall': 0.7808481982811244, 'f1-score': 0.5656996047985735, 'support': 206414}, '2': {'precision': 0.5428500199441564, 'recall': 0.26059378829656865, 'f1-score': 0.3521424690144125, 'support': 208896}, 'accuracy': 0.4766076674912142, 'macro avg': {'precision': 0.4988181931405153, 'recall': 0.47786369090279407, 'f1-score': 0.45375270952626295, 'support': 624585}, 'weighted avg': {'precision': 0.4990448629900736, 'recall': 0.4766076674912142, 'f1-score': 0.4533015783171879, 'support': 624585}}
[[ 82067  97687  29521]
 [ 28914 161178  16322]
 [ 49902 104557  54437]]
Evaluating performance on  val set...
826/826 - 9s - 9s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.78726345
{'0': {'precision': 0.4546395070811109, 'recall': 0.49484510284770533, 'f1-score': 0.4738910589757722, 'support': 39962}, '1': {'precision': 0.7642073276110375, 'recall': 0.8019753347640782, 'f1-score': 0.7826359493222815, 'support': 132332}, '2': {'precision': 0.4996904024767802, 'recall': 0.3710913549969344, 'f1-score': 0.4258949775705867, 'support': 39144}, 'accuracy': 0.6641568686801804, 'macro avg': {'precision': 0.5728457457229762, 'recall': 0.5559705975362393, 'f1-score': 0.5608073286228802, 'support': 211438}, 'weighted avg': {'precision': 0.656728067679179, 'recall': 0.6641568686801804, 'f1-score': 0.6582385755944012, 'support': 211438}}
[[ 19775  15256   4931]
 [ 16592 106127   9613]
 [  7129  17489  14526]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8868581
{'0': {'precision': 0.5163293520386193, 'recall': 0.43988337742078737, 'f1-score': 0.47505056613215996, 'support': 51791}, '1': {'precision': 0.6505559631179966, 'recall': 0.8328069900838774, 'f1-score': 0.7304854855056956, 'support': 108611}, '2': {'precision': 0.5640273013403119, 'recall': 0.3125048985030175, 'f1-score': 0.402178709669285, 'support': 51036}, 'accuracy': 0.6109734295632763, 'macro avg': {'precision': 0.5769708721656426, 'recall': 0.5283984220025607, 'f1-score': 0.5359049204357135, 'support': 211438}, 'weighted avg': {'precision': 0.5967917050522848, 'recall': 0.6109734295632763, 'f1-score': 0.5886723084946482, 'support': 211438}}
[[22782 22953  6056]
 [11887 90452  6272]
 [ 9454 25633 15949]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9608396
{'0': {'precision': 0.540105970594307, 'recall': 0.3924303784810759, 'f1-score': 0.45457528957528964, 'support': 60003}, '1': {'precision': 0.5606683294597812, 'recall': 0.853165703441732, 'f1-score': 0.6766607374974345, 'support': 92744}, '2': {'precision': 0.5840227604537117, 'recall': 0.2658158831848154, 'f1-score': 0.3653458854386211, 'support': 58691}, 'accuracy': 0.5593791087694738, 'macro avg': {'precision': 0.5615990201692665, 'recall': 0.5038039883692078, 'f1-score': 0.4988606375037818, 'support': 211438}, 'weighted avg': {'precision': 0.5613157612859416, 'recall': 0.5593791087694738, 'f1-score': 0.5272213126359797, 'support': 211438}}
[[23547 29709  6747]
 [ 9253 79126  4365]
 [10797 32293 15601]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0420351
{'0': {'precision': 0.5168051448152843, 'recall': 0.33944840982317664, 'f1-score': 0.40975873009965297, 'support': 64867}, '1': {'precision': 0.48823146403635154, 'recall': 0.8408388705309745, 'f1-score': 0.6177611253533163, 'support': 83827}, '2': {'precision': 0.5568590582079791, 'recall': 0.21712036210633687, 'f1-score': 0.31242546555361894, 'support': 62744}, 'accuracy': 0.5019296436780522, 'macro avg': {'precision': 0.5206318890198717, 'recall': 0.4658025474868293, 'f1-score': 0.44664844033552936, 'support': 211438}, 'weighted avg': {'precision': 0.5173627399649529, 'recall': 0.5019296436780522, 'f1-score': 0.4633401035341939, 'support': 211438}}
[[22019 36227  6621]
 [ 9122 70485  4220]
 [11465 37656 13623]]
training model: results/ATVI/W3/deepVOL_L2/seq2seq
Epoch 1/50
2440/2440 - 74s - loss: 11.9388 - accuracy10: 0.5032 - accuracy20: 0.5049 - accuracy30: 0.4951 - accuracy50: 0.4667 - val_loss: 11.6648 - val_accuracy10: 0.5750 - val_accuracy20: 0.5576 - val_accuracy30: 0.5291 - val_accuracy50: 0.4862 - 74s/epoch - 30ms/step
Epoch 2/50
2440/2440 - 69s - loss: 11.5851 - accuracy10: 0.5420 - accuracy20: 0.5373 - accuracy30: 0.5230 - accuracy50: 0.4867 - val_loss: 11.4511 - val_accuracy10: 0.5767 - val_accuracy20: 0.5625 - val_accuracy30: 0.5374 - val_accuracy50: 0.4937 - 69s/epoch - 28ms/step
Epoch 3/50
2440/2440 - 67s - loss: 11.4160 - accuracy10: 0.5595 - accuracy20: 0.5500 - accuracy30: 0.5319 - accuracy50: 0.4935 - val_loss: 11.3396 - val_accuracy10: 0.5944 - val_accuracy20: 0.5775 - val_accuracy30: 0.5487 - val_accuracy50: 0.5014 - 67s/epoch - 28ms/step
Epoch 4/50
2440/2440 - 69s - loss: 11.3222 - accuracy10: 0.5657 - accuracy20: 0.5559 - accuracy30: 0.5378 - accuracy50: 0.4972 - val_loss: 11.2204 - val_accuracy10: 0.6080 - val_accuracy20: 0.5829 - val_accuracy30: 0.5501 - val_accuracy50: 0.5011 - 69s/epoch - 28ms/step
Epoch 5/50
2440/2440 - 68s - loss: 11.2550 - accuracy10: 0.5702 - accuracy20: 0.5596 - accuracy30: 0.5407 - accuracy50: 0.4999 - val_loss: 11.0528 - val_accuracy10: 0.6278 - val_accuracy20: 0.5972 - val_accuracy30: 0.5595 - val_accuracy50: 0.5075 - 68s/epoch - 28ms/step
Epoch 6/50
2440/2440 - 68s - loss: 11.2101 - accuracy10: 0.5739 - accuracy20: 0.5627 - accuracy30: 0.5432 - accuracy50: 0.5014 - val_loss: 11.0172 - val_accuracy10: 0.6163 - val_accuracy20: 0.5913 - val_accuracy30: 0.5575 - val_accuracy50: 0.5059 - 68s/epoch - 28ms/step
Epoch 7/50
2440/2440 - 68s - loss: 11.1729 - accuracy10: 0.5760 - accuracy20: 0.5644 - accuracy30: 0.5443 - accuracy50: 0.5025 - val_loss: 10.9798 - val_accuracy10: 0.6159 - val_accuracy20: 0.5917 - val_accuracy30: 0.5590 - val_accuracy50: 0.5075 - 68s/epoch - 28ms/step
Epoch 8/50
2440/2440 - 68s - loss: 11.1410 - accuracy10: 0.5778 - accuracy20: 0.5664 - accuracy30: 0.5462 - accuracy50: 0.5036 - val_loss: 10.9320 - val_accuracy10: 0.6262 - val_accuracy20: 0.5974 - val_accuracy30: 0.5607 - val_accuracy50: 0.5072 - 68s/epoch - 28ms/step
Epoch 9/50
2440/2440 - 67s - loss: 11.1132 - accuracy10: 0.5797 - accuracy20: 0.5685 - accuracy30: 0.5478 - accuracy50: 0.5046 - val_loss: 10.9043 - val_accuracy10: 0.6292 - val_accuracy20: 0.5993 - val_accuracy30: 0.5618 - val_accuracy50: 0.5076 - 67s/epoch - 28ms/step
Epoch 10/50
2440/2440 - 68s - loss: 11.0904 - accuracy10: 0.5803 - accuracy20: 0.5695 - accuracy30: 0.5491 - accuracy50: 0.5059 - val_loss: 10.8683 - val_accuracy10: 0.6273 - val_accuracy20: 0.5994 - val_accuracy30: 0.5628 - val_accuracy50: 0.5083 - 68s/epoch - 28ms/step
Epoch 11/50
2440/2440 - 69s - loss: 11.0651 - accuracy10: 0.5817 - accuracy20: 0.5703 - accuracy30: 0.5503 - accuracy50: 0.5071 - val_loss: 10.8745 - val_accuracy10: 0.6195 - val_accuracy20: 0.5941 - val_accuracy30: 0.5601 - val_accuracy50: 0.5079 - 69s/epoch - 28ms/step
Epoch 12/50
2440/2440 - 69s - loss: 11.0467 - accuracy10: 0.5830 - accuracy20: 0.5718 - accuracy30: 0.5506 - accuracy50: 0.5075 - val_loss: 10.8563 - val_accuracy10: 0.6259 - val_accuracy20: 0.5987 - val_accuracy30: 0.5618 - val_accuracy50: 0.5070 - 69s/epoch - 28ms/step
Epoch 13/50
2440/2440 - 68s - loss: 11.0296 - accuracy10: 0.5834 - accuracy20: 0.5726 - accuracy30: 0.5518 - accuracy50: 0.5084 - val_loss: 10.7812 - val_accuracy10: 0.6296 - val_accuracy20: 0.6024 - val_accuracy30: 0.5647 - val_accuracy50: 0.5090 - 68s/epoch - 28ms/step
Epoch 14/50
2440/2440 - 67s - loss: 11.0110 - accuracy10: 0.5848 - accuracy20: 0.5741 - accuracy30: 0.5531 - accuracy50: 0.5095 - val_loss: 10.7695 - val_accuracy10: 0.6325 - val_accuracy20: 0.6036 - val_accuracy30: 0.5655 - val_accuracy50: 0.5089 - 67s/epoch - 28ms/step
Epoch 15/50
2440/2440 - 69s - loss: 10.9941 - accuracy10: 0.5855 - accuracy20: 0.5744 - accuracy30: 0.5538 - accuracy50: 0.5102 - val_loss: 10.7154 - val_accuracy10: 0.6262 - val_accuracy20: 0.6016 - val_accuracy30: 0.5669 - val_accuracy50: 0.5112 - 69s/epoch - 28ms/step
Epoch 16/50
2440/2440 - 69s - loss: 10.9787 - accuracy10: 0.5861 - accuracy20: 0.5749 - accuracy30: 0.5544 - accuracy50: 0.5113 - val_loss: 10.7167 - val_accuracy10: 0.6336 - val_accuracy20: 0.6058 - val_accuracy30: 0.5681 - val_accuracy50: 0.5110 - 69s/epoch - 28ms/step
Epoch 17/50
2440/2440 - 68s - loss: 10.9666 - accuracy10: 0.5864 - accuracy20: 0.5758 - accuracy30: 0.5553 - accuracy50: 0.5122 - val_loss: 10.7478 - val_accuracy10: 0.6398 - val_accuracy20: 0.6080 - val_accuracy30: 0.5662 - val_accuracy50: 0.5081 - 68s/epoch - 28ms/step
Epoch 18/50
2440/2440 - 68s - loss: 10.9530 - accuracy10: 0.5866 - accuracy20: 0.5761 - accuracy30: 0.5556 - accuracy50: 0.5127 - val_loss: 10.7223 - val_accuracy10: 0.6368 - val_accuracy20: 0.6075 - val_accuracy30: 0.5683 - val_accuracy50: 0.5108 - 68s/epoch - 28ms/step
Epoch 19/50
2440/2440 - 67s - loss: 10.9401 - accuracy10: 0.5871 - accuracy20: 0.5770 - accuracy30: 0.5561 - accuracy50: 0.5132 - val_loss: 10.7352 - val_accuracy10: 0.6423 - val_accuracy20: 0.6094 - val_accuracy30: 0.5674 - val_accuracy50: 0.5100 - 67s/epoch - 28ms/step
Epoch 20/50
2440/2440 - 69s - loss: 10.9296 - accuracy10: 0.5876 - accuracy20: 0.5770 - accuracy30: 0.5565 - accuracy50: 0.5141 - val_loss: 10.7457 - val_accuracy10: 0.6350 - val_accuracy20: 0.6067 - val_accuracy30: 0.5667 - val_accuracy50: 0.5111 - 69s/epoch - 28ms/step
Epoch 21/50
2440/2440 - 68s - loss: 10.9133 - accuracy10: 0.5887 - accuracy20: 0.5782 - accuracy30: 0.5574 - accuracy50: 0.5147 - val_loss: 10.7054 - val_accuracy10: 0.6409 - val_accuracy20: 0.6106 - val_accuracy30: 0.5694 - val_accuracy50: 0.5118 - 68s/epoch - 28ms/step
Epoch 22/50
2440/2440 - 68s - loss: 10.9026 - accuracy10: 0.5885 - accuracy20: 0.5790 - accuracy30: 0.5590 - accuracy50: 0.5159 - val_loss: 10.7482 - val_accuracy10: 0.6407 - val_accuracy20: 0.6098 - val_accuracy30: 0.5678 - val_accuracy50: 0.5091 - 68s/epoch - 28ms/step
Epoch 23/50
2440/2440 - 68s - loss: 10.8925 - accuracy10: 0.5893 - accuracy20: 0.5791 - accuracy30: 0.5590 - accuracy50: 0.5162 - val_loss: 10.7243 - val_accuracy10: 0.6435 - val_accuracy20: 0.6107 - val_accuracy30: 0.5676 - val_accuracy50: 0.5101 - 68s/epoch - 28ms/step
Epoch 24/50
2440/2440 - 70s - loss: 10.8820 - accuracy10: 0.5891 - accuracy20: 0.5798 - accuracy30: 0.5596 - accuracy50: 0.5165 - val_loss: 10.7646 - val_accuracy10: 0.6389 - val_accuracy20: 0.6077 - val_accuracy30: 0.5659 - val_accuracy50: 0.5092 - 70s/epoch - 29ms/step
Epoch 25/50
2440/2440 - 69s - loss: 10.8714 - accuracy10: 0.5896 - accuracy20: 0.5801 - accuracy30: 0.5602 - accuracy50: 0.5179 - val_loss: 10.7384 - val_accuracy10: 0.6409 - val_accuracy20: 0.6094 - val_accuracy30: 0.5676 - val_accuracy50: 0.5100 - 69s/epoch - 28ms/step
Epoch 26/50
2440/2440 - 69s - loss: 10.8612 - accuracy10: 0.5901 - accuracy20: 0.5809 - accuracy30: 0.5612 - accuracy50: 0.5191 - val_loss: 10.7564 - val_accuracy10: 0.6376 - val_accuracy20: 0.6081 - val_accuracy30: 0.5664 - val_accuracy50: 0.5100 - 69s/epoch - 28ms/step
Epoch 27/50
2440/2440 - 70s - loss: 10.8521 - accuracy10: 0.5907 - accuracy20: 0.5815 - accuracy30: 0.5617 - accuracy50: 0.5195 - val_loss: 10.7327 - val_accuracy10: 0.6421 - val_accuracy20: 0.6103 - val_accuracy30: 0.5684 - val_accuracy50: 0.5107 - 70s/epoch - 29ms/step
Epoch 28/50
2440/2440 - 69s - loss: 10.8437 - accuracy10: 0.5908 - accuracy20: 0.5818 - accuracy30: 0.5625 - accuracy50: 0.5198 - val_loss: 10.7301 - val_accuracy10: 0.6434 - val_accuracy20: 0.6106 - val_accuracy30: 0.5681 - val_accuracy50: 0.5109 - 69s/epoch - 28ms/step
Epoch 29/50
2440/2440 - 67s - loss: 10.8298 - accuracy10: 0.5908 - accuracy20: 0.5828 - accuracy30: 0.5633 - accuracy50: 0.5211 - val_loss: 10.7555 - val_accuracy10: 0.6478 - val_accuracy20: 0.6120 - val_accuracy30: 0.5683 - val_accuracy50: 0.5103 - 67s/epoch - 28ms/step
Epoch 30/50
2440/2440 - 68s - loss: 10.8210 - accuracy10: 0.5916 - accuracy20: 0.5832 - accuracy30: 0.5639 - accuracy50: 0.5219 - val_loss: 10.7881 - val_accuracy10: 0.6468 - val_accuracy20: 0.6114 - val_accuracy30: 0.5665 - val_accuracy50: 0.5084 - 68s/epoch - 28ms/step
Epoch 31/50
2440/2440 - 67s - loss: 10.8090 - accuracy10: 0.5919 - accuracy20: 0.5839 - accuracy30: 0.5647 - accuracy50: 0.5228 - val_loss: 10.7714 - val_accuracy10: 0.6415 - val_accuracy20: 0.6093 - val_accuracy30: 0.5673 - val_accuracy50: 0.5099 - 67s/epoch - 27ms/step
testing model: results/ATVI/W3/deepVOL_L2/seq2seq
Evaluating performance on  test set...
6082/6082 - 56s - 56s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.78520817
{'0': {'precision': 0.44777474178578286, 'recall': 0.5234909781026128, 'f1-score': 0.48268158290198704, 'support': 276106}, '1': {'precision': 0.8346689011939235, 'recall': 0.6823246824519403, 'f1-score': 0.7508472008047792, 'support': 1005832}, '2': {'precision': 0.4141144299026382, 'recall': 0.6203641046910131, 'f1-score': 0.4966787013074018, 'support': 274866}, 'accuracy': 0.6432152024275375, 'macro avg': {'precision': 0.5655193576274482, 'recall': 0.6087265884151888, 'f1-score': 0.576735828338056, 'support': 1556804}, 'weighted avg': {'precision': 0.6917993273211082, 'recall': 0.6432152024275375, 'f1-score': 0.6584114061385821, 'support': 1556804}}
[[144539  71848  59719]
 [138001 686304 181527]
 [ 40254  64095 170517]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.82371956
{'0': {'precision': 0.5158240001982258, 'recall': 0.46651969545024174, 'f1-score': 0.4899345443847907, 'support': 356986}, '1': {'precision': 0.7360983091985153, 'recall': 0.7334159913764573, 'f1-score': 0.7347547022579245, 'support': 846056}, '2': {'precision': 0.4880872298685055, 'recall': 0.539419157512678, 'f1-score': 0.5124709793763906, 'support': 353762}, 'accuracy': 0.6281317365577169, 'macro avg': {'precision': 0.5800031797550822, 'recall': 0.5797849481131258, 'f1-score': 0.5790534086730353, 'support': 1556804}, 'weighted avg': {'precision': 0.629230816618383, 'recall': 0.6281317365577169, 'f1-score': 0.6281048585701413, 'support': 1556804}}
[[166541 114417  76028]
 [101432 620511 124113]
 [ 54891 108045 190826]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8673034
{'0': {'precision': 0.5490460386462285, 'recall': 0.4048688965632891, 'f1-score': 0.4660618166761787, 'support': 411469}, '1': {'precision': 0.6497041716578685, 'recall': 0.7718952205857484, 'f1-score': 0.7055483389112052, 'support': 739191}, '2': {'precision': 0.520189352645313, 'recall': 0.48052168688937913, 'f1-score': 0.49956931693537965, 'support': 406144}, 'accuracy': 0.5988743605489194, 'macro avg': {'precision': 0.57297985431647, 'recall': 0.5524286013461389, 'f1-score': 0.5570598241742545, 'support': 1556804}, 'weighted avg': {'precision': 0.5893116187191544, 'recall': 0.5988743605489194, 'f1-score': 0.5885147086540413, 'support': 1556804}}
[[166591 158494  86384]
 [ 74985 570578  93628]
 [ 61843 149140 195161]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.93908
{'0': {'precision': 0.5315704424106578, 'recall': 0.3270301658676037, 'f1-score': 0.4049369829832073, 'support': 436553}, '1': {'precision': 0.5734132812449747, 'recall': 0.7809764523622835, 'f1-score': 0.6612901131956967, 'support': 684867}, '2': {'precision': 0.5067715835433921, 'recall': 0.4137382172978336, 'f1-score': 0.45555358858934797, 'support': 435384}, 'accuracy': 0.5509788001572452, 'macro avg': {'precision': 0.5372517690663415, 'recall': 0.5072482785092404, 'f1-score': 0.507260228256084, 'support': 1556804}, 'weighted avg': {'precision': 0.5430425051333103, 'recall': 0.5509788001572452, 'f1-score': 0.5318671934942677, 'support': 1556804}}
[[142766 204061  89726]
 [ 64407 534865  85595]
 [ 61401 193848 180135]]
Evaluating performance on  train set...
2440/2440 - 22s - 22s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9028134
{'0': {'precision': 0.4524424163662772, 'recall': 0.5364732952168456, 'f1-score': 0.49088768872995464, 'support': 143420}, '1': {'precision': 0.768843468442519, 'recall': 0.5926288835274789, 'f1-score': 0.66933249970327, 'support': 337805}, '2': {'precision': 0.43914436409337204, 'recall': 0.5947112903000795, 'f1-score': 0.5052235489318835, 'support': 143362}, 'accuracy': 0.5802122042245516, 'macro avg': {'precision': 0.5534767496340561, 'recall': 0.574604489681468, 'f1-score': 0.555147912455036, 'support': 624587}, 'weighted avg': {'precision': 0.6205141534127842, 'recall': 0.5802122042245516, 'f1-score': 0.5906892647491636, 'support': 624587}}
[[ 76941  29562  36917]
 [ 65640 200193  71972]
 [ 27476  30627  85259]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9304008
{'0': {'precision': 0.5141922932683293, 'recall': 0.48877080409063567, 'f1-score': 0.5011593772487921, 'support': 179532}, '1': {'precision': 0.6438581782274142, 'recall': 0.6501570936729818, 'f1-score': 0.6469923052440418, 'support': 265765}, '2': {'precision': 0.5024681245486781, 'recall': 0.5200568910703329, 'f1-score': 0.5111112329247703, 'support': 179290}, 'accuracy': 0.5664222918504548, 'macro avg': {'precision': 0.5535061986814739, 'recall': 0.5529949296113168, 'f1-score': 0.5530876384725348, 'support': 624587}, 'weighted avg': {'precision': 0.5660003323508029, 'recall': 0.5664222918504548, 'f1-score': 0.5660687594690491, 'support': 624587}}
[[ 87750  46891  44891]
 [ 45542 172789  47434]
 [ 37364  48685  93241]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9577637
{'0': {'precision': 0.5428306149608493, 'recall': 0.43468584570850766, 'f1-score': 0.4827760849759017, 'support': 201748}, '1': {'precision': 0.5431751050024468, 'recall': 0.6970169280186492, 'f1-score': 0.6105542254496528, 'support': 221349}, '2': {'precision': 0.5265851355654754, 'recall': 0.4677850017370589, 'f1-score': 0.4954465531787396, 'support': 201490}, 'accuracy': 0.5383317296069242, 'macro avg': {'precision': 0.5375302851762572, 'recall': 0.5331625918214052, 'f1-score': 0.529592287868098, 'support': 624587}, 'weighted avg': {'precision': 0.5377119539622113, 'recall': 0.5383317296069242, 'f1-score': 0.5321471673934258, 'support': 624587}}
[[ 87697  63995  50056]
 [ 32384 154284  34681]
 [ 41474  65762  94254]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0179696
{'0': {'precision': 0.5203561116458133, 'recall': 0.3618514463827285, 'f1-score': 0.4268646531523783, 'support': 209177}, '1': {'precision': 0.46718730767486605, 'recall': 0.6984315301660476, 'f1-score': 0.5598714358081551, 'support': 206507}, '2': {'precision': 0.5027786743346733, 'recall': 0.41012335868800354, 'f1-score': 0.45174897444820566, 'support': 208903}, 'accuracy': 0.4892801163008516, 'macro avg': {'precision': 0.49677403121845093, 'recall': 0.49013544507892653, 'f1-score': 0.47949502113624637, 'support': 624587}, 'weighted avg': {'precision': 0.49689787510192507, 'recall': 0.4892801163008516, 'f1-score': 0.47916359795519803, 'support': 624587}}
[[ 75691  82172  51314]
 [ 28861 144231  33415]
 [ 40908  82319  85676]]
Evaluating performance on  val set...
826/826 - 7s - 7s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.79906183
{'0': {'precision': 0.45859575978000533, 'recall': 0.5178164517340679, 'f1-score': 0.48641019911322286, 'support': 39935}, '1': {'precision': 0.800591455031259, 'recall': 0.6995277851233426, 'f1-score': 0.7466552689091217, 'support': 132355}, '2': {'precision': 0.4375234225527131, 'recall': 0.5666189843670175, 'f1-score': 0.4937727470032388, 'support': 39148}, 'accuracy': 0.64059913544396, 'macro avg': {'precision': 0.5655702124546591, 'recall': 0.5946544070748093, 'f1-score': 0.5756127383418611, 'support': 211438}, 'weighted avg': {'precision': 0.6687751049649089, 'recall': 0.64059913544396, 'f1-score': 0.6506804118357917, 'support': 211438}}
[[20679 11637  7619]
 [18871 92586 20898]
 [ 5542 11424 22182]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8587011
{'0': {'precision': 0.5272108843537415, 'recall': 0.4540636382909014, 'f1-score': 0.48791095003883, 'support': 51887}, '1': {'precision': 0.6828890553586909, 'recall': 0.7470167943429582, 'f1-score': 0.7135149396477803, 'support': 108608}, '2': {'precision': 0.5086456834157228, 'recall': 0.4786918713071472, 'f1-score': 0.49321440851081044, 'support': 50943}, 'accuracy': 0.6104768300873069, 'macro avg': {'precision': 0.572915207709385, 'recall': 0.559924101313669, 'f1-score': 0.5648800993991402, 'support': 211438}, 'weighted avg': {'precision': 0.6027040680062546, 'recall': 0.6104768300873069, 'f1-score': 0.6050732963927824, 'support': 211438}}
[[23560 18822  9505]
 [13424 81132 14052]
 [ 7704 18853 24386]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.91386807
{'0': {'precision': 0.5599703554949915, 'recall': 0.3904028534760071, 'f1-score': 0.4600593168738829, 'support': 59997}, '1': {'precision': 0.5852235537490607, 'recall': 0.7808975437234479, 'f1-score': 0.6690470361628322, 'support': 92742}, '2': {'precision': 0.5351737973745039, 'recall': 0.4180991158282083, 'f1-score': 0.46944728712568257, 'support': 58699}, 'accuracy': 0.5693725820335039, 'macro avg': {'precision': 0.5601225688728521, 'recall': 0.5297998376758878, 'f1-score': 0.5328512133874659, 'support': 211438}, 'weighted avg': {'precision': 0.5641630689493581, 'recall': 0.5693725820335039, 'f1-score': 0.5543328321743782, 'support': 211438}}
[[23423 25832 10742]
 [ 9746 72422 10574]
 [ 8660 25497 24542]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9935243
{'0': {'precision': 0.5446784444683831, 'recall': 0.3113789971209952, 'f1-score': 0.3962384287603468, 'support': 64953}, '1': {'precision': 0.5012972543992186, 'recall': 0.7849470074440501, 'f1-score': 0.6118461187405989, 'support': 83691}, '2': {'precision': 0.516551086453999, 'recall': 0.3558620250342389, 'f1-score': 0.42140796198163194, 'support': 62794}, 'accuracy': 0.5120366253937324, 'macro avg': {'precision': 0.5208422617738669, 'recall': 0.4840626765330948, 'f1-score': 0.4764975031608592, 'support': 211438}, 'weighted avg': {'precision': 0.51915396685682, 'recall': 0.5120366253937324, 'f1-score': 0.48905485178380836, 'support': 211438}}
[[20225 33573 11155]
 [ 8239 65693  9759]
 [ 8668 31780 22346]]
training model: results/ATVI/W3/deepVOL_L3/seq2seq
Epoch 1/50
2440/2440 - 107s - loss: 12.3326 - accuracy10: 0.4637 - accuracy20: 0.4675 - accuracy30: 0.4624 - accuracy50: 0.4426 - val_loss: 12.2265 - val_accuracy10: 0.6117 - val_accuracy20: 0.5576 - val_accuracy30: 0.5080 - val_accuracy50: 0.4594 - 107s/epoch - 44ms/step
Epoch 2/50
2440/2440 - 100s - loss: 11.7567 - accuracy10: 0.5135 - accuracy20: 0.5185 - accuracy30: 0.5096 - accuracy50: 0.4791 - val_loss: 11.5530 - val_accuracy10: 0.5901 - val_accuracy20: 0.5659 - val_accuracy30: 0.5327 - val_accuracy50: 0.4848 - 100s/epoch - 41ms/step
Epoch 3/50
2440/2440 - 100s - loss: 11.4931 - accuracy10: 0.5479 - accuracy20: 0.5428 - accuracy30: 0.5280 - accuracy50: 0.4920 - val_loss: 11.2594 - val_accuracy10: 0.6064 - val_accuracy20: 0.5846 - val_accuracy30: 0.5516 - val_accuracy50: 0.5001 - 100s/epoch - 41ms/step
Epoch 4/50
2440/2440 - 101s - loss: 11.3679 - accuracy10: 0.5585 - accuracy20: 0.5512 - accuracy30: 0.5340 - accuracy50: 0.4959 - val_loss: 11.1817 - val_accuracy10: 0.5985 - val_accuracy20: 0.5829 - val_accuracy30: 0.5537 - val_accuracy50: 0.5038 - 101s/epoch - 41ms/step
Epoch 5/50
2440/2440 - 100s - loss: 11.2713 - accuracy10: 0.5660 - accuracy20: 0.5568 - accuracy30: 0.5379 - accuracy50: 0.4990 - val_loss: 11.2006 - val_accuracy10: 0.5877 - val_accuracy20: 0.5750 - val_accuracy30: 0.5479 - val_accuracy50: 0.4981 - 100s/epoch - 41ms/step
Epoch 6/50
2440/2440 - 101s - loss: 11.1947 - accuracy10: 0.5715 - accuracy20: 0.5616 - accuracy30: 0.5423 - accuracy50: 0.5020 - val_loss: 11.1737 - val_accuracy10: 0.5991 - val_accuracy20: 0.5769 - val_accuracy30: 0.5428 - val_accuracy50: 0.4917 - 101s/epoch - 41ms/step
Epoch 7/50
2440/2440 - 103s - loss: 11.1521 - accuracy10: 0.5730 - accuracy20: 0.5636 - accuracy30: 0.5440 - accuracy50: 0.5038 - val_loss: 11.0023 - val_accuracy10: 0.6311 - val_accuracy20: 0.5996 - val_accuracy30: 0.5564 - val_accuracy50: 0.4993 - 103s/epoch - 42ms/step
Epoch 8/50
2440/2440 - 100s - loss: 11.1096 - accuracy10: 0.5758 - accuracy20: 0.5664 - accuracy30: 0.5463 - accuracy50: 0.5056 - val_loss: 10.9212 - val_accuracy10: 0.6318 - val_accuracy20: 0.6006 - val_accuracy30: 0.5578 - val_accuracy50: 0.5019 - 100s/epoch - 41ms/step
Epoch 9/50
2440/2440 - 100s - loss: 11.0804 - accuracy10: 0.5771 - accuracy20: 0.5680 - accuracy30: 0.5486 - accuracy50: 0.5069 - val_loss: 10.8712 - val_accuracy10: 0.6326 - val_accuracy20: 0.6041 - val_accuracy30: 0.5619 - val_accuracy50: 0.5044 - 100s/epoch - 41ms/step
Epoch 10/50
2440/2440 - 100s - loss: 11.0540 - accuracy10: 0.5787 - accuracy20: 0.5695 - accuracy30: 0.5490 - accuracy50: 0.5073 - val_loss: 10.8761 - val_accuracy10: 0.6328 - val_accuracy20: 0.6035 - val_accuracy30: 0.5603 - val_accuracy50: 0.5030 - 100s/epoch - 41ms/step
Epoch 11/50
2440/2440 - 99s - loss: 11.0295 - accuracy10: 0.5802 - accuracy20: 0.5709 - accuracy30: 0.5507 - accuracy50: 0.5087 - val_loss: 10.8605 - val_accuracy10: 0.6428 - val_accuracy20: 0.6070 - val_accuracy30: 0.5603 - val_accuracy50: 0.5016 - 99s/epoch - 41ms/step
Epoch 12/50
2440/2440 - 102s - loss: 11.0064 - accuracy10: 0.5815 - accuracy20: 0.5722 - accuracy30: 0.5517 - accuracy50: 0.5094 - val_loss: 10.7759 - val_accuracy10: 0.6358 - val_accuracy20: 0.6066 - val_accuracy30: 0.5625 - val_accuracy50: 0.5053 - 102s/epoch - 42ms/step
Epoch 13/50
2440/2440 - 103s - loss: 10.9867 - accuracy10: 0.5826 - accuracy20: 0.5732 - accuracy30: 0.5525 - accuracy50: 0.5103 - val_loss: 10.7736 - val_accuracy10: 0.6453 - val_accuracy20: 0.6121 - val_accuracy30: 0.5660 - val_accuracy50: 0.5076 - 103s/epoch - 42ms/step
Epoch 14/50
2440/2440 - 100s - loss: 10.9688 - accuracy10: 0.5832 - accuracy20: 0.5744 - accuracy30: 0.5538 - accuracy50: 0.5115 - val_loss: 10.7890 - val_accuracy10: 0.6446 - val_accuracy20: 0.6122 - val_accuracy30: 0.5679 - val_accuracy50: 0.5087 - 100s/epoch - 41ms/step
Epoch 15/50
2440/2440 - 101s - loss: 10.9537 - accuracy10: 0.5844 - accuracy20: 0.5752 - accuracy30: 0.5545 - accuracy50: 0.5119 - val_loss: 10.8160 - val_accuracy10: 0.6459 - val_accuracy20: 0.6113 - val_accuracy30: 0.5648 - val_accuracy50: 0.5062 - 101s/epoch - 41ms/step
Epoch 16/50
2440/2440 - 100s - loss: 10.9407 - accuracy10: 0.5852 - accuracy20: 0.5756 - accuracy30: 0.5552 - accuracy50: 0.5129 - val_loss: 10.7993 - val_accuracy10: 0.6460 - val_accuracy20: 0.6110 - val_accuracy30: 0.5661 - val_accuracy50: 0.5076 - 100s/epoch - 41ms/step
Epoch 17/50
2440/2440 - 102s - loss: 10.9241 - accuracy10: 0.5859 - accuracy20: 0.5770 - accuracy30: 0.5561 - accuracy50: 0.5138 - val_loss: 10.8737 - val_accuracy10: 0.6373 - val_accuracy20: 0.6056 - val_accuracy30: 0.5630 - val_accuracy50: 0.5064 - 102s/epoch - 42ms/step
Epoch 18/50
2440/2440 - 99s - loss: 10.9139 - accuracy10: 0.5861 - accuracy20: 0.5772 - accuracy30: 0.5568 - accuracy50: 0.5143 - val_loss: 10.8813 - val_accuracy10: 0.6442 - val_accuracy20: 0.6090 - val_accuracy30: 0.5633 - val_accuracy50: 0.5055 - 99s/epoch - 41ms/step
Epoch 19/50
2440/2440 - 101s - loss: 10.9014 - accuracy10: 0.5870 - accuracy20: 0.5779 - accuracy30: 0.5579 - accuracy50: 0.5151 - val_loss: 10.8540 - val_accuracy10: 0.6405 - val_accuracy20: 0.6082 - val_accuracy30: 0.5643 - val_accuracy50: 0.5070 - 101s/epoch - 42ms/step
Epoch 20/50
2440/2440 - 100s - loss: 10.8878 - accuracy10: 0.5876 - accuracy20: 0.5787 - accuracy30: 0.5583 - accuracy50: 0.5154 - val_loss: 10.8604 - val_accuracy10: 0.6313 - val_accuracy20: 0.6051 - val_accuracy30: 0.5647 - val_accuracy50: 0.5084 - 100s/epoch - 41ms/step
Epoch 21/50
2440/2440 - 100s - loss: 10.8765 - accuracy10: 0.5885 - accuracy20: 0.5789 - accuracy30: 0.5586 - accuracy50: 0.5162 - val_loss: 10.8935 - val_accuracy10: 0.6254 - val_accuracy20: 0.6041 - val_accuracy30: 0.5660 - val_accuracy50: 0.5086 - 100s/epoch - 41ms/step
Epoch 22/50
2440/2440 - 100s - loss: 10.8639 - accuracy10: 0.5888 - accuracy20: 0.5800 - accuracy30: 0.5597 - accuracy50: 0.5172 - val_loss: 10.8571 - val_accuracy10: 0.6282 - val_accuracy20: 0.6034 - val_accuracy30: 0.5646 - val_accuracy50: 0.5095 - 100s/epoch - 41ms/step
Epoch 23/50
2440/2440 - 99s - loss: 10.8553 - accuracy10: 0.5891 - accuracy20: 0.5805 - accuracy30: 0.5601 - accuracy50: 0.5178 - val_loss: 10.8455 - val_accuracy10: 0.6339 - val_accuracy20: 0.6069 - val_accuracy30: 0.5664 - val_accuracy50: 0.5106 - 99s/epoch - 41ms/step
testing model: results/ATVI/W3/deepVOL_L3/seq2seq
Evaluating performance on  test set...
6082/6082 - 103s - 103s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7645243
{'0': {'precision': 0.4917840823755521, 'recall': 0.41981702679405736, 'f1-score': 0.45295980711479134, 'support': 276106}, '1': {'precision': 0.8230996279165242, 'recall': 0.7255525773687852, 'f1-score': 0.7712539386544821, 'support': 1005832}, '2': {'precision': 0.40982429328337255, 'recall': 0.6477992912910291, 'f1-score': 0.5020385146756139, 'support': 274866}, 'accuracy': 0.6576010853003975, 'macro avg': {'precision': 0.574902667858483, 'recall': 0.5977229651512905, 'f1-score': 0.5754174201482958, 'support': 1556804}, 'weighted avg': {'precision': 0.6913723532265752, 'recall': 0.6576010853003975, 'f1-score': 0.6672709798425357, 'support': 1556804}}
[[115914  90240  69952]
 [ 89584 729784 186464]
 [ 30203  66605 178058]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.81079465
{'0': {'precision': 0.5621058513610601, 'recall': 0.3550475368781969, 'f1-score': 0.4352037522833715, 'support': 356986}, '1': {'precision': 0.7194424959260978, 'recall': 0.7879584802897208, 'f1-score': 0.7521433575940693, 'support': 846056}, '2': {'precision': 0.4839827224923892, 'recall': 0.5536547170131331, 'f1-score': 0.5164796624695102, 'support': 353762}, 'accuracy': 0.6354467229015341, 'macro avg': {'precision': 0.5885103565931823, 'recall': 0.5655535780603502, 'f1-score': 0.5679422574489837, 'support': 1556804}, 'weighted avg': {'precision': 0.6298591573901291, 'recall': 0.6354467229015341, 'f1-score': 0.6259156101987009, 'support': 1556804}}
[[126747 140206  90033]
 [ 60606 666657 118793]
 [ 38133 119767 195862]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.866179
{'0': {'precision': 0.5884978370140381, 'recall': 0.3021831535303996, 'f1-score': 0.39932171927463783, 'support': 411469}, '1': {'precision': 0.6339991514389572, 'recall': 0.8227602879364061, 'f1-score': 0.7161502582925022, 'support': 739191}, '2': {'precision': 0.5121591918208626, 'recall': 0.4870735502678853, 'f1-score': 0.49930148473930297, 'support': 406144}, 'accuracy': 0.5975948160462075, 'macro avg': {'precision': 0.5782187267579527, 'recall': 0.5373389972448971, 'f1-score': 0.5382578207688143, 'support': 1556804}, 'weighted avg': {'precision': 0.5901869895327452, 'recall': 0.5975948160462075, 'f1-score': 0.5758391141747249, 'support': 1556804}}
[[124339 184477 102653]
 [ 45238 608177  85776]
 [ 41705 166617 197822]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9428898
{'0': {'precision': 0.560567940552017, 'recall': 0.24192022503567723, 'f1-score': 0.33798061614233393, 'support': 436553}, '1': {'precision': 0.5651823341352752, 'recall': 0.817757316384057, 'f1-score': 0.6684051450207216, 'support': 684867}, '2': {'precision': 0.48934501796140684, 'recall': 0.42425996361832313, 'f1-score': 0.45448416701523014, 'support': 435384}, 'accuracy': 0.5462357496512085, 'macro avg': {'precision': 0.5383650975495663, 'recall': 0.4946458350126857, 'f1-score': 0.48695664272609523, 'support': 1556804}, 'weighted avg': {'precision': 0.542679320636469, 'recall': 0.5462357496512085, 'f1-score': 0.5159225008064277, 'support': 1556804}}
[[105611 220727 110215]
 [ 42267 560055  82545]
 [ 40522 210146 184716]]
Evaluating performance on  train set...
2440/2440 - 41s - 41s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.893305
{'0': {'precision': 0.4849429106044984, 'recall': 0.44272765304699485, 'f1-score': 0.46287474257804667, 'support': 143420}, '1': {'precision': 0.7659195213141672, 'recall': 0.6131051938248397, 'f1-score': 0.6810454249505107, 'support': 337805}, '2': {'precision': 0.41829828215637527, 'recall': 0.6513790265202773, 'f1-score': 0.5094447187315027, 'support': 143362}, 'accuracy': 0.5827674927592152, 'macro avg': {'precision': 0.5563869046916803, 'recall': 0.5690706244640373, 'f1-score': 0.5511216287533532, 'support': 624587}, 'weighted avg': {'precision': 0.6216108155676178, 'recall': 0.5827674927592152, 'f1-score': 0.5915605978394305, 'support': 624587}}
[[ 63496  34147  45777]
 [ 46610 207110  84085]
 [ 20829  29150  93383]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.91957927
{'0': {'precision': 0.546626489825294, 'recall': 0.3849787224561638, 'f1-score': 0.45177842489369985, 'support': 179532}, '1': {'precision': 0.6388403376805338, 'recall': 0.6793896863770624, 'f1-score': 0.6584913539229649, 'support': 265765}, '2': {'precision': 0.4804512045732952, 'recall': 0.5775168721066428, 'f1-score': 0.5245312840360484, 'support': 179290}, 'accuracy': 0.5655208962082144, 'macro avg': {'precision': 0.555306010693041, 'recall': 0.5472950936466231, 'f1-score': 0.5449336876175711, 'support': 624587}, 'weighted avg': {'precision': 0.5668680996929618, 'recall': 0.5655208962082144, 'f1-score': 0.5606198220074635, 'support': 624587}}
[[ 69116  52730  57686]
 [ 30924 180558  54283]
 [ 26401  49346 103543]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9520449
{'0': {'precision': 0.5699364023080487, 'recall': 0.33536887602355414, 'f1-score': 0.422264036721868, 'support': 201748}, '1': {'precision': 0.5415513874196436, 'recall': 0.7215889839122833, 'f1-score': 0.6187396496121328, 'support': 221349}, '2': {'precision': 0.5029629840330716, 'recall': 0.5265422601617946, 'f1-score': 0.514482598090324, 'support': 201490}, 'accuracy': 0.5339144106425526, 'macro avg': {'precision': 0.5381502579202546, 'recall': 0.5278333733658773, 'f1-score': 0.5184954281414417, 'support': 624587}, 'weighted avg': {'precision': 0.5382715282252408, 'recall': 0.5339144106425526, 'f1-score': 0.5216429837184872, 'support': 624587}}
[[ 67660  68325  65763]
 [ 22546 159723  39080]
 [ 28509  66888 106093]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0143404
{'0': {'precision': 0.5409655904198878, 'recall': 0.2729745622128628, 'f1-score': 0.3628518503220231, 'support': 209177}, '1': {'precision': 0.47122610565150463, 'recall': 0.7026347775135952, 'f1-score': 0.5641211060893231, 'support': 206507}, '2': {'precision': 0.4771951098206208, 'recall': 0.4822525286855622, 'f1-score': 0.47971048997666776, 'support': 208903}, 'accuracy': 0.48502930736630767, 'macro avg': {'precision': 0.49646226863067106, 'recall': 0.48595395613734005, 'f1-score': 0.468894482129338, 'support': 624587}, 'weighted avg': {'precision': 0.49657860111384533, 'recall': 0.48502930736630767, 'f1-score': 0.46848266012195816, 'support': 624587}}
[[ 57100  81630  70447]
 [ 21482 145099  39926]
 [ 26970  81189 100744]]
Evaluating performance on  val set...
826/826 - 14s - 14s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.79291564
{'0': {'precision': 0.5005800109896819, 'recall': 0.4106172530361838, 'f1-score': 0.4511576080227807, 'support': 39935}, '1': {'precision': 0.7925218972070732, 'recall': 0.7246496165615202, 'f1-score': 0.7570675875678343, 'support': 132355}, '2': {'precision': 0.41708289975719737, 'recall': 0.614309798712578, 'f1-score': 0.49683910420626404, 'support': 39148}, 'accuracy': 0.644907727087846, 'macro avg': {'precision': 0.5700616026513176, 'recall': 0.583192222770094, 'f1-score': 0.5683547665989597, 'support': 211438}, 'weighted avg': {'precision': 0.6678688778904922, 'recall': 0.644907727087846, 'f1-score': 0.6511077331435091, 'support': 211438}}
[[16398 13966  9571]
 [12404 95911 24040]
 [ 3956 11143 24049]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.85499775
{'0': {'precision': 0.5728090530531803, 'recall': 0.3472931562819203, 'f1-score': 0.43241427303049934, 'support': 51887}, '1': {'precision': 0.6736354640807442, 'recall': 0.783524233942251, 'f1-score': 0.7244363286554039, 'support': 108608}, '2': {'precision': 0.489600029820703, 'recall': 0.5156547513888071, 'f1-score': 0.502289740623536, 'support': 50943}, 'accuracy': 0.6119335218834836, 'macro avg': {'precision': 0.5786815156515425, 'recall': 0.5488240472043261, 'f1-score': 0.5530467807698131, 'support': 211438}, 'weighted avg': {'precision': 0.6045518692846503, 'recall': 0.6119335218834836, 'f1-score': 0.5992508746011806, 'support': 211438}}
[[18020 21802 12065]
 [ 8191 85097 15320]
 [ 5248 19426 26269]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.91721034
{'0': {'precision': 0.5950262222974116, 'recall': 0.29311465573278667, 'f1-score': 0.39275504734679295, 'support': 59997}, '1': {'precision': 0.5786847864346601, 'recall': 0.8154449979513058, 'f1-score': 0.6769608106414594, 'support': 92742}, '2': {'precision': 0.5143465437427974, 'recall': 0.4486107088706792, 'f1-score': 0.4792349130086627, 'support': 58699}, 'accuracy': 0.5653903271881119, 'macro avg': {'precision': 0.5626858508249565, 'recall': 0.5190567875182572, 'f1-score': 0.5163169236656384, 'support': 211438}, 'weighted avg': {'precision': 0.5654603264023473, 'recall': 0.5653903271881119, 'f1-score': 0.541423179536655, 'support': 211438}}
[[17586 28561 13850]
 [ 6102 75626 11014]
 [ 5867 26499 26333]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0003936
{'0': {'precision': 0.5726640984968653, 'recall': 0.2334457222915031, 'f1-score': 0.33168181470179703, 'support': 64953}, '1': {'precision': 0.5008480664824869, 'recall': 0.8079841321050053, 'f1-score': 0.6183791791645329, 'support': 83691}, '2': {'precision': 0.4929425190702144, 'recall': 0.39209160110838615, 'f1-score': 0.4367710061113526, 'support': 62794}, 'accuracy': 0.5079739687284216, 'macro avg': {'precision': 0.5221515613498555, 'recall': 0.4778404851682982, 'f1-score': 0.4622773333258942, 'support': 211438}, 'weighted avg': {'precision': 0.5205618633554411, 'recall': 0.5079739687284216, 'f1-score': 0.47637179386648104, 'support': 211438}}
[[15163 34954 14836]
 [ 5580 67621 10490]
 [ 5735 32438 24621]]
training model: results/ATVI/W4/deepLOB_L1/seq2seq
Epoch 1/50
1972/1972 - 53s - loss: 11.9440 - accuracy10: 0.4625 - accuracy20: 0.4814 - accuracy30: 0.4862 - accuracy50: 0.4790 - val_loss: 13.1082 - val_accuracy10: 0.4783 - val_accuracy20: 0.4567 - val_accuracy30: 0.4300 - val_accuracy50: 0.3705 - 53s/epoch - 27ms/step
Epoch 2/50
1972/1972 - 51s - loss: 11.8364 - accuracy10: 0.4689 - accuracy20: 0.4898 - accuracy30: 0.4960 - accuracy50: 0.4885 - val_loss: 12.9635 - val_accuracy10: 0.5859 - val_accuracy20: 0.5207 - val_accuracy30: 0.4679 - val_accuracy50: 0.3907 - 51s/epoch - 26ms/step
Epoch 3/50
1972/1972 - 48s - loss: 11.7499 - accuracy10: 0.4704 - accuracy20: 0.4901 - accuracy30: 0.4963 - accuracy50: 0.4874 - val_loss: 12.5006 - val_accuracy10: 0.5429 - val_accuracy20: 0.5103 - val_accuracy30: 0.4849 - val_accuracy50: 0.4366 - 48s/epoch - 24ms/step
Epoch 4/50
1972/1972 - 48s - loss: 11.4583 - accuracy10: 0.5023 - accuracy20: 0.5138 - accuracy30: 0.5134 - accuracy50: 0.4985 - val_loss: 11.8044 - val_accuracy10: 0.4693 - val_accuracy20: 0.4806 - val_accuracy30: 0.4822 - val_accuracy50: 0.4778 - 48s/epoch - 24ms/step
Epoch 5/50
1972/1972 - 47s - loss: 11.2173 - accuracy10: 0.5344 - accuracy20: 0.5376 - accuracy30: 0.5309 - accuracy50: 0.5120 - val_loss: 11.7448 - val_accuracy10: 0.4937 - val_accuracy20: 0.5024 - val_accuracy30: 0.4996 - val_accuracy50: 0.4871 - 47s/epoch - 24ms/step
Epoch 6/50
1972/1972 - 83s - loss: 11.0821 - accuracy10: 0.5480 - accuracy20: 0.5500 - accuracy30: 0.5412 - accuracy50: 0.5195 - val_loss: 11.7145 - val_accuracy10: 0.5305 - val_accuracy20: 0.5281 - val_accuracy30: 0.5161 - val_accuracy50: 0.4910 - 83s/epoch - 42ms/step
Epoch 7/50
1972/1972 - 87s - loss: 10.9775 - accuracy10: 0.5586 - accuracy20: 0.5595 - accuracy30: 0.5487 - accuracy50: 0.5246 - val_loss: 11.7461 - val_accuracy10: 0.5438 - val_accuracy20: 0.5378 - val_accuracy30: 0.5234 - val_accuracy50: 0.4944 - 87s/epoch - 44ms/step
Epoch 8/50
1972/1972 - 88s - loss: 10.8908 - accuracy10: 0.5662 - accuracy20: 0.5663 - accuracy30: 0.5548 - accuracy50: 0.5290 - val_loss: 11.8004 - val_accuracy10: 0.5674 - val_accuracy20: 0.5522 - val_accuracy30: 0.5313 - val_accuracy50: 0.4956 - 88s/epoch - 45ms/step
Epoch 9/50
1972/1972 - 90s - loss: 10.8267 - accuracy10: 0.5702 - accuracy20: 0.5704 - accuracy30: 0.5590 - accuracy50: 0.5327 - val_loss: 11.9191 - val_accuracy10: 0.5896 - val_accuracy20: 0.5663 - val_accuracy30: 0.5401 - val_accuracy50: 0.4948 - 90s/epoch - 45ms/step
Epoch 10/50
1972/1972 - 61s - loss: 10.7720 - accuracy10: 0.5744 - accuracy20: 0.5740 - accuracy30: 0.5620 - accuracy50: 0.5345 - val_loss: 11.7968 - val_accuracy10: 0.5848 - val_accuracy20: 0.5645 - val_accuracy30: 0.5405 - val_accuracy50: 0.4970 - 61s/epoch - 31ms/step
Epoch 11/50
1972/1972 - 46s - loss: 10.7308 - accuracy10: 0.5788 - accuracy20: 0.5773 - accuracy30: 0.5648 - accuracy50: 0.5364 - val_loss: 11.7915 - val_accuracy10: 0.5838 - val_accuracy20: 0.5651 - val_accuracy30: 0.5418 - val_accuracy50: 0.4995 - 46s/epoch - 23ms/step
Epoch 12/50
1972/1972 - 52s - loss: 10.6975 - accuracy10: 0.5809 - accuracy20: 0.5793 - accuracy30: 0.5663 - accuracy50: 0.5380 - val_loss: 11.8925 - val_accuracy10: 0.6022 - val_accuracy20: 0.5742 - val_accuracy30: 0.5448 - val_accuracy50: 0.4952 - 52s/epoch - 27ms/step
Epoch 13/50
1972/1972 - 88s - loss: 10.6720 - accuracy10: 0.5840 - accuracy20: 0.5808 - accuracy30: 0.5679 - accuracy50: 0.5392 - val_loss: 11.8704 - val_accuracy10: 0.5963 - val_accuracy20: 0.5719 - val_accuracy30: 0.5438 - val_accuracy50: 0.4963 - 88s/epoch - 45ms/step
Epoch 14/50
1972/1972 - 91s - loss: 10.6432 - accuracy10: 0.5866 - accuracy20: 0.5831 - accuracy30: 0.5699 - accuracy50: 0.5404 - val_loss: 11.9369 - val_accuracy10: 0.6027 - val_accuracy20: 0.5747 - val_accuracy30: 0.5449 - val_accuracy50: 0.4936 - 91s/epoch - 46ms/step
Epoch 15/50
1972/1972 - 89s - loss: 10.6169 - accuracy10: 0.5883 - accuracy20: 0.5849 - accuracy30: 0.5715 - accuracy50: 0.5418 - val_loss: 11.9506 - val_accuracy10: 0.6066 - val_accuracy20: 0.5771 - val_accuracy30: 0.5465 - val_accuracy50: 0.4941 - 89s/epoch - 45ms/step
Epoch 16/50
1972/1972 - 90s - loss: 10.5928 - accuracy10: 0.5905 - accuracy20: 0.5868 - accuracy30: 0.5728 - accuracy50: 0.5425 - val_loss: 11.9802 - val_accuracy10: 0.6109 - val_accuracy20: 0.5786 - val_accuracy30: 0.5466 - val_accuracy50: 0.4918 - 90s/epoch - 46ms/step
testing model: results/ATVI/W4/deepLOB_L1/seq2seq
Evaluating performance on  test set...
4274/4274 - 66s - 66s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0275408
{'0': {'precision': 0.347520582396995, 'recall': 0.6480585680476451, 'f1-score': 0.4524274958845744, 'support': 230706}, '1': {'precision': 0.77273276841818, 'recall': 0.3519875250584566, 'f1-score': 0.4836621091744081, 'support': 635514}, '2': {'precision': 0.36503632866759267, 'recall': 0.5997717746713774, 'f1-score': 0.4538487724279937, 'support': 227845}, 'accuracy': 0.46602258549537734, 'macro avg': {'precision': 0.4950965598275892, 'recall': 0.533272622592493, 'f1-score': 0.46331279249565877, 'support': 1094065}, 'weighted avg': {'precision': 0.5981630692657749, 'recall': 0.46602258549537734, 'f1-score': 0.4708668617214404, 'support': 1094065}}
[[149511  27362  53833]
 [227949 223693 183872]
 [ 52762  38428 136655]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0200644
{'0': {'precision': 0.41558957510774636, 'recall': 0.6251536008057748, 'f1-score': 0.4992726838836134, 'support': 297850}, '1': {'precision': 0.6599406932751628, 'recall': 0.34597859299894573, 'f1-score': 0.4539635647464304, 'support': 503667}, '2': {'precision': 0.42756125465022216, 'recall': 0.5582536882836321, 'f1-score': 0.48424432818052565, 'support': 292548}, 'accuracy': 0.4787430362912624, 'macro avg': {'precision': 0.5010305076777104, 'recall': 0.5097952940294509, 'f1-score': 0.4791601922701898, 'support': 1094065}, 'weighted avg': {'precision': 0.5312809513429977, 'recall': 0.4787430362912624, 'f1-score': 0.4743955298637933, 'support': 1094065}}
[[186202  38907  72741]
 [183495 174258 145914]
 [ 78346  50886 163316]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0234646
{'0': {'precision': 0.44769994822726317, 'recall': 0.6166550749645646, 'f1-score': 0.5187675899866687, 'support': 340761}, '1': {'precision': 0.5752510436880148, 'recall': 0.331690384454809, 'f1-score': 0.4207663999418935, 'support': 419165}, '2': {'precision': 0.4587653225069514, 'recall': 0.5258709698658343, 'f1-score': 0.49003142979053316, 'support': 334139}, 'accuracy': 0.4797512030820838, 'macro avg': {'precision': 0.4939054381407431, 'recall': 0.49140547642840265, 'f1-score': 0.4765218065730317, 'support': 1094065}, 'weighted avg': {'precision': 0.4999476008121157, 'recall': 0.4797512030820838, 'f1-score': 0.4724444367399286, 'support': 1094065}}
[[210132  45650  84979]
 [157810 139033 122322]
 [101417  57008 175714]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0294391
{'0': {'precision': 0.4762405550451864, 'recall': 0.5903819814335718, 'f1-score': 0.5272040162489113, 'support': 394260}, '1': {'precision': 0.44626021944676747, 'recall': 0.3119433689832739, 'f1-score': 0.36720458310066245, 'support': 313044}, '2': {'precision': 0.48496076214329514, 'recall': 0.4846197005385755, 'f1-score': 0.4847901713546718, 'support': 386761}, 'accuracy': 0.47332471105464485, 'macro avg': {'precision': 0.469153845545083, 'recall': 0.4623150169851404, 'f1-score': 0.4597329235680819, 'support': 1094065}, 'weighted avg': {'precision': 0.47074496917085557, 'recall': 0.47332471105464485, 'f1-score': 0.4664298541876066, 'support': 1094065}}
[[232764  55682 105814]
 [122149  97652  93243]
 [133840  65489 187432]]
Evaluating performance on  train set...
1972/1972 - 17s - 17s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9072553
{'0': {'precision': 0.35658241346921193, 'recall': 0.5813988300861315, 'f1-score': 0.4420484939218442, 'support': 86844}, '1': {'precision': 0.8368908824761483, 'recall': 0.5373732916664148, 'f1-score': 0.6544925156946793, 'support': 330878}, '2': {'precision': 0.3591387419946321, 'recall': 0.622383660687559, 'f1-score': 0.4554599759038175, 'support': 86858}, 'accuracy': 0.5595842086487772, 'macro avg': {'precision': 0.5175373459799975, 'recall': 0.5803852608133684, 'f1-score': 0.5173336618401136, 'support': 504580}, 'weighted avg': {'precision': 0.6719844174946152, 'recall': 0.5595842086487772, 'f1-score': 0.5836671619985463, 'support': 504580}}
[[ 50491  16544  19809]
 [ 76417 177805  76656]
 [ 14689  18110  54059]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9271295
{'0': {'precision': 0.4186239572365757, 'recall': 0.5491222012695546, 'f1-score': 0.47507439193924567, 'support': 112953}, '1': {'precision': 0.7484350683036486, 'recall': 0.5438647509496012, 'f1-score': 0.6299582278981085, 'support': 278538}, '2': {'precision': 0.4224048931569823, 'recall': 0.5752548877432818, 'f1-score': 0.48712092849120187, 'support': 113089}, 'accuracy': 0.552076974909826, 'macro avg': {'precision': 0.5298213062324022, 'recall': 0.5560806133208125, 'f1-score': 0.530717849442852, 'support': 504580}, 'weighted avg': {'precision': 0.6015335246326342, 'recall': 0.552076974909826, 'f1-score': 0.5632732200189039, 'support': 504580}}
[[ 62025  24216  26712]
 [ 64807 151487  62244]
 [ 21332  26702  65055]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9535509
{'0': {'precision': 0.4477119950263577, 'recall': 0.5291101263594548, 'f1-score': 0.4850196265517955, 'support': 130659}, '1': {'precision': 0.6766258767425177, 'recall': 0.5394880869100037, 'f1-score': 0.6003246582273845, 'support': 243010}, '2': {'precision': 0.4520647788810107, 'recall': 0.5401150399890001, 'f1-score': 0.49218293192259505, 'support': 130911}, 'accuracy': 0.5369634151175234, 'macro avg': {'precision': 0.5254675502166287, 'recall': 0.5362377510861528, 'f1-score': 0.5258424055672583, 'support': 504580}, 'weighted avg': {'precision': 0.5590881686421184, 'recall': 0.5369634151175234, 'f1-score': 0.5424099932268156, 'support': 504580}}
[[ 69133  29939  31587]
 [ 57794 131101  54115]
 [ 27487  32717  70707]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.99355793
{'0': {'precision': 0.47471335162408157, 'recall': 0.4938130986280093, 'f1-score': 0.484074897623209, 'support': 154520}, '1': {'precision': 0.5592203410058751, 'recall': 0.5300081749332894, 'f1-score': 0.5442225354640818, 'support': 194497}, '2': {'precision': 0.4801888330219553, 'recall': 0.4923600084853082, 'f1-score': 0.4861982613332318, 'support': 155563}, 'accuracy': 0.507316976495303, 'macro avg': {'precision': 0.5047075085506373, 'recall': 0.5053937606822023, 'f1-score': 0.5048318981401742, 'support': 504580}, 'weighted avg': {'precision': 0.5089757841947109, 'recall': 0.507316976495303, 'f1-score': 0.5079142332012314, 'support': 504580}}
[[ 76304  39130  39086]
 [ 47585 103085  43827]
 [ 36848  42122  76593]]
Evaluating performance on  val set...
707/707 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.95778424
{'0': {'precision': 0.35446652958647473, 'recall': 0.5806874181273782, 'f1-score': 0.4402146927387511, 'support': 32062}, '1': {'precision': 0.8204569248641129, 'recall': 0.48727470954993013, 'f1-score': 0.611421945054534, 'support': 117404}, '2': {'precision': 0.3394184913594175, 'recall': 0.6346522628483764, 'f1-score': 0.4422937710906439, 'support': 31288}, 'accuracy': 0.5293548137247308, 'macro avg': {'precision': 0.5047806486033349, 'recall': 0.5675381301752283, 'f1-score': 0.49797680296130964, 'support': 180754}, 'weighted avg': {'precision': 0.654533545238287, 'recall': 0.5293548137247308, 'f1-score': 0.5517777367342156, 'support': 180754}}
[[18618  6064  7380]
 [28930 57208 31266]
 [ 4976  6455 19857]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9692144
{'0': {'precision': 0.42055017067338407, 'recall': 0.5471017073923677, 'f1-score': 0.475550601688443, 'support': 42111}, '1': {'precision': 0.725604670558799, 'recall': 0.4911167903439357, 'f1-score': 0.5857653510919596, 'support': 97431}, '2': {'precision': 0.40432479258987775, 'recall': 0.5889061438415996, 'f1-score': 0.47946423279796124, 'support': 41212}, 'accuracy': 0.5264558460670303, 'macro avg': {'precision': 0.5168265446073536, 'recall': 0.5423748805259677, 'f1-score': 0.5135933951927879, 'support': 180754}, 'weighted avg': {'precision': 0.5812829052007439, 'recall': 0.5264558460670303, 'f1-score': 0.5358514626067048, 'support': 180754}}
[[23039  8650 10422]
 [24247 47850 25334]
 [ 7497  9445 24270]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9879314
{'0': {'precision': 0.4504274103139013, 'recall': 0.5255370025955977, 'f1-score': 0.4850920135449975, 'support': 48929}, '1': {'precision': 0.6501014036824707, 'recall': 0.48576474238121375, 'f1-score': 0.55604499170235, 'support': 83806}, '2': {'precision': 0.4368252928167745, 'recall': 0.5553218517670089, 'f1-score': 0.48899728599721265, 'support': 48019}, 'accuracy': 0.5150093497239342, 'macro avg': {'precision': 0.5124513689377155, 'recall': 0.5222078655812734, 'f1-score': 0.5100447637481867, 'support': 180754}, 'weighted avg': {'precision': 0.5393920728284338, 'recall': 0.5150093497239342, 'f1-score': 0.5190266017994096, 'support': 180754}}
[[25714 10477 12738]
 [21455 40710 21641]
 [ 9919 11434 26666]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0157274
{'0': {'precision': 0.47792155140376363, 'recall': 0.4873309792438205, 'f1-score': 0.4825804030600497, 'support': 58055}, '1': {'precision': 0.5304692775151925, 'recall': 0.4776634391767621, 'f1-score': 0.5026833774564301, 'support': 65789}, '2': {'precision': 0.4664612619551961, 'recall': 0.51077139342822, 'f1-score': 0.48761176253501753, 'support': 56910}, 'accuracy': 0.4911924494063755, 'macro avg': {'precision': 0.49161736362471736, 'recall': 0.49192193728293415, 'f1-score': 0.4909585143504991, 'support': 180754}, 'weighted avg': {'precision': 0.493439090604151, 'recall': 0.4911924494063755, 'f1-score': 0.49148139142149055, 'support': 180754}}
[[28292 13434 16329]
 [17445 31425 16919]
 [13461 14381 29068]]
training model: results/ATVI/W4/deepOF_L1/seq2seq
Epoch 1/50
1972/1972 - 50s - loss: 12.6694 - accuracy10: 0.4119 - accuracy20: 0.4281 - accuracy30: 0.4331 - accuracy50: 0.4318 - val_loss: 12.9326 - val_accuracy10: 0.2569 - val_accuracy20: 0.3067 - val_accuracy30: 0.3382 - val_accuracy50: 0.3781 - 50s/epoch - 25ms/step
Epoch 2/50
1972/1972 - 48s - loss: 12.6313 - accuracy10: 0.3897 - accuracy20: 0.4105 - accuracy30: 0.4192 - accuracy50: 0.4210 - val_loss: 12.8620 - val_accuracy10: 0.2482 - val_accuracy20: 0.3002 - val_accuracy30: 0.3364 - val_accuracy50: 0.3837 - 48s/epoch - 24ms/step
Epoch 3/50
1972/1972 - 47s - loss: 12.5605 - accuracy10: 0.3980 - accuracy20: 0.4174 - accuracy30: 0.4256 - accuracy50: 0.4255 - val_loss: 12.7879 - val_accuracy10: 0.2717 - val_accuracy20: 0.3100 - val_accuracy30: 0.3423 - val_accuracy50: 0.3883 - 47s/epoch - 24ms/step
Epoch 4/50
1972/1972 - 49s - loss: 12.5030 - accuracy10: 0.4123 - accuracy20: 0.4273 - accuracy30: 0.4328 - accuracy50: 0.4309 - val_loss: 12.7760 - val_accuracy10: 0.3195 - val_accuracy20: 0.3364 - val_accuracy30: 0.3562 - val_accuracy50: 0.3926 - 49s/epoch - 25ms/step
Epoch 5/50
1972/1972 - 48s - loss: 12.4599 - accuracy10: 0.4235 - accuracy20: 0.4351 - accuracy30: 0.4388 - accuracy50: 0.4353 - val_loss: 12.7358 - val_accuracy10: 0.3673 - val_accuracy20: 0.3700 - val_accuracy30: 0.3765 - val_accuracy50: 0.4010 - 48s/epoch - 24ms/step
Epoch 6/50
1972/1972 - 48s - loss: 12.4077 - accuracy10: 0.4348 - accuracy20: 0.4440 - accuracy30: 0.4464 - accuracy50: 0.4416 - val_loss: 12.7271 - val_accuracy10: 0.3962 - val_accuracy20: 0.3931 - val_accuracy30: 0.3928 - val_accuracy50: 0.4051 - 48s/epoch - 24ms/step
Epoch 7/50
1972/1972 - 47s - loss: 12.3557 - accuracy10: 0.4448 - accuracy20: 0.4523 - accuracy30: 0.4533 - accuracy50: 0.4465 - val_loss: 12.6626 - val_accuracy10: 0.4053 - val_accuracy20: 0.4048 - val_accuracy30: 0.4028 - val_accuracy50: 0.4108 - 47s/epoch - 24ms/step
Epoch 8/50
1972/1972 - 49s - loss: 12.3042 - accuracy10: 0.4507 - accuracy20: 0.4587 - accuracy30: 0.4587 - accuracy50: 0.4508 - val_loss: 12.6448 - val_accuracy10: 0.4490 - val_accuracy20: 0.4378 - val_accuracy30: 0.4275 - val_accuracy50: 0.4206 - 49s/epoch - 25ms/step
Epoch 9/50
1972/1972 - 49s - loss: 12.2547 - accuracy10: 0.4558 - accuracy20: 0.4633 - accuracy30: 0.4630 - accuracy50: 0.4557 - val_loss: 12.6100 - val_accuracy10: 0.4401 - val_accuracy20: 0.4358 - val_accuracy30: 0.4285 - val_accuracy50: 0.4257 - 49s/epoch - 25ms/step
Epoch 10/50
1972/1972 - 45s - loss: 12.2008 - accuracy10: 0.4579 - accuracy20: 0.4657 - accuracy30: 0.4664 - accuracy50: 0.4594 - val_loss: 12.5865 - val_accuracy10: 0.4409 - val_accuracy20: 0.4375 - val_accuracy30: 0.4331 - val_accuracy50: 0.4291 - 45s/epoch - 23ms/step
Epoch 11/50
1972/1972 - 48s - loss: 12.1528 - accuracy10: 0.4605 - accuracy20: 0.4685 - accuracy30: 0.4696 - accuracy50: 0.4628 - val_loss: 12.5535 - val_accuracy10: 0.4163 - val_accuracy20: 0.4213 - val_accuracy30: 0.4237 - val_accuracy50: 0.4269 - 48s/epoch - 24ms/step
Epoch 12/50
1972/1972 - 42s - loss: 12.1166 - accuracy10: 0.4609 - accuracy20: 0.4682 - accuracy30: 0.4707 - accuracy50: 0.4653 - val_loss: 12.5051 - val_accuracy10: 0.4277 - val_accuracy20: 0.4320 - val_accuracy30: 0.4350 - val_accuracy50: 0.4356 - 42s/epoch - 21ms/step
Epoch 13/50
1972/1972 - 48s - loss: 12.0776 - accuracy10: 0.4654 - accuracy20: 0.4715 - accuracy30: 0.4743 - accuracy50: 0.4689 - val_loss: 12.4970 - val_accuracy10: 0.4345 - val_accuracy20: 0.4350 - val_accuracy30: 0.4367 - val_accuracy50: 0.4358 - 48s/epoch - 24ms/step
Epoch 14/50
1972/1972 - 45s - loss: 12.0436 - accuracy10: 0.4696 - accuracy20: 0.4750 - accuracy30: 0.4776 - accuracy50: 0.4718 - val_loss: 12.4479 - val_accuracy10: 0.4345 - val_accuracy20: 0.4350 - val_accuracy30: 0.4373 - val_accuracy50: 0.4389 - 45s/epoch - 23ms/step
Epoch 15/50
1972/1972 - 47s - loss: 12.0091 - accuracy10: 0.4722 - accuracy20: 0.4770 - accuracy30: 0.4798 - accuracy50: 0.4737 - val_loss: 12.4438 - val_accuracy10: 0.4378 - val_accuracy20: 0.4369 - val_accuracy30: 0.4412 - val_accuracy50: 0.4412 - 47s/epoch - 24ms/step
Epoch 16/50
1972/1972 - 49s - loss: 11.9736 - accuracy10: 0.4748 - accuracy20: 0.4799 - accuracy30: 0.4825 - accuracy50: 0.4763 - val_loss: 12.4361 - val_accuracy10: 0.4397 - val_accuracy20: 0.4388 - val_accuracy30: 0.4423 - val_accuracy50: 0.4404 - 49s/epoch - 25ms/step
Epoch 17/50
1972/1972 - 48s - loss: 11.9419 - accuracy10: 0.4779 - accuracy20: 0.4818 - accuracy30: 0.4848 - accuracy50: 0.4786 - val_loss: 12.4169 - val_accuracy10: 0.4366 - val_accuracy20: 0.4394 - val_accuracy30: 0.4438 - val_accuracy50: 0.4426 - 48s/epoch - 25ms/step
Epoch 18/50
1972/1972 - 47s - loss: 11.9081 - accuracy10: 0.4816 - accuracy20: 0.4849 - accuracy30: 0.4880 - accuracy50: 0.4813 - val_loss: 12.4180 - val_accuracy10: 0.4411 - val_accuracy20: 0.4383 - val_accuracy30: 0.4429 - val_accuracy50: 0.4416 - 47s/epoch - 24ms/step
Epoch 19/50
1972/1972 - 45s - loss: 11.8835 - accuracy10: 0.4842 - accuracy20: 0.4875 - accuracy30: 0.4905 - accuracy50: 0.4833 - val_loss: 12.4004 - val_accuracy10: 0.4386 - val_accuracy20: 0.4394 - val_accuracy30: 0.4447 - val_accuracy50: 0.4436 - 45s/epoch - 23ms/step
Epoch 20/50
1972/1972 - 45s - loss: 11.8598 - accuracy10: 0.4860 - accuracy20: 0.4896 - accuracy30: 0.4922 - accuracy50: 0.4846 - val_loss: 12.4122 - val_accuracy10: 0.4345 - val_accuracy20: 0.4363 - val_accuracy30: 0.4422 - val_accuracy50: 0.4424 - 45s/epoch - 23ms/step
Epoch 21/50
1972/1972 - 46s - loss: 11.8209 - accuracy10: 0.4893 - accuracy20: 0.4930 - accuracy30: 0.4953 - accuracy50: 0.4874 - val_loss: 12.3994 - val_accuracy10: 0.4533 - val_accuracy20: 0.4481 - val_accuracy30: 0.4499 - val_accuracy50: 0.4457 - 46s/epoch - 23ms/step
Epoch 22/50
1972/1972 - 48s - loss: 11.8047 - accuracy10: 0.4910 - accuracy20: 0.4947 - accuracy30: 0.4968 - accuracy50: 0.4884 - val_loss: 12.3805 - val_accuracy10: 0.4630 - val_accuracy20: 0.4569 - val_accuracy30: 0.4569 - val_accuracy50: 0.4484 - 48s/epoch - 25ms/step
Epoch 23/50
1972/1972 - 47s - loss: 11.7712 - accuracy10: 0.4931 - accuracy20: 0.4967 - accuracy30: 0.4989 - accuracy50: 0.4899 - val_loss: 12.3851 - val_accuracy10: 0.4673 - val_accuracy20: 0.4605 - val_accuracy30: 0.4603 - val_accuracy50: 0.4495 - 47s/epoch - 24ms/step
Epoch 24/50
1972/1972 - 42s - loss: 11.7584 - accuracy10: 0.4932 - accuracy20: 0.4970 - accuracy30: 0.4996 - accuracy50: 0.4915 - val_loss: 12.4193 - val_accuracy10: 0.4433 - val_accuracy20: 0.4451 - val_accuracy30: 0.4488 - val_accuracy50: 0.4441 - 42s/epoch - 21ms/step
Epoch 25/50
1972/1972 - 48s - loss: 11.7329 - accuracy10: 0.4947 - accuracy20: 0.4994 - accuracy30: 0.5015 - accuracy50: 0.4929 - val_loss: 12.3829 - val_accuracy10: 0.4493 - val_accuracy20: 0.4509 - val_accuracy30: 0.4537 - val_accuracy50: 0.4480 - 48s/epoch - 24ms/step
Epoch 26/50
1972/1972 - 44s - loss: 11.7082 - accuracy10: 0.4970 - accuracy20: 0.5007 - accuracy30: 0.5032 - accuracy50: 0.4947 - val_loss: 12.3991 - val_accuracy10: 0.4570 - val_accuracy20: 0.4533 - val_accuracy30: 0.4547 - val_accuracy50: 0.4470 - 44s/epoch - 22ms/step
Epoch 27/50
1972/1972 - 44s - loss: 11.6867 - accuracy10: 0.4998 - accuracy20: 0.5030 - accuracy30: 0.5051 - accuracy50: 0.4958 - val_loss: 12.4097 - val_accuracy10: 0.4628 - val_accuracy20: 0.4597 - val_accuracy30: 0.4598 - val_accuracy50: 0.4494 - 44s/epoch - 22ms/step
Epoch 28/50
1972/1972 - 47s - loss: 11.6607 - accuracy10: 0.5012 - accuracy20: 0.5047 - accuracy30: 0.5070 - accuracy50: 0.4980 - val_loss: 12.4011 - val_accuracy10: 0.4635 - val_accuracy20: 0.4606 - val_accuracy30: 0.4587 - val_accuracy50: 0.4491 - 47s/epoch - 24ms/step
Epoch 29/50
1972/1972 - 48s - loss: 11.6421 - accuracy10: 0.5028 - accuracy20: 0.5061 - accuracy30: 0.5083 - accuracy50: 0.4994 - val_loss: 12.4124 - val_accuracy10: 0.4706 - val_accuracy20: 0.4627 - val_accuracy30: 0.4612 - val_accuracy50: 0.4498 - 48s/epoch - 24ms/step
Epoch 30/50
1972/1972 - 49s - loss: 11.6241 - accuracy10: 0.5033 - accuracy20: 0.5076 - accuracy30: 0.5096 - accuracy50: 0.5013 - val_loss: 12.4246 - val_accuracy10: 0.4665 - val_accuracy20: 0.4602 - val_accuracy30: 0.4579 - val_accuracy50: 0.4482 - 49s/epoch - 25ms/step
Epoch 31/50
1972/1972 - 47s - loss: 11.6056 - accuracy10: 0.5044 - accuracy20: 0.5083 - accuracy30: 0.5106 - accuracy50: 0.5013 - val_loss: 12.3956 - val_accuracy10: 0.4641 - val_accuracy20: 0.4594 - val_accuracy30: 0.4581 - val_accuracy50: 0.4477 - 47s/epoch - 24ms/step
Epoch 32/50
1972/1972 - 46s - loss: 11.5823 - accuracy10: 0.5063 - accuracy20: 0.5110 - accuracy30: 0.5130 - accuracy50: 0.5032 - val_loss: 12.4188 - val_accuracy10: 0.4602 - val_accuracy20: 0.4543 - val_accuracy30: 0.4536 - val_accuracy50: 0.4450 - 46s/epoch - 23ms/step
testing model: results/ATVI/W4/deepOF_L1/seq2seq
Evaluating performance on  test set...
4274/4274 - 39s - 39s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0574999
{'0': {'precision': 0.2896513118926272, 'recall': 0.5786610606618843, 'f1-score': 0.3860590742679337, 'support': 230705}, '1': {'precision': 0.6709491125264192, 'recall': 0.2987155218399052, 'f1-score': 0.41338604538738677, 'support': 635511}, '2': {'precision': 0.3086396135045, 'recall': 0.4744146239768264, 'f1-score': 0.37397957683252353, 'support': 227845}, 'accuracy': 0.3943381584756243, 'macro avg': {'precision': 0.42308001264118217, 'recall': 0.45059706882620526, 'f1-score': 0.39114156549594803, 'support': 1094061}, 'weighted avg': {'precision': 0.5150915169262944, 'recall': 0.3943381584756243, 'f1-score': 0.39941695618669665, 'support': 1094061}}
[[133500  45307  51898]
 [255441 189837 190233]
 [ 71958  47794 108093]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0699408
{'0': {'precision': 0.35267514052686005, 'recall': 0.5885591883053659, 'f1-score': 0.4410595493292272, 'support': 297846}, '1': {'precision': 0.5629808461437775, 'recall': 0.23056900690337068, 'f1-score': 0.32715256414590443, 'support': 503667}, '2': {'precision': 0.3634029985207025, 'recall': 0.4853596674733719, 'f1-score': 0.41561950257144287, 'support': 292548}, 'accuracy': 0.3961579838784126, 'macro avg': {'precision': 0.42635299506378005, 'recall': 0.43482928756070277, 'f1-score': 0.3946105386821915, 'support': 1094061}, 'weighted avg': {'precision': 0.45236104216428125, 'recall': 0.3961579838784126, 'f1-score': 0.381818223383759, 'support': 1094061}}
[[175300  43629  78917]
 [217719 116130 169818]
 [104039  46518 141991]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0695341
{'0': {'precision': 0.3932477326368383, 'recall': 0.5686574303682683, 'f1-score': 0.4649590286859186, 'support': 340757}, '1': {'precision': 0.4798858744212493, 'recall': 0.22551024059737812, 'f1-score': 0.30683236466977526, 'support': 419165}, '2': {'precision': 0.3950837430626317, 'recall': 0.4780794818922664, 'f1-score': 0.4326371651696546, 'support': 334139}, 'accuracy': 0.40952469743460373, 'macro avg': {'precision': 0.4227391167069065, 'recall': 0.42408238428597095, 'f1-score': 0.40147618617511616, 'support': 1094061}, 'weighted avg': {'precision': 0.427001937739412, 'recall': 0.40952469743460373, 'f1-score': 0.3945048599733992, 'support': 1094061}}
[[193774  49707  97276]
 [177328  94526 147311]
 [121651  52743 159745]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.069471
{'0': {'precision': 0.4369762281959603, 'recall': 0.5310089611598526, 'f1-score': 0.4794252960426128, 'support': 394257}, '1': {'precision': 0.36052027394175556, 'recall': 0.235258414978134, 'f1-score': 0.28472125570246654, 'support': 313043}, '2': {'precision': 0.4298139459004059, 'recall': 0.4564033085031841, 'f1-score': 0.44270974408362673, 'support': 386761}, 'accuracy': 0.4200122296654391, 'macro avg': {'precision': 0.40910348267937396, 'recall': 0.40755689488039026, 'f1-score': 0.40228543194290206, 'support': 1094061}, 'weighted avg': {'precision': 0.41256799798712374, 'recall': 0.4200122296654391, 'f1-score': 0.4107354510601029, 'support': 1094061}}
[[209354  63336 121567]
 [126796  73646 112601]
 [142947  67295 176519]]
Evaluating performance on  train set...
1972/1972 - 18s - 18s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9974286
{'0': {'precision': 0.2802131682998109, 'recall': 0.5818680116534817, 'f1-score': 0.3782638639358007, 'support': 86841}, '1': {'precision': 0.788375884498378, 'recall': 0.4252673825073362, 'f1-score': 0.5525026306283668, 'support': 330893}, '2': {'precision': 0.30144279255483364, 'recall': 0.5059475144801538, 'f1-score': 0.3777955477596925, 'support': 86843}, 'accuracy': 0.46610527233702687, 'macro avg': {'precision': 0.4566772817843409, 'recall': 0.5043609695469905, 'f1-score': 0.4361873474412867, 'support': 504577}, 'weighted avg': {'precision': 0.6171114611476249, 'recall': 0.46610527233702687, 'f1-score': 0.49244607645345706, 'support': 504577}}
[[ 50530  18012  18299]
 [106653 140718  83522]
 [ 23144  19761  43938]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0151591
{'0': {'precision': 0.33900901090572233, 'recall': 0.5705768753764927, 'f1-score': 0.4253159708923784, 'support': 112884}, '1': {'precision': 0.7117537804942304, 'recall': 0.38790139055399614, 'f1-score': 0.5021397406290512, 'support': 278594}, '2': {'precision': 0.3584327170620511, 'recall': 0.5157958956312612, 'f1-score': 0.42295143772747706, 'support': 113099}, 'accuracy': 0.4574366251335277, 'macro avg': {'precision': 0.4697318361540013, 'recall': 0.49142472052058334, 'f1-score': 0.45013571641630223, 'support': 504577}, 'weighted avg': {'precision': 0.5491677341160855, 'recall': 0.4574366251335277, 'f1-score': 0.46720296726677013, 'support': 504577}}
[[ 64409  21106  27369]
 [ 93479 108067  77048]
 [ 32104  22659  58336]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.026332
{'0': {'precision': 0.37832559886263045, 'recall': 0.5399168510592685, 'f1-score': 0.44490290343339517, 'support': 130609}, '1': {'precision': 0.6411039239894788, 'recall': 0.39315855961879526, 'f1-score': 0.48741107662013367, 'support': 243019}, '2': {'precision': 0.39054093999408807, 'recall': 0.5044712063475093, 'f1-score': 0.44025471594373855, 'support': 130949}, 'accuracy': 0.46003484106489195, 'macro avg': {'precision': 0.46999015428206575, 'recall': 0.47918220567519104, 'f1-score': 0.4575228986657558, 'support': 504577}, 'weighted avg': {'precision': 0.5080574584198929, 'recall': 0.46003484106489195, 'f1-score': 0.4641697709998617, 'support': 504577}}
[[70518 25869 34222]
 [78606 95545 68868]
 [37271 27618 66060]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0412694
{'0': {'precision': 0.42234949683854306, 'recall': 0.49111372873896497, 'f1-score': 0.4541433752678261, 'support': 154508}, '1': {'precision': 0.5245104161873271, 'recall': 0.4099934226753268, 'f1-score': 0.46023528597426794, 'support': 194608}, '2': {'precision': 0.42653101380834985, 'recall': 0.4740867484449476, 'f1-score': 0.4490533274436033, 'support': 155461}, 'accuracy': 0.4545807676529053, 'macro avg': {'precision': 0.45779697561140664, 'recall': 0.45839796661974647, 'f1-score': 0.4544773295618991, 'support': 504577}, 'weighted avg': {'precision': 0.46303980773712006, 'recall': 0.4545807676529053, 'f1-score': 0.45492468443165585, 'support': 504577}}
[[75881 35021 43606]
 [59334 79788 55486]
 [44449 37310 73702]]
Evaluating performance on  val set...
707/707 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.99963367
{'0': {'precision': 0.28845132881546487, 'recall': 0.5763087290197791, 'f1-score': 0.384469696969697, 'support': 32054}, '1': {'precision': 0.7731926776295377, 'recall': 0.4242243690683917, 'f1-score': 0.5478578691362774, 'support': 117485}, '2': {'precision': 0.29686901936767973, 'recall': 0.49694057344225534, 'f1-score': 0.3716918063426264, 'support': 31215}, 'accuracy': 0.4637518395166912, 'macro avg': {'precision': 0.4528376752708941, 'recall': 0.4991578905101421, 'f1-score': 0.43467312414953363, 'support': 180754}, 'weighted avg': {'precision': 0.6049732070367421, 'recall': 0.4637518395166912, 'f1-score': 0.4884607430935266, 'support': 180754}}
[[18473  7073  6508]
 [37413 49840 30232]
 [ 8156  7547 15512]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0171846
{'0': {'precision': 0.3519908276005837, 'recall': 0.5619636277190063, 'f1-score': 0.4328575483185776, 'support': 42065}, '1': {'precision': 0.6891990920302419, 'recall': 0.3956170230229409, 'f1-score': 0.5026822320864051, 'support': 97468}, '2': {'precision': 0.3555432199420612, 'recall': 0.49722228960966497, 'f1-score': 0.41461342395921835, 'support': 41221}, 'accuracy': 0.4575002489571462, 'macro avg': {'precision': 0.46557771319096225, 'recall': 0.48493431345053734, 'f1-score': 0.45005106812140033, 'support': 180754}, 'weighted avg': {'precision': 0.5346338024843371, 'recall': 0.4575002489571462, 'f1-score': 0.46634854285958616, 'support': 180754}}
[[23639  8392 10034]
 [31791 38560 27117]
 [11728  8997 20496]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0297465
{'0': {'precision': 0.390531644799854, 'recall': 0.525908486027229, 'f1-score': 0.44822110938563275, 'support': 48845}, '1': {'precision': 0.6114223943788848, 'recall': 0.40445005899247993, 'f1-score': 0.48685210954423513, 'support': 83909}, '2': {'precision': 0.3889561474307237, 'recall': 0.48191666666666666, 'f1-score': 0.43047491439630786, 'support': 48000}, 'accuracy': 0.45784325658076724, 'macro avg': {'precision': 0.4636367288698209, 'recall': 0.4707584038954586, 'f1-score': 0.4551827111087252, 'support': 180754}, 'weighted avg': {'precision': 0.49265440851578074, 'recall': 0.45784325658076724, 'f1-score': 0.4614416811728163, 'support': 180754}}
[[25688 10456 12701]
 [26333 33937 23639]
 [13756 11112 23132]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0474557
{'0': {'precision': 0.43264260989141257, 'recall': 0.4718008825151682, 'f1-score': 0.4513740590189887, 'support': 58016}, '1': {'precision': 0.4899261779094847, 'recall': 0.42451038485497666, 'f1-score': 0.45487846572130963, 'support': 65817}, '2': {'precision': 0.4273379867015118, 'recall': 0.45389223660863304, 'f1-score': 0.44021502994573136, 'support': 56921}, 'accuracy': 0.4489416555096983, 'macro avg': {'precision': 0.44996892483413636, 'recall': 0.4500678346595926, 'f1-score': 0.4488225182286765, 'support': 180754}, 'weighted avg': {'precision': 0.4518305013884368, 'recall': 0.4489416555096983, 'f1-score': 0.44913602523853446, 'support': 180754}}
[[27372 14253 16391]
 [19646 27940 18231]
 [16249 14836 25836]]
training model: results/ATVI/W4/deepLOB_L2/seq2seq
Epoch 1/50
1972/1972 - 100s - loss: 12.0309 - accuracy10: 0.4496 - accuracy20: 0.4699 - accuracy30: 0.4759 - accuracy50: 0.4727 - val_loss: 13.0220 - val_accuracy10: 0.3227 - val_accuracy20: 0.3567 - val_accuracy30: 0.3743 - val_accuracy50: 0.3909 - 100s/epoch - 51ms/step
Epoch 2/50
1972/1972 - 93s - loss: 11.6082 - accuracy10: 0.4847 - accuracy20: 0.5036 - accuracy30: 0.5090 - accuracy50: 0.5003 - val_loss: 12.3224 - val_accuracy10: 0.4476 - val_accuracy20: 0.4597 - val_accuracy30: 0.4614 - val_accuracy50: 0.4521 - 93s/epoch - 47ms/step
Epoch 3/50
1972/1972 - 94s - loss: 11.1026 - accuracy10: 0.5466 - accuracy20: 0.5505 - accuracy30: 0.5457 - accuracy50: 0.5244 - val_loss: 11.7412 - val_accuracy10: 0.5496 - val_accuracy20: 0.5363 - val_accuracy30: 0.5200 - val_accuracy50: 0.4885 - 94s/epoch - 48ms/step
Epoch 4/50
1972/1972 - 94s - loss: 10.8058 - accuracy10: 0.5778 - accuracy20: 0.5742 - accuracy30: 0.5624 - accuracy50: 0.5360 - val_loss: 11.6137 - val_accuracy10: 0.6024 - val_accuracy20: 0.5746 - val_accuracy30: 0.5467 - val_accuracy50: 0.5010 - 94s/epoch - 48ms/step
Epoch 5/50
1972/1972 - 93s - loss: 10.6286 - accuracy10: 0.5886 - accuracy20: 0.5857 - accuracy30: 0.5715 - accuracy50: 0.5419 - val_loss: 11.3884 - val_accuracy10: 0.5939 - val_accuracy20: 0.5746 - val_accuracy30: 0.5508 - val_accuracy50: 0.5098 - 93s/epoch - 47ms/step
Epoch 6/50
1972/1972 - 93s - loss: 10.5013 - accuracy10: 0.5972 - accuracy20: 0.5943 - accuracy30: 0.5790 - accuracy50: 0.5465 - val_loss: 11.3085 - val_accuracy10: 0.5973 - val_accuracy20: 0.5793 - val_accuracy30: 0.5549 - val_accuracy50: 0.5135 - 93s/epoch - 47ms/step
Epoch 7/50
1972/1972 - 93s - loss: 10.4261 - accuracy10: 0.6016 - accuracy20: 0.5988 - accuracy30: 0.5834 - accuracy50: 0.5497 - val_loss: 11.3010 - val_accuracy10: 0.6058 - val_accuracy20: 0.5872 - val_accuracy30: 0.5624 - val_accuracy50: 0.5160 - 93s/epoch - 47ms/step
Epoch 8/50
1972/1972 - 93s - loss: 10.3807 - accuracy10: 0.6034 - accuracy20: 0.6000 - accuracy30: 0.5846 - accuracy50: 0.5513 - val_loss: 11.2558 - val_accuracy10: 0.5974 - val_accuracy20: 0.5837 - val_accuracy30: 0.5609 - val_accuracy50: 0.5169 - 93s/epoch - 47ms/step
Epoch 9/50
1972/1972 - 93s - loss: 10.3467 - accuracy10: 0.6062 - accuracy20: 0.6014 - accuracy30: 0.5858 - accuracy50: 0.5522 - val_loss: 11.1515 - val_accuracy10: 0.5940 - val_accuracy20: 0.5824 - val_accuracy30: 0.5611 - val_accuracy50: 0.5196 - 93s/epoch - 47ms/step
Epoch 10/50
1972/1972 - 92s - loss: 10.2976 - accuracy10: 0.6087 - accuracy20: 0.6035 - accuracy30: 0.5878 - accuracy50: 0.5540 - val_loss: 11.0999 - val_accuracy10: 0.5994 - val_accuracy20: 0.5872 - val_accuracy30: 0.5651 - val_accuracy50: 0.5212 - 92s/epoch - 47ms/step
Epoch 11/50
1972/1972 - 95s - loss: 10.2666 - accuracy10: 0.6103 - accuracy20: 0.6048 - accuracy30: 0.5889 - accuracy50: 0.5555 - val_loss: 11.1606 - val_accuracy10: 0.5953 - val_accuracy20: 0.5835 - val_accuracy30: 0.5636 - val_accuracy50: 0.5210 - 95s/epoch - 48ms/step
Epoch 12/50
1972/1972 - 95s - loss: 10.2327 - accuracy10: 0.6127 - accuracy20: 0.6067 - accuracy30: 0.5904 - accuracy50: 0.5567 - val_loss: 11.2584 - val_accuracy10: 0.5734 - val_accuracy20: 0.5690 - val_accuracy30: 0.5532 - val_accuracy50: 0.5164 - 95s/epoch - 48ms/step
Epoch 13/50
1972/1972 - 95s - loss: 10.1994 - accuracy10: 0.6138 - accuracy20: 0.6073 - accuracy30: 0.5914 - accuracy50: 0.5577 - val_loss: 11.2314 - val_accuracy10: 0.5783 - val_accuracy20: 0.5725 - val_accuracy30: 0.5554 - val_accuracy50: 0.5182 - 95s/epoch - 48ms/step
Epoch 14/50
1972/1972 - 94s - loss: 10.1791 - accuracy10: 0.6155 - accuracy20: 0.6090 - accuracy30: 0.5926 - accuracy50: 0.5589 - val_loss: 11.2447 - val_accuracy10: 0.5797 - val_accuracy20: 0.5731 - val_accuracy30: 0.5561 - val_accuracy50: 0.5182 - 94s/epoch - 48ms/step
Epoch 15/50
1972/1972 - 94s - loss: 10.1536 - accuracy10: 0.6167 - accuracy20: 0.6098 - accuracy30: 0.5937 - accuracy50: 0.5597 - val_loss: 11.2737 - val_accuracy10: 0.5741 - val_accuracy20: 0.5694 - val_accuracy30: 0.5529 - val_accuracy50: 0.5173 - 94s/epoch - 48ms/step
Epoch 16/50
1972/1972 - 93s - loss: 10.1310 - accuracy10: 0.6176 - accuracy20: 0.6110 - accuracy30: 0.5947 - accuracy50: 0.5607 - val_loss: 11.2735 - val_accuracy10: 0.5732 - val_accuracy20: 0.5681 - val_accuracy30: 0.5527 - val_accuracy50: 0.5167 - 93s/epoch - 47ms/step
Epoch 17/50
1972/1972 - 93s - loss: 10.1042 - accuracy10: 0.6193 - accuracy20: 0.6119 - accuracy30: 0.5958 - accuracy50: 0.5620 - val_loss: 11.2129 - val_accuracy10: 0.5709 - val_accuracy20: 0.5679 - val_accuracy30: 0.5526 - val_accuracy50: 0.5191 - 93s/epoch - 47ms/step
Epoch 18/50
1972/1972 - 94s - loss: 10.0857 - accuracy10: 0.6196 - accuracy20: 0.6123 - accuracy30: 0.5960 - accuracy50: 0.5622 - val_loss: 11.2134 - val_accuracy10: 0.5777 - val_accuracy20: 0.5735 - val_accuracy30: 0.5565 - val_accuracy50: 0.5201 - 94s/epoch - 48ms/step
Epoch 19/50
1972/1972 - 94s - loss: 10.0656 - accuracy10: 0.6207 - accuracy20: 0.6132 - accuracy30: 0.5972 - accuracy50: 0.5633 - val_loss: 11.2247 - val_accuracy10: 0.5829 - val_accuracy20: 0.5760 - val_accuracy30: 0.5575 - val_accuracy50: 0.5201 - 94s/epoch - 48ms/step
Epoch 20/50
1972/1972 - 94s - loss: 10.0423 - accuracy10: 0.6212 - accuracy20: 0.6140 - accuracy30: 0.5978 - accuracy50: 0.5643 - val_loss: 11.2845 - val_accuracy10: 0.5725 - val_accuracy20: 0.5692 - val_accuracy30: 0.5542 - val_accuracy50: 0.5195 - 94s/epoch - 48ms/step
testing model: results/ATVI/W4/deepLOB_L2/seq2seq
Evaluating performance on  test set...
4274/4274 - 70s - 70s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.4611884
{'0': {'precision': 0.25464916446347, 'recall': 0.8111882655847702, 'f1-score': 0.38761711351117356, 'support': 230706}, '1': {'precision': 0.8555565138643322, 'recall': 0.062436075365766924, 'f1-score': 0.1163791333524957, 'support': 635514}, '2': {'precision': 0.37617098826613804, 'recall': 0.5163817507516074, 'f1-score': 0.4352635424470279, 'support': 227845}, 'accuracy': 0.3148624624679521, 'macro avg': {'precision': 0.4954588888646468, 'recall': 0.4633353639007149, 'f1-score': 0.31308659643689907, 'support': 1094065}, 'weighted avg': {'precision': 0.6290082502503824, 'recall': 0.3148624624679521, 'f1-score': 0.23998462995519446, 'support': 1094065}}
[[187146   2188  41372]
 [442092  39679 153743]
 [105679   4511 117655]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.3933171
{'0': {'precision': 0.3191425747564044, 'recall': 0.8206748363270102, 'f1-score': 0.4595688357738648, 'support': 297850}, '1': {'precision': 0.7688752768738549, 'recall': 0.05582458251185803, 'f1-score': 0.10409154517655247, 'support': 503667}, '2': {'precision': 0.4479739346651805, 'recall': 0.4464839957887253, 'f1-score': 0.44722772429779345, 'support': 292548}, 'accuracy': 0.36850918364082574, 'macro avg': {'precision': 0.51199726209848, 'recall': 0.4409944715425312, 'f1-score': 0.3369627017494035, 'support': 1094065}, 'weighted avg': {'precision': 0.5606317710619096, 'recall': 0.36850918364082574, 'f1-score': 0.2926203016343226, 'support': 1094065}}
[[244438   3079  50333]
 [364926  28117 110624]
 [156557   5373 130618]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.3202648
{'0': {'precision': 0.3589946800757907, 'recall': 0.809549801767221, 'f1-score': 0.49741208247798174, 'support': 340761}, '1': {'precision': 0.6987207914037182, 'recall': 0.04886619827514225, 'f1-score': 0.09134409561184445, 'support': 419165}, '2': {'precision': 0.47744990179469354, 'recall': 0.42340762377333985, 'f1-score': 0.44880776960205065, 'support': 334139}, 'accuracy': 0.4001800624277351, 'macro avg': {'precision': 0.5117217910914008, 'recall': 0.42727454127190106, 'f1-score': 0.3458546492306256, 'support': 1094065}, 'weighted avg': {'precision': 0.525330139837965, 'recall': 0.4001800624277351, 'f1-score': 0.3269925148884919, 'support': 1094065}}
[[275863   3506  61392]
 [305233  20483  93449]
 [187336   5326 141477]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1978668
{'0': {'precision': 0.40449687434352083, 'recall': 0.7862983817785217, 'f1-score': 0.5341896284783042, 'support': 394260}, '1': {'precision': 0.5771678599840891, 'recall': 0.04171618047303254, 'f1-score': 0.07780856198051657, 'support': 313044}, '2': {'precision': 0.49886900078678204, 'recall': 0.3934600437996592, 'f1-score': 0.43993865287850115, 'support': 386761}, 'accuracy': 0.43438004140521813, 'macro avg': {'precision': 0.49351124503813065, 'recall': 0.40715820201707115, 'f1-score': 0.35064561444577397, 'support': 1094065}, 'weighted avg': {'precision': 0.48726441925555825, 'recall': 0.43438004140521813, 'f1-score': 0.3702871581911742, 'support': 1094065}}
[[310006   4091  80163]
 [227283  13059  72702]
 [229110   5476 152175]]
Evaluating performance on  train set...
1972/1972 - 32s - 32s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.89296603
{'0': {'precision': 0.34167016269460426, 'recall': 0.684595366404127, 'f1-score': 0.45583877385940635, 'support': 86844}, '1': {'precision': 0.8623409753044002, 'recall': 0.5537358180356506, 'f1-score': 0.6744112856472407, 'support': 330878}, '2': {'precision': 0.41689668602780555, 'recall': 0.5668792742176887, 'f1-score': 0.48045510431100097, 'support': 86858}, 'accuracy': 0.5785207499306354, 'macro avg': {'precision': 0.5403026080089367, 'recall': 0.6017368195524888, 'f1-score': 0.5369017212725494, 'support': 504580}, 'weighted avg': {'precision': 0.6960491362931996, 'recall': 0.5785207499306354, 'f1-score': 0.6034049889010245, 'support': 504580}}
[[ 59453  12677  14714]
 [ 93505 183219  54154]
 [ 21049  16571  49238]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.90609187
{'0': {'precision': 0.40906731558120457, 'recall': 0.6488805078218374, 'f1-score': 0.50179375881475, 'support': 112953}, '1': {'precision': 0.779017824663514, 'recall': 0.5766322727958124, 'f1-score': 0.662717938243868, 'support': 278538}, '2': {'precision': 0.4865223006860459, 'recall': 0.5129588200443899, 'f1-score': 0.4993909341735429, 'support': 113089}, 'accuracy': 0.5785346228546514, 'macro avg': {'precision': 0.5582024803102549, 'recall': 0.5794905335540133, 'f1-score': 0.5546342104107204, 'support': 504580}, 'weighted avg': {'precision': 0.6306468108233658, 'recall': 0.5785346228546514, 'f1-score': 0.5900885109927558, 'support': 504580}}
[[ 73293  20532  19128]
 [ 75828 160614  42096]
 [ 30050  25029  58010]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9270346
{'0': {'precision': 0.4406853865560475, 'recall': 0.6163065690078755, 'f1-score': 0.513906084470369, 'support': 130659}, '1': {'precision': 0.7079111040290013, 'recall': 0.5850047323155426, 'f1-score': 0.6406160931349687, 'support': 243010}, '2': {'precision': 0.5144011501090621, 'recall': 0.4755826477530536, 'f1-score': 0.4942308379276265, 'support': 130911}, 'accuracy': 0.5647211542272781, 'macro avg': {'precision': 0.554332546898037, 'recall': 0.5589646496921573, 'f1-score': 0.5495843385109881, 'support': 504580}, 'weighted avg': {'precision': 0.5885087761584715, 'recall': 0.5647211542272781, 'f1-score': 0.5698260436550918, 'support': 504580}}
[[ 80526  27037  23096]
 [ 65171 142162  35677]
 [ 37032  31620  62259]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9607348
{'0': {'precision': 0.4681358453932964, 'recall': 0.5742298731555786, 'f1-score': 0.5157836301332039, 'support': 154520}, '1': {'precision': 0.590696827873115, 'recall': 0.5840244322534538, 'f1-score': 0.5873416805197559, 'support': 194497}, '2': {'precision': 0.5359659771388534, 'recall': 0.4228833334404711, 'f1-score': 0.47275641025641024, 'support': 155563}, 'accuracy': 0.531344880891038, 'macro avg': {'precision': 0.5315995501350882, 'recall': 0.5270458796165012, 'f1-score': 0.52529390696979, 'support': 504580}, 'weighted avg': {'precision': 0.5362907508475581, 'recall': 0.531344880891038, 'f1-score': 0.5301012462106139, 'support': 504580}}
[[ 88730  36842  28948]
 [ 52898 113591  28008]
 [ 47911  41867  65785]]
Evaluating performance on  val set...
707/707 - 12s - 12s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8503041
{'0': {'precision': 0.39025830539469675, 'recall': 0.6389807248456116, 'f1-score': 0.4845668062158518, 'support': 32062}, '1': {'precision': 0.8364563751960632, 'recall': 0.5950393512997854, 'f1-score': 0.6953907715891162, 'support': 117404}, '2': {'precision': 0.4054404434609625, 'recall': 0.5797430324725135, 'f1-score': 0.4771725834243098, 'support': 31288}, 'accuracy': 0.6001858880024785, 'macro avg': {'precision': 0.5440517080172408, 'recall': 0.6045877028726369, 'f1-score': 0.5523767204097593, 'support': 180754}, 'weighted avg': {'precision': 0.6827024943076777, 'recall': 0.6001858880024785, 'f1-score': 0.6202220414415229, 'support': 180754}}
[[20487  6582  4993]
 [25937 69860 21607]
 [ 6072  7077 18139]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.88279134
{'0': {'precision': 0.4568215809006813, 'recall': 0.5875187005770464, 'f1-score': 0.5139918977874728, 'support': 42111}, '1': {'precision': 0.7399049881235155, 'recall': 0.6138498013979123, 'f1-score': 0.671008565995187, 'support': 97431}, '2': {'precision': 0.4726744313091362, 'recall': 0.5248713966805785, 'f1-score': 0.49740730094854846, 'support': 41212}, 'accuracy': 0.5874282173561858, 'macro avg': {'precision': 0.556467000111111, 'recall': 0.5754132995518457, 'f1-score': 0.5608025882437361, 'support': 180754}, 'weighted avg': {'precision': 0.6130251897843642, 'recall': 0.5874282173561858, 'f1-score': 0.5948465764956622, 'support': 180754}}
[[24741 10255  7115]
 [20606 59808 17017]
 [ 8812 10769 21631]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9157857
{'0': {'precision': 0.48431291465146803, 'recall': 0.5505324040957306, 'f1-score': 0.5153039752075601, 'support': 48929}, '1': {'precision': 0.6603451134436098, 'recall': 0.6178197265112283, 'f1-score': 0.6383749961470888, 'support': 83806}, '2': {'precision': 0.5032316055301117, 'recall': 0.48968116787105104, 'f1-score': 0.4963639242176368, 'support': 48019}, 'accuracy': 0.5655642475408567, 'macro avg': {'precision': 0.5492965445417298, 'recall': 0.5526777661593366, 'f1-score': 0.5500142985240952, 'support': 180754}, 'weighted avg': {'precision': 0.5709555951413926, 'recall': 0.5655642475408567, 'f1-score': 0.567333848252544, 'support': 180754}}
[[26937 13082  8910]
 [17727 51777 14302]
 [10955 13550 23514]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.96683097
{'0': {'precision': 0.5010982976386601, 'recall': 0.5029713202997158, 'f1-score': 0.5020330619718552, 'support': 58055}, '1': {'precision': 0.5363835353157866, 'recall': 0.6108619982063871, 'f1-score': 0.5712052191339818, 'support': 65789}, '2': {'precision': 0.5226670591698558, 'recall': 0.43677736777367776, 'f1-score': 0.47587778075582954, 'support': 56910}, 'accuracy': 0.5213992498091329, 'macro avg': {'precision': 0.520049630708101, 'recall': 0.5168702287599268, 'f1-score': 0.5163720206205555, 'support': 180754}, 'weighted avg': {'precision': 0.5207319362872146, 'recall': 0.5213992498091329, 'f1-score': 0.5189747063810253, 'support': 180754}}
[[29200 17139 11716]
 [14616 40188 10985]
 [14456 17597 24857]]
training model: results/ATVI/W4/deepOF_L2/seq2seq
Epoch 1/50
1972/1972 - 67s - loss: 11.4111 - accuracy10: 0.5423 - accuracy20: 0.5439 - accuracy30: 0.5341 - accuracy50: 0.5087 - val_loss: 12.0292 - val_accuracy10: 0.6157 - val_accuracy20: 0.5790 - val_accuracy30: 0.5416 - val_accuracy50: 0.4784 - 67s/epoch - 34ms/step
Epoch 2/50
1972/1972 - 61s - loss: 10.7298 - accuracy10: 0.5904 - accuracy20: 0.5831 - accuracy30: 0.5690 - accuracy50: 0.5374 - val_loss: 11.9421 - val_accuracy10: 0.6780 - val_accuracy20: 0.6270 - val_accuracy30: 0.5782 - val_accuracy50: 0.4968 - 61s/epoch - 31ms/step
Epoch 3/50
1972/1972 - 59s - loss: 10.5861 - accuracy10: 0.5996 - accuracy20: 0.5900 - accuracy30: 0.5749 - accuracy50: 0.5424 - val_loss: 11.8046 - val_accuracy10: 0.6729 - val_accuracy20: 0.6259 - val_accuracy30: 0.5812 - val_accuracy50: 0.5048 - 59s/epoch - 30ms/step
Epoch 4/50
1972/1972 - 58s - loss: 10.5045 - accuracy10: 0.6028 - accuracy20: 0.5933 - accuracy30: 0.5785 - accuracy50: 0.5462 - val_loss: 11.7630 - val_accuracy10: 0.6572 - val_accuracy20: 0.6160 - val_accuracy30: 0.5765 - val_accuracy50: 0.5068 - 58s/epoch - 30ms/step
Epoch 5/50
1972/1972 - 58s - loss: 10.4502 - accuracy10: 0.6046 - accuracy20: 0.5959 - accuracy30: 0.5804 - accuracy50: 0.5473 - val_loss: 11.6937 - val_accuracy10: 0.6637 - val_accuracy20: 0.6230 - val_accuracy30: 0.5815 - val_accuracy50: 0.5099 - 58s/epoch - 30ms/step
Epoch 6/50
1972/1972 - 61s - loss: 10.4070 - accuracy10: 0.6064 - accuracy20: 0.5981 - accuracy30: 0.5826 - accuracy50: 0.5490 - val_loss: 11.6654 - val_accuracy10: 0.6583 - val_accuracy20: 0.6209 - val_accuracy30: 0.5818 - val_accuracy50: 0.5129 - 61s/epoch - 31ms/step
Epoch 7/50
1972/1972 - 59s - loss: 10.3698 - accuracy10: 0.6075 - accuracy20: 0.5996 - accuracy30: 0.5840 - accuracy50: 0.5509 - val_loss: 11.6602 - val_accuracy10: 0.6550 - val_accuracy20: 0.6191 - val_accuracy30: 0.5812 - val_accuracy50: 0.5138 - 59s/epoch - 30ms/step
Epoch 8/50
1972/1972 - 60s - loss: 10.3376 - accuracy10: 0.6090 - accuracy20: 0.6011 - accuracy30: 0.5856 - accuracy50: 0.5521 - val_loss: 11.7247 - val_accuracy10: 0.6591 - val_accuracy20: 0.6213 - val_accuracy30: 0.5814 - val_accuracy50: 0.5133 - 60s/epoch - 31ms/step
Epoch 9/50
1972/1972 - 61s - loss: 10.3088 - accuracy10: 0.6104 - accuracy20: 0.6027 - accuracy30: 0.5868 - accuracy50: 0.5536 - val_loss: 11.5760 - val_accuracy10: 0.6600 - val_accuracy20: 0.6238 - val_accuracy30: 0.5848 - val_accuracy50: 0.5144 - 61s/epoch - 31ms/step
Epoch 10/50
1972/1972 - 61s - loss: 10.2804 - accuracy10: 0.6111 - accuracy20: 0.6033 - accuracy30: 0.5873 - accuracy50: 0.5540 - val_loss: 11.5141 - val_accuracy10: 0.6590 - val_accuracy20: 0.6232 - val_accuracy30: 0.5843 - val_accuracy50: 0.5146 - 61s/epoch - 31ms/step
Epoch 11/50
1972/1972 - 57s - loss: 10.2566 - accuracy10: 0.6122 - accuracy20: 0.6049 - accuracy30: 0.5885 - accuracy50: 0.5550 - val_loss: 11.4669 - val_accuracy10: 0.6562 - val_accuracy20: 0.6210 - val_accuracy30: 0.5833 - val_accuracy50: 0.5151 - 57s/epoch - 29ms/step
Epoch 12/50
1972/1972 - 60s - loss: 10.2319 - accuracy10: 0.6124 - accuracy20: 0.6058 - accuracy30: 0.5892 - accuracy50: 0.5559 - val_loss: 11.5122 - val_accuracy10: 0.6550 - val_accuracy20: 0.6200 - val_accuracy30: 0.5811 - val_accuracy50: 0.5139 - 60s/epoch - 31ms/step
Epoch 13/50
1972/1972 - 58s - loss: 10.2124 - accuracy10: 0.6135 - accuracy20: 0.6062 - accuracy30: 0.5898 - accuracy50: 0.5567 - val_loss: 11.3951 - val_accuracy10: 0.6495 - val_accuracy20: 0.6171 - val_accuracy30: 0.5802 - val_accuracy50: 0.5173 - 58s/epoch - 30ms/step
Epoch 14/50
1972/1972 - 58s - loss: 10.1933 - accuracy10: 0.6133 - accuracy20: 0.6066 - accuracy30: 0.5901 - accuracy50: 0.5574 - val_loss: 11.4299 - val_accuracy10: 0.6473 - val_accuracy20: 0.6156 - val_accuracy30: 0.5797 - val_accuracy50: 0.5181 - 58s/epoch - 29ms/step
Epoch 15/50
1972/1972 - 57s - loss: 10.1870 - accuracy10: 0.6145 - accuracy20: 0.6076 - accuracy30: 0.5908 - accuracy50: 0.5581 - val_loss: 11.4148 - val_accuracy10: 0.6557 - val_accuracy20: 0.6212 - val_accuracy30: 0.5829 - val_accuracy50: 0.5180 - 57s/epoch - 29ms/step
Epoch 16/50
1972/1972 - 59s - loss: 10.1552 - accuracy10: 0.6155 - accuracy20: 0.6085 - accuracy30: 0.5915 - accuracy50: 0.5591 - val_loss: 11.3961 - val_accuracy10: 0.6498 - val_accuracy20: 0.6165 - val_accuracy30: 0.5804 - val_accuracy50: 0.5182 - 59s/epoch - 30ms/step
Epoch 17/50
1972/1972 - 58s - loss: 10.1361 - accuracy10: 0.6155 - accuracy20: 0.6092 - accuracy30: 0.5925 - accuracy50: 0.5600 - val_loss: 11.3492 - val_accuracy10: 0.6459 - val_accuracy20: 0.6145 - val_accuracy30: 0.5794 - val_accuracy50: 0.5194 - 58s/epoch - 29ms/step
Epoch 18/50
1972/1972 - 60s - loss: 10.1164 - accuracy10: 0.6160 - accuracy20: 0.6096 - accuracy30: 0.5931 - accuracy50: 0.5607 - val_loss: 11.3433 - val_accuracy10: 0.6462 - val_accuracy20: 0.6146 - val_accuracy30: 0.5794 - val_accuracy50: 0.5202 - 60s/epoch - 30ms/step
Epoch 19/50
1972/1972 - 59s - loss: 10.0992 - accuracy10: 0.6166 - accuracy20: 0.6107 - accuracy30: 0.5942 - accuracy50: 0.5620 - val_loss: 11.2984 - val_accuracy10: 0.6465 - val_accuracy20: 0.6156 - val_accuracy30: 0.5800 - val_accuracy50: 0.5193 - 59s/epoch - 30ms/step
Epoch 20/50
1972/1972 - 58s - loss: 10.0879 - accuracy10: 0.6178 - accuracy20: 0.6111 - accuracy30: 0.5947 - accuracy50: 0.5627 - val_loss: 11.3483 - val_accuracy10: 0.6477 - val_accuracy20: 0.6163 - val_accuracy30: 0.5799 - val_accuracy50: 0.5201 - 58s/epoch - 30ms/step
Epoch 21/50
1972/1972 - 60s - loss: 10.0640 - accuracy10: 0.6178 - accuracy20: 0.6116 - accuracy30: 0.5954 - accuracy50: 0.5637 - val_loss: 11.3215 - val_accuracy10: 0.6402 - val_accuracy20: 0.6103 - val_accuracy30: 0.5763 - val_accuracy50: 0.5197 - 60s/epoch - 31ms/step
Epoch 22/50
1972/1972 - 61s - loss: 10.0524 - accuracy10: 0.6179 - accuracy20: 0.6119 - accuracy30: 0.5956 - accuracy50: 0.5640 - val_loss: 11.3017 - val_accuracy10: 0.6426 - val_accuracy20: 0.6127 - val_accuracy30: 0.5784 - val_accuracy50: 0.5190 - 61s/epoch - 31ms/step
Epoch 23/50
1972/1972 - 60s - loss: 10.0339 - accuracy10: 0.6186 - accuracy20: 0.6125 - accuracy30: 0.5963 - accuracy50: 0.5646 - val_loss: 11.2579 - val_accuracy10: 0.6413 - val_accuracy20: 0.6126 - val_accuracy30: 0.5795 - val_accuracy50: 0.5210 - 60s/epoch - 30ms/step
Epoch 24/50
1972/1972 - 59s - loss: 10.0166 - accuracy10: 0.6196 - accuracy20: 0.6134 - accuracy30: 0.5976 - accuracy50: 0.5655 - val_loss: 11.3221 - val_accuracy10: 0.6400 - val_accuracy20: 0.6109 - val_accuracy30: 0.5772 - val_accuracy50: 0.5201 - 59s/epoch - 30ms/step
Epoch 25/50
1972/1972 - 63s - loss: 10.0031 - accuracy10: 0.6194 - accuracy20: 0.6135 - accuracy30: 0.5978 - accuracy50: 0.5661 - val_loss: 11.3217 - val_accuracy10: 0.6354 - val_accuracy20: 0.6077 - val_accuracy30: 0.5747 - val_accuracy50: 0.5193 - 63s/epoch - 32ms/step
Epoch 26/50
1972/1972 - 60s - loss: 9.9864 - accuracy10: 0.6200 - accuracy20: 0.6142 - accuracy30: 0.5986 - accuracy50: 0.5675 - val_loss: 11.2590 - val_accuracy10: 0.6373 - val_accuracy20: 0.6098 - val_accuracy30: 0.5773 - val_accuracy50: 0.5205 - 60s/epoch - 30ms/step
Epoch 27/50
1972/1972 - 59s - loss: 9.9701 - accuracy10: 0.6205 - accuracy20: 0.6151 - accuracy30: 0.5992 - accuracy50: 0.5678 - val_loss: 11.2071 - val_accuracy10: 0.6176 - val_accuracy20: 0.5933 - val_accuracy30: 0.5643 - val_accuracy50: 0.5173 - 59s/epoch - 30ms/step
Epoch 28/50
1972/1972 - 59s - loss: 9.9504 - accuracy10: 0.6217 - accuracy20: 0.6159 - accuracy30: 0.5999 - accuracy50: 0.5690 - val_loss: 11.2476 - val_accuracy10: 0.6175 - val_accuracy20: 0.5950 - val_accuracy30: 0.5666 - val_accuracy50: 0.5183 - 59s/epoch - 30ms/step
Epoch 29/50
1972/1972 - 59s - loss: 9.9348 - accuracy10: 0.6220 - accuracy20: 0.6165 - accuracy30: 0.6011 - accuracy50: 0.5700 - val_loss: 11.3832 - val_accuracy10: 0.6217 - val_accuracy20: 0.5958 - val_accuracy30: 0.5654 - val_accuracy50: 0.5140 - 59s/epoch - 30ms/step
Epoch 30/50
1972/1972 - 57s - loss: 9.9177 - accuracy10: 0.6220 - accuracy20: 0.6168 - accuracy30: 0.6014 - accuracy50: 0.5709 - val_loss: 11.3608 - val_accuracy10: 0.6166 - val_accuracy20: 0.5915 - val_accuracy30: 0.5618 - val_accuracy50: 0.5142 - 57s/epoch - 29ms/step
Epoch 31/50
1972/1972 - 58s - loss: 9.9019 - accuracy10: 0.6223 - accuracy20: 0.6177 - accuracy30: 0.6024 - accuracy50: 0.5716 - val_loss: 11.2769 - val_accuracy10: 0.6164 - val_accuracy20: 0.5924 - val_accuracy30: 0.5642 - val_accuracy50: 0.5150 - 58s/epoch - 30ms/step
Epoch 32/50
1972/1972 - 59s - loss: 9.8836 - accuracy10: 0.6229 - accuracy20: 0.6193 - accuracy30: 0.6038 - accuracy50: 0.5729 - val_loss: 11.2577 - val_accuracy10: 0.6125 - val_accuracy20: 0.5891 - val_accuracy30: 0.5615 - val_accuracy50: 0.5149 - 59s/epoch - 30ms/step
Epoch 33/50
1972/1972 - 61s - loss: 9.8662 - accuracy10: 0.6234 - accuracy20: 0.6187 - accuracy30: 0.6037 - accuracy50: 0.5734 - val_loss: 11.3512 - val_accuracy10: 0.5940 - val_accuracy20: 0.5746 - val_accuracy30: 0.5500 - val_accuracy50: 0.5099 - 61s/epoch - 31ms/step
Epoch 34/50
1972/1972 - 62s - loss: 9.8469 - accuracy10: 0.6242 - accuracy20: 0.6196 - accuracy30: 0.6050 - accuracy50: 0.5749 - val_loss: 11.3069 - val_accuracy10: 0.6039 - val_accuracy20: 0.5799 - val_accuracy30: 0.5519 - val_accuracy50: 0.5083 - 62s/epoch - 32ms/step
Epoch 35/50
1972/1972 - 58s - loss: 9.8315 - accuracy10: 0.6239 - accuracy20: 0.6199 - accuracy30: 0.6058 - accuracy50: 0.5761 - val_loss: 11.3413 - val_accuracy10: 0.5969 - val_accuracy20: 0.5751 - val_accuracy30: 0.5483 - val_accuracy50: 0.5083 - 58s/epoch - 30ms/step
Epoch 36/50
1972/1972 - 59s - loss: 9.8128 - accuracy10: 0.6247 - accuracy20: 0.6206 - accuracy30: 0.6062 - accuracy50: 0.5764 - val_loss: 11.2873 - val_accuracy10: 0.6013 - val_accuracy20: 0.5793 - val_accuracy30: 0.5523 - val_accuracy50: 0.5108 - 59s/epoch - 30ms/step
Epoch 37/50
1972/1972 - 59s - loss: 9.8029 - accuracy10: 0.6245 - accuracy20: 0.6209 - accuracy30: 0.6069 - accuracy50: 0.5775 - val_loss: 11.3661 - val_accuracy10: 0.5975 - val_accuracy20: 0.5746 - val_accuracy30: 0.5471 - val_accuracy50: 0.5067 - 59s/epoch - 30ms/step
testing model: results/ATVI/W4/deepOF_L2/seq2seq
Evaluating performance on  test set...
4274/4274 - 43s - 43s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1075114
{'0': {'precision': 0.3636238553873891, 'recall': 0.6644069265945688, 'f1-score': 0.47001356852103127, 'support': 230705}, '1': {'precision': 0.8127580815219343, 'recall': 0.3917886551137589, 'f1-score': 0.528712396136148, 'support': 635511}, '2': {'precision': 0.3779023087384686, 'recall': 0.6073339331563125, 'f1-score': 0.46590428925674093, 'support': 227845}, 'accuracy': 0.49416440216770363, 'macro avg': {'precision': 0.518094748549264, 'recall': 0.5545098382882134, 'f1-score': 0.4882100846379734, 'support': 1094061}, 'weighted avg': {'precision': 0.6274875845476166, 'recall': 0.49416440216770363, 'f1-score': 0.5032543767598208, 'support': 1094061}}
[[153282  26783  50640]
 [209369 248986 177156]
 [ 58889  30578 138378]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0794072
{'0': {'precision': 0.4260960093042908, 'recall': 0.6568461553957414, 'f1-score': 0.5168872995512483, 'support': 297846}, '1': {'precision': 0.7109255604848881, 'recall': 0.3805232425392174, 'f1-score': 0.4957148676697855, 'support': 503667}, '2': {'precision': 0.44838091588426904, 'recall': 0.5599320453395682, 'f1-score': 0.49798594876253655, 'support': 292548}, 'accuracy': 0.503722370142067, 'macro avg': {'precision': 0.5284674952244827, 'recall': 0.5324338144248423, 'f1-score': 0.5035293719945235, 'support': 1094061}, 'weighted avg': {'precision': 0.563180367858921, 'recall': 0.503722370142067, 'f1-score': 0.5020861069130163, 'support': 1094061}}
[[195639  36305  65902]
 [176389 191657 135621]
 [ 87115  41626 163807]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0679698
{'0': {'precision': 0.45258309907078104, 'recall': 0.6557810991410301, 'f1-score': 0.5355558085332023, 'support': 340757}, '1': {'precision': 0.6285229433685521, 'recall': 0.3516753545739745, 'f1-score': 0.4510026786028432, 'support': 419165}, '2': {'precision': 0.48167062625246393, 'recall': 0.5272805628795202, 'f1-score': 0.5034446892350247, 'support': 334139}, 'accuracy': 0.5000242216841657, 'macro avg': {'precision': 0.520925556230599, 'recall': 0.5115790055315083, 'f1-score': 0.4966677254570235, 'support': 1094061}, 'weighted avg': {'precision': 0.5288741852899549, 'recall': 0.5000242216841657, 'f1-score': 0.49335405744397354, 'support': 1094061}}
[[223462  40647  76648]
 [158809 147410 112946]
 [111477  46477 176185]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.037919
{'0': {'precision': 0.47659569680354336, 'recall': 0.6446505705669144, 'f1-score': 0.5480289153509033, 'support': 394257}, '1': {'precision': 0.4897827406238621, 'recall': 0.32226563123915886, 'f1-score': 0.3887456697070237, 'support': 313043}, '2': {'precision': 0.5112567924060337, 'recall': 0.46901833432016155, 'f1-score': 0.4892275701923894, 'support': 386761}, 'accuracy': 0.490319095553173, 'macro avg': {'precision': 0.4925450766111464, 'recall': 0.4786448453754116, 'f1-score': 0.47533405175010546, 'support': 1094061}, 'weighted avg': {'precision': 0.49262192546443045, 'recall': 0.490319095553173, 'f1-score': 0.4816664619584973, 'support': 1094061}}
[[254158  49569  90530]
 [129280 100883  82880]
 [149840  55523 181398]]
Evaluating performance on  train set...
1972/1972 - 21s - 21s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8747594
{'0': {'precision': 0.3896324780004437, 'recall': 0.6067410554922215, 'f1-score': 0.4745329196518231, 'support': 86841}, '1': {'precision': 0.8527206142538615, 'recall': 0.6044703272659138, 'f1-score': 0.7074492354815777, 'support': 330893}, '2': {'precision': 0.4014957043016337, 'recall': 0.623147519086167, 'f1-score': 0.4883476440357535, 'support': 86843}, 'accuracy': 0.6080756752685913, 'macro avg': {'precision': 0.5479495988519796, 'recall': 0.6114529672814341, 'f1-score': 0.5567765997230515, 'support': 504577}, 'weighted avg': {'precision': 0.6953595738271983, 'recall': 0.6080756752685913, 'f1-score': 0.6296531304492409, 'support': 504577}}
[[ 52690  17711  16440]
 [ 66648 200015  64230]
 [ 15892  16835  54116]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.89189166
{'0': {'precision': 0.44761393021459517, 'recall': 0.5903671025123135, 'f1-score': 0.5091741191661351, 'support': 112884}, '1': {'precision': 0.7715789811575129, 'recall': 0.6039577306043921, 'f1-score': 0.6775552938097108, 'support': 278594}, '2': {'precision': 0.4710981608911431, 'recall': 0.5732411427156738, 'f1-score': 0.5171745373324824, 'support': 113099}, 'accuracy': 0.5940322289759541, 'macro avg': {'precision': 0.5634303574210837, 'recall': 0.5891886586107932, 'f1-score': 0.5679679834361094, 'support': 504577}, 'weighted avg': {'precision': 0.6317498745950922, 'recall': 0.5940322289759541, 'f1-score': 0.6039363145552393, 'support': 504577}}
[[ 66643  25064  21177]
 [ 58724 168259  51611]
 [ 23518  24748  64833]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.91877556
{'0': {'precision': 0.46905155606011995, 'recall': 0.5820578980009035, 'f1-score': 0.5194799870167587, 'support': 130609}, '1': {'precision': 0.704369885840774, 'recall': 0.582682835498459, 'f1-score': 0.6377737842694808, 'support': 243019}, '2': {'precision': 0.49847313135311666, 'recall': 0.5385073578263293, 'f1-score': 0.517717453150524, 'support': 130949}, 'accuracy': 0.571056548356346, 'macro avg': {'precision': 0.5572981910846702, 'recall': 0.5677493637752306, 'f1-score': 0.5583237414789212, 'support': 504577}, 'weighted avg': {'precision': 0.5900232829680198, 'recall': 0.571056548356346, 'f1-score': 0.5759963131023902, 'support': 504577}}
[[ 76022  29564  25023]
 [ 55490 141603  45926]
 [ 30564  29868  70517]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9553403
{'0': {'precision': 0.48820144943114635, 'recall': 0.558508297304994, 'f1-score': 0.520993639571705, 'support': 154508}, '1': {'precision': 0.5878785922207336, 'recall': 0.5614311847406067, 'f1-score': 0.5743505904678797, 'support': 194608}, '2': {'precision': 0.5215229105765505, 'recall': 0.4762480622149607, 'f1-score': 0.4978582908017457, 'support': 155461}, 'accuracy': 0.5342910992772164, 'macro avg': {'precision': 0.5325343174094769, 'recall': 0.5320625147535205, 'f1-score': 0.5310675069471101, 'support': 504577}, 'weighted avg': {'precision': 0.5369118684060931, 'recall': 0.5342910992772164, 'f1-score': 0.5344445995735999, 'support': 504577}}
[[ 86294  37562  30652]
 [ 48074 109259  37275]
 [ 42391  39032  74038]]
Evaluating performance on  val set...
707/707 - 7s - 7s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8535491
{'0': {'precision': 0.41050880670813683, 'recall': 0.5620515380295751, 'f1-score': 0.47447360450876336, 'support': 32054}, '1': {'precision': 0.8244616009752134, 'recall': 0.6390007234966166, 'f1-score': 0.7199796683641664, 'support': 117485}, '2': {'precision': 0.40506439641999564, 'recall': 0.5944577927278551, 'f1-score': 0.4818175916910094, 'support': 31215}, 'accuracy': 0.6176626796640738, 'macro avg': {'precision': 0.5466782680344486, 'recall': 0.5985033514180156, 'f1-score': 0.5587569548546464, 'support': 180754}, 'weighted avg': {'precision': 0.6786262302081599, 'recall': 0.6176626796640738, 'f1-score': 0.6353138762147607, 'support': 180754}}
[[18016  8436  5602]
 [20760 75073 21652]
 [ 5111  7548 18556]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.88770545
{'0': {'precision': 0.46886591922644105, 'recall': 0.5348627124687982, 'f1-score': 0.4996946174945308, 'support': 42065}, '1': {'precision': 0.7301046568799606, 'recall': 0.6398715475848483, 'f1-score': 0.6820165126578817, 'support': 97468}, '2': {'precision': 0.4703037215393064, 'recall': 0.5401858276121394, 'f1-score': 0.5028283672248128, 'support': 41221}, 'accuracy': 0.5927005764741029, 'macro avg': {'precision': 0.5564247658819027, 'recall': 0.5716400292219287, 'f1-score': 0.5615131657924084, 'support': 180754}, 'weighted avg': {'precision': 0.6100616046926097, 'recall': 0.5927005764741028, 'f1-score': 0.5987227262800262, 'support': 180754}}
[[22499 11937  7629]
 [17651 62367 17450]
 [ 7836 11118 22267]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.92364985
{'0': {'precision': 0.4894136651218246, 'recall': 0.5210359299825981, 'f1-score': 0.5047299843325468, 'support': 48845}, '1': {'precision': 0.6548216992121447, 'recall': 0.6230440119653434, 'f1-score': 0.6385377352729227, 'support': 83909}, '2': {'precision': 0.4973219396516477, 'recall': 0.5068125, 'f1-score': 0.5020223698873252, 'support': 48000}, 'accuracy': 0.5646126780043595, 'macro avg': {'precision': 0.5471857679952057, 'recall': 0.5502974806493138, 'f1-score': 0.5484300298309316, 'support': 180754}, 'weighted avg': {'precision': 0.5682988898466782, 'recall': 0.5646126780043595, 'f1-score': 0.566126739482006, 'support': 180754}}
[[25450 14164  9231]
 [16272 52279 15358]
 [10279 13394 24327]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.97380745
{'0': {'precision': 0.5026852656020135, 'recall': 0.48884790402647543, 'f1-score': 0.4956700310219775, 'support': 58016}, '1': {'precision': 0.5295928473913858, 'recall': 0.6011820654238267, 'f1-score': 0.5631213041962272, 'support': 65817}, '2': {'precision': 0.5151447975655469, 'recall': 0.44907854746051545, 'f1-score': 0.4798483227271874, 'support': 56921}, 'accuracy': 0.5172278345154188, 'macro avg': {'precision': 0.515807636852982, 'recall': 0.5130361723036059, 'f1-score': 0.5128798859817973, 'support': 180754}, 'weighted avg': {'precision': 0.5164065958604166, 'recall': 0.5172278345154188, 'f1-score': 0.5152483141507704, 'support': 180754}}
[[28361 17864 11791]
 [13981 39568 12268]
 [14077 17282 25562]]
training model: results/ATVI/W4/deepVOL_L2/seq2seq
Epoch 1/50
1972/1972 - 67s - loss: 11.5243 - accuracy10: 0.5145 - accuracy20: 0.5248 - accuracy30: 0.5202 - accuracy50: 0.5019 - val_loss: 11.9296 - val_accuracy10: 0.4728 - val_accuracy20: 0.5110 - val_accuracy30: 0.5186 - val_accuracy50: 0.4812 - 67s/epoch - 34ms/step
Epoch 2/50
1972/1972 - 59s - loss: 10.9904 - accuracy10: 0.5603 - accuracy20: 0.5659 - accuracy30: 0.5559 - accuracy50: 0.5278 - val_loss: 11.3675 - val_accuracy10: 0.5598 - val_accuracy20: 0.5633 - val_accuracy30: 0.5504 - val_accuracy50: 0.5079 - 59s/epoch - 30ms/step
Epoch 3/50
1972/1972 - 57s - loss: 10.7815 - accuracy10: 0.5819 - accuracy20: 0.5813 - accuracy30: 0.5682 - accuracy50: 0.5382 - val_loss: 11.3384 - val_accuracy10: 0.6041 - val_accuracy20: 0.5916 - val_accuracy30: 0.5650 - val_accuracy50: 0.5091 - 57s/epoch - 29ms/step
Epoch 4/50
1972/1972 - 57s - loss: 10.6926 - accuracy10: 0.5885 - accuracy20: 0.5869 - accuracy30: 0.5723 - accuracy50: 0.5413 - val_loss: 11.2505 - val_accuracy10: 0.6008 - val_accuracy20: 0.5895 - val_accuracy30: 0.5655 - val_accuracy50: 0.5146 - 57s/epoch - 29ms/step
Epoch 5/50
1972/1972 - 59s - loss: 10.6153 - accuracy10: 0.5940 - accuracy20: 0.5914 - accuracy30: 0.5760 - accuracy50: 0.5439 - val_loss: 11.2622 - val_accuracy10: 0.5959 - val_accuracy20: 0.5879 - val_accuracy30: 0.5641 - val_accuracy50: 0.5141 - 59s/epoch - 30ms/step
Epoch 6/50
1972/1972 - 58s - loss: 10.5486 - accuracy10: 0.5994 - accuracy20: 0.5956 - accuracy30: 0.5791 - accuracy50: 0.5457 - val_loss: 11.1451 - val_accuracy10: 0.5842 - val_accuracy20: 0.5808 - val_accuracy30: 0.5607 - val_accuracy50: 0.5159 - 58s/epoch - 30ms/step
Epoch 7/50
1972/1972 - 57s - loss: 10.5046 - accuracy10: 0.6025 - accuracy20: 0.5979 - accuracy30: 0.5808 - accuracy50: 0.5469 - val_loss: 11.1085 - val_accuracy10: 0.5775 - val_accuracy20: 0.5769 - val_accuracy30: 0.5587 - val_accuracy50: 0.5154 - 57s/epoch - 29ms/step
Epoch 8/50
1972/1972 - 57s - loss: 10.4561 - accuracy10: 0.6059 - accuracy20: 0.6004 - accuracy30: 0.5829 - accuracy50: 0.5491 - val_loss: 11.0483 - val_accuracy10: 0.5749 - val_accuracy20: 0.5761 - val_accuracy30: 0.5580 - val_accuracy50: 0.5170 - 57s/epoch - 29ms/step
Epoch 9/50
1972/1972 - 57s - loss: 10.4153 - accuracy10: 0.6087 - accuracy20: 0.6022 - accuracy30: 0.5842 - accuracy50: 0.5503 - val_loss: 11.0419 - val_accuracy10: 0.5710 - val_accuracy20: 0.5728 - val_accuracy30: 0.5566 - val_accuracy50: 0.5165 - 57s/epoch - 29ms/step
Epoch 10/50
1972/1972 - 58s - loss: 10.3804 - accuracy10: 0.6105 - accuracy20: 0.6043 - accuracy30: 0.5858 - accuracy50: 0.5512 - val_loss: 10.9752 - val_accuracy10: 0.5695 - val_accuracy20: 0.5729 - val_accuracy30: 0.5579 - val_accuracy50: 0.5189 - 58s/epoch - 29ms/step
Epoch 11/50
1972/1972 - 56s - loss: 10.3530 - accuracy10: 0.6123 - accuracy20: 0.6051 - accuracy30: 0.5870 - accuracy50: 0.5526 - val_loss: 10.9700 - val_accuracy10: 0.5489 - val_accuracy20: 0.5600 - val_accuracy30: 0.5502 - val_accuracy50: 0.5174 - 56s/epoch - 29ms/step
Epoch 12/50
1972/1972 - 56s - loss: 10.3244 - accuracy10: 0.6137 - accuracy20: 0.6058 - accuracy30: 0.5877 - accuracy50: 0.5534 - val_loss: 10.9938 - val_accuracy10: 0.5575 - val_accuracy20: 0.5644 - val_accuracy30: 0.5536 - val_accuracy50: 0.5180 - 56s/epoch - 29ms/step
Epoch 13/50
1972/1972 - 57s - loss: 10.2962 - accuracy10: 0.6152 - accuracy20: 0.6069 - accuracy30: 0.5888 - accuracy50: 0.5547 - val_loss: 10.9635 - val_accuracy10: 0.5519 - val_accuracy20: 0.5628 - val_accuracy30: 0.5530 - val_accuracy50: 0.5193 - 57s/epoch - 29ms/step
Epoch 14/50
1972/1972 - 57s - loss: 10.2749 - accuracy10: 0.6159 - accuracy20: 0.6076 - accuracy30: 0.5897 - accuracy50: 0.5553 - val_loss: 10.9666 - val_accuracy10: 0.5508 - val_accuracy20: 0.5617 - val_accuracy30: 0.5533 - val_accuracy50: 0.5188 - 57s/epoch - 29ms/step
Epoch 15/50
1972/1972 - 57s - loss: 10.2554 - accuracy10: 0.6172 - accuracy20: 0.6086 - accuracy30: 0.5903 - accuracy50: 0.5560 - val_loss: 10.9191 - val_accuracy10: 0.5548 - val_accuracy20: 0.5634 - val_accuracy30: 0.5529 - val_accuracy50: 0.5196 - 57s/epoch - 29ms/step
Epoch 16/50
1972/1972 - 57s - loss: 10.2365 - accuracy10: 0.6177 - accuracy20: 0.6093 - accuracy30: 0.5909 - accuracy50: 0.5567 - val_loss: 10.9208 - val_accuracy10: 0.5482 - val_accuracy20: 0.5595 - val_accuracy30: 0.5500 - val_accuracy50: 0.5196 - 57s/epoch - 29ms/step
Epoch 17/50
1972/1972 - 57s - loss: 10.2214 - accuracy10: 0.6189 - accuracy20: 0.6097 - accuracy30: 0.5920 - accuracy50: 0.5576 - val_loss: 10.8917 - val_accuracy10: 0.5488 - val_accuracy20: 0.5620 - val_accuracy30: 0.5533 - val_accuracy50: 0.5222 - 57s/epoch - 29ms/step
Epoch 18/50
1972/1972 - 57s - loss: 10.1965 - accuracy10: 0.6194 - accuracy20: 0.6110 - accuracy30: 0.5932 - accuracy50: 0.5584 - val_loss: 10.8872 - val_accuracy10: 0.5516 - val_accuracy20: 0.5629 - val_accuracy30: 0.5524 - val_accuracy50: 0.5214 - 57s/epoch - 29ms/step
Epoch 19/50
1972/1972 - 57s - loss: 10.1834 - accuracy10: 0.6207 - accuracy20: 0.6118 - accuracy30: 0.5935 - accuracy50: 0.5590 - val_loss: 10.9054 - val_accuracy10: 0.5489 - val_accuracy20: 0.5620 - val_accuracy30: 0.5526 - val_accuracy50: 0.5205 - 57s/epoch - 29ms/step
Epoch 20/50
1972/1972 - 59s - loss: 10.1677 - accuracy10: 0.6206 - accuracy20: 0.6120 - accuracy30: 0.5941 - accuracy50: 0.5599 - val_loss: 10.8815 - val_accuracy10: 0.5486 - val_accuracy20: 0.5605 - val_accuracy30: 0.5511 - val_accuracy50: 0.5212 - 59s/epoch - 30ms/step
Epoch 21/50
1972/1972 - 58s - loss: 10.1508 - accuracy10: 0.6210 - accuracy20: 0.6124 - accuracy30: 0.5944 - accuracy50: 0.5608 - val_loss: 10.8833 - val_accuracy10: 0.5456 - val_accuracy20: 0.5581 - val_accuracy30: 0.5488 - val_accuracy50: 0.5205 - 58s/epoch - 30ms/step
Epoch 22/50
1972/1972 - 59s - loss: 10.1368 - accuracy10: 0.6220 - accuracy20: 0.6133 - accuracy30: 0.5953 - accuracy50: 0.5610 - val_loss: 10.8650 - val_accuracy10: 0.5580 - val_accuracy20: 0.5663 - val_accuracy30: 0.5545 - val_accuracy50: 0.5235 - 59s/epoch - 30ms/step
Epoch 23/50
1972/1972 - 59s - loss: 10.1240 - accuracy10: 0.6224 - accuracy20: 0.6134 - accuracy30: 0.5952 - accuracy50: 0.5610 - val_loss: 10.9068 - val_accuracy10: 0.5610 - val_accuracy20: 0.5674 - val_accuracy30: 0.5544 - val_accuracy50: 0.5203 - 59s/epoch - 30ms/step
Epoch 24/50
1972/1972 - 56s - loss: 10.1099 - accuracy10: 0.6229 - accuracy20: 0.6142 - accuracy30: 0.5963 - accuracy50: 0.5622 - val_loss: 10.8971 - val_accuracy10: 0.5537 - val_accuracy20: 0.5627 - val_accuracy30: 0.5513 - val_accuracy50: 0.5202 - 56s/epoch - 29ms/step
Epoch 25/50
1972/1972 - 57s - loss: 10.0977 - accuracy10: 0.6232 - accuracy20: 0.6143 - accuracy30: 0.5966 - accuracy50: 0.5623 - val_loss: 10.8717 - val_accuracy10: 0.5591 - val_accuracy20: 0.5646 - val_accuracy30: 0.5527 - val_accuracy50: 0.5211 - 57s/epoch - 29ms/step
Epoch 26/50
1972/1972 - 57s - loss: 10.0821 - accuracy10: 0.6230 - accuracy20: 0.6152 - accuracy30: 0.5974 - accuracy50: 0.5637 - val_loss: 10.8866 - val_accuracy10: 0.5611 - val_accuracy20: 0.5663 - val_accuracy30: 0.5530 - val_accuracy50: 0.5203 - 57s/epoch - 29ms/step
Epoch 27/50
1972/1972 - 58s - loss: 10.0680 - accuracy10: 0.6240 - accuracy20: 0.6153 - accuracy30: 0.5974 - accuracy50: 0.5641 - val_loss: 10.8897 - val_accuracy10: 0.5571 - val_accuracy20: 0.5625 - val_accuracy30: 0.5503 - val_accuracy50: 0.5198 - 58s/epoch - 29ms/step
Epoch 28/50
1972/1972 - 57s - loss: 10.0557 - accuracy10: 0.6241 - accuracy20: 0.6161 - accuracy30: 0.5988 - accuracy50: 0.5649 - val_loss: 10.9262 - val_accuracy10: 0.5594 - val_accuracy20: 0.5650 - val_accuracy30: 0.5514 - val_accuracy50: 0.5197 - 57s/epoch - 29ms/step
Epoch 29/50
1972/1972 - 57s - loss: 10.0440 - accuracy10: 0.6250 - accuracy20: 0.6168 - accuracy30: 0.5991 - accuracy50: 0.5654 - val_loss: 10.9288 - val_accuracy10: 0.5528 - val_accuracy20: 0.5591 - val_accuracy30: 0.5474 - val_accuracy50: 0.5180 - 57s/epoch - 29ms/step
Epoch 30/50
1972/1972 - 57s - loss: 10.0336 - accuracy10: 0.6249 - accuracy20: 0.6167 - accuracy30: 0.5993 - accuracy50: 0.5657 - val_loss: 10.9321 - val_accuracy10: 0.5473 - val_accuracy20: 0.5572 - val_accuracy30: 0.5468 - val_accuracy50: 0.5181 - 57s/epoch - 29ms/step
Epoch 31/50
1972/1972 - 57s - loss: 10.0146 - accuracy10: 0.6256 - accuracy20: 0.6178 - accuracy30: 0.6001 - accuracy50: 0.5665 - val_loss: 10.8948 - val_accuracy10: 0.5538 - val_accuracy20: 0.5598 - val_accuracy30: 0.5469 - val_accuracy50: 0.5175 - 57s/epoch - 29ms/step
Epoch 32/50
1972/1972 - 58s - loss: 10.0084 - accuracy10: 0.6252 - accuracy20: 0.6180 - accuracy30: 0.6006 - accuracy50: 0.5670 - val_loss: 10.9024 - val_accuracy10: 0.5515 - val_accuracy20: 0.5586 - val_accuracy30: 0.5451 - val_accuracy50: 0.5170 - 58s/epoch - 29ms/step
testing model: results/ATVI/W4/deepVOL_L2/seq2seq
Evaluating performance on  test set...
4274/4274 - 42s - 42s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9840439
{'0': {'precision': 0.37848575410600244, 'recall': 0.6933196362469983, 'f1-score': 0.4896627834182077, 'support': 230706}, '1': {'precision': 0.8295006432696047, 'recall': 0.43625160106622357, 'f1-score': 0.5717880182811134, 'support': 635514}, '2': {'precision': 0.4136681473925189, 'recall': 0.6122495556189514, 'f1-score': 0.4937396804272768, 'support': 227845}, 'accuracy': 0.5271121916887936, 'macro avg': {'precision': 0.5405515149227087, 'recall': 0.5806069309773911, 'f1-score': 0.5183968273755326, 'support': 1094065}, 'weighted avg': {'precision': 0.6477955379582269, 'recall': 0.5271121916887936, 'f1-score': 0.538216239664131, 'support': 1094065}}
[[159953  26850  43903]
 [204449 277244 153821]
 [ 58211  30136 139498]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.96991885
{'0': {'precision': 0.4505049760921964, 'recall': 0.6570052039617257, 'f1-score': 0.5345036443616529, 'support': 297850}, '1': {'precision': 0.7159977161551163, 'recall': 0.4606098870880959, 'f1-score': 0.5605872786891584, 'support': 503667}, '2': {'precision': 0.48265127073074093, 'recall': 0.55379971833682, 'f1-score': 0.5157834583689498, 'support': 292548}, 'accuracy': 0.5389953978968343, 'macro avg': {'precision': 0.5497179876593512, 'recall': 0.5571382697955473, 'f1-score': 0.5369581271399203, 'support': 1094065}, 'weighted avg': {'precision': 0.581323772153845, 'recall': 0.5389953978968343, 'f1-score': 0.5415058909183368, 'support': 1094065}}
[[195689  43849  58312]
 [156325 231994 115348]
 [ 82363  48172 162013]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9728827
{'0': {'precision': 0.4854334276064691, 'recall': 0.6225712449488058, 'f1-score': 0.5455155575612409, 'support': 340761}, '1': {'precision': 0.6230820208579736, 'recall': 0.46879391170541435, 'f1-score': 0.5350370846357428, 'support': 419165}, '2': {'precision': 0.5095356283622017, 'recall': 0.5210137098632605, 'f1-score': 0.515210748662706, 'support': 334139}, 'accuracy': 0.5326383715775571, 'macro avg': {'precision': 0.5393503589422147, 'recall': 0.5374596221724935, 'f1-score': 0.5319211302865633, 'support': 1094065}, 'weighted avg': {'precision': 0.5455312808862894, 'recall': 0.5326383715775571, 'f1-score': 0.5322455711853272, 'support': 1094065}}
[[212148  57716  70897]
 [125985 196502  96678]
 [ 98895  61153 174091]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9896527
{'0': {'precision': 0.5092334193876809, 'recall': 0.5683533708720134, 'f1-score': 0.5371716377479349, 'support': 394260}, '1': {'precision': 0.47413982973752, 'recall': 0.4744987925020125, 'f1-score': 0.47431924320440666, 'support': 313044}, '2': {'precision': 0.5286894867821759, 'recall': 0.4657967064931573, 'f1-score': 0.49525438033409713, 'support': 386761}, 'accuracy': 0.5052442039549753, 'macro avg': {'precision': 0.5040209119691256, 'recall': 0.5028829566223944, 'f1-score': 0.5022484204288129, 'support': 1094065}, 'weighted avg': {'precision': 0.5060699971075763, 'recall': 0.5052442039549753, 'f1-score': 0.5043696329382411, 'support': 1094065}}
[[224079  81239  88942]
 [ 92847 148539  71658]
 [123106  83503 180152]]
Evaluating performance on  train set...
1972/1972 - 20s - 20s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.87511855
{'0': {'precision': 0.3735425548307566, 'recall': 0.6699368983464603, 'f1-score': 0.47964517139606594, 'support': 86844}, '1': {'precision': 0.8790971281594891, 'recall': 0.5433362145564226, 'f1-score': 0.6715890179143451, 'support': 330878}, '2': {'precision': 0.39282175645245104, 'recall': 0.6527205323631675, 'f1-score': 0.49046858981845554, 'support': 86858}, 'accuracy': 0.5839549724523366, 'macro avg': {'precision': 0.5484871464808989, 'recall': 0.6219978817553501, 'f1-score': 0.5472342597096221, 'support': 504580}, 'weighted avg': {'precision': 0.7083783370819783, 'recall': 0.5839549724523366, 'f1-score': 0.6073753559567047, 'support': 504580}}
[[ 58180  12511  16153]
 [ 79622 179778  71478]
 [ 17950  12214  56694]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8781048
{'0': {'precision': 0.44049185336683855, 'recall': 0.6254194222375679, 'f1-score': 0.5169138684208601, 'support': 112953}, '1': {'precision': 0.7933252554264087, 'recall': 0.571193158563643, 'f1-score': 0.6641785904380225, 'support': 278538}, '2': {'precision': 0.46724209940136435, 'recall': 0.5935502126643617, 'f1-score': 0.522876427951034, 'support': 113089}, 'accuracy': 0.5883427801339728, 'macro avg': {'precision': 0.5670197360648705, 'recall': 0.5967209311551909, 'f1-score': 0.5679896289366387, 'support': 504580}, 'weighted avg': {'precision': 0.6412581713276516, 'recall': 0.5883427801339728, 'f1-score': 0.5995432255811205, 'support': 504580}}
[[ 70643  20964  21346]
 [ 64249 159099  55190]
 [ 25481  20484  67124]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.89876616
{'0': {'precision': 0.47244992869101504, 'recall': 0.5831362554435592, 'f1-score': 0.5219899359090738, 'support': 130659}, '1': {'precision': 0.7166606744076526, 'recall': 0.5823793259536645, 'f1-score': 0.6425796902065215, 'support': 243010}, '2': {'precision': 0.4974045654961497, 'recall': 0.5541016415732826, 'f1-score': 0.5242245541005405, 'support': 130911}, 'accuracy': 0.5752388124777043, 'macro avg': {'precision': 0.5621717228649391, 'recall': 0.5732057409901689, 'f1-score': 0.5629313934053787, 'support': 504580}, 'weighted avg': {'precision': 0.5965382591349428, 'recall': 0.5752388124777043, 'f1-score': 0.5806467441335097, 'support': 504580}}
[[ 76192  28435  26032]
 [ 54223 141524  47263]
 [ 30855  27518  72538]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.94121295
{'0': {'precision': 0.49864632653818103, 'recall': 0.5220812839761844, 'f1-score': 0.5100947828341269, 'support': 154520}, '1': {'precision': 0.5870385088514167, 'recall': 0.5962199931104336, 'f1-score': 0.591593629156506, 'support': 194497}, '2': {'precision': 0.5239193440681816, 'recall': 0.4892165874918843, 'f1-score': 0.5059736322476415, 'support': 155563}, 'accuracy': 0.5405267747433509, 'macro avg': {'precision': 0.5365347264859265, 'recall': 0.5358392881928341, 'f1-score': 0.5358873480794247, 'support': 504580}, 'weighted avg': {'precision': 0.5405099769194821, 'recall': 0.5405267747433509, 'f1-score': 0.5402390266893696, 'support': 504580}}
[[ 80672  41429  32419]
 [ 41798 115963  36736]
 [ 39312  40147  76104]]
Evaluating performance on  val set...
707/707 - 7s - 7s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.90947074
{'0': {'precision': 0.36630485141306507, 'recall': 0.6904747052585616, 'f1-score': 0.478669809076953, 'support': 32062}, '1': {'precision': 0.8736275306079475, 'recall': 0.49473612483390683, 'f1-score': 0.6317254880635161, 'support': 117404}, '2': {'precision': 0.38192896418487143, 'recall': 0.6571209409358221, 'f1-score': 0.48308270676691734, 'support': 31288}, 'accuracy': 0.5575644245770495, 'macro avg': {'precision': 0.5406204487352947, 'recall': 0.6141105903427635, 'f1-score': 0.5311593346357956, 'support': 180754}, 'weighted avg': {'precision': 0.6985274250136507, 'recall': 0.5575644245770495, 'f1-score': 0.5788469541396464, 'support': 180754}}
[[22138  4250  5674]
 [31722 58084 27598]
 [ 6576  4152 20560]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.90705514
{'0': {'precision': 0.43522293198086864, 'recall': 0.6439410130369737, 'f1-score': 0.5193981822883248, 'support': 42111}, '1': {'precision': 0.7808863923952964, 'recall': 0.5193726842586035, 'f1-score': 0.6238311564231691, 'support': 97431}, '2': {'precision': 0.45557916713268465, 'recall': 0.5930311559739881, 'f1-score': 0.5152965485251639, 'support': 41212}, 'accuracy': 0.5651880456310787, 'macro avg': {'precision': 0.5572294971696166, 'recall': 0.5854482844231885, 'f1-score': 0.5528419624122193, 'support': 180754}, 'weighted avg': {'precision': 0.6261855539682922, 'recall': 0.5651880456310787, 'f1-score': 0.5747550350953698, 'support': 180754}}
[[27117  7064  7930]
 [25552 50603 21276]
 [ 9637  7135 24440]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.92395645
{'0': {'precision': 0.46794003791438993, 'recall': 0.60033926710131, 'f1-score': 0.5259350772591358, 'support': 48929}, '1': {'precision': 0.6969076709913087, 'recall': 0.5281483426007685, 'f1-score': 0.6009041664969658, 'support': 83806}, '2': {'precision': 0.4860195707650223, 'recall': 0.5513026093837856, 'f1-score': 0.5166068222621185, 'support': 48019}, 'accuracy': 0.5538411321464531, 'macro avg': {'precision': 0.5502890932235737, 'recall': 0.5599300730286213, 'f1-score': 0.5478153553394066, 'support': 180754}, 'weighted avg': {'precision': 0.5789031288866437, 'recall': 0.5538411321464531, 'f1-score': 0.5582161112388198, 'support': 180754}}
[[29374  9625  9930]
 [21478 44262 18066]
 [11921  9625 26473]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.96321917
{'0': {'precision': 0.49426727350576444, 'recall': 0.5368702092842994, 'f1-score': 0.5146886404544478, 'support': 58055}, '1': {'precision': 0.5582534980461364, 'recall': 0.5385246773776772, 'f1-score': 0.548211646925023, 'support': 65789}, '2': {'precision': 0.5100957017204182, 'recall': 0.4860832894043226, 'f1-score': 0.4978000917753124, 'support': 56910}, 'accuracy': 0.521482235524525, 'macro avg': {'precision': 0.5208721577574397, 'recall': 0.520492725355433, 'f1-score': 0.5202334597182611, 'support': 180754}, 'weighted avg': {'precision': 0.5225398737026203, 'recall': 0.521482235524525, 'f1-score': 0.5215726804611037, 'support': 180754}}
[[31168 14118 12769]
 [16561 35429 13799]
 [15330 13917 27663]]
training model: results/ATVI/W4/deepVOL_L3/seq2seq
Epoch 1/50
1972/1972 - 93s - loss: 11.8800 - accuracy10: 0.4994 - accuracy20: 0.5056 - accuracy30: 0.5010 - accuracy50: 0.4830 - val_loss: 12.3115 - val_accuracy10: 0.5611 - val_accuracy20: 0.5378 - val_accuracy30: 0.5149 - val_accuracy50: 0.4606 - 93s/epoch - 47ms/step
Epoch 2/50
1972/1972 - 83s - loss: 11.0814 - accuracy10: 0.5510 - accuracy20: 0.5559 - accuracy30: 0.5487 - accuracy50: 0.5244 - val_loss: 11.6728 - val_accuracy10: 0.5445 - val_accuracy20: 0.5443 - val_accuracy30: 0.5317 - val_accuracy50: 0.4930 - 83s/epoch - 42ms/step
Epoch 3/50
1972/1972 - 84s - loss: 10.8153 - accuracy10: 0.5798 - accuracy20: 0.5767 - accuracy30: 0.5640 - accuracy50: 0.5350 - val_loss: 11.3406 - val_accuracy10: 0.5678 - val_accuracy20: 0.5667 - val_accuracy30: 0.5523 - val_accuracy50: 0.5128 - 84s/epoch - 43ms/step
Epoch 4/50
1972/1972 - 85s - loss: 10.6849 - accuracy10: 0.5880 - accuracy20: 0.5840 - accuracy30: 0.5702 - accuracy50: 0.5406 - val_loss: 11.1082 - val_accuracy10: 0.5753 - val_accuracy20: 0.5741 - val_accuracy30: 0.5586 - val_accuracy50: 0.5174 - 85s/epoch - 43ms/step
Epoch 5/50
1972/1972 - 84s - loss: 10.5789 - accuracy10: 0.5956 - accuracy20: 0.5907 - accuracy30: 0.5760 - accuracy50: 0.5444 - val_loss: 11.0832 - val_accuracy10: 0.5652 - val_accuracy20: 0.5682 - val_accuracy30: 0.5553 - val_accuracy50: 0.5189 - 84s/epoch - 42ms/step
Epoch 6/50
1972/1972 - 84s - loss: 10.5170 - accuracy10: 0.5984 - accuracy20: 0.5933 - accuracy30: 0.5782 - accuracy50: 0.5459 - val_loss: 11.0881 - val_accuracy10: 0.5397 - val_accuracy20: 0.5542 - val_accuracy30: 0.5478 - val_accuracy50: 0.5190 - 84s/epoch - 43ms/step
Epoch 7/50
1972/1972 - 85s - loss: 10.4644 - accuracy10: 0.6013 - accuracy20: 0.5965 - accuracy30: 0.5806 - accuracy50: 0.5472 - val_loss: 10.9505 - val_accuracy10: 0.5756 - val_accuracy20: 0.5783 - val_accuracy30: 0.5643 - val_accuracy50: 0.5229 - 85s/epoch - 43ms/step
Epoch 8/50
1972/1972 - 85s - loss: 10.4198 - accuracy10: 0.6048 - accuracy20: 0.5989 - accuracy30: 0.5824 - accuracy50: 0.5489 - val_loss: 11.0033 - val_accuracy10: 0.5331 - val_accuracy20: 0.5465 - val_accuracy30: 0.5406 - val_accuracy50: 0.5170 - 85s/epoch - 43ms/step
Epoch 9/50
1972/1972 - 84s - loss: 10.3808 - accuracy10: 0.6073 - accuracy20: 0.6013 - accuracy30: 0.5848 - accuracy50: 0.5504 - val_loss: 10.9037 - val_accuracy10: 0.5422 - val_accuracy20: 0.5548 - val_accuracy30: 0.5480 - val_accuracy50: 0.5215 - 84s/epoch - 43ms/step
Epoch 10/50
1972/1972 - 84s - loss: 10.3461 - accuracy10: 0.6103 - accuracy20: 0.6034 - accuracy30: 0.5866 - accuracy50: 0.5521 - val_loss: 10.9228 - val_accuracy10: 0.5352 - val_accuracy20: 0.5501 - val_accuracy30: 0.5460 - val_accuracy50: 0.5213 - 84s/epoch - 42ms/step
Epoch 11/50
1972/1972 - 83s - loss: 10.3142 - accuracy10: 0.6111 - accuracy20: 0.6043 - accuracy30: 0.5868 - accuracy50: 0.5522 - val_loss: 10.8515 - val_accuracy10: 0.5403 - val_accuracy20: 0.5535 - val_accuracy30: 0.5473 - val_accuracy50: 0.5220 - 83s/epoch - 42ms/step
Epoch 12/50
1972/1972 - 85s - loss: 10.2860 - accuracy10: 0.6122 - accuracy20: 0.6057 - accuracy30: 0.5888 - accuracy50: 0.5538 - val_loss: 10.9333 - val_accuracy10: 0.5325 - val_accuracy20: 0.5487 - val_accuracy30: 0.5448 - val_accuracy50: 0.5216 - 85s/epoch - 43ms/step
Epoch 13/50
1972/1972 - 85s - loss: 10.2598 - accuracy10: 0.6130 - accuracy20: 0.6062 - accuracy30: 0.5889 - accuracy50: 0.5539 - val_loss: 10.8408 - val_accuracy10: 0.5493 - val_accuracy20: 0.5620 - val_accuracy30: 0.5551 - val_accuracy50: 0.5251 - 85s/epoch - 43ms/step
Epoch 14/50
1972/1972 - 84s - loss: 10.2395 - accuracy10: 0.6144 - accuracy20: 0.6075 - accuracy30: 0.5903 - accuracy50: 0.5551 - val_loss: 10.8898 - val_accuracy10: 0.5402 - val_accuracy20: 0.5546 - val_accuracy30: 0.5487 - val_accuracy50: 0.5238 - 84s/epoch - 42ms/step
Epoch 15/50
1972/1972 - 83s - loss: 10.2124 - accuracy10: 0.6156 - accuracy20: 0.6085 - accuracy30: 0.5915 - accuracy50: 0.5564 - val_loss: 10.8338 - val_accuracy10: 0.5502 - val_accuracy20: 0.5621 - val_accuracy30: 0.5543 - val_accuracy50: 0.5247 - 83s/epoch - 42ms/step
Epoch 16/50
1972/1972 - 85s - loss: 10.1921 - accuracy10: 0.6164 - accuracy20: 0.6094 - accuracy30: 0.5924 - accuracy50: 0.5574 - val_loss: 10.8462 - val_accuracy10: 0.5486 - val_accuracy20: 0.5609 - val_accuracy30: 0.5543 - val_accuracy50: 0.5266 - 85s/epoch - 43ms/step
Epoch 17/50
1972/1972 - 85s - loss: 10.1722 - accuracy10: 0.6180 - accuracy20: 0.6100 - accuracy30: 0.5928 - accuracy50: 0.5577 - val_loss: 10.8438 - val_accuracy10: 0.5573 - val_accuracy20: 0.5676 - val_accuracy30: 0.5598 - val_accuracy50: 0.5287 - 85s/epoch - 43ms/step
Epoch 18/50
1972/1972 - 84s - loss: 10.1560 - accuracy10: 0.6183 - accuracy20: 0.6108 - accuracy30: 0.5937 - accuracy50: 0.5588 - val_loss: 10.9334 - val_accuracy10: 0.5491 - val_accuracy20: 0.5614 - val_accuracy30: 0.5550 - val_accuracy50: 0.5259 - 84s/epoch - 43ms/step
Epoch 19/50
1972/1972 - 85s - loss: 10.1399 - accuracy10: 0.6195 - accuracy20: 0.6117 - accuracy30: 0.5945 - accuracy50: 0.5597 - val_loss: 10.8744 - val_accuracy10: 0.5407 - val_accuracy20: 0.5543 - val_accuracy30: 0.5489 - val_accuracy50: 0.5242 - 85s/epoch - 43ms/step
Epoch 20/50
1972/1972 - 85s - loss: 10.1228 - accuracy10: 0.6206 - accuracy20: 0.6124 - accuracy30: 0.5953 - accuracy50: 0.5603 - val_loss: 10.9298 - val_accuracy10: 0.5398 - val_accuracy20: 0.5524 - val_accuracy30: 0.5466 - val_accuracy50: 0.5214 - 85s/epoch - 43ms/step
Epoch 21/50
1972/1972 - 85s - loss: 10.1081 - accuracy10: 0.6205 - accuracy20: 0.6127 - accuracy30: 0.5960 - accuracy50: 0.5610 - val_loss: 10.9626 - val_accuracy10: 0.5298 - val_accuracy20: 0.5437 - val_accuracy30: 0.5404 - val_accuracy50: 0.5196 - 85s/epoch - 43ms/step
Epoch 22/50
1972/1972 - 85s - loss: 10.0919 - accuracy10: 0.6199 - accuracy20: 0.6130 - accuracy30: 0.5958 - accuracy50: 0.5607 - val_loss: 10.9970 - val_accuracy10: 0.5201 - val_accuracy20: 0.5361 - val_accuracy30: 0.5341 - val_accuracy50: 0.5164 - 85s/epoch - 43ms/step
Epoch 23/50
1972/1972 - 84s - loss: 10.0786 - accuracy10: 0.6208 - accuracy20: 0.6133 - accuracy30: 0.5966 - accuracy50: 0.5619 - val_loss: 10.9128 - val_accuracy10: 0.5371 - val_accuracy20: 0.5483 - val_accuracy30: 0.5426 - val_accuracy50: 0.5194 - 84s/epoch - 42ms/step
Epoch 24/50
1972/1972 - 83s - loss: 10.0643 - accuracy10: 0.6223 - accuracy20: 0.6147 - accuracy30: 0.5979 - accuracy50: 0.5632 - val_loss: 10.9647 - val_accuracy10: 0.5277 - val_accuracy20: 0.5422 - val_accuracy30: 0.5391 - val_accuracy50: 0.5191 - 83s/epoch - 42ms/step
Epoch 25/50
1972/1972 - 85s - loss: 10.0501 - accuracy10: 0.6225 - accuracy20: 0.6149 - accuracy30: 0.5979 - accuracy50: 0.5636 - val_loss: 10.9377 - val_accuracy10: 0.5326 - val_accuracy20: 0.5455 - val_accuracy30: 0.5408 - val_accuracy50: 0.5197 - 85s/epoch - 43ms/step
testing model: results/ATVI/W4/deepVOL_L3/seq2seq
Evaluating performance on  test set...
4274/4274 - 75s - 75s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0375339
{'0': {'precision': 0.34574714156182473, 'recall': 0.7288930500290413, 'f1-score': 0.46901779874573446, 'support': 230706}, '1': {'precision': 0.8379714339383736, 'recall': 0.3790553787957464, 'f1-score': 0.521989451650509, 'support': 635514}, '2': {'precision': 0.4212395073448586, 'recall': 0.5920296692927209, 'f1-score': 0.49224094046552536, 'support': 227845}, 'accuracy': 0.4971788696284042, 'macro avg': {'precision': 0.534986027615019, 'recall': 0.5666593660391696, 'f1-score': 0.4944160636205896, 'support': 1094065}, 'weighted avg': {'precision': 0.6473891710822147, 'recall': 0.4971788696284042, 'f1-score': 0.5046240047291729, 'support': 1094065}}
[[168160  18059  44487]
 [253773 240895 140846]
 [ 64434  28520 134891]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0074072
{'0': {'precision': 0.41735936401320256, 'recall': 0.703454759106933, 'f1-score': 0.5238931680404264, 'support': 297850}, '1': {'precision': 0.7302163188401628, 'recall': 0.40320092442030153, 'f1-score': 0.5195331137475616, 'support': 503667}, '2': {'precision': 0.49126249466448363, 'recall': 0.527175027687764, 'f1-score': 0.508585580445916, 'support': 292548}, 'accuracy': 0.5180926178974741, 'macro avg': {'precision': 0.5462793925059497, 'recall': 0.5446102370716662, 'f1-score': 0.5173372874113014, 'support': 1094065}, 'weighted avg': {'precision': 0.5811484779439119, 'recall': 0.5180926178974741, 'f1-score': 0.5177927813164902, 'support': 1094065}}
[[209524  31276  57050]
 [197928 203079 102660]
 [ 94571  43753 154224]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.99703664
{'0': {'precision': 0.45586902221887954, 'recall': 0.6759165514832977, 'f1-score': 0.5445014048347118, 'support': 340761}, '1': {'precision': 0.6392442020602656, 'recall': 0.41526129328546035, 'f1-score': 0.5034651317502097, 'support': 419165}, '2': {'precision': 0.5171803717885531, 'recall': 0.4899158733341514, 'f1-score': 0.5031790650459608, 'support': 334139}, 'accuracy': 0.5192461142619497, 'macro avg': {'precision': 0.5374311986892327, 'recall': 0.5270312393676365, 'f1-score': 0.5170485338769608, 'support': 1094065}, 'weighted avg': {'precision': 0.5448499971080093, 'recall': 0.5192461142619497, 'f1-score': 0.5161590534185356, 'support': 1094065}}
[[230326  43018  67417]
 [159695 174063  85407]
 [115225  55214 163700]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.99532545
{'0': {'precision': 0.48909988393718623, 'recall': 0.6210089788464465, 'f1-score': 0.5472173579735621, 'support': 394260}, '1': {'precision': 0.49414737962224, 'recall': 0.41535694662731115, 'f1-score': 0.45133935234842254, 'support': 313044}, '2': {'precision': 0.5286882764633231, 'recall': 0.4515682811865726, 'f1-score': 0.487094637465922, 'support': 386761}, 'accuracy': 0.5022672327512534, 'macro avg': {'precision': 0.5039785133409165, 'recall': 0.49597806888677676, 'f1-score': 0.4952171159293022, 'support': 1094065}, 'weighted avg': {'precision': 0.5045389433358811, 'recall': 0.5022672327512534, 'f1-score': 0.4985299784310563, 'support': 1094065}}
[[244839  60678  88743]
 [116067 130025  66952]
 [139685  72427 174649]]
Evaluating performance on  train set...
1972/1972 - 34s - 34s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9100792
{'0': {'precision': 0.3452896014322274, 'recall': 0.6929091244069826, 'f1-score': 0.46090273363000633, 'support': 86844}, '1': {'precision': 0.8859235838276958, 'recall': 0.5131710177164998, 'f1-score': 0.6498921611592627, 'support': 330878}, '2': {'precision': 0.39995672400735693, 'recall': 0.6384213313684405, 'f1-score': 0.491807204338745, 'support': 86858}, 'accuracy': 0.565666494906655, 'macro avg': {'precision': 0.5437233030890934, 'recall': 0.6148338244973076, 'f1-score': 0.534200699709338, 'support': 504580}, 'weighted avg': {'precision': 0.7092203314644886, 'recall': 0.565666494906655, 'f1-score': 0.5901522962738783, 'support': 504580}}
[[ 60175   9667  17002]
 [ 94890 169797  66191]
 [ 19209  12197  55452]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9043267
{'0': {'precision': 0.413058288752136, 'recall': 0.6548564447159438, 'f1-score': 0.5065832953802217, 'support': 112953}, '1': {'precision': 0.8027466597193792, 'recall': 0.542055303046622, 'f1-score': 0.6471333266183905, 'support': 278538}, '2': {'precision': 0.473406926060412, 'recall': 0.5752725729292858, 'f1-score': 0.5193922846011367, 'support': 113089}, 'accuracy': 0.5747512782908558, 'macro avg': {'precision': 0.5630706248439757, 'recall': 0.5907281068972838, 'f1-score': 0.557702968866583, 'support': 504580}, 'weighted avg': {'precision': 0.6416995082159072, 'recall': 0.5747512782908558, 'f1-score': 0.587040468441027, 'support': 504580}}
[[ 73968  17059  21926]
 [ 77115 150983  50440]
 [ 27991  20041  65057]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9170314
{'0': {'precision': 0.44956367648533885, 'recall': 0.6174545955502492, 'f1-score': 0.5203006645964535, 'support': 130659}, '1': {'precision': 0.7282948526488822, 'recall': 0.5578988518990988, 'f1-score': 0.6318097510508803, 'support': 243010}, '2': {'precision': 0.5028710819445644, 'recall': 0.5338359648921787, 'f1-score': 0.5178910861373262, 'support': 130911}, 'accuracy': 0.5670775694637123, 'macro avg': {'precision': 0.5602432036929285, 'recall': 0.5697298041138422, 'f1-score': 0.5566671672615534, 'support': 504580}, 'weighted avg': {'precision': 0.5976333361539253, 'recall': 0.5670775694637123, 'f1-score': 0.5733792304802131, 'support': 504580}}
[[ 80676  23882  26101]
 [ 64449 135575  42986]
 [ 34329  26697  69885]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.94785213
{'0': {'precision': 0.4821896442417204, 'recall': 0.556206316334455, 'f1-score': 0.51656003293675, 'support': 154520}, '1': {'precision': 0.6046808907517844, 'recall': 0.5666771209838712, 'f1-score': 0.5850625049765109, 'support': 194497}, '2': {'precision': 0.5243218480162146, 'recall': 0.4855781901866125, 'f1-score': 0.5042068410811965, 'support': 155563}, 'accuracy': 0.538467636450117, 'macro avg': {'precision': 0.5370641276699065, 'recall': 0.5361538758349796, 'f1-score': 0.5352764596648192, 'support': 504580}, 'weighted avg': {'precision': 0.5423949476390797, 'recall': 0.538467636450117, 'f1-score': 0.539156698915766, 'support': 504580}}
[[ 85945  34738  33837]
 [ 49587 110217  34693]
 [ 42707  37318  75538]]
Evaluating performance on  val set...
707/707 - 12s - 12s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9249211
{'0': {'precision': 0.34658938121844096, 'recall': 0.7235980288191629, 'f1-score': 0.46868686868686876, 'support': 32062}, '1': {'precision': 0.8788043393913056, 'recall': 0.4823004326939457, 'f1-score': 0.6227995402475843, 'support': 117404}, '2': {'precision': 0.39720146609157, 'recall': 0.6269176681155715, 'f1-score': 0.48629619070049956, 'support': 31288}, 'accuracy': 0.5501344368589354, 'macro avg': {'precision': 0.5408650622337722, 'recall': 0.6109387098762267, 'f1-score': 0.525927533211651, 'support': 180754}, 'weighted avg': {'precision': 0.7010363968354534, 'recall': 0.5501344368589354, 'f1-score': 0.5718348187132954, 'support': 180754}}
[[23200  3373  5489]
 [36501 56624 24279]
 [ 7237  4436 19615]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9172336
{'0': {'precision': 0.4176821288352479, 'recall': 0.6821020635938353, 'f1-score': 0.5181049954455678, 'support': 42111}, '1': {'precision': 0.7886685372774687, 'recall': 0.5106177705247816, 'f1-score': 0.6198913476874003, 'support': 97431}, '2': {'precision': 0.4730793611843854, 'recall': 0.5613656216635932, 'f1-score': 0.5134550296842922, 'support': 41212}, 'accuracy': 0.5621397036856722, 'macro avg': {'precision': 0.559810009099034, 'recall': 0.5846951519274034, 'f1-score': 0.5504837909390868, 'support': 180754}, 'weighted avg': {'precision': 0.630283827832264, 'recall': 0.5621397036856722, 'f1-score': 0.5719102318238515, 'support': 180754}}
[[28724  5961  7426]
 [29339 49750 18342]
 [10707  7370 23135]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.929356
{'0': {'precision': 0.455384704569499, 'recall': 0.6421958347810092, 'f1-score': 0.5328923937929281, 'support': 48929}, '1': {'precision': 0.7057652479650649, 'recall': 0.5245447819965158, 'f1-score': 0.6018084370914417, 'support': 83806}, '2': {'precision': 0.5030526017870861, 'recall': 0.518211541264916, 'f1-score': 0.5105195671128891, 'support': 48019}, 'accuracy': 0.5547097159675581, 'macro avg': {'precision': 0.5547341847738833, 'recall': 0.5616507193474803, 'f1-score': 0.5484067993324196, 'support': 180754}, 'weighted avg': {'precision': 0.5841362485259265, 'recall': 0.5547097159675581, 'f1-score': 0.5589015397057513, 'support': 180754}}
[[31422  8465  9042]
 [24306 43960 15540]
 [13273  9862 24884]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.96109056
{'0': {'precision': 0.4877813927023912, 'recall': 0.5759021617431745, 'f1-score': 0.5281915986034534, 'support': 58055}, '1': {'precision': 0.5726147218888213, 'recall': 0.5293742114943227, 'f1-score': 0.550146118000158, 'support': 65789}, '2': {'precision': 0.5197703833430628, 'recall': 0.4693551221226498, 'f1-score': 0.4932779316712834, 'support': 56910}, 'accuracy': 0.525421290815141, 'macro avg': {'precision': 0.5267221659780917, 'recall': 0.524877165120049, 'f1-score': 0.5238718827582983, 'support': 180754}, 'weighted avg': {'precision': 0.5287298273218556, 'recall': 0.525421290815141, 'f1-score': 0.5251898896038185, 'support': 180754}}
[[33434 12336 12285]
 [18568 34827 12394]
 [16541 13658 26711]]
training model: results/ATVI/W5/deepLOB_L1/seq2seq
Epoch 1/50
1806/1806 - 52s - loss: 12.1463 - accuracy10: 0.4512 - accuracy20: 0.4665 - accuracy30: 0.4696 - accuracy50: 0.4610 - val_loss: 14.2412 - val_accuracy10: 0.5682 - val_accuracy20: 0.4838 - val_accuracy30: 0.4231 - val_accuracy50: 0.3372 - 52s/epoch - 29ms/step
Epoch 2/50
1806/1806 - 41s - loss: 11.9428 - accuracy10: 0.4612 - accuracy20: 0.4812 - accuracy30: 0.4831 - accuracy50: 0.4689 - val_loss: 13.1448 - val_accuracy10: 0.5390 - val_accuracy20: 0.4941 - val_accuracy30: 0.4528 - val_accuracy50: 0.3821 - 41s/epoch - 23ms/step
Epoch 3/50
1806/1806 - 42s - loss: 11.6400 - accuracy10: 0.5029 - accuracy20: 0.5110 - accuracy30: 0.5064 - accuracy50: 0.4866 - val_loss: 12.7634 - val_accuracy10: 0.5694 - val_accuracy20: 0.5280 - val_accuracy30: 0.4920 - val_accuracy50: 0.4308 - 42s/epoch - 23ms/step
Epoch 4/50
1806/1806 - 47s - loss: 11.4542 - accuracy10: 0.5247 - accuracy20: 0.5272 - accuracy30: 0.5195 - accuracy50: 0.4973 - val_loss: 12.6122 - val_accuracy10: 0.5872 - val_accuracy20: 0.5440 - val_accuracy30: 0.5059 - val_accuracy50: 0.4442 - 47s/epoch - 26ms/step
Epoch 5/50
1806/1806 - 44s - loss: 11.3312 - accuracy10: 0.5383 - accuracy20: 0.5389 - accuracy30: 0.5291 - accuracy50: 0.5046 - val_loss: 12.4885 - val_accuracy10: 0.5589 - val_accuracy20: 0.5317 - val_accuracy30: 0.5023 - val_accuracy50: 0.4512 - 44s/epoch - 25ms/step
Epoch 6/50
1806/1806 - 45s - loss: 11.2512 - accuracy10: 0.5465 - accuracy20: 0.5456 - accuracy30: 0.5351 - accuracy50: 0.5089 - val_loss: 12.3251 - val_accuracy10: 0.5583 - val_accuracy20: 0.5336 - val_accuracy30: 0.5061 - val_accuracy50: 0.4573 - 45s/epoch - 25ms/step
Epoch 7/50
1806/1806 - 44s - loss: 11.1817 - accuracy10: 0.5539 - accuracy20: 0.5522 - accuracy30: 0.5398 - accuracy50: 0.5119 - val_loss: 12.2720 - val_accuracy10: 0.5641 - val_accuracy20: 0.5372 - val_accuracy30: 0.5081 - val_accuracy50: 0.4562 - 44s/epoch - 24ms/step
Epoch 8/50
1806/1806 - 47s - loss: 11.1276 - accuracy10: 0.5584 - accuracy20: 0.5561 - accuracy30: 0.5428 - accuracy50: 0.5139 - val_loss: 12.2725 - val_accuracy10: 0.5640 - val_accuracy20: 0.5382 - val_accuracy30: 0.5086 - val_accuracy50: 0.4571 - 47s/epoch - 26ms/step
Epoch 9/50
1806/1806 - 45s - loss: 11.0900 - accuracy10: 0.5601 - accuracy20: 0.5581 - accuracy30: 0.5449 - accuracy50: 0.5150 - val_loss: 12.2420 - val_accuracy10: 0.5630 - val_accuracy20: 0.5373 - val_accuracy30: 0.5093 - val_accuracy50: 0.4597 - 45s/epoch - 25ms/step
Epoch 10/50
1806/1806 - 45s - loss: 11.0491 - accuracy10: 0.5632 - accuracy20: 0.5606 - accuracy30: 0.5469 - accuracy50: 0.5173 - val_loss: 12.3451 - val_accuracy10: 0.5538 - val_accuracy20: 0.5302 - val_accuracy30: 0.5027 - val_accuracy50: 0.4541 - 45s/epoch - 25ms/step
Epoch 11/50
1806/1806 - 46s - loss: 11.0178 - accuracy10: 0.5656 - accuracy20: 0.5636 - accuracy30: 0.5494 - accuracy50: 0.5188 - val_loss: 12.3497 - val_accuracy10: 0.5554 - val_accuracy20: 0.5310 - val_accuracy30: 0.5036 - val_accuracy50: 0.4521 - 46s/epoch - 25ms/step
Epoch 12/50
1806/1806 - 43s - loss: 10.9932 - accuracy10: 0.5665 - accuracy20: 0.5639 - accuracy30: 0.5503 - accuracy50: 0.5194 - val_loss: 12.4190 - val_accuracy10: 0.5604 - val_accuracy20: 0.5330 - val_accuracy30: 0.5039 - val_accuracy50: 0.4521 - 43s/epoch - 24ms/step
Epoch 13/50
1806/1806 - 45s - loss: 10.9654 - accuracy10: 0.5687 - accuracy20: 0.5652 - accuracy30: 0.5511 - accuracy50: 0.5204 - val_loss: 12.4702 - val_accuracy10: 0.5563 - val_accuracy20: 0.5300 - val_accuracy30: 0.5007 - val_accuracy50: 0.4461 - 45s/epoch - 25ms/step
Epoch 14/50
1806/1806 - 45s - loss: 10.9458 - accuracy10: 0.5698 - accuracy20: 0.5668 - accuracy30: 0.5528 - accuracy50: 0.5214 - val_loss: 12.4836 - val_accuracy10: 0.5608 - val_accuracy20: 0.5321 - val_accuracy30: 0.4996 - val_accuracy50: 0.4445 - 45s/epoch - 25ms/step
Epoch 15/50
1806/1806 - 42s - loss: 10.9226 - accuracy10: 0.5703 - accuracy20: 0.5679 - accuracy30: 0.5542 - accuracy50: 0.5229 - val_loss: 12.5108 - val_accuracy10: 0.5583 - val_accuracy20: 0.5309 - val_accuracy30: 0.5000 - val_accuracy50: 0.4450 - 42s/epoch - 23ms/step
Epoch 16/50
1806/1806 - 48s - loss: 10.9038 - accuracy10: 0.5719 - accuracy20: 0.5693 - accuracy30: 0.5549 - accuracy50: 0.5231 - val_loss: 12.6773 - val_accuracy10: 0.5544 - val_accuracy20: 0.5273 - val_accuracy30: 0.4964 - val_accuracy50: 0.4405 - 48s/epoch - 26ms/step
Epoch 17/50
1806/1806 - 47s - loss: 10.8857 - accuracy10: 0.5727 - accuracy20: 0.5699 - accuracy30: 0.5562 - accuracy50: 0.5244 - val_loss: 12.6422 - val_accuracy10: 0.5560 - val_accuracy20: 0.5266 - val_accuracy30: 0.4954 - val_accuracy50: 0.4385 - 47s/epoch - 26ms/step
Epoch 18/50
1806/1806 - 45s - loss: 10.8685 - accuracy10: 0.5732 - accuracy20: 0.5706 - accuracy30: 0.5570 - accuracy50: 0.5251 - val_loss: 12.5909 - val_accuracy10: 0.5596 - val_accuracy20: 0.5320 - val_accuracy30: 0.5005 - val_accuracy50: 0.4438 - 45s/epoch - 25ms/step
Epoch 19/50
1806/1806 - 47s - loss: 10.8469 - accuracy10: 0.5747 - accuracy20: 0.5728 - accuracy30: 0.5580 - accuracy50: 0.5260 - val_loss: 12.6153 - val_accuracy10: 0.5678 - val_accuracy20: 0.5345 - val_accuracy30: 0.5004 - val_accuracy50: 0.4383 - 47s/epoch - 26ms/step
testing model: results/ATVI/W5/deepLOB_L1/seq2seq
Evaluating performance on  test set...
8238/8238 - 90s - 90s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9992168
{'0': {'precision': 0.49768880895017525, 'recall': 0.25539644858038174, 'f1-score': 0.3375659077987392, 'support': 526550}, '1': {'precision': 0.6235702897998432, 'recall': 0.5669326093869396, 'f1-score': 0.5939041925456574, 'support': 1053485}, '2': {'precision': 0.3818087266154049, 'recall': 0.6360419082278661, 'f1-score': 0.47717482848926523, 'support': 528679}, 'accuracy': 0.5064679231038444, 'macro avg': {'precision': 0.5010226084551411, 'recall': 0.4861236553983958, 'f1-score': 0.46954830961122057, 'support': 2108714}, 'weighted avg': {'precision': 0.5315250170866264, 'recall': 0.5064679231038444, 'f1-score': 0.5006306204569536, 'support': 2108714}}
[[134479 208100 183971]
 [ 95755 597255 360475]
 [ 39973 152444 336262]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0581583
{'0': {'precision': 0.5484948134724739, 'recall': 0.21409733401629347, 'f1-score': 0.30797924597814075, 'support': 655968}, '1': {'precision': 0.4905345514181922, 'recall': 0.5764873550090295, 'f1-score': 0.5300490353276592, 'support': 798498}, '2': {'precision': 0.4352044784102431, 'recall': 0.6081592912779252, 'f1-score': 0.5073468234958092, 'support': 654248}, 'accuracy': 0.4735834257277184, 'macro avg': {'precision': 0.4914112811003031, 'recall': 0.4662479934344161, 'f1-score': 0.44845836826720303, 'support': 2108714}, 'weighted avg': {'precision': 0.49139786791057494, 'recall': 0.4735834257277184, 'f1-score': 0.4539251265061741, 'support': 2108714}}
[[140441 271189 244338]
 [ 66146 460324 272028]
 [ 49461 206900 397887]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.086626
{'0': {'precision': 0.5654005870203282, 'recall': 0.17679963668699877, 'f1-score': 0.26936833262725685, 'support': 735454}, '1': {'precision': 0.3988531470911717, 'recall': 0.5849181688286568, 'f1-score': 0.47429000755116, 'support': 641076}, '2': {'precision': 0.4592079062349177, 'recall': 0.588667602679108, 'f1-score': 0.5159407105043438, 'support': 732184}, 'accuracy': 0.44388096252028486, 'macro avg': {'precision': 0.4744872134488059, 'recall': 0.4501284693982545, 'f1-score': 0.41986635022758695, 'support': 2108714}, 'weighted avg': {'precision': 0.47789599968026747, 'recall': 0.44388096252028486, 'f1-score': 0.41728157150036777, 'support': 2108714}}
[[130028 316379 289047]
 [ 47558 374977 218541]
 [ 52389 248782 431013]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1250967
{'0': {'precision': 0.5680650270691473, 'recall': 0.13444718735987427, 'f1-score': 0.21743321627235343, 'support': 829612}, '1': {'precision': 0.2849880810118403, 'recall': 0.6009441852035435, 'f1-score': 0.3866253361964026, 'support': 457961}, '2': {'precision': 0.47894059126694477, 'recall': 0.5521621743403387, 'f1-score': 0.5129515448405381, 'support': 821141}, 'accuracy': 0.3984186570582829, 'macro avg': {'precision': 0.4439978997826441, 'recall': 0.4291845156345855, 'f1-score': 0.372336699103098, 'support': 2108714}, 'weighted avg': {'precision': 0.4718822684625242, 'recall': 0.3984186570582829, 'f1-score': 0.3692535239439226, 'support': 2108714}}
[[111539 378071 340002]
 [ 29478 275209 153274]
 [ 55332 312406 453403]]
Evaluating performance on  train set...
1806/1806 - 18s - 18s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8985736
{'0': {'precision': 0.4713866906170036, 'recall': 0.3140112433115842, 'f1-score': 0.37693178045624237, 'support': 88586}, '1': {'precision': 0.7741428033157498, 'recall': 0.5762173531989483, 'f1-score': 0.6606748799163937, 'support': 285250}, '2': {'precision': 0.334839020709315, 'recall': 0.7234254531456973, 'f1-score': 0.4577892885416555, 'support': 88327}, 'accuracy': 0.5540923873178943, 'macro avg': {'precision': 0.5267895048806895, 'recall': 0.5378846832187433, 'f1-score': 0.4984653163047639, 'support': 462163}, 'weighted avg': {'precision': 0.6321532061264254, 'recall': 0.5540923873178943, 'f1-score': 0.5675130693903814, 'support': 462163}}
[[ 27817  28591  32178]
 [ 26128 164366  94756]
 [  5066  19363  63898]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9424961
{'0': {'precision': 0.5420635627169945, 'recall': 0.26573273980972334, 'f1-score': 0.35663455061938093, 'support': 114570}, '1': {'precision': 0.6645469074255183, 'recall': 0.5970810115730819, 'f1-score': 0.6290100809410384, 'support': 233300}, '2': {'precision': 0.3983389600932871, 'recall': 0.6844426167831801, 'f1-score': 0.5035921667589386, 'support': 114293}, 'accuracy': 0.5365444659135413, 'macro avg': {'precision': 0.5349831434119333, 'recall': 0.5157521227219951, 'f1-score': 0.49641226610645256, 'support': 462163}, 'weighted avg': {'precision': 0.5683500640440744, 'recall': 0.5365444659135413, 'f1-score': 0.5304724347543748, 'support': 462163}}
[[ 30445  40986  43139]
 [ 18984 139299  75017]
 [  6736  29330  78227]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.978112
{'0': {'precision': 0.5748963766535113, 'recall': 0.21996266674760598, 'f1-score': 0.31818406335581667, 'support': 131786}, '1': {'precision': 0.5779388746234637, 'recall': 0.6139112700677128, 'f1-score': 0.5953822133126129, 'support': 199076}, '2': {'precision': 0.42868484518632066, 'recall': 0.6538716384490598, 'f1-score': 0.5178572505685006, 'support': 131301}, 'accuracy': 0.5129294210051432, 'macro avg': {'precision': 0.5271733654877653, 'recall': 0.4959151917547929, 'f1-score': 0.4771411757456434, 'support': 462163}, 'weighted avg': {'precision': 0.5346680763194142, 'recall': 0.5129294210051432, 'f1-score': 0.494314104174774, 'support': 462163}}
[[ 28988  51203  51595]
 [ 14037 122215  62824]
 [  7398  38049  85854]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0351452
{'0': {'precision': 0.592975446584125, 'recall': 0.1650342326266995, 'f1-score': 0.25820579994537896, 'support': 154677}, '1': {'precision': 0.4484939029683338, 'recall': 0.6367900049300709, 'f1-score': 0.52630732401691, 'support': 154156}, '2': {'precision': 0.45706337989482465, 'recall': 0.5968890628057132, 'f1-score': 0.5177010297906762, 'support': 153330}, 'accuracy': 0.4656647113680671, 'macro avg': {'precision': 0.49951090981576113, 'recall': 0.46623776678749457, 'f1-score': 0.43407138458432176, 'support': 462163}, 'weighted avg': {'precision': 0.4996921373986075, 'recall': 0.4656647113680671, 'f1-score': 0.43372366298709886, 'support': 462163}}
[[25527 67304 61846]
 [ 9121 98165 46870]
 [ 8401 53408 91521]]
Evaluating performance on  val set...
642/642 - 7s - 7s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.890072
{'0': {'precision': 0.48863915198508123, 'recall': 0.29589016671124185, 'f1-score': 0.3685866587695269, 'support': 33651}, '1': {'precision': 0.7451515001973944, 'recall': 0.6191720998892852, 'f1-score': 0.6763454345927302, 'support': 97548}, '2': {'precision': 0.3539728728394473, 'recall': 0.6720707665368475, 'f1-score': 0.4637128692246802, 'support': 33123}, 'accuracy': 0.5636311632039532, 'macro avg': {'precision': 0.5292545083406409, 'recall': 0.5290443443791248, 'f1-score': 0.5028816541956458, 'support': 164322}, 'weighted avg': {'precision': 0.6137697819632576, 'recall': 0.5636311632039532, 'f1-score': 0.5704593144876162, 'support': 164322}}
[[ 9957 11928 11766]
 [ 8287 60399 28862]
 [ 2133  8729 22261]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9409819
{'0': {'precision': 0.5508825786646201, 'recall': 0.2511898096304591, 'f1-score': 0.3450463875402586, 'support': 42864}, '1': {'precision': 0.6369964380675263, 'recall': 0.6409272743333796, 'f1-score': 0.6389558106620539, 'support': 79243}, '2': {'precision': 0.4120378199707895, 'recall': 0.6348691223498757, 'f1-score': 0.4997389520790602, 'support': 42215}, 'accuracy': 0.5377064544005064, 'macro avg': {'precision': 0.5333056122343119, 'recall': 0.5089954021045715, 'f1-score': 0.49458038342712424, 'support': 164322}, 'weighted avg': {'precision': 0.5567405226551049, 'recall': 0.5377064544005064, 'f1-score': 0.5265230676466712, 'support': 164322}}
[[10767 16390 15707]
 [ 5917 50789 22537]
 [ 2861 12553 26801]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.978546
{'0': {'precision': 0.5756044954024293, 'recall': 0.20847380971959542, 'f1-score': 0.30608795388005194, 'support': 48644}, '1': {'precision': 0.5547565337687101, 'recall': 0.6584517980503247, 'f1-score': 0.6021726484395081, 'support': 67601}, '2': {'precision': 0.43967683211217595, 'recall': 0.6078582274268362, 'f1-score': 0.5102667970386926, 'support': 48077}, 'accuracy': 0.5104429108701208, 'macro avg': {'precision': 0.5233459537611052, 'recall': 0.49159461173225205, 'f1-score': 0.4728424664527509, 'support': 164322}, 'weighted avg': {'precision': 0.527258337721738, 'recall': 0.5104429108701208, 'f1-score': 0.4876335027380975, 'support': 164322}}
[[10141 20018 18485]
 [ 4331 44512 18758]
 [ 3146 15707 29224]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0340092
{'0': {'precision': 0.5842154008997089, 'recall': 0.1576879810010178, 'f1-score': 0.2483443243015228, 'support': 56003}, '1': {'precision': 0.43366605291210386, 'recall': 0.678981906459811, 'f1-score': 0.5292804447138484, 'support': 52726}, '2': {'precision': 0.46451825846910916, 'recall': 0.556940622020758, 'f1-score': 0.5065482179521787, 'support': 55593}, 'accuracy': 0.46002969778848846, 'macro avg': {'precision': 0.494133237426974, 'recall': 0.4645368364938623, 'f1-score': 0.4280576623225167, 'support': 164322}, 'weighted avg': {'precision': 0.49541299975355196, 'recall': 0.46002969778848846, 'f1-score': 0.4258431798691352, 'support': 164322}}
[[ 8831 25615 21557]
 [ 2791 35800 14135]
 [ 3494 21137 30962]]
training model: results/ATVI/W5/deepOF_L1/seq2seq
Epoch 1/50
1806/1806 - 51s - loss: 12.6893 - accuracy10: 0.4275 - accuracy20: 0.4341 - accuracy30: 0.4339 - accuracy50: 0.4296 - val_loss: 13.9971 - val_accuracy10: 0.5837 - val_accuracy20: 0.4890 - val_accuracy30: 0.4196 - val_accuracy50: 0.3290 - 51s/epoch - 28ms/step
Epoch 2/50
1806/1806 - 41s - loss: 12.6709 - accuracy10: 0.4045 - accuracy20: 0.4164 - accuracy30: 0.4212 - accuracy50: 0.4238 - val_loss: 13.6547 - val_accuracy10: 0.5817 - val_accuracy20: 0.4961 - val_accuracy30: 0.4304 - val_accuracy50: 0.3421 - 41s/epoch - 23ms/step
Epoch 3/50
1806/1806 - 47s - loss: 12.6594 - accuracy10: 0.4012 - accuracy20: 0.4133 - accuracy30: 0.4194 - accuracy50: 0.4189 - val_loss: 13.5284 - val_accuracy10: 0.5834 - val_accuracy20: 0.5001 - val_accuracy30: 0.4365 - val_accuracy50: 0.3491 - 47s/epoch - 26ms/step
Epoch 4/50
1806/1806 - 45s - loss: 12.6189 - accuracy10: 0.4089 - accuracy20: 0.4172 - accuracy30: 0.4221 - accuracy50: 0.4210 - val_loss: 13.5349 - val_accuracy10: 0.5830 - val_accuracy20: 0.5005 - val_accuracy30: 0.4392 - val_accuracy50: 0.3548 - 45s/epoch - 25ms/step
Epoch 5/50
1806/1806 - 44s - loss: 12.5814 - accuracy10: 0.4189 - accuracy20: 0.4251 - accuracy30: 0.4279 - accuracy50: 0.4239 - val_loss: 13.5415 - val_accuracy10: 0.5843 - val_accuracy20: 0.5023 - val_accuracy30: 0.4414 - val_accuracy50: 0.3572 - 44s/epoch - 25ms/step
Epoch 6/50
1806/1806 - 48s - loss: 12.5415 - accuracy10: 0.4251 - accuracy20: 0.4321 - accuracy30: 0.4341 - accuracy50: 0.4288 - val_loss: 13.5823 - val_accuracy10: 0.5848 - val_accuracy20: 0.5018 - val_accuracy30: 0.4408 - val_accuracy50: 0.3574 - 48s/epoch - 26ms/step
Epoch 7/50
1806/1806 - 50s - loss: 12.4981 - accuracy10: 0.4353 - accuracy20: 0.4399 - accuracy30: 0.4405 - accuracy50: 0.4333 - val_loss: 13.6818 - val_accuracy10: 0.5860 - val_accuracy20: 0.5023 - val_accuracy30: 0.4413 - val_accuracy50: 0.3595 - 50s/epoch - 28ms/step
Epoch 8/50
1806/1806 - 46s - loss: 12.4539 - accuracy10: 0.4462 - accuracy20: 0.4486 - accuracy30: 0.4468 - accuracy50: 0.4371 - val_loss: 13.7167 - val_accuracy10: 0.5872 - val_accuracy20: 0.5032 - val_accuracy30: 0.4427 - val_accuracy50: 0.3599 - 46s/epoch - 25ms/step
Epoch 9/50
1806/1806 - 44s - loss: 12.4104 - accuracy10: 0.4524 - accuracy20: 0.4538 - accuracy30: 0.4512 - accuracy50: 0.4418 - val_loss: 13.7452 - val_accuracy10: 0.5880 - val_accuracy20: 0.5026 - val_accuracy30: 0.4414 - val_accuracy50: 0.3581 - 44s/epoch - 24ms/step
Epoch 10/50
1806/1806 - 41s - loss: 12.3755 - accuracy10: 0.4541 - accuracy20: 0.4568 - accuracy30: 0.4541 - accuracy50: 0.4443 - val_loss: 13.7773 - val_accuracy10: 0.5874 - val_accuracy20: 0.5034 - val_accuracy30: 0.4425 - val_accuracy50: 0.3603 - 41s/epoch - 23ms/step
Epoch 11/50
1806/1806 - 47s - loss: 12.3408 - accuracy10: 0.4562 - accuracy20: 0.4598 - accuracy30: 0.4573 - accuracy50: 0.4474 - val_loss: 13.6842 - val_accuracy10: 0.5857 - val_accuracy20: 0.5046 - val_accuracy30: 0.4454 - val_accuracy50: 0.3642 - 47s/epoch - 26ms/step
Epoch 12/50
1806/1806 - 47s - loss: 12.3087 - accuracy10: 0.4599 - accuracy20: 0.4636 - accuracy30: 0.4610 - accuracy50: 0.4510 - val_loss: 13.6364 - val_accuracy10: 0.5840 - val_accuracy20: 0.5047 - val_accuracy30: 0.4461 - val_accuracy50: 0.3649 - 47s/epoch - 26ms/step
Epoch 13/50
1806/1806 - 48s - loss: 12.2810 - accuracy10: 0.4615 - accuracy20: 0.4658 - accuracy30: 0.4631 - accuracy50: 0.4525 - val_loss: 13.6959 - val_accuracy10: 0.5849 - val_accuracy20: 0.5047 - val_accuracy30: 0.4461 - val_accuracy50: 0.3660 - 48s/epoch - 26ms/step
testing model: results/ATVI/W5/deepOF_L1/seq2seq
Evaluating performance on  test set...
8238/8238 - 81s - 81s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0244746
{'0': {'precision': 0.42624010215124924, 'recall': 0.1039692336910075, 'f1-score': 0.1671636230948095, 'support': 526550}, '1': {'precision': 0.5154574509227259, 'recall': 0.8767650956255624, 'f1-score': 0.6492282464030578, 'support': 1053484}, '2': {'precision': 0.419393373081395, 'recall': 0.14941883009410317, 'f1-score': 0.22033728111036108, 'support': 528675}, 'accuracy': 0.5014428259186071, 'macro avg': {'precision': 0.4536969753851234, 'recall': 0.37671771980355767, 'f1-score': 0.3455763835360761, 'support': 2108709}, 'weighted avg': {'precision': 0.46909540127605265, 'recall': 0.5014428259186071, 'f1-score': 0.4213281148632984, 'support': 2108709}}
[[ 54745 442415  29390]
 [ 49857 923658  79969]
 [ 23835 425846  78994]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0951827
{'0': {'precision': 0.4861515350671298, 'recall': 0.07893701807715643, 'f1-score': 0.13582066845382673, 'support': 655966}, '1': {'precision': 0.3879694723900885, 'recall': 0.8979119520799702, 'f1-score': 0.5418266718407394, 'support': 798497}, '2': {'precision': 0.48884651060213924, 'recall': 0.11519214485071365, 'f1-score': 0.18644925304268983, 'support': 654246}, 'accuracy': 0.40030369292301593, 'macro avg': {'precision': 0.4543225060197858, 'recall': 0.3640137050026135, 'f1-score': 0.28803219777908534, 'support': 2108709}, 'weighted avg': {'precision': 0.44980943877145707, 'recall': 0.40030369292301593, 'f1-score': 0.30526942816385066, 'support': 2108709}}
[[ 51780 574743  29443]
 [ 32157 716980  49360]
 [ 22573 556309  75364]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1351683
{'0': {'precision': 0.5118773670837529, 'recall': 0.05807177082936752, 'f1-score': 0.1043097468762517, 'support': 735452}, '1': {'precision': 0.3090900675786906, 'recall': 0.9167180127130211, 'f1-score': 0.46230472299161346, 'support': 641075}, '2': {'precision': 0.5228428034276308, 'recall': 0.0884998538614716, 'f1-score': 0.15137668259908704, 'support': 732182}, 'accuracy': 0.329676593593521, 'macro avg': {'precision': 0.44793674603002476, 'recall': 0.3544298791346201, 'f1-score': 0.23933038415565075, 'support': 2108709}, 'weighted avg': {'precision': 0.45403478524003976, 'recall': 0.329676593593521, 'f1-score': 0.22948737567404817, 'support': 2108709}}
[[ 42709 665952  26791]
 [ 21045 587685  32345]
 [ 19682 647702  64798]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1814774
{'0': {'precision': 0.5316221732911168, 'recall': 0.03987063769876858, 'f1-score': 0.07417806368275462, 'support': 829608}, '1': {'precision': 0.2195000937356347, 'recall': 0.9331777160063848, 'f1-score': 0.35540303527010814, 'support': 457961}, '2': {'precision': 0.5548053252951519, 'recall': 0.06724431887376087, 'f1-score': 0.11995025334948108, 'support': 821140}, 'accuracy': 0.24453492634593013, 'macro avg': {'precision': 0.4353091974406345, 'recall': 0.34676422419297137, 'f1-score': 0.1831771174341146, 'support': 2108709}, 'weighted avg': {'precision': 0.47286436164488455, 'recall': 0.24453492634593013, 'f1-score': 0.15307725984308387, 'support': 2108709}}
[[ 33077 770950  25581]
 [ 11875 427359  18727]
 [ 17267 748656  55217]]
Evaluating performance on  train set...
1806/1806 - 17s - 17s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9469516
{'0': {'precision': 0.4115748136315229, 'recall': 0.1396880259338326, 'f1-score': 0.2085831625639858, 'support': 88533}, '1': {'precision': 0.6397898277454203, 'recall': 0.8694989167852711, 'f1-score': 0.73716386504672, 'support': 285262}, '2': {'precision': 0.37850551429214496, 'recall': 0.19031290669382675, 'f1-score': 0.2532776083436877, 'support': 88365}, 'accuracy': 0.5998333910334084, 'macro avg': {'precision': 0.4766233852230293, 'recall': 0.3998332831376435, 'f1-score': 0.3996748786514645, 'support': 462160}, 'weighted avg': {'precision': 0.5461145892937058, 'recall': 0.5998333910334084, 'f1-score': 0.5433880203036281, 'support': 462160}}
[[ 12367  71498   4668]
 [ 14282 248035  22945]
 [  3399  68149  16817]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0104308
{'0': {'precision': 0.49788278127349717, 'recall': 0.10994302293064877, 'f1-score': 0.18011324185224156, 'support': 114432}, '1': {'precision': 0.5231139594651746, 'recall': 0.8956221454829008, 'f1-score': 0.6604645431581542, 'support': 233402}, '2': {'precision': 0.4685387833923399, 'recall': 0.1527998880394661, 'f1-score': 0.23044654046566848, 'support': 114326}, 'accuracy': 0.517331660031158, 'macro avg': {'precision': 0.4965118413770038, 'recall': 0.38612168548433856, 'f1-score': 0.3570081084920214, 'support': 462160}, 'weighted avg': {'precision': 0.5033662189369312, 'recall': 0.517331660031158, 'f1-score': 0.4351533992104752, 'support': 462160}}
[[ 12581  97089   4762]
 [  9309 209040  15053]
 [  3379  93478  17469]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0518862
{'0': {'precision': 0.541259017689495, 'recall': 0.08318209086698003, 'f1-score': 0.14420273161099226, 'support': 131687}, '1': {'precision': 0.4441386620507572, 'recall': 0.9173064466727255, 'f1-score': 0.5984982505798639, 'support': 199157}, '2': {'precision': 0.5178974208100422, 'recall': 0.12064790276889335, 'f1-score': 0.19570494172580555, 'support': 131316}, 'accuracy': 0.45327375800588543, 'macro avg': {'precision': 0.5010983668500981, 'recall': 0.37371214676953296, 'f1-score': 0.31280197463888726, 'support': 462160}, 'weighted avg': {'precision': 0.49276942507272525, 'recall': 0.45327375800588543, 'f1-score': 0.35460431741400505, 'support': 462160}}
[[ 10954 116201   4532]
 [  6253 182688  10216]
 [  3031 112442  15843]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1061022
{'0': {'precision': 0.578889392859457, 'recall': 0.05779531634105318, 'f1-score': 0.10509784545887667, 'support': 154580}, '1': {'precision': 0.34143168261927725, 'recall': 0.9343393730301812, 'f1-score': 0.5001102084240889, 'support': 154202}, '2': {'precision': 0.559115888152578, 'recall': 0.09021502431900273, 'f1-score': 0.15536193481019056, 'support': 153378}, 'accuracy': 0.3610178293231781, 'macro avg': {'precision': 0.49314565454377074, 'recall': 0.3607832378967457, 'f1-score': 0.2535233295643854, 'support': 462160}, 'weighted avg': {'precision': 0.4930981637626336, 'recall': 0.3610178293231781, 'f1-score': 0.25357694769725186, 'support': 462160}}
[[  8934 141116   4530]
 [  3744 144077   6381]
 [  2755 136786  13837]]
Evaluating performance on  val set...
642/642 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.96159333
{'0': {'precision': 0.4245173541512818, 'recall': 0.11941361505133836, 'f1-score': 0.18639553465965678, 'support': 33698}, '1': {'precision': 0.6152700455498518, 'recall': 0.873167177992797, 'f1-score': 0.7218760736144277, 'support': 97459}, '2': {'precision': 0.40367749349785276, 'recall': 0.2012362430272878, 'f1-score': 0.26858223670972675, 'support': 33165}, 'accuracy': 0.5829773250082155, 'macro avg': {'precision': 0.48115496439966216, 'recall': 0.3979390120238077, 'f1-score': 0.39228461499460376, 'support': 164322}, 'weighted avg': {'precision': 0.5334462411684935, 'recall': 0.5829773250082155, 'f1-score': 0.5205754972908541, 'support': 164322}}
[[ 4024 27883  1791]
 [ 4293 85098  8068]
 [ 1162 25329  6674]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.026626
{'0': {'precision': 0.5054917308420654, 'recall': 0.0934924230041796, 'f1-score': 0.15779932214077402, 'support': 42827}, '1': {'precision': 0.5008248913600528, 'recall': 0.9002561740469189, 'f1-score': 0.6436040164917947, 'support': 79243}, '2': {'precision': 0.4928356498065625, 'recall': 0.16280886111900028, 'f1-score': 0.24476071873332145, 'support': 42252}, 'accuracy': 0.5003712223561056, 'macro avg': {'precision': 0.4997174240028936, 'recall': 0.3855191527233663, 'f1-score': 0.34872135245529673, 'support': 164322}, 'weighted avg': {'precision': 0.49998693478928374, 'recall': 0.5003712223561056, 'f1-score': 0.4144351610624415, 'support': 164322}}
[[ 4004 36911  1912]
 [ 2737 71339  5167]
 [ 1180 34193  6879]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.067736
{'0': {'precision': 0.5376344086021505, 'recall': 0.06891727869324611, 'f1-score': 0.12217359591539022, 'support': 48609}, '1': {'precision': 0.42478901659236235, 'recall': 0.9215866067203029, 'f1-score': 0.581531426438337, 'support': 67616}, '2': {'precision': 0.5375098710186891, 'recall': 0.12736761128552718, 'f1-score': 0.2059367331159445, 'support': 48097}, 'accuracy': 0.4368861138496367, 'macro avg': {'precision': 0.49997776540440064, 'recall': 0.37262383223302536, 'f1-score': 0.3032139184898906, 'support': 164322}, 'weighted avg': {'precision': 0.491163796570374, 'recall': 0.4368861138496367, 'f1-score': 0.3357097911818465, 'support': 164322}}
[[ 3350 43467  1792]
 [ 1823 62314  3479]
 [ 1058 40913  6126]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1188663
{'0': {'precision': 0.5667095667095667, 'recall': 0.04718446948725734, 'f1-score': 0.08711565410930674, 'support': 55993}, '1': {'precision': 0.32873260599291276, 'recall': 0.9378971528291508, 'f1-score': 0.48683109338847047, 'support': 52719}, '2': {'precision': 0.5721699643204671, 'recall': 0.09516274051429599, 'f1-score': 0.1631847546215637, 'support': 55610}, 'accuracy': 0.34918635362276507, 'macro avg': {'precision': 0.4892040456743156, 'recall': 0.36008145427690136, 'f1-score': 0.24571050070644695, 'support': 164322}, 'weighted avg': {'precision': 0.4922079498787156, 'recall': 0.34918635362276507, 'f1-score': 0.24109869303802497, 'support': 164322}}
[[ 2642 51603  1748]
 [ 1065 49445  2209]
 [  955 49363  5292]]
training model: results/ATVI/W5/deepLOB_L2/seq2seq
Epoch 1/50
1806/1806 - 94s - loss: 12.1450 - accuracy10: 0.4591 - accuracy20: 0.4692 - accuracy30: 0.4704 - accuracy50: 0.4609 - val_loss: 12.5150 - val_accuracy10: 0.4465 - val_accuracy20: 0.4618 - val_accuracy30: 0.4630 - val_accuracy50: 0.4496 - 94s/epoch - 52ms/step
Epoch 2/50
1806/1806 - 87s - loss: 11.6217 - accuracy10: 0.5009 - accuracy20: 0.5121 - accuracy30: 0.5097 - accuracy50: 0.4904 - val_loss: 12.8375 - val_accuracy10: 0.5850 - val_accuracy20: 0.5185 - val_accuracy30: 0.4698 - val_accuracy50: 0.3975 - 87s/epoch - 48ms/step
Epoch 3/50
1806/1806 - 87s - loss: 11.2015 - accuracy10: 0.5524 - accuracy20: 0.5517 - accuracy30: 0.5397 - accuracy50: 0.5120 - val_loss: 11.8514 - val_accuracy10: 0.5819 - val_accuracy20: 0.5527 - val_accuracy30: 0.5253 - val_accuracy50: 0.4788 - 87s/epoch - 48ms/step
Epoch 4/50
1806/1806 - 88s - loss: 10.9821 - accuracy10: 0.5711 - accuracy20: 0.5683 - accuracy30: 0.5539 - accuracy50: 0.5218 - val_loss: 11.5913 - val_accuracy10: 0.5628 - val_accuracy20: 0.5520 - val_accuracy30: 0.5335 - val_accuracy50: 0.4985 - 88s/epoch - 49ms/step
Epoch 5/50
1806/1806 - 86s - loss: 10.8699 - accuracy10: 0.5785 - accuracy20: 0.5755 - accuracy30: 0.5593 - accuracy50: 0.5261 - val_loss: 11.5994 - val_accuracy10: 0.5498 - val_accuracy20: 0.5387 - val_accuracy30: 0.5207 - val_accuracy50: 0.4899 - 86s/epoch - 48ms/step
Epoch 6/50
1806/1806 - 85s - loss: 10.7965 - accuracy10: 0.5809 - accuracy20: 0.5785 - accuracy30: 0.5632 - accuracy50: 0.5294 - val_loss: 11.5169 - val_accuracy10: 0.5563 - val_accuracy20: 0.5469 - val_accuracy30: 0.5302 - val_accuracy50: 0.4961 - 85s/epoch - 47ms/step
Epoch 7/50
1806/1806 - 85s - loss: 10.7386 - accuracy10: 0.5830 - accuracy20: 0.5812 - accuracy30: 0.5654 - accuracy50: 0.5316 - val_loss: 11.5566 - val_accuracy10: 0.5354 - val_accuracy20: 0.5331 - val_accuracy30: 0.5194 - val_accuracy50: 0.4925 - 85s/epoch - 47ms/step
Epoch 8/50
1806/1806 - 85s - loss: 10.6990 - accuracy10: 0.5847 - accuracy20: 0.5826 - accuracy30: 0.5675 - accuracy50: 0.5337 - val_loss: 11.5523 - val_accuracy10: 0.5362 - val_accuracy20: 0.5321 - val_accuracy30: 0.5200 - val_accuracy50: 0.4938 - 85s/epoch - 47ms/step
Epoch 9/50
1806/1806 - 85s - loss: 10.6616 - accuracy10: 0.5865 - accuracy20: 0.5846 - accuracy30: 0.5695 - accuracy50: 0.5352 - val_loss: 11.6199 - val_accuracy10: 0.5221 - val_accuracy20: 0.5217 - val_accuracy30: 0.5122 - val_accuracy50: 0.4901 - 85s/epoch - 47ms/step
Epoch 10/50
1806/1806 - 85s - loss: 10.6317 - accuracy10: 0.5879 - accuracy20: 0.5857 - accuracy30: 0.5707 - accuracy50: 0.5367 - val_loss: 11.5878 - val_accuracy10: 0.5215 - val_accuracy20: 0.5242 - val_accuracy30: 0.5157 - val_accuracy50: 0.4928 - 85s/epoch - 47ms/step
Epoch 11/50
1806/1806 - 84s - loss: 10.5965 - accuracy10: 0.5904 - accuracy20: 0.5880 - accuracy30: 0.5727 - accuracy50: 0.5383 - val_loss: 11.6643 - val_accuracy10: 0.5252 - val_accuracy20: 0.5230 - val_accuracy30: 0.5133 - val_accuracy50: 0.4903 - 84s/epoch - 47ms/step
Epoch 12/50
1806/1806 - 84s - loss: 10.5703 - accuracy10: 0.5912 - accuracy20: 0.5885 - accuracy30: 0.5733 - accuracy50: 0.5394 - val_loss: 11.5700 - val_accuracy10: 0.5189 - val_accuracy20: 0.5240 - val_accuracy30: 0.5165 - val_accuracy50: 0.4940 - 84s/epoch - 47ms/step
Epoch 13/50
1806/1806 - 85s - loss: 10.5436 - accuracy10: 0.5920 - accuracy20: 0.5895 - accuracy30: 0.5745 - accuracy50: 0.5409 - val_loss: 11.6243 - val_accuracy10: 0.5217 - val_accuracy20: 0.5245 - val_accuracy30: 0.5165 - val_accuracy50: 0.4931 - 85s/epoch - 47ms/step
Epoch 14/50
1806/1806 - 85s - loss: 10.5235 - accuracy10: 0.5934 - accuracy20: 0.5913 - accuracy30: 0.5761 - accuracy50: 0.5419 - val_loss: 11.8126 - val_accuracy10: 0.5175 - val_accuracy20: 0.5182 - val_accuracy30: 0.5081 - val_accuracy50: 0.4846 - 85s/epoch - 47ms/step
Epoch 15/50
1806/1806 - 86s - loss: 10.4993 - accuracy10: 0.5943 - accuracy20: 0.5922 - accuracy30: 0.5771 - accuracy50: 0.5434 - val_loss: 11.7774 - val_accuracy10: 0.5027 - val_accuracy20: 0.5076 - val_accuracy30: 0.5020 - val_accuracy50: 0.4830 - 86s/epoch - 48ms/step
Epoch 16/50
1806/1806 - 85s - loss: 10.4790 - accuracy10: 0.5951 - accuracy20: 0.5931 - accuracy30: 0.5784 - accuracy50: 0.5440 - val_loss: 11.8015 - val_accuracy10: 0.5177 - val_accuracy20: 0.5191 - val_accuracy30: 0.5100 - val_accuracy50: 0.4863 - 85s/epoch - 47ms/step
testing model: results/ATVI/W5/deepLOB_L2/seq2seq
Evaluating performance on  test set...
8238/8238 - 130s - 130s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.99090797
{'0': {'precision': 0.4995748709537363, 'recall': 0.3146728705725952, 'f1-score': 0.3861297997935247, 'support': 526550}, '1': {'precision': 0.6766969206081983, 'recall': 0.5051718818967522, 'f1-score': 0.5784876563842606, 'support': 1053485}, '2': {'precision': 0.379069772137178, 'recall': 0.7102703152574624, 'f1-score': 0.4943213045696138, 'support': 528679}, 'accuracy': 0.5090244575603899, 'macro avg': {'precision': 0.5184471878997042, 'recall': 0.5100383559089366, 'f1-score': 0.48631292024913303, 'support': 2108714}, 'weighted avg': {'precision': 0.5578506292324749, 'recall': 0.5090244575603899, 'f1-score': 0.5093540459947683, 'support': 2108714}}
[[165691 158929 201930]
 [108133 532191 413161]
 [ 57840  95334 375505]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0273582
{'0': {'precision': 0.5515916863983162, 'recall': 0.2716763622615737, 'f1-score': 0.3640477073253439, 'support': 655968}, '1': {'precision': 0.5476471308162719, 'recall': 0.5099536880493126, 'f1-score': 0.5281287024889805, 'support': 798498}, '2': {'precision': 0.4324386569298237, 'recall': 0.6887907949279173, 'f1-score': 0.5313092084242644, 'support': 654248}, 'accuracy': 0.4913174569903742, 'macro avg': {'precision': 0.5105591580481373, 'recall': 0.4901402817462679, 'f1-score': 0.47449520607952955, 'support': 2108714}, 'weighted avg': {'precision': 0.5131296896709965, 'recall': 0.4913174569903742, 'f1-score': 0.4780740044178562, 'support': 2108714}}
[[178211 203852 273905]
 [ 73756 407197 317545]
 [ 71118 132490 450640]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.04781
{'0': {'precision': 0.5658358457468315, 'recall': 0.24166433250753955, 'f1-score': 0.33868064838537254, 'support': 735454}, '1': {'precision': 0.4563079977677257, 'recall': 0.5076262408825163, 'f1-score': 0.4806010707033413, 'support': 641076}, '2': {'precision': 0.45662468225031044, 'recall': 0.6744329294275756, 'f1-score': 0.5445570922636919, 'support': 732184}, 'accuracy': 0.4727853089608169, 'macro avg': {'precision': 0.4929228419216225, 'recall': 0.47457450093921044, 'f1-score': 0.45461293711746853, 'support': 2108714}, 'weighted avg': {'precision': 0.4946178706185827, 'recall': 0.4727853089608169, 'f1-score': 0.453310330192634, 'support': 2108714}}
[[177733 229323 328398]
 [ 56423 325427 259226]
 [ 79951 158424 493809]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0774281
{'0': {'precision': 0.564160787089377, 'recall': 0.21233178883622705, 'f1-score': 0.30853938035698175, 'support': 829612}, '1': {'precision': 0.3360517116630199, 'recall': 0.5050582909898441, 'f1-score': 0.4035755195905915, 'support': 457961}, '2': {'precision': 0.47757212842121033, 'recall': 0.6445226824625734, 'f1-score': 0.5486275603341664, 'support': 821141}, 'accuracy': 0.4442015370505436, 'macro avg': {'precision': 0.4592615423912025, 'recall': 0.4539709207628815, 'f1-score': 0.4202474867605799, 'support': 2108714}, 'weighted avg': {'precision': 0.4809031437774974, 'recall': 0.4442015370505436, 'f1-score': 0.4226701223894283, 'support': 2108714}}
[[176153 261263 392196]
 [ 39907 231297 186757]
 [ 96179 195718 529244]]
Evaluating performance on  train set...
1806/1806 - 29s - 29s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9067596
{'0': {'precision': 0.4464698896955303, 'recall': 0.4116790463504391, 'f1-score': 0.4283692275164593, 'support': 88586}, '1': {'precision': 0.8090435275645499, 'recall': 0.5202383873794917, 'f1-score': 0.6332674737664133, 'support': 285250}, '2': {'precision': 0.33528540110425464, 'recall': 0.7480158954792985, 'f1-score': 0.4630268796669739, 'support': 88327}, 'accuracy': 0.54296211509792, 'macro avg': {'precision': 0.5302662727881117, 'recall': 0.5599777764030764, 'f1-score': 0.5082211936499489, 'support': 462163}, 'weighted avg': {'precision': 0.6490034933772102, 'recall': 0.54296211509792, 'f1-score': 0.5614574045974845, 'support': 462163}}
[[ 36469  22488  29629]
 [ 35495 148398 101357]
 [  9719  12538  66070]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9265474
{'0': {'precision': 0.5160455551249515, 'recall': 0.3602950161473335, 'f1-score': 0.4243296446872703, 'support': 114570}, '1': {'precision': 0.7086306528401316, 'recall': 0.5371924560651522, 'f1-score': 0.6111157163824672, 'support': 233300}, '2': {'precision': 0.39820957168045046, 'recall': 0.7153368972727988, 'f1-score': 0.5116158281889946, 'support': 114293}, 'accuracy': 0.5373948152491653, 'macro avg': {'precision': 0.5409619265485112, 'recall': 0.5376081231617614, 'f1-score': 0.515687063086244, 'support': 462163}, 'weighted avg': {'precision': 0.5841216997776587, 'recall': 0.5373948152491653, 'f1-score': 0.5402051914044502, 'support': 462163}}
[[ 41279  32086  41205]
 [ 25622 125327  82351]
 [ 13090  19445  81758]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9526324
{'0': {'precision': 0.5444501409894899, 'recall': 0.32232558845400877, 'f1-score': 0.404926455868755, 'support': 131786}, '1': {'precision': 0.6266470516689159, 'recall': 0.5434859048805482, 'f1-score': 0.5821113541170679, 'support': 199076}, '2': {'precision': 0.4280661604077811, 'recall': 0.6894844669880655, 'f1-score': 0.5281997275275899, 'support': 131301}, 'accuracy': 0.5219002819351614, 'macro avg': {'precision': 0.5330544510220623, 'recall': 0.5184319867742074, 'f1-score': 0.5050791791711376, 'support': 462163}, 'weighted avg': {'precision': 0.546791520883723, 'recall': 0.5219002819351614, 'f1-score': 0.5162706453554898, 'support': 462163}}
[[ 42478  39160  50148]
 [ 20073 108195  70808]
 [ 15469  25302  90530]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9975636
{'0': {'precision': 0.5610079234410372, 'recall': 0.28197469565610916, 'f1-score': 0.3753103204959965, 'support': 154677}, '1': {'precision': 0.4978965866127057, 'recall': 0.5458756065284517, 'f1-score': 0.5207833720645981, 'support': 154156}, '2': {'precision': 0.4573507019237911, 'recall': 0.6425161416552534, 'f1-score': 0.534346880440855, 'support': 153330}, 'accuracy': 0.48961513578542637, 'macro avg': {'precision': 0.5054184039925113, 'recall': 0.49012214794660475, 'f1-score': 0.4768135243338166, 'support': 462163}, 'weighted avg': {'precision': 0.5055669794118796, 'recall': 0.48961513578542637, 'f1-score': 0.47659627258206677, 'support': 462163}}
[[43615 49525 61537]
 [14652 84150 55354]
 [19477 35336 98517]]
Evaluating performance on  val set...
642/642 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8960912
{'0': {'precision': 0.4507042253521127, 'recall': 0.4659594068526938, 'f1-score': 0.4582048771934951, 'support': 33651}, '1': {'precision': 0.80116465015237, 'recall': 0.5444089063845492, 'f1-score': 0.648290342663916, 'support': 97548}, '2': {'precision': 0.35829933908863804, 'recall': 0.6841469673640672, 'f1-score': 0.47029646463074226, 'support': 33123}, 'accuracy': 0.5565109967015981, 'macro avg': {'precision': 0.5367227381977069, 'recall': 0.5648384268671034, 'f1-score': 0.5255972281627178, 'support': 164322}, 'weighted avg': {'precision': 0.6401249144303276, 'recall': 0.5565109967015981, 'f1-score': 0.5734844297573184, 'support': 164322}}
[[15680  7919 10052]
 [13909 53106 30533]
 [ 5201  5261 22661]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.91728854
{'0': {'precision': 0.5139450282942603, 'recall': 0.41529022023142964, 'f1-score': 0.45938064516129035, 'support': 42864}, '1': {'precision': 0.7035697436703884, 'recall': 0.5645924561159976, 'f1-score': 0.6264658727324919, 'support': 79243}, '2': {'precision': 0.41699951585572503, 'recall': 0.6528958900864622, 'f1-score': 0.5089418433954077, 'support': 42215}, 'accuracy': 0.5483319336424824, 'macro avg': {'precision': 0.5448380959401246, 'recall': 0.5442595221446299, 'f1-score': 0.53159612042973, 'support': 164322}, 'weighted avg': {'precision': 0.5804843627288323, 'recall': 0.5483319336424824, 'f1-score': 0.5526886664358488, 'support': 164322}}
[[17801 11134 13929]
 [ 9898 44740 24605]
 [ 6937  7716 27562]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9442454
{'0': {'precision': 0.5358529940293316, 'recall': 0.3800674286654058, 'f1-score': 0.444711711928415, 'support': 48644}, '1': {'precision': 0.6241598753206273, 'recall': 0.5687341903226284, 'f1-score': 0.5951594052585547, 'support': 67601}, '2': {'precision': 0.44202749846090705, 'recall': 0.6272437964099258, 'f1-score': 0.518594312934763, 'support': 48077}, 'accuracy': 0.5300020691082143, 'macro avg': {'precision': 0.5340134559369553, 'recall': 0.52534847179932, 'f1-score': 0.5194884767072442, 'support': 164322}, 'weighted avg': {'precision': 0.5447305949088836, 'recall': 0.5300020691082143, 'f1-score': 0.5282213352618272, 'support': 164322}}
[[18488 13450 16706]
 [ 7794 38447 21360]
 [ 8220  9701 30156]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9860204
{'0': {'precision': 0.5455685023218712, 'recall': 0.3419459671803296, 'f1-score': 0.4203986652616789, 'support': 56003}, '1': {'precision': 0.5034823371839946, 'recall': 0.5703637674012821, 'f1-score': 0.5348402930924094, 'support': 52726}, '2': {'precision': 0.4677440244060382, 'recall': 0.58467792707715, 'f1-score': 0.5197147516868664, 'support': 55593}, 'accuracy': 0.4973588442204939, 'macro avg': {'precision': 0.5055982879706347, 'recall': 0.49899588721958726, 'f1-score': 0.49165123668031824, 'support': 164322}, 'weighted avg': {'precision': 0.5057349356428228, 'recall': 0.4973588442204939, 'f1-score': 0.49071991537814863, 'support': 164322}}
[[19150 16831 20022]
 [ 5688 30073 16965]
 [10263 12826 32504]]
training model: results/ATVI/W5/deepOF_L2/seq2seq
Epoch 1/50
1806/1806 - 59s - loss: 11.6678 - accuracy10: 0.5200 - accuracy20: 0.5227 - accuracy30: 0.5125 - accuracy50: 0.4875 - val_loss: 11.5981 - val_accuracy10: 0.5913 - val_accuracy20: 0.5778 - val_accuracy30: 0.5533 - val_accuracy50: 0.5019 - 59s/epoch - 33ms/step
Epoch 2/50
1806/1806 - 52s - loss: 11.0462 - accuracy10: 0.5704 - accuracy20: 0.5676 - accuracy30: 0.5520 - accuracy50: 0.5199 - val_loss: 11.5387 - val_accuracy10: 0.6049 - val_accuracy20: 0.5866 - val_accuracy30: 0.5594 - val_accuracy50: 0.5042 - 52s/epoch - 29ms/step
Epoch 3/50
1806/1806 - 52s - loss: 10.9331 - accuracy10: 0.5767 - accuracy20: 0.5733 - accuracy30: 0.5578 - accuracy50: 0.5248 - val_loss: 11.4660 - val_accuracy10: 0.6040 - val_accuracy20: 0.5872 - val_accuracy30: 0.5595 - val_accuracy50: 0.5047 - 52s/epoch - 29ms/step
Epoch 4/50
1806/1806 - 52s - loss: 10.8691 - accuracy10: 0.5812 - accuracy20: 0.5770 - accuracy30: 0.5605 - accuracy50: 0.5277 - val_loss: 11.4515 - val_accuracy10: 0.5987 - val_accuracy20: 0.5848 - val_accuracy30: 0.5600 - val_accuracy50: 0.5046 - 52s/epoch - 29ms/step
Epoch 5/50
1806/1806 - 52s - loss: 10.8176 - accuracy10: 0.5837 - accuracy20: 0.5792 - accuracy30: 0.5631 - accuracy50: 0.5292 - val_loss: 11.4053 - val_accuracy10: 0.6029 - val_accuracy20: 0.5866 - val_accuracy30: 0.5604 - val_accuracy50: 0.5054 - 52s/epoch - 29ms/step
Epoch 6/50
1806/1806 - 53s - loss: 10.7720 - accuracy10: 0.5862 - accuracy20: 0.5810 - accuracy30: 0.5652 - accuracy50: 0.5309 - val_loss: 11.2829 - val_accuracy10: 0.6031 - val_accuracy20: 0.5910 - val_accuracy30: 0.5665 - val_accuracy50: 0.5126 - 53s/epoch - 29ms/step
Epoch 7/50
1806/1806 - 53s - loss: 10.7344 - accuracy10: 0.5883 - accuracy20: 0.5832 - accuracy30: 0.5668 - accuracy50: 0.5328 - val_loss: 11.2221 - val_accuracy10: 0.6005 - val_accuracy20: 0.5880 - val_accuracy30: 0.5641 - val_accuracy50: 0.5110 - 53s/epoch - 29ms/step
Epoch 8/50
1806/1806 - 53s - loss: 10.6959 - accuracy10: 0.5900 - accuracy20: 0.5849 - accuracy30: 0.5682 - accuracy50: 0.5341 - val_loss: 11.2254 - val_accuracy10: 0.6050 - val_accuracy20: 0.5915 - val_accuracy30: 0.5669 - val_accuracy50: 0.5125 - 53s/epoch - 29ms/step
Epoch 9/50
1806/1806 - 51s - loss: 10.6659 - accuracy10: 0.5915 - accuracy20: 0.5859 - accuracy30: 0.5691 - accuracy50: 0.5354 - val_loss: 11.2008 - val_accuracy10: 0.6003 - val_accuracy20: 0.5879 - val_accuracy30: 0.5642 - val_accuracy50: 0.5123 - 51s/epoch - 28ms/step
Epoch 10/50
1806/1806 - 53s - loss: 10.6372 - accuracy10: 0.5919 - accuracy20: 0.5868 - accuracy30: 0.5709 - accuracy50: 0.5366 - val_loss: 11.2250 - val_accuracy10: 0.6026 - val_accuracy20: 0.5909 - val_accuracy30: 0.5671 - val_accuracy50: 0.5136 - 53s/epoch - 29ms/step
Epoch 11/50
1806/1806 - 53s - loss: 10.6118 - accuracy10: 0.5922 - accuracy20: 0.5884 - accuracy30: 0.5722 - accuracy50: 0.5380 - val_loss: 11.2207 - val_accuracy10: 0.5993 - val_accuracy20: 0.5891 - val_accuracy30: 0.5660 - val_accuracy50: 0.5133 - 53s/epoch - 29ms/step
Epoch 12/50
1806/1806 - 52s - loss: 10.5875 - accuracy10: 0.5929 - accuracy20: 0.5889 - accuracy30: 0.5723 - accuracy50: 0.5392 - val_loss: 11.2105 - val_accuracy10: 0.5983 - val_accuracy20: 0.5878 - val_accuracy30: 0.5653 - val_accuracy50: 0.5159 - 52s/epoch - 29ms/step
Epoch 13/50
1806/1806 - 52s - loss: 10.5646 - accuracy10: 0.5937 - accuracy20: 0.5900 - accuracy30: 0.5739 - accuracy50: 0.5406 - val_loss: 11.2280 - val_accuracy10: 0.5914 - val_accuracy20: 0.5840 - val_accuracy30: 0.5636 - val_accuracy50: 0.5163 - 52s/epoch - 29ms/step
Epoch 14/50
1806/1806 - 53s - loss: 10.5420 - accuracy10: 0.5944 - accuracy20: 0.5914 - accuracy30: 0.5754 - accuracy50: 0.5420 - val_loss: 11.2010 - val_accuracy10: 0.5949 - val_accuracy20: 0.5856 - val_accuracy30: 0.5635 - val_accuracy50: 0.5156 - 53s/epoch - 29ms/step
Epoch 15/50
1806/1806 - 51s - loss: 10.5231 - accuracy10: 0.5951 - accuracy20: 0.5916 - accuracy30: 0.5761 - accuracy50: 0.5430 - val_loss: 11.1580 - val_accuracy10: 0.5951 - val_accuracy20: 0.5862 - val_accuracy30: 0.5654 - val_accuracy50: 0.5185 - 51s/epoch - 28ms/step
Epoch 16/50
1806/1806 - 52s - loss: 10.5006 - accuracy10: 0.5955 - accuracy20: 0.5928 - accuracy30: 0.5775 - accuracy50: 0.5446 - val_loss: 11.1957 - val_accuracy10: 0.5885 - val_accuracy20: 0.5805 - val_accuracy30: 0.5611 - val_accuracy50: 0.5167 - 52s/epoch - 29ms/step
Epoch 17/50
1806/1806 - 53s - loss: 10.4746 - accuracy10: 0.5957 - accuracy20: 0.5938 - accuracy30: 0.5787 - accuracy50: 0.5454 - val_loss: 11.1967 - val_accuracy10: 0.5878 - val_accuracy20: 0.5804 - val_accuracy30: 0.5609 - val_accuracy50: 0.5158 - 53s/epoch - 29ms/step
Epoch 18/50
1806/1806 - 53s - loss: 10.4575 - accuracy10: 0.5970 - accuracy20: 0.5952 - accuracy30: 0.5798 - accuracy50: 0.5472 - val_loss: 11.2133 - val_accuracy10: 0.5889 - val_accuracy20: 0.5813 - val_accuracy30: 0.5620 - val_accuracy50: 0.5173 - 53s/epoch - 30ms/step
Epoch 19/50
1806/1806 - 52s - loss: 10.4377 - accuracy10: 0.5965 - accuracy20: 0.5948 - accuracy30: 0.5802 - accuracy50: 0.5476 - val_loss: 11.2281 - val_accuracy10: 0.5850 - val_accuracy20: 0.5775 - val_accuracy30: 0.5584 - val_accuracy50: 0.5152 - 52s/epoch - 29ms/step
Epoch 20/50
1806/1806 - 52s - loss: 10.4172 - accuracy10: 0.5975 - accuracy20: 0.5960 - accuracy30: 0.5814 - accuracy50: 0.5491 - val_loss: 11.2289 - val_accuracy10: 0.5817 - val_accuracy20: 0.5770 - val_accuracy30: 0.5587 - val_accuracy50: 0.5175 - 52s/epoch - 29ms/step
Epoch 21/50
1806/1806 - 51s - loss: 10.3933 - accuracy10: 0.5986 - accuracy20: 0.5972 - accuracy30: 0.5828 - accuracy50: 0.5502 - val_loss: 11.2460 - val_accuracy10: 0.5851 - val_accuracy20: 0.5785 - val_accuracy30: 0.5589 - val_accuracy50: 0.5184 - 51s/epoch - 28ms/step
Epoch 22/50
1806/1806 - 52s - loss: 10.3750 - accuracy10: 0.5988 - accuracy20: 0.5982 - accuracy30: 0.5842 - accuracy50: 0.5519 - val_loss: 11.2296 - val_accuracy10: 0.5906 - val_accuracy20: 0.5804 - val_accuracy30: 0.5602 - val_accuracy50: 0.5179 - 52s/epoch - 29ms/step
Epoch 23/50
1806/1806 - 53s - loss: 10.3547 - accuracy10: 0.5999 - accuracy20: 0.5992 - accuracy30: 0.5849 - accuracy50: 0.5530 - val_loss: 11.2191 - val_accuracy10: 0.5843 - val_accuracy20: 0.5751 - val_accuracy30: 0.5569 - val_accuracy50: 0.5179 - 53s/epoch - 29ms/step
Epoch 24/50
1806/1806 - 53s - loss: 10.3356 - accuracy10: 0.6002 - accuracy20: 0.5992 - accuracy30: 0.5856 - accuracy50: 0.5549 - val_loss: 11.2270 - val_accuracy10: 0.5783 - val_accuracy20: 0.5714 - val_accuracy30: 0.5540 - val_accuracy50: 0.5155 - 53s/epoch - 29ms/step
Epoch 25/50
1806/1806 - 52s - loss: 10.3163 - accuracy10: 0.6007 - accuracy20: 0.6008 - accuracy30: 0.5869 - accuracy50: 0.5554 - val_loss: 11.2265 - val_accuracy10: 0.5780 - val_accuracy20: 0.5703 - val_accuracy30: 0.5534 - val_accuracy50: 0.5173 - 52s/epoch - 29ms/step
testing model: results/ATVI/W5/deepOF_L2/seq2seq
Evaluating performance on  test set...
8238/8238 - 86s - 86s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0204574
{'0': {'precision': 0.42277310300558496, 'recall': 0.5516171303769822, 'f1-score': 0.478676566925215, 'support': 526550}, '1': {'precision': 0.7254590700405643, 'recall': 0.45852808395761113, 'f1-score': 0.5619036595998118, 'support': 1053484}, '2': {'precision': 0.41219928793605976, 'recall': 0.589309121861257, 'f1-score': 0.4850938804489819, 'support': 528675}, 'accuracy': 0.5145608047388236, 'macro avg': {'precision': 0.520143820327403, 'recall': 0.5331514453986167, 'f1-score': 0.508558035658003, 'support': 2108709}, 'weighted avg': {'precision': 0.5713401701608903, 'recall': 0.5145608047388236, 'f1-score': 0.521864642532794, 'support': 2108709}}
[[290454  84859 151237]
 [277391 483052 293041]
 [119176  97946 311553]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0051347
{'0': {'precision': 0.48783448140499147, 'recall': 0.5153026223920142, 'f1-score': 0.5011924822832792, 'support': 655966}, '1': {'precision': 0.594254523762794, 'recall': 0.48156974916624606, 'f1-score': 0.5320106808339904, 'support': 798497}, '2': {'precision': 0.46973104816416794, 'recall': 0.5519238940704261, 'f1-score': 0.5075212354995288, 'support': 654246}, 'accuracy': 0.5138912007299252, 'macro avg': {'precision': 0.5172733511106511, 'recall': 0.5162654218762288, 'f1-score': 0.5135747995389327, 'support': 2108709}, 'weighted avg': {'precision': 0.5225154097732501, 'recall': 0.5138912007299252, 'f1-score': 0.5148258477997472, 'support': 2108709}}
[[338021 124338 193607]
 [199941 384532 214024]
 [154939 138213 361094]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0045798
{'0': {'precision': 0.5156230661368458, 'recall': 0.481494373528116, 'f1-score': 0.49797465239325706, 'support': 735452}, '1': {'precision': 0.49506669416941695, 'recall': 0.49418710759271534, 'f1-score': 0.49462650984261647, 'support': 641075}, '2': {'precision': 0.49351278772378515, 'recall': 0.5270916247599641, 'f1-score': 0.5097498187139987, 'support': 732182}, 'accuracy': 0.5011853223939386, 'macro avg': {'precision': 0.5014008493433493, 'recall': 0.5009243686269319, 'f1-score': 0.5007836603166241, 'support': 2108709}, 'weighted avg': {'precision': 0.5016965717613531, 'recall': 0.5011853223939386, 'f1-score': 0.5010453247057485, 'support': 2108709}}
[[354116 155909 225427]
 [153618 316811 170646]
 [179039 167216 385927]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0171964
{'0': {'precision': 0.5333878096794562, 'recall': 0.43274655017791536, 'f1-score': 0.47782532976016895, 'support': 829608}, '1': {'precision': 0.3600915263742512, 'recall': 0.5075497695218588, 'f1-score': 0.42129016238044403, 'support': 457961}, '2': {'precision': 0.5080789787087556, 'recall': 0.48889592517719266, 'f1-score': 0.4983028988808256, 'support': 821140}, 'accuracy': 0.4708568133393465, 'macro avg': {'precision': 0.467186104920821, 'recall': 0.47639741495898896, 'f1-score': 0.4658061303404795, 'support': 2108709}, 'weighted avg': {'precision': 0.4858966515054189, 'recall': 0.4708568133393465, 'f1-score': 0.4735212979185776, 'support': 2108709}}
[[359010 202820 267778]
 [104616 232438 120907]
 [209449 210239 401452]]
Evaluating performance on  train set...
1806/1806 - 19s - 19s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8538452
{'0': {'precision': 0.4408314525342027, 'recall': 0.5361051811189048, 'f1-score': 0.48382262996941894, 'support': 88533}, '1': {'precision': 0.8033789942389631, 'recall': 0.6457712558980867, 'f1-score': 0.7160045164713221, 'support': 285262}, '2': {'precision': 0.4188699138936371, 'recall': 0.5934476319809879, 'f1-score': 0.4911055024606783, 'support': 88365}, 'accuracy': 0.6147589579366454, 'macro avg': {'precision': 0.5543601202222677, 'recall': 0.5917746896659931, 'f1-score': 0.5636442163004731, 'support': 462160}, 'weighted avg': {'precision': 0.6604099653432078, 'recall': 0.6147589579366454, 'f1-score': 0.6285262398339594, 'support': 462160}}
[[ 47463  22264  18806]
 [ 47100 184214  53948]
 [ 13104  22821  52440]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.87301636
{'0': {'precision': 0.5179604190919674, 'recall': 0.4860178970917226, 'f1-score': 0.5014810172807893, 'support': 114432}, '1': {'precision': 0.6972322207559329, 'recall': 0.681360913788228, 'f1-score': 0.6892052066020788, 'support': 233402}, '2': {'precision': 0.48879996211403676, 'recall': 0.5416878050487203, 'f1-score': 0.5138866991394976, 'support': 114326}, 'accuracy': 0.5984420979747274, 'macro avg': {'precision': 0.5679975339873123, 'recall': 0.5696888719762235, 'f1-score': 0.5681909743407886, 'support': 462160}, 'weighted avg': {'precision': 0.6012835077355411, 'recall': 0.5984420979747274, 'f1-score': 0.5993551154722085, 'support': 462160}}
[[ 55616  34287  24529]
 [ 34133 159031  40238]
 [ 17626  34771  61929]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.90583235
{'0': {'precision': 0.5542766804515264, 'recall': 0.43663383629363567, 'f1-score': 0.4884718635313307, 'support': 131687}, '1': {'precision': 0.6098270034321617, 'recall': 0.7056995234915168, 'f1-score': 0.6542697800867735, 'support': 199157}, '2': {'precision': 0.516943324267717, 'recall': 0.5037162265070517, 'f1-score': 0.5102440680058009, 'support': 131316}, 'accuracy': 0.5716418556344123, 'macro avg': {'precision': 0.5603490027171351, 'recall': 0.5486831954307347, 'f1-score': 0.5509952372079684, 'support': 462160}, 'weighted avg': {'precision': 0.5676070609977036, 'recall': 0.5716418556344123, 'f1-score': 0.5661048358140939, 'support': 462160}}
[[ 57499  45315  28873]
 [ 25675 140545  32937]
 [ 20563  44607  66146]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9690456
{'0': {'precision': 0.5778134850779875, 'recall': 0.3652283607193686, 'f1-score': 0.4475599315068493, 'support': 154580}, '1': {'precision': 0.47698300582826497, 'recall': 0.7313458969403769, 'f1-score': 0.5773917406485832, 'support': 154202}, '2': {'precision': 0.5331750222624944, 'recall': 0.4450181903532449, 'f1-score': 0.48512416665482094, 'support': 153378}, 'accuracy': 0.5138653280249265, 'macro avg': {'precision': 0.5293238377229156, 'recall': 0.5138641493376634, 'f1-score': 0.5033586129367512, 'support': 462160}, 'weighted avg': {'precision': 0.5293566309344432, 'recall': 0.5138653280249265, 'f1-score': 0.5033454860589508, 'support': 462160}}
[[ 56457  62911  35212]
 [ 16877 112775  24550]
 [ 24374  60748  68256]]
Evaluating performance on  val set...
642/642 - 6s - 6s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8858943
{'0': {'precision': 0.4351817421214093, 'recall': 0.5556709597008724, 'f1-score': 0.48810051351562705, 'support': 33698}, '1': {'precision': 0.8099166791670644, 'recall': 0.6094049805559261, 'f1-score': 0.695497394461034, 'support': 97459}, '2': {'precision': 0.41323520213497905, 'recall': 0.5976179707522992, 'f1-score': 0.4886105906715314, 'support': 33165}, 'accuracy': 0.596006621146286, 'macro avg': {'precision': 0.5527778744744842, 'recall': 0.5875646370030325, 'f1-score': 0.5574028328827308, 'support': 164322}, 'weighted avg': {'precision': 0.6530067152283734, 'recall': 0.596006621146286, 'f1-score': 0.6112100747973421, 'support': 164322}}
[[18725  6930  8043]
 [17967 59392 20100]
 [ 6336  7009 19820]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8897864
{'0': {'precision': 0.5037609598523304, 'recall': 0.5097952226399234, 'f1-score': 0.5067601285875103, 'support': 42827}, '1': {'precision': 0.7079744948658496, 'recall': 0.647337935211943, 'f1-score': 0.6762997778495574, 'support': 79243}, '2': {'precision': 0.47881548036104354, 'recall': 0.5499147969326896, 'f1-score': 0.5119081715834233, 'support': 42252}, 'accuracy': 0.5864400384610703, 'macro avg': {'precision': 0.5635169783597412, 'recall': 0.5690159849281854, 'f1-score': 0.5649893593401637, 'support': 164322}, 'weighted avg': {'precision': 0.5958271272286431, 'recall': 0.5864400384610703, 'f1-score': 0.5898430118236913, 'support': 164322}}
[[21833 10604 10390]
 [13045 51297 14901]
 [ 8462 10555 23235]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9116223
{'0': {'precision': 0.5338241192987424, 'recall': 0.46542821288238806, 'f1-score': 0.49728541597977804, 'support': 48609}, '1': {'precision': 0.6245383781112286, 'recall': 0.6727993374349266, 'f1-score': 0.6477712039983767, 'support': 67616}, '2': {'precision': 0.5053767820773931, 'recall': 0.5159157535813045, 'f1-score': 0.5105918906962149, 'support': 48097}, 'accuracy': 0.5655359598836431, 'macro avg': {'precision': 0.5545797598291213, 'recall': 0.5513811012995397, 'f1-score': 0.5518828368914566, 'support': 164322}, 'weighted avg': {'precision': 0.5628251279617933, 'recall': 0.5655359598836431, 'f1-score': 0.5631028266557803, 'support': 164322}}
[[22624 13878 12107]
 [ 9945 45492 12179]
 [ 9812 13471 24814]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9595086
{'0': {'precision': 0.549551100725618, 'recall': 0.3990141624845963, 'f1-score': 0.4623375548381757, 'support': 55993}, '1': {'precision': 0.49635232271215535, 'recall': 0.7020618752252509, 'f1-score': 0.5815519259625885, 'support': 52719}, '2': {'precision': 0.5223527974093158, 'recall': 0.46119402985074626, 'f1-score': 0.4898719307795891, 'support': 55610}, 'accuracy': 0.517283139202298, 'macro avg': {'precision': 0.5227520736156964, 'recall': 0.5207566891868645, 'f1-score': 0.5112538038601178, 'support': 164322}, 'weighted avg': {'precision': 0.5232790006689529, 'recall': 0.517283139202298, 'f1-score': 0.5099029999849602, 'support': 164322}}
[[22342 19265 14386]
 [ 6641 37012  9066]
 [11672 18291 25647]]
training model: results/ATVI/W5/deepVOL_L2/seq2seq
Epoch 1/50
1806/1806 - 56s - loss: 11.8427 - accuracy10: 0.4952 - accuracy20: 0.5050 - accuracy30: 0.5001 - accuracy50: 0.4796 - val_loss: 11.9381 - val_accuracy10: 0.5808 - val_accuracy20: 0.5685 - val_accuracy30: 0.5395 - val_accuracy50: 0.4818 - 56s/epoch - 31ms/step
Epoch 2/50
1806/1806 - 51s - loss: 11.4332 - accuracy10: 0.5280 - accuracy20: 0.5372 - accuracy30: 0.5297 - accuracy50: 0.5017 - val_loss: 11.6102 - val_accuracy10: 0.5872 - val_accuracy20: 0.5730 - val_accuracy30: 0.5461 - val_accuracy50: 0.4908 - 51s/epoch - 28ms/step
Epoch 3/50
1806/1806 - 50s - loss: 11.1779 - accuracy10: 0.5560 - accuracy20: 0.5567 - accuracy30: 0.5446 - accuracy50: 0.5130 - val_loss: 11.8397 - val_accuracy10: 0.5907 - val_accuracy20: 0.5694 - val_accuracy30: 0.5421 - val_accuracy50: 0.4881 - 50s/epoch - 28ms/step
Epoch 4/50
1806/1806 - 50s - loss: 11.0573 - accuracy10: 0.5661 - accuracy20: 0.5657 - accuracy30: 0.5519 - accuracy50: 0.5187 - val_loss: 11.7405 - val_accuracy10: 0.5722 - val_accuracy20: 0.5632 - val_accuracy30: 0.5418 - val_accuracy50: 0.4943 - 50s/epoch - 28ms/step
Epoch 5/50
1806/1806 - 50s - loss: 10.9773 - accuracy10: 0.5713 - accuracy20: 0.5694 - accuracy30: 0.5552 - accuracy50: 0.5212 - val_loss: 11.5516 - val_accuracy10: 0.5682 - val_accuracy20: 0.5659 - val_accuracy30: 0.5479 - val_accuracy50: 0.5048 - 50s/epoch - 28ms/step
Epoch 6/50
1806/1806 - 51s - loss: 10.9136 - accuracy10: 0.5755 - accuracy20: 0.5732 - accuracy30: 0.5585 - accuracy50: 0.5239 - val_loss: 11.4299 - val_accuracy10: 0.5756 - val_accuracy20: 0.5736 - val_accuracy30: 0.5558 - val_accuracy50: 0.5115 - 51s/epoch - 28ms/step
Epoch 7/50
1806/1806 - 51s - loss: 10.8625 - accuracy10: 0.5789 - accuracy20: 0.5760 - accuracy30: 0.5604 - accuracy50: 0.5256 - val_loss: 11.3119 - val_accuracy10: 0.5848 - val_accuracy20: 0.5820 - val_accuracy30: 0.5628 - val_accuracy50: 0.5144 - 51s/epoch - 28ms/step
Epoch 8/50
1806/1806 - 51s - loss: 10.8222 - accuracy10: 0.5802 - accuracy20: 0.5781 - accuracy30: 0.5625 - accuracy50: 0.5271 - val_loss: 11.3006 - val_accuracy10: 0.5829 - val_accuracy20: 0.5802 - val_accuracy30: 0.5615 - val_accuracy50: 0.5151 - 51s/epoch - 28ms/step
Epoch 9/50
1806/1806 - 51s - loss: 10.7908 - accuracy10: 0.5829 - accuracy20: 0.5804 - accuracy30: 0.5644 - accuracy50: 0.5291 - val_loss: 11.2701 - val_accuracy10: 0.5846 - val_accuracy20: 0.5823 - val_accuracy30: 0.5629 - val_accuracy50: 0.5142 - 51s/epoch - 28ms/step
Epoch 10/50
1806/1806 - 53s - loss: 10.7583 - accuracy10: 0.5844 - accuracy20: 0.5815 - accuracy30: 0.5662 - accuracy50: 0.5300 - val_loss: 11.2793 - val_accuracy10: 0.5857 - val_accuracy20: 0.5826 - val_accuracy30: 0.5629 - val_accuracy50: 0.5147 - 53s/epoch - 29ms/step
Epoch 11/50
1806/1806 - 51s - loss: 10.7305 - accuracy10: 0.5855 - accuracy20: 0.5832 - accuracy30: 0.5674 - accuracy50: 0.5312 - val_loss: 11.3974 - val_accuracy10: 0.5898 - val_accuracy20: 0.5818 - val_accuracy30: 0.5599 - val_accuracy50: 0.5099 - 51s/epoch - 28ms/step
Epoch 12/50
1806/1806 - 49s - loss: 10.7039 - accuracy10: 0.5866 - accuracy20: 0.5843 - accuracy30: 0.5687 - accuracy50: 0.5324 - val_loss: 11.2221 - val_accuracy10: 0.5884 - val_accuracy20: 0.5859 - val_accuracy30: 0.5660 - val_accuracy50: 0.5179 - 49s/epoch - 27ms/step
Epoch 13/50
1806/1806 - 51s - loss: 10.6804 - accuracy10: 0.5876 - accuracy20: 0.5856 - accuracy30: 0.5698 - accuracy50: 0.5338 - val_loss: 11.1906 - val_accuracy10: 0.5829 - val_accuracy20: 0.5835 - val_accuracy30: 0.5667 - val_accuracy50: 0.5197 - 51s/epoch - 28ms/step
Epoch 14/50
1806/1806 - 51s - loss: 10.6571 - accuracy10: 0.5893 - accuracy20: 0.5869 - accuracy30: 0.5713 - accuracy50: 0.5350 - val_loss: 11.1588 - val_accuracy10: 0.5839 - val_accuracy20: 0.5861 - val_accuracy30: 0.5678 - val_accuracy50: 0.5195 - 51s/epoch - 28ms/step
Epoch 15/50
1806/1806 - 50s - loss: 10.6335 - accuracy10: 0.5897 - accuracy20: 0.5876 - accuracy30: 0.5718 - accuracy50: 0.5363 - val_loss: 11.2047 - val_accuracy10: 0.5809 - val_accuracy20: 0.5823 - val_accuracy30: 0.5651 - val_accuracy50: 0.5192 - 50s/epoch - 28ms/step
Epoch 16/50
1806/1806 - 50s - loss: 10.6141 - accuracy10: 0.5915 - accuracy20: 0.5887 - accuracy30: 0.5735 - accuracy50: 0.5375 - val_loss: 11.1748 - val_accuracy10: 0.5907 - val_accuracy20: 0.5880 - val_accuracy30: 0.5688 - val_accuracy50: 0.5196 - 50s/epoch - 28ms/step
Epoch 17/50
1806/1806 - 50s - loss: 10.5961 - accuracy10: 0.5927 - accuracy20: 0.5895 - accuracy30: 0.5735 - accuracy50: 0.5380 - val_loss: 11.1858 - val_accuracy10: 0.5878 - val_accuracy20: 0.5858 - val_accuracy30: 0.5678 - val_accuracy50: 0.5198 - 50s/epoch - 28ms/step
Epoch 18/50
1806/1806 - 51s - loss: 10.5767 - accuracy10: 0.5935 - accuracy20: 0.5905 - accuracy30: 0.5751 - accuracy50: 0.5395 - val_loss: 11.2186 - val_accuracy10: 0.5815 - val_accuracy20: 0.5826 - val_accuracy30: 0.5657 - val_accuracy50: 0.5194 - 51s/epoch - 28ms/step
Epoch 19/50
1806/1806 - 51s - loss: 10.5596 - accuracy10: 0.5933 - accuracy20: 0.5906 - accuracy30: 0.5755 - accuracy50: 0.5409 - val_loss: 11.2311 - val_accuracy10: 0.5812 - val_accuracy20: 0.5802 - val_accuracy30: 0.5637 - val_accuracy50: 0.5189 - 51s/epoch - 28ms/step
Epoch 20/50
1806/1806 - 51s - loss: 10.5435 - accuracy10: 0.5943 - accuracy20: 0.5919 - accuracy30: 0.5763 - accuracy50: 0.5412 - val_loss: 11.3136 - val_accuracy10: 0.5769 - val_accuracy20: 0.5768 - val_accuracy30: 0.5598 - val_accuracy50: 0.5169 - 51s/epoch - 28ms/step
Epoch 21/50
1806/1806 - 50s - loss: 10.5248 - accuracy10: 0.5952 - accuracy20: 0.5927 - accuracy30: 0.5770 - accuracy50: 0.5421 - val_loss: 11.3013 - val_accuracy10: 0.5816 - val_accuracy20: 0.5807 - val_accuracy30: 0.5637 - val_accuracy50: 0.5183 - 50s/epoch - 28ms/step
Epoch 22/50
1806/1806 - 51s - loss: 10.5133 - accuracy10: 0.5951 - accuracy20: 0.5928 - accuracy30: 0.5773 - accuracy50: 0.5421 - val_loss: 11.3213 - val_accuracy10: 0.5927 - val_accuracy20: 0.5860 - val_accuracy30: 0.5646 - val_accuracy50: 0.5160 - 51s/epoch - 28ms/step
Epoch 23/50
1806/1806 - 51s - loss: 10.4951 - accuracy10: 0.5964 - accuracy20: 0.5938 - accuracy30: 0.5789 - accuracy50: 0.5434 - val_loss: 11.3770 - val_accuracy10: 0.5859 - val_accuracy20: 0.5813 - val_accuracy30: 0.5619 - val_accuracy50: 0.5170 - 51s/epoch - 28ms/step
Epoch 24/50
1806/1806 - 50s - loss: 10.4825 - accuracy10: 0.5970 - accuracy20: 0.5943 - accuracy30: 0.5791 - accuracy50: 0.5445 - val_loss: 11.3793 - val_accuracy10: 0.5842 - val_accuracy20: 0.5791 - val_accuracy30: 0.5612 - val_accuracy50: 0.5166 - 50s/epoch - 28ms/step
testing model: results/ATVI/W5/deepVOL_L2/seq2seq
Evaluating performance on  test set...
8238/8238 - 73s - 73s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0450922
{'0': {'precision': 0.43962327207493, 'recall': 0.4821612382489792, 'f1-score': 0.45991074671504617, 'support': 526550}, '1': {'precision': 0.7574689539334196, 'recall': 0.36557331143775185, 'f1-score': 0.493143387990317, 'support': 1053485}, '2': {'precision': 0.37475226760085534, 'recall': 0.7249919138078116, 'f1-score': 0.494101025101582, 'support': 528679}, 'accuracy': 0.48479594672392745, 'macro avg': {'precision': 0.5239481645364017, 'recall': 0.5242421544981809, 'f1-score': 0.48238505326898173, 'support': 2108714}, 'weighted avg': {'precision': 0.5821507653140993, 'recall': 0.48479594672392745, 'f1-score': 0.4850852233301747, 'support': 2108714}}
[[253882  70709 201959]
 [230829 385126 437530]
 [ 92788  52603 383288]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0188574
{'0': {'precision': 0.5057548653515155, 'recall': 0.4466041026391531, 'f1-score': 0.47434256490964744, 'support': 655968}, '1': {'precision': 0.6220158519317517, 'recall': 0.40875618974624855, 'f1-score': 0.4933250404880788, 'support': 798498}, '2': {'precision': 0.4405434672261514, 'recall': 0.6765462026632103, 'f1-score': 0.5336151929315689, 'support': 654248}, 'accuracy': 0.5036140510282571, 'macro avg': {'precision': 0.5227713948364728, 'recall': 0.5106354983495374, 'f1-score': 0.5004275994430983, 'support': 2108714}, 'weighted avg': {'precision': 0.5295464930742043, 'recall': 0.5036140510282571, 'f1-score': 0.499920460784817, 'support': 2108714}}
[[292958 110957 252053]
 [162055 326391 310052]
 [124236  87383 442629]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0097245
{'0': {'precision': 0.5326354658230598, 'recall': 0.4134480198625611, 'f1-score': 0.46553413516889985, 'support': 735454}, '1': {'precision': 0.5171852384574936, 'recall': 0.4464618859542394, 'f1-score': 0.47922832144678007, 'support': 641076}, '2': {'precision': 0.4738602691328202, 'recall': 0.6371048807403603, 'f1-score': 0.5434890379557323, 'support': 732184}, 'accuracy': 0.5011424024310551, 'macro avg': {'precision': 0.5078936578044578, 'recall': 0.49900492885238695, 'f1-score': 0.4960838315238041, 'support': 2108714}, 'weighted avg': {'precision': 0.5075305779283267, 'recall': 0.5011424024310551, 'f1-score': 0.4967647082595857, 'support': 2108714}}
[[304072 146565 284817]
 [121734 286216 233126]
 [145076 120630 466478]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0114897
{'0': {'precision': 0.5466743445347945, 'recall': 0.36847466044367727, 'f1-score': 0.44022479919642565, 'support': 829612}, '1': {'precision': 0.376041513899926, 'recall': 0.48151043429462337, 'f1-score': 0.4222902485428973, 'support': 457961}, '2': {'precision': 0.49907748215444514, 'recall': 0.5853732793758928, 'f1-score': 0.538791861751555, 'support': 821141}, 'accuracy': 0.47748438147610345, 'macro avg': {'precision': 0.4739311135297219, 'recall': 0.4784527913713978, 'f1-score': 0.46710230316362605, 'support': 2108714}, 'weighted avg': {'precision': 0.49108268207026046, 'recall': 0.47748438147610345, 'f1-score': 0.47471223161340637, 'support': 2108714}}
[[305691 197373 326548]
 [ 81545 220513 155903]
 [171947 168520 480674]]
Evaluating performance on  train set...
1806/1806 - 17s - 17s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.87955505
{'0': {'precision': 0.4423398775342493, 'recall': 0.4982502878558689, 'f1-score': 0.46863337385663245, 'support': 88586}, '1': {'precision': 0.8261424101715857, 'recall': 0.5813146362839614, 'f1-score': 0.6824345736121458, 'support': 285250}, '2': {'precision': 0.37937326801266824, 'recall': 0.6943629920635819, 'f1-score': 0.49066566396390265, 'support': 88327}, 'accuracy': 0.5869985264938994, 'macro avg': {'precision': 0.5492851852395011, 'recall': 0.5913093054011375, 'f1-score': 0.5472445371442269, 'support': 462163}, 'weighted avg': {'precision': 0.6671913275975118, 'recall': 0.5869985264938994, 'f1-score': 0.6048035958747624, 'support': 462163}}
[[ 44138  19433  25015]
 [ 44112 165820  75318]
 [ 11533  15463  61331]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.889646
{'0': {'precision': 0.5211138310893513, 'recall': 0.4459282534694946, 'f1-score': 0.4805982785381685, 'support': 114570}, '1': {'precision': 0.7173816916670311, 'recall': 0.6328118302614659, 'f1-score': 0.6724482289790183, 'support': 233300}, '2': {'precision': 0.4555284665816101, 'recall': 0.6310272720114093, 'f1-score': 0.5291047212409994, 'support': 114293}, 'accuracy': 0.5860421539586682, 'macro avg': {'precision': 0.5646746631126642, 'recall': 0.5699224519141234, 'f1-score': 0.5607170762527287, 'support': 462163}, 'weighted avg': {'precision': 0.6039706236216168, 'recall': 0.5860421539586682, 'f1-score': 0.5894398350748988, 'support': 462163}}
[[ 51090  31883  31597]
 [ 31058 147635  54607]
 [ 15892  26279  72122]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9167806
{'0': {'precision': 0.5569810116483166, 'recall': 0.3973032036786912, 'f1-score': 0.4637828788569961, 'support': 131786}, '1': {'precision': 0.6242182872971977, 'recall': 0.6723713556631639, 'f1-score': 0.6474006611706153, 'support': 199076}, '2': {'precision': 0.49286713286713285, 'recall': 0.5770405404376204, 'f1-score': 0.5316427273301383, 'support': 131301}, 'accuracy': 0.5668519548297895, 'macro avg': {'precision': 0.5580221439375491, 'recall': 0.5489050332598252, 'f1-score': 0.5476087557859166, 'support': 462163}, 'weighted avg': {'precision': 0.5677285433400108, 'recall': 0.5668519548297895, 'f1-score': 0.5621550107590265, 'support': 462163}}
[[ 52359  43644  35783]
 [ 23047 133853  42176]
 [ 18599  36936  75766]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.97307706
{'0': {'precision': 0.575925905186413, 'recall': 0.33246701190222205, 'f1-score': 0.4215716815320042, 'support': 154677}, '1': {'precision': 0.48673052939309547, 'recall': 0.7063364384130362, 'f1-score': 0.5763222314847896, 'support': 154156}, '2': {'precision': 0.5199077519223936, 'recall': 0.5057783864866627, 'f1-score': 0.5127457494884179, 'support': 153330}, 'accuracy': 0.5146712307129736, 'macro avg': {'precision': 0.527521395500634, 'recall': 0.514860612267307, 'f1-score': 0.5035465541684039, 'support': 462163}, 'weighted avg': {'precision': 0.5275895697576427, 'recall': 0.5146712307129736, 'f1-score': 0.5034377020015754, 'support': 462163}}
[[ 51425  61398  41854]
 [ 15512 108886  29758]
 [ 22354  53425  77551]]
Evaluating performance on  val set...
642/642 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.88541174
{'0': {'precision': 0.4482473772613377, 'recall': 0.4837597693976405, 'f1-score': 0.46532700663160304, 'support': 33651}, '1': {'precision': 0.8267577726623736, 'recall': 0.5817341206380449, 'f1-score': 0.6829335804460063, 'support': 97548}, '2': {'precision': 0.38662893526706754, 'recall': 0.6929625939679377, 'f1-score': 0.49633473889069085, 'support': 33123}, 'accuracy': 0.5840909920765327, 'macro avg': {'precision': 0.5538780283969263, 'recall': 0.5861521613345411, 'f1-score': 0.5481984419894333, 'support': 164322}, 'weighted avg': {'precision': 0.6605253704479106, 'recall': 0.5840909920765327, 'f1-score': 0.6007571692273916, 'support': 164322}}
[[16279  6575 10797]
 [15184 56747 25617]
 [ 4854  5316 22953]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8881283
{'0': {'precision': 0.5223864015109432, 'recall': 0.4387831280328481, 'f1-score': 0.476948825886291, 'support': 42864}, '1': {'precision': 0.722108925999344, 'recall': 0.6389838850119254, 'f1-score': 0.6780080876248626, 'support': 79243}, '2': {'precision': 0.45899273158410225, 'recall': 0.6327608669904062, 'f1-score': 0.5320479623949329, 'support': 42215}, 'accuracy': 0.5851620598580836, 'macro avg': {'precision': 0.5678293530314631, 'recall': 0.5701759600117265, 'f1-score': 0.5623349586353622, 'support': 164322}, 'weighted avg': {'precision': 0.6024149322741565, 'recall': 0.5851620598580836, 'f1-score': 0.588063278763337, 'support': 164322}}
[[18808 10618 13438]
 [10561 50635 18047]
 [ 6635  8868 26712]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.91016036
{'0': {'precision': 0.5520163143382353, 'recall': 0.3950949757421265, 'f1-score': 0.4605559549484783, 'support': 48644}, '1': {'precision': 0.633244585952296, 'recall': 0.6825638673984112, 'f1-score': 0.6569799312293991, 'support': 67601}, '2': {'precision': 0.4928848870056497, 'recall': 0.5806726709237265, 'f1-score': 0.5331894534793779, 'support': 48077}, 'accuracy': 0.5676537529971641, 'macro avg': {'precision': 0.5593819290987271, 'recall': 0.5527771713547548, 'f1-score': 0.5502417798857517, 'support': 164322}, 'weighted avg': {'precision': 0.5681325419736913, 'recall': 0.5676537529971641, 'f1-score': 0.5626144615966239, 'support': 164322}}
[[19219 14428 14997]
 [ 7733 46142 13726]
 [ 7864 12296 27917]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9583668
{'0': {'precision': 0.5630599378600947, 'recall': 0.3333035730228738, 'f1-score': 0.41873611952352113, 'support': 56003}, '1': {'precision': 0.5011251332394626, 'recall': 0.7222432955278231, 'f1-score': 0.5917011738931144, 'support': 52726}, '2': {'precision': 0.5177963030083363, 'recall': 0.5139495979709676, 'f1-score': 0.515865779567223, 'support': 55593}, 'accuracy': 0.5192183639439637, 'macro avg': {'precision': 0.5273271247026312, 'recall': 0.5231654888405548, 'f1-score': 0.5087676909946195, 'support': 164322}, 'weighted avg': {'precision': 0.5278734396386682, 'recall': 0.5192183639439637, 'f1-score': 0.5070960752659093, 'support': 164322}}
[[18666 20250 17087]
 [ 5124 38081  9521]
 [ 9361 17660 28572]]
training model: results/ATVI/W5/deepVOL_L3/seq2seq
Epoch 1/50
1806/1806 - 84s - loss: 12.2211 - accuracy10: 0.4653 - accuracy20: 0.4746 - accuracy30: 0.4722 - accuracy50: 0.4567 - val_loss: 12.2343 - val_accuracy10: 0.5629 - val_accuracy20: 0.5442 - val_accuracy30: 0.5194 - val_accuracy50: 0.4716 - 84s/epoch - 46ms/step
Epoch 2/50
1806/1806 - 75s - loss: 11.4385 - accuracy10: 0.5328 - accuracy20: 0.5378 - accuracy30: 0.5297 - accuracy50: 0.5018 - val_loss: 11.6826 - val_accuracy10: 0.5775 - val_accuracy20: 0.5624 - val_accuracy30: 0.5370 - val_accuracy50: 0.4854 - 75s/epoch - 41ms/step
Epoch 3/50
1806/1806 - 76s - loss: 11.1443 - accuracy10: 0.5638 - accuracy20: 0.5608 - accuracy30: 0.5479 - accuracy50: 0.5147 - val_loss: 11.6127 - val_accuracy10: 0.5893 - val_accuracy20: 0.5717 - val_accuracy30: 0.5428 - val_accuracy50: 0.4838 - 76s/epoch - 42ms/step
Epoch 4/50
1806/1806 - 76s - loss: 10.9883 - accuracy10: 0.5721 - accuracy20: 0.5684 - accuracy30: 0.5544 - accuracy50: 0.5208 - val_loss: 11.4704 - val_accuracy10: 0.5874 - val_accuracy20: 0.5697 - val_accuracy30: 0.5441 - val_accuracy50: 0.4915 - 76s/epoch - 42ms/step
Epoch 5/50
1806/1806 - 75s - loss: 10.9015 - accuracy10: 0.5756 - accuracy20: 0.5728 - accuracy30: 0.5583 - accuracy50: 0.5244 - val_loss: 11.3902 - val_accuracy10: 0.5979 - val_accuracy20: 0.5794 - val_accuracy30: 0.5529 - val_accuracy50: 0.4989 - 75s/epoch - 41ms/step
Epoch 6/50
1806/1806 - 76s - loss: 10.8411 - accuracy10: 0.5790 - accuracy20: 0.5759 - accuracy30: 0.5617 - accuracy50: 0.5277 - val_loss: 11.3154 - val_accuracy10: 0.5852 - val_accuracy20: 0.5728 - val_accuracy30: 0.5495 - val_accuracy50: 0.4996 - 76s/epoch - 42ms/step
Epoch 7/50
1806/1806 - 78s - loss: 10.7956 - accuracy10: 0.5797 - accuracy20: 0.5772 - accuracy30: 0.5631 - accuracy50: 0.5296 - val_loss: 11.2708 - val_accuracy10: 0.5996 - val_accuracy20: 0.5852 - val_accuracy30: 0.5590 - val_accuracy50: 0.5041 - 78s/epoch - 43ms/step
Epoch 8/50
1806/1806 - 76s - loss: 10.7579 - accuracy10: 0.5822 - accuracy20: 0.5793 - accuracy30: 0.5652 - accuracy50: 0.5316 - val_loss: 11.3079 - val_accuracy10: 0.5939 - val_accuracy20: 0.5789 - val_accuracy30: 0.5547 - val_accuracy50: 0.5034 - 76s/epoch - 42ms/step
Epoch 9/50
1806/1806 - 75s - loss: 10.7262 - accuracy10: 0.5837 - accuracy20: 0.5815 - accuracy30: 0.5671 - accuracy50: 0.5326 - val_loss: 11.3180 - val_accuracy10: 0.5949 - val_accuracy20: 0.5825 - val_accuracy30: 0.5571 - val_accuracy50: 0.5038 - 75s/epoch - 42ms/step
Epoch 10/50
1806/1806 - 74s - loss: 10.6993 - accuracy10: 0.5855 - accuracy20: 0.5833 - accuracy30: 0.5685 - accuracy50: 0.5341 - val_loss: 11.2158 - val_accuracy10: 0.5942 - val_accuracy20: 0.5847 - val_accuracy30: 0.5612 - val_accuracy50: 0.5089 - 74s/epoch - 41ms/step
Epoch 11/50
1806/1806 - 75s - loss: 10.6791 - accuracy10: 0.5864 - accuracy20: 0.5835 - accuracy30: 0.5690 - accuracy50: 0.5344 - val_loss: 11.2697 - val_accuracy10: 0.6028 - val_accuracy20: 0.5888 - val_accuracy30: 0.5619 - val_accuracy50: 0.5053 - 75s/epoch - 42ms/step
Epoch 12/50
1806/1806 - 74s - loss: 10.6558 - accuracy10: 0.5879 - accuracy20: 0.5855 - accuracy30: 0.5707 - accuracy50: 0.5359 - val_loss: 11.2606 - val_accuracy10: 0.5914 - val_accuracy20: 0.5813 - val_accuracy30: 0.5583 - val_accuracy50: 0.5070 - 74s/epoch - 41ms/step
Epoch 13/50
1806/1806 - 75s - loss: 10.6349 - accuracy10: 0.5889 - accuracy20: 0.5864 - accuracy30: 0.5721 - accuracy50: 0.5373 - val_loss: 11.1627 - val_accuracy10: 0.5945 - val_accuracy20: 0.5868 - val_accuracy30: 0.5641 - val_accuracy50: 0.5128 - 75s/epoch - 42ms/step
Epoch 14/50
1806/1806 - 75s - loss: 10.6138 - accuracy10: 0.5908 - accuracy20: 0.5876 - accuracy30: 0.5729 - accuracy50: 0.5378 - val_loss: 11.1374 - val_accuracy10: 0.5920 - val_accuracy20: 0.5851 - val_accuracy30: 0.5645 - val_accuracy50: 0.5152 - 75s/epoch - 42ms/step
Epoch 15/50
1806/1806 - 78s - loss: 10.5963 - accuracy10: 0.5907 - accuracy20: 0.5880 - accuracy30: 0.5734 - accuracy50: 0.5392 - val_loss: 11.1747 - val_accuracy10: 0.6013 - val_accuracy20: 0.5898 - val_accuracy30: 0.5651 - val_accuracy50: 0.5109 - 78s/epoch - 43ms/step
Epoch 16/50
1806/1806 - 76s - loss: 10.5749 - accuracy10: 0.5916 - accuracy20: 0.5901 - accuracy30: 0.5754 - accuracy50: 0.5399 - val_loss: 11.1637 - val_accuracy10: 0.5992 - val_accuracy20: 0.5891 - val_accuracy30: 0.5644 - val_accuracy50: 0.5109 - 76s/epoch - 42ms/step
Epoch 17/50
1806/1806 - 76s - loss: 10.5602 - accuracy10: 0.5927 - accuracy20: 0.5906 - accuracy30: 0.5757 - accuracy50: 0.5408 - val_loss: 11.1430 - val_accuracy10: 0.5944 - val_accuracy20: 0.5886 - val_accuracy30: 0.5667 - val_accuracy50: 0.5145 - 76s/epoch - 42ms/step
Epoch 18/50
1806/1806 - 75s - loss: 10.5473 - accuracy10: 0.5924 - accuracy20: 0.5908 - accuracy30: 0.5760 - accuracy50: 0.5410 - val_loss: 11.0430 - val_accuracy10: 0.5958 - val_accuracy20: 0.5902 - val_accuracy30: 0.5692 - val_accuracy50: 0.5192 - 75s/epoch - 42ms/step
Epoch 19/50
1806/1806 - 75s - loss: 10.5254 - accuracy10: 0.5934 - accuracy20: 0.5918 - accuracy30: 0.5778 - accuracy50: 0.5423 - val_loss: 11.0678 - val_accuracy10: 0.5905 - val_accuracy20: 0.5880 - val_accuracy30: 0.5683 - val_accuracy50: 0.5197 - 75s/epoch - 42ms/step
Epoch 20/50
1806/1806 - 75s - loss: 10.5318 - accuracy10: 0.5937 - accuracy20: 0.5909 - accuracy30: 0.5761 - accuracy50: 0.5421 - val_loss: 11.0430 - val_accuracy10: 0.5793 - val_accuracy20: 0.5803 - val_accuracy30: 0.5639 - val_accuracy50: 0.5195 - 75s/epoch - 41ms/step
Epoch 21/50
1806/1806 - 75s - loss: 10.5023 - accuracy10: 0.5945 - accuracy20: 0.5925 - accuracy30: 0.5778 - accuracy50: 0.5435 - val_loss: 11.0927 - val_accuracy10: 0.5866 - val_accuracy20: 0.5830 - val_accuracy30: 0.5634 - val_accuracy50: 0.5174 - 75s/epoch - 42ms/step
Epoch 22/50
1806/1806 - 74s - loss: 10.4832 - accuracy10: 0.5963 - accuracy20: 0.5941 - accuracy30: 0.5789 - accuracy50: 0.5446 - val_loss: 11.0976 - val_accuracy10: 0.5860 - val_accuracy20: 0.5836 - val_accuracy30: 0.5656 - val_accuracy50: 0.5188 - 74s/epoch - 41ms/step
Epoch 23/50
1806/1806 - 75s - loss: 10.4666 - accuracy10: 0.5962 - accuracy20: 0.5944 - accuracy30: 0.5795 - accuracy50: 0.5449 - val_loss: 11.1342 - val_accuracy10: 0.5899 - val_accuracy20: 0.5849 - val_accuracy30: 0.5646 - val_accuracy50: 0.5160 - 75s/epoch - 42ms/step
Epoch 24/50
1806/1806 - 75s - loss: 10.4597 - accuracy10: 0.5959 - accuracy20: 0.5942 - accuracy30: 0.5798 - accuracy50: 0.5457 - val_loss: 11.1957 - val_accuracy10: 0.5760 - val_accuracy20: 0.5741 - val_accuracy30: 0.5567 - val_accuracy50: 0.5138 - 75s/epoch - 41ms/step
Epoch 25/50
1806/1806 - 75s - loss: 10.4414 - accuracy10: 0.5965 - accuracy20: 0.5952 - accuracy30: 0.5808 - accuracy50: 0.5462 - val_loss: 11.1072 - val_accuracy10: 0.5904 - val_accuracy20: 0.5872 - val_accuracy30: 0.5670 - val_accuracy50: 0.5168 - 75s/epoch - 42ms/step
Epoch 26/50
1806/1806 - 75s - loss: 10.4242 - accuracy10: 0.5977 - accuracy20: 0.5963 - accuracy30: 0.5819 - accuracy50: 0.5474 - val_loss: 11.0605 - val_accuracy10: 0.5931 - val_accuracy20: 0.5892 - val_accuracy30: 0.5690 - val_accuracy50: 0.5208 - 75s/epoch - 42ms/step
Epoch 27/50
1806/1806 - 76s - loss: 10.4152 - accuracy10: 0.5977 - accuracy20: 0.5967 - accuracy30: 0.5821 - accuracy50: 0.5482 - val_loss: 11.1170 - val_accuracy10: 0.5876 - val_accuracy20: 0.5836 - val_accuracy30: 0.5644 - val_accuracy50: 0.5171 - 76s/epoch - 42ms/step
Epoch 28/50
1806/1806 - 75s - loss: 10.4027 - accuracy10: 0.5979 - accuracy20: 0.5967 - accuracy30: 0.5824 - accuracy50: 0.5482 - val_loss: 11.2091 - val_accuracy10: 0.5861 - val_accuracy20: 0.5810 - val_accuracy30: 0.5614 - val_accuracy50: 0.5153 - 75s/epoch - 42ms/step
Epoch 29/50
1806/1806 - 76s - loss: 10.3940 - accuracy10: 0.5981 - accuracy20: 0.5977 - accuracy30: 0.5837 - accuracy50: 0.5499 - val_loss: 11.0699 - val_accuracy10: 0.5863 - val_accuracy20: 0.5843 - val_accuracy30: 0.5659 - val_accuracy50: 0.5207 - 76s/epoch - 42ms/step
Epoch 30/50
1806/1806 - 75s - loss: 10.3892 - accuracy10: 0.5990 - accuracy20: 0.5982 - accuracy30: 0.5839 - accuracy50: 0.5498 - val_loss: 11.1075 - val_accuracy10: 0.5811 - val_accuracy20: 0.5804 - val_accuracy30: 0.5632 - val_accuracy50: 0.5201 - 75s/epoch - 42ms/step
testing model: results/ATVI/W5/deepVOL_L3/seq2seq
Evaluating performance on  test set...
8238/8238 - 139s - 139s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0378851
{'0': {'precision': 0.4563046715614058, 'recall': 0.43411641819390373, 'f1-score': 0.4449340922008455, 'support': 526550}, '1': {'precision': 0.7707830641786602, 'recall': 0.35143452445929463, 'f1-score': 0.4827580361660069, 'support': 1053485}, '2': {'precision': 0.36651005776819456, 'recall': 0.7816028251547725, 'f1-score': 0.49901939236140463, 'support': 528679}, 'accuracy': 0.4799285251579873, 'macro avg': {'precision': 0.5311992645027536, 'recall': 0.5223845892693236, 'f1-score': 0.475570506909419, 'support': 2108714}, 'weighted avg': {'precision': 0.590901275378143, 'recall': 0.4799285251579873, 'f1-score': 0.47739023372203915, 'support': 2108714}}
[[228584  65683 232283]
 [201317 370231 481937]
 [ 71045  44417 413217]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0145086
{'0': {'precision': 0.5161466586525326, 'recall': 0.41760268793599686, 'f1-score': 0.4616747156182243, 'support': 655968}, '1': {'precision': 0.6390079711336208, 'recall': 0.3796941257210413, 'f1-score': 0.4763464680744093, 'support': 798498}, '2': {'precision': 0.4318568801918945, 'recall': 0.7284149129993519, 'f1-score': 0.5422367304956106, 'support': 654248}, 'accuracy': 0.49968037391509706, 'macro avg': {'precision': 0.5290038366593494, 'recall': 0.50857057555213, 'f1-score': 0.4934193047294147, 'support': 2108714}, 'weighted avg': {'precision': 0.5365183607018426, 'recall': 0.49968037391509706, 'f1-score': 0.4922255167710876, 'support': 2108714}}
[[273934  98212 283822]
 [152176 303185 343137]
 [104619  73065 476564]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0042732
{'0': {'precision': 0.5399948978736795, 'recall': 0.39430610208116346, 'f1-score': 0.455791620333442, 'support': 735454}, '1': {'precision': 0.5330484791189837, 'recall': 0.40107101186130817, 'f1-score': 0.4577364993573242, 'support': 641076}, '2': {'precision': 0.46365980588085715, 'recall': 0.6898252351867836, 'f1-score': 0.5545702341183026, 'support': 732184}, 'accuracy': 0.4989723594569961, 'macro avg': {'precision': 0.5122343942911735, 'recall': 0.4950674497097518, 'f1-score': 0.48936611793635626, 'support': 2108714}, 'weighted avg': {'precision': 0.511378160210223, 'recall': 0.4989723594569961, 'f1-score': 0.490680626533699, 'support': 2108714}}
[[289994 126709 318751]
 [118458 257117 265501]
 [128579  98526 505079]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.99743944
{'0': {'precision': 0.5515950958298013, 'recall': 0.35374247238468104, 'f1-score': 0.4310494114121921, 'support': 829612}, '1': {'precision': 0.3887749179812506, 'recall': 0.42126076237932925, 'f1-score': 0.4043664305499225, 'support': 457961}, '2': {'precision': 0.4884034322767664, 'recall': 0.6426362829282669, 'f1-score': 0.5550039703616447, 'support': 821141}, 'accuracy': 0.4809021043157109, 'macro avg': {'precision': 0.4762578153626061, 'recall': 0.4725465058974258, 'f1-score': 0.4634732707745865, 'support': 2108714}, 'weighted avg': {'precision': 0.4916274770492067, 'recall': 0.4809021043157109, 'f1-score': 0.4735228838184296, 'support': 2108714}}
[[293469 168079 368064]
 [ 80350 192921 184690]
 [158218 135228 527695]]
Evaluating performance on  train set...
1806/1806 - 30s - 30s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.87564206
{'0': {'precision': 0.4635649965365966, 'recall': 0.4532770415189759, 'f1-score': 0.4583632980605687, 'support': 88586}, '1': {'precision': 0.8303247110621904, 'recall': 0.581794916739702, 'f1-score': 0.6841894788918206, 'support': 285250}, '2': {'precision': 0.37191827998611054, 'recall': 0.7397058657035788, 'f1-score': 0.49496969696969695, 'support': 88327}, 'accuracy': 0.587340397219163, 'macro avg': {'precision': 0.5552693291949659, 'recall': 0.5915926079874189, 'f1-score': 0.5458408246406954, 'support': 462163}, 'weighted avg': {'precision': 0.6724162655383793, 'recall': 0.587340397219163, 'f1-score': 0.6047407698152552, 'support': 462163}}
[[ 40154  19527  28905]
 [ 37861 165957  81432]
 [  8605  14386  65336]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.88852453
{'0': {'precision': 0.538000136323359, 'recall': 0.4133542812254517, 'f1-score': 0.4675116981579103, 'support': 114570}, '1': {'precision': 0.7236624761377236, 'recall': 0.6272010287183883, 'f1-score': 0.6719877291034255, 'support': 233300}, '2': {'precision': 0.4477564195771658, 'recall': 0.6735758095421417, 'f1-score': 0.5379278058051623, 'support': 114293}, 'accuracy': 0.5856570084580548, 'macro avg': {'precision': 0.5698063440127494, 'recall': 0.5713770398286605, 'f1-score': 0.5591424110221661, 'support': 462163}, 'weighted avg': {'precision': 0.6094052439598824, 'recall': 0.5856570084580548, 'f1-score': 0.5881451677582809, 'support': 462163}}
[[ 47358  31418  35794]
 [ 27818 146326  59156]
 [ 12850  24458  76985]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9156191
{'0': {'precision': 0.571112242602219, 'recall': 0.3659796943529662, 'f1-score': 0.44609386922682054, 'support': 131786}, '1': {'precision': 0.6306086906595982, 'recall': 0.6620637344531737, 'f1-score': 0.6459535093437103, 'support': 199076}, '2': {'precision': 0.482632508624471, 'recall': 0.6201247515251217, 'f1-score': 0.5428073344955284, 'support': 131301}, 'accuracy': 0.5657203194543916, 'macro avg': {'precision': 0.5614511472954294, 'recall': 0.5493893934437538, 'f1-score': 0.5449515710220197, 'support': 462163}, 'weighted avg': {'precision': 0.5716030593540112, 'recall': 0.5657203194543916, 'f1-score': 0.559659499576192, 'support': 462163}}
[[ 48231  43026  40529]
 [ 20521 131801  46754]
 [ 15699  34179  81423]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9665336
{'0': {'precision': 0.5894566862054497, 'recall': 0.2997148897379701, 'f1-score': 0.3973787522929489, 'support': 154677}, '1': {'precision': 0.492085505016876, 'recall': 0.6951335011287267, 'f1-score': 0.5762460307430879, 'support': 154156}, '2': {'precision': 0.5083528907819561, 'recall': 0.5495336855149024, 'f1-score': 0.5281417571086965, 'support': 153330}, 'accuracy': 0.5144894766565044, 'macro avg': {'precision': 0.5299650273347606, 'recall': 0.5147940254605331, 'f1-score': 0.5005888467149111, 'support': 462163}, 'weighted avg': {'precision': 0.5300707190042889, 'recall': 0.5144894766565044, 'f1-score': 0.5004232532702193, 'support': 462163}}
[[ 46359  60767  47551]
 [ 13057 107159  33940]
 [ 19231  49839  84260]]
Evaluating performance on  val set...
642/642 - 11s - 11s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.88626266
{'0': {'precision': 0.4661832767664301, 'recall': 0.448991114677127, 'f1-score': 0.45742571259896164, 'support': 33651}, '1': {'precision': 0.8338375333442618, 'recall': 0.5735945380735638, 'f1-score': 0.6796557567217933, 'support': 97548}, '2': {'precision': 0.37900600225277353, 'recall': 0.7415693022974972, 'f1-score': 0.501633786709145, 'support': 33123}, 'accuracy': 0.5819366852886406, 'macro avg': {'precision': 0.5596756041211551, 'recall': 0.5880516516827293, 'f1-score': 0.5462384186766333, 'support': 164322}, 'weighted avg': {'precision': 0.6668646496619551, 'recall': 0.5819366852886406, 'f1-score': 0.598261391222917, 'support': 164322}}
[[15109  6425 12117]
 [13466 55953 28129]
 [ 3835  4725 24563]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8900332
{'0': {'precision': 0.5317396364938669, 'recall': 0.41566349384098544, 'f1-score': 0.4665907216089877, 'support': 42864}, '1': {'precision': 0.7308165473490743, 'recall': 0.6222126875559987, 'f1-score': 0.6721559539227047, 'support': 79243}, '2': {'precision': 0.45013260087137713, 'recall': 0.6754708042165107, 'f1-score': 0.5402461089586315, 'support': 42215}, 'accuracy': 0.5820157982497779, 'macro avg': {'precision': 0.5708962615714395, 'recall': 0.5711156618711649, 'f1-score': 0.5596642614967746, 'support': 164322}, 'weighted avg': {'precision': 0.6067777363106643, 'recall': 0.5820157982497779, 'f1-score': 0.584645321000433, 'support': 164322}}
[[17817 10271 14776]
 [ 9880 49306 20057]
 [ 5810  7890 28515]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.90990156
{'0': {'precision': 0.5571175356029583, 'recall': 0.37476358852068087, 'f1-score': 0.44809871445075344, 'support': 48644}, '1': {'precision': 0.6431950614434893, 'recall': 0.6596647978580199, 'f1-score': 0.6513258308807957, 'support': 67601}, '2': {'precision': 0.4817562793087942, 'recall': 0.6239574016681574, 'f1-score': 0.543712900448593, 'support': 48077}, 'accuracy': 0.5648787137449641, 'macro avg': {'precision': 0.5606896254517473, 'recall': 0.552795262682286, 'f1-score': 0.5477124819267141, 'support': 164322}, 'weighted avg': {'precision': 0.5704802241382196, 'recall': 0.5648787137449641, 'f1-score': 0.5596796319055398, 'support': 164322}}
[[18230 13866 16548]
 [ 7285 44594 15722]
 [ 7207 10872 29998]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.95050895
{'0': {'precision': 0.5696161875702586, 'recall': 0.3166794636001643, 'f1-score': 0.40705547522320923, 'support': 56003}, '1': {'precision': 0.5101799407155879, 'recall': 0.6952926449948792, 'f1-score': 0.5885233137747525, 'support': 52726}, '2': {'precision': 0.5070764715473667, 'recall': 0.559404961056248, 'f1-score': 0.5319569289190321, 'support': 55593}, 'accuracy': 0.5202833461131193, 'macro avg': {'precision': 0.5289575332777376, 'recall': 0.5237923565504304, 'f1-score': 0.5091785726389979, 'support': 164322}, 'weighted avg': {'precision': 0.5293866018512435, 'recall': 0.5202833461131193, 'f1-score': 0.5075394017259328, 'support': 164322}}
[[17735 19408 18860]
 [ 4695 36660 11371]
 [ 8705 15789 31099]]
training model: results/ATVI/W6/deepLOB_L1/seq2seq
Epoch 1/50
2046/2046 - 58s - loss: 12.3367 - accuracy10: 0.4625 - accuracy20: 0.4700 - accuracy30: 0.4650 - accuracy50: 0.4405 - val_loss: 13.0825 - val_accuracy10: 0.5051 - val_accuracy20: 0.4401 - val_accuracy30: 0.3805 - val_accuracy50: 0.3581 - 58s/epoch - 28ms/step
Epoch 2/50
2046/2046 - 46s - loss: 12.2682 - accuracy10: 0.4671 - accuracy20: 0.4783 - accuracy30: 0.4728 - accuracy50: 0.4449 - val_loss: 12.7496 - val_accuracy10: 0.5222 - val_accuracy20: 0.4844 - val_accuracy30: 0.4484 - val_accuracy50: 0.4155 - 46s/epoch - 22ms/step
Epoch 3/50
2046/2046 - 48s - loss: 12.0056 - accuracy10: 0.4973 - accuracy20: 0.5025 - accuracy30: 0.4935 - accuracy50: 0.4607 - val_loss: 12.8035 - val_accuracy10: 0.5328 - val_accuracy20: 0.4863 - val_accuracy30: 0.4483 - val_accuracy50: 0.4202 - 48s/epoch - 23ms/step
Epoch 4/50
2046/2046 - 50s - loss: 11.8097 - accuracy10: 0.5200 - accuracy20: 0.5188 - accuracy30: 0.5070 - accuracy50: 0.4716 - val_loss: 12.5305 - val_accuracy10: 0.5531 - val_accuracy20: 0.5029 - val_accuracy30: 0.4595 - val_accuracy50: 0.4257 - 50s/epoch - 25ms/step
Epoch 5/50
2046/2046 - 50s - loss: 11.6978 - accuracy10: 0.5303 - accuracy20: 0.5266 - accuracy30: 0.5130 - accuracy50: 0.4763 - val_loss: 12.5783 - val_accuracy10: 0.5533 - val_accuracy20: 0.4969 - val_accuracy30: 0.4499 - val_accuracy50: 0.4205 - 50s/epoch - 24ms/step
Epoch 6/50
2046/2046 - 52s - loss: 11.6185 - accuracy10: 0.5368 - accuracy20: 0.5323 - accuracy30: 0.5184 - accuracy50: 0.4803 - val_loss: 12.5417 - val_accuracy10: 0.5550 - val_accuracy20: 0.5018 - val_accuracy30: 0.4568 - val_accuracy50: 0.4257 - 52s/epoch - 26ms/step
Epoch 7/50
2046/2046 - 52s - loss: 11.5461 - accuracy10: 0.5441 - accuracy20: 0.5378 - accuracy30: 0.5224 - accuracy50: 0.4830 - val_loss: 12.5419 - val_accuracy10: 0.5600 - val_accuracy20: 0.5036 - val_accuracy30: 0.4556 - val_accuracy50: 0.4239 - 52s/epoch - 25ms/step
Epoch 8/50
2046/2046 - 49s - loss: 11.4924 - accuracy10: 0.5485 - accuracy20: 0.5414 - accuracy30: 0.5251 - accuracy50: 0.4850 - val_loss: 12.4203 - val_accuracy10: 0.5598 - val_accuracy20: 0.5089 - val_accuracy30: 0.4629 - val_accuracy50: 0.4305 - 49s/epoch - 24ms/step
Epoch 9/50
2046/2046 - 50s - loss: 11.4514 - accuracy10: 0.5516 - accuracy20: 0.5435 - accuracy30: 0.5270 - accuracy50: 0.4866 - val_loss: 12.4034 - val_accuracy10: 0.5572 - val_accuracy20: 0.5064 - val_accuracy30: 0.4592 - val_accuracy50: 0.4263 - 50s/epoch - 24ms/step
Epoch 10/50
2046/2046 - 52s - loss: 11.4196 - accuracy10: 0.5531 - accuracy20: 0.5452 - accuracy30: 0.5287 - accuracy50: 0.4880 - val_loss: 12.5738 - val_accuracy10: 0.5576 - val_accuracy20: 0.5006 - val_accuracy30: 0.4512 - val_accuracy50: 0.4193 - 52s/epoch - 25ms/step
Epoch 11/50
2046/2046 - 51s - loss: 11.3912 - accuracy10: 0.5546 - accuracy20: 0.5468 - accuracy30: 0.5300 - accuracy50: 0.4887 - val_loss: 12.5710 - val_accuracy10: 0.5559 - val_accuracy20: 0.4998 - val_accuracy30: 0.4522 - val_accuracy50: 0.4195 - 51s/epoch - 25ms/step
Epoch 12/50
2046/2046 - 51s - loss: 11.3643 - accuracy10: 0.5570 - accuracy20: 0.5481 - accuracy30: 0.5307 - accuracy50: 0.4897 - val_loss: 12.6580 - val_accuracy10: 0.5605 - val_accuracy20: 0.4997 - val_accuracy30: 0.4476 - val_accuracy50: 0.4155 - 51s/epoch - 25ms/step
Epoch 13/50
2046/2046 - 49s - loss: 11.3434 - accuracy10: 0.5583 - accuracy20: 0.5494 - accuracy30: 0.5318 - accuracy50: 0.4908 - val_loss: 12.6241 - val_accuracy10: 0.5624 - val_accuracy20: 0.4996 - val_accuracy30: 0.4446 - val_accuracy50: 0.4121 - 49s/epoch - 24ms/step
Epoch 14/50
2046/2046 - 52s - loss: 11.3211 - accuracy10: 0.5590 - accuracy20: 0.5501 - accuracy30: 0.5330 - accuracy50: 0.4915 - val_loss: 12.7662 - val_accuracy10: 0.5573 - val_accuracy20: 0.4959 - val_accuracy30: 0.4411 - val_accuracy50: 0.4074 - 52s/epoch - 25ms/step
Epoch 15/50
2046/2046 - 53s - loss: 11.3034 - accuracy10: 0.5606 - accuracy20: 0.5513 - accuracy30: 0.5339 - accuracy50: 0.4923 - val_loss: 12.8091 - val_accuracy10: 0.5583 - val_accuracy20: 0.4947 - val_accuracy30: 0.4411 - val_accuracy50: 0.4085 - 53s/epoch - 26ms/step
Epoch 16/50
2046/2046 - 54s - loss: 11.2858 - accuracy10: 0.5616 - accuracy20: 0.5522 - accuracy30: 0.5343 - accuracy50: 0.4936 - val_loss: 12.7217 - val_accuracy10: 0.5583 - val_accuracy20: 0.4962 - val_accuracy30: 0.4435 - val_accuracy50: 0.4109 - 54s/epoch - 26ms/step
Epoch 17/50
2046/2046 - 51s - loss: 11.2763 - accuracy10: 0.5619 - accuracy20: 0.5524 - accuracy30: 0.5354 - accuracy50: 0.4939 - val_loss: 12.6965 - val_accuracy10: 0.5579 - val_accuracy20: 0.4965 - val_accuracy30: 0.4433 - val_accuracy50: 0.4087 - 51s/epoch - 25ms/step
Epoch 18/50
2046/2046 - 49s - loss: 11.2636 - accuracy10: 0.5627 - accuracy20: 0.5535 - accuracy30: 0.5364 - accuracy50: 0.4943 - val_loss: 12.7029 - val_accuracy10: 0.5614 - val_accuracy20: 0.4946 - val_accuracy30: 0.4396 - val_accuracy50: 0.4072 - 49s/epoch - 24ms/step
Epoch 19/50
2046/2046 - 50s - loss: 11.2523 - accuracy10: 0.5635 - accuracy20: 0.5537 - accuracy30: 0.5367 - accuracy50: 0.4954 - val_loss: 12.7396 - val_accuracy10: 0.5581 - val_accuracy20: 0.4962 - val_accuracy30: 0.4418 - val_accuracy50: 0.4097 - 50s/epoch - 25ms/step
testing model: results/ATVI/W6/deepLOB_L1/seq2seq
Evaluating performance on  test set...
7324/7324 - 64s - 64s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9467107
{'0': {'precision': 0.4459788264964261, 'recall': 0.5651754018026128, 'f1-score': 0.49855156692482766, 'support': 488735}, '1': {'precision': 0.6089545832550902, 'recall': 0.5994184057098784, 'f1-score': 0.6041488659178754, 'support': 908881}, '2': {'precision': 0.4845508304708358, 'recall': 0.3663396843362888, 'f1-score': 0.41723393360380717, 'support': 477090}, 'accuracy': 0.5311755549936896, 'macro avg': {'precision': 0.5131614134074507, 'recall': 0.5103111639495933, 'f1-score': 0.5066447888155033, 'support': 1874706}, 'weighted avg': {'precision': 0.5348076274682705, 'recall': 0.5311755549936896, 'f1-score': 0.5290521088897943, 'support': 1874706}}
[[276221 157534  54980]
 [233139 544800 130942]
 [109999 192314 174777]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0198656
{'0': {'precision': 0.5078546874422449, 'recall': 0.49930786588125686, 'f1-score': 0.5035450123275804, 'support': 605374}, '1': {'precision': 0.4606760764096277, 'recall': 0.6456125974908989, 'f1-score': 0.537686564654242, 'support': 680961}, '2': {'precision': 0.541920108244411, 'recall': 0.2995168014739, 'f1-score': 0.3858023711607653, 'support': 588371}, 'accuracy': 0.489747192359762, 'macro avg': {'precision': 0.5034836240320946, 'recall': 0.4814790882820186, 'f1-score': 0.4756779827141959, 'support': 1874706}, 'weighted avg': {'precision': 0.50140904292807, 'recall': 0.489747192359762, 'f1-score': 0.4789932746620241, 'support': 1874706}}
[[302268 237707  65399]
 [157760 439637  83564]
 [135158 276986 176227]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0690424
{'0': {'precision': 0.5281473563881315, 'recall': 0.45438365831012073, 'f1-score': 0.4884965956950676, 'support': 673125}, '1': {'precision': 0.3645188189512751, 'recall': 0.6781512084806683, 'f1-score': 0.4741651166373212, 'support': 549202}, '2': {'precision': 0.563615317483212, 'recall': 0.23659559857076945, 'f1-score': 0.3332843897235694, 'support': 652379}, 'accuracy': 0.4441491092469966, 'macro avg': {'precision': 0.4854271642742061, 'recall': 0.4563768217871862, 'f1-score': 0.4319820340186527, 'support': 1874706}, 'weighted avg': {'precision': 0.49255427297870685, 'recall': 0.4441491092469966, 'f1-score': 0.4302858358847547, 'support': 1874706}}
[[305857 303276  63992]
 [121245 372442  55515]
 [152011 346018 154350]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.093157
{'0': {'precision': 0.47717388817413986, 'recall': 0.41486019790951, 'f1-score': 0.44384055895059255, 'support': 653531}, '1': {'precision': 0.3513094015065257, 'recall': 0.6527431786623666, 'f1-score': 0.4567784993785286, 'support': 580458}, '2': {'precision': 0.5143216774629294, 'recall': 0.18303088571085205, 'f1-score': 0.26998323986334044, 'support': 640717}, 'accuracy': 0.40928284221632616, 'macro avg': {'precision': 0.4476016557145317, 'recall': 0.4168780874275762, 'f1-score': 0.3902007660641538, 'support': 1874706}, 'weighted avg': {'precision': 0.45089892661090564, 'recall': 0.40928284221632616, 'f1-score': 0.3884273854243393, 'support': 1874706}}
[[271124 328375  54032]
 [144860 378890  56708]
 [152203 371243 117271]]
Evaluating performance on  train set...
2046/2046 - 19s - 19s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.92868525
{'0': {'precision': 0.4374978084785582, 'recall': 0.40570991919618904, 'f1-score': 0.42100468176641787, 'support': 123014}, '1': {'precision': 0.6100633189990857, 'recall': 0.7157375071777073, 'f1-score': 0.6586889833522223, 'support': 276899}, '2': {'precision': 0.45314987089243397, 'recall': 0.31034649827598737, 'f1-score': 0.3683933055997546, 'support': 123839}, 'accuracy': 0.5470680780216591, 'macro avg': {'precision': 0.5002369994566926, 'recall': 0.4772646415499613, 'f1-score': 0.4826956569061316, 'support': 523752}, 'weighted avg': {'precision': 0.532431198813861, 'recall': 0.5470680780216591, 'f1-score': 0.534224688967735, 'support': 523752}}
[[ 49908  61156  11950]
 [ 44282 198187  34430]
 [ 19886  65520  38433]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0098298
{'0': {'precision': 0.49600839377765615, 'recall': 0.35389963350410436, 'f1-score': 0.41307337532577065, 'support': 153617}, '1': {'precision': 0.48175715032036076, 'recall': 0.7430742726944344, 'f1-score': 0.5845397780675997, 'support': 215934}, '2': {'precision': 0.5090337300363815, 'recall': 0.2676701188708244, 'f1-score': 0.3508496043113487, 'support': 154201}, 'accuracy': 0.48896233331805894, 'macro avg': {'precision': 0.49559975804479944, 'recall': 0.45488134168978767, 'f1-score': 0.449487585901573, 'support': 523752}, 'weighted avg': {'precision': 0.4939677177930758, 'recall': 0.48896233331805894, 'f1-score': 0.4654463657782352, 'support': 523752}}
[[ 54365  84145  15107]
 [ 30776 160455  24703]
 [ 24464  88462  41275]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0590482
{'0': {'precision': 0.5223246599870471, 'recall': 0.3175454240153787, 'f1-score': 0.3949701478563352, 'support': 172706}, '1': {'precision': 0.39627510835624735, 'recall': 0.7630173864273696, 'f1-score': 0.5216367721601496, 'support': 178300}, '2': {'precision': 0.5261651025926515, 'recall': 0.2297940328574902, 'f1-score': 0.31988395986945484, 'support': 172746}, 'accuracy': 0.44025416609387646, 'macro avg': {'precision': 0.48158829031198197, 'recall': 0.4367856144334128, 'f1-score': 0.41216362662864653, 'support': 523752}, 'weighted avg': {'precision': 0.480680496418366, 'recall': 0.44025416609387646, 'f1-score': 0.41332582092944703, 'support': 523752}}
[[ 54842 101145  16719]
 [ 23225 136046  19029]
 [ 26929 106121  39696]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0848876
{'0': {'precision': 0.4866808398075849, 'recall': 0.28395209923118697, 'f1-score': 0.35865076385479544, 'support': 174945}, '1': {'precision': 0.3691928953749028, 'recall': 0.742893142551392, 'f1-score': 0.4932547678849405, 'support': 173811}, '2': {'precision': 0.4855498561241086, 'recall': 0.19959884797366798, 'f1-score': 0.28290264970660056, 'support': 174996}, 'accuracy': 0.408070995432953, 'macro avg': {'precision': 0.4471411971021988, 'recall': 0.40881469658541564, 'f1-score': 0.3782693938154455, 'support': 523752}, 'weighted avg': {'precision': 0.44731370664062314, 'recall': 0.408070995432953, 'f1-score': 0.3780111473206458, 'support': 523752}}
[[ 49676 107898  17371]
 [ 25051 129123  19637]
 [ 27344 112723  34929]]
Evaluating performance on  val set...
741/741 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9009089
{'0': {'precision': 0.45569234121363983, 'recall': 0.47452012524390796, 'f1-score': 0.4649156931832076, 'support': 44074}, '1': {'precision': 0.632445277155783, 'recall': 0.6874391528084083, 'f1-score': 0.6587965365080422, 'support': 100662}, '2': {'precision': 0.4516044340723454, 'recall': 0.3451420163196148, 'f1-score': 0.39126039376247884, 'support': 44854}, 'accuracy': 0.5569597552613534, 'macro avg': {'precision': 0.5132473508139227, 'recall': 0.5023670981239771, 'f1-score': 0.5049908744845762, 'support': 189590}, 'weighted avg': {'precision': 0.5485714226572413, 'recall': 0.5569597552613534, 'f1-score': 0.5504302174226039, 'support': 189590}}
[[20914 18421  4739]
 [17403 69199 14060]
 [ 7578 21795 15481]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.98519593
{'0': {'precision': 0.5165782036258358, 'recall': 0.40777015997388183, 'f1-score': 0.45577010795195383, 'support': 55134}, '1': {'precision': 0.5002710738020287, 'recall': 0.72719992881929, 'f1-score': 0.5927587510943725, 'support': 78673}, '2': {'precision': 0.5086568482134409, 'recall': 0.2891382679310901, 'f1-score': 0.36869656654322674, 'support': 55783}, 'accuracy': 0.5054169523709057, 'macro avg': {'precision': 0.5085020418804351, 'recall': 0.4747027855747539, 'f1-score': 0.47240847519651763, 'support': 189590}, 'weighted avg': {'precision': 0.5074806362773576, 'recall': 0.5054169523709057, 'f1-score': 0.48699582746005277, 'support': 189590}}
[[22482 26791  5861]
 [11743 57211  9719]
 [ 9296 30358 16129]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0396305
{'0': {'precision': 0.5429981373521372, 'recall': 0.36220612202088004, 'f1-score': 0.43454777760569924, 'support': 61973}, '1': {'precision': 0.4121171936513199, 'recall': 0.763563213095622, 'f1-score': 0.5353113426922745, 'support': 65121}, '2': {'precision': 0.5352949702855486, 'recall': 0.23636712749615976, 'f1-score': 0.3279314478533055, 'support': 62496}, 'accuracy': 0.4585843135186455, 'macro avg': {'precision': 0.49680343376300184, 'recall': 0.45404548753755397, 'f1-score': 0.43259685605042647, 'support': 189590}, 'weighted avg': {'precision': 0.4955034643011617, 'recall': 0.4585843135186455, 'f1-score': 0.4340136248434084, 'support': 189590}}
[[22447 33517  6009]
 [ 8582 49724  6815]
 [10310 37414 14772]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.070236
{'0': {'precision': 0.5126863982699223, 'recall': 0.3216178697627461, 'f1-score': 0.39527331594916587, 'support': 63392}, '1': {'precision': 0.3829936529199758, 'recall': 0.7555527590763229, 'f1-score': 0.5083181645006984, 'support': 63572}, '2': {'precision': 0.5018639138093482, 'recall': 0.19562162680037046, 'f1-score': 0.2815124602180682, 'support': 62626}, 'accuracy': 0.42550239991560734, 'macro avg': {'precision': 0.46584798833308216, 'recall': 0.4242640852131465, 'f1-score': 0.3950346468893109, 'support': 189590}, 'weighted avg': {'precision': 0.4656238099518955, 'recall': 0.42550239991560734, 'f1-score': 0.39560086361044705, 'support': 189590}}
[[20388 37338  5666]
 [ 9046 48032  6494]
 [10333 40042 12251]]
training model: results/ATVI/W6/deepOF_L1/seq2seq
Epoch 1/50
2046/2046 - 52s - loss: 12.7904 - accuracy10: 0.4404 - accuracy20: 0.4374 - accuracy30: 0.4301 - accuracy50: 0.4139 - val_loss: 14.4136 - val_accuracy10: 0.5285 - val_accuracy20: 0.4164 - val_accuracy30: 0.3458 - val_accuracy50: 0.3372 - 52s/epoch - 25ms/step
Epoch 2/50
2046/2046 - 43s - loss: 12.8552 - accuracy10: 0.4088 - accuracy20: 0.4156 - accuracy30: 0.4144 - accuracy50: 0.4026 - val_loss: 13.3510 - val_accuracy10: 0.5265 - val_accuracy20: 0.4242 - val_accuracy30: 0.3518 - val_accuracy50: 0.3394 - 43s/epoch - 21ms/step
Epoch 3/50
2046/2046 - 45s - loss: 12.8141 - accuracy10: 0.4186 - accuracy20: 0.4183 - accuracy30: 0.4134 - accuracy50: 0.4006 - val_loss: 13.3954 - val_accuracy10: 0.5276 - val_accuracy20: 0.4252 - val_accuracy30: 0.3553 - val_accuracy50: 0.3421 - 45s/epoch - 22ms/step
Epoch 4/50
2046/2046 - 50s - loss: 12.7567 - accuracy10: 0.4309 - accuracy20: 0.4280 - accuracy30: 0.4207 - accuracy50: 0.4062 - val_loss: 13.5244 - val_accuracy10: 0.5307 - val_accuracy20: 0.4266 - val_accuracy30: 0.3569 - val_accuracy50: 0.3440 - 50s/epoch - 24ms/step
Epoch 5/50
2046/2046 - 49s - loss: 12.7041 - accuracy10: 0.4409 - accuracy20: 0.4359 - accuracy30: 0.4269 - accuracy50: 0.4109 - val_loss: 13.6398 - val_accuracy10: 0.5327 - val_accuracy20: 0.4277 - val_accuracy30: 0.3585 - val_accuracy50: 0.3460 - 49s/epoch - 24ms/step
Epoch 6/50
2046/2046 - 49s - loss: 12.6595 - accuracy10: 0.4470 - accuracy20: 0.4401 - accuracy30: 0.4310 - accuracy50: 0.4146 - val_loss: 13.6964 - val_accuracy10: 0.5335 - val_accuracy20: 0.4292 - val_accuracy30: 0.3612 - val_accuracy50: 0.3482 - 49s/epoch - 24ms/step
Epoch 7/50
2046/2046 - 48s - loss: 12.6234 - accuracy10: 0.4496 - accuracy20: 0.4428 - accuracy30: 0.4341 - accuracy50: 0.4170 - val_loss: 13.7405 - val_accuracy10: 0.5341 - val_accuracy20: 0.4302 - val_accuracy30: 0.3625 - val_accuracy50: 0.3496 - 48s/epoch - 23ms/step
Epoch 8/50
2046/2046 - 45s - loss: 12.5879 - accuracy10: 0.4538 - accuracy20: 0.4469 - accuracy30: 0.4379 - accuracy50: 0.4206 - val_loss: 13.7526 - val_accuracy10: 0.5345 - val_accuracy20: 0.4314 - val_accuracy30: 0.3638 - val_accuracy50: 0.3504 - 45s/epoch - 22ms/step
Epoch 9/50
2046/2046 - 46s - loss: 12.5638 - accuracy10: 0.4551 - accuracy20: 0.4494 - accuracy30: 0.4408 - accuracy50: 0.4225 - val_loss: 13.7804 - val_accuracy10: 0.5342 - val_accuracy20: 0.4323 - val_accuracy30: 0.3654 - val_accuracy50: 0.3518 - 46s/epoch - 23ms/step
Epoch 10/50
2046/2046 - 48s - loss: 12.5302 - accuracy10: 0.4585 - accuracy20: 0.4530 - accuracy30: 0.4453 - accuracy50: 0.4262 - val_loss: 13.7623 - val_accuracy10: 0.5347 - val_accuracy20: 0.4335 - val_accuracy30: 0.3671 - val_accuracy50: 0.3534 - 48s/epoch - 23ms/step
Epoch 11/50
2046/2046 - 46s - loss: 12.4995 - accuracy10: 0.4620 - accuracy20: 0.4570 - accuracy30: 0.4486 - accuracy50: 0.4285 - val_loss: 13.7458 - val_accuracy10: 0.5351 - val_accuracy20: 0.4352 - val_accuracy30: 0.3688 - val_accuracy50: 0.3549 - 46s/epoch - 22ms/step
Epoch 12/50
2046/2046 - 46s - loss: 12.4717 - accuracy10: 0.4637 - accuracy20: 0.4589 - accuracy30: 0.4513 - accuracy50: 0.4311 - val_loss: 13.7450 - val_accuracy10: 0.5351 - val_accuracy20: 0.4360 - val_accuracy30: 0.3710 - val_accuracy50: 0.3567 - 46s/epoch - 23ms/step
testing model: results/ATVI/W6/deepOF_L1/seq2seq
Evaluating performance on  test set...
7324/7324 - 70s - 70s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0273933
{'0': {'precision': 0.439867865562805, 'recall': 0.06566175327173175, 'f1-score': 0.11426628306105882, 'support': 488732}, '1': {'precision': 0.4897339375341944, 'recall': 0.9060789103071912, 'f1-score': 0.6358124488503883, 'support': 908880}, '2': {'precision': 0.4315347173108125, 'recall': 0.10870927646623586, 'f1-score': 0.1736690363216882, 'support': 477089}, 'accuracy': 0.48406225846148265, 'macro avg': {'precision': 0.4537121734692707, 'recall': 0.36014998001505294, 'f1-score': 0.30791592274437846, 'support': 1874701}, 'weighted avg': {'precision': 0.4619229144089739, 'recall': 0.48406225846148265, 'f1-score': 0.3822360976144015, 'support': 1874701}}
[[ 32091 443388  13253]
 [ 30295 823517  55068]
 [ 10570 414655  51864]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1024362
{'0': {'precision': 0.5094871416992115, 'recall': 0.04568588291846514, 'f1-score': 0.08385266888701248, 'support': 605373}, '1': {'precision': 0.3655795397600234, 'recall': 0.93955142673788, 'f1-score': 0.5263544992566986, 'support': 680959}, '2': {'precision': 0.5097540167780463, 'recall': 0.06093284996320336, 'f1-score': 0.1088539682009537, 'support': 588369}, 'accuracy': 0.37515529143047344, 'macro avg': {'precision': 0.4616068994124271, 'recall': 0.3487233865398494, 'f1-score': 0.23968704544822161, 'support': 1874701}, 'weighted avg': {'precision': 0.4572984696466289, 'recall': 0.37515529143047344, 'f1-score': 0.2524318681207865, 'support': 1874701}}
[[ 27657 567512  10204]
 [ 16888 639796  24275]
 [  9739 542779  35851]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1410941
{'0': {'precision': 0.5418941652155949, 'recall': 0.02727729214825203, 'f1-score': 0.05194007980119009, 'support': 673124}, '1': {'precision': 0.2940967141367608, 'recall': 0.9675875178895925, 'f1-score': 0.451086416755868, 'support': 549202}, '2': {'precision': 0.5629605612214821, 'recall': 0.02927610653381874, 'f1-score': 0.05565779446627646, 'support': 652375}, 'accuracy': 0.3034409220457022, 'macro avg': {'precision': 0.4663171468579459, 'recall': 0.34138030552388776, 'f1-score': 0.1862280970077782, 'support': 1874701}, 'weighted avg': {'precision': 0.4766316696853438, 'recall': 0.3034409220457022, 'f1-score': 0.17016549849612797, 'support': 1874701}}
[[ 18361 649205   5558]
 [  8532 531401   9269]
 [  6990 626286  19099]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1313723
{'0': {'precision': 0.5012097812097812, 'recall': 0.01489755634783407, 'f1-score': 0.028935069952671425, 'support': 653530}, '1': {'precision': 0.3100313897079806, 'recall': 0.9826533231574431, 'f1-score': 0.4713498540635774, 'support': 580457}, '2': {'precision': 0.5577059544545513, 'recall': 0.013492759640026596, 'f1-score': 0.026348071897167848, 'support': 640714}, 'accuracy': 0.3140602154690268, 'macro avg': {'precision': 0.4563157084574377, 'recall': 0.3370145463817679, 'f1-score': 0.17554433197113886, 'support': 1874701}, 'weighted avg': {'precision': 0.46132451606530694, 'recall': 0.3140602154690268, 'f1-score': 0.16503423054869723, 'support': 1874701}}
[[  9736 641471   2323]
 [  5536 570388   4533]
 [  4153 627916   8645]]
Evaluating performance on  train set...
2046/2046 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.99717474
{'0': {'precision': 0.45186650436193954, 'recall': 0.07232211714088566, 'f1-score': 0.124687720869693, 'support': 123185}, '1': {'precision': 0.537638424421173, 'recall': 0.9106172714555779, 'f1-score': 0.6760999959743972, 'support': 276653}, '2': {'precision': 0.4195222382040218, 'recall': 0.1200448705532959, 'f1-score': 0.1866736943822199, 'support': 123912}, 'accuracy': 0.5264133651551313, 'macro avg': {'precision': 0.4696757223290448, 'recall': 0.36766141971658645, 'f1-score': 0.3291538037421034, 'support': 523750}, 'weighted avg': {'precision': 0.48952037795045933, 'recall': 0.5264133651551313, 'f1-score': 0.43061739360368056, 'support': 523750}}
[[  8909 110369   3907]
 [  8053 251925  16675]
 [  2754 106283  14875]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0702783
{'0': {'precision': 0.5171002428026361, 'recall': 0.04852169611123407, 'f1-score': 0.08871855603230241, 'support': 153622}, '1': {'precision': 0.4174333615108613, 'recall': 0.9449948103940393, 'f1-score': 0.5790725242587506, 'support': 215816}, '2': {'precision': 0.4993739766926707, 'recall': 0.06720151381616465, 'f1-score': 0.11846148573778545, 'support': 154312}, 'accuracy': 0.4234252983293556, 'macro avg': {'precision': 0.4779691936687227, 'recall': 0.3535726734404793, 'f1-score': 0.2620841886762795, 'support': 523750}, 'weighted avg': {'precision': 0.4708089144421079, 'recall': 0.4234252983293556, 'f1-score': 0.29953654739358476, 'support': 523750}}
[[  7454 143115   3053]
 [  4528 203945   7343]
 [  2433 141509  10370]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.111848
{'0': {'precision': 0.5604026845637584, 'recall': 0.0289947334915215, 'f1-score': 0.055136741319539974, 'support': 172790}, '1': {'precision': 0.3425746812963785, 'recall': 0.9707337620398192, 'f1-score': 0.506429104056701, 'support': 178055}, '2': {'precision': 0.5459770114942529, 'recall': 0.03241664497845638, 'f1-score': 0.061199644048457444, 'support': 172905}, 'accuracy': 0.3502797136038186, 'macro avg': {'precision': 0.48298479245146336, 'recall': 0.34404838016993233, 'f1-score': 0.2075884964748995, 'support': 523750}, 'weighted avg': {'precision': 0.4815871501984006, 'recall': 0.3502797136038186, 'f1-score': 0.2105604508059528, 'support': 523750}}
[[  5010 166049   1731]
 [  2281 172844   2930]
 [  1649 165651   5605]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1167564
{'0': {'precision': 0.5477838040022442, 'recall': 0.01673484779230277, 'f1-score': 0.0324775046986489, 'support': 175024}, '1': {'precision': 0.3328355302868046, 'recall': 0.9842126172394535, 'f1-score': 0.497447157097689, 'support': 173683}, '2': {'precision': 0.5584874298774153, 'recall': 0.015356226755711454, 'f1-score': 0.029890579129970646, 'support': 175043}, 'accuracy': 0.3371035799522673, 'macro avg': {'precision': 0.4797022547221547, 'recall': 0.33876789726248924, 'f1-score': 0.18660508030876952, 'support': 523750}, 'weighted avg': {'precision': 0.48008114769742105, 'recall': 0.3371035799522673, 'f1-score': 0.1858035207851488, 'support': 523750}}
[[  2929 171303    792]
 [  1409 170941   1333]
 [  1009 171346   2688]]
Evaluating performance on  val set...
741/741 - 7s - 7s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.99732894
{'0': {'precision': 0.4584837545126354, 'recall': 0.07186347072270885, 'f1-score': 0.12425155559034162, 'support': 44181}, '1': {'precision': 0.5386695384471315, 'recall': 0.9148798695812086, 'f1-score': 0.6780889791016624, 'support': 100599}, '2': {'precision': 0.397476073515711, 'recall': 0.10473108681097969, 'f1-score': 0.16578059593408342, 'support': 44810}, 'accuracy': 0.5269476238198217, 'macro avg': {'precision': 0.46487645549182594, 'recall': 0.363824809038299, 'f1-score': 0.32270704354202917, 'support': 189590}, 'weighted avg': {'precision': 0.4866121130365776, 'recall': 0.5269476238198217, 'f1-score': 0.4279406070467393, 'support': 189590}}
[[ 3175 39698  1308]
 [ 2757 92036  5806]
 [  993 39124  4693]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0702821
{'0': {'precision': 0.5270808442851453, 'recall': 0.047978974080116005, 'f1-score': 0.08795188729399256, 'support': 55170}, '1': {'precision': 0.41910821575643015, 'recall': 0.947523052464229, 'f1-score': 0.5811585101860122, 'support': 78625}, '2': {'precision': 0.47592483852025835, 'recall': 0.058105565014786274, 'f1-score': 0.10356669382017986, 'support': 55795}, 'accuracy': 0.4240097051532254, 'macro avg': {'precision': 0.47403796618727795, 'recall': 0.3512025305197104, 'f1-score': 0.25755903043339484, 'support': 189590}, 'weighted avg': {'precision': 0.46724858910437583, 'recall': 0.4240097051532254, 'f1-score': 0.2970852743661676, 'support': 189590}}
[[ 2647 51544   979]
 [ 1535 74499  2591]
 [  840 51713  3242]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1113129
{'0': {'precision': 0.5551244746201099, 'recall': 0.027715005165289255, 'f1-score': 0.05279421938657852, 'support': 61952}, '1': {'precision': 0.34521717298518706, 'recall': 0.972837455395595, 'f1-score': 0.5095998130795942, 'support': 65016}, '2': {'precision': 0.5303446172613602, 'recall': 0.027769793363354733, 'f1-score': 0.05277613389781642, 'support': 62622}, 'accuracy': 0.3518434516588428, 'macro avg': {'precision': 0.47689542162221904, 'recall': 0.34277408464141296, 'f1-score': 0.20505672212132972, 'support': 189590}, 'weighted avg': {'precision': 0.4749562307748872, 'recall': 0.3518434516588428, 'f1-score': 0.20944035014277793, 'support': 189590}}
[[ 1717 59667   568]
 [  794 63250   972]
 [  582 60301  1739]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1164762
{'0': {'precision': 0.5416909620991254, 'recall': 0.01465253462035898, 'f1-score': 0.028533255524670977, 'support': 63402}, '1': {'precision': 0.3362101333447762, 'recall': 0.9866051753447082, 'f1-score': 0.5015162062040437, 'support': 63532}, '2': {'precision': 0.5287994448299792, 'recall': 0.01216164453524004, 'f1-score': 0.023776463797057584, 'support': 62656}, 'accuracy': 0.33953267577403873, 'macro avg': {'precision': 0.46890018009129353, 'recall': 0.3378064515001023, 'f1-score': 0.18460864184192408, 'support': 189590}, 'weighted avg': {'precision': 0.4685735038026069, 'recall': 0.33953267577403873, 'f1-score': 0.18545878577456054, 'support': 189590}}
[[  929 62214   259]
 [  431 62681   420]
 [  355 61539   762]]
training model: results/ATVI/W6/deepLOB_L2/seq2seq
Epoch 1/50
2046/2046 - 103s - loss: 12.3379 - accuracy10: 0.4626 - accuracy20: 0.4666 - accuracy30: 0.4620 - accuracy50: 0.4392 - val_loss: 12.6611 - val_accuracy10: 0.4128 - val_accuracy20: 0.4223 - val_accuracy30: 0.4151 - val_accuracy50: 0.3978 - 103s/epoch - 50ms/step
Epoch 2/50
2046/2046 - 96s - loss: 11.9971 - accuracy10: 0.4944 - accuracy20: 0.4983 - accuracy30: 0.4900 - accuracy50: 0.4584 - val_loss: 12.1180 - val_accuracy10: 0.5098 - val_accuracy20: 0.5037 - val_accuracy30: 0.4873 - val_accuracy50: 0.4513 - 96s/epoch - 47ms/step
Epoch 3/50
2046/2046 - 96s - loss: 11.7182 - accuracy10: 0.5291 - accuracy20: 0.5236 - accuracy30: 0.5105 - accuracy50: 0.4751 - val_loss: 11.9291 - val_accuracy10: 0.4920 - val_accuracy20: 0.5022 - val_accuracy30: 0.4974 - val_accuracy50: 0.4644 - 96s/epoch - 47ms/step
Epoch 4/50
2046/2046 - 97s - loss: 11.5115 - accuracy10: 0.5505 - accuracy20: 0.5403 - accuracy30: 0.5240 - accuracy50: 0.4861 - val_loss: 11.8385 - val_accuracy10: 0.5248 - val_accuracy20: 0.5204 - val_accuracy30: 0.5050 - val_accuracy50: 0.4683 - 97s/epoch - 47ms/step
Epoch 5/50
2046/2046 - 97s - loss: 11.3779 - accuracy10: 0.5612 - accuracy20: 0.5501 - accuracy30: 0.5317 - accuracy50: 0.4914 - val_loss: 11.6237 - val_accuracy10: 0.5403 - val_accuracy20: 0.5329 - val_accuracy30: 0.5157 - val_accuracy50: 0.4769 - 97s/epoch - 47ms/step
Epoch 6/50
2046/2046 - 96s - loss: 11.2856 - accuracy10: 0.5680 - accuracy20: 0.5560 - accuracy30: 0.5369 - accuracy50: 0.4951 - val_loss: 11.5914 - val_accuracy10: 0.5381 - val_accuracy20: 0.5322 - val_accuracy30: 0.5161 - val_accuracy50: 0.4766 - 96s/epoch - 47ms/step
Epoch 7/50
2046/2046 - 96s - loss: 11.2137 - accuracy10: 0.5730 - accuracy20: 0.5604 - accuracy30: 0.5408 - accuracy50: 0.4979 - val_loss: 11.6103 - val_accuracy10: 0.5389 - val_accuracy20: 0.5320 - val_accuracy30: 0.5151 - val_accuracy50: 0.4761 - 96s/epoch - 47ms/step
Epoch 8/50
2046/2046 - 97s - loss: 11.1653 - accuracy10: 0.5744 - accuracy20: 0.5624 - accuracy30: 0.5430 - accuracy50: 0.4997 - val_loss: 11.5104 - val_accuracy10: 0.5537 - val_accuracy20: 0.5419 - val_accuracy30: 0.5216 - val_accuracy50: 0.4797 - 97s/epoch - 47ms/step
Epoch 9/50
2046/2046 - 98s - loss: 11.1231 - accuracy10: 0.5758 - accuracy20: 0.5644 - accuracy30: 0.5454 - accuracy50: 0.5016 - val_loss: 11.5896 - val_accuracy10: 0.5443 - val_accuracy20: 0.5371 - val_accuracy30: 0.5198 - val_accuracy50: 0.4792 - 98s/epoch - 48ms/step
Epoch 10/50
2046/2046 - 96s - loss: 11.0890 - accuracy10: 0.5769 - accuracy20: 0.5661 - accuracy30: 0.5470 - accuracy50: 0.5033 - val_loss: 11.6964 - val_accuracy10: 0.5333 - val_accuracy20: 0.5301 - val_accuracy30: 0.5152 - val_accuracy50: 0.4756 - 96s/epoch - 47ms/step
Epoch 11/50
2046/2046 - 96s - loss: 11.0648 - accuracy10: 0.5783 - accuracy20: 0.5671 - accuracy30: 0.5478 - accuracy50: 0.5040 - val_loss: 11.5803 - val_accuracy10: 0.5455 - val_accuracy20: 0.5369 - val_accuracy30: 0.5186 - val_accuracy50: 0.4781 - 96s/epoch - 47ms/step
Epoch 12/50
2046/2046 - 96s - loss: 11.0386 - accuracy10: 0.5796 - accuracy20: 0.5686 - accuracy30: 0.5493 - accuracy50: 0.5053 - val_loss: 11.7689 - val_accuracy10: 0.5316 - val_accuracy20: 0.5283 - val_accuracy30: 0.5133 - val_accuracy50: 0.4736 - 96s/epoch - 47ms/step
Epoch 13/50
2046/2046 - 96s - loss: 11.0147 - accuracy10: 0.5805 - accuracy20: 0.5696 - accuracy30: 0.5506 - accuracy50: 0.5065 - val_loss: 11.7336 - val_accuracy10: 0.5322 - val_accuracy20: 0.5291 - val_accuracy30: 0.5140 - val_accuracy50: 0.4750 - 96s/epoch - 47ms/step
Epoch 14/50
2046/2046 - 95s - loss: 10.9988 - accuracy10: 0.5812 - accuracy20: 0.5705 - accuracy30: 0.5513 - accuracy50: 0.5073 - val_loss: 11.7620 - val_accuracy10: 0.5352 - val_accuracy20: 0.5293 - val_accuracy30: 0.5118 - val_accuracy50: 0.4724 - 95s/epoch - 47ms/step
Epoch 15/50
2046/2046 - 96s - loss: 10.9801 - accuracy10: 0.5814 - accuracy20: 0.5710 - accuracy30: 0.5525 - accuracy50: 0.5082 - val_loss: 11.7830 - val_accuracy10: 0.5331 - val_accuracy20: 0.5273 - val_accuracy30: 0.5105 - val_accuracy50: 0.4714 - 96s/epoch - 47ms/step
Epoch 16/50
2046/2046 - 97s - loss: 10.9599 - accuracy10: 0.5822 - accuracy20: 0.5724 - accuracy30: 0.5533 - accuracy50: 0.5092 - val_loss: 11.8803 - val_accuracy10: 0.5342 - val_accuracy20: 0.5260 - val_accuracy30: 0.5082 - val_accuracy50: 0.4693 - 97s/epoch - 47ms/step
Epoch 17/50
2046/2046 - 96s - loss: 10.9453 - accuracy10: 0.5834 - accuracy20: 0.5734 - accuracy30: 0.5546 - accuracy50: 0.5103 - val_loss: 11.9109 - val_accuracy10: 0.5349 - val_accuracy20: 0.5253 - val_accuracy30: 0.5069 - val_accuracy50: 0.4676 - 96s/epoch - 47ms/step
Epoch 18/50
2046/2046 - 97s - loss: 10.9275 - accuracy10: 0.5843 - accuracy20: 0.5747 - accuracy30: 0.5555 - accuracy50: 0.5109 - val_loss: 11.7861 - val_accuracy10: 0.5411 - val_accuracy20: 0.5302 - val_accuracy30: 0.5098 - val_accuracy50: 0.4689 - 97s/epoch - 48ms/step
testing model: results/ATVI/W6/deepLOB_L2/seq2seq
Evaluating performance on  test set...
7324/7324 - 116s - 116s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.94132406
{'0': {'precision': 0.4318219025404139, 'recall': 0.6746232620950003, 'f1-score': 0.5265820844033884, 'support': 488735}, '1': {'precision': 0.7257993706886505, 'recall': 0.5002195006827076, 'f1-score': 0.5922567870355896, 'support': 908881}, '2': {'precision': 0.48509602491903375, 'recall': 0.49290490263891507, 'f1-score': 0.4889692886698688, 'support': 477090}, 'accuracy': 0.5438250050941321, 'macro avg': {'precision': 0.5475724327160327, 'recall': 0.5559158884722076, 'f1-score': 0.5359360533696157, 'support': 1874706}, 'weighted avg': {'precision': 0.587903488812423, 'recall': 0.5438250050941321, 'f1-score': 0.5488500030458596, 'support': 1874706}}
[[329712  76526  82497]
 [287128 454640 167113]
 [146697  95233 235160]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.94882
{'0': {'precision': 0.4889847328244275, 'recall': 0.6348835595846535, 'f1-score': 0.5524639672726385, 'support': 605374}, '1': {'precision': 0.5909887506241495, 'recall': 0.5318630582368153, 'f1-score': 0.5598692219401066, 'support': 680961}, '2': {'precision': 0.5411665321767198, 'recall': 0.43769322417318324, 'f1-score': 0.48396089990725805, 'support': 588371}, 'accuracy': 0.5355751781879399, 'macro avg': {'precision': 0.5403800052084323, 'recall': 0.5348132806648841, 'f1-score': 0.5320980297066676, 'support': 1874706}, 'weighted avg': {'precision': 0.5424133853340071, 'recall': 0.5355751781879399, 'f1-score': 0.5336543359890012, 'support': 1874706}}
[[384342 113701 107331]
 [207768 362178 111015]
 [193890 136955 257526]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9690336
{'0': {'precision': 0.5065473978952859, 'recall': 0.611688765088208, 'f1-score': 0.5541751600136477, 'support': 673125}, '1': {'precision': 0.4935364007066293, 'recall': 0.5412489393702135, 'f1-score': 0.5162926900437517, 'support': 549202}, '2': {'precision': 0.5573408070187654, 'recall': 0.3926184012667483, 'f1-score': 0.4606982167315528, 'support': 652379}, 'accuracy': 0.5148188569301, 'macro avg': {'precision': 0.5191415352068937, 'recall': 0.5151853685750566, 'f1-score': 0.5103886889296507, 'support': 1874706}, 'weighted avg': {'precision': 0.5204113785794903, 'recall': 0.5148188569301, 'f1-score': 0.5105483070277199, 'support': 1874706}}
[[411743 140612 120770]
 [169285 297255  82662]
 [231814 164429 256136]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.027722
{'0': {'precision': 0.45890893897056906, 'recall': 0.5915648989871942, 'f1-score': 0.5168608875671217, 'support': 653531}, '1': {'precision': 0.4538600336170362, 'recall': 0.46843699285736434, 'f1-score': 0.4610333183842436, 'support': 580458}, '2': {'precision': 0.5073979762627581, 'recall': 0.3430282012183226, 'f1-score': 0.4093284513295763, 'support': 640717}, 'accuracy': 0.46849906065271035, 'macro avg': {'precision': 0.47338898295012105, 'recall': 0.46767669768762704, 'f1-score': 0.46240755242698056, 'support': 1874706}, 'weighted avg': {'precision': 0.47391773128415765, 'recall': 0.46849906065271035, 'f1-score': 0.46282392438379244, 'support': 1874706}}
[[386606 152115 114810]
 [209985 271908  98565]
 [245855 175078 219784]]
Evaluating performance on  train set...
2046/2046 - 33s - 33s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9411526
{'0': {'precision': 0.41337301362161716, 'recall': 0.6515193392621978, 'f1-score': 0.5058173475924355, 'support': 123014}, '1': {'precision': 0.7562538054962878, 'recall': 0.533779464714571, 'f1-score': 0.6258330863361139, 'support': 276899}, '2': {'precision': 0.4410837028000119, 'recall': 0.4787990859099314, 'f1-score': 0.4591682251313563, 'support': 123839}, 'accuracy': 0.5484332279399411, 'macro avg': {'precision': 0.5369035073059724, 'recall': 0.5546992966289, 'f1-score': 0.5302728863533018, 'support': 523752}, 'weighted avg': {'precision': 0.6012004823978082, 'recall': 0.5484332279399411, 'f1-score': 0.558237686542794, 'support': 523752}}
[[ 80146  21348  21520]
 [ 75482 147803  53614]
 [ 38255  26290  59294]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9515561
{'0': {'precision': 0.4680994525912015, 'recall': 0.610095236855296, 'f1-score': 0.5297470840763863, 'support': 153617}, '1': {'precision': 0.6355044089695786, 'recall': 0.5667194605759167, 'f1-score': 0.5991441776663664, 'support': 215934}, '2': {'precision': 0.5010689144410341, 'recall': 0.42559386774404834, 'f1-score': 0.4602577364776015, 'support': 154201}, 'accuracy': 0.5378919794101025, 'macro avg': {'precision': 0.5348909253339381, 'recall': 0.5341361883917536, 'f1-score': 0.5297163327401181, 'support': 523752}, 'weighted avg': {'precision': 0.5468243946197083, 'recall': 0.5378919794101025, 'f1-score': 0.5378995400444371, 'support': 523752}}
[[ 93721  31781  28115]
 [ 56328 122374  37232]
 [ 50167  38407  65627]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9703313
{'0': {'precision': 0.4891791170699488, 'recall': 0.5875128831656109, 'f1-score': 0.5338556121737621, 'support': 172706}, '1': {'precision': 0.544316837928044, 'recall': 0.5808132361189007, 'f1-score': 0.5619731112045693, 'support': 178300}, '2': {'precision': 0.5267858559258848, 'recall': 0.38446042165954636, 'f1-score': 0.4445083997055083, 'support': 172746}, 'accuracy': 0.5182605507950327, 'macro avg': {'precision': 0.5200939369746259, 'recall': 0.5175955136480194, 'f1-score': 0.5134457076946133, 'support': 523752}, 'weighted avg': {'precision': 0.5203531638314044, 'recall': 0.5182605507950327, 'f1-score': 0.513958745932014, 'support': 523752}}
[[101467  39742  31497]
 [ 46578 103559  28163]
 [ 59378  46954  66414]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0199726
{'0': {'precision': 0.4590802335620063, 'recall': 0.5653605418845923, 'f1-score': 0.5067073779877098, 'support': 174945}, '1': {'precision': 0.4869853014803923, 'recall': 0.531634936799167, 'f1-score': 0.508331545448044, 'support': 173811}, '2': {'precision': 0.49433615330763586, 'recall': 0.3349105122402798, 'f1-score': 0.3992982575667252, 'support': 174996}, 'accuracy': 0.47717049290503905, 'macro avg': {'precision': 0.4801338961166781, 'recall': 0.4773019969746797, 'f1-score': 0.4714457270008263, 'support': 523752}, 'weighted avg': {'precision': 0.48012044475312116, 'recall': 0.47717049290503905, 'f1-score': 0.4713588384752259, 'support': 523752}}
[[98907 45110 30928]
 [52384 92404 29023]
 [64155 52233 58608]]
Evaluating performance on  val set...
741/741 - 13s - 13s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.93401337
{'0': {'precision': 0.40744405438009135, 'recall': 0.6820347597222852, 'f1-score': 0.5101356797990684, 'support': 44074}, '1': {'precision': 0.7660404112017015, 'recall': 0.5366970654268741, 'f1-score': 0.6311811060419307, 'support': 100662}, '2': {'precision': 0.46239621974916095, 'recall': 0.46687029027511484, 'f1-score': 0.464622484524417, 'support': 44854}, 'accuracy': 0.5539638166569967, 'macro avg': {'precision': 0.5452935617769846, 'recall': 0.5618673718080913, 'f1-score': 0.5353130901218054, 'support': 189590}, 'weighted avg': {'precision': 0.6108400715531552, 'recall': 0.5539638166569967, 'f1-score': 0.5636365281328929, 'support': 189590}}
[[30060  6926  7088]
 [29378 54025 17259]
 [14339  9574 20941]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9440396
{'0': {'precision': 0.4627147516737755, 'recall': 0.6355424964631625, 'f1-score': 0.5355300662535056, 'support': 55134}, '1': {'precision': 0.6438722285287314, 'recall': 0.5695600777903473, 'f1-score': 0.6044406674490443, 'support': 78673}, '2': {'precision': 0.5174610345606505, 'recall': 0.410662746714949, 'f1-score': 0.4579173038289706, 'support': 55783}, 'accuracy': 0.5419958858589589, 'macro avg': {'precision': 0.5413493382543858, 'recall': 0.5385884403228196, 'f1-score': 0.5326293458438401, 'support': 189590}, 'weighted avg': {'precision': 0.5539965390828608, 'recall': 0.5419958858589589, 'f1-score': 0.541289499775995, 'support': 189590}}
[[35040 10732  9362]
 [21864 44809 12000]
 [18823 14052 22908]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9628453
{'0': {'precision': 0.4854082245714505, 'recall': 0.6127345779613703, 'f1-score': 0.5416898475057418, 'support': 61973}, '1': {'precision': 0.5523960591993248, 'recall': 0.5828995254986871, 'f1-score': 0.567238004154276, 'support': 65121}, '2': {'precision': 0.5378716818309727, 'recall': 0.36701548899129544, 'f1-score': 0.436313486779532, 'support': 62496}, 'accuracy': 0.5214884751305449, 'macro avg': {'precision': 0.5252253218672492, 'recall': 0.5208831974837843, 'f1-score': 0.5150804461465166, 'support': 189590}, 'weighted avg': {'precision': 0.5257113576675679, 'recall': 0.5214884751305449, 'f1-score': 0.515729198047247, 'support': 189590}}
[[37973 13574 10426]
 [17881 37959  9281]
 [22375 17184 22937]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0159167
{'0': {'precision': 0.4596071080637802, 'recall': 0.5879290762241293, 'f1-score': 0.5159084459763433, 'support': 63392}, '1': {'precision': 0.4923539807498503, 'recall': 0.5302648964953124, 'f1-score': 0.5106067146827831, 'support': 63572}, '2': {'precision': 0.5008743005595524, 'recall': 0.32017053619902275, 'f1-score': 0.3906368719437355, 'support': 62626}, 'accuracy': 0.48014663220634, 'macro avg': {'precision': 0.4842784631243943, 'recall': 0.4794548363061548, 'f1-score': 0.47238401086762055, 'support': 189590}, 'weighted avg': {'precision': 0.48421907803919595, 'recall': 0.48014663220634, 'f1-score': 0.4727505829183745, 'support': 189590}}
[[37270 16092 10030]
 [19911 33710  9951]
 [23910 18665 20051]]
training model: results/ATVI/W6/deepOF_L2/seq2seq
Epoch 1/50
2046/2046 - 68s - loss: 11.8907 - accuracy10: 0.5230 - accuracy20: 0.5144 - accuracy30: 0.4988 - accuracy50: 0.4647 - val_loss: 11.6535 - val_accuracy10: 0.5816 - val_accuracy20: 0.5506 - val_accuracy30: 0.5182 - val_accuracy50: 0.4720 - 68s/epoch - 33ms/step
Epoch 2/50
2046/2046 - 60s - loss: 11.3920 - accuracy10: 0.5628 - accuracy20: 0.5507 - accuracy30: 0.5318 - accuracy50: 0.4905 - val_loss: 11.6080 - val_accuracy10: 0.5923 - val_accuracy20: 0.5576 - val_accuracy30: 0.5220 - val_accuracy50: 0.4757 - 60s/epoch - 29ms/step
Epoch 3/50
2046/2046 - 59s - loss: 11.2880 - accuracy10: 0.5706 - accuracy20: 0.5560 - accuracy30: 0.5367 - accuracy50: 0.4949 - val_loss: 11.5267 - val_accuracy10: 0.5940 - val_accuracy20: 0.5593 - val_accuracy30: 0.5245 - val_accuracy50: 0.4777 - 59s/epoch - 29ms/step
Epoch 4/50
2046/2046 - 62s - loss: 11.2276 - accuracy10: 0.5743 - accuracy20: 0.5594 - accuracy30: 0.5403 - accuracy50: 0.4977 - val_loss: 11.4501 - val_accuracy10: 0.5952 - val_accuracy20: 0.5617 - val_accuracy30: 0.5272 - val_accuracy50: 0.4798 - 62s/epoch - 30ms/step
Epoch 5/50
2046/2046 - 62s - loss: 11.1852 - accuracy10: 0.5768 - accuracy20: 0.5620 - accuracy30: 0.5429 - accuracy50: 0.4997 - val_loss: 11.4643 - val_accuracy10: 0.5955 - val_accuracy20: 0.5607 - val_accuracy30: 0.5257 - val_accuracy50: 0.4788 - 62s/epoch - 30ms/step
Epoch 6/50
2046/2046 - 61s - loss: 11.1509 - accuracy10: 0.5787 - accuracy20: 0.5635 - accuracy30: 0.5445 - accuracy50: 0.5009 - val_loss: 11.4641 - val_accuracy10: 0.5945 - val_accuracy20: 0.5603 - val_accuracy30: 0.5257 - val_accuracy50: 0.4783 - 61s/epoch - 30ms/step
Epoch 7/50
2046/2046 - 57s - loss: 11.1214 - accuracy10: 0.5798 - accuracy20: 0.5649 - accuracy30: 0.5457 - accuracy50: 0.5026 - val_loss: 11.4120 - val_accuracy10: 0.5929 - val_accuracy20: 0.5621 - val_accuracy30: 0.5297 - val_accuracy50: 0.4822 - 57s/epoch - 28ms/step
Epoch 8/50
2046/2046 - 58s - loss: 11.0969 - accuracy10: 0.5814 - accuracy20: 0.5662 - accuracy30: 0.5472 - accuracy50: 0.5036 - val_loss: 11.4248 - val_accuracy10: 0.5931 - val_accuracy20: 0.5617 - val_accuracy30: 0.5295 - val_accuracy50: 0.4814 - 58s/epoch - 28ms/step
Epoch 9/50
2046/2046 - 60s - loss: 11.0687 - accuracy10: 0.5821 - accuracy20: 0.5674 - accuracy30: 0.5490 - accuracy50: 0.5057 - val_loss: 11.3978 - val_accuracy10: 0.5900 - val_accuracy20: 0.5610 - val_accuracy30: 0.5303 - val_accuracy50: 0.4830 - 60s/epoch - 29ms/step
Epoch 10/50
2046/2046 - 59s - loss: 11.0465 - accuracy10: 0.5827 - accuracy20: 0.5684 - accuracy30: 0.5492 - accuracy50: 0.5058 - val_loss: 11.3895 - val_accuracy10: 0.5894 - val_accuracy20: 0.5609 - val_accuracy30: 0.5308 - val_accuracy50: 0.4837 - 59s/epoch - 29ms/step
Epoch 11/50
2046/2046 - 60s - loss: 11.0255 - accuracy10: 0.5837 - accuracy20: 0.5701 - accuracy30: 0.5510 - accuracy50: 0.5075 - val_loss: 11.4138 - val_accuracy10: 0.5857 - val_accuracy20: 0.5590 - val_accuracy30: 0.5290 - val_accuracy50: 0.4830 - 60s/epoch - 29ms/step
Epoch 12/50
2046/2046 - 60s - loss: 11.0064 - accuracy10: 0.5846 - accuracy20: 0.5712 - accuracy30: 0.5527 - accuracy50: 0.5089 - val_loss: 11.3901 - val_accuracy10: 0.5849 - val_accuracy20: 0.5593 - val_accuracy30: 0.5305 - val_accuracy50: 0.4845 - 60s/epoch - 30ms/step
Epoch 13/50
2046/2046 - 59s - loss: 10.9883 - accuracy10: 0.5846 - accuracy20: 0.5718 - accuracy30: 0.5534 - accuracy50: 0.5098 - val_loss: 11.3923 - val_accuracy10: 0.5894 - val_accuracy20: 0.5608 - val_accuracy30: 0.5293 - val_accuracy50: 0.4828 - 59s/epoch - 29ms/step
Epoch 14/50
2046/2046 - 59s - loss: 10.9688 - accuracy10: 0.5851 - accuracy20: 0.5723 - accuracy30: 0.5542 - accuracy50: 0.5108 - val_loss: 11.4179 - val_accuracy10: 0.5877 - val_accuracy20: 0.5600 - val_accuracy30: 0.5283 - val_accuracy50: 0.4818 - 59s/epoch - 29ms/step
Epoch 15/50
2046/2046 - 58s - loss: 10.9530 - accuracy10: 0.5856 - accuracy20: 0.5733 - accuracy30: 0.5555 - accuracy50: 0.5119 - val_loss: 11.3863 - val_accuracy10: 0.5819 - val_accuracy20: 0.5589 - val_accuracy30: 0.5300 - val_accuracy50: 0.4844 - 58s/epoch - 28ms/step
Epoch 16/50
2046/2046 - 58s - loss: 10.9370 - accuracy10: 0.5865 - accuracy20: 0.5745 - accuracy30: 0.5562 - accuracy50: 0.5125 - val_loss: 11.4023 - val_accuracy10: 0.5916 - val_accuracy20: 0.5630 - val_accuracy30: 0.5312 - val_accuracy50: 0.4841 - 58s/epoch - 28ms/step
Epoch 17/50
2046/2046 - 57s - loss: 10.9203 - accuracy10: 0.5866 - accuracy20: 0.5758 - accuracy30: 0.5577 - accuracy50: 0.5141 - val_loss: 11.4242 - val_accuracy10: 0.5829 - val_accuracy20: 0.5591 - val_accuracy30: 0.5306 - val_accuracy50: 0.4849 - 57s/epoch - 28ms/step
Epoch 18/50
2046/2046 - 57s - loss: 10.9030 - accuracy10: 0.5872 - accuracy20: 0.5764 - accuracy30: 0.5585 - accuracy50: 0.5146 - val_loss: 11.3553 - val_accuracy10: 0.5836 - val_accuracy20: 0.5608 - val_accuracy30: 0.5323 - val_accuracy50: 0.4863 - 57s/epoch - 28ms/step
Epoch 19/50
2046/2046 - 58s - loss: 10.8870 - accuracy10: 0.5880 - accuracy20: 0.5776 - accuracy30: 0.5595 - accuracy50: 0.5162 - val_loss: 11.4058 - val_accuracy10: 0.5837 - val_accuracy20: 0.5595 - val_accuracy30: 0.5316 - val_accuracy50: 0.4855 - 58s/epoch - 28ms/step
Epoch 20/50
2046/2046 - 60s - loss: 10.8742 - accuracy10: 0.5883 - accuracy20: 0.5777 - accuracy30: 0.5604 - accuracy50: 0.5168 - val_loss: 11.4309 - val_accuracy10: 0.5799 - val_accuracy20: 0.5578 - val_accuracy30: 0.5289 - val_accuracy50: 0.4836 - 60s/epoch - 29ms/step
Epoch 21/50
2046/2046 - 59s - loss: 10.8605 - accuracy10: 0.5890 - accuracy20: 0.5780 - accuracy30: 0.5606 - accuracy50: 0.5176 - val_loss: 11.3852 - val_accuracy10: 0.5801 - val_accuracy20: 0.5584 - val_accuracy30: 0.5307 - val_accuracy50: 0.4848 - 59s/epoch - 29ms/step
Epoch 22/50
2046/2046 - 60s - loss: 10.8444 - accuracy10: 0.5889 - accuracy20: 0.5793 - accuracy30: 0.5621 - accuracy50: 0.5187 - val_loss: 11.4081 - val_accuracy10: 0.5807 - val_accuracy20: 0.5582 - val_accuracy30: 0.5304 - val_accuracy50: 0.4848 - 60s/epoch - 29ms/step
Epoch 23/50
2046/2046 - 58s - loss: 10.8261 - accuracy10: 0.5901 - accuracy20: 0.5806 - accuracy30: 0.5635 - accuracy50: 0.5202 - val_loss: 11.4097 - val_accuracy10: 0.5882 - val_accuracy20: 0.5611 - val_accuracy30: 0.5292 - val_accuracy50: 0.4832 - 58s/epoch - 28ms/step
Epoch 24/50
2046/2046 - 59s - loss: 10.8158 - accuracy10: 0.5900 - accuracy20: 0.5810 - accuracy30: 0.5639 - accuracy50: 0.5208 - val_loss: 11.4394 - val_accuracy10: 0.5829 - val_accuracy20: 0.5581 - val_accuracy30: 0.5282 - val_accuracy50: 0.4833 - 59s/epoch - 29ms/step
Epoch 25/50
2046/2046 - 58s - loss: 10.8058 - accuracy10: 0.5900 - accuracy20: 0.5816 - accuracy30: 0.5651 - accuracy50: 0.5220 - val_loss: 11.3869 - val_accuracy10: 0.5873 - val_accuracy20: 0.5596 - val_accuracy30: 0.5301 - val_accuracy50: 0.4847 - 58s/epoch - 29ms/step
Epoch 26/50
2046/2046 - 58s - loss: 10.7913 - accuracy10: 0.5907 - accuracy20: 0.5820 - accuracy30: 0.5655 - accuracy50: 0.5224 - val_loss: 11.4310 - val_accuracy10: 0.5846 - val_accuracy20: 0.5582 - val_accuracy30: 0.5288 - val_accuracy50: 0.4840 - 58s/epoch - 29ms/step
Epoch 27/50
2046/2046 - 59s - loss: 10.7760 - accuracy10: 0.5910 - accuracy20: 0.5825 - accuracy30: 0.5666 - accuracy50: 0.5240 - val_loss: 11.4598 - val_accuracy10: 0.5911 - val_accuracy20: 0.5600 - val_accuracy30: 0.5281 - val_accuracy50: 0.4820 - 59s/epoch - 29ms/step
Epoch 28/50
2046/2046 - 60s - loss: 10.7601 - accuracy10: 0.5914 - accuracy20: 0.5835 - accuracy30: 0.5672 - accuracy50: 0.5246 - val_loss: 11.4003 - val_accuracy10: 0.5837 - val_accuracy20: 0.5598 - val_accuracy30: 0.5296 - val_accuracy50: 0.4846 - 60s/epoch - 29ms/step
testing model: results/ATVI/W6/deepOF_L2/seq2seq
Evaluating performance on  test set...
7324/7324 - 79s - 79s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9268822
{'0': {'precision': 0.4560694710965622, 'recall': 0.5952198751053748, 'f1-score': 0.5164355838023044, 'support': 488732}, '1': {'precision': 0.7023037182845534, 'recall': 0.5625330076577766, 'f1-score': 0.6246956857479211, 'support': 908880}, '2': {'precision': 0.4711411479868568, 'recall': 0.50251210989983, 'f1-score': 0.4863212450998788, 'support': 477089}, 'accuracy': 0.5557798283566286, 'macro avg': {'precision': 0.5431714457893241, 'recall': 0.5534216642209938, 'f1-score': 0.5424841715500347, 'support': 1874701}, 'weighted avg': {'precision': 0.5792826735433177, 'recall': 0.5557798283566286, 'f1-score': 0.5612577830325446, 'support': 1874701}}
[[290903 104300  93529]
 [222021 511275 175584]
 [124924 112422 239743]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.94874
{'0': {'precision': 0.5065086920529801, 'recall': 0.5660031088271198, 'f1-score': 0.5346057621271705, 'support': 605373}, '1': {'precision': 0.5681644451490889, 'recall': 0.5894114036234194, 'f1-score': 0.578592933602329, 'support': 680959}, '2': {'precision': 0.5311256473707647, 'recall': 0.4439492903263088, 'f1-score': 0.4836404774821647, 'support': 588369}, 'accuracy': 0.5361996393024808, 'macro avg': {'precision': 0.5352662615242779, 'recall': 0.5331212675922826, 'f1-score': 0.532279724403888, 'support': 1874701}, 'weighted avg': {'precision': 0.5366302385587657, 'recall': 0.5361996393024808, 'f1-score': 0.5345881949200559, 'support': 1874701}}
[[342643 146245 116485]
 [165488 401365 114106]
 [168349 158814 261206]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.97343296
{'0': {'precision': 0.5214949964124692, 'recall': 0.5517601511757121, 'f1-score': 0.5362008441413602, 'support': 673124}, '1': {'precision': 0.4666091074212245, 'recall': 0.6071554728496983, 'f1-score': 0.5276841468934064, 'support': 549202}, '2': {'precision': 0.5586376890548042, 'recall': 0.38353094462540716, 'f1-score': 0.45481208549607777, 'support': 652375}, 'accuracy': 0.5094465730801871, 'macro avg': {'precision': 0.5155805976294993, 'recall': 0.5141488562169392, 'f1-score': 0.5062323588436147, 'support': 1874701}, 'weighted avg': {'precision': 0.518341173006376, 'recall': 0.5094465730801871, 'f1-score': 0.5053834612183303, 'support': 1874701}}
[[371403 181726 119995]
 [138066 333451  77685]
 [202720 199449 250206]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0314932
{'0': {'precision': 0.4696292501062867, 'recall': 0.5273575811362906, 'f1-score': 0.49682209956220075, 'support': 653530}, '1': {'precision': 0.4253670795767102, 'recall': 0.5464470236382712, 'f1-score': 0.47836427526505504, 'support': 580457}, '2': {'precision': 0.5169554148509189, 'recall': 0.31882712099314203, 'f1-score': 0.3944073955368831, 'support': 640714}, 'accuracy': 0.46199900677494704, 'macro avg': {'precision': 0.4706505815113053, 'recall': 0.4642105752559013, 'f1-score': 0.45653125678804624, 'support': 1874701}, 'weighted avg': {'precision': 0.4720991104195345, 'recall': 0.46199900677494704, 'f1-score': 0.4561049356022276, 'support': 1874701}}
[[344644 204169 104717]
 [177108 317189  86160]
 [212112 224325 204277]]
Evaluating performance on  train set...
2046/2046 - 20s - 20s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8825369
{'0': {'precision': 0.45193097285286443, 'recall': 0.6075983277184722, 'f1-score': 0.5183292301619454, 'support': 123185}, '1': {'precision': 0.746559733161029, 'recall': 0.6181064365830119, 'f1-score': 0.6762875589523537, 'support': 276653}, '2': {'precision': 0.48143815559101966, 'recall': 0.5015252760023242, 'f1-score': 0.49127647295983307, 'support': 123912}, 'accuracy': 0.5880534606205251, 'macro avg': {'precision': 0.5599762872016377, 'recall': 0.5757433467679361, 'f1-score': 0.5619644206913774, 'support': 523750}, 'weighted avg': {'precision': 0.6145395159611888, 'recall': 0.5880534606205251, 'f1-score': 0.5953649996787468, 'support': 523750}}
[[ 74847  26556  21782]
 [ 60497 171001  45155]
 [ 30272  31495  62145]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.91259617
{'0': {'precision': 0.5031715129058595, 'recall': 0.5736938719714624, 'f1-score': 0.5361234887080831, 'support': 153622}, '1': {'precision': 0.6270703194717115, 'recall': 0.6511982429476962, 'f1-score': 0.638906568228106, 'support': 215816}, '2': {'precision': 0.5432328863966838, 'recall': 0.4382031209497641, 'f1-score': 0.485098049062194, 'support': 154312}, 'accuracy': 0.5657107398568019, 'macro avg': {'precision': 0.557824906258085, 'recall': 0.5543650786229742, 'f1-score': 0.5533760353327944, 'support': 523750}, 'weighted avg': {'precision': 0.5660284016961832, 'recall': 0.5657107398568019, 'f1-score': 0.5634426208265687, 'support': 523750}}
[[ 88132  38309  27181]
 [ 45601 140539  29676]
 [ 41420  45272  67620]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.94366693
{'0': {'precision': 0.5226622137404581, 'recall': 0.5579258058915446, 'f1-score': 0.539718618959909, 'support': 172790}, '1': {'precision': 0.5311819661155229, 'recall': 0.6728145797646794, 'f1-score': 0.5936677684557937, 'support': 178055}, '2': {'precision': 0.5729403802374946, 'recall': 0.3769931465255487, 'f1-score': 0.45475728697205203, 'support': 172905}, 'accuracy': 0.5372525059665871, 'macro avg': {'precision': 0.5422615200311586, 'recall': 0.5359111773939242, 'f1-score': 0.5293812247959183, 'support': 523750}, 'weighted avg': {'precision': 0.5421568789190973, 'recall': 0.5372525059665871, 'f1-score': 0.5300110804513254, 'support': 523750}}
[[ 96404  48156  28230]
 [ 37900 119798  20357]
 [ 50144  57577  65184]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.001402
{'0': {'precision': 0.48724170894918745, 'recall': 0.5300073132827497, 'f1-score': 0.5077255685394487, 'support': 175024}, '1': {'precision': 0.46961159230341415, 'recall': 0.6271483104276181, 'f1-score': 0.5370657988807533, 'support': 173683}, '2': {'precision': 0.5432816983345987, 'recall': 0.3147683712002194, 'f1-score': 0.3985965419952253, 'support': 175043}, 'accuracy': 0.4902854415274463, 'macro avg': {'precision': 0.5000449998624, 'recall': 0.49064133163686235, 'f1-score': 0.4811293031384758, 'support': 523750}, 'weighted avg': {'precision': 0.5001244894983096, 'recall': 0.4902854415274463, 'f1-score': 0.48098309032081066, 'support': 523750}}
[[ 92764  57005  25255]
 [ 43694 108925  21064]
 [ 53928  66017  55098]]
Evaluating performance on  val set...
741/741 - 7s - 7s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.88870984
{'0': {'precision': 0.4497507477567298, 'recall': 0.6126162830175867, 'f1-score': 0.5186995141863341, 'support': 44181}, '1': {'precision': 0.7524677110445416, 'recall': 0.6092505889720574, 'f1-score': 0.6733278037473017, 'support': 100599}, '2': {'precision': 0.46788856916468574, 'recall': 0.5007587592055345, 'f1-score': 0.4837659537771645, 'support': 44810}, 'accuracy': 0.5843926367424442, 'macro avg': {'precision': 0.556702342655319, 'recall': 0.5742085437317263, 'f1-score': 0.5585977572369335, 'support': 189590}, 'weighted avg': {'precision': 0.6146633463488553, 'recall': 0.5843926367424442, 'f1-score': 0.5924907397763383, 'support': 189590}}
[[27066  8779  8336]
 [22126 61290 17183]
 [10988 11383 22439]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9196738
{'0': {'precision': 0.4983944990053726, 'recall': 0.5767446075765815, 'f1-score': 0.5347146950333157, 'support': 55170}, '1': {'precision': 0.6319447929736511, 'recall': 0.6405850556438791, 'f1-score': 0.636235591346913, 'support': 78625}, '2': {'precision': 0.524485851412687, 'recall': 0.4328524061295815, 'f1-score': 0.47428369435007167, 'support': 55795}, 'accuracy': 0.5608734637902842, 'macro avg': {'precision': 0.5516083811305702, 'recall': 0.5500606897833474, 'f1-score': 0.5484113269101002, 'support': 189590}, 'weighted avg': {'precision': 0.5614577347816372, 'recall': 0.5608734637902842, 'f1-score': 0.5590320788063785, 'support': 189590}}
[[31819 12975 10376]
 [16739 50366 11520]
 [15285 16359 24151]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9510416
{'0': {'precision': 0.5144990629104379, 'recall': 0.56275826446281, 'f1-score': 0.5375477007285202, 'support': 61952}, '1': {'precision': 0.5357566821197846, 'recall': 0.6594530577088716, 'f1-score': 0.5912039877829333, 'support': 65016}, '2': {'precision': 0.5528708133971292, 'recall': 0.369039634633196, 'f1-score': 0.4426270326176476, 'support': 62622}, 'accuracy': 0.5319320639274223, 'macro avg': {'precision': 0.5343755194757839, 'recall': 0.5304169856016259, 'f1-score': 0.5237929070430337, 'support': 189590}, 'weighted avg': {'precision': 0.5344632019973753, 'recall': 0.5319320639274223, 'f1-score': 0.5245955148573807, 'support': 189590}}
[[34864 16436 10652]
 [14103 42875  8038]
 [18796 20716 23110]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0091203
{'0': {'precision': 0.48135851828828957, 'recall': 0.5373962966467934, 'f1-score': 0.5078361962961584, 'support': 63402}, '1': {'precision': 0.4748232190618092, 'recall': 0.6119593275829504, 'f1-score': 0.5347389848225399, 'support': 63532}, '2': {'precision': 0.5173048800303309, 'recall': 0.30487104187946884, 'f1-score': 0.38364363037496735, 'support': 62656}, 'accuracy': 0.4855372118782636, 'macro avg': {'precision': 0.4911622057934766, 'recall': 0.4847422220364042, 'f1-score': 0.47540627049788853, 'support': 189590}, 'weighted avg': {'precision': 0.49104813594139674, 'recall': 0.4855372118782636, 'f1-score': 0.47580802260714483, 'support': 189590}}
[[34072 19761  9569]
 [16398 38879  8255]
 [20313 23241 19102]]
training model: results/ATVI/W6/deepVOL_L2/seq2seq
Epoch 1/50
2046/2046 - 65s - loss: 12.1281 - accuracy10: 0.4850 - accuracy20: 0.4894 - accuracy30: 0.4820 - accuracy50: 0.4523 - val_loss: 12.4693 - val_accuracy10: 0.5751 - val_accuracy20: 0.5289 - val_accuracy30: 0.4867 - val_accuracy50: 0.4485 - 65s/epoch - 32ms/step
Epoch 2/50
2046/2046 - 57s - loss: 11.7818 - accuracy10: 0.5244 - accuracy20: 0.5221 - accuracy30: 0.5090 - accuracy50: 0.4727 - val_loss: 12.0819 - val_accuracy10: 0.5802 - val_accuracy20: 0.5417 - val_accuracy30: 0.5027 - val_accuracy50: 0.4609 - 57s/epoch - 28ms/step
Epoch 3/50
2046/2046 - 57s - loss: 11.5426 - accuracy10: 0.5499 - accuracy20: 0.5412 - accuracy30: 0.5236 - accuracy50: 0.4844 - val_loss: 12.0225 - val_accuracy10: 0.5799 - val_accuracy20: 0.5461 - val_accuracy30: 0.5079 - val_accuracy50: 0.4661 - 57s/epoch - 28ms/step
Epoch 4/50
2046/2046 - 57s - loss: 11.4264 - accuracy10: 0.5578 - accuracy20: 0.5476 - accuracy30: 0.5287 - accuracy50: 0.4887 - val_loss: 12.0834 - val_accuracy10: 0.5862 - val_accuracy20: 0.5506 - val_accuracy30: 0.5116 - val_accuracy50: 0.4697 - 57s/epoch - 28ms/step
Epoch 5/50
2046/2046 - 58s - loss: 11.3470 - accuracy10: 0.5625 - accuracy20: 0.5522 - accuracy30: 0.5332 - accuracy50: 0.4917 - val_loss: 12.1019 - val_accuracy10: 0.5895 - val_accuracy20: 0.5513 - val_accuracy30: 0.5098 - val_accuracy50: 0.4662 - 58s/epoch - 28ms/step
Epoch 6/50
2046/2046 - 59s - loss: 11.2925 - accuracy10: 0.5672 - accuracy20: 0.5558 - accuracy30: 0.5361 - accuracy50: 0.4943 - val_loss: 12.0015 - val_accuracy10: 0.5915 - val_accuracy20: 0.5526 - val_accuracy30: 0.5116 - val_accuracy50: 0.4677 - 59s/epoch - 29ms/step
Epoch 7/50
2046/2046 - 57s - loss: 11.2452 - accuracy10: 0.5700 - accuracy20: 0.5580 - accuracy30: 0.5386 - accuracy50: 0.4963 - val_loss: 11.9512 - val_accuracy10: 0.5941 - val_accuracy20: 0.5544 - val_accuracy30: 0.5128 - val_accuracy50: 0.4669 - 57s/epoch - 28ms/step
Epoch 8/50
2046/2046 - 57s - loss: 11.2056 - accuracy10: 0.5728 - accuracy20: 0.5612 - accuracy30: 0.5411 - accuracy50: 0.4985 - val_loss: 11.8562 - val_accuracy10: 0.5949 - val_accuracy20: 0.5575 - val_accuracy30: 0.5152 - val_accuracy50: 0.4674 - 57s/epoch - 28ms/step
Epoch 9/50
2046/2046 - 57s - loss: 11.1733 - accuracy10: 0.5746 - accuracy20: 0.5628 - accuracy30: 0.5437 - accuracy50: 0.4999 - val_loss: 11.8861 - val_accuracy10: 0.5947 - val_accuracy20: 0.5569 - val_accuracy30: 0.5146 - val_accuracy50: 0.4682 - 57s/epoch - 28ms/step
Epoch 10/50
2046/2046 - 57s - loss: 11.1459 - accuracy10: 0.5770 - accuracy20: 0.5647 - accuracy30: 0.5450 - accuracy50: 0.5012 - val_loss: 11.9047 - val_accuracy10: 0.5953 - val_accuracy20: 0.5571 - val_accuracy30: 0.5134 - val_accuracy50: 0.4671 - 57s/epoch - 28ms/step
Epoch 11/50
2046/2046 - 58s - loss: 11.1226 - accuracy10: 0.5779 - accuracy20: 0.5662 - accuracy30: 0.5460 - accuracy50: 0.5022 - val_loss: 11.8453 - val_accuracy10: 0.5944 - val_accuracy20: 0.5575 - val_accuracy30: 0.5157 - val_accuracy50: 0.4686 - 58s/epoch - 28ms/step
Epoch 12/50
2046/2046 - 58s - loss: 11.0989 - accuracy10: 0.5790 - accuracy20: 0.5673 - accuracy30: 0.5477 - accuracy50: 0.5037 - val_loss: 11.8250 - val_accuracy10: 0.5954 - val_accuracy20: 0.5588 - val_accuracy30: 0.5167 - val_accuracy50: 0.4678 - 58s/epoch - 28ms/step
Epoch 13/50
2046/2046 - 58s - loss: 11.0799 - accuracy10: 0.5802 - accuracy20: 0.5680 - accuracy30: 0.5480 - accuracy50: 0.5044 - val_loss: 11.8823 - val_accuracy10: 0.5950 - val_accuracy20: 0.5573 - val_accuracy30: 0.5155 - val_accuracy50: 0.4682 - 58s/epoch - 28ms/step
Epoch 14/50
2046/2046 - 56s - loss: 11.0606 - accuracy10: 0.5811 - accuracy20: 0.5690 - accuracy30: 0.5490 - accuracy50: 0.5054 - val_loss: 11.8711 - val_accuracy10: 0.5953 - val_accuracy20: 0.5590 - val_accuracy30: 0.5161 - val_accuracy50: 0.4685 - 56s/epoch - 27ms/step
Epoch 15/50
2046/2046 - 56s - loss: 11.0441 - accuracy10: 0.5813 - accuracy20: 0.5700 - accuracy30: 0.5506 - accuracy50: 0.5062 - val_loss: 11.8958 - val_accuracy10: 0.5963 - val_accuracy20: 0.5576 - val_accuracy30: 0.5140 - val_accuracy50: 0.4665 - 56s/epoch - 27ms/step
Epoch 16/50
2046/2046 - 56s - loss: 11.0278 - accuracy10: 0.5819 - accuracy20: 0.5710 - accuracy30: 0.5514 - accuracy50: 0.5072 - val_loss: 11.8473 - val_accuracy10: 0.5979 - val_accuracy20: 0.5594 - val_accuracy30: 0.5160 - val_accuracy50: 0.4683 - 56s/epoch - 28ms/step
Epoch 17/50
2046/2046 - 58s - loss: 11.0116 - accuracy10: 0.5827 - accuracy20: 0.5720 - accuracy30: 0.5522 - accuracy50: 0.5084 - val_loss: 11.9156 - val_accuracy10: 0.5975 - val_accuracy20: 0.5578 - val_accuracy30: 0.5139 - val_accuracy50: 0.4675 - 58s/epoch - 28ms/step
Epoch 18/50
2046/2046 - 57s - loss: 11.0018 - accuracy10: 0.5832 - accuracy20: 0.5717 - accuracy30: 0.5524 - accuracy50: 0.5086 - val_loss: 11.9582 - val_accuracy10: 0.5966 - val_accuracy20: 0.5561 - val_accuracy30: 0.5118 - val_accuracy50: 0.4641 - 57s/epoch - 28ms/step
Epoch 19/50
2046/2046 - 57s - loss: 10.9843 - accuracy10: 0.5842 - accuracy20: 0.5735 - accuracy30: 0.5541 - accuracy50: 0.5096 - val_loss: 11.9348 - val_accuracy10: 0.5983 - val_accuracy20: 0.5587 - val_accuracy30: 0.5132 - val_accuracy50: 0.4672 - 57s/epoch - 28ms/step
Epoch 20/50
2046/2046 - 58s - loss: 10.9710 - accuracy10: 0.5849 - accuracy20: 0.5743 - accuracy30: 0.5551 - accuracy50: 0.5106 - val_loss: 11.9053 - val_accuracy10: 0.5997 - val_accuracy20: 0.5592 - val_accuracy30: 0.5148 - val_accuracy50: 0.4675 - 58s/epoch - 28ms/step
Epoch 21/50
2046/2046 - 58s - loss: 10.9605 - accuracy10: 0.5846 - accuracy20: 0.5744 - accuracy30: 0.5554 - accuracy50: 0.5112 - val_loss: 11.9383 - val_accuracy10: 0.5993 - val_accuracy20: 0.5569 - val_accuracy30: 0.5115 - val_accuracy50: 0.4654 - 58s/epoch - 29ms/step
Epoch 22/50
2046/2046 - 58s - loss: 10.9479 - accuracy10: 0.5857 - accuracy20: 0.5755 - accuracy30: 0.5568 - accuracy50: 0.5125 - val_loss: 11.9078 - val_accuracy10: 0.5980 - val_accuracy20: 0.5584 - val_accuracy30: 0.5142 - val_accuracy50: 0.4659 - 58s/epoch - 28ms/step
testing model: results/ATVI/W6/deepVOL_L2/seq2seq
Evaluating performance on  test set...
7324/7324 - 66s - 66s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.93835634
{'0': {'precision': 0.49485227004359456, 'recall': 0.47589593542512815, 'f1-score': 0.48518901734345216, 'support': 488735}, '1': {'precision': 0.6654438150300594, 'recall': 0.6580036330388687, 'f1-score': 0.6617028103562735, 'support': 908881}, '2': {'precision': 0.4731369596066201, 'recall': 0.5017816344924437, 'f1-score': 0.48703848376097586, 'support': 477090}, 'accuracy': 0.5707716303249682, 'macro avg': {'precision': 0.5444776815600915, 'recall': 0.5452270676521468, 'f1-score': 0.5446434371535672, 'support': 1874706}, 'weighted avg': {'precision': 0.57203090847675, 'recall': 0.5707716303249682, 'f1-score': 0.5712357866184332, 'support': 1874706}}
[[232587 160352  95796]
 [140051 598047 170783]
 [ 97375 140320 239395]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.99710506
{'0': {'precision': 0.5496835575951704, 'recall': 0.41075764733867, 'f1-score': 0.4701729241491585, 'support': 605374}, '1': {'precision': 0.522221719525253, 'recall': 0.7119232966351965, 'f1-score': 0.6024929052431294, 'support': 680961}, '2': {'precision': 0.5306685937648656, 'recall': 0.4455590095364999, 'f1-score': 0.48440378499932557, 'support': 588371}, 'accuracy': 0.5310742057687979, 'macro avg': {'precision': 0.5341912902950964, 'recall': 0.5227466511701221, 'f1-score': 0.5190232047972044, 'support': 1874706}, 'weighted avg': {'precision': 0.5337406342793388, 'recall': 0.5310742057687979, 'f1-score': 0.5227026394618556, 'support': 1874706}}
[[248662 233712 123000]
 [ 87316 484792 108853]
 [116395 209822 262154]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0403551
{'0': {'precision': 0.5641365587238861, 'recall': 0.35968802228412255, 'f1-score': 0.43928937869170276, 'support': 673125}, '1': {'precision': 0.42268938561842273, 'recall': 0.742757673861348, 'f1-score': 0.5387731382118116, 'support': 549202}, '2': {'precision': 0.5456978728718311, 'recall': 0.4018921516480451, 'f1-score': 0.46288307517661376, 'support': 652379}, 'accuracy': 0.48659629829957335, 'macro avg': {'precision': 0.5108412724047133, 'recall': 0.5014459492645053, 'f1-score': 0.48031519736004274, 'support': 1874706}, 'weighted avg': {'precision': 0.5162826115975929, 'recall': 0.48659629829957335, 'f1-score': 0.47664388217923226, 'support': 1874706}}
[[242115 291717 139293]
 [ 62297 407924  78981]
 [124766 265427 262186]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0976294
{'0': {'precision': 0.5044121762691044, 'recall': 0.31163938665495594, 'f1-score': 0.3852567861534097, 'support': 653531}, '1': {'precision': 0.39673412493444354, 'recall': 0.6894124984064308, 'f1-score': 0.5036400397449927, 'support': 580458}, '2': {'precision': 0.4963505702369209, 'recall': 0.3581066211759638, 'f1-score': 0.41604524465969955, 'support': 640717}, 'accuracy': 0.4444888958588707, 'macro avg': {'precision': 0.46583229048015623, 'recall': 0.45305283541245017, 'f1-score': 0.434980690186034, 'support': 1874706}, 'weighted avg': {'precision': 0.46831702622758475, 'recall': 0.4444888958588707, 'f1-score': 0.4324338877266897, 'support': 1874706}}
[[203666 315008 134857]
 [ 82321 400175  97962]
 [117782 293490 229445]]
Evaluating performance on  train set...
2046/2046 - 19s - 19s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.89912975
{'0': {'precision': 0.47607284471731903, 'recall': 0.4840993708033232, 'f1-score': 0.48005255902814165, 'support': 123014}, '1': {'precision': 0.7139406633920877, 'recall': 0.6671746737980274, 'f1-score': 0.6897658962774894, 'support': 276899}, '2': {'precision': 0.4589465558279665, 'recall': 0.5184796388859729, 'f1-score': 0.48690007659000084, 'support': 123839}, 'accuracy': 0.5890173211749072, 'macro avg': {'precision': 0.5496533546457911, 'recall': 0.5565845611624411, 'f1-score': 0.5522395106318773, 'support': 523752}, 'weighted avg': {'precision': 0.5977801768773037, 'recall': 0.5890173211749072, 'f1-score': 0.592543591231074, 'support': 523752}}
[[ 59551  39384  24079]
 [ 40543 184740  51616]
 [ 24994  34637  64208]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.95252866
{'0': {'precision': 0.533727642819007, 'recall': 0.41648385269859456, 'f1-score': 0.4678725652585662, 'support': 153617}, '1': {'precision': 0.5818507069452034, 'recall': 0.7200070391879, 'f1-score': 0.6435981289067351, 'support': 215934}, '2': {'precision': 0.5189428859914834, 'recall': 0.45995810662706466, 'f1-score': 0.4876733992264718, 'support': 154201}, 'accuracy': 0.5544207945745314, 'macro avg': {'precision': 0.5448404119185645, 'recall': 0.5321496661711864, 'f1-score': 0.533048031130591, 'support': 523752}, 'weighted avg': {'precision': 0.5492150900105501, 'recall': 0.5544207945745314, 'f1-score': 0.5461508959560886, 'support': 523752}}
[[ 63979  58319  31319]
 [ 26031 155474  34429]
 [ 29862  53413  70926]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.99416465
{'0': {'precision': 0.5562956672504998, 'recall': 0.36412747675240004, 'f1-score': 0.44015090008118934, 'support': 172706}, '1': {'precision': 0.48342314564002076, 'recall': 0.7526977005047673, 'f1-score': 0.5887312575123487, 'support': 178300}, '2': {'precision': 0.5392741753700503, 'recall': 0.4154770588030982, 'f1-score': 0.4693495860526556, 'support': 172746}, 'accuracy': 0.5133441017886328, 'macro avg': {'precision': 0.526330996086857, 'recall': 0.5107674120200886, 'f1-score': 0.4994105812153979, 'support': 523752}, 'weighted avg': {'precision': 0.5258737018173777, 'recall': 0.5133441017886328, 'f1-score': 0.5003622862654954, 'support': 523752}}
[[ 62887  74196  35623]
 [ 18399 134206  25695]
 [ 31760  69214  71772]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0538177
{'0': {'precision': 0.5174496644295302, 'recall': 0.31290405556031897, 'f1-score': 0.3899834363367589, 'support': 174945}, '1': {'precision': 0.4331733237764093, 'recall': 0.7232165973384883, 'f1-score': 0.5418209404269809, 'support': 173811}, '2': {'precision': 0.5041910918753082, 'recall': 0.3681284143637569, 'f1-score': 0.42554835896910825, 'support': 174996}, 'accuracy': 0.4675208877484, 'macro avg': {'precision': 0.48493802669374925, 'recall': 0.46808302242085476, 'f1-score': 0.4524509119109494, 'support': 523752}, 'weighted avg': {'precision': 0.4850519796322249, 'recall': 0.4675208877484, 'f1-score': 0.4522547930559622, 'support': 523752}}
[[ 54741  84461  35743]
 [ 20501 125703  27607]
 [ 30548  80027  64421]]
Evaluating performance on  val set...
741/741 - 7s - 7s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8856764
{'0': {'precision': 0.494557403984391, 'recall': 0.491718473476426, 'f1-score': 0.493133852892656, 'support': 44074}, '1': {'precision': 0.7207201469167649, 'recall': 0.6744749756611234, 'f1-score': 0.6968311395068381, 'support': 100662}, '2': {'precision': 0.448512585812357, 'recall': 0.5156284835243233, 'f1-score': 0.4797344949180668, 'support': 44854}, 'accuracy': 0.5944089878158131, 'macro avg': {'precision': 0.5545967122378377, 'recall': 0.560607310887291, 'f1-score': 0.5565664957725203, 'support': 189590}, 'weighted avg': {'precision': 0.6037440686543114, 'recall': 0.5944089878158131, 'f1-score': 0.5981159799171012, 'support': 189590}}
[[21672 13044  9358]
 [13688 67894 19080]
 [ 8461 13265 23128]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9423755
{'0': {'precision': 0.5504052865530438, 'recall': 0.41997678383574566, 'f1-score': 0.47642562472351674, 'support': 55134}, '1': {'precision': 0.5896455300600378, 'recall': 0.7290430007753613, 'f1-score': 0.6519764699195771, 'support': 78673}, '2': {'precision': 0.5070946685506179, 'recall': 0.45678791029525123, 'f1-score': 0.48062848951259995, 'support': 55783}, 'accuracy': 0.5590590221003218, 'macro avg': {'precision': 0.5490484950545665, 'recall': 0.5352692316354527, 'f1-score': 0.5363435280518979, 'support': 189590}, 'weighted avg': {'precision': 0.5539453017088876, 'recall': 0.5590590221003218, 'f1-score': 0.5505094901733775, 'support': 189590}}
[[23155 19865 12114]
 [ 8663 57356 12654]
 [10251 20051 25481]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9893478
{'0': {'precision': 0.5696792126812411, 'recall': 0.36707921191486614, 'f1-score': 0.44647027652935056, 'support': 61973}, '1': {'precision': 0.49113041411210046, 'recall': 0.7614440810184119, 'f1-score': 0.5971195298764481, 'support': 65121}, '2': {'precision': 0.5271696718281513, 'recall': 0.4107462877624168, 'f1-score': 0.461732170159187, 'support': 62496}, 'accuracy': 0.5169312727464529, 'macro avg': {'precision': 0.529326432873831, 'recall': 0.5130898602318983, 'f1-score': 0.5017739921883285, 'support': 189590}, 'weighted avg': {'precision': 0.5286862669732623, 'recall': 0.5169312727464529, 'f1-score': 0.5032466747123064, 'support': 189590}}
[[22749 25573 13651]
 [ 6162 49586  9373]
 [11022 25804 25670]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0548888
{'0': {'precision': 0.5254674575099078, 'recall': 0.31164815749621405, 'f1-score': 0.39125053223618417, 'support': 63392}, '1': {'precision': 0.4387084538428714, 'recall': 0.7277417731076574, 'f1-score': 0.5474155016654144, 'support': 63572}, '2': {'precision': 0.49002965318664315, 'recall': 0.3641458819020854, 'f1-score': 0.4178117328056869, 'support': 62626}, 'accuracy': 0.4685109974154755, 'macro avg': {'precision': 0.48473518817980743, 'recall': 0.46784527083531896, 'f1-score': 0.4521592555690952, 'support': 189590}, 'weighted avg': {'precision': 0.48467009839460834, 'recall': 0.4685109974154755, 'f1-score': 0.4523884676938597, 'support': 189590}}
[[19756 30158 13478]
 [ 7053 46264 10255]
 [10788 29033 22805]]
training model: results/ATVI/W6/deepVOL_L3/seq2seq
Epoch 1/50
2046/2046 - 92s - loss: 12.7455 - accuracy10: 0.4611 - accuracy20: 0.4441 - accuracy30: 0.4272 - accuracy50: 0.4066 - val_loss: 13.3695 - val_accuracy10: 0.5226 - val_accuracy20: 0.4631 - val_accuracy30: 0.4123 - val_accuracy50: 0.3796 - 92s/epoch - 45ms/step
Epoch 2/50
2046/2046 - 84s - loss: 12.5858 - accuracy10: 0.4579 - accuracy20: 0.4560 - accuracy30: 0.4454 - accuracy50: 0.4231 - val_loss: 13.3634 - val_accuracy10: 0.5391 - val_accuracy20: 0.4827 - val_accuracy30: 0.4372 - val_accuracy50: 0.4049 - 84s/epoch - 41ms/step
Epoch 3/50
2046/2046 - 85s - loss: 11.9375 - accuracy10: 0.5099 - accuracy20: 0.5084 - accuracy30: 0.4985 - accuracy50: 0.4644 - val_loss: 12.1156 - val_accuracy10: 0.5765 - val_accuracy20: 0.5370 - val_accuracy30: 0.5009 - val_accuracy50: 0.4614 - 85s/epoch - 41ms/step
Epoch 4/50
2046/2046 - 83s - loss: 11.6175 - accuracy10: 0.5394 - accuracy20: 0.5349 - accuracy30: 0.5195 - accuracy50: 0.4806 - val_loss: 11.9306 - val_accuracy10: 0.5771 - val_accuracy20: 0.5433 - val_accuracy30: 0.5078 - val_accuracy50: 0.4649 - 83s/epoch - 41ms/step
Epoch 5/50
2046/2046 - 86s - loss: 11.4929 - accuracy10: 0.5498 - accuracy20: 0.5431 - accuracy30: 0.5262 - accuracy50: 0.4860 - val_loss: 11.9101 - val_accuracy10: 0.5740 - val_accuracy20: 0.5426 - val_accuracy30: 0.5067 - val_accuracy50: 0.4649 - 86s/epoch - 42ms/step
Epoch 6/50
2046/2046 - 84s - loss: 11.4146 - accuracy10: 0.5560 - accuracy20: 0.5483 - accuracy30: 0.5308 - accuracy50: 0.4897 - val_loss: 11.8836 - val_accuracy10: 0.5848 - val_accuracy20: 0.5462 - val_accuracy30: 0.5074 - val_accuracy50: 0.4648 - 84s/epoch - 41ms/step
Epoch 7/50
2046/2046 - 85s - loss: 11.3479 - accuracy10: 0.5595 - accuracy20: 0.5512 - accuracy30: 0.5337 - accuracy50: 0.4925 - val_loss: 11.8771 - val_accuracy10: 0.5897 - val_accuracy20: 0.5489 - val_accuracy30: 0.5072 - val_accuracy50: 0.4646 - 85s/epoch - 42ms/step
Epoch 8/50
2046/2046 - 84s - loss: 11.2884 - accuracy10: 0.5643 - accuracy20: 0.5553 - accuracy30: 0.5376 - accuracy50: 0.4950 - val_loss: 11.7806 - val_accuracy10: 0.5903 - val_accuracy20: 0.5501 - val_accuracy30: 0.5085 - val_accuracy50: 0.4648 - 84s/epoch - 41ms/step
Epoch 9/50
2046/2046 - 85s - loss: 11.2443 - accuracy10: 0.5666 - accuracy20: 0.5579 - accuracy30: 0.5395 - accuracy50: 0.4972 - val_loss: 11.8265 - val_accuracy10: 0.5871 - val_accuracy20: 0.5489 - val_accuracy30: 0.5069 - val_accuracy50: 0.4622 - 85s/epoch - 41ms/step
Epoch 10/50
2046/2046 - 83s - loss: 11.2062 - accuracy10: 0.5692 - accuracy20: 0.5605 - accuracy30: 0.5416 - accuracy50: 0.4985 - val_loss: 11.7957 - val_accuracy10: 0.5821 - val_accuracy20: 0.5463 - val_accuracy30: 0.5049 - val_accuracy50: 0.4618 - 83s/epoch - 41ms/step
Epoch 11/50
2046/2046 - 85s - loss: 11.1746 - accuracy10: 0.5716 - accuracy20: 0.5619 - accuracy30: 0.5431 - accuracy50: 0.5001 - val_loss: 11.6900 - val_accuracy10: 0.5877 - val_accuracy20: 0.5483 - val_accuracy30: 0.5053 - val_accuracy50: 0.4612 - 85s/epoch - 42ms/step
Epoch 12/50
2046/2046 - 85s - loss: 11.1443 - accuracy10: 0.5725 - accuracy20: 0.5633 - accuracy30: 0.5442 - accuracy50: 0.5008 - val_loss: 11.6778 - val_accuracy10: 0.5867 - val_accuracy20: 0.5506 - val_accuracy30: 0.5083 - val_accuracy50: 0.4636 - 85s/epoch - 41ms/step
Epoch 13/50
2046/2046 - 84s - loss: 11.1196 - accuracy10: 0.5746 - accuracy20: 0.5654 - accuracy30: 0.5464 - accuracy50: 0.5027 - val_loss: 11.6413 - val_accuracy10: 0.5931 - val_accuracy20: 0.5543 - val_accuracy30: 0.5093 - val_accuracy50: 0.4627 - 84s/epoch - 41ms/step
Epoch 14/50
2046/2046 - 84s - loss: 11.0993 - accuracy10: 0.5749 - accuracy20: 0.5656 - accuracy30: 0.5461 - accuracy50: 0.5030 - val_loss: 11.6258 - val_accuracy10: 0.5936 - val_accuracy20: 0.5532 - val_accuracy30: 0.5073 - val_accuracy50: 0.4618 - 84s/epoch - 41ms/step
Epoch 15/50
2046/2046 - 84s - loss: 11.0791 - accuracy10: 0.5767 - accuracy20: 0.5670 - accuracy30: 0.5473 - accuracy50: 0.5038 - val_loss: 11.4892 - val_accuracy10: 0.5905 - val_accuracy20: 0.5584 - val_accuracy30: 0.5159 - val_accuracy50: 0.4664 - 84s/epoch - 41ms/step
Epoch 16/50
2046/2046 - 84s - loss: 11.0594 - accuracy10: 0.5771 - accuracy20: 0.5678 - accuracy30: 0.5485 - accuracy50: 0.5049 - val_loss: 11.5817 - val_accuracy10: 0.5846 - val_accuracy20: 0.5563 - val_accuracy30: 0.5161 - val_accuracy50: 0.4674 - 84s/epoch - 41ms/step
Epoch 17/50
2046/2046 - 84s - loss: 11.0466 - accuracy10: 0.5783 - accuracy20: 0.5686 - accuracy30: 0.5493 - accuracy50: 0.5054 - val_loss: 11.5499 - val_accuracy10: 0.5867 - val_accuracy20: 0.5551 - val_accuracy30: 0.5145 - val_accuracy50: 0.4674 - 84s/epoch - 41ms/step
Epoch 18/50
2046/2046 - 85s - loss: 11.0301 - accuracy10: 0.5792 - accuracy20: 0.5697 - accuracy30: 0.5499 - accuracy50: 0.5058 - val_loss: 11.5274 - val_accuracy10: 0.5876 - val_accuracy20: 0.5578 - val_accuracy30: 0.5179 - val_accuracy50: 0.4703 - 85s/epoch - 41ms/step
Epoch 19/50
2046/2046 - 84s - loss: 11.0146 - accuracy10: 0.5809 - accuracy20: 0.5709 - accuracy30: 0.5514 - accuracy50: 0.5071 - val_loss: 11.4998 - val_accuracy10: 0.5899 - val_accuracy20: 0.5587 - val_accuracy30: 0.5185 - val_accuracy50: 0.4707 - 84s/epoch - 41ms/step
Epoch 20/50
2046/2046 - 85s - loss: 11.0028 - accuracy10: 0.5809 - accuracy20: 0.5719 - accuracy30: 0.5517 - accuracy50: 0.5073 - val_loss: 11.5277 - val_accuracy10: 0.5926 - val_accuracy20: 0.5606 - val_accuracy30: 0.5182 - val_accuracy50: 0.4696 - 85s/epoch - 41ms/step
Epoch 21/50
2046/2046 - 85s - loss: 10.9839 - accuracy10: 0.5818 - accuracy20: 0.5724 - accuracy30: 0.5526 - accuracy50: 0.5082 - val_loss: 11.5062 - val_accuracy10: 0.5889 - val_accuracy20: 0.5589 - val_accuracy30: 0.5188 - val_accuracy50: 0.4703 - 85s/epoch - 41ms/step
Epoch 22/50
2046/2046 - 85s - loss: 10.9725 - accuracy10: 0.5823 - accuracy20: 0.5733 - accuracy30: 0.5535 - accuracy50: 0.5089 - val_loss: 11.4714 - val_accuracy10: 0.5882 - val_accuracy20: 0.5611 - val_accuracy30: 0.5239 - val_accuracy50: 0.4743 - 85s/epoch - 41ms/step
Epoch 23/50
2046/2046 - 85s - loss: 10.9616 - accuracy10: 0.5831 - accuracy20: 0.5740 - accuracy30: 0.5543 - accuracy50: 0.5098 - val_loss: 11.4365 - val_accuracy10: 0.5917 - val_accuracy20: 0.5619 - val_accuracy30: 0.5229 - val_accuracy50: 0.4716 - 85s/epoch - 41ms/step
Epoch 24/50
2046/2046 - 87s - loss: 10.9503 - accuracy10: 0.5833 - accuracy20: 0.5743 - accuracy30: 0.5552 - accuracy50: 0.5105 - val_loss: 11.4540 - val_accuracy10: 0.5848 - val_accuracy20: 0.5604 - val_accuracy30: 0.5250 - val_accuracy50: 0.4763 - 87s/epoch - 43ms/step
Epoch 25/50
2046/2046 - 86s - loss: 10.9366 - accuracy10: 0.5836 - accuracy20: 0.5749 - accuracy30: 0.5558 - accuracy50: 0.5112 - val_loss: 11.4321 - val_accuracy10: 0.5825 - val_accuracy20: 0.5610 - val_accuracy30: 0.5278 - val_accuracy50: 0.4770 - 86s/epoch - 42ms/step
Epoch 26/50
2046/2046 - 85s - loss: 10.9284 - accuracy10: 0.5845 - accuracy20: 0.5752 - accuracy30: 0.5559 - accuracy50: 0.5116 - val_loss: 11.4598 - val_accuracy10: 0.5879 - val_accuracy20: 0.5606 - val_accuracy30: 0.5237 - val_accuracy50: 0.4743 - 85s/epoch - 41ms/step
Epoch 27/50
2046/2046 - 83s - loss: 10.9149 - accuracy10: 0.5844 - accuracy20: 0.5759 - accuracy30: 0.5569 - accuracy50: 0.5125 - val_loss: 11.4037 - val_accuracy10: 0.5855 - val_accuracy20: 0.5613 - val_accuracy30: 0.5285 - val_accuracy50: 0.4790 - 83s/epoch - 41ms/step
Epoch 28/50
2046/2046 - 85s - loss: 10.9047 - accuracy10: 0.5851 - accuracy20: 0.5771 - accuracy30: 0.5578 - accuracy50: 0.5133 - val_loss: 11.5153 - val_accuracy10: 0.5903 - val_accuracy20: 0.5588 - val_accuracy30: 0.5204 - val_accuracy50: 0.4717 - 85s/epoch - 42ms/step
Epoch 29/50
2046/2046 - 85s - loss: 10.8987 - accuracy10: 0.5854 - accuracy20: 0.5770 - accuracy30: 0.5580 - accuracy50: 0.5138 - val_loss: 11.4632 - val_accuracy10: 0.5877 - val_accuracy20: 0.5594 - val_accuracy30: 0.5241 - val_accuracy50: 0.4740 - 85s/epoch - 41ms/step
Epoch 30/50
2046/2046 - 85s - loss: 10.8839 - accuracy10: 0.5852 - accuracy20: 0.5777 - accuracy30: 0.5591 - accuracy50: 0.5149 - val_loss: 11.4226 - val_accuracy10: 0.5819 - val_accuracy20: 0.5594 - val_accuracy30: 0.5279 - val_accuracy50: 0.4785 - 85s/epoch - 41ms/step
Epoch 31/50
2046/2046 - 84s - loss: 10.8760 - accuracy10: 0.5857 - accuracy20: 0.5781 - accuracy30: 0.5594 - accuracy50: 0.5149 - val_loss: 11.4463 - val_accuracy10: 0.5845 - val_accuracy20: 0.5596 - val_accuracy30: 0.5256 - val_accuracy50: 0.4772 - 84s/epoch - 41ms/step
Epoch 32/50
2046/2046 - 85s - loss: 10.8656 - accuracy10: 0.5865 - accuracy20: 0.5783 - accuracy30: 0.5599 - accuracy50: 0.5158 - val_loss: 11.4526 - val_accuracy10: 0.5836 - val_accuracy20: 0.5570 - val_accuracy30: 0.5249 - val_accuracy50: 0.4758 - 85s/epoch - 42ms/step
Epoch 33/50
2046/2046 - 84s - loss: 10.8549 - accuracy10: 0.5866 - accuracy20: 0.5787 - accuracy30: 0.5608 - accuracy50: 0.5172 - val_loss: 11.4823 - val_accuracy10: 0.5867 - val_accuracy20: 0.5581 - val_accuracy30: 0.5246 - val_accuracy50: 0.4759 - 84s/epoch - 41ms/step
Epoch 34/50
2046/2046 - 84s - loss: 10.8475 - accuracy10: 0.5871 - accuracy20: 0.5791 - accuracy30: 0.5609 - accuracy50: 0.5173 - val_loss: 11.5003 - val_accuracy10: 0.5845 - val_accuracy20: 0.5578 - val_accuracy30: 0.5242 - val_accuracy50: 0.4759 - 84s/epoch - 41ms/step
Epoch 35/50
2046/2046 - 84s - loss: 10.8366 - accuracy10: 0.5877 - accuracy20: 0.5802 - accuracy30: 0.5620 - accuracy50: 0.5178 - val_loss: 11.4610 - val_accuracy10: 0.5869 - val_accuracy20: 0.5602 - val_accuracy30: 0.5265 - val_accuracy50: 0.4777 - 84s/epoch - 41ms/step
Epoch 36/50
2046/2046 - 84s - loss: 10.8302 - accuracy10: 0.5875 - accuracy20: 0.5806 - accuracy30: 0.5627 - accuracy50: 0.5189 - val_loss: 11.5121 - val_accuracy10: 0.5889 - val_accuracy20: 0.5589 - val_accuracy30: 0.5241 - val_accuracy50: 0.4751 - 84s/epoch - 41ms/step
Epoch 37/50
2046/2046 - 84s - loss: 10.8178 - accuracy10: 0.5883 - accuracy20: 0.5811 - accuracy30: 0.5634 - accuracy50: 0.5197 - val_loss: 11.5682 - val_accuracy10: 0.5885 - val_accuracy20: 0.5571 - val_accuracy30: 0.5221 - val_accuracy50: 0.4737 - 84s/epoch - 41ms/step
testing model: results/ATVI/W6/deepVOL_L3/seq2seq
Evaluating performance on  test set...
7324/7324 - 119s - 119s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9157848
{'0': {'precision': 0.4654345075731837, 'recall': 0.5886339222687141, 'f1-score': 0.5198344471679209, 'support': 488735}, '1': {'precision': 0.6988214858686868, 'recall': 0.5736691602090923, 'f1-score': 0.6300908162587084, 'support': 908881}, '2': {'precision': 0.4720242117944348, 'recall': 0.5050745142425958, 'f1-score': 0.48799040082625805, 'support': 477090}, 'accuracy': 0.5601139592021362, 'macro avg': {'precision': 0.5454267350787684, 'recall': 0.555792532240134, 'f1-score': 0.5459718880842959, 'support': 1874706}, 'weighted avg': {'precision': 0.5802604441238278, 'recall': 0.5601139592021362, 'f1-score': 0.5651841942357065, 'support': 1874706}}
[[287686 110265  90784]
 [208739 521397 178745]
 [121677 114447 240966]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.94975877
{'0': {'precision': 0.5205268138179381, 'recall': 0.5234004103248571, 'f1-score': 0.5219596570270739, 'support': 605374}, '1': {'precision': 0.5590524267055569, 'recall': 0.6124741358168824, 'f1-score': 0.5845452640622624, 'support': 680961}, '2': {'precision': 0.5256174537174156, 'recall': 0.46450113958709727, 'f1-score': 0.4931730560149558, 'support': 588371}, 'accuracy': 0.5372698439115253, 'macro avg': {'precision': 0.5350655647469702, 'recall': 0.5334585619096123, 'f1-score': 0.5332259923680974, 'support': 1874706}, 'weighted avg': {'precision': 0.5361183917858228, 'recall': 0.5372698439115253, 'f1-score': 0.5356584217017419, 'support': 1874706}}
[[316853 162283 126238]
 [143469 417071 120421]
 [148394 166678 273299]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9812921
{'0': {'precision': 0.5381197221465541, 'recall': 0.4695561745589601, 'f1-score': 0.5015053729318477, 'support': 673125}, '1': {'precision': 0.4554224412451392, 'recall': 0.6382533202719582, 'f1-score': 0.5315558696260396, 'support': 549202}, '2': {'precision': 0.538587696676422, 'recall': 0.4273712060014194, 'f1-score': 0.4765769492429345, 'support': 652379}, 'accuracy': 0.504296673718439, 'macro avg': {'precision': 0.5107099533560384, 'recall': 0.5117269002774459, 'f1-score': 0.5032127306002739, 'support': 1874706}, 'weighted avg': {'precision': 0.5140561008055021, 'recall': 0.504296673718439, 'f1-score': 0.5016339332328731, 'support': 1874706}}
[[316070 206941 150114]
 [109929 350530  88743]
 [161361 212210 278808]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0402994
{'0': {'precision': 0.4830206360602816, 'recall': 0.4148525471630267, 'f1-score': 0.446348871858614, 'support': 653531}, '1': {'precision': 0.41516239312062125, 'recall': 0.5853791316512134, 'f1-score': 0.48579173410041004, 'support': 580458}, '2': {'precision': 0.48858596939960924, 'recall': 0.37743808889103925, 'f1-score': 0.4258795186663825, 'support': 640717}, 'accuracy': 0.45486492281989815, 'macro avg': {'precision': 0.4622563328601707, 'recall': 0.4592232559017598, 'f1-score': 0.45267337487513554, 'support': 1874706}, 'weighted avg': {'precision': 0.4639120098015, 'recall': 0.45486492281989815, 'f1-score': 0.45156561643716736, 'support': 1874706}}
[[271119 235163 147249]
 [134789 339788 105881]
 [155391 243495 241831]]
Evaluating performance on  train set...
2046/2046 - 34s - 34s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8805629
{'0': {'precision': 0.45179580560090415, 'recall': 0.5849171639000439, 'f1-score': 0.5098096176055888, 'support': 123014}, '1': {'precision': 0.7420522235283241, 'recall': 0.6087020899317079, 'f1-score': 0.6687948130894894, 'support': 276899}, '2': {'precision': 0.46458395521029755, 'recall': 0.5152819386461454, 'f1-score': 0.4886213972862875, 'support': 123839}, 'accuracy': 0.5810268982266417, 'macro avg': {'precision': 0.5528106614465086, 'recall': 0.5696337308259657, 'f1-score': 0.5557419426604553, 'support': 523752}, 'weighted avg': {'precision': 0.6082732673140094, 'recall': 0.5810268982266417, 'f1-score': 0.5888525876146286, 'support': 523752}}
[[ 71953  28508  22553]
 [ 57362 168549  50988]
 [ 29945  30082  63812]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9202553
{'0': {'precision': 0.5105398160112631, 'recall': 0.5169740328218883, 'f1-score': 0.5137367791182845, 'support': 153617}, '1': {'precision': 0.6151057030481809, 'recall': 0.6489297655765187, 'f1-score': 0.6315651887808681, 'support': 215934}, '2': {'precision': 0.5212584852305348, 'recall': 0.474575391858678, 'f1-score': 0.49682272431023244, 'support': 154201}, 'accuracy': 0.5588942858452092, 'macro avg': {'precision': 0.5489680014299929, 'recall': 0.5468263967523617, 'f1-score': 0.5473748974031284, 'support': 523752}, 'weighted avg': {'precision': 0.5568062928241644, 'recall': 0.5588942858452092, 'f1-score': 0.5573356496650775, 'support': 523752}}
[[ 79416  42669  31532]
 [ 40129 140126  35679]
 [ 36008  45013  73180]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9540758
{'0': {'precision': 0.5348217683622987, 'recall': 0.4638171227403796, 'f1-score': 0.49679517990095606, 'support': 172706}, '1': {'precision': 0.5162264118626867, 'recall': 0.6761581604038138, 'f1-score': 0.5854666508028622, 'support': 178300}, '2': {'precision': 0.5385015238257996, 'recall': 0.4377814826392507, 'f1-score': 0.4829460186089878, 'support': 172746}, 'accuracy': 0.5275168400311598, 'macro avg': {'precision': 0.5298499013502617, 'recall': 0.5259189219278148, 'f1-score': 0.5217359497709354, 'support': 523752}, 'weighted avg': {'precision': 0.5297050546760829, 'recall': 0.5275168400311598, 'f1-score': 0.522413671181691, 'support': 523752}}
[[ 80104  54846  37756]
 [ 30686 120559  27055]
 [ 38987  58134  75625]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0115422
{'0': {'precision': 0.4997830438251473, 'recall': 0.40819686187087373, 'f1-score': 0.4493708920778653, 'support': 174945}, '1': {'precision': 0.45543852211768926, 'recall': 0.6428246773794524, 'f1-score': 0.5331456451978479, 'support': 173811}, '2': {'precision': 0.5028478257661831, 'recall': 0.38947747377082903, 'f1-score': 0.4389607713065712, 'support': 174996}, 'accuracy': 0.4798053277123524, 'macro avg': {'precision': 0.4860231305696732, 'recall': 0.4801663376737184, 'f1-score': 0.47382576952742816, 'support': 523752}, 'weighted avg': {'precision': 0.48609098903215087, 'recall': 0.4798053277123524, 'f1-score': 0.4736939383288465, 'support': 523752}}
[[ 71412  65034  38499]
 [ 33195 111730  28886]
 [ 38279  68560  68157]]
Evaluating performance on  val set...
741/741 - 12s - 12s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8750295
{'0': {'precision': 0.46059274743573847, 'recall': 0.5899169578436266, 'f1-score': 0.5172945495060832, 'support': 44074}, '1': {'precision': 0.7458200014434527, 'recall': 0.6159523951441458, 'f1-score': 0.6746936821258352, 'support': 100662}, '2': {'precision': 0.4539764432979383, 'recall': 0.506131002809114, 'f1-score': 0.47863716385026517, 'support': 44854}, 'accuracy': 0.5839179281607679, 'macro avg': {'precision': 0.5534630640590431, 'recall': 0.5706667852656288, 'f1-score': 0.5568751318273945, 'support': 189590}, 'weighted avg': {'precision': 0.6104676255259734, 'recall': 0.5839179281607679, 'f1-score': 0.5917192191171567, 'support': 189590}}
[[26000  9549  8525]
 [19879 62003 18780]
 [10570 11582 22702]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9180638
{'0': {'precision': 0.5162331151904042, 'recall': 0.5136394964994377, 'f1-score': 0.5149330399759979, 'support': 55134}, '1': {'precision': 0.6202033963120974, 'recall': 0.659667230180621, 'f1-score': 0.6393268946486647, 'support': 78673}, '2': {'precision': 0.506365808751518, 'recall': 0.4634386820357457, 'f1-score': 0.48395218884843266, 'support': 55783}, 'accuracy': 0.5594651616646448, 'macro avg': {'precision': 0.5476007734180065, 'recall': 0.5455818029052681, 'f1-score': 0.5460707078243651, 'support': 189590}, 'weighted avg': {'precision': 0.5564737711933927, 'recall': 0.5594651616646448, 'f1-score': 0.5574365101496027, 'support': 189590}}
[[28319 14754 12061]
 [13634 51898 13141]
 [12904 17027 25852]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9556542
{'0': {'precision': 0.5397135540168833, 'recall': 0.45908702176754396, 'f1-score': 0.4961460658482143, 'support': 61973}, '1': {'precision': 0.5224905440791388, 'recall': 0.6894089464228129, 'f1-score': 0.5944546694384492, 'support': 65121}, '2': {'precision': 0.5244160942100098, 'recall': 0.42753136200716846, 'f1-score': 0.47104349205789536, 'support': 62496}, 'accuracy': 0.5277968247270426, 'macro avg': {'precision': 0.5288733974353439, 'recall': 0.525342443399175, 'f1-score': 0.5205480757815196, 'support': 189590}, 'weighted avg': {'precision': 0.5287551190875821, 'recall': 0.5277968247270426, 'f1-score': 0.5216386768656727, 'support': 189590}}
[[28451 19128 14394]
 [10389 44895  9837]
 [13875 21902 26719]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0167612
{'0': {'precision': 0.5011478329705126, 'recall': 0.3994668096920747, 'f1-score': 0.44456733554537314, 'support': 63392}, '1': {'precision': 0.46079018589999554, 'recall': 0.6534795192852199, 'f1-score': 0.5404740840965863, 'support': 63572}, '2': {'precision': 0.48523638148208736, 'recall': 0.37891610513205376, 'f1-score': 0.42553573029678116, 'support': 62626}, 'accuracy': 0.4778522073949048, 'macro avg': {'precision': 0.4823914667841985, 'recall': 0.4772874780364495, 'f1-score': 0.4701923833129135, 'support': 189590}, 'weighted avg': {'precision': 0.4823594638556804, 'recall': 0.4778522073949048, 'f1-score': 0.4704395361287341, 'support': 189590}}
[[25323 23459 14610]
 [11465 41543 10564]
 [13742 25154 23730]]
training model: results/ATVI/W7/deepLOB_L1/seq2seq
Epoch 1/50
2083/2083 - 56s - loss: 12.3337 - accuracy10: 0.4538 - accuracy20: 0.4656 - accuracy30: 0.4646 - accuracy50: 0.4386 - val_loss: 13.4395 - val_accuracy10: 0.5296 - val_accuracy20: 0.4271 - val_accuracy30: 0.3612 - val_accuracy50: 0.3508 - 56s/epoch - 27ms/step
Epoch 2/50
2083/2083 - 52s - loss: 12.2150 - accuracy10: 0.4624 - accuracy20: 0.4786 - accuracy30: 0.4762 - accuracy50: 0.4456 - val_loss: 13.0973 - val_accuracy10: 0.5162 - val_accuracy20: 0.4537 - val_accuracy30: 0.4035 - val_accuracy50: 0.3786 - 52s/epoch - 25ms/step
Epoch 3/50
2083/2083 - 53s - loss: 11.9264 - accuracy10: 0.5018 - accuracy20: 0.5071 - accuracy30: 0.4982 - accuracy50: 0.4617 - val_loss: 12.9826 - val_accuracy10: 0.5312 - val_accuracy20: 0.4651 - val_accuracy30: 0.4146 - val_accuracy50: 0.3870 - 53s/epoch - 25ms/step
Epoch 4/50
2083/2083 - 53s - loss: 11.7585 - accuracy10: 0.5250 - accuracy20: 0.5215 - accuracy30: 0.5085 - accuracy50: 0.4695 - val_loss: 12.8981 - val_accuracy10: 0.5419 - val_accuracy20: 0.4783 - val_accuracy30: 0.4307 - val_accuracy50: 0.4003 - 53s/epoch - 25ms/step
Epoch 5/50
2083/2083 - 50s - loss: 11.6532 - accuracy10: 0.5348 - accuracy20: 0.5282 - accuracy30: 0.5139 - accuracy50: 0.4738 - val_loss: 13.0882 - val_accuracy10: 0.5475 - val_accuracy20: 0.4815 - val_accuracy30: 0.4324 - val_accuracy50: 0.4019 - 50s/epoch - 24ms/step
Epoch 6/50
2083/2083 - 48s - loss: 11.5820 - accuracy10: 0.5413 - accuracy20: 0.5336 - accuracy30: 0.5188 - accuracy50: 0.4772 - val_loss: 13.1122 - val_accuracy10: 0.5524 - val_accuracy20: 0.4804 - val_accuracy30: 0.4276 - val_accuracy50: 0.3975 - 48s/epoch - 23ms/step
Epoch 7/50
2083/2083 - 52s - loss: 11.5300 - accuracy10: 0.5454 - accuracy20: 0.5375 - accuracy30: 0.5218 - accuracy50: 0.4794 - val_loss: 13.1053 - val_accuracy10: 0.5583 - val_accuracy20: 0.4842 - val_accuracy30: 0.4289 - val_accuracy50: 0.3980 - 52s/epoch - 25ms/step
Epoch 8/50
2083/2083 - 51s - loss: 11.4866 - accuracy10: 0.5494 - accuracy20: 0.5407 - accuracy30: 0.5241 - accuracy50: 0.4813 - val_loss: 13.2792 - val_accuracy10: 0.5607 - val_accuracy20: 0.4851 - val_accuracy30: 0.4289 - val_accuracy50: 0.3975 - 51s/epoch - 24ms/step
Epoch 9/50
2083/2083 - 50s - loss: 11.4555 - accuracy10: 0.5509 - accuracy20: 0.5423 - accuracy30: 0.5261 - accuracy50: 0.4829 - val_loss: 13.3373 - val_accuracy10: 0.5602 - val_accuracy20: 0.4861 - val_accuracy30: 0.4304 - val_accuracy50: 0.3992 - 50s/epoch - 24ms/step
Epoch 10/50
2083/2083 - 49s - loss: 11.4224 - accuracy10: 0.5538 - accuracy20: 0.5442 - accuracy30: 0.5272 - accuracy50: 0.4839 - val_loss: 13.4419 - val_accuracy10: 0.5641 - val_accuracy20: 0.4842 - val_accuracy30: 0.4271 - val_accuracy50: 0.3959 - 49s/epoch - 24ms/step
Epoch 11/50
2083/2083 - 52s - loss: 11.3926 - accuracy10: 0.5556 - accuracy20: 0.5462 - accuracy30: 0.5291 - accuracy50: 0.4852 - val_loss: 13.0395 - val_accuracy10: 0.5644 - val_accuracy20: 0.4916 - val_accuracy30: 0.4382 - val_accuracy50: 0.4050 - 52s/epoch - 25ms/step
Epoch 12/50
2083/2083 - 51s - loss: 11.3691 - accuracy10: 0.5568 - accuracy20: 0.5469 - accuracy30: 0.5297 - accuracy50: 0.4858 - val_loss: 13.3346 - val_accuracy10: 0.5646 - val_accuracy20: 0.4894 - val_accuracy30: 0.4344 - val_accuracy50: 0.4039 - 51s/epoch - 24ms/step
Epoch 13/50
2083/2083 - 50s - loss: 11.3435 - accuracy10: 0.5591 - accuracy20: 0.5491 - accuracy30: 0.5316 - accuracy50: 0.4872 - val_loss: 13.2690 - val_accuracy10: 0.5670 - val_accuracy20: 0.4915 - val_accuracy30: 0.4354 - val_accuracy50: 0.4028 - 50s/epoch - 24ms/step
Epoch 14/50
2083/2083 - 50s - loss: 11.3242 - accuracy10: 0.5599 - accuracy20: 0.5499 - accuracy30: 0.5323 - accuracy50: 0.4879 - val_loss: 13.1618 - val_accuracy10: 0.5695 - val_accuracy20: 0.4945 - val_accuracy30: 0.4385 - val_accuracy50: 0.4043 - 50s/epoch - 24ms/step
testing model: results/ATVI/W7/deepLOB_L1/seq2seq
Evaluating performance on  test set...
6143/6143 - 68s - 68s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.84069884
{'0': {'precision': 0.46270305685270713, 'recall': 0.22762822356134602, 'f1-score': 0.3051412498782146, 'support': 316459}, '1': {'precision': 0.6627804060729948, 'recall': 0.8454848662337539, 'f1-score': 0.743066638554828, 'support': 944147}, '2': {'precision': 0.44704220710435255, 'recall': 0.3044412239977428, 'f1-score': 0.36221178292621986, 'support': 311896}, 'accuracy': 0.6138313337598299, 'macro avg': {'precision': 0.5241752233433515, 'recall': 0.45918477126428087, 'f1-score': 0.4701398904530875, 'support': 1572502}, 'weighted avg': {'precision': 0.5797254025420443, 'recall': 0.6138313337598299, 'f1-score': 0.5793959172289711, 'support': 1572502}}
[[ 72035 210652  33772]
 [ 62206 798262  83679]
 [ 21442 195500  94954]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9532124
{'0': {'precision': 0.5212645307626879, 'recall': 0.1912935982777457, 'f1-score': 0.2798777073203441, 'support': 403657}, '1': {'precision': 0.548645395636525, 'recall': 0.8584886597671075, 'f1-score': 0.6694541271013275, 'support': 772030}, '2': {'precision': 0.49759175372099473, 'recall': 0.2712825876037952, 'f1-score': 0.35113144310981725, 'support': 396815}, 'accuracy': 0.539042239691905, 'macro avg': {'precision': 0.5225005600400693, 'recall': 0.4403549485495495, 'f1-score': 0.4334877591771629, 'support': 1572502}, 'weighted avg': {'precision': 0.5287336062148965, 'recall': 0.539042239691905, 'f1-score': 0.48912337729775107, 'support': 1572502}}
[[ 77217 282675  43765]
 [ 44325 662779  64926]
 [ 26592 262574 107649]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0288587
{'0': {'precision': 0.5455742044330677, 'recall': 0.16227399458819916, 'f1-score': 0.2501454566672502, 'support': 462323}, '1': {'precision': 0.4661321732060428, 'recall': 0.8684125740758555, 'f1-score': 0.6066413902087414, 'support': 654903}, '2': {'precision': 0.5155192792725716, 'recall': 0.2433293211151038, 'f1-score': 0.3306086515361774, 'support': 455276}, 'accuracy': 0.4798283245426715, 'macro avg': {'precision': 0.5090752189705606, 'recall': 0.4246719632597195, 'f1-score': 0.39579849947072304, 'support': 1572502}, 'weighted avg': {'precision': 0.5037872237589303, 'recall': 0.4798283245426715, 'f1-score': 0.42191199042763267, 'support': 1572502}}
[[ 75023 336413  50887]
 [ 32952 568726  53225]
 [ 29537 314957 110782]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0722004
{'0': {'precision': 0.5117071128359555, 'recall': 0.13345470733745754, 'f1-score': 0.2116979673957216, 'support': 476214}, '1': {'precision': 0.42789857321724717, 'recall': 0.8578242331575902, 'f1-score': 0.5709811844658209, 'support': 618706}, '2': {'precision': 0.4808209231538606, 'recall': 0.20937137496806832, 'f1-score': 0.29171620160952705, 'support': 477582}, 'accuracy': 0.4415167675462416, 'macro avg': {'precision': 0.47347553640235446, 'recall': 0.4002167718210387, 'f1-score': 0.3581317844903566, 'support': 1572502}, 'weighted avg': {'precision': 0.469351977800142, 'recall': 0.4415167675462416, 'f1-score': 0.3773613181786589, 'support': 1572502}}
[[ 63553 360532  52129]
 [ 32125 530741  55840]
 [ 28520 349070  99992]]
Evaluating performance on  train set...
2083/2083 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.93080634
{'0': {'precision': 0.4595354342358337, 'recall': 0.3188307381320868, 'f1-score': 0.37646554255958903, 'support': 126644}, '1': {'precision': 0.6370730888646472, 'recall': 0.648847296113497, 'f1-score': 0.6429062887023531, 'support': 280818}, '2': {'precision': 0.39960587917812, 'recall': 0.5063337441851219, 'f1-score': 0.44668305874842595, 'support': 125755}, 'accuracy': 0.5368546014099326, 'macro avg': {'precision': 0.498738134092867, 'recall': 0.4913372594769019, 'f1-score': 0.4886849633367894, 'support': 533217}, 'weighted avg': {'precision': 0.5389014857707086, 'recall': 0.5368546014099326, 'f1-score': 0.5333464394526849, 'support': 533217}}
[[ 40378  54904  31362]
 [ 34304 182208  64306]
 [ 13185  48896  63674]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0026346
{'0': {'precision': 0.5123027656477438, 'recall': 0.2789921934947904, 'f1-score': 0.3612520733770179, 'support': 157689}, '1': {'precision': 0.5135088781628345, 'recall': 0.6691600720654975, 'f1-score': 0.5810918395234342, 'support': 219245}, '2': {'precision': 0.45312760995044576, 'recall': 0.4686626184549823, 'f1-score': 0.46076420779809013, 'support': 156283}, 'accuracy': 0.4950104741596761, 'macro avg': {'precision': 0.49297975125367466, 'recall': 0.47227162800509004, 'f1-score': 0.4677027068995141, 'support': 533217}, 'weighted avg': {'precision': 0.4954547718300865, 'recall': 0.4950104741596761, 'f1-score': 0.48081094796747453, 'support': 533217}}
[[ 43994  73195  40500]
 [ 24638 146710  47897]
 [ 17243  65796  73244]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0480962
{'0': {'precision': 0.5319434859986198, 'recall': 0.24818260383305374, 'f1-score': 0.33845585006817186, 'support': 177039}, '1': {'precision': 0.427588112383222, 'recall': 0.6848434561345281, 'f1-score': 0.5264699941529792, 'support': 180780}, '2': {'precision': 0.47762815617763377, 'recall': 0.4386195965746474, 'f1-score': 0.45729349631914784, 'support': 175398}, 'accuracy': 0.4588694659022499, 'macro avg': {'precision': 0.4790532515198252, 'recall': 0.45721521884740973, 'f1-score': 0.4407397801800997, 'support': 533217}, 'weighted avg': {'precision': 0.4786965627719918, 'recall': 0.4588694659022499, 'f1-score': 0.4412903104187986, 'support': 533217}}
[[ 43938  87086  46015]
 [ 18849 123806  38125]
 [ 19812  78653  76933]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0772047
{'0': {'precision': 0.4883355851508718, 'recall': 0.21360747916045186, 'f1-score': 0.29720967021951433, 'support': 177667}, '1': {'precision': 0.39334522286148027, 'recall': 0.6576280132744108, 'f1-score': 0.4922577065662382, 'support': 178087}, '2': {'precision': 0.44905901965631556, 'recall': 0.3992043411866135, 'f1-score': 0.42266663484714695, 'support': 177463}, 'accuracy': 0.42367366381792027, 'macro avg': {'precision': 0.4435799425562226, 'recall': 0.42347994454049204, 'f1-score': 0.40404467054429977, 'support': 533217}, 'weighted avg': {'precision': 0.44353827787936456, 'recall': 0.42367366381792027, 'f1-score': 0.4041070290107618, 'support': 533217}}
[[ 37951  93834  45882]
 [ 19937 117115  41035]
 [ 19827  86792  70844]]
Evaluating performance on  val set...
685/685 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.93679935
{'0': {'precision': 0.4703392507423084, 'recall': 0.18355975245938017, 'f1-score': 0.2640632758742995, 'support': 40559}, '1': {'precision': 0.6021056022242754, 'recall': 0.7551428298055558, 'f1-score': 0.6699963213446899, 'support': 94063}, '2': {'precision': 0.39890750006042586, 'recall': 0.4069936623017928, 'f1-score': 0.4029100141594648, 'support': 40551}, 'accuracy': 0.542206846945591, 'macro avg': {'precision': 0.49045078434233663, 'recall': 0.44856541485557627, 'f1-score': 0.4456565371261514, 'support': 175173}, 'weighted avg': {'precision': 0.5245582764914092, 'recall': 0.542206846945591, 'f1-score': 0.5141797558128921, 'support': 175173}}
[[ 7445 24911  8203]
 [ 6366 71031 16666]
 [ 2018 22029 16504]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0233922
{'0': {'precision': 0.5204533611255863, 'recall': 0.15850973079135836, 'f1-score': 0.24300856156571726, 'support': 50407}, '1': {'precision': 0.48348570747569675, 'recall': 0.7655407591114946, 'f1-score': 0.5926664092744671, 'support': 74192}, '2': {'precision': 0.4519092261553357, 'recall': 0.3783960137620121, 'f1-score': 0.41189827918339234, 'support': 50574}, 'accuracy': 0.47909209752644527, 'macro avg': {'precision': 0.4852827649188729, 'recall': 0.43414883455495495, 'f1-score': 0.4158577500078589, 'support': 175173}, 'weighted avg': {'precision': 0.48500694391758015, 'recall': 0.47909209752644527, 'f1-score': 0.4398610651821643, 'support': 175173}}
[[ 7990 31985 10432]
 [ 4617 56797 12778]
 [ 2745 28692 19137]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0736845
{'0': {'precision': 0.5379955947136564, 'recall': 0.13757656833063436, 'f1-score': 0.21911970843846368, 'support': 56812}, '1': {'precision': 0.4030423392208231, 'recall': 0.7747238466536712, 'f1-score': 0.5302351436989271, 'support': 61560}, '2': {'precision': 0.47389814486588683, 'recall': 0.3530395591626908, 'f1-score': 0.4046369910004439, 'support': 56801}, 'accuracy': 0.43135072185782053, 'macro avg': {'precision': 0.47164535960012216, 'recall': 0.42177999138233213, 'f1-score': 0.38466394771261153, 'support': 175173}, 'weighted avg': {'precision': 0.46978575839788866, 'recall': 0.43135072185782053, 'f1-score': 0.38860834744925393, 'support': 175173}}
[[ 7816 37110 11886]
 [ 3492 47692 10376]
 [ 3220 33528 20053]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0989666
{'0': {'precision': 0.49608588682621335, 'recall': 0.11598598546253203, 'f1-score': 0.18801390183945071, 'support': 57369}, '1': {'precision': 0.3762791199488767, 'recall': 0.756557869443332, 'f1-score': 0.5025911617827193, 'support': 59928}, '2': {'precision': 0.44231468243390604, 'recall': 0.31538115972078234, 'f1-score': 0.3682156077584902, 'support': 57876}, 'accuracy': 0.40100928796104424, 'macro avg': {'precision': 0.43822656306966534, 'recall': 0.3959750048755488, 'f1-score': 0.35294022379355344, 'support': 175173}, 'weighted avg': {'precision': 0.437333441239084, 'recall': 0.40100928796104424, 'f1-score': 0.35517059816622787, 'support': 175173}}
[[ 6654 38821 11894]
 [ 3469 45339 11120]
 [ 3290 36333 18253]]
training model: results/ATVI/W7/deepOF_L1/seq2seq
Epoch 1/50
2083/2083 - 58s - loss: 12.8534 - accuracy10: 0.4181 - accuracy20: 0.4247 - accuracy30: 0.4222 - accuracy50: 0.4069 - val_loss: 13.8631 - val_accuracy10: 0.5349 - val_accuracy20: 0.4254 - val_accuracy30: 0.3548 - val_accuracy50: 0.3450 - 58s/epoch - 28ms/step
Epoch 2/50
2083/2083 - 46s - loss: 12.8725 - accuracy10: 0.3900 - accuracy20: 0.4056 - accuracy30: 0.4096 - accuracy50: 0.3988 - val_loss: 13.1490 - val_accuracy10: 0.5175 - val_accuracy20: 0.4340 - val_accuracy30: 0.3711 - val_accuracy50: 0.3534 - 46s/epoch - 22ms/step
Epoch 3/50
2083/2083 - 44s - loss: 12.8242 - accuracy10: 0.4006 - accuracy20: 0.4116 - accuracy30: 0.4122 - accuracy50: 0.4000 - val_loss: 13.1300 - val_accuracy10: 0.5142 - val_accuracy20: 0.4368 - val_accuracy30: 0.3791 - val_accuracy50: 0.3613 - 44s/epoch - 21ms/step
Epoch 4/50
2083/2083 - 43s - loss: 12.7863 - accuracy10: 0.4109 - accuracy20: 0.4174 - accuracy30: 0.4164 - accuracy50: 0.4037 - val_loss: 13.2426 - val_accuracy10: 0.5271 - val_accuracy20: 0.4382 - val_accuracy30: 0.3775 - val_accuracy50: 0.3608 - 43s/epoch - 20ms/step
Epoch 5/50
2083/2083 - 50s - loss: 12.7431 - accuracy10: 0.4225 - accuracy20: 0.4257 - accuracy30: 0.4227 - accuracy50: 0.4078 - val_loss: 13.2790 - val_accuracy10: 0.5256 - val_accuracy20: 0.4386 - val_accuracy30: 0.3793 - val_accuracy50: 0.3632 - 50s/epoch - 24ms/step
Epoch 6/50
2083/2083 - 47s - loss: 12.7029 - accuracy10: 0.4307 - accuracy20: 0.4319 - accuracy30: 0.4276 - accuracy50: 0.4109 - val_loss: 13.4346 - val_accuracy10: 0.5316 - val_accuracy20: 0.4395 - val_accuracy30: 0.3769 - val_accuracy50: 0.3613 - 47s/epoch - 23ms/step
Epoch 7/50
2083/2083 - 47s - loss: 12.6661 - accuracy10: 0.4353 - accuracy20: 0.4367 - accuracy30: 0.4319 - accuracy50: 0.4137 - val_loss: 13.4956 - val_accuracy10: 0.5323 - val_accuracy20: 0.4408 - val_accuracy30: 0.3776 - val_accuracy50: 0.3610 - 47s/epoch - 23ms/step
Epoch 8/50
2083/2083 - 49s - loss: 12.6211 - accuracy10: 0.4404 - accuracy20: 0.4423 - accuracy30: 0.4375 - accuracy50: 0.4169 - val_loss: 13.6026 - val_accuracy10: 0.5304 - val_accuracy20: 0.4396 - val_accuracy30: 0.3773 - val_accuracy50: 0.3608 - 49s/epoch - 24ms/step
Epoch 9/50
2083/2083 - 47s - loss: 12.5746 - accuracy10: 0.4440 - accuracy20: 0.4462 - accuracy30: 0.4419 - accuracy50: 0.4209 - val_loss: 13.6819 - val_accuracy10: 0.5305 - val_accuracy20: 0.4420 - val_accuracy30: 0.3802 - val_accuracy50: 0.3633 - 47s/epoch - 23ms/step
Epoch 10/50
2083/2083 - 48s - loss: 12.5327 - accuracy10: 0.4462 - accuracy20: 0.4502 - accuracy30: 0.4463 - accuracy50: 0.4241 - val_loss: 13.8419 - val_accuracy10: 0.5322 - val_accuracy20: 0.4420 - val_accuracy30: 0.3782 - val_accuracy50: 0.3610 - 48s/epoch - 23ms/step
Epoch 11/50
2083/2083 - 45s - loss: 12.4978 - accuracy10: 0.4507 - accuracy20: 0.4548 - accuracy30: 0.4508 - accuracy50: 0.4275 - val_loss: 14.0043 - val_accuracy10: 0.5339 - val_accuracy20: 0.4412 - val_accuracy30: 0.3772 - val_accuracy50: 0.3603 - 45s/epoch - 22ms/step
Epoch 12/50
2083/2083 - 46s - loss: 12.4634 - accuracy10: 0.4537 - accuracy20: 0.4584 - accuracy30: 0.4547 - accuracy50: 0.4306 - val_loss: 13.8061 - val_accuracy10: 0.5328 - val_accuracy20: 0.4439 - val_accuracy30: 0.3815 - val_accuracy50: 0.3645 - 46s/epoch - 22ms/step
Epoch 13/50
2083/2083 - 45s - loss: 12.4319 - accuracy10: 0.4578 - accuracy20: 0.4622 - accuracy30: 0.4584 - accuracy50: 0.4335 - val_loss: 13.8346 - val_accuracy10: 0.5297 - val_accuracy20: 0.4449 - val_accuracy30: 0.3842 - val_accuracy50: 0.3661 - 45s/epoch - 22ms/step
testing model: results/ATVI/W7/deepOF_L1/seq2seq
Evaluating performance on  test set...
6143/6143 - 58s - 58s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.96632886
{'0': {'precision': 0.3392231337000999, 'recall': 0.32850908654256344, 'f1-score': 0.33378015440209724, 'support': 316457}, '1': {'precision': 0.6281600774049771, 'recall': 0.761889580636893, 'f1-score': 0.6885921163724362, 'support': 944146}, '2': {'precision': 0.4070759126140509, 'recall': 0.1577811692433968, 'f1-score': 0.22741651127701415, 'support': 311894}, 'accuracy': 0.554853204807386, 'macro avg': {'precision': 0.4581530412397093, 'recall': 0.41605994547428443, 'f1-score': 0.4165962606838492, 'support': 1572497}, 'weighted avg': {'precision': 0.5261624628547965, 'recall': 0.554853204807386, 'f1-score': 0.525716999138585, 'support': 1572497}}
[[103959 197501  14997]
 [168130 719335  56681]
 [ 34373 228310  49211]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0157845
{'0': {'precision': 0.4147126697688495, 'recall': 0.27157169258820674, 'f1-score': 0.32821444825025753, 'support': 403654}, '1': {'precision': 0.5131149243377738, 'recall': 0.8000194292967889, 'f1-score': 0.6252245366914085, 'support': 772030}, '2': {'precision': 0.48312304952997265, 'recall': 0.12718333320732939, 'f1-score': 0.20135853573387857, 'support': 396813}, 'accuracy': 0.49458154769134693, 'macro avg': {'precision': 0.4703168812121987, 'recall': 0.39959148503077496, 'f1-score': 0.38493250689184816, 'support': 1572497}, 'weighted avg': {'precision': 0.48028711640944544, 'recall': 0.49458154769134693, 'f1-score': 0.44202237498452784, 'support': 1572497}}
[[109621 278759  15274]
 [115671 617639  38720]
 [ 39038 307307  50468]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0523342
{'0': {'precision': 0.4620646468895496, 'recall': 0.2090833582079867, 'f1-score': 0.28789485284043864, 'support': 462318}, '1': {'precision': 0.4336113515315521, 'recall': 0.8460672801926392, 'f1-score': 0.5733695441278961, 'support': 654903}, '2': {'precision': 0.5280706887471472, 'recall': 0.09910691536562437, 'f1-score': 0.16689198311143824, 'support': 455276}, 'accuracy': 0.44252930212267494, 'macro avg': {'precision': 0.474582229056083, 'recall': 0.3847525179220834, 'f1-score': 0.3427187933599243, 'support': 1572497}, 'weighted avg': {'precision': 0.469324958497725, 'recall': 0.44252930212267494, 'f1-score': 0.371754172908769, 'support': 1572497}}
[[ 96663 351495  14160]
 [ 74647 554092  26164]
 [ 37888 372267  45121]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0682817
{'0': {'precision': 0.4685800836189266, 'recall': 0.14097352008567648, 'f1-score': 0.21674019619712692, 'support': 476210}, '1': {'precision': 0.404250375466447, 'recall': 0.8914088436187786, 'f1-score': 0.5562455843619469, 'support': 618706}, '2': {'precision': 0.5270542934154794, 'recall': 0.07165067287015187, 'f1-score': 0.1261516001666341, 'support': 477581}, 'accuracy': 0.41518171417815103, 'macro avg': {'precision': 0.46662825083361764, 'recall': 0.36801101219153565, 'f1-score': 0.2997124602419026, 'support': 1572497}, 'weighted avg': {'precision': 0.4610283968282107, 'recall': 0.41518171417815103, 'f1-score': 0.32280757083063294, 'support': 1572497}}
[[ 67133 397993  11084]
 [ 47564 551520  19622]
 [ 28572 414790  34219]]
Evaluating performance on  train set...
2083/2083 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0092627
{'0': {'precision': 0.3703699888756129, 'recall': 0.2827764102644762, 'f1-score': 0.32069960444343365, 'support': 127157}, '1': {'precision': 0.5472720515859465, 'recall': 0.7766730810348514, 'f1-score': 0.6420983166094145, 'support': 280620}, '2': {'precision': 0.41006757470172106, 'recall': 0.1238450561627564, 'f1-score': 0.19023652516791878, 'support': 125439}, 'accuracy': 0.5053149192822421, 'macro avg': {'precision': 0.44256987172109347, 'recall': 0.39443151582069474, 'f1-score': 0.3843448154069223, 'support': 533216}, 'weighted avg': {'precision': 0.4728085546842439, 'recall': 0.5053149192822421, 'f1-score': 0.4591533425285178, 'support': 533216}}
[[ 35957  85470   5730]
 [ 46051 217950  16619]
 [ 15076  94828  15535]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0651543
{'0': {'precision': 0.43600406169914413, 'recall': 0.22812254914362334, 'f1-score': 0.29952830188679247, 'support': 158108}, '1': {'precision': 0.42636328610162516, 'recall': 0.8128364691497709, 'f1-score': 0.5593345650389212, 'support': 219188}, '2': {'precision': 0.47454250068969744, 'recall': 0.09928809645972293, 'f1-score': 0.1642171812265637, 'support': 155920}, 'accuracy': 0.430806652463542, 'macro avg': {'precision': 0.4456366161634889, 'recall': 0.3800823715843724, 'f1-score': 0.3410266827174258, 'support': 533216}, 'weighted avg': {'precision': 0.44331023984409496, 'recall': 0.430806652463542, 'f1-score': 0.3667594151212901, 'support': 533216}}
[[ 36068 115891   6149]
 [ 30031 178164  10993]
 [ 16625 123814  15481]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0995421
{'0': {'precision': 0.47338818388881143, 'recall': 0.1723103300471496, 'f1-score': 0.2526556045764471, 'support': 177308}, '1': {'precision': 0.349650080663591, 'recall': 0.854933831990794, 'f1-score': 0.496316911055048, 'support': 180752}, '2': {'precision': 0.5074107343364024, 'recall': 0.07739957523578982, 'f1-score': 0.13431150123344265, 'support': 175156}, 'accuracy': 0.3725319570305467, 'macro avg': {'precision': 0.4434829996296015, 'recall': 0.3682145790912445, 'f1-score': 0.2944280056216459, 'support': 533216}, 'weighted avg': {'precision': 0.4426189350516295, 'recall': 0.3725319570305467, 'f1-score': 0.29637820236697243, 'support': 533216}}
[[ 30552 140992   5764]
 [ 18824 154531   7397]
 [ 15163 146436  13557]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1038814
{'0': {'precision': 0.46517195340914325, 'recall': 0.11368712412307104, 'f1-score': 0.18271825961942736, 'support': 177751}, '1': {'precision': 0.3395805386990312, 'recall': 0.8949568750245507, 'f1-score': 0.4923462575615148, 'support': 178203}, '2': {'precision': 0.4926455972967601, 'recall': 0.05592851259717255, 'f1-score': 0.10045291965995562, 'support': 177262}, 'accuracy': 0.35558947968553084, 'macro avg': {'precision': 0.4324660298016449, 'recall': 0.35485750391493137, 'f1-score': 0.2585058122802993, 'support': 533216}, 'weighted avg': {'precision': 0.43233210274303535, 'recall': 0.35558947968553084, 'f1-score': 0.25884898230100095, 'support': 533216}}
[[ 20208 153212   4331]
 [ 12840 159484   5879]
 [ 10394 156954   9914]]
Evaluating performance on  val set...
685/685 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0070467
{'0': {'precision': 0.3589644637401512, 'recall': 0.2756798142705426, 'f1-score': 0.3118573983012964, 'support': 40489}, '1': {'precision': 0.5563632839003586, 'recall': 0.7941677309493401, 'f1-score': 0.6543289445416322, 'support': 93960}, '2': {'precision': 0.4312543938937431, 'recall': 0.1054415086926628, 'f1-score': 0.16945206290325765, 'support': 40724}, 'accuracy': 0.5142116650397036, 'macro avg': {'precision': 0.44886071384475096, 'recall': 0.3917630179708485, 'f1-score': 0.3785461352487287, 'support': 175173}, 'weighted avg': {'precision': 0.481651911336687, 'recall': 0.5142116650397036, 'f1-score': 0.46244745273886506, 'support': 175173}}
[[11162 27866  1461]
 [15138 74620  4202]
 [ 4795 31635  4294]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.06372
{'0': {'precision': 0.42253204407465705, 'recall': 0.22355297336955443, 'f1-score': 0.2924020593155499, 'support': 50431}, '1': {'precision': 0.43674414615318635, 'recall': 0.8256516275487454, 'f1-score': 0.5712923357408316, 'support': 74007}, '2': {'precision': 0.4926016544331819, 'recall': 0.08333497585493249, 'f1-score': 0.14255369365116827, 'support': 50735}, 'accuracy': 0.43731625307553107, 'macro avg': {'precision': 0.4506259482203418, 'recall': 0.3775131922577441, 'f1-score': 0.33541602956918326, 'support': 175173}, 'weighted avg': {'precision': 0.44883048458812363, 'recall': 0.43731625307553107, 'f1-score': 0.3668272039178769, 'support': 175173}}
[[11274 37645  1512]
 [10060 61104  2843]
 [ 5348 41159  4228]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0976579
{'0': {'precision': 0.4629146300953827, 'recall': 0.17158285402705223, 'f1-score': 0.25036573159150993, 'support': 56853}, '1': {'precision': 0.3606848299823897, 'recall': 0.863577905481303, 'f1-score': 0.5088441247002399, 'support': 61427}, '2': {'precision': 0.527394336132062, 'recall': 0.06513982387991493, 'f1-score': 0.11595744680851065, 'support': 56893}, 'accuracy': 0.3796703829928128, 'macro avg': {'precision': 0.4503312654032781, 'recall': 0.3667668611294234, 'f1-score': 0.29172243436675344, 'support': 175173}, 'weighted avg': {'precision': 0.4480080747700984, 'recall': 0.3796703829928128, 'f1-score': 0.29735163528289377, 'support': 175173}}
[[ 9755 45683  1415]
 [ 6474 53047  1906]
 [ 4844 48343  3706]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1023865
{'0': {'precision': 0.46299146495032883, 'recall': 0.11532630478348001, 'f1-score': 0.18465659398150086, 'support': 57385}, '1': {'precision': 0.3475329983163469, 'recall': 0.9033222535869982, 'f1-score': 0.5019514300432053, 'support': 59869}, '2': {'precision': 0.5069325735992403, 'recall': 0.04608159671265043, 'f1-score': 0.08448341352241075, 'support': 57919}, 'accuracy': 0.3617452461281134, 'macro avg': {'precision': 0.439152345621972, 'recall': 0.3549100516943762, 'f1-score': 0.25703047918237226, 'support': 175173}, 'weighted avg': {'precision': 0.4380597810317251, 'recall': 0.3617452461281134, 'f1-score': 0.25997752872126184, 'support': 175173}}
[[ 6618 49658  1109]
 [ 4301 54081  1487]
 [ 3375 51875  2669]]
training model: results/ATVI/W7/deepLOB_L2/seq2seq
Epoch 1/50
2083/2083 - 102s - loss: 12.2893 - accuracy10: 0.4656 - accuracy20: 0.4723 - accuracy30: 0.4684 - accuracy50: 0.4421 - val_loss: 12.3760 - val_accuracy10: 0.5440 - val_accuracy20: 0.5039 - val_accuracy30: 0.4704 - val_accuracy50: 0.4353 - 102s/epoch - 49ms/step
Epoch 2/50
2083/2083 - 96s - loss: 11.8918 - accuracy10: 0.5041 - accuracy20: 0.5077 - accuracy30: 0.5000 - accuracy50: 0.4633 - val_loss: 12.4622 - val_accuracy10: 0.5784 - val_accuracy20: 0.5083 - val_accuracy30: 0.4521 - val_accuracy50: 0.4171 - 96s/epoch - 46ms/step
Epoch 3/50
2083/2083 - 97s - loss: 11.6370 - accuracy10: 0.5395 - accuracy20: 0.5310 - accuracy30: 0.5154 - accuracy50: 0.4752 - val_loss: 12.0405 - val_accuracy10: 0.5984 - val_accuracy20: 0.5357 - val_accuracy30: 0.4834 - val_accuracy50: 0.4422 - 97s/epoch - 47ms/step
Epoch 4/50
2083/2083 - 97s - loss: 11.4379 - accuracy10: 0.5603 - accuracy20: 0.5464 - accuracy30: 0.5263 - accuracy50: 0.4827 - val_loss: 11.8931 - val_accuracy10: 0.6042 - val_accuracy20: 0.5458 - val_accuracy30: 0.4965 - val_accuracy50: 0.4528 - 97s/epoch - 46ms/step
Epoch 5/50
2083/2083 - 98s - loss: 11.3003 - accuracy10: 0.5685 - accuracy20: 0.5541 - accuracy30: 0.5336 - accuracy50: 0.4881 - val_loss: 12.0389 - val_accuracy10: 0.6057 - val_accuracy20: 0.5435 - val_accuracy30: 0.4918 - val_accuracy50: 0.4481 - 98s/epoch - 47ms/step
Epoch 6/50
2083/2083 - 97s - loss: 11.2252 - accuracy10: 0.5732 - accuracy20: 0.5585 - accuracy30: 0.5372 - accuracy50: 0.4911 - val_loss: 12.1242 - val_accuracy10: 0.6082 - val_accuracy20: 0.5435 - val_accuracy30: 0.4896 - val_accuracy50: 0.4448 - 97s/epoch - 46ms/step
Epoch 7/50
2083/2083 - 97s - loss: 11.1754 - accuracy10: 0.5756 - accuracy20: 0.5612 - accuracy30: 0.5396 - accuracy50: 0.4923 - val_loss: 12.0636 - val_accuracy10: 0.6096 - val_accuracy20: 0.5467 - val_accuracy30: 0.4931 - val_accuracy50: 0.4469 - 97s/epoch - 47ms/step
Epoch 8/50
2083/2083 - 98s - loss: 11.1347 - accuracy10: 0.5781 - accuracy20: 0.5637 - accuracy30: 0.5418 - accuracy50: 0.4944 - val_loss: 11.9673 - val_accuracy10: 0.6102 - val_accuracy20: 0.5514 - val_accuracy30: 0.5003 - val_accuracy50: 0.4532 - 98s/epoch - 47ms/step
Epoch 9/50
2083/2083 - 98s - loss: 11.1038 - accuracy10: 0.5796 - accuracy20: 0.5649 - accuracy30: 0.5428 - accuracy50: 0.4953 - val_loss: 12.0230 - val_accuracy10: 0.6079 - val_accuracy20: 0.5509 - val_accuracy30: 0.5010 - val_accuracy50: 0.4542 - 98s/epoch - 47ms/step
Epoch 10/50
2083/2083 - 97s - loss: 11.0760 - accuracy10: 0.5808 - accuracy20: 0.5671 - accuracy30: 0.5449 - accuracy50: 0.4965 - val_loss: 12.0886 - val_accuracy10: 0.6055 - val_accuracy20: 0.5471 - val_accuracy30: 0.4965 - val_accuracy50: 0.4496 - 97s/epoch - 47ms/step
Epoch 11/50
2083/2083 - 97s - loss: 11.0540 - accuracy10: 0.5820 - accuracy20: 0.5680 - accuracy30: 0.5464 - accuracy50: 0.4980 - val_loss: 12.1240 - val_accuracy10: 0.5945 - val_accuracy20: 0.5419 - val_accuracy30: 0.4946 - val_accuracy50: 0.4495 - 97s/epoch - 46ms/step
Epoch 12/50
2083/2083 - 97s - loss: 11.0322 - accuracy10: 0.5834 - accuracy20: 0.5692 - accuracy30: 0.5473 - accuracy50: 0.4994 - val_loss: 12.1465 - val_accuracy10: 0.5739 - val_accuracy20: 0.5307 - val_accuracy30: 0.4907 - val_accuracy50: 0.4484 - 97s/epoch - 47ms/step
Epoch 13/50
2083/2083 - 97s - loss: 11.0121 - accuracy10: 0.5840 - accuracy20: 0.5699 - accuracy30: 0.5485 - accuracy50: 0.5003 - val_loss: 12.0821 - val_accuracy10: 0.5803 - val_accuracy20: 0.5366 - val_accuracy30: 0.4950 - val_accuracy50: 0.4523 - 97s/epoch - 47ms/step
Epoch 14/50
2083/2083 - 96s - loss: 10.9939 - accuracy10: 0.5843 - accuracy20: 0.5710 - accuracy30: 0.5497 - accuracy50: 0.5018 - val_loss: 12.1238 - val_accuracy10: 0.5758 - val_accuracy20: 0.5334 - val_accuracy30: 0.4931 - val_accuracy50: 0.4498 - 96s/epoch - 46ms/step
testing model: results/ATVI/W7/deepLOB_L2/seq2seq
Evaluating performance on  test set...
6143/6143 - 96s - 96s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7754536
{'0': {'precision': 0.4754113139508677, 'recall': 0.4665944087543726, 'f1-score': 0.4709615994922247, 'support': 316459}, '1': {'precision': 0.722676331719017, 'recall': 0.8322909462191799, 'f1-score': 0.7736200966674396, 'support': 944147}, '2': {'precision': 0.5501495205032139, 'recall': 0.30790071049324136, 'f1-score': 0.39482869911646323, 'support': 311896}, 'accuracy': 0.6546866077117867, 'macro avg': {'precision': 0.5827457220576996, 'recall': 0.535595355155598, 'f1-score': 0.5464701317587092, 'support': 1572502}, 'weighted avg': {'precision': 0.6386957310146268, 'recall': 0.6546866077117867, 'f1-score': 0.637580506836628, 'support': 1572502}}
[[147658 142462  26339]
 [106156 785805  52186]
 [ 56776 159087  96033]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8741866
{'0': {'precision': 0.5306636778480506, 'recall': 0.4105292364557037, 'f1-score': 0.4629294402261667, 'support': 403657}, '1': {'precision': 0.6086821389919247, 'recall': 0.8523347538308097, 'f1-score': 0.7101915708812262, 'support': 772030}, '2': {'precision': 0.5987095117690071, 'recall': 0.27030984211786346, 'f1-score': 0.37245907787184096, 'support': 396815}, 'accuracy': 0.5920526651158472, 'macro avg': {'precision': 0.5793517762029942, 'recall': 0.5110579441347923, 'f1-score': 0.5151933629930779, 'support': 1572502}, 'weighted avg': {'precision': 0.5861384563502398, 'recall': 0.5920526651158472, 'f1-score': 0.5614945205198604, 'support': 1572502}}
[[165713 204211  33733]
 [ 75841 658028  38161]
 [ 70721 218831 107263]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9472975
{'0': {'precision': 0.5507158642282693, 'recall': 0.36599520248830364, 'f1-score': 0.4397445859657421, 'support': 462323}, '1': {'precision': 0.5213821489263523, 'recall': 0.8591883072760393, 'f1-score': 0.6489570220301814, 'support': 654903}, '2': {'precision': 0.608693081335032, 'recall': 0.24872165455679632, 'f1-score': 0.3531433365195249, 'support': 455276}, 'accuracy': 0.5374428776561174, 'macro avg': {'precision': 0.5602636981632179, 'recall': 0.4913017214403798, 'f1-score': 0.4806149815051495, 'support': 1572502}, 'weighted avg': {'precision': 0.5552849505271276, 'recall': 0.5374428776561174, 'f1-score': 0.5018026193247035, 'support': 1572502}}
[[169208 253030  40085]
 [ 59507 562685  32711]
 [ 78536 263503 113237]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0071301
{'0': {'precision': 0.5124441410129096, 'recall': 0.3120802832340082, 'f1-score': 0.3879174660350025, 'support': 476214}, '1': {'precision': 0.46911588559102074, 'recall': 0.8267141420965692, 'f1-score': 0.5985734681458597, 'support': 618706}, '2': {'precision': 0.5540457554436071, 'recall': 0.22291669284018242, 'f1-score': 0.31792024893465165, 'support': 477582}, 'accuracy': 0.48748491257880755, 'macro avg': {'precision': 0.5118685940158458, 'recall': 0.45390370605692, 'f1-score': 0.4348037277051713, 'support': 1572502}, 'weighted avg': {'precision': 0.5080312567202259, 'recall': 0.48748491257880755, 'f1-score': 0.44954201182558357, 'support': 1572502}}
[[148617 283397  44200]
 [ 65722 511493  41491]
 [ 75677 295444 106461]]
Evaluating performance on  train set...
2083/2083 - 33s - 33s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.86606866
{'0': {'precision': 0.4684871729053105, 'recall': 0.48997978585641644, 'f1-score': 0.47899250476653626, 'support': 126644}, '1': {'precision': 0.6976973936842399, 'recall': 0.7117100755649567, 'f1-score': 0.7046340758290497, 'support': 280818}, '2': {'precision': 0.4809500896723678, 'recall': 0.43715955628006836, 'f1-score': 0.4580104973756561, 'support': 125755}, 'accuracy': 0.594296505925355, 'macro avg': {'precision': 0.5490448854206393, 'recall': 0.5462831392338138, 'f1-score': 0.5472123593237473, 'support': 533217}, 'weighted avg': {'precision': 0.5921397006318059, 'recall': 0.594296505925355, 'f1-score': 0.5928778879467289, 'support': 533217}}
[[ 62053  43829  20762]
 [ 42389 199861  38568]
 [ 28012  42768  54975]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9312767
{'0': {'precision': 0.5169731205785489, 'recall': 0.4370120934243987, 'f1-score': 0.47364152473641524, 'support': 157689}, '1': {'precision': 0.5762878992097386, 'recall': 0.7410613697005632, 'f1-score': 0.6483697376376012, 'support': 219245}, '2': {'precision': 0.528630515484888, 'recall': 0.39909011216831003, 'f1-score': 0.4548162570323296, 'support': 156283}, 'accuracy': 0.5509145432347431, 'macro avg': {'precision': 0.5406305117577251, 'recall': 0.5257211917644239, 'f1-score': 0.5256091731354486, 'support': 533217}, 'weighted avg': {'precision': 0.5447785380523777, 'recall': 0.5509145432347431, 'f1-score': 0.5399676503567966, 'support': 533217}}
[[ 68912  61072  27705]
 [ 28861 162474  27910]
 [ 35526  58386  62371]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9798412
{'0': {'precision': 0.5354230179978025, 'recall': 0.3908573817068556, 'f1-score': 0.45185893815075895, 'support': 177039}, '1': {'precision': 0.48648340692209086, 'recall': 0.7557473171811041, 'f1-score': 0.5919327585459903, 'support': 180780}, '2': {'precision': 0.5410471093642144, 'recall': 0.3798446960626689, 'f1-score': 0.4463366349899678, 'support': 175398}, 'accuracy': 0.5109458250580908, 'macro avg': {'precision': 0.5209845114280359, 'recall': 0.5088164649835428, 'f1-score': 0.49670944389557237, 'support': 533217}, 'weighted avg': {'precision': 0.5206807113707046, 'recall': 0.5109458250580908, 'f1-score': 0.49753254630888866, 'support': 533217}}
[[ 69197  74268  33574]
 [ 21215 136624  22941]
 [ 38826  69948  66624]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0291582
{'0': {'precision': 0.49377310112883355, 'recall': 0.3338492798324956, 'f1-score': 0.39835992357055783, 'support': 177667}, '1': {'precision': 0.44159974751902376, 'recall': 0.7071319074384992, 'f1-score': 0.5436766201050389, 'support': 178087}, '2': {'precision': 0.49774473706839273, 'recall': 0.35879591802234834, 'f1-score': 0.4170001244326852, 'support': 177463}, 'accuracy': 0.46682307578340526, 'macro avg': {'precision': 0.47770586190541664, 'recall': 0.4665923684311144, 'f1-score': 0.45301222270276065, 'support': 533217}, 'weighted avg': {'precision': 0.47766975559489855, 'recall': 0.46682307578340526, 'f1-score': 0.45309741412568233, 'support': 533217}}
[[ 59314  81853  36500]
 [ 24406 125931  27750]
 [ 36404  77386  63673]]
Evaluating performance on  val set...
685/685 - 11s - 11s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8553817
{'0': {'precision': 0.4874380963884527, 'recall': 0.3979881160778126, 'f1-score': 0.4381947743467934, 'support': 40559}, '1': {'precision': 0.6773566212893993, 'recall': 0.785005793989135, 'f1-score': 0.7272190077557552, 'support': 94063}, '2': {'precision': 0.47958844000605233, 'recall': 0.390816502675643, 'f1-score': 0.43067558019457575, 'support': 40551}, 'accuracy': 0.6041456160481353, 'macro avg': {'precision': 0.5481277192279681, 'recall': 0.5246034709141968, 'f1-score': 0.5320297874323748, 'support': 175173}, 'weighted avg': {'precision': 0.5876019046910738, 'recall': 0.6041456160481353, 'f1-score': 0.591652074416328, 'support': 175173}}
[[16142 17694  6723]
 [ 9749 73840 10474]
 [ 7225 17478 15848]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9390447
{'0': {'precision': 0.5300666146552242, 'recall': 0.35044735850179537, 'f1-score': 0.4219363930588896, 'support': 50407}, '1': {'precision': 0.557929326779863, 'recall': 0.8078364244123356, 'f1-score': 0.6600189410624615, 'support': 74192}, '2': {'precision': 0.5237486564215786, 'recall': 0.3564875232332819, 'f1-score': 0.4242267374142617, 'support': 50574}, 'accuracy': 0.5459117558071164, 'macro avg': {'precision': 0.5372481992855552, 'recall': 0.5049237687158042, 'f1-score': 0.5020606905118709, 'support': 175173}, 'weighted avg': {'precision': 0.5400434142661391, 'recall': 0.5459117558071164, 'f1-score': 0.5234340683679246, 'support': 175173}}
[[17665 24056  8686]
 [ 6549 59935  7708]
 [ 9112 23433 18029]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9959981
{'0': {'precision': 0.544700288990398, 'recall': 0.30854396958389074, 'f1-score': 0.3939410964907352, 'support': 56812}, '1': {'precision': 0.4693827968041863, 'recall': 0.8159681611435997, 'f1-score': 0.5959483909239212, 'support': 61560}, '2': {'precision': 0.5322289240348, 'recall': 0.33710674107850214, 'f1-score': 0.41277026881372736, 'support': 56801}, 'accuracy': 0.4961266861902234, 'macro avg': {'precision': 0.5154373366097947, 'recall': 0.48720629060199744, 'f1-score': 0.4675532520761279, 'support': 175173}, 'weighted avg': {'precision': 0.5141879907490816, 'recall': 0.4961266861902234, 'f1-score': 0.471036795385115, 'support': 175173}}
[[17529 28966 10317]
 [ 4817 50231  6512]
 [ 9835 27818 19148]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0424719
{'0': {'precision': 0.49887360882283716, 'recall': 0.2586239955376597, 'f1-score': 0.34064975318562735, 'support': 57369}, '1': {'precision': 0.427331486611265, 'recall': 0.7722600453877987, 'f1-score': 0.5502056732529662, 'support': 59928}, '2': {'precision': 0.4877464181837768, 'recall': 0.3129276383993365, 'f1-score': 0.38125210508588747, 'support': 57876}, 'accuracy': 0.45228431322178647, 'macro avg': {'precision': 0.4713171712059596, 'recall': 0.44793722644159834, 'f1-score': 0.4240358438414937, 'support': 175173}, 'weighted avg': {'precision': 0.47072216090950947, 'recall': 0.45228431322178647, 'f1-score': 0.4257551569657472, 'support': 175173}}
[[14837 31533 10999]
 [ 5626 46280  8022]
 [ 9278 30487 18111]]
training model: results/ATVI/W7/deepOF_L2/seq2seq
Epoch 1/50
2083/2083 - 67s - loss: 11.9013 - accuracy10: 0.5213 - accuracy20: 0.5118 - accuracy30: 0.4951 - accuracy50: 0.4602 - val_loss: 12.1357 - val_accuracy10: 0.5920 - val_accuracy20: 0.5387 - val_accuracy30: 0.4940 - val_accuracy50: 0.4491 - 67s/epoch - 32ms/step
Epoch 2/50
2083/2083 - 60s - loss: 11.4020 - accuracy10: 0.5626 - accuracy20: 0.5479 - accuracy30: 0.5274 - accuracy50: 0.4843 - val_loss: 11.7058 - val_accuracy10: 0.6051 - val_accuracy20: 0.5498 - val_accuracy30: 0.5034 - val_accuracy50: 0.4575 - 60s/epoch - 29ms/step
Epoch 3/50
2083/2083 - 59s - loss: 11.3025 - accuracy10: 0.5692 - accuracy20: 0.5537 - accuracy30: 0.5325 - accuracy50: 0.4886 - val_loss: 11.6340 - val_accuracy10: 0.6088 - val_accuracy20: 0.5528 - val_accuracy30: 0.5051 - val_accuracy50: 0.4590 - 59s/epoch - 28ms/step
Epoch 4/50
2083/2083 - 60s - loss: 11.2449 - accuracy10: 0.5727 - accuracy20: 0.5571 - accuracy30: 0.5354 - accuracy50: 0.4908 - val_loss: 11.6051 - val_accuracy10: 0.6116 - val_accuracy20: 0.5550 - val_accuracy30: 0.5072 - val_accuracy50: 0.4600 - 60s/epoch - 29ms/step
Epoch 5/50
2083/2083 - 59s - loss: 11.2016 - accuracy10: 0.5757 - accuracy20: 0.5599 - accuracy30: 0.5378 - accuracy50: 0.4930 - val_loss: 11.5386 - val_accuracy10: 0.6092 - val_accuracy20: 0.5565 - val_accuracy30: 0.5110 - val_accuracy50: 0.4630 - 59s/epoch - 28ms/step
Epoch 6/50
2083/2083 - 59s - loss: 11.1658 - accuracy10: 0.5769 - accuracy20: 0.5614 - accuracy30: 0.5400 - accuracy50: 0.4946 - val_loss: 11.5797 - val_accuracy10: 0.6107 - val_accuracy20: 0.5573 - val_accuracy30: 0.5097 - val_accuracy50: 0.4604 - 59s/epoch - 28ms/step
Epoch 7/50
2083/2083 - 59s - loss: 11.1359 - accuracy10: 0.5782 - accuracy20: 0.5625 - accuracy30: 0.5411 - accuracy50: 0.4956 - val_loss: 11.5781 - val_accuracy10: 0.6120 - val_accuracy20: 0.5589 - val_accuracy30: 0.5105 - val_accuracy50: 0.4609 - 59s/epoch - 28ms/step
Epoch 8/50
2083/2083 - 60s - loss: 11.1082 - accuracy10: 0.5803 - accuracy20: 0.5646 - accuracy30: 0.5429 - accuracy50: 0.4972 - val_loss: 11.5471 - val_accuracy10: 0.6086 - val_accuracy20: 0.5590 - val_accuracy30: 0.5131 - val_accuracy50: 0.4634 - 60s/epoch - 29ms/step
Epoch 9/50
2083/2083 - 59s - loss: 11.0843 - accuracy10: 0.5806 - accuracy20: 0.5658 - accuracy30: 0.5443 - accuracy50: 0.4984 - val_loss: 11.5687 - val_accuracy10: 0.6107 - val_accuracy20: 0.5596 - val_accuracy30: 0.5137 - val_accuracy50: 0.4642 - 59s/epoch - 28ms/step
Epoch 10/50
2083/2083 - 60s - loss: 11.0624 - accuracy10: 0.5819 - accuracy20: 0.5671 - accuracy30: 0.5460 - accuracy50: 0.4999 - val_loss: 11.5124 - val_accuracy10: 0.6098 - val_accuracy20: 0.5611 - val_accuracy30: 0.5164 - val_accuracy50: 0.4664 - 60s/epoch - 29ms/step
Epoch 11/50
2083/2083 - 61s - loss: 11.0411 - accuracy10: 0.5825 - accuracy20: 0.5681 - accuracy30: 0.5469 - accuracy50: 0.5001 - val_loss: 11.5403 - val_accuracy10: 0.6085 - val_accuracy20: 0.5594 - val_accuracy30: 0.5153 - val_accuracy50: 0.4651 - 61s/epoch - 29ms/step
Epoch 12/50
2083/2083 - 61s - loss: 11.0229 - accuracy10: 0.5835 - accuracy20: 0.5684 - accuracy30: 0.5479 - accuracy50: 0.5016 - val_loss: 11.4542 - val_accuracy10: 0.6060 - val_accuracy20: 0.5616 - val_accuracy30: 0.5212 - val_accuracy50: 0.4721 - 61s/epoch - 29ms/step
Epoch 13/50
2083/2083 - 59s - loss: 11.0041 - accuracy10: 0.5851 - accuracy20: 0.5703 - accuracy30: 0.5488 - accuracy50: 0.5027 - val_loss: 11.4462 - val_accuracy10: 0.6066 - val_accuracy20: 0.5621 - val_accuracy30: 0.5209 - val_accuracy50: 0.4705 - 59s/epoch - 28ms/step
Epoch 14/50
2083/2083 - 61s - loss: 10.9861 - accuracy10: 0.5852 - accuracy20: 0.5712 - accuracy30: 0.5500 - accuracy50: 0.5039 - val_loss: 11.4518 - val_accuracy10: 0.6047 - val_accuracy20: 0.5624 - val_accuracy30: 0.5225 - val_accuracy50: 0.4734 - 61s/epoch - 29ms/step
Epoch 15/50
2083/2083 - 60s - loss: 10.9682 - accuracy10: 0.5857 - accuracy20: 0.5720 - accuracy30: 0.5516 - accuracy50: 0.5057 - val_loss: 11.4775 - val_accuracy10: 0.6079 - val_accuracy20: 0.5628 - val_accuracy30: 0.5210 - val_accuracy50: 0.4727 - 60s/epoch - 29ms/step
Epoch 16/50
2083/2083 - 59s - loss: 10.9518 - accuracy10: 0.5866 - accuracy20: 0.5730 - accuracy30: 0.5519 - accuracy50: 0.5065 - val_loss: 11.4819 - val_accuracy10: 0.6041 - val_accuracy20: 0.5607 - val_accuracy30: 0.5209 - val_accuracy50: 0.4728 - 59s/epoch - 28ms/step
Epoch 17/50
2083/2083 - 62s - loss: 10.9325 - accuracy10: 0.5872 - accuracy20: 0.5741 - accuracy30: 0.5533 - accuracy50: 0.5070 - val_loss: 11.5792 - val_accuracy10: 0.6067 - val_accuracy20: 0.5615 - val_accuracy30: 0.5187 - val_accuracy50: 0.4705 - 62s/epoch - 30ms/step
Epoch 18/50
2083/2083 - 60s - loss: 10.9198 - accuracy10: 0.5878 - accuracy20: 0.5750 - accuracy30: 0.5544 - accuracy50: 0.5078 - val_loss: 11.5684 - val_accuracy10: 0.6040 - val_accuracy20: 0.5613 - val_accuracy30: 0.5201 - val_accuracy50: 0.4723 - 60s/epoch - 29ms/step
Epoch 19/50
2083/2083 - 60s - loss: 10.9038 - accuracy10: 0.5882 - accuracy20: 0.5757 - accuracy30: 0.5552 - accuracy50: 0.5090 - val_loss: 11.5736 - val_accuracy10: 0.6045 - val_accuracy20: 0.5621 - val_accuracy30: 0.5211 - val_accuracy50: 0.4726 - 60s/epoch - 29ms/step
Epoch 20/50
2083/2083 - 59s - loss: 10.8889 - accuracy10: 0.5882 - accuracy20: 0.5761 - accuracy30: 0.5557 - accuracy50: 0.5101 - val_loss: 11.4933 - val_accuracy10: 0.6010 - val_accuracy20: 0.5620 - val_accuracy30: 0.5232 - val_accuracy50: 0.4745 - 59s/epoch - 28ms/step
Epoch 21/50
2083/2083 - 61s - loss: 10.8733 - accuracy10: 0.5897 - accuracy20: 0.5773 - accuracy30: 0.5569 - accuracy50: 0.5109 - val_loss: 11.6025 - val_accuracy10: 0.6001 - val_accuracy20: 0.5590 - val_accuracy30: 0.5201 - val_accuracy50: 0.4729 - 61s/epoch - 29ms/step
Epoch 22/50
2083/2083 - 58s - loss: 10.8576 - accuracy10: 0.5902 - accuracy20: 0.5784 - accuracy30: 0.5584 - accuracy50: 0.5122 - val_loss: 11.5540 - val_accuracy10: 0.6021 - val_accuracy20: 0.5596 - val_accuracy30: 0.5219 - val_accuracy50: 0.4752 - 58s/epoch - 28ms/step
Epoch 23/50
2083/2083 - 59s - loss: 10.8426 - accuracy10: 0.5900 - accuracy20: 0.5786 - accuracy30: 0.5596 - accuracy50: 0.5137 - val_loss: 11.6170 - val_accuracy10: 0.5918 - val_accuracy20: 0.5561 - val_accuracy30: 0.5220 - val_accuracy50: 0.4754 - 59s/epoch - 28ms/step
testing model: results/ATVI/W7/deepOF_L2/seq2seq
Evaluating performance on  test set...
6143/6143 - 73s - 73s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7682589
{'0': {'precision': 0.46850409523120573, 'recall': 0.5525679634199907, 'f1-score': 0.5070755811255974, 'support': 316457}, '1': {'precision': 0.7603259756156568, 'recall': 0.7822423650579465, 'f1-score': 0.7711284793007805, 'support': 944146}, '2': {'precision': 0.548581157277191, 'recall': 0.40084131147120494, 'f1-score': 0.4632163189086146, 'support': 311894}, 'accuracy': 0.6603732789315337, 'macro avg': {'precision': 0.5924704093746845, 'recall': 0.5785505466497142, 'f1-score': 0.5804734597783309, 'support': 1572497}, 'weighted avg': {'precision': 0.6596001776194256, 'recall': 0.6603732789315337, 'f1-score': 0.6569169142859168, 'support': 1572497}}
[[174864 106706  34887]
 [137605 738551  67990]
 [ 60770 126104 125020]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8421749
{'0': {'precision': 0.5299183306037896, 'recall': 0.484167133237872, 'f1-score': 0.5060106827814587, 'support': 403654}, '1': {'precision': 0.6457227767000732, 'recall': 0.8088584640493245, 'f1-score': 0.7181425399026856, 'support': 772030}, '2': {'precision': 0.5927596072978696, 'recall': 0.3534586820492272, 'f1-score': 0.44284924932510306, 'support': 396813}, 'accuracy': 0.6105932157581223, 'macro avg': {'precision': 0.5894669048672442, 'recall': 0.5488280931121412, 'f1-score': 0.5556674906697491, 'support': 1572497}, 'weighted avg': {'precision': 0.6026311828690224, 'recall': 0.6105932157581223, 'f1-score': 0.5942199955872599, 'support': 1572497}}
[[195436 161734  46484]
 [ 97691 624463  49876]
 [ 75677 180879 140257]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9059661
{'0': {'precision': 0.552459369553114, 'recall': 0.42711942861839686, 'f1-score': 0.4817705950738459, 'support': 462318}, '1': {'precision': 0.5533959962365321, 'recall': 0.823569291940944, 'f1-score': 0.6619773972468236, 'support': 654903}, '2': {'precision': 0.6026327281801734, 'recall': 0.31825530008170866, 'f1-score': 0.4165350267567998, 'support': 455276}, 'accuracy': 0.5607114035829639, 'macro avg': {'precision': 0.5694960313232732, 'recall': 0.5229813402136831, 'f1-score': 0.5200943396924897, 'support': 1572497}, 'weighted avg': {'precision': 0.5673758531121565, 'recall': 0.5607114035829639, 'f1-score': 0.5379346365711448, 'support': 1572497}}
[[197465 209761  55092]
 [ 75096 539358  40449]
 [ 84868 225514 144894]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.982007
{'0': {'precision': 0.5122960334799769, 'recall': 0.36142038176434765, 'f1-score': 0.42383140517033335, 'support': 476210}, '1': {'precision': 0.4899100013937837, 'recall': 0.795361609552841, 'f1-score': 0.6063397089391965, 'support': 618706}, '2': {'precision': 0.5522568135301088, 'recall': 0.2683628536311118, 'f1-score': 0.361203174495812, 'support': 477581}, 'accuracy': 0.5038941250762322, 'macro avg': {'precision': 0.5181542828012898, 'recall': 0.47504828164943347, 'f1-score': 0.463791429535114, 'support': 1572497}, 'weighted avg': {'precision': 0.5156245847771824, 'recall': 0.5038941250762322, 'f1-score': 0.47661937841152213, 'support': 1572497}}
[[172112 248207  55891]
 [ 78592 492095  48019]
 [ 85258 264158 128165]]
Evaluating performance on  train set...
2083/2083 - 21s - 21s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.84998506
{'0': {'precision': 0.4750848402662573, 'recall': 0.5427699615436036, 'f1-score': 0.506676944536211, 'support': 127157}, '1': {'precision': 0.7053059645025205, 'recall': 0.7274463687548999, 'f1-score': 0.7162050981582284, 'support': 280620}, '2': {'precision': 0.5211239011714071, 'recall': 0.4092666555058634, 'f1-score': 0.45847119708153045, 'support': 125439}, 'accuracy': 0.6085545069915381, 'macro avg': {'precision': 0.5671715686467284, 'recall': 0.559827661934789, 'f1-score': 0.5604510799253233, 'support': 533216}, 'weighted avg': {'precision': 0.6070759013823177, 'recall': 0.6085545069915381, 'f1-score': 0.605606664789247, 'support': 533216}}
[[ 69017  39858  18282]
 [ 47590 204136  28894]
 [ 28666  45435  51338]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.91140467
{'0': {'precision': 0.5265341054186308, 'recall': 0.48251195385432744, 'f1-score': 0.5035627415452958, 'support': 158108}, '1': {'precision': 0.5824482167340512, 'recall': 0.7578060842746865, 'f1-score': 0.6586553045698865, 'support': 219188}, '2': {'precision': 0.5591480203203164, 'recall': 0.36990123140071834, 'f1-score': 0.44524989578025853, 'support': 155920}, 'accuracy': 0.5627475544619817, 'macro avg': {'precision': 0.5560434474909995, 'recall': 0.5367397565099108, 'f1-score': 0.5358226472984803, 'support': 533216}, 'weighted avg': {'precision': 0.5590553798036365, 'recall': 0.5627475544619817, 'f1-score': 0.5502648093612454, 'support': 533216}}
[[ 76289  56918  24901]
 [ 32514 166102  20572]
 [ 36086  62159  57675]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9562306
{'0': {'precision': 0.5447050866763963, 'recall': 0.4315202923725946, 'f1-score': 0.4815512960509546, 'support': 177308}, '1': {'precision': 0.4893724344256592, 'recall': 0.7782763122952996, 'f1-score': 0.6009030097477212, 'support': 180752}, '2': {'precision': 0.5701531944800601, 'recall': 0.3427344766950604, 'f1-score': 0.4281165425196205, 'support': 175156}, 'accuracy': 0.5199000030006602, 'macro avg': {'precision': 0.5347435718607052, 'recall': 0.5175103604543182, 'f1-score': 0.5035236161060987, 'support': 533216}, 'weighted avg': {'precision': 0.5343076140027205, 'recall': 0.5199000030006602, 'f1-score': 0.5044569164085274, 'support': 533216}}
[[ 76512  71539  29257]
 [ 24075 140675  16002]
 [ 39878  75246  60032]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0164495
{'0': {'precision': 0.5001315265345389, 'recall': 0.3743663889373337, 'f1-score': 0.428205557200036, 'support': 177751}, '1': {'precision': 0.43902145658899705, 'recall': 0.7373613238834363, 'f1-score': 0.550360729207024, 'support': 178203}, '2': {'precision': 0.5247518862593074, 'recall': 0.29858063205876045, 'f1-score': 0.3806013885942551, 'support': 177262}, 'accuracy': 0.470486632059053, 'macro avg': {'precision': 0.48796828979428114, 'recall': 0.4701027816265102, 'f1-score': 0.453055891667105, 'support': 533216}, 'weighted avg': {'precision': 0.4878930648436416, 'recall': 0.470486632059053, 'f1-score': 0.4532048220040991, 'support': 533216}}
[[ 66544  82673  28534]
 [ 27403 131400  19400]
 [ 39106  85229  52927]]
Evaluating performance on  val set...
685/685 - 7s - 7s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.85638285
{'0': {'precision': 0.458832950065703, 'recall': 0.5519276840623379, 'f1-score': 0.5010931351114998, 'support': 40489}, '1': {'precision': 0.7160096199688516, 'recall': 0.7192635163899531, 'f1-score': 0.7176328797379304, 'support': 93960}, '2': {'precision': 0.5091328470793591, 'recall': 0.4010902661821039, 'f1-score': 0.4486992830261242, 'support': 40724}, 'accuracy': 0.6066174581699234, 'macro avg': {'precision': 0.5613251390379713, 'recall': 0.5574271555447984, 'f1-score': 0.5558084326251849, 'support': 175173}, 'weighted avg': {'precision': 0.6084720663112658, 'recall': 0.6066174581699234, 'f1-score': 0.6050611391576404, 'support': 175173}}
[[22347 12077  6065]
 [16695 67582  9683]
 [ 9662 14728 16334]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9148319
{'0': {'precision': 0.5112061308380327, 'recall': 0.49072990819139023, 'f1-score': 0.5007587867505716, 'support': 50431}, '1': {'precision': 0.5956139125576198, 'recall': 0.7490102287621441, 'f1-score': 0.6635622538515866, 'support': 74007}, '2': {'precision': 0.5478557649502893, 'recall': 0.3638513846457081, 'f1-score': 0.43728532512140234, 'support': 50735}, 'accuracy': 0.5631004778133617, 'macro avg': {'precision': 0.5515586027819805, 'recall': 0.5345305071997475, 'f1-score': 0.5338687885745202, 'support': 175173}, 'weighted avg': {'precision': 0.5574814466024874, 'recall': 0.5631004778133617, 'f1-score': 0.5511562230791663, 'support': 175173}}
[[24748 17451  8232]
 [11572 55432  7003]
 [12091 20184 18460]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9569684
{'0': {'precision': 0.5330594346049047, 'recall': 0.4404516912036304, 'f1-score': 0.4823507883154032, 'support': 56853}, '1': {'precision': 0.5032888073942198, 'recall': 0.7685545444185782, 'f1-score': 0.6082587128776653, 'support': 61427}, '2': {'precision': 0.5571611327557132, 'recall': 0.33682526848645705, 'f1-score': 0.4198407221181548, 'support': 56893}, 'accuracy': 0.5218498284552985, 'macro avg': {'precision': 0.5311697915849459, 'recall': 0.5152771680362219, 'f1-score': 0.5034834077704078, 'support': 175173}, 'weighted avg': {'precision': 0.5304477170184227, 'recall': 0.5218498284552985, 'f1-score': 0.5062001308848975, 'support': 175173}}
[[25041 22147  9665]
 [ 8651 47210  5566]
 [13284 24446 19163]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0166459
{'0': {'precision': 0.4905055487053021, 'recall': 0.38126688158926547, 'f1-score': 0.4290420629473478, 'support': 57385}, '1': {'precision': 0.44932941260847736, 'recall': 0.7325159932519334, 'f1-score': 0.5569949831713977, 'support': 59869}, '2': {'precision': 0.5129978463311796, 'recall': 0.29199399160897116, 'f1-score': 0.37215852826617957, 'support': 57919}, 'accuracy': 0.47179645264966635, 'macro avg': {'precision': 0.48427760254831975, 'recall': 0.4685922888167233, 'f1-score': 0.4527318581283084, 'support': 175173}, 'weighted avg': {'precision': 0.48386957908790906, 'recall': 0.47179645264966635, 'f1-score': 0.45396471618554696, 'support': 175173}}
[[21879 26002  9504]
 [ 9463 43855  6551]
 [13263 27744 16912]]
training model: results/ATVI/W7/deepVOL_L2/seq2seq
Epoch 1/50
2083/2083 - 66s - loss: 12.1147 - accuracy10: 0.4895 - accuracy20: 0.4904 - accuracy30: 0.4805 - accuracy50: 0.4493 - val_loss: 12.7466 - val_accuracy10: 0.5808 - val_accuracy20: 0.5194 - val_accuracy30: 0.4693 - val_accuracy50: 0.4344 - 66s/epoch - 32ms/step
Epoch 2/50
2083/2083 - 58s - loss: 11.6845 - accuracy10: 0.5362 - accuracy20: 0.5284 - accuracy30: 0.5114 - accuracy50: 0.4734 - val_loss: 12.5384 - val_accuracy10: 0.5800 - val_accuracy20: 0.5233 - val_accuracy30: 0.4745 - val_accuracy50: 0.4384 - 58s/epoch - 28ms/step
Epoch 3/50
2083/2083 - 58s - loss: 11.5079 - accuracy10: 0.5544 - accuracy20: 0.5416 - accuracy30: 0.5219 - accuracy50: 0.4807 - val_loss: 12.8266 - val_accuracy10: 0.5793 - val_accuracy20: 0.5193 - val_accuracy30: 0.4695 - val_accuracy50: 0.4350 - 58s/epoch - 28ms/step
Epoch 4/50
2083/2083 - 57s - loss: 11.4087 - accuracy10: 0.5629 - accuracy20: 0.5484 - accuracy30: 0.5272 - accuracy50: 0.4842 - val_loss: 12.6192 - val_accuracy10: 0.5884 - val_accuracy20: 0.5305 - val_accuracy30: 0.4812 - val_accuracy50: 0.4432 - 57s/epoch - 27ms/step
Epoch 5/50
2083/2083 - 59s - loss: 11.3344 - accuracy10: 0.5677 - accuracy20: 0.5529 - accuracy30: 0.5310 - accuracy50: 0.4870 - val_loss: 12.6444 - val_accuracy10: 0.5847 - val_accuracy20: 0.5298 - val_accuracy30: 0.4822 - val_accuracy50: 0.4433 - 59s/epoch - 28ms/step
Epoch 6/50
2083/2083 - 57s - loss: 11.2829 - accuracy10: 0.5712 - accuracy20: 0.5565 - accuracy30: 0.5340 - accuracy50: 0.4885 - val_loss: 12.5073 - val_accuracy10: 0.5986 - val_accuracy20: 0.5396 - val_accuracy30: 0.4884 - val_accuracy50: 0.4473 - 57s/epoch - 27ms/step
Epoch 7/50
2083/2083 - 57s - loss: 11.2444 - accuracy10: 0.5737 - accuracy20: 0.5590 - accuracy30: 0.5366 - accuracy50: 0.4908 - val_loss: 12.4416 - val_accuracy10: 0.6034 - val_accuracy20: 0.5452 - val_accuracy30: 0.4930 - val_accuracy50: 0.4509 - 57s/epoch - 27ms/step
Epoch 8/50
2083/2083 - 57s - loss: 11.2125 - accuracy10: 0.5764 - accuracy20: 0.5608 - accuracy30: 0.5379 - accuracy50: 0.4918 - val_loss: 12.4215 - val_accuracy10: 0.6044 - val_accuracy20: 0.5444 - val_accuracy30: 0.4914 - val_accuracy50: 0.4494 - 57s/epoch - 27ms/step
Epoch 9/50
2083/2083 - 58s - loss: 11.1837 - accuracy10: 0.5781 - accuracy20: 0.5627 - accuracy30: 0.5394 - accuracy50: 0.4930 - val_loss: 12.4449 - val_accuracy10: 0.6058 - val_accuracy20: 0.5468 - val_accuracy30: 0.4925 - val_accuracy50: 0.4506 - 58s/epoch - 28ms/step
Epoch 10/50
2083/2083 - 59s - loss: 11.1597 - accuracy10: 0.5788 - accuracy20: 0.5630 - accuracy30: 0.5405 - accuracy50: 0.4943 - val_loss: 12.4153 - val_accuracy10: 0.6071 - val_accuracy20: 0.5461 - val_accuracy30: 0.4919 - val_accuracy50: 0.4499 - 59s/epoch - 28ms/step
Epoch 11/50
2083/2083 - 57s - loss: 11.1361 - accuracy10: 0.5805 - accuracy20: 0.5652 - accuracy30: 0.5419 - accuracy50: 0.4953 - val_loss: 12.3067 - val_accuracy10: 0.6086 - val_accuracy20: 0.5491 - val_accuracy30: 0.4950 - val_accuracy50: 0.4529 - 57s/epoch - 27ms/step
Epoch 12/50
2083/2083 - 59s - loss: 11.1158 - accuracy10: 0.5811 - accuracy20: 0.5659 - accuracy30: 0.5428 - accuracy50: 0.4967 - val_loss: 12.3802 - val_accuracy10: 0.6092 - val_accuracy20: 0.5485 - val_accuracy30: 0.4938 - val_accuracy50: 0.4512 - 59s/epoch - 28ms/step
Epoch 13/50
2083/2083 - 58s - loss: 11.0980 - accuracy10: 0.5829 - accuracy20: 0.5673 - accuracy30: 0.5441 - accuracy50: 0.4969 - val_loss: 12.3292 - val_accuracy10: 0.6107 - val_accuracy20: 0.5501 - val_accuracy30: 0.4955 - val_accuracy50: 0.4519 - 58s/epoch - 28ms/step
Epoch 14/50
2083/2083 - 57s - loss: 11.0783 - accuracy10: 0.5833 - accuracy20: 0.5684 - accuracy30: 0.5455 - accuracy50: 0.4986 - val_loss: 12.3114 - val_accuracy10: 0.6124 - val_accuracy20: 0.5511 - val_accuracy30: 0.4968 - val_accuracy50: 0.4527 - 57s/epoch - 27ms/step
Epoch 15/50
2083/2083 - 58s - loss: 11.0595 - accuracy10: 0.5842 - accuracy20: 0.5698 - accuracy30: 0.5464 - accuracy50: 0.4994 - val_loss: 12.2328 - val_accuracy10: 0.6126 - val_accuracy20: 0.5534 - val_accuracy30: 0.4994 - val_accuracy50: 0.4553 - 58s/epoch - 28ms/step
Epoch 16/50
2083/2083 - 57s - loss: 11.0433 - accuracy10: 0.5849 - accuracy20: 0.5702 - accuracy30: 0.5475 - accuracy50: 0.4999 - val_loss: 12.2856 - val_accuracy10: 0.6134 - val_accuracy20: 0.5528 - val_accuracy30: 0.4984 - val_accuracy50: 0.4541 - 57s/epoch - 28ms/step
Epoch 17/50
2083/2083 - 58s - loss: 11.0291 - accuracy10: 0.5853 - accuracy20: 0.5710 - accuracy30: 0.5483 - accuracy50: 0.5009 - val_loss: 12.2399 - val_accuracy10: 0.6139 - val_accuracy20: 0.5553 - val_accuracy30: 0.5010 - val_accuracy50: 0.4546 - 58s/epoch - 28ms/step
Epoch 18/50
2083/2083 - 57s - loss: 11.0153 - accuracy10: 0.5857 - accuracy20: 0.5713 - accuracy30: 0.5486 - accuracy50: 0.5010 - val_loss: 12.3095 - val_accuracy10: 0.6134 - val_accuracy20: 0.5554 - val_accuracy30: 0.5001 - val_accuracy50: 0.4549 - 57s/epoch - 27ms/step
Epoch 19/50
2083/2083 - 58s - loss: 10.9984 - accuracy10: 0.5866 - accuracy20: 0.5721 - accuracy30: 0.5495 - accuracy50: 0.5020 - val_loss: 12.2609 - val_accuracy10: 0.6129 - val_accuracy20: 0.5550 - val_accuracy30: 0.5009 - val_accuracy50: 0.4560 - 58s/epoch - 28ms/step
Epoch 20/50
2083/2083 - 58s - loss: 10.9874 - accuracy10: 0.5868 - accuracy20: 0.5724 - accuracy30: 0.5499 - accuracy50: 0.5024 - val_loss: 12.2128 - val_accuracy10: 0.6132 - val_accuracy20: 0.5561 - val_accuracy30: 0.5020 - val_accuracy50: 0.4558 - 58s/epoch - 28ms/step
Epoch 21/50
2083/2083 - 60s - loss: 10.9749 - accuracy10: 0.5882 - accuracy20: 0.5736 - accuracy30: 0.5504 - accuracy50: 0.5032 - val_loss: 12.2148 - val_accuracy10: 0.6142 - val_accuracy20: 0.5568 - val_accuracy30: 0.5013 - val_accuracy50: 0.4556 - 60s/epoch - 29ms/step
Epoch 22/50
2083/2083 - 59s - loss: 10.9638 - accuracy10: 0.5881 - accuracy20: 0.5740 - accuracy30: 0.5513 - accuracy50: 0.5039 - val_loss: 12.2318 - val_accuracy10: 0.6147 - val_accuracy20: 0.5581 - val_accuracy30: 0.5035 - val_accuracy50: 0.4569 - 59s/epoch - 28ms/step
Epoch 23/50
2083/2083 - 57s - loss: 10.9506 - accuracy10: 0.5886 - accuracy20: 0.5753 - accuracy30: 0.5526 - accuracy50: 0.5050 - val_loss: 12.2952 - val_accuracy10: 0.6143 - val_accuracy20: 0.5576 - val_accuracy30: 0.5033 - val_accuracy50: 0.4575 - 57s/epoch - 28ms/step
Epoch 24/50
2083/2083 - 59s - loss: 10.9407 - accuracy10: 0.5891 - accuracy20: 0.5757 - accuracy30: 0.5528 - accuracy50: 0.5052 - val_loss: 12.2418 - val_accuracy10: 0.6161 - val_accuracy20: 0.5595 - val_accuracy30: 0.5060 - val_accuracy50: 0.4591 - 59s/epoch - 29ms/step
Epoch 25/50
2083/2083 - 58s - loss: 10.9270 - accuracy10: 0.5894 - accuracy20: 0.5761 - accuracy30: 0.5541 - accuracy50: 0.5063 - val_loss: 12.3243 - val_accuracy10: 0.6151 - val_accuracy20: 0.5580 - val_accuracy30: 0.5053 - val_accuracy50: 0.4593 - 58s/epoch - 28ms/step
Epoch 26/50
2083/2083 - 59s - loss: 10.9128 - accuracy10: 0.5903 - accuracy20: 0.5773 - accuracy30: 0.5545 - accuracy50: 0.5066 - val_loss: 12.2778 - val_accuracy10: 0.6151 - val_accuracy20: 0.5616 - val_accuracy30: 0.5093 - val_accuracy50: 0.4608 - 59s/epoch - 28ms/step
Epoch 27/50
2083/2083 - 60s - loss: 10.9036 - accuracy10: 0.5904 - accuracy20: 0.5778 - accuracy30: 0.5551 - accuracy50: 0.5072 - val_loss: 12.2706 - val_accuracy10: 0.6159 - val_accuracy20: 0.5603 - val_accuracy30: 0.5069 - val_accuracy50: 0.4598 - 60s/epoch - 29ms/step
Epoch 28/50
2083/2083 - 57s - loss: 10.8962 - accuracy10: 0.5913 - accuracy20: 0.5783 - accuracy30: 0.5560 - accuracy50: 0.5084 - val_loss: 12.2767 - val_accuracy10: 0.6166 - val_accuracy20: 0.5616 - val_accuracy30: 0.5086 - val_accuracy50: 0.4606 - 57s/epoch - 28ms/step
Epoch 29/50
2083/2083 - 58s - loss: 10.8831 - accuracy10: 0.5921 - accuracy20: 0.5787 - accuracy30: 0.5566 - accuracy50: 0.5090 - val_loss: 12.3560 - val_accuracy10: 0.6152 - val_accuracy20: 0.5603 - val_accuracy30: 0.5089 - val_accuracy50: 0.4612 - 58s/epoch - 28ms/step
Epoch 30/50
2083/2083 - 58s - loss: 10.8737 - accuracy10: 0.5922 - accuracy20: 0.5795 - accuracy30: 0.5581 - accuracy50: 0.5099 - val_loss: 12.3371 - val_accuracy10: 0.6149 - val_accuracy20: 0.5621 - val_accuracy30: 0.5103 - val_accuracy50: 0.4629 - 58s/epoch - 28ms/step
testing model: results/ATVI/W7/deepVOL_L2/seq2seq
Evaluating performance on  test set...
6143/6143 - 57s - 57s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7628409
{'0': {'precision': 0.5095151772576265, 'recall': 0.42454472775304225, 'f1-score': 0.4631651161868712, 'support': 316459}, '1': {'precision': 0.7444851805318119, 'recall': 0.8422427863457703, 'f1-score': 0.7903525820851983, 'support': 944147}, '2': {'precision': 0.5334280586299731, 'recall': 0.41165644958575937, 'f1-score': 0.46469728117670905, 'support': 311896}, 'accuracy': 0.672778794557972, 'macro avg': {'precision': 0.5958094721398038, 'recall': 0.5594813212281906, 'f1-score': 0.5727383264829262, 'support': 1572502}, 'weighted avg': {'precision': 0.6553366488550056, 'recall': 0.672778794557972, 'f1-score': 0.6599158614941448, 'support': 1572502}}
[[134351 140595  41513]
 [ 78157 795201  70789]
 [ 51176 132326 128394]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8736925
{'0': {'precision': 0.5665631636590603, 'recall': 0.35755108916728806, 'f1-score': 0.43842041312272173, 'support': 403657}, '1': {'precision': 0.6254578957270444, 'recall': 0.8784490240016579, 'f1-score': 0.7306740475064347, 'support': 772030}, '2': {'precision': 0.5892885444911352, 'recall': 0.3466854831596588, 'f1-score': 0.43654583937575564, 'support': 396815}, 'accuracy': 0.6105473951702446, 'macro avg': {'precision': 0.59376986795908, 'recall': 0.5275618654428683, 'f1-score': 0.5352134333349707, 'support': 1572502}, 'weighted avg': {'precision': 0.6012125771372788, 'recall': 0.6105473951702446, 'f1-score': 0.5814311783693514, 'support': 1572502}}
[[144328 208282  51047]
 [ 49007 678189  44834]
 [ 61408 197837 137570]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9549106
{'0': {'precision': 0.5789184637352177, 'recall': 0.30781077298771636, 'f1-score': 0.4019205241901319, 'support': 462323}, '1': {'precision': 0.5324791345535053, 'recall': 0.8982887542124559, 'f1-score': 0.6686200077285023, 'support': 654903}, '2': {'precision': 0.608343699857573, 'recall': 0.29646192639190294, 'f1-score': 0.39865080396488783, 'support': 455276}, 'accuracy': 0.5504425431573378, 'macro avg': {'precision': 0.5732470993820987, 'recall': 0.500853817864025, 'f1-score': 0.48973044529450743, 'support': 1572502}, 'weighted avg': {'precision': 0.5680970770544697, 'recall': 0.5504425431573378, 'f1-score': 0.5120467222633053, 'support': 1572502}}
[[142308 265302  54713]
 [ 34428 588292  32183]
 [ 69081 251223 134972]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0320086
{'0': {'precision': 0.5310139600393338, 'recall': 0.25967737193782625, 'f1-score': 0.34878922792919964, 'support': 476214}, '1': {'precision': 0.477804597425846, 'recall': 0.8705604923824886, 'f1-score': 0.6169809775433865, 'support': 618706}, '2': {'precision': 0.558034284637845, 'recall': 0.2481102721626862, 'f1-score': 0.3434968010876591, 'support': 477582}, 'accuracy': 0.4965182874171225, 'macro avg': {'precision': 0.5222842807010083, 'recall': 0.459449378827667, 'f1-score': 0.4364223355200818, 'support': 1572502}, 'weighted avg': {'precision': 0.5182848625610894, 'recall': 0.4965182874171225, 'f1-score': 0.4527027853306901, 'support': 1572502}}
[[123662 297256  55296]
 [ 41534 538621  38551]
 [ 67683 291406 118493]]
Evaluating performance on  train set...
2083/2083 - 20s - 20s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.86913717
{'0': {'precision': 0.4939596852133094, 'recall': 0.4520072012886516, 'f1-score': 0.4720531723648838, 'support': 126644}, '1': {'precision': 0.6838717874030875, 'recall': 0.7859004764651839, 'f1-score': 0.7313448168448399, 'support': 280818}, '2': {'precision': 0.522369603128468, 'recall': 0.39301817025167984, 'f1-score': 0.44855470345328313, 'support': 125755}, 'accuracy': 0.6139395405622852, 'macro avg': {'precision': 0.5667336919149549, 'recall': 0.5436419493351718, 'f1-score': 0.5506508975543356, 'support': 533217}, 'weighted avg': {'precision': 0.6006768865406299, 'recall': 0.6139395405622852, 'f1-score': 0.6030668329600898, 'support': 533217}}
[[ 57244  51842  17558]
 [ 32490 220695  27633]
 [ 26154  50177  49424]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9637719
{'0': {'precision': 0.5407543063407384, 'recall': 0.3876110572075414, 'f1-score': 0.4515514184397163, 'support': 157689}, '1': {'precision': 0.5538039836754584, 'recall': 0.8293735318935438, 'f1-score': 0.6641379877096707, 'support': 219245}, '2': {'precision': 0.5705093308364001, 'recall': 0.3352827882751163, 'f1-score': 0.4223528890214365, 'support': 156283}, 'accuracy': 0.5539151977525097, 'macro avg': {'precision': 0.555022540284199, 'recall': 0.5174224591254005, 'f1-score': 0.5126807650569412, 'support': 533217}, 'weighted avg': {'precision': 0.5548410308834784, 'recall': 0.5539151977525097, 'f1-score': 0.5304035717028609, 'support': 533217}}
[[ 61122  74397  22170]
 [ 20132 181836  17277]
 [ 31777  72107  52399]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0199252
{'0': {'precision': 0.5504139402046202, 'recall': 0.34399200176232353, 'f1-score': 0.4233826816322132, 'support': 177039}, '1': {'precision': 0.4601887533005067, 'recall': 0.8561068702290077, 'f1-score': 0.5986052772040565, 'support': 180780}, '2': {'precision': 0.5870323784792664, 'recall': 0.28870340596814104, 'f1-score': 0.3870533786340237, 'support': 175398}, 'accuracy': 0.49943081334616113, 'macro avg': {'precision': 0.5325450239947978, 'recall': 0.49626742598649076, 'f1-score': 0.46968044582343116, 'support': 533217}, 'weighted avg': {'precision': 0.5318696918929023, 'recall': 0.49943081334616113, 'f1-score': 0.4708392588609989, 'support': 533217}}
[[ 60900  92579  23560]
 [ 13950 154767  12063]
 [ 35794  88966  50638]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.074221
{'0': {'precision': 0.5019035413407716, 'recall': 0.2997799253659937, 'f1-score': 0.37536162940254064, 'support': 177667}, '1': {'precision': 0.4211165926418889, 'recall': 0.8172410114157687, 'f1-score': 0.5558228882625665, 'support': 178087}, '2': {'precision': 0.5375733182811004, 'recall': 0.24686272631478112, 'f1-score': 0.3383496101669389, 'support': 177463}, 'accuracy': 0.4549929953471101, 'macro avg': {'precision': 0.4868644840879203, 'recall': 0.4546278876988478, 'f1-score': 0.423178042610682, 'support': 533217}, 'weighted avg': {'precision': 0.4867932959664186, 'recall': 0.4549929953471101, 'f1-score': 0.42331497717089356, 'support': 533217}}
[[ 53261 101263  23143]
 [ 18005 145540  14542]
 [ 34852  98802  43809]]
Evaluating performance on  val set...
685/685 - 7s - 7s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8699619
{'0': {'precision': 0.4866894922631844, 'recall': 0.45210680736704556, 'f1-score': 0.4687611841096171, 'support': 40559}, '1': {'precision': 0.6919615540305195, 'recall': 0.7814443511263728, 'f1-score': 0.7339857207049778, 'support': 94063}, '2': {'precision': 0.5057724903258819, 'recall': 0.3900027126334739, 'f1-score': 0.44040657198551936, 'support': 40551}, 'accuracy': 0.6145753055550799, 'macro avg': {'precision': 0.5614745122065287, 'recall': 0.541184623708964, 'f1-score': 0.5477178256000381, 'support': 175173}, 'weighted avg': {'precision': 0.601332391571076, 'recall': 0.6145753055550799, 'f1-score': 0.6046154978995569, 'support': 175173}}
[[18337 16198  6024]
 [11128 73505  9430]
 [ 8212 16524 15815]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.963842
{'0': {'precision': 0.5328318487942646, 'recall': 0.38925149284821553, 'f1-score': 0.44986300741708796, 'support': 50407}, '1': {'precision': 0.5664946591193337, 'recall': 0.8241858960534828, 'f1-score': 0.6714653577330851, 'support': 74192}, '2': {'precision': 0.5531439094975007, 'recall': 0.33258195910942384, 'f1-score': 0.4154009532982639, 'support': 50574}, 'accuracy': 0.5571006947417696, 'macro avg': {'precision': 0.5508234724703663, 'recall': 0.5153397826703741, 'f1-score': 0.512243106149479, 'support': 175173}, 'weighted avg': {'precision': 0.5529535192665577, 'recall': 0.5571006947417696, 'f1-score': 0.533769988799145, 'support': 175173}}
[[19621 23276  7510]
 [ 6966 61148  6078]
 [10237 23517 16820]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0203199
{'0': {'precision': 0.5421503593145384, 'recall': 0.34526156445821304, 'f1-score': 0.421864246386786, 'support': 56812}, '1': {'precision': 0.47313434187059217, 'recall': 0.8489441195581546, 'f1-score': 0.6076259904544318, 'support': 61560}, '2': {'precision': 0.5651457807681525, 'recall': 0.2839210577278569, 'f1-score': 0.3779603220174133, 'support': 56801}, 'accuracy': 0.5023776495236137, 'macro avg': {'precision': 0.5268101606510943, 'recall': 0.4927089139147416, 'f1-score': 0.46915018628621036, 'support': 175173}, 'weighted avg': {'precision': 0.5253528899564603, 'recall': 0.5023776495236137, 'f1-score': 0.4729092485086857, 'support': 175173}}
[[19615 29114  8083]
 [ 4973 52261  4326]
 [11592 29082 16127]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0753478
{'0': {'precision': 0.49378917706596126, 'recall': 0.2993428506684795, 'f1-score': 0.3727305283948474, 'support': 57369}, '1': {'precision': 0.4296030472428448, 'recall': 0.8130256307569083, 'f1-score': 0.5621603535207855, 'support': 59928}, '2': {'precision': 0.518587153923131, 'recall': 0.24175824175824176, 'f1-score': 0.32977833296015646, 'support': 57876}, 'accuracy': 0.45605201714876153, 'macro avg': {'precision': 0.4806597927439791, 'recall': 0.4513755743945432, 'f1-score': 0.4215564049585965, 'support': 175173}, 'weighted avg': {'precision': 0.4800237070480124, 'recall': 0.45605201714876153, 'f1-score': 0.4233447742955801, 'support': 175173}}
[[17173 32204  7992]
 [ 6208 48723  4997]
 [11397 32487 13992]]
training model: results/ATVI/W7/deepVOL_L3/seq2seq
Epoch 1/50
2083/2083 - 95s - loss: 12.6698 - accuracy10: 0.4571 - accuracy20: 0.4489 - accuracy30: 0.4369 - accuracy50: 0.4150 - val_loss: 13.2796 - val_accuracy10: 0.5481 - val_accuracy20: 0.4748 - val_accuracy30: 0.4167 - val_accuracy50: 0.3885 - 95s/epoch - 46ms/step
Epoch 2/50
2083/2083 - 87s - loss: 12.4650 - accuracy10: 0.4633 - accuracy20: 0.4626 - accuracy30: 0.4542 - accuracy50: 0.4289 - val_loss: 13.2665 - val_accuracy10: 0.5480 - val_accuracy20: 0.4710 - val_accuracy30: 0.4156 - val_accuracy50: 0.3935 - 87s/epoch - 42ms/step
Epoch 3/50
2083/2083 - 88s - loss: 11.9384 - accuracy10: 0.5053 - accuracy20: 0.5041 - accuracy30: 0.4943 - accuracy50: 0.4607 - val_loss: 12.7270 - val_accuracy10: 0.5712 - val_accuracy20: 0.5214 - val_accuracy30: 0.4776 - val_accuracy50: 0.4411 - 88s/epoch - 42ms/step
Epoch 4/50
2083/2083 - 87s - loss: 11.5504 - accuracy10: 0.5484 - accuracy20: 0.5384 - accuracy30: 0.5212 - accuracy50: 0.4793 - val_loss: 12.2831 - val_accuracy10: 0.5745 - val_accuracy20: 0.5296 - val_accuracy30: 0.4892 - val_accuracy50: 0.4509 - 87s/epoch - 42ms/step
Epoch 5/50
2083/2083 - 87s - loss: 11.4056 - accuracy10: 0.5597 - accuracy20: 0.5473 - accuracy30: 0.5279 - accuracy50: 0.4849 - val_loss: 12.3854 - val_accuracy10: 0.5692 - val_accuracy20: 0.5299 - val_accuracy30: 0.4916 - val_accuracy50: 0.4535 - 87s/epoch - 42ms/step
Epoch 6/50
2083/2083 - 86s - loss: 11.3251 - accuracy10: 0.5643 - accuracy20: 0.5522 - accuracy30: 0.5320 - accuracy50: 0.4880 - val_loss: 12.4786 - val_accuracy10: 0.5890 - val_accuracy20: 0.5377 - val_accuracy30: 0.4917 - val_accuracy50: 0.4523 - 86s/epoch - 41ms/step
Epoch 7/50
2083/2083 - 86s - loss: 11.2595 - accuracy10: 0.5694 - accuracy20: 0.5563 - accuracy30: 0.5354 - accuracy50: 0.4903 - val_loss: 12.3615 - val_accuracy10: 0.5946 - val_accuracy20: 0.5406 - val_accuracy30: 0.4931 - val_accuracy50: 0.4534 - 86s/epoch - 41ms/step
Epoch 8/50
2083/2083 - 85s - loss: 11.2128 - accuracy10: 0.5730 - accuracy20: 0.5592 - accuracy30: 0.5373 - accuracy50: 0.4920 - val_loss: 12.1988 - val_accuracy10: 0.5975 - val_accuracy20: 0.5468 - val_accuracy30: 0.5003 - val_accuracy50: 0.4590 - 85s/epoch - 41ms/step
Epoch 9/50
2083/2083 - 87s - loss: 11.1721 - accuracy10: 0.5751 - accuracy20: 0.5617 - accuracy30: 0.5394 - accuracy50: 0.4937 - val_loss: 12.1708 - val_accuracy10: 0.6036 - val_accuracy20: 0.5476 - val_accuracy30: 0.4968 - val_accuracy50: 0.4550 - 87s/epoch - 42ms/step
Epoch 10/50
2083/2083 - 85s - loss: 11.1400 - accuracy10: 0.5768 - accuracy20: 0.5637 - accuracy30: 0.5413 - accuracy50: 0.4950 - val_loss: 12.0198 - val_accuracy10: 0.5976 - val_accuracy20: 0.5466 - val_accuracy30: 0.4972 - val_accuracy50: 0.4546 - 85s/epoch - 41ms/step
Epoch 11/50
2083/2083 - 85s - loss: 11.1160 - accuracy10: 0.5786 - accuracy20: 0.5653 - accuracy30: 0.5431 - accuracy50: 0.4965 - val_loss: 11.9355 - val_accuracy10: 0.6057 - val_accuracy20: 0.5516 - val_accuracy30: 0.5010 - val_accuracy50: 0.4569 - 85s/epoch - 41ms/step
Epoch 12/50
2083/2083 - 87s - loss: 11.0925 - accuracy10: 0.5804 - accuracy20: 0.5670 - accuracy30: 0.5441 - accuracy50: 0.4972 - val_loss: 11.9518 - val_accuracy10: 0.6048 - val_accuracy20: 0.5537 - val_accuracy30: 0.5029 - val_accuracy50: 0.4576 - 87s/epoch - 42ms/step
Epoch 13/50
2083/2083 - 86s - loss: 11.0752 - accuracy10: 0.5815 - accuracy20: 0.5678 - accuracy30: 0.5454 - accuracy50: 0.4984 - val_loss: 11.8185 - val_accuracy10: 0.6086 - val_accuracy20: 0.5570 - val_accuracy30: 0.5055 - val_accuracy50: 0.4588 - 86s/epoch - 41ms/step
Epoch 14/50
2083/2083 - 85s - loss: 11.0554 - accuracy10: 0.5821 - accuracy20: 0.5688 - accuracy30: 0.5468 - accuracy50: 0.4995 - val_loss: 11.7108 - val_accuracy10: 0.6128 - val_accuracy20: 0.5612 - val_accuracy30: 0.5096 - val_accuracy50: 0.4613 - 85s/epoch - 41ms/step
Epoch 15/50
2083/2083 - 87s - loss: 11.0378 - accuracy10: 0.5834 - accuracy20: 0.5699 - accuracy30: 0.5472 - accuracy50: 0.5000 - val_loss: 11.7769 - val_accuracy10: 0.6080 - val_accuracy20: 0.5588 - val_accuracy30: 0.5084 - val_accuracy50: 0.4601 - 87s/epoch - 42ms/step
Epoch 16/50
2083/2083 - 86s - loss: 11.0221 - accuracy10: 0.5838 - accuracy20: 0.5707 - accuracy30: 0.5481 - accuracy50: 0.5012 - val_loss: 11.7260 - val_accuracy10: 0.6100 - val_accuracy20: 0.5604 - val_accuracy30: 0.5104 - val_accuracy50: 0.4628 - 86s/epoch - 41ms/step
Epoch 17/50
2083/2083 - 87s - loss: 11.0071 - accuracy10: 0.5849 - accuracy20: 0.5713 - accuracy30: 0.5489 - accuracy50: 0.5017 - val_loss: 11.7021 - val_accuracy10: 0.6098 - val_accuracy20: 0.5624 - val_accuracy30: 0.5131 - val_accuracy50: 0.4639 - 87s/epoch - 42ms/step
Epoch 18/50
2083/2083 - 86s - loss: 10.9939 - accuracy10: 0.5854 - accuracy20: 0.5721 - accuracy30: 0.5492 - accuracy50: 0.5022 - val_loss: 11.7261 - val_accuracy10: 0.6072 - val_accuracy20: 0.5616 - val_accuracy30: 0.5143 - val_accuracy50: 0.4654 - 86s/epoch - 41ms/step
Epoch 19/50
2083/2083 - 87s - loss: 10.9800 - accuracy10: 0.5856 - accuracy20: 0.5723 - accuracy30: 0.5499 - accuracy50: 0.5027 - val_loss: 11.6530 - val_accuracy10: 0.6107 - val_accuracy20: 0.5638 - val_accuracy30: 0.5156 - val_accuracy50: 0.4672 - 87s/epoch - 42ms/step
Epoch 20/50
2083/2083 - 87s - loss: 10.9698 - accuracy10: 0.5864 - accuracy20: 0.5737 - accuracy30: 0.5509 - accuracy50: 0.5038 - val_loss: 11.7215 - val_accuracy10: 0.6076 - val_accuracy20: 0.5624 - val_accuracy30: 0.5164 - val_accuracy50: 0.4668 - 87s/epoch - 42ms/step
Epoch 21/50
2083/2083 - 85s - loss: 10.9595 - accuracy10: 0.5867 - accuracy20: 0.5738 - accuracy30: 0.5517 - accuracy50: 0.5040 - val_loss: 11.6622 - val_accuracy10: 0.6133 - val_accuracy20: 0.5655 - val_accuracy30: 0.5166 - val_accuracy50: 0.4671 - 85s/epoch - 41ms/step
Epoch 22/50
2083/2083 - 85s - loss: 10.9445 - accuracy10: 0.5870 - accuracy20: 0.5742 - accuracy30: 0.5528 - accuracy50: 0.5049 - val_loss: 11.6288 - val_accuracy10: 0.6092 - val_accuracy20: 0.5648 - val_accuracy30: 0.5191 - val_accuracy50: 0.4699 - 85s/epoch - 41ms/step
Epoch 23/50
2083/2083 - 85s - loss: 10.9343 - accuracy10: 0.5877 - accuracy20: 0.5752 - accuracy30: 0.5533 - accuracy50: 0.5056 - val_loss: 11.5878 - val_accuracy10: 0.6074 - val_accuracy20: 0.5660 - val_accuracy30: 0.5215 - val_accuracy50: 0.4725 - 85s/epoch - 41ms/step
Epoch 24/50
2083/2083 - 86s - loss: 10.9215 - accuracy10: 0.5880 - accuracy20: 0.5757 - accuracy30: 0.5536 - accuracy50: 0.5062 - val_loss: 11.6130 - val_accuracy10: 0.6141 - val_accuracy20: 0.5661 - val_accuracy30: 0.5190 - val_accuracy50: 0.4705 - 86s/epoch - 41ms/step
Epoch 25/50
2083/2083 - 86s - loss: 10.9106 - accuracy10: 0.5888 - accuracy20: 0.5763 - accuracy30: 0.5544 - accuracy50: 0.5074 - val_loss: 11.6223 - val_accuracy10: 0.6107 - val_accuracy20: 0.5669 - val_accuracy30: 0.5216 - val_accuracy50: 0.4723 - 86s/epoch - 41ms/step
Epoch 26/50
2083/2083 - 84s - loss: 10.8993 - accuracy10: 0.5891 - accuracy20: 0.5769 - accuracy30: 0.5548 - accuracy50: 0.5072 - val_loss: 11.5866 - val_accuracy10: 0.6107 - val_accuracy20: 0.5677 - val_accuracy30: 0.5220 - val_accuracy50: 0.4738 - 84s/epoch - 41ms/step
Epoch 27/50
2083/2083 - 88s - loss: 10.8865 - accuracy10: 0.5896 - accuracy20: 0.5774 - accuracy30: 0.5559 - accuracy50: 0.5083 - val_loss: 11.5806 - val_accuracy10: 0.6107 - val_accuracy20: 0.5687 - val_accuracy30: 0.5246 - val_accuracy50: 0.4757 - 88s/epoch - 42ms/step
Epoch 28/50
2083/2083 - 84s - loss: 10.8792 - accuracy10: 0.5904 - accuracy20: 0.5780 - accuracy30: 0.5559 - accuracy50: 0.5087 - val_loss: 11.5627 - val_accuracy10: 0.6115 - val_accuracy20: 0.5682 - val_accuracy30: 0.5238 - val_accuracy50: 0.4756 - 84s/epoch - 40ms/step
Epoch 29/50
2083/2083 - 85s - loss: 10.8677 - accuracy10: 0.5903 - accuracy20: 0.5782 - accuracy30: 0.5567 - accuracy50: 0.5093 - val_loss: 11.6153 - val_accuracy10: 0.6103 - val_accuracy20: 0.5678 - val_accuracy30: 0.5231 - val_accuracy50: 0.4747 - 85s/epoch - 41ms/step
Epoch 30/50
2083/2083 - 84s - loss: 10.8598 - accuracy10: 0.5904 - accuracy20: 0.5790 - accuracy30: 0.5574 - accuracy50: 0.5103 - val_loss: 11.5872 - val_accuracy10: 0.6097 - val_accuracy20: 0.5674 - val_accuracy30: 0.5237 - val_accuracy50: 0.4768 - 84s/epoch - 40ms/step
Epoch 31/50
2083/2083 - 85s - loss: 10.8482 - accuracy10: 0.5906 - accuracy20: 0.5793 - accuracy30: 0.5581 - accuracy50: 0.5110 - val_loss: 11.5842 - val_accuracy10: 0.6099 - val_accuracy20: 0.5694 - val_accuracy30: 0.5249 - val_accuracy50: 0.4766 - 85s/epoch - 41ms/step
Epoch 32/50
2083/2083 - 85s - loss: 10.8393 - accuracy10: 0.5920 - accuracy20: 0.5801 - accuracy30: 0.5586 - accuracy50: 0.5115 - val_loss: 11.5731 - val_accuracy10: 0.6094 - val_accuracy20: 0.5688 - val_accuracy30: 0.5253 - val_accuracy50: 0.4783 - 85s/epoch - 41ms/step
Epoch 33/50
2083/2083 - 86s - loss: 10.8314 - accuracy10: 0.5918 - accuracy20: 0.5805 - accuracy30: 0.5595 - accuracy50: 0.5121 - val_loss: 11.5807 - val_accuracy10: 0.6089 - val_accuracy20: 0.5685 - val_accuracy30: 0.5268 - val_accuracy50: 0.4786 - 86s/epoch - 41ms/step
Epoch 34/50
2083/2083 - 85s - loss: 10.8210 - accuracy10: 0.5921 - accuracy20: 0.5809 - accuracy30: 0.5603 - accuracy50: 0.5129 - val_loss: 11.6443 - val_accuracy10: 0.6110 - val_accuracy20: 0.5692 - val_accuracy30: 0.5253 - val_accuracy50: 0.4768 - 85s/epoch - 41ms/step
Epoch 35/50
2083/2083 - 86s - loss: 10.8118 - accuracy10: 0.5925 - accuracy20: 0.5811 - accuracy30: 0.5607 - accuracy50: 0.5141 - val_loss: 11.5824 - val_accuracy10: 0.6099 - val_accuracy20: 0.5685 - val_accuracy30: 0.5261 - val_accuracy50: 0.4781 - 86s/epoch - 41ms/step
Epoch 36/50
2083/2083 - 85s - loss: 10.7993 - accuracy10: 0.5929 - accuracy20: 0.5818 - accuracy30: 0.5612 - accuracy50: 0.5149 - val_loss: 11.6224 - val_accuracy10: 0.6119 - val_accuracy20: 0.5675 - val_accuracy30: 0.5242 - val_accuracy50: 0.4770 - 85s/epoch - 41ms/step
Epoch 37/50
2083/2083 - 85s - loss: 10.7895 - accuracy10: 0.5931 - accuracy20: 0.5820 - accuracy30: 0.5620 - accuracy50: 0.5149 - val_loss: 11.6107 - val_accuracy10: 0.6101 - val_accuracy20: 0.5681 - val_accuracy30: 0.5254 - val_accuracy50: 0.4786 - 85s/epoch - 41ms/step
Epoch 38/50
2083/2083 - 85s - loss: 10.7826 - accuracy10: 0.5934 - accuracy20: 0.5830 - accuracy30: 0.5623 - accuracy50: 0.5156 - val_loss: 11.5714 - val_accuracy10: 0.6084 - val_accuracy20: 0.5684 - val_accuracy30: 0.5269 - val_accuracy50: 0.4805 - 85s/epoch - 41ms/step
testing model: results/ATVI/W7/deepVOL_L3/seq2seq
Evaluating performance on  test set...
6143/6143 - 103s - 103s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.763296
{'0': {'precision': 0.5031309275050002, 'recall': 0.4618418183714162, 'f1-score': 0.48160303683346845, 'support': 316459}, '1': {'precision': 0.7649760172350717, 'recall': 0.7972985138966707, 'f1-score': 0.7808028993038537, 'support': 944147}, '2': {'precision': 0.5063344665456266, 'recall': 0.483731756739426, 'f1-score': 0.49477510744110625, 'support': 311896}, 'accuracy': 0.667595335331847, 'macro avg': {'precision': 0.5914804704285662, 'recall': 0.5809573630025043, 'f1-score': 0.5857270145261427, 'support': 1572502}, 'weighted avg': {'precision': 0.660980918758425, 'recall': 0.667595335331847, 'f1-score': 0.6638584289958102, 'support': 1572502}}
[[146154 116775  53530]
 [ 97811 752767  93569]
 [ 46524 114498 150874]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8477363
{'0': {'precision': 0.5628766158465008, 'recall': 0.3920085617244344, 'f1-score': 0.4621549434197018, 'support': 403657}, '1': {'precision': 0.6480484352727255, 'recall': 0.8332512985246687, 'f1-score': 0.7290721626116694, 'support': 772030}, '2': {'precision': 0.5607150628525518, 'recall': 0.42209593891359953, 'f1-score': 0.4816298362399897, 'support': 396815}, 'accuracy': 0.6162319666366084, 'macro avg': {'precision': 0.5905467046572593, 'recall': 0.5491185997209009, 'f1-score': 0.5576189807571202, 'support': 1572502}, 'weighted avg': {'precision': 0.6041468101612517, 'recall': 0.6162319666366084, 'f1-score': 0.5981140902616501, 'support': 1572502}}
[[158237 177728  67692]
 [ 65206 643295  63529]
 [ 57679 171642 167494]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9143157
{'0': {'precision': 0.5803712285094125, 'recall': 0.3429593595819373, 'f1-score': 0.43114296746265246, 'support': 462323}, '1': {'precision': 0.5565509260187811, 'recall': 0.8474186253536783, 'f1-score': 0.6718544860251502, 'support': 654903}, '2': {'precision': 0.5755753337150687, 'recall': 0.3819617111378592, 'f1-score': 0.45919422237772395, 'support': 455276}, 'accuracy': 0.5643445922485313, 'macro avg': {'precision': 0.5708324960810874, 'recall': 0.5241132320244916, 'f1-score': 0.5207305586218421, 'support': 1572502}, 'weighted avg': {'precision': 0.5690622169085295, 'recall': 0.5643445922485313, 'f1-score': 0.5395140593746816, 'support': 1572502}}
[[158558 225889  77876]
 [ 49571 554977  50355]
 [ 65072 216306 173898]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9932922
{'0': {'precision': 0.5388321116298062, 'recall': 0.28818976342568675, 'f1-score': 0.3755303298751014, 'support': 476214}, '1': {'precision': 0.49727707242281394, 'recall': 0.8083338451542412, 'f1-score': 0.6157514197331364, 'support': 618706}, '2': {'precision': 0.525108624601069, 'recall': 0.3431410731560235, 'f1-score': 0.4150564922384907, 'support': 477582}, 'accuracy': 0.5095313074323594, 'macro avg': {'precision': 0.5204059362178963, 'recall': 0.4798882272453171, 'f1-score': 0.4687794139489095, 'support': 1572502}, 'weighted avg': {'precision': 0.5183142092870685, 'recall': 0.5095313074323594, 'f1-score': 0.48205052081637695, 'support': 1572502}}
[[137240 254751  84223]
 [ 54602 500121  63983]
 [ 62857 250847 163878]]
Evaluating performance on  train set...
2083/2083 - 35s - 35s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8512199
{'0': {'precision': 0.502455647171307, 'recall': 0.485502668898645, 'f1-score': 0.4938337047968998, 'support': 126644}, '1': {'precision': 0.7136597758752697, 'recall': 0.7302345291256258, 'f1-score': 0.72185202003668, 'support': 280818}, '2': {'precision': 0.49641312972649104, 'recall': 0.4875352868673214, 'f1-score': 0.49193415736918333, 'support': 125755}, 'accuracy': 0.6148697434627928, 'macro avg': {'precision': 0.5708428509243559, 'recall': 0.5677574949638641, 'f1-score': 0.5692066274009211, 'support': 533217}, 'weighted avg': {'precision': 0.6122609313860199, 'recall': 0.6148697434627928, 'f1-score': 0.6134712438517913, 'support': 533217}}
[[ 61486  41094  24064]
 [ 37623 205063  38132]
 [ 23262  41183  61310]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9162193
{'0': {'precision': 0.5533498137600428, 'recall': 0.4201751548934929, 'f1-score': 0.47765358094201354, 'support': 157689}, '1': {'precision': 0.5863377740291883, 'recall': 0.7736732878742959, 'f1-score': 0.6671032113564545, 'support': 219245}, '2': {'precision': 0.5463783870837863, 'recall': 0.4341611051745871, 'f1-score': 0.483848424775732, 'support': 156283}, 'accuracy': 0.5696236241530184, 'macro avg': {'precision': 0.5620219916243391, 'recall': 0.5426698493141252, 'f1-score': 0.5428684056914, 'support': 533217}, 'weighted avg': {'precision': 0.5648703201841879, 'recall': 0.5696236241530184, 'f1-score': 0.557366030093258, 'support': 533217}}
[[ 66257  60546  30886]
 [ 24174 169624  25447]
 [ 29307  59124  67852]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.95954823
{'0': {'precision': 0.5670567673617656, 'recall': 0.3738611266444117, 'f1-score': 0.45062482766602785, 'support': 177039}, '1': {'precision': 0.4932207515281163, 'recall': 0.7958402478150238, 'f1-score': 0.6090090776521284, 'support': 180780}, '2': {'precision': 0.560466681624411, 'recall': 0.39877307608980717, 'f1-score': 0.4659919918452734, 'support': 175398}, 'accuracy': 0.5251220422454648, 'macro avg': {'precision': 0.5402480668380977, 'recall': 0.5228248168497476, 'f1-score': 0.5085419657211432, 'support': 533217}, 'weighted avg': {'precision': 0.5398559039223635, 'recall': 0.5251220422454648, 'f1-score': 0.5093777829829037, 'support': 533217}}
[[ 66188  75384  35467]
 [ 17523 143872  19385]
 [ 33011  72443  69944]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0230482
{'0': {'precision': 0.52207543486143, 'recall': 0.31607445389408273, 'f1-score': 0.393759422220664, 'support': 177667}, '1': {'precision': 0.44670919087499494, 'recall': 0.7463823861371127, 'f1-score': 0.5589107797234479, 'support': 178087}, '2': {'precision': 0.5130290871051851, 'recall': 0.3703194468706153, 'f1-score': 0.43014651738932647, 'support': 177463}, 'accuracy': 0.47784485490897705, 'macro avg': {'precision': 0.4939379042805367, 'recall': 0.47759209563393684, 'f1-score': 0.4609389064444795, 'support': 533217}, 'weighted avg': {'precision': 0.4938933995837125, 'recall': 0.47784485490897705, 'f1-score': 0.46102785678579344, 'support': 533217}}
[[ 56156  83848  37663]
 [ 20449 132921  24717]
 [ 30958  80787  65718]]
Evaluating performance on  val set...
685/685 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.86048186
{'0': {'precision': 0.4877250409165303, 'recall': 0.47757587711728594, 'f1-score': 0.4825971049156639, 'support': 40559}, '1': {'precision': 0.7208198215383311, 'recall': 0.7231111063861455, 'f1-score': 0.7219636460130026, 'support': 94063}, '2': {'precision': 0.47771072610473037, 'recall': 0.48413109417770217, 'f1-score': 0.48089948191605325, 'support': 40551}, 'accuracy': 0.6109389004013176, 'macro avg': {'precision': 0.5620851961865306, 'recall': 0.5616060258937112, 'f1-score': 0.5618200776149066, 'support': 175173}, 'weighted avg': {'precision': 0.61057219127472, 'recall': 0.6109389004013176, 'f1-score': 0.6107372557664329, 'support': 175173}}
[[19370 12873  8316]
 [12897 68018 13148]
 [ 7448 13471 19632]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.92418087
{'0': {'precision': 0.537426149499101, 'recall': 0.4150614002023528, 'f1-score': 0.4683837603680446, 'support': 50407}, '1': {'precision': 0.5992060985111715, 'recall': 0.767050355833513, 'f1-score': 0.672818415047941, 'support': 74192}, '2': {'precision': 0.5259153359664639, 'recall': 0.42915331988768934, 'f1-score': 0.4726326448395632, 'support': 50574}, 'accuracy': 0.5682097126840323, 'macro avg': {'precision': 0.5541825279922454, 'recall': 0.5370883586411851, 'f1-score': 0.5379449400851829, 'support': 175173}, 'weighted avg': {'precision': 0.5602688826457843, 'recall': 0.5682097126840323, 'f1-score': 0.5561958032243836, 'support': 175173}}
[[20922 18896 10589]
 [ 8307 56909  8976]
 [ 9701 19169 21704]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.967225
{'0': {'precision': 0.5518933529272837, 'recall': 0.3701858762233331, 'f1-score': 0.4431357262508033, 'support': 56812}, '1': {'precision': 0.5059775957827356, 'recall': 0.7858187134502924, 'f1-score': 0.6155872415965183, 'support': 61560}, '2': {'precision': 0.5404134204877108, 'recall': 0.3944472808577314, 'f1-score': 0.4560350091593731, 'support': 56801}, 'accuracy': 0.5241161594537971, 'macro avg': {'precision': 0.5327614563992434, 'recall': 0.516817290177119, 'f1-score': 0.5049193256688982, 'support': 175173}, 'weighted avg': {'precision': 0.5320350091624423, 'recall': 0.5241161594537971, 'f1-score': 0.507922008686863, 'support': 175173}}
[[21031 23643 12138]
 [ 6269 48375  6916]
 [10807 23589 22405]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0284754
{'0': {'precision': 0.5097793950420741, 'recall': 0.3125729923826457, 'f1-score': 0.3875303906207791, 'support': 57369}, '1': {'precision': 0.45569542334800406, 'recall': 0.7411894273127754, 'f1-score': 0.5643928564621572, 'support': 59928}, '2': {'precision': 0.4958846768883454, 'recall': 0.3643479162347087, 'f1-score': 0.4200597609561753, 'support': 57876}, 'accuracy': 0.4763119887197228, 'macro avg': {'precision': 0.48711983175947454, 'recall': 0.4727034453100432, 'f1-score': 0.45732766934637054, 'support': 175173}, 'weighted avg': {'precision': 0.4866861388693339, 'recall': 0.4763119887197228, 'f1-score': 0.4587838582811691, 'support': 175173}}
[[17932 26611 12826]
 [ 6899 44418  8611]
 [10345 26444 21087]]
training model: results/ATVI/W8/deepLOB_L1/seq2seq
Epoch 1/50
1691/1691 - 48s - loss: 12.2022 - accuracy10: 0.4602 - accuracy20: 0.4754 - accuracy30: 0.4753 - accuracy50: 0.4556 - val_loss: 13.7333 - val_accuracy10: 0.4797 - val_accuracy20: 0.4093 - val_accuracy30: 0.3607 - val_accuracy50: 0.3179 - 48s/epoch - 29ms/step
Epoch 2/50
1691/1691 - 42s - loss: 12.0652 - accuracy10: 0.4662 - accuracy20: 0.4838 - accuracy30: 0.4846 - accuracy50: 0.4624 - val_loss: 13.5716 - val_accuracy10: 0.4778 - val_accuracy20: 0.4230 - val_accuracy30: 0.3859 - val_accuracy50: 0.3473 - 42s/epoch - 25ms/step
Epoch 3/50
1691/1691 - 43s - loss: 11.8137 - accuracy10: 0.4975 - accuracy20: 0.5078 - accuracy30: 0.5052 - accuracy50: 0.4790 - val_loss: 14.1404 - val_accuracy10: 0.4833 - val_accuracy20: 0.4292 - val_accuracy30: 0.3942 - val_accuracy50: 0.3588 - 43s/epoch - 26ms/step
Epoch 4/50
1691/1691 - 44s - loss: 11.6327 - accuracy10: 0.5212 - accuracy20: 0.5251 - accuracy30: 0.5188 - accuracy50: 0.4896 - val_loss: 14.1627 - val_accuracy10: 0.4908 - val_accuracy20: 0.4347 - val_accuracy30: 0.3980 - val_accuracy50: 0.3607 - 44s/epoch - 26ms/step
Epoch 5/50
1691/1691 - 40s - loss: 11.5086 - accuracy10: 0.5328 - accuracy20: 0.5333 - accuracy30: 0.5248 - accuracy50: 0.4948 - val_loss: 14.1039 - val_accuracy10: 0.4918 - val_accuracy20: 0.4372 - val_accuracy30: 0.4020 - val_accuracy50: 0.3673 - 40s/epoch - 24ms/step
Epoch 6/50
1691/1691 - 40s - loss: 11.4144 - accuracy10: 0.5417 - accuracy20: 0.5407 - accuracy30: 0.5306 - accuracy50: 0.4986 - val_loss: 14.2870 - val_accuracy10: 0.5012 - val_accuracy20: 0.4435 - val_accuracy30: 0.4046 - val_accuracy50: 0.3678 - 40s/epoch - 23ms/step
Epoch 7/50
1691/1691 - 43s - loss: 11.3415 - accuracy10: 0.5467 - accuracy20: 0.5452 - accuracy30: 0.5347 - accuracy50: 0.5020 - val_loss: 14.2622 - val_accuracy10: 0.5020 - val_accuracy20: 0.4452 - val_accuracy30: 0.4067 - val_accuracy50: 0.3699 - 43s/epoch - 25ms/step
Epoch 8/50
1691/1691 - 39s - loss: 11.2894 - accuracy10: 0.5504 - accuracy20: 0.5482 - accuracy30: 0.5366 - accuracy50: 0.5039 - val_loss: 14.3616 - val_accuracy10: 0.5084 - val_accuracy20: 0.4492 - val_accuracy30: 0.4071 - val_accuracy50: 0.3682 - 39s/epoch - 23ms/step
Epoch 9/50
1691/1691 - 40s - loss: 11.2437 - accuracy10: 0.5534 - accuracy20: 0.5513 - accuracy30: 0.5401 - accuracy50: 0.5060 - val_loss: 14.1544 - val_accuracy10: 0.5086 - val_accuracy20: 0.4486 - val_accuracy30: 0.4067 - val_accuracy50: 0.3672 - 40s/epoch - 23ms/step
Epoch 10/50
1691/1691 - 43s - loss: 11.1909 - accuracy10: 0.5583 - accuracy20: 0.5552 - accuracy30: 0.5424 - accuracy50: 0.5081 - val_loss: 14.4811 - val_accuracy10: 0.5104 - val_accuracy20: 0.4498 - val_accuracy30: 0.4074 - val_accuracy50: 0.3666 - 43s/epoch - 25ms/step
Epoch 11/50
1691/1691 - 41s - loss: 11.1603 - accuracy10: 0.5604 - accuracy20: 0.5569 - accuracy30: 0.5441 - accuracy50: 0.5093 - val_loss: 14.4145 - val_accuracy10: 0.5122 - val_accuracy20: 0.4500 - val_accuracy30: 0.4071 - val_accuracy50: 0.3668 - 41s/epoch - 24ms/step
Epoch 12/50
1691/1691 - 41s - loss: 11.1261 - accuracy10: 0.5621 - accuracy20: 0.5589 - accuracy30: 0.5465 - accuracy50: 0.5111 - val_loss: 14.3194 - val_accuracy10: 0.5156 - val_accuracy20: 0.4540 - val_accuracy30: 0.4112 - val_accuracy50: 0.3703 - 41s/epoch - 25ms/step
testing model: results/ATVI/W8/deepLOB_L1/seq2seq
Evaluating performance on  test set...
4960/4960 - 46s - 46s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9672184
{'0': {'precision': 0.31977209541522794, 'recall': 0.6630068346260999, 'f1-score': 0.43145223875340905, 'support': 249465}, '1': {'precision': 0.7329495884821152, 'recall': 0.4100143442014437, 'f1-score': 0.5258605915037469, 'support': 774529}, '2': {'precision': 0.35489955259233263, 'recall': 0.46105191178984556, 'f1-score': 0.4010707115770689, 'support': 245686}, 'accuracy': 0.46959785142713123, 'macro avg': {'precision': 0.46920707882989193, 'recall': 0.511357696872463, 'f1-score': 0.4527945139447416, 'support': 1269680}, 'weighted avg': {'precision': 0.5786154850658621, 'recall': 0.46959785142713123, 'f1-score': 0.48316423796700625, 'support': 1269680}}
[[165397  51607  32461]
 [283524 317568 173437]
 [ 68313  64099 113274]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.98731863
{'0': {'precision': 0.37863628815555084, 'recall': 0.6381402774509118, 'f1-score': 0.47527268851332943, 'support': 314434}, '1': {'precision': 0.642473266685069, 'recall': 0.4154628213983593, 'f1-score': 0.5046122522080934, 'support': 644255}, '2': {'precision': 0.42028725369743974, 'recall': 0.4366910939544874, 'f1-score': 0.42833217687503944, 'support': 310991}, 'accuracy': 0.47580807762585847, 'macro avg': {'precision': 0.48046560284601986, 'recall': 0.49676473093458623, 'f1-score': 0.4694057058654874, 'support': 1269680}, 'weighted avg': {'precision': 0.5227130382243652, 'recall': 0.47580807762585847, 'f1-score': 0.47866258514339893, 'support': 1269680}}
[[200653  68148  45633]
 [234902 267664 141689]
 [ 94381  80803 135807]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0043701
{'0': {'precision': 0.41335196793127477, 'recall': 0.6081761059004641, 'f1-score': 0.49218576887421706, 'support': 357921}, '1': {'precision': 0.5621798083294277, 'recall': 0.43715833260025383, 'f1-score': 0.4918487097914457, 'support': 557011}, '2': {'precision': 0.4590380805492995, 'recall': 0.4010339734121123, 'f1-score': 0.42808009989919815, 'support': 354748}, 'accuracy': 0.4752748724087959, 'macro avg': {'precision': 0.47818995227000066, 'recall': 0.48212280397094337, 'f1-score': 0.4707048595216203, 'support': 1269680}, 'weighted avg': {'precision': 0.49140769952272667, 'recall': 0.4752748724087959, 'f1-score': 0.47412680639996885, 'support': 1269680}}
[[217679  87712  52530]
 [198383 243502 115126]
 [110557 101925 142266]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0305322
{'0': {'precision': 0.42638688601783453, 'recall': 0.5546769916360601, 'f1-score': 0.482143926805297, 'support': 391801}, '1': {'precision': 0.47030185004868547, 'recall': 0.4600719232051087, 'f1-score': 0.4651306450354886, 'support': 486074}, '2': {'precision': 0.4747340892953806, 'recall': 0.3447097408149462, 'f1-score': 0.39940617981100074, 'support': 391805}, 'accuracy': 0.4536662781173209, 'macro avg': {'precision': 0.4571409417873002, 'recall': 0.453152885218705, 'f1-score': 0.44889358388392875, 'support': 1269680}, 'weighted avg': {'precision': 0.45811818698066825, 'recall': 0.4536662781173209, 'f1-score': 0.45009902030596016, 'support': 1269680}}
[[217323 117986  56492]
 [169502 223629  92943]
 [122860 133886 135059]]
Evaluating performance on  train set...
1691/1691 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9622767
{'0': {'precision': 0.37559685649372415, 'recall': 0.5131957944448402, 'f1-score': 0.43374509668983546, 'support': 98251}, '1': {'precision': 0.6408367855850058, 'recall': 0.5354682327636907, 'f1-score': 0.5834332689473346, 'support': 238044}, '2': {'precision': 0.4038617784241938, 'recall': 0.4170214088183202, 'f1-score': 0.4103361121868694, 'support': 96549}, 'accuracy': 0.5039922004232472, 'macro avg': {'precision': 0.4734318068343079, 'recall': 0.4885618120089504, 'f1-score': 0.4758381592746798, 'support': 432844}, 'weighted avg': {'precision': 0.5277711355135788, 'recall': 0.5039922004232471, 'f1-score': 0.5108450616473889, 'support': 432844}}
[[ 50422  33592  14237]
 [ 65384 127465  45195]
 [ 18439  37847  40263]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.99959916
{'0': {'precision': 0.4327823550483599, 'recall': 0.48799366916437914, 'f1-score': 0.4587327294283567, 'support': 121311}, '1': {'precision': 0.5341501283608245, 'recall': 0.5418410150585031, 'f1-score': 0.5379680855456009, 'support': 192383}, '2': {'precision': 0.4614485055101879, 'recall': 0.39078472513638274, 'f1-score': 0.42318703590936774, 'support': 119150}, 'accuracy': 0.48516786648307475, 'macro avg': {'precision': 0.47612699630645744, 'recall': 0.473539803119755, 'f1-score': 0.47329595029444177, 'support': 432844}, 'weighted avg': {'precision': 0.4857275458346447, 'recall': 0.48516786648307475, 'f1-score': 0.4841651395648407, 'support': 432844}}
[[ 59199  43259  18853]
 [ 52653 104241  35489]
 [ 24935  47653  46562]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0265291
{'0': {'precision': 0.4638928317955997, 'recall': 0.45924147723114306, 'f1-score': 0.46155543622976264, 'support': 136634}, '1': {'precision': 0.4531613470043829, 'recall': 0.5582098913464554, 'f1-score': 0.5002300573352474, 'support': 162627}, '2': {'precision': 0.49224710551751083, 'recall': 0.358376440115883, 'f1-score': 0.41477752699957116, 'support': 133583}, 'accuracy': 0.46529696611250243, 'macro avg': {'precision': 0.46976709477249784, 'recall': 0.4586092695644939, 'f1-score': 0.4588543401881937, 'support': 432844}, 'weighted avg': {'precision': 0.4686114365803555, 'recall': 0.46529696611250243, 'f1-score': 0.4616497061233617, 'support': 432844}}
[[62748 52717 21169]
 [43635 90780 28212]
 [28881 56829 47873]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0576683
{'0': {'precision': 0.46614134449642947, 'recall': 0.41373657896893695, 'f1-score': 0.4383783705547756, 'support': 146412}, '1': {'precision': 0.38211194840238244, 'recall': 0.5664113945661188, 'f1-score': 0.45635684810375327, 'support': 143507}, '2': {'precision': 0.4948374718583992, 'recall': 0.3121847122616757, 'f1-score': 0.38284125717521694, 'support': 142925}, 'accuracy': 0.4308226520409201, 'macro avg': {'precision': 0.447696921585737, 'recall': 0.4307775619322438, 'f1-score': 0.42585882527791524, 'support': 432844}, 'weighted avg': {'precision': 0.4477573249834897, 'recall': 0.4308226520409201, 'f1-score': 0.4260006904849299, 'support': 432844}}
[[60576 64264 21572]
 [38245 81284 23978]
 [31131 67175 44619]]
Evaluating performance on  val set...
591/591 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0057356
{'0': {'precision': 0.3609138218832848, 'recall': 0.30301448160259403, 'f1-score': 0.32943953154875716, 'support': 36391}, '1': {'precision': 0.5255296194586112, 'recall': 0.690280193236715, 'f1-score': 0.5967424896288664, 'support': 77625}, '2': {'precision': 0.41249127329359325, 'recall': 0.20693464087504715, 'f1-score': 0.27560594915588726, 'support': 37118}, 'accuracy': 0.47832387153122397, 'macro avg': {'precision': 0.43297823821182974, 'recall': 0.4000764385714521, 'f1-score': 0.40059599011117025, 'support': 151134}, 'weighted avg': {'precision': 0.4581305509332176, 'recall': 0.47832387153122397, 'f1-score': 0.453509543655298, 'support': 151134}}
[[11027 23191  2173]
 [15275 53583  8767]
 [ 4251 25186  7681]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0631632
{'0': {'precision': 0.4131292869160088, 'recall': 0.29040915190247674, 'f1-score': 0.3410660149311538, 'support': 43969}, '1': {'precision': 0.4177715564405627, 'recall': 0.6848186151733053, 'f1-score': 0.5189557210031348, 'support': 61885}, '2': {'precision': 0.4735132832880796, 'recall': 0.19642226148409894, 'f1-score': 0.27766417432839546, 'support': 45280}, 'accuracy': 0.423749784959043, 'macro avg': {'precision': 0.4348047088815504, 'recall': 0.39055000951996033, 'f1-score': 0.37922863675422797, 'support': 151134}, 'weighted avg': {'precision': 0.43312130860043707, 'recall': 0.423749784959043, 'f1-score': 0.3949114045706237, 'support': 151134}}
[[12769 28401  2799]
 [12415 42380  7090]
 [ 5724 30662  8894]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0966313
{'0': {'precision': 0.44350198901929844, 'recall': 0.2763325003072637, 'f1-score': 0.3405060894806588, 'support': 48818}, '1': {'precision': 0.34903071353497606, 'recall': 0.6906678477892466, 'f1-score': 0.4637195831501642, 'support': 51928}, '2': {'precision': 0.5038138188296866, 'recall': 0.17958640946257046, 'f1-score': 0.26478807297839035, 'support': 50388}, 'accuracy': 0.38643852475286833, 'macro avg': {'precision': 0.432115507127987, 'recall': 0.382195585853027, 'f1-score': 0.3563379152030712, 'support': 151134}, 'weighted avg': {'precision': 0.4311506192887014, 'recall': 0.38643852475286833, 'f1-score': 0.35759655809628316, 'support': 151134}}
[[13490 32170  3158]
 [10309 35865  5754]
 [ 6618 34721  9049]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1258833
{'0': {'precision': 0.4459473448121183, 'recall': 0.2457221081451061, 'f1-score': 0.31685401522487955, 'support': 52596}, '1': {'precision': 0.2951965643800371, 'recall': 0.6948322312025471, 'f1-score': 0.4143558013397155, 'support': 44913}, '2': {'precision': 0.504775810671047, 'recall': 0.15472261072261073, 'f1-score': 0.23684736376352375, 'support': 53625}, 'accuracy': 0.3468974552383977, 'macro avg': {'precision': 0.4153065732877342, 'recall': 0.36509231669008796, 'f1-score': 0.3226857267760396, 'support': 151134}, 'weighted avg': {'precision': 0.4220216013006582, 'recall': 0.3468974552383977, 'f1-score': 0.31744118313653685, 'support': 151134}}
[[12924 36291  3381]
 [ 8947 31207  4759]
 [ 7110 38218  8297]]
training model: results/ATVI/W8/deepOF_L1/seq2seq
Epoch 1/50
1691/1691 - 47s - loss: 12.7067 - accuracy10: 0.4344 - accuracy20: 0.4385 - accuracy30: 0.4355 - accuracy50: 0.4244 - val_loss: 13.1300 - val_accuracy10: 0.4536 - val_accuracy20: 0.4178 - val_accuracy30: 0.3975 - val_accuracy50: 0.3811 - 47s/epoch - 28ms/step
Epoch 2/50
1691/1691 - 39s - loss: 12.6879 - accuracy10: 0.4168 - accuracy20: 0.4267 - accuracy30: 0.4285 - accuracy50: 0.4208 - val_loss: 13.0482 - val_accuracy10: 0.4259 - val_accuracy20: 0.4095 - val_accuracy30: 0.4028 - val_accuracy50: 0.3979 - 39s/epoch - 23ms/step
Epoch 3/50
1691/1691 - 38s - loss: 12.6738 - accuracy10: 0.4211 - accuracy20: 0.4290 - accuracy30: 0.4290 - accuracy50: 0.4200 - val_loss: 13.0367 - val_accuracy10: 0.4267 - val_accuracy20: 0.4085 - val_accuracy30: 0.4047 - val_accuracy50: 0.4037 - 38s/epoch - 23ms/step
Epoch 4/50
1691/1691 - 41s - loss: 12.6372 - accuracy10: 0.4272 - accuracy20: 0.4307 - accuracy30: 0.4296 - accuracy50: 0.4197 - val_loss: 13.0122 - val_accuracy10: 0.4076 - val_accuracy20: 0.4013 - val_accuracy30: 0.4028 - val_accuracy50: 0.4076 - 41s/epoch - 24ms/step
Epoch 5/50
1691/1691 - 41s - loss: 12.5990 - accuracy10: 0.4349 - accuracy20: 0.4358 - accuracy30: 0.4329 - accuracy50: 0.4222 - val_loss: 13.0069 - val_accuracy10: 0.4222 - val_accuracy20: 0.4077 - val_accuracy30: 0.4059 - val_accuracy50: 0.4080 - 41s/epoch - 24ms/step
Epoch 6/50
1691/1691 - 38s - loss: 12.5531 - accuracy10: 0.4413 - accuracy20: 0.4412 - accuracy30: 0.4375 - accuracy50: 0.4259 - val_loss: 13.0058 - val_accuracy10: 0.4273 - val_accuracy20: 0.4120 - val_accuracy30: 0.4074 - val_accuracy50: 0.4034 - 38s/epoch - 22ms/step
Epoch 7/50
1691/1691 - 39s - loss: 12.5146 - accuracy10: 0.4499 - accuracy20: 0.4476 - accuracy30: 0.4420 - accuracy50: 0.4288 - val_loss: 13.0196 - val_accuracy10: 0.4394 - val_accuracy20: 0.4178 - val_accuracy30: 0.4081 - val_accuracy50: 0.4002 - 39s/epoch - 23ms/step
Epoch 8/50
1691/1691 - 42s - loss: 12.4725 - accuracy10: 0.4567 - accuracy20: 0.4532 - accuracy30: 0.4463 - accuracy50: 0.4316 - val_loss: 13.0269 - val_accuracy10: 0.4506 - val_accuracy20: 0.4216 - val_accuracy30: 0.4055 - val_accuracy50: 0.3925 - 42s/epoch - 25ms/step
Epoch 9/50
1691/1691 - 41s - loss: 12.4343 - accuracy10: 0.4633 - accuracy20: 0.4589 - accuracy30: 0.4509 - accuracy50: 0.4347 - val_loss: 13.0872 - val_accuracy10: 0.4575 - val_accuracy20: 0.4223 - val_accuracy30: 0.4034 - val_accuracy50: 0.3879 - 41s/epoch - 24ms/step
Epoch 10/50
1691/1691 - 40s - loss: 12.4009 - accuracy10: 0.4662 - accuracy20: 0.4623 - accuracy30: 0.4550 - accuracy50: 0.4388 - val_loss: 13.0953 - val_accuracy10: 0.4632 - val_accuracy20: 0.4266 - val_accuracy30: 0.4046 - val_accuracy50: 0.3866 - 40s/epoch - 23ms/step
Epoch 11/50
1691/1691 - 36s - loss: 12.3484 - accuracy10: 0.4709 - accuracy20: 0.4669 - accuracy30: 0.4602 - accuracy50: 0.4433 - val_loss: 13.1029 - val_accuracy10: 0.4745 - val_accuracy20: 0.4320 - val_accuracy30: 0.4083 - val_accuracy50: 0.3899 - 36s/epoch - 21ms/step
Epoch 12/50
1691/1691 - 40s - loss: 12.2959 - accuracy10: 0.4751 - accuracy20: 0.4718 - accuracy30: 0.4656 - accuracy50: 0.4474 - val_loss: 13.0948 - val_accuracy10: 0.4835 - val_accuracy20: 0.4377 - val_accuracy30: 0.4120 - val_accuracy50: 0.3903 - 40s/epoch - 24ms/step
Epoch 13/50
1691/1691 - 39s - loss: 12.2495 - accuracy10: 0.4781 - accuracy20: 0.4749 - accuracy30: 0.4698 - accuracy50: 0.4519 - val_loss: 13.1805 - val_accuracy10: 0.4928 - val_accuracy20: 0.4409 - val_accuracy30: 0.4127 - val_accuracy50: 0.3890 - 39s/epoch - 23ms/step
Epoch 14/50
1691/1691 - 39s - loss: 12.2045 - accuracy10: 0.4804 - accuracy20: 0.4788 - accuracy30: 0.4743 - accuracy50: 0.4555 - val_loss: 13.2188 - val_accuracy10: 0.5033 - val_accuracy20: 0.4474 - val_accuracy30: 0.4156 - val_accuracy50: 0.3888 - 39s/epoch - 23ms/step
Epoch 15/50
1691/1691 - 37s - loss: 12.1649 - accuracy10: 0.4835 - accuracy20: 0.4824 - accuracy30: 0.4782 - accuracy50: 0.4590 - val_loss: 13.2374 - val_accuracy10: 0.5047 - val_accuracy20: 0.4494 - val_accuracy30: 0.4173 - val_accuracy50: 0.3891 - 37s/epoch - 22ms/step
Epoch 16/50
1691/1691 - 40s - loss: 12.1252 - accuracy10: 0.4847 - accuracy20: 0.4845 - accuracy30: 0.4810 - accuracy50: 0.4616 - val_loss: 13.3059 - val_accuracy10: 0.5079 - val_accuracy20: 0.4529 - val_accuracy30: 0.4197 - val_accuracy50: 0.3877 - 40s/epoch - 24ms/step
testing model: results/ATVI/W8/deepOF_L1/seq2seq
Evaluating performance on  test set...
4960/4960 - 48s - 48s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0429387
{'0': {'precision': 0.2690007853225078, 'recall': 0.5231498184092166, 'f1-score': 0.35530544654124, 'support': 249462}, '1': {'precision': 0.6523877742150545, 'recall': 0.42450757106263426, 'f1-score': 0.5143369792383646, 'support': 774528}, '2': {'precision': 0.31918086547372926, 'recall': 0.3644626249058754, 'f1-score': 0.34032210556320963, 'support': 245685}, 'accuracy': 0.432269675310611, 'macro avg': {'precision': 0.4135231416704305, 'recall': 0.4373733381259088, 'f1-score': 0.40332151044760484, 'support': 1269675}, 'weighted avg': {'precision': 0.5125847345417327, 'recall': 0.432269675310611, 'f1-score': 0.4494186588425385, 'support': 1269675}}
[[130506  80540  38416]
 [293154 328793 152581]
 [ 61491  94651  89543]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0558443
{'0': {'precision': 0.322680705469447, 'recall': 0.5233945654386322, 'f1-score': 0.3992300293408794, 'support': 314432}, '1': {'precision': 0.5417524141206269, 'recall': 0.3824609548407926, 'f1-score': 0.44837945987454936, 'support': 644254}, '2': {'precision': 0.3699169389442192, 'recall': 0.3625980340140648, 'f1-score': 0.3662209231518694, 'support': 310989}, 'accuracy': 0.4124976864158151, 'macro avg': {'precision': 0.411450019511431, 'recall': 0.4228178514311632, 'f1-score': 0.4046101374557661, 'support': 1269675}, 'weighted avg': {'precision': 0.4454111471946469, 'recall': 0.4124976864158151, 'f1-score': 0.41608414420840456, 'support': 1269675}}
[[164572  95848  54012]
 [259792 246402 138060]
 [ 85651 112574 112764]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0646278
{'0': {'precision': 0.355468442866931, 'recall': 0.5305181633782039, 'f1-score': 0.4257004882904454, 'support': 357918}, '1': {'precision': 0.4662832629597354, 'recall': 0.34773999077217504, 'f1-score': 0.3983801121539922, 'support': 557011}, '2': {'precision': 0.4008447386589774, 'recall': 0.36169541023718377, 'f1-score': 0.38026509791137225, 'support': 354746}, 'accuracy': 0.403163801760293, 'macro avg': {'precision': 0.4075321481618812, 'recall': 0.41331785479585426, 'f1-score': 0.4014485661186033, 'support': 1269675}, 'weighted avg': {'precision': 0.41676139829391695, 'recall': 0.403163801760293, 'f1-score': 0.40102033547373517, 'support': 1269675}}
[[189882 102141  65895]
 [237422 193695 125894]
 [106870 119566 128310]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0732435
{'0': {'precision': 0.3766569004389357, 'recall': 0.5295892271017207, 'f1-score': 0.44021912088564896, 'support': 391798}, '1': {'precision': 0.398268051052908, 'recall': 0.3166822335693742, 'f1-score': 0.3528201014239464, 'support': 486074}, '2': {'precision': 0.41899992777523654, 'recall': 0.3553622611363364, 'f1-score': 0.38456619882087945, 'support': 391803}, 'accuracy': 0.39431744344025044, 'macro avg': {'precision': 0.3979749597556934, 'recall': 0.40054457393581044, 'f1-score': 0.3925351403768249, 'support': 1269675}, 'weighted avg': {'precision': 0.3979968051885612, 'recall': 0.39431744344025044, 'f1-score': 0.38958618504807596, 'support': 1269675}}
[[207492 107390  76916]
 [215995 153931 116148]
 [127391 125180 139232]]
Evaluating performance on  train set...
1691/1691 - 16s - 16s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0413543
{'0': {'precision': 0.31425818400240263, 'recall': 0.5125311237193355, 'f1-score': 0.3896206655806377, 'support': 97996}, '1': {'precision': 0.6068045740086376, 'recall': 0.4155107664647517, 'f1-score': 0.4932603936548464, 'support': 238054}, '2': {'precision': 0.3553345635357107, 'recall': 0.4038598630037917, 'f1-score': 0.37804642166344293, 'support': 96791}, 'accuracy': 0.4348710034400623, 'macro avg': {'precision': 0.42546577384891693, 'recall': 0.4439672510626263, 'f1-score': 0.4203091602996423, 'support': 432841}, 'weighted avg': {'precision': 0.48433833393725795, 'recall': 0.4348710034400623, 'f1-score': 0.44403226056352624, 'support': 432841}}
[[50226 30084 17686]
 [85907 98914 53233]
 [23691 34010 39090]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0525427
{'0': {'precision': 0.37138512927035133, 'recall': 0.5125237505163156, 'f1-score': 0.4306862476267168, 'support': 121050}, '1': {'precision': 0.4917611375954627, 'recall': 0.37573263499189424, 'f1-score': 0.42598739922769463, 'support': 192456}, '2': {'precision': 0.40503280248608314, 'recall': 0.4030167176436083, 'f1-score': 0.40402224499739575, 'support': 119335}, 'accuracy': 0.4215104391681934, 'macro avg': {'precision': 0.42272635645063245, 'recall': 0.4304243677172727, 'f1-score': 0.4202319639506024, 'support': 432841}, 'weighted avg': {'precision': 0.43418516471389057, 'recall': 0.4215104391681934, 'f1-score': 0.4212456670873219, 'support': 432841}}
[[62041 35121 23888]
 [73385 72312 46759]
 [31627 39614 48094]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0611732
{'0': {'precision': 0.4043962471899803, 'recall': 0.5170702019387291, 'f1-score': 0.4538445201027179, 'support': 136378}, '1': {'precision': 0.4139134966128192, 'recall': 0.3416155174214636, 'f1-score': 0.37430534284339034, 'support': 162759}, '2': {'precision': 0.4323599307205865, 'recall': 0.40141656195775743, 'f1-score': 0.4163140564460768, 'support': 133704}, 'accuracy': 0.4153696160945936, 'macro avg': {'precision': 0.4168898915077954, 'recall': 0.42003409377265005, 'f1-score': 0.41482130646406173, 'support': 432841}, 'weighted avg': {'precision': 0.4166129141452549, 'recall': 0.4153696160945936, 'f1-score': 0.41234269826906894, 'support': 432841}}
[[70517 37249 28612]
 [65306 55601 41852]
 [38553 41480 53671]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.070606
{'0': {'precision': 0.42019877880287027, 'recall': 0.5153355789531221, 'f1-score': 0.46292983075294225, 'support': 146359}, '1': {'precision': 0.3578161351444264, 'recall': 0.31172340781189056, 'f1-score': 0.3331832038621737, 'support': 143576}, '2': {'precision': 0.4399597704733986, 'recall': 0.39488195037297247, 'f1-score': 0.4162038573588524, 'support': 142906}, 'accuracy': 0.4080274280856019, 'macro avg': {'precision': 0.40599156147356513, 'recall': 0.40731364571266165, 'f1-score': 0.4041056306579895, 'support': 432841}, 'weighted avg': {'precision': 0.4060303285630912, 'recall': 0.4080274280856019, 'f1-score': 0.4044651204867596, 'support': 432841}}
[[75424 38187 32748]
 [59735 44756 39085]
 [44337 42138 56431]]
Evaluating performance on  val set...
591/591 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0525737
{'0': {'precision': 0.3268144363283077, 'recall': 0.49860013175230566, 'f1-score': 0.39483122133588366, 'support': 36432}, '1': {'precision': 0.5702126199097353, 'recall': 0.4276557955159721, 'f1-score': 0.4887512778460113, 'support': 77698}, '2': {'precision': 0.3537475186437041, 'recall': 0.35637651001270165, 'f1-score': 0.3550571478574602, 'support': 37003}, 'accuracy': 0.4273057505640727, 'macro avg': {'precision': 0.4169248582939156, 'recall': 0.42754414576032646, 'f1-score': 0.41287988234645173, 'support': 151133}, 'weighted avg': {'precision': 0.458540511459658, 'recall': 0.4273057505640727, 'f1-score': 0.4333776705547954, 'support': 151133}}
[[18165 11433  6834]
 [27213 33228 17257]
 [10204 13612 13187]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0643613
{'0': {'precision': 0.3795851078444841, 'recall': 0.5028550629023819, 'f1-score': 0.4326101635205355, 'support': 43957}, '1': {'precision': 0.45692001073166993, 'recall': 0.38445290077074395, 'f1-score': 0.41756567425569174, 'support': 62018}, '2': {'precision': 0.4042338957243547, 'recall': 0.36449798485318213, 'f1-score': 0.38333896153801367, 'support': 45158}, 'accuracy': 0.41292768621015924, 'macro avg': {'precision': 0.41357967143350294, 'recall': 0.41726864950876935, 'f1-score': 0.4111715997714136, 'support': 151133}, 'weighted avg': {'precision': 0.4186847483620195, 'recall': 0.41292768621015924, 'f1-score': 0.41171454129141416, 'support': 151133}}
[[22104 12889  8964]
 [22880 23843 15295]
 [13248 15450 16460]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.07125
{'0': {'precision': 0.41121034193516554, 'recall': 0.5115708059664845, 'f1-score': 0.4559330379123584, 'support': 48873}, '1': {'precision': 0.38114945456088967, 'recall': 0.3457044408939537, 'f1-score': 0.36256271008509394, 'support': 51949}, '2': {'precision': 0.43303096218817977, 'recall': 0.3719464928146926, 'f1-score': 0.4001710772520717, 'support': 50311}, 'accuracy': 0.40807765345755065, 'macro avg': {'precision': 0.4084635862280783, 'recall': 0.40974057989171025, 'f1-score': 0.4062222750831747, 'support': 151133}, 'weighted avg': {'precision': 0.4081414171294854, 'recall': 0.40807765345755065, 'f1-score': 0.4052760989044763, 'support': 151133}}
[[25002 13234 10637]
 [20126 17959 13864]
 [15673 15925 18713]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0776894
{'0': {'precision': 0.43058414309192156, 'recall': 0.5130613331305373, 'f1-score': 0.46821837235731445, 'support': 52598}, '1': {'precision': 0.32069308994880585, 'recall': 0.3074941139887166, 'f1-score': 0.313954938712567, 'support': 45022}, '2': {'precision': 0.4472411737431278, 'recall': 0.37852484443032536, 'f1-score': 0.4100238856726448, 'support': 53513}, 'accuracy': 0.4041870405536845, 'macro avg': {'precision': 0.39950613559461834, 'recall': 0.39969343051652645, 'f1-score': 0.3973990655808421, 'support': 151133}, 'weighted avg': {'precision': 0.403745879354873, 'recall': 0.4041870405536845, 'f1-score': 0.40165838959041017, 'support': 151133}}
[[26986 13470 12142]
 [18285 13844 12893]
 [17402 15855 20256]]
training model: results/ATVI/W8/deepLOB_L2/seq2seq
Epoch 1/50
1691/1691 - 88s - loss: 12.1337 - accuracy10: 0.4796 - accuracy20: 0.4841 - accuracy30: 0.4796 - accuracy50: 0.4584 - val_loss: 14.4296 - val_accuracy10: 0.4795 - val_accuracy20: 0.4172 - val_accuracy30: 0.3754 - val_accuracy50: 0.3386 - 88s/epoch - 52ms/step
Epoch 2/50
1691/1691 - 82s - loss: 11.6695 - accuracy10: 0.5198 - accuracy20: 0.5200 - accuracy30: 0.5118 - accuracy50: 0.4840 - val_loss: 12.9352 - val_accuracy10: 0.4789 - val_accuracy20: 0.4670 - val_accuracy30: 0.4526 - val_accuracy50: 0.4284 - 82s/epoch - 48ms/step
Epoch 3/50
1691/1691 - 81s - loss: 11.3292 - accuracy10: 0.5576 - accuracy20: 0.5501 - accuracy30: 0.5347 - accuracy50: 0.5002 - val_loss: 12.8887 - val_accuracy10: 0.4961 - val_accuracy20: 0.4732 - val_accuracy30: 0.4542 - val_accuracy50: 0.4271 - 81s/epoch - 48ms/step
Epoch 4/50
1691/1691 - 81s - loss: 11.1463 - accuracy10: 0.5711 - accuracy20: 0.5620 - accuracy30: 0.5447 - accuracy50: 0.5070 - val_loss: 13.1296 - val_accuracy10: 0.4937 - val_accuracy20: 0.4714 - val_accuracy30: 0.4528 - val_accuracy50: 0.4247 - 81s/epoch - 48ms/step
Epoch 5/50
1691/1691 - 80s - loss: 11.0214 - accuracy10: 0.5795 - accuracy20: 0.5685 - accuracy30: 0.5505 - accuracy50: 0.5117 - val_loss: 12.6785 - val_accuracy10: 0.5087 - val_accuracy20: 0.4946 - val_accuracy30: 0.4789 - val_accuracy50: 0.4479 - 80s/epoch - 47ms/step
Epoch 6/50
1691/1691 - 79s - loss: 10.9139 - accuracy10: 0.5849 - accuracy20: 0.5736 - accuracy30: 0.5554 - accuracy50: 0.5163 - val_loss: 13.1179 - val_accuracy10: 0.5190 - val_accuracy20: 0.4867 - val_accuracy30: 0.4595 - val_accuracy50: 0.4218 - 79s/epoch - 47ms/step
Epoch 7/50
1691/1691 - 79s - loss: 10.8440 - accuracy10: 0.5884 - accuracy20: 0.5771 - accuracy30: 0.5588 - accuracy50: 0.5189 - val_loss: 12.7144 - val_accuracy10: 0.5021 - val_accuracy20: 0.4870 - val_accuracy30: 0.4717 - val_accuracy50: 0.4419 - 79s/epoch - 47ms/step
Epoch 8/50
1691/1691 - 79s - loss: 10.7945 - accuracy10: 0.5903 - accuracy20: 0.5791 - accuracy30: 0.5611 - accuracy50: 0.5210 - val_loss: 12.4421 - val_accuracy10: 0.5216 - val_accuracy20: 0.5098 - val_accuracy30: 0.4923 - val_accuracy50: 0.4578 - 79s/epoch - 47ms/step
Epoch 9/50
1691/1691 - 79s - loss: 10.7538 - accuracy10: 0.5926 - accuracy20: 0.5818 - accuracy30: 0.5631 - accuracy50: 0.5226 - val_loss: 12.2197 - val_accuracy10: 0.5367 - val_accuracy20: 0.5242 - val_accuracy30: 0.5061 - val_accuracy50: 0.4703 - 79s/epoch - 47ms/step
Epoch 10/50
1691/1691 - 79s - loss: 10.7175 - accuracy10: 0.5950 - accuracy20: 0.5839 - accuracy30: 0.5655 - accuracy50: 0.5246 - val_loss: 12.2492 - val_accuracy10: 0.5326 - val_accuracy20: 0.5222 - val_accuracy30: 0.5055 - val_accuracy50: 0.4693 - 79s/epoch - 47ms/step
Epoch 11/50
1691/1691 - 82s - loss: 10.6864 - accuracy10: 0.5964 - accuracy20: 0.5851 - accuracy30: 0.5672 - accuracy50: 0.5260 - val_loss: 12.0976 - val_accuracy10: 0.5339 - val_accuracy20: 0.5270 - val_accuracy30: 0.5118 - val_accuracy50: 0.4775 - 82s/epoch - 48ms/step
Epoch 12/50
1691/1691 - 80s - loss: 10.6543 - accuracy10: 0.5983 - accuracy20: 0.5876 - accuracy30: 0.5688 - accuracy50: 0.5274 - val_loss: 12.2302 - val_accuracy10: 0.5270 - val_accuracy20: 0.5200 - val_accuracy30: 0.5050 - val_accuracy50: 0.4719 - 80s/epoch - 47ms/step
Epoch 13/50
1691/1691 - 81s - loss: 10.6282 - accuracy10: 0.5995 - accuracy20: 0.5887 - accuracy30: 0.5702 - accuracy50: 0.5288 - val_loss: 12.0477 - val_accuracy10: 0.5305 - val_accuracy20: 0.5259 - val_accuracy30: 0.5128 - val_accuracy50: 0.4799 - 81s/epoch - 48ms/step
Epoch 14/50
1691/1691 - 80s - loss: 10.6071 - accuracy10: 0.5998 - accuracy20: 0.5900 - accuracy30: 0.5717 - accuracy50: 0.5295 - val_loss: 12.2544 - val_accuracy10: 0.5066 - val_accuracy20: 0.5092 - val_accuracy30: 0.5029 - val_accuracy50: 0.4752 - 80s/epoch - 47ms/step
Epoch 15/50
1691/1691 - 81s - loss: 10.5827 - accuracy10: 0.6014 - accuracy20: 0.5915 - accuracy30: 0.5728 - accuracy50: 0.5309 - val_loss: 12.1076 - val_accuracy10: 0.5157 - val_accuracy20: 0.5173 - val_accuracy30: 0.5083 - val_accuracy50: 0.4776 - 81s/epoch - 48ms/step
Epoch 16/50
1691/1691 - 80s - loss: 10.5579 - accuracy10: 0.6017 - accuracy20: 0.5930 - accuracy30: 0.5745 - accuracy50: 0.5321 - val_loss: 12.1468 - val_accuracy10: 0.5096 - val_accuracy20: 0.5135 - val_accuracy30: 0.5064 - val_accuracy50: 0.4783 - 80s/epoch - 47ms/step
Epoch 17/50
1691/1691 - 80s - loss: 10.5417 - accuracy10: 0.6029 - accuracy20: 0.5931 - accuracy30: 0.5751 - accuracy50: 0.5329 - val_loss: 12.0641 - val_accuracy10: 0.5138 - val_accuracy20: 0.5167 - val_accuracy30: 0.5095 - val_accuracy50: 0.4808 - 80s/epoch - 47ms/step
Epoch 18/50
1691/1691 - 79s - loss: 10.5207 - accuracy10: 0.6038 - accuracy20: 0.5952 - accuracy30: 0.5770 - accuracy50: 0.5348 - val_loss: 12.2755 - val_accuracy10: 0.5100 - val_accuracy20: 0.5116 - val_accuracy30: 0.5035 - val_accuracy50: 0.4735 - 79s/epoch - 47ms/step
Epoch 19/50
1691/1691 - 80s - loss: 10.5392 - accuracy10: 0.6021 - accuracy20: 0.5937 - accuracy30: 0.5762 - accuracy50: 0.5343 - val_loss: 11.8846 - val_accuracy10: 0.5363 - val_accuracy20: 0.5321 - val_accuracy30: 0.5192 - val_accuracy50: 0.4857 - 80s/epoch - 47ms/step
Epoch 20/50
1691/1691 - 80s - loss: 10.5000 - accuracy10: 0.6038 - accuracy20: 0.5959 - accuracy30: 0.5778 - accuracy50: 0.5358 - val_loss: 12.2013 - val_accuracy10: 0.5293 - val_accuracy20: 0.5255 - val_accuracy30: 0.5131 - val_accuracy50: 0.4796 - 80s/epoch - 48ms/step
Epoch 21/50
1691/1691 - 79s - loss: 10.4686 - accuracy10: 0.6057 - accuracy20: 0.5979 - accuracy30: 0.5797 - accuracy50: 0.5374 - val_loss: 12.4189 - val_accuracy10: 0.5143 - val_accuracy20: 0.5139 - val_accuracy30: 0.5033 - val_accuracy50: 0.4705 - 79s/epoch - 47ms/step
Epoch 22/50
1691/1691 - 80s - loss: 10.4476 - accuracy10: 0.6062 - accuracy20: 0.5986 - accuracy30: 0.5809 - accuracy50: 0.5385 - val_loss: 12.3455 - val_accuracy10: 0.5115 - val_accuracy20: 0.5132 - val_accuracy30: 0.5057 - val_accuracy50: 0.4748 - 80s/epoch - 47ms/step
Epoch 23/50
1691/1691 - 80s - loss: 10.4341 - accuracy10: 0.6070 - accuracy20: 0.5997 - accuracy30: 0.5820 - accuracy50: 0.5398 - val_loss: 12.1850 - val_accuracy10: 0.5191 - val_accuracy20: 0.5197 - val_accuracy30: 0.5104 - val_accuracy50: 0.4787 - 80s/epoch - 47ms/step
Epoch 24/50
1691/1691 - 80s - loss: 10.4185 - accuracy10: 0.6076 - accuracy20: 0.6004 - accuracy30: 0.5835 - accuracy50: 0.5409 - val_loss: 12.3728 - val_accuracy10: 0.5011 - val_accuracy20: 0.5076 - val_accuracy30: 0.5023 - val_accuracy50: 0.4750 - 80s/epoch - 47ms/step
Epoch 25/50
1691/1691 - 80s - loss: 10.3952 - accuracy10: 0.6085 - accuracy20: 0.6014 - accuracy30: 0.5846 - accuracy50: 0.5428 - val_loss: 12.2779 - val_accuracy10: 0.5018 - val_accuracy20: 0.5091 - val_accuracy30: 0.5043 - val_accuracy50: 0.4769 - 80s/epoch - 47ms/step
Epoch 26/50
1691/1691 - 80s - loss: 10.3766 - accuracy10: 0.6096 - accuracy20: 0.6030 - accuracy30: 0.5857 - accuracy50: 0.5434 - val_loss: 12.2967 - val_accuracy10: 0.5011 - val_accuracy20: 0.5106 - val_accuracy30: 0.5060 - val_accuracy50: 0.4786 - 80s/epoch - 47ms/step
Epoch 27/50
1691/1691 - 80s - loss: 10.3589 - accuracy10: 0.6108 - accuracy20: 0.6042 - accuracy30: 0.5873 - accuracy50: 0.5451 - val_loss: 12.2253 - val_accuracy10: 0.5107 - val_accuracy20: 0.5143 - val_accuracy30: 0.5079 - val_accuracy50: 0.4782 - 80s/epoch - 47ms/step
Epoch 28/50
1691/1691 - 82s - loss: 10.3456 - accuracy10: 0.6102 - accuracy20: 0.6048 - accuracy30: 0.5879 - accuracy50: 0.5455 - val_loss: 12.2783 - val_accuracy10: 0.5107 - val_accuracy20: 0.5138 - val_accuracy30: 0.5059 - val_accuracy50: 0.4769 - 82s/epoch - 49ms/step
Epoch 29/50
1691/1691 - 80s - loss: 10.3272 - accuracy10: 0.6105 - accuracy20: 0.6053 - accuracy30: 0.5887 - accuracy50: 0.5470 - val_loss: 12.3614 - val_accuracy10: 0.5020 - val_accuracy20: 0.5077 - val_accuracy30: 0.5034 - val_accuracy50: 0.4757 - 80s/epoch - 47ms/step
testing model: results/ATVI/W8/deepLOB_L2/seq2seq
Evaluating performance on  test set...
4960/4960 - 85s - 85s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0374943
{'0': {'precision': 0.33590809831343216, 'recall': 0.5796203876295272, 'f1-score': 0.42532632275618637, 'support': 249465}, '1': {'precision': 0.8718166586883677, 'recall': 0.37622348549892903, 'f1-score': 0.5256207559915546, 'support': 774529}, '2': {'precision': 0.34224721771159256, 'recall': 0.7034507460742574, 'f1-score': 0.46046577306018927, 'support': 245686}, 'accuracy': 0.4795058597441875, 'macro avg': {'precision': 0.516657324904464, 'recall': 0.5530982064009046, 'f1-score': 0.47047095060264343, 'support': 1269680}, 'weighted avg': {'precision': 0.6640491686989584, 'recall': 0.4795058597441875, 'f1-score': 0.49330740308094984, 'support': 1269680}}
[[144595  23945  80925]
 [231906 291396 251227]
 [ 53959  18899 172828]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0023812
{'0': {'precision': 0.3951119130412741, 'recall': 0.5452972642907573, 'f1-score': 0.45821212821708557, 'support': 314434}, '1': {'precision': 0.7972442452794055, 'recall': 0.38770828321084044, 'f1-score': 0.5217056214578047, 'support': 644255}, '2': {'precision': 0.4036453498054244, 'recall': 0.6780646385265169, 'f1-score': 0.5060462437455755, 'support': 310991}, 'accuracy': 0.4978537899313213, 'macro avg': {'precision': 0.5320005027087014, 'recall': 0.5370233953427048, 'f1-score': 0.49532133114015525, 'support': 1269680}, 'weighted avg': {'precision': 0.6012501429407742, 'recall': 0.4978537899313213, 'f1-score': 0.5021460170001806, 'support': 1269680}}
[[171460  35016 107958]
 [190883 249783 203589]
 [ 71610  28509 210872]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9831286
{'0': {'precision': 0.4242134872044933, 'recall': 0.5250125027589887, 'f1-score': 0.46926103367632716, 'support': 357921}, '1': {'precision': 0.7277297621802546, 'recall': 0.38955245049020576, 'f1-score': 0.5074616044846804, 'support': 557011}, '2': {'precision': 0.4360953182794275, 'recall': 0.6497457350006202, 'f1-score': 0.5219015660715074, 'support': 354748}, 'accuracy': 0.5004363304139626, 'macro avg': {'precision': 0.5293461892213918, 'recall': 0.5214368960832715, 'f1-score': 0.4995414014108383, 'support': 1269680}, 'weighted avg': {'precision': 0.5606864249925143, 'recall': 0.5004363304139626, 'f1-score': 0.5007274360238927, 'support': 1269680}}
[[187913  44262 125746]
 [167723 216985 172303]
 [ 87332  36920 230496]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9976827
{'0': {'precision': 0.4318585243078553, 'recall': 0.49924834290877257, 'f1-score': 0.4631147298402706, 'support': 391801}, '1': {'precision': 0.638889373475732, 'recall': 0.37672041705583925, 'f1-score': 0.47396681968248466, 'support': 486074}, '2': {'precision': 0.44839066865109684, 'recall': 0.6066895522007121, 'f1-score': 0.5156649297345142, 'support': 391805}, 'accuracy': 0.48549555793585786, 'macro avg': {'precision': 0.5063795221448947, 'recall': 0.49421943738844126, 'f1-score': 0.4842488264190898, 'support': 1269680}, 'weighted avg': {'precision': 0.5162181186881954, 'recall': 0.48549555793585786, 'f1-score': 0.48348549238479244, 'support': 1269680}}
[[195606  54407 141788]
 [152325 183114 150635]
 [105009  49092 237704]]
Evaluating performance on  train set...
1691/1691 - 29s - 29s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9634242
{'0': {'precision': 0.4440966176416108, 'recall': 0.48803574518325515, 'f1-score': 0.4650305736993449, 'support': 98251}, '1': {'precision': 0.8202513230458631, 'recall': 0.46424190485792544, 'f1-score': 0.5929109292300098, 'support': 238044}, '2': {'precision': 0.373478135107418, 'recall': 0.7355332525453396, 'f1-score': 0.4954062519620222, 'support': 96549}, 'accuracy': 0.5301563611832438, 'macro avg': {'precision': 0.545942025264964, 'recall': 0.5626036341955067, 'f1-score': 0.5177825849637923, 'support': 432844}, 'weighted avg': {'precision': 0.6352121854282871, 'recall': 0.5301563611832438, 'f1-score': 0.5421343171092682, 'support': 432844}}
[[ 47950  14032  36269]
 [ 44673 110510  82861]
 [ 15349  10185  71015]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9507396
{'0': {'precision': 0.5034438364982298, 'recall': 0.45129460642480895, 'f1-score': 0.4759449873074381, 'support': 121311}, '1': {'precision': 0.7270519782777347, 'recall': 0.4871376369013894, 'f1-score': 0.5833922118506114, 'support': 192383}, '2': {'precision': 0.4309243387517354, 'recall': 0.7059672681493915, 'f1-score': 0.5351758714040763, 'support': 119150}, 'accuracy': 0.5373298463187661, 'macro avg': {'precision': 0.5538067178425666, 'recall': 0.5481331704918633, 'f1-score': 0.531504356854042, 'support': 432844}, 'weighted avg': {'precision': 0.5828666931936483, 'recall': 0.5373298463187661, 'f1-score': 0.5400058943303002, 'support': 432844}}
[[54747 19981 46583]
 [34166 93717 64500]
 [19832 15202 84116]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.95180273
{'0': {'precision': 0.5291950936275222, 'recall': 0.4269069192148367, 'f1-score': 0.4725793776179018, 'support': 136634}, '1': {'precision': 0.6442525582615748, 'recall': 0.49823829991329854, 'f1-score': 0.5619148670577955, 'support': 162627}, '2': {'precision': 0.4601449827534531, 'recall': 0.6780802946482711, 'f1-score': 0.5482486669047374, 'support': 133583}, 'accuracy': 0.5312237203241814, 'macro avg': {'precision': 0.5445308782141833, 'recall': 0.5344085045921355, 'f1-score': 0.5275809705268116, 'support': 432844}, 'weighted avg': {'precision': 0.5511141437706483, 'recall': 0.5312237203241814, 'f1-score': 0.5294970969623883, 'support': 432844}}
[[58330 25170 53134]
 [28463 81027 53137]
 [23431 19572 90580]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.990983
{'0': {'precision': 0.5183733156298782, 'recall': 0.39464661366554654, 'f1-score': 0.44812663352437976, 'support': 146412}, '1': {'precision': 0.5482804924135823, 'recall': 0.47515452207906234, 'f1-score': 0.5091050269903014, 'support': 143507}, '2': {'precision': 0.46174579084416606, 'recall': 0.6364806716809516, 'f1-score': 0.5352125105902288, 'support': 142925}, 'accuracy': 0.5011921154041641, 'macro avg': {'precision': 0.5094665329625422, 'recall': 0.5020939358085202, 'f1-score': 0.4974813903683033, 'support': 432844}, 'weighted avg': {'precision': 0.509590475250206, 'recall': 0.5011921154041641, 'f1-score': 0.497099416538007, 'support': 432844}}
[[57781 30981 57650]
 [26927 68188 48392]
 [26758 25198 90969]]
Evaluating performance on  val set...
591/591 - 10s - 10s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9530445
{'0': {'precision': 0.4594836032505331, 'recall': 0.43815778626583496, 'f1-score': 0.44856736950192005, 'support': 36391}, '1': {'precision': 0.7735374001308459, 'recall': 0.5026473429951691, 'f1-score': 0.6093420580013431, 'support': 77625}, '2': {'precision': 0.39540240335803367, 'recall': 0.7029742981841695, 'f1-score': 0.5061245866025275, 'support': 37118}, 'accuracy': 0.5363187634814138, 'macro avg': {'precision': 0.542807802246471, 'recall': 0.5479264758150578, 'f1-score': 0.5213446713685969, 'support': 151134}, 'weighted avg': {'precision': 0.6050488632530772, 'recall': 0.5363187634814138, 'f1-score': 0.5452798496791671, 'support': 151134}}
[[15945  6540 13906]
 [12615 39018 25992]
 [ 6142  4883 26093]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.96301526
{'0': {'precision': 0.5020808391767858, 'recall': 0.4006004230253133, 'f1-score': 0.4456363613363525, 'support': 43969}, '1': {'precision': 0.6685425685425685, 'recall': 0.5240526783550133, 'f1-score': 0.5875447257575072, 'support': 61885}, '2': {'precision': 0.4497645909212046, 'recall': 0.6708922261484099, 'f1-score': 0.5385119923419192, 'support': 45280}, 'accuracy': 0.5321304273029233, 'macro avg': {'precision': 0.5401293328801863, 'recall': 0.5318484425095789, 'f1-score': 0.5238976931452596, 'support': 151134}, 'weighted avg': {'precision': 0.5545680650874926, 'recall': 0.5321304273029233, 'f1-score': 0.5315694253996024, 'support': 151134}}
[[17614  8963 17392]
 [ 9682 32431 19772]
 [ 7786  7116 30378]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.977265
{'0': {'precision': 0.5187959378331369, 'recall': 0.37881519111803025, 'f1-score': 0.4378906989960219, 'support': 48818}, '1': {'precision': 0.5817830596732877, 'recall': 0.5335849637960253, 'f1-score': 0.5566426261124616, 'support': 51928}, '2': {'precision': 0.47521440570569684, 'recall': 0.6400134952766532, 'f1-score': 0.5454376321353066, 'support': 50388}, 'accuracy': 0.5190757870499028, 'macro avg': {'precision': 0.5252644677373738, 'recall': 0.5174712167302362, 'f1-score': 0.5133236524145968, 'support': 151134}, 'weighted avg': {'precision': 0.5259075673941749, 'recall': 0.5190757870499028, 'f1-score': 0.5145486643666516, 'support': 151134}}
[[18493 10952 19373]
 [ 7980 27708 16240]
 [ 9173  8966 32249]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0212244
{'0': {'precision': 0.5059463039099362, 'recall': 0.3486196668948209, 'f1-score': 0.4128009725677364, 'support': 52596}, '1': {'precision': 0.4848210335601576, 'recall': 0.5123906218689467, 'f1-score': 0.4982247239662265, 'support': 44913}, '2': {'precision': 0.47253285082905705, 'recall': 0.5941445221445222, 'f1-score': 0.5264062254752129, 'support': 53625}, 'accuracy': 0.48440456813159183, 'macro avg': {'precision': 0.4877667294330503, 'recall': 0.48505160363609656, 'f1-score': 0.4791439740030586, 'support': 151134}, 'weighted avg': {'precision': 0.48781275561053467, 'recall': 0.48440456813159183, 'f1-score': 0.478495777401353, 'support': 151134}}
[[18336 13199 21061]
 [ 7396 23013 14504]
 [10509 11255 31861]]
training model: results/ATVI/W8/deepOF_L2/seq2seq
Epoch 1/50
1691/1691 - 57s - loss: 11.7495 - accuracy10: 0.5288 - accuracy20: 0.5222 - accuracy30: 0.5071 - accuracy50: 0.4765 - val_loss: 12.0022 - val_accuracy10: 0.5638 - val_accuracy20: 0.5384 - val_accuracy30: 0.5104 - val_accuracy50: 0.4644 - 57s/epoch - 34ms/step
Epoch 2/50
1691/1691 - 49s - loss: 11.0846 - accuracy10: 0.5766 - accuracy20: 0.5665 - accuracy30: 0.5480 - accuracy50: 0.5094 - val_loss: 11.8655 - val_accuracy10: 0.5700 - val_accuracy20: 0.5474 - val_accuracy30: 0.5211 - val_accuracy50: 0.4755 - 49s/epoch - 29ms/step
Epoch 3/50
1691/1691 - 50s - loss: 10.9427 - accuracy10: 0.5855 - accuracy20: 0.5740 - accuracy30: 0.5548 - accuracy50: 0.5149 - val_loss: 11.7773 - val_accuracy10: 0.5798 - val_accuracy20: 0.5536 - val_accuracy30: 0.5267 - val_accuracy50: 0.4811 - 50s/epoch - 29ms/step
Epoch 4/50
1691/1691 - 51s - loss: 10.8652 - accuracy10: 0.5900 - accuracy20: 0.5785 - accuracy30: 0.5590 - accuracy50: 0.5190 - val_loss: 11.7969 - val_accuracy10: 0.5824 - val_accuracy20: 0.5558 - val_accuracy30: 0.5277 - val_accuracy50: 0.4815 - 51s/epoch - 30ms/step
Epoch 5/50
1691/1691 - 48s - loss: 10.8158 - accuracy10: 0.5928 - accuracy20: 0.5802 - accuracy30: 0.5607 - accuracy50: 0.5198 - val_loss: 11.7555 - val_accuracy10: 0.5817 - val_accuracy20: 0.5562 - val_accuracy30: 0.5291 - val_accuracy50: 0.4843 - 48s/epoch - 28ms/step
Epoch 6/50
1691/1691 - 49s - loss: 10.7788 - accuracy10: 0.5943 - accuracy20: 0.5816 - accuracy30: 0.5623 - accuracy50: 0.5218 - val_loss: 11.6565 - val_accuracy10: 0.5844 - val_accuracy20: 0.5594 - val_accuracy30: 0.5330 - val_accuracy50: 0.4870 - 49s/epoch - 29ms/step
Epoch 7/50
1691/1691 - 51s - loss: 10.7417 - accuracy10: 0.5959 - accuracy20: 0.5838 - accuracy30: 0.5650 - accuracy50: 0.5236 - val_loss: 11.6336 - val_accuracy10: 0.5848 - val_accuracy20: 0.5611 - val_accuracy30: 0.5350 - val_accuracy50: 0.4891 - 51s/epoch - 30ms/step
Epoch 8/50
1691/1691 - 49s - loss: 10.7094 - accuracy10: 0.5973 - accuracy20: 0.5853 - accuracy30: 0.5665 - accuracy50: 0.5252 - val_loss: 11.5880 - val_accuracy10: 0.5851 - val_accuracy20: 0.5616 - val_accuracy30: 0.5350 - val_accuracy50: 0.4897 - 49s/epoch - 29ms/step
Epoch 9/50
1691/1691 - 50s - loss: 10.6770 - accuracy10: 0.5987 - accuracy20: 0.5874 - accuracy30: 0.5684 - accuracy50: 0.5273 - val_loss: 11.5614 - val_accuracy10: 0.5893 - val_accuracy20: 0.5638 - val_accuracy30: 0.5364 - val_accuracy50: 0.4905 - 50s/epoch - 30ms/step
Epoch 10/50
1691/1691 - 51s - loss: 10.6506 - accuracy10: 0.6006 - accuracy20: 0.5889 - accuracy30: 0.5693 - accuracy50: 0.5275 - val_loss: 11.5449 - val_accuracy10: 0.5860 - val_accuracy20: 0.5632 - val_accuracy30: 0.5377 - val_accuracy50: 0.4925 - 51s/epoch - 30ms/step
Epoch 11/50
1691/1691 - 53s - loss: 10.6293 - accuracy10: 0.6013 - accuracy20: 0.5894 - accuracy30: 0.5707 - accuracy50: 0.5292 - val_loss: 11.5339 - val_accuracy10: 0.5867 - val_accuracy20: 0.5630 - val_accuracy30: 0.5361 - val_accuracy50: 0.4912 - 53s/epoch - 31ms/step
Epoch 12/50
1691/1691 - 52s - loss: 10.6026 - accuracy10: 0.6026 - accuracy20: 0.5913 - accuracy30: 0.5721 - accuracy50: 0.5306 - val_loss: 11.5057 - val_accuracy10: 0.5846 - val_accuracy20: 0.5624 - val_accuracy30: 0.5365 - val_accuracy50: 0.4911 - 52s/epoch - 31ms/step
Epoch 13/50
1691/1691 - 52s - loss: 10.5760 - accuracy10: 0.6036 - accuracy20: 0.5930 - accuracy30: 0.5736 - accuracy50: 0.5321 - val_loss: 11.5202 - val_accuracy10: 0.5853 - val_accuracy20: 0.5629 - val_accuracy30: 0.5362 - val_accuracy50: 0.4936 - 52s/epoch - 31ms/step
Epoch 14/50
1691/1691 - 49s - loss: 10.5567 - accuracy10: 0.6045 - accuracy20: 0.5937 - accuracy30: 0.5747 - accuracy50: 0.5329 - val_loss: 11.4959 - val_accuracy10: 0.5831 - val_accuracy20: 0.5611 - val_accuracy30: 0.5367 - val_accuracy50: 0.4937 - 49s/epoch - 29ms/step
Epoch 15/50
1691/1691 - 49s - loss: 10.5336 - accuracy10: 0.6054 - accuracy20: 0.5951 - accuracy30: 0.5760 - accuracy50: 0.5343 - val_loss: 11.4077 - val_accuracy10: 0.5846 - val_accuracy20: 0.5649 - val_accuracy30: 0.5407 - val_accuracy50: 0.4968 - 49s/epoch - 29ms/step
Epoch 16/50
1691/1691 - 49s - loss: 10.5109 - accuracy10: 0.6059 - accuracy20: 0.5955 - accuracy30: 0.5769 - accuracy50: 0.5354 - val_loss: 11.4174 - val_accuracy10: 0.5850 - val_accuracy20: 0.5646 - val_accuracy30: 0.5405 - val_accuracy50: 0.4982 - 49s/epoch - 29ms/step
Epoch 17/50
1691/1691 - 50s - loss: 10.4870 - accuracy10: 0.6072 - accuracy20: 0.5969 - accuracy30: 0.5781 - accuracy50: 0.5375 - val_loss: 11.4782 - val_accuracy10: 0.5813 - val_accuracy20: 0.5612 - val_accuracy30: 0.5363 - val_accuracy50: 0.4947 - 50s/epoch - 29ms/step
Epoch 18/50
1691/1691 - 50s - loss: 10.4683 - accuracy10: 0.6074 - accuracy20: 0.5982 - accuracy30: 0.5800 - accuracy50: 0.5386 - val_loss: 11.5007 - val_accuracy10: 0.5864 - val_accuracy20: 0.5625 - val_accuracy30: 0.5368 - val_accuracy50: 0.4931 - 50s/epoch - 29ms/step
Epoch 19/50
1691/1691 - 51s - loss: 10.4510 - accuracy10: 0.6084 - accuracy20: 0.5987 - accuracy30: 0.5806 - accuracy50: 0.5401 - val_loss: 11.4302 - val_accuracy10: 0.5800 - val_accuracy20: 0.5606 - val_accuracy30: 0.5371 - val_accuracy50: 0.4968 - 51s/epoch - 30ms/step
Epoch 20/50
1691/1691 - 50s - loss: 10.4256 - accuracy10: 0.6092 - accuracy20: 0.6007 - accuracy30: 0.5825 - accuracy50: 0.5413 - val_loss: 11.4785 - val_accuracy10: 0.5787 - val_accuracy20: 0.5605 - val_accuracy30: 0.5374 - val_accuracy50: 0.4974 - 50s/epoch - 30ms/step
Epoch 21/50
1691/1691 - 50s - loss: 10.4099 - accuracy10: 0.6095 - accuracy20: 0.6016 - accuracy30: 0.5832 - accuracy50: 0.5424 - val_loss: 11.4916 - val_accuracy10: 0.5769 - val_accuracy20: 0.5586 - val_accuracy30: 0.5356 - val_accuracy50: 0.4957 - 50s/epoch - 29ms/step
Epoch 22/50
1691/1691 - 49s - loss: 10.3907 - accuracy10: 0.6098 - accuracy20: 0.6019 - accuracy30: 0.5843 - accuracy50: 0.5436 - val_loss: 11.4530 - val_accuracy10: 0.5790 - val_accuracy20: 0.5601 - val_accuracy30: 0.5379 - val_accuracy50: 0.4960 - 49s/epoch - 29ms/step
Epoch 23/50
1691/1691 - 49s - loss: 10.3750 - accuracy10: 0.6105 - accuracy20: 0.6027 - accuracy30: 0.5846 - accuracy50: 0.5447 - val_loss: 11.4985 - val_accuracy10: 0.5774 - val_accuracy20: 0.5592 - val_accuracy30: 0.5358 - val_accuracy50: 0.4946 - 49s/epoch - 29ms/step
Epoch 24/50
1691/1691 - 50s - loss: 10.3533 - accuracy10: 0.6111 - accuracy20: 0.6037 - accuracy30: 0.5860 - accuracy50: 0.5466 - val_loss: 11.5411 - val_accuracy10: 0.5776 - val_accuracy20: 0.5588 - val_accuracy30: 0.5340 - val_accuracy50: 0.4927 - 50s/epoch - 30ms/step
Epoch 25/50
1691/1691 - 50s - loss: 10.3311 - accuracy10: 0.6116 - accuracy20: 0.6053 - accuracy30: 0.5879 - accuracy50: 0.5479 - val_loss: 11.5467 - val_accuracy10: 0.5798 - val_accuracy20: 0.5588 - val_accuracy30: 0.5345 - val_accuracy50: 0.4943 - 50s/epoch - 29ms/step
testing model: results/ATVI/W8/deepOF_L2/seq2seq
Evaluating performance on  test set...
4960/4960 - 50s - 50s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.815235
{'0': {'precision': 0.4224229789205467, 'recall': 0.5848105122223024, 'f1-score': 0.49052657769887464, 'support': 249462}, '1': {'precision': 0.7976593202099893, 'recall': 0.6928890885803999, 'f1-score': 0.7415920692256883, 'support': 774528}, '2': {'precision': 0.4631499012003069, 'recall': 0.4741477908704235, 'f1-score': 0.4685843235372201, 'support': 245685}, 'accuracy': 0.6293271900289444, 'macro avg': {'precision': 0.561077400110281, 'recall': 0.5839491305577086, 'f1-score': 0.5669009901539277, 'support': 1269675}, 'weighted avg': {'precision': 0.6592056570441078, 'recall': 0.6293271900289444, 'f1-score': 0.6394358421228996, 'support': 1269675}}
[[145888  64699  38875]
 [141713 536662  96153]
 [ 57759  71435 116491]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.85736555
{'0': {'precision': 0.47646275858244136, 'recall': 0.5464520150620802, 'f1-score': 0.5090630055166121, 'support': 314432}, '1': {'precision': 0.7072257447805617, 'recall': 0.7074057747410183, 'f1-score': 0.707315748305232, 'support': 644254}, '2': {'precision': 0.5157819957148849, 'recall': 0.43890619925463603, 'f1-score': 0.4742489046707411, 'support': 310989}, 'accuracy': 0.6017807706696595, 'macro avg': {'precision': 0.5664901663592959, 'recall': 0.5642546630192449, 'f1-score': 0.5635425528308619, 'support': 1269675}, 'weighted avg': {'precision': 0.603186390335973, 'recall': 0.6017807706696595, 'f1-score': 0.601132487978331, 'support': 1269675}}
[[171822  91522  51088]
 [111451 455749  77054]
 [ 77347  97147 136495]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8973248
{'0': {'precision': 0.4982922719613826, 'recall': 0.5197112187707799, 'f1-score': 0.5087764164322415, 'support': 357918}, '1': {'precision': 0.631875865731277, 'recall': 0.7092229776431704, 'f1-score': 0.6683189463756287, 'support': 557011}, '2': {'precision': 0.5343575068774016, 'recall': 0.4084781787532488, 'f1-score': 0.463014679098421, 'support': 354746}, 'accuracy': 0.5717723039360466, 'macro avg': {'precision': 0.5548418815233537, 'recall': 0.545804125055733, 'f1-score': 0.5467033473020971, 'support': 1269675}, 'weighted avg': {'precision': 0.5669724688423803, 'recall': 0.5717723039360466, 'f1-score': 0.565982513168865, 'support': 1269675}}
[[186014 112702  59202]
 [ 94896 395045  67070]
 [ 92393 117447 144906]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.96099985
{'0': {'precision': 0.49303257934935757, 'recall': 0.4796093905532953, 'f1-score': 0.48622835991404123, 'support': 391798}, '1': {'precision': 0.5436565473128043, 'recall': 0.6934849426219053, 'f1-score': 0.6094979961251489, 'support': 486074}, '2': {'precision': 0.5219339244947134, 'recall': 0.3576925138398634, 'f1-score': 0.4244798686685425, 'support': 391803}, 'accuracy': 0.5238663437493847, 'macro avg': {'precision': 0.5195410170522917, 'recall': 0.5102622823383547, 'f1-score': 0.5067354082359109, 'support': 1269675}, 'weighted avg': {'precision': 0.5213316545740019, 'recall': 0.5238663437493847, 'f1-score': 0.5143654194262927, 'support': 1269675}}
[[187910 137806  66082]
 [ 86705 337085  62284]
 [106516 145142 140145]]
Evaluating performance on  train set...
1691/1691 - 18s - 18s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.840396
{'0': {'precision': 0.4579422022154281, 'recall': 0.6083309522837667, 'f1-score': 0.522531050864691, 'support': 97996}, '1': {'precision': 0.777814949817746, 'recall': 0.6543599351407664, 'f1-score': 0.7107664649893686, 'support': 238054}, '2': {'precision': 0.4908636332561796, 'recall': 0.5192734861712349, 'f1-score': 0.5046690497228693, 'support': 96791}, 'accuracy': 0.6137311391480936, 'macro avg': {'precision': 0.5755402617631179, 'recall': 0.5939881245319226, 'f1-score': 0.579322188525643, 'support': 432841}, 'weighted avg': {'precision': 0.6412277165026319, 'recall': 0.6137311391480936, 'f1-score': 0.6220625470065028, 'support': 432841}}
[[ 59614  21913  16469]
 [ 46618 155773  35663]
 [ 23946  22584  50261]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.86919826
{'0': {'precision': 0.5106156405990017, 'recall': 0.5704089219330855, 'f1-score': 0.5388586479367866, 'support': 121050}, '1': {'precision': 0.6790413311693427, 'recall': 0.6717483476742736, 'f1-score': 0.6753751518238452, 'support': 192456}, '2': {'precision': 0.5398453747656841, 'recall': 0.4850714375497549, 'f1-score': 0.510994782885038, 'support': 119335}, 'accuracy': 0.5919402274738299, 'macro avg': {'precision': 0.5765007821780094, 'recall': 0.5757429023857047, 'f1-score': 0.5750761942152233, 'support': 432841}, 'weighted avg': {'precision': 0.593562184552062, 'recall': 0.5919402274738299, 'f1-score': 0.5918764672656794, 'support': 432841}}
[[ 69048  30574  21428]
 [ 35261 129282  27913]
 [ 30916  30533  57886]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9025347
{'0': {'precision': 0.5304707256094503, 'recall': 0.5429761398466029, 'f1-score': 0.5366505900982349, 'support': 136378}, '1': {'precision': 0.5975541514774512, 'recall': 0.6757844420277834, 'f1-score': 0.6342661738162653, 'support': 162759}, '2': {'precision': 0.5569741988074848, 'recall': 0.4548181056662478, 'f1-score': 0.5007390328756407, 'support': 133704}, 'accuracy': 0.5656834726839648, 'macro avg': {'precision': 0.5616663586314621, 'recall': 0.5578595625135447, 'f1-score': 0.557218598930047, 'support': 432841}, 'weighted avg': {'precision': 0.5638826521397927, 'recall': 0.5656834726839648, 'f1-score': 0.5622634501172099, 'support': 432841}}
[[ 74050  37625  24703]
 [ 29102 109990  23667]
 [ 36441  36452  60811]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.96236795
{'0': {'precision': 0.5133786752872357, 'recall': 0.5012947615110789, 'f1-score': 0.507264763735295, 'support': 146359}, '1': {'precision': 0.5096269884805266, 'recall': 0.647078898980331, 'f1-score': 0.5701862057960696, 'support': 143576}, '2': {'precision': 0.5412582344578962, 'recall': 0.4076385876030398, 'f1-score': 0.4650405335824024, 'support': 142906}, 'accuracy': 0.5187308965647894, 'macro avg': {'precision': 0.5214212994085529, 'recall': 0.5186707493648165, 'f1-score': 0.5141638343712557, 'support': 432841}, 'weighted avg': {'precision': 0.5213388826102072, 'recall': 0.5187308965647894, 'f1-score': 0.5141955145908944, 'support': 432841}}
[[73369 46021 26969]
 [28267 92905 22404]
 [41278 43374 58254]]
Evaluating performance on  val set...
591/591 - 6s - 6s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.888361
{'0': {'precision': 0.4460561739060554, 'recall': 0.609409310496267, 'f1-score': 0.5150917569542723, 'support': 36432}, '1': {'precision': 0.7628303226315374, 'recall': 0.6223068804859841, 'f1-score': 0.6854404853880339, 'support': 77698}, '2': {'precision': 0.46792542265760784, 'recall': 0.4802043077588304, 'f1-score': 0.4739853555090228, 'support': 37003}, 'accuracy': 0.5844057882791978, 'macro avg': {'precision': 0.5589373063984002, 'recall': 0.5706401662470272, 'f1-score': 0.5581725326171096, 'support': 151133}, 'weighted avg': {'precision': 0.6142652719801107, 'recall': 0.5844057882791978, 'f1-score': 0.5926042481320287, 'support': 151133}}
[[22202  7066  7164]
 [16305 48352 13041]
 [11267  7967 17769]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9124947
{'0': {'precision': 0.4868299267258002, 'recall': 0.5743567577405192, 'f1-score': 0.526983729400837, 'support': 43957}, '1': {'precision': 0.6596145510319763, 'recall': 0.6379599471121288, 'f1-score': 0.6486065573770492, 'support': 62018}, '2': {'precision': 0.5204754269425568, 'recall': 0.452854422250764, 'f1-score': 0.4843159776906772, 'support': 45158}, 'accuracy': 0.564152104437813, 'macro avg': {'precision': 0.5556399682334444, 'recall': 0.555057042367804, 'f1-score': 0.5533020881561878, 'support': 151133}, 'weighted avg': {'precision': 0.5677859080734128, 'recall': 0.564152104437813, 'f1-score': 0.5641431466935615, 'support': 151133}}
[[25247  9829  8881]
 [12493 39565  9960]
 [14120 10588 20450]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9380708
{'0': {'precision': 0.5019117264931883, 'recall': 0.5533116444662697, 'f1-score': 0.5263598407801383, 'support': 48873}, '1': {'precision': 0.5738882652620672, 'recall': 0.6396850757473677, 'f1-score': 0.6050030039871103, 'support': 51949}, '2': {'precision': 0.5375857687420584, 'recall': 0.42046470950686726, 'f1-score': 0.471866251770558, 'support': 50311}, 'accuracy': 0.538777103610727, 'macro avg': {'precision': 0.5377952534991046, 'recall': 0.5378204765735015, 'f1-score': 0.5344096988459356, 'support': 151133}, 'weighted avg': {'precision': 0.5385278589863393, 'recall': 0.538777103610727, 'f1-score': 0.5352513914591958, 'support': 151133}}
[[27042 11972  9859]
 [10381 33231  8337]
 [16455 12702 21154]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9905855
{'0': {'precision': 0.49237496191961005, 'recall': 0.5223772767025362, 'f1-score': 0.5069325928727595, 'support': 52598}, '1': {'precision': 0.48106166783461807, 'recall': 0.609901825774066, 'f1-score': 0.5378738908150673, 'support': 45022}, '2': {'precision': 0.5235555555555556, 'recall': 0.3742268233887093, 'f1-score': 0.4364722164706908, 'support': 53513}, 'accuracy': 0.49599359504542356, 'macro avg': {'precision': 0.4989973951032612, 'recall': 0.5021686419551039, 'f1-score': 0.4937595667195058, 'support': 151133}, 'weighted avg': {'precision': 0.5000451595663572, 'recall': 0.49599359504542356, 'f1-score': 0.49120136933822156, 'support': 151133}}
[[27476 14593 10529]
 [ 9868 27459  7695]
 [18459 15028 20026]]
training model: results/ATVI/W8/deepVOL_L2/seq2seq
Epoch 1/50
1691/1691 - 57s - loss: 12.2736 - accuracy10: 0.4796 - accuracy20: 0.4790 - accuracy30: 0.4697 - accuracy50: 0.4463 - val_loss: 12.8135 - val_accuracy10: 0.5220 - val_accuracy20: 0.4937 - val_accuracy30: 0.4667 - val_accuracy50: 0.4304 - 57s/epoch - 34ms/step
Epoch 2/50
1691/1691 - 49s - loss: 11.4908 - accuracy10: 0.5418 - accuracy20: 0.5360 - accuracy30: 0.5222 - accuracy50: 0.4900 - val_loss: 12.2180 - val_accuracy10: 0.5300 - val_accuracy20: 0.5182 - val_accuracy30: 0.4978 - val_accuracy50: 0.4601 - 49s/epoch - 29ms/step
Epoch 3/50
1691/1691 - 49s - loss: 11.1971 - accuracy10: 0.5683 - accuracy20: 0.5576 - accuracy30: 0.5405 - accuracy50: 0.5043 - val_loss: 12.0667 - val_accuracy10: 0.5398 - val_accuracy20: 0.5236 - val_accuracy30: 0.5025 - val_accuracy50: 0.4649 - 49s/epoch - 29ms/step
Epoch 4/50
1691/1691 - 49s - loss: 11.0897 - accuracy10: 0.5768 - accuracy20: 0.5661 - accuracy30: 0.5475 - accuracy50: 0.5093 - val_loss: 12.0160 - val_accuracy10: 0.5513 - val_accuracy20: 0.5333 - val_accuracy30: 0.5087 - val_accuracy50: 0.4690 - 49s/epoch - 29ms/step
Epoch 5/50
1691/1691 - 50s - loss: 11.0149 - accuracy10: 0.5822 - accuracy20: 0.5705 - accuracy30: 0.5514 - accuracy50: 0.5125 - val_loss: 12.0239 - val_accuracy10: 0.5662 - val_accuracy20: 0.5429 - val_accuracy30: 0.5148 - val_accuracy50: 0.4725 - 50s/epoch - 30ms/step
Epoch 6/50
1691/1691 - 50s - loss: 10.9479 - accuracy10: 0.5863 - accuracy20: 0.5747 - accuracy30: 0.5552 - accuracy50: 0.5149 - val_loss: 11.9220 - val_accuracy10: 0.5643 - val_accuracy20: 0.5431 - val_accuracy30: 0.5173 - val_accuracy50: 0.4761 - 50s/epoch - 30ms/step
Epoch 7/50
1691/1691 - 49s - loss: 10.8954 - accuracy10: 0.5888 - accuracy20: 0.5775 - accuracy30: 0.5578 - accuracy50: 0.5170 - val_loss: 11.9477 - val_accuracy10: 0.5631 - val_accuracy20: 0.5441 - val_accuracy30: 0.5164 - val_accuracy50: 0.4737 - 49s/epoch - 29ms/step
Epoch 8/50
1691/1691 - 48s - loss: 10.8522 - accuracy10: 0.5911 - accuracy20: 0.5796 - accuracy30: 0.5598 - accuracy50: 0.5186 - val_loss: 11.8654 - val_accuracy10: 0.5643 - val_accuracy20: 0.5455 - val_accuracy30: 0.5198 - val_accuracy50: 0.4768 - 48s/epoch - 29ms/step
Epoch 9/50
1691/1691 - 50s - loss: 10.8178 - accuracy10: 0.5931 - accuracy20: 0.5817 - accuracy30: 0.5616 - accuracy50: 0.5199 - val_loss: 11.8535 - val_accuracy10: 0.5671 - val_accuracy20: 0.5478 - val_accuracy30: 0.5213 - val_accuracy50: 0.4772 - 50s/epoch - 29ms/step
Epoch 10/50
1691/1691 - 50s - loss: 10.7877 - accuracy10: 0.5941 - accuracy20: 0.5833 - accuracy30: 0.5636 - accuracy50: 0.5221 - val_loss: 11.8219 - val_accuracy10: 0.5665 - val_accuracy20: 0.5490 - val_accuracy30: 0.5237 - val_accuracy50: 0.4801 - 50s/epoch - 29ms/step
Epoch 11/50
1691/1691 - 49s - loss: 10.7648 - accuracy10: 0.5957 - accuracy20: 0.5850 - accuracy30: 0.5642 - accuracy50: 0.5228 - val_loss: 11.7994 - val_accuracy10: 0.5713 - val_accuracy20: 0.5520 - val_accuracy30: 0.5249 - val_accuracy50: 0.4810 - 49s/epoch - 29ms/step
Epoch 12/50
1691/1691 - 48s - loss: 10.7394 - accuracy10: 0.5966 - accuracy20: 0.5859 - accuracy30: 0.5661 - accuracy50: 0.5239 - val_loss: 11.8068 - val_accuracy10: 0.5606 - val_accuracy20: 0.5456 - val_accuracy30: 0.5226 - val_accuracy50: 0.4801 - 48s/epoch - 29ms/step
Epoch 13/50
1691/1691 - 48s - loss: 10.7202 - accuracy10: 0.5981 - accuracy20: 0.5869 - accuracy30: 0.5671 - accuracy50: 0.5251 - val_loss: 11.7390 - val_accuracy10: 0.5652 - val_accuracy20: 0.5504 - val_accuracy30: 0.5264 - val_accuracy50: 0.4845 - 48s/epoch - 28ms/step
Epoch 14/50
1691/1691 - 50s - loss: 10.7010 - accuracy10: 0.5980 - accuracy20: 0.5874 - accuracy30: 0.5675 - accuracy50: 0.5253 - val_loss: 11.7089 - val_accuracy10: 0.5666 - val_accuracy20: 0.5525 - val_accuracy30: 0.5289 - val_accuracy50: 0.4853 - 50s/epoch - 29ms/step
Epoch 15/50
1691/1691 - 49s - loss: 10.6827 - accuracy10: 0.5989 - accuracy20: 0.5883 - accuracy30: 0.5686 - accuracy50: 0.5267 - val_loss: 11.7027 - val_accuracy10: 0.5682 - val_accuracy20: 0.5536 - val_accuracy30: 0.5300 - val_accuracy50: 0.4873 - 49s/epoch - 29ms/step
Epoch 16/50
1691/1691 - 49s - loss: 10.6663 - accuracy10: 0.5998 - accuracy20: 0.5896 - accuracy30: 0.5700 - accuracy50: 0.5271 - val_loss: 11.6690 - val_accuracy10: 0.5619 - val_accuracy20: 0.5518 - val_accuracy30: 0.5302 - val_accuracy50: 0.4888 - 49s/epoch - 29ms/step
Epoch 17/50
1691/1691 - 50s - loss: 10.6481 - accuracy10: 0.6003 - accuracy20: 0.5903 - accuracy30: 0.5710 - accuracy50: 0.5282 - val_loss: 11.6598 - val_accuracy10: 0.5684 - val_accuracy20: 0.5550 - val_accuracy30: 0.5306 - val_accuracy50: 0.4872 - 50s/epoch - 29ms/step
Epoch 18/50
1691/1691 - 50s - loss: 10.6308 - accuracy10: 0.6017 - accuracy20: 0.5913 - accuracy30: 0.5717 - accuracy50: 0.5288 - val_loss: 11.6088 - val_accuracy10: 0.5676 - val_accuracy20: 0.5544 - val_accuracy30: 0.5331 - val_accuracy50: 0.4898 - 50s/epoch - 29ms/step
Epoch 19/50
1691/1691 - 49s - loss: 10.6174 - accuracy10: 0.6020 - accuracy20: 0.5923 - accuracy30: 0.5729 - accuracy50: 0.5296 - val_loss: 11.6353 - val_accuracy10: 0.5682 - val_accuracy20: 0.5543 - val_accuracy30: 0.5319 - val_accuracy50: 0.4877 - 49s/epoch - 29ms/step
Epoch 20/50
1691/1691 - 49s - loss: 10.6020 - accuracy10: 0.6030 - accuracy20: 0.5926 - accuracy30: 0.5737 - accuracy50: 0.5310 - val_loss: 11.6380 - val_accuracy10: 0.5685 - val_accuracy20: 0.5551 - val_accuracy30: 0.5333 - val_accuracy50: 0.4898 - 49s/epoch - 29ms/step
Epoch 21/50
1691/1691 - 50s - loss: 10.5854 - accuracy10: 0.6035 - accuracy20: 0.5938 - accuracy30: 0.5752 - accuracy50: 0.5318 - val_loss: 11.6158 - val_accuracy10: 0.5697 - val_accuracy20: 0.5563 - val_accuracy30: 0.5333 - val_accuracy50: 0.4890 - 50s/epoch - 29ms/step
Epoch 22/50
1691/1691 - 49s - loss: 10.5721 - accuracy10: 0.6034 - accuracy20: 0.5944 - accuracy30: 0.5756 - accuracy50: 0.5330 - val_loss: 11.6085 - val_accuracy10: 0.5698 - val_accuracy20: 0.5560 - val_accuracy30: 0.5331 - val_accuracy50: 0.4887 - 49s/epoch - 29ms/step
Epoch 23/50
1691/1691 - 48s - loss: 10.5616 - accuracy10: 0.6042 - accuracy20: 0.5947 - accuracy30: 0.5761 - accuracy50: 0.5332 - val_loss: 11.6336 - val_accuracy10: 0.5738 - val_accuracy20: 0.5574 - val_accuracy30: 0.5328 - val_accuracy50: 0.4880 - 48s/epoch - 28ms/step
Epoch 24/50
1691/1691 - 49s - loss: 10.5472 - accuracy10: 0.6050 - accuracy20: 0.5955 - accuracy30: 0.5764 - accuracy50: 0.5338 - val_loss: 11.6561 - val_accuracy10: 0.5708 - val_accuracy20: 0.5547 - val_accuracy30: 0.5314 - val_accuracy50: 0.4876 - 49s/epoch - 29ms/step
Epoch 25/50
1691/1691 - 48s - loss: 10.5324 - accuracy10: 0.6055 - accuracy20: 0.5964 - accuracy30: 0.5782 - accuracy50: 0.5349 - val_loss: 11.6317 - val_accuracy10: 0.5703 - val_accuracy20: 0.5557 - val_accuracy30: 0.5327 - val_accuracy50: 0.4892 - 48s/epoch - 29ms/step
Epoch 26/50
1691/1691 - 49s - loss: 10.5243 - accuracy10: 0.6057 - accuracy20: 0.5969 - accuracy30: 0.5780 - accuracy50: 0.5356 - val_loss: 11.6372 - val_accuracy10: 0.5770 - val_accuracy20: 0.5594 - val_accuracy30: 0.5343 - val_accuracy50: 0.4885 - 49s/epoch - 29ms/step
Epoch 27/50
1691/1691 - 50s - loss: 10.5047 - accuracy10: 0.6064 - accuracy20: 0.5974 - accuracy30: 0.5793 - accuracy50: 0.5362 - val_loss: 11.6505 - val_accuracy10: 0.5734 - val_accuracy20: 0.5574 - val_accuracy30: 0.5325 - val_accuracy50: 0.4881 - 50s/epoch - 30ms/step
Epoch 28/50
1691/1691 - 48s - loss: 10.4961 - accuracy10: 0.6068 - accuracy20: 0.5983 - accuracy30: 0.5798 - accuracy50: 0.5373 - val_loss: 11.6523 - val_accuracy10: 0.5807 - val_accuracy20: 0.5612 - val_accuracy30: 0.5346 - val_accuracy50: 0.4880 - 48s/epoch - 29ms/step
Epoch 29/50
1691/1691 - 49s - loss: 10.4842 - accuracy10: 0.6072 - accuracy20: 0.5984 - accuracy30: 0.5799 - accuracy50: 0.5377 - val_loss: 11.6705 - val_accuracy10: 0.5782 - val_accuracy20: 0.5577 - val_accuracy30: 0.5310 - val_accuracy50: 0.4861 - 49s/epoch - 29ms/step
Epoch 30/50
1691/1691 - 49s - loss: 10.4702 - accuracy10: 0.6072 - accuracy20: 0.5991 - accuracy30: 0.5811 - accuracy50: 0.5386 - val_loss: 11.6550 - val_accuracy10: 0.5806 - val_accuracy20: 0.5602 - val_accuracy30: 0.5329 - val_accuracy50: 0.4860 - 49s/epoch - 29ms/step
Epoch 31/50
1691/1691 - 48s - loss: 10.4560 - accuracy10: 0.6085 - accuracy20: 0.5997 - accuracy30: 0.5815 - accuracy50: 0.5391 - val_loss: 11.6423 - val_accuracy10: 0.5846 - val_accuracy20: 0.5622 - val_accuracy30: 0.5325 - val_accuracy50: 0.4856 - 48s/epoch - 28ms/step
Epoch 32/50
1691/1691 - 51s - loss: 10.4482 - accuracy10: 0.6078 - accuracy20: 0.5996 - accuracy30: 0.5822 - accuracy50: 0.5397 - val_loss: 11.6742 - val_accuracy10: 0.5837 - val_accuracy20: 0.5615 - val_accuracy30: 0.5333 - val_accuracy50: 0.4861 - 51s/epoch - 30ms/step
testing model: results/ATVI/W8/deepVOL_L2/seq2seq
Evaluating performance on  test set...
4960/4960 - 47s - 47s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8305131
{'0': {'precision': 0.43446793146458346, 'recall': 0.5305954743150342, 'f1-score': 0.47774419129257834, 'support': 249465}, '1': {'precision': 0.8139316182983505, 'recall': 0.65371341809022, 'f1-score': 0.7250772592789897, 'support': 774529}, '2': {'precision': 0.4305633716573408, 'recall': 0.60102325732846, 'f1-score': 0.50170987651175, 'support': 245686}, 'accuracy': 0.6193277046184865, 'macro avg': {'precision': 0.5596543071400916, 'recall': 0.5951107165779047, 'f1-score': 0.5681771090277726, 'support': 1269680}, 'weighted avg': {'precision': 0.6651924716785496, 'recall': 0.6193277046184865, 'f1-score': 0.633259492118932, 'support': 1269680}}
[[132365  58701  58399]
 [131318 506320 136891]
 [ 40977  57046 147663]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8659692
{'0': {'precision': 0.49555952026960054, 'recall': 0.47701902466018303, 'f1-score': 0.4861125515310223, 'support': 314434}, '1': {'precision': 0.7179590131291171, 'recall': 0.6827762299089646, 'f1-score': 0.6999257720541728, 'support': 644255}, '2': {'precision': 0.49147113110525337, 'recall': 0.5599551112411614, 'f1-score': 0.5234827909101978, 'support': 310991}, 'accuracy': 0.6017374456555983, 'macro avg': {'precision': 0.5683298881679903, 'recall': 0.5732501219367697, 'f1-score': 0.5698403714984642, 'support': 1269680}, 'weighted avg': {'precision': 0.607407019669133, 'recall': 0.6017374456555983, 'f1-score': 0.6037579775461691, 'support': 1269680}}
[[149991  88097  76346]
 [100534 439882 103839]
 [ 52145  84705 174141]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.90136415
{'0': {'precision': 0.5221514570774033, 'recall': 0.42856943291955485, 'f1-score': 0.4707546793433728, 'support': 357921}, '1': {'precision': 0.6351237234878241, 'recall': 0.6967295080348503, 'f1-score': 0.6645018068560362, 'support': 557011}, '2': {'precision': 0.5141654356244878, 'recall': 0.5288317340760201, 'f1-score': 0.5213954684101915, 'support': 354748}, 'accuracy': 0.5742250015752001, 'macro avg': {'precision': 0.5571468720632384, 'recall': 0.5513768916768084, 'f1-score': 0.5522173182032001, 'support': 1269680}, 'weighted avg': {'precision': 0.5694813118023386, 'recall': 0.5742250015752001, 'f1-score': 0.569900920823771, 'support': 1269680}}
[[153394 114070  90457]
 [ 82117 388086  86808]
 [ 58262 108884 187602]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9642154
{'0': {'precision': 0.5182309058614565, 'recall': 0.372336977189951, 'f1-score': 0.4333336798846281, 'support': 391801}, '1': {'precision': 0.5393451927601547, 'recall': 0.6861856425153372, 'f1-score': 0.6039683653467454, 'support': 486074}, '2': {'precision': 0.5066649719148982, 'recall': 0.4781689871236967, 'f1-score': 0.4920047165475712, 'support': 391805}, 'accuracy': 0.5251464936046878, 'macro avg': {'precision': 0.5214136901788365, 'recall': 0.5122305356096616, 'f1-score': 0.5097689205929815, 'support': 1269680}, 'weighted avg': {'precision': 0.5227450473302254, 'recall': 0.5251464936046878, 'f1-score': 0.5167631184998993, 'support': 1269680}}
[[145882 144809 101110]
 [ 71227 333537  81310]
 [ 64391 140065 187349]]
Evaluating performance on  train set...
1691/1691 - 17s - 17s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.85985214
{'0': {'precision': 0.45437929160697527, 'recall': 0.561704206572961, 'f1-score': 0.5023735941631886, 'support': 98251}, '1': {'precision': 0.7833432128037937, 'recall': 0.6217674043454151, 'f1-score': 0.693265384507293, 'support': 238044}, '2': {'precision': 0.4622678492674082, 'recall': 0.586241183233384, 'f1-score': 0.5169253530967026, 'support': 96549}, 'accuracy': 0.60020931328608, 'macro avg': {'precision': 0.566663451226059, 'recall': 0.5899042647172534, 'f1-score': 0.5708547772557281, 'support': 432844}, 'weighted avg': {'precision': 0.6370536962676212, 'recall': 0.60020931328608, 'f1-score': 0.6106010458870055, 'support': 432844}}
[[ 55188  19568  23495]
 [ 47690 148008  42346]
 [ 18580  21368  56601]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8854101
{'0': {'precision': 0.51599429757647, 'recall': 0.5102010534906151, 'f1-score': 0.5130813230539667, 'support': 121311}, '1': {'precision': 0.6761597591786271, 'recall': 0.6538311597178544, 'f1-score': 0.6648080272083676, 'support': 192383}, '2': {'precision': 0.5147834312064005, 'recall': 0.5481158203944607, 'f1-score': 0.5309269759973985, 'support': 119150}, 'accuracy': 0.5844761623125191, 'macro avg': {'precision': 0.5689791626538324, 'recall': 0.5707160112009767, 'f1-score': 0.5696054420865776, 'support': 432844}, 'weighted avg': {'precision': 0.5868485482335519, 'recall': 0.5844761623125191, 'f1-score': 0.5854305945548909, 'support': 432844}}
[[ 61893  29183  30235]
 [ 35275 125786  31322]
 [ 22781  31061  65308]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.91483897
{'0': {'precision': 0.5439471323072675, 'recall': 0.46145176164058727, 'f1-score': 0.49931497628154864, 'support': 136634}, '1': {'precision': 0.5850230328251275, 'recall': 0.6708049708842935, 'f1-score': 0.6249842452019478, 'support': 162627}, '2': {'precision': 0.5322668424562507, 'recall': 0.5198191386628538, 'f1-score': 0.5259693533604501, 'support': 133583}, 'accuracy': 0.5581225568565118, 'macro avg': {'precision': 0.5537456691962153, 'recall': 0.5506919570625781, 'f1-score': 0.5500895249479822, 'support': 432844}, 'weighted avg': {'precision': 0.5557753251766376, 'recall': 0.5581225568565118, 'f1-score': 0.5547570936495811, 'support': 432844}}
[[ 63050  38203  35381]
 [ 27897 109091  25639]
 [ 24965  39179  69439]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.97512347
{'0': {'precision': 0.5348218313035634, 'recall': 0.4049189957107341, 'f1-score': 0.4608920089247538, 'support': 146412}, '1': {'precision': 0.4908226483365064, 'recall': 0.6503236775906401, 'f1-score': 0.559426223366472, 'support': 143507}, '2': {'precision': 0.516928070867336, 'recall': 0.4768794822459332, 'f1-score': 0.4960968348879272, 'support': 142925}, 'accuracy': 0.5100428791897311, 'macro avg': {'precision': 0.5141908501691353, 'recall': 0.5107073851824359, 'f1-score': 0.5054716890597177, 'support': 432844}, 'weighted avg': {'precision': 0.5143256329956251, 'recall': 0.5100428791897311, 'f1-score': 0.5051851012690491, 'support': 432844}}
[[59285 48662 38465]
 [24952 93326 25229]
 [26613 48154 68158]]
Evaluating performance on  val set...
591/591 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9172075
{'0': {'precision': 0.45545994136015827, 'recall': 0.5250474018301229, 'f1-score': 0.48778433024431345, 'support': 36391}, '1': {'precision': 0.7658426508763297, 'recall': 0.581487922705314, 'f1-score': 0.6610526932427286, 'support': 77625}, '2': {'precision': 0.43863943953506884, 'recall': 0.5937550514575138, 'f1-score': 0.5045443098830155, 'support': 37118}, 'accuracy': 0.5709105826617439, 'macro avg': {'precision': 0.5533140105905189, 'recall': 0.5667634586643169, 'f1-score': 0.5511271111233524, 'support': 151134}, 'weighted avg': {'precision': 0.6107467361214239, 'recall': 0.5709105826617439, 'f1-score': 0.5808941109818134, 'support': 151134}}
[[19107  6402 10882]
 [15164 45138 17323]
 [ 7680  7399 22039]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9358646
{'0': {'precision': 0.5053271344859315, 'recall': 0.4746298528508722, 'f1-score': 0.4894976954742163, 'support': 43969}, '1': {'precision': 0.6523922082851671, 'recall': 0.6110042821362204, 'f1-score': 0.6310203264243516, 'support': 61885}, '2': {'precision': 0.4920099466044683, 'recall': 0.5636925795053004, 'f1-score': 0.5254176230225306, 'support': 45280}, 'accuracy': 0.5571545780565591, 'macro avg': {'precision': 0.5499097631251889, 'recall': 0.5497755714974644, 'f1-score': 0.5486452149736994, 'support': 151134}, 'weighted avg': {'precision': 0.5615561751041447, 'recall': 0.5571545780565591, 'f1-score': 0.5582087885157344, 'support': 151134}}
[[20869  9518 13582]
 [11302 37812 12771]
 [ 9127 10629 25524]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.95609415
{'0': {'precision': 0.5261474129679077, 'recall': 0.42785447990495307, 'f1-score': 0.4719372768764969, 'support': 48818}, '1': {'precision': 0.5583367811336367, 'recall': 0.6237097519642582, 'f1-score': 0.5892155435889972, 'support': 51928}, '2': {'precision': 0.5097140076364453, 'recall': 0.540465983964436, 'f1-score': 0.524639747245126, 'support': 50388}, 'accuracy': 0.532692842113621, 'macro avg': {'precision': 0.5313994005793299, 'recall': 0.5306767386112158, 'f1-score': 0.5285975225702066, 'support': 151134}, 'weighted avg': {'precision': 0.5317284409448569, 'recall': 0.532692842113621, 'f1-score': 0.5298037920933323, 'support': 151134}}
[[20887 12272 15659]
 [ 9004 32388 10536]
 [ 9807 13348 27233]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0035537
{'0': {'precision': 0.5171165499331077, 'recall': 0.3748003650467716, 'f1-score': 0.4346043189258904, 'support': 52596}, '1': {'precision': 0.45826707717292015, 'recall': 0.6031661211675907, 'f1-score': 0.5208263239351323, 'support': 44913}, '2': {'precision': 0.5000834894896009, 'recall': 0.5026386946386946, 'f1-score': 0.5013578363900151, 'support': 53625}, 'accuracy': 0.4880238728545529, 'macro avg': {'precision': 0.4918223721985429, 'recall': 0.4935350602843523, 'f1-score': 0.4855961597503459, 'support': 151134}, 'weighted avg': {'precision': 0.49358442455853047, 'recall': 0.4880238728545529, 'f1-score': 0.48391252412785535, 'support': 151134}}
[[19713 15791 17092]
 [ 7970 27090  9853]
 [10438 16233 26954]]
training model: results/ATVI/W8/deepVOL_L3/seq2seq
Epoch 1/50
1691/1691 - 78s - loss: 12.5406 - accuracy10: 0.4759 - accuracy20: 0.4641 - accuracy30: 0.4515 - accuracy50: 0.4288 - val_loss: 12.9029 - val_accuracy10: 0.4802 - val_accuracy20: 0.4641 - val_accuracy30: 0.4458 - val_accuracy50: 0.4175 - 78s/epoch - 46ms/step
Epoch 2/50
1691/1691 - 72s - loss: 12.0925 - accuracy10: 0.4985 - accuracy20: 0.4935 - accuracy30: 0.4817 - accuracy50: 0.4552 - val_loss: 12.2803 - val_accuracy10: 0.5470 - val_accuracy20: 0.5241 - val_accuracy30: 0.4995 - val_accuracy50: 0.4602 - 72s/epoch - 42ms/step
Epoch 3/50
1691/1691 - 72s - loss: 11.3078 - accuracy10: 0.5603 - accuracy20: 0.5518 - accuracy30: 0.5355 - accuracy50: 0.5002 - val_loss: 11.9634 - val_accuracy10: 0.5418 - val_accuracy20: 0.5312 - val_accuracy30: 0.5132 - val_accuracy50: 0.4756 - 72s/epoch - 43ms/step
Epoch 4/50
1691/1691 - 72s - loss: 11.1048 - accuracy10: 0.5737 - accuracy20: 0.5645 - accuracy30: 0.5468 - accuracy50: 0.5092 - val_loss: 11.8672 - val_accuracy10: 0.5466 - val_accuracy20: 0.5305 - val_accuracy30: 0.5105 - val_accuracy50: 0.4745 - 72s/epoch - 43ms/step
Epoch 5/50
1691/1691 - 72s - loss: 10.9941 - accuracy10: 0.5818 - accuracy20: 0.5709 - accuracy30: 0.5520 - accuracy50: 0.5125 - val_loss: 11.8400 - val_accuracy10: 0.5492 - val_accuracy20: 0.5344 - val_accuracy30: 0.5140 - val_accuracy50: 0.4770 - 72s/epoch - 43ms/step
Epoch 6/50
1691/1691 - 72s - loss: 10.9144 - accuracy10: 0.5863 - accuracy20: 0.5751 - accuracy30: 0.5559 - accuracy50: 0.5166 - val_loss: 11.8920 - val_accuracy10: 0.5503 - val_accuracy20: 0.5353 - val_accuracy30: 0.5154 - val_accuracy50: 0.4794 - 72s/epoch - 43ms/step
Epoch 7/50
1691/1691 - 71s - loss: 10.8643 - accuracy10: 0.5887 - accuracy20: 0.5774 - accuracy30: 0.5583 - accuracy50: 0.5183 - val_loss: 11.8179 - val_accuracy10: 0.5630 - val_accuracy20: 0.5418 - val_accuracy30: 0.5159 - val_accuracy50: 0.4752 - 71s/epoch - 42ms/step
Epoch 8/50
1691/1691 - 72s - loss: 10.8211 - accuracy10: 0.5911 - accuracy20: 0.5801 - accuracy30: 0.5608 - accuracy50: 0.5205 - val_loss: 11.8010 - val_accuracy10: 0.5631 - val_accuracy20: 0.5429 - val_accuracy30: 0.5176 - val_accuracy50: 0.4774 - 72s/epoch - 42ms/step
Epoch 9/50
1691/1691 - 73s - loss: 10.7924 - accuracy10: 0.5930 - accuracy20: 0.5818 - accuracy30: 0.5625 - accuracy50: 0.5222 - val_loss: 11.6747 - val_accuracy10: 0.5681 - val_accuracy20: 0.5489 - val_accuracy30: 0.5243 - val_accuracy50: 0.4820 - 73s/epoch - 43ms/step
Epoch 10/50
1691/1691 - 73s - loss: 10.7575 - accuracy10: 0.5947 - accuracy20: 0.5835 - accuracy30: 0.5640 - accuracy50: 0.5230 - val_loss: 11.6856 - val_accuracy10: 0.5663 - val_accuracy20: 0.5453 - val_accuracy30: 0.5209 - val_accuracy50: 0.4791 - 73s/epoch - 43ms/step
Epoch 11/50
1691/1691 - 72s - loss: 10.7318 - accuracy10: 0.5967 - accuracy20: 0.5847 - accuracy30: 0.5650 - accuracy50: 0.5240 - val_loss: 11.6291 - val_accuracy10: 0.5746 - val_accuracy20: 0.5509 - val_accuracy30: 0.5222 - val_accuracy50: 0.4778 - 72s/epoch - 42ms/step
Epoch 12/50
1691/1691 - 72s - loss: 10.7103 - accuracy10: 0.5974 - accuracy20: 0.5867 - accuracy30: 0.5669 - accuracy50: 0.5252 - val_loss: 11.5816 - val_accuracy10: 0.5766 - val_accuracy20: 0.5544 - val_accuracy30: 0.5268 - val_accuracy50: 0.4817 - 72s/epoch - 42ms/step
Epoch 13/50
1691/1691 - 73s - loss: 10.6871 - accuracy10: 0.5989 - accuracy20: 0.5874 - accuracy30: 0.5681 - accuracy50: 0.5265 - val_loss: 11.5180 - val_accuracy10: 0.5743 - val_accuracy20: 0.5555 - val_accuracy30: 0.5311 - val_accuracy50: 0.4882 - 73s/epoch - 43ms/step
Epoch 14/50
1691/1691 - 71s - loss: 10.6682 - accuracy10: 0.5997 - accuracy20: 0.5884 - accuracy30: 0.5687 - accuracy50: 0.5272 - val_loss: 11.5155 - val_accuracy10: 0.5755 - val_accuracy20: 0.5555 - val_accuracy30: 0.5298 - val_accuracy50: 0.4861 - 71s/epoch - 42ms/step
Epoch 15/50
1691/1691 - 72s - loss: 10.6465 - accuracy10: 0.6007 - accuracy20: 0.5899 - accuracy30: 0.5703 - accuracy50: 0.5284 - val_loss: 11.4977 - val_accuracy10: 0.5737 - val_accuracy20: 0.5559 - val_accuracy30: 0.5312 - val_accuracy50: 0.4883 - 72s/epoch - 42ms/step
Epoch 16/50
1691/1691 - 73s - loss: 10.6292 - accuracy10: 0.6016 - accuracy20: 0.5911 - accuracy30: 0.5711 - accuracy50: 0.5294 - val_loss: 11.5019 - val_accuracy10: 0.5792 - val_accuracy20: 0.5589 - val_accuracy30: 0.5323 - val_accuracy50: 0.4878 - 73s/epoch - 43ms/step
Epoch 17/50
1691/1691 - 72s - loss: 10.6188 - accuracy10: 0.6018 - accuracy20: 0.5916 - accuracy30: 0.5720 - accuracy50: 0.5299 - val_loss: 11.4906 - val_accuracy10: 0.5771 - val_accuracy20: 0.5587 - val_accuracy30: 0.5323 - val_accuracy50: 0.4870 - 72s/epoch - 43ms/step
Epoch 18/50
1691/1691 - 73s - loss: 10.5985 - accuracy10: 0.6032 - accuracy20: 0.5931 - accuracy30: 0.5731 - accuracy50: 0.5304 - val_loss: 11.4717 - val_accuracy10: 0.5784 - val_accuracy20: 0.5594 - val_accuracy30: 0.5320 - val_accuracy50: 0.4861 - 73s/epoch - 43ms/step
Epoch 19/50
1691/1691 - 72s - loss: 10.5804 - accuracy10: 0.6041 - accuracy20: 0.5937 - accuracy30: 0.5745 - accuracy50: 0.5322 - val_loss: 11.4836 - val_accuracy10: 0.5791 - val_accuracy20: 0.5601 - val_accuracy30: 0.5332 - val_accuracy50: 0.4873 - 72s/epoch - 43ms/step
Epoch 20/50
1691/1691 - 72s - loss: 10.5732 - accuracy10: 0.6036 - accuracy20: 0.5936 - accuracy30: 0.5746 - accuracy50: 0.5326 - val_loss: 11.4348 - val_accuracy10: 0.5748 - val_accuracy20: 0.5584 - val_accuracy30: 0.5340 - val_accuracy50: 0.4902 - 72s/epoch - 43ms/step
Epoch 21/50
1691/1691 - 72s - loss: 10.5534 - accuracy10: 0.6044 - accuracy20: 0.5945 - accuracy30: 0.5752 - accuracy50: 0.5331 - val_loss: 11.4511 - val_accuracy10: 0.5827 - val_accuracy20: 0.5604 - val_accuracy30: 0.5320 - val_accuracy50: 0.4862 - 72s/epoch - 42ms/step
Epoch 22/50
1691/1691 - 71s - loss: 10.5404 - accuracy10: 0.6048 - accuracy20: 0.5958 - accuracy30: 0.5767 - accuracy50: 0.5337 - val_loss: 11.3990 - val_accuracy10: 0.5769 - val_accuracy20: 0.5600 - val_accuracy30: 0.5359 - val_accuracy50: 0.4929 - 71s/epoch - 42ms/step
Epoch 23/50
1691/1691 - 74s - loss: 10.5249 - accuracy10: 0.6060 - accuracy20: 0.5965 - accuracy30: 0.5768 - accuracy50: 0.5347 - val_loss: 11.4535 - val_accuracy10: 0.5752 - val_accuracy20: 0.5578 - val_accuracy30: 0.5333 - val_accuracy50: 0.4895 - 74s/epoch - 44ms/step
Epoch 24/50
1691/1691 - 71s - loss: 10.5106 - accuracy10: 0.6069 - accuracy20: 0.5975 - accuracy30: 0.5784 - accuracy50: 0.5361 - val_loss: 11.3882 - val_accuracy10: 0.5762 - val_accuracy20: 0.5589 - val_accuracy30: 0.5338 - val_accuracy50: 0.4912 - 71s/epoch - 42ms/step
Epoch 25/50
1691/1691 - 74s - loss: 10.5025 - accuracy10: 0.6062 - accuracy20: 0.5974 - accuracy30: 0.5782 - accuracy50: 0.5366 - val_loss: 11.3952 - val_accuracy10: 0.5753 - val_accuracy20: 0.5588 - val_accuracy30: 0.5347 - val_accuracy50: 0.4921 - 74s/epoch - 43ms/step
Epoch 26/50
1691/1691 - 70s - loss: 10.4865 - accuracy10: 0.6073 - accuracy20: 0.5985 - accuracy30: 0.5792 - accuracy50: 0.5370 - val_loss: 11.4158 - val_accuracy10: 0.5697 - val_accuracy20: 0.5559 - val_accuracy30: 0.5332 - val_accuracy50: 0.4915 - 70s/epoch - 42ms/step
Epoch 27/50
1691/1691 - 72s - loss: 10.4801 - accuracy10: 0.6070 - accuracy20: 0.5979 - accuracy30: 0.5794 - accuracy50: 0.5377 - val_loss: 11.4378 - val_accuracy10: 0.5700 - val_accuracy20: 0.5548 - val_accuracy30: 0.5331 - val_accuracy50: 0.4915 - 72s/epoch - 43ms/step
Epoch 28/50
1691/1691 - 72s - loss: 10.4614 - accuracy10: 0.6079 - accuracy20: 0.5996 - accuracy30: 0.5809 - accuracy50: 0.5386 - val_loss: 11.4238 - val_accuracy10: 0.5736 - val_accuracy20: 0.5578 - val_accuracy30: 0.5348 - val_accuracy50: 0.4921 - 72s/epoch - 42ms/step
Epoch 29/50
1691/1691 - 73s - loss: 10.4512 - accuracy10: 0.6083 - accuracy20: 0.6000 - accuracy30: 0.5812 - accuracy50: 0.5396 - val_loss: 11.4731 - val_accuracy10: 0.5770 - val_accuracy20: 0.5577 - val_accuracy30: 0.5320 - val_accuracy50: 0.4887 - 73s/epoch - 43ms/step
Epoch 30/50
1691/1691 - 73s - loss: 10.4390 - accuracy10: 0.6089 - accuracy20: 0.6010 - accuracy30: 0.5825 - accuracy50: 0.5404 - val_loss: 11.4395 - val_accuracy10: 0.5725 - val_accuracy20: 0.5551 - val_accuracy30: 0.5322 - val_accuracy50: 0.4896 - 73s/epoch - 43ms/step
Epoch 31/50
1691/1691 - 72s - loss: 10.4296 - accuracy10: 0.6094 - accuracy20: 0.6009 - accuracy30: 0.5824 - accuracy50: 0.5407 - val_loss: 11.4589 - val_accuracy10: 0.5708 - val_accuracy20: 0.5550 - val_accuracy30: 0.5315 - val_accuracy50: 0.4907 - 72s/epoch - 43ms/step
Epoch 32/50
1691/1691 - 72s - loss: 10.4152 - accuracy10: 0.6099 - accuracy20: 0.6012 - accuracy30: 0.5829 - accuracy50: 0.5411 - val_loss: 11.4713 - val_accuracy10: 0.5734 - val_accuracy20: 0.5558 - val_accuracy30: 0.5315 - val_accuracy50: 0.4885 - 72s/epoch - 42ms/step
Epoch 33/50
1691/1691 - 73s - loss: 10.4013 - accuracy10: 0.6101 - accuracy20: 0.6022 - accuracy30: 0.5838 - accuracy50: 0.5421 - val_loss: 11.4797 - val_accuracy10: 0.5695 - val_accuracy20: 0.5538 - val_accuracy30: 0.5304 - val_accuracy50: 0.4891 - 73s/epoch - 43ms/step
Epoch 34/50
1691/1691 - 72s - loss: 10.3909 - accuracy10: 0.6101 - accuracy20: 0.6025 - accuracy30: 0.5840 - accuracy50: 0.5429 - val_loss: 11.4856 - val_accuracy10: 0.5703 - val_accuracy20: 0.5541 - val_accuracy30: 0.5302 - val_accuracy50: 0.4883 - 72s/epoch - 43ms/step
testing model: results/ATVI/W8/deepVOL_L3/seq2seq
Evaluating performance on  test set...
4960/4960 - 86s - 86s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.82447666
{'0': {'precision': 0.4185559367618916, 'recall': 0.5839095664722506, 'f1-score': 0.48759546296714706, 'support': 249465}, '1': {'precision': 0.8133259594113686, 'recall': 0.6550677895856708, 'f1-score': 0.725668627788914, 'support': 774529}, '2': {'precision': 0.4509907937765661, 'recall': 0.5467303794273992, 'f1-score': 0.49426708467641045, 'support': 245686}, 'accuracy': 0.6201231806439418, 'macro avg': {'precision': 0.5609575633166087, 'recall': 0.5952359118284402, 'f1-score': 0.5691770584774906, 'support': 1269680}, 'weighted avg': {'precision': 0.6656493942891301, 'recall': 0.6201231806439418, 'f1-score': 0.6341156053081309, 'support': 1269680}}
[[145665  58509  45291]
 [148933 507369 118227]
 [ 53420  57942 134324]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8574446
{'0': {'precision': 0.47213463855918913, 'recall': 0.5457520497147255, 'f1-score': 0.5062811994760258, 'support': 314434}, '1': {'precision': 0.715717518370481, 'recall': 0.682894195621299, 'f1-score': 0.6989206998770418, 'support': 644255}, '2': {'precision': 0.5192875691659605, 'recall': 0.4867568514844481, 'f1-score': 0.5024962655601659, 'support': 310991}, 'accuracy': 0.6008899880284796, 'macro avg': {'precision': 0.5690465753652102, 'recall': 0.5718010322734909, 'f1-score': 0.5692327216377445, 'support': 1269680}, 'weighted avg': {'precision': 0.6072817821506092, 'recall': 0.6008899880284796, 'f1-score': 0.6031023520084979, 'support': 1269680}}
[[171603  88068  54763]
 [118928 439958  85369]
 [ 72931  86683 151377]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.894168
{'0': {'precision': 0.49482807654284205, 'recall': 0.5104282788660067, 'f1-score': 0.5025071308136416, 'support': 357921}, '1': {'precision': 0.6334473478829759, 'recall': 0.6892305537951674, 'f1-score': 0.6601626379748837, 'support': 557011}, '2': {'precision': 0.5430009646345937, 'recall': 0.450646656217935, 'f1-score': 0.49253188736212955, 'support': 354748}, 'accuracy': 0.5721662151093189, 'macro avg': {'precision': 0.5570921296868039, 'recall': 0.5501018296263697, 'f1-score': 0.5517338853835517, 'support': 1269680}, 'weighted avg': {'precision': 0.5691000936284164, 'recall': 0.5721662151093189, 'f1-score': 0.568883819456019, 'support': 1269680}}
[[182693 112169  63059]
 [101615 383909  71487]
 [ 84897 109985 159866]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.95655453
{'0': {'precision': 0.49248169220759447, 'recall': 0.4539983307852711, 'f1-score': 0.47245765525521055, 'support': 391801}, '1': {'precision': 0.5390942588070926, 'recall': 0.6763394051111559, 'f1-score': 0.5999680626337378, 'support': 486074}, '2': {'precision': 0.5321788973931444, 'recall': 0.4056813976340271, 'f1-score': 0.4603992300996844, 'support': 391805}, 'accuracy': 0.5242076743746455, 'macro avg': {'precision': 0.5212516161359438, 'recall': 0.5120063778434846, 'f1-score': 0.5109416493295442, 'support': 1269680}, 'weighted avg': {'precision': 0.5225764563804639, 'recall': 0.5242076743746455, 'f1-score': 0.5175516494018061, 'support': 1269680}}
[[177877 140590  73334]
 [ 90931 328751  66392]
 [ 92377 140480 158948]]
Evaluating performance on  train set...
1691/1691 - 29s - 29s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8423148
{'0': {'precision': 0.4548534734924788, 'recall': 0.5998310449766414, 'f1-score': 0.5173779069257038, 'support': 98251}, '1': {'precision': 0.7839846140396888, 'recall': 0.6404530254910857, 'f1-score': 0.7049874337293962, 'support': 238044}, '2': {'precision': 0.4804528829010973, 'recall': 0.5414867062320687, 'f1-score': 0.5091472173663221, 'support': 96549}, 'accuracy': 0.6091571097208232, 'macro avg': {'precision': 0.5730969901444216, 'recall': 0.5939235922332653, 'f1-score': 0.5771708526738074, 'support': 432844}, 'weighted avg': {'precision': 0.6415703751924279, 'recall': 0.6091571097208232, 'f1-score': 0.6187184761658675, 'support': 432844}}
[[ 58934  20435  18882]
 [ 47936 152456  37652]
 [ 22697  21572  52280]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8674196
{'0': {'precision': 0.5091573459293258, 'recall': 0.5651259984667507, 'f1-score': 0.5356837281262088, 'support': 121311}, '1': {'precision': 0.676292561871445, 'recall': 0.6742747540063311, 'f1-score': 0.6752821505913709, 'support': 192383}, '2': {'precision': 0.5396234573123161, 'recall': 0.48182962652119177, 'f1-score': 0.5090915540106146, 'support': 119150}, 'accuracy': 0.590709354871501, 'macro avg': {'precision': 0.5750244550376956, 'recall': 0.5737434596647578, 'f1-score': 0.5733524775760648, 'support': 432844}, 'weighted avg': {'precision': 0.5918291894107557, 'recall': 0.590709354871501, 'f1-score': 0.5904099245462636, 'support': 432844}}
[[ 68556  30508  22247]
 [ 35932 129719  26732]
 [ 30158  31582  57410]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8996424
{'0': {'precision': 0.5306505956881428, 'recall': 0.5290776819825227, 'f1-score': 0.5298629715278363, 'support': 136634}, '1': {'precision': 0.5881447023517561, 'recall': 0.6857040958758386, 'f1-score': 0.6331885415779462, 'support': 162627}, '2': {'precision': 0.5592830710574515, 'recall': 0.44803605249170925, 'f1-score': 0.4975165734948772, 'support': 133583}, 'accuracy': 0.5629141214848767, 'macro avg': {'precision': 0.5593594563657834, 'recall': 0.5542726101166902, 'f1-score': 0.5535226955335533, 'support': 432844}, 'weighted avg': {'precision': 0.5610885965421266, 'recall': 0.5629141214848767, 'f1-score': 0.5587015336705539, 'support': 432844}}
[[ 72290  38991  25353]
 [ 29304 111514  21809]
 [ 34635  39098  59850]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.96109515
{'0': {'precision': 0.519491168416935, 'recall': 0.4716621588394394, 'f1-score': 0.4944226473452088, 'support': 146412}, '1': {'precision': 0.49631836849713246, 'recall': 0.6627411903252106, 'f1-score': 0.5675819224548986, 'support': 143507}, '2': {'precision': 0.5404441981807268, 'recall': 0.4094595067343012, 'f1-score': 0.46592094263763384, 'support': 142925}, 'accuracy': 0.5144740368354419, 'macro avg': {'precision': 0.5187512450315981, 'recall': 0.5146209519663171, 'f1-score': 0.5093085041459138, 'support': 432844}, 'weighted avg': {'precision': 0.5187270427293866, 'recall': 0.5144740368354419, 'f1-score': 0.5092669375463809, 'support': 432844}}
[[69057 48790 28565]
 [27201 95108 21198]
 [36674 47729 58522]]
Evaluating performance on  val set...
591/591 - 10s - 10s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9001475
{'0': {'precision': 0.4477406804389656, 'recall': 0.5818746393339013, 'f1-score': 0.5060704555231585, 'support': 36391}, '1': {'precision': 0.7687775403925757, 'recall': 0.5933526570048309, 'f1-score': 0.6697688621970815, 'support': 77625}, '2': {'precision': 0.4539597987661909, 'recall': 0.5372595506223395, 'f1-score': 0.4921095167001863, 'support': 37118}, 'accuracy': 0.5768126298516548, 'macro avg': {'precision': 0.5568260065325774, 'recall': 0.5708289489870239, 'f1-score': 0.5559829448068089, 'support': 151134}, 'weighted avg': {'precision': 0.6141580814736033, 'recall': 0.5768126298516548, 'f1-score': 0.5867199896507022, 'support': 151134}}
[[21175  6604  8612]
 [16191 46059 15375]
 [ 9927  7249 19942]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.91760427
{'0': {'precision': 0.4866934673366834, 'recall': 0.5506834360572221, 'f1-score': 0.5167148603804991, 'support': 43969}, '1': {'precision': 0.654309058855438, 'recall': 0.6237214187606044, 'f1-score': 0.6386492053906037, 'support': 61885}, '2': {'precision': 0.5130449141347424, 'recall': 0.48032243816254416, 'f1-score': 0.4961447212336892, 'support': 45280}, 'accuracy': 0.5595101036166581, 'macro avg': {'precision': 0.5513491467756212, 'recall': 0.5515757643267902, 'f1-score': 0.5505029290015974, 'support': 151134}, 'weighted avg': {'precision': 0.5632221398534846, 'recall': 0.5595101036166581, 'f1-score': 0.5604805983374298, 'support': 151134}}
[[24213  9873  9883]
 [12526 38599 10760]
 [13011 10520 21749]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9394966
{'0': {'precision': 0.5020644580553001, 'recall': 0.5255643410217543, 'f1-score': 0.5135457011038721, 'support': 48818}, '1': {'precision': 0.5641268583438129, 'recall': 0.6306231705438299, 'f1-score': 0.5955245187630139, 'support': 51928}, '2': {'precision': 0.5336096422276214, 'recall': 0.4445899817416845, 'f1-score': 0.485049258417235, 'support': 50388}, 'accuracy': 0.5346646022734791, 'macro avg': {'precision': 0.5332669862089116, 'recall': 0.5335924977690896, 'f1-score': 0.5313731594280403, 'support': 151134}, 'weighted avg': {'precision': 0.5339055729748868, 'recall': 0.5346646022734791, 'f1-score': 0.5322120322359115, 'support': 151134}}
[[25657 12315 10846]
 [10447 32747  8734]
 [14999 12987 22402]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9893861
{'0': {'precision': 0.4945425011390424, 'recall': 0.47465586736633963, 'f1-score': 0.48439516089913365, 'support': 52596}, '1': {'precision': 0.46665528427522623, 'recall': 0.6085543161222808, 'f1-score': 0.5282413536522907, 'support': 44913}, '2': {'precision': 0.5197823349095835, 'recall': 0.4079067599067599, 'f1-score': 0.4570986751368747, 'support': 53625}, 'accuracy': 0.49076316381489277, 'macro avg': {'precision': 0.49366004010795067, 'recall': 0.49703898113179346, 'f1-score': 0.4899117298960997, 'support': 151134}, 'weighted avg': {'precision': 0.49521069965784487, 'recall': 0.49076316381489277, 'f1-score': 0.48773980873563244, 'support': 151134}}
[[24965 15447 12184]
 [ 9556 27332  8025]
 [15960 15791 21874]]
training model: results/ATVI/W9/deepLOB_L1/seq2seq
Epoch 1/50
1431/1431 - 43s - loss: 11.9912 - accuracy10: 0.4720 - accuracy20: 0.4873 - accuracy30: 0.4904 - accuracy50: 0.4820 - val_loss: 13.3312 - val_accuracy10: 0.4421 - val_accuracy20: 0.4316 - val_accuracy30: 0.4168 - val_accuracy50: 0.3835 - 43s/epoch - 30ms/step
Epoch 2/50
1431/1431 - 34s - loss: 11.9818 - accuracy10: 0.4518 - accuracy20: 0.4760 - accuracy30: 0.4843 - accuracy50: 0.4776 - val_loss: 13.1696 - val_accuracy10: 0.4200 - val_accuracy20: 0.4336 - val_accuracy30: 0.4339 - val_accuracy50: 0.4164 - 34s/epoch - 24ms/step
Epoch 3/50
1431/1431 - 34s - loss: 11.7844 - accuracy10: 0.4730 - accuracy20: 0.4927 - accuracy30: 0.4974 - accuracy50: 0.4862 - val_loss: 12.7832 - val_accuracy10: 0.4357 - val_accuracy20: 0.4625 - val_accuracy30: 0.4713 - val_accuracy50: 0.4682 - 34s/epoch - 24ms/step
Epoch 4/50
1431/1431 - 36s - loss: 11.4648 - accuracy10: 0.5065 - accuracy20: 0.5197 - accuracy30: 0.5200 - accuracy50: 0.5057 - val_loss: 12.6976 - val_accuracy10: 0.4697 - val_accuracy20: 0.4851 - val_accuracy30: 0.4877 - val_accuracy50: 0.4762 - 36s/epoch - 25ms/step
Epoch 5/50
1431/1431 - 35s - loss: 11.2597 - accuracy10: 0.5362 - accuracy20: 0.5429 - accuracy30: 0.5375 - accuracy50: 0.5182 - val_loss: 12.4804 - val_accuracy10: 0.4847 - val_accuracy20: 0.4928 - val_accuracy30: 0.4905 - val_accuracy50: 0.4776 - 35s/epoch - 24ms/step
Epoch 6/50
1431/1431 - 34s - loss: 11.1255 - accuracy10: 0.5538 - accuracy20: 0.5565 - accuracy30: 0.5483 - accuracy50: 0.5251 - val_loss: 12.5194 - val_accuracy10: 0.5221 - val_accuracy20: 0.5148 - val_accuracy30: 0.5034 - val_accuracy50: 0.4768 - 34s/epoch - 24ms/step
Epoch 7/50
1431/1431 - 36s - loss: 11.0142 - accuracy10: 0.5645 - accuracy20: 0.5650 - accuracy30: 0.5545 - accuracy50: 0.5295 - val_loss: 12.4521 - val_accuracy10: 0.5009 - val_accuracy20: 0.5035 - val_accuracy30: 0.4965 - val_accuracy50: 0.4752 - 36s/epoch - 25ms/step
Epoch 8/50
1431/1431 - 35s - loss: 10.9346 - accuracy10: 0.5681 - accuracy20: 0.5693 - accuracy30: 0.5585 - accuracy50: 0.5329 - val_loss: 12.3757 - val_accuracy10: 0.5311 - val_accuracy20: 0.5233 - val_accuracy30: 0.5087 - val_accuracy50: 0.4777 - 35s/epoch - 24ms/step
Epoch 9/50
1431/1431 - 35s - loss: 10.8749 - accuracy10: 0.5727 - accuracy20: 0.5731 - accuracy30: 0.5618 - accuracy50: 0.5355 - val_loss: 12.3529 - val_accuracy10: 0.5187 - val_accuracy20: 0.5128 - val_accuracy30: 0.5019 - val_accuracy50: 0.4747 - 35s/epoch - 24ms/step
Epoch 10/50
1431/1431 - 35s - loss: 10.8226 - accuracy10: 0.5762 - accuracy20: 0.5761 - accuracy30: 0.5648 - accuracy50: 0.5378 - val_loss: 12.4824 - val_accuracy10: 0.5405 - val_accuracy20: 0.5232 - val_accuracy30: 0.5037 - val_accuracy50: 0.4679 - 35s/epoch - 24ms/step
Epoch 11/50
1431/1431 - 33s - loss: 10.7757 - accuracy10: 0.5787 - accuracy20: 0.5779 - accuracy30: 0.5665 - accuracy50: 0.5384 - val_loss: 12.5015 - val_accuracy10: 0.5397 - val_accuracy20: 0.5222 - val_accuracy30: 0.5045 - val_accuracy50: 0.4699 - 33s/epoch - 23ms/step
Epoch 12/50
1431/1431 - 38s - loss: 10.7412 - accuracy10: 0.5803 - accuracy20: 0.5796 - accuracy30: 0.5679 - accuracy50: 0.5402 - val_loss: 12.5270 - val_accuracy10: 0.5464 - val_accuracy20: 0.5287 - val_accuracy30: 0.5082 - val_accuracy50: 0.4724 - 38s/epoch - 27ms/step
Epoch 13/50
1431/1431 - 35s - loss: 10.7055 - accuracy10: 0.5816 - accuracy20: 0.5815 - accuracy30: 0.5699 - accuracy50: 0.5406 - val_loss: 12.4462 - val_accuracy10: 0.5449 - val_accuracy20: 0.5265 - val_accuracy30: 0.5072 - val_accuracy50: 0.4714 - 35s/epoch - 24ms/step
Epoch 14/50
1431/1431 - 35s - loss: 10.6811 - accuracy10: 0.5830 - accuracy20: 0.5827 - accuracy30: 0.5713 - accuracy50: 0.5425 - val_loss: 12.4436 - val_accuracy10: 0.5492 - val_accuracy20: 0.5300 - val_accuracy30: 0.5096 - val_accuracy50: 0.4724 - 35s/epoch - 24ms/step
Epoch 15/50
1431/1431 - 38s - loss: 10.6523 - accuracy10: 0.5857 - accuracy20: 0.5840 - accuracy30: 0.5724 - accuracy50: 0.5437 - val_loss: 12.5353 - val_accuracy10: 0.5529 - val_accuracy20: 0.5296 - val_accuracy30: 0.5072 - val_accuracy50: 0.4688 - 38s/epoch - 27ms/step
Epoch 16/50
1431/1431 - 39s - loss: 10.6284 - accuracy10: 0.5858 - accuracy20: 0.5845 - accuracy30: 0.5735 - accuracy50: 0.5440 - val_loss: 12.5768 - val_accuracy10: 0.5597 - val_accuracy20: 0.5347 - val_accuracy30: 0.5110 - val_accuracy50: 0.4680 - 39s/epoch - 27ms/step
Epoch 17/50
1431/1431 - 34s - loss: 10.6107 - accuracy10: 0.5873 - accuracy20: 0.5852 - accuracy30: 0.5737 - accuracy50: 0.5452 - val_loss: 12.7613 - val_accuracy10: 0.5592 - val_accuracy20: 0.5296 - val_accuracy30: 0.5046 - val_accuracy50: 0.4612 - 34s/epoch - 23ms/step
Epoch 18/50
1431/1431 - 37s - loss: 10.5947 - accuracy10: 0.5880 - accuracy20: 0.5860 - accuracy30: 0.5751 - accuracy50: 0.5460 - val_loss: 12.5608 - val_accuracy10: 0.5478 - val_accuracy20: 0.5290 - val_accuracy30: 0.5086 - val_accuracy50: 0.4708 - 37s/epoch - 26ms/step
Epoch 19/50
1431/1431 - 34s - loss: 10.5715 - accuracy10: 0.5894 - accuracy20: 0.5877 - accuracy30: 0.5762 - accuracy50: 0.5475 - val_loss: 12.5273 - val_accuracy10: 0.5455 - val_accuracy20: 0.5261 - val_accuracy30: 0.5052 - val_accuracy50: 0.4701 - 34s/epoch - 24ms/step
testing model: results/ATVI/W9/deepLOB_L1/seq2seq
Evaluating performance on  test set...
3337/3337 - 32s - 32s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.95723546
{'0': {'precision': 0.4088674293542021, 'recall': 0.41867990694767543, 'f1-score': 0.41371549340231795, 'support': 144005}, '1': {'precision': 0.8259345717789158, 'recall': 0.4433062801796348, 'f1-score': 0.5769464197785336, 'support': 568264}, '2': {'precision': 0.28064967600870616, 'recall': 0.7950222924544275, 'f1-score': 0.414852771734529, 'support': 141752}, 'accuracy': 0.49753226208723206, 'macro avg': {'precision': 0.5051505590472747, 'recall': 0.5523361598605793, 'f1-score': 0.46850489497179354, 'support': 854021}, 'weighted avg': {'precision': 0.6651013154654416, 'recall': 0.49753226208723206, 'f1-score': 0.5225178186664524, 'support': 854021}}
[[ 60292  36070  47643]
 [ 75134 251915 241215]
 [ 12035  17021 112696]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.96501994
{'0': {'precision': 0.4755221398189552, 'recall': 0.37417399699635273, 'f1-score': 0.41880388060418317, 'support': 186440}, '1': {'precision': 0.7450412103459748, 'recall': 0.4494114920935737, 'f1-score': 0.5606418426262173, 'support': 483341}, '2': {'precision': 0.341066085567774, 'recall': 0.7696645679548415, 'f1-score': 0.4726735155098965, 'support': 184240}, 'accuracy': 0.5020754758957918, 'macro avg': {'precision': 0.5205431452442347, 'recall': 0.531083352348256, 'f1-score': 0.48403974624676566, 'support': 854021}, 'weighted avg': {'precision': 0.5990523968411626, 'recall': 0.5020754758957918, 'f1-score': 0.5106997987803411, 'support': 854021}}
[[ 69761  48519  68160]
 [ 60321 217219 205801]
 [ 16622  25815 141803]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9787329
{'0': {'precision': 0.5094027317995938, 'recall': 0.33872549019607845, 'f1-score': 0.4068905751774862, 'support': 216240}, '1': {'precision': 0.6770868824531516, 'recall': 0.4490823020952749, 'f1-score': 0.5400036514273826, 'support': 424813}, '2': {'precision': 0.3736174741465623, 'recall': 0.7516856992599827, 'f1-score': 0.4991417760947616, 'support': 212968}, 'accuracy': 0.49660020069764094, 'macro avg': {'precision': 0.5200356961331026, 'recall': 0.5131644971837787, 'f1-score': 0.4820120008998768, 'support': 854021}, 'weighted avg': {'precision': 0.5589524411624069, 'recall': 0.49660020069764094, 'f1-score': 0.49610936372940423, 'support': 854021}}
[[ 73246  58004  84990]
 [ 50639 190776 183398]
 [ 19903  32980 160085]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.002583
{'0': {'precision': 0.5356420772918953, 'recall': 0.28831391936693757, 'f1-score': 0.3748575586757189, 'support': 257289}, '1': {'precision': 0.5605532543838841, 'recall': 0.44587133593037903, 'f1-score': 0.49667830217506936, 'support': 344494}, '2': {'precision': 0.40929248637654636, 'recall': 0.7164265495286198, 'f1-score': 0.5209612601548672, 'support': 252238}, 'accuracy': 0.47831376511818796, 'macro avg': {'precision': 0.5018292726841086, 'recall': 0.4835372682753121, 'f1-score': 0.46416570700188514, 'support': 854021}, 'weighted avg': {'precision': 0.5083729386264783, 'recall': 0.47831376511818796, 'f1-score': 0.4671496927857264, 'support': 854021}}
[[ 74180  74124 108985]
 [ 39071 153600 151823]
 [ 25237  46291 180710]]
Evaluating performance on  train set...
1431/1431 - 11s - 11s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9003183
{'0': {'precision': 0.4473577202713033, 'recall': 0.3945545051571533, 'f1-score': 0.41930025154356276, 'support': 69709}, '1': {'precision': 0.775185203538069, 'recall': 0.5550632462256285, 'f1-score': 0.6469119593085767, 'support': 225468}, '2': {'precision': 0.337796215978377, 'recall': 0.6818931607664002, 'f1-score': 0.451786464901219, 'support': 70929}, 'accuracy': 0.5490732192315887, 'macro avg': {'precision': 0.5201130465959164, 'recall': 0.543836970716394, 'f1-score': 0.5059995585844529, 'support': 366106}, 'weighted avg': {'precision': 0.6280253931835149, 'recall': 0.5490732192315887, 'f1-score': 0.5657697744511561, 'support': 366106}}
[[ 27504  21331  20874]
 [ 26378 125149  73941]
 [  7599  14964  48366]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.92694
{'0': {'precision': 0.5083606714017262, 'recall': 0.36425254173465543, 'f1-score': 0.42440720330251075, 'support': 87637}, '1': {'precision': 0.688475413191424, 'recall': 0.5698290602815291, 'f1-score': 0.6235586155757862, 'support': 188897}, '2': {'precision': 0.3979641826792227, 'recall': 0.6529719108650025, 'f1-score': 0.4945294664750148, 'support': 89572}, 'accuracy': 0.5409608146274576, 'macro avg': {'precision': 0.5316000890907909, 'recall': 0.5290178376270623, 'f1-score': 0.5141650951177706, 'support': 366106}, 'weighted avg': {'precision': 0.5742833825618724, 'recall': 0.5409608146274576, 'f1-score': 0.5443180916274014, 'support': 366106}}
[[ 31922  27564  28151]
 [ 20929 107639  60329]
 [  9943  21141  58488]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9535614
{'0': {'precision': 0.5341773370559353, 'recall': 0.33399548532731377, 'f1-score': 0.41100761125206026, 'support': 99675}, '1': {'precision': 0.6183772832728818, 'recall': 0.575301571088088, 'f1-score': 0.5960622009720083, 'support': 164472}, '2': {'precision': 0.4287884114108338, 'recall': 0.6340587883364882, 'f1-score': 0.5116014054635815, 'support': 101959}, 'accuracy': 0.5259678890813043, 'macro avg': {'precision': 0.527114343913217, 'recall': 0.5144519482506299, 'f1-score': 0.5062237392292167, 'support': 366106}, 'weighted avg': {'precision': 0.542653527242233, 'recall': 0.5259678890813043, 'f1-score': 0.5221577730752256, 'support': 366106}}
[[33291 32518 33866]
 [17596 94621 52255]
 [11435 25876 64648]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9970931
{'0': {'precision': 0.5493559400306773, 'recall': 0.2881190259936854, 'f1-score': 0.37799314555482416, 'support': 115605}, '1': {'precision': 0.5056683767045002, 'recall': 0.5792418360356246, 'f1-score': 0.5399604050323926, 'support': 131370}, '2': {'precision': 0.4609299894832603, 'recall': 0.5996759869387481, 'f1-score': 0.5212277744945681, 'support': 119131}, 'accuracy': 0.49396349691073077, 'macro avg': {'precision': 0.5053181020728127, 'recall': 0.4890122829893528, 'f1-score': 0.47972710836059496, 'support': 366106}, 'weighted avg': {'precision': 0.5049056794263053, 'recall': 0.49396349691073077, 'f1-score': 0.48272052903881185, 'support': 366106}}
[[33308 40448 41849]
 [13573 76095 41702]
 [13750 33941 71440]]
Evaluating performance on  val set...
492/492 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9451708
{'0': {'precision': 0.4735885214485775, 'recall': 0.3505109648325272, 'f1-score': 0.4028590536699549, 'support': 27497}, '1': {'precision': 0.7332351083982319, 'recall': 0.4971316037331963, 'f1-score': 0.5925295958633828, 'support': 70074}, '2': {'precision': 0.3604157315009841, 'recall': 0.739968807599603, 'f1-score': 0.48473309030115874, 'support': 28212}, 'accuracy': 0.5195455665709993, 'macro avg': {'precision': 0.5224131204492645, 'recall': 0.5292037920551088, 'f1-score': 0.49337391327816543, 'support': 125783}, 'weighted avg': {'precision': 0.5928545922523314, 'recall': 0.5195455665709993, 'f1-score': 0.5268885639781984, 'support': 125783}}
[[ 9638  7968  9891]
 [ 8083 34836 27155]
 [ 2630  4706 20876]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9663852
{'0': {'precision': 0.528614311997676, 'recall': 0.31925843616585764, 'f1-score': 0.3980894042149785, 'support': 34198}, '1': {'precision': 0.6409485046894355, 'recall': 0.5094681318681319, 'f1-score': 0.5676949149221713, 'support': 56875}, '2': {'precision': 0.41531349610320256, 'recall': 0.7169691731489485, 'f1-score': 0.5259587238854075, 'support': 34710}, 'accuracy': 0.5150139526009079, 'macro avg': {'precision': 0.528292104263438, 'recall': 0.515231913727646, 'f1-score': 0.4972476810075191, 'support': 125783}, 'weighted avg': {'precision': 0.5481426734586575, 'recall': 0.5150139526009079, 'f1-score': 0.5100652475899352, 'support': 125783}}
[[10918  9876 13404]
 [ 6268 28976 21631]
 [ 3468  6356 24886]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.98673326
{'0': {'precision': 0.5500803427959293, 'recall': 0.2937413869315375, 'f1-score': 0.38297511695708186, 'support': 38459}, '1': {'precision': 0.5692297073440088, 'recall': 0.5103762686690321, 'f1-score': 0.5381988253208614, 'support': 48476}, '2': {'precision': 0.4417629730342171, 'recall': 0.7025586902800659, 'f1-score': 0.5424426115472524, 'support': 38848}, 'accuracy': 0.5034941128769389, 'macro avg': {'precision': 0.520357674391385, 'recall': 0.5022254486268785, 'f1-score': 0.4878721846083985, 'support': 125783}, 'weighted avg': {'precision': 0.52400663979417, 'recall': 0.5034941128769389, 'f1-score': 0.4920488210067669, 'support': 125783}}
[[11297 11143 16019]
 [ 5265 24741 18470]
 [ 3975  7580 27293]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0192394
{'0': {'precision': 0.5552059925093633, 'recall': 0.25328048113723345, 'f1-score': 0.3478668982024687, 'support': 43896}, '1': {'precision': 0.4551087294562331, 'recall': 0.5047358785917062, 'f1-score': 0.478639359935591, 'support': 37691}, '2': {'precision': 0.4658129680879341, 'recall': 0.6740881527740067, 'f1-score': 0.5509232291291042, 'support': 44196}, 'accuracy': 0.47648728365518395, 'macro avg': {'precision': 0.49204256335117685, 'recall': 0.47736817083431543, 'f1-score': 0.4591431624223879, 'support': 125783}, 'weighted avg': {'precision': 0.4938019868085531, 'recall': 0.47648728365518395, 'f1-score': 0.45840029664913234, 'support': 125783}}
[[11118 13198 19580]
 [ 4082 19024 14585]
 [ 4825  9579 29792]]
training model: results/ATVI/W9/deepOF_L1/seq2seq
Epoch 1/50
1431/1431 - 39s - loss: 12.6595 - accuracy10: 0.4396 - accuracy20: 0.4477 - accuracy30: 0.4472 - accuracy50: 0.4424 - val_loss: 13.8404 - val_accuracy10: 0.5096 - val_accuracy20: 0.4524 - val_accuracy30: 0.4138 - val_accuracy50: 0.3612 - 39s/epoch - 27ms/step
Epoch 2/50
1431/1431 - 32s - loss: 12.6692 - accuracy10: 0.4162 - accuracy20: 0.4269 - accuracy30: 0.4299 - accuracy50: 0.4270 - val_loss: 13.4865 - val_accuracy10: 0.4930 - val_accuracy20: 0.4491 - val_accuracy30: 0.4165 - val_accuracy50: 0.3661 - 32s/epoch - 22ms/step
Epoch 3/50
1431/1431 - 35s - loss: 12.6076 - accuracy10: 0.4292 - accuracy20: 0.4344 - accuracy30: 0.4349 - accuracy50: 0.4286 - val_loss: 13.4726 - val_accuracy10: 0.5004 - val_accuracy20: 0.4537 - val_accuracy30: 0.4188 - val_accuracy50: 0.3665 - 35s/epoch - 24ms/step
Epoch 4/50
1431/1431 - 36s - loss: 12.5607 - accuracy10: 0.4365 - accuracy20: 0.4389 - accuracy30: 0.4385 - accuracy50: 0.4317 - val_loss: 13.4629 - val_accuracy10: 0.5057 - val_accuracy20: 0.4555 - val_accuracy30: 0.4195 - val_accuracy50: 0.3664 - 36s/epoch - 25ms/step
Epoch 5/50
1431/1431 - 35s - loss: 12.5168 - accuracy10: 0.4415 - accuracy20: 0.4438 - accuracy30: 0.4430 - accuracy50: 0.4357 - val_loss: 13.4619 - val_accuracy10: 0.5108 - val_accuracy20: 0.4575 - val_accuracy30: 0.4193 - val_accuracy50: 0.3655 - 35s/epoch - 24ms/step
Epoch 6/50
1431/1431 - 34s - loss: 12.4661 - accuracy10: 0.4476 - accuracy20: 0.4485 - accuracy30: 0.4473 - accuracy50: 0.4404 - val_loss: 13.4875 - val_accuracy10: 0.5160 - val_accuracy20: 0.4608 - val_accuracy30: 0.4222 - val_accuracy50: 0.3678 - 34s/epoch - 24ms/step
Epoch 7/50
1431/1431 - 35s - loss: 12.4048 - accuracy10: 0.4541 - accuracy20: 0.4555 - accuracy30: 0.4545 - accuracy50: 0.4476 - val_loss: 13.5173 - val_accuracy10: 0.5241 - val_accuracy20: 0.4660 - val_accuracy30: 0.4241 - val_accuracy50: 0.3669 - 35s/epoch - 24ms/step
Epoch 8/50
1431/1431 - 34s - loss: 12.3364 - accuracy10: 0.4604 - accuracy20: 0.4618 - accuracy30: 0.4609 - accuracy50: 0.4540 - val_loss: 13.5305 - val_accuracy10: 0.5279 - val_accuracy20: 0.4690 - val_accuracy30: 0.4276 - val_accuracy50: 0.3700 - 34s/epoch - 24ms/step
Epoch 9/50
1431/1431 - 32s - loss: 12.2750 - accuracy10: 0.4633 - accuracy20: 0.4659 - accuracy30: 0.4658 - accuracy50: 0.4588 - val_loss: 13.5574 - val_accuracy10: 0.5319 - val_accuracy20: 0.4722 - val_accuracy30: 0.4316 - val_accuracy50: 0.3769 - 32s/epoch - 22ms/step
Epoch 10/50
1431/1431 - 30s - loss: 12.1940 - accuracy10: 0.4690 - accuracy20: 0.4727 - accuracy30: 0.4722 - accuracy50: 0.4656 - val_loss: 13.5448 - val_accuracy10: 0.5284 - val_accuracy20: 0.4720 - val_accuracy30: 0.4360 - val_accuracy50: 0.3866 - 30s/epoch - 21ms/step
Epoch 11/50
1431/1431 - 32s - loss: 12.1139 - accuracy10: 0.4739 - accuracy20: 0.4796 - accuracy30: 0.4800 - accuracy50: 0.4731 - val_loss: 13.6649 - val_accuracy10: 0.5363 - val_accuracy20: 0.4795 - val_accuracy30: 0.4421 - val_accuracy50: 0.3916 - 32s/epoch - 22ms/step
Epoch 12/50
1431/1431 - 32s - loss: 12.0431 - accuracy10: 0.4795 - accuracy20: 0.4864 - accuracy30: 0.4856 - accuracy50: 0.4788 - val_loss: 13.5148 - val_accuracy10: 0.5286 - val_accuracy20: 0.4786 - val_accuracy30: 0.4468 - val_accuracy50: 0.4045 - 32s/epoch - 22ms/step
Epoch 13/50
1431/1431 - 34s - loss: 11.9900 - accuracy10: 0.4850 - accuracy20: 0.4906 - accuracy30: 0.4906 - accuracy50: 0.4826 - val_loss: 13.5542 - val_accuracy10: 0.5320 - val_accuracy20: 0.4820 - val_accuracy30: 0.4513 - val_accuracy50: 0.4070 - 34s/epoch - 24ms/step
Epoch 14/50
1431/1431 - 31s - loss: 11.9353 - accuracy10: 0.4892 - accuracy20: 0.4950 - accuracy30: 0.4942 - accuracy50: 0.4861 - val_loss: 13.4306 - val_accuracy10: 0.5228 - val_accuracy20: 0.4801 - val_accuracy30: 0.4535 - val_accuracy50: 0.4168 - 31s/epoch - 22ms/step
Epoch 15/50
1431/1431 - 36s - loss: 11.8984 - accuracy10: 0.4938 - accuracy20: 0.4998 - accuracy30: 0.4983 - accuracy50: 0.4892 - val_loss: 13.5167 - val_accuracy10: 0.5323 - val_accuracy20: 0.4816 - val_accuracy30: 0.4512 - val_accuracy50: 0.4098 - 36s/epoch - 25ms/step
Epoch 16/50
1431/1431 - 31s - loss: 11.8589 - accuracy10: 0.4971 - accuracy20: 0.5030 - accuracy30: 0.5017 - accuracy50: 0.4912 - val_loss: 13.4846 - val_accuracy10: 0.5276 - val_accuracy20: 0.4834 - val_accuracy30: 0.4561 - val_accuracy50: 0.4162 - 31s/epoch - 22ms/step
Epoch 17/50
1431/1431 - 33s - loss: 11.8166 - accuracy10: 0.5000 - accuracy20: 0.5068 - accuracy30: 0.5046 - accuracy50: 0.4936 - val_loss: 13.5538 - val_accuracy10: 0.5280 - val_accuracy20: 0.4832 - val_accuracy30: 0.4557 - val_accuracy50: 0.4147 - 33s/epoch - 23ms/step
Epoch 18/50
1431/1431 - 34s - loss: 11.7903 - accuracy10: 0.5025 - accuracy20: 0.5098 - accuracy30: 0.5075 - accuracy50: 0.4963 - val_loss: 13.6116 - val_accuracy10: 0.5328 - val_accuracy20: 0.4849 - val_accuracy30: 0.4549 - val_accuracy50: 0.4120 - 34s/epoch - 23ms/step
Epoch 19/50
1431/1431 - 36s - loss: 11.7518 - accuracy10: 0.5053 - accuracy20: 0.5124 - accuracy30: 0.5097 - accuracy50: 0.4985 - val_loss: 13.5837 - val_accuracy10: 0.5296 - val_accuracy20: 0.4842 - val_accuracy30: 0.4548 - val_accuracy50: 0.4131 - 36s/epoch - 25ms/step
Epoch 20/50
1431/1431 - 35s - loss: 11.7273 - accuracy10: 0.5072 - accuracy20: 0.5148 - accuracy30: 0.5118 - accuracy50: 0.5001 - val_loss: 13.4834 - val_accuracy10: 0.5222 - val_accuracy20: 0.4832 - val_accuracy30: 0.4562 - val_accuracy50: 0.4175 - 35s/epoch - 25ms/step
Epoch 21/50
1431/1431 - 35s - loss: 11.6952 - accuracy10: 0.5095 - accuracy20: 0.5176 - accuracy30: 0.5144 - accuracy50: 0.5027 - val_loss: 13.5552 - val_accuracy10: 0.5265 - val_accuracy20: 0.4842 - val_accuracy30: 0.4558 - val_accuracy50: 0.4140 - 35s/epoch - 25ms/step
Epoch 22/50
1431/1431 - 34s - loss: 11.6683 - accuracy10: 0.5117 - accuracy20: 0.5190 - accuracy30: 0.5162 - accuracy50: 0.5029 - val_loss: 13.6591 - val_accuracy10: 0.5270 - val_accuracy20: 0.4832 - val_accuracy30: 0.4530 - val_accuracy50: 0.4112 - 34s/epoch - 24ms/step
Epoch 23/50
1431/1431 - 34s - loss: 11.6416 - accuracy10: 0.5125 - accuracy20: 0.5198 - accuracy30: 0.5176 - accuracy50: 0.5046 - val_loss: 13.6136 - val_accuracy10: 0.5245 - val_accuracy20: 0.4833 - val_accuracy30: 0.4549 - val_accuracy50: 0.4126 - 34s/epoch - 24ms/step
Epoch 24/50
1431/1431 - 35s - loss: 11.6221 - accuracy10: 0.5131 - accuracy20: 0.5220 - accuracy30: 0.5189 - accuracy50: 0.5056 - val_loss: 13.6607 - val_accuracy10: 0.5249 - val_accuracy20: 0.4839 - val_accuracy30: 0.4549 - val_accuracy50: 0.4129 - 35s/epoch - 24ms/step
testing model: results/ATVI/W9/deepOF_L1/seq2seq
Evaluating performance on  test set...
3337/3337 - 35s - 35s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9258284
{'0': {'precision': 0.2978730086939042, 'recall': 0.32928946418155053, 'f1-score': 0.31279436404174193, 'support': 144004}, '1': {'precision': 0.7296855908210401, 'recall': 0.646299959173905, 'f1-score': 0.6854661628665467, 'support': 568264}, '2': {'precision': 0.3083603133159269, 'recall': 0.4165884768146513, 'f1-score': 0.3543956621025119, 'support': 141749}, 'accuracy': 0.5547184657916646, 'macro avg': {'precision': 0.4453063042769571, 'recall': 0.4640593000567023, 'f1-score': 0.45088539633693353, 'support': 854017}, 'weighted avg': {'precision': 0.5869423247763264, 'recall': 0.5547184657916646, 'f1-score': 0.5676756011672265, 'support': 854017}}
[[ 47419  73119  23466]
 [ 92012 367269 108983]
 [ 19761  62937  59051]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.97234833
{'0': {'precision': 0.34962665424985834, 'recall': 0.33427555393453084, 'f1-score': 0.3417788160968708, 'support': 186439}, '1': {'precision': 0.6378002146931139, 'recall': 0.612170289712646, 'f1-score': 0.6247224887807875, 'support': 483341}, '2': {'precision': 0.36373592137684924, 'recall': 0.41824389237775256, 'f1-score': 0.3890901654451213, 'support': 184237}, 'accuracy': 0.509667840335731, 'macro avg': {'precision': 0.4503875967732738, 'recall': 0.4548965786749764, 'f1-score': 0.4518638234409265, 'support': 854017}, 'weighted avg': {'precision': 0.5157656724730072, 'recall': 0.509667840335731, 'f1-score': 0.5121205994203768, 'support': 854017}}
[[ 62322  89722  34395]
 [ 87059 295887 100395]
 [ 28872  78309  77056]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0042821
{'0': {'precision': 0.38079613339374907, 'recall': 0.3381150573436922, 'f1-score': 0.3581886278515492, 'support': 216240}, '1': {'precision': 0.5710085995475831, 'recall': 0.5930162212549993, 'f1-score': 0.5818043669796387, 'support': 424813}, '2': {'precision': 0.3975537522415636, 'recall': 0.41223399259968824, 'f1-score': 0.40476080702272055, 'support': 212964}, 'accuracy': 0.4833931877234294, 'macro avg': {'precision': 0.4497861617276319, 'recall': 0.4477884237327932, 'f1-score': 0.44825126728463616, 'support': 854017}, 'weighted avg': {'precision': 0.47959217366521284, 'recall': 0.4833931877234294, 'f1-score': 0.4810352111762727, 'support': 854017}}
[[ 73114 100943  42183]
 [ 82038 251921  90854]
 [ 36851  88322  87791]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0459924
{'0': {'precision': 0.4195036428492032, 'recall': 0.32270715032512076, 'f1-score': 0.3647934694021014, 'support': 257289}, '1': {'precision': 0.4672024103803065, 'recall': 0.5815543957224218, 'f1-score': 0.5181441757855234, 'support': 344494}, '2': {'precision': 0.4318844788215573, 'recall': 0.3891624443968696, 'f1-score': 0.40941197079561314, 'support': 252234}, 'accuracy': 0.44674871811685246, 'macro avg': {'precision': 0.43953017735035566, 'recall': 0.43114133014813744, 'f1-score': 0.430783205327746, 'support': 854017}, 'weighted avg': {'precision': 0.44240108751659346, 'recall': 0.44674871811685246, 'f1-score': 0.43983026764539357, 'support': 854017}}
[[ 83029 121369  52891]
 [ 67920 200342  76232]
 [ 46973 107101  98160]]
Evaluating performance on  train set...
1431/1431 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.92736864
{'0': {'precision': 0.3482862976209438, 'recall': 0.3447569086113978, 'f1-score': 0.34651261624012275, 'support': 69768}, '1': {'precision': 0.6947574762534948, 'recall': 0.682110453823845, 'f1-score': 0.6883758813354903, 'support': 225506}, '2': {'precision': 0.3522156416900217, 'recall': 0.3761435509374294, 'f1-score': 0.36378655889019357, 'support': 70832}, 'accuracy': 0.5586250976493147, 'macro avg': {'precision': 0.46508647185482016, 'recall': 0.4676703044575574, 'f1-score': 0.4662250188219356, 'support': 366106}, 'weighted avg': {'precision': 0.562458294003994, 'recall': 0.5586250976493147, 'f1-score': 0.5604281635526109, 'support': 366106}}
[[ 24053  34664  11051]
 [ 33736 153820  37950]
 [ 11272  32917  26643]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.97510934
{'0': {'precision': 0.40089947924885594, 'recall': 0.34731589500546844, 'f1-score': 0.3721889879135637, 'support': 87776}, '1': {'precision': 0.603218825162556, 'recall': 0.6627759183154683, 'f1-score': 0.6315964783454582, 'support': 188824}, '2': {'precision': 0.40795447666323625, 'recall': 0.37645520970661184, 'f1-score': 0.3915723906310829, 'support': 89506}, 'accuracy': 0.5171425761937799, 'macro avg': {'precision': 0.47069092702488274, 'recall': 0.46218234100918293, 'f1-score': 0.46511928563003485, 'support': 366106}, 'weighted avg': {'precision': 0.5069731649338215, 'recall': 0.5171425761937799, 'f1-score': 0.5107206995406507, 'support': 366106}}
[[ 30486  41970  15320]
 [ 30096 125148  33580]
 [ 15462  40349  33695]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0086974
{'0': {'precision': 0.42570266317639394, 'recall': 0.34779160014859883, 'f1-score': 0.3828232927732281, 'support': 99597}, '1': {'precision': 0.5357591786249409, 'recall': 0.6472825129541547, 'f1-score': 0.5862642879740306, 'support': 164619}, '2': {'precision': 0.43567343420577515, 'recall': 0.3670919619197173, 'f1-score': 0.398453188168807, 'support': 101890}, 'accuracy': 0.4878286616444418, 'macro avg': {'precision': 0.4657117586690367, 'recall': 0.4540553583408236, 'f1-score': 0.4558469229720219, 'support': 366106}, 'weighted avg': {'precision': 0.47796434524882114, 'recall': 0.4878286616444418, 'f1-score': 0.4786501386343078, 'support': 366106}}
[[ 34639  46805  18153]
 [ 27769 106555  30295]
 [ 18961  45526  37403]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0540237
{'0': {'precision': 0.45516317350942676, 'recall': 0.3293144187576274, 'f1-score': 0.3821442381571745, 'support': 115537}, '1': {'precision': 0.4338389323231647, 'recall': 0.6414596096038964, 'f1-score': 0.5176053743368049, 'support': 131405}, '2': {'precision': 0.46985479976876776, 'recall': 0.3478567352556141, 'f1-score': 0.3997550473269781, 'support': 119164}, 'accuracy': 0.4473868223956996, 'macro avg': {'precision': 0.4529523018671197, 'recall': 0.4395435878723793, 'f1-score': 0.43316821994031923, 'support': 366106}, 'weighted avg': {'precision': 0.45229133048715275, 'recall': 0.4473868223956996, 'f1-score': 0.4364969258039074, 'support': 366106}}
[[38048 55427 22062]
 [22405 84291 24709]
 [23139 54573 41452]]
Evaluating performance on  val set...
492/492 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.96689713
{'0': {'precision': 0.3603907708192685, 'recall': 0.3298680527788884, 'f1-score': 0.34445456615805053, 'support': 27511}, '1': {'precision': 0.6351305342575821, 'recall': 0.6645908741129193, 'f1-score': 0.6495268204703245, 'support': 70174}, '2': {'precision': 0.376403047142384, 'recall': 0.36401167342871377, 'f1-score': 0.37010367100287667, 'support': 28098}, 'accuracy': 0.5242361845400412, 'macro avg': {'precision': 0.45730811740641153, 'recall': 0.4528235334401738, 'f1-score': 0.4546950192104173, 'support': 125783}, 'weighted avg': {'precision': 0.5172442494264501, 'recall': 0.5242361845400412, 'f1-score': 0.5203831806929197, 'support': 125783}}
[[ 9075 13579  4857]
 [11449 46637 12088]
 [ 4657 13213 10228]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.015386
{'0': {'precision': 0.40832859579306424, 'recall': 0.33630856574288137, 'f1-score': 0.3688357538313407, 'support': 34171}, '1': {'precision': 0.5357670051960322, 'recall': 0.6369667082009792, 'f1-score': 0.5820004008819403, 'support': 56981}, '2': {'precision': 0.4234821876567988, 'recall': 0.365568421356588, 'f1-score': 0.39239996280569067, 'support': 34631}, 'accuracy': 0.48056573622826615, 'macro avg': {'precision': 0.45585926288196504, 'recall': 0.44628123176681617, 'f1-score': 0.44774537250632385, 'support': 125783}, 'weighted avg': {'precision': 0.47023165142080015, 'recall': 0.48056573622826615, 'f1-score': 0.4718893212814805, 'support': 125783}}
[[11492 15952  6727]
 [10178 36295 10508]
 [ 6474 15497 12660]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0455624
{'0': {'precision': 0.4318398788557132, 'recall': 0.3414811922426136, 'f1-score': 0.3813815559948831, 'support': 38415}, '1': {'precision': 0.4661712701157483, 'recall': 0.6164177567205685, 'f1-score': 0.5308685779165484, 'support': 48545}, '2': {'precision': 0.4486304661220567, 'recall': 0.3607140097364964, 'f1-score': 0.3998971986635827, 'support': 38823}, 'accuracy': 0.4535271062067211, 'macro avg': {'precision': 0.4488805383645061, 'recall': 0.4395376528998929, 'f1-score': 0.4373824441916714, 'support': 125783}, 'weighted avg': {'precision': 0.4502722453771005, 'recall': 0.4535271062067211, 'f1-score': 0.4447898088948312, 'support': 125783}}
[[13118 17382  7915]
 [ 9325 29924  9296]
 [ 7934 16885 14004]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.084364
{'0': {'precision': 0.4554471233575711, 'recall': 0.3255596589613824, 'f1-score': 0.3797027465369174, 'support': 43866}, '1': {'precision': 0.36623276319812065, 'recall': 0.6031960566067738, 'f1-score': 0.45575323128059836, 'support': 37734}, '2': {'precision': 0.47595885742611066, 'recall': 0.34771292125930786, 'f1-score': 0.4018519245105348, 'support': 44183}, 'accuracy': 0.4166302282502405, 'macro avg': {'precision': 0.43254624799393415, 'recall': 0.4254895456091547, 'f1-score': 0.41243596744268346, 'support': 125783}, 'weighted avg': {'precision': 0.43588848093445814, 'recall': 0.4166302282502405, 'f1-score': 0.4102975496639409, 'support': 125783}}
[[14281 20077  9508]
 [ 7566 22761  7407]
 [ 9509 19311 15363]]
training model: results/ATVI/W9/deepLOB_L2/seq2seq
Epoch 1/50
1431/1431 - 76s - loss: 12.1693 - accuracy10: 0.4496 - accuracy20: 0.4688 - accuracy30: 0.4738 - accuracy50: 0.4689 - val_loss: 14.9227 - val_accuracy10: 0.3393 - val_accuracy20: 0.3597 - val_accuracy30: 0.3722 - val_accuracy50: 0.3818 - 76s/epoch - 53ms/step
Epoch 2/50
1431/1431 - 69s - loss: 11.9188 - accuracy10: 0.4593 - accuracy20: 0.4836 - accuracy30: 0.4913 - accuracy50: 0.4848 - val_loss: 13.2092 - val_accuracy10: 0.3104 - val_accuracy20: 0.3582 - val_accuracy30: 0.3889 - val_accuracy50: 0.4227 - 69s/epoch - 48ms/step
Epoch 3/50
1431/1431 - 67s - loss: 11.7720 - accuracy10: 0.4687 - accuracy20: 0.4921 - accuracy30: 0.4990 - accuracy50: 0.4917 - val_loss: 12.6691 - val_accuracy10: 0.3539 - val_accuracy20: 0.4011 - val_accuracy30: 0.4264 - val_accuracy50: 0.4528 - 67s/epoch - 47ms/step
Epoch 4/50
1431/1431 - 68s - loss: 11.2415 - accuracy10: 0.5394 - accuracy20: 0.5456 - accuracy30: 0.5411 - accuracy50: 0.5215 - val_loss: 12.3076 - val_accuracy10: 0.5883 - val_accuracy20: 0.5585 - val_accuracy30: 0.5275 - val_accuracy50: 0.4794 - 68s/epoch - 47ms/step
Epoch 5/50
1431/1431 - 70s - loss: 10.8571 - accuracy10: 0.5816 - accuracy20: 0.5791 - accuracy30: 0.5659 - accuracy50: 0.5363 - val_loss: 12.0541 - val_accuracy10: 0.5972 - val_accuracy20: 0.5693 - val_accuracy30: 0.5400 - val_accuracy50: 0.4920 - 70s/epoch - 49ms/step
Epoch 6/50
1431/1431 - 69s - loss: 10.6610 - accuracy10: 0.5948 - accuracy20: 0.5906 - accuracy30: 0.5763 - accuracy50: 0.5436 - val_loss: 12.0654 - val_accuracy10: 0.6001 - val_accuracy20: 0.5697 - val_accuracy30: 0.5393 - val_accuracy50: 0.4905 - 69s/epoch - 48ms/step
Epoch 7/50
1431/1431 - 68s - loss: 10.5509 - accuracy10: 0.5998 - accuracy20: 0.5949 - accuracy30: 0.5802 - accuracy50: 0.5481 - val_loss: 12.1515 - val_accuracy10: 0.5970 - val_accuracy20: 0.5666 - val_accuracy30: 0.5369 - val_accuracy50: 0.4903 - 68s/epoch - 48ms/step
Epoch 8/50
1431/1431 - 67s - loss: 10.4778 - accuracy10: 0.6019 - accuracy20: 0.5975 - accuracy30: 0.5837 - accuracy50: 0.5506 - val_loss: 12.1333 - val_accuracy10: 0.5891 - val_accuracy20: 0.5612 - val_accuracy30: 0.5349 - val_accuracy50: 0.4928 - 67s/epoch - 47ms/step
Epoch 9/50
1431/1431 - 68s - loss: 10.4265 - accuracy10: 0.6042 - accuracy20: 0.5994 - accuracy30: 0.5854 - accuracy50: 0.5523 - val_loss: 12.1086 - val_accuracy10: 0.5855 - val_accuracy20: 0.5615 - val_accuracy30: 0.5371 - val_accuracy50: 0.4955 - 68s/epoch - 48ms/step
Epoch 10/50
1431/1431 - 68s - loss: 10.3849 - accuracy10: 0.6058 - accuracy20: 0.6005 - accuracy30: 0.5861 - accuracy50: 0.5542 - val_loss: 12.0166 - val_accuracy10: 0.5868 - val_accuracy20: 0.5630 - val_accuracy30: 0.5393 - val_accuracy50: 0.4991 - 68s/epoch - 47ms/step
Epoch 11/50
1431/1431 - 68s - loss: 10.3502 - accuracy10: 0.6065 - accuracy20: 0.6019 - accuracy30: 0.5880 - accuracy50: 0.5557 - val_loss: 11.9805 - val_accuracy10: 0.5892 - val_accuracy20: 0.5661 - val_accuracy30: 0.5412 - val_accuracy50: 0.4998 - 68s/epoch - 47ms/step
Epoch 12/50
1431/1431 - 68s - loss: 10.3214 - accuracy10: 0.6078 - accuracy20: 0.6037 - accuracy30: 0.5900 - accuracy50: 0.5575 - val_loss: 11.9810 - val_accuracy10: 0.5915 - val_accuracy20: 0.5683 - val_accuracy30: 0.5433 - val_accuracy50: 0.5015 - 68s/epoch - 48ms/step
Epoch 13/50
1431/1431 - 67s - loss: 10.2921 - accuracy10: 0.6095 - accuracy20: 0.6048 - accuracy30: 0.5912 - accuracy50: 0.5587 - val_loss: 12.0142 - val_accuracy10: 0.5749 - val_accuracy20: 0.5580 - val_accuracy30: 0.5386 - val_accuracy50: 0.5018 - 67s/epoch - 47ms/step
Epoch 14/50
1431/1431 - 68s - loss: 10.2615 - accuracy10: 0.6106 - accuracy20: 0.6067 - accuracy30: 0.5918 - accuracy50: 0.5596 - val_loss: 11.9632 - val_accuracy10: 0.5807 - val_accuracy20: 0.5626 - val_accuracy30: 0.5419 - val_accuracy50: 0.5019 - 68s/epoch - 48ms/step
Epoch 15/50
1431/1431 - 68s - loss: 10.2415 - accuracy10: 0.6116 - accuracy20: 0.6072 - accuracy30: 0.5933 - accuracy50: 0.5608 - val_loss: 12.0769 - val_accuracy10: 0.5768 - val_accuracy20: 0.5599 - val_accuracy30: 0.5391 - val_accuracy50: 0.5019 - 68s/epoch - 47ms/step
Epoch 16/50
1431/1431 - 68s - loss: 10.2172 - accuracy10: 0.6122 - accuracy20: 0.6078 - accuracy30: 0.5938 - accuracy50: 0.5616 - val_loss: 12.0648 - val_accuracy10: 0.5756 - val_accuracy20: 0.5589 - val_accuracy30: 0.5378 - val_accuracy50: 0.5002 - 68s/epoch - 47ms/step
Epoch 17/50
1431/1431 - 68s - loss: 10.1881 - accuracy10: 0.6130 - accuracy20: 0.6092 - accuracy30: 0.5950 - accuracy50: 0.5630 - val_loss: 12.1042 - val_accuracy10: 0.5712 - val_accuracy20: 0.5544 - val_accuracy30: 0.5351 - val_accuracy50: 0.4994 - 68s/epoch - 47ms/step
Epoch 18/50
1431/1431 - 68s - loss: 10.1664 - accuracy10: 0.6138 - accuracy20: 0.6103 - accuracy30: 0.5967 - accuracy50: 0.5641 - val_loss: 12.0045 - val_accuracy10: 0.5721 - val_accuracy20: 0.5580 - val_accuracy30: 0.5385 - val_accuracy50: 0.5020 - 68s/epoch - 47ms/step
Epoch 19/50
1431/1431 - 67s - loss: 10.1421 - accuracy10: 0.6154 - accuracy20: 0.6112 - accuracy30: 0.5976 - accuracy50: 0.5652 - val_loss: 12.0608 - val_accuracy10: 0.5654 - val_accuracy20: 0.5517 - val_accuracy30: 0.5334 - val_accuracy50: 0.5002 - 67s/epoch - 47ms/step
Epoch 20/50
1431/1431 - 69s - loss: 10.1243 - accuracy10: 0.6147 - accuracy20: 0.6116 - accuracy30: 0.5983 - accuracy50: 0.5663 - val_loss: 11.9949 - val_accuracy10: 0.5478 - val_accuracy20: 0.5421 - val_accuracy30: 0.5289 - val_accuracy50: 0.5001 - 69s/epoch - 48ms/step
Epoch 21/50
1431/1431 - 68s - loss: 10.1149 - accuracy10: 0.6155 - accuracy20: 0.6127 - accuracy30: 0.5987 - accuracy50: 0.5663 - val_loss: 12.1119 - val_accuracy10: 0.5612 - val_accuracy20: 0.5493 - val_accuracy30: 0.5315 - val_accuracy50: 0.4992 - 68s/epoch - 47ms/step
Epoch 22/50
1431/1431 - 69s - loss: 10.0849 - accuracy10: 0.6167 - accuracy20: 0.6135 - accuracy30: 0.6000 - accuracy50: 0.5681 - val_loss: 12.0459 - val_accuracy10: 0.5627 - val_accuracy20: 0.5507 - val_accuracy30: 0.5324 - val_accuracy50: 0.4999 - 69s/epoch - 48ms/step
Epoch 23/50
1431/1431 - 68s - loss: 10.0642 - accuracy10: 0.6167 - accuracy20: 0.6141 - accuracy30: 0.6008 - accuracy50: 0.5686 - val_loss: 12.2591 - val_accuracy10: 0.5469 - val_accuracy20: 0.5379 - val_accuracy30: 0.5224 - val_accuracy50: 0.4940 - 68s/epoch - 47ms/step
Epoch 24/50
1431/1431 - 68s - loss: 10.0469 - accuracy10: 0.6181 - accuracy20: 0.6153 - accuracy30: 0.6022 - accuracy50: 0.5703 - val_loss: 12.2244 - val_accuracy10: 0.5403 - val_accuracy20: 0.5337 - val_accuracy30: 0.5195 - val_accuracy50: 0.4931 - 68s/epoch - 47ms/step
testing model: results/ATVI/W9/deepLOB_L2/seq2seq
Evaluating performance on  test set...
3337/3337 - 54s - 54s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.87380564
{'0': {'precision': 0.43306934131096747, 'recall': 0.4503524183188084, 'f1-score': 0.4415418185779403, 'support': 144005}, '1': {'precision': 0.8400817803680116, 'recall': 0.56616642968761, 'f1-score': 0.6764468730847388, 'support': 568264}, '2': {'precision': 0.32539247787059744, 'recall': 0.737527512839325, 'f1-score': 0.4515596789937889, 'support': 141752}, 'accuracy': 0.5750807064463286, 'macro avg': {'precision': 0.5328478665165255, 'recall': 0.5846821202819145, 'f1-score': 0.5231827902188226, 'support': 854021}, 'weighted avg': {'precision': 0.6860222615809757, 'recall': 0.5750807064463286, 'f1-score': 0.5995099922457059, 'support': 854021}}
[[ 64853  38128  41024]
 [ 70810 321732 175722]
 [ 14089  23117 104546]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8981824
{'0': {'precision': 0.5005976844763209, 'recall': 0.3998229993563613, 'f1-score': 0.44457101279864497, 'support': 186440}, '1': {'precision': 0.7575035835163697, 'recall': 0.5751053603977316, 'f1-score': 0.6538217732821043, 'support': 483341}, '2': {'precision': 0.38684331149916457, 'recall': 0.7100141120277899, 'f1-score': 0.5008202605308244, 'support': 184240}, 'accuracy': 0.5659439287792689, 'macro avg': {'precision': 0.5483148598306183, 'recall': 0.5616474905939609, 'f1-score': 0.5330710155371913, 'support': 854021}, 'weighted avg': {'precision': 0.6214554250595207, 'recall': 0.5659439287792689, 'f1-score': 0.5751331807371529, 'support': 854021}}
[[ 74543  54979  56918]
 [ 54945 277972 150424]
 [ 19420  34007 130813]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9203193
{'0': {'precision': 0.5297168460929021, 'recall': 0.3679430262671106, 'f1-score': 0.4342527173542262, 'support': 216240}, '1': {'precision': 0.6885866816521495, 'recall': 0.5768844173789408, 'f1-score': 0.6278056084630332, 'support': 424813}, '2': {'precision': 0.4195935847321223, 'recall': 0.685478569550355, 'f1-score': 0.5205495571308354, 'support': 212968}, 'accuracy': 0.5510602198306599, 'macro avg': {'precision': 0.5459657041590581, 'recall': 0.5434353377321355, 'f1-score': 0.5275359609826983, 'support': 854021}, 'weighted avg': {'precision': 0.581281433764573, 'recall': 0.5510602198306599, 'f1-score': 0.5520510498356881, 'support': 854021}}
[[ 79564  67515  69161]
 [ 46971 245068 132774]
 [ 23666  43317 145985]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.96380776
{'0': {'precision': 0.5446046922447085, 'recall': 0.3283156295061196, 'f1-score': 0.40966449723081705, 'support': 257289}, '1': {'precision': 0.5735201012978791, 'recall': 0.5679895731130296, 'f1-score': 0.570741439709713, 'support': 344494}, '2': {'precision': 0.4519989266007346, 'recall': 0.6410572554492185, 'f1-score': 0.5301780386242172, 'support': 252238}, 'accuracy': 0.5173643271067105, 'macro avg': {'precision': 0.5233745733811074, 'recall': 0.5124541526894558, 'f1-score': 0.5035279918549157, 'support': 854021}, 'weighted avg': {'precision': 0.5289171293063947, 'recall': 0.5173643271067105, 'f1-score': 0.5102336107260511, 'support': 854021}}
[[ 84472  86310  86507]
 [ 39289 195669 109536]
 [ 31346  59193 161699]]
Evaluating performance on  train set...
1431/1431 - 23s - 23s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8279426
{'0': {'precision': 0.4677091565993, 'recall': 0.47540489750247455, 'f1-score': 0.47152562871269516, 'support': 69709}, '1': {'precision': 0.8192260975186535, 'recall': 0.6281867049869605, 'f1-score': 0.7110990616480655, 'support': 225468}, '2': {'precision': 0.3863108859104282, 'recall': 0.6664269903706523, 'f1-score': 0.48910181127741353, 'support': 70929}, 'accuracy': 0.6065046735098578, 'macro avg': {'precision': 0.557748713342794, 'recall': 0.5900061976200291, 'f1-score': 0.5572421672127247, 'support': 366106}, 'weighted avg': {'precision': 0.6684224027452627, 'recall': 0.6065046735098578, 'f1-score': 0.622473178958266, 'support': 366106}}
[[ 33140  18096  18473]
 [ 27214 141636  56618]
 [ 10502  13158  47269]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8607459
{'0': {'precision': 0.529836083978893, 'recall': 0.43079977635017175, 'f1-score': 0.4752128791073238, 'support': 87637}, '1': {'precision': 0.733566647290422, 'recall': 0.6480304081060049, 'f1-score': 0.6881507049537902, 'support': 188897}, '2': {'precision': 0.44622945952070264, 'recall': 0.6375653105881303, 'f1-score': 0.5250079291752279, 'support': 89572}, 'accuracy': 0.5934701971560149, 'macro avg': {'precision': 0.5698773969300058, 'recall': 0.5721318316814356, 'f1-score': 0.562790504412114, 'support': 366106}, 'weighted avg': {'precision': 0.614498120798527, 'recall': 0.5934701971560149, 'f1-score': 0.5972637570323025, 'support': 366106}}
[[ 37754  25360  24523]
 [ 20138 122411  46348]
 [ 13364  19100  57108]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8925634
{'0': {'precision': 0.5524248396857563, 'recall': 0.39929771758214194, 'f1-score': 0.4635426069030579, 'support': 99675}, '1': {'precision': 0.6637194747821819, 'recall': 0.6576985748334063, 'f1-score': 0.6606953080146099, 'support': 164472}, '2': {'precision': 0.4758239243210253, 'recall': 0.6117262821330143, 'f1-score': 0.535283793699767, 'support': 101959}, 'accuracy': 0.5745439845290709, 'macro avg': {'precision': 0.5639894129296545, 'recall': 0.5562408581828542, 'f1-score': 0.5531739028724783, 'support': 366106}, 'weighted avg': {'precision': 0.5810905771877549, 'recall': 0.5745439845290709, 'f1-score': 0.5720924769456817, 'support': 366106}}
[[ 39800  30698  29177]
 [ 16767 108173  39532]
 [ 15479  24109  62371]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.94979304
{'0': {'precision': 0.5561206594177481, 'recall': 0.35658492279745685, 'f1-score': 0.43454153512077626, 'support': 115605}, '1': {'precision': 0.5496389491870819, 'recall': 0.6611022303417827, 'f1-score': 0.6002398222412666, 'support': 131370}, '2': {'precision': 0.5026535989669252, 'recall': 0.5652600918316811, 'f1-score': 0.532121691031213, 'support': 119131}, 'accuracy': 0.5337579826607595, 'macro avg': {'precision': 0.5361377358572518, 'recall': 0.5276490816569736, 'f1-score': 0.5223010161310853, 'support': 366106}, 'weighted avg': {'precision': 0.5363966268928247, 'recall': 0.5337579826607595, 'f1-score': 0.5257517461874757, 'support': 366106}}
[[41223 38870 35512]
 [13404 86849 31117]
 [19499 32292 67340]]
Evaluating performance on  val set...
492/492 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.88207185
{'0': {'precision': 0.5008388558006879, 'recall': 0.4342655562424992, 'f1-score': 0.4651824149282222, 'support': 27497}, '1': {'precision': 0.770130346979989, 'recall': 0.5986385820703828, 'f1-score': 0.673641443987667, 'support': 70074}, '2': {'precision': 0.4064376145436161, 'recall': 0.6838933787040975, 'f1-score': 0.5098635096388885, 'support': 28212}, 'accuracy': 0.581827432959939, 'macro avg': {'precision': 0.5591356057747643, 'recall': 0.5722658390056597, 'f1-score': 0.5495624561849258, 'support': 125783}, 'weighted avg': {'precision': 0.6296884152368106, 'recall': 0.581827432959939, 'f1-score': 0.5913369910338077, 'support': 125783}}
[[11941  7527  8029]
 [ 7977 41949 20148]
 [ 3924  4994 19294]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9175467
{'0': {'precision': 0.5538041193778899, 'recall': 0.3852564477454822, 'f1-score': 0.4544043595226599, 'support': 34198}, '1': {'precision': 0.6676860736266677, 'recall': 0.614189010989011, 'f1-score': 0.639821233961884, 'support': 56875}, '2': {'precision': 0.46007045797684953, 'recall': 0.6584269662921348, 'f1-score': 0.5416602476743497, 'support': 34710}, 'accuracy': 0.5641541384765827, 'macro avg': {'precision': 0.5605202169938023, 'recall': 0.5526241416755426, 'f1-score': 0.5452952803862979, 'support': 125783}, 'weighted avg': {'precision': 0.5794319129642183, 'recall': 0.5641541384765827, 'f1-score': 0.5623222547189585, 'support': 125783}}
[[13175 10416 10607]
 [ 5729 34932 16214]
 [ 4886  6970 22854]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9459498
{'0': {'precision': 0.566759532620899, 'recall': 0.3544033906237812, 'f1-score': 0.4361041786651309, 'support': 38459}, '1': {'precision': 0.589565012099392, 'recall': 0.6181821932502681, 'f1-score': 0.6035345652283368, 'support': 48476}, '2': {'precision': 0.48439249582555743, 'recall': 0.6347302306425041, 'f1-score': 0.549463527681526, 'support': 38848}, 'accuracy': 0.54264089741857, 'macro avg': {'precision': 0.5469056801819495, 'recall': 0.5357719381721845, 'f1-score': 0.5297007571916645, 'support': 125783}, 'weighted avg': {'precision': 0.5501096179088473, 'recall': 0.54264089741857, 'f1-score': 0.5356417903425983, 'support': 125783}}
[[13630 12300 12529]
 [ 4791 29967 13718]
 [ 5628  8562 24658]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9938139
{'0': {'precision': 0.5630150753768844, 'recall': 0.3190495717149626, 'f1-score': 0.40729377208416334, 'support': 43896}, '1': {'precision': 0.47403702261126257, 'recall': 0.6135151627709533, 'f1-score': 0.5348320843741327, 'support': 37691}, '2': {'precision': 0.5023692136512747, 'recall': 0.59251968503937, 'f1-score': 0.5437330647924171, 'support': 44196}, 'accuracy': 0.5033748598777259, 'macro avg': {'precision': 0.5131404372131406, 'recall': 0.5083614731750953, 'f1-score': 0.49528630708357096, 'support': 125783}, 'weighted avg': {'precision': 0.5150437573799047, 'recall': 0.5033748598777259, 'f1-score': 0.4934510231360163, 'support': 125783}}
[[14005 14631 15260]
 [ 3887 23124 10680]
 [ 6983 11026 26187]]
training model: results/ATVI/W9/deepOF_L2/seq2seq
Epoch 1/50
1431/1431 - 47s - loss: 11.5522 - accuracy10: 0.5277 - accuracy20: 0.5294 - accuracy30: 0.5211 - accuracy50: 0.5003 - val_loss: 12.3646 - val_accuracy10: 0.5970 - val_accuracy20: 0.5629 - val_accuracy30: 0.5276 - val_accuracy50: 0.4688 - 47s/epoch - 33ms/step
Epoch 2/50
1431/1431 - 42s - loss: 10.7571 - accuracy10: 0.5864 - accuracy20: 0.5826 - accuracy30: 0.5684 - accuracy50: 0.5385 - val_loss: 12.5996 - val_accuracy10: 0.6099 - val_accuracy20: 0.5701 - val_accuracy30: 0.5339 - val_accuracy50: 0.4720 - 42s/epoch - 29ms/step
Epoch 3/50
1431/1431 - 42s - loss: 10.6064 - accuracy10: 0.5955 - accuracy20: 0.5900 - accuracy30: 0.5752 - accuracy50: 0.5445 - val_loss: 12.4970 - val_accuracy10: 0.6103 - val_accuracy20: 0.5715 - val_accuracy30: 0.5348 - val_accuracy50: 0.4745 - 42s/epoch - 29ms/step
Epoch 4/50
1431/1431 - 41s - loss: 10.5228 - accuracy10: 0.6001 - accuracy20: 0.5948 - accuracy30: 0.5786 - accuracy50: 0.5475 - val_loss: 12.4260 - val_accuracy10: 0.6104 - val_accuracy20: 0.5731 - val_accuracy30: 0.5383 - val_accuracy50: 0.4794 - 41s/epoch - 29ms/step
Epoch 5/50
1431/1431 - 42s - loss: 10.4684 - accuracy10: 0.6025 - accuracy20: 0.5967 - accuracy30: 0.5813 - accuracy50: 0.5493 - val_loss: 12.5098 - val_accuracy10: 0.6099 - val_accuracy20: 0.5712 - val_accuracy30: 0.5369 - val_accuracy50: 0.4774 - 42s/epoch - 29ms/step
Epoch 6/50
1431/1431 - 41s - loss: 10.4203 - accuracy10: 0.6052 - accuracy20: 0.5996 - accuracy30: 0.5836 - accuracy50: 0.5519 - val_loss: 12.4692 - val_accuracy10: 0.6082 - val_accuracy20: 0.5715 - val_accuracy30: 0.5379 - val_accuracy50: 0.4808 - 41s/epoch - 29ms/step
Epoch 7/50
1431/1431 - 41s - loss: 10.3770 - accuracy10: 0.6064 - accuracy20: 0.6009 - accuracy30: 0.5855 - accuracy50: 0.5541 - val_loss: 12.3688 - val_accuracy10: 0.6065 - val_accuracy20: 0.5714 - val_accuracy30: 0.5393 - val_accuracy50: 0.4821 - 41s/epoch - 29ms/step
Epoch 8/50
1431/1431 - 44s - loss: 10.3410 - accuracy10: 0.6082 - accuracy20: 0.6025 - accuracy30: 0.5873 - accuracy50: 0.5557 - val_loss: 12.4415 - val_accuracy10: 0.6046 - val_accuracy20: 0.5700 - val_accuracy30: 0.5385 - val_accuracy50: 0.4823 - 44s/epoch - 31ms/step
Epoch 9/50
1431/1431 - 43s - loss: 10.3061 - accuracy10: 0.6100 - accuracy20: 0.6044 - accuracy30: 0.5895 - accuracy50: 0.5570 - val_loss: 12.4053 - val_accuracy10: 0.6015 - val_accuracy20: 0.5691 - val_accuracy30: 0.5374 - val_accuracy50: 0.4824 - 43s/epoch - 30ms/step
Epoch 10/50
1431/1431 - 41s - loss: 10.2765 - accuracy10: 0.6108 - accuracy20: 0.6052 - accuracy30: 0.5901 - accuracy50: 0.5586 - val_loss: 12.4640 - val_accuracy10: 0.6082 - val_accuracy20: 0.5736 - val_accuracy30: 0.5402 - val_accuracy50: 0.4833 - 41s/epoch - 29ms/step
Epoch 11/50
1431/1431 - 42s - loss: 10.2496 - accuracy10: 0.6120 - accuracy20: 0.6068 - accuracy30: 0.5918 - accuracy50: 0.5607 - val_loss: 12.3479 - val_accuracy10: 0.6021 - val_accuracy20: 0.5700 - val_accuracy30: 0.5393 - val_accuracy50: 0.4841 - 42s/epoch - 29ms/step
Epoch 12/50
1431/1431 - 41s - loss: 10.2157 - accuracy10: 0.6128 - accuracy20: 0.6080 - accuracy30: 0.5925 - accuracy50: 0.5621 - val_loss: 12.2414 - val_accuracy10: 0.6015 - val_accuracy20: 0.5694 - val_accuracy30: 0.5399 - val_accuracy50: 0.4872 - 41s/epoch - 29ms/step
Epoch 13/50
1431/1431 - 42s - loss: 10.1846 - accuracy10: 0.6133 - accuracy20: 0.6097 - accuracy30: 0.5942 - accuracy50: 0.5641 - val_loss: 12.2331 - val_accuracy10: 0.5990 - val_accuracy20: 0.5701 - val_accuracy30: 0.5422 - val_accuracy50: 0.4909 - 42s/epoch - 29ms/step
Epoch 14/50
1431/1431 - 42s - loss: 10.1520 - accuracy10: 0.6148 - accuracy20: 0.6109 - accuracy30: 0.5962 - accuracy50: 0.5660 - val_loss: 12.2265 - val_accuracy10: 0.6013 - val_accuracy20: 0.5706 - val_accuracy30: 0.5403 - val_accuracy50: 0.4893 - 42s/epoch - 29ms/step
Epoch 15/50
1431/1431 - 42s - loss: 10.1291 - accuracy10: 0.6154 - accuracy20: 0.6115 - accuracy30: 0.5966 - accuracy50: 0.5672 - val_loss: 12.2845 - val_accuracy10: 0.5958 - val_accuracy20: 0.5658 - val_accuracy30: 0.5382 - val_accuracy50: 0.4888 - 42s/epoch - 29ms/step
Epoch 16/50
1431/1431 - 41s - loss: 10.1029 - accuracy10: 0.6155 - accuracy20: 0.6120 - accuracy30: 0.5974 - accuracy50: 0.5692 - val_loss: 12.2760 - val_accuracy10: 0.5867 - val_accuracy20: 0.5603 - val_accuracy30: 0.5322 - val_accuracy50: 0.4871 - 41s/epoch - 29ms/step
Epoch 17/50
1431/1431 - 41s - loss: 10.0780 - accuracy10: 0.6165 - accuracy20: 0.6134 - accuracy30: 0.5991 - accuracy50: 0.5707 - val_loss: 12.3529 - val_accuracy10: 0.5895 - val_accuracy20: 0.5611 - val_accuracy30: 0.5336 - val_accuracy50: 0.4870 - 41s/epoch - 29ms/step
Epoch 18/50
1431/1431 - 41s - loss: 10.0496 - accuracy10: 0.6169 - accuracy20: 0.6148 - accuracy30: 0.6010 - accuracy50: 0.5723 - val_loss: 12.2691 - val_accuracy10: 0.5920 - val_accuracy20: 0.5626 - val_accuracy30: 0.5353 - val_accuracy50: 0.4893 - 41s/epoch - 29ms/step
Epoch 19/50
1431/1431 - 42s - loss: 10.0269 - accuracy10: 0.6174 - accuracy20: 0.6149 - accuracy30: 0.6014 - accuracy50: 0.5734 - val_loss: 12.1715 - val_accuracy10: 0.5898 - val_accuracy20: 0.5630 - val_accuracy30: 0.5351 - val_accuracy50: 0.4907 - 42s/epoch - 29ms/step
Epoch 20/50
1431/1431 - 43s - loss: 10.0032 - accuracy10: 0.6175 - accuracy20: 0.6168 - accuracy30: 0.6034 - accuracy50: 0.5753 - val_loss: 12.2706 - val_accuracy10: 0.5958 - val_accuracy20: 0.5663 - val_accuracy30: 0.5377 - val_accuracy50: 0.4901 - 43s/epoch - 30ms/step
Epoch 21/50
1431/1431 - 42s - loss: 9.9776 - accuracy10: 0.6187 - accuracy20: 0.6171 - accuracy30: 0.6037 - accuracy50: 0.5762 - val_loss: 12.3103 - val_accuracy10: 0.5872 - val_accuracy20: 0.5609 - val_accuracy30: 0.5345 - val_accuracy50: 0.4896 - 42s/epoch - 30ms/step
Epoch 22/50
1431/1431 - 41s - loss: 9.9570 - accuracy10: 0.6189 - accuracy20: 0.6179 - accuracy30: 0.6047 - accuracy50: 0.5777 - val_loss: 12.4241 - val_accuracy10: 0.5925 - val_accuracy20: 0.5647 - val_accuracy30: 0.5355 - val_accuracy50: 0.4885 - 41s/epoch - 29ms/step
Epoch 23/50
1431/1431 - 42s - loss: 9.9318 - accuracy10: 0.6193 - accuracy20: 0.6186 - accuracy30: 0.6059 - accuracy50: 0.5795 - val_loss: 12.3084 - val_accuracy10: 0.5893 - val_accuracy20: 0.5624 - val_accuracy30: 0.5339 - val_accuracy50: 0.4901 - 42s/epoch - 30ms/step
Epoch 24/50
1431/1431 - 43s - loss: 9.9057 - accuracy10: 0.6199 - accuracy20: 0.6193 - accuracy30: 0.6071 - accuracy50: 0.5812 - val_loss: 12.3618 - val_accuracy10: 0.5859 - val_accuracy20: 0.5591 - val_accuracy30: 0.5316 - val_accuracy50: 0.4882 - 43s/epoch - 30ms/step
Epoch 25/50
1431/1431 - 42s - loss: 9.8845 - accuracy10: 0.6202 - accuracy20: 0.6209 - accuracy30: 0.6088 - accuracy50: 0.5820 - val_loss: 12.3755 - val_accuracy10: 0.5865 - val_accuracy20: 0.5603 - val_accuracy30: 0.5328 - val_accuracy50: 0.4895 - 42s/epoch - 29ms/step
Epoch 26/50
1431/1431 - 43s - loss: 9.8603 - accuracy10: 0.6202 - accuracy20: 0.6211 - accuracy30: 0.6092 - accuracy50: 0.5836 - val_loss: 12.3061 - val_accuracy10: 0.5714 - val_accuracy20: 0.5493 - val_accuracy30: 0.5252 - val_accuracy50: 0.4890 - 43s/epoch - 30ms/step
Epoch 27/50
1431/1431 - 42s - loss: 9.8283 - accuracy10: 0.6209 - accuracy20: 0.6227 - accuracy30: 0.6115 - accuracy50: 0.5860 - val_loss: 12.5092 - val_accuracy10: 0.5755 - val_accuracy20: 0.5502 - val_accuracy30: 0.5249 - val_accuracy50: 0.4837 - 42s/epoch - 29ms/step
Epoch 28/50
1431/1431 - 42s - loss: 9.8220 - accuracy10: 0.6215 - accuracy20: 0.6229 - accuracy30: 0.6114 - accuracy50: 0.5862 - val_loss: 12.4346 - val_accuracy10: 0.5918 - val_accuracy20: 0.5647 - val_accuracy30: 0.5362 - val_accuracy50: 0.4888 - 42s/epoch - 29ms/step
Epoch 29/50
1431/1431 - 41s - loss: 9.7862 - accuracy10: 0.6227 - accuracy20: 0.6247 - accuracy30: 0.6142 - accuracy50: 0.5889 - val_loss: 12.4899 - val_accuracy10: 0.5859 - val_accuracy20: 0.5587 - val_accuracy30: 0.5323 - val_accuracy50: 0.4879 - 41s/epoch - 29ms/step
testing model: results/ATVI/W9/deepOF_L2/seq2seq
Evaluating performance on  test set...
3337/3337 - 36s - 36s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8203557
{'0': {'precision': 0.40001562819326064, 'recall': 0.4621329963056582, 'f1-score': 0.4288365499242839, 'support': 144004}, '1': {'precision': 0.8072640143418603, 'recall': 0.6592851210000985, 'f1-score': 0.7258088263783952, 'support': 568264}, '2': {'precision': 0.3757509337746863, 'recall': 0.5926038278929657, 'f1-score': 0.45989641504062373, 'support': 141749}, 'accuracy': 0.6149737066123977, 'macro avg': {'precision': 0.5276768587699358, 'recall': 0.5713406483995741, 'f1-score': 0.5381805971144343, 'support': 854017}, 'weighted avg': {'precision': 0.6669717903506994, 'recall': 0.6149737066123977, 'f1-score': 0.6315975705214092, 'support': 854017}}
[[ 66549  49847  27608]
 [ 81670 374648 111946]
 [ 18147  39601  84001]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8660163
{'0': {'precision': 0.46009131695821626, 'recall': 0.4356331025161045, 'f1-score': 0.4475282876955756, 'support': 186439}, '1': {'precision': 0.7199933208173875, 'recall': 0.6601509079511153, 'f1-score': 0.6887747447677248, 'support': 483341}, '2': {'precision': 0.43980266386708833, 'recall': 0.5593610403990512, 'f1-score': 0.49242876733929347, 'support': 184237}, 'accuracy': 0.5893934195689313, 'macro avg': {'precision': 0.5399624338808974, 'recall': 0.5517150169554237, 'f1-score': 0.542910599934198, 'support': 854017}, 'weighted avg': {'precision': 0.6028090542722809, 'recall': 0.5893934195689313, 'f1-score': 0.5937509430710884, 'support': 854017}}
[[ 81219  67837  37383]
 [ 70380 319078  93883]
 [ 24929  56253 103055]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.90554976
{'0': {'precision': 0.4894140790574835, 'recall': 0.4164863115057344, 'f1-score': 0.45001474049238244, 'support': 216240}, '1': {'precision': 0.6493098546877019, 'recall': 0.6505662491496258, 'f1-score': 0.6499374447350103, 'support': 424813}, '2': {'precision': 0.46694684978147355, 'recall': 0.5357947822167127, 'f1-score': 0.49900727705279363, 'support': 212964}, 'accuracy': 0.5626761528166301, 'macro avg': {'precision': 0.5352235945088862, 'recall': 0.5342824476240243, 'f1-score': 0.5329864874267287, 'support': 854017}, 'weighted avg': {'precision': 0.5633483135250219, 'recall': 0.5626761528166301, 'f1-score': 0.5616792744694283, 'support': 854017}}
[[ 90061  80679  45500]
 [ 63685 276369  84759]
 [ 30272  68587 114105]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9739972
{'0': {'precision': 0.5164151663557632, 'recall': 0.37336225023222913, 'f1-score': 0.4333891262468814, 'support': 257289}, '1': {'precision': 0.5341903549030445, 'recall': 0.6453348969793378, 'f1-score': 0.5845261508366375, 'support': 344494}, '2': {'precision': 0.4903148949688282, 'recall': 0.48952956381772483, 'f1-score': 0.4899219146775013, 'support': 252234}, 'accuracy': 0.5173808015531307, 'macro avg': {'precision': 0.5136401387425452, 'recall': 0.502742237009764, 'f1-score': 0.5026123972536735, 'support': 854017}, 'weighted avg': {'precision': 0.5158766172992397, 'recall': 0.5173808015531307, 'f1-score': 0.5110518536937969, 'support': 854017}}
[[ 96062 103336  57891]
 [ 51717 222314  70463]
 [ 38238  90520 123476]]
Evaluating performance on  train set...
1431/1431 - 15s - 15s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8009049
{'0': {'precision': 0.46003107028971685, 'recall': 0.48386079578030045, 'f1-score': 0.4716451274886483, 'support': 69768}, '1': {'precision': 0.7951590510645629, 'recall': 0.6959060956249501, 'f1-score': 0.7422291800673504, 'support': 225506}, '2': {'precision': 0.4316737621374494, 'recall': 0.5811921165574881, 'f1-score': 0.4953970565229425, 'support': 70832}, 'accuracy': 0.6333029231971069, 'macro avg': {'precision': 0.5622879611639097, 'recall': 0.5869863359875795, 'f1-score': 0.569757121359647, 'support': 366106}, 'weighted avg': {'precision': 0.6609695022781874, 'recall': 0.6333029231971069, 'f1-score': 0.6429089800290871, 'support': 366106}}
[[ 33758  20896  15114]
 [ 29490 156931  39085]
 [ 10134  19531  41167]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8423051
{'0': {'precision': 0.5188176551795322, 'recall': 0.4581206707983959, 'f1-score': 0.4865836171899106, 'support': 87776}, '1': {'precision': 0.7078519741018154, 'recall': 0.7086916917341016, 'f1-score': 0.7082715840284541, 'support': 188824}, '2': {'precision': 0.4927926389488805, 'recall': 0.5480973342569213, 'f1-score': 0.5189757586336395, 'support': 89506}, 'accuracy': 0.6093535751940695, 'macro avg': {'precision': 0.5731540894100761, 'recall': 0.5716365655964729, 'f1-score': 0.5712769866173347, 'support': 366106}, 'weighted avg': {'precision': 0.6099519745663778, 'recall': 0.6093535751940695, 'f1-score': 0.6088413776810895, 'support': 366106}}
[[ 40212  28140  19424]
 [ 23937 133818  31069]
 [ 13358  27090  49058]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8834153
{'0': {'precision': 0.5379757828395613, 'recall': 0.43538459993774914, 'f1-score': 0.48127368882525623, 'support': 99597}, '1': {'precision': 0.6394086394086395, 'recall': 0.7062125271080495, 'f1-score': 0.6711523307267988, 'support': 164619}, '2': {'precision': 0.5160198294818873, 'recall': 0.525105505937776, 'f1-score': 0.5205230233395275, 'support': 101890}, 'accuracy': 0.5821319508557631, 'macro avg': {'precision': 0.5644680839100293, 'recall': 0.5555675443278583, 'f1-score': 0.5576496809638608, 'support': 366106}, 'weighted avg': {'precision': 0.5774744070848118, 'recall': 0.5821319508557631, 'f1-score': 0.5775757074888376, 'support': 366106}}
[[ 43363  33181  23053]
 [ 21235 116256  27128]
 [ 16006  32381  53503]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.95505655
{'0': {'precision': 0.5488707117568062, 'recall': 0.3891220994140405, 'f1-score': 0.45539309282997464, 'support': 115537}, '1': {'precision': 0.5264125512488651, 'recall': 0.7103534873102241, 'f1-score': 0.6047044952482137, 'support': 131405}, '2': {'precision': 0.5365052631578947, 'recall': 0.481177201168138, 'f1-score': 0.5073372294161627, 'support': 119164}, 'accuracy': 0.5343834845645796, 'macro avg': {'precision': 0.5372628420545219, 'recall': 0.5268842626308009, 'f1-score': 0.522478272498117, 'support': 366106}, 'weighted avg': {'precision': 0.5367850565138255, 'recall': 0.5343834845645796, 'f1-score': 0.5258921721319396, 'support': 366106}}
[[44958 42275 28304]
 [16829 93344 21232]
 [20123 41702 57339]]
Evaluating performance on  val set...
492/492 - 6s - 6s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.88448113
{'0': {'precision': 0.47699125549004867, 'recall': 0.43818836101922864, 'f1-score': 0.4567672021824795, 'support': 27511}, '1': {'precision': 0.7515253665936289, 'recall': 0.6353920255365235, 'f1-score': 0.6885964912280703, 'support': 70174}, '2': {'precision': 0.4211753278290432, 'recall': 0.6172681329632003, 'f1-score': 0.5007072952452438, 'support': 28098}, 'accuracy': 0.5882114435178045, 'macro avg': {'precision': 0.5498973166375736, 'recall': 0.5636161731729841, 'f1-score': 0.5486903295519312, 'support': 125783}, 'weighted avg': {'precision': 0.617684678108079, 'recall': 0.5882114435178045, 'f1-score': 0.5959196891192106, 'support': 125783}}
[[12055  8013  7443]
 [ 9193 44588 16393]
 [ 4025  6729 17344]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9258375
{'0': {'precision': 0.5255196348409974, 'recall': 0.40768487899095723, 'f1-score': 0.4591628213579433, 'support': 34171}, '1': {'precision': 0.647507341754237, 'recall': 0.6423369193239852, 'f1-score': 0.644911767556186, 'support': 56981}, '2': {'precision': 0.4740338729297277, 'recall': 0.585140481071872, 'f1-score': 0.5237596763979891, 'support': 34631}, 'accuracy': 0.5628423554852404, 'macro avg': {'precision': 0.5490202831749874, 'recall': 0.5450540931289382, 'f1-score': 0.5426114217707062, 'support': 125783}, 'weighted avg': {'precision': 0.5666060941150974, 'recall': 0.5628423554852404, 'f1-score': 0.5610940393302757, 'support': 125783}}
[[13931 10780  9460]
 [ 7356 36601 13024]
 [ 5222  9145 20264]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.95969063
{'0': {'precision': 0.5409233233816355, 'recall': 0.38674996746062734, 'f1-score': 0.4510253335559569, 'support': 38415}, '1': {'precision': 0.5693771015623549, 'recall': 0.6313523534864559, 'f1-score': 0.5987653115048743, 'support': 48545}, '2': {'precision': 0.4926721812623629, 'recall': 0.5645622440306004, 'f1-score': 0.5261730143678506, 'support': 38823}, 'accuracy': 0.5360342812621738, 'macro avg': {'precision': 0.5343242020687844, 'recall': 0.5275548549925612, 'f1-score': 0.5253212198095606, 'support': 125783}, 'weighted avg': {'precision': 0.5370120998560916, 'recall': 0.5360342812621738, 'f1-score': 0.5312388412771144, 'support': 125783}}
[[14857 12347 11211]
 [ 6537 30649 11359]
 [ 6072 10833 21918]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0171677
{'0': {'precision': 0.5425860705814706, 'recall': 0.3441845620754115, 'f1-score': 0.4211906488869051, 'support': 43866}, '1': {'precision': 0.44964285026665896, 'recall': 0.6189113266550061, 'f1-score': 0.5208702731033868, 'support': 37734}, '2': {'precision': 0.5062584206180191, 'recall': 0.5272842495982618, 'f1-score': 0.5165574661034801, 'support': 44183}, 'accuracy': 0.49091689655994847, 'macro avg': {'precision': 0.4994957804887162, 'recall': 0.49679337944289315, 'f1-score': 0.48620612936459073, 'support': 125783}, 'weighted avg': {'precision': 0.5019431853450373, 'recall': 0.49091689655994847, 'f1-score': 0.4845927224999105, 'support': 125783}}
[[15098 15102 13666]
 [ 5325 23354  9055]
 [ 7403 13483 23297]]
training model: results/ATVI/W9/deepVOL_L2/seq2seq
Epoch 1/50
1431/1431 - 49s - loss: 11.7193 - accuracy10: 0.5078 - accuracy20: 0.5165 - accuracy30: 0.5126 - accuracy50: 0.4940 - val_loss: 12.3128 - val_accuracy10: 0.5320 - val_accuracy20: 0.5242 - val_accuracy30: 0.5070 - val_accuracy50: 0.4722 - 49s/epoch - 34ms/step
Epoch 2/50
1431/1431 - 42s - loss: 11.1244 - accuracy10: 0.5615 - accuracy20: 0.5611 - accuracy30: 0.5499 - accuracy50: 0.5225 - val_loss: 12.0923 - val_accuracy10: 0.5485 - val_accuracy20: 0.5398 - val_accuracy30: 0.5205 - val_accuracy50: 0.4833 - 42s/epoch - 29ms/step
Epoch 3/50
1431/1431 - 42s - loss: 10.9044 - accuracy10: 0.5791 - accuracy20: 0.5753 - accuracy30: 0.5613 - accuracy50: 0.5304 - val_loss: 12.0302 - val_accuracy10: 0.5497 - val_accuracy20: 0.5403 - val_accuracy30: 0.5204 - val_accuracy50: 0.4805 - 42s/epoch - 29ms/step
Epoch 4/50
1431/1431 - 41s - loss: 10.7851 - accuracy10: 0.5871 - accuracy20: 0.5828 - accuracy30: 0.5677 - accuracy50: 0.5360 - val_loss: 11.9403 - val_accuracy10: 0.5563 - val_accuracy20: 0.5476 - val_accuracy30: 0.5275 - val_accuracy50: 0.4900 - 41s/epoch - 28ms/step
Epoch 5/50
1431/1431 - 41s - loss: 10.6996 - accuracy10: 0.5921 - accuracy20: 0.5870 - accuracy30: 0.5718 - accuracy50: 0.5393 - val_loss: 11.8487 - val_accuracy10: 0.5631 - val_accuracy20: 0.5521 - val_accuracy30: 0.5325 - val_accuracy50: 0.4941 - 41s/epoch - 29ms/step
Epoch 6/50
1431/1431 - 41s - loss: 10.6374 - accuracy10: 0.5957 - accuracy20: 0.5903 - accuracy30: 0.5751 - accuracy50: 0.5418 - val_loss: 11.8070 - val_accuracy10: 0.5635 - val_accuracy20: 0.5556 - val_accuracy30: 0.5376 - val_accuracy50: 0.4979 - 41s/epoch - 29ms/step
Epoch 7/50
1431/1431 - 42s - loss: 10.5824 - accuracy10: 0.5990 - accuracy20: 0.5944 - accuracy30: 0.5783 - accuracy50: 0.5449 - val_loss: 11.8462 - val_accuracy10: 0.5731 - val_accuracy20: 0.5598 - val_accuracy30: 0.5380 - val_accuracy50: 0.4949 - 42s/epoch - 29ms/step
Epoch 8/50
1431/1431 - 41s - loss: 10.5447 - accuracy10: 0.6015 - accuracy20: 0.5961 - accuracy30: 0.5803 - accuracy50: 0.5467 - val_loss: 11.7638 - val_accuracy10: 0.5707 - val_accuracy20: 0.5618 - val_accuracy30: 0.5415 - val_accuracy50: 0.5000 - 41s/epoch - 29ms/step
Epoch 9/50
1431/1431 - 41s - loss: 10.5003 - accuracy10: 0.6036 - accuracy20: 0.5982 - accuracy30: 0.5830 - accuracy50: 0.5493 - val_loss: 11.7174 - val_accuracy10: 0.5646 - val_accuracy20: 0.5570 - val_accuracy30: 0.5388 - val_accuracy50: 0.5011 - 41s/epoch - 29ms/step
Epoch 10/50
1431/1431 - 42s - loss: 10.4633 - accuracy10: 0.6056 - accuracy20: 0.6003 - accuracy30: 0.5843 - accuracy50: 0.5506 - val_loss: 11.6632 - val_accuracy10: 0.5640 - val_accuracy20: 0.5573 - val_accuracy30: 0.5412 - val_accuracy50: 0.5039 - 42s/epoch - 29ms/step
Epoch 11/50
1431/1431 - 41s - loss: 10.4347 - accuracy10: 0.6073 - accuracy20: 0.6015 - accuracy30: 0.5861 - accuracy50: 0.5523 - val_loss: 11.6855 - val_accuracy10: 0.5747 - val_accuracy20: 0.5637 - val_accuracy30: 0.5435 - val_accuracy50: 0.5041 - 41s/epoch - 29ms/step
Epoch 12/50
1431/1431 - 43s - loss: 10.4115 - accuracy10: 0.6087 - accuracy20: 0.6022 - accuracy30: 0.5863 - accuracy50: 0.5525 - val_loss: 11.6407 - val_accuracy10: 0.5665 - val_accuracy20: 0.5608 - val_accuracy30: 0.5447 - val_accuracy50: 0.5060 - 43s/epoch - 30ms/step
Epoch 13/50
1431/1431 - 42s - loss: 10.3896 - accuracy10: 0.6096 - accuracy20: 0.6035 - accuracy30: 0.5876 - accuracy50: 0.5539 - val_loss: 11.6209 - val_accuracy10: 0.5689 - val_accuracy20: 0.5617 - val_accuracy30: 0.5449 - val_accuracy50: 0.5067 - 42s/epoch - 29ms/step
Epoch 14/50
1431/1431 - 41s - loss: 10.3605 - accuracy10: 0.6110 - accuracy20: 0.6052 - accuracy30: 0.5892 - accuracy50: 0.5553 - val_loss: 11.5722 - val_accuracy10: 0.5696 - val_accuracy20: 0.5647 - val_accuracy30: 0.5481 - val_accuracy50: 0.5085 - 41s/epoch - 29ms/step
Epoch 15/50
1431/1431 - 41s - loss: 10.3459 - accuracy10: 0.6118 - accuracy20: 0.6057 - accuracy30: 0.5897 - accuracy50: 0.5558 - val_loss: 11.5969 - val_accuracy10: 0.5649 - val_accuracy20: 0.5614 - val_accuracy30: 0.5465 - val_accuracy50: 0.5089 - 41s/epoch - 29ms/step
Epoch 16/50
1431/1431 - 42s - loss: 10.3244 - accuracy10: 0.6122 - accuracy20: 0.6055 - accuracy30: 0.5903 - accuracy50: 0.5568 - val_loss: 11.6135 - val_accuracy10: 0.5691 - val_accuracy20: 0.5644 - val_accuracy30: 0.5474 - val_accuracy50: 0.5085 - 42s/epoch - 29ms/step
Epoch 17/50
1431/1431 - 40s - loss: 10.3072 - accuracy10: 0.6136 - accuracy20: 0.6070 - accuracy30: 0.5913 - accuracy50: 0.5574 - val_loss: 11.5924 - val_accuracy10: 0.5655 - val_accuracy20: 0.5634 - val_accuracy30: 0.5482 - val_accuracy50: 0.5106 - 40s/epoch - 28ms/step
Epoch 18/50
1431/1431 - 41s - loss: 10.2846 - accuracy10: 0.6145 - accuracy20: 0.6080 - accuracy30: 0.5921 - accuracy50: 0.5582 - val_loss: 11.5835 - val_accuracy10: 0.5720 - val_accuracy20: 0.5667 - val_accuracy30: 0.5496 - val_accuracy50: 0.5111 - 41s/epoch - 29ms/step
Epoch 19/50
1431/1431 - 42s - loss: 10.2766 - accuracy10: 0.6140 - accuracy20: 0.6081 - accuracy30: 0.5920 - accuracy50: 0.5585 - val_loss: 11.5726 - val_accuracy10: 0.5737 - val_accuracy20: 0.5679 - val_accuracy30: 0.5505 - val_accuracy50: 0.5100 - 42s/epoch - 29ms/step
Epoch 20/50
1431/1431 - 41s - loss: 10.2580 - accuracy10: 0.6151 - accuracy20: 0.6090 - accuracy30: 0.5926 - accuracy50: 0.5595 - val_loss: 11.5949 - val_accuracy10: 0.5705 - val_accuracy20: 0.5654 - val_accuracy30: 0.5491 - val_accuracy50: 0.5090 - 41s/epoch - 29ms/step
Epoch 21/50
1431/1431 - 41s - loss: 10.2440 - accuracy10: 0.6150 - accuracy20: 0.6091 - accuracy30: 0.5934 - accuracy50: 0.5598 - val_loss: 11.5779 - val_accuracy10: 0.5672 - val_accuracy20: 0.5635 - val_accuracy30: 0.5484 - val_accuracy50: 0.5098 - 41s/epoch - 29ms/step
Epoch 22/50
1431/1431 - 42s - loss: 10.2299 - accuracy10: 0.6157 - accuracy20: 0.6101 - accuracy30: 0.5946 - accuracy50: 0.5605 - val_loss: 11.5915 - val_accuracy10: 0.5701 - val_accuracy20: 0.5648 - val_accuracy30: 0.5489 - val_accuracy50: 0.5104 - 42s/epoch - 29ms/step
Epoch 23/50
1431/1431 - 41s - loss: 10.2157 - accuracy10: 0.6158 - accuracy20: 0.6101 - accuracy30: 0.5953 - accuracy50: 0.5616 - val_loss: 11.6174 - val_accuracy10: 0.5660 - val_accuracy20: 0.5633 - val_accuracy30: 0.5477 - val_accuracy50: 0.5098 - 41s/epoch - 29ms/step
Epoch 24/50
1431/1431 - 42s - loss: 10.1949 - accuracy10: 0.6168 - accuracy20: 0.6110 - accuracy30: 0.5961 - accuracy50: 0.5629 - val_loss: 11.5791 - val_accuracy10: 0.5724 - val_accuracy20: 0.5654 - val_accuracy30: 0.5498 - val_accuracy50: 0.5100 - 42s/epoch - 29ms/step
testing model: results/ATVI/W9/deepVOL_L2/seq2seq
Evaluating performance on  test set...
3337/3337 - 32s - 32s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.84359086
{'0': {'precision': 0.40277643638138133, 'recall': 0.5502378389639249, 'f1-score': 0.4650986699224024, 'support': 144005}, '1': {'precision': 0.8487646865579346, 'recall': 0.6183305646671265, 'f1-score': 0.7154506804798787, 'support': 568264}, '2': {'precision': 0.3795528338333813, 'recall': 0.6514828714938766, 'f1-score': 0.4796578213378625, 'support': 141752}, 'accuracy': 0.6123514527160339, 'macro avg': {'precision': 0.5436979855908991, 'recall': 0.606683758374976, 'f1-score': 0.5534023905800479, 'support': 854021}, 'weighted avg': {'precision': 0.6956814994769548, 'recall': 0.6123514527160339, 'f1-score': 0.6340989916461984, 'support': 854021}}
[[ 79237  34960  29808]
 [ 95736 351375 121153]
 [ 21754  27649  92349]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8562502
{'0': {'precision': 0.47304137158022247, 'recall': 0.5047897446899807, 'f1-score': 0.48840015257153097, 'support': 186440}, '1': {'precision': 0.7643561651187697, 'recall': 0.6482338556009112, 'f1-score': 0.701522078875838, 'support': 483341}, '2': {'precision': 0.45534086320194816, 'recall': 0.605894485453756, 'f1-score': 0.5199384252801021, 'support': 184240}, 'accuracy': 0.607784820279595, 'macro avg': {'precision': 0.5642461333003135, 'recall': 0.5863060285815492, 'f1-score': 0.5699535522424903, 'support': 854021}, 'weighted avg': {'precision': 0.6340950716181626, 'recall': 0.607784820279595, 'f1-score': 0.6158222842821999, 'support': 854021}}
[[ 94113  53313  39014]
 [ 75510 313318  94513]
 [ 29330  43280 111630]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.87964624
{'0': {'precision': 0.506565431888955, 'recall': 0.46866907140214575, 'f1-score': 0.486880949692892, 'support': 216240}, '1': {'precision': 0.6893867684107822, 'recall': 0.6686165442206335, 'f1-score': 0.678842819364098, 'support': 424813}, '2': {'precision': 0.49441606322124126, 'recall': 0.5616853236166935, 'f1-score': 0.5259083075407991, 'support': 212968}, 'accuracy': 0.5913238667433236, 'macro avg': {'precision': 0.5634560878403262, 'recall': 0.5663236464131577, 'f1-score': 0.5638773588659297, 'support': 854021}, 'weighted avg': {'precision': 0.5944759793876948, 'recall': 0.5913238667433236, 'f1-score': 0.5921002312875917, 'support': 854021}}
[[101345  70704  44191]
 [ 62644 284037  78132]
 [ 36074  57273 119621]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9334725
{'0': {'precision': 0.532059912069351, 'recall': 0.4162673103008679, 'f1-score': 0.46709436003000543, 'support': 257289}, '1': {'precision': 0.5674590863725455, 'recall': 0.6849408117412785, 'f1-score': 0.6206897458796358, 'support': 344494}, '2': {'precision': 0.524821557462507, 'recall': 0.4929312791887027, 'f1-score': 0.5083767931652727, 'support': 252238}, 'accuracy': 0.5472874788793249, 'macro avg': {'precision': 0.5414468519681345, 'recall': 0.5313798004102831, 'f1-score': 0.5320536330249713, 'support': 854021}, 'weighted avg': {'precision': 0.5442013173311462, 'recall': 0.5472874788793249, 'f1-score': 0.5412443952423199, 'support': 854021}}
[[107101  98705  51483]
 [ 47444 235958  61092]
 [ 46750  81152 124336]]
Evaluating performance on  train set...
1431/1431 - 14s - 14s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8624041
{'0': {'precision': 0.4331433942313341, 'recall': 0.5288700167840594, 'f1-score': 0.47624399317935207, 'support': 69709}, '1': {'precision': 0.8372550103492964, 'recall': 0.6045913389039687, 'f1-score': 0.7021512770390517, 'support': 225468}, '2': {'precision': 0.3964274230398213, 'recall': 0.6605055759985338, 'f1-score': 0.49547610611981574, 'support': 70929}, 'accuracy': 0.6010062659448356, 'macro avg': {'precision': 0.5556086092068172, 'recall': 0.5979889772288539, 'f1-score': 0.5579571254460731, 'support': 366106}, 'weighted avg': {'precision': 0.6749040065737757, 'recall': 0.6010062659448356, 'f1-score': 0.6190960032967303, 'support': 366106}}
[[ 36867  14252  18590]
 [ 36413 136316  52739]
 [ 11835  12245  46849]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.87216765
{'0': {'precision': 0.4955003744886789, 'recall': 0.49068315893971726, 'f1-score': 0.49308000137597324, 'support': 87637}, '1': {'precision': 0.7480276195580372, 'recall': 0.635441536922238, 'f1-score': 0.6871534764700327, 'support': 188897}, '2': {'precision': 0.46394346051911994, 'recall': 0.6156164872951368, 'f1-score': 0.5291253052627538, 'support': 89572}, 'accuracy': 0.5959394273789558, 'macro avg': {'precision': 0.5691571515219453, 'recall': 0.5805803943856974, 'f1-score': 0.5697862610362533, 'support': 366106}, 'weighted avg': {'precision': 0.6180742277273181, 'recall': 0.5959394273789558, 'f1-score': 0.6020335481208757, 'support': 366106}}
[[ 43002  21398  23237]
 [ 28388 120033  40476]
 [ 15395  19035  55142]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.89387476
{'0': {'precision': 0.5225185586317381, 'recall': 0.46466014547278656, 'f1-score': 0.49189381508446045, 'support': 99675}, '1': {'precision': 0.6716831041232871, 'recall': 0.6550780679994164, 'f1-score': 0.663276676167669, 'support': 164472}, '2': {'precision': 0.4969674189745605, 'recall': 0.5705822928824331, 'f1-score': 0.531236730724451, 'support': 101959}, 'accuracy': 0.579703692373247, 'macro avg': {'precision': 0.5637230272431952, 'recall': 0.5634401687848787, 'f1-score': 0.5621357406588602, 'support': 366106}, 'weighted avg': {'precision': 0.5824143879210146, 'recall': 0.579703692373247, 'f1-score': 0.5798438794478287, 'support': 366106}}
[[ 46315  27687  25673]
 [ 23517 107742  33213]
 [ 18806  24977  58176]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.94092065
{'0': {'precision': 0.5367941933559441, 'recall': 0.42030189005665847, 'f1-score': 0.47145865070201143, 'support': 115605}, '1': {'precision': 0.5472367334008336, 'recall': 0.6706097282484585, 'f1-score': 0.6026741278642208, 'support': 131370}, '2': {'precision': 0.5233416519781505, 'recall': 0.5034457865710856, 'f1-score': 0.5132009600698233, 'support': 119131}, 'accuracy': 0.5371750258121964, 'macro avg': {'precision': 0.5357908595783094, 'recall': 0.5314524682920676, 'f1-score': 0.5291112462120185, 'support': 366106}, 'weighted avg': {'precision': 0.5361638343310147, 'recall': 0.5371750258121964, 'f1-score': 0.5321257260629622, 'support': 366106}}
[[48589 37741 29275]
 [17921 88098 25351]
 [24007 35148 59976]]
Evaluating performance on  val set...
492/492 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.92081875
{'0': {'precision': 0.4489769614950862, 'recall': 0.5067461904935083, 'f1-score': 0.4761156290576095, 'support': 27497}, '1': {'precision': 0.7954927269002253, 'recall': 0.5540999514798641, 'f1-score': 0.6532081693078968, 'support': 70074}, '2': {'precision': 0.4121424528712613, 'recall': 0.6710974053594215, 'f1-score': 0.5106675657451113, 'support': 28212}, 'accuracy': 0.5699895852380688, 'macro avg': {'precision': 0.5522040470888575, 'recall': 0.577314515777598, 'f1-score': 0.5466637880368727, 'support': 125783}, 'weighted avg': {'precision': 0.6337600449618852, 'recall': 0.5699895852380688, 'f1-score': 0.5825239823591403, 'support': 125783}}
[[13934  5495  8068]
 [12309 38828 18937]
 [ 4792  4487 18933]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9243968
{'0': {'precision': 0.5061137022563973, 'recall': 0.4696181063220071, 'f1-score': 0.4871833763082057, 'support': 34198}, '1': {'precision': 0.6903184129365675, 'recall': 0.5824527472527472, 'f1-score': 0.6318148441299599, 'support': 56875}, '2': {'precision': 0.4729609447930009, 'recall': 0.627657735522904, 'f1-score': 0.5394376833842992, 'support': 34710}, 'accuracy': 0.564249540875953, 'macro avg': {'precision': 0.5564643533286552, 'recall': 0.5599095296992195, 'f1-score': 0.5528119679408215, 'support': 125783}, 'weighted avg': {'precision': 0.5802565570808186, 'recall': 0.564249540875953, 'f1-score': 0.5670006944749968, 'support': 125783}}
[[16060  8115 10023]
 [ 9494 33127 14254]
 [ 6178  6746 21786]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9391372
{'0': {'precision': 0.5266061794997547, 'recall': 0.44670948282586653, 'f1-score': 0.4833785855971188, 'support': 38459}, '1': {'precision': 0.6045494313210849, 'recall': 0.5986880105619276, 'f1-score': 0.6016044443523144, 'support': 48476}, '2': {'precision': 0.5025579695701282, 'recall': 0.5841227347611203, 'f1-score': 0.5402792823894953, 'support': 38848}, 'accuracy': 0.5477210751850409, 'macro avg': {'precision': 0.544571193463656, 'recall': 0.5431734093829714, 'f1-score': 0.5417541041129762, 'support': 125783}, 'weighted avg': {'precision': 0.5492177582977217, 'recall': 0.5477210751850409, 'f1-score': 0.5465158537335689, 'support': 125783}}
[[17180 10326 10953]
 [ 7946 29022 11508]
 [ 7498  8658 22692]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.97606087
{'0': {'precision': 0.5357078933237873, 'recall': 0.40910333515582287, 'f1-score': 0.46392311865457647, 'support': 43896}, '1': {'precision': 0.47530186608122943, 'recall': 0.6088721445437904, 'f1-score': 0.5338590736734362, 'support': 37691}, '2': {'precision': 0.523284369457456, 'recall': 0.5207032310616345, 'f1-score': 0.5219906094767166, 'support': 44196}, 'accuracy': 0.5081767806460332, 'macro avg': {'precision': 0.5114313762874909, 'recall': 0.5128929035870825, 'f1-score': 0.5065909339349098, 'support': 125783}, 'weighted avg': {'precision': 0.5132419509182505, 'recall': 0.5081767806460332, 'f1-score': 0.5052824987376652, 'support': 125783}}
[[17958 13582 12356]
 [ 6133 22949  8609]
 [ 9431 11752 23013]]
training model: results/ATVI/W9/deepVOL_L3/seq2seq
Epoch 1/50
1431/1431 - 69s - loss: 12.5397 - accuracy10: 0.4598 - accuracy20: 0.4620 - accuracy30: 0.4598 - accuracy50: 0.4498 - val_loss: 12.9435 - val_accuracy10: 0.4222 - val_accuracy20: 0.4413 - val_accuracy30: 0.4473 - val_accuracy50: 0.4452 - 69s/epoch - 48ms/step
Epoch 2/50
1431/1431 - 62s - loss: 11.5671 - accuracy10: 0.5076 - accuracy20: 0.5225 - accuracy30: 0.5217 - accuracy50: 0.5046 - val_loss: 12.2255 - val_accuracy10: 0.5377 - val_accuracy20: 0.5270 - val_accuracy30: 0.5099 - val_accuracy50: 0.4762 - 62s/epoch - 43ms/step
Epoch 3/50
1431/1431 - 63s - loss: 11.1385 - accuracy10: 0.5564 - accuracy20: 0.5592 - accuracy30: 0.5504 - accuracy50: 0.5244 - val_loss: 12.2599 - val_accuracy10: 0.5805 - val_accuracy20: 0.5522 - val_accuracy30: 0.5241 - val_accuracy50: 0.4748 - 63s/epoch - 44ms/step
Epoch 4/50
1431/1431 - 65s - loss: 10.9243 - accuracy10: 0.5765 - accuracy20: 0.5741 - accuracy30: 0.5615 - accuracy50: 0.5312 - val_loss: 11.8686 - val_accuracy10: 0.5421 - val_accuracy20: 0.5376 - val_accuracy30: 0.5222 - val_accuracy50: 0.4901 - 65s/epoch - 46ms/step
Epoch 5/50
1431/1431 - 63s - loss: 10.7849 - accuracy10: 0.5852 - accuracy20: 0.5815 - accuracy30: 0.5678 - accuracy50: 0.5366 - val_loss: 11.7235 - val_accuracy10: 0.5462 - val_accuracy20: 0.5404 - val_accuracy30: 0.5270 - val_accuracy50: 0.4981 - 63s/epoch - 44ms/step
Epoch 6/50
1431/1431 - 63s - loss: 10.6799 - accuracy10: 0.5907 - accuracy20: 0.5863 - accuracy30: 0.5730 - accuracy50: 0.5416 - val_loss: 11.7068 - val_accuracy10: 0.5477 - val_accuracy20: 0.5425 - val_accuracy30: 0.5286 - val_accuracy50: 0.4973 - 63s/epoch - 44ms/step
Epoch 7/50
1431/1431 - 63s - loss: 10.6205 - accuracy10: 0.5925 - accuracy20: 0.5893 - accuracy30: 0.5761 - accuracy50: 0.5439 - val_loss: 11.8378 - val_accuracy10: 0.5375 - val_accuracy20: 0.5335 - val_accuracy30: 0.5223 - val_accuracy50: 0.4937 - 63s/epoch - 44ms/step
Epoch 8/50
1431/1431 - 62s - loss: 10.5660 - accuracy10: 0.5963 - accuracy20: 0.5926 - accuracy30: 0.5787 - accuracy50: 0.5450 - val_loss: 11.7580 - val_accuracy10: 0.5733 - val_accuracy20: 0.5566 - val_accuracy30: 0.5356 - val_accuracy50: 0.4954 - 62s/epoch - 43ms/step
Epoch 9/50
1431/1431 - 58s - loss: 10.5171 - accuracy10: 0.5982 - accuracy20: 0.5947 - accuracy30: 0.5810 - accuracy50: 0.5480 - val_loss: 11.7475 - val_accuracy10: 0.5470 - val_accuracy20: 0.5432 - val_accuracy30: 0.5300 - val_accuracy50: 0.4981 - 58s/epoch - 41ms/step
Epoch 10/50
1431/1431 - 58s - loss: 10.4813 - accuracy10: 0.6000 - accuracy20: 0.5966 - accuracy30: 0.5821 - accuracy50: 0.5490 - val_loss: 11.5454 - val_accuracy10: 0.5568 - val_accuracy20: 0.5508 - val_accuracy30: 0.5362 - val_accuracy50: 0.5041 - 58s/epoch - 40ms/step
Epoch 11/50
1431/1431 - 58s - loss: 10.4439 - accuracy10: 0.6020 - accuracy20: 0.5983 - accuracy30: 0.5837 - accuracy50: 0.5511 - val_loss: 11.5822 - val_accuracy10: 0.5547 - val_accuracy20: 0.5516 - val_accuracy30: 0.5378 - val_accuracy50: 0.5043 - 58s/epoch - 41ms/step
Epoch 12/50
1431/1431 - 59s - loss: 10.4132 - accuracy10: 0.6045 - accuracy20: 0.6000 - accuracy30: 0.5865 - accuracy50: 0.5522 - val_loss: 11.5353 - val_accuracy10: 0.5416 - val_accuracy20: 0.5428 - val_accuracy30: 0.5342 - val_accuracy50: 0.5072 - 59s/epoch - 41ms/step
Epoch 13/50
1431/1431 - 59s - loss: 10.3840 - accuracy10: 0.6050 - accuracy20: 0.6005 - accuracy30: 0.5865 - accuracy50: 0.5539 - val_loss: 11.5283 - val_accuracy10: 0.5554 - val_accuracy20: 0.5526 - val_accuracy30: 0.5393 - val_accuracy50: 0.5059 - 59s/epoch - 41ms/step
Epoch 14/50
1431/1431 - 59s - loss: 10.3553 - accuracy10: 0.6079 - accuracy20: 0.6031 - accuracy30: 0.5883 - accuracy50: 0.5549 - val_loss: 11.4876 - val_accuracy10: 0.5410 - val_accuracy20: 0.5425 - val_accuracy30: 0.5335 - val_accuracy50: 0.5082 - 59s/epoch - 41ms/step
Epoch 15/50
1431/1431 - 58s - loss: 10.3331 - accuracy10: 0.6086 - accuracy20: 0.6047 - accuracy30: 0.5898 - accuracy50: 0.5558 - val_loss: 11.4908 - val_accuracy10: 0.5398 - val_accuracy20: 0.5443 - val_accuracy30: 0.5356 - val_accuracy50: 0.5095 - 58s/epoch - 41ms/step
Epoch 16/50
1431/1431 - 59s - loss: 10.3000 - accuracy10: 0.6100 - accuracy20: 0.6061 - accuracy30: 0.5908 - accuracy50: 0.5575 - val_loss: 11.4317 - val_accuracy10: 0.5351 - val_accuracy20: 0.5425 - val_accuracy30: 0.5360 - val_accuracy50: 0.5100 - 59s/epoch - 41ms/step
Epoch 17/50
1431/1431 - 59s - loss: 10.2738 - accuracy10: 0.6113 - accuracy20: 0.6075 - accuracy30: 0.5922 - accuracy50: 0.5590 - val_loss: 11.4333 - val_accuracy10: 0.5328 - val_accuracy20: 0.5397 - val_accuracy30: 0.5338 - val_accuracy50: 0.5110 - 59s/epoch - 41ms/step
Epoch 18/50
1431/1431 - 60s - loss: 10.2543 - accuracy10: 0.6121 - accuracy20: 0.6079 - accuracy30: 0.5933 - accuracy50: 0.5599 - val_loss: 11.4355 - val_accuracy10: 0.5320 - val_accuracy20: 0.5408 - val_accuracy30: 0.5348 - val_accuracy50: 0.5109 - 60s/epoch - 42ms/step
Epoch 19/50
1431/1431 - 59s - loss: 10.2380 - accuracy10: 0.6130 - accuracy20: 0.6088 - accuracy30: 0.5939 - accuracy50: 0.5599 - val_loss: 11.5194 - val_accuracy10: 0.5277 - val_accuracy20: 0.5377 - val_accuracy30: 0.5320 - val_accuracy50: 0.5080 - 59s/epoch - 41ms/step
Epoch 20/50
1431/1431 - 59s - loss: 10.2233 - accuracy10: 0.6134 - accuracy20: 0.6094 - accuracy30: 0.5943 - accuracy50: 0.5612 - val_loss: 11.4217 - val_accuracy10: 0.5410 - val_accuracy20: 0.5461 - val_accuracy30: 0.5376 - val_accuracy50: 0.5104 - 59s/epoch - 41ms/step
Epoch 21/50
1431/1431 - 58s - loss: 10.1937 - accuracy10: 0.6164 - accuracy20: 0.6112 - accuracy30: 0.5957 - accuracy50: 0.5622 - val_loss: 11.4550 - val_accuracy10: 0.5307 - val_accuracy20: 0.5400 - val_accuracy30: 0.5336 - val_accuracy50: 0.5084 - 58s/epoch - 41ms/step
Epoch 22/50
1431/1431 - 59s - loss: 10.1795 - accuracy10: 0.6157 - accuracy20: 0.6118 - accuracy30: 0.5968 - accuracy50: 0.5633 - val_loss: 11.4337 - val_accuracy10: 0.5355 - val_accuracy20: 0.5439 - val_accuracy30: 0.5360 - val_accuracy50: 0.5099 - 59s/epoch - 41ms/step
Epoch 23/50
1431/1431 - 58s - loss: 10.1635 - accuracy10: 0.6164 - accuracy20: 0.6121 - accuracy30: 0.5969 - accuracy50: 0.5636 - val_loss: 11.4096 - val_accuracy10: 0.5420 - val_accuracy20: 0.5486 - val_accuracy30: 0.5399 - val_accuracy50: 0.5118 - 58s/epoch - 41ms/step
Epoch 24/50
1431/1431 - 59s - loss: 10.1436 - accuracy10: 0.6167 - accuracy20: 0.6135 - accuracy30: 0.5982 - accuracy50: 0.5647 - val_loss: 11.4633 - val_accuracy10: 0.5322 - val_accuracy20: 0.5413 - val_accuracy30: 0.5335 - val_accuracy50: 0.5086 - 59s/epoch - 41ms/step
Epoch 25/50
1431/1431 - 58s - loss: 10.1315 - accuracy10: 0.6175 - accuracy20: 0.6141 - accuracy30: 0.5988 - accuracy50: 0.5660 - val_loss: 11.4344 - val_accuracy10: 0.5293 - val_accuracy20: 0.5397 - val_accuracy30: 0.5329 - val_accuracy50: 0.5083 - 58s/epoch - 41ms/step
Epoch 26/50
1431/1431 - 59s - loss: 10.1134 - accuracy10: 0.6177 - accuracy20: 0.6144 - accuracy30: 0.5997 - accuracy50: 0.5668 - val_loss: 11.4245 - val_accuracy10: 0.5459 - val_accuracy20: 0.5511 - val_accuracy30: 0.5400 - val_accuracy50: 0.5115 - 59s/epoch - 41ms/step
Epoch 27/50
1431/1431 - 60s - loss: 10.1004 - accuracy10: 0.6182 - accuracy20: 0.6145 - accuracy30: 0.5995 - accuracy50: 0.5669 - val_loss: 11.4185 - val_accuracy10: 0.5366 - val_accuracy20: 0.5436 - val_accuracy30: 0.5363 - val_accuracy50: 0.5105 - 60s/epoch - 42ms/step
Epoch 28/50
1431/1431 - 58s - loss: 10.0843 - accuracy10: 0.6196 - accuracy20: 0.6160 - accuracy30: 0.6006 - accuracy50: 0.5684 - val_loss: 11.3879 - val_accuracy10: 0.5369 - val_accuracy20: 0.5457 - val_accuracy30: 0.5398 - val_accuracy50: 0.5136 - 58s/epoch - 41ms/step
Epoch 29/50
1431/1431 - 58s - loss: 10.0653 - accuracy10: 0.6207 - accuracy20: 0.6165 - accuracy30: 0.6017 - accuracy50: 0.5694 - val_loss: 11.4539 - val_accuracy10: 0.5288 - val_accuracy20: 0.5396 - val_accuracy30: 0.5338 - val_accuracy50: 0.5107 - 58s/epoch - 41ms/step
Epoch 30/50
1431/1431 - 59s - loss: 10.0624 - accuracy10: 0.6204 - accuracy20: 0.6169 - accuracy30: 0.6014 - accuracy50: 0.5688 - val_loss: 11.5466 - val_accuracy10: 0.5133 - val_accuracy20: 0.5284 - val_accuracy30: 0.5254 - val_accuracy50: 0.5055 - 59s/epoch - 41ms/step
Epoch 31/50
1431/1431 - 60s - loss: 10.0411 - accuracy10: 0.6207 - accuracy20: 0.6178 - accuracy30: 0.6025 - accuracy50: 0.5708 - val_loss: 11.4656 - val_accuracy10: 0.5272 - val_accuracy20: 0.5380 - val_accuracy30: 0.5329 - val_accuracy50: 0.5089 - 60s/epoch - 42ms/step
Epoch 32/50
1431/1431 - 59s - loss: 10.0280 - accuracy10: 0.6212 - accuracy20: 0.6177 - accuracy30: 0.6031 - accuracy50: 0.5711 - val_loss: 11.4635 - val_accuracy10: 0.5171 - val_accuracy20: 0.5316 - val_accuracy30: 0.5281 - val_accuracy50: 0.5086 - 59s/epoch - 41ms/step
Epoch 33/50
1431/1431 - 59s - loss: 10.0138 - accuracy10: 0.6222 - accuracy20: 0.6182 - accuracy30: 0.6038 - accuracy50: 0.5717 - val_loss: 11.4495 - val_accuracy10: 0.5301 - val_accuracy20: 0.5398 - val_accuracy30: 0.5335 - val_accuracy50: 0.5091 - 59s/epoch - 41ms/step
Epoch 34/50
1431/1431 - 59s - loss: 10.0049 - accuracy10: 0.6212 - accuracy20: 0.6195 - accuracy30: 0.6046 - accuracy50: 0.5729 - val_loss: 11.4985 - val_accuracy10: 0.5308 - val_accuracy20: 0.5397 - val_accuracy30: 0.5317 - val_accuracy50: 0.5066 - 59s/epoch - 41ms/step
Epoch 35/50
1431/1431 - 59s - loss: 9.9886 - accuracy10: 0.6230 - accuracy20: 0.6196 - accuracy30: 0.6053 - accuracy50: 0.5731 - val_loss: 11.4881 - val_accuracy10: 0.5484 - val_accuracy20: 0.5498 - val_accuracy30: 0.5373 - val_accuracy50: 0.5084 - 59s/epoch - 41ms/step
Epoch 36/50
1431/1431 - 58s - loss: 9.9804 - accuracy10: 0.6230 - accuracy20: 0.6205 - accuracy30: 0.6061 - accuracy50: 0.5734 - val_loss: 11.5196 - val_accuracy10: 0.5469 - val_accuracy20: 0.5490 - val_accuracy30: 0.5377 - val_accuracy50: 0.5091 - 58s/epoch - 41ms/step
Epoch 37/50
1431/1431 - 59s - loss: 9.9621 - accuracy10: 0.6232 - accuracy20: 0.6206 - accuracy30: 0.6066 - accuracy50: 0.5747 - val_loss: 11.5865 - val_accuracy10: 0.5303 - val_accuracy20: 0.5366 - val_accuracy30: 0.5288 - val_accuracy50: 0.5038 - 59s/epoch - 41ms/step
Epoch 38/50
1431/1431 - 60s - loss: 9.9449 - accuracy10: 0.6242 - accuracy20: 0.6220 - accuracy30: 0.6075 - accuracy50: 0.5759 - val_loss: 11.5142 - val_accuracy10: 0.5382 - val_accuracy20: 0.5420 - val_accuracy30: 0.5321 - val_accuracy50: 0.5064 - 60s/epoch - 42ms/step
testing model: results/ATVI/W9/deepVOL_L3/seq2seq
Evaluating performance on  test set...
3337/3337 - 58s - 58s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8745248
{'0': {'precision': 0.37552378909858786, 'recall': 0.6322766570605187, 'f1-score': 0.4711943260649626, 'support': 144005}, '1': {'precision': 0.8703560307302585, 'recall': 0.5538253347035885, 'f1-score': 0.6769154992891417, 'support': 568264}, '2': {'precision': 0.37551758488392095, 'recall': 0.6621705513855184, 'f1-score': 0.4792512847481944, 'support': 141752}, 'accuracy': 0.5850371360891594, 'macro avg': {'precision': 0.5404658015709224, 'recall': 0.6160908477165418, 'f1-score': 0.5424537033674329, 'support': 854021}, 'weighted avg': {'precision': 0.7047832212422263, 'recall': 0.5850371360891594, 'f1-score': 0.609418124763508, 'support': 854021}}
[[ 91051  26236  26718]
 [124168 314719 129377]
 [ 27245  20643  93864]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.874676
{'0': {'precision': 0.4465151213358563, 'recall': 0.5771454623471358, 'f1-score': 0.5034953582391255, 'support': 186440}, '1': {'precision': 0.7886167719270767, 'recall': 0.583337643609791, 'f1-score': 0.6706197293983472, 'support': 483341}, '2': {'precision': 0.445601167855787, 'recall': 0.6179765523230569, 'f1-score': 0.5178203119492623, 'support': 184240}, 'accuracy': 0.5894585730327474, 'macro avg': {'precision': 0.5602443537062399, 'recall': 0.5928198860933279, 'f1-score': 0.5639784665289117, 'support': 854021}, 'weighted avg': {'precision': 0.6399335116438735, 'recall': 0.5894585730327474, 'f1-score': 0.6011712820770932, 'support': 854021}}
[[107603  42362  36475]
 [ 96210 281951 105180]
 [ 37171  33213 113856]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.88935494
{'0': {'precision': 0.4813613321275378, 'recall': 0.5366074731779504, 'f1-score': 0.5074852721857519, 'support': 216240}, '1': {'precision': 0.7147103479843256, 'recall': 0.602794641406925, 'f1-score': 0.6539991444314619, 'support': 424813}, '2': {'precision': 0.4821082887333069, 'recall': 0.5765138424552045, 'f1-score': 0.5251016275374809, 'support': 212968}, 'accuracy': 0.5794822375562193, 'macro avg': {'precision': 0.5593933229483902, 'recall': 0.5719719856800266, 'f1-score': 0.5621953480515649, 'support': 854021}, 'weighted avg': {'precision': 0.5976216738844583, 'recall': 0.5794822375562193, 'f1-score': 0.5847582169691516, 'support': 854021}}
[[116036  57166  43038]
 [ 79884 256075  88854]
 [ 45138  45051 122779]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.933831
{'0': {'precision': 0.5118167361934207, 'recall': 0.47161363291862457, 'f1-score': 0.4908934235225581, 'support': 257289}, '1': {'precision': 0.5900674142451147, 'recall': 0.6219847080065255, 'f1-score': 0.6056058177953766, 'support': 344494}, '2': {'precision': 0.5109056238032575, 'recall': 0.5140977965255037, 'f1-score': 0.5124967394655094, 'support': 252238}, 'accuracy': 0.5448179845694661, 'macro avg': {'precision': 0.537596591413931, 'recall': 0.5358987124835513, 'f1-score': 0.5363319935944814, 'support': 854021}, 'weighted avg': {'precision': 0.5431123037704128, 'recall': 0.5448179845694661, 'f1-score': 0.5435465886782609, 'support': 854021}}
[[121341  83082  52866]
 [ 58951 214270  71273]
 [ 56787  65776 129675]]
Evaluating performance on  train set...
1431/1431 - 25s - 25s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.88462305
{'0': {'precision': 0.4076490315014019, 'recall': 0.6382246194895924, 'f1-score': 0.4975202267860238, 'support': 69709}, '1': {'precision': 0.8683561613942696, 'recall': 0.5294720315077971, 'f1-score': 0.6578352091914752, 'support': 225468}, '2': {'precision': 0.3942891096400566, 'recall': 0.6642417064952276, 'f1-score': 0.49484297867871024, 'support': 70929}, 'accuracy': 0.5762893806711717, 'macro avg': {'precision': 0.5567647675119094, 'recall': 0.6106461191642057, 'f1-score': 0.5500661382187365, 'support': 366106}, 'weighted avg': {'precision': 0.6887892184007746, 'recall': 0.5762893806711717, 'f1-score': 0.5957322307465945, 'support': 366106}}
[[ 44490   9789  15430]
 [ 49142 119379  56947]
 [ 15506   8309  47114]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.87638867
{'0': {'precision': 0.47406936048361437, 'recall': 0.5950682930725607, 'f1-score': 0.527721840499489, 'support': 87637}, '1': {'precision': 0.7862002519825094, 'recall': 0.5615864730514514, 'f1-score': 0.6551769926534847, 'support': 188897}, '2': {'precision': 0.46036592914146124, 'recall': 0.622772741481713, 'f1-score': 0.5293936216149528, 'support': 89572}, 'accuracy': 0.5845711351357257, 'macro avg': {'precision': 0.5735451805358617, 'recall': 0.5931425025352417, 'f1-score': 0.5707641515893088, 'support': 366106}, 'weighted avg': {'precision': 0.6317645232487356, 'recall': 0.5845711351357257, 'f1-score': 0.5938929512010555, 'support': 366106}}
[[ 52150  15493  19994]
 [ 37421 106082  45394]
 [ 20434  13355  55783]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.88823736
{'0': {'precision': 0.5036734327285791, 'recall': 0.5626185101580136, 'f1-score': 0.531516716821079, 'support': 99675}, '1': {'precision': 0.7121034952743415, 'recall': 0.581326912787587, 'f1-score': 0.6401039034073222, 'support': 164472}, '2': {'precision': 0.4942032713964431, 'recall': 0.5840681058072362, 'f1-score': 0.5353909502018358, 'support': 101959}, 'accuracy': 0.5769968260558418, 'macro avg': {'precision': 0.5699933997997879, 'recall': 0.576004509584279, 'f1-score': 0.5690038568100789, 'support': 366106}, 'weighted avg': {'precision': 0.594672599821616, 'recall': 0.5769968260558418, 'f1-score': 0.5813781359551036, 'support': 366106}}
[[56079 20598 22998]
 [30910 95612 37950]
 [24351 18057 59551]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9251734
{'0': {'precision': 0.5250981239422419, 'recall': 0.5045629514294364, 'f1-score': 0.5146257648143492, 'support': 115605}, '1': {'precision': 0.585472742885908, 'recall': 0.6020248154068661, 'f1-score': 0.593633422654567, 'support': 131370}, '2': {'precision': 0.522311527622605, 'recall': 0.5258496948737105, 'f1-score': 0.5240746395392126, 'support': 119131}, 'accuracy': 0.5464619536418415, 'macro avg': {'precision': 0.5442941314835849, 'recall': 0.5441458205700044, 'f1-score': 0.5441112756693763, 'support': 366106}, 'weighted avg': {'precision': 0.5458556195431736, 'recall': 0.5464619536418415, 'f1-score': 0.5460507890021995, 'support': 366106}}
[[58330 29631 27644]
 [22633 79088 29649]
 [30121 26365 62645]]
Evaluating performance on  val set...
492/492 - 8s - 8s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.95563316
{'0': {'precision': 0.41834192545817817, 'recall': 0.6167945594064808, 'f1-score': 0.49854493077397927, 'support': 27497}, '1': {'precision': 0.8352488387524883, 'recall': 0.44906812797899365, 'f1-score': 0.5840982282898217, 'support': 70074}, '2': {'precision': 0.40109739945760714, 'recall': 0.6762725081525592, 'f1-score': 0.5035431979836101, 'support': 28212}, 'accuracy': 0.5366941478578187, 'macro avg': {'precision': 0.551562721222758, 'recall': 0.5807117318460112, 'f1-score': 0.5287287856824704, 'support': 125783}, 'weighted avg': {'precision': 0.646733937690812, 'recall': 0.5366941478578187, 'f1-score': 0.5473279370995022, 'support': 125783}}
[[16960  3445  7092]
 [17210 31468 21396]
 [ 6371  2762 19079]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9407528
{'0': {'precision': 0.476113418993334, 'recall': 0.5764372185507924, 'f1-score': 0.521494140366657, 'support': 34198}, '1': {'precision': 0.7365779135748581, 'recall': 0.4747252747252747, 'f1-score': 0.5773486865317381, 'support': 56875}, '2': {'precision': 0.45982021247616456, 'recall': 0.6322097378277154, 'f1-score': 0.5324081375177416, 'support': 34710}, 'accuracy': 0.5458368777974766, 'macro avg': {'precision': 0.5575038483481188, 'recall': 0.5611240770345942, 'f1-score': 0.5437503214720455, 'support': 125783}, 'weighted avg': {'precision': 0.5893908963242391, 'recall': 0.5458368777974766, 'f1-score': 0.5497614909168358, 'support': 125783}}
[[19713  5385  9100]
 [13196 27000 16679]
 [ 8495  4271 21944]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.94487876
{'0': {'precision': 0.4976040412624224, 'recall': 0.5481161756675941, 'f1-score': 0.5216401474845959, 'support': 38459}, '1': {'precision': 0.6528852775099848, 'recall': 0.48896361085898177, 'f1-score': 0.5591583019780375, 'support': 48476}, '2': {'precision': 0.48772153242067284, 'recall': 0.5915105024711697, 'f1-score': 0.5346253620743808, 'support': 38848}, 'accuracy': 0.5387214488444384, 'macro avg': {'precision': 0.5460702837310266, 'recall': 0.542863429665915, 'f1-score': 0.5384746038456715, 'support': 125783}, 'weighted avg': {'precision': 0.5543962747506724, 'recall': 0.5387214488444384, 'f1-score': 0.5401098904038142, 'support': 125783}}
[[21080  6991 10388]
 [11025 23703 13748]
 [10258  5611 22979]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9692654
{'0': {'precision': 0.5122139187295657, 'recall': 0.4996582832148715, 'f1-score': 0.5058582037916879, 'support': 43896}, '1': {'precision': 0.5154342159418301, 'recall': 0.49839484227003794, 'f1-score': 0.5067713391604618, 'support': 37691}, '2': {'precision': 0.5090287630594609, 'recall': 0.5357724680966603, 'f1-score': 0.5220583371916132, 'support': 44196}, 'accuracy': 0.5119690260210045, 'macro avg': {'precision': 0.5122256325769522, 'recall': 0.5112751978605233, 'f1-score': 0.5115626267145876, 'support': 125783}, 'weighted avg': {'precision': 0.5120597252553403, 'recall': 0.5119690260210045, 'f1-score': 0.5118240185753038, 'support': 125783}}
[[21933  9733 12230]
 [ 8297 18785 10609]
 [12590  7927 23679]]
training model: results/ATVI/W10/deepLOB_L1/seq2seq
Epoch 1/50
1586/1586 - 46s - loss: 12.2081 - accuracy10: 0.4451 - accuracy20: 0.4642 - accuracy30: 0.4694 - accuracy50: 0.4643 - val_loss: 13.3296 - val_accuracy10: 0.6176 - val_accuracy20: 0.5246 - val_accuracy30: 0.4624 - val_accuracy50: 0.3785 - 46s/epoch - 29ms/step
Epoch 2/50
1586/1586 - 38s - loss: 12.1483 - accuracy10: 0.4240 - accuracy20: 0.4514 - accuracy30: 0.4618 - accuracy50: 0.4603 - val_loss: 12.6227 - val_accuracy10: 0.6171 - val_accuracy20: 0.5402 - val_accuracy30: 0.4825 - val_accuracy50: 0.3977 - 38s/epoch - 24ms/step
Epoch 3/50
1586/1586 - 38s - loss: 11.8662 - accuracy10: 0.4572 - accuracy20: 0.4780 - accuracy30: 0.4838 - accuracy50: 0.4763 - val_loss: 12.7033 - val_accuracy10: 0.6124 - val_accuracy20: 0.5460 - val_accuracy30: 0.4985 - val_accuracy50: 0.4256 - 38s/epoch - 24ms/step
Epoch 4/50
1586/1586 - 39s - loss: 11.6575 - accuracy10: 0.4882 - accuracy20: 0.5002 - accuracy30: 0.5013 - accuracy50: 0.4907 - val_loss: 12.3532 - val_accuracy10: 0.5972 - val_accuracy20: 0.5449 - val_accuracy30: 0.5074 - val_accuracy50: 0.4476 - 39s/epoch - 24ms/step
Epoch 5/50
1586/1586 - 38s - loss: 11.5260 - accuracy10: 0.5082 - accuracy20: 0.5159 - accuracy30: 0.5141 - accuracy50: 0.4995 - val_loss: 12.6793 - val_accuracy10: 0.6152 - val_accuracy20: 0.5521 - val_accuracy30: 0.5075 - val_accuracy50: 0.4402 - 38s/epoch - 24ms/step
Epoch 6/50
1586/1586 - 37s - loss: 11.4287 - accuracy10: 0.5184 - accuracy20: 0.5245 - accuracy30: 0.5210 - accuracy50: 0.5047 - val_loss: 12.8819 - val_accuracy10: 0.6211 - val_accuracy20: 0.5524 - val_accuracy30: 0.5033 - val_accuracy50: 0.4319 - 37s/epoch - 24ms/step
Epoch 7/50
1586/1586 - 39s - loss: 11.3567 - accuracy10: 0.5260 - accuracy20: 0.5313 - accuracy30: 0.5264 - accuracy50: 0.5089 - val_loss: 12.9167 - val_accuracy10: 0.6229 - val_accuracy20: 0.5554 - val_accuracy30: 0.5065 - val_accuracy50: 0.4345 - 39s/epoch - 24ms/step
Epoch 8/50
1586/1586 - 41s - loss: 11.2878 - accuracy10: 0.5321 - accuracy20: 0.5368 - accuracy30: 0.5312 - accuracy50: 0.5117 - val_loss: 12.9047 - val_accuracy10: 0.6266 - val_accuracy20: 0.5572 - val_accuracy30: 0.5062 - val_accuracy50: 0.4326 - 41s/epoch - 26ms/step
Epoch 9/50
1586/1586 - 41s - loss: 11.2239 - accuracy10: 0.5377 - accuracy20: 0.5410 - accuracy30: 0.5349 - accuracy50: 0.5149 - val_loss: 13.0915 - val_accuracy10: 0.6278 - val_accuracy20: 0.5565 - val_accuracy30: 0.5052 - val_accuracy50: 0.4306 - 41s/epoch - 26ms/step
Epoch 10/50
1586/1586 - 37s - loss: 11.1753 - accuracy10: 0.5408 - accuracy20: 0.5441 - accuracy30: 0.5374 - accuracy50: 0.5165 - val_loss: 13.0162 - val_accuracy10: 0.6263 - val_accuracy20: 0.5577 - val_accuracy30: 0.5073 - val_accuracy50: 0.4342 - 37s/epoch - 23ms/step
Epoch 11/50
1586/1586 - 40s - loss: 11.1431 - accuracy10: 0.5442 - accuracy20: 0.5475 - accuracy30: 0.5401 - accuracy50: 0.5187 - val_loss: 13.0663 - val_accuracy10: 0.6261 - val_accuracy20: 0.5581 - val_accuracy30: 0.5082 - val_accuracy50: 0.4363 - 40s/epoch - 25ms/step
Epoch 12/50
1586/1586 - 39s - loss: 11.1107 - accuracy10: 0.5472 - accuracy20: 0.5494 - accuracy30: 0.5421 - accuracy50: 0.5198 - val_loss: 12.8841 - val_accuracy10: 0.6278 - val_accuracy20: 0.5616 - val_accuracy30: 0.5128 - val_accuracy50: 0.4415 - 39s/epoch - 25ms/step
Epoch 13/50
1586/1586 - 41s - loss: 11.0760 - accuracy10: 0.5493 - accuracy20: 0.5528 - accuracy30: 0.5442 - accuracy50: 0.5211 - val_loss: 12.9528 - val_accuracy10: 0.6286 - val_accuracy20: 0.5605 - val_accuracy30: 0.5115 - val_accuracy50: 0.4401 - 41s/epoch - 26ms/step
Epoch 14/50
1586/1586 - 40s - loss: 11.0538 - accuracy10: 0.5510 - accuracy20: 0.5537 - accuracy30: 0.5452 - accuracy50: 0.5220 - val_loss: 12.5271 - val_accuracy10: 0.6280 - val_accuracy20: 0.5661 - val_accuracy30: 0.5189 - val_accuracy50: 0.4494 - 40s/epoch - 25ms/step
testing model: results/ATVI/W10/deepLOB_L1/seq2seq
Evaluating performance on  test set...
7633/7633 - 77s - 77s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.91794646
{'0': {'precision': 0.400283185840708, 'recall': 0.438484099305314, 'f1-score': 0.4185137291802419, 'support': 425516}, '1': {'precision': 0.654228955187035, 'recall': 0.6819985447401782, 'f1-score': 0.6678251950191859, 'support': 1103583}, '2': {'precision': 0.39810986939784315, 'recall': 0.3161696348928779, 'f1-score': 0.3524397698622374, 'support': 424889}, 'accuracy': 0.5494204672700139, 'macro avg': {'precision': 0.48420733680852873, 'recall': 0.4788840929794567, 'f1-score': 0.47959289802055505, 'support': 1953988}, 'weighted avg': {'precision': 0.5432353512186097, 'recall': 0.5494204672700139, 'f1-score': 0.5449535010234016, 'support': 1953988}}
[[186582 176189  62745]
 [210586 752642 140355]
 [ 68957 221595 134337]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9836009
{'0': {'precision': 0.442926378756683, 'recall': 0.4022902041059758, 'f1-score': 0.4216314419919526, 'support': 519779}, '1': {'precision': 0.5514784298128601, 'recall': 0.687234436833385, 'f1-score': 0.611917383508433, 'support': 911977}, '2': {'precision': 0.4378061490359562, 'recall': 0.2895781951316656, 'f1-score': 0.34858906566227016, 'support': 522232}, 'accuracy': 0.5051571452844132, 'macro avg': {'precision': 0.4774036525351664, 'recall': 0.45970094535700884, 'f1-score': 0.46071263038755195, 'support': 1953988}, 'weighted avg': {'precision': 0.4922219865385858, 'recall': 0.5051571452844132, 'f1-score': 0.490921189836347, 'support': 1953988}}
[[209102 229266  81411]
 [172453 626742 112782]
 [ 90537 280468 151227]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0275328
{'0': {'precision': 0.46797897483153056, 'recall': 0.3567616773872195, 'f1-score': 0.4048714310218466, 'support': 582215}, '1': {'precision': 0.4791399026288474, 'recall': 0.7004615843708929, 'f1-score': 0.5690381014767094, 'support': 787505}, '2': {'precision': 0.4527104220422767, 'recall': 0.2780675991154744, 'f1-score': 0.3445207614547969, 'support': 584268}, 'accuracy': 0.47175059416946263, 'macro avg': {'precision': 0.46660976650088487, 'recall': 0.4450969536245289, 'f1-score': 0.4394767646511177, 'support': 1953988}, 'weighted avg': {'precision': 0.4679116047371155, 'recall': 0.47175059416946263, 'f1-score': 0.4529889777058363, 'support': 1953988}}
[[207712 275345  99158]
 [138638 551617  97250]
 [ 97499 324303 162466]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0851917
{'0': {'precision': 0.49677808073690555, 'recall': 0.2939104481218998, 'f1-score': 0.3693193033602089, 'support': 662052}, '1': {'precision': 0.37742703079597234, 'recall': 0.7318829372513692, 'f1-score': 0.4980256409004531, 'support': 627185}, '2': {'precision': 0.4688296378482395, 'recall': 0.24409290095088235, 'f1-score': 0.3210390473750283, 'support': 664751}, 'accuracy': 0.41754145880117993, 'macro avg': {'precision': 0.4476782497937058, 'recall': 0.4232954287747171, 'f1-score': 0.3961279972118968, 'support': 1953988}, 'weighted avg': {'precision': 0.44896102985640474, 'recall': 0.41754145880117993, 'f1-score': 0.3942060149796115, 'support': 1953988}}
[[194584 354818 112650]
 [ 96972 459026  71187]
 [100136 402354 162261]]
Evaluating performance on  train set...
1586/1586 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8900178
{'0': {'precision': 0.4059698380707485, 'recall': 0.4208624022862907, 'f1-score': 0.4132820007900338, 'support': 83279}, '1': {'precision': 0.669107055229291, 'recall': 0.7084916926815982, 'f1-score': 0.6882363835819407, 'support': 238645}, '2': {'precision': 0.38897371414885334, 'recall': 0.3096917979643887, 'f1-score': 0.344834450268728, 'support': 83906}, 'accuracy': 0.5670157455092033, 'macro avg': {'precision': 0.48801686914963094, 'recall': 0.4796819643107592, 'f1-score': 0.4821176115469008, 'support': 405830}, 'weighted avg': {'precision': 0.5571915427623925, 'recall': 0.5670157455092033, 'f1-score': 0.5608150281841001, 'support': 405830}}
[[ 35049  37007  11223]
 [ 39971 169078  29596]
 [ 11314  46607  25985]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9601716
{'0': {'precision': 0.45700892352874734, 'recall': 0.39073832633154665, 'f1-score': 0.42128335285695684, 'support': 103545}, '1': {'precision': 0.5653990487848929, 'recall': 0.7152678344757553, 'f1-score': 0.6315643178175541, 'support': 196950}, '2': {'precision': 0.44182258419546555, 'recall': 0.28583092039682917, 'f1-score': 0.3471062946737376, 'support': 105335}, 'accuracy': 0.5210038686149373, 'macro avg': {'precision': 0.48807685216970187, 'recall': 0.4639456937347104, 'f1-score': 0.4666513217827495, 'support': 405830}, 'weighted avg': {'precision': 0.5056691559303111, 'recall': 0.5210038686149373, 'f1-score': 0.5040800796274277, 'support': 405830}}
[[ 40459  48503  14583]
 [ 32624 140872  23454]
 [ 15447  59780  30108]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0078497
{'0': {'precision': 0.48688938063625764, 'recall': 0.35116698129397633, 'f1-score': 0.40803812676351237, 'support': 116540}, '1': {'precision': 0.49235144808081127, 'recall': 0.7290930160056, 'f1-score': 0.5877794902193243, 'support': 170003}, '2': {'precision': 0.4614374045038484, 'recall': 0.27089288857964405, 'f1-score': 0.3413763231845169, 'support': 119287}, 'accuracy': 0.4858857156937634, 'macro avg': {'precision': 0.4802260777403058, 'recall': 0.45038429529307344, 'f1-score': 0.44573131338911787, 'support': 405830}, 'weighted avg': {'precision': 0.48169626523047143, 'recall': 0.4858857156937634, 'f1-score': 0.4637380120555084, 'support': 405830}}
[[ 40925  58063  17552]
 [ 25892 123948  20163]
 [ 17237  69736  32314]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0729108
{'0': {'precision': 0.514028987046082, 'recall': 0.29151330397802117, 'f1-score': 0.37203829028957874, 'support': 132855}, '1': {'precision': 0.3908591418087796, 'recall': 0.7570238682642668, 'f1-score': 0.5155398187480879, 'support': 135787}, '2': {'precision': 0.48108636707116503, 'recall': 0.23667521940694522, 'f1-score': 0.31726752622398974, 'support': 137188}, 'accuracy': 0.42873124214572605, 'macro avg': {'precision': 0.46199149864200884, 'recall': 0.4284041305497444, 'f1-score': 0.4016152117538854, 'support': 405830}, 'weighted avg': {'precision': 0.4616814624068082, 'recall': 0.42873124214572605, 'f1-score': 0.4015377123731249, 'support': 405830}}
[[ 38729  74040  20086]
 [ 18057 102794  14936]
 [ 18558  86161  32469]]
Evaluating performance on  val set...
574/574 - 6s - 6s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.85887706
{'0': {'precision': 0.3865739893908908, 'recall': 0.38560064224200846, 'f1-score': 0.3860867023511574, 'support': 27404}, '1': {'precision': 0.7001133098620048, 'recall': 0.756165521160003, 'f1-score': 0.7270606899522487, 'support': 91517}, '2': {'precision': 0.38591998453807497, 'recall': 0.2857193961508192, 'f1-score': 0.32834532374100717, 'support': 27954}, 'accuracy': 0.597487659574468, 'macro avg': {'precision': 0.49086909459699024, 'recall': 0.47582851985094354, 'f1-score': 0.4804975720148044, 'support': 146875}, 'weighted avg': {'precision': 0.5818141319604181, 'recall': 0.597487659574468, 'f1-score': 0.5875560737596403, 'support': 146875}}
[[10567 13049  3788]
 [13394 69202  8921]
 [ 3374 16593  7987]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.94008934
{'0': {'precision': 0.43100916147982377, 'recall': 0.35705802265287795, 'f1-score': 0.39056385557439127, 'support': 34521}, '1': {'precision': 0.6020228626696437, 'recall': 0.7597911905256597, 'f1-score': 0.6717681705195842, 'support': 77008}, '2': {'precision': 0.43731031866464337, 'recall': 0.2609064674927856, 'f1-score': 0.32682425488180883, 'support': 35346}, 'accuracy': 0.5450757446808511, 'macro avg': {'precision': 0.4901141142713703, 'recall': 0.45925189355710777, 'f1-score': 0.46305209365859473, 'support': 146875}, 'weighted avg': {'precision': 0.5221897150327107, 'recall': 0.5450757446808511, 'f1-score': 0.5226628646584383, 'support': 146875}}
[[12326 17299  4896]
 [11528 58510  6970]
 [ 4744 21380  9222]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.99418765
{'0': {'precision': 0.4568732167678689, 'recall': 0.3192740286298569, 'f1-score': 0.3758764934244184, 'support': 39120}, '1': {'precision': 0.5319092395748161, 'recall': 0.7719188952669129, 'f1-score': 0.6298234891896962, 'support': 67419}, '2': {'precision': 0.45900354887772504, 'recall': 0.24690103133677113, 'f1-score': 0.32108716328405845, 'support': 40336}, 'accuracy': 0.5071727659574468, 'macro avg': {'precision': 0.48259533507347, 'recall': 0.4460313184111803, 'f1-score': 0.44226238196605766, 'support': 146875}, 'weighted avg': {'precision': 0.49190152449624147, 'recall': 0.5071727659574468, 'f1-score': 0.4773973110377476, 'support': 146875}}
[[12490 20785  5845]
 [ 9484 52042  5893]
 [ 5364 25013  9959]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0687603
{'0': {'precision': 0.47768235151808397, 'recall': 0.2635184732077318, 'f1-score': 0.33965996731557674, 'support': 44957}, '1': {'precision': 0.43092430657223124, 'recall': 0.7942930075667791, 'f1-score': 0.5587256392004464, 'support': 54845}, '2': {'precision': 0.4779334667810504, 'recall': 0.2130308244641302, 'f1-score': 0.29470281390052167, 'support': 47073}, 'accuracy': 0.4455353191489362, 'macro avg': {'precision': 0.4621800416237885, 'recall': 0.42361410174621367, 'f1-score': 0.3976961401388483, 'support': 146875}, 'weighted avg': {'precision': 0.4603027823178683, 'recall': 0.4455353191489362, 'f1-score': 0.4070532520258323, 'support': 146875}}
[[11847 26554  6556]
 [ 6884 43563  4398]
 [ 6070 30975 10028]]
training model: results/ATVI/W10/deepOF_L1/seq2seq
Epoch 1/50
1586/1586 - 40s - loss: 12.7497 - accuracy10: 0.4263 - accuracy20: 0.4335 - accuracy30: 0.4332 - accuracy50: 0.4301 - val_loss: 14.7365 - val_accuracy10: 0.6206 - val_accuracy20: 0.5259 - val_accuracy30: 0.4622 - val_accuracy50: 0.3777 - 40s/epoch - 25ms/step
Epoch 2/50
1586/1586 - 37s - loss: 12.7616 - accuracy10: 0.4034 - accuracy20: 0.4127 - accuracy30: 0.4160 - accuracy50: 0.4172 - val_loss: 12.7653 - val_accuracy10: 0.5991 - val_accuracy20: 0.5257 - val_accuracy30: 0.4708 - val_accuracy50: 0.3931 - 37s/epoch - 23ms/step
Epoch 3/50
1586/1586 - 35s - loss: 12.7246 - accuracy10: 0.4018 - accuracy20: 0.4092 - accuracy30: 0.4110 - accuracy50: 0.4099 - val_loss: 12.6905 - val_accuracy10: 0.6006 - val_accuracy20: 0.5263 - val_accuracy30: 0.4729 - val_accuracy50: 0.3951 - 35s/epoch - 22ms/step
Epoch 4/50
1586/1586 - 37s - loss: 12.6840 - accuracy10: 0.4070 - accuracy20: 0.4125 - accuracy30: 0.4142 - accuracy50: 0.4118 - val_loss: 12.6786 - val_accuracy10: 0.5999 - val_accuracy20: 0.5273 - val_accuracy30: 0.4742 - val_accuracy50: 0.3964 - 37s/epoch - 23ms/step
Epoch 5/50
1586/1586 - 38s - loss: 12.6494 - accuracy10: 0.4119 - accuracy20: 0.4175 - accuracy30: 0.4184 - accuracy50: 0.4154 - val_loss: 12.6729 - val_accuracy10: 0.6017 - val_accuracy20: 0.5287 - val_accuracy30: 0.4761 - val_accuracy50: 0.3980 - 38s/epoch - 24ms/step
Epoch 6/50
1586/1586 - 38s - loss: 12.6104 - accuracy10: 0.4199 - accuracy20: 0.4239 - accuracy30: 0.4236 - accuracy50: 0.4194 - val_loss: 12.6939 - val_accuracy10: 0.6052 - val_accuracy20: 0.5310 - val_accuracy30: 0.4768 - val_accuracy50: 0.3987 - 38s/epoch - 24ms/step
Epoch 7/50
1586/1586 - 34s - loss: 12.5689 - accuracy10: 0.4251 - accuracy20: 0.4283 - accuracy30: 0.4278 - accuracy50: 0.4234 - val_loss: 12.7630 - val_accuracy10: 0.6082 - val_accuracy20: 0.5318 - val_accuracy30: 0.4768 - val_accuracy50: 0.3978 - 34s/epoch - 21ms/step
Epoch 8/50
1586/1586 - 35s - loss: 12.5271 - accuracy10: 0.4332 - accuracy20: 0.4363 - accuracy30: 0.4337 - accuracy50: 0.4276 - val_loss: 12.7676 - val_accuracy10: 0.6105 - val_accuracy20: 0.5331 - val_accuracy30: 0.4783 - val_accuracy50: 0.3995 - 35s/epoch - 22ms/step
Epoch 9/50
1586/1586 - 35s - loss: 12.4930 - accuracy10: 0.4384 - accuracy20: 0.4405 - accuracy30: 0.4379 - accuracy50: 0.4319 - val_loss: 12.7387 - val_accuracy10: 0.6096 - val_accuracy20: 0.5337 - val_accuracy30: 0.4795 - val_accuracy50: 0.4013 - 35s/epoch - 22ms/step
Epoch 10/50
1586/1586 - 38s - loss: 12.4541 - accuracy10: 0.4435 - accuracy20: 0.4452 - accuracy30: 0.4423 - accuracy50: 0.4353 - val_loss: 12.7757 - val_accuracy10: 0.6098 - val_accuracy20: 0.5338 - val_accuracy30: 0.4794 - val_accuracy50: 0.4017 - 38s/epoch - 24ms/step
Epoch 11/50
1586/1586 - 36s - loss: 12.4229 - accuracy10: 0.4491 - accuracy20: 0.4506 - accuracy30: 0.4469 - accuracy50: 0.4395 - val_loss: 12.7880 - val_accuracy10: 0.6110 - val_accuracy20: 0.5343 - val_accuracy30: 0.4798 - val_accuracy50: 0.4025 - 36s/epoch - 22ms/step
Epoch 12/50
1586/1586 - 36s - loss: 12.3788 - accuracy10: 0.4532 - accuracy20: 0.4547 - accuracy30: 0.4512 - accuracy50: 0.4440 - val_loss: 12.7934 - val_accuracy10: 0.6115 - val_accuracy20: 0.5345 - val_accuracy30: 0.4801 - val_accuracy50: 0.4020 - 36s/epoch - 23ms/step
Epoch 13/50
1586/1586 - 37s - loss: 12.3448 - accuracy10: 0.4576 - accuracy20: 0.4590 - accuracy30: 0.4552 - accuracy50: 0.4475 - val_loss: 12.8356 - val_accuracy10: 0.6120 - val_accuracy20: 0.5344 - val_accuracy30: 0.4802 - val_accuracy50: 0.4025 - 37s/epoch - 24ms/step
Epoch 14/50
1586/1586 - 37s - loss: 12.3050 - accuracy10: 0.4617 - accuracy20: 0.4626 - accuracy30: 0.4590 - accuracy50: 0.4508 - val_loss: 12.8758 - val_accuracy10: 0.6119 - val_accuracy20: 0.5348 - val_accuracy30: 0.4799 - val_accuracy50: 0.4034 - 37s/epoch - 24ms/step
Epoch 15/50
1586/1586 - 39s - loss: 12.2744 - accuracy10: 0.4645 - accuracy20: 0.4656 - accuracy30: 0.4620 - accuracy50: 0.4546 - val_loss: 12.9134 - val_accuracy10: 0.6103 - val_accuracy20: 0.5339 - val_accuracy30: 0.4805 - val_accuracy50: 0.4040 - 39s/epoch - 24ms/step
testing model: results/ATVI/W10/deepOF_L1/seq2seq
Evaluating performance on  test set...
7633/7633 - 71s - 71s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9759991
{'0': {'precision': 0.39296325939894966, 'recall': 0.16845979215724982, 'f1-score': 0.23582397915542627, 'support': 425514}, '1': {'precision': 0.5874858676745544, 'recall': 0.8743817858573264, 'f1-score': 0.7027817339034037, 'support': 1103582}, '2': {'precision': 0.4129693626121589, 'recall': 0.12543805764826885, 'f1-score': 0.19242704600637248, 'support': 424887}, 'accuracy': 0.5577996328524865, 'macro avg': {'precision': 0.464472829895221, 'recall': 0.3894265452209484, 'f1-score': 0.37701091968840084, 'support': 1953983}, 'weighted avg': {'precision': 0.5071771406159097, 'recall': 0.5577996328524865, 'f1-score': 0.4901186071871852, 'support': 1953983}}
[[ 71682 334738  19094]
 [ 81963 964952  56667]
 [ 28769 342821  53297]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0359277
{'0': {'precision': 0.4496266729849758, 'recall': 0.14238633565228098, 'f1-score': 0.21628137707725417, 'support': 519776}, '1': {'precision': 0.4848166703687316, 'recall': 0.8927044132740335, 'f1-score': 0.6283722062859217, 'support': 911976}, '2': {'precision': 0.4746547544466538, 'recall': 0.10010512589256479, 'f1-score': 0.16533991176051996, 'support': 522231}, 'accuracy': 0.48127951983205586, 'macro avg': {'precision': 0.4696993659334537, 'recall': 0.37839862493962645, 'f1-score': 0.33666449837456525, 'support': 1953983}, 'weighted avg': {'precision': 0.47273991044091157, 'recall': 0.48127951983205586, 'f1-score': 0.3950002982165785, 'support': 1953983}}
[[ 74009 426532  19235]
 [ 59225 814125  38626]
 [ 31367 438586  52278]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0728755
{'0': {'precision': 0.48377685314043106, 'recall': 0.11762382087624439, 'f1-score': 0.189237173739135, 'support': 582212}, '1': {'precision': 0.41674157486057783, 'recall': 0.9113274345273167, 'f1-score': 0.5719402043024977, 'support': 787504}, '2': {'precision': 0.5090347439048695, 'recall': 0.07868833940646999, 'f1-score': 0.13630602518585502, 'support': 584267}, 'accuracy': 0.4258639916519233, 'macro avg': {'precision': 0.4698510573019594, 'recall': 0.36921319827001037, 'f1-score': 0.29916113440916253, 'support': 1953983}, 'weighted avg': {'precision': 0.4643124065596617, 'recall': 0.4258639916519233, 'f1-score': 0.32764894293517766, 'support': 1953983}}
[[ 68482 496282  17448]
 [ 42935 717674  26895]
 [ 30140 508152  45975]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1188223
{'0': {'precision': 0.5156094822747096, 'recall': 0.09018201042217355, 'f1-score': 0.1535138748722432, 'support': 662050}, '1': {'precision': 0.32955239092890914, 'recall': 0.9279669124212352, 'f1-score': 0.4863761755014344, 'support': 627184}, '2': {'precision': 0.5393274002606117, 'recall': 0.05852735393358997, 'f1-score': 0.10559556621300144, 'support': 664749}, 'accuracy': 0.34832288714896703, 'macro avg': {'precision': 0.4614964244880768, 'recall': 0.3588920922589996, 'f1-score': 0.24849520552889304, 'support': 1953983}, 'weighted avg': {'precision': 0.46395828136077427, 'recall': 0.34832288714896703, 'f1-score': 0.24405317915221716, 'support': 1953983}}
[[ 59705 586346  15999]
 [ 27945 582006  17233]
 [ 28145 597698  38906]]
Evaluating performance on  train set...
1586/1586 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.95550525
{'0': {'precision': 0.3956210438933278, 'recall': 0.22854025799645136, 'f1-score': 0.2897178507108825, 'support': 83412}, '1': {'precision': 0.6128629543018611, 'recall': 0.843534164822638, 'f1-score': 0.7099311492987952, 'support': 238608}, '2': {'precision': 0.405008724212255, 'recall': 0.14124806109056198, 'f1-score': 0.20944983589734517, 'support': 83810}, 'accuracy': 0.57209915481852, 'macro avg': {'precision': 0.47116424080248126, 'recall': 0.40444082796988373, 'f1-score': 0.40303294530234096, 'support': 405830}, 'weighted avg': {'precision': 0.5252872569536945, 'recall': 0.57209915481852, 'f1-score': 0.5202059674788447, 'support': 405830}}
[[ 19063  60612   3737]
 [ 23680 201274  13654]
 [  5442  66530  11838]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0150743
{'0': {'precision': 0.46159942036860935, 'recall': 0.19643683033993678, 'f1-score': 0.2755931057789794, 'support': 103784}, '1': {'precision': 0.5046199843672449, 'recall': 0.8630792926237882, 'f1-score': 0.6368754688672167, 'support': 196727}, '2': {'precision': 0.46758763050295743, 'recall': 0.11184116826023795, 'f1-score': 0.18050724082445788, 'support': 105319}, 'accuracy': 0.4976394056624695, 'macro avg': {'precision': 0.4779356784129372, 'recall': 0.3904524304079877, 'f1-score': 0.3643252718235513, 'support': 405830}, 'weighted avg': {'precision': 0.48400776572725457, 'recall': 0.4976394056624695, 'f1-score': 0.4260493244718173, 'support': 405830}}
[[ 20387  79372   4025]
 [ 17549 169791   9387]
 [  6230  87310  11779]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0528843
{'0': {'precision': 0.5005696235306302, 'recall': 0.16571237549928858, 'f1-score': 0.2489954149708928, 'support': 116666}, '1': {'precision': 0.43393268547870223, 'recall': 0.8845723769391934, 'f1-score': 0.5822425381084274, 'support': 169916}, '2': {'precision': 0.49889603532686955, 'recall': 0.08716288742788139, 'f1-score': 0.148398794991505, 'support': 119248}, 'accuracy': 0.4436093930956312, 'macro avg': {'precision': 0.4777994481120673, 'recall': 0.37914921328878776, 'f1-score': 0.32654558269027506, 'support': 405830}, 'weighted avg': {'precision': 0.47217779933785625, 'recall': 0.4436093930956312, 'f1-score': 0.35896282111567096, 'support': 405830}}
[[ 19333  93533   3800]
 [ 12973 150303   6640]
 [  6316 102538  10394]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1004316
{'0': {'precision': 0.5388313380063271, 'recall': 0.13061914965602797, 'f1-score': 0.21026705477255261, 'support': 133005}, '1': {'precision': 0.3440587191753756, 'recall': 0.9052004453521896, 'f1-score': 0.4986028754772155, 'support': 135623}, '2': {'precision': 0.5279947528471767, 'recall': 0.06453987551201877, 'f1-score': 0.1150201658732375, 'support': 137202}, 'accuracy': 0.3671340216346746, 'macro avg': {'precision': 0.47029493667629313, 'recall': 0.36678649017341214, 'f1-score': 0.27463003204100184, 'support': 405830}, 'weighted avg': {'precision': 0.4700773078934328, 'recall': 0.3671340216346746, 'f1-score': 0.27442422738341105, 'support': 405830}}
[[ 17373 112056   3576]
 [  8517 122766   4340]
 [  6352 121995   8855]]
Evaluating performance on  val set...
574/574 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9352802
{'0': {'precision': 0.37828716969118115, 'recall': 0.21637469497760134, 'f1-score': 0.27528844817200315, 'support': 27457}, '1': {'precision': 0.646605432293334, 'recall': 0.8612474717104903, 'f1-score': 0.738649363314142, 'support': 91465}, '2': {'precision': 0.39023868136572837, 'recall': 0.1304332272028047, 'f1-score': 0.1955169455169455, 'support': 27953}, 'accuracy': 0.6016068085106383, 'macro avg': {'precision': 0.4717104277834145, 'recall': 0.4026851312969654, 'f1-score': 0.4031515856676969, 'support': 146875}, 'weighted avg': {'precision': 0.547654390080931, 'recall': 0.6016068085106383, 'f1-score': 0.5486600450384467, 'support': 146875}}
[[ 5941 20342  1174]
 [ 8168 78774  4523]
 [ 1596 22711  3646]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.99577
{'0': {'precision': 0.44455205811138016, 'recall': 0.18591598194653397, 'f1-score': 0.2621840510822334, 'support': 34564}, '1': {'precision': 0.5435695643445091, 'recall': 0.8793390147578466, 'f1-score': 0.6718378568840849, 'support': 76976}, '2': {'precision': 0.45142495250158327, 'recall': 0.10086316683175323, 'f1-score': 0.16488549618320614, 'support': 35335}, 'accuracy': 0.5288714893617021, 'macro avg': {'precision': 0.4798488583191575, 'recall': 0.3887060545120446, 'f1-score': 0.3663024680498415, 'support': 146875}, 'weighted avg': {'precision': 0.4980998047195787, 'recall': 0.5288714893617021, 'f1-score': 0.4534723364816969, 'support': 146875}}
[[ 6426 26927  1211]
 [ 6168 67688  3120]
 [ 1861 29910  3564]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0351079
{'0': {'precision': 0.4825572217837411, 'recall': 0.15635229132569559, 'f1-score': 0.2361803221694287, 'support': 39104}, '1': {'precision': 0.4746876540215767, 'recall': 0.9000637859166629, 'f1-score': 0.6215656948513593, 'support': 67413}, '2': {'precision': 0.48292071450955815, 'recall': 0.0763665196491402, 'f1-score': 0.13187847667950364, 'support': 40358}, 'accuracy': 0.4757242553191489, 'macro avg': {'precision': 0.48005519677162534, 'recall': 0.3775941989638329, 'f1-score': 0.32987483123343053, 'support': 146875}, 'weighted avg': {'precision': 0.47904511058631294, 'recall': 0.4757242553191489, 'f1-score': 0.3844054813069578, 'support': 146875}}
[[ 6114 31859  1131]
 [ 4568 60676  2169]
 [ 1988 35288  3082]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0870929
{'0': {'precision': 0.5190977158563169, 'recall': 0.12186547404490132, 'f1-score': 0.19739070890546725, 'support': 44943}, '1': {'precision': 0.3840583021109385, 'recall': 0.919504813302217, 'f1-score': 0.541812595346039, 'support': 54848}, '2': {'precision': 0.5009984025559105, 'recall': 0.053287741058533684, 'f1-score': 0.09632957075942562, 'support': 47084}, 'accuracy': 0.3977463829787234, 'macro avg': {'precision': 0.46805147350772197, 'recall': 0.36488600946855065, 'f1-score': 0.2785109583369773, 'support': 146875}, 'weighted avg': {'precision': 0.46286738508155706, 'recall': 0.3977463829787234, 'f1-score': 0.29361191060095154, 'support': 146875}}
[[ 5477 38355  1111]
 [ 3027 50433  1388]
 [ 2047 42528  2509]]
training model: results/ATVI/W10/deepLOB_L2/seq2seq
Epoch 1/50
1586/1586 - 82s - loss: 12.1009 - accuracy10: 0.4501 - accuracy20: 0.4691 - accuracy30: 0.4735 - accuracy50: 0.4680 - val_loss: 13.6711 - val_accuracy10: 0.6174 - val_accuracy20: 0.5248 - val_accuracy30: 0.4623 - val_accuracy50: 0.3789 - 82s/epoch - 52ms/step
Epoch 2/50
1586/1586 - 75s - loss: 11.5582 - accuracy10: 0.5064 - accuracy20: 0.5172 - accuracy30: 0.5140 - accuracy50: 0.4973 - val_loss: 13.0103 - val_accuracy10: 0.6294 - val_accuracy20: 0.5530 - val_accuracy30: 0.4973 - val_accuracy50: 0.4202 - 75s/epoch - 47ms/step
Epoch 3/50
1586/1586 - 75s - loss: 11.2218 - accuracy10: 0.5476 - accuracy20: 0.5471 - accuracy30: 0.5369 - accuracy50: 0.5137 - val_loss: 12.2089 - val_accuracy10: 0.6362 - val_accuracy20: 0.5773 - val_accuracy30: 0.5289 - val_accuracy50: 0.4566 - 75s/epoch - 47ms/step
Epoch 4/50
1586/1586 - 75s - loss: 11.0005 - accuracy10: 0.5666 - accuracy20: 0.5642 - accuracy30: 0.5514 - accuracy50: 0.5245 - val_loss: 11.9823 - val_accuracy10: 0.6250 - val_accuracy20: 0.5732 - val_accuracy30: 0.5302 - val_accuracy50: 0.4668 - 75s/epoch - 48ms/step
Epoch 5/50
1586/1586 - 75s - loss: 10.8907 - accuracy10: 0.5724 - accuracy20: 0.5700 - accuracy30: 0.5571 - accuracy50: 0.5292 - val_loss: 11.7892 - val_accuracy10: 0.6082 - val_accuracy20: 0.5664 - val_accuracy30: 0.5306 - val_accuracy50: 0.4764 - 75s/epoch - 47ms/step
Epoch 6/50
1586/1586 - 76s - loss: 10.8207 - accuracy10: 0.5750 - accuracy20: 0.5720 - accuracy30: 0.5594 - accuracy50: 0.5316 - val_loss: 11.7705 - val_accuracy10: 0.6207 - val_accuracy20: 0.5765 - val_accuracy30: 0.5377 - val_accuracy50: 0.4788 - 76s/epoch - 48ms/step
Epoch 7/50
1586/1586 - 74s - loss: 10.7576 - accuracy10: 0.5768 - accuracy20: 0.5748 - accuracy30: 0.5620 - accuracy50: 0.5340 - val_loss: 11.7234 - val_accuracy10: 0.6151 - val_accuracy20: 0.5746 - val_accuracy30: 0.5381 - val_accuracy50: 0.4812 - 74s/epoch - 47ms/step
Epoch 8/50
1586/1586 - 74s - loss: 10.7134 - accuracy10: 0.5788 - accuracy20: 0.5770 - accuracy30: 0.5649 - accuracy50: 0.5365 - val_loss: 11.5645 - val_accuracy10: 0.6101 - val_accuracy20: 0.5759 - val_accuracy30: 0.5435 - val_accuracy50: 0.4892 - 74s/epoch - 47ms/step
Epoch 9/50
1586/1586 - 76s - loss: 10.6730 - accuracy10: 0.5805 - accuracy20: 0.5790 - accuracy30: 0.5667 - accuracy50: 0.5376 - val_loss: 11.5470 - val_accuracy10: 0.6082 - val_accuracy20: 0.5763 - val_accuracy30: 0.5449 - val_accuracy50: 0.4899 - 76s/epoch - 48ms/step
Epoch 10/50
1586/1586 - 74s - loss: 10.6390 - accuracy10: 0.5817 - accuracy20: 0.5807 - accuracy30: 0.5681 - accuracy50: 0.5391 - val_loss: 11.6109 - val_accuracy10: 0.6038 - val_accuracy20: 0.5744 - val_accuracy30: 0.5451 - val_accuracy50: 0.4922 - 74s/epoch - 47ms/step
Epoch 11/50
1586/1586 - 75s - loss: 10.6115 - accuracy10: 0.5824 - accuracy20: 0.5821 - accuracy30: 0.5693 - accuracy50: 0.5403 - val_loss: 11.6186 - val_accuracy10: 0.6102 - val_accuracy20: 0.5777 - val_accuracy30: 0.5453 - val_accuracy50: 0.4904 - 75s/epoch - 47ms/step
Epoch 12/50
1586/1586 - 75s - loss: 10.5798 - accuracy10: 0.5835 - accuracy20: 0.5832 - accuracy30: 0.5710 - accuracy50: 0.5421 - val_loss: 11.5345 - val_accuracy10: 0.6123 - val_accuracy20: 0.5810 - val_accuracy30: 0.5486 - val_accuracy50: 0.4909 - 75s/epoch - 48ms/step
Epoch 13/50
1586/1586 - 75s - loss: 10.5563 - accuracy10: 0.5853 - accuracy20: 0.5848 - accuracy30: 0.5725 - accuracy50: 0.5432 - val_loss: 11.5484 - val_accuracy10: 0.6036 - val_accuracy20: 0.5764 - val_accuracy30: 0.5466 - val_accuracy50: 0.4939 - 75s/epoch - 48ms/step
Epoch 14/50
1586/1586 - 75s - loss: 10.5381 - accuracy10: 0.5853 - accuracy20: 0.5854 - accuracy30: 0.5731 - accuracy50: 0.5442 - val_loss: 11.5089 - val_accuracy10: 0.6105 - val_accuracy20: 0.5807 - val_accuracy30: 0.5488 - val_accuracy50: 0.4938 - 75s/epoch - 47ms/step
Epoch 15/50
1586/1586 - 75s - loss: 10.5122 - accuracy10: 0.5862 - accuracy20: 0.5862 - accuracy30: 0.5744 - accuracy50: 0.5454 - val_loss: 11.5864 - val_accuracy10: 0.6135 - val_accuracy20: 0.5823 - val_accuracy30: 0.5498 - val_accuracy50: 0.4933 - 75s/epoch - 47ms/step
Epoch 16/50
1586/1586 - 75s - loss: 10.4869 - accuracy10: 0.5878 - accuracy20: 0.5887 - accuracy30: 0.5766 - accuracy50: 0.5475 - val_loss: 11.6865 - val_accuracy10: 0.6131 - val_accuracy20: 0.5811 - val_accuracy30: 0.5480 - val_accuracy50: 0.4908 - 75s/epoch - 47ms/step
Epoch 17/50
1586/1586 - 76s - loss: 10.4649 - accuracy10: 0.5887 - accuracy20: 0.5889 - accuracy30: 0.5773 - accuracy50: 0.5482 - val_loss: 11.6543 - val_accuracy10: 0.6028 - val_accuracy20: 0.5748 - val_accuracy30: 0.5439 - val_accuracy50: 0.4912 - 76s/epoch - 48ms/step
Epoch 18/50
1586/1586 - 74s - loss: 10.4422 - accuracy10: 0.5906 - accuracy20: 0.5907 - accuracy30: 0.5783 - accuracy50: 0.5495 - val_loss: 11.7376 - val_accuracy10: 0.6073 - val_accuracy20: 0.5763 - val_accuracy30: 0.5446 - val_accuracy50: 0.4894 - 74s/epoch - 47ms/step
Epoch 19/50
1586/1586 - 75s - loss: 10.4209 - accuracy10: 0.5912 - accuracy20: 0.5918 - accuracy30: 0.5805 - accuracy50: 0.5514 - val_loss: 11.7641 - val_accuracy10: 0.6135 - val_accuracy20: 0.5806 - val_accuracy30: 0.5469 - val_accuracy50: 0.4901 - 75s/epoch - 47ms/step
Epoch 20/50
1586/1586 - 74s - loss: 10.3982 - accuracy10: 0.5915 - accuracy20: 0.5929 - accuracy30: 0.5812 - accuracy50: 0.5525 - val_loss: 11.6474 - val_accuracy10: 0.6070 - val_accuracy20: 0.5774 - val_accuracy30: 0.5465 - val_accuracy50: 0.4927 - 74s/epoch - 47ms/step
Epoch 21/50
1586/1586 - 75s - loss: 10.3789 - accuracy10: 0.5915 - accuracy20: 0.5936 - accuracy30: 0.5822 - accuracy50: 0.5536 - val_loss: 11.7630 - val_accuracy10: 0.6098 - val_accuracy20: 0.5765 - val_accuracy30: 0.5430 - val_accuracy50: 0.4872 - 75s/epoch - 47ms/step
Epoch 22/50
1586/1586 - 74s - loss: 10.3606 - accuracy10: 0.5933 - accuracy20: 0.5953 - accuracy30: 0.5836 - accuracy50: 0.5555 - val_loss: 11.7961 - val_accuracy10: 0.6124 - val_accuracy20: 0.5793 - val_accuracy30: 0.5475 - val_accuracy50: 0.4914 - 74s/epoch - 47ms/step
Epoch 23/50
1586/1586 - 74s - loss: 10.3395 - accuracy10: 0.5933 - accuracy20: 0.5959 - accuracy30: 0.5841 - accuracy50: 0.5559 - val_loss: 11.8434 - val_accuracy10: 0.6012 - val_accuracy20: 0.5722 - val_accuracy30: 0.5402 - val_accuracy50: 0.4907 - 74s/epoch - 47ms/step
Epoch 24/50
1586/1586 - 73s - loss: 10.3177 - accuracy10: 0.5929 - accuracy20: 0.5961 - accuracy30: 0.5849 - accuracy50: 0.5569 - val_loss: 11.7873 - val_accuracy10: 0.6050 - val_accuracy20: 0.5732 - val_accuracy30: 0.5424 - val_accuracy50: 0.4905 - 73s/epoch - 46ms/step
testing model: results/ATVI/W10/deepLOB_L2/seq2seq
Evaluating performance on  test set...
7633/7633 - 117s - 117s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8955877
{'0': {'precision': 0.46512359807736325, 'recall': 0.4202591676928717, 'f1-score': 0.4415546896991067, 'support': 425516}, '1': {'precision': 0.7540619035943918, 'recall': 0.6326257291023875, 'f1-score': 0.6880265609955841, 'support': 1103583}, '2': {'precision': 0.38962832688838933, 'recall': 0.5902412159411046, 'f1-score': 0.4693986033357478, 'support': 424889}, 'accuracy': 0.577162705195733, 'macro avg': {'precision': 0.5362712761867149, 'recall': 0.5477087042454546, 'f1-score': 0.5329932846768128, 'support': 1953988}, 'weighted avg': {'precision': 0.6118953754563374, 'recall': 0.577162705195733, 'f1-score': 0.5868128692591343, 'support': 1953988}}
[[178827 114456 132233]
 [144791 698155 260637]
 [ 60854 113248 250787]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9334268
{'0': {'precision': 0.5129551974073182, 'recall': 0.36053976786288017, 'f1-score': 0.4234500601616739, 'support': 519779}, '1': {'precision': 0.6538388962869912, 'recall': 0.664907119368142, 'f1-score': 0.6593265600807223, 'support': 911977}, '2': {'precision': 0.4366074493714054, 'recall': 0.5528213514300158, 'f1-score': 0.4878894166218127, 'support': 522232}, 'accuracy': 0.5539860019611175, 'macro avg': {'precision': 0.5344671810219049, 'recall': 0.5260894128870126, 'f1-score': 0.5235553456214029, 'support': 1953988}, 'weighted avg': {'precision': 0.5583042250886022, 'recall': 0.5539860019611175, 'f1-score': 0.550762119790272, 'support': 1953988}}
[[187401 161474 170904]
 [103965 606380 201632]
 [ 73970 159561 288701]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9676463
{'0': {'precision': 0.5311986623716011, 'recall': 0.31212181067131556, 'f1-score': 0.3932044664523814, 'support': 582215}, '1': {'precision': 0.5754938379792505, 'recall': 0.6838153408549787, 'f1-score': 0.6249958653394746, 'support': 787505}, '2': {'precision': 0.4532091611723887, 'recall': 0.5244870504631436, 'f1-score': 0.48624988694298593, 'support': 584268}, 'accuracy': 0.5254233905223573, 'macro avg': {'precision': 0.5199672205077468, 'recall': 0.5068080673298127, 'f1-score': 0.5014834062449472, 'support': 1953988}, 'weighted avg': {'precision': 0.5257308203890713, 'recall': 0.5254233905223573, 'f1-score': 0.514443873920485, 'support': 1953988}}
[[181722 198834 201659]
 [ 80939 538508 168058]
 [ 79437 198390 306441]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0217104
{'0': {'precision': 0.5415630659174174, 'recall': 0.25430932917656013, 'f1-score': 0.3460970397999467, 'support': 662052}, '1': {'precision': 0.4616337543174493, 'recall': 0.7011009510750417, 'f1-score': 0.5567080137872971, 'support': 627185}, '2': {'precision': 0.465511773624359, 'recall': 0.4835916004639331, 'f1-score': 0.47437948233627486, 'support': 664751}, 'accuracy': 0.4757214476240386, 'macro avg': {'precision': 0.48956953128640857, 'recall': 0.47966729357184495, 'f1-score': 0.45906151197450623, 'support': 1953988}, 'weighted avg': {'precision': 0.4900347873922019, 'recall': 0.4757214476240386, 'f1-score': 0.45734026426126534, 'support': 1953988}}
[[168366 253677 240009]
 [ 58373 439720 129092]
 [ 84150 259133 321468]]
Evaluating performance on  train set...
1586/1586 - 27s - 27s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8533266
{'0': {'precision': 0.4603111143417896, 'recall': 0.4562374668283721, 'f1-score': 0.4582652378166818, 'support': 83279}, '1': {'precision': 0.7662709183573841, 'recall': 0.6577384818454189, 'f1-score': 0.7078687408255898, 'support': 238645}, '2': {'precision': 0.3980615311877343, 'recall': 0.561914523395228, 'f1-score': 0.46600444773906596, 'support': 83906}, 'accuracy': 0.5965773846191755, 'macro avg': {'precision': 0.5415478546289693, 'recall': 0.5586301573563396, 'f1-score': 0.5440461421271124, 'support': 405830}, 'weighted avg': {'precision': 0.6273580648017788, 'recall': 0.5965773846191755, 'f1-score': 0.6066426227396998, 'support': 405830}}
[[ 37995  23159  22125]
 [ 32508 156966  49171]
 [ 12039  24719  47148]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.89141184
{'0': {'precision': 0.5244527070607429, 'recall': 0.4004925394755903, 'f1-score': 0.45416611906952287, 'support': 103545}, '1': {'precision': 0.6673951027678949, 'recall': 0.6962427011931962, 'f1-score': 0.6815137681933734, 'support': 196950}, '2': {'precision': 0.4541617200896979, 'recall': 0.522979066786918, 'f1-score': 0.4861470849089489, 'support': 105335}, 'accuracy': 0.5758125323411281, 'macro avg': {'precision': 0.5486698433061119, 'recall': 0.5399047691519016, 'f1-score': 0.5406089907239483, 'support': 405830}, 'weighted avg': {'precision': 0.5755785571012243, 'recall': 0.5758125323411281, 'f1-score': 0.5727991292748756, 'support': 405830}}
[[ 41469  33085  28991]
 [ 22608 137125  37217]
 [ 14994  35253  55088]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9284416
{'0': {'precision': 0.5488067961034959, 'recall': 0.35145014587266177, 'f1-score': 0.4284959538842189, 'support': 116540}, '1': {'precision': 0.5903074151501431, 'recall': 0.7208637494632447, 'f1-score': 0.6490856847764198, 'support': 170003}, '2': {'precision': 0.47499534778352226, 'recall': 0.4921575695591305, 'f1-score': 0.4834241860311918, 'support': 119287}, 'accuracy': 0.5475568587832343, 'macro avg': {'precision': 0.5380365196790537, 'recall': 0.5214904882983457, 'f1-score': 0.5203352748972768, 'support': 405830}, 'weighted avg': {'precision': 0.5444958370912062, 'recall': 0.5475568587832343, 'f1-score': 0.5370466772141422, 'support': 405830}}
[[ 40958  41019  34563]
 [ 17128 122549  30326]
 [ 16545  44034  58708]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.99105555
{'0': {'precision': 0.5626642527594463, 'recall': 0.29007564638139327, 'f1-score': 0.3828018296771246, 'support': 132855}, '1': {'precision': 0.47745294011766154, 'recall': 0.7423170112013668, 'f1-score': 0.5811283334438356, 'support': 135787}, '2': {'precision': 0.4891700469007479, 'recall': 0.45007580837974165, 'f1-score': 0.4688093177228069, 'support': 137188}, 'accuracy': 0.4954784022866718, 'macro avg': {'precision': 0.5097624132592852, 'recall': 0.49415615532083385, 'f1-score': 0.4775798269479224, 'support': 405830}, 'weighted avg': {'precision': 0.5093091246934257, 'recall': 0.4954784022866718, 'f1-score': 0.4782342921293372, 'support': 405830}}
[[ 38538  52798  41519]
 [ 12030 100797  22960]
 [ 17924  57519  61745]]
Evaluating performance on  val set...
574/574 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8486662
{'0': {'precision': 0.41418282943525386, 'recall': 0.42391621661071377, 'f1-score': 0.4189930029575128, 'support': 27404}, '1': {'precision': 0.7672009335778418, 'recall': 0.7040003496618115, 'f1-score': 0.7342431408302231, 'support': 91517}, '2': {'precision': 0.388246434617923, 'recall': 0.48400944408671387, 'f1-score': 0.4308711367291372, 'support': 27954}, 'accuracy': 0.609872340425532, 'macro avg': {'precision': 0.5232100658770062, 'recall': 0.5373086701197464, 'f1-score': 0.528035760172291, 'support': 146875}, 'weighted avg': {'precision': 0.6292101101575931, 'recall': 0.609872340425532, 'f1-score': 0.6176843270027814, 'support': 146875}}
[[11617  9136  6651]
 [12421 64428 14668]
 [ 4010 10414 13530]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.89865404
{'0': {'precision': 0.4721136112135743, 'recall': 0.37075982735146723, 'f1-score': 0.41534292807191187, 'support': 34521}, '1': {'precision': 0.6726442972212955, 'recall': 0.7330537087055891, 'f1-score': 0.7015509656252331, 'support': 77008}, '2': {'precision': 0.4435702128846851, 'recall': 0.449782153567589, 'f1-score': 0.4466545858092067, 'support': 35346}, 'accuracy': 0.5797310638297872, 'macro avg': {'precision': 0.5294427071065183, 'recall': 0.5178652298748817, 'f1-score': 0.5211828265021171, 'support': 146875}, 'weighted avg': {'precision': 0.5703847404782529, 'recall': 0.5797310638297872, 'f1-score': 0.5729398670355789, 'support': 146875}}
[[12799 13101  8621]
 [ 9235 56451 11322]
 [ 5076 14372 15898]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.93982255
{'0': {'precision': 0.49932215207034125, 'recall': 0.3295245398773006, 'f1-score': 0.39703096847713937, 'support': 39120}, '1': {'precision': 0.5999668002561123, 'recall': 0.7505302659487681, 'f1-score': 0.6668555651469125, 'support': 67419}, '2': {'precision': 0.4675653594771242, 'recall': 0.42564954383181275, 'f1-score': 0.4456239617940199, 'support': 40336}, 'accuracy': 0.5491744680851064, 'macro avg': {'precision': 0.5222847706011926, 'recall': 0.5019014498859605, 'f1-score': 0.5031701651393572, 'support': 146875}, 'weighted avg': {'precision': 0.5367990511341472, 'recall': 0.5491744680851064, 'f1-score': 0.5342316592775419, 'support': 146875}}
[[12891 16165 10064]
 [ 7332 50600  9487]
 [ 5594 17573 17169]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0050309
{'0': {'precision': 0.5134291068082448, 'recall': 0.2742620726471962, 'f1-score': 0.3575363915791915, 'support': 44957}, '1': {'precision': 0.49289690806586395, 'recall': 0.7635700610812289, 'f1-score': 0.5990787365529869, 'support': 54845}, '2': {'precision': 0.48505158719687574, 'recall': 0.39049986191659763, 'f1-score': 0.43267035424267386, 'support': 47073}, 'accuracy': 0.49422978723404254, 'macro avg': {'precision': 0.49712586735699477, 'recall': 0.47611066521500756, 'f1-score': 0.4630951607916174, 'support': 146875}, 'weighted avg': {'precision': 0.4966672111780024, 'recall': 0.49422978723404254, 'f1-score': 0.4718115979420573, 'support': 146875}}
[[12330 20603 12024]
 [ 5476 41878  7491]
 [ 6209 22482 18382]]
training model: results/ATVI/W10/deepOF_L2/seq2seq
Epoch 1/50
1586/1586 - 52s - loss: 11.7699 - accuracy10: 0.5069 - accuracy20: 0.5121 - accuracy30: 0.5035 - accuracy50: 0.4839 - val_loss: 12.1064 - val_accuracy10: 0.6348 - val_accuracy20: 0.5813 - val_accuracy30: 0.5371 - val_accuracy50: 0.4690 - 52s/epoch - 33ms/step
Epoch 2/50
1586/1586 - 44s - loss: 11.0521 - accuracy10: 0.5640 - accuracy20: 0.5630 - accuracy30: 0.5504 - accuracy50: 0.5220 - val_loss: 12.0179 - val_accuracy10: 0.6147 - val_accuracy20: 0.5749 - val_accuracy30: 0.5375 - val_accuracy50: 0.4773 - 44s/epoch - 28ms/step
Epoch 3/50
1586/1586 - 44s - loss: 10.9175 - accuracy10: 0.5721 - accuracy20: 0.5687 - accuracy30: 0.5553 - accuracy50: 0.5275 - val_loss: 11.9766 - val_accuracy10: 0.6177 - val_accuracy20: 0.5776 - val_accuracy30: 0.5397 - val_accuracy50: 0.4782 - 44s/epoch - 28ms/step
Epoch 4/50
1586/1586 - 44s - loss: 10.8469 - accuracy10: 0.5753 - accuracy20: 0.5730 - accuracy30: 0.5593 - accuracy50: 0.5302 - val_loss: 11.7971 - val_accuracy10: 0.6100 - val_accuracy20: 0.5755 - val_accuracy30: 0.5407 - val_accuracy50: 0.4814 - 44s/epoch - 28ms/step
Epoch 5/50
1586/1586 - 44s - loss: 10.7927 - accuracy10: 0.5787 - accuracy20: 0.5756 - accuracy30: 0.5616 - accuracy50: 0.5326 - val_loss: 11.7952 - val_accuracy10: 0.6150 - val_accuracy20: 0.5803 - val_accuracy30: 0.5449 - val_accuracy50: 0.4848 - 44s/epoch - 28ms/step
Epoch 6/50
1586/1586 - 45s - loss: 10.7487 - accuracy10: 0.5802 - accuracy20: 0.5769 - accuracy30: 0.5635 - accuracy50: 0.5348 - val_loss: 11.8135 - val_accuracy10: 0.6109 - val_accuracy20: 0.5780 - val_accuracy30: 0.5437 - val_accuracy50: 0.4855 - 45s/epoch - 28ms/step
Epoch 7/50
1586/1586 - 44s - loss: 10.7125 - accuracy10: 0.5822 - accuracy20: 0.5791 - accuracy30: 0.5657 - accuracy50: 0.5365 - val_loss: 11.7020 - val_accuracy10: 0.6135 - val_accuracy20: 0.5814 - val_accuracy30: 0.5482 - val_accuracy50: 0.4900 - 44s/epoch - 28ms/step
Epoch 8/50
1586/1586 - 47s - loss: 10.6799 - accuracy10: 0.5839 - accuracy20: 0.5807 - accuracy30: 0.5675 - accuracy50: 0.5382 - val_loss: 11.6860 - val_accuracy10: 0.6098 - val_accuracy20: 0.5782 - val_accuracy30: 0.5461 - val_accuracy50: 0.4888 - 47s/epoch - 30ms/step
Epoch 9/50
1586/1586 - 44s - loss: 10.6504 - accuracy10: 0.5849 - accuracy20: 0.5831 - accuracy30: 0.5697 - accuracy50: 0.5403 - val_loss: 11.6811 - val_accuracy10: 0.6146 - val_accuracy20: 0.5835 - val_accuracy30: 0.5515 - val_accuracy50: 0.4929 - 44s/epoch - 28ms/step
Epoch 10/50
1586/1586 - 44s - loss: 10.6202 - accuracy10: 0.5860 - accuracy20: 0.5842 - accuracy30: 0.5712 - accuracy50: 0.5417 - val_loss: 11.7272 - val_accuracy10: 0.6083 - val_accuracy20: 0.5793 - val_accuracy30: 0.5488 - val_accuracy50: 0.4936 - 44s/epoch - 28ms/step
Epoch 11/50
1586/1586 - 44s - loss: 10.5917 - accuracy10: 0.5877 - accuracy20: 0.5858 - accuracy30: 0.5728 - accuracy50: 0.5432 - val_loss: 11.5534 - val_accuracy10: 0.6146 - val_accuracy20: 0.5854 - val_accuracy30: 0.5546 - val_accuracy50: 0.4972 - 44s/epoch - 28ms/step
Epoch 12/50
1586/1586 - 44s - loss: 10.5670 - accuracy10: 0.5887 - accuracy20: 0.5863 - accuracy30: 0.5737 - accuracy50: 0.5444 - val_loss: 11.5331 - val_accuracy10: 0.6164 - val_accuracy20: 0.5873 - val_accuracy30: 0.5558 - val_accuracy50: 0.4985 - 44s/epoch - 28ms/step
Epoch 13/50
1586/1586 - 45s - loss: 10.5392 - accuracy10: 0.5898 - accuracy20: 0.5881 - accuracy30: 0.5752 - accuracy50: 0.5461 - val_loss: 11.5251 - val_accuracy10: 0.6160 - val_accuracy20: 0.5881 - val_accuracy30: 0.5569 - val_accuracy50: 0.4997 - 45s/epoch - 28ms/step
Epoch 14/50
1586/1586 - 44s - loss: 10.5197 - accuracy10: 0.5912 - accuracy20: 0.5894 - accuracy30: 0.5766 - accuracy50: 0.5470 - val_loss: 11.5509 - val_accuracy10: 0.6128 - val_accuracy20: 0.5854 - val_accuracy30: 0.5551 - val_accuracy50: 0.5004 - 44s/epoch - 28ms/step
Epoch 15/50
1586/1586 - 44s - loss: 10.4943 - accuracy10: 0.5920 - accuracy20: 0.5909 - accuracy30: 0.5780 - accuracy50: 0.5481 - val_loss: 11.4779 - val_accuracy10: 0.6144 - val_accuracy20: 0.5867 - val_accuracy30: 0.5564 - val_accuracy50: 0.5007 - 44s/epoch - 28ms/step
Epoch 16/50
1586/1586 - 44s - loss: 10.4739 - accuracy10: 0.5924 - accuracy20: 0.5920 - accuracy30: 0.5795 - accuracy50: 0.5498 - val_loss: 11.4911 - val_accuracy10: 0.6125 - val_accuracy20: 0.5856 - val_accuracy30: 0.5568 - val_accuracy50: 0.5015 - 44s/epoch - 28ms/step
Epoch 17/50
1586/1586 - 44s - loss: 10.4496 - accuracy10: 0.5934 - accuracy20: 0.5932 - accuracy30: 0.5808 - accuracy50: 0.5518 - val_loss: 11.4430 - val_accuracy10: 0.6148 - val_accuracy20: 0.5896 - val_accuracy30: 0.5598 - val_accuracy50: 0.5038 - 44s/epoch - 28ms/step
Epoch 18/50
1586/1586 - 44s - loss: 10.4332 - accuracy10: 0.5931 - accuracy20: 0.5938 - accuracy30: 0.5815 - accuracy50: 0.5524 - val_loss: 11.5207 - val_accuracy10: 0.6184 - val_accuracy20: 0.5906 - val_accuracy30: 0.5608 - val_accuracy50: 0.5029 - 44s/epoch - 28ms/step
Epoch 19/50
1586/1586 - 45s - loss: 10.4059 - accuracy10: 0.5939 - accuracy20: 0.5949 - accuracy30: 0.5829 - accuracy50: 0.5542 - val_loss: 11.5484 - val_accuracy10: 0.6073 - val_accuracy20: 0.5838 - val_accuracy30: 0.5559 - val_accuracy50: 0.5035 - 45s/epoch - 29ms/step
Epoch 20/50
1586/1586 - 45s - loss: 10.3884 - accuracy10: 0.5945 - accuracy20: 0.5962 - accuracy30: 0.5846 - accuracy50: 0.5559 - val_loss: 11.4837 - val_accuracy10: 0.6095 - val_accuracy20: 0.5862 - val_accuracy30: 0.5581 - val_accuracy50: 0.5044 - 45s/epoch - 28ms/step
Epoch 21/50
1586/1586 - 44s - loss: 10.3660 - accuracy10: 0.5958 - accuracy20: 0.5972 - accuracy30: 0.5855 - accuracy50: 0.5573 - val_loss: 11.5529 - val_accuracy10: 0.6142 - val_accuracy20: 0.5860 - val_accuracy30: 0.5559 - val_accuracy50: 0.4997 - 44s/epoch - 28ms/step
Epoch 22/50
1586/1586 - 44s - loss: 10.3468 - accuracy10: 0.5958 - accuracy20: 0.5984 - accuracy30: 0.5870 - accuracy50: 0.5587 - val_loss: 11.5512 - val_accuracy10: 0.6135 - val_accuracy20: 0.5867 - val_accuracy30: 0.5581 - val_accuracy50: 0.5025 - 44s/epoch - 28ms/step
Epoch 23/50
1586/1586 - 44s - loss: 10.3262 - accuracy10: 0.5964 - accuracy20: 0.5996 - accuracy30: 0.5885 - accuracy50: 0.5608 - val_loss: 11.5626 - val_accuracy10: 0.6141 - val_accuracy20: 0.5867 - val_accuracy30: 0.5569 - val_accuracy50: 0.5019 - 44s/epoch - 28ms/step
Epoch 24/50
1586/1586 - 45s - loss: 10.3031 - accuracy10: 0.5970 - accuracy20: 0.6003 - accuracy30: 0.5894 - accuracy50: 0.5619 - val_loss: 11.5267 - val_accuracy10: 0.6175 - val_accuracy20: 0.5895 - val_accuracy30: 0.5594 - val_accuracy50: 0.5035 - 45s/epoch - 28ms/step
Epoch 25/50
1586/1586 - 44s - loss: 10.2808 - accuracy10: 0.5980 - accuracy20: 0.6014 - accuracy30: 0.5901 - accuracy50: 0.5630 - val_loss: 11.7231 - val_accuracy10: 0.6097 - val_accuracy20: 0.5832 - val_accuracy30: 0.5544 - val_accuracy50: 0.5004 - 44s/epoch - 28ms/step
Epoch 26/50
1586/1586 - 44s - loss: 10.2568 - accuracy10: 0.5986 - accuracy20: 0.6024 - accuracy30: 0.5917 - accuracy50: 0.5651 - val_loss: 11.4876 - val_accuracy10: 0.6001 - val_accuracy20: 0.5793 - val_accuracy30: 0.5538 - val_accuracy50: 0.5057 - 44s/epoch - 28ms/step
Epoch 27/50
1586/1586 - 44s - loss: 10.2415 - accuracy10: 0.5990 - accuracy20: 0.6036 - accuracy30: 0.5928 - accuracy50: 0.5664 - val_loss: 11.6890 - val_accuracy10: 0.6051 - val_accuracy20: 0.5814 - val_accuracy30: 0.5542 - val_accuracy50: 0.5026 - 44s/epoch - 28ms/step
testing model: results/ATVI/W10/deepOF_L2/seq2seq
Evaluating performance on  test set...
7633/7633 - 73s - 73s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.88152105
{'0': {'precision': 0.4651127547683489, 'recall': 0.4111286585165235, 'f1-score': 0.4364577615887431, 'support': 425514}, '1': {'precision': 0.7419937535423677, 'recall': 0.6785440501929172, 'f1-score': 0.7088518804956848, 'support': 1103582}, '2': {'precision': 0.4194901915958111, 'recall': 0.5614222134355723, 'f1-score': 0.4801878550464404, 'support': 424887}, 'accuracy': 0.5948419203237695, 'macro avg': {'precision': 0.5421988999688426, 'recall': 0.5503649740483376, 'f1-score': 0.5418324990436229, 'support': 1953983}, 'weighted avg': {'precision': 0.6115707599763467, 'recall': 0.5948419203237695, 'f1-score': 0.5998110736444371, 'support': 1953983}}
[[174941 134773 115800]
 [140449 748829 214304]
 [ 60736 125610 238541]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9369981
{'0': {'precision': 0.5098612009878369, 'recall': 0.3713830573169981, 'f1-score': 0.42974194690226086, 'support': 519776}, '1': {'precision': 0.6428303643894239, 'recall': 0.706947331947332, 'f1-score': 0.6733660101706918, 'support': 911976}, '2': {'precision': 0.4677747886241353, 'recall': 0.5127481899772323, 'f1-score': 0.489230097444803, 'support': 522231}, 'accuracy': 0.5657817903226384, 'macro avg': {'precision': 0.5401554513337987, 'recall': 0.5303595264138541, 'f1-score': 0.5307793515059185, 'support': 1953983}, 'weighted avg': {'precision': 0.5606732380153943, 'recall': 0.5657817903226384, 'f1-score': 0.5593468897647489, 'support': 1953983}}
[[193036 184263 142477]
 [105067 644719 162190]
 [ 80502 173956 267773]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9802833
{'0': {'precision': 0.5237404531836787, 'recall': 0.34110255370895826, 'f1-score': 0.4131367303379669, 'support': 582212}, '1': {'precision': 0.5663287282241082, 'recall': 0.7212610983563258, 'f1-score': 0.634473606605721, 'support': 787504}, '2': {'precision': 0.4844986928504603, 'recall': 0.4742061420549167, 'f1-score': 0.47929716759995916, 'support': 584267}, 'accuracy': 0.5341157011089657, 'macro avg': {'precision': 0.5248559580860824, 'recall': 0.5121899313734002, 'f1-score': 0.5089691681812157, 'support': 1953983}, 'weighted avg': {'precision': 0.5291707825994566, 'recall': 0.5341157011089657, 'f1-score': 0.5221238789498606, 'support': 1953983}}
[[198594 222179 161439]
 [ 86155 567996 133353]
 [ 94435 212769 277063]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0484521
{'0': {'precision': 0.5301693026218024, 'recall': 0.301773279963749, 'f1-score': 0.3846201234009376, 'support': 662050}, '1': {'precision': 0.4549431407478799, 'recall': 0.7345691216612669, 'f1-score': 0.5618894295854524, 'support': 627184}, '2': {'precision': 0.49270550802792723, 'recall': 0.4183774627716627, 'f1-score': 0.4525095670736469, 'support': 664749}, 'accuracy': 0.4803598598350139, 'macro avg': {'precision': 0.4926059837992032, 'recall': 0.4849066214655595, 'f1-score': 0.466339706686679, 'support': 1953983}, 'weighted avg': {'precision': 0.4932781602212707, 'recall': 0.4803598598350139, 'f1-score': 0.46461565679197453, 'support': 1953983}}
[[199789 276932 185329]
 [ 65452 460710 101022]
 [111599 275034 278116]]
Evaluating performance on  train set...
1586/1586 - 16s - 16s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.84059125
{'0': {'precision': 0.47045281115407994, 'recall': 0.4360763439313288, 'f1-score': 0.4526127830074224, 'support': 83412}, '1': {'precision': 0.7616810797853706, 'recall': 0.6924872594380742, 'f1-score': 0.7254379417833781, 'support': 238608}, '2': {'precision': 0.4202686837364784, 'recall': 0.5595275026846438, 'f1-score': 0.4800016377417588, 'support': 83810}, 'accuracy': 0.6123278219944311, 'macro avg': {'precision': 0.5508008582253097, 'recall': 0.562697035351349, 'f1-score': 0.5526841208441865, 'support': 405830}, 'weighted avg': {'precision': 0.6313168749312916, 'recall': 0.6123278219944311, 'f1-score': 0.618676714704187, 'support': 405830}}
[[ 36374  25706  21332]
 [ 30020 165233  43355]
 [ 10923  25993  46894]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8897454
{'0': {'precision': 0.5289338672739602, 'recall': 0.3983465659446543, 'f1-score': 0.45444502459534475, 'support': 103784}, '1': {'precision': 0.6629682802968001, 'recall': 0.7253198595007294, 'f1-score': 0.6927438852693006, 'support': 196727}, '2': {'precision': 0.4810476698683742, 'recall': 0.5135730494972417, 'f1-score': 0.4967785487626229, 'support': 105319}, 'accuracy': 0.5867506098612719, 'macro avg': {'precision': 0.5576499391463782, 'recall': 0.5457464916475417, 'f1-score': 0.547989152875756, 'support': 405830}, 'weighted avg': {'precision': 0.5814801589384141, 'recall': 0.5867506098612719, 'f1-score': 0.5809471175790544, 'support': 405830}}
[[ 41342  36089  26353]
 [ 22039 142690  31998]
 [ 14780  36450  54089]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.933775
{'0': {'precision': 0.5488057557614816, 'recall': 0.3700649717998389, 'f1-score': 0.4420508357437223, 'support': 116666}, '1': {'precision': 0.5859751087425783, 'recall': 0.7428906047694155, 'f1-score': 0.6551683868238639, 'support': 169916}, '2': {'precision': 0.5038301832760596, 'recall': 0.4721253186636254, 'f1-score': 0.48746276927339477, 'support': 119248}, 'accuracy': 0.556151590567479, 'macro avg': {'precision': 0.5462036825933732, 'recall': 0.52836029841096, 'f1-score': 0.5282273306136603, 'support': 405830}, 'weighted avg': {'precision': 0.5511526022572912, 'recall': 0.556151590567479, 'f1-score': 0.5446242385450917, 'support': 405830}}
[[ 43174  43937  29555]
 [ 17798 126229  25889]
 [ 17697  45251  56300]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0081427
{'0': {'precision': 0.5544997133940514, 'recall': 0.3272884478027142, 'f1-score': 0.4116211999432651, 'support': 133005}, '1': {'precision': 0.47343963595328314, 'recall': 0.7609844937805534, 'f1-score': 0.5837219364453632, 'support': 135623}, '2': {'precision': 0.5157183232568988, 'recall': 0.41095610851153774, 'f1-score': 0.4574154372842581, 'support': 137202}, 'accuracy': 0.5005100657910948, 'macro avg': {'precision': 0.5145525575347444, 'recall': 0.4997430166982684, 'f1-score': 0.4842528578909621, 'support': 405830}, 'weighted avg': {'precision': 0.5142993951022865, 'recall': 0.5005100657910948, 'f1-score': 0.4846169842329504, 'support': 405830}}
[[ 43531  55661  33813]
 [ 13282 103207  19134]
 [ 21692  59126  56384]]
Evaluating performance on  val set...
574/574 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8348545
{'0': {'precision': 0.43725590753086907, 'recall': 0.40368576319335686, 'f1-score': 0.4198007802143696, 'support': 27457}, '1': {'precision': 0.7781264116620069, 'recall': 0.6968129885748647, 'f1-score': 0.7352282952264495, 'support': 91465}, '2': {'precision': 0.3954415810595926, 'recall': 0.5604765141487497, 'f1-score': 0.463712780441603, 'support': 27953}, 'accuracy': 0.616068085106383, 'macro avg': {'precision': 0.5369413000841562, 'recall': 0.5536584219723237, 'f1-score': 0.5395806186274741, 'support': 146875}, 'weighted avg': {'precision': 0.6415717188840805, 'recall': 0.616068085106383, 'f1-score': 0.6245875022768835, 'support': 146875}}
[[11084  9313  7060]
 [10839 63734 16892]
 [ 3426  8860 15667]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8879626
{'0': {'precision': 0.49031731217918806, 'recall': 0.3648015276009721, 'f1-score': 0.41834771068347715, 'support': 34564}, '1': {'precision': 0.6855905937915089, 'recall': 0.7241737684473083, 'f1-score': 0.7043541987819363, 'support': 76976}, '2': {'precision': 0.4587337833429525, 'recall': 0.517362388566577, 'f1-score': 0.486287340728327, 'support': 35335}, 'accuracy': 0.5898485106382979, 'macro avg': {'precision': 0.5448805631045498, 'recall': 0.5354458948716191, 'f1-score': 0.5363297500645802, 'support': 146875}, 'weighted avg': {'precision': 0.5850601352189269, 'recall': 0.5898485106382979, 'f1-score': 0.5845862281677444, 'support': 146875}}
[[12609 13207  8748]
 [ 8410 55744 12822]
 [ 4697 12357 18281]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9333742
{'0': {'precision': 0.5098024170343373, 'recall': 0.33981178396072015, 'f1-score': 0.4078012551980236, 'support': 39104}, '1': {'precision': 0.6128088865951512, 'recall': 0.739783127883346, 'f1-score': 0.670336169469199, 'support': 67413}, '2': {'precision': 0.4892591747191154, 'recall': 0.477996927498885, 'f1-score': 0.48356248511662303, 'support': 40358}, 'accuracy': 0.5613617021276596, 'macro avg': {'precision': 0.5372901594495346, 'recall': 0.5191972797809837, 'f1-score': 0.5205666365946152, 'support': 146875}, 'weighted avg': {'precision': 0.5514357171817104, 'recall': 0.5613617021276596, 'f1-score': 0.5491175982980583, 'support': 146875}}
[[13288 16191  9625]
 [ 7029 49871 10513]
 [ 5748 15319 19291]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0115304
{'0': {'precision': 0.5118269708433643, 'recall': 0.2980219389003849, 'f1-score': 0.3767015412307346, 'support': 44943}, '1': {'precision': 0.5014255729590041, 'recall': 0.7535188156359394, 'f1-score': 0.6021519476072877, 'support': 54848}, '2': {'precision': 0.5056813729331557, 'recall': 0.4111587800526718, 'f1-score': 0.45354762378905195, 'support': 47084}, 'accuracy': 0.504388085106383, 'macro avg': {'precision': 0.5063113055785081, 'recall': 0.4875665115296653, 'f1-score': 0.47746703754235814, 'support': 146875}, 'weighted avg': {'precision': 0.5059726375452152, 'recall': 0.504388085106383, 'f1-score': 0.48552690184429725, 'support': 146875}}
[[13394 20565 10984]
 [ 5579 41329  7940]
 [ 7196 20529 19359]]
training model: results/ATVI/W10/deepVOL_L2/seq2seq
Epoch 1/50
1586/1586 - 51s - loss: 11.8774 - accuracy10: 0.4838 - accuracy20: 0.4945 - accuracy30: 0.4921 - accuracy50: 0.4796 - val_loss: 11.9111 - val_accuracy10: 0.5958 - val_accuracy20: 0.5703 - val_accuracy30: 0.5405 - val_accuracy50: 0.4843 - 51s/epoch - 32ms/step
Epoch 2/50
1586/1586 - 43s - loss: 11.3931 - accuracy10: 0.5270 - accuracy20: 0.5345 - accuracy30: 0.5282 - accuracy50: 0.5062 - val_loss: 11.8696 - val_accuracy10: 0.6090 - val_accuracy20: 0.5844 - val_accuracy30: 0.5559 - val_accuracy50: 0.5010 - 43s/epoch - 27ms/step
Epoch 3/50
1586/1586 - 42s - loss: 11.1665 - accuracy10: 0.5524 - accuracy20: 0.5525 - accuracy30: 0.5424 - accuracy50: 0.5170 - val_loss: 11.9059 - val_accuracy10: 0.6173 - val_accuracy20: 0.5876 - val_accuracy30: 0.5564 - val_accuracy50: 0.4999 - 42s/epoch - 27ms/step
Epoch 4/50
1586/1586 - 42s - loss: 11.0428 - accuracy10: 0.5631 - accuracy20: 0.5620 - accuracy30: 0.5497 - accuracy50: 0.5216 - val_loss: 11.9129 - val_accuracy10: 0.6269 - val_accuracy20: 0.5939 - val_accuracy30: 0.5607 - val_accuracy50: 0.5005 - 42s/epoch - 27ms/step
Epoch 5/50
1586/1586 - 42s - loss: 10.9616 - accuracy10: 0.5687 - accuracy20: 0.5672 - accuracy30: 0.5544 - accuracy50: 0.5249 - val_loss: 11.9487 - val_accuracy10: 0.6220 - val_accuracy20: 0.5909 - val_accuracy30: 0.5591 - val_accuracy50: 0.5009 - 42s/epoch - 27ms/step
Epoch 6/50
1586/1586 - 43s - loss: 10.9000 - accuracy10: 0.5718 - accuracy20: 0.5703 - accuracy30: 0.5575 - accuracy50: 0.5273 - val_loss: 12.0639 - val_accuracy10: 0.6209 - val_accuracy20: 0.5914 - val_accuracy30: 0.5590 - val_accuracy50: 0.5014 - 43s/epoch - 27ms/step
Epoch 7/50
1586/1586 - 43s - loss: 10.8483 - accuracy10: 0.5737 - accuracy20: 0.5725 - accuracy30: 0.5598 - accuracy50: 0.5300 - val_loss: 12.1077 - val_accuracy10: 0.6118 - val_accuracy20: 0.5856 - val_accuracy30: 0.5558 - val_accuracy50: 0.4996 - 43s/epoch - 27ms/step
Epoch 8/50
1586/1586 - 42s - loss: 10.8099 - accuracy10: 0.5765 - accuracy20: 0.5754 - accuracy30: 0.5622 - accuracy50: 0.5319 - val_loss: 11.9306 - val_accuracy10: 0.6238 - val_accuracy20: 0.5939 - val_accuracy30: 0.5610 - val_accuracy50: 0.5014 - 42s/epoch - 27ms/step
Epoch 9/50
1586/1586 - 43s - loss: 10.7784 - accuracy10: 0.5779 - accuracy20: 0.5767 - accuracy30: 0.5639 - accuracy50: 0.5331 - val_loss: 11.8164 - val_accuracy10: 0.6266 - val_accuracy20: 0.5970 - val_accuracy30: 0.5639 - val_accuracy50: 0.5035 - 43s/epoch - 27ms/step
Epoch 10/50
1586/1586 - 44s - loss: 10.7451 - accuracy10: 0.5796 - accuracy20: 0.5791 - accuracy30: 0.5660 - accuracy50: 0.5348 - val_loss: 11.7713 - val_accuracy10: 0.6244 - val_accuracy20: 0.5954 - val_accuracy30: 0.5628 - val_accuracy50: 0.5025 - 44s/epoch - 27ms/step
Epoch 11/50
1586/1586 - 42s - loss: 10.7176 - accuracy10: 0.5804 - accuracy20: 0.5797 - accuracy30: 0.5665 - accuracy50: 0.5351 - val_loss: 11.7122 - val_accuracy10: 0.6197 - val_accuracy20: 0.5952 - val_accuracy30: 0.5640 - val_accuracy50: 0.5054 - 42s/epoch - 27ms/step
Epoch 12/50
1586/1586 - 43s - loss: 10.6951 - accuracy10: 0.5818 - accuracy20: 0.5806 - accuracy30: 0.5677 - accuracy50: 0.5361 - val_loss: 11.6106 - val_accuracy10: 0.6231 - val_accuracy20: 0.5959 - val_accuracy30: 0.5632 - val_accuracy50: 0.5022 - 43s/epoch - 27ms/step
Epoch 13/50
1586/1586 - 43s - loss: 10.6725 - accuracy10: 0.5825 - accuracy20: 0.5819 - accuracy30: 0.5689 - accuracy50: 0.5375 - val_loss: 11.5295 - val_accuracy10: 0.6212 - val_accuracy20: 0.5964 - val_accuracy30: 0.5644 - val_accuracy50: 0.5049 - 43s/epoch - 27ms/step
Epoch 14/50
1586/1586 - 42s - loss: 10.6462 - accuracy10: 0.5834 - accuracy20: 0.5828 - accuracy30: 0.5701 - accuracy50: 0.5392 - val_loss: 11.4191 - val_accuracy10: 0.6299 - val_accuracy20: 0.6014 - val_accuracy30: 0.5674 - val_accuracy50: 0.5055 - 42s/epoch - 27ms/step
Epoch 15/50
1586/1586 - 42s - loss: 10.6292 - accuracy10: 0.5840 - accuracy20: 0.5836 - accuracy30: 0.5718 - accuracy50: 0.5407 - val_loss: 11.3207 - val_accuracy10: 0.6289 - val_accuracy20: 0.6039 - val_accuracy30: 0.5720 - val_accuracy50: 0.5111 - 42s/epoch - 27ms/step
Epoch 16/50
1586/1586 - 43s - loss: 10.6087 - accuracy10: 0.5848 - accuracy20: 0.5850 - accuracy30: 0.5723 - accuracy50: 0.5410 - val_loss: 11.3044 - val_accuracy10: 0.6313 - val_accuracy20: 0.6045 - val_accuracy30: 0.5714 - val_accuracy50: 0.5090 - 43s/epoch - 27ms/step
Epoch 17/50
1586/1586 - 43s - loss: 10.5893 - accuracy10: 0.5866 - accuracy20: 0.5856 - accuracy30: 0.5732 - accuracy50: 0.5418 - val_loss: 11.2542 - val_accuracy10: 0.6278 - val_accuracy20: 0.6036 - val_accuracy30: 0.5716 - val_accuracy50: 0.5110 - 43s/epoch - 27ms/step
Epoch 18/50
1586/1586 - 43s - loss: 10.5733 - accuracy10: 0.5872 - accuracy20: 0.5871 - accuracy30: 0.5742 - accuracy50: 0.5430 - val_loss: 11.3554 - val_accuracy10: 0.6276 - val_accuracy20: 0.6025 - val_accuracy30: 0.5707 - val_accuracy50: 0.5085 - 43s/epoch - 27ms/step
Epoch 19/50
1586/1586 - 43s - loss: 10.5564 - accuracy10: 0.5879 - accuracy20: 0.5874 - accuracy30: 0.5751 - accuracy50: 0.5438 - val_loss: 11.2378 - val_accuracy10: 0.6313 - val_accuracy20: 0.6056 - val_accuracy30: 0.5728 - val_accuracy50: 0.5102 - 43s/epoch - 27ms/step
Epoch 20/50
1586/1586 - 43s - loss: 10.5384 - accuracy10: 0.5875 - accuracy20: 0.5879 - accuracy30: 0.5758 - accuracy50: 0.5451 - val_loss: 11.1266 - val_accuracy10: 0.6323 - val_accuracy20: 0.6069 - val_accuracy30: 0.5741 - val_accuracy50: 0.5107 - 43s/epoch - 27ms/step
Epoch 21/50
1586/1586 - 43s - loss: 10.5196 - accuracy10: 0.5888 - accuracy20: 0.5890 - accuracy30: 0.5768 - accuracy50: 0.5454 - val_loss: 11.2520 - val_accuracy10: 0.6334 - val_accuracy20: 0.6077 - val_accuracy30: 0.5730 - val_accuracy50: 0.5095 - 43s/epoch - 27ms/step
Epoch 22/50
1586/1586 - 43s - loss: 10.5068 - accuracy10: 0.5891 - accuracy20: 0.5897 - accuracy30: 0.5773 - accuracy50: 0.5463 - val_loss: 11.2340 - val_accuracy10: 0.6275 - val_accuracy20: 0.6030 - val_accuracy30: 0.5713 - val_accuracy50: 0.5093 - 43s/epoch - 27ms/step
Epoch 23/50
1586/1586 - 42s - loss: 10.4923 - accuracy10: 0.5895 - accuracy20: 0.5901 - accuracy30: 0.5782 - accuracy50: 0.5469 - val_loss: 11.2359 - val_accuracy10: 0.6276 - val_accuracy20: 0.6037 - val_accuracy30: 0.5715 - val_accuracy50: 0.5104 - 42s/epoch - 27ms/step
Epoch 24/50
1586/1586 - 43s - loss: 10.4731 - accuracy10: 0.5906 - accuracy20: 0.5915 - accuracy30: 0.5791 - accuracy50: 0.5485 - val_loss: 11.2374 - val_accuracy10: 0.6287 - val_accuracy20: 0.6047 - val_accuracy30: 0.5729 - val_accuracy50: 0.5100 - 43s/epoch - 27ms/step
Epoch 25/50
1586/1586 - 43s - loss: 10.4614 - accuracy10: 0.5906 - accuracy20: 0.5914 - accuracy30: 0.5801 - accuracy50: 0.5494 - val_loss: 11.1841 - val_accuracy10: 0.6237 - val_accuracy20: 0.6022 - val_accuracy30: 0.5727 - val_accuracy50: 0.5123 - 43s/epoch - 27ms/step
Epoch 26/50
1586/1586 - 42s - loss: 10.4450 - accuracy10: 0.5912 - accuracy20: 0.5925 - accuracy30: 0.5808 - accuracy50: 0.5502 - val_loss: 11.1471 - val_accuracy10: 0.6312 - val_accuracy20: 0.6075 - val_accuracy30: 0.5744 - val_accuracy50: 0.5122 - 42s/epoch - 27ms/step
Epoch 27/50
1586/1586 - 43s - loss: 10.4305 - accuracy10: 0.5919 - accuracy20: 0.5934 - accuracy30: 0.5822 - accuracy50: 0.5513 - val_loss: 11.1932 - val_accuracy10: 0.6275 - val_accuracy20: 0.6043 - val_accuracy30: 0.5731 - val_accuracy50: 0.5119 - 43s/epoch - 27ms/step
Epoch 28/50
1586/1586 - 43s - loss: 10.4214 - accuracy10: 0.5925 - accuracy20: 0.5934 - accuracy30: 0.5819 - accuracy50: 0.5509 - val_loss: 11.2155 - val_accuracy10: 0.6272 - val_accuracy20: 0.6046 - val_accuracy30: 0.5732 - val_accuracy50: 0.5120 - 43s/epoch - 27ms/step
Epoch 29/50
1586/1586 - 43s - loss: 10.3991 - accuracy10: 0.5924 - accuracy20: 0.5938 - accuracy30: 0.5823 - accuracy50: 0.5522 - val_loss: 11.2030 - val_accuracy10: 0.6267 - val_accuracy20: 0.6043 - val_accuracy30: 0.5722 - val_accuracy50: 0.5106 - 43s/epoch - 27ms/step
Epoch 30/50
1586/1586 - 43s - loss: 10.3891 - accuracy10: 0.5933 - accuracy20: 0.5955 - accuracy30: 0.5840 - accuracy50: 0.5538 - val_loss: 11.2815 - val_accuracy10: 0.6267 - val_accuracy20: 0.6032 - val_accuracy30: 0.5707 - val_accuracy50: 0.5087 - 43s/epoch - 27ms/step
testing model: results/ATVI/W10/deepVOL_L2/seq2seq
Evaluating performance on  test set...
7633/7633 - 67s - 67s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.86695397
{'0': {'precision': 0.48937805768628895, 'recall': 0.41891256733001814, 'f1-score': 0.4514119443579205, 'support': 425516}, '1': {'precision': 0.7383828708138399, 'recall': 0.7229352028800734, 'f1-score': 0.7305773878039155, 'support': 1103583}, '2': {'precision': 0.4372357618208846, 'recall': 0.5240451035446905, 'f1-score': 0.47672073445408375, 'support': 424889}, 'accuracy': 0.6134807378550943, 'macro avg': {'precision': 0.5549988967736711, 'recall': 0.5552976245849274, 'f1-score': 0.5529033555386399, 'support': 1953988}, 'weighted avg': {'precision': 0.6186740363400914, 'recall': 0.6134807378550943, 'f1-score': 0.6145837059499211, 'support': 1953988}}
[[178254 139038 108224]
 [127402 797819 178362]
 [ 58590 143638 222661]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9238935
{'0': {'precision': 0.5375762412358206, 'recall': 0.362873451986325, 'f1-score': 0.4332771676894787, 'support': 519779}, '1': {'precision': 0.6350145904011767, 'recall': 0.7630992886882015, 'f1-score': 0.6931898602671543, 'support': 911977}, '2': {'precision': 0.4840635486453129, 'recall': 0.47013204859143065, 'f1-score': 0.47699609688430733, 'support': 522232}, 'accuracy': 0.5783356909049595, 'macro avg': {'precision': 0.5522181267607701, 'recall': 0.5320349297553191, 'f1-score': 0.5344877082803134, 'support': 1953988}, 'weighted avg': {'precision': 0.5687511987482761, 'recall': 0.5783356909049595, 'f1-score': 0.5662697047317659, 'support': 1953988}}
[[188614 195508 135657]
 [ 90021 695929 126027]
 [ 72225 204489 245518]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9702218
{'0': {'precision': 0.5566652418172936, 'recall': 0.3131472050702919, 'f1-score': 0.40081782057412324, 'support': 582215}, '1': {'precision': 0.5544311380448329, 'recall': 0.7897626046818751, 'f1-score': 0.6514968278468589, 'support': 787505}, '2': {'precision': 0.4977570923039734, 'recall': 0.42997220453627444, 'f1-score': 0.46138828434208473, 'support': 584268}, 'accuracy': 0.5401670839329618, 'macro avg': {'precision': 0.5362844907220333, 'recall': 0.5109606714294804, 'f1-score': 0.5045676442543556, 'support': 1953988}, 'weighted avg': {'precision': 0.5381505351808249, 'recall': 0.5401670839329618, 'f1-score': 0.5199589592848497, 'support': 1953988}}
[[182319 244343 155553]
 [ 67633 621942  97930]
 [ 77568 255481 251219]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0405619
{'0': {'precision': 0.5651244627477353, 'recall': 0.25639526804541035, 'f1-score': 0.35274925890175113, 'support': 662052}, '1': {'precision': 0.44176671110527804, 'recall': 0.8157608998939707, 'f1-score': 0.5731500551436507, 'support': 627185}, '2': {'precision': 0.5036884542803225, 'recall': 0.3754187658235941, 'f1-score': 0.4301957566522096, 'support': 664751}, 'accuracy': 0.4764307662073667, 'macro avg': {'precision': 0.503526542711112, 'recall': 0.48252497792099175, 'f1-score': 0.45203169023253714, 'support': 1953988}, 'weighted avg': {'precision': 0.5046288099962365, 'recall': 0.4764307662073667, 'f1-score': 0.44984029027814176, 'support': 1953988}}
[[169747 315125 177180]
 [ 46827 511633  68725]
 [ 83797 331394 249560]]
Evaluating performance on  train set...
1586/1586 - 15s - 15s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8459948
{'0': {'precision': 0.483288015596142, 'recall': 0.4524670084895352, 'f1-score': 0.4673699355646927, 'support': 83279}, '1': {'precision': 0.7648354724101971, 'recall': 0.7099289739990362, 'f1-score': 0.7363601197849433, 'support': 238645}, '2': {'precision': 0.43029083489266473, 'recall': 0.5453841203251257, 'f1-score': 0.4810491182886127, 'support': 83906}, 'accuracy': 0.6230761648966316, 'macro avg': {'precision': 0.5594714409663345, 'recall': 0.5692600342712324, 'f1-score': 0.5615930578794163, 'support': 405830}, 'weighted avg': {'precision': 0.6378924346565471, 'recall': 0.6230761648966316, 'f1-score': 0.6283755980807091, 'support': 405830}}
[[ 37681  24825  20773]
 [ 29409 169421  39815]
 [ 10878  27267  45761]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8900373
{'0': {'precision': 0.5435922496797115, 'recall': 0.3974793568013907, 'f1-score': 0.45919289515670153, 'support': 103545}, '1': {'precision': 0.6626859417557092, 'recall': 0.7548159431327748, 'f1-score': 0.7057569650660722, 'support': 196950}, '2': {'precision': 0.4893653224434235, 'recall': 0.49146057815540894, 'f1-score': 0.4904107123403167, 'support': 105335}, 'accuracy': 0.5952886676687282, 'macro avg': {'precision': 0.5652145046262814, 'recall': 0.5479186260298582, 'f1-score': 0.5517868575210302, 'support': 405830}, 'weighted avg': {'precision': 0.5873137815377145, 'recall': 0.5952886676687282, 'f1-score': 0.5869535888996152, 'support': 405830}}
[[ 41157  35895  26493]
 [ 20764 148661  27525]
 [ 13792  39775  51768]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.933099
{'0': {'precision': 0.5671779269535121, 'recall': 0.34872146902351125, 'f1-score': 0.4318970418665944, 'support': 116540}, '1': {'precision': 0.581665996819683, 'recall': 0.7832097080639754, 'f1-score': 0.667557425089807, 'support': 170003}, '2': {'precision': 0.5102261824468742, 'recall': 0.4502670031101461, 'f1-score': 0.4783751046509557, 'support': 119287}, 'accuracy': 0.5605770889288618, 'macro avg': {'precision': 0.5530233687400231, 'recall': 0.5273993933992109, 'f1-score': 0.5259431905357856, 'support': 405830}, 'weighted avg': {'precision': 0.5565069873839764, 'recall': 0.5605770889288618, 'f1-score': 0.5442771044653523, 'support': 405830}}
[[ 40640  45443  30457]
 [ 15754 133148  21101]
 [ 15259  50317  53711]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0048361
{'0': {'precision': 0.5738949448969813, 'recall': 0.2884874487222912, 'f1-score': 0.3839630533112268, 'support': 132855}, '1': {'precision': 0.46541235363991174, 'recall': 0.8079344856282266, 'f1-score': 0.5906052914211576, 'support': 135787}, '2': {'precision': 0.518223873952345, 'recall': 0.39031110592763213, 'f1-score': 0.4452630616097192, 'support': 137188}, 'accuracy': 0.4967104452603307, 'macro avg': {'precision': 0.5191770574964126, 'recall': 0.4955776800927166, 'f1-score': 0.4732771354473679, 'support': 405830}, 'weighted avg': {'precision': 0.5187784466100719, 'recall': 0.4967104452603307, 'f1-score': 0.4738256931473324, 'support': 405830}}
[[ 38327  59764  34764]
 [ 11064 109707  15016]
 [ 17393  66249  53546]]
Evaluating performance on  val set...
574/574 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8292841
{'0': {'precision': 0.46413433980543334, 'recall': 0.41957378484892716, 'f1-score': 0.440730590106752, 'support': 27404}, '1': {'precision': 0.7902027512821742, 'recall': 0.7205655779800474, 'f1-score': 0.7537792408941012, 'support': 91517}, '2': {'precision': 0.4047347994825356, 'recall': 0.5595979108535452, 'f1-score': 0.4697315476547955, 'support': 27954}, 'accuracy': 0.6337702127659575, 'macro avg': {'precision': 0.553023963523381, 'recall': 0.5665790912275065, 'f1-score': 0.5547471262185496, 'support': 146875}, 'weighted avg': {'precision': 0.6560005393828332, 'recall': 0.6337702127659575, 'f1-score': 0.6413090829843952, 'support': 146875}}
[[11498  8626  7280]
 [ 9846 65944 15727]
 [ 3429  8882 15643]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.87242895
{'0': {'precision': 0.5229028351914485, 'recall': 0.3627646939544046, 'f1-score': 0.4283564220968018, 'support': 34521}, '1': {'precision': 0.695600165808018, 'recall': 0.7626869935591107, 'f1-score': 0.7276004534108013, 'support': 77008}, '2': {'precision': 0.46813540827725963, 'recall': 0.5097889435862615, 'f1-score': 0.4880750843073256, 'support': 35346}, 'accuracy': 0.6078297872340426, 'macro avg': {'precision': 0.5622128030922421, 'recall': 0.5450802103665923, 'f1-score': 0.5480106532716429, 'support': 146875}, 'weighted avg': {'precision': 0.6002697564810612, 'recall': 0.6078297872340426, 'f1-score': 0.5996245085507363, 'support': 146875}}
[[12523 12653  9345]
 [ 7148 58733 11127]
 [ 4278 13049 18019]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9157351
{'0': {'precision': 0.5483627651078179, 'recall': 0.31592535787321063, 'f1-score': 0.4008887735573648, 'support': 39120}, '1': {'precision': 0.6184231940666342, 'recall': 0.7890653969949124, 'f1-score': 0.6934000690819273, 'support': 67419}, '2': {'precision': 0.4950802557745008, 'recall': 0.4702746925823086, 'f1-score': 0.4823587748407522, 'support': 40336}, 'accuracy': 0.575496170212766, 'macro avg': {'precision': 0.5539554049829843, 'recall': 0.5250884824834773, 'f1-score': 0.5255492058266814, 'support': 146875}, 'weighted avg': {'precision': 0.5658892383912614, 'recall': 0.575496170212766, 'f1-score': 0.5575321301853627, 'support': 146875}}
[[12359 16101 10660]
 [ 5535 53198  8686]
 [ 4644 16723 18969]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9910917
{'0': {'precision': 0.5529777565175795, 'recall': 0.25713459527993415, 'f1-score': 0.35103701679268773, 'support': 44957}, '1': {'precision': 0.5037646765774844, 'recall': 0.8112498860424834, 'f1-score': 0.6215581911906458, 'support': 54845}, '2': {'precision': 0.5089643815240776, 'recall': 0.4070698702016018, 'f1-score': 0.4523500389509218, 'support': 47073}, 'accuracy': 0.5121021276595744, 'macro avg': {'precision': 0.5219022715397138, 'recall': 0.4918181171746731, 'f1-score': 0.47498174897808515, 'support': 146875}, 'weighted avg': {'precision': 0.5204948086341165, 'recall': 0.5121021276595744, 'f1-score': 0.4845235985929298, 'support': 146875}}
[[11560 21229 12168]
 [ 4033 44493  6319]
 [ 5312 22599 19162]]
training model: results/ATVI/W10/deepVOL_L3/seq2seq
Epoch 1/50
1586/1586 - 74s - loss: 12.4344 - accuracy10: 0.4421 - accuracy20: 0.4504 - accuracy30: 0.4510 - accuracy50: 0.4444 - val_loss: 12.3317 - val_accuracy10: 0.4955 - val_accuracy20: 0.4956 - val_accuracy30: 0.4854 - val_accuracy50: 0.4550 - 74s/epoch - 47ms/step
Epoch 2/50
1586/1586 - 64s - loss: 11.6021 - accuracy10: 0.4974 - accuracy20: 0.5129 - accuracy30: 0.5126 - accuracy50: 0.4972 - val_loss: 11.8013 - val_accuracy10: 0.5652 - val_accuracy20: 0.5535 - val_accuracy30: 0.5371 - val_accuracy50: 0.4967 - 64s/epoch - 40ms/step
Epoch 3/50
1586/1586 - 65s - loss: 11.2235 - accuracy10: 0.5380 - accuracy20: 0.5441 - accuracy30: 0.5364 - accuracy50: 0.5144 - val_loss: 11.6499 - val_accuracy10: 0.6111 - val_accuracy20: 0.5855 - val_accuracy30: 0.5578 - val_accuracy50: 0.5021 - 65s/epoch - 41ms/step
Epoch 4/50
1586/1586 - 65s - loss: 11.0538 - accuracy10: 0.5557 - accuracy20: 0.5579 - accuracy30: 0.5480 - accuracy50: 0.5212 - val_loss: 11.5121 - val_accuracy10: 0.5752 - val_accuracy20: 0.5701 - val_accuracy30: 0.5552 - val_accuracy50: 0.5142 - 65s/epoch - 41ms/step
Epoch 5/50
1586/1586 - 64s - loss: 10.9593 - accuracy10: 0.5639 - accuracy20: 0.5646 - accuracy30: 0.5525 - accuracy50: 0.5243 - val_loss: 11.3653 - val_accuracy10: 0.5969 - val_accuracy20: 0.5835 - val_accuracy30: 0.5607 - val_accuracy50: 0.5122 - 64s/epoch - 40ms/step
Epoch 6/50
1586/1586 - 64s - loss: 10.9008 - accuracy10: 0.5694 - accuracy20: 0.5699 - accuracy30: 0.5572 - accuracy50: 0.5283 - val_loss: 11.3637 - val_accuracy10: 0.5754 - val_accuracy20: 0.5695 - val_accuracy30: 0.5526 - val_accuracy50: 0.5113 - 64s/epoch - 41ms/step
Epoch 7/50
1586/1586 - 64s - loss: 10.8478 - accuracy10: 0.5715 - accuracy20: 0.5713 - accuracy30: 0.5587 - accuracy50: 0.5295 - val_loss: 11.3374 - val_accuracy10: 0.5707 - val_accuracy20: 0.5677 - val_accuracy30: 0.5529 - val_accuracy50: 0.5145 - 64s/epoch - 41ms/step
Epoch 8/50
1586/1586 - 65s - loss: 10.8028 - accuracy10: 0.5742 - accuracy20: 0.5738 - accuracy30: 0.5613 - accuracy50: 0.5318 - val_loss: 11.2993 - val_accuracy10: 0.5821 - val_accuracy20: 0.5767 - val_accuracy30: 0.5592 - val_accuracy50: 0.5154 - 65s/epoch - 41ms/step
Epoch 9/50
1586/1586 - 66s - loss: 10.7687 - accuracy10: 0.5761 - accuracy20: 0.5759 - accuracy30: 0.5634 - accuracy50: 0.5330 - val_loss: 11.1903 - val_accuracy10: 0.5750 - val_accuracy20: 0.5709 - val_accuracy30: 0.5554 - val_accuracy50: 0.5152 - 66s/epoch - 41ms/step
Epoch 10/50
1586/1586 - 65s - loss: 10.7353 - accuracy10: 0.5785 - accuracy20: 0.5779 - accuracy30: 0.5650 - accuracy50: 0.5343 - val_loss: 11.2187 - val_accuracy10: 0.5765 - val_accuracy20: 0.5723 - val_accuracy30: 0.5559 - val_accuracy50: 0.5164 - 65s/epoch - 41ms/step
Epoch 11/50
1586/1586 - 66s - loss: 10.7061 - accuracy10: 0.5806 - accuracy20: 0.5794 - accuracy30: 0.5667 - accuracy50: 0.5361 - val_loss: 11.1684 - val_accuracy10: 0.5759 - val_accuracy20: 0.5713 - val_accuracy30: 0.5560 - val_accuracy50: 0.5163 - 66s/epoch - 41ms/step
Epoch 12/50
1586/1586 - 66s - loss: 10.6751 - accuracy10: 0.5812 - accuracy20: 0.5807 - accuracy30: 0.5683 - accuracy50: 0.5377 - val_loss: 11.1447 - val_accuracy10: 0.5725 - val_accuracy20: 0.5683 - val_accuracy30: 0.5538 - val_accuracy50: 0.5165 - 66s/epoch - 41ms/step
Epoch 13/50
1586/1586 - 65s - loss: 10.6488 - accuracy10: 0.5835 - accuracy20: 0.5824 - accuracy30: 0.5698 - accuracy50: 0.5386 - val_loss: 11.1037 - val_accuracy10: 0.5856 - val_accuracy20: 0.5779 - val_accuracy30: 0.5584 - val_accuracy50: 0.5161 - 65s/epoch - 41ms/step
Epoch 14/50
1586/1586 - 65s - loss: 10.6261 - accuracy10: 0.5846 - accuracy20: 0.5840 - accuracy30: 0.5708 - accuracy50: 0.5400 - val_loss: 11.1384 - val_accuracy10: 0.5857 - val_accuracy20: 0.5771 - val_accuracy30: 0.5584 - val_accuracy50: 0.5150 - 65s/epoch - 41ms/step
Epoch 15/50
1586/1586 - 64s - loss: 10.6059 - accuracy10: 0.5851 - accuracy20: 0.5844 - accuracy30: 0.5715 - accuracy50: 0.5408 - val_loss: 11.0146 - val_accuracy10: 0.5789 - val_accuracy20: 0.5748 - val_accuracy30: 0.5582 - val_accuracy50: 0.5188 - 64s/epoch - 40ms/step
Epoch 16/50
1586/1586 - 66s - loss: 10.5851 - accuracy10: 0.5861 - accuracy20: 0.5856 - accuracy30: 0.5725 - accuracy50: 0.5413 - val_loss: 11.0291 - val_accuracy10: 0.5694 - val_accuracy20: 0.5682 - val_accuracy30: 0.5532 - val_accuracy50: 0.5161 - 66s/epoch - 41ms/step
Epoch 17/50
1586/1586 - 66s - loss: 10.5619 - accuracy10: 0.5874 - accuracy20: 0.5870 - accuracy30: 0.5740 - accuracy50: 0.5430 - val_loss: 11.0812 - val_accuracy10: 0.5808 - val_accuracy20: 0.5738 - val_accuracy30: 0.5543 - val_accuracy50: 0.5125 - 66s/epoch - 41ms/step
Epoch 18/50
1586/1586 - 65s - loss: 10.5444 - accuracy10: 0.5880 - accuracy20: 0.5875 - accuracy30: 0.5748 - accuracy50: 0.5436 - val_loss: 11.0592 - val_accuracy10: 0.5930 - val_accuracy20: 0.5823 - val_accuracy30: 0.5590 - val_accuracy50: 0.5132 - 65s/epoch - 41ms/step
Epoch 19/50
1586/1586 - 65s - loss: 10.5282 - accuracy10: 0.5887 - accuracy20: 0.5887 - accuracy30: 0.5761 - accuracy50: 0.5445 - val_loss: 10.9908 - val_accuracy10: 0.6012 - val_accuracy20: 0.5898 - val_accuracy30: 0.5666 - val_accuracy50: 0.5177 - 65s/epoch - 41ms/step
Epoch 20/50
1586/1586 - 65s - loss: 10.5120 - accuracy10: 0.5894 - accuracy20: 0.5894 - accuracy30: 0.5767 - accuracy50: 0.5457 - val_loss: 10.9758 - val_accuracy10: 0.5935 - val_accuracy20: 0.5856 - val_accuracy30: 0.5648 - val_accuracy50: 0.5188 - 65s/epoch - 41ms/step
Epoch 21/50
1586/1586 - 64s - loss: 10.4954 - accuracy10: 0.5902 - accuracy20: 0.5906 - accuracy30: 0.5776 - accuracy50: 0.5468 - val_loss: 10.8779 - val_accuracy10: 0.6005 - val_accuracy20: 0.5902 - val_accuracy30: 0.5679 - val_accuracy50: 0.5200 - 64s/epoch - 40ms/step
Epoch 22/50
1586/1586 - 66s - loss: 10.4798 - accuracy10: 0.5903 - accuracy20: 0.5913 - accuracy30: 0.5788 - accuracy50: 0.5486 - val_loss: 10.9253 - val_accuracy10: 0.6105 - val_accuracy20: 0.5955 - val_accuracy30: 0.5695 - val_accuracy50: 0.5180 - 66s/epoch - 42ms/step
Epoch 23/50
1586/1586 - 65s - loss: 10.4642 - accuracy10: 0.5910 - accuracy20: 0.5917 - accuracy30: 0.5795 - accuracy50: 0.5491 - val_loss: 10.9523 - val_accuracy10: 0.6075 - val_accuracy20: 0.5907 - val_accuracy30: 0.5648 - val_accuracy50: 0.5153 - 65s/epoch - 41ms/step
Epoch 24/50
1586/1586 - 65s - loss: 10.4492 - accuracy10: 0.5929 - accuracy20: 0.5931 - accuracy30: 0.5809 - accuracy50: 0.5498 - val_loss: 10.8767 - val_accuracy10: 0.6089 - val_accuracy20: 0.5946 - val_accuracy30: 0.5701 - val_accuracy50: 0.5194 - 65s/epoch - 41ms/step
Epoch 25/50
1586/1586 - 65s - loss: 10.4346 - accuracy10: 0.5932 - accuracy20: 0.5937 - accuracy30: 0.5808 - accuracy50: 0.5497 - val_loss: 10.9011 - val_accuracy10: 0.6057 - val_accuracy20: 0.5920 - val_accuracy30: 0.5679 - val_accuracy50: 0.5193 - 65s/epoch - 41ms/step
Epoch 26/50
1586/1586 - 65s - loss: 10.4158 - accuracy10: 0.5930 - accuracy20: 0.5942 - accuracy30: 0.5817 - accuracy50: 0.5513 - val_loss: 10.9591 - val_accuracy10: 0.6242 - val_accuracy20: 0.6010 - val_accuracy30: 0.5709 - val_accuracy50: 0.5150 - 65s/epoch - 41ms/step
Epoch 27/50
1586/1586 - 65s - loss: 10.3968 - accuracy10: 0.5946 - accuracy20: 0.5955 - accuracy30: 0.5838 - accuracy50: 0.5529 - val_loss: 10.9362 - val_accuracy10: 0.6186 - val_accuracy20: 0.5988 - val_accuracy30: 0.5704 - val_accuracy50: 0.5166 - 65s/epoch - 41ms/step
Epoch 28/50
1586/1586 - 65s - loss: 10.3823 - accuracy10: 0.5946 - accuracy20: 0.5959 - accuracy30: 0.5838 - accuracy50: 0.5530 - val_loss: 10.8825 - val_accuracy10: 0.6142 - val_accuracy20: 0.5969 - val_accuracy30: 0.5695 - val_accuracy50: 0.5186 - 65s/epoch - 41ms/step
Epoch 29/50
1586/1586 - 65s - loss: 10.3721 - accuracy10: 0.5950 - accuracy20: 0.5963 - accuracy30: 0.5841 - accuracy50: 0.5541 - val_loss: 10.9011 - val_accuracy10: 0.6096 - val_accuracy20: 0.5931 - val_accuracy30: 0.5675 - val_accuracy50: 0.5166 - 65s/epoch - 41ms/step
Epoch 30/50
1586/1586 - 65s - loss: 10.3517 - accuracy10: 0.5956 - accuracy20: 0.5971 - accuracy30: 0.5858 - accuracy50: 0.5550 - val_loss: 10.9542 - val_accuracy10: 0.6111 - val_accuracy20: 0.5937 - val_accuracy30: 0.5675 - val_accuracy50: 0.5169 - 65s/epoch - 41ms/step
Epoch 31/50
1586/1586 - 65s - loss: 10.3330 - accuracy10: 0.5962 - accuracy20: 0.5984 - accuracy30: 0.5864 - accuracy50: 0.5561 - val_loss: 10.9210 - val_accuracy10: 0.6000 - val_accuracy20: 0.5883 - val_accuracy30: 0.5659 - val_accuracy50: 0.5181 - 65s/epoch - 41ms/step
Epoch 32/50
1586/1586 - 65s - loss: 10.3249 - accuracy10: 0.5966 - accuracy20: 0.5986 - accuracy30: 0.5866 - accuracy50: 0.5563 - val_loss: 10.9824 - val_accuracy10: 0.6140 - val_accuracy20: 0.5954 - val_accuracy30: 0.5686 - val_accuracy50: 0.5166 - 65s/epoch - 41ms/step
Epoch 33/50
1586/1586 - 65s - loss: 10.3156 - accuracy10: 0.5957 - accuracy20: 0.5982 - accuracy30: 0.5866 - accuracy50: 0.5570 - val_loss: 11.0482 - val_accuracy10: 0.6141 - val_accuracy20: 0.5937 - val_accuracy30: 0.5663 - val_accuracy50: 0.5127 - 65s/epoch - 41ms/step
Epoch 34/50
1586/1586 - 64s - loss: 10.2951 - accuracy10: 0.5975 - accuracy20: 0.5994 - accuracy30: 0.5884 - accuracy50: 0.5587 - val_loss: 10.9905 - val_accuracy10: 0.6047 - val_accuracy20: 0.5895 - val_accuracy30: 0.5660 - val_accuracy50: 0.5167 - 64s/epoch - 41ms/step
testing model: results/ATVI/W10/deepVOL_L3/seq2seq
Evaluating performance on  test set...
7633/7633 - 125s - 125s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8847428
{'0': {'precision': 0.4593644392428921, 'recall': 0.4593622801492776, 'f1-score': 0.4593633596935478, 'support': 425516}, '1': {'precision': 0.7716220694461685, 'recall': 0.6139782870885108, 'f1-score': 0.6838323824671924, 'support': 1103583}, '2': {'precision': 0.39241798709935344, 'recall': 0.6006533471094804, 'f1-score': 0.47470341615484485, 'support': 424889}, 'accuracy': 0.5774104037486413, 'macro avg': {'precision': 0.5411348319294713, 'recall': 0.5579979714490896, 'f1-score': 0.5392997194385284, 'support': 1953988}, 'weighted avg': {'precision': 0.621165535875935, 'recall': 0.5774104037486413, 'f1-score': 0.5894757343905219, 'support': 1953988}}
[[195466  98818 131232]
 [162095 677576 263912]
 [ 67953 101725 255211]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.92402714
{'0': {'precision': 0.5038064031770311, 'recall': 0.4144299788948765, 'f1-score': 0.45476846945367494, 'support': 519779}, '1': {'precision': 0.6724190880903038, 'recall': 0.6482268741426593, 'f1-score': 0.6601013989391132, 'support': 911977}, '2': {'precision': 0.4423664316735496, 'recall': 0.5482678196663552, 'f1-score': 0.489656558228622, 'support': 522232}, 'accuracy': 0.5593191974566886, 'macro avg': {'precision': 0.5395306409802948, 'recall': 0.536974890901297, 'f1-score': 0.5348421422071367, 'support': 1953988}, 'weighted avg': {'precision': 0.566081591842952, 'recall': 0.5593191974566886, 'f1-score': 0.5599270402383777, 'support': 1953988}}
[[215412 142019 162348]
 [122227 591168 198582]
 [ 89930 145979 286323]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9558847
{'0': {'precision': 0.5231292171146764, 'recall': 0.37113093960135, 'f1-score': 0.4342124300688059, 'support': 582215}, '1': {'precision': 0.5937593136148115, 'recall': 0.6678713151027612, 'f1-score': 0.6286385327241597, 'support': 787505}, '2': {'precision': 0.46121204813024413, 'recall': 0.5171565103685295, 'f1-score': 0.48758478853193504, 'support': 584268}, 'accuracy': 0.5343881333969298, 'macro avg': {'precision': 0.5260335262865773, 'recall': 0.518719588357547, 'f1-score': 0.5168119171083002, 'support': 1953988}, 'weighted avg': {'precision': 0.5330808307664197, 'recall': 0.5343881333969298, 'f1-score': 0.5285299433320091, 'support': 1953988}}
[[216078 177657 188480]
 [ 97052 525952 164501]
 [ 99919 182191 302158]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0045255
{'0': {'precision': 0.5347274877923023, 'recall': 0.31956100125065706, 'f1-score': 0.4000476503823375, 'support': 662052}, '1': {'precision': 0.4783731232096773, 'recall': 0.6880378197820419, 'f1-score': 0.564361647519024, 'support': 627185}, '2': {'precision': 0.4746915875318469, 'recall': 0.4686311114988921, 'f1-score': 0.47164188143208063, 'support': 664751}, 'accuracy': 0.488547524345083, 'macro avg': {'precision': 0.4959307328446088, 'recall': 0.49207664417719704, 'f1-score': 0.4786837264444807, 'support': 1953988}, 'weighted avg': {'precision': 0.49621469401629564, 'recall': 0.488547524345083, 'f1-score': 0.4771451612057, 'support': 1953988}}
[[211566 230893 219593]
 [ 70510 431527 125148]
 [113576 239652 311523]]
Evaluating performance on  train set...
1586/1586 - 27s - 27s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.84638065
{'0': {'precision': 0.4617787578096288, 'recall': 0.4828107926367992, 'f1-score': 0.47206062776267826, 'support': 83279}, '1': {'precision': 0.7951060014766375, 'recall': 0.6317668503425591, 'f1-score': 0.7040874225070926, 'support': 238645}, '2': {'precision': 0.4013381034242438, 'recall': 0.6176912258956452, 'f1-score': 0.4865473798839677, 'support': 83906}, 'accuracy': 0.5982899243525615, 'macro avg': {'precision': 0.5527409542368367, 'recall': 0.5774229562916678, 'f1-score': 0.5542318100512461, 'support': 405830}, 'weighted avg': {'precision': 0.6452929054035799, 'recall': 0.5982899243525615, 'f1-score': 0.6114972387950555, 'support': 405830}}
[[ 40208  18948  24123]
 [ 34690 150768  53187]
 [ 12174  19904  51828]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.879164
{'0': {'precision': 0.5160167447786322, 'recall': 0.43808971944565167, 'f1-score': 0.4738708717021932, 'support': 103545}, '1': {'precision': 0.698942594204045, 'recall': 0.6729119065752729, 'f1-score': 0.6856802866270872, 'support': 196950}, '2': {'precision': 0.46432384827016454, 'recall': 0.5655859875634879, 'f1-score': 0.5099768021160579, 'support': 105335}, 'accuracy': 0.5851415617376734, 'macro avg': {'precision': 0.559761062417614, 'recall': 0.5588625378614708, 'f1-score': 0.5565093201484461, 'support': 405830}, 'weighted avg': {'precision': 0.591373851918606, 'recall': 0.5851415617376734, 'f1-score': 0.5860338031010605, 'support': 405830}}
[[ 45362  28169  30014]
 [ 25703 132530  38717]
 [ 16843  28916  59576]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.910892
{'0': {'precision': 0.5415899522709415, 'recall': 0.3962845374978548, 'f1-score': 0.45768112064138583, 'support': 116540}, '1': {'precision': 0.6222357401687529, 'recall': 0.6979641535737605, 'f1-score': 0.6579280058553464, 'support': 170003}, '2': {'precision': 0.48925029261381137, 'recall': 0.5326313848114212, 'f1-score': 0.5100200280151395, 'support': 119287}, 'accuracy': 0.5627356282187123, 'macro avg': {'precision': 0.5510253283511687, 'recall': 0.5422933586276789, 'f1-score': 0.5418763848372906, 'support': 405830}, 'weighted avg': {'precision': 0.5599882591937209, 'recall': 0.5627356282187123, 'f1-score': 0.5569490960767205, 'support': 405830}}
[[ 46183  35684  34673]
 [ 19692 118656  31655]
 [ 19398  36353  63536]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.966468
{'0': {'precision': 0.5508152207150459, 'recall': 0.33896353166986565, 'f1-score': 0.41966898402698827, 'support': 132855}, '1': {'precision': 0.5049456443261753, 'recall': 0.7210778645967582, 'f1-score': 0.5939610852454541, 'support': 135787}, '2': {'precision': 0.506142204125533, 'recall': 0.4802315071289034, 'f1-score': 0.4928465362273848, 'support': 137188}, 'accuracy': 0.5145701402064904, 'macro avg': {'precision': 0.5206343563889181, 'recall': 0.5134243011318423, 'f1-score': 0.5021588684999424, 'support': 405830}, 'weighted avg': {'precision': 0.5203662791163526, 'recall': 0.5145701402064904, 'f1-score': 0.5027226852797784, 'support': 405830}}
[[45033 47379 40443]
 [14034 97913 23840]
 [22690 48616 65882]]
Evaluating performance on  val set...
574/574 - 9s - 9s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.83261406
{'0': {'precision': 0.4408679666943013, 'recall': 0.4463217048606043, 'f1-score': 0.4435780731499447, 'support': 27404}, '1': {'precision': 0.8126375480996422, 'recall': 0.6576701596424708, 'f1-score': 0.7269872329117899, 'support': 91517}, '2': {'precision': 0.3827412519138172, 'recall': 0.617049438363025, 'f1-score': 0.47243943523096094, 'support': 27954}, 'accuracy': 0.6105055319148937, 'macro avg': {'precision': 0.5454155889025869, 'recall': 0.5736804342887, 'f1-score': 0.5476682470975651, 'support': 146875}, 'weighted avg': {'precision': 0.6614525630959961, 'recall': 0.6105055319148937, 'f1-score': 0.6256617946106257, 'support': 146875}}
[[12231  7073  8100]
 [11611 60188 19718]
 [ 3901  6804 17249]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8693307
{'0': {'precision': 0.4930156704247323, 'recall': 0.40282726456359896, 'f1-score': 0.44338163789117924, 'support': 34521}, '1': {'precision': 0.723203290978227, 'recall': 0.6940058175773945, 'f1-score': 0.7083037897513037, 'support': 77008}, '2': {'precision': 0.4476435112798749, 'recall': 0.5669948509025067, 'f1-score': 0.5002995656298367, 'support': 35346}, 'accuracy': 0.5950025531914893, 'macro avg': {'precision': 0.5546208242276114, 'recall': 0.5546093110145001, 'f1-score': 0.5506616644241066, 'support': 146875}, 'weighted avg': {'precision': 0.6027863185707707, 'recall': 0.5950025531914893, 'f1-score': 0.5959804201502095, 'support': 146875}}
[[13906 10600 10015]
 [ 8850 53444 14714]
 [ 5450  9855 20041]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9048485
{'0': {'precision': 0.514463111760409, 'recall': 0.3600715746421268, 'f1-score': 0.4236390977443609, 'support': 39120}, '1': {'precision': 0.6481623845168252, 'recall': 0.7128257612839111, 'f1-score': 0.6789579271566217, 'support': 67419}, '2': {'precision': 0.47323042998897463, 'recall': 0.5320557318524395, 'f1-score': 0.5009219709170692, 'support': 40336}, 'accuracy': 0.5692255319148937, 'macro avg': {'precision': 0.5452853087554029, 'recall': 0.5349843559261591, 'f1-score': 0.5345063319393506, 'support': 146875}, 'weighted avg': {'precision': 0.5645104977555221, 'recall': 0.5692255319148937, 'f1-score': 0.56206035481629, 'support': 146875}}
[[14086 13520 11514]
 [ 6986 48058 12375]
 [ 6308 12567 21461]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9650664
{'0': {'precision': 0.5198736008528135, 'recall': 0.3037346798051471, 'f1-score': 0.38344355053844964, 'support': 44957}, '1': {'precision': 0.5346921940900201, 'recall': 0.7327559485823685, 'f1-score': 0.6182483885359138, 'support': 54845}, '2': {'precision': 0.4948072522443232, 'recall': 0.4777260850168887, 'f1-score': 0.48611666540569165, 'support': 47073}, 'accuracy': 0.5197004255319149, 'macro avg': {'precision': 0.5164576823957189, 'recall': 0.5047389044681347, 'f1-score': 0.4959362014933517, 'support': 146875}, 'weighted avg': {'precision': 0.5173733626778152, 'recall': 0.5197004255319149, 'f1-score': 0.5040291020354137, 'support': 146875}}
[[13655 17829 13473]
 [ 5170 40188  9487]
 [ 7441 17144 22488]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :       256            32
 Used       :        23 (peak)  21.22 (ave)

============================================
