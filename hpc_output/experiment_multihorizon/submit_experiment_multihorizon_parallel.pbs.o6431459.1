This machine has 1 visible gpus.
This machine has 1 physical gpus.
training model: results/QRTEA/W0/deepLOB_L1/seq2seq
Epoch 1/50
589/589 - 56s - loss: 12.2750 - accuracy10: 0.4178 - accuracy20: 0.4323 - accuracy30: 0.4397 - accuracy50: 0.4444 - val_loss: 12.9639 - val_accuracy10: 0.3873 - val_accuracy20: 0.3945 - val_accuracy30: 0.3991 - val_accuracy50: 0.4006 - 56s/epoch - 95ms/step
Epoch 2/50
589/589 - 13s - loss: 12.0951 - accuracy10: 0.3970 - accuracy20: 0.4235 - accuracy30: 0.4388 - accuracy50: 0.4490 - val_loss: 12.2807 - val_accuracy10: 0.4077 - val_accuracy20: 0.4372 - val_accuracy30: 0.4515 - val_accuracy50: 0.4530 - 13s/epoch - 23ms/step
Epoch 3/50
589/589 - 13s - loss: 11.8257 - accuracy10: 0.4234 - accuracy20: 0.4488 - accuracy30: 0.4610 - accuracy50: 0.4652 - val_loss: 12.7262 - val_accuracy10: 0.5265 - val_accuracy20: 0.5076 - val_accuracy30: 0.4932 - val_accuracy50: 0.4633 - 13s/epoch - 22ms/step
Epoch 4/50
589/589 - 13s - loss: 11.4947 - accuracy10: 0.4803 - accuracy20: 0.4961 - accuracy30: 0.4986 - accuracy50: 0.4908 - val_loss: 12.6219 - val_accuracy10: 0.5651 - val_accuracy20: 0.5361 - val_accuracy30: 0.5124 - val_accuracy50: 0.4710 - 13s/epoch - 21ms/step
Epoch 5/50
589/589 - 12s - loss: 11.1704 - accuracy10: 0.5185 - accuracy20: 0.5275 - accuracy30: 0.5234 - accuracy50: 0.5067 - val_loss: 12.6988 - val_accuracy10: 0.5942 - val_accuracy20: 0.5590 - val_accuracy30: 0.5293 - val_accuracy50: 0.4813 - 12s/epoch - 21ms/step
Epoch 6/50
589/589 - 13s - loss: 10.9309 - accuracy10: 0.5456 - accuracy20: 0.5505 - accuracy30: 0.5419 - accuracy50: 0.5197 - val_loss: 12.3917 - val_accuracy10: 0.6039 - val_accuracy20: 0.5676 - val_accuracy30: 0.5363 - val_accuracy50: 0.4875 - 13s/epoch - 22ms/step
Epoch 7/50
589/589 - 12s - loss: 10.7546 - accuracy10: 0.5630 - accuracy20: 0.5648 - accuracy30: 0.5542 - accuracy50: 0.5301 - val_loss: 12.2758 - val_accuracy10: 0.6174 - val_accuracy20: 0.5791 - val_accuracy30: 0.5453 - val_accuracy50: 0.4952 - 12s/epoch - 21ms/step
Epoch 8/50
589/589 - 12s - loss: 10.6388 - accuracy10: 0.5753 - accuracy20: 0.5746 - accuracy30: 0.5610 - accuracy50: 0.5350 - val_loss: 12.3553 - val_accuracy10: 0.5940 - val_accuracy20: 0.5593 - val_accuracy30: 0.5293 - val_accuracy50: 0.4852 - 12s/epoch - 21ms/step
Epoch 9/50
589/589 - 13s - loss: 10.5364 - accuracy10: 0.5830 - accuracy20: 0.5823 - accuracy30: 0.5682 - accuracy50: 0.5394 - val_loss: 12.3586 - val_accuracy10: 0.5904 - val_accuracy20: 0.5555 - val_accuracy30: 0.5262 - val_accuracy50: 0.4857 - 13s/epoch - 22ms/step
Epoch 10/50
589/589 - 12s - loss: 10.4804 - accuracy10: 0.5869 - accuracy20: 0.5851 - accuracy30: 0.5703 - accuracy50: 0.5405 - val_loss: 11.9588 - val_accuracy10: 0.6012 - val_accuracy20: 0.5726 - val_accuracy30: 0.5455 - val_accuracy50: 0.5056 - 12s/epoch - 21ms/step
Epoch 11/50
589/589 - 13s - loss: 10.3999 - accuracy10: 0.5946 - accuracy20: 0.5920 - accuracy30: 0.5774 - accuracy50: 0.5467 - val_loss: 11.9941 - val_accuracy10: 0.5911 - val_accuracy20: 0.5642 - val_accuracy30: 0.5394 - val_accuracy50: 0.5028 - 13s/epoch - 22ms/step
Epoch 12/50
589/589 - 13s - loss: 10.3445 - accuracy10: 0.5993 - accuracy20: 0.5970 - accuracy30: 0.5802 - accuracy50: 0.5493 - val_loss: 11.7250 - val_accuracy10: 0.5949 - val_accuracy20: 0.5678 - val_accuracy30: 0.5446 - val_accuracy50: 0.5082 - 13s/epoch - 22ms/step
Epoch 13/50
589/589 - 13s - loss: 10.2887 - accuracy10: 0.6026 - accuracy20: 0.5999 - accuracy30: 0.5839 - accuracy50: 0.5526 - val_loss: 11.6673 - val_accuracy10: 0.5789 - val_accuracy20: 0.5608 - val_accuracy30: 0.5415 - val_accuracy50: 0.5069 - 13s/epoch - 23ms/step
Epoch 14/50
589/589 - 13s - loss: 10.2587 - accuracy10: 0.6056 - accuracy20: 0.6027 - accuracy30: 0.5860 - accuracy50: 0.5546 - val_loss: 11.5337 - val_accuracy10: 0.5771 - val_accuracy20: 0.5620 - val_accuracy30: 0.5438 - val_accuracy50: 0.5132 - 13s/epoch - 21ms/step
Epoch 15/50
589/589 - 12s - loss: 10.2123 - accuracy10: 0.6079 - accuracy20: 0.6055 - accuracy30: 0.5885 - accuracy50: 0.5564 - val_loss: 11.5129 - val_accuracy10: 0.5700 - val_accuracy20: 0.5582 - val_accuracy30: 0.5411 - val_accuracy50: 0.5112 - 12s/epoch - 21ms/step
Epoch 16/50
589/589 - 12s - loss: 10.1804 - accuracy10: 0.6117 - accuracy20: 0.6084 - accuracy30: 0.5911 - accuracy50: 0.5572 - val_loss: 11.6151 - val_accuracy10: 0.5880 - val_accuracy20: 0.5680 - val_accuracy30: 0.5473 - val_accuracy50: 0.5132 - 12s/epoch - 21ms/step
Epoch 17/50
589/589 - 13s - loss: 10.1498 - accuracy10: 0.6132 - accuracy20: 0.6099 - accuracy30: 0.5925 - accuracy50: 0.5590 - val_loss: 11.7124 - val_accuracy10: 0.5794 - val_accuracy20: 0.5600 - val_accuracy30: 0.5409 - val_accuracy50: 0.5091 - 13s/epoch - 22ms/step
Epoch 18/50
589/589 - 13s - loss: 10.1141 - accuracy10: 0.6165 - accuracy20: 0.6120 - accuracy30: 0.5952 - accuracy50: 0.5612 - val_loss: 11.6235 - val_accuracy10: 0.5787 - val_accuracy20: 0.5599 - val_accuracy30: 0.5403 - val_accuracy50: 0.5079 - 13s/epoch - 23ms/step
Epoch 19/50
589/589 - 13s - loss: 10.0865 - accuracy10: 0.6189 - accuracy20: 0.6145 - accuracy30: 0.5968 - accuracy50: 0.5620 - val_loss: 11.7121 - val_accuracy10: 0.5844 - val_accuracy20: 0.5644 - val_accuracy30: 0.5452 - val_accuracy50: 0.5098 - 13s/epoch - 22ms/step
Epoch 20/50
589/589 - 12s - loss: 10.0484 - accuracy10: 0.6207 - accuracy20: 0.6158 - accuracy30: 0.5990 - accuracy50: 0.5646 - val_loss: 12.1291 - val_accuracy10: 0.5959 - val_accuracy20: 0.5637 - val_accuracy30: 0.5368 - val_accuracy50: 0.4967 - 12s/epoch - 21ms/step
Epoch 21/50
589/589 - 13s - loss: 10.0149 - accuracy10: 0.6231 - accuracy20: 0.6193 - accuracy30: 0.6006 - accuracy50: 0.5660 - val_loss: 11.7020 - val_accuracy10: 0.5850 - val_accuracy20: 0.5623 - val_accuracy30: 0.5409 - val_accuracy50: 0.5068 - 13s/epoch - 22ms/step
Epoch 22/50
589/589 - 12s - loss: 9.9937 - accuracy10: 0.6231 - accuracy20: 0.6187 - accuracy30: 0.6009 - accuracy50: 0.5665 - val_loss: 11.7260 - val_accuracy10: 0.5793 - val_accuracy20: 0.5624 - val_accuracy30: 0.5422 - val_accuracy50: 0.5116 - 12s/epoch - 21ms/step
Epoch 23/50
589/589 - 13s - loss: 9.9796 - accuracy10: 0.6231 - accuracy20: 0.6189 - accuracy30: 0.6007 - accuracy50: 0.5664 - val_loss: 11.6335 - val_accuracy10: 0.5711 - val_accuracy20: 0.5561 - val_accuracy30: 0.5379 - val_accuracy50: 0.5066 - 13s/epoch - 22ms/step
Epoch 24/50
589/589 - 12s - loss: 9.9428 - accuracy10: 0.6243 - accuracy20: 0.6209 - accuracy30: 0.6030 - accuracy50: 0.5687 - val_loss: 11.8730 - val_accuracy10: 0.5910 - val_accuracy20: 0.5683 - val_accuracy30: 0.5439 - val_accuracy50: 0.5088 - 12s/epoch - 21ms/step
Epoch 25/50
589/589 - 12s - loss: 9.9208 - accuracy10: 0.6258 - accuracy20: 0.6220 - accuracy30: 0.6047 - accuracy50: 0.5696 - val_loss: 11.6623 - val_accuracy10: 0.5636 - val_accuracy20: 0.5524 - val_accuracy30: 0.5372 - val_accuracy50: 0.5078 - 12s/epoch - 20ms/step
testing model: results/QRTEA/W0/deepLOB_L1/seq2seq
Evaluating performance on  test set...
2359/2359 - 23s - 23s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.80485773
{'0': {'precision': 0.3519665948275862, 'recall': 0.572217626161857, 'f1-score': 0.43584706340233886, 'support': 82196}, '1': {'precision': 0.8734994503015397, 'recall': 0.627271213009718, 'f1-score': 0.7301862611640494, 'support': 438257}, '2': {'precision': 0.3114425044069018, 'recall': 0.5809083818323634, 'f1-score': 0.4054897329262521, 'support': 83335}, 'accuracy': 0.6133775431111582, 'macro avg': {'precision': 0.5123028498453426, 'recall': 0.5934657403346462, 'f1-score': 0.5238410191642134, 'support': 603788}, 'weighted avg': {'precision': 0.7249258943933953, 'recall': 0.6133775431111582, 'f1-score': 0.6453020139118377, 'support': 603788}}
[[ 47034  20937  14225]
 [ 70548 274906  92803]
 [ 16050  18875  48410]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.83875215
{'0': {'precision': 0.4105705136814426, 'recall': 0.547152748339692, 'f1-score': 0.46912254062611053, 'support': 106155}, '1': {'precision': 0.8140583218303425, 'recall': 0.627545224154505, 'f1-score': 0.708736342208237, 'support': 389062}, '2': {'precision': 0.3714415906697784, 'recall': 0.5555903510145435, 'f1-score': 0.44522600454666234, 'support': 108571}, 'accuracy': 0.6004723512226146, 'macro avg': {'precision': 0.5320234753938545, 'recall': 0.5767627745029135, 'f1-score': 0.54102829579367, 'support': 603788}, 'weighted avg': {'precision': 0.6635293457776881, 'recall': 0.6004723512226146, 'f1-score': 0.6192251495757146, 'support': 603788}}
[[ 58083  28588  19484]
 [ 62316 244154  82592]
 [ 21070  27180  60321]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8722976
{'0': {'precision': 0.43693027839369303, 'recall': 0.5253301518081211, 'f1-score': 0.47706970436264057, 'support': 121535}, '1': {'precision': 0.7654297935317448, 'recall': 0.6213509386508578, 'f1-score': 0.6859058676619366, 'support': 356256}, '2': {'precision': 0.4016394902265726, 'recall': 0.5370207227156202, 'f1-score': 0.45956721364920666, 'support': 125997}, 'accuracy': 0.5844253280952917, 'macro avg': {'precision': 0.5346665207173368, 'recall': 0.5612339377248664, 'f1-score': 0.5408475952245946, 'support': 603788}, 'weighted avg': {'precision': 0.6233920660216835, 'recall': 0.5844253280952917, 'f1-score': 0.5966379549239857, 'support': 603788}}
[[ 63846  33890  23799]
 [ 57891 221360  77005]
 [ 24387  33947  67663]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9208741
{'0': {'precision': 0.46162197885196377, 'recall': 0.47992400075718805, 'f1-score': 0.47059511001268384, 'support': 142633}, '1': {'precision': 0.6776031455081137, 'recall': 0.6187135600956947, 'f1-score': 0.646820723172102, 'support': 308899}, '2': {'precision': 0.43713641631161104, 'recall': 0.4979770912147961, 'f1-score': 0.46557753536197083, 'support': 152256}, 'accuracy': 0.5554813941317152, 'macro avg': {'precision': 0.5254538468905628, 'recall': 0.5322048840225596, 'f1-score': 0.5276644561822522, 'support': 603788}, 'weighted avg': {'precision': 0.5659438477675005, 'recall': 0.5554813941317152, 'f1-score': 0.5594871711886467, 'support': 603788}}
[[ 68453  43423  30757]
 [ 50909 191120  66870]
 [ 28926  47510  75820]]
Evaluating performance on  train set...
589/589 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8439969
{'0': {'precision': 0.39235742252708894, 'recall': 0.5530267379679145, 'f1-score': 0.45903909662298925, 'support': 23375}, '1': {'precision': 0.8661396164507552, 'recall': 0.5875642796837823, 'f1-score': 0.7001600548759574, 'support': 104232}, '2': {'precision': 0.3368969181721573, 'recall': 0.6862498917655209, 'f1-score': 0.45193020471004164, 'support': 23098}, 'accuracy': 0.597332537075744, 'macro avg': {'precision': 0.5317979857166671, 'recall': 0.6089469698057391, 'f1-score': 0.5370431187363295, 'support': 150705}, 'weighted avg': {'precision': 0.7115388624757394, 'recall': 0.597332537075744, 'f1-score': 0.6247158726769896, 'support': 150705}}
[[12927  5523  4925]
 [16715 61243 26274]
 [ 3305  3942 15851]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8678493
{'0': {'precision': 0.4556809024979855, 'recall': 0.5197098500016412, 'f1-score': 0.48559380510618727, 'support': 30467}, '1': {'precision': 0.7937813470265106, 'recall': 0.5890099909173478, 'f1-score': 0.6762338339458525, 'support': 90282}, '2': {'precision': 0.40036760951700195, 'recall': 0.6544264921885432, 'f1-score': 0.4968005980664209, 'support': 29956}, 'accuracy': 0.5880030523207591, 'macro avg': {'precision': 0.5499432863471659, 'recall': 0.5877154443691773, 'f1-score': 0.5528760790394869, 'support': 150705}, 'weighted avg': {'precision': 0.6472300835363449, 'recall': 0.5880030523207591, 'f1-score': 0.6020270606293577, 'support': 150705}}
[[15834  7934  6699]
 [14443 53177 22662]
 [ 4471  5881 19604]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8985495
{'0': {'precision': 0.47893972403776325, 'recall': 0.4906011272924952, 'f1-score': 0.4847002953938349, 'support': 34951}, '1': {'precision': 0.7330079678168805, 'recall': 0.5770859675181989, 'f1-score': 0.6457683695756693, 'support': 81461}, '2': {'precision': 0.4275162497537916, 'recall': 0.6329280027994051, 'f1-score': 0.5103276395142423, 'support': 34293}, 'accuracy': 0.5697355761255433, 'macro avg': {'precision': 0.5464879805361451, 'recall': 0.5668716992033663, 'f1-score': 0.5469321014945822, 'support': 150705}, 'weighted avg': {'precision': 0.6045705126835974, 'recall': 0.5697355761255433, 'f1-score': 0.5775943924898007, 'support': 150705}}
[[17147  9746  8058]
 [13444 47010 21007]
 [ 5211  7377 21705]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9506399
{'0': {'precision': 0.4932668741222152, 'recall': 0.43835348245313493, 'f1-score': 0.464191771946874, 'support': 40862}, '1': {'precision': 0.6320337264871997, 'recall': 0.5635195041820295, 'f1-score': 0.5958134243458475, 'support': 69703}, '2': {'precision': 0.4515456024499952, 'recall': 0.5877179870453413, 'f1-score': 0.5107106131947827, 'support': 40140}, 'accuracy': 0.5360273381772337, 'macro avg': {'precision': 0.5256154010198033, 'recall': 0.5298636578935019, 'f1-score': 0.5235719364958348, 'support': 150705}, 'weighted avg': {'precision': 0.5463359432670585, 'recall': 0.5360273381772337, 'f1-score': 0.5374586862818775, 'support': 150705}}
[[17912 12747 10203]
 [11973 39279 18451]
 [ 6428 10121 23591]]
Evaluating performance on  val set...
230/230 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8741271
{'0': {'precision': 0.39574054579318163, 'recall': 0.5170334320778671, 'f1-score': 0.44832805834594747, 'support': 9452}, '1': {'precision': 0.8351119402985074, 'recall': 0.5599029344807746, 'f1-score': 0.6703607745645696, 'support': 39973}, '2': {'precision': 0.3232169183061359, 'recall': 0.6767429483767962, 'f1-score': 0.4374870983279433, 'support': 9395}, 'accuracy': 0.5716763005780346, 'macro avg': {'precision': 0.5180231347992751, 'recall': 0.5845597716451459, 'f1-score': 0.5187253104128201, 'support': 58820}, 'weighted avg': {'precision': 0.6827455317217874, 'recall': 0.5716763005780346, 'f1-score': 0.5974858778977636, 'support': 58820}}
[[ 4887  2620  1945]
 [ 6224 22381 11368]
 [ 1238  1799  6358]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.90422195
{'0': {'precision': 0.4555709023941068, 'recall': 0.48532657565601245, 'f1-score': 0.4699782307540075, 'support': 12233}, '1': {'precision': 0.7534832172260925, 'recall': 0.5546458436525742, 'f1-score': 0.6389527565662498, 'support': 34321}, '2': {'precision': 0.38257649580978365, 'recall': 0.6401434860590249, 'f1-score': 0.4789265019823117, 'support': 12266}, 'accuracy': 0.5580584835090105, 'macro avg': {'precision': 0.5305435384766609, 'recall': 0.5600386351225372, 'f1-score': 0.529285829767523, 'support': 58820}, 'weighted avg': {'precision': 0.6141785046753934, 'recall': 0.5580584835090105, 'f1-score': 0.5704395397524493, 'support': 58820}}
[[ 5937  3589  2707]
 [ 5320 19036  9965]
 [ 1775  2639  7852]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.93419874
{'0': {'precision': 0.47867263236390756, 'recall': 0.45673829514728903, 'f1-score': 0.4674482959510632, 'support': 14054}, '1': {'precision': 0.6884019020053752, 'recall': 0.5443696050222339, 'f1-score': 0.60797166280195, 'support': 30584}, '2': {'precision': 0.4156419316843345, 'recall': 0.6220561274855451, 'f1-score': 0.49831954133363465, 'support': 14182}, 'accuracy': 0.5421625297517851, 'macro avg': {'precision': 0.5275721553512057, 'recall': 0.5410546758850227, 'f1-score': 0.5245798333622159, 'support': 58820}, 'weighted avg': {'precision': 0.5725260595260454, 'recall': 0.5421625297517851, 'f1-score': 0.5479580316495187, 'support': 58820}}
[[ 6419  4302  3333]
 [ 4865 16649  9070]
 [ 2126  3234  8822]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9815628
{'0': {'precision': 0.49587264150943394, 'recall': 0.40760935417423966, 'f1-score': 0.44742967347210216, 'support': 16506}, '1': {'precision': 0.5816195372750642, 'recall': 0.5313527477689056, 'f1-score': 0.5553510063819342, 'support': 25548}, '2': {'precision': 0.4485213581599124, 'recall': 0.5861863294763211, 'f1-score': 0.5081958736232484, 'support': 16766}, 'accuracy': 0.5122577354641279, 'macro avg': {'precision': 0.5086711789814702, 'recall': 0.5083828104731555, 'f1-score': 0.5036588511590949, 'support': 58820}, 'weighted avg': {'precision': 0.5196191575988974, 'recall': 0.5122577354641279, 'f1-score': 0.5116251907266841, 'support': 58820}}
[[ 6728  5406  4372]
 [ 4261 13575  7712]
 [ 2579  4359  9828]]
training model: results/QRTEA/W0/deepOF_L1/seq2seq
Epoch 1/50
589/589 - 17s - loss: 12.9748 - accuracy10: 0.3830 - accuracy20: 0.3936 - accuracy30: 0.3960 - accuracy50: 0.3948 - val_loss: 13.1926 - val_accuracy10: 0.5845 - val_accuracy20: 0.5298 - val_accuracy30: 0.4893 - val_accuracy50: 0.4320 - 17s/epoch - 29ms/step
Epoch 2/50
589/589 - 12s - loss: 12.7806 - accuracy10: 0.4172 - accuracy20: 0.4176 - accuracy30: 0.4132 - accuracy50: 0.4057 - val_loss: 13.1115 - val_accuracy10: 0.5955 - val_accuracy20: 0.5422 - val_accuracy30: 0.5008 - val_accuracy50: 0.4401 - 12s/epoch - 20ms/step
Epoch 3/50
589/589 - 11s - loss: 12.6716 - accuracy10: 0.4416 - accuracy20: 0.4393 - accuracy30: 0.4319 - accuracy50: 0.4207 - val_loss: 13.0620 - val_accuracy10: 0.5835 - val_accuracy20: 0.5361 - val_accuracy30: 0.4978 - val_accuracy50: 0.4384 - 11s/epoch - 19ms/step
Epoch 4/50
589/589 - 13s - loss: 12.5892 - accuracy10: 0.4585 - accuracy20: 0.4557 - accuracy30: 0.4476 - accuracy50: 0.4324 - val_loss: 13.0206 - val_accuracy10: 0.5770 - val_accuracy20: 0.5351 - val_accuracy30: 0.4995 - val_accuracy50: 0.4413 - 13s/epoch - 21ms/step
Epoch 5/50
589/589 - 11s - loss: 12.5195 - accuracy10: 0.4693 - accuracy20: 0.4671 - accuracy30: 0.4572 - accuracy50: 0.4395 - val_loss: 13.0148 - val_accuracy10: 0.5703 - val_accuracy20: 0.5275 - val_accuracy30: 0.4914 - val_accuracy50: 0.4378 - 11s/epoch - 19ms/step
Epoch 6/50
589/589 - 11s - loss: 12.4555 - accuracy10: 0.4735 - accuracy20: 0.4708 - accuracy30: 0.4607 - accuracy50: 0.4424 - val_loss: 12.9581 - val_accuracy10: 0.5589 - val_accuracy20: 0.5200 - val_accuracy30: 0.4875 - val_accuracy50: 0.4377 - 11s/epoch - 19ms/step
Epoch 7/50
589/589 - 11s - loss: 12.3707 - accuracy10: 0.4726 - accuracy20: 0.4724 - accuracy30: 0.4646 - accuracy50: 0.4474 - val_loss: 12.9151 - val_accuracy10: 0.5312 - val_accuracy20: 0.4981 - val_accuracy30: 0.4720 - val_accuracy50: 0.4313 - 11s/epoch - 19ms/step
Epoch 8/50
589/589 - 12s - loss: 12.2898 - accuracy10: 0.4737 - accuracy20: 0.4755 - accuracy30: 0.4688 - accuracy50: 0.4522 - val_loss: 12.9315 - val_accuracy10: 0.5206 - val_accuracy20: 0.4926 - val_accuracy30: 0.4692 - val_accuracy50: 0.4312 - 12s/epoch - 20ms/step
Epoch 9/50
589/589 - 13s - loss: 12.2235 - accuracy10: 0.4740 - accuracy20: 0.4769 - accuracy30: 0.4702 - accuracy50: 0.4554 - val_loss: 12.8689 - val_accuracy10: 0.5077 - val_accuracy20: 0.4849 - val_accuracy30: 0.4664 - val_accuracy50: 0.4344 - 13s/epoch - 21ms/step
Epoch 10/50
589/589 - 13s - loss: 12.1526 - accuracy10: 0.4783 - accuracy20: 0.4815 - accuracy30: 0.4749 - accuracy50: 0.4606 - val_loss: 12.8941 - val_accuracy10: 0.5000 - val_accuracy20: 0.4795 - val_accuracy30: 0.4636 - val_accuracy50: 0.4358 - 13s/epoch - 21ms/step
Epoch 11/50
589/589 - 12s - loss: 12.0849 - accuracy10: 0.4859 - accuracy20: 0.4887 - accuracy30: 0.4815 - accuracy50: 0.4655 - val_loss: 12.7828 - val_accuracy10: 0.4808 - val_accuracy20: 0.4675 - val_accuracy30: 0.4549 - val_accuracy50: 0.4326 - 12s/epoch - 21ms/step
Epoch 12/50
589/589 - 11s - loss: 12.0304 - accuracy10: 0.4920 - accuracy20: 0.4933 - accuracy30: 0.4848 - accuracy50: 0.4689 - val_loss: 12.8180 - val_accuracy10: 0.4955 - val_accuracy20: 0.4763 - val_accuracy30: 0.4598 - val_accuracy50: 0.4344 - 11s/epoch - 19ms/step
Epoch 13/50
589/589 - 12s - loss: 11.9872 - accuracy10: 0.4939 - accuracy20: 0.4964 - accuracy30: 0.4886 - accuracy50: 0.4716 - val_loss: 12.7287 - val_accuracy10: 0.4491 - val_accuracy20: 0.4451 - val_accuracy30: 0.4386 - val_accuracy50: 0.4257 - 12s/epoch - 20ms/step
Epoch 14/50
589/589 - 11s - loss: 11.9453 - accuracy10: 0.4979 - accuracy20: 0.4995 - accuracy30: 0.4908 - accuracy50: 0.4740 - val_loss: 12.6952 - val_accuracy10: 0.4637 - val_accuracy20: 0.4566 - val_accuracy30: 0.4473 - val_accuracy50: 0.4307 - 11s/epoch - 19ms/step
Epoch 15/50
589/589 - 12s - loss: 11.8765 - accuracy10: 0.5031 - accuracy20: 0.5052 - accuracy30: 0.4972 - accuracy50: 0.4807 - val_loss: 12.6900 - val_accuracy10: 0.4669 - val_accuracy20: 0.4613 - val_accuracy30: 0.4518 - val_accuracy50: 0.4337 - 12s/epoch - 20ms/step
Epoch 16/50
589/589 - 12s - loss: 11.8424 - accuracy10: 0.5052 - accuracy20: 0.5077 - accuracy30: 0.4986 - accuracy50: 0.4823 - val_loss: 12.6524 - val_accuracy10: 0.4641 - val_accuracy20: 0.4592 - val_accuracy30: 0.4528 - val_accuracy50: 0.4368 - 12s/epoch - 20ms/step
Epoch 17/50
589/589 - 11s - loss: 11.8122 - accuracy10: 0.5082 - accuracy20: 0.5098 - accuracy30: 0.5013 - accuracy50: 0.4829 - val_loss: 12.6635 - val_accuracy10: 0.4629 - val_accuracy20: 0.4608 - val_accuracy30: 0.4530 - val_accuracy50: 0.4347 - 11s/epoch - 19ms/step
Epoch 18/50
589/589 - 11s - loss: 11.7389 - accuracy10: 0.5142 - accuracy20: 0.5164 - accuracy30: 0.5072 - accuracy50: 0.4886 - val_loss: 12.6252 - val_accuracy10: 0.4479 - val_accuracy20: 0.4480 - val_accuracy30: 0.4427 - val_accuracy50: 0.4305 - 11s/epoch - 19ms/step
Epoch 19/50
589/589 - 12s - loss: 11.6936 - accuracy10: 0.5163 - accuracy20: 0.5182 - accuracy30: 0.5097 - accuracy50: 0.4914 - val_loss: 12.6213 - val_accuracy10: 0.4602 - val_accuracy20: 0.4565 - val_accuracy30: 0.4497 - val_accuracy50: 0.4343 - 12s/epoch - 21ms/step
Epoch 20/50
589/589 - 12s - loss: 11.6565 - accuracy10: 0.5195 - accuracy20: 0.5215 - accuracy30: 0.5128 - accuracy50: 0.4939 - val_loss: 12.5637 - val_accuracy10: 0.4357 - val_accuracy20: 0.4391 - val_accuracy30: 0.4359 - val_accuracy50: 0.4274 - 12s/epoch - 20ms/step
Epoch 21/50
589/589 - 11s - loss: 11.6061 - accuracy10: 0.5198 - accuracy20: 0.5226 - accuracy30: 0.5147 - accuracy50: 0.4959 - val_loss: 12.6142 - val_accuracy10: 0.4428 - val_accuracy20: 0.4421 - val_accuracy30: 0.4362 - val_accuracy50: 0.4271 - 11s/epoch - 19ms/step
Epoch 22/50
589/589 - 12s - loss: 11.5640 - accuracy10: 0.5213 - accuracy20: 0.5246 - accuracy30: 0.5171 - accuracy50: 0.4981 - val_loss: 12.6073 - val_accuracy10: 0.4590 - val_accuracy20: 0.4520 - val_accuracy30: 0.4457 - val_accuracy50: 0.4320 - 12s/epoch - 20ms/step
Epoch 23/50
589/589 - 11s - loss: 11.5182 - accuracy10: 0.5246 - accuracy20: 0.5276 - accuracy30: 0.5196 - accuracy50: 0.5023 - val_loss: 12.5745 - val_accuracy10: 0.4515 - val_accuracy20: 0.4486 - val_accuracy30: 0.4449 - val_accuracy50: 0.4303 - 11s/epoch - 19ms/step
Epoch 24/50
589/589 - 12s - loss: 11.4731 - accuracy10: 0.5268 - accuracy20: 0.5310 - accuracy30: 0.5231 - accuracy50: 0.5033 - val_loss: 12.5788 - val_accuracy10: 0.4438 - val_accuracy20: 0.4419 - val_accuracy30: 0.4381 - val_accuracy50: 0.4267 - 12s/epoch - 20ms/step
Epoch 25/50
589/589 - 13s - loss: 11.4326 - accuracy10: 0.5293 - accuracy20: 0.5327 - accuracy30: 0.5246 - accuracy50: 0.5059 - val_loss: 12.6407 - val_accuracy10: 0.4450 - val_accuracy20: 0.4400 - val_accuracy30: 0.4341 - val_accuracy50: 0.4234 - 13s/epoch - 22ms/step
Epoch 26/50
589/589 - 12s - loss: 11.3998 - accuracy10: 0.5313 - accuracy20: 0.5341 - accuracy30: 0.5274 - accuracy50: 0.5083 - val_loss: 12.5763 - val_accuracy10: 0.4470 - val_accuracy20: 0.4457 - val_accuracy30: 0.4403 - val_accuracy50: 0.4299 - 12s/epoch - 20ms/step
Epoch 27/50
589/589 - 11s - loss: 11.3537 - accuracy10: 0.5335 - accuracy20: 0.5361 - accuracy30: 0.5281 - accuracy50: 0.5095 - val_loss: 12.5974 - val_accuracy10: 0.4582 - val_accuracy20: 0.4516 - val_accuracy30: 0.4451 - val_accuracy50: 0.4338 - 11s/epoch - 20ms/step
Epoch 28/50
589/589 - 11s - loss: 11.2903 - accuracy10: 0.5358 - accuracy20: 0.5382 - accuracy30: 0.5304 - accuracy50: 0.5131 - val_loss: 12.5752 - val_accuracy10: 0.4229 - val_accuracy20: 0.4256 - val_accuracy30: 0.4230 - val_accuracy50: 0.4184 - 11s/epoch - 19ms/step
Epoch 29/50
589/589 - 12s - loss: 11.2810 - accuracy10: 0.5367 - accuracy20: 0.5391 - accuracy30: 0.5324 - accuracy50: 0.5130 - val_loss: 12.5671 - val_accuracy10: 0.4600 - val_accuracy20: 0.4521 - val_accuracy30: 0.4445 - val_accuracy50: 0.4319 - 12s/epoch - 21ms/step
Epoch 30/50
589/589 - 11s - loss: 11.2246 - accuracy10: 0.5406 - accuracy20: 0.5430 - accuracy30: 0.5362 - accuracy50: 0.5166 - val_loss: 12.5814 - val_accuracy10: 0.4428 - val_accuracy20: 0.4396 - val_accuracy30: 0.4348 - val_accuracy50: 0.4246 - 11s/epoch - 19ms/step
testing model: results/QRTEA/W0/deepOF_L1/seq2seq
Evaluating performance on  test set...
2359/2359 - 22s - 22s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.98327035
{'0': {'precision': 0.21884317233154443, 'recall': 0.567060856023554, 'f1-score': 0.315808017670993, 'support': 82194}, '1': {'precision': 0.8356182933585014, 'recall': 0.46465079770727613, 'f1-score': 0.5972159290036967, 'support': 438256}, '2': {'precision': 0.23265061960858954, 'recall': 0.41070164280657123, 'f1-score': 0.2970378663611668, 'support': 83333}, 'accuracy': 0.47114609056565027, 'macro avg': {'precision': 0.42903736176621177, 'recall': 0.4808044321791338, 'f1-score': 0.4033539376786188, 'support': 603783}, 'weighted avg': {'precision': 0.6684351837739468, 'recall': 0.47114609056565027, 'f1-score': 0.5174773799583109, 'support': 603783}}
[[ 46609  16784  18801]
 [140537 203636  94083]
 [ 25833  23275  34225]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9991426
{'0': {'precision': 0.268167126130945, 'recall': 0.5525651412099403, 'f1-score': 0.36109170265353796, 'support': 106154}, '1': {'precision': 0.7725284988565543, 'recall': 0.4549686168271381, 'f1-score': 0.5726713620643358, 'support': 389062}, '2': {'precision': 0.28588104003386394, 'recall': 0.4105667468015143, 'f1-score': 0.3370625933417774, 'support': 108567}, 'accuracy': 0.46414357476113105, 'macro avg': {'precision': 0.4421922216737877, 'recall': 0.4727001682795309, 'f1-score': 0.42360855268655034, 'support': 603783}, 'weighted avg': {'precision': 0.596349587190745, 'recall': 0.46414357476113105, 'f1-score': 0.4931074055451959, 'support': 603783}}
[[ 58657  21368  26129]
 [126836 177011  85215]
 [ 33240  30753  44574]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.015098
{'0': {'precision': 0.2943823760818253, 'recall': 0.5387628153438544, 'f1-score': 0.38073142438488305, 'support': 121534}, '1': {'precision': 0.7214895338578213, 'recall': 0.4430185035480104, 'f1-score': 0.5489583641299527, 'support': 356256}, '2': {'precision': 0.315759047999754, 'recall': 0.4075147031977967, 'f1-score': 0.3558167416267612, 'support': 125993}, 'accuracy': 0.454881969184293, 'macro avg': {'precision': 0.44387698597980024, 'recall': 0.4630986740298872, 'f1-score': 0.42850217671386565, 'support': 603783}, 'weighted avg': {'precision': 0.5508533244616255, 'recall': 0.454881969184293, 'f1-score': 0.4747930011783262, 'support': 603783}}
[[ 65478  24556  31500]
 [118667 157828  79761]
 [ 38280  36369  51344]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0353855
{'0': {'precision': 0.32554655618482004, 'recall': 0.5134437815061242, 'f1-score': 0.3984547791667234, 'support': 142631}, '1': {'precision': 0.6361422285646331, 'recall': 0.4329343895577519, 'f1-score': 0.515225649363158, 'support': 308899}, '2': {'precision': 0.35195487651538515, 'recall': 0.38975258287193026, 'f1-score': 0.36989063663875177, 'support': 152253}, 'accuracy': 0.4410640909068324, 'macro avg': {'precision': 0.43788122042161276, 'recall': 0.4453769179786022, 'f1-score': 0.4278570217228777, 'support': 603783}, 'weighted avg': {'precision': 0.4911084196320211, 'recall': 0.4410640909068324, 'f1-score': 0.450992576091276, 'support': 603783}}
[[ 73233  30675  38723]
 [104626 133733  70540]
 [ 47095  45817  59341]]
Evaluating performance on  train set...
589/589 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9980842
{'0': {'precision': 0.2527557568893922, 'recall': 0.5716786202185792, 'f1-score': 0.35053138579131976, 'support': 23424}, '1': {'precision': 0.8490880892082376, 'recall': 0.4150910801005816, 'f1-score': 0.5575932598900284, 'support': 104194}, '2': {'precision': 0.2720200055570992, 'recall': 0.551286493979035, 'f1-score': 0.3642894966582228, 'support': 23086}, 'accuracy': 0.46029302473723327, 'macro avg': {'precision': 0.457954617218243, 'recall': 0.5126853980993986, 'f1-score': 0.42413804744652367, 'support': 150704}, 'weighted avg': {'precision': 0.6680001132327704, 'recall': 0.46029302473723327, 'f1-score': 0.49579776662603, 'support': 150704}}
[[13391  3532  6501]
 [33385 43250 27559]
 [ 6204  4155 12727]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0005292
{'0': {'precision': 0.3150740515317509, 'recall': 0.5600983606557377, 'f1-score': 0.4032861577686233, 'support': 30500}, '1': {'precision': 0.7823769538272806, 'recall': 0.40974799224591524, 'f1-score': 0.5378251450339503, 'support': 90275}, '2': {'precision': 0.33069137910010976, 'recall': 0.5436867252497578, 'f1-score': 0.41124660390471984, 'support': 29929}, 'accuracy': 0.4667759316275613, 'macro avg': {'precision': 0.4760474614863804, 'recall': 0.5045110260504703, 'f1-score': 0.45078596890243117, 'support': 150704}, 'weighted avg': {'precision': 0.5981002519081334, 'recall': 0.4667759316275613, 'f1-score': 0.4854588623271262, 'support': 150704}}
[[17083  4701  8716]
 [29067 36990 24218]
 [ 8069  5588 16272]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0121142
{'0': {'precision': 0.3462671369867995, 'recall': 0.5442386831275721, 'f1-score': 0.42324702744749415, 'support': 34992}, '1': {'precision': 0.723805476020043, 'recall': 0.3974377871127816, 'f1-score': 0.5131226311866665, 'support': 81414}, '2': {'precision': 0.3586133877102859, 'recall': 0.5332672459035512, 'f1-score': 0.42883939038686986, 'support': 34298}, 'accuracy': 0.4624362989701667, 'macro avg': {'precision': 0.4762286669057095, 'recall': 0.49164790538130165, 'f1-score': 0.4550696830070102, 'support': 150704}, 'weighted avg': {'precision': 0.5530324387794966, 'recall': 0.4624362989701667, 'f1-score': 0.47307277372440576, 'support': 150704}}
[[19044  5620 10328]
 [26673 32357 22384]
 [ 9281  6727 18290]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0308125
{'0': {'precision': 0.3781556361547025, 'recall': 0.5149262854208944, 'f1-score': 0.4360681194678814, 'support': 40901}, '1': {'precision': 0.624774532080864, 'recall': 0.38297291864104993, 'f1-score': 0.4748644630600635, 'support': 69642}, '2': {'precision': 0.3852755107891669, 'recall': 0.5019297328253779, 'f1-score': 0.43593347894725465, 'support': 40161}, 'accuracy': 0.450485720352479, 'macro avg': {'precision': 0.4627352263415778, 'recall': 0.4666096456291074, 'f1-score': 0.4489553538250665, 'support': 150704}, 'weighted avg': {'precision': 0.49401835005270434, 'recall': 0.450485720352479, 'f1-score': 0.4539604624879595, 'support': 150704}}
[[21061  7352 12488]
 [23296 26671 19675]
 [11337  8666 20158]]
Evaluating performance on  val set...
230/230 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0177059
{'0': {'precision': 0.2464230426420228, 'recall': 0.5558141995556026, 'f1-score': 0.3414586583463339, 'support': 9451}, '1': {'precision': 0.8090767634854772, 'recall': 0.39060974082884686, 'f1-score': 0.5268597483745673, 'support': 39935}, '2': {'precision': 0.2567775216770936, 'recall': 0.4960245945086399, 'f1-score': 0.33838365575845236, 'support': 9433}, 'accuracy': 0.43406042265254424, 'macro avg': {'precision': 0.43742577593486454, 'recall': 0.48081617829769646, 'f1-score': 0.40223402082645116, 'support': 58819}, 'weighted avg': {'precision': 0.6300958378718154, 'recall': 0.43406042265254424, 'f1-score': 0.46684307547117476, 'support': 58819}}
[[ 5253  1646  2552]
 [13345 15599 10991]
 [ 2719  2035  4679]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0233786
{'0': {'precision': 0.30439181421016326, 'recall': 0.541919109218929, 'f1-score': 0.38982302187932505, 'support': 12214}, '1': {'precision': 0.7372809735759761, 'recall': 0.3815271582261874, 'f1-score': 0.5028435290501077, 'support': 34299}, '2': {'precision': 0.31389391979301423, 'recall': 0.4929302779132131, 'f1-score': 0.3835477854003983, 'support': 12306}, 'accuracy': 0.43814073683673643, 'macro avg': {'precision': 0.4518555691930512, 'recall': 0.47212551511944323, 'f1-score': 0.42540477877661037, 'support': 58819}, 'weighted avg': {'precision': 0.5588095735802745, 'recall': 0.43814073683673643, 'f1-score': 0.45441553986400685, 'support': 58819}}
[[ 6619  2014  3581]
 [11535 13086  9678]
 [ 3591  2649  6066]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0331676
{'0': {'precision': 0.3371509399525461, 'recall': 0.5271456089034744, 'f1-score': 0.4112654106253305, 'support': 14017}, '1': {'precision': 0.6729428588452601, 'recall': 0.36912115566885645, 'f1-score': 0.4767412410299705, 'support': 30597}, '2': {'precision': 0.34358846918489067, 'recall': 0.4866596268919395, 'f1-score': 0.40279679533867446, 'support': 14205}, 'accuracy': 0.4351655077440963, 'macro avg': {'precision': 0.45122742266089894, 'recall': 0.4609754638214234, 'f1-score': 0.4302678156646585, 'support': 58819}, 'weighted avg': {'precision': 0.5133809072268252, 'recall': 0.4351655077440963, 'f1-score': 0.44328001989688937, 'support': 58819}}
[[ 7389  2369  4259]
 [10355 11294  8948]
 [ 4172  3120  6913]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0484385
{'0': {'precision': 0.37383473617521945, 'recall': 0.501061442348517, 'f1-score': 0.42819748606971625, 'support': 16487}, '1': {'precision': 0.5673586434760926, 'recall': 0.35646860679174336, 'f1-score': 0.43784277879341865, 'support': 25531}, '2': {'precision': 0.37238878143133464, 'recall': 0.4583655734777692, 'f1-score': 0.41092820362316906, 'support': 16801}, 'accuracy': 0.4261038099933695, 'macro avg': {'precision': 0.4378607203608822, 'recall': 0.43863187420600985, 'f1-score': 0.42565615616210134, 'support': 58819}, 'weighted avg': {'precision': 0.45742278411290255, 'recall': 0.4261038099933695, 'f1-score': 0.4274513454373425, 'support': 58819}}
[[8261 3000 5226]
 [8677 9101 7753]
 [5160 3940 7701]]
training model: results/QRTEA/W0/deepLOB_L2/seq2seq
Epoch 1/50
589/589 - 34s - loss: 12.4190 - accuracy10: 0.4157 - accuracy20: 0.4275 - accuracy30: 0.4327 - accuracy50: 0.4359 - val_loss: 12.8823 - val_accuracy10: 0.4432 - val_accuracy20: 0.4325 - val_accuracy30: 0.4252 - val_accuracy50: 0.4154 - 34s/epoch - 58ms/step
Epoch 2/50
589/589 - 28s - loss: 11.8038 - accuracy10: 0.4505 - accuracy20: 0.4689 - accuracy30: 0.4746 - accuracy50: 0.4740 - val_loss: 12.9370 - val_accuracy10: 0.4460 - val_accuracy20: 0.4329 - val_accuracy30: 0.4250 - val_accuracy50: 0.4164 - 28s/epoch - 47ms/step
Epoch 3/50
589/589 - 28s - loss: 11.5686 - accuracy10: 0.4847 - accuracy20: 0.4992 - accuracy30: 0.5024 - accuracy50: 0.4965 - val_loss: 12.7752 - val_accuracy10: 0.5620 - val_accuracy20: 0.5248 - val_accuracy30: 0.4965 - val_accuracy50: 0.4598 - 28s/epoch - 47ms/step
Epoch 4/50
589/589 - 27s - loss: 11.3074 - accuracy10: 0.5165 - accuracy20: 0.5252 - accuracy30: 0.5242 - accuracy50: 0.5127 - val_loss: 13.0058 - val_accuracy10: 0.6083 - val_accuracy20: 0.5601 - val_accuracy30: 0.5243 - val_accuracy50: 0.4704 - 27s/epoch - 46ms/step
Epoch 5/50
589/589 - 27s - loss: 11.0637 - accuracy10: 0.5476 - accuracy20: 0.5529 - accuracy30: 0.5463 - accuracy50: 0.5276 - val_loss: 12.4768 - val_accuracy10: 0.6162 - val_accuracy20: 0.5732 - val_accuracy30: 0.5372 - val_accuracy50: 0.4869 - 27s/epoch - 47ms/step
Epoch 6/50
589/589 - 27s - loss: 10.7767 - accuracy10: 0.5808 - accuracy20: 0.5802 - accuracy30: 0.5679 - accuracy50: 0.5413 - val_loss: 11.8976 - val_accuracy10: 0.6027 - val_accuracy20: 0.5773 - val_accuracy30: 0.5512 - val_accuracy50: 0.5137 - 27s/epoch - 47ms/step
Epoch 7/50
589/589 - 27s - loss: 10.5473 - accuracy10: 0.5988 - accuracy20: 0.5963 - accuracy30: 0.5800 - accuracy50: 0.5483 - val_loss: 11.3473 - val_accuracy10: 0.5837 - val_accuracy20: 0.5743 - val_accuracy30: 0.5558 - val_accuracy50: 0.5237 - 27s/epoch - 47ms/step
Epoch 8/50
589/589 - 27s - loss: 10.3751 - accuracy10: 0.6113 - accuracy20: 0.6075 - accuracy30: 0.5896 - accuracy50: 0.5551 - val_loss: 11.1111 - val_accuracy10: 0.5781 - val_accuracy20: 0.5740 - val_accuracy30: 0.5583 - val_accuracy50: 0.5272 - 27s/epoch - 47ms/step
Epoch 9/50
589/589 - 27s - loss: 10.2383 - accuracy10: 0.6194 - accuracy20: 0.6155 - accuracy30: 0.5958 - accuracy50: 0.5597 - val_loss: 11.1387 - val_accuracy10: 0.5617 - val_accuracy20: 0.5603 - val_accuracy30: 0.5467 - val_accuracy50: 0.5213 - 27s/epoch - 46ms/step
Epoch 10/50
589/589 - 28s - loss: 10.1459 - accuracy10: 0.6238 - accuracy20: 0.6197 - accuracy30: 0.5990 - accuracy50: 0.5631 - val_loss: 11.1101 - val_accuracy10: 0.5992 - val_accuracy20: 0.5871 - val_accuracy30: 0.5664 - val_accuracy50: 0.5330 - 28s/epoch - 47ms/step
Epoch 11/50
589/589 - 27s - loss: 10.0518 - accuracy10: 0.6268 - accuracy20: 0.6231 - accuracy30: 0.6029 - accuracy50: 0.5664 - val_loss: 11.0815 - val_accuracy10: 0.5809 - val_accuracy20: 0.5748 - val_accuracy30: 0.5578 - val_accuracy50: 0.5286 - 27s/epoch - 46ms/step
Epoch 12/50
589/589 - 28s - loss: 9.9819 - accuracy10: 0.6286 - accuracy20: 0.6257 - accuracy30: 0.6059 - accuracy50: 0.5692 - val_loss: 11.0923 - val_accuracy10: 0.5599 - val_accuracy20: 0.5576 - val_accuracy30: 0.5441 - val_accuracy50: 0.5204 - 28s/epoch - 47ms/step
Epoch 13/50
589/589 - 28s - loss: 9.9208 - accuracy10: 0.6302 - accuracy20: 0.6273 - accuracy30: 0.6074 - accuracy50: 0.5715 - val_loss: 11.1395 - val_accuracy10: 0.5739 - val_accuracy20: 0.5664 - val_accuracy30: 0.5503 - val_accuracy50: 0.5221 - 28s/epoch - 47ms/step
Epoch 14/50
589/589 - 27s - loss: 9.8624 - accuracy10: 0.6331 - accuracy20: 0.6296 - accuracy30: 0.6100 - accuracy50: 0.5734 - val_loss: 11.1595 - val_accuracy10: 0.5623 - val_accuracy20: 0.5570 - val_accuracy30: 0.5414 - val_accuracy50: 0.5152 - 27s/epoch - 46ms/step
Epoch 15/50
589/589 - 27s - loss: 9.8006 - accuracy10: 0.6353 - accuracy20: 0.6321 - accuracy30: 0.6123 - accuracy50: 0.5765 - val_loss: 11.2521 - val_accuracy10: 0.5603 - val_accuracy20: 0.5519 - val_accuracy30: 0.5356 - val_accuracy50: 0.5086 - 27s/epoch - 46ms/step
Epoch 16/50
589/589 - 27s - loss: 9.7528 - accuracy10: 0.6365 - accuracy20: 0.6339 - accuracy30: 0.6142 - accuracy50: 0.5780 - val_loss: 11.2363 - val_accuracy10: 0.5598 - val_accuracy20: 0.5490 - val_accuracy30: 0.5327 - val_accuracy50: 0.5083 - 27s/epoch - 46ms/step
Epoch 17/50
589/589 - 27s - loss: 9.6897 - accuracy10: 0.6387 - accuracy20: 0.6357 - accuracy30: 0.6159 - accuracy50: 0.5801 - val_loss: 11.4500 - val_accuracy10: 0.5362 - val_accuracy20: 0.5327 - val_accuracy30: 0.5211 - val_accuracy50: 0.5006 - 27s/epoch - 46ms/step
Epoch 18/50
589/589 - 27s - loss: 9.6278 - accuracy10: 0.6394 - accuracy20: 0.6377 - accuracy30: 0.6184 - accuracy50: 0.5821 - val_loss: 11.4786 - val_accuracy10: 0.5516 - val_accuracy20: 0.5449 - val_accuracy30: 0.5311 - val_accuracy50: 0.5094 - 27s/epoch - 46ms/step
Epoch 19/50
589/589 - 27s - loss: 9.5856 - accuracy10: 0.6414 - accuracy20: 0.6397 - accuracy30: 0.6201 - accuracy50: 0.5843 - val_loss: 11.6210 - val_accuracy10: 0.5495 - val_accuracy20: 0.5423 - val_accuracy30: 0.5280 - val_accuracy50: 0.5039 - 27s/epoch - 47ms/step
Epoch 20/50
589/589 - 27s - loss: 9.5642 - accuracy10: 0.6411 - accuracy20: 0.6404 - accuracy30: 0.6209 - accuracy50: 0.5858 - val_loss: 11.4818 - val_accuracy10: 0.5516 - val_accuracy20: 0.5461 - val_accuracy30: 0.5339 - val_accuracy50: 0.5108 - 27s/epoch - 46ms/step
Epoch 21/50
589/589 - 28s - loss: 9.5158 - accuracy10: 0.6428 - accuracy20: 0.6428 - accuracy30: 0.6240 - accuracy50: 0.5887 - val_loss: 11.8426 - val_accuracy10: 0.5236 - val_accuracy20: 0.5219 - val_accuracy30: 0.5107 - val_accuracy50: 0.4903 - 28s/epoch - 47ms/step
testing model: results/QRTEA/W0/deepLOB_L2/seq2seq
Evaluating performance on  test set...
2359/2359 - 38s - 38s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.799273
{'0': {'precision': 0.33754272380701983, 'recall': 0.49981750936785246, 'f1-score': 0.4029562351648782, 'support': 82196}, '1': {'precision': 0.9094074210200979, 'recall': 0.621032864278266, 'f1-score': 0.7380515279129867, 'support': 438257}, '2': {'precision': 0.32968253360395205, 'recall': 0.7231415371692567, 'f1-score': 0.45289073596717344, 'support': 83335}, 'accuracy': 0.618624417842024, 'macro avg': {'precision': 0.5255442261436899, 'recall': 0.6146639702717916, 'f1-score': 0.5312994996816794, 'support': 603788}, 'weighted avg': {'precision': 0.7515434619070471, 'recall': 0.618624417842024, 'f1-score': 0.6530757296534521, 'support': 603788}}
[[ 41083  15302  25811]
 [ 69368 272172  96717]
 [ 11261  11811  60263]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8212956
{'0': {'precision': 0.39166268794564935, 'recall': 0.47138618058499365, 'f1-score': 0.4278422353132294, 'support': 106155}, '1': {'precision': 0.8565790631766094, 'recall': 0.6253681932442644, 'f1-score': 0.7229370664693727, 'support': 389062}, '2': {'precision': 0.3932440879258256, 'recall': 0.6953514290187988, 'f1-score': 0.5023773003583418, 'support': 108571}, 'accuracy': 0.6108799777405315, 'macro avg': {'precision': 0.5471619463493614, 'recall': 0.5973686009493523, 'f1-score': 0.5510522007136479, 'support': 603788}, 'weighted avg': {'precision': 0.6915245417045108, 'recall': 0.6108799777405315, 'f1-score': 0.6313946937030688, 'support': 603788}}
[[ 50040  21544  34571]
 [ 63841 243307  81914]
 [ 13882  19194  75495]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.855154
{'0': {'precision': 0.4147124278988085, 'recall': 0.450783724852923, 'f1-score': 0.43199640436680187, 'support': 121535}, '1': {'precision': 0.8097793304048878, 'recall': 0.6142240411389562, 'f1-score': 0.6985740942633353, 'support': 356256}, '2': {'precision': 0.4215448304617813, 'recall': 0.6740160480011429, 'f1-score': 0.5186895338610378, 'support': 125997}, 'accuracy': 0.5938027917083479, 'macro avg': {'precision': 0.5486788629218259, 'recall': 0.5796746046643407, 'f1-score': 0.549753344163725, 'support': 603788}, 'weighted avg': {'precision': 0.649241462336281, 'recall': 0.5938027917083479, 'f1-score': 0.6073774581947425, 'support': 603788}}
[[ 54786  25875  40874]
 [ 61774 218821  75661]
 [ 15546  25527  84924]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.90676486
{'0': {'precision': 0.4374376887799186, 'recall': 0.4152825783654554, 'f1-score': 0.4260723200092073, 'support': 142633}, '1': {'precision': 0.7227063462771227, 'recall': 0.6022065464763563, 'f1-score': 0.6569767647193859, 'support': 308899}, '2': {'precision': 0.45191104538732796, 'recall': 0.6262216267339218, 'f1-score': 0.5249752229930624, 'support': 152256}, 'accuracy': 0.5641052819863925, 'macro avg': {'precision': 0.5373516934814564, 'recall': 0.5479035838585778, 'f1-score': 0.5360081025738852, 'support': 603788}, 'weighted avg': {'precision': 0.5870313514824674, 'recall': 0.5641052819863925, 'f1-score': 0.5691435842000149, 'support': 603788}}
[[ 59233  33635  49765]
 [ 57005 186021  65873]
 [ 19171  37739  95346]]
Evaluating performance on  train set...
589/589 - 10s - 10s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8271082
{'0': {'precision': 0.39201762172469345, 'recall': 0.5101176470588236, 'f1-score': 0.4433372992266508, 'support': 23375}, '1': {'precision': 0.8855705033811314, 'recall': 0.5942800675416379, 'f1-score': 0.7112568105225084, 'support': 104232}, '2': {'precision': 0.3463379750104289, 'recall': 0.7548272577712356, 'f1-score': 0.47481583354893175, 'support': 23098}, 'accuracy': 0.6058325868418434, 'macro avg': {'precision': 0.5413087000387513, 'recall': 0.6197416574572324, 'f1-score': 0.5431366477660303, 'support': 150705}, 'weighted avg': {'precision': 0.7263721254306604, 'recall': 0.6058325868418434, 'f1-score': 0.6334628935146033, 'support': 150705}}
[[11924  4796  6655]
 [16038 61943 26251]
 [ 2455  3208 17435]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.84564114
{'0': {'precision': 0.45609011673641486, 'recall': 0.4757606590737519, 'f1-score': 0.4657177740650302, 'support': 30467}, '1': {'precision': 0.8162675662184035, 'recall': 0.5976938924702598, 'f1-score': 0.690086898694921, 'support': 90282}, '2': {'precision': 0.40950830225116913, 'recall': 0.722025637601816, 'f1-score': 0.5226100298406485, 'support': 29956}, 'accuracy': 0.5977572077900534, 'macro avg': {'precision': 0.5606219950686625, 'recall': 0.5984933963819427, 'f1-score': 0.5594715675335332, 'support': 150705}, 'weighted avg': {'precision': 0.6626004226944977, 'recall': 0.5977572077900534, 'f1-score': 0.6114379407738336, 'support': 150705}}
[[14495  7003  8969]
 [14102 53961 22219]
 [ 3184  5143 21629]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8785786
{'0': {'precision': 0.47750221164699064, 'recall': 0.44785556922548714, 'f1-score': 0.46220398039331484, 'support': 34951}, '1': {'precision': 0.7570350913721031, 'recall': 0.5802408514503873, 'f1-score': 0.656951451722748, 'support': 81461}, '2': {'precision': 0.43410168147494005, 'recall': 0.7023882424984691, 'f1-score': 0.5365783025172643, 'support': 34293}, 'accuracy': 0.5773332006237352, 'macro avg': {'precision': 0.5562129948313447, 'recall': 0.5768282210581145, 'f1-score': 0.5519112448777758, 'support': 150705}, 'weighted avg': {'precision': 0.6187230970462625, 'recall': 0.5773332006237352, 'f1-score': 0.5843952971416879, 'support': 150705}}
[[15653  8596 10702]
 [13496 47267 20698]
 [ 3632  6574 24087]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.93406415
{'0': {'precision': 0.4902373887240356, 'recall': 0.4043120747883119, 'f1-score': 0.4431479842278909, 'support': 40862}, '1': {'precision': 0.6568727470584235, 'recall': 0.5542372638193478, 'f1-score': 0.6012060848928141, 'support': 69703}, '2': {'precision': 0.4527520492155414, 'recall': 0.656377678126557, 'f1-score': 0.5358730029593322, 'support': 40140}, 'accuracy': 0.5407916127533924, 'macro avg': {'precision': 0.5332873949993335, 'recall': 0.5383090055780723, 'f1-score': 0.5267423573600124, 'support': 150705}, 'weighted avg': {'precision': 0.5573242329170675, 'recall': 0.5407916127533924, 'f1-score': 0.5409490262804252, 'support': 150705}}
[[16521 11150 13191]
 [12416 38632 18655]
 [ 4763  9030 26347]]
Evaluating performance on  val set...
230/230 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8600997
{'0': {'precision': 0.39562930721799056, 'recall': 0.46159542953872196, 'f1-score': 0.42607421875, 'support': 9452}, '1': {'precision': 0.8763757556967912, 'recall': 0.5657318690115828, 'f1-score': 0.6875959681955699, 'support': 39973}, '2': {'precision': 0.3284973621975623, 'recall': 0.7688131985098456, 'f1-score': 0.46031290826243515, 'support': 9395}, 'accuracy': 0.5814348860931656, 'macro avg': {'precision': 0.5335008083707814, 'recall': 0.5987134990200501, 'f1-score': 0.5246610317360016, 'support': 58820}, 'weighted avg': {'precision': 0.7116132099989524, 'recall': 0.5814348860931656, 'f1-score': 0.6092683938359758, 'support': 58820}}
[[ 4363  1941  3148]
 [ 5742 22614 11617]
 [  923  1249  7223]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.87492675
{'0': {'precision': 0.45467128027681664, 'recall': 0.4296574838551459, 'f1-score': 0.4418106165678981, 'support': 12233}, '1': {'precision': 0.8069645149269181, 'recall': 0.567844759768072, 'f1-score': 0.6666096593241209, 'support': 34321}, '2': {'precision': 0.3919684971223333, 'recall': 0.7384640469590739, 'f1-score': 0.512113074204947, 'support': 12266}, 'accuracy': 0.5746854811288677, 'macro avg': {'precision': 0.551201430775356, 'recall': 0.5786554301940973, 'f1-score': 0.5401777833656554, 'support': 58820}, 'weighted avg': {'precision': 0.6471558734127099, 'recall': 0.5746854811288677, 'f1-score': 0.5876395504647421, 'support': 58820}}
[[ 5256  2695  4282]
 [ 5063 19489  9769]
 [ 1241  1967  9058]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.90274113
{'0': {'precision': 0.4767957187055774, 'recall': 0.40572079123381244, 'f1-score': 0.43839618652212353, 'support': 14054}, '1': {'precision': 0.7467934542237947, 'recall': 0.5520860580695789, 'f1-score': 0.6348460352671353, 'support': 30584}, '2': {'precision': 0.4192404436930436, 'recall': 0.7168946551967282, 'f1-score': 0.5290765748185153, 'support': 14182}, 'accuracy': 0.5568514110846651, 'macro avg': {'precision': 0.5476098722074719, 'recall': 0.5582338348333732, 'f1-score': 0.5341062655359248, 'support': 58820}, 'weighted avg': {'precision': 0.6033064605087294, 'recall': 0.5568514110846651, 'f1-score': 0.5624059015992549, 'support': 58820}}
[[ 5702  3180  5172]
 [ 4787 16885  8912]
 [ 1470  2545 10167]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9522364
{'0': {'precision': 0.49209453952730237, 'recall': 0.36580637343996125, 'f1-score': 0.4196552682791215, 'support': 16506}, '1': {'precision': 0.6436543442429951, 'recall': 0.5349929544387036, 'f1-score': 0.5843148152106534, 'support': 25548}, '2': {'precision': 0.44692869840015803, 'recall': 0.6748180842180603, 'f1-score': 0.5377248639528528, 'support': 16766}, 'accuracy': 0.527371642298538, 'macro avg': {'precision': 0.5275591940568184, 'recall': 0.5252058040322417, 'f1-score': 0.5138983158142092, 'support': 58820}, 'weighted avg': {'precision': 0.5450493065884859, 'recall': 0.527371642298538, 'f1-score': 0.5248282867434628, 'support': 58820}}
[[ 6038  4056  6412]
 [ 4291 13668  7589]
 [ 1941  3511 11314]]
training model: results/QRTEA/W0/deepOF_L2/seq2seq
Epoch 1/50
589/589 - 23s - loss: 12.0186 - accuracy10: 0.4954 - accuracy20: 0.4985 - accuracy30: 0.4909 - accuracy50: 0.4731 - val_loss: 11.7013 - val_accuracy10: 0.5630 - val_accuracy20: 0.5529 - val_accuracy30: 0.5362 - val_accuracy50: 0.4971 - 23s/epoch - 39ms/step
Epoch 2/50
589/589 - 17s - loss: 10.8311 - accuracy10: 0.6029 - accuracy20: 0.5977 - accuracy30: 0.5807 - accuracy50: 0.5462 - val_loss: 11.3813 - val_accuracy10: 0.6182 - val_accuracy20: 0.5959 - val_accuracy30: 0.5698 - val_accuracy50: 0.5228 - 17s/epoch - 28ms/step
Epoch 3/50
589/589 - 16s - loss: 10.5498 - accuracy10: 0.6167 - accuracy20: 0.6085 - accuracy30: 0.5887 - accuracy50: 0.5531 - val_loss: 11.2920 - val_accuracy10: 0.6353 - val_accuracy20: 0.6081 - val_accuracy30: 0.5776 - val_accuracy50: 0.5293 - 16s/epoch - 28ms/step
Epoch 4/50
589/589 - 16s - loss: 10.4160 - accuracy10: 0.6226 - accuracy20: 0.6131 - accuracy30: 0.5937 - accuracy50: 0.5577 - val_loss: 11.3698 - val_accuracy10: 0.6228 - val_accuracy20: 0.5957 - val_accuracy30: 0.5689 - val_accuracy50: 0.5266 - 16s/epoch - 27ms/step
Epoch 5/50
589/589 - 16s - loss: 10.3248 - accuracy10: 0.6238 - accuracy20: 0.6156 - accuracy30: 0.5966 - accuracy50: 0.5605 - val_loss: 11.2980 - val_accuracy10: 0.6320 - val_accuracy20: 0.6078 - val_accuracy30: 0.5794 - val_accuracy50: 0.5340 - 16s/epoch - 28ms/step
Epoch 6/50
589/589 - 16s - loss: 10.2377 - accuracy10: 0.6254 - accuracy20: 0.6186 - accuracy30: 0.6001 - accuracy50: 0.5637 - val_loss: 11.4282 - val_accuracy10: 0.6126 - val_accuracy20: 0.5864 - val_accuracy30: 0.5611 - val_accuracy50: 0.5219 - 16s/epoch - 28ms/step
Epoch 7/50
589/589 - 16s - loss: 10.1682 - accuracy10: 0.6295 - accuracy20: 0.6220 - accuracy30: 0.6027 - accuracy50: 0.5664 - val_loss: 11.3066 - val_accuracy10: 0.6176 - val_accuracy20: 0.5959 - val_accuracy30: 0.5699 - val_accuracy50: 0.5286 - 16s/epoch - 27ms/step
Epoch 8/50
589/589 - 16s - loss: 10.1051 - accuracy10: 0.6297 - accuracy20: 0.6246 - accuracy30: 0.6048 - accuracy50: 0.5685 - val_loss: 11.1679 - val_accuracy10: 0.6238 - val_accuracy20: 0.6005 - val_accuracy30: 0.5730 - val_accuracy50: 0.5304 - 16s/epoch - 28ms/step
Epoch 9/50
589/589 - 16s - loss: 10.0528 - accuracy10: 0.6302 - accuracy20: 0.6259 - accuracy30: 0.6071 - accuracy50: 0.5699 - val_loss: 11.2466 - val_accuracy10: 0.6261 - val_accuracy20: 0.6052 - val_accuracy30: 0.5781 - val_accuracy50: 0.5337 - 16s/epoch - 28ms/step
Epoch 10/50
589/589 - 16s - loss: 9.9973 - accuracy10: 0.6318 - accuracy20: 0.6282 - accuracy30: 0.6084 - accuracy50: 0.5724 - val_loss: 11.3370 - val_accuracy10: 0.6197 - val_accuracy20: 0.5967 - val_accuracy30: 0.5681 - val_accuracy50: 0.5237 - 16s/epoch - 27ms/step
Epoch 11/50
589/589 - 16s - loss: 9.9471 - accuracy10: 0.6341 - accuracy20: 0.6303 - accuracy30: 0.6115 - accuracy50: 0.5745 - val_loss: 11.4973 - val_accuracy10: 0.6185 - val_accuracy20: 0.5938 - val_accuracy30: 0.5675 - val_accuracy50: 0.5233 - 16s/epoch - 28ms/step
Epoch 12/50
589/589 - 16s - loss: 9.8997 - accuracy10: 0.6361 - accuracy20: 0.6332 - accuracy30: 0.6125 - accuracy50: 0.5755 - val_loss: 11.4355 - val_accuracy10: 0.6098 - val_accuracy20: 0.5906 - val_accuracy30: 0.5653 - val_accuracy50: 0.5231 - 16s/epoch - 28ms/step
Epoch 13/50
589/589 - 16s - loss: 9.8481 - accuracy10: 0.6363 - accuracy20: 0.6341 - accuracy30: 0.6149 - accuracy50: 0.5781 - val_loss: 11.3672 - val_accuracy10: 0.6165 - val_accuracy20: 0.5937 - val_accuracy30: 0.5668 - val_accuracy50: 0.5221 - 16s/epoch - 28ms/step
Epoch 14/50
589/589 - 16s - loss: 9.8129 - accuracy10: 0.6364 - accuracy20: 0.6346 - accuracy30: 0.6155 - accuracy50: 0.5794 - val_loss: 11.5596 - val_accuracy10: 0.6087 - val_accuracy20: 0.5888 - val_accuracy30: 0.5624 - val_accuracy50: 0.5197 - 16s/epoch - 27ms/step
Epoch 15/50
589/589 - 16s - loss: 9.7626 - accuracy10: 0.6365 - accuracy20: 0.6352 - accuracy30: 0.6176 - accuracy50: 0.5812 - val_loss: 11.3025 - val_accuracy10: 0.6091 - val_accuracy20: 0.5930 - val_accuracy30: 0.5688 - val_accuracy50: 0.5246 - 16s/epoch - 27ms/step
Epoch 16/50
589/589 - 16s - loss: 9.7204 - accuracy10: 0.6372 - accuracy20: 0.6363 - accuracy30: 0.6177 - accuracy50: 0.5818 - val_loss: 11.7118 - val_accuracy10: 0.5934 - val_accuracy20: 0.5748 - val_accuracy30: 0.5480 - val_accuracy50: 0.5080 - 16s/epoch - 28ms/step
Epoch 17/50
589/589 - 16s - loss: 9.6520 - accuracy10: 0.6396 - accuracy20: 0.6387 - accuracy30: 0.6210 - accuracy50: 0.5845 - val_loss: 11.8565 - val_accuracy10: 0.6001 - val_accuracy20: 0.5791 - val_accuracy30: 0.5509 - val_accuracy50: 0.5073 - 16s/epoch - 28ms/step
Epoch 18/50
589/589 - 16s - loss: 9.6260 - accuracy10: 0.6404 - accuracy20: 0.6391 - accuracy30: 0.6209 - accuracy50: 0.5846 - val_loss: 11.7085 - val_accuracy10: 0.6014 - val_accuracy20: 0.5840 - val_accuracy30: 0.5568 - val_accuracy50: 0.5115 - 16s/epoch - 28ms/step
testing model: results/QRTEA/W0/deepOF_L2/seq2seq
Evaluating performance on  test set...
2359/2359 - 22s - 22s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7780577
{'0': {'precision': 0.3003472618857234, 'recall': 0.6397790592987322, 'f1-score': 0.4087873817427063, 'support': 82194}, '1': {'precision': 0.8846837161417287, 'recall': 0.6646936950093096, 'f1-score': 0.7590709454837772, 'support': 438256}, '2': {'precision': 0.4365029872663998, 'recall': 0.5207780831123324, 'f1-score': 0.4749309184427239, 'support': 83333}, 'accuracy': 0.6414390600596572, 'macro avg': {'precision': 0.5405113217646172, 'recall': 0.6084169458067915, 'f1-score': 0.5475964152230691, 'support': 603783}, 'weighted avg': {'precision': 0.7432799416060332, 'recall': 0.6414390600596572, 'f1-score': 0.6721697771641232, 'support': 603783}}
[[ 52586  15192  14416]
 [105342 291306  41608]
 [ 17156  22779  43398]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.82375443
{'0': {'precision': 0.3394815021709875, 'recall': 0.629736043860806, 'f1-score': 0.4411470655197331, 'support': 106154}, '1': {'precision': 0.8213889645188496, 'recall': 0.6358395320026115, 'f1-score': 0.7168012100209203, 'support': 389062}, '2': {'precision': 0.49833481559975024, 'recall': 0.4851474204868883, 'f1-score': 0.49165270394518834, 'support': 108567}, 'accuracy': 0.6076703053911753, 'macro avg': {'precision': 0.5530684274298624, 'recall': 0.5835743321167687, 'f1-score': 0.5498669931619472, 'support': 603783}, 'weighted avg': {'precision': 0.6785737071436423, 'recall': 0.6076703053911753, 'f1-score': 0.6278528827005039, 'support': 603783}}
[[ 66849  20588  18717]
 [107375 247381  34306]
 [ 22691  33205  52671]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.86795527
{'0': {'precision': 0.36079746026866977, 'recall': 0.6181150953642602, 'f1-score': 0.4556369315683331, 'support': 121534}, '1': {'precision': 0.769141617142998, 'recall': 0.612865467528968, 'f1-score': 0.6821677573356536, 'support': 356256}, '2': {'precision': 0.5132362288609771, 'recall': 0.45501734223329865, 'f1-score': 0.4823765008792818, 'support': 125993}, 'accuracy': 0.5809835652875288, 'macro avg': {'precision': 0.5477251020908817, 'recall': 0.5619993017088423, 'f1-score': 0.5400603965944228, 'support': 603783}, 'weighted avg': {'precision': 0.6335465666904657, 'recall': 0.5809835652875288, 'f1-score': 0.5948789513349659, 'support': 603783}}
[[ 75122  24595  21817]
 [105364 218337  32555]
 [ 27725  40939  57329]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.93035245
{'0': {'precision': 0.38665643022994534, 'recall': 0.5790886974079968, 'f1-score': 0.4637007469536586, 'support': 142631}, '1': {'precision': 0.6791222304364694, 'recall': 0.6007206238932467, 'f1-score': 0.6375200339438999, 'support': 308899}, '2': {'precision': 0.5210683406169556, 'recall': 0.4001760228041484, 'f1-score': 0.4526900015602826, 'support': 152253}, 'accuracy': 0.545040188279564, 'macro avg': {'precision': 0.5289490004277901, 'recall': 0.526661781368464, 'f1-score': 0.5179702608192803, 'support': 603783}, 'weighted avg': {'precision': 0.5701776784435395, 'recall': 0.545040188279564, 'f1-score': 0.5498512098080629, 'support': 603783}}
[[ 82596  33272  26763]
 [ 94099 185562  29238]
 [ 36921  54404  60928]]
Evaluating performance on  train set...
589/589 - 7s - 7s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8046999
{'0': {'precision': 0.360077297452047, 'recall': 0.6443391393442623, 'f1-score': 0.4619834710743802, 'support': 23424}, '1': {'precision': 0.8764933913710755, 'recall': 0.635813962416262, 'f1-score': 0.73700195241883, 'support': 104194}, '2': {'precision': 0.418009335943382, 'recall': 0.6012301827947674, 'f1-score': 0.49315165834680497, 'support': 23086}, 'accuracy': 0.6318412251831405, 'macro avg': {'precision': 0.5515266749221682, 'recall': 0.6271277615184306, 'f1-score': 0.5640456939466717, 'support': 150704}, 'weighted avg': {'precision': 0.7259924525269634, 'recall': 0.6318412251831405, 'f1-score': 0.6569008217523635, 'support': 150704}}
[[15093  4230  4101]
 [22722 66248 15224]
 [ 4101  5105 13880]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.83257735
{'0': {'precision': 0.41502402033650015, 'recall': 0.6316393442622951, 'f1-score': 0.5009165485770746, 'support': 30500}, '1': {'precision': 0.8090057855174503, 'recall': 0.6211354195513709, 'f1-score': 0.7027308159863648, 'support': 90275}, '2': {'precision': 0.4860181849373821, 'recall': 0.5679441344515354, 'f1-score': 0.5237970509837758, 'support': 29929}, 'accuracy': 0.6126977386134409, 'macro avg': {'precision': 0.5700159969304442, 'recall': 0.6069062994217337, 'f1-score': 0.575814805182405, 'support': 150704}, 'weighted avg': {'precision': 0.6651267926852771, 'recall': 0.6126977386134409, 'f1-score': 0.6263516634174493, 'support': 150704}}
[[19265  5843  5392]
 [21618 56073 12584]
 [ 5536  7395 16998]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.87107325
{'0': {'precision': 0.4361855900975183, 'recall': 0.6122828074988569, 'f1-score': 0.5094458513155236, 'support': 34992}, '1': {'precision': 0.7504973704908932, 'recall': 0.5977227503869114, 'f1-score': 0.6654541725069227, 'support': 81414}, '2': {'precision': 0.5045177443936425, 'recall': 0.5404979882208876, 'f1-score': 0.5218884603474001, 'support': 34298}, 'accuracy': 0.5880799447924409, 'macro avg': {'precision': 0.5637335683273513, 'recall': 0.5835011820355519, 'f1-score': 0.5655961613899488, 'support': 150704}, 'weighted avg': {'precision': 0.6215359160145125, 'recall': 0.5880799447924409, 'f1-score': 0.5965571294903024, 'support': 150704}}
[[21425  7225  6342]
 [20887 48663 11864]
 [ 6807  8953 18538]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.93065536
{'0': {'precision': 0.45610653238655363, 'recall': 0.5669299039143297, 'f1-score': 0.505515587529976, 'support': 40901}, '1': {'precision': 0.6478487212338431, 'recall': 0.5736050084718991, 'f1-score': 0.6084704842996732, 'support': 69642}, '2': {'precision': 0.5115694691655324, 'recall': 0.48664126889270687, 'f1-score': 0.4987941045109424, 'support': 40161}, 'accuracy': 0.54861848391549, 'macro avg': {'precision': 0.538508240928643, 'recall': 0.5423920604263119, 'f1-score': 0.5375933921135306, 'support': 150704}, 'weighted avg': {'precision': 0.5594930152913439, 'recall': 0.54861848391549, 'f1-score': 0.5513009909785099, 'support': 150704}}
[[23188 10007  7706]
 [18741 39947 10954]
 [ 8910 11707 19544]]
Evaluating performance on  val set...
230/230 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.81728476
{'0': {'precision': 0.3630227717151328, 'recall': 0.6089302719288964, 'f1-score': 0.45486879544736014, 'support': 9451}, '1': {'precision': 0.8583434180449105, 'recall': 0.639389007136597, 'f1-score': 0.7328616735789217, 'support': 39935}, '2': {'precision': 0.4089120895748222, 'recall': 0.5729884448213718, 'f1-score': 0.4772416228864068, 'support': 9433}, 'accuracy': 0.6238460361447832, 'macro avg': {'precision': 0.5434260931116218, 'recall': 0.607102574628955, 'f1-score': 0.5549906973042296, 'support': 58819}, 'weighted avg': {'precision': 0.7066788003206875, 'recall': 0.6238460361447832, 'f1-score': 0.6471993088769736, 'support': 58819}}
[[ 5755  1936  1760]
 [ 8348 25534  6053]
 [ 1750  2278  5405]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.85112673
{'0': {'precision': 0.4149772209567198, 'recall': 0.5966104470280007, 'f1-score': 0.48948747229126083, 'support': 12214}, '1': {'precision': 0.7856278643446379, 'recall': 0.6247412461004694, 'f1-score': 0.6960080553480364, 'support': 34299}, '2': {'precision': 0.47368421052631576, 'recall': 0.538274012676743, 'f1-score': 0.503917839482693, 'support': 12306}, 'accuracy': 0.6008092623131981, 'macro avg': {'precision': 0.5580964319425578, 'recall': 0.586541901935071, 'f1-score': 0.5631377890406634, 'support': 58819}, 'weighted avg': {'precision': 0.6433965179730861, 'recall': 0.6008092623131981, 'f1-score': 0.6129344805185701, 'support': 58819}}
[[ 7287  2549  2378]
 [ 7889 21428  4982]
 [ 2384  3298  6624]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.89199215
{'0': {'precision': 0.43535478326260946, 'recall': 0.5782264393236783, 'f1-score': 0.49672121100692523, 'support': 14017}, '1': {'precision': 0.7212240094154571, 'recall': 0.600843219923522, 'f1-score': 0.6555529801914882, 'support': 30597}, '2': {'precision': 0.4940184883088635, 'recall': 0.5116508271735305, 'f1-score': 0.5026800843794308, 'support': 14205}, 'accuracy': 0.5739131913157313, 'macro avg': {'precision': 0.55019909366231, 'recall': 0.5635734954735769, 'f1-score': 0.5516514251926147, 'support': 58819}, 'weighted avg': {'precision': 0.5982283214523222, 'recall': 0.5739131913157313, 'f1-score': 0.5807828481989298, 'support': 58819}}
[[ 8105  3115  2797]
 [ 7566 18384  4647]
 [ 2946  3991  7268]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9558406
{'0': {'precision': 0.45218649850098214, 'recall': 0.5305998665615334, 'f1-score': 0.4882650071163453, 'support': 16487}, '1': {'precision': 0.6127251597908193, 'recall': 0.5782382202028906, 'f1-score': 0.5949823677581865, 'support': 25531}, '2': {'precision': 0.5030886273489824, 'recall': 0.4605083030771978, 'f1-score': 0.4808576755748913, 'support': 16801}, 'accuracy': 0.5312569067818222, 'macro avg': {'precision': 0.5226667618802613, 'recall': 0.5231154632805407, 'f1-score': 0.5213683501498076, 'support': 58819}, 'weighted avg': {'precision': 0.5364096105594341, 'recall': 0.5312569067818222, 'f1-score': 0.5324709670496811, 'support': 58819}}
[[ 8748  4214  3525]
 [ 6651 14763  4117]
 [ 3947  5117  7737]]
training model: results/QRTEA/W0/deepVOL_L2/seq2seq
Epoch 1/50
589/589 - 22s - loss: 11.7759 - accuracy10: 0.5092 - accuracy20: 0.5145 - accuracy30: 0.5097 - accuracy50: 0.4922 - val_loss: 11.8322 - val_accuracy10: 0.4729 - val_accuracy20: 0.4842 - val_accuracy30: 0.4827 - val_accuracy50: 0.4727 - 22s/epoch - 37ms/step
Epoch 2/50
589/589 - 15s - loss: 10.9857 - accuracy10: 0.5717 - accuracy20: 0.5721 - accuracy30: 0.5587 - accuracy50: 0.5314 - val_loss: 11.8338 - val_accuracy10: 0.5245 - val_accuracy20: 0.5189 - val_accuracy30: 0.5049 - val_accuracy50: 0.4838 - 15s/epoch - 26ms/step
Epoch 3/50
589/589 - 16s - loss: 10.7212 - accuracy10: 0.5937 - accuracy20: 0.5928 - accuracy30: 0.5778 - accuracy50: 0.5464 - val_loss: 11.5631 - val_accuracy10: 0.5482 - val_accuracy20: 0.5443 - val_accuracy30: 0.5291 - val_accuracy50: 0.5012 - 16s/epoch - 27ms/step
Epoch 4/50
589/589 - 16s - loss: 10.5347 - accuracy10: 0.6059 - accuracy20: 0.6038 - accuracy30: 0.5861 - accuracy50: 0.5526 - val_loss: 11.3931 - val_accuracy10: 0.5694 - val_accuracy20: 0.5630 - val_accuracy30: 0.5429 - val_accuracy50: 0.5110 - 16s/epoch - 27ms/step
Epoch 5/50
589/589 - 16s - loss: 10.3950 - accuracy10: 0.6114 - accuracy20: 0.6094 - accuracy30: 0.5908 - accuracy50: 0.5558 - val_loss: 11.2392 - val_accuracy10: 0.5785 - val_accuracy20: 0.5701 - val_accuracy30: 0.5489 - val_accuracy50: 0.5138 - 16s/epoch - 27ms/step
Epoch 6/50
589/589 - 16s - loss: 10.3061 - accuracy10: 0.6174 - accuracy20: 0.6135 - accuracy30: 0.5945 - accuracy50: 0.5580 - val_loss: 11.2934 - val_accuracy10: 0.5765 - val_accuracy20: 0.5649 - val_accuracy30: 0.5421 - val_accuracy50: 0.5056 - 16s/epoch - 26ms/step
Epoch 7/50
589/589 - 16s - loss: 10.2380 - accuracy10: 0.6191 - accuracy20: 0.6168 - accuracy30: 0.5977 - accuracy50: 0.5598 - val_loss: 11.2153 - val_accuracy10: 0.5752 - val_accuracy20: 0.5628 - val_accuracy30: 0.5409 - val_accuracy50: 0.5071 - 16s/epoch - 27ms/step
Epoch 8/50
589/589 - 16s - loss: 10.1818 - accuracy10: 0.6231 - accuracy20: 0.6191 - accuracy30: 0.5992 - accuracy50: 0.5616 - val_loss: 11.2173 - val_accuracy10: 0.5615 - val_accuracy20: 0.5546 - val_accuracy30: 0.5323 - val_accuracy50: 0.4979 - 16s/epoch - 27ms/step
Epoch 9/50
589/589 - 16s - loss: 10.1287 - accuracy10: 0.6239 - accuracy20: 0.6207 - accuracy30: 0.6002 - accuracy50: 0.5630 - val_loss: 11.1834 - val_accuracy10: 0.5553 - val_accuracy20: 0.5506 - val_accuracy30: 0.5306 - val_accuracy50: 0.4991 - 16s/epoch - 27ms/step
Epoch 10/50
589/589 - 16s - loss: 10.0952 - accuracy10: 0.6263 - accuracy20: 0.6223 - accuracy30: 0.6017 - accuracy50: 0.5643 - val_loss: 11.1607 - val_accuracy10: 0.5640 - val_accuracy20: 0.5573 - val_accuracy30: 0.5350 - val_accuracy50: 0.5020 - 16s/epoch - 27ms/step
Epoch 11/50
589/589 - 16s - loss: 10.0510 - accuracy10: 0.6270 - accuracy20: 0.6240 - accuracy30: 0.6039 - accuracy50: 0.5660 - val_loss: 11.0898 - val_accuracy10: 0.5745 - val_accuracy20: 0.5658 - val_accuracy30: 0.5424 - val_accuracy50: 0.5057 - 16s/epoch - 28ms/step
Epoch 12/50
589/589 - 16s - loss: 10.0007 - accuracy10: 0.6268 - accuracy20: 0.6253 - accuracy30: 0.6053 - accuracy50: 0.5683 - val_loss: 11.0930 - val_accuracy10: 0.5667 - val_accuracy20: 0.5617 - val_accuracy30: 0.5394 - val_accuracy50: 0.5053 - 16s/epoch - 27ms/step
Epoch 13/50
589/589 - 16s - loss: 9.9740 - accuracy10: 0.6287 - accuracy20: 0.6269 - accuracy30: 0.6074 - accuracy50: 0.5698 - val_loss: 11.0697 - val_accuracy10: 0.5743 - val_accuracy20: 0.5659 - val_accuracy30: 0.5409 - val_accuracy50: 0.5051 - 16s/epoch - 27ms/step
Epoch 14/50
589/589 - 16s - loss: 9.9307 - accuracy10: 0.6296 - accuracy20: 0.6276 - accuracy30: 0.6080 - accuracy50: 0.5718 - val_loss: 11.0312 - val_accuracy10: 0.5746 - val_accuracy20: 0.5663 - val_accuracy30: 0.5419 - val_accuracy50: 0.5058 - 16s/epoch - 27ms/step
Epoch 15/50
589/589 - 16s - loss: 9.9035 - accuracy10: 0.6330 - accuracy20: 0.6294 - accuracy30: 0.6096 - accuracy50: 0.5723 - val_loss: 11.0502 - val_accuracy10: 0.5827 - val_accuracy20: 0.5703 - val_accuracy30: 0.5432 - val_accuracy50: 0.5083 - 16s/epoch - 27ms/step
Epoch 16/50
589/589 - 16s - loss: 9.8759 - accuracy10: 0.6324 - accuracy20: 0.6292 - accuracy30: 0.6102 - accuracy50: 0.5730 - val_loss: 11.1016 - val_accuracy10: 0.5868 - val_accuracy20: 0.5729 - val_accuracy30: 0.5467 - val_accuracy50: 0.5108 - 16s/epoch - 27ms/step
Epoch 17/50
589/589 - 16s - loss: 9.8436 - accuracy10: 0.6345 - accuracy20: 0.6307 - accuracy30: 0.6106 - accuracy50: 0.5746 - val_loss: 11.1239 - val_accuracy10: 0.5826 - val_accuracy20: 0.5678 - val_accuracy30: 0.5408 - val_accuracy50: 0.5068 - 16s/epoch - 27ms/step
Epoch 18/50
589/589 - 16s - loss: 9.8109 - accuracy10: 0.6347 - accuracy20: 0.6312 - accuracy30: 0.6107 - accuracy50: 0.5754 - val_loss: 11.2308 - val_accuracy10: 0.5886 - val_accuracy20: 0.5722 - val_accuracy30: 0.5431 - val_accuracy50: 0.5063 - 16s/epoch - 27ms/step
Epoch 19/50
589/589 - 16s - loss: 9.7797 - accuracy10: 0.6356 - accuracy20: 0.6320 - accuracy30: 0.6130 - accuracy50: 0.5775 - val_loss: 11.1780 - val_accuracy10: 0.5766 - val_accuracy20: 0.5613 - val_accuracy30: 0.5341 - val_accuracy50: 0.5027 - 16s/epoch - 27ms/step
Epoch 20/50
589/589 - 15s - loss: 9.7585 - accuracy10: 0.6367 - accuracy20: 0.6328 - accuracy30: 0.6128 - accuracy50: 0.5777 - val_loss: 11.0939 - val_accuracy10: 0.5933 - val_accuracy20: 0.5755 - val_accuracy30: 0.5481 - val_accuracy50: 0.5107 - 15s/epoch - 26ms/step
Epoch 21/50
589/589 - 16s - loss: 9.7274 - accuracy10: 0.6369 - accuracy20: 0.6340 - accuracy30: 0.6149 - accuracy50: 0.5794 - val_loss: 11.2528 - val_accuracy10: 0.5846 - val_accuracy20: 0.5678 - val_accuracy30: 0.5378 - val_accuracy50: 0.5030 - 16s/epoch - 26ms/step
Epoch 22/50
589/589 - 16s - loss: 9.6900 - accuracy10: 0.6380 - accuracy20: 0.6350 - accuracy30: 0.6156 - accuracy50: 0.5809 - val_loss: 11.2846 - val_accuracy10: 0.5758 - val_accuracy20: 0.5586 - val_accuracy30: 0.5314 - val_accuracy50: 0.4986 - 16s/epoch - 27ms/step
Epoch 23/50
589/589 - 16s - loss: 9.6678 - accuracy10: 0.6380 - accuracy20: 0.6347 - accuracy30: 0.6165 - accuracy50: 0.5804 - val_loss: 11.2702 - val_accuracy10: 0.5862 - val_accuracy20: 0.5691 - val_accuracy30: 0.5426 - val_accuracy50: 0.5075 - 16s/epoch - 27ms/step
Epoch 24/50
589/589 - 16s - loss: 9.6380 - accuracy10: 0.6399 - accuracy20: 0.6373 - accuracy30: 0.6180 - accuracy50: 0.5823 - val_loss: 11.1974 - val_accuracy10: 0.5830 - val_accuracy20: 0.5672 - val_accuracy30: 0.5402 - val_accuracy50: 0.5091 - 16s/epoch - 27ms/step
testing model: results/QRTEA/W0/deepVOL_L2/seq2seq
Evaluating performance on  test set...
2359/2359 - 21s - 21s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8358005
{'0': {'precision': 0.40054584922759173, 'recall': 0.46244342790403425, 'f1-score': 0.42927484838560315, 'support': 82196}, '1': {'precision': 0.9020790776276006, 'recall': 0.58342023059529, 'f1-score': 0.7085714285714286, 'support': 438257}, '2': {'precision': 0.29063593660594284, 'recall': 0.7862602747945041, 'f1-score': 0.4243964997959725, 'support': 83335}, 'accuracy': 0.5949472331348089, 'macro avg': {'precision': 0.531086954487045, 'recall': 0.6107079777646094, 'f1-score': 0.5207475922510013, 'support': 603788}, 'weighted avg': {'precision': 0.7494118510536923, 'recall': 0.5949472331348089, 'f1-score': 0.6313277943911256, 'support': 603788}}
[[ 38011  18875  25310]
 [ 47955 255688 134614]
 [  8932   8880  65523]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8525056
{'0': {'precision': 0.4615200955033824, 'recall': 0.4370213367246008, 'f1-score': 0.4489367364219185, 'support': 106155}, '1': {'precision': 0.8452226496835408, 'recall': 0.5776817062576145, 'f1-score': 0.686300045956093, 'support': 389062}, '2': {'precision': 0.34875314399828106, 'recall': 0.7624411675309245, 'f1-score': 0.4785909206540089, 'support': 108571}, 'accuracy': 0.5861742863389137, 'macro avg': {'precision': 0.5518319630617348, 'recall': 0.5923814035043798, 'f1-score': 0.5379425676773401, 'support': 603788}, 'weighted avg': {'precision': 0.6884886050507408, 'recall': 0.5861742863389137, 'f1-score': 0.6072184981830785, 'support': 603788}}
[[ 46392  26679  33084]
 [ 42814 224754 121494]
 [ 11314  14478  82779]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8867208
{'0': {'precision': 0.47623139396291264, 'recall': 0.4241000534825359, 'f1-score': 0.44865645918020947, 'support': 121535}, '1': {'precision': 0.7976830543502424, 'recall': 0.5438841731788376, 'f1-score': 0.646776664741756, 'support': 356256}, '2': {'precision': 0.37280675714721095, 'recall': 0.7475574815273379, 'f1-score': 0.49750691935517943, 'support': 125997}, 'accuracy': 0.5622751694303298, 'macro avg': {'precision': 0.5489070684867886, 'recall': 0.5718472360629038, 'f1-score': 0.530980014425715, 'support': 603788}, 'weighted avg': {'precision': 0.6443166966818813, 'recall': 0.5622751694303298, 'f1-score': 0.5757482917161326, 'support': 603788}}
[[ 51543  30784  39208]
 [ 43241 193762 119253]
 [ 13447  18360  94190]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9368886
{'0': {'precision': 0.48388806716653987, 'recall': 0.3968015816816585, 'f1-score': 0.4360390761028676, 'support': 142633}, '1': {'precision': 0.7074606427658968, 'recall': 0.4984121023376573, 'f1-score': 0.5848161801713512, 'support': 308899}, '2': {'precision': 0.4015594179856837, 'recall': 0.7099950084068937, 'f1-score': 0.5129846556841828, 'support': 152256}, 'accuracy': 0.5277630559070402, 'macro avg': {'precision': 0.5309693759727068, 'recall': 0.5350695641420699, 'f1-score': 0.5112799706528005, 'support': 603788}, 'weighted avg': {'precision': 0.5775075399291408, 'recall': 0.5277630559070402, 'f1-score': 0.5315569148714142, 'support': 603788}}
[[ 56597  37061  48975]
 [ 42813 153959 112127]
 [ 17553  26602 108101]]
Evaluating performance on  train set...
589/589 - 6s - 6s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.852806
{'0': {'precision': 0.3673847003590168, 'recall': 0.5691122994652407, 'f1-score': 0.44652177561466816, 'support': 23375}, '1': {'precision': 0.8841397849462366, 'recall': 0.5679829610868063, 'f1-score': 0.6916444693677274, 'support': 104232}, '2': {'precision': 0.34589250026296414, 'recall': 0.7118365226426531, 'f1-score': 0.46556142313083126, 'support': 23098}, 'accuracy': 0.5902060316512392, 'macro avg': {'precision': 0.5324723285227392, 'recall': 0.6163105943982333, 'f1-score': 0.5345758893710756, 'support': 150705}, 'weighted avg': {'precision': 0.7214936492251889, 'recall': 0.5902060316512392, 'f1-score': 0.6189739596403953, 'support': 150705}}
[[13303  4307  5765]
 [19702 59202 25328]
 [ 3205  3451 16442]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.86209357
{'0': {'precision': 0.4362042945272578, 'recall': 0.5407490071224603, 'f1-score': 0.4828829356937687, 'support': 30467}, '1': {'precision': 0.8127940989444232, 'recall': 0.5663144369863318, 'f1-score': 0.6675283642108287, 'support': 90282}, '2': {'precision': 0.4068396226415094, 'recall': 0.6794965950060088, 'f1-score': 0.5089513427014052, 'support': 29956}, 'accuracy': 0.5836435420191766, 'macro avg': {'precision': 0.5519460053710635, 'recall': 0.595520013038267, 'f1-score': 0.5531208808686675, 'support': 150705}, 'weighted avg': {'precision': 0.655968951382578, 'recall': 0.5836435420191766, 'f1-score': 0.5986791188177392, 'support': 150705}}
[[16475  6456  7536]
 [17013 51128 22141]
 [ 4281  5320 20355]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8932285
{'0': {'precision': 0.45636893106391524, 'recall': 0.5201281794512317, 'f1-score': 0.48616701210135715, 'support': 34951}, '1': {'precision': 0.7522770874021327, 'recall': 0.5343170351456525, 'f1-score': 0.6248349124318117, 'support': 81461}, '2': {'precision': 0.42720516109560097, 'recall': 0.6603971656023095, 'f1-score': 0.5188019013802188, 'support': 34293}, 'accuracy': 0.5597160014598056, 'macro avg': {'precision': 0.5452837265205496, 'recall': 0.5716141267330646, 'f1-score': 0.5432679419711292, 'support': 150705}, 'weighted avg': {'precision': 0.6096807731391227, 'recall': 0.5597160014598056, 'f1-score': 0.5685476503473288, 'support': 150705}}
[[18179  7805  8967]
 [16537 43526 21398]
 [ 5118  6528 22647]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.94515944
{'0': {'precision': 0.47095911348872754, 'recall': 0.4825999706328618, 'f1-score': 0.4767084874416806, 'support': 40862}, '1': {'precision': 0.6513521153302554, 'recall': 0.4958753568712968, 'f1-score': 0.5630783265997654, 'support': 69703}, '2': {'precision': 0.44613398364653567, 'recall': 0.6198305929247633, 'f1-score': 0.518830545939859, 'support': 40140}, 'accuracy': 0.5252911316810989, 'macro avg': {'precision': 0.5228150708218395, 'recall': 0.532768640142974, 'f1-score': 0.5195391199937683, 'support': 150705}, 'weighted avg': {'precision': 0.5477810682712128, 'recall': 0.5252911316810989, 'f1-score': 0.5278747813732214, 'support': 150705}}
[[19720  9989 11153]
 [15404 34564 19735]
 [ 6748  8512 24880]]
Evaluating performance on  val set...
230/230 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.88625205
{'0': {'precision': 0.393453985367732, 'recall': 0.5405205247566652, 'f1-score': 0.4554084770691269, 'support': 9452}, '1': {'precision': 0.8669388402235523, 'recall': 0.5471693393040302, 'f1-score': 0.6708996656544278, 'support': 39973}, '2': {'precision': 0.3303406774725808, 'recall': 0.7245343267695583, 'f1-score': 0.45378487383753874, 'support': 9395}, 'accuracy': 0.5744304658279497, 'macro avg': {'precision': 0.5302445010212883, 'recall': 0.6040747302767513, 'f1-score': 0.5266976721870311, 'support': 58820}, 'weighted avg': {'precision': 0.7051449166067113, 'recall': 0.5744304658279497, 'f1-score': 0.6015930321347418, 'support': 58820}}
[[ 5109  2046  2297]
 [ 6599 21872 11502]
 [ 1277  1311  6807]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.89646554
{'0': {'precision': 0.4575910856975295, 'recall': 0.5102591351262977, 'f1-score': 0.4824920769884826, 'support': 12233}, '1': {'precision': 0.7896600264471271, 'recall': 0.5393782232452434, 'f1-score': 0.6409528426009279, 'support': 34321}, '2': {'precision': 0.3911483253588517, 'recall': 0.6931354964943747, 'f1-score': 0.5000882301041115, 'support': 12266}, 'accuracy': 0.5653859231553893, 'macro avg': {'precision': 0.5461331458345028, 'recall': 0.5809242849553052, 'f1-score': 0.5411777165645074, 'support': 58820}, 'weighted avg': {'precision': 0.6374950506270214, 'recall': 0.5653859231553893, 'f1-score': 0.578622072750146, 'support': 58820}}
[[ 6242  2894  3097]
 [ 5672 18512 10137]
 [ 1727  2037  8502]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.92569774
{'0': {'precision': 0.475133153489659, 'recall': 0.48875764906788105, 'f1-score': 0.481849110869489, 'support': 14054}, '1': {'precision': 0.7254855852889996, 'recall': 0.5043813758828145, 'f1-score': 0.5950585376203059, 'support': 30584}, '2': {'precision': 0.4163203463203463, 'recall': 0.6781131011140883, 'f1-score': 0.5159057990451156, 'support': 14182}, 'accuracy': 0.5425365521931316, 'macro avg': {'precision': 0.5389796950330017, 'recall': 0.5570840420215947, 'f1-score': 0.5309378158449701, 'support': 58820}, 'weighted avg': {'precision': 0.591125937285576, 'recall': 0.5425365521931316, 'f1-score': 0.5489247494185152, 'support': 58820}}
[[ 6869  3353  3832]
 [ 5507 15426  9651]
 [ 2081  2484  9617]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.97277313
{'0': {'precision': 0.4832682291666667, 'recall': 0.4497152550587665, 'f1-score': 0.46588840770727424, 'support': 16506}, '1': {'precision': 0.6129321720770652, 'recall': 0.45451698763112575, 'f1-score': 0.5219697480502551, 'support': 25548}, '2': {'precision': 0.43871099326942686, 'recall': 0.6414767982822379, 'f1-score': 0.5210629587461545, 'support': 16766}, 'accuracy': 0.5064603876232574, 'macro avg': {'precision': 0.5116371315043863, 'recall': 0.5152363469907101, 'f1-score': 0.5029737048345613, 'support': 58820}, 'weighted avg': {'precision': 0.5268861787828132, 'recall': 0.5064603876232574, 'f1-score': 0.5059737971292454, 'support': 58820}}
[[ 7423  4094  4989]
 [ 5165 11612  8771]
 [ 2772  3239 10755]]
training model: results/QRTEA/W0/deepVOL_L3/seq2seq
Epoch 1/50
589/589 - 31s - loss: 12.3247 - accuracy10: 0.4885 - accuracy20: 0.4875 - accuracy30: 0.4790 - accuracy50: 0.4633 - val_loss: 11.9539 - val_accuracy10: 0.4471 - val_accuracy20: 0.4642 - val_accuracy30: 0.4707 - val_accuracy50: 0.4668 - 31s/epoch - 52ms/step
Epoch 2/50
589/589 - 23s - loss: 11.2433 - accuracy10: 0.5583 - accuracy20: 0.5566 - accuracy30: 0.5465 - accuracy50: 0.5236 - val_loss: 11.7545 - val_accuracy10: 0.5264 - val_accuracy20: 0.5187 - val_accuracy30: 0.5043 - val_accuracy50: 0.4803 - 23s/epoch - 40ms/step
Epoch 3/50
589/589 - 24s - loss: 10.7829 - accuracy10: 0.5944 - accuracy20: 0.5899 - accuracy30: 0.5744 - accuracy50: 0.5444 - val_loss: 11.3997 - val_accuracy10: 0.5210 - val_accuracy20: 0.5195 - val_accuracy30: 0.5060 - val_accuracy50: 0.4831 - 24s/epoch - 41ms/step
Epoch 4/50
589/589 - 23s - loss: 10.5750 - accuracy10: 0.6068 - accuracy20: 0.6017 - accuracy30: 0.5839 - accuracy50: 0.5513 - val_loss: 11.2513 - val_accuracy10: 0.5433 - val_accuracy20: 0.5409 - val_accuracy30: 0.5253 - val_accuracy50: 0.4962 - 23s/epoch - 40ms/step
Epoch 5/50
589/589 - 23s - loss: 10.4022 - accuracy10: 0.6155 - accuracy20: 0.6099 - accuracy30: 0.5906 - accuracy50: 0.5547 - val_loss: 11.1766 - val_accuracy10: 0.5614 - val_accuracy20: 0.5535 - val_accuracy30: 0.5350 - val_accuracy50: 0.5025 - 23s/epoch - 40ms/step
Epoch 6/50
589/589 - 23s - loss: 10.2556 - accuracy10: 0.6210 - accuracy20: 0.6153 - accuracy30: 0.5957 - accuracy50: 0.5601 - val_loss: 10.9667 - val_accuracy10: 0.5670 - val_accuracy20: 0.5648 - val_accuracy30: 0.5476 - val_accuracy50: 0.5173 - 23s/epoch - 40ms/step
Epoch 7/50
589/589 - 24s - loss: 10.1822 - accuracy10: 0.6220 - accuracy20: 0.6171 - accuracy30: 0.5979 - accuracy50: 0.5616 - val_loss: 10.9736 - val_accuracy10: 0.5583 - val_accuracy20: 0.5565 - val_accuracy30: 0.5413 - val_accuracy50: 0.5115 - 24s/epoch - 40ms/step
Epoch 8/50
589/589 - 23s - loss: 10.1080 - accuracy10: 0.6250 - accuracy20: 0.6202 - accuracy30: 0.6004 - accuracy50: 0.5626 - val_loss: 10.9540 - val_accuracy10: 0.5763 - val_accuracy20: 0.5703 - val_accuracy30: 0.5499 - val_accuracy50: 0.5172 - 23s/epoch - 40ms/step
Epoch 9/50
589/589 - 23s - loss: 10.0544 - accuracy10: 0.6279 - accuracy20: 0.6227 - accuracy30: 0.6035 - accuracy50: 0.5657 - val_loss: 10.8789 - val_accuracy10: 0.5951 - val_accuracy20: 0.5825 - val_accuracy30: 0.5595 - val_accuracy50: 0.5227 - 23s/epoch - 39ms/step
Epoch 10/50
589/589 - 23s - loss: 10.0076 - accuracy10: 0.6303 - accuracy20: 0.6246 - accuracy30: 0.6046 - accuracy50: 0.5671 - val_loss: 10.9258 - val_accuracy10: 0.5984 - val_accuracy20: 0.5851 - val_accuracy30: 0.5605 - val_accuracy50: 0.5238 - 23s/epoch - 39ms/step
Epoch 11/50
589/589 - 23s - loss: 9.9620 - accuracy10: 0.6291 - accuracy20: 0.6260 - accuracy30: 0.6063 - accuracy50: 0.5698 - val_loss: 10.9050 - val_accuracy10: 0.5986 - val_accuracy20: 0.5863 - val_accuracy30: 0.5612 - val_accuracy50: 0.5233 - 23s/epoch - 39ms/step
Epoch 12/50
589/589 - 23s - loss: 9.9332 - accuracy10: 0.6321 - accuracy20: 0.6281 - accuracy30: 0.6091 - accuracy50: 0.5708 - val_loss: 10.8806 - val_accuracy10: 0.5934 - val_accuracy20: 0.5837 - val_accuracy30: 0.5614 - val_accuracy50: 0.5254 - 23s/epoch - 39ms/step
Epoch 13/50
589/589 - 23s - loss: 9.8802 - accuracy10: 0.6327 - accuracy20: 0.6283 - accuracy30: 0.6092 - accuracy50: 0.5714 - val_loss: 10.8444 - val_accuracy10: 0.5967 - val_accuracy20: 0.5854 - val_accuracy30: 0.5620 - val_accuracy50: 0.5268 - 23s/epoch - 40ms/step
Epoch 14/50
589/589 - 24s - loss: 9.8424 - accuracy10: 0.6340 - accuracy20: 0.6300 - accuracy30: 0.6106 - accuracy50: 0.5741 - val_loss: 10.9655 - val_accuracy10: 0.5879 - val_accuracy20: 0.5781 - val_accuracy30: 0.5543 - val_accuracy50: 0.5201 - 24s/epoch - 40ms/step
Epoch 15/50
589/589 - 23s - loss: 9.8166 - accuracy10: 0.6347 - accuracy20: 0.6313 - accuracy30: 0.6116 - accuracy50: 0.5746 - val_loss: 10.9595 - val_accuracy10: 0.5979 - val_accuracy20: 0.5845 - val_accuracy30: 0.5599 - val_accuracy50: 0.5240 - 23s/epoch - 40ms/step
Epoch 16/50
589/589 - 23s - loss: 9.7731 - accuracy10: 0.6348 - accuracy20: 0.6320 - accuracy30: 0.6129 - accuracy50: 0.5768 - val_loss: 10.9953 - val_accuracy10: 0.5993 - val_accuracy20: 0.5865 - val_accuracy30: 0.5610 - val_accuracy50: 0.5221 - 23s/epoch - 40ms/step
Epoch 17/50
589/589 - 23s - loss: 9.7402 - accuracy10: 0.6369 - accuracy20: 0.6331 - accuracy30: 0.6137 - accuracy50: 0.5773 - val_loss: 11.0892 - val_accuracy10: 0.5837 - val_accuracy20: 0.5713 - val_accuracy30: 0.5485 - val_accuracy50: 0.5151 - 23s/epoch - 39ms/step
Epoch 18/50
589/589 - 24s - loss: 9.7156 - accuracy10: 0.6364 - accuracy20: 0.6339 - accuracy30: 0.6148 - accuracy50: 0.5783 - val_loss: 11.0528 - val_accuracy10: 0.5856 - val_accuracy20: 0.5744 - val_accuracy30: 0.5508 - val_accuracy50: 0.5189 - 24s/epoch - 41ms/step
Epoch 19/50
589/589 - 24s - loss: 9.6855 - accuracy10: 0.6367 - accuracy20: 0.6345 - accuracy30: 0.6160 - accuracy50: 0.5803 - val_loss: 11.2118 - val_accuracy10: 0.5829 - val_accuracy20: 0.5716 - val_accuracy30: 0.5501 - val_accuracy50: 0.5166 - 24s/epoch - 41ms/step
Epoch 20/50
589/589 - 24s - loss: 9.6603 - accuracy10: 0.6384 - accuracy20: 0.6349 - accuracy30: 0.6169 - accuracy50: 0.5817 - val_loss: 11.1364 - val_accuracy10: 0.5907 - val_accuracy20: 0.5753 - val_accuracy30: 0.5502 - val_accuracy50: 0.5147 - 24s/epoch - 40ms/step
Epoch 21/50
589/589 - 24s - loss: 9.6238 - accuracy10: 0.6387 - accuracy20: 0.6365 - accuracy30: 0.6183 - accuracy50: 0.5824 - val_loss: 11.2627 - val_accuracy10: 0.5940 - val_accuracy20: 0.5771 - val_accuracy30: 0.5526 - val_accuracy50: 0.5175 - 24s/epoch - 40ms/step
Epoch 22/50
589/589 - 24s - loss: 9.5972 - accuracy10: 0.6383 - accuracy20: 0.6357 - accuracy30: 0.6174 - accuracy50: 0.5831 - val_loss: 11.2299 - val_accuracy10: 0.5745 - val_accuracy20: 0.5624 - val_accuracy30: 0.5372 - val_accuracy50: 0.5030 - 24s/epoch - 41ms/step
Epoch 23/50
589/589 - 24s - loss: 9.5663 - accuracy10: 0.6403 - accuracy20: 0.6368 - accuracy30: 0.6198 - accuracy50: 0.5854 - val_loss: 11.2390 - val_accuracy10: 0.5754 - val_accuracy20: 0.5637 - val_accuracy30: 0.5407 - val_accuracy50: 0.5108 - 24s/epoch - 41ms/step
testing model: results/QRTEA/W0/deepVOL_L3/seq2seq
Evaluating performance on  test set...
2359/2359 - 36s - 36s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7681941
{'0': {'precision': 0.3962127316680097, 'recall': 0.4785634337437345, 'f1-score': 0.4335118693380943, 'support': 82196}, '1': {'precision': 0.9065935117547609, 'recall': 0.6484962020001962, 'f1-score': 0.756126728806367, 'support': 438257}, '2': {'precision': 0.3343611596812866, 'recall': 0.766412671746565, 'f1-score': 0.4655972415100254, 'support': 83335}, 'accuracy': 0.641637462155591, 'macro avg': {'precision': 0.5457224677013524, 'recall': 0.6311574358301653, 'f1-score': 0.5517452798848289, 'support': 603788}, 'weighted avg': {'precision': 0.7581337184828614, 'recall': 0.641637462155591, 'f1-score': 0.672108951353528, 'support': 603788}}
[[ 39336  18796  24064]
 [ 50964 284208 103085]
 [  8980  10486  63869]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7943189
{'0': {'precision': 0.4501896216816206, 'recall': 0.4584805237624229, 'f1-score': 0.4542972487340443, 'support': 106155}, '1': {'precision': 0.8512290965359974, 'recall': 0.6447481378289321, 'f1-score': 0.7337389396709324, 'support': 389062}, '2': {'precision': 0.3955569928852182, 'recall': 0.7322673642132798, 'f1-score': 0.5136499752875847, 'support': 108571}, 'accuracy': 0.6277368877818043, 'macro avg': {'precision': 0.5656585703676121, 'recall': 0.611832008601545, 'f1-score': 0.5672287212308539, 'support': 603788}, 'weighted avg': {'precision': 0.6987830038368462, 'recall': 0.6277368877818043, 'f1-score': 0.6450332819674507, 'support': 603788}}
[[ 48670  26891  30594]
 [ 47322 250847  90893]
 [ 12118  16950  79503]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8341547
{'0': {'precision': 0.4666539501976833, 'recall': 0.4428518533755708, 'f1-score': 0.45444144703235095, 'support': 121535}, '1': {'precision': 0.8023669576742444, 'recall': 0.6253424503727657, 'f1-score': 0.7028798950011989, 'support': 356256}, '2': {'precision': 0.4210421450122393, 'recall': 0.7044135971491384, 'f1-score': 0.5270537095485951, 'support': 125997}, 'accuracy': 0.6051097405049455, 'macro avg': {'precision': 0.563354350961389, 'recall': 0.5908693002991584, 'f1-score': 0.5614583505273817, 'support': 603788}, 'weighted avg': {'precision': 0.6552181856141198, 'recall': 0.6051097405049455, 'f1-score': 0.6161813540193217, 'support': 603788}}
[[ 53822  32204  35509]
 [ 46941 222782  86533]
 [ 14573  22670  88754]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8963759
{'0': {'precision': 0.4742702156773311, 'recall': 0.40824353410501074, 'f1-score': 0.43878692885320386, 'support': 142633}, '1': {'precision': 0.7115444312864321, 'recall': 0.6010508289117155, 'f1-score': 0.6516469824333574, 'support': 308899}, '2': {'precision': 0.4498162040339693, 'recall': 0.6501944094157209, 'f1-score': 0.5317548350016249, 'support': 152256}, 'accuracy': 0.5678963477246981, 'macro avg': {'precision': 0.5452102836659108, 'recall': 0.553162924144149, 'f1-score': 0.5407295820960621, 'support': 603788}, 'weighted avg': {'precision': 0.5894936019166468, 'recall': 0.5678963477246981, 'f1-score': 0.5711300347271031, 'support': 603788}}
[[ 58229  41202  43202]
 [ 45352 185664  77883]
 [ 19195  34065  98996]]
Evaluating performance on  train set...
589/589 - 10s - 10s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.82713556
{'0': {'precision': 0.37560210597065086, 'recall': 0.5737754010695187, 'f1-score': 0.4540053822588562, 'support': 23375}, '1': {'precision': 0.8886720991621715, 'recall': 0.594289661524292, 'f1-score': 0.7122619814184528, 'support': 104232}, '2': {'precision': 0.3636102709027885, 'recall': 0.7130054550177505, 'f1-score': 0.48161307774414763, 'support': 23098}, 'accuracy': 0.6093029428353406, 'macro avg': {'precision': 0.542628158678537, 'recall': 0.6270235058705204, 'f1-score': 0.5492934804738189, 'support': 150705}, 'weighted avg': {'precision': 0.7286184234381609, 'recall': 0.6093029428353406, 'f1-score': 0.6368545537788611, 'support': 150705}}
[[13412  4391  5572]
 [19036 61944 23252]
 [ 3260  3369 16469]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8394255
{'0': {'precision': 0.44069831163069856, 'recall': 0.5543046574982768, 'f1-score': 0.49101587486189446, 'support': 30467}, '1': {'precision': 0.819444231329886, 'recall': 0.5915243348618773, 'f1-score': 0.6870758364264441, 'support': 90282}, '2': {'precision': 0.42725520513417914, 'recall': 0.6733876351982908, 'f1-score': 0.5228006064611438, 'support': 29956}, 'accuracy': 0.6002720546763545, 'macro avg': {'precision': 0.5624659160315879, 'recall': 0.6064055425194816, 'f1-score': 0.5669641059164942, 'support': 150705}, 'weighted avg': {'precision': 0.6649193887288194, 'recall': 0.6002720546763545, 'f1-score': 0.6147863461120705, 'support': 150705}}
[[16888  6432  7147]
 [16984 53404 19894]
 [ 4449  5335 20172]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.871646
{'0': {'precision': 0.4624433492657074, 'recall': 0.5342622528683013, 'f1-score': 0.49576529934952873, 'support': 34951}, '1': {'precision': 0.7582467979165984, 'recall': 0.5682964854347479, 'f1-score': 0.6496719643546293, 'support': 81461}, '2': {'precision': 0.4500527683065433, 'recall': 0.6466334237307906, 'f1-score': 0.5307245856518877, 'support': 34293}, 'accuracy': 0.5782289904117315, 'macro avg': {'precision': 0.5569143051629496, 'recall': 0.5830640540112798, 'f1-score': 0.5587206164520152, 'support': 150705}, 'weighted avg': {'precision': 0.6195153411552773, 'recall': 0.5782289904117315, 'f1-score': 0.5869119079102751, 'support': 150705}}
[[18673  7951  8327]
 [16397 46294 18770]
 [ 5309  6809 22175]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.92848426
{'0': {'precision': 0.47838691430187613, 'recall': 0.49672066957075034, 'f1-score': 0.48738143834794095, 'support': 40862}, '1': {'precision': 0.656491357116587, 'recall': 0.5377817310589215, 'f1-score': 0.591236731281841, 'support': 69703}, '2': {'precision': 0.46785728242604246, 'recall': 0.5965122072745391, 'f1-score': 0.5244092073851816, 'support': 40140}, 'accuracy': 0.5422912312132975, 'macro avg': {'precision': 0.5342451846148352, 'recall': 0.5436715359680703, 'f1-score': 0.5343424590049878, 'support': 150705}, 'weighted avg': {'precision': 0.5579579607437184, 'recall': 0.5422912312132975, 'f1-score': 0.5452781248051021, 'support': 150705}}
[[20297 10398 10167]
 [15151 37485 17067]
 [ 6980  9216 23944]]
Evaluating performance on  val set...
230/230 - 4s - 4s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.84646523
{'0': {'precision': 0.40325540572887575, 'recall': 0.5347016504443504, 'f1-score': 0.4597680236524903, 'support': 9452}, '1': {'precision': 0.8741950147738465, 'recall': 0.5773146874140045, 'f1-score': 0.6953940727124798, 'support': 39973}, '2': {'precision': 0.34652320378098445, 'recall': 0.7335816923895689, 'f1-score': 0.47070072394481627, 'support': 9395}, 'accuracy': 0.5954267256035363, 'macro avg': {'precision': 0.5413245414279023, 'recall': 0.6151993434159745, 'f1-score': 0.5419542734365954, 'support': 58820}, 'weighted avg': {'precision': 0.7142358537916805, 'recall': 0.5954267256035363, 'f1-score': 0.6216414132873315, 'support': 58820}}
[[ 5054  2000  2398]
 [ 6297 23077 10599]
 [ 1182  1321  6892]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8634575
{'0': {'precision': 0.4622360987213797, 'recall': 0.5082972288073244, 'f1-score': 0.48417364220362075, 'support': 12233}, '1': {'precision': 0.799034717715769, 'recall': 0.5740217359634043, 'f1-score': 0.6680909507095986, 'support': 34321}, '2': {'precision': 0.4110177674777907, 'recall': 0.6940322843632806, 'f1-score': 0.5162835829947238, 'support': 12266}, 'accuracy': 0.5853791227473648, 'macro avg': {'precision': 0.5574295279716465, 'recall': 0.5921170830446698, 'f1-score': 0.5561827253026478, 'support': 58820}, 'weighted avg': {'precision': 0.6480746120072106, 'recall': 0.5853791227473648, 'f1-score': 0.5981839529648811, 'support': 58820}}
[[ 6218  2872  3143]
 [ 5564 19701  9056]
 [ 1670  2083  8513]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8963853
{'0': {'precision': 0.4786396852164137, 'recall': 0.4847018642379394, 'f1-score': 0.4816517004878738, 'support': 14054}, '1': {'precision': 0.7306019485038274, 'recall': 0.549241433429244, 'f1-score': 0.6270718232044199, 'support': 30584}, '2': {'precision': 0.4358677532876459, 'recall': 0.6637286701452545, 'f1-score': 0.5261892783274638, 'support': 14182}, 'accuracy': 0.5614246854811289, 'macro avg': {'precision': 0.5483697956692957, 'recall': 0.5658906559374793, 'f1-score': 0.5449709340065858, 'support': 58820}, 'weighted avg': {'precision': 0.5993371065317568, 'recall': 0.5614246854811289, 'f1-score': 0.5680026178983449, 'support': 58820}}
[[ 6812  3481  3761]
 [ 5364 16798  8422]
 [ 2056  2713  9413]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.95020133
{'0': {'precision': 0.4907741676694745, 'recall': 0.44474736459469283, 'f1-score': 0.46662852784134246, 'support': 16506}, '1': {'precision': 0.6199092906906064, 'recall': 0.5189447314858306, 'f1-score': 0.564951528709918, 'support': 25548}, '2': {'precision': 0.46060066740823136, 'recall': 0.617440057258738, 'f1-score': 0.5276114268239852, 'support': 16766}, 'accuracy': 0.5261985719143148, 'macro avg': {'precision': 0.523761375256104, 'recall': 0.5270440511130872, 'f1-score': 0.5197304944584152, 'support': 58820}, 'weighted avg': {'precision': 0.5382623556593398, 'recall': 0.5261985719143148, 'f1-score': 0.5267168534199442, 'support': 58820}}
[[ 7341  4432  4733]
 [ 4900 13258  7390]
 [ 2717  3697 10352]]
training model: results/QRTEA/W1/deepLOB_L1/seq2seq
Epoch 1/50
653/653 - 20s - loss: 12.0965 - accuracy10: 0.4337 - accuracy20: 0.4521 - accuracy30: 0.4602 - accuracy50: 0.4652 - val_loss: 13.1576 - val_accuracy10: 0.6082 - val_accuracy20: 0.5698 - val_accuracy30: 0.5412 - val_accuracy50: 0.4933 - 20s/epoch - 31ms/step
Epoch 2/50
653/653 - 13s - loss: 11.9375 - accuracy10: 0.4216 - accuracy20: 0.4438 - accuracy30: 0.4550 - accuracy50: 0.4647 - val_loss: 12.0623 - val_accuracy10: 0.4321 - val_accuracy20: 0.4293 - val_accuracy30: 0.4279 - val_accuracy50: 0.4288 - 13s/epoch - 20ms/step
Epoch 3/50
653/653 - 13s - loss: 11.8166 - accuracy10: 0.4282 - accuracy20: 0.4512 - accuracy30: 0.4644 - accuracy50: 0.4741 - val_loss: 11.9388 - val_accuracy10: 0.4261 - val_accuracy20: 0.4283 - val_accuracy30: 0.4266 - val_accuracy50: 0.4282 - 13s/epoch - 20ms/step
Epoch 4/50
653/653 - 13s - loss: 11.6774 - accuracy10: 0.4521 - accuracy20: 0.4715 - accuracy30: 0.4818 - accuracy50: 0.4881 - val_loss: 11.9528 - val_accuracy10: 0.3787 - val_accuracy20: 0.3936 - val_accuracy30: 0.4025 - val_accuracy50: 0.4137 - 13s/epoch - 20ms/step
Epoch 5/50
653/653 - 13s - loss: 11.4872 - accuracy10: 0.4810 - accuracy20: 0.4942 - accuracy30: 0.5004 - accuracy50: 0.5029 - val_loss: 12.1504 - val_accuracy10: 0.3533 - val_accuracy20: 0.3722 - val_accuracy30: 0.3837 - val_accuracy50: 0.4003 - 13s/epoch - 20ms/step
Epoch 6/50
653/653 - 13s - loss: 11.4138 - accuracy10: 0.4794 - accuracy20: 0.4929 - accuracy30: 0.5006 - accuracy50: 0.5037 - val_loss: 12.2865 - val_accuracy10: 0.4117 - val_accuracy20: 0.4231 - val_accuracy30: 0.4307 - val_accuracy50: 0.4374 - 13s/epoch - 20ms/step
Epoch 7/50
653/653 - 14s - loss: 11.2696 - accuracy10: 0.5166 - accuracy20: 0.5244 - accuracy30: 0.5267 - accuracy50: 0.5231 - val_loss: 12.3046 - val_accuracy10: 0.3949 - val_accuracy20: 0.4089 - val_accuracy30: 0.4160 - val_accuracy50: 0.4261 - 14s/epoch - 21ms/step
Epoch 8/50
653/653 - 13s - loss: 11.1063 - accuracy10: 0.5290 - accuracy20: 0.5340 - accuracy30: 0.5340 - accuracy50: 0.5289 - val_loss: 12.4597 - val_accuracy10: 0.3706 - val_accuracy20: 0.3892 - val_accuracy30: 0.3998 - val_accuracy50: 0.4144 - 13s/epoch - 20ms/step
Epoch 9/50
653/653 - 13s - loss: 10.9578 - accuracy10: 0.5483 - accuracy20: 0.5481 - accuracy30: 0.5429 - accuracy50: 0.5342 - val_loss: 12.2142 - val_accuracy10: 0.4148 - val_accuracy20: 0.4244 - val_accuracy30: 0.4303 - val_accuracy50: 0.4369 - 13s/epoch - 20ms/step
Epoch 10/50
653/653 - 14s - loss: 10.8194 - accuracy10: 0.5656 - accuracy20: 0.5627 - accuracy30: 0.5549 - accuracy50: 0.5428 - val_loss: 12.1047 - val_accuracy10: 0.4264 - val_accuracy20: 0.4340 - val_accuracy30: 0.4357 - val_accuracy50: 0.4393 - 14s/epoch - 21ms/step
Epoch 11/50
653/653 - 13s - loss: 10.7736 - accuracy10: 0.5729 - accuracy20: 0.5692 - accuracy30: 0.5608 - accuracy50: 0.5477 - val_loss: 12.0127 - val_accuracy10: 0.4238 - val_accuracy20: 0.4296 - val_accuracy30: 0.4343 - val_accuracy50: 0.4399 - 13s/epoch - 20ms/step
Epoch 12/50
653/653 - 13s - loss: 10.6245 - accuracy10: 0.5828 - accuracy20: 0.5775 - accuracy30: 0.5682 - accuracy50: 0.5534 - val_loss: 12.0378 - val_accuracy10: 0.4569 - val_accuracy20: 0.4587 - val_accuracy30: 0.4560 - val_accuracy50: 0.4540 - 13s/epoch - 20ms/step
Epoch 13/50
653/653 - 14s - loss: 10.5819 - accuracy10: 0.5911 - accuracy20: 0.5831 - accuracy30: 0.5716 - accuracy50: 0.5554 - val_loss: 11.9103 - val_accuracy10: 0.4659 - val_accuracy20: 0.4628 - val_accuracy30: 0.4594 - val_accuracy50: 0.4557 - 14s/epoch - 22ms/step
Epoch 14/50
653/653 - 13s - loss: 10.4725 - accuracy10: 0.5986 - accuracy20: 0.5894 - accuracy30: 0.5770 - accuracy50: 0.5603 - val_loss: 11.6160 - val_accuracy10: 0.4822 - val_accuracy20: 0.4779 - val_accuracy30: 0.4738 - val_accuracy50: 0.4679 - 13s/epoch - 20ms/step
Epoch 15/50
653/653 - 13s - loss: 10.4566 - accuracy10: 0.6012 - accuracy20: 0.5912 - accuracy30: 0.5773 - accuracy50: 0.5585 - val_loss: 11.6235 - val_accuracy10: 0.4993 - val_accuracy20: 0.4987 - val_accuracy30: 0.4941 - val_accuracy50: 0.4880 - 13s/epoch - 20ms/step
Epoch 16/50
653/653 - 13s - loss: 10.3689 - accuracy10: 0.6075 - accuracy20: 0.5985 - accuracy30: 0.5849 - accuracy50: 0.5653 - val_loss: 12.2626 - val_accuracy10: 0.4614 - val_accuracy20: 0.4612 - val_accuracy30: 0.4576 - val_accuracy50: 0.4536 - 13s/epoch - 20ms/step
Epoch 17/50
653/653 - 13s - loss: 10.3278 - accuracy10: 0.6094 - accuracy20: 0.5985 - accuracy30: 0.5846 - accuracy50: 0.5650 - val_loss: 11.9582 - val_accuracy10: 0.4713 - val_accuracy20: 0.4723 - val_accuracy30: 0.4675 - val_accuracy50: 0.4630 - 13s/epoch - 20ms/step
Epoch 18/50
653/653 - 13s - loss: 10.2799 - accuracy10: 0.6108 - accuracy20: 0.6004 - accuracy30: 0.5867 - accuracy50: 0.5674 - val_loss: 12.2025 - val_accuracy10: 0.4545 - val_accuracy20: 0.4560 - val_accuracy30: 0.4527 - val_accuracy50: 0.4524 - 13s/epoch - 20ms/step
Epoch 19/50
653/653 - 13s - loss: 10.2140 - accuracy10: 0.6158 - accuracy20: 0.6047 - accuracy30: 0.5897 - accuracy50: 0.5697 - val_loss: 11.9585 - val_accuracy10: 0.4876 - val_accuracy20: 0.4860 - val_accuracy30: 0.4800 - val_accuracy50: 0.4730 - 13s/epoch - 20ms/step
Epoch 20/50
653/653 - 14s - loss: 10.1843 - accuracy10: 0.6173 - accuracy20: 0.6055 - accuracy30: 0.5904 - accuracy50: 0.5701 - val_loss: 12.1500 - val_accuracy10: 0.4655 - val_accuracy20: 0.4662 - val_accuracy30: 0.4639 - val_accuracy50: 0.4601 - 14s/epoch - 21ms/step
Epoch 21/50
653/653 - 14s - loss: 10.1284 - accuracy10: 0.6232 - accuracy20: 0.6110 - accuracy30: 0.5954 - accuracy50: 0.5739 - val_loss: 12.4088 - val_accuracy10: 0.4669 - val_accuracy20: 0.4666 - val_accuracy30: 0.4630 - val_accuracy50: 0.4579 - 14s/epoch - 21ms/step
Epoch 22/50
653/653 - 13s - loss: 10.0825 - accuracy10: 0.6259 - accuracy20: 0.6137 - accuracy30: 0.5989 - accuracy50: 0.5768 - val_loss: 12.7043 - val_accuracy10: 0.4481 - val_accuracy20: 0.4513 - val_accuracy30: 0.4493 - val_accuracy50: 0.4491 - 13s/epoch - 20ms/step
Epoch 23/50
653/653 - 13s - loss: 10.0522 - accuracy10: 0.6260 - accuracy20: 0.6133 - accuracy30: 0.5992 - accuracy50: 0.5775 - val_loss: 11.9798 - val_accuracy10: 0.4818 - val_accuracy20: 0.4802 - val_accuracy30: 0.4737 - val_accuracy50: 0.4674 - 13s/epoch - 20ms/step
Epoch 24/50
653/653 - 13s - loss: 10.0170 - accuracy10: 0.6275 - accuracy20: 0.6157 - accuracy30: 0.6001 - accuracy50: 0.5776 - val_loss: 12.0270 - val_accuracy10: 0.4777 - val_accuracy20: 0.4750 - val_accuracy30: 0.4681 - val_accuracy50: 0.4620 - 13s/epoch - 20ms/step
testing model: results/QRTEA/W1/deepLOB_L1/seq2seq
Evaluating performance on  test set...
1645/1645 - 15s - 15s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.241445
{'0': {'precision': 0.14295591938747676, 'recall': 0.6597769124923148, 'f1-score': 0.23499478623566214, 'support': 34157}, '1': {'precision': 0.9380919698009609, 'recall': 0.2711858641859832, 'f1-score': 0.42074248674130815, 'support': 352806}, '2': {'precision': 0.14687966686702567, 'recall': 0.6961846858754075, 'f1-score': 0.24258023579498936, 'support': 34047}, 'accuracy': 0.33708225457827606, 'macro avg': {'precision': 0.4093091853518211, 'recall': 0.5423824875179019, 'f1-score': 0.2994391695906532, 'support': 421010}, 'weighted avg': {'precision': 0.8095965246762251, 'recall': 0.33708225457827606, 'f1-score': 0.3912646254930227, 'support': 421010}}
[[ 22536   2230   9391]
 [128847  95676 128283]
 [  6260   4084  23703]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2504708
{'0': {'precision': 0.1850852605973798, 'recall': 0.6405906109104895, 'f1-score': 0.287192309350347, 'support': 46799}, '1': {'precision': 0.900768, 'recall': 0.2574517318016774, 'f1-score': 0.4004495436989196, 'support': 328011}, '2': {'precision': 0.19586655857120386, 'recall': 0.7007359307359308, 'f1-score': 0.30615738157608546, 'support': 46200}, 'accuracy': 0.3486853043870692, 'macro avg': {'precision': 0.42723993972286123, 'recall': 0.532926091149366, 'f1-score': 0.33126641154178404, 'support': 421010}, 'weighted avg': {'precision': 0.7438603657031576, 'recall': 0.3486853043870692, 'f1-score': 0.3775127412468311, 'support': 421010}}
[[ 29979   3356  13464]
 [124116  84447 119448]
 [  7879   5947  32374]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2387612
{'0': {'precision': 0.2144842588676053, 'recall': 0.6276191318185836, 'f1-score': 0.31970996870003826, 'support': 56555}, '1': {'precision': 0.8652863100309404, 'recall': 0.24986565840330965, 'f1-score': 0.38775940801470915, 'support': 308914}, '2': {'precision': 0.23019432886793814, 'recall': 0.6893105993770368, 'f1-score': 0.3451322248114777, 'support': 55541}, 'accuracy': 0.3585829315218166, 'macro avg': {'precision': 0.4366549659221613, 'recall': 0.52226512986631, 'f1-score': 0.3508672005087417, 'support': 421010}, 'weighted avg': {'precision': 0.6940795602403969, 'recall': 0.3585829315218166, 'f1-score': 0.3729946935833847, 'support': 421010}}
[[ 35495   4396  16664]
 [120360  77187 111367]
 [  9635   7621  38285]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2129726
{'0': {'precision': 0.26022245100781377, 'recall': 0.5939796514392056, 'f1-score': 0.3618975891150157, 'support': 73617}, '1': {'precision': 0.7899736513659686, 'recall': 0.24737903006922907, 'f1-score': 0.37677237289209914, 'support': 276329}, '2': {'precision': 0.2785251230165644, 'recall': 0.6523415512777215, 'f1-score': 0.3903749394749584, 'support': 71064}, 'accuracy': 0.37634022944823164, 'macro avg': {'precision': 0.4429070751301156, 'recall': 0.4979000775953854, 'f1-score': 0.37634830049402446, 'support': 421010}, 'weighted avg': {'precision': 0.6110128847918057, 'recall': 0.37634022944823164, 'f1-score': 0.3764674296231192, 'support': 421010}}
[[ 43727   7108  22782]
 [110670  68358  97301]
 [ 13640  11066  46358]]
Evaluating performance on  train set...
653/653 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0450932
{'0': {'precision': 0.2300195631494876, 'recall': 0.5901095865180956, 'f1-score': 0.3310131077678053, 'support': 21718}, '1': {'precision': 0.8444236600340932, 'recall': 0.45088483813543623, 'f1-score': 0.587872041000651, 'support': 124147}, '2': {'precision': 0.23848859992874955, 'recall': 0.5087635966370588, 'f1-score': 0.3247479724096112, 'support': 21053}, 'accuracy': 0.4762997399920919, 'macro avg': {'precision': 0.4376439410374435, 'recall': 0.5165860070968636, 'f1-score': 0.41454437372602254, 'support': 166918}, 'weighted avg': {'precision': 0.6880571866966599, 'recall': 0.4762997399920919, 'f1-score': 0.5212644053472278, 'support': 166918}}
[[12816  4492  4410]
 [38380 55976 29791]
 [ 4521  5821 10711]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0684313
{'0': {'precision': 0.28398028664472424, 'recall': 0.574918911296009, 'f1-score': 0.3801741522608321, 'support': 28364}, '1': {'precision': 0.7788797119530029, 'recall': 0.44492255509548684, 'f1-score': 0.5663352011758221, 'support': 110853}, '2': {'precision': 0.30321406913280774, 'recall': 0.5053969170788059, 'f1-score': 0.3790288738781422, 'support': 27701}, 'accuracy': 0.4770486106950718, 'macro avg': {'precision': 0.455358022576845, 'recall': 0.5084127944901006, 'f1-score': 0.4418460757715988, 'support': 166918}, 'weighted avg': {'precision': 0.6158431235011508, 'recall': 0.4770486106950718, 'f1-score': 0.5036167132721939, 'support': 166918}}
[[16307  6231  5826]
 [35186 49321 26346]
 [ 5930  7771 14000]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0773996
{'0': {'precision': 0.31783130885764976, 'recall': 0.5630269878207259, 'f1-score': 0.4063028188212202, 'support': 33089}, '1': {'precision': 0.7250032526671871, 'recall': 0.4393534716404672, 'f1-score': 0.5471393592017331, 'support': 101465}, '2': {'precision': 0.34126543341735377, 'recall': 0.49363490297861823, 'f1-score': 0.40354643966758447, 'support': 32364}, 'accuracy': 0.47439461292371105, 'macro avg': {'precision': 0.4613666649807302, 'recall': 0.4986717874799371, 'f1-score': 0.4523295392301792, 'support': 166918}, 'weighted avg': {'precision': 0.5698839531853135, 'recall': 0.47439461292371105, 'f1-score': 0.49137915639284496, 'support': 166918}}
[[18630  7565  6894]
 [32942 44579 23944]
 [ 7044  9344 15976]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.095031
{'0': {'precision': 0.362088383116774, 'recall': 0.536726964668361, 'f1-score': 0.43244165621079045, 'support': 40134}, '1': {'precision': 0.6345780594217083, 'recall': 0.4378627107585591, 'f1-score': 0.5181788626696648, 'support': 87363}, '2': {'precision': 0.39097696517201885, 'recall': 0.4675934146774562, 'f1-score': 0.4258666697471323, 'support': 39421}, 'accuracy': 0.46865526785607303, 'macro avg': {'precision': 0.46254780257016703, 'recall': 0.4807276967014588, 'f1-score': 0.4588290628758625, 'support': 166918}, 'weighted avg': {'precision': 0.511529020940303, 'recall': 0.46865526785607303, 'f1-score': 0.4757627301901263, 'support': 166918}}
[[21541 10013  8580]
 [28977 38253 20133]
 [ 8973 12015 18433]]
Evaluating performance on  val set...
181/181 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.016173
{'0': {'precision': 0.2184395284143595, 'recall': 0.6450224916878545, 'f1-score': 0.32635693434268465, 'support': 5113}, '1': {'precision': 0.877471846543456, 'recall': 0.44890702097747887, 'f1-score': 0.5939528776716027, 'support': 36277}, '2': {'precision': 0.21182616955592495, 'recall': 0.5461224489795918, 'f1-score': 0.3052529515770262, 'support': 4900}, 'accuracy': 0.4808597969323828, 'macro avg': {'precision': 0.4359125148379135, 'recall': 0.546683987214975, 'f1-score': 0.40852092119710454, 'support': 46290}, 'weighted avg': {'precision': 0.7342163689061051, 'recall': 0.4808597969323828, 'f1-score': 0.5338351914304236, 'support': 46290}}
[[ 3298   886   929]
 [10964 16285  9028]
 [  836  1388  2676]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0418742
{'0': {'precision': 0.2721642969984202, 'recall': 0.6215007215007216, 'f1-score': 0.3785541639200176, 'support': 6930}, '1': {'precision': 0.8143626776707932, 'recall': 0.43412771157959057, 'f1-score': 0.5663438160149866, 'support': 32730}, '2': {'precision': 0.2744872090343397, 'recall': 0.5389140271493212, 'f1-score': 0.3637196518552451, 'support': 6630}, 'accuracy': 0.47718729747245625, 'macro avg': {'precision': 0.45367139456785105, 'recall': 0.5315141534098777, 'f1-score': 0.4362058772634165, 'support': 46290}, 'weighted avg': {'precision': 0.6558660448101488, 'recall': 0.47718729747245625, 'f1-score': 0.509208786907248, 'support': 46290}}
[[ 4307  1334  1289]
 [10366 14209  8155]
 [ 1152  1905  3573]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0556684
{'0': {'precision': 0.3049379683085616, 'recall': 0.6044558071585099, 'f1-score': 0.4053723056825604, 'support': 8214}, '1': {'precision': 0.7604886769964243, 'recall': 0.4224377648305085, 'f1-score': 0.5431599557333788, 'support': 30208}, '2': {'precision': 0.3138796492289084, 'recall': 0.5277071682765633, 'f1-score': 0.39362912400455063, 'support': 7868}, 'accuracy': 0.4726290775545474, 'macro avg': {'precision': 0.4597687648446314, 'recall': 0.5182002467551939, 'f1-score': 0.44738712847349665, 'support': 46290}, 'weighted avg': {'precision': 0.6037417910245747, 'recall': 0.4726290775545474, 'f1-score': 0.49329397298203204, 'support': 46290}}
[[ 4965  1709  1540]
 [ 9911 12761  7536]
 [ 1406  2310  4152]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0737507
{'0': {'precision': 0.3538210989806382, 'recall': 0.5657247564856784, 'f1-score': 0.4353569838206917, 'support': 10369}, '1': {'precision': 0.6671161507814894, 'recall': 0.4159596422838798, 'f1-score': 0.5124173159765542, 'support': 26166}, '2': {'precision': 0.36324275903254705, 'recall': 0.4988211173757048, 'f1-score': 0.4203706103408061, 'support': 9755}, 'accuracy': 0.46696910779866063, 'macro avg': {'precision': 0.4613933362648916, 'recall': 0.4935018387150876, 'f1-score': 0.4560483033793506, 'support': 46290}, 'weighted avg': {'precision': 0.5329005247578567, 'recall': 0.46696910779866063, 'f1-score': 0.4757581196576762, 'support': 46290}}
[[ 5866  2417  2086]
 [ 8838 10884  6444]
 [ 1875  3014  4866]]
training model: results/QRTEA/W1/deepOF_L1/seq2seq
Epoch 1/50
653/653 - 18s - loss: 12.5691 - accuracy10: 0.3972 - accuracy20: 0.4161 - accuracy30: 0.4238 - accuracy50: 0.4289 - val_loss: 12.4775 - val_accuracy10: 0.6732 - val_accuracy20: 0.6445 - val_accuracy30: 0.6159 - val_accuracy50: 0.5610 - 18s/epoch - 27ms/step
Epoch 2/50
653/653 - 12s - loss: 12.3248 - accuracy10: 0.4249 - accuracy20: 0.4293 - accuracy30: 0.4295 - accuracy50: 0.4316 - val_loss: 11.6563 - val_accuracy10: 0.6413 - val_accuracy20: 0.6192 - val_accuracy30: 0.5959 - val_accuracy50: 0.5522 - 12s/epoch - 19ms/step
Epoch 3/50
653/653 - 13s - loss: 12.1923 - accuracy10: 0.4549 - accuracy20: 0.4576 - accuracy30: 0.4554 - accuracy50: 0.4536 - val_loss: 11.3824 - val_accuracy10: 0.6644 - val_accuracy20: 0.6419 - val_accuracy30: 0.6191 - val_accuracy50: 0.5722 - 13s/epoch - 20ms/step
Epoch 4/50
653/653 - 12s - loss: 12.0849 - accuracy10: 0.4690 - accuracy20: 0.4708 - accuracy30: 0.4684 - accuracy50: 0.4651 - val_loss: 11.5271 - val_accuracy10: 0.6701 - val_accuracy20: 0.6452 - val_accuracy30: 0.6211 - val_accuracy50: 0.5728 - 12s/epoch - 19ms/step
Epoch 5/50
653/653 - 12s - loss: 12.0069 - accuracy10: 0.4753 - accuracy20: 0.4765 - accuracy30: 0.4757 - accuracy50: 0.4720 - val_loss: 11.3291 - val_accuracy10: 0.6621 - val_accuracy20: 0.6386 - val_accuracy30: 0.6144 - val_accuracy50: 0.5696 - 12s/epoch - 19ms/step
Epoch 6/50
653/653 - 12s - loss: 11.9376 - accuracy10: 0.4866 - accuracy20: 0.4880 - accuracy30: 0.4863 - accuracy50: 0.4812 - val_loss: 11.4284 - val_accuracy10: 0.6958 - val_accuracy20: 0.6656 - val_accuracy30: 0.6376 - val_accuracy50: 0.5849 - 12s/epoch - 19ms/step
Epoch 7/50
653/653 - 13s - loss: 11.8691 - accuracy10: 0.4893 - accuracy20: 0.4916 - accuracy30: 0.4906 - accuracy50: 0.4863 - val_loss: 11.2073 - val_accuracy10: 0.6755 - val_accuracy20: 0.6480 - val_accuracy30: 0.6242 - val_accuracy50: 0.5785 - 13s/epoch - 20ms/step
Epoch 8/50
653/653 - 12s - loss: 11.7956 - accuracy10: 0.4964 - accuracy20: 0.4985 - accuracy30: 0.4971 - accuracy50: 0.4915 - val_loss: 11.2047 - val_accuracy10: 0.6880 - val_accuracy20: 0.6591 - val_accuracy30: 0.6335 - val_accuracy50: 0.5847 - 12s/epoch - 18ms/step
Epoch 9/50
653/653 - 12s - loss: 11.7115 - accuracy10: 0.5049 - accuracy20: 0.5054 - accuracy30: 0.5046 - accuracy50: 0.4970 - val_loss: 11.1885 - val_accuracy10: 0.6945 - val_accuracy20: 0.6662 - val_accuracy30: 0.6391 - val_accuracy50: 0.5878 - 12s/epoch - 19ms/step
Epoch 10/50
653/653 - 12s - loss: 11.6547 - accuracy10: 0.5053 - accuracy20: 0.5052 - accuracy30: 0.5046 - accuracy50: 0.4984 - val_loss: 11.1204 - val_accuracy10: 0.7070 - val_accuracy20: 0.6754 - val_accuracy30: 0.6481 - val_accuracy50: 0.5941 - 12s/epoch - 19ms/step
Epoch 11/50
653/653 - 13s - loss: 11.5798 - accuracy10: 0.5085 - accuracy20: 0.5093 - accuracy30: 0.5098 - accuracy50: 0.5047 - val_loss: 11.0693 - val_accuracy10: 0.6995 - val_accuracy20: 0.6689 - val_accuracy30: 0.6410 - val_accuracy50: 0.5900 - 13s/epoch - 19ms/step
Epoch 12/50
653/653 - 13s - loss: 11.5249 - accuracy10: 0.5106 - accuracy20: 0.5125 - accuracy30: 0.5131 - accuracy50: 0.5081 - val_loss: 11.1215 - val_accuracy10: 0.6951 - val_accuracy20: 0.6624 - val_accuracy30: 0.6350 - val_accuracy50: 0.5872 - 13s/epoch - 19ms/step
Epoch 13/50
653/653 - 14s - loss: 11.4604 - accuracy10: 0.5134 - accuracy20: 0.5144 - accuracy30: 0.5159 - accuracy50: 0.5122 - val_loss: 11.0618 - val_accuracy10: 0.6984 - val_accuracy20: 0.6674 - val_accuracy30: 0.6403 - val_accuracy50: 0.5908 - 14s/epoch - 21ms/step
Epoch 14/50
653/653 - 12s - loss: 11.4109 - accuracy10: 0.5175 - accuracy20: 0.5187 - accuracy30: 0.5193 - accuracy50: 0.5153 - val_loss: 11.1027 - val_accuracy10: 0.6950 - val_accuracy20: 0.6624 - val_accuracy30: 0.6341 - val_accuracy50: 0.5863 - 12s/epoch - 19ms/step
Epoch 15/50
653/653 - 13s - loss: 11.3583 - accuracy10: 0.5195 - accuracy20: 0.5209 - accuracy30: 0.5218 - accuracy50: 0.5173 - val_loss: 11.1860 - val_accuracy10: 0.6936 - val_accuracy20: 0.6631 - val_accuracy30: 0.6344 - val_accuracy50: 0.5889 - 13s/epoch - 21ms/step
Epoch 16/50
653/653 - 12s - loss: 11.3032 - accuracy10: 0.5236 - accuracy20: 0.5238 - accuracy30: 0.5247 - accuracy50: 0.5212 - val_loss: 11.2067 - val_accuracy10: 0.6982 - val_accuracy20: 0.6661 - val_accuracy30: 0.6367 - val_accuracy50: 0.5878 - 12s/epoch - 19ms/step
Epoch 17/50
653/653 - 12s - loss: 11.2653 - accuracy10: 0.5247 - accuracy20: 0.5253 - accuracy30: 0.5265 - accuracy50: 0.5238 - val_loss: 11.1739 - val_accuracy10: 0.7066 - val_accuracy20: 0.6738 - val_accuracy30: 0.6433 - val_accuracy50: 0.5934 - 12s/epoch - 19ms/step
Epoch 18/50
653/653 - 12s - loss: 11.2111 - accuracy10: 0.5305 - accuracy20: 0.5300 - accuracy30: 0.5288 - accuracy50: 0.5260 - val_loss: 11.1467 - val_accuracy10: 0.6976 - val_accuracy20: 0.6639 - val_accuracy30: 0.6352 - val_accuracy50: 0.5862 - 12s/epoch - 19ms/step
Epoch 19/50
653/653 - 12s - loss: 11.1501 - accuracy10: 0.5346 - accuracy20: 0.5342 - accuracy30: 0.5339 - accuracy50: 0.5303 - val_loss: 11.0087 - val_accuracy10: 0.6912 - val_accuracy20: 0.6584 - val_accuracy30: 0.6298 - val_accuracy50: 0.5838 - 12s/epoch - 19ms/step
Epoch 20/50
653/653 - 12s - loss: 11.1030 - accuracy10: 0.5391 - accuracy20: 0.5387 - accuracy30: 0.5385 - accuracy50: 0.5331 - val_loss: 11.0917 - val_accuracy10: 0.7052 - val_accuracy20: 0.6705 - val_accuracy30: 0.6406 - val_accuracy50: 0.5917 - 12s/epoch - 19ms/step
Epoch 21/50
653/653 - 12s - loss: 11.0673 - accuracy10: 0.5382 - accuracy20: 0.5367 - accuracy30: 0.5355 - accuracy50: 0.5316 - val_loss: 11.0900 - val_accuracy10: 0.7097 - val_accuracy20: 0.6733 - val_accuracy30: 0.6422 - val_accuracy50: 0.5921 - 12s/epoch - 19ms/step
Epoch 22/50
653/653 - 12s - loss: 11.0161 - accuracy10: 0.5447 - accuracy20: 0.5432 - accuracy30: 0.5430 - accuracy50: 0.5375 - val_loss: 10.9882 - val_accuracy10: 0.7035 - val_accuracy20: 0.6696 - val_accuracy30: 0.6407 - val_accuracy50: 0.5913 - 12s/epoch - 19ms/step
Epoch 23/50
653/653 - 12s - loss: 10.9780 - accuracy10: 0.5450 - accuracy20: 0.5442 - accuracy30: 0.5434 - accuracy50: 0.5374 - val_loss: 11.0927 - val_accuracy10: 0.7040 - val_accuracy20: 0.6685 - val_accuracy30: 0.6390 - val_accuracy50: 0.5906 - 12s/epoch - 19ms/step
Epoch 24/50
653/653 - 12s - loss: 10.9254 - accuracy10: 0.5493 - accuracy20: 0.5486 - accuracy30: 0.5464 - accuracy50: 0.5400 - val_loss: 11.0165 - val_accuracy10: 0.7021 - val_accuracy20: 0.6654 - val_accuracy30: 0.6362 - val_accuracy50: 0.5889 - 12s/epoch - 19ms/step
Epoch 25/50
653/653 - 12s - loss: 10.8705 - accuracy10: 0.5519 - accuracy20: 0.5509 - accuracy30: 0.5487 - accuracy50: 0.5426 - val_loss: 11.2297 - val_accuracy10: 0.7020 - val_accuracy20: 0.6642 - val_accuracy30: 0.6329 - val_accuracy50: 0.5837 - 12s/epoch - 19ms/step
Epoch 26/50
653/653 - 12s - loss: 10.8347 - accuracy10: 0.5529 - accuracy20: 0.5512 - accuracy30: 0.5494 - accuracy50: 0.5434 - val_loss: 11.2309 - val_accuracy10: 0.7110 - val_accuracy20: 0.6734 - val_accuracy30: 0.6417 - val_accuracy50: 0.5914 - 12s/epoch - 19ms/step
Epoch 27/50
653/653 - 13s - loss: 10.8048 - accuracy10: 0.5549 - accuracy20: 0.5544 - accuracy30: 0.5524 - accuracy50: 0.5461 - val_loss: 11.1501 - val_accuracy10: 0.7114 - val_accuracy20: 0.6764 - val_accuracy30: 0.6461 - val_accuracy50: 0.5953 - 13s/epoch - 20ms/step
Epoch 28/50
653/653 - 12s - loss: 10.7552 - accuracy10: 0.5576 - accuracy20: 0.5573 - accuracy30: 0.5548 - accuracy50: 0.5476 - val_loss: 11.2460 - val_accuracy10: 0.7118 - val_accuracy20: 0.6756 - val_accuracy30: 0.6432 - val_accuracy50: 0.5927 - 12s/epoch - 19ms/step
Epoch 29/50
653/653 - 12s - loss: 10.7066 - accuracy10: 0.5589 - accuracy20: 0.5602 - accuracy30: 0.5584 - accuracy50: 0.5510 - val_loss: 11.3924 - val_accuracy10: 0.7078 - val_accuracy20: 0.6701 - val_accuracy30: 0.6378 - val_accuracy50: 0.5876 - 12s/epoch - 18ms/step
Epoch 30/50
653/653 - 12s - loss: 10.6757 - accuracy10: 0.5577 - accuracy20: 0.5586 - accuracy30: 0.5573 - accuracy50: 0.5499 - val_loss: 11.3202 - val_accuracy10: 0.7148 - val_accuracy20: 0.6745 - val_accuracy30: 0.6417 - val_accuracy50: 0.5895 - 12s/epoch - 18ms/step
Epoch 31/50
653/653 - 12s - loss: 10.6308 - accuracy10: 0.5620 - accuracy20: 0.5624 - accuracy30: 0.5600 - accuracy50: 0.5520 - val_loss: 11.3233 - val_accuracy10: 0.7076 - val_accuracy20: 0.6696 - val_accuracy30: 0.6372 - val_accuracy50: 0.5870 - 12s/epoch - 18ms/step
Epoch 32/50
653/653 - 12s - loss: 10.6060 - accuracy10: 0.5590 - accuracy20: 0.5619 - accuracy30: 0.5606 - accuracy50: 0.5543 - val_loss: 11.5249 - val_accuracy10: 0.7086 - val_accuracy20: 0.6698 - val_accuracy30: 0.6373 - val_accuracy50: 0.5866 - 12s/epoch - 19ms/step
testing model: results/QRTEA/W1/deepOF_L1/seq2seq
Evaluating performance on  test set...
1645/1645 - 15s - 15s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6958042
{'0': {'precision': 0.22789152395872725, 'recall': 0.49405633307958075, 'f1-score': 0.31190964712841274, 'support': 34154}, '1': {'precision': 0.8994016159006735, 'recall': 0.7736659807372891, 'f1-score': 0.8318091087781315, 'support': 352806}, '2': {'precision': 0.28709432573544635, 'recall': 0.36663239829637245, 'f1-score': 0.32202471556461393, 'support': 34045}, 'accuracy': 0.7180674813838316, 'macro avg': {'precision': 0.4714624885316157, 'recall': 0.5447849040377474, 'f1-score': 0.4885811571570527, 'support': 421005}, 'weighted avg': {'precision': 0.7954105531487812, 'recall': 0.7180674813838316, 'f1-score': 0.748408066319874, 'support': 421005}}
[[ 16874  14450   2830]
 [ 51687 272954  28165]
 [  5483  16080  12482]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.74992365
{'0': {'precision': 0.2762314972094152, 'recall': 0.4865159415334644, 'f1-score': 0.3523867013372957, 'support': 46796}, '1': {'precision': 0.8513595331511272, 'recall': 0.7587824798558584, 'f1-score': 0.8024095919426649, 'support': 328011}, '2': {'precision': 0.35539120280264697, 'recall': 0.3557296852677605, 'f1-score': 0.35556036347901343, 'support': 46198}, 'accuracy': 0.6842911604375245, 'macro avg': {'precision': 0.4943274110543964, 'recall': 0.5336760355523611, 'f1-score': 0.5034522189196581, 'support': 421005}, 'weighted avg': {'precision': 0.7330083579979403, 'recall': 0.6842911604375245, 'f1-score': 0.7033542081697106, 'support': 421005}}
[[ 22767  20260   3769]
 [ 53083 248889  26039]
 [  6570  23194  16434]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7979057
{'0': {'precision': 0.3055108033684114, 'recall': 0.4728037912010185, 'f1-score': 0.3711780996869599, 'support': 56552}, '1': {'precision': 0.8080237035380605, 'recall': 0.7486161196967441, 'f1-score': 0.7771862964531284, 'support': 308914}, '2': {'precision': 0.39222570002537854, 'recall': 0.33392751039809865, 'f1-score': 0.3607364111142449, 'support': 55539}, 'accuracy': 0.6568615574636881, 'macro avg': {'precision': 0.5019200689772835, 'recall': 0.5184491404319537, 'f1-score': 0.5030336024181111, 'support': 421005}, 'weighted avg': {'precision': 0.6856709646216942, 'recall': 0.6568615574636881, 'f1-score': 0.6677106709252686, 'support': 421005}}
[[ 26738  25524   4290]
 [ 53208 231258  24448]
 [  7573  29420  18546]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.86806726
{'0': {'precision': 0.35157465769527885, 'recall': 0.4265900508055533, 'f1-score': 0.3854665971092767, 'support': 73614}, '1': {'precision': 0.7256555689094116, 'recall': 0.7472758921430613, 'f1-score': 0.7363070543118002, 'support': 276329}, '2': {'precision': 0.4351682865752727, 'recall': 0.2885649151445217, 'f1-score': 0.34701820889460505, 'support': 71062}, 'accuracy': 0.6137765584731772, 'macro avg': {'precision': 0.5041328377266544, 'recall': 0.48747695269771213, 'f1-score': 0.489597286771894, 'support': 421005}, 'weighted avg': {'precision': 0.6112146490739091, 'recall': 0.6137765584731772, 'f1-score': 0.6092529496110406, 'support': 421005}}
[[ 31403  36762   5449]
 [ 48668 206494  21167]
 [  9250  41306  20506]]
Evaluating performance on  train set...
653/653 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7742634
{'0': {'precision': 0.3256952249737138, 'recall': 0.41537963562378616, 'f1-score': 0.3651106549881114, 'support': 21626}, '1': {'precision': 0.8189730498398068, 'recall': 0.7695564678419061, 'f1-score': 0.7934961239023257, 'support': 124230}, '2': {'precision': 0.3221696235013051, 'recall': 0.3457411451903903, 'f1-score': 0.33353944807053704, 'support': 21062}, 'accuracy': 0.6701913514420255, 'macro avg': {'precision': 0.48894596610494195, 'recall': 0.5102257495520275, 'f1-score': 0.497382075653658, 'support': 166918}, 'weighted avg': {'precision': 0.6923761579162536, 'recall': 0.6701913514420255, 'f1-score': 0.6799561122971786, 'support': 166918}}
[[ 8983 10102  2541]
 [15848 95602 12780]
 [ 2750 11030  7282]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8293637
{'0': {'precision': 0.39339417362216234, 'recall': 0.427945592651475, 'f1-score': 0.4099431433599567, 'support': 28305}, '1': {'precision': 0.7525154504556878, 'recall': 0.758738231793096, 'f1-score': 0.7556140295732844, 'support': 110892}, '2': {'precision': 0.39004029936672424, 'recall': 0.34215937375996536, 'f1-score': 0.3645342915890006, 'support': 27721}, 'accuracy': 0.633460741202267, 'macro avg': {'precision': 0.5119833078148581, 'recall': 0.5096143994015121, 'f1-score': 0.5100304881740806, 'support': 166918}, 'weighted avg': {'precision': 0.6314194547924873, 'recall': 0.633460741202267, 'f1-score': 0.63204835151022, 'support': 166918}}
[[12113 12949  3243]
 [15164 84138 11590]
 [ 3514 14722  9485]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8708561
{'0': {'precision': 0.4297298945186269, 'recall': 0.42641498018573976, 'f1-score': 0.4280660198302434, 'support': 33057}, '1': {'precision': 0.6983096240449789, 'recall': 0.7500270906601255, 'f1-score': 0.7232449890757101, 'support': 101511}, '2': {'precision': 0.42651572527603937, 'recall': 0.33075734157650694, 'f1-score': 0.3725821334679736, 'support': 32350}, 'accuracy': 0.6046801423453432, 'macro avg': {'precision': 0.5181850812798817, 'recall': 0.5023998041407908, 'f1-score': 0.507964380791309, 'support': 166918}, 'weighted avg': {'precision': 0.5924434337951088, 'recall': 0.6046801423453432, 'f1-score': 0.5968255821498084, 'support': 166918}}
[[14096 15231  3730]
 [14718 76136 10657]
 [ 3988 17662 10700]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.93499476
{'0': {'precision': 0.4777426851796675, 'recall': 0.3999900214538742, 'f1-score': 0.4354225505105367, 'support': 40086}, '1': {'precision': 0.6061406831810328, 'recall': 0.750500509089245, 'f1-score': 0.6706399509302801, 'support': 87411}, '2': {'precision': 0.4756636287658694, 'recall': 0.30318865579259785, 'f1-score': 0.3703290574456219, 'support': 39421}, 'accuracy': 0.5606824908038678, 'macro avg': {'precision': 0.5198489990421898, 'recall': 0.48455972877857234, 'f1-score': 0.4921305196288129, 'support': 166918}, 'weighted avg': {'precision': 0.5444906627519426, 'recall': 0.5606824908038678, 'f1-score': 0.5432272066769068, 'support': 166918}}
[[16034 19765  4287]
 [12921 65602  8888]
 [ 4607 22862 11952]]
Evaluating performance on  val set...
181/181 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7290679
{'0': {'precision': 0.30822454308093994, 'recall': 0.46540508574807804, 'f1-score': 0.3708474043823136, 'support': 5073}, '1': {'precision': 0.8612334132936568, 'recall': 0.7811561871712248, 'f1-score': 0.8192426561913291, 'support': 36309}, '2': {'precision': 0.32157275759171494, 'recall': 0.3732681336593317, 'f1-score': 0.34549740688354547, 'support': 4908}, 'accuracy': 0.7033052495139339, 'macro avg': {'precision': 0.4970102379887706, 'recall': 0.5399431355262115, 'f1-score': 0.5118624891523961, 'support': 46290}, 'weighted avg': {'precision': 0.7434095097124461, 'recall': 0.7033052495139339, 'f1-score': 0.7198723646374354, 'support': 46290}}
[[ 2361  2163   549]
 [ 4630 28363  3316]
 [  669  2407  1832]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7817767
{'0': {'precision': 0.3790719475041012, 'recall': 0.46802662037037035, 'f1-score': 0.4188786740903794, 'support': 6912}, '1': {'precision': 0.79950119964642, 'recall': 0.7736840497357407, 'f1-score': 0.7863807852939805, 'support': 32733}, '2': {'precision': 0.3907894736842105, 'recall': 0.3575620767494357, 'f1-score': 0.37343811394891946, 'support': 6645}, 'accuracy': 0.6683084899546339, 'macro avg': {'precision': 0.5231208736115772, 'recall': 0.5330909156185155, 'f1-score': 0.5262325244444264, 'support': 46290}, 'weighted avg': {'precision': 0.6780517200649425, 'recall': 0.6683084899546339, 'f1-score': 0.6722270016749002, 'support': 46290}}
[[ 3235  2954   723]
 [ 4427 25325  2981]
 [  872  3397  2376]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8291751
{'0': {'precision': 0.4141080664685815, 'recall': 0.45946275946275944, 'f1-score': 0.43560803380216473, 'support': 8190}, '1': {'precision': 0.746429377438179, 'recall': 0.7668256491785903, 'f1-score': 0.7564900586515055, 'support': 30192}, '2': {'precision': 0.43485289363077917, 'recall': 0.34016186140617094, 'f1-score': 0.38172271888746984, 'support': 7908}, 'accuracy': 0.6395549794772089, 'macro avg': {'precision': 0.5317967791791799, 'recall': 0.5221500900158402, 'f1-score': 0.5246069371137133, 'support': 46290}, 'weighted avg': {'precision': 0.6344039211670639, 'recall': 0.6395549794772089, 'f1-score': 0.6356932579090105, 'support': 46290}}
[[ 3763  3651   776]
 [ 4320 23152  2720]
 [ 1004  4214  2690]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.89780796
{'0': {'precision': 0.4632439995694758, 'recall': 0.41572491065391676, 'f1-score': 0.4381999592750967, 'support': 10353}, '1': {'precision': 0.6509938713966081, 'recall': 0.7679596052329585, 'f1-score': 0.704655937944227, 'support': 26142}, '2': {'precision': 0.48295454545454547, 'recall': 0.3037263910158244, 'f1-score': 0.3729238483234095, 'support': 9795}, 'accuracy': 0.590948368978181, 'macro avg': {'precision': 0.5323974721402097, 'recall': 0.4958036356342332, 'f1-score': 0.5052599151809111, 'support': 46290}, 'weighted avg': {'precision': 0.5734453809963315, 'recall': 0.590948368978181, 'f1-score': 0.5748669000311266, 'support': 46290}}
[[ 4304  5146   903]
 [ 3784 20076  2282]
 [ 1203  5617  2975]]
training model: results/QRTEA/W1/deepLOB_L2/seq2seq
Epoch 1/50
653/653 - 34s - loss: 12.3604 - accuracy10: 0.4246 - accuracy20: 0.4353 - accuracy30: 0.4417 - accuracy50: 0.4448 - val_loss: 12.5620 - val_accuracy10: 0.5971 - val_accuracy20: 0.5709 - val_accuracy30: 0.5490 - val_accuracy50: 0.5094 - 34s/epoch - 53ms/step
Epoch 2/50
653/653 - 29s - loss: 11.7775 - accuracy10: 0.4568 - accuracy20: 0.4761 - accuracy30: 0.4836 - accuracy50: 0.4875 - val_loss: 12.0934 - val_accuracy10: 0.3616 - val_accuracy20: 0.3860 - val_accuracy30: 0.3992 - val_accuracy50: 0.4133 - 29s/epoch - 45ms/step
Epoch 3/50
653/653 - 29s - loss: 11.6742 - accuracy10: 0.4827 - accuracy20: 0.4937 - accuracy30: 0.4954 - accuracy50: 0.4928 - val_loss: 12.2085 - val_accuracy10: 0.5354 - val_accuracy20: 0.5214 - val_accuracy30: 0.5076 - val_accuracy50: 0.4812 - 29s/epoch - 45ms/step
Epoch 4/50
653/653 - 30s - loss: 11.3843 - accuracy10: 0.5071 - accuracy20: 0.5158 - accuracy30: 0.5144 - accuracy50: 0.5089 - val_loss: 11.8437 - val_accuracy10: 0.3688 - val_accuracy20: 0.3925 - val_accuracy30: 0.4046 - val_accuracy50: 0.4204 - 30s/epoch - 45ms/step
Epoch 5/50
653/653 - 30s - loss: 11.1432 - accuracy10: 0.5347 - accuracy20: 0.5411 - accuracy30: 0.5373 - accuracy50: 0.5271 - val_loss: 11.6832 - val_accuracy10: 0.3786 - val_accuracy20: 0.4004 - val_accuracy30: 0.4105 - val_accuracy50: 0.4249 - 30s/epoch - 45ms/step
Epoch 6/50
653/653 - 30s - loss: 10.9168 - accuracy10: 0.5591 - accuracy20: 0.5621 - accuracy30: 0.5544 - accuracy50: 0.5410 - val_loss: 12.1236 - val_accuracy10: 0.3920 - val_accuracy20: 0.4087 - val_accuracy30: 0.4152 - val_accuracy50: 0.4250 - 30s/epoch - 45ms/step
Epoch 7/50
653/653 - 30s - loss: 10.7503 - accuracy10: 0.5813 - accuracy20: 0.5815 - accuracy30: 0.5711 - accuracy50: 0.5535 - val_loss: 12.0749 - val_accuracy10: 0.4014 - val_accuracy20: 0.4183 - val_accuracy30: 0.4238 - val_accuracy50: 0.4326 - 30s/epoch - 45ms/step
Epoch 8/50
653/653 - 29s - loss: 10.5535 - accuracy10: 0.5993 - accuracy20: 0.5962 - accuracy30: 0.5828 - accuracy50: 0.5630 - val_loss: 11.5999 - val_accuracy10: 0.4338 - val_accuracy20: 0.4461 - val_accuracy30: 0.4481 - val_accuracy50: 0.4529 - 29s/epoch - 45ms/step
Epoch 9/50
653/653 - 29s - loss: 10.3206 - accuracy10: 0.6169 - accuracy20: 0.6112 - accuracy30: 0.5949 - accuracy50: 0.5725 - val_loss: 11.3584 - val_accuracy10: 0.4854 - val_accuracy20: 0.4932 - val_accuracy30: 0.4887 - val_accuracy50: 0.4816 - 29s/epoch - 44ms/step
Epoch 10/50
653/653 - 29s - loss: 10.1295 - accuracy10: 0.6326 - accuracy20: 0.6245 - accuracy30: 0.6059 - accuracy50: 0.5794 - val_loss: 11.1616 - val_accuracy10: 0.5287 - val_accuracy20: 0.5314 - val_accuracy30: 0.5203 - val_accuracy50: 0.5062 - 29s/epoch - 45ms/step
Epoch 11/50
653/653 - 29s - loss: 10.0095 - accuracy10: 0.6378 - accuracy20: 0.6308 - accuracy30: 0.6114 - accuracy50: 0.5839 - val_loss: 10.9930 - val_accuracy10: 0.5496 - val_accuracy20: 0.5490 - val_accuracy30: 0.5338 - val_accuracy50: 0.5152 - 29s/epoch - 45ms/step
Epoch 12/50
653/653 - 31s - loss: 9.8970 - accuracy10: 0.6439 - accuracy20: 0.6350 - accuracy30: 0.6157 - accuracy50: 0.5877 - val_loss: 11.0624 - val_accuracy10: 0.5484 - val_accuracy20: 0.5472 - val_accuracy30: 0.5322 - val_accuracy50: 0.5140 - 31s/epoch - 47ms/step
Epoch 13/50
653/653 - 29s - loss: 9.8027 - accuracy10: 0.6472 - accuracy20: 0.6393 - accuracy30: 0.6207 - accuracy50: 0.5919 - val_loss: 11.1868 - val_accuracy10: 0.5446 - val_accuracy20: 0.5440 - val_accuracy30: 0.5284 - val_accuracy50: 0.5095 - 29s/epoch - 45ms/step
Epoch 14/50
653/653 - 29s - loss: 9.7088 - accuracy10: 0.6509 - accuracy20: 0.6422 - accuracy30: 0.6230 - accuracy50: 0.5928 - val_loss: 11.2998 - val_accuracy10: 0.5330 - val_accuracy20: 0.5320 - val_accuracy30: 0.5173 - val_accuracy50: 0.5006 - 29s/epoch - 45ms/step
Epoch 15/50
653/653 - 30s - loss: 9.6403 - accuracy10: 0.6528 - accuracy20: 0.6442 - accuracy30: 0.6244 - accuracy50: 0.5962 - val_loss: 11.1319 - val_accuracy10: 0.5488 - val_accuracy20: 0.5464 - val_accuracy30: 0.5307 - val_accuracy50: 0.5102 - 30s/epoch - 46ms/step
Epoch 16/50
653/653 - 30s - loss: 9.5573 - accuracy10: 0.6559 - accuracy20: 0.6482 - accuracy30: 0.6281 - accuracy50: 0.5997 - val_loss: 11.1932 - val_accuracy10: 0.5643 - val_accuracy20: 0.5592 - val_accuracy30: 0.5426 - val_accuracy50: 0.5188 - 30s/epoch - 45ms/step
Epoch 17/50
653/653 - 30s - loss: 9.4974 - accuracy10: 0.6571 - accuracy20: 0.6500 - accuracy30: 0.6306 - accuracy50: 0.6022 - val_loss: 11.0328 - val_accuracy10: 0.5590 - val_accuracy20: 0.5531 - val_accuracy30: 0.5373 - val_accuracy50: 0.5160 - 30s/epoch - 45ms/step
Epoch 18/50
653/653 - 29s - loss: 9.4321 - accuracy10: 0.6578 - accuracy20: 0.6507 - accuracy30: 0.6319 - accuracy50: 0.6038 - val_loss: 11.4576 - val_accuracy10: 0.5355 - val_accuracy20: 0.5339 - val_accuracy30: 0.5191 - val_accuracy50: 0.5010 - 29s/epoch - 45ms/step
Epoch 19/50
653/653 - 29s - loss: 9.4186 - accuracy10: 0.6577 - accuracy20: 0.6514 - accuracy30: 0.6330 - accuracy50: 0.6058 - val_loss: 11.1008 - val_accuracy10: 0.5388 - val_accuracy20: 0.5390 - val_accuracy30: 0.5297 - val_accuracy50: 0.5160 - 29s/epoch - 45ms/step
Epoch 20/50
653/653 - 29s - loss: 9.3392 - accuracy10: 0.6596 - accuracy20: 0.6535 - accuracy30: 0.6352 - accuracy50: 0.6074 - val_loss: 11.3626 - val_accuracy10: 0.5378 - val_accuracy20: 0.5367 - val_accuracy30: 0.5254 - val_accuracy50: 0.5106 - 29s/epoch - 45ms/step
Epoch 21/50
653/653 - 30s - loss: 9.2649 - accuracy10: 0.6613 - accuracy20: 0.6563 - accuracy30: 0.6389 - accuracy50: 0.6105 - val_loss: 11.2265 - val_accuracy10: 0.5545 - val_accuracy20: 0.5507 - val_accuracy30: 0.5347 - val_accuracy50: 0.5145 - 30s/epoch - 46ms/step
testing model: results/QRTEA/W1/deepLOB_L2/seq2seq
Evaluating performance on  test set...
1645/1645 - 27s - 27s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2167101
{'0': {'precision': 0.1666203219052604, 'recall': 0.5964516790116228, 'f1-score': 0.260475998695894, 'support': 34157}, '1': {'precision': 0.9508192675945119, 'recall': 0.32763898573153516, 'f1-score': 0.4873455345736944, 'support': 352806}, '2': {'precision': 0.142950679024192, 'recall': 0.7438540840602696, 'f1-score': 0.23981478412787094, 'support': 34047}, 'accuracy': 0.38310728961307333, 'macro avg': {'precision': 0.420130089507988, 'recall': 0.5559815829344759, 'f1-score': 0.3292121057991531, 'support': 421010}, 'weighted avg': {'precision': 0.8218641709864469, 'recall': 0.38310728961307333, 'f1-score': 0.44892159643111584, 'support': 421010}}
[[ 20373   3181  10603]
 [ 95976 115593 141237]
 [  5923   2798  25326]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2050629
{'0': {'precision': 0.21388413590809094, 'recall': 0.5796064018461933, 'f1-score': 0.31246400184310563, 'support': 46799}, '1': {'precision': 0.9196934974384384, 'recall': 0.31688266552036365, 'f1-score': 0.471357827620922, 'support': 328011}, '2': {'precision': 0.19057028679928464, 'recall': 0.7473160173160173, 'f1-score': 0.3036961455236352, 'support': 46200}, 'accuracy': 0.393320823733403, 'macro avg': {'precision': 0.44138264004860467, 'recall': 0.5479350282275247, 'f1-score': 0.3625059916625542, 'support': 421010}, 'weighted avg': {'precision': 0.7612253740166963, 'recall': 0.393320823733403, 'f1-score': 0.43529682701411776, 'support': 421010}}
[[ 27125   4612  15062]
 [ 92486 103941 131584]
 [  7210   4464  34526]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2033137
{'0': {'precision': 0.24221621827314585, 'recall': 0.5627442312792856, 'f1-score': 0.3386645384410747, 'support': 56555}, '1': {'precision': 0.8885962980341087, 'recall': 0.30039752164032707, 'f1-score': 0.4490050684053272, 'support': 308914}, '2': {'precision': 0.22233562294798687, 'recall': 0.7413082227543616, 'f1-score': 0.34207498182573476, 'support': 55541}, 'accuracy': 0.3938053727939954, 'macro avg': {'precision': 0.45104937975174714, 'recall': 0.5348166585579914, 'f1-score': 0.3765815295573789, 'support': 421010}, 'weighted avg': {'precision': 0.7138716844481141, 'recall': 0.3938053727939954, 'f1-score': 0.42007627191392455, 'support': 421010}}
[[ 31826   5673  19056]
 [ 91162  92797 124955]
 [  8407   5961  41173]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1929116
{'0': {'precision': 0.2870218085537912, 'recall': 0.5286414822663243, 'f1-score': 0.372044778830435, 'support': 73617}, '1': {'precision': 0.8247836578465635, 'recall': 0.2869695182192242, 'f1-score': 0.4257919365967466, 'support': 276329}, '2': {'precision': 0.2685165128356853, 'recall': 0.7151863109309918, 'f1-score': 0.39044176675974973, 'support': 71064}, 'accuracy': 0.4015082777131185, 'macro avg': {'precision': 0.4601073264120133, 'recall': 0.5102657704721801, 'f1-score': 0.3960928273956437, 'support': 421010}, 'weighted avg': {'precision': 0.6368570469526676, 'recall': 0.4015082777131185, 'f1-score': 0.41042691205438675, 'support': 421010}}
[[ 38917   7885  26815]
 [ 85393  79298 111638]
 [ 11279   8961  50824]]
Evaluating performance on  train set...
653/653 - 10s - 10s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0575724
{'0': {'precision': 0.26914051716205023, 'recall': 0.5386775946219725, 'f1-score': 0.35894210413278926, 'support': 21718}, '1': {'precision': 0.9068920433320882, 'recall': 0.46933071278403826, 'f1-score': 0.6185514477560444, 'support': 124147}, '2': {'precision': 0.24058308840917536, 'recall': 0.6765306607134375, 'f1-score': 0.35494361722011086, 'support': 21053}, 'accuracy': 0.5044872332522556, 'macro avg': {'precision': 0.47220521630110457, 'recall': 0.5615129893731493, 'f1-score': 0.44414572303631483, 'support': 166918}, 'weighted avg': {'precision': 0.7398729676580867, 'recall': 0.5044872332522556, 'f1-score': 0.5515249354501045, 'support': 166918}}
[[11699  2758  7261]
 [28183 58266 37698]
 [ 3586  3224 14243]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0443004
{'0': {'precision': 0.333561795268627, 'recall': 0.5319066422225356, 'f1-score': 0.4100062505095524, 'support': 28364}, '1': {'precision': 0.8562087240114146, 'recall': 0.47366331989210936, 'f1-score': 0.6099153201918944, 'support': 110853}, '2': {'precision': 0.30207246160727597, 'recall': 0.6582433847153533, 'f1-score': 0.4141079215116279, 'support': 27701}, 'accuracy': 0.5141925975628752, 'macro avg': {'precision': 0.4972809936291059, 'recall': 0.5546044489433327, 'f1-score': 0.4780098307376916, 'support': 166918}, 'weighted avg': {'precision': 0.6754344151189197, 'recall': 0.5141925975628752, 'f1-score': 0.54344986048526, 'support': 166918}}
[[15087  4032  9245]
 [25462 52507 32884]
 [ 4681  4786 18234]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0498023
{'0': {'precision': 0.36672801986131326, 'recall': 0.5178458097857294, 'f1-score': 0.42937867264731305, 'support': 33089}, '1': {'precision': 0.8089872223651488, 'recall': 0.46486965948849357, 'f1-score': 0.5904487701070288, 'support': 101465}, '2': {'precision': 0.33744284121572493, 'recall': 0.6452848844395007, 'f1-score': 0.4431476982165024, 'support': 32364}, 'accuracy': 0.5103523885979943, 'macro avg': {'precision': 0.5043860278140623, 'recall': 0.5426667845712413, 'f1-score': 0.48765838032361475, 'support': 166918}, 'weighted avg': {'precision': 0.6298874422145996, 'recall': 0.5103523885979943, 'f1-score': 0.5299585872297505, 'support': 166918}}
[[17135  5110 10844]
 [24136 47168 30161]
 [ 5453  6027 20884]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0665213
{'0': {'precision': 0.4059255560410295, 'recall': 0.4861214929984552, 'f1-score': 0.4424186763722122, 'support': 40134}, '1': {'precision': 0.721160279942854, 'recall': 0.4564632624795394, 'f1-score': 0.5590635076405439, 'support': 87363}, '2': {'precision': 0.38160420403411055, 'recall': 0.61525582811192, 'f1-score': 0.4710474951203643, 'support': 39421}, 'accuracy': 0.5010963467091626, 'macro avg': {'precision': 0.5028966800059981, 'recall': 0.5192801945299715, 'f1-score': 0.4908432263777068, 'support': 166918}, 'weighted avg': {'precision': 0.5651718875737003, 'recall': 0.5010963467091626, 'f1-score': 0.5102305304440689, 'support': 166918}}
[[19510  7080 13544]
 [21725 39878 25760]
 [ 6828  8339 24254]]
Evaluating performance on  val set...
181/181 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9441603
{'0': {'precision': 0.2773951792586591, 'recall': 0.5356933307256014, 'f1-score': 0.36551678121038234, 'support': 5113}, '1': {'precision': 0.9090695599079424, 'recall': 0.5335336439066075, 'f1-score': 0.6724221789883269, 'support': 36277}, '2': {'precision': 0.22082644628099174, 'recall': 0.6816326530612244, 'f1-score': 0.33358302122347067, 'support': 4900}, 'accuracy': 0.5494491250810111, 'macro avg': {'precision': 0.46909706181586436, 'recall': 0.5836198758978112, 'f1-score': 0.4571739938073933, 'support': 46290}, 'weighted avg': {'precision': 0.7664438877318387, 'recall': 0.5494491250810111, 'f1-score': 0.6026550765496483, 'support': 46290}}
[[ 2739  1036  1338]
 [ 6475 19355 10447]
 [  660   900  3340]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.94586694
{'0': {'precision': 0.35, 'recall': 0.5222222222222223, 'f1-score': 0.4191082802547771, 'support': 6930}, '1': {'precision': 0.8584070796460177, 'recall': 0.5304919034524901, 'f1-score': 0.6557395622863834, 'support': 32730}, '2': {'precision': 0.2815620428671373, 'recall': 0.6677224736048265, 'f1-score': 0.39609895763432196, 'support': 6630}, 'accuracy': 0.5489090516310218, 'macro avg': {'precision': 0.49665637417105163, 'recall': 0.5734788664265129, 'f1-score': 0.4903156000584941, 'support': 46290}, 'weighted avg': {'precision': 0.6996742290132486, 'recall': 0.5489090516310218, 'f1-score': 0.5831262118149598, 'support': 46290}}
[[ 3619  1496  1815]
 [ 5886 17363  9481]
 [  835  1368  4427]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9697659
{'0': {'precision': 0.3805115042625355, 'recall': 0.5053567080594108, 'f1-score': 0.434136903205564, 'support': 8214}, '1': {'precision': 0.8101411999370112, 'recall': 0.5109242584745762, 'f1-score': 0.626646907164173, 'support': 30208}, '2': {'precision': 0.31316595223515004, 'recall': 0.6499745805795628, 'f1-score': 0.42267956029423914, 'support': 7868}, 'accuracy': 0.5335709656513286, 'macro avg': {'precision': 0.5012728854782322, 'recall': 0.5554185157045167, 'f1-score': 0.49448779022132533, 'support': 46290}, 'weighted avg': {'precision': 0.6494330649361819, 'recall': 0.5335709656513286, 'f1-score': 0.5578179536604215, 'support': 46290}}
[[ 4151  1845  2218]
 [ 5776 15434  8998]
 [  982  1772  5114]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0072132
{'0': {'precision': 0.42547993019197206, 'recall': 0.470247854180731, 'f1-score': 0.44674515552705113, 'support': 10369}, '1': {'precision': 0.7229097832782663, 'recall': 0.4933501490483834, 'f1-score': 0.5864661654135339, 'support': 26166}, '2': {'precision': 0.356743062511047, 'recall': 0.6207073295745772, 'f1-score': 0.45308290930859035, 'support': 9755}, 'accuracy': 0.5150140419096997, 'macro avg': {'precision': 0.5017109253270952, 'recall': 0.5281017776012306, 'f1-score': 0.4954314100830585, 'support': 46290}, 'weighted avg': {'precision': 0.5791204873669245, 'recall': 0.5150140419096997, 'f1-score': 0.5270597965473282, 'support': 46290}}
[[ 4876  2512  2981]
 [ 5320 12909  7937]
 [ 1264  2436  6055]]
training model: results/QRTEA/W1/deepOF_L2/seq2seq
Epoch 1/50
653/653 - 23s - loss: 11.5871 - accuracy10: 0.5221 - accuracy20: 0.5238 - accuracy30: 0.5148 - accuracy50: 0.5000 - val_loss: 11.0260 - val_accuracy10: 0.7299 - val_accuracy20: 0.7086 - val_accuracy30: 0.6785 - val_accuracy50: 0.6207 - 23s/epoch - 36ms/step
Epoch 2/50
653/653 - 18s - loss: 10.4684 - accuracy10: 0.6172 - accuracy20: 0.6085 - accuracy30: 0.5915 - accuracy50: 0.5635 - val_loss: 10.5501 - val_accuracy10: 0.7495 - val_accuracy20: 0.7267 - val_accuracy30: 0.6947 - val_accuracy50: 0.6375 - 18s/epoch - 27ms/step
Epoch 3/50
653/653 - 17s - loss: 10.1366 - accuracy10: 0.6320 - accuracy20: 0.6216 - accuracy30: 0.6028 - accuracy50: 0.5739 - val_loss: 10.3525 - val_accuracy10: 0.7695 - val_accuracy20: 0.7433 - val_accuracy30: 0.7091 - val_accuracy50: 0.6465 - 17s/epoch - 27ms/step
Epoch 4/50
653/653 - 17s - loss: 9.9664 - accuracy10: 0.6410 - accuracy20: 0.6305 - accuracy30: 0.6110 - accuracy50: 0.5810 - val_loss: 10.3081 - val_accuracy10: 0.7740 - val_accuracy20: 0.7470 - val_accuracy30: 0.7116 - val_accuracy50: 0.6489 - 17s/epoch - 26ms/step
Epoch 5/50
653/653 - 18s - loss: 9.8663 - accuracy10: 0.6441 - accuracy20: 0.6339 - accuracy30: 0.6142 - accuracy50: 0.5849 - val_loss: 10.2087 - val_accuracy10: 0.7724 - val_accuracy20: 0.7465 - val_accuracy30: 0.7124 - val_accuracy50: 0.6494 - 18s/epoch - 28ms/step
Epoch 6/50
653/653 - 17s - loss: 9.8027 - accuracy10: 0.6471 - accuracy20: 0.6355 - accuracy30: 0.6169 - accuracy50: 0.5880 - val_loss: 10.1673 - val_accuracy10: 0.7751 - val_accuracy20: 0.7476 - val_accuracy30: 0.7135 - val_accuracy50: 0.6511 - 17s/epoch - 27ms/step
Epoch 7/50
653/653 - 17s - loss: 9.7407 - accuracy10: 0.6482 - accuracy20: 0.6379 - accuracy30: 0.6197 - accuracy50: 0.5924 - val_loss: 10.1037 - val_accuracy10: 0.7713 - val_accuracy20: 0.7450 - val_accuracy30: 0.7128 - val_accuracy50: 0.6507 - 17s/epoch - 26ms/step
Epoch 8/50
653/653 - 17s - loss: 9.6617 - accuracy10: 0.6524 - accuracy20: 0.6403 - accuracy30: 0.6223 - accuracy50: 0.5949 - val_loss: 10.0367 - val_accuracy10: 0.7664 - val_accuracy20: 0.7407 - val_accuracy30: 0.7077 - val_accuracy50: 0.6483 - 17s/epoch - 27ms/step
Epoch 9/50
653/653 - 17s - loss: 9.6151 - accuracy10: 0.6554 - accuracy20: 0.6429 - accuracy30: 0.6251 - accuracy50: 0.5962 - val_loss: 10.0755 - val_accuracy10: 0.7767 - val_accuracy20: 0.7480 - val_accuracy30: 0.7142 - val_accuracy50: 0.6520 - 17s/epoch - 26ms/step
Epoch 10/50
653/653 - 18s - loss: 9.5403 - accuracy10: 0.6567 - accuracy20: 0.6471 - accuracy30: 0.6292 - accuracy50: 0.6005 - val_loss: 10.0211 - val_accuracy10: 0.7682 - val_accuracy20: 0.7405 - val_accuracy30: 0.7081 - val_accuracy50: 0.6482 - 18s/epoch - 27ms/step
Epoch 11/50
653/653 - 17s - loss: 9.4828 - accuracy10: 0.6580 - accuracy20: 0.6483 - accuracy30: 0.6315 - accuracy50: 0.6023 - val_loss: 9.8996 - val_accuracy10: 0.7573 - val_accuracy20: 0.7315 - val_accuracy30: 0.6996 - val_accuracy50: 0.6445 - 17s/epoch - 27ms/step
Epoch 12/50
653/653 - 17s - loss: 9.4229 - accuracy10: 0.6605 - accuracy20: 0.6502 - accuracy30: 0.6332 - accuracy50: 0.6053 - val_loss: 10.0082 - val_accuracy10: 0.7591 - val_accuracy20: 0.7321 - val_accuracy30: 0.6997 - val_accuracy50: 0.6428 - 17s/epoch - 26ms/step
Epoch 13/50
653/653 - 17s - loss: 9.3771 - accuracy10: 0.6611 - accuracy20: 0.6517 - accuracy30: 0.6356 - accuracy50: 0.6078 - val_loss: 10.0375 - val_accuracy10: 0.7505 - val_accuracy20: 0.7240 - val_accuracy30: 0.6939 - val_accuracy50: 0.6391 - 17s/epoch - 26ms/step
Epoch 14/50
653/653 - 17s - loss: 9.3213 - accuracy10: 0.6637 - accuracy20: 0.6535 - accuracy30: 0.6364 - accuracy50: 0.6080 - val_loss: 10.0444 - val_accuracy10: 0.7467 - val_accuracy20: 0.7198 - val_accuracy30: 0.6883 - val_accuracy50: 0.6342 - 17s/epoch - 26ms/step
Epoch 15/50
653/653 - 17s - loss: 9.2668 - accuracy10: 0.6649 - accuracy20: 0.6561 - accuracy30: 0.6399 - accuracy50: 0.6114 - val_loss: 10.0888 - val_accuracy10: 0.7526 - val_accuracy20: 0.7243 - val_accuracy30: 0.6939 - val_accuracy50: 0.6389 - 17s/epoch - 27ms/step
Epoch 16/50
653/653 - 18s - loss: 9.2196 - accuracy10: 0.6650 - accuracy20: 0.6561 - accuracy30: 0.6395 - accuracy50: 0.6121 - val_loss: 10.2106 - val_accuracy10: 0.7409 - val_accuracy20: 0.7138 - val_accuracy30: 0.6822 - val_accuracy50: 0.6310 - 18s/epoch - 27ms/step
Epoch 17/50
653/653 - 17s - loss: 9.1650 - accuracy10: 0.6650 - accuracy20: 0.6579 - accuracy30: 0.6410 - accuracy50: 0.6135 - val_loss: 10.2617 - val_accuracy10: 0.7413 - val_accuracy20: 0.7119 - val_accuracy30: 0.6786 - val_accuracy50: 0.6249 - 17s/epoch - 27ms/step
Epoch 18/50
653/653 - 17s - loss: 9.1155 - accuracy10: 0.6665 - accuracy20: 0.6600 - accuracy30: 0.6439 - accuracy50: 0.6169 - val_loss: 10.2845 - val_accuracy10: 0.7421 - val_accuracy20: 0.7138 - val_accuracy30: 0.6812 - val_accuracy50: 0.6277 - 17s/epoch - 27ms/step
Epoch 19/50
653/653 - 18s - loss: 9.0667 - accuracy10: 0.6664 - accuracy20: 0.6606 - accuracy30: 0.6453 - accuracy50: 0.6177 - val_loss: 10.3869 - val_accuracy10: 0.7460 - val_accuracy20: 0.7164 - val_accuracy30: 0.6813 - val_accuracy50: 0.6281 - 18s/epoch - 27ms/step
Epoch 20/50
653/653 - 17s - loss: 9.0049 - accuracy10: 0.6681 - accuracy20: 0.6630 - accuracy30: 0.6472 - accuracy50: 0.6210 - val_loss: 10.4634 - val_accuracy10: 0.7408 - val_accuracy20: 0.7123 - val_accuracy30: 0.6779 - val_accuracy50: 0.6227 - 17s/epoch - 26ms/step
Epoch 21/50
653/653 - 17s - loss: 8.9397 - accuracy10: 0.6704 - accuracy20: 0.6653 - accuracy30: 0.6497 - accuracy50: 0.6224 - val_loss: 10.5627 - val_accuracy10: 0.7207 - val_accuracy20: 0.6933 - val_accuracy30: 0.6623 - val_accuracy50: 0.6108 - 17s/epoch - 26ms/step
testing model: results/QRTEA/W1/deepOF_L2/seq2seq
Evaluating performance on  test set...
1645/1645 - 16s - 16s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5611189
{'0': {'precision': 0.28940527425550966, 'recall': 0.5867248345728172, 'f1-score': 0.38761654222600483, 'support': 34154}, '1': {'precision': 0.9254035840292408, 'recall': 0.8267007930704127, 'f1-score': 0.8732720342763728, 'support': 352806}, '2': {'precision': 0.4044606007598327, 'recall': 0.43466000881186667, 'f1-score': 0.41901687620342054, 'support': 34045}, 'accuracy': 0.7755299818291944, 'macro avg': {'precision': 0.5397564863481944, 'recall': 0.6160285454850322, 'f1-score': 0.559968484235266, 'support': 421005}, 'weighted avg': {'precision': 0.8316816801624957, 'recall': 0.7755299818291944, 'f1-score': 0.7971394597651867, 'support': 421005}}
[[ 20039  10406   3709]
 [ 43061 291665  18080]
 [  6142  13105  14798]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.626992
{'0': {'precision': 0.34200549772665095, 'recall': 0.560988118642619, 'f1-score': 0.424944356764194, 'support': 46796}, '1': {'precision': 0.8795951369293519, 'recall': 0.8191920392913652, 'f1-score': 0.8483197236924563, 'support': 328011}, '2': {'precision': 0.47814757481940146, 'recall': 0.4011645525780337, 'f1-score': 0.43628616492855293, 'support': 46198}, 'accuracy': 0.7446206102065296, 'macro avg': {'precision': 0.5665827364918015, 'recall': 0.5937815701706727, 'f1-score': 0.5698500817950678, 'support': 421005}, 'weighted avg': {'precision': 0.7757884856295215, 'recall': 0.7446206102065296, 'f1-score': 0.7560467102637565, 'support': 421005}}
[[ 26252  16314   4230]
 [ 43310 268704  15997]
 [  7197  20468  18533]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.69352055
{'0': {'precision': 0.36801822211881113, 'recall': 0.5314047248550007, 'f1-score': 0.43487131993835515, 'support': 56552}, '1': {'precision': 0.8366596814472125, 'recall': 0.8090666010604893, 'f1-score': 0.8226318214732408, 'support': 308914}, '2': {'precision': 0.5073609059576564, 'recall': 0.37107257962872936, 'f1-score': 0.4286442246695577, 'support': 55539}, 'accuracy': 0.7139891450220306, 'macro avg': {'precision': 0.5706796031745599, 'recall': 0.5705146351814064, 'f1-score': 0.5620491220270513, 'support': 421005}, 'weighted avg': {'precision': 0.7302677466724372, 'recall': 0.7139891450220306, 'f1-score': 0.7185705656171807, 'support': 421005}}
[[ 30052  21896   4604]
 [ 43575 249932  15407]
 [  8032  26898  20609]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.788332
{'0': {'precision': 0.4138892862251466, 'recall': 0.4716765832586193, 'f1-score': 0.44089748961944303, 'support': 73614}, '1': {'precision': 0.7549745927719999, 'recall': 0.8054348258778485, 'f1-score': 0.7793888224510485, 'support': 276329}, '2': {'precision': 0.5360983102918587, 'recall': 0.3192282795305508, 'f1-score': 0.4001693465164893, 'support': 71062}, 'accuracy': 0.6650087291124809, 'macro avg': {'precision': 0.5683207297630016, 'recall': 0.5321132295556729, 'f1-score': 0.5401518861956602, 'support': 421005}, 'weighted avg': {'precision': 0.6583903713453092, 'recall': 0.6650087291124809, 'f1-score': 0.6561936219809176, 'support': 421005}}
[[ 34722  33252   5640]
 [ 39774 222565  13990]
 [  9396  38981  22685]]
Evaluating performance on  train set...
653/653 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6916877
{'0': {'precision': 0.3637753569770934, 'recall': 0.6161102376768705, 'f1-score': 0.45745283504712203, 'support': 21626}, '1': {'precision': 0.8878504672897196, 'recall': 0.7830636722208806, 'f1-score': 0.8321713616027511, 'support': 124230}, '2': {'precision': 0.4466052212517493, 'recall': 0.4394169594530434, 'f1-score': 0.44298193131506525, 'support': 21062}, 'accuracy': 0.7180711487077487, 'macro avg': {'precision': 0.5660770151728541, 'recall': 0.6128636231169314, 'f1-score': 0.5775353759883127, 'support': 166918}, 'weighted avg': {'precision': 0.7642738865274735, 'recall': 0.7180711487077487, 'f1-score': 0.7345140050803193, 'support': 166918}}
[[13324  5134  3168]
 [18650 97280  8300]
 [ 4653  7154  9255]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.73441905
{'0': {'precision': 0.4282175089111914, 'recall': 0.5984455043278573, 'f1-score': 0.49921900327134483, 'support': 28305}, '1': {'precision': 0.827116151474872, 'recall': 0.7912022508386538, 'f1-score': 0.8087606985329701, 'support': 110892}, '2': {'precision': 0.5236797594437136, 'recall': 0.4020778471195123, 'f1-score': 0.454892357922661, 'support': 27721}, 'accuracy': 0.6938916114499335, 'macro avg': {'precision': 0.5930044732765923, 'recall': 0.5972418674286745, 'f1-score': 0.5876240199089919, 'support': 166918}, 'weighted avg': {'precision': 0.7090798324364177, 'recall': 0.6938916114499335, 'f1-score': 0.6975015056691766, 'support': 166918}}
[[16939  7765  3601]
 [16617 87738  6537]
 [ 6001 10574 11146]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.78281724
{'0': {'precision': 0.4594366061074604, 'recall': 0.5752790634358834, 'f1-score': 0.5108732152211581, 'support': 33057}, '1': {'precision': 0.7737263654193598, 'recall': 0.7889095763020756, 'f1-score': 0.781244207712644, 'support': 101511}, '2': {'precision': 0.5520138037506244, 'recall': 0.37579598145285936, 'f1-score': 0.44717047063800053, 'support': 32350}, 'accuracy': 0.6665368624114835, 'macro avg': {'precision': 0.5950589250924815, 'recall': 0.5799948737302728, 'f1-score': 0.5797626311906009, 'support': 166918}, 'weighted avg': {'precision': 0.6685137583694487, 'recall': 0.6665368624114835, 'f1-score': 0.6629529551625549, 'support': 166918}}
[[19017 10000  4040]
 [15602 80083  5826]
 [ 6773 13420 12157]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8644078
{'0': {'precision': 0.49610279181822475, 'recall': 0.5239734570673052, 'f1-score': 0.5096573813452393, 'support': 40086}, '1': {'precision': 0.6768253157594925, 'recall': 0.7883790369633112, 'f1-score': 0.7283555903164949, 'support': 87411}, '2': {'precision': 0.5742026183990862, 'recall': 0.331549174297963, 'f1-score': 0.42037212743032665, 'support': 39421}, 'accuracy': 0.6169915767023328, 'macro avg': {'precision': 0.5823769086589344, 'recall': 0.5479672227761933, 'f1-score': 0.5527950330306869, 'support': 166918}, 'weighted avg': {'precision': 0.6091877185719259, 'recall': 0.6169915767023328, 'f1-score': 0.6030979638456685, 'support': 166918}}
[[21004 14407  4675]
 [13481 68913  5017]
 [ 7853 18498 13070]]
Evaluating performance on  val set...
181/181 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6220656
{'0': {'precision': 0.3884042410414709, 'recall': 0.5704711216242855, 'f1-score': 0.46215266687959117, 'support': 5073}, '1': {'precision': 0.9040796503156873, 'recall': 0.8202924894654218, 'f1-score': 0.8601504627958355, 'support': 36309}, '2': {'precision': 0.41306191687871074, 'recall': 0.49612876935615324, 'f1-score': 0.4508007035082847, 'support': 4908}, 'accuracy': 0.7585439619788291, 'macro avg': {'precision': 0.5685152694119563, 'recall': 0.6289641268152869, 'f1-score': 0.5910346110612371, 'support': 46290}, 'weighted avg': {'precision': 0.7955046581584874, 'recall': 0.7585439619788291, 'f1-score': 0.7731309891024588, 'support': 46290}}
[[ 2894  1463   716]
 [ 3781 29784  2744]
 [  776  1697  2435]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6710952
{'0': {'precision': 0.4678514130568925, 'recall': 0.5484664351851852, 'f1-score': 0.5049617049617049, 'support': 6912}, '1': {'precision': 0.8454974525677492, 'recall': 0.826383160724651, 'f1-score': 0.8358310416216049, 'support': 32733}, '2': {'precision': 0.4924120116241524, 'recall': 0.45899172310007524, 'f1-score': 0.47511488433678634, 'support': 6645}, 'accuracy': 0.7321451717433571, 'macro avg': {'precision': 0.6019202924162647, 'recall': 0.6112804396699706, 'f1-score': 0.605302543640032, 'support': 46290}, 'weighted avg': {'precision': 0.7384215791573097, 'recall': 0.7321451717433571, 'f1-score': 0.7346444414887285, 'support': 46290}}
[[ 3791  2293   828]
 [ 3367 27050  2316]
 [  945  2650  3050]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.73272836
{'0': {'precision': 0.5031041349420171, 'recall': 0.5244200244200244, 'f1-score': 0.51354098164644, 'support': 8190}, '1': {'precision': 0.7923239031866658, 'recall': 0.8218733439321675, 'f1-score': 0.8068281580230857, 'support': 30192}, '2': {'precision': 0.5226107226107226, 'recall': 0.42526555386949927, 'f1-score': 0.4689395523948965, 'support': 7908}, 'accuracy': 0.7014906027219702, 'macro avg': {'precision': 0.6060129202464685, 'recall': 0.5905196407405637, 'f1-score': 0.5964362306881407, 'support': 46290}, 'weighted avg': {'precision': 0.6950760800300828, 'recall': 0.7014906027219702, 'f1-score': 0.6972138770156878, 'support': 46290}}
[[ 4295  3028   867]
 [ 3173 24814  2205]
 [ 1069  3476  3363]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8290708
{'0': {'precision': 0.54733492442323, 'recall': 0.4651791751183232, 'f1-score': 0.5029239766081871, 'support': 10353}, '1': {'precision': 0.6940356564019449, 'recall': 0.8190268533394538, 'f1-score': 0.7513686131386862, 'support': 26142}, '2': {'precision': 0.5444963107965668, 'recall': 0.36916794282797344, 'f1-score': 0.4400097347286444, 'support': 9795}, 'accuracy': 0.644696478721106, 'macro avg': {'precision': 0.595288963873914, 'recall': 0.5511246570952502, 'f1-score': 0.5647674414918392, 'support': 46290}, 'weighted avg': {'precision': 0.6295826305134092, 'recall': 0.644696478721106, 'f1-score': 0.6299188931985994, 'support': 46290}}
[[ 4816  4519  1018]
 [ 2724 21411  2007]
 [ 1259  4920  3616]]
training model: results/QRTEA/W1/deepVOL_L2/seq2seq
Epoch 1/50
653/653 - 24s - loss: 11.2407 - accuracy10: 0.5635 - accuracy20: 0.5548 - accuracy30: 0.5416 - accuracy50: 0.5241 - val_loss: 10.5799 - val_accuracy10: 0.7199 - val_accuracy20: 0.6993 - val_accuracy30: 0.6709 - val_accuracy50: 0.6178 - 24s/epoch - 36ms/step
Epoch 2/50
653/653 - 18s - loss: 10.4759 - accuracy10: 0.6241 - accuracy20: 0.6171 - accuracy30: 0.5991 - accuracy50: 0.5710 - val_loss: 10.5045 - val_accuracy10: 0.7097 - val_accuracy20: 0.6961 - val_accuracy30: 0.6704 - val_accuracy50: 0.6169 - 18s/epoch - 27ms/step
Epoch 3/50
653/653 - 17s - loss: 10.2492 - accuracy10: 0.6369 - accuracy20: 0.6301 - accuracy30: 0.6094 - accuracy50: 0.5788 - val_loss: 10.2219 - val_accuracy10: 0.7234 - val_accuracy20: 0.7084 - val_accuracy30: 0.6815 - val_accuracy50: 0.6247 - 17s/epoch - 26ms/step
Epoch 4/50
653/653 - 17s - loss: 10.1289 - accuracy10: 0.6437 - accuracy20: 0.6359 - accuracy30: 0.6156 - accuracy50: 0.5844 - val_loss: 10.1191 - val_accuracy10: 0.7186 - val_accuracy20: 0.7063 - val_accuracy30: 0.6829 - val_accuracy50: 0.6301 - 17s/epoch - 26ms/step
Epoch 5/50
653/653 - 17s - loss: 10.0340 - accuracy10: 0.6471 - accuracy20: 0.6390 - accuracy30: 0.6207 - accuracy50: 0.5900 - val_loss: 10.1247 - val_accuracy10: 0.6809 - val_accuracy20: 0.6718 - val_accuracy30: 0.6502 - val_accuracy50: 0.6063 - 17s/epoch - 25ms/step
Epoch 6/50
653/653 - 17s - loss: 9.9458 - accuracy10: 0.6503 - accuracy20: 0.6417 - accuracy30: 0.6234 - accuracy50: 0.5918 - val_loss: 10.1245 - val_accuracy10: 0.7013 - val_accuracy20: 0.6883 - val_accuracy30: 0.6640 - val_accuracy50: 0.6151 - 17s/epoch - 25ms/step
Epoch 7/50
653/653 - 18s - loss: 9.8740 - accuracy10: 0.6537 - accuracy20: 0.6439 - accuracy30: 0.6254 - accuracy50: 0.5933 - val_loss: 10.2668 - val_accuracy10: 0.7278 - val_accuracy20: 0.7076 - val_accuracy30: 0.6770 - val_accuracy50: 0.6218 - 18s/epoch - 27ms/step
Epoch 8/50
653/653 - 17s - loss: 9.8218 - accuracy10: 0.6550 - accuracy20: 0.6470 - accuracy30: 0.6277 - accuracy50: 0.5950 - val_loss: 10.1304 - val_accuracy10: 0.7238 - val_accuracy20: 0.7049 - val_accuracy30: 0.6749 - val_accuracy50: 0.6214 - 17s/epoch - 27ms/step
Epoch 9/50
653/653 - 17s - loss: 9.7756 - accuracy10: 0.6565 - accuracy20: 0.6482 - accuracy30: 0.6294 - accuracy50: 0.5971 - val_loss: 10.1042 - val_accuracy10: 0.7340 - val_accuracy20: 0.7151 - val_accuracy30: 0.6860 - val_accuracy50: 0.6288 - 17s/epoch - 26ms/step
Epoch 10/50
653/653 - 17s - loss: 9.6925 - accuracy10: 0.6596 - accuracy20: 0.6499 - accuracy30: 0.6300 - accuracy50: 0.5978 - val_loss: 10.0573 - val_accuracy10: 0.7435 - val_accuracy20: 0.7213 - val_accuracy30: 0.6912 - val_accuracy50: 0.6320 - 17s/epoch - 26ms/step
Epoch 11/50
653/653 - 17s - loss: 9.6532 - accuracy10: 0.6600 - accuracy20: 0.6508 - accuracy30: 0.6322 - accuracy50: 0.5997 - val_loss: 9.9504 - val_accuracy10: 0.7416 - val_accuracy20: 0.7207 - val_accuracy30: 0.6895 - val_accuracy50: 0.6315 - 17s/epoch - 26ms/step
Epoch 12/50
653/653 - 17s - loss: 9.6171 - accuracy10: 0.6615 - accuracy20: 0.6525 - accuracy30: 0.6320 - accuracy50: 0.5996 - val_loss: 9.9809 - val_accuracy10: 0.7323 - val_accuracy20: 0.7146 - val_accuracy30: 0.6857 - val_accuracy50: 0.6297 - 17s/epoch - 26ms/step
Epoch 13/50
653/653 - 18s - loss: 9.5608 - accuracy10: 0.6633 - accuracy20: 0.6542 - accuracy30: 0.6350 - accuracy50: 0.6030 - val_loss: 10.0738 - val_accuracy10: 0.7167 - val_accuracy20: 0.6993 - val_accuracy30: 0.6717 - val_accuracy50: 0.6178 - 18s/epoch - 28ms/step
Epoch 14/50
653/653 - 18s - loss: 9.5348 - accuracy10: 0.6636 - accuracy20: 0.6542 - accuracy30: 0.6341 - accuracy50: 0.6023 - val_loss: 10.1013 - val_accuracy10: 0.7496 - val_accuracy20: 0.7265 - val_accuracy30: 0.6962 - val_accuracy50: 0.6362 - 18s/epoch - 27ms/step
Epoch 15/50
653/653 - 17s - loss: 9.5046 - accuracy10: 0.6641 - accuracy20: 0.6553 - accuracy30: 0.6364 - accuracy50: 0.6045 - val_loss: 10.0597 - val_accuracy10: 0.7228 - val_accuracy20: 0.7028 - val_accuracy30: 0.6749 - val_accuracy50: 0.6222 - 17s/epoch - 27ms/step
Epoch 16/50
653/653 - 17s - loss: 9.4691 - accuracy10: 0.6653 - accuracy20: 0.6563 - accuracy30: 0.6371 - accuracy50: 0.6059 - val_loss: 10.0431 - val_accuracy10: 0.7357 - val_accuracy20: 0.7162 - val_accuracy30: 0.6860 - val_accuracy50: 0.6292 - 17s/epoch - 26ms/step
Epoch 17/50
653/653 - 17s - loss: 9.4285 - accuracy10: 0.6648 - accuracy20: 0.6572 - accuracy30: 0.6381 - accuracy50: 0.6052 - val_loss: 10.0943 - val_accuracy10: 0.7374 - val_accuracy20: 0.7164 - val_accuracy30: 0.6860 - val_accuracy50: 0.6288 - 17s/epoch - 26ms/step
Epoch 18/50
653/653 - 18s - loss: 9.3865 - accuracy10: 0.6662 - accuracy20: 0.6576 - accuracy30: 0.6390 - accuracy50: 0.6079 - val_loss: 10.1286 - val_accuracy10: 0.7437 - val_accuracy20: 0.7219 - val_accuracy30: 0.6913 - val_accuracy50: 0.6310 - 18s/epoch - 27ms/step
Epoch 19/50
653/653 - 17s - loss: 9.3476 - accuracy10: 0.6665 - accuracy20: 0.6586 - accuracy30: 0.6396 - accuracy50: 0.6088 - val_loss: 10.1671 - val_accuracy10: 0.7433 - val_accuracy20: 0.7209 - val_accuracy30: 0.6895 - val_accuracy50: 0.6314 - 17s/epoch - 26ms/step
Epoch 20/50
653/653 - 17s - loss: 9.3079 - accuracy10: 0.6679 - accuracy20: 0.6597 - accuracy30: 0.6413 - accuracy50: 0.6122 - val_loss: 10.1937 - val_accuracy10: 0.7474 - val_accuracy20: 0.7242 - val_accuracy30: 0.6941 - val_accuracy50: 0.6355 - 17s/epoch - 26ms/step
Epoch 21/50
653/653 - 17s - loss: 9.2652 - accuracy10: 0.6692 - accuracy20: 0.6605 - accuracy30: 0.6419 - accuracy50: 0.6114 - val_loss: 10.2634 - val_accuracy10: 0.7611 - val_accuracy20: 0.7366 - val_accuracy30: 0.7049 - val_accuracy50: 0.6420 - 17s/epoch - 26ms/step
testing model: results/QRTEA/W1/deepVOL_L2/seq2seq
Evaluating performance on  test set...
1645/1645 - 15s - 15s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5538735
{'0': {'precision': 0.30045817321903634, 'recall': 0.5951635096759083, 'f1-score': 0.39932427787108243, 'support': 34157}, '1': {'precision': 0.9282389560866686, 'recall': 0.8224378270210824, 'f1-score': 0.8721413768280386, 'support': 352806}, '2': {'precision': 0.3858723654832299, 'recall': 0.4619202866625547, 'f1-score': 0.42048553553285917, 'support': 34047}, 'accuracy': 0.7748438279375787, 'macro avg': {'precision': 0.5381898315963116, 'recall': 0.6265072077865151, 'f1-score': 0.5639837300773267, 'support': 421010}, 'weighted avg': {'precision': 0.833445332394393, 'recall': 0.7748438279375787, 'f1-score': 0.7972558869877743, 'support': 421010}}
[[ 20329  10267   3561]
 [ 41176 290161  21469]
 [  6155  12165  15727]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6063942
{'0': {'precision': 0.35591507971656333, 'recall': 0.5495202888950619, 'f1-score': 0.4320188148334803, 'support': 46799}, '1': {'precision': 0.881569986999319, 'recall': 0.8248503861150998, 'f1-score': 0.8522675369102781, 'support': 328011}, '2': {'precision': 0.4697349869763663, 'recall': 0.42547619047619045, 'f1-score': 0.44651152225515917, 'support': 46200}, 'accuracy': 0.7504192299470321, 'macro avg': {'precision': 0.5690733512307495, 'recall': 0.5999489551621173, 'f1-score': 0.5769326246663059, 'support': 421010}, 'weighted avg': {'precision': 0.7779456051390637, 'recall': 0.7504192299470321, 'f1-score': 0.7610270727371266, 'support': 421010}}
[[ 25717  16843   4239]
 [ 39500 270560  17951]
 [  7039  19504  19657]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.66920024
{'0': {'precision': 0.3782900176824537, 'recall': 0.5258067368048802, 'f1-score': 0.4400136130922435, 'support': 56555}, '1': {'precision': 0.8386043290965625, 'recall': 0.8154534919103699, 'f1-score': 0.8268668964385361, 'support': 308914}, '2': {'precision': 0.5112459835772938, 'recall': 0.3867413262274716, 'f1-score': 0.44036245848538275, 'support': 55541}, 'accuracy': 0.7199876487494359, 'macro avg': {'precision': 0.5760467767854366, 'recall': 0.5760005183142405, 'f1-score': 0.5690809893387208, 'support': 421010}, 'weighted avg': {'precision': 0.7335833420641628, 'recall': 0.7199876487494359, 'f1-score': 0.7239113124191405, 'support': 421010}}
[[ 29737  22462   4356]
 [ 40830 251905  16179]
 [  8042  26019  21480]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7718954
{'0': {'precision': 0.412892228483963, 'recall': 0.48367904152573454, 'f1-score': 0.44549122642394673, 'support': 73617}, '1': {'precision': 0.7582032690180657, 'recall': 0.8037592869369483, 'f1-score': 0.7803169372221178, 'support': 276329}, '2': {'precision': 0.5509560229445507, 'recall': 0.3243836541708882, 'f1-score': 0.4083469141925884, 'support': 71064}, 'accuracy': 0.6668748960832285, 'macro avg': {'precision': 0.5740171734821932, 'recall': 0.5372739942111904, 'f1-score': 0.5447183592795509, 'support': 421010}, 'weighted avg': {'precision': 0.6628407332921511, 'recall': 0.6668748960832285, 'f1-score': 0.658983614810775, 'support': 421010}}
[[ 35607  32998   5012]
 [ 40451 222102  13776]
 [ 10180  37832  23052]]
Evaluating performance on  train set...
653/653 - 6s - 6s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6987312
{'0': {'precision': 0.36040309903435885, 'recall': 0.5911686158946496, 'f1-score': 0.4478044016602142, 'support': 21718}, '1': {'precision': 0.8946149053812008, 'recall': 0.7402675860069111, 'f1-score': 0.8101553719008264, 'support': 124147}, '2': {'precision': 0.3898690751242736, 'recall': 0.5289982425307557, 'f1-score': 0.44890062274531933, 'support': 21053}, 'accuracy': 0.6942211145592446, 'macro avg': {'precision': 0.5482956931799444, 'recall': 0.6201448148107721, 'f1-score': 0.5689534654354533, 'support': 166918}, 'weighted avg': {'precision': 0.7614451694950782, 'recall': 0.6942211145592446, 'f1-score': 0.7174449715506155, 'support': 166918}}
[[12839  5017  3862]
 [18678 91902 13567]
 [ 4107  5809 11137]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.733569
{'0': {'precision': 0.4277282970275781, 'recall': 0.5621209984487379, 'f1-score': 0.48580134064594765, 'support': 28364}, '1': {'precision': 0.832510844907868, 'recall': 0.7548194455720639, 'f1-score': 0.7917638542588273, 'support': 110853}, '2': {'precision': 0.4665339465916112, 'recall': 0.49066820692393776, 'f1-score': 0.4782968241400546, 'support': 27701}, 'accuracy': 0.6782372182748415, 'macro avg': {'precision': 0.5755910295090191, 'recall': 0.6025362169815799, 'f1-score': 0.58528733968161, 'support': 166918}, 'weighted avg': {'precision': 0.7029910912064387, 'recall': 0.6782372182748415, 'f1-score': 0.6877506805002402, 'support': 166918}}
[[15944  7851  4569]
 [16206 83674 10973]
 [ 5126  8983 13592]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.78051496
{'0': {'precision': 0.45373643177659123, 'recall': 0.5470095802230348, 'f1-score': 0.4960263085776925, 'support': 33089}, '1': {'precision': 0.7771657077569674, 'recall': 0.7508401911989356, 'f1-score': 0.7637761725975348, 'support': 101465}, '2': {'precision': 0.5024311183144247, 'recall': 0.4501915708812261, 'f1-score': 0.4748789987451722, 'support': 32364}, 'accuracy': 0.6521405720173977, 'macro avg': {'precision': 0.5777777526159945, 'recall': 0.5826804474343988, 'f1-score': 0.5782271599734665, 'support': 166918}, 'weighted avg': {'precision': 0.6597819530652437, 'recall': 0.6521405720173977, 'f1-score': 0.6546840232480912, 'support': 166918}}
[[18100 10082  4907]
 [15759 76184  9522]
 [ 6032 11762 14570]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8659223
{'0': {'precision': 0.48512217321291046, 'recall': 0.5179399013305427, 'f1-score': 0.5009941795307473, 'support': 40134}, '1': {'precision': 0.6808352210755936, 'recall': 0.7430949028765038, 'f1-score': 0.7106039460361766, 'support': 87363}, '2': {'precision': 0.5378347320402549, 'recall': 0.39179625072930674, 'f1-score': 0.4533446828495113, 'support': 39421}, 'accuracy': 0.605992163816964, 'macro avg': {'precision': 0.567930708776253, 'recall': 0.5509436849787844, 'f1-score': 0.5549809361388117, 'support': 166918}, 'weighted avg': {'precision': 0.6000052941582867, 'recall': 0.605992163816964, 'f1-score': 0.599448194211865, 'support': 166918}}
[[20787 13864  5483]
 [14655 64919  7789]
 [ 7407 16569 15445]]
Evaluating performance on  val set...
181/181 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.63729554
{'0': {'precision': 0.37050586602750096, 'recall': 0.5744181498141991, 'f1-score': 0.45046012269938657, 'support': 5113}, '1': {'precision': 0.9064030131826742, 'recall': 0.7960415690382336, 'f1-score': 0.8476451854352262, 'support': 36277}, '2': {'precision': 0.38536060279870826, 'recall': 0.5114285714285715, 'f1-score': 0.43953345610804173, 'support': 4900}, 'accuracy': 0.7414344350831713, 'macro avg': {'precision': 0.5540898273362945, 'recall': 0.6272960967603347, 'f1-score': 0.5792129214142182, 'support': 46290}, 'weighted avg': {'precision': 0.7920554235459095, 'recall': 0.7414344350831713, 'f1-score': 0.7605733621586749, 'support': 46290}}
[[ 2937  1341   835]
 [ 4237 28878  3162]
 [  753  1641  2506]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6787073
{'0': {'precision': 0.44988624116872233, 'recall': 0.5421356421356421, 'f1-score': 0.4917217459590341, 'support': 6930}, '1': {'precision': 0.8478545640435796, 'recall': 0.8107852123434158, 'f1-score': 0.8289056521263802, 'support': 32730}, '2': {'precision': 0.4661144578313253, 'recall': 0.46681749622926094, 'f1-score': 0.46646571213263005, 'support': 6630}, 'accuracy': 0.721300496867574, 'macro avg': {'precision': 0.5879517543478757, 'recall': 0.6065794502361063, 'f1-score': 0.5956977034060148, 'support': 46290}, 'weighted avg': {'precision': 0.7335997059379411, 'recall': 0.721300496867574, 'f1-score': 0.7265150435306086, 'support': 46290}}
[[ 3757  2169  1004]
 [ 3652 26537  2541]
 [  942  2593  3095]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7367817
{'0': {'precision': 0.4757787384990578, 'recall': 0.5225225225225225, 'f1-score': 0.4980562808239049, 'support': 8214}, '1': {'precision': 0.7939880544404191, 'recall': 0.8053164724576272, 'f1-score': 0.7996121419297583, 'support': 30208}, '2': {'precision': 0.503921568627451, 'recall': 0.4246314184036604, 'f1-score': 0.4608911574010209, 'support': 7868}, 'accuracy': 0.6904298984661914, 'macro avg': {'precision': 0.5912294538556426, 'recall': 0.58415680446127, 'f1-score': 0.586186526718228, 'support': 46290}, 'weighted avg': {'precision': 0.6882197582313291, 'recall': 0.6904298984661914, 'f1-score': 0.6885290451616533, 'support': 46290}}
[[ 4292  2887  1035]
 [ 3627 24327  2254]
 [ 1102  3425  3341]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.83580655
{'0': {'precision': 0.5022933442054837, 'recall': 0.4752628025846273, 'f1-score': 0.488404360753221, 'support': 10369}, '1': {'precision': 0.6946776837386679, 'recall': 0.7936253152946572, 'f1-score': 0.7408623057849765, 'support': 26166}, '2': {'precision': 0.5364409353173398, 'recall': 0.36217324449000515, 'f1-score': 0.43240927727801237, 'support': 9755}, 'accuracy': 0.6313890689133722, 'macro avg': {'precision': 0.5778039877538305, 'recall': 0.5436871207897632, 'f1-score': 0.55389198127207, 'support': 46290}, 'weighted avg': {'precision': 0.6182371415595873, 'recall': 0.6313890689133722, 'f1-score': 0.6193091468927815, 'support': 46290}}
[[ 4928  4289  1152]
 [ 3499 20766  1901]
 [ 1384  4838  3533]]
training model: results/QRTEA/W1/deepVOL_L3/seq2seq
Epoch 1/50
653/653 - 32s - loss: 12.0137 - accuracy10: 0.4532 - accuracy20: 0.4625 - accuracy30: 0.4663 - accuracy50: 0.4660 - val_loss: 11.0101 - val_accuracy10: 0.6737 - val_accuracy20: 0.6594 - val_accuracy30: 0.6368 - val_accuracy50: 0.5948 - 32s/epoch - 48ms/step
Epoch 2/50
653/653 - 24s - loss: 10.7294 - accuracy10: 0.5923 - accuracy20: 0.5922 - accuracy30: 0.5827 - accuracy50: 0.5618 - val_loss: 10.1876 - val_accuracy10: 0.7127 - val_accuracy20: 0.6927 - val_accuracy30: 0.6666 - val_accuracy50: 0.6172 - 24s/epoch - 37ms/step
Epoch 3/50
653/653 - 25s - loss: 10.2679 - accuracy10: 0.6311 - accuracy20: 0.6226 - accuracy30: 0.6072 - accuracy50: 0.5799 - val_loss: 9.8744 - val_accuracy10: 0.7166 - val_accuracy20: 0.7003 - val_accuracy30: 0.6752 - val_accuracy50: 0.6266 - 25s/epoch - 39ms/step
Epoch 4/50
653/653 - 26s - loss: 10.0866 - accuracy10: 0.6391 - accuracy20: 0.6293 - accuracy30: 0.6114 - accuracy50: 0.5825 - val_loss: 9.8458 - val_accuracy10: 0.6995 - val_accuracy20: 0.6847 - val_accuracy30: 0.6618 - val_accuracy50: 0.6175 - 26s/epoch - 39ms/step
Epoch 5/50
653/653 - 26s - loss: 9.9622 - accuracy10: 0.6455 - accuracy20: 0.6372 - accuracy30: 0.6184 - accuracy50: 0.5887 - val_loss: 9.6833 - val_accuracy10: 0.7303 - val_accuracy20: 0.7108 - val_accuracy30: 0.6835 - val_accuracy50: 0.6324 - 26s/epoch - 40ms/step
Epoch 6/50
653/653 - 25s - loss: 9.8799 - accuracy10: 0.6510 - accuracy20: 0.6412 - accuracy30: 0.6225 - accuracy50: 0.5906 - val_loss: 9.7004 - val_accuracy10: 0.7284 - val_accuracy20: 0.7084 - val_accuracy30: 0.6811 - val_accuracy50: 0.6310 - 25s/epoch - 39ms/step
Epoch 7/50
653/653 - 27s - loss: 9.7940 - accuracy10: 0.6540 - accuracy20: 0.6445 - accuracy30: 0.6251 - accuracy50: 0.5937 - val_loss: 9.7714 - val_accuracy10: 0.7300 - val_accuracy20: 0.7105 - val_accuracy30: 0.6818 - val_accuracy50: 0.6294 - 27s/epoch - 41ms/step
Epoch 8/50
653/653 - 25s - loss: 9.7221 - accuracy10: 0.6582 - accuracy20: 0.6478 - accuracy30: 0.6290 - accuracy50: 0.5958 - val_loss: 9.6428 - val_accuracy10: 0.7304 - val_accuracy20: 0.7126 - val_accuracy30: 0.6854 - val_accuracy50: 0.6331 - 25s/epoch - 39ms/step
Epoch 9/50
653/653 - 25s - loss: 9.6890 - accuracy10: 0.6583 - accuracy20: 0.6485 - accuracy30: 0.6286 - accuracy50: 0.5951 - val_loss: 9.5998 - val_accuracy10: 0.7293 - val_accuracy20: 0.7124 - val_accuracy30: 0.6855 - val_accuracy50: 0.6345 - 25s/epoch - 38ms/step
Epoch 10/50
653/653 - 25s - loss: 9.6294 - accuracy10: 0.6597 - accuracy20: 0.6497 - accuracy30: 0.6297 - accuracy50: 0.5977 - val_loss: 9.6626 - val_accuracy10: 0.7267 - val_accuracy20: 0.7102 - val_accuracy30: 0.6851 - val_accuracy50: 0.6338 - 25s/epoch - 39ms/step
Epoch 11/50
653/653 - 26s - loss: 9.5935 - accuracy10: 0.6621 - accuracy20: 0.6514 - accuracy30: 0.6321 - accuracy50: 0.5989 - val_loss: 9.6825 - val_accuracy10: 0.7437 - val_accuracy20: 0.7227 - val_accuracy30: 0.6935 - val_accuracy50: 0.6373 - 26s/epoch - 39ms/step
Epoch 12/50
653/653 - 25s - loss: 9.5416 - accuracy10: 0.6638 - accuracy20: 0.6530 - accuracy30: 0.6337 - accuracy50: 0.6010 - val_loss: 9.6765 - val_accuracy10: 0.7469 - val_accuracy20: 0.7262 - val_accuracy30: 0.6968 - val_accuracy50: 0.6404 - 25s/epoch - 38ms/step
Epoch 13/50
653/653 - 25s - loss: 9.4928 - accuracy10: 0.6640 - accuracy20: 0.6539 - accuracy30: 0.6347 - accuracy50: 0.6028 - val_loss: 9.5834 - val_accuracy10: 0.7398 - val_accuracy20: 0.7205 - val_accuracy30: 0.6920 - val_accuracy50: 0.6374 - 25s/epoch - 38ms/step
Epoch 14/50
653/653 - 26s - loss: 9.4519 - accuracy10: 0.6647 - accuracy20: 0.6549 - accuracy30: 0.6363 - accuracy50: 0.6042 - val_loss: 9.6494 - val_accuracy10: 0.7399 - val_accuracy20: 0.7210 - val_accuracy30: 0.6929 - val_accuracy50: 0.6397 - 26s/epoch - 39ms/step
Epoch 15/50
653/653 - 25s - loss: 9.4143 - accuracy10: 0.6664 - accuracy20: 0.6574 - accuracy30: 0.6371 - accuracy50: 0.6040 - val_loss: 9.7172 - val_accuracy10: 0.7416 - val_accuracy20: 0.7216 - val_accuracy30: 0.6923 - val_accuracy50: 0.6377 - 25s/epoch - 38ms/step
Epoch 16/50
653/653 - 24s - loss: 9.3717 - accuracy10: 0.6673 - accuracy20: 0.6579 - accuracy30: 0.6379 - accuracy50: 0.6054 - val_loss: 9.7091 - val_accuracy10: 0.7276 - val_accuracy20: 0.7086 - val_accuracy30: 0.6810 - val_accuracy50: 0.6305 - 24s/epoch - 37ms/step
Epoch 17/50
653/653 - 25s - loss: 9.3294 - accuracy10: 0.6692 - accuracy20: 0.6578 - accuracy30: 0.6385 - accuracy50: 0.6064 - val_loss: 9.7003 - val_accuracy10: 0.7276 - val_accuracy20: 0.7090 - val_accuracy30: 0.6816 - val_accuracy50: 0.6326 - 25s/epoch - 38ms/step
Epoch 18/50
653/653 - 25s - loss: 9.2957 - accuracy10: 0.6704 - accuracy20: 0.6598 - accuracy30: 0.6399 - accuracy50: 0.6076 - val_loss: 9.7065 - val_accuracy10: 0.7230 - val_accuracy20: 0.7053 - val_accuracy30: 0.6789 - val_accuracy50: 0.6310 - 25s/epoch - 38ms/step
Epoch 19/50
653/653 - 24s - loss: 9.2563 - accuracy10: 0.6696 - accuracy20: 0.6598 - accuracy30: 0.6410 - accuracy50: 0.6091 - val_loss: 9.8000 - val_accuracy10: 0.7351 - val_accuracy20: 0.7137 - val_accuracy30: 0.6859 - val_accuracy50: 0.6337 - 24s/epoch - 37ms/step
Epoch 20/50
653/653 - 25s - loss: 9.2310 - accuracy10: 0.6721 - accuracy20: 0.6606 - accuracy30: 0.6407 - accuracy50: 0.6097 - val_loss: 9.7661 - val_accuracy10: 0.7269 - val_accuracy20: 0.7072 - val_accuracy30: 0.6797 - val_accuracy50: 0.6291 - 25s/epoch - 38ms/step
Epoch 21/50
653/653 - 25s - loss: 9.1976 - accuracy10: 0.6710 - accuracy20: 0.6603 - accuracy30: 0.6417 - accuracy50: 0.6111 - val_loss: 9.6984 - val_accuracy10: 0.7273 - val_accuracy20: 0.7070 - val_accuracy30: 0.6785 - val_accuracy50: 0.6304 - 25s/epoch - 38ms/step
Epoch 22/50
653/653 - 24s - loss: 9.1532 - accuracy10: 0.6738 - accuracy20: 0.6643 - accuracy30: 0.6442 - accuracy50: 0.6132 - val_loss: 9.8115 - val_accuracy10: 0.7316 - val_accuracy20: 0.7124 - val_accuracy30: 0.6830 - val_accuracy50: 0.6325 - 24s/epoch - 37ms/step
Epoch 23/50
653/653 - 24s - loss: 9.1411 - accuracy10: 0.6718 - accuracy20: 0.6619 - accuracy30: 0.6436 - accuracy50: 0.6124 - val_loss: 9.9164 - val_accuracy10: 0.7260 - val_accuracy20: 0.7052 - val_accuracy30: 0.6761 - val_accuracy50: 0.6269 - 24s/epoch - 37ms/step
testing model: results/QRTEA/W1/deepVOL_L3/seq2seq
Evaluating performance on  test set...
1645/1645 - 25s - 25s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.57212496
{'0': {'precision': 0.28415038656055697, 'recall': 0.6596012530374448, 'f1-score': 0.39719337834740764, 'support': 34157}, '1': {'precision': 0.9325495211002949, 'recall': 0.8102469912643209, 'f1-score': 0.867106903549296, 'support': 352806}, '2': {'precision': 0.432258064516129, 'recall': 0.44670602402561166, 'f1-score': 0.4393633002079963, 'support': 34047}, 'accuracy': 0.768625448326643, 'macro avg': {'precision': 0.5496526573923269, 'recall': 0.6388514227757924, 'f1-score': 0.5678878607015667, 'support': 421010}, 'weighted avg': {'precision': 0.8394857162956704, 'recall': 0.768625448326643, 'f1-score': 0.7943907620246715, 'support': 421010}}
[[ 22530   8250   3377]
 [ 50347 285860  16599]
 [  6412  12426  15209]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.62572825
{'0': {'precision': 0.3374734681501178, 'recall': 0.6183251778884165, 'f1-score': 0.4366366139801577, 'support': 46799}, '1': {'precision': 0.8870246309370988, 'recall': 0.8089393343515918, 'f1-score': 0.8461843873924295, 'support': 328011}, '2': {'precision': 0.5180469441984057, 'recall': 0.4051082251082251, 'f1-score': 0.4546691283645904, 'support': 46200}, 'accuracy': 0.7434360228973184, 'macro avg': {'precision': 0.5808483477618741, 'recall': 0.6107909124494112, 'f1-score': 0.5791633765790593, 'support': 421010}, 'weighted avg': {'precision': 0.7854469629610518, 'recall': 0.7434360228973184, 'f1-score': 0.7576961538231388, 'support': 421010}}
[[ 28937  13874   3988]
 [ 49246 265341  13424]
 [  7563  19921  18716]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.68536353
{'0': {'precision': 0.36583477145006416, 'recall': 0.5847405180797454, 'f1-score': 0.4500820001224898, 'support': 56555}, '1': {'precision': 0.8445290504659391, 'recall': 0.8020776008856834, 'f1-score': 0.8227561016104932, 'support': 308914}, '2': {'precision': 0.552863436123348, 'recall': 0.3705730901496192, 'f1-score': 0.44372581357996743, 'support': 55541}, 'accuracy': 0.7159568656326453, 'macro avg': {'precision': 0.5877424193464504, 'recall': 0.585797069705016, 'f1-score': 0.5721879717709836, 'support': 421010}, 'weighted avg': {'precision': 0.7417477511240123, 'recall': 0.7159568656326453, 'f1-score': 0.7226912455805712, 'support': 421010}}
[[ 33070  19145   4340]
 [ 48835 247773  12306]
 [  8491  26468  20582]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7801066
{'0': {'precision': 0.40929312901631243, 'recall': 0.5286278984473695, 'f1-score': 0.46136883661928413, 'support': 73617}, '1': {'precision': 0.7646068841776575, 'recall': 0.7957579551910947, 'f1-score': 0.7798714702189689, 'support': 276329}, '2': {'precision': 0.5843200667675135, 'recall': 0.3152651131374536, 'f1-score': 0.4095570626839479, 'support': 71064}, 'accuracy': 0.6679437543051234, 'macro avg': {'precision': 0.5860733599871611, 'recall': 0.5465503222586393, 'f1-score': 0.5502657898407336, 'support': 421010}, 'weighted avg': {'precision': 0.6720460540165041, 'recall': 0.6679437543051234, 'f1-score': 0.6616718278475839, 'support': 421010}}
[[ 38916  29461   5240]
 [ 45740 219891  10698]
 [ 10425  38235  22404]]
Evaluating performance on  train set...
653/653 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.72542226
{'0': {'precision': 0.3436776501952714, 'recall': 0.6766737268625104, 'f1-score': 0.4558383349617706, 'support': 21718}, '1': {'precision': 0.9035000452202225, 'recall': 0.724222091552756, 'f1-score': 0.8039881963694894, 'support': 124147}, '2': {'precision': 0.41770816425904883, 'recall': 0.4889564432622429, 'f1-score': 0.45053285773683177, 'support': 21053}, 'accuracy': 0.6883619501791298, 'macro avg': {'precision': 0.5549619532248475, 'recall': 0.6299507538925031, 'f1-score': 0.5701197963560306, 'support': 166918}, 'weighted avg': {'precision': 0.769388689674221, 'recall': 0.6883619501791298, 'f1-score': 0.7141092502145738, 'support': 166918}}
[[14696  3820  3202]
 [23089 89910 11148]
 [ 4976  5783 10294]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7514802
{'0': {'precision': 0.40872421730094527, 'recall': 0.6448314765195318, 'f1-score': 0.5003214202672575, 'support': 28364}, '1': {'precision': 0.8429535193660699, 'recall': 0.7360378158462108, 'f1-score': 0.7858759619737438, 'support': 110853}, '2': {'precision': 0.49109394703657, 'recall': 0.4498754557597199, 'f1-score': 0.4695819281421332, 'support': 27701}, 'accuracy': 0.6730490420445967, 'macro avg': {'precision': 0.5809238945678618, 'recall': 0.6102482493751541, 'f1-score': 0.5852597701277115, 'support': 166918}, 'weighted avg': {'precision': 0.7107727962752428, 'recall': 0.6730490420445967, 'f1-score': 0.6848615114523366, 'support': 166918}}
[[18290  6243  3831]
 [20178 81592  9083]
 [ 6281  8958 12462]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.79186976
{'0': {'precision': 0.4425490408583505, 'recall': 0.6170328507963372, 'f1-score': 0.5154246188023831, 'support': 33089}, '1': {'precision': 0.7894091533664518, 'recall': 0.7360764795742374, 'f1-score': 0.7618105316843045, 'support': 101465}, '2': {'precision': 0.5206128452985902, 'recall': 0.42102335928809786, 'f1-score': 0.4655517023421084, 'support': 32364}, 'accuracy': 0.6513917013144178, 'macro avg': {'precision': 0.5841903465077976, 'recall': 0.5913775632195575, 'f1-score': 0.5809289509429321, 'support': 166918}, 'weighted avg': {'precision': 0.6685319682990005, 'recall': 0.6513917013144178, 'f1-score': 0.655526103257288, 'support': 166918}}
[[20417  8301  4371]
 [18603 74686  8176]
 [ 7115 11623 13626]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.86596906
{'0': {'precision': 0.47821346194170683, 'recall': 0.5682463746449394, 'f1-score': 0.5193568956094006, 'support': 40134}, '1': {'precision': 0.6919707712656389, 'recall': 0.7305838856266382, 'f1-score': 0.7107532808837368, 'support': 87363}, '2': {'precision': 0.5460911448684698, 'recall': 0.3738870145353999, 'f1-score': 0.4438722500790532, 'support': 39421}, 'accuracy': 0.6073101762542087, 'macro avg': {'precision': 0.5720917926919385, 'recall': 0.5575724249356592, 'f1-score': 0.5579941421907302, 'support': 166918}, 'weighted avg': {'precision': 0.6061222911460024, 'recall': 0.6073101762542087, 'f1-score': 0.6017044087312329, 'support': 166918}}
[[22806 12193  5135]
 [16421 63826  7116]
 [ 8463 16219 14739]]
Evaluating performance on  val set...
181/181 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.64484334
{'0': {'precision': 0.36011142061281337, 'recall': 0.632114218658322, 'f1-score': 0.45883021010789327, 'support': 5113}, '1': {'precision': 0.9107819716515368, 'recall': 0.7882129172754087, 'f1-score': 0.8450762501477715, 'support': 36277}, '2': {'precision': 0.40929054054054054, 'recall': 0.49448979591836734, 'f1-score': 0.44787430683918666, 'support': 4900}, 'accuracy': 0.7398790235472025, 'macro avg': {'precision': 0.5600613109349636, 'recall': 0.638272310617366, 'f1-score': 0.5839269223649505, 'support': 46290}, 'weighted avg': {'precision': 0.7968721306512155, 'recall': 0.7398790235472025, 'f1-score': 0.7603675544265367, 'support': 46290}}
[[ 3232  1196   685]
 [ 4871 28594  2812]
 [  872  1605  2423]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.68101406
{'0': {'precision': 0.4357255107386066, 'recall': 0.6001443001443001, 'f1-score': 0.504886191198786, 'support': 6930}, '1': {'precision': 0.8537625309204531, 'recall': 0.8014359914451573, 'f1-score': 0.8267721499038674, 'support': 32730}, '2': {'precision': 0.5017438963627304, 'recall': 0.45565610859728506, 'f1-score': 0.4775907042921508, 'support': 6630}, 'accuracy': 0.7217757615035645, 'macro avg': {'precision': 0.59707731267393, 'recall': 0.6190788000622475, 'f1-score': 0.6030830151316013, 'support': 46290}, 'weighted avg': {'precision': 0.7407601525022657, 'recall': 0.7217757615035645, 'f1-score': 0.7285707526640338, 'support': 46290}}
[[ 4159  1961   810]
 [ 4309 26231  2190]
 [ 1077  2532  3021]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.73548055
{'0': {'precision': 0.4681617941529836, 'recall': 0.5692719746773801, 'f1-score': 0.5137896934402814, 'support': 8214}, '1': {'precision': 0.8011565688457576, 'recall': 0.798000529661017, 'f1-score': 0.7995754349304277, 'support': 30208}, '2': {'precision': 0.5300177048124899, 'recall': 0.41853075749872903, 'f1-score': 0.46772246289326036, 'support': 7868}, 'accuracy': 0.6929142363361417, 'macro avg': {'precision': 0.5997786892704103, 'recall': 0.5952677539457087, 'f1-score': 0.5936958637546564, 'support': 46290}, 'weighted avg': {'precision': 0.6959818083890672, 'recall': 0.6929142363361417, 'f1-score': 0.6924580604523872, 'support': 46290}}
[[ 4676  2658   880]
 [ 4062 24106  2040]
 [ 1250  3325  3293]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8273218
{'0': {'precision': 0.5064710957722174, 'recall': 0.5094994695727649, 'f1-score': 0.5079807692307693, 'support': 10369}, '1': {'precision': 0.7039712415640791, 'recall': 0.7933195750210197, 'f1-score': 0.7459795518660272, 'support': 26166}, '2': {'precision': 0.5601067168863779, 'recall': 0.3658636596617119, 'f1-score': 0.4426117690829045, 'support': 9755}, 'accuracy': 0.6396629941672067, 'macro avg': {'precision': 0.5901830180742248, 'recall': 0.5562275680851655, 'f1-score': 0.5655240300599004, 'support': 46290}, 'weighted avg': {'precision': 0.6294135087935717, 'recall': 0.6396629941672067, 'f1-score': 0.6287369055451295, 'support': 46290}}
[[ 5283  4036  1050]
 [ 3655 20758  1753]
 [ 1493  4693  3569]]
training model: results/QRTEA/W2/deepLOB_L1/seq2seq
Epoch 1/50
528/528 - 17s - loss: 11.8268 - accuracy10: 0.4341 - accuracy20: 0.4487 - accuracy30: 0.4581 - accuracy50: 0.4719 - val_loss: 13.2725 - val_accuracy10: 0.5074 - val_accuracy20: 0.4900 - val_accuracy30: 0.4751 - val_accuracy50: 0.4500 - 17s/epoch - 32ms/step
Epoch 2/50
528/528 - 12s - loss: 11.6812 - accuracy10: 0.4300 - accuracy20: 0.4579 - accuracy30: 0.4720 - accuracy50: 0.4845 - val_loss: 12.9785 - val_accuracy10: 0.5038 - val_accuracy20: 0.4946 - val_accuracy30: 0.4827 - val_accuracy50: 0.4621 - 12s/epoch - 22ms/step
Epoch 3/50
528/528 - 11s - loss: 11.5306 - accuracy10: 0.4456 - accuracy20: 0.4686 - accuracy30: 0.4825 - accuracy50: 0.4956 - val_loss: 12.5403 - val_accuracy10: 0.3796 - val_accuracy20: 0.4145 - val_accuracy30: 0.4337 - val_accuracy50: 0.4567 - 11s/epoch - 20ms/step
Epoch 4/50
528/528 - 11s - loss: 11.3109 - accuracy10: 0.4778 - accuracy20: 0.4987 - accuracy30: 0.5086 - accuracy50: 0.5154 - val_loss: 12.5431 - val_accuracy10: 0.4255 - val_accuracy20: 0.4518 - val_accuracy30: 0.4651 - val_accuracy50: 0.4773 - 11s/epoch - 20ms/step
Epoch 5/50
528/528 - 11s - loss: 11.1780 - accuracy10: 0.5012 - accuracy20: 0.5162 - accuracy30: 0.5226 - accuracy50: 0.5258 - val_loss: 12.3760 - val_accuracy10: 0.4381 - val_accuracy20: 0.4619 - val_accuracy30: 0.4735 - val_accuracy50: 0.4840 - 11s/epoch - 20ms/step
Epoch 6/50
528/528 - 11s - loss: 11.0506 - accuracy10: 0.5215 - accuracy20: 0.5336 - accuracy30: 0.5371 - accuracy50: 0.5372 - val_loss: 12.4445 - val_accuracy10: 0.5289 - val_accuracy20: 0.5233 - val_accuracy30: 0.5175 - val_accuracy50: 0.5045 - 11s/epoch - 20ms/step
Epoch 7/50
528/528 - 11s - loss: 10.8527 - accuracy10: 0.5499 - accuracy20: 0.5559 - accuracy30: 0.5542 - accuracy50: 0.5477 - val_loss: 13.1311 - val_accuracy10: 0.6211 - val_accuracy20: 0.5868 - val_accuracy30: 0.5594 - val_accuracy50: 0.5138 - 11s/epoch - 21ms/step
Epoch 8/50
528/528 - 11s - loss: 10.6997 - accuracy10: 0.5706 - accuracy20: 0.5725 - accuracy30: 0.5682 - accuracy50: 0.5588 - val_loss: 12.8106 - val_accuracy10: 0.5823 - val_accuracy20: 0.5629 - val_accuracy30: 0.5453 - val_accuracy50: 0.5130 - 11s/epoch - 20ms/step
Epoch 9/50
528/528 - 12s - loss: 10.5693 - accuracy10: 0.5858 - accuracy20: 0.5861 - accuracy30: 0.5794 - accuracy50: 0.5663 - val_loss: 13.1812 - val_accuracy10: 0.5001 - val_accuracy20: 0.4950 - val_accuracy30: 0.4860 - val_accuracy50: 0.4704 - 12s/epoch - 22ms/step
Epoch 10/50
528/528 - 11s - loss: 10.4988 - accuracy10: 0.5923 - accuracy20: 0.5904 - accuracy30: 0.5816 - accuracy50: 0.5674 - val_loss: 12.8057 - val_accuracy10: 0.6145 - val_accuracy20: 0.5870 - val_accuracy30: 0.5619 - val_accuracy50: 0.5228 - 11s/epoch - 21ms/step
Epoch 11/50
528/528 - 11s - loss: 10.4280 - accuracy10: 0.5994 - accuracy20: 0.5962 - accuracy30: 0.5861 - accuracy50: 0.5686 - val_loss: 12.9770 - val_accuracy10: 0.6254 - val_accuracy20: 0.5945 - val_accuracy30: 0.5671 - val_accuracy50: 0.5221 - 11s/epoch - 21ms/step
Epoch 12/50
528/528 - 11s - loss: 10.3463 - accuracy10: 0.6064 - accuracy20: 0.6014 - accuracy30: 0.5906 - accuracy50: 0.5716 - val_loss: 13.3092 - val_accuracy10: 0.6334 - val_accuracy20: 0.5915 - val_accuracy30: 0.5593 - val_accuracy50: 0.5119 - 11s/epoch - 21ms/step
Epoch 13/50
528/528 - 11s - loss: 10.2655 - accuracy10: 0.6135 - accuracy20: 0.6067 - accuracy30: 0.5942 - accuracy50: 0.5741 - val_loss: 12.8524 - val_accuracy10: 0.5298 - val_accuracy20: 0.5222 - val_accuracy30: 0.5101 - val_accuracy50: 0.4898 - 11s/epoch - 20ms/step
Epoch 14/50
528/528 - 11s - loss: 10.2002 - accuracy10: 0.6169 - accuracy20: 0.6113 - accuracy30: 0.5986 - accuracy50: 0.5775 - val_loss: 13.2109 - val_accuracy10: 0.6400 - val_accuracy20: 0.6038 - val_accuracy30: 0.5729 - val_accuracy50: 0.5204 - 11s/epoch - 20ms/step
Epoch 15/50
528/528 - 11s - loss: 10.1545 - accuracy10: 0.6218 - accuracy20: 0.6139 - accuracy30: 0.5999 - accuracy50: 0.5783 - val_loss: 12.9874 - val_accuracy10: 0.5313 - val_accuracy20: 0.5127 - val_accuracy30: 0.4987 - val_accuracy50: 0.4745 - 11s/epoch - 21ms/step
testing model: results/QRTEA/W2/deepLOB_L1/seq2seq
Evaluating performance on  test set...
1242/1242 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.91484857
{'0': {'precision': 0.28735982580293956, 'recall': 0.262464946997872, 'f1-score': 0.27434879321456046, 'support': 50281}, '1': {'precision': 0.7609563941829609, 'recall': 0.6372239602502761, 'f1-score': 0.693615305838844, 'support': 217360}, '2': {'precision': 0.31098300633228354, 'recall': 0.5571195023725029, 'f1-score': 0.39915723315359064, 'support': 50158}, 'accuracy': 0.5652881223666532, 'macro avg': {'precision': 0.45309974210606135, 'recall': 0.4856028032068836, 'f1-score': 0.455707110735665, 'support': 317799}, 'weighted avg': {'precision': 0.6150066767750076, 'recall': 0.5652881223666532, 'f1-score': 0.5808063683311472, 'support': 317799}}
[[ 13197  26364  10720]
 [ 27660 138507  51193]
 [  5068  17146  27944]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9656858
{'0': {'precision': 0.3489881550767079, 'recall': 0.24643898825599161, 'f1-score': 0.288882657814521, 'support': 64799}, '1': {'precision': 0.6736642074670244, 'recall': 0.643235281560859, 'f1-score': 0.6580981916659386, 'support': 187384}, '2': {'precision': 0.37498523426509595, 'recall': 0.5321720312118995, 'f1-score': 0.4399604377051348, 'support': 65616}, 'accuracy': 0.5393975437304711, 'macro avg': {'precision': 0.46587919893627605, 'recall': 0.4739487670095834, 'f1-score': 0.4623137623951982, 'support': 317799}, 'weighted avg': {'precision': 0.5457946955287934, 'recall': 0.5393975437304711, 'f1-score': 0.5377764655373789, 'support': 317799}}
[[ 15969  34382  14448]
 [ 23098 120532  43754]
 [  6691  24006  34919]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0001175
{'0': {'precision': 0.38126013280920334, 'recall': 0.2321872971218351, 'f1-score': 0.28861074451720287, 'support': 73936}, '1': {'precision': 0.6110582747415736, 'recall': 0.6444084917375107, 'f1-score': 0.6272904256864739, 'support': 167504}, '2': {'precision': 0.4083286519776127, 'recall': 0.5140323995861653, 'f1-score': 0.4551236339391831, 'support': 76359}, 'accuracy': 0.5171790974798536, 'macro avg': {'precision': 0.46688235317612986, 'recall': 0.46354272948183706, 'f1-score': 0.45700826804761996, 'support': 317799}, 'weighted avg': {'precision': 0.508884930311462, 'recall': 0.5171790974798536, 'f1-score': 0.5071292390308753, 'support': 317799}}
[[ 17167  39312  17457]
 [ 20145 107941  39418]
 [  7715  29393  39251]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0416864
{'0': {'precision': 0.4238961868272213, 'recall': 0.2153142195192586, 'f1-score': 0.2855738133099798, 'support': 86325}, '1': {'precision': 0.5199667694688805, 'recall': 0.650701758133772, 'f1-score': 0.5780343164386811, 'support': 140433}, '2': {'precision': 0.447494628801841, 'recall': 0.4827275623070924, 'f1-score': 0.464443857331572, 'support': 91041}, 'accuracy': 0.48431555794700426, 'macro avg': {'precision': 0.46378586169931424, 'recall': 0.4495811799867076, 'f1-score': 0.442683995693411, 'support': 317799}, 'weighted avg': {'precision': 0.47310938727129914, 'recall': 0.48431555794700426, 'f1-score': 0.46605145330772274, 'support': 317799}}
[[18587 46457 21281]
 [16073 91380 32980]
 [ 9188 37905 43948]]
Evaluating performance on  train set...
528/528 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9461173
{'0': {'precision': 0.2254289628270914, 'recall': 0.6044325468467907, 'f1-score': 0.3283839545423797, 'support': 16063}, '1': {'precision': 0.8670767306088407, 'recall': 0.4860284592833559, 'f1-score': 0.6228990482134499, 'support': 102673}, '2': {'precision': 0.2575161111597119, 'recall': 0.5458647546050192, 'f1-score': 0.3499435319292267, 'support': 16178}, 'accuracy': 0.5073009472701128, 'macro avg': {'precision': 0.450007268198548, 'recall': 0.5454419202450552, 'f1-score': 0.4337421782283521, 'support': 134914}, 'weighted avg': {'precision': 0.7175869831006041, 'recall': 0.5073009472701128, 'f1-score': 0.5551027461833821, 'support': 134914}}
[[ 9709  4263  2091]
 [29400 49902 23371]
 [ 3960  3387  8831]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.95809263
{'0': {'precision': 0.2970401197044796, 'recall': 0.5869987063389392, 'f1-score': 0.39446721311475413, 'support': 21644}, '1': {'precision': 0.8067678069974038, 'recall': 0.49972650694672355, 'f1-score': 0.6171680256162559, 'support': 91410}, '2': {'precision': 0.3299456659440894, 'recall': 0.5361390667886551, 'f1-score': 0.40849758630905697, 'support': 21860}, 'accuracy': 0.5196273181434099, 'macro avg': {'precision': 0.4779178642153243, 'recall': 0.5409547600247726, 'f1-score': 0.473377608346689, 'support': 134914}, 'weighted avg': {'precision': 0.6477340664872009, 'recall': 0.5196273181434099, 'f1-score': 0.5476298591617896, 'support': 134914}}
[[12705  6106  2833]
 [24762 45680 20968]
 [ 5305  4835 11720]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.97092646
{'0': {'precision': 0.34079537100713797, 'recall': 0.562025811497849, 'f1-score': 0.4243050532189729, 'support': 25570}, '1': {'precision': 0.7570918185066094, 'recall': 0.5075384707502545, 'f1-score': 0.6076925834319102, 'support': 83505}, '2': {'precision': 0.3701890384876921, 'recall': 0.5267231704013313, 'f1-score': 0.43479649862628583, 'support': 25839}, 'accuracy': 0.5215396474791348, 'macro avg': {'precision': 0.48935874266714646, 'recall': 0.5320958175498116, 'f1-score': 0.488931378425723, 'support': 134914}, 'weighted avg': {'precision': 0.6040915287259323, 'recall': 0.5215396474791348, 'f1-score': 0.5398220801273063, 'support': 134914}}
[[14371  7600  3599]
 [21567 42382 19556]
 [ 6231  5998 13610]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.985545
{'0': {'precision': 0.3957229600599947, 'recall': 0.5154561210020482, 'f1-score': 0.4477227939566455, 'support': 31735}, '1': {'precision': 0.6689531655771469, 'recall': 0.52544137300415, 'f1-score': 0.5885754806177119, 'support': 71085}, '2': {'precision': 0.42758730326956707, 'recall': 0.5028354209509566, 'f1-score': 0.4621685090784123, 'support': 32094}, 'accuracy': 0.5177149888076849, 'macro avg': {'precision': 0.4974211429689029, 'recall': 0.5145776383190516, 'f1-score': 0.49948892788425653, 'support': 134914}, 'weighted avg': {'precision': 0.5472655975190781, 'recall': 0.5177149888076849, 'f1-score': 0.5253732528595013, 'support': 134914}}
[[16358 10317  5060]
 [17190 37351 16544]
 [ 7789  8167 16138]]
Evaluating performance on  val set...
159/159 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0306606
{'0': {'precision': 0.23822041138200697, 'recall': 0.6740423949423577, 'f1-score': 0.35202719106579267, 'support': 5378}, '1': {'precision': 0.8518214392355927, 'recall': 0.380125920250508, 'f1-score': 0.5256708510883336, 'support': 30019}, '2': {'precision': 0.23343348355867133, 'recall': 0.5380915736821854, 'f1-score': 0.3256111757857974, 'support': 5198}, 'accuracy': 0.4392905530237714, 'macro avg': {'precision': 0.4411584447254237, 'recall': 0.5307532962916838, 'f1-score': 0.4011030726466412, 'support': 40595}, 'weighted avg': {'precision': 0.6913502747718602, 'recall': 0.4392905530237714, 'f1-score': 0.4770499422122698, 'support': 40595}}
[[ 3625  1047   706]
 [10129 11411  8479]
 [ 1463   938  2797]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0334092
{'0': {'precision': 0.31021194605009633, 'recall': 0.6492838270059798, 'f1-score': 0.41983634565236944, 'support': 7191}, '1': {'precision': 0.7926316594053352, 'recall': 0.3922087745839637, 'f1-score': 0.5247577360018217, 'support': 26440}, '2': {'precision': 0.2982906668806677, 'recall': 0.5337449741527858, 'f1-score': 0.38270270270270274, 'support': 6964}, 'accuracy': 0.46202734326887546, 'macro avg': {'precision': 0.46704475744536644, 'recall': 0.5250791919142431, 'f1-score': 0.44243226145229797, 'support': 40595}, 'weighted avg': {'precision': 0.6223724937278058, 'recall': 0.46202734326887546, 'f1-score': 0.48180266838517, 'support': 40595}}
[[ 4669  1445  1077]
 [ 8403 10370  7667]
 [ 1979  1268  3717]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0356135
{'0': {'precision': 0.3610301592680447, 'recall': 0.6245017584994138, 'f1-score': 0.4575477775391883, 'support': 8530}, '1': {'precision': 0.7456113096162809, 'recall': 0.4011618187897024, 'f1-score': 0.5216564317156676, 'support': 23928}, '2': {'precision': 0.333487582909147, 'recall': 0.5313997787882512, 'f1-score': 0.4097995545657015, 'support': 8137}, 'accuracy': 0.47419632959724106, 'macro avg': {'precision': 0.4800430172644909, 'recall': 0.5190211186924558, 'f1-score': 0.46300125460685243, 'support': 40595}, 'weighted avg': {'precision': 0.5821939435198058, 'recall': 0.47419632959724106, 'f1-score': 0.48576466599342, 'support': 40595}}
[[5327 1750 1453]
 [7140 9599 7189]
 [2288 1525 4324]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0328953
{'0': {'precision': 0.4207223539255334, 'recall': 0.5685480071610289, 'f1-score': 0.48359046283309964, 'support': 10613}, '1': {'precision': 0.6602922885572139, 'recall': 0.42455140700754734, 'f1-score': 0.5168081287457029, 'support': 20007}, '2': {'precision': 0.3857644334901785, 'recall': 0.5177944862155388, 'f1-score': 0.4421331963704845, 'support': 9975}, 'accuracy': 0.4851090035718685, 'macro avg': {'precision': 0.488926358657642, 'recall': 0.5036313001280384, 'f1-score': 0.480843929316429, 'support': 40595}, 'weighted avg': {'precision': 0.5302030886424534, 'recall': 0.4851090035718685, 'f1-score': 0.48977471234532693, 'support': 40595}}
[[6034 2357 2222]
 [5511 8494 6002]
 [2797 2013 5165]]
training model: results/QRTEA/W2/deepOF_L1/seq2seq
Epoch 1/50
528/528 - 16s - loss: 12.4300 - accuracy10: 0.3793 - accuracy20: 0.4040 - accuracy30: 0.4137 - accuracy50: 0.4277 - val_loss: 13.6779 - val_accuracy10: 0.6379 - val_accuracy20: 0.5952 - val_accuracy30: 0.5579 - val_accuracy50: 0.4933 - 16s/epoch - 30ms/step
Epoch 2/50
528/528 - 11s - loss: 12.2242 - accuracy10: 0.3942 - accuracy20: 0.4094 - accuracy30: 0.4162 - accuracy50: 0.4289 - val_loss: 12.9174 - val_accuracy10: 0.5775 - val_accuracy20: 0.5461 - val_accuracy30: 0.5174 - val_accuracy50: 0.4745 - 11s/epoch - 21ms/step
Epoch 3/50
528/528 - 10s - loss: 12.0653 - accuracy10: 0.4206 - accuracy20: 0.4261 - accuracy30: 0.4284 - accuracy50: 0.4351 - val_loss: 12.7023 - val_accuracy10: 0.5552 - val_accuracy20: 0.5159 - val_accuracy30: 0.4799 - val_accuracy50: 0.4485 - 10s/epoch - 20ms/step
Epoch 4/50
528/528 - 10s - loss: 11.9433 - accuracy10: 0.4399 - accuracy20: 0.4406 - accuracy30: 0.4399 - accuracy50: 0.4434 - val_loss: 12.6817 - val_accuracy10: 0.6011 - val_accuracy20: 0.5422 - val_accuracy30: 0.5000 - val_accuracy50: 0.4630 - 10s/epoch - 19ms/step
Epoch 5/50
528/528 - 11s - loss: 11.8183 - accuracy10: 0.4558 - accuracy20: 0.4553 - accuracy30: 0.4537 - accuracy50: 0.4560 - val_loss: 12.5324 - val_accuracy10: 0.5961 - val_accuracy20: 0.5557 - val_accuracy30: 0.5245 - val_accuracy50: 0.4868 - 11s/epoch - 20ms/step
Epoch 6/50
528/528 - 10s - loss: 11.7520 - accuracy10: 0.4666 - accuracy20: 0.4664 - accuracy30: 0.4648 - accuracy50: 0.4646 - val_loss: 12.4998 - val_accuracy10: 0.6009 - val_accuracy20: 0.5603 - val_accuracy30: 0.5282 - val_accuracy50: 0.4906 - 10s/epoch - 19ms/step
Epoch 7/50
528/528 - 10s - loss: 11.6626 - accuracy10: 0.4799 - accuracy20: 0.4796 - accuracy30: 0.4776 - accuracy50: 0.4752 - val_loss: 12.4722 - val_accuracy10: 0.6283 - val_accuracy20: 0.5879 - val_accuracy30: 0.5558 - val_accuracy50: 0.5109 - 10s/epoch - 19ms/step
Epoch 8/50
528/528 - 10s - loss: 11.5888 - accuracy10: 0.4882 - accuracy20: 0.4873 - accuracy30: 0.4856 - accuracy50: 0.4812 - val_loss: 12.3394 - val_accuracy10: 0.6047 - val_accuracy20: 0.5704 - val_accuracy30: 0.5434 - val_accuracy50: 0.5078 - 10s/epoch - 19ms/step
Epoch 9/50
528/528 - 10s - loss: 11.4946 - accuracy10: 0.5004 - accuracy20: 0.4989 - accuracy30: 0.4954 - accuracy50: 0.4898 - val_loss: 12.2922 - val_accuracy10: 0.5931 - val_accuracy20: 0.5647 - val_accuracy30: 0.5415 - val_accuracy50: 0.5077 - 10s/epoch - 18ms/step
Epoch 10/50
528/528 - 10s - loss: 11.4322 - accuracy10: 0.5066 - accuracy20: 0.5038 - accuracy30: 0.4999 - accuracy50: 0.4937 - val_loss: 12.2445 - val_accuracy10: 0.6064 - val_accuracy20: 0.5782 - val_accuracy30: 0.5528 - val_accuracy50: 0.5166 - 10s/epoch - 19ms/step
Epoch 11/50
528/528 - 10s - loss: 11.3653 - accuracy10: 0.5134 - accuracy20: 0.5098 - accuracy30: 0.5049 - accuracy50: 0.4986 - val_loss: 12.2132 - val_accuracy10: 0.6008 - val_accuracy20: 0.5752 - val_accuracy30: 0.5523 - val_accuracy50: 0.5204 - 10s/epoch - 19ms/step
Epoch 12/50
528/528 - 10s - loss: 11.3032 - accuracy10: 0.5214 - accuracy20: 0.5173 - accuracy30: 0.5120 - accuracy50: 0.5049 - val_loss: 12.1561 - val_accuracy10: 0.5960 - val_accuracy20: 0.5718 - val_accuracy30: 0.5520 - val_accuracy50: 0.5215 - 10s/epoch - 19ms/step
Epoch 13/50
528/528 - 10s - loss: 11.2308 - accuracy10: 0.5285 - accuracy20: 0.5234 - accuracy30: 0.5165 - accuracy50: 0.5087 - val_loss: 12.2234 - val_accuracy10: 0.6012 - val_accuracy20: 0.5748 - val_accuracy30: 0.5521 - val_accuracy50: 0.5193 - 10s/epoch - 19ms/step
Epoch 14/50
528/528 - 10s - loss: 11.1665 - accuracy10: 0.5295 - accuracy20: 0.5257 - accuracy30: 0.5203 - accuracy50: 0.5132 - val_loss: 12.2255 - val_accuracy10: 0.6038 - val_accuracy20: 0.5799 - val_accuracy30: 0.5587 - val_accuracy50: 0.5252 - 10s/epoch - 18ms/step
Epoch 15/50
528/528 - 10s - loss: 11.1214 - accuracy10: 0.5337 - accuracy20: 0.5300 - accuracy30: 0.5239 - accuracy50: 0.5159 - val_loss: 12.2513 - val_accuracy10: 0.6206 - val_accuracy20: 0.5928 - val_accuracy30: 0.5674 - val_accuracy50: 0.5294 - 10s/epoch - 18ms/step
Epoch 16/50
528/528 - 10s - loss: 11.0629 - accuracy10: 0.5350 - accuracy20: 0.5313 - accuracy30: 0.5253 - accuracy50: 0.5166 - val_loss: 12.1805 - val_accuracy10: 0.6109 - val_accuracy20: 0.5865 - val_accuracy30: 0.5627 - val_accuracy50: 0.5291 - 10s/epoch - 19ms/step
Epoch 17/50
528/528 - 10s - loss: 11.0200 - accuracy10: 0.5422 - accuracy20: 0.5378 - accuracy30: 0.5305 - accuracy50: 0.5222 - val_loss: 12.1816 - val_accuracy10: 0.6006 - val_accuracy20: 0.5771 - val_accuracy30: 0.5541 - val_accuracy50: 0.5244 - 10s/epoch - 18ms/step
Epoch 18/50
528/528 - 10s - loss: 10.9444 - accuracy10: 0.5425 - accuracy20: 0.5397 - accuracy30: 0.5331 - accuracy50: 0.5255 - val_loss: 12.2313 - val_accuracy10: 0.6197 - val_accuracy20: 0.5923 - val_accuracy30: 0.5650 - val_accuracy50: 0.5283 - 10s/epoch - 19ms/step
Epoch 19/50
528/528 - 10s - loss: 10.8960 - accuracy10: 0.5454 - accuracy20: 0.5421 - accuracy30: 0.5343 - accuracy50: 0.5268 - val_loss: 12.1927 - val_accuracy10: 0.6102 - val_accuracy20: 0.5841 - val_accuracy30: 0.5620 - val_accuracy50: 0.5294 - 10s/epoch - 19ms/step
Epoch 20/50
528/528 - 10s - loss: 10.8689 - accuracy10: 0.5469 - accuracy20: 0.5445 - accuracy30: 0.5370 - accuracy50: 0.5293 - val_loss: 12.1448 - val_accuracy10: 0.6056 - val_accuracy20: 0.5826 - val_accuracy30: 0.5596 - val_accuracy50: 0.5283 - 10s/epoch - 19ms/step
Epoch 21/50
528/528 - 10s - loss: 10.7995 - accuracy10: 0.5525 - accuracy20: 0.5499 - accuracy30: 0.5419 - accuracy50: 0.5315 - val_loss: 12.1929 - val_accuracy10: 0.6178 - val_accuracy20: 0.5906 - val_accuracy30: 0.5654 - val_accuracy50: 0.5323 - 10s/epoch - 19ms/step
Epoch 22/50
528/528 - 11s - loss: 10.7622 - accuracy10: 0.5537 - accuracy20: 0.5517 - accuracy30: 0.5442 - accuracy50: 0.5348 - val_loss: 12.2457 - val_accuracy10: 0.6250 - val_accuracy20: 0.6000 - val_accuracy30: 0.5739 - val_accuracy50: 0.5364 - 11s/epoch - 22ms/step
Epoch 23/50
528/528 - 11s - loss: 10.6952 - accuracy10: 0.5571 - accuracy20: 0.5558 - accuracy30: 0.5485 - accuracy50: 0.5397 - val_loss: 12.2615 - val_accuracy10: 0.6138 - val_accuracy20: 0.5878 - val_accuracy30: 0.5645 - val_accuracy50: 0.5312 - 11s/epoch - 21ms/step
Epoch 24/50
528/528 - 10s - loss: 10.6629 - accuracy10: 0.5594 - accuracy20: 0.5576 - accuracy30: 0.5496 - accuracy50: 0.5398 - val_loss: 12.2767 - val_accuracy10: 0.6194 - val_accuracy20: 0.5934 - val_accuracy30: 0.5699 - val_accuracy50: 0.5338 - 10s/epoch - 19ms/step
Epoch 25/50
528/528 - 10s - loss: 10.6112 - accuracy10: 0.5582 - accuracy20: 0.5585 - accuracy30: 0.5518 - accuracy50: 0.5421 - val_loss: 12.3047 - val_accuracy10: 0.6281 - val_accuracy20: 0.5987 - val_accuracy30: 0.5708 - val_accuracy50: 0.5345 - 10s/epoch - 19ms/step
Epoch 26/50
528/528 - 10s - loss: 10.5697 - accuracy10: 0.5617 - accuracy20: 0.5602 - accuracy30: 0.5539 - accuracy50: 0.5437 - val_loss: 12.2880 - val_accuracy10: 0.6316 - val_accuracy20: 0.6018 - val_accuracy30: 0.5753 - val_accuracy50: 0.5390 - 10s/epoch - 20ms/step
Epoch 27/50
528/528 - 10s - loss: 10.5301 - accuracy10: 0.5632 - accuracy20: 0.5631 - accuracy30: 0.5564 - accuracy50: 0.5462 - val_loss: 12.3008 - val_accuracy10: 0.6245 - val_accuracy20: 0.5971 - val_accuracy30: 0.5707 - val_accuracy50: 0.5343 - 10s/epoch - 20ms/step
Epoch 28/50
528/528 - 10s - loss: 10.4622 - accuracy10: 0.5665 - accuracy20: 0.5674 - accuracy30: 0.5616 - accuracy50: 0.5525 - val_loss: 12.3293 - val_accuracy10: 0.6232 - val_accuracy20: 0.5948 - val_accuracy30: 0.5671 - val_accuracy50: 0.5315 - 10s/epoch - 19ms/step
Epoch 29/50
528/528 - 10s - loss: 10.4116 - accuracy10: 0.5692 - accuracy20: 0.5696 - accuracy30: 0.5629 - accuracy50: 0.5534 - val_loss: 12.4726 - val_accuracy10: 0.6407 - val_accuracy20: 0.6100 - val_accuracy30: 0.5790 - val_accuracy50: 0.5367 - 10s/epoch - 19ms/step
Epoch 30/50
528/528 - 10s - loss: 10.3715 - accuracy10: 0.5713 - accuracy20: 0.5715 - accuracy30: 0.5652 - accuracy50: 0.5554 - val_loss: 12.3978 - val_accuracy10: 0.6326 - val_accuracy20: 0.6004 - val_accuracy30: 0.5720 - val_accuracy50: 0.5342 - 10s/epoch - 19ms/step
testing model: results/QRTEA/W2/deepOF_L1/seq2seq
Evaluating performance on  test set...
1242/1242 - 11s - 11s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9190937
{'0': {'precision': 0.3381797088432319, 'recall': 0.35946139464576954, 'f1-score': 0.34849595063632854, 'support': 50278}, '1': {'precision': 0.8081823408319578, 'recall': 0.6014657778145832, 'f1-score': 0.6896671783752987, 'support': 217359}, '2': {'precision': 0.2745908430728441, 'recall': 0.5616364615108559, 'f1-score': 0.3688476293978239, 'support': 50157}, 'accuracy': 0.556892200607941, 'macro avg': {'precision': 0.47365096424934455, 'recall': 0.5075212113237363, 'f1-score': 0.46900358613648363, 'support': 317794}, 'weighted avg': {'precision': 0.6496074744586687, 'recall': 0.556892200607941, 'f1-score': 0.5850561627289267, 'support': 317794}}
[[ 18073  17484  14721]
 [ 26927 130734  59698]
 [  8442  13545  28170]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9552564
{'0': {'precision': 0.3935049995575613, 'recall': 0.343143306892188, 'f1-score': 0.3666026396709068, 'support': 64798}, '1': {'precision': 0.7282063593683312, 'recall': 0.5827422978605317, 'f1-score': 0.6474039159885574, 'support': 187383}, '2': {'precision': 0.3308513791461958, 'recall': 0.5614131345922302, 'f1-score': 0.4163435998869737, 'support': 65613}, 'accuracy': 0.5294845088327659, 'macro avg': {'precision': 0.48418757935736273, 'recall': 0.4957662464483166, 'f1-score': 0.47678338518214597, 'support': 317794}, 'weighted avg': {'precision': 0.5779214860531231, 'recall': 0.5294845088327659, 'f1-score': 0.5424430872026007, 'support': 317794}}
[[ 22235  22714  19849]
 [ 23535 109196  54652]
 [ 10735  18042  36836]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.98305094
{'0': {'precision': 0.4176567572620808, 'recall': 0.332350474747748, 'f1-score': 0.3701522215610807, 'support': 73934}, '1': {'precision': 0.6639113587509899, 'recall': 0.5605418378068583, 'f1-score': 0.6078633209032526, 'support': 167504}, '2': {'precision': 0.3602269923513447, 'recall': 0.5545078317355545, 'f1-score': 0.4367357253743044, 'support': 76356}, 'accuracy': 0.5060038893119442, 'macro avg': {'precision': 0.4805983694548052, 'recall': 0.48246671476338693, 'f1-score': 0.4715837559462126, 'support': 317794}, 'weighted avg': {'precision': 0.5336549310421838, 'recall': 0.5060038893119442, 'f1-score': 0.5114437815067487, 'support': 317794}}
[[24572 25987 23375]
 [21789 93893 51822]
 [12472 21544 42340]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.019668
{'0': {'precision': 0.4377973830293418, 'recall': 0.30697496611563546, 'f1-score': 0.36089641881907514, 'support': 86323}, '1': {'precision': 0.5605579888843903, 'recall': 0.5422443442780543, 'f1-score': 0.551249104163198, 'support': 140433}, '2': {'precision': 0.3989095790678713, 'recall': 0.5320415650607438, 'f1-score': 0.4559562080213123, 'support': 91038}, 'accuracy': 0.4754148914076414, 'macro avg': {'precision': 0.4657549836605345, 'recall': 0.46042029181814453, 'f1-score': 0.4560339103345285, 'support': 317794}, 'weighted avg': {'precision': 0.4809050951478767, 'recall': 0.4754148914076414, 'f1-score': 0.4722448135349114, 'support': 317794}}
[[26499 31817 28007]
 [19306 76149 44978]
 [14723 27879 48436]]
Evaluating performance on  train set...
528/528 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8291681
{'0': {'precision': 0.3314370184554739, 'recall': 0.45890963220244374, 'f1-score': 0.38489348973912135, 'support': 16123}, '1': {'precision': 0.8790692793998058, 'recall': 0.6529367638606096, 'f1-score': 0.749313820301975, 'support': 102647}, '2': {'precision': 0.27014609183701543, 'recall': 0.6082512544136778, 'f1-score': 0.37412840541055437, 'support': 16143}, 'accuracy': 0.6244023926530431, 'macro avg': {'precision': 0.49355079656409834, 'recall': 0.5733658834922437, 'f1-score': 0.5027785718172169, 'support': 134913}, 'weighted avg': {'precision': 0.7407629489495781, 'recall': 0.6244023926530431, 'f1-score': 0.6608704001552353, 'support': 134913}}
[[ 7399  5052  3672]
 [12769 67022 22856]
 [ 2156  4168  9819]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8547293
{'0': {'precision': 0.4132894905410599, 'recall': 0.4464022140221402, 'f1-score': 0.4292081513182695, 'support': 21680}, '1': {'precision': 0.819286860651734, 'recall': 0.6424452007572856, 'f1-score': 0.7201687991461904, 'support': 91379}, '2': {'precision': 0.3357094450440501, 'recall': 0.612016106891187, 'f1-score': 0.4335845692519653, 'support': 21854}, 'accuracy': 0.6060127637811034, 'macro avg': {'precision': 0.5227619320789479, 'recall': 0.5669545072235377, 'f1-score': 0.527653839905475, 'support': 134913}, 'weighted avg': {'precision': 0.6757119358877028, 'recall': 0.6060127637811034, 'f1-score': 0.6269899460703733, 'support': 134913}}
[[ 9678  7178  4824]
 [11031 58706 21642]
 [ 2708  5771 13375]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.88259894
{'0': {'precision': 0.45778035832780356, 'recall': 0.4317790643091848, 'f1-score': 0.4443997101215879, 'support': 25564}, '1': {'precision': 0.7671470333318643, 'recall': 0.6253382828403784, 'f1-score': 0.6890218560128774, 'support': 83510}, '2': {'precision': 0.36999157461149595, 'recall': 0.611827083091451, 'f1-score': 0.46112561436259425, 'support': 25839}, 'accuracy': 0.5860739884221684, 'macro avg': {'precision': 0.5316396554237213, 'recall': 0.556314810080338, 'f1-score': 0.5315157268323532, 'support': 134913}, 'weighted avg': {'precision': 0.6324620913494058, 'recall': 0.5860739884221684, 'f1-score': 0.5990221411924627, 'support': 134913}}
[[11038  8799  5727]
 [10096 52222 21192]
 [ 2978  7052 15809]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9265493
{'0': {'precision': 0.506818825624216, 'recall': 0.3946804487583512, 'f1-score': 0.4437751359778892, 'support': 31732}, '1': {'precision': 0.6674460898934789, 'recall': 0.6144030837624153, 'f1-score': 0.6398271252243344, 'support': 71082}, '2': {'precision': 0.4177444213629967, 'recall': 0.58263497305212, 'f1-score': 0.48660040589061765, 'support': 32099}, 'accuracy': 0.555165180523745, 'macro avg': {'precision': 0.5306697789602306, 'recall': 0.5305728351909621, 'f1-score': 0.5234008890309471, 'support': 134913}, 'weighted avg': {'precision': 0.5702560621870888, 'recall': 0.555165180523745, 'f1-score': 0.5572587575602755, 'support': 134913}}
[[12524 11967  7241]
 [ 8583 43673 18826]
 [ 3604  9793 18702]]
Evaluating performance on  val set...
159/159 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.85533
{'0': {'precision': 0.3363247273229325, 'recall': 0.4487840825350037, 'f1-score': 0.3845000394601847, 'support': 5428}, '1': {'precision': 0.8533362792752983, 'recall': 0.6439361099069659, 'f1-score': 0.7339934244284384, 'support': 29989}, '2': {'precision': 0.2650872120138047, 'recall': 0.5489665829631061, 'f1-score': 0.3575292489621336, 'support': 5177}, 'accuracy': 0.6057299108242598, 'macro avg': {'precision': 0.4849160728706785, 'recall': 0.5472289251350252, 'f1-score': 0.4920075709502522, 'support': 40594}, 'weighted avg': {'precision': 0.7091843325538569, 'recall': 0.6057299108242598, 'f1-score': 0.6392502325775062, 'support': 40594}}
[[ 2436  1809  1183]
 [ 3982 19311  6696]
 [  825  1510  2842]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.88976914
{'0': {'precision': 0.40946964687210685, 'recall': 0.42591828312009905, 'f1-score': 0.41753202966958863, 'support': 7269}, '1': {'precision': 0.7852185331082349, 'recall': 0.6343866030158369, 'f1-score': 0.701789681042793, 'support': 26394}, '2': {'precision': 0.3241950636262704, 'recall': 0.5476843168373972, 'f1-score': 0.40729613733905573, 'support': 6931}, 'accuracy': 0.5822535350051732, 'macro avg': {'precision': 0.5062944145355374, 'recall': 0.535996400991111, 'f1-score': 0.5088726160171458, 'support': 40594}, 'weighted avg': {'precision': 0.6392198061774098, 'recall': 0.5822535350051732, 'f1-score': 0.6006071511309237, 'support': 40594}}
[[ 3096  2521  1652]
 [ 3389 16744  6261]
 [ 1076  2059  3796]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9209187
{'0': {'precision': 0.4427587965323814, 'recall': 0.40449569065921265, 'f1-score': 0.4227632379793061, 'support': 8586}, '1': {'precision': 0.7268789683516267, 'recall': 0.6185549738219895, 'f1-score': 0.668356263577118, 'support': 23875}, '2': {'precision': 0.3567119761923912, 'recall': 0.5453092339849994, 'f1-score': 0.43129436934746673, 'support': 8133}, 'accuracy': 0.5586047199093462, 'macro avg': {'precision': 0.5087832470254664, 'recall': 0.5227866328220672, 'f1-score': 0.5074712903012969, 'support': 40594}, 'weighted avg': {'precision': 0.5926220845148256, 'recall': 0.5586047199093462, 'f1-score': 0.5689158018450254, 'support': 40594}}
[[ 3473  3086  2027]
 [ 3136 14768  5971]
 [ 1235  2463  4435]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.96291554
{'0': {'precision': 0.48256607519543365, 'recall': 0.36506148502769176, 'f1-score': 0.41566908935442504, 'support': 10653}, '1': {'precision': 0.6271938775510204, 'recall': 0.6146807340367019, 'f1-score': 0.6208742645016287, 'support': 19999}, '2': {'precision': 0.40533436412833396, 'recall': 0.5273586803460069, 'f1-score': 0.45836429601783446, 'support': 9942}, 'accuracy': 0.5277873577375967, 'macro avg': {'precision': 0.5050314389582627, 'recall': 0.5023669664701335, 'f1-score': 0.49830254995796275, 'support': 40594}, 'weighted avg': {'precision': 0.5349032124048803, 'recall': 0.5277873577375967, 'f1-score': 0.5272218814521868, 'support': 40594}}
[[ 3889  4106  2658]
 [ 2672 12293  5034]
 [ 1498  3201  5243]]
training model: results/QRTEA/W2/deepLOB_L2/seq2seq
Epoch 1/50
528/528 - 29s - loss: 12.1466 - accuracy10: 0.4295 - accuracy20: 0.4414 - accuracy30: 0.4480 - accuracy50: 0.4593 - val_loss: 13.0024 - val_accuracy10: 0.3868 - val_accuracy20: 0.4039 - val_accuracy30: 0.4142 - val_accuracy50: 0.4278 - 29s/epoch - 56ms/step
Epoch 2/50
528/528 - 24s - loss: 11.6337 - accuracy10: 0.4548 - accuracy20: 0.4734 - accuracy30: 0.4816 - accuracy50: 0.4890 - val_loss: 13.4614 - val_accuracy10: 0.6106 - val_accuracy20: 0.5741 - val_accuracy30: 0.5442 - val_accuracy50: 0.5015 - 24s/epoch - 45ms/step
Epoch 3/50
528/528 - 24s - loss: 11.2776 - accuracy10: 0.4877 - accuracy20: 0.5049 - accuracy30: 0.5106 - accuracy50: 0.5143 - val_loss: 12.5227 - val_accuracy10: 0.5508 - val_accuracy20: 0.5328 - val_accuracy30: 0.5156 - val_accuracy50: 0.4917 - 24s/epoch - 45ms/step
Epoch 4/50
528/528 - 24s - loss: 11.0088 - accuracy10: 0.5220 - accuracy20: 0.5332 - accuracy30: 0.5352 - accuracy50: 0.5353 - val_loss: 12.6569 - val_accuracy10: 0.4510 - val_accuracy20: 0.4464 - val_accuracy30: 0.4410 - val_accuracy50: 0.4389 - 24s/epoch - 45ms/step
Epoch 5/50
528/528 - 24s - loss: 10.8745 - accuracy10: 0.5367 - accuracy20: 0.5468 - accuracy30: 0.5462 - accuracy50: 0.5422 - val_loss: 12.7086 - val_accuracy10: 0.4846 - val_accuracy20: 0.4656 - val_accuracy30: 0.4530 - val_accuracy50: 0.4415 - 24s/epoch - 45ms/step
Epoch 6/50
528/528 - 24s - loss: 10.6342 - accuracy10: 0.5697 - accuracy20: 0.5745 - accuracy30: 0.5708 - accuracy50: 0.5619 - val_loss: 13.3871 - val_accuracy10: 0.4585 - val_accuracy20: 0.4477 - val_accuracy30: 0.4389 - val_accuracy50: 0.4281 - 24s/epoch - 45ms/step
Epoch 7/50
528/528 - 24s - loss: 10.3989 - accuracy10: 0.6002 - accuracy20: 0.5991 - accuracy30: 0.5900 - accuracy50: 0.5735 - val_loss: 13.0094 - val_accuracy10: 0.5797 - val_accuracy20: 0.5410 - val_accuracy30: 0.5128 - val_accuracy50: 0.4797 - 24s/epoch - 45ms/step
Epoch 8/50
528/528 - 24s - loss: 10.1566 - accuracy10: 0.6255 - accuracy20: 0.6206 - accuracy30: 0.6069 - accuracy50: 0.5859 - val_loss: 12.7958 - val_accuracy10: 0.6466 - val_accuracy20: 0.6173 - val_accuracy30: 0.5906 - val_accuracy50: 0.5454 - 24s/epoch - 45ms/step
Epoch 9/50
528/528 - 24s - loss: 9.9998 - accuracy10: 0.6413 - accuracy20: 0.6331 - accuracy30: 0.6171 - accuracy50: 0.5931 - val_loss: 12.8046 - val_accuracy10: 0.6410 - val_accuracy20: 0.6131 - val_accuracy30: 0.5833 - val_accuracy50: 0.5386 - 24s/epoch - 45ms/step
Epoch 10/50
528/528 - 24s - loss: 9.8720 - accuracy10: 0.6491 - accuracy20: 0.6389 - accuracy30: 0.6204 - accuracy50: 0.5959 - val_loss: 12.6541 - val_accuracy10: 0.6777 - val_accuracy20: 0.6486 - val_accuracy30: 0.6161 - val_accuracy50: 0.5667 - 24s/epoch - 45ms/step
Epoch 11/50
528/528 - 24s - loss: 9.7646 - accuracy10: 0.6518 - accuracy20: 0.6426 - accuracy30: 0.6246 - accuracy50: 0.5994 - val_loss: 12.7461 - val_accuracy10: 0.6783 - val_accuracy20: 0.6493 - val_accuracy30: 0.6188 - val_accuracy50: 0.5685 - 24s/epoch - 45ms/step
Epoch 12/50
528/528 - 24s - loss: 9.6668 - accuracy10: 0.6553 - accuracy20: 0.6480 - accuracy30: 0.6296 - accuracy50: 0.6031 - val_loss: 12.7560 - val_accuracy10: 0.6793 - val_accuracy20: 0.6499 - val_accuracy30: 0.6182 - val_accuracy50: 0.5664 - 24s/epoch - 45ms/step
Epoch 13/50
528/528 - 23s - loss: 9.5693 - accuracy10: 0.6603 - accuracy20: 0.6517 - accuracy30: 0.6332 - accuracy50: 0.6079 - val_loss: 12.7212 - val_accuracy10: 0.6581 - val_accuracy20: 0.6322 - val_accuracy30: 0.6023 - val_accuracy50: 0.5572 - 23s/epoch - 44ms/step
testing model: results/QRTEA/W2/deepLOB_L2/seq2seq
Evaluating performance on  test set...
1242/1242 - 20s - 20s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8567008
{'0': {'precision': 0.37903189628101025, 'recall': 0.16803563970485869, 'f1-score': 0.23284462327068287, 'support': 50281}, '1': {'precision': 0.7625914980677426, 'recall': 0.7716783216783217, 'f1-score': 0.7671080011890878, 'support': 217360}, '2': {'precision': 0.33325392413774846, 'recall': 0.5020136369073727, 'f1-score': 0.40058544656209233, 'support': 50158}, 'accuracy': 0.6336111819105787, 'macro avg': {'precision': 0.4916257728288338, 'recall': 0.48057586609685105, 'f1-score': 0.4668460236739544, 'support': 317799}, 'weighted avg': {'precision': 0.6341440379730937, 'recall': 0.6336111819105787, 'f1-score': 0.6247307904360768, 'support': 317799}}
[[  8449  30695  11137]
 [ 10387 167732  39241]
 [  3455  21523  25180]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.91473293
{'0': {'precision': 0.43926724137931034, 'recall': 0.157270945539283, 'f1-score': 0.231616268366686, 'support': 64799}, '1': {'precision': 0.6746417693880294, 'recall': 0.7766351449430048, 'f1-score': 0.7220544930872719, 'support': 187384}, '2': {'precision': 0.39726947747382296, 'recall': 0.47761216776396, 'f1-score': 0.4337517819822562, 'support': 65616}, 'accuracy': 0.5886078936686396, 'macro avg': {'precision': 0.5037261627470543, 'recall': 0.4705060860820826, 'f1-score': 0.46247418114540473, 'support': 317799}, 'weighted avg': {'precision': 0.5693799707458702, 'recall': 0.5886078936686396, 'f1-score': 0.5625285750839555, 'support': 317799}}
[[ 10191  40385  14223]
 [  8531 145529  33324]
 [  4478  29799  31339]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.95599145
{'0': {'precision': 0.4635764387729232, 'recall': 0.148385089807401, 'f1-score': 0.2248109669883814, 'support': 73936}, '1': {'precision': 0.6124868805491731, 'recall': 0.773426306237463, 'f1-score': 0.6836120330745973, 'support': 167504}, '2': {'precision': 0.4281789021364159, 'recall': 0.4632590788250239, 'f1-score': 0.4450287468391057, 'support': 76359}, 'accuracy': 0.5534850644589819, 'macro avg': {'precision': 0.5014140738195041, 'recall': 0.4616901582899626, 'f1-score': 0.45115058230069477, 'support': 317799}, 'weighted avg': {'precision': 0.5335583271340002, 'recall': 0.5534850644589819, 'f1-score': 0.5195463916603501, 'support': 317799}}
[[ 10971  46084  16881]
 [  7592 129552  30360]
 [  5103  35882  35374]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0116293
{'0': {'precision': 0.49508682761541717, 'recall': 0.13540689255719665, 'f1-score': 0.21265293127757312, 'support': 86325}, '1': {'precision': 0.522541488216236, 'recall': 0.7706308346328854, 'f1-score': 0.6227887437417275, 'support': 140433}, '2': {'precision': 0.4584529523897017, 'recall': 0.43851671225052447, 'f1-score': 0.44826327874558597, 'support': 91041}, 'accuracy': 0.5029405378871551, 'macro avg': {'precision': 0.4920270894071183, 'recall': 0.44818481314686887, 'f1-score': 0.4279016512549622, 'support': 317799}, 'weighted avg': {'precision': 0.49672420129415884, 'recall': 0.5029405378871551, 'f1-score': 0.4613850046812464, 'support': 317799}}
[[ 11689  53661  20975]
 [  6027 108222  26184]
 [  5894  45224  39923]]
Evaluating performance on  train set...
528/528 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8473363
{'0': {'precision': 0.2834189166804704, 'recall': 0.42607234016061757, 'f1-score': 0.34040436696426346, 'support': 16063}, '1': {'precision': 0.8476609981827153, 'recall': 0.6859933965112541, 'f1-score': 0.7583062380224371, 'support': 102673}, '2': {'precision': 0.27555555555555555, 'recall': 0.47138088762517, 'f1-score': 0.3477983262262559, 'support': 16178}, 'accuracy': 0.6293120061668915, 'macro avg': {'precision': 0.46887849013958044, 'recall': 0.5278155414323472, 'f1-score': 0.48216964373765214, 'support': 134914}, 'weighted avg': {'precision': 0.711878630111257, 'recall': 0.6293120061668915, 'f1-score': 0.6593249999608122, 'support': 134914}}
[[ 6844  7082  2137]
 [14328 70433 17912]
 [ 2976  5576  7626]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8800238
{'0': {'precision': 0.3521669980119284, 'recall': 0.40921271484014043, 'f1-score': 0.3785528059152882, 'support': 21644}, '1': {'precision': 0.7813263546950774, 'recall': 0.6891587353681217, 'f1-score': 0.7323540866209013, 'support': 91410}, '2': {'precision': 0.3476679136493119, 'recall': 0.4634034766697164, 'f1-score': 0.397278271270859, 'support': 21860}, 'accuracy': 0.6076685888788413, 'macro avg': {'precision': 0.4937204221187726, 'recall': 0.5205916422926594, 'f1-score': 0.5027283879356829, 'support': 134914}, 'weighted avg': {'precision': 0.6422118177507239, 'recall': 0.6076685888788413, 'f1-score': 0.6213023629810699, 'support': 134914}}
[[ 8857  9801  2986]
 [12393 62996 16021]
 [ 3900  7830 10130]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.90858376
{'0': {'precision': 0.39154076203052784, 'recall': 0.39425107547907706, 'f1-score': 0.39289124461679364, 'support': 25570}, '1': {'precision': 0.730700386120132, 'recall': 0.6844021316088857, 'f1-score': 0.7067938832171854, 'support': 83505}, '2': {'precision': 0.384001550738216, 'recall': 0.4600023220712876, 'f1-score': 0.4185800817016481, 'support': 25839}, 'accuracy': 0.5864328386972442, 'macro avg': {'precision': 0.5020808996296252, 'recall': 0.5128851763864168, 'f1-score': 0.5060884031785423, 'support': 134914}, 'weighted avg': {'precision': 0.6000196354537483, 'recall': 0.5864328386972442, 'f1-score': 0.592101213172772, 'support': 134914}}
[[10081 11655  3834]
 [11121 57151 15233]
 [ 4545  9408 11886]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9488337
{'0': {'precision': 0.44163004086668206, 'recall': 0.3609579328816764, 'f1-score': 0.3972396095226536, 'support': 31735}, '1': {'precision': 0.6420889117070152, 'recall': 0.6861503833438841, 'f1-score': 0.6633888254175508, 'support': 71085}, '2': {'precision': 0.4332838578741708, 'recall': 0.4456907833239858, 'f1-score': 0.43939975732256137, 'support': 32094}, 'accuracy': 0.5524556384066887, 'macro avg': {'precision': 0.5056676034826227, 'recall': 0.4975996998498488, 'f1-score': 0.500009397420922, 'support': 134914}, 'weighted avg': {'precision': 0.5452646261337665, 'recall': 0.5524556384066887, 'f1-score': 0.5475005520147523, 'support': 134914}}
[[11455 14895  5385]
 [ 8986 48775 13324]
 [ 5497 12293 14304]]
Evaluating performance on  val set...
159/159 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.94498456
{'0': {'precision': 0.3018166804293972, 'recall': 0.4077724060989215, 'f1-score': 0.34688389750079085, 'support': 5378}, '1': {'precision': 0.8235927695045425, 'recall': 0.5858622872180952, 'f1-score': 0.6846787222860258, 'support': 30019}, '2': {'precision': 0.22772442588726513, 'recall': 0.5246248557137361, 'f1-score': 0.3175915681593199, 'support': 5198}, 'accuracy': 0.5544278852075378, 'macro avg': {'precision': 0.45104462527373496, 'recall': 0.5060865163435843, 'f1-score': 0.4497180626487121, 'support': 40595}, 'weighted avg': {'precision': 0.6781700460861723, 'recall': 0.5544278852075378, 'f1-score': 0.5929240826790395, 'support': 40595}}
[[ 2193  2192   993]
 [ 4177 17587  8255]
 [  896  1575  2727]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9635256
{'0': {'precision': 0.36942248425566127, 'recall': 0.3833959115561118, 'f1-score': 0.37627951412583593, 'support': 7191}, '1': {'precision': 0.7513944612975829, 'recall': 0.5808245083207262, 'f1-score': 0.6551900678356585, 'support': 26440}, '2': {'precision': 0.29076729163384274, 'recall': 0.5300114876507754, 'f1-score': 0.3755214162173161, 'support': 6964}, 'accuracy': 0.5371351151619658, 'macro avg': {'precision': 0.47052807906236227, 'recall': 0.4980773025092045, 'f1-score': 0.4689969993929369, 'support': 40595}, 'weighted avg': {'precision': 0.6047121581457972, 'recall': 0.5371351151619658, 'f1-score': 0.5578071812339225, 'support': 40595}}
[[ 2757  3001  1433]
 [ 3513 15357  7570]
 [ 1193  2080  3691]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.98197293
{'0': {'precision': 0.407870247274661, 'recall': 0.35967174677608443, 'f1-score': 0.3822576625965612, 'support': 8530}, '1': {'precision': 0.6965375737368557, 'recall': 0.5674941491140086, 'f1-score': 0.6254289201575203, 'support': 23928}, '2': {'precision': 0.3225806451612903, 'recall': 0.5382819220843063, 'f1-score': 0.403407782638729, 'support': 8137}, 'accuracy': 0.5179701933735682, 'macro avg': {'precision': 0.4756628220576023, 'recall': 0.4884826059914664, 'f1-score': 0.47036478846427016, 'support': 40595}, 'weighted avg': {'precision': 0.5609243252446301, 'recall': 0.5179701933735682, 'f1-score': 0.5298300330289235, 'support': 40595}}
[[ 3068  3522  1940]
 [ 3091 13579  7258]
 [ 1363  2394  4380]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0050855
{'0': {'precision': 0.4524445631846113, 'recall': 0.3191369075661924, 'f1-score': 0.3742748218133598, 'support': 10613}, '1': {'precision': 0.6025877003031616, 'recall': 0.5563552756535213, 'f1-score': 0.5785493386002756, 'support': 20007}, '2': {'precision': 0.367425018788003, 'recall': 0.5391478696741855, 'f1-score': 0.4370225906062084, 'support': 9975}, 'accuracy': 0.4901096194112575, 'macro avg': {'precision': 0.47415242742525865, 'recall': 0.47154668429796637, 'f1-score': 0.4632822503399479, 'support': 40595}, 'weighted avg': {'precision': 0.505550704063406, 'recall': 0.4901096194112575, 'f1-score': 0.49036865728729717, 'support': 40595}}
[[ 3387  4370  2856]
 [ 2473 11131  6403]
 [ 1626  2971  5378]]
training model: results/QRTEA/W2/deepOF_L2/seq2seq
Epoch 1/50
528/528 - 20s - loss: 11.6504 - accuracy10: 0.4898 - accuracy20: 0.4961 - accuracy30: 0.4938 - accuracy50: 0.4871 - val_loss: 13.1709 - val_accuracy10: 0.6791 - val_accuracy20: 0.6471 - val_accuracy30: 0.6114 - val_accuracy50: 0.5486 - 20s/epoch - 37ms/step
Epoch 2/50
528/528 - 14s - loss: 10.5654 - accuracy10: 0.5915 - accuracy20: 0.5867 - accuracy30: 0.5716 - accuracy50: 0.5505 - val_loss: 12.1048 - val_accuracy10: 0.7189 - val_accuracy20: 0.6855 - val_accuracy30: 0.6479 - val_accuracy50: 0.5815 - 14s/epoch - 27ms/step
Epoch 3/50
528/528 - 14s - loss: 10.1124 - accuracy10: 0.6232 - accuracy20: 0.6137 - accuracy30: 0.5953 - accuracy50: 0.5689 - val_loss: 12.1014 - val_accuracy10: 0.7300 - val_accuracy20: 0.6926 - val_accuracy30: 0.6541 - val_accuracy50: 0.5894 - 14s/epoch - 27ms/step
Epoch 4/50
528/528 - 15s - loss: 9.9033 - accuracy10: 0.6362 - accuracy20: 0.6238 - accuracy30: 0.6035 - accuracy50: 0.5788 - val_loss: 11.7536 - val_accuracy10: 0.7256 - val_accuracy20: 0.6903 - val_accuracy30: 0.6534 - val_accuracy50: 0.5925 - 15s/epoch - 29ms/step
Epoch 5/50
528/528 - 15s - loss: 9.7615 - accuracy10: 0.6461 - accuracy20: 0.6331 - accuracy30: 0.6125 - accuracy50: 0.5853 - val_loss: 11.5592 - val_accuracy10: 0.7273 - val_accuracy20: 0.6953 - val_accuracy30: 0.6586 - val_accuracy50: 0.5984 - 15s/epoch - 29ms/step
Epoch 6/50
528/528 - 15s - loss: 9.6529 - accuracy10: 0.6520 - accuracy20: 0.6365 - accuracy30: 0.6168 - accuracy50: 0.5914 - val_loss: 11.5653 - val_accuracy10: 0.7172 - val_accuracy20: 0.6874 - val_accuracy30: 0.6534 - val_accuracy50: 0.5938 - 15s/epoch - 28ms/step
Epoch 7/50
528/528 - 14s - loss: 9.5738 - accuracy10: 0.6535 - accuracy20: 0.6394 - accuracy30: 0.6191 - accuracy50: 0.5929 - val_loss: 11.4406 - val_accuracy10: 0.7181 - val_accuracy20: 0.6869 - val_accuracy30: 0.6523 - val_accuracy50: 0.5930 - 14s/epoch - 27ms/step
Epoch 8/50
528/528 - 15s - loss: 9.5016 - accuracy10: 0.6573 - accuracy20: 0.6427 - accuracy30: 0.6214 - accuracy50: 0.5954 - val_loss: 11.4088 - val_accuracy10: 0.7095 - val_accuracy20: 0.6816 - val_accuracy30: 0.6485 - val_accuracy50: 0.5929 - 15s/epoch - 28ms/step
Epoch 9/50
528/528 - 15s - loss: 9.4854 - accuracy10: 0.6561 - accuracy20: 0.6413 - accuracy30: 0.6195 - accuracy50: 0.5952 - val_loss: 11.4570 - val_accuracy10: 0.7185 - val_accuracy20: 0.6868 - val_accuracy30: 0.6525 - val_accuracy50: 0.5943 - 15s/epoch - 28ms/step
Epoch 10/50
528/528 - 15s - loss: 9.4190 - accuracy10: 0.6587 - accuracy20: 0.6442 - accuracy30: 0.6224 - accuracy50: 0.5979 - val_loss: 11.4747 - val_accuracy10: 0.7075 - val_accuracy20: 0.6772 - val_accuracy30: 0.6456 - val_accuracy50: 0.5916 - 15s/epoch - 28ms/step
Epoch 11/50
528/528 - 15s - loss: 9.3502 - accuracy10: 0.6596 - accuracy20: 0.6466 - accuracy30: 0.6260 - accuracy50: 0.6008 - val_loss: 11.4056 - val_accuracy10: 0.7137 - val_accuracy20: 0.6853 - val_accuracy30: 0.6510 - val_accuracy50: 0.5953 - 15s/epoch - 29ms/step
Epoch 12/50
528/528 - 14s - loss: 9.2868 - accuracy10: 0.6610 - accuracy20: 0.6497 - accuracy30: 0.6282 - accuracy50: 0.6033 - val_loss: 11.4480 - val_accuracy10: 0.7051 - val_accuracy20: 0.6795 - val_accuracy30: 0.6465 - val_accuracy50: 0.5919 - 14s/epoch - 27ms/step
Epoch 13/50
528/528 - 15s - loss: 9.2203 - accuracy10: 0.6619 - accuracy20: 0.6488 - accuracy30: 0.6283 - accuracy50: 0.6045 - val_loss: 11.1988 - val_accuracy10: 0.6990 - val_accuracy20: 0.6719 - val_accuracy30: 0.6411 - val_accuracy50: 0.5892 - 15s/epoch - 27ms/step
Epoch 14/50
528/528 - 14s - loss: 9.1790 - accuracy10: 0.6614 - accuracy20: 0.6488 - accuracy30: 0.6300 - accuracy50: 0.6071 - val_loss: 11.2530 - val_accuracy10: 0.6974 - val_accuracy20: 0.6692 - val_accuracy30: 0.6364 - val_accuracy50: 0.5834 - 14s/epoch - 27ms/step
Epoch 15/50
528/528 - 15s - loss: 9.1149 - accuracy10: 0.6640 - accuracy20: 0.6527 - accuracy30: 0.6318 - accuracy50: 0.6087 - val_loss: 11.1987 - val_accuracy10: 0.6731 - val_accuracy20: 0.6504 - val_accuracy30: 0.6216 - val_accuracy50: 0.5775 - 15s/epoch - 28ms/step
Epoch 16/50
528/528 - 15s - loss: 9.0747 - accuracy10: 0.6618 - accuracy20: 0.6528 - accuracy30: 0.6330 - accuracy50: 0.6093 - val_loss: 11.3487 - val_accuracy10: 0.6962 - val_accuracy20: 0.6706 - val_accuracy30: 0.6395 - val_accuracy50: 0.5878 - 15s/epoch - 29ms/step
Epoch 17/50
528/528 - 15s - loss: 9.0227 - accuracy10: 0.6644 - accuracy20: 0.6548 - accuracy30: 0.6346 - accuracy50: 0.6115 - val_loss: 11.3804 - val_accuracy10: 0.6841 - val_accuracy20: 0.6582 - val_accuracy30: 0.6291 - val_accuracy50: 0.5804 - 15s/epoch - 28ms/step
Epoch 18/50
528/528 - 15s - loss: 8.9386 - accuracy10: 0.6661 - accuracy20: 0.6576 - accuracy30: 0.6382 - accuracy50: 0.6140 - val_loss: 11.3740 - val_accuracy10: 0.6595 - val_accuracy20: 0.6335 - val_accuracy30: 0.6040 - val_accuracy50: 0.5638 - 15s/epoch - 28ms/step
Epoch 19/50
528/528 - 15s - loss: 8.8785 - accuracy10: 0.6666 - accuracy20: 0.6592 - accuracy30: 0.6398 - accuracy50: 0.6163 - val_loss: 11.4584 - val_accuracy10: 0.6634 - val_accuracy20: 0.6401 - val_accuracy30: 0.6142 - val_accuracy50: 0.5710 - 15s/epoch - 28ms/step
Epoch 20/50
528/528 - 15s - loss: 8.8389 - accuracy10: 0.6668 - accuracy20: 0.6606 - accuracy30: 0.6417 - accuracy50: 0.6191 - val_loss: 11.6563 - val_accuracy10: 0.6711 - val_accuracy20: 0.6447 - val_accuracy30: 0.6141 - val_accuracy50: 0.5701 - 15s/epoch - 28ms/step
Epoch 21/50
528/528 - 14s - loss: 8.7785 - accuracy10: 0.6677 - accuracy20: 0.6607 - accuracy30: 0.6424 - accuracy50: 0.6201 - val_loss: 11.4978 - val_accuracy10: 0.6634 - val_accuracy20: 0.6381 - val_accuracy30: 0.6105 - val_accuracy50: 0.5684 - 14s/epoch - 27ms/step
Epoch 22/50
528/528 - 14s - loss: 8.7160 - accuracy10: 0.6692 - accuracy20: 0.6632 - accuracy30: 0.6462 - accuracy50: 0.6227 - val_loss: 11.3054 - val_accuracy10: 0.6518 - val_accuracy20: 0.6272 - val_accuracy30: 0.5974 - val_accuracy50: 0.5567 - 14s/epoch - 27ms/step
Epoch 23/50
528/528 - 16s - loss: 8.6960 - accuracy10: 0.6687 - accuracy20: 0.6635 - accuracy30: 0.6464 - accuracy50: 0.6251 - val_loss: 11.3446 - val_accuracy10: 0.6598 - val_accuracy20: 0.6306 - val_accuracy30: 0.5999 - val_accuracy50: 0.5570 - 16s/epoch - 30ms/step
Epoch 24/50
528/528 - 14s - loss: 8.6104 - accuracy10: 0.6713 - accuracy20: 0.6664 - accuracy30: 0.6496 - accuracy50: 0.6274 - val_loss: 11.6626 - val_accuracy10: 0.6577 - val_accuracy20: 0.6341 - val_accuracy30: 0.6040 - val_accuracy50: 0.5622 - 14s/epoch - 27ms/step
Epoch 25/50
528/528 - 15s - loss: 8.5899 - accuracy10: 0.6709 - accuracy20: 0.6661 - accuracy30: 0.6482 - accuracy50: 0.6271 - val_loss: 11.6069 - val_accuracy10: 0.6696 - val_accuracy20: 0.6430 - val_accuracy30: 0.6113 - val_accuracy50: 0.5654 - 15s/epoch - 28ms/step
testing model: results/QRTEA/W2/deepOF_L2/seq2seq
Evaluating performance on  test set...
1242/1242 - 12s - 12s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.89564556
{'0': {'precision': 0.3574964639321075, 'recall': 0.522813158836867, 'f1-score': 0.42463208568243865, 'support': 50278}, '1': {'precision': 0.865289710545157, 'recall': 0.6227439397494468, 'f1-score': 0.7242496475303044, 'support': 217359}, '2': {'precision': 0.36571259421180863, 'recall': 0.6404290527742887, 'f1-score': 0.4655665949228573, 'support': 50157}, 'accuracy': 0.6097251678760455, 'macro avg': {'precision': 0.5294995895630245, 'recall': 0.5953287171202009, 'f1-score': 0.5381494427118668, 'support': 317794}, 'weighted avg': {'precision': 0.7061044575915373, 'recall': 0.6097251678760455, 'f1-score': 0.6360197324147934, 'support': 317794}}
[[ 26286  11319  12673]
 [ 38961 135359  43039]
 [  8281   9754  32122]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.91780585
{'0': {'precision': 0.42169166411590653, 'recall': 0.5102626624278527, 'f1-score': 0.46176836166082424, 'support': 64798}, '1': {'precision': 0.789379956790933, 'recall': 0.610316837706729, 'f1-score': 0.688394630710889, 'support': 187383}, '2': {'precision': 0.42895385624649507, 'recall': 0.6178653620471553, 'f1-score': 0.5063638975281347, 'support': 65613}, 'accuracy': 0.5914743513093388, 'macro avg': {'precision': 0.5466751590511115, 'recall': 0.5794816207272456, 'f1-score': 0.552175629966616, 'support': 317794}, 'weighted avg': {'precision': 0.6399935501130896, 'recall': 0.5914743513093388, 'f1-score': 0.6046028930499321, 'support': 317794}}
[[ 33064  15827  15907]
 [ 34958 114363  38062]
 [ 10386  14687  40540]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.95023465
{'0': {'precision': 0.44381796214256947, 'recall': 0.4918711283036222, 'f1-score': 0.4666106381477228, 'support': 73934}, '1': {'precision': 0.7285598947431374, 'recall': 0.581824911643901, 'f1-score': 0.6469768182904485, 'support': 167504}, '2': {'precision': 0.45046871785829734, 'recall': 0.6022709413798523, 'f1-score': 0.5154250937274087, 'support': 76356}, 'accuracy': 0.5658099271855352, 'macro avg': {'precision': 0.5409488582480014, 'recall': 0.5586556604424585, 'f1-score': 0.5430041833885267, 'support': 317794}, 'weighted avg': {'precision': 0.5954987295005298, 'recall': 0.5658099271855352, 'f1-score': 0.5734072838014156, 'support': 317794}}
[[36366 18368 19200]
 [33146 97458 36900]
 [12427 17942 45987]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9937975
{'0': {'precision': 0.4669299820466786, 'recall': 0.45193053994879695, 'f1-score': 0.45930783585384377, 'support': 86323}, '1': {'precision': 0.6255034748847759, 'recall': 0.5518147443976843, 'f1-score': 0.586353008830139, 'support': 140433}, '2': {'precision': 0.46681165330071134, 'recall': 0.5658626068235243, 'f1-score': 0.5115867979522626, 'support': 91038}, 'accuracy': 0.528707275782425, 'macro avg': {'precision': 0.5197483700773886, 'recall': 0.5232026303900019, 'f1-score': 0.5190825475454152, 'support': 317794}, 'weighted avg': {'precision': 0.5369696269341124, 'recall': 0.528707275782425, 'f1-score': 0.5304253110991156, 'support': 317794}}
[[39012 22736 24575]
 [28675 77493 34265]
 [15863 23660 51515]]
Evaluating performance on  train set...
528/528 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.70773816
{'0': {'precision': 0.4044932939524524, 'recall': 0.5181417850276003, 'f1-score': 0.45431803350010874, 'support': 16123}, '1': {'precision': 0.9050109869112448, 'recall': 0.7382777869786745, 'f1-score': 0.8131857519194347, 'support': 102647}, '2': {'precision': 0.34553138513956233, 'recall': 0.653348200458403, 'f1-score': 0.4520110570638782, 'support': 16143}, 'accuracy': 0.7018078317137711, 'macro avg': {'precision': 0.5516785553344198, 'recall': 0.636589257488226, 'f1-score': 0.5731716141611406, 'support': 134913}, 'weighted avg': {'precision': 0.7782513271677444, 'recall': 0.7018078317137711, 'f1-score': 0.7270823569676653, 'support': 134913}}
[[ 8354  4355  3414]
 [10302 75782 16563]
 [ 1997  3599 10547]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.73420155
{'0': {'precision': 0.4880361573909961, 'recall': 0.5080258302583026, 'f1-score': 0.49783041041403003, 'support': 21680}, '1': {'precision': 0.8457245566183587, 'recall': 0.7363289158340538, 'f1-score': 0.7872444980051246, 'support': 91379}, '2': {'precision': 0.4224669066064784, 'recall': 0.6337970165644733, 'f1-score': 0.50699121522694, 'support': 21854}, 'accuracy': 0.6830327692661197, 'macro avg': {'precision': 0.5854092068719444, 'recall': 0.6260505875522765, 'f1-score': 0.5973553745486982, 'support': 134913}, 'weighted avg': {'precision': 0.7196836474501623, 'recall': 0.6830327692661197, 'f1-score': 0.6953396952002846, 'support': 134913}}
[[11014  6558  4108]
 [ 9267 67285 14827]
 [ 2287  5716 13851]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.781165
{'0': {'precision': 0.5197305501268245, 'recall': 0.48892974495384134, 'f1-score': 0.5038598754358737, 'support': 25564}, '1': {'precision': 0.7924503293702865, 'recall': 0.7159382109926955, 'f1-score': 0.75225375415993, 'support': 83510}, '2': {'precision': 0.4502639975153175, 'recall': 0.6171678470529045, 'f1-score': 0.5206673631970745, 'support': 25839}, 'accuracy': 0.6540066561413652, 'macro avg': {'precision': 0.5874816256708094, 'recall': 0.6073452676664804, 'f1-score': 0.5922603309309594, 'support': 134913}, 'weighted avg': {'precision': 0.6752373027132527, 'recall': 0.6540066561413652, 'f1-score': 0.6608326022191164, 'support': 134913}}
[[12499  8246  4819]
 [ 9071 59788 14651]
 [ 2479  7413 15947]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8542104
{'0': {'precision': 0.5569534307852065, 'recall': 0.43946174209000377, 'f1-score': 0.49128060595384887, 'support': 31732}, '1': {'precision': 0.6926941595143395, 'recall': 0.6982780450747025, 'f1-score': 0.6954748943861788, 'support': 71082}, '2': {'precision': 0.4816326530612245, 'recall': 0.5734758092152403, 'f1-score': 0.5235569334034899, 'support': 32099}, 'accuracy': 0.6077101539510648, 'macro avg': {'precision': 0.5770934144535902, 'recall': 0.5704051987933155, 'f1-score': 0.5701041445811725, 'support': 134913}, 'weighted avg': {'precision': 0.6105509405534433, 'recall': 0.6077101539510648, 'f1-score': 0.6065443406951481, 'support': 134913}}
[[13945 11451  6336]
 [ 7971 49635 13476]
 [ 3122 10569 18408]]
Evaluating performance on  val set...
159/159 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.78369635
{'0': {'precision': 0.3903137789904502, 'recall': 0.5270817980840088, 'f1-score': 0.4485029001410879, 'support': 5428}, '1': {'precision': 0.8860628189701673, 'recall': 0.7120944346260295, 'f1-score': 0.7896099094102422, 'support': 29989}, '2': {'precision': 0.34704791007312014, 'recall': 0.6142553602472475, 'f1-score': 0.44351464435146437, 'support': 5177}, 'accuracy': 0.6748780607971622, 'macro avg': {'precision': 0.5411415026779125, 'recall': 0.617810530985762, 'f1-score': 0.5605424846342648, 'support': 40594}, 'weighted avg': {'precision': 0.7510328644850236, 'recall': 0.6748780607971622, 'f1-score': 0.6998610787081122, 'support': 40594}}
[[ 2861  1460  1107]
 [ 3758 21355  4876]
 [  711  1286  3180]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8138575
{'0': {'precision': 0.4611509885404861, 'recall': 0.5037831888843032, 'f1-score': 0.48152531229454304, 'support': 7269}, '1': {'precision': 0.8196390145360327, 'recall': 0.7071304084261575, 'f1-score': 0.7592392962473304, 'support': 26394}, '2': {'precision': 0.4081157660392633, 'recall': 0.5818785168085413, 'f1-score': 0.4797478141913995, 'support': 6931}, 'accuracy': 0.6493324136571907, 'macro avg': {'precision': 0.5629685897052606, 'recall': 0.5975973713730007, 'f1-score': 0.573504140911091, 'support': 40594}, 'weighted avg': {'precision': 0.6851827624718672, 'recall': 0.6493324136571907, 'f1-score': 0.6617899586239755, 'support': 40594}}
[[ 3662  2134  1473]
 [ 3354 18664  4376]
 [  925  1973  4033]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8550598
{'0': {'precision': 0.49641062455132806, 'recall': 0.4832285115303983, 'f1-score': 0.4897308781869688, 'support': 8586}, '1': {'precision': 0.7647798742138365, 'recall': 0.6875811518324607, 'f1-score': 0.7241288045875606, 'support': 23875}, '2': {'precision': 0.4320861572741621, 'recall': 0.572236567072421, 'f1-score': 0.492382564536606, 'support': 8133}, 'accuracy': 0.6212494457308962, 'macro avg': {'precision': 0.5644255520131088, 'recall': 0.5810154101450934, 'f1-score': 0.5687474157703785, 'support': 40594}, 'weighted avg': {'precision': 0.6413622169868407, 'recall': 0.6212494457308962, 'f1-score': 0.6281211983795028, 'support': 40594}}
[[ 4149  2618  1819]
 [ 3161 16416  4298]
 [ 1048  2431  4654]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9127863
{'0': {'precision': 0.5292682926829269, 'recall': 0.42776682624612783, 'f1-score': 0.47313502569693194, 'support': 10653}, '1': {'precision': 0.660578911095796, 'recall': 0.6709835491774588, 'f1-score': 0.6657405799617988, 'support': 19999}, '2': {'precision': 0.46006855184233075, 'recall': 0.54003218668276, 'f1-score': 0.49685359985193417, 'support': 9942}, 'accuracy': 0.5750849879292507, 'macro avg': {'precision': 0.5499719185403512, 'recall': 0.5462608540354489, 'f1-score': 0.545243068503555, 'support': 40594}, 'weighted avg': {'precision': 0.5770117334426884, 'recall': 0.5750849879292507, 'f1-score': 0.5738328762165187, 'support': 40594}}
[[ 4557  3638  2458]
 [ 2737 13419  3843]
 [ 1316  3257  5369]]
training model: results/QRTEA/W2/deepVOL_L2/seq2seq
Epoch 1/50
528/528 - 20s - loss: 11.3409 - accuracy10: 0.5288 - accuracy20: 0.5354 - accuracy30: 0.5329 - accuracy50: 0.5225 - val_loss: 12.0871 - val_accuracy10: 0.5361 - val_accuracy20: 0.5367 - val_accuracy30: 0.5247 - val_accuracy50: 0.5039 - 20s/epoch - 38ms/step
Epoch 2/50
528/528 - 14s - loss: 10.5290 - accuracy10: 0.6022 - accuracy20: 0.6006 - accuracy30: 0.5867 - accuracy50: 0.5644 - val_loss: 12.2669 - val_accuracy10: 0.5257 - val_accuracy20: 0.5273 - val_accuracy30: 0.5178 - val_accuracy50: 0.4999 - 14s/epoch - 26ms/step
Epoch 3/50
528/528 - 14s - loss: 10.2428 - accuracy10: 0.6240 - accuracy20: 0.6188 - accuracy30: 0.6025 - accuracy50: 0.5781 - val_loss: 11.8833 - val_accuracy10: 0.6056 - val_accuracy20: 0.6005 - val_accuracy30: 0.5836 - val_accuracy50: 0.5490 - 14s/epoch - 26ms/step
Epoch 4/50
528/528 - 14s - loss: 10.0948 - accuracy10: 0.6352 - accuracy20: 0.6277 - accuracy30: 0.6103 - accuracy50: 0.5868 - val_loss: 12.0861 - val_accuracy10: 0.5860 - val_accuracy20: 0.5840 - val_accuracy30: 0.5711 - val_accuracy50: 0.5426 - 14s/epoch - 26ms/step
Epoch 5/50
528/528 - 14s - loss: 10.0028 - accuracy10: 0.6391 - accuracy20: 0.6326 - accuracy30: 0.6166 - accuracy50: 0.5909 - val_loss: 11.8451 - val_accuracy10: 0.6199 - val_accuracy20: 0.6132 - val_accuracy30: 0.5954 - val_accuracy50: 0.5602 - 14s/epoch - 26ms/step
Epoch 6/50
528/528 - 14s - loss: 9.9329 - accuracy10: 0.6445 - accuracy20: 0.6374 - accuracy30: 0.6198 - accuracy50: 0.5936 - val_loss: 12.0038 - val_accuracy10: 0.6310 - val_accuracy20: 0.6210 - val_accuracy30: 0.5986 - val_accuracy50: 0.5592 - 14s/epoch - 26ms/step
Epoch 7/50
528/528 - 15s - loss: 9.8812 - accuracy10: 0.6493 - accuracy20: 0.6414 - accuracy30: 0.6218 - accuracy50: 0.5941 - val_loss: 11.9840 - val_accuracy10: 0.6901 - val_accuracy20: 0.6679 - val_accuracy30: 0.6381 - val_accuracy50: 0.5859 - 15s/epoch - 28ms/step
Epoch 8/50
528/528 - 14s - loss: 9.8272 - accuracy10: 0.6489 - accuracy20: 0.6416 - accuracy30: 0.6237 - accuracy50: 0.5963 - val_loss: 12.1183 - val_accuracy10: 0.6502 - val_accuracy20: 0.6346 - val_accuracy30: 0.6110 - val_accuracy50: 0.5689 - 14s/epoch - 27ms/step
Epoch 9/50
528/528 - 14s - loss: 9.7523 - accuracy10: 0.6505 - accuracy20: 0.6431 - accuracy30: 0.6256 - accuracy50: 0.5992 - val_loss: 11.9892 - val_accuracy10: 0.6655 - val_accuracy20: 0.6467 - val_accuracy30: 0.6188 - val_accuracy50: 0.5719 - 14s/epoch - 27ms/step
Epoch 10/50
528/528 - 14s - loss: 9.7109 - accuracy10: 0.6529 - accuracy20: 0.6447 - accuracy30: 0.6265 - accuracy50: 0.6000 - val_loss: 12.4146 - val_accuracy10: 0.6557 - val_accuracy20: 0.6350 - val_accuracy30: 0.6077 - val_accuracy50: 0.5630 - 14s/epoch - 27ms/step
Epoch 11/50
528/528 - 14s - loss: 9.6790 - accuracy10: 0.6548 - accuracy20: 0.6477 - accuracy30: 0.6290 - accuracy50: 0.6017 - val_loss: 11.8579 - val_accuracy10: 0.6256 - val_accuracy20: 0.6150 - val_accuracy30: 0.5916 - val_accuracy50: 0.5550 - 14s/epoch - 27ms/step
Epoch 12/50
528/528 - 14s - loss: 9.6194 - accuracy10: 0.6557 - accuracy20: 0.6474 - accuracy30: 0.6288 - accuracy50: 0.6013 - val_loss: 11.6887 - val_accuracy10: 0.6330 - val_accuracy20: 0.6242 - val_accuracy30: 0.6044 - val_accuracy50: 0.5665 - 14s/epoch - 27ms/step
Epoch 13/50
528/528 - 14s - loss: 9.5981 - accuracy10: 0.6552 - accuracy20: 0.6473 - accuracy30: 0.6295 - accuracy50: 0.6028 - val_loss: 11.8106 - val_accuracy10: 0.6317 - val_accuracy20: 0.6260 - val_accuracy30: 0.6082 - val_accuracy50: 0.5713 - 14s/epoch - 27ms/step
Epoch 14/50
528/528 - 14s - loss: 9.5572 - accuracy10: 0.6601 - accuracy20: 0.6502 - accuracy30: 0.6310 - accuracy50: 0.6041 - val_loss: 11.9478 - val_accuracy10: 0.6353 - val_accuracy20: 0.6251 - val_accuracy30: 0.6054 - val_accuracy50: 0.5675 - 14s/epoch - 27ms/step
Epoch 15/50
528/528 - 14s - loss: 9.5153 - accuracy10: 0.6591 - accuracy20: 0.6509 - accuracy30: 0.6317 - accuracy50: 0.6051 - val_loss: 12.1711 - val_accuracy10: 0.6617 - val_accuracy20: 0.6473 - val_accuracy30: 0.6218 - val_accuracy50: 0.5769 - 14s/epoch - 27ms/step
Epoch 16/50
528/528 - 14s - loss: 9.4680 - accuracy10: 0.6613 - accuracy20: 0.6522 - accuracy30: 0.6330 - accuracy50: 0.6060 - val_loss: 11.9993 - val_accuracy10: 0.6660 - val_accuracy20: 0.6509 - val_accuracy30: 0.6265 - val_accuracy50: 0.5821 - 14s/epoch - 26ms/step
Epoch 17/50
528/528 - 14s - loss: 9.4335 - accuracy10: 0.6623 - accuracy20: 0.6535 - accuracy30: 0.6349 - accuracy50: 0.6079 - val_loss: 12.2830 - val_accuracy10: 0.6518 - val_accuracy20: 0.6367 - val_accuracy30: 0.6106 - val_accuracy50: 0.5664 - 14s/epoch - 26ms/step
Epoch 18/50
528/528 - 14s - loss: 9.3940 - accuracy10: 0.6630 - accuracy20: 0.6542 - accuracy30: 0.6347 - accuracy50: 0.6088 - val_loss: 12.0266 - val_accuracy10: 0.6487 - val_accuracy20: 0.6356 - val_accuracy30: 0.6098 - val_accuracy50: 0.5688 - 14s/epoch - 26ms/step
Epoch 19/50
528/528 - 14s - loss: 9.3512 - accuracy10: 0.6641 - accuracy20: 0.6557 - accuracy30: 0.6358 - accuracy50: 0.6099 - val_loss: 12.1044 - val_accuracy10: 0.6607 - val_accuracy20: 0.6436 - val_accuracy30: 0.6187 - val_accuracy50: 0.5748 - 14s/epoch - 26ms/step
Epoch 20/50
528/528 - 14s - loss: 9.3086 - accuracy10: 0.6657 - accuracy20: 0.6556 - accuracy30: 0.6360 - accuracy50: 0.6097 - val_loss: 12.0855 - val_accuracy10: 0.6592 - val_accuracy20: 0.6436 - val_accuracy30: 0.6173 - val_accuracy50: 0.5753 - 14s/epoch - 27ms/step
Epoch 21/50
528/528 - 14s - loss: 9.2484 - accuracy10: 0.6667 - accuracy20: 0.6562 - accuracy30: 0.6376 - accuracy50: 0.6122 - val_loss: 12.1401 - val_accuracy10: 0.6679 - val_accuracy20: 0.6456 - val_accuracy30: 0.6146 - val_accuracy50: 0.5684 - 14s/epoch - 27ms/step
Epoch 22/50
528/528 - 14s - loss: 9.2707 - accuracy10: 0.6648 - accuracy20: 0.6551 - accuracy30: 0.6362 - accuracy50: 0.6122 - val_loss: 12.2804 - val_accuracy10: 0.6465 - val_accuracy20: 0.6252 - val_accuracy30: 0.5975 - val_accuracy50: 0.5544 - 14s/epoch - 27ms/step
testing model: results/QRTEA/W2/deepVOL_L2/seq2seq
Evaluating performance on  test set...
1242/1242 - 11s - 11s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0057377
{'0': {'precision': 0.3554331418713611, 'recall': 0.36059346472822734, 'f1-score': 0.3579947083678869, 'support': 50281}, '1': {'precision': 0.8648287730166925, 'recall': 0.578018034596982, 'f1-score': 0.6929171205206337, 'support': 217360}, '2': {'precision': 0.3137688971550369, 'recall': 0.7601379640336536, 'f1-score': 0.44418684576894174, 'support': 50158}, 'accuracy': 0.5723617758394457, 'macro avg': {'precision': 0.5113436040143635, 'recall': 0.566249821119621, 'f1-score': 0.4983662248858208, 'support': 317799}, 'weighted avg': {'precision': 0.6972606466755544, 'recall': 0.5723617758394457, 'f1-score': 0.6006699865571926, 'support': 317799}}
[[ 18131  11955  20195]
 [ 28531 125638  63191]
 [  4349   7682  38127]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0017813
{'0': {'precision': 0.4175056348610068, 'recall': 0.3430299850306332, 'f1-score': 0.37662128618507446, 'support': 64799}, '1': {'precision': 0.7837008153137185, 'recall': 0.5899169619604662, 'f1-score': 0.6731398089113795, 'support': 187384}, '2': {'precision': 0.38049858714749535, 'recall': 0.7162125091441112, 'f1-score': 0.4969729015201587, 'support': 65616}, 'accuracy': 0.5656531329551069, 'macro avg': {'precision': 0.5272350124407402, 'recall': 0.5497198187117368, 'f1-score': 0.5155779988722042, 'support': 317799}, 'weighted avg': {'precision': 0.6257846516331841, 'recall': 0.5656531329551069, 'f1-score': 0.5763066799540065, 'support': 317799}}
[[ 22228  17941  24630]
 [ 24959 110541  51884]
 [  6053  12568  46995]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.019072
{'0': {'precision': 0.44217638817457927, 'recall': 0.33722408569573686, 'f1-score': 0.3826339172670979, 'support': 73936}, '1': {'precision': 0.7191107342071981, 'recall': 0.5872397077084727, 'f1-score': 0.6465192858152229, 'support': 167504}, '2': {'precision': 0.41608826479438316, 'recall': 0.6790948021844183, 'f1-score': 0.5160112247741113, 'support': 76359}, 'accuracy': 0.5511439620640719, 'macro avg': {'precision': 0.5257917957253868, 'recall': 0.5345195318628759, 'f1-score': 0.5150548092854773, 'support': 317799}, 'weighted avg': {'precision': 0.5818733277013223, 'recall': 0.5511439620640719, 'f1-score': 0.5537685419739509, 'support': 317799}}
[[24933 21877 27126]
 [23495 98365 45644]
 [ 7959 16545 51855]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0482575
{'0': {'precision': 0.4644252397300817, 'recall': 0.31811178685201275, 'f1-score': 0.3775901659631224, 'support': 86325}, '1': {'precision': 0.6180638564995452, 'recall': 0.5854250781511469, 'f1-score': 0.6013018833424758, 'support': 140433}, '2': {'precision': 0.4547603320254988, 'recall': 0.6276512779956284, 'f1-score': 0.5273980820881058, 'support': 91041}, 'accuracy': 0.5249103993404636, 'macro avg': {'precision': 0.5124164760850419, 'recall': 0.5103960476662627, 'f1-score': 0.5020967104645679, 'support': 317799}, 'weighted avg': {'precision': 0.5295482546119823, 'recall': 0.5249103993404636, 'f1-score': 0.5193627017441329, 'support': 317799}}
[[27461 27735 31129]
 [20838 82213 37382]
 [10830 23069 57142]]
Evaluating performance on  train set...
528/528 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7773577
{'0': {'precision': 0.39167135621834553, 'recall': 0.3899645147232771, 'f1-score': 0.3908160718742201, 'support': 16063}, '1': {'precision': 0.9045453977691452, 'recall': 0.7053168798028693, 'f1-score': 0.7926033754350634, 'support': 102673}, '2': {'precision': 0.3019659307292471, 'recall': 0.7253677834095685, 'f1-score': 0.4264171511627907, 'support': 16178}, 'accuracy': 0.6701750744918985, 'macro avg': {'precision': 0.5327275615722459, 'recall': 0.606883059311905, 'f1-score': 0.5366121994906915, 'support': 134914}, 'weighted avg': {'precision': 0.7712247168375742, 'recall': 0.6701750744918985, 'f1-score': 0.7008555198131513, 'support': 134914}}
[[ 6264  4408  5391]
 [ 8520 72417 21736]
 [ 1209  3234 11735]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7815988
{'0': {'precision': 0.48189213618559806, 'recall': 0.3694788394012197, 'f1-score': 0.4182640759434086, 'support': 21644}, '1': {'precision': 0.8412363266344441, 'recall': 0.7235313423039055, 'f1-score': 0.7779568311474445, 'support': 91410}, '2': {'precision': 0.3760800020151641, 'recall': 0.6829826166514181, 'f1-score': 0.4850631101869751, 'support': 21860}, 'accuracy': 0.6601612879315713, 'macro avg': {'precision': 0.5664028216117355, 'recall': 0.5919975994521811, 'f1-score': 0.5604280057592761, 'support': 134914}, 'weighted avg': {'precision': 0.7082185307477883, 'recall': 0.6601612879315713, 'f1-score': 0.6727946779696274, 'support': 134914}}
[[ 7997  7067  6580]
 [ 7083 66138 18189]
 [ 1515  5415 14930]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8182663
{'0': {'precision': 0.5246241575946086, 'recall': 0.3561986703167775, 'f1-score': 0.4243087745452004, 'support': 25570}, '1': {'precision': 0.7856521682696676, 'recall': 0.7248547991138256, 'f1-score': 0.754029947430052, 'support': 83505}, '2': {'precision': 0.4151567514194026, 'recall': 0.6508765819110647, 'f1-score': 0.506955643641954, 'support': 25839}, 'accuracy': 0.6408156306980743, 'macro avg': {'precision': 0.5751443590945595, 'recall': 0.5773100171138893, 'f1-score': 0.5617647885390687, 'support': 134914}, 'weighted avg': {'precision': 0.6652219882367929, 'recall': 0.6408156306980743, 'f1-score': 0.644218339099958, 'support': 134914}}
[[ 9108  9250  7212]
 [ 6496 60529 16480]
 [ 1757  7264 16818]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8927483
{'0': {'precision': 0.5694068218254188, 'recall': 0.3245627855679849, 'f1-score': 0.41345536287732826, 'support': 31735}, '1': {'precision': 0.6835624056566298, 'recall': 0.7262291622705213, 'f1-score': 0.7042501381243733, 'support': 71085}, '2': {'precision': 0.4599907996997797, 'recall': 0.5919798093101515, 'f1-score': 0.5177050833140319, 'support': 32094}, 'accuracy': 0.5998117319181108, 'macro avg': {'precision': 0.570986675727276, 'recall': 0.5475905857162192, 'f1-score': 0.5451368614385778, 'support': 134914}, 'weighted avg': {'precision': 0.6035259781957093, 'recall': 0.5998117319181108, 'f1-score': 0.5914720040423057, 'support': 134914}}
[[10300 13123  8312]
 [ 5469 51624 13992]
 [ 2320 10775 18999]]
Evaluating performance on  val set...
159/159 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.87038046
{'0': {'precision': 0.39311119430924746, 'recall': 0.39047973224246935, 'f1-score': 0.3917910447761194, 'support': 5378}, '1': {'precision': 0.8974044831654415, 'recall': 0.65881608314734, 'f1-score': 0.7598209654801467, 'support': 30019}, '2': {'precision': 0.29148694665153235, 'recall': 0.7410542516352443, 'f1-score': 0.41840004344756415, 'support': 5198}, 'accuracy': 0.6337972656731125, 'macro avg': {'precision': 0.5273342080420738, 'recall': 0.5967833556750178, 'f1-score': 0.5233373512346101, 'support': 40595}, 'weighted avg': {'precision': 0.753011117916817, 'recall': 0.6337972656731125, 'f1-score': 0.6673472404826931, 'support': 40595}}
[[ 2100  1350  1928]
 [ 2807 19777  7435]
 [  435   911  3852]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.86757493
{'0': {'precision': 0.47153887592027294, 'recall': 0.36517869559171184, 'f1-score': 0.4115987460815047, 'support': 7191}, '1': {'precision': 0.828720844131803, 'recall': 0.677269288956127, 'f1-score': 0.7453796203796204, 'support': 26440}, '2': {'precision': 0.36227455656580715, 'recall': 0.6980183802412406, 'f1-score': 0.4769895005396919, 'support': 6964}, 'accuracy': 0.6255450178593422, 'macro avg': {'precision': 0.554178092205961, 'recall': 0.5801554549296931, 'f1-score': 0.544655955666939, 'support': 40595}, 'weighted avg': {'precision': 0.6854315848629593, 'recall': 0.6255450178593422, 'f1-score': 0.6402118149443939, 'support': 40595}}
[[ 2626  2195  2370]
 [ 2346 17907  6187]
 [  597  1506  4861]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8961883
{'0': {'precision': 0.5136612021857924, 'recall': 0.3526377491207503, 'f1-score': 0.4181843458918393, 'support': 8530}, '1': {'precision': 0.7693512410421907, 'recall': 0.6774908057505851, 'f1-score': 0.7205049001088915, 'support': 23928}, '2': {'precision': 0.3952297336845186, 'recall': 0.6638810372373111, 'f1-score': 0.4954826874570053, 'support': 8137}, 'accuracy': 0.6065032639487622, 'macro avg': {'precision': 0.5594140589708338, 'recall': 0.5646698640362154, 'f1-score': 0.5447239778192453, 'support': 40595}, 'weighted avg': {'precision': 0.6406343365757673, 'recall': 0.6065032639487622, 'f1-score': 0.6118757568198201, 'support': 40595}}
[[ 3008  2852  2670]
 [ 2121 16211  5596]
 [  727  2008  5402]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.950907
{'0': {'precision': 0.5512630014858841, 'recall': 0.3146141524545369, 'f1-score': 0.4005998800239952, 'support': 10613}, '1': {'precision': 0.662864077669903, 'recall': 0.6825111211076124, 'f1-score': 0.6725441426355062, 'support': 20007}, '2': {'precision': 0.4390873869995695, 'recall': 0.6135338345864662, 'f1-score': 0.5118554761008657, 'support': 9975}, 'accuracy': 0.5693804655745781, 'macro avg': {'precision': 0.5510714887184522, 'recall': 0.5368863693828718, 'f1-score': 0.5283331662534557, 'support': 40595}, 'weighted avg': {'precision': 0.5787011336872063, 'recall': 0.5693804655745781, 'f1-score': 0.5619636793326609, 'support': 40595}}
[[ 3339  4043  3231]
 [ 1765 13655  4587]
 [  953  2902  6120]]
training model: results/QRTEA/W2/deepVOL_L3/seq2seq
Epoch 1/50
528/528 - 28s - loss: 11.8903 - accuracy10: 0.4766 - accuracy20: 0.4879 - accuracy30: 0.4920 - accuracy50: 0.4916 - val_loss: 13.2782 - val_accuracy10: 0.5112 - val_accuracy20: 0.5091 - val_accuracy30: 0.4993 - val_accuracy50: 0.4849 - 28s/epoch - 54ms/step
Epoch 2/50
528/528 - 21s - loss: 10.7285 - accuracy10: 0.5811 - accuracy20: 0.5818 - accuracy30: 0.5752 - accuracy50: 0.5579 - val_loss: 12.5836 - val_accuracy10: 0.5955 - val_accuracy20: 0.5824 - val_accuracy30: 0.5632 - val_accuracy50: 0.5308 - 21s/epoch - 40ms/step
Epoch 3/50
528/528 - 20s - loss: 10.2712 - accuracy10: 0.6245 - accuracy20: 0.6177 - accuracy30: 0.6026 - accuracy50: 0.5786 - val_loss: 12.1352 - val_accuracy10: 0.5931 - val_accuracy20: 0.5843 - val_accuracy30: 0.5693 - val_accuracy50: 0.5367 - 20s/epoch - 38ms/step
Epoch 4/50
528/528 - 20s - loss: 10.0644 - accuracy10: 0.6385 - accuracy20: 0.6263 - accuracy30: 0.6073 - accuracy50: 0.5828 - val_loss: 12.1884 - val_accuracy10: 0.6344 - val_accuracy20: 0.6185 - val_accuracy30: 0.5971 - val_accuracy50: 0.5555 - 20s/epoch - 38ms/step
Epoch 5/50
528/528 - 20s - loss: 9.9033 - accuracy10: 0.6468 - accuracy20: 0.6363 - accuracy30: 0.6174 - accuracy50: 0.5909 - val_loss: 12.2764 - val_accuracy10: 0.6212 - val_accuracy20: 0.6099 - val_accuracy30: 0.5915 - val_accuracy50: 0.5571 - 20s/epoch - 38ms/step
Epoch 6/50
528/528 - 21s - loss: 9.8339 - accuracy10: 0.6466 - accuracy20: 0.6370 - accuracy30: 0.6173 - accuracy50: 0.5908 - val_loss: 12.1852 - val_accuracy10: 0.6248 - val_accuracy20: 0.6118 - val_accuracy30: 0.5916 - val_accuracy50: 0.5540 - 21s/epoch - 39ms/step
Epoch 7/50
528/528 - 21s - loss: 9.7666 - accuracy10: 0.6511 - accuracy20: 0.6401 - accuracy30: 0.6204 - accuracy50: 0.5927 - val_loss: 12.6235 - val_accuracy10: 0.6346 - val_accuracy20: 0.6219 - val_accuracy30: 0.6014 - val_accuracy50: 0.5613 - 21s/epoch - 39ms/step
Epoch 8/50
528/528 - 21s - loss: 9.6856 - accuracy10: 0.6558 - accuracy20: 0.6452 - accuracy30: 0.6244 - accuracy50: 0.5961 - val_loss: 12.0456 - val_accuracy10: 0.6299 - val_accuracy20: 0.6175 - val_accuracy30: 0.5951 - val_accuracy50: 0.5565 - 21s/epoch - 39ms/step
Epoch 9/50
528/528 - 20s - loss: 9.6620 - accuracy10: 0.6543 - accuracy20: 0.6449 - accuracy30: 0.6238 - accuracy50: 0.5968 - val_loss: 12.3405 - val_accuracy10: 0.6063 - val_accuracy20: 0.5933 - val_accuracy30: 0.5731 - val_accuracy50: 0.5401 - 20s/epoch - 38ms/step
Epoch 10/50
528/528 - 21s - loss: 9.5963 - accuracy10: 0.6576 - accuracy20: 0.6484 - accuracy30: 0.6266 - accuracy50: 0.5997 - val_loss: 12.5026 - val_accuracy10: 0.6218 - val_accuracy20: 0.6044 - val_accuracy30: 0.5785 - val_accuracy50: 0.5373 - 21s/epoch - 40ms/step
Epoch 11/50
528/528 - 20s - loss: 9.5443 - accuracy10: 0.6615 - accuracy20: 0.6507 - accuracy30: 0.6299 - accuracy50: 0.6013 - val_loss: 12.4488 - val_accuracy10: 0.6469 - val_accuracy20: 0.6322 - val_accuracy30: 0.6082 - val_accuracy50: 0.5619 - 20s/epoch - 38ms/step
Epoch 12/50
528/528 - 21s - loss: 9.4992 - accuracy10: 0.6608 - accuracy20: 0.6502 - accuracy30: 0.6292 - accuracy50: 0.6011 - val_loss: 12.4073 - val_accuracy10: 0.6134 - val_accuracy20: 0.6025 - val_accuracy30: 0.5801 - val_accuracy50: 0.5435 - 21s/epoch - 39ms/step
Epoch 13/50
528/528 - 21s - loss: 9.4498 - accuracy10: 0.6608 - accuracy20: 0.6518 - accuracy30: 0.6315 - accuracy50: 0.6041 - val_loss: 12.6735 - val_accuracy10: 0.6021 - val_accuracy20: 0.5882 - val_accuracy30: 0.5677 - val_accuracy50: 0.5344 - 21s/epoch - 39ms/step
Epoch 14/50
528/528 - 21s - loss: 9.4098 - accuracy10: 0.6622 - accuracy20: 0.6539 - accuracy30: 0.6327 - accuracy50: 0.6038 - val_loss: 12.5689 - val_accuracy10: 0.6091 - val_accuracy20: 0.5999 - val_accuracy30: 0.5798 - val_accuracy50: 0.5432 - 21s/epoch - 40ms/step
Epoch 15/50
528/528 - 20s - loss: 9.3494 - accuracy10: 0.6621 - accuracy20: 0.6538 - accuracy30: 0.6326 - accuracy50: 0.6063 - val_loss: 12.7831 - val_accuracy10: 0.5938 - val_accuracy20: 0.5871 - val_accuracy30: 0.5691 - val_accuracy50: 0.5369 - 20s/epoch - 38ms/step
Epoch 16/50
528/528 - 20s - loss: 9.3135 - accuracy10: 0.6632 - accuracy20: 0.6558 - accuracy30: 0.6346 - accuracy50: 0.6083 - val_loss: 12.6530 - val_accuracy10: 0.5910 - val_accuracy20: 0.5830 - val_accuracy30: 0.5661 - val_accuracy50: 0.5337 - 20s/epoch - 38ms/step
Epoch 17/50
528/528 - 20s - loss: 9.2741 - accuracy10: 0.6655 - accuracy20: 0.6574 - accuracy30: 0.6361 - accuracy50: 0.6078 - val_loss: 12.4578 - val_accuracy10: 0.5834 - val_accuracy20: 0.5739 - val_accuracy30: 0.5558 - val_accuracy50: 0.5268 - 20s/epoch - 38ms/step
Epoch 18/50
528/528 - 20s - loss: 9.2340 - accuracy10: 0.6666 - accuracy20: 0.6591 - accuracy30: 0.6385 - accuracy50: 0.6110 - val_loss: 12.5513 - val_accuracy10: 0.6116 - val_accuracy20: 0.5994 - val_accuracy30: 0.5796 - val_accuracy50: 0.5423 - 20s/epoch - 38ms/step
testing model: results/QRTEA/W2/deepVOL_L3/seq2seq
Evaluating performance on  test set...
1242/1242 - 21s - 21s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9235639
{'0': {'precision': 0.429010572282234, 'recall': 0.2969909110797319, 'f1-score': 0.35099719117629774, 'support': 50281}, '1': {'precision': 0.8610364041126739, 'recall': 0.615679057784321, 'f1-score': 0.7179745803177192, 'support': 217360}, '2': {'precision': 0.3094325423888249, 'recall': 0.7869931017983173, 'f1-score': 0.4442093773033922, 'support': 50158}, 'accuracy': 0.5922957592692236, 'macro avg': {'precision': 0.5331598395945776, 'recall': 0.5665543568874568, 'f1-score': 0.5043937162658031, 'support': 317799}, 'weighted avg': {'precision': 0.7056235886330432, 'recall': 0.5922957592692236, 'f1-score': 0.6167045789765808, 'support': 317799}}
[[ 14933  14734  20614]
 [ 16055 133824  67481]
 [  3820   6864  39474]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9490295
{'0': {'precision': 0.5013042985142339, 'recall': 0.2728437167240235, 'f1-score': 0.35336324662476143, 'support': 64799}, '1': {'precision': 0.7810073382254836, 'recall': 0.624775861332878, 'f1-score': 0.6942102204670249, 'support': 187384}, '2': {'precision': 0.3740226643846461, 'recall': 0.7560198732016581, 'f1-score': 0.50045650123331, 'support': 65616}, 'accuracy': 0.580115104201083, 'macro avg': {'precision': 0.5521114337081211, 'recall': 0.5512131504195198, 'f1-score': 0.5160099894416987, 'support': 317799}, 'weighted avg': {'precision': 0.6399459011882693, 'recall': 0.580115104201083, 'f1-score': 0.5847073991892856, 'support': 317799}}
[[ 17680  21233  25886]
 [ 13173 117073  57138]
 [  4415  11594  49607]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9771245
{'0': {'precision': 0.5256442193251958, 'recall': 0.2568572819735988, 'f1-score': 0.3450869940489711, 'support': 73936}, '1': {'precision': 0.7176485987489322, 'recall': 0.6219015665297545, 'f1-score': 0.6663532271477003, 'support': 167504}, '2': {'precision': 0.4073281861201049, 'recall': 0.7282180227609057, 'f1-score': 0.5224335636741155, 'support': 76359}, 'accuracy': 0.5625190765232112, 'macro avg': {'precision': 0.5502070013980775, 'recall': 0.5356589570880863, 'f1-score': 0.5112912616235956, 'support': 317799}, 'weighted avg': {'precision': 0.5984166559643482, 'recall': 0.5625190765232112, 'f1-score': 0.5570303476119965, 'support': 317799}}
[[ 18991  25472  29473]
 [ 11898 104171  51435]
 [  5240  15513  55606]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0199435
{'0': {'precision': 0.5454619988521767, 'recall': 0.2312076455256299, 'f1-score': 0.3247583715708289, 'support': 86325}, '1': {'precision': 0.6173673318970405, 'recall': 0.6203171619206312, 'f1-score': 0.6188387316764759, 'support': 140433}, '2': {'precision': 0.4442342831039799, 'recall': 0.6836370426511132, 'f1-score': 0.5385277639576889, 'support': 91041}, 'accuracy': 0.5327612736352223, 'macro avg': {'precision': 0.535687871284399, 'recall': 0.5117206166991247, 'f1-score': 0.49404162240166455, 'support': 317799}, 'weighted avg': {'precision': 0.5482373668239381, 'recall': 0.5327612736352223, 'f1-score': 0.5159495536167399, 'support': 317799}}
[[19959 31571 34795]
 [10250 87113 43070]
 [ 6382 22420 62239]]
Evaluating performance on  train set...
528/528 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7812531
{'0': {'precision': 0.4740834386852086, 'recall': 0.3501836518707589, 'f1-score': 0.40282154110570034, 'support': 16063}, '1': {'precision': 0.9029445117897783, 'recall': 0.6746953921673663, 'f1-score': 0.7723086871209418, 'support': 102673}, '2': {'precision': 0.2743146988992014, 'recall': 0.7855730003708741, 'f1-score': 0.40663595059832347, 'support': 16178}, 'accuracy': 0.6493544035459626, 'macro avg': {'precision': 0.5504475497913961, 'recall': 0.6034840148029997, 'f1-score': 0.5272553929416552, 'support': 134914}, 'weighted avg': {'precision': 0.7765027153103732, 'recall': 0.6493544035459626, 'f1-score': 0.6844680956485539, 'support': 134914}}
[[ 5625  5050  5388]
 [ 5167 69273 28233]
 [ 1073  2396 12709]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.80229974
{'0': {'precision': 0.575344700987191, 'recall': 0.3258177785991499, 'f1-score': 0.4160349252234448, 'support': 21644}, '1': {'precision': 0.8412959691665328, 'recall': 0.6877256317689531, 'f1-score': 0.7567987287370436, 'support': 91410}, '2': {'precision': 0.3446477374668809, 'recall': 0.7557182067703568, 'f1-score': 0.4733999111658762, 'support': 21860}, 'accuracy': 0.640682212372326, 'macro avg': {'precision': 0.5870961358735348, 'recall': 0.5897538723794865, 'f1-score': 0.5487445217087882, 'support': 134914}, 'weighted avg': {'precision': 0.7181584178862501, 'recall': 0.640682212372326, 'f1-score': 0.65621176285245, 'support': 134914}}
[[ 7052  7670  6922]
 [ 4054 62865 24491]
 [ 1151  4189 16520]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8418643
{'0': {'precision': 0.6180281245062411, 'recall': 0.3059444661712945, 'f1-score': 0.4092811551742179, 'support': 25570}, '1': {'precision': 0.7855693842864192, 'recall': 0.6863301598706665, 'f1-score': 0.7326042911652105, 'support': 83505}, '2': {'precision': 0.3815212981744422, 'recall': 0.7279306474708773, 'f1-score': 0.5006454703948682, 'support': 25839}, 'accuracy': 0.6222037742561929, 'macro avg': {'precision': 0.5950396023223675, 'recall': 0.5734017578376128, 'f1-score': 0.5475103055780989, 'support': 134914}, 'weighted avg': {'precision': 0.67643150008147, 'recall': 0.6222037742561929, 'f1-score': 0.6269002385303872, 'support': 134914}}
[[ 7823  9790  7957]
 [ 3659 57312 22534]
 [ 1176  5854 18809]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.91770405
{'0': {'precision': 0.6601647497668636, 'recall': 0.26768552071844964, 'f1-score': 0.3809160818779006, 'support': 31735}, '1': {'precision': 0.6843172915500839, 'recall': 0.6881198565098122, 'f1-score': 0.6862133062112019, 'support': 71085}, '2': {'precision': 0.42894434995847014, 'recall': 0.6758272574312956, 'f1-score': 0.5248003871279942, 'support': 32094}, 'accuracy': 0.586299420371496, 'macro avg': {'precision': 0.5911421304251392, 'recall': 0.5438775448865192, 'f1-score': 0.5306432584056989, 'support': 134914}, 'weighted avg': {'precision': 0.617886675743483, 'recall': 0.586299420371496, 'f1-score': 0.57600240416046, 'support': 134914}}
[[ 8495 13545  9695]
 [ 2989 48915 19181]
 [ 1384  9020 21690]]
Evaluating performance on  val set...
159/159 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.83674973
{'0': {'precision': 0.47898706896551724, 'recall': 0.330606173298624, 'f1-score': 0.39119911991199124, 'support': 5378}, '1': {'precision': 0.8890441209608364, 'recall': 0.6571504713681335, 'f1-score': 0.7557079374808459, 'support': 30019}, '2': {'precision': 0.2769838029127535, 'recall': 0.782993459022701, 'f1-score': 0.4092097325558013, 'support': 5198}, 'accuracy': 0.6300036950363346, 'macro avg': {'precision': 0.5483383309463691, 'recall': 0.5902500345631528, 'f1-score': 0.5187055966495461, 'support': 40595}, 'weighted avg': {'precision': 0.7563485584815961, 'recall': 0.6300036950363346, 'f1-score': 0.6630505636642261, 'support': 40595}}
[[ 1778  1711  1889]
 [ 1557 19727  8735]
 [  377   751  4070]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8622607
{'0': {'precision': 0.5707070707070707, 'recall': 0.2985676540119594, 'f1-score': 0.39203871085547337, 'support': 7191}, '1': {'precision': 0.8195094811998702, 'recall': 0.6685325264750378, 'f1-score': 0.7363619321377243, 'support': 26440}, '2': {'precision': 0.34394654088050314, 'recall': 0.753877082136703, 'f1-score': 0.4723771819326974, 'support': 6964}, 'accuracy': 0.617637640103461, 'macro avg': {'precision': 0.5780543642624814, 'recall': 0.5736590875412334, 'f1-score': 0.5335926083086316, 'support': 40595}, 'weighted avg': {'precision': 0.6938546357696992, 'recall': 0.617637640103461, 'f1-score': 0.6300823882365425, 'support': 40595}}
[[ 2147  2604  2440]
 [ 1190 17676  7574]
 [  425  1289  5250]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.90190583
{'0': {'precision': 0.6099767381752391, 'recall': 0.27667057444314186, 'f1-score': 0.3806758609565288, 'support': 8530}, '1': {'precision': 0.7578902270671681, 'recall': 0.6653711133400201, 'f1-score': 0.7086235673750974, 'support': 23928}, '2': {'precision': 0.37451491825179717, 'recall': 0.7234853139977879, 'f1-score': 0.49354460093896707, 'support': 8137}, 'accuracy': 0.5953442542184998, 'macro avg': {'precision': 0.5807939611647348, 'recall': 0.5551756672603166, 'f1-score': 0.5276146764235311, 'support': 40595}, 'weighted avg': {'precision': 0.6499649419808563, 'recall': 0.5953442542184998, 'f1-score': 0.596602592239214, 'support': 40595}}
[[ 2360  3289  2881]
 [ 1056 15921  6951]
 [  453  1797  5887]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.970997
{'0': {'precision': 0.6314321926489227, 'recall': 0.2347121454819561, 'f1-score': 0.3422173375463663, 'support': 10613}, '1': {'precision': 0.6510980966325036, 'recall': 0.6668166141850352, 'f1-score': 0.6588636195273724, 'support': 20007}, '2': {'precision': 0.4170173267326733, 'recall': 0.6755889724310777, 'f1-score': 0.5157069064472929, 'support': 9975}, 'accuracy': 0.5560044340436014, 'macro avg': {'precision': 0.5665158720046999, 'recall': 0.5257059106993563, 'f1-score': 0.5055959545070104, 'support': 40595}, 'weighted avg': {'precision': 0.5884384114809196, 'recall': 0.5560044340436014, 'f1-score': 0.5409043830785928, 'support': 40595}}
[[ 2491  4493  3629]
 [  874 13341  5792]
 [  580  2656  6739]]
training model: results/QRTEA/W3/deepLOB_L1/seq2seq
Epoch 1/50
641/641 - 22s - loss: 12.3211 - accuracy10: 0.4570 - accuracy20: 0.4612 - accuracy30: 0.4603 - accuracy50: 0.4564 - val_loss: 12.8419 - val_accuracy10: 0.5085 - val_accuracy20: 0.4877 - val_accuracy30: 0.4696 - val_accuracy50: 0.4327 - 22s/epoch - 34ms/step
Epoch 2/50
641/641 - 16s - loss: 12.1525 - accuracy10: 0.4578 - accuracy20: 0.4705 - accuracy30: 0.4735 - accuracy50: 0.4677 - val_loss: 11.8028 - val_accuracy10: 0.5306 - val_accuracy20: 0.5146 - val_accuracy30: 0.5022 - val_accuracy50: 0.4650 - 16s/epoch - 25ms/step
Epoch 3/50
641/641 - 15s - loss: 12.0357 - accuracy10: 0.4580 - accuracy20: 0.4736 - accuracy30: 0.4794 - accuracy50: 0.4748 - val_loss: 11.9561 - val_accuracy10: 0.5340 - val_accuracy20: 0.5013 - val_accuracy30: 0.4812 - val_accuracy50: 0.4449 - 15s/epoch - 23ms/step
Epoch 4/50
641/641 - 17s - loss: 11.9292 - accuracy10: 0.4710 - accuracy20: 0.4850 - accuracy30: 0.4884 - accuracy50: 0.4842 - val_loss: 11.6840 - val_accuracy10: 0.5214 - val_accuracy20: 0.5128 - val_accuracy30: 0.5022 - val_accuracy50: 0.4779 - 17s/epoch - 26ms/step
Epoch 5/50
641/641 - 15s - loss: 11.7426 - accuracy10: 0.4948 - accuracy20: 0.5048 - accuracy30: 0.5051 - accuracy50: 0.4969 - val_loss: 11.5070 - val_accuracy10: 0.5679 - val_accuracy20: 0.5467 - val_accuracy30: 0.5290 - val_accuracy50: 0.4932 - 15s/epoch - 24ms/step
Epoch 6/50
641/641 - 16s - loss: 11.6553 - accuracy10: 0.5116 - accuracy20: 0.5168 - accuracy30: 0.5143 - accuracy50: 0.5030 - val_loss: 11.4552 - val_accuracy10: 0.5703 - val_accuracy20: 0.5501 - val_accuracy30: 0.5329 - val_accuracy50: 0.4969 - 16s/epoch - 25ms/step
Epoch 7/50
641/641 - 14s - loss: 11.4901 - accuracy10: 0.5340 - accuracy20: 0.5335 - accuracy30: 0.5246 - accuracy50: 0.5098 - val_loss: 11.2098 - val_accuracy10: 0.5753 - val_accuracy20: 0.5589 - val_accuracy30: 0.5424 - val_accuracy50: 0.5083 - 14s/epoch - 22ms/step
Epoch 8/50
641/641 - 15s - loss: 11.3764 - accuracy10: 0.5446 - accuracy20: 0.5432 - accuracy30: 0.5349 - accuracy50: 0.5175 - val_loss: 11.2766 - val_accuracy10: 0.6056 - val_accuracy20: 0.5779 - val_accuracy30: 0.5547 - val_accuracy50: 0.5134 - 15s/epoch - 24ms/step
Epoch 9/50
641/641 - 15s - loss: 11.2942 - accuracy10: 0.5521 - accuracy20: 0.5483 - accuracy30: 0.5374 - accuracy50: 0.5191 - val_loss: 11.2682 - val_accuracy10: 0.5959 - val_accuracy20: 0.5698 - val_accuracy30: 0.5495 - val_accuracy50: 0.5129 - 15s/epoch - 23ms/step
Epoch 10/50
641/641 - 15s - loss: 11.2253 - accuracy10: 0.5581 - accuracy20: 0.5531 - accuracy30: 0.5416 - accuracy50: 0.5224 - val_loss: 11.3824 - val_accuracy10: 0.6141 - val_accuracy20: 0.5839 - val_accuracy30: 0.5580 - val_accuracy50: 0.5117 - 15s/epoch - 23ms/step
Epoch 11/50
641/641 - 16s - loss: 11.1883 - accuracy10: 0.5596 - accuracy20: 0.5555 - accuracy30: 0.5436 - accuracy50: 0.5246 - val_loss: 11.5208 - val_accuracy10: 0.6076 - val_accuracy20: 0.5782 - val_accuracy30: 0.5536 - val_accuracy50: 0.5109 - 16s/epoch - 25ms/step
Epoch 12/50
641/641 - 14s - loss: 11.1359 - accuracy10: 0.5622 - accuracy20: 0.5576 - accuracy30: 0.5462 - accuracy50: 0.5257 - val_loss: 11.7346 - val_accuracy10: 0.6103 - val_accuracy20: 0.5782 - val_accuracy30: 0.5517 - val_accuracy50: 0.5059 - 14s/epoch - 22ms/step
Epoch 13/50
641/641 - 14s - loss: 11.0941 - accuracy10: 0.5668 - accuracy20: 0.5600 - accuracy30: 0.5485 - accuracy50: 0.5284 - val_loss: 11.4151 - val_accuracy10: 0.6069 - val_accuracy20: 0.5784 - val_accuracy30: 0.5545 - val_accuracy50: 0.5121 - 14s/epoch - 22ms/step
Epoch 14/50
641/641 - 14s - loss: 11.0492 - accuracy10: 0.5701 - accuracy20: 0.5632 - accuracy30: 0.5513 - accuracy50: 0.5307 - val_loss: 11.5069 - val_accuracy10: 0.6159 - val_accuracy20: 0.5836 - val_accuracy30: 0.5585 - val_accuracy50: 0.5142 - 14s/epoch - 22ms/step
Epoch 15/50
641/641 - 15s - loss: 11.0011 - accuracy10: 0.5740 - accuracy20: 0.5661 - accuracy30: 0.5542 - accuracy50: 0.5331 - val_loss: 11.4323 - val_accuracy10: 0.6063 - val_accuracy20: 0.5781 - val_accuracy30: 0.5545 - val_accuracy50: 0.5109 - 15s/epoch - 23ms/step
Epoch 16/50
641/641 - 14s - loss: 10.9577 - accuracy10: 0.5783 - accuracy20: 0.5690 - accuracy30: 0.5555 - accuracy50: 0.5340 - val_loss: 11.4412 - val_accuracy10: 0.6049 - val_accuracy20: 0.5754 - val_accuracy30: 0.5506 - val_accuracy50: 0.5093 - 14s/epoch - 22ms/step
Epoch 17/50
641/641 - 15s - loss: 10.9177 - accuracy10: 0.5817 - accuracy20: 0.5710 - accuracy30: 0.5589 - accuracy50: 0.5370 - val_loss: 11.5636 - val_accuracy10: 0.6064 - val_accuracy20: 0.5769 - val_accuracy30: 0.5509 - val_accuracy50: 0.5081 - 15s/epoch - 23ms/step
testing model: results/QRTEA/W3/deepLOB_L1/seq2seq
Evaluating performance on  test set...
1443/1443 - 14s - 14s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.98256475
{'0': {'precision': 0.2540846867180217, 'recall': 0.6062042727538777, 'f1-score': 0.35808252804812696, 'support': 34170}, '1': {'precision': 0.9305602095835745, 'recall': 0.4046334654626015, 'f1-score': 0.5640167557150605, 'support': 301977}, '2': {'precision': 0.16236152926662448, 'recall': 0.7667693050775826, 'f1-score': 0.26797913138890206, 'support': 33126}, 'accuracy': 0.45577120450181846, 'macro avg': {'precision': 0.4490021418560736, 'recall': 0.5925356810980206, 'f1-score': 0.39669280505069643, 'support': 369273}, 'weighted avg': {'precision': 0.7990517643398247, 'recall': 0.45577120450181846, 'f1-score': 0.5184046614032439, 'support': 369273}}
[[ 20714   5916   7540]
 [ 56286 122190 123501]
 [  4524   3202  25400]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.97728384
{'0': {'precision': 0.32579348338586, 'recall': 0.5686533547017802, 'f1-score': 0.4142528082796921, 'support': 46174}, '1': {'precision': 0.8887191338875791, 'recall': 0.4121292113818799, 'f1-score': 0.5631203931203931, 'support': 278056}, '2': {'precision': 0.21563214073308917, 'recall': 0.7646915169948716, 'f1-score': 0.3364033245758821, 'support': 45043}, 'accuracy': 0.47470570553492947, 'macro avg': {'precision': 0.4767149193355094, 'recall': 0.5818246943595106, 'f1-score': 0.43792550865865576, 'support': 369273}, 'weighted avg': {'precision': 0.7362292783635519, 'recall': 0.47470570553492947, 'f1-score': 0.5168515655026552, 'support': 369273}}
[[ 26257   9230  10687]
 [ 48857 114595 114604]
 [  5480   5119  34444]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9773316
{'0': {'precision': 0.3701970286297265, 'recall': 0.5248323118367052, 'f1-score': 0.4341564093743924, 'support': 55311}, '1': {'precision': 0.8460065433457895, 'recall': 0.41973129012281574, 'f1-score': 0.5610884157863479, 'support': 259983}, '2': {'precision': 0.25126025501630916, 'recall': 0.7534782044869301, 'f1-score': 0.3768525510653182, 'support': 53979}, 'accuracy': 0.4842596128067852, 'macro avg': {'precision': 0.4891546089972751, 'recall': 0.5660139354821504, 'f1-score': 0.4573657920753529, 'support': 369273}, 'weighted avg': {'precision': 0.687800257031336, 'recall': 0.4842596128067852, 'f1-score': 0.5151451598525859, 'support': 369273}}
[[ 29029  12719  13563]
 [ 43223 109123 107637]
 [  6163   7144  40672]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.98575777
{'0': {'precision': 0.4250481747136281, 'recall': 0.45129436503651504, 'f1-score': 0.437778237199366, 'support': 70382}, '1': {'precision': 0.7625564831125067, 'recall': 0.43257838737286625, 'f1-score': 0.5520137716533468, 'support': 230171}, '2': {'precision': 0.3018264979417594, 'recall': 0.720197904540163, 'f1-score': 0.4253808633619115, 'support': 68720}, 'accuracy': 0.4896702439658464, 'macro avg': {'precision': 0.4964770519226314, 'recall': 0.5346902189831814, 'f1-score': 0.47172429073820804, 'support': 369273}, 'weighted avg': {'precision': 0.6124889874042809, 'recall': 0.4896702439658464, 'f1-score': 0.5066751228928701, 'support': 369273}}
[[31763 19405 19214]
 [35335 99567 95269]
 [ 7630 11598 49492]]
Evaluating performance on  train set...
641/641 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9326069
{'0': {'precision': 0.3486496895007943, 'recall': 0.5216999819917162, 'f1-score': 0.4179711734068185, 'support': 27765}, '1': {'precision': 0.827661749671389, 'recall': 0.5173405391588538, 'f1-score': 0.6367022262669161, 'support': 109541}, '2': {'precision': 0.29149632808598014, 'recall': 0.5886659942470769, 'f1-score': 0.3899143861038254, 'support': 26769}, 'accuracy': 0.5297150693280512, 'macro avg': {'precision': 0.4892692557527211, 'recall': 0.5425688384658823, 'f1-score': 0.4815292619258533, 'support': 164075}, 'weighted avg': {'precision': 0.6591267381153544, 'recall': 0.5297150693280512, 'f1-score': 0.5594245704632508, 'support': 164075}}
[[14485  7307  5973]
 [20543 56670 32328]
 [ 6518  4493 15758]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9488265
{'0': {'precision': 0.41855548453709623, 'recall': 0.47758765778401124, 'f1-score': 0.4461272403312022, 'support': 35650}, '1': {'precision': 0.7464753009981052, 'recall': 0.5330080642583972, 'f1-score': 0.6219343932180638, 'support': 93871}, '2': {'precision': 0.35841759801312756, 'recall': 0.5847079932858714, 'f1-score': 0.4444151159209889, 'support': 34554}, 'accuracy': 0.5318543349078165, 'macro avg': {'precision': 0.5078161278494431, 'recall': 0.5317679051094266, 'f1-score': 0.504158916490085, 'support': 164075}, 'weighted avg': {'precision': 0.5935008239249504, 'recall': 0.5318543349078165, 'f1-score': 0.5463498976633495, 'support': 164075}}
[[17026 10236  8388]
 [16059 50034 27778]
 [ 7593  6757 20204]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9665806
{'0': {'precision': 0.4519316701989122, 'recall': 0.43393728393850983, 'f1-score': 0.44275171982489053, 'support': 40787}, '1': {'precision': 0.6785597088392351, 'recall': 0.5443124304533544, 'f1-score': 0.6040672159554903, 'support': 83577}, '2': {'precision': 0.3935890789701054, 'recall': 0.5735690362871748, 'f1-score': 0.46683268259189803, 'support': 39711}, 'accuracy': 0.5239555081517598, 'macro avg': {'precision': 0.5080268193360843, 'recall': 0.517272916893013, 'f1-score': 0.5045505394574262, 'support': 164075}, 'weighted avg': {'precision': 0.5532514870214331, 'recall': 0.5239555081517598, 'f1-score': 0.5307513805443649, 'support': 164075}}
[[17699 12757 10331]
 [13323 45492 24762]
 [ 8141  8793 22777]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.99863267
{'0': {'precision': 0.48682412115247936, 'recall': 0.3711600183402109, 'f1-score': 0.4211957807104678, 'support': 47982}, '1': {'precision': 0.5736719943589141, 'recall': 0.5661616527727438, 'f1-score': 0.5698920808189891, 'support': 68975}, '2': {'precision': 0.4345601723296478, 'recall': 0.5480283543444119, 'f1-score': 0.4847426763908052, 'support': 47118}, 'accuracy': 0.503928081669968, 'macro avg': {'precision': 0.49835209594701374, 'recall': 0.49511667515245544, 'f1-score': 0.49194351264008734, 'support': 164075}, 'weighted avg': {'precision': 0.5083250159492471, 'recall': 0.503928081669968, 'f1-score': 0.5019547624605907, 'support': 164075}}
[[17809 16724 13449]
 [ 9774 39051 20150]
 [ 8999 12297 25822]]
Evaluating performance on  val set...
274/274 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8771007
{'0': {'precision': 0.3557753379911079, 'recall': 0.3982732351447435, 'f1-score': 0.3758267037285536, 'support': 9845}, '1': {'precision': 0.8176948751076658, 'recall': 0.6026981450252951, 'f1-score': 0.6939251002204279, 'support': 50405}, '2': {'precision': 0.2803772381429678, 'recall': 0.6233792544570502, 'f1-score': 0.386788598724113, 'support': 9872}, 'accuracy': 0.5769088160634323, 'macro avg': {'precision': 0.4846158170805805, 'recall': 0.541450211542363, 'f1-score': 0.48551346755769814, 'support': 70122}, 'weighted avg': {'precision': 0.6771969207562781, 'recall': 0.5769088160634323, 'f1-score': 0.6060250081489792, 'support': 70122}}
[[ 3921  4072  1852]
 [ 6083 30379 13943]
 [ 1017  2701  6154]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.91370773
{'0': {'precision': 0.42500223074863924, 'recall': 0.36582181259600616, 'f1-score': 0.393197672018822, 'support': 13020}, '1': {'precision': 0.7323738636051526, 'recall': 0.6065741583257507, 'f1-score': 0.6635643096218692, 'support': 43960}, '2': {'precision': 0.3476850617613081, 'recall': 0.5954192664739004, 'f1-score': 0.43901481149012567, 'support': 13142}, 'accuracy': 0.5597815236302445, 'macro avg': {'precision': 0.5016870520383666, 'recall': 0.5226050791318858, 'f1-score': 0.49859226437693893, 'support': 70122}, 'weighted avg': {'precision': 0.6032052875003122, 'recall': 0.5597815236302445, 'f1-score': 0.5712793901096042, 'support': 70122}}
[[ 4763  5690  2567]
 [ 5181 26665 12114]
 [ 1263  4054  7825]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9427364
{'0': {'precision': 0.46796939810120747, 'recall': 0.33535900653940154, 'f1-score': 0.39071879328921033, 'support': 15139}, '1': {'precision': 0.6650082462891699, 'recall': 0.6118768810541491, 'f1-score': 0.6373371619752631, 'support': 39539}, '2': {'precision': 0.3877167693181322, 'recall': 0.5747215747215747, 'f1-score': 0.46305136030466654, 'support': 15444}, 'accuracy': 0.5439947520036508, 'macro avg': {'precision': 0.5068981379028366, 'recall': 0.5073191541050418, 'f1-score': 0.49703577185638004, 'support': 70122}, 'weighted avg': {'precision': 0.5613965310919669, 'recall': 0.5439947520036508, 'f1-score': 0.5457079242960918, 'support': 70122}}
[[ 5077  6993  3069]
 [ 4398 24193 10948]
 [ 1374  5194  8876]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.99119616
{'0': {'precision': 0.5132463424278371, 'recall': 0.28385544803455254, 'f1-score': 0.3655437040166156, 'support': 18291}, '1': {'precision': 0.558336280297054, 'recall': 0.621085121191031, 'f1-score': 0.588041485216594, 'support': 33047}, '2': {'precision': 0.4310604431060443, 'recall': 0.5334327086882453, 'f1-score': 0.47681362868495564, 'support': 18784}, 'accuracy': 0.5096403411197628, 'macro avg': {'precision': 0.5008810219436451, 'recall': 0.4794577593046096, 'f1-score': 0.47679960597272175, 'support': 70122}, 'weighted avg': {'precision': 0.5124806375692115, 'recall': 0.5096403411197628, 'f1-score': 0.500208694180698, 'support': 70122}}
[[ 5192  9078  4021]
 [ 3318 20525  9204]
 [ 1606  7158 10020]]
training model: results/QRTEA/W3/deepOF_L1/seq2seq
Epoch 1/50
641/641 - 19s - loss: 12.7227 - accuracy10: 0.4424 - accuracy20: 0.4451 - accuracy30: 0.4411 - accuracy50: 0.4311 - val_loss: 12.0868 - val_accuracy10: 0.6341 - val_accuracy20: 0.5905 - val_accuracy30: 0.5528 - val_accuracy50: 0.4860 - 19s/epoch - 30ms/step
Epoch 2/50
641/641 - 13s - loss: 12.5946 - accuracy10: 0.4525 - accuracy20: 0.4481 - accuracy30: 0.4405 - accuracy50: 0.4326 - val_loss: 11.8811 - val_accuracy10: 0.6276 - val_accuracy20: 0.5883 - val_accuracy30: 0.5546 - val_accuracy50: 0.4960 - 13s/epoch - 20ms/step
Epoch 3/50
641/641 - 13s - loss: 12.5128 - accuracy10: 0.4606 - accuracy20: 0.4532 - accuracy30: 0.4455 - accuracy50: 0.4353 - val_loss: 11.8029 - val_accuracy10: 0.6401 - val_accuracy20: 0.6020 - val_accuracy30: 0.5677 - val_accuracy50: 0.5041 - 13s/epoch - 21ms/step
Epoch 4/50
641/641 - 13s - loss: 12.4656 - accuracy10: 0.4720 - accuracy20: 0.4615 - accuracy30: 0.4515 - accuracy50: 0.4390 - val_loss: 11.6558 - val_accuracy10: 0.6402 - val_accuracy20: 0.6049 - val_accuracy30: 0.5719 - val_accuracy50: 0.5103 - 13s/epoch - 20ms/step
Epoch 5/50
641/641 - 14s - loss: 12.4158 - accuracy10: 0.4829 - accuracy20: 0.4741 - accuracy30: 0.4635 - accuracy50: 0.4465 - val_loss: 11.6010 - val_accuracy10: 0.6393 - val_accuracy20: 0.6058 - val_accuracy30: 0.5738 - val_accuracy50: 0.5131 - 14s/epoch - 22ms/step
Epoch 6/50
641/641 - 14s - loss: 12.3555 - accuracy10: 0.5012 - accuracy20: 0.4851 - accuracy30: 0.4705 - accuracy50: 0.4513 - val_loss: 11.6151 - val_accuracy10: 0.6462 - val_accuracy20: 0.6105 - val_accuracy30: 0.5779 - val_accuracy50: 0.5163 - 14s/epoch - 21ms/step
Epoch 7/50
641/641 - 13s - loss: 12.2938 - accuracy10: 0.5141 - accuracy20: 0.4983 - accuracy30: 0.4821 - accuracy50: 0.4592 - val_loss: 11.5906 - val_accuracy10: 0.6435 - val_accuracy20: 0.6084 - val_accuracy30: 0.5754 - val_accuracy50: 0.5155 - 13s/epoch - 20ms/step
Epoch 8/50
641/641 - 15s - loss: 12.2308 - accuracy10: 0.5173 - accuracy20: 0.5058 - accuracy30: 0.4919 - accuracy50: 0.4677 - val_loss: 11.5439 - val_accuracy10: 0.6460 - val_accuracy20: 0.6111 - val_accuracy30: 0.5796 - val_accuracy50: 0.5186 - 15s/epoch - 24ms/step
Epoch 9/50
641/641 - 13s - loss: 12.1681 - accuracy10: 0.5183 - accuracy20: 0.5087 - accuracy30: 0.4963 - accuracy50: 0.4732 - val_loss: 11.5172 - val_accuracy10: 0.6418 - val_accuracy20: 0.6101 - val_accuracy30: 0.5788 - val_accuracy50: 0.5205 - 13s/epoch - 20ms/step
Epoch 10/50
641/641 - 13s - loss: 12.1098 - accuracy10: 0.5213 - accuracy20: 0.5111 - accuracy30: 0.4987 - accuracy50: 0.4763 - val_loss: 11.5081 - val_accuracy10: 0.6525 - val_accuracy20: 0.6158 - val_accuracy30: 0.5826 - val_accuracy50: 0.5235 - 13s/epoch - 20ms/step
Epoch 11/50
641/641 - 15s - loss: 12.0701 - accuracy10: 0.5228 - accuracy20: 0.5132 - accuracy30: 0.5006 - accuracy50: 0.4774 - val_loss: 11.4664 - val_accuracy10: 0.6476 - val_accuracy20: 0.6128 - val_accuracy30: 0.5810 - val_accuracy50: 0.5219 - 15s/epoch - 23ms/step
Epoch 12/50
641/641 - 13s - loss: 12.0222 - accuracy10: 0.5258 - accuracy20: 0.5158 - accuracy30: 0.5029 - accuracy50: 0.4816 - val_loss: 11.4899 - val_accuracy10: 0.6516 - val_accuracy20: 0.6141 - val_accuracy30: 0.5800 - val_accuracy50: 0.5221 - 13s/epoch - 20ms/step
Epoch 13/50
641/641 - 15s - loss: 11.9706 - accuracy10: 0.5226 - accuracy20: 0.5146 - accuracy30: 0.5045 - accuracy50: 0.4847 - val_loss: 11.4373 - val_accuracy10: 0.6524 - val_accuracy20: 0.6147 - val_accuracy30: 0.5816 - val_accuracy50: 0.5239 - 15s/epoch - 23ms/step
Epoch 14/50
641/641 - 14s - loss: 11.9246 - accuracy10: 0.5278 - accuracy20: 0.5190 - accuracy30: 0.5079 - accuracy50: 0.4877 - val_loss: 11.3990 - val_accuracy10: 0.6356 - val_accuracy20: 0.6040 - val_accuracy30: 0.5735 - val_accuracy50: 0.5206 - 14s/epoch - 22ms/step
Epoch 15/50
641/641 - 14s - loss: 11.8944 - accuracy10: 0.5254 - accuracy20: 0.5178 - accuracy30: 0.5078 - accuracy50: 0.4895 - val_loss: 11.4091 - val_accuracy10: 0.6457 - val_accuracy20: 0.6092 - val_accuracy30: 0.5771 - val_accuracy50: 0.5237 - 14s/epoch - 22ms/step
Epoch 16/50
641/641 - 14s - loss: 11.8535 - accuracy10: 0.5270 - accuracy20: 0.5200 - accuracy30: 0.5107 - accuracy50: 0.4931 - val_loss: 11.3664 - val_accuracy10: 0.6311 - val_accuracy20: 0.5990 - val_accuracy30: 0.5713 - val_accuracy50: 0.5218 - 14s/epoch - 22ms/step
Epoch 17/50
641/641 - 13s - loss: 11.8142 - accuracy10: 0.5292 - accuracy20: 0.5221 - accuracy30: 0.5115 - accuracy50: 0.4945 - val_loss: 11.3923 - val_accuracy10: 0.6426 - val_accuracy20: 0.6062 - val_accuracy30: 0.5758 - val_accuracy50: 0.5241 - 13s/epoch - 21ms/step
Epoch 18/50
641/641 - 13s - loss: 11.7631 - accuracy10: 0.5339 - accuracy20: 0.5276 - accuracy30: 0.5170 - accuracy50: 0.4986 - val_loss: 11.4198 - val_accuracy10: 0.6431 - val_accuracy20: 0.6075 - val_accuracy30: 0.5755 - val_accuracy50: 0.5230 - 13s/epoch - 20ms/step
Epoch 19/50
641/641 - 13s - loss: 11.7319 - accuracy10: 0.5339 - accuracy20: 0.5291 - accuracy30: 0.5187 - accuracy50: 0.5006 - val_loss: 11.3796 - val_accuracy10: 0.6350 - val_accuracy20: 0.6027 - val_accuracy30: 0.5725 - val_accuracy50: 0.5222 - 13s/epoch - 21ms/step
Epoch 20/50
641/641 - 13s - loss: 11.6970 - accuracy10: 0.5358 - accuracy20: 0.5305 - accuracy30: 0.5203 - accuracy50: 0.5032 - val_loss: 11.3742 - val_accuracy10: 0.6345 - val_accuracy20: 0.5979 - val_accuracy30: 0.5692 - val_accuracy50: 0.5219 - 13s/epoch - 21ms/step
Epoch 21/50
641/641 - 14s - loss: 11.6696 - accuracy10: 0.5357 - accuracy20: 0.5314 - accuracy30: 0.5228 - accuracy50: 0.5048 - val_loss: 11.4017 - val_accuracy10: 0.6468 - val_accuracy20: 0.6109 - val_accuracy30: 0.5776 - val_accuracy50: 0.5243 - 14s/epoch - 21ms/step
Epoch 22/50
641/641 - 13s - loss: 11.6411 - accuracy10: 0.5378 - accuracy20: 0.5333 - accuracy30: 0.5244 - accuracy50: 0.5065 - val_loss: 11.3299 - val_accuracy10: 0.6272 - val_accuracy20: 0.5964 - val_accuracy30: 0.5688 - val_accuracy50: 0.5228 - 13s/epoch - 20ms/step
Epoch 23/50
641/641 - 13s - loss: 11.5983 - accuracy10: 0.5377 - accuracy20: 0.5342 - accuracy30: 0.5252 - accuracy50: 0.5091 - val_loss: 11.4177 - val_accuracy10: 0.6456 - val_accuracy20: 0.6076 - val_accuracy30: 0.5758 - val_accuracy50: 0.5243 - 13s/epoch - 20ms/step
Epoch 24/50
641/641 - 13s - loss: 11.5623 - accuracy10: 0.5420 - accuracy20: 0.5383 - accuracy30: 0.5296 - accuracy50: 0.5126 - val_loss: 11.3591 - val_accuracy10: 0.6431 - val_accuracy20: 0.6073 - val_accuracy30: 0.5751 - val_accuracy50: 0.5243 - 13s/epoch - 21ms/step
Epoch 25/50
641/641 - 13s - loss: 11.5453 - accuracy10: 0.5407 - accuracy20: 0.5379 - accuracy30: 0.5304 - accuracy50: 0.5135 - val_loss: 11.3746 - val_accuracy10: 0.6399 - val_accuracy20: 0.6047 - val_accuracy30: 0.5756 - val_accuracy50: 0.5263 - 13s/epoch - 20ms/step
Epoch 26/50
641/641 - 13s - loss: 11.5085 - accuracy10: 0.5427 - accuracy20: 0.5388 - accuracy30: 0.5313 - accuracy50: 0.5151 - val_loss: 11.3807 - val_accuracy10: 0.6428 - val_accuracy20: 0.6059 - val_accuracy30: 0.5746 - val_accuracy50: 0.5253 - 13s/epoch - 20ms/step
Epoch 27/50
641/641 - 13s - loss: 11.4980 - accuracy10: 0.5403 - accuracy20: 0.5388 - accuracy30: 0.5320 - accuracy50: 0.5157 - val_loss: 11.3787 - val_accuracy10: 0.6463 - val_accuracy20: 0.6098 - val_accuracy30: 0.5780 - val_accuracy50: 0.5275 - 13s/epoch - 21ms/step
Epoch 28/50
641/641 - 14s - loss: 11.4620 - accuracy10: 0.5424 - accuracy20: 0.5397 - accuracy30: 0.5329 - accuracy50: 0.5173 - val_loss: 11.3749 - val_accuracy10: 0.6451 - val_accuracy20: 0.6088 - val_accuracy30: 0.5759 - val_accuracy50: 0.5256 - 14s/epoch - 22ms/step
Epoch 29/50
641/641 - 13s - loss: 11.4382 - accuracy10: 0.5464 - accuracy20: 0.5435 - accuracy30: 0.5352 - accuracy50: 0.5192 - val_loss: 11.3830 - val_accuracy10: 0.6399 - val_accuracy20: 0.6043 - val_accuracy30: 0.5737 - val_accuracy50: 0.5250 - 13s/epoch - 20ms/step
Epoch 30/50
641/641 - 12s - loss: 11.3989 - accuracy10: 0.5481 - accuracy20: 0.5461 - accuracy30: 0.5385 - accuracy50: 0.5218 - val_loss: 11.4148 - val_accuracy10: 0.6463 - val_accuracy20: 0.6104 - val_accuracy30: 0.5778 - val_accuracy50: 0.5250 - 12s/epoch - 19ms/step
Epoch 31/50
641/641 - 12s - loss: 11.3626 - accuracy10: 0.5478 - accuracy20: 0.5462 - accuracy30: 0.5388 - accuracy50: 0.5238 - val_loss: 11.4375 - val_accuracy10: 0.6386 - val_accuracy20: 0.6040 - val_accuracy30: 0.5743 - val_accuracy50: 0.5263 - 12s/epoch - 19ms/step
Epoch 32/50
641/641 - 14s - loss: 11.3327 - accuracy10: 0.5490 - accuracy20: 0.5471 - accuracy30: 0.5407 - accuracy50: 0.5256 - val_loss: 11.4852 - val_accuracy10: 0.6391 - val_accuracy20: 0.6024 - val_accuracy30: 0.5718 - val_accuracy50: 0.5241 - 14s/epoch - 21ms/step
testing model: results/QRTEA/W3/deepOF_L1/seq2seq
Evaluating performance on  test set...
1443/1443 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.73989654
{'0': {'precision': 0.2954936103430237, 'recall': 0.46286215978928885, 'f1-score': 0.3607088284261181, 'support': 34170}, '1': {'precision': 0.891305531994366, 'recall': 0.7585967096722919, 'f1-score': 0.8196139465822287, 'support': 301976}, '2': {'precision': 0.24549215916636868, 'recall': 0.43528665881713613, 'f1-score': 0.31393298059964725, 'support': 33123}, 'accuracy': 0.7022306232042224, 'macro avg': {'precision': 0.47743043383458605, 'recall': 0.5522485094262389, 'f1-score': 0.49808525186933145, 'support': 369269}, 'weighted avg': {'precision': 0.7782438622874367, 'recall': 0.7022306232042224, 'f1-score': 0.7317905481284313, 'support': 369269}}
[[ 15816  13529   4825]
 [ 33410 229078  39488]
 [  4298  14407  14418]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7820063
{'0': {'precision': 0.3590531871412578, 'recall': 0.4375933987395231, 'f1-score': 0.39445171114538385, 'support': 46173}, '1': {'precision': 0.8360347671966673, 'recall': 0.7599979860172051, 'f1-score': 0.7962051380592025, 'support': 278056}, '2': {'precision': 0.3065134735758522, 'recall': 0.4098801065719361, 'f1-score': 0.35073953395586543, 'support': 45040}, 'accuracy': 0.676980737619459, 'macro avg': {'precision': 0.5005338093045925, 'recall': 0.5358238304428881, 'f1-score': 0.5137987943868173, 'support': 369269}, 'weighted avg': {'precision': 0.7118074165103656, 'recall': 0.676980737619459, 'f1-score': 0.691636566666245, 'support': 369269}}
[[ 20205  19888   6080]
 [ 31046 211322  35688]
 [  5022  21557  18461]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.82366836
{'0': {'precision': 0.3947064383993278, 'recall': 0.4076658832037606, 'f1-score': 0.40108150414458, 'support': 55310}, '1': {'precision': 0.7869794483504597, 'recall': 0.7611920779435578, 'f1-score': 0.7738709973858483, 'support': 259983}, '2': {'precision': 0.3451111587204799, 'recall': 0.3879687268415592, 'f1-score': 0.3652871658453622, 'support': 53976}, 'accuracy': 0.6536860662552232, 'macro avg': {'precision': 0.5089323484900891, 'recall': 0.5189422293296259, 'f1-score': 0.5134132224585969, 'support': 369269}, 'weighted avg': {'precision': 0.6636360239593928, 'recall': 0.6536860662552232, 'f1-score': 0.6583110457993252, 'support': 369269}}
[[ 22548  25913   6849]
 [ 29197 197897  32889]
 [  5381  27654  20941]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8868562
{'0': {'precision': 0.441218155405166, 'recall': 0.3538597064548671, 'f1-score': 0.3927397163064647, 'support': 70381}, '1': {'precision': 0.6994268328043883, 'recall': 0.7650301950732068, 'f1-score': 0.7307590952194203, 'support': 230170}, '2': {'precision': 0.3911797458404297, 'recall': 0.347609068948456, 'f1-score': 0.3681095991739995, 'support': 68718}, 'accuracy': 0.6089842364238536, 'macro avg': {'precision': 0.5106082446833281, 'recall': 0.4888329901588433, 'f1-score': 0.4972028035666282, 'support': 369269}, 'weighted avg': {'precision': 0.5928511163320498, 'recall': 0.6089842364238536, 'f1-score': 0.5988479681642871, 'support': 369269}}
[[ 24905  37060   8416]
 [ 25322 176087  28761]
 [  6219  38612  23887]]
Evaluating performance on  train set...
641/641 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.87230724
{'0': {'precision': 0.37069089860089427, 'recall': 0.36993054805858433, 'f1-score': 0.37031033302714284, 'support': 27789}, '1': {'precision': 0.7600978013938624, 'recall': 0.7213381323881388, 'f1-score': 0.7402109210217951, 'support': 109466}, '2': {'precision': 0.32944112391398117, 'recall': 0.3987098698683769, 'f1-score': 0.3607807412655837, 'support': 26819}, 'accuracy': 0.6090849250947743, 'macro avg': {'precision': 0.48674327463624595, 'recall': 0.4966595167717, 'f1-score': 0.49043399843817387, 'support': 164074}, 'weighted avg': {'precision': 0.6237507271770655, 'recall': 0.6090849250947743, 'f1-score': 0.6155409219319622, 'support': 164074}}
[[10280 12822  4687]
 [13426 78962 17078]
 [ 4026 12100 10693]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.92067975
{'0': {'precision': 0.4351883156400027, 'recall': 0.3604693494637206, 'f1-score': 0.39432046196026777, 'support': 35709}, '1': {'precision': 0.6704525270864992, 'recall': 0.7242754048032747, 'f1-score': 0.6963254472132122, 'support': 93811}, '2': {'precision': 0.39473366712915486, 'recall': 0.37874052208137987, 'f1-score': 0.3865717492763041, 'support': 34554}, 'accuracy': 0.572327120689445, 'macro avg': {'precision': 0.5001248366185522, 'recall': 0.4878284254494584, 'f1-score': 0.49240588614992803, 'support': 164074}, 'weighted avg': {'precision': 0.5611832997042874, 'recall': 0.572327120689445, 'f1-score': 0.5653630442919125, 'support': 164074}}
[[12872 17007  5830]
 [11629 67945 14237]
 [ 5077 16390 13087]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.95833457
{'0': {'precision': 0.46605365499967044, 'recall': 0.3464657601372045, 'f1-score': 0.39745913964894536, 'support': 40815}, '1': {'precision': 0.6023763085618755, 'recall': 0.7250101803722423, 'f1-score': 0.6580283282423662, 'support': 83494}, '2': {'precision': 0.4299338146811071, 'recall': 0.35938639507104236, 'f1-score': 0.3915074309978769, 'support': 39765}, 'accuracy': 0.5422309445737898, 'macro avg': {'precision': 0.49945459274755105, 'recall': 0.476954111860163, 'f1-score': 0.48233163296306286, 'support': 164074}, 'weighted avg': {'precision': 0.5266715358720517, 'recall': 0.5422309445737898, 'f1-score': 0.528615167647954, 'support': 164074}}
[[14141 20259  6415]
 [10426 60534 12534]
 [ 5775 19699 14291]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0155518
{'0': {'precision': 0.4966416305462727, 'recall': 0.31260413195601466, 'f1-score': 0.3836961106353609, 'support': 48016}, '1': {'precision': 0.4981533329362006, 'recall': 0.7276168102323153, 'f1-score': 0.5914073550212164, 'support': 68958}, '2': {'precision': 0.4691056174348758, 'recall': 0.3299575371549894, 'f1-score': 0.387416021638061, 'support': 47100}, 'accuracy': 0.4920097029389178, 'macro avg': {'precision': 0.487966860305783, 'recall': 0.4567261597811065, 'f1-score': 0.4541731624315461, 'support': 164074}, 'weighted avg': {'precision': 0.48937233593443813, 'recall': 0.4920097029389178, 'f1-score': 0.47206209061139, 'support': 164074}}
[[15010 25581  7425]
 [ 8620 50175 10163]
 [ 6593 24966 15541]]
Evaluating performance on  val set...
274/274 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.84608465
{'0': {'precision': 0.3395485770363101, 'recall': 0.4226814618751909, 'f1-score': 0.37658156092694206, 'support': 9823}, '1': {'precision': 0.8098575472559584, 'recall': 0.7031435820185523, 'f1-score': 0.7527372262773723, 'support': 50452}, '2': {'precision': 0.3108587650816182, 'recall': 0.44480552452523614, 'f1-score': 0.36596064669758116, 'support': 9847}, 'accuracy': 0.627577650380765, 'macro avg': {'precision': 0.48675496312462885, 'recall': 0.5235435228063264, 'f1-score': 0.49842647796729844, 'support': 70122}, 'weighted avg': {'precision': 0.6739018411645986, 'recall': 0.627577650380765, 'f1-score': 0.6457299235783693, 'support': 70122}}
[[ 4152  4186  1485]
 [ 6752 35475  8225]
 [ 1324  4143  4380]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8880332
{'0': {'precision': 0.4034265519360787, 'recall': 0.4045766237768703, 'f1-score': 0.4040007693787267, 'support': 12979}, '1': {'precision': 0.7254943205721498, 'recall': 0.7052528740855183, 'f1-score': 0.7152304147465438, 'support': 44014}, '2': {'precision': 0.3881284916201117, 'recall': 0.42333764947825425, 'f1-score': 0.4049692156362709, 'support': 13129}, 'accuracy': 0.596816976127321, 'macro avg': {'precision': 0.5056831213761134, 'recall': 0.5110557157802144, 'f1-score': 0.5080667999205138, 'support': 70122}, 'weighted avg': {'precision': 0.6027169677094408, 'recall': 0.596816976127321, 'f1-score': 0.5995339307565312, 'support': 70122}}
[[ 5251  5870  1858]
 [ 6069 31041  6904]
 [ 1696  5875  5558]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9244741
{'0': {'precision': 0.43570892723180793, 'recall': 0.38356888125742966, 'f1-score': 0.4079797695982017, 'support': 15142}, '1': {'precision': 0.6582565021575609, 'recall': 0.7053591732571949, 'f1-score': 0.6809943161027492, 'support': 39577}, '2': {'precision': 0.43085587151498295, 'recall': 0.40232422255404793, 'f1-score': 0.4161015242060028, 'support': 15403}, 'accuracy': 0.5693077778728501, 'macro avg': {'precision': 0.5082737669681173, 'recall': 0.49708409235622414, 'f1-score': 0.5016918699689846, 'support': 70122}, 'weighted avg': {'precision': 0.5602492106753815, 'recall': 0.5693077778728501, 'f1-score': 0.563853761971985, 'support': 70122}}
[[ 5808  7228  2106]
 [ 5581 27916  6080]
 [ 1941  7265  6197]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9810999
{'0': {'precision': 0.4747709866346298, 'recall': 0.3459728605821843, 'f1-score': 0.400265873267076, 'support': 18276}, '1': {'precision': 0.5527671284427406, 'recall': 0.7104809697995708, 'f1-score': 0.6217789301021218, 'support': 33079}, '2': {'precision': 0.4772170504654581, 'recall': 0.3632972771353972, 'f1-score': 0.41253706056755607, 'support': 18767}, 'accuracy': 0.5225606799577879, 'macro avg': {'precision': 0.5015850551809428, 'recall': 0.4732503691723841, 'f1-score': 0.4781939546455846, 'support': 70122}, 'weighted avg': {'precision': 0.5122191434867397, 'recall': 0.5225606799577879, 'f1-score': 0.5080455113138316, 'support': 70122}}
[[ 6323  9407  2546]
 [ 4654 23502  4923]
 [ 2341  9608  6818]]
training model: results/QRTEA/W3/deepLOB_L2/seq2seq
Epoch 1/50
641/641 - 38s - loss: 12.4919 - accuracy10: 0.4507 - accuracy20: 0.4551 - accuracy30: 0.4551 - accuracy50: 0.4518 - val_loss: 12.5606 - val_accuracy10: 0.5279 - val_accuracy20: 0.5041 - val_accuracy30: 0.4818 - val_accuracy50: 0.4421 - 38s/epoch - 59ms/step
Epoch 2/50
641/641 - 31s - loss: 12.0946 - accuracy10: 0.4574 - accuracy20: 0.4729 - accuracy30: 0.4767 - accuracy50: 0.4725 - val_loss: 12.1601 - val_accuracy10: 0.5487 - val_accuracy20: 0.5171 - val_accuracy30: 0.4932 - val_accuracy50: 0.4519 - 31s/epoch - 49ms/step
Epoch 3/50
641/641 - 30s - loss: 11.8071 - accuracy10: 0.4963 - accuracy20: 0.5045 - accuracy30: 0.5025 - accuracy50: 0.4933 - val_loss: 11.7336 - val_accuracy10: 0.5740 - val_accuracy20: 0.5451 - val_accuracy30: 0.5198 - val_accuracy50: 0.4779 - 30s/epoch - 47ms/step
Epoch 4/50
641/641 - 30s - loss: 11.6518 - accuracy10: 0.5171 - accuracy20: 0.5211 - accuracy30: 0.5157 - accuracy50: 0.5029 - val_loss: 11.5131 - val_accuracy10: 0.5703 - val_accuracy20: 0.5479 - val_accuracy30: 0.5284 - val_accuracy50: 0.4921 - 30s/epoch - 47ms/step
Epoch 5/50
641/641 - 30s - loss: 11.4972 - accuracy10: 0.5348 - accuracy20: 0.5366 - accuracy30: 0.5298 - accuracy50: 0.5141 - val_loss: 11.4280 - val_accuracy10: 0.5680 - val_accuracy20: 0.5486 - val_accuracy30: 0.5316 - val_accuracy50: 0.5002 - 30s/epoch - 47ms/step
Epoch 6/50
641/641 - 30s - loss: 11.3404 - accuracy10: 0.5472 - accuracy20: 0.5467 - accuracy30: 0.5388 - accuracy50: 0.5208 - val_loss: 11.3150 - val_accuracy10: 0.5543 - val_accuracy20: 0.5416 - val_accuracy30: 0.5281 - val_accuracy50: 0.4998 - 30s/epoch - 47ms/step
Epoch 7/50
641/641 - 30s - loss: 11.1396 - accuracy10: 0.5694 - accuracy20: 0.5655 - accuracy30: 0.5536 - accuracy50: 0.5315 - val_loss: 11.0751 - val_accuracy10: 0.5704 - val_accuracy20: 0.5564 - val_accuracy30: 0.5420 - val_accuracy50: 0.5118 - 30s/epoch - 47ms/step
Epoch 8/50
641/641 - 30s - loss: 10.9699 - accuracy10: 0.5846 - accuracy20: 0.5786 - accuracy30: 0.5648 - accuracy50: 0.5402 - val_loss: 10.9335 - val_accuracy10: 0.5775 - val_accuracy20: 0.5649 - val_accuracy30: 0.5492 - val_accuracy50: 0.5201 - 30s/epoch - 47ms/step
Epoch 9/50
641/641 - 30s - loss: 10.8284 - accuracy10: 0.5970 - accuracy20: 0.5890 - accuracy30: 0.5739 - accuracy50: 0.5465 - val_loss: 10.8225 - val_accuracy10: 0.5929 - val_accuracy20: 0.5752 - val_accuracy30: 0.5572 - val_accuracy50: 0.5255 - 30s/epoch - 47ms/step
Epoch 10/50
641/641 - 30s - loss: 10.7216 - accuracy10: 0.6042 - accuracy20: 0.5958 - accuracy30: 0.5796 - accuracy50: 0.5507 - val_loss: 10.7339 - val_accuracy10: 0.5989 - val_accuracy20: 0.5811 - val_accuracy30: 0.5637 - val_accuracy50: 0.5303 - 30s/epoch - 47ms/step
Epoch 11/50
641/641 - 30s - loss: 10.6349 - accuracy10: 0.6106 - accuracy20: 0.6016 - accuracy30: 0.5844 - accuracy50: 0.5546 - val_loss: 10.6304 - val_accuracy10: 0.6051 - val_accuracy20: 0.5829 - val_accuracy30: 0.5630 - val_accuracy50: 0.5285 - 30s/epoch - 47ms/step
Epoch 12/50
641/641 - 32s - loss: 10.5715 - accuracy10: 0.6142 - accuracy20: 0.6051 - accuracy30: 0.5872 - accuracy50: 0.5562 - val_loss: 10.6336 - val_accuracy10: 0.5933 - val_accuracy20: 0.5751 - val_accuracy30: 0.5580 - val_accuracy50: 0.5267 - 32s/epoch - 50ms/step
Epoch 13/50
641/641 - 31s - loss: 10.4974 - accuracy10: 0.6151 - accuracy20: 0.6063 - accuracy30: 0.5886 - accuracy50: 0.5590 - val_loss: 10.5143 - val_accuracy10: 0.6093 - val_accuracy20: 0.5880 - val_accuracy30: 0.5671 - val_accuracy50: 0.5314 - 31s/epoch - 48ms/step
Epoch 14/50
641/641 - 31s - loss: 10.4487 - accuracy10: 0.6196 - accuracy20: 0.6106 - accuracy30: 0.5930 - accuracy50: 0.5627 - val_loss: 10.5470 - val_accuracy10: 0.6125 - val_accuracy20: 0.5917 - val_accuracy30: 0.5714 - val_accuracy50: 0.5362 - 31s/epoch - 48ms/step
Epoch 15/50
641/641 - 32s - loss: 10.4012 - accuracy10: 0.6195 - accuracy20: 0.6119 - accuracy30: 0.5937 - accuracy50: 0.5632 - val_loss: 10.5700 - val_accuracy10: 0.6077 - val_accuracy20: 0.5898 - val_accuracy30: 0.5692 - val_accuracy50: 0.5342 - 32s/epoch - 49ms/step
Epoch 16/50
641/641 - 30s - loss: 10.3612 - accuracy10: 0.6201 - accuracy20: 0.6130 - accuracy30: 0.5956 - accuracy50: 0.5652 - val_loss: 10.5719 - val_accuracy10: 0.5898 - val_accuracy20: 0.5744 - val_accuracy30: 0.5563 - val_accuracy50: 0.5256 - 30s/epoch - 47ms/step
Epoch 17/50
641/641 - 31s - loss: 10.3056 - accuracy10: 0.6230 - accuracy20: 0.6151 - accuracy30: 0.5964 - accuracy50: 0.5654 - val_loss: 10.5013 - val_accuracy10: 0.5946 - val_accuracy20: 0.5779 - val_accuracy30: 0.5613 - val_accuracy50: 0.5311 - 31s/epoch - 48ms/step
Epoch 18/50
641/641 - 32s - loss: 10.2638 - accuracy10: 0.6229 - accuracy20: 0.6157 - accuracy30: 0.5988 - accuracy50: 0.5694 - val_loss: 10.5413 - val_accuracy10: 0.5818 - val_accuracy20: 0.5696 - val_accuracy30: 0.5528 - val_accuracy50: 0.5258 - 32s/epoch - 49ms/step
Epoch 19/50
641/641 - 31s - loss: 10.2061 - accuracy10: 0.6234 - accuracy20: 0.6177 - accuracy30: 0.6015 - accuracy50: 0.5718 - val_loss: 10.5394 - val_accuracy10: 0.5941 - val_accuracy20: 0.5781 - val_accuracy30: 0.5590 - val_accuracy50: 0.5273 - 31s/epoch - 48ms/step
Epoch 20/50
641/641 - 32s - loss: 10.1627 - accuracy10: 0.6253 - accuracy20: 0.6196 - accuracy30: 0.6032 - accuracy50: 0.5739 - val_loss: 10.6105 - val_accuracy10: 0.5798 - val_accuracy20: 0.5662 - val_accuracy30: 0.5489 - val_accuracy50: 0.5209 - 32s/epoch - 49ms/step
Epoch 21/50
641/641 - 32s - loss: 10.1235 - accuracy10: 0.6260 - accuracy20: 0.6214 - accuracy30: 0.6048 - accuracy50: 0.5752 - val_loss: 10.6523 - val_accuracy10: 0.5702 - val_accuracy20: 0.5603 - val_accuracy30: 0.5448 - val_accuracy50: 0.5211 - 32s/epoch - 50ms/step
Epoch 22/50
641/641 - 31s - loss: 10.0700 - accuracy10: 0.6278 - accuracy20: 0.6240 - accuracy30: 0.6075 - accuracy50: 0.5785 - val_loss: 10.6433 - val_accuracy10: 0.5710 - val_accuracy20: 0.5607 - val_accuracy30: 0.5453 - val_accuracy50: 0.5208 - 31s/epoch - 48ms/step
Epoch 23/50
641/641 - 30s - loss: 10.0279 - accuracy10: 0.6280 - accuracy20: 0.6239 - accuracy30: 0.6081 - accuracy50: 0.5803 - val_loss: 10.7581 - val_accuracy10: 0.5603 - val_accuracy20: 0.5502 - val_accuracy30: 0.5366 - val_accuracy50: 0.5165 - 30s/epoch - 47ms/step
Epoch 24/50
641/641 - 32s - loss: 9.9895 - accuracy10: 0.6288 - accuracy20: 0.6256 - accuracy30: 0.6111 - accuracy50: 0.5823 - val_loss: 10.7890 - val_accuracy10: 0.5632 - val_accuracy20: 0.5522 - val_accuracy30: 0.5355 - val_accuracy50: 0.5113 - 32s/epoch - 49ms/step
Epoch 25/50
641/641 - 31s - loss: 9.9364 - accuracy10: 0.6296 - accuracy20: 0.6281 - accuracy30: 0.6141 - accuracy50: 0.5852 - val_loss: 10.7757 - val_accuracy10: 0.5628 - val_accuracy20: 0.5558 - val_accuracy30: 0.5399 - val_accuracy50: 0.5144 - 31s/epoch - 48ms/step
Epoch 26/50
641/641 - 31s - loss: 9.8992 - accuracy10: 0.6297 - accuracy20: 0.6279 - accuracy30: 0.6131 - accuracy50: 0.5866 - val_loss: 10.7726 - val_accuracy10: 0.5686 - val_accuracy20: 0.5557 - val_accuracy30: 0.5390 - val_accuracy50: 0.5153 - 31s/epoch - 48ms/step
Epoch 27/50
641/641 - 33s - loss: 9.8634 - accuracy10: 0.6321 - accuracy20: 0.6303 - accuracy30: 0.6169 - accuracy50: 0.5895 - val_loss: 10.8059 - val_accuracy10: 0.5661 - val_accuracy20: 0.5550 - val_accuracy30: 0.5402 - val_accuracy50: 0.5151 - 33s/epoch - 51ms/step
testing model: results/QRTEA/W3/deepLOB_L2/seq2seq
Evaluating performance on  test set...
1443/1443 - 25s - 25s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7839784
{'0': {'precision': 0.3189795015484442, 'recall': 0.569710272168569, 'f1-score': 0.4089748841899599, 'support': 34170}, '1': {'precision': 0.93299754528484, 'recall': 0.6305844484844872, 'f1-score': 0.7525460703375395, 'support': 301977}, '2': {'precision': 0.22225316139687173, 'recall': 0.6987562639618426, 'f1-score': 0.33724038958862995, 'support': 33126}, 'accuracy': 0.6310669883798707, 'macro avg': {'precision': 0.491410069410052, 'recall': 0.633016994871633, 'f1-score': 0.4995871147053765, 'support': 369273}, 'weighted avg': {'precision': 0.8124224828915824, 'recall': 0.6310669883798707, 'f1-score': 0.6834989333652962, 'support': 369273}}
[[ 19467   7923   6780]
 [ 37335 190422  74220]
 [  4227   5752  23147]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8202777
{'0': {'precision': 0.3881631315259634, 'recall': 0.5386148048685407, 'f1-score': 0.45117692412354304, 'support': 46174}, '1': {'precision': 0.8910548111291313, 'recall': 0.6105604626406191, 'f1-score': 0.7246101544443566, 'support': 278056}, '2': {'precision': 0.27349465881839985, 'recall': 0.6962902115756056, 'f1-score': 0.39272968607170144, 'support': 45043}, 'accuracy': 0.6120214583790312, 'macro avg': {'precision': 0.5175708671578315, 'recall': 0.6151551596949217, 'f1-score': 0.5228389215465338, 'support': 369273}, 'weighted avg': {'precision': 0.7528446458732666, 'recall': 0.6120214583790312, 'f1-score': 0.6499380340517399, 'support': 369273}}
[[ 24870  11931   9373]
 [ 34347 169770  73939]
 [  4854   8826  31363]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8607445
{'0': {'precision': 0.4232360774636231, 'recall': 0.5085245249588689, 'f1-score': 0.4619768740555811, 'support': 55311}, '1': {'precision': 0.8496627856256082, 'recall': 0.5844035956197136, 'f1-score': 0.6925007007732434, 'support': 259983}, '2': {'precision': 0.29993225697188663, 'recall': 0.6889901628411049, 'f1-score': 0.4179304067379493, 'support': 53979}, 'accuracy': 0.5883262518516111, 'macro avg': {'precision': 0.5242770400203726, 'recall': 0.5939727611398958, 'f1-score': 0.5241359938555913, 'support': 369273}, 'weighted avg': {'precision': 0.7054334705623708, 'recall': 0.5883262518516111, 'f1-score': 0.6178363378728642, 'support': 369273}}
[[ 28127  15491  11693]
 [ 32934 151935  75114]
 [  5396  11392  37191]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.91061264
{'0': {'precision': 0.46027210489672776, 'recall': 0.45086811968969337, 'f1-score': 0.45552158247563274, 'support': 70382}, '1': {'precision': 0.7690625952009749, 'recall': 0.5593580424988378, 'f1-score': 0.6476583329141304, 'support': 230171}, '2': {'precision': 0.33853445681613, 'recall': 0.654802095459837, 'f1-score': 0.446320174568538, 'support': 68720}, 'accuracy': 0.5564419819483146, 'macro avg': {'precision': 0.5226230523046108, 'recall': 0.5550094192161227, 'f1-score': 0.5165000299861005, 'support': 369273}, 'weighted avg': {'precision': 0.6300890283320187, 'recall': 0.5564419819483146, 'f1-score': 0.5735697128122778, 'support': 369273}}
[[ 31733  21976  16673]
 [ 30174 128748  71249]
 [  7037  16685  44998]]
Evaluating performance on  train set...
641/641 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.88400483
{'0': {'precision': 0.38183531498572654, 'recall': 0.49620025211597335, 'f1-score': 0.43156971462581833, 'support': 27765}, '1': {'precision': 0.8656737468618657, 'recall': 0.5603198802274947, 'f1-score': 0.6803034753357015, 'support': 109541}, '2': {'precision': 0.3247215021369018, 'recall': 0.6925548208748926, 'f1-score': 0.44213639236355395, 'support': 26769}, 'accuracy': 0.5710437300015236, 'macro avg': {'precision': 0.5240768546614981, 'recall': 0.5830249844061203, 'f1-score': 0.5180031941083579, 'support': 164075}, 'weighted avg': {'precision': 0.6955410349917845, 'recall': 0.5710437300015236, 'f1-score': 0.5993552046656339, 'support': 164075}}
[[13777  5683  8305]
 [17915 61378 30248]
 [ 4389  3841 18539]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.89509076
{'0': {'precision': 0.4511689340906089, 'recall': 0.4790743338008415, 'f1-score': 0.46470308142303246, 'support': 35650}, '1': {'precision': 0.794881818728574, 'recall': 0.5631771260559705, 'f1-score': 0.659263369892567, 'support': 93871}, '2': {'precision': 0.3884478831725616, 'recall': 0.6712681599814783, 'f1-score': 0.4921180489253814, 'support': 34554}, 'accuracy': 0.5676672253542587, 'macro avg': {'precision': 0.5448328786639148, 'recall': 0.5711732066127634, 'f1-score': 0.5386948334136602, 'support': 164075}, 'weighted avg': {'precision': 0.6346058318533895, 'recall': 0.5676672253542587, 'f1-score': 0.581788960600237, 'support': 164075}}
[[17079  7990 10581]
 [15069 52866 25936]
 [ 5707  5652 23195]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.916264
{'0': {'precision': 0.4798993058204287, 'recall': 0.4627209650133621, 'f1-score': 0.4711536061112914, 'support': 40787}, '1': {'precision': 0.7350696643445218, 'recall': 0.555499718822164, 'f1-score': 0.6327920020172144, 'support': 83577}, '2': {'precision': 0.4201467818406183, 'recall': 0.6516078668379038, 'f1-score': 0.5108836217534231, 'support': 39711}, 'accuracy': 0.5556970897455432, 'macro avg': {'precision': 0.5450385840018562, 'recall': 0.5566095168911432, 'f1-score': 0.538276409960643, 'support': 164075}, 'weighted avg': {'precision': 0.595416847033934, 'recall': 0.5556970897455432, 'f1-score': 0.5631052798324191, 'support': 164075}}
[[18873  9693 12221]
 [13659 46427 23491]
 [ 6795  7040 25876]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9520645
{'0': {'precision': 0.5042884175861985, 'recall': 0.4276603726397399, 'f1-score': 0.46282408399400043, 'support': 47982}, '1': {'precision': 0.6325613033812257, 'recall': 0.5527654947444727, 'f1-score': 0.5899774853190355, 'support': 68975}, '2': {'precision': 0.45650451592457614, 'recall': 0.6114436096608514, 'f1-score': 0.522734695358711, 'support': 47118}, 'accuracy': 0.5330306262380009, 'macro avg': {'precision': 0.5311180789640001, 'recall': 0.5306231590150213, 'f1-score': 0.5251787548905823, 'support': 164075}, 'weighted avg': {'precision': 0.5444904009427103, 'recall': 0.5330306262380009, 'f1-score': 0.5334824660916797, 'support': 164075}}
[[20520 12497 14965]
 [11513 38127 19335]
 [ 8658  9650 28810]]
Evaluating performance on  val set...
274/274 - 5s - 5s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.85177016
{'0': {'precision': 0.35892002734108, 'recall': 0.5333671914677501, 'f1-score': 0.4290909090909091, 'support': 9845}, '1': {'precision': 0.8695375906189527, 'recall': 0.5972820156730483, 'f1-score': 0.708143199887096, 'support': 50405}, '2': {'precision': 0.30102065264267575, 'recall': 0.6363452188006483, 'f1-score': 0.4087049868254123, 'support': 9872}, 'accuracy': 0.5938079347423063, 'macro avg': {'precision': 0.5098260902009027, 'recall': 0.5889981419804822, 'f1-score': 0.5153130319344724, 'support': 70122}, 'weighted avg': {'precision': 0.7178101852087753, 'recall': 0.5938079347423063, 'f1-score': 0.6268088990651941, 'support': 70122}}
[[ 5251  2530  2064]
 [ 7776 30106 12523]
 [ 1603  1987  6282]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.88022166
{'0': {'precision': 0.42556906363166064, 'recall': 0.5054531490015362, 'f1-score': 0.46208397696952674, 'support': 13020}, '1': {'precision': 0.7942651447558687, 'recall': 0.5872611464968153, 'f1-score': 0.6752546983508364, 'support': 43960}, '2': {'precision': 0.36917174452719476, 'recall': 0.6223558058134226, 'f1-score': 0.4634388191631017, 'support': 13142}, 'accuracy': 0.5786486409400758, 'macro avg': {'precision': 0.5296686509715747, 'recall': 0.5716900337705914, 'f1-score': 0.533592498161155, 'support': 70122}, 'weighted avg': {'precision': 0.6461375893233023, 'recall': 0.5786486409400758, 'f1-score': 0.5959761969294586, 'support': 70122}}
[[ 6581  3730  2709]
 [ 6877 25816 11267]
 [ 2006  2957  8179]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.91130936
{'0': {'precision': 0.46124586892810376, 'recall': 0.4886055882158663, 'f1-score': 0.47453169104439313, 'support': 15139}, '1': {'precision': 0.7320392754139797, 'recall': 0.5713346316295304, 'f1-score': 0.6417795960112503, 'support': 39539}, '2': {'precision': 0.4036424696460863, 'recall': 0.607031857031857, 'f1-score': 0.48487199379363854, 'support': 15444}, 'accuracy': 0.561335957331508, 'macro avg': {'precision': 0.5323092046627232, 'recall': 0.5556573589590846, 'f1-score': 0.533727760283094, 'support': 70122}, 'weighted avg': {'precision': 0.6012486298381402, 'recall': 0.561335957331508, 'f1-score': 0.5711135134416995, 'support': 70122}}
[[ 7397  4510  3232]
 [ 6330 22590 10619]
 [ 2310  3759  9375]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9600638
{'0': {'precision': 0.49363482056256064, 'recall': 0.44519162429610193, 'f1-score': 0.46816339437146065, 'support': 18291}, '1': {'precision': 0.6237428649089426, 'recall': 0.5555118467637001, 'f1-score': 0.587653451559724, 'support': 33047}, '2': {'precision': 0.4408117715135984, 'recall': 0.5677704429301533, 'f1-score': 0.4963004327795616, 'support': 18784}, 'accuracy': 0.5300191095519238, 'macro avg': {'precision': 0.5193964856617005, 'recall': 0.5228246379966518, 'f1-score': 0.5173724262369155, 'support': 70122}, 'weighted avg': {'precision': 0.5408019348516451, 'recall': 0.5300191095519238, 'f1-score': 0.5320137416142419, 'support': 70122}}
[[ 8143  5873  4275]
 [ 5435 18358  9254]
 [ 2918  5201 10665]]
training model: results/QRTEA/W3/deepOF_L2/seq2seq
Epoch 1/50
641/641 - 24s - loss: 12.0877 - accuracy10: 0.4999 - accuracy20: 0.4985 - accuracy30: 0.4899 - accuracy50: 0.4702 - val_loss: 10.9839 - val_accuracy10: 0.6882 - val_accuracy20: 0.6520 - val_accuracy30: 0.6160 - val_accuracy50: 0.5469 - 24s/epoch - 37ms/step
Epoch 2/50
641/641 - 19s - loss: 11.2037 - accuracy10: 0.5752 - accuracy20: 0.5695 - accuracy30: 0.5538 - accuracy50: 0.5239 - val_loss: 10.5199 - val_accuracy10: 0.7017 - val_accuracy20: 0.6656 - val_accuracy30: 0.6296 - val_accuracy50: 0.5635 - 19s/epoch - 30ms/step
Epoch 3/50
641/641 - 19s - loss: 10.8571 - accuracy10: 0.6010 - accuracy20: 0.5924 - accuracy30: 0.5751 - accuracy50: 0.5421 - val_loss: 10.3497 - val_accuracy10: 0.6974 - val_accuracy20: 0.6637 - val_accuracy30: 0.6301 - val_accuracy50: 0.5656 - 19s/epoch - 30ms/step
Epoch 4/50
641/641 - 19s - loss: 10.7178 - accuracy10: 0.6055 - accuracy20: 0.5982 - accuracy30: 0.5810 - accuracy50: 0.5478 - val_loss: 10.1692 - val_accuracy10: 0.6966 - val_accuracy20: 0.6649 - val_accuracy30: 0.6318 - val_accuracy50: 0.5690 - 19s/epoch - 30ms/step
Epoch 5/50
641/641 - 19s - loss: 10.6072 - accuracy10: 0.6112 - accuracy20: 0.6029 - accuracy30: 0.5850 - accuracy50: 0.5519 - val_loss: 10.1270 - val_accuracy10: 0.6942 - val_accuracy20: 0.6643 - val_accuracy30: 0.6336 - val_accuracy50: 0.5720 - 19s/epoch - 30ms/step
Epoch 6/50
641/641 - 19s - loss: 10.5336 - accuracy10: 0.6139 - accuracy20: 0.6057 - accuracy30: 0.5883 - accuracy50: 0.5554 - val_loss: 10.1052 - val_accuracy10: 0.6913 - val_accuracy20: 0.6627 - val_accuracy30: 0.6312 - val_accuracy50: 0.5708 - 19s/epoch - 30ms/step
Epoch 7/50
641/641 - 18s - loss: 10.4600 - accuracy10: 0.6166 - accuracy20: 0.6088 - accuracy30: 0.5918 - accuracy50: 0.5588 - val_loss: 10.1237 - val_accuracy10: 0.6869 - val_accuracy20: 0.6600 - val_accuracy30: 0.6295 - val_accuracy50: 0.5684 - 18s/epoch - 29ms/step
Epoch 8/50
641/641 - 18s - loss: 10.4136 - accuracy10: 0.6184 - accuracy20: 0.6100 - accuracy30: 0.5926 - accuracy50: 0.5608 - val_loss: 10.1538 - val_accuracy10: 0.6891 - val_accuracy20: 0.6594 - val_accuracy30: 0.6278 - val_accuracy50: 0.5679 - 18s/epoch - 29ms/step
Epoch 9/50
641/641 - 19s - loss: 10.3596 - accuracy10: 0.6207 - accuracy20: 0.6134 - accuracy30: 0.5968 - accuracy50: 0.5636 - val_loss: 10.1199 - val_accuracy10: 0.6908 - val_accuracy20: 0.6637 - val_accuracy30: 0.6311 - val_accuracy50: 0.5708 - 19s/epoch - 29ms/step
Epoch 10/50
641/641 - 19s - loss: 10.3086 - accuracy10: 0.6224 - accuracy20: 0.6139 - accuracy30: 0.5982 - accuracy50: 0.5656 - val_loss: 10.1240 - val_accuracy10: 0.6846 - val_accuracy20: 0.6583 - val_accuracy30: 0.6273 - val_accuracy50: 0.5687 - 19s/epoch - 30ms/step
Epoch 11/50
641/641 - 19s - loss: 10.2491 - accuracy10: 0.6247 - accuracy20: 0.6173 - accuracy30: 0.6008 - accuracy50: 0.5690 - val_loss: 10.2087 - val_accuracy10: 0.6887 - val_accuracy20: 0.6615 - val_accuracy30: 0.6279 - val_accuracy50: 0.5676 - 19s/epoch - 29ms/step
Epoch 12/50
641/641 - 19s - loss: 10.2049 - accuracy10: 0.6260 - accuracy20: 0.6195 - accuracy30: 0.6029 - accuracy50: 0.5725 - val_loss: 10.1667 - val_accuracy10: 0.6797 - val_accuracy20: 0.6541 - val_accuracy30: 0.6222 - val_accuracy50: 0.5649 - 19s/epoch - 29ms/step
Epoch 13/50
641/641 - 18s - loss: 10.1557 - accuracy10: 0.6255 - accuracy20: 0.6206 - accuracy30: 0.6049 - accuracy50: 0.5750 - val_loss: 10.2810 - val_accuracy10: 0.6841 - val_accuracy20: 0.6572 - val_accuracy30: 0.6238 - val_accuracy50: 0.5652 - 18s/epoch - 28ms/step
Epoch 14/50
641/641 - 19s - loss: 10.1102 - accuracy10: 0.6273 - accuracy20: 0.6223 - accuracy30: 0.6073 - accuracy50: 0.5772 - val_loss: 10.2486 - val_accuracy10: 0.6775 - val_accuracy20: 0.6507 - val_accuracy30: 0.6183 - val_accuracy50: 0.5604 - 19s/epoch - 29ms/step
Epoch 15/50
641/641 - 19s - loss: 10.0625 - accuracy10: 0.6292 - accuracy20: 0.6238 - accuracy30: 0.6091 - accuracy50: 0.5791 - val_loss: 10.3216 - val_accuracy10: 0.6844 - val_accuracy20: 0.6565 - val_accuracy30: 0.6242 - val_accuracy50: 0.5657 - 19s/epoch - 29ms/step
Epoch 16/50
641/641 - 18s - loss: 10.0179 - accuracy10: 0.6289 - accuracy20: 0.6241 - accuracy30: 0.6101 - accuracy50: 0.5822 - val_loss: 10.2814 - val_accuracy10: 0.6803 - val_accuracy20: 0.6536 - val_accuracy30: 0.6212 - val_accuracy50: 0.5635 - 18s/epoch - 29ms/step
testing model: results/QRTEA/W3/deepOF_L2/seq2seq
Evaluating performance on  test set...
1443/1443 - 14s - 14s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5979477
{'0': {'precision': 0.4040043239178456, 'recall': 0.5031314018144571, 'f1-score': 0.4481518169021428, 'support': 34170}, '1': {'precision': 0.9124509306200081, 'recall': 0.8451598802553846, 'f1-score': 0.8775172688857487, 'support': 301976}, '2': {'precision': 0.33795656150949815, 'recall': 0.4796365063551007, 'f1-score': 0.39652074077771676, 'support': 33123}, 'accuracy': 0.7807235375837127, 'macro avg': {'precision': 0.5514706053491173, 'recall': 0.6093092628083142, 'f1-score': 0.5740632755218694, 'support': 369269}, 'weighted avg': {'precision': 0.8138707694392421, 'recall': 0.7807235375837127, 'f1-score': 0.7946414642695959, 'support': 369269}}
[[ 17192  11952   5026]
 [ 20662 255218  26096]
 [  4700  12536  15887]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6521211
{'0': {'precision': 0.48512927137949735, 'recall': 0.46490373161804516, 'f1-score': 0.47480120768405565, 'support': 46173}, '1': {'precision': 0.8599927404718694, 'recall': 0.8520873493109302, 'f1-score': 0.8560217936396679, 'support': 278056}, '2': {'precision': 0.4041719674481533, 'recall': 0.44438277087033745, 'f1-score': 0.42332462643161556, 'support': 45040}, 'accuracy': 0.7539463101424707, 'macro avg': {'precision': 0.58309799309984, 'recall': 0.5871246172664376, 'f1-score': 0.5847158759184463, 'support': 369269}, 'weighted avg': {'precision': 0.7575234333396967, 'recall': 0.7539463101424707, 'f1-score': 0.7555780019149925, 'support': 369269}}
[[ 21466  18738   5969]
 [ 17591 236928  23537]
 [  5191  19834  20015]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7114597
{'0': {'precision': 0.5262864407913813, 'recall': 0.42659555234134877, 'f1-score': 0.4712261466103472, 'support': 55310}, '1': {'precision': 0.8121122458719099, 'recall': 0.8509056361377475, 'f1-score': 0.8310564722897903, 'support': 259983}, '2': {'precision': 0.4333897067302149, 'recall': 0.4177967985771454, 'f1-score': 0.425450429204792, 'support': 53976}, 'accuracy': 0.724043989611909, 'macro avg': {'precision': 0.5905961311311687, 'recall': 0.5650993290187473, 'f1-score': 0.5759110160349765, 'support': 369269}, 'weighted avg': {'precision': 0.7139427459904789, 'recall': 0.724043989611909, 'f1-score': 0.7178728389631751, 'support': 369269}}
[[ 23595  25120   6595]
 [ 15874 221221  22888]
 [  5364  26061  22551]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7990202
{'0': {'precision': 0.5645022818670643, 'recall': 0.3550105852431764, 'f1-score': 0.4358922917230009, 'support': 70381}, '1': {'precision': 0.7240616065664484, 'recall': 0.8527392796628579, 'f1-score': 0.783149956608046, 'support': 230170}, '2': {'precision': 0.4663094266854558, 'recall': 0.3659739806164324, 'f1-score': 0.41009376273950265, 'support': 68718}, 'accuracy': 0.6672913242108057, 'macro avg': {'precision': 0.5849577717063228, 'recall': 0.5245746151741556, 'f1-score': 0.5430453370235165, 'support': 369269}, 'weighted avg': {'precision': 0.6456847075342268, 'recall': 0.6672913242108057, 'f1-score': 0.6475414510402, 'support': 369269}}
[[ 24986  37600   7795]
 [ 12907 196275  20988]
 [  6369  37200  25149]]
Evaluating performance on  train set...
641/641 - 7s - 7s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7948677
{'0': {'precision': 0.4141526365267926, 'recall': 0.5231566447155349, 'f1-score': 0.4623163518412517, 'support': 27789}, '1': {'precision': 0.8345494459544219, 'recall': 0.7292949408948898, 'f1-score': 0.7783801175862641, 'support': 109466}, '2': {'precision': 0.4057518537420071, 'recall': 0.5039710652895335, 'f1-score': 0.44955928820888075, 'support': 26819}, 'accuracy': 0.6575508611967771, 'macro avg': {'precision': 0.5514846454077406, 'recall': 0.5854742169666528, 'f1-score': 0.5634185858787989, 'support': 164074}, 'weighted avg': {'precision': 0.6932575315576915, 'recall': 0.6575508611967771, 'f1-score': 0.6711008301345034, 'support': 164074}}
[[14538  8213  5038]
 [14876 79833 14757]
 [ 5689  7614 13516]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8267788
{'0': {'precision': 0.48213061246880057, 'recall': 0.4922568540143941, 'f1-score': 0.48714111517570113, 'support': 35709}, '1': {'precision': 0.7529297924954306, 'recall': 0.74650094338617, 'f1-score': 0.7497015860101379, 'support': 93811}, '2': {'precision': 0.47467129027597166, 'recall': 0.47537188169242345, 'f1-score': 0.4750213276652352, 'support': 34554}, 'accuracy': 0.634067554883772, 'macro avg': {'precision': 0.5699105650800677, 'recall': 0.5713765596976625, 'f1-score': 0.570621342950358, 'support': 164074}, 'weighted avg': {'precision': 0.6353918998051681, 'recall': 0.634067554883772, 'f1-score': 0.6347103412067158, 'support': 164074}}
[[17578 11929  6202]
 [11804 70030 11977]
 [ 7077 11051 16426]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8676725
{'0': {'precision': 0.5053841598018629, 'recall': 0.4599534484870758, 'f1-score': 0.48159977424609746, 'support': 40815}, '1': {'precision': 0.6856156020723565, 'recall': 0.7465207080748317, 'f1-score': 0.7147730856340128, 'support': 83494}, '2': {'precision': 0.4996251769997501, 'recall': 0.4525336351062492, 'f1-score': 0.4749148874402892, 'support': 39765}, 'accuracy': 0.6039835683898729, 'macro avg': {'precision': 0.5635416462913232, 'recall': 0.5530025972227189, 'f1-score': 0.5570959157734664, 'support': 164074}, 'weighted avg': {'precision': 0.5957046133155615, 'recall': 0.6039835683898729, 'f1-score': 0.5986368912615273, 'support': 164074}}
[[18773 14911  7131]
 [10273 62330 10891]
 [ 8100 13670 17995]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.93458897
{'0': {'precision': 0.5239302778741691, 'recall': 0.40878040653115627, 'f1-score': 0.45924730050655715, 'support': 48016}, '1': {'precision': 0.5760756680699952, 'recall': 0.7480930421415934, 'f1-score': 0.650911316219473, 'support': 68958}, '2': {'precision': 0.5216124332200097, 'recall': 0.41044585987261145, 'f1-score': 0.4593997290938904, 'support': 47100}, 'accuracy': 0.551866840571937, 'macro avg': {'precision': 0.5405394597213914, 'recall': 0.5224397695151204, 'f1-score': 0.5231861152733068, 'support': 164074}, 'weighted avg': {'precision': 0.5451808802481763, 'recall': 0.551866840571937, 'f1-score': 0.539844753984833, 'support': 164074}}
[[19628 19799  8589]
 [ 8230 51587  9141]
 [ 9605 18163 19332]]
Evaluating performance on  val set...
274/274 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7330056
{'0': {'precision': 0.40546503733876443, 'recall': 0.4864094472157182, 'f1-score': 0.4422640810848336, 'support': 9823}, '1': {'precision': 0.8517645503811077, 'recall': 0.766371997145802, 'f1-score': 0.8068150992216682, 'support': 50452}, '2': {'precision': 0.3919962917181706, 'recall': 0.5152838427947598, 'f1-score': 0.4452634811987188, 'support': 9847}, 'accuracy': 0.6918941273779984, 'macro avg': {'precision': 0.5497419598126808, 'recall': 0.58935509571876, 'f1-score': 0.5647808871684069, 'support': 70122}, 'weighted avg': {'precision': 0.724681207640329, 'recall': 0.6918941273779984, 'f1-score': 0.7049756845753359, 'support': 70122}}
[[ 4778  3475  1570]
 [ 5487 38665  6300]
 [ 1519  3254  5074]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.77450293
{'0': {'precision': 0.4835818463293408, 'recall': 0.45727713999537717, 'f1-score': 0.4700617772849675, 'support': 12979}, '1': {'precision': 0.7727774896850269, 'recall': 0.7787294951606307, 'f1-score': 0.7757420756617289, 'support': 44014}, '2': {'precision': 0.4742145820983995, 'recall': 0.48747048518546726, 'f1-score': 0.4807511737089201, 'support': 13129}, 'accuracy': 0.6646986680357092, 'macro avg': {'precision': 0.5768579727042558, 'recall': 0.5744923734471584, 'f1-score': 0.5755183422185388, 'support': 70122}, 'weighted avg': {'precision': 0.6633495973143262, 'recall': 0.6646986680357092, 'f1-score': 0.6639318000795947, 'support': 70122}}
[[ 5935  5216  1828]
 [ 4471 34275  5268]
 [ 1867  4862  6400]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8233808
{'0': {'precision': 0.5155150351887396, 'recall': 0.4257033416985867, 'f1-score': 0.46632424220502067, 'support': 15142}, '1': {'precision': 0.7058999081726355, 'recall': 0.7769411526896935, 'f1-score': 0.7397187774396479, 'support': 39577}, '2': {'precision': 0.5107412149665671, 'recall': 0.4661429591637993, 'f1-score': 0.48742405213672313, 'support': 15403}, 'accuracy': 0.6328256467299849, 'macro avg': {'precision': 0.577385386109314, 'recall': 0.5562624845173599, 'f1-score': 0.5644890239271305, 'support': 70122}, 'weighted avg': {'precision': 0.621920028845531, 'recall': 0.6328256467299849, 'f1-score': 0.6252634609004208, 'support': 70122}}
[[ 6446  6657  2039]
 [ 3989 30749  4839]
 [ 2069  6154  7180]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9040333
{'0': {'precision': 0.5355888924353654, 'recall': 0.3672576056029766, 'f1-score': 0.43573097896650226, 'support': 18276}, '1': {'precision': 0.593574576664347, 'recall': 0.7735723570845552, 'f1-score': 0.6717242646576278, 'support': 33079}, '2': {'precision': 0.5413674033149172, 'recall': 0.4177012841690201, 'f1-score': 0.4715613438806509, 'support': 18767}, 'accuracy': 0.5724309061350218, 'macro avg': {'precision': 0.5568436241382099, 'recall': 0.5195104156188507, 'f1-score': 0.5263388625015937, 'support': 70122}, 'weighted avg': {'precision': 0.5644892912016161, 'recall': 0.5724309061350218, 'f1-score': 0.5566466738371644, 'support': 70122}}
[[ 6712  9073  2491]
 [ 3340 25589  4150]
 [ 2480  8448  7839]]
training model: results/QRTEA/W3/deepVOL_L2/seq2seq
Epoch 1/50
641/641 - 24s - loss: 11.7981 - accuracy10: 0.5300 - accuracy20: 0.5292 - accuracy30: 0.5182 - accuracy50: 0.4988 - val_loss: 10.8754 - val_accuracy10: 0.5883 - val_accuracy20: 0.5754 - val_accuracy30: 0.5548 - val_accuracy50: 0.5202 - 24s/epoch - 37ms/step
Epoch 2/50
641/641 - 18s - loss: 11.2149 - accuracy10: 0.5793 - accuracy20: 0.5764 - accuracy30: 0.5616 - accuracy50: 0.5336 - val_loss: 10.5869 - val_accuracy10: 0.5964 - val_accuracy20: 0.5802 - val_accuracy30: 0.5555 - val_accuracy50: 0.5192 - 18s/epoch - 27ms/step
Epoch 3/50
641/641 - 18s - loss: 10.9123 - accuracy10: 0.5988 - accuracy20: 0.5949 - accuracy30: 0.5792 - accuracy50: 0.5470 - val_loss: 10.4147 - val_accuracy10: 0.6391 - val_accuracy20: 0.6209 - val_accuracy30: 0.5934 - val_accuracy50: 0.5468 - 18s/epoch - 28ms/step
Epoch 4/50
641/641 - 17s - loss: 10.8009 - accuracy10: 0.6052 - accuracy20: 0.6015 - accuracy30: 0.5848 - accuracy50: 0.5515 - val_loss: 10.4373 - val_accuracy10: 0.6520 - val_accuracy20: 0.6281 - val_accuracy30: 0.5954 - val_accuracy50: 0.5451 - 17s/epoch - 27ms/step
Epoch 5/50
641/641 - 19s - loss: 10.7389 - accuracy10: 0.6083 - accuracy20: 0.6039 - accuracy30: 0.5880 - accuracy50: 0.5538 - val_loss: 10.4485 - val_accuracy10: 0.6340 - val_accuracy20: 0.6208 - val_accuracy30: 0.5955 - val_accuracy50: 0.5467 - 19s/epoch - 30ms/step
Epoch 6/50
641/641 - 19s - loss: 10.6734 - accuracy10: 0.6108 - accuracy20: 0.6071 - accuracy30: 0.5899 - accuracy50: 0.5566 - val_loss: 10.4099 - val_accuracy10: 0.6239 - val_accuracy20: 0.6141 - val_accuracy30: 0.5932 - val_accuracy50: 0.5507 - 19s/epoch - 29ms/step
Epoch 7/50
641/641 - 18s - loss: 10.6326 - accuracy10: 0.6136 - accuracy20: 0.6093 - accuracy30: 0.5926 - accuracy50: 0.5582 - val_loss: 10.3028 - val_accuracy10: 0.6725 - val_accuracy20: 0.6501 - val_accuracy30: 0.6188 - val_accuracy50: 0.5636 - 18s/epoch - 29ms/step
Epoch 8/50
641/641 - 18s - loss: 10.5712 - accuracy10: 0.6125 - accuracy20: 0.6095 - accuracy30: 0.5931 - accuracy50: 0.5590 - val_loss: 10.2092 - val_accuracy10: 0.6643 - val_accuracy20: 0.6447 - val_accuracy30: 0.6154 - val_accuracy50: 0.5613 - 18s/epoch - 28ms/step
Epoch 9/50
641/641 - 17s - loss: 10.5220 - accuracy10: 0.6173 - accuracy20: 0.6128 - accuracy30: 0.5950 - accuracy50: 0.5602 - val_loss: 10.2304 - val_accuracy10: 0.6746 - val_accuracy20: 0.6510 - val_accuracy30: 0.6184 - val_accuracy50: 0.5638 - 17s/epoch - 27ms/step
Epoch 10/50
641/641 - 18s - loss: 10.4883 - accuracy10: 0.6172 - accuracy20: 0.6132 - accuracy30: 0.5961 - accuracy50: 0.5613 - val_loss: 10.2238 - val_accuracy10: 0.6763 - val_accuracy20: 0.6522 - val_accuracy30: 0.6186 - val_accuracy50: 0.5609 - 18s/epoch - 28ms/step
Epoch 11/50
641/641 - 18s - loss: 10.4373 - accuracy10: 0.6185 - accuracy20: 0.6147 - accuracy30: 0.5975 - accuracy50: 0.5625 - val_loss: 10.2202 - val_accuracy10: 0.6754 - val_accuracy20: 0.6538 - val_accuracy30: 0.6216 - val_accuracy50: 0.5632 - 18s/epoch - 28ms/step
Epoch 12/50
641/641 - 18s - loss: 10.4096 - accuracy10: 0.6212 - accuracy20: 0.6155 - accuracy30: 0.5977 - accuracy50: 0.5634 - val_loss: 10.1500 - val_accuracy10: 0.6676 - val_accuracy20: 0.6458 - val_accuracy30: 0.6147 - val_accuracy50: 0.5592 - 18s/epoch - 28ms/step
Epoch 13/50
641/641 - 18s - loss: 10.3615 - accuracy10: 0.6217 - accuracy20: 0.6172 - accuracy30: 0.6005 - accuracy50: 0.5656 - val_loss: 10.2289 - val_accuracy10: 0.6887 - val_accuracy20: 0.6600 - val_accuracy30: 0.6262 - val_accuracy50: 0.5632 - 18s/epoch - 28ms/step
Epoch 14/50
641/641 - 17s - loss: 10.3310 - accuracy10: 0.6231 - accuracy20: 0.6184 - accuracy30: 0.6018 - accuracy50: 0.5677 - val_loss: 10.2842 - val_accuracy10: 0.6711 - val_accuracy20: 0.6446 - val_accuracy30: 0.6116 - val_accuracy50: 0.5539 - 17s/epoch - 27ms/step
Epoch 15/50
641/641 - 18s - loss: 10.2908 - accuracy10: 0.6239 - accuracy20: 0.6193 - accuracy30: 0.6025 - accuracy50: 0.5683 - val_loss: 10.1918 - val_accuracy10: 0.6756 - val_accuracy20: 0.6489 - val_accuracy30: 0.6172 - val_accuracy50: 0.5585 - 18s/epoch - 28ms/step
Epoch 16/50
641/641 - 18s - loss: 10.2567 - accuracy10: 0.6255 - accuracy20: 0.6210 - accuracy30: 0.6042 - accuracy50: 0.5712 - val_loss: 10.3212 - val_accuracy10: 0.6698 - val_accuracy20: 0.6424 - val_accuracy30: 0.6079 - val_accuracy50: 0.5497 - 18s/epoch - 28ms/step
Epoch 17/50
641/641 - 18s - loss: 10.2369 - accuracy10: 0.6257 - accuracy20: 0.6205 - accuracy30: 0.6033 - accuracy50: 0.5693 - val_loss: 10.2986 - val_accuracy10: 0.6677 - val_accuracy20: 0.6414 - val_accuracy30: 0.6078 - val_accuracy50: 0.5506 - 18s/epoch - 29ms/step
Epoch 18/50
641/641 - 18s - loss: 10.1897 - accuracy10: 0.6260 - accuracy20: 0.6218 - accuracy30: 0.6057 - accuracy50: 0.5724 - val_loss: 10.3270 - val_accuracy10: 0.6694 - val_accuracy20: 0.6420 - val_accuracy30: 0.6094 - val_accuracy50: 0.5499 - 18s/epoch - 27ms/step
Epoch 19/50
641/641 - 18s - loss: 10.1555 - accuracy10: 0.6269 - accuracy20: 0.6226 - accuracy30: 0.6072 - accuracy50: 0.5746 - val_loss: 10.3300 - val_accuracy10: 0.6686 - val_accuracy20: 0.6394 - val_accuracy30: 0.6055 - val_accuracy50: 0.5481 - 18s/epoch - 28ms/step
Epoch 20/50
641/641 - 19s - loss: 10.1390 - accuracy10: 0.6284 - accuracy20: 0.6236 - accuracy30: 0.6076 - accuracy50: 0.5759 - val_loss: 10.3183 - val_accuracy10: 0.6681 - val_accuracy20: 0.6383 - val_accuracy30: 0.6045 - val_accuracy50: 0.5462 - 19s/epoch - 29ms/step
Epoch 21/50
641/641 - 18s - loss: 10.1149 - accuracy10: 0.6290 - accuracy20: 0.6242 - accuracy30: 0.6083 - accuracy50: 0.5762 - val_loss: 10.3384 - val_accuracy10: 0.6609 - val_accuracy20: 0.6314 - val_accuracy30: 0.5969 - val_accuracy50: 0.5423 - 18s/epoch - 29ms/step
Epoch 22/50
641/641 - 18s - loss: 10.0817 - accuracy10: 0.6277 - accuracy20: 0.6237 - accuracy30: 0.6076 - accuracy50: 0.5768 - val_loss: 10.3660 - val_accuracy10: 0.6452 - val_accuracy20: 0.6192 - val_accuracy30: 0.5877 - val_accuracy50: 0.5374 - 18s/epoch - 28ms/step
testing model: results/QRTEA/W3/deepVOL_L2/seq2seq
Evaluating performance on  test set...
1443/1443 - 15s - 15s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7037699
{'0': {'precision': 0.45814258638285466, 'recall': 0.4598185542873866, 'f1-score': 0.4589790403855985, 'support': 34170}, '1': {'precision': 0.9244736752601864, 'recall': 0.7200912652288088, 'f1-score': 0.8095824033447941, 'support': 301977}, '2': {'precision': 0.22958641566929291, 'recall': 0.6914206363581477, 'f1-score': 0.3447113358617783, 'support': 33126}, 'accuracy': 0.6934354799836435, 'macro avg': {'precision': 0.5374008924374446, 'recall': 0.6237768186247811, 'f1-score': 0.5377575931973904, 'support': 369273}, 'weighted avg': {'precision': 0.8189870334852764, 'recall': 0.6934354799836435, 'f1-score': 0.7354382447040104, 'support': 369273}}
[[ 15712  11682   6776]
 [ 14444 217451  70082]
 [  4139   6083  22904]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.74054056
{'0': {'precision': 0.5478319177469826, 'recall': 0.4246545675055226, 'f1-score': 0.478442280945758, 'support': 46174}, '1': {'precision': 0.8737572314407455, 'recall': 0.725688350548091, 'f1-score': 0.7928690431283792, 'support': 278056}, '2': {'precision': 0.28800039007265105, 'recall': 0.6556623670714651, 'f1-score': 0.40020868905331064, 'support': 45043}, 'accuracy': 0.6795054065691236, 'macro avg': {'precision': 0.5698631797534597, 'recall': 0.6020017617083595, 'f1-score': 0.5571733377091492, 'support': 369273}, 'weighted avg': {'precision': 0.7615542790444454, 'recall': 0.6795054065691236, 'f1-score': 0.7056573010144861, 'support': 369273}}
[[ 19608  18547   8019]
 [ 11281 201782  64993]
 [  4903  10607  29533]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7925126
{'0': {'precision': 0.589329852528675, 'recall': 0.38364882211495, 'f1-score': 0.464749556494886, 'support': 55311}, '1': {'precision': 0.8275089766606822, 'recall': 0.7091579064785005, 'f1-score': 0.7637758578906051, 'support': 259983}, '2': {'precision': 0.31330001991563017, 'recall': 0.6411567461420182, 'f1-score': 0.4209188482471343, 'support': 53979}, 'accuracy': 0.6504618534255144, 'macro avg': {'precision': 0.5767129497016624, 'recall': 0.5779878249118229, 'f1-score': 0.5498147542108751, 'support': 369273}, 'weighted avg': {'precision': 0.7166684580985165, 'recall': 0.6504618534255144, 'f1-score': 0.6688690483484954, 'support': 369273}}
[[ 21220  24229   9862]
 [  9619 184369  65995]
 [  5168  14202  34609]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8657989
{'0': {'precision': 0.6239775846941952, 'recall': 0.31324770537921626, 'f1-score': 0.4171025871446814, 'support': 70382}, '1': {'precision': 0.7422138978041732, 'recall': 0.6852122986822841, 'f1-score': 0.7125749720443224, 'support': 230171}, '2': {'precision': 0.34584094988719266, 'recall': 0.6111903376018626, 'f1-score': 0.44172985707224216, 'support': 68720}, 'accuracy': 0.6005421463253474, 'macro avg': {'precision': 0.5706774774618537, 'recall': 0.5365501138877876, 'f1-score': 0.523802472087082, 'support': 369273}, 'weighted avg': {'precision': 0.6459153404491502, 'recall': 0.6005421463253474, 'f1-score': 0.6058560575965077, 'support': 369273}}
[[ 22047  33827  14508]
 [  7518 157716  64937]
 [  5768  20951  42001]]
Evaluating performance on  train set...
641/641 - 6s - 6s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.82860553
{'0': {'precision': 0.4294957472660996, 'recall': 0.5092382495948136, 'f1-score': 0.46598006097058575, 'support': 27765}, '1': {'precision': 0.846092852217881, 'recall': 0.6721410248217562, 'f1-score': 0.7491516628425781, 'support': 109541}, '2': {'precision': 0.35226011102299765, 'recall': 0.5807837423885838, 'f1-score': 0.4385366128850276, 'support': 26769}, 'accuracy': 0.6296693585250648, 'macro avg': {'precision': 0.5426162368356594, 'recall': 0.5873876722683845, 'f1-score': 0.5512227788993972, 'support': 164075}, 'weighted avg': {'precision': 0.6950264053610652, 'recall': 0.6296693585250648, 'f1-score': 0.6505558146128689, 'support': 164075}}
[[14139  8149  5477]
 [12803 73627 23111]
 [ 5978  5244 15547]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8527352
{'0': {'precision': 0.4932308301065544, 'recall': 0.48950911640953715, 'f1-score': 0.4913629260463741, 'support': 35650}, '1': {'precision': 0.7647719746428233, 'recall': 0.6888495914606215, 'f1-score': 0.7248280770976836, 'support': 93871}, '2': {'precision': 0.4197136513977618, 'recall': 0.5361752619088962, 'f1-score': 0.47084985259733664, 'support': 34554}, 'accuracy': 0.6133841231144294, 'macro avg': {'precision': 0.5592388187157131, 'recall': 0.571511323259685, 'f1-score': 0.5623469519137981, 'support': 164075}, 'weighted avg': {'precision': 0.6331029994538679, 'recall': 0.6133841231144294, 'f1-score': 0.6206135641958754, 'support': 164075}}
[[17451 11869  6330]
 [ 9923 64663 19285]
 [ 8007  8020 18527]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8873371
{'0': {'precision': 0.5168148434480093, 'recall': 0.4589207345477726, 'f1-score': 0.4861502499837673, 'support': 40787}, '1': {'precision': 0.6990558954222622, 'recall': 0.679517092022925, 'f1-score': 0.6891480299481854, 'support': 83577}, '2': {'precision': 0.4421443281276815, 'recall': 0.5190249553020574, 'f1-score': 0.47750993316111995, 'support': 39711}, 'accuracy': 0.5858357458479354, 'macro avg': {'precision': 0.5526716889993176, 'recall': 0.552487593957585, 'f1-score': 0.5509360710310242, 'support': 164075}, 'weighted avg': {'precision': 0.5915728478177584, 'recall': 0.5858357458479354, 'f1-score': 0.5874626366041666, 'support': 164075}}
[[18718 14537  7532]
 [ 8312 56792 18473]
 [ 9188  9912 20611]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9381961
{'0': {'precision': 0.535237039090657, 'recall': 0.4023592180400984, 'f1-score': 0.45938228715557033, 'support': 47982}, '1': {'precision': 0.5929402347229933, 'recall': 0.6658209496194273, 'f1-score': 0.6272707405687435, 'support': 68975}, '2': {'precision': 0.4647096059503086, 'recall': 0.4985780381170678, 'f1-score': 0.4810484283812839, 'support': 47118}, 'accuracy': 0.5407466097821119, 'macro avg': {'precision': 0.530962293254653, 'recall': 0.5222527352588645, 'f1-score': 0.5225671520351992, 'support': 164075}, 'weighted avg': {'precision': 0.5392411001848729, 'recall': 0.5407466097821119, 'f1-score': 0.536182356126753, 'support': 164075}}
[[19306 18365 10311]
 [ 6301 45925 16749]
 [10463 13163 23492]]
Evaluating performance on  val set...
274/274 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.76518893
{'0': {'precision': 0.44280039721946374, 'recall': 0.45292026409344843, 'f1-score': 0.4478031634446397, 'support': 9845}, '1': {'precision': 0.8577210755538723, 'recall': 0.7189167741295507, 'f1-score': 0.7822088869221719, 'support': 50405}, '2': {'precision': 0.33739609076612, 'recall': 0.6084886547811994, 'f1-score': 0.43409452232981643, 'support': 9872}, 'accuracy': 0.6660249279826588, 'macro avg': {'precision': 0.5459725211798186, 'recall': 0.5934418976680661, 'f1-score': 0.5547021908988761, 'support': 70122}, 'weighted avg': {'precision': 0.7262139547069634, 'recall': 0.6660249279826588, 'f1-score': 0.6862502811366548, 'support': 70122}}
[[ 4459  3621  1765]
 [ 4136 36237 10032]
 [ 1475  2390  6007]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.80230886
{'0': {'precision': 0.516003048199657, 'recall': 0.41605222734254993, 'f1-score': 0.46066842418573006, 'support': 13020}, '1': {'precision': 0.7754045307443366, 'recall': 0.7358052775250228, 'f1-score': 0.7550860811205136, 'support': 43960}, '2': {'precision': 0.4137584454743425, 'recall': 0.5638411200730482, 'f1-score': 0.4772793146758558, 'support': 13142}, 'accuracy': 0.6442058127263911, 'macro avg': {'precision': 0.568388674806112, 'recall': 0.5718995416468736, 'f1-score': 0.5643446066606997, 'support': 70122}, 'weighted avg': {'precision': 0.6594614578806134, 'recall': 0.6442058127263911, 'f1-score': 0.6483541793221254, 'support': 70122}}
[[ 5417  5562  2041]
 [ 3156 32346  8458]
 [ 1925  3807  7410]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.84750116
{'0': {'precision': 0.5534044763433752, 'recall': 0.3870797278552084, 'f1-score': 0.45553482587064675, 'support': 15139}, '1': {'precision': 0.7080107170071037, 'recall': 0.7284959154252764, 'f1-score': 0.7181072523746603, 'support': 39539}, '2': {'precision': 0.4482228116710875, 'recall': 0.5470732970732971, 'f1-score': 0.492739254680119, 'support': 15444}, 'accuracy': 0.6148284418584752, 'macro avg': {'precision': 0.5698793350071888, 'recall': 0.5542163134512607, 'f1-score': 0.5554604443084754, 'support': 70122}, 'weighted avg': {'precision': 0.6174150653226449, 'recall': 0.6148284418584752, 'f1-score': 0.6117830271494991, 'support': 70122}}
[[ 5860  6974  2305]
 [ 2639 28804  8096]
 [ 2090  4905  8449]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9173436
{'0': {'precision': 0.5802421679800115, 'recall': 0.3301077032420316, 'f1-score': 0.4208105376868662, 'support': 18291}, '1': {'precision': 0.5981058580921103, 'recall': 0.710896601809544, 'f1-score': 0.6496418991787186, 'support': 33047}, '2': {'precision': 0.4733571463522043, 'recall': 0.5150127768313458, 'f1-score': 0.49330715688024274, 'support': 18784}, 'accuracy': 0.5590970023673028, 'macro avg': {'precision': 0.5505683908081087, 'recall': 0.5186723606276405, 'f1-score': 0.5212531979152758, 'support': 70122}, 'weighted avg': {'precision': 0.5600290126347247, 'recall': 0.5590970023673028, 'f1-score': 0.5480739713902636, 'support': 70122}}
[[ 6038  9022  3231]
 [ 2022 23493  7532]
 [ 2346  6764  9674]]
training model: results/QRTEA/W3/deepVOL_L3/seq2seq
Epoch 1/50
641/641 - 33s - loss: 12.3475 - accuracy10: 0.5010 - accuracy20: 0.4953 - accuracy30: 0.4857 - accuracy50: 0.4684 - val_loss: 11.1744 - val_accuracy10: 0.5993 - val_accuracy20: 0.5736 - val_accuracy30: 0.5482 - val_accuracy50: 0.5084 - 33s/epoch - 52ms/step
Epoch 2/50
641/641 - 26s - loss: 11.4602 - accuracy10: 0.5623 - accuracy20: 0.5576 - accuracy30: 0.5459 - accuracy50: 0.5208 - val_loss: 10.6654 - val_accuracy10: 0.5924 - val_accuracy20: 0.5828 - val_accuracy30: 0.5662 - val_accuracy50: 0.5281 - 26s/epoch - 41ms/step
Epoch 3/50
641/641 - 26s - loss: 11.0685 - accuracy10: 0.5876 - accuracy20: 0.5814 - accuracy30: 0.5668 - accuracy50: 0.5379 - val_loss: 10.4521 - val_accuracy10: 0.6106 - val_accuracy20: 0.5928 - val_accuracy30: 0.5704 - val_accuracy50: 0.5329 - 26s/epoch - 41ms/step
Epoch 4/50
641/641 - 28s - loss: 10.9022 - accuracy10: 0.5976 - accuracy20: 0.5906 - accuracy30: 0.5748 - accuracy50: 0.5445 - val_loss: 10.3684 - val_accuracy10: 0.6305 - val_accuracy20: 0.6106 - val_accuracy30: 0.5837 - val_accuracy50: 0.5374 - 28s/epoch - 44ms/step
Epoch 5/50
641/641 - 27s - loss: 10.7730 - accuracy10: 0.6017 - accuracy20: 0.5969 - accuracy30: 0.5815 - accuracy50: 0.5500 - val_loss: 10.3843 - val_accuracy10: 0.6142 - val_accuracy20: 0.5909 - val_accuracy30: 0.5628 - val_accuracy50: 0.5215 - 27s/epoch - 42ms/step
Epoch 6/50
641/641 - 26s - loss: 10.6896 - accuracy10: 0.6052 - accuracy20: 0.5992 - accuracy30: 0.5831 - accuracy50: 0.5523 - val_loss: 10.1413 - val_accuracy10: 0.6672 - val_accuracy20: 0.6386 - val_accuracy30: 0.6050 - val_accuracy50: 0.5538 - 26s/epoch - 40ms/step
Epoch 7/50
641/641 - 27s - loss: 10.5971 - accuracy10: 0.6099 - accuracy20: 0.6033 - accuracy30: 0.5874 - accuracy50: 0.5559 - val_loss: 10.2069 - val_accuracy10: 0.6488 - val_accuracy20: 0.6208 - val_accuracy30: 0.5915 - val_accuracy50: 0.5439 - 27s/epoch - 42ms/step
Epoch 8/50
641/641 - 27s - loss: 10.5396 - accuracy10: 0.6104 - accuracy20: 0.6051 - accuracy30: 0.5886 - accuracy50: 0.5572 - val_loss: 10.1914 - val_accuracy10: 0.6423 - val_accuracy20: 0.6186 - val_accuracy30: 0.5899 - val_accuracy50: 0.5416 - 27s/epoch - 42ms/step
Epoch 9/50
641/641 - 26s - loss: 10.4863 - accuracy10: 0.6133 - accuracy20: 0.6069 - accuracy30: 0.5899 - accuracy50: 0.5591 - val_loss: 10.1602 - val_accuracy10: 0.6470 - val_accuracy20: 0.6235 - val_accuracy30: 0.5923 - val_accuracy50: 0.5423 - 26s/epoch - 41ms/step
Epoch 10/50
641/641 - 26s - loss: 10.4427 - accuracy10: 0.6133 - accuracy20: 0.6084 - accuracy30: 0.5913 - accuracy50: 0.5597 - val_loss: 10.0787 - val_accuracy10: 0.6673 - val_accuracy20: 0.6407 - val_accuracy30: 0.6107 - val_accuracy50: 0.5580 - 26s/epoch - 40ms/step
Epoch 11/50
641/641 - 27s - loss: 10.3993 - accuracy10: 0.6161 - accuracy20: 0.6103 - accuracy30: 0.5937 - accuracy50: 0.5617 - val_loss: 10.1418 - val_accuracy10: 0.6480 - val_accuracy20: 0.6234 - val_accuracy30: 0.5938 - val_accuracy50: 0.5464 - 27s/epoch - 42ms/step
Epoch 12/50
641/641 - 26s - loss: 10.3426 - accuracy10: 0.6191 - accuracy20: 0.6130 - accuracy30: 0.5970 - accuracy50: 0.5651 - val_loss: 10.1086 - val_accuracy10: 0.6579 - val_accuracy20: 0.6329 - val_accuracy30: 0.6023 - val_accuracy50: 0.5490 - 26s/epoch - 41ms/step
Epoch 13/50
641/641 - 26s - loss: 10.3018 - accuracy10: 0.6197 - accuracy20: 0.6141 - accuracy30: 0.5976 - accuracy50: 0.5652 - val_loss: 10.1187 - val_accuracy10: 0.6428 - val_accuracy20: 0.6186 - val_accuracy30: 0.5925 - val_accuracy50: 0.5465 - 26s/epoch - 40ms/step
Epoch 14/50
641/641 - 27s - loss: 10.2602 - accuracy10: 0.6226 - accuracy20: 0.6159 - accuracy30: 0.5995 - accuracy50: 0.5688 - val_loss: 10.0983 - val_accuracy10: 0.6545 - val_accuracy20: 0.6281 - val_accuracy30: 0.5978 - val_accuracy50: 0.5484 - 27s/epoch - 42ms/step
Epoch 15/50
641/641 - 27s - loss: 10.2344 - accuracy10: 0.6242 - accuracy20: 0.6182 - accuracy30: 0.6013 - accuracy50: 0.5693 - val_loss: 10.1343 - val_accuracy10: 0.6576 - val_accuracy20: 0.6328 - val_accuracy30: 0.6034 - val_accuracy50: 0.5551 - 27s/epoch - 43ms/step
Epoch 16/50
641/641 - 26s - loss: 10.1908 - accuracy10: 0.6246 - accuracy20: 0.6203 - accuracy30: 0.6035 - accuracy50: 0.5727 - val_loss: 10.1031 - val_accuracy10: 0.6450 - val_accuracy20: 0.6217 - val_accuracy30: 0.5942 - val_accuracy50: 0.5481 - 26s/epoch - 40ms/step
Epoch 17/50
641/641 - 26s - loss: 10.1549 - accuracy10: 0.6256 - accuracy20: 0.6192 - accuracy30: 0.6038 - accuracy50: 0.5731 - val_loss: 10.0845 - val_accuracy10: 0.6461 - val_accuracy20: 0.6213 - val_accuracy30: 0.5932 - val_accuracy50: 0.5477 - 26s/epoch - 41ms/step
Epoch 18/50
641/641 - 29s - loss: 10.1221 - accuracy10: 0.6256 - accuracy20: 0.6200 - accuracy30: 0.6051 - accuracy50: 0.5755 - val_loss: 10.1897 - val_accuracy10: 0.6232 - val_accuracy20: 0.6044 - val_accuracy30: 0.5808 - val_accuracy50: 0.5393 - 29s/epoch - 45ms/step
Epoch 19/50
641/641 - 26s - loss: 10.0814 - accuracy10: 0.6267 - accuracy20: 0.6222 - accuracy30: 0.6073 - accuracy50: 0.5772 - val_loss: 10.1871 - val_accuracy10: 0.6447 - val_accuracy20: 0.6233 - val_accuracy30: 0.5971 - val_accuracy50: 0.5509 - 26s/epoch - 40ms/step
Epoch 20/50
641/641 - 26s - loss: 10.0400 - accuracy10: 0.6264 - accuracy20: 0.6236 - accuracy30: 0.6088 - accuracy50: 0.5789 - val_loss: 10.2523 - val_accuracy10: 0.6240 - val_accuracy20: 0.6075 - val_accuracy30: 0.5854 - val_accuracy50: 0.5445 - 26s/epoch - 40ms/step
testing model: results/QRTEA/W3/deepVOL_L3/seq2seq
Evaluating performance on  test set...
1443/1443 - 25s - 25s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.68120694
{'0': {'precision': 0.46238813904722526, 'recall': 0.4581796897863623, 'f1-score': 0.4602742947860471, 'support': 34170}, '1': {'precision': 0.9240906651253045, 'recall': 0.7411955215132279, 'f1-score': 0.8225995843340618, 'support': 301977}, '2': {'precision': 0.24208188489764387, 'recall': 0.6811266074986415, 'f1-score': 0.3572073141771551, 'support': 33126}, 'accuracy': 0.7096186290359707, 'macro avg': {'precision': 0.5428535630233912, 'recall': 0.6268339395994106, 'f1-score': 0.5466937310990879, 'support': 369273}, 'weighted avg': {'precision': 0.8201875956620363, 'recall': 0.7096186290359707, 'f1-score': 0.7473240037065224, 'support': 369273}}
[[ 15656  12017   6497]
 [ 14009 223824  64144]
 [  4194   6369  22563]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.73088574
{'0': {'precision': 0.5495106838844172, 'recall': 0.4110321826135921, 'f1-score': 0.47028942412528496, 'support': 46174}, '1': {'precision': 0.873822878828719, 'recall': 0.7345139108668758, 'f1-score': 0.7981351471229018, 'support': 278056}, '2': {'precision': 0.29475883098368444, 'recall': 0.6609906089736474, 'f1-score': 0.4077068969058753, 'support': 45043}, 'accuracy': 0.6850974753095948, 'macro avg': {'precision': 0.5726974645656068, 'recall': 0.6021789008180384, 'f1-score': 0.5587104893846874, 'support': 369273}, 'weighted avg': {'precision': 0.7626380015253632, 'recall': 0.6850974753095948, 'f1-score': 0.7095177608308699, 'support': 369273}}
[[ 18979  18718   8477]
 [ 11062 204236  62758]
 [  4497  10773  29773]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7870639
{'0': {'precision': 0.5846849923168858, 'recall': 0.37148126050875957, 'f1-score': 0.4543132897748002, 'support': 55311}, '1': {'precision': 0.8268275846712241, 'recall': 0.7141236157748776, 'f1-score': 0.7663540600336822, 'support': 259983}, '2': {'precision': 0.31827970726187654, 'recall': 0.6461586913429297, 'f1-score': 0.4264848836853851, 'support': 53979}, 'accuracy': 0.6528665783850972, 'macro avg': {'precision': 0.5765974280833288, 'recall': 0.577254522542189, 'f1-score': 0.5490507444979559, 'support': 369273}, 'weighted avg': {'precision': 0.7162209202240807, 'recall': 0.6528665783850972, 'f1-score': 0.669934648612068, 'support': 369273}}
[[ 20547  24399  10365]
 [  9981 185660  64342]
 [  4614  14486  34879]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8635114
{'0': {'precision': 0.6125467433164035, 'recall': 0.31186951209115965, 'f1-score': 0.4133087293816374, 'support': 70382}, '1': {'precision': 0.7413662256867668, 'recall': 0.6875540359124304, 'f1-score': 0.713446865103069, 'support': 230171}, '2': {'precision': 0.35023129818712234, 'recall': 0.6114522700814901, 'f1-score': 0.44536421208829063, 'support': 68720}, 'accuracy': 0.6017878371827888, 'macro avg': {'precision': 0.5680480890634308, 'recall': 0.5369586060283601, 'f1-score': 0.5240399355243323, 'support': 369273}, 'weighted avg': {'precision': 0.6440253287731921, 'recall': 0.6017878371827888, 'f1-score': 0.6063527580778563, 'support': 369273}}
[[ 21950  33852  14580]
 [  8540 158255  63376]
 [  5344  21357  42019]]
Evaluating performance on  train set...
641/641 - 11s - 11s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8282899
{'0': {'precision': 0.4222668295804969, 'recall': 0.5227804790203494, 'f1-score': 0.46717842256875713, 'support': 27765}, '1': {'precision': 0.8495669851118083, 'recall': 0.6600177102637369, 'f1-score': 0.7428920787908057, 'support': 109541}, '2': {'precision': 0.35098654708520177, 'recall': 0.584780903283649, 'f1-score': 0.43867785733301573, 'support': 26769}, 'accuracy': 0.6245192747219259, 'macro avg': {'precision': 0.5409401205925023, 'recall': 0.5891930308559118, 'f1-score': 0.5495827862308594, 'support': 164075}, 'weighted avg': {'precision': 0.6959147616538709, 'recall': 0.6245192747219259, 'f1-score': 0.6466025760682168, 'support': 164075}}
[[14515  7872  5378]
 [13674 72299 23568]
 [ 6185  4930 15654]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.85431165
{'0': {'precision': 0.49351315902027315, 'recall': 0.48549789621318373, 'f1-score': 0.4894727167319467, 'support': 35650}, '1': {'precision': 0.7677560820246466, 'recall': 0.6676715918654323, 'f1-score': 0.7142246659639325, 'support': 93871}, '2': {'precision': 0.41110407430863416, 'recall': 0.563581640331076, 'f1-score': 0.4754162394414336, 'support': 34554}, 'accuracy': 0.6061679110163035, 'macro avg': {'precision': 0.5574577717845179, 'recall': 0.572250376136564, 'f1-score': 0.5597045407124376, 'support': 164075}, 'weighted avg': {'precision': 0.633058451796245, 'recall': 0.6061679110163035, 'f1-score': 0.6150980875078683, 'support': 164075}}
[[17308 11442  6900]
 [10200 62675 20996]
 [ 7563  7517 19474]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8886814
{'0': {'precision': 0.5193124704967651, 'recall': 0.4585284526932601, 'f1-score': 0.4870312500000001, 'support': 40787}, '1': {'precision': 0.7012662105585622, 'recall': 0.6573578855426733, 'f1-score': 0.6786025283934758, 'support': 83577}, '2': {'precision': 0.4362202823926948, 'recall': 0.5461459041575382, 'f1-score': 0.48503281933153675, 'support': 39711}, 'accuracy': 0.5810147798262989, 'macro avg': {'precision': 0.5522663211493407, 'recall': 0.5540107474644905, 'f1-score': 0.5502221992416708, 'support': 164075}, 'weighted avg': {'precision': 0.5918858293347604, 'recall': 0.5810147798262989, 'f1-score': 0.5841307048469675, 'support': 164075}}
[[18702 13958  8127]
 [ 8734 54940 19903]
 [ 8577  9446 21688]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.93938065
{'0': {'precision': 0.5333549924193199, 'recall': 0.41057063065316163, 'f1-score': 0.46397701311853795, 'support': 47982}, '1': {'precision': 0.5951935414884517, 'recall': 0.6455962305183037, 'f1-score': 0.6193711706574125, 'support': 68975}, '2': {'precision': 0.46375398964126674, 'recall': 0.5149836580500021, 'f1-score': 0.4880280769501514, 'support': 47118}, 'accuracy': 0.5393570013713241, 'macro avg': {'precision': 0.5307675078496795, 'recall': 0.5237168397404891, 'f1-score': 0.5237920869087006, 'support': 164075}, 'weighted avg': {'precision': 0.539363548708499, 'recall': 0.5393570013713241, 'f1-score': 0.5362095289915341, 'support': 164075}}
[[19700 17638 10644]
 [ 7031 44530 17414]
 [10205 12648 24265]]
Evaluating performance on  val set...
274/274 - 5s - 5s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.75411713
{'0': {'precision': 0.43366747945452905, 'recall': 0.4877602844083291, 'f1-score': 0.45912611148293336, 'support': 9845}, '1': {'precision': 0.8626321075032279, 'recall': 0.7157424858644976, 'f1-score': 0.7823522395827687, 'support': 50405}, '2': {'precision': 0.3429500203169443, 'recall': 0.5984602917341977, 'f1-score': 0.4360308498468578, 'support': 9872}, 'accuracy': 0.6672228401928069, 'macro avg': {'precision': 0.5464165357582337, 'recall': 0.6006543540023415, 'f1-score': 0.55916973363752, 'support': 70122}, 'weighted avg': {'precision': 0.7292437510980707, 'recall': 0.6672228401928069, 'f1-score': 0.6882156492029193, 'support': 70122}}
[[ 4802  3438  1605]
 [ 4614 36077  9714]
 [ 1657  2307  5908]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7962606
{'0': {'precision': 0.5122737860598459, 'recall': 0.4391705069124424, 'f1-score': 0.4729137374906956, 'support': 13020}, '1': {'precision': 0.781854569713142, 'recall': 0.7198362147406734, 'f1-score': 0.7495647436428884, 'support': 43960}, '2': {'precision': 0.41169470438686645, 'recall': 0.5791355957997261, 'f1-score': 0.4812671915014701, 'support': 13142}, 'accuracy': 0.6413536407974673, 'macro avg': {'precision': 0.5686076867199514, 'recall': 0.5793807724842805, 'f1-score': 0.5679152242116847, 'support': 70122}, 'weighted avg': {'precision': 0.6624258204863113, 'recall': 0.6413536407974673, 'f1-score': 0.6479138704455456, 'support': 70122}}
[[ 5718  5247  2055]
 [ 3495 31644  8821]
 [ 1949  3582  7611]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.844044
{'0': {'precision': 0.5420908205718332, 'recall': 0.40451813197701303, 'f1-score': 0.4633076108337116, 'support': 15139}, '1': {'precision': 0.7140229885057471, 'recall': 0.7069981537216419, 'f1-score': 0.7104932074368716, 'support': 39539}, '2': {'precision': 0.4434561626429479, 'recall': 0.564944314944315, 'f1-score': 0.4968820296705487, 'support': 15444}, 'accuracy': 0.6104075753686432, 'macro avg': {'precision': 0.5665233239068427, 'recall': 0.5588202002143233, 'f1-score': 0.556894282647044, 'support': 70122}, 'weighted avg': {'precision': 0.6173127527883319, 'recall': 0.6104075753686432, 'f1-score': 0.6100803016954733, 'support': 70122}}
[[ 6124  6590  2425]
 [ 3060 27954  8525]
 [ 2113  4606  8725]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.91638315
{'0': {'precision': 0.5608025232171018, 'recall': 0.3499535290580067, 'f1-score': 0.4309712169668406, 'support': 18291}, '1': {'precision': 0.6024828244781029, 'recall': 0.6872938542076437, 'f1-score': 0.6420999067085065, 'support': 33047}, '2': {'precision': 0.4726069779618259, 'recall': 0.5285881601362862, 'f1-score': 0.4990324931520619, 'support': 18784}, 'accuracy': 0.5567867431048744, 'macro avg': {'precision': 0.5452974418856769, 'recall': 0.5219451811339789, 'f1-score': 0.5240345389424697, 'support': 70122}, 'weighted avg': {'precision': 0.5568200896541287, 'recall': 0.5567867431048744, 'f1-score': 0.5487036379154163, 'support': 70122}}
[[ 6401  8577  3313]
 [ 2567 22713  7767]
 [ 2446  6409  9929]]
training model: results/QRTEA/W4/deepLOB_L1/seq2seq
Epoch 1/50
634/634 - 20s - loss: 11.8557 - accuracy10: 0.4308 - accuracy20: 0.4436 - accuracy30: 0.4510 - accuracy50: 0.4592 - val_loss: 10.6111 - val_accuracy10: 0.3687 - val_accuracy20: 0.3839 - val_accuracy30: 0.3966 - val_accuracy50: 0.4150 - 20s/epoch - 32ms/step
Epoch 2/50
634/634 - 14s - loss: 11.3772 - accuracy10: 0.4831 - accuracy20: 0.4952 - accuracy30: 0.5011 - accuracy50: 0.5036 - val_loss: 10.2900 - val_accuracy10: 0.4028 - val_accuracy20: 0.4121 - val_accuracy30: 0.4190 - val_accuracy50: 0.4338 - 14s/epoch - 22ms/step
Epoch 3/50
634/634 - 15s - loss: 11.0687 - accuracy10: 0.5190 - accuracy20: 0.5272 - accuracy30: 0.5284 - accuracy50: 0.5251 - val_loss: 9.9690 - val_accuracy10: 0.4658 - val_accuracy20: 0.4745 - val_accuracy30: 0.4764 - val_accuracy50: 0.4811 - 15s/epoch - 24ms/step
Epoch 4/50
634/634 - 14s - loss: 10.6955 - accuracy10: 0.5744 - accuracy20: 0.5710 - accuracy30: 0.5633 - accuracy50: 0.5500 - val_loss: 9.7396 - val_accuracy10: 0.5327 - val_accuracy20: 0.5294 - val_accuracy30: 0.5181 - val_accuracy50: 0.5084 - 14s/epoch - 22ms/step
Epoch 5/50
634/634 - 14s - loss: 10.4087 - accuracy10: 0.6091 - accuracy20: 0.5990 - accuracy30: 0.5841 - accuracy50: 0.5639 - val_loss: 9.7395 - val_accuracy10: 0.5128 - val_accuracy20: 0.5057 - val_accuracy30: 0.4943 - val_accuracy50: 0.4880 - 14s/epoch - 22ms/step
Epoch 6/50
634/634 - 14s - loss: 10.2306 - accuracy10: 0.6254 - accuracy20: 0.6118 - accuracy30: 0.5934 - accuracy50: 0.5715 - val_loss: 9.4245 - val_accuracy10: 0.5660 - val_accuracy20: 0.5537 - val_accuracy30: 0.5342 - val_accuracy50: 0.5185 - 14s/epoch - 22ms/step
Epoch 7/50
634/634 - 14s - loss: 10.0536 - accuracy10: 0.6400 - accuracy20: 0.6229 - accuracy30: 0.6016 - accuracy50: 0.5764 - val_loss: 9.6255 - val_accuracy10: 0.5564 - val_accuracy20: 0.5445 - val_accuracy30: 0.5270 - val_accuracy50: 0.5135 - 14s/epoch - 22ms/step
Epoch 8/50
634/634 - 14s - loss: 9.9322 - accuracy10: 0.6459 - accuracy20: 0.6280 - accuracy30: 0.6065 - accuracy50: 0.5801 - val_loss: 9.4990 - val_accuracy10: 0.5640 - val_accuracy20: 0.5591 - val_accuracy30: 0.5456 - val_accuracy50: 0.5325 - 14s/epoch - 21ms/step
Epoch 9/50
634/634 - 15s - loss: 9.8503 - accuracy10: 0.6538 - accuracy20: 0.6353 - accuracy30: 0.6119 - accuracy50: 0.5849 - val_loss: 9.5162 - val_accuracy10: 0.5615 - val_accuracy20: 0.5485 - val_accuracy30: 0.5315 - val_accuracy50: 0.5155 - 15s/epoch - 24ms/step
Epoch 10/50
634/634 - 14s - loss: 9.7822 - accuracy10: 0.6576 - accuracy20: 0.6378 - accuracy30: 0.6142 - accuracy50: 0.5854 - val_loss: 9.3504 - val_accuracy10: 0.5902 - val_accuracy20: 0.5790 - val_accuracy30: 0.5621 - val_accuracy50: 0.5432 - 14s/epoch - 21ms/step
Epoch 11/50
634/634 - 15s - loss: 9.7272 - accuracy10: 0.6590 - accuracy20: 0.6398 - accuracy30: 0.6161 - accuracy50: 0.5878 - val_loss: 9.4733 - val_accuracy10: 0.5669 - val_accuracy20: 0.5547 - val_accuracy30: 0.5381 - val_accuracy50: 0.5225 - 15s/epoch - 24ms/step
Epoch 12/50
634/634 - 15s - loss: 9.6798 - accuracy10: 0.6622 - accuracy20: 0.6418 - accuracy30: 0.6180 - accuracy50: 0.5900 - val_loss: 9.6019 - val_accuracy10: 0.5809 - val_accuracy20: 0.5657 - val_accuracy30: 0.5512 - val_accuracy50: 0.5357 - 15s/epoch - 24ms/step
Epoch 13/50
634/634 - 15s - loss: 9.6417 - accuracy10: 0.6646 - accuracy20: 0.6436 - accuracy30: 0.6186 - accuracy50: 0.5901 - val_loss: 9.3123 - val_accuracy10: 0.6103 - val_accuracy20: 0.5922 - val_accuracy30: 0.5710 - val_accuracy50: 0.5504 - 15s/epoch - 23ms/step
Epoch 14/50
634/634 - 14s - loss: 9.5933 - accuracy10: 0.6651 - accuracy20: 0.6447 - accuracy30: 0.6208 - accuracy50: 0.5929 - val_loss: 9.6760 - val_accuracy10: 0.5736 - val_accuracy20: 0.5592 - val_accuracy30: 0.5431 - val_accuracy50: 0.5276 - 14s/epoch - 22ms/step
Epoch 15/50
634/634 - 15s - loss: 9.5760 - accuracy10: 0.6640 - accuracy20: 0.6444 - accuracy30: 0.6205 - accuracy50: 0.5929 - val_loss: 9.5632 - val_accuracy10: 0.5759 - val_accuracy20: 0.5626 - val_accuracy30: 0.5461 - val_accuracy50: 0.5307 - 15s/epoch - 24ms/step
Epoch 16/50
634/634 - 14s - loss: 9.5409 - accuracy10: 0.6656 - accuracy20: 0.6447 - accuracy30: 0.6213 - accuracy50: 0.5935 - val_loss: 9.5598 - val_accuracy10: 0.5715 - val_accuracy20: 0.5560 - val_accuracy30: 0.5383 - val_accuracy50: 0.5229 - 14s/epoch - 22ms/step
Epoch 17/50
634/634 - 15s - loss: 9.5128 - accuracy10: 0.6660 - accuracy20: 0.6449 - accuracy30: 0.6215 - accuracy50: 0.5944 - val_loss: 9.5296 - val_accuracy10: 0.5882 - val_accuracy20: 0.5710 - val_accuracy30: 0.5535 - val_accuracy50: 0.5339 - 15s/epoch - 23ms/step
Epoch 18/50
634/634 - 15s - loss: 9.4811 - accuracy10: 0.6675 - accuracy20: 0.6466 - accuracy30: 0.6221 - accuracy50: 0.5948 - val_loss: 9.5758 - val_accuracy10: 0.5656 - val_accuracy20: 0.5511 - val_accuracy30: 0.5361 - val_accuracy50: 0.5224 - 15s/epoch - 24ms/step
Epoch 19/50
634/634 - 15s - loss: 9.4397 - accuracy10: 0.6697 - accuracy20: 0.6480 - accuracy30: 0.6245 - accuracy50: 0.5959 - val_loss: 9.3643 - val_accuracy10: 0.5971 - val_accuracy20: 0.5776 - val_accuracy30: 0.5600 - val_accuracy50: 0.5420 - 15s/epoch - 23ms/step
Epoch 20/50
634/634 - 15s - loss: 9.4203 - accuracy10: 0.6694 - accuracy20: 0.6479 - accuracy30: 0.6240 - accuracy50: 0.5961 - val_loss: 9.4369 - val_accuracy10: 0.5828 - val_accuracy20: 0.5650 - val_accuracy30: 0.5502 - val_accuracy50: 0.5348 - 15s/epoch - 24ms/step
Epoch 21/50
634/634 - 15s - loss: 9.3863 - accuracy10: 0.6713 - accuracy20: 0.6502 - accuracy30: 0.6265 - accuracy50: 0.5985 - val_loss: 9.4160 - val_accuracy10: 0.5870 - val_accuracy20: 0.5702 - val_accuracy30: 0.5535 - val_accuracy50: 0.5364 - 15s/epoch - 23ms/step
Epoch 22/50
634/634 - 14s - loss: 9.3561 - accuracy10: 0.6718 - accuracy20: 0.6493 - accuracy30: 0.6261 - accuracy50: 0.5974 - val_loss: 9.5046 - val_accuracy10: 0.5893 - val_accuracy20: 0.5679 - val_accuracy30: 0.5486 - val_accuracy50: 0.5311 - 14s/epoch - 22ms/step
Epoch 23/50
634/634 - 14s - loss: 9.3332 - accuracy10: 0.6715 - accuracy20: 0.6493 - accuracy30: 0.6260 - accuracy50: 0.5976 - val_loss: 9.4578 - val_accuracy10: 0.5963 - val_accuracy20: 0.5745 - val_accuracy30: 0.5537 - val_accuracy50: 0.5331 - 14s/epoch - 22ms/step
testing model: results/QRTEA/W4/deepLOB_L1/seq2seq
Evaluating performance on  test set...
1613/1613 - 15s - 15s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.81652284
{'0': {'precision': 0.2158386908240795, 'recall': 0.5467547080421651, 'f1-score': 0.30949866747121235, 'support': 33772}, '1': {'precision': 0.9340995110330452, 'recall': 0.6272982842568977, 'f1-score': 0.750556997536207, 'support': 345040}, '2': {'precision': 0.2503086226016362, 'recall': 0.7029409172371243, 'f1-score': 0.36916288004443654, 'support': 34037}, 'accuracy': 0.6269459293833823, 'macro avg': {'precision': 0.4667489414862536, 'recall': 0.6256646365120623, 'f1-score': 0.47640618168395193, 'support': 412849}, 'weighted avg': {'precision': 0.8189695364185082, 'recall': 0.6269459293833823, 'f1-score': 0.683033681505352, 'support': 412849}}
[[ 18465   7954   7353]
 [ 64290 216443  64307]
 [  2795   7316  23926]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8373887
{'0': {'precision': 0.280732938336625, 'recall': 0.5514818407155944, 'f1-score': 0.3720652924710074, 'support': 46395}, '1': {'precision': 0.8979438944949728, 'recall': 0.6154192952521094, 'f1-score': 0.7303098191761686, 'support': 319405}, '2': {'precision': 0.31860894941634244, 'recall': 0.696146570596612, 'f1-score': 0.4371467277058905, 'support': 47049}, 'accuracy': 0.6174339770715201, 'macro avg': {'precision': 0.4990952607493134, 'recall': 0.6210159021881053, 'f1-score': 0.5131739464510221, 'support': 412849}, 'weighted avg': {'precision': 0.7625611464636805, 'recall': 0.6174339770715201, 'f1-score': 0.6566417586817238, 'support': 412849}}
[[ 25586  11401   9408]
 [ 62198 196568  60639]
 [  3356  10940  32753]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.86356527
{'0': {'precision': 0.3185791894760943, 'recall': 0.5496283262110819, 'f1-score': 0.4033601264988799, 'support': 55694}, '1': {'precision': 0.8660182200960626, 'recall': 0.5982634046985918, 'f1-score': 0.7076603299701207, 'support': 300473}, '2': {'precision': 0.3573220990933236, 'recall': 0.6883313926819802, 'f1-score': 0.47043503424327193, 'support': 56682}, 'accuracy': 0.604068315534251, 'macro avg': {'precision': 0.5139731695551601, 'recall': 0.6120743745305512, 'f1-score': 0.5271518302374242, 'support': 412849}, 'weighted avg': {'precision': 0.7223265001160559, 'recall': 0.604068315534251, 'f1-score': 0.6340399512250673, 'support': 412849}}
[[ 30611  14073  11010]
 [ 61547 179762  59164]
 [  3928  13738  39016]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.89531237
{'0': {'precision': 0.3758087760274313, 'recall': 0.5279014896617198, 'f1-score': 0.43905667607203813, 'support': 71627}, '1': {'precision': 0.8005263908120877, 'recall': 0.5856311822190442, 'f1-score': 0.6764212464296776, 'support': 268512}, '2': {'precision': 0.40640921573029826, 'recall': 0.6472699766194471, 'f1-score': 0.49931038872856903, 'support': 72710}, 'accuracy': 0.5864710826476508, 'macro avg': {'precision': 0.5275814608566057, 'recall': 0.5869342161667371, 'f1-score': 0.538262770410095, 'support': 412849}, 'weighted avg': {'precision': 0.6574292574912428, 'recall': 0.5864710826476508, 'f1-score': 0.6040474668045501, 'support': 412849}}
[[ 37812  19493  14322]
 [ 56846 157249  54417]
 [  5957  19690  47063]]
Evaluating performance on  train set...
634/634 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7844872
{'0': {'precision': 0.26724453988372704, 'recall': 0.6379719929982496, 'f1-score': 0.37669336680078264, 'support': 15996}, '1': {'precision': 0.916897566655526, 'recall': 0.6538050539295955, 'f1-score': 0.7633173271103532, 'support': 130077}, '2': {'precision': 0.3132460716228758, 'recall': 0.6074598150561659, 'f1-score': 0.41334459459459466, 'support': 16113}, 'accuracy': 0.6476391303811673, 'macro avg': {'precision': 0.4991293927207096, 'recall': 0.6330789539946703, 'f1-score': 0.5177850961685768, 'support': 162186}, 'weighted avg': {'precision': 0.792851802189402, 'recall': 0.6476391303811673, 'f1-score': 0.6904161672806619, 'support': 162186}}
[[10205  3472  2319]
 [25892 85045 19140]
 [ 2089  4236  9788]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8233539
{'0': {'precision': 0.3263137080429087, 'recall': 0.6149331594391914, 'f1-score': 0.4263729875498571, 'support': 21469}, '1': {'precision': 0.8674500480087788, 'recall': 0.6377250037815761, 'f1-score': 0.7350568088259508, 'support': 118998}, '2': {'precision': 0.37162714636140637, 'recall': 0.585938579124269, 'f1-score': 0.45480049318299587, 'support': 21719}, 'accuracy': 0.6277730506948812, 'macro avg': {'precision': 0.5217969674710313, 'recall': 0.6128655807816789, 'f1-score': 0.5387434298529347, 'support': 162186}, 'weighted avg': {'precision': 0.7294206639459957, 'recall': 0.6277730506948812, 'f1-score': 0.6566652098073809, 'support': 162186}}
[[13202  5262  3005]
 [24597 75888 18513]
 [ 2659  6334 12726]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8625387
{'0': {'precision': 0.3586426299045599, 'recall': 0.5935184462990406, 'f1-score': 0.44711135919620426, 'support': 25642}, '1': {'precision': 0.8235513883532588, 'recall': 0.6177566038076986, 'f1-score': 0.7059619616310422, 'support': 110618}, '2': {'precision': 0.3988851121685928, 'recall': 0.565802669135231, 'f1-score': 0.4679032232340792, 'support': 25926}, 'accuracy': 0.6056194739373312, 'macro avg': {'precision': 0.5270263768088038, 'recall': 0.5923592397473234, 'f1-score': 0.5403255146871085, 'support': 162186}, 'weighted avg': {'precision': 0.6821637947230738, 'recall': 0.6056194739373312, 'f1-score': 0.6269825306116337, 'support': 162186}}
[[15219  6672  3751]
 [23928 68335 18355]
 [ 3288  7969 14669]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9140314
{'0': {'precision': 0.4045413465883416, 'recall': 0.5508044421201588, 'f1-score': 0.46647648077950166, 'support': 32507}, '1': {'precision': 0.740211350890802, 'recall': 0.6005530106062482, 'f1-score': 0.6631085491652474, 'support': 96924}, '2': {'precision': 0.43185115426709764, 'recall': 0.5179972523278888, 'f1-score': 0.4710177113985898, 'support': 32755}, 'accuracy': 0.5739089687149322, 'macro avg': {'precision': 0.5255346172487472, 'recall': 0.556451568351432, 'f1-score': 0.5335342471144463, 'support': 162186}, 'weighted avg': {'precision': 0.6106566231691151, 'recall': 0.5739089687149322, 'f1-score': 0.5849029454876038, 'support': 162186}}
[[17905  9332  5270]
 [21664 58208 17052]
 [ 4691 11097 16967]]
Evaluating performance on  val set...
206/206 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8444043
{'0': {'precision': 0.21036988110964333, 'recall': 0.637478108581436, 'f1-score': 0.31634490036625496, 'support': 3997}, '1': {'precision': 0.9463450913727157, 'recall': 0.5993943472409152, 'f1-score': 0.7339321028345419, 'support': 44580}, '2': {'precision': 0.2383298336294621, 'recall': 0.7105706718035155, 'f1-score': 0.35693982461445417, 'support': 4153}, 'accuracy': 0.6110373601365446, 'macro avg': {'precision': 0.46501493537060706, 'recall': 0.6491477092086223, 'f1-score': 0.469072275938417, 'support': 52730}, 'weighted avg': {'precision': 0.8347941662669083, 'recall': 0.6110373601365446, 'f1-score': 0.6725866641902452, 'support': 52730}}
[[ 2548   725   724]
 [ 9152 26721  8707]
 [  412   790  2951]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.87605476
{'0': {'precision': 0.26286594761171034, 'recall': 0.6268601873966563, 'f1-score': 0.3704065570211149, 'support': 5443}, '1': {'precision': 0.9090356640966235, 'recall': 0.5759457118105689, 'f1-score': 0.7051336819621419, 'support': 41556}, '2': {'precision': 0.29312271812830637, 'recall': 0.6864421566916769, 'f1-score': 0.41081871345029236, 'support': 5731}, 'accuracy': 0.5932106959984829, 'macro avg': {'precision': 0.4883414432788801, 'recall': 0.6297493519663008, 'f1-score': 0.4954529841445164, 'support': 52730}, 'weighted avg': {'precision': 0.775394494740056, 'recall': 0.5932106959984829, 'f1-score': 0.6385939735305959, 'support': 52730}}
[[ 3412  1130   901]
 [ 9036 23934  8586]
 [  532  1265  3934]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9090755
{'0': {'precision': 0.2924494088634221, 'recall': 0.6124867081877563, 'f1-score': 0.3958762886597938, 'support': 6583}, '1': {'precision': 0.8733530627964486, 'recall': 0.549076080030585, 'f1-score': 0.6742511971456293, 'support': 39235}, '2': {'precision': 0.32123844214065567, 'recall': 0.6634837962962963, 'f1-score': 0.43288653955068906, 'support': 6912}, 'accuracy': 0.5719893798596625, 'macro avg': {'precision': 0.4956803046001754, 'recall': 0.6083488615048792, 'f1-score': 0.5010046751187041, 'support': 52730}, 'weighted avg': {'precision': 0.7284582209262807, 'recall': 0.5719893798596625, 'f1-score': 0.6078591141595022, 'support': 52730}}
[[ 4032  1469  1082]
 [ 9084 21543  8608]
 [  671  1655  4586]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.94287735
{'0': {'precision': 0.3375676801332778, 'recall': 0.5689050070191858, 'f1-score': 0.423716999215823, 'support': 8548}, '1': {'precision': 0.805538857878918, 'recall': 0.5318799081450402, 'f1-score': 0.6407117121732152, 'support': 35273}, '2': {'precision': 0.36437408540641214, 'recall': 0.6148838253451566, 'f1-score': 0.4575867685753665, 'support': 8909}, 'accuracy': 0.5519059358998673, 'macro avg': {'precision': 0.502493541139536, 'recall': 0.5718895801697942, 'f1-score': 0.5073384933214683, 'support': 52730}, 'weighted avg': {'precision': 0.6551395674308375, 'recall': 0.5519059358998673, 'f1-score': 0.5745950626592189, 'support': 52730}}
[[ 4863  2147  1538]
 [ 8494 18761  8018]
 [ 1049  2382  5478]]
training model: results/QRTEA/W4/deepOF_L1/seq2seq
Epoch 1/50
634/634 - 18s - loss: 12.3288 - accuracy10: 0.4258 - accuracy20: 0.4338 - accuracy30: 0.4337 - accuracy50: 0.4322 - val_loss: 10.5508 - val_accuracy10: 0.5964 - val_accuracy20: 0.5827 - val_accuracy30: 0.5655 - val_accuracy50: 0.5367 - 18s/epoch - 29ms/step
Epoch 2/50
634/634 - 14s - loss: 11.9029 - accuracy10: 0.4646 - accuracy20: 0.4570 - accuracy30: 0.4492 - accuracy50: 0.4436 - val_loss: 10.3799 - val_accuracy10: 0.6418 - val_accuracy20: 0.6098 - val_accuracy30: 0.5723 - val_accuracy50: 0.5339 - 14s/epoch - 22ms/step
Epoch 3/50
634/634 - 13s - loss: 11.7423 - accuracy10: 0.4997 - accuracy20: 0.4862 - accuracy30: 0.4742 - accuracy50: 0.4644 - val_loss: 10.2641 - val_accuracy10: 0.6807 - val_accuracy20: 0.6508 - val_accuracy30: 0.6210 - val_accuracy50: 0.5822 - 13s/epoch - 21ms/step
Epoch 4/50
634/634 - 14s - loss: 11.6040 - accuracy10: 0.5206 - accuracy20: 0.5040 - accuracy30: 0.4907 - accuracy50: 0.4793 - val_loss: 10.1968 - val_accuracy10: 0.6345 - val_accuracy20: 0.6033 - val_accuracy30: 0.5760 - val_accuracy50: 0.5500 - 14s/epoch - 22ms/step
Epoch 5/50
634/634 - 14s - loss: 11.4851 - accuracy10: 0.5273 - accuracy20: 0.5124 - accuracy30: 0.5002 - accuracy50: 0.4883 - val_loss: 10.1033 - val_accuracy10: 0.6913 - val_accuracy20: 0.6628 - val_accuracy30: 0.6336 - val_accuracy50: 0.5935 - 14s/epoch - 21ms/step
Epoch 6/50
634/634 - 14s - loss: 11.3874 - accuracy10: 0.5397 - accuracy20: 0.5256 - accuracy30: 0.5131 - accuracy50: 0.4982 - val_loss: 10.0118 - val_accuracy10: 0.6760 - val_accuracy20: 0.6539 - val_accuracy30: 0.6336 - val_accuracy50: 0.6018 - 14s/epoch - 22ms/step
Epoch 7/50
634/634 - 14s - loss: 11.3065 - accuracy10: 0.5461 - accuracy20: 0.5309 - accuracy30: 0.5181 - accuracy50: 0.5046 - val_loss: 9.9887 - val_accuracy10: 0.6657 - val_accuracy20: 0.6463 - val_accuracy30: 0.6276 - val_accuracy50: 0.5967 - 14s/epoch - 23ms/step
Epoch 8/50
634/634 - 14s - loss: 11.2149 - accuracy10: 0.5536 - accuracy20: 0.5389 - accuracy30: 0.5258 - accuracy50: 0.5112 - val_loss: 9.9162 - val_accuracy10: 0.6476 - val_accuracy20: 0.6270 - val_accuracy30: 0.6098 - val_accuracy50: 0.5853 - 14s/epoch - 22ms/step
Epoch 9/50
634/634 - 15s - loss: 11.1563 - accuracy10: 0.5566 - accuracy20: 0.5414 - accuracy30: 0.5284 - accuracy50: 0.5137 - val_loss: 9.8702 - val_accuracy10: 0.6653 - val_accuracy20: 0.6414 - val_accuracy30: 0.6228 - val_accuracy50: 0.5948 - 15s/epoch - 23ms/step
Epoch 10/50
634/634 - 15s - loss: 11.0787 - accuracy10: 0.5595 - accuracy20: 0.5456 - accuracy30: 0.5336 - accuracy50: 0.5196 - val_loss: 9.8440 - val_accuracy10: 0.6697 - val_accuracy20: 0.6461 - val_accuracy30: 0.6262 - val_accuracy50: 0.5978 - 15s/epoch - 24ms/step
Epoch 11/50
634/634 - 14s - loss: 11.0257 - accuracy10: 0.5631 - accuracy20: 0.5485 - accuracy30: 0.5361 - accuracy50: 0.5215 - val_loss: 9.8077 - val_accuracy10: 0.6683 - val_accuracy20: 0.6422 - val_accuracy30: 0.6215 - val_accuracy50: 0.5935 - 14s/epoch - 23ms/step
Epoch 12/50
634/634 - 13s - loss: 10.9490 - accuracy10: 0.5668 - accuracy20: 0.5517 - accuracy30: 0.5379 - accuracy50: 0.5229 - val_loss: 9.8181 - val_accuracy10: 0.6696 - val_accuracy20: 0.6424 - val_accuracy30: 0.6206 - val_accuracy50: 0.5891 - 13s/epoch - 21ms/step
Epoch 13/50
634/634 - 15s - loss: 10.8882 - accuracy10: 0.5668 - accuracy20: 0.5539 - accuracy30: 0.5417 - accuracy50: 0.5270 - val_loss: 9.7657 - val_accuracy10: 0.6829 - val_accuracy20: 0.6574 - val_accuracy30: 0.6337 - val_accuracy50: 0.6000 - 15s/epoch - 23ms/step
Epoch 14/50
634/634 - 14s - loss: 10.8325 - accuracy10: 0.5713 - accuracy20: 0.5578 - accuracy30: 0.5443 - accuracy50: 0.5288 - val_loss: 9.8036 - val_accuracy10: 0.6827 - val_accuracy20: 0.6552 - val_accuracy30: 0.6325 - val_accuracy50: 0.5994 - 14s/epoch - 22ms/step
Epoch 15/50
634/634 - 14s - loss: 10.7656 - accuracy10: 0.5776 - accuracy20: 0.5641 - accuracy30: 0.5493 - accuracy50: 0.5321 - val_loss: 9.7771 - val_accuracy10: 0.6879 - val_accuracy20: 0.6575 - val_accuracy30: 0.6330 - val_accuracy50: 0.5981 - 14s/epoch - 22ms/step
Epoch 16/50
634/634 - 14s - loss: 10.7158 - accuracy10: 0.5768 - accuracy20: 0.5639 - accuracy30: 0.5500 - accuracy50: 0.5337 - val_loss: 9.8015 - val_accuracy10: 0.7003 - val_accuracy20: 0.6696 - val_accuracy30: 0.6441 - val_accuracy50: 0.6056 - 14s/epoch - 22ms/step
Epoch 17/50
634/634 - 14s - loss: 10.6567 - accuracy10: 0.5824 - accuracy20: 0.5681 - accuracy30: 0.5533 - accuracy50: 0.5375 - val_loss: 9.7425 - val_accuracy10: 0.6909 - val_accuracy20: 0.6625 - val_accuracy30: 0.6387 - val_accuracy50: 0.6051 - 14s/epoch - 22ms/step
Epoch 18/50
634/634 - 14s - loss: 10.6127 - accuracy10: 0.5828 - accuracy20: 0.5694 - accuracy30: 0.5563 - accuracy50: 0.5397 - val_loss: 9.7956 - val_accuracy10: 0.6994 - val_accuracy20: 0.6704 - val_accuracy30: 0.6461 - val_accuracy50: 0.6083 - 14s/epoch - 22ms/step
Epoch 19/50
634/634 - 14s - loss: 10.5575 - accuracy10: 0.5837 - accuracy20: 0.5707 - accuracy30: 0.5576 - accuracy50: 0.5425 - val_loss: 9.7839 - val_accuracy10: 0.7084 - val_accuracy20: 0.6775 - val_accuracy30: 0.6516 - val_accuracy50: 0.6148 - 14s/epoch - 22ms/step
Epoch 20/50
634/634 - 14s - loss: 10.5219 - accuracy10: 0.5856 - accuracy20: 0.5723 - accuracy30: 0.5580 - accuracy50: 0.5423 - val_loss: 9.7650 - val_accuracy10: 0.7019 - val_accuracy20: 0.6713 - val_accuracy30: 0.6478 - val_accuracy50: 0.6103 - 14s/epoch - 22ms/step
Epoch 21/50
634/634 - 14s - loss: 10.4530 - accuracy10: 0.5885 - accuracy20: 0.5748 - accuracy30: 0.5607 - accuracy50: 0.5445 - val_loss: 9.7778 - val_accuracy10: 0.7067 - val_accuracy20: 0.6755 - val_accuracy30: 0.6464 - val_accuracy50: 0.6054 - 14s/epoch - 22ms/step
Epoch 22/50
634/634 - 14s - loss: 10.4029 - accuracy10: 0.5921 - accuracy20: 0.5796 - accuracy30: 0.5645 - accuracy50: 0.5477 - val_loss: 9.8209 - val_accuracy10: 0.6908 - val_accuracy20: 0.6580 - val_accuracy30: 0.6300 - val_accuracy50: 0.5923 - 14s/epoch - 23ms/step
Epoch 23/50
634/634 - 14s - loss: 10.3810 - accuracy10: 0.5934 - accuracy20: 0.5798 - accuracy30: 0.5649 - accuracy50: 0.5484 - val_loss: 9.7959 - val_accuracy10: 0.6948 - val_accuracy20: 0.6636 - val_accuracy30: 0.6393 - val_accuracy50: 0.6036 - 14s/epoch - 22ms/step
Epoch 24/50
634/634 - 13s - loss: 10.3208 - accuracy10: 0.5940 - accuracy20: 0.5812 - accuracy30: 0.5669 - accuracy50: 0.5510 - val_loss: 9.8086 - val_accuracy10: 0.6971 - val_accuracy20: 0.6683 - val_accuracy30: 0.6457 - val_accuracy50: 0.6087 - 13s/epoch - 21ms/step
Epoch 25/50
634/634 - 14s - loss: 10.2894 - accuracy10: 0.5953 - accuracy20: 0.5824 - accuracy30: 0.5675 - accuracy50: 0.5516 - val_loss: 9.8268 - val_accuracy10: 0.6836 - val_accuracy20: 0.6552 - val_accuracy30: 0.6303 - val_accuracy50: 0.5954 - 14s/epoch - 21ms/step
Epoch 26/50
634/634 - 12s - loss: 10.2360 - accuracy10: 0.5969 - accuracy20: 0.5833 - accuracy30: 0.5693 - accuracy50: 0.5531 - val_loss: 9.8624 - val_accuracy10: 0.7018 - val_accuracy20: 0.6718 - val_accuracy30: 0.6453 - val_accuracy50: 0.6060 - 12s/epoch - 20ms/step
Epoch 27/50
634/634 - 12s - loss: 10.1621 - accuracy10: 0.5998 - accuracy20: 0.5874 - accuracy30: 0.5733 - accuracy50: 0.5576 - val_loss: 9.9120 - val_accuracy10: 0.6991 - val_accuracy20: 0.6670 - val_accuracy30: 0.6400 - val_accuracy50: 0.6013 - 12s/epoch - 19ms/step
testing model: results/QRTEA/W4/deepOF_L1/seq2seq
Evaluating performance on  test set...
1613/1613 - 15s - 15s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7741169
{'0': {'precision': 0.2329424963401787, 'recall': 0.5041603742856297, 'f1-score': 0.31865396492672793, 'support': 33771}, '1': {'precision': 0.9193256305284908, 'recall': 0.6885763307229928, 'f1-score': 0.7873936156109976, 'support': 345038}, '2': {'precision': 0.24189621249385146, 'recall': 0.5779468797743565, 'f1-score': 0.3410485800478519, 'support': 34036}, 'accuracy': 0.664370405357943, 'macro avg': {'precision': 0.4647214464541736, 'recall': 0.5902278615943264, 'f1-score': 0.48236538686185915, 'support': 412845}, 'weighted avg': {'precision': 0.8073300086924495, 'recall': 0.664370405357943, 'f1-score': 0.71225256661274, 'support': 412845}}
[[ 17026  10780   5965]
 [ 51769 237585  55684]
 [  4296  10069  19671]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.80626076
{'0': {'precision': 0.29942763695829927, 'recall': 0.5130620338836919, 'f1-score': 0.37815853648849385, 'support': 46394}, '1': {'precision': 0.877922726268322, 'recall': 0.6717062770230712, 'f1-score': 0.7610934032895752, 'support': 319403}, '2': {'precision': 0.30654587960257157, 'recall': 0.5797058323414386, 'f1-score': 0.40102926040288195, 'support': 47048}, 'accuracy': 0.6433940098584214, 'macro avg': {'precision': 0.49463208094306427, 'recall': 0.5881580477494005, 'f1-score': 0.5134270667269837, 'support': 412845}, 'weighted avg': {'precision': 0.7477992197334739, 'recall': 0.6433940098584214, 'f1-score': 0.677027523831419, 'support': 412845}}
[[ 23803  15308   7283]
 [ 50443 214545  54415]
 [  5249  14525  27274]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8358657
{'0': {'precision': 0.3408325887119478, 'recall': 0.4999730666331496, 'f1-score': 0.4053424557828081, 'support': 55693}, '1': {'precision': 0.838169327902755, 'recall': 0.6622902043791248, 'f1-score': 0.7399217686821891, 'support': 300471}, '2': {'precision': 0.3438603604084202, 'recall': 0.5686032356521585, 'f1-score': 0.4285543322163715, 'support': 56681}, 'accuracy': 0.6275309135389795, 'macro avg': {'precision': 0.5076207590077076, 'recall': 0.5769555022214776, 'f1-score': 0.5246061855604562, 'support': 412845}, 'weighted avg': {'precision': 0.70321286336449, 'recall': 0.6275309135389795, 'f1-score': 0.6520380754326056, 'support': 412845}}
[[ 27845  19678   8170]
 [ 48144 198999  53328]
 [  5708  18744  32229]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.87558484
{'0': {'precision': 0.4067887602337754, 'recall': 0.4654669328605135, 'f1-score': 0.43415415467555635, 'support': 71627}, '1': {'precision': 0.7612599087196733, 'recall': 0.6609474507467133, 'f1-score': 0.7075660137389911, 'support': 268510}, '2': {'precision': 0.3925816812946255, 'recall': 0.5278373769048798, 'f1-score': 0.45027160841458114, 'support': 72708}, 'accuracy': 0.6035897249573084, 'macro avg': {'precision': 0.5202101167493581, 'recall': 0.5514172535040355, 'f1-score': 0.5306639256097095, 'support': 412845}, 'weighted avg': {'precision': 0.6348309547243003, 'recall': 0.6035897249573084, 'f1-score': 0.6148168394690742, 'support': 412845}}
[[ 33340  28191  10096]
 [ 41755 177471  49284]
 [  6864  27466  38378]]
Evaluating performance on  train set...
634/634 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.78620094
{'0': {'precision': 0.2906292142222807, 'recall': 0.5500155617802677, 'f1-score': 0.3803047258328312, 'support': 16065}, '1': {'precision': 0.9070161492762112, 'recall': 0.6667230482985561, 'f1-score': 0.768524508804736, 'support': 130066}, '2': {'precision': 0.26615065653075326, 'recall': 0.599688570538773, 'f1-score': 0.3686770055523645, 'support': 16055}, 'accuracy': 0.6485269998643532, 'macro avg': {'precision': 0.487932006676415, 'recall': 0.6054757268725323, 'f1-score': 0.505835413396644, 'support': 162186}, 'weighted avg': {'precision': 0.7825211151939246, 'recall': 0.6485269998643532, 'f1-score': 0.6904887814413355, 'support': 162186}}
[[ 8836  4551  2678]
 [19479 86718 23869]
 [ 2088  4339  9628]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8187162
{'0': {'precision': 0.35242736300110333, 'recall': 0.535036292573981, 'f1-score': 0.42494456762749444, 'support': 21492}, '1': {'precision': 0.8582603011400778, 'recall': 0.6508759400075621, 'f1-score': 0.7403188195267404, 'support': 119015}, '2': {'precision': 0.32655657616854533, 'recall': 0.5920014760828451, 'f1-score': 0.42092489340767464, 'support': 21679}, 'accuracy': 0.627655901249183, 'macro avg': {'precision': 0.5124147467699088, 'recall': 0.5926379028881293, 'f1-score': 0.5287294268539698, 'support': 162186}, 'weighted avg': {'precision': 0.7201585749729568, 'recall': 0.627655901249183, 'f1-score': 0.6558345585784846, 'support': 162186}}
[[11499  6486  3507]
 [18591 77464 22960]
 [ 2538  6307 12834]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8522401
{'0': {'precision': 0.3901174226619777, 'recall': 0.5098344693281402, 'f1-score': 0.44201320299177765, 'support': 25675}, '1': {'precision': 0.8123409888908075, 'recall': 0.6380166185951048, 'f1-score': 0.7147024267714621, 'support': 110599}, '2': {'precision': 0.3603323197739842, 'recall': 0.580811979005866, 'f1-score': 0.4447465240325655, 'support': 25912}, 'accuracy': 0.6085852046415844, 'macro avg': {'precision': 0.5209302437755898, 'recall': 0.5762210223097037, 'f1-score': 0.5338207179319351, 'support': 162186}, 'weighted avg': {'precision': 0.673284358250183, 'recall': 0.6085852046415844, 'f1-score': 0.6284040214077828, 'support': 162186}}
[[13090  8315  4270]
 [17588 70564 22447]
 [ 2876  7986 15050]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.90257615
{'0': {'precision': 0.43984407300218537, 'recall': 0.457783925003842, 'f1-score': 0.4486347274726268, 'support': 32535}, '1': {'precision': 0.7224848635647342, 'recall': 0.6293100779193973, 'f1-score': 0.6726863547607753, 'support': 96895}, '2': {'precision': 0.40034149117814455, 'recall': 0.5368482110147759, 'f1-score': 0.4586533821937638, 'support': 32756}, 'accuracy': 0.5762272945876956, 'macro avg': {'precision': 0.520890142581688, 'recall': 0.5413140713126717, 'f1-score': 0.5266581548090553, 'support': 162186}, 'weighted avg': {'precision': 0.600724376057504, 'recall': 0.5762272945876956, 'f1-score': 0.5845136164034267, 'support': 162186}}
[[14894 11970  5671]
 [15249 60977 20669]
 [ 3719 11452 17585]]
Evaluating performance on  val set...
206/206 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.73635775
{'0': {'precision': 0.24649122807017543, 'recall': 0.4900348779272546, 'f1-score': 0.327997331999333, 'support': 4014}, '1': {'precision': 0.9187607081667618, 'recall': 0.7220925535257418, 'f1-score': 0.8086405790545125, 'support': 44558}, '2': {'precision': 0.24031246787953542, 'recall': 0.5624248255953813, 'f1-score': 0.3367420423448077, 'support': 4157}, 'accuracy': 0.6918394052608622, 'macro avg': {'precision': 0.4685214680388243, 'recall': 0.5915174190161259, 'f1-score': 0.49112665113288445, 'support': 52729}, 'weighted avg': {'precision': 0.8140972586801094, 'recall': 0.6918394052608622, 'f1-score': 0.7348484682467648, 'support': 52729}}
[[ 1967  1449   598]
 [ 5590 32175  6793]
 [  423  1396  2338]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7795694
{'0': {'precision': 0.30131004366812225, 'recall': 0.48039574935873947, 'f1-score': 0.37033898305084745, 'support': 5458}, '1': {'precision': 0.8751611452555839, 'recall': 0.7028217845620456, 'f1-score': 0.7795804457263416, 'support': 41534}, '2': {'precision': 0.29657046476761617, 'recall': 0.5516820637964093, 'f1-score': 0.38576391004936317, 'support': 5737}, 'accuracy': 0.6633541315025887, 'macro avg': {'precision': 0.4910138845637741, 'recall': 0.5782998659057315, 'f1-score': 0.5118944462755174, 'support': 52729}, 'weighted avg': {'precision': 0.7528099903612404, 'recall': 0.6633541315025887, 'f1-score': 0.6943718248827513, 'support': 52729}}
[[ 2622  2079   757]
 [ 5593 29191  6750]
 [  487  2085  3165]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8187415
{'0': {'precision': 0.340118838028169, 'recall': 0.4674833635813672, 'f1-score': 0.39375796178343947, 'support': 6612}, '1': {'precision': 0.8352321981424149, 'recall': 0.688056313601469, 'f1-score': 0.7545343942720496, 'support': 39209}, '2': {'precision': 0.32527995767568996, 'recall': 0.5340185292414592, 'f1-score': 0.40429612581511315, 'support': 6908}, 'accuracy': 0.6402169584099832, 'macro avg': {'precision': 0.5002103312820912, 'recall': 0.5631860688080984, 'f1-score': 0.5175294939568674, 'support': 52729}, 'weighted avg': {'precision': 0.7063384278410717, 'recall': 0.6402169584099832, 'f1-score': 0.663409970707878, 'support': 52729}}
[[ 3091  2653   868]
 [ 5447 26978  6784]
 [  550  2669  3689]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8730689
{'0': {'precision': 0.39101587992168807, 'recall': 0.4196824655615223, 'f1-score': 0.40484234234234234, 'support': 8566}, '1': {'precision': 0.7597449966697326, 'recall': 0.6798932788374206, 'f1-score': 0.7176045895058494, 'support': 35232}, '2': {'precision': 0.3695652173913043, 'recall': 0.4968088679879073, 'f1-score': 0.4238429574437598, 'support': 8931}, 'accuracy': 0.6066111627377724, 'macro avg': {'precision': 0.5067753646609083, 'recall': 0.53212820412895, 'f1-score': 0.5154299630973173, 'support': 52729}, 'weighted avg': {'precision': 0.6337568455043512, 'recall': 0.6066111627377724, 'f1-score': 0.6170393114776463, 'support': 52729}}
[[ 3595  3831  1140]
 [ 4849 23954  6429]
 [  750  3744  4437]]
training model: results/QRTEA/W4/deepLOB_L2/seq2seq
Epoch 1/50
634/634 - 36s - loss: 11.8903 - accuracy10: 0.4315 - accuracy20: 0.4476 - accuracy30: 0.4540 - accuracy50: 0.4595 - val_loss: 10.7617 - val_accuracy10: 0.4408 - val_accuracy20: 0.4543 - val_accuracy30: 0.4608 - val_accuracy50: 0.4609 - 36s/epoch - 56ms/step
Epoch 2/50
634/634 - 30s - loss: 11.1718 - accuracy10: 0.4945 - accuracy20: 0.5130 - accuracy30: 0.5204 - accuracy50: 0.5189 - val_loss: 10.3072 - val_accuracy10: 0.5975 - val_accuracy20: 0.5953 - val_accuracy30: 0.5876 - val_accuracy50: 0.5669 - 30s/epoch - 47ms/step
Epoch 3/50
634/634 - 29s - loss: 10.6822 - accuracy10: 0.5602 - accuracy20: 0.5642 - accuracy30: 0.5605 - accuracy50: 0.5495 - val_loss: 10.1790 - val_accuracy10: 0.6595 - val_accuracy20: 0.6472 - val_accuracy30: 0.6312 - val_accuracy50: 0.5992 - 29s/epoch - 45ms/step
Epoch 4/50
634/634 - 29s - loss: 10.2680 - accuracy10: 0.6158 - accuracy20: 0.6103 - accuracy30: 0.5974 - accuracy50: 0.5768 - val_loss: 10.0333 - val_accuracy10: 0.6459 - val_accuracy20: 0.6288 - val_accuracy30: 0.6074 - val_accuracy50: 0.5768 - 29s/epoch - 45ms/step
Epoch 5/50
634/634 - 31s - loss: 9.9502 - accuracy10: 0.6508 - accuracy20: 0.6389 - accuracy30: 0.6188 - accuracy50: 0.5920 - val_loss: 9.8457 - val_accuracy10: 0.6653 - val_accuracy20: 0.6489 - val_accuracy30: 0.6286 - val_accuracy50: 0.5974 - 31s/epoch - 49ms/step
Epoch 6/50
634/634 - 30s - loss: 9.7642 - accuracy10: 0.6680 - accuracy20: 0.6527 - accuracy30: 0.6296 - accuracy50: 0.5992 - val_loss: 9.6485 - val_accuracy10: 0.6680 - val_accuracy20: 0.6541 - val_accuracy30: 0.6341 - val_accuracy50: 0.6027 - 30s/epoch - 48ms/step
Epoch 7/50
634/634 - 29s - loss: 9.6230 - accuracy10: 0.6760 - accuracy20: 0.6582 - accuracy30: 0.6342 - accuracy50: 0.6034 - val_loss: 9.7315 - val_accuracy10: 0.6390 - val_accuracy20: 0.6297 - val_accuracy30: 0.6138 - val_accuracy50: 0.5873 - 29s/epoch - 46ms/step
Epoch 8/50
634/634 - 30s - loss: 9.5190 - accuracy10: 0.6788 - accuracy20: 0.6616 - accuracy30: 0.6362 - accuracy50: 0.6040 - val_loss: 10.0374 - val_accuracy10: 0.6299 - val_accuracy20: 0.6197 - val_accuracy30: 0.6056 - val_accuracy50: 0.5809 - 30s/epoch - 47ms/step
Epoch 9/50
634/634 - 29s - loss: 9.4095 - accuracy10: 0.6849 - accuracy20: 0.6677 - accuracy30: 0.6401 - accuracy50: 0.6082 - val_loss: 9.6702 - val_accuracy10: 0.6527 - val_accuracy20: 0.6437 - val_accuracy30: 0.6284 - val_accuracy50: 0.6019 - 29s/epoch - 45ms/step
Epoch 10/50
634/634 - 29s - loss: 9.3020 - accuracy10: 0.6860 - accuracy20: 0.6675 - accuracy30: 0.6409 - accuracy50: 0.6094 - val_loss: 9.7608 - val_accuracy10: 0.6469 - val_accuracy20: 0.6366 - val_accuracy30: 0.6205 - val_accuracy50: 0.5943 - 29s/epoch - 45ms/step
Epoch 11/50
634/634 - 29s - loss: 9.2227 - accuracy10: 0.6880 - accuracy20: 0.6695 - accuracy30: 0.6444 - accuracy50: 0.6126 - val_loss: 9.6837 - val_accuracy10: 0.6549 - val_accuracy20: 0.6455 - val_accuracy30: 0.6304 - val_accuracy50: 0.6048 - 29s/epoch - 46ms/step
Epoch 12/50
634/634 - 29s - loss: 9.1397 - accuracy10: 0.6876 - accuracy20: 0.6701 - accuracy30: 0.6441 - accuracy50: 0.6138 - val_loss: 9.7025 - val_accuracy10: 0.6730 - val_accuracy20: 0.6605 - val_accuracy30: 0.6421 - val_accuracy50: 0.6127 - 29s/epoch - 45ms/step
Epoch 13/50
634/634 - 29s - loss: 9.0602 - accuracy10: 0.6904 - accuracy20: 0.6727 - accuracy30: 0.6472 - accuracy50: 0.6160 - val_loss: 9.8167 - val_accuracy10: 0.6933 - val_accuracy20: 0.6773 - val_accuracy30: 0.6575 - val_accuracy50: 0.6239 - 29s/epoch - 45ms/step
Epoch 14/50
634/634 - 30s - loss: 8.9829 - accuracy10: 0.6927 - accuracy20: 0.6733 - accuracy30: 0.6479 - accuracy50: 0.6169 - val_loss: 9.9202 - val_accuracy10: 0.7065 - val_accuracy20: 0.6879 - val_accuracy30: 0.6668 - val_accuracy50: 0.6309 - 30s/epoch - 47ms/step
Epoch 15/50
634/634 - 30s - loss: 8.9335 - accuracy10: 0.6923 - accuracy20: 0.6738 - accuracy30: 0.6477 - accuracy50: 0.6165 - val_loss: 10.2126 - val_accuracy10: 0.6809 - val_accuracy20: 0.6651 - val_accuracy30: 0.6456 - val_accuracy50: 0.6135 - 30s/epoch - 47ms/step
Epoch 16/50
634/634 - 29s - loss: 8.8661 - accuracy10: 0.6903 - accuracy20: 0.6728 - accuracy30: 0.6488 - accuracy50: 0.6180 - val_loss: 9.9314 - val_accuracy10: 0.6693 - val_accuracy20: 0.6522 - val_accuracy30: 0.6324 - val_accuracy50: 0.6029 - 29s/epoch - 46ms/step
testing model: results/QRTEA/W4/deepLOB_L2/seq2seq
Evaluating performance on  test set...
1613/1613 - 26s - 26s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0822461
{'0': {'precision': 0.18354198473282443, 'recall': 0.5339630463105531, 'f1-score': 0.2731817424368666, 'support': 33772}, '1': {'precision': 0.9442966558288348, 'recall': 0.5277677950382564, 'f1-score': 0.6771026412807246, 'support': 345040}, '2': {'precision': 0.20505765629619896, 'recall': 0.733525281311514, 'f1-score': 0.3205150423959998, 'support': 34037}, 'accuracy': 0.5452380894709689, 'macro avg': {'precision': 0.44429876561928605, 'recall': 0.5984187075534412, 'f1-score': 0.4235998087045303, 'support': 412849}, 'weighted avg': {'precision': 0.8211192118254661, 'recall': 0.5452380894709689, 'f1-score': 0.614662405991323, 'support': 412849}}
[[ 18033   5435  10304]
 [ 76454 182101  86485]
 [  3763   5307  24967]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0703446
{'0': {'precision': 0.24303848517437393, 'recall': 0.545554477853217, 'f1-score': 0.33627166382133533, 'support': 46395}, '1': {'precision': 0.908537081982701, 'recall': 0.5238740783644589, 'f1-score': 0.6645564341571712, 'support': 319405}, '2': {'precision': 0.27131179134680244, 'recall': 0.718123658313673, 'f1-score': 0.39383148483806485, 'support': 47049}, 'accuracy': 0.5484474953312228, 'macro avg': {'precision': 0.4742957861679591, 'recall': 0.5958507381771162, 'f1-score': 0.4648865276055238, 'support': 412849}, 'weighted avg': {'precision': 0.7611305965653917, 'recall': 0.5484474953312228, 'f1-score': 0.5968122708910721, 'support': 412849}}
[[ 25311   8186  12898]
 [ 74230 167328  77847]
 [  4603   8659  33787]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.072961
{'0': {'precision': 0.2788638539135557, 'recall': 0.5440083312385535, 'f1-score': 0.3687188910929647, 'support': 55694}, '1': {'precision': 0.8753980891719745, 'recall': 0.5122922858293424, 'f1-score': 0.6463396967960144, 'support': 300473}, '2': {'precision': 0.31088103084270147, 'recall': 0.704015384072545, 'f1-score': 0.4313051560988528, 'support': 56682}, 'accuracy': 0.5428934065481569, 'macro avg': {'precision': 0.48838099130941054, 'recall': 0.586772000380147, 'f1-score': 0.48212124799594397, 'support': 412849}, 'weighted avg': {'precision': 0.7174194248208382, 'recall': 0.5428934065481569, 'f1-score': 0.5793650862516697, 'support': 412849}}
[[ 30298  10403  14993]
 [ 73080 153930  73463]
 [  5270  11507  39905]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0655895
{'0': {'precision': 0.33341653221133705, 'recall': 0.522191352422969, 'f1-score': 0.40697902158774374, 'support': 71627}, '1': {'precision': 0.8076365106544902, 'recall': 0.5058917292337027, 'f1-score': 0.6221055909723748, 'support': 268512}, '2': {'precision': 0.36182402850327605, 'recall': 0.6592353183881172, 'f1-score': 0.46721511214215394, 'support': 72710}, 'accuracy': 0.5357261371591066, 'macro avg': {'precision': 0.5009590237897011, 'recall': 0.5624394666815963, 'f1-score': 0.4987665749007575, 'support': 412849}, 'weighted avg': {'precision': 0.6468465366611839, 'recall': 0.5357261371591066, 'f1-score': 0.557503381687483, 'support': 412849}}
[[ 37403  15021  19203]
 [ 67334 135838  65340]
 [  7444  17333  47933]]
Evaluating performance on  train set...
634/634 - 11s - 11s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7716933
{'0': {'precision': 0.2829429644198105, 'recall': 0.5935858964741185, 'f1-score': 0.38321830730112605, 'support': 15996}, '1': {'precision': 0.9177966283229441, 'recall': 0.6587713431275322, 'f1-score': 0.7670054555300456, 'support': 130077}, '2': {'precision': 0.2945663887470932, 'recall': 0.6446347669583566, 'f1-score': 0.40436009732360095, 'support': 16113}, 'accuracy': 0.6509378121416152, 'macro avg': {'precision': 0.4984353271632826, 'recall': 0.6323306688533358, 'f1-score': 0.5181946200515909, 'support': 162186}, 'weighted avg': {'precision': 0.7932653613943546, 'recall': 0.6509378121416152, 'f1-score': 0.6931250720206783, 'support': 162186}}
[[ 9495  3764  2737]
 [22248 85691 22138]
 [ 1815  3911 10387]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.80096984
{'0': {'precision': 0.34354874528092383, 'recall': 0.5764590805347245, 'f1-score': 0.43052197658845426, 'support': 21469}, '1': {'precision': 0.8689229116304056, 'recall': 0.6524479403015176, 'f1-score': 0.7452843772498199, 'support': 118998}, '2': {'precision': 0.36210268948655255, 'recall': 0.6137022883189833, 'f1-score': 0.45546652086999606, 'support': 21719}, 'accuracy': 0.6372004981934323, 'macro avg': {'precision': 0.5248581154659607, 'recall': 0.6142031030517418, 'f1-score': 0.5437576249027568, 'support': 162186}, 'weighted avg': {'precision': 0.7315073123672178, 'recall': 0.6372004981934323, 'f1-score': 0.6648077146370651, 'support': 162186}}
[[12376  5623  3470]
 [21347 77640 20011]
 [ 2301  6089 13329]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8376931
{'0': {'precision': 0.37601844332084566, 'recall': 0.5597457296622729, 'f1-score': 0.44984564273737326, 'support': 25642}, '1': {'precision': 0.8260900058445354, 'recall': 0.6388833643710788, 'f1-score': 0.7205252640593777, 'support': 110618}, '2': {'precision': 0.39584037436630704, 'recall': 0.5872868934660187, 'f1-score': 0.472923234613533, 'support': 25926}, 'accuracy': 0.6181236358255336, 'macro avg': {'precision': 0.532649607843896, 'recall': 0.5953053291664568, 'f1-score': 0.547764713803428, 'support': 162186}, 'weighted avg': {'precision': 0.6861556899853553, 'recall': 0.6181236358255336, 'f1-score': 0.6381501079709865, 'support': 162186}}
[[14353  7052  4237]
 [20944 70672 19002]
 [ 2874  7826 15226]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.89444566
{'0': {'precision': 0.420977835398539, 'recall': 0.5194265850432215, 'f1-score': 0.4650490250082626, 'support': 32507}, '1': {'precision': 0.7443757815630045, 'recall': 0.6325781024307705, 'f1-score': 0.6839384018160422, 'support': 96924}, '2': {'precision': 0.43487786451775373, 'recall': 0.5272172187452298, 'f1-score': 0.4766162975229421, 'support': 32755}, 'accuracy': 0.5886204727904998, 'macro avg': {'precision': 0.5334104938264325, 'recall': 0.5597406354064073, 'f1-score': 0.541867908115749, 'support': 162186}, 'weighted avg': {'precision': 0.6170509735722688, 'recall': 0.5886204727904998, 'f1-score': 0.598195658928179, 'support': 162186}}
[[16885  9853  5769]
 [18940 61312 16672]
 [ 4284 11202 17269]]
Evaluating performance on  val set...
206/206 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.749776
{'0': {'precision': 0.24855838539163863, 'recall': 0.5176382286715037, 'f1-score': 0.33584936287638995, 'support': 3997}, '1': {'precision': 0.9274154146818127, 'recall': 0.6812696276357111, 'f1-score': 0.7855110697289469, 'support': 44580}, '2': {'precision': 0.23666151998627552, 'recall': 0.6643390320250422, 'f1-score': 0.34899753336284867, 'support': 4153}, 'accuracy': 0.667532713825147, 'macro avg': {'precision': 0.4708784400199089, 'recall': 0.6210822961107523, 'f1-score': 0.4901193219893951, 'support': 52730}, 'weighted avg': {'precision': 0.8215536192950615, 'recall': 0.667532713825147, 'f1-score': 0.7170464659205251, 'support': 52730}}
[[ 2069  1265   663]
 [ 5973 30371  8236]
 [  282  1112  2759]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.78376323
{'0': {'precision': 0.3059461853615325, 'recall': 0.5076244717986405, 'f1-score': 0.38178803371562803, 'support': 5443}, '1': {'precision': 0.8870192307692307, 'recall': 0.6748483973433439, 'f1-score': 0.7665227136062974, 'support': 41556}, '2': {'precision': 0.30042208060912023, 'recall': 0.6333973128598849, 'f1-score': 0.4075446278208151, 'support': 5731}, 'accuracy': 0.6530817371515266, 'macro avg': {'precision': 0.4977958322466278, 'recall': 0.6052900606672897, 'f1-score': 0.5186184583809135, 'support': 52730}, 'weighted avg': {'precision': 0.7632838077894906, 'recall': 0.6530817371515266, 'f1-score': 0.6877930668723413, 'support': 52730}}
[[ 2763  1829   851]
 [ 5910 28044  7602]
 [  358  1743  3630]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8228059
{'0': {'precision': 0.33752860411899316, 'recall': 0.4929363512076561, 'f1-score': 0.40069148607766875, 'support': 6583}, '1': {'precision': 0.8503694983977503, 'recall': 0.6628265579202243, 'f1-score': 0.7449761519400719, 'support': 39235}, '2': {'precision': 0.3346896441678634, 'recall': 0.6069155092592593, 'f1-score': 0.4314511981898591, 'support': 6912}, 'accuracy': 0.6342878816612934, 'macro avg': {'precision': 0.507529248894869, 'recall': 0.5875594727957132, 'f1-score': 0.5257062787358665, 'support': 52730}, 'weighted avg': {'precision': 0.7187478264942032, 'recall': 0.6342878816612934, 'f1-score': 0.660896682270175, 'support': 52730}}
[[ 3245  2311  1027]
 [ 5917 26006  7312]
 [  452  2265  4195]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8810478
{'0': {'precision': 0.38117693290107085, 'recall': 0.4539073467477773, 'f1-score': 0.4143749666257276, 'support': 8548}, '1': {'precision': 0.7764389094580949, 'recall': 0.6539846341394268, 'f1-score': 0.7099702999245957, 'support': 35273}, '2': {'precision': 0.37746281442255275, 'recall': 0.5440565720058368, 'f1-score': 0.4457011494252874, 'support': 8909}, 'accuracy': 0.6029774322017827, 'macro avg': {'precision': 0.5116928855939061, 'recall': 0.5506495176310137, 'f1-score': 0.5233488053252036, 'support': 52730}, 'weighted avg': {'precision': 0.6449544147438698, 'recall': 0.6029774322017827, 'f1-score': 0.6174020698688957, 'support': 52730}}
[[ 3880  3305  1363]
 [ 5574 23068  6631]
 [  725  3337  4847]]
training model: results/QRTEA/W4/deepOF_L2/seq2seq
Epoch 1/50
634/634 - 23s - loss: 11.4321 - accuracy10: 0.5154 - accuracy20: 0.5121 - accuracy30: 0.5011 - accuracy50: 0.4855 - val_loss: 9.3753 - val_accuracy10: 0.6724 - val_accuracy20: 0.6494 - val_accuracy30: 0.6217 - val_accuracy50: 0.5846 - 23s/epoch - 37ms/step
Epoch 2/50
634/634 - 18s - loss: 10.2184 - accuracy10: 0.6135 - accuracy20: 0.6050 - accuracy30: 0.5866 - accuracy50: 0.5580 - val_loss: 8.9615 - val_accuracy10: 0.7191 - val_accuracy20: 0.6918 - val_accuracy30: 0.6586 - val_accuracy50: 0.6110 - 18s/epoch - 28ms/step
Epoch 3/50
634/634 - 18s - loss: 9.8028 - accuracy10: 0.6506 - accuracy20: 0.6346 - accuracy30: 0.6114 - accuracy50: 0.5778 - val_loss: 8.7299 - val_accuracy10: 0.7389 - val_accuracy20: 0.7140 - val_accuracy30: 0.6824 - val_accuracy50: 0.6358 - 18s/epoch - 29ms/step
Epoch 4/50
634/634 - 18s - loss: 9.6069 - accuracy10: 0.6606 - accuracy20: 0.6431 - accuracy30: 0.6198 - accuracy50: 0.5860 - val_loss: 8.7221 - val_accuracy10: 0.7318 - val_accuracy20: 0.7084 - val_accuracy30: 0.6803 - val_accuracy50: 0.6373 - 18s/epoch - 28ms/step
Epoch 5/50
634/634 - 18s - loss: 9.4816 - accuracy10: 0.6618 - accuracy20: 0.6455 - accuracy30: 0.6225 - accuracy50: 0.5911 - val_loss: 8.7424 - val_accuracy10: 0.7350 - val_accuracy20: 0.7116 - val_accuracy30: 0.6852 - val_accuracy50: 0.6430 - 18s/epoch - 28ms/step
Epoch 6/50
634/634 - 18s - loss: 9.3946 - accuracy10: 0.6656 - accuracy20: 0.6479 - accuracy30: 0.6257 - accuracy50: 0.5956 - val_loss: 8.7037 - val_accuracy10: 0.7444 - val_accuracy20: 0.7192 - val_accuracy30: 0.6932 - val_accuracy50: 0.6517 - 18s/epoch - 29ms/step
Epoch 7/50
634/634 - 17s - loss: 9.3170 - accuracy10: 0.6677 - accuracy20: 0.6510 - accuracy30: 0.6294 - accuracy50: 0.6000 - val_loss: 8.7740 - val_accuracy10: 0.7263 - val_accuracy20: 0.7040 - val_accuracy30: 0.6783 - val_accuracy50: 0.6369 - 17s/epoch - 28ms/step
Epoch 8/50
634/634 - 19s - loss: 9.2684 - accuracy10: 0.6685 - accuracy20: 0.6513 - accuracy30: 0.6291 - accuracy50: 0.5989 - val_loss: 8.9275 - val_accuracy10: 0.7270 - val_accuracy20: 0.7010 - val_accuracy30: 0.6746 - val_accuracy50: 0.6306 - 19s/epoch - 30ms/step
Epoch 9/50
634/634 - 18s - loss: 9.2109 - accuracy10: 0.6670 - accuracy20: 0.6501 - accuracy30: 0.6290 - accuracy50: 0.6002 - val_loss: 8.7143 - val_accuracy10: 0.7351 - val_accuracy20: 0.7081 - val_accuracy30: 0.6832 - val_accuracy50: 0.6430 - 18s/epoch - 28ms/step
Epoch 10/50
634/634 - 17s - loss: 9.1340 - accuracy10: 0.6714 - accuracy20: 0.6541 - accuracy30: 0.6324 - accuracy50: 0.6048 - val_loss: 8.7616 - val_accuracy10: 0.7486 - val_accuracy20: 0.7218 - val_accuracy30: 0.6949 - val_accuracy50: 0.6517 - 17s/epoch - 28ms/step
Epoch 11/50
634/634 - 17s - loss: 9.0854 - accuracy10: 0.6732 - accuracy20: 0.6550 - accuracy30: 0.6333 - accuracy50: 0.6052 - val_loss: 8.7166 - val_accuracy10: 0.7404 - val_accuracy20: 0.7116 - val_accuracy30: 0.6819 - val_accuracy50: 0.6397 - 17s/epoch - 27ms/step
Epoch 12/50
634/634 - 17s - loss: 9.0208 - accuracy10: 0.6748 - accuracy20: 0.6575 - accuracy30: 0.6350 - accuracy50: 0.6078 - val_loss: 8.8366 - val_accuracy10: 0.7202 - val_accuracy20: 0.6922 - val_accuracy30: 0.6633 - val_accuracy50: 0.6222 - 17s/epoch - 27ms/step
Epoch 13/50
634/634 - 18s - loss: 8.9864 - accuracy10: 0.6752 - accuracy20: 0.6583 - accuracy30: 0.6362 - accuracy50: 0.6084 - val_loss: 8.7868 - val_accuracy10: 0.7341 - val_accuracy20: 0.7086 - val_accuracy30: 0.6800 - val_accuracy50: 0.6398 - 18s/epoch - 29ms/step
Epoch 14/50
634/634 - 18s - loss: 8.9074 - accuracy10: 0.6779 - accuracy20: 0.6600 - accuracy30: 0.6385 - accuracy50: 0.6110 - val_loss: 8.7977 - val_accuracy10: 0.7200 - val_accuracy20: 0.6936 - val_accuracy30: 0.6666 - val_accuracy50: 0.6294 - 18s/epoch - 28ms/step
Epoch 15/50
634/634 - 17s - loss: 8.8328 - accuracy10: 0.6793 - accuracy20: 0.6631 - accuracy30: 0.6410 - accuracy50: 0.6138 - val_loss: 8.9151 - val_accuracy10: 0.7056 - val_accuracy20: 0.6767 - val_accuracy30: 0.6472 - val_accuracy50: 0.6112 - 17s/epoch - 27ms/step
Epoch 16/50
634/634 - 17s - loss: 8.7815 - accuracy10: 0.6786 - accuracy20: 0.6631 - accuracy30: 0.6416 - accuracy50: 0.6167 - val_loss: 8.9153 - val_accuracy10: 0.7304 - val_accuracy20: 0.7018 - val_accuracy30: 0.6740 - val_accuracy50: 0.6335 - 17s/epoch - 27ms/step
testing model: results/QRTEA/W4/deepOF_L2/seq2seq
Evaluating performance on  test set...
1613/1613 - 16s - 16s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6647414
{'0': {'precision': 0.3120635355333425, 'recall': 0.5398714873708211, 'f1-score': 0.3955095178697327, 'support': 33771}, '1': {'precision': 0.9410024668718755, 'recall': 0.7495609179278804, 'f1-score': 0.8344421500935665, 'support': 345038}, '2': {'precision': 0.29321806004096557, 'recall': 0.6855682218827124, 'f1-score': 0.4107556220569467, 'support': 34036}, 'accuracy': 0.7271324589131514, 'macro avg': {'precision': 0.5154280208153945, 'recall': 0.6583335423938046, 'f1-score': 0.5469024300067487, 'support': 412845}, 'weighted avg': {'precision': 0.8361498303590669, 'recall': 0.7271324589131514, 'f1-score': 0.7636073607874456, 'support': 412845}}
[[ 18232   9287   6252]
 [ 36418 258627  49993]
 [  3774   6928  23334]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6995523
{'0': {'precision': 0.37706782464846983, 'recall': 0.5502651204897185, 'f1-score': 0.4474925064418307, 'support': 46394}, '1': {'precision': 0.9034255310131728, 'recall': 0.7341352460684465, 'f1-score': 0.8100298123857855, 'support': 319403}, '2': {'precision': 0.364435097558126, 'recall': 0.6629824859717736, 'f1-score': 0.47033278547625873, 'support': 47048}, 'accuracy': 0.7053639985951143, 'macro avg': {'precision': 0.5483094844065896, 'recall': 0.6491276175099795, 'f1-score': 0.5759517014346249, 'support': 412845}, 'weighted avg': {'precision': 0.7828518015450261, 'recall': 0.7053639985951143, 'f1-score': 0.7305771812675613, 'support': 412845}}
[[ 25529  13644   7221]
 [ 37741 234485  47177]
 [  4434  11422  31192]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.75175124
{'0': {'precision': 0.4069818883809473, 'recall': 0.5450954338965399, 'f1-score': 0.4660209078488863, 'support': 55693}, '1': {'precision': 0.8665919828551946, 'recall': 0.7105644138702237, 'f1-score': 0.7808603200552993, 'support': 300471}, '2': {'precision': 0.3963865912059208, 'recall': 0.6425433566803691, 'f1-score': 0.49030364631363543, 'support': 56681}, 'accuracy': 0.6789037047802444, 'macro avg': {'precision': 0.5566534874806875, 'recall': 0.6327344014823776, 'f1-score': 0.5790616247392736, 'support': 412845}, 'weighted avg': {'precision': 0.7400341299185554, 'recall': 0.6789037047802444, 'f1-score': 0.698496735154518, 'support': 412845}}
[[ 30358  17476   7859]
 [ 39366 213504  47601]
 [  4869  15392  36420]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8136876
{'0': {'precision': 0.4593450489266289, 'recall': 0.5105337372778421, 'f1-score': 0.48358856356952046, 'support': 71627}, '1': {'precision': 0.791863926777047, 'recall': 0.6914528322967487, 'f1-score': 0.7382597838448263, 'support': 268510}, '2': {'precision': 0.43502338672120194, 'recall': 0.5909803597953458, 'f1-score': 0.5011488086213132, 'support': 72708}, 'accuracy': 0.6423694122491492, 'macro avg': {'precision': 0.5620774541416259, 'recall': 0.5976556431233122, 'f1-score': 0.5743323853452199, 'support': 412845}, 'weighted avg': {'precision': 0.6713283949184262, 'recall': 0.6423694122491492, 'f1-score': 0.6523166325865803, 'support': 412845}}
[[ 36568  25354   9705]
 [ 36748 185662  46100]
 [  6293  23446  42969]]
Evaluating performance on  train set...
634/634 - 6s - 6s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.67299235
{'0': {'precision': 0.3769501344920339, 'recall': 0.5670090258325552, 'f1-score': 0.4528461347253293, 'support': 16065}, '1': {'precision': 0.9279165778303258, 'recall': 0.7361493395660664, 'f1-score': 0.8209833141838012, 'support': 130066}, '2': {'precision': 0.31106645615042344, 'recall': 0.6749299283712239, 'f1-score': 0.42585969738651996, 'support': 16055}, 'accuracy': 0.7133353063766293, 'macro avg': {'precision': 0.5386443894909277, 'recall': 0.6593627645899485, 'f1-score': 0.5665630487652168, 'support': 162186}, 'weighted avg': {'precision': 0.8122789480977933, 'recall': 0.7133353063766293, 'f1-score': 0.7454044512999476, 'support': 162186}}
[[ 9109  4174  2782]
 [13101 95748 21217]
 [ 1955  3264 10836]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.71151185
{'0': {'precision': 0.4365619223659889, 'recall': 0.5494602642843849, 'f1-score': 0.48654773186106876, 'support': 21492}, '1': {'precision': 0.8801891696309357, 'recall': 0.7256060160483973, 'f1-score': 0.7954570575881508, 'support': 119015}, '2': {'precision': 0.3774410501580099, 'recall': 0.6445869274413026, 'f1-score': 0.4760996218186773, 'support': 21679}, 'accuracy': 0.6914345257913753, 'macro avg': {'precision': 0.5647307140516449, 'recall': 0.6398844025913616, 'f1-score': 0.5860348037559656, 'support': 162186}, 'weighted avg': {'precision': 0.7542010246599037, 'recall': 0.6914345257913753, 'f1-score': 0.7118343708052419, 'support': 162186}}
[[11809  6307  3376]
 [12984 86358 19673]
 [ 2257  5448 13974]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.76465493
{'0': {'precision': 0.46296043190049885, 'recall': 0.527711781888997, 'f1-score': 0.4932199996359731, 'support': 25675}, '1': {'precision': 0.8352152925688476, 'recall': 0.7055669581099286, 'f1-score': 0.7649365289418223, 'support': 110599}, '2': {'precision': 0.4071513586061941, 'recall': 0.6204847175054029, 'f1-score': 0.4916744392287579, 'support': 25912}, 'accuracy': 0.6638180854081117, 'macro avg': {'precision': 0.5684423610251802, 'recall': 0.6179211525014429, 'f1-score': 0.5832769892688511, 'support': 162186}, 'weighted avg': {'precision': 0.7078945854517097, 'recall': 0.6638180854081117, 'f1-score': 0.6782638866757045, 'support': 162186}}
[[13549  8113  4013]
 [13166 78035 19398]
 [ 2551  7283 16078]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.836031
{'0': {'precision': 0.5025076532273822, 'recall': 0.47425849085600125, 'f1-score': 0.4879745734570927, 'support': 32535}, '1': {'precision': 0.7471308125538847, 'recall': 0.6886526652562052, 'f1-score': 0.7167008581893171, 'support': 96895}, '2': {'precision': 0.4383551898313927, 'recall': 0.5643240932958847, 'f1-score': 0.49342676009342673, 'support': 32756}, 'accuracy': 0.6205344481027956, 'macro avg': {'precision': 0.5626645518708865, 'recall': 0.5757450831360305, 'f1-score': 0.5660340639132788, 'support': 162186}, 'weighted avg': {'precision': 0.635696602532146, 'recall': 0.6205344481027956, 'f1-score': 0.6257239795993531, 'support': 162186}}
[[15430 11688  5417]
 [11901 66727 18267]
 [ 3375 10896 18485]]
Evaluating performance on  val set...
206/206 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6277276
{'0': {'precision': 0.34718659141440056, 'recall': 0.5057299451918286, 'f1-score': 0.4117229489909745, 'support': 4014}, '1': {'precision': 0.9370652173913043, 'recall': 0.7739126531711478, 'f1-score': 0.8477101207010989, 'support': 44558}, '2': {'precision': 0.26770482047212857, 'recall': 0.6492662978109214, 'f1-score': 0.37909965587471034, 'support': 4157}, 'accuracy': 0.7436704659674942, 'macro avg': {'precision': 0.5173188764259445, 'recall': 0.642969632057966, 'f1-score': 0.546177575188928, 'support': 52729}, 'weighted avg': {'precision': 0.8393902382590563, 'recall': 0.7436704659674942, 'f1-score': 0.7775766797193292, 'support': 52729}}
[[ 2030  1257   727]
 [ 3418 34484  6656]
 [  399  1059  2699]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.67739475
{'0': {'precision': 0.40234551195308976, 'recall': 0.4902894833272261, 'f1-score': 0.44198530018994137, 'support': 5458}, '1': {'precision': 0.8961152705184348, 'recall': 0.7636635045986421, 'f1-score': 0.82460450545308, 'support': 41534}, '2': {'precision': 0.3333333333333333, 'recall': 0.620707686944396, 'f1-score': 0.4337393422655298, 'support': 5737}, 'accuracy': 0.7198126268277418, 'macro avg': {'precision': 0.5439313719349526, 'recall': 0.6248868916234214, 'f1-score': 0.5667763826361837, 'support': 52729}, 'weighted avg': {'precision': 0.7837733843480051, 'recall': 0.7198126268277418, 'f1-score': 0.7424726792562396, 'support': 52729}}
[[ 2676  1932   850]
 [ 3544 31718  6272]
 [  431  1745  3561]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7363124
{'0': {'precision': 0.4384284325975288, 'recall': 0.47761645493042953, 'f1-score': 0.45718422005066955, 'support': 6612}, '1': {'precision': 0.858512416077868, 'recall': 0.7468438368741871, 'f1-score': 0.7987942933522464, 'support': 39209}, '2': {'precision': 0.36200402907944296, 'recall': 0.598291835552982, 'f1-score': 0.45107776261937244, 'support': 6908}, 'accuracy': 0.6936221054827514, 'macro avg': {'precision': 0.5529816259182799, 'recall': 0.6075840424525328, 'f1-score': 0.5690187586740961, 'support': 52729}, 'weighted avg': {'precision': 0.7407882939409581, 'recall': 0.6936221054827514, 'f1-score': 0.7104036241005497, 'support': 52729}}
[[ 3158  2502   952]
 [ 3594 29283  6332]
 [  451  2324  4133]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8099733
{'0': {'precision': 0.48421468034727705, 'recall': 0.429722157366332, 'f1-score': 0.4553438891637803, 'support': 8566}, '1': {'precision': 0.7825332562174667, 'recall': 0.729649182561308, 'f1-score': 0.7551664879632213, 'support': 35232}, '2': {'precision': 0.39874551971326166, 'recall': 0.5480909192699586, 'f1-score': 0.4616400245202056, 'support': 8931}, 'accuracy': 0.6501735287981946, 'macro avg': {'precision': 0.5551644854260018, 'recall': 0.5691540863991995, 'f1-score': 0.5573834672157357, 'support': 52729}, 'weighted avg': {'precision': 0.66906618504936, 'recall': 0.6501735287981946, 'f1-score': 0.6567431302980733, 'support': 52729}}
[[ 3681  3681  1204]
 [ 3348 25707  6177]
 [  573  3463  4895]]
training model: results/QRTEA/W4/deepVOL_L2/seq2seq
Epoch 1/50
634/634 - 23s - loss: 11.0660 - accuracy10: 0.5752 - accuracy20: 0.5716 - accuracy30: 0.5577 - accuracy50: 0.5360 - val_loss: 9.6493 - val_accuracy10: 0.5932 - val_accuracy20: 0.5873 - val_accuracy30: 0.5689 - val_accuracy50: 0.5420 - 23s/epoch - 37ms/step
Epoch 2/50
634/634 - 17s - loss: 10.3055 - accuracy10: 0.6375 - accuracy20: 0.6296 - accuracy30: 0.6118 - accuracy50: 0.5835 - val_loss: 9.3592 - val_accuracy10: 0.6158 - val_accuracy20: 0.6049 - val_accuracy30: 0.5853 - val_accuracy50: 0.5573 - 17s/epoch - 27ms/step
Epoch 3/50
634/634 - 17s - loss: 10.0202 - accuracy10: 0.6583 - accuracy20: 0.6448 - accuracy30: 0.6222 - accuracy50: 0.5902 - val_loss: 9.4107 - val_accuracy10: 0.6034 - val_accuracy20: 0.5941 - val_accuracy30: 0.5750 - val_accuracy50: 0.5476 - 17s/epoch - 27ms/step
Epoch 4/50
634/634 - 18s - loss: 9.8753 - accuracy10: 0.6642 - accuracy20: 0.6494 - accuracy30: 0.6263 - accuracy50: 0.5928 - val_loss: 9.1244 - val_accuracy10: 0.6438 - val_accuracy20: 0.6314 - val_accuracy30: 0.6105 - val_accuracy50: 0.5778 - 18s/epoch - 28ms/step
Epoch 5/50
634/634 - 17s - loss: 9.7573 - accuracy10: 0.6747 - accuracy20: 0.6579 - accuracy30: 0.6339 - accuracy50: 0.5981 - val_loss: 9.2831 - val_accuracy10: 0.6262 - val_accuracy20: 0.6108 - val_accuracy30: 0.5883 - val_accuracy50: 0.5600 - 17s/epoch - 27ms/step
Epoch 6/50
634/634 - 18s - loss: 9.6619 - accuracy10: 0.6788 - accuracy20: 0.6609 - accuracy30: 0.6344 - accuracy50: 0.6004 - val_loss: 9.3170 - val_accuracy10: 0.5936 - val_accuracy20: 0.5762 - val_accuracy30: 0.5540 - val_accuracy50: 0.5294 - 18s/epoch - 28ms/step
Epoch 7/50
634/634 - 18s - loss: 9.6206 - accuracy10: 0.6806 - accuracy20: 0.6622 - accuracy30: 0.6367 - accuracy50: 0.6005 - val_loss: 9.2445 - val_accuracy10: 0.6347 - val_accuracy20: 0.6194 - val_accuracy30: 0.5973 - val_accuracy50: 0.5677 - 18s/epoch - 28ms/step
Epoch 8/50
634/634 - 17s - loss: 9.5381 - accuracy10: 0.6834 - accuracy20: 0.6640 - accuracy30: 0.6370 - accuracy50: 0.6002 - val_loss: 9.2033 - val_accuracy10: 0.6510 - val_accuracy20: 0.6349 - val_accuracy30: 0.6090 - val_accuracy50: 0.5754 - 17s/epoch - 27ms/step
Epoch 9/50
634/634 - 17s - loss: 9.4888 - accuracy10: 0.6832 - accuracy20: 0.6637 - accuracy30: 0.6378 - accuracy50: 0.6030 - val_loss: 9.0349 - val_accuracy10: 0.6636 - val_accuracy20: 0.6454 - val_accuracy30: 0.6189 - val_accuracy50: 0.5816 - 17s/epoch - 28ms/step
Epoch 10/50
634/634 - 18s - loss: 9.4700 - accuracy10: 0.6851 - accuracy20: 0.6649 - accuracy30: 0.6377 - accuracy50: 0.6031 - val_loss: 9.1295 - val_accuracy10: 0.6331 - val_accuracy20: 0.6190 - val_accuracy30: 0.5963 - val_accuracy50: 0.5682 - 18s/epoch - 28ms/step
Epoch 11/50
634/634 - 17s - loss: 9.4052 - accuracy10: 0.6834 - accuracy20: 0.6659 - accuracy30: 0.6399 - accuracy50: 0.6048 - val_loss: 9.1662 - val_accuracy10: 0.6338 - val_accuracy20: 0.6209 - val_accuracy30: 0.6008 - val_accuracy50: 0.5711 - 17s/epoch - 27ms/step
Epoch 12/50
634/634 - 17s - loss: 9.3456 - accuracy10: 0.6877 - accuracy20: 0.6688 - accuracy30: 0.6418 - accuracy50: 0.6068 - val_loss: 9.1407 - val_accuracy10: 0.6530 - val_accuracy20: 0.6374 - val_accuracy30: 0.6131 - val_accuracy50: 0.5814 - 17s/epoch - 27ms/step
Epoch 13/50
634/634 - 17s - loss: 9.2973 - accuracy10: 0.6854 - accuracy20: 0.6680 - accuracy30: 0.6415 - accuracy50: 0.6074 - val_loss: 9.0066 - val_accuracy10: 0.6668 - val_accuracy20: 0.6488 - val_accuracy30: 0.6210 - val_accuracy50: 0.5843 - 17s/epoch - 26ms/step
Epoch 14/50
634/634 - 17s - loss: 9.2658 - accuracy10: 0.6881 - accuracy20: 0.6697 - accuracy30: 0.6432 - accuracy50: 0.6098 - val_loss: 9.1250 - val_accuracy10: 0.6381 - val_accuracy20: 0.6233 - val_accuracy30: 0.6018 - val_accuracy50: 0.5713 - 17s/epoch - 27ms/step
Epoch 15/50
634/634 - 17s - loss: 9.2121 - accuracy10: 0.6868 - accuracy20: 0.6692 - accuracy30: 0.6438 - accuracy50: 0.6094 - val_loss: 9.1533 - val_accuracy10: 0.6356 - val_accuracy20: 0.6247 - val_accuracy30: 0.6022 - val_accuracy50: 0.5691 - 17s/epoch - 27ms/step
Epoch 16/50
634/634 - 17s - loss: 9.1705 - accuracy10: 0.6878 - accuracy20: 0.6714 - accuracy30: 0.6453 - accuracy50: 0.6110 - val_loss: 9.2132 - val_accuracy10: 0.6374 - val_accuracy20: 0.6267 - val_accuracy30: 0.6057 - val_accuracy50: 0.5732 - 17s/epoch - 27ms/step
Epoch 17/50
634/634 - 17s - loss: 9.1468 - accuracy10: 0.6859 - accuracy20: 0.6699 - accuracy30: 0.6447 - accuracy50: 0.6120 - val_loss: 9.2084 - val_accuracy10: 0.6372 - val_accuracy20: 0.6222 - val_accuracy30: 0.5994 - val_accuracy50: 0.5693 - 17s/epoch - 27ms/step
Epoch 18/50
634/634 - 17s - loss: 9.1191 - accuracy10: 0.6880 - accuracy20: 0.6700 - accuracy30: 0.6442 - accuracy50: 0.6118 - val_loss: 9.1582 - val_accuracy10: 0.6441 - val_accuracy20: 0.6251 - val_accuracy30: 0.5986 - val_accuracy50: 0.5650 - 17s/epoch - 26ms/step
Epoch 19/50
634/634 - 17s - loss: 9.0740 - accuracy10: 0.6882 - accuracy20: 0.6703 - accuracy30: 0.6454 - accuracy50: 0.6142 - val_loss: 9.1037 - val_accuracy10: 0.6528 - val_accuracy20: 0.6379 - val_accuracy30: 0.6149 - val_accuracy50: 0.5837 - 17s/epoch - 27ms/step
Epoch 20/50
634/634 - 17s - loss: 9.0105 - accuracy10: 0.6892 - accuracy20: 0.6709 - accuracy30: 0.6461 - accuracy50: 0.6144 - val_loss: 9.2449 - val_accuracy10: 0.6385 - val_accuracy20: 0.6229 - val_accuracy30: 0.5992 - val_accuracy50: 0.5692 - 17s/epoch - 27ms/step
Epoch 21/50
634/634 - 17s - loss: 8.9758 - accuracy10: 0.6902 - accuracy20: 0.6717 - accuracy30: 0.6470 - accuracy50: 0.6144 - val_loss: 9.2865 - val_accuracy10: 0.6374 - val_accuracy20: 0.6234 - val_accuracy30: 0.6020 - val_accuracy50: 0.5727 - 17s/epoch - 28ms/step
Epoch 22/50
634/634 - 17s - loss: 8.9377 - accuracy10: 0.6911 - accuracy20: 0.6714 - accuracy30: 0.6471 - accuracy50: 0.6159 - val_loss: 9.3915 - val_accuracy10: 0.6475 - val_accuracy20: 0.6292 - val_accuracy30: 0.6035 - val_accuracy50: 0.5712 - 17s/epoch - 27ms/step
Epoch 23/50
634/634 - 17s - loss: 8.8933 - accuracy10: 0.6917 - accuracy20: 0.6734 - accuracy30: 0.6479 - accuracy50: 0.6176 - val_loss: 9.3806 - val_accuracy10: 0.6403 - val_accuracy20: 0.6233 - val_accuracy30: 0.6002 - val_accuracy50: 0.5706 - 17s/epoch - 27ms/step
testing model: results/QRTEA/W4/deepVOL_L2/seq2seq
Evaluating performance on  test set...
1613/1613 - 14s - 14s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.765014
{'0': {'precision': 0.22156345833109162, 'recall': 0.6097062655454223, 'f1-score': 0.32501756019793704, 'support': 33772}, '1': {'precision': 0.9480039977863497, 'recall': 0.6652677950382564, 'f1-score': 0.7818602322309911, 'support': 345040}, '2': {'precision': 0.3067369503728465, 'recall': 0.7009430913417751, 'f1-score': 0.4267329654703667, 'support': 34037}, 'accuracy': 0.66366395461779, 'macro avg': {'precision': 0.492101468830096, 'recall': 0.6586390506418179, 'f1-score': 0.5112035859664316, 'support': 412849}, 'weighted avg': {'precision': 0.8357107467640719, 'recall': 0.66366395461779, 'f1-score': 0.7152112697807206, 'support': 412849}}
[[ 20591   6034   7147]
 [ 68721 229544  46775]
 [  3623   6556  23858]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7778045
{'0': {'precision': 0.2830811826362108, 'recall': 0.6170492509968747, 'f1-score': 0.3881104897475004, 'support': 46395}, '1': {'precision': 0.9098611940884294, 'recall': 0.6532239633067736, 'f1-score': 0.7604744149089333, 'support': 319405}, '2': {'precision': 0.38386767953789774, 'recall': 0.6723416013092733, 'f1-score': 0.48871036267428836, 'support': 47049}, 'accuracy': 0.6513374139213126, 'macro avg': {'precision': 0.5256033520875126, 'recall': 0.6475382718709738, 'f1-score': 0.5457650891102407, 'support': 412849}, 'weighted avg': {'precision': 0.7794819815981153, 'recall': 0.6513374139213126, 'f1-score': 0.6876583218544449, 'support': 412849}}
[[ 28628   9674   8093]
 [ 68082 208643  42680]
 [  4420  10996  31633]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8119229
{'0': {'precision': 0.3172047495898334, 'recall': 0.6144467985779437, 'f1-score': 0.418408455956522, 'support': 55694}, '1': {'precision': 0.8724501305146466, 'recall': 0.630708915609722, 'f1-score': 0.7321408564971315, 'support': 300473}, '2': {'precision': 0.4202441053459299, 'recall': 0.6505769027204403, 'f1-score': 0.5106382978723404, 'support': 56682}, 'accuracy': 0.6312428999464695, 'macro avg': {'precision': 0.5366329951501366, 'recall': 0.631910872302702, 'f1-score': 0.5537292034419979, 'support': 412849}, 'weighted avg': {'precision': 0.735461114763513, 'recall': 0.6312428999464695, 'f1-score': 0.6594067083129792, 'support': 412849}}
[[ 34221  12975   8498]
 [ 68587 189511  42375]
 [  5075  14731  36876]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.86051387
{'0': {'precision': 0.36850985706167766, 'recall': 0.588493165984894, 'f1-score': 0.45321807195234715, 'support': 71627}, '1': {'precision': 0.7967056530214425, 'recall': 0.6088517459182458, 'f1-score': 0.6902252845610835, 'support': 268512}, '2': {'precision': 0.4634478469720364, 'recall': 0.5944574336404896, 'f1-score': 0.5208406135900804, 'support': 72710}, 'accuracy': 0.6027845531901495, 'macro avg': {'precision': 0.5428877856850521, 'recall': 0.5972674485145432, 'f1-score': 0.554761323367837, 'support': 412849}, 'weighted avg': {'precision': 0.6637234843470304, 'recall': 0.6027845531901495, 'f1-score': 0.6192742224443589, 'support': 412849}}
[[ 42152  19510   9965]
 [ 64952 163484  40076]
 [  7281  22206  43223]]
Evaluating performance on  train set...
634/634 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7763204
{'0': {'precision': 0.304863622536925, 'recall': 0.5638909727431858, 'f1-score': 0.39576157778119037, 'support': 15996}, '1': {'precision': 0.9354616293831809, 'recall': 0.6571107882254357, 'f1-score': 0.7719610384332284, 'support': 130077}, '2': {'precision': 0.2879423678657191, 'recall': 0.7367343139080246, 'f1-score': 0.4140565050575515, 'support': 16113}, 'accuracy': 0.6558272600594379, 'macro avg': {'precision': 0.5094225399286084, 'recall': 0.6525786916255486, 'f1-score': 0.5272597070906567, 'support': 162186}, 'weighted avg': {'precision': 0.8089369997706152, 'recall': 0.6558272600594379, 'f1-score': 0.6993000053053857, 'support': 162186}}
[[ 9020  3140  3836]
 [19082 85475 25520]
 [ 1485  2757 11871]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7984323
{'0': {'precision': 0.36503776784337905, 'recall': 0.551492850156039, 'f1-score': 0.43929949539922825, 'support': 21469}, '1': {'precision': 0.8871991475364266, 'recall': 0.6436998941158675, 'f1-score': 0.7460844664355007, 'support': 118998}, '2': {'precision': 0.34968788151014674, 'recall': 0.6989732492287859, 'f1-score': 0.4661610268378063, 'support': 21719}, 'accuracy': 0.6388960822759054, 'macro avg': {'precision': 0.5339749322966508, 'recall': 0.6313886645002308, 'f1-score': 0.5505149962241784, 'support': 162186}, 'weighted avg': {'precision': 0.746098868551466, 'recall': 0.6388960822759054, 'f1-score': 0.667988800177007, 'support': 162186}}
[[11840  5059  4570]
 [18737 76599 23662]
 [ 1858  4680 15181]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8387731
{'0': {'precision': 0.3976704055220017, 'recall': 0.5392325091646517, 'f1-score': 0.45775673707210485, 'support': 25642}, '1': {'precision': 0.8421886125365219, 'recall': 0.6201793559818475, 'f1-score': 0.7143318269851517, 'support': 110618}, '2': {'precision': 0.3785195178206188, 'recall': 0.6709866543238447, 'f1-score': 0.484002003227422, 'support': 25926}, 'accuracy': 0.6155031876980751, 'macro avg': {'precision': 0.5394595119597142, 'recall': 0.610132839823448, 'f1-score': 0.5520301890948928, 'support': 162186}, 'weighted avg': {'precision': 0.6977900774356449, 'recall': 0.6155031876980751, 'f1-score': 0.6369476540830933, 'support': 162186}}
[[13827  6607  5208]
 [18661 68603 23354]
 [ 2282  6248 17396]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8980139
{'0': {'precision': 0.4411200820889477, 'recall': 0.5025379149106346, 'f1-score': 0.46983031348863963, 'support': 32507}, '1': {'precision': 0.7576763268612643, 'recall': 0.5982831909537369, 'f1-score': 0.6686114217851007, 'support': 96924}, '2': {'precision': 0.41434418642917376, 'recall': 0.6150206075408334, 'f1-score': 0.49512129181310977, 'support': 32755}, 'accuracy': 0.582473209771497, 'macro avg': {'precision': 0.5377135317931286, 'recall': 0.571947237801735, 'f1-score': 0.5445210090289501, 'support': 162186}, 'weighted avg': {'precision': 0.6248896614976273, 'recall': 0.582473209771497, 'f1-score': 0.593731674491095, 'support': 162186}}
[[16336  9364  6807]
 [17269 57988 21667]
 [ 3428  9182 20145]]
Evaluating performance on  val set...
206/206 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.75463706
{'0': {'precision': 0.25217982108481485, 'recall': 0.5571678759069302, 'f1-score': 0.3472092298097911, 'support': 3997}, '1': {'precision': 0.9478338316686812, 'recall': 0.6684163301929116, 'f1-score': 0.7839722171064748, 'support': 44580}, '2': {'precision': 0.24452291148382954, 'recall': 0.7336864916927522, 'f1-score': 0.36679908510894427, 'support': 4153}, 'accuracy': 0.6651242177128769, 'macro avg': {'precision': 0.4815121880791085, 'recall': 0.6530902325975313, 'f1-score': 0.4993268440084034, 'support': 52730}, 'weighted avg': {'precision': 0.839709816272675, 'recall': 0.6651242177128769, 'f1-score': 0.7180085972048896, 'support': 52730}}
[[ 2227   835   935]
 [ 6303 29798  8479]
 [  301   805  3047]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.78568894
{'0': {'precision': 0.31342516447368424, 'recall': 0.5601690244350542, 'f1-score': 0.40195109089710634, 'support': 5443}, '1': {'precision': 0.9087657127574218, 'recall': 0.6541293676003466, 'f1-score': 0.7607040913415795, 'support': 41556}, '2': {'precision': 0.30397249809014515, 'recall': 0.694294189495725, 'f1-score': 0.42282556718559056, 'support': 5731}, 'accuracy': 0.648795751943865, 'macro avg': {'precision': 0.5087211251070838, 'recall': 0.636197527177042, 'f1-score': 0.5284935831414255, 'support': 52730}, 'weighted avg': {'precision': 0.7815798884151773, 'recall': 0.648795751943865, 'f1-score': 0.6869495985792575, 'support': 52730}}
[[ 3049  1337  1057]
 [ 6319 27183  8054]
 [  360  1392  3979]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.83295584
{'0': {'precision': 0.34165872259294566, 'recall': 0.5444326295002279, 'f1-score': 0.41984419844198445, 'support': 6583}, '1': {'precision': 0.8693437113037326, 'recall': 0.626277558302536, 'f1-score': 0.7280592592592593, 'support': 39235}, '2': {'precision': 0.3267978533094812, 'recall': 0.6607349537037037, 'f1-score': 0.4373055010293484, 'support': 6912}, 'accuracy': 0.6205765219040394, 'macro avg': {'precision': 0.5126000957353866, 'recall': 0.6104817138354891, 'f1-score': 0.5284029862435307, 'support': 52730}, 'weighted avg': {'precision': 0.7323471770511368, 'recall': 0.6205765219040393, 'f1-score': 0.6514677606390191, 'support': 52730}}
[[ 3584  1795  1204]
 [ 6459 24572  8204]
 [  447  1898  4567]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8933167
{'0': {'precision': 0.3821368504912809, 'recall': 0.5050304164716893, 'f1-score': 0.43507180650037797, 'support': 8548}, '1': {'precision': 0.7938551903309613, 'recall': 0.5977376463584044, 'f1-score': 0.6819769698537974, 'support': 35273}, '2': {'precision': 0.3622428398547802, 'recall': 0.6047816814457291, 'f1-score': 0.45309674977925407, 'support': 8909}, 'accuracy': 0.5838991086667931, 'macro avg': {'precision': 0.5127449602256741, 'recall': 0.569183248091941, 'f1-score': 0.5233818420444765, 'support': 52730}, 'weighted avg': {'precision': 0.6541889130819212, 'recall': 0.5838991086667931, 'f1-score': 0.6032809862203983, 'support': 52730}}
[[ 4317  2691  1540]
 [ 6243 21084  7946]
 [  737  2784  5388]]
training model: results/QRTEA/W4/deepVOL_L3/seq2seq
Epoch 1/50
634/634 - 31s - loss: 12.3258 - accuracy10: 0.3794 - accuracy20: 0.3963 - accuracy30: 0.4046 - accuracy50: 0.4121 - val_loss: 9.9292 - val_accuracy10: 0.5547 - val_accuracy20: 0.5619 - val_accuracy30: 0.5622 - val_accuracy50: 0.5536 - 31s/epoch - 49ms/step
Epoch 2/50
634/634 - 25s - loss: 10.5613 - accuracy10: 0.5927 - accuracy20: 0.5918 - accuracy30: 0.5849 - accuracy50: 0.5687 - val_loss: 8.9443 - val_accuracy10: 0.6477 - val_accuracy20: 0.6376 - val_accuracy30: 0.6199 - val_accuracy50: 0.5953 - 25s/epoch - 39ms/step
Epoch 3/50
634/634 - 26s - loss: 10.0240 - accuracy10: 0.6450 - accuracy20: 0.6327 - accuracy30: 0.6147 - accuracy50: 0.5888 - val_loss: 8.9367 - val_accuracy10: 0.6363 - val_accuracy20: 0.6304 - val_accuracy30: 0.6157 - val_accuracy50: 0.5929 - 26s/epoch - 40ms/step
Epoch 4/50
634/634 - 25s - loss: 9.8257 - accuracy10: 0.6591 - accuracy20: 0.6424 - accuracy30: 0.6226 - accuracy50: 0.5934 - val_loss: 8.7743 - val_accuracy10: 0.6496 - val_accuracy20: 0.6445 - val_accuracy30: 0.6297 - val_accuracy50: 0.6048 - 25s/epoch - 39ms/step
Epoch 5/50
634/634 - 25s - loss: 9.7010 - accuracy10: 0.6682 - accuracy20: 0.6533 - accuracy30: 0.6317 - accuracy50: 0.6023 - val_loss: 8.6967 - val_accuracy10: 0.6653 - val_accuracy20: 0.6591 - val_accuracy30: 0.6425 - val_accuracy50: 0.6159 - 25s/epoch - 39ms/step
Epoch 6/50
634/634 - 25s - loss: 9.5666 - accuracy10: 0.6756 - accuracy20: 0.6581 - accuracy30: 0.6359 - accuracy50: 0.6045 - val_loss: 8.7213 - val_accuracy10: 0.6567 - val_accuracy20: 0.6545 - val_accuracy30: 0.6401 - val_accuracy50: 0.6143 - 25s/epoch - 39ms/step
Epoch 7/50
634/634 - 25s - loss: 9.4750 - accuracy10: 0.6771 - accuracy20: 0.6623 - accuracy30: 0.6396 - accuracy50: 0.6074 - val_loss: 8.6718 - val_accuracy10: 0.6740 - val_accuracy20: 0.6619 - val_accuracy30: 0.6428 - val_accuracy50: 0.6137 - 25s/epoch - 40ms/step
Epoch 8/50
634/634 - 25s - loss: 9.4106 - accuracy10: 0.6790 - accuracy20: 0.6652 - accuracy30: 0.6426 - accuracy50: 0.6086 - val_loss: 8.5846 - val_accuracy10: 0.7026 - val_accuracy20: 0.6923 - val_accuracy30: 0.6713 - val_accuracy50: 0.6398 - 25s/epoch - 39ms/step
Epoch 9/50
634/634 - 25s - loss: 9.3623 - accuracy10: 0.6855 - accuracy20: 0.6690 - accuracy30: 0.6439 - accuracy50: 0.6092 - val_loss: 8.4920 - val_accuracy10: 0.6980 - val_accuracy20: 0.6859 - val_accuracy30: 0.6662 - val_accuracy50: 0.6327 - 25s/epoch - 40ms/step
Epoch 10/50
634/634 - 25s - loss: 9.2848 - accuracy10: 0.6877 - accuracy20: 0.6709 - accuracy30: 0.6451 - accuracy50: 0.6103 - val_loss: 8.6041 - val_accuracy10: 0.6913 - val_accuracy20: 0.6787 - val_accuracy30: 0.6599 - val_accuracy50: 0.6295 - 25s/epoch - 39ms/step
Epoch 11/50
634/634 - 25s - loss: 9.2227 - accuracy10: 0.6886 - accuracy20: 0.6710 - accuracy30: 0.6460 - accuracy50: 0.6128 - val_loss: 8.6164 - val_accuracy10: 0.6679 - val_accuracy20: 0.6562 - val_accuracy30: 0.6347 - val_accuracy50: 0.6035 - 25s/epoch - 40ms/step
Epoch 12/50
634/634 - 25s - loss: 9.1763 - accuracy10: 0.6892 - accuracy20: 0.6712 - accuracy30: 0.6461 - accuracy50: 0.6134 - val_loss: 8.5517 - val_accuracy10: 0.7064 - val_accuracy20: 0.6874 - val_accuracy30: 0.6637 - val_accuracy50: 0.6260 - 25s/epoch - 39ms/step
Epoch 13/50
634/634 - 24s - loss: 9.1315 - accuracy10: 0.6903 - accuracy20: 0.6717 - accuracy30: 0.6459 - accuracy50: 0.6138 - val_loss: 8.5701 - val_accuracy10: 0.6968 - val_accuracy20: 0.6840 - val_accuracy30: 0.6676 - val_accuracy50: 0.6372 - 24s/epoch - 39ms/step
Epoch 14/50
634/634 - 26s - loss: 9.0991 - accuracy10: 0.6912 - accuracy20: 0.6712 - accuracy30: 0.6462 - accuracy50: 0.6162 - val_loss: 8.4991 - val_accuracy10: 0.7108 - val_accuracy20: 0.6943 - val_accuracy30: 0.6726 - val_accuracy50: 0.6373 - 26s/epoch - 41ms/step
Epoch 15/50
634/634 - 25s - loss: 9.0429 - accuracy10: 0.6911 - accuracy20: 0.6709 - accuracy30: 0.6458 - accuracy50: 0.6145 - val_loss: 8.6109 - val_accuracy10: 0.7148 - val_accuracy20: 0.6997 - val_accuracy30: 0.6778 - val_accuracy50: 0.6433 - 25s/epoch - 40ms/step
Epoch 16/50
634/634 - 25s - loss: 8.9981 - accuracy10: 0.6924 - accuracy20: 0.6731 - accuracy30: 0.6478 - accuracy50: 0.6164 - val_loss: 8.5207 - val_accuracy10: 0.7106 - val_accuracy20: 0.6929 - val_accuracy30: 0.6705 - val_accuracy50: 0.6360 - 25s/epoch - 39ms/step
Epoch 17/50
634/634 - 24s - loss: 8.9368 - accuracy10: 0.6912 - accuracy20: 0.6719 - accuracy30: 0.6472 - accuracy50: 0.6171 - val_loss: 8.6182 - val_accuracy10: 0.7191 - val_accuracy20: 0.7005 - val_accuracy30: 0.6773 - val_accuracy50: 0.6423 - 24s/epoch - 38ms/step
Epoch 18/50
634/634 - 25s - loss: 8.8999 - accuracy10: 0.6936 - accuracy20: 0.6737 - accuracy30: 0.6497 - accuracy50: 0.6197 - val_loss: 8.6300 - val_accuracy10: 0.7291 - val_accuracy20: 0.7066 - val_accuracy30: 0.6820 - val_accuracy50: 0.6444 - 25s/epoch - 40ms/step
Epoch 19/50
634/634 - 24s - loss: 8.8523 - accuracy10: 0.6928 - accuracy20: 0.6722 - accuracy30: 0.6482 - accuracy50: 0.6171 - val_loss: 8.7171 - val_accuracy10: 0.7164 - val_accuracy20: 0.6924 - val_accuracy30: 0.6669 - val_accuracy50: 0.6307 - 24s/epoch - 39ms/step
testing model: results/QRTEA/W4/deepVOL_L3/seq2seq
Evaluating performance on  test set...
1613/1613 - 28s - 28s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.68899494
{'0': {'precision': 0.24029470431564262, 'recall': 0.617108847566031, 'f1-score': 0.34590010207214755, 'support': 33772}, '1': {'precision': 0.9500605433619788, 'recall': 0.7026576628796661, 'f1-score': 0.8078416737611812, 'support': 345040}, '2': {'precision': 0.3311903452748523, 'recall': 0.6901607074654053, 'f1-score': 0.447592553779319, 'support': 34037}, 'accuracy': 0.6946292712347614, 'macro avg': {'precision': 0.5071818643174912, 'recall': 0.6699757393037009, 'f1-score': 0.5337781098708826, 'support': 412849}, 'weighted avg': {'precision': 0.8409778113011905, 'recall': 0.6946292712347614, 'f1-score': 0.7403533425410386, 'support': 412849}}
[[ 20841   5839   7092]
 [ 62249 242445  40346]
 [  3641   6905  23491]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7039678
{'0': {'precision': 0.3106641158786554, 'recall': 0.6125229011746955, 'f1-score': 0.41224341771233775, 'support': 46395}, '1': {'precision': 0.9126819714499163, 'recall': 0.7076031996994412, 'f1-score': 0.7971642212189617, 'support': 319405}, '2': {'precision': 0.418448853388302, 'recall': 0.655826903866182, 'f1-score': 0.5109116799682087, 'support': 47049}, 'accuracy': 0.6910177813195624, 'macro avg': {'precision': 0.5472649802389579, 'recall': 0.6586510015801063, 'f1-score': 0.5734397729665027, 'support': 412849}, 'weighted avg': {'precision': 0.78870494260666, 'recall': 0.6910177813195624, 'f1-score': 0.7212858819423824, 'support': 412849}}
[[ 28418   9694   8283]
 [ 58793 226012  34600]
 [  4264  11929  30856]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7407255
{'0': {'precision': 0.35169766322880275, 'recall': 0.6037095557869788, 'f1-score': 0.4444664763113367, 'support': 55694}, '1': {'precision': 0.8762664277923619, 'recall': 0.7032079421445521, 'f1-score': 0.7802564235123819, 'support': 300473}, '2': {'precision': 0.46363445267749226, 'recall': 0.6225962386648318, 'f1-score': 0.5314839078901791, 'support': 56682}, 'accuracy': 0.6787178847472078, 'macro avg': {'precision': 0.5638661812328857, 'recall': 0.6431712455321209, 'f1-score': 0.5854022692379659, 'support': 412849}, 'weighted avg': {'precision': 0.7488490466504336, 'recall': 0.6787178847472078, 'f1-score': 0.7008026545801264, 'support': 412849}}
[[ 33623  13223   8848]
 [ 57200 211295  31978]
 [  4779  16613  35290]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.80052435
{'0': {'precision': 0.4083197046163725, 'recall': 0.568165635863571, 'f1-score': 0.4751596670052658, 'support': 71627}, '1': {'precision': 0.8032300551129752, 'recall': 0.7018122095101895, 'f1-score': 0.7491040922561373, 'support': 268512}, '2': {'precision': 0.5121861199139653, 'recall': 0.5534864530325952, 'f1-score': 0.5320359855370399, 'support': 72710}, 'accuracy': 0.6525024888034124, 'macro avg': {'precision': 0.5745786265477709, 'recall': 0.6078214328021186, 'f1-score': 0.5854332482661477, 'support': 412849}, 'weighted avg': {'precision': 0.6834573338436002, 'recall': 0.6525024888034124, 'f1-score': 0.663346734512774, 'support': 412849}}
[[ 40696  20452  10479]
 [ 52217 188445  27850]
 [  6754  25712  40244]]
Evaluating performance on  train set...
634/634 - 10s - 10s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7475826
{'0': {'precision': 0.31299360970014745, 'recall': 0.5970867716929232, 'f1-score': 0.41069854443034975, 'support': 15996}, '1': {'precision': 0.9432917933469201, 'recall': 0.6511604664929235, 'f1-score': 0.7704643653067722, 'support': 130077}, '2': {'precision': 0.28633172548832325, 'recall': 0.7441817166263266, 'f1-score': 0.4135469296959874, 'support': 16113}, 'accuracy': 0.6550688715425499, 'macro avg': {'precision': 0.514205709511797, 'recall': 0.6641429849373911, 'f1-score': 0.5315699464777031, 'support': 162186}, 'weighted avg': {'precision': 0.8158588008628626, 'recall': 0.6550688715425499, 'f1-score': 0.6995222080876791, 'support': 162186}}
[[ 9551  2671  3774]
 [19263 84701 26113]
 [ 1701  2421 11991]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7701899
{'0': {'precision': 0.37874945884099204, 'recall': 0.5704969956681727, 'f1-score': 0.4552567509803557, 'support': 21469}, '1': {'precision': 0.8996432016549865, 'recall': 0.6504983277029867, 'f1-score': 0.7550489902019597, 'support': 118998}, '2': {'precision': 0.3534984590800137, 'recall': 0.7129702104148441, 'f1-score': 0.4726512422929004, 'support': 21719}, 'accuracy': 0.6482742036920572, 'macro avg': {'precision': 0.5439637065253308, 'recall': 0.6446551779286679, 'f1-score': 0.5609856611584053, 'support': 162186}, 'weighted avg': {'precision': 0.7575545785404176, 'recall': 0.6482742036920572, 'f1-score': 0.6775476258999517, 'support': 162186}}
[[12248  4437  4784]
 [18054 77408 23536]
 [ 2036  4198 15485]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8093406
{'0': {'precision': 0.4106188487485763, 'recall': 0.5483191638717728, 'f1-score': 0.46958235225356115, 'support': 25642}, '1': {'precision': 0.856818568064289, 'recall': 0.6380787936863802, 'f1-score': 0.7314452112997161, 'support': 110618}, '2': {'precision': 0.3862663769833432, 'recall': 0.6788937745892154, 'f1-score': 0.4923838697494859, 'support': 25926}, 'accuracy': 0.6304119961032395, 'macro avg': {'precision': 0.5512345979320695, 'recall': 0.6217639107157895, 'f1-score': 0.5644704777675877, 'support': 162186}, 'weighted avg': {'precision': 0.7110538947345435, 'recall': 0.6304119961032395, 'f1-score': 0.6518292655787983, 'support': 162186}}
[[14060  5959  5623]
 [17692 70583 22343]
 [ 2489  5836 17601]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.86653286
{'0': {'precision': 0.4553899210145734, 'recall': 0.5037068938997754, 'f1-score': 0.478331361465317, 'support': 32507}, '1': {'precision': 0.7761116331039386, 'recall': 0.630648755726136, 'f1-score': 0.6958595644402955, 'support': 96924}, '2': {'precision': 0.4252401415571284, 'recall': 0.6163028545260265, 'f1-score': 0.5032470365338353, 'support': 32755}, 'accuracy': 0.6023084606562835, 'macro avg': {'precision': 0.5522472318918802, 'recall': 0.5835528347173127, 'f1-score': 0.5591459874798159, 'support': 162186}, 'weighted avg': {'precision': 0.6409674381641487, 'recall': 0.6023084606562835, 'f1-score': 0.6133603805052844, 'support': 162186}}
[[16374  8714  7419]
 [15933 61125 19866]
 [ 3649  8919 20187]]
Evaluating performance on  val set...
206/206 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.68042284
{'0': {'precision': 0.2846060606060606, 'recall': 0.5874405804353265, 'f1-score': 0.3834408426553441, 'support': 3997}, '1': {'precision': 0.9522380822499015, 'recall': 0.7048227904890085, 'f1-score': 0.8100596826378953, 'support': 44580}, '2': {'precision': 0.26404249760515547, 'recall': 0.730074644835059, 'f1-score': 0.38782297262727045, 'support': 4153}, 'accuracy': 0.6979139010051204, 'macro avg': {'precision': 0.5002955468203725, 'recall': 0.6741126719197981, 'f1-score': 0.5271078326401699, 'support': 52730}, 'weighted avg': {'precision': 0.8474286482741749, 'recall': 0.6979139010051204, 'f1-score': 0.7444661958166477, 'support': 52730}}
[[ 2348   811   838]
 [ 5546 31421  7613]
 [  356   765  3032]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7153262
{'0': {'precision': 0.3522198251390939, 'recall': 0.5699063016718722, 'f1-score': 0.43536842105263157, 'support': 5443}, '1': {'precision': 0.9151221963937928, 'recall': 0.7010299355087112, 'f1-score': 0.7938956261070991, 'support': 41556}, '2': {'precision': 0.325585242782695, 'recall': 0.6867911359274124, 'f1-score': 0.4417508417508418, 'support': 5731}, 'accuracy': 0.6859472785890385, 'macro avg': {'precision': 0.5309757547718607, 'recall': 0.6525757910359986, 'f1-score': 0.5570049629701909, 'support': 52730}, 'weighted avg': {'precision': 0.792942907793669, 'recall': 0.6859472785890385, 'f1-score': 0.7186139015431473, 'support': 52730}}
[[ 3102  1328  1013]
 [ 5284 29132  7140]
 [  421  1374  3936]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.76405054
{'0': {'precision': 0.3887580299785867, 'recall': 0.5515722315053927, 'f1-score': 0.45606983608616464, 'support': 6583}, '1': {'precision': 0.8789379377748819, 'recall': 0.6876258442716962, 'f1-score': 0.7716001716001716, 'support': 39235}, '2': {'precision': 0.35667585663647106, 'recall': 0.6550925925925926, 'f1-score': 0.4618758606620084, 'support': 6912}, 'accuracy': 0.6663758771098046, 'macro avg': {'precision': 0.5414572747966466, 'recall': 0.6314302227898938, 'f1-score': 0.5631819561161149, 'support': 52730}, 'weighted avg': {'precision': 0.7492825264748306, 'recall': 0.6663758771098046, 'f1-score': 0.6916086935820929, 'support': 52730}}
[[ 3631  1809  1143]
 [ 5232 26979  7024]
 [  477  1907  4528]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.83026785
{'0': {'precision': 0.43132700464552615, 'recall': 0.49964904071127747, 'f1-score': 0.46298102981029804, 'support': 8548}, '1': {'precision': 0.8086043360433605, 'recall': 0.6767215717404247, 'f1-score': 0.7368079885172781, 'support': 35273}, '2': {'precision': 0.3957769762548843, 'recall': 0.5911999102031653, 'f1-score': 0.47414142323446007, 'support': 8909}, 'accuracy': 0.6335672292812441, 'macro avg': {'precision': 0.5452361056479237, 'recall': 0.5891901742182891, 'f1-score': 0.5579768138540121, 'support': 52730}, 'weighted avg': {'precision': 0.6776950704043652, 'recall': 0.6335672292812441, 'f1-score': 0.6480393696450633, 'support': 52730}}
[[ 4271  2754  1523]
 [ 4885 23870  6518]
 [  746  2896  5267]]
training model: results/QRTEA/W5/deepLOB_L1/seq2seq
Epoch 1/50
589/589 - 19s - loss: 11.4025 - accuracy10: 0.4631 - accuracy20: 0.4711 - accuracy30: 0.4755 - accuracy50: 0.4863 - val_loss: 13.0581 - val_accuracy10: 0.4916 - val_accuracy20: 0.4688 - val_accuracy30: 0.4514 - val_accuracy50: 0.4452 - 19s/epoch - 32ms/step
Epoch 2/50
589/589 - 12s - loss: 11.0402 - accuracy10: 0.5048 - accuracy20: 0.5160 - accuracy30: 0.5230 - accuracy50: 0.5293 - val_loss: 12.6304 - val_accuracy10: 0.4057 - val_accuracy20: 0.4186 - val_accuracy30: 0.4252 - val_accuracy50: 0.4379 - 12s/epoch - 21ms/step
Epoch 3/50
589/589 - 12s - loss: 10.7877 - accuracy10: 0.5169 - accuracy20: 0.5282 - accuracy30: 0.5351 - accuracy50: 0.5402 - val_loss: 12.6208 - val_accuracy10: 0.4610 - val_accuracy20: 0.4735 - val_accuracy30: 0.4757 - val_accuracy50: 0.4759 - 12s/epoch - 20ms/step
Epoch 4/50
589/589 - 12s - loss: 10.5553 - accuracy10: 0.5368 - accuracy20: 0.5463 - accuracy30: 0.5520 - accuracy50: 0.5552 - val_loss: 12.7193 - val_accuracy10: 0.4993 - val_accuracy20: 0.5032 - val_accuracy30: 0.5026 - val_accuracy50: 0.4971 - 12s/epoch - 21ms/step
Epoch 5/50
589/589 - 12s - loss: 10.3115 - accuracy10: 0.5699 - accuracy20: 0.5735 - accuracy30: 0.5736 - accuracy50: 0.5709 - val_loss: 12.5614 - val_accuracy10: 0.5354 - val_accuracy20: 0.5339 - val_accuracy30: 0.5282 - val_accuracy50: 0.5148 - 12s/epoch - 21ms/step
Epoch 6/50
589/589 - 12s - loss: 10.0736 - accuracy10: 0.5933 - accuracy20: 0.5921 - accuracy30: 0.5878 - accuracy50: 0.5807 - val_loss: 12.4214 - val_accuracy10: 0.5628 - val_accuracy20: 0.5568 - val_accuracy30: 0.5474 - val_accuracy50: 0.5304 - 12s/epoch - 21ms/step
Epoch 7/50
589/589 - 13s - loss: 9.8728 - accuracy10: 0.6169 - accuracy20: 0.6087 - accuracy30: 0.5985 - accuracy50: 0.5874 - val_loss: 12.1025 - val_accuracy10: 0.5991 - val_accuracy20: 0.5871 - val_accuracy30: 0.5723 - val_accuracy50: 0.5484 - 13s/epoch - 21ms/step
Epoch 8/50
589/589 - 12s - loss: 9.7038 - accuracy10: 0.6369 - accuracy20: 0.6246 - accuracy30: 0.6115 - accuracy50: 0.5963 - val_loss: 12.2223 - val_accuracy10: 0.6375 - val_accuracy20: 0.6166 - val_accuracy30: 0.5939 - val_accuracy50: 0.5598 - 12s/epoch - 20ms/step
Epoch 9/50
589/589 - 12s - loss: 9.5770 - accuracy10: 0.6451 - accuracy20: 0.6318 - accuracy30: 0.6159 - accuracy50: 0.5985 - val_loss: 12.1681 - val_accuracy10: 0.6529 - val_accuracy20: 0.6296 - val_accuracy30: 0.6043 - val_accuracy50: 0.5670 - 12s/epoch - 21ms/step
Epoch 10/50
589/589 - 13s - loss: 9.5137 - accuracy10: 0.6518 - accuracy20: 0.6362 - accuracy30: 0.6192 - accuracy50: 0.6008 - val_loss: 12.2121 - val_accuracy10: 0.6673 - val_accuracy20: 0.6452 - val_accuracy30: 0.6176 - val_accuracy50: 0.5776 - 13s/epoch - 21ms/step
Epoch 11/50
589/589 - 12s - loss: 9.4295 - accuracy10: 0.6561 - accuracy20: 0.6406 - accuracy30: 0.6215 - accuracy50: 0.6034 - val_loss: 12.2776 - val_accuracy10: 0.6729 - val_accuracy20: 0.6474 - val_accuracy30: 0.6203 - val_accuracy50: 0.5748 - 12s/epoch - 21ms/step
Epoch 12/50
589/589 - 12s - loss: 9.3694 - accuracy10: 0.6595 - accuracy20: 0.6422 - accuracy30: 0.6228 - accuracy50: 0.6032 - val_loss: 12.2266 - val_accuracy10: 0.6797 - val_accuracy20: 0.6531 - val_accuracy30: 0.6233 - val_accuracy50: 0.5808 - 12s/epoch - 21ms/step
Epoch 13/50
589/589 - 13s - loss: 9.3124 - accuracy10: 0.6642 - accuracy20: 0.6461 - accuracy30: 0.6261 - accuracy50: 0.6053 - val_loss: 12.2366 - val_accuracy10: 0.6802 - val_accuracy20: 0.6526 - val_accuracy30: 0.6225 - val_accuracy50: 0.5789 - 13s/epoch - 22ms/step
Epoch 14/50
589/589 - 13s - loss: 9.2795 - accuracy10: 0.6658 - accuracy20: 0.6485 - accuracy30: 0.6269 - accuracy50: 0.6058 - val_loss: 12.4958 - val_accuracy10: 0.6743 - val_accuracy20: 0.6458 - val_accuracy30: 0.6156 - val_accuracy50: 0.5727 - 13s/epoch - 22ms/step
Epoch 15/50
589/589 - 12s - loss: 9.2365 - accuracy10: 0.6666 - accuracy20: 0.6491 - accuracy30: 0.6277 - accuracy50: 0.6062 - val_loss: 12.4148 - val_accuracy10: 0.6855 - val_accuracy20: 0.6557 - val_accuracy30: 0.6252 - val_accuracy50: 0.5789 - 12s/epoch - 20ms/step
Epoch 16/50
589/589 - 12s - loss: 9.1881 - accuracy10: 0.6694 - accuracy20: 0.6512 - accuracy30: 0.6314 - accuracy50: 0.6097 - val_loss: 12.2472 - val_accuracy10: 0.6782 - val_accuracy20: 0.6529 - val_accuracy30: 0.6261 - val_accuracy50: 0.5822 - 12s/epoch - 20ms/step
Epoch 17/50
589/589 - 13s - loss: 9.1446 - accuracy10: 0.6718 - accuracy20: 0.6541 - accuracy30: 0.6331 - accuracy50: 0.6103 - val_loss: 12.4567 - val_accuracy10: 0.7032 - val_accuracy20: 0.6725 - val_accuracy30: 0.6396 - val_accuracy50: 0.5899 - 13s/epoch - 22ms/step
testing model: results/QRTEA/W5/deepLOB_L1/seq2seq
Evaluating performance on  test set...
2185/2185 - 22s - 22s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.96543413
{'0': {'precision': 0.39443044974195135, 'recall': 0.31783694131917367, 'f1-score': 0.3520154629635976, 'support': 80793}, '1': {'precision': 0.8211889519193306, 'recall': 0.5785420543802081, 'f1-score': 0.6788337775466423, 'support': 397093}, '2': {'precision': 0.2623925203995465, 'recall': 0.6916133792424988, 'f1-score': 0.380446657173877, 'support': 81320}, 'accuracy': 0.5573187698272193, 'macro avg': {'precision': 0.49267064068694283, 'recall': 0.5293307916472935, 'f1-score': 0.4704319658947056, 'support': 559206}, 'weighted avg': {'precision': 0.6782712695668419, 'recall': 0.5573187698272193, 'f1-score': 0.5882241046911629, 'support': 559206}}
[[ 25679  30898  24216]
 [ 33473 229735 133885]
 [  5952  19126  56242]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0164483
{'0': {'precision': 0.44975361893993326, 'recall': 0.3145833740162862, 'f1-score': 0.37021631093619833, 'support': 102418}, '1': {'precision': 0.7484125799451149, 'recall': 0.5525726816476014, 'f1-score': 0.6357525461476563, 'support': 353872}, '2': {'precision': 0.3080567044932301, 'recall': 0.677367950561623, 'f1-score': 0.42350825607815024, 'support': 102916}, 'accuracy': 0.5319524468621581, 'macro avg': {'precision': 0.5020743011260927, 'recall': 0.5148413354085036, 'f1-score': 0.47649237105400166, 'support': 559206}, 'weighted avg': {'precision': 0.6126706194757443, 'recall': 0.5319524468621581, 'f1-score': 0.54805852373967, 'support': 559206}}
[[ 32219  39999  30200]
 [ 31948 195540 126384]
 [  7470  25734  69712]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.053261
{'0': {'precision': 0.47529347172475095, 'recall': 0.3081845767855024, 'f1-score': 0.3739176042287995, 'support': 117978}, '1': {'precision': 0.6877531512264671, 'recall': 0.526198681078937, 'f1-score': 0.5962259645771593, 'support': 322688}, '2': {'precision': 0.3338690526672886, 'recall': 0.664189303188797, 'f1-score': 0.44436731008014446, 'support': 118540}, 'accuracy': 0.5094544765256452, 'macro avg': {'precision': 0.49897189187283547, 'recall': 0.4995241870177454, 'f1-score': 0.47150362629536774, 'support': 559206}, 'weighted avg': {'precision': 0.5679136124671217, 'recall': 0.5094544765256452, 'f1-score': 0.5171337863078723, 'support': 559206}}
[[ 36359  46215  35404]
 [ 31207 169798 121683]
 [  8932  30875  78733]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1003025
{'0': {'precision': 0.5063126902540047, 'recall': 0.28393524283935245, 'f1-score': 0.3638352234524183, 'support': 142934}, '1': {'precision': 0.5827163123588804, 'recall': 0.5014039795304917, 'f1-score': 0.5390108092984399, 'support': 272796}, '2': {'precision': 0.3714963981663392, 'recall': 0.632607544118877, 'f1-score': 0.4681017854748373, 'support': 143476}, 'accuracy': 0.4794816221571299, 'macro avg': {'precision': 0.48684180025974144, 'recall': 0.47264892216290705, 'f1-score': 0.45698260607523183, 'support': 559206}, 'weighted avg': {'precision': 0.508994528739557, 'recall': 0.4794816221571299, 'f1-score': 0.4760424393427698, 'support': 559206}}
[[ 40584  57112  45238]
 [ 27697 136781 108318]
 [ 11875  40837  90764]]
Evaluating performance on  train set...
589/589 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8322448
{'0': {'precision': 0.2822005703422053, 'recall': 0.5819176739627573, 'f1-score': 0.38008108396457907, 'support': 12244}, '1': {'precision': 0.9391928906202447, 'recall': 0.612175265421421, 'f1-score': 0.7412175567201964, 'support': 126026}, '2': {'precision': 0.20580627280705807, 'recall': 0.7174140568392239, 'f1-score': 0.3198549866293365, 'support': 12421}, 'accuracy': 0.6183912775149146, 'macro avg': {'precision': 0.47573324458983596, 'recall': 0.6371689987411341, 'f1-score': 0.4803845424380373, 'support': 150691}, 'weighted avg': {'precision': 0.8253598869946671, 'recall': 0.6183912775149146, 'f1-score': 0.6771427317106181, 'support': 150691}}
[[ 7125  2730  2389]
 [16878 77150 31998]
 [ 1245  2265  8911]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.86118597
{'0': {'precision': 0.35287200029399873, 'recall': 0.5734934002269605, 'f1-score': 0.4369113163762115, 'support': 16743}, '1': {'precision': 0.9011697117126443, 'recall': 0.5962944570968681, 'f1-score': 0.7176966436866891, 'support': 116798}, '2': {'precision': 0.2585938176465495, 'recall': 0.6965597667638483, 'f1-score': 0.3771666719287722, 'support': 17150}, 'accuracy': 0.6051721735206482, 'macro avg': {'precision': 0.5042118432177308, 'recall': 0.6221158746958924, 'f1-score': 0.5105915439972243, 'support': 150691}, 'weighted avg': {'precision': 0.7671184069531305, 'recall': 0.6051721735206482, 'f1-score': 0.6477437085358997, 'support': 150691}}
[[ 9602  4056  3085]
 [15987 69646 31165]
 [ 1622  3582 11946]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.88946503
{'0': {'precision': 0.3954770712640469, 'recall': 0.5600197677291822, 'f1-score': 0.46358076458917147, 'support': 20235}, '1': {'precision': 0.8642457037198172, 'recall': 0.579536130408621, 'f1-score': 0.6938189676813761, 'support': 109686}, '2': {'precision': 0.28841909869031657, 'recall': 0.6732787674530573, 'f1-score': 0.40384087791495193, 'support': 20770}, 'accuracy': 0.589836154780312, 'macro avg': {'precision': 0.5160472912247269, 'recall': 0.6042782218636201, 'f1-score': 0.5204135367284999, 'support': 150691}, 'weighted avg': {'precision': 0.7219316181791728, 'recall': 0.589836154780312, 'f1-score': 0.6229340776480006, 'support': 150691}}
[[11332  5200  3703]
 [15321 63567 30798]
 [ 2001  4785 13984]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9257435
{'0': {'precision': 0.4534396675937406, 'recall': 0.5136263569422304, 'f1-score': 0.4816601114097065, 'support': 26346}, '1': {'precision': 0.7883044756615485, 'recall': 0.56941323730083, 'f1-score': 0.6612140346696849, 'support': 97467}, '2': {'precision': 0.3335315690355833, 'recall': 0.625976635166307, 'f1-score': 0.4351874603934146, 'support': 26878}, 'accuracy': 0.5697486910299885, 'macro avg': {'precision': 0.5250919040969575, 'recall': 0.5696720764697891, 'f1-score': 0.5260205354909354, 'support': 150691}, 'weighted avg': {'precision': 0.6486429536220959, 'recall': 0.5697486910299885, 'f1-score': 0.589506567564118, 'support': 150691}}
[[13532  7712  5102]
 [13450 55499 28518]
 [ 2861  7192 16825]]
Evaluating performance on  val set...
222/222 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.85337335
{'0': {'precision': 0.25411375760763394, 'recall': 0.611794500723589, 'f1-score': 0.35908053299357645, 'support': 5528}, '1': {'precision': 0.915392770425088, 'recall': 0.5895944844600102, 'f1-score': 0.717229367631297, 'support': 45399}, '2': {'precision': 0.2701092353525323, 'recall': 0.6656178989687118, 'f1-score': 0.384277713305414, 'support': 5721}, 'accuracy': 0.5994386386103657, 'macro avg': {'precision': 0.4798719211284181, 'recall': 0.6223356280507704, 'f1-score': 0.48686253797676254, 'support': 56648}, 'weighted avg': {'precision': 0.7856932667002438, 'recall': 0.5994386386103657, 'f1-score': 0.6486538985542651, 'support': 56648}}
[[ 3382  1212   934]
 [ 9276 26767  9356]
 [  651  1262  3808]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.88771915
{'0': {'precision': 0.3152592177989226, 'recall': 0.6013612705191512, 'f1-score': 0.41366014871936113, 'support': 7493}, '1': {'precision': 0.8642280561413715, 'recall': 0.5755660491584937, 'f1-score': 0.6909603616436764, 'support': 41295}, '2': {'precision': 0.33420857739177273, 'recall': 0.6315521628498728, 'f1-score': 0.4371065028838111, 'support': 7860}, 'accuracy': 0.586746222284988, 'macro avg': {'precision': 0.5045652837773557, 'recall': 0.6028264941758392, 'f1-score': 0.5139090044156162, 'support': 56648}, 'weighted avg': {'precision': 0.7180732649983159, 'recall': 0.586746222284988, 'f1-score': 0.619058408789305, 'support': 56648}}
[[ 4506  1812  1175]
 [ 8813 23768  8714]
 [  974  1922  4964]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9177884
{'0': {'precision': 0.3517781316348195, 'recall': 0.5869589283737408, 'f1-score': 0.43990873262808544, 'support': 9033}, '1': {'precision': 0.8170307180291496, 'recall': 0.560106996748138, 'f1-score': 0.6646025547274905, 'support': 38132}, '2': {'precision': 0.3703271784904438, 'recall': 0.6027628387641042, 'f1-score': 0.4587848141905449, 'support': 9483}, 'accuracy': 0.571529444993645, 'macro avg': {'precision': 0.5130453427181377, 'recall': 0.583276254628661, 'f1-score': 0.5210987005153737, 'support': 56648}, 'weighted avg': {'precision': 0.6680631237920092, 'recall': 0.571529444993645, 'f1-score': 0.5943188919585352, 'support': 56648}}
[[ 5302  2324  1407]
 [ 8462 21358  8312]
 [ 1308  2459  5716]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9596363
{'0': {'precision': 0.4027175299821383, 'recall': 0.5432406849668703, 'f1-score': 0.46254167124592444, 'support': 11621}, '1': {'precision': 0.722991357234315, 'recall': 0.55073303057088, 'f1-score': 0.6252140966419266, 'support': 32809}, '2': {'precision': 0.42015018773466833, 'recall': 0.5495171059093141, 'f1-score': 0.47620398609830483, 'support': 12218}, 'accuracy': 0.5489337664171727, 'macro avg': {'precision': 0.5152863583170405, 'recall': 0.5478302738156882, 'f1-score': 0.5213199179953852, 'support': 56648}, 'weighted avg': {'precision': 0.5919714526402564, 'recall': 0.5489337664171727, 'f1-score': 0.5597038970559056, 'support': 56648}}
[[ 6313  3327  1981]
 [ 7455 18069  7285]
 [ 1908  3596  6714]]
training model: results/QRTEA/W5/deepOF_L1/seq2seq
Epoch 1/50
589/589 - 18s - loss: 11.9343 - accuracy10: 0.4297 - accuracy20: 0.4339 - accuracy30: 0.4329 - accuracy50: 0.4368 - val_loss: 13.3241 - val_accuracy10: 0.5539 - val_accuracy20: 0.5419 - val_accuracy30: 0.5261 - val_accuracy50: 0.4974 - 18s/epoch - 31ms/step
Epoch 2/50
589/589 - 12s - loss: 11.4483 - accuracy10: 0.4500 - accuracy20: 0.4541 - accuracy30: 0.4542 - accuracy50: 0.4586 - val_loss: 13.0628 - val_accuracy10: 0.5861 - val_accuracy20: 0.5662 - val_accuracy30: 0.5452 - val_accuracy50: 0.5118 - 12s/epoch - 20ms/step
Epoch 3/50
589/589 - 12s - loss: 11.2051 - accuracy10: 0.4779 - accuracy20: 0.4764 - accuracy30: 0.4739 - accuracy50: 0.4780 - val_loss: 12.7958 - val_accuracy10: 0.5880 - val_accuracy20: 0.5641 - val_accuracy30: 0.5408 - val_accuracy50: 0.5090 - 12s/epoch - 21ms/step
Epoch 4/50
589/589 - 12s - loss: 11.0654 - accuracy10: 0.4961 - accuracy20: 0.4899 - accuracy30: 0.4851 - accuracy50: 0.4867 - val_loss: 12.7603 - val_accuracy10: 0.5899 - val_accuracy20: 0.5691 - val_accuracy30: 0.5513 - val_accuracy50: 0.5236 - 12s/epoch - 21ms/step
Epoch 5/50
589/589 - 12s - loss: 10.9585 - accuracy10: 0.5143 - accuracy20: 0.5064 - accuracy30: 0.5008 - accuracy50: 0.5011 - val_loss: 12.6475 - val_accuracy10: 0.5808 - val_accuracy20: 0.5549 - val_accuracy30: 0.5377 - val_accuracy50: 0.5155 - 12s/epoch - 20ms/step
Epoch 6/50
589/589 - 11s - loss: 10.8422 - accuracy10: 0.5345 - accuracy20: 0.5220 - accuracy30: 0.5154 - accuracy50: 0.5138 - val_loss: 12.6300 - val_accuracy10: 0.6096 - val_accuracy20: 0.5840 - val_accuracy30: 0.5656 - val_accuracy50: 0.5389 - 11s/epoch - 19ms/step
Epoch 7/50
589/589 - 11s - loss: 10.7675 - accuracy10: 0.5483 - accuracy20: 0.5337 - accuracy30: 0.5242 - accuracy50: 0.5217 - val_loss: 12.6791 - val_accuracy10: 0.6163 - val_accuracy20: 0.5876 - val_accuracy30: 0.5693 - val_accuracy50: 0.5410 - 11s/epoch - 19ms/step
Epoch 8/50
589/589 - 12s - loss: 10.7026 - accuracy10: 0.5526 - accuracy20: 0.5359 - accuracy30: 0.5259 - accuracy50: 0.5232 - val_loss: 12.5897 - val_accuracy10: 0.6277 - val_accuracy20: 0.5991 - val_accuracy30: 0.5765 - val_accuracy50: 0.5460 - 12s/epoch - 20ms/step
Epoch 9/50
589/589 - 11s - loss: 10.5942 - accuracy10: 0.5594 - accuracy20: 0.5428 - accuracy30: 0.5327 - accuracy50: 0.5317 - val_loss: 12.6134 - val_accuracy10: 0.6458 - val_accuracy20: 0.6138 - val_accuracy30: 0.5889 - val_accuracy50: 0.5553 - 11s/epoch - 19ms/step
Epoch 10/50
589/589 - 11s - loss: 10.5311 - accuracy10: 0.5603 - accuracy20: 0.5421 - accuracy30: 0.5341 - accuracy50: 0.5331 - val_loss: 12.5989 - val_accuracy10: 0.6283 - val_accuracy20: 0.5952 - val_accuracy30: 0.5734 - val_accuracy50: 0.5460 - 11s/epoch - 19ms/step
Epoch 11/50
589/589 - 12s - loss: 10.4570 - accuracy10: 0.5672 - accuracy20: 0.5487 - accuracy30: 0.5398 - accuracy50: 0.5392 - val_loss: 12.7005 - val_accuracy10: 0.6287 - val_accuracy20: 0.5954 - val_accuracy30: 0.5762 - val_accuracy50: 0.5496 - 12s/epoch - 21ms/step
Epoch 12/50
589/589 - 12s - loss: 10.3909 - accuracy10: 0.5732 - accuracy20: 0.5528 - accuracy30: 0.5426 - accuracy50: 0.5410 - val_loss: 12.6256 - val_accuracy10: 0.6318 - val_accuracy20: 0.5938 - val_accuracy30: 0.5714 - val_accuracy50: 0.5420 - 12s/epoch - 20ms/step
Epoch 13/50
589/589 - 11s - loss: 10.3271 - accuracy10: 0.5768 - accuracy20: 0.5561 - accuracy30: 0.5456 - accuracy50: 0.5445 - val_loss: 12.5423 - val_accuracy10: 0.6071 - val_accuracy20: 0.5741 - val_accuracy30: 0.5544 - val_accuracy50: 0.5342 - 11s/epoch - 19ms/step
Epoch 14/50
589/589 - 12s - loss: 10.2804 - accuracy10: 0.5816 - accuracy20: 0.5608 - accuracy30: 0.5495 - accuracy50: 0.5460 - val_loss: 12.6003 - val_accuracy10: 0.6304 - val_accuracy20: 0.5939 - val_accuracy30: 0.5717 - val_accuracy50: 0.5433 - 12s/epoch - 20ms/step
Epoch 15/50
589/589 - 12s - loss: 10.2070 - accuracy10: 0.5836 - accuracy20: 0.5629 - accuracy30: 0.5511 - accuracy50: 0.5492 - val_loss: 12.7057 - val_accuracy10: 0.6318 - val_accuracy20: 0.5971 - val_accuracy30: 0.5779 - val_accuracy50: 0.5506 - 12s/epoch - 20ms/step
Epoch 16/50
589/589 - 11s - loss: 10.1707 - accuracy10: 0.5858 - accuracy20: 0.5639 - accuracy30: 0.5527 - accuracy50: 0.5517 - val_loss: 12.6086 - val_accuracy10: 0.6283 - val_accuracy20: 0.5912 - val_accuracy30: 0.5697 - val_accuracy50: 0.5432 - 11s/epoch - 19ms/step
Epoch 17/50
589/589 - 11s - loss: 10.1206 - accuracy10: 0.5881 - accuracy20: 0.5661 - accuracy30: 0.5538 - accuracy50: 0.5521 - val_loss: 12.6684 - val_accuracy10: 0.6321 - val_accuracy20: 0.5919 - val_accuracy30: 0.5652 - val_accuracy50: 0.5396 - 11s/epoch - 19ms/step
Epoch 18/50
589/589 - 11s - loss: 10.0875 - accuracy10: 0.5921 - accuracy20: 0.5693 - accuracy30: 0.5568 - accuracy50: 0.5546 - val_loss: 12.6264 - val_accuracy10: 0.6322 - val_accuracy20: 0.5937 - val_accuracy30: 0.5708 - val_accuracy50: 0.5448 - 11s/epoch - 19ms/step
Epoch 19/50
589/589 - 11s - loss: 10.0146 - accuracy10: 0.5943 - accuracy20: 0.5712 - accuracy30: 0.5588 - accuracy50: 0.5558 - val_loss: 12.7417 - val_accuracy10: 0.6517 - val_accuracy20: 0.6099 - val_accuracy30: 0.5814 - val_accuracy50: 0.5512 - 11s/epoch - 19ms/step
Epoch 20/50
589/589 - 12s - loss: 9.9692 - accuracy10: 0.5928 - accuracy20: 0.5708 - accuracy30: 0.5580 - accuracy50: 0.5560 - val_loss: 12.7265 - val_accuracy10: 0.6428 - val_accuracy20: 0.6016 - val_accuracy30: 0.5749 - val_accuracy50: 0.5467 - 12s/epoch - 20ms/step
Epoch 21/50
589/589 - 11s - loss: 9.9133 - accuracy10: 0.5969 - accuracy20: 0.5763 - accuracy30: 0.5646 - accuracy50: 0.5610 - val_loss: 12.9178 - val_accuracy10: 0.6440 - val_accuracy20: 0.6074 - val_accuracy30: 0.5828 - val_accuracy50: 0.5536 - 11s/epoch - 19ms/step
Epoch 22/50
589/589 - 11s - loss: 9.8746 - accuracy10: 0.5969 - accuracy20: 0.5767 - accuracy30: 0.5649 - accuracy50: 0.5606 - val_loss: 12.6690 - val_accuracy10: 0.6413 - val_accuracy20: 0.6003 - val_accuracy30: 0.5741 - val_accuracy50: 0.5461 - 11s/epoch - 19ms/step
Epoch 23/50
589/589 - 11s - loss: 9.8229 - accuracy10: 0.6011 - accuracy20: 0.5791 - accuracy30: 0.5658 - accuracy50: 0.5609 - val_loss: 12.7808 - val_accuracy10: 0.6561 - val_accuracy20: 0.6171 - val_accuracy30: 0.5884 - val_accuracy50: 0.5554 - 11s/epoch - 19ms/step
testing model: results/QRTEA/W5/deepOF_L1/seq2seq
Evaluating performance on  test set...
2185/2185 - 16s - 16s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9192673
{'0': {'precision': 0.29090530789980157, 'recall': 0.48456492140116353, 'f1-score': 0.3635536280605303, 'support': 80790}, '1': {'precision': 0.807550526230351, 'recall': 0.6013276486868315, 'f1-score': 0.6893462724872651, 'support': 397093}, '2': {'precision': 0.2810997363114627, 'recall': 0.4457192749452766, 'f1-score': 0.34476690542095906, 'support': 81318}, 'accuracy': 0.5618301827071125, 'macro avg': {'precision': 0.4598518568138717, 'recall': 0.5105372816777572, 'f1-score': 0.46588893532291814, 'support': 559201}, 'weighted avg': {'precision': 0.6563532062621299, 'recall': 0.5618301827071125, 'f1-score': 0.5921695994943095, 'support': 559201}}
[[ 39148  28269  13373]
 [ 78988 238783  79322]
 [ 16437  28636  36245]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.96631175
{'0': {'precision': 0.3369963608853875, 'recall': 0.504540306202156, 'f1-score': 0.4040899315738026, 'support': 102416}, '1': {'precision': 0.7386540348758209, 'recall': 0.5530235594326747, 'f1-score': 0.6325000686800978, 'support': 353871}, '2': {'precision': 0.33037671986205625, 'recall': 0.4524068639835202, 'f1-score': 0.3818799955708843, 'support': 102914}, 'accuracy': 0.5256267424414477, 'macro avg': {'precision': 0.46867570520775487, 'recall': 0.5033235765394503, 'f1-score': 0.47282333194159487, 'support': 559201}, 'weighted avg': {'precision': 0.5899532565568787, 'recall': 0.5256267424414477, 'f1-score': 0.5445439190919534, 'support': 559201}}
[[ 51673  34214  16529]
 [ 80333 195699  77839]
 [ 21328  35027  46559]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9915502
{'0': {'precision': 0.36629472400046825, 'recall': 0.5039203221021403, 'f1-score': 0.42422469280280867, 'support': 117975}, '1': {'precision': 0.6795273091094655, 'recall': 0.5240851844506148, 'f1-score': 0.5917688575672587, 'support': 322688}, '2': {'precision': 0.36115708620724596, 'recall': 0.45100305387301964, 'f1-score': 0.4011104233489018, 'support': 118538}, 'accuracy': 0.5043392268611823, 'macro avg': {'precision': 0.4689930397723932, 'recall': 0.49300285347525824, 'f1-score': 0.4723679912396564, 'support': 559201}, 'weighted avg': {'precision': 0.5459571193018341, 'recall': 0.5043392268611823, 'f1-score': 0.5160066677402348, 'support': 559201}}
[[ 59450  39551  18974]
 [ 77980 169116  75592]
 [ 24871  40206  53461]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0227828
{'0': {'precision': 0.41403241043528816, 'recall': 0.47833935018050544, 'f1-score': 0.44386880648177, 'support': 142932}, '1': {'precision': 0.5770766348411588, 'recall': 0.5171300165691579, 'f1-score': 0.5454612240794658, 'support': 272796}, '2': {'precision': 0.4099230671541531, 'recall': 0.42746021899590864, 'f1-score': 0.4185080045311242, 'support': 143473}, 'accuracy': 0.48420871922618164, 'macro avg': {'precision': 0.46701070414353335, 'recall': 0.47430986191519064, 'f1-score': 0.46927934503078667, 'support': 559201}, 'weighted avg': {'precision': 0.49251623366244546, 'recall': 0.48420871922618164, 'f1-score': 0.4869220463949962, 'support': 559201}}
[[ 68370  51426  23136]
 [ 66579 141071  65146]
 [ 30183  51961  61329]]
Evaluating performance on  train set...
589/589 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8150016
{'0': {'precision': 0.23191547006231375, 'recall': 0.6296175220660346, 'f1-score': 0.3389726102738973, 'support': 12236}, '1': {'precision': 0.9256570129945807, 'recall': 0.6303600765073293, 'f1-score': 0.7499881967460789, 'support': 126001}, '2': {'precision': 0.23229962736057602, 'recall': 0.590701035894965, 'f1-score': 0.3334617738389356, 'support': 12453}, 'accuracy': 0.6270223637932179, 'macro avg': {'precision': 0.4632907034724902, 'recall': 0.6168928781561096, 'f1-score': 0.4741408602863039, 'support': 150690}, 'weighted avg': {'precision': 0.8120263736514293, 'recall': 0.6270223637932179, 'f1-score': 0.6821921236122527, 'support': 150690}}
[[ 7704  3097  1435]
 [23700 79426 22875]
 [ 1815  3282  7356]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.85096085
{'0': {'precision': 0.2844721822158212, 'recall': 0.6381476606437717, 'f1-score': 0.393521251475797, 'support': 16714}, '1': {'precision': 0.8858979254168258, 'recall': 0.5959026077427529, 'f1-score': 0.7125235443452624, 'support': 116806}, '2': {'precision': 0.28998440478253334, 'recall': 0.5847990681421084, 'f1-score': 0.38771333693721516, 'support': 17170}, 'accuracy': 0.5993231136770855, 'macro avg': {'precision': 0.48678483747172674, 'recall': 0.606283112176211, 'f1-score': 0.49791937758609156, 'support': 150690}, 'weighted avg': {'precision': 0.7512900216332143, 'recall': 0.5993231136770855, 'f1-score': 0.6401312450273487, 'support': 150690}}
[[10666  4280  1768]
 [24384 69605 22817]
 [ 2444  4685 10041]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8740307
{'0': {'precision': 0.32211538461538464, 'recall': 0.6288593587906931, 'f1-score': 0.42601609691615216, 'support': 20243}, '1': {'precision': 0.8475645697138571, 'recall': 0.5768298019765873, 'f1-score': 0.6864678948853157, 'support': 109684}, '2': {'precision': 0.32599529050982967, 'recall': 0.5734238790155565, 'f1-score': 0.41567600593523607, 'support': 20763}, 'accuracy': 0.5833499236843852, 'macro avg': {'precision': 0.49855841494635716, 'recall': 0.5930376799276122, 'f1-score': 0.5093866659122346, 'support': 150690}, 'weighted avg': {'precision': 0.7051131077849859, 'recall': 0.5833499236843852, 'f1-score': 0.6141686199728444, 'support': 150690}}
[[12730  5493  2020]
 [23819 63269 22596]
 [ 2971  5886 11906]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.89844775
{'0': {'precision': 0.3807933818399282, 'recall': 0.5792805428149047, 'f1-score': 0.4595191917369537, 'support': 26381}, '1': {'precision': 0.7680800718035194, 'recall': 0.5796803957591371, 'f1-score': 0.6607123012043259, 'support': 97433}, '2': {'precision': 0.3816983578219533, 'recall': 0.5258222949843727, 'f1-score': 0.4423161189358373, 'support': 26876}, 'accuracy': 0.5700046452982945, 'macro avg': {'precision': 0.5101906038218004, 'recall': 0.5615944111861382, 'f1-score': 0.520849203959039, 'support': 150690}, 'weighted avg': {'precision': 0.631366254609956, 'recall': 0.5700046452982946, 'f1-score': 0.5865382271748173, 'support': 150690}}
[[15282  8352  2747]
 [20808 56480 20145]
 [ 4042  8702 14132]]
Evaluating performance on  val set...
222/222 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8529812
{'0': {'precision': 0.2415162184433291, 'recall': 0.5853304284676834, 'f1-score': 0.3419419844089728, 'support': 5508}, '1': {'precision': 0.8921928341256421, 'recall': 0.6159878406062075, 'f1-score': 0.728798540526453, 'support': 45397}, '2': {'precision': 0.2640515222482436, 'recall': 0.5497126937140867, 'f1-score': 0.3567433188315724, 'support': 5743}, 'accuracy': 0.6062879536788589, 'macro avg': {'precision': 0.4659201916057383, 'recall': 0.5836769875959925, 'f1-score': 0.4758279479223327, 'support': 56648}, 'weighted avg': {'precision': 0.7652449744785216, 'recall': 0.6062879536788589, 'f1-score': 0.6534645649352798, 'support': 56648}}
[[ 3224  1649   635]
 [ 9269 27964  8164]
 [  856  1730  3157]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8953026
{'0': {'precision': 0.2923706441393875, 'recall': 0.5908242197919445, 'f1-score': 0.39116997792494484, 'support': 7498}, '1': {'precision': 0.8372544178335861, 'recall': 0.5750799496075201, 'f1-score': 0.6818331968920103, 'support': 41276}, '2': {'precision': 0.32483834157474323, 'recall': 0.5422910845821691, 'f1-score': 0.4062990627527475, 'support': 7874}, 'accuracy': 0.572606270300805, 'macro avg': {'precision': 0.4848211345159057, 'recall': 0.5693984179938779, 'f1-score': 0.49310074585656755, 'support': 56648}, 'weighted avg': {'precision': 0.6939077379927934, 'recall': 0.572606270300805, 'f1-score': 0.6050617559227331, 'support': 56648}}
[[ 4430  2250   818]
 [ 9482 23737  8057]
 [ 1240  2364  4270]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9217017
{'0': {'precision': 0.3275272161741835, 'recall': 0.5815751684524467, 'f1-score': 0.419054441260745, 'support': 9053}, '1': {'precision': 0.785807558855352, 'recall': 0.5525618490437337, 'f1-score': 0.6488601355514478, 'support': 38117}, '2': {'precision': 0.3615831517792302, 'recall': 0.5253217978476472, 'f1-score': 0.42833792154163797, 'support': 9478}, 'accuracy': 0.5526408699336252, 'macro avg': {'precision': 0.49163930893625524, 'recall': 0.5531529384479426, 'f1-score': 0.49875083278461024, 'support': 56648}, 'weighted avg': {'precision': 0.6415904484090856, 'recall': 0.5526408699336252, 'f1-score': 0.5752381101525157, 'support': 56648}}
[[ 5265  2762  1026]
 [ 9290 21062  7765]
 [ 1520  2979  4979]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.95414746
{'0': {'precision': 0.3812053489650119, 'recall': 0.536340206185567, 'f1-score': 0.44565799336117357, 'support': 11640}, '1': {'precision': 0.6874952518422852, 'recall': 0.5518829089800275, 'f1-score': 0.6122697518648197, 'support': 32795}, '2': {'precision': 0.4175690211545357, 'recall': 0.4767870302137067, 'f1-score': 0.4452175242755562, 'support': 12213}, 'accuracy': 0.5324989408275668, 'macro avg': {'precision': 0.4954232073206109, 'recall': 0.521670048459767, 'f1-score': 0.5010484231671831, 'support': 56648}, 'weighted avg': {'precision': 0.5663643465167494, 'recall': 0.5324989408275668, 'f1-score': 0.5420189093897082, 'support': 56648}}
[[ 6243  3991  1406]
 [ 7980 18099  6716]
 [ 2154  4236  5823]]
training model: results/QRTEA/W5/deepLOB_L2/seq2seq
Epoch 1/50
589/589 - 35s - loss: 11.3856 - accuracy10: 0.4527 - accuracy20: 0.4676 - accuracy30: 0.4779 - accuracy50: 0.4910 - val_loss: 13.2075 - val_accuracy10: 0.3576 - val_accuracy20: 0.3828 - val_accuracy30: 0.3981 - val_accuracy50: 0.4119 - 35s/epoch - 60ms/step
Epoch 2/50
589/589 - 28s - loss: 10.8785 - accuracy10: 0.4912 - accuracy20: 0.5082 - accuracy30: 0.5159 - accuracy50: 0.5234 - val_loss: 12.9894 - val_accuracy10: 0.4568 - val_accuracy20: 0.4597 - val_accuracy30: 0.4611 - val_accuracy50: 0.4623 - 28s/epoch - 47ms/step
Epoch 3/50
589/589 - 28s - loss: 10.6541 - accuracy10: 0.5265 - accuracy20: 0.5342 - accuracy30: 0.5373 - accuracy50: 0.5404 - val_loss: 12.8795 - val_accuracy10: 0.4071 - val_accuracy20: 0.4156 - val_accuracy30: 0.4190 - val_accuracy50: 0.4296 - 28s/epoch - 48ms/step
Epoch 4/50
589/589 - 28s - loss: 10.2880 - accuracy10: 0.5707 - accuracy20: 0.5736 - accuracy30: 0.5728 - accuracy50: 0.5708 - val_loss: 12.9089 - val_accuracy10: 0.4489 - val_accuracy20: 0.4519 - val_accuracy30: 0.4494 - val_accuracy50: 0.4494 - 28s/epoch - 48ms/step
Epoch 5/50
589/589 - 28s - loss: 10.0072 - accuracy10: 0.6017 - accuracy20: 0.5980 - accuracy30: 0.5917 - accuracy50: 0.5854 - val_loss: 12.9088 - val_accuracy10: 0.4809 - val_accuracy20: 0.4822 - val_accuracy30: 0.4775 - val_accuracy50: 0.4716 - 28s/epoch - 48ms/step
Epoch 6/50
589/589 - 28s - loss: 9.6798 - accuracy10: 0.6377 - accuracy20: 0.6269 - accuracy30: 0.6160 - accuracy50: 0.6029 - val_loss: 12.3486 - val_accuracy10: 0.5442 - val_accuracy20: 0.5350 - val_accuracy30: 0.5200 - val_accuracy50: 0.5042 - 28s/epoch - 48ms/step
Epoch 7/50
589/589 - 28s - loss: 9.3621 - accuracy10: 0.6683 - accuracy20: 0.6518 - accuracy30: 0.6343 - accuracy50: 0.6163 - val_loss: 12.0966 - val_accuracy10: 0.6129 - val_accuracy20: 0.5951 - val_accuracy30: 0.5739 - val_accuracy50: 0.5472 - 28s/epoch - 47ms/step
Epoch 8/50
589/589 - 28s - loss: 9.1423 - accuracy10: 0.6858 - accuracy20: 0.6654 - accuracy30: 0.6447 - accuracy50: 0.6241 - val_loss: 11.9495 - val_accuracy10: 0.6343 - val_accuracy20: 0.6164 - val_accuracy30: 0.5942 - val_accuracy50: 0.5650 - 28s/epoch - 47ms/step
Epoch 9/50
589/589 - 27s - loss: 8.9994 - accuracy10: 0.6944 - accuracy20: 0.6730 - accuracy30: 0.6519 - accuracy50: 0.6290 - val_loss: 11.9683 - val_accuracy10: 0.6386 - val_accuracy20: 0.6167 - val_accuracy30: 0.5926 - val_accuracy50: 0.5617 - 27s/epoch - 46ms/step
Epoch 10/50
589/589 - 27s - loss: 8.8791 - accuracy10: 0.6998 - accuracy20: 0.6772 - accuracy30: 0.6545 - accuracy50: 0.6317 - val_loss: 11.9587 - val_accuracy10: 0.6096 - val_accuracy20: 0.5901 - val_accuracy30: 0.5683 - val_accuracy50: 0.5455 - 27s/epoch - 46ms/step
Epoch 11/50
589/589 - 27s - loss: 8.7966 - accuracy10: 0.7034 - accuracy20: 0.6801 - accuracy30: 0.6574 - accuracy50: 0.6330 - val_loss: 11.8588 - val_accuracy10: 0.6611 - val_accuracy20: 0.6305 - val_accuracy30: 0.5993 - val_accuracy50: 0.5610 - 27s/epoch - 47ms/step
Epoch 12/50
589/589 - 27s - loss: 8.7137 - accuracy10: 0.7038 - accuracy20: 0.6819 - accuracy30: 0.6592 - accuracy50: 0.6348 - val_loss: 11.7274 - val_accuracy10: 0.6542 - val_accuracy20: 0.6266 - val_accuracy30: 0.5965 - val_accuracy50: 0.5616 - 27s/epoch - 46ms/step
Epoch 13/50
589/589 - 28s - loss: 8.6522 - accuracy10: 0.7051 - accuracy20: 0.6813 - accuracy30: 0.6596 - accuracy50: 0.6357 - val_loss: 11.8990 - val_accuracy10: 0.6341 - val_accuracy20: 0.6142 - val_accuracy30: 0.5875 - val_accuracy50: 0.5590 - 28s/epoch - 48ms/step
Epoch 14/50
589/589 - 28s - loss: 8.5502 - accuracy10: 0.7082 - accuracy20: 0.6853 - accuracy30: 0.6621 - accuracy50: 0.6375 - val_loss: 11.8226 - val_accuracy10: 0.6742 - val_accuracy20: 0.6449 - val_accuracy30: 0.6134 - val_accuracy50: 0.5735 - 28s/epoch - 48ms/step
Epoch 15/50
589/589 - 28s - loss: 8.4811 - accuracy10: 0.7100 - accuracy20: 0.6879 - accuracy30: 0.6634 - accuracy50: 0.6380 - val_loss: 11.7242 - val_accuracy10: 0.6461 - val_accuracy20: 0.6176 - val_accuracy30: 0.5882 - val_accuracy50: 0.5534 - 28s/epoch - 48ms/step
Epoch 16/50
589/589 - 28s - loss: 8.4035 - accuracy10: 0.7102 - accuracy20: 0.6879 - accuracy30: 0.6630 - accuracy50: 0.6382 - val_loss: 12.2124 - val_accuracy10: 0.6073 - val_accuracy20: 0.5878 - val_accuracy30: 0.5630 - val_accuracy50: 0.5351 - 28s/epoch - 48ms/step
Epoch 17/50
589/589 - 28s - loss: 8.3253 - accuracy10: 0.7115 - accuracy20: 0.6904 - accuracy30: 0.6655 - accuracy50: 0.6407 - val_loss: 12.4434 - val_accuracy10: 0.6236 - val_accuracy20: 0.5953 - val_accuracy30: 0.5648 - val_accuracy50: 0.5300 - 28s/epoch - 48ms/step
Epoch 18/50
589/589 - 28s - loss: 8.2907 - accuracy10: 0.7102 - accuracy20: 0.6904 - accuracy30: 0.6664 - accuracy50: 0.6407 - val_loss: 12.7968 - val_accuracy10: 0.6146 - val_accuracy20: 0.5893 - val_accuracy30: 0.5616 - val_accuracy50: 0.5308 - 28s/epoch - 47ms/step
Epoch 19/50
589/589 - 27s - loss: 8.2069 - accuracy10: 0.7144 - accuracy20: 0.6925 - accuracy30: 0.6686 - accuracy50: 0.6428 - val_loss: 12.4882 - val_accuracy10: 0.6347 - val_accuracy20: 0.6066 - val_accuracy30: 0.5754 - val_accuracy50: 0.5417 - 27s/epoch - 46ms/step
Epoch 20/50
589/589 - 27s - loss: 8.1476 - accuracy10: 0.7124 - accuracy20: 0.6922 - accuracy30: 0.6686 - accuracy50: 0.6444 - val_loss: 12.6722 - val_accuracy10: 0.6430 - val_accuracy20: 0.6097 - val_accuracy30: 0.5762 - val_accuracy50: 0.5413 - 27s/epoch - 46ms/step
Epoch 21/50
589/589 - 27s - loss: 8.0876 - accuracy10: 0.7125 - accuracy20: 0.6928 - accuracy30: 0.6694 - accuracy50: 0.6444 - val_loss: 13.1882 - val_accuracy10: 0.6188 - val_accuracy20: 0.5870 - val_accuracy30: 0.5541 - val_accuracy50: 0.5211 - 27s/epoch - 46ms/step
Epoch 22/50
589/589 - 27s - loss: 7.9671 - accuracy10: 0.7157 - accuracy20: 0.6978 - accuracy30: 0.6738 - accuracy50: 0.6486 - val_loss: 13.2394 - val_accuracy10: 0.6208 - val_accuracy20: 0.5869 - val_accuracy30: 0.5515 - val_accuracy50: 0.5171 - 27s/epoch - 46ms/step
Epoch 23/50
589/589 - 27s - loss: 7.9390 - accuracy10: 0.7151 - accuracy20: 0.6969 - accuracy30: 0.6731 - accuracy50: 0.6489 - val_loss: 13.3436 - val_accuracy10: 0.6154 - val_accuracy20: 0.5842 - val_accuracy30: 0.5508 - val_accuracy50: 0.5173 - 27s/epoch - 46ms/step
Epoch 24/50
589/589 - 27s - loss: 7.8569 - accuracy10: 0.7160 - accuracy20: 0.6991 - accuracy30: 0.6751 - accuracy50: 0.6511 - val_loss: 13.2344 - val_accuracy10: 0.6225 - val_accuracy20: 0.5905 - val_accuracy30: 0.5587 - val_accuracy50: 0.5212 - 27s/epoch - 46ms/step
Epoch 25/50
589/589 - 27s - loss: 7.8153 - accuracy10: 0.7161 - accuracy20: 0.6983 - accuracy30: 0.6747 - accuracy50: 0.6510 - val_loss: 13.5239 - val_accuracy10: 0.6135 - val_accuracy20: 0.5810 - val_accuracy30: 0.5475 - val_accuracy50: 0.5141 - 27s/epoch - 46ms/step
testing model: results/QRTEA/W5/deepLOB_L2/seq2seq
Evaluating performance on  test set...
2185/2185 - 35s - 35s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2129188
{'0': {'precision': 0.3094995129644232, 'recall': 0.49552560246556016, 'f1-score': 0.3810190009850248, 'support': 80793}, '1': {'precision': 0.8637419401943024, 'recall': 0.47667171166452194, 'f1-score': 0.6143198385034305, 'support': 397093}, '2': {'precision': 0.2607956945360663, 'recall': 0.6757501229709788, 'f1-score': 0.3763461847967154, 'support': 81320}, 'accuracy': 0.5083457616692239, 'macro avg': {'precision': 0.47801238256493067, 'recall': 0.5493158123670203, 'f1-score': 0.4572283414283902, 'support': 559206}, 'weighted avg': {'precision': 0.6959853404437429, 'recall': 0.5083457616692239, 'f1-score': 0.5460067444288773, 'support': 559206}}
[[ 40035  18871  21887]
 [ 73940 189283 133870]
 [ 15379  10989  54952]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2278476
{'0': {'precision': 0.36877312730327133, 'recall': 0.47582456208869534, 'f1-score': 0.4155145438190368, 'support': 102418}, '1': {'precision': 0.7945850804990423, 'recall': 0.43374440475652215, 'f1-score': 0.5611634938450796, 'support': 353872}, '2': {'precision': 0.2995848422528828, 'recall': 0.6808367989428271, 'f1-score': 0.41608299213486816, 'support': 102916}, 'accuracy': 0.4869261059430693, 'macro avg': {'precision': 0.4876476833517322, 'recall': 0.5301352552626816, 'f1-score': 0.4642536765996615, 'support': 559206}, 'weighted avg': {'precision': 0.625498459215032, 'recall': 0.4869261059430693, 'f1-score': 0.5077874945214397, 'support': 559206}}
[[ 48733  24563  29122]
 [ 65686 153490 134696]
 [ 17730  15117  70069]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2344903
{'0': {'precision': 0.39739200483335013, 'recall': 0.46831612673549305, 'f1-score': 0.42994879616515963, 'support': 117978}, '1': {'precision': 0.7353732170463495, 'recall': 0.3906373958746529, 'f1-score': 0.5102336962131377, 'support': 322688}, '2': {'precision': 0.3218120495101645, 'recall': 0.67532478488274, 'f1-score': 0.43590336975254357, 'support': 118540}, 'accuracy': 0.4673733829751469, 'macro avg': {'precision': 0.48485909046328796, 'recall': 0.5114261024976287, 'f1-score': 0.458695287376947, 'support': 559206}, 'weighted avg': {'precision': 0.5764015889625939, 'recall': 0.4673733829751469, 'f1-score': 0.4775391814252077, 'support': 559206}}
[[ 55251  27454  35273]
 [ 63203 126054 133431]
 [ 20580  17907  80053]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2143286
{'0': {'precision': 0.43277765601884827, 'recall': 0.4420851581848965, 'f1-score': 0.4373818967128351, 'support': 142934}, '1': {'precision': 0.63502734879835, 'recall': 0.3566401266880746, 'f1-score': 0.4567584189745588, 'support': 272796}, '2': {'precision': 0.36025723868426723, 'recall': 0.6528199838300482, 'f1-score': 0.4642945661118107, 'support': 143476}, 'accuracy': 0.45447116089598466, 'macro avg': {'precision': 0.47602074783382187, 'recall': 0.48384842290100644, 'f1-score': 0.45281162726640156, 'support': 559206}, 'weighted avg': {'precision': 0.5128339640591422, 'recall': 0.45447116089598466, 'f1-score': 0.4537393033243461, 'support': 559206}}
[[ 63189  32830  46915]
 [ 56093  97290 119413]
 [ 26726  23086  93664]]
Evaluating performance on  train set...
589/589 - 10s - 10s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.81435376
{'0': {'precision': 0.3266187665725772, 'recall': 0.623734073832081, 'f1-score': 0.428731825071577, 'support': 12244}, '1': {'precision': 0.9502256161055189, 'recall': 0.6516750511799153, 'f1-score': 0.7731294950483866, 'support': 126026}, '2': {'precision': 0.22167861249052082, 'recall': 0.7295708880122374, 'f1-score': 0.3400375234521576, 'support': 12421}, 'accuracy': 0.6558254972095214, 'macro avg': {'precision': 0.49950766505620564, 'recall': 0.668326671008078, 'f1-score': 0.513966281190707, 'support': 150691}, 'weighted avg': {'precision': 0.8395041755577541, 'recall': 0.6558254972095214, 'f1-score': 0.7094479185083622, 'support': 150691}}
[[ 7637  2485  2122]
 [14203 82128 29695]
 [ 1542  1817  9062]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8428081
{'0': {'precision': 0.4057560274628772, 'recall': 0.6071193931792391, 'f1-score': 0.4864218207919607, 'support': 16743}, '1': {'precision': 0.9130233574578036, 'recall': 0.6081011661158582, 'f1-score': 0.7300001541710991, 'support': 116798}, '2': {'precision': 0.25988547065708073, 'recall': 0.7250728862973761, 'f1-score': 0.3826271577587002, 'support': 17150}, 'accuracy': 0.621304523826904, 'macro avg': {'precision': 0.5262216185259205, 'recall': 0.6467644818641578, 'f1-score': 0.53301637757392, 'support': 150691}, 'weighted avg': {'precision': 0.7823288125630359, 'recall': 0.621304523826904, 'f1-score': 0.6634024215643771, 'support': 150691}}
[[10165  3882  2696]
 [13056 71025 32717]
 [ 1831  2884 12435]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8809403
{'0': {'precision': 0.43962159154145797, 'recall': 0.5856189770200149, 'f1-score': 0.5022250476795932, 'support': 20235}, '1': {'precision': 0.8751145124237171, 'recall': 0.5660886530642014, 'f1-score': 0.6874705905147837, 'support': 109686}, '2': {'precision': 0.28132163764848533, 'recall': 0.7149253731343284, 'f1-score': 0.4037632727421044, 'support': 20770}, 'accuracy': 0.589225633913107, 'macro avg': {'precision': 0.5320192472045534, 'recall': 0.6222110010728482, 'f1-score': 0.5311529703121604, 'support': 150691}, 'weighted avg': {'precision': 0.7347924144674086, 'recall': 0.589225633913107, 'f1-score': 0.623491689655352, 'support': 150691}}
[[11850  5044  3341]
 [13001 62092 34593]
 [ 2104  3817 14849]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.91827214
{'0': {'precision': 0.48252582767908897, 'recall': 0.5371593410764443, 'f1-score': 0.508378985181859, 'support': 26346}, '1': {'precision': 0.7967669925332923, 'recall': 0.530989976094473, 'f1-score': 0.6372782012288976, 'support': 97467}, '2': {'precision': 0.32222951052174376, 'recall': 0.6762407917255748, 'f1-score': 0.43647715675091553, 'support': 26878}, 'accuracy': 0.5579762560471428, 'macro avg': {'precision': 0.533840776911375, 'recall': 0.5814633696321639, 'f1-score': 0.527378114387224, 'support': 150691}, 'weighted avg': {'precision': 0.6571858883482034, 'recall': 0.5579762560471428, 'f1-score': 0.5789262809453075, 'support': 150691}}
[[14152  7332  4862]
 [12344 51754 33369]
 [ 2833  5869 18176]]
Evaluating performance on  val set...
222/222 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.86989397
{'0': {'precision': 0.28431531239883456, 'recall': 0.6354920405209841, 'f1-score': 0.39286513084321184, 'support': 5528}, '1': {'precision': 0.9297950637649895, 'recall': 0.6455869072005991, 'f1-score': 0.7620545754735378, 'support': 45399}, '2': {'precision': 0.2902897415818324, 'recall': 0.6479636427198042, 'f1-score': 0.4009518143961927, 'support': 5721}, 'accuracy': 0.6448418302499647, 'macro avg': {'precision': 0.5014667059152188, 'recall': 0.6430141968137958, 'f1-score': 0.5186238402376474, 'support': 56648}, 'weighted avg': {'precision': 0.802220886145975, 'recall': 0.6448418302499647, 'f1-score': 0.6895586683622553, 'support': 56648}}
[[ 3513  1111   904]
 [ 7931 29309  8159]
 [  912  1102  3707]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.89354855
{'0': {'precision': 0.3505725335557746, 'recall': 0.6169758441211798, 'f1-score': 0.44709864603481625, 'support': 7493}, '1': {'precision': 0.8793867238873122, 'recall': 0.6153045162852646, 'f1-score': 0.7240165837951815, 'support': 41295}, '2': {'precision': 0.34131942060822407, 'recall': 0.6325699745547074, 'f1-score': 0.44339412315512555, 'support': 7860}, 'accuracy': 0.6179211975709645, 'macro avg': {'precision': 0.523759559350437, 'recall': 0.621616778320384, 'f1-score': 0.5381697843283745, 'support': 56648}, 'weighted avg': {'precision': 0.7347811997394545, 'recall': 0.6179211975709645, 'f1-score': 0.6484510095777466, 'support': 56648}}
[[ 4623  1754  1116]
 [ 7407 25409  8479]
 [ 1157  1731  4972]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9300088
{'0': {'precision': 0.3823757490306662, 'recall': 0.6004649618067087, 'f1-score': 0.46722370574554223, 'support': 9033}, '1': {'precision': 0.8307802326019045, 'recall': 0.5788576523654674, 'f1-score': 0.6823078468648089, 'support': 38132}, '2': {'precision': 0.3661759154397886, 'recall': 0.6137298323315407, 'f1-score': 0.4586830594632935, 'support': 9483}, 'accuracy': 0.5881407993221296, 'macro avg': {'precision': 0.5264439656907864, 'recall': 0.5976841488345723, 'f1-score': 0.5360715373578816, 'support': 56648}, 'weighted avg': {'precision': 0.6815025804385917, 'recall': 0.5881407993221296, 'f1-score': 0.6105755896684577, 'support': 56648}}
[[ 5424  2253  1356]
 [ 7341 22073  8718]
 [ 1420  2243  5820]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9691977
{'0': {'precision': 0.4247834077185613, 'recall': 0.5569228121504174, 'f1-score': 0.48196001042558734, 'support': 11621}, '1': {'precision': 0.7365716383213019, 'recall': 0.5504587155963303, 'f1-score': 0.6300586101032655, 'support': 32809}, '2': {'precision': 0.40934114722074233, 'recall': 0.5659682435750532, 'f1-score': 0.47507814915324104, 'support': 12218}, 'accuracy': 0.5551299251518147, 'macro avg': {'precision': 0.5235653977535352, 'recall': 0.5577832571072671, 'f1-score': 0.5290322565606979, 'support': 56648}, 'weighted avg': {'precision': 0.6020321458749475, 'recall': 0.5551299251518147, 'f1-score': 0.5662504421407302, 'support': 56648}}
[[ 6472  3210  1939]
 [ 6710 18060  8039]
 [ 2054  3249  6915]]
training model: results/QRTEA/W5/deepOF_L2/seq2seq
Epoch 1/50
589/589 - 23s - loss: 11.1453 - accuracy10: 0.4936 - accuracy20: 0.4902 - accuracy30: 0.4839 - accuracy50: 0.4811 - val_loss: 12.3980 - val_accuracy10: 0.7372 - val_accuracy20: 0.7065 - val_accuracy30: 0.6721 - val_accuracy50: 0.6090 - 23s/epoch - 38ms/step
Epoch 2/50
589/589 - 17s - loss: 9.8694 - accuracy10: 0.5980 - accuracy20: 0.5860 - accuracy30: 0.5718 - accuracy50: 0.5577 - val_loss: 12.0197 - val_accuracy10: 0.7610 - val_accuracy20: 0.7343 - val_accuracy30: 0.7009 - val_accuracy50: 0.6394 - 17s/epoch - 29ms/step
Epoch 3/50
589/589 - 17s - loss: 9.4639 - accuracy10: 0.6428 - accuracy20: 0.6262 - accuracy30: 0.6059 - accuracy50: 0.5853 - val_loss: 11.9262 - val_accuracy10: 0.7508 - val_accuracy20: 0.7234 - val_accuracy30: 0.6916 - val_accuracy50: 0.6362 - 17s/epoch - 28ms/step
Epoch 4/50
589/589 - 16s - loss: 9.1541 - accuracy10: 0.6606 - accuracy20: 0.6421 - accuracy30: 0.6206 - accuracy50: 0.6006 - val_loss: 11.5947 - val_accuracy10: 0.7406 - val_accuracy20: 0.7171 - val_accuracy30: 0.6879 - val_accuracy50: 0.6348 - 16s/epoch - 28ms/step
Epoch 5/50
589/589 - 16s - loss: 8.9807 - accuracy10: 0.6693 - accuracy20: 0.6490 - accuracy30: 0.6261 - accuracy50: 0.6073 - val_loss: 11.4603 - val_accuracy10: 0.7469 - val_accuracy20: 0.7186 - val_accuracy30: 0.6869 - val_accuracy50: 0.6335 - 16s/epoch - 28ms/step
Epoch 6/50
589/589 - 16s - loss: 8.8691 - accuracy10: 0.6741 - accuracy20: 0.6534 - accuracy30: 0.6312 - accuracy50: 0.6129 - val_loss: 11.3986 - val_accuracy10: 0.7225 - val_accuracy20: 0.6973 - val_accuracy30: 0.6688 - val_accuracy50: 0.6221 - 16s/epoch - 27ms/step
Epoch 7/50
589/589 - 16s - loss: 8.7810 - accuracy10: 0.6780 - accuracy20: 0.6574 - accuracy30: 0.6349 - accuracy50: 0.6150 - val_loss: 11.4685 - val_accuracy10: 0.7204 - val_accuracy20: 0.6951 - val_accuracy30: 0.6644 - val_accuracy50: 0.6172 - 16s/epoch - 28ms/step
Epoch 8/50
589/589 - 17s - loss: 8.6926 - accuracy10: 0.6821 - accuracy20: 0.6620 - accuracy30: 0.6383 - accuracy50: 0.6185 - val_loss: 11.4262 - val_accuracy10: 0.7174 - val_accuracy20: 0.6906 - val_accuracy30: 0.6580 - val_accuracy50: 0.6119 - 17s/epoch - 30ms/step
Epoch 9/50
589/589 - 17s - loss: 8.6401 - accuracy10: 0.6826 - accuracy20: 0.6645 - accuracy30: 0.6419 - accuracy50: 0.6218 - val_loss: 11.3558 - val_accuracy10: 0.7092 - val_accuracy20: 0.6848 - val_accuracy30: 0.6551 - val_accuracy50: 0.6092 - 17s/epoch - 28ms/step
Epoch 10/50
589/589 - 16s - loss: 8.5578 - accuracy10: 0.6856 - accuracy20: 0.6666 - accuracy30: 0.6445 - accuracy50: 0.6247 - val_loss: 11.4529 - val_accuracy10: 0.7129 - val_accuracy20: 0.6855 - val_accuracy30: 0.6566 - val_accuracy50: 0.6110 - 16s/epoch - 28ms/step
Epoch 11/50
589/589 - 16s - loss: 8.5044 - accuracy10: 0.6863 - accuracy20: 0.6679 - accuracy30: 0.6450 - accuracy50: 0.6254 - val_loss: 11.5087 - val_accuracy10: 0.7133 - val_accuracy20: 0.6886 - val_accuracy30: 0.6605 - val_accuracy50: 0.6125 - 16s/epoch - 28ms/step
Epoch 12/50
589/589 - 16s - loss: 8.4297 - accuracy10: 0.6869 - accuracy20: 0.6699 - accuracy30: 0.6472 - accuracy50: 0.6275 - val_loss: 11.6944 - val_accuracy10: 0.7199 - val_accuracy20: 0.6956 - val_accuracy30: 0.6628 - val_accuracy50: 0.6122 - 16s/epoch - 28ms/step
Epoch 13/50
589/589 - 17s - loss: 8.3587 - accuracy10: 0.6888 - accuracy20: 0.6731 - accuracy30: 0.6521 - accuracy50: 0.6316 - val_loss: 11.6006 - val_accuracy10: 0.6826 - val_accuracy20: 0.6580 - val_accuracy30: 0.6279 - val_accuracy50: 0.5847 - 17s/epoch - 28ms/step
Epoch 14/50
589/589 - 17s - loss: 8.3093 - accuracy10: 0.6916 - accuracy20: 0.6761 - accuracy30: 0.6542 - accuracy50: 0.6341 - val_loss: 11.7706 - val_accuracy10: 0.6898 - val_accuracy20: 0.6626 - val_accuracy30: 0.6287 - val_accuracy50: 0.5853 - 17s/epoch - 28ms/step
Epoch 15/50
589/589 - 17s - loss: 8.2512 - accuracy10: 0.6924 - accuracy20: 0.6759 - accuracy30: 0.6548 - accuracy50: 0.6349 - val_loss: 12.0217 - val_accuracy10: 0.6993 - val_accuracy20: 0.6746 - val_accuracy30: 0.6428 - val_accuracy50: 0.5966 - 17s/epoch - 28ms/step
Epoch 16/50
589/589 - 16s - loss: 8.1952 - accuracy10: 0.6908 - accuracy20: 0.6771 - accuracy30: 0.6562 - accuracy50: 0.6364 - val_loss: 11.8339 - val_accuracy10: 0.6767 - val_accuracy20: 0.6523 - val_accuracy30: 0.6205 - val_accuracy50: 0.5787 - 16s/epoch - 28ms/step
Epoch 17/50
589/589 - 16s - loss: 8.1505 - accuracy10: 0.6922 - accuracy20: 0.6783 - accuracy30: 0.6580 - accuracy50: 0.6376 - val_loss: 12.2965 - val_accuracy10: 0.6561 - val_accuracy20: 0.6311 - val_accuracy30: 0.6010 - val_accuracy50: 0.5623 - 16s/epoch - 28ms/step
Epoch 18/50
589/589 - 17s - loss: 8.0714 - accuracy10: 0.6953 - accuracy20: 0.6816 - accuracy30: 0.6602 - accuracy50: 0.6407 - val_loss: 12.0326 - val_accuracy10: 0.6943 - val_accuracy20: 0.6666 - val_accuracy30: 0.6333 - val_accuracy50: 0.5851 - 17s/epoch - 28ms/step
Epoch 19/50
589/589 - 17s - loss: 8.0279 - accuracy10: 0.6973 - accuracy20: 0.6829 - accuracy30: 0.6628 - accuracy50: 0.6422 - val_loss: 12.3387 - val_accuracy10: 0.6760 - val_accuracy20: 0.6516 - val_accuracy30: 0.6222 - val_accuracy50: 0.5807 - 17s/epoch - 28ms/step
testing model: results/QRTEA/W5/deepOF_L2/seq2seq
Evaluating performance on  test set...
2185/2185 - 21s - 21s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9385599
{'0': {'precision': 0.3222830944307615, 'recall': 0.5847010768659487, 'f1-score': 0.4155293517414883, 'support': 80790}, '1': {'precision': 0.8884194748849221, 'recall': 0.6090109873505702, 'f1-score': 0.7226475422082773, 'support': 397093}, '2': {'precision': 0.3366020751881841, 'recall': 0.5812489239774712, 'f1-score': 0.426321035090805, 'support': 81318}, 'accuracy': 0.6014617284303855, 'macro avg': {'precision': 0.5157682148346225, 'recall': 0.59165366273133, 'f1-score': 0.5214993096801902, 'support': 559201}, 'weighted avg': {'precision': 0.726383202622478, 'recall': 0.6014617284303855, 'f1-score': 0.6351856858925867, 'support': 559201}}
[[ 47238  17119  16433]
 [ 78537 241834  76722]
 [ 20798  13254  47266]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9635907
{'0': {'precision': 0.3746891605371306, 'recall': 0.5590630370254648, 'f1-score': 0.4486733430501356, 'support': 102416}, '1': {'precision': 0.8234281198768679, 'recall': 0.591876700831659, 'f1-score': 0.688710886635363, 'support': 353871}, '2': {'precision': 0.38393585392164603, 'recall': 0.5671628738558409, 'f1-score': 0.45790022828721827, 'support': 102914}, 'accuracy': 0.5813187029350806, 'macro avg': {'precision': 0.5273510447785482, 'recall': 0.5727008705709883, 'f1-score': 0.5317614859909056, 'support': 559201}, 'weighted avg': {'precision': 0.660359820073659, 'recall': 0.5813187029350806, 'f1-score': 0.6022708889295906, 'support': 559201}}
[[ 57257  25035  20124]
 [ 70888 209448  73535]
 [ 24667  19878  58369]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9985332
{'0': {'precision': 0.39975639158169674, 'recall': 0.5396906124178852, 'f1-score': 0.45930163356140913, 'support': 117975}, '1': {'precision': 0.7653623523963881, 'recall': 0.5634172947243158, 'f1-score': 0.6490442369514113, 'support': 322688}, '2': {'precision': 0.40382057345551287, 'recall': 0.5531896944439758, 'f1-score': 0.46684844903567535, 'support': 118538}, 'accuracy': 0.556243640479899, 'macro avg': {'precision': 0.5229797724778659, 'recall': 0.5520992005287256, 'f1-score': 0.525064773182832, 'support': 559201}, 'weighted avg': {'precision': 0.6115915211224693, 'recall': 0.556243640479899, 'f1-score': 0.570392718190016, 'support': 559201}}
[[ 63670  30955  23350]
 [ 67420 181808  73460]
 [ 28182  24782  65574]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0356759
{'0': {'precision': 0.4334282587533934, 'recall': 0.5015391934626255, 'f1-score': 0.4650028379145382, 'support': 142932}, '1': {'precision': 0.6577046477030345, 'recall': 0.5380430798105544, 'f1-score': 0.5918864424550367, 'support': 272796}, '2': {'precision': 0.4332294132814514, 'recall': 0.5152746509796269, 'f1-score': 0.47070359133698597, 'support': 143473}, 'accuracy': 0.5228710249087537, 'macro avg': {'precision': 0.5081207732459597, 'recall': 0.5182856414176022, 'f1-score': 0.509197623902187, 'support': 559201}, 'weighted avg': {'precision': 0.5427863837272585, 'recall': 0.5228710249087537, 'f1-score': 0.5283633182785016, 'support': 559201}}
[[ 71686  41696  29550]
 [ 58854 146776  67166]
 [ 34853  34692  73928]]
Evaluating performance on  train set...
589/589 - 6s - 6s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6263679
{'0': {'precision': 0.3233008559820125, 'recall': 0.6698267407649559, 'f1-score': 0.43610822890893125, 'support': 12236}, '1': {'precision': 0.9479919658241658, 'recall': 0.7379306513440369, 'f1-score': 0.8298747779830598, 'support': 126001}, '2': {'precision': 0.2965001100594321, 'recall': 0.6490002409058059, 'f1-score': 0.4070408702878296, 'support': 12453}, 'accuracy': 0.7250514300882607, 'macro avg': {'precision': 0.5225976439552035, 'recall': 0.6855858776715995, 'f1-score': 0.5576746257266069, 'support': 150690}, 'weighted avg': {'precision': 0.8434279702049022, 'recall': 0.7250514300882607, 'f1-score': 0.7629580738421099, 'support': 150690}}
[[ 8196  2658  1382]
 [15227 92980 17794]
 [ 1928  2443  8082]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6590874
{'0': {'precision': 0.39611742770445657, 'recall': 0.6482589445973436, 'f1-score': 0.49175119704086956, 'support': 16714}, '1': {'precision': 0.9108551288388387, 'recall': 0.7256990223104978, 'f1-score': 0.8078029999809404, 'support': 116806}, '2': {'precision': 0.35993393889347647, 'recall': 0.6346534653465347, 'f1-score': 0.4593529349773422, 'support': 17170}, 'accuracy': 0.7067356825270422, 'macro avg': {'precision': 0.5556354984789239, 'recall': 0.669537144084792, 'f1-score': 0.5863023773330508, 'support': 150690}, 'weighted avg': {'precision': 0.790988895060075, 'recall': 0.7067356825270422, 'f1-score': 0.7330443733272001, 'support': 150690}}
[[10835  4264  1615]
 [14277 84766 17763]
 [ 2241  4032 10897]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.711318
{'0': {'precision': 0.43377562506395606, 'recall': 0.6282171614879217, 'f1-score': 0.5131961259079902, 'support': 20243}, '1': {'precision': 0.8729281143296475, 'recall': 0.7039039422340542, 'f1-score': 0.779356987836269, 'support': 109684}, '2': {'precision': 0.3886779846326723, 'recall': 0.6163849154746424, 'f1-score': 0.47673682249953436, 'support': 20763}, 'accuracy': 0.6816776162983609, 'macro avg': {'precision': 0.5651272413420919, 'recall': 0.6495020063988727, 'f1-score': 0.5897633120812645, 'support': 150690}, 'weighted avg': {'precision': 0.7472114159216331, 'recall': 0.6816776162983609, 'f1-score': 0.7019052868547787, 'support': 150690}}
[[12717  5752  1774]
 [14122 77207 18355]
 [ 2478  5487 12798]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7804864
{'0': {'precision': 0.482794274451517, 'recall': 0.5663924794359577, 'f1-score': 0.521262864120007, 'support': 26381}, '1': {'precision': 0.793810170692812, 'recall': 0.6897047201666786, 'f1-score': 0.7381046526954, 'support': 97433}, '2': {'precision': 0.4347318018582911, 'recall': 0.567532370888525, 'f1-score': 0.49233401116813524, 'support': 26876}, 'accuracy': 0.6463268962771253, 'macro avg': {'precision': 0.57044541566754, 'recall': 0.6078765234970538, 'f1-score': 0.5839005093278474, 'support': 150690}, 'weighted avg': {'precision': 0.6753185614318246, 'recall': 0.6463268962771253, 'f1-score': 0.6563086809249161, 'support': 150690}}
[[14942  9011  2428]
 [12828 67200 17405]
 [ 3179  8444 15253]]
Evaluating performance on  val set...
222/222 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6795045
{'0': {'precision': 0.3325137128806506, 'recall': 0.6383442265795207, 'f1-score': 0.43725904738216637, 'support': 5508}, '1': {'precision': 0.9238514092883024, 'recall': 0.7357314359979734, 'f1-score': 0.8191293684855916, 'support': 45397}, '2': {'precision': 0.33766757383328294, 'recall': 0.5833188229148528, 'f1-score': 0.427732379979571, 'support': 5743}, 'accuracy': 0.7108106199689309, 'macro avg': {'precision': 0.5313442320007454, 'recall': 0.652464828497449, 'f1-score': 0.5613735986157763, 'support': 56648}, 'weighted avg': {'precision': 0.806926861222501, 'recall': 0.7108106199689309, 'f1-score': 0.7423193375290221, 'support': 56648}}
[[ 3516  1398   594]
 [ 6020 33400  5977]
 [ 1038  1355  3350]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.71932894
{'0': {'precision': 0.39754633255024796, 'recall': 0.6093624966657776, 'f1-score': 0.4811752935601074, 'support': 7498}, '1': {'precision': 0.871883615885493, 'recall': 0.7201763736796201, 'f1-score': 0.788801910574499, 'support': 41276}, '2': {'precision': 0.40330892324382966, 'recall': 0.5665481330962662, 'f1-score': 0.47119091629257986, 'support': 7874}, 'accuracy': 0.6841547803982488, 'macro avg': {'precision': 0.5575796238931902, 'recall': 0.6320290011472213, 'f1-score': 0.5803893734757287, 'support': 56648}, 'weighted avg': {'precision': 0.743968454179729, 'recall': 0.6841547803982488, 'f1-score': 0.7039365429825322, 'support': 56648}}
[[ 4569  2226   703]
 [ 5653 29726  5897]
 [ 1271  2142  4461]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7749783
{'0': {'precision': 0.42842147759386356, 'recall': 0.5861040539047829, 'f1-score': 0.49500886276704914, 'support': 9053}, '1': {'precision': 0.825158326089656, 'recall': 0.6973266521499594, 'f1-score': 0.7558759544426907, 'support': 38117}, '2': {'precision': 0.43174840262218905, 'recall': 0.5489554758387846, 'f1-score': 0.48334804217567007, 'support': 9478}, 'accuracy': 0.6547274396271713, 'macro avg': {'precision': 0.5617760687685696, 'recall': 0.610795393964509, 'f1-score': 0.5780776197951366, 'support': 56648}, 'weighted avg': {'precision': 0.6959322643742016, 'recall': 0.6547274396271713, 'f1-score': 0.6685886833403322, 'support': 56648}}
[[ 5306  2897   850]
 [ 5539 26580  5998]
 [ 1540  2735  5203]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.85373724
{'0': {'precision': 0.46733744950072414, 'recall': 0.5267182130584193, 'f1-score': 0.4952542509794418, 'support': 11640}, '1': {'precision': 0.7263047880331831, 'recall': 0.6780911724348224, 'f1-score': 0.7013703814675224, 'support': 32795}, '2': {'precision': 0.4747114863294865, 'recall': 0.5018422991893884, 'f1-score': 0.4879000159210317, 'support': 12213}, 'accuracy': 0.6089888433837028, 'macro avg': {'precision': 0.5561179079544646, 'recall': 0.56888389489421, 'f1-score': 0.5615082161226653, 'support': 56648}, 'weighted avg': {'precision': 0.6188501768514102, 'recall': 0.6089888433837028, 'f1-score': 0.612994704774602, 'support': 56648}}
[[ 6131  4308  1201]
 [ 4976 22238  5581]
 [ 2012  4072  6129]]
training model: results/QRTEA/W5/deepVOL_L2/seq2seq
Epoch 1/50
589/589 - 22s - loss: 10.5349 - accuracy10: 0.5889 - accuracy20: 0.5805 - accuracy30: 0.5685 - accuracy50: 0.5550 - val_loss: 12.2594 - val_accuracy10: 0.6269 - val_accuracy20: 0.6115 - val_accuracy30: 0.5871 - val_accuracy50: 0.5494 - 22s/epoch - 38ms/step
Epoch 2/50
589/589 - 16s - loss: 9.8796 - accuracy10: 0.6624 - accuracy20: 0.6508 - accuracy30: 0.6271 - accuracy50: 0.5977 - val_loss: 11.9233 - val_accuracy10: 0.6436 - val_accuracy20: 0.6300 - val_accuracy30: 0.6059 - val_accuracy50: 0.5636 - 16s/epoch - 28ms/step
Epoch 3/50
589/589 - 17s - loss: 9.6413 - accuracy10: 0.6717 - accuracy20: 0.6625 - accuracy30: 0.6426 - accuracy50: 0.6123 - val_loss: 11.8586 - val_accuracy10: 0.6934 - val_accuracy20: 0.6757 - val_accuracy30: 0.6480 - val_accuracy50: 0.5962 - 17s/epoch - 29ms/step
Epoch 4/50
589/589 - 16s - loss: 9.4992 - accuracy10: 0.6863 - accuracy20: 0.6734 - accuracy30: 0.6519 - accuracy50: 0.6202 - val_loss: 11.7540 - val_accuracy10: 0.7054 - val_accuracy20: 0.6832 - val_accuracy30: 0.6547 - val_accuracy50: 0.6035 - 16s/epoch - 27ms/step
Epoch 5/50
589/589 - 16s - loss: 9.3537 - accuracy10: 0.6946 - accuracy20: 0.6806 - accuracy30: 0.6581 - accuracy50: 0.6270 - val_loss: 11.8023 - val_accuracy10: 0.7011 - val_accuracy20: 0.6788 - val_accuracy30: 0.6494 - val_accuracy50: 0.5978 - 16s/epoch - 27ms/step
Epoch 6/50
589/589 - 16s - loss: 9.3347 - accuracy10: 0.6904 - accuracy20: 0.6756 - accuracy30: 0.6537 - accuracy50: 0.6225 - val_loss: 11.7374 - val_accuracy10: 0.7089 - val_accuracy20: 0.6846 - val_accuracy30: 0.6530 - val_accuracy50: 0.6010 - 16s/epoch - 27ms/step
Epoch 7/50
589/589 - 17s - loss: 9.2641 - accuracy10: 0.6947 - accuracy20: 0.6770 - accuracy30: 0.6534 - accuracy50: 0.6229 - val_loss: 11.6026 - val_accuracy10: 0.6890 - val_accuracy20: 0.6658 - val_accuracy30: 0.6358 - val_accuracy50: 0.5871 - 17s/epoch - 28ms/step
Epoch 8/50
589/589 - 17s - loss: 9.1655 - accuracy10: 0.6976 - accuracy20: 0.6809 - accuracy30: 0.6574 - accuracy50: 0.6259 - val_loss: 11.4911 - val_accuracy10: 0.6865 - val_accuracy20: 0.6567 - val_accuracy30: 0.6186 - val_accuracy50: 0.5694 - 17s/epoch - 28ms/step
Epoch 9/50
589/589 - 16s - loss: 9.0831 - accuracy10: 0.7009 - accuracy20: 0.6815 - accuracy30: 0.6568 - accuracy50: 0.6238 - val_loss: 11.6277 - val_accuracy10: 0.7125 - val_accuracy20: 0.6865 - val_accuracy30: 0.6524 - val_accuracy50: 0.5987 - 16s/epoch - 28ms/step
Epoch 10/50
589/589 - 16s - loss: 9.0605 - accuracy10: 0.7033 - accuracy20: 0.6837 - accuracy30: 0.6586 - accuracy50: 0.6268 - val_loss: 11.4220 - val_accuracy10: 0.7063 - val_accuracy20: 0.6756 - val_accuracy30: 0.6388 - val_accuracy50: 0.5850 - 16s/epoch - 27ms/step
Epoch 11/50
589/589 - 16s - loss: 8.9657 - accuracy10: 0.7070 - accuracy20: 0.6862 - accuracy30: 0.6603 - accuracy50: 0.6276 - val_loss: 11.5156 - val_accuracy10: 0.6822 - val_accuracy20: 0.6534 - val_accuracy30: 0.6225 - val_accuracy50: 0.5766 - 16s/epoch - 27ms/step
Epoch 12/50
589/589 - 16s - loss: 8.9268 - accuracy10: 0.7044 - accuracy20: 0.6853 - accuracy30: 0.6589 - accuracy50: 0.6262 - val_loss: 11.5069 - val_accuracy10: 0.6939 - val_accuracy20: 0.6651 - val_accuracy30: 0.6315 - val_accuracy50: 0.5837 - 16s/epoch - 27ms/step
Epoch 13/50
589/589 - 16s - loss: 8.8497 - accuracy10: 0.7079 - accuracy20: 0.6852 - accuracy30: 0.6600 - accuracy50: 0.6299 - val_loss: 11.4907 - val_accuracy10: 0.7074 - val_accuracy20: 0.6771 - val_accuracy30: 0.6427 - val_accuracy50: 0.5916 - 16s/epoch - 27ms/step
Epoch 14/50
589/589 - 16s - loss: 8.8227 - accuracy10: 0.7061 - accuracy20: 0.6849 - accuracy30: 0.6591 - accuracy50: 0.6280 - val_loss: 11.5175 - val_accuracy10: 0.6669 - val_accuracy20: 0.6401 - val_accuracy30: 0.6139 - val_accuracy50: 0.5733 - 16s/epoch - 27ms/step
Epoch 15/50
589/589 - 16s - loss: 8.7385 - accuracy10: 0.7082 - accuracy20: 0.6853 - accuracy30: 0.6595 - accuracy50: 0.6298 - val_loss: 11.5446 - val_accuracy10: 0.6803 - val_accuracy20: 0.6542 - val_accuracy30: 0.6258 - val_accuracy50: 0.5824 - 16s/epoch - 26ms/step
Epoch 16/50
589/589 - 16s - loss: 8.7089 - accuracy10: 0.7076 - accuracy20: 0.6854 - accuracy30: 0.6600 - accuracy50: 0.6297 - val_loss: 11.5391 - val_accuracy10: 0.6758 - val_accuracy20: 0.6487 - val_accuracy30: 0.6213 - val_accuracy50: 0.5794 - 16s/epoch - 27ms/step
Epoch 17/50
589/589 - 16s - loss: 8.6817 - accuracy10: 0.7069 - accuracy20: 0.6853 - accuracy30: 0.6596 - accuracy50: 0.6312 - val_loss: 11.5026 - val_accuracy10: 0.6818 - val_accuracy20: 0.6551 - val_accuracy30: 0.6267 - val_accuracy50: 0.5844 - 16s/epoch - 27ms/step
Epoch 18/50
589/589 - 16s - loss: 8.6380 - accuracy10: 0.7096 - accuracy20: 0.6849 - accuracy30: 0.6583 - accuracy50: 0.6298 - val_loss: 11.7123 - val_accuracy10: 0.6946 - val_accuracy20: 0.6640 - val_accuracy30: 0.6331 - val_accuracy50: 0.5879 - 16s/epoch - 27ms/step
Epoch 19/50
589/589 - 16s - loss: 8.5597 - accuracy10: 0.7111 - accuracy20: 0.6877 - accuracy30: 0.6608 - accuracy50: 0.6317 - val_loss: 11.6892 - val_accuracy10: 0.6809 - val_accuracy20: 0.6536 - val_accuracy30: 0.6286 - val_accuracy50: 0.5866 - 16s/epoch - 27ms/step
Epoch 20/50
589/589 - 16s - loss: 8.5274 - accuracy10: 0.7103 - accuracy20: 0.6872 - accuracy30: 0.6621 - accuracy50: 0.6320 - val_loss: 11.7865 - val_accuracy10: 0.6837 - val_accuracy20: 0.6597 - val_accuracy30: 0.6354 - val_accuracy50: 0.5924 - 16s/epoch - 27ms/step
testing model: results/QRTEA/W5/deepVOL_L2/seq2seq
Evaluating performance on  test set...
2185/2185 - 20s - 20s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8976159
{'0': {'precision': 0.34275950153612483, 'recall': 0.6144963053729903, 'f1-score': 0.44005885533465117, 'support': 80793}, '1': {'precision': 0.8920864837312038, 'recall': 0.6346573724543118, 'f1-score': 0.7416689596922883, 'support': 397093}, '2': {'precision': 0.3309039338070789, 'recall': 0.5365469749139203, 'f1-score': 0.409349976779859, 'support': 81320}, 'accuracy': 0.6174772802866922, 'macro avg': {'precision': 0.5219166396914692, 'recall': 0.5952335509137407, 'f1-score': 0.5303592639355995, 'support': 559206}, 'weighted avg': {'precision': 0.7311133542720835, 'recall': 0.6174772802866922, 'f1-score': 0.6497669327973599, 'support': 559206}}
[[ 49647  16520  14626]
 [ 71476 252018  73599]
 [ 23722  13966  43632]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.92121667
{'0': {'precision': 0.3984746877054569, 'recall': 0.5917709777578161, 'f1-score': 0.47625708201384576, 'support': 102418}, '1': {'precision': 0.8290336752430615, 'recall': 0.6132499886964778, 'f1-score': 0.7049998619316253, 'support': 353872}, '2': {'precision': 0.3746912433518415, 'recall': 0.529149986396673, 'f1-score': 0.43872277518861497, 'support': 102916}, 'accuracy': 0.5938384065979263, 'macro avg': {'precision': 0.5340665354334533, 'recall': 0.5780569842836556, 'f1-score': 0.5399932397113619, 'support': 559206}, 'weighted avg': {'precision': 0.6665602824215553, 'recall': 0.5938384065979263, 'f1-score': 0.6141003531765998, 'support': 559206}}
[[ 60608  24512  17298]
 [ 63275 217012  73585]
 [ 28217  20241  54458]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.95976794
{'0': {'precision': 0.4240302399638926, 'recall': 0.5733526589703165, 'f1-score': 0.4875136035055604, 'support': 117978}, '1': {'precision': 0.7704528197982461, 'recall': 0.5723051368504561, 'f1-score': 0.6567588809109757, 'support': 322688}, '2': {'precision': 0.3871887188718872, 'recall': 0.5225577864012148, 'f1-score': 0.44480188421823613, 'support': 118540}, 'accuracy': 0.5619807369734946, 'macro avg': {'precision': 0.527223926211342, 'recall': 0.5560718607406625, 'f1-score': 0.5296914562115907, 'support': 559206}, 'weighted avg': {'precision': 0.61612262726185, 'recall': 0.5619807369734946, 'f1-score': 0.5761220463174745, 'support': 559206}}
[[ 67643  30432  19903]
 [ 59875 184676  78137]
 [ 32006  24590  61944]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0038127
{'0': {'precision': 0.45452976498663955, 'recall': 0.534344522646816, 'f1-score': 0.4912161097479797, 'support': 142934}, '1': {'precision': 0.664349649895363, 'recall': 0.524831742400915, 'f1-score': 0.5864063911137142, 'support': 272796}, '2': {'precision': 0.41175298577983216, 'recall': 0.5041330954305947, 'f1-score': 0.4532841180414988, 'support': 143476}, 'accuracy': 0.5219525541571443, 'macro avg': {'precision': 0.5102108002206116, 'recall': 0.5211031201594419, 'f1-score': 0.5103022063010642, 'support': 559206}, 'weighted avg': {'precision': 0.545910372759239, 'recall': 0.5219525541571443, 'f1-score': 0.5279202895195985, 'support': 559206}}
[[ 76376  39992  26566]
 [ 52855 143172  76769]
 [ 38802  32343  72331]]
Evaluating performance on  train set...
589/589 - 6s - 6s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.671258
{'0': {'precision': 0.32145767842589357, 'recall': 0.6764946096047043, 'f1-score': 0.43582120964983817, 'support': 12244}, '1': {'precision': 0.9464719719670867, 'recall': 0.7694205957500834, 'f1-score': 0.848811915422559, 'support': 126026}, '2': {'precision': 0.32292083833934054, 'recall': 0.5842524756460833, 'f1-score': 0.4159454347452284, 'support': 12421}, 'accuracy': 0.7466072957243631, 'macro avg': {'precision': 0.5302834962441069, 'recall': 0.6767225603336237, 'f1-score': 0.5668595199392086, 'support': 150691}, 'weighted avg': {'precision': 0.8442906629246847, 'recall': 0.7466072957243631, 'f1-score': 0.7795755790920925, 'support': 150691}}
[[ 8283  2486  1475]
 [15318 96967 13741]
 [ 2166  2998  7257]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7046625
{'0': {'precision': 0.3912919749573136, 'recall': 0.6569909813056203, 'f1-score': 0.49046928993423256, 'support': 16743}, '1': {'precision': 0.909342137948166, 'recall': 0.752213222829158, 'f1-score': 0.8233480465199097, 'support': 116798}, '2': {'precision': 0.3757655124600393, 'recall': 0.568862973760933, 'f1-score': 0.4525781086911141, 'support': 17150}, 'accuracy': 0.72076633641027, 'macro avg': {'precision': 0.5587998751218396, 'recall': 0.6593557259652371, 'f1-score': 0.5887984817150854, 'support': 150691}, 'weighted avg': {'precision': 0.7910566862219368, 'recall': 0.72076633641027, 'f1-score': 0.7441655243037332, 'support': 150691}}
[[11000  4087  1656]
 [14390 87857 14551]
 [ 2722  4672  9756]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7604364
{'0': {'precision': 0.42310359631452066, 'recall': 0.6331603657029898, 'f1-score': 0.5072452292343019, 'support': 20235}, '1': {'precision': 0.8725670583019286, 'recall': 0.7177123789727039, 'f1-score': 0.787600172080878, 'support': 109686}, '2': {'precision': 0.3871811858231202, 'recall': 0.562782859894078, 'f1-score': 0.4587519623233909, 'support': 20770}, 'accuracy': 0.6850044130040944, 'macro avg': {'precision': 0.5609506134798565, 'recall': 0.6378852015232573, 'f1-score': 0.5845324545461902, 'support': 150691}, 'weighted avg': {'precision': 0.7453109001723783, 'recall': 0.6850044130040944, 'f1-score': 0.7046279999859056, 'support': 150691}}
[[12812  5538  1885]
 [14347 78723 16616]
 [ 3122  5959 11689]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.83375615
{'0': {'precision': 0.46578178275694104, 'recall': 0.5807333181507629, 'f1-score': 0.5169442848937392, 'support': 26346}, '1': {'precision': 0.7971241956319647, 'recall': 0.6774087639919152, 'f1-score': 0.7324067089674757, 'support': 97467}, '2': {'precision': 0.4102359056377449, 'recall': 0.5344147630031997, 'f1-score': 0.46416338137400637, 'support': 26878}, 'accuracy': 0.6350014267607222, 'macro avg': {'precision': 0.557713961342217, 'recall': 0.5975189483819593, 'f1-score': 0.5711714584117403, 'support': 150691}, 'weighted avg': {'precision': 0.670186749679187, 'recall': 0.6350014267607222, 'f1-score': 0.6468912025092006, 'support': 150691}}
[[15300  8373  2673]
 [13465 66025 17977]
 [ 4083  8431 14364]]
Evaluating performance on  val set...
222/222 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7387551
{'0': {'precision': 0.3007202395403415, 'recall': 0.6722141823444283, 'f1-score': 0.41554375174727426, 'support': 5528}, '1': {'precision': 0.9267761394101877, 'recall': 0.730985263992599, 'f1-score': 0.8173187040526064, 'support': 45399}, '2': {'precision': 0.37121301426382175, 'recall': 0.5504282468099982, 'f1-score': 0.4433962264150943, 'support': 5721}, 'accuracy': 0.7070152520830392, 'macro avg': {'precision': 0.5329031310714503, 'recall': 0.6512092310490085, 'f1-score': 0.5587528940716583, 'support': 56648}, 'weighted avg': {'precision': 0.8095749380713432, 'recall': 0.7070152520830392, 'f1-score': 0.7403482473567287, 'support': 56648}}
[[ 3716  1172   640]
 [ 7519 33186  4694]
 [ 1122  1450  3149]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7765065
{'0': {'precision': 0.36413690476190474, 'recall': 0.6531429334045109, 'f1-score': 0.4675870634882721, 'support': 7493}, '1': {'precision': 0.8739290085679314, 'recall': 0.708899382491827, 'f1-score': 0.7828109958284308, 'support': 41295}, '2': {'precision': 0.41777365873751415, 'recall': 0.5161577608142494, 'f1-score': 0.4617836207387172, 'support': 7860}, 'accuracy': 0.6747811043637905, 'macro avg': {'precision': 0.55194652402245, 'recall': 0.6260666922368624, 'f1-score': 0.5707272266851401, 'support': 56648}, 'weighted avg': {'precision': 0.743205006246832, 'recall': 0.6747811043637905, 'f1-score': 0.69657232732769, 'support': 56648}}
[[ 4894  1895   704]
 [ 7071 29274  4950]
 [ 1475  2328  4057]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8315626
{'0': {'precision': 0.3947331851028349, 'recall': 0.6289161961696004, 'f1-score': 0.4850373532550694, 'support': 9033}, '1': {'precision': 0.8271890883355851, 'recall': 0.6743417602014057, 'f1-score': 0.742985928515704, 'support': 38132}, '2': {'precision': 0.42963294538943597, 'recall': 0.5060634820204577, 'f1-score': 0.4647266740909311, 'support': 9483}, 'accuracy': 0.6389281174975286, 'macro avg': {'precision': 0.5505184062759519, 'recall': 0.6031071461304879, 'f1-score': 0.5642499852872348, 'support': 56648}, 'weighted avg': {'precision': 0.6916785835082345, 'recall': 0.6389281174975286, 'f1-score': 0.6552726466692234, 'support': 56648}}
[[ 5681  2495   857]
 [ 6904 25714  5514]
 [ 1807  2877  4799]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9061349
{'0': {'precision': 0.4297866855706644, 'recall': 0.5738748816797178, 'f1-score': 0.49148795047534827, 'support': 11621}, '1': {'precision': 0.7283484035038147, 'recall': 0.6285165655765187, 'f1-score': 0.6747599024885065, 'support': 32809}, '2': {'precision': 0.454403619627116, 'recall': 0.4767556064822393, 'f1-score': 0.4653113392179574, 'support': 12218}, 'accuracy': 0.5845749187967801, 'macro avg': {'precision': 0.5375129029005317, 'recall': 0.559715684579492, 'f1-score': 0.543853064060604, 'support': 56648}, 'weighted avg': {'precision': 0.6080150626355291, 'recall': 0.5845749187967801, 'f1-score': 0.591988297129368, 'support': 56648}}
[[ 6669  3700  1252]
 [ 6446 20621  5742]
 [ 2402  3991  5825]]
training model: results/QRTEA/W5/deepVOL_L3/seq2seq
Epoch 1/50
589/589 - 31s - loss: 11.1722 - accuracy10: 0.5212 - accuracy20: 0.5269 - accuracy30: 0.5290 - accuracy50: 0.5276 - val_loss: 12.1504 - val_accuracy10: 0.6597 - val_accuracy20: 0.6333 - val_accuracy30: 0.6056 - val_accuracy50: 0.5634 - 31s/epoch - 53ms/step
Epoch 2/50
589/589 - 24s - loss: 9.9402 - accuracy10: 0.6523 - accuracy20: 0.6405 - accuracy30: 0.6216 - accuracy50: 0.5981 - val_loss: 11.9652 - val_accuracy10: 0.6791 - val_accuracy20: 0.6613 - val_accuracy30: 0.6368 - val_accuracy50: 0.5917 - 24s/epoch - 41ms/step
Epoch 3/50
589/589 - 24s - loss: 9.5334 - accuracy10: 0.6750 - accuracy20: 0.6610 - accuracy30: 0.6402 - accuracy50: 0.6141 - val_loss: 11.8853 - val_accuracy10: 0.7148 - val_accuracy20: 0.6959 - val_accuracy30: 0.6694 - val_accuracy50: 0.6177 - 24s/epoch - 41ms/step
Epoch 4/50
589/589 - 23s - loss: 9.3393 - accuracy10: 0.6902 - accuracy20: 0.6732 - accuracy30: 0.6491 - accuracy50: 0.6195 - val_loss: 11.9194 - val_accuracy10: 0.7287 - val_accuracy20: 0.7014 - val_accuracy30: 0.6664 - val_accuracy50: 0.6077 - 23s/epoch - 40ms/step
Epoch 5/50
589/589 - 24s - loss: 9.2321 - accuracy10: 0.6919 - accuracy20: 0.6766 - accuracy30: 0.6536 - accuracy50: 0.6251 - val_loss: 11.7190 - val_accuracy10: 0.7227 - val_accuracy20: 0.6977 - val_accuracy30: 0.6705 - val_accuracy50: 0.6189 - 24s/epoch - 40ms/step
Epoch 6/50
589/589 - 23s - loss: 9.1424 - accuracy10: 0.6931 - accuracy20: 0.6767 - accuracy30: 0.6540 - accuracy50: 0.6260 - val_loss: 11.6081 - val_accuracy10: 0.7162 - val_accuracy20: 0.6907 - val_accuracy30: 0.6602 - val_accuracy50: 0.6083 - 23s/epoch - 40ms/step
Epoch 7/50
589/589 - 23s - loss: 9.0253 - accuracy10: 0.7013 - accuracy20: 0.6835 - accuracy30: 0.6604 - accuracy50: 0.6305 - val_loss: 11.5589 - val_accuracy10: 0.7068 - val_accuracy20: 0.6814 - val_accuracy30: 0.6502 - val_accuracy50: 0.6004 - 23s/epoch - 39ms/step
Epoch 8/50
589/589 - 23s - loss: 8.9647 - accuracy10: 0.7001 - accuracy20: 0.6814 - accuracy30: 0.6580 - accuracy50: 0.6300 - val_loss: 11.6748 - val_accuracy10: 0.7051 - val_accuracy20: 0.6839 - val_accuracy30: 0.6569 - val_accuracy50: 0.6126 - 23s/epoch - 40ms/step
Epoch 9/50
589/589 - 23s - loss: 8.8807 - accuracy10: 0.7053 - accuracy20: 0.6847 - accuracy30: 0.6595 - accuracy50: 0.6311 - val_loss: 11.4263 - val_accuracy10: 0.7220 - val_accuracy20: 0.6989 - val_accuracy30: 0.6712 - val_accuracy50: 0.6212 - 23s/epoch - 40ms/step
Epoch 10/50
589/589 - 23s - loss: 8.8117 - accuracy10: 0.7080 - accuracy20: 0.6861 - accuracy30: 0.6614 - accuracy50: 0.6332 - val_loss: 11.5403 - val_accuracy10: 0.7034 - val_accuracy20: 0.6754 - val_accuracy30: 0.6434 - val_accuracy50: 0.5964 - 23s/epoch - 39ms/step
Epoch 11/50
589/589 - 23s - loss: 8.7658 - accuracy10: 0.7113 - accuracy20: 0.6890 - accuracy30: 0.6629 - accuracy50: 0.6328 - val_loss: 11.3574 - val_accuracy10: 0.6820 - val_accuracy20: 0.6567 - val_accuracy30: 0.6247 - val_accuracy50: 0.5808 - 23s/epoch - 39ms/step
Epoch 12/50
589/589 - 23s - loss: 8.7301 - accuracy10: 0.7119 - accuracy20: 0.6897 - accuracy30: 0.6630 - accuracy50: 0.6316 - val_loss: 11.5678 - val_accuracy10: 0.6696 - val_accuracy20: 0.6431 - val_accuracy30: 0.6115 - val_accuracy50: 0.5737 - 23s/epoch - 39ms/step
Epoch 13/50
589/589 - 23s - loss: 8.6697 - accuracy10: 0.7094 - accuracy20: 0.6878 - accuracy30: 0.6614 - accuracy50: 0.6337 - val_loss: 11.4778 - val_accuracy10: 0.6772 - val_accuracy20: 0.6450 - val_accuracy30: 0.6109 - val_accuracy50: 0.5690 - 23s/epoch - 39ms/step
Epoch 14/50
589/589 - 23s - loss: 8.6438 - accuracy10: 0.7110 - accuracy20: 0.6877 - accuracy30: 0.6610 - accuracy50: 0.6315 - val_loss: 11.3539 - val_accuracy10: 0.6811 - val_accuracy20: 0.6542 - val_accuracy30: 0.6228 - val_accuracy50: 0.5826 - 23s/epoch - 39ms/step
Epoch 15/50
589/589 - 23s - loss: 8.5988 - accuracy10: 0.7121 - accuracy20: 0.6894 - accuracy30: 0.6620 - accuracy50: 0.6327 - val_loss: 11.3904 - val_accuracy10: 0.6820 - val_accuracy20: 0.6562 - val_accuracy30: 0.6250 - val_accuracy50: 0.5832 - 23s/epoch - 40ms/step
Epoch 16/50
589/589 - 24s - loss: 8.5389 - accuracy10: 0.7126 - accuracy20: 0.6900 - accuracy30: 0.6627 - accuracy50: 0.6338 - val_loss: 11.2296 - val_accuracy10: 0.6681 - val_accuracy20: 0.6438 - val_accuracy30: 0.6115 - val_accuracy50: 0.5674 - 24s/epoch - 40ms/step
Epoch 17/50
589/589 - 23s - loss: 8.5149 - accuracy10: 0.7127 - accuracy20: 0.6904 - accuracy30: 0.6638 - accuracy50: 0.6348 - val_loss: 11.4296 - val_accuracy10: 0.6940 - val_accuracy20: 0.6644 - val_accuracy30: 0.6300 - val_accuracy50: 0.5848 - 23s/epoch - 39ms/step
Epoch 18/50
589/589 - 24s - loss: 8.4527 - accuracy10: 0.7120 - accuracy20: 0.6909 - accuracy30: 0.6652 - accuracy50: 0.6361 - val_loss: 11.1530 - val_accuracy10: 0.6954 - val_accuracy20: 0.6723 - val_accuracy30: 0.6444 - val_accuracy50: 0.6002 - 24s/epoch - 40ms/step
Epoch 19/50
589/589 - 23s - loss: 8.4132 - accuracy10: 0.7140 - accuracy20: 0.6913 - accuracy30: 0.6653 - accuracy50: 0.6358 - val_loss: 11.2022 - val_accuracy10: 0.6874 - val_accuracy20: 0.6603 - val_accuracy30: 0.6297 - val_accuracy50: 0.5914 - 23s/epoch - 40ms/step
Epoch 20/50
589/589 - 23s - loss: 8.4039 - accuracy10: 0.7138 - accuracy20: 0.6917 - accuracy30: 0.6655 - accuracy50: 0.6376 - val_loss: 11.2874 - val_accuracy10: 0.6737 - val_accuracy20: 0.6540 - val_accuracy30: 0.6305 - val_accuracy50: 0.5938 - 23s/epoch - 40ms/step
Epoch 21/50
589/589 - 25s - loss: 8.3536 - accuracy10: 0.7139 - accuracy20: 0.6918 - accuracy30: 0.6660 - accuracy50: 0.6387 - val_loss: 11.1827 - val_accuracy10: 0.6642 - val_accuracy20: 0.6407 - val_accuracy30: 0.6146 - val_accuracy50: 0.5786 - 25s/epoch - 42ms/step
Epoch 22/50
589/589 - 25s - loss: 8.2978 - accuracy10: 0.7158 - accuracy20: 0.6940 - accuracy30: 0.6676 - accuracy50: 0.6397 - val_loss: 11.3695 - val_accuracy10: 0.6642 - val_accuracy20: 0.6387 - val_accuracy30: 0.6108 - val_accuracy50: 0.5761 - 25s/epoch - 42ms/step
Epoch 23/50
589/589 - 25s - loss: 8.2845 - accuracy10: 0.7147 - accuracy20: 0.6937 - accuracy30: 0.6677 - accuracy50: 0.6395 - val_loss: 11.2492 - val_accuracy10: 0.6629 - val_accuracy20: 0.6395 - val_accuracy30: 0.6128 - val_accuracy50: 0.5775 - 25s/epoch - 42ms/step
Epoch 24/50
589/589 - 24s - loss: 8.2308 - accuracy10: 0.7171 - accuracy20: 0.6949 - accuracy30: 0.6691 - accuracy50: 0.6426 - val_loss: 11.2812 - val_accuracy10: 0.6809 - val_accuracy20: 0.6536 - val_accuracy30: 0.6234 - val_accuracy50: 0.5816 - 24s/epoch - 40ms/step
Epoch 25/50
589/589 - 23s - loss: 8.1906 - accuracy10: 0.7176 - accuracy20: 0.6946 - accuracy30: 0.6688 - accuracy50: 0.6415 - val_loss: 11.3198 - val_accuracy10: 0.6563 - val_accuracy20: 0.6312 - val_accuracy30: 0.6017 - val_accuracy50: 0.5654 - 23s/epoch - 39ms/step
Epoch 26/50
589/589 - 23s - loss: 8.1667 - accuracy10: 0.7185 - accuracy20: 0.6969 - accuracy30: 0.6703 - accuracy50: 0.6422 - val_loss: 11.3731 - val_accuracy10: 0.6576 - val_accuracy20: 0.6325 - val_accuracy30: 0.6050 - val_accuracy50: 0.5705 - 23s/epoch - 39ms/step
Epoch 27/50
589/589 - 23s - loss: 8.1089 - accuracy10: 0.7169 - accuracy20: 0.6964 - accuracy30: 0.6703 - accuracy50: 0.6448 - val_loss: 11.2540 - val_accuracy10: 0.6545 - val_accuracy20: 0.6311 - val_accuracy30: 0.6038 - val_accuracy50: 0.5677 - 23s/epoch - 40ms/step
Epoch 28/50
589/589 - 23s - loss: 8.0861 - accuracy10: 0.7184 - accuracy20: 0.6963 - accuracy30: 0.6711 - accuracy50: 0.6441 - val_loss: 11.4525 - val_accuracy10: 0.6621 - val_accuracy20: 0.6399 - val_accuracy30: 0.6106 - val_accuracy50: 0.5743 - 23s/epoch - 40ms/step
testing model: results/QRTEA/W5/deepVOL_L3/seq2seq
Evaluating performance on  test set...
2185/2185 - 35s - 35s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9269647
{'0': {'precision': 0.3022468751351585, 'recall': 0.6919658881338729, 'f1-score': 0.42072388348930057, 'support': 80793}, '1': {'precision': 0.9011714433666459, 'recall': 0.5565824630502174, 'f1-score': 0.6881493774383277, 'support': 397093}, '2': {'precision': 0.319990696592627, 'recall': 0.5075504181013281, 'f1-score': 0.39251563205820117, 'support': 81320}, 'accuracy': 0.5690121350629285, 'macro avg': {'precision': 0.5078030050314771, 'recall': 0.5853662564284727, 'f1-score': 0.5004629643286099, 'support': 559206}, 'weighted avg': {'precision': 0.7301244035122992, 'recall': 0.5690121350629285, 'f1-score': 0.606521061384967, 'support': 559206}}
[[ 55906  13192  11695]
 [100062 221015  76016]
 [ 29000  11046  41274]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.94976
{'0': {'precision': 0.35261801234150025, 'recall': 0.6611630768029058, 'f1-score': 0.4599375791722279, 'support': 102418}, '1': {'precision': 0.8392213217180192, 'recall': 0.5313955328480354, 'f1-score': 0.6507412482870312, 'support': 353872}, '2': {'precision': 0.3695413664665721, 'recall': 0.5138268102141552, 'f1-score': 0.4299006158161088, 'support': 102916}, 'accuracy': 0.5519289850251965, 'macro avg': {'precision': 0.5204602335086972, 'recall': 0.5687951399550322, 'f1-score': 0.5135264810917892, 'support': 559206}, 'weighted avg': {'precision': 0.663660759037393, 'recall': 0.5519289850251965, 'f1-score': 0.5751523513245926, 'support': 559206}}
[[ 67715  19647  15056]
 [ 90664 188046  75162]
 [ 33656  16379  52881]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.97980106
{'0': {'precision': 0.3787870432110216, 'recall': 0.6404075336079608, 'f1-score': 0.4760191657662369, 'support': 117978}, '1': {'precision': 0.7833619807352343, 'recall': 0.49573581911939707, 'f1-score': 0.6072101652131829, 'support': 322688}, '2': {'precision': 0.3900447484826664, 'recall': 0.5117766154884427, 'f1-score': 0.44269472701002643, 'support': 118540}, 'accuracy': 0.5296581224092731, 'macro avg': {'precision': 0.5173979241429741, 'recall': 0.5493066560719335, 'f1-score': 0.5086413526631488, 'support': 559206}, 'weighted avg': {'precision': 0.6146320910515561, 'recall': 0.5296581224092731, 'f1-score': 0.5446584190277808, 'support': 559206}}
[[ 75554  24381  18043]
 [ 85893 159968  76827]
 [ 38016  19858  60666]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0094227
{'0': {'precision': 0.41678523388902106, 'recall': 0.6004799417913163, 'f1-score': 0.4920470669170023, 'support': 142934}, '1': {'precision': 0.6798235883005492, 'recall': 0.46051994897285886, 'f1-score': 0.549084225869827, 'support': 272796}, '2': {'precision': 0.4194207027540361, 'recall': 0.4925144275000697, 'f1-score': 0.45303824898383105, 'support': 143476}, 'accuracy': 0.5045028129168857, 'macro avg': {'precision': 0.5053431749812022, 'recall': 0.5178381060880816, 'f1-score': 0.4980565139235534, 'support': 559206}, 'weighted avg': {'precision': 0.5457787308488607, 'recall': 0.5045028129168857, 'f1-score': 0.5098628264973986, 'support': 559206}}
[[ 85829  32575  24530]
 [ 73882 125628  73286]
 [ 46220  26592  70664]]
Evaluating performance on  train set...
589/589 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.651041
{'0': {'precision': 0.32256006006006005, 'recall': 0.701813132963084, 'f1-score': 0.44198127764633266, 'support': 12244}, '1': {'precision': 0.9544034849792463, 'recall': 0.737101867868535, 'f1-score': 0.831794697302089, 'support': 126026}, '2': {'precision': 0.2989632845540626, 'recall': 0.6431044199339828, 'f1-score': 0.40817577925396015, 'support': 12421}, 'accuracy': 0.7264866514921263, 'macro avg': {'precision': 0.5253089431977896, 'recall': 0.694006473588534, 'f1-score': 0.5606505847341273, 'support': 150691}, 'weighted avg': {'precision': 0.8490387742520515, 'recall': 0.7264866514921263, 'f1-score': 0.7652038186740296, 'support': 150691}}
[[ 8593  2179  1472]
 [15873 92894 17259]
 [ 2174  2259  7988]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.67771256
{'0': {'precision': 0.3936841375485302, 'recall': 0.6783133249716299, 'f1-score': 0.49821236647583955, 'support': 16743}, '1': {'precision': 0.9186667245345254, 'recall': 0.724909673110841, 'f1-score': 0.8103674352274576, 'support': 116798}, '2': {'precision': 0.3612655412918225, 'recall': 0.6251895043731779, 'f1-score': 0.4579213735078691, 'support': 17150}, 'accuracy': 0.7083833805602192, 'macro avg': {'precision': 0.5578721344582926, 'recall': 0.6761375008185496, 'f1-score': 0.5888337250703887, 'support': 150691}, 'weighted avg': {'precision': 0.7968995735665255, 'recall': 0.7083833805602192, 'f1-score': 0.7355729068574868, 'support': 150691}}
[[11357  3653  1733]
 [14906 84668 17224]
 [ 2585  3843 10722]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7259917
{'0': {'precision': 0.4290806571826696, 'recall': 0.654361255250803, 'f1-score': 0.5182996046502525, 'support': 20235}, '1': {'precision': 0.8827963024478528, 'recall': 0.7026329704793683, 'f1-score': 0.7824780315452288, 'support': 109686}, '2': {'precision': 0.3913190495219944, 'recall': 0.6129032258064516, 'f1-score': 0.47766458415414353, 'support': 20770}, 'accuracy': 0.6837833712696844, 'macro avg': {'precision': 0.5677320030508389, 'recall': 0.656632483845541, 'f1-score': 0.5928140734498749, 'support': 150691}, 'weighted avg': {'precision': 0.7541295696953256, 'recall': 0.6837833712696844, 'f1-score': 0.7049908175076772, 'support': 150691}}
[[13241  5069  1925]
 [14741 77069 17876]
 [ 2877  5163 12730]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.79546964
{'0': {'precision': 0.47964520568894325, 'recall': 0.5952326728915205, 'f1-score': 0.5312240646330516, 'support': 26346}, '1': {'precision': 0.8077524832931074, 'recall': 0.6833081966203945, 'f1-score': 0.7403372647539435, 'support': 97467}, '2': {'precision': 0.433084822056548, 'recall': 0.5727360666716274, 'f1-score': 0.4932156416705381, 'support': 26878}, 'accuracy': 0.6481873502730754, 'macro avg': {'precision': 0.5734941703461995, 'recall': 0.6170923120611808, 'f1-score': 0.5882589903525112, 'support': 150691}, 'weighted avg': {'precision': 0.6835603833370679, 'recall': 0.6481873502730754, 'f1-score': 0.6596991950907201, 'support': 150691}}
[[15682  8009  2655]
 [13371 66600 17496]
 [ 3642  7842 15394]]
Evaluating performance on  val set...
222/222 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7080382
{'0': {'precision': 0.307452447770502, 'recall': 0.7134587554269175, 'f1-score': 0.4297232512529963, 'support': 5528}, '1': {'precision': 0.9367062739030158, 'recall': 0.7067336284940197, 'f1-score': 0.8056294882739918, 'support': 45399}, '2': {'precision': 0.34974391136197347, 'recall': 0.5848627862261843, 'f1-score': 0.4377289377289378, 'support': 5721}, 'accuracy': 0.6950819093348397, 'macro avg': {'precision': 0.531300877678497, 'recall': 0.6683517233823738, 'f1-score': 0.557693892418642, 'support': 56648}, 'weighted avg': {'precision': 0.8160219279956962, 'recall': 0.6950819093348397, 'f1-score': 0.7317915994178926, 'support': 56648}}
[[ 3944   997   587]
 [ 7680 32085  5634]
 [ 1204  1171  3346]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7445964
{'0': {'precision': 0.3706126008284282, 'recall': 0.6806352595756039, 'f1-score': 0.47990966406323515, 'support': 7493}, '1': {'precision': 0.8880260910079205, 'recall': 0.6923356338539775, 'f1-score': 0.7780650428629745, 'support': 41295}, '2': {'precision': 0.4151702207257763, 'recall': 0.5647582697201018, 'f1-score': 0.4785467874083657, 'support': 7860}, 'accuracy': 0.673086428470555, 'macro avg': {'precision': 0.5579363041873749, 'recall': 0.6459097210498944, 'f1-score': 0.5788404981115252, 'support': 56648}, 'weighted avg': {'precision': 0.7539767614228939, 'recall': 0.673086428470555, 'f1-score': 0.6970685073944731, 'support': 56648}}
[[ 5100  1699   694]
 [ 7146 28590  5559]
 [ 1515  1906  4439]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.79561967
{'0': {'precision': 0.40338427947598254, 'recall': 0.6544890955385808, 'f1-score': 0.4991346194436237, 'support': 9033}, '1': {'precision': 0.8413306052405782, 'recall': 0.6685723277037658, 'f1-score': 0.7450682409328696, 'support': 38132}, '2': {'precision': 0.44003421727972625, 'recall': 0.5424443741432037, 'f1-score': 0.48590185613753367, 'support': 9483}, 'accuracy': 0.6452125406016099, 'macro avg': {'precision': 0.5615830339987623, 'recall': 0.6218352657951834, 'f1-score': 0.5767015721713423, 'support': 56648}, 'weighted avg': {'precision': 0.7043184811114943, 'recall': 0.6452125406016099, 'f1-score': 0.6624670329480065, 'support': 56648}}
[[ 5912  2305   816]
 [ 6908 25494  5730]
 [ 1836  2503  5144]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8707312
{'0': {'precision': 0.44728641911191896, 'recall': 0.5928921779537045, 'f1-score': 0.5098982423681776, 'support': 11621}, '1': {'precision': 0.7440689897923266, 'recall': 0.6443049163339327, 'f1-score': 0.6906025906989659, 'support': 32809}, '2': {'precision': 0.4735857877512856, 'recall': 0.49746275986249794, 'f1-score': 0.48523072010218743, 'support': 12218}, 'accuracy': 0.6020865696935461, 'macro avg': {'precision': 0.554980398885177, 'recall': 0.5782199513833784, 'f1-score': 0.5619105177231104, 'support': 56648}, 'weighted avg': {'precision': 0.6248472341007848, 'recall': 0.6020865696935461, 'f1-score': 0.6092369864957543, 'support': 56648}}
[[ 6890  3537  1194]
 [ 6108 21139  5562]
 [ 2406  3734  6078]]
training model: results/QRTEA/W6/deepLOB_L1/seq2seq
Epoch 1/50
533/533 - 17s - loss: 11.7388 - accuracy10: 0.4483 - accuracy20: 0.4636 - accuracy30: 0.4724 - accuracy50: 0.4794 - val_loss: 12.6385 - val_accuracy10: 0.1969 - val_accuracy20: 0.2388 - val_accuracy30: 0.2735 - val_accuracy50: 0.3240 - 17s/epoch - 31ms/step
Epoch 2/50
533/533 - 11s - loss: 11.5302 - accuracy10: 0.4598 - accuracy20: 0.4757 - accuracy30: 0.4850 - accuracy50: 0.4910 - val_loss: 11.7259 - val_accuracy10: 0.4395 - val_accuracy20: 0.4481 - val_accuracy30: 0.4546 - val_accuracy50: 0.4629 - 11s/epoch - 21ms/step
Epoch 3/50
533/533 - 11s - loss: 11.2279 - accuracy10: 0.4876 - accuracy20: 0.4989 - accuracy30: 0.5042 - accuracy50: 0.5081 - val_loss: 11.4429 - val_accuracy10: 0.4659 - val_accuracy20: 0.4771 - val_accuracy30: 0.4846 - val_accuracy50: 0.4916 - 11s/epoch - 21ms/step
Epoch 4/50
533/533 - 12s - loss: 10.9904 - accuracy10: 0.5219 - accuracy20: 0.5275 - accuracy30: 0.5292 - accuracy50: 0.5275 - val_loss: 11.4361 - val_accuracy10: 0.4489 - val_accuracy20: 0.4594 - val_accuracy30: 0.4653 - val_accuracy50: 0.4750 - 12s/epoch - 22ms/step
Epoch 5/50
533/533 - 12s - loss: 10.7876 - accuracy10: 0.5437 - accuracy20: 0.5456 - accuracy30: 0.5442 - accuracy50: 0.5394 - val_loss: 11.3251 - val_accuracy10: 0.4754 - val_accuracy20: 0.4751 - val_accuracy30: 0.4724 - val_accuracy50: 0.4750 - 12s/epoch - 23ms/step
Epoch 6/50
533/533 - 12s - loss: 10.5990 - accuracy10: 0.5679 - accuracy20: 0.5646 - accuracy30: 0.5582 - accuracy50: 0.5492 - val_loss: 11.2317 - val_accuracy10: 0.4968 - val_accuracy20: 0.4899 - val_accuracy30: 0.4824 - val_accuracy50: 0.4806 - 12s/epoch - 22ms/step
Epoch 7/50
533/533 - 11s - loss: 10.4105 - accuracy10: 0.5892 - accuracy20: 0.5815 - accuracy30: 0.5712 - accuracy50: 0.5587 - val_loss: 11.3430 - val_accuracy10: 0.5132 - val_accuracy20: 0.4974 - val_accuracy30: 0.4828 - val_accuracy50: 0.4777 - 11s/epoch - 20ms/step
Epoch 8/50
533/533 - 11s - loss: 10.2393 - accuracy10: 0.6127 - accuracy20: 0.6005 - accuracy30: 0.5858 - accuracy50: 0.5689 - val_loss: 11.1258 - val_accuracy10: 0.5209 - val_accuracy20: 0.5043 - val_accuracy30: 0.4861 - val_accuracy50: 0.4783 - 11s/epoch - 21ms/step
Epoch 9/50
533/533 - 11s - loss: 10.1223 - accuracy10: 0.6195 - accuracy20: 0.6068 - accuracy30: 0.5916 - accuracy50: 0.5732 - val_loss: 11.0123 - val_accuracy10: 0.5267 - val_accuracy20: 0.5043 - val_accuracy30: 0.4810 - val_accuracy50: 0.4684 - 11s/epoch - 21ms/step
Epoch 10/50
533/533 - 12s - loss: 10.0141 - accuracy10: 0.6274 - accuracy20: 0.6133 - accuracy30: 0.5974 - accuracy50: 0.5769 - val_loss: 11.1009 - val_accuracy10: 0.5170 - val_accuracy20: 0.5018 - val_accuracy30: 0.4850 - val_accuracy50: 0.4755 - 12s/epoch - 22ms/step
Epoch 11/50
533/533 - 12s - loss: 9.9274 - accuracy10: 0.6330 - accuracy20: 0.6186 - accuracy30: 0.6017 - accuracy50: 0.5804 - val_loss: 10.8982 - val_accuracy10: 0.5327 - val_accuracy20: 0.5116 - val_accuracy30: 0.4899 - val_accuracy50: 0.4773 - 12s/epoch - 22ms/step
Epoch 12/50
533/533 - 11s - loss: 9.8568 - accuracy10: 0.6398 - accuracy20: 0.6240 - accuracy30: 0.6048 - accuracy50: 0.5810 - val_loss: 10.8878 - val_accuracy10: 0.5368 - val_accuracy20: 0.5186 - val_accuracy30: 0.4972 - val_accuracy50: 0.4846 - 11s/epoch - 21ms/step
Epoch 13/50
533/533 - 11s - loss: 9.7758 - accuracy10: 0.6442 - accuracy20: 0.6274 - accuracy30: 0.6075 - accuracy50: 0.5831 - val_loss: 10.9043 - val_accuracy10: 0.5199 - val_accuracy20: 0.5043 - val_accuracy30: 0.4849 - val_accuracy50: 0.4720 - 11s/epoch - 21ms/step
Epoch 14/50
533/533 - 11s - loss: 9.7250 - accuracy10: 0.6469 - accuracy20: 0.6297 - accuracy30: 0.6100 - accuracy50: 0.5862 - val_loss: 10.9356 - val_accuracy10: 0.5141 - val_accuracy20: 0.4922 - val_accuracy30: 0.4693 - val_accuracy50: 0.4600 - 11s/epoch - 20ms/step
Epoch 15/50
533/533 - 11s - loss: 9.6697 - accuracy10: 0.6510 - accuracy20: 0.6322 - accuracy30: 0.6128 - accuracy50: 0.5873 - val_loss: 10.9115 - val_accuracy10: 0.5118 - val_accuracy20: 0.4915 - val_accuracy30: 0.4692 - val_accuracy50: 0.4579 - 11s/epoch - 20ms/step
Epoch 16/50
533/533 - 11s - loss: 9.6264 - accuracy10: 0.6534 - accuracy20: 0.6360 - accuracy30: 0.6157 - accuracy50: 0.5899 - val_loss: 10.8484 - val_accuracy10: 0.5190 - val_accuracy20: 0.4954 - val_accuracy30: 0.4720 - val_accuracy50: 0.4572 - 11s/epoch - 21ms/step
Epoch 17/50
533/533 - 11s - loss: 9.5764 - accuracy10: 0.6568 - accuracy20: 0.6381 - accuracy30: 0.6170 - accuracy50: 0.5899 - val_loss: 10.8631 - val_accuracy10: 0.5237 - val_accuracy20: 0.4970 - val_accuracy30: 0.4704 - val_accuracy50: 0.4588 - 11s/epoch - 20ms/step
Epoch 18/50
533/533 - 11s - loss: 9.5460 - accuracy10: 0.6583 - accuracy20: 0.6403 - accuracy30: 0.6188 - accuracy50: 0.5919 - val_loss: 10.8630 - val_accuracy10: 0.5171 - val_accuracy20: 0.4910 - val_accuracy30: 0.4673 - val_accuracy50: 0.4553 - 11s/epoch - 21ms/step
Epoch 19/50
533/533 - 11s - loss: 9.4886 - accuracy10: 0.6618 - accuracy20: 0.6438 - accuracy30: 0.6228 - accuracy50: 0.5957 - val_loss: 10.8691 - val_accuracy10: 0.5147 - val_accuracy20: 0.4886 - val_accuracy30: 0.4640 - val_accuracy50: 0.4492 - 11s/epoch - 21ms/step
Epoch 20/50
533/533 - 11s - loss: 9.4626 - accuracy10: 0.6628 - accuracy20: 0.6444 - accuracy30: 0.6244 - accuracy50: 0.5966 - val_loss: 10.8626 - val_accuracy10: 0.5066 - val_accuracy20: 0.4851 - val_accuracy30: 0.4635 - val_accuracy50: 0.4540 - 11s/epoch - 20ms/step
Epoch 21/50
533/533 - 11s - loss: 9.4350 - accuracy10: 0.6628 - accuracy20: 0.6452 - accuracy30: 0.6245 - accuracy50: 0.5965 - val_loss: 10.8990 - val_accuracy10: 0.5255 - val_accuracy20: 0.5020 - val_accuracy30: 0.4768 - val_accuracy50: 0.4602 - 11s/epoch - 21ms/step
Epoch 22/50
533/533 - 11s - loss: 9.4035 - accuracy10: 0.6632 - accuracy20: 0.6450 - accuracy30: 0.6251 - accuracy50: 0.5980 - val_loss: 10.8687 - val_accuracy10: 0.5300 - val_accuracy20: 0.5066 - val_accuracy30: 0.4829 - val_accuracy50: 0.4661 - 11s/epoch - 20ms/step
Epoch 23/50
533/533 - 11s - loss: 9.3665 - accuracy10: 0.6645 - accuracy20: 0.6471 - accuracy30: 0.6267 - accuracy50: 0.5996 - val_loss: 10.9032 - val_accuracy10: 0.5425 - val_accuracy20: 0.5211 - val_accuracy30: 0.4962 - val_accuracy50: 0.4771 - 11s/epoch - 20ms/step
Epoch 24/50
533/533 - 11s - loss: 9.3379 - accuracy10: 0.6667 - accuracy20: 0.6499 - accuracy30: 0.6290 - accuracy50: 0.6003 - val_loss: 10.8087 - val_accuracy10: 0.5365 - val_accuracy20: 0.5101 - val_accuracy30: 0.4864 - val_accuracy50: 0.4682 - 11s/epoch - 21ms/step
Epoch 25/50
533/533 - 11s - loss: 9.3049 - accuracy10: 0.6673 - accuracy20: 0.6486 - accuracy30: 0.6279 - accuracy50: 0.5986 - val_loss: 10.8618 - val_accuracy10: 0.5297 - val_accuracy20: 0.5059 - val_accuracy30: 0.4831 - val_accuracy50: 0.4681 - 11s/epoch - 21ms/step
Epoch 26/50
533/533 - 11s - loss: 9.2852 - accuracy10: 0.6686 - accuracy20: 0.6514 - accuracy30: 0.6298 - accuracy50: 0.6000 - val_loss: 10.8399 - val_accuracy10: 0.5332 - val_accuracy20: 0.5085 - val_accuracy30: 0.4839 - val_accuracy50: 0.4639 - 11s/epoch - 20ms/step
Epoch 27/50
533/533 - 12s - loss: 9.2508 - accuracy10: 0.6692 - accuracy20: 0.6517 - accuracy30: 0.6305 - accuracy50: 0.5996 - val_loss: 10.9666 - val_accuracy10: 0.5350 - val_accuracy20: 0.5127 - val_accuracy30: 0.4880 - val_accuracy50: 0.4679 - 12s/epoch - 22ms/step
Epoch 28/50
533/533 - 12s - loss: 9.2118 - accuracy10: 0.6737 - accuracy20: 0.6557 - accuracy30: 0.6342 - accuracy50: 0.6038 - val_loss: 10.8921 - val_accuracy10: 0.5476 - val_accuracy20: 0.5240 - val_accuracy30: 0.4975 - val_accuracy50: 0.4752 - 12s/epoch - 22ms/step
Epoch 29/50
533/533 - 11s - loss: 9.1748 - accuracy10: 0.6726 - accuracy20: 0.6555 - accuracy30: 0.6341 - accuracy50: 0.6048 - val_loss: 10.9826 - val_accuracy10: 0.5302 - val_accuracy20: 0.5104 - val_accuracy30: 0.4876 - val_accuracy50: 0.4689 - 11s/epoch - 20ms/step
Epoch 30/50
533/533 - 11s - loss: 9.1795 - accuracy10: 0.6692 - accuracy20: 0.6519 - accuracy30: 0.6321 - accuracy50: 0.6022 - val_loss: 11.0501 - val_accuracy10: 0.5410 - val_accuracy20: 0.5199 - val_accuracy30: 0.4958 - val_accuracy50: 0.4761 - 11s/epoch - 21ms/step
Epoch 31/50
533/533 - 11s - loss: 9.1661 - accuracy10: 0.6728 - accuracy20: 0.6552 - accuracy30: 0.6341 - accuracy50: 0.6048 - val_loss: 10.9021 - val_accuracy10: 0.5557 - val_accuracy20: 0.5290 - val_accuracy30: 0.4998 - val_accuracy50: 0.4761 - 11s/epoch - 20ms/step
Epoch 32/50
533/533 - 11s - loss: 9.1289 - accuracy10: 0.6740 - accuracy20: 0.6554 - accuracy30: 0.6333 - accuracy50: 0.6051 - val_loss: 10.9383 - val_accuracy10: 0.5478 - val_accuracy20: 0.5239 - val_accuracy30: 0.4970 - val_accuracy50: 0.4742 - 11s/epoch - 20ms/step
Epoch 33/50
533/533 - 12s - loss: 9.0993 - accuracy10: 0.6748 - accuracy20: 0.6566 - accuracy30: 0.6352 - accuracy50: 0.6071 - val_loss: 11.0935 - val_accuracy10: 0.5404 - val_accuracy20: 0.5173 - val_accuracy30: 0.4946 - val_accuracy50: 0.4729 - 12s/epoch - 22ms/step
Epoch 34/50
533/533 - 11s - loss: 9.0910 - accuracy10: 0.6747 - accuracy20: 0.6572 - accuracy30: 0.6359 - accuracy50: 0.6064 - val_loss: 11.0076 - val_accuracy10: 0.5521 - val_accuracy20: 0.5253 - val_accuracy30: 0.4989 - val_accuracy50: 0.4734 - 11s/epoch - 21ms/step
testing model: results/QRTEA/W6/deepLOB_L1/seq2seq
Evaluating performance on  test set...
2185/2185 - 21s - 21s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9266103
{'0': {'precision': 0.23959666031709928, 'recall': 0.7556452215497272, 'f1-score': 0.3638312952189759, 'support': 66915}, '1': {'precision': 0.8964950928141112, 'recall': 0.5350580806295799, 'f1-score': 0.6701489718346437, 'support': 424410}, '2': {'precision': 0.3576105868086677, 'recall': 0.4998378776713338, 'f1-score': 0.4169284199526692, 'support': 67850}, 'accuracy': 0.5571815621227701, 'macro avg': {'precision': 0.49790077997995935, 'recall': 0.5968470599502136, 'f1-score': 0.4836362290020963, 'support': 559175}, 'weighted avg': {'precision': 0.7524978247978249, 'recall': 0.5571815621227701, 'f1-score': 0.6027670935748335, 'support': 559175}}
[[ 50564   9647   6704]
 [143109 227084  54217]
 [ 17365  16571  33914]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.97239596
{'0': {'precision': 0.2858561788186982, 'recall': 0.7632716737240918, 'f1-score': 0.41593772107470006, 'support': 89740}, '1': {'precision': 0.8505644107532867, 'recall': 0.47599085567059296, 'f1-score': 0.6103942925330692, 'support': 378814}, '2': {'precision': 0.41148307566446957, 'recall': 0.4884298341444036, 'f1-score': 0.44666680121904456, 'support': 90621}, 'accuracy': 0.5241114141368981, 'macro avg': {'precision': 0.5159678884121515, 'recall': 0.5758974545130294, 'f1-score': 0.4909996049422712, 'support': 559175}, 'weighted avg': {'precision': 0.6887780175831814, 'recall': 0.5241114141368981, 'f1-score': 0.5526526522361276, 'support': 559175}}
[[ 68496  11366   9878]
 [145075 180312  53427]
 [ 26046  20313  44262]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.009306
{'0': {'precision': 0.3144595370193227, 'recall': 0.7644169953121512, 'f1-score': 0.44560838470756, 'support': 107512}, '1': {'precision': 0.8082184910475957, 'recall': 0.4226388042999974, 'f1-score': 0.5550350929561509, 'support': 343163}, '2': {'precision': 0.4349445833614922, 'recall': 0.4745345622119816, 'f1-score': 0.4538778892434634, 'support': 108500}, 'accuracy': 0.4984217820896857, 'macro avg': {'precision': 0.5192075371428035, 'recall': 0.5538634539413768, 'f1-score': 0.4848404556357248, 'support': 559175}, 'weighted avg': {'precision': 0.640855444328, 'recall': 0.4984217820896857, 'f1-score': 0.5143676080720823, 'support': 559175}}
[[ 82184  12413  12915]
 [144155 145034  53974]
 [ 35011  22002  51487]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0377077
{'0': {'precision': 0.3580936589323266, 'recall': 0.744778947056821, 'f1-score': 0.4836471897099001, 'support': 135126}, '1': {'precision': 0.7232522857564814, 'recall': 0.37568606118933545, 'f1-score': 0.4945059988800866, 'support': 286782}, '2': {'precision': 0.46424811098724145, 'recall': 0.4368566370649901, 'f1-score': 0.450136055698388, 'support': 137267}, 'accuracy': 0.4798944874144946, 'macro avg': {'precision': 0.5151980185586831, 'recall': 0.5191072151037156, 'f1-score': 0.4760964147627916, 'support': 559175}, 'weighted avg': {'precision': 0.5714301358637107, 'recall': 0.4798944874144946, 'f1-score': 0.48098995034670644, 'support': 559175}}
[[100639  15467  19020]
 [128860 107740  50182]
 [ 51542  25759  59966]]
Evaluating performance on  train set...
533/533 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.96244425
{'0': {'precision': 0.23127785668805406, 'recall': 0.6999184762469428, 'f1-score': 0.34767242807443816, 'support': 13493}, '1': {'precision': 0.938377389802381, 'recall': 0.5071523360636984, 'f1-score': 0.6584441355054124, 'support': 109265}, '2': {'precision': 0.25286503421551654, 'recall': 0.6807487422314294, 'f1-score': 0.3687553854477687, 'support': 13516}, 'accuracy': 0.5434565654490219, 'macro avg': {'precision': 0.4741734269019839, 'recall': 0.629273184847357, 'f1-score': 0.45829064967587313, 'support': 136274}, 'weighted avg': {'precision': 0.8003739628946532, 'recall': 0.5434565654490219, 'f1-score': 0.5989413998834651, 'support': 136274}}
[[ 9444  1931  2118]
 [28783 55414 25068]
 [ 2607  1708  9201]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.99535656
{'0': {'precision': 0.27636998856994976, 'recall': 0.706761526582837, 'f1-score': 0.39735818049332566, 'support': 18132}, '1': {'precision': 0.9056708217155979, 'recall': 0.4416704993101242, 'f1-score': 0.5937739424976813, 'support': 100018}, '2': {'precision': 0.29888886187361713, 'recall': 0.6782719046568086, 'f1-score': 0.4149325772534723, 'support': 18124}, 'accuracy': 0.5084095278629819, 'macro avg': {'precision': 0.493643224053055, 'recall': 0.6089013101832567, 'f1-score': 0.4686882334148265, 'support': 136274}, 'weighted avg': {'precision': 0.7412388761737267, 'recall': 0.5084095278629819, 'f1-score': 0.5438544310696098, 'support': 136274}}
[[12815  2449  2868]
 [29875 44175 25968]
 [ 3679  2152 12293]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0259826
{'0': {'precision': 0.30250688759061334, 'recall': 0.7113255226280726, 'f1-score': 0.4244900197411713, 'support': 21765}, '1': {'precision': 0.8754208754208754, 'recall': 0.37822053166384706, 'f1-score': 0.5282246534936569, 'support': 92803}, '2': {'precision': 0.3238666666666667, 'recall': 0.6714272551368285, 'f1-score': 0.43696219230653915, 'support': 21706}, 'accuracy': 0.47812495413651906, 'macro avg': {'precision': 0.5005981432260519, 'recall': 0.5869911031429161, 'f1-score': 0.46322562184712246, 'support': 136274}, 'weighted avg': {'precision': 0.6960652492534148, 'recall': 0.47812495413651906, 'f1-score': 0.49712020740599216, 'support': 136274}}
[[15482  2645  3638]
 [30915 35100 26788]
 [ 4782  2350 14574]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0416662
{'0': {'precision': 0.34382319809752, 'recall': 0.6932617081876195, 'f1-score': 0.45967202141900937, 'support': 27737}, '1': {'precision': 0.8104691420766763, 'recall': 0.3147481126955149, 'f1-score': 0.4534122308997699, 'support': 81068}, '2': {'precision': 0.362475442043222, 'recall': 0.6447995922676472, 'f1-score': 0.4640718955104608, 'support': 27469}, 'accuracy': 0.45831926853251537, 'macro avg': {'precision': 0.5055892607391393, 'recall': 0.5509364710502606, 'f1-score': 0.45905204927641335, 'support': 136274}, 'weighted avg': {'precision': 0.6251858342236095, 'recall': 0.45831926853251537, 'f1-score': 0.45683502715454494, 'support': 136274}}
[[19229  3148  5360]
 [29760 25516 25792]
 [ 6938  2819 17712]]
Evaluating performance on  val set...
189/189 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.021882
{'0': {'precision': 0.24006163328197228, 'recall': 0.6569681636095298, 'f1-score': 0.35163347063138295, 'support': 4743}, '1': {'precision': 0.939347555725629, 'recall': 0.5033835742848355, 'f1-score': 0.6554958443205715, 'support': 39012}, '2': {'precision': 0.21786811958647667, 'recall': 0.701371711266022, 'f1-score': 0.33246282577412994, 'support': 4447}, 'accuracy': 0.5367619600846438, 'macro avg': {'precision': 0.46575910286469263, 'recall': 0.6205744830534624, 'f1-score': 0.4465307135753615, 'support': 48202}, 'weighted avg': {'precision': 0.8039769863994376, 'recall': 0.5367619600846438, 'f1-score': 0.5957940254772902, 'support': 48202}}
[[ 3116   634   993]
 [ 9170 19638 10204]
 [  694   634  3119]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0498692
{'0': {'precision': 0.28405519879764995, 'recall': 0.6550094517958412, 'f1-score': 0.3962641761174116, 'support': 6348}, '1': {'precision': 0.9068605683836589, 'recall': 0.4561011697049217, 'f1-score': 0.606943180340658, 'support': 35821}, '2': {'precision': 0.26820169796758425, 'recall': 0.6911984087518648, 'f1-score': 0.386451044900607, 'support': 6033}, 'accuracy': 0.511721505331729, 'macro avg': {'precision': 0.4863724883829644, 'recall': 0.6007696767508759, 'f1-score': 0.4632194671195588, 'support': 48202}, 'weighted avg': {'precision': 0.7449046858196124, 'recall': 0.511721505331729, 'f1-score': 0.5516006764628315, 'support': 48202}}
[[ 4158   836  1354]
 [ 9459 16338 10024]
 [ 1021   842  4170]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.072653
{'0': {'precision': 0.3078957077850203, 'recall': 0.6531437516305766, 'f1-score': 0.41850551654964896, 'support': 7666}, '1': {'precision': 0.8772304111714507, 'recall': 0.40796752856283824, 'f1-score': 0.5569282548021671, 'support': 33260}, '2': {'precision': 0.29668528411850414, 'recall': 0.6716602528862012, 'f1-score': 0.41157150075795856, 'support': 7276}, 'accuracy': 0.48676403468735735, 'macro avg': {'precision': 0.49393713435832504, 'recall': 0.5775905110265387, 'f1-score': 0.4623350907032582, 'support': 48202}, 'weighted avg': {'precision': 0.6990517841311285, 'recall': 0.48676403468735735, 'f1-score': 0.5129723099478153, 'support': 48202}}
[[ 5007   960  1699]
 [ 9805 13569  9886]
 [ 1450   939  4887]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0777977
{'0': {'precision': 0.3511287883031763, 'recall': 0.6366036969327645, 'f1-score': 0.4526121962667437, 'support': 9846}, '1': {'precision': 0.8190143577803648, 'recall': 0.36230988429979055, 'f1-score': 0.5023802723031515, 'support': 29127}, '2': {'precision': 0.33304706286499486, 'recall': 0.6302958066962835, 'f1-score': 0.435811949803334, 'support': 9229}, 'accuracy': 0.4696485623003195, 'macro avg': {'precision': 0.5010634029828454, 'recall': 0.5430697959762796, 'f1-score': 0.4636014727910764, 'support': 48202}, 'weighted avg': {'precision': 0.6303957634928591, 'recall': 0.4696485623003195, 'f1-score': 0.4794688676932747, 'support': 48202}}
[[ 6268  1158  2420]
 [ 9345 10553  9229]
 [ 2238  1174  5817]]
training model: results/QRTEA/W6/deepOF_L1/seq2seq
Epoch 1/50
533/533 - 17s - loss: 12.3710 - accuracy10: 0.4186 - accuracy20: 0.4254 - accuracy30: 0.4244 - accuracy50: 0.4254 - val_loss: 12.0164 - val_accuracy10: 0.5192 - val_accuracy20: 0.4946 - val_accuracy30: 0.4666 - val_accuracy50: 0.4409 - 17s/epoch - 31ms/step
Epoch 2/50
533/533 - 11s - loss: 12.0158 - accuracy10: 0.4219 - accuracy20: 0.4270 - accuracy30: 0.4270 - accuracy50: 0.4309 - val_loss: 11.8745 - val_accuracy10: 0.5892 - val_accuracy20: 0.5743 - val_accuracy30: 0.5568 - val_accuracy50: 0.5230 - 11s/epoch - 20ms/step
Epoch 3/50
533/533 - 11s - loss: 11.8010 - accuracy10: 0.4563 - accuracy20: 0.4541 - accuracy30: 0.4504 - accuracy50: 0.4496 - val_loss: 11.7507 - val_accuracy10: 0.6020 - val_accuracy20: 0.5804 - val_accuracy30: 0.5625 - val_accuracy50: 0.5273 - 11s/epoch - 20ms/step
Epoch 4/50
533/533 - 11s - loss: 11.6576 - accuracy10: 0.4822 - accuracy20: 0.4749 - accuracy30: 0.4690 - accuracy50: 0.4668 - val_loss: 11.6896 - val_accuracy10: 0.6506 - val_accuracy20: 0.6179 - val_accuracy30: 0.5858 - val_accuracy50: 0.5397 - 11s/epoch - 20ms/step
Epoch 5/50
533/533 - 10s - loss: 11.5409 - accuracy10: 0.4997 - accuracy20: 0.4910 - accuracy30: 0.4839 - accuracy50: 0.4783 - val_loss: 11.6002 - val_accuracy10: 0.6492 - val_accuracy20: 0.6195 - val_accuracy30: 0.5933 - val_accuracy50: 0.5499 - 10s/epoch - 19ms/step
Epoch 6/50
533/533 - 10s - loss: 11.4506 - accuracy10: 0.5077 - accuracy20: 0.4966 - accuracy30: 0.4891 - accuracy50: 0.4838 - val_loss: 11.4864 - val_accuracy10: 0.6488 - val_accuracy20: 0.6159 - val_accuracy30: 0.5855 - val_accuracy50: 0.5446 - 10s/epoch - 19ms/step
Epoch 7/50
533/533 - 10s - loss: 11.3470 - accuracy10: 0.5254 - accuracy20: 0.5105 - accuracy30: 0.5004 - accuracy50: 0.4927 - val_loss: 11.3871 - val_accuracy10: 0.6226 - val_accuracy20: 0.5884 - val_accuracy30: 0.5607 - val_accuracy50: 0.5255 - 10s/epoch - 19ms/step
Epoch 8/50
533/533 - 10s - loss: 11.2247 - accuracy10: 0.5436 - accuracy20: 0.5285 - accuracy30: 0.5174 - accuracy50: 0.5084 - val_loss: 11.2935 - val_accuracy10: 0.5952 - val_accuracy20: 0.5556 - val_accuracy30: 0.5254 - val_accuracy50: 0.4992 - 10s/epoch - 19ms/step
Epoch 9/50
533/533 - 10s - loss: 11.1454 - accuracy10: 0.5443 - accuracy20: 0.5291 - accuracy30: 0.5184 - accuracy50: 0.5116 - val_loss: 11.1528 - val_accuracy10: 0.5681 - val_accuracy20: 0.5282 - val_accuracy30: 0.5020 - val_accuracy50: 0.4854 - 10s/epoch - 19ms/step
Epoch 10/50
533/533 - 10s - loss: 11.0488 - accuracy10: 0.5532 - accuracy20: 0.5377 - accuracy30: 0.5272 - accuracy50: 0.5206 - val_loss: 11.1115 - val_accuracy10: 0.5880 - val_accuracy20: 0.5457 - val_accuracy30: 0.5157 - val_accuracy50: 0.4981 - 10s/epoch - 19ms/step
Epoch 11/50
533/533 - 11s - loss: 10.9703 - accuracy10: 0.5567 - accuracy20: 0.5403 - accuracy30: 0.5277 - accuracy50: 0.5204 - val_loss: 11.0748 - val_accuracy10: 0.5701 - val_accuracy20: 0.5320 - val_accuracy30: 0.5045 - val_accuracy50: 0.4909 - 11s/epoch - 21ms/step
Epoch 12/50
533/533 - 10s - loss: 10.8965 - accuracy10: 0.5638 - accuracy20: 0.5462 - accuracy30: 0.5340 - accuracy50: 0.5255 - val_loss: 11.0200 - val_accuracy10: 0.5781 - val_accuracy20: 0.5362 - val_accuracy30: 0.5068 - val_accuracy50: 0.4916 - 10s/epoch - 19ms/step
Epoch 13/50
533/533 - 10s - loss: 10.8482 - accuracy10: 0.5625 - accuracy20: 0.5451 - accuracy30: 0.5331 - accuracy50: 0.5244 - val_loss: 11.0635 - val_accuracy10: 0.5579 - val_accuracy20: 0.5134 - val_accuracy30: 0.4858 - val_accuracy50: 0.4721 - 10s/epoch - 19ms/step
Epoch 14/50
533/533 - 11s - loss: 10.7724 - accuracy10: 0.5668 - accuracy20: 0.5488 - accuracy30: 0.5361 - accuracy50: 0.5267 - val_loss: 11.1086 - val_accuracy10: 0.5594 - val_accuracy20: 0.5138 - val_accuracy30: 0.4843 - val_accuracy50: 0.4730 - 11s/epoch - 20ms/step
Epoch 15/50
533/533 - 10s - loss: 10.7150 - accuracy10: 0.5739 - accuracy20: 0.5545 - accuracy30: 0.5419 - accuracy50: 0.5330 - val_loss: 11.0049 - val_accuracy10: 0.5940 - val_accuracy20: 0.5468 - val_accuracy30: 0.5167 - val_accuracy50: 0.5028 - 10s/epoch - 19ms/step
Epoch 16/50
533/533 - 11s - loss: 10.6716 - accuracy10: 0.5755 - accuracy20: 0.5569 - accuracy30: 0.5439 - accuracy50: 0.5343 - val_loss: 10.9685 - val_accuracy10: 0.5976 - val_accuracy20: 0.5510 - val_accuracy30: 0.5230 - val_accuracy50: 0.5078 - 11s/epoch - 20ms/step
Epoch 17/50
533/533 - 10s - loss: 10.6395 - accuracy10: 0.5784 - accuracy20: 0.5590 - accuracy30: 0.5449 - accuracy50: 0.5354 - val_loss: 10.9700 - val_accuracy10: 0.5936 - val_accuracy20: 0.5429 - val_accuracy30: 0.5153 - val_accuracy50: 0.5038 - 10s/epoch - 19ms/step
Epoch 18/50
533/533 - 11s - loss: 10.5592 - accuracy10: 0.5806 - accuracy20: 0.5626 - accuracy30: 0.5506 - accuracy50: 0.5411 - val_loss: 10.9780 - val_accuracy10: 0.5785 - val_accuracy20: 0.5333 - val_accuracy30: 0.5086 - val_accuracy50: 0.4979 - 11s/epoch - 20ms/step
Epoch 19/50
533/533 - 11s - loss: 10.5063 - accuracy10: 0.5793 - accuracy20: 0.5640 - accuracy30: 0.5525 - accuracy50: 0.5449 - val_loss: 11.0092 - val_accuracy10: 0.5743 - val_accuracy20: 0.5294 - val_accuracy30: 0.5095 - val_accuracy50: 0.5024 - 11s/epoch - 20ms/step
Epoch 20/50
533/533 - 10s - loss: 10.4717 - accuracy10: 0.5789 - accuracy20: 0.5642 - accuracy30: 0.5546 - accuracy50: 0.5465 - val_loss: 10.9803 - val_accuracy10: 0.6010 - val_accuracy20: 0.5481 - val_accuracy30: 0.5226 - val_accuracy50: 0.5069 - 10s/epoch - 19ms/step
Epoch 21/50
533/533 - 10s - loss: 10.3892 - accuracy10: 0.5857 - accuracy20: 0.5695 - accuracy30: 0.5595 - accuracy50: 0.5505 - val_loss: 10.9909 - val_accuracy10: 0.5588 - val_accuracy20: 0.5121 - val_accuracy30: 0.4891 - val_accuracy50: 0.4786 - 10s/epoch - 19ms/step
Epoch 22/50
533/533 - 10s - loss: 10.3382 - accuracy10: 0.5866 - accuracy20: 0.5721 - accuracy30: 0.5622 - accuracy50: 0.5528 - val_loss: 10.9710 - val_accuracy10: 0.5850 - val_accuracy20: 0.5429 - val_accuracy30: 0.5221 - val_accuracy50: 0.5080 - 10s/epoch - 19ms/step
Epoch 23/50
533/533 - 10s - loss: 10.2882 - accuracy10: 0.5880 - accuracy20: 0.5748 - accuracy30: 0.5649 - accuracy50: 0.5562 - val_loss: 10.9449 - val_accuracy10: 0.5781 - val_accuracy20: 0.5340 - val_accuracy30: 0.5147 - val_accuracy50: 0.5018 - 10s/epoch - 19ms/step
Epoch 24/50
533/533 - 10s - loss: 10.2605 - accuracy10: 0.5869 - accuracy20: 0.5736 - accuracy30: 0.5634 - accuracy50: 0.5550 - val_loss: 10.9641 - val_accuracy10: 0.5891 - val_accuracy20: 0.5442 - val_accuracy30: 0.5248 - val_accuracy50: 0.5126 - 10s/epoch - 19ms/step
Epoch 25/50
533/533 - 10s - loss: 10.2226 - accuracy10: 0.5874 - accuracy20: 0.5773 - accuracy30: 0.5683 - accuracy50: 0.5594 - val_loss: 10.8958 - val_accuracy10: 0.5685 - val_accuracy20: 0.5287 - val_accuracy30: 0.5134 - val_accuracy50: 0.5036 - 10s/epoch - 19ms/step
Epoch 26/50
533/533 - 10s - loss: 10.1712 - accuracy10: 0.5889 - accuracy20: 0.5780 - accuracy30: 0.5684 - accuracy50: 0.5604 - val_loss: 10.9259 - val_accuracy10: 0.5704 - val_accuracy20: 0.5324 - val_accuracy30: 0.5142 - val_accuracy50: 0.5028 - 10s/epoch - 19ms/step
Epoch 27/50
533/533 - 10s - loss: 10.1157 - accuracy10: 0.5918 - accuracy20: 0.5815 - accuracy30: 0.5727 - accuracy50: 0.5638 - val_loss: 11.0084 - val_accuracy10: 0.5568 - val_accuracy20: 0.5229 - val_accuracy30: 0.5044 - val_accuracy50: 0.4955 - 10s/epoch - 19ms/step
Epoch 28/50
533/533 - 10s - loss: 10.0822 - accuracy10: 0.5904 - accuracy20: 0.5802 - accuracy30: 0.5714 - accuracy50: 0.5636 - val_loss: 10.9809 - val_accuracy10: 0.5642 - val_accuracy20: 0.5255 - val_accuracy30: 0.5072 - val_accuracy50: 0.4961 - 10s/epoch - 19ms/step
Epoch 29/50
533/533 - 11s - loss: 10.0274 - accuracy10: 0.5919 - accuracy20: 0.5835 - accuracy30: 0.5753 - accuracy50: 0.5675 - val_loss: 11.0741 - val_accuracy10: 0.5533 - val_accuracy20: 0.5169 - val_accuracy30: 0.4979 - val_accuracy50: 0.4899 - 11s/epoch - 20ms/step
Epoch 30/50
533/533 - 10s - loss: 10.0091 - accuracy10: 0.5959 - accuracy20: 0.5868 - accuracy30: 0.5771 - accuracy50: 0.5693 - val_loss: 11.0784 - val_accuracy10: 0.5580 - val_accuracy20: 0.5240 - val_accuracy30: 0.5023 - val_accuracy50: 0.4907 - 10s/epoch - 19ms/step
Epoch 31/50
533/533 - 10s - loss: 9.9778 - accuracy10: 0.5941 - accuracy20: 0.5861 - accuracy30: 0.5773 - accuracy50: 0.5696 - val_loss: 11.0041 - val_accuracy10: 0.5447 - val_accuracy20: 0.5191 - val_accuracy30: 0.5033 - val_accuracy50: 0.4976 - 10s/epoch - 19ms/step
Epoch 32/50
533/533 - 11s - loss: 9.8977 - accuracy10: 0.6020 - accuracy20: 0.5934 - accuracy30: 0.5844 - accuracy50: 0.5751 - val_loss: 11.1181 - val_accuracy10: 0.5523 - val_accuracy20: 0.5230 - val_accuracy30: 0.5040 - val_accuracy50: 0.4924 - 11s/epoch - 20ms/step
Epoch 33/50
533/533 - 11s - loss: 9.8611 - accuracy10: 0.5999 - accuracy20: 0.5916 - accuracy30: 0.5829 - accuracy50: 0.5756 - val_loss: 11.1924 - val_accuracy10: 0.5368 - val_accuracy20: 0.5112 - val_accuracy30: 0.4964 - val_accuracy50: 0.4864 - 11s/epoch - 20ms/step
Epoch 34/50
533/533 - 11s - loss: 9.8107 - accuracy10: 0.6031 - accuracy20: 0.5967 - accuracy30: 0.5871 - accuracy50: 0.5785 - val_loss: 11.1834 - val_accuracy10: 0.5397 - val_accuracy20: 0.5136 - val_accuracy30: 0.4957 - val_accuracy50: 0.4862 - 11s/epoch - 20ms/step
Epoch 35/50
533/533 - 11s - loss: 9.7697 - accuracy10: 0.6035 - accuracy20: 0.5971 - accuracy30: 0.5891 - accuracy50: 0.5813 - val_loss: 11.3601 - val_accuracy10: 0.5362 - val_accuracy20: 0.5060 - val_accuracy30: 0.4872 - val_accuracy50: 0.4758 - 11s/epoch - 21ms/step
testing model: results/QRTEA/W6/deepOF_L1/seq2seq
Evaluating performance on  test set...
2185/2185 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0275788
{'0': {'precision': 0.22687639122895478, 'recall': 0.5513943270466569, 'f1-score': 0.32147773808486535, 'support': 66914}, '1': {'precision': 0.8635538450366713, 'recall': 0.4483222551830899, 'f1-score': 0.5902240420631413, 'support': 424409}, '2': {'precision': 0.23045491691637157, 'recall': 0.5985231476704939, 'f1-score': 0.3327774477064597, 'support': 67847}, 'accuracy': 0.4788811989198276, 'macro avg': {'precision': 0.44029505106066597, 'recall': 0.5327465766334135, 'f1-score': 0.4148264092848221, 'support': 559170}, 'weighted avg': {'precision': 0.7105476070048249, 'recall': 0.4788811989198276, 'f1-score': 0.5268267402198374, 'support': 559170}}
[[ 36896  16415  13603]
 [112140 190272 121997]
 [ 13590  13649  40608]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0632858
{'0': {'precision': 0.27216728634338, 'recall': 0.5750852481668858, 'f1-score': 0.36947518014841435, 'support': 89738}, '1': {'precision': 0.8147919840202, 'recall': 0.3628852154355436, 'f1-score': 0.5021341413300167, 'support': 378814}, '2': {'precision': 0.27508190517919556, 'recall': 0.6096801959875522, 'f1-score': 0.37911205654292185, 'support': 90618}, 'accuracy': 0.43693510023785254, 'macro avg': {'precision': 0.45401372518092514, 'recall': 0.5158835531966605, 'f1-score': 0.4169071260071176, 'support': 559170}, 'weighted avg': {'precision': 0.6402448819858694, 'recall': 0.43693510023785254, 'f1-score': 0.46090774302940757, 'support': 559170}}
[[ 51607  17093  21038]
 [116792 137466 124556]
 [ 21216  14154  55248]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0757387
{'0': {'precision': 0.30502901737080834, 'recall': 0.5729699562831364, 'f1-score': 0.3981154146927855, 'support': 107510}, '1': {'precision': 0.7582596463022508, 'recall': 0.3298519945332102, 'f1-score': 0.4597202112731829, 'support': 343163}, '2': {'precision': 0.3093122120591319, 'recall': 0.5928182346055652, 'f1-score': 0.40651752786477013, 'support': 108497}, 'accuracy': 0.4276195074843071, 'macro avg': {'precision': 0.45753362524406366, 'recall': 0.49854672847397064, 'f1-score': 0.4214510512769129, 'support': 559170}, 'weighted avg': {'precision': 0.5840080328582266, 'recall': 0.4276195074843071, 'f1-score': 0.4375525999526165, 'support': 559170}}
[[ 61600  19507  26403]
 [112750 113193 117220]
 [ 27598  16580  64319]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0728467
{'0': {'precision': 0.3537544696066746, 'recall': 0.5491293118122007, 'f1-score': 0.4303033290515639, 'support': 135123}, '1': {'precision': 0.6487310231261466, 'recall': 0.3132065471333626, 'f1-score': 0.42245320289718746, 'support': 286782}, '2': {'precision': 0.36129729524748533, 'recall': 0.5552762903872073, 'f1-score': 0.43776042638853396, 'support': 137265}, 'accuracy': 0.4296403598190175, 'macro avg': {'precision': 0.4545942626601022, 'recall': 0.4725373831109236, 'f1-score': 0.4301723194457618, 'support': 559170}, 'weighted avg': {'precision': 0.50689096107261, 'recall': 0.4296403598190175, 'f1-score': 0.4281077956487612, 'support': 559170}}
[[74200 25800 35123]
 [97341 89822 99619]
 [38209 22836 76220]]
Evaluating performance on  train set...
533/533 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9540732
{'0': {'precision': 0.23687195191108087, 'recall': 0.6183567727609178, 'f1-score': 0.3425314691049244, 'support': 13510}, '1': {'precision': 0.9221485106243227, 'recall': 0.5139193938062816, 'f1-score': 0.6600105776576365, 'support': 109272}, '2': {'precision': 0.22131903752649296, 'recall': 0.6580176440062273, 'f1-score': 0.3312311079598463, 'support': 13489}, 'accuracy': 0.5385371795906686, 'macro avg': {'precision': 0.46011316668729885, 'recall': 0.5967646035244756, 'f1-score': 0.44459105157413575, 'support': 136271}, 'weighted avg': {'precision': 0.7848370131609408, 'recall': 0.5385371795906686, 'f1-score': 0.5959907273351128, 'support': 136271}}
[[ 8354  2547  2609]
 [24495 56157 28620]
 [ 2419  2194  8876]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9852876
{'0': {'precision': 0.28216414035261245, 'recall': 0.628116915285958, 'f1-score': 0.3894007644007644, 'support': 18167}, '1': {'precision': 0.8889794134011605, 'recall': 0.44740131809226646, 'f1-score': 0.5952354025160163, 'support': 99993}, '2': {'precision': 0.26693183316485736, 'recall': 0.6706973662415107, 'f1-score': 0.38187905748463463, 'support': 18111}, 'accuracy': 0.501170461800383, 'macro avg': {'precision': 0.4793584623062101, 'recall': 0.5820718665399117, 'f1-score': 0.4555050748004718, 'support': 136271}, 'weighted avg': {'precision': 0.7254089047006103, 'recall': 0.501170461800383, 'f1-score': 0.5394385371851452, 'support': 136271}}
[[11411  3113  3643]
 [25540 44737 29716]
 [ 3490  2474 12147]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0029378
{'0': {'precision': 0.31383077638307766, 'recall': 0.6192267119203779, 'f1-score': 0.4165496814402295, 'support': 21803}, '1': {'precision': 0.8502740627055471, 'recall': 0.4180293410656347, 'f1-score': 0.560496021852711, 'support': 92771}, '2': {'precision': 0.3013790642513801, 'recall': 0.6617504724155413, 'f1-score': 0.4141452017652658, 'support': 21697}, 'accuracy': 0.4890255446866905, 'macro avg': {'precision': 0.4884946344466683, 'recall': 0.5663355084671847, 'f1-score': 0.46373030168606877, 'support': 136271}, 'weighted avg': {'precision': 0.6770497688121371, 'recall': 0.4890255446866905, 'f1-score': 0.5141630837848121, 'support': 136271}}
[[13501  3878  4424]
 [25131 38781 28859]
 [ 4388  2951 14358]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.006798
{'0': {'precision': 0.3651467107319905, 'recall': 0.58775744940872, 'f1-score': 0.45044970593501643, 'support': 27821}, '1': {'precision': 0.769545784288489, 'recall': 0.40588743520118487, 'f1-score': 0.5314618635507825, 'support': 81020}, '2': {'precision': 0.3505414718188531, 'recall': 0.6230769230769231, 'f1-score': 0.4486651090751582, 'support': 27430}, 'accuracy': 0.4867359893154083, 'macro avg': {'precision': 0.4950779889464442, 'recall': 0.5389072692289426, 'f1-score': 0.47685889285365235, 'support': 136271}, 'weighted avg': {'precision': 0.6026425186159875, 'recall': 0.4867359893154083, 'f1-score': 0.498256308353458, 'support': 136271}}
[[16352  5530  5939]
 [22409 32885 25726]
 [ 6021  4318 17091]]
Evaluating performance on  val set...
189/189 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.91160226
{'0': {'precision': 0.24149747280047973, 'recall': 0.5914813260595888, 'f1-score': 0.34296490054139545, 'support': 4766}, '1': {'precision': 0.919704641350211, 'recall': 0.5593420411096, 'f1-score': 0.695623035312515, 'support': 38969}, '2': {'precision': 0.21671343935141876, 'recall': 0.6224809673085535, 'f1-score': 0.32149878570602525, 'support': 4466}, 'accuracy': 0.5683699508308956, 'macro avg': {'precision': 0.4593051845007032, 'recall': 0.5911014448259141, 'f1-score': 0.4533622405199786, 'support': 48201}, 'weighted avg': {'precision': 0.7875104114911909, 'recall': 0.5683699508308956, 'f1-score': 0.6260890511822742, 'support': 48201}}
[[ 2819   995   952]
 [ 8076 21797  9096]
 [  778   908  2780]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.95221704
{'0': {'precision': 0.2861407567728935, 'recall': 0.602072864321608, 'f1-score': 0.3879192593716801, 'support': 6368}, '1': {'precision': 0.8850591863125435, 'recall': 0.49751174233952133, 'f1-score': 0.6369688942978845, 'support': 35768}, '2': {'precision': 0.2583696243875885, 'recall': 0.6260511129431162, 'f1-score': 0.36578199508694187, 'support': 6065}, 'accuracy': 0.5274994294724176, 'macro avg': {'precision': 0.4765231891576751, 'recall': 0.5752119065347485, 'f1-score': 0.4635567162521688, 'support': 48201}, 'weighted avg': {'precision': 0.7270793777529007, 'recall': 0.5274994294724176, 'f1-score': 0.5699433840610754, 'support': 48201}}
[[ 3834  1210  1324]
 [ 8398 17795  9575]
 [ 1167  1101  3797]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9774118
{'0': {'precision': 0.3182872811643113, 'recall': 0.588457038866502, 'f1-score': 0.41312283263369226, 'support': 7693}, '1': {'precision': 0.8465451003733564, 'recall': 0.47089453407175536, 'f1-score': 0.6051639106469393, 'support': 33224}, '2': {'precision': 0.2897334968058334, 'recall': 0.6164195496979682, 'f1-score': 0.3941881392388394, 'support': 7284}, 'accuracy': 0.5116491359100434, 'macro avg': {'precision': 0.48485529278116707, 'recall': 0.5585903742120752, 'f1-score': 0.4708249608398236, 'support': 48201}, 'weighted avg': {'precision': 0.6780900242637109, 'recall': 0.5116491359100434, 'f1-score': 0.5426316077467399, 'support': 48201}}
[[ 4527  1524  1642]
 [ 8214 15645  9365]
 [ 1482  1312  4490]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9902165
{'0': {'precision': 0.37039287160793843, 'recall': 0.5564344386979008, 'f1-score': 0.444741641337386, 'support': 9861}, '1': {'precision': 0.7744529320544483, 'recall': 0.4633836214302897, 'f1-score': 0.5798322941302946, 'support': 29099}, '2': {'precision': 0.3316224336504757, 'recall': 0.5733145763445514, 'f1-score': 0.4201927271285244, 'support': 9241}, 'accuracy': 0.5034957780958901, 'macro avg': {'precision': 0.49215607910428744, 'recall': 0.5310442121575806, 'f1-score': 0.48158888753206835, 'support': 48201}, 'weighted avg': {'precision': 0.6068914106790796, 'recall': 0.5034957780958901, 'f1-score': 0.5215895571361611, 'support': 48201}}
[[ 5487  2134  2240]
 [ 7177 13484  8438]
 [ 2150  1793  5298]]
training model: results/QRTEA/W6/deepLOB_L2/seq2seq
Epoch 1/50
533/533 - 31s - loss: 11.9166 - accuracy10: 0.4299 - accuracy20: 0.4388 - accuracy30: 0.4470 - accuracy50: 0.4575 - val_loss: 12.0518 - val_accuracy10: 0.3236 - val_accuracy20: 0.3420 - val_accuracy30: 0.3544 - val_accuracy50: 0.3737 - 31s/epoch - 59ms/step
Epoch 2/50
533/533 - 25s - loss: 11.3274 - accuracy10: 0.4721 - accuracy20: 0.4857 - accuracy30: 0.4958 - accuracy50: 0.5027 - val_loss: 11.9321 - val_accuracy10: 0.3885 - val_accuracy20: 0.3802 - val_accuracy30: 0.3775 - val_accuracy50: 0.3818 - 25s/epoch - 47ms/step
Epoch 3/50
533/533 - 25s - loss: 10.9676 - accuracy10: 0.5228 - accuracy20: 0.5269 - accuracy30: 0.5289 - accuracy50: 0.5285 - val_loss: 11.9251 - val_accuracy10: 0.4649 - val_accuracy20: 0.4584 - val_accuracy30: 0.4536 - val_accuracy50: 0.4487 - 25s/epoch - 46ms/step
Epoch 4/50
533/533 - 25s - loss: 10.6661 - accuracy10: 0.5566 - accuracy20: 0.5555 - accuracy30: 0.5520 - accuracy50: 0.5459 - val_loss: 11.6113 - val_accuracy10: 0.5042 - val_accuracy20: 0.4889 - val_accuracy30: 0.4745 - val_accuracy50: 0.4619 - 25s/epoch - 46ms/step
Epoch 5/50
533/533 - 25s - loss: 10.4363 - accuracy10: 0.5835 - accuracy20: 0.5796 - accuracy30: 0.5711 - accuracy50: 0.5589 - val_loss: 11.4377 - val_accuracy10: 0.5291 - val_accuracy20: 0.5096 - val_accuracy30: 0.4926 - val_accuracy50: 0.4780 - 25s/epoch - 47ms/step
Epoch 6/50
533/533 - 25s - loss: 10.2203 - accuracy10: 0.6109 - accuracy20: 0.6010 - accuracy30: 0.5877 - accuracy50: 0.5689 - val_loss: 11.1386 - val_accuracy10: 0.5038 - val_accuracy20: 0.4878 - val_accuracy30: 0.4701 - val_accuracy50: 0.4587 - 25s/epoch - 46ms/step
Epoch 7/50
533/533 - 24s - loss: 10.0294 - accuracy10: 0.6361 - accuracy20: 0.6208 - accuracy30: 0.6023 - accuracy50: 0.5786 - val_loss: 11.0789 - val_accuracy10: 0.5403 - val_accuracy20: 0.5128 - val_accuracy30: 0.4870 - val_accuracy50: 0.4661 - 24s/epoch - 46ms/step
Epoch 8/50
533/533 - 24s - loss: 9.8680 - accuracy10: 0.6539 - accuracy20: 0.6353 - accuracy30: 0.6139 - accuracy50: 0.5873 - val_loss: 11.2637 - val_accuracy10: 0.5457 - val_accuracy20: 0.5237 - val_accuracy30: 0.5011 - val_accuracy50: 0.4794 - 24s/epoch - 46ms/step
Epoch 9/50
533/533 - 24s - loss: 9.7364 - accuracy10: 0.6647 - accuracy20: 0.6451 - accuracy30: 0.6227 - accuracy50: 0.5956 - val_loss: 11.1256 - val_accuracy10: 0.5546 - val_accuracy20: 0.5313 - val_accuracy30: 0.5057 - val_accuracy50: 0.4831 - 24s/epoch - 46ms/step
Epoch 10/50
533/533 - 24s - loss: 9.5684 - accuracy10: 0.6754 - accuracy20: 0.6537 - accuracy30: 0.6308 - accuracy50: 0.6028 - val_loss: 11.6876 - val_accuracy10: 0.5422 - val_accuracy20: 0.5189 - val_accuracy30: 0.4947 - val_accuracy50: 0.4745 - 24s/epoch - 46ms/step
Epoch 11/50
533/533 - 24s - loss: 9.4552 - accuracy10: 0.6835 - accuracy20: 0.6590 - accuracy30: 0.6337 - accuracy50: 0.6038 - val_loss: 11.9559 - val_accuracy10: 0.5836 - val_accuracy20: 0.5571 - val_accuracy30: 0.5325 - val_accuracy50: 0.5052 - 24s/epoch - 46ms/step
Epoch 12/50
533/533 - 24s - loss: 9.3562 - accuracy10: 0.6860 - accuracy20: 0.6622 - accuracy30: 0.6378 - accuracy50: 0.6084 - val_loss: 11.6857 - val_accuracy10: 0.5945 - val_accuracy20: 0.5670 - val_accuracy30: 0.5384 - val_accuracy50: 0.5100 - 24s/epoch - 46ms/step
Epoch 13/50
533/533 - 24s - loss: 9.2731 - accuracy10: 0.6883 - accuracy20: 0.6645 - accuracy30: 0.6401 - accuracy50: 0.6114 - val_loss: 11.5322 - val_accuracy10: 0.6040 - val_accuracy20: 0.5841 - val_accuracy30: 0.5616 - val_accuracy50: 0.5348 - 24s/epoch - 46ms/step
Epoch 14/50
533/533 - 24s - loss: 9.1659 - accuracy10: 0.6907 - accuracy20: 0.6669 - accuracy30: 0.6416 - accuracy50: 0.6131 - val_loss: 12.3479 - val_accuracy10: 0.6139 - val_accuracy20: 0.5884 - val_accuracy30: 0.5623 - val_accuracy50: 0.5346 - 24s/epoch - 46ms/step
Epoch 15/50
533/533 - 24s - loss: 9.0756 - accuracy10: 0.6917 - accuracy20: 0.6688 - accuracy30: 0.6446 - accuracy50: 0.6167 - val_loss: 12.2372 - val_accuracy10: 0.6151 - val_accuracy20: 0.5895 - val_accuracy30: 0.5653 - val_accuracy50: 0.5379 - 24s/epoch - 45ms/step
Epoch 16/50
533/533 - 25s - loss: 8.9732 - accuracy10: 0.6938 - accuracy20: 0.6712 - accuracy30: 0.6475 - accuracy50: 0.6204 - val_loss: 11.6471 - val_accuracy10: 0.6221 - val_accuracy20: 0.6003 - val_accuracy30: 0.5757 - val_accuracy50: 0.5441 - 25s/epoch - 46ms/step
Epoch 17/50
533/533 - 25s - loss: 8.9274 - accuracy10: 0.6932 - accuracy20: 0.6720 - accuracy30: 0.6482 - accuracy50: 0.6213 - val_loss: 12.0040 - val_accuracy10: 0.6117 - val_accuracy20: 0.5853 - val_accuracy30: 0.5575 - val_accuracy50: 0.5289 - 25s/epoch - 46ms/step
testing model: results/QRTEA/W6/deepLOB_L2/seq2seq
Evaluating performance on  test set...
2185/2185 - 34s - 34s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8478575
{'0': {'precision': 0.27956634368695044, 'recall': 0.6709258013898229, 'f1-score': 0.3946761141611319, 'support': 66915}, '1': {'precision': 0.8824499778130811, 'recall': 0.6138309653401193, 'f1-score': 0.7240286314198009, 'support': 424410}, '2': {'precision': 0.3132304001238294, 'recall': 0.4771997052321297, 'f1-score': 0.37820789870223925, 'support': 67850}, 'accuracy': 0.6040845889032951, 'macro avg': {'precision': 0.49174890720795367, 'recall': 0.5873188239873574, 'f1-score': 0.498970881427724, 'support': 559175}, 'weighted avg': {'precision': 0.741235676880876, 'recall': 0.6040845889032951, 'f1-score': 0.6426541772556298, 'support': 559175}}
[[ 44895  14381   7639]
 [100543 260516  63351]
 [ 15150  20322  32378]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8971862
{'0': {'precision': 0.33501308156068704, 'recall': 0.6563628259416091, 'f1-score': 0.443605964753728, 'support': 89740}, '1': {'precision': 0.8317714872065951, 'recall': 0.5649184032269134, 'f1-score': 0.6728523255174149, 'support': 378814}, '2': {'precision': 0.356076589939242, 'recall': 0.49538186513059884, 'f1-score': 0.41433351023327714, 'support': 90621}, 'accuracy': 0.5683247641614879, 'macro avg': {'precision': 0.5076203862355081, 'recall': 0.5722210314330405, 'f1-score': 0.5102639335014733, 'support': 559175}, 'weighted avg': {'precision': 0.6749564532584955, 'recall': 0.5683247641614879, 'f1-score': 0.5941653277532138, 'support': 559175}}
[[ 58902  19037  11801]
 [ 95434 213999  69381]
 [ 21484  24245  44892]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9384999
{'0': {'precision': 0.3658684546615581, 'recall': 0.6395007068978347, 'f1-score': 0.46544720951014107, 'support': 107512}, '1': {'precision': 0.7903895554685778, 'recall': 0.5119637023805014, 'f1-score': 0.6214147516456153, 'support': 343163}, '2': {'precision': 0.3734896896144345, 'recall': 0.5128202764976959, 'f1-score': 0.4322033898305085, 'support': 108500}, 'accuracy': 0.5366513166718827, 'macro avg': {'precision': 0.5099158999148568, 'recall': 0.554761561925344, 'f1-score': 0.5063551169954216, 'support': 559175}, 'weighted avg': {'precision': 0.6278737991576933, 'recall': 0.5366513166718827, 'f1-score': 0.5547132446987594, 'support': 559175}}
[[ 68754  21331  17427]
 [ 91568 175687  75908]
 [ 27598  25261  55641]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9835084
{'0': {'precision': 0.4080317651789304, 'recall': 0.6007874132291343, 'f1-score': 0.4859946241386949, 'support': 135126}, '1': {'precision': 0.7097772376613434, 'recall': 0.46230237602081026, 'f1-score': 0.5599136775111757, 'support': 286782}, '2': {'precision': 0.4027527908478642, 'recall': 0.5088404350645093, 'f1-score': 0.4496235809856095, 'support': 137267}, 'accuracy': 0.5071918451289846, 'macro avg': {'precision': 0.5068539312293794, 'recall': 0.5239767414381513, 'f1-score': 0.49851062754516007, 'support': 559175}, 'weighted avg': {'precision': 0.5614909525888628, 'recall': 0.5071918451289846, 'f1-score': 0.514976803212817, 'support': 559175}}
[[ 81182  25753  28191]
 [ 78816 132580  75386]
 [ 38962  28458  69847]]
Evaluating performance on  train set...
533/533 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.94060546
{'0': {'precision': 0.2251197581781387, 'recall': 0.6513006744237753, 'f1-score': 0.3345897582333905, 'support': 13493}, '1': {'precision': 0.9292736971686499, 'recall': 0.518153113988926, 'f1-score': 0.6653269874845761, 'support': 109265}, '2': {'precision': 0.24468495263273848, 'recall': 0.6573690440958864, 'f1-score': 0.3566267961788553, 'support': 13516}, 'accuracy': 0.5451443415471771, 'macro avg': {'precision': 0.4663594693265091, 'recall': 0.6089409441695292, 'f1-score': 0.45218118063227397, 'support': 136274}, 'weighted avg': {'precision': 0.7916535306662624, 'recall': 0.5451443415471771, 'f1-score': 0.6019617878135136, 'support': 136274}}
[[ 8788  2166  2539]
 [27761 56616 24888]
 [ 2488  2143  8885]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.96323997
{'0': {'precision': 0.27713046536162234, 'recall': 0.6519413192146482, 'f1-score': 0.38893184397979835, 'support': 18132}, '1': {'precision': 0.8937242934854717, 'recall': 0.47143514167449857, 'f1-score': 0.6172656878980475, 'support': 100018}, '2': {'precision': 0.29251101321585904, 'recall': 0.65945707349371, 'f1-score': 0.40526244405262446, 'support': 18124}, 'accuracy': 0.5204587815724203, 'macro avg': {'precision': 0.48778859068765096, 'recall': 0.5942778447942856, 'f1-score': 0.4704866586434901, 'support': 136274}, 'weighted avg': {'precision': 0.7317237006860521, 'recall': 0.5204587815724203, 'f1-score': 0.5586888790469083, 'support': 136274}}
[[11821  2952  3359]
 [27317 47152 25549]
 [ 3517  2655 11952]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9850159
{'0': {'precision': 0.30944454179078323, 'recall': 0.6491155524925338, 'f1-score': 0.4190979071802554, 'support': 21765}, '1': {'precision': 0.8635532950216879, 'recall': 0.422615648201028, 'f1-score': 0.5675010852264505, 'support': 92803}, '2': {'precision': 0.31977168646711357, 'recall': 0.6658988298166406, 'f1-score': 0.4320624149939468, 'support': 21706}, 'accuracy': 0.4975417174222522, 'macro avg': {'precision': 0.49758984109319493, 'recall': 0.5792100101700675, 'f1-score': 0.4728871358002176, 'support': 136274}, 'weighted avg': {'precision': 0.6884391822095871, 'recall': 0.4975417174222522, 'f1-score': 0.522225926749836, 'support': 136274}}
[[14128  3368  4269]
 [27105 39220 26478]
 [ 4423  2829 14454]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0014569
{'0': {'precision': 0.35752799668187474, 'recall': 0.6215524389804232, 'f1-score': 0.45394104559158466, 'support': 27737}, '1': {'precision': 0.7992035812815574, 'recall': 0.3787807766319633, 'f1-score': 0.5139676960415098, 'support': 81068}, '2': {'precision': 0.36065441650548036, 'recall': 0.6516436710473624, 'f1-score': 0.4643260139297805, 'support': 27469}, 'accuracy': 0.48319562058793314, 'macro avg': {'precision': 0.5057953314896375, 'recall': 0.5506589622199164, 'f1-score': 0.477411585187625, 'support': 136274}, 'weighted avg': {'precision': 0.6209064541899958, 'recall': 0.48319562058793314, 'f1-score': 0.49174359922585414, 'support': 136274}}
[[17240  4260  6237]
 [24866 30707 25495]
 [ 6114  3455 17900]]
Evaluating performance on  val set...
189/189 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.95977646
{'0': {'precision': 0.23965947200963109, 'recall': 0.5876027830487034, 'f1-score': 0.3404593207915954, 'support': 4743}, '1': {'precision': 0.9271273662929609, 'recall': 0.517225469086435, 'f1-score': 0.6640121100434383, 'support': 39012}, '2': {'precision': 0.20777905327841178, 'recall': 0.6919271418934113, 'f1-score': 0.3195886996260906, 'support': 4447}, 'accuracy': 0.5402680386705946, 'macro avg': {'precision': 0.45818863052700126, 'recall': 0.5989184646761833, 'f1-score': 0.4413533768203748, 'support': 48202}, 'weighted avg': {'precision': 0.7931162843759962, 'recall': 0.5402680386705946, 'f1-score': 0.6003993598349939, 'support': 48202}}
[[ 2787   845  1111]
 [ 8213 20178 10621]
 [  629   741  3077]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9906537
{'0': {'precision': 0.2884069400630915, 'recall': 0.5760869565217391, 'f1-score': 0.38438091233970995, 'support': 6348}, '1': {'precision': 0.8896178878857862, 'recall': 0.4731582032885737, 'f1-score': 0.6177537222313342, 'support': 35821}, '2': {'precision': 0.25112325440194294, 'recall': 0.6855627382728328, 'f1-score': 0.36759543172021514, 'support': 6033}, 'accuracy': 0.5132982033940501, 'macro avg': {'precision': 0.4763826941169402, 'recall': 0.5782692993610485, 'f1-score': 0.45657668876375307, 'support': 48202}, 'weighted avg': {'precision': 0.7305264555679053, 'recall': 0.5132982033940501, 'f1-score': 0.5557095007499514, 'support': 48202}}
[[ 3657  1113  1578]
 [ 8116 16949 10756]
 [  907   990  4136]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.017352
{'0': {'precision': 0.31632578256726046, 'recall': 0.5628750326115315, 'f1-score': 0.4050312104003379, 'support': 7666}, '1': {'precision': 0.8577732108317214, 'recall': 0.426668671076368, 'f1-score': 0.5698739057103847, 'support': 33260}, '2': {'precision': 0.275850585558084, 'recall': 0.683067619571193, 'f1-score': 0.3929941090420274, 'support': 7276}, 'accuracy': 0.4870337330401228, 'macro avg': {'precision': 0.48331652631902194, 'recall': 0.5575371077530309, 'f1-score': 0.45596640838425, 'support': 48202}, 'weighted avg': {'precision': 0.6838218186370751, 'recall': 0.4870337330401228, 'f1-score': 0.5169578129589265, 'support': 48202}}
[[ 4315  1237  2114]
 [ 8136 14191 10933]
 [ 1190  1116  4970]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0391111
{'0': {'precision': 0.3612316594337673, 'recall': 0.5326020719073735, 'f1-score': 0.43048885605221027, 'support': 9846}, '1': {'precision': 0.7962698299271116, 'recall': 0.38256600405122393, 'f1-score': 0.5168247489622225, 'support': 29127}, '2': {'precision': 0.31263013559494185, 'recall': 0.6670278470040091, 'f1-score': 0.4257261410788382, 'support': 9229}, 'accuracy': 0.46767768972241813, 'macro avg': {'precision': 0.4900438749852736, 'recall': 0.5273986409875354, 'f1-score': 0.4576799153644237, 'support': 48202}, 'weighted avg': {'precision': 0.6148064764216749, 'recall': 0.46767768972241813, 'f1-score': 0.48174711206442294, 'support': 48202}}
[[ 5244  1494  3108]
 [ 7557 11143 10427]
 [ 1716  1357  6156]]
training model: results/QRTEA/W6/deepOF_L2/seq2seq
Epoch 1/50
533/533 - 22s - loss: 11.6531 - accuracy10: 0.4957 - accuracy20: 0.4918 - accuracy30: 0.4827 - accuracy50: 0.4716 - val_loss: 11.0156 - val_accuracy10: 0.6212 - val_accuracy20: 0.5836 - val_accuracy30: 0.5402 - val_accuracy50: 0.4941 - 22s/epoch - 41ms/step
Epoch 2/50
533/533 - 16s - loss: 10.4639 - accuracy10: 0.5826 - accuracy20: 0.5691 - accuracy30: 0.5524 - accuracy50: 0.5351 - val_loss: 10.8566 - val_accuracy10: 0.6539 - val_accuracy20: 0.5976 - val_accuracy30: 0.5454 - val_accuracy50: 0.4931 - 16s/epoch - 29ms/step
Epoch 3/50
533/533 - 15s - loss: 9.9954 - accuracy10: 0.6317 - accuracy20: 0.6154 - accuracy30: 0.5936 - accuracy50: 0.5660 - val_loss: 10.6733 - val_accuracy10: 0.6755 - val_accuracy20: 0.6381 - val_accuracy30: 0.5957 - val_accuracy50: 0.5401 - 15s/epoch - 29ms/step
Epoch 4/50
533/533 - 15s - loss: 9.6915 - accuracy10: 0.6555 - accuracy20: 0.6392 - accuracy30: 0.6158 - accuracy50: 0.5867 - val_loss: 10.2424 - val_accuracy10: 0.6876 - val_accuracy20: 0.6489 - val_accuracy30: 0.6039 - val_accuracy50: 0.5581 - 15s/epoch - 29ms/step
Epoch 5/50
533/533 - 15s - loss: 9.4769 - accuracy10: 0.6646 - accuracy20: 0.6492 - accuracy30: 0.6268 - accuracy50: 0.5992 - val_loss: 10.2122 - val_accuracy10: 0.7052 - val_accuracy20: 0.6686 - val_accuracy30: 0.6316 - val_accuracy50: 0.5898 - 15s/epoch - 28ms/step
Epoch 6/50
533/533 - 15s - loss: 9.3630 - accuracy10: 0.6718 - accuracy20: 0.6546 - accuracy30: 0.6321 - accuracy50: 0.6058 - val_loss: 10.2015 - val_accuracy10: 0.7069 - val_accuracy20: 0.6684 - val_accuracy30: 0.6307 - val_accuracy50: 0.5887 - 15s/epoch - 28ms/step
Epoch 7/50
533/533 - 15s - loss: 9.2465 - accuracy10: 0.6757 - accuracy20: 0.6573 - accuracy30: 0.6337 - accuracy50: 0.6074 - val_loss: 10.0564 - val_accuracy10: 0.6997 - val_accuracy20: 0.6628 - val_accuracy30: 0.6256 - val_accuracy50: 0.5861 - 15s/epoch - 27ms/step
Epoch 8/50
533/533 - 15s - loss: 9.1656 - accuracy10: 0.6779 - accuracy20: 0.6595 - accuracy30: 0.6367 - accuracy50: 0.6109 - val_loss: 10.0653 - val_accuracy10: 0.7064 - val_accuracy20: 0.6671 - val_accuracy30: 0.6278 - val_accuracy50: 0.5866 - 15s/epoch - 27ms/step
Epoch 9/50
533/533 - 14s - loss: 9.0905 - accuracy10: 0.6816 - accuracy20: 0.6630 - accuracy30: 0.6397 - accuracy50: 0.6143 - val_loss: 10.0381 - val_accuracy10: 0.7121 - val_accuracy20: 0.6728 - val_accuracy30: 0.6338 - val_accuracy50: 0.5930 - 14s/epoch - 27ms/step
Epoch 10/50
533/533 - 14s - loss: 9.0362 - accuracy10: 0.6830 - accuracy20: 0.6642 - accuracy30: 0.6407 - accuracy50: 0.6152 - val_loss: 10.0119 - val_accuracy10: 0.7147 - val_accuracy20: 0.6728 - val_accuracy30: 0.6304 - val_accuracy50: 0.5886 - 14s/epoch - 27ms/step
Epoch 11/50
533/533 - 14s - loss: 8.9797 - accuracy10: 0.6838 - accuracy20: 0.6651 - accuracy30: 0.6419 - accuracy50: 0.6171 - val_loss: 10.1080 - val_accuracy10: 0.6978 - val_accuracy20: 0.6565 - val_accuracy30: 0.6169 - val_accuracy50: 0.5785 - 14s/epoch - 27ms/step
Epoch 12/50
533/533 - 15s - loss: 8.9432 - accuracy10: 0.6858 - accuracy20: 0.6658 - accuracy30: 0.6425 - accuracy50: 0.6178 - val_loss: 10.0374 - val_accuracy10: 0.7095 - val_accuracy20: 0.6678 - val_accuracy30: 0.6282 - val_accuracy50: 0.5862 - 15s/epoch - 27ms/step
Epoch 13/50
533/533 - 15s - loss: 8.8814 - accuracy10: 0.6863 - accuracy20: 0.6679 - accuracy30: 0.6454 - accuracy50: 0.6212 - val_loss: 9.9774 - val_accuracy10: 0.7005 - val_accuracy20: 0.6607 - val_accuracy30: 0.6213 - val_accuracy50: 0.5825 - 15s/epoch - 27ms/step
Epoch 14/50
533/533 - 15s - loss: 8.8184 - accuracy10: 0.6886 - accuracy20: 0.6698 - accuracy30: 0.6474 - accuracy50: 0.6229 - val_loss: 10.0891 - val_accuracy10: 0.6914 - val_accuracy20: 0.6522 - val_accuracy30: 0.6152 - val_accuracy50: 0.5750 - 15s/epoch - 27ms/step
Epoch 15/50
533/533 - 15s - loss: 8.7670 - accuracy10: 0.6886 - accuracy20: 0.6705 - accuracy30: 0.6481 - accuracy50: 0.6242 - val_loss: 10.0548 - val_accuracy10: 0.7050 - val_accuracy20: 0.6666 - val_accuracy30: 0.6279 - val_accuracy50: 0.5867 - 15s/epoch - 27ms/step
Epoch 16/50
533/533 - 15s - loss: 8.7018 - accuracy10: 0.6900 - accuracy20: 0.6721 - accuracy30: 0.6504 - accuracy50: 0.6272 - val_loss: 10.0025 - val_accuracy10: 0.6930 - val_accuracy20: 0.6574 - val_accuracy30: 0.6209 - val_accuracy50: 0.5822 - 15s/epoch - 28ms/step
Epoch 17/50
533/533 - 15s - loss: 8.7249 - accuracy10: 0.6861 - accuracy20: 0.6694 - accuracy30: 0.6490 - accuracy50: 0.6259 - val_loss: 10.0601 - val_accuracy10: 0.6842 - val_accuracy20: 0.6486 - val_accuracy30: 0.6122 - val_accuracy50: 0.5740 - 15s/epoch - 27ms/step
Epoch 18/50
533/533 - 14s - loss: 8.6570 - accuracy10: 0.6884 - accuracy20: 0.6716 - accuracy30: 0.6507 - accuracy50: 0.6285 - val_loss: 10.0414 - val_accuracy10: 0.6950 - val_accuracy20: 0.6565 - val_accuracy30: 0.6176 - val_accuracy50: 0.5806 - 14s/epoch - 27ms/step
Epoch 19/50
533/533 - 15s - loss: 8.5574 - accuracy10: 0.6921 - accuracy20: 0.6760 - accuracy30: 0.6536 - accuracy50: 0.6305 - val_loss: 10.1588 - val_accuracy10: 0.6885 - val_accuracy20: 0.6493 - val_accuracy30: 0.6077 - val_accuracy50: 0.5677 - 15s/epoch - 28ms/step
Epoch 20/50
533/533 - 15s - loss: 8.5003 - accuracy10: 0.6914 - accuracy20: 0.6775 - accuracy30: 0.6570 - accuracy50: 0.6339 - val_loss: 10.2812 - val_accuracy10: 0.6794 - val_accuracy20: 0.6397 - val_accuracy30: 0.5997 - val_accuracy50: 0.5617 - 15s/epoch - 28ms/step
Epoch 21/50
533/533 - 14s - loss: 8.4506 - accuracy10: 0.6908 - accuracy20: 0.6768 - accuracy30: 0.6576 - accuracy50: 0.6363 - val_loss: 10.2584 - val_accuracy10: 0.6928 - val_accuracy20: 0.6568 - val_accuracy30: 0.6194 - val_accuracy50: 0.5775 - 14s/epoch - 27ms/step
Epoch 22/50
533/533 - 15s - loss: 8.4034 - accuracy10: 0.6933 - accuracy20: 0.6781 - accuracy30: 0.6589 - accuracy50: 0.6372 - val_loss: 10.2489 - val_accuracy10: 0.6778 - val_accuracy20: 0.6418 - val_accuracy30: 0.6044 - val_accuracy50: 0.5659 - 15s/epoch - 27ms/step
Epoch 23/50
533/533 - 15s - loss: 8.4025 - accuracy10: 0.6910 - accuracy20: 0.6780 - accuracy30: 0.6587 - accuracy50: 0.6366 - val_loss: 10.3210 - val_accuracy10: 0.6681 - val_accuracy20: 0.6338 - val_accuracy30: 0.5975 - val_accuracy50: 0.5610 - 15s/epoch - 28ms/step
testing model: results/QRTEA/W6/deepOF_L2/seq2seq
Evaluating performance on  test set...
2185/2185 - 20s - 20s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.82840836
{'0': {'precision': 0.29725856532469946, 'recall': 0.6695758735092806, 'f1-score': 0.41172956928477566, 'support': 66914}, '1': {'precision': 0.9071768808107937, 'recall': 0.6430495112026371, 'f1-score': 0.752612202688728, 'support': 424409}, '2': {'precision': 0.3425398448027508, 'recall': 0.5432664671982549, 'f1-score': 0.42016049973782, 'support': 67847}, 'accuracy': 0.6341166371586459, 'macro avg': {'precision': 0.5156584303127479, 'recall': 0.6186306173033908, 'f1-score': 0.5281674239037746, 'support': 559170}, 'weighted avg': {'precision': 0.7656796560947429, 'recall': 0.6341166371586459, 'f1-score': 0.6714818287028161, 'support': 559170}}
[[ 44804  14783   7327]
 [ 88074 272916  63419]
 [ 17846  13142  36859]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8783262
{'0': {'precision': 0.34996637363693134, 'recall': 0.6494684526064767, 'f1-score': 0.4548413026682379, 'support': 89738}, '1': {'precision': 0.8529945207776076, 'recall': 0.5909628472020569, 'f1-score': 0.6982035367869506, 'support': 378814}, '2': {'precision': 0.37736196884505485, 'recall': 0.542143944911607, 'f1-score': 0.4449879079372843, 'support': 90618}, 'accuracy': 0.5924405815762648, 'macro avg': {'precision': 0.5267742877531979, 'recall': 0.5941917482400468, 'f1-score': 0.5326775824641575, 'support': 559170}, 'weighted avg': {'precision': 0.695186322091816, 'recall': 0.5924405815762648, 'f1-score': 0.6181120904996961, 'support': 559170}}
[[ 58282  20658  10798]
 [ 84687 223865  70262]
 [ 23567  17923  49128]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9295755
{'0': {'precision': 0.3805701586155547, 'recall': 0.6275602269556321, 'f1-score': 0.473809139237484, 'support': 107510}, '1': {'precision': 0.8026460956902046, 'recall': 0.5321261324793174, 'f1-score': 0.6399728038018603, 'support': 343163}, '2': {'precision': 0.3840174632888762, 'recall': 0.5464206383586643, 'f1-score': 0.4510457322408113, 'support': 108497}, 'accuracy': 0.5532485648371693, 'macro avg': {'precision': 0.5224112391982119, 'recall': 0.5687023325978713, 'f1-score': 0.5216092250933851, 'support': 559170}, 'weighted avg': {'precision': 0.6402673294392567, 'recall': 0.5532485648371693, 'f1-score': 0.5713670558889266, 'support': 559170}}
[[ 67469  24119  15922]
 [ 81383 182606  79174]
 [ 28432  20780  59285]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9704647
{'0': {'precision': 0.4235518560872625, 'recall': 0.5701397985539102, 'f1-score': 0.4860336076666109, 'support': 135123}, '1': {'precision': 0.701451223059102, 'recall': 0.48776422509083556, 'f1-score': 0.5754092965857671, 'support': 286782}, '2': {'precision': 0.40832883551477533, 'recall': 0.52910064473828, 'f1-score': 0.4609350456479727, 'support': 137265}, 'accuracy': 0.5178174794785128, 'macro avg': {'precision': 0.5111106382203799, 'recall': 0.5290015561276752, 'f1-score': 0.5074593166334503, 'support': 559170}, 'weighted avg': {'precision': 0.562341398337447, 'recall': 0.5178174794785128, 'f1-score': 0.5257106016114311, 'support': 559170}}
[[ 77039  31863  26221]
 [ 67884 139882  79016]
 [ 36965  27673  72627]]
Evaluating performance on  train set...
533/533 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.72861856
{'0': {'precision': 0.3139864099660249, 'recall': 0.6566987416728349, 'f1-score': 0.4248431738734856, 'support': 13510}, '1': {'precision': 0.9313435319568758, 'recall': 0.7170455377406838, 'f1-score': 0.810264683222941, 'support': 109272}, '2': {'precision': 0.3300678221552374, 'recall': 0.5844762398991771, 'f1-score': 0.421886287625418, 'support': 13489}, 'accuracy': 0.6979401339976957, 'macro avg': {'precision': 0.525132588026046, 'recall': 0.6527401731042319, 'f1-score': 0.5523313815739481, 'support': 136271}, 'weighted avg': {'precision': 0.8106201002097638, 'recall': 0.6979401339976957, 'f1-score': 0.7336094831471646, 'support': 136271}}
[[ 8872  3156  1482]
 [16399 78353 14520]
 [ 2985  2620  7884]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7728371
{'0': {'precision': 0.3737592550680591, 'recall': 0.6363185996587218, 'f1-score': 0.4709141274238227, 'support': 18167}, '1': {'precision': 0.8916791750962605, 'recall': 0.6832078245477183, 'f1-score': 0.7736455879688349, 'support': 99993}, '2': {'precision': 0.37344658335363945, 'recall': 0.5923471923140633, 'f1-score': 0.4580895853793928, 'support': 18111}, 'accuracy': 0.6648810091655598, 'macro avg': {'precision': 0.5462950045059863, 'recall': 0.6372912055068345, 'f1-score': 0.5675497669240168, 'support': 136271}, 'weighted avg': {'precision': 0.7537572279746942, 'recall': 0.6648810091655598, 'f1-score': 0.6913481277122974, 'support': 136271}}
[[11560  4698  1909]
 [15587 68316 16090]
 [ 3782  3601 10728]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.82851106
{'0': {'precision': 0.4071772800290971, 'recall': 0.6161537403109664, 'f1-score': 0.490327761150449, 'support': 21803}, '1': {'precision': 0.8554279448259942, 'recall': 0.6390790225393711, 'f1-score': 0.7315938523806291, 'support': 92771}, '2': {'precision': 0.383014424492199, 'recall': 0.5996681568880491, 'f1-score': 0.467458278692942, 'support': 21697}, 'accuracy': 0.6291360597632658, 'macro avg': {'precision': 0.5485398831157634, 'recall': 0.6183003065794622, 'f1-score': 0.5631266307413401, 'support': 136271}, 'weighted avg': {'precision': 0.7084915798235424, 'recall': 0.6291360597632658, 'f1-score': 0.6509363821236166, 'support': 136271}}
[[13434  5808  2561]
 [15085 59288 18398]
 [ 4474  4212 13011]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.88103175
{'0': {'precision': 0.4556909851027498, 'recall': 0.5563423313324467, 'f1-score': 0.5010115396442617, 'support': 27821}, '1': {'precision': 0.7803714620772717, 'recall': 0.6077882004443347, 'f1-score': 0.6833516048903012, 'support': 81020}, '2': {'precision': 0.40933091855215165, 'recall': 0.5850164053955523, 'f1-score': 0.4816532348836162, 'support': 27430}, 'accuracy': 0.5927013084221882, 'macro avg': {'precision': 0.5484644552440577, 'recall': 0.5830489790574446, 'f1-score': 0.555338793139393, 'support': 136271}, 'weighted avg': {'precision': 0.6393981246921919, 'recall': 0.5927013084221882, 'f1-score': 0.6055252937566524, 'support': 136271}}
[[15478  8102  4241]
 [12862 49243 18915]
 [ 5626  5757 16047]]
Evaluating performance on  val set...
189/189 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.72413826
{'0': {'precision': 0.30758863777731704, 'recall': 0.6225346202266051, 'f1-score': 0.41174021648626147, 'support': 4766}, '1': {'precision': 0.9252651564750557, 'recall': 0.7253201262542021, 'f1-score': 0.8131823870420185, 'support': 38969}, '2': {'precision': 0.31459972524041463, 'recall': 0.5640394088669951, 'f1-score': 0.4039124508939309, 'support': 4466}, 'accuracy': 0.7002136885126865, 'macro avg': {'precision': 0.5158178398309291, 'recall': 0.6372980517826008, 'f1-score': 0.542945018140737, 'support': 48201}, 'weighted avg': {'precision': 0.8076103753707771, 'recall': 0.7002136885126865, 'f1-score': 0.7355683765504084, 'support': 48201}}
[[ 2967  1220   579]
 [ 5795 28265  4909]
 [  884  1063  2519]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7869398
{'0': {'precision': 0.35878935532233885, 'recall': 0.601287688442211, 'f1-score': 0.44941314553990613, 'support': 6368}, '1': {'precision': 0.8850760764001295, 'recall': 0.6879333482442407, 'f1-score': 0.7741509226195158, 'support': 35768}, '2': {'precision': 0.35053453947368424, 'recall': 0.562242374278648, 'f1-score': 0.43183688976128665, 'support': 6065}, 'accuracy': 0.6606709404369204, 'macro avg': {'precision': 0.5314666570653842, 'recall': 0.6171544703216999, 'f1-score': 0.5518003193069029, 'support': 48201}, 'weighted avg': {'precision': 0.7482866267770457, 'recall': 0.6606709404369204, 'f1-score': 0.6881762587385152, 'support': 48201}}
[[ 3829  1715   824]
 [ 5668 24606  5494]
 [ 1175  1480  3410]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.85124093
{'0': {'precision': 0.39202687174047557, 'recall': 0.5764981151696348, 'f1-score': 0.4666947279806377, 'support': 7693}, '1': {'precision': 0.8490363600238426, 'recall': 0.6430893330122803, 'f1-score': 0.7318501772594154, 'support': 33224}, '2': {'precision': 0.35468736671500467, 'recall': 0.570840197693575, 'f1-score': 0.43752301783553427, 'support': 7284}, 'accuracy': 0.6215431215120019, 'macro avg': {'precision': 0.5319168661597743, 'recall': 0.5968092152918301, 'f1-score': 0.5453559743585291, 'support': 48201}, 'weighted avg': {'precision': 0.7013918700625239, 'recall': 0.6215431215120019, 'f1-score': 0.6450528099735668, 'support': 48201}}
[[ 4435  2087  1171]
 [ 5464 21366  6394]
 [ 1414  1712  4158]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.90798575
{'0': {'precision': 0.44087226340286156, 'recall': 0.5187100699726194, 'f1-score': 0.47663420770628523, 'support': 9861}, '1': {'precision': 0.7774961765348481, 'recall': 0.6114643114883673, 'f1-score': 0.6845567867036011, 'support': 29099}, '2': {'precision': 0.3734869476447426, 'recall': 0.5542690185044908, 'f1-score': 0.44626443040731867, 'support': 9241}, 'accuracy': 0.5815232049127611, 'macro avg': {'precision': 0.5306184625274841, 'recall': 0.5614811333218258, 'f1-score': 0.5358184749390683, 'support': 48201}, 'weighted avg': {'precision': 0.6311735340260208, 'recall': 0.5815232049127611, 'f1-score': 0.5963348781119437, 'support': 48201}}
[[ 5115  2819  1927]
 [ 4641 17793  6665]
 [ 1846  2273  5122]]
training model: results/QRTEA/W6/deepVOL_L2/seq2seq
Epoch 1/50
533/533 - 21s - loss: 11.1772 - accuracy10: 0.5365 - accuracy20: 0.5358 - accuracy30: 0.5314 - accuracy50: 0.5244 - val_loss: 11.3768 - val_accuracy10: 0.4540 - val_accuracy20: 0.4462 - val_accuracy30: 0.4302 - val_accuracy50: 0.4213 - 21s/epoch - 39ms/step
Epoch 2/50
533/533 - 15s - loss: 10.3084 - accuracy10: 0.6147 - accuracy20: 0.6097 - accuracy30: 0.5946 - accuracy50: 0.5731 - val_loss: 11.0993 - val_accuracy10: 0.4937 - val_accuracy20: 0.4780 - val_accuracy30: 0.4539 - val_accuracy50: 0.4339 - 15s/epoch - 28ms/step
Epoch 3/50
533/533 - 15s - loss: 10.0851 - accuracy10: 0.6304 - accuracy20: 0.6249 - accuracy30: 0.6095 - accuracy50: 0.5859 - val_loss: 10.8188 - val_accuracy10: 0.5204 - val_accuracy20: 0.5011 - val_accuracy30: 0.4689 - val_accuracy50: 0.4426 - 15s/epoch - 28ms/step
Epoch 4/50
533/533 - 14s - loss: 9.9086 - accuracy10: 0.6483 - accuracy20: 0.6388 - accuracy30: 0.6195 - accuracy50: 0.5934 - val_loss: 10.8436 - val_accuracy10: 0.4847 - val_accuracy20: 0.4583 - val_accuracy30: 0.4268 - val_accuracy50: 0.4062 - 14s/epoch - 27ms/step
Epoch 5/50
533/533 - 14s - loss: 9.7913 - accuracy10: 0.6551 - accuracy20: 0.6428 - accuracy30: 0.6229 - accuracy50: 0.5951 - val_loss: 10.7899 - val_accuracy10: 0.5098 - val_accuracy20: 0.4775 - val_accuracy30: 0.4404 - val_accuracy50: 0.4150 - 14s/epoch - 26ms/step
Epoch 6/50
533/533 - 14s - loss: 9.7263 - accuracy10: 0.6647 - accuracy20: 0.6525 - accuracy30: 0.6302 - accuracy50: 0.6015 - val_loss: 10.6756 - val_accuracy10: 0.5412 - val_accuracy20: 0.5106 - val_accuracy30: 0.4701 - val_accuracy50: 0.4380 - 14s/epoch - 27ms/step
Epoch 7/50
533/533 - 14s - loss: 9.6363 - accuracy10: 0.6711 - accuracy20: 0.6598 - accuracy30: 0.6365 - accuracy50: 0.6048 - val_loss: 10.5015 - val_accuracy10: 0.5538 - val_accuracy20: 0.5199 - val_accuracy30: 0.4799 - val_accuracy50: 0.4461 - 14s/epoch - 27ms/step
Epoch 8/50
533/533 - 14s - loss: 9.5336 - accuracy10: 0.6768 - accuracy20: 0.6644 - accuracy30: 0.6410 - accuracy50: 0.6093 - val_loss: 10.2985 - val_accuracy10: 0.6072 - val_accuracy20: 0.5778 - val_accuracy30: 0.5394 - val_accuracy50: 0.4991 - 14s/epoch - 27ms/step
Epoch 9/50
533/533 - 14s - loss: 9.4570 - accuracy10: 0.6771 - accuracy20: 0.6652 - accuracy30: 0.6412 - accuracy50: 0.6092 - val_loss: 10.5487 - val_accuracy10: 0.5397 - val_accuracy20: 0.5138 - val_accuracy30: 0.4762 - val_accuracy50: 0.4455 - 14s/epoch - 27ms/step
Epoch 10/50
533/533 - 14s - loss: 9.4157 - accuracy10: 0.6807 - accuracy20: 0.6670 - accuracy30: 0.6421 - accuracy50: 0.6109 - val_loss: 10.3248 - val_accuracy10: 0.5753 - val_accuracy20: 0.5445 - val_accuracy30: 0.5061 - val_accuracy50: 0.4729 - 14s/epoch - 27ms/step
Epoch 11/50
533/533 - 14s - loss: 9.3629 - accuracy10: 0.6811 - accuracy20: 0.6669 - accuracy30: 0.6406 - accuracy50: 0.6079 - val_loss: 10.3374 - val_accuracy10: 0.5625 - val_accuracy20: 0.5284 - val_accuracy30: 0.4885 - val_accuracy50: 0.4600 - 14s/epoch - 27ms/step
Epoch 12/50
533/533 - 14s - loss: 9.2811 - accuracy10: 0.6843 - accuracy20: 0.6711 - accuracy30: 0.6453 - accuracy50: 0.6135 - val_loss: 10.3087 - val_accuracy10: 0.5683 - val_accuracy20: 0.5399 - val_accuracy30: 0.5037 - val_accuracy50: 0.4754 - 14s/epoch - 26ms/step
Epoch 13/50
533/533 - 14s - loss: 9.2258 - accuracy10: 0.6876 - accuracy20: 0.6733 - accuracy30: 0.6475 - accuracy50: 0.6144 - val_loss: 10.2191 - val_accuracy10: 0.5993 - val_accuracy20: 0.5713 - val_accuracy30: 0.5352 - val_accuracy50: 0.5019 - 14s/epoch - 26ms/step
Epoch 14/50
533/533 - 14s - loss: 9.1457 - accuracy10: 0.6892 - accuracy20: 0.6733 - accuracy30: 0.6476 - accuracy50: 0.6155 - val_loss: 10.1815 - val_accuracy10: 0.6163 - val_accuracy20: 0.5805 - val_accuracy30: 0.5427 - val_accuracy50: 0.5073 - 14s/epoch - 27ms/step
Epoch 15/50
533/533 - 14s - loss: 9.0788 - accuracy10: 0.6889 - accuracy20: 0.6741 - accuracy30: 0.6494 - accuracy50: 0.6182 - val_loss: 10.0781 - val_accuracy10: 0.6080 - val_accuracy20: 0.5766 - val_accuracy30: 0.5385 - val_accuracy50: 0.5059 - 14s/epoch - 26ms/step
Epoch 16/50
533/533 - 14s - loss: 9.0154 - accuracy10: 0.6890 - accuracy20: 0.6741 - accuracy30: 0.6494 - accuracy50: 0.6173 - val_loss: 10.2380 - val_accuracy10: 0.5925 - val_accuracy20: 0.5578 - val_accuracy30: 0.5179 - val_accuracy50: 0.4886 - 14s/epoch - 27ms/step
Epoch 17/50
533/533 - 14s - loss: 8.9674 - accuracy10: 0.6897 - accuracy20: 0.6746 - accuracy30: 0.6490 - accuracy50: 0.6186 - val_loss: 10.1518 - val_accuracy10: 0.6148 - val_accuracy20: 0.5754 - val_accuracy30: 0.5324 - val_accuracy50: 0.5012 - 14s/epoch - 27ms/step
Epoch 18/50
533/533 - 14s - loss: 8.8986 - accuracy10: 0.6911 - accuracy20: 0.6754 - accuracy30: 0.6505 - accuracy50: 0.6214 - val_loss: 10.1829 - val_accuracy10: 0.6185 - val_accuracy20: 0.5821 - val_accuracy30: 0.5424 - val_accuracy50: 0.5081 - 14s/epoch - 26ms/step
Epoch 19/50
533/533 - 14s - loss: 8.8580 - accuracy10: 0.6922 - accuracy20: 0.6767 - accuracy30: 0.6520 - accuracy50: 0.6224 - val_loss: 10.3088 - val_accuracy10: 0.6061 - val_accuracy20: 0.5736 - val_accuracy30: 0.5363 - val_accuracy50: 0.5026 - 14s/epoch - 27ms/step
Epoch 20/50
533/533 - 14s - loss: 8.8080 - accuracy10: 0.6940 - accuracy20: 0.6782 - accuracy30: 0.6533 - accuracy50: 0.6240 - val_loss: 10.1991 - val_accuracy10: 0.6313 - val_accuracy20: 0.5941 - val_accuracy30: 0.5542 - val_accuracy50: 0.5184 - 14s/epoch - 26ms/step
Epoch 21/50
533/533 - 14s - loss: 8.7660 - accuracy10: 0.6942 - accuracy20: 0.6776 - accuracy30: 0.6532 - accuracy50: 0.6236 - val_loss: 10.2951 - val_accuracy10: 0.6291 - val_accuracy20: 0.5888 - val_accuracy30: 0.5449 - val_accuracy50: 0.5054 - 14s/epoch - 27ms/step
Epoch 22/50
533/533 - 15s - loss: 8.7211 - accuracy10: 0.6930 - accuracy20: 0.6776 - accuracy30: 0.6548 - accuracy50: 0.6264 - val_loss: 10.3530 - val_accuracy10: 0.6248 - val_accuracy20: 0.5755 - val_accuracy30: 0.5304 - val_accuracy50: 0.4952 - 15s/epoch - 28ms/step
Epoch 23/50
533/533 - 14s - loss: 8.7097 - accuracy10: 0.6940 - accuracy20: 0.6784 - accuracy30: 0.6555 - accuracy50: 0.6271 - val_loss: 10.2879 - val_accuracy10: 0.6183 - val_accuracy20: 0.5705 - val_accuracy30: 0.5224 - val_accuracy50: 0.4848 - 14s/epoch - 27ms/step
Epoch 24/50
533/533 - 14s - loss: 8.6316 - accuracy10: 0.6955 - accuracy20: 0.6809 - accuracy30: 0.6569 - accuracy50: 0.6295 - val_loss: 10.2542 - val_accuracy10: 0.6011 - val_accuracy20: 0.5536 - val_accuracy30: 0.5044 - val_accuracy50: 0.4704 - 14s/epoch - 26ms/step
Epoch 25/50
533/533 - 14s - loss: 8.6035 - accuracy10: 0.6940 - accuracy20: 0.6791 - accuracy30: 0.6560 - accuracy50: 0.6295 - val_loss: 10.3278 - val_accuracy10: 0.5879 - val_accuracy20: 0.5460 - val_accuracy30: 0.5039 - val_accuracy50: 0.4746 - 14s/epoch - 26ms/step
testing model: results/QRTEA/W6/deepVOL_L2/seq2seq
Evaluating performance on  test set...
2185/2185 - 22s - 22s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8943218
{'0': {'precision': 0.2980611805256355, 'recall': 0.6720017933198834, 'f1-score': 0.4129580310404996, 'support': 66915}, '1': {'precision': 0.9254127656818577, 'recall': 0.5386913597700337, 'f1-score': 0.6809786987518299, 'support': 424410}, '2': {'precision': 0.2884960032742765, 'recall': 0.685659543109801, 'f1-score': 0.40611591963580335, 'support': 67850}, 'accuracy': 0.5724773103232441, 'macro avg': {'precision': 0.50398998316059, 'recall': 0.632117565399906, 'f1-score': 0.5000175498093776, 'support': 559175}, 'weighted avg': {'precision': 0.7730561087317384, 'recall': 0.5724773103232441, 'f1-score': 0.6155536662612392, 'support': 559175}}
[[ 44967   9979  11969]
 [ 93018 228626 102766]
 [ 12880   8448  46522]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.92826736
{'0': {'precision': 0.3486208003736245, 'recall': 0.6654446177847114, 'f1-score': 0.4575401766046699, 'support': 89740}, '1': {'precision': 0.8782007552100849, 'recall': 0.4825613625684373, 'f1-score': 0.6228653010044841, 'support': 378814}, '2': {'precision': 0.3343589686522818, 'recall': 0.6631244413546529, 'f1-score': 0.4445619888513651, 'support': 90621}, 'accuracy': 0.5411740510573613, 'macro avg': {'precision': 0.5203935080786638, 'recall': 0.6037101405692672, 'f1-score': 0.5083224888201731, 'support': 559175}, 'weighted avg': {'precision': 0.7050742891007656, 'recall': 0.5411740510573613, 'f1-score': 0.5674366764875312, 'support': 559175}}
[[ 59717  13208  16815]
 [ 93195 182801 102818]
 [ 18383  12145  60093]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.97110075
{'0': {'precision': 0.37065178924578973, 'recall': 0.6624376813751023, 'f1-score': 0.4753387172128412, 'support': 107512}, '1': {'precision': 0.8353999629857376, 'recall': 0.407771234078266, 'f1-score': 0.548037268978158, 'support': 343163}, '2': {'precision': 0.3541629077203745, 'recall': 0.6512811059907834, 'f1-score': 0.45882139054099685, 'support': 108500}, 'accuracy': 0.5039853355389636, 'macro avg': {'precision': 0.5200715533173006, 'recall': 0.5738300071480505, 'f1-score': 0.49406579224399866, 'support': 559175}, 'weighted avg': {'precision': 0.6526660672439373, 'recall': 0.5039853355389636, 'f1-score': 0.516748514102091, 'support': 559175}}
[[ 71220  13810  22482]
 [ 96853 139932 106378]
 [ 24075  13761  70664]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0055199
{'0': {'precision': 0.4030532843729577, 'recall': 0.6344078859730918, 'f1-score': 0.49293446228598536, 'support': 135126}, '1': {'precision': 0.7390064828555807, 'recall': 0.3299195904903376, 'f1-score': 0.45618255981022726, 'support': 286782}, '2': {'precision': 0.38799117442414033, 'recall': 0.6174754310941449, 'f1-score': 0.47654495211161496, 'support': 137267}, 'accuracy': 0.47408950686278895, 'macro avg': {'precision': 0.5100169805508928, 'recall': 0.5272676358525248, 'f1-score': 0.4752206580692759, 'support': 559175}, 'weighted avg': {'precision': 0.5716548840884301, 'recall': 0.47408950686278895, 'f1-score': 0.4700623328293606, 'support': 559175}}
[[ 85725  16001  33400]
 [ 91870  94615 100297]
 [ 35094  17414  84759]]
Evaluating performance on  train set...
533/533 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.87411743
{'0': {'precision': 0.2967482356045116, 'recall': 0.6668643000074113, 'f1-score': 0.4107269200045647, 'support': 13493}, '1': {'precision': 0.9488187177260887, 'recall': 0.5700727588889397, 'f1-score': 0.7122242930811714, 'support': 109265}, '2': {'precision': 0.2478971788700593, 'recall': 0.7391979875702871, 'f1-score': 0.37128151767962986, 'support': 13516}, 'accuracy': 0.5964307204602493, 'macro avg': {'precision': 0.49782137740021987, 'recall': 0.6587116821555461, 'f1-score': 0.49807757692178867, 'support': 136274}, 'weighted avg': {'precision': 0.8147356018386521, 'recall': 0.5964307204602493, 'f1-score': 0.648556340226996, 'support': 136274}}
[[ 8998  2021  2474]
 [19138 62289 27838]
 [ 2186  1339  9991]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8999451
{'0': {'precision': 0.34554167379770667, 'recall': 0.6681005956320317, 'f1-score': 0.4554991539763113, 'support': 18132}, '1': {'precision': 0.9166592986861417, 'recall': 0.5182867083924894, 'f1-score': 0.6621745045315484, 'support': 100018}, '2': {'precision': 0.29607074890854135, 'recall': 0.729640256014125, 'f1-score': 0.42122027743713075, 'support': 18124}, 'accuracy': 0.5663296006574988, 'macro avg': {'precision': 0.5194239071307966, 'recall': 0.6386758533462152, 'f1-score': 0.5129646453149969, 'support': 136274}, 'weighted avg': {'precision': 0.7581327151071293, 'recall': 0.5663296006574988, 'f1-score': 0.6026290896459005, 'support': 136274}}
[[12114  2815  3203]
 [19942 51838 28238]
 [ 3002  1898 13224]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9411551
{'0': {'precision': 0.3659254822689726, 'recall': 0.6736963014013324, 'f1-score': 0.47425447959117667, 'support': 21765}, '1': {'precision': 0.8880960034286939, 'recall': 0.446569615206405, 'f1-score': 0.5943012017093527, 'support': 92803}, '2': {'precision': 0.31688804554079697, 'recall': 0.7232101723025891, 'f1-score': 0.4406827241592275, 'support': 21706}, 'accuracy': 0.5269090215301525, 'macro avg': {'precision': 0.5236365104128211, 'recall': 0.6144920296367755, 'f1-score': 0.5030794684865857, 'support': 136274}, 'weighted avg': {'precision': 0.7137143801773325, 'recall': 0.5269090215301525, 'f1-score': 0.5506592774933972, 'support': 136274}}
[[14663  2994  4108]
 [21628 41443 29732]
 [ 3780  2228 15698]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9714604
{'0': {'precision': 0.3991414409630023, 'recall': 0.6503226736849695, 'f1-score': 0.4946729010407382, 'support': 27737}, '1': {'precision': 0.8261319111885067, 'recall': 0.37452509004786105, 'f1-score': 0.5153963673400102, 'support': 81068}, '2': {'precision': 0.355567826247009, 'recall': 0.7032654992901088, 'f1-score': 0.4723285125735034, 'support': 27469}, 'accuracy': 0.49692531223857817, 'macro avg': {'precision': 0.5269470594661726, 'recall': 0.5760377543409798, 'f1-score': 0.4941325936514172, 'support': 136274}, 'weighted avg': {'precision': 0.6443704635029408, 'recall': 0.49692531223857817, 'f1-score': 0.5024970785004363, 'support': 136274}}
[[18038  3533  6166]
 [21860 30362 28846]
 [ 5294  2857 19318]]
Evaluating performance on  val set...
189/189 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.85517156
{'0': {'precision': 0.29604935814508904, 'recall': 0.6272401433691757, 'f1-score': 0.4022444564629529, 'support': 4743}, '1': {'precision': 0.9433687110102892, 'recall': 0.5969445298882395, 'f1-score': 0.7312003516593928, 'support': 39012}, '2': {'precision': 0.23509319076260488, 'recall': 0.7119406341353721, 'f1-score': 0.35346656246511104, 'support': 4447}, 'accuracy': 0.610534832579561, 'macro avg': {'precision': 0.49150375330599433, 'recall': 0.6453751024642624, 'f1-score': 0.4956371235291523, 'support': 48202}, 'weighted avg': {'precision': 0.814329730694512, 'recall': 0.610534832579561, 'f1-score': 0.6639828094108619, 'support': 48202}}
[[ 2975   799   969]
 [ 6392 23288  9332]
 [  682   599  3166]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8986746
{'0': {'precision': 0.3393322900365154, 'recall': 0.6148393194706995, 'f1-score': 0.4373109243697479, 'support': 6348}, '1': {'precision': 0.9057864859915766, 'recall': 0.5523575556237961, 'f1-score': 0.6862394866903667, 'support': 35821}, '2': {'precision': 0.2794157242864836, 'recall': 0.6880490634841704, 'f1-score': 0.39743405620182876, 'support': 6033}, 'accuracy': 0.5775693954607692, 'macro avg': {'precision': 0.5081781667715252, 'recall': 0.6184153128595553, 'f1-score': 0.5069948224206479, 'support': 48202}, 'weighted avg': {'precision': 0.7527898044993242, 'recall': 0.5775693954607692, 'f1-score': 0.6173095320049048, 'support': 48202}}
[[ 3903  1155  1290]
 [ 6620 19786  9415]
 [  979   903  4151]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9478887
{'0': {'precision': 0.3598811066229708, 'recall': 0.615966605791808, 'f1-score': 0.45432241304661564, 'support': 7666}, '1': {'precision': 0.8752750496431063, 'recall': 0.49034876728803367, 'f1-score': 0.6285626192357351, 'support': 33260}, '2': {'precision': 0.29936770428015563, 'recall': 0.6767454645409565, 'f1-score': 0.4151070645759568, 'support': 7276}, 'accuracy': 0.5384631343097797, 'macro avg': {'precision': 0.5115079535154109, 'recall': 0.5943536125402661, 'f1-score': 0.4993306989527692, 'support': 48202}, 'weighted avg': {'precision': 0.7063751738692134, 'recall': 0.5384631343097797, 'f1-score': 0.5686309144029411, 'support': 48202}}
[[ 4722  1276  1668]
 [ 7095 16309  9856]
 [ 1304  1048  4924]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9868527
{'0': {'precision': 0.3947155020948777, 'recall': 0.593235831809872, 'f1-score': 0.47403018990423634, 'support': 9846}, '1': {'precision': 0.8151293441337862, 'recall': 0.42839976653963674, 'f1-score': 0.5616293462360751, 'support': 29127}, '2': {'precision': 0.3311781609195402, 'recall': 0.649366128507964, 'f1-score': 0.4386459286367795, 'support': 9229}, 'accuracy': 0.5043774117256545, 'macro avg': {'precision': 0.5136743357160681, 'recall': 0.5570005756191576, 'f1-score': 0.49143515492569695, 'support': 48202}, 'weighted avg': {'precision': 0.6365935954387244, 'recall': 0.5043774117256545, 'f1-score': 0.5201888405668668, 'support': 48202}}
[[ 5841  1535  2470]
 [ 7016 12478  9633]
 [ 1941  1295  5993]]
training model: results/QRTEA/W6/deepVOL_L3/seq2seq
Epoch 1/50
533/533 - 28s - loss: 11.8659 - accuracy10: 0.4505 - accuracy20: 0.4548 - accuracy30: 0.4582 - accuracy50: 0.4630 - val_loss: 11.5744 - val_accuracy10: 0.3734 - val_accuracy20: 0.3837 - val_accuracy30: 0.3828 - val_accuracy50: 0.3912 - 28s/epoch - 52ms/step
Epoch 2/50
533/533 - 21s - loss: 10.3926 - accuracy10: 0.6007 - accuracy20: 0.5964 - accuracy30: 0.5851 - accuracy50: 0.5675 - val_loss: 10.9885 - val_accuracy10: 0.4787 - val_accuracy20: 0.4509 - val_accuracy30: 0.4139 - val_accuracy50: 0.3954 - 21s/epoch - 40ms/step
Epoch 3/50
533/533 - 22s - loss: 9.9141 - accuracy10: 0.6426 - accuracy20: 0.6310 - accuracy30: 0.6117 - accuracy50: 0.5848 - val_loss: 11.0182 - val_accuracy10: 0.4761 - val_accuracy20: 0.4400 - val_accuracy30: 0.3964 - val_accuracy50: 0.3743 - 22s/epoch - 41ms/step
Epoch 4/50
533/533 - 22s - loss: 9.7036 - accuracy10: 0.6600 - accuracy20: 0.6465 - accuracy30: 0.6234 - accuracy50: 0.5930 - val_loss: 10.6620 - val_accuracy10: 0.5298 - val_accuracy20: 0.4797 - val_accuracy30: 0.4161 - val_accuracy50: 0.3799 - 22s/epoch - 41ms/step
Epoch 5/50
533/533 - 21s - loss: 9.5765 - accuracy10: 0.6717 - accuracy20: 0.6594 - accuracy30: 0.6359 - accuracy50: 0.6038 - val_loss: 10.6296 - val_accuracy10: 0.5633 - val_accuracy20: 0.5039 - val_accuracy30: 0.4264 - val_accuracy50: 0.3739 - 21s/epoch - 40ms/step
Epoch 6/50
533/533 - 21s - loss: 9.4717 - accuracy10: 0.6782 - accuracy20: 0.6635 - accuracy30: 0.6383 - accuracy50: 0.6048 - val_loss: 10.5107 - val_accuracy10: 0.5374 - val_accuracy20: 0.4869 - val_accuracy30: 0.4251 - val_accuracy50: 0.3792 - 21s/epoch - 39ms/step
Epoch 7/50
533/533 - 21s - loss: 9.3644 - accuracy10: 0.6826 - accuracy20: 0.6677 - accuracy30: 0.6423 - accuracy50: 0.6093 - val_loss: 10.4288 - val_accuracy10: 0.5690 - val_accuracy20: 0.5215 - val_accuracy30: 0.4611 - val_accuracy50: 0.4143 - 21s/epoch - 39ms/step
Epoch 8/50
533/533 - 21s - loss: 9.2991 - accuracy10: 0.6845 - accuracy20: 0.6685 - accuracy30: 0.6434 - accuracy50: 0.6103 - val_loss: 10.4214 - val_accuracy10: 0.5684 - val_accuracy20: 0.5275 - val_accuracy30: 0.4697 - val_accuracy50: 0.4239 - 21s/epoch - 39ms/step
Epoch 9/50
533/533 - 22s - loss: 9.2271 - accuracy10: 0.6852 - accuracy20: 0.6702 - accuracy30: 0.6454 - accuracy50: 0.6122 - val_loss: 10.3704 - val_accuracy10: 0.5572 - val_accuracy20: 0.5211 - val_accuracy30: 0.4683 - val_accuracy50: 0.4238 - 22s/epoch - 41ms/step
Epoch 10/50
533/533 - 22s - loss: 9.1596 - accuracy10: 0.6855 - accuracy20: 0.6727 - accuracy30: 0.6486 - accuracy50: 0.6147 - val_loss: 10.2947 - val_accuracy10: 0.5849 - val_accuracy20: 0.5479 - val_accuracy30: 0.4981 - val_accuracy50: 0.4535 - 22s/epoch - 41ms/step
Epoch 11/50
533/533 - 21s - loss: 9.0990 - accuracy10: 0.6843 - accuracy20: 0.6715 - accuracy30: 0.6473 - accuracy50: 0.6148 - val_loss: 10.1958 - val_accuracy10: 0.5764 - val_accuracy20: 0.5517 - val_accuracy30: 0.5071 - val_accuracy50: 0.4660 - 21s/epoch - 40ms/step
Epoch 12/50
533/533 - 22s - loss: 9.0428 - accuracy10: 0.6861 - accuracy20: 0.6723 - accuracy30: 0.6493 - accuracy50: 0.6161 - val_loss: 10.1305 - val_accuracy10: 0.5877 - val_accuracy20: 0.5578 - val_accuracy30: 0.5169 - val_accuracy50: 0.4708 - 22s/epoch - 40ms/step
Epoch 13/50
533/533 - 21s - loss: 8.9863 - accuracy10: 0.6872 - accuracy20: 0.6728 - accuracy30: 0.6498 - accuracy50: 0.6197 - val_loss: 10.2263 - val_accuracy10: 0.5631 - val_accuracy20: 0.5342 - val_accuracy30: 0.4892 - val_accuracy50: 0.4533 - 21s/epoch - 40ms/step
Epoch 14/50
533/533 - 21s - loss: 8.9225 - accuracy10: 0.6904 - accuracy20: 0.6756 - accuracy30: 0.6522 - accuracy50: 0.6207 - val_loss: 10.2039 - val_accuracy10: 0.5775 - val_accuracy20: 0.5460 - val_accuracy30: 0.5042 - val_accuracy50: 0.4710 - 21s/epoch - 40ms/step
Epoch 15/50
533/533 - 21s - loss: 8.8821 - accuracy10: 0.6919 - accuracy20: 0.6757 - accuracy30: 0.6515 - accuracy50: 0.6201 - val_loss: 10.3456 - val_accuracy10: 0.5394 - val_accuracy20: 0.5122 - val_accuracy30: 0.4762 - val_accuracy50: 0.4524 - 21s/epoch - 40ms/step
Epoch 16/50
533/533 - 21s - loss: 8.8516 - accuracy10: 0.6904 - accuracy20: 0.6753 - accuracy30: 0.6513 - accuracy50: 0.6197 - val_loss: 10.2234 - val_accuracy10: 0.5922 - val_accuracy20: 0.5565 - val_accuracy30: 0.5139 - val_accuracy50: 0.4787 - 21s/epoch - 39ms/step
Epoch 17/50
533/533 - 21s - loss: 8.8104 - accuracy10: 0.6925 - accuracy20: 0.6765 - accuracy30: 0.6528 - accuracy50: 0.6214 - val_loss: 10.4544 - val_accuracy10: 0.5507 - val_accuracy20: 0.5164 - val_accuracy30: 0.4775 - val_accuracy50: 0.4504 - 21s/epoch - 39ms/step
Epoch 18/50
533/533 - 21s - loss: 8.7472 - accuracy10: 0.6930 - accuracy20: 0.6774 - accuracy30: 0.6542 - accuracy50: 0.6239 - val_loss: 10.3714 - val_accuracy10: 0.5530 - val_accuracy20: 0.5186 - val_accuracy30: 0.4794 - val_accuracy50: 0.4523 - 21s/epoch - 40ms/step
Epoch 19/50
533/533 - 21s - loss: 8.6853 - accuracy10: 0.6951 - accuracy20: 0.6805 - accuracy30: 0.6577 - accuracy50: 0.6266 - val_loss: 10.4413 - val_accuracy10: 0.5424 - val_accuracy20: 0.5079 - val_accuracy30: 0.4680 - val_accuracy50: 0.4420 - 21s/epoch - 40ms/step
Epoch 20/50
533/533 - 22s - loss: 8.6204 - accuracy10: 0.6956 - accuracy20: 0.6799 - accuracy30: 0.6571 - accuracy50: 0.6279 - val_loss: 10.6500 - val_accuracy10: 0.5035 - val_accuracy20: 0.4673 - val_accuracy30: 0.4312 - val_accuracy50: 0.4117 - 22s/epoch - 40ms/step
Epoch 21/50
533/533 - 21s - loss: 8.5953 - accuracy10: 0.6969 - accuracy20: 0.6820 - accuracy30: 0.6581 - accuracy50: 0.6296 - val_loss: 10.5815 - val_accuracy10: 0.5286 - val_accuracy20: 0.4939 - val_accuracy30: 0.4588 - val_accuracy50: 0.4383 - 21s/epoch - 39ms/step
Epoch 22/50
533/533 - 21s - loss: 8.5603 - accuracy10: 0.6948 - accuracy20: 0.6803 - accuracy30: 0.6582 - accuracy50: 0.6291 - val_loss: 10.6237 - val_accuracy10: 0.5350 - val_accuracy20: 0.4956 - val_accuracy30: 0.4540 - val_accuracy50: 0.4268 - 21s/epoch - 39ms/step
testing model: results/QRTEA/W6/deepVOL_L3/seq2seq
Evaluating performance on  test set...
2185/2185 - 34s - 34s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9262651
{'0': {'precision': 0.2616290787431727, 'recall': 0.7759844578943436, 'f1-score': 0.3913212225349777, 'support': 66915}, '1': {'precision': 0.9239772595635476, 'recall': 0.4886383449965835, 'f1-score': 0.6392265772374764, 'support': 424410}, '2': {'precision': 0.2838743294119374, 'recall': 0.5700957995578482, 'f1-score': 0.3790192591286114, 'support': 67850}, 'accuracy': 0.5329083024098001, 'macro avg': {'precision': 0.4898268892395526, 'recall': 0.611572867482925, 'f1-score': 0.4698556863003552, 'support': 559175}, 'weighted avg': {'precision': 0.7670460442367141, 'recall': 0.5329083024098001, 'f1-score': 0.5779869772131474, 'support': 559175}}
[[ 51925   7947   7043]
 [126490 207383  90537]
 [ 20053   9116  38681]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.95961016
{'0': {'precision': 0.31326717578284646, 'recall': 0.7601738355248495, 'f1-score': 0.44368998026035517, 'support': 89740}, '1': {'precision': 0.8744034175650914, 'recall': 0.43334459655662144, 'f1-score': 0.5794969552554937, 'support': 378814}, '2': {'precision': 0.33184752336083706, 'recall': 0.5627503558777767, 'f1-score': 0.4175000102334453, 'support': 90621}, 'accuracy': 0.5067680064380561, 'macro avg': {'precision': 0.506506038902925, 'recall': 0.5854229293197492, 'f1-score': 0.48022898191643143, 'support': 559175}, 'weighted avg': {'precision': 0.6964209898345556, 'recall': 0.5067680064380561, 'f1-score': 0.5314482351036508, 'support': 559175}}
[[ 68218  11128  10394]
 [122372 164157  92285]
 [ 27173  12451  50997]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9994255
{'0': {'precision': 0.34053801700860525, 'recall': 0.753097328670288, 'f1-score': 0.469001430747754, 'support': 107512}, '1': {'precision': 0.8319860603368752, 'recall': 0.35480806497203954, 'f1-score': 0.49746684425995086, 'support': 343163}, '2': {'precision': 0.3487273516576416, 'recall': 0.5626820276497696, 'f1-score': 0.4305916041302263, 'support': 108500}, 'accuracy': 0.4717217329100908, 'macro avg': {'precision': 0.5070838096677074, 'recall': 0.5568624737640323, 'f1-score': 0.4656866263793104, 'support': 559175}, 'weighted avg': {'precision': 0.6437263349807598, 'recall': 0.4717217329100908, 'f1-score': 0.4790176340992705, 'support': 559175}}
[[ 80967  11711  14834]
 [122223 121757  99183]
 [ 34572  12877  61051]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0293425
{'0': {'precision': 0.37881461730526184, 'recall': 0.7275653834199192, 'f1-score': 0.4982237605598829, 'support': 135126}, '1': {'precision': 0.7444842856023199, 'recall': 0.2649782761819082, 'f1-score': 0.3908459216055384, 'support': 286782}, '2': {'precision': 0.37863596102745795, 'recall': 0.5449889631156797, 'f1-score': 0.4468316399973719, 'support': 137267}, 'accuracy': 0.44550096123753746, 'macro avg': {'precision': 0.5006449546450132, 'recall': 0.512510874239169, 'f1-score': 0.44530044072093106, 'support': 559175}, 'weighted avg': {'precision': 0.566310401634464, 'recall': 0.44550096123753746, 'f1-score': 0.43053748412717574, 'support': 559175}}
[[ 98313  12311  24502]
 [112527  75991  98264]
 [ 48688  13770  74809]]
Evaluating performance on  train set...
533/533 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.896661
{'0': {'precision': 0.2578336208450269, 'recall': 0.7421626028310976, 'f1-score': 0.38271038752579684, 'support': 13493}, '1': {'precision': 0.9525582632401343, 'recall': 0.524449732302201, 'f1-score': 0.6764606930582034, 'support': 109265}, '2': {'precision': 0.2464790621562894, 'recall': 0.679786919206866, 'f1-score': 0.361782135333609, 'support': 13516}, 'accuracy': 0.5614130355020033, 'macro avg': {'precision': 0.48562364874715014, 'recall': 0.6487997514467215, 'f1-score': 0.4736510719725364, 'support': 136274}, 'weighted avg': {'precision': 0.8137402489330292, 'recall': 0.5614130355020033, 'f1-score': 0.6161647579660041, 'support': 136274}}
[[10014  1592  1887]
 [25759 57304 26202]
 [ 3066  1262  9188]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9194751
{'0': {'precision': 0.3103239760913552, 'recall': 0.735881314802559, 'f1-score': 0.43655220926237953, 'support': 18132}, '1': {'precision': 0.9211167610093064, 'recall': 0.4799536083504969, 'f1-score': 0.6310793844859433, 'support': 100018}, '2': {'precision': 0.29692434769933435, 'recall': 0.6743544471419113, 'f1-score': 0.4123064467159195, 'support': 18124}, 'accuracy': 0.5398608685442564, 'macro avg': {'precision': 0.5094550282666653, 'recall': 0.6300631234316557, 'f1-score': 0.4933126801547474, 'support': 136274}, 'weighted avg': {'precision': 0.7568318785301671, 'recall': 0.5398608685442564, 'f1-score': 0.5761003902148603, 'support': 136274}}
[[13343  2289  2500]
 [25574 48004 26440]
 [ 4080  1822 12222]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9583546
{'0': {'precision': 0.33764289028556965, 'recall': 0.7355387089363657, 'f1-score': 0.462828314951069, 'support': 21765}, '1': {'precision': 0.8915040048857257, 'recall': 0.40897384782819524, 'f1-score': 0.5607197730764686, 'support': 92803}, '2': {'precision': 0.315682589063884, 'recall': 0.673177923154888, 'f1-score': 0.4298089509214184, 'support': 21706}, 'accuracy': 0.5032141127434434, 'macro avg': {'precision': 0.5149431614117265, 'recall': 0.6058968266398163, 'f1-score': 0.48445234631631867, 'support': 136274}, 'weighted avg': {'precision': 0.7113260779803637, 'recall': 0.5032141127434434, 'f1-score': 0.5242332980937365, 'support': 136274}}
[[16009  2568  3188]
 [26362 37954 28487]
 [ 5043  2051 14612]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9880653
{'0': {'precision': 0.3750809061488673, 'recall': 0.7103507949670116, 'f1-score': 0.4909364994331419, 'support': 27737}, '1': {'precision': 0.8271690943635213, 'recall': 0.3222233186954162, 'f1-score': 0.4637809814643847, 'support': 81068}, '2': {'precision': 0.3484778774633847, 'recall': 0.6617641705194947, 'f1-score': 0.45654439742317887, 'support': 27469}, 'accuracy': 0.4696640591748976, 'macro avg': {'precision': 0.5169092926585911, 'recall': 0.5647794280606409, 'f1-score': 0.4704206261069018, 'support': 136274}, 'weighted avg': {'precision': 0.6386610949392751, 'recall': 0.4696640591748976, 'f1-score': 0.4678494822412866, 'support': 136274}}
[[19703  3036  4998]
 [25958 26122 28988]
 [ 6869  2422 18178]]
Evaluating performance on  val set...
189/189 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8716211
{'0': {'precision': 0.2742714404662781, 'recall': 0.6944971537001897, 'f1-score': 0.3932430012535068, 'support': 4743}, '1': {'precision': 0.9462604826287866, 'recall': 0.5669024915410643, 'f1-score': 0.7090279558861247, 'support': 39012}, '2': {'precision': 0.22815912636505462, 'recall': 0.6577467955925342, 'f1-score': 0.3387965483291828, 'support': 4447}, 'accuracy': 0.587838678892992, 'macro avg': {'precision': 0.4828970164867064, 'recall': 0.6397154802779295, 'f1-score': 0.4803558351562714, 'support': 48202}, 'weighted avg': {'precision': 0.8138875363136628, 'recall': 0.587838678892992, 'f1-score': 0.6437985647980323, 'support': 48202}}
[[ 3294   706   743]
 [ 7744 22116  9152]
 [  972   550  2925]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9122633
{'0': {'precision': 0.3205666316894019, 'recall': 0.673755513547574, 'f1-score': 0.43443372270187913, 'support': 6348}, '1': {'precision': 0.9097093983866265, 'recall': 0.5225984757544457, 'f1-score': 0.6638415574744233, 'support': 35821}, '2': {'precision': 0.27342108948326566, 'recall': 0.6472733300182331, 'f1-score': 0.38444499138567556, 'support': 6033}, 'accuracy': 0.5581096220073856, 'macro avg': {'precision': 0.5012323731864313, 'recall': 0.6145424397734175, 'f1-score': 0.49424009052065937, 'support': 48202}, 'weighted avg': {'precision': 0.75248343990756, 'recall': 0.5581096220073856, 'f1-score': 0.5986600210578943, 'support': 48202}}
[[ 4277  1045  1026]
 [ 7750 18720  9351]
 [ 1315   813  3905]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.96267897
{'0': {'precision': 0.3452041785375119, 'recall': 0.663840333942082, 'f1-score': 0.45421278114958946, 'support': 7666}, '1': {'precision': 0.8776949073534553, 'recall': 0.4528863499699339, 'f1-score': 0.597477291658403, 'support': 33260}, '2': {'precision': 0.2885016566449871, 'recall': 0.6462341946124244, 'f1-score': 0.3989140578603546, 'support': 7276}, 'accuracy': 0.5156217584332601, 'macro avg': {'precision': 0.5038002475119848, 'recall': 0.5876536261748134, 'f1-score': 0.4835347102227823, 'support': 48202}, 'weighted avg': {'precision': 0.7040704930291983, 'recall': 0.5156217584332601, 'f1-score': 0.5447198992955309, 'support': 48202}}
[[ 5089  1185  1392]
 [ 7993 15063 10204]
 [ 1660   914  4702]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.002109
{'0': {'precision': 0.38418837308607334, 'recall': 0.6396506195409303, 'f1-score': 0.48004878234688814, 'support': 9846}, '1': {'precision': 0.8186953493770797, 'recall': 0.3632368592714663, 'f1-score': 0.5032104637336504, 'support': 29127}, '2': {'precision': 0.31144763316742563, 'recall': 0.6373388232744609, 'f1-score': 0.41842432865018675, 'support': 9229}, 'accuracy': 0.4721795776108875, 'macro avg': {'precision': 0.5047771185435262, 'recall': 0.5467421006956191, 'f1-score': 0.4672278582435751, 'support': 48202}, 'weighted avg': {'precision': 0.6328203885567788, 'recall': 0.4721795776108875, 'f1-score': 0.4822457494973252, 'support': 48202}}
[[ 6298  1319  2229]
 [ 7772 10580 10775]
 [ 2323  1024  5882]]
training model: results/QRTEA/W7/deepLOB_L1/seq2seq
Epoch 1/50
538/538 - 18s - loss: 12.1387 - accuracy10: 0.3904 - accuracy20: 0.4079 - accuracy30: 0.4197 - accuracy50: 0.4339 - val_loss: 13.5502 - val_accuracy10: 0.3909 - val_accuracy20: 0.4132 - val_accuracy30: 0.4188 - val_accuracy50: 0.4153 - 18s/epoch - 33ms/step
Epoch 2/50
538/538 - 11s - loss: 11.9114 - accuracy10: 0.3955 - accuracy20: 0.4184 - accuracy30: 0.4313 - accuracy50: 0.4416 - val_loss: 13.4000 - val_accuracy10: 0.4303 - val_accuracy20: 0.4576 - val_accuracy30: 0.4684 - val_accuracy50: 0.4570 - 11s/epoch - 21ms/step
Epoch 3/50
538/538 - 11s - loss: 11.6445 - accuracy10: 0.4362 - accuracy20: 0.4564 - accuracy30: 0.4662 - accuracy50: 0.4709 - val_loss: 12.5376 - val_accuracy10: 0.3118 - val_accuracy20: 0.3511 - val_accuracy30: 0.3774 - val_accuracy50: 0.4078 - 11s/epoch - 21ms/step
Epoch 4/50
538/538 - 11s - loss: 11.4234 - accuracy10: 0.4610 - accuracy20: 0.4778 - accuracy30: 0.4852 - accuracy50: 0.4862 - val_loss: 12.5610 - val_accuracy10: 0.4199 - val_accuracy20: 0.4423 - val_accuracy30: 0.4547 - val_accuracy50: 0.4619 - 11s/epoch - 20ms/step
Epoch 5/50
538/538 - 11s - loss: 11.1282 - accuracy10: 0.5035 - accuracy20: 0.5126 - accuracy30: 0.5144 - accuracy50: 0.5098 - val_loss: 13.1235 - val_accuracy10: 0.7273 - val_accuracy20: 0.6840 - val_accuracy30: 0.6414 - val_accuracy50: 0.5682 - 11s/epoch - 20ms/step
Epoch 6/50
538/538 - 11s - loss: 10.9600 - accuracy10: 0.5242 - accuracy20: 0.5269 - accuracy30: 0.5229 - accuracy50: 0.5143 - val_loss: 12.8483 - val_accuracy10: 0.6807 - val_accuracy20: 0.6567 - val_accuracy30: 0.6276 - val_accuracy50: 0.5723 - 11s/epoch - 20ms/step
Epoch 7/50
538/538 - 11s - loss: 10.7010 - accuracy10: 0.5583 - accuracy20: 0.5565 - accuracy30: 0.5492 - accuracy50: 0.5354 - val_loss: 12.2535 - val_accuracy10: 0.6552 - val_accuracy20: 0.6328 - val_accuracy30: 0.6085 - val_accuracy50: 0.5602 - 11s/epoch - 20ms/step
Epoch 8/50
538/538 - 11s - loss: 10.4923 - accuracy10: 0.5809 - accuracy20: 0.5721 - accuracy30: 0.5602 - accuracy50: 0.5433 - val_loss: 11.8727 - val_accuracy10: 0.6382 - val_accuracy20: 0.6265 - val_accuracy30: 0.6088 - val_accuracy50: 0.5713 - 11s/epoch - 20ms/step
Epoch 9/50
538/538 - 12s - loss: 10.3323 - accuracy10: 0.5910 - accuracy20: 0.5824 - accuracy30: 0.5689 - accuracy50: 0.5517 - val_loss: 11.5559 - val_accuracy10: 0.6452 - val_accuracy20: 0.6299 - val_accuracy30: 0.6127 - val_accuracy50: 0.5771 - 12s/epoch - 22ms/step
Epoch 10/50
538/538 - 11s - loss: 10.1860 - accuracy10: 0.6042 - accuracy20: 0.5920 - accuracy30: 0.5767 - accuracy50: 0.5571 - val_loss: 11.9184 - val_accuracy10: 0.6843 - val_accuracy20: 0.6602 - val_accuracy30: 0.6342 - val_accuracy50: 0.5825 - 11s/epoch - 20ms/step
Epoch 11/50
538/538 - 11s - loss: 10.0848 - accuracy10: 0.6102 - accuracy20: 0.5976 - accuracy30: 0.5812 - accuracy50: 0.5606 - val_loss: 13.1168 - val_accuracy10: 0.7538 - val_accuracy20: 0.7063 - val_accuracy30: 0.6617 - val_accuracy50: 0.5878 - 11s/epoch - 20ms/step
Epoch 12/50
538/538 - 11s - loss: 10.0011 - accuracy10: 0.6198 - accuracy20: 0.6054 - accuracy30: 0.5868 - accuracy50: 0.5654 - val_loss: 13.3232 - val_accuracy10: 0.7673 - val_accuracy20: 0.7145 - val_accuracy30: 0.6682 - val_accuracy50: 0.5888 - 11s/epoch - 20ms/step
Epoch 13/50
538/538 - 11s - loss: 9.9217 - accuracy10: 0.6258 - accuracy20: 0.6104 - accuracy30: 0.5911 - accuracy50: 0.5682 - val_loss: 12.6870 - val_accuracy10: 0.7607 - val_accuracy20: 0.7128 - val_accuracy30: 0.6700 - val_accuracy50: 0.5972 - 11s/epoch - 20ms/step
Epoch 14/50
538/538 - 12s - loss: 9.8516 - accuracy10: 0.6306 - accuracy20: 0.6141 - accuracy30: 0.5955 - accuracy50: 0.5718 - val_loss: 12.5981 - val_accuracy10: 0.7220 - val_accuracy20: 0.6865 - val_accuracy30: 0.6502 - val_accuracy50: 0.5870 - 12s/epoch - 22ms/step
Epoch 15/50
538/538 - 11s - loss: 9.7857 - accuracy10: 0.6337 - accuracy20: 0.6160 - accuracy30: 0.5963 - accuracy50: 0.5727 - val_loss: 13.3087 - val_accuracy10: 0.7035 - val_accuracy20: 0.6686 - val_accuracy30: 0.6348 - val_accuracy50: 0.5736 - 11s/epoch - 20ms/step
Epoch 16/50
538/538 - 11s - loss: 9.7341 - accuracy10: 0.6369 - accuracy20: 0.6200 - accuracy30: 0.6001 - accuracy50: 0.5746 - val_loss: 14.1473 - val_accuracy10: 0.7513 - val_accuracy20: 0.7014 - val_accuracy30: 0.6565 - val_accuracy50: 0.5794 - 11s/epoch - 21ms/step
Epoch 17/50
538/538 - 11s - loss: 9.6955 - accuracy10: 0.6405 - accuracy20: 0.6213 - accuracy30: 0.6005 - accuracy50: 0.5752 - val_loss: 16.0196 - val_accuracy10: 0.6622 - val_accuracy20: 0.6338 - val_accuracy30: 0.6041 - val_accuracy50: 0.5510 - 11s/epoch - 20ms/step
Epoch 18/50
538/538 - 12s - loss: 9.6385 - accuracy10: 0.6439 - accuracy20: 0.6250 - accuracy30: 0.6037 - accuracy50: 0.5766 - val_loss: 15.4644 - val_accuracy10: 0.7032 - val_accuracy20: 0.6679 - val_accuracy30: 0.6333 - val_accuracy50: 0.5665 - 12s/epoch - 22ms/step
Epoch 19/50
538/538 - 12s - loss: 9.6230 - accuracy10: 0.6444 - accuracy20: 0.6252 - accuracy30: 0.6029 - accuracy50: 0.5769 - val_loss: 13.6664 - val_accuracy10: 0.7093 - val_accuracy20: 0.6754 - val_accuracy30: 0.6420 - val_accuracy50: 0.5774 - 12s/epoch - 22ms/step
testing model: results/QRTEA/W7/deepLOB_L1/seq2seq
Evaluating performance on  test set...
2006/2006 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.827418
{'0': {'precision': 0.2853548499045636, 'recall': 0.5445476934539208, 'f1-score': 0.3744760793299508, 'support': 48319}, '1': {'precision': 0.9079367997467087, 'recall': 0.6396004460806063, 'f1-score': 0.7505044336694348, 'support': 416965}, '2': {'precision': 0.2351144918321048, 'recall': 0.6233817591474836, 'f1-score': 0.3414483996921937, 'support': 48046}, 'accuracy': 0.6291352541250268, 'macro avg': {'precision': 0.476135380494459, 'recall': 0.6025099662273369, 'f1-score': 0.48880963756385976, 'support': 513330}, 'weighted avg': {'precision': 0.7863601183906849, 'recall': 0.6291352541250268, 'f1-score': 0.6768231365276349, 'support': 513330}}
[[ 26312  14299   7708]
 [ 60544 266691  89730]
 [  5352  12743  29951]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8570809
{'0': {'precision': 0.35126749748368286, 'recall': 0.5050275995822766, 'f1-score': 0.4143426294820717, 'support': 67030}, '1': {'precision': 0.8555557889724521, 'recall': 0.6422841372059404, 'f1-score': 0.733736499004597, 'support': 380450}, '2': {'precision': 0.30032661575825864, 'recall': 0.5990432801822323, 'f1-score': 0.4000770802801259, 'support': 65850}, 'accuracy': 0.6188144078857655, 'macro avg': {'precision': 0.5023833007381312, 'recall': 0.5821183389901498, 'f1-score': 0.5160520695889316, 'support': 513330}, 'weighted avg': {'precision': 0.7184816159557827, 'recall': 0.6188144078857655, 'f1-score': 0.6492285922056542, 'support': 513330}}
[[ 33852  21767  11411]
 [ 55604 244357  80489]
 [  6915  19488  39447]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8860161
{'0': {'precision': 0.39156757612330095, 'recall': 0.4767824233006902, 'f1-score': 0.429993753564542, 'support': 83019}, '1': {'precision': 0.8046999468932554, 'recall': 0.6419650243753023, 'f1-score': 0.7141794835457228, 'support': 349329}, '2': {'precision': 0.3465034441449536, 'recall': 0.5714726729396656, 'f1-score': 0.43142135339467336, 'support': 80982}, 'accuracy': 0.6041298969473827, 'macro avg': {'precision': 0.5142569890538367, 'recall': 0.5634067068718861, 'f1-score': 0.5251981968349794, 'support': 513330}, 'weighted avg': {'precision': 0.6656013057179612, 'recall': 0.6041298969473827, 'f1-score': 0.6236117512620069, 'support': 513330}}
[[ 39582  28457  14980]
 [ 52771 224257  72301]
 [  8733  25970  46279]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9413823
{'0': {'precision': 0.44207354627199424, 'recall': 0.42347559315264943, 'f1-score': 0.43257476369064446, 'support': 110174}, '1': {'precision': 0.7055047249836027, 'recall': 0.6491308510781763, 'f1-score': 0.6761447737843775, 'support': 296612}, '2': {'precision': 0.40526393831553975, 'recall': 0.5130462531911698, 'f1-score': 0.45282987606865926, 'support': 106544}, 'accuracy': 0.572454366586796, 'macro avg': {'precision': 0.5176140698570455, 'recall': 0.5285508991406651, 'f1-score': 0.5205164711812271, 'support': 513330}, 'weighted avg': {'precision': 0.5866491719122162, 'recall': 0.572454366586796, 'f1-score': 0.5775182669480532, 'support': 513330}}
[[ 46656  41732  21786]
 [ 45640 192540  58432]
 [ 13243  38639  54662]]
Evaluating performance on  train set...
538/538 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.83277756
{'0': {'precision': 0.3164754546164052, 'recall': 0.5630771367076304, 'f1-score': 0.40520622548652224, 'support': 14403}, '1': {'precision': 0.9109705041527226, 'recall': 0.615860919266492, 'f1-score': 0.7348959728059197, 'support': 109174}, '2': {'precision': 0.24559101406676465, 'recall': 0.6703438395415473, 'f1-score': 0.359480639213276, 'support': 13960}, 'accuracy': 0.6158633676756073, 'macro avg': {'precision': 0.4910123242786308, 'recall': 0.6164272985052232, 'f1-score': 0.49986094583523927, 'support': 137537}, 'weighted avg': {'precision': 0.7811784490688429, 'recall': 0.6158633676756073, 'f1-score': 0.6622659206192746, 'support': 137537}}
[[ 8110  3693  2600]
 [15792 67236 26146]
 [ 1724  2878  9358]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8539503
{'0': {'precision': 0.38233535172310684, 'recall': 0.524671727533853, 'f1-score': 0.4423351351351351, 'support': 19496}, '1': {'precision': 0.861591598337639, 'recall': 0.6186275794630886, 'f1-score': 0.7201694626835895, 'support': 99197}, '2': {'precision': 0.30791981597108115, 'recall': 0.6464126512417746, 'f1-score': 0.41713610602195095, 'support': 18844}, 'accuracy': 0.609116092396955, 'macro avg': {'precision': 0.5172822553439423, 'recall': 0.5965706527462387, 'f1-score': 0.5265469012802252, 'support': 137537}, 'weighted avg': {'precision': 0.7177977766684711, 'recall': 0.6091160923969549, 'f1-score': 0.6392674608745011, 'support': 137537}}
[[10229  5525  3742]
 [14195 61366 23636]
 [ 2330  4333 12181]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8804778
{'0': {'precision': 0.4153545406077839, 'recall': 0.49571561890218035, 'f1-score': 0.45199094935117673, 'support': 23574}, '1': {'precision': 0.8151620252797167, 'recall': 0.6154351827504602, 'f1-score': 0.7013565903571585, 'support': 91272}, '2': {'precision': 0.34783789790828046, 'recall': 0.6207306861751355, 'f1-score': 0.44584071916941, 'support': 22691}, 'accuracy': 0.5957887695674619, 'macro avg': {'precision': 0.5261181545985937, 'recall': 0.5772938292759253, 'f1-score': 0.5330627529592484, 'support': 137537}, 'weighted avg': {'precision': 0.6695349328039364, 'recall': 0.5957887695674619, 'f1-score': 0.6164597534754742, 'support': 137537}}
[[11686  7060  4828]
 [13520 56172 21580]
 [ 2929  5677 14085]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9265275
{'0': {'precision': 0.46074422408505417, 'recall': 0.44503324336778355, 'f1-score': 0.4527524778998125, 'support': 30382}, '1': {'precision': 0.7224623639886719, 'recall': 0.6201619816523152, 'f1-score': 0.6674148175177456, 'support': 78157}, '2': {'precision': 0.39843312814773363, 'recall': 0.5647286019725498, 'f1-score': 0.4672249247492831, 'support': 28998}, 'accuracy': 0.5697884932781724, 'macro avg': {'precision': 0.5272132387404865, 'recall': 0.5433079423308828, 'f1-score': 0.5291307400556137, 'support': 137537}, 'weighted avg': {'precision': 0.5963310661745037, 'recall': 0.5697884932781724, 'f1-score': 0.5777881882269226, 'support': 137537}}
[[13521 10113  6748]
 [11710 48470 17977]
 [ 4115  8507 16376]]
Evaluating performance on  val set...
153/153 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7853618
{'0': {'precision': 0.31212267568220237, 'recall': 0.5922107674684994, 'f1-score': 0.4087925990353444, 'support': 4365}, '1': {'precision': 0.9011688253080012, 'recall': 0.6592822476806761, 'f1-score': 0.7614780353874314, 'support': 30289}, '2': {'precision': 0.3121152282495063, 'recall': 0.6112374886260237, 'f1-score': 0.41322568242983465, 'support': 4396}, 'accuracy': 0.6463764404609476, 'macro avg': {'precision': 0.50846890974657, 'recall': 0.6209101679250665, 'f1-score': 0.5278321056175368, 'support': 39050}, 'weighted avg': {'precision': 0.76901348457085, 'recall': 0.6463764404609476, 'f1-score': 0.6828509093111585, 'support': 39050}}
[[ 2585  1134   646]
 [ 5044 19969  5276]
 [  653  1056  2687]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.819847
{'0': {'precision': 0.3767274416444083, 'recall': 0.5513256288239293, 'f1-score': 0.44760262159365294, 'support': 5884}, '1': {'precision': 0.8432929963089286, 'recall': 0.662494494200558, 'f1-score': 0.7420395913417066, 'support': 27244}, '2': {'precision': 0.3789287295263391, 'recall': 0.5781830462681526, 'f1-score': 0.4578152159379596, 'support': 5922}, 'accuracy': 0.6329577464788733, 'macro avg': {'precision': 0.5329830558265587, 'recall': 0.5973343897642133, 'f1-score': 0.5491524762911064, 'support': 39050}, 'weighted avg': {'precision': 0.7025698999828716, 'recall': 0.6329577464788733, 'f1-score': 0.654571118073114, 'support': 39050}}
[[ 3244  1727   913]
 [ 4496 18049  4699]
 [  871  1627  3424]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.85702825
{'0': {'precision': 0.41376634892485037, 'recall': 0.5240033688938799, 'f1-score': 0.4624055493620711, 'support': 7124}, '1': {'precision': 0.7879606405556627, 'recall': 0.6592945354750182, 'f1-score': 0.7179081520544935, 'support': 24778}, '2': {'precision': 0.41921256454388983, 'recall': 0.5451874650251819, 'f1-score': 0.47397226952079785, 'support': 7148}, 'accuracy': 0.6137259923175417, 'macro avg': {'precision': 0.5403131846748009, 'recall': 0.5761617897980266, 'f1-score': 0.5514286569791209, 'support': 39050}, 'weighted avg': {'precision': 0.6521969688294128, 'recall': 0.6137259923175417, 'f1-score': 0.6266442793289705, 'support': 39050}}
[[ 3733  2254  1137]
 [ 4180 16336  4262]
 [ 1109  2142  3897]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.91877604
{'0': {'precision': 0.4565912969283277, 'recall': 0.46966538672517827, 'f1-score': 0.4630360716024011, 'support': 9115}, '1': {'precision': 0.6830741804496385, 'recall': 0.6648351648351648, 'f1-score': 0.6738312735088661, 'support': 20748}, '2': {'precision': 0.47246835443037977, 'recall': 0.4875367366931534, 'f1-score': 0.4798842877805754, 'support': 9187}, 'accuracy': 0.5775672215108835, 'macro avg': {'precision': 0.5373779439361154, 'recall': 0.5406790960844988, 'f1-score': 0.5389172109639475, 'support': 39050}, 'weighted avg': {'precision': 0.5806611917957158, 'recall': 0.5775672215108835, 'f1-score': 0.5789992831564145, 'support': 39050}}
[[ 4281  3258  1576]
 [ 3529 13794  3425]
 [ 1566  3142  4479]]
training model: results/QRTEA/W7/deepOF_L1/seq2seq
Epoch 1/50
538/538 - 16s - loss: 12.2209 - accuracy10: 0.3780 - accuracy20: 0.3889 - accuracy30: 0.3919 - accuracy50: 0.3976 - val_loss: 12.8564 - val_accuracy10: 0.6059 - val_accuracy20: 0.5785 - val_accuracy30: 0.5520 - val_accuracy50: 0.5036 - 16s/epoch - 29ms/step
Epoch 2/50
538/538 - 10s - loss: 11.8004 - accuracy10: 0.4201 - accuracy20: 0.4205 - accuracy30: 0.4167 - accuracy50: 0.4169 - val_loss: 12.4563 - val_accuracy10: 0.5621 - val_accuracy20: 0.5475 - val_accuracy30: 0.5335 - val_accuracy50: 0.4964 - 10s/epoch - 19ms/step
Epoch 3/50
538/538 - 11s - loss: 11.6003 - accuracy10: 0.4627 - accuracy20: 0.4558 - accuracy30: 0.4483 - accuracy50: 0.4424 - val_loss: 12.4401 - val_accuracy10: 0.6061 - val_accuracy20: 0.5846 - val_accuracy30: 0.5620 - val_accuracy50: 0.5154 - 11s/epoch - 20ms/step
Epoch 4/50
538/538 - 11s - loss: 11.4896 - accuracy10: 0.4863 - accuracy20: 0.4738 - accuracy30: 0.4611 - accuracy50: 0.4507 - val_loss: 12.3656 - val_accuracy10: 0.6182 - val_accuracy20: 0.5904 - val_accuracy30: 0.5657 - val_accuracy50: 0.5167 - 11s/epoch - 20ms/step
Epoch 5/50
538/538 - 11s - loss: 11.4117 - accuracy10: 0.5034 - accuracy20: 0.4881 - accuracy30: 0.4755 - accuracy50: 0.4639 - val_loss: 12.3283 - val_accuracy10: 0.6396 - val_accuracy20: 0.6090 - val_accuracy30: 0.5810 - val_accuracy50: 0.5283 - 11s/epoch - 21ms/step
Epoch 6/50
538/538 - 11s - loss: 11.3346 - accuracy10: 0.5187 - accuracy20: 0.5012 - accuracy30: 0.4863 - accuracy50: 0.4719 - val_loss: 12.2364 - val_accuracy10: 0.6501 - val_accuracy20: 0.6138 - val_accuracy30: 0.5825 - val_accuracy50: 0.5275 - 11s/epoch - 20ms/step
Epoch 7/50
538/538 - 10s - loss: 11.2635 - accuracy10: 0.5241 - accuracy20: 0.5061 - accuracy30: 0.4909 - accuracy50: 0.4759 - val_loss: 12.2162 - val_accuracy10: 0.6382 - val_accuracy20: 0.6046 - val_accuracy30: 0.5741 - val_accuracy50: 0.5208 - 10s/epoch - 19ms/step
Epoch 8/50
538/538 - 10s - loss: 11.2051 - accuracy10: 0.5336 - accuracy20: 0.5153 - accuracy30: 0.4978 - accuracy50: 0.4821 - val_loss: 12.2115 - val_accuracy10: 0.6550 - val_accuracy20: 0.6184 - val_accuracy30: 0.5859 - val_accuracy50: 0.5283 - 10s/epoch - 19ms/step
Epoch 9/50
538/538 - 10s - loss: 11.1310 - accuracy10: 0.5352 - accuracy20: 0.5226 - accuracy30: 0.5076 - accuracy50: 0.4910 - val_loss: 12.1504 - val_accuracy10: 0.6418 - val_accuracy20: 0.6067 - val_accuracy30: 0.5764 - val_accuracy50: 0.5276 - 10s/epoch - 19ms/step
Epoch 10/50
538/538 - 11s - loss: 11.0626 - accuracy10: 0.5322 - accuracy20: 0.5233 - accuracy30: 0.5114 - accuracy50: 0.4969 - val_loss: 12.1074 - val_accuracy10: 0.6386 - val_accuracy20: 0.6068 - val_accuracy30: 0.5800 - val_accuracy50: 0.5319 - 11s/epoch - 20ms/step
Epoch 11/50
538/538 - 10s - loss: 11.0011 - accuracy10: 0.5364 - accuracy20: 0.5263 - accuracy30: 0.5148 - accuracy50: 0.5003 - val_loss: 12.0029 - val_accuracy10: 0.6254 - val_accuracy20: 0.5933 - val_accuracy30: 0.5655 - val_accuracy50: 0.5235 - 10s/epoch - 19ms/step
Epoch 12/50
538/538 - 11s - loss: 10.9400 - accuracy10: 0.5391 - accuracy20: 0.5298 - accuracy30: 0.5185 - accuracy50: 0.5036 - val_loss: 12.0677 - val_accuracy10: 0.6435 - val_accuracy20: 0.6101 - val_accuracy30: 0.5809 - val_accuracy50: 0.5332 - 11s/epoch - 20ms/step
Epoch 13/50
538/538 - 10s - loss: 10.8959 - accuracy10: 0.5443 - accuracy20: 0.5341 - accuracy30: 0.5223 - accuracy50: 0.5065 - val_loss: 11.9790 - val_accuracy10: 0.6350 - val_accuracy20: 0.6035 - val_accuracy30: 0.5759 - val_accuracy50: 0.5345 - 10s/epoch - 19ms/step
Epoch 14/50
538/538 - 10s - loss: 10.8295 - accuracy10: 0.5487 - accuracy20: 0.5381 - accuracy30: 0.5250 - accuracy50: 0.5087 - val_loss: 11.9095 - val_accuracy10: 0.6357 - val_accuracy20: 0.6056 - val_accuracy30: 0.5759 - val_accuracy50: 0.5342 - 10s/epoch - 19ms/step
Epoch 15/50
538/538 - 10s - loss: 10.7788 - accuracy10: 0.5497 - accuracy20: 0.5402 - accuracy30: 0.5285 - accuracy50: 0.5115 - val_loss: 11.9846 - val_accuracy10: 0.6391 - val_accuracy20: 0.6047 - val_accuracy30: 0.5767 - val_accuracy50: 0.5366 - 10s/epoch - 19ms/step
Epoch 16/50
538/538 - 10s - loss: 10.7332 - accuracy10: 0.5508 - accuracy20: 0.5418 - accuracy30: 0.5305 - accuracy50: 0.5152 - val_loss: 11.9682 - val_accuracy10: 0.6442 - val_accuracy20: 0.6105 - val_accuracy30: 0.5810 - val_accuracy50: 0.5373 - 10s/epoch - 19ms/step
Epoch 17/50
538/538 - 10s - loss: 10.6941 - accuracy10: 0.5521 - accuracy20: 0.5433 - accuracy30: 0.5328 - accuracy50: 0.5177 - val_loss: 12.0347 - val_accuracy10: 0.6403 - val_accuracy20: 0.6084 - val_accuracy30: 0.5806 - val_accuracy50: 0.5389 - 10s/epoch - 19ms/step
Epoch 18/50
538/538 - 11s - loss: 10.6579 - accuracy10: 0.5542 - accuracy20: 0.5444 - accuracy30: 0.5327 - accuracy50: 0.5172 - val_loss: 12.0975 - val_accuracy10: 0.6457 - val_accuracy20: 0.6092 - val_accuracy30: 0.5797 - val_accuracy50: 0.5373 - 11s/epoch - 20ms/step
Epoch 19/50
538/538 - 10s - loss: 10.5979 - accuracy10: 0.5584 - accuracy20: 0.5481 - accuracy30: 0.5357 - accuracy50: 0.5195 - val_loss: 12.1286 - val_accuracy10: 0.6535 - val_accuracy20: 0.6208 - val_accuracy30: 0.5930 - val_accuracy50: 0.5474 - 10s/epoch - 19ms/step
Epoch 20/50
538/538 - 10s - loss: 10.5610 - accuracy10: 0.5599 - accuracy20: 0.5492 - accuracy30: 0.5380 - accuracy50: 0.5220 - val_loss: 12.0819 - val_accuracy10: 0.6404 - val_accuracy20: 0.6069 - val_accuracy30: 0.5806 - val_accuracy50: 0.5401 - 10s/epoch - 19ms/step
Epoch 21/50
538/538 - 11s - loss: 10.5020 - accuracy10: 0.5630 - accuracy20: 0.5529 - accuracy30: 0.5411 - accuracy50: 0.5257 - val_loss: 12.2483 - val_accuracy10: 0.6604 - val_accuracy20: 0.6241 - val_accuracy30: 0.5940 - val_accuracy50: 0.5477 - 11s/epoch - 20ms/step
Epoch 22/50
538/538 - 11s - loss: 10.4585 - accuracy10: 0.5641 - accuracy20: 0.5550 - accuracy30: 0.5434 - accuracy50: 0.5268 - val_loss: 12.1765 - val_accuracy10: 0.6410 - val_accuracy20: 0.6081 - val_accuracy30: 0.5838 - val_accuracy50: 0.5419 - 11s/epoch - 21ms/step
Epoch 23/50
538/538 - 10s - loss: 10.4436 - accuracy10: 0.5656 - accuracy20: 0.5551 - accuracy30: 0.5439 - accuracy50: 0.5288 - val_loss: 12.2223 - val_accuracy10: 0.6571 - val_accuracy20: 0.6239 - val_accuracy30: 0.5955 - val_accuracy50: 0.5500 - 10s/epoch - 18ms/step
Epoch 24/50
538/538 - 10s - loss: 10.3878 - accuracy10: 0.5687 - accuracy20: 0.5580 - accuracy30: 0.5471 - accuracy50: 0.5321 - val_loss: 12.2626 - val_accuracy10: 0.6431 - val_accuracy20: 0.6126 - val_accuracy30: 0.5890 - val_accuracy50: 0.5471 - 10s/epoch - 19ms/step
testing model: results/QRTEA/W7/deepOF_L1/seq2seq
Evaluating performance on  test set...
2006/2006 - 18s - 18s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.76732945
{'0': {'precision': 0.2884567970413538, 'recall': 0.5327000289747092, 'f1-score': 0.3742548055951377, 'support': 48318}, '1': {'precision': 0.891401548980279, 'recall': 0.7301072999457984, 'f1-score': 0.8027323175257786, 'support': 416962}, '2': {'precision': 0.3043594090578833, 'recall': 0.5231345613487356, 'f1-score': 0.38482679425837324, 'support': 48045}, 'accuracy': 0.6921540934106073, 'macro avg': {'precision': 0.49473925169317196, 'recall': 0.5953139634230812, 'f1-score': 0.5206046391264297, 'support': 513325}, 'weighted avg': {'precision': 0.7797032601052847, 'recall': 0.6921540934106073, 'f1-score': 0.7232866499918629, 'support': 513325}}
[[ 25739  18974   3605]
 [ 58694 304427  53841]
 [  4797  18114  25134]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8157954
{'0': {'precision': 0.34759906662341605, 'recall': 0.4955840668357452, 'f1-score': 0.40860532482149114, 'support': 67030}, '1': {'precision': 0.8271280723269196, 'recall': 0.7144453001584969, 'f1-score': 0.7666683590290353, 'support': 380449}, '2': {'precision': 0.361166268412255, 'recall': 0.48892871245026276, 'f1-score': 0.4154466561280124, 'support': 65846}, 'accuracy': 0.656938586665368, 'macro avg': {'precision': 0.5119644691208636, 'recall': 0.5663193598148349, 'f1-score': 0.5302401133261796, 'support': 513325}, 'weighted avg': {'precision': 0.7047405981285642, 'recall': 0.656938586665368, 'f1-score': 0.6748600320779762, 'support': 513325}}
[[ 33219  29025   4786]
 [ 56480 271810  52159]
 [  5868  27784  32194]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8603901
{'0': {'precision': 0.38859350419180755, 'recall': 0.47011491483774603, 'f1-score': 0.42548459542550643, 'support': 83018}, '1': {'precision': 0.7676206493633292, 'recall': 0.6977033112051962, 'f1-score': 0.7309939415751906, 'support': 349329}, '2': {'precision': 0.39474732648353955, 'recall': 0.4649534441453234, 'f1-score': 0.4269837489651731, 'support': 80978}, 'accuracy': 0.6241796133054108, 'macro avg': {'precision': 0.516987160012892, 'recall': 0.5442572233960885, 'f1-score': 0.5278207619886234, 'support': 513325}, 'weighted avg': {'precision': 0.647500625055125, 'recall': 0.6241796133054108, 'f1-score': 0.6336269474178273, 'support': 513325}}
[[ 39028  37651   6339]
 [ 54211 243728  51390]
 [  7195  36132  37651]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.92299825
{'0': {'precision': 0.445850791433892, 'recall': 0.4172475765167193, 'f1-score': 0.43107522646711305, 'support': 110172}, '1': {'precision': 0.6570487517633203, 'recall': 0.6846587461060241, 'f1-score': 0.6705696662307987, 'support': 296612}, '2': {'precision': 0.44126748727074994, 'recall': 0.4189185384030561, 'f1-score': 0.4298026828962953, 'support': 106541}, 'accuracy': 0.572111235572006, 'macro avg': {'precision': 0.5147223434893208, 'recall': 0.5069416203419331, 'f1-score': 0.510482525198069, 'support': 513325}, 'weighted avg': {'precision': 0.5669349770870106, 'recall': 0.572111235572006, 'f1-score': 0.5691969752668167, 'support': 513325}}
[[ 45969  54396   9807]
 [ 46828 203078  46706]
 [ 10307  51602  44632]]
Evaluating performance on  train set...
538/538 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.81117725
{'0': {'precision': 0.31564694931031567, 'recall': 0.5144118052682388, 'f1-score': 0.39123138242080974, 'support': 14502}, '1': {'precision': 0.8749078052378332, 'recall': 0.6851558130793138, 'f1-score': 0.768491953313795, 'support': 109073}, '2': {'precision': 0.26435893835135515, 'recall': 0.5393982808022922, 'f1-score': 0.3548204693242861, 'support': 13960}, 'accuracy': 0.6523575817064747, 'macro avg': {'precision': 0.48497123096650135, 'recall': 0.579655299716615, 'f1-score': 0.5048479350196303, 'support': 137535}, 'weighted avg': {'precision': 0.7539664949212149, 'recall': 0.6523575817064747, 'f1-score': 0.6867244998249842, 'support': 137535}}
[[ 7460  5545  1497]
 [14884 74732 19457]
 [ 1290  5140  7530]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8461347
{'0': {'precision': 0.380204398138943, 'recall': 0.48872872258856004, 'f1-score': 0.4276895549094163, 'support': 19563}, '1': {'precision': 0.8132488098588964, 'recall': 0.6702742503252878, 'f1-score': 0.7348719423187507, 'support': 99143}, '2': {'precision': 0.320880195599022, 'recall': 0.5227574486164959, 'f1-score': 0.3976648351648352, 'support': 18829}, 'accuracy': 0.6242556440178864, 'macro avg': {'precision': 0.5047778011989538, 'recall': 0.5605868071767812, 'f1-score': 0.5200754441310007, 'support': 137535}, 'weighted avg': {'precision': 0.6842456000259329, 'recall': 0.6242556440178864, 'f1-score': 0.6450134941747154, 'support': 137535}}
[[ 9561  7988  2014]
 [13872 66453 18818]
 [ 1714  7272  9843]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8815247
{'0': {'precision': 0.41617926319787313, 'recall': 0.46302712752471903, 'f1-score': 0.4383550684054724, 'support': 23666}, '1': {'precision': 0.757770072155223, 'recall': 0.6519297629884729, 'f1-score': 0.7008766706559997, 'support': 91177}, '2': {'precision': 0.35549247626896197, 'recall': 0.5132645866384629, 'f1-score': 0.4200522946533225, 'support': 22692}, 'accuracy': 0.5965463336605228, 'macro avg': {'precision': 0.5098139372073527, 'recall': 0.5427404923838849, 'f1-score': 0.5197613445715982, 'support': 137535}, 'weighted avg': {'precision': 0.6326195919819168, 'recall': 0.5965463336605228, 'f1-score': 0.6093704869273944, 'support': 137535}}
[[10958 10082  2626]
 [13246 59441 18490]
 [ 2126  8919 11647]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9315678
{'0': {'precision': 0.4605971249539255, 'recall': 0.4103102938762108, 'f1-score': 0.43400191021967527, 'support': 30455}, '1': {'precision': 0.6566314398943197, 'recall': 0.6363717833824094, 'f1-score': 0.6463428905792861, 'support': 78110}, '2': {'precision': 0.4010949430917735, 'recall': 0.4804970659302727, 'f1-score': 0.43722025912838636, 'support': 28970}, 'accuracy': 0.5534809321263678, 'macro avg': {'precision': 0.5061078359800062, 'recall': 0.5090597143962977, 'f1-score': 0.5058550199757826, 'support': 137535}, 'weighted avg': {'precision': 0.5593971549931712, 'recall': 0.5534809321263678, 'f1-score': 0.5552742375819798, 'support': 137535}}
[[12496 13971  3988]
 [11606 49707 16797]
 [ 3028 12022 13920]]
Evaluating performance on  val set...
153/153 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8302564
{'0': {'precision': 0.3092827605874804, 'recall': 0.4993093922651934, 'f1-score': 0.3819670687681606, 'support': 4344}, '1': {'precision': 0.8580930330456746, 'recall': 0.6721403369934382, 'f1-score': 0.7538182759513332, 'support': 30327}, '2': {'precision': 0.27360540932141997, 'recall': 0.517469741950217, 'f1-score': 0.35794960903562123, 'support': 4379}, 'accuracy': 0.6355697823303457, 'macro avg': {'precision': 0.480327067651525, 'recall': 0.5629731570696163, 'f1-score': 0.49791165125170506, 'support': 39050}, 'weighted avg': {'precision': 0.7314988428319253, 'recall': 0.6355697823303457, 'f1-score': 0.6680607718174637, 'support': 39050}}
[[ 2169  1704   471]
 [ 4398 20384  5545]
 [  446  1667  2266]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8693712
{'0': {'precision': 0.3773635872501351, 'recall': 0.47525089300901513, 'f1-score': 0.42068809756832043, 'support': 5879}, '1': {'precision': 0.7883166659324199, 'recall': 0.6559624619670809, 'f1-score': 0.7160750730321341, 'support': 27279}, '2': {'precision': 0.3296076897284006, 'recall': 0.5005091649694501, 'f1-score': 0.3974661365321113, 'support': 5892}, 'accuracy': 0.6053008962868118, 'macro avg': {'precision': 0.49842931430365184, 'recall': 0.5439075066485154, 'f1-score': 0.5114097690441887, 'support': 39050}, 'weighted avg': {'precision': 0.6572358352700067, 'recall': 0.6053008962868118, 'f1-score': 0.6235315677156195, 'support': 39050}}
[[ 2794  2437   648]
 [ 4035 17894  5350]
 [  575  2368  2949]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9041099
{'0': {'precision': 0.41223438506117194, 'recall': 0.45040101308569014, 'f1-score': 0.4304733727810651, 'support': 7107}, '1': {'precision': 0.7257129714811408, 'recall': 0.6355031015870458, 'f1-score': 0.6776188635485118, 'support': 24826}, '2': {'precision': 0.364903090623363, 'recall': 0.48939159758325135, 'f1-score': 0.4180770615772416, 'support': 7117}, 'accuracy': 0.5751856594110115, 'macro avg': {'precision': 0.5009501490552252, 'recall': 0.5250985707519957, 'f1-score': 0.5087230993022728, 'support': 39050}, 'weighted avg': {'precision': 0.6029018002711145, 'recall': 0.5751856594110115, 'f1-score': 0.5853366098349708, 'support': 39050}}
[[ 3201  3083   823]
 [ 3810 15777  5239]
 [  754  2880  3483]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9552274
{'0': {'precision': 0.46532410320956574, 'recall': 0.405773241137087, 'f1-score': 0.4335131332082552, 'support': 9111}, '1': {'precision': 0.6166928683721595, 'recall': 0.6227449848462981, 'f1-score': 0.6197041505098377, 'support': 20787}, '2': {'precision': 0.4190231362467866, 'recall': 0.4630681818181818, 'f1-score': 0.4399460188933873, 'support': 9152}, 'accuracy': 0.5346991037131882, 'macro avg': {'precision': 0.500346702609504, 'recall': 0.497195469267189, 'f1-score': 0.49772110087049337, 'support': 39050}, 'weighted avg': {'precision': 0.5350489706049943, 'recall': 0.5346991037131882, 'f1-score': 0.534133528763654, 'support': 39050}}
[[ 3697  4177  1237]
 [ 3203 12945  4639]
 [ 1045  3869  4238]]
training model: results/QRTEA/W7/deepLOB_L2/seq2seq
Epoch 1/50
538/538 - 30s - loss: 12.2050 - accuracy10: 0.4060 - accuracy20: 0.4173 - accuracy30: 0.4240 - accuracy50: 0.4341 - val_loss: 13.2154 - val_accuracy10: 0.4770 - val_accuracy20: 0.4820 - val_accuracy30: 0.4802 - val_accuracy50: 0.4612 - 30s/epoch - 56ms/step
Epoch 2/50
538/538 - 24s - loss: 11.4075 - accuracy10: 0.4706 - accuracy20: 0.4901 - accuracy30: 0.4999 - accuracy50: 0.5017 - val_loss: 12.9742 - val_accuracy10: 0.6335 - val_accuracy20: 0.6177 - val_accuracy30: 0.5966 - val_accuracy50: 0.5515 - 24s/epoch - 45ms/step
Epoch 3/50
538/538 - 24s - loss: 11.0680 - accuracy10: 0.5242 - accuracy20: 0.5335 - accuracy30: 0.5346 - accuracy50: 0.5281 - val_loss: 14.8126 - val_accuracy10: 0.7619 - val_accuracy20: 0.6989 - val_accuracy30: 0.6452 - val_accuracy50: 0.5521 - 24s/epoch - 45ms/step
Epoch 4/50
538/538 - 25s - loss: 10.8109 - accuracy10: 0.5583 - accuracy20: 0.5624 - accuracy30: 0.5575 - accuracy50: 0.5458 - val_loss: 12.5350 - val_accuracy10: 0.6602 - val_accuracy20: 0.6416 - val_accuracy30: 0.6197 - val_accuracy50: 0.5706 - 25s/epoch - 46ms/step
Epoch 5/50
538/538 - 24s - loss: 10.4986 - accuracy10: 0.5925 - accuracy20: 0.5894 - accuracy30: 0.5793 - accuracy50: 0.5619 - val_loss: 12.3563 - val_accuracy10: 0.6567 - val_accuracy20: 0.6416 - val_accuracy30: 0.6205 - val_accuracy50: 0.5759 - 24s/epoch - 45ms/step
Epoch 6/50
538/538 - 24s - loss: 10.1671 - accuracy10: 0.6270 - accuracy20: 0.6183 - accuracy30: 0.6027 - accuracy50: 0.5802 - val_loss: 12.2072 - val_accuracy10: 0.7183 - val_accuracy20: 0.6928 - val_accuracy30: 0.6604 - val_accuracy50: 0.6007 - 24s/epoch - 45ms/step
Epoch 7/50
538/538 - 24s - loss: 9.8748 - accuracy10: 0.6541 - accuracy20: 0.6394 - accuracy30: 0.6178 - accuracy50: 0.5895 - val_loss: 11.8873 - val_accuracy10: 0.5957 - val_accuracy20: 0.5855 - val_accuracy30: 0.5700 - val_accuracy50: 0.5434 - 24s/epoch - 45ms/step
Epoch 8/50
538/538 - 24s - loss: 9.6970 - accuracy10: 0.6634 - accuracy20: 0.6474 - accuracy30: 0.6236 - accuracy50: 0.5933 - val_loss: 11.5921 - val_accuracy10: 0.5953 - val_accuracy20: 0.5981 - val_accuracy30: 0.5906 - val_accuracy50: 0.5691 - 24s/epoch - 45ms/step
Epoch 9/50
538/538 - 24s - loss: 9.5916 - accuracy10: 0.6707 - accuracy20: 0.6536 - accuracy30: 0.6274 - accuracy50: 0.5953 - val_loss: 13.5868 - val_accuracy10: 0.3877 - val_accuracy20: 0.4135 - val_accuracy30: 0.4266 - val_accuracy50: 0.4484 - 24s/epoch - 45ms/step
Epoch 10/50
538/538 - 24s - loss: 9.4686 - accuracy10: 0.6742 - accuracy20: 0.6576 - accuracy30: 0.6307 - accuracy50: 0.5981 - val_loss: 12.2372 - val_accuracy10: 0.5116 - val_accuracy20: 0.5182 - val_accuracy30: 0.5143 - val_accuracy50: 0.5074 - 24s/epoch - 44ms/step
Epoch 11/50
538/538 - 24s - loss: 9.3747 - accuracy10: 0.6763 - accuracy20: 0.6586 - accuracy30: 0.6326 - accuracy50: 0.6001 - val_loss: 12.1486 - val_accuracy10: 0.7112 - val_accuracy20: 0.6838 - val_accuracy30: 0.6504 - val_accuracy50: 0.5949 - 24s/epoch - 45ms/step
Epoch 12/50
538/538 - 24s - loss: 9.2896 - accuracy10: 0.6774 - accuracy20: 0.6598 - accuracy30: 0.6334 - accuracy50: 0.6014 - val_loss: 12.4590 - val_accuracy10: 0.5079 - val_accuracy20: 0.5155 - val_accuracy30: 0.5124 - val_accuracy50: 0.5070 - 24s/epoch - 45ms/step
Epoch 13/50
538/538 - 24s - loss: 9.1981 - accuracy10: 0.6798 - accuracy20: 0.6618 - accuracy30: 0.6365 - accuracy50: 0.6043 - val_loss: 13.1692 - val_accuracy10: 0.6954 - val_accuracy20: 0.6641 - val_accuracy30: 0.6282 - val_accuracy50: 0.5742 - 24s/epoch - 44ms/step
Epoch 14/50
538/538 - 24s - loss: 9.1075 - accuracy10: 0.6821 - accuracy20: 0.6638 - accuracy30: 0.6381 - accuracy50: 0.6060 - val_loss: 16.2200 - val_accuracy10: 0.3466 - val_accuracy20: 0.3617 - val_accuracy30: 0.3678 - val_accuracy50: 0.3868 - 24s/epoch - 44ms/step
Epoch 15/50
538/538 - 24s - loss: 9.0366 - accuracy10: 0.6816 - accuracy20: 0.6631 - accuracy30: 0.6383 - accuracy50: 0.6070 - val_loss: 14.7373 - val_accuracy10: 0.5128 - val_accuracy20: 0.5038 - val_accuracy30: 0.4899 - val_accuracy50: 0.4712 - 24s/epoch - 44ms/step
Epoch 16/50
538/538 - 24s - loss: 8.9782 - accuracy10: 0.6847 - accuracy20: 0.6644 - accuracy30: 0.6392 - accuracy50: 0.6085 - val_loss: 14.4732 - val_accuracy10: 0.5809 - val_accuracy20: 0.5634 - val_accuracy30: 0.5423 - val_accuracy50: 0.5139 - 24s/epoch - 45ms/step
Epoch 17/50
538/538 - 24s - loss: 8.9051 - accuracy10: 0.6847 - accuracy20: 0.6655 - accuracy30: 0.6400 - accuracy50: 0.6107 - val_loss: 15.0915 - val_accuracy10: 0.7492 - val_accuracy20: 0.6980 - val_accuracy30: 0.6500 - val_accuracy50: 0.5801 - 24s/epoch - 44ms/step
Epoch 18/50
538/538 - 24s - loss: 8.8241 - accuracy10: 0.6875 - accuracy20: 0.6674 - accuracy30: 0.6415 - accuracy50: 0.6131 - val_loss: 14.7791 - val_accuracy10: 0.4899 - val_accuracy20: 0.4820 - val_accuracy30: 0.4716 - val_accuracy50: 0.4591 - 24s/epoch - 44ms/step
testing model: results/QRTEA/W7/deepLOB_L2/seq2seq
Evaluating performance on  test set...
2006/2006 - 32s - 32s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1096702
{'0': {'precision': 0.24962224750004244, 'recall': 0.6085804755893127, 'f1-score': 0.35403109781424386, 'support': 48319}, '1': {'precision': 0.9284612354756122, 'recall': 0.5427122180518749, 'f1-score': 0.685014068561344, 'support': 416965}, '2': {'precision': 0.22113965744400527, 'recall': 0.6986845939308163, 'f1-score': 0.33594868048397264, 'support': 48046}, 'accuracy': 0.5635108020181949, 'macro avg': {'precision': 0.4664077134732199, 'recall': 0.6166590958573347, 'f1-score': 0.45833128228652015, 'support': 513330}, 'weighted avg': {'precision': 0.7983601433943036, 'recall': 0.5635108020181949, 'f1-score': 0.6211877544961334, 'support': 513330}}
[[ 29406   9248   9665]
 [ 82107 226292 108566]
 [  6289   8188  33569]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0813215
{'0': {'precision': 0.31630630253858055, 'recall': 0.5641652991197971, 'f1-score': 0.40534876865771635, 'support': 67030}, '1': {'precision': 0.8780304076533879, 'recall': 0.5514732553555001, 'f1-score': 0.6774523210252453, 'support': 380450}, '2': {'precision': 0.2825954967640258, 'recall': 0.6644191343963554, 'f1-score': 0.3965342227378191, 'support': 65850}, 'accuracy': 0.5676192702550017, 'macro avg': {'precision': 0.49231073565199807, 'recall': 0.5933525629572175, 'f1-score': 0.49311177080692686, 'support': 513330}, 'weighted avg': {'precision': 0.7282987425492442, 'recall': 0.5676192702550017, 'f1-score': 0.6058851850943189, 'support': 513330}}
[[ 37816  15307  13907]
 [ 73479 209808  97163]
 [  8260  13838  43752]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0668105
{'0': {'precision': 0.3634506507908714, 'recall': 0.5250484828774136, 'f1-score': 0.42955407735895534, 'support': 83019}, '1': {'precision': 0.827593831186778, 'recall': 0.5571710336101497, 'f1-score': 0.6659777729114201, 'support': 349329}, '2': {'precision': 0.3240759468068969, 'recall': 0.6331530463559804, 'f1-score': 0.42871595916353816, 'support': 80982}, 'accuracy': 0.5639627530048896, 'macro avg': {'precision': 0.505040142928182, 'recall': 0.5717908542811813, 'f1-score': 0.5080826031446378, 'support': 513330}, 'weighted avg': {'precision': 0.6730955785887626, 'recall': 0.5639627530048896, 'f1-score': 0.5903118368040408, 'support': 513330}}
[[ 43589  21183  18247]
 [ 65998 194636  88695]
 [ 10344  19364  51274]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0687745
{'0': {'precision': 0.4243095307734091, 'recall': 0.46086190934340227, 'f1-score': 0.44183102084502635, 'support': 110174}, '1': {'precision': 0.729118209541531, 'recall': 0.5706950494248378, 'f1-score': 0.6402522050925156, 'support': 296612}, '2': {'precision': 0.3810378883102891, 'recall': 0.5775829704159784, 'f1-score': 0.4591617079221773, 'support': 106544}, 'accuracy': 0.5485516139715193, 'macro avg': {'precision': 0.5114885428750764, 'recall': 0.5363799763947394, 'f1-score': 0.5137483112865731, 'support': 513330}, 'weighted avg': {'precision': 0.5914526510901245, 'recall': 0.5485516139715193, 'f1-score': 0.5600796816011954, 'support': 513330}}
[[ 50775  32628  26771]
 [ 54145 169275  73192]
 [ 14745  30261  61538]]
Evaluating performance on  train set...
538/538 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0175481
{'0': {'precision': 0.30125998347562655, 'recall': 0.6075817538012914, 'f1-score': 0.402798554693793, 'support': 14403}, '1': {'precision': 0.9348722940712928, 'recall': 0.5541978859435397, 'f1-score': 0.6958761997320192, 'support': 109174}, '2': {'precision': 0.23287639936029245, 'recall': 0.7301575931232092, 'f1-score': 0.3531266239390265, 'support': 13960}, 'accuracy': 0.5776481964853094, 'macro avg': {'precision': 0.48966955896907055, 'recall': 0.6306457442893467, 'f1-score': 0.4839337927882796, 'support': 137537}, 'weighted avg': {'precision': 0.7972672801501302, 'recall': 0.5776481964853094, 'f1-score': 0.630395773377251, 'support': 137537}}
[[ 8751  2424  3228]
 [18321 60504 30349]
 [ 1976  1791 10193]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.98920345
{'0': {'precision': 0.3705393349553934, 'recall': 0.5624230611407468, 'f1-score': 0.4467486962190352, 'support': 19496}, '1': {'precision': 0.8882819550657863, 'recall': 0.5655715394618789, 'f1-score': 0.691110892113627, 'support': 99197}, '2': {'precision': 0.2925244496047872, 'recall': 0.695234557418807, 'f1-score': 0.41178689297501175, 'support': 18844}, 'accuracy': 0.5828904222136588, 'macro avg': {'precision': 0.5171152465419889, 'recall': 0.6077430526738109, 'f1-score': 0.5165488271025579, 'support': 137537}, 'weighted avg': {'precision': 0.7332664715625886, 'recall': 0.5828904222136588, 'f1-score': 0.6182020253292052, 'support': 137537}}
[[10965  4003  4528]
 [15937 56103 27157]
 [ 2690  3053 13101]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.98551285
{'0': {'precision': 0.40979190517879993, 'recall': 0.5162467124798507, 'f1-score': 0.45690043550082593, 'support': 23574}, '1': {'precision': 0.8415676767676767, 'recall': 0.570514506091682, 'f1-score': 0.68002637988338, 'support': 91272}, '2': {'precision': 0.3298450961622139, 'recall': 0.6681503679873078, 'f1-score': 0.4416575631782099, 'support': 22691}, 'accuracy': 0.5773210118004609, 'macro avg': {'precision': 0.5270682260362302, 'recall': 0.5849705288529468, 'f1-score': 0.5261947928541386, 'support': 137537}, 'weighted avg': {'precision': 0.6831362792822384, 'recall': 0.5773210118004609, 'f1-score': 0.6024559964030703, 'support': 137537}}
[[12170  5539  5865]
 [14262 52072 24938]
 [ 3266  4264 15161]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9974484
{'0': {'precision': 0.45950959560187526, 'recall': 0.4484234085971957, 'f1-score': 0.45389881894354583, 'support': 30382}, '1': {'precision': 0.7497040447221309, 'recall': 0.5834026382793608, 'f1-score': 0.6561805190786966, 'support': 78157}, '2': {'precision': 0.38004589105124503, 'recall': 0.6168701289744121, 'f1-score': 0.4703283990219021, 'support': 28998}, 'accuracy': 0.5606418636439648, 'macro avg': {'precision': 0.5297531771250837, 'recall': 0.5495653919503228, 'f1-score': 0.5268025790147148, 'support': 137537}, 'weighted avg': {'precision': 0.6076620131719301, 'recall': 0.5606418636439648, 'f1-score': 0.5723117245658521, 'support': 137537}}
[[13624  8451  8307]
 [11687 45597 20873]
 [ 4338  6772 17888]]
Evaluating performance on  val set...
153/153 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.99640656
{'0': {'precision': 0.3016482275908783, 'recall': 0.6121420389461627, 'f1-score': 0.4041442940331241, 'support': 4365}, '1': {'precision': 0.9248938428874734, 'recall': 0.5752913598996335, 'f1-score': 0.7093569989212075, 'support': 30289}, '2': {'precision': 0.2750176180408739, 'recall': 0.7101910828025477, 'f1-score': 0.39649479298958595, 'support': 4396}, 'accuracy': 0.5945966709346991, 'macro avg': {'precision': 0.5005198961730752, 'recall': 0.6325414938827814, 'f1-score': 0.5033320286479724, 'support': 39050}, 'weighted avg': {'precision': 0.7820686701551998, 'recall': 0.5945966709346991, 'f1-score': 0.6400203609157813, 'support': 39050}}
[[ 2672   795   898]
 [ 5532 17425  7332]
 [  654   620  3122]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9666484
{'0': {'precision': 0.37216610549943885, 'recall': 0.5635622025832767, 'f1-score': 0.4482898472353657, 'support': 5884}, '1': {'precision': 0.8699609882964889, 'recall': 0.589340772280135, 'f1-score': 0.7026695842450765, 'support': 27244}, '2': {'precision': 0.3414070523793222, 'recall': 0.6735900033772374, 'f1-score': 0.4531409746677269, 'support': 5922}, 'accuracy': 0.5982330345710627, 'macro avg': {'precision': 0.52784471539175, 'recall': 0.6088309927468831, 'f1-score': 0.5347001353827231, 'support': 39050}, 'weighted avg': {'precision': 0.7147978257131521, 'recall': 0.5982330345710627, 'f1-score': 0.6264985522737013, 'support': 39050}}
[[ 3316  1344  1224]
 [ 4717 16056  6471]
 [  877  1056  3989]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9624154
{'0': {'precision': 0.4183822702216222, 'recall': 0.5220381807973049, 'f1-score': 0.4644975957034909, 'support': 7124}, '1': {'precision': 0.8149991703998672, 'recall': 0.5947211235773671, 'f1-score': 0.6876502018245877, 'support': 24778}, '2': {'precision': 0.38236754966887415, 'recall': 0.6461947397873531, 'f1-score': 0.4804451841065114, 'support': 7148}, 'accuracy': 0.5908834827144687, 'macro avg': {'precision': 0.5385829967634546, 'recall': 0.5876513480540083, 'f1-score': 0.5441976605448633, 'support': 39050}, 'weighted avg': {'precision': 0.6634511647185624, 'recall': 0.5908834827144687, 'f1-score': 0.6090115172495428, 'support': 39050}}
[[ 3719  1869  1536]
 [ 4117 14736  5925]
 [ 1053  1476  4619]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9811277
{'0': {'precision': 0.46722517830861543, 'recall': 0.45277015907844215, 'f1-score': 0.45988410965010035, 'support': 9115}, '1': {'precision': 0.7102221723518851, 'recall': 0.6101310969732022, 'f1-score': 0.6563828684019495, 'support': 20748}, '2': {'precision': 0.4401678366819979, 'recall': 0.5937738108196364, 'f1-score': 0.5055607043558851, 'support': 9187}, 'accuracy': 0.5695518565941101, 'macro avg': {'precision': 0.5392050624474994, 'recall': 0.5522250222904269, 'f1-score': 0.5406092274693116, 'support': 39050}, 'weighted avg': {'precision': 0.5899684775374509, 'recall': 0.5695518565941101, 'f1-score': 0.575033587810034, 'support': 39050}}
[[ 4127  2844  2144]
 [ 3295 12659  4794]
 [ 1411  2321  5455]]
training model: results/QRTEA/W7/deepOF_L2/seq2seq
Epoch 1/50
538/538 - 21s - loss: 11.7171 - accuracy10: 0.4583 - accuracy20: 0.4555 - accuracy30: 0.4487 - accuracy50: 0.4424 - val_loss: 11.9493 - val_accuracy10: 0.7174 - val_accuracy20: 0.6801 - val_accuracy30: 0.6421 - val_accuracy50: 0.5707 - 21s/epoch - 40ms/step
Epoch 2/50
538/538 - 15s - loss: 10.6052 - accuracy10: 0.5614 - accuracy20: 0.5492 - accuracy30: 0.5344 - accuracy50: 0.5142 - val_loss: 11.4373 - val_accuracy10: 0.7405 - val_accuracy20: 0.7040 - val_accuracy30: 0.6657 - val_accuracy50: 0.5952 - 15s/epoch - 28ms/step
Epoch 3/50
538/538 - 15s - loss: 9.9841 - accuracy10: 0.6273 - accuracy20: 0.6095 - accuracy30: 0.5874 - accuracy50: 0.5583 - val_loss: 11.1858 - val_accuracy10: 0.7502 - val_accuracy20: 0.7153 - val_accuracy30: 0.6784 - val_accuracy50: 0.6103 - 15s/epoch - 28ms/step
Epoch 4/50
538/538 - 15s - loss: 9.6995 - accuracy10: 0.6487 - accuracy20: 0.6307 - accuracy30: 0.6074 - accuracy50: 0.5755 - val_loss: 10.6828 - val_accuracy10: 0.7303 - val_accuracy20: 0.6979 - val_accuracy30: 0.6613 - val_accuracy50: 0.6004 - 15s/epoch - 27ms/step
Epoch 5/50
538/538 - 14s - loss: 9.5525 - accuracy10: 0.6548 - accuracy20: 0.6356 - accuracy30: 0.6122 - accuracy50: 0.5824 - val_loss: 10.6657 - val_accuracy10: 0.7466 - val_accuracy20: 0.7129 - val_accuracy30: 0.6779 - val_accuracy50: 0.6140 - 14s/epoch - 27ms/step
Epoch 6/50
538/538 - 15s - loss: 9.4458 - accuracy10: 0.6592 - accuracy20: 0.6394 - accuracy30: 0.6168 - accuracy50: 0.5878 - val_loss: 10.5816 - val_accuracy10: 0.7447 - val_accuracy20: 0.7087 - val_accuracy30: 0.6720 - val_accuracy50: 0.6118 - 15s/epoch - 27ms/step
Epoch 7/50
538/538 - 15s - loss: 9.3483 - accuracy10: 0.6647 - accuracy20: 0.6449 - accuracy30: 0.6220 - accuracy50: 0.5924 - val_loss: 10.5094 - val_accuracy10: 0.7371 - val_accuracy20: 0.7019 - val_accuracy30: 0.6666 - val_accuracy50: 0.6127 - 15s/epoch - 28ms/step
Epoch 8/50
538/538 - 15s - loss: 9.2823 - accuracy10: 0.6680 - accuracy20: 0.6459 - accuracy30: 0.6240 - accuracy50: 0.5942 - val_loss: 10.4386 - val_accuracy10: 0.7230 - val_accuracy20: 0.6889 - val_accuracy30: 0.6549 - val_accuracy50: 0.6047 - 15s/epoch - 28ms/step
Epoch 9/50
538/538 - 15s - loss: 9.1990 - accuracy10: 0.6727 - accuracy20: 0.6502 - accuracy30: 0.6282 - accuracy50: 0.5991 - val_loss: 10.5037 - val_accuracy10: 0.7271 - val_accuracy20: 0.6909 - val_accuracy30: 0.6571 - val_accuracy50: 0.6047 - 15s/epoch - 28ms/step
Epoch 10/50
538/538 - 15s - loss: 9.1332 - accuracy10: 0.6771 - accuracy20: 0.6536 - accuracy30: 0.6301 - accuracy50: 0.6020 - val_loss: 10.5264 - val_accuracy10: 0.7308 - val_accuracy20: 0.6952 - val_accuracy30: 0.6604 - val_accuracy50: 0.6070 - 15s/epoch - 27ms/step
Epoch 11/50
538/538 - 15s - loss: 9.0599 - accuracy10: 0.6788 - accuracy20: 0.6576 - accuracy30: 0.6339 - accuracy50: 0.6049 - val_loss: 10.5374 - val_accuracy10: 0.7269 - val_accuracy20: 0.6909 - val_accuracy30: 0.6559 - val_accuracy50: 0.6038 - 15s/epoch - 28ms/step
Epoch 12/50
538/538 - 15s - loss: 8.9946 - accuracy10: 0.6784 - accuracy20: 0.6574 - accuracy30: 0.6348 - accuracy50: 0.6063 - val_loss: 10.5749 - val_accuracy10: 0.7159 - val_accuracy20: 0.6821 - val_accuracy30: 0.6472 - val_accuracy50: 0.5963 - 15s/epoch - 27ms/step
Epoch 13/50
538/538 - 14s - loss: 8.9285 - accuracy10: 0.6815 - accuracy20: 0.6607 - accuracy30: 0.6372 - accuracy50: 0.6098 - val_loss: 10.5646 - val_accuracy10: 0.7234 - val_accuracy20: 0.6887 - val_accuracy30: 0.6546 - val_accuracy50: 0.6033 - 14s/epoch - 27ms/step
Epoch 14/50
538/538 - 14s - loss: 8.8597 - accuracy10: 0.6829 - accuracy20: 0.6631 - accuracy30: 0.6409 - accuracy50: 0.6128 - val_loss: 10.8247 - val_accuracy10: 0.7321 - val_accuracy20: 0.6952 - val_accuracy30: 0.6582 - val_accuracy50: 0.6046 - 14s/epoch - 27ms/step
Epoch 15/50
538/538 - 14s - loss: 8.7897 - accuracy10: 0.6854 - accuracy20: 0.6646 - accuracy30: 0.6420 - accuracy50: 0.6148 - val_loss: 11.0588 - val_accuracy10: 0.7315 - val_accuracy20: 0.6935 - val_accuracy30: 0.6568 - val_accuracy50: 0.6011 - 14s/epoch - 27ms/step
Epoch 16/50
538/538 - 14s - loss: 8.7239 - accuracy10: 0.6857 - accuracy20: 0.6667 - accuracy30: 0.6443 - accuracy50: 0.6173 - val_loss: 11.1506 - val_accuracy10: 0.7297 - val_accuracy20: 0.6905 - val_accuracy30: 0.6542 - val_accuracy50: 0.6023 - 14s/epoch - 27ms/step
Epoch 17/50
538/538 - 14s - loss: 8.6838 - accuracy10: 0.6851 - accuracy20: 0.6656 - accuracy30: 0.6441 - accuracy50: 0.6170 - val_loss: 11.1583 - val_accuracy10: 0.7430 - val_accuracy20: 0.7012 - val_accuracy30: 0.6616 - val_accuracy50: 0.6071 - 14s/epoch - 26ms/step
Epoch 18/50
538/538 - 14s - loss: 8.5698 - accuracy10: 0.6899 - accuracy20: 0.6715 - accuracy30: 0.6496 - accuracy50: 0.6226 - val_loss: 11.1252 - val_accuracy10: 0.7125 - val_accuracy20: 0.6740 - val_accuracy30: 0.6369 - val_accuracy50: 0.5877 - 14s/epoch - 27ms/step
testing model: results/QRTEA/W7/deepOF_L2/seq2seq
Evaluating performance on  test set...
2006/2006 - 19s - 19s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.58829
{'0': {'precision': 0.3602279061125906, 'recall': 0.6019081915642204, 'f1-score': 0.45071404771682955, 'support': 48318}, '1': {'precision': 0.9151079563696012, 'recall': 0.8134866006974256, 'f1-score': 0.8613101986869318, 'support': 416962}, '2': {'precision': 0.42295457848250473, 'recall': 0.5451972109480695, 'f1-score': 0.4763584782134284, 'support': 48045}, 'accuracy': 0.7684605269566065, 'macro avg': {'precision': 0.5660968136548988, 'recall': 0.6535306677365719, 'f1-score': 0.5961275748723966, 'support': 513325}, 'weighted avg': {'precision': 0.8168150555584118, 'recall': 0.7684605269566065, 'f1-score': 0.7866319924185389, 'support': 513325}}
[[ 29083  15645   3590]
 [ 45622 339193  32147]
 [  6030  15821  26194]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.660572
{'0': {'precision': 0.4132779541599617, 'recall': 0.5670595255855587, 'f1-score': 0.478107193620206, 'support': 67030}, '1': {'precision': 0.8567295497780596, 'recall': 0.7954758719302719, 'f1-score': 0.8249672548749688, 'support': 380449}, '2': {'precision': 0.4814624476910653, 'recall': 0.4979801354676062, 'f1-score': 0.4895820113325022, 'support': 65846}, 'accuracy': 0.7274884332537865, 'macro avg': {'precision': 0.5838233172096955, 'recall': 0.6201718443278122, 'f1-score': 0.5975521532758924, 'support': 513325}, 'weighted avg': {'precision': 0.7506867931262282, 'recall': 0.7274884332537865, 'f1-score': 0.7366532108439865, 'support': 513325}}
[[ 38010  24807   4213]
 [ 46709 302638  31102]
 [  7253  25803  32790]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7295233
{'0': {'precision': 0.4461045040737863, 'recall': 0.5394974583825195, 'f1-score': 0.48837615039036947, 'support': 83018}, '1': {'precision': 0.8005291878322156, 'recall': 0.7777481972581721, 'f1-score': 0.7889742811633805, 'support': 349329}, '2': {'precision': 0.5099335046709909, 'recall': 0.46308874015164614, 'f1-score': 0.4853834853122957, 'support': 80978}, 'accuracy': 0.6895787269273852, 'macro avg': {'precision': 0.5855223988589976, 'recall': 0.5934447985974459, 'f1-score': 0.5875779722886819, 'support': 513325}, 'weighted avg': {'precision': 0.6973674761928313, 'recall': 0.6895787269273852, 'f1-score': 0.6924677188744933, 'support': 513325}}
[[ 44788  33226   5004]
 [ 46604 271690  31035]
 [  9006  34472  37500]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.82947695
{'0': {'precision': 0.49198058701178643, 'recall': 0.48306284718440257, 'f1-score': 0.4874809363078036, 'support': 110172}, '1': {'precision': 0.6925510023386885, 'recall': 0.7647499089719904, 'f1-score': 0.7268619842152316, 'support': 296612}, '2': {'precision': 0.5455189651618223, 'recall': 0.3974150796407017, 'f1-score': 0.4598359008889154, 'support': 106541}, 'accuracy': 0.628052403448108, 'macro avg': {'precision': 0.5766835181707658, 'recall': 0.5484092785990315, 'f1-score': 0.5580596071373168, 'support': 513325}, 'weighted avg': {'precision': 0.6189871118789291, 'recall': 0.628052403448108, 'f1-score': 0.6200635334214338, 'support': 513325}}
[[ 53220  49649   7303]
 [ 41806 226834  27972]
 [ 13149  51051  42341]]
Evaluating performance on  train set...
538/538 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.61422116
{'0': {'precision': 0.4064259540620252, 'recall': 0.627154875189629, 'f1-score': 0.4932212581344902, 'support': 14502}, '1': {'precision': 0.9140840128858033, 'recall': 0.7882427365159114, 'f1-score': 0.8465120858563481, 'support': 109073}, '2': {'precision': 0.37459715639810426, 'recall': 0.566189111747851, 'f1-score': 0.45088419851682826, 'support': 13960}, 'accuracy': 0.7487185080161414, 'macro avg': {'precision': 0.5650357077819775, 'recall': 0.6605289078177972, 'f1-score': 0.5968725141692222, 'support': 137535}, 'weighted avg': {'precision': 0.8057967137573582, 'recall': 0.7487185080161414, 'f1-score': 0.769103507015456, 'support': 137535}}
[[ 9095  4094  1313]
 [11214 85976 11883]
 [ 2069  3987  7904]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.66892
{'0': {'precision': 0.4631077594760865, 'recall': 0.596432040075653, 'f1-score': 0.5213816524420215, 'support': 19563}, '1': {'precision': 0.8596956770011085, 'recall': 0.7744570973240673, 'f1-score': 0.8148533344653395, 'support': 99143}, '2': {'precision': 0.43379511008815735, 'recall': 0.5305114451112646, 'f1-score': 0.47730313455657497, 'support': 18829}, 'accuracy': 0.7157378121932599, 'macro avg': {'precision': 0.5855328488551175, 'recall': 0.6338001941703283, 'f1-score': 0.6045127071546453, 'support': 137535}, 'weighted avg': {'precision': 0.7449777418940743, 'recall': 0.7157378121932599, 'f1-score': 0.7268981286667843, 'support': 137535}}
[[11668  6373  1522]
 [10845 76782 11516]
 [ 2682  6158  9989]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7301109
{'0': {'precision': 0.49086932750136686, 'recall': 0.5690441984281247, 'f1-score': 0.5270738341715425, 'support': 23666}, '1': {'precision': 0.8090082286704201, 'recall': 0.7580420500784188, 'f1-score': 0.7826963365607836, 'support': 91177}, '2': {'precision': 0.4653585762354563, 'recall': 0.5058610964216465, 'f1-score': 0.4847653033214384, 'support': 22692}, 'accuracy': 0.6839131857345403, 'macro avg': {'precision': 0.5884120441357478, 'recall': 0.6109824483093966, 'f1-score': 0.5981784913512548, 'support': 137535}, 'weighted avg': {'precision': 0.6975662455525156, 'recall': 0.6839131857345403, 'f1-score': 0.68955485877105, 'support': 137535}}
[[13467  8392  1807]
 [10680 69116 11381]
 [ 3288  7925 11479]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8168239
{'0': {'precision': 0.5221989458034869, 'recall': 0.5074700377606305, 'f1-score': 0.5147291468918087, 'support': 30455}, '1': {'precision': 0.7095625883844541, 'recall': 0.7451542696197669, 'f1-score': 0.7269230288875845, 'support': 78110}, '2': {'precision': 0.5041102234572189, 'recall': 0.45088022091819124, 'f1-score': 0.47601173448005685, 'support': 28970}, 'accuracy': 0.6305376813174828, 'macro avg': {'precision': 0.5786239192150533, 'recall': 0.5678348427661962, 'f1-score': 0.57255463675315, 'support': 137535}, 'weighted avg': {'precision': 0.624797875789512, 'recall': 0.6305376813174828, 'f1-score': 0.6270846977342968, 'support': 137535}}
[[15455 12405  2595]
 [ 9652 58204 10254]
 [ 4489 11419 13062]]
Evaluating performance on  val set...
153/153 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.654156
{'0': {'precision': 0.3747343251859724, 'recall': 0.6494014732965009, 'f1-score': 0.47523584905660377, 'support': 4344}, '1': {'precision': 0.9073650142090306, 'recall': 0.7580373924225937, 'f1-score': 0.8260065034223811, 'support': 30327}, '2': {'precision': 0.39233753637245394, 'recall': 0.5542361269696278, 'f1-score': 0.45944155229531475, 'support': 4379}, 'accuracy': 0.7230985915492958, 'macro avg': {'precision': 0.5581456252558189, 'recall': 0.6538916642295741, 'f1-score': 0.5868946349247666, 'support': 39050}, 'weighted avg': {'precision': 0.7903598147580055, 'recall': 0.7230985915492958, 'f1-score': 0.7458801105017572, 'support': 39050}}
[[ 2821  1097   426]
 [ 4005 22989  3333]
 [  702  1250  2427]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7155007
{'0': {'precision': 0.4330410049774828, 'recall': 0.6215342745364858, 'f1-score': 0.510442131731508, 'support': 5879}, '1': {'precision': 0.8447303563223192, 'recall': 0.7413028336815866, 'f1-score': 0.7896442656878441, 'support': 27279}, '2': {'precision': 0.4465757530346171, 'recall': 0.5057705363204344, 'f1-score': 0.47433346597692, 'support': 5892}, 'accuracy': 0.6877336747759283, 'macro avg': {'precision': 0.5747823714448064, 'recall': 0.622869214846169, 'f1-score': 0.5914732877987573, 'support': 39050}, 'weighted avg': {'precision': 0.7226753340655347, 'recall': 0.6877336747759283, 'f1-score': 0.700035031950941, 'support': 39050}}
[[ 3654  1745   480]
 [ 3844 20222  3213]
 [  940  1972  2980]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7758535
{'0': {'precision': 0.4632086851628468, 'recall': 0.5943436048965809, 'f1-score': 0.5206458769875509, 'support': 7107}, '1': {'precision': 0.7856171892128919, 'recall': 0.7216627728993796, 'f1-score': 0.7522831769225923, 'support': 24826}, '2': {'precision': 0.47810833567218636, 'recall': 0.478712940845862, 'f1-score': 0.47841044723723936, 'support': 7117}, 'accuracy': 0.6542125480153649, 'macro avg': {'precision': 0.5756447366826417, 'recall': 0.5982397728806075, 'f1-score': 0.5837798337157941, 'support': 39050}, 'weighted avg': {'precision': 0.6708950957703088, 'recall': 0.6542125480153649, 'f1-score': 0.6602115121899677, 'support': 39050}}
[[ 4224  2359   524]
 [ 3715 17916  3195]
 [ 1180  2530  3407]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8581378
{'0': {'precision': 0.5014271151885831, 'recall': 0.5398968280100976, 'f1-score': 0.519951376777126, 'support': 9111}, '1': {'precision': 0.6757029031962634, 'recall': 0.7098667436378506, 'f1-score': 0.6923636363636363, 'support': 20787}, '2': {'precision': 0.5276952175087815, 'recall': 0.426791958041958, 'f1-score': 0.47191011235955055, 'support': 9152}, 'accuracy': 0.6038668373879641, 'macro avg': {'precision': 0.5682750786312093, 'recall': 0.5588518432299687, 'f1-score': 0.561408375166771, 'support': 39050}, 'weighted avg': {'precision': 0.6003535294715564, 'recall': 0.6038668373879641, 'f1-score': 0.6004701984947993, 'support': 39050}}
[[ 4919  3474   718]
 [ 3253 14756  2778]
 [ 1638  3608  3906]]
training model: results/QRTEA/W7/deepVOL_L2/seq2seq
Epoch 1/50
538/538 - 21s - loss: 11.6286 - accuracy10: 0.5068 - accuracy20: 0.5138 - accuracy30: 0.5108 - accuracy50: 0.5005 - val_loss: 12.2133 - val_accuracy10: 0.7123 - val_accuracy20: 0.6836 - val_accuracy30: 0.6496 - val_accuracy50: 0.5831 - 21s/epoch - 39ms/step
Epoch 2/50
538/538 - 15s - loss: 10.5554 - accuracy10: 0.6228 - accuracy20: 0.6126 - accuracy30: 0.5929 - accuracy50: 0.5616 - val_loss: 11.7504 - val_accuracy10: 0.7303 - val_accuracy20: 0.7008 - val_accuracy30: 0.6679 - val_accuracy50: 0.6008 - 15s/epoch - 27ms/step
Epoch 3/50
538/538 - 14s - loss: 10.2225 - accuracy10: 0.6484 - accuracy20: 0.6333 - accuracy30: 0.6104 - accuracy50: 0.5767 - val_loss: 11.8668 - val_accuracy10: 0.7500 - val_accuracy20: 0.7144 - val_accuracy30: 0.6743 - val_accuracy50: 0.6018 - 14s/epoch - 27ms/step
Epoch 4/50
538/538 - 15s - loss: 10.0332 - accuracy10: 0.6630 - accuracy20: 0.6456 - accuracy30: 0.6207 - accuracy50: 0.5831 - val_loss: 11.6534 - val_accuracy10: 0.7561 - val_accuracy20: 0.7203 - val_accuracy30: 0.6811 - val_accuracy50: 0.6083 - 15s/epoch - 27ms/step
Epoch 5/50
538/538 - 15s - loss: 9.9265 - accuracy10: 0.6686 - accuracy20: 0.6513 - accuracy30: 0.6254 - accuracy50: 0.5892 - val_loss: 11.4629 - val_accuracy10: 0.7337 - val_accuracy20: 0.7051 - val_accuracy30: 0.6710 - val_accuracy50: 0.6047 - 15s/epoch - 27ms/step
Epoch 6/50
538/538 - 14s - loss: 9.8066 - accuracy10: 0.6696 - accuracy20: 0.6519 - accuracy30: 0.6258 - accuracy50: 0.5904 - val_loss: 10.8321 - val_accuracy10: 0.7341 - val_accuracy20: 0.7095 - val_accuracy30: 0.6758 - val_accuracy50: 0.6139 - 14s/epoch - 27ms/step
Epoch 7/50
538/538 - 14s - loss: 9.6965 - accuracy10: 0.6730 - accuracy20: 0.6532 - accuracy30: 0.6275 - accuracy50: 0.5938 - val_loss: 10.8295 - val_accuracy10: 0.7363 - val_accuracy20: 0.7078 - val_accuracy30: 0.6740 - val_accuracy50: 0.6091 - 14s/epoch - 26ms/step
Epoch 8/50
538/538 - 14s - loss: 9.5825 - accuracy10: 0.6745 - accuracy20: 0.6536 - accuracy30: 0.6272 - accuracy50: 0.5942 - val_loss: 10.8360 - val_accuracy10: 0.7404 - val_accuracy20: 0.7125 - val_accuracy30: 0.6791 - val_accuracy50: 0.6156 - 14s/epoch - 26ms/step
Epoch 9/50
538/538 - 14s - loss: 9.4989 - accuracy10: 0.6754 - accuracy20: 0.6539 - accuracy30: 0.6282 - accuracy50: 0.5962 - val_loss: 10.6845 - val_accuracy10: 0.7210 - val_accuracy20: 0.6944 - val_accuracy30: 0.6645 - val_accuracy50: 0.6077 - 14s/epoch - 26ms/step
Epoch 10/50
538/538 - 14s - loss: 9.4194 - accuracy10: 0.6750 - accuracy20: 0.6530 - accuracy30: 0.6272 - accuracy50: 0.5963 - val_loss: 10.6438 - val_accuracy10: 0.7218 - val_accuracy20: 0.6964 - val_accuracy30: 0.6634 - val_accuracy50: 0.6078 - 14s/epoch - 26ms/step
Epoch 11/50
538/538 - 14s - loss: 9.3644 - accuracy10: 0.6755 - accuracy20: 0.6547 - accuracy30: 0.6297 - accuracy50: 0.5997 - val_loss: 10.6652 - val_accuracy10: 0.7219 - val_accuracy20: 0.6949 - val_accuracy30: 0.6629 - val_accuracy50: 0.6084 - 14s/epoch - 26ms/step
Epoch 12/50
538/538 - 14s - loss: 9.2983 - accuracy10: 0.6781 - accuracy20: 0.6558 - accuracy30: 0.6313 - accuracy50: 0.6012 - val_loss: 10.6433 - val_accuracy10: 0.7177 - val_accuracy20: 0.6911 - val_accuracy30: 0.6617 - val_accuracy50: 0.6080 - 14s/epoch - 26ms/step
Epoch 13/50
538/538 - 14s - loss: 9.2305 - accuracy10: 0.6801 - accuracy20: 0.6581 - accuracy30: 0.6331 - accuracy50: 0.6040 - val_loss: 10.5997 - val_accuracy10: 0.7082 - val_accuracy20: 0.6805 - val_accuracy30: 0.6492 - val_accuracy50: 0.5992 - 14s/epoch - 26ms/step
Epoch 14/50
538/538 - 14s - loss: 9.1931 - accuracy10: 0.6800 - accuracy20: 0.6591 - accuracy30: 0.6338 - accuracy50: 0.6043 - val_loss: 10.6345 - val_accuracy10: 0.7192 - val_accuracy20: 0.6907 - val_accuracy30: 0.6588 - val_accuracy50: 0.6059 - 14s/epoch - 26ms/step
Epoch 15/50
538/538 - 14s - loss: 9.1398 - accuracy10: 0.6799 - accuracy20: 0.6598 - accuracy30: 0.6356 - accuracy50: 0.6059 - val_loss: 10.7665 - val_accuracy10: 0.7143 - val_accuracy20: 0.6890 - val_accuracy30: 0.6584 - val_accuracy50: 0.6024 - 14s/epoch - 26ms/step
Epoch 16/50
538/538 - 14s - loss: 9.0892 - accuracy10: 0.6820 - accuracy20: 0.6615 - accuracy30: 0.6360 - accuracy50: 0.6080 - val_loss: 10.7749 - val_accuracy10: 0.7089 - val_accuracy20: 0.6842 - val_accuracy30: 0.6517 - val_accuracy50: 0.5994 - 14s/epoch - 26ms/step
Epoch 17/50
538/538 - 14s - loss: 9.0233 - accuracy10: 0.6826 - accuracy20: 0.6618 - accuracy30: 0.6377 - accuracy50: 0.6100 - val_loss: 10.9658 - val_accuracy10: 0.7168 - val_accuracy20: 0.6887 - val_accuracy30: 0.6559 - val_accuracy50: 0.5992 - 14s/epoch - 26ms/step
Epoch 18/50
538/538 - 14s - loss: 9.0062 - accuracy10: 0.6821 - accuracy20: 0.6614 - accuracy30: 0.6365 - accuracy50: 0.6085 - val_loss: 10.7880 - val_accuracy10: 0.7097 - val_accuracy20: 0.6833 - val_accuracy30: 0.6530 - val_accuracy50: 0.5992 - 14s/epoch - 26ms/step
Epoch 19/50
538/538 - 14s - loss: 8.9373 - accuracy10: 0.6855 - accuracy20: 0.6636 - accuracy30: 0.6380 - accuracy50: 0.6099 - val_loss: 10.9190 - val_accuracy10: 0.7039 - val_accuracy20: 0.6771 - val_accuracy30: 0.6449 - val_accuracy50: 0.5925 - 14s/epoch - 26ms/step
Epoch 20/50
538/538 - 14s - loss: 8.8848 - accuracy10: 0.6870 - accuracy20: 0.6653 - accuracy30: 0.6404 - accuracy50: 0.6136 - val_loss: 10.9958 - val_accuracy10: 0.7162 - val_accuracy20: 0.6825 - val_accuracy30: 0.6506 - val_accuracy50: 0.5970 - 14s/epoch - 26ms/step
Epoch 21/50
538/538 - 14s - loss: 8.8389 - accuracy10: 0.6870 - accuracy20: 0.6645 - accuracy30: 0.6400 - accuracy50: 0.6145 - val_loss: 11.1544 - val_accuracy10: 0.7172 - val_accuracy20: 0.6834 - val_accuracy30: 0.6485 - val_accuracy50: 0.5923 - 14s/epoch - 26ms/step
Epoch 22/50
538/538 - 14s - loss: 8.8140 - accuracy10: 0.6880 - accuracy20: 0.6675 - accuracy30: 0.6422 - accuracy50: 0.6155 - val_loss: 11.1280 - val_accuracy10: 0.7001 - val_accuracy20: 0.6714 - val_accuracy30: 0.6392 - val_accuracy50: 0.5872 - 14s/epoch - 26ms/step
Epoch 23/50
538/538 - 14s - loss: 8.8301 - accuracy10: 0.6860 - accuracy20: 0.6645 - accuracy30: 0.6411 - accuracy50: 0.6153 - val_loss: 10.9743 - val_accuracy10: 0.6965 - val_accuracy20: 0.6660 - val_accuracy30: 0.6322 - val_accuracy50: 0.5819 - 14s/epoch - 26ms/step
testing model: results/QRTEA/W7/deepVOL_L2/seq2seq
Evaluating performance on  test set...
2006/2006 - 18s - 18s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.68652314
{'0': {'precision': 0.3284461389682425, 'recall': 0.611519278130756, 'f1-score': 0.4273585860777252, 'support': 48319}, '1': {'precision': 0.9244961456583313, 'recall': 0.7311405033995659, 'f1-score': 0.816527681616878, 'support': 416965}, '2': {'precision': 0.3137946137657704, 'recall': 0.6113724347500312, 'f1-score': 0.4147259186050615, 'support': 48046}, 'accuracy': 0.708670835524906, 'macro avg': {'precision': 0.5222456327974481, 'recall': 0.6513440720934511, 'f1-score': 0.552870728766555, 'support': 513330}, 'weighted avg': {'precision': 0.8112311775587299, 'recall': 0.708670835524906, 'f1-score': 0.7422884416873549, 'support': 513330}}
[[ 29548  13151   5620]
 [ 53490 304860  58615]
 [  6925  11747  29374]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7345489
{'0': {'precision': 0.39174141985972066, 'recall': 0.5615992839027302, 'f1-score': 0.4615384615384615, 'support': 67030}, '1': {'precision': 0.8684386845126689, 'recall': 0.7256696017873571, 'f1-score': 0.7906609102820199, 'support': 380450}, '2': {'precision': 0.37661958502380927, 'recall': 0.5681093394077449, 'f1-score': 0.45295766462244447, 'support': 65850}, 'accuracy': 0.6840336625562503, 'macro avg': {'precision': 0.5455998964653995, 'recall': 0.6184594083659439, 'f1-score': 0.5683856788143086, 'support': 513330}, 'weighted avg': {'precision': 0.7431015615098666, 'recall': 0.6840336625562503, 'f1-score': 0.7043639152379667, 'support': 513330}}
[[ 37644  22002   7384]
 [ 49832 276081  54537]
 [  8618  19822  37410]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7878071
{'0': {'precision': 0.43054665865124025, 'recall': 0.5262409809802575, 'f1-score': 0.473608325654507, 'support': 83019}, '1': {'precision': 0.8137949010344546, 'recall': 0.7150107778054499, 'f1-score': 0.7612113602355185, 'support': 349329}, '2': {'precision': 0.41298339908895115, 'recall': 0.5351312637376207, 'f1-score': 0.4661890316056714, 'support': 80982}, 'accuracy': 0.6561042604172754, 'macro avg': {'precision': 0.552441652924882, 'recall': 0.5921276741744427, 'f1-score': 0.5670029058318989, 'support': 513330}, 'weighted avg': {'precision': 0.6885822641635083, 'recall': 0.6561042604172754, 'f1-score': 0.6681561821921871, 'support': 513330}}
[[ 43688  29935   9396]
 [ 47353 249774  52202]
 [ 10430  27216  43336]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.86856455
{'0': {'precision': 0.47830280564722794, 'recall': 0.4591010583259208, 'f1-score': 0.4685052680328817, 'support': 110174}, '1': {'precision': 0.708038090890477, 'recall': 0.7111580111391312, 'f1-score': 0.7095946216429421, 'support': 296612}, '2': {'precision': 0.46147182199525805, 'recall': 0.4749680883015468, 'f1-score': 0.4681226989324897, 'support': 106544}, 'accuracy': 0.6080377145306138, 'macro avg': {'precision': 0.5492709061776543, 'recall': 0.5484090525888663, 'f1-score': 0.5487408628694378, 'support': 513330}, 'weighted avg': {'precision': 0.6075549477475437, 'recall': 0.6080377145306138, 'f1-score': 0.6077319543959523, 'support': 513330}}
[[ 50581  45338  14255]
 [ 40874 210938  44800]
 [ 14296  41643  50605]]
Evaluating performance on  train set...
538/538 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6571443
{'0': {'precision': 0.3990281486669877, 'recall': 0.6328542664722627, 'f1-score': 0.4894485313859206, 'support': 14403}, '1': {'precision': 0.9258742831440459, 'recall': 0.7541905581915108, 'f1-score': 0.831260348099988, 'support': 109174}, '2': {'precision': 0.33523521192361433, 'recall': 0.6186962750716333, 'f1-score': 0.4348504682307925, 'support': 13960}, 'accuracy': 0.7277314468106764, 'macro avg': {'precision': 0.553379214578216, 'recall': 0.668580366578469, 'f1-score': 0.5851864492389004, 'support': 137537}, 'weighted avg': {'precision': 0.8107526336307491, 'recall': 0.7277314468106764, 'f1-score': 0.7552299161499914, 'support': 137537}}
[[ 9115  3665  1623]
 [11332 82338 15504]
 [ 2396  2927  8637]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6947818
{'0': {'precision': 0.46101818476367906, 'recall': 0.5838633565859663, 'f1-score': 0.515219408423292, 'support': 19496}, '1': {'precision': 0.8722921708226656, 'recall': 0.7521900863937417, 'f1-score': 0.8078014030833189, 'support': 99197}, '2': {'precision': 0.3978833266195481, 'recall': 0.5765760984928889, 'f1-score': 0.4708457021516327, 'support': 18844}, 'accuracy': 0.704268669521656, 'macro avg': {'precision': 0.5770645607352977, 'recall': 0.6375431804908657, 'f1-score': 0.5979555045527478, 'support': 137537}, 'weighted avg': {'precision': 0.7489947461851532, 'recall': 0.704268669521656, 'f1-score': 0.7201611913857497, 'support': 137537}}
[[11383  6059  2054]
 [10194 74615 14388]
 [ 3114  4865 10865]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7495306
{'0': {'precision': 0.49030439254828756, 'recall': 0.5459404428607788, 'f1-score': 0.5166288661862996, 'support': 23574}, '1': {'precision': 0.8213109374430279, 'recall': 0.7403694451748619, 'f1-score': 0.7787426029536327, 'support': 91272}, '2': {'precision': 0.4308365792285685, 'recall': 0.5508351328720638, 'f1-score': 0.4835016053537581, 'support': 22691}, 'accuracy': 0.675774518856744, 'macro avg': {'precision': 0.5808173030732946, 'recall': 0.6123816736359015, 'f1-score': 0.5929576914978968, 'support': 137537}, 'weighted avg': {'precision': 0.700155161531143, 'recall': 0.675774518856744, 'f1-score': 0.6851068343452447, 'support': 137537}}
[[12870  8161  2543]
 [ 9728 67575 13969]
 [ 3651  6541 12499]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8311648
{'0': {'precision': 0.5255179934569247, 'recall': 0.4758409584622474, 'f1-score': 0.49944724659711187, 'support': 30382}, '1': {'precision': 0.7233454728117543, 'recall': 0.7369781337564134, 'f1-score': 0.7300981703182138, 'support': 78157}, '2': {'precision': 0.4753429614764615, 'recall': 0.4982757431547003, 'f1-score': 0.48653927098240596, 'support': 28998}, 'accuracy': 0.6289652966110938, 'macro avg': {'precision': 0.5747354759150468, 'recall': 0.5703649451244537, 'f1-score': 0.5720282292992439, 'support': 137537}, 'weighted avg': {'precision': 0.6273569657085075, 'recall': 0.6289652966110938, 'f1-score': 0.6277958274764021, 'support': 137537}}
[[14457 12089  3836]
 [ 8445 57600 12112]
 [ 4608  9941 14449]]
Evaluating performance on  val set...
153/153 - 1s - 1s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.687534
{'0': {'precision': 0.37168141592920356, 'recall': 0.6446735395189004, 'f1-score': 0.47151474530831106, 'support': 4365}, '1': {'precision': 0.9175334323922734, 'recall': 0.7339298095017993, 'f1-score': 0.8155254324339196, 'support': 30289}, '2': {'precision': 0.3603640877120397, 'recall': 0.5944040036396724, 'f1-score': 0.4486992358547265, 'support': 4396}, 'accuracy': 0.7082458386683739, 'macro avg': {'precision': 0.5498596453445056, 'recall': 0.6576691175534574, 'f1-score': 0.578579804532319, 'support': 39050}, 'weighted avg': {'precision': 0.7937956477296458, 'recall': 0.7082458386683739, 'f1-score': 0.7357770429469692, 'support': 39050}}
[[ 2814  1054   497]
 [ 3918 22230  4141]
 [  839   944  2613]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7327714
{'0': {'precision': 0.43101538461538463, 'recall': 0.5951733514615908, 'f1-score': 0.4999643086587194, 'support': 5884}, '1': {'precision': 0.8546993780234969, 'recall': 0.7263250623990604, 'f1-score': 0.7853004206683071, 'support': 27244}, '2': {'precision': 0.41837128521806255, 'recall': 0.5491388044579534, 'f1-score': 0.47491785323110625, 'support': 5922}, 'accuracy': 0.6796927016645327, 'macro avg': {'precision': 0.5680286826189814, 'recall': 0.6235457394395348, 'f1-score': 0.5867275275193776, 'support': 39050}, 'weighted avg': {'precision': 0.7246893502947614, 'recall': 0.6796927016645327, 'f1-score': 0.6952363170209955, 'support': 39050}}
[[ 3502  1754   628]
 [ 3563 19788  3893]
 [ 1060  1610  3252]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.78933465
{'0': {'precision': 0.4667364503372877, 'recall': 0.563307130825379, 'f1-score': 0.5104948479837171, 'support': 7124}, '1': {'precision': 0.79528233808407, 'recall': 0.7116393574945516, 'f1-score': 0.751139510117146, 'support': 24778}, '2': {'precision': 0.44818840579710145, 'recall': 0.5191662003357582, 'f1-score': 0.4810733730878921, 'support': 7148}, 'accuracy': 0.6493469910371319, 'macro avg': {'precision': 0.5700690647394865, 'recall': 0.5980375628852296, 'f1-score': 0.5809025770629184, 'support': 39050}, 'weighted avg': {'precision': 0.671810165682141, 'recall': 0.6493469910371319, 'f1-score': 0.6578031382727502, 'support': 39050}}
[[ 4013  2344   767]
 [ 3343 17633  3802]
 [ 1242  2195  3711]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.87293714
{'0': {'precision': 0.5054492882562278, 'recall': 0.4986286341195831, 'f1-score': 0.5020157949964101, 'support': 9115}, '1': {'precision': 0.6828435043055036, 'recall': 0.7032485058800848, 'f1-score': 0.6928958115680501, 'support': 20748}, '2': {'precision': 0.49321058688147296, 'recall': 0.4665287906824861, 'f1-score': 0.4794987973373608, 'support': 9187}, 'accuracy': 0.5997951344430218, 'macro avg': {'precision': 0.5605011264810681, 'recall': 0.5561353102273846, 'f1-score': 0.558136801300607, 'support': 39050}, 'weighted avg': {'precision': 0.5968228668749347, 'recall': 0.5997951344430218, 'f1-score': 0.5981365357476188, 'support': 39050}}
[[ 4545  3472  1098]
 [ 2851 14591  3306]
 [ 1596  3305  4286]]
training model: results/QRTEA/W7/deepVOL_L3/seq2seq
Epoch 1/50
538/538 - 27s - loss: 12.5360 - accuracy10: 0.4019 - accuracy20: 0.4102 - accuracy30: 0.4157 - accuracy50: 0.4228 - val_loss: 12.3002 - val_accuracy10: 0.5629 - val_accuracy20: 0.5601 - val_accuracy30: 0.5519 - val_accuracy50: 0.5231 - 27s/epoch - 51ms/step
Epoch 2/50
538/538 - 22s - loss: 11.0044 - accuracy10: 0.5548 - accuracy20: 0.5568 - accuracy30: 0.5529 - accuracy50: 0.5380 - val_loss: 11.6190 - val_accuracy10: 0.6401 - val_accuracy20: 0.6266 - val_accuracy30: 0.6090 - val_accuracy50: 0.5666 - 22s/epoch - 40ms/step
Epoch 3/50
538/538 - 21s - loss: 10.3694 - accuracy10: 0.6265 - accuracy20: 0.6124 - accuracy30: 0.5955 - accuracy50: 0.5692 - val_loss: 11.5810 - val_accuracy10: 0.7317 - val_accuracy20: 0.7022 - val_accuracy30: 0.6688 - val_accuracy50: 0.6042 - 21s/epoch - 39ms/step
Epoch 4/50
538/538 - 21s - loss: 10.0828 - accuracy10: 0.6477 - accuracy20: 0.6291 - accuracy30: 0.6071 - accuracy50: 0.5756 - val_loss: 11.4450 - val_accuracy10: 0.7509 - val_accuracy20: 0.7173 - val_accuracy30: 0.6812 - val_accuracy50: 0.6113 - 21s/epoch - 39ms/step
Epoch 5/50
538/538 - 21s - loss: 9.9174 - accuracy10: 0.6532 - accuracy20: 0.6330 - accuracy30: 0.6092 - accuracy50: 0.5784 - val_loss: 11.1486 - val_accuracy10: 0.7457 - val_accuracy20: 0.7151 - val_accuracy30: 0.6821 - val_accuracy50: 0.6143 - 21s/epoch - 38ms/step
Epoch 6/50
538/538 - 21s - loss: 9.7572 - accuracy10: 0.6664 - accuracy20: 0.6439 - accuracy30: 0.6196 - accuracy50: 0.5874 - val_loss: 10.9271 - val_accuracy10: 0.7172 - val_accuracy20: 0.6937 - val_accuracy30: 0.6660 - val_accuracy50: 0.6090 - 21s/epoch - 39ms/step
Epoch 7/50
538/538 - 21s - loss: 9.6591 - accuracy10: 0.6684 - accuracy20: 0.6466 - accuracy30: 0.6227 - accuracy50: 0.5917 - val_loss: 10.7387 - val_accuracy10: 0.7053 - val_accuracy20: 0.6847 - val_accuracy30: 0.6584 - val_accuracy50: 0.6032 - 21s/epoch - 39ms/step
Epoch 8/50
538/538 - 22s - loss: 9.5525 - accuracy10: 0.6740 - accuracy20: 0.6521 - accuracy30: 0.6284 - accuracy50: 0.5970 - val_loss: 10.6228 - val_accuracy10: 0.7025 - val_accuracy20: 0.6802 - val_accuracy30: 0.6554 - val_accuracy50: 0.6034 - 22s/epoch - 40ms/step
Epoch 9/50
538/538 - 21s - loss: 9.4769 - accuracy10: 0.6765 - accuracy20: 0.6539 - accuracy30: 0.6295 - accuracy50: 0.5981 - val_loss: 10.6566 - val_accuracy10: 0.7173 - val_accuracy20: 0.6939 - val_accuracy30: 0.6656 - val_accuracy50: 0.6099 - 21s/epoch - 38ms/step
Epoch 10/50
538/538 - 21s - loss: 9.4131 - accuracy10: 0.6798 - accuracy20: 0.6576 - accuracy30: 0.6338 - accuracy50: 0.6006 - val_loss: 10.5715 - val_accuracy10: 0.7048 - val_accuracy20: 0.6826 - val_accuracy30: 0.6553 - val_accuracy50: 0.6043 - 21s/epoch - 39ms/step
Epoch 11/50
538/538 - 20s - loss: 9.3441 - accuracy10: 0.6822 - accuracy20: 0.6579 - accuracy30: 0.6336 - accuracy50: 0.6024 - val_loss: 10.5920 - val_accuracy10: 0.7311 - val_accuracy20: 0.7040 - val_accuracy30: 0.6742 - val_accuracy50: 0.6191 - 20s/epoch - 37ms/step
Epoch 12/50
538/538 - 21s - loss: 9.2950 - accuracy10: 0.6801 - accuracy20: 0.6584 - accuracy30: 0.6354 - accuracy50: 0.6035 - val_loss: 10.6419 - val_accuracy10: 0.7243 - val_accuracy20: 0.6990 - val_accuracy30: 0.6706 - val_accuracy50: 0.6146 - 21s/epoch - 40ms/step
Epoch 13/50
538/538 - 21s - loss: 9.2227 - accuracy10: 0.6815 - accuracy20: 0.6599 - accuracy30: 0.6360 - accuracy50: 0.6052 - val_loss: 10.6837 - val_accuracy10: 0.7188 - val_accuracy20: 0.6932 - val_accuracy30: 0.6645 - val_accuracy50: 0.6115 - 21s/epoch - 39ms/step
Epoch 14/50
538/538 - 21s - loss: 9.1578 - accuracy10: 0.6841 - accuracy20: 0.6608 - accuracy30: 0.6350 - accuracy50: 0.6057 - val_loss: 10.5756 - val_accuracy10: 0.7332 - val_accuracy20: 0.7049 - val_accuracy30: 0.6753 - val_accuracy50: 0.6187 - 21s/epoch - 40ms/step
Epoch 15/50
538/538 - 21s - loss: 9.1099 - accuracy10: 0.6826 - accuracy20: 0.6611 - accuracy30: 0.6388 - accuracy50: 0.6094 - val_loss: 10.5905 - val_accuracy10: 0.7399 - val_accuracy20: 0.7080 - val_accuracy30: 0.6761 - val_accuracy50: 0.6191 - 21s/epoch - 39ms/step
Epoch 16/50
538/538 - 21s - loss: 9.0920 - accuracy10: 0.6843 - accuracy20: 0.6606 - accuracy30: 0.6371 - accuracy50: 0.6086 - val_loss: 10.5827 - val_accuracy10: 0.7294 - val_accuracy20: 0.7005 - val_accuracy30: 0.6695 - val_accuracy50: 0.6145 - 21s/epoch - 38ms/step
Epoch 17/50
538/538 - 20s - loss: 9.0081 - accuracy10: 0.6860 - accuracy20: 0.6637 - accuracy30: 0.6409 - accuracy50: 0.6120 - val_loss: 10.5423 - val_accuracy10: 0.7151 - val_accuracy20: 0.6899 - val_accuracy30: 0.6619 - val_accuracy50: 0.6105 - 20s/epoch - 37ms/step
Epoch 18/50
538/538 - 20s - loss: 8.9563 - accuracy10: 0.6870 - accuracy20: 0.6649 - accuracy30: 0.6400 - accuracy50: 0.6135 - val_loss: 10.6713 - val_accuracy10: 0.7172 - val_accuracy20: 0.6915 - val_accuracy30: 0.6634 - val_accuracy50: 0.6099 - 20s/epoch - 37ms/step
Epoch 19/50
538/538 - 20s - loss: 8.8966 - accuracy10: 0.6890 - accuracy20: 0.6675 - accuracy30: 0.6434 - accuracy50: 0.6154 - val_loss: 10.7067 - val_accuracy10: 0.7185 - val_accuracy20: 0.6913 - val_accuracy30: 0.6607 - val_accuracy50: 0.6092 - 20s/epoch - 38ms/step
Epoch 20/50
538/538 - 20s - loss: 8.8594 - accuracy10: 0.6881 - accuracy20: 0.6663 - accuracy30: 0.6430 - accuracy50: 0.6159 - val_loss: 10.8210 - val_accuracy10: 0.7086 - val_accuracy20: 0.6808 - val_accuracy30: 0.6522 - val_accuracy50: 0.6019 - 20s/epoch - 37ms/step
Epoch 21/50
538/538 - 20s - loss: 8.8030 - accuracy10: 0.6867 - accuracy20: 0.6669 - accuracy30: 0.6453 - accuracy50: 0.6184 - val_loss: 10.8173 - val_accuracy10: 0.7146 - val_accuracy20: 0.6862 - val_accuracy30: 0.6562 - val_accuracy50: 0.6042 - 20s/epoch - 38ms/step
Epoch 22/50
538/538 - 20s - loss: 8.7456 - accuracy10: 0.6889 - accuracy20: 0.6686 - accuracy30: 0.6467 - accuracy50: 0.6195 - val_loss: 10.9356 - val_accuracy10: 0.7517 - val_accuracy20: 0.7179 - val_accuracy30: 0.6833 - val_accuracy50: 0.6239 - 20s/epoch - 38ms/step
Epoch 23/50
538/538 - 20s - loss: 8.7058 - accuracy10: 0.6898 - accuracy20: 0.6685 - accuracy30: 0.6455 - accuracy50: 0.6195 - val_loss: 10.9070 - val_accuracy10: 0.7294 - val_accuracy20: 0.6980 - val_accuracy30: 0.6648 - val_accuracy50: 0.6080 - 20s/epoch - 38ms/step
Epoch 24/50
538/538 - 20s - loss: 8.6564 - accuracy10: 0.6898 - accuracy20: 0.6700 - accuracy30: 0.6477 - accuracy50: 0.6212 - val_loss: 10.9135 - val_accuracy10: 0.7052 - val_accuracy20: 0.6759 - val_accuracy30: 0.6453 - val_accuracy50: 0.5948 - 20s/epoch - 38ms/step
Epoch 25/50
538/538 - 20s - loss: 8.6157 - accuracy10: 0.6894 - accuracy20: 0.6701 - accuracy30: 0.6474 - accuracy50: 0.6215 - val_loss: 10.8513 - val_accuracy10: 0.7158 - val_accuracy20: 0.6837 - val_accuracy30: 0.6503 - val_accuracy50: 0.5976 - 20s/epoch - 38ms/step
Epoch 26/50
538/538 - 21s - loss: 8.5734 - accuracy10: 0.6921 - accuracy20: 0.6711 - accuracy30: 0.6496 - accuracy50: 0.6223 - val_loss: 11.0945 - val_accuracy10: 0.7075 - val_accuracy20: 0.6773 - val_accuracy30: 0.6436 - val_accuracy50: 0.5930 - 21s/epoch - 38ms/step
Epoch 27/50
538/538 - 20s - loss: 8.5449 - accuracy10: 0.6918 - accuracy20: 0.6716 - accuracy30: 0.6496 - accuracy50: 0.6244 - val_loss: 10.9393 - val_accuracy10: 0.7134 - val_accuracy20: 0.6832 - val_accuracy30: 0.6530 - val_accuracy50: 0.6020 - 20s/epoch - 38ms/step
testing model: results/QRTEA/W7/deepVOL_L3/seq2seq
Evaluating performance on  test set...
2006/2006 - 33s - 33s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6781907
{'0': {'precision': 0.32860316611029045, 'recall': 0.5846768351994039, 'f1-score': 0.4207398802609239, 'support': 48319}, '1': {'precision': 0.9251668796197892, 'recall': 0.7432398402743635, 'f1-score': 0.8242844812796816, 'support': 416965}, '2': {'precision': 0.3223899983763598, 'recall': 0.6199059234899887, 'f1-score': 0.4241798463302262, 'support': 48046}, 'accuracy': 0.7167708881226501, 'macro avg': {'precision': 0.5253866813688132, 'recall': 0.6492741996545854, 'f1-score': 0.5564014026236105, 'support': 513330}, 'weighted avg': {'precision': 0.8125952782925976, 'recall': 0.7167708881226501, 'f1-score': 0.7488509417098008, 'support': 513330}}
[[ 28251  12161   7907]
 [ 52366 309905  54694]
 [  5356  12906  29784]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7330431
{'0': {'precision': 0.3925557989718673, 'recall': 0.5399970162613755, 'f1-score': 0.45462081438870605, 'support': 67030}, '1': {'precision': 0.8706307966761831, 'recall': 0.7350348271783415, 'f1-score': 0.79710737735642, 'support': 380450}, '2': {'precision': 0.37755561559938755, 'recall': 0.5729384965831436, 'f1-score': 0.45516567436978594, 'support': 65850}, 'accuracy': 0.6887733037227515, 'macro avg': {'precision': 0.5469140704158127, 'recall': 0.6159901133409535, 'f1-score': 0.5689646220383039, 'support': 513330}, 'weighted avg': {'precision': 0.7449526407725202, 'recall': 0.6887733037227515, 'f1-score': 0.7085216031811414, 'support': 513330}}
[[ 36196  20022  10812]
 [ 49419 279644  51387]
 [  6591  21531  37728]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.788896
{'0': {'precision': 0.43334779823528197, 'recall': 0.5052096508028283, 'f1-score': 0.4665276271516365, 'support': 83019}, '1': {'precision': 0.8164799789031572, 'recall': 0.7267704656641734, 'f1-score': 0.7690178046756205, 'support': 349329}, '2': {'precision': 0.41026733714025965, 'recall': 0.534970734237238, 'f1-score': 0.4643930989018057, 'support': 80982}, 'accuracy': 0.6606802641575594, 'macro avg': {'precision': 0.5533650380928996, 'recall': 0.5889836169014132, 'f1-score': 0.5666461769096875, 'support': 513330}, 'weighted avg': {'precision': 0.6904340383539797, 'recall': 0.6606802641575595, 'f1-score': 0.6720401295527197, 'support': 513330}}
[[ 41942  27366  13711]
 [ 46884 253882  48563]
 [  7960  29699  43323]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.87800926
{'0': {'precision': 0.48574924642611994, 'recall': 0.44318986330713234, 'f1-score': 0.46349462493177346, 'support': 110174}, '1': {'precision': 0.7110259760829968, 'recall': 0.7264540881690559, 'f1-score': 0.718657239102158, 'support': 296612}, '2': {'precision': 0.45338508213299805, 'recall': 0.4670746358312059, 'f1-score': 0.46012805991539724, 'support': 106544}, 'accuracy': 0.6118228040441821, 'macro avg': {'precision': 0.5500534348807049, 'recall': 0.5455728624357981, 'f1-score': 0.5474266413164429, 'support': 513330}, 'weighted avg': {'precision': 0.6092011658863876, 'recall': 0.6118228040441821, 'f1-score': 0.6102337713116875, 'support': 513330}}
[[ 48828  42054  19292]
 [ 40432 215475  40705]
 [ 11261  45519  49764]]
Evaluating performance on  train set...
538/538 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.65372103
{'0': {'precision': 0.3947430624497707, 'recall': 0.5797403318753037, 'f1-score': 0.4696816289796378, 'support': 14403}, '1': {'precision': 0.930734027683845, 'recall': 0.7563247659699196, 'f1-score': 0.8345141240082874, 'support': 109174}, '2': {'precision': 0.34570623102501086, 'recall': 0.6851719197707736, 'f1-score': 0.45954645911405784, 'support': 13960}, 'accuracy': 0.7306106720373426, 'macro avg': {'precision': 0.5570611070528755, 'recall': 0.6737456725386656, 'f1-score': 0.587914070700661, 'support': 137537}, 'weighted avg': {'precision': 0.8152242673021026, 'recall': 0.7306106720373426, 'f1-score': 0.7582493296051733, 'support': 137537}}
[[ 8350  3176  2877]
 [11377 82571 15226]
 [ 1426  2969  9565]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.687504
{'0': {'precision': 0.4649967040210943, 'recall': 0.5427267131719327, 'f1-score': 0.5008638848784643, 'support': 19496}, '1': {'precision': 0.8817165100607999, 'recall': 0.7558192284040848, 'f1-score': 0.8139282418715736, 'support': 99197}, '2': {'precision': 0.40828263134895293, 'recall': 0.6445552961154745, 'f1-score': 0.4999073940691047, 'support': 18844}, 'accuracy': 0.7103688462013859, 'macro avg': {'precision': 0.5849986151436157, 'recall': 0.6477004125638306, 'f1-score': 0.6048998402730476, 'support': 137537}, 'weighted avg': {'precision': 0.7577807157000378, 'recall': 0.7103688462013859, 'f1-score': 0.7265269494198888, 'support': 137537}}
[[10581  5170  3745]
 [10364 74975 13858]
 [ 1810  4888 12146]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.73823535
{'0': {'precision': 0.4973900697373366, 'recall': 0.5052600322389073, 'f1-score': 0.5012941646850866, 'support': 23574}, '1': {'precision': 0.8323010031820058, 'recall': 0.7508326759575773, 'f1-score': 0.7894706526121766, 'support': 91272}, '2': {'precision': 0.43971585818507614, 'recall': 0.6056145608390991, 'f1-score': 0.5095007693305897, 'support': 22691}, 'accuracy': 0.6847830038462377, 'macro avg': {'precision': 0.5898023103681396, 'recall': 0.6205690896785279, 'f1-score': 0.600088528875951, 'support': 137537}, 'weighted avg': {'precision': 0.7101277707416446, 'recall': 0.6847830038462377, 'f1-score': 0.6938871430988406, 'support': 137537}}
[[11911  7056  4607]
 [ 9839 68530 12903]
 [ 2197  6752 13742]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8217443
{'0': {'precision': 0.5398571084530785, 'recall': 0.44269633335527614, 'f1-score': 0.48647280092592593, 'support': 30382}, '1': {'precision': 0.7336840661738122, 'recall': 0.7529843775989354, 'f1-score': 0.743208941087327, 'support': 78157}, '2': {'precision': 0.47849429188522064, 'recall': 0.5347955031381475, 'f1-score': 0.5050807712350183, 'support': 28998}, 'accuracy': 0.6384391109301497, 'macro avg': {'precision': 0.5840118221707038, 'recall': 0.576825404697453, 'f1-score': 0.578254171082757, 'support': 137537}, 'weighted avg': {'precision': 0.637063929742947, 'recall': 0.6384391109301497, 'f1-score': 0.6362893625029392, 'support': 137537}}
[[13450 10847  6085]
 [ 8489 58851 10817]
 [ 2975 10515 15508]]
Evaluating performance on  val set...
153/153 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6803033
{'0': {'precision': 0.36037126715092815, 'recall': 0.613745704467354, 'f1-score': 0.45410628019323673, 'support': 4365}, '1': {'precision': 0.9239638001570313, 'recall': 0.7381887814057909, 'f1-score': 0.8206944648362943, 'support': 30289}, '2': {'precision': 0.3846568693541863, 'recall': 0.6489990900818926, 'f1-score': 0.48302717345297547, 'support': 4396}, 'accuracy': 0.7142381562099872, 'macro avg': {'precision': 0.5563306455540485, 'recall': 0.6669778586516791, 'f1-score': 0.5859426394941688, 'support': 39050}, 'weighted avg': {'precision': 0.8002538212996446, 'recall': 0.7142381562099872, 'f1-score': 0.7417048914972926, 'support': 39050}}
[[ 2679   869   817]
 [ 4183 22359  3747]
 [  572   971  2853]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.724713
{'0': {'precision': 0.42982679572083543, 'recall': 0.5735893949694085, 'f1-score': 0.4914094350611532, 'support': 5884}, '1': {'precision': 0.8644009315966531, 'recall': 0.7356482161209807, 'f1-score': 0.7948443386872893, 'support': 27244}, '2': {'precision': 0.44171243135297056, 'recall': 0.5976021614319487, 'f1-score': 0.5079661260226784, 'support': 5922}, 'accuracy': 0.6902944942381563, 'macro avg': {'precision': 0.5786467195568197, 'recall': 0.635613257507446, 'f1-score': 0.598073299923707, 'support': 39050}, 'weighted avg': {'precision': 0.734818460048986, 'recall': 0.6902944942381563, 'f1-score': 0.7056176101767642, 'support': 39050}}
[[ 3375  1474  1035]
 [ 3764 20042  3438]
 [  713  1670  3539]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.77957165
{'0': {'precision': 0.47287968441814593, 'recall': 0.5384615384615384, 'f1-score': 0.5035442373326333, 'support': 7124}, '1': {'precision': 0.8060208137924874, 'recall': 0.7283073694406328, 'f1-score': 0.7651960056819387, 'support': 24778}, '2': {'precision': 0.46765703591063285, 'recall': 0.5593172915500839, 'f1-score': 0.5093967000063706, 'support': 7148}, 'accuracy': 0.6627400768245839, 'macro avg': {'precision': 0.5821858447070888, 'recall': 0.6086953998174184, 'f1-score': 0.5927123143403142, 'support': 39050}, 'weighted avg': {'precision': 0.683308350541212, 'recall': 0.6627400768245839, 'f1-score': 0.670638755113708, 'support': 39050}}
[[ 3836  2035  1253]
 [ 3434 18046  3298]
 [  842  2308  3998]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.86452293
{'0': {'precision': 0.5156966916203816, 'recall': 0.46856829402084477, 'f1-score': 0.4910041961257688, 'support': 9115}, '1': {'precision': 0.6933333333333334, 'recall': 0.7268170426065163, 'f1-score': 0.7096804555508496, 'support': 20748}, '2': {'precision': 0.5056553559547572, 'recall': 0.4963535430499619, 'f1-score': 0.5009612743751717, 'support': 9187}, 'accuracy': 0.6123175416133163, 'macro avg': {'precision': 0.5715617936361573, 'recall': 0.563912959892441, 'f1-score': 0.56721530868393, 'support': 39050}, 'weighted avg': {'precision': 0.6077160332721162, 'recall': 0.6123175416133163, 'f1-score': 0.609533535650195, 'support': 39050}}
[[ 4271  3163  1681]
 [ 2891 15080  2777]
 [ 1120  3507  4560]]
training model: results/QRTEA/W8/deepLOB_L1/seq2seq
Epoch 1/50
614/614 - 21s - loss: 11.7962 - accuracy10: 0.4551 - accuracy20: 0.4690 - accuracy30: 0.4764 - accuracy50: 0.4790 - val_loss: 11.8240 - val_accuracy10: 0.5035 - val_accuracy20: 0.5008 - val_accuracy30: 0.4957 - val_accuracy50: 0.4813 - 21s/epoch - 34ms/step
Epoch 2/50
614/614 - 13s - loss: 11.6988 - accuracy10: 0.4671 - accuracy20: 0.4815 - accuracy30: 0.4883 - accuracy50: 0.4879 - val_loss: 11.5086 - val_accuracy10: 0.4998 - val_accuracy20: 0.5041 - val_accuracy30: 0.5139 - val_accuracy50: 0.5115 - 13s/epoch - 21ms/step
Epoch 3/50
614/614 - 13s - loss: 11.5514 - accuracy10: 0.4619 - accuracy20: 0.4788 - accuracy30: 0.4892 - accuracy50: 0.4926 - val_loss: 11.5051 - val_accuracy10: 0.5252 - val_accuracy20: 0.5273 - val_accuracy30: 0.5282 - val_accuracy50: 0.5190 - 13s/epoch - 21ms/step
Epoch 4/50
614/614 - 13s - loss: 11.3130 - accuracy10: 0.4910 - accuracy20: 0.5037 - accuracy30: 0.5092 - accuracy50: 0.5079 - val_loss: 11.6137 - val_accuracy10: 0.5435 - val_accuracy20: 0.5478 - val_accuracy30: 0.5462 - val_accuracy50: 0.5346 - 13s/epoch - 21ms/step
Epoch 5/50
614/614 - 13s - loss: 11.1644 - accuracy10: 0.5188 - accuracy20: 0.5266 - accuracy30: 0.5275 - accuracy50: 0.5214 - val_loss: 11.0931 - val_accuracy10: 0.5716 - val_accuracy20: 0.5718 - val_accuracy30: 0.5681 - val_accuracy50: 0.5538 - 13s/epoch - 21ms/step
Epoch 6/50
614/614 - 12s - loss: 10.9131 - accuracy10: 0.5533 - accuracy20: 0.5556 - accuracy30: 0.5524 - accuracy50: 0.5405 - val_loss: 11.3655 - val_accuracy10: 0.6120 - val_accuracy20: 0.6070 - val_accuracy30: 0.5973 - val_accuracy50: 0.5718 - 12s/epoch - 20ms/step
Epoch 7/50
614/614 - 13s - loss: 10.6601 - accuracy10: 0.5865 - accuracy20: 0.5827 - accuracy30: 0.5740 - accuracy50: 0.5558 - val_loss: 11.3703 - val_accuracy10: 0.6744 - val_accuracy20: 0.6556 - val_accuracy30: 0.6358 - val_accuracy50: 0.5961 - 13s/epoch - 21ms/step
Epoch 8/50
614/614 - 14s - loss: 10.4717 - accuracy10: 0.5943 - accuracy20: 0.5907 - accuracy30: 0.5825 - accuracy50: 0.5645 - val_loss: 10.9393 - val_accuracy10: 0.6662 - val_accuracy20: 0.6502 - val_accuracy30: 0.6333 - val_accuracy50: 0.5973 - 14s/epoch - 23ms/step
Epoch 9/50
614/614 - 12s - loss: 10.3205 - accuracy10: 0.6225 - accuracy20: 0.6088 - accuracy30: 0.5925 - accuracy50: 0.5678 - val_loss: 11.5825 - val_accuracy10: 0.6709 - val_accuracy20: 0.6512 - val_accuracy30: 0.6307 - val_accuracy50: 0.5898 - 12s/epoch - 20ms/step
Epoch 10/50
614/614 - 13s - loss: 10.2616 - accuracy10: 0.6233 - accuracy20: 0.6095 - accuracy30: 0.5922 - accuracy50: 0.5681 - val_loss: 11.0497 - val_accuracy10: 0.6925 - val_accuracy20: 0.6688 - val_accuracy30: 0.6460 - val_accuracy50: 0.6040 - 13s/epoch - 22ms/step
Epoch 11/50
614/614 - 13s - loss: 10.1486 - accuracy10: 0.6325 - accuracy20: 0.6182 - accuracy30: 0.5996 - accuracy50: 0.5732 - val_loss: 11.1540 - val_accuracy10: 0.6911 - val_accuracy20: 0.6683 - val_accuracy30: 0.6458 - val_accuracy50: 0.6056 - 13s/epoch - 21ms/step
Epoch 12/50
614/614 - 13s - loss: 10.0687 - accuracy10: 0.6349 - accuracy20: 0.6201 - accuracy30: 0.6025 - accuracy50: 0.5766 - val_loss: 11.3039 - val_accuracy10: 0.7040 - val_accuracy20: 0.6775 - val_accuracy30: 0.6516 - val_accuracy50: 0.6060 - 13s/epoch - 21ms/step
Epoch 13/50
614/614 - 12s - loss: 9.9964 - accuracy10: 0.6405 - accuracy20: 0.6232 - accuracy30: 0.6044 - accuracy50: 0.5783 - val_loss: 11.2358 - val_accuracy10: 0.6986 - val_accuracy20: 0.6729 - val_accuracy30: 0.6467 - val_accuracy50: 0.6024 - 12s/epoch - 20ms/step
Epoch 14/50
614/614 - 13s - loss: 9.9844 - accuracy10: 0.6388 - accuracy20: 0.6217 - accuracy30: 0.6035 - accuracy50: 0.5775 - val_loss: 11.2992 - val_accuracy10: 0.7166 - val_accuracy20: 0.6890 - val_accuracy30: 0.6614 - val_accuracy50: 0.6126 - 13s/epoch - 21ms/step
Epoch 15/50
614/614 - 12s - loss: 9.9442 - accuracy10: 0.6368 - accuracy20: 0.6222 - accuracy30: 0.6056 - accuracy50: 0.5805 - val_loss: 11.2883 - val_accuracy10: 0.7095 - val_accuracy20: 0.6790 - val_accuracy30: 0.6522 - val_accuracy50: 0.6060 - 12s/epoch - 20ms/step
Epoch 16/50
614/614 - 12s - loss: 9.8658 - accuracy10: 0.6498 - accuracy20: 0.6311 - accuracy30: 0.6111 - accuracy50: 0.5838 - val_loss: 11.0485 - val_accuracy10: 0.6936 - val_accuracy20: 0.6705 - val_accuracy30: 0.6482 - val_accuracy50: 0.6051 - 12s/epoch - 20ms/step
Epoch 17/50
614/614 - 12s - loss: 9.8122 - accuracy10: 0.6487 - accuracy20: 0.6313 - accuracy30: 0.6122 - accuracy50: 0.5850 - val_loss: 11.2041 - val_accuracy10: 0.7120 - val_accuracy20: 0.6852 - val_accuracy30: 0.6590 - val_accuracy50: 0.6120 - 12s/epoch - 20ms/step
Epoch 18/50
614/614 - 12s - loss: 9.7513 - accuracy10: 0.6531 - accuracy20: 0.6355 - accuracy30: 0.6157 - accuracy50: 0.5876 - val_loss: 10.9340 - val_accuracy10: 0.6904 - val_accuracy20: 0.6676 - val_accuracy30: 0.6424 - val_accuracy50: 0.6011 - 12s/epoch - 20ms/step
Epoch 19/50
614/614 - 13s - loss: 9.7207 - accuracy10: 0.6526 - accuracy20: 0.6359 - accuracy30: 0.6154 - accuracy50: 0.5879 - val_loss: 10.8388 - val_accuracy10: 0.6656 - val_accuracy20: 0.6483 - val_accuracy30: 0.6309 - val_accuracy50: 0.5970 - 13s/epoch - 21ms/step
Epoch 20/50
614/614 - 13s - loss: 9.6726 - accuracy10: 0.6568 - accuracy20: 0.6388 - accuracy30: 0.6179 - accuracy50: 0.5905 - val_loss: 10.8352 - val_accuracy10: 0.6385 - val_accuracy20: 0.6281 - val_accuracy30: 0.6131 - val_accuracy50: 0.5848 - 13s/epoch - 21ms/step
Epoch 21/50
614/614 - 13s - loss: 9.6389 - accuracy10: 0.6623 - accuracy20: 0.6425 - accuracy30: 0.6204 - accuracy50: 0.5910 - val_loss: 10.8522 - val_accuracy10: 0.6691 - val_accuracy20: 0.6515 - val_accuracy30: 0.6310 - val_accuracy50: 0.5945 - 13s/epoch - 20ms/step
Epoch 22/50
614/614 - 13s - loss: 9.5961 - accuracy10: 0.6640 - accuracy20: 0.6441 - accuracy30: 0.6220 - accuracy50: 0.5925 - val_loss: 11.0045 - val_accuracy10: 0.6427 - val_accuracy20: 0.6315 - val_accuracy30: 0.6165 - val_accuracy50: 0.5870 - 13s/epoch - 21ms/step
Epoch 23/50
614/614 - 12s - loss: 9.5555 - accuracy10: 0.6664 - accuracy20: 0.6464 - accuracy30: 0.6239 - accuracy50: 0.5936 - val_loss: 10.9899 - val_accuracy10: 0.6649 - val_accuracy20: 0.6490 - val_accuracy30: 0.6290 - val_accuracy50: 0.5933 - 12s/epoch - 20ms/step
Epoch 24/50
614/614 - 12s - loss: 9.5118 - accuracy10: 0.6690 - accuracy20: 0.6491 - accuracy30: 0.6255 - accuracy50: 0.5961 - val_loss: 11.0110 - val_accuracy10: 0.6466 - val_accuracy20: 0.6361 - val_accuracy30: 0.6212 - val_accuracy50: 0.5913 - 12s/epoch - 20ms/step
Epoch 25/50
614/614 - 12s - loss: 9.4954 - accuracy10: 0.6673 - accuracy20: 0.6486 - accuracy30: 0.6272 - accuracy50: 0.5967 - val_loss: 10.9983 - val_accuracy10: 0.6376 - val_accuracy20: 0.6280 - val_accuracy30: 0.6128 - val_accuracy50: 0.5842 - 12s/epoch - 20ms/step
Epoch 26/50
614/614 - 13s - loss: 9.4465 - accuracy10: 0.6694 - accuracy20: 0.6508 - accuracy30: 0.6294 - accuracy50: 0.5983 - val_loss: 11.0536 - val_accuracy10: 0.6620 - val_accuracy20: 0.6480 - val_accuracy30: 0.6321 - val_accuracy50: 0.5976 - 13s/epoch - 21ms/step
Epoch 27/50
614/614 - 12s - loss: 9.4290 - accuracy10: 0.6707 - accuracy20: 0.6508 - accuracy30: 0.6297 - accuracy50: 0.5989 - val_loss: 11.0356 - val_accuracy10: 0.6504 - val_accuracy20: 0.6392 - val_accuracy30: 0.6252 - val_accuracy50: 0.5945 - 12s/epoch - 20ms/step
Epoch 28/50
614/614 - 12s - loss: 9.3869 - accuracy10: 0.6726 - accuracy20: 0.6532 - accuracy30: 0.6323 - accuracy50: 0.6002 - val_loss: 11.0761 - val_accuracy10: 0.6532 - val_accuracy20: 0.6425 - val_accuracy30: 0.6271 - val_accuracy50: 0.5948 - 12s/epoch - 20ms/step
Epoch 29/50
614/614 - 13s - loss: 9.3284 - accuracy10: 0.6765 - accuracy20: 0.6564 - accuracy30: 0.6350 - accuracy50: 0.6026 - val_loss: 11.0244 - val_accuracy10: 0.6512 - val_accuracy20: 0.6409 - val_accuracy30: 0.6238 - val_accuracy50: 0.5930 - 13s/epoch - 21ms/step
Epoch 30/50
614/614 - 12s - loss: 9.2930 - accuracy10: 0.6756 - accuracy20: 0.6562 - accuracy30: 0.6346 - accuracy50: 0.6028 - val_loss: 10.9031 - val_accuracy10: 0.6619 - val_accuracy20: 0.6447 - val_accuracy30: 0.6247 - val_accuracy50: 0.5931 - 12s/epoch - 20ms/step
testing model: results/QRTEA/W8/deepLOB_L1/seq2seq
Evaluating performance on  test set...
2179/2179 - 20s - 20s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8737398
{'0': {'precision': 0.2639992869701905, 'recall': 0.6555602502967747, 'f1-score': 0.3764137755750413, 'support': 49701}, '1': {'precision': 0.9335024062222671, 'recall': 0.5635948624908251, 'f1-score': 0.7028496695100437, 'support': 459133}, '2': {'precision': 0.22910317182578818, 'recall': 0.7356474482082295, 'f1-score': 0.34939425843356253, 'support': 48946}, 'accuracy': 0.5868873032378357, 'macro avg': {'precision': 0.4755349550060819, 'recall': 0.6516008536652764, 'f1-score': 0.4762192345062158, 'support': 557780}, 'weighted avg': {'precision': 0.8120342656350865, 'recall': 0.5868873032378357, 'f1-score': 0.6427463690779504, 'support': 557780}}
[[ 32582  10721   6398]
 [ 85608 258765 114760]
 [  5227   7712  36007]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.89060396
{'0': {'precision': 0.3319303746889009, 'recall': 0.6324245939675174, 'f1-score': 0.43536029628298617, 'support': 68960}, '1': {'precision': 0.8903916349809886, 'recall': 0.5558092561693159, 'f1-score': 0.6843971890302623, 'support': 421319}, '2': {'precision': 0.29297207312520274, 'recall': 0.7091598642983067, 'f1-score': 0.414644076018225, 'support': 67501}, 'accuracy': 0.5838395066155115, 'macro avg': {'precision': 0.5050980275983641, 'recall': 0.63246457147838, 'f1-score': 0.5114671871104911, 'support': 557780}, 'weighted avg': {'precision': 0.7490493380994766, 'recall': 0.5838395066155115, 'f1-score': 0.6209632383592492, 'support': 557780}}
[[ 43612  16469   8879]
 [ 80503 234173 106643]
 [  7274  12358  47869]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9108931
{'0': {'precision': 0.3710765305025338, 'recall': 0.6076719017771205, 'f1-score': 0.4607778128852239, 'support': 85194}, '1': {'precision': 0.8464281747354057, 'recall': 0.547399881987737, 'f1-score': 0.6648376472641049, 'support': 389790}, '2': {'precision': 0.33664093198461936, 'recall': 0.6756848156915793, 'f1-score': 0.44938729772390446, 'support': 82796}, 'accuracy': 0.5756481049876295, 'macro avg': {'precision': 0.5180485457408529, 'recall': 0.6102521998188123, 'f1-score': 0.5250009192910777, 'support': 557780}, 'weighted avg': {'precision': 0.6981520577545719, 'recall': 0.5756481049876295, 'f1-score': 0.6016889135866607, 'support': 557780}}
[[ 51770  21966  11458]
 [ 77638 213371  98781]
 [ 10105  16747  55944]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.94676226
{'0': {'precision': 0.42053060892658733, 'recall': 0.5520700849379642, 'f1-score': 0.47740531228008104, 'support': 112435}, '1': {'precision': 0.7595928761555266, 'recall': 0.5482606565409113, 'f1-score': 0.6368524893245677, 'support': 336765}, '2': {'precision': 0.40010173244367314, 'recall': 0.6157579664763309, 'f1-score': 0.4850390844623393, 'support': 108580}, 'accuracy': 0.5621678798092438, 'macro avg': {'precision': 0.5267417391752623, 'recall': 0.5720295693184021, 'f1-score': 0.5330989620223293, 'support': 557780}, 'weighted avg': {'precision': 0.6212659114021851, 'recall': 0.5621678798092438, 'f1-score': 0.5751590925535511, 'support': 557780}}
[[ 62072  32858  17505]
 [ 69389 184635  82741]
 [ 16143  25578  66859]]
Evaluating performance on  train set...
614/614 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7975806
{'0': {'precision': 0.2971218064242553, 'recall': 0.6224875069405885, 'f1-score': 0.4022460622152058, 'support': 18010}, '1': {'precision': 0.9037812288993923, 'recall': 0.6425934509816905, 'f1-score': 0.751129601857675, 'support': 120812}, '2': {'precision': 0.3229219595301432, 'recall': 0.5915138242540378, 'f1-score': 0.4177719345732957, 'support': 18265}, 'accuracy': 0.6343491186412625, 'macro avg': {'precision': 0.5079416649512636, 'recall': 0.6188649273921056, 'f1-score': 0.5237158662153921, 'support': 157087}, 'weighted avg': {'precision': 0.7666894851280647, 'recall': 0.6343491186412625, 'f1-score': 0.6723696131768162, 'support': 157087}}
[[11211  4554  2245]
 [22771 77633 20408]
 [ 3750  3711 10804]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8285679
{'0': {'precision': 0.3621454563581078, 'recall': 0.6005124814018846, 'f1-score': 0.4518175316396654, 'support': 24196}, '1': {'precision': 0.8501510939199807, 'recall': 0.6477110519675467, 'f1-score': 0.7352509186324268, 'support': 108587}, '2': {'precision': 0.395005111727764, 'recall': 0.5564104674127716, 'f1-score': 0.46201677514135875, 'support': 24304}, 'accuracy': 0.6263153539121633, 'macro avg': {'precision': 0.5357672206686175, 'recall': 0.6015446669274009, 'f1-score': 0.549695075137817, 'support': 157087}, 'weighted avg': {'precision': 0.704565193383038, 'recall': 0.6263153539121633, 'f1-score': 0.6493199577312461, 'support': 157087}}
[[14530  6679  2987]
 [20529 70333 17725]
 [ 5063  5718 13523]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8632619
{'0': {'precision': 0.39887032242880677, 'recall': 0.5830867680451387, 'f1-score': 0.47369892112471357, 'support': 29066}, '1': {'precision': 0.7996379977530895, 'recall': 0.6479507201812591, 'f1-score': 0.7158469945355191, 'support': 98864}, '2': {'precision': 0.43981790239800506, 'recall': 0.5202181294371849, 'f1-score': 0.4766513732637798, 'support': 29157}, 'accuracy': 0.6122403508883613, 'macro avg': {'precision': 0.5461087408599671, 'recall': 0.5837518725545275, 'f1-score': 0.5553990963080042, 'support': 157087}, 'weighted avg': {'precision': 0.6586970683875546, 'recall': 0.6122403508883613, 'f1-score': 0.6266448159263498, 'support': 157087}}
[[16948  8431  3687]
 [19173 64059 15632]
 [ 6369  7620 15168]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9274107
{'0': {'precision': 0.4447928480885983, 'recall': 0.5414016187099044, 'f1-score': 0.4883652789647174, 'support': 36943}, '1': {'precision': 0.7012723039121094, 'recall': 0.6529243373378529, 'f1-score': 0.676235253253278, 'support': 83489}, '2': {'precision': 0.4850088696309652, 'recall': 0.45499931796480697, 'f1-score': 0.4695250696770924, 'support': 36655}, 'accuracy': 0.5805127095176558, 'macro avg': {'precision': 0.5436913405438909, 'recall': 0.5497750913375214, 'f1-score': 0.5447085339650294, 'support': 157087}, 'weighted avg': {'precision': 0.5904912926249671, 'recall': 0.5805127095176558, 'f1-score': 0.5838186800223462, 'support': 157087}}
[[20001 11896  5046]
 [16314 54512 12663]
 [ 8652 11325 16678]]
Evaluating performance on  val set...
190/190 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7996707
{'0': {'precision': 0.25902484763244255, 'recall': 0.6507656065959952, 'f1-score': 0.37055667337357473, 'support': 5094}, '1': {'precision': 0.9052039175559129, 'recall': 0.6475647695485085, 'f1-score': 0.7550102872818716, 'support': 38251}, '2': {'precision': 0.3432960228625863, 'recall': 0.5528283796740172, 'f1-score': 0.42356570924851245, 'support': 5215}, 'accuracy': 0.6377265238879737, 'macro avg': {'precision': 0.5025082626836472, 'recall': 0.6170529186061736, 'f1-score': 0.5163775566346529, 'support': 48560}, 'weighted avg': {'precision': 0.777074060615718, 'recall': 0.6377265238879737, 'f1-score': 0.6790858601053307, 'support': 48560}}
[[ 3315  1189   590]
 [ 8556 24770  4925]
 [  927  1405  2883]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8327866
{'0': {'precision': 0.31735952152403457, 'recall': 0.6364578705760403, 'f1-score': 0.4235317303902247, 'support': 6753}, '1': {'precision': 0.8559486263631872, 'recall': 0.6430304587365476, 'f1-score': 0.734367868553172, 'support': 35031}, '2': {'precision': 0.4168965517241379, 'recall': 0.535271546635183, 'f1-score': 0.4687257689325407, 'support': 6776}, 'accuracy': 0.6270799011532125, 'macro avg': {'precision': 0.5300682332037866, 'recall': 0.604919958649257, 'f1-score': 0.5422084559586459, 'support': 48560}, 'weighted avg': {'precision': 0.7197849302607779, 'recall': 0.6270799011532125, 'f1-score': 0.6540740607268998, 'support': 48560}}
[[ 4298  1774   681]
 [ 8113 22526  4392]
 [ 1132  2017  3627]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.86605394
{'0': {'precision': 0.35354595048258497, 'recall': 0.6259286775631501, 'f1-score': 0.45186377044784126, 'support': 8076}, '1': {'precision': 0.8104824440687296, 'recall': 0.6353408950807545, 'f1-score': 0.7123036784905922, 'support': 32444}, '2': {'precision': 0.45690338656699514, 'recall': 0.5017412935323383, 'f1-score': 0.4782737565949375, 'support': 8040}, 'accuracy': 0.6116556836902801, 'macro avg': {'precision': 0.5403105937061032, 'recall': 0.5876702887254144, 'f1-score': 0.547480401844457, 'support': 48560}, 'weighted avg': {'precision': 0.6759479559197255, 'recall': 0.6116556836902801, 'f1-score': 0.6302420378523236, 'support': 48560}}
[[ 5055  2248   773]
 [ 7809 20613  4022]
 [ 1434  2572  4034]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.92547596
{'0': {'precision': 0.3984681984681985, 'recall': 0.5861663564220633, 'f1-score': 0.4744270874633257, 'support': 10207}, '1': {'precision': 0.7251682477904808, 'recall': 0.6327201980898479, 'f1-score': 0.6757971890584857, 'support': 28270}, '2': {'precision': 0.5030971956301385, 'recall': 0.4430229098482594, 'f1-score': 0.47115283197974894, 'support': 10083}, 'accuracy': 0.5835461285008238, 'macro avg': {'precision': 0.5422445472962726, 'recall': 0.5539698214533902, 'f1-score': 0.5404590361671867, 'support': 48560}, 'weighted avg': {'precision': 0.6103871558966327, 'recall': 0.5835461285008238, 'f1-score': 0.5909781264677383, 'support': 48560}}
[[ 5983  3235   989]
 [ 6960 17887  3423]
 [ 2072  3544  4467]]
training model: results/QRTEA/W8/deepOF_L1/seq2seq
Epoch 1/50
614/614 - 19s - loss: 12.0107 - accuracy10: 0.4813 - accuracy20: 0.4798 - accuracy30: 0.4707 - accuracy50: 0.4612 - val_loss: 12.7613 - val_accuracy10: 0.7205 - val_accuracy20: 0.6794 - val_accuracy30: 0.6414 - val_accuracy50: 0.5755 - 19s/epoch - 31ms/step
Epoch 2/50
614/614 - 13s - loss: 11.7960 - accuracy10: 0.4872 - accuracy20: 0.4895 - accuracy30: 0.4855 - accuracy50: 0.4761 - val_loss: 12.4770 - val_accuracy10: 0.7104 - val_accuracy20: 0.6793 - val_accuracy30: 0.6480 - val_accuracy50: 0.5864 - 13s/epoch - 21ms/step
Epoch 3/50
614/614 - 12s - loss: 11.6264 - accuracy10: 0.5150 - accuracy20: 0.5149 - accuracy30: 0.5086 - accuracy50: 0.4962 - val_loss: 12.1134 - val_accuracy10: 0.7232 - val_accuracy20: 0.6886 - val_accuracy30: 0.6550 - val_accuracy50: 0.5925 - 12s/epoch - 20ms/step
Epoch 4/50
614/614 - 12s - loss: 11.5423 - accuracy10: 0.5227 - accuracy20: 0.5272 - accuracy30: 0.5240 - accuracy50: 0.5106 - val_loss: 12.4134 - val_accuracy10: 0.7231 - val_accuracy20: 0.6905 - val_accuracy30: 0.6586 - val_accuracy50: 0.5961 - 12s/epoch - 19ms/step
Epoch 5/50
614/614 - 12s - loss: 11.4994 - accuracy10: 0.5170 - accuracy20: 0.5184 - accuracy30: 0.5160 - accuracy50: 0.5061 - val_loss: 11.9714 - val_accuracy10: 0.7222 - val_accuracy20: 0.6932 - val_accuracy30: 0.6634 - val_accuracy50: 0.6033 - 12s/epoch - 19ms/step
Epoch 6/50
614/614 - 13s - loss: 11.4001 - accuracy10: 0.5429 - accuracy20: 0.5407 - accuracy30: 0.5364 - accuracy50: 0.5216 - val_loss: 12.2287 - val_accuracy10: 0.7276 - val_accuracy20: 0.6951 - val_accuracy30: 0.6629 - val_accuracy50: 0.6022 - 13s/epoch - 20ms/step
Epoch 7/50
614/614 - 12s - loss: 11.3415 - accuracy10: 0.5429 - accuracy20: 0.5382 - accuracy30: 0.5321 - accuracy50: 0.5167 - val_loss: 11.5988 - val_accuracy10: 0.7194 - val_accuracy20: 0.6937 - val_accuracy30: 0.6662 - val_accuracy50: 0.6069 - 12s/epoch - 19ms/step
Epoch 8/50
614/614 - 13s - loss: 11.2693 - accuracy10: 0.5455 - accuracy20: 0.5437 - accuracy30: 0.5395 - accuracy50: 0.5252 - val_loss: 11.5126 - val_accuracy10: 0.7188 - val_accuracy20: 0.6893 - val_accuracy30: 0.6624 - val_accuracy50: 0.6065 - 13s/epoch - 21ms/step
Epoch 9/50
614/614 - 12s - loss: 11.2035 - accuracy10: 0.5582 - accuracy20: 0.5524 - accuracy30: 0.5460 - accuracy50: 0.5301 - val_loss: 11.3695 - val_accuracy10: 0.7058 - val_accuracy20: 0.6814 - val_accuracy30: 0.6576 - val_accuracy50: 0.6068 - 12s/epoch - 19ms/step
Epoch 10/50
614/614 - 12s - loss: 11.1323 - accuracy10: 0.5726 - accuracy20: 0.5630 - accuracy30: 0.5569 - accuracy50: 0.5404 - val_loss: 11.2733 - val_accuracy10: 0.7063 - val_accuracy20: 0.6808 - val_accuracy30: 0.6551 - val_accuracy50: 0.6057 - 12s/epoch - 19ms/step
Epoch 11/50
614/614 - 11s - loss: 11.0674 - accuracy10: 0.5817 - accuracy20: 0.5699 - accuracy30: 0.5615 - accuracy50: 0.5429 - val_loss: 11.2577 - val_accuracy10: 0.6966 - val_accuracy20: 0.6733 - val_accuracy30: 0.6513 - val_accuracy50: 0.6033 - 11s/epoch - 19ms/step
Epoch 12/50
614/614 - 12s - loss: 10.9719 - accuracy10: 0.5938 - accuracy20: 0.5785 - accuracy30: 0.5663 - accuracy50: 0.5456 - val_loss: 11.2561 - val_accuracy10: 0.7042 - val_accuracy20: 0.6761 - val_accuracy30: 0.6513 - val_accuracy50: 0.6016 - 12s/epoch - 19ms/step
Epoch 13/50
614/614 - 13s - loss: 10.8895 - accuracy10: 0.5964 - accuracy20: 0.5789 - accuracy30: 0.5666 - accuracy50: 0.5460 - val_loss: 11.2537 - val_accuracy10: 0.7204 - val_accuracy20: 0.6891 - val_accuracy30: 0.6600 - val_accuracy50: 0.6063 - 13s/epoch - 21ms/step
Epoch 14/50
614/614 - 12s - loss: 10.8331 - accuracy10: 0.5979 - accuracy20: 0.5813 - accuracy30: 0.5681 - accuracy50: 0.5481 - val_loss: 11.1865 - val_accuracy10: 0.7227 - val_accuracy20: 0.6930 - val_accuracy30: 0.6636 - val_accuracy50: 0.6098 - 12s/epoch - 20ms/step
Epoch 15/50
614/614 - 12s - loss: 10.7709 - accuracy10: 0.6008 - accuracy20: 0.5834 - accuracy30: 0.5713 - accuracy50: 0.5510 - val_loss: 11.0223 - val_accuracy10: 0.7088 - val_accuracy20: 0.6801 - val_accuracy30: 0.6539 - val_accuracy50: 0.6057 - 12s/epoch - 19ms/step
Epoch 16/50
614/614 - 12s - loss: 10.7086 - accuracy10: 0.6079 - accuracy20: 0.5882 - accuracy30: 0.5734 - accuracy50: 0.5529 - val_loss: 11.1093 - val_accuracy10: 0.7200 - val_accuracy20: 0.6896 - val_accuracy30: 0.6609 - val_accuracy50: 0.6074 - 12s/epoch - 19ms/step
Epoch 17/50
614/614 - 11s - loss: 10.6466 - accuracy10: 0.6120 - accuracy20: 0.5915 - accuracy30: 0.5759 - accuracy50: 0.5546 - val_loss: 11.1022 - val_accuracy10: 0.7199 - val_accuracy20: 0.6871 - val_accuracy30: 0.6596 - val_accuracy50: 0.6069 - 11s/epoch - 18ms/step
Epoch 18/50
614/614 - 12s - loss: 10.5989 - accuracy10: 0.6117 - accuracy20: 0.5919 - accuracy30: 0.5772 - accuracy50: 0.5571 - val_loss: 11.1175 - val_accuracy10: 0.7218 - val_accuracy20: 0.6890 - val_accuracy30: 0.6616 - val_accuracy50: 0.6091 - 12s/epoch - 19ms/step
Epoch 19/50
614/614 - 12s - loss: 10.5428 - accuracy10: 0.6150 - accuracy20: 0.5948 - accuracy30: 0.5795 - accuracy50: 0.5592 - val_loss: 11.2643 - val_accuracy10: 0.7240 - val_accuracy20: 0.6901 - val_accuracy30: 0.6601 - val_accuracy50: 0.6070 - 12s/epoch - 20ms/step
Epoch 20/50
614/614 - 12s - loss: 10.4864 - accuracy10: 0.6166 - accuracy20: 0.5966 - accuracy30: 0.5819 - accuracy50: 0.5615 - val_loss: 11.0692 - val_accuracy10: 0.7208 - val_accuracy20: 0.6884 - val_accuracy30: 0.6607 - val_accuracy50: 0.6088 - 12s/epoch - 19ms/step
Epoch 21/50
614/614 - 12s - loss: 10.4500 - accuracy10: 0.6177 - accuracy20: 0.5972 - accuracy30: 0.5817 - accuracy50: 0.5617 - val_loss: 11.3654 - val_accuracy10: 0.7235 - val_accuracy20: 0.6892 - val_accuracy30: 0.6595 - val_accuracy50: 0.6064 - 12s/epoch - 20ms/step
Epoch 22/50
614/614 - 12s - loss: 10.4176 - accuracy10: 0.6174 - accuracy20: 0.5977 - accuracy30: 0.5832 - accuracy50: 0.5629 - val_loss: 11.4831 - val_accuracy10: 0.7337 - val_accuracy20: 0.6980 - val_accuracy30: 0.6674 - val_accuracy50: 0.6136 - 12s/epoch - 19ms/step
Epoch 23/50
614/614 - 11s - loss: 10.3541 - accuracy10: 0.6210 - accuracy20: 0.6006 - accuracy30: 0.5857 - accuracy50: 0.5658 - val_loss: 11.5039 - val_accuracy10: 0.7270 - val_accuracy20: 0.6942 - val_accuracy30: 0.6639 - val_accuracy50: 0.6097 - 11s/epoch - 19ms/step
Epoch 24/50
614/614 - 12s - loss: 10.3256 - accuracy10: 0.6203 - accuracy20: 0.6006 - accuracy30: 0.5855 - accuracy50: 0.5659 - val_loss: 11.6507 - val_accuracy10: 0.7290 - val_accuracy20: 0.6947 - val_accuracy30: 0.6636 - val_accuracy50: 0.6095 - 12s/epoch - 19ms/step
Epoch 25/50
614/614 - 12s - loss: 10.2696 - accuracy10: 0.6227 - accuracy20: 0.6033 - accuracy30: 0.5885 - accuracy50: 0.5707 - val_loss: 11.8955 - val_accuracy10: 0.7328 - val_accuracy20: 0.6969 - val_accuracy30: 0.6664 - val_accuracy50: 0.6107 - 12s/epoch - 19ms/step
testing model: results/QRTEA/W8/deepOF_L1/seq2seq
Evaluating performance on  test set...
2179/2179 - 19s - 19s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7031857
{'0': {'precision': 0.28984172357207133, 'recall': 0.5508561540473651, 'f1-score': 0.37982990413030504, 'support': 49699}, '1': {'precision': 0.8999239422985815, 'recall': 0.7653877316327331, 'f1-score': 0.827221421215242, 'support': 459132}, '2': {'precision': 0.3272275392368215, 'recall': 0.4869033998038575, 'f1-score': 0.39140682100007396, 'support': 48944}, 'accuracy': 0.7218358657164627, 'macro avg': {'precision': 0.5056644017024915, 'recall': 0.6010490951613185, 'f1-score': 0.532819382115207, 'support': 557775}, 'weighted avg': {'precision': 0.7953109192338268, 'recall': 0.7218358657164627, 'f1-score': 0.7491156961459301, 'support': 557775}}
[[ 27377  18796   3526]
 [ 62248 351414  45470]
 [  4830  20283  23831]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7498979
{'0': {'precision': 0.3582203859525369, 'recall': 0.5155096654436823, 'f1-score': 0.4227073820395738, 'support': 68957}, '1': {'precision': 0.8418909056665961, 'recall': 0.7639099207724331, 'f1-score': 0.8010069548575119, 'support': 421318}, '2': {'precision': 0.4053929990688158, 'recall': 0.4579259259259259, 'f1-score': 0.4300611491022421, 'support': 67500}, 'accuracy': 0.6961713952758729, 'macro avg': {'precision': 0.535168096895983, 'recall': 0.5791151707140137, 'f1-score': 0.5512584953331093, 'support': 557775}, 'weighted avg': {'precision': 0.7292718805699665, 'recall': 0.6961713952758729, 'f1-score': 0.7093476916576783, 'support': 557775}}
[[ 35548  29737   3672]
 [ 57804 321849  41665]
 [  5883  30707  30910]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.79198694
{'0': {'precision': 0.4062867273560288, 'recall': 0.47882992334871055, 'f1-score': 0.4395855447134321, 'support': 85191}, '1': {'precision': 0.7865670389156696, 'recall': 0.7694085774611392, 'f1-score': 0.7778932010504814, 'support': 389789}, '2': {'precision': 0.45716088162235335, 'recall': 0.4201219880427562, 'f1-score': 0.43785954356062984, 'support': 82795}, 'accuracy': 0.6731800457173591, 'macro avg': {'precision': 0.5500048826313506, 'recall': 0.5561201629508686, 'f1-score': 0.5517794297748478, 'support': 557775}, 'weighted avg': {'precision': 0.6795890588785982, 'recall': 0.6731800457173591, 'f1-score': 0.6757483322003504, 'support': 557775}}
[[ 40792  40592   3807]
 [ 52386 299907  37496]
 [  7224  40787  34784]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.862371
{'0': {'precision': 0.4659547814842503, 'recall': 0.41023018357762914, 'f1-score': 0.43632046467188224, 'support': 112432}, '1': {'precision': 0.6849410258278766, 'recall': 0.7814938651399793, 'f1-score': 0.7300388349514564, 'support': 336764}, '2': {'precision': 0.5235201802744356, 'recall': 0.3594617743762606, 'f1-score': 0.4262499180918682, 'support': 108579}, 'accuracy': 0.6245027116668908, 'macro avg': {'precision': 0.5581386625288541, 'recall': 0.5170619410312897, 'f1-score': 0.5308697392384022, 'support': 557775}, 'weighted avg': {'precision': 0.6093765501640521, 'recall': 0.6245027116668908, 'f1-score': 0.6116964198002389, 'support': 557775}}
[[ 46123  61440   4869]
 [ 42931 263179  30654]
 [  9932  59617  39030]]
Evaluating performance on  train set...
614/614 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.71405137
{'0': {'precision': 0.3415044066407051, 'recall': 0.4636060100166945, 'f1-score': 0.39329635312168065, 'support': 17970}, '1': {'precision': 0.845930081554205, 'recall': 0.8084359977826133, 'f1-score': 0.8267581620263231, 'support': 120863}, '2': {'precision': 0.4108712099167782, 'recall': 0.3868281190071777, 'f1-score': 0.3984873285544957, 'support': 18251}, 'accuracy': 0.7200033103307785, 'macro avg': {'precision': 0.5327685660372294, 'recall': 0.5529567089354951, 'f1-score': 0.5395139479008332, 'support': 157084}, 'weighted avg': {'precision': 0.7376772432991933, 'recall': 0.7200033103307785, 'f1-score': 0.7274120816635188, 'support': 157084}}
[[ 8331  8441  1198]
 [14228 97710  8925]
 [ 1836  9355  7060]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7770754
{'0': {'precision': 0.40470860671555386, 'recall': 0.43492326835338035, 'f1-score': 0.4192722910835666, 'support': 24110}, '1': {'precision': 0.7741687504970267, 'recall': 0.8062779526254762, 'f1-score': 0.7898971776829141, 'support': 108666}, '2': {'precision': 0.48175101383256486, 'recall': 0.35675497778509135, 'f1-score': 0.40993642014701365, 'support': 24308}, 'accuracy': 0.6797191311654911, 'macro avg': {'precision': 0.5535427903483818, 'recall': 0.5326520662546493, 'f1-score': 0.5397019629711648, 'support': 157084}, 'weighted avg': {'precision': 0.6722119986355319, 'recall': 0.6797191311654911, 'f1-score': 0.6742147904882098, 'support': 157084}}
[[10486 12240  1384]
 [13106 87615  7945]
 [ 2318 13318  8672]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8291249
{'0': {'precision': 0.44410080183276057, 'recall': 0.4009030745898249, 'f1-score': 0.42139777544291873, 'support': 29012}, '1': {'precision': 0.7089774788726163, 'recall': 0.8100828100828101, 'f1-score': 0.7561654695950092, 'support': 98901}, '2': {'precision': 0.5236737660014534, 'recall': 0.3211408590723664, 'f1-score': 0.39813004674883135, 'support': 29171}, 'accuracy': 0.6437129179292608, 'macro avg': {'precision': 0.5589173489022768, 'recall': 0.5107089145816671, 'f1-score': 0.525231097262253, 'support': 157084}, 'weighted avg': {'precision': 0.6256456515544618, 'recall': 0.6437129179292608, 'f1-score': 0.6278485712311637, 'support': 157084}}
[[11631 15883  1498]
 [11760 80118  7023]
 [ 2799 17004  9368]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9100297
{'0': {'precision': 0.49391878764328734, 'recall': 0.3443875477525807, 'f1-score': 0.4058169976374434, 'support': 36909}, '1': {'precision': 0.5996471114934557, 'recall': 0.8181230238574303, 'f1-score': 0.6920516885919367, 'support': 83496}, '2': {'precision': 0.5664295548416705, 'recall': 0.2692003598789498, 'f1-score': 0.36495352146513643, 'support': 36679}, 'accuracy': 0.5786394540500623, 'macro avg': {'precision': 0.5533318179928045, 'recall': 0.47723697716298696, 'f1-score': 0.48760740256483887, 'support': 157084}, 'weighted avg': {'precision': 0.5670485434316754, 'recall': 0.5786394540500623, 'f1-score': 0.5484198108673861, 'support': 157084}}
[[12711 22272  1926]
 [ 9554 68310  5632]
 [ 3470 23335  9874]]
Evaluating performance on  val set...
190/190 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.73272103
{'0': {'precision': 0.3041834370045127, 'recall': 0.49142857142857144, 'f1-score': 0.3757721862287177, 'support': 5075}, '1': {'precision': 0.8729533495987536, 'recall': 0.7764936593018695, 'f1-score': 0.8219030222517435, 'support': 38245}, '2': {'precision': 0.34720908230842007, 'recall': 0.4202290076335878, 'f1-score': 0.38024520808150575, 'support': 5240}, 'accuracy': 0.7082578253706755, 'macro avg': {'precision': 0.5081152896372289, 'recall': 0.5627170794546762, 'f1-score': 0.5259734721873223, 'support': 48560}, 'weighted avg': {'precision': 0.7567793943471655, 'recall': 0.7082578253706755, 'f1-score': 0.7276196421226475, 'support': 48560}}
[[ 2494  2051   530]
 [ 4938 29697  3610]
 [  767  2271  2202]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7789009
{'0': {'precision': 0.3705069124423963, 'recall': 0.47545830869308103, 'f1-score': 0.41647241647241645, 'support': 6764}, '1': {'precision': 0.8133084651946333, 'recall': 0.7726999914258768, 'f1-score': 0.7924843546188683, 'support': 34989}, '2': {'precision': 0.41488400120518226, 'recall': 0.40458351696782724, 'f1-score': 0.40966902194124205, 'support': 6807}, 'accuracy': 0.6796952224052718, 'macro avg': {'precision': 0.532899792947404, 'recall': 0.5509139390289284, 'f1-score': 0.5395419310108422, 'support': 48560}, 'weighted avg': {'precision': 0.6957799431766695, 'recall': 0.6796952224052718, 'f1-score': 0.6864471075192142, 'support': 48560}}
[[ 3216  2976   572]
 [ 4641 27036  3312]
 [  823  3230  2754]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.819246
{'0': {'precision': 0.41102272727272726, 'recall': 0.4474823704070271, 'f1-score': 0.42847835100396847, 'support': 8083}, '1': {'precision': 0.758189668186347, 'recall': 0.7748464932580456, 'f1-score': 0.766427590416603, 'support': 32409}, '2': {'precision': 0.45925591203494504, 'recall': 0.37791274169558753, 'f1-score': 0.4146324879309173, 'support': 8068}, 'accuracy': 0.6544069192751235, 'macro avg': {'precision': 0.5428227691646731, 'recall': 0.5334138684535534, 'f1-score': 0.5365128097838296, 'support': 48560}, 'weighted avg': {'precision': 0.6507360452861349, 'recall': 0.6544069192751235, 'f1-score': 0.6517256425371377, 'support': 48560}}
[[ 3617  3882   584]
 [ 4291 25112  3006]
 [  892  4127  3049]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.88586545
{'0': {'precision': 0.4640101347460555, 'recall': 0.39345703125, 'f1-score': 0.4258309993130053, 'support': 10240}, '1': {'precision': 0.6613710620185246, 'recall': 0.7819953925217084, 'f1-score': 0.7166428478628036, 'support': 28215}, '2': {'precision': 0.503683241252302, 'recall': 0.3247897080653142, 'f1-score': 0.39492208651705674, 'support': 10105}, 'accuracy': 0.6049217462932455, 'macro avg': {'precision': 0.5430214793389607, 'recall': 0.5000807106123408, 'f1-score': 0.5124653112309553, 'support': 48560}, 'weighted avg': {'precision': 0.586939197848163, 'recall': 0.6049217462932455, 'f1-score': 0.5883705739223443, 'support': 48560}}
[[ 4029  5532   679]
 [ 3596 22064  2555]
 [ 1058  5765  3282]]
training model: results/QRTEA/W8/deepLOB_L2/seq2seq
Epoch 1/50
614/614 - 34s - loss: 11.9898 - accuracy10: 0.4413 - accuracy20: 0.4525 - accuracy30: 0.4592 - accuracy50: 0.4650 - val_loss: 12.3234 - val_accuracy10: 0.6260 - val_accuracy20: 0.5983 - val_accuracy30: 0.5772 - val_accuracy50: 0.5304 - 34s/epoch - 56ms/step
Epoch 2/50
614/614 - 28s - loss: 11.6801 - accuracy10: 0.4534 - accuracy20: 0.4712 - accuracy30: 0.4807 - accuracy50: 0.4849 - val_loss: 11.6273 - val_accuracy10: 0.5912 - val_accuracy20: 0.5792 - val_accuracy30: 0.5636 - val_accuracy50: 0.5355 - 28s/epoch - 45ms/step
Epoch 3/50
614/614 - 28s - loss: 11.6102 - accuracy10: 0.4503 - accuracy20: 0.4727 - accuracy30: 0.4841 - accuracy50: 0.4869 - val_loss: 11.3073 - val_accuracy10: 0.4355 - val_accuracy20: 0.4435 - val_accuracy30: 0.4537 - val_accuracy50: 0.4624 - 28s/epoch - 46ms/step
Epoch 4/50
614/614 - 28s - loss: 11.4035 - accuracy10: 0.4958 - accuracy20: 0.5141 - accuracy30: 0.5211 - accuracy50: 0.5164 - val_loss: 11.3396 - val_accuracy10: 0.4736 - val_accuracy20: 0.4790 - val_accuracy30: 0.4826 - val_accuracy50: 0.4829 - 28s/epoch - 46ms/step
Epoch 5/50
614/614 - 28s - loss: 11.0966 - accuracy10: 0.5346 - accuracy20: 0.5447 - accuracy30: 0.5431 - accuracy50: 0.5312 - val_loss: 11.3470 - val_accuracy10: 0.4933 - val_accuracy20: 0.5013 - val_accuracy30: 0.5044 - val_accuracy50: 0.5015 - 28s/epoch - 45ms/step
Epoch 6/50
614/614 - 28s - loss: 10.8331 - accuracy10: 0.5723 - accuracy20: 0.5768 - accuracy30: 0.5692 - accuracy50: 0.5500 - val_loss: 11.1107 - val_accuracy10: 0.5567 - val_accuracy20: 0.5569 - val_accuracy30: 0.5522 - val_accuracy50: 0.5363 - 28s/epoch - 45ms/step
Epoch 7/50
614/614 - 28s - loss: 10.5223 - accuracy10: 0.6047 - accuracy20: 0.6030 - accuracy30: 0.5905 - accuracy50: 0.5655 - val_loss: 11.2968 - val_accuracy10: 0.5219 - val_accuracy20: 0.5279 - val_accuracy30: 0.5257 - val_accuracy50: 0.5186 - 28s/epoch - 45ms/step
Epoch 8/50
614/614 - 28s - loss: 10.1945 - accuracy10: 0.6397 - accuracy20: 0.6315 - accuracy30: 0.6146 - accuracy50: 0.5845 - val_loss: 10.8988 - val_accuracy10: 0.5639 - val_accuracy20: 0.5672 - val_accuracy30: 0.5612 - val_accuracy50: 0.5438 - 28s/epoch - 45ms/step
Epoch 9/50
614/614 - 28s - loss: 10.0011 - accuracy10: 0.6602 - accuracy20: 0.6484 - accuracy30: 0.6275 - accuracy50: 0.5920 - val_loss: 11.4910 - val_accuracy10: 0.4888 - val_accuracy20: 0.5018 - val_accuracy30: 0.5041 - val_accuracy50: 0.5004 - 28s/epoch - 45ms/step
Epoch 10/50
614/614 - 28s - loss: 9.8490 - accuracy10: 0.6680 - accuracy20: 0.6534 - accuracy30: 0.6315 - accuracy50: 0.5951 - val_loss: 10.6964 - val_accuracy10: 0.5703 - val_accuracy20: 0.5722 - val_accuracy30: 0.5638 - val_accuracy50: 0.5471 - 28s/epoch - 45ms/step
Epoch 11/50
614/614 - 27s - loss: 9.6923 - accuracy10: 0.6770 - accuracy20: 0.6617 - accuracy30: 0.6391 - accuracy50: 0.6020 - val_loss: 11.0427 - val_accuracy10: 0.5278 - val_accuracy20: 0.5349 - val_accuracy30: 0.5330 - val_accuracy50: 0.5261 - 27s/epoch - 45ms/step
Epoch 12/50
614/614 - 28s - loss: 9.5868 - accuracy10: 0.6850 - accuracy20: 0.6672 - accuracy30: 0.6436 - accuracy50: 0.6049 - val_loss: 11.1294 - val_accuracy10: 0.5246 - val_accuracy20: 0.5307 - val_accuracy30: 0.5259 - val_accuracy50: 0.5155 - 28s/epoch - 45ms/step
Epoch 13/50
614/614 - 28s - loss: 9.4794 - accuracy10: 0.6887 - accuracy20: 0.6692 - accuracy30: 0.6445 - accuracy50: 0.6069 - val_loss: 10.8060 - val_accuracy10: 0.5568 - val_accuracy20: 0.5580 - val_accuracy30: 0.5503 - val_accuracy50: 0.5368 - 28s/epoch - 45ms/step
Epoch 14/50
614/614 - 28s - loss: 9.4042 - accuracy10: 0.6909 - accuracy20: 0.6716 - accuracy30: 0.6462 - accuracy50: 0.6089 - val_loss: 10.8289 - val_accuracy10: 0.5619 - val_accuracy20: 0.5624 - val_accuracy30: 0.5553 - val_accuracy50: 0.5407 - 28s/epoch - 45ms/step
Epoch 15/50
614/614 - 28s - loss: 9.3288 - accuracy10: 0.6913 - accuracy20: 0.6734 - accuracy30: 0.6481 - accuracy50: 0.6111 - val_loss: 10.9661 - val_accuracy10: 0.5760 - val_accuracy20: 0.5749 - val_accuracy30: 0.5640 - val_accuracy50: 0.5468 - 28s/epoch - 45ms/step
Epoch 16/50
614/614 - 28s - loss: 9.2462 - accuracy10: 0.6946 - accuracy20: 0.6748 - accuracy30: 0.6495 - accuracy50: 0.6125 - val_loss: 11.0016 - val_accuracy10: 0.5645 - val_accuracy20: 0.5640 - val_accuracy30: 0.5563 - val_accuracy50: 0.5422 - 28s/epoch - 45ms/step
Epoch 17/50
614/614 - 28s - loss: 9.1663 - accuracy10: 0.6975 - accuracy20: 0.6760 - accuracy30: 0.6496 - accuracy50: 0.6145 - val_loss: 11.0612 - val_accuracy10: 0.5477 - val_accuracy20: 0.5472 - val_accuracy30: 0.5395 - val_accuracy50: 0.5252 - 28s/epoch - 45ms/step
Epoch 18/50
614/614 - 28s - loss: 9.1089 - accuracy10: 0.6978 - accuracy20: 0.6769 - accuracy30: 0.6510 - accuracy50: 0.6146 - val_loss: 10.9928 - val_accuracy10: 0.5451 - val_accuracy20: 0.5457 - val_accuracy30: 0.5402 - val_accuracy50: 0.5285 - 28s/epoch - 45ms/step
Epoch 19/50
614/614 - 28s - loss: 9.0626 - accuracy10: 0.6989 - accuracy20: 0.6782 - accuracy30: 0.6526 - accuracy50: 0.6169 - val_loss: 10.9171 - val_accuracy10: 0.5578 - val_accuracy20: 0.5552 - val_accuracy30: 0.5435 - val_accuracy50: 0.5282 - 28s/epoch - 45ms/step
Epoch 20/50
614/614 - 27s - loss: 8.9882 - accuracy10: 0.7021 - accuracy20: 0.6805 - accuracy30: 0.6527 - accuracy50: 0.6182 - val_loss: 10.6680 - val_accuracy10: 0.5929 - val_accuracy20: 0.5817 - val_accuracy30: 0.5667 - val_accuracy50: 0.5467 - 27s/epoch - 45ms/step
Epoch 21/50
614/614 - 28s - loss: 8.9333 - accuracy10: 0.7028 - accuracy20: 0.6802 - accuracy30: 0.6547 - accuracy50: 0.6204 - val_loss: 10.8984 - val_accuracy10: 0.5777 - val_accuracy20: 0.5686 - val_accuracy30: 0.5528 - val_accuracy50: 0.5334 - 28s/epoch - 45ms/step
Epoch 22/50
614/614 - 28s - loss: 8.8895 - accuracy10: 0.7035 - accuracy20: 0.6829 - accuracy30: 0.6575 - accuracy50: 0.6229 - val_loss: 10.8763 - val_accuracy10: 0.5770 - val_accuracy20: 0.5694 - val_accuracy30: 0.5553 - val_accuracy50: 0.5380 - 28s/epoch - 45ms/step
Epoch 23/50
614/614 - 28s - loss: 8.8769 - accuracy10: 0.7022 - accuracy20: 0.6816 - accuracy30: 0.6567 - accuracy50: 0.6220 - val_loss: 10.9184 - val_accuracy10: 0.5868 - val_accuracy20: 0.5746 - val_accuracy30: 0.5574 - val_accuracy50: 0.5352 - 28s/epoch - 45ms/step
Epoch 24/50
614/614 - 28s - loss: 8.7884 - accuracy10: 0.7065 - accuracy20: 0.6849 - accuracy30: 0.6594 - accuracy50: 0.6256 - val_loss: 11.1027 - val_accuracy10: 0.6115 - val_accuracy20: 0.5975 - val_accuracy30: 0.5793 - val_accuracy50: 0.5519 - 28s/epoch - 45ms/step
Epoch 25/50
614/614 - 28s - loss: 8.7340 - accuracy10: 0.7051 - accuracy20: 0.6841 - accuracy30: 0.6591 - accuracy50: 0.6254 - val_loss: 11.1030 - val_accuracy10: 0.6162 - val_accuracy20: 0.6019 - val_accuracy30: 0.5845 - val_accuracy50: 0.5562 - 28s/epoch - 45ms/step
Epoch 26/50
614/614 - 28s - loss: 8.6787 - accuracy10: 0.7058 - accuracy20: 0.6860 - accuracy30: 0.6607 - accuracy50: 0.6273 - val_loss: 11.1408 - val_accuracy10: 0.6154 - val_accuracy20: 0.6009 - val_accuracy30: 0.5825 - val_accuracy50: 0.5547 - 28s/epoch - 45ms/step
Epoch 27/50
614/614 - 27s - loss: 8.6286 - accuracy10: 0.7066 - accuracy20: 0.6870 - accuracy30: 0.6622 - accuracy50: 0.6304 - val_loss: 11.4791 - val_accuracy10: 0.6175 - val_accuracy20: 0.6010 - val_accuracy30: 0.5796 - val_accuracy50: 0.5512 - 27s/epoch - 45ms/step
Epoch 28/50
614/614 - 28s - loss: 8.5857 - accuracy10: 0.7065 - accuracy20: 0.6873 - accuracy30: 0.6637 - accuracy50: 0.6331 - val_loss: 11.4816 - val_accuracy10: 0.6044 - val_accuracy20: 0.5893 - val_accuracy30: 0.5710 - val_accuracy50: 0.5447 - 28s/epoch - 45ms/step
Epoch 29/50
614/614 - 28s - loss: 8.5400 - accuracy10: 0.7069 - accuracy20: 0.6874 - accuracy30: 0.6630 - accuracy50: 0.6325 - val_loss: 11.4149 - val_accuracy10: 0.5953 - val_accuracy20: 0.5817 - val_accuracy30: 0.5661 - val_accuracy50: 0.5416 - 28s/epoch - 45ms/step
Epoch 30/50
614/614 - 28s - loss: 8.5028 - accuracy10: 0.7080 - accuracy20: 0.6889 - accuracy30: 0.6648 - accuracy50: 0.6341 - val_loss: 11.2459 - val_accuracy10: 0.6084 - val_accuracy20: 0.5928 - val_accuracy30: 0.5730 - val_accuracy50: 0.5443 - 28s/epoch - 45ms/step
testing model: results/QRTEA/W8/deepLOB_L2/seq2seq
Evaluating performance on  test set...
2179/2179 - 34s - 34s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1259139
{'0': {'precision': 0.20968498375476763, 'recall': 0.7466449367215952, 'f1-score': 0.32741887098766526, 'support': 49701}, '1': {'precision': 0.9490339757675277, 'recall': 0.43553828629177166, 'f1-score': 0.5970661738141234, 'support': 459133}, '2': {'precision': 0.2166188505314646, 'recall': 0.7527887876435255, 'f1-score': 0.3364286301257294, 'support': 48946}, 'accuracy': 0.49109864104127077, 'macro avg': {'precision': 0.4584459366845866, 'recall': 0.6449906702189642, 'f1-score': 0.4203045583091727, 'support': 557780}, 'weighted avg': {'precision': 0.8188837821933039, 'recall': 0.49109864104127077, 'f1-score': 0.5501679239465235, 'support': 557780}}
[[ 37109   5726   6866]
 [132779 199970 126384]
 [  7087   5013  36846]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1250516
{'0': {'precision': 0.26868802542930686, 'recall': 0.7281032482598608, 'f1-score': 0.392524752668754, 'support': 68960}, '1': {'precision': 0.910384523969453, 'recall': 0.41819618863616403, 'f1-score': 0.5731218803721841, 'support': 421319}, '2': {'precision': 0.278348771783437, 'recall': 0.7314113864979778, 'f1-score': 0.4032392433597962, 'support': 67501}, 'accuracy': 0.4944153608949765, 'macro avg': {'precision': 0.4858071070607323, 'recall': 0.6259036077980009, 'f1-score': 0.4562952921335781, 'support': 557780}, 'weighted avg': {'precision': 0.7545624510237813, 'recall': 0.4944153608949765, 'f1-score': 0.530235391420623, 'support': 557780}}
[[ 50210   9125   9625]
 [126750 176194 118375]
 [  9911   8219  49371]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1245766
{'0': {'precision': 0.30671243830760375, 'recall': 0.7068455525036974, 'f1-score': 0.42779658367995005, 'support': 85194}, '1': {'precision': 0.8702819201778067, 'recall': 0.3978013802303805, 'f1-score': 0.5460198851681718, 'support': 389790}, '2': {'precision': 0.31787725348116463, 'recall': 0.7036330257500363, 'f1-score': 0.437918126193304, 'support': 82796}, 'accuracy': 0.4904012334612213, 'macro avg': {'precision': 0.4982905373221917, 'recall': 0.6027599861613714, 'f1-score': 0.470578198347142, 'support': 557780}, 'weighted avg': {'precision': 0.7022055545457202, 'recall': 0.4904012334612213, 'f1-score': 0.5119162794758366, 'support': 557780}}
[[ 60219  12220  12755]
 [122472 155059 112259]
 [ 13646  10892  58258]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1092538
{'0': {'precision': 0.35945227617897896, 'recall': 0.6567616845288389, 'f1-score': 0.46461570405232383, 'support': 112435}, '1': {'precision': 0.7846952168737218, 'recall': 0.3816815880510148, 'f1-score': 0.5135625387058752, 'support': 336765}, '2': {'precision': 0.37359117018398985, 'recall': 0.6487198379075336, 'f1-score': 0.47413360796707094, 'support': 108580}, 'accuracy': 0.4891139875936749, 'macro avg': {'precision': 0.5059128877455635, 'recall': 0.5623877034957958, 'f1-score': 0.48410395024175673, 'support': 557780}, 'weighted avg': {'precision': 0.6189491029460362, 'recall': 0.4891139875936749, 'f1-score': 0.4960206213658999, 'support': 557780}}
[[ 73843  18699  19893]
 [110016 128537  98212]
 [ 21573  16569  70438]]
Evaluating performance on  train set...
614/614 - 10s - 10s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8501654
{'0': {'precision': 0.2814301458121397, 'recall': 0.7373126041088284, 'f1-score': 0.40736877626775475, 'support': 18010}, '1': {'precision': 0.9345869019254298, 'recall': 0.6006522530874416, 'f1-score': 0.7313019948905809, 'support': 120812}, '2': {'precision': 0.3454026908053816, 'recall': 0.6100191623323296, 'f1-score': 0.4410664449854521, 'support': 18265}, 'accuracy': 0.6174094609993188, 'macro avg': {'precision': 0.5204732461809837, 'recall': 0.6493280065095332, 'f1-score': 0.5265790720479293, 'support': 157087}, 'weighted avg': {'precision': 0.7911962789349338, 'recall': 0.6174094609993188, 'f1-score': 0.6604165009514625, 'support': 157087}}
[[13279  2307  2424]
 [29554 72566 18692]
 [ 4351  2772 11142]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8602845
{'0': {'precision': 0.3427048660643525, 'recall': 0.7148702264837163, 'f1-score': 0.4633042267102373, 'support': 24196}, '1': {'precision': 0.8887972508591065, 'recall': 0.5954672290421505, 'f1-score': 0.7131473444470793, 'support': 108587}, '2': {'precision': 0.41535508637236085, 'recall': 0.5787524687294272, 'f1-score': 0.4836252986986195, 'support': 24304}, 'accuracy': 0.6112727342173445, 'macro avg': {'precision': 0.5489524010986067, 'recall': 0.6296966414184314, 'f1-score': 0.5533589566186454, 'support': 157087}, 'weighted avg': {'precision': 0.7314335625323848, 'recall': 0.6112727342173445, 'f1-score': 0.6391532655186435, 'support': 157087}}
[[17297  3644  3255]
 [27383 64660 16544]
 [ 5792  4446 14066]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.88307124
{'0': {'precision': 0.3763164701969624, 'recall': 0.7007156127434115, 'f1-score': 0.48966197047651105, 'support': 29066}, '1': {'precision': 0.8454598969830758, 'recall': 0.5810911959864056, 'f1-score': 0.6887791192585755, 'support': 98864}, '2': {'precision': 0.45549050406968444, 'recall': 0.5470041499468395, 'f1-score': 0.4970703733715639, 'support': 29157}, 'accuracy': 0.5968985339334254, 'macro avg': {'precision': 0.5590889570832408, 'recall': 0.6096036528922189, 'f1-score': 0.5585038210355502, 'support': 157087}, 'weighted avg': {'precision': 0.686271291737951, 'recall': 0.5968985339334254, 'f1-score': 0.6163530690422808, 'support': 157087}}
[[20367  4671  4028]
 [26377 57449 15038]
 [ 7378  5830 15949]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9201601
{'0': {'precision': 0.42232227898519353, 'recall': 0.6601250575210459, 'f1-score': 0.5151022304832713, 'support': 36943}, '1': {'precision': 0.7552446449414808, 'recall': 0.573500700691109, 'f1-score': 0.6519433305874585, 'support': 83489}, '2': {'precision': 0.4952982417093256, 'recall': 0.48569090165052514, 'f1-score': 0.49044752682543835, 'support': 36655}, 'accuracy': 0.5733829024680591, 'macro avg': {'precision': 0.5576217218786667, 'recall': 0.57310555328756, 'f1-score': 0.5524976959653894, 'support': 157087}, 'weighted avg': {'precision': 0.6162930679427618, 'recall': 0.5733829024680591, 'f1-score': 0.5820779092092042, 'support': 157087}}
[[24387  6986  5570]
 [23037 47881 12571]
 [10321  8531 17803]]
Evaluating performance on  val set...
190/190 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8982998
{'0': {'precision': 0.2278644155174636, 'recall': 0.6941499803690616, 'f1-score': 0.34310110615175626, 'support': 5094}, '1': {'precision': 0.921101446885692, 'recall': 0.5841677341768843, 'f1-score': 0.7149256119020957, 'support': 38251}, '2': {'precision': 0.336445405897757, 'recall': 0.5666347075743049, 'f1-score': 0.4222031718816974, 'support': 5215}, 'accuracy': 0.5938220757825371, 'macro avg': {'precision': 0.49513708943363754, 'recall': 0.6149841407067503, 'f1-score': 0.4934099633118498, 'support': 48560}, 'weighted avg': {'precision': 0.785592165758389, 'recall': 0.5938220757825371, 'f1-score': 0.6444844760495709, 'support': 48560}}
[[ 3536   822   736]
 [10814 22345  5092]
 [ 1168  1092  2955]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9238836
{'0': {'precision': 0.27929594272076375, 'recall': 0.6931734044128536, 'f1-score': 0.3981627184961511, 'support': 6753}, '1': {'precision': 0.8788631224227376, 'recall': 0.5658131369358568, 'f1-score': 0.6884203945540427, 'support': 35031}, '2': {'precision': 0.40899751270682383, 'recall': 0.55814639905549, 'f1-score': 0.472071397366286, 'support': 6776}, 'accuracy': 0.5824546952224052, 'macro avg': {'precision': 0.5223855259501083, 'recall': 0.6057109801347335, 'f1-score': 0.51955150347216, 'support': 48560}, 'weighted avg': {'precision': 0.7299198247299357, 'recall': 0.5824546952224052, 'f1-score': 0.6178666282574369, 'support': 48560}}
[[ 4681  1190   882]
 [10627 19821  4583]
 [ 1452  1542  3782]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.95080006
{'0': {'precision': 0.3094428021640917, 'recall': 0.6869737493808816, 'f1-score': 0.4266871755431648, 'support': 8076}, '1': {'precision': 0.8400628511570326, 'recall': 0.5437985451855505, 'f1-score': 0.6602177899187964, 'support': 32444}, '2': {'precision': 0.44854086613355487, 'recall': 0.5371890547263681, 'f1-score': 0.4888788273246929, 'support': 8040}, 'accuracy': 0.5665156507413509, 'macro avg': {'precision': 0.5326821731515597, 'recall': 0.5893204497642667, 'f1-score': 0.525261264262218, 'support': 48560}, 'weighted avg': {'precision': 0.6869919229186523, 'recall': 0.5665156507413509, 'f1-score': 0.59301106625829, 'support': 48560}}
[[ 5548  1493  1035]
 [10526 17643  4275]
 [ 1855  1866  4319]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9875611
{'0': {'precision': 0.35184599156118146, 'recall': 0.6535710786715, 'f1-score': 0.45743477217403233, 'support': 10207}, '1': {'precision': 0.7620619603859827, 'recall': 0.5307746727980192, 'f1-score': 0.6257297748123436, 'support': 28270}, '2': {'precision': 0.48688193743693237, 'recall': 0.47852821580878707, 'f1-score': 0.4826689341269444, 'support': 10083}, 'accuracy': 0.5457372322899505, 'macro avg': {'precision': 0.5335966297946989, 'recall': 0.554291322426102, 'f1-score': 0.5219444937044401, 'support': 48560}, 'weighted avg': {'precision': 0.6186988103614764, 'recall': 0.5457372322899505, 'f1-score': 0.5606500888864762, 'support': 48560}}
[[ 6671  2117  1419]
 [ 9599 15005  3666]
 [ 2690  2568  4825]]
training model: results/QRTEA/W8/deepOF_L2/seq2seq
Epoch 1/50
614/614 - 23s - loss: 11.3820 - accuracy10: 0.5500 - accuracy20: 0.5369 - accuracy30: 0.5210 - accuracy50: 0.5021 - val_loss: 11.7145 - val_accuracy10: 0.7715 - val_accuracy20: 0.7360 - val_accuracy30: 0.6993 - val_accuracy50: 0.6311 - 23s/epoch - 37ms/step
Epoch 2/50
614/614 - 18s - loss: 10.4144 - accuracy10: 0.6267 - accuracy20: 0.6099 - accuracy30: 0.5869 - accuracy50: 0.5532 - val_loss: 11.0143 - val_accuracy10: 0.7806 - val_accuracy20: 0.7474 - val_accuracy30: 0.7123 - val_accuracy50: 0.6438 - 18s/epoch - 29ms/step
Epoch 3/50
614/614 - 17s - loss: 9.9961 - accuracy10: 0.6611 - accuracy20: 0.6401 - accuracy30: 0.6126 - accuracy50: 0.5729 - val_loss: 10.9288 - val_accuracy10: 0.7757 - val_accuracy20: 0.7451 - val_accuracy30: 0.7108 - val_accuracy50: 0.6469 - 17s/epoch - 28ms/step
Epoch 4/50
614/614 - 18s - loss: 9.7225 - accuracy10: 0.6690 - accuracy20: 0.6493 - accuracy30: 0.6241 - accuracy50: 0.5865 - val_loss: 10.7689 - val_accuracy10: 0.7814 - val_accuracy20: 0.7502 - val_accuracy30: 0.7153 - val_accuracy50: 0.6515 - 18s/epoch - 29ms/step
Epoch 5/50
614/614 - 17s - loss: 9.5616 - accuracy10: 0.6773 - accuracy20: 0.6571 - accuracy30: 0.6312 - accuracy50: 0.5939 - val_loss: 10.5975 - val_accuracy10: 0.7769 - val_accuracy20: 0.7461 - val_accuracy30: 0.7127 - val_accuracy50: 0.6504 - 17s/epoch - 28ms/step
Epoch 6/50
614/614 - 17s - loss: 9.4362 - accuracy10: 0.6794 - accuracy20: 0.6586 - accuracy30: 0.6328 - accuracy50: 0.5969 - val_loss: 10.5441 - val_accuracy10: 0.7733 - val_accuracy20: 0.7413 - val_accuracy30: 0.7084 - val_accuracy50: 0.6492 - 17s/epoch - 27ms/step
Epoch 7/50
614/614 - 17s - loss: 9.3519 - accuracy10: 0.6839 - accuracy20: 0.6610 - accuracy30: 0.6355 - accuracy50: 0.5998 - val_loss: 10.4626 - val_accuracy10: 0.7710 - val_accuracy20: 0.7396 - val_accuracy30: 0.7058 - val_accuracy50: 0.6481 - 17s/epoch - 27ms/step
Epoch 8/50
614/614 - 16s - loss: 9.2681 - accuracy10: 0.6876 - accuracy20: 0.6656 - accuracy30: 0.6408 - accuracy50: 0.6044 - val_loss: 10.6885 - val_accuracy10: 0.7710 - val_accuracy20: 0.7420 - val_accuracy30: 0.7093 - val_accuracy50: 0.6504 - 16s/epoch - 27ms/step
Epoch 9/50
614/614 - 17s - loss: 9.2007 - accuracy10: 0.6920 - accuracy20: 0.6683 - accuracy30: 0.6427 - accuracy50: 0.6073 - val_loss: 10.6499 - val_accuracy10: 0.7697 - val_accuracy20: 0.7400 - val_accuracy30: 0.7077 - val_accuracy50: 0.6492 - 17s/epoch - 27ms/step
Epoch 10/50
614/614 - 17s - loss: 9.1365 - accuracy10: 0.6947 - accuracy20: 0.6697 - accuracy30: 0.6449 - accuracy50: 0.6106 - val_loss: 10.8251 - val_accuracy10: 0.7615 - val_accuracy20: 0.7309 - val_accuracy30: 0.6990 - val_accuracy50: 0.6433 - 17s/epoch - 27ms/step
Epoch 11/50
614/614 - 17s - loss: 9.0744 - accuracy10: 0.6974 - accuracy20: 0.6729 - accuracy30: 0.6487 - accuracy50: 0.6139 - val_loss: 10.6173 - val_accuracy10: 0.7582 - val_accuracy20: 0.7271 - val_accuracy30: 0.6955 - val_accuracy50: 0.6409 - 17s/epoch - 27ms/step
Epoch 12/50
614/614 - 16s - loss: 9.0104 - accuracy10: 0.6982 - accuracy20: 0.6734 - accuracy30: 0.6485 - accuracy50: 0.6143 - val_loss: 10.6586 - val_accuracy10: 0.7617 - val_accuracy20: 0.7314 - val_accuracy30: 0.6992 - val_accuracy50: 0.6440 - 16s/epoch - 27ms/step
Epoch 13/50
614/614 - 16s - loss: 8.9552 - accuracy10: 0.7002 - accuracy20: 0.6764 - accuracy30: 0.6517 - accuracy50: 0.6171 - val_loss: 10.6188 - val_accuracy10: 0.7461 - val_accuracy20: 0.7151 - val_accuracy30: 0.6836 - val_accuracy50: 0.6305 - 16s/epoch - 27ms/step
Epoch 14/50
614/614 - 17s - loss: 8.8785 - accuracy10: 0.7033 - accuracy20: 0.6783 - accuracy30: 0.6537 - accuracy50: 0.6204 - val_loss: 10.9071 - val_accuracy10: 0.7383 - val_accuracy20: 0.7072 - val_accuracy30: 0.6747 - val_accuracy50: 0.6246 - 17s/epoch - 27ms/step
Epoch 15/50
614/614 - 17s - loss: 8.8400 - accuracy10: 0.7023 - accuracy20: 0.6786 - accuracy30: 0.6554 - accuracy50: 0.6222 - val_loss: 10.7342 - val_accuracy10: 0.7588 - val_accuracy20: 0.7265 - val_accuracy30: 0.6929 - val_accuracy50: 0.6372 - 17s/epoch - 28ms/step
Epoch 16/50
614/614 - 17s - loss: 8.7905 - accuracy10: 0.7031 - accuracy20: 0.6794 - accuracy30: 0.6562 - accuracy50: 0.6240 - val_loss: 11.1033 - val_accuracy10: 0.7450 - val_accuracy20: 0.7130 - val_accuracy30: 0.6808 - val_accuracy50: 0.6281 - 17s/epoch - 28ms/step
Epoch 17/50
614/614 - 17s - loss: 8.7081 - accuracy10: 0.7059 - accuracy20: 0.6830 - accuracy30: 0.6603 - accuracy50: 0.6280 - val_loss: 11.3628 - val_accuracy10: 0.7496 - val_accuracy20: 0.7173 - val_accuracy30: 0.6857 - val_accuracy50: 0.6328 - 17s/epoch - 28ms/step
testing model: results/QRTEA/W8/deepOF_L2/seq2seq
Evaluating performance on  test set...
2179/2179 - 20s - 20s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5160845
{'0': {'precision': 0.41894792946715426, 'recall': 0.569367592909314, 'f1-score': 0.4827109738830794, 'support': 49699}, '1': {'precision': 0.91514714388093, 'recall': 0.8649800057499804, 'f1-score': 0.8893566753816783, 'support': 459132}, '2': {'precision': 0.4390694698679557, 'recall': 0.5047809741745668, 'f1-score': 0.46963778240331516, 'support': 48944}, 'accuracy': 0.8070333019586751, 'macro avg': {'precision': 0.59105484773868, 'recall': 0.6463761909446204, 'f1-score': 0.6139018105560242, 'support': 557775}, 'weighted avg': {'precision': 0.8291595136822992, 'recall': 0.8070333019586751, 'f1-score': 0.8162938700987024, 'support': 557775}}
[[ 28297  17442   3960]
 [ 34389 397140  27603]
 [  4857  19381  24706]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.5761132
{'0': {'precision': 0.5006252605252188, 'recall': 0.5224995286917934, 'f1-score': 0.5113285601765453, 'support': 68957}, '1': {'precision': 0.8576829698588396, 'recall': 0.8711899325450135, 'f1-score': 0.8643836890698022, 'support': 421318}, '2': {'precision': 0.5293680425914402, 'recall': 0.4537037037037037, 'f1-score': 0.48862403471823346, 'support': 67500}, 'accuracy': 0.7775590515889024, 'macro avg': {'precision': 0.6292254243251663, 'recall': 0.6157977216468369, 'f1-score': 0.6214454279881937, 'support': 557775}, 'weighted avg': {'precision': 0.773808852063908, 'recall': 0.7775590515889024, 'f1-score': 0.7752628084426261, 'support': 557775}}
[[ 36030  29100   3827]
 [ 30870 367048  23400]
 [  5070  31805  30625]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6471506
{'0': {'precision': 0.5439514833458284, 'recall': 0.47694005235294806, 'f1-score': 0.5082464490546449, 'support': 85191}, '1': {'precision': 0.8029683864010443, 'recall': 0.8710866648366168, 'f1-score': 0.8356416393382105, 'support': 389789}, '2': {'precision': 0.572273051824054, 'recall': 0.4162570203514705, 'f1-score': 0.4819533205610483, 'support': 82795}, 'accuracy': 0.7433732239702389, 'macro avg': {'precision': 0.6397309738569755, 'recall': 0.588094579180345, 'f1-score': 0.6086138029846345, 'support': 557775}, 'weighted avg': {'precision': 0.7291638429660054, 'recall': 0.7433732239702389, 'f1-score': 0.7331366005526744, 'support': 557775}}
[[ 40631  40654   3906]
 [ 28396 339540  21853]
 [  5669  42662  34464]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7724645
{'0': {'precision': 0.5848697420919499, 'recall': 0.39896114985057635, 'f1-score': 0.47435043304463687, 'support': 112432}, '1': {'precision': 0.7014519099672304, 'recall': 0.8708056680642824, 'f1-score': 0.7770079249212409, 'support': 336764}, '2': {'precision': 0.6158924632207075, 'recall': 0.3574171801177023, 'f1-score': 0.45233405210093824, 'support': 108579}, 'accuracy': 0.6757563533682936, 'macro avg': {'precision': 0.6340713717599625, 'recall': 0.5423946660108537, 'f1-score': 0.567897470022272, 'support': 557775}, 'weighted avg': {'precision': 0.6612967838557262, 'recall': 0.6757563533682936, 'f1-score': 0.652798070475226, 'support': 557775}}
[[ 44856  62709   4867]
 [ 24172 293256  19336]
 [  7666  62105  38808]]
Evaluating performance on  train set...
614/614 - 6s - 6s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.56275666
{'0': {'precision': 0.45233560090702946, 'recall': 0.5550361713967724, 'f1-score': 0.4984507746126936, 'support': 17970}, '1': {'precision': 0.8860926817768497, 'recall': 0.8707627644523138, 'f1-score': 0.8783608404448432, 'support': 120863}, '2': {'precision': 0.5174640265649981, 'recall': 0.46107062626705386, 'f1-score': 0.48764233766986353, 'support': 18251}, 'accuracy': 0.7870438746148557, 'macro avg': {'precision': 0.6186307697496257, 'recall': 0.62895652070538, 'f1-score': 0.6214846509091335, 'support': 157084}, 'weighted avg': {'precision': 0.7936424237651989, 'recall': 0.7870438746148557, 'f1-score': 0.7895040041206479, 'support': 157084}}
[[  9974   6201   1795]
 [  9568 105243   6052]
 [  2508   7328   8415]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.634656
{'0': {'precision': 0.513383807041496, 'recall': 0.5146827042720863, 'f1-score': 0.5140324351194052, 'support': 24110}, '1': {'precision': 0.8185153605663643, 'recall': 0.8745789851471482, 'f1-score': 0.8456189522856189, 'support': 108666}, '2': {'precision': 0.5874196619852416, 'recall': 0.40608030278097745, 'f1-score': 0.480200428098852, 'support': 24308}, 'accuracy': 0.7468424537190294, 'macro avg': {'precision': 0.6397729431977007, 'recall': 0.598447330733404, 'f1-score': 0.6132839385012919, 'support': 157084}, 'weighted avg': {'precision': 0.7359213599259776, 'recall': 0.7468424537190294, 'f1-score': 0.7381787011154849, 'support': 157084}}
[[12409  9710  1991]
 [ 8687 95037  4942]
 [ 3075 11362  9871]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7080579
{'0': {'precision': 0.5456290897692097, 'recall': 0.47997380394319594, 'f1-score': 0.5106999431536867, 'support': 29012}, '1': {'precision': 0.757577617961761, 'recall': 0.8733885400552067, 'f1-score': 0.8113713536945627, 'support': 98901}, '2': {'precision': 0.6120389899105056, 'recall': 0.36807102944705355, 'f1-score': 0.459690884959541, 'support': 29171}, 'accuracy': 0.7068893076315856, 'macro avg': {'precision': 0.6384152325471587, 'recall': 0.5738111244818187, 'f1-score': 0.5939207272692634, 'support': 157084}, 'weighted avg': {'precision': 0.6914056461581052, 'recall': 0.7068893076315856, 'f1-score': 0.6905318670754212, 'support': 157084}}
[[13925 12885  2202]
 [ 7918 86379  4604]
 [ 3678 14756 10737]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.83138967
{'0': {'precision': 0.5772226193611498, 'recall': 0.41567097455905067, 'f1-score': 0.48330393145161293, 'support': 36909}, '1': {'precision': 0.6490666333693064, 'recall': 0.8715866628341478, 'f1-score': 0.7440457628938181, 'support': 83496}, '2': {'precision': 0.6184181897302001, 'recall': 0.3099593773003626, 'f1-score': 0.4129451718940123, 'support': 36679}, 'accuracy': 0.6333235721015508, 'macro avg': {'precision': 0.6149024808202187, 'recall': 0.5324056715645203, 'f1-score': 0.5467649554131477, 'support': 157084}, 'weighted avg': {'precision': 0.6250295259792105, 'recall': 0.6333235721015508, 'f1-score': 0.6054692125514394, 'support': 157084}}
[[15342 18647  2920]
 [ 6627 72774  4095]
 [ 4610 20700 11369]]
Evaluating performance on  val set...
190/190 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.593687
{'0': {'precision': 0.38493543758967, 'recall': 0.5286699507389162, 'f1-score': 0.44549605645496054, 'support': 5075}, '1': {'precision': 0.8968062376869502, 'recall': 0.8450777879461367, 'f1-score': 0.8701739270906252, 'support': 38245}, '2': {'precision': 0.43956043956043955, 'recall': 0.46564885496183206, 'f1-score': 0.45222870910944307, 'support': 5240}, 'accuracy': 0.7710667215815487, 'macro avg': {'precision': 0.5737673716123532, 'recall': 0.613132197882295, 'f1-score': 0.589299564218343, 'support': 48560}, 'weighted avg': {'precision': 0.7939703173270529, 'recall': 0.7710667215815487, 'f1-score': 0.7806913666355718, 'support': 48560}}
[[ 2683  1784   608]
 [ 3422 32320  2503]
 [  865  1935  2440]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6496253
{'0': {'precision': 0.45239046477560263, 'recall': 0.5022176227084565, 'f1-score': 0.4760036432424858, 'support': 6764}, '1': {'precision': 0.8375385835244811, 'recall': 0.845294235331104, 'f1-score': 0.841398537737191, 'support': 34989}, '2': {'precision': 0.5151620773788776, 'recall': 0.43425885118260615, 'f1-score': 0.4712634515743324, 'support': 6807}, 'accuracy': 0.7398887973640856, 'macro avg': {'precision': 0.6016970418929871, 'recall': 0.5939235697407222, 'f1-score': 0.596221877518003, 'support': 48560}, 'weighted avg': {'precision': 0.7387008826894206, 'recall': 0.7398887973640856, 'f1-score': 0.7386176358040616, 'support': 48560}}
[[ 3397  2766   601]
 [ 3232 29576  2181]
 [  880  2971  2956]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.71158874
{'0': {'precision': 0.48716966679433166, 'recall': 0.47210194234813807, 'f1-score': 0.47951746670017587, 'support': 8083}, '1': {'precision': 0.7842031029619182, 'recall': 0.8406306890061402, 'f1-score': 0.8114370811615785, 'support': 32409}, '2': {'precision': 0.545439358503174, 'recall': 0.4046851760039663, 'f1-score': 0.46463640244770177, 'support': 8068}, 'accuracy': 0.7068574958813838, 'macro avg': {'precision': 0.6056040427531413, 'recall': 0.5724726024527481, 'f1-score': 0.5851969834364854, 'support': 48560}, 'weighted avg': {'precision': 0.6950913411242793, 'recall': 0.7068574958813838, 'f1-score': 0.6985685861130803, 'support': 48560}}
[[ 3816  3656   611]
 [ 3055 27244  2110]
 [  962  3841  3265]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.81742036
{'0': {'precision': 0.5250030868008396, 'recall': 0.415234375, 'f1-score': 0.4637112165330716, 'support': 10240}, '1': {'precision': 0.691311844297028, 'recall': 0.8384192805245437, 'f1-score': 0.7577922285933946, 'support': 28215}, '2': {'precision': 0.5743351489907081, 'recall': 0.35477486392874813, 'f1-score': 0.4386125894659571, 'support': 10105}, 'accuracy': 0.6485378912685338, 'macro avg': {'precision': 0.5968833600295252, 'recall': 0.536142839817764, 'f1-score': 0.5533720115308077, 'support': 48560}, 'weighted avg': {'precision': 0.6318997523935822, 'recall': 0.6485378912685338, 'f1-score': 0.6293593658075531, 'support': 48560}}
[[ 4252  5249   739]
 [ 2641 23656  1918]
 [ 1206  5314  3585]]
training model: results/QRTEA/W8/deepVOL_L2/seq2seq
Epoch 1/50
614/614 - 22s - loss: 11.6609 - accuracy10: 0.5207 - accuracy20: 0.5201 - accuracy30: 0.5135 - accuracy50: 0.5014 - val_loss: 11.1100 - val_accuracy10: 0.6531 - val_accuracy20: 0.6387 - val_accuracy30: 0.6212 - val_accuracy50: 0.5862 - 22s/epoch - 35ms/step
Epoch 2/50
614/614 - 16s - loss: 10.8903 - accuracy10: 0.5996 - accuracy20: 0.5939 - accuracy30: 0.5786 - accuracy50: 0.5487 - val_loss: 11.2803 - val_accuracy10: 0.6971 - val_accuracy20: 0.6800 - val_accuracy30: 0.6588 - val_accuracy50: 0.6124 - 16s/epoch - 26ms/step
Epoch 3/50
614/614 - 16s - loss: 10.5080 - accuracy10: 0.6359 - accuracy20: 0.6261 - accuracy30: 0.6078 - accuracy50: 0.5730 - val_loss: 10.3759 - val_accuracy10: 0.6578 - val_accuracy20: 0.6501 - val_accuracy30: 0.6366 - val_accuracy50: 0.6024 - 16s/epoch - 26ms/step
Epoch 4/50
614/614 - 16s - loss: 10.2524 - accuracy10: 0.6575 - accuracy20: 0.6400 - accuracy30: 0.6165 - accuracy50: 0.5793 - val_loss: 10.5073 - val_accuracy10: 0.6836 - val_accuracy20: 0.6728 - val_accuracy30: 0.6568 - val_accuracy50: 0.6166 - 16s/epoch - 26ms/step
Epoch 5/50
614/614 - 16s - loss: 10.1395 - accuracy10: 0.6711 - accuracy20: 0.6483 - accuracy30: 0.6214 - accuracy50: 0.5813 - val_loss: 10.2721 - val_accuracy10: 0.7163 - val_accuracy20: 0.6953 - val_accuracy30: 0.6729 - val_accuracy50: 0.6251 - 16s/epoch - 26ms/step
Epoch 6/50
614/614 - 16s - loss: 10.0125 - accuracy10: 0.6846 - accuracy20: 0.6603 - accuracy30: 0.6330 - accuracy50: 0.5908 - val_loss: 10.3509 - val_accuracy10: 0.6937 - val_accuracy20: 0.6767 - val_accuracy30: 0.6571 - val_accuracy50: 0.6153 - 16s/epoch - 26ms/step
Epoch 7/50
614/614 - 16s - loss: 9.9035 - accuracy10: 0.6867 - accuracy20: 0.6630 - accuracy30: 0.6350 - accuracy50: 0.5955 - val_loss: 10.1996 - val_accuracy10: 0.7061 - val_accuracy20: 0.6920 - val_accuracy30: 0.6732 - val_accuracy50: 0.6293 - 16s/epoch - 26ms/step
Epoch 8/50
614/614 - 16s - loss: 9.8344 - accuracy10: 0.6917 - accuracy20: 0.6661 - accuracy30: 0.6380 - accuracy50: 0.5961 - val_loss: 10.2858 - val_accuracy10: 0.7069 - val_accuracy20: 0.6852 - val_accuracy30: 0.6626 - val_accuracy50: 0.6182 - 16s/epoch - 26ms/step
Epoch 9/50
614/614 - 16s - loss: 9.7775 - accuracy10: 0.6952 - accuracy20: 0.6699 - accuracy30: 0.6403 - accuracy50: 0.5992 - val_loss: 10.2001 - val_accuracy10: 0.7114 - val_accuracy20: 0.6946 - val_accuracy30: 0.6736 - val_accuracy50: 0.6274 - 16s/epoch - 26ms/step
Epoch 10/50
614/614 - 16s - loss: 9.7025 - accuracy10: 0.6969 - accuracy20: 0.6717 - accuracy30: 0.6439 - accuracy50: 0.6021 - val_loss: 10.2275 - val_accuracy10: 0.6916 - val_accuracy20: 0.6729 - val_accuracy30: 0.6520 - val_accuracy50: 0.6123 - 16s/epoch - 26ms/step
Epoch 11/50
614/614 - 16s - loss: 9.6559 - accuracy10: 0.6995 - accuracy20: 0.6725 - accuracy30: 0.6431 - accuracy50: 0.6024 - val_loss: 10.1569 - val_accuracy10: 0.6813 - val_accuracy20: 0.6647 - val_accuracy30: 0.6427 - val_accuracy50: 0.6057 - 16s/epoch - 26ms/step
Epoch 12/50
614/614 - 16s - loss: 9.5871 - accuracy10: 0.7023 - accuracy20: 0.6746 - accuracy30: 0.6455 - accuracy50: 0.6049 - val_loss: 10.1807 - val_accuracy10: 0.7217 - val_accuracy20: 0.7010 - val_accuracy30: 0.6768 - val_accuracy50: 0.6290 - 16s/epoch - 26ms/step
Epoch 13/50
614/614 - 16s - loss: 9.5324 - accuracy10: 0.7010 - accuracy20: 0.6753 - accuracy30: 0.6465 - accuracy50: 0.6068 - val_loss: 10.1583 - val_accuracy10: 0.7059 - val_accuracy20: 0.6865 - val_accuracy30: 0.6634 - val_accuracy50: 0.6186 - 16s/epoch - 26ms/step
Epoch 14/50
614/614 - 16s - loss: 9.4721 - accuracy10: 0.7021 - accuracy20: 0.6741 - accuracy30: 0.6446 - accuracy50: 0.6058 - val_loss: 10.0433 - val_accuracy10: 0.7043 - val_accuracy20: 0.6856 - val_accuracy30: 0.6625 - val_accuracy50: 0.6196 - 16s/epoch - 26ms/step
Epoch 15/50
614/614 - 16s - loss: 9.4097 - accuracy10: 0.7023 - accuracy20: 0.6748 - accuracy30: 0.6459 - accuracy50: 0.6081 - val_loss: 10.1757 - val_accuracy10: 0.7226 - val_accuracy20: 0.7015 - val_accuracy30: 0.6772 - val_accuracy50: 0.6281 - 16s/epoch - 26ms/step
Epoch 16/50
614/614 - 16s - loss: 9.3637 - accuracy10: 0.7036 - accuracy20: 0.6764 - accuracy30: 0.6469 - accuracy50: 0.6093 - val_loss: 10.1511 - val_accuracy10: 0.7095 - val_accuracy20: 0.6917 - val_accuracy30: 0.6666 - val_accuracy50: 0.6228 - 16s/epoch - 26ms/step
Epoch 17/50
614/614 - 16s - loss: 9.3014 - accuracy10: 0.7041 - accuracy20: 0.6769 - accuracy30: 0.6483 - accuracy50: 0.6107 - val_loss: 10.0906 - val_accuracy10: 0.7113 - val_accuracy20: 0.6936 - val_accuracy30: 0.6680 - val_accuracy50: 0.6228 - 16s/epoch - 26ms/step
Epoch 18/50
614/614 - 16s - loss: 9.2707 - accuracy10: 0.7036 - accuracy20: 0.6760 - accuracy30: 0.6475 - accuracy50: 0.6112 - val_loss: 10.1509 - val_accuracy10: 0.6773 - val_accuracy20: 0.6637 - val_accuracy30: 0.6452 - val_accuracy50: 0.6077 - 16s/epoch - 26ms/step
Epoch 19/50
614/614 - 16s - loss: 9.2210 - accuracy10: 0.7056 - accuracy20: 0.6768 - accuracy30: 0.6486 - accuracy50: 0.6117 - val_loss: 10.0791 - val_accuracy10: 0.7016 - val_accuracy20: 0.6819 - val_accuracy30: 0.6592 - val_accuracy50: 0.6175 - 16s/epoch - 26ms/step
Epoch 20/50
614/614 - 16s - loss: 9.1746 - accuracy10: 0.7033 - accuracy20: 0.6766 - accuracy30: 0.6491 - accuracy50: 0.6146 - val_loss: 10.1076 - val_accuracy10: 0.6796 - val_accuracy20: 0.6632 - val_accuracy30: 0.6394 - val_accuracy50: 0.6006 - 16s/epoch - 26ms/step
Epoch 21/50
614/614 - 16s - loss: 9.1407 - accuracy10: 0.7059 - accuracy20: 0.6784 - accuracy30: 0.6512 - accuracy50: 0.6155 - val_loss: 10.0805 - val_accuracy10: 0.6934 - val_accuracy20: 0.6750 - val_accuracy30: 0.6523 - val_accuracy50: 0.6093 - 16s/epoch - 26ms/step
Epoch 22/50
614/614 - 16s - loss: 9.0982 - accuracy10: 0.7043 - accuracy20: 0.6782 - accuracy30: 0.6523 - accuracy50: 0.6174 - val_loss: 10.1871 - val_accuracy10: 0.6540 - val_accuracy20: 0.6368 - val_accuracy30: 0.6147 - val_accuracy50: 0.5797 - 16s/epoch - 26ms/step
Epoch 23/50
614/614 - 16s - loss: 9.0486 - accuracy10: 0.7055 - accuracy20: 0.6785 - accuracy30: 0.6516 - accuracy50: 0.6172 - val_loss: 10.1988 - val_accuracy10: 0.6770 - val_accuracy20: 0.6592 - val_accuracy30: 0.6371 - val_accuracy50: 0.5985 - 16s/epoch - 26ms/step
Epoch 24/50
614/614 - 16s - loss: 8.9969 - accuracy10: 0.7055 - accuracy20: 0.6813 - accuracy30: 0.6543 - accuracy50: 0.6190 - val_loss: 10.2036 - val_accuracy10: 0.6731 - val_accuracy20: 0.6551 - val_accuracy30: 0.6323 - val_accuracy50: 0.5956 - 16s/epoch - 26ms/step
testing model: results/QRTEA/W8/deepVOL_L2/seq2seq
Evaluating performance on  test set...
2179/2179 - 19s - 19s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6569098
{'0': {'precision': 0.3737847678390451, 'recall': 0.60107442506187, 'f1-score': 0.46093316052582856, 'support': 49701}, '1': {'precision': 0.9333995887781894, 'recall': 0.7425451884312388, 'f1-score': 0.8271052637963284, 'support': 459133}, '2': {'precision': 0.2952115377784093, 'recall': 0.679156621582969, 'f1-score': 0.4115382234602291, 'support': 48946}, 'accuracy': 0.7243769945139661, 'macro avg': {'precision': 0.534131964798548, 'recall': 0.6742587450253593, 'f1-score': 0.5665255492607953, 'support': 557780}, 'weighted avg': {'precision': 0.8275331744934685, 'recall': 0.7243769945139661, 'f1-score': 0.758010882389792, 'support': 557780}}
[[ 29874  13901   5926]
 [ 44770 340927  73436]
 [  5279  10425  33242]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.68850315
{'0': {'precision': 0.4490525353614663, 'recall': 0.5556699535962877, 'f1-score': 0.4967043222958916, 'support': 68960}, '1': {'precision': 0.8823384835383361, 'recall': 0.7498261412373997, 'f1-score': 0.8107030998392276, 'support': 421319}, '2': {'precision': 0.3736877529435417, 'recall': 0.6333387653516244, 'f1-score': 0.4700391415252001, 'support': 67501}, 'accuracy': 0.7117250528882355, 'macro avg': {'precision': 0.568359590614448, 'recall': 0.6462782867284372, 'f1-score': 0.5924821878867731, 'support': 557780}, 'weighted avg': {'precision': 0.7672145422852324, 'recall': 0.7117250528882355, 'f1-score': 0.7306562829050535, 'support': 557780}}
[[ 38319  23514   7127]
 [ 40878 315916  64525]
 [  6136  18614  42751]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.73652023
{'0': {'precision': 0.4880996217319988, 'recall': 0.5134516515247552, 'f1-score': 0.5004547716702991, 'support': 85194}, '1': {'precision': 0.8314313670832788, 'recall': 0.7498986633828472, 'f1-score': 0.7885631194729658, 'support': 389790}, '2': {'precision': 0.41883442686221534, 'recall': 0.5898111019856032, 'f1-score': 0.4898315370302571, 'support': 82796}, 'accuracy': 0.690021155294202, 'macro avg': {'precision': 0.5794551385591643, 'recall': 0.6177204722977352, 'f1-score': 0.5929498093911739, 'support': 557780}, 'weighted avg': {'precision': 0.7177464357913714, 'recall': 0.690021155294202, 'f1-score': 0.7002148770070709, 'support': 557780}}
[[ 43743  32772   8679]
 [ 38405 292303  59082]
 [  7471  26491  48834]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.82750297
{'0': {'precision': 0.5264874203649714, 'recall': 0.4336550006670521, 'f1-score': 0.47558340852008096, 'support': 112435}, '1': {'precision': 0.7327792996544746, 'recall': 0.7538075512597806, 'f1-score': 0.7431446997485341, 'support': 336765}, '2': {'precision': 0.4735011495608088, 'recall': 0.5178117517038129, 'f1-score': 0.4946661329133692, 'support': 108580}, 'accuracy': 0.6433324966832802, 'macro avg': {'precision': 0.577589289860085, 'recall': 0.5684247678768819, 'f1-score': 0.5711314137273281, 'support': 557780}, 'weighted avg': {'precision': 0.6407235626522775, 'recall': 0.6433324966832802, 'f1-score': 0.6408408226532039, 'support': 557780}}
[[ 48758  50932  12745]
 [ 33137 253856  49772]
 [ 10715  41641  56224]]
Evaluating performance on  train set...
614/614 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.71046185
{'0': {'precision': 0.3729656572491964, 'recall': 0.6120488617434758, 'f1-score': 0.4634920634920635, 'support': 18010}, '1': {'precision': 0.9137649303688711, 'recall': 0.7174535642154752, 'f1-score': 0.8037965586152854, 'support': 120812}, '2': {'precision': 0.34938026013771994, 'recall': 0.6250205310703532, 'f1-score': 0.4482135846093443, 'support': 18265}, 'accuracy': 0.6946214518069604, 'macro avg': {'precision': 0.5453702825852624, 'recall': 0.6515076523431014, 'f1-score': 0.5718340689055644, 'support': 157087}, 'weighted avg': {'precision': 0.7861395959321746, 'recall': 0.6946214518069604, 'f1-score': 0.7234359496700019, 'support': 157087}}
[[11023  4354  2633]
 [15509 86677 18626]
 [ 3023  3826 11416]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7458636
{'0': {'precision': 0.4390999304721573, 'recall': 0.5742271449826417, 'f1-score': 0.49765392743293096, 'support': 24196}, '1': {'precision': 0.8521223531448481, 'recall': 0.7252617716669583, 'f1-score': 0.7835907028575978, 'support': 108587}, '2': {'precision': 0.42320736434108525, 'recall': 0.5750493745885451, 'f1-score': 0.48758024002232764, 'support': 24304}, 'accuracy': 0.6787576311216078, 'macro avg': {'precision': 0.5714765493193635, 'recall': 0.6248460970793817, 'f1-score': 0.5896082901042855, 'support': 157087}, 'weighted avg': {'precision': 0.7221444400974599, 'recall': 0.6787576311216078, 'f1-score': 0.6937502672587026, 'support': 157087}}
[[13894  7163  3139]
 [13924 78754 15909]
 [ 3824  6504 13976]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.793674
{'0': {'precision': 0.4711978790069896, 'recall': 0.5380857359113741, 'f1-score': 0.5024253911143949, 'support': 29066}, '1': {'precision': 0.7931573174379827, 'recall': 0.7241058423693154, 'f1-score': 0.7570602947319441, 'support': 98864}, '2': {'precision': 0.4638206789939949, 'recall': 0.5351030627293617, 'f1-score': 0.49691854447010114, 'support': 29157}, 'accuracy': 0.6546054097410989, 'macro avg': {'precision': 0.5760586251463224, 'recall': 0.599098213670017, 'f1-score': 0.5854680767721467, 'support': 157087}, 'weighted avg': {'precision': 0.6724564230002087, 'recall': 0.6546054097410989, 'f1-score': 0.6616598407100822, 'support': 157087}}
[[15640  9728  3698]
 [12938 71588 14338]
 [ 4614  8941 15602]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8781931
{'0': {'precision': 0.5135913015669972, 'recall': 0.47819613999945865, 'f1-score': 0.4952621250350435, 'support': 36943}, '1': {'precision': 0.6871011103956984, 'recall': 0.728563044233372, 'f1-score': 0.7072249093107618, 'support': 83489}, '2': {'precision': 0.5021514503995551, 'recall': 0.4680125494475515, 'f1-score': 0.48448134655031216, 'support': 36655}, 'accuracy': 0.6088855220355599, 'macro avg': {'precision': 0.5676146207874169, 'recall': 0.5582572445601274, 'f1-score': 0.5623227936320392, 'support': 157087}, 'weighted avg': {'precision': 0.6031393398181373, 'recall': 0.6088855220355599, 'f1-score': 0.6054010382553457, 'support': 157087}}
[[17666 14280  4997]
 [10651 60827 12011]
 [ 6080 13420 17155]]
Evaluating performance on  val set...
190/190 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7036893
{'0': {'precision': 0.3268512414853878, 'recall': 0.5840204161758932, 'f1-score': 0.41913214990138065, 'support': 5094}, '1': {'precision': 0.918684838382848, 'recall': 0.734856605056077, 'f1-score': 0.8165524052986289, 'support': 38251}, '2': {'precision': 0.3473648572395892, 'recall': 0.5902205177372962, 'f1-score': 0.4373401534526854, 'support': 5215}, 'accuracy': 0.703500823723229, 'macro avg': {'precision': 0.5309669790359416, 'recall': 0.6363658463230887, 'f1-score': 0.5576749028842317, 'support': 48560}, 'weighted avg': {'precision': 0.7952450928256453, 'recall': 0.703500823723229, 'f1-score': 0.7341378526962775, 'support': 48560}}
[[ 2975  1327   792]
 [ 5151 28109  4991]
 [  976  1161  3078]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7376876
{'0': {'precision': 0.38550548112058464, 'recall': 0.5624167036872502, 'f1-score': 0.4574525745257453, 'support': 6753}, '1': {'precision': 0.8664710445546224, 'recall': 0.7333504610202393, 'f1-score': 0.7943722943722944, 'support': 35031}, '2': {'precision': 0.42134893476101115, 'recall': 0.5633116883116883, 'f1-score': 0.4820966214082728, 'support': 6776}, 'accuracy': 0.6858525535420099, 'macro avg': {'precision': 0.5577751534787394, 'recall': 0.6196929510063925, 'f1-score': 0.5779738301021041, 'support': 48560}, 'weighted avg': {'precision': 0.7374737656042194, 'recall': 0.6858525535420099, 'f1-score': 0.7039439824256726, 'support': 48560}}
[[ 3798  2072   883]
 [ 4982 25690  4359]
 [ 1072  1887  3817]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.782729
{'0': {'precision': 0.4170661553211889, 'recall': 0.5386329866270431, 'f1-score': 0.4701177996325516, 'support': 8076}, '1': {'precision': 0.8169880145909327, 'recall': 0.7248489705338429, 'f1-score': 0.768165411814663, 'support': 32444}, '2': {'precision': 0.45853397538790797, 'recall': 0.5329601990049752, 'f1-score': 0.4929536957146966, 'support': 8040}, 'accuracy': 0.6621087314662274, 'macro avg': {'precision': 0.5641960484333431, 'recall': 0.598814052055287, 'f1-score': 0.5770789690539705, 'support': 48560}, 'weighted avg': {'precision': 0.6911284715379103, 'recall': 0.6621087314662274, 'f1-score': 0.673030841933558, 'support': 48560}}
[[ 4350  2764   962]
 [ 4829 23517  4098]
 [ 1251  2504  4285]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.86059046
{'0': {'precision': 0.4578313253012048, 'recall': 0.4839815812677574, 'f1-score': 0.47054341096347096, 'support': 10207}, '1': {'precision': 0.7252068316585591, 'recall': 0.7224619738238415, 'f1-score': 0.723831800542236, 'support': 28270}, '2': {'precision': 0.49370250858748826, 'recall': 0.470395715560845, 'f1-score': 0.48176739461655665, 'support': 10083}, 'accuracy': 0.619995881383855, 'macro avg': {'precision': 0.5589135551824174, 'recall': 0.5589464235508146, 'f1-score': 0.5587142020407545, 'support': 48560}, 'weighted avg': {'precision': 0.6209366528505871, 'recall': 0.619995881383855, 'f1-score': 0.6203299472189435, 'support': 48560}}
[[ 4940  4025  1242]
 [ 4224 20424  3622]
 [ 1626  3714  4743]]
training model: results/QRTEA/W8/deepVOL_L3/seq2seq
Epoch 1/50
614/614 - 29s - loss: 12.3047 - accuracy10: 0.4509 - accuracy20: 0.4458 - accuracy30: 0.4448 - accuracy50: 0.4470 - val_loss: 12.3517 - val_accuracy10: 0.7141 - val_accuracy20: 0.6718 - val_accuracy30: 0.6342 - val_accuracy50: 0.5685 - 29s/epoch - 48ms/step
Epoch 2/50
614/614 - 24s - loss: 11.7824 - accuracy10: 0.4343 - accuracy20: 0.4486 - accuracy30: 0.4604 - accuracy50: 0.4675 - val_loss: 12.9277 - val_accuracy10: 0.7144 - val_accuracy20: 0.6765 - val_accuracy30: 0.6414 - val_accuracy50: 0.5751 - 24s/epoch - 38ms/step
Epoch 3/50
614/614 - 24s - loss: 10.8106 - accuracy10: 0.5748 - accuracy20: 0.5814 - accuracy30: 0.5762 - accuracy50: 0.5582 - val_loss: 10.7332 - val_accuracy10: 0.6447 - val_accuracy20: 0.6352 - val_accuracy30: 0.6203 - val_accuracy50: 0.5889 - 24s/epoch - 39ms/step
Epoch 4/50
614/614 - 24s - loss: 10.3678 - accuracy10: 0.6426 - accuracy20: 0.6313 - accuracy30: 0.6117 - accuracy50: 0.5785 - val_loss: 10.4497 - val_accuracy10: 0.6388 - val_accuracy20: 0.6287 - val_accuracy30: 0.6126 - val_accuracy50: 0.5805 - 24s/epoch - 39ms/step
Epoch 5/50
614/614 - 24s - loss: 10.1028 - accuracy10: 0.6639 - accuracy20: 0.6476 - accuracy30: 0.6244 - accuracy50: 0.5864 - val_loss: 10.3546 - val_accuracy10: 0.6819 - val_accuracy20: 0.6675 - val_accuracy30: 0.6471 - val_accuracy50: 0.6059 - 24s/epoch - 38ms/step
Epoch 6/50
614/614 - 23s - loss: 9.8961 - accuracy10: 0.6767 - accuracy20: 0.6581 - accuracy30: 0.6324 - accuracy50: 0.5931 - val_loss: 10.2938 - val_accuracy10: 0.6731 - val_accuracy20: 0.6586 - val_accuracy30: 0.6389 - val_accuracy50: 0.6011 - 23s/epoch - 38ms/step
Epoch 7/50
614/614 - 24s - loss: 9.7928 - accuracy10: 0.6802 - accuracy20: 0.6613 - accuracy30: 0.6358 - accuracy50: 0.5954 - val_loss: 10.1370 - val_accuracy10: 0.6852 - val_accuracy20: 0.6688 - val_accuracy30: 0.6454 - val_accuracy50: 0.6068 - 24s/epoch - 39ms/step
Epoch 8/50
614/614 - 24s - loss: 9.6753 - accuracy10: 0.6837 - accuracy20: 0.6642 - accuracy30: 0.6377 - accuracy50: 0.5987 - val_loss: 10.0516 - val_accuracy10: 0.6583 - val_accuracy20: 0.6443 - val_accuracy30: 0.6222 - val_accuracy50: 0.5877 - 24s/epoch - 39ms/step
Epoch 9/50
614/614 - 24s - loss: 9.5982 - accuracy10: 0.6873 - accuracy20: 0.6687 - accuracy30: 0.6411 - accuracy50: 0.6018 - val_loss: 9.9217 - val_accuracy10: 0.6730 - val_accuracy20: 0.6567 - val_accuracy30: 0.6334 - val_accuracy50: 0.5954 - 24s/epoch - 39ms/step
Epoch 10/50
614/614 - 24s - loss: 9.5183 - accuracy10: 0.6900 - accuracy20: 0.6712 - accuracy30: 0.6448 - accuracy50: 0.6043 - val_loss: 10.0190 - val_accuracy10: 0.6571 - val_accuracy20: 0.6431 - val_accuracy30: 0.6221 - val_accuracy50: 0.5883 - 24s/epoch - 39ms/step
Epoch 11/50
614/614 - 24s - loss: 9.4496 - accuracy10: 0.6899 - accuracy20: 0.6725 - accuracy30: 0.6456 - accuracy50: 0.6064 - val_loss: 9.9087 - val_accuracy10: 0.6580 - val_accuracy20: 0.6433 - val_accuracy30: 0.6209 - val_accuracy50: 0.5869 - 24s/epoch - 39ms/step
Epoch 12/50
614/614 - 24s - loss: 9.3652 - accuracy10: 0.6938 - accuracy20: 0.6741 - accuracy30: 0.6462 - accuracy50: 0.6067 - val_loss: 9.9619 - val_accuracy10: 0.6783 - val_accuracy20: 0.6600 - val_accuracy30: 0.6354 - val_accuracy50: 0.5958 - 24s/epoch - 39ms/step
Epoch 13/50
614/614 - 24s - loss: 9.3020 - accuracy10: 0.6953 - accuracy20: 0.6752 - accuracy30: 0.6482 - accuracy50: 0.6083 - val_loss: 9.8031 - val_accuracy10: 0.6783 - val_accuracy20: 0.6582 - val_accuracy30: 0.6312 - val_accuracy50: 0.5906 - 24s/epoch - 39ms/step
Epoch 14/50
614/614 - 24s - loss: 9.2443 - accuracy10: 0.6940 - accuracy20: 0.6762 - accuracy30: 0.6490 - accuracy50: 0.6098 - val_loss: 9.8401 - val_accuracy10: 0.6657 - val_accuracy20: 0.6517 - val_accuracy30: 0.6291 - val_accuracy50: 0.5928 - 24s/epoch - 39ms/step
Epoch 15/50
614/614 - 23s - loss: 9.2082 - accuracy10: 0.6931 - accuracy20: 0.6748 - accuracy30: 0.6477 - accuracy50: 0.6104 - val_loss: 9.9107 - val_accuracy10: 0.6831 - val_accuracy20: 0.6673 - val_accuracy30: 0.6446 - val_accuracy50: 0.6027 - 23s/epoch - 38ms/step
Epoch 16/50
614/614 - 23s - loss: 9.1656 - accuracy10: 0.6951 - accuracy20: 0.6769 - accuracy30: 0.6504 - accuracy50: 0.6135 - val_loss: 9.8557 - val_accuracy10: 0.6632 - val_accuracy20: 0.6477 - val_accuracy30: 0.6269 - val_accuracy50: 0.5926 - 23s/epoch - 38ms/step
Epoch 17/50
614/614 - 23s - loss: 9.1313 - accuracy10: 0.6971 - accuracy20: 0.6775 - accuracy30: 0.6504 - accuracy50: 0.6125 - val_loss: 9.8883 - val_accuracy10: 0.6639 - val_accuracy20: 0.6442 - val_accuracy30: 0.6208 - val_accuracy50: 0.5850 - 23s/epoch - 38ms/step
Epoch 18/50
614/614 - 23s - loss: 9.0822 - accuracy10: 0.6974 - accuracy20: 0.6784 - accuracy30: 0.6500 - accuracy50: 0.6131 - val_loss: 9.9000 - val_accuracy10: 0.6770 - val_accuracy20: 0.6586 - val_accuracy30: 0.6333 - val_accuracy50: 0.5931 - 23s/epoch - 38ms/step
Epoch 19/50
614/614 - 23s - loss: 9.0150 - accuracy10: 0.6977 - accuracy20: 0.6780 - accuracy30: 0.6520 - accuracy50: 0.6167 - val_loss: 10.0640 - val_accuracy10: 0.6794 - val_accuracy20: 0.6599 - val_accuracy30: 0.6336 - val_accuracy50: 0.5957 - 23s/epoch - 38ms/step
Epoch 20/50
614/614 - 23s - loss: 8.9814 - accuracy10: 0.6996 - accuracy20: 0.6785 - accuracy30: 0.6525 - accuracy50: 0.6170 - val_loss: 10.0696 - val_accuracy10: 0.6680 - val_accuracy20: 0.6471 - val_accuracy30: 0.6238 - val_accuracy50: 0.5864 - 23s/epoch - 38ms/step
Epoch 21/50
614/614 - 24s - loss: 8.9231 - accuracy10: 0.6997 - accuracy20: 0.6789 - accuracy30: 0.6543 - accuracy50: 0.6192 - val_loss: 10.1072 - val_accuracy10: 0.6611 - val_accuracy20: 0.6408 - val_accuracy30: 0.6173 - val_accuracy50: 0.5821 - 24s/epoch - 38ms/step
Epoch 22/50
614/614 - 24s - loss: 8.8766 - accuracy10: 0.6996 - accuracy20: 0.6794 - accuracy30: 0.6542 - accuracy50: 0.6205 - val_loss: 10.2129 - val_accuracy10: 0.6601 - val_accuracy20: 0.6416 - val_accuracy30: 0.6170 - val_accuracy50: 0.5829 - 24s/epoch - 39ms/step
Epoch 23/50
614/614 - 23s - loss: 8.8376 - accuracy10: 0.7011 - accuracy20: 0.6797 - accuracy30: 0.6541 - accuracy50: 0.6210 - val_loss: 10.2834 - val_accuracy10: 0.6754 - val_accuracy20: 0.6540 - val_accuracy30: 0.6294 - val_accuracy50: 0.5914 - 23s/epoch - 38ms/step
testing model: results/QRTEA/W8/deepVOL_L3/seq2seq
Evaluating performance on  test set...
2179/2179 - 35s - 35s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.688814
{'0': {'precision': 0.30630081300813006, 'recall': 0.6973903945594656, 'f1-score': 0.42565132229324393, 'support': 49701}, '1': {'precision': 0.93984480344549, 'recall': 0.7119810599543052, 'f1-score': 0.8101964186132969, 'support': 459133}, '2': {'precision': 0.3268287139861368, 'recall': 0.6463858129367057, 'f1-score': 0.4341436304880308, 'support': 48946}, 'accuracy': 0.7049248807773674, 'macro avg': {'precision': 0.5243247768132523, 'recall': 0.6852524224834923, 'f1-score': 0.5566637904648573, 'support': 557780}, 'weighted avg': {'precision': 0.8295998047302174, 'recall': 0.7049248807773674, 'f1-score': 0.7429323438888855, 'support': 557780}}
[[ 34661  10170   4870]
 [ 71944 326894  60295]
 [  6555  10753  31638]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.72158426
{'0': {'precision': 0.37680702656526033, 'recall': 0.6588167053364269, 'f1-score': 0.4794149769694668, 'support': 68960}, '1': {'precision': 0.8938493409685094, 'recall': 0.7035547886518292, 'f1-score': 0.7873674200668844, 'support': 421319}, '2': {'precision': 0.3940673952986191, 'recall': 0.6164056828787722, 'f1-score': 0.4807755637338448, 'support': 67501}, 'accuracy': 0.6874771415253326, 'macro avg': {'precision': 0.5549079209441297, 'recall': 0.6595923922890093, 'f1-score': 0.5825193202567319, 'support': 557780}, 'weighted avg': {'precision': 0.769443627038445, 'recall': 0.6874771415253326, 'f1-score': 0.7121914414187894, 'support': 557780}}
[[ 45432  17399   6129]
 [ 67049 296421  57849]
 [  8090  17803  41608]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7695265
{'0': {'precision': 0.41398918868321904, 'recall': 0.6229664060849356, 'f1-score': 0.4974202527730525, 'support': 85194}, '1': {'precision': 0.8475890778330206, 'recall': 0.6827137689525129, 'f1-score': 0.7562695646366573, 'support': 389790}, '2': {'precision': 0.4221288079298355, 'recall': 0.5894487656408522, 'f1-score': 0.49195101053374324, 'support': 82796}, 'accuracy': 0.6597439850837248, 'macro avg': {'precision': 0.561235691482025, 'recall': 0.6317096468927669, 'f1-score': 0.581880275981151, 'support': 557780}, 'weighted avg': {'precision': 0.718207390674764, 'recall': 0.6597439850837248, 'f1-score': 0.6774984948951591, 'support': 557780}}
[[ 53073  24298   7823]
 [ 64688 266115  58987]
 [ 10438  23554  48804]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8477625
{'0': {'precision': 0.4577158635275456, 'recall': 0.5543558500466936, 'f1-score': 0.5014219115156733, 'support': 112435}, '1': {'precision': 0.754964546239454, 'recall': 0.6595103410390034, 'f1-score': 0.7040166352062204, 'support': 336765}, '2': {'precision': 0.45968450792654214, 'recall': 0.5394455700865721, 'f1-score': 0.4963813559322034, 'support': 108580}, 'accuracy': 0.6149413747355589, 'macro avg': {'precision': 0.5574549725645139, 'recall': 0.5844372537240897, 'f1-score': 0.567273300884699, 'support': 557780}, 'weighted avg': {'precision': 0.6375658187828772, 'recall': 0.6149413747355589, 'f1-score': 0.6227591925196425, 'support': 557780}}
[[ 62329  37523  12583]
 [ 58401 222100  56264]
 [ 15444  34563  58573]]
Evaluating performance on  train set...
614/614 - 10s - 10s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7734877
{'0': {'precision': 0.31329444128248907, 'recall': 0.7335369239311493, 'f1-score': 0.4390641098075708, 'support': 18010}, '1': {'precision': 0.9263022522940032, 'recall': 0.6617802867264841, 'f1-score': 0.7720109692744443, 'support': 120812}, '2': {'precision': 0.3714825042821687, 'recall': 0.5818231590473584, 'f1-score': 0.45344768731865503, 'support': 18265}, 'accuracy': 0.660710307027316, 'macro avg': {'precision': 0.5370263992862204, 'recall': 0.659046789901664, 'f1-score': 0.5548409221335567, 'support': 157087}, 'weighted avg': {'precision': 0.7915103638897844, 'recall': 0.660710307027316, 'f1-score': 0.6967983082399801, 'support': 157087}}
[[13211  2882  1917]
 [24798 79951 16063]
 [ 4159  3479 10627]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.799248
{'0': {'precision': 0.37926529876799026, 'recall': 0.6959414779302364, 'f1-score': 0.4909687294992346, 'support': 24196}, '1': {'precision': 0.8737661375007721, 'recall': 0.6513394789431516, 'f1-score': 0.7463330730430745, 'support': 108587}, '2': {'precision': 0.4317172289953691, 'recall': 0.5638578011849901, 'f1-score': 0.4890181454850393, 'support': 24304}, 'accuracy': 0.6446746070648749, 'macro avg': {'precision': 0.5615828884213772, 'recall': 0.637046252686126, 'f1-score': 0.5754399826757828, 'support': 157087}, 'weighted avg': {'precision': 0.7292061232010929, 'recall': 0.6446746070648749, 'f1-score': 0.6671885374942561, 'support': 157087}}
[[16839  4792  2565]
 [22386 70727 15474]
 [ 5174  5426 13704]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8375538
{'0': {'precision': 0.41362442825681855, 'recall': 0.672022294089314, 'f1-score': 0.5120723554856469, 'support': 29066}, '1': {'precision': 0.8251255478147353, 'recall': 0.6265475805146464, 'f1-score': 0.7122545778595453, 'support': 98864}, '2': {'precision': 0.45536330190848473, 'recall': 0.5433686593270912, 'f1-score': 0.49548859247212623, 'support': 29157}, 'accuracy': 0.6195229395175922, 'macro avg': {'precision': 0.5647044259933462, 'recall': 0.6139795113103506, 'f1-score': 0.5732718419391062, 'support': 157087}, 'weighted avg': {'precision': 0.6803532283678113, 'recall': 0.6195229395175922, 'f1-score': 0.634980568479643, 'support': 157087}}
[[19533  6324  3209]
 [21181 61943 15740]
 [ 6510  6804 15843]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.89599067
{'0': {'precision': 0.4594756614179522, 'recall': 0.6224183201147714, 'f1-score': 0.5286766988170646, 'support': 36943}, '1': {'precision': 0.7307564145284905, 'recall': 0.6041394674747571, 'f1-score': 0.6614430339907679, 'support': 83489}, '2': {'precision': 0.4801157285639137, 'recall': 0.4979948165325331, 'f1-score': 0.488891864747238, 'support': 36655}, 'accuracy': 0.5836701954967629, 'macro avg': {'precision': 0.5567826015034522, 'recall': 0.5748508680406871, 'f1-score': 0.5596705325183567, 'support': 157087}, 'weighted avg': {'precision': 0.6084728442381789, 'recall': 0.5836701954967629, 'f1-score': 0.589956215673888, 'support': 157087}}
[[22994  9109  4840]
 [18124 50439 14926]
 [ 8926  9475 18254]]
Evaluating performance on  val set...
190/190 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7414767
{'0': {'precision': 0.2978704205017145, 'recall': 0.6480172752257558, 'f1-score': 0.40813550939663695, 'support': 5094}, '1': {'precision': 0.9261965528091459, 'recall': 0.6925832004392042, 'f1-score': 0.7925329823196816, 'support': 38251}, '2': {'precision': 0.34569014084507044, 'recall': 0.5883029721955897, 'f1-score': 0.435486160397445, 'support': 5215}, 'accuracy': 0.6767092257001648, 'macro avg': {'precision': 0.5232523713853103, 'recall': 0.6429678159535166, 'f1-score': 0.5453848840379212, 'support': 48560}, 'weighted avg': {'precision': 0.7979421406104905, 'recall': 0.6767092257001648, 'f1-score': 0.7138649447703724, 'support': 48560}}
[[ 3301  1050   743]
 [ 6695 26492  5064]
 [ 1086  1061  3068]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7765559
{'0': {'precision': 0.3569551580910401, 'recall': 0.6235747075373907, 'f1-score': 0.45401617250673854, 'support': 6753}, '1': {'precision': 0.8781210639401349, 'recall': 0.6766578173617653, 'f1-score': 0.7643369609028619, 'support': 35031}, '2': {'precision': 0.40464735387450096, 'recall': 0.5833825265643447, 'f1-score': 0.4778482925355092, 'support': 6776}, 'accuracy': 0.6562602965403624, 'macro avg': {'precision': 0.546574525301892, 'recall': 0.627871683821167, 'f1-score': 0.5654004753150365, 'support': 48560}, 'weighted avg': {'precision': 0.7395771755216078, 'recall': 0.6562602965403624, 'f1-score': 0.6812059168152136, 'support': 48560}}
[[ 4211  1670   872]
 [ 6383 23704  4944]
 [ 1203  1620  3953]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.82162875
{'0': {'precision': 0.38726621567847197, 'recall': 0.6025260029717682, 'f1-score': 0.47148878445811737, 'support': 8076}, '1': {'precision': 0.8348111788456971, 'recall': 0.6500123289360128, 'f1-score': 0.7309118635843759, 'support': 32444}, '2': {'precision': 0.4277462032982391, 'recall': 0.5710199004975124, 'f1-score': 0.4891066957865019, 'support': 8040}, 'accuracy': 0.6290362438220758, 'macro avg': {'precision': 0.549941199274136, 'recall': 0.6078527441350978, 'f1-score': 0.5638357812763317, 'support': 48560}, 'weighted avg': {'precision': 0.6929830172736199, 'recall': 0.6290362438220758, 'f1-score': 0.647731996695608, 'support': 48560}}
[[ 4866  2171  1039]
 [ 6252 21089  5103]
 [ 1447  2002  4591]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.88881105
{'0': {'precision': 0.4260576563084987, 'recall': 0.5574605662780445, 'f1-score': 0.48298107121636535, 'support': 10207}, '1': {'precision': 0.7518453727012843, 'recall': 0.6233109303148213, 'f1-score': 0.6815711605778715, 'support': 28270}, '2': {'precision': 0.45249830047586675, 'recall': 0.5281166319547753, 'f1-score': 0.4873918813784266, 'support': 10083}, 'accuracy': 0.5897034596375618, 'macro avg': {'precision': 0.5434671098285498, 'recall': 0.5696293761825472, 'f1-score': 0.5506480377242211, 'support': 48560}, 'weighted avg': {'precision': 0.6212104519749654, 'recall': 0.5897034596375618, 'f1-score': 0.5995094078126142, 'support': 48560}}
[[ 5690  3051  1466]
 [ 5672 17621  4977]
 [ 1993  2765  5325]]
training model: results/QRTEA/W9/deepLOB_L1/seq2seq
Epoch 1/50
505/505 - 18s - loss: 11.6454 - accuracy10: 0.4250 - accuracy20: 0.4337 - accuracy30: 0.4399 - accuracy50: 0.4526 - val_loss: 12.2158 - val_accuracy10: 0.6108 - val_accuracy20: 0.5953 - val_accuracy30: 0.5829 - val_accuracy50: 0.5593 - 18s/epoch - 36ms/step
Epoch 2/50
505/505 - 11s - loss: 11.2274 - accuracy10: 0.4638 - accuracy20: 0.4718 - accuracy30: 0.4771 - accuracy50: 0.4834 - val_loss: 11.5234 - val_accuracy10: 0.5661 - val_accuracy20: 0.5603 - val_accuracy30: 0.5630 - val_accuracy50: 0.5569 - 11s/epoch - 21ms/step
Epoch 3/50
505/505 - 11s - loss: 10.8959 - accuracy10: 0.5116 - accuracy20: 0.5129 - accuracy30: 0.5126 - accuracy50: 0.5134 - val_loss: 11.3422 - val_accuracy10: 0.6135 - val_accuracy20: 0.6076 - val_accuracy30: 0.6021 - val_accuracy50: 0.5834 - 11s/epoch - 21ms/step
Epoch 4/50
505/505 - 11s - loss: 10.5502 - accuracy10: 0.5663 - accuracy20: 0.5594 - accuracy30: 0.5493 - accuracy50: 0.5408 - val_loss: 10.9665 - val_accuracy10: 0.6369 - val_accuracy20: 0.6284 - val_accuracy30: 0.6181 - val_accuracy50: 0.5978 - 11s/epoch - 21ms/step
Epoch 5/50
505/505 - 11s - loss: 10.2919 - accuracy10: 0.5897 - accuracy20: 0.5797 - accuracy30: 0.5676 - accuracy50: 0.5575 - val_loss: 10.7827 - val_accuracy10: 0.6709 - val_accuracy20: 0.6583 - val_accuracy30: 0.6477 - val_accuracy50: 0.6242 - 11s/epoch - 21ms/step
Epoch 6/50
505/505 - 11s - loss: 10.0887 - accuracy10: 0.6162 - accuracy20: 0.6011 - accuracy30: 0.5845 - accuracy50: 0.5708 - val_loss: 10.6156 - val_accuracy10: 0.6767 - val_accuracy20: 0.6632 - val_accuracy30: 0.6515 - val_accuracy50: 0.6301 - 11s/epoch - 22ms/step
Epoch 7/50
505/505 - 11s - loss: 9.9032 - accuracy10: 0.6354 - accuracy20: 0.6185 - accuracy30: 0.6008 - accuracy50: 0.5827 - val_loss: 10.6799 - val_accuracy10: 0.7085 - val_accuracy20: 0.6907 - val_accuracy30: 0.6756 - val_accuracy50: 0.6454 - 11s/epoch - 22ms/step
Epoch 8/50
505/505 - 11s - loss: 9.7593 - accuracy10: 0.6515 - accuracy20: 0.6313 - accuracy30: 0.6094 - accuracy50: 0.5872 - val_loss: 10.5247 - val_accuracy10: 0.7134 - val_accuracy20: 0.6930 - val_accuracy30: 0.6769 - val_accuracy50: 0.6462 - 11s/epoch - 22ms/step
Epoch 9/50
505/505 - 12s - loss: 9.6334 - accuracy10: 0.6604 - accuracy20: 0.6391 - accuracy30: 0.6162 - accuracy50: 0.5932 - val_loss: 10.4880 - val_accuracy10: 0.6854 - val_accuracy20: 0.6667 - val_accuracy30: 0.6524 - val_accuracy50: 0.6257 - 12s/epoch - 23ms/step
Epoch 10/50
505/505 - 11s - loss: 9.4835 - accuracy10: 0.6745 - accuracy20: 0.6511 - accuracy30: 0.6255 - accuracy50: 0.5995 - val_loss: 10.4945 - val_accuracy10: 0.7170 - val_accuracy20: 0.6944 - val_accuracy30: 0.6743 - val_accuracy50: 0.6412 - 11s/epoch - 21ms/step
Epoch 11/50
505/505 - 10s - loss: 9.3962 - accuracy10: 0.6765 - accuracy20: 0.6525 - accuracy30: 0.6263 - accuracy50: 0.6002 - val_loss: 10.3898 - val_accuracy10: 0.7032 - val_accuracy20: 0.6816 - val_accuracy30: 0.6621 - val_accuracy50: 0.6320 - 10s/epoch - 21ms/step
Epoch 12/50
505/505 - 11s - loss: 9.3102 - accuracy10: 0.6811 - accuracy20: 0.6590 - accuracy30: 0.6344 - accuracy50: 0.6074 - val_loss: 10.1392 - val_accuracy10: 0.7194 - val_accuracy20: 0.6960 - val_accuracy30: 0.6786 - val_accuracy50: 0.6475 - 11s/epoch - 21ms/step
Epoch 13/50
505/505 - 11s - loss: 9.2529 - accuracy10: 0.6885 - accuracy20: 0.6619 - accuracy30: 0.6326 - accuracy50: 0.6059 - val_loss: 10.1130 - val_accuracy10: 0.7103 - val_accuracy20: 0.6850 - val_accuracy30: 0.6667 - val_accuracy50: 0.6382 - 11s/epoch - 21ms/step
Epoch 14/50
505/505 - 10s - loss: 9.1987 - accuracy10: 0.6893 - accuracy20: 0.6633 - accuracy30: 0.6350 - accuracy50: 0.6078 - val_loss: 10.3606 - val_accuracy10: 0.7373 - val_accuracy20: 0.7160 - val_accuracy30: 0.6977 - val_accuracy50: 0.6640 - 10s/epoch - 21ms/step
Epoch 15/50
505/505 - 10s - loss: 9.1441 - accuracy10: 0.6908 - accuracy20: 0.6645 - accuracy30: 0.6360 - accuracy50: 0.6079 - val_loss: 10.2689 - val_accuracy10: 0.7342 - val_accuracy20: 0.7124 - val_accuracy30: 0.6940 - val_accuracy50: 0.6617 - 10s/epoch - 21ms/step
Epoch 16/50
505/505 - 10s - loss: 9.0908 - accuracy10: 0.6956 - accuracy20: 0.6689 - accuracy30: 0.6400 - accuracy50: 0.6106 - val_loss: 10.0915 - val_accuracy10: 0.7088 - val_accuracy20: 0.6886 - val_accuracy30: 0.6699 - val_accuracy50: 0.6407 - 10s/epoch - 21ms/step
Epoch 17/50
505/505 - 10s - loss: 9.0755 - accuracy10: 0.6947 - accuracy20: 0.6686 - accuracy30: 0.6401 - accuracy50: 0.6113 - val_loss: 10.4100 - val_accuracy10: 0.7281 - val_accuracy20: 0.7073 - val_accuracy30: 0.6858 - val_accuracy50: 0.6512 - 10s/epoch - 20ms/step
Epoch 18/50
505/505 - 10s - loss: 9.0180 - accuracy10: 0.6977 - accuracy20: 0.6707 - accuracy30: 0.6423 - accuracy50: 0.6132 - val_loss: 10.4770 - val_accuracy10: 0.7450 - val_accuracy20: 0.7216 - val_accuracy30: 0.6997 - val_accuracy50: 0.6620 - 10s/epoch - 21ms/step
Epoch 19/50
505/505 - 10s - loss: 8.9744 - accuracy10: 0.6995 - accuracy20: 0.6745 - accuracy30: 0.6449 - accuracy50: 0.6150 - val_loss: 10.4268 - val_accuracy10: 0.7608 - val_accuracy20: 0.7362 - val_accuracy30: 0.7122 - val_accuracy50: 0.6697 - 10s/epoch - 21ms/step
Epoch 20/50
505/505 - 10s - loss: 8.9244 - accuracy10: 0.7018 - accuracy20: 0.6753 - accuracy30: 0.6460 - accuracy50: 0.6163 - val_loss: 10.2568 - val_accuracy10: 0.7438 - val_accuracy20: 0.7201 - val_accuracy30: 0.6960 - val_accuracy50: 0.6561 - 10s/epoch - 21ms/step
Epoch 21/50
505/505 - 10s - loss: 8.8855 - accuracy10: 0.7015 - accuracy20: 0.6762 - accuracy30: 0.6464 - accuracy50: 0.6154 - val_loss: 10.3597 - val_accuracy10: 0.7552 - val_accuracy20: 0.7323 - val_accuracy30: 0.7117 - val_accuracy50: 0.6719 - 10s/epoch - 20ms/step
Epoch 22/50
505/505 - 10s - loss: 8.8724 - accuracy10: 0.7030 - accuracy20: 0.6775 - accuracy30: 0.6477 - accuracy50: 0.6169 - val_loss: 10.4198 - val_accuracy10: 0.7539 - val_accuracy20: 0.7309 - val_accuracy30: 0.7075 - val_accuracy50: 0.6667 - 10s/epoch - 20ms/step
Epoch 23/50
505/505 - 10s - loss: 8.8136 - accuracy10: 0.7060 - accuracy20: 0.6802 - accuracy30: 0.6500 - accuracy50: 0.6199 - val_loss: 10.4316 - val_accuracy10: 0.7311 - val_accuracy20: 0.7079 - val_accuracy30: 0.6829 - val_accuracy50: 0.6437 - 10s/epoch - 21ms/step
Epoch 24/50
505/505 - 11s - loss: 8.7772 - accuracy10: 0.7070 - accuracy20: 0.6828 - accuracy30: 0.6527 - accuracy50: 0.6208 - val_loss: 10.3154 - val_accuracy10: 0.7556 - val_accuracy20: 0.7335 - val_accuracy30: 0.7098 - val_accuracy50: 0.6674 - 11s/epoch - 21ms/step
Epoch 25/50
505/505 - 11s - loss: 8.7259 - accuracy10: 0.7097 - accuracy20: 0.6850 - accuracy30: 0.6547 - accuracy50: 0.6236 - val_loss: 10.4883 - val_accuracy10: 0.7531 - val_accuracy20: 0.7302 - val_accuracy30: 0.7055 - val_accuracy50: 0.6643 - 11s/epoch - 21ms/step
Epoch 26/50
505/505 - 10s - loss: 8.7353 - accuracy10: 0.7095 - accuracy20: 0.6842 - accuracy30: 0.6530 - accuracy50: 0.6212 - val_loss: 10.4873 - val_accuracy10: 0.7432 - val_accuracy20: 0.7222 - val_accuracy30: 0.6994 - val_accuracy50: 0.6617 - 10s/epoch - 21ms/step
testing model: results/QRTEA/W9/deepLOB_L1/seq2seq
Evaluating performance on  test set...
1118/1118 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.82788795
{'0': {'precision': 0.16758053981803545, 'recall': 0.6255244358770836, 'f1-score': 0.2643426175501647, 'support': 17638}, '1': {'precision': 0.9418508391239997, 'recall': 0.6001006960816437, 'f1-score': 0.7331039027604892, 'support': 250258}, '2': {'precision': 0.19491358349214694, 'recall': 0.6496905974481134, 'f1-score': 0.2998647777679485, 'support': 18261}, 'accuracy': 0.6048323123320415, 'macro avg': {'precision': 0.43478165414472736, 'recall': 0.6251052431356136, 'f1-score': 0.4324370993595341, 'support': 286157}, 'weighted avg': {'precision': 0.8464612426288873, 'recall': 0.6048323123320415, 'f1-score': 0.6765636426584176, 'support': 286157}}
[[ 11033   4825   1780]
 [ 52854 150180  47224]
 [  1950   4447  11864]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.867795
{'0': {'precision': 0.21781889807468235, 'recall': 0.6472527925477103, 'f1-score': 0.32594729795647254, 'support': 24261}, '1': {'precision': 0.9104544243070363, 'recall': 0.5772018755544291, 'f1-score': 0.7065019001577003, 'support': 236730}, '2': {'precision': 0.24637024302570915, 'recall': 0.6264006993562743, 'f1-score': 0.3536471828695135, 'support': 25166}, 'accuracy': 0.5874677187697662, 'macro avg': {'precision': 0.45821452180247596, 'recall': 0.6169517891528046, 'f1-score': 0.46203212699456214, 'support': 286157}, 'weighted avg': {'precision': 0.7933286052355161, 'recall': 0.5874677187697662, 'f1-score': 0.6432059576531365, 'support': 286157}}
[[ 15703   6593   1965]
 [ 53833 136641  46256]
 [  2556   6846  15764]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.89334387
{'0': {'precision': 0.25060978774196896, 'recall': 0.6505017848723648, 'f1-score': 0.3618244825325466, 'support': 29694}, '1': {'precision': 0.8802399815398816, 'recall': 0.5581275742971531, 'f1-score': 0.6831163616038725, 'support': 225547}, '2': {'precision': 0.2830482821250189, 'recall': 0.6048971406391512, 'f1-score': 0.3856432887220836, 'support': 30916}, 'accuracy': 0.5727659990844187, 'macro avg': {'precision': 0.4712993504689565, 'recall': 0.6045088332695564, 'f1-score': 0.4768613776195008, 'support': 286157}, 'weighted avg': {'precision': 0.7503846309674856, 'recall': 0.5727659990844187, 'f1-score': 0.617637905447436, 'support': 286157}}
[[ 19316   8044   2334]
 [ 54628 125884  45035]
 [  3132   9083  18701]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.91971254
{'0': {'precision': 0.30366885476064387, 'recall': 0.6201614728740662, 'f1-score': 0.40770197427163596, 'support': 39759}, '1': {'precision': 0.8155441774977025, 'recall': 0.5458779419733739, 'f1-score': 0.6540037374650162, 'support': 204837}, '2': {'precision': 0.33541132431396825, 'recall': 0.5476047255840812, 'f1-score': 0.41601242973998087, 'support': 41561}, 'accuracy': 0.5564497810642409, 'macro avg': {'precision': 0.4848747855241049, 'recall': 0.5712147134771738, 'f1-score': 0.4925727138255443, 'support': 286157}, 'weighted avg': {'precision': 0.6746898476442588, 'recall': 0.5564497810642408, 'f1-score': 0.5852167829499569, 'support': 286157}}
[[ 24657  11311   3791]
 [ 51717 111816  41304]
 [  4823  13979  22759]]
Evaluating performance on  train set...
505/505 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.605047
{'0': {'precision': 0.25691130121566863, 'recall': 0.6087698709057933, 'f1-score': 0.36133362885096415, 'support': 9373}, '1': {'precision': 0.9306590923489536, 'recall': 0.7967367231638418, 'f1-score': 0.8585065090025373, 'support': 110625}, '2': {'precision': 0.33891553532233154, 'recall': 0.4522182449289511, 'f1-score': 0.38745353159851303, 'support': 9219}, 'accuracy': 0.7585224854314835, 'macro avg': {'precision': 0.5088286429623179, 'recall': 0.6192416129995287, 'f1-score': 0.5357645564840049, 'support': 129217}, 'weighted avg': {'precision': 0.8395695151375905, 'recall': 0.7585224854314835, 'f1-score': 0.7888358092931462, 'support': 129217}}
[[ 5706  2714   953]
 [15307 88139  7179]
 [ 1197  3853  4169]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.66104424
{'0': {'precision': 0.3172452497394372, 'recall': 0.6156838338260464, 'f1-score': 0.4187301587301588, 'support': 12854}, '1': {'precision': 0.8948545122139254, 'recall': 0.783285613750952, 'f1-score': 0.8353613085966617, 'support': 103731}, '2': {'precision': 0.41638833221999555, 'recall': 0.4441101963267891, 'f1-score': 0.42980271978548173, 'support': 12632}, 'accuracy': 0.7334561241941849, 'macro avg': {'precision': 0.5428293647244528, 'recall': 0.6143598813012624, 'f1-score': 0.5612980623707674, 'support': 129217}, 'weighted avg': {'precision': 0.7906222962862194, 'recall': 0.7334561241941849, 'f1-score': 0.7542698663387015, 'support': 129217}}
[[ 7914  4046   894]
 [15511 81251  6969]
 [ 1521  5501  5610]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.71221876
{'0': {'precision': 0.3526204977817881, 'recall': 0.6030347842859899, 'f1-score': 0.44501909800479234, 'support': 15553}, '1': {'precision': 0.8605150214592274, 'recall': 0.7708401139137511, 'f1-score': 0.813212871658959, 'support': 98320}, '2': {'precision': 0.4482640082502578, 'recall': 0.4249217935349322, 'f1-score': 0.43628090601893676, 'support': 15344}, 'accuracy': 0.7095660787667257, 'macro avg': {'precision': 0.5537998424970911, 'recall': 0.5995988972448911, 'f1-score': 0.5648376252275628, 'support': 129217}, 'weighted avg': {'precision': 0.7504299469455517, 'recall': 0.7095660787667257, 'f1-score': 0.7241366522573032, 'support': 129217}}
[[ 9379  5322   852]
 [15358 75789  7173]
 [ 1861  6963  6520]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7766938
{'0': {'precision': 0.40278471974294894, 'recall': 0.5520379703478984, 'f1-score': 0.46574607302825766, 'support': 20437}, '1': {'precision': 0.7919046117553633, 'recall': 0.7635573371768309, 'f1-score': 0.7774726692158199, 'support': 88808}, '2': {'precision': 0.4921042495827449, 'recall': 0.38383737232124976, 'f1-score': 0.4312798874824192, 'support': 19972}, 'accuracy': 0.6714132041449654, 'macro avg': {'precision': 0.5622645270270191, 'recall': 0.5664775599486597, 'f1-score': 0.5581662099088321, 'support': 129217}, 'weighted avg': {'precision': 0.6840236358282853, 'recall': 0.6714132041449654, 'f1-score': 0.674661748957149, 'support': 129217}}
[[11282  8095  1060]
 [14146 67810  6852]
 [ 2582  9724  7666]]
Evaluating performance on  val set...
187/187 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.679901
{'0': {'precision': 0.22687556492919553, 'recall': 0.6806266947875866, 'f1-score': 0.3403133473937933, 'support': 3319}, '1': {'precision': 0.944460321996761, 'recall': 0.7255031101353824, 'f1-score': 0.8206274315040145, 'support': 40995}, '2': {'precision': 0.3106048703849175, 'recall': 0.5650185767362104, 'f1-score': 0.4008515815085158, 'support': 3499}, 'accuracy': 0.7106435488256332, 'macro avg': {'precision': 0.49398025243695803, 'recall': 0.6570494605530598, 'f1-score': 0.5205974534687746, 'support': 47813}, 'weighted avg': {'precision': 0.8482621325106988, 'recall': 0.7106435488256332, 'f1-score': 0.756566231740434, 'support': 47813}}
[[ 2259   739   321]
 [ 7186 29742  4067]
 [  512  1010  1977]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7259968
{'0': {'precision': 0.28059377262853, 'recall': 0.670995670995671, 'f1-score': 0.39571100331886644, 'support': 4620}, '1': {'precision': 0.9081394573695087, 'recall': 0.70953125, 'f1-score': 0.7966433730007895, 'support': 38400}, '2': {'precision': 0.38607127014638476, 'recall': 0.5447527644481536, 'f1-score': 0.45188646590515746, 'support': 4793}, 'accuracy': 0.6892895237696861, 'macro avg': {'precision': 0.5249348333814745, 'recall': 0.6417598951479415, 'f1-score': 0.5480802807416044, 'support': 47813}, 'weighted avg': {'precision': 0.7951673810542021, 'recall': 0.6892895237696861, 'f1-score': 0.723342651363581, 'support': 47813}}
[[ 3100  1207   313]
 [ 7315 27246  3839]
 [  633  1549  2611]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7654298
{'0': {'precision': 0.3154391055730989, 'recall': 0.6516220028208745, 'f1-score': 0.4250963252630974, 'support': 5672}, '1': {'precision': 0.8749741182966388, 'recall': 0.6971980091841504, 'f1-score': 0.7760348917285179, 'support': 36367}, '2': {'precision': 0.42624332677718463, 'recall': 0.5254589539314167, 'f1-score': 0.4706794911573069, 'support': 5774}, 'accuracy': 0.6710518059941857, 'macro avg': {'precision': 0.5388855168823075, 'recall': 0.6247596553121472, 'f1-score': 0.5572702360496408, 'support': 47813}, 'weighted avg': {'precision': 0.7544074485122445, 'recall': 0.6710518059941857, 'f1-score': 0.6975280916555244, 'support': 47813}}
[[ 3696  1619   357]
 [ 7285 25355  3727]
 [  736  2004  3034]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.81999916
{'0': {'precision': 0.36149505193424386, 'recall': 0.5928111587982833, 'f1-score': 0.4491185286795712, 'support': 7456}, '1': {'precision': 0.8067926946491509, 'recall': 0.6906198573779484, 'f1-score': 0.7441997931136397, 'support': 32814}, '2': {'precision': 0.4748566093103908, 'recall': 0.4719607583189712, 'f1-score': 0.47340425531914887, 'support': 7543}, 'accuracy': 0.6408717294459666, 'macro avg': {'precision': 0.5477147852979285, 'recall': 0.585130591498401, 'f1-score': 0.5555741923707865, 'support': 47813}, 'weighted avg': {'precision': 0.6849862170009671, 'recall': 0.6408717294459666, 'f1-score': 0.655463745402677, 'support': 47813}}
[[ 4420  2476   560]
 [ 6775 22662  3377]
 [ 1032  2951  3560]]
training model: results/QRTEA/W9/deepOF_L1/seq2seq
Epoch 1/50
505/505 - 17s - loss: 11.7093 - accuracy10: 0.4757 - accuracy20: 0.4805 - accuracy30: 0.4745 - accuracy50: 0.4677 - val_loss: 12.3148 - val_accuracy10: 0.6995 - val_accuracy20: 0.6943 - val_accuracy30: 0.6830 - val_accuracy50: 0.6477 - 17s/epoch - 33ms/step
Epoch 2/50
505/505 - 10s - loss: 11.2521 - accuracy10: 0.5399 - accuracy20: 0.5274 - accuracy30: 0.5126 - accuracy50: 0.4989 - val_loss: 11.7647 - val_accuracy10: 0.6953 - val_accuracy20: 0.6913 - val_accuracy30: 0.6807 - val_accuracy50: 0.6513 - 10s/epoch - 20ms/step
Epoch 3/50
505/505 - 10s - loss: 11.0649 - accuracy10: 0.5708 - accuracy20: 0.5573 - accuracy30: 0.5404 - accuracy50: 0.5237 - val_loss: 11.5257 - val_accuracy10: 0.7020 - val_accuracy20: 0.6993 - val_accuracy30: 0.6899 - val_accuracy50: 0.6602 - 10s/epoch - 19ms/step
Epoch 4/50
505/505 - 10s - loss: 10.8893 - accuracy10: 0.5881 - accuracy20: 0.5716 - accuracy30: 0.5535 - accuracy50: 0.5359 - val_loss: 11.4656 - val_accuracy10: 0.7178 - val_accuracy20: 0.7120 - val_accuracy30: 0.7014 - val_accuracy50: 0.6692 - 10s/epoch - 19ms/step
Epoch 5/50
505/505 - 10s - loss: 10.7622 - accuracy10: 0.6036 - accuracy20: 0.5859 - accuracy30: 0.5662 - accuracy50: 0.5482 - val_loss: 11.2314 - val_accuracy10: 0.7144 - val_accuracy20: 0.7066 - val_accuracy30: 0.6946 - val_accuracy50: 0.6639 - 10s/epoch - 19ms/step
Epoch 6/50
505/505 - 10s - loss: 10.6349 - accuracy10: 0.6156 - accuracy20: 0.5964 - accuracy30: 0.5766 - accuracy50: 0.5559 - val_loss: 11.2515 - val_accuracy10: 0.7376 - val_accuracy20: 0.7274 - val_accuracy30: 0.7124 - val_accuracy50: 0.6770 - 10s/epoch - 20ms/step
Epoch 7/50
505/505 - 10s - loss: 10.5371 - accuracy10: 0.6203 - accuracy20: 0.6000 - accuracy30: 0.5801 - accuracy50: 0.5589 - val_loss: 11.2324 - val_accuracy10: 0.7370 - val_accuracy20: 0.7280 - val_accuracy30: 0.7130 - val_accuracy50: 0.6777 - 10s/epoch - 19ms/step
Epoch 8/50
505/505 - 10s - loss: 10.4528 - accuracy10: 0.6277 - accuracy20: 0.6059 - accuracy30: 0.5856 - accuracy50: 0.5646 - val_loss: 11.1658 - val_accuracy10: 0.7353 - val_accuracy20: 0.7254 - val_accuracy30: 0.7098 - val_accuracy50: 0.6752 - 10s/epoch - 19ms/step
Epoch 9/50
505/505 - 10s - loss: 10.3721 - accuracy10: 0.6297 - accuracy20: 0.6070 - accuracy30: 0.5842 - accuracy50: 0.5635 - val_loss: 11.0029 - val_accuracy10: 0.7269 - val_accuracy20: 0.7192 - val_accuracy30: 0.7069 - val_accuracy50: 0.6749 - 10s/epoch - 19ms/step
Epoch 10/50
505/505 - 10s - loss: 10.2641 - accuracy10: 0.6352 - accuracy20: 0.6125 - accuracy30: 0.5900 - accuracy50: 0.5690 - val_loss: 11.0889 - val_accuracy10: 0.7387 - val_accuracy20: 0.7272 - val_accuracy30: 0.7111 - val_accuracy50: 0.6760 - 10s/epoch - 19ms/step
Epoch 11/50
505/505 - 10s - loss: 10.2070 - accuracy10: 0.6377 - accuracy20: 0.6154 - accuracy30: 0.5939 - accuracy50: 0.5745 - val_loss: 10.9525 - val_accuracy10: 0.7305 - val_accuracy20: 0.7211 - val_accuracy30: 0.7069 - val_accuracy50: 0.6748 - 10s/epoch - 19ms/step
Epoch 12/50
505/505 - 11s - loss: 10.1326 - accuracy10: 0.6424 - accuracy20: 0.6172 - accuracy30: 0.5943 - accuracy50: 0.5734 - val_loss: 10.8742 - val_accuracy10: 0.7376 - val_accuracy20: 0.7245 - val_accuracy30: 0.7091 - val_accuracy50: 0.6748 - 11s/epoch - 21ms/step
Epoch 13/50
505/505 - 11s - loss: 10.0677 - accuracy10: 0.6446 - accuracy20: 0.6188 - accuracy30: 0.5947 - accuracy50: 0.5745 - val_loss: 10.8288 - val_accuracy10: 0.7181 - val_accuracy20: 0.7086 - val_accuracy30: 0.6958 - val_accuracy50: 0.6654 - 11s/epoch - 21ms/step
Epoch 14/50
505/505 - 10s - loss: 9.9883 - accuracy10: 0.6481 - accuracy20: 0.6225 - accuracy30: 0.5986 - accuracy50: 0.5790 - val_loss: 10.9148 - val_accuracy10: 0.7348 - val_accuracy20: 0.7224 - val_accuracy30: 0.7059 - val_accuracy50: 0.6732 - 10s/epoch - 19ms/step
Epoch 15/50
505/505 - 10s - loss: 9.9154 - accuracy10: 0.6540 - accuracy20: 0.6280 - accuracy30: 0.6036 - accuracy50: 0.5846 - val_loss: 11.0467 - val_accuracy10: 0.7389 - val_accuracy20: 0.7245 - val_accuracy30: 0.7077 - val_accuracy50: 0.6751 - 10s/epoch - 20ms/step
Epoch 16/50
505/505 - 10s - loss: 9.8360 - accuracy10: 0.6532 - accuracy20: 0.6254 - accuracy30: 0.6017 - accuracy50: 0.5835 - val_loss: 11.0549 - val_accuracy10: 0.7448 - val_accuracy20: 0.7294 - val_accuracy30: 0.7099 - val_accuracy50: 0.6742 - 10s/epoch - 19ms/step
Epoch 17/50
505/505 - 10s - loss: 9.7953 - accuracy10: 0.6535 - accuracy20: 0.6263 - accuracy30: 0.6023 - accuracy50: 0.5827 - val_loss: 11.1755 - val_accuracy10: 0.7491 - val_accuracy20: 0.7338 - val_accuracy30: 0.7155 - val_accuracy50: 0.6791 - 10s/epoch - 19ms/step
Epoch 18/50
505/505 - 10s - loss: 9.7316 - accuracy10: 0.6560 - accuracy20: 0.6273 - accuracy30: 0.6030 - accuracy50: 0.5840 - val_loss: 10.8854 - val_accuracy10: 0.7168 - val_accuracy20: 0.7038 - val_accuracy30: 0.6880 - val_accuracy50: 0.6589 - 10s/epoch - 19ms/step
Epoch 19/50
505/505 - 10s - loss: 9.6755 - accuracy10: 0.6565 - accuracy20: 0.6297 - accuracy30: 0.6056 - accuracy50: 0.5867 - val_loss: 11.1131 - val_accuracy10: 0.7524 - val_accuracy20: 0.7360 - val_accuracy30: 0.7157 - val_accuracy50: 0.6790 - 10s/epoch - 20ms/step
Epoch 20/50
505/505 - 10s - loss: 9.6822 - accuracy10: 0.6539 - accuracy20: 0.6271 - accuracy30: 0.6032 - accuracy50: 0.5827 - val_loss: 11.0310 - val_accuracy10: 0.7508 - val_accuracy20: 0.7369 - val_accuracy30: 0.7172 - val_accuracy50: 0.6819 - 10s/epoch - 19ms/step
Epoch 21/50
505/505 - 10s - loss: 9.5903 - accuracy10: 0.6591 - accuracy20: 0.6338 - accuracy30: 0.6104 - accuracy50: 0.5901 - val_loss: 10.9177 - val_accuracy10: 0.7458 - val_accuracy20: 0.7311 - val_accuracy30: 0.7110 - val_accuracy50: 0.6766 - 10s/epoch - 19ms/step
Epoch 22/50
505/505 - 10s - loss: 9.4928 - accuracy10: 0.6614 - accuracy20: 0.6351 - accuracy30: 0.6105 - accuracy50: 0.5896 - val_loss: 11.1800 - val_accuracy10: 0.7600 - val_accuracy20: 0.7421 - val_accuracy30: 0.7207 - val_accuracy50: 0.6826 - 10s/epoch - 19ms/step
Epoch 23/50
505/505 - 10s - loss: 9.4692 - accuracy10: 0.6630 - accuracy20: 0.6359 - accuracy30: 0.6110 - accuracy50: 0.5905 - val_loss: 11.1869 - val_accuracy10: 0.7593 - val_accuracy20: 0.7423 - val_accuracy30: 0.7211 - val_accuracy50: 0.6821 - 10s/epoch - 21ms/step
testing model: results/QRTEA/W9/deepOF_L1/seq2seq
Evaluating performance on  test set...
1118/1118 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6704949
{'0': {'precision': 0.21403337799975636, 'recall': 0.4980723438031523, 'f1-score': 0.2994052792120376, 'support': 17638}, '1': {'precision': 0.9337556345439743, 'recall': 0.7516043699601205, 'f1-score': 0.8328366800239102, 'support': 250254}, '2': {'precision': 0.2372916285033889, 'recall': 0.567493565522151, 'f1-score': 0.3346519626047503, 'support': 18261}, 'accuracy': 0.7242279479858676, 'macro avg': {'precision': 0.4616935470157065, 'recall': 0.6057234264284745, 'f1-score': 0.4889646406135661, 'support': 286153}, 'weighted avg': {'precision': 0.8449479324572093, 'recall': 0.7242279479858676, 'f1-score': 0.7681649338870146, 'support': 286153}}
[[  8785   7368   1485]
 [ 30338 188092  31824]
 [  1922   5976  10363]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.71166354
{'0': {'precision': 0.27448603794694887, 'recall': 0.48538807139029716, 'f1-score': 0.3506692673049149, 'support': 24261}, '1': {'precision': 0.8962575688061831, 'recall': 0.7509525780860573, 'f1-score': 0.8171961946615856, 'support': 236726}, '2': {'precision': 0.30075271690717975, 'recall': 0.5366367320988635, 'f1-score': 0.3854716711859569, 'support': 25166}, 'accuracy': 0.7095889262038141, 'macro avg': {'precision': 0.49049877455343727, 'recall': 0.5909924605250727, 'f1-score': 0.5177790443841525, 'support': 286153}, 'weighted avg': {'precision': 0.7911694718333531, 'recall': 0.7095889262038141, 'f1-score': 0.7396740678888875, 'support': 286153}}
[[ 11776  10955   1530]
 [ 29087 177770  29869]
 [  2039   9622  13505]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7480792
{'0': {'precision': 0.3154460936225738, 'recall': 0.45591702027345593, 'f1-score': 0.372891159741637, 'support': 29694}, '1': {'precision': 0.8583396222592523, 'recall': 0.7513777860541005, 'f1-score': 0.8013050262423755, 'support': 225543}, '2': {'precision': 0.3399200855913885, 'recall': 0.5035580282054599, 'f1-score': 0.4058658671706968, 'support': 30916}, 'accuracy': 0.6939434498327818, 'macro avg': {'precision': 0.5045686004910716, 'recall': 0.5702842781776721, 'f1-score': 0.5266873510515697, 'support': 286153}, 'weighted avg': {'precision': 0.7459936435871392, 'recall': 0.6939434498327818, 'f1-score': 0.7141253762169243, 'support': 286153}}
[[ 13538  14647   1509]
 [ 27353 169468  28722]
 [  2026  13322  15568]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.80528307
{'0': {'precision': 0.3758711217183771, 'recall': 0.39611157222264143, 'f1-score': 0.3857260069312629, 'support': 39759}, '1': {'precision': 0.7839820654067345, 'recall': 0.7580284523077223, 'f1-score': 0.770786845939432, 'support': 204834}, '2': {'precision': 0.3986147186147186, 'recall': 0.4431183830606352, 'f1-score': 0.419690063810392, 'support': 41560}, 'accuracy': 0.662005989802658, 'macro avg': {'precision': 0.5194893019132768, 'recall': 0.5324194691969996, 'f1-score': 0.525400972227029, 'support': 286153}, 'weighted avg': {'precision': 0.6713082512486387, 'recall': 0.662005989802658, 'f1-score': 0.6662930396071249, 'support': 286153}}
[[ 15749  21891   2119]
 [ 23899 155270  25665]
 [  2252  20892  18416]]
Evaluating performance on  train set...
505/505 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.65784466
{'0': {'precision': 0.2779813260843872, 'recall': 0.5057520696699279, 'f1-score': 0.358769019562979, 'support': 9301}, '1': {'precision': 0.9354721669433663, 'recall': 0.7685859334068038, 'f1-score': 0.8438570826411443, 'support': 110702}, '2': {'precision': 0.26192484303251806, 'recall': 0.6066854786194921, 'f1-score': 0.3658855871187328, 'support': 9214}, 'accuracy': 0.7381226928345341, 'macro avg': {'precision': 0.49179277868675725, 'recall': 0.6270078272320746, 'f1-score': 0.5228372297742854, 'support': 129217}, 'weighted avg': {'precision': 0.8401179383717085, 'recall': 0.7381226928345341, 'f1-score': 0.7748581627278703, 'support': 129217}}
[[ 4704  3202  1395]
 [11261 85084 14357]
 [  957  2667  5590]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.69782686
{'0': {'precision': 0.353290031064671, 'recall': 0.4895898559799624, 'f1-score': 0.4104196056559824, 'support': 12776}, '1': {'precision': 0.8949305765336376, 'recall': 0.7705676081846558, 'f1-score': 0.8281059927633383, 'support': 103804}, '2': {'precision': 0.33339357520444585, 'recall': 0.5839202342328084, 'f1-score': 0.42444636180615475, 'support': 12637}, 'accuracy': 0.72453314966297, 'macro avg': {'precision': 0.5272047276009182, 'recall': 0.6146925661324755, 'f1-score': 0.5543239867418251, 'support': 129217}, 'weighted avg': {'precision': 0.7864607722918698, 'recall': 0.72453314966297, 'f1-score': 0.7473317290202589, 'support': 129217}}
[[ 6255  5065  1456]
 [10518 79988 13298]
 [  932  4326  7379]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.73536944
{'0': {'precision': 0.39920148456390936, 'recall': 0.4583252630899348, 'f1-score': 0.4267251743207502, 'support': 15489}, '1': {'precision': 0.8562480284800145, 'recall': 0.7725946632782719, 'f1-score': 0.8122732300589401, 'support': 98375}, '2': {'precision': 0.374459638288487, 'recall': 0.5529212531752752, 'f1-score': 0.4465192120558609, 'support': 15353}, 'accuracy': 0.7088231424657746, 'macro avg': {'precision': 0.543303050444137, 'recall': 0.594613726514494, 'f1-score': 0.5618392054785171, 'support': 129217}, 'weighted avg': {'precision': 0.7442187206232536, 'recall': 0.7088231424657746, 'f1-score': 0.7226010098887605, 'support': 129217}}
[[ 7099  6830  1560]
 [ 9750 76004 12621]
 [  934  5930  8489]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7936352
{'0': {'precision': 0.46278817001315714, 'recall': 0.39660751054024906, 'f1-score': 0.4271496079621954, 'support': 20398}, '1': {'precision': 0.7821132168958256, 'recall': 0.7817434858461365, 'f1-score': 0.7819283076645952, 'support': 88845}, '2': {'precision': 0.4261108446343697, 'recall': 0.4892360068088515, 'f1-score': 0.4554967720884704, 'support': 19974}, 'accuracy': 0.6757315213942438, 'macro avg': {'precision': 0.5570040771811174, 'recall': 0.5558623343984124, 'f1-score': 0.5548582292384203, 'support': 129217}, 'weighted avg': {'precision': 0.6766752041741018, 'recall': 0.6757315213942438, 'f1-score': 0.6754646116483817, 'support': 129217}}
[[ 8090 10274  2034]
 [ 8264 69454 11127]
 [ 1127  9075  9772]]
Evaluating performance on  val set...
187/187 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6900967
{'0': {'precision': 0.2659219498041491, 'recall': 0.5465116279069767, 'f1-score': 0.357763247779838, 'support': 3354}, '1': {'precision': 0.9397623995781507, 'recall': 0.7399618991793669, 'f1-score': 0.827979175491576, 'support': 40944}, '2': {'precision': 0.25809425048968776, 'recall': 0.6376316538571022, 'f1-score': 0.3674540682414698, 'support': 3513}, 'accuracy': 0.7188722260567652, 'macro avg': {'precision': 0.48792619995732917, 'recall': 0.6413683936478153, 'f1-score': 0.5177321638376279, 'support': 47811}, 'weighted avg': {'precision': 0.8424048651971552, 'recall': 0.7188722260567652, 'f1-score': 0.7611550362074196, 'support': 47811}}
[[ 1833  1129   392]
 [ 4600 30297  6047]
 [  460   813  2240]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.72159386
{'0': {'precision': 0.33575825405707893, 'recall': 0.5167958656330749, 'f1-score': 0.40705563093622793, 'support': 4644}, '1': {'precision': 0.9011422440994573, 'recall': 0.7444800709053466, 'f1-score': 0.8153540890468646, 'support': 38361}, '2': {'precision': 0.33184706275777504, 'recall': 0.6194340407823554, 'f1-score': 0.43216955795891704, 'support': 4806}, 'accuracy': 0.709794817092301, 'macro avg': {'precision': 0.5229158536381038, 'recall': 0.6269033257735922, 'f1-score': 0.5515264259806699, 'support': 47811}, 'weighted avg': {'precision': 0.7889990993987622, 'recall': 0.709794817092301, 'f1-score': 0.7371770399185369, 'support': 47811}}
[[ 2400  1799   445]
 [ 4253 28559  5549]
 [  495  1334  2977]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7542615
{'0': {'precision': 0.378764746703678, 'recall': 0.47885593963853307, 'f1-score': 0.42296962182269054, 'support': 5699}, '1': {'precision': 0.862972740863259, 'recall': 0.7466905187835421, 'f1-score': 0.800631510608788, 'support': 36335}, '2': {'precision': 0.37427729900730883, 'recall': 0.5939068720789337, 'f1-score': 0.45918094218415423, 'support': 5777}, 'accuracy': 0.6963041977787539, 'macro avg': {'precision': 0.5386715955247486, 'recall': 0.6064844435003364, 'f1-score': 0.5609273582052109, 'support': 47811}, 'weighted avg': {'precision': 0.746206830794085, 'recall': 0.6963041977787539, 'f1-score': 0.7143573260491451, 'support': 47811}}
[[ 2729  2445   525]
 [ 3993 27131  5211]
 [  483  1863  3431]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.81016415
{'0': {'precision': 0.4256842105263158, 'recall': 0.4058067968959058, 'f1-score': 0.4155079115007877, 'support': 7474}, '1': {'precision': 0.7871961874503575, 'recall': 0.7557189044104191, 'f1-score': 0.7711364591276202, 'support': 32786}, '2': {'precision': 0.4336119856693084, 'recall': 0.5289365646934181, 'f1-score': 0.4765541104880086, 'support': 7551}, 'accuracy': 0.6652025684465918, 'macro avg': {'precision': 0.5488307945486605, 'recall': 0.5634874219999143, 'f1-score': 0.5543994937054721, 'support': 47811}, 'weighted avg': {'precision': 0.6748401433772573, 'recall': 0.6652025684465918, 'f1-score': 0.669018555725879, 'support': 47811}}
[[ 3033  3694   747]
 [ 3539 24777  4470]
 [  553  3004  3994]]
training model: results/QRTEA/W9/deepLOB_L2/seq2seq
Epoch 1/50
505/505 - 31s - loss: 11.8230 - accuracy10: 0.4323 - accuracy20: 0.4308 - accuracy30: 0.4293 - accuracy50: 0.4371 - val_loss: 12.9780 - val_accuracy10: 0.7390 - val_accuracy20: 0.7134 - val_accuracy30: 0.6899 - val_accuracy50: 0.6398 - 31s/epoch - 61ms/step
Epoch 2/50
505/505 - 24s - loss: 11.1975 - accuracy10: 0.4716 - accuracy20: 0.4744 - accuracy30: 0.4730 - accuracy50: 0.4741 - val_loss: 12.6194 - val_accuracy10: 0.7502 - val_accuracy20: 0.7174 - val_accuracy30: 0.6915 - val_accuracy50: 0.6401 - 24s/epoch - 47ms/step
Epoch 3/50
505/505 - 23s - loss: 11.0041 - accuracy10: 0.4989 - accuracy20: 0.4976 - accuracy30: 0.4956 - accuracy50: 0.4962 - val_loss: 11.9569 - val_accuracy10: 0.7034 - val_accuracy20: 0.6753 - val_accuracy30: 0.6548 - val_accuracy50: 0.6141 - 23s/epoch - 47ms/step
Epoch 4/50
505/505 - 23s - loss: 10.5727 - accuracy10: 0.5596 - accuracy20: 0.5573 - accuracy30: 0.5537 - accuracy50: 0.5494 - val_loss: 12.1258 - val_accuracy10: 0.7567 - val_accuracy20: 0.7226 - val_accuracy30: 0.6951 - val_accuracy50: 0.6443 - 23s/epoch - 46ms/step
Epoch 5/50
505/505 - 24s - loss: 10.2372 - accuracy10: 0.5930 - accuracy20: 0.5862 - accuracy30: 0.5780 - accuracy50: 0.5702 - val_loss: 11.4366 - val_accuracy10: 0.7424 - val_accuracy20: 0.7147 - val_accuracy30: 0.6876 - val_accuracy50: 0.6412 - 24s/epoch - 47ms/step
Epoch 6/50
505/505 - 23s - loss: 9.8420 - accuracy10: 0.6457 - accuracy20: 0.6286 - accuracy30: 0.6131 - accuracy50: 0.5974 - val_loss: 10.9790 - val_accuracy10: 0.7019 - val_accuracy20: 0.6676 - val_accuracy30: 0.6347 - val_accuracy50: 0.5929 - 23s/epoch - 46ms/step
Epoch 7/50
505/505 - 23s - loss: 9.5811 - accuracy10: 0.6769 - accuracy20: 0.6535 - accuracy30: 0.6310 - accuracy50: 0.6091 - val_loss: 10.7769 - val_accuracy10: 0.7196 - val_accuracy20: 0.6910 - val_accuracy30: 0.6620 - val_accuracy50: 0.6224 - 23s/epoch - 46ms/step
Epoch 8/50
505/505 - 23s - loss: 9.3868 - accuracy10: 0.6918 - accuracy20: 0.6657 - accuracy30: 0.6396 - accuracy50: 0.6153 - val_loss: 10.6365 - val_accuracy10: 0.7152 - val_accuracy20: 0.6801 - val_accuracy30: 0.6476 - val_accuracy50: 0.6056 - 23s/epoch - 46ms/step
Epoch 9/50
505/505 - 23s - loss: 9.2550 - accuracy10: 0.6979 - accuracy20: 0.6711 - accuracy30: 0.6451 - accuracy50: 0.6183 - val_loss: 10.7136 - val_accuracy10: 0.7113 - val_accuracy20: 0.6759 - val_accuracy30: 0.6432 - val_accuracy50: 0.6035 - 23s/epoch - 46ms/step
Epoch 10/50
505/505 - 23s - loss: 9.1166 - accuracy10: 0.7031 - accuracy20: 0.6769 - accuracy30: 0.6506 - accuracy50: 0.6238 - val_loss: 10.8672 - val_accuracy10: 0.7254 - val_accuracy20: 0.6948 - val_accuracy30: 0.6654 - val_accuracy50: 0.6264 - 23s/epoch - 46ms/step
Epoch 11/50
505/505 - 23s - loss: 8.9834 - accuracy10: 0.7087 - accuracy20: 0.6828 - accuracy30: 0.6554 - accuracy50: 0.6289 - val_loss: 10.9882 - val_accuracy10: 0.7360 - val_accuracy20: 0.7034 - val_accuracy30: 0.6753 - val_accuracy50: 0.6342 - 23s/epoch - 46ms/step
Epoch 12/50
505/505 - 23s - loss: 8.8732 - accuracy10: 0.7104 - accuracy20: 0.6829 - accuracy30: 0.6553 - accuracy50: 0.6280 - val_loss: 10.9273 - val_accuracy10: 0.7012 - val_accuracy20: 0.6703 - val_accuracy30: 0.6417 - val_accuracy50: 0.6056 - 23s/epoch - 46ms/step
Epoch 13/50
505/505 - 24s - loss: 8.7496 - accuracy10: 0.7114 - accuracy20: 0.6845 - accuracy30: 0.6597 - accuracy50: 0.6341 - val_loss: 10.9685 - val_accuracy10: 0.7069 - val_accuracy20: 0.6741 - val_accuracy30: 0.6440 - val_accuracy50: 0.6060 - 24s/epoch - 47ms/step
Epoch 14/50
505/505 - 24s - loss: 8.6485 - accuracy10: 0.7119 - accuracy20: 0.6861 - accuracy30: 0.6605 - accuracy50: 0.6356 - val_loss: 11.0434 - val_accuracy10: 0.6601 - val_accuracy20: 0.6325 - val_accuracy30: 0.6076 - val_accuracy50: 0.5760 - 24s/epoch - 47ms/step
Epoch 15/50
505/505 - 23s - loss: 8.5202 - accuracy10: 0.7149 - accuracy20: 0.6887 - accuracy30: 0.6614 - accuracy50: 0.6362 - val_loss: 11.0979 - val_accuracy10: 0.6893 - val_accuracy20: 0.6621 - val_accuracy30: 0.6382 - val_accuracy50: 0.6033 - 23s/epoch - 46ms/step
Epoch 16/50
505/505 - 23s - loss: 8.4834 - accuracy10: 0.7151 - accuracy20: 0.6893 - accuracy30: 0.6629 - accuracy50: 0.6380 - val_loss: 10.9519 - val_accuracy10: 0.6852 - val_accuracy20: 0.6610 - val_accuracy30: 0.6366 - val_accuracy50: 0.6016 - 23s/epoch - 46ms/step
Epoch 17/50
505/505 - 24s - loss: 8.3374 - accuracy10: 0.7153 - accuracy20: 0.6904 - accuracy30: 0.6658 - accuracy50: 0.6414 - val_loss: 11.4128 - val_accuracy10: 0.6365 - val_accuracy20: 0.6132 - val_accuracy30: 0.5938 - val_accuracy50: 0.5652 - 24s/epoch - 47ms/step
Epoch 18/50
505/505 - 23s - loss: 8.2664 - accuracy10: 0.7172 - accuracy20: 0.6935 - accuracy30: 0.6687 - accuracy50: 0.6437 - val_loss: 11.3117 - val_accuracy10: 0.6527 - val_accuracy20: 0.6320 - val_accuracy30: 0.6110 - val_accuracy50: 0.5801 - 23s/epoch - 46ms/step
testing model: results/QRTEA/W9/deepLOB_L2/seq2seq
Evaluating performance on  test set...
1118/1118 - 18s - 18s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7482491
{'0': {'precision': 0.19484092177657283, 'recall': 0.5541444608232226, 'f1-score': 0.28831007934869174, 'support': 17638}, '1': {'precision': 0.9222006344377829, 'recall': 0.7074499116911348, 'f1-score': 0.800675652757898, 'support': 250258}, '2': {'precision': 0.19828683086430973, 'recall': 0.4779037292590767, 'f1-score': 0.28028198416649275, 'support': 18261}, 'accuracy': 0.6833521458500054, 'macro avg': {'precision': 0.43844279569288847, 'recall': 0.5798327005911447, 'f1-score': 0.4564225720910275, 'support': 286157}, 'weighted avg': {'precision': 0.8311717217116443, 'recall': 0.6833521458500054, 'f1-score': 0.7358859996446098, 'support': 286157}}
[[  9774   7107    757]
 [ 38685 177045  34528]
 [  1705   7829   8727]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8122264
{'0': {'precision': 0.2385904998447687, 'recall': 0.5701743539013231, 'f1-score': 0.33640973260861634, 'support': 24261}, '1': {'precision': 0.8875517517506147, 'recall': 0.6601655894901365, 'f1-score': 0.7571552114648108, 'support': 236730}, '2': {'precision': 0.2408921647664018, 'recall': 0.4986887069856155, 'f1-score': 0.32486021950714433, 'support': 25166}, 'accuracy': 0.638334900072338, 'macro avg': {'precision': 0.4556781387872617, 'recall': 0.576342883459025, 'f1-score': 0.4728083878601905, 'support': 286157}, 'weighted avg': {'precision': 0.7756611319211769, 'recall': 0.638334900072338, 'f1-score': 0.6834654473488299, 'support': 286157}}
[[ 13833   9278   1150]
 [ 42051 156281  38398]
 [  2094  10522  12550]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.86359936
{'0': {'precision': 0.2635019811033222, 'recall': 0.5823061898026537, 'f1-score': 0.36282183100069243, 'support': 29694}, '1': {'precision': 0.8569096674911375, 'recall': 0.6098063818184236, 'f1-score': 0.7125428048925797, 'support': 225547}, '2': {'precision': 0.2650174912543728, 'recall': 0.5145879156423858, 'f1-score': 0.34985595848085677, 'support': 30916}, 'accuracy': 0.5966654668591018, 'macro avg': {'precision': 0.4618097132829442, 'recall': 0.5689001624211544, 'f1-score': 0.475073531458043, 'support': 286157}, 'weighted avg': {'precision': 0.7313856147503847, 'recall': 0.5966654668591018, 'f1-score': 0.6370687080072667, 'support': 286157}}
[[ 17291  10645   1758]
 [ 45644 137540  42363]
 [  2685  12322  15909]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9193683
{'0': {'precision': 0.3024634913804696, 'recall': 0.5657335446062527, 'f1-score': 0.3941818181818182, 'support': 39759}, '1': {'precision': 0.7906687251383905, 'recall': 0.5550510894027935, 'f1-score': 0.6522331506197061, 'support': 204837}, '2': {'precision': 0.30697845429811016, 'recall': 0.5022256442337769, 'f1-score': 0.38104713571141696, 'support': 41561}, 'accuracy': 0.5488630367245952, 'macro avg': {'precision': 0.46670355693899007, 'recall': 0.541003426080941, 'f1-score': 0.4758207015043137, 'support': 286157}, 'weighted avg': {'precision': 0.6525864722654079, 'recall': 0.5488630367245952, 'f1-score': 0.5769925488102051, 'support': 286157}}
[[ 22493  13789   3477]
 [ 47497 113695  43645]
 [  4376  16312  20873]]
Evaluating performance on  train set...
505/505 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6431158
{'0': {'precision': 0.25346767270591425, 'recall': 0.5985276859063267, 'f1-score': 0.356122643306037, 'support': 9373}, '1': {'precision': 0.9256942628523612, 'recall': 0.8000090395480226, 'f1-score': 0.8582747417931436, 'support': 110625}, '2': {'precision': 0.332520254377559, 'recall': 0.41403622952597896, 'f1-score': 0.36882790607788196, 'support': 9219}, 'accuracy': 0.7578569383285481, 'macro avg': {'precision': 0.5038940633119448, 'recall': 0.6041909849934427, 'f1-score': 0.5277417637256875, 'support': 129217}, 'weighted avg': {'precision': 0.8346129731337341, 'recall': 0.7578569383285481, 'f1-score': 0.7869305533537073, 'support': 129217}}
[[ 5610  2857   906]
 [15368 88501  6756]
 [ 1155  4247  3817]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.69546664
{'0': {'precision': 0.31018885891128395, 'recall': 0.608215341527929, 'f1-score': 0.4108466025539965, 'support': 12854}, '1': {'precision': 0.8902897293931915, 'recall': 0.7719775187745226, 'f1-score': 0.8269231762160711, 'support': 103731}, '2': {'precision': 0.3869339589109263, 'recall': 0.4308898036732109, 'f1-score': 0.4077306266152291, 'support': 12632}, 'accuracy': 0.7223430353591246, 'macro avg': {'precision': 0.5291375157384673, 'recall': 0.6036942213252209, 'f1-score': 0.5485001351284322, 'support': 129217}, 'weighted avg': {'precision': 0.7833765006237076, 'recall': 0.7223430353591246, 'f1-score': 0.7445540718071301, 'support': 129217}}
[[ 7818  4037   999]
 [16028 80078  7625]
 [ 1358  5831  5443]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.749296
{'0': {'precision': 0.334850640113798, 'recall': 0.6054137465440751, 'f1-score': 0.4312046344423328, 'support': 15553}, '1': {'precision': 0.859987643172853, 'recall': 0.7361676159479251, 'f1-score': 0.7932750268516693, 'support': 98320}, '2': {'precision': 0.40158270832102994, 'recall': 0.443169968717414, 'f1-score': 0.42135266598506677, 'support': 15344}, 'accuracy': 0.6856373387402587, 'macro avg': {'precision': 0.5321403305358937, 'recall': 0.594917110403138, 'f1-score': 0.5486107757596896, 'support': 129217}, 'weighted avg': {'precision': 0.7423466119699628, 'recall': 0.6856373387402587, 'f1-score': 0.7055307090120696, 'support': 129217}}
[[ 9416  5014  1123]
 [16930 72380  9010]
 [ 1774  6770  6800]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.814613
{'0': {'precision': 0.3793977101439979, 'recall': 0.5788520820081225, 'f1-score': 0.45836723623542175, 'support': 20437}, '1': {'precision': 0.7992002248569092, 'recall': 0.7043847401135033, 'f1-score': 0.7488029686377783, 'support': 88808}, '2': {'precision': 0.4267860756931795, 'recall': 0.42234127778890446, 'f1-score': 0.42455204348701425, 'support': 19972}, 'accuracy': 0.6409373379663666, 'macro avg': {'precision': 0.5351280035646956, 'recall': 0.5685260333035101, 'f1-score': 0.5439074161200714, 'support': 129217}, 'weighted avg': {'precision': 0.675243165179887, 'recall': 0.6409373379663666, 'f1-score': 0.6527507886597721, 'support': 129217}}
[[11830  6950  1657]
 [16581 62555  9672]
 [ 2770  8767  8435]]
Evaluating performance on  val set...
187/187 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.71063626
{'0': {'precision': 0.2073569227896555, 'recall': 0.6691774630912926, 'f1-score': 0.31660727013542417, 'support': 3319}, '1': {'precision': 0.9325343305541932, 'recall': 0.7421148920600074, 'f1-score': 0.8264985941129328, 'support': 40995}, '2': {'precision': 0.34970969182670836, 'recall': 0.44755644469848527, 'f1-score': 0.39262880782248966, 'support': 3499}, 'accuracy': 0.7154957856649865, 'macro avg': {'precision': 0.4965336483901857, 'recall': 0.6196162666165951, 'f1-score': 0.5119115573569489, 'support': 47813}, 'weighted avg': {'precision': 0.8395435701484882, 'recall': 0.7154957856649865, 'f1-score': 0.7593528453309778, 'support': 47813}}
[[ 2221   852   246]
 [ 7906 30423  2666]
 [  584  1349  1566]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7546181
{'0': {'precision': 0.2540833333333333, 'recall': 0.65995670995671, 'f1-score': 0.36690734055354995, 'support': 4620}, '1': {'precision': 0.8945990180032733, 'recall': 0.71171875, 'f1-score': 0.7927483683828862, 'support': 38400}, '2': {'precision': 0.4178225346760403, 'recall': 0.4587940746922595, 'f1-score': 0.4373508353221957, 'support': 4793}, 'accuracy': 0.6813628092778115, 'macro avg': {'precision': 0.5221682953375489, 'recall': 0.6101565115496564, 'f1-score': 0.5323355147528773, 'support': 47813}, 'weighted avg': {'precision': 0.7849139501814978, 'recall': 0.6813628092778115, 'f1-score': 0.7159741453780251, 'support': 47813}}
[[ 3049  1321   250]
 [ 8256 27330  2814]
 [  695  1899  2199]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7995379
{'0': {'precision': 0.279652624362002, 'recall': 0.6472143864598026, 'f1-score': 0.3905526889728177, 'support': 5672}, '1': {'precision': 0.8603408535307676, 'recall': 0.6773998405147524, 'f1-score': 0.7579883386409441, 'support': 36367}, '2': {'precision': 0.43456708526107074, 'recall': 0.4554901281607205, 'f1-score': 0.44478268222560463, 'support': 5774}, 'accuracy': 0.6470206847510092, 'macro avg': {'precision': 0.5248535210512801, 'recall': 0.5933681183784252, 'f1-score': 0.5311079032797889, 'support': 47813}, 'weighted avg': {'precision': 0.7400371416985365, 'recall': 0.6470206847510093, 'f1-score': 0.6765764953125651, 'support': 47813}}
[[ 3671  1671   330]
 [ 8640 24635  3092]
 [  816  2328  2630]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8585381
{'0': {'precision': 0.3186226282501757, 'recall': 0.6081008583690987, 'f1-score': 0.41814995849857045, 'support': 7456}, '1': {'precision': 0.792249972001344, 'recall': 0.6467361492046078, 'f1-score': 0.7121357024211001, 'support': 32814}, '2': {'precision': 0.47189523248969983, 'recall': 0.42516240222723056, 'f1-score': 0.44731152800055796, 'support': 7543}, 'accuracy': 0.6057557568025432, 'macro avg': {'precision': 0.5275892775804065, 'recall': 0.559999803266979, 'f1-score': 0.5258657296400762, 'support': 47813}, 'weighted avg': {'precision': 0.6678528148443983, 'recall': 0.6057557568025432, 'f1-score': 0.6245125360366329, 'support': 47813}}
[[ 4534  2399   523]
 [ 8526 21222  3066]
 [ 1170  3166  3207]]
training model: results/QRTEA/W9/deepOF_L2/seq2seq
Epoch 1/50
505/505 - 20s - loss: 11.1262 - accuracy10: 0.5288 - accuracy20: 0.5153 - accuracy30: 0.4989 - accuracy50: 0.4866 - val_loss: 10.8257 - val_accuracy10: 0.7669 - val_accuracy20: 0.7476 - val_accuracy30: 0.7252 - val_accuracy50: 0.6811 - 20s/epoch - 40ms/step
Epoch 2/50
505/505 - 14s - loss: 10.0169 - accuracy10: 0.6317 - accuracy20: 0.6052 - accuracy30: 0.5768 - accuracy50: 0.5505 - val_loss: 10.4373 - val_accuracy10: 0.8094 - val_accuracy20: 0.7924 - val_accuracy30: 0.7697 - val_accuracy50: 0.7202 - 14s/epoch - 28ms/step
Epoch 3/50
505/505 - 14s - loss: 9.5824 - accuracy10: 0.6709 - accuracy20: 0.6474 - accuracy30: 0.6177 - accuracy50: 0.5844 - val_loss: 10.1640 - val_accuracy10: 0.8177 - val_accuracy20: 0.8006 - val_accuracy30: 0.7788 - val_accuracy50: 0.7299 - 14s/epoch - 28ms/step
Epoch 4/50
505/505 - 14s - loss: 9.3029 - accuracy10: 0.6842 - accuracy20: 0.6632 - accuracy30: 0.6350 - accuracy50: 0.6010 - val_loss: 10.1677 - val_accuracy10: 0.8138 - val_accuracy20: 0.7975 - val_accuracy30: 0.7765 - val_accuracy50: 0.7298 - 14s/epoch - 28ms/step
Epoch 5/50
505/505 - 14s - loss: 9.0472 - accuracy10: 0.6940 - accuracy20: 0.6749 - accuracy30: 0.6484 - accuracy50: 0.6167 - val_loss: 10.2702 - val_accuracy10: 0.8215 - val_accuracy20: 0.8046 - val_accuracy30: 0.7818 - val_accuracy50: 0.7331 - 14s/epoch - 28ms/step
Epoch 6/50
505/505 - 14s - loss: 8.8969 - accuracy10: 0.7007 - accuracy20: 0.6809 - accuracy30: 0.6530 - accuracy50: 0.6230 - val_loss: 9.9927 - val_accuracy10: 0.8129 - val_accuracy20: 0.7960 - val_accuracy30: 0.7761 - val_accuracy50: 0.7299 - 14s/epoch - 28ms/step
Epoch 7/50
505/505 - 14s - loss: 8.7637 - accuracy10: 0.7055 - accuracy20: 0.6854 - accuracy30: 0.6577 - accuracy50: 0.6273 - val_loss: 10.1118 - val_accuracy10: 0.8169 - val_accuracy20: 0.8005 - val_accuracy30: 0.7793 - val_accuracy50: 0.7321 - 14s/epoch - 28ms/step
Epoch 8/50
505/505 - 14s - loss: 8.6939 - accuracy10: 0.7060 - accuracy20: 0.6856 - accuracy30: 0.6589 - accuracy50: 0.6315 - val_loss: 9.9883 - val_accuracy10: 0.8104 - val_accuracy20: 0.7931 - val_accuracy30: 0.7727 - val_accuracy50: 0.7269 - 14s/epoch - 28ms/step
Epoch 9/50
505/505 - 14s - loss: 8.5667 - accuracy10: 0.7106 - accuracy20: 0.6887 - accuracy30: 0.6607 - accuracy50: 0.6344 - val_loss: 10.0532 - val_accuracy10: 0.8173 - val_accuracy20: 0.7993 - val_accuracy30: 0.7777 - val_accuracy50: 0.7305 - 14s/epoch - 28ms/step
Epoch 10/50
505/505 - 14s - loss: 8.4823 - accuracy10: 0.7121 - accuracy20: 0.6902 - accuracy30: 0.6637 - accuracy50: 0.6351 - val_loss: 9.9764 - val_accuracy10: 0.7960 - val_accuracy20: 0.7792 - val_accuracy30: 0.7599 - val_accuracy50: 0.7186 - 14s/epoch - 27ms/step
Epoch 11/50
505/505 - 14s - loss: 8.4060 - accuracy10: 0.7150 - accuracy20: 0.6921 - accuracy30: 0.6647 - accuracy50: 0.6377 - val_loss: 10.0153 - val_accuracy10: 0.8014 - val_accuracy20: 0.7844 - val_accuracy30: 0.7637 - val_accuracy50: 0.7202 - 14s/epoch - 27ms/step
Epoch 12/50
505/505 - 14s - loss: 8.3249 - accuracy10: 0.7175 - accuracy20: 0.6944 - accuracy30: 0.6671 - accuracy50: 0.6396 - val_loss: 10.2322 - val_accuracy10: 0.8013 - val_accuracy20: 0.7833 - val_accuracy30: 0.7620 - val_accuracy50: 0.7161 - 14s/epoch - 28ms/step
Epoch 13/50
505/505 - 14s - loss: 8.2529 - accuracy10: 0.7202 - accuracy20: 0.6971 - accuracy30: 0.6696 - accuracy50: 0.6414 - val_loss: 10.1457 - val_accuracy10: 0.8010 - val_accuracy20: 0.7823 - val_accuracy30: 0.7597 - val_accuracy50: 0.7165 - 14s/epoch - 28ms/step
Epoch 14/50
505/505 - 15s - loss: 8.1855 - accuracy10: 0.7194 - accuracy20: 0.6953 - accuracy30: 0.6682 - accuracy50: 0.6415 - val_loss: 10.0481 - val_accuracy10: 0.8040 - val_accuracy20: 0.7845 - val_accuracy30: 0.7607 - val_accuracy50: 0.7169 - 15s/epoch - 29ms/step
Epoch 15/50
505/505 - 14s - loss: 8.1087 - accuracy10: 0.7199 - accuracy20: 0.6980 - accuracy30: 0.6698 - accuracy50: 0.6416 - val_loss: 10.1277 - val_accuracy10: 0.7984 - val_accuracy20: 0.7779 - val_accuracy30: 0.7541 - val_accuracy50: 0.7117 - 14s/epoch - 29ms/step
Epoch 16/50
505/505 - 14s - loss: 8.0422 - accuracy10: 0.7212 - accuracy20: 0.6983 - accuracy30: 0.6720 - accuracy50: 0.6435 - val_loss: 10.4888 - val_accuracy10: 0.8022 - val_accuracy20: 0.7839 - val_accuracy30: 0.7602 - val_accuracy50: 0.7138 - 14s/epoch - 29ms/step
Epoch 17/50
505/505 - 14s - loss: 7.9644 - accuracy10: 0.7215 - accuracy20: 0.6985 - accuracy30: 0.6704 - accuracy50: 0.6422 - val_loss: 10.4565 - val_accuracy10: 0.8026 - val_accuracy20: 0.7810 - val_accuracy30: 0.7558 - val_accuracy50: 0.7106 - 14s/epoch - 28ms/step
Epoch 18/50
505/505 - 14s - loss: 7.8878 - accuracy10: 0.7206 - accuracy20: 0.6982 - accuracy30: 0.6708 - accuracy50: 0.6439 - val_loss: 10.6179 - val_accuracy10: 0.7934 - val_accuracy20: 0.7715 - val_accuracy30: 0.7467 - val_accuracy50: 0.7026 - 14s/epoch - 28ms/step
Epoch 19/50
505/505 - 14s - loss: 7.8041 - accuracy10: 0.7242 - accuracy20: 0.7018 - accuracy30: 0.6735 - accuracy50: 0.6482 - val_loss: 10.6779 - val_accuracy10: 0.7992 - val_accuracy20: 0.7744 - val_accuracy30: 0.7466 - val_accuracy50: 0.7011 - 14s/epoch - 28ms/step
Epoch 20/50
505/505 - 14s - loss: 7.7317 - accuracy10: 0.7211 - accuracy20: 0.7006 - accuracy30: 0.6738 - accuracy50: 0.6473 - val_loss: 11.0159 - val_accuracy10: 0.8063 - val_accuracy20: 0.7800 - val_accuracy30: 0.7516 - val_accuracy50: 0.7052 - 14s/epoch - 28ms/step
testing model: results/QRTEA/W9/deepOF_L2/seq2seq
Evaluating performance on  test set...
1118/1118 - 11s - 11s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.49872556
{'0': {'precision': 0.2870092314536759, 'recall': 0.5852137430547681, 'f1-score': 0.38513488302675275, 'support': 17638}, '1': {'precision': 0.9515475279629833, 'recall': 0.8348997418622679, 'f1-score': 0.889415320435051, 'support': 250254}, '2': {'precision': 0.36141508509456766, 'recall': 0.6058813865615246, 'f1-score': 0.4527560666202889, 'support': 18261}, 'accuracy': 0.8048945843657065, 'macro avg': {'precision': 0.533323948170409, 'recall': 0.6753316238261869, 'f1-score': 0.5757687566940309, 'support': 286153}, 'weighted avg': {'precision': 0.872926877426203, 'recall': 0.8048945843657065, 'f1-score': 0.8304666706256171, 'support': 286153}}
[[ 10322   5522   1794]
 [ 23562 208937  17755]
 [  2080   5117  11064]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.54146844
{'0': {'precision': 0.3506021647441435, 'recall': 0.568772927744116, 'f1-score': 0.433801222905107, 'support': 24261}, '1': {'precision': 0.9172391004877323, 'recall': 0.8325616958002079, 'f1-score': 0.8728515183858211, 'support': 236726}, '2': {'precision': 0.4454468564984494, 'recall': 0.5650480807438608, 'f1-score': 0.4981695247771024, 'support': 25166}, 'accuracy': 0.7866700681104165, 'macro avg': {'precision': 0.5710960405767751, 'recall': 0.655460901429395, 'f1-score': 0.6016074220226768, 'support': 286153}, 'weighted avg': {'precision': 0.8277055212126259, 'recall': 0.7866700681104165, 'f1-score': 0.8026756115464219, 'support': 286153}}
[[ 13799   8969   1493]
 [ 23427 197089  16210]
 [  2132   8814  14220]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.59864175
{'0': {'precision': 0.3867835435988086, 'recall': 0.5379201185424665, 'f1-score': 0.4500007043146314, 'support': 29694}, '1': {'precision': 0.8817000745895216, 'recall': 0.8280771294165635, 'f1-score': 0.8540477262906149, 'support': 225543}, '2': {'precision': 0.49364214350590374, 'recall': 0.5273968171820417, 'f1-score': 0.509961530040972, 'support': 30916}, 'accuracy': 0.7654821022320227, 'macro avg': {'precision': 0.587375253898078, 'recall': 0.6311313550470238, 'f1-score': 0.6046699868820727, 'support': 286153}, 'weighted avg': {'precision': 0.7884169342114045, 'recall': 0.7654821022320227, 'f1-score': 0.7749447949433678, 'support': 286153}}
[[ 15973  12467   1254]
 [ 23305 186767  15471]
 [  2019  12592  16305]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.6884078
{'0': {'precision': 0.4410404761340194, 'recall': 0.46781860710782464, 'f1-score': 0.45403505345896594, 'support': 39759}, '1': {'precision': 0.8066671101270514, 'recall': 0.8288467734848707, 'f1-score': 0.8176065494823019, 'support': 204834}, '2': {'precision': 0.5565136957689324, 'recall': 0.4487728585178056, 'f1-score': 0.4968697551748941, 'support': 41560}, 'accuracy': 0.7234835909461023, 'macro avg': {'precision': 0.6014070940100011, 'recall': 0.5818127463701669, 'f1-score': 0.5895037860387207, 'support': 286153}, 'weighted avg': {'precision': 0.7195342642660875, 'recall': 0.7234835909461023, 'f1-score': 0.7205079334209372, 'support': 286153}}
[[ 18600  19898   1261]
 [ 21456 169776  13602]
 [  2117  20792  18651]]
Evaluating performance on  train set...
505/505 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.50811046
{'0': {'precision': 0.3476810361745274, 'recall': 0.5714439307601333, 'f1-score': 0.43232471124125593, 'support': 9301}, '1': {'precision': 0.9482760379996122, 'recall': 0.8394789615363769, 'f1-score': 0.8905669779543178, 'support': 110702}, '2': {'precision': 0.36122794902379307, 'recall': 0.624484480138919, 'f1-score': 0.4577019448753132, 'support': 9214}, 'accuracy': 0.8048553982835076, 'macro avg': {'precision': 0.5523950077326443, 'recall': 0.6784691241451432, 'f1-score': 0.5935312113569623, 'support': 129217}, 'weighted avg': {'precision': 0.8631851041147649, 'recall': 0.8048553982835076, 'f1-score': 0.826716789995395, 'support': 129217}}
[[ 5315  2670  1316]
 [ 8911 92932  8859]
 [ 1061  2399  5754]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.5420346
{'0': {'precision': 0.4277807856584251, 'recall': 0.5565904821540388, 'f1-score': 0.48375795095071267, 'support': 12776}, '1': {'precision': 0.9111581008728985, 'recall': 0.8426746560826173, 'f1-score': 0.8755793119325747, 'support': 103804}, '2': {'precision': 0.4491923818707811, 'recall': 0.5897760544433014, 'f1-score': 0.5099729720483082, 'support': 12637}, 'accuracy': 0.789656159793216, 'macro avg': {'precision': 0.5960437561340349, 'recall': 0.6630137308933192, 'f1-score': 0.6231034116438652, 'support': 129217}, 'weighted avg': {'precision': 0.8181866700997815, 'recall': 0.789656159793216, 'f1-score': 0.8010838738321564, 'support': 129217}}
[[ 7111  4423  1242]
 [ 8434 87473  7897]
 [ 1078  4106  7453]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.5981126
{'0': {'precision': 0.4683624253559945, 'recall': 0.526631803215185, 'f1-score': 0.4957909132350707, 'support': 15489}, '1': {'precision': 0.8735462042715162, 'recall': 0.8398475222363405, 'f1-score': 0.8563654738151383, 'support': 98375}, '2': {'precision': 0.491609081934847, 'recall': 0.551423174623852, 'f1-score': 0.5198010683367104, 'support': 15353}, 'accuracy': 0.768033617867618, 'macro avg': {'precision': 0.6111725705207859, 'recall': 0.6393008333584592, 'f1-score': 0.6239858184623065, 'support': 129217}, 'weighted avg': {'precision': 0.7795974808770914, 'recall': 0.768033617867618, 'f1-score': 0.7731549621476723, 'support': 129217}}
[[ 8157  6140  1192]
 [ 8192 82620  7563]
 [ 1067  5820  8466]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.68535906
{'0': {'precision': 0.5266887901456775, 'recall': 0.4590646141778606, 'f1-score': 0.4905571417345522, 'support': 20398}, '1': {'precision': 0.7994226610850137, 'recall': 0.8447183296752772, 'f1-score': 0.8214465532716009, 'support': 88845}, '2': {'precision': 0.5441653852725098, 'recall': 0.478371883448483, 'f1-score': 0.5091519462872672, 'support': 19974}, 'accuracy': 0.7272108159143147, 'macro avg': {'precision': 0.6234256121677336, 'recall': 0.5940516091005402, 'f1-score': 0.6070518804311401, 'support': 129217}, 'weighted avg': {'precision': 0.7169123541865441, 'recall': 0.7272108159143147, 'f1-score': 0.7209392307332523, 'support': 129217}}
[[ 9364  9657  1377]
 [ 7169 75049  6627]
 [ 1246  9173  9555]]
Evaluating performance on  val set...
187/187 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.52118737
{'0': {'precision': 0.3200996677740864, 'recall': 0.5745378652355396, 'f1-score': 0.41113718796671644, 'support': 3354}, '1': {'precision': 0.9472390581794822, 'recall': 0.8283020711215319, 'f1-score': 0.8837869884164855, 'support': 40944}, '2': {'precision': 0.37040748162992654, 'recall': 0.6313692001138628, 'f1-score': 0.46689822123986946, 'support': 3513}, 'accuracy': 0.7960302022547112, 'macro avg': {'precision': 0.5459154025278317, 'recall': 0.6780697121569781, 'f1-score': 0.5872741325410238, 'support': 47811}, 'weighted avg': {'precision': 0.8608607175499559, 'recall': 0.7960302022547112, 'f1-score': 0.8199983692744476, 'support': 47811}}
[[ 1927  1076   351]
 [ 3611 33914  3419]
 [  482   813  2218]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.55841005
{'0': {'precision': 0.39012421407759545, 'recall': 0.5478036175710594, 'f1-score': 0.4557098074339454, 'support': 4644}, '1': {'precision': 0.9083649431024157, 'recall': 0.8302703266338208, 'f1-score': 0.8675637393767706, 'support': 38361}, '2': {'precision': 0.46153846153846156, 'recall': 0.5980024968789014, 'f1-score': 0.5209825070243814, 'support': 4806}, 'accuracy': 0.7794858923678651, 'macro avg': {'precision': 0.5866758729061576, 'recall': 0.6586921470279271, 'f1-score': 0.6147520179450324, 'support': 47811}, 'weighted avg': {'precision': 0.8131115910288839, 'recall': 0.7794858923678651, 'f1-score': 0.7927207312274313, 'support': 47811}}
[[ 2544  1777   323]
 [ 3481 31850  3030]
 [  496  1436  2874]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.613292
{'0': {'precision': 0.4341621303516257, 'recall': 0.5178101421301983, 'f1-score': 0.47231113956466064, 'support': 5699}, '1': {'precision': 0.8711077671026739, 'recall': 0.8284574102105408, 'f1-score': 0.849247436204878, 'support': 36335}, '2': {'precision': 0.5063487147723753, 'recall': 0.5660377358490566, 'f1-score': 0.5345320800980792, 'support': 5777}, 'accuracy': 0.7597205663968543, 'macro avg': {'precision': 0.603872870742225, 'recall': 0.6374350960632652, 'f1-score': 0.618696885289206, 'support': 47811}, 'weighted avg': {'precision': 0.7749506854863857, 'recall': 0.7597205663968543, 'f1-score': 0.7662901551025882, 'support': 47811}}
[[ 2951  2421   327]
 [ 3372 30102  2861]
 [  474  2033  3270]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.70725137
{'0': {'precision': 0.47743330930064887, 'recall': 0.443002408348943, 'f1-score': 0.45957387743771255, 'support': 7474}, '1': {'precision': 0.793992541661811, 'recall': 0.8312389434514732, 'f1-score': 0.8121889435255552, 'support': 32786}, '2': {'precision': 0.5648656898656899, 'recall': 0.49013375711826246, 'f1-score': 0.5248528681840743, 'support': 7551}, 'accuracy': 0.7166760787266528, 'macro avg': {'precision': 0.6120971802760499, 'recall': 0.5881250363062263, 'f1-score': 0.5988718963824473, 'support': 47811}, 'weighted avg': {'precision': 0.7083197768047731, 'recall': 0.7166760787266528, 'f1-score': 0.711686554768908, 'support': 47811}}
[[ 3311  3769   394]
 [ 3076 27253  2457]
 [  548  3302  3701]]
training model: results/QRTEA/W9/deepVOL_L2/seq2seq
Epoch 1/50
505/505 - 19s - loss: 11.0155 - accuracy10: 0.5449 - accuracy20: 0.5496 - accuracy30: 0.5450 - accuracy50: 0.5388 - val_loss: 10.7733 - val_accuracy10: 0.7405 - val_accuracy20: 0.7268 - val_accuracy30: 0.7054 - val_accuracy50: 0.6611 - 19s/epoch - 37ms/step
Epoch 2/50
505/505 - 14s - loss: 10.0633 - accuracy10: 0.6570 - accuracy20: 0.6438 - accuracy30: 0.6207 - accuracy50: 0.5933 - val_loss: 10.3836 - val_accuracy10: 0.7208 - val_accuracy20: 0.7133 - val_accuracy30: 0.6962 - val_accuracy50: 0.6559 - 14s/epoch - 27ms/step
Epoch 3/50
505/505 - 14s - loss: 9.6943 - accuracy10: 0.6978 - accuracy20: 0.6774 - accuracy30: 0.6459 - accuracy50: 0.6096 - val_loss: 10.2475 - val_accuracy10: 0.7599 - val_accuracy20: 0.7474 - val_accuracy30: 0.7249 - val_accuracy50: 0.6769 - 14s/epoch - 27ms/step
Epoch 4/50
505/505 - 13s - loss: 9.5086 - accuracy10: 0.7097 - accuracy20: 0.6837 - accuracy30: 0.6485 - accuracy50: 0.6111 - val_loss: 10.4527 - val_accuracy10: 0.7598 - val_accuracy20: 0.7480 - val_accuracy30: 0.7273 - val_accuracy50: 0.6799 - 13s/epoch - 26ms/step
Epoch 5/50
505/505 - 13s - loss: 9.3756 - accuracy10: 0.7153 - accuracy20: 0.6874 - accuracy30: 0.6520 - accuracy50: 0.6132 - val_loss: 10.3616 - val_accuracy10: 0.7591 - val_accuracy20: 0.7433 - val_accuracy30: 0.7200 - val_accuracy50: 0.6725 - 13s/epoch - 26ms/step
Epoch 6/50
505/505 - 13s - loss: 9.2511 - accuracy10: 0.7207 - accuracy20: 0.6949 - accuracy30: 0.6593 - accuracy50: 0.6193 - val_loss: 10.3030 - val_accuracy10: 0.7457 - val_accuracy20: 0.7361 - val_accuracy30: 0.7183 - val_accuracy50: 0.6742 - 13s/epoch - 27ms/step
Epoch 7/50
505/505 - 14s - loss: 9.1451 - accuracy10: 0.7217 - accuracy20: 0.6971 - accuracy30: 0.6632 - accuracy50: 0.6240 - val_loss: 10.4338 - val_accuracy10: 0.7710 - val_accuracy20: 0.7550 - val_accuracy30: 0.7344 - val_accuracy50: 0.6864 - 14s/epoch - 27ms/step
Epoch 8/50
505/505 - 13s - loss: 9.0871 - accuracy10: 0.7231 - accuracy20: 0.6994 - accuracy30: 0.6654 - accuracy50: 0.6255 - val_loss: 10.4141 - val_accuracy10: 0.7842 - val_accuracy20: 0.7692 - val_accuracy30: 0.7467 - val_accuracy50: 0.6969 - 13s/epoch - 27ms/step
Epoch 9/50
505/505 - 14s - loss: 8.9880 - accuracy10: 0.7250 - accuracy20: 0.7015 - accuracy30: 0.6665 - accuracy50: 0.6263 - val_loss: 10.4541 - val_accuracy10: 0.7904 - val_accuracy20: 0.7736 - val_accuracy30: 0.7506 - val_accuracy50: 0.6993 - 14s/epoch - 27ms/step
Epoch 10/50
505/505 - 13s - loss: 8.9694 - accuracy10: 0.7260 - accuracy20: 0.7000 - accuracy30: 0.6644 - accuracy50: 0.6239 - val_loss: 10.2607 - val_accuracy10: 0.7687 - val_accuracy20: 0.7561 - val_accuracy30: 0.7356 - val_accuracy50: 0.6875 - 13s/epoch - 27ms/step
Epoch 11/50
505/505 - 13s - loss: 8.8571 - accuracy10: 0.7280 - accuracy20: 0.7022 - accuracy30: 0.6673 - accuracy50: 0.6284 - val_loss: 10.3201 - val_accuracy10: 0.7576 - val_accuracy20: 0.7457 - val_accuracy30: 0.7246 - val_accuracy50: 0.6769 - 13s/epoch - 27ms/step
Epoch 12/50
505/505 - 13s - loss: 8.7998 - accuracy10: 0.7318 - accuracy20: 0.7046 - accuracy30: 0.6692 - accuracy50: 0.6300 - val_loss: 10.2972 - val_accuracy10: 0.7931 - val_accuracy20: 0.7811 - val_accuracy30: 0.7584 - val_accuracy50: 0.7051 - 13s/epoch - 26ms/step
Epoch 13/50
505/505 - 13s - loss: 8.7443 - accuracy10: 0.7271 - accuracy20: 0.7023 - accuracy30: 0.6683 - accuracy50: 0.6326 - val_loss: 10.4276 - val_accuracy10: 0.7746 - val_accuracy20: 0.7621 - val_accuracy30: 0.7420 - val_accuracy50: 0.6940 - 13s/epoch - 27ms/step
testing model: results/QRTEA/W9/deepVOL_L2/seq2seq
Evaluating performance on  test set...
1118/1118 - 11s - 11s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.79886615
{'0': {'precision': 0.1688897632631648, 'recall': 0.7300714366708243, 'f1-score': 0.2743201644600194, 'support': 17638}, '1': {'precision': 0.9585886392564308, 'recall': 0.64701228332361, 'f1-score': 0.7725688438902315, 'support': 250258}, '2': {'precision': 0.2678732590189526, 'recall': 0.6013909424456492, 'f1-score': 0.37065037632049685, 'support': 18261}, 'accuracy': 0.6492205327844505, 'macro avg': {'precision': 0.46511722051284937, 'recall': 0.6594915541466945, 'f1-score': 0.4725131282235826, 'support': 286157}, 'weighted avg': {'precision': 0.8658358415499766, 'recall': 0.6492205327844505, 'f1-score': 0.7162097705700575, 'support': 286157}}
[[ 12877   3111   1650]
 [ 59973 161920  28365]
 [  3395   3884  10982]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7998298
{'0': {'precision': 0.2164048425906096, 'recall': 0.7080499567206628, 'f1-score': 0.33149363180239294, 'support': 24261}, '1': {'precision': 0.9264117128884298, 'recall': 0.6441600135175094, 'f1-score': 0.7599237544694583, 'support': 236730}, '2': {'precision': 0.337561947217414, 'recall': 0.5656838591750775, 'f1-score': 0.42281590163204086, 'support': 25166}, 'accuracy': 0.6426751748166216, 'macro avg': {'precision': 0.49345950089881785, 'recall': 0.6392979431377499, 'f1-score': 0.5047444293012974, 'support': 286157}, 'weighted avg': {'precision': 0.8144295846051022, 'recall': 0.6426751748166216, 'f1-score': 0.6939536770974837, 'support': 286157}}
[[ 17178   5251   1832]
 [ 58133 152492  26105]
 [  4068   6862  14236]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.830991
{'0': {'precision': 0.2478396169958109, 'recall': 0.6973462652387687, 'f1-score': 0.3657059093638515, 'support': 29694}, '1': {'precision': 0.8939490425780092, 'recall': 0.6286184254279595, 'f1-score': 0.7381647793830535, 'support': 225547}, '2': {'precision': 0.3767384783201527, 'recall': 0.5362271962737741, 'f1-score': 0.4425520555258943, 'support': 30916}, 'accuracy': 0.6257683719077289, 'macro avg': {'precision': 0.5061757126313243, 'recall': 0.6207306289801674, 'f1-score': 0.515474248090933, 'support': 286157}, 'weighted avg': {'precision': 0.7710247210068658, 'recall': 0.6257683719077289, 'f1-score': 0.6675778055990185, 'support': 286157}}
[[ 20707   7079   1908]
 [ 58246 141783  25518]
 [  4597   9741  16578]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.881385
{'0': {'precision': 0.29545557211907664, 'recall': 0.6580145375889735, 'f1-score': 0.40780315960937435, 'support': 39759}, '1': {'precision': 0.8235375713379836, 'recall': 0.6086644502702149, 'f1-score': 0.6999823147469746, 'support': 204837}, '2': {'precision': 0.4243243828028647, 'recall': 0.47186063857943744, 'f1-score': 0.4468317801727084, 'support': 41561}, 'accuracy': 0.5956520371684075, 'macro avg': {'precision': 0.514439175419975, 'recall': 0.5795132088128753, 'f1-score': 0.5182057515096857, 'support': 286157}, 'weighted avg': {'precision': 0.692184113146667, 'recall': 0.5956520371684075, 'f1-score': 0.6226193971997648, 'support': 286157}}
[[ 26162  11164   2433]
 [ 55987 124677  24173]
 [  6399  15551  19611]]
Evaluating performance on  train set...
505/505 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6157087
{'0': {'precision': 0.2818562932631374, 'recall': 0.6168782673637042, 'f1-score': 0.38692408070398504, 'support': 9373}, '1': {'precision': 0.9464378026522624, 'recall': 0.8109378531073447, 'f1-score': 0.8734640624695733, 'support': 110625}, '2': {'precision': 0.3496694452428859, 'recall': 0.5278229742922226, 'f1-score': 0.4206613356386427, 'support': 9219}, 'accuracy': 0.7766625134463732, 'macro avg': {'precision': 0.5259878470527619, 'recall': 0.6518796982544238, 'f1-score': 0.5603498262707337, 'support': 129217}, 'weighted avg': {'precision': 0.8556546241659849, 'recall': 0.7766625134463732, 'f1-score': 0.8058667061794319, 'support': 129217}}
[[ 5782  2346  1245]
 [13110 89710  7805]
 [ 1622  2731  4866]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6353523
{'0': {'precision': 0.3530465105320202, 'recall': 0.582853586432239, 'f1-score': 0.4397358767424798, 'support': 12854}, '1': {'precision': 0.9070152393767554, 'recall': 0.8187716304672663, 'f1-score': 0.860637381567614, 'support': 103731}, '2': {'precision': 0.43268092219823084, 'recall': 0.4917669411019633, 'f1-score': 0.46033569231909294, 'support': 12632}, 'accuracy': 0.7633360935480625, 'macro avg': {'precision': 0.5642475573690021, 'recall': 0.6311307193338228, 'f1-score': 0.5869029835430623, 'support': 129217}, 'weighted avg': {'precision': 0.8055386137379513, 'recall': 0.7633360935480625, 'f1-score': 0.7796350453300478, 'support': 129217}}
[[ 7492  4075  1287]
 [11941 84932  6858]
 [ 1788  4632  6212]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.68550116
{'0': {'precision': 0.3863360187227148, 'recall': 0.5519192438757796, 'f1-score': 0.45451657312294824, 'support': 15553}, '1': {'precision': 0.8691655724006208, 'recall': 0.8145951993490643, 'f1-score': 0.8409960780607665, 'support': 98320}, '2': {'precision': 0.47350346777994745, 'recall': 0.45828988529718456, 'f1-score': 0.46577247888723294, 'support': 15344}, 'accuracy': 0.7406687974492521, 'macro avg': {'precision': 0.5763350196344277, 'recall': 0.6082681095073429, 'f1-score': 0.5870950433569826, 'support': 129217}, 'weighted avg': {'precision': 0.7640672696877263, 'recall': 0.7406687974492521, 'f1-score': 0.7499217871701207, 'support': 129217}}
[[ 8584  5735  1234]
 [11644 80091  6585]
 [ 1991  6321  7032]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.76278335
{'0': {'precision': 0.4312733764025842, 'recall': 0.4965014434603905, 'f1-score': 0.4615944501307858, 'support': 20437}, '1': {'precision': 0.7971204333781069, 'recall': 0.8085645437347987, 'f1-score': 0.8028017060668229, 'support': 88808}, '2': {'precision': 0.5119825708061002, 'recall': 0.4000600841177649, 'f1-score': 0.4491539715554556, 'support': 19972}, 'accuracy': 0.6960694026327805, 'macro avg': {'precision': 0.5801254601955971, 'recall': 0.568375357104318, 'f1-score': 0.5711833759176881, 'support': 129217}, 'weighted avg': {'precision': 0.695186557071608, 'recall': 0.6960694026327805, 'f1-score': 0.6941758654790843, 'support': 129217}}
[[10147  8849  1441]
 [10826 71807  6175]
 [ 2555  9427  7990]]
Evaluating performance on  val set...
187/187 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6363931
{'0': {'precision': 0.23528143196031917, 'recall': 0.6574269358240434, 'f1-score': 0.34654172953227985, 'support': 3319}, '1': {'precision': 0.9435681024447031, 'recall': 0.790852542993048, 'f1-score': 0.8604870280671489, 'support': 40995}, '2': {'precision': 0.39913854989231873, 'recall': 0.47670763075164335, 'f1-score': 0.43448814795519664, 'support': 3499}, 'accuracy': 0.7586012172421727, 'macro avg': {'precision': 0.5259960280991137, 'recall': 0.6416623698562449, 'f1-score': 0.5471723018515418, 'support': 47813}, 'weighted avg': {'precision': 0.8545596222464628, 'recall': 0.7586012172421727, 'f1-score': 0.7936358677687164, 'support': 47813}}
[[ 2182   848   289]
 [ 6352 32421  2222]
 [  740  1091  1668]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.65467745
{'0': {'precision': 0.29721524288107204, 'recall': 0.6145021645021645, 'f1-score': 0.4006491673722834, 'support': 4620}, '1': {'precision': 0.9026421089796399, 'recall': 0.7989322916666667, 'f1-score': 0.8476266784549925, 'support': 38400}, '2': {'precision': 0.5104142288790077, 'recall': 0.45503859795535156, 'f1-score': 0.4811383189940437, 'support': 4793}, 'accuracy': 0.7466379436554912, 'macro avg': {'precision': 0.5700905269132398, 'recall': 0.6228243513747276, 'f1-score': 0.5764713882737732, 'support': 47813}, 'weighted avg': {'precision': 0.8048230984448959, 'recall': 0.7466379436554912, 'f1-score': 0.7676983157064002, 'support': 47813}}
[[ 2839  1505   276]
 [ 5905 30679  1816]
 [  808  1804  2181]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7036901
{'0': {'precision': 0.3290910912917126, 'recall': 0.578984485190409, 'f1-score': 0.41965369624944093, 'support': 5672}, '1': {'precision': 0.8630354151710936, 'recall': 0.7933841119696428, 'f1-score': 0.8267453688448259, 'support': 36367}, '2': {'precision': 0.5545206724216265, 'recall': 0.42275718739175616, 'f1-score': 0.4797562893081761, 'support': 5774}, 'accuracy': 0.7231924372032711, 'macro avg': {'precision': 0.5822157262948109, 'recall': 0.5983752615172694, 'f1-score': 0.5753851181341476, 'support': 47813}, 'weighted avg': {'precision': 0.7624373282558348, 'recall': 0.7231924372032711, 'f1-score': 0.7365494197890118, 'support': 47813}}
[[ 3284  2107   281]
 [ 5834 28853  1680]
 [  861  2472  2441]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.78508437
{'0': {'precision': 0.36704761904761907, 'recall': 0.5168991416309013, 'f1-score': 0.42927155268433953, 'support': 7456}, '1': {'precision': 0.785299688397385, 'recall': 0.7833851404888158, 'f1-score': 0.7843412461097211, 'support': 32814}, '2': {'precision': 0.5959816553832714, 'recall': 0.36179239029563837, 'f1-score': 0.4502557333773305, 'support': 7543}, 'accuracy': 0.6753184280425826, 'macro avg': {'precision': 0.5827763209427584, 'recall': 0.5540255574717852, 'f1-score': 0.5546228440571304, 'support': 47813}, 'weighted avg': {'precision': 0.6902102074592027, 'recall': 0.6753184280425826, 'f1-score': 0.6762658972146492, 'support': 47813}}
[[ 3854  3269   333]
 [ 5591 25706  1517]
 [ 1055  3759  2729]]
training model: results/QRTEA/W9/deepVOL_L3/seq2seq
Epoch 1/50
505/505 - 27s - loss: 11.7661 - accuracy10: 0.4177 - accuracy20: 0.4241 - accuracy30: 0.4286 - accuracy50: 0.4383 - val_loss: 10.8211 - val_accuracy10: 0.5825 - val_accuracy20: 0.5855 - val_accuracy30: 0.5809 - val_accuracy50: 0.5665 - 27s/epoch - 54ms/step
Epoch 2/50
505/505 - 21s - loss: 10.1506 - accuracy10: 0.6383 - accuracy20: 0.6296 - accuracy30: 0.6138 - accuracy50: 0.5924 - val_loss: 10.2160 - val_accuracy10: 0.6887 - val_accuracy20: 0.6819 - val_accuracy30: 0.6687 - val_accuracy50: 0.6381 - 21s/epoch - 41ms/step
Epoch 3/50
505/505 - 20s - loss: 9.6403 - accuracy10: 0.6869 - accuracy20: 0.6658 - accuracy30: 0.6390 - accuracy50: 0.6071 - val_loss: 10.3496 - val_accuracy10: 0.7494 - val_accuracy20: 0.7365 - val_accuracy30: 0.7153 - val_accuracy50: 0.6731 - 20s/epoch - 40ms/step
Epoch 4/50
505/505 - 20s - loss: 9.3716 - accuracy10: 0.6962 - accuracy20: 0.6727 - accuracy30: 0.6443 - accuracy50: 0.6140 - val_loss: 10.2078 - val_accuracy10: 0.7307 - val_accuracy20: 0.7265 - val_accuracy30: 0.7111 - val_accuracy50: 0.6722 - 20s/epoch - 40ms/step
Epoch 5/50
505/505 - 20s - loss: 9.1992 - accuracy10: 0.7093 - accuracy20: 0.6852 - accuracy30: 0.6552 - accuracy50: 0.6230 - val_loss: 10.1025 - val_accuracy10: 0.7243 - val_accuracy20: 0.7189 - val_accuracy30: 0.7042 - val_accuracy50: 0.6682 - 20s/epoch - 39ms/step
Epoch 6/50
505/505 - 20s - loss: 9.0539 - accuracy10: 0.7145 - accuracy20: 0.6892 - accuracy30: 0.6595 - accuracy50: 0.6264 - val_loss: 9.7957 - val_accuracy10: 0.7601 - val_accuracy20: 0.7492 - val_accuracy30: 0.7302 - val_accuracy50: 0.6889 - 20s/epoch - 40ms/step
Epoch 7/50
505/505 - 20s - loss: 8.9696 - accuracy10: 0.7200 - accuracy20: 0.6933 - accuracy30: 0.6629 - accuracy50: 0.6290 - val_loss: 9.7224 - val_accuracy10: 0.7449 - val_accuracy20: 0.7338 - val_accuracy30: 0.7161 - val_accuracy50: 0.6789 - 20s/epoch - 40ms/step
Epoch 8/50
505/505 - 20s - loss: 8.9179 - accuracy10: 0.7159 - accuracy20: 0.6914 - accuracy30: 0.6632 - accuracy50: 0.6303 - val_loss: 9.8375 - val_accuracy10: 0.7281 - val_accuracy20: 0.7251 - val_accuracy30: 0.7141 - val_accuracy50: 0.6789 - 20s/epoch - 39ms/step
Epoch 9/50
505/505 - 20s - loss: 8.8639 - accuracy10: 0.7189 - accuracy20: 0.6930 - accuracy30: 0.6633 - accuracy50: 0.6303 - val_loss: 9.8253 - val_accuracy10: 0.7999 - val_accuracy20: 0.7868 - val_accuracy30: 0.7663 - val_accuracy50: 0.7188 - 20s/epoch - 40ms/step
Epoch 10/50
505/505 - 20s - loss: 8.7634 - accuracy10: 0.7240 - accuracy20: 0.6972 - accuracy30: 0.6679 - accuracy50: 0.6342 - val_loss: 9.8860 - val_accuracy10: 0.7579 - val_accuracy20: 0.7480 - val_accuracy30: 0.7300 - val_accuracy50: 0.6896 - 20s/epoch - 39ms/step
Epoch 11/50
505/505 - 20s - loss: 8.7477 - accuracy10: 0.7242 - accuracy20: 0.6966 - accuracy30: 0.6659 - accuracy50: 0.6329 - val_loss: 9.8953 - val_accuracy10: 0.7629 - val_accuracy20: 0.7510 - val_accuracy30: 0.7334 - val_accuracy50: 0.6927 - 20s/epoch - 39ms/step
Epoch 12/50
505/505 - 20s - loss: 8.6572 - accuracy10: 0.7279 - accuracy20: 0.7008 - accuracy30: 0.6709 - accuracy50: 0.6371 - val_loss: 9.9776 - val_accuracy10: 0.7284 - val_accuracy20: 0.7208 - val_accuracy30: 0.7062 - val_accuracy50: 0.6721 - 20s/epoch - 39ms/step
Epoch 13/50
505/505 - 20s - loss: 8.6734 - accuracy10: 0.7208 - accuracy20: 0.6965 - accuracy30: 0.6667 - accuracy50: 0.6344 - val_loss: 10.0942 - val_accuracy10: 0.7857 - val_accuracy20: 0.7749 - val_accuracy30: 0.7562 - val_accuracy50: 0.7111 - 20s/epoch - 39ms/step
Epoch 14/50
505/505 - 20s - loss: 8.5499 - accuracy10: 0.7275 - accuracy20: 0.7038 - accuracy30: 0.6743 - accuracy50: 0.6420 - val_loss: 10.0688 - val_accuracy10: 0.7846 - val_accuracy20: 0.7734 - val_accuracy30: 0.7548 - val_accuracy50: 0.7096 - 20s/epoch - 39ms/step
Epoch 15/50
505/505 - 20s - loss: 8.5091 - accuracy10: 0.7300 - accuracy20: 0.7058 - accuracy30: 0.6753 - accuracy50: 0.6442 - val_loss: 10.2172 - val_accuracy10: 0.7965 - val_accuracy20: 0.7847 - val_accuracy30: 0.7624 - val_accuracy50: 0.7140 - 20s/epoch - 39ms/step
Epoch 16/50
505/505 - 20s - loss: 8.4883 - accuracy10: 0.7284 - accuracy20: 0.7034 - accuracy30: 0.6734 - accuracy50: 0.6418 - val_loss: 9.9438 - val_accuracy10: 0.8019 - val_accuracy20: 0.7877 - val_accuracy30: 0.7661 - val_accuracy50: 0.7189 - 20s/epoch - 39ms/step
Epoch 17/50
505/505 - 20s - loss: 8.4332 - accuracy10: 0.7294 - accuracy20: 0.7043 - accuracy30: 0.6742 - accuracy50: 0.6437 - val_loss: 10.2168 - val_accuracy10: 0.8230 - val_accuracy20: 0.8046 - val_accuracy30: 0.7816 - val_accuracy50: 0.7284 - 20s/epoch - 39ms/step
testing model: results/QRTEA/W9/deepVOL_L3/seq2seq
Evaluating performance on  test set...
1118/1118 - 19s - 19s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.80183
{'0': {'precision': 0.15514531248207258, 'recall': 0.7666402086404355, 'f1-score': 0.25806574741161314, 'support': 17638}, '1': {'precision': 0.9590591401050163, 'recall': 0.6437236771651655, 'f1-score': 0.7703714684672622, 'support': 250258}, '2': {'precision': 0.3504480113453233, 'recall': 0.5954219374623515, 'f1-score': 0.4412116785359223, 'support': 18261}, 'accuracy': 0.6482175868491772, 'macro avg': {'precision': 0.4882174879774707, 'recall': 0.668595274422651, 'f1-score': 0.4898829648049326, 'support': 286157}, 'weighted avg': {'precision': 0.870669619967839, 'recall': 0.6482175868491772, 'f1-score': 0.71778902165689, 'support': 286157}}
[[ 13522   2398   1718]
 [ 70726 161097  18435]
 [  2909   4479  10873]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8017119
{'0': {'precision': 0.20487951538906954, 'recall': 0.7583776431309509, 'f1-score': 0.3226055319335467, 'support': 24261}, '1': {'precision': 0.9284198033853928, 'recall': 0.6410932285726355, 'f1-score': 0.7584564601933548, 'support': 236730}, '2': {'precision': 0.425256948245454, 'recall': 0.5557100850353651, 'f1-score': 0.48180941225108526, 'support': 25166}, 'accuracy': 0.643527853590861, 'macro avg': {'precision': 0.5195187556733054, 'recall': 0.6517269855796505, 'f1-score': 0.5209571347926623, 'support': 286157}, 'weighted avg': {'precision': 0.8228259953026602, 'recall': 0.643527853590861, 'f1-score': 0.6971744402566544, 'support': 286157}}
[[ 18399   4175   1687]
 [ 67750 151766  17214]
 [  3655   7526  13985]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.82153636
{'0': {'precision': 0.24058429170981632, 'recall': 0.7432477941671718, 'f1-score': 0.3635045993955316, 'support': 29694}, '1': {'precision': 0.8960456507168941, 'recall': 0.634240313548839, 'f1-score': 0.7427478101943435, 'support': 225547}, '2': {'precision': 0.4651042415528397, 'recall': 0.5231595290464485, 'f1-score': 0.492426664231021, 'support': 30916}, 'accuracy': 0.6335508130152329, 'macro avg': {'precision': 0.53391139465985, 'recall': 0.6335492122541532, 'f1-score': 0.5328930246069654, 'support': 286157}, 'weighted avg': {'precision': 0.781471293982402, 'recall': 0.6335508130152329, 'f1-score': 0.6763500759084026, 'support': 286157}}
[[ 22070   6068   1556]
 [ 65451 143051  17045]
 [  4214  10528  16174]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.85879517
{'0': {'precision': 0.2951923796491303, 'recall': 0.6944842677129707, 'f1-score': 0.41428978679350026, 'support': 39759}, '1': {'precision': 0.8261336950748971, 'recall': 0.630301166293199, 'f1-score': 0.7150515897850563, 'support': 204837}, '2': {'precision': 0.5191127500894405, 'recall': 0.4538629965592743, 'f1-score': 0.4842999820277799, 'support': 41561}, 'accuracy': 0.6135932372788364, 'macro avg': {'precision': 0.5468129416044892, 'recall': 0.5928828101884812, 'f1-score': 0.5378804528687788, 'support': 286157}, 'weighted avg': {'precision': 0.7077728188616519, 'recall': 0.6135932372788364, 'f1-score': 0.6397493742350561, 'support': 286157}}
[[ 27612  10234   1913]
 [ 60167 129109  15561]
 [  5760  16938  18863]]
Evaluating performance on  train set...
505/505 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.67163056
{'0': {'precision': 0.26562710041672266, 'recall': 0.6324549237170597, 'f1-score': 0.3741243294414642, 'support': 9373}, '1': {'precision': 0.9538145967048237, 'recall': 0.7818305084745762, 'f1-score': 0.8593016497518665, 'support': 110625}, '2': {'precision': 0.34101837011465913, 'recall': 0.6000650829808005, 'f1-score': 0.43488856570103374, 'support': 9219}, 'accuracy': 0.7580271945641828, 'macro avg': {'precision': 0.5201533557454019, 'recall': 0.6714501717241456, 'f1-score': 0.5561048482981215, 'support': 129217}, 'weighted avg': {'precision': 0.8601756032624509, 'recall': 0.7580271945641828, 'f1-score': 0.7938285986430029, 'support': 129217}}
[[ 5928  1935  1510]
 [14955 86490  9180]
 [ 1434  2253  5532]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6772197
{'0': {'precision': 0.33912067029454956, 'recall': 0.610860432550179, 'f1-score': 0.4361253054876694, 'support': 12854}, '1': {'precision': 0.9182477647191137, 'recall': 0.7870935400217871, 'f1-score': 0.8476272541345266, 'support': 103731}, '2': {'precision': 0.4177746675997201, 'recall': 0.5671310956301456, 'f1-score': 0.4811282740094023, 'support': 12632}, 'accuracy': 0.7480594658597552, 'macro avg': {'precision': 0.5583810342044612, 'recall': 0.6550283560673705, 'f1-score': 0.5882936112105327, 'support': 129217}, 'weighted avg': {'precision': 0.8117132078531787, 'recall': 0.7480594658597552, 'f1-score': 0.7708644352728653, 'support': 129217}}
[[ 7852  3419  1583]
 [13684 81646  8401]
 [ 1618  3850  7164]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7131337
{'0': {'precision': 0.3823070763265478, 'recall': 0.5832315308943612, 'f1-score': 0.4618635437881874, 'support': 15553}, '1': {'precision': 0.8829734837638165, 'recall': 0.7840520748576079, 'f1-score': 0.8305777777777777, 'support': 98320}, '2': {'precision': 0.45367060764366235, 'recall': 0.5376694473409802, 'f1-score': 0.49211130663008146, 'support': 15344}, 'accuracy': 0.7306236795468088, 'macro avg': {'precision': 0.5729837225780089, 'recall': 0.634984351030983, 'f1-score': 0.5948508760653489, 'support': 129217}, 'weighted avg': {'precision': 0.7717335697737108, 'recall': 0.7306236795468088, 'f1-score': 0.7460065370390953, 'support': 129217}}
[[ 9071  4901  1581]
 [12878 77088  8354]
 [ 1778  5316  8250]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.77082497
{'0': {'precision': 0.44188916772946063, 'recall': 0.5255663747125312, 'f1-score': 0.4801090649025567, 'support': 20437}, '1': {'precision': 0.8127520690057116, 'recall': 0.7851319700927845, 'f1-score': 0.798703307025281, 'support': 88808}, '2': {'precision': 0.49492677824267783, 'recall': 0.4738133386741438, 'f1-score': 0.4841399774890003, 'support': 19972}, 'accuracy': 0.6959610577555585, 'macro avg': {'precision': 0.58318933832595, 'recall': 0.5948372278264865, 'f1-score': 0.587650783138946, 'support': 129217}, 'weighted avg': {'precision': 0.7049726605648559, 'recall': 0.6959610577555585, 'f1-score': 0.6996948998980398, 'support': 129217}}
[[10741  7843  1853]
 [11278 69726  7804]
 [ 2288  8221  9463]]
Evaluating performance on  val set...
187/187 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.65810925
{'0': {'precision': 0.22757803239826155, 'recall': 0.6941849954805664, 'f1-score': 0.3427806293238116, 'support': 3319}, '1': {'precision': 0.9495151515151515, 'recall': 0.7643371142822295, 'f1-score': 0.8469220893303601, 'support': 40995}, '2': {'precision': 0.40221795692045215, 'recall': 0.5390111460417262, 'f1-score': 0.4606741573033708, 'support': 3499}, 'accuracy': 0.7429778512120134, 'macro avg': {'precision': 0.5264370469446217, 'recall': 0.6658444186015074, 'f1-score': 0.5501256253191809, 'support': 47813}, 'weighted avg': {'precision': 0.859349251399371, 'recall': 0.7429778512120134, 'f1-score': 0.7836604864206038, 'support': 47813}}
[[ 2304   685   330]
 [ 7188 31334  2473]
 [  632   981  1886]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6688199
{'0': {'precision': 0.28889311525294786, 'recall': 0.6575757575757576, 'f1-score': 0.4014270613107822, 'support': 4620}, '1': {'precision': 0.9105989929257668, 'recall': 0.7676302083333333, 'f1-score': 0.8330248265532493, 'support': 38400}, '2': {'precision': 0.4989849776695087, 'recall': 0.5128312121844356, 'f1-score': 0.5058133552834653, 'support': 4793}, 'accuracy': 0.7314537887185494, 'macro avg': {'precision': 0.5661590286160745, 'recall': 0.6460123926978422, 'f1-score': 0.5800884143824989, 'support': 47813}, 'weighted avg': {'precision': 0.8092636420803551, 'recall': 0.7314537887185494, 'f1-score': 0.7585198539053027, 'support': 47813}}
[[ 3038  1271   311]
 [ 6766 29477  2157]
 [  712  1623  2458]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7057562
{'0': {'precision': 0.3279948157748565, 'recall': 0.6246473906911142, 'f1-score': 0.4301323297316984, 'support': 5672}, '1': {'precision': 0.8737424547283702, 'recall': 0.764209310638766, 'f1-score': 0.8153135313531354, 'support': 36367}, '2': {'precision': 0.5394964443590237, 'recall': 0.48614478697609975, 'f1-score': 0.5114329962649176, 'support': 5774}, 'accuracy': 0.7140735783155209, 'macro avg': {'precision': 0.5804112382874168, 'recall': 0.6250004961019933, 'f1-score': 0.5856262857832505, 'support': 47813}, 'weighted avg': {'precision': 0.7686367915820097, 'recall': 0.7140735783155209, 'f1-score': 0.7329226756194195, 'support': 47813}}
[[ 3543  1819   310]
 [ 6489 27792  2086]
 [  770  2197  2807]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7729669
{'0': {'precision': 0.37657282520141216, 'recall': 0.5579399141630901, 'f1-score': 0.44965681240879857, 'support': 7456}, '1': {'precision': 0.7984800587540314, 'recall': 0.7620527823489974, 'f1-score': 0.7798412624159923, 'support': 32814}, '2': {'precision': 0.5854285189943109, 'recall': 0.4229086570330107, 'f1-score': 0.4910714285714286, 'support': 7543}, 'accuracy': 0.6767197205780855, 'macro avg': {'precision': 0.5868271343165848, 'recall': 0.5809671178483661, 'f1-score': 0.5735231677987398, 'support': 47813}, 'weighted avg': {'precision': 0.699076379884772, 'recall': 0.6767197205780855, 'f1-score': 0.6827955611225537, 'support': 47813}}
[[ 4160  2916   380]
 [ 5929 25006  1879]
 [  958  3395  3190]]
training model: results/QRTEA/W10/deepLOB_L1/seq2seq
Epoch 1/50
529/529 - 20s - loss: 10.9808 - accuracy10: 0.4547 - accuracy20: 0.4598 - accuracy30: 0.4638 - accuracy50: 0.4735 - val_loss: 13.9550 - val_accuracy10: 0.5949 - val_accuracy20: 0.5913 - val_accuracy30: 0.5856 - val_accuracy50: 0.5704 - 20s/epoch - 37ms/step
Epoch 2/50
529/529 - 12s - loss: 10.7053 - accuracy10: 0.4603 - accuracy20: 0.4673 - accuracy30: 0.4759 - accuracy50: 0.4902 - val_loss: 13.7899 - val_accuracy10: 0.5774 - val_accuracy20: 0.5779 - val_accuracy30: 0.5776 - val_accuracy50: 0.5715 - 12s/epoch - 22ms/step
Epoch 3/50
529/529 - 11s - loss: 10.5189 - accuracy10: 0.4989 - accuracy20: 0.4986 - accuracy30: 0.5005 - accuracy50: 0.5089 - val_loss: 13.4225 - val_accuracy10: 0.6251 - val_accuracy20: 0.6090 - val_accuracy30: 0.5989 - val_accuracy50: 0.5855 - 11s/epoch - 21ms/step
Epoch 4/50
529/529 - 12s - loss: 10.2946 - accuracy10: 0.5391 - accuracy20: 0.5277 - accuracy30: 0.5234 - accuracy50: 0.5272 - val_loss: 13.4820 - val_accuracy10: 0.6843 - val_accuracy20: 0.6551 - val_accuracy30: 0.6357 - val_accuracy50: 0.6143 - 12s/epoch - 23ms/step
Epoch 5/50
529/529 - 11s - loss: 10.1208 - accuracy10: 0.5645 - accuracy20: 0.5481 - accuracy30: 0.5426 - accuracy50: 0.5443 - val_loss: 12.9075 - val_accuracy10: 0.5067 - val_accuracy20: 0.4886 - val_accuracy30: 0.4857 - val_accuracy50: 0.4972 - 11s/epoch - 21ms/step
Epoch 6/50
529/529 - 11s - loss: 9.9554 - accuracy10: 0.5849 - accuracy20: 0.5640 - accuracy30: 0.5544 - accuracy50: 0.5531 - val_loss: 12.8309 - val_accuracy10: 0.5182 - val_accuracy20: 0.5048 - val_accuracy30: 0.5014 - val_accuracy50: 0.5086 - 11s/epoch - 21ms/step
Epoch 7/50
529/529 - 11s - loss: 9.8749 - accuracy10: 0.5927 - accuracy20: 0.5685 - accuracy30: 0.5557 - accuracy50: 0.5532 - val_loss: 12.6100 - val_accuracy10: 0.5795 - val_accuracy20: 0.5478 - val_accuracy30: 0.5305 - val_accuracy50: 0.5300 - 11s/epoch - 21ms/step
Epoch 8/50
529/529 - 11s - loss: 9.7186 - accuracy10: 0.6083 - accuracy20: 0.5841 - accuracy30: 0.5706 - accuracy50: 0.5659 - val_loss: 13.4906 - val_accuracy10: 0.4302 - val_accuracy20: 0.4269 - val_accuracy30: 0.4290 - val_accuracy50: 0.4421 - 11s/epoch - 21ms/step
Epoch 9/50
529/529 - 11s - loss: 9.6226 - accuracy10: 0.6210 - accuracy20: 0.5915 - accuracy30: 0.5753 - accuracy50: 0.5688 - val_loss: 12.8347 - val_accuracy10: 0.5367 - val_accuracy20: 0.5226 - val_accuracy30: 0.5193 - val_accuracy50: 0.5243 - 11s/epoch - 21ms/step
Epoch 10/50
529/529 - 11s - loss: 9.4704 - accuracy10: 0.6356 - accuracy20: 0.6031 - accuracy30: 0.5844 - accuracy50: 0.5753 - val_loss: 13.4925 - val_accuracy10: 0.4720 - val_accuracy20: 0.4612 - val_accuracy30: 0.4592 - val_accuracy50: 0.4679 - 11s/epoch - 21ms/step
Epoch 11/50
529/529 - 12s - loss: 9.3547 - accuracy10: 0.6409 - accuracy20: 0.6085 - accuracy30: 0.5880 - accuracy50: 0.5778 - val_loss: 12.6710 - val_accuracy10: 0.6366 - val_accuracy20: 0.5988 - val_accuracy30: 0.5759 - val_accuracy50: 0.5654 - 12s/epoch - 22ms/step
Epoch 12/50
529/529 - 11s - loss: 9.2618 - accuracy10: 0.6553 - accuracy20: 0.6195 - accuracy30: 0.5952 - accuracy50: 0.5808 - val_loss: 13.0942 - val_accuracy10: 0.6744 - val_accuracy20: 0.6468 - val_accuracy30: 0.6282 - val_accuracy50: 0.6105 - 11s/epoch - 21ms/step
Epoch 13/50
529/529 - 11s - loss: 9.1571 - accuracy10: 0.6613 - accuracy20: 0.6240 - accuracy30: 0.5983 - accuracy50: 0.5834 - val_loss: 12.5741 - val_accuracy10: 0.6700 - val_accuracy20: 0.6366 - val_accuracy30: 0.6178 - val_accuracy50: 0.6032 - 11s/epoch - 21ms/step
Epoch 14/50
529/529 - 12s - loss: 9.0390 - accuracy10: 0.6693 - accuracy20: 0.6314 - accuracy30: 0.6041 - accuracy50: 0.5883 - val_loss: 12.8564 - val_accuracy10: 0.6780 - val_accuracy20: 0.6532 - val_accuracy30: 0.6339 - val_accuracy50: 0.6144 - 12s/epoch - 22ms/step
Epoch 15/50
529/529 - 11s - loss: 8.9656 - accuracy10: 0.6758 - accuracy20: 0.6360 - accuracy30: 0.6091 - accuracy50: 0.5924 - val_loss: 13.0529 - val_accuracy10: 0.6576 - val_accuracy20: 0.6186 - val_accuracy30: 0.5916 - val_accuracy50: 0.5698 - 11s/epoch - 21ms/step
Epoch 16/50
529/529 - 11s - loss: 8.8707 - accuracy10: 0.6748 - accuracy20: 0.6368 - accuracy30: 0.6105 - accuracy50: 0.5933 - val_loss: 12.8982 - val_accuracy10: 0.6442 - val_accuracy20: 0.6130 - val_accuracy30: 0.5884 - val_accuracy50: 0.5682 - 11s/epoch - 22ms/step
Epoch 17/50
529/529 - 12s - loss: 8.8494 - accuracy10: 0.6724 - accuracy20: 0.6341 - accuracy30: 0.6074 - accuracy50: 0.5918 - val_loss: 12.7619 - val_accuracy10: 0.6050 - val_accuracy20: 0.5720 - val_accuracy30: 0.5469 - val_accuracy50: 0.5320 - 12s/epoch - 22ms/step
Epoch 18/50
529/529 - 11s - loss: 8.7847 - accuracy10: 0.6795 - accuracy20: 0.6407 - accuracy30: 0.6125 - accuracy50: 0.5947 - val_loss: 12.7576 - val_accuracy10: 0.6334 - val_accuracy20: 0.6028 - val_accuracy30: 0.5780 - val_accuracy50: 0.5615 - 11s/epoch - 21ms/step
Epoch 19/50
529/529 - 12s - loss: 8.7106 - accuracy10: 0.6817 - accuracy20: 0.6425 - accuracy30: 0.6140 - accuracy50: 0.5968 - val_loss: 12.8914 - val_accuracy10: 0.5985 - val_accuracy20: 0.5720 - val_accuracy30: 0.5529 - val_accuracy50: 0.5383 - 12s/epoch - 22ms/step
Epoch 20/50
529/529 - 12s - loss: 8.6493 - accuracy10: 0.6824 - accuracy20: 0.6410 - accuracy30: 0.6117 - accuracy50: 0.5951 - val_loss: 12.8872 - val_accuracy10: 0.5350 - val_accuracy20: 0.5092 - val_accuracy30: 0.4913 - val_accuracy50: 0.4852 - 12s/epoch - 22ms/step
Epoch 21/50
529/529 - 11s - loss: 8.5752 - accuracy10: 0.6838 - accuracy20: 0.6444 - accuracy30: 0.6161 - accuracy50: 0.5994 - val_loss: 12.7136 - val_accuracy10: 0.6188 - val_accuracy20: 0.5897 - val_accuracy30: 0.5604 - val_accuracy50: 0.5417 - 11s/epoch - 21ms/step
Epoch 22/50
529/529 - 12s - loss: 8.5433 - accuracy10: 0.6849 - accuracy20: 0.6456 - accuracy30: 0.6164 - accuracy50: 0.5999 - val_loss: 12.7585 - val_accuracy10: 0.5497 - val_accuracy20: 0.5213 - val_accuracy30: 0.4981 - val_accuracy50: 0.4937 - 12s/epoch - 22ms/step
Epoch 23/50
529/529 - 12s - loss: 8.5194 - accuracy10: 0.6837 - accuracy20: 0.6456 - accuracy30: 0.6164 - accuracy50: 0.5992 - val_loss: 12.7872 - val_accuracy10: 0.5853 - val_accuracy20: 0.5686 - val_accuracy30: 0.5480 - val_accuracy50: 0.5386 - 12s/epoch - 22ms/step
testing model: results/QRTEA/W10/deepLOB_L1/seq2seq
Evaluating performance on  test set...
1840/1840 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5847311
{'0': {'precision': 0.37189259203905745, 'recall': 0.18526791254063982, 'f1-score': 0.2473246529503363, 'support': 40293}, '1': {'precision': 0.8686147912978001, 'recall': 0.8748036842037841, 'f1-score': 0.8716982528966277, 'support': 390315}, '2': {'precision': 0.29066749714522994, 'recall': 0.4162640303278079, 'f1-score': 0.3423087502674287, 'support': 40359}, 'accuracy': 0.7765172506778607, 'macro avg': {'precision': 0.5103916268273624, 'recall': 0.4921118756907439, 'f1-score': 0.4871105520381309, 'support': 470967}, 'weighted avg': {'precision': 0.7765917781791821, 'recall': 0.7765172506778607, 'f1-score': 0.7729152884867057, 'support': 470967}}
[[  7465  29587   3241]
 [ 11109 341449  37757]
 [  1499  22060  16800]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.67417353
{'0': {'precision': 0.4487324272752054, 'recall': 0.20709176521332806, 'f1-score': 0.28339543291400743, 'support': 55642}, '1': {'precision': 0.8184332787281468, 'recall': 0.8469343234057454, 'f1-score': 0.8324399181108126, 'support': 359839}, '2': {'precision': 0.33979264379165636, 'recall': 0.44654507443319036, 'f1-score': 0.38592255692969063, 'support': 55486}, 'accuracy': 0.7241696339658618, 'macro avg': {'precision': 0.5356527832650028, 'recall': 0.5001903876840879, 'f1-score': 0.5005859693181702, 'support': 470967}, 'weighted avg': {'precision': 0.7183652292753598, 'recall': 0.7241696339658618, 'f1-score': 0.7149680027795551, 'support': 470967}}
[[ 11523  38848   5271]
 [ 12209 304760  42870]
 [  1947  28762  24777]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7384392
{'0': {'precision': 0.483257477243173, 'recall': 0.22078481463878327, 'f1-score': 0.3030951798385124, 'support': 67328}, '1': {'precision': 0.7767577723303373, 'recall': 0.8305394008374368, 'f1-score': 0.8027487954272912, 'support': 336503}, '2': {'precision': 0.36906908774329955, 'recall': 0.44201322688274547, 'f1-score': 0.4022610664154371, 'support': 67136}, 'accuracy': 0.6879866317597624, 'macro avg': {'precision': 0.5430281124389366, 'recall': 0.4977791474529885, 'f1-score': 0.5027016805604135, 'support': 470967}, 'weighted avg': {'precision': 0.6766841463733935, 'recall': 0.6879866317597624, 'f1-score': 0.6742306130380767, 'support': 470967}}
[[ 14865  45367   7096]
 [ 13390 279479  43634]
 [  2505  34956  29675]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8211862
{'0': {'precision': 0.5207098922182721, 'recall': 0.21449824496152864, 'f1-score': 0.303836022390517, 'support': 86038}, '1': {'precision': 0.6978410773461186, 'recall': 0.829802004104793, 'f1-score': 0.7581220136557985, 'support': 298188}, '2': {'precision': 0.423088326127239, 'recall': 0.39484211618496445, 'f1-score': 0.4084774973015845, 'support': 86741}, 'accuracy': 0.6372866888762907, 'macro avg': {'precision': 0.5472130985638765, 'recall': 0.47971412175042866, 'f1-score': 0.49014517778263333, 'support': 470967}, 'weighted avg': {'precision': 0.6148791260851884, 'recall': 0.6372866888762907, 'f1-score': 0.6107350988410383, 'support': 470967}}
[[ 18455  58493   9090]
 [ 13140 247437  37611]
 [  3847  48645  34249]]
Evaluating performance on  train set...
529/529 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7151011
{'0': {'precision': 0.1949389319070807, 'recall': 0.6343680997532147, 'f1-score': 0.29823222300247304, 'support': 7699}, '1': {'precision': 0.9530422366542306, 'recall': 0.690654806111635, 'f1-score': 0.8009057436339093, 'support': 119837}, '2': {'precision': 0.20716504276049866, 'recall': 0.6190718372536554, 'f1-score': 0.31044376434583015, 'support': 7865}, 'accuracy': 0.6832962828930362, 'macro avg': {'precision': 0.45171540377393665, 'recall': 0.6480315810395018, 'f1-score': 0.46986057699407086, 'support': 135401}, 'weighted avg': {'precision': 0.866610367811146, 'recall': 0.6832962828930362, 'f1-score': 0.7438340314424028, 'support': 135401}}
[[ 4884  1989   826]
 [19263 82766 17808]
 [  907  2089  4869]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7681881
{'0': {'precision': 0.24665692363902084, 'recall': 0.6353284396762657, 'f1-score': 0.3553531950731656, 'support': 10626}, '1': {'precision': 0.9281677682498342, 'recall': 0.6634497172362921, 'f1-score': 0.7737947704251461, 'support': 113876}, '2': {'precision': 0.25584800811023917, 'recall': 0.6251949720157812, 'f1-score': 0.363103485026111, 'support': 10899}, 'accuracy': 0.658163529072902, 'macro avg': {'precision': 0.4768908999996981, 'recall': 0.6413243763094464, 'f1-score': 0.49741715017480753, 'support': 135401}, 'weighted avg': {'precision': 0.8205662933671085, 'recall': 0.658163529072902, 'f1-score': 0.7078980303770355, 'support': 135401}}
[[ 6751  2922   953]
 [19459 75551 18866]
 [ 1160  2925  6814]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7995702
{'0': {'precision': 0.2812293801007119, 'recall': 0.6232586777495575, 'f1-score': 0.38757538049200724, 'support': 12993}, '1': {'precision': 0.903029916438094, 'recall': 0.6489777207298065, 'f1-score': 0.755210583873463, 'support': 109070}, '2': {'precision': 0.29045746075617446, 'recall': 0.6145599040335883, 'f1-score': 0.3944753242378305, 'support': 13338}, 'accuracy': 0.6431193270359894, 'macro avg': {'precision': 0.49157225243166014, 'recall': 0.6289321008376508, 'f1-score': 0.5124204295344336, 'support': 135401}, 'weighted avg': {'precision': 0.783019386364335, 'recall': 0.6431193270359894, 'f1-score': 0.684397435591284, 'support': 135401}}
[[ 8098  3827  1068]
 [19330 70784 18956]
 [ 1367  3774  8197]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8276813
{'0': {'precision': 0.33306503001643356, 'recall': 0.5755766778717979, 'f1-score': 0.42195831828514374, 'support': 17254}, '1': {'precision': 0.8481532324906755, 'recall': 0.6519696170272073, 'f1-score': 0.7372331383993651, 'support': 100451}, '2': {'precision': 0.34923152848279754, 'recall': 0.5598440325497287, 'f1-score': 0.4301406738450851, 'support': 17696}, 'accuracy': 0.6301947548393291, 'macro avg': {'precision': 0.5101499303299689, 'recall': 0.5957967758162447, 'f1-score': 0.5297773768431979, 'support': 135401}, 'weighted avg': {'precision': 0.7173104003135573, 'recall': 0.6301947548393291, 'f1-score': 0.6569230963834028, 'support': 135401}}
[[ 9931  5848  1475]
 [17974 65491 16986]
 [ 1912  5877  9907]]
Evaluating performance on  val set...
208/208 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.75689924
{'0': {'precision': 0.2069850202764214, 'recall': 0.6511325175735485, 'f1-score': 0.31411705601607637, 'support': 3841}, '1': {'precision': 0.9275872353116612, 'recall': 0.6873218271419416, 'f1-score': 0.7895812442086291, 'support': 45251}, '2': {'precision': 0.26750569018610254, 'recall': 0.5007518796992482, 'f1-score': 0.348721528929226, 'support': 3990}, 'accuracy': 0.670679326325308, 'macro avg': {'precision': 0.46735931525806174, 'recall': 0.6130687414715794, 'f1-score': 0.4841399430513105, 'support': 53082}, 'weighted avg': {'precision': 0.8258284757886339, 'recall': 0.670679326325308, 'f1-score': 0.7220387964709323, 'support': 53082}}
[[ 2501  1061   279]
 [ 8957 31102  5192]
 [  625  1367  1998]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.81461245
{'0': {'precision': 0.26472594951103023, 'recall': 0.6536877573942343, 'f1-score': 0.3768413100955053, 'support': 5342}, '1': {'precision': 0.8943503378047586, 'recall': 0.6497522111303441, 'f1-score': 0.7526781299785749, 'support': 42173}, '2': {'precision': 0.3138780804150454, 'recall': 0.5216454104544638, 'f1-score': 0.3919292799784061, 'support': 5567}, 'accuracy': 0.6367130100599073, 'macro avg': {'precision': 0.4909847892436114, 'recall': 0.608361792993014, 'f1-score': 0.5071495733508288, 'support': 53082}, 'weighted avg': {'precision': 0.770109681100911, 'recall': 0.6367130100599073, 'f1-score': 0.6770214263923064, 'support': 53082}}
[[ 3492  1462   388]
 [ 8811 27402  5960]
 [  888  1775  2904]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.85032827
{'0': {'precision': 0.3033459370764072, 'recall': 0.6536510376633359, 'f1-score': 0.4143845629080986, 'support': 6505}, '1': {'precision': 0.8629310344827587, 'recall': 0.629037528592615, 'f1-score': 0.7276507276507277, 'support': 39783}, '2': {'precision': 0.34674615002483855, 'recall': 0.5136885487194583, 'f1-score': 0.41402218399667834, 'support': 6794}, 'accuracy': 0.617290230209864, 'macro avg': {'precision': 0.5043410405280014, 'recall': 0.5987923716584698, 'f1-score': 0.5186858248518349, 'support': 53082}, 'weighted avg': {'precision': 0.728289137726129, 'recall': 0.617290230209864, 'f1-score': 0.6491196111284335, 'support': 53082}}
[[ 4252  1792   461]
 [ 8644 25025  6114]
 [ 1121  2183  3490]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8818006
{'0': {'precision': 0.36325520654340504, 'recall': 0.6182009591765119, 'f1-score': 0.4576153779548013, 'support': 8549}, '1': {'precision': 0.7975678533662319, 'recall': 0.6338450333352008, 'f1-score': 0.7063432602859462, 'support': 35698}, '2': {'precision': 0.4022434320574633, 'recall': 0.4627051499717035, 'f1-score': 0.4303610906411201, 'support': 8835}, 'accuracy': 0.6028408876832071, 'macro avg': {'precision': 0.5210221639890334, 'recall': 0.5715837141611387, 'f1-score': 0.5314399096272892, 'support': 53082}, 'weighted avg': {'precision': 0.6618225898126485, 'recall': 0.6028408876832071, 'f1-score': 0.6203503222869824, 'support': 53082}}
[[ 5285  2610   654]
 [ 7650 22627  5421]
 [ 1614  3133  4088]]
training model: results/QRTEA/W10/deepOF_L1/seq2seq
Epoch 1/50
529/529 - 18s - loss: 11.5234 - accuracy10: 0.4208 - accuracy20: 0.4234 - accuracy30: 0.4228 - accuracy50: 0.4259 - val_loss: 15.4418 - val_accuracy10: 0.7306 - val_accuracy20: 0.6988 - val_accuracy30: 0.6722 - val_accuracy50: 0.6224 - 18s/epoch - 34ms/step
Epoch 2/50
529/529 - 11s - loss: 11.0112 - accuracy10: 0.4934 - accuracy20: 0.4764 - accuracy30: 0.4588 - accuracy50: 0.4511 - val_loss: 14.1382 - val_accuracy10: 0.6877 - val_accuracy20: 0.6653 - val_accuracy30: 0.6423 - val_accuracy50: 0.6029 - 11s/epoch - 21ms/step
Epoch 3/50
529/529 - 11s - loss: 10.7529 - accuracy10: 0.5547 - accuracy20: 0.5370 - accuracy30: 0.5168 - accuracy50: 0.5010 - val_loss: 13.5606 - val_accuracy10: 0.6750 - val_accuracy20: 0.6634 - val_accuracy30: 0.6473 - val_accuracy50: 0.6134 - 11s/epoch - 20ms/step
Epoch 4/50
529/529 - 11s - loss: 10.6122 - accuracy10: 0.5710 - accuracy20: 0.5489 - accuracy30: 0.5278 - accuracy50: 0.5131 - val_loss: 13.3179 - val_accuracy10: 0.6613 - val_accuracy20: 0.6440 - val_accuracy30: 0.6264 - val_accuracy50: 0.5949 - 11s/epoch - 20ms/step
Epoch 5/50
529/529 - 11s - loss: 10.4997 - accuracy10: 0.5855 - accuracy20: 0.5591 - accuracy30: 0.5336 - accuracy50: 0.5156 - val_loss: 12.9452 - val_accuracy10: 0.6298 - val_accuracy20: 0.6168 - val_accuracy30: 0.6019 - val_accuracy50: 0.5779 - 11s/epoch - 20ms/step
Epoch 6/50
529/529 - 12s - loss: 10.4204 - accuracy10: 0.5872 - accuracy20: 0.5618 - accuracy30: 0.5396 - accuracy50: 0.5242 - val_loss: 13.0328 - val_accuracy10: 0.6460 - val_accuracy20: 0.6282 - val_accuracy30: 0.6112 - val_accuracy50: 0.5863 - 12s/epoch - 22ms/step
Epoch 7/50
529/529 - 11s - loss: 10.2573 - accuracy10: 0.6003 - accuracy20: 0.5712 - accuracy30: 0.5475 - accuracy50: 0.5316 - val_loss: 12.9000 - val_accuracy10: 0.6549 - val_accuracy20: 0.6291 - val_accuracy30: 0.6090 - val_accuracy50: 0.5845 - 11s/epoch - 21ms/step
Epoch 8/50
529/529 - 10s - loss: 10.2010 - accuracy10: 0.6059 - accuracy20: 0.5754 - accuracy30: 0.5540 - accuracy50: 0.5395 - val_loss: 12.8321 - val_accuracy10: 0.6514 - val_accuracy20: 0.6309 - val_accuracy30: 0.6126 - val_accuracy50: 0.5877 - 10s/epoch - 19ms/step
Epoch 9/50
529/529 - 11s - loss: 10.0665 - accuracy10: 0.6185 - accuracy20: 0.5858 - accuracy30: 0.5611 - accuracy50: 0.5460 - val_loss: 12.8315 - val_accuracy10: 0.6529 - val_accuracy20: 0.6259 - val_accuracy30: 0.6053 - val_accuracy50: 0.5823 - 11s/epoch - 20ms/step
Epoch 10/50
529/529 - 10s - loss: 9.9806 - accuracy10: 0.6182 - accuracy20: 0.5864 - accuracy30: 0.5637 - accuracy50: 0.5513 - val_loss: 12.9246 - val_accuracy10: 0.6579 - val_accuracy20: 0.6290 - val_accuracy30: 0.6053 - val_accuracy50: 0.5807 - 10s/epoch - 19ms/step
Epoch 11/50
529/529 - 11s - loss: 9.8805 - accuracy10: 0.6281 - accuracy20: 0.5946 - accuracy30: 0.5699 - accuracy50: 0.5556 - val_loss: 12.8498 - val_accuracy10: 0.6308 - val_accuracy20: 0.6090 - val_accuracy30: 0.5959 - val_accuracy50: 0.5792 - 11s/epoch - 21ms/step
Epoch 12/50
529/529 - 11s - loss: 9.7865 - accuracy10: 0.6310 - accuracy20: 0.5950 - accuracy30: 0.5703 - accuracy50: 0.5558 - val_loss: 12.7545 - val_accuracy10: 0.6547 - val_accuracy20: 0.6283 - val_accuracy30: 0.6090 - val_accuracy50: 0.5861 - 11s/epoch - 21ms/step
Epoch 13/50
529/529 - 11s - loss: 9.7261 - accuracy10: 0.6315 - accuracy20: 0.5937 - accuracy30: 0.5691 - accuracy50: 0.5563 - val_loss: 12.6597 - val_accuracy10: 0.6499 - val_accuracy20: 0.6262 - val_accuracy30: 0.6117 - val_accuracy50: 0.5916 - 11s/epoch - 20ms/step
Epoch 14/50
529/529 - 10s - loss: 9.6114 - accuracy10: 0.6371 - accuracy20: 0.6006 - accuracy30: 0.5755 - accuracy50: 0.5617 - val_loss: 12.7720 - val_accuracy10: 0.6825 - val_accuracy20: 0.6509 - val_accuracy30: 0.6278 - val_accuracy50: 0.5986 - 10s/epoch - 19ms/step
Epoch 15/50
529/529 - 11s - loss: 9.5360 - accuracy10: 0.6386 - accuracy20: 0.6013 - accuracy30: 0.5760 - accuracy50: 0.5638 - val_loss: 13.0863 - val_accuracy10: 0.7185 - val_accuracy20: 0.6838 - val_accuracy30: 0.6572 - val_accuracy50: 0.6242 - 11s/epoch - 20ms/step
Epoch 16/50
529/529 - 10s - loss: 9.4845 - accuracy10: 0.6430 - accuracy20: 0.6031 - accuracy30: 0.5766 - accuracy50: 0.5632 - val_loss: 12.8043 - val_accuracy10: 0.6669 - val_accuracy20: 0.6327 - val_accuracy30: 0.6114 - val_accuracy50: 0.5896 - 10s/epoch - 20ms/step
Epoch 17/50
529/529 - 10s - loss: 9.4172 - accuracy10: 0.6429 - accuracy20: 0.6035 - accuracy30: 0.5782 - accuracy50: 0.5652 - val_loss: 12.9101 - val_accuracy10: 0.6899 - val_accuracy20: 0.6530 - val_accuracy30: 0.6273 - val_accuracy50: 0.6015 - 10s/epoch - 19ms/step
Epoch 18/50
529/529 - 10s - loss: 9.3342 - accuracy10: 0.6463 - accuracy20: 0.6087 - accuracy30: 0.5817 - accuracy50: 0.5679 - val_loss: 12.8157 - val_accuracy10: 0.6662 - val_accuracy20: 0.6380 - val_accuracy30: 0.6172 - val_accuracy50: 0.5951 - 10s/epoch - 19ms/step
Epoch 19/50
529/529 - 10s - loss: 9.2889 - accuracy10: 0.6454 - accuracy20: 0.6074 - accuracy30: 0.5821 - accuracy50: 0.5687 - val_loss: 12.7671 - val_accuracy10: 0.6662 - val_accuracy20: 0.6388 - val_accuracy30: 0.6203 - val_accuracy50: 0.5992 - 10s/epoch - 20ms/step
Epoch 20/50
529/529 - 10s - loss: 9.2150 - accuracy10: 0.6506 - accuracy20: 0.6119 - accuracy30: 0.5866 - accuracy50: 0.5746 - val_loss: 12.8350 - val_accuracy10: 0.6169 - val_accuracy20: 0.5861 - val_accuracy30: 0.5691 - val_accuracy50: 0.5574 - 10s/epoch - 19ms/step
Epoch 21/50
529/529 - 11s - loss: 9.1858 - accuracy10: 0.6489 - accuracy20: 0.6111 - accuracy30: 0.5853 - accuracy50: 0.5717 - val_loss: 12.8990 - val_accuracy10: 0.6377 - val_accuracy20: 0.6076 - val_accuracy30: 0.5914 - val_accuracy50: 0.5753 - 11s/epoch - 20ms/step
Epoch 22/50
529/529 - 10s - loss: 9.1057 - accuracy10: 0.6541 - accuracy20: 0.6192 - accuracy30: 0.5937 - accuracy50: 0.5784 - val_loss: 12.8700 - val_accuracy10: 0.6381 - val_accuracy20: 0.6089 - val_accuracy30: 0.5921 - val_accuracy50: 0.5745 - 10s/epoch - 20ms/step
Epoch 23/50
529/529 - 11s - loss: 9.0107 - accuracy10: 0.6531 - accuracy20: 0.6178 - accuracy30: 0.5913 - accuracy50: 0.5770 - val_loss: 12.8741 - val_accuracy10: 0.6344 - val_accuracy20: 0.6066 - val_accuracy30: 0.5877 - val_accuracy50: 0.5698 - 11s/epoch - 20ms/step
testing model: results/QRTEA/W10/deepOF_L1/seq2seq
Evaluating performance on  test set...
1840/1840 - 16s - 16s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.80267143
{'0': {'precision': 0.2655801319363601, 'recall': 0.5095674186583278, 'f1-score': 0.34917476594984825, 'support': 40293}, '1': {'precision': 0.8978628054857231, 'recall': 0.715558322572711, 'f1-score': 0.7964110446067291, 'support': 390312}, '2': {'precision': 0.24747548129313476, 'recall': 0.5064548901058057, 'f1-score': 0.3324847291922536, 'support': 40357}, 'accuracy': 0.6800166467782963, 'macro avg': {'precision': 0.47030613957173933, 'recall': 0.5771935437789482, 'f1-score': 0.4926901799162769, 'support': 470962}, 'weighted avg': {'precision': 0.7880360105261196, 'recall': 0.6800166467782963, 'f1-score': 0.7183937827318778, 'support': 470962}}
[[ 20532  16157   3604]
 [ 52474 279291  58547]
 [  4304  15614  20439]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.85435337
{'0': {'precision': 0.3212601330704212, 'recall': 0.5007189072609634, 'f1-score': 0.39139932987264775, 'support': 55640}, '1': {'precision': 0.8460297031725603, 'recall': 0.6905440781685092, 'f1-score': 0.7604201094341009, 'support': 359838}, '2': {'precision': 0.30719611200088365, 'recall': 0.5012616249729652, 'f1-score': 0.38093672741218615, 'support': 55484}, 'accuracy': 0.6458185586098242, 'macro avg': {'precision': 0.49149531608128844, 'recall': 0.5641748701341459, 'f1-score': 0.510918722239645, 'support': 470962}, 'weighted avg': {'precision': 0.7205528667121828, 'recall': 0.6458185586098242, 'f1-score': 0.6721166536501879, 'support': 470962}}
[[ 27860  22880   4900]
 [ 53531 248484  57823]
 [  5330  22342  27812]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8854873
{'0': {'precision': 0.3531504708813717, 'recall': 0.4968288154474564, 'f1-score': 0.41284613153461164, 'support': 67325}, '1': {'precision': 0.8009983995930091, 'recall': 0.6737681387684508, 'f1-score': 0.7318950990709475, 'support': 336503}, '2': {'precision': 0.3498224115545159, 'recall': 0.4856108678166056, 'f1-score': 0.40668134500115394, 'support': 67134}, 'accuracy': 0.6216531270038772, 'macro avg': {'precision': 0.5013237606762989, 'recall': 0.5520692740108376, 'f1-score': 0.517140858535571, 'support': 470962}, 'weighted avg': {'precision': 0.6726640316790644, 'recall': 0.6216531270038772, 'f1-score': 0.6399282909099805, 'support': 470962}}
[[ 33449  28208   5668]
 [ 54854 226725  54924]
 [  6413  28120  32601]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9200026
{'0': {'precision': 0.40274556071028633, 'recall': 0.4681931771953275, 'f1-score': 0.433010303626425, 'support': 86035}, '1': {'precision': 0.716134768937316, 'recall': 0.6698313474430475, 'f1-score': 0.6922095880393836, 'support': 298187}, '2': {'precision': 0.41242299460011517, 'recall': 0.4376181692414111, 'f1-score': 0.4246471901062205, 'support': 86740}, 'accuracy': 0.5902280863424225, 'macro avg': {'precision': 0.5104344414159059, 'recall': 0.5252142312932621, 'f1-score': 0.5166223605906765, 'support': 470962}, 'weighted avg': {'precision': 0.6029485674267455, 'recall': 0.5902280863424225, 'f1-score': 0.5955806183322917, 'support': 470962}}
[[ 40281  38777   6977]
 [ 51349 199735  47103]
 [  8386  40395  37959]]
Evaluating performance on  train set...
529/529 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7008791
{'0': {'precision': 0.23544051767048282, 'recall': 0.6118225326607166, 'f1-score': 0.340030911901082, 'support': 7731}, '1': {'precision': 0.9534089327208284, 'recall': 0.7430750870047821, 'f1-score': 0.8352031818693483, 'support': 119821}, '2': {'precision': 0.2200529148800292, 'recall': 0.6147572320632089, 'f1-score': 0.3240955356243072, 'support': 7847}, 'accuracy': 0.7281442255851225, 'macro avg': {'precision': 0.46963412175711344, 'recall': 0.6565516172429026, 'f1-score': 0.4997765431315791, 'support': 135399}, 'weighted avg': {'precision': 0.8699130539569456, 'recall': 0.7281442255851225, 'f1-score': 0.7773088213555371, 'support': 135399}}
[[ 4730  2155   846]
 [14533 89036 16252]
 [  827  2196  4824]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7445925
{'0': {'precision': 0.28532369024519316, 'recall': 0.6066004125257829, 'f1-score': 0.38809909423549876, 'support': 10666}, '1': {'precision': 0.924137465701048, 'recall': 0.7218601219233675, 'f1-score': 0.8105698193977294, 'support': 113842}, '2': {'precision': 0.2758939451237447, 'recall': 0.6028831144982095, 'f1-score': 0.37855289708849815, 'support': 10891}, 'accuracy': 0.7032105111559169, 'macro avg': {'precision': 0.4951183670233286, 'recall': 0.6437812163157867, 'f1-score': 0.5257406035739088, 'support': 135399}, 'weighted avg': {'precision': 0.8216728395840195, 'recall': 0.7032105111559169, 'f1-score': 0.7425400034061034, 'support': 135399}}
[[ 6470  3314   882]
 [15313 82178 16351]
 [  893  3432  6566]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.77717453
{'0': {'precision': 0.31240645604951256, 'recall': 0.5932099239572932, 'f1-score': 0.4092739798622152, 'support': 13019}, '1': {'precision': 0.89498108917094, 'recall': 0.7074716385880281, 'f1-score': 0.7902557456987291, 'support': 109039}, '2': {'precision': 0.3167783041986604, 'recall': 0.5813657147140394, 'f1-score': 0.41009914077990745, 'support': 13341}, 'accuracy': 0.684059705019978, 'macro avg': {'precision': 0.5080552831397043, 'recall': 0.627349092419787, 'f1-score': 0.5365429554469506, 'support': 135399}, 'weighted avg': {'precision': 0.7819939732917751, 'recall': 0.684059705019978, 'f1-score': 0.7161660487611774, 'support': 135399}}
[[ 7723  4425   871]
 [16040 77142 15857]
 [  958  4627  7756]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8090531
{'0': {'precision': 0.358974358974359, 'recall': 0.5427612544844347, 'f1-score': 0.4321385791946927, 'support': 17282}, '1': {'precision': 0.8340547661616637, 'recall': 0.7061354153181234, 'f1-score': 0.7647829674329812, 'support': 100417}, '2': {'precision': 0.3801179235558488, 'recall': 0.5208474576271186, 'f1-score': 0.4394918122661073, 'support': 17700}, 'accuracy': 0.6610610122674466, 'macro avg': {'precision': 0.5243823495639571, 'recall': 0.5899147091432256, 'f1-score': 0.5454711196312604, 'support': 135399}, 'weighted avg': {'precision': 0.7140758762796563, 'recall': 0.6610610122674466, 'f1-score': 0.6798014405089435, 'support': 135399}}
[[ 9380  6869  1033]
 [15508 70908 14001]
 [ 1242  7239  9219]]
Evaluating performance on  val set...
208/208 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8219135
{'0': {'precision': 0.22341661824520628, 'recall': 0.5958161157024794, 'f1-score': 0.3249753486406536, 'support': 3872}, '1': {'precision': 0.9261114395047133, 'recall': 0.6583364663732667, 'f1-score': 0.7695966907962771, 'support': 45217}, '2': {'precision': 0.22246301705455573, 'recall': 0.5912847483095417, 'f1-score': 0.3232917978912776, 'support': 3993}, 'accuracy': 0.6487321502580913, 'macro avg': {'precision': 0.4573303582681585, 'recall': 0.615145776795096, 'f1-score': 0.4726212791094027, 'support': 53082}, 'weighted avg': {'precision': 0.8219235321394993, 'recall': 0.6487321502580913, 'f1-score': 0.703591844064876, 'support': 53082}}
[[ 2307  1161   404]
 [ 7601 29768  7848]
 [  418  1214  2361]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.85597277
{'0': {'precision': 0.2781102080914531, 'recall': 0.5824915824915825, 'f1-score': 0.3764734328719096, 'support': 5346}, '1': {'precision': 0.8824899914681368, 'recall': 0.6379854340141864, 'f1-score': 0.7405785727071199, 'support': 42153}, '2': {'precision': 0.2843747261414425, 'recall': 0.5812287300734372, 'f1-score': 0.3818994939390373, 'support': 5583}, 'accuracy': 0.6264270374138126, 'macro avg': {'precision': 0.48165830856701075, 'recall': 0.6005685821930687, 'f1-score': 0.4996504998393556, 'support': 53082}, 'weighted avg': {'precision': 0.7587137236513498, 'recall': 0.6264270374138126, 'f1-score': 0.6661840251331543, 'support': 53082}}
[[ 3114  1750   482]
 [ 7576 26893  7684]
 [  507  1831  3245]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8749645
{'0': {'precision': 0.3142375737152485, 'recall': 0.5728766702503456, 'f1-score': 0.4058538708448942, 'support': 6511}, '1': {'precision': 0.841722235385709, 'recall': 0.6253489249339872, 'f1-score': 0.717579500201997, 'support': 39765}, '2': {'precision': 0.32702031022366956, 'recall': 0.5606817513958272, 'f1-score': 0.41309878213802437, 'support': 6806}, 'accuracy': 0.6106213028898685, 'macro avg': {'precision': 0.49432670644154236, 'recall': 0.5863024488600533, 'f1-score': 0.5121773843949718, 'support': 53082}, 'weighted avg': {'precision': 0.7110279522993669, 'recall': 0.6106213028898685, 'f1-score': 0.6403039389969276, 'support': 53082}}
[[ 3730  2247   534]
 [ 7579 24867  7319]
 [  561  2429  3816]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.89766335
{'0': {'precision': 0.37063221192914025, 'recall': 0.5320191298261985, 'f1-score': 0.436898318885004, 'support': 8573}, '1': {'precision': 0.7645206557825923, 'recall': 0.6262476169115173, 'f1-score': 0.6885104415504355, 'support': 35668}, '2': {'precision': 0.38697119127952245, 'recall': 0.505938242280285, 'f1-score': 0.4385294117647059, 'support': 8841}, 'accuracy': 0.5909912964846841, 'macro avg': {'precision': 0.5073746863304184, 'recall': 0.5547349963393337, 'f1-score': 0.5213127240667151, 'support': 53082}, 'weighted avg': {'precision': 0.6380235297355842, 'recall': 0.5909912964846841, 'f1-score': 0.6062386166013685, 'support': 53082}}
[[ 4561  3259   753]
 [ 6998 22337  6333]
 [  747  3621  4473]]
training model: results/QRTEA/W10/deepLOB_L2/seq2seq
Epoch 1/50
529/529 - 31s - loss: 11.2662 - accuracy10: 0.4261 - accuracy20: 0.4194 - accuracy30: 0.4179 - accuracy50: 0.4277 - val_loss: 14.7843 - val_accuracy10: 0.7325 - val_accuracy20: 0.7043 - val_accuracy30: 0.6802 - val_accuracy50: 0.6315 - 31s/epoch - 59ms/step
Epoch 2/50
529/529 - 25s - loss: 10.5138 - accuracy10: 0.4740 - accuracy20: 0.4827 - accuracy30: 0.4909 - accuracy50: 0.5030 - val_loss: 15.2558 - val_accuracy10: 0.5268 - val_accuracy20: 0.5156 - val_accuracy30: 0.5058 - val_accuracy50: 0.4878 - 25s/epoch - 46ms/step
Epoch 3/50
529/529 - 24s - loss: 10.2073 - accuracy10: 0.5126 - accuracy20: 0.5157 - accuracy30: 0.5187 - accuracy50: 0.5262 - val_loss: 14.6433 - val_accuracy10: 0.5718 - val_accuracy20: 0.5472 - val_accuracy30: 0.5296 - val_accuracy50: 0.5083 - 24s/epoch - 46ms/step
Epoch 4/50
529/529 - 24s - loss: 9.8729 - accuracy10: 0.5713 - accuracy20: 0.5622 - accuracy30: 0.5561 - accuracy50: 0.5567 - val_loss: 13.9585 - val_accuracy10: 0.5851 - val_accuracy20: 0.5593 - val_accuracy30: 0.5393 - val_accuracy50: 0.5193 - 24s/epoch - 46ms/step
Epoch 5/50
529/529 - 24s - loss: 9.5411 - accuracy10: 0.6062 - accuracy20: 0.5930 - accuracy30: 0.5814 - accuracy50: 0.5752 - val_loss: 14.3535 - val_accuracy10: 0.6362 - val_accuracy20: 0.5994 - val_accuracy30: 0.5689 - val_accuracy50: 0.5382 - 24s/epoch - 46ms/step
Epoch 6/50
529/529 - 24s - loss: 9.2475 - accuracy10: 0.6307 - accuracy20: 0.6126 - accuracy30: 0.5965 - accuracy50: 0.5871 - val_loss: 14.4528 - val_accuracy10: 0.6248 - val_accuracy20: 0.5943 - val_accuracy30: 0.5679 - val_accuracy50: 0.5401 - 24s/epoch - 46ms/step
Epoch 7/50
529/529 - 24s - loss: 9.0666 - accuracy10: 0.6494 - accuracy20: 0.6268 - accuracy30: 0.6070 - accuracy50: 0.5928 - val_loss: 15.0931 - val_accuracy10: 0.5107 - val_accuracy20: 0.4968 - val_accuracy30: 0.4822 - val_accuracy50: 0.4692 - 24s/epoch - 46ms/step
Epoch 8/50
529/529 - 25s - loss: 8.8501 - accuracy10: 0.6731 - accuracy20: 0.6459 - accuracy30: 0.6209 - accuracy50: 0.6035 - val_loss: 13.6820 - val_accuracy10: 0.6382 - val_accuracy20: 0.6056 - val_accuracy30: 0.5774 - val_accuracy50: 0.5505 - 25s/epoch - 46ms/step
Epoch 9/50
529/529 - 24s - loss: 8.6298 - accuracy10: 0.6848 - accuracy20: 0.6560 - accuracy30: 0.6308 - accuracy50: 0.6115 - val_loss: 13.4378 - val_accuracy10: 0.6537 - val_accuracy20: 0.6204 - val_accuracy30: 0.5890 - val_accuracy50: 0.5588 - 24s/epoch - 46ms/step
Epoch 10/50
529/529 - 24s - loss: 8.4706 - accuracy10: 0.6924 - accuracy20: 0.6632 - accuracy30: 0.6374 - accuracy50: 0.6178 - val_loss: 13.7198 - val_accuracy10: 0.6447 - val_accuracy20: 0.6153 - val_accuracy30: 0.5882 - val_accuracy50: 0.5600 - 24s/epoch - 46ms/step
Epoch 11/50
529/529 - 24s - loss: 8.3133 - accuracy10: 0.6994 - accuracy20: 0.6690 - accuracy30: 0.6419 - accuracy50: 0.6230 - val_loss: 13.7353 - val_accuracy10: 0.6163 - val_accuracy20: 0.5912 - val_accuracy30: 0.5659 - val_accuracy50: 0.5407 - 24s/epoch - 46ms/step
Epoch 12/50
529/529 - 25s - loss: 8.2006 - accuracy10: 0.7033 - accuracy20: 0.6732 - accuracy30: 0.6444 - accuracy50: 0.6231 - val_loss: 13.2962 - val_accuracy10: 0.6349 - val_accuracy20: 0.6073 - val_accuracy30: 0.5809 - val_accuracy50: 0.5567 - 25s/epoch - 46ms/step
Epoch 13/50
529/529 - 25s - loss: 8.0944 - accuracy10: 0.7061 - accuracy20: 0.6761 - accuracy30: 0.6473 - accuracy50: 0.6265 - val_loss: 13.4968 - val_accuracy10: 0.6272 - val_accuracy20: 0.5987 - val_accuracy30: 0.5707 - val_accuracy50: 0.5449 - 25s/epoch - 46ms/step
Epoch 14/50
529/529 - 25s - loss: 7.9325 - accuracy10: 0.7084 - accuracy20: 0.6809 - accuracy30: 0.6537 - accuracy50: 0.6331 - val_loss: 13.7130 - val_accuracy10: 0.5211 - val_accuracy20: 0.5083 - val_accuracy30: 0.4979 - val_accuracy50: 0.4893 - 25s/epoch - 47ms/step
Epoch 15/50
529/529 - 25s - loss: 7.8491 - accuracy10: 0.7133 - accuracy20: 0.6826 - accuracy30: 0.6549 - accuracy50: 0.6349 - val_loss: 14.1720 - val_accuracy10: 0.5225 - val_accuracy20: 0.5093 - val_accuracy30: 0.4951 - val_accuracy50: 0.4831 - 25s/epoch - 47ms/step
Epoch 16/50
529/529 - 25s - loss: 7.7432 - accuracy10: 0.7139 - accuracy20: 0.6846 - accuracy30: 0.6574 - accuracy50: 0.6378 - val_loss: 13.6239 - val_accuracy10: 0.5922 - val_accuracy20: 0.5672 - val_accuracy30: 0.5450 - val_accuracy50: 0.5248 - 25s/epoch - 46ms/step
Epoch 17/50
529/529 - 25s - loss: 7.6034 - accuracy10: 0.7161 - accuracy20: 0.6882 - accuracy30: 0.6605 - accuracy50: 0.6424 - val_loss: 13.6852 - val_accuracy10: 0.5709 - val_accuracy20: 0.5514 - val_accuracy30: 0.5326 - val_accuracy50: 0.5164 - 25s/epoch - 46ms/step
Epoch 18/50
529/529 - 24s - loss: 7.5293 - accuracy10: 0.7184 - accuracy20: 0.6891 - accuracy30: 0.6630 - accuracy50: 0.6443 - val_loss: 13.8941 - val_accuracy10: 0.6041 - val_accuracy20: 0.5773 - val_accuracy30: 0.5514 - val_accuracy50: 0.5272 - 24s/epoch - 46ms/step
Epoch 19/50
529/529 - 24s - loss: 7.4136 - accuracy10: 0.7195 - accuracy20: 0.6924 - accuracy30: 0.6655 - accuracy50: 0.6464 - val_loss: 14.3899 - val_accuracy10: 0.6232 - val_accuracy20: 0.5944 - val_accuracy30: 0.5686 - val_accuracy50: 0.5412 - 24s/epoch - 46ms/step
Epoch 20/50
529/529 - 25s - loss: 7.3455 - accuracy10: 0.7216 - accuracy20: 0.6954 - accuracy30: 0.6682 - accuracy50: 0.6494 - val_loss: 14.5330 - val_accuracy10: 0.5753 - val_accuracy20: 0.5514 - val_accuracy30: 0.5271 - val_accuracy50: 0.5067 - 25s/epoch - 46ms/step
Epoch 21/50
529/529 - 24s - loss: 7.2660 - accuracy10: 0.7211 - accuracy20: 0.6945 - accuracy30: 0.6680 - accuracy50: 0.6487 - val_loss: 14.5778 - val_accuracy10: 0.5937 - val_accuracy20: 0.5728 - val_accuracy30: 0.5502 - val_accuracy50: 0.5300 - 24s/epoch - 46ms/step
Epoch 22/50
529/529 - 25s - loss: 7.1425 - accuracy10: 0.7237 - accuracy20: 0.6982 - accuracy30: 0.6710 - accuracy50: 0.6505 - val_loss: 14.9019 - val_accuracy10: 0.5952 - val_accuracy20: 0.5714 - val_accuracy30: 0.5470 - val_accuracy50: 0.5260 - 25s/epoch - 46ms/step
testing model: results/QRTEA/W10/deepLOB_L2/seq2seq
Evaluating performance on  test set...
1840/1840 - 29s - 29s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5729558
{'0': {'precision': 0.43583938487825713, 'recall': 0.2532201623110714, 'f1-score': 0.3203302827182393, 'support': 40293}, '1': {'precision': 0.8862708360911137, 'recall': 0.8919769929415985, 'f1-score': 0.8891147593734479, 'support': 390315}, '2': {'precision': 0.3195380876683294, 'recall': 0.4333110334745658, 'f1-score': 0.3678276964496046, 'support': 40359}, 'accuracy': 0.798024065380377, 'macro avg': {'precision': 0.5472161028792334, 'recall': 0.5261693962424119, 'f1-score': 0.5257575795137639, 'support': 470967}, 'weighted avg': {'precision': 0.7991691889325766, 'recall': 0.798024065380377, 'f1-score': 0.795781983424365, 'support': 470967}}
[[ 10203  24893   5197]
 [ 10119 348152  32044]
 [  3088  19783  17488]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6710752
{'0': {'precision': 0.5067153284671533, 'recall': 0.24952374105891234, 'f1-score': 0.3343850099949423, 'support': 55642}, '1': {'precision': 0.8371222259026168, 'recall': 0.8779176242708545, 'f1-score': 0.857034728043689, 'support': 359839}, '2': {'precision': 0.3755740875030215, 'recall': 0.448040947265977, 'f1-score': 0.4086194710629695, 'support': 55486}, 'accuracy': 0.7530315287482987, 'macro avg': {'precision': 0.5731372139575972, 'recall': 0.5251607708652479, 'f1-score': 0.5333464030338669, 'support': 470967}, 'weighted avg': {'precision': 0.7437102446080803, 'recall': 0.7530315287482987, 'f1-score': 0.7424576036156493, 'support': 470967}}
[[ 13884  34186   7572]
 [ 10170 315909  33760]
 [  3346  27280  24860]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.74951863
{'0': {'precision': 0.5305560950346345, 'recall': 0.24344997623574144, 'f1-score': 0.33375414876504245, 'support': 67328}, '1': {'precision': 0.7962263111502864, 'recall': 0.859017601626137, 'f1-score': 0.8264309699332278, 'support': 336503}, '2': {'precision': 0.39671309698440926, 'recall': 0.4551954242135367, 'f1-score': 0.4239468956571801, 'support': 67136}, 'accuracy': 0.7134533842073861, 'macro avg': {'precision': 0.5744985010564434, 'recall': 0.5192210006918051, 'f1-score': 0.5280440047851501, 'support': 470967}, 'weighted avg': {'precision': 0.7012965953594245, 'recall': 0.7134533842073861, 'f1-score': 0.6986255911567778, 'support': 470967}}
[[ 16391  41016   9921]
 [ 10889 289062  36552]
 [  3614  32962  30560]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8623535
{'0': {'precision': 0.5536519386834986, 'recall': 0.22122782956368117, 'f1-score': 0.3161347650248719, 'support': 86038}, '1': {'precision': 0.7203177603719008, 'recall': 0.845962949548607, 'f1-score': 0.7781008005996402, 'support': 298188}, '2': {'precision': 0.43431303321101555, 'recall': 0.43254055175753103, 'f1-score': 0.43342498036135113, 'support': 86741}, 'accuracy': 0.6556913754042215, 'macro avg': {'precision': 0.5694275774221383, 'recall': 0.4999104436232731, 'f1-score': 0.5092201819952877, 'support': 470967}, 'weighted avg': {'precision': 0.6371953122914852, 'recall': 0.6556913754042215, 'f1-score': 0.6302259832725847, 'support': 470967}}
[[ 19034  53253  13751]
 [ 10815 252256  35117]
 [  4530  44692  37519]]
Evaluating performance on  train set...
529/529 - 9s - 9s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.59670293
{'0': {'precision': 0.30324348341232227, 'recall': 0.5318872580854657, 'f1-score': 0.38626609442060084, 'support': 7699}, '1': {'precision': 0.9512570814208328, 'recall': 0.7678513313918072, 'f1-score': 0.8497707428117597, 'support': 119837}, '2': {'precision': 0.20067554142658453, 'recall': 0.642085187539733, 'f1-score': 0.30578262185891614, 'support': 7865}, 'accuracy': 0.7471288986048847, 'macro avg': {'precision': 0.4850587020865799, 'recall': 0.6472745923390019, 'f1-score': 0.5139398196970922, 'support': 135401}, 'weighted avg': {'precision': 0.8708117338744905, 'recall': 0.7471288986048847, 'f1-score': 0.7918170433615515, 'support': 135401}}
[[ 4095  2622   982]
 [ 8687 92017 19133]
 [  722  2093  5050]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6528752
{'0': {'precision': 0.3592806596117639, 'recall': 0.520798042537173, 'f1-score': 0.4252180260478697, 'support': 10626}, '1': {'precision': 0.9242066614214529, 'recall': 0.7427025887807791, 'f1-score': 0.8235729448653281, 'support': 113876}, '2': {'precision': 0.24745489012146318, 'recall': 0.6467565831727682, 'f1-score': 0.35795353561000387, 'support': 10899}, 'accuracy': 0.7175648628887527, 'macro avg': {'precision': 0.5103140703848934, 'recall': 0.6367524048302401, 'f1-score': 0.5355815021744005, 'support': 135401}, 'weighted avg': {'precision': 0.8253977807586194, 'recall': 0.7175648628887527, 'f1-score': 0.754831168151507, 'support': 135401}}
[[ 5534  3863  1229]
 [ 9092 84576 20208]
 [  777  3073  7049]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.70633227
{'0': {'precision': 0.39068586943690237, 'recall': 0.5094281536211807, 'f1-score': 0.44222482044429595, 'support': 12993}, '1': {'precision': 0.899112354505578, 'recall': 0.7160172366370221, 'f1-score': 0.7971867360115144, 'support': 109070}, '2': {'precision': 0.2735126582278481, 'recall': 0.6479982006297795, 'f1-score': 0.38466331389914993, 'support': 13338}, 'accuracy': 0.6894926920776066, 'macro avg': {'precision': 0.5211036273901094, 'recall': 0.6244811969626608, 'f1-score': 0.5413582901183202, 'support': 135401}, 'weighted avg': {'precision': 0.7886978518841079, 'recall': 0.6894926920776066, 'f1-score': 0.7224881918862893, 'support': 135401}}
[[ 6619  4881  1493]
 [ 9510 78096 21464]
 [  813  3882  8643]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7711633
{'0': {'precision': 0.4357649387059535, 'recall': 0.45942969746145823, 'f1-score': 0.4472845253209198, 'support': 17254}, '1': {'precision': 0.8452095266807356, 'recall': 0.6977431782660203, 'f1-score': 0.7644293691649945, 'support': 100451}, '2': {'precision': 0.31725244275922415, 'recall': 0.6146586799276673, 'f1-score': 0.4184990669667763, 'support': 17696}, 'accuracy': 0.6565165693015561, 'macro avg': {'precision': 0.5327423027153043, 'recall': 0.5906105185517153, 'f1-score': 0.5434043204842302, 'support': 135401}, 'weighted avg': {'precision': 0.7240340148455796, 'recall': 0.6565165693015561, 'f1-score': 0.6788051879301045, 'support': 135401}}
[[ 7927  7024  2303]
 [ 9257 70089 21105]
 [ 1007  5812 10877]]
Evaluating performance on  val set...
208/208 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7990593
{'0': {'precision': 0.2552347912278528, 'recall': 0.5363186670137985, 'f1-score': 0.34586971121558097, 'support': 3841}, '1': {'precision': 0.9236091365747322, 'recall': 0.6460630704293828, 'f1-score': 0.7602985540414023, 'support': 45251}, '2': {'precision': 0.17727204671357988, 'recall': 0.593483709273183, 'f1-score': 0.2729997694258704, 'support': 3990}, 'accuracy': 0.6341697750649938, 'macro avg': {'precision': 0.452038658172055, 'recall': 0.5919551489054548, 'f1-score': 0.45972267822761786, 'support': 53082}, 'weighted avg': {'precision': 0.8191460257457626, 'recall': 0.6341697750649938, 'f1-score': 0.6936819356790582, 'support': 53082}}
[[ 2060  1257   524]
 [ 5550 29235 10466]
 [  461  1161  2368]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.84963065
{'0': {'precision': 0.3189408921116238, 'recall': 0.5434294271808312, 'f1-score': 0.4019662143450568, 'support': 5342}, '1': {'precision': 0.8846415685206617, 'recall': 0.6162473620562919, 'f1-score': 0.7264468700647091, 'support': 42173}, '2': {'precision': 0.22818791946308725, 'recall': 0.5985270343093227, 'f1-score': 0.33040805196093015, 'support': 5567}, 'accuracy': 0.6070607738969895, 'macro avg': {'precision': 0.4772567933651242, 'recall': 0.5860679411821487, 'f1-score': 0.48627371212356535, 'support': 53082}, 'weighted avg': {'precision': 0.758865401878851, 'recall': 0.6070607738969895, 'f1-score': 0.6522574317760591, 'support': 53082}}
[[ 2903  1725   714]
 [ 5628 25989 10556]
 [  571  1664  3332]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8949579
{'0': {'precision': 0.352140856342537, 'recall': 0.5411222136817833, 'f1-score': 0.42664080964790013, 'support': 6505}, '1': {'precision': 0.8506242242826897, 'recall': 0.585727572078526, 'f1-score': 0.6937493487354303, 'support': 39783}, '2': {'precision': 0.2603874585776192, 'recall': 0.6014130114807182, 'f1-score': 0.36342613181535177, 'support': 6794}, 'accuracy': 0.5822689423910177, 'macro avg': {'precision': 0.4877175130676153, 'recall': 0.5760875990803425, 'f1-score': 0.4946054300662274, 'support': 53082}, 'weighted avg': {'precision': 0.713992166435379, 'recall': 0.5822689423910177, 'f1-score': 0.6187379139266551, 'support': 53082}}
[[ 3520  2098   887]
 [ 5762 23302 10719]
 [  714  1994  4086]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9419069
{'0': {'precision': 0.40438173041217973, 'recall': 0.5095332787460521, 'f1-score': 0.4509083380777392, 'support': 8549}, '1': {'precision': 0.7823687176895868, 'recall': 0.5638411115468653, 'f1-score': 0.6553683353683354, 'support': 35698}, '2': {'precision': 0.31025749261291685, 'recall': 0.5823429541595926, 'f1-score': 0.4048312219686836, 'support': 8835}, 'accuracy': 0.5581741456614295, 'macro avg': {'precision': 0.4990026469048945, 'recall': 0.55190578148417, 'f1-score': 0.5037026318049195, 'support': 53082}, 'weighted avg': {'precision': 0.6429144125054014, 'recall': 0.5581741456614295, 'f1-score': 0.5807399507233855, 'support': 53082}}
[[ 4356  2879  1314]
 [ 5446 20128 10124]
 [  970  2720  5145]]
training model: results/QRTEA/W10/deepOF_L2/seq2seq
Epoch 1/50
529/529 - 21s - loss: 10.6852 - accuracy10: 0.5222 - accuracy20: 0.5092 - accuracy30: 0.4965 - accuracy50: 0.4875 - val_loss: 13.3190 - val_accuracy10: 0.8007 - val_accuracy20: 0.7684 - val_accuracy30: 0.7376 - val_accuracy50: 0.6818 - 21s/epoch - 40ms/step
Epoch 2/50
529/529 - 15s - loss: 9.4150 - accuracy10: 0.6227 - accuracy20: 0.5924 - accuracy30: 0.5633 - accuracy50: 0.5418 - val_loss: 12.9084 - val_accuracy10: 0.7849 - val_accuracy20: 0.7586 - val_accuracy30: 0.7303 - val_accuracy50: 0.6776 - 15s/epoch - 28ms/step
Epoch 3/50
529/529 - 15s - loss: 9.0226 - accuracy10: 0.6576 - accuracy20: 0.6348 - accuracy30: 0.6086 - accuracy50: 0.5830 - val_loss: 12.1062 - val_accuracy10: 0.7522 - val_accuracy20: 0.7343 - val_accuracy30: 0.7130 - val_accuracy50: 0.6710 - 15s/epoch - 28ms/step
Epoch 4/50
529/529 - 15s - loss: 8.7423 - accuracy10: 0.6713 - accuracy20: 0.6505 - accuracy30: 0.6268 - accuracy50: 0.6032 - val_loss: 11.9881 - val_accuracy10: 0.7111 - val_accuracy20: 0.6948 - val_accuracy30: 0.6768 - val_accuracy50: 0.6449 - 15s/epoch - 28ms/step
Epoch 5/50
529/529 - 15s - loss: 8.4735 - accuracy10: 0.6821 - accuracy20: 0.6593 - accuracy30: 0.6358 - accuracy50: 0.6144 - val_loss: 11.8372 - val_accuracy10: 0.6968 - val_accuracy20: 0.6785 - val_accuracy30: 0.6579 - val_accuracy50: 0.6308 - 15s/epoch - 28ms/step
Epoch 6/50
529/529 - 15s - loss: 8.3238 - accuracy10: 0.6870 - accuracy20: 0.6627 - accuracy30: 0.6382 - accuracy50: 0.6181 - val_loss: 12.2359 - val_accuracy10: 0.6442 - val_accuracy20: 0.6251 - val_accuracy30: 0.6097 - val_accuracy50: 0.5907 - 15s/epoch - 28ms/step
Epoch 7/50
529/529 - 15s - loss: 8.1804 - accuracy10: 0.6938 - accuracy20: 0.6664 - accuracy30: 0.6418 - accuracy50: 0.6197 - val_loss: 11.7134 - val_accuracy10: 0.6951 - val_accuracy20: 0.6733 - val_accuracy30: 0.6524 - val_accuracy50: 0.6253 - 15s/epoch - 28ms/step
Epoch 8/50
529/529 - 15s - loss: 8.0599 - accuracy10: 0.6986 - accuracy20: 0.6698 - accuracy30: 0.6430 - accuracy50: 0.6208 - val_loss: 11.8325 - val_accuracy10: 0.7359 - val_accuracy20: 0.7117 - val_accuracy30: 0.6852 - val_accuracy50: 0.6494 - 15s/epoch - 28ms/step
Epoch 9/50
529/529 - 15s - loss: 7.9561 - accuracy10: 0.7045 - accuracy20: 0.6776 - accuracy30: 0.6496 - accuracy50: 0.6238 - val_loss: 12.9160 - val_accuracy10: 0.5967 - val_accuracy20: 0.5739 - val_accuracy30: 0.5567 - val_accuracy50: 0.5398 - 15s/epoch - 27ms/step
Epoch 10/50
529/529 - 15s - loss: 7.8527 - accuracy10: 0.7052 - accuracy20: 0.6771 - accuracy30: 0.6493 - accuracy50: 0.6250 - val_loss: 12.4311 - val_accuracy10: 0.7562 - val_accuracy20: 0.7280 - val_accuracy30: 0.6983 - val_accuracy50: 0.6569 - 15s/epoch - 28ms/step
Epoch 11/50
529/529 - 15s - loss: 7.7776 - accuracy10: 0.7045 - accuracy20: 0.6775 - accuracy30: 0.6499 - accuracy50: 0.6255 - val_loss: 12.2537 - val_accuracy10: 0.7620 - val_accuracy20: 0.7341 - val_accuracy30: 0.7046 - val_accuracy50: 0.6630 - 15s/epoch - 28ms/step
Epoch 12/50
529/529 - 15s - loss: 7.6959 - accuracy10: 0.7082 - accuracy20: 0.6814 - accuracy30: 0.6543 - accuracy50: 0.6302 - val_loss: 12.1041 - val_accuracy10: 0.7636 - val_accuracy20: 0.7356 - val_accuracy30: 0.7068 - val_accuracy50: 0.6669 - 15s/epoch - 28ms/step
Epoch 13/50
529/529 - 15s - loss: 7.5947 - accuracy10: 0.7122 - accuracy20: 0.6849 - accuracy30: 0.6567 - accuracy50: 0.6306 - val_loss: 12.2572 - val_accuracy10: 0.7488 - val_accuracy20: 0.7237 - val_accuracy30: 0.6961 - val_accuracy50: 0.6549 - 15s/epoch - 29ms/step
Epoch 14/50
529/529 - 15s - loss: 7.4830 - accuracy10: 0.7129 - accuracy20: 0.6869 - accuracy30: 0.6586 - accuracy50: 0.6315 - val_loss: 11.9774 - val_accuracy10: 0.6952 - val_accuracy20: 0.6592 - val_accuracy30: 0.6303 - val_accuracy50: 0.5984 - 15s/epoch - 28ms/step
Epoch 15/50
529/529 - 15s - loss: 7.4337 - accuracy10: 0.7156 - accuracy20: 0.6901 - accuracy30: 0.6618 - accuracy50: 0.6354 - val_loss: 13.0197 - val_accuracy10: 0.7743 - val_accuracy20: 0.7419 - val_accuracy30: 0.7113 - val_accuracy50: 0.6642 - 15s/epoch - 28ms/step
Epoch 16/50
529/529 - 15s - loss: 7.3428 - accuracy10: 0.7182 - accuracy20: 0.6938 - accuracy30: 0.6652 - accuracy50: 0.6383 - val_loss: 12.4623 - val_accuracy10: 0.7083 - val_accuracy20: 0.6745 - val_accuracy30: 0.6428 - val_accuracy50: 0.6090 - 15s/epoch - 28ms/step
Epoch 17/50
529/529 - 14s - loss: 7.3098 - accuracy10: 0.7187 - accuracy20: 0.6959 - accuracy30: 0.6671 - accuracy50: 0.6374 - val_loss: 12.0359 - val_accuracy10: 0.7274 - val_accuracy20: 0.6975 - val_accuracy30: 0.6657 - val_accuracy50: 0.6291 - 14s/epoch - 27ms/step
testing model: results/QRTEA/W10/deepOF_L2/seq2seq
Evaluating performance on  test set...
1840/1840 - 22s - 22s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7730451
{'0': {'precision': 0.23051679806036646, 'recall': 0.7409227409227409, 'f1-score': 0.3516330785267547, 'support': 40293}, '1': {'precision': 0.9370019989450012, 'recall': 0.6917517268236693, 'f1-score': 0.7959125318366191, 'support': 390312}, '2': {'precision': 0.3523948894016998, 'recall': 0.4654211165349258, 'f1-score': 0.4010976104550599, 'support': 40357}, 'accuracy': 0.6765641389326528, 'macro avg': {'precision': 0.5066378954690225, 'recall': 0.6326985280937786, 'f1-score': 0.516214406939478, 'support': 470962}, 'weighted avg': {'precision': 0.8264635747853373, 'recall': 0.6765641389326528, 'f1-score': 0.7240704346092208, 'support': 470962}}
[[ 29854   7684   2755]
 [ 88550 269999  31763]
 [ 11105  10469  18783]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.77950877
{'0': {'precision': 0.2911387745787292, 'recall': 0.71078360891445, 'f1-score': 0.4130792410655999, 'support': 55640}, '1': {'precision': 0.896132113302468, 'recall': 0.6831351886126534, 'f1-score': 0.7752701262165929, 'support': 359838}, '2': {'precision': 0.4266193083715653, 'recall': 0.4675942614086944, 'f1-score': 0.44616800089426206, 'support': 55484}, 'accuracy': 0.6610087438052327, 'macro avg': {'precision': 0.5379633987509208, 'recall': 0.6205043529785993, 'f1-score': 0.544839122725485, 'support': 470962}, 'weighted avg': {'precision': 0.769344224183229, 'recall': 0.6610087438052327, 'f1-score': 0.6937089744226362, 'support': 470962}}
[[ 39548  12270   3822]
 [ 82973 245818  31047]
 [ 13318  16222  25944]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.803096
{'0': {'precision': 0.3283056848356794, 'recall': 0.683148904567397, 'f1-score': 0.4434834174633709, 'support': 67325}, '1': {'precision': 0.8568060859596244, 'recall': 0.6707369622261912, 'f1-score': 0.7524390386195701, 'support': 336503}, '2': {'precision': 0.45809857066603404, 'recall': 0.46021390055709477, 'f1-score': 0.4591537992836868, 'support': 67134}, 'accuracy': 0.6425019428319058, 'macro avg': {'precision': 0.5477367804871126, 'recall': 0.6046999224502275, 'f1-score': 0.5516920851222092, 'support': 470962}, 'weighted avg': {'precision': 0.7244214777802183, 'recall': 0.6425019428319058, 'f1-score': 0.666466394431894, 'support': 470962}}
[[ 45993  16696   4636]
 [ 78886 225705  31912]
 [ 15213  21025  30896]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8512569
{'0': {'precision': 0.37897684422222844, 'recall': 0.630801418027547, 'f1-score': 0.4734883680351074, 'support': 86035}, '1': {'precision': 0.778568818585792, 'recall': 0.6645460734371385, 'f1-score': 0.7170528890690135, 'support': 298187}, '2': {'precision': 0.49869608552586664, 'recall': 0.4210860041503343, 'f1-score': 0.4566167232358842, 'support': 86740}, 'accuracy': 0.6135420692115288, 'macro avg': {'precision': 0.5520805827779623, 'recall': 0.5721444985383399, 'f1-score': 0.5490526601133351, 'support': 470962}, 'weighted avg': {'precision': 0.6540257421168048, 'recall': 0.6135420692115288, 'f1-score': 0.6245925491869897, 'support': 470962}}
[[ 54271  25665   6099]
 [ 69411 198159  30617]
 [ 19522  30693  36525]]
Evaluating performance on  train set...
529/529 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.53162056
{'0': {'precision': 0.24442267444449392, 'recall': 0.7099987065062734, 'f1-score': 0.36365443222472504, 'support': 7731}, '1': {'precision': 0.9635521344159499, 'recall': 0.8002353510653392, 'f1-score': 0.8743326357638841, 'support': 119821}, '2': {'precision': 0.33268801191362624, 'recall': 0.5693895756340003, 'f1-score': 0.41998402030361426, 'support': 7847}, 'accuracy': 0.7817044439028353, 'macro avg': {'precision': 0.5135542735913566, 'recall': 0.6932078777352042, 'f1-score': 0.5526570294307411, 'support': 135399}, 'weighted avg': {'precision': 0.8859298430820769, 'recall': 0.7817044439028353, 'f1-score': 0.8188423679105177, 'support': 135399}}
[[ 5489  1564   678]
 [15652 95885  8284]
 [ 1316  2063  4468]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.5621294
{'0': {'precision': 0.3019857160549891, 'recall': 0.6858241140071254, 'f1-score': 0.41932987474562183, 'support': 10666}, '1': {'precision': 0.9374062968515742, 'recall': 0.7908856133940022, 'f1-score': 0.8579351088665492, 'support': 113842}, '2': {'precision': 0.4083818085668958, 'recall': 0.5672573684693784, 'f1-score': 0.47488373880625695, 'support': 10891}, 'accuracy': 0.7646215998641054, 'macro avg': {'precision': 0.549257940491153, 'recall': 0.6813223652901687, 'f1-score': 0.584049574139476, 'support': 135399}, 'weighted avg': {'precision': 0.8447985108510512, 'recall': 0.7646215998641054, 'f1-score': 0.7925729134407303, 'support': 135399}}
[[ 7315  2644   707]
 [15563 90036  8243]
 [ 1345  3368  6178]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.60488564
{'0': {'precision': 0.3381337309684508, 'recall': 0.6618787925339887, 'f1-score': 0.4476014855985248, 'support': 13019}, '1': {'precision': 0.9106294155427104, 'recall': 0.7801887398086923, 'f1-score': 0.8403775579253083, 'support': 109039}, '2': {'precision': 0.4445589572597757, 'recall': 0.5496589461059891, 'f1-score': 0.4915538275908299, 'support': 13341}, 'accuracy': 0.7460985679362477, 'macro avg': {'precision': 0.564440701256979, 'recall': 0.6639088261495567, 'f1-score': 0.5931776237048877, 'support': 135399}, 'weighted avg': {'precision': 0.8096599305286044, 'recall': 0.7460985679362477, 'f1-score': 0.7682410645094435, 'support': 135399}}
[[ 8617  3758   644]
 [15450 85071  8518]
 [ 1417  4591  7333]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.66969997
{'0': {'precision': 0.3908736909757665, 'recall': 0.5982525170697836, 'f1-score': 0.4728237257905929, 'support': 17282}, '1': {'precision': 0.8528982885460865, 'recall': 0.7746895445990221, 'f1-score': 0.8119148758519199, 'support': 100417}, '2': {'precision': 0.4961948249619482, 'recall': 0.4972881355932203, 'f1-score': 0.4967408786929654, 'support': 17700}, 'accuracy': 0.7159063213169964, 'macro avg': {'precision': 0.5799889348279338, 'recall': 0.6234100657540087, 'f1-score': 0.5938264934451595, 'support': 135399}, 'weighted avg': {'precision': 0.7472966194004539, 'recall': 0.7159063213169964, 'f1-score': 0.7274330628025372, 'support': 135399}}
[[10339  6262   681]
 [14369 77792  8256]
 [ 1743  7155  8802]]
Evaluating performance on  val set...
208/208 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.693519
{'0': {'precision': 0.2153731343283582, 'recall': 0.7453512396694215, 'f1-score': 0.3341824918943955, 'support': 3872}, '1': {'precision': 0.9479722280163294, 'recall': 0.7035628192936285, 'f1-score': 0.807682542906469, 'support': 45217}, '2': {'precision': 0.34378572595133106, 'recall': 0.5271725519659404, 'f1-score': 0.41617240015816526, 'support': 3993}, 'accuracy': 0.6933423759466486, 'macro avg': {'precision': 0.5023770294320062, 'recall': 0.6586955369763302, 'f1-score': 0.51934581165301, 'support': 53082}, 'weighted avg': {'precision': 0.8490848388164997, 'recall': 0.6933423759466486, 'f1-score': 0.7436930135459943, 'support': 53082}}
[[ 2886   683   303]
 [ 9689 31813  3715]
 [  825  1063  2105]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7148526
{'0': {'precision': 0.2695850938560643, 'recall': 0.7280209502431725, 'f1-score': 0.39346914017085377, 'support': 5346}, '1': {'precision': 0.9116710289804799, 'recall': 0.6858349346428486, 'f1-score': 0.7827899924184988, 'support': 42153}, '2': {'precision': 0.42111335448514564, 'recall': 0.523016299480566, 'f1-score': 0.46656547095949513, 'support': 5583}, 'accuracy': 0.6729588184318601, 'macro avg': {'precision': 0.5341231591072299, 'recall': 0.6456240614555291, 'f1-score': 0.5476082011829492, 'support': 53082}, 'weighted avg': {'precision': 0.7954098687777261, 'recall': 0.6729588184318601, 'f1-score': 0.7103211559123097, 'support': 53082}}
[[ 3892  1107   347]
 [ 9576 28910  3667]
 [  969  1694  2920]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7482087
{'0': {'precision': 0.30432485968966655, 'recall': 0.7078789740439256, 'f1-score': 0.42565570742519393, 'support': 6511}, '1': {'precision': 0.8764352646166029, 'recall': 0.6679994970451402, 'f1-score': 0.7581522126924779, 'support': 39765}, '2': {'precision': 0.46179053611220344, 'recall': 0.517631501616221, 'f1-score': 0.4881191548320055, 'support': 6806}, 'accuracy': 0.6536113936927772, 'macro avg': {'precision': 0.5475168868061576, 'recall': 0.6311699909017622, 'f1-score': 0.5573090249832258, 'support': 53082}, 'weighted avg': {'precision': 0.7530962256075183, 'recall': 0.6536113936927772, 'f1-score': 0.6827456768122613, 'support': 53082}}
[[ 4609  1550   352]
 [ 9448 26563  3754]
 [ 1088  2195  3523]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.80037475
{'0': {'precision': 0.3570290086069493, 'recall': 0.6532135775107897, 'f1-score': 0.4617033555940308, 'support': 8573}, '1': {'precision': 0.804230993051039, 'recall': 0.6586856566109678, 'f1-score': 0.7242181840600485, 'support': 35668}, '2': {'precision': 0.511852394916911, 'recall': 0.4738151792783622, 'f1-score': 0.4920998531571219, 'support': 8841}, 'accuracy': 0.6270110395237557, 'macro avg': {'precision': 0.5577041321916331, 'recall': 0.5952381378000399, 'f1-score': 0.5593404642704004, 'support': 53082}, 'weighted avg': {'precision': 0.6833089893823188, 'recall': 0.6270110395237557, 'f1-score': 0.6431606167500009, 'support': 53082}}
[[ 5600  2505   468]
 [ 8647 23494  3527]
 [ 1438  3214  4189]]
training model: results/QRTEA/W10/deepVOL_L2/seq2seq
Epoch 1/50
529/529 - 20s - loss: 10.1372 - accuracy10: 0.5868 - accuracy20: 0.5851 - accuracy30: 0.5757 - accuracy50: 0.5647 - val_loss: 12.4918 - val_accuracy10: 0.6964 - val_accuracy20: 0.6833 - val_accuracy30: 0.6600 - val_accuracy50: 0.6241 - 20s/epoch - 38ms/step
Epoch 2/50
529/529 - 15s - loss: 9.4642 - accuracy10: 0.6678 - accuracy20: 0.6538 - accuracy30: 0.6314 - accuracy50: 0.6025 - val_loss: 11.8766 - val_accuracy10: 0.6861 - val_accuracy20: 0.6821 - val_accuracy30: 0.6669 - val_accuracy50: 0.6363 - 15s/epoch - 28ms/step
Epoch 3/50
529/529 - 15s - loss: 9.1946 - accuracy10: 0.6923 - accuracy20: 0.6737 - accuracy30: 0.6460 - accuracy50: 0.6131 - val_loss: 11.6713 - val_accuracy10: 0.6742 - val_accuracy20: 0.6688 - val_accuracy30: 0.6493 - val_accuracy50: 0.6173 - 15s/epoch - 28ms/step
Epoch 4/50
529/529 - 15s - loss: 9.0327 - accuracy10: 0.7005 - accuracy20: 0.6757 - accuracy30: 0.6453 - accuracy50: 0.6134 - val_loss: 11.6954 - val_accuracy10: 0.6674 - val_accuracy20: 0.6547 - val_accuracy30: 0.6305 - val_accuracy50: 0.5994 - 15s/epoch - 27ms/step
Epoch 5/50
529/529 - 15s - loss: 8.9753 - accuracy10: 0.7029 - accuracy20: 0.6762 - accuracy30: 0.6441 - accuracy50: 0.6133 - val_loss: 11.4338 - val_accuracy10: 0.5975 - val_accuracy20: 0.5888 - val_accuracy30: 0.5646 - val_accuracy50: 0.5425 - 15s/epoch - 28ms/step
Epoch 6/50
529/529 - 14s - loss: 8.8668 - accuracy10: 0.7124 - accuracy20: 0.6857 - accuracy30: 0.6521 - accuracy50: 0.6183 - val_loss: 11.4140 - val_accuracy10: 0.6314 - val_accuracy20: 0.6192 - val_accuracy30: 0.5912 - val_accuracy50: 0.5636 - 14s/epoch - 27ms/step
Epoch 7/50
529/529 - 14s - loss: 8.7886 - accuracy10: 0.7144 - accuracy20: 0.6901 - accuracy30: 0.6603 - accuracy50: 0.6277 - val_loss: 11.4309 - val_accuracy10: 0.5719 - val_accuracy20: 0.5659 - val_accuracy30: 0.5453 - val_accuracy50: 0.5253 - 14s/epoch - 27ms/step
Epoch 8/50
529/529 - 14s - loss: 8.7223 - accuracy10: 0.7168 - accuracy20: 0.6926 - accuracy30: 0.6626 - accuracy50: 0.6298 - val_loss: 11.3966 - val_accuracy10: 0.5863 - val_accuracy20: 0.5693 - val_accuracy30: 0.5425 - val_accuracy50: 0.5176 - 14s/epoch - 27ms/step
Epoch 9/50
529/529 - 14s - loss: 8.6817 - accuracy10: 0.7214 - accuracy20: 0.6944 - accuracy30: 0.6620 - accuracy50: 0.6295 - val_loss: 11.3979 - val_accuracy10: 0.5920 - val_accuracy20: 0.5757 - val_accuracy30: 0.5505 - val_accuracy50: 0.5295 - 14s/epoch - 27ms/step
Epoch 10/50
529/529 - 14s - loss: 8.5814 - accuracy10: 0.7218 - accuracy20: 0.6948 - accuracy30: 0.6628 - accuracy50: 0.6300 - val_loss: 11.2892 - val_accuracy10: 0.5979 - val_accuracy20: 0.5879 - val_accuracy30: 0.5646 - val_accuracy50: 0.5447 - 14s/epoch - 27ms/step
Epoch 11/50
529/529 - 14s - loss: 8.5520 - accuracy10: 0.7241 - accuracy20: 0.6932 - accuracy30: 0.6581 - accuracy50: 0.6235 - val_loss: 11.4968 - val_accuracy10: 0.5907 - val_accuracy20: 0.5747 - val_accuracy30: 0.5493 - val_accuracy50: 0.5292 - 14s/epoch - 27ms/step
Epoch 12/50
529/529 - 14s - loss: 8.5066 - accuracy10: 0.7235 - accuracy20: 0.6944 - accuracy30: 0.6608 - accuracy50: 0.6266 - val_loss: 11.4918 - val_accuracy10: 0.5694 - val_accuracy20: 0.5559 - val_accuracy30: 0.5332 - val_accuracy50: 0.5171 - 14s/epoch - 27ms/step
Epoch 13/50
529/529 - 14s - loss: 8.4406 - accuracy10: 0.7241 - accuracy20: 0.6963 - accuracy30: 0.6622 - accuracy50: 0.6268 - val_loss: 11.4033 - val_accuracy10: 0.5352 - val_accuracy20: 0.5224 - val_accuracy30: 0.5034 - val_accuracy50: 0.4919 - 14s/epoch - 27ms/step
Epoch 14/50
529/529 - 14s - loss: 8.3923 - accuracy10: 0.7252 - accuracy20: 0.6973 - accuracy30: 0.6627 - accuracy50: 0.6274 - val_loss: 11.3776 - val_accuracy10: 0.5638 - val_accuracy20: 0.5529 - val_accuracy30: 0.5325 - val_accuracy50: 0.5185 - 14s/epoch - 27ms/step
Epoch 15/50
529/529 - 14s - loss: 8.3104 - accuracy10: 0.7260 - accuracy20: 0.6992 - accuracy30: 0.6633 - accuracy50: 0.6286 - val_loss: 11.7842 - val_accuracy10: 0.5297 - val_accuracy20: 0.5200 - val_accuracy30: 0.5030 - val_accuracy50: 0.4928 - 14s/epoch - 27ms/step
Epoch 16/50
529/529 - 14s - loss: 8.2486 - accuracy10: 0.7240 - accuracy20: 0.6975 - accuracy30: 0.6637 - accuracy50: 0.6313 - val_loss: 11.8507 - val_accuracy10: 0.5445 - val_accuracy20: 0.5364 - val_accuracy30: 0.5210 - val_accuracy50: 0.5126 - 14s/epoch - 27ms/step
Epoch 17/50
529/529 - 14s - loss: 8.1876 - accuracy10: 0.7233 - accuracy20: 0.6977 - accuracy30: 0.6651 - accuracy50: 0.6326 - val_loss: 11.4437 - val_accuracy10: 0.5372 - val_accuracy20: 0.5253 - val_accuracy30: 0.5047 - val_accuracy50: 0.4915 - 14s/epoch - 27ms/step
Epoch 18/50
529/529 - 14s - loss: 8.1090 - accuracy10: 0.7265 - accuracy20: 0.7001 - accuracy30: 0.6663 - accuracy50: 0.6321 - val_loss: 11.3388 - val_accuracy10: 0.5590 - val_accuracy20: 0.5472 - val_accuracy30: 0.5268 - val_accuracy50: 0.5150 - 14s/epoch - 27ms/step
Epoch 19/50
529/529 - 14s - loss: 8.0688 - accuracy10: 0.7261 - accuracy20: 0.6984 - accuracy30: 0.6648 - accuracy50: 0.6329 - val_loss: 11.9126 - val_accuracy10: 0.5903 - val_accuracy20: 0.5741 - val_accuracy30: 0.5492 - val_accuracy50: 0.5311 - 14s/epoch - 27ms/step
Epoch 20/50
529/529 - 14s - loss: 8.0193 - accuracy10: 0.7292 - accuracy20: 0.7017 - accuracy30: 0.6668 - accuracy50: 0.6344 - val_loss: 11.7848 - val_accuracy10: 0.5862 - val_accuracy20: 0.5676 - val_accuracy30: 0.5426 - val_accuracy50: 0.5212 - 14s/epoch - 27ms/step
testing model: results/QRTEA/W10/deepVOL_L2/seq2seq
Evaluating performance on  test set...
1840/1840 - 16s - 16s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.89219296
{'0': {'precision': 0.26295150831960384, 'recall': 0.6773384955203137, 'f1-score': 0.3788345687238, 'support': 40293}, '1': {'precision': 0.9396893395142314, 'recall': 0.6159435327876203, 'f1-score': 0.7441287488953923, 'support': 390315}, '2': {'precision': 0.19017550793109023, 'recall': 0.5246165663173022, 'f1-score': 0.2791559267731537, 'support': 40359}, 'accuracy': 0.6133699388704517, 'macro avg': {'precision': 0.4642721185883085, 'recall': 0.605966198208412, 'f1-score': 0.46737308146411527, 'support': 470967}, 'weighted avg': {'precision': 0.8175631052744883, 'recall': 0.6133699388704517, 'f1-score': 0.6730311209730847, 'support': 470967}}
[[ 27292   8232   4769]
 [ 64511 240412  85392]
 [ 11988   7198  21173]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9088685
{'0': {'precision': 0.3193044705969775, 'recall': 0.617806692786025, 'f1-score': 0.42101395582390794, 'support': 55642}, '1': {'precision': 0.8989208980885561, 'recall': 0.594260210816504, 'f1-score': 0.7155098858666739, 'support': 359839}, '2': {'precision': 0.2503727327087901, 'recall': 0.5659625851566161, 'f1-score': 0.34716518066894775, 'support': 55486}, 'accuracy': 0.5937082640609639, 'macro avg': {'precision': 0.48953270046477454, 'recall': 0.5926764962530483, 'f1-score': 0.49456300745317655, 'support': 470967}, 'weighted avg': {'precision': 0.7540352463066942, 'recall': 0.5937082640609639, 'f1-score': 0.6373211447191187, 'support': 470967}}
[[ 34376  12825   8441]
 [ 60420 213838  85581]
 [ 12863  11220  31403]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9417654
{'0': {'precision': 0.34553984835572266, 'recall': 0.5841403279467681, 'f1-score': 0.43422193025553835, 'support': 67328}, '1': {'precision': 0.8608531869094094, 'recall': 0.5609489365622298, 'f1-score': 0.6792712878413028, 'support': 336503}, '2': {'precision': 0.27901882851257653, 'recall': 0.5730159675881792, 'f1-score': 0.37529510467679944, 'support': 67136}, 'accuracy': 0.5659844532631798, 'macro avg': {'precision': 0.49513728792590284, 'recall': 0.5727017440323924, 'f1-score': 0.4962627742578802, 'support': 470967}, 'weighted avg': {'precision': 0.7042455096337779, 'recall': 0.5659844532631798, 'f1-score': 0.6009082004477775, 'support': 470967}}
[[ 39329  16308  11691]
 [ 60027 188761  87715]
 [ 14463  14203  38470]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9800197
{'0': {'precision': 0.3805833521430542, 'recall': 0.5291266649619936, 'f1-score': 0.442727453964611, 'support': 86038}, '1': {'precision': 0.7867285933099462, 'recall': 0.533978563859042, 'f1-score': 0.6361685891109877, 'support': 298188}, '2': {'precision': 0.32558842089716566, 'recall': 0.5591242895516537, 'f1-score': 0.41153335398113694, 'support': 86741}, 'accuracy': 0.5377234498383114, 'macro avg': {'precision': 0.4976334554500553, 'recall': 0.5407431727908965, 'f1-score': 0.4968097990189119, 'support': 470967}, 'weighted avg': {'precision': 0.6276013424520855, 'recall': 0.5377234498383114, 'f1-score': 0.5594575386209908, 'support': 470967}}
[[ 45525  22772  17741]
 [ 56244 159226  82718]
 [ 17850  20392  48499]]
Evaluating performance on  train set...
529/529 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7729602
{'0': {'precision': 0.20875347862228485, 'recall': 0.750227302247045, 'f1-score': 0.32662293598733316, 'support': 7699}, '1': {'precision': 0.9691317144959529, 'recall': 0.6594207131353421, 'f1-score': 0.7848264697557317, 'support': 119837}, '2': {'precision': 0.18807269395235188, 'recall': 0.6263191354100445, 'f1-score': 0.2892797369116481, 'support': 7865}, 'accuracy': 0.6626612801973397, 'macro avg': {'precision': 0.4553192956901965, 'recall': 0.6786557169308106, 'f1-score': 0.4669097142182377, 'support': 135401}, 'weighted avg': {'precision': 0.8805268944830521, 'recall': 0.6626612801973397, 'f1-score': 0.729987996920955, 'support': 135401}}
[[ 5776  1218   705]
 [20253 79023 20561]
 [ 1640  1299  4926]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7970435
{'0': {'precision': 0.2552067762830095, 'recall': 0.7230378317334839, 'f1-score': 0.37725565294247626, 'support': 10626}, '1': {'precision': 0.9462330252796803, 'recall': 0.6320822649197373, 'f1-score': 0.7578930743109847, 'support': 113876}, '2': {'precision': 0.2433366407773634, 'recall': 0.6525369299935774, 'f1-score': 0.3544833773613118, 'support': 10899}, 'accuracy': 0.6408667587388571, 'macro avg': {'precision': 0.4815921474466844, 'recall': 0.6692190088822662, 'f1-score': 0.496544034871591, 'support': 135401}, 'weighted avg': {'precision': 0.8354235584623794, 'recall': 0.6408667587388571, 'f1-score': 0.695549254645574, 'support': 135401}}
[[ 7683  1963   980]
 [20762 71979 21135]
 [ 1660  2127  7112]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8395673
{'0': {'precision': 0.2802683745044221, 'recall': 0.7073039328869392, 'f1-score': 0.4014590568551646, 'support': 12993}, '1': {'precision': 0.923010047744602, 'recall': 0.5937746401393601, 'f1-score': 0.7226601947164338, 'support': 109070}, '2': {'precision': 0.2693706466128336, 'recall': 0.6552706552706553, 'f1-score': 0.3817927660318015, 'support': 13338}, 'accuracy': 0.6107266563762453, 'macro avg': {'precision': 0.49088302295395264, 'recall': 0.6521164094323182, 'f1-score': 0.5019706725344667, 'support': 135401}, 'weighted avg': {'precision': 0.7969446206598303, 'recall': 0.6107266563762453, 'f1-score': 0.6582599602423377, 'support': 135401}}
[[ 9190  2614  1189]
 [21790 64763 22517]
 [ 1810  2788  8740]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.88480234
{'0': {'precision': 0.32259895020570295, 'recall': 0.6589776283760288, 'f1-score': 0.4331511076401455, 'support': 17254}, '1': {'precision': 0.8720320499930393, 'recall': 0.5612288578510916, 'f1-score': 0.6829315566323441, 'support': 100451}, '2': {'precision': 0.31278339482355594, 'recall': 0.6275994575045208, 'f1-score': 0.4174952540270286, 'support': 17696}, 'accuracy': 0.5823590667720328, 'macro avg': {'precision': 0.5024714650074327, 'recall': 0.6159353145772138, 'f1-score': 0.5111926394331726, 'support': 135401}, 'weighted avg': {'precision': 0.7289283586937884, 'recall': 0.5823590667720328, 'f1-score': 0.6164115702377453, 'support': 135401}}
[[11370  4022  1862]
 [21536 56376 22539]
 [ 2339  4251 11106]]
Evaluating performance on  val set...
208/208 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8863821
{'0': {'precision': 0.22874088322513425, 'recall': 0.7430356677948451, 'f1-score': 0.3497977693344772, 'support': 3841}, '1': {'precision': 0.9583514571552849, 'recall': 0.5842743806766701, 'f1-score': 0.7259572481774873, 'support': 45251}, '2': {'precision': 0.1874471844511024, 'recall': 0.6115288220551378, 'f1-score': 0.28694067148821073, 'support': 3990}, 'accuracy': 0.5978109340266003, 'macro avg': {'precision': 0.4581798416105072, 'recall': 0.6462796235088843, 'f1-score': 0.4542318963333918, 'support': 53082}, 'weighted avg': {'precision': 0.847610673790766, 'recall': 0.5978109340266003, 'f1-score': 0.6657390066035788, 'support': 53082}}
[[ 2854   553   434]
 [ 8669 26439 10143]
 [  954   596  2440]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8907492
{'0': {'precision': 0.28643862570001516, 'recall': 0.708536128790715, 'f1-score': 0.4079543004957965, 'support': 5342}, '1': {'precision': 0.9271755665639505, 'recall': 0.5636307590164323, 'f1-score': 0.7010765373838668, 'support': 42173}, '2': {'precision': 0.2540229077366313, 'recall': 0.6493623136339142, 'f1-score': 0.36518840286897664, 'support': 5567}, 'accuracy': 0.587204702158924, 'macro avg': {'precision': 0.4892123666668657, 'recall': 0.6405097338136871, 'f1-score': 0.49140641358287995, 'support': 53082}, 'weighted avg': {'precision': 0.7920966774906897, 'recall': 0.587204702158924, 'f1-score': 0.6363512400269385, 'support': 53082}}
[[ 3785   892   665]
 [ 8452 23770  9951]
 [  977   975  3615]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9191509
{'0': {'precision': 0.3154560810810811, 'recall': 0.6890084550345887, 'f1-score': 0.43277168927726545, 'support': 6505}, '1': {'precision': 0.8964060099026806, 'recall': 0.527888796722218, 'f1-score': 0.6644729556564521, 'support': 39783}, '2': {'precision': 0.28628771202900427, 'recall': 0.6508684133058581, 'f1-score': 0.39766187050359714, 'support': 6794}, 'accuracy': 0.5633736483176971, 'macro avg': {'precision': 0.49938326767092195, 'recall': 0.6225885550208883, 'f1-score': 0.4983021718124383, 'support': 53082}, 'weighted avg': {'precision': 0.747123333991105, 'recall': 0.5633736483176971, 'f1-score': 0.6019295087191645, 'support': 53082}}
[[ 4482  1148   875]
 [ 8633 21001 10149]
 [ 1093  1279  4422]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9530152
{'0': {'precision': 0.3641042560211151, 'recall': 0.6454556088431396, 'f1-score': 0.4655754303071211, 'support': 8549}, '1': {'precision': 0.8331063629960085, 'recall': 0.49697462042691465, 'f1-score': 0.622567683750636, 'support': 35698}, '2': {'precision': 0.3336339586339586, 'recall': 0.6280701754385964, 'f1-score': 0.4357796363921938, 'support': 8835}, 'accuracy': 0.5427075091368072, 'macro avg': {'precision': 0.510281525883694, 'recall': 0.5901668015695501, 'f1-score': 0.5079742501499837, 'support': 53082}, 'weighted avg': {'precision': 0.674439814918184, 'recall': 0.5427075091368072, 'f1-score': 0.5661945408189369, 'support': 53082}}
[[ 5518  1685  1346]
 [ 8220 17741  9737]
 [ 1417  1869  5549]]
training model: results/QRTEA/W10/deepVOL_L3/seq2seq
Epoch 1/50
529/529 - 28s - loss: 11.2568 - accuracy10: 0.4133 - accuracy20: 0.4270 - accuracy30: 0.4344 - accuracy50: 0.4454 - val_loss: 13.2695 - val_accuracy10: 0.5208 - val_accuracy20: 0.5364 - val_accuracy30: 0.5453 - val_accuracy50: 0.5460 - 28s/epoch - 53ms/step
Epoch 2/50
529/529 - 21s - loss: 9.6071 - accuracy10: 0.6257 - accuracy20: 0.6095 - accuracy30: 0.5877 - accuracy50: 0.5645 - val_loss: 12.1377 - val_accuracy10: 0.6112 - val_accuracy20: 0.6142 - val_accuracy30: 0.6100 - val_accuracy50: 0.5958 - 21s/epoch - 40ms/step
Epoch 3/50
529/529 - 21s - loss: 9.1300 - accuracy10: 0.6841 - accuracy20: 0.6591 - accuracy30: 0.6313 - accuracy50: 0.5997 - val_loss: 12.1489 - val_accuracy10: 0.5980 - val_accuracy20: 0.5980 - val_accuracy30: 0.5932 - val_accuracy50: 0.5824 - 21s/epoch - 40ms/step
Epoch 4/50
529/529 - 22s - loss: 8.8025 - accuracy10: 0.6977 - accuracy20: 0.6702 - accuracy30: 0.6378 - accuracy50: 0.6028 - val_loss: 11.9654 - val_accuracy10: 0.6502 - val_accuracy20: 0.6405 - val_accuracy30: 0.6271 - val_accuracy50: 0.6071 - 22s/epoch - 41ms/step
Epoch 5/50
529/529 - 22s - loss: 8.6506 - accuracy10: 0.7150 - accuracy20: 0.6834 - accuracy30: 0.6491 - accuracy50: 0.6132 - val_loss: 11.8787 - val_accuracy10: 0.6553 - val_accuracy20: 0.6443 - val_accuracy30: 0.6305 - val_accuracy50: 0.6097 - 22s/epoch - 41ms/step
Epoch 6/50
529/529 - 21s - loss: 8.5948 - accuracy10: 0.7151 - accuracy20: 0.6837 - accuracy30: 0.6492 - accuracy50: 0.6129 - val_loss: 11.7245 - val_accuracy10: 0.6540 - val_accuracy20: 0.6417 - val_accuracy30: 0.6274 - val_accuracy50: 0.6072 - 21s/epoch - 40ms/step
Epoch 7/50
529/529 - 22s - loss: 8.5260 - accuracy10: 0.7197 - accuracy20: 0.6876 - accuracy30: 0.6516 - accuracy50: 0.6173 - val_loss: 11.7344 - val_accuracy10: 0.6320 - val_accuracy20: 0.6161 - val_accuracy30: 0.6007 - val_accuracy50: 0.5853 - 22s/epoch - 41ms/step
Epoch 8/50
529/529 - 21s - loss: 8.4131 - accuracy10: 0.7218 - accuracy20: 0.6908 - accuracy30: 0.6554 - accuracy50: 0.6204 - val_loss: 12.4542 - val_accuracy10: 0.6332 - val_accuracy20: 0.6218 - val_accuracy30: 0.6077 - val_accuracy50: 0.5912 - 21s/epoch - 40ms/step
Epoch 9/50
529/529 - 22s - loss: 8.3702 - accuracy10: 0.7230 - accuracy20: 0.6916 - accuracy30: 0.6565 - accuracy50: 0.6229 - val_loss: 11.9755 - val_accuracy10: 0.6248 - val_accuracy20: 0.6121 - val_accuracy30: 0.5948 - val_accuracy50: 0.5782 - 22s/epoch - 42ms/step
Epoch 10/50
529/529 - 21s - loss: 8.3002 - accuracy10: 0.7209 - accuracy20: 0.6909 - accuracy30: 0.6571 - accuracy50: 0.6234 - val_loss: 11.9433 - val_accuracy10: 0.6135 - val_accuracy20: 0.5996 - val_accuracy30: 0.5847 - val_accuracy50: 0.5702 - 21s/epoch - 40ms/step
Epoch 11/50
529/529 - 21s - loss: 8.2416 - accuracy10: 0.7241 - accuracy20: 0.6940 - accuracy30: 0.6611 - accuracy50: 0.6283 - val_loss: 11.8747 - val_accuracy10: 0.6334 - val_accuracy20: 0.6218 - val_accuracy30: 0.6083 - val_accuracy50: 0.5941 - 21s/epoch - 39ms/step
Epoch 12/50
529/529 - 21s - loss: 8.1847 - accuracy10: 0.7258 - accuracy20: 0.6955 - accuracy30: 0.6622 - accuracy50: 0.6301 - val_loss: 12.0605 - val_accuracy10: 0.6654 - val_accuracy20: 0.6459 - val_accuracy30: 0.6258 - val_accuracy50: 0.6041 - 21s/epoch - 40ms/step
Epoch 13/50
529/529 - 21s - loss: 8.1178 - accuracy10: 0.7249 - accuracy20: 0.6969 - accuracy30: 0.6661 - accuracy50: 0.6362 - val_loss: 12.2573 - val_accuracy10: 0.6667 - val_accuracy20: 0.6486 - val_accuracy30: 0.6314 - val_accuracy50: 0.6109 - 21s/epoch - 40ms/step
Epoch 14/50
529/529 - 21s - loss: 8.0769 - accuracy10: 0.7275 - accuracy20: 0.6984 - accuracy30: 0.6676 - accuracy50: 0.6366 - val_loss: 12.0841 - val_accuracy10: 0.6844 - val_accuracy20: 0.6657 - val_accuracy30: 0.6464 - val_accuracy50: 0.6208 - 21s/epoch - 40ms/step
Epoch 15/50
529/529 - 22s - loss: 8.0257 - accuracy10: 0.7271 - accuracy20: 0.6990 - accuracy30: 0.6688 - accuracy50: 0.6384 - val_loss: 12.0891 - val_accuracy10: 0.6776 - val_accuracy20: 0.6603 - val_accuracy30: 0.6410 - val_accuracy50: 0.6172 - 22s/epoch - 41ms/step
Epoch 16/50
529/529 - 22s - loss: 7.9826 - accuracy10: 0.7275 - accuracy20: 0.6988 - accuracy30: 0.6680 - accuracy50: 0.6385 - val_loss: 11.8863 - val_accuracy10: 0.6882 - val_accuracy20: 0.6659 - val_accuracy30: 0.6443 - val_accuracy50: 0.6178 - 22s/epoch - 42ms/step
testing model: results/QRTEA/W10/deepVOL_L3/seq2seq
Evaluating performance on  test set...
1840/1840 - 31s - 31s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.96015173
{'0': {'precision': 0.2052204137562247, 'recall': 0.7619685801503984, 'f1-score': 0.32335253662492497, 'support': 40293}, '1': {'precision': 0.9353136708617542, 'recall': 0.6235783918117418, 'f1-score': 0.7482768161834784, 'support': 390315}, '2': {'precision': 0.2916891571388848, 'recall': 0.4418593126687975, 'f1-score': 0.3514030109560967, 'support': 40359}, 'accuracy': 0.619845976469689, 'macro avg': {'precision': 0.47740774725228796, 'recall': 0.6091354282103126, 'f1-score': 0.47434412125483333, 'support': 470967}, 'weighted avg': {'precision': 0.8176967478970999, 'recall': 0.619845976469689, 'f1-score': 0.6779132792447446, 'support': 470967}}
[[ 30702   6498   3093]
 [106712 243392  40211]
 [ 12191  10335  17833]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9574659
{'0': {'precision': 0.25756634812805757, 'recall': 0.7304733834154056, 'f1-score': 0.3808457408431172, 'support': 55642}, '1': {'precision': 0.8917949259698679, 'recall': 0.6099533402438313, 'f1-score': 0.7244267313579392, 'support': 359839}, '2': {'precision': 0.3609855772816084, 'recall': 0.4362001225534369, 'f1-score': 0.3950446002301421, 'support': 55486}, 'accuracy': 0.6037217044930961, 'macro avg': {'precision': 0.5034489504598446, 'recall': 0.5922089487375579, 'f1-score': 0.5001056908103995, 'support': 470967}, 'weighted avg': {'precision': 0.7543283220473197, 'recall': 0.6037217044930961, 'f1-score': 0.6450291718644233, 'support': 470967}}
[[ 40645  10558   4439]
 [101949 219485  38405]
 [ 15210  16073  24203]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9723549
{'0': {'precision': 0.2890771444811281, 'recall': 0.7100611929657795, 'f1-score': 0.41087896315522593, 'support': 67328}, '1': {'precision': 0.8513159015416063, 'recall': 0.5940689978989786, 'f1-score': 0.699800288103227, 'support': 336503}, '2': {'precision': 0.39840890785513433, 'recall': 0.419968422306959, 'f1-score': 0.4089046807584932, 'support': 67136}, 'accuracy': 0.5858329776820881, 'macro avg': {'precision': 0.5129339846259563, 'recall': 0.5746995377239057, 'f1-score': 0.506527977338982, 'support': 470967}, 'weighted avg': {'precision': 0.7063784113066157, 'recall': 0.5858329776820881, 'f1-score': 0.6170300250894807, 'support': 470967}}
[[ 47807  14043   5478]
 [ 99501 199906  37096]
 [ 18070  20871  28195]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9992277
{'0': {'precision': 0.33311388688215143, 'recall': 0.6645551965410632, 'f1-score': 0.44377954222646515, 'support': 86038}, '1': {'precision': 0.7721991977128166, 'recall': 0.5842354487772814, 'f1-score': 0.6651940747585401, 'support': 298188}, '2': {'precision': 0.4466751675303182, 'recall': 0.3796128704995331, 'f1-score': 0.4104226001657744, 'support': 86741}, 'accuracy': 0.5612219115139702, 'macro avg': {'precision': 0.5173294173750954, 'recall': 0.5428011719392926, 'f1-score': 0.5064654057169266, 'support': 470967}, 'weighted avg': {'precision': 0.6320316236039961, 'recall': 0.5612219115139702, 'f1-score': 0.5778223565115169, 'support': 470967}}
[[ 57177  21432   7429]
 [ 90615 174212  33361]
 [ 23852  29961  32928]]
Evaluating performance on  train set...
529/529 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7285269
{'0': {'precision': 0.18473895582329317, 'recall': 0.7826990518249123, 'f1-score': 0.29892355771615653, 'support': 7699}, '1': {'precision': 0.9665115860921942, 'recall': 0.7176915309962699, 'f1-score': 0.8237215249278097, 'support': 119837}, '2': {'precision': 0.31320672658741666, 'recall': 0.5493960584869676, 'f1-score': 0.3989658833848853, 'support': 7865}, 'accuracy': 0.7116121742084622, 'macro avg': {'precision': 0.48815242283430144, 'recall': 0.6832622137693832, 'f1-score': 0.5072036553429505, 'support': 135401}, 'weighted avg': {'precision': 0.8841110853540508, 'recall': 0.7116121742084622, 'f1-score': 0.7692084661594284, 'support': 135401}}
[[ 6026  1034   639]
 [24995 86006  8836]
 [ 1598  1946  4321]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7465609
{'0': {'precision': 0.23063668719281397, 'recall': 0.7683982683982684, 'f1-score': 0.35478404449465545, 'support': 10626}, '1': {'precision': 0.9409047092845555, 'recall': 0.7028610067090519, 'f1-score': 0.8046465804103708, 'support': 113876}, '2': {'precision': 0.38592379294180673, 'recall': 0.5287641067987888, 'f1-score': 0.44619077113657474, 'support': 10899}, 'accuracy': 0.6939904432020443, 'macro avg': {'precision': 0.5191550631397254, 'recall': 0.6666744606353697, 'f1-score': 0.535207132013867, 'support': 135401}, 'weighted avg': {'precision': 0.8404915291014958, 'recall': 0.6939904432020443, 'f1-score': 0.740488640868451, 'support': 135401}}
[[ 8165  1776   685]
 [25352 80039  8485]
 [ 1885  3251  5763]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7753032
{'0': {'precision': 0.26106663839262045, 'recall': 0.7580235511429231, 'f1-score': 0.38837516512549536, 'support': 12993}, '1': {'precision': 0.9141664938202315, 'recall': 0.6869533327221051, 'f1-score': 0.784438127843125, 'support': 109070}, '2': {'precision': 0.4260532009672903, 'recall': 0.5019493177387915, 'f1-score': 0.46089770067465236, 'support': 13338}, 'accuracy': 0.6755489250448667, 'macro avg': {'precision': 0.5337621110600475, 'recall': 0.6489754005346066, 'f1-score': 0.5445703312144242, 'support': 135401}, 'weighted avg': {'precision': 0.803412647676972, 'recall': 0.6755489250448667, 'f1-score': 0.7145610346742174, 'support': 135401}}
[[ 9849  2500   644]
 [25769 74926  8375]
 [ 2108  4535  6695]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8141358
{'0': {'precision': 0.30811220621683094, 'recall': 0.7066187550712878, 'f1-score': 0.4291144586794312, 'support': 17254}, '1': {'precision': 0.8565763633617, 'recall': 0.6773750385760221, 'f1-score': 0.7565082524028974, 'support': 100451}, '2': {'precision': 0.478194571515706, 'recall': 0.4430379746835443, 'f1-score': 0.4599454401454929, 'support': 17696}, 'accuracy': 0.6504752549833458, 'macro avg': {'precision': 0.547627713698079, 'recall': 0.6090105894436181, 'f1-score': 0.5485227170759405, 'support': 135401}, 'weighted avg': {'precision': 0.7372342258894192, 'recall': 0.6504752549833458, 'f1-score': 0.6760300576878532, 'support': 135401}}
[[12192  4297   765]
 [24618 68043  7790]
 [ 2760  7096  7840]]
Evaluating performance on  val set...
208/208 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.86892045
{'0': {'precision': 0.2033534540576794, 'recall': 0.789377766206717, 'f1-score': 0.32339608554210447, 'support': 3841}, '1': {'precision': 0.9535063429712152, 'recall': 0.6544385759430731, 'f1-score': 0.7761600859662687, 'support': 45251}, '2': {'precision': 0.29069440539780717, 'recall': 0.5182957393483709, 'f1-score': 0.372478386167147, 'support': 3990}, 'accuracy': 0.6539693304698391, 'macro avg': {'precision': 0.4825180674755672, 'recall': 0.654037360499387, 'f1-score': 0.4906781858918401, 'support': 53082}, 'weighted avg': {'precision': 0.8494040695596108, 'recall': 0.6539693304698391, 'f1-score': 0.7130547676318482, 'support': 53082}}
[[ 3032   494   315]
 [10906 29614  4731]
 [  972   950  2068]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8641701
{'0': {'precision': 0.2592708988057825, 'recall': 0.7721827031074504, 'f1-score': 0.3881987577639751, 'support': 5342}, '1': {'precision': 0.9190526208789347, 'recall': 0.6431603158418894, 'f1-score': 0.7567446921295651, 'support': 42173}, '2': {'precision': 0.36806371588980286, 'recall': 0.5063768636608587, 'f1-score': 0.42628156661122035, 'support': 5567}, 'accuracy': 0.6417994800497344, 'macro avg': {'precision': 0.5154624118581733, 'recall': 0.6405732942033996, 'f1-score': 0.5237416721682535, 'support': 53082}, 'weighted avg': {'precision': 0.7948691087017508, 'recall': 0.6417994800497344, 'f1-score': 0.68499794933273, 'support': 53082}}
[[ 4125   827   390]
 [10599 27124  4450]
 [ 1186  1562  2819]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8788885
{'0': {'precision': 0.2934646374216652, 'recall': 0.755880092236741, 'f1-score': 0.42278589853826315, 'support': 6505}, '1': {'precision': 0.8854365500176741, 'recall': 0.6296408013473092, 'f1-score': 0.7359452352621451, 'support': 39783}, '2': {'precision': 0.41246733855916384, 'recall': 0.48793052693553135, 'f1-score': 0.4470366125008428, 'support': 6794}, 'accuracy': 0.6269733619682755, 'macro avg': {'precision': 0.5304561753328344, 'recall': 0.6244838068398605, 'f1-score': 0.5352559154337504, 'support': 53082}, 'weighted avg': {'precision': 0.7523569728712562, 'recall': 0.6269733619682755, 'f1-score': 0.6605911290033541, 'support': 53082}}
[[ 4917  1159   429]
 [10441 25049  4293]
 [ 1397  2082  3315]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9100097
{'0': {'precision': 0.34799333984038583, 'recall': 0.7089718095683706, 'f1-score': 0.4668412539474698, 'support': 8549}, '1': {'precision': 0.8158646451329378, 'recall': 0.6240685752703232, 'f1-score': 0.7071931940829154, 'support': 35698}, '2': {'precision': 0.4642899868405312, 'recall': 0.43927560837577817, 'f1-score': 0.45143654763289526, 'support': 8835}, 'accuracy': 0.6069854187860292, 'macro avg': {'precision': 0.5427159906046183, 'recall': 0.5907719977381573, 'f1-score': 0.5418236652210934, 'support': 53082}, 'weighted avg': {'precision': 0.6819964055232878, 'recall': 0.6069854187860292, 'f1-score': 0.6259155725237455, 'support': 53082}}
[[ 6061  1915   573]
 [ 9515 22278  3905]
 [ 1841  3113  3881]]
