This machine has 1 visible gpus.
This machine has 1 physical gpus.
training model: results/EXC/W0/deepLOB_L1/seq2seq
Epoch 1/50
1497/1497 - 54s - loss: 11.0742 - accuracy10: 0.5053 - accuracy20: 0.5200 - accuracy30: 0.5194 - accuracy50: 0.5111 - val_loss: 11.0548 - val_accuracy10: 0.5981 - val_accuracy20: 0.5865 - val_accuracy30: 0.5675 - val_accuracy50: 0.5305 - 54s/epoch - 36ms/step
Epoch 2/50
1497/1497 - 41s - loss: 10.2445 - accuracy10: 0.5903 - accuracy20: 0.5935 - accuracy30: 0.5813 - accuracy50: 0.5566 - val_loss: 10.3951 - val_accuracy10: 0.6342 - val_accuracy20: 0.6213 - val_accuracy30: 0.5995 - val_accuracy50: 0.5587 - 41s/epoch - 28ms/step
Epoch 3/50
1497/1497 - 42s - loss: 9.8247 - accuracy10: 0.6220 - accuracy20: 0.6175 - accuracy30: 0.5989 - accuracy50: 0.5696 - val_loss: 9.8960 - val_accuracy10: 0.6475 - val_accuracy20: 0.6338 - val_accuracy30: 0.6077 - val_accuracy50: 0.5672 - 42s/epoch - 28ms/step
Epoch 4/50
1497/1497 - 43s - loss: 9.6159 - accuracy10: 0.6328 - accuracy20: 0.6268 - accuracy30: 0.6057 - accuracy50: 0.5747 - val_loss: 9.6747 - val_accuracy10: 0.6705 - val_accuracy20: 0.6505 - val_accuracy30: 0.6208 - val_accuracy50: 0.5743 - 43s/epoch - 29ms/step
Epoch 5/50
1497/1497 - 42s - loss: 9.4852 - accuracy10: 0.6391 - accuracy20: 0.6334 - accuracy30: 0.6117 - accuracy50: 0.5788 - val_loss: 9.5308 - val_accuracy10: 0.6710 - val_accuracy20: 0.6514 - val_accuracy30: 0.6219 - val_accuracy50: 0.5768 - 42s/epoch - 28ms/step
Epoch 6/50
1497/1497 - 41s - loss: 9.3969 - accuracy10: 0.6417 - accuracy20: 0.6372 - accuracy30: 0.6155 - accuracy50: 0.5823 - val_loss: 9.5486 - val_accuracy10: 0.6747 - val_accuracy20: 0.6536 - val_accuracy30: 0.6240 - val_accuracy50: 0.5791 - 41s/epoch - 27ms/step
Epoch 7/50
1497/1497 - 41s - loss: 9.3214 - accuracy10: 0.6448 - accuracy20: 0.6409 - accuracy30: 0.6192 - accuracy50: 0.5851 - val_loss: 9.5078 - val_accuracy10: 0.6813 - val_accuracy20: 0.6613 - val_accuracy30: 0.6313 - val_accuracy50: 0.5829 - 41s/epoch - 27ms/step
Epoch 8/50
1497/1497 - 41s - loss: 9.2662 - accuracy10: 0.6475 - accuracy20: 0.6431 - accuracy30: 0.6213 - accuracy50: 0.5866 - val_loss: 9.5336 - val_accuracy10: 0.6801 - val_accuracy20: 0.6588 - val_accuracy30: 0.6281 - val_accuracy50: 0.5799 - 41s/epoch - 27ms/step
Epoch 9/50
1497/1497 - 41s - loss: 9.2230 - accuracy10: 0.6496 - accuracy20: 0.6450 - accuracy30: 0.6234 - accuracy50: 0.5885 - val_loss: 9.4618 - val_accuracy10: 0.6813 - val_accuracy20: 0.6592 - val_accuracy30: 0.6280 - val_accuracy50: 0.5799 - 41s/epoch - 28ms/step
Epoch 10/50
1497/1497 - 42s - loss: 9.1895 - accuracy10: 0.6516 - accuracy20: 0.6460 - accuracy30: 0.6244 - accuracy50: 0.5900 - val_loss: 9.4713 - val_accuracy10: 0.6766 - val_accuracy20: 0.6554 - val_accuracy30: 0.6253 - val_accuracy50: 0.5792 - 42s/epoch - 28ms/step
Epoch 11/50
1497/1497 - 41s - loss: 9.1591 - accuracy10: 0.6519 - accuracy20: 0.6470 - accuracy30: 0.6253 - accuracy50: 0.5909 - val_loss: 9.4670 - val_accuracy10: 0.6763 - val_accuracy20: 0.6553 - val_accuracy30: 0.6259 - val_accuracy50: 0.5805 - 41s/epoch - 28ms/step
Epoch 12/50
1497/1497 - 41s - loss: 9.1297 - accuracy10: 0.6533 - accuracy20: 0.6479 - accuracy30: 0.6266 - accuracy50: 0.5927 - val_loss: 9.4877 - val_accuracy10: 0.6785 - val_accuracy20: 0.6542 - val_accuracy30: 0.6248 - val_accuracy50: 0.5775 - 41s/epoch - 27ms/step
Epoch 13/50
1497/1497 - 41s - loss: 9.1029 - accuracy10: 0.6543 - accuracy20: 0.6484 - accuracy30: 0.6276 - accuracy50: 0.5930 - val_loss: 9.4437 - val_accuracy10: 0.6742 - val_accuracy20: 0.6514 - val_accuracy30: 0.6211 - val_accuracy50: 0.5759 - 41s/epoch - 27ms/step
Epoch 14/50
1497/1497 - 41s - loss: 9.0830 - accuracy10: 0.6555 - accuracy20: 0.6502 - accuracy30: 0.6289 - accuracy50: 0.5939 - val_loss: 9.4529 - val_accuracy10: 0.6705 - val_accuracy20: 0.6492 - val_accuracy30: 0.6195 - val_accuracy50: 0.5765 - 41s/epoch - 28ms/step
Epoch 15/50
1497/1497 - 40s - loss: 9.0632 - accuracy10: 0.6570 - accuracy20: 0.6506 - accuracy30: 0.6296 - accuracy50: 0.5942 - val_loss: 9.4879 - val_accuracy10: 0.6736 - val_accuracy20: 0.6503 - val_accuracy30: 0.6208 - val_accuracy50: 0.5762 - 40s/epoch - 27ms/step
Epoch 16/50
1497/1497 - 41s - loss: 9.0388 - accuracy10: 0.6585 - accuracy20: 0.6516 - accuracy30: 0.6307 - accuracy50: 0.5957 - val_loss: 9.4969 - val_accuracy10: 0.6675 - val_accuracy20: 0.6451 - val_accuracy30: 0.6167 - val_accuracy50: 0.5749 - 41s/epoch - 28ms/step
Epoch 17/50
1497/1497 - 41s - loss: 9.0168 - accuracy10: 0.6590 - accuracy20: 0.6524 - accuracy30: 0.6317 - accuracy50: 0.5969 - val_loss: 9.4803 - val_accuracy10: 0.6693 - val_accuracy20: 0.6470 - val_accuracy30: 0.6198 - val_accuracy50: 0.5764 - 41s/epoch - 27ms/step
Epoch 18/50
1497/1497 - 41s - loss: 8.9990 - accuracy10: 0.6592 - accuracy20: 0.6525 - accuracy30: 0.6316 - accuracy50: 0.5959 - val_loss: 9.4432 - val_accuracy10: 0.6628 - val_accuracy20: 0.6419 - val_accuracy30: 0.6151 - val_accuracy50: 0.5719 - 41s/epoch - 28ms/step
Epoch 19/50
1497/1497 - 41s - loss: 8.9824 - accuracy10: 0.6605 - accuracy20: 0.6535 - accuracy30: 0.6330 - accuracy50: 0.5980 - val_loss: 9.4829 - val_accuracy10: 0.6677 - val_accuracy20: 0.6439 - val_accuracy30: 0.6152 - val_accuracy50: 0.5706 - 41s/epoch - 27ms/step
Epoch 20/50
1497/1497 - 42s - loss: 8.9633 - accuracy10: 0.6610 - accuracy20: 0.6537 - accuracy30: 0.6332 - accuracy50: 0.5979 - val_loss: 9.5025 - val_accuracy10: 0.6618 - val_accuracy20: 0.6394 - val_accuracy30: 0.6119 - val_accuracy50: 0.5694 - 42s/epoch - 28ms/step
Epoch 21/50
1497/1497 - 42s - loss: 8.9465 - accuracy10: 0.6612 - accuracy20: 0.6541 - accuracy30: 0.6341 - accuracy50: 0.5982 - val_loss: 9.5680 - val_accuracy10: 0.6645 - val_accuracy20: 0.6391 - val_accuracy30: 0.6094 - val_accuracy50: 0.5666 - 42s/epoch - 28ms/step
Epoch 22/50
1497/1497 - 42s - loss: 8.9340 - accuracy10: 0.6621 - accuracy20: 0.6553 - accuracy30: 0.6351 - accuracy50: 0.5995 - val_loss: 9.5604 - val_accuracy10: 0.6653 - val_accuracy20: 0.6401 - val_accuracy30: 0.6110 - val_accuracy50: 0.5676 - 42s/epoch - 28ms/step
Epoch 23/50
1497/1497 - 43s - loss: 8.9170 - accuracy10: 0.6627 - accuracy20: 0.6556 - accuracy30: 0.6354 - accuracy50: 0.6001 - val_loss: 9.5185 - val_accuracy10: 0.6579 - val_accuracy20: 0.6357 - val_accuracy30: 0.6080 - val_accuracy50: 0.5654 - 43s/epoch - 29ms/step
Epoch 24/50
1497/1497 - 41s - loss: 8.9015 - accuracy10: 0.6633 - accuracy20: 0.6565 - accuracy30: 0.6356 - accuracy50: 0.6003 - val_loss: 9.5354 - val_accuracy10: 0.6633 - val_accuracy20: 0.6408 - val_accuracy30: 0.6133 - val_accuracy50: 0.5679 - 41s/epoch - 28ms/step
Epoch 25/50
1497/1497 - 41s - loss: 8.8936 - accuracy10: 0.6629 - accuracy20: 0.6564 - accuracy30: 0.6358 - accuracy50: 0.6002 - val_loss: 9.5569 - val_accuracy10: 0.6593 - val_accuracy20: 0.6366 - val_accuracy30: 0.6076 - val_accuracy50: 0.5638 - 41s/epoch - 27ms/step
Epoch 26/50
1497/1497 - 41s - loss: 8.8702 - accuracy10: 0.6641 - accuracy20: 0.6576 - accuracy30: 0.6377 - accuracy50: 0.6021 - val_loss: 9.6183 - val_accuracy10: 0.6585 - val_accuracy20: 0.6364 - val_accuracy30: 0.6073 - val_accuracy50: 0.5619 - 41s/epoch - 27ms/step
Epoch 27/50
1497/1497 - 41s - loss: 8.8583 - accuracy10: 0.6640 - accuracy20: 0.6575 - accuracy30: 0.6370 - accuracy50: 0.6019 - val_loss: 9.7097 - val_accuracy10: 0.6602 - val_accuracy20: 0.6339 - val_accuracy30: 0.6039 - val_accuracy50: 0.5610 - 41s/epoch - 28ms/step
Epoch 28/50
1497/1497 - 41s - loss: 8.8487 - accuracy10: 0.6651 - accuracy20: 0.6580 - accuracy30: 0.6380 - accuracy50: 0.6022 - val_loss: 9.6637 - val_accuracy10: 0.6552 - val_accuracy20: 0.6302 - val_accuracy30: 0.6001 - val_accuracy50: 0.5569 - 41s/epoch - 27ms/step
testing model: results/EXC/W0/deepLOB_L1/seq2seq
Evaluating performance on  test set...
4693/4693 - 65s - 65s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6846791
{'0': {'precision': 0.3312505919868658, 'recall': 0.766959560221059, 'f1-score': 0.4626724818422759, 'support': 136796}, '1': {'precision': 0.9281941346166829, 'recall': 0.6683532380442109, 'f1-score': 0.7771289045695843, 'support': 925744}, '2': {'precision': 0.3790465087459208, 'recall': 0.5956206906499726, 'f1-score': 0.4632718603183507, 'support': 138652}, 'accuracy': 0.6711874537958961, 'macro avg': {'precision': 0.5461637451164898, 'recall': 0.6769778296384142, 'f1-score': 0.5676910822434037, 'support': 1201192}, 'weighted avg': {'precision': 0.7968247070149161, 'recall': 0.6711874537958961, 'f1-score': 0.7050893907342217, 'support': 1201192}}
[[104917  18294  13585]
 [185316 618724 121704]
 [ 26497  29571  82584]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7277047
{'0': {'precision': 0.39953102553926473, 'recall': 0.7509021667760998, 'f1-score': 0.5215578180040388, 'support': 190375}, '1': {'precision': 0.8782290037646008, 'recall': 0.6433010640675395, 'f1-score': 0.7426283115412893, 'support': 818839}, '2': {'precision': 0.4586726986107918, 'recall': 0.581988561189303, 'f1-score': 0.5130243129692128, 'support': 191978}, 'accuracy': 0.6505554482547337, 'macro avg': {'precision': 0.5788109093048858, 'recall': 0.6587305973443142, 'f1-score': 0.5924034808381803, 'support': 1201192}, 'weighted avg': {'precision': 0.7353062171031293, 'recall': 0.6505554482547337, 'f1-score': 0.6708952233713513, 'support': 1201192}}
[[142953  28844  18578]
 [178794 526760 113285]
 [ 36055  44194 111729]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7759448
{'0': {'precision': 0.425403063887885, 'recall': 0.7409555866410211, 'f1-score': 0.5404937437022488, 'support': 228760}, '1': {'precision': 0.8281130351468429, 'recall': 0.6028651566625867, 'f1-score': 0.6977611504153767, 'support': 742647}, '2': {'precision': 0.4953834062068387, 'recall': 0.5650455860913463, 'f1-score': 0.5279263564709494, 'support': 229785}, 'accuracy': 0.6219288839752513, 'macro avg': {'precision': 0.5829665017471889, 'recall': 0.6362887764649847, 'f1-score': 0.588727083529525, 'support': 1201192}, 'weighted avg': {'precision': 0.687768934610727, 'recall': 0.6219288839752513, 'f1-score': 0.6353215237060618, 'support': 1201192}}
[[169501  36860  22399]
 [185071 447716 109860]
 [ 43876  56070 129839]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8455115
{'0': {'precision': 0.45631144762120013, 'recall': 0.7056822987846865, 'f1-score': 0.5542386304833304, 'support': 286099}, '1': {'precision': 0.7235245872559065, 'recall': 0.552544760824039, 'f1-score': 0.6265799278341107, 'support': 627446}, '2': {'precision': 0.5341505377882542, 'recall': 0.5191536848985041, 'f1-score': 0.5265453494071063, 'support': 287647}, 'accuracy': 0.5810228506350359, 'macro avg': {'precision': 0.5713288575551202, 'recall': 0.5924602481690765, 'f1-score': 0.5691213025748492, 'support': 1201192}, 'weighted avg': {'precision': 0.6145309465693454, 'recall': 0.5810228506350359, 'f1-score': 0.5853946558613091, 'support': 1201192}}
[[201895  53902  30302]
 [180818 346692  99936]
 [ 59737  78577 149333]]
Evaluating performance on  train set...
1497/1497 - 22s - 22s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7075886
{'0': {'precision': 0.3544135487940991, 'recall': 0.7404095701540957, 'f1-score': 0.47936726723770146, 'support': 49320}, '1': {'precision': 0.9101059896475228, 'recall': 0.6525919510772548, 'f1-score': 0.7601313446355596, 'support': 282895}, '2': {'precision': 0.3955917374197556, 'recall': 0.6000903129540189, 'f1-score': 0.4768405123324857, 'support': 50934}, 'accuracy': 0.6569167608423877, 'macro avg': {'precision': 0.5533704252871258, 'recall': 0.6643639447284565, 'f1-score': 0.5721130414019157, 'support': 383149}, 'weighted avg': {'precision': 0.7701786503986667, 'recall': 0.6569167608423877, 'f1-score': 0.6863312836937664, 'support': 383149}}
[[ 36517   7491   5312]
 [ 56893 184615  41387]
 [  9625  10744  30565]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.75457245
{'0': {'precision': 0.425115347784452, 'recall': 0.724697257509201, 'f1-score': 0.5358784992373281, 'support': 67384}, '1': {'precision': 0.8518461707023118, 'recall': 0.6298750749388337, 'f1-score': 0.7242342946568299, 'support': 246868}, '2': {'precision': 0.4638495900348733, 'recall': 0.5772384864362744, 'f1-score': 0.5143692283814895, 'support': 68897}, 'accuracy': 0.6370863554387458, 'macro avg': {'precision': 0.5802703695072123, 'recall': 0.643936939628103, 'f1-score': 0.5914940074252159, 'support': 383149}, 'weighted avg': {'precision': 0.7070288015071904, 'recall': 0.6370863554387458, 'f1-score': 0.6533708958492646, 'support': 383149}}
[[ 48833  11240   7311]
 [ 52714 155496  38658]
 [ 13323  15804  39770]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8072733
{'0': {'precision': 0.4507828121171887, 'recall': 0.7135815443126657, 'f1-score': 0.5525251497847071, 'support': 79932}, '1': {'precision': 0.7957503062350673, 'recall': 0.5918482403402505, 'f1-score': 0.6788179760750082, 'support': 221719}, '2': {'precision': 0.4942864619678995, 'recall': 0.5562345088223024, 'f1-score': 0.5234339818717164, 'support': 81498}, 'accuracy': 0.6096688233559268, 'macro avg': {'precision': 0.5802731934400518, 'recall': 0.6205547644917395, 'f1-score': 0.5849257025771439, 'support': 383149}, 'weighted avg': {'precision': 0.6596605810369958, 'recall': 0.6096688233559268, 'f1-score': 0.6194198752040253, 'support': 383149}}
[[ 57038  13983   8911]
 [ 53026 131224  37469]
 [ 16467  19699  45332]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.88028306
{'0': {'precision': 0.4824188339772793, 'recall': 0.6768852657982037, 'f1-score': 0.5633417508417509, 'support': 98872}, '1': {'precision': 0.6790941240478782, 'recall': 0.5434911580769294, 'f1-score': 0.6037724440467157, 'support': 183727}, '2': {'precision': 0.5262525543997288, 'recall': 0.5096668324216808, 'f1-score': 0.5178269194820417, 'support': 100550}, 'accuracy': 0.5690371108889754, 'macro avg': {'precision': 0.5625885041416288, 'recall': 0.5766810854322713, 'f1-score': 0.5616470381235027, 'support': 383149}, 'weighted avg': {'precision': 0.5882315637698098, 'recall': 0.5690371108889754, 'f1-score': 0.5707845307452605, 'support': 383149}}
[[66925 20077 11870]
 [49609 99854 34264]
 [22194 27109 51247]]
Evaluating performance on  val set...
547/547 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6970575
{'0': {'precision': 0.34705848021477764, 'recall': 0.7104115644226748, 'f1-score': 0.4663098668862357, 'support': 16741}, '1': {'precision': 0.9149538961975839, 'recall': 0.6608717895275359, 'f1-score': 0.7674290680660527, 'support': 105553}, '2': {'precision': 0.378461328604556, 'recall': 0.6327612748731398, 'f1-score': 0.4736359174615368, 'support': 17539}, 'accuracy': 0.663276908884169, 'macro avg': {'precision': 0.5468245683389725, 'recall': 0.6680148762744502, 'f1-score': 0.5691249508046085, 'support': 139833}, 'weighted avg': {'precision': 0.7796733808544084, 'recall': 0.663276908884169, 'f1-score': 0.6945287182530335, 'support': 139833}}
[[11893  3036  1812]
 [19382 69757 16414]
 [ 2993  3448 11098]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.74609905
{'0': {'precision': 0.41745632025753526, 'recall': 0.6967071057192374, 'f1-score': 0.522086397506453, 'support': 23080}, '1': {'precision': 0.8591103856355846, 'recall': 0.6356088461414046, 'f1-score': 0.7306498094264201, 'support': 92741}, '2': {'precision': 0.44938837920489294, 'recall': 0.6119856738297518, 'f1-score': 0.5182324728452532, 'support': 24012}, 'accuracy': 0.6416368096229074, 'macro avg': {'precision': 0.5753183616993376, 'recall': 0.6481005418967979, 'f1-score': 0.5903228932593755, 'support': 139833}, 'weighted avg': {'precision': 0.7158564995905228, 'recall': 0.6416368096229074, 'f1-score': 0.6597494594868506, 'support': 139833}}
[[16080  4502  2498]
 [18287 58947 15507]
 [ 4152  5165 14695]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7977377
{'0': {'precision': 0.4458516715048225, 'recall': 0.690161261098025, 'f1-score': 0.5417360014791427, 'support': 27595}, '1': {'precision': 0.8044193548387096, 'recall': 0.5965361337703036, 'f1-score': 0.6850541873274453, 'support': 83606}, '2': {'precision': 0.48318478229917133, 'recall': 0.5926236378876781, 'f1-score': 0.5323377621609751, 'support': 28632}, 'accuracy': 0.6142112376906739, 'macro avg': {'precision': 0.5778186028809011, 'recall': 0.6264403442520022, 'f1-score': 0.5863759836558543, 'support': 139833}, 'weighted avg': {'precision': 0.6678831759499589, 'recall': 0.6142112376906739, 'f1-score': 0.6255014206425406, 'support': 139833}}
[[19045  5565  2985]
 [18568 49874 15164]
 [ 5103  6561 16968]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8721973
{'0': {'precision': 0.48278866176533086, 'recall': 0.6543312982375302, 'f1-score': 0.5556207663903359, 'support': 34724}, '1': {'precision': 0.6871040150610043, 'recall': 0.5460338924533188, 'f1-score': 0.60849979159319, 'support': 69514}, '2': {'precision': 0.5138959204881558, 'recall': 0.5418176710212108, 'f1-score': 0.5274875553853727, 'support': 35595}, 'accuracy': 0.5718535681849063, 'macro avg': {'precision': 0.561262865771497, 'recall': 0.5807276205706866, 'f1-score': 0.5638693711229662, 'support': 139833}, 'weighted avg': {'precision': 0.5922766963725722, 'recall': 0.5718535681849063, 'f1-score': 0.5747466587921977, 'support': 139833}}
[[22721  7929  4074]
 [17388 37957 14169]
 [ 6953  9356 19286]]
training model: results/EXC/W0/deepOF_L1/seq2seq
Epoch 1/50
1497/1497 - 47s - loss: 12.2855 - accuracy10: 0.4088 - accuracy20: 0.4354 - accuracy30: 0.4464 - accuracy50: 0.4534 - val_loss: 11.7013 - val_accuracy10: 0.4559 - val_accuracy20: 0.4631 - val_accuracy30: 0.4611 - val_accuracy50: 0.4594 - 47s/epoch - 31ms/step
Epoch 2/50
1497/1497 - 40s - loss: 11.9473 - accuracy10: 0.4503 - accuracy20: 0.4729 - accuracy30: 0.4832 - accuracy50: 0.4849 - val_loss: 11.4427 - val_accuracy10: 0.4292 - val_accuracy20: 0.4550 - val_accuracy30: 0.4655 - val_accuracy50: 0.4727 - 40s/epoch - 27ms/step
Epoch 3/50
1497/1497 - 38s - loss: 11.7835 - accuracy10: 0.4653 - accuracy20: 0.4874 - accuracy30: 0.4978 - accuracy50: 0.4968 - val_loss: 11.2849 - val_accuracy10: 0.4735 - val_accuracy20: 0.4873 - val_accuracy30: 0.4933 - val_accuracy50: 0.4915 - 38s/epoch - 26ms/step
Epoch 4/50
1497/1497 - 38s - loss: 11.6380 - accuracy10: 0.4803 - accuracy20: 0.4979 - accuracy30: 0.5059 - accuracy50: 0.5037 - val_loss: 11.2660 - val_accuracy10: 0.4569 - val_accuracy20: 0.4742 - val_accuracy30: 0.4814 - val_accuracy50: 0.4855 - 38s/epoch - 25ms/step
Epoch 5/50
1497/1497 - 39s - loss: 11.5358 - accuracy10: 0.4918 - accuracy20: 0.5073 - accuracy30: 0.5128 - accuracy50: 0.5086 - val_loss: 11.1069 - val_accuracy10: 0.4984 - val_accuracy20: 0.5069 - val_accuracy30: 0.5062 - val_accuracy50: 0.5009 - 39s/epoch - 26ms/step
Epoch 6/50
1497/1497 - 39s - loss: 11.4360 - accuracy10: 0.5031 - accuracy20: 0.5163 - accuracy30: 0.5188 - accuracy50: 0.5129 - val_loss: 11.0045 - val_accuracy10: 0.5199 - val_accuracy20: 0.5235 - val_accuracy30: 0.5176 - val_accuracy50: 0.5072 - 39s/epoch - 26ms/step
Epoch 7/50
1497/1497 - 38s - loss: 11.3521 - accuracy10: 0.5116 - accuracy20: 0.5236 - accuracy30: 0.5247 - accuracy50: 0.5166 - val_loss: 10.9627 - val_accuracy10: 0.5327 - val_accuracy20: 0.5311 - val_accuracy30: 0.5216 - val_accuracy50: 0.5077 - 38s/epoch - 26ms/step
Epoch 8/50
1497/1497 - 38s - loss: 11.2635 - accuracy10: 0.5171 - accuracy20: 0.5293 - accuracy30: 0.5299 - accuracy50: 0.5215 - val_loss: 10.8929 - val_accuracy10: 0.5297 - val_accuracy20: 0.5334 - val_accuracy30: 0.5249 - val_accuracy50: 0.5113 - 38s/epoch - 25ms/step
Epoch 9/50
1497/1497 - 38s - loss: 11.2095 - accuracy10: 0.5210 - accuracy20: 0.5329 - accuracy30: 0.5332 - accuracy50: 0.5238 - val_loss: 10.9097 - val_accuracy10: 0.5303 - val_accuracy20: 0.5307 - val_accuracy30: 0.5210 - val_accuracy50: 0.5073 - 38s/epoch - 26ms/step
Epoch 10/50
1497/1497 - 38s - loss: 11.1453 - accuracy10: 0.5249 - accuracy20: 0.5368 - accuracy30: 0.5353 - accuracy50: 0.5250 - val_loss: 10.8647 - val_accuracy10: 0.5407 - val_accuracy20: 0.5387 - val_accuracy30: 0.5255 - val_accuracy50: 0.5101 - 38s/epoch - 25ms/step
Epoch 11/50
1497/1497 - 38s - loss: 11.0964 - accuracy10: 0.5285 - accuracy20: 0.5405 - accuracy30: 0.5386 - accuracy50: 0.5277 - val_loss: 10.8291 - val_accuracy10: 0.5353 - val_accuracy20: 0.5350 - val_accuracy30: 0.5238 - val_accuracy50: 0.5085 - 38s/epoch - 25ms/step
Epoch 12/50
1497/1497 - 38s - loss: 11.0401 - accuracy10: 0.5317 - accuracy20: 0.5436 - accuracy30: 0.5412 - accuracy50: 0.5290 - val_loss: 10.8972 - val_accuracy10: 0.5232 - val_accuracy20: 0.5255 - val_accuracy30: 0.5174 - val_accuracy50: 0.5053 - 38s/epoch - 26ms/step
Epoch 13/50
1497/1497 - 38s - loss: 10.9733 - accuracy10: 0.5375 - accuracy20: 0.5485 - accuracy30: 0.5447 - accuracy50: 0.5321 - val_loss: 10.8632 - val_accuracy10: 0.5319 - val_accuracy20: 0.5327 - val_accuracy30: 0.5214 - val_accuracy50: 0.5060 - 38s/epoch - 26ms/step
Epoch 14/50
1497/1497 - 38s - loss: 10.9351 - accuracy10: 0.5391 - accuracy20: 0.5500 - accuracy30: 0.5463 - accuracy50: 0.5334 - val_loss: 10.8024 - val_accuracy10: 0.5349 - val_accuracy20: 0.5363 - val_accuracy30: 0.5251 - val_accuracy50: 0.5096 - 38s/epoch - 26ms/step
Epoch 15/50
1497/1497 - 38s - loss: 10.8876 - accuracy10: 0.5420 - accuracy20: 0.5522 - accuracy30: 0.5489 - accuracy50: 0.5352 - val_loss: 10.7703 - val_accuracy10: 0.5452 - val_accuracy20: 0.5441 - val_accuracy30: 0.5314 - val_accuracy50: 0.5122 - 38s/epoch - 26ms/step
Epoch 16/50
1497/1497 - 39s - loss: 10.8412 - accuracy10: 0.5430 - accuracy20: 0.5539 - accuracy30: 0.5504 - accuracy50: 0.5375 - val_loss: 10.7948 - val_accuracy10: 0.5426 - val_accuracy20: 0.5427 - val_accuracy30: 0.5294 - val_accuracy50: 0.5108 - 39s/epoch - 26ms/step
Epoch 17/50
1497/1497 - 39s - loss: 10.8154 - accuracy10: 0.5458 - accuracy20: 0.5559 - accuracy30: 0.5524 - accuracy50: 0.5386 - val_loss: 10.8184 - val_accuracy10: 0.5300 - val_accuracy20: 0.5307 - val_accuracy30: 0.5190 - val_accuracy50: 0.5037 - 39s/epoch - 26ms/step
Epoch 18/50
1497/1497 - 38s - loss: 10.7717 - accuracy10: 0.5486 - accuracy20: 0.5583 - accuracy30: 0.5533 - accuracy50: 0.5388 - val_loss: 10.7636 - val_accuracy10: 0.5421 - val_accuracy20: 0.5394 - val_accuracy30: 0.5262 - val_accuracy50: 0.5081 - 38s/epoch - 25ms/step
Epoch 19/50
1497/1497 - 39s - loss: 10.7297 - accuracy10: 0.5516 - accuracy20: 0.5610 - accuracy30: 0.5562 - accuracy50: 0.5410 - val_loss: 10.7516 - val_accuracy10: 0.5341 - val_accuracy20: 0.5367 - val_accuracy30: 0.5253 - val_accuracy50: 0.5084 - 39s/epoch - 26ms/step
Epoch 20/50
1497/1497 - 38s - loss: 10.6991 - accuracy10: 0.5536 - accuracy20: 0.5628 - accuracy30: 0.5579 - accuracy50: 0.5425 - val_loss: 10.7515 - val_accuracy10: 0.5368 - val_accuracy20: 0.5380 - val_accuracy30: 0.5258 - val_accuracy50: 0.5093 - 38s/epoch - 26ms/step
Epoch 21/50
1497/1497 - 38s - loss: 10.6672 - accuracy10: 0.5552 - accuracy20: 0.5639 - accuracy30: 0.5594 - accuracy50: 0.5437 - val_loss: 10.6776 - val_accuracy10: 0.5386 - val_accuracy20: 0.5408 - val_accuracy30: 0.5294 - val_accuracy50: 0.5111 - 38s/epoch - 25ms/step
Epoch 22/50
1497/1497 - 38s - loss: 10.6289 - accuracy10: 0.5572 - accuracy20: 0.5666 - accuracy30: 0.5613 - accuracy50: 0.5457 - val_loss: 10.7405 - val_accuracy10: 0.5370 - val_accuracy20: 0.5383 - val_accuracy30: 0.5256 - val_accuracy50: 0.5075 - 38s/epoch - 26ms/step
Epoch 23/50
1497/1497 - 38s - loss: 10.6014 - accuracy10: 0.5587 - accuracy20: 0.5682 - accuracy30: 0.5631 - accuracy50: 0.5470 - val_loss: 10.8037 - val_accuracy10: 0.5397 - val_accuracy20: 0.5404 - val_accuracy30: 0.5289 - val_accuracy50: 0.5098 - 38s/epoch - 26ms/step
Epoch 24/50
1497/1497 - 38s - loss: 10.5609 - accuracy10: 0.5609 - accuracy20: 0.5696 - accuracy30: 0.5641 - accuracy50: 0.5488 - val_loss: 10.8132 - val_accuracy10: 0.5313 - val_accuracy20: 0.5342 - val_accuracy30: 0.5247 - val_accuracy50: 0.5071 - 38s/epoch - 25ms/step
Epoch 25/50
1497/1497 - 38s - loss: 10.5336 - accuracy10: 0.5619 - accuracy20: 0.5708 - accuracy30: 0.5656 - accuracy50: 0.5494 - val_loss: 10.8097 - val_accuracy10: 0.5347 - val_accuracy20: 0.5361 - val_accuracy30: 0.5252 - val_accuracy50: 0.5080 - 38s/epoch - 26ms/step
Epoch 26/50
1497/1497 - 38s - loss: 10.5063 - accuracy10: 0.5636 - accuracy20: 0.5715 - accuracy30: 0.5662 - accuracy50: 0.5505 - val_loss: 10.7397 - val_accuracy10: 0.5438 - val_accuracy20: 0.5439 - val_accuracy30: 0.5331 - val_accuracy50: 0.5141 - 38s/epoch - 25ms/step
Epoch 27/50
1497/1497 - 39s - loss: 10.5046 - accuracy10: 0.5628 - accuracy20: 0.5720 - accuracy30: 0.5666 - accuracy50: 0.5507 - val_loss: 10.7758 - val_accuracy10: 0.5423 - val_accuracy20: 0.5440 - val_accuracy30: 0.5330 - val_accuracy50: 0.5143 - 39s/epoch - 26ms/step
Epoch 28/50
1497/1497 - 40s - loss: 10.4581 - accuracy10: 0.5656 - accuracy20: 0.5741 - accuracy30: 0.5692 - accuracy50: 0.5537 - val_loss: 10.7838 - val_accuracy10: 0.5408 - val_accuracy20: 0.5418 - val_accuracy30: 0.5304 - val_accuracy50: 0.5119 - 40s/epoch - 27ms/step
Epoch 29/50
1497/1497 - 40s - loss: 10.4223 - accuracy10: 0.5675 - accuracy20: 0.5756 - accuracy30: 0.5701 - accuracy50: 0.5543 - val_loss: 10.7907 - val_accuracy10: 0.5481 - val_accuracy20: 0.5466 - val_accuracy30: 0.5329 - val_accuracy50: 0.5131 - 40s/epoch - 26ms/step
Epoch 30/50
1497/1497 - 39s - loss: 10.3986 - accuracy10: 0.5689 - accuracy20: 0.5769 - accuracy30: 0.5713 - accuracy50: 0.5548 - val_loss: 10.7967 - val_accuracy10: 0.5388 - val_accuracy20: 0.5387 - val_accuracy30: 0.5270 - val_accuracy50: 0.5099 - 39s/epoch - 26ms/step
Epoch 31/50
1497/1497 - 38s - loss: 10.3683 - accuracy10: 0.5703 - accuracy20: 0.5783 - accuracy30: 0.5729 - accuracy50: 0.5552 - val_loss: 10.7913 - val_accuracy10: 0.5500 - val_accuracy20: 0.5485 - val_accuracy30: 0.5358 - val_accuracy50: 0.5164 - 38s/epoch - 26ms/step
testing model: results/EXC/W0/deepOF_L1/seq2seq
Evaluating performance on  test set...
4693/4693 - 60s - 60s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.89516497
{'0': {'precision': 0.24922741073580834, 'recall': 0.6726757021506792, 'f1-score': 0.36370247842421155, 'support': 136794}, '1': {'precision': 0.9123697534010126, 'recall': 0.5298673605957593, 'f1-score': 0.6703959403489326, 'support': 925743}, '2': {'precision': 0.28553033906366787, 'recall': 0.6061521817526145, 'f1-score': 0.3881983417630892, 'support': 138650}, 'accuracy': 0.5549360757317553, 'macro avg': {'precision': 0.48237583440016296, 'recall': 0.6028984148330178, 'f1-score': 0.47409892017874444, 'support': 1201187}, 'weighted avg': {'precision': 0.7644950441172651, 'recall': 0.5549360757317554, 'f1-score': 0.60289560736626, 'support': 1201187}}
[[ 92018  21819  22957]
 [247882 490521 187340]
 [ 29313  25294  84043]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.90552926
{'0': {'precision': 0.32425630620500756, 'recall': 0.6740871867334128, 'f1-score': 0.4378793927668417, 'support': 190373}, '1': {'precision': 0.8617639976655252, 'recall': 0.5157357132912738, 'f1-score': 0.6452886581240201, 'support': 818838}, '2': {'precision': 0.36563827763333123, 'recall': 0.6006740425886569, 'f1-score': 0.4545723318537674, 'support': 191976}, 'accuracy': 0.5544074319818646, 'macro avg': {'precision': 0.5172195271679546, 'recall': 0.5968323142044478, 'f1-score': 0.512580127581543, 'support': 1201187}, 'weighted avg': {'precision': 0.6972840432743159, 'recall': 0.5544074319818646, 'f1-score': 0.5819362562699373, 'support': 1201187}}
[[128328  31339  30706]
 [227175 422304 169359]
 [ 40258  36403 115315]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9278348
{'0': {'precision': 0.3608638688530705, 'recall': 0.6766714169559097, 'f1-score': 0.4707045028827207, 'support': 228758}, '1': {'precision': 0.8106252936287087, 'recall': 0.48326255039413124, 'f1-score': 0.6055313814449688, 'support': 742646}, '2': {'precision': 0.407047712118775, 'recall': 0.5836854771675886, 'f1-score': 0.4796202260048634, 'support': 229783}, 'accuracy': 0.5393065359515213, 'macro avg': {'precision': 0.5261789582001847, 'recall': 0.5812064815058765, 'f1-score': 0.5186187034441843, 'support': 1201187}, 'weighted avg': {'precision': 0.6477682268931192, 'recall': 0.5393065359515213, 'f1-score': 0.5557681304968346, 'support': 1201187}}
[[154794  37673  36291]
 [224668 358893 159085]
 [ 49492  46170 134121]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.95567507
{'0': {'precision': 0.4049584293083573, 'recall': 0.6593672775317462, 'f1-score': 0.5017568124692457, 'support': 286097}, '1': {'precision': 0.7065952062679163, 'recall': 0.4490266891493451, 'f1-score': 0.5491071211050746, 'support': 627446}, '2': {'precision': 0.45827552914964725, 'recall': 0.5363122470832, 'f1-score': 0.4942324542785242, 'support': 287644}, 'accuracy': 0.5200272730224353, 'macro avg': {'precision': 0.5232763882419736, 'recall': 0.5482354045880972, 'f1-score': 0.5150321292842815, 'support': 1201187}, 'weighted avg': {'precision': 0.5752875562660379, 'recall': 0.5200272730224353, 'f1-score': 0.5246886501139292, 'support': 1201187}}
[[188643  51162  46292]
 [209640 281740 136066]
 [ 67550  65827 154267]]
Evaluating performance on  train set...
1497/1497 - 19s - 19s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.91669065
{'0': {'precision': 0.2710578842315369, 'recall': 0.6467321917114196, 'f1-score': 0.38200861862580804, 'support': 49345}, '1': {'precision': 0.883661290518614, 'recall': 0.5139088669689591, 'f1-score': 0.6498727382833187, 'support': 282949}, '2': {'precision': 0.29524385528311803, 'recall': 0.585558658119322, 'f1-score': 0.3925569990706136, 'support': 50854}, 'accuracy': 0.540524810256089, 'macro avg': {'precision': 0.4833210100110896, 'recall': 0.5820665722665669, 'f1-score': 0.47481278532658006, 'support': 383148}, 'weighted avg': {'precision': 0.7266663555725834, 'recall': 0.540524810256089, 'f1-score': 0.5812222700923774, 'support': 383148}}
[[ 31913   8282   9150]
 [ 75608 145410  61931]
 [ 10214  10862  29778]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.92621547
{'0': {'precision': 0.3485914930971191, 'recall': 0.6480335870161853, 'f1-score': 0.45332793681927386, 'support': 67407}, '1': {'precision': 0.8253349070128762, 'recall': 0.5011783093892227, 'f1-score': 0.6236499542741686, 'support': 246964}, '2': {'precision': 0.36961741339192183, 'recall': 0.5797141486252672, 'f1-score': 0.4514175082650243, 'support': 68777}, 'accuracy': 0.5411120506958147, 'macro avg': {'precision': 0.514514604500639, 'recall': 0.5763086816768918, 'f1-score': 0.5094651331194889, 'support': 383148}, 'weighted avg': {'precision': 0.6596581310396548, 'recall': 0.5411120506958147, 'f1-score': 0.562768709507778, 'support': 383148}}
[[ 43682  11458  12267]
 [ 67458 123773  55733]
 [ 14170  14736  39871]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.94672596
{'0': {'precision': 0.3859008878702241, 'recall': 0.6503168710391121, 'f1-score': 0.48437281792028597, 'support': 80001}, '1': {'precision': 0.7696982628593291, 'recall': 0.47172882762228147, 'f1-score': 0.5849539806976146, 'support': 221763}, '2': {'precision': 0.4098809799142486, 'recall': 0.5661800845375012, 'f1-score': 0.47551624854232677, 'support': 81384}, 'accuracy': 0.5290801465752137, 'macro avg': {'precision': 0.5218267102146006, 'recall': 0.5627419277329649, 'f1-score': 0.5149476823867424, 'support': 383148}, 'weighted avg': {'precision': 0.6131333230665967, 'recall': 0.5290801465752137, 'f1-score': 0.5407071779031982, 'support': 383148}}
[[ 52026  13598  14377]
 [ 65188 104612  51963]
 [ 17603  17703  46078]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.97488356
{'0': {'precision': 0.4299078249291357, 'recall': 0.6335005461385979, 'f1-score': 0.5122149670655868, 'support': 98876}, '1': {'precision': 0.6542139819808077, 'recall': 0.4371397312170349, 'f1-score': 0.5240884248307366, 'support': 183717}, '2': {'precision': 0.4579079074715099, 'recall': 0.5222713937646064, 'f1-score': 0.48797643604467483, 'support': 100555}, 'accuracy': 0.5101553446709888, 'macro avg': {'precision': 0.5140099047938178, 'recall': 0.5309705570400797, 'f1-score': 0.5080932759803327, 'support': 383148}, 'weighted avg': {'precision': 0.5448096449963433, 'recall': 0.5101553446709888, 'f1-score': 0.5115469498853646, 'support': 383148}}
[[62638 18373 17865]
 [59100 80310 44307]
 [23963 24075 52517]]
Evaluating performance on  val set...
547/547 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9122277
{'0': {'precision': 0.25603974838180327, 'recall': 0.6688895504614468, 'f1-score': 0.37032519655189466, 'support': 16795}, '1': {'precision': 0.8986806324906839, 'recall': 0.5072912817305779, 'f1-score': 0.6485091847302723, 'support': 105537}, '2': {'precision': 0.29189456614352854, 'recall': 0.6068224672875836, 'f1-score': 0.39418009056491726, 'support': 17501}, 'accuracy': 0.5391574234980298, 'macro avg': {'precision': 0.4822049823386719, 'recall': 0.5943344331598693, 'f1-score': 0.4710048239490281, 'support': 139833}, 'weighted avg': {'precision': 0.7455514241081832, 'recall': 0.5391574234980298, 'f1-score': 0.5832662623983211, 'support': 139833}}
[[11234  2519  3042]
 [29278 53538 22721]
 [ 3364  3517 10620]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.92180014
{'0': {'precision': 0.3323934034008374, 'recall': 0.6730394913274795, 'f1-score': 0.44501008136591785, 'support': 23119}, '1': {'precision': 0.843057866518765, 'recall': 0.49195732148058646, 'f1-score': 0.6213389833972599, 'support': 92693}, '2': {'precision': 0.369371452056202, 'recall': 0.5986428541692685, 'f1-score': 0.4568560172830093, 'support': 24021}, 'accuracy': 0.5402229802693213, 'macro avg': {'precision': 0.5149409073252681, 'recall': 0.5878798889924449, 'f1-score': 0.507735027348729, 'support': 139833}, 'weighted avg': {'precision': 0.6772567102492965, 'recall': 0.5402229802693213, 'f1-score': 0.5639305518031941, 'support': 139833}}
[[15560  3586  3973]
 [26514 45601 20578]
 [ 4738  4903 14380]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.94185317
{'0': {'precision': 0.37080801036166183, 'recall': 0.6731416169289203, 'f1-score': 0.4781960683541051, 'support': 27645}, '1': {'precision': 0.7880704188001061, 'recall': 0.4621439594224397, 'f1-score': 0.5826232524469512, 'support': 83593}, '2': {'precision': 0.4118935683166367, 'recall': 0.5852072040566533, 'f1-score': 0.483487908468406, 'support': 28595}, 'accuracy': 0.5290239070891707, 'macro avg': {'precision': 0.5235906658261349, 'recall': 0.5734975934693378, 'f1-score': 0.5147690764231542, 'support': 139833}, 'weighted avg': {'precision': 0.6286517099055275, 'recall': 0.5290239070891707, 'f1-score': 0.5417054099826314, 'support': 139833}}
[[18609  4398  4638]
 [25706 38632 19255]
 [ 5870  5991 16734]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9686854
{'0': {'precision': 0.4188318898512103, 'recall': 0.6517869999712006, 'f1-score': 0.5099651866289615, 'support': 34723}, '1': {'precision': 0.6709431579896733, 'recall': 0.42784431568201753, 'f1-score': 0.5225017997928043, 'support': 69551}, '2': {'precision': 0.46154031752159436, 'recall': 0.5379510109958098, 'f1-score': 0.49682488150120124, 'support': 35559}, 'accuracy': 0.5114529474444516, 'macro avg': {'precision': 0.5171051217874927, 'recall': 0.5391941088830093, 'f1-score': 0.5097639559743224, 'support': 139833}, 'weighted avg': {'precision': 0.555089138067507, 'recall': 0.5114529474444516, 'f1-score': 0.5128591949969461, 'support': 139833}}
[[22632  6285  5806]
 [23283 29757 16511]
 [ 8121  8309 19129]]
training model: results/EXC/W0/deepLOB_L2/seq2seq
Epoch 1/50
1497/1497 - 85s - loss: 11.2329 - accuracy10: 0.4724 - accuracy20: 0.4928 - accuracy30: 0.4995 - accuracy50: 0.4999 - val_loss: 10.6971 - val_accuracy10: 0.5857 - val_accuracy20: 0.5726 - val_accuracy30: 0.5558 - val_accuracy50: 0.5285 - 85s/epoch - 57ms/step
Epoch 2/50
1497/1497 - 78s - loss: 10.0033 - accuracy10: 0.6016 - accuracy20: 0.6066 - accuracy30: 0.5941 - accuracy50: 0.5680 - val_loss: 9.7062 - val_accuracy10: 0.6891 - val_accuracy20: 0.6693 - val_accuracy30: 0.6366 - val_accuracy50: 0.5854 - 78s/epoch - 52ms/step
Epoch 3/50
1497/1497 - 78s - loss: 9.4972 - accuracy10: 0.6418 - accuracy20: 0.6396 - accuracy30: 0.6196 - accuracy50: 0.5838 - val_loss: 9.5675 - val_accuracy10: 0.6942 - val_accuracy20: 0.6706 - val_accuracy30: 0.6361 - val_accuracy50: 0.5830 - 78s/epoch - 52ms/step
Epoch 4/50
1497/1497 - 78s - loss: 9.2871 - accuracy10: 0.6494 - accuracy20: 0.6468 - accuracy30: 0.6246 - accuracy50: 0.5879 - val_loss: 9.7165 - val_accuracy10: 0.6837 - val_accuracy20: 0.6667 - val_accuracy30: 0.6382 - val_accuracy50: 0.5844 - 78s/epoch - 52ms/step
Epoch 5/50
1497/1497 - 78s - loss: 9.2095 - accuracy10: 0.6512 - accuracy20: 0.6488 - accuracy30: 0.6279 - accuracy50: 0.5908 - val_loss: 9.0603 - val_accuracy10: 0.6668 - val_accuracy20: 0.6558 - val_accuracy30: 0.6289 - val_accuracy50: 0.5834 - 78s/epoch - 52ms/step
Epoch 6/50
1497/1497 - 80s - loss: 9.0932 - accuracy10: 0.6546 - accuracy20: 0.6529 - accuracy30: 0.6311 - accuracy50: 0.5932 - val_loss: 9.1289 - val_accuracy10: 0.6728 - val_accuracy20: 0.6609 - val_accuracy30: 0.6330 - val_accuracy50: 0.5877 - 80s/epoch - 54ms/step
Epoch 7/50
1497/1497 - 79s - loss: 9.0240 - accuracy10: 0.6567 - accuracy20: 0.6545 - accuracy30: 0.6331 - accuracy50: 0.5958 - val_loss: 8.9268 - val_accuracy10: 0.6835 - val_accuracy20: 0.6718 - val_accuracy30: 0.6450 - val_accuracy50: 0.5969 - 79s/epoch - 53ms/step
Epoch 8/50
1497/1497 - 78s - loss: 8.9790 - accuracy10: 0.6592 - accuracy20: 0.6559 - accuracy30: 0.6350 - accuracy50: 0.5975 - val_loss: 8.9289 - val_accuracy10: 0.6741 - val_accuracy20: 0.6640 - val_accuracy30: 0.6393 - val_accuracy50: 0.5957 - 78s/epoch - 52ms/step
Epoch 9/50
1497/1497 - 78s - loss: 8.9311 - accuracy10: 0.6601 - accuracy20: 0.6567 - accuracy30: 0.6362 - accuracy50: 0.5989 - val_loss: 8.9675 - val_accuracy10: 0.6740 - val_accuracy20: 0.6640 - val_accuracy30: 0.6390 - val_accuracy50: 0.5957 - 78s/epoch - 52ms/step
Epoch 10/50
1497/1497 - 78s - loss: 8.8994 - accuracy10: 0.6608 - accuracy20: 0.6578 - accuracy30: 0.6371 - accuracy50: 0.6001 - val_loss: 8.9926 - val_accuracy10: 0.6702 - val_accuracy20: 0.6576 - val_accuracy30: 0.6328 - val_accuracy50: 0.5896 - 78s/epoch - 52ms/step
Epoch 11/50
1497/1497 - 78s - loss: 8.8660 - accuracy10: 0.6617 - accuracy20: 0.6579 - accuracy30: 0.6376 - accuracy50: 0.6015 - val_loss: 9.0568 - val_accuracy10: 0.6669 - val_accuracy20: 0.6529 - val_accuracy30: 0.6284 - val_accuracy50: 0.5861 - 78s/epoch - 52ms/step
Epoch 12/50
1497/1497 - 78s - loss: 8.8318 - accuracy10: 0.6632 - accuracy20: 0.6585 - accuracy30: 0.6388 - accuracy50: 0.6017 - val_loss: 9.0281 - val_accuracy10: 0.6635 - val_accuracy20: 0.6507 - val_accuracy30: 0.6261 - val_accuracy50: 0.5830 - 78s/epoch - 52ms/step
Epoch 13/50
1497/1497 - 78s - loss: 8.8001 - accuracy10: 0.6644 - accuracy20: 0.6599 - accuracy30: 0.6402 - accuracy50: 0.6038 - val_loss: 9.0516 - val_accuracy10: 0.6507 - val_accuracy20: 0.6418 - val_accuracy30: 0.6202 - val_accuracy50: 0.5808 - 78s/epoch - 52ms/step
Epoch 14/50
1497/1497 - 78s - loss: 8.7712 - accuracy10: 0.6651 - accuracy20: 0.6610 - accuracy30: 0.6411 - accuracy50: 0.6043 - val_loss: 9.0451 - val_accuracy10: 0.6566 - val_accuracy20: 0.6460 - val_accuracy30: 0.6241 - val_accuracy50: 0.5828 - 78s/epoch - 52ms/step
Epoch 15/50
1497/1497 - 78s - loss: 8.7419 - accuracy10: 0.6663 - accuracy20: 0.6618 - accuracy30: 0.6423 - accuracy50: 0.6054 - val_loss: 9.0840 - val_accuracy10: 0.6446 - val_accuracy20: 0.6371 - val_accuracy30: 0.6175 - val_accuracy50: 0.5791 - 78s/epoch - 52ms/step
Epoch 16/50
1497/1497 - 79s - loss: 8.7142 - accuracy10: 0.6663 - accuracy20: 0.6618 - accuracy30: 0.6429 - accuracy50: 0.6069 - val_loss: 9.0256 - val_accuracy10: 0.6573 - val_accuracy20: 0.6473 - val_accuracy30: 0.6250 - val_accuracy50: 0.5850 - 79s/epoch - 53ms/step
Epoch 17/50
1497/1497 - 79s - loss: 8.6920 - accuracy10: 0.6669 - accuracy20: 0.6635 - accuracy30: 0.6443 - accuracy50: 0.6076 - val_loss: 9.0785 - val_accuracy10: 0.6599 - val_accuracy20: 0.6466 - val_accuracy30: 0.6223 - val_accuracy50: 0.5821 - 79s/epoch - 53ms/step
testing model: results/EXC/W0/deepLOB_L2/seq2seq
Evaluating performance on  test set...
4693/4693 - 95s - 95s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.67025185
{'0': {'precision': 0.34132139369772735, 'recall': 0.7640208778034445, 'f1-score': 0.4718478204436539, 'support': 136796}, '1': {'precision': 0.9321620155505997, 'recall': 0.7016529407698024, 'f1-score': 0.8006466300908561, 'support': 925744}, '2': {'precision': 0.4208505119522817, 'recall': 0.6014842916077662, 'f1-score': 0.4952095363923816, 'support': 138652}, 'accuracy': 0.6971932880005861, 'macro avg': {'precision': 0.5647779737335362, 'recall': 0.6890527033936711, 'f1-score': 0.5892346623089639, 'support': 1201192}, 'weighted avg': {'precision': 0.8058549836157388, 'recall': 0.6971932880005861, 'f1-score': 0.7279456581563282, 'support': 1201192}}
[[104515  17776  14505]
 [175932 649551 100261]
 [ 25760  29495  83397]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.69582856
{'0': {'precision': 0.4142605696405078, 'recall': 0.7343558765594221, 'f1-score': 0.5297062996944213, 'support': 190375}, '1': {'precision': 0.8772548947151242, 'recall': 0.6958095547476366, 'f1-score': 0.7760678056139181, 'support': 818839}, '2': {'precision': 0.5135362210604929, 'recall': 0.5730864994947338, 'f1-score': 0.5416795907616107, 'support': 191978}, 'accuracy': 0.6823047439543387, 'macro avg': {'precision': 0.6016838951387083, 'recall': 0.6677506436005975, 'f1-score': 0.6158178986899833, 'support': 1201192}, 'weighted avg': {'precision': 0.7457450876510172, 'recall': 0.6823047439543387, 'f1-score': 0.6995617579543095, 'support': 1201192}}
[[139803  30847  19725]
 [164588 569756  84495]
 [ 33085  48873 110020]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7421941
{'0': {'precision': 0.4391157384909885, 'recall': 0.7149720230809582, 'f1-score': 0.5440755519111686, 'support': 228760}, '1': {'precision': 0.8221819911065132, 'recall': 0.6634996169108608, 'f1-score': 0.7343665468917898, 'support': 742647}, '2': {'precision': 0.5494185032780025, 'recall': 0.548517092064321, 'f1-score': 0.5489674276393586, 'support': 229785}, 'accuracy': 0.6513063690067866, 'macro avg': {'precision': 0.6035720776251682, 'recall': 0.6423295773520467, 'f1-score': 0.6091365088141056, 'support': 1201192}, 'weighted avg': {'precision': 0.6970502935935413, 'recall': 0.6513063690067866, 'f1-score': 0.6626603545185582, 'support': 1201192}}
[[163557  40916  24287]
 [170821 492746  79080]
 [ 38091  65653 126041]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.81935155
{'0': {'precision': 0.4639905125562779, 'recall': 0.6782896829419187, 'f1-score': 0.5510381408873037, 'support': 286099}, '1': {'precision': 0.713705196340317, 'recall': 0.611058162774167, 'f1-score': 0.6584049642339208, 'support': 627446}, '2': {'precision': 0.5808789420142421, 'recall': 0.4962714716301578, 'f1-score': 0.5352523542502113, 'support': 287647}, 'accuracy': 0.5995835803102252, 'macro avg': {'precision': 0.5861915503036124, 'recall': 0.5952064391154145, 'f1-score': 0.5815651531238119, 'support': 1201192}, 'weighted avg': {'precision': 0.6224207098518436, 'recall': 0.5995835803102252, 'f1-score': 0.6033413111321454, 'support': 1201192}}
[[194058  59578  32463]
 [173504 383406  70536]
 [ 50675  94221 142751]]
Evaluating performance on  train set...
1497/1497 - 32s - 32s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7193541
{'0': {'precision': 0.36129470258181745, 'recall': 0.7337388483373884, 'f1-score': 0.48417869710065425, 'support': 49320}, '1': {'precision': 0.9197600780041957, 'recall': 0.6602166881705226, 'f1-score': 0.7686707369521422, 'support': 282895}, '2': {'precision': 0.40266012687528935, 'recall': 0.6318176463658852, 'f1-score': 0.4918573994115624, 'support': 50934}, 'accuracy': 0.6659054310464075, 'macro avg': {'precision': 0.5612383024871008, 'recall': 0.6752577276245987, 'f1-score': 0.5815689444881197, 'support': 383149}, 'weighted avg': {'precision': 0.7791320684657879, 'recall': 0.6659054310464075, 'f1-score': 0.6952518896113757, 'support': 383149}}
[[ 36188   6597   6535]
 [ 54918 186772  41205]
 [  9056   9697  32181]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7435518
{'0': {'precision': 0.440319409407924, 'recall': 0.7045737860619732, 'f1-score': 0.5419501392630474, 'support': 67384}, '1': {'precision': 0.8590841075044812, 'recall': 0.6581492943597388, 'f1-score': 0.7453112994415074, 'support': 246868}, '2': {'precision': 0.47830576115455115, 'recall': 0.598415025327663, 'f1-score': 0.5316612398852316, 'support': 68897}, 'accuracy': 0.6555726362329015, 'macro avg': {'precision': 0.5925697593556521, 'recall': 0.6537127019164582, 'f1-score': 0.6063075595299289, 'support': 383149}, 'weighted avg': {'precision': 0.7169656988827451, 'recall': 0.6555726362329015, 'f1-score': 0.6711283143085328, 'support': 383149}}
[[ 47477  10826   9081]
 [ 48504 162476  35888]
 [ 11843  15825  41229]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7869394
{'0': {'precision': 0.46868133288524677, 'recall': 0.6804533853775709, 'f1-score': 0.5550538062363187, 'support': 79932}, '1': {'precision': 0.7988327359822567, 'recall': 0.6302887889626059, 'f1-score': 0.7046221177941703, 'support': 221719}, '2': {'precision': 0.508924599342455, 'recall': 0.5755110554860242, 'f1-score': 0.5401735585256162, 'support': 81498}, 'accuracy': 0.629102516253468, 'macro avg': {'precision': 0.5921462227366528, 'recall': 0.6287510766087337, 'f1-score': 0.5999498275187017, 'support': 383149}, 'weighted avg': {'precision': 0.6682918882383744, 'recall': 0.629102516253468, 'f1-score': 0.6384402330372981, 'support': 383149}}
[[ 54390  14300  11242]
 [ 47956 139747  34016]
 [ 13703  20892  46903]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8578254
{'0': {'precision': 0.4976515781553206, 'recall': 0.6354781940286431, 'f1-score': 0.5581827146455113, 'support': 98872}, '1': {'precision': 0.6806870094141996, 'recall': 0.5871646519020067, 'f1-score': 0.6304765188728592, 'support': 183727}, '2': {'precision': 0.5383700843410223, 'recall': 0.5269119840875186, 'f1-score': 0.532579412947326, 'support': 100550}, 'accuracy': 0.5838198716426247, 'macro avg': {'precision': 0.5722362239701808, 'recall': 0.5831849433393895, 'f1-score': 0.5737462154885654, 'support': 383149}, 'weighted avg': {'precision': 0.5961062171492169, 'recall': 0.5838198716426247, 'f1-score': 0.5861298364793812, 'support': 383149}}
[[ 62831  20963  15078]
 [ 45498 107878  30351]
 [ 17926  29643  52981]]
Evaluating performance on  val set...
547/547 - 11s - 11s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.68295
{'0': {'precision': 0.3618210623860341, 'recall': 0.7230153515321666, 'f1-score': 0.48228871976730286, 'support': 16741}, '1': {'precision': 0.9253177081325572, 'recall': 0.6822259907345125, 'f1-score': 0.7853917633714336, 'support': 105553}, '2': {'precision': 0.40256329446370415, 'recall': 0.6554535606362962, 'f1-score': 0.49878514404720575, 'support': 17539}, 'accuracy': 0.6837513319459642, 'macro avg': {'precision': 0.5632340216607651, 'recall': 0.6868983009676585, 'f1-score': 0.5888218757286474, 'support': 139833}, 'weighted avg': {'precision': 0.7922869714124657, 'recall': 0.6837513319459642, 'f1-score': 0.7131552988079587, 'support': 139833}}
[[12104  2539  2098]
 [18579 72011 14963]
 [ 2770  3273 11496]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7087514
{'0': {'precision': 0.4415766471509854, 'recall': 0.69605719237435, 'f1-score': 0.5403541817325641, 'support': 23080}, '1': {'precision': 0.8680572800264879, 'recall': 0.6784701480467107, 'f1-score': 0.761643072863394, 'support': 92741}, '2': {'precision': 0.48511270425628106, 'recall': 0.6256038647342995, 'f1-score': 0.546473134708429, 'support': 24012}, 'accuracy': 0.6722948088076491, 'macro avg': {'precision': 0.5982488771445847, 'recall': 0.6667104017184534, 'f1-score': 0.6161567964347957, 'support': 139833}, 'weighted avg': {'precision': 0.7319060270306943, 'recall': 0.672294808807649, 'f1-score': 0.6881696569867657, 'support': 139833}}
[[16065  4136  2879]
 [16754 62922 13065]
 [ 3562  5428 15022]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.75355947
{'0': {'precision': 0.4719949653870359, 'recall': 0.679470918644682, 'f1-score': 0.5570409982174688, 'support': 27595}, '1': {'precision': 0.8098486431620742, 'recall': 0.6489366791857044, 'f1-score': 0.7205179282868527, 'support': 83606}, '2': {'precision': 0.5195083650419762, 'recall': 0.6008312377759151, 'f1-score': 0.5572182813461601, 'support': 28632}, 'accuracy': 0.6451123840581264, 'macro avg': {'precision': 0.6004506578636954, 'recall': 0.6430796118687672, 'f1-score': 0.6115924026168272, 'support': 139833}, 'weighted avg': {'precision': 0.6837260892489291, 'recall': 0.6451123840581264, 'f1-score': 0.6548199787579821, 'support': 139833}}
[[18750  5365  3480]
 [16920 54255 12431]
 [ 4055  7374 17203]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8312248
{'0': {'precision': 0.5054446874430472, 'recall': 0.6389528856122566, 'f1-score': 0.5644110913253624, 'support': 34724}, '1': {'precision': 0.6904330046499357, 'recall': 0.6023534827516759, 'f1-score': 0.6433927473878304, 'support': 69514}, '2': {'precision': 0.5509903374798107, 'recall': 0.5462845905323781, 'f1-score': 0.5486273735293287, 'support': 35595}, 'accuracy': 0.5971694807377371, 'macro avg': {'precision': 0.5822893431909312, 'recall': 0.5958636529654369, 'f1-score': 0.5854770707475071, 'support': 139833}, 'weighted avg': {'precision': 0.6090001807484775, 'recall': 0.5971694807377371, 'f1-score': 0.5996567729926124, 'support': 139833}}
[[22187  7983  4554]
 [16350 41872 11292]
 [ 5359 10791 19445]]
training model: results/EXC/W0/deepOF_L2/seq2seq
Epoch 1/50
1497/1497 - 58s - loss: 10.5590 - accuracy10: 0.5692 - accuracy20: 0.5778 - accuracy30: 0.5709 - accuracy50: 0.5492 - val_loss: 9.6492 - val_accuracy10: 0.7000 - val_accuracy20: 0.6906 - val_accuracy30: 0.6657 - val_accuracy50: 0.6112 - 58s/epoch - 39ms/step
Epoch 2/50
1497/1497 - 51s - loss: 9.6242 - accuracy10: 0.6339 - accuracy20: 0.6332 - accuracy30: 0.6180 - accuracy50: 0.5862 - val_loss: 9.4248 - val_accuracy10: 0.7118 - val_accuracy20: 0.7006 - val_accuracy30: 0.6742 - val_accuracy50: 0.6184 - 51s/epoch - 34ms/step
Epoch 3/50
1497/1497 - 52s - loss: 9.4330 - accuracy10: 0.6397 - accuracy20: 0.6391 - accuracy30: 0.6230 - accuracy50: 0.5910 - val_loss: 9.2966 - val_accuracy10: 0.7131 - val_accuracy20: 0.7009 - val_accuracy30: 0.6747 - val_accuracy50: 0.6209 - 52s/epoch - 34ms/step
Epoch 4/50
1497/1497 - 51s - loss: 9.3241 - accuracy10: 0.6429 - accuracy20: 0.6416 - accuracy30: 0.6262 - accuracy50: 0.5936 - val_loss: 9.3093 - val_accuracy10: 0.7178 - val_accuracy20: 0.7040 - val_accuracy30: 0.6790 - val_accuracy50: 0.6241 - 51s/epoch - 34ms/step
Epoch 5/50
1497/1497 - 51s - loss: 9.2553 - accuracy10: 0.6445 - accuracy20: 0.6437 - accuracy30: 0.6280 - accuracy50: 0.5949 - val_loss: 9.2862 - val_accuracy10: 0.7156 - val_accuracy20: 0.7029 - val_accuracy30: 0.6775 - val_accuracy50: 0.6229 - 51s/epoch - 34ms/step
Epoch 6/50
1497/1497 - 51s - loss: 9.2041 - accuracy10: 0.6472 - accuracy20: 0.6460 - accuracy30: 0.6295 - accuracy50: 0.5966 - val_loss: 9.2737 - val_accuracy10: 0.7130 - val_accuracy20: 0.7009 - val_accuracy30: 0.6755 - val_accuracy50: 0.6211 - 51s/epoch - 34ms/step
Epoch 7/50
1497/1497 - 51s - loss: 9.1608 - accuracy10: 0.6496 - accuracy20: 0.6478 - accuracy30: 0.6307 - accuracy50: 0.5967 - val_loss: 9.2804 - val_accuracy10: 0.7152 - val_accuracy20: 0.7024 - val_accuracy30: 0.6769 - val_accuracy50: 0.6212 - 51s/epoch - 34ms/step
Epoch 8/50
1497/1497 - 51s - loss: 9.1184 - accuracy10: 0.6518 - accuracy20: 0.6495 - accuracy30: 0.6317 - accuracy50: 0.5972 - val_loss: 9.2851 - val_accuracy10: 0.7125 - val_accuracy20: 0.7003 - val_accuracy30: 0.6752 - val_accuracy50: 0.6196 - 51s/epoch - 34ms/step
Epoch 9/50
1497/1497 - 52s - loss: 9.0873 - accuracy10: 0.6519 - accuracy20: 0.6503 - accuracy30: 0.6333 - accuracy50: 0.5986 - val_loss: 9.2880 - val_accuracy10: 0.7077 - val_accuracy20: 0.6949 - val_accuracy30: 0.6695 - val_accuracy50: 0.6160 - 52s/epoch - 35ms/step
Epoch 10/50
1497/1497 - 51s - loss: 9.0577 - accuracy10: 0.6528 - accuracy20: 0.6518 - accuracy30: 0.6350 - accuracy50: 0.6001 - val_loss: 9.2783 - val_accuracy10: 0.7095 - val_accuracy20: 0.6966 - val_accuracy30: 0.6701 - val_accuracy50: 0.6151 - 51s/epoch - 34ms/step
Epoch 11/50
1497/1497 - 51s - loss: 9.0324 - accuracy10: 0.6535 - accuracy20: 0.6523 - accuracy30: 0.6345 - accuracy50: 0.5999 - val_loss: 9.2531 - val_accuracy10: 0.7083 - val_accuracy20: 0.6952 - val_accuracy30: 0.6688 - val_accuracy50: 0.6146 - 51s/epoch - 34ms/step
Epoch 12/50
1497/1497 - 52s - loss: 9.0071 - accuracy10: 0.6546 - accuracy20: 0.6537 - accuracy30: 0.6362 - accuracy50: 0.6013 - val_loss: 9.2211 - val_accuracy10: 0.7071 - val_accuracy20: 0.6942 - val_accuracy30: 0.6673 - val_accuracy50: 0.6130 - 52s/epoch - 35ms/step
Epoch 13/50
1497/1497 - 53s - loss: 8.9795 - accuracy10: 0.6554 - accuracy20: 0.6548 - accuracy30: 0.6369 - accuracy50: 0.6014 - val_loss: 9.3177 - val_accuracy10: 0.6995 - val_accuracy20: 0.6886 - val_accuracy30: 0.6606 - val_accuracy50: 0.6078 - 53s/epoch - 35ms/step
Epoch 14/50
1497/1497 - 53s - loss: 8.9491 - accuracy10: 0.6562 - accuracy20: 0.6551 - accuracy30: 0.6377 - accuracy50: 0.6018 - val_loss: 9.2535 - val_accuracy10: 0.7019 - val_accuracy20: 0.6899 - val_accuracy30: 0.6628 - val_accuracy50: 0.6080 - 53s/epoch - 35ms/step
Epoch 15/50
1497/1497 - 51s - loss: 8.9223 - accuracy10: 0.6570 - accuracy20: 0.6571 - accuracy30: 0.6389 - accuracy50: 0.6029 - val_loss: 9.2420 - val_accuracy10: 0.6901 - val_accuracy20: 0.6810 - val_accuracy30: 0.6548 - val_accuracy50: 0.6050 - 51s/epoch - 34ms/step
Epoch 16/50
1497/1497 - 51s - loss: 8.8979 - accuracy10: 0.6578 - accuracy20: 0.6573 - accuracy30: 0.6390 - accuracy50: 0.6041 - val_loss: 9.3356 - val_accuracy10: 0.7014 - val_accuracy20: 0.6900 - val_accuracy30: 0.6628 - val_accuracy50: 0.6104 - 51s/epoch - 34ms/step
Epoch 17/50
1497/1497 - 51s - loss: 8.8765 - accuracy10: 0.6585 - accuracy20: 0.6582 - accuracy30: 0.6398 - accuracy50: 0.6042 - val_loss: 9.3457 - val_accuracy10: 0.6896 - val_accuracy20: 0.6809 - val_accuracy30: 0.6545 - val_accuracy50: 0.6035 - 51s/epoch - 34ms/step
Epoch 18/50
1497/1497 - 51s - loss: 8.8667 - accuracy10: 0.6582 - accuracy20: 0.6580 - accuracy30: 0.6398 - accuracy50: 0.6048 - val_loss: 9.2932 - val_accuracy10: 0.6955 - val_accuracy20: 0.6843 - val_accuracy30: 0.6576 - val_accuracy50: 0.6056 - 51s/epoch - 34ms/step
Epoch 19/50
1497/1497 - 50s - loss: 8.8347 - accuracy10: 0.6603 - accuracy20: 0.6597 - accuracy30: 0.6410 - accuracy50: 0.6057 - val_loss: 9.3226 - val_accuracy10: 0.6925 - val_accuracy20: 0.6810 - val_accuracy30: 0.6538 - val_accuracy50: 0.6033 - 50s/epoch - 34ms/step
Epoch 20/50
1497/1497 - 51s - loss: 8.8082 - accuracy10: 0.6601 - accuracy20: 0.6595 - accuracy30: 0.6414 - accuracy50: 0.6063 - val_loss: 9.3389 - val_accuracy10: 0.6891 - val_accuracy20: 0.6783 - val_accuracy30: 0.6523 - val_accuracy50: 0.6023 - 51s/epoch - 34ms/step
Epoch 21/50
1497/1497 - 51s - loss: 8.7809 - accuracy10: 0.6616 - accuracy20: 0.6611 - accuracy30: 0.6432 - accuracy50: 0.6079 - val_loss: 9.3311 - val_accuracy10: 0.7004 - val_accuracy20: 0.6878 - val_accuracy30: 0.6595 - val_accuracy50: 0.6083 - 51s/epoch - 34ms/step
Epoch 22/50
1497/1497 - 52s - loss: 8.7564 - accuracy10: 0.6615 - accuracy20: 0.6611 - accuracy30: 0.6430 - accuracy50: 0.6073 - val_loss: 9.4283 - val_accuracy10: 0.6959 - val_accuracy20: 0.6838 - val_accuracy30: 0.6576 - val_accuracy50: 0.6051 - 52s/epoch - 35ms/step
testing model: results/EXC/W0/deepOF_L2/seq2seq
Evaluating performance on  test set...
4693/4693 - 70s - 70s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.64831847
{'0': {'precision': 0.34667039627039625, 'recall': 0.6794961767328976, 'f1-score': 0.4591091057717716, 'support': 136794}, '1': {'precision': 0.9195038001175166, 'recall': 0.7251883082021684, 'f1-score': 0.8108671547940275, 'support': 925743}, '2': {'precision': 0.4132828783018728, 'recall': 0.6049549224666426, 'f1-score': 0.4910788254201514, 'support': 138650}, 'accuracy': 0.706106542944604, 'macro avg': {'precision': 0.5598190248965952, 'recall': 0.6698798024672362, 'f1-score': 0.5870183619953169, 'support': 1201187}, 'weighted avg': {'precision': 0.7958363749325937, 'recall': 0.706106542944604, 'f1-score': 0.7338957569803329, 'support': 1201187}}
[[ 92951  24361  19482]
 [154811 671338  99594]
 [ 20363  34410  83877]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.67974895
{'0': {'precision': 0.42981648707744635, 'recall': 0.6598099520415185, 'f1-score': 0.520540224693026, 'support': 190373}, '1': {'precision': 0.8627611841308472, 'recall': 0.730775806691922, 'f1-score': 0.7913026229659947, 'support': 818838}, '2': {'precision': 0.5106419530676869, 'recall': 0.5728789015293578, 'f1-score': 0.5399729961949183, 'support': 191976}, 'accuracy': 0.6942932282816914, 'macro avg': {'precision': 0.6010732080919935, 'recall': 0.6544882200875994, 'f1-score': 0.617271947951313, 'support': 1201187}, 'weighted avg': {'precision': 0.7378685385105331, 'recall': 0.6942932282816914, 'f1-score': 0.7082222146070764, 'support': 1201187}}
[[125610  39822  24941]
 [139997 598387  80454]
 [ 26634  55363 109979]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7263718
{'0': {'precision': 0.46685251661193006, 'recall': 0.6412890478147212, 'f1-score': 0.5403414427521686, 'support': 228758}, '1': {'precision': 0.8078683124063767, 'recall': 0.7145786821715865, 'f1-score': 0.7583652844446794, 'support': 742646}, '2': {'precision': 0.546462552213051, 'recall': 0.5471379518937433, 'f1-score': 0.5468000434924432, 'support': 229783}, 'accuracy': 0.6685903194090512, 'macro avg': {'precision': 0.6070611270771192, 'recall': 0.6343352272933503, 'f1-score': 0.615168923563097, 'support': 1201187}, 'weighted avg': {'precision': 0.692918107976218, 'recall': 0.6685903194090512, 'f1-score': 0.6763723942954994, 'support': 1201187}}
[[146700  53286  28772]
 [136395 530679  75572]
 [ 31137  72923 125723]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8120776
{'0': {'precision': 0.5027848086329068, 'recall': 0.5957245269960887, 'f1-score': 0.5453230711638049, 'support': 286097}, '1': {'precision': 0.6995836084219609, 'recall': 0.6822770405740095, 'f1-score': 0.6908219498616233, 'support': 627446}, '2': {'precision': 0.5723806441559687, 'recall': 0.4980322899139214, 'f1-score': 0.532624436492076, 'support': 287644}, 'accuracy': 0.617541648386138, 'macro avg': {'precision': 0.5915830204036121, 'recall': 0.5920112858280066, 'f1-score': 0.5895898191725014, 'support': 1201187}, 'weighted avg': {'precision': 0.6222495083388131, 'recall': 0.6175416483861379, 'f1-score': 0.6182842365543033, 'support': 1201187}}
[[170435  79058  36604]
 [128933 428092  70421]
 [ 39614 104774 143256]]
Evaluating performance on  train set...
1497/1497 - 22s - 22s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.67727685
{'0': {'precision': 0.38097654358004474, 'recall': 0.6694903232343703, 'f1-score': 0.4856128591272904, 'support': 49345}, '1': {'precision': 0.9012869623954565, 'recall': 0.7167828831344164, 'f1-score': 0.7985156749840051, 'support': 282949}, '2': {'precision': 0.42070916423930094, 'recall': 0.5907499901679317, 'f1-score': 0.49143642341856014, 'support': 50854}, 'accuracy': 0.6939642122626244, 'macro avg': {'precision': 0.5676575567382675, 'recall': 0.6590077321789062, 'f1-score': 0.5918549858432852, 'support': 383148}, 'weighted avg': {'precision': 0.7704914970299069, 'recall': 0.6939642122626244, 'f1-score': 0.7174597965569777, 'support': 383148}}
[[ 33036   8956   7353]
 [ 46123 202813  34013]
 [  7555  13257  30042]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.71136546
{'0': {'precision': 0.4663332338011347, 'recall': 0.6487308439776285, 'f1-score': 0.542614112260282, 'support': 67407}, '1': {'precision': 0.8383307805790211, 'recall': 0.722502065078311, 'f1-score': 0.7761186239414014, 'support': 246964}, '2': {'precision': 0.5023780280659577, 'recall': 0.5590386321008477, 'f1-score': 0.5291960003027988, 'support': 68777}, 'accuracy': 0.680181026652886, 'macro avg': {'precision': 0.6023473474820378, 'recall': 0.6434238470522624, 'f1-score': 0.6159762455014941, 'support': 383148}, 'weighted avg': {'precision': 0.712580258338926, 'recall': 0.680181026652886, 'f1-score': 0.6907144566095051, 'support': 383148}}
[[ 43729  13940   9738]
 [ 40185 178432  28347]
 [  9858  20470  38449]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7604599
{'0': {'precision': 0.500618305841993, 'recall': 0.6274796565042937, 'f1-score': 0.5569158230481209, 'support': 80001}, '1': {'precision': 0.7789579717950252, 'recall': 0.704382606656656, 'f1-score': 0.7397956404882842, 'support': 221763}, '2': {'precision': 0.5318792353841296, 'recall': 0.5381401749729676, 'f1-score': 0.5349913880507677, 'support': 81384}, 'accuracy': 0.653013978932423, 'macro avg': {'precision': 0.6038185043403826, 'recall': 0.623334146044639, 'f1-score': 0.6105676171957243, 'support': 383148}, 'weighted avg': {'precision': 0.6683591757684955, 'recall': 0.653013978932423, 'f1-score': 0.6581082571392772, 'support': 383148}}
[[ 50199  18258  11544]
 [ 38555 156206  27002]
 [ 11520  26068  43796]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8439107
{'0': {'precision': 0.5358637234299741, 'recall': 0.5828512480278328, 'f1-score': 0.5583707162996192, 'support': 98876}, '1': {'precision': 0.6619673561262459, 'recall': 0.6691160861542481, 'f1-score': 0.6655225246198073, 'support': 183717}, '2': {'precision': 0.5542541239808233, 'recall': 0.49552980955695886, 'f1-score': 0.523249464443231, 'support': 100555}, 'accuracy': 0.6012976708739182, 'macro avg': {'precision': 0.5840284011790144, 'recall': 0.5824990479130133, 'f1-score': 0.5823809017875524, 'support': 383148}, 'weighted avg': {'precision': 0.6011560590690785, 'recall': 0.6012976708739182, 'f1-score': 0.6005319471783942, 'support': 383148}}
[[ 57630  26676  14570]
 [ 35286 122928  25503]
 [ 14630  36097  49828]]
Evaluating performance on  val set...
547/547 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.64462334
{'0': {'precision': 0.3787238393891881, 'recall': 0.6615659422447157, 'f1-score': 0.48169423189473903, 'support': 16795}, '1': {'precision': 0.9078640296079772, 'recall': 0.7298388242985873, 'f1-score': 0.8091753817385321, 'support': 105537}, '2': {'precision': 0.4179238295715901, 'recall': 0.6125935660819382, 'f1-score': 0.49687166890670625, 'support': 17501}, 'accuracy': 0.7069647365071192, 'macro avg': {'precision': 0.5681705661895852, 'recall': 0.6679994442084137, 'f1-score': 0.5959137608466591, 'support': 139833}, 'weighted avg': {'precision': 0.7829911245314832, 'recall': 0.7069647365071192, 'f1-score': 0.7307556010723353, 'support': 139833}}
[[11111  3256  2428]
 [16008 77025 12504]
 [ 2219  4561 10721]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.680187
{'0': {'precision': 0.46488535271269266, 'recall': 0.641939530256499, 'f1-score': 0.5392511309339971, 'support': 23119}, '1': {'precision': 0.8477930931528662, 'recall': 0.7352119361764103, 'f1-score': 0.7874992055559087, 'support': 92693}, '2': {'precision': 0.5114259763851045, 'recall': 0.5860288913867033, 'f1-score': 0.5461917510573081, 'support': 24021}, 'accuracy': 0.694163752476168, 'macro avg': {'precision': 0.6080348074168879, 'recall': 0.6543934526065375, 'f1-score': 0.6243140291824046, 'support': 139833}, 'weighted avg': {'precision': 0.726703517994536, 'recall': 0.694163752476168, 'f1-score': 0.7050029879127568, 'support': 139833}}
[[14841  5151  3127]
 [14223 68149 10321]
 [ 2860  7084 14077]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7321868
{'0': {'precision': 0.502438174851968, 'recall': 0.6261530113944656, 'f1-score': 0.5575148557901347, 'support': 27645}, '1': {'precision': 0.7895499196755419, 'recall': 0.7172849401265656, 'f1-score': 0.7516845833202747, 'support': 83593}, '2': {'precision': 0.5447195896599749, 'recall': 0.5607973421926911, 'f1-score': 0.5526415549505463, 'support': 28595}, 'accuracy': 0.6672673832357169, 'macro avg': {'precision': 0.6122358947291615, 'recall': 0.634745097904574, 'f1-score': 0.6206136646869852, 'support': 139833}, 'weighted avg': {'precision': 0.6827215782079138, 'recall': 0.6672673832357169, 'f1-score': 0.6725941145911256, 'support': 139833}}
[[17310  6761  3574]
 [13804 59960  9829]
 [ 3338  9221 16036]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.82377315
{'0': {'precision': 0.5406855119884139, 'recall': 0.5805949946721194, 'f1-score': 0.5599300087489064, 'support': 34723}, '1': {'precision': 0.6706099029538853, 'recall': 0.6805797184799643, 'f1-score': 0.675558029342924, 'support': 69551}, '2': {'precision': 0.5685501533070522, 'recall': 0.5110379931944093, 'f1-score': 0.5382621702877624, 'support': 35559}, 'accuracy': 0.6126379323907805, 'macro avg': {'precision': 0.5932818560831171, 'recall': 0.5907375687821643, 'f1-score': 0.5912500694598642, 'support': 139833}, 'weighted avg': {'precision': 0.6123939792078038, 'recall': 0.6126379323907805, 'f1-score': 0.6119317379007854, 'support': 139833}}
[[20160 10069  4494]
 [12920 47335  9296]
 [ 4206 13181 18172]]
training model: results/EXC/W0/deepVOL_L2/seq2seq
Epoch 1/50
1497/1497 - 57s - loss: 10.4444 - accuracy10: 0.5882 - accuracy20: 0.5929 - accuracy30: 0.5789 - accuracy50: 0.5497 - val_loss: 9.8103 - val_accuracy10: 0.6892 - val_accuracy20: 0.6827 - val_accuracy30: 0.6606 - val_accuracy50: 0.6069 - 57s/epoch - 38ms/step
Epoch 2/50
1497/1497 - 51s - loss: 9.8754 - accuracy10: 0.6233 - accuracy20: 0.6242 - accuracy30: 0.6080 - accuracy50: 0.5749 - val_loss: 9.4751 - val_accuracy10: 0.6473 - val_accuracy20: 0.6455 - val_accuracy30: 0.6295 - val_accuracy50: 0.5900 - 51s/epoch - 34ms/step
Epoch 3/50
1497/1497 - 49s - loss: 9.6059 - accuracy10: 0.6375 - accuracy20: 0.6336 - accuracy30: 0.6155 - accuracy50: 0.5815 - val_loss: 9.2262 - val_accuracy10: 0.6891 - val_accuracy20: 0.6759 - val_accuracy30: 0.6497 - val_accuracy50: 0.6004 - 49s/epoch - 33ms/step
Epoch 4/50
1497/1497 - 50s - loss: 9.4348 - accuracy10: 0.6443 - accuracy20: 0.6396 - accuracy30: 0.6195 - accuracy50: 0.5850 - val_loss: 9.1786 - val_accuracy10: 0.6898 - val_accuracy20: 0.6789 - val_accuracy30: 0.6537 - val_accuracy50: 0.6040 - 50s/epoch - 33ms/step
Epoch 5/50
1497/1497 - 49s - loss: 9.3522 - accuracy10: 0.6475 - accuracy20: 0.6421 - accuracy30: 0.6219 - accuracy50: 0.5865 - val_loss: 9.1464 - val_accuracy10: 0.6958 - val_accuracy20: 0.6824 - val_accuracy30: 0.6573 - val_accuracy50: 0.6074 - 49s/epoch - 33ms/step
Epoch 6/50
1497/1497 - 49s - loss: 9.2776 - accuracy10: 0.6506 - accuracy20: 0.6454 - accuracy30: 0.6244 - accuracy50: 0.5898 - val_loss: 9.1411 - val_accuracy10: 0.6907 - val_accuracy20: 0.6794 - val_accuracy30: 0.6539 - val_accuracy50: 0.6055 - 49s/epoch - 33ms/step
Epoch 7/50
1497/1497 - 50s - loss: 9.2271 - accuracy10: 0.6531 - accuracy20: 0.6470 - accuracy30: 0.6253 - accuracy50: 0.5910 - val_loss: 9.1150 - val_accuracy10: 0.6994 - val_accuracy20: 0.6846 - val_accuracy30: 0.6573 - val_accuracy50: 0.6064 - 50s/epoch - 33ms/step
Epoch 8/50
1497/1497 - 49s - loss: 9.1844 - accuracy10: 0.6555 - accuracy20: 0.6489 - accuracy30: 0.6266 - accuracy50: 0.5920 - val_loss: 9.0893 - val_accuracy10: 0.6975 - val_accuracy20: 0.6826 - val_accuracy30: 0.6532 - val_accuracy50: 0.6034 - 49s/epoch - 33ms/step
Epoch 9/50
1497/1497 - 50s - loss: 9.1465 - accuracy10: 0.6564 - accuracy20: 0.6502 - accuracy30: 0.6282 - accuracy50: 0.5935 - val_loss: 9.1172 - val_accuracy10: 0.7050 - val_accuracy20: 0.6899 - val_accuracy30: 0.6614 - val_accuracy50: 0.6085 - 50s/epoch - 34ms/step
Epoch 10/50
1497/1497 - 50s - loss: 9.1121 - accuracy10: 0.6578 - accuracy20: 0.6519 - accuracy30: 0.6297 - accuracy50: 0.5947 - val_loss: 9.0802 - val_accuracy10: 0.7011 - val_accuracy20: 0.6870 - val_accuracy30: 0.6595 - val_accuracy50: 0.6077 - 50s/epoch - 34ms/step
Epoch 11/50
1497/1497 - 49s - loss: 9.0812 - accuracy10: 0.6594 - accuracy20: 0.6535 - accuracy30: 0.6304 - accuracy50: 0.5949 - val_loss: 9.0833 - val_accuracy10: 0.7016 - val_accuracy20: 0.6878 - val_accuracy30: 0.6606 - val_accuracy50: 0.6074 - 49s/epoch - 33ms/step
Epoch 12/50
1497/1497 - 49s - loss: 9.0528 - accuracy10: 0.6600 - accuracy20: 0.6537 - accuracy30: 0.6314 - accuracy50: 0.5963 - val_loss: 9.0537 - val_accuracy10: 0.7034 - val_accuracy20: 0.6881 - val_accuracy30: 0.6595 - val_accuracy50: 0.6082 - 49s/epoch - 33ms/step
Epoch 13/50
1497/1497 - 49s - loss: 9.0278 - accuracy10: 0.6608 - accuracy20: 0.6542 - accuracy30: 0.6316 - accuracy50: 0.5967 - val_loss: 9.0523 - val_accuracy10: 0.6973 - val_accuracy20: 0.6833 - val_accuracy30: 0.6558 - val_accuracy50: 0.6059 - 49s/epoch - 33ms/step
Epoch 14/50
1497/1497 - 49s - loss: 9.0010 - accuracy10: 0.6615 - accuracy20: 0.6549 - accuracy30: 0.6332 - accuracy50: 0.5979 - val_loss: 9.0565 - val_accuracy10: 0.7001 - val_accuracy20: 0.6855 - val_accuracy30: 0.6584 - val_accuracy50: 0.6090 - 49s/epoch - 33ms/step
Epoch 15/50
1497/1497 - 49s - loss: 8.9723 - accuracy10: 0.6620 - accuracy20: 0.6559 - accuracy30: 0.6338 - accuracy50: 0.5983 - val_loss: 9.0492 - val_accuracy10: 0.6935 - val_accuracy20: 0.6798 - val_accuracy30: 0.6544 - val_accuracy50: 0.6059 - 49s/epoch - 33ms/step
Epoch 16/50
1497/1497 - 49s - loss: 8.9534 - accuracy10: 0.6626 - accuracy20: 0.6566 - accuracy30: 0.6348 - accuracy50: 0.5987 - val_loss: 9.1133 - val_accuracy10: 0.7019 - val_accuracy20: 0.6861 - val_accuracy30: 0.6603 - val_accuracy50: 0.6096 - 49s/epoch - 33ms/step
Epoch 17/50
1497/1497 - 49s - loss: 8.9332 - accuracy10: 0.6631 - accuracy20: 0.6576 - accuracy30: 0.6352 - accuracy50: 0.6000 - val_loss: 9.0216 - val_accuracy10: 0.6957 - val_accuracy20: 0.6819 - val_accuracy30: 0.6554 - val_accuracy50: 0.6072 - 49s/epoch - 33ms/step
Epoch 18/50
1497/1497 - 50s - loss: 8.9071 - accuracy10: 0.6647 - accuracy20: 0.6584 - accuracy30: 0.6356 - accuracy50: 0.5999 - val_loss: 9.0700 - val_accuracy10: 0.6960 - val_accuracy20: 0.6832 - val_accuracy30: 0.6578 - val_accuracy50: 0.6076 - 50s/epoch - 33ms/step
Epoch 19/50
1497/1497 - 50s - loss: 8.8859 - accuracy10: 0.6647 - accuracy20: 0.6586 - accuracy30: 0.6366 - accuracy50: 0.6011 - val_loss: 9.0637 - val_accuracy10: 0.6946 - val_accuracy20: 0.6817 - val_accuracy30: 0.6560 - val_accuracy50: 0.6071 - 50s/epoch - 33ms/step
Epoch 20/50
1497/1497 - 50s - loss: 8.8696 - accuracy10: 0.6657 - accuracy20: 0.6593 - accuracy30: 0.6375 - accuracy50: 0.6020 - val_loss: 9.1252 - val_accuracy10: 0.7013 - val_accuracy20: 0.6855 - val_accuracy30: 0.6582 - val_accuracy50: 0.6076 - 50s/epoch - 33ms/step
Epoch 21/50
1497/1497 - 49s - loss: 8.8530 - accuracy10: 0.6662 - accuracy20: 0.6598 - accuracy30: 0.6378 - accuracy50: 0.6019 - val_loss: 9.0912 - val_accuracy10: 0.6963 - val_accuracy20: 0.6837 - val_accuracy30: 0.6577 - val_accuracy50: 0.6087 - 49s/epoch - 33ms/step
Epoch 22/50
1497/1497 - 49s - loss: 8.8367 - accuracy10: 0.6661 - accuracy20: 0.6598 - accuracy30: 0.6378 - accuracy50: 0.6021 - val_loss: 9.0543 - val_accuracy10: 0.6964 - val_accuracy20: 0.6833 - val_accuracy30: 0.6572 - val_accuracy50: 0.6078 - 49s/epoch - 33ms/step
Epoch 23/50
1497/1497 - 50s - loss: 8.8140 - accuracy10: 0.6672 - accuracy20: 0.6611 - accuracy30: 0.6393 - accuracy50: 0.6035 - val_loss: 9.1484 - val_accuracy10: 0.6984 - val_accuracy20: 0.6846 - val_accuracy30: 0.6584 - val_accuracy50: 0.6082 - 50s/epoch - 33ms/step
Epoch 24/50
1497/1497 - 49s - loss: 8.7963 - accuracy10: 0.6676 - accuracy20: 0.6613 - accuracy30: 0.6395 - accuracy50: 0.6042 - val_loss: 9.1051 - val_accuracy10: 0.6971 - val_accuracy20: 0.6825 - val_accuracy30: 0.6577 - val_accuracy50: 0.6078 - 49s/epoch - 33ms/step
Epoch 25/50
1497/1497 - 49s - loss: 8.7824 - accuracy10: 0.6678 - accuracy20: 0.6618 - accuracy30: 0.6403 - accuracy50: 0.6046 - val_loss: 9.1163 - val_accuracy10: 0.6989 - val_accuracy20: 0.6836 - val_accuracy30: 0.6561 - val_accuracy50: 0.6057 - 49s/epoch - 33ms/step
Epoch 26/50
1497/1497 - 49s - loss: 8.7640 - accuracy10: 0.6681 - accuracy20: 0.6620 - accuracy30: 0.6404 - accuracy50: 0.6054 - val_loss: 9.1782 - val_accuracy10: 0.6983 - val_accuracy20: 0.6829 - val_accuracy30: 0.6562 - val_accuracy50: 0.6057 - 49s/epoch - 33ms/step
Epoch 27/50
1497/1497 - 49s - loss: 8.7485 - accuracy10: 0.6680 - accuracy20: 0.6622 - accuracy30: 0.6410 - accuracy50: 0.6063 - val_loss: 9.1629 - val_accuracy10: 0.6950 - val_accuracy20: 0.6792 - val_accuracy30: 0.6532 - val_accuracy50: 0.6036 - 49s/epoch - 33ms/step
testing model: results/EXC/W0/deepVOL_L2/seq2seq
Evaluating performance on  test set...
4693/4693 - 62s - 62s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.66090244
{'0': {'precision': 0.355234869994421, 'recall': 0.7307742916459545, 'f1-score': 0.4780742550937694, 'support': 136796}, '1': {'precision': 0.932280905863238, 'recall': 0.7028703399643962, 'f1-score': 0.801482552661044, 'support': 925744}, '2': {'precision': 0.4002767773024581, 'recall': 0.6404307186337016, 'f1-score': 0.49264475396057045, 'support': 138652}, 'accuracy': 0.6988408181206668, 'macro avg': {'precision': 0.562597517720039, 'recall': 0.6913584500813509, 'f1-score': 0.590733853905128, 'support': 1201192}, 'weighted avg': {'precision': 0.805156327980668, 'recall': 0.6988408181206668, 'f1-score': 0.7290029324675771, 'support': 1201192}}
[[ 99967  20159  16670]
 [158694 650678 116372]
 [ 22750  27105  88797]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6879928
{'0': {'precision': 0.4301954680004083, 'recall': 0.7084333552199606, 'f1-score': 0.5353189952349672, 'support': 190375}, '1': {'precision': 0.878826897545832, 'recall': 0.6976585140668679, 'f1-score': 0.7778328463396502, 'support': 818839}, '2': {'precision': 0.4917925866080934, 'recall': 0.6087937159466189, 'f1-score': 0.544074073212004, 'support': 191978}, 'accuracy': 0.6851635708529528, 'macro avg': {'precision': 0.6002716507181113, 'recall': 0.6716285284111492, 'f1-score': 0.6190753049288739, 'support': 1201192}, 'weighted avg': {'precision': 0.7458670698539099, 'recall': 0.6851635708529528, 'f1-score': 0.7020372065488812, 'support': 1201192}}
[[134868  34206  21301]
 [148094 571270  99475]
 [ 30542  44561 116875]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7324484
{'0': {'precision': 0.4608205140189646, 'recall': 0.6895829690505333, 'f1-score': 0.5524565649066159, 'support': 228760}, '1': {'precision': 0.8243563501402499, 'recall': 0.6735339939432866, 'f1-score': 0.7413520317232354, 'support': 742647}, '2': {'precision': 0.5281876745366845, 'recall': 0.5794721152381574, 'f1-score': 0.5526426648902946, 'support': 229785}, 'accuracy': 0.6585966273501656, 'macro avg': {'precision': 0.6044548462319663, 'recall': 0.6475296927439925, 'f1-score': 0.6154837538400485, 'support': 1201192}, 'weighted avg': {'precision': 0.6984667529778724, 'recall': 0.6585966273501656, 'f1-score': 0.6692783675241089, 'support': 1201192}}
[[157749  46475  24536]
 [148043 500198  94406]
 [ 36530  60101 133154]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.81343204
{'0': {'precision': 0.49589720104523044, 'recall': 0.6434206341161626, 'f1-score': 0.5601079553147758, 'support': 286099}, '1': {'precision': 0.7143717035352929, 'recall': 0.6450005259416747, 'f1-score': 0.6779160475794036, 'support': 627446}, '2': {'precision': 0.5672534596494424, 'recall': 0.5195673864145984, 'f1-score': 0.5423642701224611, 'support': 287647}, 'accuracy': 0.6145870102364984, 'macro avg': {'precision': 0.5925074547433219, 'recall': 0.6026628488241452, 'f1-score': 0.5934627576722135, 'support': 1201192}, 'weighted avg': {'precision': 0.6271055061355952, 'recall': 0.6145870102364984, 'f1-score': 0.6173962975985722, 'support': 1201192}}
[[184082  71476  30541]
 [139270 404703  83473]
 [ 47858  90337 149452]]
Evaluating performance on  train set...
1497/1497 - 24s - 24s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.68852454
{'0': {'precision': 0.3870753669950457, 'recall': 0.6859286293592863, 'f1-score': 0.49488366649843835, 'support': 49320}, '1': {'precision': 0.9100459925758178, 'recall': 0.6889481963272592, 'f1-score': 0.7842111616303867, 'support': 282895}, '2': {'precision': 0.3994729423300852, 'recall': 0.6398672792240939, 'f1-score': 0.4918690904700458, 'support': 50934}, 'accuracy': 0.6820349263602411, 'macro avg': {'precision': 0.5655314339669829, 'recall': 0.6715813683035465, 'f1-score': 0.5903213061996236, 'support': 383149}, 'weighted avg': {'precision': 0.7748546205642509, 'recall': 0.6820349263602411, 'f1-score': 0.7081055653417667, 'support': 383149}}
[[ 33830   8559   6931]
 [ 45932 194900  42063]
 [  7637  10706  32591]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.72230124
{'0': {'precision': 0.4672628053297718, 'recall': 0.6645791285765167, 'f1-score': 0.5487216875072753, 'support': 67384}, '1': {'precision': 0.8461188219871711, 'recall': 0.6850098028095987, 'f1-score': 0.7570881740648714, 'support': 246868}, '2': {'precision': 0.4745448723813009, 'recall': 0.6023194043282001, 'f1-score': 0.5308516422015415, 'support': 68897}, 'accuracy': 0.6665474789181233, 'macro avg': {'precision': 0.5959754998994146, 'recall': 0.6506361119047718, 'f1-score': 0.6122205012578961, 'support': 383149}, 'weighted avg': {'precision': 0.7126742241089623, 'recall': 0.6665474789181233, 'f1-score': 0.6797616361749516, 'support': 383149}}
[[ 44782  13755   8847]
 [ 40658 169107  37103]
 [ 10399  17000  41498]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7712724
{'0': {'precision': 0.4975596110811019, 'recall': 0.6453360356302857, 'f1-score': 0.5618940763817781, 'support': 79932}, '1': {'precision': 0.7845134070076244, 'recall': 0.6608454845998765, 'f1-score': 0.7173888030708443, 'support': 221719}, '2': {'precision': 0.5042660367386123, 'recall': 0.57363370880267, 'f1-score': 0.536717812717055, 'support': 81498}, 'accuracy': 0.6390594781664575, 'macro avg': {'precision': 0.5954463516091129, 'recall': 0.6266050763442773, 'f1-score': 0.6053335640565591, 'support': 383149}, 'weighted avg': {'precision': 0.665039283368563, 'recall': 0.6390594781664575, 'f1-score': 0.6465199534442929, 'support': 383149}}
[[ 51583  18145  10204]
 [ 39442 146522  35755]
 [ 12647  22101  46750]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8564602
{'0': {'precision': 0.531364522068682, 'recall': 0.6012622380451493, 'f1-score': 0.5641565836298933, 'support': 98872}, '1': {'precision': 0.6629977505709429, 'recall': 0.6304625885144807, 'f1-score': 0.6463209815923535, 'support': 183727}, '2': {'precision': 0.5387945318972659, 'recall': 0.5174142217802089, 'f1-score': 0.5278879813302216, 'support': 100550}, 'accuracy': 0.5932600633174039, 'macro avg': {'precision': 0.5777189348456303, 'recall': 0.5830463494466129, 'f1-score': 0.5794551821841561, 'support': 383149}, 'weighted avg': {'precision': 0.5964349402644726, 'recall': 0.5932600633174039, 'f1-score': 0.594037936271338, 'support': 383149}}
[[ 59448  26857  12567]
 [ 35927 115833  31967]
 [ 16503  32021  52026]]
Evaluating performance on  val set...
547/547 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6584138
{'0': {'precision': 0.38110427833864974, 'recall': 0.6922525536108954, 'f1-score': 0.49158006362672324, 'support': 16741}, '1': {'precision': 0.9215969695459303, 'recall': 0.7006906482999062, 'f1-score': 0.7961034417803611, 'support': 105553}, '2': {'precision': 0.40007541478129716, 'recall': 0.6654313244768801, 'f1-score': 0.4997109888463103, 'support': 17539}, 'accuracy': 0.6952579147983666, 'macro avg': {'precision': 0.5675922208886258, 'recall': 0.6861248421292272, 'f1-score': 0.5957981647511316, 'support': 139833}, 'weighted avg': {'precision': 0.7914749333132958, 'recall': 0.6952579147983666, 'f1-score': 0.7224695134109465, 'support': 139833}}
[[11589  2845  2307]
 [16399 73960 15194]
 [ 2421  3447 11671]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.69147307
{'0': {'precision': 0.46215780998389694, 'recall': 0.6714904679376084, 'f1-score': 0.5474970855265482, 'support': 23080}, '1': {'precision': 0.8622314788854621, 'recall': 0.6963694590310651, 'f1-score': 0.770475179251023, 'support': 92741}, '2': {'precision': 0.4831517931078413, 'recall': 0.631767449608529, 'f1-score': 0.5475545930337484, 'support': 24012}, 'accuracy': 0.6811696809765935, 'macro avg': {'precision': 0.6025136939924002, 'recall': 0.6665424588590675, 'f1-score': 0.6218422859371066, 'support': 139833}, 'weighted avg': {'precision': 0.7311024771967309, 'recall': 0.6811696809765936, 'f1-score': 0.6953920192000331, 'support': 139833}}
[[15498  4695  2887]
 [14818 64582 13341]
 [ 3218  5624 15170]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7404778
{'0': {'precision': 0.49658351856425453, 'recall': 0.6557709730023555, 'f1-score': 0.5651820850771442, 'support': 27595}, '1': {'precision': 0.8018818312321446, 'recall': 0.6748080281319523, 'f1-score': 0.7328773796301709, 'support': 83606}, '2': {'precision': 0.5189344634478583, 'recall': 0.5987356803576418, 'f1-score': 0.5559861838584657, 'support': 28632}, 'accuracy': 0.6554747448742428, 'macro avg': {'precision': 0.6057999377480858, 'recall': 0.64310489383065, 'f1-score': 0.6180152161885936, 'support': 139833}, 'weighted avg': {'precision': 0.6836975973784041, 'recall': 0.6554747448742428, 'f1-score': 0.663563981716043, 'support': 139833}}
[[18096  6258  3241]
 [14537 56418 12651]
 [ 3808  7681 17143]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.83257794
{'0': {'precision': 0.5345534146155216, 'recall': 0.6047978343508812, 'f1-score': 0.5675102349650727, 'support': 34724}, '1': {'precision': 0.6772856537786652, 'recall': 0.6441004689702794, 'f1-score': 0.6602763563433661, 'support': 69514}, '2': {'precision': 0.5529066728613741, 'recall': 0.5349346818373367, 'f1-score': 0.5437722216669284, 'support': 35595}, 'accuracy': 0.6065521014352835, 'macro avg': {'precision': 0.5882485804185204, 'recall': 0.5946109950528324, 'f1-score': 0.5905196043251224, 'support': 139833}, 'weighted avg': {'precision': 0.6101805777347273, 'recall': 0.6065521014352835, 'f1-score': 0.6075836767001656, 'support': 139833}}
[[21001  9742  3981]
 [13324 44774 11416]
 [ 4962 11592 19041]]
training model: results/EXC/W0/deepVOL_L3/seq2seq
Epoch 1/50
1497/1497 - 75s - loss: 10.6988 - accuracy10: 0.5649 - accuracy20: 0.5696 - accuracy30: 0.5592 - accuracy50: 0.5372 - val_loss: 9.7851 - val_accuracy10: 0.6734 - val_accuracy20: 0.6691 - val_accuracy30: 0.6486 - val_accuracy50: 0.6007 - 75s/epoch - 50ms/step
Epoch 2/50
1497/1497 - 68s - loss: 9.8848 - accuracy10: 0.6263 - accuracy20: 0.6244 - accuracy30: 0.6067 - accuracy50: 0.5735 - val_loss: 9.6067 - val_accuracy10: 0.6739 - val_accuracy20: 0.6700 - val_accuracy30: 0.6504 - val_accuracy50: 0.6028 - 68s/epoch - 45ms/step
Epoch 3/50
1497/1497 - 68s - loss: 9.5363 - accuracy10: 0.6445 - accuracy20: 0.6398 - accuracy30: 0.6189 - accuracy50: 0.5826 - val_loss: 9.3359 - val_accuracy10: 0.6785 - val_accuracy20: 0.6706 - val_accuracy30: 0.6494 - val_accuracy50: 0.6035 - 68s/epoch - 45ms/step
Epoch 4/50
1497/1497 - 68s - loss: 9.3433 - accuracy10: 0.6499 - accuracy20: 0.6441 - accuracy30: 0.6220 - accuracy50: 0.5851 - val_loss: 9.1281 - val_accuracy10: 0.7071 - val_accuracy20: 0.6951 - val_accuracy30: 0.6690 - val_accuracy50: 0.6159 - 68s/epoch - 45ms/step
Epoch 5/50
1497/1497 - 69s - loss: 9.2355 - accuracy10: 0.6510 - accuracy20: 0.6466 - accuracy30: 0.6253 - accuracy50: 0.5888 - val_loss: 9.0937 - val_accuracy10: 0.7028 - val_accuracy20: 0.6929 - val_accuracy30: 0.6674 - val_accuracy50: 0.6155 - 69s/epoch - 46ms/step
Epoch 6/50
1497/1497 - 69s - loss: 9.1718 - accuracy10: 0.6531 - accuracy20: 0.6484 - accuracy30: 0.6276 - accuracy50: 0.5905 - val_loss: 9.0613 - val_accuracy10: 0.6934 - val_accuracy20: 0.6842 - val_accuracy30: 0.6601 - val_accuracy50: 0.6091 - 69s/epoch - 46ms/step
Epoch 7/50
1497/1497 - 70s - loss: 9.1169 - accuracy10: 0.6540 - accuracy20: 0.6502 - accuracy30: 0.6290 - accuracy50: 0.5925 - val_loss: 9.0350 - val_accuracy10: 0.6869 - val_accuracy20: 0.6781 - val_accuracy30: 0.6546 - val_accuracy50: 0.6050 - 70s/epoch - 47ms/step
Epoch 8/50
1497/1497 - 68s - loss: 9.0820 - accuracy10: 0.6550 - accuracy20: 0.6511 - accuracy30: 0.6301 - accuracy50: 0.5929 - val_loss: 8.9480 - val_accuracy10: 0.6828 - val_accuracy20: 0.6761 - val_accuracy30: 0.6539 - val_accuracy50: 0.6056 - 68s/epoch - 46ms/step
Epoch 9/50
1497/1497 - 69s - loss: 9.0459 - accuracy10: 0.6570 - accuracy20: 0.6526 - accuracy30: 0.6313 - accuracy50: 0.5945 - val_loss: 8.8973 - val_accuracy10: 0.6818 - val_accuracy20: 0.6741 - val_accuracy30: 0.6522 - val_accuracy50: 0.6036 - 69s/epoch - 46ms/step
Epoch 10/50
1497/1497 - 68s - loss: 9.0093 - accuracy10: 0.6587 - accuracy20: 0.6541 - accuracy30: 0.6327 - accuracy50: 0.5957 - val_loss: 8.8860 - val_accuracy10: 0.6810 - val_accuracy20: 0.6736 - val_accuracy30: 0.6508 - val_accuracy50: 0.6038 - 68s/epoch - 46ms/step
Epoch 11/50
1497/1497 - 69s - loss: 8.9847 - accuracy10: 0.6594 - accuracy20: 0.6544 - accuracy30: 0.6329 - accuracy50: 0.5963 - val_loss: 8.8578 - val_accuracy10: 0.6723 - val_accuracy20: 0.6673 - val_accuracy30: 0.6462 - val_accuracy50: 0.6023 - 69s/epoch - 46ms/step
Epoch 12/50
1497/1497 - 70s - loss: 8.9581 - accuracy10: 0.6596 - accuracy20: 0.6547 - accuracy30: 0.6342 - accuracy50: 0.5972 - val_loss: 8.8983 - val_accuracy10: 0.6674 - val_accuracy20: 0.6621 - val_accuracy30: 0.6421 - val_accuracy50: 0.5986 - 70s/epoch - 46ms/step
Epoch 13/50
1497/1497 - 70s - loss: 8.9352 - accuracy10: 0.6611 - accuracy20: 0.6562 - accuracy30: 0.6352 - accuracy50: 0.5980 - val_loss: 8.8969 - val_accuracy10: 0.6746 - val_accuracy20: 0.6674 - val_accuracy30: 0.6472 - val_accuracy50: 0.6009 - 70s/epoch - 47ms/step
Epoch 14/50
1497/1497 - 69s - loss: 8.9091 - accuracy10: 0.6617 - accuracy20: 0.6565 - accuracy30: 0.6360 - accuracy50: 0.5992 - val_loss: 8.9059 - val_accuracy10: 0.6726 - val_accuracy20: 0.6663 - val_accuracy30: 0.6454 - val_accuracy50: 0.6010 - 69s/epoch - 46ms/step
Epoch 15/50
1497/1497 - 68s - loss: 8.8914 - accuracy10: 0.6620 - accuracy20: 0.6576 - accuracy30: 0.6367 - accuracy50: 0.5997 - val_loss: 9.0061 - val_accuracy10: 0.6732 - val_accuracy20: 0.6672 - val_accuracy30: 0.6461 - val_accuracy50: 0.6013 - 68s/epoch - 45ms/step
Epoch 16/50
1497/1497 - 68s - loss: 8.8703 - accuracy10: 0.6633 - accuracy20: 0.6582 - accuracy30: 0.6376 - accuracy50: 0.6004 - val_loss: 8.9010 - val_accuracy10: 0.6779 - val_accuracy20: 0.6700 - val_accuracy30: 0.6483 - val_accuracy50: 0.6026 - 68s/epoch - 45ms/step
Epoch 17/50
1497/1497 - 68s - loss: 8.8475 - accuracy10: 0.6636 - accuracy20: 0.6595 - accuracy30: 0.6385 - accuracy50: 0.6011 - val_loss: 8.9002 - val_accuracy10: 0.6770 - val_accuracy20: 0.6695 - val_accuracy30: 0.6474 - val_accuracy50: 0.6029 - 68s/epoch - 46ms/step
Epoch 18/50
1497/1497 - 68s - loss: 8.8321 - accuracy10: 0.6650 - accuracy20: 0.6600 - accuracy30: 0.6388 - accuracy50: 0.6018 - val_loss: 8.9032 - val_accuracy10: 0.6844 - val_accuracy20: 0.6746 - val_accuracy30: 0.6525 - val_accuracy50: 0.6059 - 68s/epoch - 46ms/step
Epoch 19/50
1497/1497 - 68s - loss: 8.8126 - accuracy10: 0.6653 - accuracy20: 0.6597 - accuracy30: 0.6389 - accuracy50: 0.6029 - val_loss: 8.8756 - val_accuracy10: 0.6743 - val_accuracy20: 0.6659 - val_accuracy30: 0.6446 - val_accuracy50: 0.6014 - 68s/epoch - 45ms/step
Epoch 20/50
1497/1497 - 69s - loss: 8.7942 - accuracy10: 0.6659 - accuracy20: 0.6610 - accuracy30: 0.6400 - accuracy50: 0.6036 - val_loss: 8.8615 - val_accuracy10: 0.6793 - val_accuracy20: 0.6704 - val_accuracy30: 0.6483 - val_accuracy50: 0.6033 - 69s/epoch - 46ms/step
Epoch 21/50
1497/1497 - 69s - loss: 8.7782 - accuracy10: 0.6663 - accuracy20: 0.6607 - accuracy30: 0.6406 - accuracy50: 0.6041 - val_loss: 8.8738 - val_accuracy10: 0.6761 - val_accuracy20: 0.6671 - val_accuracy30: 0.6453 - val_accuracy50: 0.6013 - 69s/epoch - 46ms/step
testing model: results/EXC/W0/deepVOL_L3/seq2seq
Evaluating performance on  test set...
4693/4693 - 97s - 97s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6909976
{'0': {'precision': 0.36670236757352, 'recall': 0.7108175677651394, 'f1-score': 0.4838119026176604, 'support': 136796}, '1': {'precision': 0.9416965921141425, 'recall': 0.6753119652949412, 'f1-score': 0.7865622892572798, 'support': 925744}, '2': {'precision': 0.3626108747253393, 'recall': 0.7117531662002712, 'f1-score': 0.48045062632970303, 'support': 138652}, 'accuracy': 0.6835618285836069, 'macro avg': {'precision': 0.5570032781376673, 'recall': 0.6992942330867838, 'f1-score': 0.5836082727348811, 'support': 1201192}, 'weighted avg': {'precision': 0.8093711163969787, 'recall': 0.6835618285836069, 'f1-score': 0.7167499393756724, 'support': 1201192}}
[[ 97237  19034  20525]
 [147635 625166 152943]
 [ 20294  19672  98686]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7010124
{'0': {'precision': 0.4489636550422035, 'recall': 0.6794957321076822, 'f1-score': 0.5406820855877601, 'support': 190375}, '1': {'precision': 0.8907097698065517, 'recall': 0.6790968676382049, 'f1-score': 0.7706404091079174, 'support': 818839}, '2': {'precision': 0.45274844768893524, 'recall': 0.6809999062392565, 'f1-score': 0.5438978576822031, 'support': 191978}, 'accuracy': 0.6794642321960186, 'macro avg': {'precision': 0.5974739575125635, 'recall': 0.6798641686617145, 'f1-score': 0.6184067841259602, 'support': 1201192}, 'weighted avg': {'precision': 0.7507018815624088, 'recall': 0.6794642321960186, 'f1-score': 0.6979560277785748, 'support': 1201192}}
[[129359  33371  27645]
 [132387 556071 130381]
 [ 26382  34859 130737]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.73790944
{'0': {'precision': 0.48477634341127646, 'recall': 0.6551495016611296, 'f1-score': 0.5572309482689708, 'support': 228760}, '1': {'precision': 0.8390676855000615, 'recall': 0.6618204880649892, 'f1-score': 0.7399780941949619, 'support': 742647}, '2': {'precision': 0.4904674679283109, 'recall': 0.6537154296407511, 'f1-score': 0.5604456284091842, 'support': 229785}, 'accuracy': 0.658999560436633, 'macro avg': {'precision': 0.6047704989465497, 'recall': 0.6568951397889565, 'f1-score': 0.6192182236243723, 'support': 1201192}, 'weighted avg': {'precision': 0.7049086264895492, 'recall': 0.658999560436633, 'f1-score': 0.6708308598205949, 'support': 1201192}}
[[149872  45867  33021]
 [128116 491499 123032]
 [ 31169  48402 150214]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8116957
{'0': {'precision': 0.5190753577952794, 'recall': 0.5998797619006009, 'f1-score': 0.5565599487624344, 'support': 286099}, '1': {'precision': 0.7318965246427536, 'recall': 0.6312383854546846, 'f1-score': 0.6778509993590616, 'support': 627446}, '2': {'precision': 0.5265525814883288, 'recall': 0.6029890803658651, 'f1-score': 0.5621845879588364, 'support': 287647}, 'accuracy': 0.617004608755303, 'macro avg': {'precision': 0.5925081546421206, 'recall': 0.6113690759070501, 'f1-score': 0.5988651786934441, 'support': 1201192}, 'weighted avg': {'precision': 0.6320336449112566, 'recall': 0.617004608755303, 'f1-score': 0.6212635890826985, 'support': 1201192}}
[[171625  70145  44329]
 [119752 396068 111626]
 [ 39259  74940 173448]]
Evaluating performance on  train set...
1497/1497 - 31s - 31s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7274022
{'0': {'precision': 0.3896823285881142, 'recall': 0.6832319545823196, 'f1-score': 0.4962995147025252, 'support': 49320}, '1': {'precision': 0.9265191654832979, 'recall': 0.6434754944414005, 'f1-score': 0.7594833197042773, 'support': 282895}, '2': {'precision': 0.3604283304891071, 'recall': 0.7090744885538147, 'f1-score': 0.4779240027260035, 'support': 50934}, 'accuracy': 0.6573134733484884, 'macro avg': {'precision': 0.5588766081868398, 'recall': 0.6785939791925116, 'f1-score': 0.5779022790442686, 'support': 383149}, 'weighted avg': {'precision': 0.7821626269427704, 'recall': 0.6573134733484884, 'f1-score': 0.6881764194809756, 'support': 383149}}
[[ 33697   7232   8391]
 [ 45163 182036  55696]
 [  7613   7205  36116]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7414082
{'0': {'precision': 0.47296076406814663, 'recall': 0.652588151489968, 'f1-score': 0.5484410077326016, 'support': 67384}, '1': {'precision': 0.8662741295917034, 'recall': 0.6442349757765283, 'f1-score': 0.7389350926915392, 'support': 246868}, '2': {'precision': 0.43661628245184414, 'recall': 0.6754285382527541, 'f1-score': 0.5303798766796978, 'support': 68897}, 'accuracy': 0.6513131966937145, 'macro avg': {'precision': 0.5919503920372313, 'recall': 0.6574172218397502, 'f1-score': 0.605918659034613, 'support': 383149}, 'weighted avg': {'precision': 0.7198424162978302, 'recall': 0.6513131966937145, 'f1-score': 0.6679311695743162, 'support': 383149}}
[[ 43974  12132  11278]
 [ 39059 159041  48768]
 [  9943  12419  46535]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7818035
{'0': {'precision': 0.5058323747250307, 'recall': 0.627145573737677, 'f1-score': 0.5599941910475105, 'support': 79932}, '1': {'precision': 0.8071577545261756, 'recall': 0.6231401007581668, 'f1-score': 0.7033113594135763, 'support': 221719}, '2': {'precision': 0.46882419646337575, 'recall': 0.6493288178851014, 'f1-score': 0.5445069813863994, 'support': 81498}, 'accuracy': 0.6295462078721333, 'macro avg': {'precision': 0.5939381085715273, 'recall': 0.6332048307936485, 'f1-score': 0.6026041772824954, 'support': 383149}, 'weighted avg': {'precision': 0.6723301846427433, 'recall': 0.6295462078721333, 'f1-score': 0.6396341291394656, 'support': 383149}}
[[ 50129  16257  13546]
 [ 37146 138162  46411]
 [ 11827  16752  52919]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8556368
{'0': {'precision': 0.5415763040748773, 'recall': 0.5758657658386601, 'f1-score': 0.5581949373541695, 'support': 98872}, '1': {'precision': 0.687289117508499, 'recall': 0.5876000805543007, 'f1-score': 0.6335470430304719, 'support': 183727}, '2': {'precision': 0.501475950685883, 'recall': 0.6031626056688215, 'f1-score': 0.547638934664927, 'support': 100550}, 'accuracy': 0.5886561102860767, 'macro avg': {'precision': 0.5767804574230865, 'recall': 0.5888761506872607, 'f1-score': 0.5797936383498561, 'support': 383149}, 'weighted avg': {'precision': 0.6009247234638243, 'recall': 0.5886561102860767, 'f1-score': 0.591557441886836, 'support': 383149}}
[[ 56937  24017  17918]
 [ 33396 107958  42373]
 [ 14799  25103  60648]]
Evaluating performance on  val set...
547/547 - 11s - 11s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7017508
{'0': {'precision': 0.386789564980783, 'recall': 0.6792903649722238, 'f1-score': 0.4929131810498028, 'support': 16741}, '1': {'precision': 0.9330337439313084, 'recall': 0.6609191590954308, 'f1-score': 0.773749182018833, 'support': 105553}, '2': {'precision': 0.36354204637859966, 'recall': 0.7392097611038257, 'f1-score': 0.4873876921920229, 'support': 17539}, 'accuracy': 0.6729384337030601, 'macro avg': {'precision': 0.561121785096897, 'recall': 0.6931397617238267, 'f1-score': 0.5846833517535529, 'support': 139833}, 'weighted avg': {'precision': 0.7962063234855788, 'recall': 0.6729384337030601, 'f1-score': 0.7042093047202342, 'support': 139833}}
[[11372  2575  2794]
 [15887 69762 19904]
 [ 2142  2432 12965]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7150307
{'0': {'precision': 0.47304955607329513, 'recall': 0.6509965337954939, 'f1-score': 0.5479377119725757, 'support': 23080}, '1': {'precision': 0.8751816912246702, 'recall': 0.662220592833806, 'f1-score': 0.7539514470736274, 'support': 92741}, '2': {'precision': 0.44444151252078, 'recall': 0.7014409461935699, 'f1-score': 0.5441212101633043, 'support': 24012}, 'accuracy': 0.6671029013180008, 'macro avg': {'precision': 0.5975575866062485, 'recall': 0.6715526909409566, 'f1-score': 0.6153367897365024, 'support': 139833}, 'weighted avg': {'precision': 0.7348418368960672, 'recall': 0.6671029013180008, 'f1-score': 0.6839161860492414, 'support': 139833}}
[[15025  4374  3681]
 [13953 61415 17373]
 [ 2784  4385 16843]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7543788
{'0': {'precision': 0.5093441466854725, 'recall': 0.6281572748686356, 'f1-score': 0.5625456374640986, 'support': 27595}, '1': {'precision': 0.8171908967907691, 'recall': 0.6429442862952419, 'f1-score': 0.7196706496636208, 'support': 83606}, '2': {'precision': 0.4815601419219429, 'recall': 0.6731279687063425, 'f1-score': 0.5614530835785242, 'support': 28632}, 'accuracy': 0.6462065463803252, 'macro avg': {'precision': 0.6026983951327282, 'recall': 0.6480765099567399, 'f1-score': 0.6145564569020813, 'support': 139833}, 'weighted avg': {'precision': 0.687716374735461, 'recall': 0.6462065463803252, 'f1-score': 0.6562668031910834, 'support': 139833}}
[[17334  5944  4317]
 [13420 53754 16432]
 [ 3278  6081 19273]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.83533716
{'0': {'precision': 0.5481367736982095, 'recall': 0.5756825250547172, 'f1-score': 0.5615720646692793, 'support': 34724}, '1': {'precision': 0.6938866137070114, 'recall': 0.6069137152228328, 'f1-score': 0.6474926140505697, 'support': 69514}, '2': {'precision': 0.515048281371144, 'recall': 0.6158730158730159, 'f1-score': 0.5609662478569053, 'support': 35595}, 'accuracy': 0.6014388592106298, 'macro avg': {'precision': 0.5856905562587883, 'recall': 0.5994897520501886, 'f1-score': 0.590010308858918, 'support': 139833}, 'weighted avg': {'precision': 0.6121693661047942, 'recall': 0.6014388592106298, 'f1-score': 0.6041308098886092, 'support': 139833}}
[[19990  9129  5605]
 [12289 42189 15036]
 [ 4190  9483 21922]]
training model: results/EXC/W1/deepLOB_L1/seq2seq
Epoch 1/50
1290/1290 - 41s - loss: 10.6912 - accuracy10: 0.4974 - accuracy20: 0.5103 - accuracy30: 0.5124 - accuracy50: 0.5120 - val_loss: 11.4676 - val_accuracy10: 0.5751 - val_accuracy20: 0.5656 - val_accuracy30: 0.5511 - val_accuracy50: 0.5222 - 41s/epoch - 32ms/step
Epoch 2/50
1290/1290 - 35s - loss: 9.7769 - accuracy10: 0.5837 - accuracy20: 0.5937 - accuracy30: 0.5897 - accuracy50: 0.5761 - val_loss: 10.3394 - val_accuracy10: 0.6792 - val_accuracy20: 0.6648 - val_accuracy30: 0.6382 - val_accuracy50: 0.5915 - 35s/epoch - 27ms/step
Epoch 3/50
1290/1290 - 34s - loss: 9.2014 - accuracy10: 0.6398 - accuracy20: 0.6329 - accuracy30: 0.6128 - accuracy50: 0.5874 - val_loss: 10.1670 - val_accuracy10: 0.7186 - val_accuracy20: 0.6944 - val_accuracy30: 0.6605 - val_accuracy50: 0.6061 - 34s/epoch - 27ms/step
Epoch 4/50
1290/1290 - 35s - loss: 8.9228 - accuracy10: 0.6592 - accuracy20: 0.6498 - accuracy30: 0.6253 - accuracy50: 0.5962 - val_loss: 10.1556 - val_accuracy10: 0.7154 - val_accuracy20: 0.6934 - val_accuracy30: 0.6609 - val_accuracy50: 0.6094 - 35s/epoch - 27ms/step
Epoch 5/50
1290/1290 - 35s - loss: 8.7348 - accuracy10: 0.6695 - accuracy20: 0.6583 - accuracy30: 0.6333 - accuracy50: 0.6028 - val_loss: 10.4242 - val_accuracy10: 0.7289 - val_accuracy20: 0.7062 - val_accuracy30: 0.6735 - val_accuracy50: 0.6182 - 35s/epoch - 27ms/step
Epoch 6/50
1290/1290 - 35s - loss: 8.6273 - accuracy10: 0.6718 - accuracy20: 0.6621 - accuracy30: 0.6377 - accuracy50: 0.6072 - val_loss: 10.0248 - val_accuracy10: 0.7241 - val_accuracy20: 0.7046 - val_accuracy30: 0.6737 - val_accuracy50: 0.6202 - 35s/epoch - 27ms/step
Epoch 7/50
1290/1290 - 35s - loss: 8.5599 - accuracy10: 0.6723 - accuracy20: 0.6633 - accuracy30: 0.6394 - accuracy50: 0.6085 - val_loss: 10.0296 - val_accuracy10: 0.7427 - val_accuracy20: 0.7215 - val_accuracy30: 0.6908 - val_accuracy50: 0.6340 - 35s/epoch - 27ms/step
Epoch 8/50
1290/1290 - 34s - loss: 8.5002 - accuracy10: 0.6744 - accuracy20: 0.6650 - accuracy30: 0.6413 - accuracy50: 0.6108 - val_loss: 10.3356 - val_accuracy10: 0.7480 - val_accuracy20: 0.7204 - val_accuracy30: 0.6878 - val_accuracy50: 0.6281 - 34s/epoch - 26ms/step
Epoch 9/50
1290/1290 - 35s - loss: 8.4465 - accuracy10: 0.6763 - accuracy20: 0.6665 - accuracy30: 0.6429 - accuracy50: 0.6128 - val_loss: 10.2381 - val_accuracy10: 0.7474 - val_accuracy20: 0.7199 - val_accuracy30: 0.6845 - val_accuracy50: 0.6264 - 35s/epoch - 27ms/step
Epoch 10/50
1290/1290 - 35s - loss: 8.4131 - accuracy10: 0.6787 - accuracy20: 0.6682 - accuracy30: 0.6444 - accuracy50: 0.6139 - val_loss: 10.0566 - val_accuracy10: 0.7484 - val_accuracy20: 0.7230 - val_accuracy30: 0.6893 - val_accuracy50: 0.6334 - 35s/epoch - 27ms/step
Epoch 11/50
1290/1290 - 34s - loss: 8.3744 - accuracy10: 0.6789 - accuracy20: 0.6683 - accuracy30: 0.6450 - accuracy50: 0.6149 - val_loss: 10.2383 - val_accuracy10: 0.7564 - val_accuracy20: 0.7286 - val_accuracy30: 0.6932 - val_accuracy50: 0.6351 - 34s/epoch - 27ms/step
Epoch 12/50
1290/1290 - 34s - loss: 8.3433 - accuracy10: 0.6803 - accuracy20: 0.6691 - accuracy30: 0.6461 - accuracy50: 0.6163 - val_loss: 10.3733 - val_accuracy10: 0.7504 - val_accuracy20: 0.7209 - val_accuracy30: 0.6851 - val_accuracy50: 0.6266 - 34s/epoch - 27ms/step
Epoch 13/50
1290/1290 - 34s - loss: 8.3196 - accuracy10: 0.6797 - accuracy20: 0.6697 - accuracy30: 0.6471 - accuracy50: 0.6159 - val_loss: 10.2172 - val_accuracy10: 0.7472 - val_accuracy20: 0.7184 - val_accuracy30: 0.6831 - val_accuracy50: 0.6253 - 34s/epoch - 26ms/step
Epoch 14/50
1290/1290 - 34s - loss: 8.2834 - accuracy10: 0.6807 - accuracy20: 0.6714 - accuracy30: 0.6481 - accuracy50: 0.6176 - val_loss: 10.2296 - val_accuracy10: 0.7481 - val_accuracy20: 0.7150 - val_accuracy30: 0.6747 - val_accuracy50: 0.6137 - 34s/epoch - 27ms/step
Epoch 15/50
1290/1290 - 34s - loss: 8.2690 - accuracy10: 0.6812 - accuracy20: 0.6717 - accuracy30: 0.6486 - accuracy50: 0.6178 - val_loss: 10.3010 - val_accuracy10: 0.7422 - val_accuracy20: 0.7139 - val_accuracy30: 0.6769 - val_accuracy50: 0.6183 - 34s/epoch - 27ms/step
Epoch 16/50
1290/1290 - 34s - loss: 8.2490 - accuracy10: 0.6815 - accuracy20: 0.6716 - accuracy30: 0.6488 - accuracy50: 0.6190 - val_loss: 10.3648 - val_accuracy10: 0.7473 - val_accuracy20: 0.7151 - val_accuracy30: 0.6772 - val_accuracy50: 0.6172 - 34s/epoch - 26ms/step
testing model: results/EXC/W1/deepLOB_L1/seq2seq
Evaluating performance on  test set...
5343/5343 - 71s - 71s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6108157
{'0': {'precision': 0.4099232929991357, 'recall': 0.5880924549382277, 'f1-score': 0.48310419192173737, 'support': 154843}, '1': {'precision': 0.8493534896612265, 'recall': 0.8502704079651742, 'f1-score': 0.8498117014822533, 'support': 1055997}, '2': {'precision': 0.45985673611424954, 'recall': 0.25932627796290514, 'f1-score': 0.33163446143316344, 'support': 156949}, 'accuracy': 0.7527813134920663, 'macro avg': {'precision': 0.5730445062582039, 'recall': 0.565896380288769, 'f1-score': 0.5548501182790514, 'support': 1367789}, 'weighted avg': {'precision': 0.7549136192468624, 'recall': 0.7527813134920663, 'f1-score': 0.7488388975253977, 'support': 1367789}}
[[ 91062  55978   7803]
 [118110 897883  40004]
 [ 12972 103276  40701]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.70987946
{'0': {'precision': 0.49030473119563706, 'recall': 0.5619522121390474, 'f1-score': 0.5236892568168, 'support': 219177}, '1': {'precision': 0.7718442487226392, 'recall': 0.844715478725355, 'f1-score': 0.806637420184193, 'support': 927066}, '2': {'precision': 0.5546219311318534, 'recall': 0.25532846451752683, 'f1-score': 0.34967762673936287, 'support': 221546}, 'accuracy': 0.7039397158479853, 'macro avg': {'precision': 0.6055903036833766, 'recall': 0.5539987184606431, 'f1-score': 0.5600014345801186, 'support': 1367789}, 'weighted avg': {'precision': 0.6915455166769918, 'recall': 0.7039397158479853, 'f1-score': 0.6872817710300446, 'support': 1367789}}
[[123167  86138   9872]
 [108406 783107  35553]
 [ 19632 145347  56567]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.79246724
{'0': {'precision': 0.5165166871453227, 'recall': 0.5420934150304874, 'f1-score': 0.5289960756643912, 'support': 268308}, '1': {'precision': 0.7049748592157398, 'recall': 0.8233846450803455, 'f1-score': 0.7595928479055885, 'support': 828920}, '2': {'precision': 0.5875032825908325, 'recall': 0.25633036542591137, 'f1-score': 0.356930377140975, 'support': 270561}, 'accuracy': 0.6560375905932859, 'macro avg': {'precision': 0.6029982763172983, 'recall': 0.5406028085122481, 'f1-score': 0.5485064335703181, 'support': 1367789}, 'weighted avg': {'precision': 0.6447696210722242, 'recall': 0.6560375905932859, 'f1-score': 0.6347082936950811, 'support': 1367789}}
[[145448 111155  11705]
 [109411 682520  36989]
 [ 26735 174473  69353]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.92073476
{'0': {'precision': 0.5446486776679917, 'recall': 0.49214021714021716, 'f1-score': 0.5170647946460535, 'support': 346320}, '1': {'precision': 0.5819022629230762, 'recall': 0.7959538997715192, 'f1-score': 0.6723014898067504, 'support': 673142}, '2': {'precision': 0.6181385671993498, 'recall': 0.2379746617402613, 'f1-score': 0.343649207757427, 'support': 348327}, 'accuracy': 0.5769318220865938, 'macro avg': {'precision': 0.5815631692634726, 'recall': 0.5086895928839993, 'f1-score': 0.511005164070077, 'support': 1367789}, 'weighted avg': {'precision': 0.5816978611579654, 'recall': 0.5769318220865938, 'f1-score': 0.5493000358416672, 'support': 1367789}}
[[170438 160322  15560]
 [101704 535790  35648]
 [ 40790 224644  82893]]
Evaluating performance on  train set...
1290/1290 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.60942066
{'0': {'precision': 0.35360257418139934, 'recall': 0.6080736944697708, 'f1-score': 0.44717007306020523, 'support': 31807}, '1': {'precision': 0.9212379099421917, 'recall': 0.7435127899051442, 'f1-score': 0.8228885786326033, 'support': 265561}, '2': {'precision': 0.3585223463230364, 'recall': 0.668231278002987, 'f1-score': 0.4666666666666667, 'support': 32809}, 'accuracy': 0.7229849444388918, 'macro avg': {'precision': 0.5444542768155425, 'recall': 0.6732725874593006, 'f1-score': 0.5789084394531584, 'support': 330177}, 'weighted avg': {'precision': 0.8106399214350444, 'recall': 0.7229849444388918, 'f1-score': 0.7512973920374387, 'support': 330177}}
[[ 19341   8454   4012]
 [ 32898 197448  35215]
 [  2458   8427  21924]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.65365785
{'0': {'precision': 0.4356580877450327, 'recall': 0.5832496485238, 'f1-score': 0.49876434834880695, 'support': 44811}, '1': {'precision': 0.8680937411801345, 'recall': 0.7458577395361672, 'f1-score': 0.802346840333451, 'support': 239181}, '2': {'precision': 0.44993274894485413, 'recall': 0.6301396557323806, 'f1-score': 0.5250027059205541, 'support': 46185}, 'accuracy': 0.707602286046575, 'macro avg': {'precision': 0.5845615259566738, 'recall': 0.6530823479307827, 'f1-score': 0.6087046315342707, 'support': 330177}, 'weighted avg': {'precision': 0.7509122309826746, 'recall': 0.707602286046575, 'f1-score': 0.7223504326606468, 'support': 330177}}
[[ 26136  13337   5338]
 [ 30544 178395  30242]
 [  3312  13770  29103]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7098915
{'0': {'precision': 0.4745182866961217, 'recall': 0.5656005997769122, 'f1-score': 0.5160714434683952, 'support': 54687}, '1': {'precision': 0.8168310536194803, 'recall': 0.7322155699544474, 'f1-score': 0.7722122838401907, 'support': 219307}, '2': {'precision': 0.4931290567803052, 'recall': 0.6003951373191179, 'f1-score': 0.5415011196994871, 'support': 56183}, 'accuracy': 0.6821886442726174, 'macro avg': {'precision': 0.5948261323653025, 'recall': 0.6327371023501592, 'f1-score': 0.6099282823360244, 'support': 330177}, 'weighted avg': {'precision': 0.7050528026415106, 'recall': 0.6821886442726174, 'f1-score': 0.69052997564692, 'support': 330177}}
[[ 30931  17427   6329]
 [ 30384 160580  28343]
 [  3869  18582  33732]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.80863786
{'0': {'precision': 0.5187793090590985, 'recall': 0.513397292157475, 'f1-score': 0.5160742690433902, 'support': 70462}, '1': {'precision': 0.7111229957850592, 'recall': 0.7164264299508146, 'f1-score': 0.7137648615754201, 'support': 187454}, '2': {'precision': 0.5410229907534151, 'recall': 0.536029116674278, 'f1-score': 0.5385144763824684, 'support': 72261}, 'accuracy': 0.6336177262498599, 'macro avg': {'precision': 0.5903084318658576, 'recall': 0.5886176129275226, 'f1-score': 0.5894512023337595, 'support': 330177}, 'weighted avg': {'precision': 0.6328482603623123, 'recall': 0.6336177262498599, 'f1-score': 0.633221872162409, 'support': 330177}}
[[ 36175  26254   8033]
 [ 28330 134297  24827]
 [  5226  28301  38734]]
Evaluating performance on  val set...
363/363 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.61094993
{'0': {'precision': 0.35200901737170137, 'recall': 0.5848848738570012, 'f1-score': 0.4395049463967879, 'support': 9077}, '1': {'precision': 0.9195251524890142, 'recall': 0.7497626910170194, 'f1-score': 0.82601170968811, 'support': 74797}, '2': {'precision': 0.35423870275426256, 'recall': 0.6624303232998885, 'f1-score': 0.461622125543816, 'support': 8970}, 'accuracy': 0.7252057214251864, 'macro avg': {'precision': 0.5419242908716594, 'recall': 0.665692629391303, 'f1-score': 0.5757129272095712, 'support': 92844}, 'weighted avg': {'precision': 0.8094268864451065, 'recall': 0.7252057214251864, 'f1-score': 0.7530194165924909, 'support': 92844}}
[[ 5309  2634  1134]
 [ 9019 56080  9698]
 [  754  2274  5942]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6635258
{'0': {'precision': 0.42736526946107783, 'recall': 0.560688192316757, 'f1-score': 0.4850317713819702, 'support': 12729}, '1': {'precision': 0.8651038453629447, 'recall': 0.7476120662845973, 'f1-score': 0.8020781201591956, 'support': 67527}, '2': {'precision': 0.4385540814031932, 'recall': 0.6197171909755322, 'f1-score': 0.5136291809323151, 'support': 12588}, 'accuracy': 0.7046443496617982, 'macro avg': {'precision': 0.5770077320757386, 'recall': 0.6426724831922955, 'f1-score': 0.6002463574911604, 'support': 92844}, 'weighted avg': {'precision': 0.7472568895943413, 'recall': 0.7046443496617982, 'f1-score': 0.7195022055004856, 'support': 92844}}
[[ 7137  4045  1547]
 [ 8603 50484  8440]
 [  960  3827  7801]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.72484356
{'0': {'precision': 0.4583129915920803, 'recall': 0.5455191115702479, 'f1-score': 0.498128113669192, 'support': 15488}, '1': {'precision': 0.8133878993293431, 'recall': 0.7270251542936332, 'f1-score': 0.7677855775366943, 'support': 62057}, '2': {'precision': 0.47431497808985795, 'recall': 0.5872279233936859, 'f1-score': 0.524766355140187, 'support': 15299}, 'accuracy': 0.6737107405971307, 'macro avg': {'precision': 0.5820052896704271, 'recall': 0.6199240630858557, 'f1-score': 0.5968933487820244, 'support': 92844}, 'weighted avg': {'precision': 0.6982821650538098, 'recall': 0.6737107405971307, 'f1-score': 0.6827568639545131, 'support': 92844}}
[[ 8449  5163  1876]
 [ 8859 45117  8081]
 [ 1127  5188  8984]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8236289
{'0': {'precision': 0.49107276819204804, 'recall': 0.49500907441016334, 'f1-score': 0.49303306469835056, 'support': 19836}, '1': {'precision': 0.7079786630348428, 'recall': 0.7006889321551595, 'f1-score': 0.7043149357370015, 'support': 53416}, '2': {'precision': 0.513086123204724, 'recall': 0.523325847284606, 'f1-score': 0.5181554011370815, 'support': 19592}, 'accuracy': 0.6193184266080738, 'macro avg': {'precision': 0.5707125181438717, 'recall': 0.5730079512833096, 'f1-score': 0.5718344671908112, 'support': 92844}, 'weighted avg': {'precision': 0.6205106524961611, 'recall': 0.6193184266080738, 'f1-score': 0.6198913349032986, 'support': 92844}}
[[ 9819  7598  2419]
 [ 8677 37428  7311]
 [ 1499  7840 10253]]
training model: results/EXC/W1/deepOF_L1/seq2seq
Epoch 1/50
1290/1290 - 39s - loss: 11.8797 - accuracy10: 0.3867 - accuracy20: 0.4106 - accuracy30: 0.4222 - accuracy50: 0.4339 - val_loss: 12.5934 - val_accuracy10: 0.6972 - val_accuracy20: 0.6614 - val_accuracy30: 0.6292 - val_accuracy50: 0.5712 - 39s/epoch - 30ms/step
Epoch 2/50
1290/1290 - 34s - loss: 11.4142 - accuracy10: 0.4376 - accuracy20: 0.4606 - accuracy30: 0.4721 - accuracy50: 0.4786 - val_loss: 12.0548 - val_accuracy10: 0.6933 - val_accuracy20: 0.6652 - val_accuracy30: 0.6373 - val_accuracy50: 0.5817 - 34s/epoch - 26ms/step
Epoch 3/50
1290/1290 - 32s - loss: 11.1808 - accuracy10: 0.4712 - accuracy20: 0.4845 - accuracy30: 0.4921 - accuracy50: 0.4945 - val_loss: 11.7033 - val_accuracy10: 0.6751 - val_accuracy20: 0.6481 - val_accuracy30: 0.6227 - val_accuracy50: 0.5748 - 32s/epoch - 25ms/step
Epoch 4/50
1290/1290 - 32s - loss: 11.0190 - accuracy10: 0.4872 - accuracy20: 0.4967 - accuracy30: 0.5015 - accuracy50: 0.5024 - val_loss: 11.5488 - val_accuracy10: 0.6632 - val_accuracy20: 0.6388 - val_accuracy30: 0.6165 - val_accuracy50: 0.5722 - 32s/epoch - 25ms/step
Epoch 5/50
1290/1290 - 33s - loss: 10.8826 - accuracy10: 0.5015 - accuracy20: 0.5093 - accuracy30: 0.5120 - accuracy50: 0.5115 - val_loss: 11.3769 - val_accuracy10: 0.6613 - val_accuracy20: 0.6397 - val_accuracy30: 0.6176 - val_accuracy50: 0.5757 - 33s/epoch - 26ms/step
Epoch 6/50
1290/1290 - 33s - loss: 10.7431 - accuracy10: 0.5175 - accuracy20: 0.5236 - accuracy30: 0.5249 - accuracy50: 0.5214 - val_loss: 11.1467 - val_accuracy10: 0.6309 - val_accuracy20: 0.6129 - val_accuracy30: 0.5976 - val_accuracy50: 0.5671 - 33s/epoch - 26ms/step
Epoch 7/50
1290/1290 - 34s - loss: 10.6133 - accuracy10: 0.5334 - accuracy20: 0.5372 - accuracy30: 0.5356 - accuracy50: 0.5290 - val_loss: 10.9858 - val_accuracy10: 0.6231 - val_accuracy20: 0.6069 - val_accuracy30: 0.5941 - val_accuracy50: 0.5665 - 34s/epoch - 26ms/step
Epoch 8/50
1290/1290 - 33s - loss: 10.5063 - accuracy10: 0.5414 - accuracy20: 0.5441 - accuracy30: 0.5414 - accuracy50: 0.5333 - val_loss: 10.9752 - val_accuracy10: 0.6213 - val_accuracy20: 0.6043 - val_accuracy30: 0.5878 - val_accuracy50: 0.5608 - 33s/epoch - 26ms/step
Epoch 9/50
1290/1290 - 34s - loss: 10.4319 - accuracy10: 0.5477 - accuracy20: 0.5497 - accuracy30: 0.5461 - accuracy50: 0.5376 - val_loss: 10.9100 - val_accuracy10: 0.6254 - val_accuracy20: 0.6052 - val_accuracy30: 0.5884 - val_accuracy50: 0.5621 - 34s/epoch - 26ms/step
Epoch 10/50
1290/1290 - 33s - loss: 10.3633 - accuracy10: 0.5528 - accuracy20: 0.5555 - accuracy30: 0.5510 - accuracy50: 0.5417 - val_loss: 10.8377 - val_accuracy10: 0.6085 - val_accuracy20: 0.5908 - val_accuracy30: 0.5774 - val_accuracy50: 0.5533 - 33s/epoch - 26ms/step
Epoch 11/50
1290/1290 - 33s - loss: 10.2914 - accuracy10: 0.5562 - accuracy20: 0.5583 - accuracy30: 0.5534 - accuracy50: 0.5439 - val_loss: 10.8126 - val_accuracy10: 0.6097 - val_accuracy20: 0.5943 - val_accuracy30: 0.5793 - val_accuracy50: 0.5551 - 33s/epoch - 25ms/step
Epoch 12/50
1290/1290 - 32s - loss: 10.2435 - accuracy10: 0.5599 - accuracy20: 0.5624 - accuracy30: 0.5565 - accuracy50: 0.5459 - val_loss: 10.7948 - val_accuracy10: 0.6266 - val_accuracy20: 0.6049 - val_accuracy30: 0.5894 - val_accuracy50: 0.5621 - 32s/epoch - 25ms/step
Epoch 13/50
1290/1290 - 32s - loss: 10.1903 - accuracy10: 0.5631 - accuracy20: 0.5655 - accuracy30: 0.5596 - accuracy50: 0.5481 - val_loss: 10.7423 - val_accuracy10: 0.6230 - val_accuracy20: 0.6056 - val_accuracy30: 0.5890 - val_accuracy50: 0.5612 - 32s/epoch - 25ms/step
Epoch 14/50
1290/1290 - 32s - loss: 10.1354 - accuracy10: 0.5660 - accuracy20: 0.5690 - accuracy30: 0.5625 - accuracy50: 0.5506 - val_loss: 10.8001 - val_accuracy10: 0.6107 - val_accuracy20: 0.5958 - val_accuracy30: 0.5795 - val_accuracy50: 0.5546 - 32s/epoch - 25ms/step
Epoch 15/50
1290/1290 - 32s - loss: 10.0749 - accuracy10: 0.5675 - accuracy20: 0.5704 - accuracy30: 0.5646 - accuracy50: 0.5526 - val_loss: 10.8205 - val_accuracy10: 0.6182 - val_accuracy20: 0.6031 - val_accuracy30: 0.5873 - val_accuracy50: 0.5593 - 32s/epoch - 24ms/step
Epoch 16/50
1290/1290 - 32s - loss: 10.0365 - accuracy10: 0.5713 - accuracy20: 0.5738 - accuracy30: 0.5675 - accuracy50: 0.5542 - val_loss: 10.7674 - val_accuracy10: 0.6236 - val_accuracy20: 0.6071 - val_accuracy30: 0.5896 - val_accuracy50: 0.5622 - 32s/epoch - 25ms/step
Epoch 17/50
1290/1290 - 32s - loss: 9.9903 - accuracy10: 0.5742 - accuracy20: 0.5776 - accuracy30: 0.5710 - accuracy50: 0.5576 - val_loss: 10.7867 - val_accuracy10: 0.6125 - val_accuracy20: 0.5981 - val_accuracy30: 0.5818 - val_accuracy50: 0.5552 - 32s/epoch - 25ms/step
Epoch 18/50
1290/1290 - 33s - loss: 9.9479 - accuracy10: 0.5765 - accuracy20: 0.5791 - accuracy30: 0.5720 - accuracy50: 0.5582 - val_loss: 10.7686 - val_accuracy10: 0.6112 - val_accuracy20: 0.5967 - val_accuracy30: 0.5811 - val_accuracy50: 0.5552 - 33s/epoch - 26ms/step
Epoch 19/50
1290/1290 - 33s - loss: 9.8982 - accuracy10: 0.5796 - accuracy20: 0.5825 - accuracy30: 0.5754 - accuracy50: 0.5608 - val_loss: 10.7674 - val_accuracy10: 0.6226 - val_accuracy20: 0.6043 - val_accuracy30: 0.5862 - val_accuracy50: 0.5586 - 33s/epoch - 26ms/step
Epoch 20/50
1290/1290 - 32s - loss: 9.8535 - accuracy10: 0.5827 - accuracy20: 0.5845 - accuracy30: 0.5767 - accuracy50: 0.5622 - val_loss: 10.8077 - val_accuracy10: 0.6197 - val_accuracy20: 0.6050 - val_accuracy30: 0.5873 - val_accuracy50: 0.5593 - 32s/epoch - 25ms/step
Epoch 21/50
1290/1290 - 32s - loss: 9.8155 - accuracy10: 0.5840 - accuracy20: 0.5873 - accuracy30: 0.5791 - accuracy50: 0.5632 - val_loss: 10.7994 - val_accuracy10: 0.6189 - val_accuracy20: 0.6039 - val_accuracy30: 0.5856 - val_accuracy50: 0.5583 - 32s/epoch - 25ms/step
Epoch 22/50
1290/1290 - 33s - loss: 9.7696 - accuracy10: 0.5857 - accuracy20: 0.5885 - accuracy30: 0.5805 - accuracy50: 0.5648 - val_loss: 10.8334 - val_accuracy10: 0.6117 - val_accuracy20: 0.5975 - val_accuracy30: 0.5795 - val_accuracy50: 0.5547 - 33s/epoch - 25ms/step
Epoch 23/50
1290/1290 - 32s - loss: 9.7312 - accuracy10: 0.5876 - accuracy20: 0.5908 - accuracy30: 0.5822 - accuracy50: 0.5658 - val_loss: 10.7948 - val_accuracy10: 0.6115 - val_accuracy20: 0.5983 - val_accuracy30: 0.5815 - val_accuracy50: 0.5551 - 32s/epoch - 25ms/step
testing model: results/EXC/W1/deepOF_L1/seq2seq
Evaluating performance on  test set...
5343/5343 - 71s - 71s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.83500165
{'0': {'precision': 0.27783116657208773, 'recall': 0.6292155875020989, 'f1-score': 0.3854612784089223, 'support': 154842}, '1': {'precision': 0.8881263255902717, 'recall': 0.581719610414822, 'f1-score': 0.7029859218112364, 'support': 1055995}, '2': {'precision': 0.29064879514740316, 'recall': 0.6026684167266657, 'f1-score': 0.3921671873477604, 'support': 156947}, 'accuracy': 0.589500242728384, 'macro avg': {'precision': 0.48553542910325415, 'recall': 0.604534538214529, 'f1-score': 0.49353812918930634, 'support': 1367784}, 'weighted avg': {'precision': 0.7504791320398935, 'recall': 0.589500242728384, 'f1-score': 0.6313750397190784, 'support': 1367784}}
[[ 97429  38712  18701]
 [229556 614293 212146]
 [ 23692  38668  94587]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.86466813
{'0': {'precision': 0.3568282753515914, 'recall': 0.6158594730238394, 'f1-score': 0.4518532776527102, 'support': 219175}, '1': {'precision': 0.8242757056554243, 'recall': 0.5676609166141712, 'f1-score': 0.6723138038457681, 'support': 927064}, '2': {'precision': 0.3694008061414878, 'recall': 0.5853438353381931, 'f1-score': 0.4529514495284666, 'support': 221545}, 'accuracy': 0.5782484661320794, 'macro avg': {'precision': 0.5168349290495011, 'recall': 0.5896214083254012, 'f1-score': 0.5257061770089816, 'support': 1367784}, 'weighted avg': {'precision': 0.6756937291520746, 'recall': 0.5782484661320794, 'f1-score': 0.6014560743975584, 'support': 1367784}}
[[134981  55620  28574]
 [208005 526258 192801]
 [ 35294  56571 129680]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.89749277
{'0': {'precision': 0.401384621563548, 'recall': 0.5959687819131887, 'f1-score': 0.47969496701575864, 'support': 268306}, '1': {'precision': 0.7591930384730795, 'recall': 0.5524617001178643, 'f1-score': 0.6395357930899646, 'support': 828919}, '2': {'precision': 0.41305873454084713, 'recall': 0.5590832313839126, 'f1-score': 0.47510388431543144, 'support': 270559}, 'accuracy': 0.562305890403748, 'macro avg': {'precision': 0.5245454648591582, 'recall': 0.5691712378049886, 'f1-score': 0.5314448814737182, 'support': 1367784}, 'weighted avg': {'precision': 0.6205367182902658, 'recall': 0.562305890403748, 'f1-score': 0.5756552494611498, 'support': 1367784}}
[[159902  71262  37142]
 [193173 457946 177800]
 [ 45301  73993 151265]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.95291656
{'0': {'precision': 0.4536280414357986, 'recall': 0.543721251216364, 'f1-score': 0.4946054668979891, 'support': 346319}, '1': {'precision': 0.6288110331943653, 'recall': 0.5440337997034801, 'f1-score': 0.5833584223395697, 'support': 673142}, '2': {'precision': 0.4687898329984661, 'recall': 0.4983621523700703, 'f1-score': 0.48312388066555434, 'support': 348323}, 'accuracy': 0.5323238172109046, 'macro avg': {'precision': 0.5170763025428766, 'recall': 0.5287057344299715, 'f1-score': 0.5203625899677043, 'support': 1367784}, 'weighted avg': {'precision': 0.5437038356846187, 'recall': 0.5323238172109046, 'f1-score': 0.5353604701518773, 'support': 1367784}}
[[188301 105760  52258]
 [162483 366212 144447]
 [ 64316 110416 173591]]
Evaluating performance on  train set...
1290/1290 - 19s - 19s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7921801
{'0': {'precision': 0.2657593688362919, 'recall': 0.6344686862345, 'f1-score': 0.37460729345257404, 'support': 31855}, '1': {'precision': 0.9197911079745942, 'recall': 0.6135346840400693, 'f1-score': 0.7360780725831045, 'support': 265540}, '2': {'precision': 0.27149944157294614, 'recall': 0.6377280214751998, 'f1-score': 0.3808569554762078, 'support': 32782}, 'accuracy': 0.6179564294302753, 'macro avg': {'precision': 0.485683306127944, 'recall': 0.6285771305832565, 'f1-score': 0.4971807738372955, 'support': 330177}, 'weighted avg': {'precision': 0.7923246931176252, 'recall': 0.6179564294302753, 'f1-score': 0.6659353602494128, 'support': 330177}}
[[ 20211   7360   4284]
 [ 50810 162918  51812]
 [  5029   6847  20906]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.81696534
{'0': {'precision': 0.3404183372783923, 'recall': 0.628789399718932, 'f1-score': 0.4417039480385167, 'support': 44829}, '1': {'precision': 0.8736970773178949, 'recall': 0.6006304426894986, 'f1-score': 0.7118758284093302, 'support': 239197}, '2': {'precision': 0.34865858805088323, 'recall': 0.6265519707048601, 'f1-score': 0.44801140325054617, 'support': 46151}, 'accuracy': 0.6080768799764975, 'macro avg': {'precision': 0.5209246675490568, 'recall': 0.6186572710377636, 'f1-score': 0.533863726566131, 'support': 330177}, 'weighted avg': {'precision': 0.7279043541560977, 'recall': 0.6080768799764975, 'f1-score': 0.6383118239188713, 'support': 330177}}
[[ 28188  10510   6131]
 [ 47640 143669  47888]
 [  6976  10259  28916]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8442911
{'0': {'precision': 0.3843000216976715, 'recall': 0.6159083421794356, 'f1-score': 0.4732885622868394, 'support': 54638}, '1': {'precision': 0.8262951369551719, 'recall': 0.5884956962579327, 'f1-score': 0.6874106341679025, 'support': 219344}, '2': {'precision': 0.3950643006794689, 'recall': 0.6073494083103479, 'f1-score': 0.47872862693392054, 'support': 56195}, 'accuracy': 0.5962408041747306, 'macro avg': {'precision': 0.5352198197774375, 'recall': 0.6039178155825721, 'f1-score': 0.5464759411295542, 'support': 330177}, 'weighted avg': {'precision': 0.6797593517491992, 'recall': 0.5962408041747306, 'f1-score': 0.6164605463060855, 'support': 330177}}
[[ 33652  13462   7524]
 [ 45524 129083  44737]
 [  8391  13674  34130]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8883342
{'0': {'precision': 0.43811185741252906, 'recall': 0.5667414390368561, 'f1-score': 0.49419381994651873, 'support': 70436}, '1': {'precision': 0.7232843153395808, 'recall': 0.5857287611327396, 'f1-score': 0.6472791350752449, 'support': 187510}, '2': {'precision': 0.45564830527909006, 'recall': 0.5501515969597541, 'f1-score': 0.4984602647968239, 'support': 72231}, 'accuracy': 0.573895213779276, 'macro avg': {'precision': 0.5390148260104, 'recall': 0.5675405990431166, 'f1-score': 0.5466444066061958, 'support': 330177}, 'weighted avg': {'precision': 0.6038997916167621, 'recall': 0.573895213779276, 'f1-score': 0.5820654676317598, 'support': 330177}}
[[ 39919  20661   9856]
 [ 40062 109830  37618]
 [ 11135  21358  39738]]
Evaluating performance on  val set...
363/363 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.79103875
{'0': {'precision': 0.25891081906794045, 'recall': 0.5938160382604827, 'f1-score': 0.36059705524787244, 'support': 8991}, '1': {'precision': 0.9116250337824794, 'recall': 0.6306876610975333, 'f1-score': 0.7455695103371515, 'support': 74877}, '2': {'precision': 0.25645169188580386, 'recall': 0.5834447415329769, 'f1-score': 0.35629486001972993, 'support': 8976}, 'accuracy': 0.6225496531816811, 'macro avg': {'precision': 0.47566251491207456, 'recall': 0.6026494802969976, 'f1-score': 0.4874871418682513, 'support': 92844}, 'weighted avg': {'precision': 0.7850752360425827, 'recall': 0.6225496531816811, 'f1-score': 0.6706544204556634, 'support': 92844}}
[[ 5339  2353  1299]
 [13768 47224 13885]
 [ 1514  2225  5237]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8277203
{'0': {'precision': 0.32964384539855396, 'recall': 0.5825380550516602, 'f1-score': 0.42103463018383924, 'support': 12679}, '1': {'precision': 0.8637919943557926, 'recall': 0.6161759699216958, 'f1-score': 0.7192694474202578, 'support': 67557}, '2': {'precision': 0.3239987414033353, 'recall': 0.5717005076142132, 'f1-score': 0.41359919667192657, 'support': 12608}, 'accuracy': 0.6055426306492612, 'macro avg': {'precision': 0.5058115270525606, 'recall': 0.5901381775291897, 'f1-score': 0.5179677580920078, 'support': 92844}, 'weighted avg': {'precision': 0.7175447655219055, 'recall': 0.6055426306492612, 'f1-score': 0.6370324717495034, 'support': 92844}}
[[ 7386  3289  2004]
 [12895 41627 13035]
 [ 2125  3275  7208]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8615294
{'0': {'precision': 0.3698849509039572, 'recall': 0.5677966101694916, 'f1-score': 0.447954678847577, 'support': 15458}, '1': {'precision': 0.8152759304886292, 'recall': 0.6025946817082998, 'f1-score': 0.6929841631684784, 'support': 62050}, '2': {'precision': 0.3663340787889214, 'recall': 0.5554251434533125, 'f1-score': 0.4414843992951176, 'support': 15336}, 'accuracy': 0.5890095213476368, 'macro avg': {'precision': 0.5171649867271693, 'recall': 0.5752721451103678, 'f1-score': 0.527474413770391, 'support': 92844}, 'weighted avg': {'precision': 0.6669645048705324, 'recall': 0.5890095213476368, 'f1-score': 0.6106453351624215, 'support': 92844}}
[[ 8777  4199  2482]
 [12407 37391 12252]
 [ 2545  4273  8518]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.90854543
{'0': {'precision': 0.41790562378797674, 'recall': 0.5221078134463961, 'f1-score': 0.4642312180235167, 'support': 19812}, '1': {'precision': 0.7155570499887918, 'recall': 0.5976819952067106, 'f1-score': 0.651329347670836, 'support': 53408}, '2': {'precision': 0.4190443744144451, 'recall': 0.5014268242967794, 'f1-score': 0.4565489723008398, 'support': 19624}, 'accuracy': 0.5612102020593684, 'macro avg': {'precision': 0.5175023493970712, 'recall': 0.5404055443166287, 'f1-score': 0.5240365126650641, 'support': 92844}, 'weighted avg': {'precision': 0.5893686608482815, 'recall': 0.5612102020593684, 'f1-score': 0.5702346271629573, 'support': 92844}}
[[10344  6275  3193]
 [11038 31921 10449]
 [ 3370  6414  9840]]
training model: results/EXC/W1/deepLOB_L2/seq2seq
Epoch 1/50
1290/1290 - 73s - loss: 10.7777 - accuracy10: 0.5041 - accuracy20: 0.5106 - accuracy30: 0.5092 - accuracy50: 0.5060 - val_loss: 10.4430 - val_accuracy10: 0.5027 - val_accuracy20: 0.5173 - val_accuracy30: 0.5195 - val_accuracy50: 0.5162 - 73s/epoch - 56ms/step
Epoch 2/50
1290/1290 - 65s - loss: 9.7588 - accuracy10: 0.6023 - accuracy20: 0.6025 - accuracy30: 0.5934 - accuracy50: 0.5743 - val_loss: 9.7895 - val_accuracy10: 0.6640 - val_accuracy20: 0.6487 - val_accuracy30: 0.6279 - val_accuracy50: 0.5917 - 65s/epoch - 50ms/step
Epoch 3/50
1290/1290 - 65s - loss: 9.0193 - accuracy10: 0.6616 - accuracy20: 0.6510 - accuracy30: 0.6314 - accuracy50: 0.6023 - val_loss: 9.3422 - val_accuracy10: 0.6846 - val_accuracy20: 0.6676 - val_accuracy30: 0.6413 - val_accuracy50: 0.6006 - 65s/epoch - 51ms/step
Epoch 4/50
1290/1290 - 65s - loss: 8.6867 - accuracy10: 0.6749 - accuracy20: 0.6630 - accuracy30: 0.6407 - accuracy50: 0.6094 - val_loss: 9.0321 - val_accuracy10: 0.6910 - val_accuracy20: 0.6736 - val_accuracy30: 0.6484 - val_accuracy50: 0.6086 - 65s/epoch - 50ms/step
Epoch 5/50
1290/1290 - 65s - loss: 8.4872 - accuracy10: 0.6804 - accuracy20: 0.6683 - accuracy30: 0.6454 - accuracy50: 0.6133 - val_loss: 8.9123 - val_accuracy10: 0.6985 - val_accuracy20: 0.6826 - val_accuracy30: 0.6574 - val_accuracy50: 0.6168 - 65s/epoch - 50ms/step
Epoch 6/50
1290/1290 - 65s - loss: 8.3476 - accuracy10: 0.6835 - accuracy20: 0.6728 - accuracy30: 0.6501 - accuracy50: 0.6173 - val_loss: 8.8398 - val_accuracy10: 0.6843 - val_accuracy20: 0.6676 - val_accuracy30: 0.6422 - val_accuracy50: 0.6045 - 65s/epoch - 50ms/step
Epoch 7/50
1290/1290 - 65s - loss: 8.2613 - accuracy10: 0.6857 - accuracy20: 0.6744 - accuracy30: 0.6522 - accuracy50: 0.6186 - val_loss: 8.8793 - val_accuracy10: 0.6806 - val_accuracy20: 0.6656 - val_accuracy30: 0.6424 - val_accuracy50: 0.6041 - 65s/epoch - 50ms/step
Epoch 8/50
1290/1290 - 65s - loss: 8.1886 - accuracy10: 0.6881 - accuracy20: 0.6768 - accuracy30: 0.6540 - accuracy50: 0.6216 - val_loss: 8.7605 - val_accuracy10: 0.6880 - val_accuracy20: 0.6729 - val_accuracy30: 0.6488 - val_accuracy50: 0.6101 - 65s/epoch - 51ms/step
Epoch 9/50
1290/1290 - 65s - loss: 8.1379 - accuracy10: 0.6894 - accuracy20: 0.6777 - accuracy30: 0.6554 - accuracy50: 0.6228 - val_loss: 8.8058 - val_accuracy10: 0.6681 - val_accuracy20: 0.6558 - val_accuracy30: 0.6341 - val_accuracy50: 0.6006 - 65s/epoch - 50ms/step
Epoch 10/50
1290/1290 - 65s - loss: 8.0876 - accuracy10: 0.6892 - accuracy20: 0.6785 - accuracy30: 0.6567 - accuracy50: 0.6244 - val_loss: 8.7388 - val_accuracy10: 0.6802 - val_accuracy20: 0.6677 - val_accuracy30: 0.6448 - val_accuracy50: 0.6100 - 65s/epoch - 50ms/step
Epoch 11/50
1290/1290 - 65s - loss: 8.0496 - accuracy10: 0.6905 - accuracy20: 0.6801 - accuracy30: 0.6576 - accuracy50: 0.6253 - val_loss: 8.7779 - val_accuracy10: 0.6755 - val_accuracy20: 0.6622 - val_accuracy30: 0.6417 - val_accuracy50: 0.6076 - 65s/epoch - 50ms/step
Epoch 12/50
1290/1290 - 65s - loss: 8.0153 - accuracy10: 0.6906 - accuracy20: 0.6801 - accuracy30: 0.6583 - accuracy50: 0.6256 - val_loss: 8.7372 - val_accuracy10: 0.6717 - val_accuracy20: 0.6590 - val_accuracy30: 0.6368 - val_accuracy50: 0.6012 - 65s/epoch - 50ms/step
Epoch 13/50
1290/1290 - 65s - loss: 7.9778 - accuracy10: 0.6910 - accuracy20: 0.6817 - accuracy30: 0.6597 - accuracy50: 0.6274 - val_loss: 8.7458 - val_accuracy10: 0.6793 - val_accuracy20: 0.6659 - val_accuracy30: 0.6424 - val_accuracy50: 0.6057 - 65s/epoch - 50ms/step
Epoch 14/50
1290/1290 - 65s - loss: 7.9338 - accuracy10: 0.6914 - accuracy20: 0.6824 - accuracy30: 0.6603 - accuracy50: 0.6274 - val_loss: 8.7610 - val_accuracy10: 0.6699 - val_accuracy20: 0.6585 - val_accuracy30: 0.6356 - val_accuracy50: 0.6004 - 65s/epoch - 51ms/step
Epoch 15/50
1290/1290 - 65s - loss: 7.9043 - accuracy10: 0.6915 - accuracy20: 0.6835 - accuracy30: 0.6613 - accuracy50: 0.6292 - val_loss: 8.8123 - val_accuracy10: 0.6881 - val_accuracy20: 0.6756 - val_accuracy30: 0.6509 - val_accuracy50: 0.6112 - 65s/epoch - 51ms/step
Epoch 16/50
1290/1290 - 65s - loss: 7.8714 - accuracy10: 0.6929 - accuracy20: 0.6847 - accuracy30: 0.6631 - accuracy50: 0.6299 - val_loss: 8.8166 - val_accuracy10: 0.6877 - val_accuracy20: 0.6751 - val_accuracy30: 0.6511 - val_accuracy50: 0.6118 - 65s/epoch - 50ms/step
Epoch 17/50
1290/1290 - 65s - loss: 7.8453 - accuracy10: 0.6925 - accuracy20: 0.6846 - accuracy30: 0.6630 - accuracy50: 0.6301 - val_loss: 8.8541 - val_accuracy10: 0.6805 - val_accuracy20: 0.6671 - val_accuracy30: 0.6429 - val_accuracy50: 0.6056 - 65s/epoch - 50ms/step
Epoch 18/50
1290/1290 - 65s - loss: 7.8151 - accuracy10: 0.6934 - accuracy20: 0.6862 - accuracy30: 0.6647 - accuracy50: 0.6325 - val_loss: 8.8993 - val_accuracy10: 0.6841 - val_accuracy20: 0.6708 - val_accuracy30: 0.6468 - val_accuracy50: 0.6080 - 65s/epoch - 50ms/step
Epoch 19/50
1290/1290 - 65s - loss: 7.7864 - accuracy10: 0.6932 - accuracy20: 0.6860 - accuracy30: 0.6646 - accuracy50: 0.6314 - val_loss: 8.9455 - val_accuracy10: 0.6837 - val_accuracy20: 0.6710 - val_accuracy30: 0.6457 - val_accuracy50: 0.6054 - 65s/epoch - 50ms/step
Epoch 20/50
1290/1290 - 65s - loss: 7.7591 - accuracy10: 0.6933 - accuracy20: 0.6870 - accuracy30: 0.6660 - accuracy50: 0.6327 - val_loss: 8.9957 - val_accuracy10: 0.6826 - val_accuracy20: 0.6688 - val_accuracy30: 0.6444 - val_accuracy50: 0.6043 - 65s/epoch - 51ms/step
Epoch 21/50
1290/1290 - 66s - loss: 7.7268 - accuracy10: 0.6948 - accuracy20: 0.6879 - accuracy30: 0.6669 - accuracy50: 0.6341 - val_loss: 9.0207 - val_accuracy10: 0.6824 - val_accuracy20: 0.6700 - val_accuracy30: 0.6460 - val_accuracy50: 0.6062 - 66s/epoch - 51ms/step
Epoch 22/50
1290/1290 - 65s - loss: 7.7051 - accuracy10: 0.6951 - accuracy20: 0.6885 - accuracy30: 0.6671 - accuracy50: 0.6346 - val_loss: 9.1292 - val_accuracy10: 0.6747 - val_accuracy20: 0.6632 - val_accuracy30: 0.6392 - val_accuracy50: 0.6024 - 65s/epoch - 51ms/step
testing model: results/EXC/W1/deepLOB_L2/seq2seq
Evaluating performance on  test set...
5343/5343 - 108s - 108s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.76942194
{'0': {'precision': 0.343092989113875, 'recall': 0.7199163023191233, 'f1-score': 0.46471510280311495, 'support': 154843}, '1': {'precision': 0.9098989697777642, 'recall': 0.674785060942408, 'f1-score': 0.7749005099696651, 'support': 1055997}, '2': {'precision': 0.3418082141152194, 'recall': 0.5656869428922771, 'f1-score': 0.42613217757747235, 'support': 156949}, 'accuracy': 0.6673755966746333, 'macro avg': {'precision': 0.5316000576689529, 'recall': 0.6534627687179361, 'f1-score': 0.5552492634500842, 'support': 1367789}, 'weighted avg': {'precision': 0.7805462593272346, 'recall': 0.6673755966746333, 'f1-score': 0.6997654708645749, 'support': 1367789}}
[[111474  26232  17137]
 [189599 712571 153827]
 [ 23836  44329  88784]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.80848926
{'0': {'precision': 0.41555922088195646, 'recall': 0.7046496667077293, 'f1-score': 0.5228018983528201, 'support': 219177}, '1': {'precision': 0.849604807519338, 'recall': 0.6520981246211165, 'f1-score': 0.737863248176207, 'support': 927066}, '2': {'precision': 0.4297997793285685, 'recall': 0.5520975327922869, 'f1-score': 0.4833324113077221, 'support': 221546}, 'accuracy': 0.6443216022354326, 'macro avg': {'precision': 0.5649879359099543, 'recall': 0.6362817747070443, 'f1-score': 0.5813325192789164, 'support': 1367789}, 'weighted avg': {'precision': 0.7120551311306745, 'recall': 0.6443216022354326, 'f1-score': 0.662174095642369, 'support': 1367789}}
[[154443  43485  21249]
 [181506 604538 141022]
 [ 35702  63529 122315]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8542713
{'0': {'precision': 0.44616902080987025, 'recall': 0.6895359064955201, 'f1-score': 0.5417772747438749, 'support': 268308}, '1': {'precision': 0.791251859034518, 'recall': 0.6123124065048496, 'f1-score': 0.6903756982879279, 'support': 828920}, '2': {'precision': 0.47002900522350705, 'recall': 0.5414416711942963, 'f1-score': 0.5032143709777425, 'support': 270561}, 'accuracy': 0.6134418393480281, 'macro avg': {'precision': 0.5691499616892984, 'recall': 0.6144299947315554, 'f1-score': 0.5784557813365151, 'support': 1367789}, 'weighted avg': {'precision': 0.6600189987700037, 'recall': 0.6134418393480281, 'f1-score': 0.6242041603514268, 'support': 1367789}}
[[185008  58597  24703]
 [180890 507558 140472]
 [ 48761  75307 146493]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.92073935
{'0': {'precision': 0.4846365018429198, 'recall': 0.6397378147378148, 'f1-score': 0.551489467625004, 'support': 346320}, '1': {'precision': 0.6694006442117538, 'recall': 0.566213369541642, 'f1-score': 0.6134983742716416, 'support': 673142}, '2': {'precision': 0.5151264739667581, 'recall': 0.5046694628897559, 'f1-score': 0.5098443552117731, 'support': 348327}, 'accuracy': 0.5691565000157188, 'macro avg': {'precision': 0.5563878733404772, 'recall': 0.5702068823897376, 'f1-score': 0.5582773990361395, 'support': 1367789}, 'weighted avg': {'precision': 0.5833308069165984, 'recall': 0.5691565000157188, 'f1-score': 0.5714009323073252, 'support': 1367789}}
[[221554  90051  34715]
 [161249 381142 130751]
 [ 74352  98185 175790]]
Evaluating performance on  train set...
1290/1290 - 27s - 27s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.67564946
{'0': {'precision': 0.3304439923074779, 'recall': 0.7454962744050052, 'f1-score': 0.4579153188818616, 'support': 31807}, '1': {'precision': 0.9547741409032202, 'recall': 0.6653085355153806, 'f1-score': 0.7841814429329131, 'support': 265561}, '2': {'precision': 0.33242469674253783, 'recall': 0.7433935810295955, 'f1-score': 0.4594128782527619, 'support': 32809}, 'accuracy': 0.6807924234577212, 'macro avg': {'precision': 0.5392142766510787, 'recall': 0.7180661303166604, 'f1-score': 0.5671698800225121, 'support': 330177}, 'weighted avg': {'precision': 0.8327888664902461, 'recall': 0.6807924234577212, 'f1-score': 0.7204796149852278, 'support': 330177}}
[[ 23712   4140   3955]
 [ 43856 176680  45025]
 [  4190   4229  24390]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6918808
{'0': {'precision': 0.40442129398863524, 'recall': 0.7242418156256276, 'f1-score': 0.519019023021134, 'support': 44811}, '1': {'precision': 0.9135772931777997, 'recall': 0.6545545005665165, 'f1-score': 0.7626733049485078, 'support': 239181}, '2': {'precision': 0.416257223594104, 'recall': 0.7080653891956263, 'f1-score': 0.5242931693748146, 'support': 46185}, 'accuracy': 0.6714974089654943, 'macro avg': {'precision': 0.578085270253513, 'recall': 0.6956205684625901, 'f1-score': 0.6019951657814855, 'support': 330177}, 'weighted avg': {'precision': 0.7749107086083457, 'recall': 0.6714974089654943, 'f1-score': 0.6962605063922227, 'support': 330177}}
[[ 32454   7263   5094]
 [ 41858 156557  40766]
 [  5936   7547  32702]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7299229
{'0': {'precision': 0.4389980688401681, 'recall': 0.7066578894435607, 'f1-score': 0.5415612716074469, 'support': 54687}, '1': {'precision': 0.8697847311190069, 'recall': 0.6284341129102127, 'f1-score': 0.7296696315120712, 'support': 219307}, '2': {'precision': 0.4559586111310249, 'recall': 0.6792268123809694, 'f1-score': 0.5456365235170901, 'support': 56183}, 'accuracy': 0.650033164030202, 'macro avg': {'precision': 0.5882471370300667, 'recall': 0.6714396049115808, 'f1-score': 0.605622475545536, 'support': 330177}, 'weighted avg': {'precision': 0.7280170637789813, 'recall': 0.650033164030202, 'f1-score': 0.6671982480281029, 'support': 330177}}
[[ 38645  10080   5962]
 [ 41916 137820  39571]
 [  7469  10553  38161]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.797758
{'0': {'precision': 0.48405549761385547, 'recall': 0.6520961653089609, 'f1-score': 0.5556489403513015, 'support': 70462}, '1': {'precision': 0.7713148984583104, 'recall': 0.6039828437910101, 'f1-score': 0.6774692512289038, 'support': 187454}, '2': {'precision': 0.5063469994461212, 'recall': 0.6199056199056199, 'f1-score': 0.5574013239759096, 'support': 72261}, 'accuracy': 0.6177353358955954, 'macro avg': {'precision': 0.587239131839429, 'recall': 0.6253282096685303, 'f1-score': 0.5968398385187049, 'support': 330177}, 'weighted avg': {'precision': 0.6520221637953213, 'recall': 0.6177353358955954, 'f1-score': 0.6251944675938043, 'support': 330177}}
[[ 45948  16554   7960]
 [ 38523 113219  35712]
 [ 10452  17014  44795]]
Evaluating performance on  val set...
363/363 - 7s - 7s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.69698524
{'0': {'precision': 0.32404914582211564, 'recall': 0.7293158532554809, 'f1-score': 0.44872229377075856, 'support': 9077}, '1': {'precision': 0.9529981594497724, 'recall': 0.6576333275398746, 'f1-score': 0.7782330791380565, 'support': 74797}, '2': {'precision': 0.3172596153846154, 'recall': 0.7356744704570791, 'f1-score': 0.44333221363789055, 'support': 8970}, 'accuracy': 0.6721812933522898, 'macro avg': {'precision': 0.5314356402188345, 'recall': 0.7075412170841449, 'f1-score': 0.5567625288489019, 'support': 92844}, 'weighted avg': {'precision': 0.8300872019623451, 'recall': 0.6721812933522898, 'f1-score': 0.7136620765712192, 'support': 92844}}
[[ 6620  1292  1165]
 [12572 49189 13036]
 [ 1237  1134  6599]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.71800935
{'0': {'precision': 0.3944282817596756, 'recall': 0.7029617409065912, 'f1-score': 0.5053226034166314, 'support': 12729}, '1': {'precision': 0.910493762448894, 'recall': 0.6430909117834348, 'f1-score': 0.7537796601343494, 'support': 67527}, '2': {'precision': 0.3898410719850421, 'recall': 0.6956625357483317, 'f1-score': 0.49967190665030964, 'support': 12588}, 'accuracy': 0.6584270389039679, 'macro avg': {'precision': 0.5649210387312039, 'recall': 0.6805717294794525, 'f1-score': 0.5862580567337635, 'support': 92844}, 'weighted avg': {'precision': 0.7691494260216395, 'recall': 0.6584270389039679, 'f1-score': 0.6852634579477038, 'support': 92844}}
[[ 8948  2157  1624]
 [12019 43426 12082]
 [ 1719  2112  8757]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.758931
{'0': {'precision': 0.427040960167546, 'recall': 0.6845945247933884, 'f1-score': 0.525981595852866, 'support': 15488}, '1': {'precision': 0.8684808286389242, 'recall': 0.6161109947306509, 'f1-score': 0.7208453917289618, 'support': 62057}, '2': {'precision': 0.42657663290400566, 'recall': 0.6689326099745081, 'f1-score': 0.5209468058030032, 'support': 15299}, 'accuracy': 0.6362392830985308, 'macro avg': {'precision': 0.5740328072368254, 'recall': 0.6565460431661825, 'f1-score': 0.5892579311282771, 'support': 92844}, 'weighted avg': {'precision': 0.7220231903054484, 'recall': 0.6362392830985308, 'f1-score': 0.6553990630851053, 'support': 92844}}
[[10603  2858  2027]
 [12093 38234 11730]
 [ 2133  2932 10234]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.82295537
{'0': {'precision': 0.4683228425639689, 'recall': 0.6338979632990522, 'f1-score': 0.5386740923208739, 'support': 19836}, '1': {'precision': 0.7742674218172864, 'recall': 0.5886438520293545, 'f1-score': 0.6688150086146385, 'support': 53416}, '2': {'precision': 0.4691353161315738, 'recall': 0.6078501429154757, 'f1-score': 0.5295595526602486, 'support': 19592}, 'accuracy': 0.6023652578518806, 'macro avg': {'precision': 0.5705751935042763, 'recall': 0.6101306527479607, 'f1-score': 0.5790162178652537, 'support': 92844}, 'weighted avg': {'precision': 0.6445135886275996, 'recall': 0.6023652578518806, 'f1-score': 0.6116247959066389, 'support': 92844}}
[[12574  4506  2756]
 [11253 31443 10720]
 [ 3022  4661 11909]]
training model: results/EXC/W1/deepOF_L2/seq2seq
Epoch 1/50
1290/1290 - 50s - loss: 10.1082 - accuracy10: 0.5634 - accuracy20: 0.5710 - accuracy30: 0.5666 - accuracy50: 0.5548 - val_loss: 10.5217 - val_accuracy10: 0.7237 - val_accuracy20: 0.7101 - val_accuracy30: 0.6836 - val_accuracy50: 0.6311 - 50s/epoch - 39ms/step
Epoch 2/50
1290/1290 - 44s - loss: 8.8965 - accuracy10: 0.6422 - accuracy20: 0.6390 - accuracy30: 0.6253 - accuracy50: 0.6010 - val_loss: 10.2294 - val_accuracy10: 0.7046 - val_accuracy20: 0.6948 - val_accuracy30: 0.6710 - val_accuracy50: 0.6230 - 44s/epoch - 34ms/step
Epoch 3/50
1290/1290 - 43s - loss: 8.6400 - accuracy10: 0.6576 - accuracy20: 0.6515 - accuracy30: 0.6351 - accuracy50: 0.6079 - val_loss: 10.0127 - val_accuracy10: 0.7043 - val_accuracy20: 0.6932 - val_accuracy30: 0.6698 - val_accuracy50: 0.6239 - 43s/epoch - 34ms/step
Epoch 4/50
1290/1290 - 42s - loss: 8.5167 - accuracy10: 0.6621 - accuracy20: 0.6552 - accuracy30: 0.6389 - accuracy50: 0.6124 - val_loss: 9.8381 - val_accuracy10: 0.7183 - val_accuracy20: 0.7039 - val_accuracy30: 0.6788 - val_accuracy50: 0.6314 - 42s/epoch - 33ms/step
Epoch 5/50
1290/1290 - 43s - loss: 8.4354 - accuracy10: 0.6637 - accuracy20: 0.6579 - accuracy30: 0.6419 - accuracy50: 0.6148 - val_loss: 9.7011 - val_accuracy10: 0.7140 - val_accuracy20: 0.7014 - val_accuracy30: 0.6767 - val_accuracy50: 0.6300 - 43s/epoch - 33ms/step
Epoch 6/50
1290/1290 - 42s - loss: 8.3748 - accuracy10: 0.6663 - accuracy20: 0.6596 - accuracy30: 0.6441 - accuracy50: 0.6169 - val_loss: 9.6127 - val_accuracy10: 0.7186 - val_accuracy20: 0.7048 - val_accuracy30: 0.6805 - val_accuracy50: 0.6328 - 42s/epoch - 33ms/step
Epoch 7/50
1290/1290 - 44s - loss: 8.3225 - accuracy10: 0.6686 - accuracy20: 0.6622 - accuracy30: 0.6463 - accuracy50: 0.6181 - val_loss: 9.6742 - val_accuracy10: 0.7172 - val_accuracy20: 0.7044 - val_accuracy30: 0.6806 - val_accuracy50: 0.6333 - 44s/epoch - 34ms/step
Epoch 8/50
1290/1290 - 62s - loss: 8.2803 - accuracy10: 0.6704 - accuracy20: 0.6644 - accuracy30: 0.6473 - accuracy50: 0.6183 - val_loss: 9.5076 - val_accuracy10: 0.7200 - val_accuracy20: 0.7052 - val_accuracy30: 0.6798 - val_accuracy50: 0.6322 - 62s/epoch - 48ms/step
Epoch 9/50
1290/1290 - 67s - loss: 8.2373 - accuracy10: 0.6720 - accuracy20: 0.6656 - accuracy30: 0.6485 - accuracy50: 0.6200 - val_loss: 9.4921 - val_accuracy10: 0.7169 - val_accuracy20: 0.7046 - val_accuracy30: 0.6793 - val_accuracy50: 0.6329 - 67s/epoch - 52ms/step
Epoch 10/50
1290/1290 - 65s - loss: 8.2028 - accuracy10: 0.6729 - accuracy20: 0.6667 - accuracy30: 0.6497 - accuracy50: 0.6212 - val_loss: 9.5687 - val_accuracy10: 0.7122 - val_accuracy20: 0.7015 - val_accuracy30: 0.6775 - val_accuracy50: 0.6317 - 65s/epoch - 51ms/step
Epoch 11/50
1290/1290 - 66s - loss: 8.1663 - accuracy10: 0.6734 - accuracy20: 0.6684 - accuracy30: 0.6513 - accuracy50: 0.6215 - val_loss: 9.5333 - val_accuracy10: 0.7174 - val_accuracy20: 0.7038 - val_accuracy30: 0.6795 - val_accuracy50: 0.6319 - 66s/epoch - 51ms/step
Epoch 12/50
1290/1290 - 68s - loss: 8.1297 - accuracy10: 0.6750 - accuracy20: 0.6700 - accuracy30: 0.6530 - accuracy50: 0.6232 - val_loss: 9.5300 - val_accuracy10: 0.7071 - val_accuracy20: 0.6953 - val_accuracy30: 0.6720 - val_accuracy50: 0.6268 - 68s/epoch - 52ms/step
Epoch 13/50
1290/1290 - 69s - loss: 8.0930 - accuracy10: 0.6766 - accuracy20: 0.6718 - accuracy30: 0.6549 - accuracy50: 0.6240 - val_loss: 9.4584 - val_accuracy10: 0.7079 - val_accuracy20: 0.6961 - val_accuracy30: 0.6723 - val_accuracy50: 0.6276 - 69s/epoch - 54ms/step
Epoch 14/50
1290/1290 - 54s - loss: 8.0633 - accuracy10: 0.6762 - accuracy20: 0.6726 - accuracy30: 0.6556 - accuracy50: 0.6250 - val_loss: 9.5448 - val_accuracy10: 0.7162 - val_accuracy20: 0.7022 - val_accuracy30: 0.6758 - val_accuracy50: 0.6287 - 54s/epoch - 42ms/step
Epoch 15/50
1290/1290 - 43s - loss: 8.0211 - accuracy10: 0.6773 - accuracy20: 0.6739 - accuracy30: 0.6574 - accuracy50: 0.6264 - val_loss: 9.6431 - val_accuracy10: 0.7208 - val_accuracy20: 0.7066 - val_accuracy30: 0.6808 - val_accuracy50: 0.6321 - 43s/epoch - 33ms/step
Epoch 16/50
1290/1290 - 47s - loss: 7.9994 - accuracy10: 0.6777 - accuracy20: 0.6743 - accuracy30: 0.6578 - accuracy50: 0.6272 - val_loss: 9.5669 - val_accuracy10: 0.7150 - val_accuracy20: 0.7009 - val_accuracy30: 0.6758 - val_accuracy50: 0.6281 - 47s/epoch - 37ms/step
Epoch 17/50
1290/1290 - 65s - loss: 7.9566 - accuracy10: 0.6787 - accuracy20: 0.6759 - accuracy30: 0.6589 - accuracy50: 0.6283 - val_loss: 9.6440 - val_accuracy10: 0.7235 - val_accuracy20: 0.7083 - val_accuracy30: 0.6825 - val_accuracy50: 0.6335 - 65s/epoch - 51ms/step
Epoch 18/50
1290/1290 - 67s - loss: 7.9283 - accuracy10: 0.6799 - accuracy20: 0.6777 - accuracy30: 0.6612 - accuracy50: 0.6301 - val_loss: 9.6376 - val_accuracy10: 0.7197 - val_accuracy20: 0.7043 - val_accuracy30: 0.6786 - val_accuracy50: 0.6296 - 67s/epoch - 52ms/step
Epoch 19/50
1290/1290 - 66s - loss: 7.9008 - accuracy10: 0.6802 - accuracy20: 0.6775 - accuracy30: 0.6605 - accuracy50: 0.6295 - val_loss: 9.6145 - val_accuracy10: 0.7188 - val_accuracy20: 0.7022 - val_accuracy30: 0.6749 - val_accuracy50: 0.6282 - 66s/epoch - 51ms/step
Epoch 20/50
1290/1290 - 67s - loss: 7.8658 - accuracy10: 0.6810 - accuracy20: 0.6786 - accuracy30: 0.6622 - accuracy50: 0.6320 - val_loss: 9.6946 - val_accuracy10: 0.7156 - val_accuracy20: 0.6994 - val_accuracy30: 0.6728 - val_accuracy50: 0.6243 - 67s/epoch - 52ms/step
Epoch 21/50
1290/1290 - 67s - loss: 7.8331 - accuracy10: 0.6808 - accuracy20: 0.6791 - accuracy30: 0.6627 - accuracy50: 0.6325 - val_loss: 9.8820 - val_accuracy10: 0.7183 - val_accuracy20: 0.7017 - val_accuracy30: 0.6740 - val_accuracy50: 0.6258 - 67s/epoch - 52ms/step
Epoch 22/50
1290/1290 - 66s - loss: 7.7940 - accuracy10: 0.6825 - accuracy20: 0.6800 - accuracy30: 0.6637 - accuracy50: 0.6337 - val_loss: 9.9810 - val_accuracy10: 0.7183 - val_accuracy20: 0.7007 - val_accuracy30: 0.6724 - val_accuracy50: 0.6228 - 66s/epoch - 51ms/step
Epoch 23/50
1290/1290 - 58s - loss: 7.7723 - accuracy10: 0.6835 - accuracy20: 0.6809 - accuracy30: 0.6653 - accuracy50: 0.6352 - val_loss: 9.9107 - val_accuracy10: 0.7161 - val_accuracy20: 0.6982 - val_accuracy30: 0.6693 - val_accuracy50: 0.6210 - 58s/epoch - 45ms/step
testing model: results/EXC/W1/deepOF_L2/seq2seq
Evaluating performance on  test set...
5343/5343 - 81s - 81s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.73499125
{'0': {'precision': 0.3301670446998083, 'recall': 0.6806163702354658, 'f1-score': 0.4446394592838549, 'support': 154842}, '1': {'precision': 0.9242559041846508, 'recall': 0.6620845742640827, 'f1-score': 0.771505972578554, 'support': 1055995}, '2': {'precision': 0.3718032539973231, 'recall': 0.6920552798078332, 'f1-score': 0.48372673020397255, 'support': 156947}, 'accuracy': 0.6676214957917332, 'macro avg': {'precision': 0.542075400960594, 'recall': 0.6782520747691273, 'f1-score': 0.5666240540221271, 'support': 1367784}, 'weighted avg': {'precision': 0.7936097690717218, 'recall': 0.6676214957917332, 'f1-score': 0.7014812074076343, 'support': 1367784}}
[[105388  27778  21676]
 [194996 699158 161841]
 [ 18812  29519 108616]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7550354
{'0': {'precision': 0.41244140355714876, 'recall': 0.6551340253222311, 'f1-score': 0.5062019780758269, 'support': 219175}, '1': {'precision': 0.864066476784255, 'recall': 0.6580721503585513, 'f1-score': 0.7471304837687487, 'support': 927064}, '2': {'precision': 0.46361320071813744, 'recall': 0.6562278543862421, 'f1-score': 0.5433554960066077, 'support': 221545}, 'accuracy': 0.657302615032783, 'macro avg': {'precision': 0.5800403603531804, 'recall': 0.6564780100223415, 'f1-score': 0.5988959859503944, 'support': 1367784}, 'weighted avg': {'precision': 0.7268347600288178, 'recall': 0.657302615032783, 'f1-score': 0.6755176889860858, 'support': 1367784}}
[[143589  46562  29024]
 [177808 610075 139181]
 [ 26747  49414 145384]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.80123335
{'0': {'precision': 0.4538917902876123, 'recall': 0.6335937325292763, 'f1-score': 0.5288953048824121, 'support': 268306}, '1': {'precision': 0.8008027930635276, 'recall': 0.6358763642768474, 'f1-score': 0.7088730506798034, 'support': 828919}, '2': {'precision': 0.5021877331741531, 'recall': 0.6218902346623103, 'f1-score': 0.5556654541131324, 'support': 270559}, 'accuracy': 0.6326620285074251, 'macro avg': {'precision': 0.5856274388417644, 'recall': 0.6304534438228113, 'f1-score': 0.5978112698917827, 'support': 1367784}, 'weighted avg': {'precision': 0.673683821428091, 'recall': 0.6326620285074251, 'f1-score': 0.6432626888219393, 'support': 1367784}}
[[169997  64114  34195]
 [169232 527090 132597]
 [ 35303  66998 168258]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8806883
{'0': {'precision': 0.5033902813607299, 'recall': 0.5792260892414219, 'f1-score': 0.5386520875765798, 'support': 346319}, '1': {'precision': 0.6722205387343265, 'recall': 0.609669282261395, 'f1-score': 0.6394187810200156, 'support': 673142}, '2': {'precision': 0.5413490455339798, 'recall': 0.5576117569037933, 'f1-score': 0.549360071276039, 'support': 348323}, 'accuracy': 0.588704064384435, 'macro avg': {'precision': 0.5723199552096788, 'recall': 0.5821690428022034, 'f1-score': 0.5758103132908782, 'support': 1367784}, 'weighted avg': {'precision': 0.5961451664318351, 'recall': 0.588704064384435, 'f1-score': 0.5909703853224578, 'support': 1367784}}
[[200597  99571  46151]
 [144341 410394 118407]
 [ 53554 100540 194229]]
Evaluating performance on  train set...
1290/1290 - 32s - 32s/epoch - 25ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6238887
{'0': {'precision': 0.3596600805813115, 'recall': 0.6417202950871135, 'f1-score': 0.4609660397781085, 'support': 31855}, '1': {'precision': 0.9404660414890594, 'recall': 0.7228703773442796, 'f1-score': 0.817435408247133, 'support': 265540}, '2': {'precision': 0.34912909096161066, 'recall': 0.7373863705692149, 'f1-score': 0.4738874730445011, 'support': 32782}, 'accuracy': 0.7164823715764574, 'macro avg': {'precision': 0.5497517376773272, 'recall': 0.700659014333536, 'f1-score': 0.5840963070232476, 'support': 330177}, 'weighted avg': {'precision': 0.8257191578572282, 'recall': 0.7164823715764574, 'f1-score': 0.7489342099674423, 'support': 330177}}
[[ 20442   6839   4574]
 [ 33098 191951  40491]
 [  3297   5312  24173]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.64290166
{'0': {'precision': 0.447114133263925, 'recall': 0.6131075866068839, 'f1-score': 0.5171164899671686, 'support': 44829}, '1': {'precision': 0.8934790293082515, 'recall': 0.7291395795097765, 'f1-score': 0.8029871224084825, 'support': 239197}, '2': {'precision': 0.4401937309534175, 'recall': 0.7010899005438669, 'f1-score': 0.5408215285612804, 'support': 46151}, 'accuracy': 0.7094649233592891, 'macro avg': {'precision': 0.593595631175198, 'recall': 0.681112355553509, 'f1-score': 0.6203083803123105, 'support': 330177}, 'weighted avg': {'precision': 0.7695162404733384, 'recall': 0.7094649233592891, 'f1-score': 0.7275291138150496, 'support': 330177}}
[[ 27485  11240   6104]
 [ 29745 174408  35044]
 [  4242   9553  32356]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6861241
{'0': {'precision': 0.4909891319301142, 'recall': 0.5878875507888283, 'f1-score': 0.53508691559983, 'support': 54638}, '1': {'precision': 0.8444434931048691, 'recall': 0.7194270187468087, 'f1-score': 0.7769383208399493, 'support': 219344}, '2': {'precision': 0.48343069910765873, 'recall': 0.6700240234896343, 'f1-score': 0.561634844868735, 'support': 56195}, 'accuracy': 0.6892515226681447, 'macro avg': {'precision': 0.606287774714214, 'recall': 0.6591128643417571, 'f1-score': 0.6245533604361714, 'support': 330177}, 'weighted avg': {'precision': 0.7245103864846638, 'recall': 0.6892515226681447, 'f1-score': 0.7002726054457455, 'support': 330177}}
[[ 32121  15436   7081]
 [ 28390 157802  33152]
 [  4910  13633  37652]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7721529
{'0': {'precision': 0.5392098326755886, 'recall': 0.5256828894315407, 'f1-score': 0.5323604471442435, 'support': 70436}, '1': {'precision': 0.7406623673250033, 'recall': 0.7055943683003573, 'f1-score': 0.7227032135073277, 'support': 187510}, '2': {'precision': 0.5298638930450311, 'recall': 0.6079522642632664, 'f1-score': 0.5662284745369326, 'support': 72231}, 'accuracy': 0.645853587621185, 'macro avg': {'precision': 0.603245364348541, 'recall': 0.6130765073317215, 'f1-score': 0.6070973783961678, 'support': 330177}, 'weighted avg': {'precision': 0.651571681643436, 'recall': 0.645853587621185, 'f1-score': 0.6478666562603941, 'support': 330177}}
[[ 37027  24264   9145]
 [ 25386 132306  29818]
 [  6256  22062  43913]]
Evaluating performance on  val set...
363/363 - 9s - 9s/epoch - 24ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6485238
{'0': {'precision': 0.35227941657400746, 'recall': 0.5990434879323768, 'f1-score': 0.4436573311367381, 'support': 8991}, '1': {'precision': 0.935491152824324, 'recall': 0.7194999799671461, 'f1-score': 0.81340117464104, 'support': 74877}, '2': {'precision': 0.3271060803365722, 'recall': 0.7276069518716578, 'f1-score': 0.4513164259553591, 'support': 8976}, 'accuracy': 0.7086187583473353, 'macro avg': {'precision': 0.5382922165783012, 'recall': 0.682050139923727, 'f1-score': 0.5694583105777123, 'support': 92844}, 'weighted avg': {'precision': 0.8201953757005827, 'recall': 0.7086187583473353, 'f1-score': 0.7425894948216671, 'support': 92844}}
[[ 5386  2213  1392]
 [ 8960 53874 12043]
 [  943  1502  6531]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6783622
{'0': {'precision': 0.4328430482416319, 'recall': 0.5640034703052291, 'f1-score': 0.48979452054794526, 'support': 12679}, '1': {'precision': 0.8858368630587722, 'recall': 0.7213020116346196, 'f1-score': 0.7951471044172119, 'support': 67557}, '2': {'precision': 0.4075255700478559, 'recall': 0.6889276649746193, 'f1-score': 0.5121160308944048, 'support': 12608}, 'accuracy': 0.695424583171772, 'macro avg': {'precision': 0.5754018271160867, 'recall': 0.658077715638156, 'f1-score': 0.5990192186198541, 'support': 92844}, 'weighted avg': {'precision': 0.7590213729856586, 'recall': 0.6954245831717719, 'f1-score': 0.715012457204102, 'support': 92844}}
[[ 7151  3567  1961]
 [ 8161 48729 10667]
 [ 1209  2713  8686]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.72542846
{'0': {'precision': 0.4706149823803569, 'recall': 0.535644973476517, 'f1-score': 0.5010286820767276, 'support': 15458}, '1': {'precision': 0.8366561934685328, 'recall': 0.7080902497985495, 'f1-score': 0.7670230873303364, 'support': 62050}, '2': {'precision': 0.44512865625687265, 'recall': 0.6598852373500261, 'f1-score': 0.5316382548396418, 'support': 15336}, 'accuracy': 0.6714165697298694, 'macro avg': {'precision': 0.5841332773685874, 'recall': 0.6345401535416976, 'f1-score': 0.599896674748902, 'support': 92844}, 'weighted avg': {'precision': 0.7110397685872367, 'recall': 0.6714165697298694, 'f1-score': 0.6838555880036424, 'support': 92844}}
[[ 8280  4757  2421]
 [ 7919 43937 10194]
 [ 1395  3821 10120]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8083249
{'0': {'precision': 0.5147106720225817, 'recall': 0.47859882899252976, 'f1-score': 0.49599832609719097, 'support': 19812}, '1': {'precision': 0.7368085063937598, 'recall': 0.6915443379269023, 'f1-score': 0.7134592166900082, 'support': 53408}, '2': {'precision': 0.4854908417369829, 'recall': 0.6010497350183449, 'f1-score': 0.5371251622304698, 'support': 19624}, 'accuracy': 0.6269764335875232, 'macro avg': {'precision': 0.5790033400511082, 'recall': 0.590397633979259, 'f1-score': 0.5821942350058896, 'support': 92844}, 'weighted avg': {'precision': 0.6362951706285367, 'recall': 0.6269764335875232, 'f1-score': 0.6297842926331076, 'support': 92844}}
[[ 9482  7156  3174]
 [ 7148 36934  9326]
 [ 1792  6037 11795]]
training model: results/EXC/W1/deepVOL_L2/seq2seq
Epoch 1/50
1290/1290 - 73s - loss: 9.9594 - accuracy10: 0.6067 - accuracy20: 0.6058 - accuracy30: 0.5909 - accuracy50: 0.5656 - val_loss: 10.0949 - val_accuracy10: 0.7556 - val_accuracy20: 0.7336 - val_accuracy30: 0.7006 - val_accuracy50: 0.6377 - 73s/epoch - 57ms/step
Epoch 2/50
1290/1290 - 64s - loss: 9.2156 - accuracy10: 0.6553 - accuracy20: 0.6517 - accuracy30: 0.6322 - accuracy50: 0.5983 - val_loss: 9.7714 - val_accuracy10: 0.7618 - val_accuracy20: 0.7384 - val_accuracy30: 0.7039 - val_accuracy50: 0.6405 - 64s/epoch - 49ms/step
Epoch 3/50
1290/1290 - 64s - loss: 8.9262 - accuracy10: 0.6659 - accuracy20: 0.6599 - accuracy30: 0.6390 - accuracy50: 0.6051 - val_loss: 9.7711 - val_accuracy10: 0.7639 - val_accuracy20: 0.7386 - val_accuracy30: 0.7044 - val_accuracy50: 0.6416 - 64s/epoch - 50ms/step
Epoch 4/50
1290/1290 - 63s - loss: 8.7174 - accuracy10: 0.6764 - accuracy20: 0.6666 - accuracy30: 0.6429 - accuracy50: 0.6082 - val_loss: 9.6822 - val_accuracy10: 0.7637 - val_accuracy20: 0.7377 - val_accuracy30: 0.7034 - val_accuracy50: 0.6422 - 63s/epoch - 49ms/step
Epoch 5/50
1290/1290 - 42s - loss: 8.6232 - accuracy10: 0.6788 - accuracy20: 0.6675 - accuracy30: 0.6431 - accuracy50: 0.6090 - val_loss: 9.6533 - val_accuracy10: 0.7654 - val_accuracy20: 0.7407 - val_accuracy30: 0.7077 - val_accuracy50: 0.6456 - 42s/epoch - 33ms/step
Epoch 6/50
1290/1290 - 42s - loss: 8.5421 - accuracy10: 0.6815 - accuracy20: 0.6686 - accuracy30: 0.6438 - accuracy50: 0.6103 - val_loss: 9.5921 - val_accuracy10: 0.7615 - val_accuracy20: 0.7349 - val_accuracy30: 0.7004 - val_accuracy50: 0.6394 - 42s/epoch - 33ms/step
Epoch 7/50
1290/1290 - 51s - loss: 8.4882 - accuracy10: 0.6833 - accuracy20: 0.6692 - accuracy30: 0.6435 - accuracy50: 0.6110 - val_loss: 9.5808 - val_accuracy10: 0.7584 - val_accuracy20: 0.7338 - val_accuracy30: 0.7020 - val_accuracy50: 0.6418 - 51s/epoch - 39ms/step
Epoch 8/50
1290/1290 - 66s - loss: 8.4423 - accuracy10: 0.6847 - accuracy20: 0.6694 - accuracy30: 0.6449 - accuracy50: 0.6120 - val_loss: 9.5240 - val_accuracy10: 0.7632 - val_accuracy20: 0.7347 - val_accuracy30: 0.7006 - val_accuracy50: 0.6402 - 66s/epoch - 51ms/step
Epoch 9/50
1290/1290 - 65s - loss: 8.4035 - accuracy10: 0.6853 - accuracy20: 0.6692 - accuracy30: 0.6445 - accuracy50: 0.6116 - val_loss: 9.4495 - val_accuracy10: 0.7571 - val_accuracy20: 0.7285 - val_accuracy30: 0.6971 - val_accuracy50: 0.6387 - 65s/epoch - 51ms/step
Epoch 10/50
1290/1290 - 66s - loss: 8.3725 - accuracy10: 0.6853 - accuracy20: 0.6703 - accuracy30: 0.6464 - accuracy50: 0.6137 - val_loss: 9.4377 - val_accuracy10: 0.7555 - val_accuracy20: 0.7284 - val_accuracy30: 0.6958 - val_accuracy50: 0.6382 - 66s/epoch - 51ms/step
Epoch 11/50
1290/1290 - 66s - loss: 8.3429 - accuracy10: 0.6861 - accuracy20: 0.6706 - accuracy30: 0.6476 - accuracy50: 0.6150 - val_loss: 9.4163 - val_accuracy10: 0.7570 - val_accuracy20: 0.7286 - val_accuracy30: 0.6967 - val_accuracy50: 0.6372 - 66s/epoch - 51ms/step
Epoch 12/50
1290/1290 - 66s - loss: 8.3186 - accuracy10: 0.6866 - accuracy20: 0.6705 - accuracy30: 0.6479 - accuracy50: 0.6152 - val_loss: 9.4600 - val_accuracy10: 0.7481 - val_accuracy20: 0.7220 - val_accuracy30: 0.6913 - val_accuracy50: 0.6346 - 66s/epoch - 51ms/step
Epoch 13/50
1290/1290 - 66s - loss: 8.2949 - accuracy10: 0.6870 - accuracy20: 0.6716 - accuracy30: 0.6488 - accuracy50: 0.6164 - val_loss: 9.4906 - val_accuracy10: 0.7530 - val_accuracy20: 0.7252 - val_accuracy30: 0.6940 - val_accuracy50: 0.6363 - 66s/epoch - 51ms/step
Epoch 14/50
1290/1290 - 47s - loss: 8.2708 - accuracy10: 0.6873 - accuracy20: 0.6718 - accuracy30: 0.6491 - accuracy50: 0.6164 - val_loss: 9.5185 - val_accuracy10: 0.7552 - val_accuracy20: 0.7280 - val_accuracy30: 0.6961 - val_accuracy50: 0.6380 - 47s/epoch - 36ms/step
Epoch 15/50
1290/1290 - 42s - loss: 8.2482 - accuracy10: 0.6871 - accuracy20: 0.6726 - accuracy30: 0.6501 - accuracy50: 0.6170 - val_loss: 9.4947 - val_accuracy10: 0.7466 - val_accuracy20: 0.7193 - val_accuracy30: 0.6884 - val_accuracy50: 0.6325 - 42s/epoch - 33ms/step
Epoch 16/50
1290/1290 - 42s - loss: 8.2300 - accuracy10: 0.6876 - accuracy20: 0.6728 - accuracy30: 0.6504 - accuracy50: 0.6183 - val_loss: 9.4741 - val_accuracy10: 0.7521 - val_accuracy20: 0.7241 - val_accuracy30: 0.6924 - val_accuracy50: 0.6345 - 42s/epoch - 33ms/step
Epoch 17/50
1290/1290 - 41s - loss: 8.2028 - accuracy10: 0.6882 - accuracy20: 0.6730 - accuracy30: 0.6510 - accuracy50: 0.6188 - val_loss: 9.4607 - val_accuracy10: 0.7445 - val_accuracy20: 0.7182 - val_accuracy30: 0.6889 - val_accuracy50: 0.6325 - 41s/epoch - 32ms/step
Epoch 18/50
1290/1290 - 42s - loss: 8.1868 - accuracy10: 0.6889 - accuracy20: 0.6744 - accuracy30: 0.6520 - accuracy50: 0.6193 - val_loss: 9.4895 - val_accuracy10: 0.7418 - val_accuracy20: 0.7161 - val_accuracy30: 0.6852 - val_accuracy50: 0.6296 - 42s/epoch - 32ms/step
Epoch 19/50
1290/1290 - 41s - loss: 8.1666 - accuracy10: 0.6890 - accuracy20: 0.6751 - accuracy30: 0.6526 - accuracy50: 0.6194 - val_loss: 9.5224 - val_accuracy10: 0.7452 - val_accuracy20: 0.7178 - val_accuracy30: 0.6860 - val_accuracy50: 0.6297 - 41s/epoch - 32ms/step
Epoch 20/50
1290/1290 - 42s - loss: 8.1481 - accuracy10: 0.6899 - accuracy20: 0.6754 - accuracy30: 0.6522 - accuracy50: 0.6198 - val_loss: 9.5231 - val_accuracy10: 0.7482 - val_accuracy20: 0.7202 - val_accuracy30: 0.6890 - val_accuracy50: 0.6340 - 42s/epoch - 32ms/step
Epoch 21/50
1290/1290 - 41s - loss: 8.1293 - accuracy10: 0.6903 - accuracy20: 0.6765 - accuracy30: 0.6539 - accuracy50: 0.6210 - val_loss: 9.5318 - val_accuracy10: 0.7511 - val_accuracy20: 0.7227 - val_accuracy30: 0.6912 - val_accuracy50: 0.6341 - 41s/epoch - 32ms/step
testing model: results/EXC/W1/deepVOL_L2/seq2seq
Evaluating performance on  test set...
5343/5343 - 79s - 79s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5613634
{'0': {'precision': 0.45993829196825337, 'recall': 0.6122847012780688, 'f1-score': 0.5252884548791468, 'support': 154843}, '1': {'precision': 0.9142112491587777, 'recall': 0.7885761039093862, 'f1-score': 0.846758867116043, 'support': 1055997}, '2': {'precision': 0.42222266528431296, 'recall': 0.6746459040834921, 'f1-score': 0.5193891040372405, 'support': 156949}, 'accuracy': 0.7555456287482938, 'macro avg': {'precision': 0.5987907354704479, 'recall': 0.6918355697569823, 'f1-score': 0.6304788086774767, 'support': 1367789}, 'weighted avg': {'precision': 0.8063304987208331, 'recall': 0.7555456287482938, 'f1-score': 0.772801699755103, 'support': 1367789}}
[[ 94808  42315  17720]
 [ 96088 832734 127175]
 [ 15236  35828 105885]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.61941093
{'0': {'precision': 0.5512553361146477, 'recall': 0.5709084438604416, 'f1-score': 0.5609097918272937, 'support': 219177}, '1': {'precision': 0.8433412035704002, 'recall': 0.7898369695361496, 'f1-score': 0.8157126656254386, 'support': 927066}, '2': {'precision': 0.5083765061567137, 'recall': 0.625409621478158, 'f1-score': 0.560852793193198, 'support': 221546}, 'accuracy': 0.7281225393682798, 'macro avg': {'precision': 0.6343243486139206, 'recall': 0.6620516782915832, 'f1-score': 0.6458250835486434, 'support': 1367789}, 'weighted avg': {'precision': 0.7422813229714468, 'recall': 0.7281225393682798, 'f1-score': 0.7336019637786413, 'support': 1367789}}
[[125130  72693  21354]
 [ 82198 732231 112637]
 [ 19663  63326 138557]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6938086
{'0': {'precision': 0.590047637705966, 'recall': 0.5331931958793625, 'f1-score': 0.5601815323349577, 'support': 268308}, '1': {'precision': 0.7711802004255791, 'recall': 0.779550499445061, 'f1-score': 0.775342759969931, 'support': 828920}, '2': {'precision': 0.5474832734319821, 'recall': 0.5815915819353121, 'f1-score': 0.5640222374358845, 'support': 270561}, 'accuracy': 0.6920665395028034, 'macro avg': {'precision': 0.6362370371878424, 'recall': 0.6314450924199119, 'f1-score': 0.6331821765802578, 'support': 1367789}, 'weighted avg': {'precision': 0.6913996349271809, 'recall': 0.6920665395028034, 'f1-score': 0.6913352335447158, 'support': 1367789}}
[[143060 101052  24196]
 [ 76870 646185 105865]
 [ 22525  90680 157356]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.83636487
{'0': {'precision': 0.6241595384150077, 'recall': 0.4647926772926773, 'f1-score': 0.532814532599377, 'support': 346320}, '1': {'precision': 0.6329171508393701, 'recall': 0.760600289389163, 'f1-score': 0.690909139980109, 'support': 673142}, '2': {'precision': 0.5851572494226711, 'recall': 0.5055766564176765, 'f1-score': 0.5424638292760311, 'support': 348327}, 'accuracy': 0.6207572951676026, 'macro avg': {'precision': 0.6140779795590162, 'recall': 0.5769898743665056, 'f1-score': 0.5887291672851723, 'support': 1367789}, 'weighted avg': {'precision': 0.6185370092271918, 'recall': 0.6207572951676026, 'f1-score': 0.6130763498569874, 'support': 1367789}}
[[160967 153961  31392]
 [ 67693 511992  93457]
 [ 29234 142987 176106]]
Evaluating performance on  train set...
1290/1290 - 20s - 20s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5424147
{'0': {'precision': 0.41210692825445355, 'recall': 0.6102115886440092, 'f1-score': 0.4919649193957213, 'support': 31807}, '1': {'precision': 0.9286201899996916, 'recall': 0.7939644752053201, 'f1-score': 0.8560292642921232, 'support': 265561}, '2': {'precision': 0.38945508415585345, 'recall': 0.6650614160748575, 'f1-score': 0.4912422891620515, 'support': 32809}, 'accuracy': 0.7634541473209824, 'macro avg': {'precision': 0.5767274008033328, 'recall': 0.6897458266413956, 'f1-score': 0.6130788242832986, 'support': 330177}, 'weighted avg': {'precision': 0.825287113274295, 'recall': 0.7634541473209824, 'f1-score': 0.7847096675753247, 'support': 330177}}
[[ 19409   8647   3751]
 [ 24259 210846  30456]
 [  3429   7560  21820]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.5908185
{'0': {'precision': 0.4944391362507166, 'recall': 0.5774028698310683, 'f1-score': 0.5327101841652856, 'support': 44811}, '1': {'precision': 0.8748840664639465, 'recall': 0.7927218299112387, 'f1-score': 0.8317788988813337, 'support': 239181}, '2': {'precision': 0.4734655149849496, 'recall': 0.6266536754357476, 'f1-score': 0.5393941088218575, 'support': 46185}, 'accuracy': 0.7402696129651671, 'macro avg': {'precision': 0.6142629058998709, 'recall': 0.6655927917260182, 'f1-score': 0.6346277306228255, 'support': 330177}, 'weighted avg': {'precision': 0.7671005637734425, 'recall': 0.7402696129651671, 'f1-score': 0.7502912128703827, 'support': 330177}}
[[ 25874  14313   4624]
 [ 22015 189604  27562]
 [  4441  12802  28942]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6502604
{'0': {'precision': 0.5343546889507892, 'recall': 0.5472232888986414, 'f1-score': 0.5407124337118646, 'support': 54687}, '1': {'precision': 0.8203447716627076, 'recall': 0.7842066144719503, 'f1-score': 0.8018687362018683, 'support': 219307}, '2': {'precision': 0.5151796922218607, 'recall': 0.5916914369115213, 'f1-score': 0.5507911523486041, 'support': 56183}, 'accuracy': 0.7121967914179365, 'macro avg': {'precision': 0.6232930509451191, 'recall': 0.6410404467607043, 'f1-score': 0.6311241074207791, 'support': 330177}, 'weighted avg': {'precision': 0.7210494563878951, 'recall': 0.7121967914179365, 'f1-score': 0.7158901652902094, 'support': 330177}}
[[ 29926  19610   5151]
 [ 21192 171982  26133]
 [  4886  18054  33243]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7649653
{'0': {'precision': 0.5765147308734205, 'recall': 0.48627629076665435, 'f1-score': 0.5275645713845798, 'support': 70462}, '1': {'precision': 0.7122534787773632, 'recall': 0.7708397793592028, 'f1-score': 0.7403894683175901, 'support': 187454}, '2': {'precision': 0.5599446007867867, 'recall': 0.5259268485074937, 'f1-score': 0.5424028772871292, 'support': 72261}, 'accuracy': 0.6565115074641783, 'macro avg': {'precision': 0.6162376034791901, 'recall': 0.5943476395444502, 'f1-score': 0.6034523056630997, 'support': 330177}, 'weighted avg': {'precision': 0.6499523024771223, 'recall': 0.6565115074641783, 'f1-score': 0.6516407761247786, 'support': 330177}}
[[ 34264  30025   6173]
 [ 19263 144497  23694]
 [  5906  28351  38004]]
Evaluating performance on  val set...
363/363 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5568826
{'0': {'precision': 0.38658804168952277, 'recall': 0.6211303294039882, 'f1-score': 0.4765648112928448, 'support': 9077}, '1': {'precision': 0.9284270691887454, 'recall': 0.7861411553939329, 'f1-score': 0.8513802115383223, 'support': 74797}, '2': {'precision': 0.3865737639019161, 'recall': 0.6432552954292085, 'f1-score': 0.4829260127217944, 'support': 8970}, 'accuracy': 0.7562039550213261, 'macro avg': {'precision': 0.5671962915933948, 'recall': 0.6835089267423765, 'f1-score': 0.6036236785176539, 'support': 92844}, 'weighted avg': {'precision': 0.8231031171721015, 'recall': 0.7562039550213261, 'f1-score': 0.7791382405826067, 'support': 92844}}
[[ 5638  2414  1025]
 [ 7865 58801  8131]
 [ 1081  2119  5770]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.61061066
{'0': {'precision': 0.4602297156194337, 'recall': 0.5886558252808547, 'f1-score': 0.516580489486384, 'support': 12729}, '1': {'precision': 0.8740466913111533, 'recall': 0.7773187021487701, 'f1-score': 0.822849797383623, 'support': 67527}, '2': {'precision': 0.46138469925495185, 'recall': 0.6051000953288846, 'f1-score': 0.5235591298071967, 'support': 12588}, 'accuracy': 0.7281030545861876, 'macro avg': {'precision': 0.5985537020618463, 'recall': 0.6570248742528365, 'f1-score': 0.6209964722257345, 'support': 92844}, 'weighted avg': {'precision': 0.7613623451004842, 'recall': 0.7281030545861876, 'f1-score': 0.7402814790897536, 'support': 92844}}
[[ 7493  3935  1301]
 [ 7446 52490  7591]
 [ 1342  3629  7617]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.674895
{'0': {'precision': 0.49432239657631954, 'recall': 0.5593362603305785, 'f1-score': 0.5248235543573744, 'support': 15488}, '1': {'precision': 0.819112805406342, 'recall': 0.7617351789483862, 'f1-score': 0.7893827181109988, 'support': 62057}, '2': {'precision': 0.49389516724402294, 'recall': 0.5684685273547291, 'f1-score': 0.5285644828005348, 'support': 15299}, 'accuracy': 0.6961246822627203, 'macro avg': {'precision': 0.6024434564088949, 'recall': 0.6298466555445645, 'f1-score': 0.6142569184229694, 'support': 92844}, 'weighted avg': {'precision': 0.7113421525024958, 'recall': 0.6961246822627203, 'f1-score': 0.7022715368797839, 'support': 92844}}
[[ 8663  5351  1474]
 [ 7348 47271  7438]
 [ 1514  5088  8697]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7855371
{'0': {'precision': 0.5265829548490516, 'recall': 0.4968239564428312, 'f1-score': 0.511270784156053, 'support': 19836}, '1': {'precision': 0.7109723621707211, 'recall': 0.7397221806200389, 'f1-score': 0.7250623899001761, 'support': 53416}, '2': {'precision': 0.527354066727753, 'recall': 0.4993875051041241, 'f1-score': 0.5129899069340674, 'support': 19592}, 'accuracy': 0.6371117142734048, 'macro avg': {'precision': 0.5883031279158418, 'recall': 0.5786445473889981, 'f1-score': 0.5831076936634322, 'support': 92844}, 'weighted avg': {'precision': 0.63283055518318, 'recall': 0.6371117142734048, 'f1-score': 0.6346344206419319, 'support': 92844}}
[[ 9855  8164  1817]
 [ 6951 39513  6952]
 [ 1909  7899  9784]]
training model: results/EXC/W1/deepVOL_L3/seq2seq
Epoch 1/50
1290/1290 - 66s - loss: 10.3067 - accuracy10: 0.5618 - accuracy20: 0.5696 - accuracy30: 0.5636 - accuracy50: 0.5461 - val_loss: 9.8304 - val_accuracy10: 0.6770 - val_accuracy20: 0.6696 - val_accuracy30: 0.6458 - val_accuracy50: 0.5978 - 66s/epoch - 51ms/step
Epoch 2/50
1290/1290 - 57s - loss: 9.0880 - accuracy10: 0.6619 - accuracy20: 0.6550 - accuracy30: 0.6338 - accuracy50: 0.6000 - val_loss: 9.5646 - val_accuracy10: 0.7199 - val_accuracy20: 0.7046 - val_accuracy30: 0.6746 - val_accuracy50: 0.6164 - 57s/epoch - 44ms/step
Epoch 3/50
1290/1290 - 57s - loss: 8.7604 - accuracy10: 0.6736 - accuracy20: 0.6661 - accuracy30: 0.6420 - accuracy50: 0.6060 - val_loss: 9.4002 - val_accuracy10: 0.7415 - val_accuracy20: 0.7216 - val_accuracy30: 0.6883 - val_accuracy50: 0.6277 - 57s/epoch - 44ms/step
Epoch 4/50
1290/1290 - 56s - loss: 8.5733 - accuracy10: 0.6776 - accuracy20: 0.6703 - accuracy30: 0.6458 - accuracy50: 0.6095 - val_loss: 9.1393 - val_accuracy10: 0.7291 - val_accuracy20: 0.7133 - val_accuracy30: 0.6819 - val_accuracy50: 0.6252 - 56s/epoch - 44ms/step
Epoch 5/50
1290/1290 - 56s - loss: 8.4681 - accuracy10: 0.6809 - accuracy20: 0.6729 - accuracy30: 0.6480 - accuracy50: 0.6118 - val_loss: 9.0162 - val_accuracy10: 0.7261 - val_accuracy20: 0.7125 - val_accuracy30: 0.6821 - val_accuracy50: 0.6259 - 56s/epoch - 44ms/step
Epoch 6/50
1290/1290 - 56s - loss: 8.3921 - accuracy10: 0.6827 - accuracy20: 0.6745 - accuracy30: 0.6505 - accuracy50: 0.6139 - val_loss: 9.1594 - val_accuracy10: 0.7138 - val_accuracy20: 0.7018 - val_accuracy30: 0.6727 - val_accuracy50: 0.6177 - 56s/epoch - 44ms/step
Epoch 7/50
1290/1290 - 57s - loss: 8.3375 - accuracy10: 0.6832 - accuracy20: 0.6751 - accuracy30: 0.6509 - accuracy50: 0.6143 - val_loss: 9.0118 - val_accuracy10: 0.7195 - val_accuracy20: 0.7053 - val_accuracy30: 0.6772 - val_accuracy50: 0.6227 - 57s/epoch - 44ms/step
Epoch 8/50
1290/1290 - 58s - loss: 8.2907 - accuracy10: 0.6859 - accuracy20: 0.6758 - accuracy30: 0.6521 - accuracy50: 0.6157 - val_loss: 9.1259 - val_accuracy10: 0.7286 - val_accuracy20: 0.7113 - val_accuracy30: 0.6825 - val_accuracy50: 0.6273 - 58s/epoch - 45ms/step
Epoch 9/50
1290/1290 - 56s - loss: 8.2526 - accuracy10: 0.6866 - accuracy20: 0.6768 - accuracy30: 0.6535 - accuracy50: 0.6180 - val_loss: 9.0366 - val_accuracy10: 0.7265 - val_accuracy20: 0.7086 - val_accuracy30: 0.6792 - val_accuracy50: 0.6251 - 56s/epoch - 43ms/step
Epoch 10/50
1290/1290 - 56s - loss: 8.2267 - accuracy10: 0.6866 - accuracy20: 0.6761 - accuracy30: 0.6523 - accuracy50: 0.6172 - val_loss: 9.1320 - val_accuracy10: 0.7244 - val_accuracy20: 0.7073 - val_accuracy30: 0.6794 - val_accuracy50: 0.6252 - 56s/epoch - 44ms/step
Epoch 11/50
1290/1290 - 57s - loss: 8.1945 - accuracy10: 0.6883 - accuracy20: 0.6767 - accuracy30: 0.6538 - accuracy50: 0.6181 - val_loss: 9.0941 - val_accuracy10: 0.7284 - val_accuracy20: 0.7087 - val_accuracy30: 0.6804 - val_accuracy50: 0.6264 - 57s/epoch - 44ms/step
Epoch 12/50
1290/1290 - 56s - loss: 8.1657 - accuracy10: 0.6888 - accuracy20: 0.6770 - accuracy30: 0.6544 - accuracy50: 0.6200 - val_loss: 9.1360 - val_accuracy10: 0.7268 - val_accuracy20: 0.7083 - val_accuracy30: 0.6791 - val_accuracy50: 0.6250 - 56s/epoch - 43ms/step
Epoch 13/50
1290/1290 - 56s - loss: 8.1415 - accuracy10: 0.6893 - accuracy20: 0.6768 - accuracy30: 0.6537 - accuracy50: 0.6189 - val_loss: 9.1029 - val_accuracy10: 0.7390 - val_accuracy20: 0.7178 - val_accuracy30: 0.6880 - val_accuracy50: 0.6315 - 56s/epoch - 43ms/step
Epoch 14/50
1290/1290 - 56s - loss: 8.1243 - accuracy10: 0.6893 - accuracy20: 0.6773 - accuracy30: 0.6547 - accuracy50: 0.6204 - val_loss: 9.1357 - val_accuracy10: 0.7287 - val_accuracy20: 0.7082 - val_accuracy30: 0.6791 - val_accuracy50: 0.6246 - 56s/epoch - 44ms/step
Epoch 15/50
1290/1290 - 56s - loss: 8.1063 - accuracy10: 0.6889 - accuracy20: 0.6771 - accuracy30: 0.6548 - accuracy50: 0.6208 - val_loss: 9.1802 - val_accuracy10: 0.7365 - val_accuracy20: 0.7133 - val_accuracy30: 0.6840 - val_accuracy50: 0.6288 - 56s/epoch - 44ms/step
Epoch 16/50
1290/1290 - 58s - loss: 8.0801 - accuracy10: 0.6904 - accuracy20: 0.6780 - accuracy30: 0.6554 - accuracy50: 0.6214 - val_loss: 9.0888 - val_accuracy10: 0.7257 - val_accuracy20: 0.7058 - val_accuracy30: 0.6781 - val_accuracy50: 0.6268 - 58s/epoch - 45ms/step
Epoch 17/50
1290/1290 - 57s - loss: 8.0514 - accuracy10: 0.6912 - accuracy20: 0.6786 - accuracy30: 0.6564 - accuracy50: 0.6217 - val_loss: 9.1217 - val_accuracy10: 0.7364 - val_accuracy20: 0.7139 - val_accuracy30: 0.6846 - val_accuracy50: 0.6292 - 57s/epoch - 44ms/step
testing model: results/EXC/W1/deepVOL_L3/seq2seq
Evaluating performance on  test set...
5343/5343 - 110s - 110s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.598837
{'0': {'precision': 0.4551700956015383, 'recall': 0.5946668561058621, 'f1-score': 0.5156506813835432, 'support': 154843}, '1': {'precision': 0.9249962042613492, 'recall': 0.7442360158220146, 'f1-score': 0.8248289020871793, 'support': 1055997}, '2': {'precision': 0.38200244416724183, 'recall': 0.7687656499882127, 'f1-score': 0.510390162498969, 'support': 156949}, 'accuracy': 0.7301184612538922, 'macro avg': {'precision': 0.5873895813433764, 'recall': 0.7025561739720297, 'f1-score': 0.6169565819898972, 'support': 1367789}, 'weighted avg': {'precision': 0.8095020660600468, 'recall': 0.7301184612538922, 'f1-score': 0.7537470839353714, 'support': 1367789}}
[[ 92080  38296  24467]
 [ 99356 785911 170730]
 [ 10862  25430 120657]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6361426
{'0': {'precision': 0.5510162574066793, 'recall': 0.5562353714121463, 'f1-score': 0.5536135140657992, 'support': 219177}, '1': {'precision': 0.8557438665273872, 'recall': 0.7519939249201244, 'f1-score': 0.8005213192592444, 'support': 927066}, '2': {'precision': 0.47189988760557694, 'recall': 0.7068870573154108, 'f1-score': 0.5659715257863476, 'support': 221546}, 'accuracy': 0.7133190864965283, 'macro avg': {'precision': 0.6262200038465477, 'recall': 0.6717054512158938, 'f1-score': 0.6400354530371304, 'support': 1367789}, 'weighted avg': {'precision': 0.7447410866114347, 'recall': 0.7133190864965283, 'f1-score': 0.7229654385176753, 'support': 1367789}}
[[121914  67459  29804]
 [ 84463 697148 145455]
 [ 14876  50062 156608]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7026097
{'0': {'precision': 0.5843981804024425, 'recall': 0.5314750212442417, 'f1-score': 0.5566815922922872, 'support': 268308}, '1': {'precision': 0.785320209862183, 'recall': 0.7354859335038363, 'f1-score': 0.759586578696381, 'support': 828920}, '2': {'precision': 0.5110832901628964, 'recall': 0.6563436711129838, 'f1-score': 0.5746762650460099, 'support': 270561}, 'accuracy': 0.6798117253465265, 'macro avg': {'precision': 0.6269338934758406, 'recall': 0.6411015419536873, 'f1-score': 0.6303148120115593, 'support': 1367789}, 'weighted avg': {'precision': 0.6916604398895903, 'recall': 0.6798117253465265, 'f1-score': 0.6832074365453126, 'support': 1367789}}
[[142599  92862  32847]
 [ 82229 609659 137032]
 [ 19182  73798 177581]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.82826453
{'0': {'precision': 0.6108049239299033, 'recall': 0.48097713097713096, 'f1-score': 0.538171878861895, 'support': 346320}, '1': {'precision': 0.6488950010314241, 'recall': 0.7009575988424434, 'f1-score': 0.6739222962067912, 'support': 673142}, '2': {'precision': 0.5488435300192972, 'recall': 0.5797311147284018, 'f1-score': 0.5638646463490061, 'support': 348327}, 'accuracy': 0.6143871605927522, 'macro avg': {'precision': 0.6028478183268748, 'recall': 0.5872219481826587, 'f1-score': 0.5919862738058974, 'support': 1367789}, 'weighted avg': {'precision': 0.6137711740047117, 'recall': 0.6143871605927522, 'f1-score': 0.6115229527869384, 'support': 1367789}}
[[166572 137974  41774]
 [ 77078 471844 124220]
 [ 29059 117332 201936]]
Evaluating performance on  train set...
1290/1290 - 29s - 29s/epoch - 22ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.60186934
{'0': {'precision': 0.39875078618057214, 'recall': 0.5780488571698054, 'f1-score': 0.4719441449766415, 'support': 31807}, '1': {'precision': 0.9401444986741478, 'recall': 0.7369606229830434, 'f1-score': 0.8262445406551003, 'support': 265561}, '2': {'precision': 0.33484848484848484, 'recall': 0.7746350086866408, 'f1-score': 0.4675785813502102, 'support': 32809}, 'accuracy': 0.7253957725704698, 'macro avg': {'precision': 0.5579145899010682, 'recall': 0.6965481629464966, 'f1-score': 0.588589088993984, 'support': 330177}, 'weighted avg': {'precision': 0.8278433186074282, 'recall': 0.7253957725704698, 'f1-score': 0.7564737687837135, 'support': 330177}}
[[ 18386   7653   5768]
 [ 25136 195708  44717]
 [  2587   4807  25415]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6281375
{'0': {'precision': 0.48741170435263015, 'recall': 0.5512708933074468, 'f1-score': 0.5173782371482726, 'support': 44811}, '1': {'precision': 0.8886387287864234, 'recall': 0.7425924300007107, 'f1-score': 0.8090777195463873, 'support': 239181}, '2': {'precision': 0.42075782123255845, 'recall': 0.7253870304211324, 'f1-score': 0.5325893424901438, 'support': 46185}, 'accuracy': 0.7142199486941853, 'macro avg': {'precision': 0.5989360847905373, 'recall': 0.6730834512430967, 'f1-score': 0.6196817663949346, 'support': 330177}, 'weighted avg': {'precision': 0.7687379970356413, 'recall': 0.7142199486941853, 'f1-score': 0.7308137544607377, 'support': 330177}}
[[ 24703  12998   7110]
 [ 22556 177614  39011]
 [  3423   9260  33502]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.68001854
{'0': {'precision': 0.5237797804943339, 'recall': 0.5366906211713935, 'f1-score': 0.5301566084427667, 'support': 54687}, '1': {'precision': 0.8370947284562731, 'recall': 0.7282758872265819, 'f1-score': 0.778902963875105, 'support': 219307}, '2': {'precision': 0.46185688231906313, 'recall': 0.685136073189399, 'f1-score': 0.5517641746758692, 'support': 56183}, 'accuracy': 0.6892030638112285, 'macro avg': {'precision': 0.6075771304232234, 'recall': 0.6500341938624582, 'f1-score': 0.620274582331247, 'support': 330177}, 'weighted avg': {'precision': 0.7213500143522579, 'recall': 0.6892030638112285, 'f1-score': 0.6990532755772862, 'support': 330177}}
[[ 29350  17559   7778]
 [ 22518 159716  37073]
 [  4167  13523  38493]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.77603424
{'0': {'precision': 0.5581543357199682, 'recall': 0.49785700093667506, 'f1-score': 0.5262842054728757, 'support': 70462}, '1': {'precision': 0.7324446081961448, 'recall': 0.6999317165811346, 'f1-score': 0.7158191643457079, 'support': 187454}, '2': {'precision': 0.5075855500374176, 'recall': 0.6195042969236517, 'f1-score': 0.5579882209965411, 'support': 72261}, 'accuracy': 0.6392056381880022, 'macro avg': {'precision': 0.5993948313178435, 'recall': 0.6057643381471538, 'f1-score': 0.6000305302717082, 'support': 330177}, 'weighted avg': {'precision': 0.6460382819504519, 'recall': 0.6392056381880022, 'f1-score': 0.6408289800825653, 'support': 330177}}
[[ 35080  26114   9268]
 [ 22089 131205  34160]
 [  5681  21814  44766]]
Evaluating performance on  val set...
363/363 - 7s - 7s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.60855275
{'0': {'precision': 0.3818744601209329, 'recall': 0.5844441996254269, 'f1-score': 0.4619269450128434, 'support': 9077}, '1': {'precision': 0.9389903623945084, 'recall': 0.7333582897709802, 'f1-score': 0.8235320611947693, 'support': 74797}, '2': {'precision': 0.32875578280983686, 'recall': 0.7526198439241918, 'f1-score': 0.45761735299101847, 'support': 8970}, 'accuracy': 0.7206604627116453, 'macro avg': {'precision': 0.5498735351084261, 'recall': 0.690140777773533, 'f1-score': 0.5810254530662103, 'support': 92844}, 'weighted avg': {'precision': 0.8255662830376114, 'recall': 0.7206604627116453, 'f1-score': 0.7528269583106735, 'support': 92844}}
[[ 5305  2111  1661]
 [ 7821 54853 12123]
 [  766  1453  6751]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.64177316
{'0': {'precision': 0.4639812585410295, 'recall': 0.5601382669494854, 'f1-score': 0.5075455580865604, 'support': 12729}, '1': {'precision': 0.8876149250527672, 'recall': 0.7348616109111911, 'f1-score': 0.8040475399609505, 'support': 67527}, '2': {'precision': 0.4083259932316536, 'recall': 0.6997140133460439, 'f1-score': 0.5157059632893235, 'support': 12588}, 'accuracy': 0.706141484640903, 'macro avg': {'precision': 0.5866407256084835, 'recall': 0.6649046304022401, 'f1-score': 0.6090996871122781, 'support': 92844}, 'weighted avg': {'precision': 0.7645512697299451, 'recall': 0.706141484640903, 'f1-score': 0.7243028338472376, 'support': 92844}}
[[ 7130  3517  2082]
 [ 7223 49623 10681]
 [ 1014  2766  8808]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.69921124
{'0': {'precision': 0.49305231200373656, 'recall': 0.545260847107438, 'f1-score': 0.5178440029433408, 'support': 15488}, '1': {'precision': 0.8358009342977697, 'recall': 0.7150039479833057, 'f1-score': 0.7706978157974727, 'support': 62057}, '2': {'precision': 0.444626126922397, 'recall': 0.6576246813517224, 'f1-score': 0.5305455216600311, 'support': 15299}, 'accuracy': 0.6772327775623627, 'macro avg': {'precision': 0.5911597910746345, 'recall': 0.6392964921474887, 'f1-score': 0.6063624468002815, 'support': 92844}, 'weighted avg': {'precision': 0.7141659978438705, 'recall': 0.6772327775623627, 'f1-score': 0.6889446621042505, 'support': 92844}}
[[ 8445  4763  2280]
 [ 7399 44371 10287]
 [ 1284  3954 10061]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7951564
{'0': {'precision': 0.5215117784105617, 'recall': 0.5078140754184312, 'f1-score': 0.5145717861612731, 'support': 19836}, '1': {'precision': 0.7325221820239707, 'recall': 0.6785045679197245, 'f1-score': 0.7044794106498984, 'support': 53416}, '2': {'precision': 0.47954432063861635, 'recall': 0.5887096774193549, 'f1-score': 0.5285491705618184, 'support': 19592}, 'accuracy': 0.623088190943949, 'macro avg': {'precision': 0.577859427024383, 'recall': 0.5916761069191702, 'f1-score': 0.5825334557909966, 'support': 92844}, 'weighted avg': {'precision': 0.6340565339870761, 'recall': 0.623088190943949, 'f1-score': 0.6267809820690311, 'support': 92844}}
[[10073  7005  2758]
 [ 7413 36243  9760]
 [ 1829  6229 11534]]
training model: results/EXC/W2/deepLOB_L1/seq2seq
Epoch 1/50
1403/1403 - 46s - loss: 10.3074 - accuracy10: 0.5145 - accuracy20: 0.5319 - accuracy30: 0.5349 - accuracy50: 0.5335 - val_loss: 11.6436 - val_accuracy10: 0.6865 - val_accuracy20: 0.6673 - val_accuracy30: 0.6455 - val_accuracy50: 0.5963 - 46s/epoch - 33ms/step
Epoch 2/50
1403/1403 - 37s - loss: 9.2958 - accuracy10: 0.6165 - accuracy20: 0.6191 - accuracy30: 0.6077 - accuracy50: 0.5858 - val_loss: 10.9172 - val_accuracy10: 0.7195 - val_accuracy20: 0.6966 - val_accuracy30: 0.6711 - val_accuracy50: 0.6179 - 37s/epoch - 27ms/step
Epoch 3/50
1403/1403 - 38s - loss: 8.8622 - accuracy10: 0.6519 - accuracy20: 0.6444 - accuracy30: 0.6238 - accuracy50: 0.5951 - val_loss: 11.0584 - val_accuracy10: 0.7313 - val_accuracy20: 0.7024 - val_accuracy30: 0.6731 - val_accuracy50: 0.6163 - 38s/epoch - 27ms/step
Epoch 4/50
1403/1403 - 38s - loss: 8.6483 - accuracy10: 0.6657 - accuracy20: 0.6550 - accuracy30: 0.6332 - accuracy50: 0.6020 - val_loss: 11.1435 - val_accuracy10: 0.7289 - val_accuracy20: 0.7035 - val_accuracy30: 0.6761 - val_accuracy50: 0.6190 - 38s/epoch - 27ms/step
Epoch 5/50
1403/1403 - 37s - loss: 8.5277 - accuracy10: 0.6698 - accuracy20: 0.6600 - accuracy30: 0.6386 - accuracy50: 0.6055 - val_loss: 11.1412 - val_accuracy10: 0.7460 - val_accuracy20: 0.7183 - val_accuracy30: 0.6867 - val_accuracy50: 0.6227 - 37s/epoch - 27ms/step
Epoch 6/50
1403/1403 - 38s - loss: 8.4476 - accuracy10: 0.6727 - accuracy20: 0.6633 - accuracy30: 0.6422 - accuracy50: 0.6089 - val_loss: 11.1328 - val_accuracy10: 0.7455 - val_accuracy20: 0.7196 - val_accuracy30: 0.6894 - val_accuracy50: 0.6244 - 38s/epoch - 27ms/step
Epoch 7/50
1403/1403 - 39s - loss: 8.3869 - accuracy10: 0.6744 - accuracy20: 0.6650 - accuracy30: 0.6441 - accuracy50: 0.6097 - val_loss: 11.2541 - val_accuracy10: 0.7433 - val_accuracy20: 0.7178 - val_accuracy30: 0.6889 - val_accuracy50: 0.6253 - 39s/epoch - 28ms/step
Epoch 8/50
1403/1403 - 39s - loss: 8.3500 - accuracy10: 0.6758 - accuracy20: 0.6661 - accuracy30: 0.6453 - accuracy50: 0.6107 - val_loss: 11.3509 - val_accuracy10: 0.7402 - val_accuracy20: 0.7161 - val_accuracy30: 0.6866 - val_accuracy50: 0.6228 - 39s/epoch - 28ms/step
Epoch 9/50
1403/1403 - 38s - loss: 8.3144 - accuracy10: 0.6790 - accuracy20: 0.6678 - accuracy30: 0.6466 - accuracy50: 0.6119 - val_loss: 11.2748 - val_accuracy10: 0.7428 - val_accuracy20: 0.7171 - val_accuracy30: 0.6875 - val_accuracy50: 0.6256 - 38s/epoch - 27ms/step
Epoch 10/50
1403/1403 - 39s - loss: 8.2819 - accuracy10: 0.6798 - accuracy20: 0.6695 - accuracy30: 0.6478 - accuracy50: 0.6130 - val_loss: 10.8555 - val_accuracy10: 0.7387 - val_accuracy20: 0.7176 - val_accuracy30: 0.6906 - val_accuracy50: 0.6310 - 39s/epoch - 28ms/step
Epoch 11/50
1403/1403 - 38s - loss: 8.2551 - accuracy10: 0.6809 - accuracy20: 0.6702 - accuracy30: 0.6490 - accuracy50: 0.6142 - val_loss: 10.7897 - val_accuracy10: 0.7349 - val_accuracy20: 0.7163 - val_accuracy30: 0.6893 - val_accuracy50: 0.6312 - 38s/epoch - 27ms/step
Epoch 12/50
1403/1403 - 39s - loss: 8.2221 - accuracy10: 0.6818 - accuracy20: 0.6710 - accuracy30: 0.6504 - accuracy50: 0.6150 - val_loss: 10.7664 - val_accuracy10: 0.7390 - val_accuracy20: 0.7197 - val_accuracy30: 0.6920 - val_accuracy50: 0.6320 - 39s/epoch - 28ms/step
Epoch 13/50
1403/1403 - 38s - loss: 8.1976 - accuracy10: 0.6822 - accuracy20: 0.6720 - accuracy30: 0.6510 - accuracy50: 0.6162 - val_loss: 10.6912 - val_accuracy10: 0.7397 - val_accuracy20: 0.7196 - val_accuracy30: 0.6936 - val_accuracy50: 0.6347 - 38s/epoch - 27ms/step
Epoch 14/50
1403/1403 - 38s - loss: 8.1784 - accuracy10: 0.6829 - accuracy20: 0.6720 - accuracy30: 0.6518 - accuracy50: 0.6166 - val_loss: 10.8191 - val_accuracy10: 0.7409 - val_accuracy20: 0.7209 - val_accuracy30: 0.6942 - val_accuracy50: 0.6347 - 38s/epoch - 27ms/step
Epoch 15/50
1403/1403 - 40s - loss: 8.1583 - accuracy10: 0.6842 - accuracy20: 0.6731 - accuracy30: 0.6524 - accuracy50: 0.6163 - val_loss: 10.5636 - val_accuracy10: 0.7355 - val_accuracy20: 0.7183 - val_accuracy30: 0.6936 - val_accuracy50: 0.6369 - 40s/epoch - 29ms/step
Epoch 16/50
1403/1403 - 39s - loss: 8.1387 - accuracy10: 0.6844 - accuracy20: 0.6738 - accuracy30: 0.6531 - accuracy50: 0.6177 - val_loss: 10.7896 - val_accuracy10: 0.7400 - val_accuracy20: 0.7199 - val_accuracy30: 0.6942 - val_accuracy50: 0.6358 - 39s/epoch - 28ms/step
Epoch 17/50
1403/1403 - 38s - loss: 8.1245 - accuracy10: 0.6851 - accuracy20: 0.6741 - accuracy30: 0.6529 - accuracy50: 0.6180 - val_loss: 10.8206 - val_accuracy10: 0.7329 - val_accuracy20: 0.7164 - val_accuracy30: 0.6906 - val_accuracy50: 0.6349 - 38s/epoch - 27ms/step
Epoch 18/50
1403/1403 - 38s - loss: 8.1063 - accuracy10: 0.6860 - accuracy20: 0.6752 - accuracy30: 0.6547 - accuracy50: 0.6193 - val_loss: 10.7921 - val_accuracy10: 0.7403 - val_accuracy20: 0.7217 - val_accuracy30: 0.6957 - val_accuracy50: 0.6363 - 38s/epoch - 27ms/step
Epoch 19/50
1403/1403 - 38s - loss: 8.0884 - accuracy10: 0.6873 - accuracy20: 0.6762 - accuracy30: 0.6554 - accuracy50: 0.6190 - val_loss: 10.9200 - val_accuracy10: 0.7392 - val_accuracy20: 0.7211 - val_accuracy30: 0.6925 - val_accuracy50: 0.6336 - 38s/epoch - 27ms/step
Epoch 20/50
1403/1403 - 38s - loss: 8.0736 - accuracy10: 0.6876 - accuracy20: 0.6763 - accuracy30: 0.6555 - accuracy50: 0.6192 - val_loss: 10.9574 - val_accuracy10: 0.7422 - val_accuracy20: 0.7233 - val_accuracy30: 0.6960 - val_accuracy50: 0.6358 - 38s/epoch - 27ms/step
Epoch 21/50
1403/1403 - 38s - loss: 8.0689 - accuracy10: 0.6880 - accuracy20: 0.6772 - accuracy30: 0.6560 - accuracy50: 0.6192 - val_loss: 10.8499 - val_accuracy10: 0.7337 - val_accuracy20: 0.7174 - val_accuracy30: 0.6923 - val_accuracy50: 0.6356 - 38s/epoch - 27ms/step
Epoch 22/50
1403/1403 - 38s - loss: 8.0427 - accuracy10: 0.6888 - accuracy20: 0.6781 - accuracy30: 0.6565 - accuracy50: 0.6201 - val_loss: 11.1105 - val_accuracy10: 0.7360 - val_accuracy20: 0.7199 - val_accuracy30: 0.6930 - val_accuracy50: 0.6349 - 38s/epoch - 27ms/step
Epoch 23/50
1403/1403 - 40s - loss: 8.0291 - accuracy10: 0.6888 - accuracy20: 0.6782 - accuracy30: 0.6573 - accuracy50: 0.6212 - val_loss: 10.9212 - val_accuracy10: 0.7219 - val_accuracy20: 0.7094 - val_accuracy30: 0.6869 - val_accuracy50: 0.6323 - 40s/epoch - 28ms/step
Epoch 24/50
1403/1403 - 39s - loss: 8.0111 - accuracy10: 0.6892 - accuracy20: 0.6780 - accuracy30: 0.6564 - accuracy50: 0.6205 - val_loss: 11.1926 - val_accuracy10: 0.7266 - val_accuracy20: 0.7135 - val_accuracy30: 0.6889 - val_accuracy50: 0.6323 - 39s/epoch - 28ms/step
Epoch 25/50
1403/1403 - 38s - loss: 7.9942 - accuracy10: 0.6891 - accuracy20: 0.6783 - accuracy30: 0.6573 - accuracy50: 0.6203 - val_loss: 11.0008 - val_accuracy10: 0.7279 - val_accuracy20: 0.7117 - val_accuracy30: 0.6872 - val_accuracy50: 0.6319 - 38s/epoch - 27ms/step
testing model: results/EXC/W2/deepLOB_L1/seq2seq
Evaluating performance on  test set...
4918/4918 - 65s - 65s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7001617
{'0': {'precision': 0.32487285531484084, 'recall': 0.7520808275198461, 'f1-score': 0.4537440184443395, 'support': 145495}, '1': {'precision': 0.9311550542569089, 'recall': 0.6255990570183375, 'f1-score': 0.7483901531550029, 'support': 967145}, '2': {'precision': 0.3547838480158978, 'recall': 0.6606474736489306, 'f1-score': 0.4616502325314622, 'support': 146199}, 'accuracy': 0.6442881099171538, 'macro avg': {'precision': 0.5369372525292159, 'recall': 0.6794424527290381, 'f1-score': 0.5545948013769348, 'support': 1258839}, 'weighted avg': {'precision': 0.7941431547873932, 'recall': 0.6442881099171538, 'f1-score': 0.6810339391951803, 'support': 1258839}}
[[109424  19871  16200]
 [202647 605045 159453]
 [ 24750  24863  96586]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.72489524
{'0': {'precision': 0.4085157779289473, 'recall': 0.7260896600734336, 'f1-score': 0.522858559277311, 'support': 202632}, '1': {'precision': 0.8809042383095959, 'recall': 0.6316277757200557, 'f1-score': 0.7357247046738573, 'support': 850455}, '2': {'precision': 0.4535894409271381, 'recall': 0.6368686574128076, 'f1-score': 0.5298266823817678, 'support': 205752}, 'accuracy': 0.6476896568981418, 'macro avg': {'precision': 0.5810031523885605, 'recall': 0.6648620310687656, 'f1-score': 0.5961366487776454, 'support': 1258839}, 'weighted avg': {'precision': 0.7350222846245836, 'recall': 0.6476896568981418, 'f1-score': 0.6678070260377212, 'support': 1258839}}
[[147129  32819  22684]
 [178116 537171 135168]
 [ 34910  39805 131037]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7700674
{'0': {'precision': 0.4565096211123438, 'recall': 0.6866115131862848, 'f1-score': 0.5484016563622727, 'support': 243321}, '1': {'precision': 0.8227204727544418, 'recall': 0.6333397240514023, 'f1-score': 0.715714306769444, 'support': 766737}, '2': {'precision': 0.4998876515877474, 'recall': 0.608089042169619, 'f1-score': 0.5487050494096055, 'support': 248781}, 'accuracy': 0.6386464035512087, 'macro avg': {'precision': 0.5930392484848444, 'recall': 0.6426800931357687, 'f1-score': 0.6042736708471074, 'support': 1258839}, 'weighted avg': {'precision': 0.6881349834940373, 'recall': 0.6386464035512087, 'f1-score': 0.6503688484026781, 'support': 1258839}}
[[167067  49272  26982]
 [156765 485605 124367]
 [ 42134  55366 151281]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.87356466
{'0': {'precision': 0.5077660543088212, 'recall': 0.6149320723998923, 'f1-score': 0.5562343512334932, 'support': 308343}, '1': {'precision': 0.7000661590379037, 'recall': 0.6299097591208028, 'f1-score': 0.663137579541601, 'support': 633305}, '2': {'precision': 0.5507763483110464, 'recall': 0.5479789779659574, 'f1-score': 0.5493741021633419, 'support': 317191}, 'accuracy': 0.605596903178246, 'macro avg': {'precision': 0.5862028538859237, 'recall': 0.5976069364955509, 'f1-score': 0.5895820109794787, 'support': 1258839}, 'weighted avg': {'precision': 0.6153470046847719, 'recall': 0.605596903178246, 'f1-score': 0.6082873458903603, 'support': 1258839}}
[[189610  82656  36077]
 [128691 398925 105689]
 [ 55119  88258 173814]]
Evaluating performance on  train set...
1403/1403 - 20s - 20s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.56100243
{'0': {'precision': 0.3751303679578431, 'recall': 0.5690258118234804, 'f1-score': 0.45216854316685595, 'support': 36030}, '1': {'precision': 0.92158244708745, 'recall': 0.7662414672345293, 'f1-score': 0.8367634567111193, 'support': 286689}, '2': {'precision': 0.376853339801704, 'recall': 0.685529908165798, 'f1-score': 0.48634847343552823, 'support': 36261}, 'accuracy': 0.7382946125132319, 'macro avg': {'precision': 0.557855384948999, 'recall': 0.673599062407936, 'f1-score': 0.5917601577711679, 'support': 358980}, 'weighted avg': {'precision': 0.8117125641682673, 'recall': 0.7382946125132319, 'f1-score': 0.7627667091386752, 'support': 358980}}
[[ 20502  11002   4526]
 [ 30438 219673  36578]
 [  3713   7690  24858]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6154534
{'0': {'precision': 0.46298409289214043, 'recall': 0.5409029425025975, 'f1-score': 0.498919598217111, 'support': 51011}, '1': {'precision': 0.8672674774695949, 'recall': 0.7726576476503397, 'f1-score': 0.8172334684808172, 'support': 256569}, '2': {'precision': 0.47214846618835093, 'recall': 0.6503891050583658, 'f1-score': 0.5471179339465156, 'support': 51400}, 'accuracy': 0.7222185079948744, 'macro avg': {'precision': 0.600800012183362, 'recall': 0.6546498984037677, 'f1-score': 0.6210903335481479, 'support': 358980}, 'weighted avg': {'precision': 0.753244365010582, 'recall': 0.7222185079948744, 'f1-score': 0.7333250409609414, 'support': 358980}}
[[ 27592  17322   6097]
 [ 27052 198240  31277]
 [  4952  13018  33430]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.676749
{'0': {'precision': 0.5099158015204774, 'recall': 0.5009798252377281, 'f1-score': 0.505408317871351, 'support': 62256}, '1': {'precision': 0.8104060037052155, 'recall': 0.7715036084895589, 'f1-score': 0.7904764613355094, 'support': 234170}, '2': {'precision': 0.511617658841439, 'recall': 0.6124788183009879, 'f1-score': 0.557523282887078, 'support': 62554}, 'accuracy': 0.69687726335729, 'macro avg': {'precision': 0.6106464880223773, 'recall': 0.6283207506760916, 'f1-score': 0.6178026873646462, 'support': 358980}, 'weighted avg': {'precision': 0.7062282663610132, 'recall': 0.69687726335729, 'f1-score': 0.7004453858879418, 'support': 358980}}
[[ 31189  23845   7222]
 [ 24156 180663  29351]
 [  5820  18421  38313]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.80116165
{'0': {'precision': 0.555701898803644, 'recall': 0.43990020604225105, 'f1-score': 0.49106641818446345, 'support': 80566}, '1': {'precision': 0.6978760334775163, 'recall': 0.7633956299771248, 'f1-score': 0.7291669681228206, 'support': 198031}, '2': {'precision': 0.5545685925171799, 'recall': 0.5421295547566027, 'f1-score': 0.5482785302240144, 'support': 80383}, 'accuracy': 0.6412474232547775, 'macro avg': {'precision': 0.6027155082661134, 'recall': 0.5818084635919929, 'f1-score': 0.5895039721770995, 'support': 358980}, 'weighted avg': {'precision': 0.6338783640785249, 'recall': 0.6412474232547775, 'f1-score': 0.6352253440491857, 'support': 358980}}
[[ 35441  35926   9199]
 [ 21052 151176  25803]
 [  7284  29521  43578]]
Evaluating performance on  val set...
480/480 - 6s - 6s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.56999105
{'0': {'precision': 0.4031933111715523, 'recall': 0.5983704589624758, 'f1-score': 0.4817645642753972, 'support': 13378}, '1': {'precision': 0.9232861462168077, 'recall': 0.7594010779764011, 'f1-score': 0.8333628313531598, 'support': 96106}, '2': {'precision': 0.38541316761840777, 'recall': 0.693644676188317, 'f1-score': 0.4955059515776404, 'support': 13233}, 'accuracy': 0.7347555758370886, 'macro avg': {'precision': 0.570630875002256, 'recall': 0.6838054043757312, 'f1-score': 0.6035444490687324, 'support': 122717}, 'weighted avg': {'precision': 0.8085874893638204, 'recall': 0.7347555758370886, 'f1-score': 0.7586010484947476, 'support': 122717}}
[[ 8005  3530  1843]
 [10329 72983 12794]
 [ 1520  2534  9179]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.62819177
{'0': {'precision': 0.4842552405577616, 'recall': 0.5595987621385125, 'f1-score': 0.5192079207920792, 'support': 18742}, '1': {'precision': 0.8645278882094224, 'recall': 0.7662483611163139, 'f1-score': 0.8124266928141892, 'support': 85424}, '2': {'precision': 0.4791288566243194, 'recall': 0.654627782868848, 'f1-score': 0.5532952137959314, 'support': 18551}, 'accuracy': 0.717814157777651, 'macro avg': {'precision': 0.6093039951305012, 'recall': 0.6601583020412248, 'f1-score': 0.6283099424673999, 'support': 122717}, 'weighted avg': {'precision': 0.7481902381917176, 'recall': 0.717814157777651, 'f1-score': 0.728472112010339, 'support': 122717}}
[[10488  5858  2396]
 [ 9162 65456 10806]
 [ 2008  4399 12144]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6935411
{'0': {'precision': 0.5266232002173322, 'recall': 0.5128080772452713, 'f1-score': 0.5196238300533875, 'support': 22681}, '1': {'precision': 0.8028980022167554, 'recall': 0.7669365146996165, 'f1-score': 0.7845053588055443, 'support': 77451}, '2': {'precision': 0.522308529400728, 'recall': 0.6162940004427717, 'f1-score': 0.5654222691635861, 'support': 22585}, 'accuracy': 0.692243128498904, 'macro avg': {'precision': 0.6172765772782719, 'recall': 0.6320128641292199, 'f1-score': 0.6231838193408392, 'support': 122717}, 'weighted avg': {'precision': 0.7001958335873163, 'recall': 0.692243128498904, 'f1-score': 0.695228652781185, 'support': 122717}}
[[11631  8292  2758]
 [ 8079 59400  9972]
 [ 2376  6290 13919]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8208471
{'0': {'precision': 0.5683217607755797, 'recall': 0.4473856096806353, 'f1-score': 0.5006539970762484, 'support': 29089}, '1': {'precision': 0.6820719344535481, 'recall': 0.7622801980351683, 'f1-score': 0.7199489896880017, 'support': 64433}, '2': {'precision': 0.5713823360184119, 'recall': 0.5442370268881658, 'f1-score': 0.5574794309071452, 'support': 29195}, 'accuracy': 0.63576358613721, 'macro avg': {'precision': 0.6072586770825134, 'recall': 0.5846342782013231, 'f1-score': 0.5926941392237984, 'support': 122717}, 'weighted avg': {'precision': 0.6287748229821772, 'recall': 0.63576358613721, 'f1-score': 0.6293146781525958, 'support': 122717}}
[[13014 12658  3417]
 [ 6815 49116  8502]
 [ 3070 10236 15889]]
training model: results/EXC/W2/deepOF_L1/seq2seq
Epoch 1/50
1403/1403 - 43s - loss: 11.8338 - accuracy10: 0.3916 - accuracy20: 0.4202 - accuracy30: 0.4368 - accuracy50: 0.4515 - val_loss: 13.6853 - val_accuracy10: 0.6774 - val_accuracy20: 0.6387 - val_accuracy30: 0.6007 - val_accuracy50: 0.5309 - 43s/epoch - 31ms/step
Epoch 2/50
1403/1403 - 37s - loss: 11.3903 - accuracy10: 0.4429 - accuracy20: 0.4662 - accuracy30: 0.4803 - accuracy50: 0.4901 - val_loss: 12.8836 - val_accuracy10: 0.7032 - val_accuracy20: 0.6637 - val_accuracy30: 0.6257 - val_accuracy50: 0.5519 - 37s/epoch - 27ms/step
Epoch 3/50
1403/1403 - 36s - loss: 11.1606 - accuracy10: 0.4766 - accuracy20: 0.4908 - accuracy30: 0.5002 - accuracy50: 0.5054 - val_loss: 12.8257 - val_accuracy10: 0.6903 - val_accuracy20: 0.6517 - val_accuracy30: 0.6171 - val_accuracy50: 0.5508 - 36s/epoch - 26ms/step
Epoch 4/50
1403/1403 - 37s - loss: 10.9925 - accuracy10: 0.4968 - accuracy20: 0.5055 - accuracy30: 0.5118 - accuracy50: 0.5140 - val_loss: 12.6922 - val_accuracy10: 0.6966 - val_accuracy20: 0.6562 - val_accuracy30: 0.6220 - val_accuracy50: 0.5547 - 37s/epoch - 26ms/step
Epoch 5/50
1403/1403 - 37s - loss: 10.8503 - accuracy10: 0.5110 - accuracy20: 0.5156 - accuracy30: 0.5193 - accuracy50: 0.5198 - val_loss: 12.3588 - val_accuracy10: 0.6842 - val_accuracy20: 0.6436 - val_accuracy30: 0.6119 - val_accuracy50: 0.5522 - 37s/epoch - 26ms/step
Epoch 6/50
1403/1403 - 37s - loss: 10.7215 - accuracy10: 0.5243 - accuracy20: 0.5261 - accuracy30: 0.5265 - accuracy50: 0.5246 - val_loss: 12.2437 - val_accuracy10: 0.6895 - val_accuracy20: 0.6474 - val_accuracy30: 0.6143 - val_accuracy50: 0.5558 - 37s/epoch - 27ms/step
Epoch 7/50
1403/1403 - 37s - loss: 10.6113 - accuracy10: 0.5339 - accuracy20: 0.5345 - accuracy30: 0.5340 - accuracy50: 0.5302 - val_loss: 12.1069 - val_accuracy10: 0.6972 - val_accuracy20: 0.6550 - val_accuracy30: 0.6227 - val_accuracy50: 0.5645 - 37s/epoch - 26ms/step
Epoch 8/50
1403/1403 - 36s - loss: 10.5233 - accuracy10: 0.5400 - accuracy20: 0.5407 - accuracy30: 0.5385 - accuracy50: 0.5331 - val_loss: 12.1789 - val_accuracy10: 0.6932 - val_accuracy20: 0.6516 - val_accuracy30: 0.6200 - val_accuracy50: 0.5642 - 36s/epoch - 26ms/step
Epoch 9/50
1403/1403 - 36s - loss: 10.4573 - accuracy10: 0.5451 - accuracy20: 0.5460 - accuracy30: 0.5429 - accuracy50: 0.5360 - val_loss: 12.0431 - val_accuracy10: 0.6898 - val_accuracy20: 0.6510 - val_accuracy30: 0.6211 - val_accuracy50: 0.5683 - 36s/epoch - 26ms/step
Epoch 10/50
1403/1403 - 36s - loss: 10.3838 - accuracy10: 0.5503 - accuracy20: 0.5512 - accuracy30: 0.5477 - accuracy50: 0.5408 - val_loss: 12.0645 - val_accuracy10: 0.6859 - val_accuracy20: 0.6486 - val_accuracy30: 0.6185 - val_accuracy50: 0.5664 - 36s/epoch - 26ms/step
Epoch 11/50
1403/1403 - 36s - loss: 10.3200 - accuracy10: 0.5548 - accuracy20: 0.5552 - accuracy30: 0.5513 - accuracy50: 0.5428 - val_loss: 11.9733 - val_accuracy10: 0.6911 - val_accuracy20: 0.6549 - val_accuracy30: 0.6259 - val_accuracy50: 0.5741 - 36s/epoch - 26ms/step
Epoch 12/50
1403/1403 - 37s - loss: 10.2663 - accuracy10: 0.5578 - accuracy20: 0.5592 - accuracy30: 0.5546 - accuracy50: 0.5463 - val_loss: 11.9098 - val_accuracy10: 0.6878 - val_accuracy20: 0.6521 - val_accuracy30: 0.6247 - val_accuracy50: 0.5735 - 37s/epoch - 26ms/step
Epoch 13/50
1403/1403 - 36s - loss: 10.2075 - accuracy10: 0.5631 - accuracy20: 0.5635 - accuracy30: 0.5584 - accuracy50: 0.5486 - val_loss: 11.9199 - val_accuracy10: 0.6657 - val_accuracy20: 0.6347 - val_accuracy30: 0.6081 - val_accuracy50: 0.5638 - 36s/epoch - 26ms/step
Epoch 14/50
1403/1403 - 35s - loss: 10.1568 - accuracy10: 0.5643 - accuracy20: 0.5655 - accuracy30: 0.5601 - accuracy50: 0.5508 - val_loss: 11.8154 - val_accuracy10: 0.6782 - val_accuracy20: 0.6473 - val_accuracy30: 0.6208 - val_accuracy50: 0.5733 - 35s/epoch - 25ms/step
Epoch 15/50
1403/1403 - 37s - loss: 10.1028 - accuracy10: 0.5690 - accuracy20: 0.5690 - accuracy30: 0.5632 - accuracy50: 0.5537 - val_loss: 11.9778 - val_accuracy10: 0.6847 - val_accuracy20: 0.6537 - val_accuracy30: 0.6267 - val_accuracy50: 0.5758 - 37s/epoch - 26ms/step
Epoch 16/50
1403/1403 - 37s - loss: 10.0412 - accuracy10: 0.5711 - accuracy20: 0.5723 - accuracy30: 0.5661 - accuracy50: 0.5551 - val_loss: 12.0290 - val_accuracy10: 0.6766 - val_accuracy20: 0.6463 - val_accuracy30: 0.6186 - val_accuracy50: 0.5710 - 37s/epoch - 26ms/step
Epoch 17/50
1403/1403 - 37s - loss: 9.9943 - accuracy10: 0.5733 - accuracy20: 0.5743 - accuracy30: 0.5687 - accuracy50: 0.5568 - val_loss: 12.0301 - val_accuracy10: 0.6696 - val_accuracy20: 0.6402 - val_accuracy30: 0.6129 - val_accuracy50: 0.5679 - 37s/epoch - 26ms/step
Epoch 18/50
1403/1403 - 37s - loss: 9.9490 - accuracy10: 0.5761 - accuracy20: 0.5773 - accuracy30: 0.5709 - accuracy50: 0.5596 - val_loss: 12.1384 - val_accuracy10: 0.6650 - val_accuracy20: 0.6380 - val_accuracy30: 0.6109 - val_accuracy50: 0.5655 - 37s/epoch - 26ms/step
Epoch 19/50
1403/1403 - 38s - loss: 9.9076 - accuracy10: 0.5781 - accuracy20: 0.5804 - accuracy30: 0.5735 - accuracy50: 0.5610 - val_loss: 12.1166 - val_accuracy10: 0.6690 - val_accuracy20: 0.6416 - val_accuracy30: 0.6152 - val_accuracy50: 0.5690 - 38s/epoch - 27ms/step
Epoch 20/50
1403/1403 - 38s - loss: 9.8732 - accuracy10: 0.5797 - accuracy20: 0.5821 - accuracy30: 0.5746 - accuracy50: 0.5618 - val_loss: 12.1377 - val_accuracy10: 0.6789 - val_accuracy20: 0.6481 - val_accuracy30: 0.6194 - val_accuracy50: 0.5708 - 38s/epoch - 27ms/step
Epoch 21/50
1403/1403 - 37s - loss: 9.8195 - accuracy10: 0.5823 - accuracy20: 0.5843 - accuracy30: 0.5775 - accuracy50: 0.5643 - val_loss: 12.3275 - val_accuracy10: 0.6723 - val_accuracy20: 0.6416 - val_accuracy30: 0.6133 - val_accuracy50: 0.5669 - 37s/epoch - 26ms/step
Epoch 22/50
1403/1403 - 36s - loss: 9.7790 - accuracy10: 0.5842 - accuracy20: 0.5869 - accuracy30: 0.5793 - accuracy50: 0.5663 - val_loss: 12.2584 - val_accuracy10: 0.6662 - val_accuracy20: 0.6371 - val_accuracy30: 0.6100 - val_accuracy50: 0.5645 - 36s/epoch - 26ms/step
Epoch 23/50
1403/1403 - 36s - loss: 9.7478 - accuracy10: 0.5856 - accuracy20: 0.5877 - accuracy30: 0.5805 - accuracy50: 0.5673 - val_loss: 12.3251 - val_accuracy10: 0.6803 - val_accuracy20: 0.6476 - val_accuracy30: 0.6183 - val_accuracy50: 0.5683 - 36s/epoch - 26ms/step
Epoch 24/50
1403/1403 - 35s - loss: 9.7011 - accuracy10: 0.5894 - accuracy20: 0.5914 - accuracy30: 0.5832 - accuracy50: 0.5693 - val_loss: 12.3256 - val_accuracy10: 0.6741 - val_accuracy20: 0.6435 - val_accuracy30: 0.6145 - val_accuracy50: 0.5676 - 35s/epoch - 25ms/step
testing model: results/EXC/W2/deepOF_L1/seq2seq
Evaluating performance on  test set...
4918/4918 - 66s - 66s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7317324
{'0': {'precision': 0.3182789770558548, 'recall': 0.5158082120224889, 'f1-score': 0.39365407412847125, 'support': 145494}, '1': {'precision': 0.8627572118977629, 'recall': 0.7161885224713641, 'f1-score': 0.7826701062496682, 'support': 967142}, '2': {'precision': 0.30672013224101286, 'recall': 0.4619830640638039, 'f1-score': 0.36867156838663545, 'support': 146198}, 'accuracy': 0.663506069902783, 'macro avg': {'precision': 0.4959187737315435, 'recall': 0.5646599328525522, 'f1-score': 0.5149985829215916, 'support': 1258834}, 'weighted avg': {'precision': 0.7352504673454661, 'recall': 0.663506069902783, 'f1-score': 0.6896274518441302, 'support': 1258834}}
[[ 75047  54445  16002]
 [137825 692656 136661]
 [ 22918  55739  67541]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7917253
{'0': {'precision': 0.39629540189116375, 'recall': 0.5183216617562145, 'f1-score': 0.44916829002824754, 'support': 202629}, '1': {'precision': 0.7987556453482063, 'recall': 0.7010365039890412, 'f1-score': 0.7467126233509888, 'support': 850455}, '2': {'precision': 0.3959967825514044, 'recall': 0.47616038882138517, 'f1-score': 0.4323944998466295, 'support': 205750}, 'accuracy': 0.6348708407939411, 'macro avg': {'precision': 0.5303492765969248, 'recall': 0.5651728515222136, 'f1-score': 0.5427584710752886, 'support': 1258834}, 'weighted avg': {'precision': 0.6681444982931545, 'recall': 0.6348708407939411, 'f1-score': 0.6474445191943838, 'support': 1258834}}
[[105027  74521  23081]
 [127905 596200 126350]
 [ 32090  75690  97970]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.84193456
{'0': {'precision': 0.4369542563512882, 'recall': 0.4997575189669486, 'f1-score': 0.46625051763009767, 'support': 243318}, '1': {'precision': 0.7379281226354755, 'recall': 0.690674898954922, 'f1-score': 0.7135200245759835, 'support': 766737}, '2': {'precision': 0.44225861052471427, 'recall': 0.4673706381969539, 'f1-score': 0.4544679919637901, 'support': 248779}, 'accuracy': 0.6096419384922873, 'macro avg': {'precision': 0.539046996503826, 'recall': 0.5526010187062749, 'f1-score': 0.5447461780566237, 'support': 1258834}, 'weighted avg': {'precision': 0.6213212270877393, 'recall': 0.6096419384922873, 'f1-score': 0.6145301438512113, 'support': 1258834}}
[[121600  94330  27388]
 [117926 529566 119245]
 [ 38764  93743 116272]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9219328
{'0': {'precision': 0.48531928529674834, 'recall': 0.44697411947849774, 'f1-score': 0.46535813532595666, 'support': 308340}, '1': {'precision': 0.6201705283611428, 'recall': 0.6934652339709935, 'f1-score': 0.6547731310060629, 'support': 633305}, '2': {'precision': 0.4985152078708981, 'recall': 0.41916964333567686, 'f1-score': 0.45541220737361127, 'support': 317189}, 'accuracy': 0.5639750753475041, 'macro avg': {'precision': 0.5346683405095964, 'recall': 0.519869665595056, 'f1-score': 0.5251811579018769, 'support': 1258834}, 'weighted avg': {'precision': 0.5564863875312512, 'recall': 0.5639750753475041, 'f1-score': 0.5581445749183995, 'support': 1258834}}
[[137820 135220  35300]
 [ 95682 439175  98448]
 [ 50476 133757 132956]]
Evaluating performance on  train set...
1403/1403 - 20s - 20s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7068437
{'0': {'precision': 0.2923972813833152, 'recall': 0.5002081194328052, 'f1-score': 0.3690600495465061, 'support': 36037}, '1': {'precision': 0.8826357672084643, 'recall': 0.7185201981441429, 'f1-score': 0.7921672092750459, 'support': 286660}, '2': {'precision': 0.28907959732382915, 'recall': 0.5096877325469228, 'f1-score': 0.36891925589746144, 'support': 36283}, 'accuracy': 0.6754972421861942, 'macro avg': {'precision': 0.4880375486385362, 'recall': 0.5761386833746237, 'f1-score': 0.5100488382396712, 'support': 358980}, 'weighted avg': {'precision': 0.7633911774664032, 'recall': 0.6754972421861942, 'f1-score': 0.706913941105409, 'support': 358980}}
[[ 18026  14245   3766]
 [ 38976 205971  41713]
 [  4647  13143  18493]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7633304
{'0': {'precision': 0.3707102378966142, 'recall': 0.5050853436281331, 'f1-score': 0.42758906723072454, 'support': 51029}, '1': {'precision': 0.826753490931603, 'recall': 0.7027625429271963, 'f1-score': 0.7597323242113425, 'support': 256539}, '2': {'precision': 0.37193405146451136, 'recall': 0.5164553022640629, 'f1-score': 0.4324394752485729, 'support': 51412}, 'accuracy': 0.6479803888796033, 'macro avg': {'precision': 0.5231325934309096, 'recall': 0.574767729606464, 'f1-score': 0.53992028889688, 'support': 358980}, 'weighted avg': {'precision': 0.6967891247245592, 'recall': 0.6479803888796033, 'f1-score': 0.6656443020058217, 'support': 358980}}
[[ 25774  19793   5462]
 [ 36878 180286  39375]
 [  6874  17986  26552]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.81228864
{'0': {'precision': 0.4141226585112774, 'recall': 0.4871123673095762, 'f1-score': 0.44766184794078795, 'support': 62269}, '1': {'precision': 0.7727448112915442, 'recall': 0.6928333475698301, 'f1-score': 0.7306104709424479, 'support': 234140}, '2': {'precision': 0.41725916447915157, 'recall': 0.5055377091623915, 'f1-score': 0.4571758924700101, 'support': 62571}, 'accuracy': 0.6245027578138058, 'macro avg': {'precision': 0.534708878093991, 'recall': 0.5618278080139326, 'f1-score': 0.5451494037844152, 'support': 358980}, 'weighted avg': {'precision': 0.6485759572100559, 'recall': 0.6245027578138058, 'f1-score': 0.6338696975977232, 'support': 358980}}
[[ 30332  25229   6708]
 [ 34451 162220  37469]
 [  8461  22478  31632]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.88927597
{'0': {'precision': 0.46722234133790735, 'recall': 0.43255381179827557, 'f1-score': 0.4492201843727654, 'support': 80605}, '1': {'precision': 0.6637357551917626, 'recall': 0.6956328436028535, 'f1-score': 0.6793100726239344, 'support': 197932}, '2': {'precision': 0.4727870813397129, 'recall': 0.4520343597329786, 'f1-score': 0.46217787804645544, 'support': 80443}, 'accuracy': 0.5819739261240181, 'macro avg': {'precision': 0.5345817259564609, 'recall': 0.5267403383780359, 'f1-score': 0.530236045014385, 'support': 358980}, 'weighted avg': {'precision': 0.5768215875657934, 'recall': 0.5819739261240181, 'f1-score': 0.5789892732176121, 'support': 358980}}
[[ 34866  36755   8984]
 [ 28679 137688  31565]
 [ 11079  33001  36363]]
Evaluating performance on  val set...
480/480 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7091785
{'0': {'precision': 0.31395618138867015, 'recall': 0.5046158427635498, 'f1-score': 0.38708203649239026, 'support': 13432}, '1': {'precision': 0.8749639475829205, 'recall': 0.7260410813510645, 'f1-score': 0.7935762338851388, 'support': 96102}, '2': {'precision': 0.309185296043401, 'recall': 0.5015172204521317, 'f1-score': 0.3825367434324731, 'support': 13182}, 'accuracy': 0.6776866912220085, 'macro avg': {'precision': 0.4993684750049972, 'recall': 0.5773913815222487, 'f1-score': 0.521065004603334, 'support': 122716}, 'weighted avg': {'precision': 0.7527830542999328, 'recall': 0.6776866912220085, 'f1-score': 0.704929662757279, 'support': 122716}}
[[ 6778  5223  1431]
 [12988 69774 13340]
 [ 1823  4748  6611]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7697465
{'0': {'precision': 0.3871072633418689, 'recall': 0.5077571040145012, 'f1-score': 0.43929889298892993, 'support': 18757}, '1': {'precision': 0.8161200936213715, 'recall': 0.7100292568753657, 'f1-score': 0.7593872033643736, 'support': 85450}, '2': {'precision': 0.3936729628538976, 'recall': 0.5055918742233508, 'f1-score': 0.44266792809839167, 'support': 18509}, 'accuracy': 0.6482773232504319, 'macro avg': {'precision': 0.5323001066057126, 'recall': 0.5744594117044058, 'f1-score': 0.547118008150565, 'support': 122716}, 'weighted avg': {'precision': 0.6868291486677567, 'recall': 0.6482773232504319, 'f1-score': 0.6626919598459224, 'support': 122716}}
[[ 9524  7140  2093]
 [12458 60672 12320]
 [ 2621  6530  9358]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.82233065
{'0': {'precision': 0.4256673826327094, 'recall': 0.48902793689962104, 'f1-score': 0.4551531804946069, 'support': 22694}, '1': {'precision': 0.7574890609222484, 'recall': 0.6974329838334796, 'f1-score': 0.7262215290289618, 'support': 77444}, '2': {'precision': 0.43804262036306235, 'recall': 0.49162901939941533, 'f1-score': 0.46329145623773943, 'support': 22578}, 'accuracy': 0.6210274128882949, 'macro avg': {'precision': 0.5403996879726735, 'recall': 0.5593633133775053, 'f1-score': 0.5482220552537694, 'support': 122716}, 'weighted avg': {'precision': 0.6373513209205526, 'recall': 0.6210274128882949, 'f1-score': 0.6277171751947522, 'support': 122716}}
[[11098  9065  2531]
 [11723 54012 11709]
 [ 3251  8227 11100]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9039951
{'0': {'precision': 0.4760758350887752, 'recall': 0.4350635957373668, 'f1-score': 0.454646693249991, 'support': 29090}, '1': {'precision': 0.6410621080027875, 'recall': 0.6993576615155465, 'f1-score': 0.6689422327755723, 'support': 64452}, '2': {'precision': 0.49366745420039504, 'recall': 0.43689586618221704, 'f1-score': 0.4635499063517175, 'support': 29174}, 'accuracy': 0.5743097884546432, 'macro avg': {'precision': 0.5369351324306525, 'recall': 0.5237723744783768, 'f1-score': 0.5290462774590936, 'support': 122716}, 'weighted avg': {'precision': 0.5669108782601328, 'recall': 0.5743097884546432, 'f1-score': 0.5693140426790184, 'support': 122716}}
[[12656 13169  3265]
 [ 9569 45075  9808]
 [ 4359 12069 12746]]
training model: results/EXC/W2/deepLOB_L2/seq2seq
Epoch 1/50
1403/1403 - 79s - loss: 10.5195 - accuracy10: 0.4994 - accuracy20: 0.5122 - accuracy30: 0.5155 - accuracy50: 0.5177 - val_loss: 11.3934 - val_accuracy10: 0.6385 - val_accuracy20: 0.6281 - val_accuracy30: 0.6072 - val_accuracy50: 0.5675 - 79s/epoch - 56ms/step
Epoch 2/50
1403/1403 - 74s - loss: 9.1136 - accuracy10: 0.6309 - accuracy20: 0.6340 - accuracy30: 0.6186 - accuracy50: 0.5932 - val_loss: 10.3989 - val_accuracy10: 0.7110 - val_accuracy20: 0.6977 - val_accuracy30: 0.6724 - val_accuracy50: 0.6220 - 74s/epoch - 53ms/step
Epoch 3/50
1403/1403 - 74s - loss: 8.6386 - accuracy10: 0.6705 - accuracy20: 0.6653 - accuracy30: 0.6418 - accuracy50: 0.6080 - val_loss: 10.3926 - val_accuracy10: 0.7238 - val_accuracy20: 0.7095 - val_accuracy30: 0.6825 - val_accuracy50: 0.6301 - 74s/epoch - 53ms/step
Epoch 4/50
1403/1403 - 73s - loss: 8.4544 - accuracy10: 0.6777 - accuracy20: 0.6692 - accuracy30: 0.6455 - accuracy50: 0.6118 - val_loss: 9.9811 - val_accuracy10: 0.7308 - val_accuracy20: 0.7156 - val_accuracy30: 0.6888 - val_accuracy50: 0.6358 - 73s/epoch - 52ms/step
Epoch 5/50
1403/1403 - 74s - loss: 8.3401 - accuracy10: 0.6815 - accuracy20: 0.6714 - accuracy30: 0.6473 - accuracy50: 0.6139 - val_loss: 9.9020 - val_accuracy10: 0.7136 - val_accuracy20: 0.7024 - val_accuracy30: 0.6794 - val_accuracy50: 0.6321 - 74s/epoch - 52ms/step
Epoch 6/50
1403/1403 - 73s - loss: 8.2741 - accuracy10: 0.6823 - accuracy20: 0.6722 - accuracy30: 0.6493 - accuracy50: 0.6160 - val_loss: 9.8722 - val_accuracy10: 0.7314 - val_accuracy20: 0.7171 - val_accuracy30: 0.6915 - val_accuracy50: 0.6400 - 73s/epoch - 52ms/step
Epoch 7/50
1403/1403 - 73s - loss: 8.2044 - accuracy10: 0.6844 - accuracy20: 0.6735 - accuracy30: 0.6503 - accuracy50: 0.6177 - val_loss: 9.7927 - val_accuracy10: 0.7226 - val_accuracy20: 0.7104 - val_accuracy30: 0.6871 - val_accuracy50: 0.6387 - 73s/epoch - 52ms/step
Epoch 8/50
1403/1403 - 73s - loss: 8.1469 - accuracy10: 0.6862 - accuracy20: 0.6749 - accuracy30: 0.6520 - accuracy50: 0.6197 - val_loss: 9.6273 - val_accuracy10: 0.7160 - val_accuracy20: 0.7046 - val_accuracy30: 0.6826 - val_accuracy50: 0.6373 - 73s/epoch - 52ms/step
Epoch 9/50
1403/1403 - 72s - loss: 8.1002 - accuracy10: 0.6874 - accuracy20: 0.6762 - accuracy30: 0.6538 - accuracy50: 0.6208 - val_loss: 9.6631 - val_accuracy10: 0.7170 - val_accuracy20: 0.7058 - val_accuracy30: 0.6830 - val_accuracy50: 0.6371 - 72s/epoch - 51ms/step
Epoch 10/50
1403/1403 - 72s - loss: 8.0662 - accuracy10: 0.6886 - accuracy20: 0.6777 - accuracy30: 0.6551 - accuracy50: 0.6217 - val_loss: 9.6247 - val_accuracy10: 0.7329 - val_accuracy20: 0.7160 - val_accuracy30: 0.6900 - val_accuracy50: 0.6397 - 72s/epoch - 52ms/step
Epoch 11/50
1403/1403 - 74s - loss: 8.0355 - accuracy10: 0.6888 - accuracy20: 0.6779 - accuracy30: 0.6557 - accuracy50: 0.6225 - val_loss: 9.6775 - val_accuracy10: 0.7264 - val_accuracy20: 0.7125 - val_accuracy30: 0.6875 - val_accuracy50: 0.6390 - 74s/epoch - 53ms/step
Epoch 12/50
1403/1403 - 73s - loss: 7.9996 - accuracy10: 0.6899 - accuracy20: 0.6789 - accuracy30: 0.6569 - accuracy50: 0.6238 - val_loss: 9.7119 - val_accuracy10: 0.7213 - val_accuracy20: 0.7076 - val_accuracy30: 0.6835 - val_accuracy50: 0.6368 - 73s/epoch - 52ms/step
Epoch 13/50
1403/1403 - 73s - loss: 7.9701 - accuracy10: 0.6905 - accuracy20: 0.6799 - accuracy30: 0.6573 - accuracy50: 0.6243 - val_loss: 9.8687 - val_accuracy10: 0.7220 - val_accuracy20: 0.7068 - val_accuracy30: 0.6817 - val_accuracy50: 0.6352 - 73s/epoch - 52ms/step
Epoch 14/50
1403/1403 - 74s - loss: 7.9461 - accuracy10: 0.6917 - accuracy20: 0.6809 - accuracy30: 0.6583 - accuracy50: 0.6249 - val_loss: 9.9135 - val_accuracy10: 0.7204 - val_accuracy20: 0.7054 - val_accuracy30: 0.6821 - val_accuracy50: 0.6367 - 74s/epoch - 53ms/step
Epoch 15/50
1403/1403 - 74s - loss: 7.9116 - accuracy10: 0.6920 - accuracy20: 0.6815 - accuracy30: 0.6594 - accuracy50: 0.6261 - val_loss: 9.8674 - val_accuracy10: 0.7192 - val_accuracy20: 0.7041 - val_accuracy30: 0.6817 - val_accuracy50: 0.6365 - 74s/epoch - 53ms/step
Epoch 16/50
1403/1403 - 73s - loss: 7.8834 - accuracy10: 0.6934 - accuracy20: 0.6829 - accuracy30: 0.6601 - accuracy50: 0.6264 - val_loss: 9.9629 - val_accuracy10: 0.7107 - val_accuracy20: 0.6977 - val_accuracy30: 0.6750 - val_accuracy50: 0.6323 - 73s/epoch - 52ms/step
Epoch 17/50
1403/1403 - 72s - loss: 7.8636 - accuracy10: 0.6939 - accuracy20: 0.6837 - accuracy30: 0.6610 - accuracy50: 0.6270 - val_loss: 10.0763 - val_accuracy10: 0.7256 - val_accuracy20: 0.7081 - val_accuracy30: 0.6830 - val_accuracy50: 0.6357 - 72s/epoch - 52ms/step
Epoch 18/50
1403/1403 - 73s - loss: 7.8376 - accuracy10: 0.6940 - accuracy20: 0.6844 - accuracy30: 0.6620 - accuracy50: 0.6286 - val_loss: 9.9562 - val_accuracy10: 0.7187 - val_accuracy20: 0.7024 - val_accuracy30: 0.6770 - val_accuracy50: 0.6317 - 73s/epoch - 52ms/step
Epoch 19/50
1403/1403 - 73s - loss: 7.8088 - accuracy10: 0.6956 - accuracy20: 0.6853 - accuracy30: 0.6626 - accuracy50: 0.6287 - val_loss: 10.1497 - val_accuracy10: 0.7198 - val_accuracy20: 0.7031 - val_accuracy30: 0.6778 - val_accuracy50: 0.6311 - 73s/epoch - 52ms/step
Epoch 20/50
1403/1403 - 73s - loss: 7.7896 - accuracy10: 0.6955 - accuracy20: 0.6858 - accuracy30: 0.6638 - accuracy50: 0.6297 - val_loss: 10.1437 - val_accuracy10: 0.7118 - val_accuracy20: 0.6975 - val_accuracy30: 0.6740 - val_accuracy50: 0.6302 - 73s/epoch - 52ms/step
testing model: results/EXC/W2/deepLOB_L2/seq2seq
Evaluating performance on  test set...
4918/4918 - 104s - 104s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6770912
{'0': {'precision': 0.3490492475838885, 'recall': 0.741475652084264, 'f1-score': 0.4746549455964591, 'support': 145495}, '1': {'precision': 0.9379333280315791, 'recall': 0.6707060471801023, 'f1-score': 0.7821237807010141, 'support': 967145}, '2': {'precision': 0.37793262657210475, 'recall': 0.6673917058256212, 'f1-score': 0.48258534220964855, 'support': 146199}, 'accuracy': 0.6785005866516687, 'macro avg': {'precision': 0.5549717340625241, 'recall': 0.6931911350299959, 'f1-score': 0.5797880228357073, 'support': 1258839}, 'weighted avg': {'precision': 0.804833517938779, 'recall': 0.6785005866516687, 'f1-score': 0.7117991416228345, 'support': 1258839}}
[[107881  17470  20144]
 [178018 648670 140457]
 [ 23172  25455  97572]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.70293725
{'0': {'precision': 0.43673204104200614, 'recall': 0.6997019226973035, 'f1-score': 0.5377914750367456, 'support': 202632}, '1': {'precision': 0.8848282373671329, 'recall': 0.6754795962161432, 'f1-score': 0.7661096196957513, 'support': 850455}, '2': {'precision': 0.46675112385377443, 'recall': 0.646428710292002, 'f1-score': 0.5420890996496905, 'support': 205752}, 'accuracy': 0.674630353841913, 'macro avg': {'precision': 0.5961038007543046, 'recall': 0.6738700764018163, 'f1-score': 0.6153300647940625, 'support': 1258839}, 'weighted avg': {'precision': 0.7443664064949137, 'recall': 0.674630353841913, 'f1-score': 0.6927426265146847, 'support': 1258839}}
[[141782  32681  28169]
 [152206 574465 123784]
 [ 30655  42093 133004]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.75158185
{'0': {'precision': 0.4760478778733317, 'recall': 0.6677105551925234, 'f1-score': 0.5558205013291003, 'support': 243321}, '1': {'precision': 0.8282391383235452, 'recall': 0.6638156238710274, 'f1-score': 0.7369676961614756, 'support': 766737}, '2': {'precision': 0.5069316340572416, 'recall': 0.6174748071597107, 'f1-score': 0.5567693344834834, 'support': 248781}, 'accuracy': 0.6554102629486376, 'macro avg': {'precision': 0.6037395500847061, 'recall': 0.6496669954077539, 'f1-score': 0.6165191773246864, 'support': 1258839}, 'weighted avg': {'precision': 0.6966649402705125, 'recall': 0.6554102629486376, 'f1-score': 0.6663416310249324, 'support': 1258839}}
[[162468  48213  32640]
 [140990 508972 116775]
 [ 37827  57338 153616]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.84170127
{'0': {'precision': 0.5179310591412785, 'recall': 0.6107257177883072, 'f1-score': 0.5605137439911896, 'support': 308343}, '1': {'precision': 0.7115787365480472, 'recall': 0.6507764821057784, 'f1-score': 0.6798207994088228, 'support': 633305}, '2': {'precision': 0.557920781115038, 'recall': 0.5559331759097831, 'f1-score': 0.5569252051316065, 'support': 317191}, 'accuracy': 0.617068584624404, 'macro avg': {'precision': 0.5958101922681213, 'recall': 0.6058117919346229, 'f1-score': 0.599086582843873, 'support': 1258839}, 'weighted avg': {'precision': 0.6254288584966149, 'recall': 0.617068584624404, 'f1-score': 0.6196313138328088, 'support': 1258839}}
[[188313  78575  41455]
 [122896 412140  98269]
 [ 52378  88476 176337]]
Evaluating performance on  train set...
1403/1403 - 31s - 31s/epoch - 22ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5485147
{'0': {'precision': 0.3863478216595102, 'recall': 0.6318068276436303, 'f1-score': 0.47948942085917995, 'support': 36030}, '1': {'precision': 0.9327238543086666, 'recall': 0.7804240832400267, 'f1-score': 0.849804203081855, 'support': 286689}, '2': {'precision': 0.4038416802366156, 'recall': 0.6702517856650396, 'f1-score': 0.5040075485001503, 'support': 36261}, 'accuracy': 0.7543790740431222, 'macro avg': {'precision': 0.5743044520682641, 'recall': 0.6941608988495656, 'f1-score': 0.6111003908137284, 'support': 358980}, 'weighted avg': {'precision': 0.8244623217152749, 'recall': 0.7543790740431222, 'f1-score': 0.7777072224832975, 'support': 358980}}
[[ 22764   8645   4621]
 [ 31693 223739  31257]
 [  4464   7493  24304]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.59445405
{'0': {'precision': 0.4757387928875532, 'recall': 0.5958322714708593, 'f1-score': 0.5290559534895866, 'support': 51011}, '1': {'precision': 0.8822111169559881, 'recall': 0.7843893845320362, 'f1-score': 0.8304294093738459, 'support': 256569}, '2': {'precision': 0.494744072149555, 'recall': 0.6446303501945525, 'f1-score': 0.5598283377825837, 'support': 51400}, 'accuracy': 0.7375842665329545, 'macro avg': {'precision': 0.6175646606643654, 'recall': 0.6749506687324827, 'f1-score': 0.639771233548672, 'support': 358980}, 'weighted avg': {'precision': 0.768972591617235, 'recall': 0.7375842665329545, 'f1-score': 0.7488586911224034, 'support': 358980}}
[[ 30394  14274   6343]
 [ 27824 201250  27495]
 [  5670  12596  33134]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6542693
{'0': {'precision': 0.5139004421872948, 'recall': 0.5656322282189669, 'f1-score': 0.5385268277016954, 'support': 62256}, '1': {'precision': 0.8300868426714765, 'recall': 0.7743306145108255, 'f1-score': 0.8012399168380795, 'support': 234170}, '2': {'precision': 0.5303404798933571, 'recall': 0.6105604757489529, 'f1-score': 0.567630229620272, 'support': 62554}, 'accuracy': 0.7095994205805337, 'macro avg': {'precision': 0.6247759215840428, 'recall': 0.6501744394929151, 'f1-score': 0.6357989913866823, 'support': 358980}, 'weighted avg': {'precision': 0.7230200575420384, 'recall': 0.7095994205805337, 'f1-score': 0.7149713602290834, 'support': 358980}}
[[ 35214  19680   7362]
 [ 26384 181325  26461]
 [  6925  17436  38193]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.76331985
{'0': {'precision': 0.5506620918887042, 'recall': 0.509966983591093, 'f1-score': 0.5295338256711648, 'support': 80566}, '1': {'precision': 0.7225381694030996, 'recall': 0.7608960213299938, 'f1-score': 0.7412211769046302, 'support': 198031}, '2': {'precision': 0.5728397341211225, 'recall': 0.5403505716382817, 'f1-score': 0.5561210445114494, 'support': 80383}, 'accuracy': 0.6551952755028135, 'macro avg': {'precision': 0.6153466651376421, 'recall': 0.6037378588531229, 'f1-score': 0.6089586823624148, 'support': 358980}, 'weighted avg': {'precision': 0.6504434081788087, 'recall': 0.6551952755028135, 'f1-score': 0.6522643907838535, 'support': 358980}}
[[ 41086  30222   9258]
 [ 24219 150681  23131]
 [  9307  27641  43435]]
Evaluating performance on  val set...
480/480 - 10s - 10s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5873927
{'0': {'precision': 0.39747849437895405, 'recall': 0.6527881596651218, 'f1-score': 0.4941016719001951, 'support': 13378}, '1': {'precision': 0.9328069880732404, 'recall': 0.7511393669489939, 'f1-score': 0.8321738378627627, 'support': 96106}, '2': {'precision': 0.38784946696921696, 'recall': 0.6845764376936446, 'f1-score': 0.49516261273572015, 'support': 13233}, 'accuracy': 0.7332398934133005, 'macro avg': {'precision': 0.5727116498071371, 'recall': 0.6961679881025868, 'f1-score': 0.6071460408328927, 'support': 122717}, 'weighted avg': {'precision': 0.8156834643119709, 'recall': 0.7332398934133005, 'f1-score': 0.7589777934813535, 'support': 122717}}
[[ 8733  2802  1843]
 [11462 72189 12455]
 [ 1776  2398  9059]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6386246
{'0': {'precision': 0.4780926751324531, 'recall': 0.6066588411055384, 'f1-score': 0.5347568431944314, 'support': 18742}, '1': {'precision': 0.8780338151077175, 'recall': 0.7538279640382094, 'f1-score': 0.8112040512962637, 'support': 85424}, '2': {'precision': 0.4740378980269584, 'recall': 0.6540348229205972, 'f1-score': 0.5496760748425679, 'support': 18551}, 'accuracy': 0.7162658800329212, 'macro avg': {'precision': 0.610054796089043, 'recall': 0.6715072093547816, 'f1-score': 0.6318789897777544, 'support': 122717}, 'weighted avg': {'precision': 0.755881015551164, 'recall': 0.7162658800329212, 'f1-score': 0.7294486379025443, 'support': 122717}}
[[11370  4863  2509]
 [10076 64395 10953]
 [ 2336  4082 12133]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.69970006
{'0': {'precision': 0.5105721148167106, 'recall': 0.5717120056434901, 'f1-score': 0.5394151171013769, 'support': 22681}, '1': {'precision': 0.8216480586331294, 'recall': 0.7439929762043098, 'f1-score': 0.7808946890542207, 'support': 77451}, '2': {'precision': 0.5168266578395675, 'recall': 0.62218286473323, 'f1-score': 0.564632137260417, 'support': 22585}, 'accuracy': 0.6897332887863947, 'macro avg': {'precision': 0.6163489437631359, 'recall': 0.6459626155270101, 'f1-score': 0.6283139811386715, 'support': 122717}, 'weighted avg': {'precision': 0.7080541407682631, 'recall': 0.6897332887863947, 'f1-score': 0.6964623129064538, 'support': 122717}}
[[12967  6811  2903]
 [ 9594 57623 10234]
 [ 2836  5697 14052]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7990173
{'0': {'precision': 0.547188388884837, 'recall': 0.5158307263914195, 'f1-score': 0.5310470527861832, 'support': 29089}, '1': {'precision': 0.7084816221550977, 'recall': 0.735321962348486, 'f1-score': 0.7216523109963674, 'support': 64433}, '2': {'precision': 0.5678195700362408, 'recall': 0.5527658845692756, 'f1-score': 0.5601916134407109, 'support': 29195}, 'accuracy': 0.6398624477456261, 'macro avg': {'precision': 0.6078298603587252, 'recall': 0.6013061911030603, 'f1-score': 0.6042969924077538, 'support': 122717}, 'weighted avg': {'precision': 0.6367842413993048, 'recall': 0.6398624477456261, 'f1-score': 0.6380586652813203, 'support': 122717}}
[[15005 10430  3654]
 [ 8425 47379  8629]
 [ 3992  9065 16138]]
training model: results/EXC/W2/deepOF_L2/seq2seq
Epoch 1/50
1403/1403 - 55s - loss: 10.0045 - accuracy10: 0.5698 - accuracy20: 0.5844 - accuracy30: 0.5826 - accuracy50: 0.5691 - val_loss: 11.5849 - val_accuracy10: 0.7426 - val_accuracy20: 0.7205 - val_accuracy30: 0.6890 - val_accuracy50: 0.6197 - 55s/epoch - 39ms/step
Epoch 2/50
1403/1403 - 50s - loss: 8.9648 - accuracy10: 0.6379 - accuracy20: 0.6422 - accuracy30: 0.6284 - accuracy50: 0.6031 - val_loss: 10.8160 - val_accuracy10: 0.7410 - val_accuracy20: 0.7210 - val_accuracy30: 0.6903 - val_accuracy50: 0.6274 - 50s/epoch - 35ms/step
Epoch 3/50
1403/1403 - 48s - loss: 8.6598 - accuracy10: 0.6542 - accuracy20: 0.6550 - accuracy30: 0.6381 - accuracy50: 0.6106 - val_loss: 10.7250 - val_accuracy10: 0.7420 - val_accuracy20: 0.7228 - val_accuracy30: 0.6917 - val_accuracy50: 0.6289 - 48s/epoch - 34ms/step
Epoch 4/50
1403/1403 - 48s - loss: 8.5300 - accuracy10: 0.6594 - accuracy20: 0.6586 - accuracy30: 0.6421 - accuracy50: 0.6141 - val_loss: 10.5878 - val_accuracy10: 0.7412 - val_accuracy20: 0.7222 - val_accuracy30: 0.6919 - val_accuracy50: 0.6300 - 48s/epoch - 34ms/step
Epoch 5/50
1403/1403 - 47s - loss: 8.4455 - accuracy10: 0.6637 - accuracy20: 0.6627 - accuracy30: 0.6456 - accuracy50: 0.6157 - val_loss: 10.8909 - val_accuracy10: 0.7484 - val_accuracy20: 0.7275 - val_accuracy30: 0.6959 - val_accuracy50: 0.6323 - 47s/epoch - 34ms/step
Epoch 6/50
1403/1403 - 48s - loss: 8.3857 - accuracy10: 0.6653 - accuracy20: 0.6631 - accuracy30: 0.6463 - accuracy50: 0.6160 - val_loss: 10.5736 - val_accuracy10: 0.7591 - val_accuracy20: 0.7362 - val_accuracy30: 0.7022 - val_accuracy50: 0.6352 - 48s/epoch - 34ms/step
Epoch 7/50
1403/1403 - 48s - loss: 8.3308 - accuracy10: 0.6684 - accuracy20: 0.6664 - accuracy30: 0.6487 - accuracy50: 0.6178 - val_loss: 10.6350 - val_accuracy10: 0.7635 - val_accuracy20: 0.7387 - val_accuracy30: 0.7041 - val_accuracy50: 0.6362 - 48s/epoch - 34ms/step
Epoch 8/50
1403/1403 - 50s - loss: 8.2837 - accuracy10: 0.6706 - accuracy20: 0.6679 - accuracy30: 0.6500 - accuracy50: 0.6183 - val_loss: 10.5897 - val_accuracy10: 0.7572 - val_accuracy20: 0.7329 - val_accuracy30: 0.6987 - val_accuracy50: 0.6332 - 50s/epoch - 36ms/step
Epoch 9/50
1403/1403 - 49s - loss: 8.2510 - accuracy10: 0.6730 - accuracy20: 0.6690 - accuracy30: 0.6507 - accuracy50: 0.6193 - val_loss: 10.5543 - val_accuracy10: 0.7537 - val_accuracy20: 0.7285 - val_accuracy30: 0.6946 - val_accuracy50: 0.6323 - 49s/epoch - 35ms/step
Epoch 10/50
1403/1403 - 48s - loss: 8.2133 - accuracy10: 0.6745 - accuracy20: 0.6706 - accuracy30: 0.6517 - accuracy50: 0.6205 - val_loss: 10.5998 - val_accuracy10: 0.7603 - val_accuracy20: 0.7355 - val_accuracy30: 0.7011 - val_accuracy50: 0.6356 - 48s/epoch - 34ms/step
Epoch 11/50
1403/1403 - 49s - loss: 8.1834 - accuracy10: 0.6748 - accuracy20: 0.6712 - accuracy30: 0.6528 - accuracy50: 0.6208 - val_loss: 10.6329 - val_accuracy10: 0.7722 - val_accuracy20: 0.7450 - val_accuracy30: 0.7087 - val_accuracy50: 0.6387 - 49s/epoch - 35ms/step
Epoch 12/50
1403/1403 - 48s - loss: 8.1520 - accuracy10: 0.6761 - accuracy20: 0.6723 - accuracy30: 0.6535 - accuracy50: 0.6214 - val_loss: 10.7358 - val_accuracy10: 0.7670 - val_accuracy20: 0.7415 - val_accuracy30: 0.7047 - val_accuracy50: 0.6368 - 48s/epoch - 35ms/step
Epoch 13/50
1403/1403 - 49s - loss: 8.1273 - accuracy10: 0.6763 - accuracy20: 0.6732 - accuracy30: 0.6553 - accuracy50: 0.6229 - val_loss: 10.7983 - val_accuracy10: 0.7666 - val_accuracy20: 0.7411 - val_accuracy30: 0.7046 - val_accuracy50: 0.6358 - 49s/epoch - 35ms/step
Epoch 14/50
1403/1403 - 48s - loss: 8.0944 - accuracy10: 0.6783 - accuracy20: 0.6738 - accuracy30: 0.6548 - accuracy50: 0.6227 - val_loss: 10.8924 - val_accuracy10: 0.7679 - val_accuracy20: 0.7413 - val_accuracy30: 0.7046 - val_accuracy50: 0.6375 - 48s/epoch - 34ms/step
Epoch 15/50
1403/1403 - 48s - loss: 8.0655 - accuracy10: 0.6788 - accuracy20: 0.6759 - accuracy30: 0.6568 - accuracy50: 0.6236 - val_loss: 10.7592 - val_accuracy10: 0.7603 - val_accuracy20: 0.7357 - val_accuracy30: 0.7023 - val_accuracy50: 0.6363 - 48s/epoch - 34ms/step
Epoch 16/50
1403/1403 - 49s - loss: 8.0378 - accuracy10: 0.6795 - accuracy20: 0.6758 - accuracy30: 0.6568 - accuracy50: 0.6250 - val_loss: 10.8754 - val_accuracy10: 0.7594 - val_accuracy20: 0.7356 - val_accuracy30: 0.6998 - val_accuracy50: 0.6344 - 49s/epoch - 35ms/step
Epoch 17/50
1403/1403 - 48s - loss: 8.0189 - accuracy10: 0.6815 - accuracy20: 0.6770 - accuracy30: 0.6580 - accuracy50: 0.6253 - val_loss: 10.8335 - val_accuracy10: 0.7607 - val_accuracy20: 0.7364 - val_accuracy30: 0.7021 - val_accuracy50: 0.6364 - 48s/epoch - 34ms/step
Epoch 18/50
1403/1403 - 48s - loss: 7.9906 - accuracy10: 0.6815 - accuracy20: 0.6771 - accuracy30: 0.6583 - accuracy50: 0.6263 - val_loss: 10.8754 - val_accuracy10: 0.7584 - val_accuracy20: 0.7340 - val_accuracy30: 0.7016 - val_accuracy50: 0.6360 - 48s/epoch - 34ms/step
Epoch 19/50
1403/1403 - 48s - loss: 7.9662 - accuracy10: 0.6829 - accuracy20: 0.6781 - accuracy30: 0.6595 - accuracy50: 0.6274 - val_loss: 10.8974 - val_accuracy10: 0.7617 - val_accuracy20: 0.7370 - val_accuracy30: 0.7023 - val_accuracy50: 0.6367 - 48s/epoch - 34ms/step
testing model: results/EXC/W2/deepOF_L2/seq2seq
Evaluating performance on  test set...
4918/4918 - 74s - 74s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.59514034
{'0': {'precision': 0.44670466568824874, 'recall': 0.5397335972617427, 'f1-score': 0.48883244939120046, 'support': 145494}, '1': {'precision': 0.9011420181091443, 'recall': 0.799569246294753, 'f1-score': 0.8473224812521093, 'support': 967142}, '2': {'precision': 0.3841447690187186, 'recall': 0.5909656766850435, 'f1-score': 0.4656218674887095, 'support': 146198}, 'accuracy': 0.7453111371316631, 'macro avg': {'precision': 0.5773304842720371, 'recall': 0.6434228400805131, 'f1-score': 0.6005922660440065, 'support': 1258834}, 'weighted avg': {'precision': 0.7885760467613354, 'recall': 0.7453111371316631, 'f1-score': 0.7615589770676398, 'support': 1258834}}
[[ 78528  43025  23941]
 [ 79274 773297 114571]
 [ 17992  41808  86398]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.65068173
{'0': {'precision': 0.5347495036539518, 'recall': 0.49979519219855006, 'f1-score': 0.516681844734741, 'support': 202629}, '1': {'precision': 0.8362844063334752, 'recall': 0.8128190204067235, 'f1-score': 0.8243847667954446, 'support': 850455}, '2': {'precision': 0.48024771677276434, 'recall': 0.5668626974483597, 'f1-score': 0.519972893929667, 'support': 205750}, 'accuracy': 0.7222326375042301, 'macro avg': {'precision': 0.6170938755867305, 'recall': 0.6264923033512111, 'f1-score': 0.6203465018199509, 'support': 1258834}, 'weighted avg': {'precision': 0.7295552707427894, 'recall': 0.7222326375042301, 'f1-score': 0.7251006052329414, 'support': 1258834}}
[[101273  67030  34326]
 [ 67289 691266  91900]
 [ 20822  68296 116632]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.72100264
{'0': {'precision': 0.5629456626302897, 'recall': 0.4665787159190853, 'f1-score': 0.5102520540064363, 'support': 243318}, '1': {'precision': 0.7745131913112121, 'recall': 0.8010647718839706, 'f1-score': 0.7875652584790342, 'support': 766737}, '2': {'precision': 0.5160365858275348, 'recall': 0.5479120022188368, 'f1-score': 0.5314968075254667, 'support': 248779}, 'accuracy': 0.6863827955075887, 'macro avg': {'precision': 0.6178318132563455, 'recall': 0.6051851633406309, 'f1-score': 0.6097713733369791, 'support': 1258834}, 'weighted avg': {'precision': 0.6825378082351207, 'recall': 0.6863827955075887, 'f1-score': 0.6833579146627398, 'support': 1258834}}
[[113527  88748  41043]
 [ 65737 614206  86794]
 [ 22402  90068 136309]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8385404
{'0': {'precision': 0.5885901729595816, 'recall': 0.4160828955049621, 'f1-score': 0.4875263627899907, 'support': 308340}, '1': {'precision': 0.656349872954998, 'recall': 0.7847656342520587, 'f1-score': 0.7148362803187591, 'support': 633305}, '2': {'precision': 0.5554376489501219, 'recall': 0.49671016334109946, 'f1-score': 0.5244349170579239, 'support': 317189}, 'accuracy': 0.6218786591401249, 'macro avg': {'precision': 0.6001258982882338, 'recall': 0.5658528976993734, 'f1-score': 0.5755991867222245, 'support': 1258834}, 'weighted avg': {'precision': 0.6143258465015743, 'recall': 0.621878659140125, 'f1-score': 0.6111832506244853, 'support': 1258834}}
[[128295 128602  51443]
 [ 61651 496996  74658]
 [ 28024 131614 157551]]
Evaluating performance on  train set...
1403/1403 - 23s - 23s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.55400425
{'0': {'precision': 0.4149262390187303, 'recall': 0.5557066348475178, 'f1-score': 0.4751070568557905, 'support': 36037}, '1': {'precision': 0.9145902617225421, 'recall': 0.818342287029931, 'f1-score': 0.8637934430998263, 'support': 286660}, '2': {'precision': 0.392342732788669, 'recall': 0.5863351983022352, 'f1-score': 0.4701124787306919, 'support': 36283}, 'accuracy': 0.7685274945679424, 'macro avg': {'precision': 0.5739530778433138, 'recall': 0.653461373393228, 'f1-score': 0.6030043262287695, 'support': 358980}, 'weighted avg': {'precision': 0.8116455308782472, 'recall': 0.7685274945679424, 'f1-score': 0.7849839892826732, 'support': 358980}}
[[ 20026  10979   5032]
 [ 24157 234586  27917]
 [  4081  10928  21274]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6064073
{'0': {'precision': 0.5032103187455942, 'recall': 0.5175880381743715, 'f1-score': 0.5102979249584606, 'support': 51029}, '1': {'precision': 0.8582480467488862, 'recall': 0.8289850665980611, 'f1-score': 0.8433627915000269, 'support': 256539}, '2': {'precision': 0.4883903170303743, 'recall': 0.5576324593480121, 'f1-score': 0.5207196243858582, 'support': 51412}, 'accuracy': 0.7458577079503036, 'macro avg': {'precision': 0.6166162275082848, 'recall': 0.6347351880401483, 'f1-score': 0.6247934469481152, 'support': 358980}, 'weighted avg': {'precision': 0.7548095659907155, 'recall': 0.7458577079503036, 'f1-score': 0.7498096754979564, 'support': 358980}}
[[ 26412  17221   7396]
 [ 21236 212667  22636]
 [  4839  17904  28669]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.67287594
{'0': {'precision': 0.538438071995119, 'recall': 0.4818609581011418, 'f1-score': 0.5085808720708506, 'support': 62269}, '1': {'precision': 0.8034778684894419, 'recall': 0.8213291193303152, 'f1-score': 0.8123054308294718, 'support': 234140}, '2': {'precision': 0.5239861058956065, 'recall': 0.5352159946301002, 'f1-score': 0.5295415194136761, 'support': 62571}, 'accuracy': 0.7125745166861663, 'macro avg': {'precision': 0.6219673487933891, 'recall': 0.6128020240205191, 'f1-score': 0.6168092741046661, 'support': 358980}, 'weighted avg': {'precision': 0.7087877961590505, 'recall': 0.7125745166861663, 'f1-score': 0.7103347214569765, 'support': 358980}}
[[ 30005  23151   9113]
 [ 20524 192306  21310]
 [  5197  23885  33489]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7887997
{'0': {'precision': 0.5700596999949832, 'recall': 0.42291421127721607, 'f1-score': 0.4855844562832968, 'support': 80605}, '1': {'precision': 0.6953074138694305, 'recall': 0.8093840308792919, 'f1-score': 0.7480214223346983, 'support': 197932}, '2': {'precision': 0.5593166121410397, 'recall': 0.47818952550252974, 'f1-score': 0.515581230146497, 'support': 80443}, 'accuracy': 0.6483898824447044, 'macro avg': {'precision': 0.6082279086684844, 'recall': 0.5701625892196792, 'f1-score': 0.583062369588164, 'support': 358980}, 'weighted avg': {'precision': 0.6367105559935411, 'recall': 0.6483898824447044, 'f1-score': 0.6370071094794731, 'support': 358980}}
[[ 34089  34675  11841]
 [ 19262 160203  18467]
 [  6448  35528  38467]]
Evaluating performance on  val set...
480/480 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.57623005
{'0': {'precision': 0.43277134457310856, 'recall': 0.5370011911852293, 'f1-score': 0.4792850260806007, 'support': 13432}, '1': {'precision': 0.9096860954807658, 'recall': 0.8024286695386152, 'f1-score': 0.8526977492494734, 'support': 96102}, '2': {'precision': 0.3819907886079519, 'recall': 0.6165983917463207, 'f1-score': 0.47173534532791644, 'support': 13182}, 'accuracy': 0.7534143876919065, 'macro avg': {'precision': 0.5748160762206088, 'recall': 0.6520094174900551, 'f1-score': 0.6012393735526635, 'support': 122716}, 'weighted avg': {'precision': 0.8008005510579597, 'recall': 0.7534143876919065, 'f1-score': 0.7709029864956494, 'support': 122716}}
[[ 7213  4074  2145]
 [ 7982 77115 11005]
 [ 1472  3582  8128]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.635349
{'0': {'precision': 0.5177631214321343, 'recall': 0.4980540598176681, 'f1-score': 0.5077173913043478, 'support': 18757}, '1': {'precision': 0.8487546007018745, 'recall': 0.8123112931538912, 'f1-score': 0.8301331690894631, 'support': 85450}, '2': {'precision': 0.4718242180674471, 'recall': 0.5835539467286185, 'f1-score': 0.5217748363566097, 'support': 18509}, 'accuracy': 0.7297744385410215, 'macro avg': {'precision': 0.6127806467338187, 'recall': 0.6313064332333926, 'f1-score': 0.6198751322501402, 'support': 122716}, 'weighted avg': {'precision': 0.7413113037492103, 'recall': 0.7297744385410215, 'f1-score': 0.7343432384816548, 'support': 122716}}
[[ 9342  6406  3009]
 [ 6956 69412  9082]
 [ 1745  5963 10801]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.703309
{'0': {'precision': 0.5486089402938418, 'recall': 0.46399929496783293, 'f1-score': 0.5027692895339954, 'support': 22694}, '1': {'precision': 0.7898349029625958, 'recall': 0.8024508031609937, 'f1-score': 0.7960928742994395, 'support': 77444}, '2': {'precision': 0.5101646471559116, 'recall': 0.5612986092656569, 'f1-score': 0.5345114827389865, 'support': 22578}, 'accuracy': 0.6954920303790867, 'macro avg': {'precision': 0.6162028301374497, 'recall': 0.6092495691314945, 'f1-score': 0.6111245488574738, 'support': 122716}, 'weighted avg': {'precision': 0.6937693774206288, 'recall': 0.6954920303790867, 'f1-score': 0.6937209742104626, 'support': 122716}}
[[10530  8555  3609]
 [ 6740 62145  8559]
 [ 1924  7981 12673]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8177821
{'0': {'precision': 0.5762351348738277, 'recall': 0.409762805087659, 'f1-score': 0.4789456766313083, 'support': 29090}, '1': {'precision': 0.6755048497376371, 'recall': 0.790960714950661, 'f1-score': 0.7286878216123498, 'support': 64452}, '2': {'precision': 0.5551539793690234, 'recall': 0.5054500582710633, 'f1-score': 0.5291373618487154, 'support': 29174}, 'accuracy': 0.6327210795658268, 'macro avg': {'precision': 0.6022979879934961, 'recall': 0.5687245261031277, 'f1-score': 0.5789236200307911, 'support': 122716}, 'weighted avg': {'precision': 0.6233611007764409, 'recall': 0.6327210795658268, 'f1-score': 0.6220457854423087, 'support': 122716}}
[[11920 12561  4609]
 [ 6266 50979  7207]
 [ 2500 11928 14746]]
training model: results/EXC/W2/deepVOL_L2/seq2seq
Epoch 1/50
1403/1403 - 53s - loss: 9.5313 - accuracy10: 0.6224 - accuracy20: 0.6248 - accuracy30: 0.6089 - accuracy50: 0.5817 - val_loss: 11.3188 - val_accuracy10: 0.7725 - val_accuracy20: 0.7500 - val_accuracy30: 0.7133 - val_accuracy50: 0.6355 - 53s/epoch - 38ms/step
Epoch 2/50
1403/1403 - 46s - loss: 8.9131 - accuracy10: 0.6500 - accuracy20: 0.6494 - accuracy30: 0.6334 - accuracy50: 0.6029 - val_loss: 10.8866 - val_accuracy10: 0.7812 - val_accuracy20: 0.7539 - val_accuracy30: 0.7163 - val_accuracy50: 0.6402 - 46s/epoch - 33ms/step
Epoch 3/50
1403/1403 - 46s - loss: 8.6875 - accuracy10: 0.6635 - accuracy20: 0.6587 - accuracy30: 0.6393 - accuracy50: 0.6079 - val_loss: 10.6805 - val_accuracy10: 0.7789 - val_accuracy20: 0.7563 - val_accuracy30: 0.7211 - val_accuracy50: 0.6446 - 46s/epoch - 33ms/step
Epoch 4/50
1403/1403 - 47s - loss: 8.5472 - accuracy10: 0.6723 - accuracy20: 0.6657 - accuracy30: 0.6436 - accuracy50: 0.6088 - val_loss: 11.0181 - val_accuracy10: 0.7784 - val_accuracy20: 0.7532 - val_accuracy30: 0.7169 - val_accuracy50: 0.6415 - 47s/epoch - 33ms/step
Epoch 5/50
1403/1403 - 46s - loss: 8.4502 - accuracy10: 0.6770 - accuracy20: 0.6701 - accuracy30: 0.6471 - accuracy50: 0.6110 - val_loss: 10.9079 - val_accuracy10: 0.7780 - val_accuracy20: 0.7535 - val_accuracy30: 0.7169 - val_accuracy50: 0.6420 - 46s/epoch - 33ms/step
Epoch 6/50
1403/1403 - 47s - loss: 8.3916 - accuracy10: 0.6787 - accuracy20: 0.6719 - accuracy30: 0.6478 - accuracy50: 0.6120 - val_loss: 11.0293 - val_accuracy10: 0.7798 - val_accuracy20: 0.7548 - val_accuracy30: 0.7183 - val_accuracy50: 0.6405 - 47s/epoch - 33ms/step
Epoch 7/50
1403/1403 - 48s - loss: 8.3451 - accuracy10: 0.6803 - accuracy20: 0.6730 - accuracy30: 0.6499 - accuracy50: 0.6134 - val_loss: 10.9366 - val_accuracy10: 0.7821 - val_accuracy20: 0.7565 - val_accuracy30: 0.7197 - val_accuracy50: 0.6434 - 48s/epoch - 34ms/step
Epoch 8/50
1403/1403 - 47s - loss: 8.3059 - accuracy10: 0.6823 - accuracy20: 0.6737 - accuracy30: 0.6502 - accuracy50: 0.6131 - val_loss: 11.0485 - val_accuracy10: 0.7845 - val_accuracy20: 0.7570 - val_accuracy30: 0.7202 - val_accuracy50: 0.6421 - 47s/epoch - 34ms/step
Epoch 9/50
1403/1403 - 47s - loss: 8.2793 - accuracy10: 0.6839 - accuracy20: 0.6750 - accuracy30: 0.6518 - accuracy50: 0.6143 - val_loss: 10.9435 - val_accuracy10: 0.7822 - val_accuracy20: 0.7566 - val_accuracy30: 0.7199 - val_accuracy50: 0.6435 - 47s/epoch - 33ms/step
Epoch 10/50
1403/1403 - 46s - loss: 8.2499 - accuracy10: 0.6852 - accuracy20: 0.6762 - accuracy30: 0.6525 - accuracy50: 0.6151 - val_loss: 11.0925 - val_accuracy10: 0.7814 - val_accuracy20: 0.7544 - val_accuracy30: 0.7182 - val_accuracy50: 0.6421 - 46s/epoch - 33ms/step
Epoch 11/50
1403/1403 - 47s - loss: 8.2195 - accuracy10: 0.6856 - accuracy20: 0.6761 - accuracy30: 0.6525 - accuracy50: 0.6160 - val_loss: 11.0889 - val_accuracy10: 0.7850 - val_accuracy20: 0.7568 - val_accuracy30: 0.7205 - val_accuracy50: 0.6447 - 47s/epoch - 33ms/step
Epoch 12/50
1403/1403 - 46s - loss: 8.1918 - accuracy10: 0.6873 - accuracy20: 0.6772 - accuracy30: 0.6536 - accuracy50: 0.6161 - val_loss: 11.0761 - val_accuracy10: 0.7845 - val_accuracy20: 0.7561 - val_accuracy30: 0.7203 - val_accuracy50: 0.6453 - 46s/epoch - 33ms/step
Epoch 13/50
1403/1403 - 46s - loss: 8.1663 - accuracy10: 0.6871 - accuracy20: 0.6770 - accuracy30: 0.6541 - accuracy50: 0.6173 - val_loss: 10.9761 - val_accuracy10: 0.7816 - val_accuracy20: 0.7541 - val_accuracy30: 0.7190 - val_accuracy50: 0.6451 - 46s/epoch - 33ms/step
testing model: results/EXC/W2/deepVOL_L2/seq2seq
Evaluating performance on  test set...
4918/4918 - 73s - 73s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5396633
{'0': {'precision': 0.46130249842241805, 'recall': 0.5426372040276298, 'f1-score': 0.4986751641438466, 'support': 145495}, '1': {'precision': 0.9043183771743085, 'recall': 0.8147640736394233, 'f1-score': 0.8572085934618936, 'support': 967145}, '2': {'precision': 0.40894130046874566, 'recall': 0.605086218099987, 'f1-score': 0.4880434512759261, 'support': 146199}, 'accuracy': 0.7589604389441382, 'macro avg': {'precision': 0.5915207253551574, 'recall': 0.6541624985890134, 'f1-score': 0.6146424029605555, 'support': 1258839}, 'weighted avg': {'precision': 0.7955830833708255, 'recall': 0.7589604389441382, 'f1-score': 0.7728956702675251, 'support': 1258839}}
[[ 78951  47808  18736]
 [ 70027 787995 109123]
 [ 22170  35566  88463]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.5976882
{'0': {'precision': 0.5651190455261971, 'recall': 0.4759218682142998, 'f1-score': 0.516699215872225, 'support': 202632}, '1': {'precision': 0.8280985126954175, 'recall': 0.8426418799348584, 'f1-score': 0.8353068981715144, 'support': 850455}, '2': {'precision': 0.5178479257088228, 'recall': 0.56075275088456, 'f1-score': 0.5384469993069668, 'support': 205752}, 'accuracy': 0.7375383190384156, 'macro avg': {'precision': 0.6370218279768124, 'recall': 0.6264388330112395, 'f1-score': 0.6301510377835687, 'support': 1258839}, 'weighted avg': {'precision': 0.7350582317976225, 'recall': 0.7375383190384156, 'f1-score': 0.7355009422145985, 'support': 1258839}}
[[ 96437  83784  22411]
 [ 48814 716629  85012]
 [ 25398  64978 115376]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6754369
{'0': {'precision': 0.6095620821309918, 'recall': 0.4245297364386962, 'f1-score': 0.5004917850100052, 'support': 243321}, '1': {'precision': 0.7559199958246589, 'recall': 0.8500411483989947, 'f1-score': 0.8002224756928116, 'support': 766737}, '2': {'precision': 0.5706267910359065, 'recall': 0.521064711533437, 'f1-score': 0.5447207083037438, 'support': 248781}, 'accuracy': 0.702779306964592, 'macro avg': {'precision': 0.6453696229971858, 'recall': 0.5985451987903759, 'f1-score': 0.6151449896688536, 'support': 1258839}, 'weighted avg': {'precision': 0.69101147082789, 'recall': 0.702779306964592, 'f1-score': 0.6917933941498574, 'support': 1258839}}
[[103297 117295  22729]
 [ 40166 651758  74813]
 [ 25998  93152 129631]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.82665515
{'0': {'precision': 0.6488507288061229, 'recall': 0.3453264708457789, 'f1-score': 0.4507553228192792, 'support': 308343}, '1': {'precision': 0.6261136826427971, 'recall': 0.8549908811709998, 'f1-score': 0.7228679221101704, 'support': 633305}, '2': {'precision': 0.6247325203110593, 'recall': 0.4528533281209114, 'f1-score': 0.5250852197435639, 'support': 317191}, 'accuracy': 0.6288254494816256, 'macro avg': {'precision': 0.6332323105866599, 'recall': 0.55105689337923, 'f1-score': 0.5662361548910045, 'support': 1258839}, 'weighted avg': {'precision': 0.6313349355305549, 'recall': 0.6288254494816256, 'f1-score': 0.6063805012807255, 'support': 1258839}}
[[106479 176869  24995]
 [ 30547 541470  61288]
 [ 27078 146472 143641]]
Evaluating performance on  train set...
1403/1403 - 20s - 20s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5084854
{'0': {'precision': 0.4278471386019393, 'recall': 0.5621149042464613, 'f1-score': 0.4858757062146893, 'support': 36030}, '1': {'precision': 0.9173675809248999, 'recall': 0.8339245663419246, 'f1-score': 0.8736581880902831, 'support': 286689}, '2': {'precision': 0.4219592012698164, 'recall': 0.5938335953227986, 'f1-score': 0.49335563396416615, 'support': 36261}, 'accuracy': 0.7823917767006519, 'macro avg': {'precision': 0.5890579735988851, 'recall': 0.6632910219703948, 'f1-score': 0.6176298427563794, 'support': 358980}, 'weighted avg': {'precision': 0.8181937417372871, 'recall': 0.7823917767006519, 'f1-score': 0.7963225322399717, 'support': 358980}}
[[ 20253  11862   3915]
 [ 22029 239077  25583]
 [  5055   9673  21533]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.55996424
{'0': {'precision': 0.5384451815939441, 'recall': 0.49640273666464096, 'f1-score': 0.5165699364538603, 'support': 51011}, '1': {'precision': 0.8523714996049107, 'recall': 0.8618929021043072, 'f1-score': 0.8571057588700862, 'support': 256569}, '2': {'precision': 0.533008359197974, 'recall': 0.5445914396887159, 'f1-score': 0.5387376463908696, 'support': 51400}, 'accuracy': 0.7645244860437908, 'macro avg': {'precision': 0.6412750134656096, 'recall': 0.6342956928192214, 'f1-score': 0.6374711139049386, 'support': 358980}, 'weighted avg': {'precision': 0.7620350997359098, 'recall': 0.7645244860437908, 'f1-score': 0.7631306242700923, 'support': 358980}}
[[ 25322  20972   4717]
 [ 15626 221135  19808]
 [  6080  17328  27992]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6311488
{'0': {'precision': 0.5894978343839787, 'recall': 0.44161205345669496, 'f1-score': 0.5049497676639668, 'support': 62256}, '1': {'precision': 0.7889274827003991, 'recall': 0.8719776230943331, 'f1-score': 0.8283761772527288, 'support': 234170}, '2': {'precision': 0.5851908596625623, 'recall': 0.5006874060811459, 'f1-score': 0.5396510876588413, 'support': 62554}, 'accuracy': 0.7326424870466322, 'macro avg': {'precision': 0.6545387255823134, 'recall': 0.604759027544058, 'f1-score': 0.624325677525179, 'support': 358980}, 'weighted avg': {'precision': 0.718839363855071, 'recall': 0.7326424870466322, 'f1-score': 0.721974305811941, 'support': 358980}}
[[ 27493  29859   4904]
 [ 12682 204191  17297]
 [  6463  24771  31320]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7708249
{'0': {'precision': 0.6357316803187957, 'recall': 0.356428269989822, 'f1-score': 0.4567665585035312, 'support': 80566}, '1': {'precision': 0.6701357047631524, 'recall': 0.8782614843130621, 'f1-score': 0.760211117546141, 'support': 198031}, '2': {'precision': 0.6342213869850394, 'recall': 0.4282373138598958, 'f1-score': 0.511261779754788, 'support': 80383}, 'accuracy': 0.6603766226530726, 'macro avg': {'precision': 0.6466962573556625, 'recall': 0.5543090227209266, 'f1-score': 0.5760798186014867, 'support': 358980}, 'weighted avg': {'precision': 0.6543724443047924, 'recall': 0.6603766226530726, 'f1-score': 0.6363640816012159, 'support': 358980}}
[[ 28716  46459   5391]
 [  9646 173923  14462]
 [  6808  39152  34423]]
Evaluating performance on  val set...
480/480 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.51382273
{'0': {'precision': 0.4589669638175144, 'recall': 0.5233966213185828, 'f1-score': 0.48906893902353843, 'support': 13378}, '1': {'precision': 0.9073533225831915, 'recall': 0.8372526169021706, 'f1-score': 0.8708945975636815, 'support': 96106}, '2': {'precision': 0.4309904153354633, 'recall': 0.6116526864656541, 'f1-score': 0.5056695717364821, 'support': 13233}, 'accuracy': 0.7787103661269424, 'macro avg': {'precision': 0.5991035672453897, 'recall': 0.6574339748954691, 'f1-score': 0.6218777027745673, 'support': 122717}, 'weighted avg': {'precision': 0.8071045953556971, 'recall': 0.7787103661269424, 'f1-score': 0.789886371916694, 'support': 122717}}
[[ 7002  4817  1559]
 [ 6514 80465  9127]
 [ 1740  3399  8094]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.5771116
{'0': {'precision': 0.5658482142857143, 'recall': 0.4598762138512432, 'f1-score': 0.5073880025902161, 'support': 18742}, '1': {'precision': 0.8363279788693276, 'recall': 0.8636331710058063, 'f1-score': 0.8497612835973899, 'support': 85424}, '2': {'precision': 0.5406288916562889, 'recall': 0.5616408818931594, 'f1-score': 0.550934616503186, 'support': 18551}, 'accuracy': 0.7563173806400091, 'macro avg': {'precision': 0.6476016949371103, 'recall': 0.6283834222500696, 'f1-score': 0.6360279675635973, 'support': 122717}, 'weighted avg': {'precision': 0.7503183346088327, 'recall': 0.7563173806400091, 'f1-score': 0.7522988820238424, 'support': 122717}}
[[ 8619  8281  1842]
 [ 4638 73775  7011]
 [ 1975  6157 10419]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6561965
{'0': {'precision': 0.6128754796877067, 'recall': 0.40840350954543453, 'f1-score': 0.4901706574943776, 'support': 22681}, '1': {'precision': 0.7678585640384288, 'recall': 0.8719964881021549, 'f1-score': 0.8166209206437494, 'support': 77451}, '2': {'precision': 0.5917141693811075, 'recall': 0.5147664379012619, 'f1-score': 0.5505647242677527, 'support': 22585}, 'accuracy': 0.7205684623972228, 'macro avg': {'precision': 0.6574827377024143, 'recall': 0.5983888118496171, 'f1-score': 0.6191187674686266, 'support': 122717}, 'weighted avg': {'precision': 0.7067961807541706, 'recall': 0.7205684623972228, 'f1-score': 0.7073198652590611, 'support': 122717}}
[[ 9263 11509  1909]
 [ 3801 67537  6113]
 [ 2050  8909 11626]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.805664
{'0': {'precision': 0.655525238744884, 'recall': 0.33036543023135895, 'f1-score': 0.439324327413198, 'support': 29089}, '1': {'precision': 0.642691020477622, 'recall': 0.8792078593267425, 'f1-score': 0.7425710128589965, 'support': 64433}, '2': {'precision': 0.6426777822418642, 'recall': 0.4383284809042644, 'f1-score': 0.5211884252754191, 'support': 29195}, 'accuracy': 0.6442220719215757, 'macro avg': {'precision': 0.6469646804881234, 'recall': 0.549300590154122, 'f1-score': 0.5676945885158712, 'support': 122717}, 'weighted avg': {'precision': 0.6457301111079621, 'recall': 0.6442220719215757, 'f1-score': 0.6180209710763961, 'support': 122717}}
[[ 9610 17343  2136]
 [ 2804 56650  4979]
 [ 2246 14152 12797]]
training model: results/EXC/W2/deepVOL_L3/seq2seq
Epoch 1/50
1403/1403 - 71s - loss: 9.9179 - accuracy10: 0.5980 - accuracy20: 0.6023 - accuracy30: 0.5914 - accuracy50: 0.5678 - val_loss: 10.4149 - val_accuracy10: 0.7410 - val_accuracy20: 0.7226 - val_accuracy30: 0.6908 - val_accuracy50: 0.6260 - 71s/epoch - 51ms/step
Epoch 2/50
1403/1403 - 63s - loss: 8.9551 - accuracy10: 0.6565 - accuracy20: 0.6535 - accuracy30: 0.6327 - accuracy50: 0.6006 - val_loss: 10.1451 - val_accuracy10: 0.7585 - val_accuracy20: 0.7391 - val_accuracy30: 0.7069 - val_accuracy50: 0.6410 - 63s/epoch - 45ms/step
Epoch 3/50
1403/1403 - 63s - loss: 8.6804 - accuracy10: 0.6697 - accuracy20: 0.6630 - accuracy30: 0.6405 - accuracy50: 0.6054 - val_loss: 10.1904 - val_accuracy10: 0.7510 - val_accuracy20: 0.7330 - val_accuracy30: 0.7030 - val_accuracy50: 0.6392 - 63s/epoch - 45ms/step
Epoch 4/50
1403/1403 - 63s - loss: 8.4911 - accuracy10: 0.6777 - accuracy20: 0.6697 - accuracy30: 0.6453 - accuracy50: 0.6095 - val_loss: 10.0715 - val_accuracy10: 0.7548 - val_accuracy20: 0.7370 - val_accuracy30: 0.7079 - val_accuracy50: 0.6445 - 63s/epoch - 45ms/step
Epoch 5/50
1403/1403 - 64s - loss: 8.3722 - accuracy10: 0.6828 - accuracy20: 0.6732 - accuracy30: 0.6487 - accuracy50: 0.6131 - val_loss: 9.8919 - val_accuracy10: 0.7452 - val_accuracy20: 0.7298 - val_accuracy30: 0.7021 - val_accuracy50: 0.6427 - 64s/epoch - 46ms/step
Epoch 6/50
1403/1403 - 63s - loss: 8.3084 - accuracy10: 0.6847 - accuracy20: 0.6743 - accuracy30: 0.6506 - accuracy50: 0.6156 - val_loss: 9.7998 - val_accuracy10: 0.7338 - val_accuracy20: 0.7217 - val_accuracy30: 0.6958 - val_accuracy50: 0.6420 - 63s/epoch - 45ms/step
Epoch 7/50
1403/1403 - 64s - loss: 8.2519 - accuracy10: 0.6856 - accuracy20: 0.6753 - accuracy30: 0.6520 - accuracy50: 0.6165 - val_loss: 9.7956 - val_accuracy10: 0.7484 - val_accuracy20: 0.7331 - val_accuracy30: 0.7045 - val_accuracy50: 0.6460 - 64s/epoch - 45ms/step
Epoch 8/50
1403/1403 - 64s - loss: 8.2158 - accuracy10: 0.6866 - accuracy20: 0.6757 - accuracy30: 0.6525 - accuracy50: 0.6174 - val_loss: 9.7493 - val_accuracy10: 0.7335 - val_accuracy20: 0.7211 - val_accuracy30: 0.6951 - val_accuracy50: 0.6414 - 64s/epoch - 46ms/step
Epoch 9/50
1403/1403 - 63s - loss: 8.1766 - accuracy10: 0.6880 - accuracy20: 0.6767 - accuracy30: 0.6535 - accuracy50: 0.6180 - val_loss: 9.6398 - val_accuracy10: 0.7361 - val_accuracy20: 0.7219 - val_accuracy30: 0.6952 - val_accuracy50: 0.6407 - 63s/epoch - 45ms/step
Epoch 10/50
1403/1403 - 62s - loss: 8.1467 - accuracy10: 0.6901 - accuracy20: 0.6782 - accuracy30: 0.6547 - accuracy50: 0.6191 - val_loss: 9.8230 - val_accuracy10: 0.7320 - val_accuracy20: 0.7188 - val_accuracy30: 0.6934 - val_accuracy50: 0.6407 - 62s/epoch - 44ms/step
Epoch 11/50
1403/1403 - 63s - loss: 8.1204 - accuracy10: 0.6913 - accuracy20: 0.6784 - accuracy30: 0.6557 - accuracy50: 0.6197 - val_loss: 9.8610 - val_accuracy10: 0.7356 - val_accuracy20: 0.7223 - val_accuracy30: 0.6958 - val_accuracy50: 0.6419 - 63s/epoch - 45ms/step
Epoch 12/50
1403/1403 - 63s - loss: 8.0951 - accuracy10: 0.6921 - accuracy20: 0.6788 - accuracy30: 0.6553 - accuracy50: 0.6195 - val_loss: 9.7833 - val_accuracy10: 0.7306 - val_accuracy20: 0.7181 - val_accuracy30: 0.6942 - val_accuracy50: 0.6434 - 63s/epoch - 45ms/step
Epoch 13/50
1403/1403 - 63s - loss: 8.0731 - accuracy10: 0.6923 - accuracy20: 0.6792 - accuracy30: 0.6559 - accuracy50: 0.6205 - val_loss: 9.8608 - val_accuracy10: 0.7451 - val_accuracy20: 0.7278 - val_accuracy30: 0.7012 - val_accuracy50: 0.6450 - 63s/epoch - 45ms/step
Epoch 14/50
1403/1403 - 63s - loss: 8.0486 - accuracy10: 0.6927 - accuracy20: 0.6800 - accuracy30: 0.6566 - accuracy50: 0.6213 - val_loss: 9.7551 - val_accuracy10: 0.7221 - val_accuracy20: 0.7106 - val_accuracy30: 0.6881 - val_accuracy50: 0.6387 - 63s/epoch - 45ms/step
Epoch 15/50
1403/1403 - 64s - loss: 8.0242 - accuracy10: 0.6936 - accuracy20: 0.6803 - accuracy30: 0.6577 - accuracy50: 0.6219 - val_loss: 9.9304 - val_accuracy10: 0.7320 - val_accuracy20: 0.7173 - val_accuracy30: 0.6925 - val_accuracy50: 0.6400 - 64s/epoch - 46ms/step
Epoch 16/50
1403/1403 - 64s - loss: 8.0118 - accuracy10: 0.6939 - accuracy20: 0.6813 - accuracy30: 0.6578 - accuracy50: 0.6225 - val_loss: 9.8265 - val_accuracy10: 0.7290 - val_accuracy20: 0.7159 - val_accuracy30: 0.6920 - val_accuracy50: 0.6409 - 64s/epoch - 46ms/step
Epoch 17/50
1403/1403 - 64s - loss: 7.9916 - accuracy10: 0.6936 - accuracy20: 0.6822 - accuracy30: 0.6592 - accuracy50: 0.6234 - val_loss: 9.9949 - val_accuracy10: 0.7377 - val_accuracy20: 0.7218 - val_accuracy30: 0.6945 - val_accuracy50: 0.6412 - 64s/epoch - 45ms/step
Epoch 18/50
1403/1403 - 62s - loss: 7.9756 - accuracy10: 0.6937 - accuracy20: 0.6827 - accuracy30: 0.6598 - accuracy50: 0.6238 - val_loss: 10.0228 - val_accuracy10: 0.7404 - val_accuracy20: 0.7234 - val_accuracy30: 0.6952 - val_accuracy50: 0.6402 - 62s/epoch - 44ms/step
Epoch 19/50
1403/1403 - 63s - loss: 7.9545 - accuracy10: 0.6948 - accuracy20: 0.6824 - accuracy30: 0.6594 - accuracy50: 0.6236 - val_loss: 10.0594 - val_accuracy10: 0.7304 - val_accuracy20: 0.7173 - val_accuracy30: 0.6919 - val_accuracy50: 0.6396 - 63s/epoch - 45ms/step
testing model: results/EXC/W2/deepVOL_L3/seq2seq
Evaluating performance on  test set...
4918/4918 - 101s - 101s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.56192887
{'0': {'precision': 0.4203112624935012, 'recall': 0.5945427677927076, 'f1-score': 0.4924708655231112, 'support': 145495}, '1': {'precision': 0.9298449952837934, 'recall': 0.755291088719892, 'f1-score': 0.8335275061703602, 'support': 967145}, '2': {'precision': 0.3927640656139813, 'recall': 0.718486446555722, 'f1-score': 0.5078884639374145, 'support': 146199}, 'accuracy': 0.7324375873324548, 'macro avg': {'precision': 0.5809734411304253, 'recall': 0.689440101022774, 'f1-score': 0.611295611876962, 'support': 1258839}, 'weighted avg': {'precision': 0.8085782524444626, 'recall': 0.7324375873324548, 'f1-score': 0.7562895605185446, 'support': 1258839}}
[[ 86503  27268  31724]
 [105992 730476 130677]
 [ 13312  27845 105042]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6083804
{'0': {'precision': 0.505930923722822, 'recall': 0.5721110189900904, 'f1-score': 0.5369896009449475, 'support': 202632}, '1': {'precision': 0.8673982211535268, 'recall': 0.7677313908437249, 'f1-score': 0.8145272862230929, 'support': 850455}, '2': {'precision': 0.49181487980474137, 'recall': 0.6620397371592985, 'f1-score': 0.5643709163528189, 'support': 205752}, 'accuracy': 0.7189680332433298, 'macro avg': {'precision': 0.6217146748936967, 'recall': 0.6672940489977046, 'f1-score': 0.6386292678402864, 'support': 1258839}, 'weighted avg': {'precision': 0.7478262464513021, 'recall': 0.7189680332433298, 'f1-score': 0.7289657571817859, 'support': 1258839}}
[[115928  49634  37070]
 [ 93854 652921 103680]
 [ 19356  50180 136216]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.67578244
{'0': {'precision': 0.5393551840332829, 'recall': 0.5466523645719029, 'f1-score': 0.5429792584307274, 'support': 243321}, '1': {'precision': 0.8034523455811957, 'recall': 0.7617957656927995, 'f1-score': 0.782069743948167, 'support': 766737}, '2': {'precision': 0.536530384725952, 'recall': 0.6151635374084033, 'f1-score': 0.5731625791398498, 'support': 248781}, 'accuracy': 0.6912321591561749, 'macro avg': {'precision': 0.6264459714468101, 'recall': 0.6412038892243687, 'f1-score': 0.6327371938395814, 'support': 1258839}, 'weighted avg': {'precision': 0.6996539267297556, 'recall': 0.6912321591561749, 'f1-score': 0.6945701753816014, 'support': 1258839}}
[[133012  71554  38755]
 [ 89194 584097  93446]
 [ 24407  71333 153041]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.805463
{'0': {'precision': 0.5720993478979476, 'recall': 0.4939369468416666, 'f1-score': 0.5301526910204174, 'support': 308343}, '1': {'precision': 0.6790582244808546, 'recall': 0.7513425600618975, 'f1-score': 0.7133739722823577, 'support': 633305}, '2': {'precision': 0.5833390429730322, 'recall': 0.5368342733558014, 'f1-score': 0.5591213193344222, 'support': 317191}, 'accuracy': 0.634243139909075, 'macro avg': {'precision': 0.6114988717839448, 'recall': 0.5940379267531218, 'f1-score': 0.6008826608790657, 'support': 1258839}, 'weighted avg': {'precision': 0.628741000607229, 'recall': 0.634243139909075, 'f1-score': 0.6296281137815016, 'support': 1258839}}
[[152302 112753  43288]
 [ 79139 475829  78337]
 [ 34775 112137 170279]]
Evaluating performance on  train set...
1403/1403 - 30s - 30s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5677169
{'0': {'precision': 0.3604201997361975, 'recall': 0.6370524562864279, 'f1-score': 0.4603766772970696, 'support': 36030}, '1': {'precision': 0.944711591927154, 'recall': 0.7407818228114786, 'f1-score': 0.8304098597827532, 'support': 286689}, '2': {'precision': 0.3823358347637354, 'recall': 0.7432779018780508, 'f1-score': 0.5049365831725274, 'support': 36261}, 'accuracy': 0.7306228759262354, 'macro avg': {'precision': 0.562489208809029, 'recall': 0.7070373936586525, 'f1-score': 0.5985743734174501, 'support': 358980}, 'weighted avg': {'precision': 0.8292613546126996, 'recall': 0.7306228759262354, 'f1-score': 0.7603940314688566, 'support': 358980}}
[[ 22953   6005   7072]
 [ 37846 212374  36469]
 [  2885   6424  26952]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.601751
{'0': {'precision': 0.4454768139200946, 'recall': 0.6203367901040951, 'f1-score': 0.5185628251874309, 'support': 51011}, '1': {'precision': 0.8951316787587433, 'recall': 0.7496813722624324, 'f1-score': 0.8159754628294107, 'support': 256569}, '2': {'precision': 0.4799978102289679, 'recall': 0.6823346303501946, 'f1-score': 0.5635549985136622, 'support': 51400}, 'accuracy': 0.7216585882221851, 'macro avg': {'precision': 0.6068687676359353, 'recall': 0.6841175975722407, 'f1-score': 0.6326977621768347, 'support': 358980}, 'weighted avg': {'precision': 0.7717954896877234, 'recall': 0.7216585882221851, 'f1-score': 0.7375707385423069, 'support': 358980}}
[[ 31644  10873   8494]
 [ 34723 192345  29501]
 [  4667  11661  35072]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.65788776
{'0': {'precision': 0.4827129214578055, 'recall': 0.5967617579028527, 'f1-score': 0.533712586463249, 'support': 62256}, '1': {'precision': 0.8425003266724419, 'recall': 0.7434129051543751, 'f1-score': 0.789861138523454, 'support': 234170}, '2': {'precision': 0.5242617992730746, 'recall': 0.631806119512741, 'f1-score': 0.5730317529360592, 'support': 62554}, 'accuracy': 0.69853195164076, 'macro avg': {'precision': 0.6164916824677741, 'recall': 0.6573269275233229, 'f1-score': 0.6322018259742541, 'support': 358980}, 'weighted avg': {'precision': 0.724649701172463, 'recall': 0.69853195164076, 'f1-score': 0.7076550834699858, 'support': 358980}}
[[ 37152  15914   9190]
 [ 33411 174085  26674]
 [  6402  16630  39522]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7649182
{'0': {'precision': 0.5220512575079567, 'recall': 0.5415684035449196, 'f1-score': 0.5316307632322838, 'support': 80566}, '1': {'precision': 0.7329422770599985, 'recall': 0.7319207598810288, 'f1-score': 0.7324311622947755, 'support': 198031}, '2': {'precision': 0.5698352801782426, 'recall': 0.5504397696030255, 'f1-score': 0.5599696260203759, 'support': 80383}, 'accuracy': 0.6485625940163797, 'macro avg': {'precision': 0.6082762715820659, 'recall': 0.607976311009658, 'f1-score': 0.6080105171824784, 'support': 358980}, 'weighted avg': {'precision': 0.6490889269803952, 'recall': 0.6485625940163797, 'f1-score': 0.6487477798745466, 'support': 358980}}
[[ 43632  26317  10617]
 [ 30304 144943  22784]
 [  9642  26495  44246]]
Evaluating performance on  val set...
480/480 - 9s - 9s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.55938625
{'0': {'precision': 0.3930444246561789, 'recall': 0.5938854836298401, 'f1-score': 0.47302929268873545, 'support': 13378}, '1': {'precision': 0.9349583033048492, 'recall': 0.7559361538301459, 'f1-score': 0.835970312410103, 'support': 96106}, '2': {'precision': 0.39174966732529537, 'recall': 0.7341494747978539, 'f1-score': 0.5108855700462769, 'support': 13233}, 'accuracy': 0.7359208585607536, 'macro avg': {'precision': 0.5732507984287745, 'recall': 0.69465703741928, 'f1-score': 0.6066283917150385, 'support': 122717}, 'weighted avg': {'precision': 0.8173054618201375, 'recall': 0.7359208585607536, 'f1-score': 0.7613492626978956, 'support': 122717}}
[[ 7945  2568  2865]
 [11237 72650 12219]
 [ 1032  2486  9715]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6087244
{'0': {'precision': 0.4714204121084311, 'recall': 0.5725109380002135, 'f1-score': 0.5170710551044504, 'support': 18742}, '1': {'precision': 0.8780615815255424, 'recall': 0.7638017418992321, 'f1-score': 0.8169559011344002, 'support': 85424}, '2': {'precision': 0.4890829694323144, 'recall': 0.6761899628052396, 'f1-score': 0.5676146519152017, 'support': 18551}, 'accuracy': 0.7213426012695877, 'macro avg': {'precision': 0.6128549876887627, 'recall': 0.670834214234895, 'f1-score': 0.6338805360513508, 'support': 122717}, 'weighted avg': {'precision': 0.7571556676736965, 'recall': 0.7213426012695877, 'f1-score': 0.7334632204254629, 'support': 122717}}
[[10730  4641  3371]
 [10444 65247  9733]
 [ 1587  4420 12544]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6727043
{'0': {'precision': 0.5053789533284802, 'recall': 0.5509457254971121, 'f1-score': 0.5271795304490898, 'support': 22681}, '1': {'precision': 0.819328494916866, 'recall': 0.7564912008883036, 'f1-score': 0.786656999771754, 'support': 77451}, '2': {'precision': 0.533761329305136, 'recall': 0.6258135930927606, 'f1-score': 0.5761337001936208, 'support': 22585}, 'accuracy': 0.6944514614927028, 'macro avg': {'precision': 0.6194895925168274, 'recall': 0.6444168398260587, 'f1-score': 0.6299900768048216, 'support': 122717}, 'weighted avg': {'precision': 0.7087470433811611, 'recall': 0.6944514614927028, 'f1-score': 0.6999544467214065, 'support': 122717}}
[[12496  6580  3605]
 [10119 58591  8741]
 [ 2111  6340 14134]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7893915
{'0': {'precision': 0.5418261548180906, 'recall': 0.5012203925882636, 'f1-score': 0.5207328833172613, 'support': 29089}, '1': {'precision': 0.7015612927679054, 'recall': 0.7468998804960191, 'f1-score': 0.7235210102984289, 'support': 64433}, '2': {'precision': 0.5835140200654148, 'recall': 0.5438602500428156, 'f1-score': 0.5629897528631707, 'support': 29195}, 'accuracy': 0.6403595263899867, 'macro avg': {'precision': 0.6089671558838036, 'recall': 0.5973268410423661, 'f1-score': 0.602414548826287, 'support': 122717}, 'weighted avg': {'precision': 0.6356134163174431, 'recall': 0.6403595263899867, 'f1-score': 0.6372606397990072, 'support': 122717}}
[[14580 10440  4069]
 [ 9044 48125  7264]
 [ 3285 10032 15878]]
training model: results/EXC/W3/deepLOB_L1/seq2seq
Epoch 1/50
1876/1876 - 60s - loss: 10.3622 - accuracy10: 0.5305 - accuracy20: 0.5485 - accuracy30: 0.5501 - accuracy50: 0.5405 - val_loss: 9.9790 - val_accuracy10: 0.6386 - val_accuracy20: 0.6289 - val_accuracy30: 0.6082 - val_accuracy50: 0.5670 - 60s/epoch - 32ms/step
Epoch 2/50
1876/1876 - 52s - loss: 9.5087 - accuracy10: 0.6062 - accuracy20: 0.6106 - accuracy30: 0.5988 - accuracy50: 0.5743 - val_loss: 9.2544 - val_accuracy10: 0.7083 - val_accuracy20: 0.6861 - val_accuracy30: 0.6556 - val_accuracy50: 0.6017 - 52s/epoch - 28ms/step
Epoch 3/50
1876/1876 - 52s - loss: 9.1672 - accuracy10: 0.6358 - accuracy20: 0.6307 - accuracy30: 0.6111 - accuracy50: 0.5799 - val_loss: 9.1116 - val_accuracy10: 0.7265 - val_accuracy20: 0.7003 - val_accuracy30: 0.6651 - val_accuracy50: 0.6045 - 52s/epoch - 28ms/step
Epoch 4/50
1876/1876 - 52s - loss: 8.9567 - accuracy10: 0.6535 - accuracy20: 0.6431 - accuracy30: 0.6200 - accuracy50: 0.5865 - val_loss: 9.3709 - val_accuracy10: 0.7386 - val_accuracy20: 0.7006 - val_accuracy30: 0.6608 - val_accuracy50: 0.5987 - 52s/epoch - 28ms/step
Epoch 5/50
1876/1876 - 51s - loss: 8.8259 - accuracy10: 0.6597 - accuracy20: 0.6481 - accuracy30: 0.6250 - accuracy50: 0.5902 - val_loss: 9.2589 - val_accuracy10: 0.7378 - val_accuracy20: 0.7035 - val_accuracy30: 0.6660 - val_accuracy50: 0.6057 - 51s/epoch - 27ms/step
Epoch 6/50
1876/1876 - 52s - loss: 8.7510 - accuracy10: 0.6630 - accuracy20: 0.6511 - accuracy30: 0.6278 - accuracy50: 0.5922 - val_loss: 9.0960 - val_accuracy10: 0.7278 - val_accuracy20: 0.6948 - val_accuracy30: 0.6568 - val_accuracy50: 0.6014 - 52s/epoch - 28ms/step
Epoch 7/50
1876/1876 - 51s - loss: 8.6947 - accuracy10: 0.6651 - accuracy20: 0.6540 - accuracy30: 0.6302 - accuracy50: 0.5944 - val_loss: 9.3097 - val_accuracy10: 0.7285 - val_accuracy20: 0.6959 - val_accuracy30: 0.6596 - val_accuracy50: 0.6028 - 51s/epoch - 27ms/step
Epoch 8/50
1876/1876 - 51s - loss: 8.6477 - accuracy10: 0.6669 - accuracy20: 0.6553 - accuracy30: 0.6315 - accuracy50: 0.5957 - val_loss: 9.4273 - val_accuracy10: 0.7216 - val_accuracy20: 0.6902 - val_accuracy30: 0.6550 - val_accuracy50: 0.5998 - 51s/epoch - 27ms/step
Epoch 9/50
1876/1876 - 51s - loss: 8.6152 - accuracy10: 0.6681 - accuracy20: 0.6563 - accuracy30: 0.6327 - accuracy50: 0.5971 - val_loss: 9.3007 - val_accuracy10: 0.7174 - val_accuracy20: 0.6889 - val_accuracy30: 0.6557 - val_accuracy50: 0.6021 - 51s/epoch - 27ms/step
Epoch 10/50
1876/1876 - 51s - loss: 8.5821 - accuracy10: 0.6698 - accuracy20: 0.6579 - accuracy30: 0.6343 - accuracy50: 0.5976 - val_loss: 9.5353 - val_accuracy10: 0.7115 - val_accuracy20: 0.6821 - val_accuracy30: 0.6482 - val_accuracy50: 0.5951 - 51s/epoch - 27ms/step
Epoch 11/50
1876/1876 - 56s - loss: 8.5639 - accuracy10: 0.6706 - accuracy20: 0.6581 - accuracy30: 0.6340 - accuracy50: 0.5982 - val_loss: 9.7021 - val_accuracy10: 0.7115 - val_accuracy20: 0.6792 - val_accuracy30: 0.6457 - val_accuracy50: 0.5926 - 56s/epoch - 30ms/step
Epoch 12/50
1876/1876 - 53s - loss: 8.5336 - accuracy10: 0.6716 - accuracy20: 0.6595 - accuracy30: 0.6353 - accuracy50: 0.5991 - val_loss: 9.4637 - val_accuracy10: 0.7233 - val_accuracy20: 0.6918 - val_accuracy30: 0.6554 - val_accuracy50: 0.6001 - 53s/epoch - 28ms/step
Epoch 13/50
1876/1876 - 52s - loss: 8.5142 - accuracy10: 0.6723 - accuracy20: 0.6598 - accuracy30: 0.6360 - accuracy50: 0.6000 - val_loss: 9.7197 - val_accuracy10: 0.7226 - val_accuracy20: 0.6885 - val_accuracy30: 0.6525 - val_accuracy50: 0.5981 - 52s/epoch - 28ms/step
Epoch 14/50
1876/1876 - 55s - loss: 8.4964 - accuracy10: 0.6732 - accuracy20: 0.6610 - accuracy30: 0.6365 - accuracy50: 0.6002 - val_loss: 9.5313 - val_accuracy10: 0.7260 - val_accuracy20: 0.6953 - val_accuracy30: 0.6595 - val_accuracy50: 0.6037 - 55s/epoch - 29ms/step
Epoch 15/50
1876/1876 - 52s - loss: 8.4754 - accuracy10: 0.6739 - accuracy20: 0.6614 - accuracy30: 0.6378 - accuracy50: 0.6017 - val_loss: 9.6107 - val_accuracy10: 0.7214 - val_accuracy20: 0.6912 - val_accuracy30: 0.6565 - val_accuracy50: 0.6005 - 52s/epoch - 28ms/step
Epoch 16/50
1876/1876 - 52s - loss: 8.4586 - accuracy10: 0.6744 - accuracy20: 0.6622 - accuracy30: 0.6381 - accuracy50: 0.6017 - val_loss: 9.4219 - val_accuracy10: 0.7260 - val_accuracy20: 0.6947 - val_accuracy30: 0.6588 - val_accuracy50: 0.6014 - 52s/epoch - 28ms/step
testing model: results/EXC/W3/deepLOB_L1/seq2seq
Evaluating performance on  test set...
5098/5098 - 70s - 70s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.75845057
{'0': {'precision': 0.3429705611668356, 'recall': 0.7683940596126743, 'f1-score': 0.47425756928950574, 'support': 153256}, '1': {'precision': 0.9389982139439944, 'recall': 0.5890761792238117, 'f1-score': 0.7239719252429985, 'support': 999577}, '2': {'precision': 0.32211376037073025, 'recall': 0.7084456660397954, 'f1-score': 0.4428664503147653, 'support': 152078}, 'accuracy': 0.6240479235748645, 'macro avg': {'precision': 0.5346941784938534, 'recall': 0.6886386349587604, 'f1-score': 0.5470319816157565, 'support': 1304911}, 'weighted avg': {'precision': 0.7971039637732694, 'recall': 0.6240479235748645, 'f1-score': 0.6618832603822192, 'support': 1304911}}
[[117761  20648  14847]
 [198861 588827 211889]
 [ 26734  17605 107739]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.77097183
{'0': {'precision': 0.4108322048149535, 'recall': 0.746157249489774, 'f1-score': 0.5299018531344494, 'support': 210201}, '1': {'precision': 0.8872792231105351, 'recall': 0.570925006874107, 'f1-score': 0.6947859375760688, 'support': 887388}, '2': {'precision': 0.39667241237324186, 'recall': 0.6737683410347189, 'f1-score': 0.49935563900770197, 'support': 207322}, 'accuracy': 0.6154917844971802, 'macro avg': {'precision': 0.5649279467662435, 'recall': 0.6636168657995333, 'f1-score': 0.5746811432394067, 'support': 1304911}, 'weighted avg': {'precision': 0.7325842094977856, 'recall': 0.6154917844971802, 'f1-score': 0.6371760317713788, 'support': 1304911}}
[[156843  34052  19306]
 [187602 506632 193154]
 [ 37324  30311 139687]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.80462885
{'0': {'precision': 0.44134701536692983, 'recall': 0.7247314215917608, 'f1-score': 0.5486046902580483, 'support': 252161}, '1': {'precision': 0.8334389400921659, 'recall': 0.539338114692989, 'f1-score': 0.6548847609219126, 'support': 804792}, '2': {'precision': 0.4332450545886931, 'recall': 0.6465530452737964, 'f1-score': 0.5188301580264014, 'support': 247958}, 'accuracy': 0.5955364005667819, 'macro avg': {'precision': 0.5693436700159297, 'recall': 0.6368741938528487, 'f1-score': 0.5741065364021207, 'support': 1304911}, 'weighted avg': {'precision': 0.6816266193344205, 'recall': 0.5955364005667819, 'f1-score': 0.6084942284461837, 'support': 1304911}}
[[182749  45534  23878]
 [184893 434055 185844]
 [ 46429  41211 160318]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8741038
{'0': {'precision': 0.48032036871773437, 'recall': 0.6689394988232037, 'f1-score': 0.5591516345421718, 'support': 317812}, '1': {'precision': 0.7156696623570646, 'recall': 0.5024056835755806, 'f1-score': 0.5903682512439392, 'support': 675068}, '2': {'precision': 0.4734585844750034, 'recall': 0.5893260605516759, 'f1-score': 0.5250762395349102, 'support': 312031}, 'accuracy': 0.5637495583990019, 'macro avg': {'precision': 0.5564828718499342, 'recall': 0.58689041431682, 'f1-score': 0.5581987084403404, 'support': 1304911}, 'weighted avg': {'precision': 0.600432535416821, 'recall': 0.5637495583990019, 'f1-score': 0.5671527621471332, 'support': 1304911}}
[[212597  69292  35923]
 [167328 339158 168582]
 [ 62690  65453 183888]]
Evaluating performance on  train set...
1876/1876 - 26s - 26s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.65991586
{'0': {'precision': 0.3702049248980959, 'recall': 0.703398521766807, 'f1-score': 0.48509828788839565, 'support': 56554}, '1': {'precision': 0.9169686269763866, 'recall': 0.7035105206384751, 'f1-score': 0.7961806569653251, 'support': 366185}, '2': {'precision': 0.3790613325200684, 'recall': 0.605589197466416, 'f1-score': 0.46626786085115784, 'support': 57468}, 'accuracy': 0.6917787537457805, 'macro avg': {'precision': 0.555411628131517, 'recall': 0.6708327466238995, 'f1-score': 0.5825156019016262, 'support': 480207}, 'weighted avg': {'precision': 0.7882030512868374, 'recall': 0.6917787537457805, 'f1-score': 0.720062689364133, 'support': 480207}}
[[ 39780  10962   5812]
 [ 57373 257615  51197]
 [ 10301  12365  34802]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7028755
{'0': {'precision': 0.42903908016173337, 'recall': 0.6884898447455335, 'f1-score': 0.5286468083406967, 'support': 76906}, '1': {'precision': 0.8623438848531056, 'recall': 0.6862539769559848, 'f1-score': 0.764287404856397, 'support': 324683}, '2': {'precision': 0.4585869465811749, 'recall': 0.5740415680887329, 'f1-score': 0.5098599664461755, 'support': 78618}, 'accuracy': 0.6682409877407035, 'macro avg': {'precision': 0.5833233038653379, 'recall': 0.6495951299300837, 'f1-score': 0.600931393214423, 'support': 480207}, 'weighted avg': {'precision': 0.7268475212377121, 'recall': 0.6682409877407035, 'f1-score': 0.6848950759886977, 'support': 480207}}
[[ 52949  16337   7620]
 [ 56207 222815  45661]
 [ 14257  19231  45130]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.75747716
{'0': {'precision': 0.45091820553481, 'recall': 0.6744674106703684, 'f1-score': 0.5404896421845574, 'support': 91487}, '1': {'precision': 0.810747378559922, 'recall': 0.6532662294748615, 'f1-score': 0.7235368307258041, 'support': 295065}, '2': {'precision': 0.4885572798803178, 'recall': 0.5509369494421014, 'f1-score': 0.5178754240520305, 'support': 93655}, 'accuracy': 0.6373480603156555, 'macro avg': {'precision': 0.5834076213250166, 'recall': 0.6262235298624438, 'f1-score': 0.5939672989874639, 'support': 480207}, 'weighted avg': {'precision': 0.6793573629116978, 'recall': 0.6373480603156555, 'f1-score': 0.648553214951554, 'support': 480207}}
[[ 61705  20850   8932]
 [ 57226 192756  45083]
 [ 17912  24145  51598]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.84581834
{'0': {'precision': 0.4804883775534163, 'recall': 0.6258596132504959, 'f1-score': 0.5436232951052348, 'support': 114441}, '1': {'precision': 0.7027668128989715, 'recall': 0.6160002890022598, 'f1-score': 0.6565292070493062, 'support': 249133}, '2': {'precision': 0.5221960130533485, 'recall': 0.5048914115216105, 'f1-score': 0.5133979363647063, 'support': 116633}, 'accuracy': 0.5913637243938551, 'macro avg': {'precision': 0.5684837345019121, 'recall': 0.5822504379247887, 'f1-score': 0.5711834795064158, 'support': 480207}, 'weighted avg': {'precision': 0.6059371529444618, 'recall': 0.5913637243938551, 'f1-score': 0.594858104873477, 'support': 480207}}
[[ 71624  30720  12097]
 [ 53883 153466  41784]
 [ 23558  34188  58887]]
Evaluating performance on  val set...
619/619 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5948358
{'0': {'precision': 0.356, 'recall': 0.7287559895675381, 'f1-score': 0.47833270298783764, 'support': 16487}, '1': {'precision': 0.9146260947239645, 'recall': 0.753113957244048, 'f1-score': 0.8260492116662868, 'support': 125082}, '2': {'precision': 0.4063251340854448, 'recall': 0.5230018449086473, 'f1-score': 0.45733912726705006, 'support': 16803}, 'accuracy': 0.7261637158083499, 'macro avg': {'precision': 0.5589837429364698, 'recall': 0.6682905972400778, 'f1-score': 0.5872403473070582, 'support': 158372}, 'weighted avg': {'precision': 0.8025415755834405, 'recall': 0.7261637158083499, 'f1-score': 0.7507313674340869, 'support': 158372}}
[[12015  3420  1052]
 [19093 94201 11788]
 [ 2642  5373  8788]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6554443
{'0': {'precision': 0.4187707346721706, 'recall': 0.7189252641189513, 'f1-score': 0.5292536166944053, 'support': 23001}, '1': {'precision': 0.8579341805148257, 'recall': 0.7301719356627843, 'f1-score': 0.7889138576779026, 'support': 111786}, '2': {'precision': 0.4931777983660406, 'recall': 0.4965444138223447, 'f1-score': 0.49485538019479836, 'support': 23585}, 'accuracy': 0.693746369307706, 'macro avg': {'precision': 0.5899609045176789, 'recall': 0.6485472045346935, 'f1-score': 0.6043409515223688, 'support': 158372}, 'weighted avg': {'precision': 0.7398326367393729, 'recall': 0.693746369307706, 'f1-score': 0.7074107233214479, 'support': 158372}}
[[16536  5114  1351]
 [19479 81623 10684]
 [ 3472  8402 11711]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7236377
{'0': {'precision': 0.4430405497039013, 'recall': 0.7022679230410949, 'f1-score': 0.5433176721688634, 'support': 27911}, '1': {'precision': 0.8020391498627714, 'recall': 0.6951568351829825, 'f1-score': 0.7447829177746768, 'support': 101731}, '2': {'precision': 0.5314378178455849, 'recall': 0.4801253045596937, 'f1-score': 0.5044801228833705, 'support': 28730}, 'accuracy': 0.6574015608819741, 'macro avg': {'precision': 0.5921725058040859, 'recall': 0.6258500209279236, 'f1-score': 0.5975269042756369, 'support': 158372}, 'weighted avg': {'precision': 0.6896809918683785, 'recall': 0.6574015608819741, 'f1-score': 0.6656843664693255, 'support': 158372}}
[[19601  6746  1564]
 [20414 70719 10598]
 [ 4227 10709 13794]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.82940173
{'0': {'precision': 0.4786247268829616, 'recall': 0.6459509833922163, 'f1-score': 0.5498395709262263, 'support': 35947}, '1': {'precision': 0.6866005873715125, 'recall': 0.656253289512158, 'f1-score': 0.6710840275327565, 'support': 85499}, '2': {'precision': 0.5680218921032056, 'recall': 0.43283865027352003, 'f1-score': 0.49130087298659786, 'support': 36926}, 'accuracy': 0.6018235546687546, 'macro avg': {'precision': 0.5777490687858933, 'recall': 0.5783476410592981, 'f1-score': 0.5707414904818603, 'support': 158372}, 'weighted avg': {'precision': 0.6117467927710816, 'recall': 0.6018235546687546, 'f1-score': 0.6016459498018041, 'support': 158372}}
[[23220 10546  2181]
 [19416 56109  9974]
 [ 5878 15065 15983]]
training model: results/EXC/W3/deepOF_L1/seq2seq
Epoch 1/50
1876/1876 - 58s - loss: 12.1973 - accuracy10: 0.4281 - accuracy20: 0.4486 - accuracy30: 0.4564 - accuracy50: 0.4572 - val_loss: 11.9484 - val_accuracy10: 0.6269 - val_accuracy20: 0.6047 - val_accuracy30: 0.5793 - val_accuracy50: 0.5228 - 58s/epoch - 31ms/step
Epoch 2/50
1876/1876 - 49s - loss: 11.9029 - accuracy10: 0.4428 - accuracy20: 0.4629 - accuracy30: 0.4731 - accuracy50: 0.4757 - val_loss: 11.4933 - val_accuracy10: 0.6786 - val_accuracy20: 0.6467 - val_accuracy30: 0.6166 - val_accuracy50: 0.5534 - 49s/epoch - 26ms/step
Epoch 3/50
1876/1876 - 50s - loss: 11.6740 - accuracy10: 0.4608 - accuracy20: 0.4741 - accuracy30: 0.4821 - accuracy50: 0.4842 - val_loss: 11.3129 - val_accuracy10: 0.6811 - val_accuracy20: 0.6463 - val_accuracy30: 0.6166 - val_accuracy50: 0.5560 - 50s/epoch - 27ms/step
Epoch 4/50
1876/1876 - 50s - loss: 11.4922 - accuracy10: 0.4843 - accuracy20: 0.4906 - accuracy30: 0.4935 - accuracy50: 0.4924 - val_loss: 11.0890 - val_accuracy10: 0.6823 - val_accuracy20: 0.6506 - val_accuracy30: 0.6233 - val_accuracy50: 0.5643 - 50s/epoch - 27ms/step
Epoch 5/50
1876/1876 - 51s - loss: 11.3548 - accuracy10: 0.4980 - accuracy20: 0.5027 - accuracy30: 0.5026 - accuracy50: 0.4983 - val_loss: 10.9952 - val_accuracy10: 0.6664 - val_accuracy20: 0.6389 - val_accuracy30: 0.6148 - val_accuracy50: 0.5621 - 51s/epoch - 27ms/step
Epoch 6/50
1876/1876 - 50s - loss: 11.2309 - accuracy10: 0.5099 - accuracy20: 0.5139 - accuracy30: 0.5114 - accuracy50: 0.5042 - val_loss: 10.8694 - val_accuracy10: 0.6663 - val_accuracy20: 0.6390 - val_accuracy30: 0.6163 - val_accuracy50: 0.5639 - 50s/epoch - 27ms/step
Epoch 7/50
1876/1876 - 49s - loss: 11.1289 - accuracy10: 0.5184 - accuracy20: 0.5207 - accuracy30: 0.5164 - accuracy50: 0.5071 - val_loss: 10.7452 - val_accuracy10: 0.6630 - val_accuracy20: 0.6369 - val_accuracy30: 0.6135 - val_accuracy50: 0.5627 - 49s/epoch - 26ms/step
Epoch 8/50
1876/1876 - 51s - loss: 11.0409 - accuracy10: 0.5242 - accuracy20: 0.5261 - accuracy30: 0.5200 - accuracy50: 0.5097 - val_loss: 10.5985 - val_accuracy10: 0.6644 - val_accuracy20: 0.6396 - val_accuracy30: 0.6160 - val_accuracy50: 0.5671 - 51s/epoch - 27ms/step
Epoch 9/50
1876/1876 - 50s - loss: 10.9557 - accuracy10: 0.5300 - accuracy20: 0.5319 - accuracy30: 0.5248 - accuracy50: 0.5131 - val_loss: 10.5482 - val_accuracy10: 0.6615 - val_accuracy20: 0.6374 - val_accuracy30: 0.6146 - val_accuracy50: 0.5674 - 50s/epoch - 27ms/step
Epoch 10/50
1876/1876 - 50s - loss: 10.8868 - accuracy10: 0.5331 - accuracy20: 0.5355 - accuracy30: 0.5285 - accuracy50: 0.5155 - val_loss: 10.4986 - val_accuracy10: 0.6705 - val_accuracy20: 0.6441 - val_accuracy30: 0.6199 - val_accuracy50: 0.5718 - 50s/epoch - 27ms/step
Epoch 11/50
1876/1876 - 48s - loss: 10.8247 - accuracy10: 0.5372 - accuracy20: 0.5394 - accuracy30: 0.5316 - accuracy50: 0.5180 - val_loss: 10.4546 - val_accuracy10: 0.6573 - val_accuracy20: 0.6358 - val_accuracy30: 0.6146 - val_accuracy50: 0.5695 - 48s/epoch - 26ms/step
Epoch 12/50
1876/1876 - 48s - loss: 10.7633 - accuracy10: 0.5406 - accuracy20: 0.5440 - accuracy30: 0.5357 - accuracy50: 0.5213 - val_loss: 10.4245 - val_accuracy10: 0.6492 - val_accuracy20: 0.6296 - val_accuracy30: 0.6094 - val_accuracy50: 0.5674 - 48s/epoch - 26ms/step
Epoch 13/50
1876/1876 - 48s - loss: 10.7016 - accuracy10: 0.5444 - accuracy20: 0.5480 - accuracy30: 0.5398 - accuracy50: 0.5249 - val_loss: 10.3950 - val_accuracy10: 0.6481 - val_accuracy20: 0.6295 - val_accuracy30: 0.6106 - val_accuracy50: 0.5697 - 48s/epoch - 26ms/step
Epoch 14/50
1876/1876 - 48s - loss: 10.6493 - accuracy10: 0.5474 - accuracy20: 0.5510 - accuracy30: 0.5431 - accuracy50: 0.5276 - val_loss: 10.3727 - val_accuracy10: 0.6448 - val_accuracy20: 0.6265 - val_accuracy30: 0.6070 - val_accuracy50: 0.5667 - 48s/epoch - 25ms/step
Epoch 15/50
1876/1876 - 48s - loss: 10.6026 - accuracy10: 0.5502 - accuracy20: 0.5541 - accuracy30: 0.5456 - accuracy50: 0.5302 - val_loss: 10.3316 - val_accuracy10: 0.6449 - val_accuracy20: 0.6286 - val_accuracy30: 0.6080 - val_accuracy50: 0.5689 - 48s/epoch - 26ms/step
Epoch 16/50
1876/1876 - 48s - loss: 10.5645 - accuracy10: 0.5521 - accuracy20: 0.5569 - accuracy30: 0.5483 - accuracy50: 0.5319 - val_loss: 10.2911 - val_accuracy10: 0.6353 - val_accuracy20: 0.6198 - val_accuracy30: 0.6014 - val_accuracy50: 0.5658 - 48s/epoch - 25ms/step
Epoch 17/50
1876/1876 - 48s - loss: 10.5122 - accuracy10: 0.5550 - accuracy20: 0.5593 - accuracy30: 0.5509 - accuracy50: 0.5344 - val_loss: 10.2991 - val_accuracy10: 0.6430 - val_accuracy20: 0.6244 - val_accuracy30: 0.6057 - val_accuracy50: 0.5678 - 48s/epoch - 26ms/step
Epoch 18/50
1876/1876 - 49s - loss: 10.4697 - accuracy10: 0.5575 - accuracy20: 0.5623 - accuracy30: 0.5534 - accuracy50: 0.5370 - val_loss: 10.2734 - val_accuracy10: 0.6452 - val_accuracy20: 0.6270 - val_accuracy30: 0.6076 - val_accuracy50: 0.5701 - 49s/epoch - 26ms/step
Epoch 19/50
1876/1876 - 50s - loss: 10.4216 - accuracy10: 0.5604 - accuracy20: 0.5652 - accuracy30: 0.5560 - accuracy50: 0.5382 - val_loss: 10.2159 - val_accuracy10: 0.6313 - val_accuracy20: 0.6170 - val_accuracy30: 0.5986 - val_accuracy50: 0.5655 - 50s/epoch - 27ms/step
Epoch 20/50
1876/1876 - 48s - loss: 10.3840 - accuracy10: 0.5624 - accuracy20: 0.5669 - accuracy30: 0.5578 - accuracy50: 0.5409 - val_loss: 10.2443 - val_accuracy10: 0.6349 - val_accuracy20: 0.6202 - val_accuracy30: 0.6011 - val_accuracy50: 0.5653 - 48s/epoch - 26ms/step
Epoch 21/50
1876/1876 - 49s - loss: 10.3454 - accuracy10: 0.5649 - accuracy20: 0.5695 - accuracy30: 0.5597 - accuracy50: 0.5426 - val_loss: 10.1997 - val_accuracy10: 0.6276 - val_accuracy20: 0.6143 - val_accuracy30: 0.5964 - val_accuracy50: 0.5636 - 49s/epoch - 26ms/step
Epoch 22/50
1876/1876 - 48s - loss: 10.3088 - accuracy10: 0.5671 - accuracy20: 0.5707 - accuracy30: 0.5608 - accuracy50: 0.5435 - val_loss: 10.1948 - val_accuracy10: 0.6361 - val_accuracy20: 0.6206 - val_accuracy30: 0.6021 - val_accuracy50: 0.5659 - 48s/epoch - 26ms/step
Epoch 23/50
1876/1876 - 48s - loss: 10.2783 - accuracy10: 0.5685 - accuracy20: 0.5725 - accuracy30: 0.5633 - accuracy50: 0.5456 - val_loss: 10.2307 - val_accuracy10: 0.6283 - val_accuracy20: 0.6146 - val_accuracy30: 0.5967 - val_accuracy50: 0.5631 - 48s/epoch - 26ms/step
Epoch 24/50
1876/1876 - 48s - loss: 10.2513 - accuracy10: 0.5698 - accuracy20: 0.5740 - accuracy30: 0.5641 - accuracy50: 0.5466 - val_loss: 10.2073 - val_accuracy10: 0.6322 - val_accuracy20: 0.6173 - val_accuracy30: 0.5984 - val_accuracy50: 0.5650 - 48s/epoch - 26ms/step
Epoch 25/50
1876/1876 - 48s - loss: 10.2136 - accuracy10: 0.5707 - accuracy20: 0.5757 - accuracy30: 0.5661 - accuracy50: 0.5485 - val_loss: 10.2353 - val_accuracy10: 0.6345 - val_accuracy20: 0.6213 - val_accuracy30: 0.6017 - val_accuracy50: 0.5660 - 48s/epoch - 26ms/step
Epoch 26/50
1876/1876 - 48s - loss: 10.1779 - accuracy10: 0.5731 - accuracy20: 0.5779 - accuracy30: 0.5678 - accuracy50: 0.5496 - val_loss: 10.2244 - val_accuracy10: 0.6277 - val_accuracy20: 0.6140 - val_accuracy30: 0.5950 - val_accuracy50: 0.5627 - 48s/epoch - 25ms/step
Epoch 27/50
1876/1876 - 48s - loss: 10.1435 - accuracy10: 0.5757 - accuracy20: 0.5799 - accuracy30: 0.5694 - accuracy50: 0.5514 - val_loss: 10.2348 - val_accuracy10: 0.6360 - val_accuracy20: 0.6221 - val_accuracy30: 0.6009 - val_accuracy50: 0.5654 - 48s/epoch - 26ms/step
Epoch 28/50
1876/1876 - 48s - loss: 10.1135 - accuracy10: 0.5765 - accuracy20: 0.5813 - accuracy30: 0.5710 - accuracy50: 0.5526 - val_loss: 10.2567 - val_accuracy10: 0.6328 - val_accuracy20: 0.6204 - val_accuracy30: 0.6004 - val_accuracy50: 0.5629 - 48s/epoch - 25ms/step
Epoch 29/50
1876/1876 - 49s - loss: 10.0932 - accuracy10: 0.5775 - accuracy20: 0.5820 - accuracy30: 0.5719 - accuracy50: 0.5531 - val_loss: 10.2236 - val_accuracy10: 0.6307 - val_accuracy20: 0.6170 - val_accuracy30: 0.5987 - val_accuracy50: 0.5643 - 49s/epoch - 26ms/step
Epoch 30/50
1876/1876 - 47s - loss: 10.0589 - accuracy10: 0.5789 - accuracy20: 0.5835 - accuracy30: 0.5739 - accuracy50: 0.5555 - val_loss: 10.2561 - val_accuracy10: 0.6323 - val_accuracy20: 0.6188 - val_accuracy30: 0.5991 - val_accuracy50: 0.5631 - 47s/epoch - 25ms/step
Epoch 31/50
1876/1876 - 48s - loss: 10.0202 - accuracy10: 0.5798 - accuracy20: 0.5848 - accuracy30: 0.5752 - accuracy50: 0.5559 - val_loss: 10.2381 - val_accuracy10: 0.6346 - val_accuracy20: 0.6196 - val_accuracy30: 0.5988 - val_accuracy50: 0.5635 - 48s/epoch - 26ms/step
Epoch 32/50
1876/1876 - 48s - loss: 10.0072 - accuracy10: 0.5818 - accuracy20: 0.5857 - accuracy30: 0.5763 - accuracy50: 0.5569 - val_loss: 10.3358 - val_accuracy10: 0.6464 - val_accuracy20: 0.6289 - val_accuracy30: 0.6058 - val_accuracy50: 0.5667 - 48s/epoch - 26ms/step
testing model: results/EXC/W3/deepOF_L1/seq2seq
Evaluating performance on  test set...
5098/5098 - 66s - 66s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7812588
{'0': {'precision': 0.28963576547186337, 'recall': 0.5480277968092395, 'f1-score': 0.3789790020147417, 'support': 153255}, '1': {'precision': 0.8739381499726327, 'recall': 0.6389442734276599, 'f1-score': 0.7381905792783885, 'support': 999577}, '2': {'precision': 0.28131940069475486, 'recall': 0.5256024987670558, 'f1-score': 0.36648448890885926, 'support': 152075}, 'accuracy': 0.6150576247962498, 'macro avg': {'precision': 0.48163110537975035, 'recall': 0.5708581896679851, 'f1-score': 0.49455135673399647, 'support': 1304907}, 'weighted avg': {'precision': 0.7362503620819258, 'recall': 0.6150576247962498, 'f1-score': 0.6526839692544663, 'support': 1304907}}
[[ 83988  43737  25530]
 [182235 638674 178668]
 [ 23755  48389  79931]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.83240044
{'0': {'precision': 0.36485141105811464, 'recall': 0.53349445049691, 'f1-score': 0.433343573751297, 'support': 210199}, '1': {'precision': 0.8139004463217011, 'recall': 0.6245121914114136, 'f1-score': 0.7067384392897723, 'support': 887387}, '2': {'precision': 0.34702984367598294, 'recall': 0.5300331370194047, 'f1-score': 0.4194392437749418, 'support': 207321}, 'accuracy': 0.5948400920525371, 'macro avg': {'precision': 0.5085939003519329, 'recall': 0.5626799263092428, 'f1-score': 0.5198404189386704, 'support': 1304907}, 'weighted avg': {'precision': 0.6673905890104265, 'recall': 0.5948400920525371, 'f1-score': 0.6170535162610414, 'support': 1304907}}
[[112140  61300  36759]
 [163199 554184 170004]
 [ 32019  65415 109887]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8776318
{'0': {'precision': 0.4081572028113465, 'recall': 0.5121906725888324, 'f1-score': 0.45429411599178315, 'support': 252160}, '1': {'precision': 0.7574265575884209, 'recall': 0.6116805481174615, 'f1-score': 0.6767959788880624, 'support': 804791}, '2': {'precision': 0.38193262914126375, 'recall': 0.5214675184306893, 'f1-score': 0.440924126172208, 'support': 247956}, 'accuracy': 0.5753130299707182, 'macro avg': {'precision': 0.515838796513677, 'recall': 0.5484462463789944, 'f1-score': 0.5240047403506846, 'support': 1304907}, 'weighted avg': {'precision': 0.6185831511060966, 'recall': 0.5753130299707182, 'f1-score': 0.5889798273462757, 'support': 1304907}}
[[129154  77333  45673]
 [148946 492275 163570]
 [ 38332  80323 129301]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9431737
{'0': {'precision': 0.45689834778052063, 'recall': 0.455424765033306, 'f1-score': 0.4561603663427341, 'support': 317811}, '1': {'precision': 0.6448786519937603, 'recall': 0.6056500974716621, 'f1-score': 0.6246490832048072, 'support': 675068}, '2': {'precision': 0.4237457570640295, 'recall': 0.4809055597574577, 'f1-score': 0.4505198560075419, 'support': 312028}, 'accuracy': 0.5392338304568831, 'macro avg': {'precision': 0.5085075856127701, 'recall': 0.5139934740874752, 'f1-score': 0.5104431018516944, 'support': 1304907}, 'weighted avg': {'precision': 0.5462188521754989, 'recall': 0.5392338304568831, 'f1-score': 0.541975940905348, 'support': 1304907}}
[[144739 112471  60601]
 [122752 408855 143461]
 [ 49295 112677 150056]]
Evaluating performance on  train set...
1876/1876 - 26s - 26s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.75129634
{'0': {'precision': 0.2963704902502566, 'recall': 0.530937312166319, 'f1-score': 0.38040050157692745, 'support': 56566}, '1': {'precision': 0.8734613206764599, 'recall': 0.6616632970875909, 'f1-score': 0.7529516374495365, 'support': 366020}, '2': {'precision': 0.3053778468927777, 'recall': 0.538485568996338, 'f1-score': 0.3897350223902626, 'support': 57619}, 'accuracy': 0.6314844701741964, 'macro avg': {'precision': 0.49173655260649807, 'recall': 0.5770287260834159, 'f1-score': 0.5076957204722422, 'support': 480205}, 'weighted avg': {'precision': 0.7373192113901538, 'recall': 0.6314844701741964, 'f1-score': 0.6654850227852362, 'support': 480205}}
[[ 30033  17251   9282]
 [ 62545 242182  61293]
 [  8758  17834  31027]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7971171
{'0': {'precision': 0.3683324546556046, 'recall': 0.5180901580693423, 'f1-score': 0.4305608113221827, 'support': 76865}, '1': {'precision': 0.8142453177206266, 'recall': 0.6546672828096118, 'f1-score': 0.7257882729036312, 'support': 324600}, '2': {'precision': 0.3817594326036866, 'recall': 0.5386715773431547, 'f1-score': 0.44684056383135623, 'support': 78740}, 'accuracy': 0.6137857789902229, 'macro avg': {'precision': 0.5214457349933059, 'recall': 0.5704763394073696, 'f1-score': 0.53439654935239, 'support': 480205}, 'weighted avg': {'precision': 0.6719539404679934, 'recall': 0.6137857789902229, 'f1-score': 0.6327925701375022, 'support': 480205}}
[[ 39823  24124  12918]
 [ 56324 212505  55771]
 [ 11970  24355  42415]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.84126043
{'0': {'precision': 0.40808199853574045, 'recall': 0.4998851618124747, 'f1-score': 0.4493425418438322, 'support': 91433}, '1': {'precision': 0.7588957569324454, 'recall': 0.644591319673937, 'f1-score': 0.6970888804175709, 'support': 295035}, '2': {'precision': 0.4198085131710967, 'recall': 0.5267077034682143, 'f1-score': 0.46722153087634793, 'support': 93737}, 'accuracy': 0.5940275507335409, 'macro avg': {'precision': 0.5289287562130942, 'recall': 0.5570613949848754, 'f1-score': 0.5378843177125837, 'support': 480205}, 'weighted avg': {'precision': 0.6259088547970169, 'recall': 0.5940275507335409, 'f1-score': 0.6050463845694263, 'support': 480205}}
[[ 45706  30290  15437]
 [ 52061 190177  52797]
 [ 14235  30130  49372]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9099646
{'0': {'precision': 0.4571936628213491, 'recall': 0.44747728286441435, 'f1-score': 0.45228329473330625, 'support': 114341}, '1': {'precision': 0.6503030106094332, 'recall': 0.642561867379456, 'f1-score': 0.646409263603293, 'support': 249162}, '2': {'precision': 0.4667971629346918, 'recall': 0.4883806618566948, 'f1-score': 0.47734505862646565, 'support': 116702}, 'accuracy': 0.558640580585375, 'macro avg': {'precision': 0.5247646121218247, 'recall': 0.526139937366855, 'f1-score': 0.5253458723210216, 'support': 480205}, 'weighted avg': {'precision': 0.5597254127693961, 'recall': 0.558640580585375, 'f1-score': 0.5590992850404524, 'support': 480205}}
[[ 51165  44007  19169]
 [ 43126 160102  45934]
 [ 17620  42087  56995]]
Evaluating performance on  val set...
619/619 - 8s - 8s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7356935
{'0': {'precision': 0.2848441842587665, 'recall': 0.5855823000243131, 'f1-score': 0.38325973664319535, 'support': 16452}, '1': {'precision': 0.9035386661005397, 'recall': 0.6464000511594817, 'f1-score': 0.7536393968200712, 'support': 125099}, '2': {'precision': 0.29215758993524094, 'recall': 0.6088223054515189, 'f1-score': 0.3948413463392066, 'support': 16821}, 'accuracy': 0.6360909756775187, 'macro avg': {'precision': 0.49351348009818236, 'recall': 0.6136015522117713, 'f1-score': 0.5105801599341577, 'support': 158372}, 'weighted avg': {'precision': 0.7743314659803332, 'recall': 0.6360909756775187, 'f1-score': 0.6770549742177893, 'support': 158372}}
[[ 9634  4260  2558]
 [21981 80864 22254]
 [ 2207  4373 10241]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7808146
{'0': {'precision': 0.35982120685373725, 'recall': 0.5669014084507042, 'f1-score': 0.4402248215099499, 'support': 23004}, '1': {'precision': 0.8483628524125445, 'recall': 0.6372550773910709, 'f1-score': 0.7278096532415047, 'support': 111770}, '2': {'precision': 0.3693545006811275, 'recall': 0.5974658869395711, 'f1-score': 0.4564999190545572, 'support': 23598}, 'accuracy': 0.6211072664359861, 'macro avg': {'precision': 0.5258461866491365, 'recall': 0.6005407909271154, 'f1-score': 0.541511464602004, 'support': 158372}, 'weighted avg': {'precision': 0.7060267633400267, 'recall': 0.6211072664359861, 'f1-score': 0.6456109781190319, 'support': 158372}}
[[13041  6326  3637]
 [20108 71226 20436]
 [ 3094  6405 14099]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8291273
{'0': {'precision': 0.4020958561625618, 'recall': 0.540913807291853, 'f1-score': 0.461287320548614, 'support': 27949}, '1': {'precision': 0.7912621359223301, 'recall': 0.6252581882561228, 'f1-score': 0.6985330476347454, 'support': 101670}, '2': {'precision': 0.41034772716031065, 'recall': 0.5770528292699892, 'f1-score': 0.4796276757194271, 'support': 28753}, 'accuracy': 0.601621498749779, 'macro avg': {'precision': 0.5345685730817341, 'recall': 0.5810749416059884, 'f1-score': 0.5464826813009288, 'support': 158372}, 'weighted avg': {'precision': 0.6534269103260119, 'recall': 0.601621498749779, 'f1-score': 0.6169216075758245, 'support': 158372}}
[[15118  8410  4421]
 [18679 63570 19421]
 [ 3801  8360 16592]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.90108573
{'0': {'precision': 0.45444665341285617, 'recall': 0.4764339706536238, 'f1-score': 0.46518064279803006, 'support': 35984}, '1': {'precision': 0.67590862285954, 'recall': 0.6221507137842265, 'f1-score': 0.6479165016481541, 'support': 85460}, '2': {'precision': 0.4613185975609756, 'recall': 0.5244800693240901, 'f1-score': 0.4908759124087591, 'support': 36928}, 'accuracy': 0.5662680271765211, 'macro avg': {'precision': 0.5305579579444574, 'recall': 0.5410215845873134, 'f1-score': 0.5346576856183144, 'support': 158372}, 'weighted avg': {'precision': 0.5755533330179338, 'recall': 0.5662680271765211, 'f1-score': 0.5697791918693091, 'support': 158372}}
[[17144 13094  5746]
 [15421 53169 16870]
 [ 5160 12400 19368]]
training model: results/EXC/W3/deepLOB_L2/seq2seq
Epoch 1/50
1876/1876 - 105s - loss: 10.3223 - accuracy10: 0.5426 - accuracy20: 0.5536 - accuracy30: 0.5499 - accuracy50: 0.5356 - val_loss: 9.4555 - val_accuracy10: 0.6179 - val_accuracy20: 0.6109 - val_accuracy30: 0.5963 - val_accuracy50: 0.5644 - 105s/epoch - 56ms/step
Epoch 2/50
1876/1876 - 100s - loss: 9.1185 - accuracy10: 0.6444 - accuracy20: 0.6397 - accuracy30: 0.6201 - accuracy50: 0.5868 - val_loss: 9.1131 - val_accuracy10: 0.6908 - val_accuracy20: 0.6769 - val_accuracy30: 0.6506 - val_accuracy50: 0.6004 - 100s/epoch - 53ms/step
Epoch 3/50
1876/1876 - 99s - loss: 8.8128 - accuracy10: 0.6590 - accuracy20: 0.6513 - accuracy30: 0.6297 - accuracy50: 0.5959 - val_loss: 8.7292 - val_accuracy10: 0.6887 - val_accuracy20: 0.6793 - val_accuracy30: 0.6540 - val_accuracy50: 0.6066 - 99s/epoch - 53ms/step
Epoch 4/50
1876/1876 - 98s - loss: 8.6642 - accuracy10: 0.6655 - accuracy20: 0.6557 - accuracy30: 0.6331 - accuracy50: 0.5991 - val_loss: 8.6418 - val_accuracy10: 0.6904 - val_accuracy20: 0.6771 - val_accuracy30: 0.6521 - val_accuracy50: 0.6074 - 98s/epoch - 52ms/step
Epoch 5/50
1876/1876 - 97s - loss: 8.5739 - accuracy10: 0.6693 - accuracy20: 0.6586 - accuracy30: 0.6354 - accuracy50: 0.6015 - val_loss: 8.6880 - val_accuracy10: 0.6998 - val_accuracy20: 0.6825 - val_accuracy30: 0.6552 - val_accuracy50: 0.6085 - 97s/epoch - 52ms/step
Epoch 6/50
1876/1876 - 97s - loss: 8.5070 - accuracy10: 0.6722 - accuracy20: 0.6609 - accuracy30: 0.6378 - accuracy50: 0.6033 - val_loss: 8.5842 - val_accuracy10: 0.6861 - val_accuracy20: 0.6713 - val_accuracy30: 0.6457 - val_accuracy50: 0.6048 - 97s/epoch - 51ms/step
Epoch 7/50
1876/1876 - 96s - loss: 8.4524 - accuracy10: 0.6745 - accuracy20: 0.6625 - accuracy30: 0.6395 - accuracy50: 0.6044 - val_loss: 8.5045 - val_accuracy10: 0.6864 - val_accuracy20: 0.6710 - val_accuracy30: 0.6462 - val_accuracy50: 0.6063 - 96s/epoch - 51ms/step
Epoch 8/50
1876/1876 - 97s - loss: 8.4140 - accuracy10: 0.6756 - accuracy20: 0.6635 - accuracy30: 0.6412 - accuracy50: 0.6062 - val_loss: 8.2991 - val_accuracy10: 0.6976 - val_accuracy20: 0.6811 - val_accuracy30: 0.6544 - val_accuracy50: 0.6120 - 97s/epoch - 52ms/step
Epoch 9/50
1876/1876 - 98s - loss: 8.3753 - accuracy10: 0.6771 - accuracy20: 0.6654 - accuracy30: 0.6428 - accuracy50: 0.6068 - val_loss: 8.4928 - val_accuracy10: 0.6849 - val_accuracy20: 0.6674 - val_accuracy30: 0.6417 - val_accuracy50: 0.6019 - 98s/epoch - 52ms/step
Epoch 10/50
1876/1876 - 99s - loss: 8.3434 - accuracy10: 0.6780 - accuracy20: 0.6661 - accuracy30: 0.6435 - accuracy50: 0.6078 - val_loss: 8.4084 - val_accuracy10: 0.6791 - val_accuracy20: 0.6634 - val_accuracy30: 0.6390 - val_accuracy50: 0.6002 - 99s/epoch - 53ms/step
Epoch 11/50
1876/1876 - 97s - loss: 8.3166 - accuracy10: 0.6800 - accuracy20: 0.6676 - accuracy30: 0.6449 - accuracy50: 0.6082 - val_loss: 8.4037 - val_accuracy10: 0.6811 - val_accuracy20: 0.6651 - val_accuracy30: 0.6389 - val_accuracy50: 0.5982 - 97s/epoch - 52ms/step
Epoch 12/50
1876/1876 - 98s - loss: 8.2905 - accuracy10: 0.6803 - accuracy20: 0.6681 - accuracy30: 0.6450 - accuracy50: 0.6092 - val_loss: 8.3944 - val_accuracy10: 0.6690 - val_accuracy20: 0.6528 - val_accuracy30: 0.6274 - val_accuracy50: 0.5908 - 98s/epoch - 52ms/step
Epoch 13/50
1876/1876 - 97s - loss: 8.2646 - accuracy10: 0.6815 - accuracy20: 0.6684 - accuracy30: 0.6455 - accuracy50: 0.6096 - val_loss: 8.3426 - val_accuracy10: 0.6850 - val_accuracy20: 0.6656 - val_accuracy30: 0.6394 - val_accuracy50: 0.5987 - 97s/epoch - 52ms/step
Epoch 14/50
1876/1876 - 101s - loss: 8.2362 - accuracy10: 0.6818 - accuracy20: 0.6690 - accuracy30: 0.6463 - accuracy50: 0.6103 - val_loss: 8.3578 - val_accuracy10: 0.6714 - val_accuracy20: 0.6545 - val_accuracy30: 0.6299 - val_accuracy50: 0.5928 - 101s/epoch - 54ms/step
Epoch 15/50
1876/1876 - 97s - loss: 8.2119 - accuracy10: 0.6827 - accuracy20: 0.6703 - accuracy30: 0.6474 - accuracy50: 0.6114 - val_loss: 8.4825 - val_accuracy10: 0.6739 - val_accuracy20: 0.6538 - val_accuracy30: 0.6277 - val_accuracy50: 0.5896 - 97s/epoch - 52ms/step
Epoch 16/50
1876/1876 - 98s - loss: 8.1914 - accuracy10: 0.6834 - accuracy20: 0.6705 - accuracy30: 0.6472 - accuracy50: 0.6113 - val_loss: 8.4591 - val_accuracy10: 0.6649 - val_accuracy20: 0.6458 - val_accuracy30: 0.6214 - val_accuracy50: 0.5845 - 98s/epoch - 53ms/step
Epoch 17/50
1876/1876 - 98s - loss: 8.1710 - accuracy10: 0.6835 - accuracy20: 0.6714 - accuracy30: 0.6482 - accuracy50: 0.6122 - val_loss: 8.4109 - val_accuracy10: 0.6657 - val_accuracy20: 0.6435 - val_accuracy30: 0.6170 - val_accuracy50: 0.5806 - 98s/epoch - 52ms/step
Epoch 18/50
1876/1876 - 97s - loss: 8.1506 - accuracy10: 0.6840 - accuracy20: 0.6718 - accuracy30: 0.6492 - accuracy50: 0.6127 - val_loss: 8.3973 - val_accuracy10: 0.6774 - val_accuracy20: 0.6563 - val_accuracy30: 0.6304 - val_accuracy50: 0.5901 - 97s/epoch - 52ms/step
testing model: results/EXC/W3/deepLOB_L2/seq2seq
Evaluating performance on  test set...
5098/5098 - 105s - 105s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7410288
{'0': {'precision': 0.3423907316721479, 'recall': 0.8056780811191732, 'f1-score': 0.48055779342339294, 'support': 153256}, '1': {'precision': 0.9525323253405663, 'recall': 0.594454454234141, 'f1-score': 0.7320516129509156, 'support': 999577}, '2': {'precision': 0.3269219367743103, 'recall': 0.6889162140480543, 'f1-score': 0.44342068229961334, 'support': 152078}, 'accuracy': 0.6302705701768166, 'macro avg': {'precision': 0.5406149979290081, 'recall': 0.6963495831337895, 'f1-score': 0.552010029557974, 'support': 1304911}, 'weighted avg': {'precision': 0.8079635104929436, 'recall': 0.6302705701768166, 'f1-score': 0.6688769202116416, 'support': 1304911}}
[[123475  16571  13210]
 [202882 594203 202492]
 [ 34269  13040 104769]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7517915
{'0': {'precision': 0.4258391027976841, 'recall': 0.7505530420882869, 'f1-score': 0.5433814488380982, 'support': 210201}, '1': {'precision': 0.9044416323505764, 'recall': 0.5831271101254468, 'f1-score': 0.7090824380618285, 'support': 887388}, '2': {'precision': 0.3999514206694011, 'recall': 0.6989128023075216, 'f1-score': 0.5087637987696975, 'support': 207322}, 'accuracy': 0.6284926711476875, 'macro avg': {'precision': 0.5767440519392205, 'recall': 0.6775309848404185, 'f1-score': 0.587075895223208, 'support': 1304911}, 'weighted avg': {'precision': 0.7471936284785022, 'recall': 0.6284926711476875, 'f1-score': 0.6505642904095054, 'support': 1304911}}
[[157767  30936  21498]
 [174032 517460 195896]
 [ 38686  23736 144900]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7871171
{'0': {'precision': 0.46809534893562993, 'recall': 0.7018135238994134, 'f1-score': 0.561608949184815, 'support': 252161}, '1': {'precision': 0.8518584037130031, 'recall': 0.5564655215260589, 'f1-score': 0.6731829551330616, 'support': 804792}, '2': {'precision': 0.43303991005342446, 'recall': 0.7005379943377508, 'f1-score': 0.5352272814808539, 'support': 247958}, 'accuracy': 0.6119290894168261, 'macro avg': {'precision': 0.5843312209006859, 'recall': 0.6529390132544076, 'f1-score': 0.5900063952662434, 'support': 1304911}, 'weighted avg': {'precision': 0.6981165226908038, 'recall': 0.6119290894168261, 'f1-score': 0.6254081828755129, 'support': 1304911}}
[[176970  43830  31361]
 [160891 447839 196062]
 [ 40203  34051 173704]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8502364
{'0': {'precision': 0.5148953902521484, 'recall': 0.6181767837589518, 'f1-score': 0.5618289525046005, 'support': 317812}, '1': {'precision': 0.7363201847091703, 'recall': 0.5253218934981365, 'f1-score': 0.6131772557902291, 'support': 675068}, '2': {'precision': 0.4692140864966676, 'recall': 0.664244898744035, 'f1-score': 0.5499503156844562, 'support': 312031}, 'accuracy': 0.5811561094971228, 'macro avg': {'precision': 0.5734765538193288, 'recall': 0.6025811920003744, 'f1-score': 0.5749855079930953, 'support': 1304911}, 'weighted avg': {'precision': 0.6185214691589753, 'recall': 0.5811561094971228, 'f1-score': 0.5855524811412633, 'support': 1304911}}
[[196464  69928  51420]
 [137397 354628 183043]
 [ 47700  57066 207265]]
Evaluating performance on  train set...
1876/1876 - 39s - 39s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.67324924
{'0': {'precision': 0.3586228358966799, 'recall': 0.7743042048307812, 'f1-score': 0.4902048583902384, 'support': 56554}, '1': {'precision': 0.9414545247451449, 'recall': 0.6771577208241736, 'f1-score': 0.7877281318995506, 'support': 366185}, '2': {'precision': 0.38242746737615607, 'recall': 0.6302986009605346, 'f1-score': 0.47602901750512533, 'support': 57468}, 'accuracy': 0.6829908768510247, 'macro avg': {'precision': 0.5608349426726603, 'recall': 0.6939201755384965, 'f1-score': 0.5846540025983048, 'support': 480207}, 'weighted avg': {'precision': 0.80591374698885, 'recall': 0.6829908768510247, 'f1-score': 0.7153867126448032, 'support': 480207}}
[[ 43790   7083   5681]
 [ 65407 247965  52813]
 [ 12909   8337  36222]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6978572
{'0': {'precision': 0.43338780897905305, 'recall': 0.7172262242217773, 'f1-score': 0.5402977764717406, 'support': 76906}, '1': {'precision': 0.8910828286135211, 'recall': 0.6706387461000421, 'f1-score': 0.7653024463880584, 'support': 324683}, '2': {'precision': 0.45909203945732363, 'recall': 0.6340151110432726, 'f1-score': 0.5325576550154655, 'support': 78618}, 'accuracy': 0.6721039051908865, 'macro avg': {'precision': 0.594520892349966, 'recall': 0.6739600271216973, 'f1-score': 0.6127192926250883, 'support': 480207}, 'weighted avg': {'precision': 0.7470579704963126, 'recall': 0.6721039051908865, 'f1-score': 0.6911632956619864, 'support': 480207}}
[[ 55159  12418   9329]
 [ 57539 217745  49399]
 [ 14576  14197  49845]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.74157864
{'0': {'precision': 0.46877637778357556, 'recall': 0.6677451441188366, 'f1-score': 0.5508442100042831, 'support': 91487}, '1': {'precision': 0.8398465018793456, 'recall': 0.6504871807906732, 'f1-score': 0.7331370010045798, 'support': 295065}, '2': {'precision': 0.4872519612367328, 'recall': 0.6313491004217607, 'f1-score': 0.5500193016971541, 'support': 93655}, 'accuracy': 0.6500425858015397, 'macro avg': {'precision': 0.5986249469665513, 'recall': 0.6498604751104234, 'f1-score': 0.6113335042353389, 'support': 480207}, 'weighted avg': {'precision': 0.7003851151293948, 'recall': 0.6500425858015397, 'f1-score': 0.6626938198371226, 'support': 480207}}
[[ 61090  17471  12926]
 [ 53832 191936  49297]
 [ 15396  19130  59129]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.81616515
{'0': {'precision': 0.510136501323811, 'recall': 0.5842224377626899, 'f1-score': 0.5446717338351623, 'support': 114441}, '1': {'precision': 0.7315182727820293, 'recall': 0.6288608895650114, 'f1-score': 0.6763161984355843, 'support': 249133}, '2': {'precision': 0.515865901092795, 'recall': 0.596992274913618, 'f1-score': 0.5534720676608057, 'support': 116633}, 'accuracy': 0.6104825627281568, 'macro avg': {'precision': 0.5858402250662117, 'recall': 0.6033585340804398, 'f1-score': 0.5914866666438509, 'support': 480207}, 'weighted avg': {'precision': 0.6263816663296444, 'recall': 0.6104825627281568, 'f1-score': 0.6151067540126758, 'support': 480207}}
[[ 66859  28375  19207]
 [ 46324 156670  46139]
 [ 17878  29126  69629]]
Evaluating performance on  val set...
619/619 - 13s - 13s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6380431
{'0': {'precision': 0.3324525347426111, 'recall': 0.8241644932370958, 'f1-score': 0.4737878972785439, 'support': 16487}, '1': {'precision': 0.9456534768915577, 'recall': 0.6937528980988471, 'f1-score': 0.8003504807581453, 'support': 125082}, '2': {'precision': 0.39029412907487276, 'recall': 0.5978099148961495, 'f1-score': 0.4722614010343207, 'support': 16803}, 'accuracy': 0.6971497486929508, 'macro avg': {'precision': 0.5561333802363472, 'recall': 0.7052424354106975, 'f1-score': 0.5821332596903367, 'support': 158372}, 'weighted avg': {'precision': 0.8228947376284718, 'recall': 0.6971497486929508, 'f1-score': 0.7315446431073761, 'support': 158372}}
[[13588  1800  1099]
 [23713 86776 14593]
 [ 3571  3187 10045]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.67184466
{'0': {'precision': 0.4075483811794919, 'recall': 0.772749010912569, 'f1-score': 0.5336495879182741, 'support': 23001}, '1': {'precision': 0.8936037551615825, 'recall': 0.6795036945592471, 'f1-score': 0.7719842064343027, 'support': 111786}, '2': {'precision': 0.47232583929831634, 'recall': 0.5959296162815348, 'f1-score': 0.5269768662592328, 'support': 23585}, 'accuracy': 0.6806001060793575, 'macro avg': {'precision': 0.5911593252131303, 'recall': 0.6827274405844502, 'f1-score': 0.6108702202039366, 'support': 158372}, 'weighted avg': {'precision': 0.7602746357301351, 'recall': 0.6806001060793575, 'f1-score': 0.7008830479055463, 'support': 158372}}
[[17774  3476  1751]
 [21876 75959 13951]
 [ 3962  5568 14055]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7239037
{'0': {'precision': 0.44588392876748423, 'recall': 0.7275267815556591, 'f1-score': 0.5529052986984698, 'support': 27911}, '1': {'precision': 0.8392636177681254, 'recall': 0.653370162487344, 'f1-score': 0.7347412520933625, 'support': 101731}, '2': {'precision': 0.5041179793655041, 'recall': 0.5901496693351898, 'f1-score': 0.5437519041739493, 'support': 28730}, 'accuracy': 0.6549705756067992, 'macro avg': {'precision': 0.5964218419670378, 'recall': 0.657015537792731, 'f1-score': 0.6104661516552605, 'support': 158372}, 'weighted avg': {'precision': 0.7091373663410789, 'recall': 0.6549705756067992, 'f1-score': 0.668047977645041, 'support': 158372}}
[[20306  5144  2461]
 [21046 66468 14217]
 [ 4189  7586 16955]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.80593044
{'0': {'precision': 0.4948453608247423, 'recall': 0.6436142098088853, 'f1-score': 0.5595095585301266, 'support': 35947}, '1': {'precision': 0.7246459307447313, 'recall': 0.6253640393454895, 'f1-score': 0.6713543105396651, 'support': 85499}, '2': {'precision': 0.5357227816985172, 'recall': 0.5488815468775389, 'f1-score': 0.542222341122808, 'support': 36926}, 'accuracy': 0.611673780718814, 'macro avg': {'precision': 0.585071357755997, 'recall': 0.6059532653439712, 'f1-score': 0.5910287367308665, 'support': 158372}, 'weighted avg': {'precision': 0.6284368957600475, 'recall': 0.611673780718814, 'f1-score': 0.6158595867048096, 'support': 158372}}
[[23136  8841  3970]
 [18436 53468 13595]
 [ 5182 11476 20268]]
training model: results/EXC/W3/deepOF_L2/seq2seq
Epoch 1/50
1876/1876 - 72s - loss: 9.9971 - accuracy10: 0.5869 - accuracy20: 0.5951 - accuracy30: 0.5859 - accuracy50: 0.5640 - val_loss: 8.9505 - val_accuracy10: 0.6902 - val_accuracy20: 0.6832 - val_accuracy30: 0.6572 - val_accuracy50: 0.6052 - 72s/epoch - 38ms/step
Epoch 2/50
1876/1876 - 68s - loss: 9.0549 - accuracy10: 0.6428 - accuracy20: 0.6411 - accuracy30: 0.6220 - accuracy50: 0.5899 - val_loss: 8.6181 - val_accuracy10: 0.6932 - val_accuracy20: 0.6846 - val_accuracy30: 0.6591 - val_accuracy50: 0.6114 - 68s/epoch - 37ms/step
Epoch 3/50
1876/1876 - 67s - loss: 8.8448 - accuracy10: 0.6497 - accuracy20: 0.6466 - accuracy30: 0.6278 - accuracy50: 0.5953 - val_loss: 8.5521 - val_accuracy10: 0.7030 - val_accuracy20: 0.6915 - val_accuracy30: 0.6639 - val_accuracy50: 0.6143 - 67s/epoch - 35ms/step
Epoch 4/50
1876/1876 - 64s - loss: 8.7417 - accuracy10: 0.6537 - accuracy20: 0.6499 - accuracy30: 0.6306 - accuracy50: 0.5978 - val_loss: 8.4419 - val_accuracy10: 0.7061 - val_accuracy20: 0.6930 - val_accuracy30: 0.6636 - val_accuracy50: 0.6128 - 64s/epoch - 34ms/step
Epoch 5/50
1876/1876 - 63s - loss: 8.6758 - accuracy10: 0.6563 - accuracy20: 0.6528 - accuracy30: 0.6327 - accuracy50: 0.6000 - val_loss: 8.4146 - val_accuracy10: 0.7038 - val_accuracy20: 0.6902 - val_accuracy30: 0.6598 - val_accuracy50: 0.6101 - 63s/epoch - 34ms/step
Epoch 6/50
1876/1876 - 63s - loss: 8.6215 - accuracy10: 0.6590 - accuracy20: 0.6542 - accuracy30: 0.6334 - accuracy50: 0.6005 - val_loss: 8.3913 - val_accuracy10: 0.7086 - val_accuracy20: 0.6941 - val_accuracy30: 0.6631 - val_accuracy50: 0.6127 - 63s/epoch - 34ms/step
Epoch 7/50
1876/1876 - 64s - loss: 8.5808 - accuracy10: 0.6608 - accuracy20: 0.6555 - accuracy30: 0.6345 - accuracy50: 0.6017 - val_loss: 8.4027 - val_accuracy10: 0.7112 - val_accuracy20: 0.6962 - val_accuracy30: 0.6654 - val_accuracy50: 0.6151 - 64s/epoch - 34ms/step
Epoch 8/50
1876/1876 - 65s - loss: 8.5487 - accuracy10: 0.6614 - accuracy20: 0.6562 - accuracy30: 0.6354 - accuracy50: 0.6026 - val_loss: 8.3892 - val_accuracy10: 0.7156 - val_accuracy20: 0.7005 - val_accuracy30: 0.6696 - val_accuracy50: 0.6172 - 65s/epoch - 34ms/step
Epoch 9/50
1876/1876 - 64s - loss: 8.5158 - accuracy10: 0.6629 - accuracy20: 0.6576 - accuracy30: 0.6364 - accuracy50: 0.6036 - val_loss: 8.3707 - val_accuracy10: 0.7137 - val_accuracy20: 0.6986 - val_accuracy30: 0.6685 - val_accuracy50: 0.6176 - 64s/epoch - 34ms/step
Epoch 10/50
1876/1876 - 63s - loss: 8.4980 - accuracy10: 0.6643 - accuracy20: 0.6587 - accuracy30: 0.6373 - accuracy50: 0.6045 - val_loss: 8.3879 - val_accuracy10: 0.7202 - val_accuracy20: 0.7041 - val_accuracy30: 0.6728 - val_accuracy50: 0.6202 - 63s/epoch - 34ms/step
Epoch 11/50
1876/1876 - 63s - loss: 8.4705 - accuracy10: 0.6654 - accuracy20: 0.6594 - accuracy30: 0.6383 - accuracy50: 0.6051 - val_loss: 8.3595 - val_accuracy10: 0.7209 - val_accuracy20: 0.7048 - val_accuracy30: 0.6734 - val_accuracy50: 0.6193 - 63s/epoch - 34ms/step
Epoch 12/50
1876/1876 - 63s - loss: 8.4437 - accuracy10: 0.6668 - accuracy20: 0.6601 - accuracy30: 0.6390 - accuracy50: 0.6056 - val_loss: 8.3783 - val_accuracy10: 0.7190 - val_accuracy20: 0.7026 - val_accuracy30: 0.6713 - val_accuracy50: 0.6192 - 63s/epoch - 34ms/step
Epoch 13/50
1876/1876 - 64s - loss: 8.4170 - accuracy10: 0.6679 - accuracy20: 0.6604 - accuracy30: 0.6396 - accuracy50: 0.6066 - val_loss: 8.3518 - val_accuracy10: 0.7177 - val_accuracy20: 0.7001 - val_accuracy30: 0.6690 - val_accuracy50: 0.6176 - 64s/epoch - 34ms/step
Epoch 14/50
1876/1876 - 64s - loss: 8.3991 - accuracy10: 0.6681 - accuracy20: 0.6609 - accuracy30: 0.6401 - accuracy50: 0.6068 - val_loss: 8.3869 - val_accuracy10: 0.7102 - val_accuracy20: 0.6951 - val_accuracy30: 0.6647 - val_accuracy50: 0.6148 - 64s/epoch - 34ms/step
Epoch 15/50
1876/1876 - 62s - loss: 8.3751 - accuracy10: 0.6694 - accuracy20: 0.6618 - accuracy30: 0.6410 - accuracy50: 0.6079 - val_loss: 8.3580 - val_accuracy10: 0.7137 - val_accuracy20: 0.6985 - val_accuracy30: 0.6668 - val_accuracy50: 0.6160 - 62s/epoch - 33ms/step
Epoch 16/50
1876/1876 - 63s - loss: 8.3564 - accuracy10: 0.6701 - accuracy20: 0.6629 - accuracy30: 0.6416 - accuracy50: 0.6082 - val_loss: 8.3559 - val_accuracy10: 0.7159 - val_accuracy20: 0.6993 - val_accuracy30: 0.6695 - val_accuracy50: 0.6176 - 63s/epoch - 33ms/step
Epoch 17/50
1876/1876 - 62s - loss: 8.3404 - accuracy10: 0.6705 - accuracy20: 0.6635 - accuracy30: 0.6424 - accuracy50: 0.6082 - val_loss: 8.3507 - val_accuracy10: 0.7134 - val_accuracy20: 0.6972 - val_accuracy30: 0.6674 - val_accuracy50: 0.6178 - 62s/epoch - 33ms/step
Epoch 18/50
1876/1876 - 62s - loss: 8.3215 - accuracy10: 0.6722 - accuracy20: 0.6642 - accuracy30: 0.6428 - accuracy50: 0.6097 - val_loss: 8.3475 - val_accuracy10: 0.7156 - val_accuracy20: 0.6986 - val_accuracy30: 0.6683 - val_accuracy50: 0.6162 - 62s/epoch - 33ms/step
Epoch 19/50
1876/1876 - 63s - loss: 8.3015 - accuracy10: 0.6718 - accuracy20: 0.6643 - accuracy30: 0.6434 - accuracy50: 0.6098 - val_loss: 8.4186 - val_accuracy10: 0.7061 - val_accuracy20: 0.6916 - val_accuracy30: 0.6641 - val_accuracy50: 0.6157 - 63s/epoch - 33ms/step
Epoch 20/50
1876/1876 - 63s - loss: 8.2809 - accuracy10: 0.6729 - accuracy20: 0.6655 - accuracy30: 0.6441 - accuracy50: 0.6104 - val_loss: 8.4059 - val_accuracy10: 0.7082 - val_accuracy20: 0.6937 - val_accuracy30: 0.6658 - val_accuracy50: 0.6164 - 63s/epoch - 33ms/step
Epoch 21/50
1876/1876 - 62s - loss: 8.2669 - accuracy10: 0.6729 - accuracy20: 0.6653 - accuracy30: 0.6443 - accuracy50: 0.6111 - val_loss: 8.3784 - val_accuracy10: 0.7098 - val_accuracy20: 0.6950 - val_accuracy30: 0.6664 - val_accuracy50: 0.6163 - 62s/epoch - 33ms/step
Epoch 22/50
1876/1876 - 63s - loss: 8.2413 - accuracy10: 0.6750 - accuracy20: 0.6671 - accuracy30: 0.6460 - accuracy50: 0.6121 - val_loss: 8.3684 - val_accuracy10: 0.6997 - val_accuracy20: 0.6837 - val_accuracy30: 0.6569 - val_accuracy50: 0.6114 - 63s/epoch - 34ms/step
Epoch 23/50
1876/1876 - 67s - loss: 8.2345 - accuracy10: 0.6747 - accuracy20: 0.6666 - accuracy30: 0.6455 - accuracy50: 0.6117 - val_loss: 8.4398 - val_accuracy10: 0.7088 - val_accuracy20: 0.6929 - val_accuracy30: 0.6650 - val_accuracy50: 0.6162 - 67s/epoch - 36ms/step
Epoch 24/50
1876/1876 - 63s - loss: 8.2069 - accuracy10: 0.6765 - accuracy20: 0.6678 - accuracy30: 0.6471 - accuracy50: 0.6134 - val_loss: 8.4193 - val_accuracy10: 0.7032 - val_accuracy20: 0.6882 - val_accuracy30: 0.6606 - val_accuracy50: 0.6135 - 63s/epoch - 33ms/step
Epoch 25/50
1876/1876 - 65s - loss: 8.1868 - accuracy10: 0.6768 - accuracy20: 0.6691 - accuracy30: 0.6479 - accuracy50: 0.6139 - val_loss: 8.4541 - val_accuracy10: 0.7049 - val_accuracy20: 0.6894 - val_accuracy30: 0.6627 - val_accuracy50: 0.6151 - 65s/epoch - 34ms/step
Epoch 26/50
1876/1876 - 63s - loss: 8.1733 - accuracy10: 0.6769 - accuracy20: 0.6693 - accuracy30: 0.6487 - accuracy50: 0.6145 - val_loss: 8.4908 - val_accuracy10: 0.7070 - val_accuracy20: 0.6908 - val_accuracy30: 0.6630 - val_accuracy50: 0.6131 - 63s/epoch - 34ms/step
Epoch 27/50
1876/1876 - 63s - loss: 8.1547 - accuracy10: 0.6773 - accuracy20: 0.6700 - accuracy30: 0.6492 - accuracy50: 0.6149 - val_loss: 8.5127 - val_accuracy10: 0.6997 - val_accuracy20: 0.6841 - val_accuracy30: 0.6574 - val_accuracy50: 0.6088 - 63s/epoch - 34ms/step
Epoch 28/50
1876/1876 - 66s - loss: 8.1352 - accuracy10: 0.6784 - accuracy20: 0.6703 - accuracy30: 0.6494 - accuracy50: 0.6158 - val_loss: 8.5290 - val_accuracy10: 0.7028 - val_accuracy20: 0.6875 - val_accuracy30: 0.6614 - val_accuracy50: 0.6127 - 66s/epoch - 35ms/step
testing model: results/EXC/W3/deepOF_L2/seq2seq
Evaluating performance on  test set...
5098/5098 - 82s - 82s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.652419
{'0': {'precision': 0.3706137368524053, 'recall': 0.7290659358585364, 'f1-score': 0.4914191970725872, 'support': 153255}, '1': {'precision': 0.9299382468077562, 'recall': 0.67161209191488, 'f1-score': 0.779941480688453, 'support': 999577}, '2': {'precision': 0.36377166808752487, 'recall': 0.6734111458162091, 'f1-score': 0.47237168325280504, 'support': 152075}, 'accuracy': 0.6785694306184272, 'macro avg': {'precision': 0.5547745505825621, 'recall': 0.6913630578632085, 'f1-score': 0.5812441203379485, 'support': 1304907}, 'weighted avg': {'precision': 0.7982667482012759, 'recall': 0.6785694306184272, 'f1-score': 0.7102114849718422, 'support': 1304907}}
[[111733  22302  19220]
 [168358 671328 159891]
 [ 21390  28276 102409]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6864139
{'0': {'precision': 0.4488631138847849, 'recall': 0.6966636377908554, 'f1-score': 0.5459612520295801, 'support': 210199}, '1': {'precision': 0.8779961108790195, 'recall': 0.6584038305722306, 'f1-score': 0.7525071916941487, 'support': 887387}, '2': {'precision': 0.4334124047391761, 'recall': 0.6547961856251899, 'f1-score': 0.5215852768279094, 'support': 207321}, 'accuracy': 0.6639936792430419, 'macro avg': {'precision': 0.5867572098343269, 'recall': 0.6699545513294254, 'f1-score': 0.6066845735172127, 'support': 1304907}, 'weighted avg': {'precision': 0.7382352962188103, 'recall': 0.6639936792430419, 'f1-score': 0.6825476372710855, 'support': 1304907}}
[[146438  37254  26507]
 [152169 584259 150959]
 [ 27635  43933 135753]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7414122
{'0': {'precision': 0.4823608212452064, 'recall': 0.6654306789340102, 'f1-score': 0.5592961591408315, 'support': 252160}, '1': {'precision': 0.8258142332229205, 'recall': 0.6235942002333525, 'f1-score': 0.7105974470977197, 'support': 804791}, '2': {'precision': 0.458797799190441, 'recall': 0.646364677604091, 'f1-score': 0.5366644231702947, 'support': 247956}, 'accuracy': 0.6360054777850069, 'macro avg': {'precision': 0.5889909512195226, 'recall': 0.6451298522571512, 'f1-score': 0.6021860098029487, 'support': 1304907}, 'weighted avg': {'precision': 0.6897055762218791, 'recall': 0.6360054777850069, 'f1-score': 0.6483095831716641, 'support': 1304907}}
[[167795  49692  34673]
 [148545 501863 154383]
 [ 31522  56164 160270]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8299885
{'0': {'precision': 0.5196215255957191, 'recall': 0.6009955602543651, 'f1-score': 0.5573540397320074, 'support': 317811}, '1': {'precision': 0.7123822383493988, 'recall': 0.5798956549562414, 'f1-score': 0.6393475688577963, 'support': 675068}, '2': {'precision': 0.48670079034566344, 'recall': 0.6048976373915161, 'f1-score': 0.5394001140272037, 'support': 312028}, 'accuracy': 0.5910129993938266, 'macro avg': {'precision': 0.5729015180969271, 'recall': 0.5952629508673742, 'f1-score': 0.5787005742056691, 'support': 1304907}, 'weighted avg': {'precision': 0.6114705214694455, 'recall': 0.5910129993938266, 'f1-score': 0.5954786571875575, 'support': 1304907}}
[[191003  76240  50568]
 [135107 391469 148492]
 [ 41471  81812 188745]]
Evaluating performance on  train set...
1876/1876 - 30s - 30s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6597501
{'0': {'precision': 0.3682694681405491, 'recall': 0.7120531768199979, 'f1-score': 0.48546134978937794, 'support': 56566}, '1': {'precision': 0.9342573262921972, 'recall': 0.6810338232883449, 'f1-score': 0.7877970965483785, 'support': 366020}, '2': {'precision': 0.37616442833658587, 'recall': 0.6790989083462052, 'f1-score': 0.4841499628804751, 'support': 57619}, 'accuracy': 0.6844555970887434, 'macro avg': {'precision': 0.5595637409231108, 'recall': 0.690728636151516, 'f1-score': 0.5858028030727438, 'support': 480205}, 'weighted avg': {'precision': 0.800621850044531, 'recall': 0.6844555970887434, 'f1-score': 0.7157491835820816, 'support': 480205}}
[[ 40278   7520   8768]
 [ 60624 249272  56124]
 [  8469  10021  39129]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6874611
{'0': {'precision': 0.44305019305019305, 'recall': 0.6807519677356404, 'f1-score': 0.5367622545122558, 'support': 76865}, '1': {'precision': 0.885347797464469, 'recall': 0.6753327171903881, 'f1-score': 0.7662097759353793, 'support': 324600}, '2': {'precision': 0.45251528384279477, 'recall': 0.6580264160528321, 'f1-score': 0.5362554336576278, 'support': 78740}, 'accuracy': 0.673362418133922, 'macro avg': {'precision': 0.5936377581191523, 'recall': 0.6713703669929535, 'f1-score': 0.613075821368421, 'support': 480205}, 'weighted avg': {'precision': 0.7435782667726313, 'recall': 0.673362418133922, 'f1-score': 0.6917767970094237, 'support': 480205}}
[[ 52326  12631  11908]
 [ 54608 219213  50779]
 [ 11170  15757  51813]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.73453623
{'0': {'precision': 0.47369676916469144, 'recall': 0.6513621996434548, 'f1-score': 0.548501328519656, 'support': 91433}, '1': {'precision': 0.8377254846990179, 'recall': 0.6481976714627078, 'f1-score': 0.7308745492728173, 'support': 295035}, '2': {'precision': 0.4808269872338402, 'recall': 0.6473110938050076, 'f1-score': 0.5517846587550583, 'support': 93737}, 'accuracy': 0.6486271488218573, 'macro avg': {'precision': 0.5974164136991832, 'recall': 0.6489569883037234, 'f1-score': 0.6103868455158439, 'support': 480205}, 'weighted avg': {'precision': 0.698745607345922, 'recall': 0.6486271488218573, 'f1-score': 0.661191227023805, 'support': 480205}}
[[ 59556  17083  14794]
 [ 53072 191241  50722]
 [ 13098  19962  60677]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8169191
{'0': {'precision': 0.5092327992459943, 'recall': 0.5906630167656396, 'f1-score': 0.5469335859996922, 'support': 114341}, '1': {'precision': 0.7328932261768083, 'recall': 0.614877067931707, 'f1-score': 0.6687181636046983, 'support': 249162}, '2': {'precision': 0.5081059621769886, 'recall': 0.603185892272626, 'f1-score': 0.5515785019706787, 'support': 116702}, 'accuracy': 0.6062702387521995, 'macro avg': {'precision': 0.5834106625332637, 'recall': 0.6029086589899908, 'f1-score': 0.5890767505250231, 'support': 480205}, 'weighted avg': {'precision': 0.6250087181875055, 'recall': 0.6062702387521995, 'f1-score': 0.6112522830329689, 'support': 480205}}
[[ 67537  26798  20006]
 [ 47817 153204  48141]
 [ 17271  29038  70393]]
Evaluating performance on  val set...
619/619 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.58706135
{'0': {'precision': 0.3681209099407915, 'recall': 0.7180282032579626, 'f1-score': 0.4867125375963083, 'support': 16452}, '1': {'precision': 0.9367306873305564, 'recall': 0.7208690716952174, 'f1-score': 0.8147445453313458, 'support': 125099}, '2': {'precision': 0.37829462530405517, 'recall': 0.6749301468402592, 'f1-score': 0.48483942603348135, 'support': 16821}, 'accuracy': 0.7156946935064279, 'macro avg': {'precision': 0.5610487408584677, 'recall': 0.7046091405978131, 'f1-score': 0.5954321696537118, 'support': 158372}, 'weighted avg': {'precision': 0.8183497799923641, 'recall': 0.7156946935064279, 'f1-score': 0.7456280562867783, 'support': 158372}}
[[11813  2673  1966]
 [18227 90180 16692]
 [ 2050  3418 11353]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.62904024
{'0': {'precision': 0.44948684135084, 'recall': 0.6815771170231264, 'f1-score': 0.5417199322806897, 'support': 23004}, '1': {'precision': 0.8848757963904367, 'recall': 0.7132683188691062, 'f1-score': 0.7898585186065867, 'support': 111770}, '2': {'precision': 0.46089352018205776, 'recall': 0.6522586659886431, 'f1-score': 0.5401270309155349, 'support': 23598}, 'accuracy': 0.6995744197206577, 'macro avg': {'precision': 0.5984187193077782, 'recall': 0.6823680339602919, 'f1-score': 0.6239018272676038, 'support': 158372}, 'weighted avg': {'precision': 0.7584593763433563, 'recall': 0.6995744197206577, 'f1-score': 0.7166047636096531, 'support': 158372}}
[[15679  4702  2623]
 [16667 79722 15381]
 [ 2536  5670 15392]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.69000876
{'0': {'precision': 0.48295971323096676, 'recall': 0.6459622884539697, 'f1-score': 0.5526932084309134, 'support': 27949}, '1': {'precision': 0.832507183908046, 'recall': 0.6838890528179404, 'f1-score': 0.7509152762028188, 'support': 101670}, '2': {'precision': 0.4901521216973579, 'recall': 0.6387507390533161, 'f1-score': 0.5546713377527446, 'support': 28753}, 'accuracy': 0.6690008334806657, 'macro avg': {'precision': 0.6018730062787901, 'recall': 0.656200693441742, 'f1-score': 0.6194266074621589, 'support': 158372}, 'weighted avg': {'precision': 0.7086643495579236, 'recall': 0.6690008334806657, 'f1-score': 0.6803048745256791, 'support': 158372}}
[[18054  6606  3289]
 [16324 69531 15815]
 [ 3004  7383 18366]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7907983
{'0': {'precision': 0.5227764090703404, 'recall': 0.5778957314361939, 'f1-score': 0.5489559409730471, 'support': 35984}, '1': {'precision': 0.7198627814154905, 'recall': 0.6457875029253451, 'f1-score': 0.6808161553359732, 'support': 85460}, '2': {'precision': 0.5201774470520893, 'recall': 0.5906087521663779, 'f1-score': 0.553160190727402, 'support': 36928}, 'accuracy': 0.6174955168842977, 'macro avg': {'precision': 0.5876055458459734, 'recall': 0.6047639955093056, 'f1-score': 0.5943107623454741, 'support': 158372}, 'weighted avg': {'precision': 0.6285212813407326, 'recall': 0.6174955168842977, 'f1-score': 0.621090083715353, 'support': 158372}}
[[20795 10484  4705]
 [14858 55189 15413]
 [ 4125 10993 21810]]
training model: results/EXC/W3/deepVOL_L2/seq2seq
Epoch 1/50
1876/1876 - 72s - loss: 9.8009 - accuracy10: 0.6059 - accuracy20: 0.6100 - accuracy30: 0.5958 - accuracy50: 0.5660 - val_loss: 9.1321 - val_accuracy10: 0.7317 - val_accuracy20: 0.7164 - val_accuracy30: 0.6896 - val_accuracy50: 0.6263 - 72s/epoch - 38ms/step
Epoch 2/50
1876/1876 - 65s - loss: 9.1954 - accuracy10: 0.6368 - accuracy20: 0.6378 - accuracy30: 0.6199 - accuracy50: 0.5872 - val_loss: 9.0283 - val_accuracy10: 0.7553 - val_accuracy20: 0.7286 - val_accuracy30: 0.6928 - val_accuracy50: 0.6226 - 65s/epoch - 35ms/step
Epoch 3/50
1876/1876 - 63s - loss: 8.8733 - accuracy10: 0.6541 - accuracy20: 0.6494 - accuracy30: 0.6277 - accuracy50: 0.5922 - val_loss: 8.9568 - val_accuracy10: 0.7475 - val_accuracy20: 0.7183 - val_accuracy30: 0.6827 - val_accuracy50: 0.6185 - 63s/epoch - 34ms/step
Epoch 4/50
1876/1876 - 64s - loss: 8.7508 - accuracy10: 0.6601 - accuracy20: 0.6527 - accuracy30: 0.6298 - accuracy50: 0.5943 - val_loss: 8.8487 - val_accuracy10: 0.7437 - val_accuracy20: 0.7163 - val_accuracy30: 0.6832 - val_accuracy50: 0.6221 - 64s/epoch - 34ms/step
Epoch 5/50
1876/1876 - 65s - loss: 8.6716 - accuracy10: 0.6642 - accuracy20: 0.6561 - accuracy30: 0.6321 - accuracy50: 0.5955 - val_loss: 8.8078 - val_accuracy10: 0.7498 - val_accuracy20: 0.7208 - val_accuracy30: 0.6865 - val_accuracy50: 0.6234 - 65s/epoch - 35ms/step
Epoch 6/50
1876/1876 - 64s - loss: 8.6217 - accuracy10: 0.6655 - accuracy20: 0.6573 - accuracy30: 0.6335 - accuracy50: 0.5973 - val_loss: 8.6997 - val_accuracy10: 0.7483 - val_accuracy20: 0.7161 - val_accuracy30: 0.6824 - val_accuracy50: 0.6216 - 64s/epoch - 34ms/step
Epoch 7/50
1876/1876 - 63s - loss: 8.5774 - accuracy10: 0.6685 - accuracy20: 0.6593 - accuracy30: 0.6350 - accuracy50: 0.5985 - val_loss: 8.6270 - val_accuracy10: 0.7478 - val_accuracy20: 0.7177 - val_accuracy30: 0.6846 - val_accuracy50: 0.6247 - 63s/epoch - 34ms/step
Epoch 8/50
1876/1876 - 63s - loss: 8.5455 - accuracy10: 0.6703 - accuracy20: 0.6600 - accuracy30: 0.6357 - accuracy50: 0.5996 - val_loss: 8.7023 - val_accuracy10: 0.7506 - val_accuracy20: 0.7194 - val_accuracy30: 0.6854 - val_accuracy50: 0.6238 - 63s/epoch - 33ms/step
Epoch 9/50
1876/1876 - 64s - loss: 8.5173 - accuracy10: 0.6716 - accuracy20: 0.6611 - accuracy30: 0.6367 - accuracy50: 0.6004 - val_loss: 8.5852 - val_accuracy10: 0.7458 - val_accuracy20: 0.7142 - val_accuracy30: 0.6793 - val_accuracy50: 0.6203 - 64s/epoch - 34ms/step
Epoch 10/50
1876/1876 - 66s - loss: 8.4885 - accuracy10: 0.6734 - accuracy20: 0.6619 - accuracy30: 0.6377 - accuracy50: 0.6018 - val_loss: 8.6172 - val_accuracy10: 0.7444 - val_accuracy20: 0.7135 - val_accuracy30: 0.6801 - val_accuracy50: 0.6219 - 66s/epoch - 35ms/step
Epoch 11/50
1876/1876 - 65s - loss: 8.4676 - accuracy10: 0.6741 - accuracy20: 0.6628 - accuracy30: 0.6383 - accuracy50: 0.6022 - val_loss: 8.5042 - val_accuracy10: 0.7479 - val_accuracy20: 0.7169 - val_accuracy30: 0.6814 - val_accuracy50: 0.6224 - 65s/epoch - 34ms/step
Epoch 12/50
1876/1876 - 65s - loss: 8.4453 - accuracy10: 0.6750 - accuracy20: 0.6630 - accuracy30: 0.6385 - accuracy50: 0.6033 - val_loss: 8.4910 - val_accuracy10: 0.7470 - val_accuracy20: 0.7175 - val_accuracy30: 0.6829 - val_accuracy50: 0.6233 - 65s/epoch - 35ms/step
Epoch 13/50
1876/1876 - 64s - loss: 8.4239 - accuracy10: 0.6756 - accuracy20: 0.6636 - accuracy30: 0.6388 - accuracy50: 0.6040 - val_loss: 8.4754 - val_accuracy10: 0.7388 - val_accuracy20: 0.7080 - val_accuracy30: 0.6728 - val_accuracy50: 0.6178 - 64s/epoch - 34ms/step
Epoch 14/50
1876/1876 - 62s - loss: 8.4091 - accuracy10: 0.6762 - accuracy20: 0.6638 - accuracy30: 0.6390 - accuracy50: 0.6041 - val_loss: 8.4322 - val_accuracy10: 0.7396 - val_accuracy20: 0.7101 - val_accuracy30: 0.6762 - val_accuracy50: 0.6215 - 62s/epoch - 33ms/step
Epoch 15/50
1876/1876 - 63s - loss: 8.3896 - accuracy10: 0.6770 - accuracy20: 0.6651 - accuracy30: 0.6409 - accuracy50: 0.6054 - val_loss: 8.4325 - val_accuracy10: 0.7414 - val_accuracy20: 0.7117 - val_accuracy30: 0.6777 - val_accuracy50: 0.6218 - 63s/epoch - 34ms/step
Epoch 16/50
1876/1876 - 62s - loss: 8.3740 - accuracy10: 0.6773 - accuracy20: 0.6653 - accuracy30: 0.6414 - accuracy50: 0.6058 - val_loss: 8.4022 - val_accuracy10: 0.7374 - val_accuracy20: 0.7091 - val_accuracy30: 0.6756 - val_accuracy50: 0.6210 - 62s/epoch - 33ms/step
Epoch 17/50
1876/1876 - 63s - loss: 8.3624 - accuracy10: 0.6776 - accuracy20: 0.6656 - accuracy30: 0.6416 - accuracy50: 0.6062 - val_loss: 8.3911 - val_accuracy10: 0.7371 - val_accuracy20: 0.7073 - val_accuracy30: 0.6737 - val_accuracy50: 0.6191 - 63s/epoch - 34ms/step
Epoch 18/50
1876/1876 - 62s - loss: 8.3494 - accuracy10: 0.6780 - accuracy20: 0.6661 - accuracy30: 0.6414 - accuracy50: 0.6063 - val_loss: 8.3290 - val_accuracy10: 0.7345 - val_accuracy20: 0.7076 - val_accuracy30: 0.6747 - val_accuracy50: 0.6207 - 62s/epoch - 33ms/step
Epoch 19/50
1876/1876 - 62s - loss: 8.3347 - accuracy10: 0.6782 - accuracy20: 0.6659 - accuracy30: 0.6419 - accuracy50: 0.6066 - val_loss: 8.3428 - val_accuracy10: 0.7355 - val_accuracy20: 0.7079 - val_accuracy30: 0.6747 - val_accuracy50: 0.6199 - 62s/epoch - 33ms/step
Epoch 20/50
1876/1876 - 62s - loss: 8.3220 - accuracy10: 0.6780 - accuracy20: 0.6661 - accuracy30: 0.6424 - accuracy50: 0.6078 - val_loss: 8.3832 - val_accuracy10: 0.7400 - val_accuracy20: 0.7120 - val_accuracy30: 0.6789 - val_accuracy50: 0.6217 - 62s/epoch - 33ms/step
Epoch 21/50
1876/1876 - 62s - loss: 8.3078 - accuracy10: 0.6791 - accuracy20: 0.6674 - accuracy30: 0.6428 - accuracy50: 0.6079 - val_loss: 8.4101 - val_accuracy10: 0.7316 - val_accuracy20: 0.7062 - val_accuracy30: 0.6737 - val_accuracy50: 0.6184 - 62s/epoch - 33ms/step
Epoch 22/50
1876/1876 - 61s - loss: 8.2950 - accuracy10: 0.6792 - accuracy20: 0.6673 - accuracy30: 0.6430 - accuracy50: 0.6078 - val_loss: 8.3409 - val_accuracy10: 0.7287 - val_accuracy20: 0.7057 - val_accuracy30: 0.6743 - val_accuracy50: 0.6207 - 61s/epoch - 33ms/step
Epoch 23/50
1876/1876 - 62s - loss: 8.2848 - accuracy10: 0.6801 - accuracy20: 0.6676 - accuracy30: 0.6435 - accuracy50: 0.6085 - val_loss: 8.3473 - val_accuracy10: 0.7293 - val_accuracy20: 0.7029 - val_accuracy30: 0.6710 - val_accuracy50: 0.6181 - 62s/epoch - 33ms/step
Epoch 24/50
1876/1876 - 63s - loss: 8.2678 - accuracy10: 0.6799 - accuracy20: 0.6677 - accuracy30: 0.6439 - accuracy50: 0.6087 - val_loss: 8.3625 - val_accuracy10: 0.7320 - val_accuracy20: 0.7059 - val_accuracy30: 0.6735 - val_accuracy50: 0.6196 - 63s/epoch - 34ms/step
Epoch 25/50
1876/1876 - 62s - loss: 8.2615 - accuracy10: 0.6806 - accuracy20: 0.6680 - accuracy30: 0.6442 - accuracy50: 0.6095 - val_loss: 8.3519 - val_accuracy10: 0.7349 - val_accuracy20: 0.7068 - val_accuracy30: 0.6734 - val_accuracy50: 0.6189 - 62s/epoch - 33ms/step
Epoch 26/50
1876/1876 - 62s - loss: 8.2486 - accuracy10: 0.6809 - accuracy20: 0.6680 - accuracy30: 0.6445 - accuracy50: 0.6095 - val_loss: 8.3917 - val_accuracy10: 0.7352 - val_accuracy20: 0.7065 - val_accuracy30: 0.6733 - val_accuracy50: 0.6187 - 62s/epoch - 33ms/step
Epoch 27/50
1876/1876 - 62s - loss: 8.2350 - accuracy10: 0.6807 - accuracy20: 0.6683 - accuracy30: 0.6449 - accuracy50: 0.6104 - val_loss: 8.4204 - val_accuracy10: 0.7342 - val_accuracy20: 0.7070 - val_accuracy30: 0.6735 - val_accuracy50: 0.6194 - 62s/epoch - 33ms/step
Epoch 28/50
1876/1876 - 61s - loss: 8.2248 - accuracy10: 0.6818 - accuracy20: 0.6695 - accuracy30: 0.6460 - accuracy50: 0.6114 - val_loss: 8.4341 - val_accuracy10: 0.7393 - val_accuracy20: 0.7123 - val_accuracy30: 0.6810 - val_accuracy50: 0.6239 - 61s/epoch - 33ms/step
testing model: results/EXC/W3/deepVOL_L2/seq2seq
Evaluating performance on  test set...
5098/5098 - 75s - 75s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.60990787
{'0': {'precision': 0.3679246140836362, 'recall': 0.7920668685075951, 'f1-score': 0.5024535115949378, 'support': 153256}, '1': {'precision': 0.9287007127443928, 'recall': 0.7104315125298001, 'f1-score': 0.8050335926159162, 'support': 999577}, '2': {'precision': 0.4263497708384839, 'recall': 0.589664514262418, 'f1-score': 0.49488148781766506, 'support': 152078}, 'accuracy': 0.7059446966114931, 'macro avg': {'precision': 0.5743250325555044, 'recall': 0.6973876317666043, 'f1-score': 0.600789530676173, 'support': 1304911}, 'weighted avg': {'precision': 0.8042946587533392, 'recall': 0.7059446966114931, 'f1-score': 0.733350907214031, 'support': 1304911}}
[[121389  18716  13151]
 [181940 710131 107506]
 [ 26600  35803  89675]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6580692
{'0': {'precision': 0.4363817586018569, 'recall': 0.7602390093291659, 'f1-score': 0.554485505750337, 'support': 210201}, '1': {'precision': 0.872380250175077, 'recall': 0.6906663150730008, 'f1-score': 0.7709605921244629, 'support': 887388}, '2': {'precision': 0.4930662296803479, 'recall': 0.5616577111932164, 'f1-score': 0.525131627901733, 'support': 207322}, 'accuracy': 0.6813767375706082, 'macro avg': {'precision': 0.600609412819094, 'recall': 0.6708543451984609, 'f1-score': 0.6168592419255109, 'support': 1304911}, 'weighted avg': {'precision': 0.7418828750405347, 'recall': 0.6813767375706082, 'f1-score': 0.6970329203127359, 'support': 1304911}}
[[159803  32831  17567]
 [172347 612889 102152]
 [ 34050  56828 116444]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.72030413
{'0': {'precision': 0.46807177095412944, 'recall': 0.7315207347686598, 'f1-score': 0.5708675307312364, 'support': 252161}, '1': {'precision': 0.8168164174257303, 'recall': 0.6562913150230122, 'f1-score': 0.7278076259006684, 'support': 804792}, '2': {'precision': 0.5171427057389646, 'recall': 0.5510046056186935, 'f1-score': 0.5335369187272528, 'support': 247958}, 'accuracy': 0.6508221633506039, 'macro avg': {'precision': 0.6006769647062747, 'recall': 0.6462722184701218, 'f1-score': 0.6107373584530525, 'support': 1304911}, 'weighted avg': {'precision': 0.6924812765606809, 'recall': 0.6508221633506039, 'f1-score': 0.6605653792284241, 'support': 1304911}}
[[184461  46246  21454]
 [170500 528178 106114]
 [ 39126  72206 136626]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8211316
{'0': {'precision': 0.5033706856640747, 'recall': 0.6705379280832694, 'f1-score': 0.5750518101159252, 'support': 317812}, '1': {'precision': 0.6996578813562175, 'recall': 0.6155809488821867, 'f1-score': 0.6549320968878201, 'support': 675068}, '2': {'precision': 0.5425838551644768, 'recall': 0.5001169755569158, 'f1-score': 0.5204856247081584, 'support': 312031}, 'accuracy': 0.6013559545440263, 'macro avg': {'precision': 0.581870807394923, 'recall': 0.5954119508407906, 'f1-score': 0.5834898439039679, 'support': 1304911}, 'weighted avg': {'precision': 0.6142923723644576, 'recall': 0.6013559545440263, 'f1-score': 0.6033282857005119, 'support': 1304911}}
[[213105  74602  30105]
 [158057 415559 101452]
 [ 52194 103785 156052]]
Evaluating performance on  train set...
1876/1876 - 27s - 27s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6291506
{'0': {'precision': 0.35715852677592075, 'recall': 0.7772748169890724, 'f1-score': 0.48942554458862886, 'support': 56554}, '1': {'precision': 0.9322689732583117, 'recall': 0.7099307726968609, 'f1-score': 0.8060486358943194, 'support': 366185}, '2': {'precision': 0.43111003232111605, 'recall': 0.5872137537412125, 'f1-score': 0.49719695016391025, 'support': 57468}, 'accuracy': 0.7031759220502825, 'macro avg': {'precision': 0.5735125107851162, 'recall': 0.6914731144757154, 'f1-score': 0.5975570435489528, 'support': 480207}, 'weighted avg': {'precision': 0.8045628002784428, 'recall': 0.7031759220502825, 'f1-score': 0.7317985916816002, 'support': 480207}}
[[ 43958   6721   5875]
 [ 67563 259966  38656]
 [ 11556  12166  33746]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.67052543
{'0': {'precision': 0.4218037617462947, 'recall': 0.7482511117468078, 'f1-score': 0.5394877467984175, 'support': 76906}, '1': {'precision': 0.8812081503067842, 'recall': 0.6975696294539597, 'f1-score': 0.7787087590939722, 'support': 324683}, '2': {'precision': 0.5073075149838635, 'recall': 0.5598463456205958, 'f1-score': 0.5322836169260724, 'support': 78618}, 'accuracy': 0.683138729756126, 'macro avg': {'precision': 0.6034398090123142, 'recall': 0.6685556956071211, 'f1-score': 0.6168267076061541, 'support': 480207}, 'weighted avg': {'precision': 0.7464198734710646, 'recall': 0.683138729756126, 'f1-score': 0.7000531314197445, 'support': 480207}}
[[ 57545  11524   7837]
 [ 63285 226489  34909]
 [ 15596  19008  44014]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.72578734
{'0': {'precision': 0.44981546555017093, 'recall': 0.7233814640331413, 'f1-score': 0.5547034122054867, 'support': 91487}, '1': {'precision': 0.8314498636981272, 'recall': 0.6677579516377747, 'f1-score': 0.74066750745716, 'support': 295065}, '2': {'precision': 0.5318606538613614, 'recall': 0.5457797234530991, 'f1-score': 0.5387302975848567, 'support': 93655}, 'accuracy': 0.6545656352364709, 'macro avg': {'precision': 0.6043753277032199, 'recall': 0.6456397130413384, 'f1-score': 0.6113670724158344, 'support': 480207}, 'weighted avg': {'precision': 0.7003134712035897, 'recall': 0.6545656352364709, 'f1-score': 0.6658545068701625, 'support': 480207}}
[[ 66180  15952   9355]
 [ 62397 197032  35636]
 [ 18550  23990  51115]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8159029
{'0': {'precision': 0.48381232303141253, 'recall': 0.6674006693405335, 'f1-score': 0.5609677277200816, 'support': 114441}, '1': {'precision': 0.7240905375725447, 'recall': 0.636519449450695, 'f1-score': 0.677486884153323, 'support': 249133}, '2': {'precision': 0.5615220105093045, 'recall': 0.49750928124973204, 'f1-score': 0.5275810337773332, 'support': 116633}, 'accuracy': 0.6101160541183281, 'macro avg': {'precision': 0.5898082903710873, 'recall': 0.6004764666803202, 'f1-score': 0.588678548550246, 'support': 480207}, 'weighted avg': {'precision': 0.6273436468207052, 'recall': 0.6101160541183281, 'f1-score': 0.613309273605623, 'support': 480207}}
[[ 76378  26010  12053]
 [ 57297 158578  33258]
 [ 24192  34415  58026]]
Evaluating performance on  val set...
619/619 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5594241
{'0': {'precision': 0.35870641293587063, 'recall': 0.7911687996603385, 'f1-score': 0.49361412272237043, 'support': 16487}, '1': {'precision': 0.9357561453687221, 'recall': 0.7480692665611359, 'f1-score': 0.8314524871598927, 'support': 125082}, '2': {'precision': 0.44344508040337965, 'recall': 0.5809676843420818, 'f1-score': 0.5029755004250716, 'support': 16803}, 'accuracy': 0.7348268633344278, 'macro avg': {'precision': 0.5793025462359908, 'recall': 0.706735250187852, 'f1-score': 0.6093473701024449, 'support': 158372}, 'weighted avg': {'precision': 0.8234501710599235, 'recall': 0.7348268633344278, 'f1-score': 0.7614316506320554, 'support': 158372}}
[[13044  2159  1284]
 [20544 93570 10968]
 [ 2776  4265  9762]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6135581
{'0': {'precision': 0.4266584917228694, 'recall': 0.7563584191991652, 'f1-score': 0.5455657300551933, 'support': 23001}, '1': {'precision': 0.8816465256797583, 'recall': 0.7309591540980087, 'f1-score': 0.7992624690657615, 'support': 111786}, '2': {'precision': 0.5254244090380061, 'recall': 0.5550985796056815, 'f1-score': 0.5398540266380768, 'support': 23585}, 'accuracy': 0.7084585659081151, 'macro avg': {'precision': 0.6112431421468779, 'recall': 0.6808053843009518, 'f1-score': 0.6282274085863438, 'support': 158372}, 'weighted avg': {'precision': 0.7625176494261394, 'recall': 0.7084585659081151, 'f1-score': 0.7237855741055473, 'support': 158372}}
[[17397  3944  1660]
 [19910 81711 10165]
 [ 3468  7025 13092]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.68169594
{'0': {'precision': 0.4561996888317662, 'recall': 0.7248754971158324, 'f1-score': 0.5599778577359535, 'support': 27911}, '1': {'precision': 0.8272227580677025, 'recall': 0.6997375431284466, 'f1-score': 0.7581583095471391, 'support': 101731}, '2': {'precision': 0.5536288880943868, 'recall': 0.5389836407935955, 'f1-score': 0.5462081128747795, 'support': 28730}, 'accuracy': 0.6750056828227212, 'macro avg': {'precision': 0.6123504449979519, 'recall': 0.6545322270126248, 'f1-score': 0.6214480933859574, 'support': 158372}, 'weighted avg': {'precision': 0.7122025728722288, 'recall': 0.6750056828227212, 'f1-score': 0.6847820578050452, 'support': 158372}}
[[20232  5655  2024]
 [20085 71185 10461]
 [ 4032  9213 15485]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.79136854
{'0': {'precision': 0.4927410168789479, 'recall': 0.6618632987453751, 'f1-score': 0.5649159464336593, 'support': 35947}, '1': {'precision': 0.7112421126725157, 'recall': 0.6618206060889601, 'f1-score': 0.685641929757599, 'support': 85499}, '2': {'precision': 0.5846244554358151, 'recall': 0.4833450685154092, 'f1-score': 0.5291824179082351, 'support': 36926}, 'accuracy': 0.620216957543, 'macro avg': {'precision': 0.5962025283290929, 'recall': 0.6023429911165815, 'f1-score': 0.5932467646998312, 'support': 158372}, 'weighted avg': {'precision': 0.6321249549576811, 'recall': 0.620216957543, 'f1-score': 0.6217596724324704, 'support': 158372}}
[[23792  9434  2721]
 [18954 56585  9960]
 [ 5539 13539 17848]]
training model: results/EXC/W3/deepVOL_L3/seq2seq
Epoch 1/50
1876/1876 - 93s - loss: 10.0445 - accuracy10: 0.5950 - accuracy20: 0.5985 - accuracy30: 0.5866 - accuracy50: 0.5612 - val_loss: 9.3649 - val_accuracy10: 0.7034 - val_accuracy20: 0.6857 - val_accuracy30: 0.6593 - val_accuracy50: 0.6037 - 93s/epoch - 50ms/step
Epoch 2/50
1876/1876 - 87s - loss: 9.2696 - accuracy10: 0.6443 - accuracy20: 0.6398 - accuracy30: 0.6192 - accuracy50: 0.5843 - val_loss: 9.2026 - val_accuracy10: 0.7423 - val_accuracy20: 0.7186 - val_accuracy30: 0.6874 - val_accuracy50: 0.6247 - 87s/epoch - 46ms/step
Epoch 3/50
1876/1876 - 84s - loss: 8.9853 - accuracy10: 0.6539 - accuracy20: 0.6478 - accuracy30: 0.6261 - accuracy50: 0.5904 - val_loss: 9.2329 - val_accuracy10: 0.7624 - val_accuracy20: 0.7333 - val_accuracy30: 0.6976 - val_accuracy50: 0.6300 - 84s/epoch - 45ms/step
Epoch 4/50
1876/1876 - 85s - loss: 8.7949 - accuracy10: 0.6624 - accuracy20: 0.6550 - accuracy30: 0.6322 - accuracy50: 0.5959 - val_loss: 8.9448 - val_accuracy10: 0.7649 - val_accuracy20: 0.7328 - val_accuracy30: 0.6968 - val_accuracy50: 0.6319 - 85s/epoch - 45ms/step
Epoch 5/50
1876/1876 - 85s - loss: 8.6757 - accuracy10: 0.6677 - accuracy20: 0.6582 - accuracy30: 0.6358 - accuracy50: 0.5997 - val_loss: 8.8192 - val_accuracy10: 0.7534 - val_accuracy20: 0.7267 - val_accuracy30: 0.6938 - val_accuracy50: 0.6325 - 85s/epoch - 46ms/step
Epoch 6/50
1876/1876 - 84s - loss: 8.6002 - accuracy10: 0.6702 - accuracy20: 0.6602 - accuracy30: 0.6366 - accuracy50: 0.6004 - val_loss: 8.5914 - val_accuracy10: 0.7489 - val_accuracy20: 0.7221 - val_accuracy30: 0.6892 - val_accuracy50: 0.6308 - 84s/epoch - 45ms/step
Epoch 7/50
1876/1876 - 87s - loss: 8.5560 - accuracy10: 0.6716 - accuracy20: 0.6606 - accuracy30: 0.6373 - accuracy50: 0.6016 - val_loss: 8.6190 - val_accuracy10: 0.7490 - val_accuracy20: 0.7181 - val_accuracy30: 0.6847 - val_accuracy50: 0.6258 - 87s/epoch - 46ms/step
Epoch 8/50
1876/1876 - 88s - loss: 8.5197 - accuracy10: 0.6720 - accuracy20: 0.6613 - accuracy30: 0.6386 - accuracy50: 0.6024 - val_loss: 8.4185 - val_accuracy10: 0.7410 - val_accuracy20: 0.7134 - val_accuracy30: 0.6810 - val_accuracy50: 0.6261 - 88s/epoch - 47ms/step
Epoch 9/50
1876/1876 - 85s - loss: 8.4837 - accuracy10: 0.6729 - accuracy20: 0.6617 - accuracy30: 0.6388 - accuracy50: 0.6033 - val_loss: 8.3891 - val_accuracy10: 0.7372 - val_accuracy20: 0.7107 - val_accuracy30: 0.6793 - val_accuracy50: 0.6250 - 85s/epoch - 45ms/step
Epoch 10/50
1876/1876 - 85s - loss: 8.4514 - accuracy10: 0.6738 - accuracy20: 0.6628 - accuracy30: 0.6397 - accuracy50: 0.6042 - val_loss: 8.4025 - val_accuracy10: 0.7375 - val_accuracy20: 0.7105 - val_accuracy30: 0.6784 - val_accuracy50: 0.6240 - 85s/epoch - 45ms/step
Epoch 11/50
1876/1876 - 85s - loss: 8.4258 - accuracy10: 0.6746 - accuracy20: 0.6630 - accuracy30: 0.6401 - accuracy50: 0.6049 - val_loss: 8.3878 - val_accuracy10: 0.7366 - val_accuracy20: 0.7085 - val_accuracy30: 0.6773 - val_accuracy50: 0.6232 - 85s/epoch - 46ms/step
Epoch 12/50
1876/1876 - 85s - loss: 8.4005 - accuracy10: 0.6758 - accuracy20: 0.6639 - accuracy30: 0.6413 - accuracy50: 0.6066 - val_loss: 8.3802 - val_accuracy10: 0.7297 - val_accuracy20: 0.7035 - val_accuracy30: 0.6731 - val_accuracy50: 0.6210 - 85s/epoch - 45ms/step
Epoch 13/50
1876/1876 - 85s - loss: 8.3801 - accuracy10: 0.6763 - accuracy20: 0.6644 - accuracy30: 0.6416 - accuracy50: 0.6064 - val_loss: 8.4004 - val_accuracy10: 0.7369 - val_accuracy20: 0.7097 - val_accuracy30: 0.6770 - val_accuracy50: 0.6228 - 85s/epoch - 45ms/step
Epoch 14/50
1876/1876 - 89s - loss: 8.3595 - accuracy10: 0.6771 - accuracy20: 0.6650 - accuracy30: 0.6423 - accuracy50: 0.6073 - val_loss: 8.3388 - val_accuracy10: 0.7370 - val_accuracy20: 0.7087 - val_accuracy30: 0.6776 - val_accuracy50: 0.6238 - 89s/epoch - 48ms/step
Epoch 15/50
1876/1876 - 87s - loss: 8.3418 - accuracy10: 0.6782 - accuracy20: 0.6663 - accuracy30: 0.6431 - accuracy50: 0.6076 - val_loss: 8.3062 - val_accuracy10: 0.7324 - val_accuracy20: 0.7052 - val_accuracy30: 0.6745 - val_accuracy50: 0.6218 - 87s/epoch - 46ms/step
Epoch 16/50
1876/1876 - 86s - loss: 8.3238 - accuracy10: 0.6790 - accuracy20: 0.6666 - accuracy30: 0.6441 - accuracy50: 0.6084 - val_loss: 8.2969 - val_accuracy10: 0.7274 - val_accuracy20: 0.7020 - val_accuracy30: 0.6716 - val_accuracy50: 0.6201 - 86s/epoch - 46ms/step
Epoch 17/50
1876/1876 - 86s - loss: 8.3095 - accuracy10: 0.6792 - accuracy20: 0.6668 - accuracy30: 0.6444 - accuracy50: 0.6094 - val_loss: 8.2979 - val_accuracy10: 0.7300 - val_accuracy20: 0.7039 - val_accuracy30: 0.6737 - val_accuracy50: 0.6219 - 86s/epoch - 46ms/step
Epoch 18/50
1876/1876 - 86s - loss: 8.2935 - accuracy10: 0.6798 - accuracy20: 0.6673 - accuracy30: 0.6452 - accuracy50: 0.6096 - val_loss: 8.2979 - val_accuracy10: 0.7296 - val_accuracy20: 0.7011 - val_accuracy30: 0.6705 - val_accuracy50: 0.6191 - 86s/epoch - 46ms/step
Epoch 19/50
1876/1876 - 86s - loss: 8.2758 - accuracy10: 0.6801 - accuracy20: 0.6678 - accuracy30: 0.6454 - accuracy50: 0.6104 - val_loss: 8.3650 - val_accuracy10: 0.7200 - val_accuracy20: 0.6943 - val_accuracy30: 0.6663 - val_accuracy50: 0.6178 - 86s/epoch - 46ms/step
Epoch 20/50
1876/1876 - 86s - loss: 8.2610 - accuracy10: 0.6807 - accuracy20: 0.6687 - accuracy30: 0.6459 - accuracy50: 0.6108 - val_loss: 8.2965 - val_accuracy10: 0.7253 - val_accuracy20: 0.6983 - val_accuracy30: 0.6686 - val_accuracy50: 0.6179 - 86s/epoch - 46ms/step
Epoch 21/50
1876/1876 - 86s - loss: 8.2505 - accuracy10: 0.6810 - accuracy20: 0.6682 - accuracy30: 0.6461 - accuracy50: 0.6112 - val_loss: 8.3275 - val_accuracy10: 0.7253 - val_accuracy20: 0.6970 - val_accuracy30: 0.6671 - val_accuracy50: 0.6169 - 86s/epoch - 46ms/step
Epoch 22/50
1876/1876 - 87s - loss: 8.2389 - accuracy10: 0.6823 - accuracy20: 0.6697 - accuracy30: 0.6474 - accuracy50: 0.6118 - val_loss: 8.3029 - val_accuracy10: 0.7259 - val_accuracy20: 0.6983 - val_accuracy30: 0.6684 - val_accuracy50: 0.6172 - 87s/epoch - 46ms/step
Epoch 23/50
1876/1876 - 84s - loss: 8.2210 - accuracy10: 0.6825 - accuracy20: 0.6697 - accuracy30: 0.6473 - accuracy50: 0.6119 - val_loss: 8.2655 - val_accuracy10: 0.7257 - val_accuracy20: 0.6985 - val_accuracy30: 0.6693 - val_accuracy50: 0.6168 - 84s/epoch - 45ms/step
Epoch 24/50
1876/1876 - 85s - loss: 8.2058 - accuracy10: 0.6828 - accuracy20: 0.6700 - accuracy30: 0.6476 - accuracy50: 0.6130 - val_loss: 8.4171 - val_accuracy10: 0.7306 - val_accuracy20: 0.7033 - val_accuracy30: 0.6739 - val_accuracy50: 0.6210 - 85s/epoch - 45ms/step
Epoch 25/50
1876/1876 - 86s - loss: 8.1924 - accuracy10: 0.6828 - accuracy20: 0.6707 - accuracy30: 0.6481 - accuracy50: 0.6135 - val_loss: 8.3601 - val_accuracy10: 0.7267 - val_accuracy20: 0.6988 - val_accuracy30: 0.6693 - val_accuracy50: 0.6163 - 86s/epoch - 46ms/step
Epoch 26/50
1876/1876 - 89s - loss: 8.1787 - accuracy10: 0.6838 - accuracy20: 0.6713 - accuracy30: 0.6493 - accuracy50: 0.6141 - val_loss: 8.3865 - val_accuracy10: 0.7267 - val_accuracy20: 0.6991 - val_accuracy30: 0.6697 - val_accuracy50: 0.6158 - 89s/epoch - 47ms/step
Epoch 27/50
1876/1876 - 87s - loss: 8.1661 - accuracy10: 0.6838 - accuracy20: 0.6718 - accuracy30: 0.6498 - accuracy50: 0.6147 - val_loss: 8.4839 - val_accuracy10: 0.7296 - val_accuracy20: 0.7014 - val_accuracy30: 0.6711 - val_accuracy50: 0.6175 - 87s/epoch - 46ms/step
Epoch 28/50
1876/1876 - 86s - loss: 8.1518 - accuracy10: 0.6846 - accuracy20: 0.6725 - accuracy30: 0.6504 - accuracy50: 0.6151 - val_loss: 8.4340 - val_accuracy10: 0.7306 - val_accuracy20: 0.7000 - val_accuracy30: 0.6704 - val_accuracy50: 0.6180 - 86s/epoch - 46ms/step
Epoch 29/50
1876/1876 - 86s - loss: 8.1412 - accuracy10: 0.6846 - accuracy20: 0.6722 - accuracy30: 0.6502 - accuracy50: 0.6147 - val_loss: 8.4276 - val_accuracy10: 0.7240 - val_accuracy20: 0.6940 - val_accuracy30: 0.6642 - val_accuracy50: 0.6126 - 86s/epoch - 46ms/step
Epoch 30/50
1876/1876 - 85s - loss: 8.1258 - accuracy10: 0.6855 - accuracy20: 0.6729 - accuracy30: 0.6507 - accuracy50: 0.6155 - val_loss: 8.4752 - val_accuracy10: 0.7280 - val_accuracy20: 0.6996 - val_accuracy30: 0.6687 - val_accuracy50: 0.6160 - 85s/epoch - 45ms/step
Epoch 31/50
1876/1876 - 83s - loss: 8.1098 - accuracy10: 0.6853 - accuracy20: 0.6731 - accuracy30: 0.6511 - accuracy50: 0.6159 - val_loss: 8.4039 - val_accuracy10: 0.7316 - val_accuracy20: 0.7030 - val_accuracy30: 0.6721 - val_accuracy50: 0.6181 - 83s/epoch - 44ms/step
Epoch 32/50
1876/1876 - 85s - loss: 8.0957 - accuracy10: 0.6856 - accuracy20: 0.6739 - accuracy30: 0.6519 - accuracy50: 0.6162 - val_loss: 8.5486 - val_accuracy10: 0.7350 - val_accuracy20: 0.7056 - val_accuracy30: 0.6745 - val_accuracy50: 0.6194 - 85s/epoch - 45ms/step
Epoch 33/50
1876/1876 - 83s - loss: 8.0832 - accuracy10: 0.6855 - accuracy20: 0.6739 - accuracy30: 0.6524 - accuracy50: 0.6172 - val_loss: 8.3893 - val_accuracy10: 0.7262 - val_accuracy20: 0.6984 - val_accuracy30: 0.6700 - val_accuracy50: 0.6180 - 83s/epoch - 44ms/step
testing model: results/EXC/W3/deepVOL_L3/seq2seq
Evaluating performance on  test set...
5098/5098 - 104s - 104s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6237967
{'0': {'precision': 0.34909812841138804, 'recall': 0.8192175184005847, 'f1-score': 0.48957198033913246, 'support': 153256}, '1': {'precision': 0.9383448672251785, 'recall': 0.6892365470594062, 'f1-score': 0.7947271584217236, 'support': 999577}, '2': {'precision': 0.4293579459577271, 'recall': 0.5958718552321834, 'f1-score': 0.4990926239552783, 'support': 152078}, 'accuracy': 0.6936212507979471, 'macro avg': {'precision': 0.5722669805314312, 'recall': 0.7014419735640581, 'f1-score': 0.594463920905378, 'support': 1304911}, 'weighted avg': {'precision': 0.809821687317769, 'recall': 0.6936212507979471, 'f1-score': 0.724433957808951, 'support': 1304911}}
[[125550  14745  12961]
 [203155 688945 107477]
 [ 30936  30523  90619]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.67102444
{'0': {'precision': 0.41675924138052095, 'recall': 0.7906432414688798, 'f1-score': 0.5458128208243976, 'support': 210201}, '1': {'precision': 0.8871576966514926, 'recall': 0.6630188823829035, 'f1-score': 0.7588842619434418, 'support': 887388}, '2': {'precision': 0.4923377088452847, 'recall': 0.5769286424016747, 'f1-score': 0.5312871309117965, 'support': 207322}, 'accuracy': 0.6698993264674755, 'macro avg': {'precision': 0.5987515489590994, 'recall': 0.6768635887511527, 'f1-score': 0.611994737893212, 'support': 1304911}, 'weighted avg': {'precision': 0.7486554576418036, 'recall': 0.6698993264674755, 'f1-score': 0.6884015068786083, 'support': 1304911}}
[[166194  26850  17157]
 [192857 588355 106176]
 [ 39726  47986 119610]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7283154
{'0': {'precision': 0.45172998739587383, 'recall': 0.7561359607552318, 'f1-score': 0.565574828141106, 'support': 252161}, '1': {'precision': 0.8327711025416993, 'recall': 0.6300522370997723, 'f1-score': 0.7173652237146276, 'support': 804792}, '2': {'precision': 0.514012039000814, 'recall': 0.567878431024609, 'f1-score': 0.5396042544467246, 'support': 247958}, 'accuracy': 0.6426024456840351, 'macro avg': {'precision': 0.5995043763127957, 'recall': 0.6513555429598711, 'f1-score': 0.6075147687674861, 'support': 1304911}, 'weighted avg': {'precision': 0.6985684109299669, 'recall': 0.6426024456840351, 'f1-score': 0.6542552703492674, 'support': 1304911}}
[[190668  39739  21754]
 [186352 507061 111379]
 [ 45064  62084 140810]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.825499
{'0': {'precision': 0.48785095404769574, 'recall': 0.6955558632147307, 'f1-score': 0.573475809861804, 'support': 317812}, '1': {'precision': 0.7150512043848262, 'recall': 0.5874904454069813, 'f1-score': 0.6450246725238837, 'support': 675068}, '2': {'precision': 0.5383629088437114, 'recall': 0.512686239508254, 'f1-score': 0.5252109392954464, 'support': 312031}, 'accuracy': 0.5959226338041445, 'macro avg': {'precision': 0.5804216890920778, 'recall': 0.598577516043322, 'f1-score': 0.5812371405603781, 'support': 1304911}, 'weighted avg': {'precision': 0.6174666246654937, 'recall': 0.5959226338041445, 'f1-score': 0.5989489737725027, 'support': 1304911}}
[[221056  65410  31346]
 [172643 396596 105829]
 [ 59423  92634 159974]]
Evaluating performance on  train set...
1876/1876 - 40s - 40s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.64962864
{'0': {'precision': 0.34699775232794605, 'recall': 0.8025603847650034, 'f1-score': 0.4845107709387477, 'support': 56554}, '1': {'precision': 0.9429056707287287, 'recall': 0.6852465283941177, 'f1-score': 0.7936884989229899, 'support': 366185}, '2': {'precision': 0.41946832524854716, 'recall': 0.6079035289204426, 'f1-score': 0.49640502444015, 'support': 57468}, 'accuracy': 0.6898066875326682, 'macro avg': {'precision': 0.5697905827684073, 'recall': 0.6985701473598546, 'f1-score': 0.5915347647672959, 'support': 480207}, 'weighted avg': {'precision': 0.8100840463307234, 'recall': 0.6898066875326682, 'f1-score': 0.7216997025497578, 'support': 480207}}
[[ 45388   5057   6109]
 [ 73018 250927  42240]
 [ 12396  10137  34935]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6843297
{'0': {'precision': 0.41314797064235587, 'recall': 0.7678204561412634, 'f1-score': 0.5372259851796591, 'support': 76906}, '1': {'precision': 0.8950508184091592, 'recall': 0.6691234219223058, 'f1-score': 0.7657707830316702, 'support': 324683}, '2': {'precision': 0.49332120609605196, 'recall': 0.5933119641812308, 'f1-score': 0.5387160667779247, 'support': 78618}, 'accuracy': 0.6725183098122268, 'macro avg': {'precision': 0.600506665049189, 'recall': 0.6767519474149334, 'f1-score': 0.6139042783297514, 'support': 480207}, 'weighted avg': {'precision': 0.7521032997949249, 'recall': 0.6725183098122268, 'f1-score': 0.6919962360008195, 'support': 480207}}
[[ 59050   9358   8498]
 [ 68020 217253  39410]
 [ 15857  16116  46645]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.73279774
{'0': {'precision': 0.4467726284089008, 'recall': 0.7297102320548274, 'f1-score': 0.5542189679218968, 'support': 91487}, '1': {'precision': 0.8462937293582276, 'recall': 0.6435090573263518, 'f1-score': 0.7311003642468253, 'support': 295065}, '2': {'precision': 0.5188265253385204, 'recall': 0.5895360632107202, 'f1-score': 0.5519257874586403, 'support': 93655}, 'accuracy': 0.6494053606049058, 'macro avg': {'precision': 0.6039642943685496, 'recall': 0.6542517841972998, 'f1-score': 0.6124150398757875, 'support': 480207}, 'weighted avg': {'precision': 0.7063125796560851, 'recall': 0.6494053606049058, 'f1-score': 0.6624571680945907, 'support': 480207}}
[[ 66759  13878  10850]
 [ 64832 189877  40356]
 [ 17834  20608  55213]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.81734776
{'0': {'precision': 0.4819655815359806, 'recall': 0.6685803164949625, 'f1-score': 0.5601388029707935, 'support': 114441}, '1': {'precision': 0.7399782209215272, 'recall': 0.6109788747375899, 'f1-score': 0.6693196433871622, 'support': 249133}, '2': {'precision': 0.5478734892400197, 'recall': 0.5437397649035864, 'f1-score': 0.5457988002719613, 'support': 116633}, 'accuracy': 0.6083751382216419, 'macro avg': {'precision': 0.5899390972325091, 'recall': 0.6077663187120462, 'f1-score': 0.5917524155433056, 'support': 480207}, 'weighted avg': {'precision': 0.6318311601037327, 'recall': 0.6083751382216419, 'f1-score': 0.6132992791418578, 'support': 480207}}
[[ 76513  23041  14887]
 [ 59470 152215  37448]
 [ 22769  30446  63418]]
Evaluating performance on  val set...
619/619 - 13s - 13s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5637878
{'0': {'precision': 0.3454733574754268, 'recall': 0.8100928003881847, 'f1-score': 0.48437811666999114, 'support': 16487}, '1': {'precision': 0.9413721584491858, 'recall': 0.7329911578004829, 'f1-score': 0.8242147467592009, 'support': 125082}, '2': {'precision': 0.44112375660901515, 'recall': 0.5859072784621794, 'f1-score': 0.5033102425807111, 'support': 16803}, 'accuracy': 0.7254123203596595, 'macro avg': {'precision': 0.5759897575112093, 'recall': 0.7096637455502823, 'f1-score': 0.6039677020033011, 'support': 158372}, 'weighted avg': {'precision': 0.826261801645112, 'recall': 0.7254123203596595, 'f1-score': 0.754789312313769, 'support': 158372}}
[[13356  1878  1253]
 [22178 91684 11220]
 [ 3126  3832  9845]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6187449
{'0': {'precision': 0.41322525200910487, 'recall': 0.7734881092126429, 'f1-score': 0.5386723185224433, 'support': 23001}, '1': {'precision': 0.889018246949513, 'recall': 0.7104288551339166, 'f1-score': 0.7897531772708287, 'support': 111786}, '2': {'precision': 0.5150454055718023, 'recall': 0.5675217299130804, 'f1-score': 0.5400116999172937, 'support': 23585}, 'accuracy': 0.6983052559795924, 'macro avg': {'precision': 0.6057629681768067, 'recall': 0.6838128980865467, 'f1-score': 0.6228123985701886, 'support': 158372}, 'weighted avg': {'precision': 0.7642243178426151, 'recall': 0.6983052559795924, 'f1-score': 0.7160958162761153, 'support': 158372}}
[[17791  3528  1682]
 [21449 79416 10921]
 [ 3814  6386 13385]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6825892
{'0': {'precision': 0.4477817942819586, 'recall': 0.7322919279137258, 'f1-score': 0.5557398444722388, 'support': 27911}, '1': {'precision': 0.8352204898165901, 'recall': 0.6808544101601282, 'f1-score': 0.7501787068125204, 'support': 101731}, '2': {'precision': 0.5432243774749983, 'recall': 0.563418029933867, 'f1-score': 0.5531369600874796, 'support': 28730}, 'accuracy': 0.6686156643851185, 'macro avg': {'precision': 0.6087422205245157, 'recall': 0.658854789335907, 'f1-score': 0.619685170457413, 'support': 158372}, 'weighted avg': {'precision': 0.7139689444762457, 'recall': 0.6686156643851185, 'f1-score': 0.6801663784325668, 'support': 158372}}
[[20439  5330  2142]
 [20998 69264 11469]
 [ 4208  8335 16187]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7912768
{'0': {'precision': 0.4865237024887107, 'recall': 0.6683728822989401, 'f1-score': 0.5631313723192313, 'support': 35947}, '1': {'precision': 0.7190254764555636, 'recall': 0.6420425969894384, 'f1-score': 0.6783569363090384, 'support': 85499}, '2': {'precision': 0.5741943389290528, 'recall': 0.5076098142230406, 'f1-score': 0.5388529538594222, 'support': 36926}, 'accuracy': 0.6166746647134594, 'macro avg': {'precision': 0.593247839291109, 'recall': 0.6060084311704731, 'f1-score': 0.5934470874958973, 'support': 158372}, 'weighted avg': {'precision': 0.6324838159783935, 'recall': 0.6166746647134594, 'f1-score': 0.6196765041324155, 'support': 158372}}
[[24026  8897  3024]
 [19729 54894 10876]
 [ 5628 12554 18744]]
training model: results/EXC/W4/deepLOB_L1/seq2seq
Epoch 1/50
1601/1601 - 52s - loss: 10.8156 - accuracy10: 0.5133 - accuracy20: 0.5307 - accuracy30: 0.5324 - accuracy50: 0.5246 - val_loss: 10.8699 - val_accuracy10: 0.6781 - val_accuracy20: 0.6533 - val_accuracy30: 0.6228 - val_accuracy50: 0.5540 - 52s/epoch - 32ms/step
Epoch 2/50
1601/1601 - 45s - loss: 9.9070 - accuracy10: 0.6050 - accuracy20: 0.6055 - accuracy30: 0.5907 - accuracy50: 0.5617 - val_loss: 9.4900 - val_accuracy10: 0.6376 - val_accuracy20: 0.6398 - val_accuracy30: 0.6278 - val_accuracy50: 0.5857 - 45s/epoch - 28ms/step
Epoch 3/50
1601/1601 - 44s - loss: 9.5041 - accuracy10: 0.6335 - accuracy20: 0.6248 - accuracy30: 0.6035 - accuracy50: 0.5703 - val_loss: 9.3201 - val_accuracy10: 0.6786 - val_accuracy20: 0.6695 - val_accuracy30: 0.6480 - val_accuracy50: 0.5958 - 44s/epoch - 27ms/step
Epoch 4/50
1601/1601 - 43s - loss: 9.3272 - accuracy10: 0.6435 - accuracy20: 0.6327 - accuracy30: 0.6094 - accuracy50: 0.5749 - val_loss: 9.3669 - val_accuracy10: 0.7055 - val_accuracy20: 0.6895 - val_accuracy30: 0.6619 - val_accuracy50: 0.6031 - 43s/epoch - 27ms/step
Epoch 5/50
1601/1601 - 44s - loss: 9.2256 - accuracy10: 0.6470 - accuracy20: 0.6364 - accuracy30: 0.6136 - accuracy50: 0.5773 - val_loss: 9.4049 - val_accuracy10: 0.7253 - val_accuracy20: 0.7009 - val_accuracy30: 0.6684 - val_accuracy50: 0.6052 - 44s/epoch - 27ms/step
Epoch 6/50
1601/1601 - 44s - loss: 9.1542 - accuracy10: 0.6508 - accuracy20: 0.6396 - accuracy30: 0.6161 - accuracy50: 0.5799 - val_loss: 9.3033 - val_accuracy10: 0.7175 - val_accuracy20: 0.6962 - val_accuracy30: 0.6664 - val_accuracy50: 0.6068 - 44s/epoch - 27ms/step
Epoch 7/50
1601/1601 - 44s - loss: 9.1026 - accuracy10: 0.6527 - accuracy20: 0.6420 - accuracy30: 0.6184 - accuracy50: 0.5819 - val_loss: 9.3563 - val_accuracy10: 0.7340 - val_accuracy20: 0.7068 - val_accuracy30: 0.6729 - val_accuracy50: 0.6088 - 44s/epoch - 27ms/step
Epoch 8/50
1601/1601 - 44s - loss: 9.0652 - accuracy10: 0.6544 - accuracy20: 0.6438 - accuracy30: 0.6204 - accuracy50: 0.5833 - val_loss: 9.4096 - val_accuracy10: 0.7315 - val_accuracy20: 0.7036 - val_accuracy30: 0.6719 - val_accuracy50: 0.6077 - 44s/epoch - 27ms/step
Epoch 9/50
1601/1601 - 44s - loss: 9.0331 - accuracy10: 0.6549 - accuracy20: 0.6440 - accuracy30: 0.6209 - accuracy50: 0.5841 - val_loss: 9.4124 - val_accuracy10: 0.7372 - val_accuracy20: 0.7076 - val_accuracy30: 0.6752 - val_accuracy50: 0.6099 - 44s/epoch - 27ms/step
Epoch 10/50
1601/1601 - 43s - loss: 8.9994 - accuracy10: 0.6569 - accuracy20: 0.6458 - accuracy30: 0.6224 - accuracy50: 0.5851 - val_loss: 9.3750 - val_accuracy10: 0.7372 - val_accuracy20: 0.7076 - val_accuracy30: 0.6741 - val_accuracy50: 0.6089 - 43s/epoch - 27ms/step
Epoch 11/50
1601/1601 - 45s - loss: 8.9824 - accuracy10: 0.6580 - accuracy20: 0.6462 - accuracy30: 0.6228 - accuracy50: 0.5859 - val_loss: 9.3773 - val_accuracy10: 0.7440 - val_accuracy20: 0.7119 - val_accuracy30: 0.6772 - val_accuracy50: 0.6102 - 45s/epoch - 28ms/step
Epoch 12/50
1601/1601 - 43s - loss: 8.9571 - accuracy10: 0.6591 - accuracy20: 0.6480 - accuracy30: 0.6245 - accuracy50: 0.5864 - val_loss: 9.4284 - val_accuracy10: 0.7432 - val_accuracy20: 0.7103 - val_accuracy30: 0.6756 - val_accuracy50: 0.6098 - 43s/epoch - 27ms/step
Epoch 13/50
1601/1601 - 43s - loss: 8.9385 - accuracy10: 0.6600 - accuracy20: 0.6484 - accuracy30: 0.6248 - accuracy50: 0.5871 - val_loss: 9.3065 - val_accuracy10: 0.7393 - val_accuracy20: 0.7096 - val_accuracy30: 0.6763 - val_accuracy50: 0.6117 - 43s/epoch - 27ms/step
Epoch 14/50
1601/1601 - 43s - loss: 8.9176 - accuracy10: 0.6610 - accuracy20: 0.6491 - accuracy30: 0.6257 - accuracy50: 0.5884 - val_loss: 9.3483 - val_accuracy10: 0.7388 - val_accuracy20: 0.7067 - val_accuracy30: 0.6736 - val_accuracy50: 0.6088 - 43s/epoch - 27ms/step
Epoch 15/50
1601/1601 - 44s - loss: 8.9001 - accuracy10: 0.6623 - accuracy20: 0.6507 - accuracy30: 0.6267 - accuracy50: 0.5888 - val_loss: 9.2201 - val_accuracy10: 0.7374 - val_accuracy20: 0.7080 - val_accuracy30: 0.6759 - val_accuracy50: 0.6149 - 44s/epoch - 27ms/step
Epoch 16/50
1601/1601 - 43s - loss: 8.8822 - accuracy10: 0.6633 - accuracy20: 0.6510 - accuracy30: 0.6274 - accuracy50: 0.5895 - val_loss: 9.3209 - val_accuracy10: 0.7384 - val_accuracy20: 0.7076 - val_accuracy30: 0.6738 - val_accuracy50: 0.6112 - 43s/epoch - 27ms/step
Epoch 17/50
1601/1601 - 44s - loss: 8.8708 - accuracy10: 0.6628 - accuracy20: 0.6507 - accuracy30: 0.6276 - accuracy50: 0.5898 - val_loss: 9.2575 - val_accuracy10: 0.7406 - val_accuracy20: 0.7097 - val_accuracy30: 0.6769 - val_accuracy50: 0.6137 - 44s/epoch - 27ms/step
Epoch 18/50
1601/1601 - 46s - loss: 8.8532 - accuracy10: 0.6643 - accuracy20: 0.6520 - accuracy30: 0.6283 - accuracy50: 0.5906 - val_loss: 9.1488 - val_accuracy10: 0.7407 - val_accuracy20: 0.7099 - val_accuracy30: 0.6775 - val_accuracy50: 0.6158 - 46s/epoch - 29ms/step
Epoch 19/50
1601/1601 - 44s - loss: 8.8387 - accuracy10: 0.6646 - accuracy20: 0.6519 - accuracy30: 0.6282 - accuracy50: 0.5907 - val_loss: 9.2326 - val_accuracy10: 0.7430 - val_accuracy20: 0.7123 - val_accuracy30: 0.6794 - val_accuracy50: 0.6172 - 44s/epoch - 28ms/step
Epoch 20/50
1601/1601 - 45s - loss: 8.8249 - accuracy10: 0.6654 - accuracy20: 0.6536 - accuracy30: 0.6295 - accuracy50: 0.5913 - val_loss: 9.2321 - val_accuracy10: 0.7397 - val_accuracy20: 0.7089 - val_accuracy30: 0.6758 - val_accuracy50: 0.6150 - 45s/epoch - 28ms/step
Epoch 21/50
1601/1601 - 45s - loss: 8.8099 - accuracy10: 0.6664 - accuracy20: 0.6538 - accuracy30: 0.6302 - accuracy50: 0.5917 - val_loss: 9.2104 - val_accuracy10: 0.7404 - val_accuracy20: 0.7099 - val_accuracy30: 0.6772 - val_accuracy50: 0.6162 - 45s/epoch - 28ms/step
Epoch 22/50
1601/1601 - 45s - loss: 8.8017 - accuracy10: 0.6665 - accuracy20: 0.6542 - accuracy30: 0.6306 - accuracy50: 0.5926 - val_loss: 9.1876 - val_accuracy10: 0.7408 - val_accuracy20: 0.7101 - val_accuracy30: 0.6765 - val_accuracy50: 0.6152 - 45s/epoch - 28ms/step
Epoch 23/50
1601/1601 - 44s - loss: 8.7890 - accuracy10: 0.6668 - accuracy20: 0.6542 - accuracy30: 0.6308 - accuracy50: 0.5925 - val_loss: 9.3185 - val_accuracy10: 0.7405 - val_accuracy20: 0.7073 - val_accuracy30: 0.6732 - val_accuracy50: 0.6125 - 44s/epoch - 27ms/step
Epoch 24/50
1601/1601 - 45s - loss: 8.7713 - accuracy10: 0.6674 - accuracy20: 0.6552 - accuracy30: 0.6313 - accuracy50: 0.5933 - val_loss: 9.2891 - val_accuracy10: 0.7398 - val_accuracy20: 0.7076 - val_accuracy30: 0.6749 - val_accuracy50: 0.6135 - 45s/epoch - 28ms/step
Epoch 25/50
1601/1601 - 46s - loss: 8.7620 - accuracy10: 0.6684 - accuracy20: 0.6554 - accuracy30: 0.6316 - accuracy50: 0.5935 - val_loss: 9.2091 - val_accuracy10: 0.7371 - val_accuracy20: 0.7067 - val_accuracy30: 0.6745 - val_accuracy50: 0.6139 - 46s/epoch - 29ms/step
Epoch 26/50
1601/1601 - 44s - loss: 8.7481 - accuracy10: 0.6688 - accuracy20: 0.6562 - accuracy30: 0.6326 - accuracy50: 0.5948 - val_loss: 9.2574 - val_accuracy10: 0.7413 - val_accuracy20: 0.7091 - val_accuracy30: 0.6764 - val_accuracy50: 0.6144 - 44s/epoch - 28ms/step
Epoch 27/50
1601/1601 - 45s - loss: 8.7400 - accuracy10: 0.6688 - accuracy20: 0.6560 - accuracy30: 0.6324 - accuracy50: 0.5942 - val_loss: 9.2427 - val_accuracy10: 0.7350 - val_accuracy20: 0.7047 - val_accuracy30: 0.6725 - val_accuracy50: 0.6129 - 45s/epoch - 28ms/step
Epoch 28/50
1601/1601 - 45s - loss: 8.7304 - accuracy10: 0.6691 - accuracy20: 0.6563 - accuracy30: 0.6328 - accuracy50: 0.5944 - val_loss: 9.2880 - val_accuracy10: 0.7440 - val_accuracy20: 0.7107 - val_accuracy30: 0.6762 - val_accuracy50: 0.6141 - 45s/epoch - 28ms/step
testing model: results/EXC/W4/deepLOB_L1/seq2seq
Evaluating performance on  test set...
3782/3782 - 52s - 52s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.65459293
{'0': {'precision': 0.4199282507588862, 'recall': 0.5363882560288871, 'f1-score': 0.47106701700341275, 'support': 116315}, '1': {'precision': 0.8865554168713734, 'recall': 0.731492843095902, 'f1-score': 0.8015940667461049, 'support': 730204}, '2': {'precision': 0.3584427200759829, 'recall': 0.6402131216390932, 'f1-score': 0.45957721001170476, 'support': 121433}, 'accuracy': 0.6965965254475428, 'macro avg': {'precision': 0.5549754625687475, 'recall': 0.6360314069212941, 'f1-score': 0.5774127645870741, 'support': 967952}, 'weighted avg': {'precision': 0.7642290536464111, 'recall': 0.6965965254475428, 'f1-score': 0.7189687023120734, 'support': 967952}}
[[ 62390  39787  14138]
 [ 71055 534139 125010]
 [ 15128  28562  77743]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7127217
{'0': {'precision': 0.48642541117324817, 'recall': 0.49594532498883587, 'f1-score': 0.4911392405063291, 'support': 154513}, '1': {'precision': 0.8242458592668371, 'recall': 0.7224590804364344, 'f1-score': 0.7700032375324266, 'support': 650178}, '2': {'precision': 0.42510227499501096, 'recall': 0.6262916434420958, 'f1-score': 0.5064476744042061, 'support': 163261}, 'accuracy': 0.6700807478056763, 'macro avg': {'precision': 0.5785911818116988, 'recall': 0.6148986829557886, 'f1-score': 0.5891967174809872, 'support': 967952}, 'weighted avg': {'precision': 0.7029978721682132, 'recall': 0.6700807478056763, 'f1-score': 0.6810355433034051, 'support': 967952}}
[[ 76630  56649  21234]
 [ 63406 469727 117045]
 [ 17501  43511 102249]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7745563
{'0': {'precision': 0.5145914998330634, 'recall': 0.45853419351995195, 'f1-score': 0.4849482445688116, 'support': 181511}, '1': {'precision': 0.7710312063481533, 'recall': 0.7044515122076059, 'f1-score': 0.7362391879490997, 'support': 593933}, '2': {'precision': 0.44973972561160686, 'recall': 0.6157510337232739, 'f1-score': 0.5198124873924521, 'support': 192508}, 'accuracy': 0.6406960262492355, 'macro avg': {'precision': 0.5784541439309412, 'recall': 0.5929122464836106, 'f1-score': 0.5803333066367878, 'support': 967952}, 'weighted avg': {'precision': 0.6590444467331192, 'recall': 0.6406960262492355, 'f1-score': 0.6460736201372055, 'support': 967952}}
[[ 83229  69464  28818]
 [ 59323 418397 116213]
 [ 19186  54785 118537]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8743191
{'0': {'precision': 0.549377121997294, 'recall': 0.38712129047925276, 'f1-score': 0.45419314671330846, 'support': 222367}, '1': {'precision': 0.6695959229638678, 'recall': 0.690720573670915, 'f1-score': 0.6799942236699661, 'support': 507887}, '2': {'precision': 0.477508265181834, 'recall': 0.5772534897222527, 'f1-score': 0.5226645944751718, 'support': 237698}, 'accuracy': 0.5931110220341504, 'macro avg': {'precision': 0.5654937700476653, 'recall': 0.5516984512908069, 'f1-score': 0.5522839882861488, 'support': 967952}, 'weighted avg': {'precision': 0.5948075592908676, 'recall': 0.5931110220341504, 'f1-score': 0.5894859688391839, 'support': 967952}}
[[ 86083  94724  41560]
 [ 48501 350808 108578]
 [ 22108  78378 137212]]
Evaluating performance on  train set...
1601/1601 - 21s - 21s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.62236375
{'0': {'precision': 0.4673143589594197, 'recall': 0.54182358603685, 'f1-score': 0.5018182955727436, 'support': 59213}, '1': {'precision': 0.8591871845412389, 'recall': 0.7758230452674897, 'f1-score': 0.8153798744654509, 'support': 291600}, '2': {'precision': 0.4454756977028191, 'recall': 0.5879638270075841, 'f1-score': 0.5068968039201346, 'support': 58939}, 'accuracy': 0.7149861379566177, 'macro avg': {'precision': 0.5906590804011592, 'recall': 0.6352034861039746, 'f1-score': 0.6080316579861097, 'support': 409752}, 'weighted avg': {'precision': 0.7430493574069091, 'recall': 0.7149861379566177, 'f1-score': 0.7256948809429196, 'support': 409752}}
[[ 32083  20319   6811]
 [ 29044 226230  36326]
 [  7527  16758  34654]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6984317
{'0': {'precision': 0.5287329348591306, 'recall': 0.4904039434095128, 'f1-score': 0.5088476764885618, 'support': 78105}, '1': {'precision': 0.7824578178848184, 'recall': 0.7734565761905512, 'f1-score': 0.7779311601450551, 'support': 253916}, '2': {'precision': 0.5089556734712792, 'recall': 0.5651541855887613, 'f1-score': 0.5355847480874151, 'support': 77731}, 'accuracy': 0.6799869189168082, 'macro avg': {'precision': 0.6067154754050761, 'recall': 0.6096715683962751, 'f1-score': 0.6074545282403441, 'support': 409752}, 'weighted avg': {'precision': 0.6822099187259852, 'recall': 0.6799869189168082, 'f1-score': 0.6806659986653238, 'support': 409752}}
[[ 38303  29712  10090]
 [ 25229 196393  32294]
 [  8911  24890  43930]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7698807
{'0': {'precision': 0.5547647185217017, 'recall': 0.4517024952435104, 'f1-score': 0.4979568220446245, 'support': 91454}, '1': {'precision': 0.7172077328413039, 'recall': 0.7596549143888376, 'f1-score': 0.7378213267325887, 'support': 227190}, '2': {'precision': 0.5307125047542577, 'recall': 0.5513566316898626, 'f1-score': 0.540837639965547, 'support': 91108}, 'accuracy': 0.6446069817841036, 'macro avg': {'precision': 0.6008949853724211, 'recall': 0.5875713471074036, 'f1-score': 0.5922052629142535, 'support': 409752}, 'weighted avg': {'precision': 0.6394844498014663, 'recall': 0.6446069817841036, 'f1-score': 0.6404859674281688, 'support': 409752}}
[[ 41310  37044  13100]
 [ 23285 172586  31319]
 [  9869  31006  50233]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.88961935
{'0': {'precision': 0.5809969061533173, 'recall': 0.37989444629258334, 'f1-score': 0.45940157000891557, 'support': 111223}, '1': {'precision': 0.5988430303704527, 'recall': 0.7471559515484115, 'f1-score': 0.6648283396867244, 'support': 187321}, '2': {'precision': 0.5492532401537077, 'recall': 0.5102600532335804, 'f1-score': 0.5290391150516732, 'support': 111208}, 'accuracy': 0.5831722602940315, 'macro avg': {'precision': 0.5763643922258259, 'recall': 0.5457701503581918, 'f1-score': 0.551089674915771, 'support': 409752}, 'weighted avg': {'precision': 0.5805400547553826, 'recall': 0.5831722602940315, 'f1-score': 0.5722137101130074, 'support': 409752}}
[[ 42253  50895  18075]
 [ 18870 139958  28493]
 [ 11602  42861  56745]]
Evaluating performance on  val set...
532/532 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5734792
{'0': {'precision': 0.45702764417237524, 'recall': 0.5497954412624196, 'f1-score': 0.4991377709389011, 'support': 17110}, '1': {'precision': 0.8903127451088698, 'recall': 0.7894210990302674, 'f1-score': 0.8368369407770064, 'support': 102090}, '2': {'precision': 0.42943242595992653, 'recall': 0.634449817195424, 'f1-score': 0.5121869941921355, 'support': 16958}, 'accuracy': 0.7400079319613978, 'macro avg': {'precision': 0.5922576050803905, 'recall': 0.6578887858293704, 'f1-score': 0.6160539019693477, 'support': 136158}, 'weighted avg': {'precision': 0.7784638891536472, 'recall': 0.7400079319613978, 'f1-score': 0.7539666974558925, 'support': 136158}}
[[ 9407  5646  2057]
 [ 9260 80592 12238]
 [ 1916  4283 10759]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.63705087
{'0': {'precision': 0.5269463847897488, 'recall': 0.49623175778697454, 'f1-score': 0.5111280624607377, 'support': 22955}, '1': {'precision': 0.8235916424226395, 'recall': 0.7912983913735195, 'f1-score': 0.8071221298774474, 'support': 90512}, '2': {'precision': 0.49619261730364783, 'recall': 0.6030584813362126, 'f1-score': 0.54443096142752, 'support': 22691}, 'accuracy': 0.7101822882239751, 'macro avg': {'precision': 0.6155768815053454, 'recall': 0.6301962101655688, 'f1-score': 0.6208937179219017, 'support': 136158}, 'weighted avg': {'precision': 0.7190182558574869, 'recall': 0.7101822882239751, 'f1-score': 0.7134422203543355, 'support': 136158}}
[[11391  8618  2946]
 [ 7942 71622 10948]
 [ 2284  6723 13684]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7048331
{'0': {'precision': 0.5563006300630063, 'recall': 0.4551178203240059, 'f1-score': 0.5006480356419604, 'support': 27160}, '1': {'precision': 0.7661205578907145, 'recall': 0.7812332570259607, 'f1-score': 0.7736031060843562, 'support': 82124}, '2': {'precision': 0.520666357554481, 'recall': 0.5849892089007963, 'f1-score': 0.5509567533468843, 'support': 26874}, 'accuracy': 0.6774482586406968, 'macro avg': {'precision': 0.6143625151694007, 'recall': 0.6071134287502543, 'f1-score': 0.6084026316910669, 'support': 136158}, 'weighted avg': {'precision': 0.6758207193234875, 'recall': 0.6774482586406968, 'f1-score': 0.6752111071075624, 'support': 136158}}
[[12361 11010  3789]
 [ 7282 64158 10684]
 [ 2577  8576 15721]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.82363343
{'0': {'precision': 0.5886081763895269, 'recall': 0.37940427547817845, 'f1-score': 0.46139997119400833, 'support': 33774}, '1': {'precision': 0.6541221280255559, 'recall': 0.770240162037037, 'f1-score': 0.7074480100989966, 'support': 69120}, '2': {'precision': 0.5391538881144312, 'recall': 0.5348424723424724, 'f1-score': 0.5369895264254023, 'support': 33264}, 'accuracy': 0.6157846031815979, 'macro avg': {'precision': 0.593961397509838, 'recall': 0.5614956366192293, 'f1-score': 0.5686125025728025, 'support': 136158}, 'weighted avg': {'precision': 0.609784140283676, 'recall': 0.6157846031815979, 'f1-score': 0.6047720199486161, 'support': 136158}}
[[12814 15648  5312]
 [ 5986 53239  9895]
 [ 2970 12503 17791]]
training model: results/EXC/W4/deepOF_L1/seq2seq
Epoch 1/50
1601/1601 - 49s - loss: 12.4729 - accuracy10: 0.3848 - accuracy20: 0.4130 - accuracy30: 0.4265 - accuracy50: 0.4348 - val_loss: 11.6636 - val_accuracy10: 0.4038 - val_accuracy20: 0.4353 - val_accuracy30: 0.4511 - val_accuracy50: 0.4513 - 49s/epoch - 31ms/step
Epoch 2/50
1601/1601 - 43s - loss: 12.1840 - accuracy10: 0.4003 - accuracy20: 0.4288 - accuracy30: 0.4432 - accuracy50: 0.4492 - val_loss: 11.4249 - val_accuracy10: 0.4647 - val_accuracy20: 0.4866 - val_accuracy30: 0.4981 - val_accuracy50: 0.4878 - 43s/epoch - 27ms/step
Epoch 3/50
1601/1601 - 42s - loss: 12.0402 - accuracy10: 0.4190 - accuracy20: 0.4440 - accuracy30: 0.4561 - accuracy50: 0.4607 - val_loss: 11.3067 - val_accuracy10: 0.4942 - val_accuracy20: 0.5070 - val_accuracy30: 0.5133 - val_accuracy50: 0.5000 - 42s/epoch - 26ms/step
Epoch 4/50
1601/1601 - 41s - loss: 11.9333 - accuracy10: 0.4374 - accuracy20: 0.4574 - accuracy30: 0.4655 - accuracy50: 0.4674 - val_loss: 11.2740 - val_accuracy10: 0.4892 - val_accuracy20: 0.5018 - val_accuracy30: 0.5079 - val_accuracy50: 0.4967 - 41s/epoch - 26ms/step
Epoch 5/50
1601/1601 - 41s - loss: 11.8402 - accuracy10: 0.4530 - accuracy20: 0.4694 - accuracy30: 0.4749 - accuracy50: 0.4741 - val_loss: 11.2562 - val_accuracy10: 0.4934 - val_accuracy20: 0.5052 - val_accuracy30: 0.5104 - val_accuracy50: 0.4988 - 41s/epoch - 26ms/step
Epoch 6/50
1601/1601 - 42s - loss: 11.7406 - accuracy10: 0.4691 - accuracy20: 0.4835 - accuracy30: 0.4861 - accuracy50: 0.4827 - val_loss: 11.1315 - val_accuracy10: 0.5155 - val_accuracy20: 0.5229 - val_accuracy30: 0.5253 - val_accuracy50: 0.5090 - 42s/epoch - 26ms/step
Epoch 7/50
1601/1601 - 41s - loss: 11.6302 - accuracy10: 0.4847 - accuracy20: 0.4974 - accuracy30: 0.4985 - accuracy50: 0.4913 - val_loss: 11.1169 - val_accuracy10: 0.5111 - val_accuracy20: 0.5183 - val_accuracy30: 0.5216 - val_accuracy50: 0.5080 - 41s/epoch - 25ms/step
Epoch 8/50
1601/1601 - 41s - loss: 11.5323 - accuracy10: 0.4974 - accuracy20: 0.5087 - accuracy30: 0.5083 - accuracy50: 0.4981 - val_loss: 11.0281 - val_accuracy10: 0.5265 - val_accuracy20: 0.5288 - val_accuracy30: 0.5289 - val_accuracy50: 0.5127 - 41s/epoch - 26ms/step
Epoch 9/50
1601/1601 - 41s - loss: 11.4315 - accuracy10: 0.5054 - accuracy20: 0.5168 - accuracy30: 0.5152 - accuracy50: 0.5040 - val_loss: 10.9823 - val_accuracy10: 0.5372 - val_accuracy20: 0.5373 - val_accuracy30: 0.5356 - val_accuracy50: 0.5170 - 41s/epoch - 26ms/step
Epoch 10/50
1601/1601 - 43s - loss: 11.3343 - accuracy10: 0.5155 - accuracy20: 0.5249 - accuracy30: 0.5221 - accuracy50: 0.5094 - val_loss: 10.9489 - val_accuracy10: 0.5526 - val_accuracy20: 0.5480 - val_accuracy30: 0.5437 - val_accuracy50: 0.5214 - 43s/epoch - 27ms/step
Epoch 11/50
1601/1601 - 41s - loss: 11.2684 - accuracy10: 0.5210 - accuracy20: 0.5308 - accuracy30: 0.5270 - accuracy50: 0.5134 - val_loss: 11.0782 - val_accuracy10: 0.5856 - val_accuracy20: 0.5658 - val_accuracy30: 0.5550 - val_accuracy50: 0.5240 - 41s/epoch - 25ms/step
Epoch 12/50
1601/1601 - 42s - loss: 11.2058 - accuracy10: 0.5237 - accuracy20: 0.5338 - accuracy30: 0.5305 - accuracy50: 0.5162 - val_loss: 10.9018 - val_accuracy10: 0.5632 - val_accuracy20: 0.5554 - val_accuracy30: 0.5481 - val_accuracy50: 0.5237 - 42s/epoch - 26ms/step
Epoch 13/50
1601/1601 - 41s - loss: 11.1377 - accuracy10: 0.5301 - accuracy20: 0.5396 - accuracy30: 0.5350 - accuracy50: 0.5200 - val_loss: 10.9000 - val_accuracy10: 0.5622 - val_accuracy20: 0.5539 - val_accuracy30: 0.5466 - val_accuracy50: 0.5231 - 41s/epoch - 25ms/step
Epoch 14/50
1601/1601 - 41s - loss: 11.0816 - accuracy10: 0.5338 - accuracy20: 0.5430 - accuracy30: 0.5393 - accuracy50: 0.5232 - val_loss: 10.9148 - val_accuracy10: 0.5673 - val_accuracy20: 0.5598 - val_accuracy30: 0.5523 - val_accuracy50: 0.5281 - 41s/epoch - 25ms/step
Epoch 15/50
1601/1601 - 41s - loss: 11.0288 - accuracy10: 0.5377 - accuracy20: 0.5463 - accuracy30: 0.5422 - accuracy50: 0.5253 - val_loss: 10.9468 - val_accuracy10: 0.5746 - val_accuracy20: 0.5626 - val_accuracy30: 0.5536 - val_accuracy50: 0.5273 - 41s/epoch - 26ms/step
Epoch 16/50
1601/1601 - 40s - loss: 10.9734 - accuracy10: 0.5410 - accuracy20: 0.5501 - accuracy30: 0.5454 - accuracy50: 0.5286 - val_loss: 10.8990 - val_accuracy10: 0.5810 - val_accuracy20: 0.5699 - val_accuracy30: 0.5597 - val_accuracy50: 0.5314 - 40s/epoch - 25ms/step
Epoch 17/50
1601/1601 - 41s - loss: 10.9252 - accuracy10: 0.5450 - accuracy20: 0.5531 - accuracy30: 0.5481 - accuracy50: 0.5301 - val_loss: 10.8976 - val_accuracy10: 0.5814 - val_accuracy20: 0.5681 - val_accuracy30: 0.5573 - val_accuracy50: 0.5294 - 41s/epoch - 25ms/step
Epoch 18/50
1601/1601 - 42s - loss: 10.8845 - accuracy10: 0.5459 - accuracy20: 0.5543 - accuracy30: 0.5494 - accuracy50: 0.5319 - val_loss: 10.9381 - val_accuracy10: 0.5790 - val_accuracy20: 0.5672 - val_accuracy30: 0.5567 - val_accuracy50: 0.5287 - 42s/epoch - 26ms/step
Epoch 19/50
1601/1601 - 43s - loss: 10.8343 - accuracy10: 0.5491 - accuracy20: 0.5576 - accuracy30: 0.5527 - accuracy50: 0.5337 - val_loss: 10.9194 - val_accuracy10: 0.5965 - val_accuracy20: 0.5804 - val_accuracy30: 0.5678 - val_accuracy50: 0.5362 - 43s/epoch - 27ms/step
Epoch 20/50
1601/1601 - 41s - loss: 10.7989 - accuracy10: 0.5518 - accuracy20: 0.5597 - accuracy30: 0.5536 - accuracy50: 0.5350 - val_loss: 10.9009 - val_accuracy10: 0.5879 - val_accuracy20: 0.5732 - val_accuracy30: 0.5616 - val_accuracy50: 0.5325 - 41s/epoch - 26ms/step
Epoch 21/50
1601/1601 - 41s - loss: 10.7532 - accuracy10: 0.5544 - accuracy20: 0.5624 - accuracy30: 0.5558 - accuracy50: 0.5367 - val_loss: 10.9170 - val_accuracy10: 0.5967 - val_accuracy20: 0.5811 - val_accuracy30: 0.5674 - val_accuracy50: 0.5367 - 41s/epoch - 26ms/step
Epoch 22/50
1601/1601 - 40s - loss: 10.7077 - accuracy10: 0.5574 - accuracy20: 0.5653 - accuracy30: 0.5580 - accuracy50: 0.5386 - val_loss: 11.0032 - val_accuracy10: 0.5976 - val_accuracy20: 0.5810 - val_accuracy30: 0.5678 - val_accuracy50: 0.5350 - 40s/epoch - 25ms/step
Epoch 23/50
1601/1601 - 41s - loss: 10.6802 - accuracy10: 0.5590 - accuracy20: 0.5662 - accuracy30: 0.5596 - accuracy50: 0.5399 - val_loss: 10.8857 - val_accuracy10: 0.6065 - val_accuracy20: 0.5900 - val_accuracy30: 0.5749 - val_accuracy50: 0.5417 - 41s/epoch - 25ms/step
Epoch 24/50
1601/1601 - 41s - loss: 10.6440 - accuracy10: 0.5618 - accuracy20: 0.5685 - accuracy30: 0.5614 - accuracy50: 0.5417 - val_loss: 10.9190 - val_accuracy10: 0.6080 - val_accuracy20: 0.5898 - val_accuracy30: 0.5745 - val_accuracy50: 0.5401 - 41s/epoch - 25ms/step
Epoch 25/50
1601/1601 - 41s - loss: 10.6150 - accuracy10: 0.5630 - accuracy20: 0.5694 - accuracy30: 0.5632 - accuracy50: 0.5433 - val_loss: 10.9910 - val_accuracy10: 0.6107 - val_accuracy20: 0.5909 - val_accuracy30: 0.5753 - val_accuracy50: 0.5395 - 41s/epoch - 26ms/step
Epoch 26/50
1601/1601 - 41s - loss: 10.5779 - accuracy10: 0.5647 - accuracy20: 0.5717 - accuracy30: 0.5646 - accuracy50: 0.5450 - val_loss: 10.9650 - val_accuracy10: 0.6200 - val_accuracy20: 0.5992 - val_accuracy30: 0.5817 - val_accuracy50: 0.5441 - 41s/epoch - 26ms/step
Epoch 27/50
1601/1601 - 43s - loss: 10.5489 - accuracy10: 0.5657 - accuracy20: 0.5722 - accuracy30: 0.5649 - accuracy50: 0.5451 - val_loss: 10.9805 - val_accuracy10: 0.6029 - val_accuracy20: 0.5856 - val_accuracy30: 0.5718 - val_accuracy50: 0.5385 - 43s/epoch - 27ms/step
Epoch 28/50
1601/1601 - 43s - loss: 10.5086 - accuracy10: 0.5683 - accuracy20: 0.5745 - accuracy30: 0.5673 - accuracy50: 0.5474 - val_loss: 11.0070 - val_accuracy10: 0.6103 - val_accuracy20: 0.5914 - val_accuracy30: 0.5750 - val_accuracy50: 0.5413 - 43s/epoch - 27ms/step
Epoch 29/50
1601/1601 - 42s - loss: 10.4842 - accuracy10: 0.5706 - accuracy20: 0.5763 - accuracy30: 0.5686 - accuracy50: 0.5484 - val_loss: 11.0124 - val_accuracy10: 0.6182 - val_accuracy20: 0.5969 - val_accuracy30: 0.5811 - val_accuracy50: 0.5456 - 42s/epoch - 26ms/step
Epoch 30/50
1601/1601 - 41s - loss: 10.4528 - accuracy10: 0.5728 - accuracy20: 0.5774 - accuracy30: 0.5700 - accuracy50: 0.5496 - val_loss: 11.0647 - val_accuracy10: 0.6161 - val_accuracy20: 0.5965 - val_accuracy30: 0.5784 - val_accuracy50: 0.5432 - 41s/epoch - 26ms/step
Epoch 31/50
1601/1601 - 41s - loss: 10.4182 - accuracy10: 0.5735 - accuracy20: 0.5783 - accuracy30: 0.5706 - accuracy50: 0.5509 - val_loss: 10.9806 - val_accuracy10: 0.6152 - val_accuracy20: 0.5975 - val_accuracy30: 0.5818 - val_accuracy50: 0.5457 - 41s/epoch - 26ms/step
Epoch 32/50
1601/1601 - 40s - loss: 10.3903 - accuracy10: 0.5753 - accuracy20: 0.5805 - accuracy30: 0.5731 - accuracy50: 0.5524 - val_loss: 11.0606 - val_accuracy10: 0.6165 - val_accuracy20: 0.5969 - val_accuracy30: 0.5812 - val_accuracy50: 0.5448 - 40s/epoch - 25ms/step
Epoch 33/50
1601/1601 - 41s - loss: 10.3673 - accuracy10: 0.5760 - accuracy20: 0.5812 - accuracy30: 0.5735 - accuracy50: 0.5532 - val_loss: 11.0024 - val_accuracy10: 0.6124 - val_accuracy20: 0.5955 - val_accuracy30: 0.5801 - val_accuracy50: 0.5451 - 41s/epoch - 26ms/step
testing model: results/EXC/W4/deepOF_L1/seq2seq
Evaluating performance on  test set...
3782/3782 - 50s - 50s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.85929066
{'0': {'precision': 0.25433106188451926, 'recall': 0.5118086542346943, 'f1-score': 0.33980443977647, 'support': 116313}, '1': {'precision': 0.8490990069097253, 'recall': 0.5965828633720532, 'f1-score': 0.7007875345767978, 'support': 730202}, '2': {'precision': 0.2803231327941749, 'recall': 0.5097955251043785, 'f1-score': 0.36173675245638687, 'support': 121433}, 'accuracy': 0.5755081884564047, 'macro avg': {'precision': 0.4612510671961398, 'recall': 0.5393956809037087, 'f1-score': 0.46744290893655155, 'support': 967948}, 'weighted avg': {'precision': 0.7062737676291128, 'recall': 0.5755081884564047, 'f1-score': 0.6148748819025442, 'support': 967948}}
[[ 59530  39024  17759]
 [153403 435626 141173]
 [ 21132  38395  61906]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.89398074
{'0': {'precision': 0.3190385228920236, 'recall': 0.5112904582845235, 'f1-score': 0.39290776614527645, 'support': 154511}, '1': {'precision': 0.7898715263026823, 'recall': 0.5805089698789251, 'f1-score': 0.6691973613872841, 'support': 650176}, '2': {'precision': 0.3501905248919534, 'recall': 0.5201303434378082, 'f1-score': 0.41856911538907055, 'support': 163261}, 'accuracy': 0.5592759115159078, 'macro avg': {'precision': 0.48636685802888646, 'recall': 0.5373099238670856, 'f1-score': 0.49355808097387704, 'support': 967948}, 'weighted avg': {'precision': 0.6405539615561243, 'recall': 0.5592759115159078, 'f1-score': 0.5828212340329715, 'support': 967948}}
[[ 79000  50245  25266]
 [140438 377433 132305]
 [ 28181  50163  84917]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9218181
{'0': {'precision': 0.3587985292396363, 'recall': 0.48976634767422, 'f1-score': 0.41417562757412546, 'support': 181509}, '1': {'precision': 0.7367488767495233, 'recall': 0.5756416559471454, 'f1-score': 0.6463066181342493, 'support': 593932}, '2': {'precision': 0.3890524343107016, 'recall': 0.5176331250292198, 'f1-score': 0.4442255097105232, 'support': 192507}, 'accuracy': 0.5480015455375702, 'macro avg': {'precision': 0.49486661343328703, 'recall': 0.5276803762168618, 'f1-score': 0.5015692518062993, 'support': 967948}, 'weighted avg': {'precision': 0.5967254574431738, 'recall': 0.5480015455375702, 'f1-score': 0.5625873564539691, 'support': 967948}}
[[ 88897  61539  31073]
 [126631 341892 125409]
 [ 32235  60624  99648]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.96391386
{'0': {'precision': 0.40626785581198915, 'recall': 0.4412629742224461, 'f1-score': 0.4230429290207423, 'support': 222364}, '1': {'precision': 0.6358729022249704, 'recall': 0.577051588246992, 'f1-score': 0.6050359623118275, 'support': 507887}, '2': {'precision': 0.4351191036625553, 'recall': 0.48605998392911987, 'f1-score': 0.4591810373950264, 'support': 237697}, 'accuracy': 0.5235126267113522, 'macro avg': {'precision': 0.4924199538998382, 'recall': 0.5014581821328526, 'f1-score': 0.49575330957586544, 'support': 967948}, 'weighted avg': {'precision': 0.5338276764509965, 'recall': 0.5235126267113522, 'f1-score': 0.5274099153106583, 'support': 967948}}
[[ 98121  84457  39786]
 [104606 293077 110204]
 [ 38791  83371 115535]]
Evaluating performance on  train set...
1601/1601 - 20s - 20s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8428252
{'0': {'precision': 0.3076331257757763, 'recall': 0.5052991625806669, 'f1-score': 0.3824347072026117, 'support': 59349}, '1': {'precision': 0.8368339222614841, 'recall': 0.6094161725955204, 'f1-score': 0.7052447260902194, 'support': 291456}, '2': {'precision': 0.3128068228401172, 'recall': 0.530765968275511, 'f1-score': 0.3936286659704835, 'support': 58945}, 'accuracy': 0.5830213544844417, 'macro avg': {'precision': 0.4857579569591259, 'recall': 0.5484937678172327, 'f1-score': 0.49376936642110486, 'support': 409750}, 'weighted avg': {'precision': 0.6847989852364135, 'recall': 0.5830213544844417, 'f1-score': 0.6136604418322121, 'support': 409750}}
[[ 29989  18254  11106]
 [ 56213 177618  57625]
 [ 11281  16378  31286]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.88206804
{'0': {'precision': 0.3762137333565905, 'recall': 0.4963816294174807, 'f1-score': 0.42802332888658584, 'support': 78212}, '1': {'precision': 0.7719043586952139, 'recall': 0.6033597024803807, 'f1-score': 0.6773040863258447, 'support': 253832}, '2': {'precision': 0.38282723674963937, 'recall': 0.5328031297454509, 'f1-score': 0.4455325147696579, 'support': 77706}, 'accuracy': 0.5695594874923734, 'macro avg': {'precision': 0.5103151096004813, 'recall': 0.5441814872144374, 'f1-score': 0.5169533099940294, 'support': 409750}, 'weighted avg': {'precision': 0.6225904306247142, 'recall': 0.5695594874923734, 'f1-score': 0.5857683002607212, 'support': 409750}}
[[ 38823  24103  15286]
 [ 49220 153152  51460]
 [ 15151  21153  41402]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9167437
{'0': {'precision': 0.4156712898351252, 'recall': 0.4718395262703624, 'f1-score': 0.44197803772271854, 'support': 91529}, '1': {'precision': 0.7106366596955603, 'recall': 0.6015262738397721, 'f1-score': 0.6515450345924625, 'support': 227089}, '2': {'precision': 0.42001742482245163, 'recall': 0.5237128560768994, 'f1-score': 0.4661682042165821, 'support': 91132}, 'accuracy': 0.5552507626601586, 'macro avg': {'precision': 0.5154417914510457, 'recall': 0.5323595520623446, 'f1-score': 0.5198970921772544, 'support': 409750}, 'weighted avg': {'precision': 0.5801117116774716, 'recall': 0.5552507626601586, 'f1-score': 0.5635030114995876, 'support': 409750}}
[[ 43187  29944  18398]
 [ 42983 136600  47506]
 [ 17727  25678  47727]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.97199434
{'0': {'precision': 0.4574456612319729, 'recall': 0.4195462760648485, 'f1-score': 0.4376770538243626, 'support': 111213}, '1': {'precision': 0.5950076359997893, 'recall': 0.6032451133760819, 'f1-score': 0.5990980601134186, 'support': 187297}, '2': {'precision': 0.46171337422896463, 'recall': 0.4891945343401654, 'f1-score': 0.4750568526545061, 'support': 111240}, 'accuracy': 0.5224234289200732, 'macro avg': {'precision': 0.5047222238202423, 'recall': 0.503995307927032, 'f1-score': 0.5039439888640957, 'support': 409750}, 'weighted avg': {'precision': 0.5214839420907236, 'recall': 0.5224234289200732, 'f1-score': 0.5216106695334205, 'support': 409750}}
[[ 46659  41382  23172]
 [ 34040 112986  40271]
 [ 21300  35522  54418]]
Evaluating performance on  val set...
532/532 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.81225765
{'0': {'precision': 0.2806540413253292, 'recall': 0.495752533833265, 'f1-score': 0.3584074544684456, 'support': 17069}, '1': {'precision': 0.8571729070256626, 'recall': 0.6383020382589627, 'f1-score': 0.7317210033107008, 'support': 102146}, '2': {'precision': 0.29529439267942426, 'recall': 0.5218674378799504, 'f1-score': 0.37717015740306276, 'support': 16943}, 'accuracy': 0.6059430955213796, 'macro avg': {'precision': 0.47770711367680535, 'recall': 0.5519740033240593, 'f1-score': 0.4890995383940697, 'support': 136158}, 'weighted avg': {'precision': 0.7149814222270661, 'recall': 0.6059430955213796, 'f1-score': 0.6408027763434895, 'support': 136158}}
[[ 8462  5628  2979]
 [18824 65200 18122]
 [ 2865  5236  8842]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.85483384
{'0': {'precision': 0.349773260359656, 'recall': 0.48821372446306965, 'f1-score': 0.4075578958876155, 'support': 22908}, '1': {'precision': 0.7970190834378047, 'recall': 0.631754444076405, 'f1-score': 0.7048287755604828, 'support': 90570}, '2': {'precision': 0.3623622387552866, 'recall': 0.5175485008818342, 'f1-score': 0.4262705863127122, 'support': 22680}, 'accuracy': 0.5885809133506661, 'macro avg': {'precision': 0.5030515275175825, 'recall': 0.5458388898071029, 'f1-score': 0.5128857525869369, 'support': 136158}, 'weighted avg': {'precision': 0.649370582780673, 'recall': 0.5885809133506661, 'f1-score': 0.6084144551115523, 'support': 136158}}
[[11184  7592  4132]
 [16829 57218 16523]
 [ 3962  6980 11738]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8917784
{'0': {'precision': 0.39270433180299197, 'recall': 0.4636601644603415, 'f1-score': 0.42524265277824747, 'support': 27119}, '1': {'precision': 0.7404865520439466, 'recall': 0.6317653933240815, 'f1-score': 0.681819077586037, 'support': 82146}, '2': {'precision': 0.4022141304986198, 'recall': 0.5093146915554233, 'f1-score': 0.44947249249347787, 'support': 26893}, 'accuracy': 0.5740977393910016, 'macro avg': {'precision': 0.5118016714485195, 'recall': 0.5349134164466154, 'f1-score': 0.5188447409525875, 'support': 136158}, 'weighted avg': {'precision': 0.6044044543094549, 'recall': 0.5740977393910016, 'f1-score': 0.5848244626735336, 'support': 136158}}
[[12574  9642  4903]
 [14795 51897 15454]
 [ 4650  8546 13697]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.95038337
{'0': {'precision': 0.445008784539211, 'recall': 0.4125503435204928, 'f1-score': 0.42816529128824554, 'support': 33768}, '1': {'precision': 0.6328762392621264, 'recall': 0.636180860911826, 'f1-score': 0.6345242474735453, 'support': 69136}, '2': {'precision': 0.4460629030433307, 'recall': 0.474258735791183, 'f1-score': 0.459728902492348, 'support': 33254}, 'accuracy': 0.5411727551814803, 'macro avg': {'precision': 0.5079826422815561, 'recall': 0.5076633134078339, 'f1-score': 0.5074728137513796, 'support': 136158}, 'weighted avg': {'precision': 0.540658382847496, 'recall': 0.5411727551814803, 'f1-score': 0.5406555534969157, 'support': 136158}}
[[13931 13587  6250]
 [11818 43983 13335]
 [ 5556 11927 15771]]
training model: results/EXC/W4/deepLOB_L2/seq2seq
Epoch 1/50
1601/1601 - 92s - loss: 10.9729 - accuracy10: 0.4927 - accuracy20: 0.5092 - accuracy30: 0.5131 - accuracy50: 0.5106 - val_loss: 10.5128 - val_accuracy10: 0.5924 - val_accuracy20: 0.5887 - val_accuracy30: 0.5779 - val_accuracy50: 0.5482 - 92s/epoch - 58ms/step
Epoch 2/50
1601/1601 - 84s - loss: 9.8240 - accuracy10: 0.6029 - accuracy20: 0.6033 - accuracy30: 0.5887 - accuracy50: 0.5624 - val_loss: 9.4546 - val_accuracy10: 0.6146 - val_accuracy20: 0.6141 - val_accuracy30: 0.5981 - val_accuracy50: 0.5669 - 84s/epoch - 53ms/step
Epoch 3/50
1601/1601 - 86s - loss: 9.3060 - accuracy10: 0.6452 - accuracy20: 0.6343 - accuracy30: 0.6109 - accuracy50: 0.5768 - val_loss: 9.2141 - val_accuracy10: 0.6490 - val_accuracy20: 0.6449 - val_accuracy30: 0.6267 - val_accuracy50: 0.5869 - 86s/epoch - 53ms/step
Epoch 4/50
1601/1601 - 83s - loss: 9.1343 - accuracy10: 0.6525 - accuracy20: 0.6414 - accuracy30: 0.6173 - accuracy50: 0.5819 - val_loss: 8.9219 - val_accuracy10: 0.6906 - val_accuracy20: 0.6800 - val_accuracy30: 0.6553 - val_accuracy50: 0.6059 - 83s/epoch - 52ms/step
Epoch 5/50
1601/1601 - 84s - loss: 9.0189 - accuracy10: 0.6572 - accuracy20: 0.6458 - accuracy30: 0.6225 - accuracy50: 0.5863 - val_loss: 8.8469 - val_accuracy10: 0.6727 - val_accuracy20: 0.6652 - val_accuracy30: 0.6421 - val_accuracy50: 0.5977 - 84s/epoch - 52ms/step
Epoch 6/50
1601/1601 - 85s - loss: 8.9428 - accuracy10: 0.6612 - accuracy20: 0.6495 - accuracy30: 0.6253 - accuracy50: 0.5893 - val_loss: 8.7973 - val_accuracy10: 0.6639 - val_accuracy20: 0.6591 - val_accuracy30: 0.6388 - val_accuracy50: 0.5981 - 85s/epoch - 53ms/step
Epoch 7/50
1601/1601 - 84s - loss: 8.8900 - accuracy10: 0.6622 - accuracy20: 0.6499 - accuracy30: 0.6261 - accuracy50: 0.5903 - val_loss: 8.8096 - val_accuracy10: 0.6617 - val_accuracy20: 0.6561 - val_accuracy30: 0.6366 - val_accuracy50: 0.5963 - 84s/epoch - 53ms/step
Epoch 8/50
1601/1601 - 82s - loss: 8.8496 - accuracy10: 0.6638 - accuracy20: 0.6516 - accuracy30: 0.6280 - accuracy50: 0.5922 - val_loss: 8.7796 - val_accuracy10: 0.6768 - val_accuracy20: 0.6675 - val_accuracy30: 0.6446 - val_accuracy50: 0.6006 - 82s/epoch - 51ms/step
Epoch 9/50
1601/1601 - 82s - loss: 8.8094 - accuracy10: 0.6650 - accuracy20: 0.6531 - accuracy30: 0.6293 - accuracy50: 0.5935 - val_loss: 8.8021 - val_accuracy10: 0.6883 - val_accuracy20: 0.6766 - val_accuracy30: 0.6520 - val_accuracy50: 0.6040 - 82s/epoch - 51ms/step
Epoch 10/50
1601/1601 - 82s - loss: 8.7761 - accuracy10: 0.6661 - accuracy20: 0.6545 - accuracy30: 0.6305 - accuracy50: 0.5940 - val_loss: 8.7688 - val_accuracy10: 0.6785 - val_accuracy20: 0.6683 - val_accuracy30: 0.6443 - val_accuracy50: 0.6000 - 82s/epoch - 51ms/step
Epoch 11/50
1601/1601 - 81s - loss: 8.7499 - accuracy10: 0.6677 - accuracy20: 0.6556 - accuracy30: 0.6309 - accuracy50: 0.5943 - val_loss: 8.7494 - val_accuracy10: 0.6821 - val_accuracy20: 0.6699 - val_accuracy30: 0.6469 - val_accuracy50: 0.6024 - 81s/epoch - 51ms/step
Epoch 12/50
1601/1601 - 82s - loss: 8.7239 - accuracy10: 0.6681 - accuracy20: 0.6565 - accuracy30: 0.6324 - accuracy50: 0.5957 - val_loss: 8.8109 - val_accuracy10: 0.6813 - val_accuracy20: 0.6703 - val_accuracy30: 0.6459 - val_accuracy50: 0.6020 - 82s/epoch - 51ms/step
Epoch 13/50
1601/1601 - 82s - loss: 8.6988 - accuracy10: 0.6688 - accuracy20: 0.6571 - accuracy30: 0.6327 - accuracy50: 0.5963 - val_loss: 8.9129 - val_accuracy10: 0.6752 - val_accuracy20: 0.6648 - val_accuracy30: 0.6409 - val_accuracy50: 0.5974 - 82s/epoch - 51ms/step
Epoch 14/50
1601/1601 - 82s - loss: 8.6739 - accuracy10: 0.6704 - accuracy20: 0.6583 - accuracy30: 0.6341 - accuracy50: 0.5977 - val_loss: 8.9133 - val_accuracy10: 0.6741 - val_accuracy20: 0.6637 - val_accuracy30: 0.6405 - val_accuracy50: 0.5990 - 82s/epoch - 51ms/step
Epoch 15/50
1601/1601 - 82s - loss: 8.6503 - accuracy10: 0.6705 - accuracy20: 0.6586 - accuracy30: 0.6346 - accuracy50: 0.5978 - val_loss: 8.8386 - val_accuracy10: 0.6804 - val_accuracy20: 0.6698 - val_accuracy30: 0.6464 - val_accuracy50: 0.6017 - 82s/epoch - 51ms/step
Epoch 16/50
1601/1601 - 82s - loss: 8.6288 - accuracy10: 0.6714 - accuracy20: 0.6592 - accuracy30: 0.6356 - accuracy50: 0.5991 - val_loss: 8.9948 - val_accuracy10: 0.6670 - val_accuracy20: 0.6573 - val_accuracy30: 0.6357 - val_accuracy50: 0.5948 - 82s/epoch - 51ms/step
Epoch 17/50
1601/1601 - 82s - loss: 8.6084 - accuracy10: 0.6723 - accuracy20: 0.6604 - accuracy30: 0.6361 - accuracy50: 0.5998 - val_loss: 8.9148 - val_accuracy10: 0.6720 - val_accuracy20: 0.6617 - val_accuracy30: 0.6394 - val_accuracy50: 0.5985 - 82s/epoch - 51ms/step
Epoch 18/50
1601/1601 - 81s - loss: 8.5855 - accuracy10: 0.6741 - accuracy20: 0.6618 - accuracy30: 0.6374 - accuracy50: 0.6008 - val_loss: 8.9762 - val_accuracy10: 0.6559 - val_accuracy20: 0.6454 - val_accuracy30: 0.6247 - val_accuracy50: 0.5875 - 81s/epoch - 51ms/step
Epoch 19/50
1601/1601 - 82s - loss: 8.5682 - accuracy10: 0.6745 - accuracy20: 0.6621 - accuracy30: 0.6377 - accuracy50: 0.6007 - val_loss: 9.0838 - val_accuracy10: 0.6519 - val_accuracy20: 0.6395 - val_accuracy30: 0.6183 - val_accuracy50: 0.5812 - 82s/epoch - 51ms/step
Epoch 20/50
1601/1601 - 82s - loss: 8.5528 - accuracy10: 0.6751 - accuracy20: 0.6625 - accuracy30: 0.6383 - accuracy50: 0.6018 - val_loss: 9.0603 - val_accuracy10: 0.6647 - val_accuracy20: 0.6514 - val_accuracy30: 0.6289 - val_accuracy50: 0.5882 - 82s/epoch - 51ms/step
Epoch 21/50
1601/1601 - 82s - loss: 8.5337 - accuracy10: 0.6756 - accuracy20: 0.6636 - accuracy30: 0.6394 - accuracy50: 0.6024 - val_loss: 9.1666 - val_accuracy10: 0.6578 - val_accuracy20: 0.6441 - val_accuracy30: 0.6212 - val_accuracy50: 0.5816 - 82s/epoch - 51ms/step
testing model: results/EXC/W4/deepLOB_L2/seq2seq
Evaluating performance on  test set...
3782/3782 - 80s - 80s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8460129
{'0': {'precision': 0.353443347319257, 'recall': 0.627176202553411, 'f1-score': 0.45210450152302506, 'support': 116315}, '1': {'precision': 0.9371734626632956, 'recall': 0.5959553768535916, 'f1-score': 0.7285931224080111, 'support': 730204}, '2': {'precision': 0.31865469765689136, 'recall': 0.7799197911605577, 'f1-score': 0.4524501666089408, 'support': 121433}, 'accuracy': 0.622786047242012, 'macro avg': {'precision': 0.5364238358798147, 'recall': 0.6676837901891868, 'f1-score': 0.5443825968466589, 'support': 967952}, 'weighted avg': {'precision': 0.7894335359342176, 'recall': 0.622786047242012, 'f1-score': 0.6607254580095847, 'support': 967952}}
[[ 72950  16344  27021]
 [119552 435169 175483]
 [ 13896  12829  94708]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8516128
{'0': {'precision': 0.42775836148153934, 'recall': 0.5671626335648133, 'f1-score': 0.4876941184981955, 'support': 154513}, '1': {'precision': 0.8855167863042637, 'recall': 0.5944372156547899, 'f1-score': 0.7113520179269027, 'support': 650178}, '2': {'precision': 0.38142590783982955, 'recall': 0.7630971266867164, 'f1-score': 0.5086223789927493, 'support': 163261}, 'accuracy': 0.6185306709423608, 'macro avg': {'precision': 0.5649003518752109, 'recall': 0.6415656586354399, 'f1-score': 0.5692228384726158, 'support': 967952}, 'weighted avg': {'precision': 0.7274221613604487, 'recall': 0.6185306709423608, 'f1-score': 0.6414560968518322, 'support': 967952}}
[[ 87634  28077  38802]
 [100447 386490 163241]
 [ 16787  21890 124584]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8817669
{'0': {'precision': 0.46293467385734155, 'recall': 0.5225743894309436, 'f1-score': 0.4909499334896456, 'support': 181511}, '1': {'precision': 0.8335497888338257, 'recall': 0.5748914439844225, 'f1-score': 0.6804694872170458, 'support': 593933}, '2': {'precision': 0.4059537047254454, 'recall': 0.7452937020799135, 'f1-score': 0.5256120234093803, 'support': 192508}, 'accuracy': 0.5989708167347141, 'macro avg': {'precision': 0.5674793891388709, 'recall': 0.6142531784984265, 'f1-score': 0.5656771480386906, 'support': 967952}, 'weighted avg': {'precision': 0.6790107341141364, 'recall': 0.5989708167347141, 'f1-score': 0.6141323296314423, 'support': 967952}}
[[ 94853  38215  48443]
 [ 90977 341447 161509]
 [ 19065  29968 143475]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.92514104
{'0': {'precision': 0.5025829668931026, 'recall': 0.45282348549919726, 'f1-score': 0.4764074394750164, 'support': 222367}, '1': {'precision': 0.7301014875289015, 'recall': 0.5620502198323643, 'f1-score': 0.6351478688265614, 'support': 507887}, '2': {'precision': 0.4379143798607073, 'recall': 0.6938468140245185, 'f1-score': 0.5369427736584651, 'support': 237698}, 'accuracy': 0.5693226523629271, 'macro avg': {'precision': 0.556866278094237, 'recall': 0.5695735064520266, 'f1-score': 0.5494993606533476, 'support': 967952}, 'weighted avg': {'precision': 0.606082009293684, 'recall': 0.5693226523629271, 'f1-score': 0.5745645054315984, 'support': 967952}}
[[100693  57583  64091]
 [ 74829 285458 147600]
 [ 24829  47943 164926]]
Evaluating performance on  train set...
1601/1601 - 33s - 33s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7621405
{'0': {'precision': 0.42674084111927346, 'recall': 0.6062857818384476, 'f1-score': 0.5009104291225697, 'support': 59213}, '1': {'precision': 0.9208437118558287, 'recall': 0.6364368998628258, 'f1-score': 0.7526696381134693, 'support': 291600}, '2': {'precision': 0.37675681774224745, 'recall': 0.7932099289095506, 'f1-score': 0.5108645172570168, 'support': 58939}, 'accuracy': 0.6546301177297488, 'macro avg': {'precision': 0.5747804569057832, 'recall': 0.6786442035369413, 'f1-score': 0.5881481948310185, 'support': 409752}, 'weighted avg': {'precision': 0.7711794009138833, 'recall': 0.6546301177297488, 'f1-score': 0.6815066662179408, 'support': 409752}}
[[ 35900   9892  13421]
 [ 42099 185585  63916]
 [  6127   6061  46751]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.77679205
{'0': {'precision': 0.5019703264094956, 'recall': 0.5414634146341464, 'f1-score': 0.520969480459487, 'support': 78105}, '1': {'precision': 0.8562768735656441, 'recall': 0.6391995778131351, 'f1-score': 0.731983195816543, 'support': 253916}, '2': {'precision': 0.437454489287054, 'recall': 0.7651387477325649, 'f1-score': 0.5566526899030362, 'support': 77731}, 'accuracy': 0.6444605517483746, 'macro avg': {'precision': 0.5985672297540645, 'recall': 0.6486005800599488, 'f1-score': 0.6032017887263553, 'support': 409752}, 'weighted avg': {'precision': 0.709288950094886, 'recall': 0.6444605517483746, 'f1-score': 0.6585001089905467, 'support': 409752}}
[[ 42291  16585  19229]
 [ 34360 162303  57253]
 [  7599  10657  59475]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8156955
{'0': {'precision': 0.5336025619893093, 'recall': 0.4955606097054257, 'f1-score': 0.5138784951357236, 'support': 91454}, '1': {'precision': 0.7928536586733349, 'recall': 0.6224349663277433, 'f1-score': 0.6973840270055011, 'support': 227190}, '2': {'precision': 0.46168604611466535, 'recall': 0.7421850990033806, 'f1-score': 0.5692577735310583, 'support': 91108}, 'accuracy': 0.6207437669614791, 'macro avg': {'precision': 0.5960474222591032, 'recall': 0.6200602250121832, 'f1-score': 0.5935067652240943, 'support': 409752}, 'weighted avg': {'precision': 0.66135565831913, 'recall': 0.6207437669614791, 'f1-score': 0.6279380167037376, 'support': 409752}}
[[ 45321  22198  23935]
 [ 30872 141411  54907]
 [  8741  14748  67619]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.88180727
{'0': {'precision': 0.5662386283697584, 'recall': 0.42698902205479083, 'f1-score': 0.4868524916194245, 'support': 111223}, '1': {'precision': 0.6719322559428732, 'recall': 0.6108338093433198, 'f1-score': 0.6399279660187522, 'support': 187321}, '2': {'precision': 0.490439801276407, 'recall': 0.6861826487303072, 'f1-score': 0.5720293402198642, 'support': 111208}, 'accuracy': 0.5813809328569476, 'macro avg': {'precision': 0.5762035618630129, 'recall': 0.5746684933761393, 'f1-score': 0.566269932619347, 'support': 409752}, 'weighted avg': {'precision': 0.5939851678551691, 'recall': 0.5813809328569476, 'f1-score': 0.5799492865566407, 'support': 409752}}
[[ 47491  32600  31132]
 [ 24747 114422  48152]
 [ 11633  23266  76309]]
Evaluating performance on  val set...
532/532 - 11s - 11s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.69991505
{'0': {'precision': 0.41058137195735267, 'recall': 0.5964348334307422, 'f1-score': 0.48635767901822946, 'support': 17110}, '1': {'precision': 0.9303221288515406, 'recall': 0.67667744147321, 'f1-score': 0.7834824719585362, 'support': 102090}, '2': {'precision': 0.36062299241504037, 'recall': 0.78782875339073, 'f1-score': 0.4947690028701046, 'support': 16958}, 'accuracy': 0.6804374329822706, 'macro avg': {'precision': 0.5671754977413113, 'recall': 0.6869803427648941, 'f1-score': 0.5882030512822901, 'support': 136158}, 'weighted avg': {'precision': 0.7940560092981561, 'recall': 0.6804374329822706, 'f1-score': 0.7101866816560178, 'support': 136158}}
[[10205  3270  3635]
 [12956 69082 20052]
 [ 1694  1904 13360]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7212023
{'0': {'precision': 0.4889476213358962, 'recall': 0.5319102592027881, 'f1-score': 0.5095249024558183, 'support': 22955}, '1': {'precision': 0.8734463276836159, 'recall': 0.6832243238465617, 'f1-score': 0.766712953779012, 'support': 90512}, '2': {'precision': 0.4258406378447977, 'recall': 0.7579216429421356, 'f1-score': 0.5453017740222268, 'support': 22691}, 'accuracy': 0.6701626052086547, 'macro avg': {'precision': 0.5960781956214366, 'recall': 0.6576854086638285, 'f1-score': 0.6071798767523523, 'support': 136158}, 'weighted avg': {'precision': 0.734028970551868, 'recall': 0.6701626052086547, 'f1-score': 0.6864547772636027, 'support': 136158}}
[[12210  5588  5157]
 [10641 61840 18031]
 [ 2121  3372 17198]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.76489973
{'0': {'precision': 0.5231006769864207, 'recall': 0.48648748159057437, 'f1-score': 0.5041301818043077, 'support': 27160}, '1': {'precision': 0.8172736824969291, 'recall': 0.6724465442501583, 'f1-score': 0.7378202344767693, 'support': 82124}, '2': {'precision': 0.45349427621861155, 'recall': 0.7311527870804495, 'f1-score': 0.5597846215207544, 'support': 26874}, 'accuracy': 0.6469395848940201, 'macro avg': {'precision': 0.5979562119006538, 'recall': 0.630028937640394, 'f1-score': 0.6005783459339438, 'support': 136158}, 'weighted avg': {'precision': 0.6867933097388912, 'recall': 0.6469395848940201, 'f1-score': 0.6560655752340954, 'support': 136158}}
[[13213  7582  6365]
 [ 9586 55224 17314]
 [ 2460  4765 19649]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8423761
{'0': {'precision': 0.5616961414790996, 'recall': 0.413779830638953, 'f1-score': 0.47652334026664844, 'support': 33774}, '1': {'precision': 0.7031781632871027, 'recall': 0.6667679398148149, 'f1-score': 0.6844891988029199, 'support': 69120}, '2': {'precision': 0.4820604762008877, 'recall': 0.6628186628186629, 'f1-score': 0.55817014974494, 'support': 33264}, 'accuracy': 0.6030493984929274, 'macro avg': {'precision': 0.5823115936556967, 'recall': 0.5811221444241436, 'f1-score': 0.5730608962715028, 'support': 136158}, 'weighted avg': {'precision': 0.6140635130441543, 'recall': 0.6030493984929274, 'f1-score': 0.6020429543364275, 'support': 136158}}
[[13975 11449  8350]
 [ 7694 46087 15339]
 [ 3211  8005 22048]]
training model: results/EXC/W4/deepOF_L2/seq2seq
Epoch 1/50
1601/1601 - 59s - loss: 10.3794 - accuracy10: 0.5687 - accuracy20: 0.5753 - accuracy30: 0.5660 - accuracy50: 0.5428 - val_loss: 9.5606 - val_accuracy10: 0.7386 - val_accuracy20: 0.7136 - val_accuracy30: 0.6810 - val_accuracy50: 0.6134 - 59s/epoch - 37ms/step
Epoch 2/50
1601/1601 - 54s - loss: 9.4104 - accuracy10: 0.6331 - accuracy20: 0.6282 - accuracy30: 0.6095 - accuracy50: 0.5769 - val_loss: 9.3209 - val_accuracy10: 0.7252 - val_accuracy20: 0.7067 - val_accuracy30: 0.6789 - val_accuracy50: 0.6166 - 54s/epoch - 34ms/step
Epoch 3/50
1601/1601 - 53s - loss: 9.2392 - accuracy10: 0.6411 - accuracy20: 0.6337 - accuracy30: 0.6142 - accuracy50: 0.5812 - val_loss: 9.2033 - val_accuracy10: 0.7268 - val_accuracy20: 0.7074 - val_accuracy30: 0.6797 - val_accuracy50: 0.6160 - 53s/epoch - 33ms/step
Epoch 4/50
1601/1601 - 53s - loss: 9.1389 - accuracy10: 0.6461 - accuracy20: 0.6373 - accuracy30: 0.6175 - accuracy50: 0.5846 - val_loss: 9.1118 - val_accuracy10: 0.7248 - val_accuracy20: 0.7056 - val_accuracy30: 0.6789 - val_accuracy50: 0.6187 - 53s/epoch - 33ms/step
Epoch 5/50
1601/1601 - 53s - loss: 9.0742 - accuracy10: 0.6499 - accuracy20: 0.6410 - accuracy30: 0.6204 - accuracy50: 0.5870 - val_loss: 9.1213 - val_accuracy10: 0.7219 - val_accuracy20: 0.7026 - val_accuracy30: 0.6767 - val_accuracy50: 0.6181 - 53s/epoch - 33ms/step
Epoch 6/50
1601/1601 - 54s - loss: 9.0230 - accuracy10: 0.6519 - accuracy20: 0.6421 - accuracy30: 0.6217 - accuracy50: 0.5881 - val_loss: 9.1362 - val_accuracy10: 0.7081 - val_accuracy20: 0.6934 - val_accuracy30: 0.6694 - val_accuracy50: 0.6155 - 54s/epoch - 33ms/step
Epoch 7/50
1601/1601 - 53s - loss: 8.9848 - accuracy10: 0.6536 - accuracy20: 0.6446 - accuracy30: 0.6234 - accuracy50: 0.5903 - val_loss: 9.0916 - val_accuracy10: 0.7085 - val_accuracy20: 0.6951 - val_accuracy30: 0.6707 - val_accuracy50: 0.6170 - 53s/epoch - 33ms/step
Epoch 8/50
1601/1601 - 53s - loss: 8.9558 - accuracy10: 0.6555 - accuracy20: 0.6457 - accuracy30: 0.6237 - accuracy50: 0.5909 - val_loss: 9.1106 - val_accuracy10: 0.7023 - val_accuracy20: 0.6891 - val_accuracy30: 0.6666 - val_accuracy50: 0.6151 - 53s/epoch - 33ms/step
Epoch 9/50
1601/1601 - 53s - loss: 8.9244 - accuracy10: 0.6561 - accuracy20: 0.6475 - accuracy30: 0.6248 - accuracy50: 0.5913 - val_loss: 9.1155 - val_accuracy10: 0.6992 - val_accuracy20: 0.6869 - val_accuracy30: 0.6648 - val_accuracy50: 0.6136 - 53s/epoch - 33ms/step
Epoch 10/50
1601/1601 - 53s - loss: 8.8993 - accuracy10: 0.6570 - accuracy20: 0.6481 - accuracy30: 0.6262 - accuracy50: 0.5922 - val_loss: 9.0358 - val_accuracy10: 0.7021 - val_accuracy20: 0.6887 - val_accuracy30: 0.6651 - val_accuracy50: 0.6136 - 53s/epoch - 33ms/step
Epoch 11/50
1601/1601 - 53s - loss: 8.8752 - accuracy10: 0.6582 - accuracy20: 0.6491 - accuracy30: 0.6263 - accuracy50: 0.5925 - val_loss: 9.0730 - val_accuracy10: 0.6997 - val_accuracy20: 0.6876 - val_accuracy30: 0.6640 - val_accuracy50: 0.6126 - 53s/epoch - 33ms/step
Epoch 12/50
1601/1601 - 53s - loss: 8.8483 - accuracy10: 0.6588 - accuracy20: 0.6501 - accuracy30: 0.6273 - accuracy50: 0.5933 - val_loss: 9.0960 - val_accuracy10: 0.7025 - val_accuracy20: 0.6891 - val_accuracy30: 0.6637 - val_accuracy50: 0.6124 - 53s/epoch - 33ms/step
Epoch 13/50
1601/1601 - 53s - loss: 8.8269 - accuracy10: 0.6598 - accuracy20: 0.6508 - accuracy30: 0.6275 - accuracy50: 0.5940 - val_loss: 9.1078 - val_accuracy10: 0.6952 - val_accuracy20: 0.6835 - val_accuracy30: 0.6606 - val_accuracy50: 0.6104 - 53s/epoch - 33ms/step
Epoch 14/50
1601/1601 - 53s - loss: 8.8006 - accuracy10: 0.6610 - accuracy20: 0.6518 - accuracy30: 0.6287 - accuracy50: 0.5947 - val_loss: 9.0801 - val_accuracy10: 0.6939 - val_accuracy20: 0.6823 - val_accuracy30: 0.6591 - val_accuracy50: 0.6108 - 53s/epoch - 33ms/step
Epoch 15/50
1601/1601 - 53s - loss: 8.7832 - accuracy10: 0.6616 - accuracy20: 0.6523 - accuracy30: 0.6294 - accuracy50: 0.5956 - val_loss: 9.1302 - val_accuracy10: 0.6939 - val_accuracy20: 0.6818 - val_accuracy30: 0.6588 - val_accuracy50: 0.6108 - 53s/epoch - 33ms/step
Epoch 16/50
1601/1601 - 53s - loss: 8.7558 - accuracy10: 0.6632 - accuracy20: 0.6538 - accuracy30: 0.6302 - accuracy50: 0.5967 - val_loss: 9.0429 - val_accuracy10: 0.6953 - val_accuracy20: 0.6818 - val_accuracy30: 0.6581 - val_accuracy50: 0.6093 - 53s/epoch - 33ms/step
Epoch 17/50
1601/1601 - 53s - loss: 8.7392 - accuracy10: 0.6629 - accuracy20: 0.6538 - accuracy30: 0.6303 - accuracy50: 0.5967 - val_loss: 9.1084 - val_accuracy10: 0.6963 - val_accuracy20: 0.6826 - val_accuracy30: 0.6593 - val_accuracy50: 0.6095 - 53s/epoch - 33ms/step
Epoch 18/50
1601/1601 - 53s - loss: 8.7169 - accuracy10: 0.6644 - accuracy20: 0.6545 - accuracy30: 0.6311 - accuracy50: 0.5971 - val_loss: 9.1588 - val_accuracy10: 0.7035 - val_accuracy20: 0.6885 - val_accuracy30: 0.6635 - val_accuracy50: 0.6117 - 53s/epoch - 33ms/step
Epoch 19/50
1601/1601 - 53s - loss: 8.6970 - accuracy10: 0.6643 - accuracy20: 0.6553 - accuracy30: 0.6320 - accuracy50: 0.5979 - val_loss: 9.0838 - val_accuracy10: 0.6969 - val_accuracy20: 0.6823 - val_accuracy30: 0.6562 - val_accuracy50: 0.6070 - 53s/epoch - 33ms/step
Epoch 20/50
1601/1601 - 53s - loss: 8.6782 - accuracy10: 0.6651 - accuracy20: 0.6557 - accuracy30: 0.6327 - accuracy50: 0.5991 - val_loss: 9.1037 - val_accuracy10: 0.7047 - val_accuracy20: 0.6887 - val_accuracy30: 0.6633 - val_accuracy50: 0.6131 - 53s/epoch - 33ms/step
testing model: results/EXC/W4/deepOF_L2/seq2seq
Evaluating performance on  test set...
3782/3782 - 52s - 52s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.75788194
{'0': {'precision': 0.3668453612726967, 'recall': 0.5806831566548881, 'f1-score': 0.4496348518437153, 'support': 116313}, '1': {'precision': 0.9134706232757023, 'recall': 0.6951227194666681, 'f1-score': 0.7894775726496523, 'support': 730202}, '2': {'precision': 0.35773576305801713, 'recall': 0.6721896024968501, 'f1-score': 0.46695861352890533, 'support': 121433}, 'accuracy': 0.6784940926578701, 'macro avg': {'precision': 0.5460172492021387, 'recall': 0.6493318262061355, 'f1-score': 0.5686903460074243, 'support': 967948}, 'weighted avg': {'precision': 0.7780664741063567, 'recall': 0.6784940926578701, 'f1-score': 0.7081792269244578, 'support': 967948}}
[[ 67541  22487  26285]
 [102359 507580 120263]
 [ 14213  25594  81626]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.78043354
{'0': {'precision': 0.43210143807020257, 'recall': 0.5425633126444072, 'f1-score': 0.48107287652680897, 'support': 154511}, '1': {'precision': 0.8553505700272561, 'recall': 0.7051798282311251, 'f1-score': 0.7730396905082857, 'support': 650176}, '2': {'precision': 0.43105615124983715, 'recall': 0.6281536925536411, 'f1-score': 0.5112669877259629, 'support': 163261}, 'accuracy': 0.6662300040911289, 'macro avg': {'precision': 0.5728360531157654, 'recall': 0.6252989444763911, 'f1-score': 0.5884598515870191, 'support': 967948}, 'weighted avg': {'precision': 0.716223904409024, 'recall': 0.6662300040911289, 'f1-score': 0.682281346440178, 'support': 967948}}
[[ 83832  35974  34705]
 [ 91032 458491 100653]
 [ 19146  41562 102553]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8219607
{'0': {'precision': 0.46078972732018797, 'recall': 0.5057214793756784, 'f1-score': 0.48221119624287856, 'support': 181509}, '1': {'precision': 0.7985378937487693, 'recall': 0.7032791632712162, 'f1-score': 0.7478874462517445, 'support': 593932}, '2': {'precision': 0.46075250652327004, 'recall': 0.5879682297267113, 'f1-score': 0.5166443767887056, 'support': 192507}, 'accuracy': 0.6433000533086488, 'macro avg': {'precision': 0.5733600425307425, 'recall': 0.5989896241245353, 'f1-score': 0.5822476730944429, 'support': 967948}, 'weighted avg': {'precision': 0.6680242881843127, 'recall': 0.6433000533086488, 'f1-score': 0.6520780225678479, 'support': 967948}}
[[ 91793  49240  40476]
 [ 84237 417700  91995]
 [ 23178  56141 113188]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.88591367
{'0': {'precision': 0.49355698959754085, 'recall': 0.4361317479448112, 'f1-score': 0.46307084057528125, 'support': 222364}, '1': {'precision': 0.6925905978302686, 'recall': 0.7089450999927149, 'f1-score': 0.7006724286730359, 'support': 507887}, '2': {'precision': 0.49445893089960885, 'recall': 0.5233301219619936, 'f1-score': 0.508485038005367, 'support': 237697}, 'accuracy': 0.6006913594531937, 'macro avg': {'precision': 0.5602021727758061, 'recall': 0.5561356566331733, 'f1-score': 0.5574094357512281, 'support': 967948}, 'weighted avg': {'precision': 0.5982123749345352, 'recall': 0.6006913594531937, 'f1-score': 0.59889381480607, 'support': 967948}}
[[ 96980  75494  49890]
 [ 70531 360064  77292]
 [ 28981  84322 124394]]
Evaluating performance on  train set...
1601/1601 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7575841
{'0': {'precision': 0.42219189461816886, 'recall': 0.5994372272489848, 'f1-score': 0.495439163312769, 'support': 59349}, '1': {'precision': 0.9061563859287907, 'recall': 0.6704579765041722, 'f1-score': 0.7706891315751071, 'support': 291456}, '2': {'precision': 0.387658299875272, 'recall': 0.7223683094410043, 'f1-score': 0.5045501943312163, 'support': 58945}, 'accuracy': 0.6676388041488712, 'macro avg': {'precision': 0.5720021934740772, 'recall': 0.6640878377313871, 'f1-score': 0.5902261630730308, 'support': 409750}, 'weighted avg': {'precision': 0.7614689465701117, 'recall': 0.6676388041488712, 'f1-score': 0.6925356964994691, 'support': 409750}}
[[ 35576  10685  13088]
 [ 41876 195409  54171]
 [  6813   9552  42580]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.77718526
{'0': {'precision': 0.490183489338695, 'recall': 0.5564107809543293, 'f1-score': 0.5212017414112138, 'support': 78212}, '1': {'precision': 0.8398821885371581, 'recall': 0.6819195373317785, 'f1-score': 0.7527026204329411, 'support': 253832}, '2': {'precision': 0.458125505967148, 'recall': 0.6772836074434406, 'f1-score': 0.5465534698964094, 'support': 77706}, 'accuracy': 0.6570835875533863, 'macro avg': {'precision': 0.596063727947667, 'recall': 0.6385379752431827, 'f1-score': 0.6068192772468548, 'support': 409750}, 'weighted avg': {'precision': 0.7007353442723738, 'recall': 0.6570835875533863, 'f1-score': 0.6694197097761039, 'support': 409750}}
[[ 43518  17232  17462]
 [ 35951 173093  44788]
 [  9310  15767  52629]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.818002
{'0': {'precision': 0.5185576441375706, 'recall': 0.5202176359405216, 'f1-score': 0.5193863136824998, 'support': 91529}, '1': {'precision': 0.7747665336402658, 'recall': 0.6787911347533346, 'f1-score': 0.723610305905217, 'support': 227089}, '2': {'precision': 0.48930822896528536, 'recall': 0.6387767194838256, 'f1-score': 0.5541403699155647, 'support': 91132}, 'accuracy': 0.6344697986577181, 'macro avg': {'precision': 0.5942108022477073, 'recall': 0.6125951633925607, 'f1-score': 0.5990456631677605, 'support': 409750}, 'weighted avg': {'precision': 0.6540467540943657, 'recall': 0.6344697986577181, 'f1-score': 0.6402996238045163, 'support': 409750}}
[[ 47615  23430  20484]
 [ 32670 154146  40273]
 [ 11537  21382  58213]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8867932
{'0': {'precision': 0.5462605384824585, 'recall': 0.45152095528400454, 'f1-score': 0.49439297423426437, 'support': 111213}, '1': {'precision': 0.6511474571939688, 'recall': 0.6801870825480387, 'f1-score': 0.6653505576489698, 'support': 187297}, '2': {'precision': 0.5202619193779415, 'recall': 0.5714041711614527, 'f1-score': 0.5446350920035131, 'support': 111240}, 'accuracy': 0.5885906040268456, 'macro avg': {'precision': 0.5725566383514562, 'recall': 0.5677040696644986, 'f1-score': 0.5681262079622491, 'support': 409750}, 'weighted avg': {'precision': 0.5871462464134488, 'recall': 0.5885906040268456, 'f1-score': 0.586177661681428, 'support': 409750}}
[[ 50215  35503  25495]
 [ 26783 127397  33117]
 [ 14927  32750  63563]]
Evaluating performance on  val set...
532/532 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6833924
{'0': {'precision': 0.41005137553861454, 'recall': 0.5798230710645029, 'f1-score': 0.4803785948307244, 'support': 17069}, '1': {'precision': 0.9153914833461472, 'recall': 0.7226812601570302, 'f1-score': 0.8077007243363896, 'support': 102146}, '2': {'precision': 0.3791268323773104, 'recall': 0.7021778905742785, 'f1-score': 0.4923949258117253, 'support': 16943}, 'accuracy': 0.7022209491913806, 'macro avg': {'precision': 0.5681898970873575, 'recall': 0.6682274072652706, 'f1-score': 0.5934914149929464, 'support': 136158}, 'weighted avg': {'precision': 0.7853103843175792, 'recall': 0.7022209491913806, 'f1-score': 0.727431569582827, 'support': 136158}}
[[ 9897  3686  3486]
 [12330 73819 15997]
 [ 1909  3137 11897]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7124508
{'0': {'precision': 0.48441959573053917, 'recall': 0.5408590885280251, 'f1-score': 0.5110859028565536, 'support': 22908}, '1': {'precision': 0.8558027166300423, 'recall': 0.7352986640167826, 'f1-score': 0.7909874277705523, 'support': 90570}, '2': {'precision': 0.45067757294591626, 'recall': 0.6510582010582011, 'f1-score': 0.5326455522689562, 'support': 22680}, 'accuracy': 0.6885530045975998, 'macro avg': {'precision': 0.5969666284354992, 'recall': 0.6424053178676696, 'f1-score': 0.6115729609653541, 'support': 136158}, 'weighted avg': {'precision': 0.7258369210666394, 'recall': 0.6885530045975998, 'f1-score': 0.7008628822491281, 'support': 136158}}
[[12390  5909  4609]
 [10585 66596 13389]
 [ 2602  5312 14766]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7602896
{'0': {'precision': 0.5148477397389825, 'recall': 0.5018621630591098, 'f1-score': 0.5082720244986368, 'support': 27119}, '1': {'precision': 0.7967843199324681, 'recall': 0.7353857765442018, 'f1-score': 0.7648548385054633, 'support': 82146}, '2': {'precision': 0.4849441118353142, 'recall': 0.6114230468895252, 'f1-score': 0.5408881578947369, 'support': 26893}, 'accuracy': 0.6643898999691534, 'macro avg': {'precision': 0.5988587238355882, 'recall': 0.6162236621642789, 'f1-score': 0.6046716736329457, 'support': 136158}, 'weighted avg': {'precision': 0.6790376077699518, 'recall': 0.6643898999691534, 'f1-score': 0.6695140926461279, 'support': 136158}}
[[13610  8148  5361]
 [ 9634 60409 12103]
 [ 3191  7259 16443]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.845743
{'0': {'precision': 0.5482577276682683, 'recall': 0.4291340914475243, 'f1-score': 0.481436568713766, 'support': 33768}, '1': {'precision': 0.6796768775493881, 'recall': 0.7375028928488776, 'f1-score': 0.7074101308323043, 'support': 69136}, '2': {'precision': 0.517992451525541, 'recall': 0.5406567630961688, 'f1-score': 0.5290820005002722, 'support': 33254}, 'accuracy': 0.6129496614227589, 'macro avg': {'precision': 0.5819756855810657, 'recall': 0.5690979157975237, 'f1-score': 0.5726429000154475, 'support': 136158}, 'weighted avg': {'precision': 0.607595797068016, 'recall': 0.6129496614227589, 'f1-score': 0.6078140814508489, 'support': 136158}}
[[14491 12621  6656]
 [ 8074 50988 10074]
 [ 3866 11409 17979]]
training model: results/EXC/W4/deepVOL_L2/seq2seq
Epoch 1/50
1601/1601 - 61s - loss: 10.1795 - accuracy10: 0.5895 - accuracy20: 0.5896 - accuracy30: 0.5756 - accuracy50: 0.5487 - val_loss: 10.0319 - val_accuracy10: 0.7485 - val_accuracy20: 0.7173 - val_accuracy30: 0.6800 - val_accuracy50: 0.6062 - 61s/epoch - 38ms/step
Epoch 2/50
1601/1601 - 52s - loss: 9.5600 - accuracy10: 0.6272 - accuracy20: 0.6247 - accuracy30: 0.6067 - accuracy50: 0.5712 - val_loss: 9.7084 - val_accuracy10: 0.7555 - val_accuracy20: 0.7207 - val_accuracy30: 0.6818 - val_accuracy50: 0.6080 - 52s/epoch - 33ms/step
Epoch 3/50
1601/1601 - 52s - loss: 9.3152 - accuracy10: 0.6418 - accuracy20: 0.6347 - accuracy30: 0.6130 - accuracy50: 0.5754 - val_loss: 9.4869 - val_accuracy10: 0.7677 - val_accuracy20: 0.7307 - val_accuracy30: 0.6904 - val_accuracy50: 0.6144 - 52s/epoch - 33ms/step
Epoch 4/50
1601/1601 - 53s - loss: 9.1855 - accuracy10: 0.6481 - accuracy20: 0.6390 - accuracy30: 0.6169 - accuracy50: 0.5796 - val_loss: 9.4335 - val_accuracy10: 0.7681 - val_accuracy20: 0.7304 - val_accuracy30: 0.6902 - val_accuracy50: 0.6160 - 53s/epoch - 33ms/step
Epoch 5/50
1601/1601 - 52s - loss: 9.1066 - accuracy10: 0.6525 - accuracy20: 0.6421 - accuracy30: 0.6189 - accuracy50: 0.5816 - val_loss: 9.5025 - val_accuracy10: 0.7735 - val_accuracy20: 0.7340 - val_accuracy30: 0.6926 - val_accuracy50: 0.6159 - 52s/epoch - 32ms/step
Epoch 6/50
1601/1601 - 51s - loss: 9.0509 - accuracy10: 0.6551 - accuracy20: 0.6441 - accuracy30: 0.6211 - accuracy50: 0.5839 - val_loss: 9.5312 - val_accuracy10: 0.7757 - val_accuracy20: 0.7354 - val_accuracy30: 0.6933 - val_accuracy50: 0.6156 - 51s/epoch - 32ms/step
Epoch 7/50
1601/1601 - 53s - loss: 9.0066 - accuracy10: 0.6579 - accuracy20: 0.6461 - accuracy30: 0.6229 - accuracy50: 0.5856 - val_loss: 9.4077 - val_accuracy10: 0.7721 - val_accuracy20: 0.7333 - val_accuracy30: 0.6928 - val_accuracy50: 0.6175 - 53s/epoch - 33ms/step
Epoch 8/50
1601/1601 - 52s - loss: 8.9716 - accuracy10: 0.6594 - accuracy20: 0.6469 - accuracy30: 0.6233 - accuracy50: 0.5865 - val_loss: 9.4812 - val_accuracy10: 0.7745 - val_accuracy20: 0.7356 - val_accuracy30: 0.6953 - val_accuracy50: 0.6182 - 52s/epoch - 32ms/step
Epoch 9/50
1601/1601 - 52s - loss: 8.9379 - accuracy10: 0.6618 - accuracy20: 0.6480 - accuracy30: 0.6244 - accuracy50: 0.5871 - val_loss: 9.3853 - val_accuracy10: 0.7708 - val_accuracy20: 0.7335 - val_accuracy30: 0.6935 - val_accuracy50: 0.6191 - 52s/epoch - 33ms/step
Epoch 10/50
1601/1601 - 52s - loss: 8.9156 - accuracy10: 0.6625 - accuracy20: 0.6485 - accuracy30: 0.6253 - accuracy50: 0.5883 - val_loss: 9.3572 - val_accuracy10: 0.7718 - val_accuracy20: 0.7337 - val_accuracy30: 0.6943 - val_accuracy50: 0.6183 - 52s/epoch - 32ms/step
Epoch 11/50
1601/1601 - 52s - loss: 8.8873 - accuracy10: 0.6640 - accuracy20: 0.6498 - accuracy30: 0.6262 - accuracy50: 0.5891 - val_loss: 9.2959 - val_accuracy10: 0.7700 - val_accuracy20: 0.7332 - val_accuracy30: 0.6943 - val_accuracy50: 0.6193 - 52s/epoch - 33ms/step
Epoch 12/50
1601/1601 - 52s - loss: 8.8649 - accuracy10: 0.6649 - accuracy20: 0.6501 - accuracy30: 0.6260 - accuracy50: 0.5896 - val_loss: 9.3259 - val_accuracy10: 0.7685 - val_accuracy20: 0.7314 - val_accuracy30: 0.6923 - val_accuracy50: 0.6185 - 52s/epoch - 32ms/step
Epoch 13/50
1601/1601 - 51s - loss: 8.8450 - accuracy10: 0.6662 - accuracy20: 0.6508 - accuracy30: 0.6270 - accuracy50: 0.5905 - val_loss: 9.3125 - val_accuracy10: 0.7708 - val_accuracy20: 0.7339 - val_accuracy30: 0.6937 - val_accuracy50: 0.6190 - 51s/epoch - 32ms/step
Epoch 14/50
1601/1601 - 52s - loss: 8.8245 - accuracy10: 0.6669 - accuracy20: 0.6523 - accuracy30: 0.6277 - accuracy50: 0.5914 - val_loss: 9.2184 - val_accuracy10: 0.7663 - val_accuracy20: 0.7306 - val_accuracy30: 0.6916 - val_accuracy50: 0.6196 - 52s/epoch - 32ms/step
Epoch 15/50
1601/1601 - 51s - loss: 8.8071 - accuracy10: 0.6678 - accuracy20: 0.6530 - accuracy30: 0.6286 - accuracy50: 0.5924 - val_loss: 9.2163 - val_accuracy10: 0.7685 - val_accuracy20: 0.7323 - val_accuracy30: 0.6935 - val_accuracy50: 0.6188 - 51s/epoch - 32ms/step
Epoch 16/50
1601/1601 - 52s - loss: 8.7920 - accuracy10: 0.6685 - accuracy20: 0.6535 - accuracy30: 0.6290 - accuracy50: 0.5923 - val_loss: 9.1723 - val_accuracy10: 0.7632 - val_accuracy20: 0.7286 - val_accuracy30: 0.6914 - val_accuracy50: 0.6193 - 52s/epoch - 32ms/step
Epoch 17/50
1601/1601 - 52s - loss: 8.7757 - accuracy10: 0.6688 - accuracy20: 0.6538 - accuracy30: 0.6292 - accuracy50: 0.5933 - val_loss: 9.2123 - val_accuracy10: 0.7662 - val_accuracy20: 0.7311 - val_accuracy30: 0.6924 - val_accuracy50: 0.6196 - 52s/epoch - 32ms/step
Epoch 18/50
1601/1601 - 52s - loss: 8.7616 - accuracy10: 0.6699 - accuracy20: 0.6545 - accuracy30: 0.6300 - accuracy50: 0.5941 - val_loss: 9.0402 - val_accuracy10: 0.7593 - val_accuracy20: 0.7262 - val_accuracy30: 0.6902 - val_accuracy50: 0.6198 - 52s/epoch - 33ms/step
Epoch 19/50
1601/1601 - 52s - loss: 8.7466 - accuracy10: 0.6700 - accuracy20: 0.6544 - accuracy30: 0.6306 - accuracy50: 0.5945 - val_loss: 9.1327 - val_accuracy10: 0.7655 - val_accuracy20: 0.7305 - val_accuracy30: 0.6925 - val_accuracy50: 0.6185 - 52s/epoch - 32ms/step
Epoch 20/50
1601/1601 - 52s - loss: 8.7389 - accuracy10: 0.6702 - accuracy20: 0.6555 - accuracy30: 0.6315 - accuracy50: 0.5953 - val_loss: 9.1359 - val_accuracy10: 0.7640 - val_accuracy20: 0.7287 - val_accuracy30: 0.6916 - val_accuracy50: 0.6204 - 52s/epoch - 33ms/step
Epoch 21/50
1601/1601 - 52s - loss: 8.7184 - accuracy10: 0.6713 - accuracy20: 0.6561 - accuracy30: 0.6321 - accuracy50: 0.5957 - val_loss: 9.0815 - val_accuracy10: 0.7571 - val_accuracy20: 0.7251 - val_accuracy30: 0.6889 - val_accuracy50: 0.6192 - 52s/epoch - 32ms/step
Epoch 22/50
1601/1601 - 52s - loss: 8.7031 - accuracy10: 0.6717 - accuracy20: 0.6568 - accuracy30: 0.6330 - accuracy50: 0.5967 - val_loss: 9.1041 - val_accuracy10: 0.7612 - val_accuracy20: 0.7271 - val_accuracy30: 0.6912 - val_accuracy50: 0.6190 - 52s/epoch - 32ms/step
Epoch 23/50
1601/1601 - 52s - loss: 8.6910 - accuracy10: 0.6722 - accuracy20: 0.6574 - accuracy30: 0.6337 - accuracy50: 0.5974 - val_loss: 9.1172 - val_accuracy10: 0.7576 - val_accuracy20: 0.7249 - val_accuracy30: 0.6882 - val_accuracy50: 0.6190 - 52s/epoch - 32ms/step
Epoch 24/50
1601/1601 - 51s - loss: 8.6780 - accuracy10: 0.6728 - accuracy20: 0.6574 - accuracy30: 0.6338 - accuracy50: 0.5975 - val_loss: 9.0893 - val_accuracy10: 0.7592 - val_accuracy20: 0.7258 - val_accuracy30: 0.6898 - val_accuracy50: 0.6188 - 51s/epoch - 32ms/step
Epoch 25/50
1601/1601 - 52s - loss: 8.6686 - accuracy10: 0.6731 - accuracy20: 0.6572 - accuracy30: 0.6341 - accuracy50: 0.5975 - val_loss: 9.1070 - val_accuracy10: 0.7585 - val_accuracy20: 0.7238 - val_accuracy30: 0.6872 - val_accuracy50: 0.6182 - 52s/epoch - 32ms/step
Epoch 26/50
1601/1601 - 52s - loss: 8.6534 - accuracy10: 0.6738 - accuracy20: 0.6583 - accuracy30: 0.6350 - accuracy50: 0.5987 - val_loss: 9.1338 - val_accuracy10: 0.7578 - val_accuracy20: 0.7248 - val_accuracy30: 0.6869 - val_accuracy50: 0.6175 - 52s/epoch - 32ms/step
Epoch 27/50
1601/1601 - 52s - loss: 8.6397 - accuracy10: 0.6740 - accuracy20: 0.6588 - accuracy30: 0.6356 - accuracy50: 0.5994 - val_loss: 9.1485 - val_accuracy10: 0.7574 - val_accuracy20: 0.7236 - val_accuracy30: 0.6867 - val_accuracy50: 0.6160 - 52s/epoch - 32ms/step
Epoch 28/50
1601/1601 - 52s - loss: 8.6253 - accuracy10: 0.6744 - accuracy20: 0.6589 - accuracy30: 0.6355 - accuracy50: 0.5995 - val_loss: 9.1289 - val_accuracy10: 0.7561 - val_accuracy20: 0.7224 - val_accuracy30: 0.6871 - val_accuracy50: 0.6183 - 52s/epoch - 32ms/step
testing model: results/EXC/W4/deepVOL_L2/seq2seq
Evaluating performance on  test set...
3782/3782 - 53s - 53s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5694252
{'0': {'precision': 0.45619745050176297, 'recall': 0.5205863388213042, 'f1-score': 0.4862696599437054, 'support': 116315}, '1': {'precision': 0.8978880279172902, 'recall': 0.8118525781836309, 'f1-score': 0.8527056183654095, 'support': 730204}, '2': {'precision': 0.4334796324235359, 'recall': 0.624640748396235, 'f1-score': 0.5117925085268389, 'support': 121433}, 'accuracy': 0.7533658693819528, 'macro avg': {'precision': 0.5958550369475297, 'recall': 0.6523598884670566, 'f1-score': 0.6169225956119846, 'support': 967952}, 'weighted avg': {'precision': 0.7865501266555746, 'recall': 0.7533658693819528, 'f1-score': 0.7659036899941186, 'support': 967952}}
[[ 60552  34862  20901]
 [ 59155 592818  78231]
 [ 13025  32556  75852]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6305292
{'0': {'precision': 0.5239287085437524, 'recall': 0.4592687993890482, 'f1-score': 0.4894725769683091, 'support': 154513}, '1': {'precision': 0.8319527273862678, 'recall': 0.8196201655546634, 'f1-score': 0.8257404018538518, 'support': 650178}, '2': {'precision': 0.501963868978163, 'recall': 0.5902266922290076, 'f1-score': 0.5425289038901667, 'support': 163261}, 'accuracy': 0.7234067391771493, 'macro avg': {'precision': 0.6192817683027277, 'recall': 0.6230385523909064, 'f1-score': 0.6192472942374425, 'support': 967952}, 'weighted avg': {'precision': 0.7271251881736011, 'recall': 0.7234067391771493, 'f1-score': 0.7242941082405434, 'support': 967952}}
[[ 70963  55753  27797]
 [ 49469 532899  67810]
 [ 15012  51888  96361]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7006909
{'0': {'precision': 0.5530911826259226, 'recall': 0.4091377382087036, 'f1-score': 0.47034644372664514, 'support': 181511}, '1': {'precision': 0.7707184336622981, 'recall': 0.8178582432698638, 'f1-score': 0.7935889193942458, 'support': 593933}, '2': {'precision': 0.5249258933355618, 'recall': 0.5546886363164129, 'f1-score': 0.5393970161467528, 'support': 192508}, 'accuracy': 0.6888750681851993, 'macro avg': {'precision': 0.6162451698745942, 'recall': 0.5938948725983267, 'f1-score': 0.6011107930892146, 'support': 967952}, 'weighted avg': {'precision': 0.6810251737526303, 'recall': 0.6888750681851993, 'f1-score': 0.6824201425217663, 'support': 967952}}
[[ 74263  74764  32484]
 [ 44023 485753  64157]
 [ 15983  69743 106782]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8179118
{'0': {'precision': 0.5890476616002015, 'recall': 0.3260825572139751, 'f1-score': 0.4197832480374222, 'support': 222367}, '1': {'precision': 0.6602309008026611, 'recall': 0.8261365224941769, 'f1-score': 0.7339246701498515, 'support': 507887}, '2': {'precision': 0.5465453989605625, 'recall': 0.48135028481518566, 'f1-score': 0.5118803154960831, 'support': 237698}, 'accuracy': 0.6265909879828752, 'macro avg': {'precision': 0.5986079871211417, 'recall': 0.5445231215077792, 'f1-score': 0.5551960778944522, 'support': 967952}, 'weighted avg': {'precision': 0.6159605033360549, 'recall': 0.6265909879828752, 'f1-score': 0.6072301805229217, 'support': 967952}}
[[ 72510 110293  39564]
 [ 32939 419584  55364]
 [ 17648 105634 114416]]
Evaluating performance on  train set...
1601/1601 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5767549
{'0': {'precision': 0.5069963612305657, 'recall': 0.5176734838633408, 'f1-score': 0.5122792944106023, 'support': 59213}, '1': {'precision': 0.8785791044329037, 'recall': 0.8046742112482853, 'f1-score': 0.8400042243109094, 'support': 291600}, '2': {'precision': 0.46894345726760805, 'recall': 0.6541848351685641, 'f1-score': 0.5462879002550297, 'support': 58939}, 'accuracy': 0.7415534274390363, 'macro avg': {'precision': 0.6181729743103591, 'recall': 0.6588441767600633, 'f1-score': 0.6328571396588472, 'support': 409752}, 'weighted avg': {'precision': 0.7659596556406698, 'recall': 0.7415534274390363, 'f1-score': 0.7503965526028605, 'support': 409752}}
[[ 30653  17949  10611]
 [ 23904 234643  33053]
 [  5903  14479  38557]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6476277
{'0': {'precision': 0.5738000780437045, 'recall': 0.4518404711606171, 'f1-score': 0.5055691251996648, 'support': 78105}, '1': {'precision': 0.7995158433683689, 'recall': 0.814245656043731, 'f1-score': 0.8068135255897446, 'support': 253916}, '2': {'precision': 0.5297476967006491, 'recall': 0.6110046184919787, 'f1-score': 0.5674821519252023, 'support': 77731}, 'accuracy': 0.706610339912923, 'macro avg': {'precision': 0.6343545393709075, 'recall': 0.6256969152321089, 'f1-score': 0.6266216009048705, 'support': 409752}, 'weighted avg': {'precision': 0.7053152594558768, 'recall': 0.706610339912923, 'f1-score': 0.7039899618273084, 'support': 409752}}
[[ 35291  28604  14210]
 [ 19216 206750  27950]
 [  6997  23240  47494]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7233992
{'0': {'precision': 0.6025020712510356, 'recall': 0.3975878583768889, 'f1-score': 0.47905193539037183, 'support': 91454}, '1': {'precision': 0.7266953734835526, 'recall': 0.8133940754434614, 'f1-score': 0.7676043905832995, 'support': 227190}, '2': {'precision': 0.5521675586444741, 'recall': 0.5764038284234095, 'f1-score': 0.5640254544478157, 'support': 91108}, 'accuracy': 0.6678942384661942, 'macro avg': {'precision': 0.6271216677930208, 'recall': 0.5957952540812532, 'f1-score': 0.6035605934738291, 'support': 409752}, 'weighted avg': {'precision': 0.6601701230473586, 'recall': 0.6678942384661942, 'f1-score': 0.6579357472315998, 'support': 409752}}
[[ 36361  38400  16693]
 [ 16496 184795  25899]
 [  7493  31100  52515]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8515418
{'0': {'precision': 0.6317341829767865, 'recall': 0.3119678483766847, 'f1-score': 0.4176758071117317, 'support': 111223}, '1': {'precision': 0.5984789156039726, 'recall': 0.8200095024049626, 'f1-score': 0.6919455831343755, 'support': 187321}, '2': {'precision': 0.5713776383342841, 'recall': 0.5043791813538594, 'f1-score': 0.5357920678587803, 'support': 111208}, 'accuracy': 0.5964437025322634, 'macro avg': {'precision': 0.6005302456383478, 'recall': 0.5454521773785023, 'f1-score': 0.5484711527016292, 'support': 409752}, 'weighted avg': {'precision': 0.6001503455430552, 'recall': 0.5964437025322634, 'f1-score': 0.5751172883967417, 'support': 409752}}
[[ 34698  56409  20116]
 [ 11755 153605  21961]
 [  8472  46645  56091]]
Evaluating performance on  val set...
532/532 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.54976684
{'0': {'precision': 0.4680240146175933, 'recall': 0.5239625949736996, 'f1-score': 0.49441610368123534, 'support': 17110}, '1': {'precision': 0.8951906064018015, 'recall': 0.8177196591243021, 'f1-score': 0.8547032173846271, 'support': 102090}, '2': {'precision': 0.4543119420582786, 'recall': 0.6362188937374691, 'f1-score': 0.5300938436594114, 'support': 16958}, 'accuracy': 0.7582000323153983, 'macro avg': {'precision': 0.6058421876925578, 'recall': 0.6593003826118237, 'f1-score': 0.6264043882417579, 'support': 136158}, 'weighted avg': {'precision': 0.7866017553951382, 'recall': 0.7582000323153983, 'f1-score': 0.7689995622553123, 'support': 136158}}
[[ 8965  5310  2835]
 [ 8485 83481 10124]
 [ 1705  4464 10789]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.61711186
{'0': {'precision': 0.5382814090816535, 'recall': 0.46064038335874535, 'f1-score': 0.49644357848775794, 'support': 22955}, '1': {'precision': 0.8251424658744533, 'recall': 0.8254706558246421, 'f1-score': 0.8253065282226886, 'support': 90512}, '2': {'precision': 0.5169837479781252, 'recall': 0.5916001939094795, 'f1-score': 0.5517808331791931, 'support': 22691}, 'accuracy': 0.7249886161665124, 'macro avg': {'precision': 0.6268025409780773, 'recall': 0.625903744364289, 'f1-score': 0.6245103132965465, 'support': 136158}, 'weighted avg': {'precision': 0.7254250418048848, 'recall': 0.7249886161665124, 'f1-score': 0.7242796289042696, 'support': 136158}}
[[10574  8605  3776]
 [ 7031 74715  8766]
 [ 2039  7228 13424]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.69034255
{'0': {'precision': 0.5732546705998034, 'recall': 0.4078424153166421, 'f1-score': 0.47660434997741113, 'support': 27160}, '1': {'precision': 0.7598821314928517, 'recall': 0.8258365398665433, 'f1-score': 0.7914877229016898, 'support': 82124}, '2': {'precision': 0.5425080665627379, 'recall': 0.5568207189104711, 'f1-score': 0.5495712213305911, 'support': 26874}, 'accuracy': 0.6893608895547819, 'macro avg': {'precision': 0.6252149562184642, 'recall': 0.5968332246978855, 'f1-score': 0.605887764736564, 'support': 136158}, 'weighted avg': {'precision': 0.6797508688510159, 'recall': 0.6893608895547819, 'f1-score': 0.6809286924235312, 'support': 136158}}
[[11077 11704  4379]
 [ 6063 67821  8240]
 [ 2183  9727 14964]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8168356
{'0': {'precision': 0.6155766067275512, 'recall': 0.32131225202818736, 'f1-score': 0.42223216543781494, 'support': 33774}, '1': {'precision': 0.6396207352141137, 'recall': 0.8334780092592593, 'f1-score': 0.723793729466232, 'support': 69120}, '2': {'precision': 0.562087139845397, 'recall': 0.4809102934102934, 'f1-score': 0.518339705787052, 'support': 33264}, 'accuracy': 0.6203014145331159, 'macro avg': {'precision': 0.6057614939290207, 'recall': 0.5452335182325799, 'f1-score': 0.5547885335636996, 'support': 136158}, 'weighted avg': {'precision': 0.6147147883593556, 'recall': 0.6203014145331159, 'f1-score': 0.5987980413159947, 'support': 136158}}
[[10852 17616  5306]
 [ 4353 57610  7157]
 [ 2424 14843 15997]]
training model: results/EXC/W4/deepVOL_L3/seq2seq
Epoch 1/50
1601/1601 - 80s - loss: 10.6109 - accuracy10: 0.5560 - accuracy20: 0.5620 - accuracy30: 0.5542 - accuracy50: 0.5328 - val_loss: 9.9563 - val_accuracy10: 0.7349 - val_accuracy20: 0.7094 - val_accuracy30: 0.6729 - val_accuracy50: 0.5970 - 80s/epoch - 50ms/step
Epoch 2/50
1601/1601 - 72s - loss: 9.5611 - accuracy10: 0.6340 - accuracy20: 0.6293 - accuracy30: 0.6098 - accuracy50: 0.5737 - val_loss: 9.3659 - val_accuracy10: 0.7344 - val_accuracy20: 0.7112 - val_accuracy30: 0.6782 - val_accuracy50: 0.6118 - 72s/epoch - 45ms/step
Epoch 3/50
1601/1601 - 71s - loss: 9.2339 - accuracy10: 0.6487 - accuracy20: 0.6390 - accuracy30: 0.6165 - accuracy50: 0.5794 - val_loss: 9.0660 - val_accuracy10: 0.7405 - val_accuracy20: 0.7157 - val_accuracy30: 0.6827 - val_accuracy50: 0.6169 - 71s/epoch - 44ms/step
Epoch 4/50
1601/1601 - 72s - loss: 9.0997 - accuracy10: 0.6544 - accuracy20: 0.6427 - accuracy30: 0.6196 - accuracy50: 0.5825 - val_loss: 9.0602 - val_accuracy10: 0.7405 - val_accuracy20: 0.7164 - val_accuracy30: 0.6831 - val_accuracy50: 0.6174 - 72s/epoch - 45ms/step
Epoch 5/50
1601/1601 - 70s - loss: 9.0192 - accuracy10: 0.6566 - accuracy20: 0.6450 - accuracy30: 0.6217 - accuracy50: 0.5844 - val_loss: 9.0341 - val_accuracy10: 0.7499 - val_accuracy20: 0.7210 - val_accuracy30: 0.6860 - val_accuracy50: 0.6171 - 70s/epoch - 44ms/step
Epoch 6/50
1601/1601 - 70s - loss: 8.9676 - accuracy10: 0.6587 - accuracy20: 0.6464 - accuracy30: 0.6233 - accuracy50: 0.5862 - val_loss: 8.9717 - val_accuracy10: 0.7494 - val_accuracy20: 0.7202 - val_accuracy30: 0.6858 - val_accuracy50: 0.6189 - 70s/epoch - 44ms/step
Epoch 7/50
1601/1601 - 70s - loss: 8.9251 - accuracy10: 0.6611 - accuracy20: 0.6487 - accuracy30: 0.6252 - accuracy50: 0.5876 - val_loss: 8.8618 - val_accuracy10: 0.7418 - val_accuracy20: 0.7152 - val_accuracy30: 0.6826 - val_accuracy50: 0.6198 - 70s/epoch - 44ms/step
Epoch 8/50
1601/1601 - 71s - loss: 8.8890 - accuracy10: 0.6628 - accuracy20: 0.6492 - accuracy30: 0.6260 - accuracy50: 0.5887 - val_loss: 8.8470 - val_accuracy10: 0.7452 - val_accuracy20: 0.7181 - val_accuracy30: 0.6860 - val_accuracy50: 0.6215 - 71s/epoch - 44ms/step
Epoch 9/50
1601/1601 - 71s - loss: 8.8580 - accuracy10: 0.6644 - accuracy20: 0.6504 - accuracy30: 0.6268 - accuracy50: 0.5901 - val_loss: 8.8185 - val_accuracy10: 0.7451 - val_accuracy20: 0.7179 - val_accuracy30: 0.6854 - val_accuracy50: 0.6221 - 71s/epoch - 44ms/step
Epoch 10/50
1601/1601 - 72s - loss: 8.8346 - accuracy10: 0.6651 - accuracy20: 0.6508 - accuracy30: 0.6269 - accuracy50: 0.5904 - val_loss: 8.7988 - val_accuracy10: 0.7426 - val_accuracy20: 0.7151 - val_accuracy30: 0.6833 - val_accuracy50: 0.6207 - 72s/epoch - 45ms/step
Epoch 11/50
1601/1601 - 72s - loss: 8.8130 - accuracy10: 0.6664 - accuracy20: 0.6518 - accuracy30: 0.6285 - accuracy50: 0.5908 - val_loss: 8.8161 - val_accuracy10: 0.7382 - val_accuracy20: 0.7129 - val_accuracy30: 0.6827 - val_accuracy50: 0.6209 - 72s/epoch - 45ms/step
Epoch 12/50
1601/1601 - 72s - loss: 8.7893 - accuracy10: 0.6671 - accuracy20: 0.6518 - accuracy30: 0.6290 - accuracy50: 0.5923 - val_loss: 8.7751 - val_accuracy10: 0.7361 - val_accuracy20: 0.7116 - val_accuracy30: 0.6817 - val_accuracy50: 0.6208 - 72s/epoch - 45ms/step
Epoch 13/50
1601/1601 - 73s - loss: 8.7734 - accuracy10: 0.6676 - accuracy20: 0.6530 - accuracy30: 0.6296 - accuracy50: 0.5926 - val_loss: 8.7294 - val_accuracy10: 0.7275 - val_accuracy20: 0.7045 - val_accuracy30: 0.6764 - val_accuracy50: 0.6172 - 73s/epoch - 46ms/step
Epoch 14/50
1601/1601 - 72s - loss: 8.7522 - accuracy10: 0.6690 - accuracy20: 0.6536 - accuracy30: 0.6308 - accuracy50: 0.5933 - val_loss: 8.7319 - val_accuracy10: 0.7285 - val_accuracy20: 0.7052 - val_accuracy30: 0.6765 - val_accuracy50: 0.6170 - 72s/epoch - 45ms/step
Epoch 15/50
1601/1601 - 73s - loss: 8.7373 - accuracy10: 0.6689 - accuracy20: 0.6538 - accuracy30: 0.6307 - accuracy50: 0.5937 - val_loss: 8.7377 - val_accuracy10: 0.7278 - val_accuracy20: 0.7031 - val_accuracy30: 0.6735 - val_accuracy50: 0.6159 - 73s/epoch - 45ms/step
Epoch 16/50
1601/1601 - 72s - loss: 8.7232 - accuracy10: 0.6694 - accuracy20: 0.6544 - accuracy30: 0.6310 - accuracy50: 0.5943 - val_loss: 8.7589 - val_accuracy10: 0.7274 - val_accuracy20: 0.7037 - val_accuracy30: 0.6749 - val_accuracy50: 0.6177 - 72s/epoch - 45ms/step
Epoch 17/50
1601/1601 - 72s - loss: 8.7025 - accuracy10: 0.6708 - accuracy20: 0.6549 - accuracy30: 0.6317 - accuracy50: 0.5953 - val_loss: 8.7196 - val_accuracy10: 0.7226 - val_accuracy20: 0.6996 - val_accuracy30: 0.6717 - val_accuracy50: 0.6149 - 72s/epoch - 45ms/step
Epoch 18/50
1601/1601 - 71s - loss: 8.6932 - accuracy10: 0.6710 - accuracy20: 0.6549 - accuracy30: 0.6320 - accuracy50: 0.5959 - val_loss: 8.7796 - val_accuracy10: 0.7288 - val_accuracy20: 0.7043 - val_accuracy30: 0.6754 - val_accuracy50: 0.6172 - 71s/epoch - 44ms/step
Epoch 19/50
1601/1601 - 72s - loss: 8.6725 - accuracy10: 0.6716 - accuracy20: 0.6561 - accuracy30: 0.6331 - accuracy50: 0.5965 - val_loss: 8.6969 - val_accuracy10: 0.7253 - val_accuracy20: 0.6994 - val_accuracy30: 0.6709 - val_accuracy50: 0.6159 - 72s/epoch - 45ms/step
Epoch 20/50
1601/1601 - 72s - loss: 8.6605 - accuracy10: 0.6721 - accuracy20: 0.6561 - accuracy30: 0.6326 - accuracy50: 0.5966 - val_loss: 8.7036 - val_accuracy10: 0.7267 - val_accuracy20: 0.7021 - val_accuracy30: 0.6743 - val_accuracy50: 0.6170 - 72s/epoch - 45ms/step
Epoch 21/50
1601/1601 - 72s - loss: 8.6430 - accuracy10: 0.6728 - accuracy20: 0.6573 - accuracy30: 0.6341 - accuracy50: 0.5972 - val_loss: 8.7498 - val_accuracy10: 0.7298 - val_accuracy20: 0.7022 - val_accuracy30: 0.6735 - val_accuracy50: 0.6157 - 72s/epoch - 45ms/step
Epoch 22/50
1601/1601 - 72s - loss: 8.6301 - accuracy10: 0.6729 - accuracy20: 0.6577 - accuracy30: 0.6347 - accuracy50: 0.5980 - val_loss: 8.7345 - val_accuracy10: 0.7310 - val_accuracy20: 0.7040 - val_accuracy30: 0.6745 - val_accuracy50: 0.6159 - 72s/epoch - 45ms/step
Epoch 23/50
1601/1601 - 71s - loss: 8.6127 - accuracy10: 0.6744 - accuracy20: 0.6588 - accuracy30: 0.6356 - accuracy50: 0.5991 - val_loss: 8.7048 - val_accuracy10: 0.7249 - val_accuracy20: 0.7006 - val_accuracy30: 0.6724 - val_accuracy50: 0.6161 - 71s/epoch - 45ms/step
Epoch 24/50
1601/1601 - 72s - loss: 8.5971 - accuracy10: 0.6740 - accuracy20: 0.6582 - accuracy30: 0.6360 - accuracy50: 0.5994 - val_loss: 8.7485 - val_accuracy10: 0.7327 - val_accuracy20: 0.7062 - val_accuracy30: 0.6767 - val_accuracy50: 0.6180 - 72s/epoch - 45ms/step
Epoch 25/50
1601/1601 - 72s - loss: 8.5782 - accuracy10: 0.6749 - accuracy20: 0.6590 - accuracy30: 0.6365 - accuracy50: 0.5998 - val_loss: 8.6948 - val_accuracy10: 0.7256 - val_accuracy20: 0.7000 - val_accuracy30: 0.6721 - val_accuracy50: 0.6155 - 72s/epoch - 45ms/step
Epoch 26/50
1601/1601 - 72s - loss: 8.5725 - accuracy10: 0.6749 - accuracy20: 0.6593 - accuracy30: 0.6369 - accuracy50: 0.6006 - val_loss: 8.7137 - val_accuracy10: 0.7179 - val_accuracy20: 0.6948 - val_accuracy30: 0.6670 - val_accuracy50: 0.6120 - 72s/epoch - 45ms/step
Epoch 27/50
1601/1601 - 71s - loss: 8.5570 - accuracy10: 0.6754 - accuracy20: 0.6602 - accuracy30: 0.6377 - accuracy50: 0.6010 - val_loss: 8.7735 - val_accuracy10: 0.7192 - val_accuracy20: 0.6932 - val_accuracy30: 0.6656 - val_accuracy50: 0.6105 - 71s/epoch - 44ms/step
Epoch 28/50
1601/1601 - 73s - loss: 8.5360 - accuracy10: 0.6764 - accuracy20: 0.6610 - accuracy30: 0.6385 - accuracy50: 0.6021 - val_loss: 8.7970 - val_accuracy10: 0.7264 - val_accuracy20: 0.6990 - val_accuracy30: 0.6689 - val_accuracy50: 0.6116 - 73s/epoch - 45ms/step
Epoch 29/50
1601/1601 - 72s - loss: 8.5216 - accuracy10: 0.6764 - accuracy20: 0.6617 - accuracy30: 0.6393 - accuracy50: 0.6028 - val_loss: 8.8238 - val_accuracy10: 0.7223 - val_accuracy20: 0.6947 - val_accuracy30: 0.6654 - val_accuracy50: 0.6094 - 72s/epoch - 45ms/step
Epoch 30/50
1601/1601 - 71s - loss: 8.5091 - accuracy10: 0.6768 - accuracy20: 0.6617 - accuracy30: 0.6395 - accuracy50: 0.6030 - val_loss: 8.7910 - val_accuracy10: 0.7170 - val_accuracy20: 0.6890 - val_accuracy30: 0.6607 - val_accuracy50: 0.6065 - 71s/epoch - 44ms/step
Epoch 31/50
1601/1601 - 71s - loss: 8.4911 - accuracy10: 0.6781 - accuracy20: 0.6630 - accuracy30: 0.6406 - accuracy50: 0.6042 - val_loss: 8.8473 - val_accuracy10: 0.7227 - val_accuracy20: 0.6943 - val_accuracy30: 0.6651 - val_accuracy50: 0.6082 - 71s/epoch - 44ms/step
Epoch 32/50
1601/1601 - 71s - loss: 8.4780 - accuracy10: 0.6781 - accuracy20: 0.6635 - accuracy30: 0.6411 - accuracy50: 0.6048 - val_loss: 8.8967 - val_accuracy10: 0.7195 - val_accuracy20: 0.6915 - val_accuracy30: 0.6631 - val_accuracy50: 0.6068 - 71s/epoch - 45ms/step
Epoch 33/50
1601/1601 - 72s - loss: 8.4655 - accuracy10: 0.6780 - accuracy20: 0.6644 - accuracy30: 0.6423 - accuracy50: 0.6053 - val_loss: 8.8638 - val_accuracy10: 0.7116 - val_accuracy20: 0.6841 - val_accuracy30: 0.6564 - val_accuracy50: 0.6024 - 72s/epoch - 45ms/step
Epoch 34/50
1601/1601 - 72s - loss: 8.4517 - accuracy10: 0.6787 - accuracy20: 0.6636 - accuracy30: 0.6419 - accuracy50: 0.6054 - val_loss: 8.8892 - val_accuracy10: 0.7193 - val_accuracy20: 0.6925 - val_accuracy30: 0.6643 - val_accuracy50: 0.6085 - 72s/epoch - 45ms/step
Epoch 35/50
1601/1601 - 70s - loss: 8.4369 - accuracy10: 0.6793 - accuracy20: 0.6651 - accuracy30: 0.6434 - accuracy50: 0.6065 - val_loss: 8.8870 - val_accuracy10: 0.7218 - val_accuracy20: 0.6939 - val_accuracy30: 0.6649 - val_accuracy50: 0.6092 - 70s/epoch - 44ms/step
testing model: results/EXC/W4/deepVOL_L3/seq2seq
Evaluating performance on  test set...
3782/3782 - 74s - 74s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.63914496
{'0': {'precision': 0.38104806610118314, 'recall': 0.5967072174698018, 'f1-score': 0.4650941499698452, 'support': 116315}, '1': {'precision': 0.9185732928869421, 'recall': 0.7248864700823332, 'f1-score': 0.810316585530143, 'support': 730204}, '2': {'precision': 0.39175744735674306, 'recall': 0.6761012245435755, 'f1-score': 0.496072555014441, 'support': 121433}, 'accuracy': 0.7033633899201613, 'macro avg': {'precision': 0.5637929354482895, 'recall': 0.6658983040319035, 'f1-score': 0.5904944301714764, 'support': 967952}, 'weighted avg': {'precision': 0.7878900820212646, 'recall': 0.7033633899201613, 'f1-score': 0.729409533372795, 'support': 967952}}
[[ 69406  22416  24493]
 [ 97912 529315 102977]
 [ 14827  24505  82101]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6816517
{'0': {'precision': 0.4440577790232594, 'recall': 0.5640496268922356, 'f1-score': 0.4969125771855704, 'support': 154513}, '1': {'precision': 0.8606157553140301, 'recall': 0.7207364752421644, 'f1-score': 0.7844895704289016, 'support': 650178}, '2': {'precision': 0.4574157624843189, 'recall': 0.6365145380709416, 'f1-score': 0.5323040830230044, 'support': 163261}, 'accuracy': 0.681519331537101, 'macro avg': {'precision': 0.5873630989405362, 'recall': 0.6404335467351139, 'f1-score': 0.6045687435458255, 'support': 967952}, 'weighted avg': {'precision': 0.7261148124780348, 'recall': 0.681519331537101, 'f1-score': 0.69604878119929, 'support': 967952}}
[[ 87153  36970  30390]
 [ 88694 468607  92877]
 [ 20418  38925 103918]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7368986
{'0': {'precision': 0.4729809916524188, 'recall': 0.5181889802821867, 'f1-score': 0.49455400122511967, 'support': 181511}, '1': {'precision': 0.8023382360456291, 'recall': 0.7137387550447609, 'f1-score': 0.7554496204155826, 'support': 593933}, '2': {'precision': 0.48215331574902903, 'recall': 0.6029671494171671, 'f1-score': 0.5358347201288854, 'support': 192508}, 'accuracy': 0.6550386796039473, 'macro avg': {'precision': 0.5858241811490257, 'recall': 0.6116316282480382, 'f1-score': 0.5952794472565293, 'support': 967952}, 'weighted avg': {'precision': 0.6768980061339043, 'recall': 0.6550386796039473, 'f1-score': 0.6628489026534709, 'support': 967952}}
[[ 94057  52176  35278]
 [ 80629 423913  89391]
 [ 24174  52258 116076]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8297963
{'0': {'precision': 0.5061026793395238, 'recall': 0.43653509738405427, 'f1-score': 0.46875181085936146, 'support': 222367}, '1': {'precision': 0.6951062199409311, 'recall': 0.7108549736457125, 'f1-score': 0.702892392636484, 'support': 507887}, '2': {'precision': 0.5047457323461483, 'recall': 0.545217040109719, 'f1-score': 0.5242013934533982, 'support': 237698}, 'accuracy': 0.6071602724102022, 'macro avg': {'precision': 0.5686515438755344, 'recall': 0.5642023703798286, 'f1-score': 0.5652818656497479, 'support': 967952}, 'weighted avg': {'precision': 0.6049401192528622, 'recall': 0.6071602724102022, 'f1-score': 0.6052226405497539, 'support': 967952}}
[[ 97071  79768  45528]
 [ 65221 361034  81632]
 [ 29509  78592 129597]]
Evaluating performance on  train set...
1601/1601 - 31s - 31s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6246888
{'0': {'precision': 0.4512525826446281, 'recall': 0.5901575667505446, 'f1-score': 0.5114413880412433, 'support': 59213}, '1': {'precision': 0.9039221841381885, 'recall': 0.7307510288065844, 'f1-score': 0.8081640547961831, 'support': 291600}, '2': {'precision': 0.4335652750165673, 'recall': 0.7104294270347308, 'f1-score': 0.5384946789698742, 'support': 58939}, 'accuracy': 0.7075108846326559, 'macro avg': {'precision': 0.5962466805997947, 'recall': 0.6771126741972866, 'f1-score': 0.6193667072691001, 'support': 409752}, 'weighted avg': {'precision': 0.7708507385321696, 'recall': 0.7075108846326559, 'f1-score': 0.7264954293632698, 'support': 409752}}
[[ 34945  11924  12344]
 [ 36153 213087  42360]
 [  6342  10725  41872]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6725929
{'0': {'precision': 0.5154879908501716, 'recall': 0.5539722168875232, 'f1-score': 0.5340376818212674, 'support': 78105}, '1': {'precision': 0.8346659718977971, 'recall': 0.7317774382079113, 'f1-score': 0.7798426968178422, 'support': 253916}, '2': {'precision': 0.49757751937984496, 'recall': 0.6606115964029795, 'f1-score': 0.5676197003277493, 'support': 77731}, 'accuracy': 0.684384700989867, 'macro avg': {'precision': 0.6159104940426046, 'recall': 0.6487870838328046, 'f1-score': 0.6271666929889529, 'support': 409752}, 'weighted avg': {'precision': 0.7098792259822244, 'recall': 0.684384700989867, 'f1-score': 0.692729256403936, 'support': 409752}}
[[ 43268  19464  15373]
 [ 31629 185810  36477]
 [  9039  17342  51350]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.73294044
{'0': {'precision': 0.5455495292432674, 'recall': 0.5081352373871018, 'f1-score': 0.5261781290337192, 'support': 91454}, '1': {'precision': 0.7657602206569728, 'recall': 0.7283199084466746, 'f1-score': 0.7465709541771192, 'support': 227190}, '2': {'precision': 0.5246571049332646, 'recall': 0.6247420643631734, 'f1-score': 0.5703420910238681, 'support': 91108}, 'accuracy': 0.6561456685995432, 'macro avg': {'precision': 0.6119889516111683, 'recall': 0.62039907006565, 'f1-score': 0.6143637247449022, 'support': 409752}, 'weighted avg': {'precision': 0.6630015489728698, 'recall': 0.6561456685995432, 'f1-score': 0.6581963649259845, 'support': 409752}}
[[ 46471  27246  17737]
 [ 27891 165467  33832]
 [ 10820  23369  56919]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8371711
{'0': {'precision': 0.574376653961009, 'recall': 0.42541560648427035, 'f1-score': 0.4887991281036772, 'support': 111223}, '1': {'precision': 0.6388744064142489, 'recall': 0.7261171998868253, 'f1-score': 0.6797077621919835, 'support': 187321}, '2': {'precision': 0.5468625789487478, 'recall': 0.5629181353859435, 'f1-score': 0.554774216704109, 'support': 111208}, 'accuracy': 0.6002020734493059, 'macro avg': {'precision': 0.5867045464413352, 'recall': 0.5714836472523465, 'f1-score': 0.5744270356665898, 'support': 409752}, 'weighted avg': {'precision': 0.5963948460218893, 'recall': 0.6002020734493059, 'f1-score': 0.5939801983586911, 'support': 409752}}
[[ 47316  41429  22478]
 [ 21910 136017  29394]
 [ 13152  35455  62601]]
Evaluating performance on  val set...
532/532 - 10s - 10s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5968926
{'0': {'precision': 0.42459476982926303, 'recall': 0.5741087083576856, 'f1-score': 0.48816001987824575, 'support': 17110}, '1': {'precision': 0.9155318541091325, 'recall': 0.7533744735037712, 'f1-score': 0.826575245300863, 'support': 102090}, '2': {'precision': 0.4118214716525935, 'recall': 0.7046231866965444, 'f1-score': 0.5198268548930894, 'support': 16958}, 'accuracy': 0.7247756283141644, 'macro avg': {'precision': 0.5839826985303297, 'recall': 0.6773687895193338, 'f1-score': 0.6115207066907327, 'support': 136158}, 'weighted avg': {'precision': 0.7911039528640601, 'recall': 0.7247756283141644, 'f1-score': 0.7458445962643319, 'support': 136158}}
[[ 9823  3929  3358]
 [11470 76912 13708]
 [ 1842  3167 11949]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.64851636
{'0': {'precision': 0.48847433460076045, 'recall': 0.5372685689392289, 'f1-score': 0.5117108893637325, 'support': 22955}, '1': {'precision': 0.8536989811941761, 'recall': 0.7508065228919922, 'f1-score': 0.7989536490021455, 'support': 90512}, '2': {'precision': 0.47433481330053984, 'recall': 0.6544444934114847, 'f1-score': 0.5500203711248566, 'support': 22691}, 'accuracy': 0.6987470438754976, 'macro avg': {'precision': 0.6055027096984921, 'recall': 0.6475065284142353, 'f1-score': 0.6202283031635782, 'support': 136158}, 'weighted avg': {'precision': 0.7289036397803308, 'recall': 0.6987470438754976, 'f1-score': 0.7090419100238018, 'support': 136158}}
[[12333  6436  4186]
 [10284 67957 12271]
 [ 2631  5210 14850]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.71037453
{'0': {'precision': 0.5203398457382248, 'recall': 0.4893225331369661, 'f1-score': 0.5043547560767347, 'support': 27160}, '1': {'precision': 0.7910321053714756, 'recall': 0.7488432127027422, 'f1-score': 0.7693597217704606, 'support': 82124}, '2': {'precision': 0.5036352021415752, 'recall': 0.6160601324700454, 'f1-score': 0.5542035583376571, 'support': 26874}, 'accuracy': 0.6708676684440136, 'macro avg': {'precision': 0.6050023844170919, 'recall': 0.6180752927699179, 'f1-score': 0.6093060120616175, 'support': 136158}, 'weighted avg': {'precision': 0.6803114268286105, 'recall': 0.6708676684440136, 'f1-score': 0.6740319290272155, 'support': 136158}}
[[13290  9026  4844]
 [ 9153 61498 11473]
 [ 3098  7220 16556]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.81793493
{'0': {'precision': 0.5577648825224202, 'recall': 0.4069698584710132, 'f1-score': 0.47058219353955183, 'support': 33774}, '1': {'precision': 0.6717169750081142, 'recall': 0.7485387731481481, 'f1-score': 0.7080502240925108, 'support': 69120}, '2': {'precision': 0.5274862278921426, 'recall': 0.5469276094276094, 'f1-score': 0.537031023998583, 'support': 33264}, 'accuracy': 0.6145580869284214, 'macro avg': {'precision': 0.5856560284742257, 'recall': 0.5674787470155902, 'f1-score': 0.5718878138768818, 'support': 136158}, 'weighted avg': {'precision': 0.6082149439583228, 'recall': 0.6145580869284214, 'f1-score': 0.6073655200294367, 'support': 136158}}
[[13745 13932  6097]
 [ 7181 51739 10200]
 [ 3717 11354 18193]]
training model: results/EXC/W5/deepLOB_L1/seq2seq
Epoch 1/50
1570/1570 - 49s - loss: 10.8339 - accuracy10: 0.5149 - accuracy20: 0.5275 - accuracy30: 0.5289 - accuracy50: 0.5230 - val_loss: 12.5715 - val_accuracy10: 0.5082 - val_accuracy20: 0.5020 - val_accuracy30: 0.5003 - val_accuracy50: 0.4930 - 49s/epoch - 32ms/step
Epoch 2/50
1570/1570 - 42s - loss: 10.0868 - accuracy10: 0.5961 - accuracy20: 0.5952 - accuracy30: 0.5847 - accuracy50: 0.5634 - val_loss: 12.0585 - val_accuracy10: 0.5863 - val_accuracy20: 0.5726 - val_accuracy30: 0.5587 - val_accuracy50: 0.5304 - 42s/epoch - 27ms/step
Epoch 3/50
1570/1570 - 41s - loss: 9.6818 - accuracy10: 0.6291 - accuracy20: 0.6195 - accuracy30: 0.5999 - accuracy50: 0.5711 - val_loss: 12.7415 - val_accuracy10: 0.6079 - val_accuracy20: 0.5815 - val_accuracy30: 0.5584 - val_accuracy50: 0.5130 - 41s/epoch - 26ms/step
Epoch 4/50
1570/1570 - 41s - loss: 9.4951 - accuracy10: 0.6396 - accuracy20: 0.6293 - accuracy30: 0.6084 - accuracy50: 0.5773 - val_loss: 12.9386 - val_accuracy10: 0.6283 - val_accuracy20: 0.5921 - val_accuracy30: 0.5643 - val_accuracy50: 0.5161 - 41s/epoch - 26ms/step
Epoch 5/50
1570/1570 - 41s - loss: 9.3823 - accuracy10: 0.6471 - accuracy20: 0.6350 - accuracy30: 0.6129 - accuracy50: 0.5802 - val_loss: 12.6206 - val_accuracy10: 0.5977 - val_accuracy20: 0.5754 - val_accuracy30: 0.5576 - val_accuracy50: 0.5230 - 41s/epoch - 26ms/step
Epoch 6/50
1570/1570 - 41s - loss: 9.3138 - accuracy10: 0.6515 - accuracy20: 0.6384 - accuracy30: 0.6150 - accuracy50: 0.5826 - val_loss: 12.5376 - val_accuracy10: 0.6134 - val_accuracy20: 0.5883 - val_accuracy30: 0.5662 - val_accuracy50: 0.5301 - 41s/epoch - 26ms/step
Epoch 7/50
1570/1570 - 41s - loss: 9.2658 - accuracy10: 0.6540 - accuracy20: 0.6407 - accuracy30: 0.6160 - accuracy50: 0.5835 - val_loss: 12.7674 - val_accuracy10: 0.6165 - val_accuracy20: 0.5860 - val_accuracy30: 0.5607 - val_accuracy50: 0.5218 - 41s/epoch - 26ms/step
Epoch 8/50
1570/1570 - 41s - loss: 9.2207 - accuracy10: 0.6555 - accuracy20: 0.6419 - accuracy30: 0.6176 - accuracy50: 0.5854 - val_loss: 12.6885 - val_accuracy10: 0.6224 - val_accuracy20: 0.5908 - val_accuracy30: 0.5653 - val_accuracy50: 0.5282 - 41s/epoch - 26ms/step
Epoch 9/50
1570/1570 - 41s - loss: 9.1839 - accuracy10: 0.6573 - accuracy20: 0.6433 - accuracy30: 0.6189 - accuracy50: 0.5864 - val_loss: 12.7906 - val_accuracy10: 0.6223 - val_accuracy20: 0.5858 - val_accuracy30: 0.5591 - val_accuracy50: 0.5219 - 41s/epoch - 26ms/step
Epoch 10/50
1570/1570 - 41s - loss: 9.1537 - accuracy10: 0.6578 - accuracy20: 0.6442 - accuracy30: 0.6203 - accuracy50: 0.5873 - val_loss: 12.6503 - val_accuracy10: 0.6265 - val_accuracy20: 0.5894 - val_accuracy30: 0.5597 - val_accuracy50: 0.5191 - 41s/epoch - 26ms/step
Epoch 11/50
1570/1570 - 41s - loss: 9.1300 - accuracy10: 0.6597 - accuracy20: 0.6462 - accuracy30: 0.6214 - accuracy50: 0.5879 - val_loss: 12.7492 - val_accuracy10: 0.6266 - val_accuracy20: 0.5861 - val_accuracy30: 0.5555 - val_accuracy50: 0.5167 - 41s/epoch - 26ms/step
Epoch 12/50
1570/1570 - 41s - loss: 9.1101 - accuracy10: 0.6593 - accuracy20: 0.6461 - accuracy30: 0.6214 - accuracy50: 0.5888 - val_loss: 12.8596 - val_accuracy10: 0.6340 - val_accuracy20: 0.5894 - val_accuracy30: 0.5543 - val_accuracy50: 0.5151 - 41s/epoch - 26ms/step
testing model: results/EXC/W5/deepLOB_L1/seq2seq
Evaluating performance on  test set...
7167/7167 - 93s - 93s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.74173284
{'0': {'precision': 0.3726669395646986, 'recall': 0.6349384181629322, 'f1-score': 0.4696691126026991, 'support': 269560}, '1': {'precision': 0.8188105832018211, 'recall': 0.7104347886561014, 'f1-score': 0.7607824543155262, 'support': 1294123}, '2': {'precision': 0.40316952314559923, 'recall': 0.37575307876317887, 'f1-score': 0.3889788002407544, 'support': 270888}, 'accuracy': 0.6499236061182696, 'macro avg': {'precision': 0.5315490153040396, 'recall': 0.5737087618607375, 'f1-score': 0.5398101223863265, 'support': 1834571}, 'weighted avg': {'precision': 0.691884639177124, 'recall': 0.6499236061182696, 'f1-score': 0.6631085781683962, 'support': 1834571}}
[[171154  85473  12933]
 [236986 919390 137747]
 [ 51128 117973 101787]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.81546485
{'0': {'precision': 0.4340126467637849, 'recall': 0.598264544932891, 'f1-score': 0.5030710369265858, 'support': 357255}, '1': {'precision': 0.7292252713421628, 'recall': 0.702650825368389, 'f1-score': 0.715691448394415, 'support': 1117501}, '2': {'precision': 0.4836999125636928, 'recall': 0.35669163320039465, 'f1-score': 0.4105983994266985, 'support': 359815}, 'accuracy': 0.6144700859219948, 'macro avg': {'precision': 0.5489792768898801, 'recall': 0.5525356678338916, 'f1-score': 0.5431202949158997, 'support': 1834571}, 'weighted avg': {'precision': 0.6235821029051694, 'recall': 0.6144700859219948, 'f1-score': 0.6144488360816409, 'support': 1834571}}
[[213733 123864  19658]
 [214953 785213 117335]
 [ 63772 167700 128343]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8781382
{'0': {'precision': 0.4668885573281304, 'recall': 0.5600791893065951, 'f1-score': 0.509255651974967, 'support': 421269}, '1': {'precision': 0.6534334508667494, 'recall': 0.6936384943325319, 'f1-score': 0.6729359877488514, 'support': 989860}, '2': {'precision': 0.5212963095973453, 'recall': 0.3428001945957179, 'f1-score': 0.4136123118305613, 'support': 423442}, 'accuracy': 0.5819916481836898, 'macro avg': {'precision': 0.5472061059307417, 'recall': 0.5321726260782816, 'f1-score': 0.5319346505181265, 'support': 1834571}, 'weighted avg': {'precision': 0.5800985970346985, 'recall': 0.5819916481836898, 'f1-score': 0.5754952305640267, 'support': 1834571}}
[[235944 158338  26987]
 [196946 686605 106309]
 [ 72464 205822 145156]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9822747
{'0': {'precision': 0.5046392241856639, 'recall': 0.49312744326976404, 'f1-score': 0.49881692486471113, 'support': 517493}, '1': {'precision': 0.5279682393835112, 'recall': 0.6865769971180329, 'f1-score': 0.5969161748372063, 'support': 798413}, '2': {'precision': 0.5574125306246043, 'recall': 0.31232683909652664, 'f1-score': 0.4003380778740635, 'support': 518665}, 'accuracy': 0.5262020385147264, 'macro avg': {'precision': 0.5300066647312598, 'recall': 0.49734375982810786, 'f1-score': 0.498690392525327, 'support': 1834571}, 'weighted avg': {'precision': 0.52971203739121, 'recall': 0.5262020385147264, 'f1-score': 0.5136684543470181, 'support': 1834571}}
[[255190 222291  40012]
 [161630 548172  88611]
 [ 88868 267804 161993]]
Evaluating performance on  train set...
1570/1570 - 21s - 21s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7476537
{'0': {'precision': 0.3134746683218248, 'recall': 0.6420172406943948, 'f1-score': 0.4212618436314822, 'support': 50346}, '1': {'precision': 0.8543720177122659, 'recall': 0.6609649691158049, 'f1-score': 0.7453259297559367, 'support': 300963}, '2': {'precision': 0.35736228974663137, 'recall': 0.4663226830720381, 'f1-score': 0.4046356247417, 'support': 50390}, 'accuracy': 0.6341738465866233, 'macro avg': {'precision': 0.5084029919269074, 'recall': 0.5897682976274127, 'f1-score': 0.5237411327097062, 'support': 401699}, 'weighted avg': {'precision': 0.7242339338619215, 'recall': 0.6341738465866233, 'f1-score': 0.6619731831728256, 'support': 401699}}
[[ 32323  14770   3253]
 [ 63034 198926  39003]
 [  7755  19137  23498]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7944609
{'0': {'precision': 0.3857153272697446, 'recall': 0.621857505987452, 'f1-score': 0.47611440785218095, 'support': 68059}, '1': {'precision': 0.7816203014077324, 'recall': 0.6579879874225678, 'f1-score': 0.7144954263492984, 'support': 265555}, '2': {'precision': 0.4327263160971617, 'recall': 0.43486817948153045, 'f1-score': 0.43379460393972474, 'support': 68085}, 'accuracy': 0.6140493254899813, 'macro avg': {'precision': 0.5333539815915462, 'recall': 0.5715712242971834, 'f1-score': 0.5414681460470679, 'support': 401699}, 'weighted avg': {'precision': 0.6554080289730798, 'recall': 0.6140493254899813, 'f1-score': 0.626530334995695, 'support': 401699}}
[[ 42323  20893   4843]
 [ 56852 174732  33971]
 [ 10551  27926  29608]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8396007
{'0': {'precision': 0.4260771438472406, 'recall': 0.5937372311578322, 'f1-score': 0.49612531426856904, 'support': 80763}, '1': {'precision': 0.7199495181275815, 'recall': 0.6535506878077638, 'f1-score': 0.6851451506535821, 'support': 240038}, '2': {'precision': 0.4708656113169417, 'recall': 0.41474449306534156, 'f1-score': 0.4410268543712292, 'support': 80898}, 'accuracy': 0.593431898013189, 'macro avg': {'precision': 0.5389640910972546, 'recall': 0.5540108040103126, 'f1-score': 0.5407657730977934, 'support': 401699}, 'weighted avg': {'precision': 0.610702533551642, 'recall': 0.593431898013189, 'f1-score': 0.5979791607491696, 'support': 401699}}
[[ 47952  26332   6479]
 [ 51936 156877  31225]
 [ 12655  34691  33552]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.91925544
{'0': {'precision': 0.47765850891266387, 'recall': 0.5342639593908629, 'f1-score': 0.5043780214431792, 'support': 100864}, '1': {'precision': 0.6106258182038417, 'recall': 0.6532838893291665, 'f1-score': 0.6312349799411479, 'support': 200631}, '2': {'precision': 0.5109449720482252, 'recall': 0.37852780328130614, 'f1-score': 0.43487981472033205, 'support': 100204}, 'accuracy': 0.5548607290533459, 'macro avg': {'precision': 0.5330764330549101, 'recall': 0.5220252173337785, 'f1-score': 0.5234976053682198, 'support': 401699}, 'weighted avg': {'precision': 0.5523731608844987, 'recall': 0.5548607290533459, 'f1-score': 0.5504011385879811, 'support': 401699}}
[[ 53888  37488   9488]
 [ 42745 131069  26817]
 [ 16184  46090  37930]]
Evaluating performance on  val set...
492/492 - 6s - 6s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.82079333
{'0': {'precision': 0.33195518805014673, 'recall': 0.5377261679719146, 'f1-score': 0.4104974539757149, 'support': 18515}, '1': {'precision': 0.827620874191852, 'recall': 0.602246508120519, 'f1-score': 0.6971720422402168, 'support': 88849}, '2': {'precision': 0.3248456790123457, 'recall': 0.5495485695637985, 'f1-score': 0.40832491412406546, 'support': 18386}, 'accuracy': 0.5850417495029822, 'macro avg': {'precision': 0.4948072470847815, 'recall': 0.5631737485520775, 'f1-score': 0.5053314701133323, 'support': 125750}, 'weighted avg': {'precision': 0.6811296223629528, 'recall': 0.5850417495029822, 'f1-score': 0.6127305050691566, 'support': 125750}}
[[ 9956  5596  2963]
 [17303 53509 18037]
 [ 2733  5549 10104]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.85304755
{'0': {'precision': 0.39471435353695206, 'recall': 0.5155862411112948, 'f1-score': 0.4471254683326461, 'support': 24188}, '1': {'precision': 0.7560003228149463, 'recall': 0.6039404801815509, 'f1-score': 0.6714692242077572, 'support': 77554}, '2': {'precision': 0.39450310559006213, 'recall': 0.5291152949016994, 'f1-score': 0.45199971534301164, 'support': 24008}, 'accuracy': 0.5726600397614314, 'macro avg': {'precision': 0.5150725939806534, 'recall': 0.549547338731515, 'f1-score': 0.5235314692944716, 'support': 125750}, 'weighted avg': {'precision': 0.6174905000234462, 'recall': 0.5726600397614314, 'f1-score': 0.5864159380373238, 'support': 125750}}
[[12471  7434  4283]
 [15502 46838 15214]
 [ 3622  7683 12703]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8855199
{'0': {'precision': 0.43081751330728285, 'recall': 0.498149992884588, 'f1-score': 0.462043590885842, 'support': 28108}, '1': {'precision': 0.7001673920321393, 'recall': 0.6001061677737766, 'f1-score': 0.6462867252261648, 'support': 69701}, '2': {'precision': 0.43033214957175686, 'recall': 0.5160874700261264, 'f1-score': 0.46932465419039865, 'support': 27941}, 'accuracy': 0.558648111332008, 'macro avg': {'precision': 0.5204390183037263, 'recall': 0.538114543561497, 'f1-score': 0.5258849901008018, 'support': 125750}, 'weighted avg': {'precision': 0.5800055399384311, 'recall': 0.558648111332008, 'f1-score': 0.5657841149132572, 'support': 125750}}
[[14002  8711  5395]
 [14179 41828 13694]
 [ 4320  9201 14420]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9449866
{'0': {'precision': 0.4723529052361459, 'recall': 0.4529794339954298, 'f1-score': 0.4624633606508345, 'support': 34134}, '1': {'precision': 0.599124334200955, 'recall': 0.5997032282554308, 'f1-score': 0.599413641458998, 'support': 57957}, '2': {'precision': 0.4660743364854441, 'recall': 0.48468463115362903, 'f1-score': 0.4751973435087822, 'support': 33659}, 'accuracy': 0.529089463220676, 'macro avg': {'precision': 0.5125171919741817, 'recall': 0.5124557644681632, 'f1-score': 0.5123581152062049, 'support': 125750}, 'weighted avg': {'precision': 0.5291001128936693, 'recall': 0.529089463220676, 'f1-score': 0.5289909197268934, 'support': 125750}}
[[15462 11391  7281]
 [11792 34757 11408]
 [ 5480 11865 16314]]
training model: results/EXC/W5/deepOF_L1/seq2seq
Epoch 1/50
1570/1570 - 47s - loss: 12.1370 - accuracy10: 0.4160 - accuracy20: 0.4396 - accuracy30: 0.4510 - accuracy50: 0.4574 - val_loss: 14.4367 - val_accuracy10: 0.6380 - val_accuracy20: 0.5842 - val_accuracy30: 0.5436 - val_accuracy50: 0.4770 - 47s/epoch - 30ms/step
Epoch 2/50
1570/1570 - 39s - loss: 11.8548 - accuracy10: 0.4300 - accuracy20: 0.4547 - accuracy30: 0.4675 - accuracy50: 0.4731 - val_loss: 14.4792 - val_accuracy10: 0.6322 - val_accuracy20: 0.5826 - val_accuracy30: 0.5463 - val_accuracy50: 0.4833 - 39s/epoch - 25ms/step
Epoch 3/50
1570/1570 - 39s - loss: 11.7132 - accuracy10: 0.4469 - accuracy20: 0.4677 - accuracy30: 0.4783 - accuracy50: 0.4823 - val_loss: 13.7991 - val_accuracy10: 0.6217 - val_accuracy20: 0.5768 - val_accuracy30: 0.5443 - val_accuracy50: 0.4862 - 39s/epoch - 25ms/step
Epoch 4/50
1570/1570 - 38s - loss: 11.6135 - accuracy10: 0.4620 - accuracy20: 0.4783 - accuracy30: 0.4855 - accuracy50: 0.4875 - val_loss: 13.6071 - val_accuracy10: 0.6094 - val_accuracy20: 0.5667 - val_accuracy30: 0.5360 - val_accuracy50: 0.4845 - 38s/epoch - 24ms/step
Epoch 5/50
1570/1570 - 39s - loss: 11.5230 - accuracy10: 0.4764 - accuracy20: 0.4897 - accuracy30: 0.4943 - accuracy50: 0.4933 - val_loss: 13.5578 - val_accuracy10: 0.5884 - val_accuracy20: 0.5519 - val_accuracy30: 0.5260 - val_accuracy50: 0.4810 - 39s/epoch - 25ms/step
Epoch 6/50
1570/1570 - 38s - loss: 11.4293 - accuracy10: 0.4905 - accuracy20: 0.5008 - accuracy30: 0.5025 - accuracy50: 0.4997 - val_loss: 13.3032 - val_accuracy10: 0.5681 - val_accuracy20: 0.5402 - val_accuracy30: 0.5201 - val_accuracy50: 0.4825 - 38s/epoch - 24ms/step
Epoch 7/50
1570/1570 - 39s - loss: 11.3299 - accuracy10: 0.5040 - accuracy20: 0.5116 - accuracy30: 0.5110 - accuracy50: 0.5043 - val_loss: 13.0798 - val_accuracy10: 0.5441 - val_accuracy20: 0.5236 - val_accuracy30: 0.5081 - val_accuracy50: 0.4799 - 39s/epoch - 25ms/step
Epoch 8/50
1570/1570 - 38s - loss: 11.2512 - accuracy10: 0.5147 - accuracy20: 0.5209 - accuracy30: 0.5186 - accuracy50: 0.5098 - val_loss: 12.9907 - val_accuracy10: 0.5261 - val_accuracy20: 0.5114 - val_accuracy30: 0.5011 - val_accuracy50: 0.4769 - 38s/epoch - 24ms/step
Epoch 9/50
1570/1570 - 40s - loss: 11.1663 - accuracy10: 0.5234 - accuracy20: 0.5289 - accuracy30: 0.5250 - accuracy50: 0.5143 - val_loss: 12.9286 - val_accuracy10: 0.5152 - val_accuracy20: 0.5046 - val_accuracy30: 0.4952 - val_accuracy50: 0.4765 - 40s/epoch - 26ms/step
Epoch 10/50
1570/1570 - 39s - loss: 11.0929 - accuracy10: 0.5309 - accuracy20: 0.5350 - accuracy30: 0.5300 - accuracy50: 0.5184 - val_loss: 12.9310 - val_accuracy10: 0.5092 - val_accuracy20: 0.4963 - val_accuracy30: 0.4859 - val_accuracy50: 0.4705 - 39s/epoch - 25ms/step
Epoch 11/50
1570/1570 - 40s - loss: 11.0239 - accuracy10: 0.5370 - accuracy20: 0.5405 - accuracy30: 0.5347 - accuracy50: 0.5216 - val_loss: 12.8131 - val_accuracy10: 0.5027 - val_accuracy20: 0.4921 - val_accuracy30: 0.4829 - val_accuracy50: 0.4700 - 40s/epoch - 26ms/step
Epoch 12/50
1570/1570 - 39s - loss: 10.9506 - accuracy10: 0.5431 - accuracy20: 0.5456 - accuracy30: 0.5393 - accuracy50: 0.5258 - val_loss: 12.8487 - val_accuracy10: 0.4796 - val_accuracy20: 0.4712 - val_accuracy30: 0.4633 - val_accuracy50: 0.4565 - 39s/epoch - 25ms/step
Epoch 13/50
1570/1570 - 39s - loss: 10.9016 - accuracy10: 0.5468 - accuracy20: 0.5498 - accuracy30: 0.5430 - accuracy50: 0.5282 - val_loss: 12.7622 - val_accuracy10: 0.4411 - val_accuracy20: 0.4457 - val_accuracy30: 0.4465 - val_accuracy50: 0.4489 - 39s/epoch - 25ms/step
Epoch 14/50
1570/1570 - 38s - loss: 10.8426 - accuracy10: 0.5511 - accuracy20: 0.5537 - accuracy30: 0.5473 - accuracy50: 0.5323 - val_loss: 12.7833 - val_accuracy10: 0.4527 - val_accuracy20: 0.4543 - val_accuracy30: 0.4531 - val_accuracy50: 0.4515 - 38s/epoch - 24ms/step
Epoch 15/50
1570/1570 - 39s - loss: 10.8012 - accuracy10: 0.5544 - accuracy20: 0.5571 - accuracy30: 0.5497 - accuracy50: 0.5336 - val_loss: 12.8803 - val_accuracy10: 0.4678 - val_accuracy20: 0.4643 - val_accuracy30: 0.4593 - val_accuracy50: 0.4542 - 39s/epoch - 25ms/step
Epoch 16/50
1570/1570 - 39s - loss: 10.7549 - accuracy10: 0.5565 - accuracy20: 0.5593 - accuracy30: 0.5523 - accuracy50: 0.5364 - val_loss: 12.8932 - val_accuracy10: 0.4444 - val_accuracy20: 0.4478 - val_accuracy30: 0.4468 - val_accuracy50: 0.4484 - 39s/epoch - 25ms/step
Epoch 17/50
1570/1570 - 39s - loss: 10.7134 - accuracy10: 0.5603 - accuracy20: 0.5620 - accuracy30: 0.5550 - accuracy50: 0.5387 - val_loss: 12.8626 - val_accuracy10: 0.4960 - val_accuracy20: 0.4880 - val_accuracy30: 0.4787 - val_accuracy50: 0.4670 - 39s/epoch - 25ms/step
Epoch 18/50
1570/1570 - 39s - loss: 10.6760 - accuracy10: 0.5630 - accuracy20: 0.5640 - accuracy30: 0.5564 - accuracy50: 0.5396 - val_loss: 12.8371 - val_accuracy10: 0.4826 - val_accuracy20: 0.4788 - val_accuracy30: 0.4733 - val_accuracy50: 0.4654 - 39s/epoch - 25ms/step
Epoch 19/50
1570/1570 - 39s - loss: 10.6391 - accuracy10: 0.5638 - accuracy20: 0.5648 - accuracy30: 0.5584 - accuracy50: 0.5420 - val_loss: 12.9228 - val_accuracy10: 0.4714 - val_accuracy20: 0.4675 - val_accuracy30: 0.4640 - val_accuracy50: 0.4590 - 39s/epoch - 25ms/step
Epoch 20/50
1570/1570 - 40s - loss: 10.5935 - accuracy10: 0.5671 - accuracy20: 0.5686 - accuracy30: 0.5621 - accuracy50: 0.5454 - val_loss: 12.8450 - val_accuracy10: 0.4711 - val_accuracy20: 0.4691 - val_accuracy30: 0.4656 - val_accuracy50: 0.4610 - 40s/epoch - 26ms/step
Epoch 21/50
1570/1570 - 39s - loss: 10.5633 - accuracy10: 0.5686 - accuracy20: 0.5700 - accuracy30: 0.5631 - accuracy50: 0.5457 - val_loss: 12.9174 - val_accuracy10: 0.4616 - val_accuracy20: 0.4613 - val_accuracy30: 0.4581 - val_accuracy50: 0.4546 - 39s/epoch - 25ms/step
Epoch 22/50
1570/1570 - 38s - loss: 10.5270 - accuracy10: 0.5711 - accuracy20: 0.5716 - accuracy30: 0.5648 - accuracy50: 0.5469 - val_loss: 12.9191 - val_accuracy10: 0.4771 - val_accuracy20: 0.4721 - val_accuracy30: 0.4663 - val_accuracy50: 0.4594 - 38s/epoch - 24ms/step
Epoch 23/50
1570/1570 - 38s - loss: 10.4850 - accuracy10: 0.5727 - accuracy20: 0.5745 - accuracy30: 0.5676 - accuracy50: 0.5499 - val_loss: 12.9459 - val_accuracy10: 0.4862 - val_accuracy20: 0.4795 - val_accuracy30: 0.4726 - val_accuracy50: 0.4633 - 38s/epoch - 24ms/step
testing model: results/EXC/W5/deepOF_L1/seq2seq
Evaluating performance on  test set...
7167/7167 - 95s - 95s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0325603
{'0': {'precision': 0.2914432491517671, 'recall': 0.41840285506536673, 'f1-score': 0.3435693647121183, 'support': 269556}, '1': {'precision': 0.8120242686423261, 'recall': 0.39568804510854066, 'f1-score': 0.5320940952268135, 'support': 1294123}, '2': {'precision': 0.2193917331822071, 'recall': 0.6616707335531051, 'f1-score': 0.32952280799805855, 'support': 270887}, 'accuracy': 0.43829984857454024, 'macro avg': {'precision': 0.44095308365876673, 'recall': 0.49192054457567086, 'f1-score': 0.40172875597899677, 'support': 1834566}, 'weighted avg': {'precision': 0.6480278864336826, 'recall': 0.43829984857454024, 'f1-score': 0.4744827034632275, 'support': 1834566}}
[[112783  67578  89195]
 [233510 512069 548544]
 [ 40688  50961 179238]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0383604
{'0': {'precision': 0.35313114293737713, 'recall': 0.42239209967221925, 'f1-score': 0.38466881901064404, 'support': 357251}, '1': {'precision': 0.7340675469486666, 'recall': 0.3732587263904014, 'f1-score': 0.4948805501243379, 'support': 1117501}, '2': {'precision': 0.2830972838517364, 'recall': 0.6601299560328392, 'f1-score': 0.39625869491413734, 'support': 359814}, 'accuracy': 0.4390907713322933, 'macro avg': {'precision': 0.45676532457926006, 'recall': 0.4852602606984866, 'f1-score': 0.4252693546830398, 'support': 1834566}, 'weighted avg': {'precision': 0.5714376249314723, 'recall': 0.4390907713322933, 'f1-score': 0.4540759263807924, 'support': 1834566}}
[[150900  85185 121166]
 [220055 417117 480329]
 [ 56365  65925 237524]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0455282
{'0': {'precision': 0.39031563573538874, 'recall': 0.416158475069137, 'f1-score': 0.40282299849957837, 'support': 421265}, '1': {'precision': 0.6659127674744888, 'recall': 0.35098700826379486, 'f1-score': 0.45968488851489026, 'support': 989860}, '2': {'precision': 0.3224006196761058, 'recall': 0.6575886605217728, 'f1-score': 0.43267206270132186, 'support': 423441}, 'accuracy': 0.43671963832317834, 'macro avg': {'precision': 0.45954300762866107, 'recall': 0.4749113812849015, 'f1-score': 0.4317266499052635, 'support': 1834566}, 'weighted avg': {'precision': 0.5233414164966732, 'recall': 0.43671963832317834, 'f1-score': 0.44039298946485683, 'support': 1834566}}
[[175313  97492 148460]
 [205665 347428 436767]
 [ 68179  76812 278450]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0535989
{'0': {'precision': 0.437978840633997, 'recall': 0.3886297319754971, 'f1-score': 0.41183119819140923, 'support': 517490}, '1': {'precision': 0.5475280152769357, 'recall': 0.33253967558143466, 'f1-score': 0.41377450953654055, 'support': 798413}, '2': {'precision': 0.3747930867968601, 'recall': 0.6434659885127723, 'f1-score': 0.4736841731759884, 'support': 518663}, 'accuracy': 0.436265579979134, 'macro avg': {'precision': 0.453433314235931, 'recall': 0.454878465356568, 'f1-score': 0.4330966269679794, 'support': 1834566}, 'weighted avg': {'precision': 0.4677915443098319, 'recall': 0.436265579979134, 'f1-score': 0.43016382542064335, 'support': 1834566}}
[[201112 120852 195526]
 [171707 265504 361202]
 [ 86363  98558 333742]]
Evaluating performance on  train set...
1570/1570 - 21s - 21s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.96242535
{'0': {'precision': 0.2843352954050661, 'recall': 0.4910284463894967, 'f1-score': 0.36013218269223757, 'support': 50270}, '1': {'precision': 0.8867688417576179, 'recall': 0.4568760385510136, 'f1-score': 0.6030513589865066, 'support': 300900}, '2': {'precision': 0.22902200703124023, 'recall': 0.7245542163905876, 'f1-score': 0.3480348120368654, 'support': 50529}, 'accuracy': 0.49482074886917815, 'macro avg': {'precision': 0.4667087147313081, 'recall': 0.5574862337770327, 'f1-score': 0.4370727845718699, 'support': 401699}, 'weighted avg': {'precision': 0.7286414274821731, 'recall': 0.49482074886917815, 'f1-score': 0.5405735382970568, 'support': 401699}}
[[ 24684  10048  15538]
 [ 55717 137474 107709]
 [  6412   7506  36611]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9658768
{'0': {'precision': 0.35625497007491735, 'recall': 0.5003894596064253, 'f1-score': 0.41619655899520214, 'support': 68043}, '1': {'precision': 0.8287403102142157, 'recall': 0.44257151251704474, 'f1-score': 0.5770053357757257, 'support': 265478}, '2': {'precision': 0.29580661255582463, 'recall': 0.7130892663322479, 'f1-score': 0.41815320041972726, 'support': 68178}, 'accuracy': 0.4982785618087175, 'macro avg': {'precision': 0.4936006309483192, 'recall': 0.552016746151906, 'f1-score': 0.470451698396885, 'support': 401699}, 'weighted avg': {'precision': 0.6582552613640766, 'recall': 0.4982785618087175, 'f1-score': 0.5228052195623957, 'support': 401699}}
[[ 34048  13597  20398]
 [ 52646 117493  95339]
 [  8878  10683  48617]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9783422
{'0': {'precision': 0.3958480188239032, 'recall': 0.49380132023828693, 'f1-score': 0.4394321801329175, 'support': 80743}, '1': {'precision': 0.7744803510720017, 'recall': 0.42433119426618887, 'f1-score': 0.5482699488239744, 'support': 239980}, '2': {'precision': 0.3348692866372063, 'recall': 0.7009237304880458, 'f1-score': 0.4532137709656684, 'support': 80976}, 'accuracy': 0.4940515161850042, 'macro avg': {'precision': 0.5017325521777037, 'recall': 0.5396854149975072, 'f1-score': 0.4803052999741868, 'support': 401699}, 'weighted avg': {'precision': 0.6097553804935831, 'recall': 0.4940515161850042, 'f1-score': 0.5072313676582851, 'support': 401699}}
[[ 39871  16379  24493]
 [ 49907 101831  88242]
 [ 10945  13273  56758]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.99645275
{'0': {'precision': 0.44773790951638065, 'recall': 0.4582164000753662, 'f1-score': 0.45291655639525197, 'support': 100841}, '1': {'precision': 0.6681239323504886, 'recall': 0.411440935695839, 'f1-score': 0.5092672872627639, 'support': 200578}, '2': {'precision': 0.3829888158007532, 'recall': 0.6682788193059434, 'f1-score': 0.48692322503533036, 'support': 100280}, 'accuracy': 0.48730019243264233, 'macro avg': {'precision': 0.49961688588920755, 'recall': 0.5126453850257162, 'f1-score': 0.48303568956444876, 'support': 401699}, 'weighted avg': {'precision': 0.5416180251507651, 'recall': 0.48730019243264233, 'f1-score': 0.4895432485880901, 'support': 401699}}
[[46207 22196 32438]
 [42526 82526 75526]
 [14468 18797 67015]]
Evaluating performance on  val set...
492/492 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0286982
{'0': {'precision': 0.28782172002510986, 'recall': 0.3958985429033999, 'f1-score': 0.33331818801399427, 'support': 18530}, '1': {'precision': 0.826927583782517, 'recall': 0.3973894044508514, 'f1-score': 0.5368091159422494, 'support': 88792}, '2': {'precision': 0.2251354354771496, 'recall': 0.7036032125027133, 'f1-score': 0.34112075769534334, 'support': 18428}, 'accuracy': 0.4420437375745527, 'macro avg': {'precision': 0.44662824642825877, 'recall': 0.4989637199523216, 'f1-score': 0.40374935388386235, 'support': 125750}, 'weighted avg': {'precision': 0.6592977041451725, 'recall': 0.4420437375745527, 'f1-score': 0.4781464363376009, 'support': 125750}}
[[ 7336  4328  6866]
 [15747 35285 37760]
 [ 2405  3057 12966]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0279869
{'0': {'precision': 0.3485726399095534, 'recall': 0.4081413146899433, 'f1-score': 0.37601234826685975, 'support': 24173}, '1': {'precision': 0.7645991550244939, 'recall': 0.38053405572755417, 'f1-score': 0.5081609977519573, 'support': 77520}, '2': {'precision': 0.2864520513038308, 'recall': 0.7009186515359355, 'f1-score': 0.4066954487349557, 'support': 24057}, 'accuracy': 0.4471332007952286, 'macro avg': {'precision': 0.4665412820792927, 'recall': 0.4965313406511443, 'f1-score': 0.43028959825125757, 'support': 125750}, 'weighted avg': {'precision': 0.5931526832624147, 'recall': 0.4471332007952286, 'f1-score': 0.46334679483581204, 'support': 125750}}
[[ 9866  5264  9043]
 [15061 29499 32960]
 [ 3377  3818 16862]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0318145
{'0': {'precision': 0.38159743126630546, 'recall': 0.406086492258409, 'f1-score': 0.3934612798096323, 'support': 28095}, '1': {'precision': 0.7133055899223935, 'recall': 0.3638345476450003, 'f1-score': 0.4818782767266925, 'support': 69724}, '2': {'precision': 0.32333134288747345, 'recall': 0.6978983924671512, 'f1-score': 0.44192294176991354, 'support': 27931}, 'accuracy': 0.4474751491053678, 'macro avg': {'precision': 0.47274478802539077, 'recall': 0.48927314412352024, 'f1-score': 0.4390874994354128, 'support': 125750}, 'weighted avg': {'precision': 0.5525762745237841, 'recall': 0.4474751491053678, 'f1-score': 0.4532495054419005, 'support': 125750}}
[[11409  5833 10853]
 [14414 25368 29942]
 [ 4075  4363 19493]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0366625
{'0': {'precision': 0.42599160511502293, 'recall': 0.3835359601581954, 'f1-score': 0.4036504902263057, 'support': 34135}, '1': {'precision': 0.6158713818578176, 'recall': 0.3507855208926139, 'f1-score': 0.4469812668241499, 'support': 57987}, '2': {'precision': 0.37040442659181466, 'recall': 0.682794100154633, 'f1-score': 0.4802702448309401, 'support': 33628}, 'accuracy': 0.44846123260437376, 'macro avg': {'precision': 0.4707558045215518, 'recall': 0.4723718604018141, 'f1-score': 0.44363400062713193, 'support': 125750}, 'weighted avg': {'precision': 0.4986856247937982, 'recall': 0.44846123260437376, 'f1-score': 0.4441211928141692, 'support': 125750}}
[[13092  7172 13871]
 [12489 20341 25157]
 [ 5152  5515 22961]]
training model: results/EXC/W5/deepLOB_L2/seq2seq
Epoch 1/50
1570/1570 - 88s - loss: 10.9048 - accuracy10: 0.5004 - accuracy20: 0.5183 - accuracy30: 0.5217 - accuracy50: 0.5178 - val_loss: 11.9227 - val_accuracy10: 0.4820 - val_accuracy20: 0.4961 - val_accuracy30: 0.4992 - val_accuracy50: 0.4929 - 88s/epoch - 56ms/step
Epoch 2/50
1570/1570 - 82s - loss: 9.8685 - accuracy10: 0.6142 - accuracy20: 0.6157 - accuracy30: 0.6008 - accuracy50: 0.5702 - val_loss: 11.8645 - val_accuracy10: 0.4730 - val_accuracy20: 0.4803 - val_accuracy30: 0.4783 - val_accuracy50: 0.4764 - 82s/epoch - 52ms/step
Epoch 3/50
1570/1570 - 81s - loss: 9.4156 - accuracy10: 0.6487 - accuracy20: 0.6410 - accuracy30: 0.6186 - accuracy50: 0.5815 - val_loss: 11.0750 - val_accuracy10: 0.4787 - val_accuracy20: 0.4944 - val_accuracy30: 0.4927 - val_accuracy50: 0.4885 - 81s/epoch - 51ms/step
Epoch 4/50
1570/1570 - 80s - loss: 9.2250 - accuracy10: 0.6608 - accuracy20: 0.6499 - accuracy30: 0.6257 - accuracy50: 0.5872 - val_loss: 10.9430 - val_accuracy10: 0.4659 - val_accuracy20: 0.4715 - val_accuracy30: 0.4640 - val_accuracy50: 0.4642 - 80s/epoch - 51ms/step
Epoch 5/50
1570/1570 - 80s - loss: 9.1062 - accuracy10: 0.6638 - accuracy20: 0.6515 - accuracy30: 0.6278 - accuracy50: 0.5904 - val_loss: 10.9748 - val_accuracy10: 0.5270 - val_accuracy20: 0.5198 - val_accuracy30: 0.5013 - val_accuracy50: 0.4892 - 80s/epoch - 51ms/step
Epoch 6/50
1570/1570 - 80s - loss: 9.0332 - accuracy10: 0.6663 - accuracy20: 0.6533 - accuracy30: 0.6298 - accuracy50: 0.5926 - val_loss: 10.8021 - val_accuracy10: 0.5553 - val_accuracy20: 0.5430 - val_accuracy30: 0.5203 - val_accuracy50: 0.5012 - 80s/epoch - 51ms/step
Epoch 7/50
1570/1570 - 81s - loss: 8.9731 - accuracy10: 0.6679 - accuracy20: 0.6547 - accuracy30: 0.6319 - accuracy50: 0.5955 - val_loss: 10.7779 - val_accuracy10: 0.5516 - val_accuracy20: 0.5367 - val_accuracy30: 0.5158 - val_accuracy50: 0.5016 - 81s/epoch - 52ms/step
Epoch 8/50
1570/1570 - 83s - loss: 8.9273 - accuracy10: 0.6685 - accuracy20: 0.6554 - accuracy30: 0.6330 - accuracy50: 0.5964 - val_loss: 10.7275 - val_accuracy10: 0.5297 - val_accuracy20: 0.5176 - val_accuracy30: 0.4993 - val_accuracy50: 0.4887 - 83s/epoch - 53ms/step
Epoch 9/50
1570/1570 - 83s - loss: 8.8872 - accuracy10: 0.6707 - accuracy20: 0.6560 - accuracy30: 0.6340 - accuracy50: 0.5980 - val_loss: 10.7324 - val_accuracy10: 0.5118 - val_accuracy20: 0.5099 - val_accuracy30: 0.5005 - val_accuracy50: 0.4944 - 83s/epoch - 53ms/step
Epoch 10/50
1570/1570 - 83s - loss: 8.8524 - accuracy10: 0.6705 - accuracy20: 0.6569 - accuracy30: 0.6353 - accuracy50: 0.5990 - val_loss: 10.8054 - val_accuracy10: 0.5120 - val_accuracy20: 0.5087 - val_accuracy30: 0.4970 - val_accuracy50: 0.4902 - 83s/epoch - 53ms/step
Epoch 11/50
1570/1570 - 82s - loss: 8.8214 - accuracy10: 0.6719 - accuracy20: 0.6574 - accuracy30: 0.6355 - accuracy50: 0.5998 - val_loss: 10.7996 - val_accuracy10: 0.5182 - val_accuracy20: 0.5169 - val_accuracy30: 0.5059 - val_accuracy50: 0.4968 - 82s/epoch - 52ms/step
Epoch 12/50
1570/1570 - 82s - loss: 8.7908 - accuracy10: 0.6730 - accuracy20: 0.6583 - accuracy30: 0.6365 - accuracy50: 0.6010 - val_loss: 10.8593 - val_accuracy10: 0.5192 - val_accuracy20: 0.5179 - val_accuracy30: 0.5081 - val_accuracy50: 0.4981 - 82s/epoch - 52ms/step
Epoch 13/50
1570/1570 - 82s - loss: 8.7607 - accuracy10: 0.6734 - accuracy20: 0.6592 - accuracy30: 0.6370 - accuracy50: 0.6014 - val_loss: 10.8621 - val_accuracy10: 0.5224 - val_accuracy20: 0.5226 - val_accuracy30: 0.5125 - val_accuracy50: 0.5036 - 82s/epoch - 52ms/step
Epoch 14/50
1570/1570 - 82s - loss: 8.7371 - accuracy10: 0.6741 - accuracy20: 0.6600 - accuracy30: 0.6384 - accuracy50: 0.6025 - val_loss: 10.8174 - val_accuracy10: 0.5311 - val_accuracy20: 0.5262 - val_accuracy30: 0.5137 - val_accuracy50: 0.5025 - 82s/epoch - 52ms/step
Epoch 15/50
1570/1570 - 83s - loss: 8.7098 - accuracy10: 0.6755 - accuracy20: 0.6609 - accuracy30: 0.6387 - accuracy50: 0.6029 - val_loss: 11.0530 - val_accuracy10: 0.5099 - val_accuracy20: 0.5055 - val_accuracy30: 0.4960 - val_accuracy50: 0.4889 - 83s/epoch - 53ms/step
Epoch 16/50
1570/1570 - 85s - loss: 8.6893 - accuracy10: 0.6757 - accuracy20: 0.6614 - accuracy30: 0.6397 - accuracy50: 0.6041 - val_loss: 11.1052 - val_accuracy10: 0.5280 - val_accuracy20: 0.5172 - val_accuracy30: 0.5035 - val_accuracy50: 0.4917 - 85s/epoch - 54ms/step
Epoch 17/50
1570/1570 - 83s - loss: 8.6596 - accuracy10: 0.6764 - accuracy20: 0.6620 - accuracy30: 0.6407 - accuracy50: 0.6048 - val_loss: 11.0229 - val_accuracy10: 0.5232 - val_accuracy20: 0.5160 - val_accuracy30: 0.5018 - val_accuracy50: 0.4933 - 83s/epoch - 53ms/step
Epoch 18/50
1570/1570 - 84s - loss: 8.6356 - accuracy10: 0.6775 - accuracy20: 0.6626 - accuracy30: 0.6411 - accuracy50: 0.6053 - val_loss: 11.3635 - val_accuracy10: 0.4717 - val_accuracy20: 0.4708 - val_accuracy30: 0.4656 - val_accuracy50: 0.4661 - 84s/epoch - 54ms/step
testing model: results/EXC/W5/deepLOB_L2/seq2seq
Evaluating performance on  test set...
7167/7167 - 150s - 150s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8148114
{'0': {'precision': 0.34605282670665194, 'recall': 0.7791066923875946, 'f1-score': 0.4792423983113697, 'support': 269560}, '1': {'precision': 0.8954192428987121, 'recall': 0.561881675853068, 'f1-score': 0.690481503603182, 'support': 1294123}, '2': {'precision': 0.3486104761675609, 'recall': 0.5348557337349753, 'f1-score': 0.42210173955350194, 'support': 270888}, 'accuracy': 0.5898087345760944, 'macro avg': {'precision': 0.5300275152576416, 'recall': 0.6252813673252127, 'f1-score': 0.5306085471560179, 'support': 1834571}, 'weighted avg': {'precision': 0.7339585284586606, 'recall': 0.5898087345760944, 'f1-score': 0.6198151348737347, 'support': 1834571}}
[[210016  35656  23888]
 [320143 727144 246836]
 [ 76731  49271 144886]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.85073423
{'0': {'precision': 0.40094262864104124, 'recall': 0.7517403535289919, 'f1-score': 0.5229620946290663, 'support': 357255}, '1': {'precision': 0.8269392860056011, 'recall': 0.5171055775341588, 'f1-score': 0.6363104814067263, 'support': 1117501}, '2': {'precision': 0.413835657304251, 'recall': 0.5358948348456846, 'f1-score': 0.4670217352341369, 'support': 359815}, 'accuracy': 0.5664823002216867, 'macro avg': {'precision': 0.5472391906502978, 'recall': 0.6015802553029451, 'f1-score': 0.5420981037566431, 'support': 1834571}, 'weighted avg': {'precision': 0.662960722086324, 'recall': 0.5664823002216867, 'f1-score': 0.5810349384474497, 'support': 1834571}}
[[268563  51008  37684]
 [304201 577866 235434]
 [ 97065  69927 192823]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.89507234
{'0': {'precision': 0.4191343439510443, 'recall': 0.7352095691826362, 'f1-score': 0.5338990866411026, 'support': 421269}, '1': {'precision': 0.7605604036450533, 'recall': 0.4617208494130483, 'f1-score': 0.5746084949308015, 'support': 989860}, '2': {'precision': 0.44642030511852804, 'recall': 0.5215377784915053, 'f1-score': 0.48106433149809125, 'support': 423442}, 'accuracy': 0.5383280341834685, 'macro avg': {'precision': 0.5420383509048752, 'recall': 0.5728227323623966, 'f1-score': 0.5298573043566651, 'support': 1834571}, 'weighted avg': {'precision': 0.6096519207673099, 'recall': 0.5383280341834685, 'f1-score': 0.5436693056745302, 'support': 1834571}}
[[309721  59767  51781]
 [310750 457039 222071]
 [118483  84118 220841]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9517562
{'0': {'precision': 0.4440507678338794, 'recall': 0.695553369804036, 'f1-score': 0.5420496429068922, 'support': 517493}, '1': {'precision': 0.6317684930325201, 'recall': 0.40361943004435047, 'f1-score': 0.49255749153418005, 'support': 798413}, '2': {'precision': 0.4878681442707168, 'recall': 0.4833813733334619, 'f1-score': 0.48561439528937783, 'support': 518665}, 'accuracy': 0.5085177951684617, 'macro avg': {'precision': 0.5212291350457056, 'recall': 0.5275180577272828, 'f1-score': 0.5067405099101501, 'support': 1834571}, 'weighted avg': {'precision': 0.5381342411247112, 'recall': 0.5085177951684617, 'f1-score': 0.5045552288125457, 'support': 1834571}}
[[359944  80429  77120]
 [290096 322255 186062]
 [160552 107400 250713]]
Evaluating performance on  train set...
1570/1570 - 34s - 34s/epoch - 22ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8417121
{'0': {'precision': 0.307685513786071, 'recall': 0.7611528224685179, 'f1-score': 0.4382247329780664, 'support': 50346}, '1': {'precision': 0.9332007163719845, 'recall': 0.5159404976691487, 'f1-score': 0.6644984455138149, 'support': 300963}, '2': {'precision': 0.30201608898599663, 'recall': 0.663842032149236, 'f1-score': 0.41515615982724063, 'support': 50390}, 'accuracy': 0.5652266995934767, 'macro avg': {'precision': 0.5143007730480174, 'recall': 0.6469784507623009, 'f1-score': 0.5059597794397074, 'support': 401699}, 'weighted avg': {'precision': 0.7756260603151601, 'recall': 0.5652266995934767, 'f1-score': 0.6048609206330677, 'support': 401699}}
[[ 38321   5139   6886]
 [ 75262 155279  70422]
 [ 10963   5976  33451]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.85507876
{'0': {'precision': 0.3671051680520419, 'recall': 0.7462495775724004, 'f1-score': 0.4921200141466699, 'support': 68059}, '1': {'precision': 0.883526711717455, 'recall': 0.4696993089943703, 'f1-score': 0.6133371360291496, 'support': 265555}, '2': {'precision': 0.36379783098015145, 'recall': 0.6528163325255195, 'f1-score': 0.46722379901187855, 'support': 68085}, 'accuracy': 0.54759160465921, 'macro avg': {'precision': 0.5381432369165494, 'recall': 0.6229217396974301, 'f1-score': 0.524226983062566, 'support': 401699}, 'weighted avg': {'precision': 0.707940328168271, 'recall': 0.54759160465921, 'f1-score': 0.5680344525546561, 'support': 401699}}
[[ 50789   7292   9978]
 [ 73074 124731  67750]
 [ 14487   9151  44447]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.89021033
{'0': {'precision': 0.38918756491576467, 'recall': 0.7376892884117727, 'f1-score': 0.5095490194401444, 'support': 80763}, '1': {'precision': 0.8347407419769363, 'recall': 0.41675484714920136, 'f1-score': 0.55594642658664, 'support': 240038}, '2': {'precision': 0.39812384487551833, 'recall': 0.6337363099211353, 'f1-score': 0.48903048571101526, 'support': 80898}, 'accuracy': 0.5249776574001926, 'macro avg': {'precision': 0.5406840505894065, 'recall': 0.5960601484940364, 'f1-score': 0.5181753105792665, 'support': 401699}, 'weighted avg': {'precision': 0.6572306038369311, 'recall': 0.5249776574001926, 'f1-score': 0.5331418899103508, 'support': 401699}}
[[ 59578   8464  12721]
 [ 75216 100037  64785]
 [ 18289  11341  51268]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9340021
{'0': {'precision': 0.4239904563077841, 'recall': 0.7047311230964467, 'f1-score': 0.5294472541468973, 'support': 100864}, '1': {'precision': 0.7333392615427177, 'recall': 0.36994283037018205, 'f1-score': 0.49179371989318915, 'support': 200631}, '2': {'precision': 0.443495084237944, 'recall': 0.5879306215320745, 'f1-score': 0.5055998489542658, 'support': 100204}, 'accuracy': 0.5083831426017988, 'macro avg': {'precision': 0.5336082673628152, 'recall': 0.5542015249995678, 'f1-score': 0.5089469409981174, 'support': 401699}, 'weighted avg': {'precision': 0.5833620302479823, 'recall': 0.5083831426017988, 'f1-score': 0.5046922220935983, 'support': 401699}}
[[71082 11622 18160]
 [70644 74222 55765]
 [25924 15367 58913]]
Evaluating performance on  val set...
492/492 - 10s - 10s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.90084165
{'0': {'precision': 0.33463993431681544, 'recall': 0.6824196597353497, 'f1-score': 0.44906880864373044, 'support': 18515}, '1': {'precision': 0.9297072641850379, 'recall': 0.46325788697678083, 'f1-score': 0.6183847777585805, 'support': 88849}, '2': {'precision': 0.2943665515427369, 'recall': 0.6999891221581638, 'f1-score': 0.4144460366786352, 'support': 18386}, 'accuracy': 0.5301391650099404, 'macro avg': {'precision': 0.5195712500148634, 'recall': 0.6152222229567648, 'f1-score': 0.49396654102698206, 'support': 125750}, 'weighted avg': {'precision': 0.7491979524144494, 'recall': 0.5301391650099404, 'f1-score': 0.5636372400913254, 'support': 125750}}
[[12635  1640  4240]
 [21078 41160 26611]
 [ 4044  1472 12870]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9049764
{'0': {'precision': 0.38455913572675376, 'recall': 0.6740119067306102, 'f1-score': 0.48971193415637854, 'support': 24188}, '1': {'precision': 0.8884140288959965, 'recall': 0.4154653531732728, 'f1-score': 0.5661647133243134, 'support': 77554}, '2': {'precision': 0.3517031940197078, 'recall': 0.6898117294235255, 'f1-score': 0.4658771238888264, 'support': 24008}, 'accuracy': 0.5175745526838966, 'macro avg': {'precision': 0.5415587862141527, 'recall': 0.5930963297758028, 'f1-score': 0.5072512571231728, 'support': 125750}, 'weighted avg': {'precision': 0.6890295686201509, 'recall': 0.5175745526838966, 'f1-score': 0.5323122738039859, 'support': 125750}}
[[16303  2014  5871]
 [20677 32221 24656]
 [ 5414  2033 16561]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9287834
{'0': {'precision': 0.40013112812486784, 'recall': 0.6730823964707556, 'f1-score': 0.501896803289561, 'support': 28108}, '1': {'precision': 0.8486150099773396, 'recall': 0.3599804880848194, 'f1-score': 0.5055204093967846, 'support': 69701}, '2': {'precision': 0.38506370012883173, 'recall': 0.6739200458108157, 'f1-score': 0.49009656177611205, 'support': 27941}, 'accuracy': 0.4997216699801193, 'macro avg': {'precision': 0.5446032794103465, 'recall': 0.5689943101221303, 'f1-score': 0.4991712581541526, 'support': 125750}, 'weighted avg': {'precision': 0.6453699038176066, 'recall': 0.4997216699801193, 'f1-score': 0.5012833513702951, 'support': 125750}}
[[18919  2111  7078]
 [21617 25091 22993]
 [ 6746  2365 18830]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.95409185
{'0': {'precision': 0.42707238288193583, 'recall': 0.6545965899103533, 'f1-score': 0.5169051392085874, 'support': 34134}, '1': {'precision': 0.7584774215208998, 'recall': 0.3118346360232586, 'f1-score': 0.4419636852723604, 'support': 57957}, '2': {'precision': 0.4255790980384251, 'recall': 0.6271725244362578, 'f1-score': 0.507074055391415, 'support': 33659}, 'accuracy': 0.4892803180914513, 'macro avg': {'precision': 0.5370429674804202, 'recall': 0.5312012501232899, 'f1-score': 0.4886476266241209, 'support': 125750}, 'weighted avg': {'precision': 0.5794141669761761, 'recall': 0.4892803180914513, 'f1-score': 0.47973387641746124, 'support': 125750}}
[[22344  2629  9161]
 [20552 18073 19332]
 [ 9423  3126 21110]]
training model: results/EXC/W5/deepOF_L2/seq2seq
Epoch 1/50
1570/1570 - 62s - loss: 10.3791 - accuracy10: 0.5684 - accuracy20: 0.5784 - accuracy30: 0.5697 - accuracy50: 0.5473 - val_loss: 11.4477 - val_accuracy10: 0.5935 - val_accuracy20: 0.5863 - val_accuracy30: 0.5678 - val_accuracy50: 0.5345 - 62s/epoch - 39ms/step
Epoch 2/50
1570/1570 - 54s - loss: 9.4872 - accuracy10: 0.6329 - accuracy20: 0.6303 - accuracy30: 0.6117 - accuracy50: 0.5781 - val_loss: 11.1361 - val_accuracy10: 0.6092 - val_accuracy20: 0.6039 - val_accuracy30: 0.5865 - val_accuracy50: 0.5545 - 54s/epoch - 34ms/step
Epoch 3/50
1570/1570 - 54s - loss: 9.3104 - accuracy10: 0.6412 - accuracy20: 0.6359 - accuracy30: 0.6169 - accuracy50: 0.5839 - val_loss: 10.9967 - val_accuracy10: 0.6163 - val_accuracy20: 0.6131 - val_accuracy30: 0.5970 - val_accuracy50: 0.5613 - 54s/epoch - 34ms/step
Epoch 4/50
1570/1570 - 53s - loss: 9.2125 - accuracy10: 0.6454 - accuracy20: 0.6386 - accuracy30: 0.6197 - accuracy50: 0.5873 - val_loss: 10.8453 - val_accuracy10: 0.6153 - val_accuracy20: 0.6095 - val_accuracy30: 0.5922 - val_accuracy50: 0.5585 - 53s/epoch - 34ms/step
Epoch 5/50
1570/1570 - 53s - loss: 9.1501 - accuracy10: 0.6480 - accuracy20: 0.6406 - accuracy30: 0.6219 - accuracy50: 0.5890 - val_loss: 10.8153 - val_accuracy10: 0.6404 - val_accuracy20: 0.6318 - val_accuracy30: 0.6108 - val_accuracy50: 0.5693 - 53s/epoch - 34ms/step
Epoch 6/50
1570/1570 - 53s - loss: 9.0984 - accuracy10: 0.6492 - accuracy20: 0.6419 - accuracy30: 0.6233 - accuracy50: 0.5912 - val_loss: 10.8361 - val_accuracy10: 0.6461 - val_accuracy20: 0.6346 - val_accuracy30: 0.6120 - val_accuracy50: 0.5686 - 53s/epoch - 34ms/step
Epoch 7/50
1570/1570 - 52s - loss: 9.0586 - accuracy10: 0.6517 - accuracy20: 0.6436 - accuracy30: 0.6243 - accuracy50: 0.5922 - val_loss: 10.8623 - val_accuracy10: 0.6467 - val_accuracy20: 0.6350 - val_accuracy30: 0.6124 - val_accuracy50: 0.5690 - 52s/epoch - 33ms/step
Epoch 8/50
1570/1570 - 53s - loss: 9.0202 - accuracy10: 0.6531 - accuracy20: 0.6450 - accuracy30: 0.6263 - accuracy50: 0.5934 - val_loss: 10.8848 - val_accuracy10: 0.6348 - val_accuracy20: 0.6267 - val_accuracy30: 0.6059 - val_accuracy50: 0.5659 - 53s/epoch - 34ms/step
Epoch 9/50
1570/1570 - 53s - loss: 8.9818 - accuracy10: 0.6546 - accuracy20: 0.6468 - accuracy30: 0.6272 - accuracy50: 0.5942 - val_loss: 10.8648 - val_accuracy10: 0.6355 - val_accuracy20: 0.6261 - val_accuracy30: 0.6048 - val_accuracy50: 0.5646 - 53s/epoch - 34ms/step
Epoch 10/50
1570/1570 - 52s - loss: 8.9573 - accuracy10: 0.6555 - accuracy20: 0.6472 - accuracy30: 0.6280 - accuracy50: 0.5958 - val_loss: 10.8374 - val_accuracy10: 0.6393 - val_accuracy20: 0.6304 - val_accuracy30: 0.6075 - val_accuracy50: 0.5662 - 52s/epoch - 33ms/step
Epoch 11/50
1570/1570 - 53s - loss: 8.9306 - accuracy10: 0.6566 - accuracy20: 0.6488 - accuracy30: 0.6291 - accuracy50: 0.5956 - val_loss: 11.0281 - val_accuracy10: 0.6422 - val_accuracy20: 0.6318 - val_accuracy30: 0.6088 - val_accuracy50: 0.5658 - 53s/epoch - 34ms/step
Epoch 12/50
1570/1570 - 54s - loss: 8.9011 - accuracy10: 0.6560 - accuracy20: 0.6493 - accuracy30: 0.6299 - accuracy50: 0.5966 - val_loss: 11.0546 - val_accuracy10: 0.6372 - val_accuracy20: 0.6259 - val_accuracy30: 0.6033 - val_accuracy50: 0.5627 - 54s/epoch - 34ms/step
Epoch 13/50
1570/1570 - 53s - loss: 8.8754 - accuracy10: 0.6577 - accuracy20: 0.6508 - accuracy30: 0.6308 - accuracy50: 0.5975 - val_loss: 11.0973 - val_accuracy10: 0.6462 - val_accuracy20: 0.6329 - val_accuracy30: 0.6109 - val_accuracy50: 0.5682 - 53s/epoch - 34ms/step
Epoch 14/50
1570/1570 - 53s - loss: 8.8490 - accuracy10: 0.6591 - accuracy20: 0.6517 - accuracy30: 0.6318 - accuracy50: 0.5985 - val_loss: 10.9838 - val_accuracy10: 0.6343 - val_accuracy20: 0.6235 - val_accuracy30: 0.6018 - val_accuracy50: 0.5611 - 53s/epoch - 34ms/step
Epoch 15/50
1570/1570 - 53s - loss: 8.8233 - accuracy10: 0.6604 - accuracy20: 0.6524 - accuracy30: 0.6319 - accuracy50: 0.5985 - val_loss: 11.0013 - val_accuracy10: 0.6372 - val_accuracy20: 0.6272 - val_accuracy30: 0.6057 - val_accuracy50: 0.5653 - 53s/epoch - 34ms/step
testing model: results/EXC/W5/deepOF_L2/seq2seq
Evaluating performance on  test set...
7167/7167 - 112s - 112s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7905847
{'0': {'precision': 0.3835316318440156, 'recall': 0.5760472777456261, 'f1-score': 0.46047771630904916, 'support': 269556}, '1': {'precision': 0.8685054509134155, 'recall': 0.6625073505377773, 'f1-score': 0.7516478564606012, 'support': 1294123}, '2': {'precision': 0.36070015433947, 'recall': 0.5892530833890146, 'f1-score': 0.4474824016214898, 'support': 270887}, 'accuracy': 0.6389870955855499, 'macro avg': {'precision': 0.5375790790323004, 'recall': 0.6092692372241394, 'f1-score': 0.55320265813038, 'support': 1834566}, 'weighted avg': {'precision': 0.7222662552965243, 'recall': 0.6389870955855499, 'f1-score': 0.6639534775918692, 'support': 1834566}}
[[155277  67387  46892]
 [200739 857366 236018]
 [ 48845  62421 159621]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.82581687
{'0': {'precision': 0.4524130006185696, 'recall': 0.5466184839230681, 'f1-score': 0.49507410393311124, 'support': 357251}, '1': {'precision': 0.7853633277474344, 'recall': 0.666395824254296, 'f1-score': 0.7210050529548507, 'support': 1117501}, '2': {'precision': 0.4354459164643372, 'recall': 0.5502815343483022, 'f1-score': 0.48617464561863577, 'support': 359814}, 'accuracy': 0.6202976616812914, 'macro avg': {'precision': 0.5577407482767803, 'recall': 0.5877652808418888, 'f1-score': 0.5674179341688659, 'support': 1834566}, 'weighted avg': {'precision': 0.6518974176953947, 'recall': 0.6202976616812914, 'f1-score': 0.6309514241106237, 'support': 1834566}}
[[195280 105067  56904]
 [173002 744698 199801]
 [ 63359  98456 197999]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.87546384
{'0': {'precision': 0.48044841353595047, 'recall': 0.5187494807306565, 'f1-score': 0.4988648724536675, 'support': 421265}, '1': {'precision': 0.7072817519900075, 'recall': 0.6567161012668458, 'f1-score': 0.6810616505810518, 'support': 989860}, '2': {'precision': 0.47045976562330394, 'recall': 0.5117737772204393, 'f1-score': 0.49024791107461313, 'support': 423441}, 'accuracy': 0.5915807880446928, 'macro avg': {'precision': 0.5527299770497539, 'recall': 0.5624131197393138, 'f1-score': 0.5567248113697775, 'support': 1834566}, 'weighted avg': {'precision': 0.6005332975583045, 'recall': 0.5915807880446928, 'f1-score': 0.5951822183839117, 'support': 1834566}}
[[218531 137663  65071]
 [160954 650057 178849]
 [ 75363 131372 216706]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.94844365
{'0': {'precision': 0.5059506525140646, 'recall': 0.4680129084619993, 'f1-score': 0.48624290663205433, 'support': 517490}, '1': {'precision': 0.5728287232699555, 'recall': 0.642202719645096, 'f1-score': 0.6055352165902972, 'support': 798413}, '2': {'precision': 0.5053432066184578, 'recall': 0.44893890638044354, 'f1-score': 0.4754741253886169, 'support': 518663}, 'accuracy': 0.5384287073891045, 'macro avg': {'precision': 0.5280408608008259, 'recall': 0.519718178162513, 'f1-score': 0.5224174162036562, 'support': 1834566}, 'weighted avg': {'precision': 0.5348846136775605, 'recall': 0.5384287073891045, 'f1-score': 0.5351150446116231, 'support': 1834566}}
[[242192 193189  82109]
 [139855 512743 145815]
 [ 96640 189175 232848]]
Evaluating performance on  train set...
1570/1570 - 24s - 24s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7020232
{'0': {'precision': 0.36066218576832754, 'recall': 0.6201710761885817, 'f1-score': 0.4560861964289633, 'support': 50270}, '1': {'precision': 0.9036561768000815, 'recall': 0.707716849451645, 'f1-score': 0.7937736228837251, 'support': 300900}, '2': {'precision': 0.3774779528152559, 'recall': 0.5946684082408122, 'f1-score': 0.4618115591211933, 'support': 50529}, 'accuracy': 0.6825409074954132, 'macro avg': {'precision': 0.5472654384612216, 'recall': 0.6408521112936797, 'f1-score': 0.5705571261446273, 'support': 401699}, 'weighted avg': {'precision': 0.7695170143702633, 'recall': 0.6825409074954132, 'f1-score': 0.7097573369389311, 'support': 401699}}
[[ 31176  10572   8522]
 [ 46916 212952  41032]
 [  8349  12132  30048]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7306615
{'0': {'precision': 0.4427376890119594, 'recall': 0.5968431726996164, 'f1-score': 0.5083682794016399, 'support': 68043}, '1': {'precision': 0.8378814883270623, 'recall': 0.717181838043077, 'f1-score': 0.7728474791612967, 'support': 265478}, '2': {'precision': 0.4581142656852436, 'recall': 0.5559417994074335, 'f1-score': 0.5023092469270782, 'support': 68178}, 'accuracy': 0.6694315893243449, 'macro avg': {'precision': 0.5795778143414219, 'recall': 0.6233222700500423, 'f1-score': 0.5945083351633382, 'support': 401699}, 'weighted avg': {'precision': 0.7064932119258976, 'recall': 0.6694315893243449, 'f1-score': 0.6821310128855259, 'support': 401699}}
[[ 40611  17248  10184]
 [ 40432 190396  34650]
 [ 10684  19591  37903]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.78171045
{'0': {'precision': 0.4799113414291512, 'recall': 0.5711826412196723, 'f1-score': 0.5215842390382376, 'support': 80743}, '1': {'precision': 0.77384667494637, 'recall': 0.7140136678056505, 'f1-score': 0.7427271052546027, 'support': 239980}, '2': {'precision': 0.4962280962280962, 'recall': 0.5158318514127643, 'f1-score': 0.5058401099599761, 'support': 80976}, 'accuracy': 0.6453538594818509, 'macro avg': {'precision': 0.5833287042012059, 'recall': 0.600342720146029, 'f1-score': 0.5900504847509388, 'support': 401699}, 'weighted avg': {'precision': 0.658801174050247, 'recall': 0.6453538594818509, 'f1-score': 0.6505239885480995, 'support': 401699}}
[[ 46119  23528  11096]
 [ 37322 171349  31309]
 [ 12658  26548  41770]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.86336464
{'0': {'precision': 0.5181102991094605, 'recall': 0.5146319453396931, 'f1-score': 0.516365264545658, 'support': 100841}, '1': {'precision': 0.6565329972818463, 'recall': 0.7116832354495508, 'f1-score': 0.6829966148730279, 'support': 200578}, '2': {'precision': 0.533861226042707, 'recall': 0.4477662544874352, 'f1-score': 0.4870382020521943, 'support': 100280}, 'accuracy': 0.5963320794923562, 'macro avg': {'precision': 0.5695015074780047, 'recall': 0.5580271450922264, 'f1-score': 0.5621333604902934, 'support': 401699}, 'weighted avg': {'precision': 0.5911601471471373, 'recall': 0.5963320794923562, 'f1-score': 0.592247119265532, 'support': 401699}}
[[ 51896  35620  13325]
 [ 31949 142748  25881]
 [ 16319  39059  44902]]
Evaluating performance on  val set...
492/492 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.80185676
{'0': {'precision': 0.3593456785752222, 'recall': 0.5477064220183486, 'f1-score': 0.43396831505355654, 'support': 18530}, '1': {'precision': 0.8958120686765894, 'recall': 0.6622443463375078, 'f1-score': 0.7615211774685462, 'support': 88792}, '2': {'precision': 0.36333396096152637, 'recall': 0.6282830475363577, 'f1-score': 0.4604127728953752, 'support': 18428}, 'accuracy': 0.640389662027833, 'macro avg': {'precision': 0.5394972360711127, 'recall': 0.6127446052974047, 'f1-score': 0.551967421805826, 'support': 125750}, 'weighted avg': {'precision': 0.7387287384376111, 'recall': 0.640389662027833, 'f1-score': 0.6691284918222307, 'support': 125750}}
[[10149  3486  4895]
 [14597 58802 15393]
 [ 3497  3353 11578]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8113407
{'0': {'precision': 0.4306069638704183, 'recall': 0.5438298928556654, 'f1-score': 0.48064056158824175, 'support': 24173}, '1': {'precision': 0.8299774867615817, 'recall': 0.6753095975232198, 'f1-score': 0.7446974977595062, 'support': 77520}, '2': {'precision': 0.43409960493980776, 'recall': 0.5800806418090368, 'f1-score': 0.49658387303394785, 'support': 24057}, 'accuracy': 0.631817097415507, 'macro avg': {'precision': 0.5648946851906026, 'recall': 0.5997400440626407, 'f1-score': 0.5739739774605652, 'support': 125750}, 'weighted avg': {'precision': 0.6774715793831761, 'recall': 0.631817097415507, 'f1-score': 0.6464715113730988, 'support': 125750}}
[[13146  5418  5609]
 [12587 52350 12583]
 [ 4796  5306 13955]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8458825
{'0': {'precision': 0.46011610406364223, 'recall': 0.5331909592454174, 'f1-score': 0.4939655740948361, 'support': 28095}, '1': {'precision': 0.7661898696972665, 'recall': 0.6729820434857438, 'f1-score': 0.7165676587816685, 'support': 69724}, '2': {'precision': 0.46762229664173266, 'recall': 0.5349253517596936, 'f1-score': 0.4990147289669684, 'support': 27931}, 'accuracy': 0.6110854870775347, 'macro avg': {'precision': 0.5646427568008805, 'recall': 0.5803661181636183, 'f1-score': 0.569849320614491, 'support': 125750}, 'weighted avg': {'precision': 0.6314905986953516, 'recall': 0.6110854870775347, 'f1-score': 0.618512180038679, 'support': 125750}}
[[14980  7193  5922]
 [11713 46923 11088]
 [ 5864  7126 14941]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9000493
{'0': {'precision': 0.4896603512014787, 'recall': 0.49667496704262487, 'f1-score': 0.49314271586265074, 'support': 34135}, '1': {'precision': 0.652355127046299, 'recall': 0.6720989187231621, 'f1-score': 0.6620798613765512, 'support': 57987}, '2': {'precision': 0.4991396890135101, 'recall': 0.46583204472463424, 'f1-score': 0.4819110318095121, 'support': 33628}, 'accuracy': 0.5693200795228628, 'macro avg': {'precision': 0.5470517224204293, 'recall': 0.5448686434968071, 'f1-score': 0.545711203016238, 'support': 125750}, 'weighted avg': {'precision': 0.5672186266595828, 'recall': 0.5693200795228628, 'f1-score': 0.568040999644564, 'support': 125750}}
[[16954 10422  6759]
 [10054 38973  8960]
 [ 7616 10347 15665]]
training model: results/EXC/W5/deepVOL_L2/seq2seq
Epoch 1/50
1570/1570 - 57s - loss: 10.1592 - accuracy10: 0.5957 - accuracy20: 0.5968 - accuracy30: 0.5829 - accuracy50: 0.5564 - val_loss: 11.6929 - val_accuracy10: 0.6742 - val_accuracy20: 0.6558 - val_accuracy30: 0.6278 - val_accuracy50: 0.5683 - 57s/epoch - 36ms/step
Epoch 2/50
1570/1570 - 52s - loss: 9.6469 - accuracy10: 0.6261 - accuracy20: 0.6252 - accuracy30: 0.6086 - accuracy50: 0.5766 - val_loss: 11.4504 - val_accuracy10: 0.6726 - val_accuracy20: 0.6563 - val_accuracy30: 0.6301 - val_accuracy50: 0.5762 - 52s/epoch - 33ms/step
Epoch 3/50
1570/1570 - 52s - loss: 9.4164 - accuracy10: 0.6439 - accuracy20: 0.6382 - accuracy30: 0.6182 - accuracy50: 0.5824 - val_loss: 11.6150 - val_accuracy10: 0.6859 - val_accuracy20: 0.6635 - val_accuracy30: 0.6330 - val_accuracy50: 0.5746 - 52s/epoch - 33ms/step
Epoch 4/50
1570/1570 - 52s - loss: 9.2891 - accuracy10: 0.6516 - accuracy20: 0.6421 - accuracy30: 0.6191 - accuracy50: 0.5829 - val_loss: 11.3289 - val_accuracy10: 0.6928 - val_accuracy20: 0.6692 - val_accuracy30: 0.6377 - val_accuracy50: 0.5804 - 52s/epoch - 33ms/step
Epoch 5/50
1570/1570 - 52s - loss: 9.2133 - accuracy10: 0.6557 - accuracy20: 0.6450 - accuracy30: 0.6213 - accuracy50: 0.5846 - val_loss: 11.4508 - val_accuracy10: 0.6836 - val_accuracy20: 0.6641 - val_accuracy30: 0.6338 - val_accuracy50: 0.5767 - 52s/epoch - 33ms/step
Epoch 6/50
1570/1570 - 51s - loss: 9.1597 - accuracy10: 0.6583 - accuracy20: 0.6469 - accuracy30: 0.6228 - accuracy50: 0.5857 - val_loss: 11.3152 - val_accuracy10: 0.6826 - val_accuracy20: 0.6628 - val_accuracy30: 0.6319 - val_accuracy50: 0.5756 - 51s/epoch - 33ms/step
Epoch 7/50
1570/1570 - 52s - loss: 9.1141 - accuracy10: 0.6618 - accuracy20: 0.6491 - accuracy30: 0.6248 - accuracy50: 0.5874 - val_loss: 11.2381 - val_accuracy10: 0.6797 - val_accuracy20: 0.6608 - val_accuracy30: 0.6318 - val_accuracy50: 0.5763 - 52s/epoch - 33ms/step
Epoch 8/50
1570/1570 - 51s - loss: 9.0834 - accuracy10: 0.6629 - accuracy20: 0.6502 - accuracy30: 0.6257 - accuracy50: 0.5882 - val_loss: 11.3445 - val_accuracy10: 0.6774 - val_accuracy20: 0.6582 - val_accuracy30: 0.6296 - val_accuracy50: 0.5749 - 51s/epoch - 33ms/step
Epoch 9/50
1570/1570 - 50s - loss: 9.0476 - accuracy10: 0.6658 - accuracy20: 0.6514 - accuracy30: 0.6268 - accuracy50: 0.5898 - val_loss: 11.3137 - val_accuracy10: 0.6813 - val_accuracy20: 0.6608 - val_accuracy30: 0.6310 - val_accuracy50: 0.5733 - 50s/epoch - 32ms/step
Epoch 10/50
1570/1570 - 51s - loss: 9.0213 - accuracy10: 0.6664 - accuracy20: 0.6519 - accuracy30: 0.6273 - accuracy50: 0.5900 - val_loss: 11.1573 - val_accuracy10: 0.6708 - val_accuracy20: 0.6542 - val_accuracy30: 0.6270 - val_accuracy50: 0.5754 - 51s/epoch - 32ms/step
Epoch 11/50
1570/1570 - 50s - loss: 8.9924 - accuracy10: 0.6681 - accuracy20: 0.6531 - accuracy30: 0.6283 - accuracy50: 0.5911 - val_loss: 11.2110 - val_accuracy10: 0.6703 - val_accuracy20: 0.6530 - val_accuracy30: 0.6271 - val_accuracy50: 0.5754 - 50s/epoch - 32ms/step
Epoch 12/50
1570/1570 - 50s - loss: 8.9702 - accuracy10: 0.6682 - accuracy20: 0.6537 - accuracy30: 0.6293 - accuracy50: 0.5918 - val_loss: 11.2927 - val_accuracy10: 0.6707 - val_accuracy20: 0.6511 - val_accuracy30: 0.6247 - val_accuracy50: 0.5724 - 50s/epoch - 32ms/step
Epoch 13/50
1570/1570 - 50s - loss: 8.9550 - accuracy10: 0.6692 - accuracy20: 0.6540 - accuracy30: 0.6299 - accuracy50: 0.5926 - val_loss: 11.3191 - val_accuracy10: 0.6710 - val_accuracy20: 0.6508 - val_accuracy30: 0.6247 - val_accuracy50: 0.5740 - 50s/epoch - 32ms/step
Epoch 14/50
1570/1570 - 50s - loss: 8.9291 - accuracy10: 0.6704 - accuracy20: 0.6546 - accuracy30: 0.6302 - accuracy50: 0.5933 - val_loss: 11.2426 - val_accuracy10: 0.6651 - val_accuracy20: 0.6470 - val_accuracy30: 0.6213 - val_accuracy50: 0.5731 - 50s/epoch - 32ms/step
Epoch 15/50
1570/1570 - 50s - loss: 8.9151 - accuracy10: 0.6710 - accuracy20: 0.6550 - accuracy30: 0.6310 - accuracy50: 0.5942 - val_loss: 11.3323 - val_accuracy10: 0.6677 - val_accuracy20: 0.6492 - val_accuracy30: 0.6230 - val_accuracy50: 0.5745 - 50s/epoch - 32ms/step
Epoch 16/50
1570/1570 - 51s - loss: 8.8950 - accuracy10: 0.6715 - accuracy20: 0.6555 - accuracy30: 0.6311 - accuracy50: 0.5944 - val_loss: 11.2315 - val_accuracy10: 0.6551 - val_accuracy20: 0.6397 - val_accuracy30: 0.6174 - val_accuracy50: 0.5720 - 51s/epoch - 33ms/step
Epoch 17/50
1570/1570 - 51s - loss: 8.8782 - accuracy10: 0.6721 - accuracy20: 0.6559 - accuracy30: 0.6315 - accuracy50: 0.5950 - val_loss: 11.4333 - val_accuracy10: 0.6691 - val_accuracy20: 0.6490 - val_accuracy30: 0.6244 - val_accuracy50: 0.5750 - 51s/epoch - 32ms/step
Epoch 18/50
1570/1570 - 50s - loss: 8.8635 - accuracy10: 0.6722 - accuracy20: 0.6561 - accuracy30: 0.6319 - accuracy50: 0.5955 - val_loss: 11.3138 - val_accuracy10: 0.6576 - val_accuracy20: 0.6426 - val_accuracy30: 0.6214 - val_accuracy50: 0.5763 - 50s/epoch - 32ms/step
Epoch 19/50
1570/1570 - 50s - loss: 8.8453 - accuracy10: 0.6731 - accuracy20: 0.6568 - accuracy30: 0.6323 - accuracy50: 0.5951 - val_loss: 11.5118 - val_accuracy10: 0.6547 - val_accuracy20: 0.6396 - val_accuracy30: 0.6172 - val_accuracy50: 0.5728 - 50s/epoch - 32ms/step
Epoch 20/50
1570/1570 - 50s - loss: 8.8282 - accuracy10: 0.6736 - accuracy20: 0.6575 - accuracy30: 0.6326 - accuracy50: 0.5964 - val_loss: 11.5572 - val_accuracy10: 0.6468 - val_accuracy20: 0.6305 - val_accuracy30: 0.6087 - val_accuracy50: 0.5661 - 50s/epoch - 32ms/step
testing model: results/EXC/W5/deepVOL_L2/seq2seq
Evaluating performance on  test set...
7167/7167 - 111s - 111s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.71542597
{'0': {'precision': 0.4046627274582346, 'recall': 0.6768177771182669, 'f1-score': 0.5064962826826871, 'support': 269560}, '1': {'precision': 0.8682633024490866, 'recall': 0.7064629869030996, 'f1-score': 0.7790507978613489, 'support': 1294123}, '2': {'precision': 0.37157714924944446, 'recall': 0.4536967307521928, 'f1-score': 0.4085512504924017, 'support': 270888}, 'accuracy': 0.6647843010709316, 'macro avg': {'precision': 0.5481677263855885, 'recall': 0.6123258315911865, 'f1-score': 0.5646994436788125, 'support': 1834571}, 'weighted avg': {'precision': 0.7268054413674065, 'recall': 0.6647843010709316, 'f1-score': 0.6842963966965864, 'support': 1834571}}
[[182443  74327  12790]
 [184809 914250 195064]
 [ 83600  64387 122901]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7671931
{'0': {'precision': 0.47463021338506306, 'recall': 0.6136401170032609, 'f1-score': 0.5352569697842745, 'support': 357255}, '1': {'precision': 0.7806651995904824, 'recall': 0.7075922079711785, 'f1-score': 0.7423347728126174, 'support': 1117501}, '2': {'precision': 0.4628971827540969, 'recall': 0.4628573016689132, 'f1-score': 0.4628772413524755, 'support': 359815}, 'accuracy': 0.6412965210940323, 'macro avg': {'precision': 0.5727308652432141, 'recall': 0.5946965422144509, 'f1-score': 0.5801563279831224, 'support': 1834571}, 'weighted avg': {'precision': 0.6587455638964694, 'recall': 0.6412965210940323, 'f1-score': 0.6471994020893139, 'support': 1834571}}
[[219226 115894  22135]
 [155660 790735 171106]
 [ 87002 106270 166543]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8256709
{'0': {'precision': 0.4994406145115221, 'recall': 0.5690591997037522, 'f1-score': 0.5319818920178416, 'support': 421269}, '1': {'precision': 0.7012183314342556, 'recall': 0.6950679894126442, 'f1-score': 0.6981296149541512, 'support': 989860}, '2': {'precision': 0.5068451695491722, 'recall': 0.4469490508735553, 'f1-score': 0.4750164398552289, 'support': 423442}, 'accuracy': 0.6088638706269749, 'macro avg': {'precision': 0.5691680384983167, 'recall': 0.5703587466633172, 'f1-score': 0.5683759822757405, 'support': 1834571}, 'weighted avg': {'precision': 0.6100207394929971, 'recall': 0.6088638706269749, 'f1-score': 0.6084801142349673, 'support': 1834571}}
[[239727 149782  31760]
 [149455 688020 152385]
 [ 90809 143376 189257]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9242425
{'0': {'precision': 0.5212187549753224, 'recall': 0.5060976670215829, 'f1-score': 0.5135469272225833, 'support': 517493}, '1': {'precision': 0.5658046609059963, 'recall': 0.676594694725662, 'f1-score': 0.6162598685917967, 'support': 798413}, '2': {'precision': 0.5486893817528442, 'recall': 0.3991844446800922, 'f1-score': 0.4621464588406774, 'support': 518665}, 'accuracy': 0.5500724692584806, 'macro avg': {'precision': 0.5452375992113877, 'recall': 0.5272922688091124, 'f1-score': 0.5306510848850191, 'support': 1834571}, 'weighted avg': {'precision': 0.5483891504243896, 'recall': 0.5500724692584806, 'f1-score': 0.5437162276879872, 'support': 1834571}}
[[261902 208492  47099]
 [135012 540202 123199]
 [105566 206056 207043]]
Evaluating performance on  train set...
1570/1570 - 23s - 23s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.635186
{'0': {'precision': 0.39602409776284053, 'recall': 0.6880983593532753, 'f1-score': 0.5027172532886384, 'support': 50346}, '1': {'precision': 0.89516737047295, 'recall': 0.7613992417672605, 'f1-score': 0.8228824027923413, 'support': 300963}, '2': {'precision': 0.3856576168152079, 'recall': 0.44568366739432425, 'f1-score': 0.4135035857967465, 'support': 50390}, 'accuracy': 0.7126081966845822, 'macro avg': {'precision': 0.5589496950169995, 'recall': 0.6317270895049534, 'f1-score': 0.5797010806259087, 'support': 401699}, 'weighted avg': {'precision': 0.7686944051564398, 'recall': 0.7126081966845822, 'f1-score': 0.7314018832856423, 'support': 401699}}
[[ 34643  13439   2264]
 [ 38299 229153  33511]
 [ 14535  13397  22458]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6881826
{'0': {'precision': 0.4812514298787463, 'recall': 0.6181548362450227, 'f1-score': 0.5411791946179227, 'support': 68059}, '1': {'precision': 0.8213749673057964, 'recall': 0.7686693905217374, 'f1-score': 0.7941486567977123, 'support': 265555}, '2': {'precision': 0.4783316099993918, 'recall': 0.4620254094147022, 'f1-score': 0.4700371313943324, 'support': 68085}, 'accuracy': 0.6911941528358299, 'macro avg': {'precision': 0.5936526690613114, 'recall': 0.6162832120604874, 'f1-score': 0.6017883276033225, 'support': 401699}, 'weighted avg': {'precision': 0.7056052620888201, 'recall': 0.6911941528358299, 'f1-score': 0.6963540846589134, 'support': 401699}}
[[ 42071  21941   4047]
 [ 31171 204124  30260]
 [ 14178  22450  31457]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.75184584
{'0': {'precision': 0.5136920996030954, 'recall': 0.5737033047311269, 'f1-score': 0.5420417522124928, 'support': 80763}, '1': {'precision': 0.7537214960207826, 'recall': 0.7614835984302486, 'f1-score': 0.7575826653514262, 'support': 240038}, '2': {'precision': 0.5193865866562305, 'recall': 0.4429404929664516, 'f1-score': 0.4781271474224259, 'support': 80898}, 'accuracy': 0.6595784405736633, 'macro avg': {'precision': 0.5956000607600362, 'recall': 0.592709132042609, 'f1-score': 0.5925838549954484, 'support': 401699}, 'weighted avg': {'precision': 0.6582701266107139, 'recall': 0.6595784405736633, 'f1-score': 0.6579679706241304, 'support': 401699}}
[[ 46334  29191   5238]
 [ 29333 182785  27920]
 [ 14531  30534  35833]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8586878
{'0': {'precision': 0.5429318981929568, 'recall': 0.5060973191624365, 'f1-score': 0.5238679221079098, 'support': 100864}, '1': {'precision': 0.6344910976853139, 'recall': 0.7506267725326594, 'f1-score': 0.6876902177015194, 'support': 200631}, '2': {'precision': 0.5594960468687787, 'recall': 0.39265897568959324, 'f1-score': 0.46146087446049916, 'support': 100204}, 'accuracy': 0.5999317897231509, 'macro avg': {'precision': 0.5789730142490165, 'recall': 0.5497943557948964, 'f1-score': 0.5576730047566427, 'support': 401699}, 'weighted avg': {'precision': 0.5927936297562993, 'recall': 0.5999317897231509, 'f1-score': 0.5901224937766976, 'support': 401699}}
[[ 51047  42622   7195]
 [ 26249 150599  23783]
 [ 16725  44133  39346]]
Evaluating performance on  val set...
492/492 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.71762925
{'0': {'precision': 0.39268217054263566, 'recall': 0.683985957331893, 'f1-score': 0.49892642568698903, 'support': 18515}, '1': {'precision': 0.8756935072724547, 'recall': 0.7230244572251798, 'f1-score': 0.7920694417044782, 'support': 88849}, '2': {'precision': 0.3735167072141403, 'recall': 0.4091700206678995, 'f1-score': 0.39053131570067745, 'support': 18386}, 'accuracy': 0.6713876739562624, 'macro avg': {'precision': 0.5472974616764102, 'recall': 0.605393478408324, 'f1-score': 0.5605090610307149, 'support': 125750}, 'weighted avg': {'precision': 0.7311529303704685, 'recall': 0.6713876739562624, 'f1-score': 0.6901988816546197, 'support': 125750}}
[[12664  4779  1072]
 [13063 64240 11546]
 [ 6523  4340  7523]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.75904274
{'0': {'precision': 0.4636449769247226, 'recall': 0.627170497767488, 'f1-score': 0.5331505790148839, 'support': 24188}, '1': {'precision': 0.803023440154003, 'recall': 0.7315161049075483, 'f1-score': 0.76560370305394, 'support': 77554}, '2': {'precision': 0.46204708930885047, 'recall': 0.43077307564145284, 'f1-score': 0.4458623439891358, 'support': 24008}, 'accuracy': 0.6540278330019881, 'macro avg': {'precision': 0.5762385021291919, 'recall': 0.5964865594388297, 'f1-score': 0.5815388753526533, 'support': 125750}, 'weighted avg': {'precision': 0.6726453367768239, 'recall': 0.6540278330019881, 'f1-score': 0.659846830587264, 'support': 125750}}
[[15170  7240  1778]
 [10559 56732 10263]
 [ 6990  6676 10342]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.80816114
{'0': {'precision': 0.48810050429089624, 'recall': 0.5888359185996869, 'f1-score': 0.5337568731154361, 'support': 28108}, '1': {'precision': 0.7374402874965305, 'recall': 0.7242363811136139, 'f1-score': 0.730778696237532, 'support': 69701}, '2': {'precision': 0.5025226611937745, 'recall': 0.4206363408611002, 'f1-score': 0.45794774883594064, 'support': 27941}, 'accuracy': 0.6265129224652087, 'macro avg': {'precision': 0.5760211509937337, 'recall': 0.5779028801914671, 'f1-score': 0.5741611060629696, 'support': 125750}, 'weighted avg': {'precision': 0.6295096630601943, 'recall': 0.6265129224652087, 'f1-score': 0.6261181880413988, 'support': 125750}}
[[16551  9230  2327]
 [ 9913 50480  9308]
 [ 7445  8743 11753]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8944405
{'0': {'precision': 0.5110047846889952, 'recall': 0.5319036737563719, 'f1-score': 0.5212448323380799, 'support': 34134}, '1': {'precision': 0.6222088745401306, 'recall': 0.7149438376727574, 'f1-score': 0.6653606525788426, 'support': 57957}, '2': {'precision': 0.5382857142857143, 'recall': 0.3778187111916575, 'f1-score': 0.44399832413937573, 'support': 33659}, 'accuracy': 0.5750218687872763, 'macro avg': {'precision': 0.5571664578382801, 'recall': 0.5415554075402623, 'f1-score': 0.5435346030187661, 'support': 125750}, 'weighted avg': {'precision': 0.5695598880273508, 'recall': 0.5750218687872763, 'f1-score': 0.5669902031073341, 'support': 125750}}
[[18156 12799  3179]
 [ 8792 41436  7729]
 [ 8582 12360 12717]]
training model: results/EXC/W5/deepVOL_L3/seq2seq
Epoch 1/50
1570/1570 - 78s - loss: 10.4201 - accuracy10: 0.5727 - accuracy20: 0.5783 - accuracy30: 0.5697 - accuracy50: 0.5485 - val_loss: 11.3832 - val_accuracy10: 0.5971 - val_accuracy20: 0.5908 - val_accuracy30: 0.5743 - val_accuracy50: 0.5428 - 78s/epoch - 50ms/step
Epoch 2/50
1570/1570 - 70s - loss: 9.5762 - accuracy10: 0.6394 - accuracy20: 0.6359 - accuracy30: 0.6173 - accuracy50: 0.5828 - val_loss: 11.1715 - val_accuracy10: 0.6775 - val_accuracy20: 0.6591 - val_accuracy30: 0.6322 - val_accuracy50: 0.5787 - 70s/epoch - 45ms/step
Epoch 3/50
1570/1570 - 69s - loss: 9.3472 - accuracy10: 0.6531 - accuracy20: 0.6452 - accuracy30: 0.6240 - accuracy50: 0.5860 - val_loss: 11.2757 - val_accuracy10: 0.6727 - val_accuracy20: 0.6543 - val_accuracy30: 0.6279 - val_accuracy50: 0.5764 - 69s/epoch - 44ms/step
Epoch 4/50
1570/1570 - 69s - loss: 9.2072 - accuracy10: 0.6568 - accuracy20: 0.6475 - accuracy30: 0.6251 - accuracy50: 0.5877 - val_loss: 11.2190 - val_accuracy10: 0.6904 - val_accuracy20: 0.6649 - val_accuracy30: 0.6335 - val_accuracy50: 0.5784 - 69s/epoch - 44ms/step
Epoch 5/50
1570/1570 - 70s - loss: 9.1264 - accuracy10: 0.6599 - accuracy20: 0.6498 - accuracy30: 0.6263 - accuracy50: 0.5880 - val_loss: 11.2278 - val_accuracy10: 0.6884 - val_accuracy20: 0.6642 - val_accuracy30: 0.6339 - val_accuracy50: 0.5799 - 70s/epoch - 45ms/step
Epoch 6/50
1570/1570 - 71s - loss: 9.0664 - accuracy10: 0.6643 - accuracy20: 0.6516 - accuracy30: 0.6276 - accuracy50: 0.5902 - val_loss: 11.3142 - val_accuracy10: 0.6868 - val_accuracy20: 0.6584 - val_accuracy30: 0.6288 - val_accuracy50: 0.5763 - 71s/epoch - 45ms/step
Epoch 7/50
1570/1570 - 70s - loss: 9.0171 - accuracy10: 0.6667 - accuracy20: 0.6529 - accuracy30: 0.6291 - accuracy50: 0.5911 - val_loss: 10.9400 - val_accuracy10: 0.6857 - val_accuracy20: 0.6603 - val_accuracy30: 0.6326 - val_accuracy50: 0.5826 - 70s/epoch - 44ms/step
Epoch 8/50
1570/1570 - 69s - loss: 8.9806 - accuracy10: 0.6678 - accuracy20: 0.6529 - accuracy30: 0.6292 - accuracy50: 0.5912 - val_loss: 11.0617 - val_accuracy10: 0.6923 - val_accuracy20: 0.6661 - val_accuracy30: 0.6350 - val_accuracy50: 0.5819 - 69s/epoch - 44ms/step
Epoch 9/50
1570/1570 - 70s - loss: 8.9402 - accuracy10: 0.6694 - accuracy20: 0.6552 - accuracy30: 0.6317 - accuracy50: 0.5932 - val_loss: 10.8595 - val_accuracy10: 0.6744 - val_accuracy20: 0.6555 - val_accuracy30: 0.6295 - val_accuracy50: 0.5806 - 70s/epoch - 45ms/step
Epoch 10/50
1570/1570 - 70s - loss: 8.9108 - accuracy10: 0.6710 - accuracy20: 0.6550 - accuracy30: 0.6317 - accuracy50: 0.5939 - val_loss: 10.8450 - val_accuracy10: 0.6906 - val_accuracy20: 0.6671 - val_accuracy30: 0.6368 - val_accuracy50: 0.5844 - 70s/epoch - 44ms/step
Epoch 11/50
1570/1570 - 69s - loss: 8.8880 - accuracy10: 0.6720 - accuracy20: 0.6554 - accuracy30: 0.6319 - accuracy50: 0.5949 - val_loss: 10.9118 - val_accuracy10: 0.6783 - val_accuracy20: 0.6554 - val_accuracy30: 0.6291 - val_accuracy50: 0.5799 - 69s/epoch - 44ms/step
Epoch 12/50
1570/1570 - 70s - loss: 8.8673 - accuracy10: 0.6720 - accuracy20: 0.6553 - accuracy30: 0.6324 - accuracy50: 0.5951 - val_loss: 10.9684 - val_accuracy10: 0.6807 - val_accuracy20: 0.6564 - val_accuracy30: 0.6308 - val_accuracy50: 0.5814 - 70s/epoch - 45ms/step
Epoch 13/50
1570/1570 - 69s - loss: 8.8466 - accuracy10: 0.6725 - accuracy20: 0.6560 - accuracy30: 0.6328 - accuracy50: 0.5962 - val_loss: 10.9525 - val_accuracy10: 0.6808 - val_accuracy20: 0.6559 - val_accuracy30: 0.6294 - val_accuracy50: 0.5801 - 69s/epoch - 44ms/step
Epoch 14/50
1570/1570 - 68s - loss: 8.8312 - accuracy10: 0.6730 - accuracy20: 0.6563 - accuracy30: 0.6337 - accuracy50: 0.5961 - val_loss: 10.8434 - val_accuracy10: 0.6832 - val_accuracy20: 0.6574 - val_accuracy30: 0.6315 - val_accuracy50: 0.5826 - 68s/epoch - 44ms/step
Epoch 15/50
1570/1570 - 70s - loss: 8.8123 - accuracy10: 0.6730 - accuracy20: 0.6563 - accuracy30: 0.6337 - accuracy50: 0.5965 - val_loss: 10.9184 - val_accuracy10: 0.6869 - val_accuracy20: 0.6596 - val_accuracy30: 0.6315 - val_accuracy50: 0.5827 - 70s/epoch - 44ms/step
Epoch 16/50
1570/1570 - 69s - loss: 8.7936 - accuracy10: 0.6745 - accuracy20: 0.6573 - accuracy30: 0.6348 - accuracy50: 0.5973 - val_loss: 11.0573 - val_accuracy10: 0.6703 - val_accuracy20: 0.6494 - val_accuracy30: 0.6258 - val_accuracy50: 0.5790 - 69s/epoch - 44ms/step
Epoch 17/50
1570/1570 - 69s - loss: 8.7755 - accuracy10: 0.6750 - accuracy20: 0.6581 - accuracy30: 0.6361 - accuracy50: 0.5993 - val_loss: 10.8836 - val_accuracy10: 0.6766 - val_accuracy20: 0.6560 - val_accuracy30: 0.6316 - val_accuracy50: 0.5828 - 69s/epoch - 44ms/step
Epoch 18/50
1570/1570 - 70s - loss: 8.7643 - accuracy10: 0.6747 - accuracy20: 0.6576 - accuracy30: 0.6354 - accuracy50: 0.5989 - val_loss: 11.2031 - val_accuracy10: 0.6844 - val_accuracy20: 0.6611 - val_accuracy30: 0.6360 - val_accuracy50: 0.5850 - 70s/epoch - 44ms/step
Epoch 19/50
1570/1570 - 70s - loss: 8.7463 - accuracy10: 0.6757 - accuracy20: 0.6581 - accuracy30: 0.6363 - accuracy50: 0.5995 - val_loss: 10.7844 - val_accuracy10: 0.6691 - val_accuracy20: 0.6492 - val_accuracy30: 0.6270 - val_accuracy50: 0.5817 - 70s/epoch - 45ms/step
Epoch 20/50
1570/1570 - 69s - loss: 8.7293 - accuracy10: 0.6760 - accuracy20: 0.6588 - accuracy30: 0.6364 - accuracy50: 0.5996 - val_loss: 10.8766 - val_accuracy10: 0.6700 - val_accuracy20: 0.6511 - val_accuracy30: 0.6290 - val_accuracy50: 0.5821 - 69s/epoch - 44ms/step
Epoch 21/50
1570/1570 - 70s - loss: 8.7115 - accuracy10: 0.6763 - accuracy20: 0.6589 - accuracy30: 0.6369 - accuracy50: 0.6005 - val_loss: 10.7867 - val_accuracy10: 0.6624 - val_accuracy20: 0.6441 - val_accuracy30: 0.6235 - val_accuracy50: 0.5789 - 70s/epoch - 45ms/step
Epoch 22/50
1570/1570 - 70s - loss: 8.7013 - accuracy10: 0.6760 - accuracy20: 0.6593 - accuracy30: 0.6371 - accuracy50: 0.6004 - val_loss: 10.9608 - val_accuracy10: 0.6611 - val_accuracy20: 0.6434 - val_accuracy30: 0.6231 - val_accuracy50: 0.5799 - 70s/epoch - 44ms/step
Epoch 23/50
1570/1570 - 70s - loss: 8.6896 - accuracy10: 0.6763 - accuracy20: 0.6599 - accuracy30: 0.6379 - accuracy50: 0.6008 - val_loss: 10.8587 - val_accuracy10: 0.6473 - val_accuracy20: 0.6311 - val_accuracy30: 0.6131 - val_accuracy50: 0.5747 - 70s/epoch - 45ms/step
Epoch 24/50
1570/1570 - 70s - loss: 8.6747 - accuracy10: 0.6767 - accuracy20: 0.6601 - accuracy30: 0.6387 - accuracy50: 0.6023 - val_loss: 10.8699 - val_accuracy10: 0.6451 - val_accuracy20: 0.6301 - val_accuracy30: 0.6133 - val_accuracy50: 0.5744 - 70s/epoch - 45ms/step
Epoch 25/50
1570/1570 - 70s - loss: 8.6548 - accuracy10: 0.6775 - accuracy20: 0.6607 - accuracy30: 0.6387 - accuracy50: 0.6021 - val_loss: 10.8996 - val_accuracy10: 0.6706 - val_accuracy20: 0.6520 - val_accuracy30: 0.6318 - val_accuracy50: 0.5864 - 70s/epoch - 45ms/step
Epoch 26/50
1570/1570 - 70s - loss: 8.6414 - accuracy10: 0.6773 - accuracy20: 0.6613 - accuracy30: 0.6393 - accuracy50: 0.6025 - val_loss: 10.7136 - val_accuracy10: 0.6445 - val_accuracy20: 0.6310 - val_accuracy30: 0.6149 - val_accuracy50: 0.5763 - 70s/epoch - 45ms/step
Epoch 27/50
1570/1570 - 69s - loss: 8.6317 - accuracy10: 0.6780 - accuracy20: 0.6612 - accuracy30: 0.6389 - accuracy50: 0.6028 - val_loss: 11.0063 - val_accuracy10: 0.6716 - val_accuracy20: 0.6537 - val_accuracy30: 0.6310 - val_accuracy50: 0.5847 - 69s/epoch - 44ms/step
Epoch 28/50
1570/1570 - 78s - loss: 8.6150 - accuracy10: 0.6776 - accuracy20: 0.6608 - accuracy30: 0.6397 - accuracy50: 0.6035 - val_loss: 11.0268 - val_accuracy10: 0.6637 - val_accuracy20: 0.6452 - val_accuracy30: 0.6237 - val_accuracy50: 0.5795 - 78s/epoch - 49ms/step
Epoch 29/50
1570/1570 - 70s - loss: 8.5970 - accuracy10: 0.6785 - accuracy20: 0.6619 - accuracy30: 0.6406 - accuracy50: 0.6040 - val_loss: 10.8261 - val_accuracy10: 0.6472 - val_accuracy20: 0.6306 - val_accuracy30: 0.6114 - val_accuracy50: 0.5719 - 70s/epoch - 45ms/step
Epoch 30/50
1570/1570 - 69s - loss: 8.5887 - accuracy10: 0.6785 - accuracy20: 0.6622 - accuracy30: 0.6407 - accuracy50: 0.6045 - val_loss: 11.1217 - val_accuracy10: 0.6448 - val_accuracy20: 0.6288 - val_accuracy30: 0.6113 - val_accuracy50: 0.5718 - 69s/epoch - 44ms/step
Epoch 31/50
1570/1570 - 68s - loss: 8.5741 - accuracy10: 0.6793 - accuracy20: 0.6625 - accuracy30: 0.6414 - accuracy50: 0.6056 - val_loss: 11.2972 - val_accuracy10: 0.6620 - val_accuracy20: 0.6412 - val_accuracy30: 0.6203 - val_accuracy50: 0.5756 - 68s/epoch - 44ms/step
Epoch 32/50
1570/1570 - 68s - loss: 8.5588 - accuracy10: 0.6796 - accuracy20: 0.6631 - accuracy30: 0.6419 - accuracy50: 0.6059 - val_loss: 11.0848 - val_accuracy10: 0.6503 - val_accuracy20: 0.6341 - val_accuracy30: 0.6147 - val_accuracy50: 0.5732 - 68s/epoch - 44ms/step
Epoch 33/50
1570/1570 - 69s - loss: 8.5475 - accuracy10: 0.6800 - accuracy20: 0.6639 - accuracy30: 0.6425 - accuracy50: 0.6065 - val_loss: 11.3625 - val_accuracy10: 0.6514 - val_accuracy20: 0.6299 - val_accuracy30: 0.6099 - val_accuracy50: 0.5689 - 69s/epoch - 44ms/step
Epoch 34/50
1570/1570 - 69s - loss: 8.5281 - accuracy10: 0.6801 - accuracy20: 0.6640 - accuracy30: 0.6428 - accuracy50: 0.6063 - val_loss: 11.1075 - val_accuracy10: 0.6520 - val_accuracy20: 0.6311 - val_accuracy30: 0.6100 - val_accuracy50: 0.5674 - 69s/epoch - 44ms/step
Epoch 35/50
1570/1570 - 70s - loss: 8.5249 - accuracy10: 0.6803 - accuracy20: 0.6645 - accuracy30: 0.6438 - accuracy50: 0.6068 - val_loss: 11.3126 - val_accuracy10: 0.6527 - val_accuracy20: 0.6336 - val_accuracy30: 0.6142 - val_accuracy50: 0.5724 - 70s/epoch - 45ms/step
Epoch 36/50
1570/1570 - 69s - loss: 8.5073 - accuracy10: 0.6799 - accuracy20: 0.6644 - accuracy30: 0.6440 - accuracy50: 0.6072 - val_loss: 11.5418 - val_accuracy10: 0.6612 - val_accuracy20: 0.6386 - val_accuracy30: 0.6153 - val_accuracy50: 0.5700 - 69s/epoch - 44ms/step
testing model: results/EXC/W5/deepVOL_L3/seq2seq
Evaluating performance on  test set...
7167/7167 - 146s - 146s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.72411525
{'0': {'precision': 0.39546071322562865, 'recall': 0.6919535539397537, 'f1-score': 0.5032864736515474, 'support': 269560}, '1': {'precision': 0.8900543375132227, 'recall': 0.6560280591566644, 'f1-score': 0.7553292383904454, 'support': 1294123}, '2': {'precision': 0.3575165379970566, 'recall': 0.5398725672602699, 'f1-score': 0.4301665132231089, 'support': 270888}, 'accuracy': 0.6441555001141956, 'macro avg': {'precision': 0.5476771962453026, 'recall': 0.6292847267855626, 'f1-score': 0.5629274084217005, 'support': 1834571}, 'weighted avg': {'precision': 0.7387487969817856, 'recall': 0.6441555001141956, 'f1-score': 0.6702830188883673, 'support': 1834571}}
[[186523  60064  22973]
 [205302 848981 239840]
 [ 79835  44808 146245]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7830592
{'0': {'precision': 0.45827337841141835, 'recall': 0.6400806146869883, 'f1-score': 0.5341299937751172, 'support': 357255}, '1': {'precision': 0.8117306480919276, 'recall': 0.6388325379574604, 'f1-score': 0.7149774033225251, 'support': 1117501}, '2': {'precision': 0.4351265371806424, 'recall': 0.5515778941956283, 'f1-score': 0.4864803916041406, 'support': 359815}, 'accuracy': 0.6219623007231664, 'macro avg': {'precision': 0.5683768545613295, 'recall': 0.6101636822800257, 'f1-score': 0.5785292629005943, 'support': 1834571}, 'weighted avg': {'precision': 0.6690366967282276, 'recall': 0.6219623007231664, 'f1-score': 0.6349449087669535, 'support': 1834571}}
[[228672  91844  36739]
 [182699 713896 220906]
 [ 87615  73734 198466]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8407915
{'0': {'precision': 0.4832964440802322, 'recall': 0.5991848438883469, 'f1-score': 0.5350372475102088, 'support': 421269}, '1': {'precision': 0.7371238808337218, 'recall': 0.6198048208837613, 'f1-score': 0.6733926909365506, 'support': 989860}, '2': {'precision': 0.4760641788774738, 'recall': 0.5396181767514795, 'f1-score': 0.5058528048633348, 'support': 423442}, 'accuracy': 0.5965618119985544, 'macro avg': {'precision': 0.5654948345971426, 'recall': 0.5862026138411959, 'f1-score': 0.5714275811033648, 'support': 1834571}, 'weighted avg': {'precision': 0.6185821221503767, 'recall': 0.5965618119985544, 'f1-score': 0.6029520899811304, 'support': 1834571}}
[[252418 119131  49720]
 [174586 613520 201754]
 [ 95280  99665 228497]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.93203354
{'0': {'precision': 0.5077685556715953, 'recall': 0.5355338139839573, 'f1-score': 0.5212817283827542, 'support': 517493}, '1': {'precision': 0.6043923854063001, 'recall': 0.5917877088674658, 'f1-score': 0.598023636622526, 'support': 798413}, '2': {'precision': 0.5154382774610025, 'recall': 0.5038647296424474, 'f1-score': 0.5095857983550489, 'support': 518665}, 'accuracy': 0.5510623464559289, 'macro avg': {'precision': 0.5425330728462993, 'recall': 0.5437287508312901, 'f1-score': 0.5429637211201097, 'support': 1834571}, 'weighted avg': {'precision': 0.5519880151647835, 'recall': 0.5510623464559289, 'f1-score': 0.5513734869658896, 'support': 1834571}}
[[277135 165429  74929]
 [155169 472491 170753]
 [113486 143842 261337]]
Evaluating performance on  train set...
1570/1570 - 33s - 33s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6314058
{'0': {'precision': 0.3819523390746659, 'recall': 0.7073848965161085, 'f1-score': 0.4960581664205922, 'support': 50346}, '1': {'precision': 0.9119735369296824, 'recall': 0.7255111093390217, 'f1-score': 0.8081259680490608, 'support': 300963}, '2': {'precision': 0.37933332367555667, 'recall': 0.519646755308593, 'f1-score': 0.4385399308317772, 'support': 50390}, 'accuracy': 0.6974152288156057, 'macro avg': {'precision': 0.5577530665599684, 'recall': 0.6508475870545744, 'f1-score': 0.5809080217671434, 'support': 401699}, 'weighted avg': {'precision': 0.7787290240653634, 'recall': 0.6974152288156057, 'f1-score': 0.722652003821702, 'support': 401699}}
[[ 35614  10947   3785]
 [ 43552 218352  39059]
 [ 14076  10129  26185]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.68847144
{'0': {'precision': 0.45530805591057555, 'recall': 0.659530701303281, 'f1-score': 0.5387140328242671, 'support': 68059}, '1': {'precision': 0.847452252059102, 'recall': 0.7144696955432961, 'f1-score': 0.7752998841530814, 'support': 265555}, '2': {'precision': 0.455502404422623, 'recall': 0.5300580157156496, 'f1-score': 0.48996022102447834, 'support': 68085}, 'accuracy': 0.6739050881381333, 'macro avg': {'precision': 0.5860875707974335, 'recall': 0.6346861375207422, 'f1-score': 0.6013247126672755, 'support': 401699}, 'weighted avg': {'precision': 0.7145795109718645, 'recall': 0.6739050881381333, 'f1-score': 0.6868526950395942, 'support': 401699}}
[[ 44887  17101   6071]
 [ 38755 189731  37069]
 [ 14944  17052  36089]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7489028
{'0': {'precision': 0.4875389105058366, 'recall': 0.6205688248331538, 'f1-score': 0.5460686521793607, 'support': 80763}, '1': {'precision': 0.784420171973042, 'recall': 0.7030886776260425, 'f1-score': 0.7415309718182378, 'support': 240038}, '2': {'precision': 0.494955163643745, 'recall': 0.5123983287596727, 'f1-score': 0.5035257247323062, 'support': 80898}, 'accuracy': 0.6480947176866261, 'macro avg': {'precision': 0.5889714153742079, 'recall': 0.6120186104062897, 'f1-score': 0.5970417829099682, 'support': 401699}, 'weighted avg': {'precision': 0.6664359062325264, 'recall': 0.6480947176866261, 'f1-score': 0.6543008024631924, 'support': 401699}}
[[ 50119  22990   7654]
 [ 36627 168768  34643]
 [ 16054  23392  41452]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.84956545
{'0': {'precision': 0.5220340249815488, 'recall': 0.5539934961928934, 'f1-score': 0.5375391408493384, 'support': 100864}, '1': {'precision': 0.6676195930729207, 'recall': 0.6855919573744835, 'f1-score': 0.6764864273366399, 'support': 200631}, '2': {'precision': 0.5321230310962676, 'recall': 0.4706498742565167, 'f1-score': 0.49950220301643794, 'support': 100204}, 'accuracy': 0.5989310404058761, 'macro avg': {'precision': 0.5739255497169125, 'recall': 0.5700784426079646, 'f1-score': 0.5711759237341387, 'support': 401699}, 'weighted avg': {'precision': 0.5972643264770948, 'recall': 0.5989310404058761, 'f1-score': 0.5974488735512515, 'support': 401699}}
[[ 55878  34073  10913]
 [ 32526 137551  30554]
 [ 18635  34408  47161]]
Evaluating performance on  val set...
492/492 - 10s - 10s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.75312805
{'0': {'precision': 0.36698154657293497, 'recall': 0.7217931406967324, 'f1-score': 0.48657406564599226, 'support': 18515}, '1': {'precision': 0.910511407850095, 'recall': 0.6584654863870162, 'f1-score': 0.7642436790918532, 'support': 88849}, '2': {'precision': 0.3685805422647528, 'recall': 0.5027738496682258, 'f1-score': 0.425343946993052, 'support': 18386}, 'accuracy': 0.6450258449304175, 'macro avg': {'precision': 0.5486911655625942, 'recall': 0.6276774922506582, 'f1-score': 0.5587205639102991, 'support': 125750}, 'weighted avg': {'precision': 0.7512478191725704, 'recall': 0.6450258449304175, 'f1-score': 0.6738097755744086, 'support': 125750}}
[[13364  3148  2003]
 [16512 58504 13833]
 [ 6540  2602  9244]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.787918
{'0': {'precision': 0.432684638698357, 'recall': 0.6728543079212833, 'f1-score': 0.5266819844017993, 'support': 24188}, '1': {'precision': 0.8494337220211768, 'recall': 0.6537509348325038, 'f1-score': 0.7388554524125268, 'support': 77554}, '2': {'precision': 0.4431946006749156, 'recall': 0.5251582805731423, 'f1-score': 0.4807076406893396, 'support': 24008}, 'accuracy': 0.6328747514910537, 'macro avg': {'precision': 0.5751043204648165, 'recall': 0.6172545077756432, 'f1-score': 0.5820816925012219, 'support': 125750}, 'weighted avg': {'precision': 0.6917135180236149, 'recall': 0.6328747514910537, 'f1-score': 0.6487587167616818, 'support': 125750}}
[[16275  4789  3124]
 [14137 50701 12716]
 [ 7202  4198 12608]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8270683
{'0': {'precision': 0.46218249265804523, 'recall': 0.6382880318770456, 'f1-score': 0.5361443982906493, 'support': 28108}, '1': {'precision': 0.7901361911921537, 'recall': 0.6484125048421113, 'f1-score': 0.7122931442080379, 'support': 69701}, '2': {'precision': 0.4803417078666801, 'recall': 0.5111484914641566, 'f1-score': 0.49526649790200095, 'support': 27941}, 'accuracy': 0.6156500994035785, 'macro avg': {'precision': 0.5775534639056263, 'recall': 0.5992830093944378, 'f1-score': 0.5812346801335627, 'support': 125750}, 'weighted avg': {'precision': 0.6479963087508513, 'recall': 0.6156500994035785, 'f1-score': 0.6246976732364042, 'support': 125750}}
[[17941  6299  3868]
 [12923 45195 11583]
 [ 7954  5705 14282]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.89540744
{'0': {'precision': 0.4927572615670424, 'recall': 0.5750278314876662, 'f1-score': 0.5307231603282545, 'support': 34134}, '1': {'precision': 0.6768683274021352, 'recall': 0.6399399554842383, 'f1-score': 0.6578863346104726, 'support': 57957}, '2': {'precision': 0.5100250626566416, 'recall': 0.47158263763035146, 'f1-score': 0.49005109522853924, 'support': 33659}, 'accuracy': 0.5772564612326043, 'macro avg': {'precision': 0.5598835505419397, 'recall': 0.5621834748674187, 'f1-score': 0.5595535300557555, 'support': 125750}, 'weighted avg': {'precision': 0.5822343348034583, 'recall': 0.5772564612326043, 'f1-score': 0.5784449500116199, 'support': 125750}}
[[19628  9171  5335]
 [10954 37089  9914]
 [ 9251  8535 15873]]
training model: results/EXC/W6/deepLOB_L1/seq2seq
Epoch 1/50
1504/1504 - 47s - loss: 11.1539 - accuracy10: 0.4735 - accuracy20: 0.4922 - accuracy30: 0.4989 - accuracy50: 0.5004 - val_loss: 11.2664 - val_accuracy10: 0.6034 - val_accuracy20: 0.5916 - val_accuracy30: 0.5764 - val_accuracy50: 0.5415 - 47s/epoch - 32ms/step
Epoch 2/50
1504/1504 - 42s - loss: 10.2653 - accuracy10: 0.5627 - accuracy20: 0.5712 - accuracy30: 0.5667 - accuracy50: 0.5496 - val_loss: 10.7829 - val_accuracy10: 0.6633 - val_accuracy20: 0.6399 - val_accuracy30: 0.6138 - val_accuracy50: 0.5616 - 42s/epoch - 28ms/step
Epoch 3/50
1504/1504 - 42s - loss: 9.7779 - accuracy10: 0.6173 - accuracy20: 0.6079 - accuracy30: 0.5900 - accuracy50: 0.5628 - val_loss: 10.6678 - val_accuracy10: 0.6786 - val_accuracy20: 0.6507 - val_accuracy30: 0.6215 - val_accuracy50: 0.5697 - 42s/epoch - 28ms/step
Epoch 4/50
1504/1504 - 42s - loss: 9.5708 - accuracy10: 0.6338 - accuracy20: 0.6177 - accuracy30: 0.5960 - accuracy50: 0.5684 - val_loss: 10.5922 - val_accuracy10: 0.6869 - val_accuracy20: 0.6557 - val_accuracy30: 0.6253 - val_accuracy50: 0.5710 - 42s/epoch - 28ms/step
Epoch 5/50
1504/1504 - 41s - loss: 9.4408 - accuracy10: 0.6415 - accuracy20: 0.6243 - accuracy30: 0.6016 - accuracy50: 0.5723 - val_loss: 10.4489 - val_accuracy10: 0.6857 - val_accuracy20: 0.6549 - val_accuracy30: 0.6243 - val_accuracy50: 0.5722 - 41s/epoch - 27ms/step
Epoch 6/50
1504/1504 - 42s - loss: 9.3610 - accuracy10: 0.6441 - accuracy20: 0.6276 - accuracy30: 0.6044 - accuracy50: 0.5750 - val_loss: 10.3589 - val_accuracy10: 0.6893 - val_accuracy20: 0.6597 - val_accuracy30: 0.6294 - val_accuracy50: 0.5770 - 42s/epoch - 28ms/step
Epoch 7/50
1504/1504 - 41s - loss: 9.3025 - accuracy10: 0.6473 - accuracy20: 0.6308 - accuracy30: 0.6073 - accuracy50: 0.5770 - val_loss: 10.3530 - val_accuracy10: 0.6966 - val_accuracy20: 0.6660 - val_accuracy30: 0.6342 - val_accuracy50: 0.5787 - 41s/epoch - 27ms/step
Epoch 8/50
1504/1504 - 40s - loss: 9.2660 - accuracy10: 0.6481 - accuracy20: 0.6318 - accuracy30: 0.6089 - accuracy50: 0.5785 - val_loss: 10.2102 - val_accuracy10: 0.6896 - val_accuracy20: 0.6639 - val_accuracy30: 0.6327 - val_accuracy50: 0.5789 - 40s/epoch - 27ms/step
Epoch 9/50
1504/1504 - 40s - loss: 9.2318 - accuracy10: 0.6489 - accuracy20: 0.6330 - accuracy30: 0.6100 - accuracy50: 0.5797 - val_loss: 10.2599 - val_accuracy10: 0.7002 - val_accuracy20: 0.6706 - val_accuracy30: 0.6380 - val_accuracy50: 0.5806 - 40s/epoch - 27ms/step
Epoch 10/50
1504/1504 - 40s - loss: 9.1962 - accuracy10: 0.6506 - accuracy20: 0.6348 - accuracy30: 0.6115 - accuracy50: 0.5811 - val_loss: 10.2858 - val_accuracy10: 0.6996 - val_accuracy20: 0.6695 - val_accuracy30: 0.6374 - val_accuracy50: 0.5809 - 40s/epoch - 26ms/step
Epoch 11/50
1504/1504 - 40s - loss: 9.1713 - accuracy10: 0.6521 - accuracy20: 0.6360 - accuracy30: 0.6130 - accuracy50: 0.5822 - val_loss: 10.2540 - val_accuracy10: 0.6994 - val_accuracy20: 0.6701 - val_accuracy30: 0.6373 - val_accuracy50: 0.5814 - 40s/epoch - 26ms/step
Epoch 12/50
1504/1504 - 40s - loss: 9.1561 - accuracy10: 0.6530 - accuracy20: 0.6368 - accuracy30: 0.6138 - accuracy50: 0.5834 - val_loss: 10.1709 - val_accuracy10: 0.6965 - val_accuracy20: 0.6677 - val_accuracy30: 0.6363 - val_accuracy50: 0.5811 - 40s/epoch - 27ms/step
Epoch 13/50
1504/1504 - 40s - loss: 9.1316 - accuracy10: 0.6545 - accuracy20: 0.6379 - accuracy30: 0.6150 - accuracy50: 0.5849 - val_loss: 10.1070 - val_accuracy10: 0.6942 - val_accuracy20: 0.6680 - val_accuracy30: 0.6376 - val_accuracy50: 0.5834 - 40s/epoch - 26ms/step
Epoch 14/50
1504/1504 - 40s - loss: 9.1102 - accuracy10: 0.6551 - accuracy20: 0.6384 - accuracy30: 0.6162 - accuracy50: 0.5858 - val_loss: 10.1578 - val_accuracy10: 0.6931 - val_accuracy20: 0.6664 - val_accuracy30: 0.6359 - val_accuracy50: 0.5813 - 40s/epoch - 27ms/step
Epoch 15/50
1504/1504 - 41s - loss: 9.0985 - accuracy10: 0.6553 - accuracy20: 0.6398 - accuracy30: 0.6170 - accuracy50: 0.5858 - val_loss: 10.1354 - val_accuracy10: 0.6923 - val_accuracy20: 0.6651 - val_accuracy30: 0.6337 - val_accuracy50: 0.5795 - 41s/epoch - 27ms/step
Epoch 16/50
1504/1504 - 40s - loss: 9.0824 - accuracy10: 0.6569 - accuracy20: 0.6405 - accuracy30: 0.6174 - accuracy50: 0.5861 - val_loss: 10.1095 - val_accuracy10: 0.6940 - val_accuracy20: 0.6672 - val_accuracy30: 0.6369 - val_accuracy50: 0.5816 - 40s/epoch - 27ms/step
Epoch 17/50
1504/1504 - 41s - loss: 9.0654 - accuracy10: 0.6565 - accuracy20: 0.6407 - accuracy30: 0.6181 - accuracy50: 0.5869 - val_loss: 10.1034 - val_accuracy10: 0.6838 - val_accuracy20: 0.6605 - val_accuracy30: 0.6322 - val_accuracy50: 0.5796 - 41s/epoch - 27ms/step
Epoch 18/50
1504/1504 - 40s - loss: 9.0511 - accuracy10: 0.6576 - accuracy20: 0.6410 - accuracy30: 0.6186 - accuracy50: 0.5875 - val_loss: 10.1237 - val_accuracy10: 0.6868 - val_accuracy20: 0.6618 - val_accuracy30: 0.6340 - val_accuracy50: 0.5810 - 40s/epoch - 27ms/step
Epoch 19/50
1504/1504 - 41s - loss: 9.0439 - accuracy10: 0.6580 - accuracy20: 0.6419 - accuracy30: 0.6197 - accuracy50: 0.5877 - val_loss: 10.0393 - val_accuracy10: 0.6812 - val_accuracy20: 0.6581 - val_accuracy30: 0.6303 - val_accuracy50: 0.5811 - 41s/epoch - 27ms/step
Epoch 20/50
1504/1504 - 41s - loss: 9.0430 - accuracy10: 0.6566 - accuracy20: 0.6417 - accuracy30: 0.6196 - accuracy50: 0.5883 - val_loss: 10.1523 - val_accuracy10: 0.6871 - val_accuracy20: 0.6628 - val_accuracy30: 0.6349 - val_accuracy50: 0.5814 - 41s/epoch - 27ms/step
Epoch 21/50
1504/1504 - 40s - loss: 9.0185 - accuracy10: 0.6584 - accuracy20: 0.6432 - accuracy30: 0.6207 - accuracy50: 0.5892 - val_loss: 10.1412 - val_accuracy10: 0.6873 - val_accuracy20: 0.6625 - val_accuracy30: 0.6336 - val_accuracy50: 0.5811 - 40s/epoch - 27ms/step
Epoch 22/50
1504/1504 - 40s - loss: 9.0037 - accuracy10: 0.6587 - accuracy20: 0.6432 - accuracy30: 0.6207 - accuracy50: 0.5890 - val_loss: 10.1460 - val_accuracy10: 0.6850 - val_accuracy20: 0.6628 - val_accuracy30: 0.6334 - val_accuracy50: 0.5809 - 40s/epoch - 27ms/step
Epoch 23/50
1504/1504 - 40s - loss: 8.9895 - accuracy10: 0.6596 - accuracy20: 0.6441 - accuracy30: 0.6215 - accuracy50: 0.5900 - val_loss: 10.1977 - val_accuracy10: 0.6854 - val_accuracy20: 0.6624 - val_accuracy30: 0.6339 - val_accuracy50: 0.5804 - 40s/epoch - 27ms/step
Epoch 24/50
1504/1504 - 40s - loss: 8.9772 - accuracy10: 0.6596 - accuracy20: 0.6438 - accuracy30: 0.6218 - accuracy50: 0.5898 - val_loss: 10.1588 - val_accuracy10: 0.6841 - val_accuracy20: 0.6623 - val_accuracy30: 0.6323 - val_accuracy50: 0.5801 - 40s/epoch - 26ms/step
Epoch 25/50
1504/1504 - 40s - loss: 8.9679 - accuracy10: 0.6604 - accuracy20: 0.6446 - accuracy30: 0.6226 - accuracy50: 0.5904 - val_loss: 10.2224 - val_accuracy10: 0.6844 - val_accuracy20: 0.6602 - val_accuracy30: 0.6318 - val_accuracy50: 0.5795 - 40s/epoch - 27ms/step
Epoch 26/50
1504/1504 - 40s - loss: 8.9528 - accuracy10: 0.6611 - accuracy20: 0.6454 - accuracy30: 0.6234 - accuracy50: 0.5912 - val_loss: 10.2025 - val_accuracy10: 0.6837 - val_accuracy20: 0.6629 - val_accuracy30: 0.6338 - val_accuracy50: 0.5798 - 40s/epoch - 27ms/step
Epoch 27/50
1504/1504 - 40s - loss: 8.9413 - accuracy10: 0.6615 - accuracy20: 0.6460 - accuracy30: 0.6235 - accuracy50: 0.5916 - val_loss: 10.2016 - val_accuracy10: 0.6815 - val_accuracy20: 0.6581 - val_accuracy30: 0.6288 - val_accuracy50: 0.5763 - 40s/epoch - 27ms/step
Epoch 28/50
1504/1504 - 40s - loss: 8.9312 - accuracy10: 0.6616 - accuracy20: 0.6467 - accuracy30: 0.6243 - accuracy50: 0.5918 - val_loss: 10.2678 - val_accuracy10: 0.6862 - val_accuracy20: 0.6606 - val_accuracy30: 0.6315 - val_accuracy50: 0.5772 - 40s/epoch - 26ms/step
Epoch 29/50
1504/1504 - 40s - loss: 8.9159 - accuracy10: 0.6622 - accuracy20: 0.6473 - accuracy30: 0.6245 - accuracy50: 0.5925 - val_loss: 10.3367 - val_accuracy10: 0.6857 - val_accuracy20: 0.6582 - val_accuracy30: 0.6276 - val_accuracy50: 0.5731 - 40s/epoch - 27ms/step
testing model: results/EXC/W6/deepLOB_L1/seq2seq
Evaluating performance on  test set...
4450/4450 - 57s - 57s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.77800375
{'0': {'precision': 0.38026620244891385, 'recall': 0.6383950161465619, 'f1-score': 0.47662568088551027, 'support': 192301}, '1': {'precision': 0.8315349242586847, 'recall': 0.6764445996497299, 'f1-score': 0.7460145181243144, 'support': 755988}, '2': {'precision': 0.4584095063985375, 'recall': 0.48354573656409827, 'f1-score': 0.4706422392688102, 'support': 190832}, 'accuracy': 0.637705739776547, 'macro avg': {'precision': 0.5567368777020453, 'recall': 0.5994617841201301, 'f1-score': 0.5644274794262117, 'support': 1139121}, 'weighted avg': {'precision': 0.6928457979816445, 'recall': 0.637705739776547, 'f1-score': 0.6544056499633265, 'support': 1139121}}
[[122764  40906  28631]
 [164215 511384  80389]
 [ 35858  62698  92276]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8147775
{'0': {'precision': 0.4465605909930388, 'recall': 0.6348796626190649, 'f1-score': 0.5243234407109878, 'support': 247554}, '1': {'precision': 0.7561881618983296, 'recall': 0.6716564675178498, 'f1-score': 0.7114200790979881, 'support': 646786}, '2': {'precision': 0.5174552276349753, 'recall': 0.44961005960429934, 'f1-score': 0.48115278008516443, 'support': 244781}, 'accuracy': 0.615949490879371, 'macro avg': {'precision': 0.5734013268421146, 'recall': 0.5853820632470713, 'f1-score': 0.5722987666313801, 'support': 1139121}, 'weighted avg': {'precision': 0.6375995044424434, 'recall': 0.615949490879371, 'f1-score': 0.6212790133649243, 'support': 1139121}}
[[157167  57034  33353]
 [143090 434418  69278]
 [ 51693  83032 110056]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8573731
{'0': {'precision': 0.4753569832521121, 'recall': 0.6252449196663494, 'f1-score': 0.5400945392120121, 'support': 285808}, '1': {'precision': 0.6916655229079416, 'recall': 0.6536555012182083, 'f1-score': 0.6721235540720287, 'support': 570510}, '2': {'precision': 0.5372955118619859, 'recall': 0.4256425851210914, 'f1-score': 0.4749959553151106, 'support': 282803}, 'accuracy': 0.5899197714729164, 'macro avg': {'precision': 0.5681060060073465, 'recall': 0.568181002001883, 'f1-score': 0.5624046828663839, 'support': 1139121}, 'weighted avg': {'precision': 0.5990686755705799, 'recall': 0.5899197714729164, 'f1-score': 0.5900574478459436, 'support': 1139121}}
[[178700  69651  37457]
 [131388 372917  66205]
 [ 65840  96590 120373]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9226776
{'0': {'precision': 0.5039863311367921, 'recall': 0.5855974475746974, 'f1-score': 0.541735504680985, 'support': 341009}, '1': {'precision': 0.5747458634755634, 'recall': 0.636792483592641, 'f1-score': 0.6041803740226097, 'support': 460007}, '2': {'precision': 0.5580962589773824, 'recall': 0.38497508170538736, 'f1-score': 0.4556455988658043, 'support': 338105}, 'accuracy': 0.5467241847003084, 'macro avg': {'precision': 0.5456094845299126, 'recall': 0.5357883376242419, 'f1-score': 0.5338538258564663, 'support': 1139121}, 'weighted avg': {'precision': 0.5486213763559602, 'recall': 0.5467241847003084, 'f1-score': 0.5413998506157813, 'support': 1139121}}
[[199694  95018  46297]
 [110312 292929  56766]
 [ 86223 121720 130162]]
Evaluating performance on  train set...
1504/1504 - 18s - 18s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7226072
{'0': {'precision': 0.36340548280222823, 'recall': 0.6583047766902062, 'f1-score': 0.46829629629629627, 'support': 52819}, '1': {'precision': 0.8850138007890196, 'recall': 0.6754433813977191, 'f1-score': 0.7661558689497541, 'support': 278654}, '2': {'precision': 0.41412860113248506, 'recall': 0.5936340119221685, 'f1-score': 0.4878943111350768, 'support': 53346}, 'accuracy': 0.6617500695131997, 'macro avg': {'precision': 0.5541826282412443, 'recall': 0.6424607233366979, 'f1-score': 0.5741154921270424, 'support': 384819}, 'weighted avg': {'precision': 0.7481425142656882, 'recall': 0.6617500695131998, 'f1-score': 0.6866982906306878, 'support': 384819}}
[[ 34771   9774   8274]
 [ 53912 188215  36527]
 [  6998  14680  31668]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7584773
{'0': {'precision': 0.4320103661755531, 'recall': 0.6415285280576976, 'f1-score': 0.5163240490065617, 'support': 70159}, '1': {'precision': 0.8142403270694284, 'recall': 0.6771438402739659, 'f1-score': 0.7393907405626514, 'support': 244118}, '2': {'precision': 0.49101379816797436, 'recall': 0.5402738793910011, 'f1-score': 0.5144673699556565, 'support': 70542}, 'accuracy': 0.6455606401970797, 'macro avg': {'precision': 0.5790881638043186, 'recall': 0.6196487492408882, 'f1-score': 0.5900607198416231, 'support': 384819}, 'weighted avg': {'precision': 0.6853020011860398, 'recall': 0.6455606401970797, 'f1-score': 0.6574907293307676, 'support': 384819}}
[[ 45009  15759   9391]
 [ 48699 165303  30116]
 [ 10477  21953  38112]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.80663913
{'0': {'precision': 0.46404469922356867, 'recall': 0.6179490276603454, 'f1-score': 0.5300510780260881, 'support': 82790}, '1': {'precision': 0.7490776040733823, 'recall': 0.6684033406240154, 'f1-score': 0.7064447318636347, 'support': 219001}, '2': {'precision': 0.526908888776593, 'recall': 0.5023365611600906, 'f1-score': 0.5143294036403098, 'support': 83028}, 'accuracy': 0.6217182623519109, 'macro avg': {'precision': 0.580010397357848, 'recall': 0.5962296431481504, 'f1-score': 0.5836084045100108, 'support': 384819}, 'weighted avg': {'precision': 0.6398207890871734, 'recall': 0.6217182623519109, 'f1-score': 0.6270448527699914, 'support': 384819}}
[[ 51160  21273  10357]
 [ 45529 146381  27091]
 [ 13559  27761  41708]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8835769
{'0': {'precision': 0.5013519780883292, 'recall': 0.559480098433655, 'f1-score': 0.5288234778314664, 'support': 102404}, '1': {'precision': 0.6264245276082641, 'recall': 0.6625709619721596, 'f1-score': 0.6439909297052153, 'support': 180026}, '2': {'precision': 0.5656324880191693, 'recall': 0.44265497270214577, 'f1-score': 0.49664414821633057, 'support': 102389}, 'accuracy': 0.5766243350770103, 'macro avg': {'precision': 0.5644696645719209, 'recall': 0.5549020110359868, 'f1-score': 0.5564861852510041, 'support': 384819}, 'weighted avg': {'precision': 0.5769665603495601, 'recall': 0.5766243350770103, 'f1-score': 0.5741391361307172, 'support': 384819}}
[[ 57293  32418  12693]
 [ 38634 119280  22112]
 [ 18350  38716  45323]]
Evaluating performance on  val set...
510/510 - 6s - 6s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.68609744
{'0': {'precision': 0.3740875912408759, 'recall': 0.6896060208677803, 'f1-score': 0.48505143269635664, 'support': 17539}, '1': {'precision': 0.879800779105336, 'recall': 0.7083333333333334, 'f1-score': 0.7848105693995825, 'support': 95016}, '2': {'precision': 0.43678797103454636, 'recall': 0.5274003118734685, 'f1-score': 0.4778363650124883, 'support': 17956}, 'accuracy': 0.6809234470657646, 'macro avg': {'precision': 0.5635587804602528, 'recall': 0.6417798886915275, 'f1-score': 0.5825661223694758, 'support': 130511}, 'weighted avg': {'precision': 0.7508887212429808, 'recall': 0.6809234470657646, 'f1-score': 0.702292587676873, 'support': 130511}}
[[12095  3212  2232]
 [17734 67303  9979]
 [ 2503  5983  9470]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7347407
{'0': {'precision': 0.4406879855872087, 'recall': 0.6673913970243424, 'f1-score': 0.5308489174479918, 'support': 23457}, '1': {'precision': 0.8045556843756394, 'recall': 0.7100501968148496, 'f1-score': 0.7543545540578561, 'support': 83073}, '2': {'precision': 0.5190568475452196, 'recall': 0.4690796880864017, 'f1-score': 0.49280441592009283, 'support': 23981}, 'accuracy': 0.6581054470504402, 'macro avg': {'precision': 0.5881001725026893, 'recall': 0.6155070939751979, 'f1-score': 0.5926692958086469, 'support': 130511}, 'weighted avg': {'precision': 0.6866974791936201, 'recall': 0.6581054470504402, 'f1-score': 0.6661244004260604, 'support': 130511}}
[[15655  5309  2493]
 [16157 58986  7930]
 [ 3712  9020 11249]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.78979486
{'0': {'precision': 0.47060379254714235, 'recall': 0.643079147090712, 'f1-score': 0.5434858966723171, 'support': 27670}, '1': {'precision': 0.7374240223384901, 'recall': 0.702718684065528, 'f1-score': 0.7196531791907514, 'support': 74411}, '2': {'precision': 0.5600018356202102, 'recall': 0.4292296869504045, 'f1-score': 0.4859720037434539, 'support': 28430}, 'accuracy': 0.6304985786638674, 'macro avg': {'precision': 0.5893432168352809, 'recall': 0.5916758393688815, 'f1-score': 0.5830370265355075, 'support': 130511}, 'weighted avg': {'precision': 0.6422057761620966, 'recall': 0.6304985786638674, 'f1-score': 0.6313992808584136, 'support': 130511}}
[[17794  7244  2632]
 [15165 52290  6956]
 [ 4852 11375 12203]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.87472045
{'0': {'precision': 0.5033478746068784, 'recall': 0.5839291493806456, 'f1-score': 0.5406524552203228, 'support': 33987}, '1': {'precision': 0.6195634926359217, 'recall': 0.6997051300848769, 'f1-score': 0.6572001285327376, 'support': 61383}, '2': {'precision': 0.5961856617647059, 'recall': 0.36916991548333855, 'f1-score': 0.45598495632765684, 'support': 35141}, 'accuracy': 0.580556428193792, 'macro avg': {'precision': 0.5730323430025019, 'recall': 0.5509347316496204, 'f1-score': 0.5512791800269057, 'support': 130511}, 'weighted avg': {'precision': 0.5830045775667053, 'recall': 0.580556428193792, 'f1-score': 0.5726707927730867, 'support': 130511}}
[[19846 10927  3214]
 [12860 42950  5573]
 [ 6722 15446 12973]]
training model: results/EXC/W6/deepOF_L1/seq2seq
Epoch 1/50
1504/1504 - 45s - loss: 12.3379 - accuracy10: 0.3915 - accuracy20: 0.4185 - accuracy30: 0.4321 - accuracy50: 0.4427 - val_loss: 13.3544 - val_accuracy10: 0.6167 - val_accuracy20: 0.5712 - val_accuracy30: 0.5352 - val_accuracy50: 0.4674 - 45s/epoch - 30ms/step
Epoch 2/50
1504/1504 - 37s - loss: 12.0300 - accuracy10: 0.4156 - accuracy20: 0.4442 - accuracy30: 0.4583 - accuracy50: 0.4654 - val_loss: 12.6669 - val_accuracy10: 0.5973 - val_accuracy20: 0.5652 - val_accuracy30: 0.5371 - val_accuracy50: 0.4798 - 37s/epoch - 25ms/step
Epoch 3/50
1504/1504 - 37s - loss: 11.9214 - accuracy10: 0.4275 - accuracy20: 0.4527 - accuracy30: 0.4661 - accuracy50: 0.4721 - val_loss: 12.5009 - val_accuracy10: 0.5824 - val_accuracy20: 0.5533 - val_accuracy30: 0.5303 - val_accuracy50: 0.4799 - 37s/epoch - 25ms/step
Epoch 4/50
1504/1504 - 37s - loss: 11.8336 - accuracy10: 0.4381 - accuracy20: 0.4585 - accuracy30: 0.4701 - accuracy50: 0.4753 - val_loss: 12.4364 - val_accuracy10: 0.5885 - val_accuracy20: 0.5582 - val_accuracy30: 0.5358 - val_accuracy50: 0.4855 - 37s/epoch - 25ms/step
Epoch 5/50
1504/1504 - 37s - loss: 11.7659 - accuracy10: 0.4473 - accuracy20: 0.4655 - accuracy30: 0.4751 - accuracy50: 0.4791 - val_loss: 12.4043 - val_accuracy10: 0.5864 - val_accuracy20: 0.5580 - val_accuracy30: 0.5356 - val_accuracy50: 0.4849 - 37s/epoch - 25ms/step
Epoch 6/50
1504/1504 - 38s - loss: 11.7078 - accuracy10: 0.4539 - accuracy20: 0.4701 - accuracy30: 0.4783 - accuracy50: 0.4812 - val_loss: 12.3832 - val_accuracy10: 0.5925 - val_accuracy20: 0.5624 - val_accuracy30: 0.5371 - val_accuracy50: 0.4868 - 38s/epoch - 25ms/step
Epoch 7/50
1504/1504 - 37s - loss: 11.6418 - accuracy10: 0.4603 - accuracy20: 0.4756 - accuracy30: 0.4828 - accuracy50: 0.4855 - val_loss: 12.4181 - val_accuracy10: 0.5904 - val_accuracy20: 0.5578 - val_accuracy30: 0.5343 - val_accuracy50: 0.4851 - 37s/epoch - 25ms/step
Epoch 8/50
1504/1504 - 38s - loss: 11.5865 - accuracy10: 0.4674 - accuracy20: 0.4816 - accuracy30: 0.4884 - accuracy50: 0.4895 - val_loss: 12.4298 - val_accuracy10: 0.5878 - val_accuracy20: 0.5557 - val_accuracy30: 0.5323 - val_accuracy50: 0.4851 - 38s/epoch - 25ms/step
Epoch 9/50
1504/1504 - 38s - loss: 11.5394 - accuracy10: 0.4740 - accuracy20: 0.4873 - accuracy30: 0.4931 - accuracy50: 0.4926 - val_loss: 12.3560 - val_accuracy10: 0.6026 - val_accuracy20: 0.5683 - val_accuracy30: 0.5447 - val_accuracy50: 0.4940 - 38s/epoch - 25ms/step
Epoch 10/50
1504/1504 - 37s - loss: 11.4817 - accuracy10: 0.4820 - accuracy20: 0.4938 - accuracy30: 0.4974 - accuracy50: 0.4959 - val_loss: 12.4740 - val_accuracy10: 0.5961 - val_accuracy20: 0.5603 - val_accuracy30: 0.5349 - val_accuracy50: 0.4856 - 37s/epoch - 25ms/step
Epoch 11/50
1504/1504 - 38s - loss: 11.4229 - accuracy10: 0.4887 - accuracy20: 0.5001 - accuracy30: 0.5028 - accuracy50: 0.4994 - val_loss: 12.4629 - val_accuracy10: 0.6030 - val_accuracy20: 0.5667 - val_accuracy30: 0.5408 - val_accuracy50: 0.4904 - 38s/epoch - 25ms/step
Epoch 12/50
1504/1504 - 38s - loss: 11.3688 - accuracy10: 0.4961 - accuracy20: 0.5061 - accuracy30: 0.5076 - accuracy50: 0.5024 - val_loss: 12.3850 - val_accuracy10: 0.5965 - val_accuracy20: 0.5628 - val_accuracy30: 0.5392 - val_accuracy50: 0.4912 - 38s/epoch - 25ms/step
Epoch 13/50
1504/1504 - 37s - loss: 11.3053 - accuracy10: 0.5022 - accuracy20: 0.5121 - accuracy30: 0.5123 - accuracy50: 0.5060 - val_loss: 12.4186 - val_accuracy10: 0.6000 - val_accuracy20: 0.5658 - val_accuracy30: 0.5408 - val_accuracy50: 0.4937 - 37s/epoch - 25ms/step
Epoch 14/50
1504/1504 - 38s - loss: 11.2610 - accuracy10: 0.5069 - accuracy20: 0.5158 - accuracy30: 0.5154 - accuracy50: 0.5083 - val_loss: 12.4125 - val_accuracy10: 0.5859 - val_accuracy20: 0.5534 - val_accuracy30: 0.5317 - val_accuracy50: 0.4873 - 38s/epoch - 25ms/step
Epoch 15/50
1504/1504 - 37s - loss: 11.2137 - accuracy10: 0.5120 - accuracy20: 0.5204 - accuracy30: 0.5202 - accuracy50: 0.5120 - val_loss: 12.4609 - val_accuracy10: 0.5917 - val_accuracy20: 0.5584 - val_accuracy30: 0.5357 - val_accuracy50: 0.4907 - 37s/epoch - 25ms/step
Epoch 16/50
1504/1504 - 38s - loss: 11.1746 - accuracy10: 0.5158 - accuracy20: 0.5232 - accuracy30: 0.5224 - accuracy50: 0.5139 - val_loss: 12.3582 - val_accuracy10: 0.5854 - val_accuracy20: 0.5568 - val_accuracy30: 0.5354 - val_accuracy50: 0.4930 - 38s/epoch - 25ms/step
Epoch 17/50
1504/1504 - 38s - loss: 11.1292 - accuracy10: 0.5188 - accuracy20: 0.5258 - accuracy30: 0.5249 - accuracy50: 0.5160 - val_loss: 12.3018 - val_accuracy10: 0.5769 - val_accuracy20: 0.5527 - val_accuracy30: 0.5332 - val_accuracy50: 0.4929 - 38s/epoch - 25ms/step
Epoch 18/50
1504/1504 - 38s - loss: 11.0905 - accuracy10: 0.5209 - accuracy20: 0.5281 - accuracy30: 0.5264 - accuracy50: 0.5182 - val_loss: 12.2587 - val_accuracy10: 0.5771 - val_accuracy20: 0.5524 - val_accuracy30: 0.5339 - val_accuracy50: 0.4957 - 38s/epoch - 25ms/step
Epoch 19/50
1504/1504 - 38s - loss: 11.0486 - accuracy10: 0.5234 - accuracy20: 0.5307 - accuracy30: 0.5289 - accuracy50: 0.5197 - val_loss: 12.3779 - val_accuracy10: 0.5831 - val_accuracy20: 0.5544 - val_accuracy30: 0.5352 - val_accuracy50: 0.4950 - 38s/epoch - 25ms/step
Epoch 20/50
1504/1504 - 38s - loss: 11.0165 - accuracy10: 0.5252 - accuracy20: 0.5327 - accuracy30: 0.5318 - accuracy50: 0.5218 - val_loss: 12.2226 - val_accuracy10: 0.5866 - val_accuracy20: 0.5619 - val_accuracy30: 0.5419 - val_accuracy50: 0.5017 - 38s/epoch - 25ms/step
Epoch 21/50
1504/1504 - 38s - loss: 10.9803 - accuracy10: 0.5282 - accuracy20: 0.5358 - accuracy30: 0.5342 - accuracy50: 0.5245 - val_loss: 12.2731 - val_accuracy10: 0.5917 - val_accuracy20: 0.5640 - val_accuracy30: 0.5437 - val_accuracy50: 0.5025 - 38s/epoch - 25ms/step
Epoch 22/50
1504/1504 - 37s - loss: 10.9410 - accuracy10: 0.5316 - accuracy20: 0.5387 - accuracy30: 0.5368 - accuracy50: 0.5264 - val_loss: 12.2811 - val_accuracy10: 0.5889 - val_accuracy20: 0.5628 - val_accuracy30: 0.5431 - val_accuracy50: 0.5052 - 37s/epoch - 25ms/step
Epoch 23/50
1504/1504 - 38s - loss: 10.9115 - accuracy10: 0.5332 - accuracy20: 0.5406 - accuracy30: 0.5382 - accuracy50: 0.5280 - val_loss: 12.3278 - val_accuracy10: 0.5876 - val_accuracy20: 0.5607 - val_accuracy30: 0.5401 - val_accuracy50: 0.5017 - 38s/epoch - 25ms/step
Epoch 24/50
1504/1504 - 38s - loss: 10.8761 - accuracy10: 0.5352 - accuracy20: 0.5422 - accuracy30: 0.5400 - accuracy50: 0.5299 - val_loss: 12.3223 - val_accuracy10: 0.5846 - val_accuracy20: 0.5582 - val_accuracy30: 0.5391 - val_accuracy50: 0.5032 - 38s/epoch - 25ms/step
Epoch 25/50
1504/1504 - 38s - loss: 10.8586 - accuracy10: 0.5369 - accuracy20: 0.5438 - accuracy30: 0.5419 - accuracy50: 0.5315 - val_loss: 12.3079 - val_accuracy10: 0.5868 - val_accuracy20: 0.5605 - val_accuracy30: 0.5410 - val_accuracy50: 0.5031 - 38s/epoch - 25ms/step
Epoch 26/50
1504/1504 - 38s - loss: 10.8201 - accuracy10: 0.5389 - accuracy20: 0.5460 - accuracy30: 0.5435 - accuracy50: 0.5334 - val_loss: 12.3517 - val_accuracy10: 0.5832 - val_accuracy20: 0.5585 - val_accuracy30: 0.5400 - val_accuracy50: 0.5050 - 38s/epoch - 25ms/step
Epoch 27/50
1504/1504 - 37s - loss: 10.7862 - accuracy10: 0.5423 - accuracy20: 0.5486 - accuracy30: 0.5462 - accuracy50: 0.5349 - val_loss: 12.2930 - val_accuracy10: 0.5643 - val_accuracy20: 0.5449 - val_accuracy30: 0.5285 - val_accuracy50: 0.4979 - 37s/epoch - 25ms/step
Epoch 28/50
1504/1504 - 37s - loss: 10.7595 - accuracy10: 0.5426 - accuracy20: 0.5495 - accuracy30: 0.5471 - accuracy50: 0.5366 - val_loss: 12.2744 - val_accuracy10: 0.5744 - val_accuracy20: 0.5534 - val_accuracy30: 0.5362 - val_accuracy50: 0.5031 - 37s/epoch - 25ms/step
Epoch 29/50
1504/1504 - 38s - loss: 10.7321 - accuracy10: 0.5444 - accuracy20: 0.5504 - accuracy30: 0.5477 - accuracy50: 0.5375 - val_loss: 12.3308 - val_accuracy10: 0.5671 - val_accuracy20: 0.5452 - val_accuracy30: 0.5286 - val_accuracy50: 0.4978 - 38s/epoch - 25ms/step
Epoch 30/50
1504/1504 - 37s - loss: 10.6933 - accuracy10: 0.5482 - accuracy20: 0.5534 - accuracy30: 0.5508 - accuracy50: 0.5401 - val_loss: 12.4392 - val_accuracy10: 0.5706 - val_accuracy20: 0.5474 - val_accuracy30: 0.5308 - val_accuracy50: 0.4978 - 37s/epoch - 25ms/step
testing model: results/EXC/W6/deepOF_L1/seq2seq
Evaluating performance on  test set...
4450/4450 - 58s - 58s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9113533
{'0': {'precision': 0.28560949488725557, 'recall': 0.6074353734067615, 'f1-score': 0.3885343644754896, 'support': 192297}, '1': {'precision': 0.7460362624948017, 'recall': 0.5861283512436706, 'f1-score': 0.6564849418675714, 'support': 755988}, '2': {'precision': 0.36797585743551336, 'recall': 0.2626145647195686, 'f1-score': 0.30649314113423565, 'support': 190831}, 'accuracy': 0.5355284273067887, 'macro avg': {'precision': 0.46654053827252356, 'recall': 0.4853927631233335, 'f1-score': 0.45050414915909887, 'support': 1139116}, 'weighted avg': {'precision': 0.6049757109017265, 'recall': 0.5355284273067888, 'f1-score': 0.5526189813275488, 'support': 1139116}}
[[116808  61667  13822]
 [240628 443106  72254]
 [ 51542  89174  50115]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.949156
{'0': {'precision': 0.3550922429731758, 'recall': 0.6059260755402949, 'f1-score': 0.4477742933607178, 'support': 247550}, '1': {'precision': 0.665051778894258, 'recall': 0.5785715831820726, 'f1-score': 0.618804812367762, 'support': 646786}, '2': {'precision': 0.43611136360685115, 'recall': 0.2744055886918866, 'f1-score': 0.33685725605444355, 'support': 244780}, 'accuracy': 0.5191552045621342, 'macro avg': {'precision': 0.48541846182476167, 'recall': 0.486301082471418, 'f1-score': 0.46781212059430777, 'support': 1139116}, 'weighted avg': {'precision': 0.5484960304267488, 'recall': 0.5191552045621342, 'f1-score': 0.5210503011375028, 'support': 1139116}}
[[149997  78090  19463]
 [205188 374212  67386]
 [ 67232 110379  67169]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.97677433
{'0': {'precision': 0.3984044239038397, 'recall': 0.5893654392520749, 'f1-score': 0.4754261231332857, 'support': 285804}, '1': {'precision': 0.5966588904083876, 'recall': 0.5850344428669085, 'f1-score': 0.590789491151911, 'support': 570510}, '2': {'precision': 0.4778655043427836, 'recall': 0.26516785595575704, 'f1-score': 0.3410737067603001, 'support': 282802}, 'accuracy': 0.5067095888390647, 'macro avg': {'precision': 0.4909762728850036, 'recall': 0.4798559126915802, 'f1-score': 0.4690964403484989, 'support': 1139116}, 'weighted avg': {'precision': 0.5174247064350339, 'recall': 0.5067095888390647, 'f1-score': 0.49984929253235727, 'support': 1139116}}
[[168443  94799  22562]
 [177367 333768  59375]
 [ 76984 130828  74990]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0249248
{'0': {'precision': 0.45018030078271043, 'recall': 0.5473158830049911, 'f1-score': 0.49401858942205507, 'support': 341006}, '1': {'precision': 0.4837409350072903, 'recall': 0.603666900721076, 'f1-score': 0.5370908345389418, 'support': 460007}, '2': {'precision': 0.5263486662856687, 'recall': 0.23426588938873658, 'f1-score': 0.32422608143925824, 'support': 338103}, 'accuracy': 0.477155092194298, 'macro avg': {'precision': 0.4867566340252232, 'recall': 0.4617495577049346, 'f1-score': 0.45177850180008505, 'support': 1139116}, 'weighted avg': {'precision': 0.48634069142720404, 'recall': 0.477155092194298, 'f1-score': 0.46101596100930003, 'support': 1139116}}
[[186638 127862  26506]
 [137546 277691  44770]
 [ 90401 168496  79206]]
Evaluating performance on  train set...
1504/1504 - 20s - 20s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.83109224
{'0': {'precision': 0.27490022780603945, 'recall': 0.6066946397520224, 'f1-score': 0.378360856701675, 'support': 52908}, '1': {'precision': 0.8070185558227657, 'recall': 0.6527407928452997, 'f1-score': 0.7217270880289515, 'support': 278642}, '2': {'precision': 0.36508271240451756, 'recall': 0.29250206502966136, 'f1-score': 0.32478685927500883, 'support': 53268}, 'accuracy': 0.5965443404414554, 'macro avg': {'precision': 0.4823338320111075, 'recall': 0.5173124992089946, 'f1-score': 0.47495826800187846, 'support': 384818}, 'weighted avg': {'precision': 0.6726840002512691, 'recall': 0.5965443404414554, 'f1-score': 0.6195722182662882, 'support': 384818}}
[[ 32099  17498   3311]
 [ 72975 181881  23786]
 [ 11692  25995  15581]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8761784
{'0': {'precision': 0.34409195781147, 'recall': 0.5949846833368954, 'f1-score': 0.43602286668928975, 'support': 70185}, '1': {'precision': 0.7318846309483388, 'recall': 0.6445353781120204, 'f1-score': 0.6854383607292909, 'support': 244134}, '2': {'precision': 0.44278904686242543, 'recall': 0.3043731116753429, 'f1-score': 0.3607599193006052, 'support': 70499}, 'accuracy': 0.5731800487503184, 'macro avg': {'precision': 0.5062552118740781, 'recall': 0.5146310577080863, 'f1-score': 0.49407371557306196, 'support': 384818}, 'weighted avg': {'precision': 0.6081945271938783, 'recall': 0.5731800487503184, 'f1-score': 0.5804673565364559, 'support': 384818}}
[[ 41759  23753   4673]
 [ 64451 157353  22330]
 [ 15150  33891  21458]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9143972
{'0': {'precision': 0.3877138822293015, 'recall': 0.5699491871145281, 'f1-score': 0.4614926044104784, 'support': 82853}, '1': {'precision': 0.6650152939631069, 'recall': 0.6471955256249287, 'f1-score': 0.6559844139376789, 'support': 219025}, '2': {'precision': 0.4881482372758994, 'recall': 0.29348926935133834, 'f1-score': 0.36657982320075905, 'support': 82940}, 'accuracy': 0.5543295791776892, 'macro avg': {'precision': 0.513625804489436, 'recall': 0.5035446606969317, 'f1-score': 0.4946856138496388, 'support': 384818}, 'weighted avg': {'precision': 0.5671908482562585, 'recall': 0.5543295791776892, 'f1-score': 0.551733971779367, 'support': 384818}}
[[ 47222  30233   5398]
 [ 57147 141752  20126]
 [ 17427  41171  24342]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9797185
{'0': {'precision': 0.4423312163815205, 'recall': 0.5152443785134291, 'f1-score': 0.47601186558349634, 'support': 102464}, '1': {'precision': 0.5486593110822295, 'recall': 0.6613869197093268, 'f1-score': 0.5997722772776052, 'support': 179996}, '2': {'precision': 0.5438683331270883, 'recall': 0.25762519783504956, 'f1-score': 0.34963273315478244, 'support': 102358}, 'accuracy': 0.515077257300854, 'macro avg': {'precision': 0.5116196201969462, 'recall': 0.47808549868593514, 'f1-score': 0.47513895867196126, 'support': 384818}, 'weighted avg': {'precision': 0.5190733852239126, 'recall': 0.515077257300854, 'f1-score': 0.5002842848210438, 'support': 384818}}
[[ 52794  43037   6633]
 [ 45466 119047  15483]
 [ 21094  54894  26370]]
Evaluating performance on  val set...
510/510 - 6s - 6s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.84118485
{'0': {'precision': 0.26535248041775455, 'recall': 0.5802455038538396, 'f1-score': 0.36416733852906924, 'support': 17515}, '1': {'precision': 0.8050636267232237, 'recall': 0.6385390163382888, 'f1-score': 0.7121967236183262, 'support': 95114}, '2': {'precision': 0.3265756365154135, 'recall': 0.3062856503746785, 'f1-score': 0.31610538770092056, 'support': 17882}, 'accuracy': 0.5851920527771606, 'macro avg': {'precision': 0.46566391455213063, 'recall': 0.5083567235222689, 'f1-score': 0.46415648328277204, 'support': 130511}, 'weighted avg': {'precision': 0.6670724767938204, 'recall': 0.5851920527771606, 'f1-score': 0.6112194883759835, 'support': 130511}}
[[10163  6163  1189]
 [24275 60734 10105]
 [ 3862  8543  5477]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8911325
{'0': {'precision': 0.3332080577269994, 'recall': 0.5681148276303986, 'f1-score': 0.4200502203060596, 'support': 23409}, '1': {'precision': 0.7277378589202337, 'recall': 0.626020659715959, 'f1-score': 0.673057902528266, 'support': 83157}, '2': {'precision': 0.4, 'recall': 0.31847984965546045, 'f1-score': 0.35461520576610095, 'support': 23945}, 'accuracy': 0.5592095685421152, 'macro avg': {'precision': 0.4869819722157443, 'recall': 0.5042051123339394, 'f1-score': 0.48257444286680884, 'support': 130511}, 'weighted avg': {'precision': 0.5968429064029944, 'recall': 0.5592095685421152, 'f1-score': 0.569252344321604, 'support': 130511}}
[[13299  8304  1806]
 [21466 52058  9633]
 [ 5147 11172  7626]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.93046814
{'0': {'precision': 0.37491889193910655, 'recall': 0.5432683614797671, 'f1-score': 0.4436602040665652, 'support': 27653}, '1': {'precision': 0.6599020590186144, 'recall': 0.6277436936997409, 'f1-score': 0.6434213061067232, 'support': 74489}, '2': {'precision': 0.44566438566030026, 'recall': 0.30762451972223204, 'f1-score': 0.363996579841922, 'support': 28369}, 'accuracy': 0.5402609741707596, 'macro avg': {'precision': 0.493495112206007, 'recall': 0.49287885830058004, 'f1-score': 0.4836926966717368, 'support': 130511}, 'weighted avg': {'precision': 0.5529505524425278, 'recall': 0.5402609741707596, 'f1-score': 0.5403572439654276, 'support': 130511}}
[[15023 10507  2123]
 [18997 46760  8732]
 [ 6050 13592  8727]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.99415827
{'0': {'precision': 0.42503958727077695, 'recall': 0.48949938231660683, 'f1-score': 0.45499781277340334, 'support': 33998}, '1': {'precision': 0.5432371892370234, 'recall': 0.6401094872672174, 'f1-score': 0.5877082102334348, 'support': 61377}, '2': {'precision': 0.4973469923824534, 'recall': 0.26943875227686703, 'f1-score': 0.3495228074061767, 'support': 35136}, 'accuracy': 0.5010841997992507, 'macro avg': {'precision': 0.4885412562967512, 'recall': 0.4663492072868971, 'f1-score': 0.4640762768043383, 'support': 130511}, 'weighted avg': {'precision': 0.5000923200050764, 'recall': 0.5010841997992507, 'f1-score': 0.4890133078375855, 'support': 130511}}
[[16642 14702  2654]
 [15175 39288  6914]
 [ 7337 18332  9467]]
training model: results/EXC/W6/deepLOB_L2/seq2seq
Epoch 1/50
1504/1504 - 85s - loss: 11.2132 - accuracy10: 0.4573 - accuracy20: 0.4798 - accuracy30: 0.4896 - accuracy50: 0.4941 - val_loss: 11.0299 - val_accuracy10: 0.6099 - val_accuracy20: 0.6044 - val_accuracy30: 0.5895 - val_accuracy50: 0.5496 - 85s/epoch - 57ms/step
Epoch 2/50
1504/1504 - 80s - loss: 10.1846 - accuracy10: 0.5683 - accuracy20: 0.5746 - accuracy30: 0.5663 - accuracy50: 0.5489 - val_loss: 10.2006 - val_accuracy10: 0.6756 - val_accuracy20: 0.6576 - val_accuracy30: 0.6310 - val_accuracy50: 0.5808 - 80s/epoch - 53ms/step
Epoch 3/50
1504/1504 - 80s - loss: 9.5684 - accuracy10: 0.6371 - accuracy20: 0.6267 - accuracy30: 0.6051 - accuracy50: 0.5732 - val_loss: 9.8920 - val_accuracy10: 0.6937 - val_accuracy20: 0.6758 - val_accuracy30: 0.6480 - val_accuracy50: 0.5929 - 80s/epoch - 53ms/step
Epoch 4/50
1504/1504 - 80s - loss: 9.3444 - accuracy10: 0.6465 - accuracy20: 0.6355 - accuracy30: 0.6127 - accuracy50: 0.5789 - val_loss: 9.7935 - val_accuracy10: 0.7000 - val_accuracy20: 0.6820 - val_accuracy30: 0.6532 - val_accuracy50: 0.5949 - 80s/epoch - 53ms/step
Epoch 5/50
1504/1504 - 79s - loss: 9.1935 - accuracy10: 0.6510 - accuracy20: 0.6394 - accuracy30: 0.6173 - accuracy50: 0.5840 - val_loss: 9.7062 - val_accuracy10: 0.7059 - val_accuracy20: 0.6872 - val_accuracy30: 0.6581 - val_accuracy50: 0.5979 - 79s/epoch - 52ms/step
Epoch 6/50
1504/1504 - 78s - loss: 9.1096 - accuracy10: 0.6552 - accuracy20: 0.6416 - accuracy30: 0.6197 - accuracy50: 0.5865 - val_loss: 9.6844 - val_accuracy10: 0.7095 - val_accuracy20: 0.6879 - val_accuracy30: 0.6574 - val_accuracy50: 0.5974 - 78s/epoch - 52ms/step
Epoch 7/50
1504/1504 - 77s - loss: 9.0432 - accuracy10: 0.6578 - accuracy20: 0.6440 - accuracy30: 0.6228 - accuracy50: 0.5898 - val_loss: 9.6000 - val_accuracy10: 0.7107 - val_accuracy20: 0.6879 - val_accuracy30: 0.6585 - val_accuracy50: 0.6002 - 77s/epoch - 51ms/step
Epoch 8/50
1504/1504 - 77s - loss: 8.9952 - accuracy10: 0.6608 - accuracy20: 0.6462 - accuracy30: 0.6242 - accuracy50: 0.5905 - val_loss: 9.5722 - val_accuracy10: 0.7140 - val_accuracy20: 0.6902 - val_accuracy30: 0.6600 - val_accuracy50: 0.6016 - 77s/epoch - 51ms/step
Epoch 9/50
1504/1504 - 77s - loss: 8.9577 - accuracy10: 0.6624 - accuracy20: 0.6473 - accuracy30: 0.6254 - accuracy50: 0.5914 - val_loss: 9.5266 - val_accuracy10: 0.7100 - val_accuracy20: 0.6864 - val_accuracy30: 0.6580 - val_accuracy50: 0.6017 - 77s/epoch - 51ms/step
Epoch 10/50
1504/1504 - 77s - loss: 8.9277 - accuracy10: 0.6629 - accuracy20: 0.6484 - accuracy30: 0.6264 - accuracy50: 0.5925 - val_loss: 9.5620 - val_accuracy10: 0.7105 - val_accuracy20: 0.6867 - val_accuracy30: 0.6579 - val_accuracy50: 0.6013 - 77s/epoch - 51ms/step
Epoch 11/50
1504/1504 - 77s - loss: 8.9001 - accuracy10: 0.6641 - accuracy20: 0.6496 - accuracy30: 0.6280 - accuracy50: 0.5941 - val_loss: 9.5675 - val_accuracy10: 0.7104 - val_accuracy20: 0.6869 - val_accuracy30: 0.6577 - val_accuracy50: 0.6007 - 77s/epoch - 51ms/step
Epoch 12/50
1504/1504 - 77s - loss: 8.8778 - accuracy10: 0.6658 - accuracy20: 0.6509 - accuracy30: 0.6291 - accuracy50: 0.5950 - val_loss: 9.5292 - val_accuracy10: 0.7100 - val_accuracy20: 0.6864 - val_accuracy30: 0.6582 - val_accuracy50: 0.6023 - 77s/epoch - 51ms/step
Epoch 13/50
1504/1504 - 78s - loss: 8.8494 - accuracy10: 0.6660 - accuracy20: 0.6512 - accuracy30: 0.6298 - accuracy50: 0.5964 - val_loss: 9.5719 - val_accuracy10: 0.7094 - val_accuracy20: 0.6854 - val_accuracy30: 0.6566 - val_accuracy50: 0.6006 - 78s/epoch - 52ms/step
Epoch 14/50
1504/1504 - 77s - loss: 8.8274 - accuracy10: 0.6673 - accuracy20: 0.6524 - accuracy30: 0.6308 - accuracy50: 0.5970 - val_loss: 9.5532 - val_accuracy10: 0.7046 - val_accuracy20: 0.6823 - val_accuracy30: 0.6527 - val_accuracy50: 0.5995 - 77s/epoch - 51ms/step
Epoch 15/50
1504/1504 - 77s - loss: 8.8039 - accuracy10: 0.6683 - accuracy20: 0.6537 - accuracy30: 0.6323 - accuracy50: 0.5979 - val_loss: 9.5760 - val_accuracy10: 0.7091 - val_accuracy20: 0.6847 - val_accuracy30: 0.6556 - val_accuracy50: 0.6005 - 77s/epoch - 51ms/step
Epoch 16/50
1504/1504 - 78s - loss: 8.7838 - accuracy10: 0.6687 - accuracy20: 0.6539 - accuracy30: 0.6327 - accuracy50: 0.5991 - val_loss: 9.5610 - val_accuracy10: 0.7072 - val_accuracy20: 0.6830 - val_accuracy30: 0.6542 - val_accuracy50: 0.6000 - 78s/epoch - 52ms/step
Epoch 17/50
1504/1504 - 77s - loss: 8.7619 - accuracy10: 0.6694 - accuracy20: 0.6557 - accuracy30: 0.6341 - accuracy50: 0.6001 - val_loss: 9.5793 - val_accuracy10: 0.7042 - val_accuracy20: 0.6809 - val_accuracy30: 0.6521 - val_accuracy50: 0.5993 - 77s/epoch - 51ms/step
Epoch 18/50
1504/1504 - 77s - loss: 8.7429 - accuracy10: 0.6697 - accuracy20: 0.6559 - accuracy30: 0.6341 - accuracy50: 0.6009 - val_loss: 9.6030 - val_accuracy10: 0.6996 - val_accuracy20: 0.6761 - val_accuracy30: 0.6479 - val_accuracy50: 0.5969 - 77s/epoch - 51ms/step
Epoch 19/50
1504/1504 - 78s - loss: 8.7227 - accuracy10: 0.6710 - accuracy20: 0.6564 - accuracy30: 0.6347 - accuracy50: 0.6010 - val_loss: 9.6320 - val_accuracy10: 0.7009 - val_accuracy20: 0.6771 - val_accuracy30: 0.6474 - val_accuracy50: 0.5952 - 78s/epoch - 52ms/step
testing model: results/EXC/W6/deepLOB_L2/seq2seq
Evaluating performance on  test set...
4450/4450 - 91s - 91s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7236411
{'0': {'precision': 0.40859082597762586, 'recall': 0.6193571536289463, 'f1-score': 0.4923666488906528, 'support': 192301}, '1': {'precision': 0.8594280941322382, 'recall': 0.7186251633623814, 'f1-score': 0.7827450076362275, 'support': 755988}, '2': {'precision': 0.467887438976853, 'recall': 0.528349543053576, 'f1-score': 0.4962837538516061, 'support': 190832}, 'accuracy': 0.6699911598504461, 'macro avg': {'precision': 0.5786354530289056, 'recall': 0.6221106200149679, 'f1-score': 0.5904651367928287, 'support': 1139121}, 'weighted avg': {'precision': 0.7177267789883574, 'recall': 0.6699911598504461, 'f1-score': 0.6857351002187014, 'support': 1139121}}
[[119103  33920  39278]
 [137328 543272  75388]
 [ 35066  54940 100826]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.76304674
{'0': {'precision': 0.4746463435739329, 'recall': 0.5982613894342245, 'f1-score': 0.5293327138210802, 'support': 247554}, '1': {'precision': 0.7792964512112482, 'recall': 0.7218817352261799, 'f1-score': 0.7494911390779505, 'support': 646786}, '2': {'precision': 0.5252696733213137, 'recall': 0.48917603898995426, 'f1-score': 0.5065807565225852, 'support': 244781}, 'accuracy': 0.6450113728041182, 'macro avg': {'precision': 0.5930708227021649, 'recall': 0.6031063878834529, 'f1-score': 0.5951348698072052, 'support': 1139121}, 'weighted avg': {'precision': 0.6585030662550198, 'recall': 0.6450113728041182, 'f1-score': 0.6494482593853418, 'support': 1139121}}
[[148102  55209  44243]
 [115906 466903  63977]
 [ 48018  77022 119741]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.81082267
{'0': {'precision': 0.5057391357608796, 'recall': 0.5777969825897106, 'f1-score': 0.5393720461575143, 'support': 285808}, '1': {'precision': 0.7078092243186582, 'recall': 0.7148884331562988, 'f1-score': 0.7113312160010324, 'support': 570510}, '2': {'precision': 0.5455653093601269, 'recall': 0.4559994059468959, 'f1-score': 0.49677759843444835, 'support': 282803}, 'accuracy': 0.6162189969283334, 'macro avg': {'precision': 0.5863712231465549, 'recall': 0.5828949405643017, 'f1-score': 0.582493620197665, 'support': 1139121}, 'weighted avg': {'precision': 0.616830027418119, 'recall': 0.6162189969283334, 'f1-score': 0.6149202876419566, 'support': 1139121}}
[[165139  73486  47183]
 [102425 407851  60234]
 [ 58966  94879 128958]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8882839
{'0': {'precision': 0.5320202374685618, 'recall': 0.5334727235938055, 'f1-score': 0.5327454905124687, 'support': 341009}, '1': {'precision': 0.5827645264749945, 'recall': 0.7086283469599376, 'f1-score': 0.6395628651170092, 'support': 460007}, '2': {'precision': 0.5642179267774774, 'recall': 0.39687079457564955, 'f1-score': 0.465974913530858, 'support': 338105}, 'accuracy': 0.5636600501614841, 'macro avg': {'precision': 0.5596675635736779, 'recall': 0.5463239550431309, 'f1-score': 0.5460944230534454, 'support': 1139121}, 'weighted avg': {'precision': 0.56206878182581, 'recall': 0.5636600501614841, 'f1-score': 0.5560628326643063, 'support': 1139121}}
[[181919 105608  53482]
 [ 83876 325974  50157]
 [ 76145 127776 134184]]
Evaluating performance on  train set...
1504/1504 - 31s - 31s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.68463504
{'0': {'precision': 0.37283942950588916, 'recall': 0.6820083682008368, 'f1-score': 0.48211620950634715, 'support': 52819}, '1': {'precision': 0.9016838749913381, 'recall': 0.7004493027195016, 'f1-score': 0.7884286403874623, 'support': 278654}, '2': {'precision': 0.4480734916917587, 'recall': 0.6025381471900424, 'f1-score': 0.5139508482435522, 'support': 53346}, 'accuracy': 0.6843451076999836, 'macro avg': {'precision': 0.5741989320629953, 'recall': 0.6616652727034603, 'f1-score': 0.5948318993791205, 'support': 384819}, 'weighted avg': {'precision': 0.7662141235663946, 'recall': 0.6843451076999836, 'f1-score': 0.708335379435122, 'support': 384819}}
[[ 36023   7647   9149]
 [ 53027 195183  30444]
 [  7568  13635  32143]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.71841097
{'0': {'precision': 0.4441395303894096, 'recall': 0.6551404666543138, 'f1-score': 0.529389745981837, 'support': 70159}, '1': {'precision': 0.8325655743660539, 'recall': 0.7040816326530612, 'f1-score': 0.7629521287811029, 'support': 244118}, '2': {'precision': 0.5214732119010737, 'recall': 0.5535709222874317, 'f1-score': 0.5370428946680786, 'support': 70542}, 'accuracy': 0.6675683892947074, 'macro avg': {'precision': 0.5993927722188458, 'recall': 0.6375976738649356, 'f1-score': 0.6097949231436729, 'support': 384819}, 'weighted avg': {'precision': 0.7047219381309355, 'recall': 0.6675683892947074, 'f1-score': 0.6789578550897969, 'support': 384819}}
[[ 45964  13806  10389]
 [ 46794 171879  25445]
 [ 10732  20760  39050]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.76802486
{'0': {'precision': 0.48042751050606136, 'recall': 0.6227684502959294, 'f1-score': 0.5424151407876534, 'support': 82790}, '1': {'precision': 0.7659174165803934, 'recall': 0.7026543257793343, 'f1-score': 0.7329232483871658, 'support': 219001}, '2': {'precision': 0.5551783569227555, 'recall': 0.5121163944693357, 'f1-score': 0.5327786688051324, 'support': 83028}, 'accuracy': 0.644357477151596, 'macro avg': {'precision': 0.6005077613364035, 'recall': 0.6125130568481998, 'f1-score': 0.6027056859933172, 'support': 384819}, 'weighted avg': {'precision': 0.6590283285438143, 'recall': 0.644357477151596, 'f1-score': 0.6487544043807609, 'support': 384819}}
[[ 51559  19956  11275]
 [ 42326 153882  22793]
 [ 13434  27074  42520]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.85072625
{'0': {'precision': 0.5183579852269239, 'recall': 0.5605640404671692, 'f1-score': 0.5386354892890319, 'support': 102404}, '1': {'precision': 0.6408822725754708, 'recall': 0.7035372668392343, 'f1-score': 0.6707497908127058, 'support': 180026}, '2': {'precision': 0.589096283894259, 'recall': 0.439861703893973, 'f1-score': 0.5036569000223663, 'support': 102389}, 'accuracy': 0.595334429952783, 'macro avg': {'precision': 0.5827788472322178, 'recall': 0.5679876704001255, 'f1-score': 0.571014060041368, 'support': 384819}, 'weighted avg': {'precision': 0.5944986669927912, 'recall': 0.595334429952783, 'f1-score': 0.5911344211756495, 'support': 384819}}
[[ 57404  31656  13344]
 [ 35301 126655  18070]
 [ 18037  39315  45037]]
Evaluating performance on  val set...
510/510 - 10s - 10s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6476758
{'0': {'precision': 0.3978936212492548, 'recall': 0.6849877416044244, 'f1-score': 0.5033834035153877, 'support': 17539}, '1': {'precision': 0.8930800166412426, 'recall': 0.7455586427549045, 'f1-score': 0.8126788920309517, 'support': 95016}, '2': {'precision': 0.4675652505239093, 'recall': 0.5467253285809757, 'f1-score': 0.5040562743889916, 'support': 17956}, 'accuracy': 0.7100627533311369, 'macro avg': {'precision': 0.5861796294714688, 'recall': 0.6590905709801015, 'f1-score': 0.6067061899784437, 'support': 130511}, 'weighted avg': {'precision': 0.7679900446911165, 'recall': 0.7100627533311369, 'f1-score': 0.7286525548221838, 'support': 130511}}
[[12014  2866  2659]
 [15656 70840  8520]
 [ 2524  5615  9817]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6925767
{'0': {'precision': 0.46860095389507156, 'recall': 0.6534083642409515, 'f1-score': 0.5457847413869847, 'support': 23457}, '1': {'precision': 0.8206363373848213, 'recall': 0.7526031321849458, 'f1-score': 0.7851487200095443, 'support': 83073}, '2': {'precision': 0.5465605773234029, 'recall': 0.4926817063508611, 'f1-score': 0.5182244835299794, 'support': 23981}, 'accuracy': 0.6870148876339925, 'macro avg': {'precision': 0.6119326228677653, 'recall': 0.6328977342589194, 'f1-score': 0.6163859816421694, 'support': 130511}, 'weighted avg': {'precision': 0.7070037332935805, 'recall': 0.6870148876339925, 'f1-score': 0.6930808409681928, 'support': 130511}}
[[15327  5109  3021]
 [13771 62521  6781]
 [ 3610  8556 11815]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7487573
{'0': {'precision': 0.5008758612635759, 'recall': 0.6200216841344416, 'f1-score': 0.5541164691062951, 'support': 27670}, '1': {'precision': 0.7519077815993122, 'recall': 0.7521199822606872, 'f1-score': 0.7520138669604886, 'support': 74411}, '2': {'precision': 0.5829019104778486, 'recall': 0.4475202251143159, 'f1-score': 0.5063175279065604, 'support': 28430}, 'accuracy': 0.6577606485277103, 'macro avg': {'precision': 0.6118951844469122, 'recall': 0.6065539638364816, 'f1-score': 0.6041492879911147, 'support': 130511}, 'weighted avg': {'precision': 0.6618702357091341, 'recall': 0.6577606485277103, 'f1-score': 0.6565355707407928, 'support': 130511}}
[[17156  7348  3166]
 [12507 55966  5938]
 [ 4589 11118 12723]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8399353
{'0': {'precision': 0.5337890843886586, 'recall': 0.5605672757230706, 'f1-score': 0.5468505575567962, 'support': 33987}, '1': {'precision': 0.6313087993029177, 'recall': 0.7554045908476288, 'f1-score': 0.687804082117005, 'support': 61383}, '2': {'precision': 0.6183902667290594, 'recall': 0.37605645826811984, 'f1-score': 0.46769655465307636, 'support': 35141}, 'accuracy': 0.6025239251863828, 'macro avg': {'precision': 0.5944960501402119, 'recall': 0.5640094416129398, 'f1-score': 0.5674503981089591, 'support': 130511}, 'weighted avg': {'precision': 0.602434813937938, 'recall': 0.6025239251863828, 'f1-score': 0.5918322018782686, 'support': 130511}}
[[19052 11372  3563]
 [10422 46369  4592]
 [ 6218 15708 13215]]
training model: results/EXC/W6/deepOF_L2/seq2seq
Epoch 1/50
1504/1504 - 58s - loss: 10.5354 - accuracy10: 0.5571 - accuracy20: 0.5618 - accuracy30: 0.5538 - accuracy50: 0.5345 - val_loss: 11.0765 - val_accuracy10: 0.6890 - val_accuracy20: 0.6651 - val_accuracy30: 0.6294 - val_accuracy50: 0.5612 - 58s/epoch - 38ms/step
Epoch 2/50
1504/1504 - 51s - loss: 9.5690 - accuracy10: 0.6234 - accuracy20: 0.6195 - accuracy30: 0.6023 - accuracy50: 0.5730 - val_loss: 10.6781 - val_accuracy10: 0.7019 - val_accuracy20: 0.6726 - val_accuracy30: 0.6377 - val_accuracy50: 0.5694 - 51s/epoch - 34ms/step
Epoch 3/50
1504/1504 - 50s - loss: 9.3971 - accuracy10: 0.6336 - accuracy20: 0.6252 - accuracy30: 0.6076 - accuracy50: 0.5785 - val_loss: 10.7376 - val_accuracy10: 0.7028 - val_accuracy20: 0.6716 - val_accuracy30: 0.6366 - val_accuracy50: 0.5691 - 50s/epoch - 33ms/step
Epoch 4/50
1504/1504 - 50s - loss: 9.3214 - accuracy10: 0.6355 - accuracy20: 0.6267 - accuracy30: 0.6095 - accuracy50: 0.5813 - val_loss: 10.7344 - val_accuracy10: 0.7010 - val_accuracy20: 0.6711 - val_accuracy30: 0.6366 - val_accuracy50: 0.5692 - 50s/epoch - 33ms/step
Epoch 5/50
1504/1504 - 50s - loss: 9.2610 - accuracy10: 0.6386 - accuracy20: 0.6293 - accuracy30: 0.6120 - accuracy50: 0.5832 - val_loss: 10.5644 - val_accuracy10: 0.6992 - val_accuracy20: 0.6684 - val_accuracy30: 0.6345 - val_accuracy50: 0.5688 - 50s/epoch - 33ms/step
Epoch 6/50
1504/1504 - 50s - loss: 9.2146 - accuracy10: 0.6403 - accuracy20: 0.6309 - accuracy30: 0.6141 - accuracy50: 0.5853 - val_loss: 10.4574 - val_accuracy10: 0.7002 - val_accuracy20: 0.6713 - val_accuracy30: 0.6379 - val_accuracy50: 0.5727 - 50s/epoch - 33ms/step
Epoch 7/50
1504/1504 - 51s - loss: 9.1741 - accuracy10: 0.6417 - accuracy20: 0.6331 - accuracy30: 0.6151 - accuracy50: 0.5863 - val_loss: 10.4850 - val_accuracy10: 0.7075 - val_accuracy20: 0.6760 - val_accuracy30: 0.6397 - val_accuracy50: 0.5735 - 51s/epoch - 34ms/step
Epoch 8/50
1504/1504 - 50s - loss: 9.1415 - accuracy10: 0.6427 - accuracy20: 0.6344 - accuracy30: 0.6164 - accuracy50: 0.5871 - val_loss: 10.4584 - val_accuracy10: 0.7031 - val_accuracy20: 0.6738 - val_accuracy30: 0.6385 - val_accuracy50: 0.5744 - 50s/epoch - 33ms/step
Epoch 9/50
1504/1504 - 50s - loss: 9.1100 - accuracy10: 0.6448 - accuracy20: 0.6364 - accuracy30: 0.6182 - accuracy50: 0.5884 - val_loss: 10.4440 - val_accuracy10: 0.6998 - val_accuracy20: 0.6717 - val_accuracy30: 0.6374 - val_accuracy50: 0.5731 - 50s/epoch - 33ms/step
Epoch 10/50
1504/1504 - 51s - loss: 9.0821 - accuracy10: 0.6461 - accuracy20: 0.6375 - accuracy30: 0.6190 - accuracy50: 0.5887 - val_loss: 10.5674 - val_accuracy10: 0.6966 - val_accuracy20: 0.6678 - val_accuracy30: 0.6321 - val_accuracy50: 0.5681 - 51s/epoch - 34ms/step
Epoch 11/50
1504/1504 - 50s - loss: 9.0532 - accuracy10: 0.6469 - accuracy20: 0.6390 - accuracy30: 0.6200 - accuracy50: 0.5893 - val_loss: 10.4209 - val_accuracy10: 0.7037 - val_accuracy20: 0.6747 - val_accuracy30: 0.6388 - val_accuracy50: 0.5742 - 50s/epoch - 33ms/step
Epoch 12/50
1504/1504 - 50s - loss: 9.0267 - accuracy10: 0.6473 - accuracy20: 0.6393 - accuracy30: 0.6203 - accuracy50: 0.5907 - val_loss: 10.3864 - val_accuracy10: 0.7098 - val_accuracy20: 0.6785 - val_accuracy30: 0.6420 - val_accuracy50: 0.5762 - 50s/epoch - 33ms/step
Epoch 13/50
1504/1504 - 50s - loss: 9.0036 - accuracy10: 0.6488 - accuracy20: 0.6403 - accuracy30: 0.6216 - accuracy50: 0.5911 - val_loss: 10.5561 - val_accuracy10: 0.7032 - val_accuracy20: 0.6733 - val_accuracy30: 0.6376 - val_accuracy50: 0.5728 - 50s/epoch - 33ms/step
Epoch 14/50
1504/1504 - 51s - loss: 8.9753 - accuracy10: 0.6506 - accuracy20: 0.6417 - accuracy30: 0.6227 - accuracy50: 0.5927 - val_loss: 10.3701 - val_accuracy10: 0.7025 - val_accuracy20: 0.6733 - val_accuracy30: 0.6376 - val_accuracy50: 0.5753 - 51s/epoch - 34ms/step
Epoch 15/50
1504/1504 - 50s - loss: 8.9524 - accuracy10: 0.6506 - accuracy20: 0.6422 - accuracy30: 0.6231 - accuracy50: 0.5936 - val_loss: 10.5582 - val_accuracy10: 0.7018 - val_accuracy20: 0.6731 - val_accuracy30: 0.6374 - val_accuracy50: 0.5743 - 50s/epoch - 33ms/step
Epoch 16/50
1504/1504 - 50s - loss: 8.9306 - accuracy10: 0.6519 - accuracy20: 0.6432 - accuracy30: 0.6246 - accuracy50: 0.5943 - val_loss: 10.4964 - val_accuracy10: 0.6924 - val_accuracy20: 0.6652 - val_accuracy30: 0.6317 - val_accuracy50: 0.5713 - 50s/epoch - 33ms/step
Epoch 17/50
1504/1504 - 50s - loss: 8.9117 - accuracy10: 0.6528 - accuracy20: 0.6448 - accuracy30: 0.6256 - accuracy50: 0.5950 - val_loss: 10.5135 - val_accuracy10: 0.6906 - val_accuracy20: 0.6642 - val_accuracy30: 0.6312 - val_accuracy50: 0.5715 - 50s/epoch - 34ms/step
Epoch 18/50
1504/1504 - 50s - loss: 8.8887 - accuracy10: 0.6529 - accuracy20: 0.6449 - accuracy30: 0.6259 - accuracy50: 0.5959 - val_loss: 10.5013 - val_accuracy10: 0.6969 - val_accuracy20: 0.6687 - val_accuracy30: 0.6335 - val_accuracy50: 0.5732 - 50s/epoch - 33ms/step
Epoch 19/50
1504/1504 - 50s - loss: 8.8610 - accuracy10: 0.6539 - accuracy20: 0.6454 - accuracy30: 0.6270 - accuracy50: 0.5973 - val_loss: 10.5570 - val_accuracy10: 0.6938 - val_accuracy20: 0.6654 - val_accuracy30: 0.6312 - val_accuracy50: 0.5714 - 50s/epoch - 33ms/step
Epoch 20/50
1504/1504 - 50s - loss: 8.8433 - accuracy10: 0.6553 - accuracy20: 0.6469 - accuracy30: 0.6280 - accuracy50: 0.5975 - val_loss: 10.5134 - val_accuracy10: 0.6969 - val_accuracy20: 0.6670 - val_accuracy30: 0.6318 - val_accuracy50: 0.5717 - 50s/epoch - 34ms/step
Epoch 21/50
1504/1504 - 51s - loss: 8.8196 - accuracy10: 0.6555 - accuracy20: 0.6475 - accuracy30: 0.6284 - accuracy50: 0.5983 - val_loss: 10.5066 - val_accuracy10: 0.6940 - val_accuracy20: 0.6660 - val_accuracy30: 0.6315 - val_accuracy50: 0.5722 - 51s/epoch - 34ms/step
Epoch 22/50
1504/1504 - 50s - loss: 8.7984 - accuracy10: 0.6566 - accuracy20: 0.6485 - accuracy30: 0.6295 - accuracy50: 0.5988 - val_loss: 10.4406 - val_accuracy10: 0.6957 - val_accuracy20: 0.6672 - val_accuracy30: 0.6328 - val_accuracy50: 0.5739 - 50s/epoch - 33ms/step
Epoch 23/50
1504/1504 - 51s - loss: 8.7728 - accuracy10: 0.6570 - accuracy20: 0.6495 - accuracy30: 0.6311 - accuracy50: 0.6008 - val_loss: 10.3760 - val_accuracy10: 0.6911 - val_accuracy20: 0.6644 - val_accuracy30: 0.6319 - val_accuracy50: 0.5741 - 51s/epoch - 34ms/step
Epoch 24/50
1504/1504 - 49s - loss: 8.7580 - accuracy10: 0.6574 - accuracy20: 0.6500 - accuracy30: 0.6313 - accuracy50: 0.6011 - val_loss: 10.4348 - val_accuracy10: 0.6939 - val_accuracy20: 0.6667 - val_accuracy30: 0.6342 - val_accuracy50: 0.5762 - 49s/epoch - 33ms/step
testing model: results/EXC/W6/deepOF_L2/seq2seq
Evaluating performance on  test set...
4450/4450 - 64s - 64s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.71496755
{'0': {'precision': 0.3963473018499911, 'recall': 0.6974419777739642, 'f1-score': 0.5054524692044313, 'support': 192297}, '1': {'precision': 0.8484762871956202, 'recall': 0.7349256866511109, 'f1-score': 0.787629456415956, 'support': 755988}, '2': {'precision': 0.5483240931737036, 'recall': 0.4192819824871221, 'f1-score': 0.47519836556278805, 'support': 190831}, 'accuracy': 0.6757195930879735, 'macro avg': {'precision': 0.5977158940731049, 'recall': 0.6172165489707324, 'f1-score': 0.5894267637277252, 'support': 1139116}, 'weighted avg': {'precision': 0.721868118376637, 'recall': 0.6757195930879735, 'f1-score': 0.6876542777612664, 'support': 1139116}}
[[134116  34258  23923]
 [158407 555595  41986]
 [ 45857  64962  80012]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7641344
{'0': {'precision': 0.4600300066681485, 'recall': 0.668850737224803, 'f1-score': 0.5451265083049368, 'support': 247550}, '1': {'precision': 0.7618306057345641, 'recall': 0.7488009944556623, 'f1-score': 0.7552596081122175, 'support': 646786}, '2': {'precision': 0.6124330879892941, 'recall': 0.35896315058419803, 'f1-score': 0.4526287050678425, 'support': 244780}, 'accuracy': 0.6476557260191236, 'macro avg': {'precision': 0.6114312334640022, 'recall': 0.5922049607548878, 'f1-score': 0.5843382738283323, 'support': 1139116}, 'weighted avg': {'precision': 0.6641405876042082, 'recall': 0.6476557260191236, 'f1-score': 0.6445628561532472, 'support': 1139116}}
[[165574  56001  25975]
 [132842 484314  29630]
 [ 61504  95409  87867]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8199003
{'0': {'precision': 0.4902191569248795, 'recall': 0.6441197463996305, 'f1-score': 0.5567292774906478, 'support': 285804}, '1': {'precision': 0.6864722747200473, 'recall': 0.7487265779740934, 'f1-score': 0.7162492307743901, 'support': 570510}, '2': {'precision': 0.635455433075323, 'recall': 0.3175861556848961, 'f1-score': 0.42351110482387894, 'support': 282802}, 'accuracy': 0.6154439056250637, 'macro avg': {'precision': 0.6040489549067499, 'recall': 0.5701441600195399, 'f1-score': 0.5654965376963056, 'support': 1139116}, 'weighted avg': {'precision': 0.6245667348723571, 'recall': 0.6154439056250637, 'f1-score': 0.6035492351432488, 'support': 1139116}}
[[184092  75452  26260]
 [118090 427156  25264]
 [ 73348 119640  89814]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9093099
{'0': {'precision': 0.5225032047546906, 'recall': 0.5916670087916341, 'f1-score': 0.5549383828118232, 'support': 341006}, '1': {'precision': 0.56062424969988, 'recall': 0.7512494375085597, 'f1-score': 0.6420872014544414, 'support': 460007}, '2': {'precision': 0.6443380129036038, 'recall': 0.26023134961831157, 'f1-score': 0.3707332077681848, 'support': 338103}, 'accuracy': 0.5577368766657654, 'macro avg': {'precision': 0.5758218224527248, 'recall': 0.5343825986395018, 'f1-score': 0.5225862640114832, 'support': 1139116}, 'weighted avg': {'precision': 0.5740595534159979, 'recall': 0.5577368766657654, 'f1-score': 0.5354572626445668, 'support': 1139116}}
[[201762 111087  28157]
 [ 94018 345580  20409]
 [ 90365 159753  87985]]
Evaluating performance on  train set...
1504/1504 - 24s - 24s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.64382726
{'0': {'precision': 0.38630594184576483, 'recall': 0.7219324109775459, 'f1-score': 0.5032974707312414, 'support': 52908}, '1': {'precision': 0.8748681869109602, 'recall': 0.7622325421149719, 'f1-score': 0.8146755911854394, 'support': 278642}, '2': {'precision': 0.5248870874348581, 'recall': 0.42543365622888035, 'f1-score': 0.4699563472724822, 'support': 53268}, 'accuracy': 0.7100707347369406, 'macro avg': {'precision': 0.5953537387305278, 'recall': 0.6365328697737994, 'f1-score': 0.5959764697297211, 'support': 384818}, 'weighted avg': {'precision': 0.7592508185217415, 'recall': 0.7100707347369406, 'f1-score': 0.7241473459324989, 'support': 384818}}
[[ 38196   9604   5108]
 [ 50847 212390  15405]
 [  9832  20774  22662]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6967636
{'0': {'precision': 0.45355435371498637, 'recall': 0.6798888651421244, 'f1-score': 0.5441235161978175, 'support': 70185}, '1': {'precision': 0.7986997831557417, 'recall': 0.7709536565984254, 'f1-score': 0.7845814913701289, 'support': 244134}, '2': {'precision': 0.5994858494858495, 'recall': 0.37377835146597826, 'f1-score': 0.4604604429688524, 'support': 70499}, 'accuracy': 0.6815819426326212, 'macro avg': {'precision': 0.6172466621188591, 'recall': 0.6082069577355094, 'f1-score': 0.5963884835122663, 'support': 384818}, 'weighted avg': {'precision': 0.6992542918453218, 'recall': 0.6815819426326212, 'f1-score': 0.6813463184345847, 'support': 384818}}
[[ 47718  16708   5759]
 [ 44072 188216  11846]
 [ 13419  30729  26351]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.76089364
{'0': {'precision': 0.4859803697785894, 'recall': 0.6424269489336536, 'f1-score': 0.5533584921352754, 'support': 82853}, '1': {'precision': 0.7297600533696061, 'recall': 0.7691359433854583, 'f1-score': 0.7489307974783715, 'support': 219025}, '2': {'precision': 0.6319910011248594, 'recall': 0.3387026766337111, 'f1-score': 0.44103932804772744, 'support': 82940}, 'accuracy': 0.6490834628317802, 'macro avg': {'precision': 0.615910474757685, 'recall': 0.5834218563176077, 'f1-score': 0.581109539220458, 'support': 384818}, 'weighted avg': {'precision': 0.6562010116466467, 'recall': 0.6490834628317802, 'f1-score': 0.6404632343987621, 'support': 384818}}
[[ 53227  23682   5944]
 [ 40151 168460  10414]
 [ 16147  38701  28092]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8627984
{'0': {'precision': 0.5220838254769319, 'recall': 0.5694292629606496, 'f1-score': 0.544729717113248, 'support': 102464}, '1': {'precision': 0.6066677722884626, 'recall': 0.7722782728505078, 'f1-score': 0.6795281672239495, 'support': 179996}, '2': {'precision': 0.6605964033689962, 'recall': 0.283514722835538, 'f1-score': 0.3967516132560429, 'support': 102358}, 'accuracy': 0.5882599046822135, 'macro avg': {'precision': 0.5964493337114635, 'recall': 0.5417407528822317, 'f1-score': 0.5403364991977467, 'support': 384818}, 'weighted avg': {'precision': 0.5984904450689577, 'recall': 0.5882599046822135, 'f1-score': 0.5684199786693863, 'support': 384818}}
[[ 58346  37481   6637]
 [ 32716 139007   8273]
 [ 20694  52644  29020]]
Evaluating performance on  val set...
510/510 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6646427
{'0': {'precision': 0.3769624060150376, 'recall': 0.7156151869825863, 'f1-score': 0.49380478676253325, 'support': 17515}, '1': {'precision': 0.8706721224153794, 'recall': 0.7561557709695733, 'f1-score': 0.8093834051699883, 'support': 95114}, '2': {'precision': 0.4889813740874667, 'recall': 0.40079409462028853, 'f1-score': 0.4405175328067857, 'support': 17882}, 'accuracy': 0.7020251166568335, 'macro avg': {'precision': 0.5788719675059611, 'recall': 0.6241883508574827, 'f1-score': 0.581235241579769, 'support': 130511}, 'weighted avg': {'precision': 0.7521172140601319, 'recall': 0.7020251166568335, 'f1-score': 0.7164914724516322, 'support': 130511}}
[[12534  3413  1568]
 [17271 71921  5922]
 [ 3445  7270  7167]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.71979606
{'0': {'precision': 0.4482582981974589, 'recall': 0.6767055406040412, 'f1-score': 0.5392864437938313, 'support': 23409}, '1': {'precision': 0.7924323515101613, 'recall': 0.7638442945272196, 'f1-score': 0.7778757485579926, 'support': 83157}, '2': {'precision': 0.5635697635697635, 'recall': 0.35339319273334724, 'f1-score': 0.43439425051334696, 'support': 23945}, 'accuracy': 0.6729087969596432, 'macro avg': {'precision': 0.6014201377591278, 'recall': 0.5979810092882026, 'f1-score': 0.5838521476217237, 'support': 130511}, 'weighted avg': {'precision': 0.6887101742053373, 'recall': 0.6729087969596432, 'f1-score': 0.6720624339262505, 'support': 130511}}
[[15841  5835  1733]
 [14818 63519  4820]
 [ 4680 10803  8462]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7830771
{'0': {'precision': 0.4779443838604144, 'recall': 0.6339637652334286, 'f1-score': 0.5450080052228249, 'support': 27653}, '1': {'precision': 0.7204103974133761, 'recall': 0.75976318651076, 'f1-score': 0.73956366344979, 'support': 74489}, '2': {'precision': 0.5879002160675703, 'recall': 0.3165074553209489, 'f1-score': 0.411484349938133, 'support': 28369}, 'accuracy': 0.6367585873987633, 'macro avg': {'precision': 0.5954183324471202, 'recall': 0.5700781356883792, 'f1-score': 0.5653520062035825, 'support': 130511}, 'weighted avg': {'precision': 0.6402325272922429, 'recall': 0.6367585873987633, 'f1-score': 0.6270265618877571, 'support': 130511}}
[[17531  8294  1828]
 [13429 56594  4466]
 [ 5720 13670  8979]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.88110465
{'0': {'precision': 0.5107538330494037, 'recall': 0.5643861403611977, 'f1-score': 0.536232289075818, 'support': 33998}, '1': {'precision': 0.5969706313111848, 'recall': 0.7570751258614791, 'f1-score': 0.667557375282836, 'support': 61377}, '2': {'precision': 0.6134392585236677, 'recall': 0.2637181238615665, 'f1-score': 0.3688620847514978, 'support': 35136}, 'accuracy': 0.5740588915876823, 'macro avg': {'precision': 0.5737212409614186, 'recall': 0.5283931300280811, 'f1-score': 0.5242172497033839, 'support': 130511}, 'weighted avg': {'precision': 0.5789448938517657, 'recall': 0.5740588915876823, 'f1-score': 0.552932952751591, 'support': 130511}}
[[19188 12780  2030]
 [11101 46467  3809]
 [ 7279 18591  9266]]
training model: results/EXC/W6/deepVOL_L2/seq2seq
Epoch 1/50
1504/1504 - 57s - loss: 10.2270 - accuracy10: 0.5844 - accuracy20: 0.5878 - accuracy30: 0.5754 - accuracy50: 0.5495 - val_loss: 10.2793 - val_accuracy10: 0.6735 - val_accuracy20: 0.6573 - val_accuracy30: 0.6300 - val_accuracy50: 0.5742 - 57s/epoch - 38ms/step
Epoch 2/50
1504/1504 - 51s - loss: 9.7003 - accuracy10: 0.6220 - accuracy20: 0.6209 - accuracy30: 0.6036 - accuracy50: 0.5697 - val_loss: 10.0065 - val_accuracy10: 0.7180 - val_accuracy20: 0.6947 - val_accuracy30: 0.6601 - val_accuracy50: 0.5949 - 51s/epoch - 34ms/step
Epoch 3/50
1504/1504 - 50s - loss: 9.4877 - accuracy10: 0.6394 - accuracy20: 0.6329 - accuracy30: 0.6120 - accuracy50: 0.5761 - val_loss: 10.0446 - val_accuracy10: 0.7252 - val_accuracy20: 0.6972 - val_accuracy30: 0.6607 - val_accuracy50: 0.5938 - 50s/epoch - 33ms/step
Epoch 4/50
1504/1504 - 51s - loss: 9.3490 - accuracy10: 0.6457 - accuracy20: 0.6371 - accuracy30: 0.6154 - accuracy50: 0.5786 - val_loss: 9.9455 - val_accuracy10: 0.7231 - val_accuracy20: 0.6988 - val_accuracy30: 0.6643 - val_accuracy50: 0.5965 - 51s/epoch - 34ms/step
Epoch 5/50
1504/1504 - 50s - loss: 9.2664 - accuracy10: 0.6497 - accuracy20: 0.6394 - accuracy30: 0.6175 - accuracy50: 0.5812 - val_loss: 9.9351 - val_accuracy10: 0.7168 - val_accuracy20: 0.6937 - val_accuracy30: 0.6597 - val_accuracy50: 0.5940 - 50s/epoch - 34ms/step
Epoch 6/50
1504/1504 - 49s - loss: 9.2106 - accuracy10: 0.6524 - accuracy20: 0.6421 - accuracy30: 0.6194 - accuracy50: 0.5830 - val_loss: 9.8763 - val_accuracy10: 0.7205 - val_accuracy20: 0.6961 - val_accuracy30: 0.6621 - val_accuracy50: 0.5968 - 49s/epoch - 32ms/step
Epoch 7/50
1504/1504 - 49s - loss: 9.1709 - accuracy10: 0.6545 - accuracy20: 0.6434 - accuracy30: 0.6205 - accuracy50: 0.5848 - val_loss: 9.9571 - val_accuracy10: 0.7257 - val_accuracy20: 0.7002 - val_accuracy30: 0.6639 - val_accuracy50: 0.5953 - 49s/epoch - 32ms/step
Epoch 8/50
1504/1504 - 49s - loss: 9.1319 - accuracy10: 0.6565 - accuracy20: 0.6439 - accuracy30: 0.6211 - accuracy50: 0.5856 - val_loss: 9.8623 - val_accuracy10: 0.7261 - val_accuracy20: 0.6996 - val_accuracy30: 0.6639 - val_accuracy50: 0.5967 - 49s/epoch - 33ms/step
Epoch 9/50
1504/1504 - 48s - loss: 9.1035 - accuracy10: 0.6578 - accuracy20: 0.6450 - accuracy30: 0.6221 - accuracy50: 0.5867 - val_loss: 9.8609 - val_accuracy10: 0.7231 - val_accuracy20: 0.6983 - val_accuracy30: 0.6635 - val_accuracy50: 0.5969 - 48s/epoch - 32ms/step
Epoch 10/50
1504/1504 - 49s - loss: 9.0756 - accuracy10: 0.6593 - accuracy20: 0.6461 - accuracy30: 0.6228 - accuracy50: 0.5876 - val_loss: 9.8569 - val_accuracy10: 0.7179 - val_accuracy20: 0.6947 - val_accuracy30: 0.6603 - val_accuracy50: 0.5962 - 49s/epoch - 32ms/step
Epoch 11/50
1504/1504 - 49s - loss: 9.0541 - accuracy10: 0.6596 - accuracy20: 0.6464 - accuracy30: 0.6228 - accuracy50: 0.5884 - val_loss: 9.8711 - val_accuracy10: 0.7212 - val_accuracy20: 0.6966 - val_accuracy30: 0.6625 - val_accuracy50: 0.5969 - 49s/epoch - 33ms/step
Epoch 12/50
1504/1504 - 49s - loss: 9.0343 - accuracy10: 0.6610 - accuracy20: 0.6467 - accuracy30: 0.6234 - accuracy50: 0.5892 - val_loss: 9.8374 - val_accuracy10: 0.7188 - val_accuracy20: 0.6943 - val_accuracy30: 0.6614 - val_accuracy50: 0.5974 - 49s/epoch - 33ms/step
Epoch 13/50
1504/1504 - 49s - loss: 9.0100 - accuracy10: 0.6627 - accuracy20: 0.6475 - accuracy30: 0.6246 - accuracy50: 0.5899 - val_loss: 9.8394 - val_accuracy10: 0.7184 - val_accuracy20: 0.6937 - val_accuracy30: 0.6596 - val_accuracy50: 0.5964 - 49s/epoch - 33ms/step
Epoch 14/50
1504/1504 - 49s - loss: 8.9927 - accuracy10: 0.6629 - accuracy20: 0.6481 - accuracy30: 0.6250 - accuracy50: 0.5907 - val_loss: 9.8563 - val_accuracy10: 0.7209 - val_accuracy20: 0.6959 - val_accuracy30: 0.6609 - val_accuracy50: 0.5955 - 49s/epoch - 33ms/step
Epoch 15/50
1504/1504 - 49s - loss: 8.9778 - accuracy10: 0.6631 - accuracy20: 0.6490 - accuracy30: 0.6258 - accuracy50: 0.5913 - val_loss: 9.8707 - val_accuracy10: 0.7179 - val_accuracy20: 0.6938 - val_accuracy30: 0.6597 - val_accuracy50: 0.5964 - 49s/epoch - 32ms/step
Epoch 16/50
1504/1504 - 48s - loss: 8.9593 - accuracy10: 0.6639 - accuracy20: 0.6485 - accuracy30: 0.6253 - accuracy50: 0.5915 - val_loss: 9.8802 - val_accuracy10: 0.7187 - val_accuracy20: 0.6945 - val_accuracy30: 0.6601 - val_accuracy50: 0.5957 - 48s/epoch - 32ms/step
Epoch 17/50
1504/1504 - 49s - loss: 8.9456 - accuracy10: 0.6641 - accuracy20: 0.6496 - accuracy30: 0.6268 - accuracy50: 0.5924 - val_loss: 9.8289 - val_accuracy10: 0.7146 - val_accuracy20: 0.6912 - val_accuracy30: 0.6578 - val_accuracy50: 0.5943 - 49s/epoch - 32ms/step
Epoch 18/50
1504/1504 - 48s - loss: 8.9243 - accuracy10: 0.6649 - accuracy20: 0.6505 - accuracy30: 0.6275 - accuracy50: 0.5937 - val_loss: 9.8577 - val_accuracy10: 0.7108 - val_accuracy20: 0.6887 - val_accuracy30: 0.6559 - val_accuracy50: 0.5934 - 48s/epoch - 32ms/step
Epoch 19/50
1504/1504 - 48s - loss: 8.9120 - accuracy10: 0.6657 - accuracy20: 0.6507 - accuracy30: 0.6278 - accuracy50: 0.5940 - val_loss: 9.8998 - val_accuracy10: 0.7180 - val_accuracy20: 0.6914 - val_accuracy30: 0.6564 - val_accuracy50: 0.5925 - 48s/epoch - 32ms/step
Epoch 20/50
1504/1504 - 48s - loss: 8.8960 - accuracy10: 0.6655 - accuracy20: 0.6508 - accuracy30: 0.6278 - accuracy50: 0.5944 - val_loss: 9.8583 - val_accuracy10: 0.7128 - val_accuracy20: 0.6883 - val_accuracy30: 0.6554 - val_accuracy50: 0.5928 - 48s/epoch - 32ms/step
Epoch 21/50
1504/1504 - 48s - loss: 8.8804 - accuracy10: 0.6657 - accuracy20: 0.6515 - accuracy30: 0.6289 - accuracy50: 0.5954 - val_loss: 9.8064 - val_accuracy10: 0.7019 - val_accuracy20: 0.6806 - val_accuracy30: 0.6488 - val_accuracy50: 0.5908 - 48s/epoch - 32ms/step
Epoch 22/50
1504/1504 - 48s - loss: 8.8707 - accuracy10: 0.6664 - accuracy20: 0.6521 - accuracy30: 0.6289 - accuracy50: 0.5953 - val_loss: 9.7697 - val_accuracy10: 0.7023 - val_accuracy20: 0.6791 - val_accuracy30: 0.6474 - val_accuracy50: 0.5897 - 48s/epoch - 32ms/step
Epoch 23/50
1504/1504 - 48s - loss: 8.8488 - accuracy10: 0.6674 - accuracy20: 0.6528 - accuracy30: 0.6300 - accuracy50: 0.5956 - val_loss: 9.8738 - val_accuracy10: 0.7116 - val_accuracy20: 0.6850 - val_accuracy30: 0.6505 - val_accuracy50: 0.5909 - 48s/epoch - 32ms/step
Epoch 24/50
1504/1504 - 48s - loss: 8.8324 - accuracy10: 0.6680 - accuracy20: 0.6535 - accuracy30: 0.6302 - accuracy50: 0.5965 - val_loss: 9.8576 - val_accuracy10: 0.7115 - val_accuracy20: 0.6838 - val_accuracy30: 0.6495 - val_accuracy50: 0.5892 - 48s/epoch - 32ms/step
Epoch 25/50
1504/1504 - 49s - loss: 8.8232 - accuracy10: 0.6680 - accuracy20: 0.6537 - accuracy30: 0.6302 - accuracy50: 0.5973 - val_loss: 9.8440 - val_accuracy10: 0.7071 - val_accuracy20: 0.6818 - val_accuracy30: 0.6489 - val_accuracy50: 0.5901 - 49s/epoch - 32ms/step
Epoch 26/50
1504/1504 - 49s - loss: 8.8086 - accuracy10: 0.6680 - accuracy20: 0.6542 - accuracy30: 0.6306 - accuracy50: 0.5972 - val_loss: 9.9847 - val_accuracy10: 0.7168 - val_accuracy20: 0.6877 - val_accuracy30: 0.6530 - val_accuracy50: 0.5899 - 49s/epoch - 32ms/step
Epoch 27/50
1504/1504 - 48s - loss: 8.7893 - accuracy10: 0.6692 - accuracy20: 0.6546 - accuracy30: 0.6317 - accuracy50: 0.5983 - val_loss: 9.9550 - val_accuracy10: 0.7067 - val_accuracy20: 0.6807 - val_accuracy30: 0.6471 - val_accuracy50: 0.5879 - 48s/epoch - 32ms/step
Epoch 28/50
1504/1504 - 49s - loss: 8.7740 - accuracy10: 0.6697 - accuracy20: 0.6549 - accuracy30: 0.6318 - accuracy50: 0.5987 - val_loss: 9.9634 - val_accuracy10: 0.7109 - val_accuracy20: 0.6837 - val_accuracy30: 0.6505 - val_accuracy50: 0.5888 - 49s/epoch - 32ms/step
Epoch 29/50
1504/1504 - 49s - loss: 8.7632 - accuracy10: 0.6699 - accuracy20: 0.6555 - accuracy30: 0.6329 - accuracy50: 0.5994 - val_loss: 10.0128 - val_accuracy10: 0.7176 - val_accuracy20: 0.6873 - val_accuracy30: 0.6523 - val_accuracy50: 0.5889 - 49s/epoch - 32ms/step
Epoch 30/50
1504/1504 - 49s - loss: 8.7491 - accuracy10: 0.6705 - accuracy20: 0.6553 - accuracy30: 0.6329 - accuracy50: 0.5995 - val_loss: 9.9640 - val_accuracy10: 0.7060 - val_accuracy20: 0.6774 - val_accuracy30: 0.6430 - val_accuracy50: 0.5847 - 49s/epoch - 32ms/step
Epoch 31/50
1504/1504 - 49s - loss: 8.7344 - accuracy10: 0.6705 - accuracy20: 0.6562 - accuracy30: 0.6336 - accuracy50: 0.5995 - val_loss: 10.0176 - val_accuracy10: 0.7116 - val_accuracy20: 0.6837 - val_accuracy30: 0.6497 - val_accuracy50: 0.5880 - 49s/epoch - 32ms/step
Epoch 32/50
1504/1504 - 49s - loss: 8.7190 - accuracy10: 0.6709 - accuracy20: 0.6576 - accuracy30: 0.6347 - accuracy50: 0.6012 - val_loss: 10.0085 - val_accuracy10: 0.7077 - val_accuracy20: 0.6790 - val_accuracy30: 0.6456 - val_accuracy50: 0.5847 - 49s/epoch - 32ms/step
testing model: results/EXC/W6/deepVOL_L2/seq2seq
Evaluating performance on  test set...
4450/4450 - 60s - 60s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7073936
{'0': {'precision': 0.41336922859202163, 'recall': 0.6531479295479483, 'f1-score': 0.506304570410442, 'support': 192301}, '1': {'precision': 0.8738912695208201, 'recall': 0.7100086244755208, 'f1-score': 0.7834716582348322, 'support': 755988}, '2': {'precision': 0.4835925413239964, 'recall': 0.5601890668231743, 'f1-score': 0.5190803369831751, 'support': 190832}, 'accuracy': 0.6753110512403863, 'macro avg': {'precision': 0.590284346478946, 'recall': 0.6411152069488811, 'f1-score': 0.6029521885428164, 'support': 1139121}, 'weighted avg': {'precision': 0.730763071645524, 'recall': 0.6753110512403863, 'f1-score': 0.6923892949276732, 'support': 1139121}}
[[125601  31641  35059]
 [140133 536758  79097]
 [ 38113  45817 106902]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7468905
{'0': {'precision': 0.47689215733824813, 'recall': 0.6355017491133248, 'f1-score': 0.5448893568531558, 'support': 247554}, '1': {'precision': 0.7918527421304316, 'recall': 0.7201841103548933, 'f1-score': 0.7543199250546343, 'support': 646786}, '2': {'precision': 0.5476048256450635, 'recall': 0.4943725207430315, 'f1-score': 0.5196289131690309, 'support': 244781}, 'accuracy': 0.6532572044585255, 'macro avg': {'precision': 0.6054499083712477, 'recall': 0.6166861267370832, 'f1-score': 0.6062793983589403, 'support': 1139121}, 'weighted avg': {'precision': 0.6709200213282963, 'recall': 0.6532572044585255, 'f1-score': 0.6583746519353443, 'support': 1139121}}
[[157321  53209  37024]
 [118032 465805  62949]
 [ 54535  69233 121013]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.799242
{'0': {'precision': 0.5016514083709126, 'recall': 0.6196432570117002, 'f1-score': 0.5544392962244068, 'support': 285808}, '1': {'precision': 0.7183190746021753, 'recall': 0.7139261362640444, 'f1-score': 0.716115868490617, 'support': 570510}, '2': {'precision': 0.5740637610239743, 'recall': 0.4446876447562437, 'f1-score': 0.5011606568221714, 'support': 282803}, 'accuracy': 0.6234280642706087, 'macro avg': {'precision': 0.5980114146656873, 'recall': 0.5927523460106628, 'f1-score': 0.5905719405123984, 'support': 1139121}, 'weighted avg': {'precision': 0.6281432392027043, 'recall': 0.6234280642706087, 'f1-score': 0.622185165350448, 'support': 1139121}}
[[177099  72367  36342]
 [106241 407302  56967]
 [ 69692  87352 125759]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8864022
{'0': {'precision': 0.5241002388567264, 'recall': 0.5694483136808706, 'f1-score': 0.5458340126264187, 'support': 341009}, '1': {'precision': 0.588872707035372, 'recall': 0.7084696537226608, 'f1-score': 0.6431585916863274, 'support': 460007}, '2': {'precision': 0.5948348778198109, 'recall': 0.37855991481936085, 'f1-score': 0.4626707321261064, 'support': 338105}, 'accuracy': 0.56893078083891, 'macro avg': {'precision': 0.5692692745706365, 'recall': 0.5521592940742974, 'f1-score': 0.5505544454796175, 'support': 1139121}, 'weighted avg': {'precision': 0.5712519671420164, 'recall': 0.56893078083891, 'f1-score': 0.5604523601821685, 'support': 1139121}}
[[194187 106371  40451]
 [ 87376 325901  46730]
 [ 88952 121160 127993]]
Evaluating performance on  train set...
1504/1504 - 20s - 20s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6332506
{'0': {'precision': 0.40612033195020747, 'recall': 0.6522652833260758, 'f1-score': 0.5005702828166886, 'support': 52819}, '1': {'precision': 0.892584229144486, 'recall': 0.7461403748017255, 'f1-score': 0.8128188588518148, 'support': 278654}, '2': {'precision': 0.4653323589506495, 'recall': 0.5848798410377535, 'f1-score': 0.5183019510452919, 'support': 53346}, 'accuracy': 0.7109004493021395, 'macro avg': {'precision': 0.588012306681781, 'recall': 0.6610951663885182, 'f1-score': 0.6105636975712652, 'support': 384819}, 'weighted avg': {'precision': 0.7665854742668292, 'recall': 0.7109004493021395, 'f1-score': 0.7291328753077433, 'support': 384819}}
[[ 34452   9803   8564]
 [ 43453 207915  27286]
 [  6927  15218  31201]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6837335
{'0': {'precision': 0.475508262338827, 'recall': 0.6197351729642668, 'f1-score': 0.5381254718498991, 'support': 70159}, '1': {'precision': 0.8180841962678453, 'recall': 0.7520993945550922, 'f1-score': 0.7837053352285581, 'support': 244118}, '2': {'precision': 0.53779440770391, 'recall': 0.5256726489183748, 'f1-score': 0.5316644443488608, 'support': 70542}, 'accuracy': 0.6864603878706613, 'macro avg': {'precision': 0.610462288770194, 'recall': 0.6325024054792446, 'f1-score': 0.6178317504757728, 'support': 384819}, 'weighted avg': {'precision': 0.7042462952977707, 'recall': 0.6864603878706613, 'f1-score': 0.6927298216514766, 'support': 384819}}
[[ 43480  17492   9187]
 [ 37834 183601  22683]
 [ 10125  23335  37082]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.74624485
{'0': {'precision': 0.5066278056673443, 'recall': 0.5899867133711801, 'f1-score': 0.545139005145032, 'support': 82790}, '1': {'precision': 0.7488788003851974, 'recall': 0.7456952251359583, 'f1-score': 0.7472836221117394, 'support': 219001}, '2': {'precision': 0.5691172498116212, 'recall': 0.48212651153827624, 'f1-score': 0.5220226257620709, 'support': 83028}, 'accuracy': 0.6553288688968061, 'macro avg': {'precision': 0.608207951954721, 'recall': 0.6059361500151382, 'f1-score': 0.6048150843396142, 'support': 384819}, 'weighted avg': {'precision': 0.6579757995621769, 'recall': 0.6553288688968061, 'f1-score': 0.6551922159088389, 'support': 384819}}
[[ 48845  24786   9159]
 [ 34545 163308  21148]
 [ 13022  29976  40030]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.84893435
{'0': {'precision': 0.5383320136710332, 'recall': 0.5245009960548416, 'f1-score': 0.5313265109285429, 'support': 102404}, '1': {'precision': 0.621417903156014, 'recall': 0.7418761734416139, 'f1-score': 0.6763252976966645, 'support': 180026}, '2': {'precision': 0.60212768991629, 'recall': 0.41237828282335015, 'f1-score': 0.48950797625672415, 'support': 102389}, 'accuracy': 0.5963608865466622, 'macro avg': {'precision': 0.5872925355811124, 'recall': 0.5595851507732685, 'f1-score': 0.5657199282939772, 'support': 384819}, 'weighted avg': {'precision': 0.5941753993549489, 'recall': 0.5963608865466622, 'f1-score': 0.5880331538962889, 'support': 384819}}
[[ 53711  38330  10363]
 [ 28932 133557  17537]
 [ 17130  43036  42223]]
Evaluating performance on  val set...
510/510 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.65357524
{'0': {'precision': 0.40038886188459133, 'recall': 0.6575061291977878, 'f1-score': 0.4977018191234544, 'support': 17539}, '1': {'precision': 0.8938356602638752, 'recall': 0.7351077713227246, 'f1-score': 0.8067383156520885, 'support': 95016}, '2': {'precision': 0.4375795637783247, 'recall': 0.5742927155268434, 'f1-score': 0.4967005442897741, 'support': 17956}, 'accuracy': 0.7025538077250193, 'macro avg': {'precision': 0.5772680286422637, 'recall': 0.655635538682452, 'f1-score': 0.6003802263551057, 'support': 130511}, 'weighted avg': {'precision': 0.7647500056809756, 'recall': 0.7025538077250193, 'f1-score': 0.7225520835705213, 'support': 130511}}
[[11532  3162  2845]
 [14760 69847 10409]
 [ 2510  5134 10312]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7035807
{'0': {'precision': 0.4711609762388368, 'recall': 0.6230123204160805, 'f1-score': 0.536549546572677, 'support': 23457}, '1': {'precision': 0.8177661745606828, 'recall': 0.7428045213246182, 'f1-score': 0.778484965085693, 'support': 83073}, '2': {'precision': 0.5148943251788983, 'recall': 0.5160752262207581, 'f1-score': 0.515484099381469, 'support': 23981}, 'accuracy': 0.679613212679391, 'macro avg': {'precision': 0.6012738253261394, 'recall': 0.6272973559871522, 'f1-score': 0.6101728703466129, 'support': 130511}, 'weighted avg': {'precision': 0.6998183543994694, 'recall': 0.679613212679391, 'f1-score': 0.6866758235381389, 'support': 130511}}
[[14614  5783  3060]
 [12766 61707  8600]
 [ 3637  7968 12376]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7636102
{'0': {'precision': 0.49931853287700273, 'recall': 0.5958077340079508, 'f1-score': 0.5433124062814112, 'support': 27670}, '1': {'precision': 0.7472212360379059, 'recall': 0.7354020238943167, 'f1-score': 0.7412645196247756, 'support': 74411}, '2': {'precision': 0.5497938994229183, 'recall': 0.46915230390432644, 'f1-score': 0.5062820269500854, 'support': 28430}, 'accuracy': 0.6478074645049077, 'macro avg': {'precision': 0.5987778894459423, 'recall': 0.6001206872688646, 'f1-score': 0.5969529842854241, 'support': 130511}, 'weighted avg': {'precision': 0.6516559045606642, 'recall': 0.6478074645049077, 'f1-score': 0.6481084849384093, 'support': 130511}}
[[16486  8165  3019]
 [11786 54722  7903]
 [ 4745 10347 13338]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.86015844
{'0': {'precision': 0.5272822512586212, 'recall': 0.5331156030246859, 'f1-score': 0.5301828822238478, 'support': 33987}, '1': {'precision': 0.623166483951097, 'recall': 0.7315706303048075, 'f1-score': 0.6730313839513204, 'support': 61383}, '2': {'precision': 0.5850043591979076, 'recall': 0.40098460487749354, 'f1-score': 0.47582224623488895, 'support': 35141}, 'accuracy': 0.5908773973075067, 'macro avg': {'precision': 0.578484364802542, 'recall': 0.5552236127356623, 'f1-score': 0.559678837470019, 'support': 130511}, 'weighted avg': {'precision': 0.5879213885762168, 'recall': 0.5908773973075067, 'f1-score': 0.5827315752248167, 'support': 130511}}
[[18119 12394  3474]
 [ 9955 44906  6522]
 [ 6289 14761 14091]]
training model: results/EXC/W6/deepVOL_L3/seq2seq
Epoch 1/50
1504/1504 - 74s - loss: 10.5058 - accuracy10: 0.5573 - accuracy20: 0.5647 - accuracy30: 0.5575 - accuracy50: 0.5380 - val_loss: 10.0962 - val_accuracy10: 0.6921 - val_accuracy20: 0.6715 - val_accuracy30: 0.6416 - val_accuracy50: 0.5845 - 74s/epoch - 49ms/step
Epoch 2/50
1504/1504 - 68s - loss: 9.6962 - accuracy10: 0.6258 - accuracy20: 0.6219 - accuracy30: 0.6040 - accuracy50: 0.5719 - val_loss: 10.0525 - val_accuracy10: 0.7104 - val_accuracy20: 0.6873 - val_accuracy30: 0.6539 - val_accuracy50: 0.5916 - 68s/epoch - 45ms/step
Epoch 3/50
1504/1504 - 68s - loss: 9.4523 - accuracy10: 0.6397 - accuracy20: 0.6322 - accuracy30: 0.6123 - accuracy50: 0.5777 - val_loss: 9.9235 - val_accuracy10: 0.7184 - val_accuracy20: 0.6918 - val_accuracy30: 0.6578 - val_accuracy50: 0.5933 - 68s/epoch - 45ms/step
Epoch 4/50
1504/1504 - 67s - loss: 9.3226 - accuracy10: 0.6455 - accuracy20: 0.6364 - accuracy30: 0.6151 - accuracy50: 0.5812 - val_loss: 9.9774 - val_accuracy10: 0.7327 - val_accuracy20: 0.7009 - val_accuracy30: 0.6643 - val_accuracy50: 0.5959 - 67s/epoch - 45ms/step
Epoch 5/50
1504/1504 - 67s - loss: 9.2303 - accuracy10: 0.6488 - accuracy20: 0.6383 - accuracy30: 0.6168 - accuracy50: 0.5830 - val_loss: 9.9956 - val_accuracy10: 0.7380 - val_accuracy20: 0.7036 - val_accuracy30: 0.6656 - val_accuracy50: 0.5950 - 67s/epoch - 44ms/step
Epoch 6/50
1504/1504 - 68s - loss: 9.1646 - accuracy10: 0.6518 - accuracy20: 0.6410 - accuracy30: 0.6185 - accuracy50: 0.5844 - val_loss: 9.9001 - val_accuracy10: 0.7319 - val_accuracy20: 0.7012 - val_accuracy30: 0.6647 - val_accuracy50: 0.5957 - 68s/epoch - 45ms/step
Epoch 7/50
1504/1504 - 67s - loss: 9.1195 - accuracy10: 0.6550 - accuracy20: 0.6430 - accuracy30: 0.6205 - accuracy50: 0.5861 - val_loss: 9.8037 - val_accuracy10: 0.7229 - val_accuracy20: 0.6957 - val_accuracy30: 0.6619 - val_accuracy50: 0.5976 - 67s/epoch - 45ms/step
Epoch 8/50
1504/1504 - 67s - loss: 9.0809 - accuracy10: 0.6567 - accuracy20: 0.6434 - accuracy30: 0.6211 - accuracy50: 0.5874 - val_loss: 9.8026 - val_accuracy10: 0.7234 - val_accuracy20: 0.6973 - val_accuracy30: 0.6637 - val_accuracy50: 0.5983 - 67s/epoch - 44ms/step
Epoch 9/50
1504/1504 - 67s - loss: 9.0504 - accuracy10: 0.6585 - accuracy20: 0.6451 - accuracy30: 0.6223 - accuracy50: 0.5885 - val_loss: 9.7705 - val_accuracy10: 0.7265 - val_accuracy20: 0.6998 - val_accuracy30: 0.6653 - val_accuracy50: 0.5993 - 67s/epoch - 44ms/step
Epoch 10/50
1504/1504 - 66s - loss: 9.0271 - accuracy10: 0.6597 - accuracy20: 0.6455 - accuracy30: 0.6233 - accuracy50: 0.5896 - val_loss: 9.7094 - val_accuracy10: 0.7168 - val_accuracy20: 0.6942 - val_accuracy30: 0.6630 - val_accuracy50: 0.5989 - 66s/epoch - 44ms/step
Epoch 11/50
1504/1504 - 66s - loss: 8.9980 - accuracy10: 0.6608 - accuracy20: 0.6465 - accuracy30: 0.6241 - accuracy50: 0.5905 - val_loss: 9.6688 - val_accuracy10: 0.7117 - val_accuracy20: 0.6906 - val_accuracy30: 0.6604 - val_accuracy50: 0.5992 - 66s/epoch - 44ms/step
Epoch 12/50
1504/1504 - 67s - loss: 8.9780 - accuracy10: 0.6615 - accuracy20: 0.6472 - accuracy30: 0.6248 - accuracy50: 0.5911 - val_loss: 9.7144 - val_accuracy10: 0.7206 - val_accuracy20: 0.6960 - val_accuracy30: 0.6631 - val_accuracy50: 0.5999 - 67s/epoch - 45ms/step
Epoch 13/50
1504/1504 - 67s - loss: 8.9591 - accuracy10: 0.6619 - accuracy20: 0.6476 - accuracy30: 0.6255 - accuracy50: 0.5916 - val_loss: 9.6801 - val_accuracy10: 0.7128 - val_accuracy20: 0.6918 - val_accuracy30: 0.6613 - val_accuracy50: 0.5996 - 67s/epoch - 44ms/step
Epoch 14/50
1504/1504 - 66s - loss: 8.9406 - accuracy10: 0.6629 - accuracy20: 0.6484 - accuracy30: 0.6255 - accuracy50: 0.5920 - val_loss: 9.6597 - val_accuracy10: 0.7053 - val_accuracy20: 0.6864 - val_accuracy30: 0.6570 - val_accuracy50: 0.5985 - 66s/epoch - 44ms/step
Epoch 15/50
1504/1504 - 65s - loss: 8.9231 - accuracy10: 0.6637 - accuracy20: 0.6494 - accuracy30: 0.6270 - accuracy50: 0.5928 - val_loss: 9.6341 - val_accuracy10: 0.7095 - val_accuracy20: 0.6892 - val_accuracy30: 0.6587 - val_accuracy50: 0.6000 - 65s/epoch - 43ms/step
Epoch 16/50
1504/1504 - 65s - loss: 8.9012 - accuracy10: 0.6646 - accuracy20: 0.6505 - accuracy30: 0.6271 - accuracy50: 0.5932 - val_loss: 9.6498 - val_accuracy10: 0.7060 - val_accuracy20: 0.6868 - val_accuracy30: 0.6570 - val_accuracy50: 0.5986 - 65s/epoch - 43ms/step
Epoch 17/50
1504/1504 - 66s - loss: 8.8924 - accuracy10: 0.6644 - accuracy20: 0.6503 - accuracy30: 0.6276 - accuracy50: 0.5937 - val_loss: 9.7050 - val_accuracy10: 0.7058 - val_accuracy20: 0.6861 - val_accuracy30: 0.6558 - val_accuracy50: 0.5975 - 66s/epoch - 44ms/step
Epoch 18/50
1504/1504 - 68s - loss: 8.8741 - accuracy10: 0.6652 - accuracy20: 0.6509 - accuracy30: 0.6281 - accuracy50: 0.5942 - val_loss: 9.7099 - val_accuracy10: 0.7103 - val_accuracy20: 0.6889 - val_accuracy30: 0.6581 - val_accuracy50: 0.5984 - 68s/epoch - 45ms/step
Epoch 19/50
1504/1504 - 68s - loss: 8.8557 - accuracy10: 0.6657 - accuracy20: 0.6518 - accuracy30: 0.6288 - accuracy50: 0.5949 - val_loss: 9.7149 - val_accuracy10: 0.7071 - val_accuracy20: 0.6871 - val_accuracy30: 0.6565 - val_accuracy50: 0.5983 - 68s/epoch - 45ms/step
Epoch 20/50
1504/1504 - 67s - loss: 8.8473 - accuracy10: 0.6653 - accuracy20: 0.6517 - accuracy30: 0.6295 - accuracy50: 0.5958 - val_loss: 9.7569 - val_accuracy10: 0.7094 - val_accuracy20: 0.6872 - val_accuracy30: 0.6562 - val_accuracy50: 0.5965 - 67s/epoch - 45ms/step
Epoch 21/50
1504/1504 - 65s - loss: 8.8346 - accuracy10: 0.6669 - accuracy20: 0.6523 - accuracy30: 0.6296 - accuracy50: 0.5964 - val_loss: 9.7627 - val_accuracy10: 0.7099 - val_accuracy20: 0.6872 - val_accuracy30: 0.6554 - val_accuracy50: 0.5957 - 65s/epoch - 43ms/step
Epoch 22/50
1504/1504 - 67s - loss: 8.8209 - accuracy10: 0.6677 - accuracy20: 0.6531 - accuracy30: 0.6305 - accuracy50: 0.5970 - val_loss: 9.7721 - val_accuracy10: 0.7122 - val_accuracy20: 0.6901 - val_accuracy30: 0.6578 - val_accuracy50: 0.5960 - 67s/epoch - 45ms/step
Epoch 23/50
1504/1504 - 66s - loss: 8.8109 - accuracy10: 0.6671 - accuracy20: 0.6531 - accuracy30: 0.6306 - accuracy50: 0.5973 - val_loss: 9.7094 - val_accuracy10: 0.7051 - val_accuracy20: 0.6822 - val_accuracy30: 0.6514 - val_accuracy50: 0.5941 - 66s/epoch - 44ms/step
Epoch 24/50
1504/1504 - 67s - loss: 8.7916 - accuracy10: 0.6680 - accuracy20: 0.6540 - accuracy30: 0.6317 - accuracy50: 0.5979 - val_loss: 9.7249 - val_accuracy10: 0.6960 - val_accuracy20: 0.6768 - val_accuracy30: 0.6479 - val_accuracy50: 0.5928 - 67s/epoch - 44ms/step
Epoch 25/50
1504/1504 - 66s - loss: 8.7800 - accuracy10: 0.6680 - accuracy20: 0.6545 - accuracy30: 0.6324 - accuracy50: 0.5985 - val_loss: 9.7874 - val_accuracy10: 0.7033 - val_accuracy20: 0.6814 - val_accuracy30: 0.6505 - val_accuracy50: 0.5933 - 66s/epoch - 44ms/step
testing model: results/EXC/W6/deepVOL_L3/seq2seq
Evaluating performance on  test set...
4450/4450 - 92s - 92s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6889278
{'0': {'precision': 0.43528322563579336, 'recall': 0.5990036453268573, 'f1-score': 0.5041855334831736, 'support': 192301}, '1': {'precision': 0.8784141667596902, 'recall': 0.7182230405773636, 'f1-score': 0.7902825899799943, 'support': 755988}, '2': {'precision': 0.4717320414404294, 'recall': 0.6337354322126268, 'f1-score': 0.5408631484794275, 'support': 190832}, 'accuracy': 0.6839431456359772, 'macro avg': {'precision': 0.5951431446119709, 'recall': 0.6503207060389493, 'f1-score': 0.6117770906475318, 'support': 1139121}, 'weighted avg': {'precision': 0.7354772123466018, 'recall': 0.6839431456359772, 'f1-score': 0.7002008858222875, 'support': 1139121}}
[[115189  34400  42712]
 [120301 542968  92719]
 [ 29140  40755 120937]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7282656
{'0': {'precision': 0.5053870216790339, 'recall': 0.561255322071144, 'f1-score': 0.5318580446108323, 'support': 247554}, '1': {'precision': 0.7938299197596453, 'recall': 0.7369547269112194, 'f1-score': 0.7643357450738917, 'support': 646786}, '2': {'precision': 0.5339349017080245, 'recall': 0.575322431071039, 'f1-score': 0.5538565607941228, 'support': 244781}, 'accuracy': 0.6640392021567507, 'macro avg': {'precision': 0.6110506143822346, 'recall': 0.6245108266844676, 'f1-score': 0.6166834501596156, 'support': 1139121}, 'weighted avg': {'precision': 0.6752976869194629, 'recall': 0.6640392021567507, 'f1-score': 0.6685846441218257, 'support': 1139121}}
[[138941  58069  50544]
 [ 97751 476652  72383]
 [ 38228  65725 140828]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.78160566
{'0': {'precision': 0.5365879562431408, 'recall': 0.5303210546940603, 'f1-score': 0.5334360999370026, 'support': 285808}, '1': {'precision': 0.717973387365458, 'recall': 0.7403516152214685, 'f1-score': 0.7289908025702407, 'support': 570510}, '2': {'precision': 0.559053357629146, 'recall': 0.5305000300562582, 'f1-score': 0.5444025531513421, 'support': 282803}, 'accuracy': 0.6355558364739128, 'macro avg': {'precision': 0.6045382337459149, 'recall': 0.6003908999905957, 'f1-score': 0.6022764852195285, 'support': 1139121}, 'weighted avg': {'precision': 0.6330092189691897, 'recall': 0.6355558364739128, 'f1-score': 0.6340990315023618, 'support': 1139121}}
[[151570  78947  55291]
 [ 85091 422378  63041]
 [ 45809  86967 150027]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8713224
{'0': {'precision': 0.5606712222126113, 'recall': 0.4752015342703565, 'f1-score': 0.5144103334105778, 'support': 341009}, '1': {'precision': 0.5875066356886294, 'recall': 0.7410082890042977, 'f1-score': 0.6553893807266467, 'support': 460007}, '2': {'precision': 0.5776250463134495, 'recall': 0.46110232028511855, 'f1-score': 0.5128280195064184, 'support': 338105}, 'accuracy': 0.5783564695936604, 'macro avg': {'precision': 0.5752676347382301, 'recall': 0.5591040478532576, 'f1-score': 0.5608759112145476, 'support': 1139121}, 'weighted avg': {'precision': 0.5765401691853004, 'recall': 0.5783564695936604, 'f1-score': 0.5708717280966182, 'support': 1139121}}
[[162048 116440  62521]
 [ 67660 340869  51478]
 [ 59317 122887 155901]]
Evaluating performance on  train set...
1504/1504 - 32s - 32s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.62105536
{'0': {'precision': 0.4249876963594525, 'recall': 0.6049148980480509, 'f1-score': 0.499234375, 'support': 52819}, '1': {'precision': 0.896118657807936, 'recall': 0.7497541754290267, 'f1-score': 0.8164284527984836, 'support': 278654}, '2': {'precision': 0.4487888413924729, 'recall': 0.6435534060660593, 'f1-score': 0.5288078679636176, 'support': 53346}, 'accuracy': 0.7151517986378011, 'macro avg': {'precision': 0.5899650651866204, 'recall': 0.6660741598477123, 'f1-score': 0.6148235652540337, 'support': 384819}, 'weighted avg': {'precision': 0.7694411220333336, 'recall': 0.7151517986378011, 'f1-score': 0.7330196769484376, 'support': 384819}}
[[ 31951  10750  10118]
 [ 37684 208922  32048]
 [  5546  13469  34331]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.67218363
{'0': {'precision': 0.4976636107372324, 'recall': 0.5586311093373623, 'f1-score': 0.5263878909161726, 'support': 70159}, '1': {'precision': 0.8195934873394302, 'recall': 0.7621355246233379, 'f1-score': 0.78982089564911, 'support': 244118}, '2': {'precision': 0.5195229000392102, 'recall': 0.5822630489637379, 'f1-score': 0.549106635562121, 'support': 70542}, 'accuracy': 0.6920604232119516, 'macro avg': {'precision': 0.6122599993719575, 'recall': 0.6343432276414794, 'f1-score': 0.6217718073758012, 'support': 384819}, 'weighted avg': {'precision': 0.7058936503202973, 'recall': 0.6920604232119516, 'f1-score': 0.6976667621107074, 'support': 384819}}
[[ 39193  19102  11864]
 [ 31944 186051  26123]
 [  7617  21851  41074]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7365077
{'0': {'precision': 0.5336667949211235, 'recall': 0.5193501630631718, 'f1-score': 0.5264111557979663, 'support': 82790}, '1': {'precision': 0.7477363185190811, 'recall': 0.7643298432427249, 'f1-score': 0.7559420316035242, 'support': 219001}, '2': {'precision': 0.5527497543196208, 'recall': 0.5351809028279616, 'f1-score': 0.543823470018419, 'support': 83028}, 'accuracy': 0.6621840397693461, 'macro avg': {'precision': 0.6113842892532751, 'recall': 0.6062869697112862, 'f1-score': 0.6087255524733032, 'support': 384819}, 'weighted avg': {'precision': 0.6596113550660611, 'recall': 0.6621840397693461, 'f1-score': 0.6607943358316672, 'support': 384819}}
[[ 42997  27113  12680]
 [ 28338 167389  23274]
 [  9234  29359  44435]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.84328234
{'0': {'precision': 0.567543265381536, 'recall': 0.449943361587438, 'f1-score': 0.5019472844233587, 'support': 102404}, '1': {'precision': 0.6197314133160747, 'recall': 0.7659393643140435, 'f1-score': 0.6851218809313233, 'support': 180026}, '2': {'precision': 0.5831073752711496, 'recall': 0.4620711209211927, 'f1-score': 0.5155809835172319, 'support': 102389}, 'accuracy': 0.6009994309012808, 'macro avg': {'precision': 0.59012735132292, 'recall': 0.5593179489408914, 'f1-score': 0.5675500496239714, 'support': 384819}, 'weighted avg': {'precision': 0.5960990725728413, 'recall': 0.6009994309012808, 'f1-score': 0.591267538172434, 'support': 384819}}
[[ 46076  41801  14527]
 [ 22839 137889  19298]
 [ 12270  42808  47311]]
Evaluating performance on  val set...
510/510 - 10s - 10s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6363247
{'0': {'precision': 0.4234872611464968, 'recall': 0.606534009920748, 'f1-score': 0.4987458683982279, 'support': 17539}, '1': {'precision': 0.8963471824380846, 'recall': 0.7442956975667256, 'f1-score': 0.8132755269846016, 'support': 95016}, '2': {'precision': 0.429245461065187, 'recall': 0.63332590777456, 'f1-score': 0.5116875520259174, 'support': 17956}, 'accuracy': 0.7105148225053827, 'macro avg': {'precision': 0.5830266348832561, 'recall': 0.6613852050873446, 'f1-score': 0.6079029824695823, 'support': 130511}, 'weighted avg': {'precision': 0.7685359736625416, 'recall': 0.7105148225053827, 'f1-score': 0.7295136267592985, 'support': 130511}}
[[10638  3542  3359]
 [12534 70720 11762]
 [ 1948  4636 11372]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6847427
{'0': {'precision': 0.5008586147681741, 'recall': 0.5595344673231871, 'f1-score': 0.5285731545245862, 'support': 23457}, '1': {'precision': 0.8194042066698712, 'recall': 0.7592358528041602, 'f1-score': 0.7881734001474575, 'support': 83073}, '2': {'precision': 0.5041524896645081, 'recall': 0.5746215754138693, 'f1-score': 0.5370853957984175, 'support': 23981}, 'accuracy': 0.6894208151037078, 'macro avg': {'precision': 0.6081384370341844, 'recall': 0.6311306318470722, 'f1-score': 0.6179439834901537, 'support': 130511}, 'weighted avg': {'precision': 0.7042248319448005, 'recall': 0.6894208151037078, 'f1-score': 0.695378276411757, 'support': 130511}}
[[13125  6340  3992]
 [10440 63072  9561]
 [ 2640  7561 13780]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.74646324
{'0': {'precision': 0.5338515639459559, 'recall': 0.5212143115287314, 'f1-score': 0.5274572551888086, 'support': 27670}, '1': {'precision': 0.7468765254561526, 'recall': 0.7607880555294244, 'f1-score': 0.7537681082232637, 'support': 74411}, '2': {'precision': 0.5381782735838839, 'recall': 0.5243404854027436, 'f1-score': 0.5311692707869372, 'support': 28430}, 'accuracy': 0.65848855652014, 'macro avg': {'precision': 0.6063021209953309, 'recall': 0.6021142841536331, 'f1-score': 0.6041315447330032, 'support': 130511}, 'weighted avg': {'precision': 0.6562505093677329, 'recall': 0.65848855652014, 'f1-score': 0.6572972647558308, 'support': 130511}}
[[14422  8955  4293]
 [ 9301 56611  8499]
 [ 3292 10231 14907]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8461973
{'0': {'precision': 0.5620108478031378, 'recall': 0.45426192367669993, 'f1-score': 0.5024244199290573, 'support': 33987}, '1': {'precision': 0.6227536154827733, 'recall': 0.7632569278138899, 'f1-score': 0.6858836877356074, 'support': 61383}, '2': {'precision': 0.5733961449942463, 'recall': 0.45374349050966106, 'f1-score': 0.5066005814230569, 'support': 35141}, 'accuracy': 0.5994513872393897, 'macro avg': {'precision': 0.5860535360933858, 'recall': 0.557087447333417, 'f1-score': 0.5649695630292405, 'support': 130511}, 'weighted avg': {'precision': 0.593645453599368, 'recall': 0.5994513872393897, 'f1-score': 0.5898349426193293, 'support': 130511}}
[[15439 13659  4889]
 [ 7558 46851  6974]
 [ 4474 14722 15945]]
training model: results/EXC/W7/deepLOB_L1/seq2seq
Epoch 1/50
1254/1254 - 44s - loss: 11.1274 - accuracy10: 0.4833 - accuracy20: 0.5027 - accuracy30: 0.5101 - accuracy50: 0.5072 - val_loss: 11.7425 - val_accuracy10: 0.5858 - val_accuracy20: 0.5725 - val_accuracy30: 0.5515 - val_accuracy50: 0.5095 - 44s/epoch - 35ms/step
Epoch 2/50
1254/1254 - 35s - loss: 10.3724 - accuracy10: 0.5657 - accuracy20: 0.5686 - accuracy30: 0.5594 - accuracy50: 0.5403 - val_loss: 11.0365 - val_accuracy10: 0.6256 - val_accuracy20: 0.6043 - val_accuracy30: 0.5761 - val_accuracy50: 0.5278 - 35s/epoch - 28ms/step
Epoch 3/50
1254/1254 - 35s - loss: 9.9845 - accuracy10: 0.6048 - accuracy20: 0.5962 - accuracy30: 0.5765 - accuracy50: 0.5490 - val_loss: 10.5578 - val_accuracy10: 0.6479 - val_accuracy20: 0.6189 - val_accuracy30: 0.5821 - val_accuracy50: 0.5280 - 35s/epoch - 28ms/step
Epoch 4/50
1254/1254 - 34s - loss: 9.7795 - accuracy10: 0.6173 - accuracy20: 0.6071 - accuracy30: 0.5852 - accuracy50: 0.5550 - val_loss: 10.4025 - val_accuracy10: 0.6639 - val_accuracy20: 0.6336 - val_accuracy30: 0.5954 - val_accuracy50: 0.5364 - 34s/epoch - 27ms/step
Epoch 5/50
1254/1254 - 34s - loss: 9.6627 - accuracy10: 0.6233 - accuracy20: 0.6136 - accuracy30: 0.5913 - accuracy50: 0.5591 - val_loss: 10.4307 - val_accuracy10: 0.6755 - val_accuracy20: 0.6421 - val_accuracy30: 0.6021 - val_accuracy50: 0.5387 - 34s/epoch - 27ms/step
Epoch 6/50
1254/1254 - 33s - loss: 9.5725 - accuracy10: 0.6284 - accuracy20: 0.6178 - accuracy30: 0.5953 - accuracy50: 0.5620 - val_loss: 10.4737 - val_accuracy10: 0.6775 - val_accuracy20: 0.6420 - val_accuracy30: 0.6007 - val_accuracy50: 0.5370 - 33s/epoch - 26ms/step
Epoch 7/50
1254/1254 - 33s - loss: 9.5049 - accuracy10: 0.6322 - accuracy20: 0.6211 - accuracy30: 0.5979 - accuracy50: 0.5644 - val_loss: 10.3743 - val_accuracy10: 0.6815 - val_accuracy20: 0.6458 - val_accuracy30: 0.6045 - val_accuracy50: 0.5401 - 33s/epoch - 26ms/step
Epoch 8/50
1254/1254 - 33s - loss: 9.4607 - accuracy10: 0.6345 - accuracy20: 0.6228 - accuracy30: 0.5994 - accuracy50: 0.5659 - val_loss: 10.3846 - val_accuracy10: 0.6732 - val_accuracy20: 0.6383 - val_accuracy30: 0.5995 - val_accuracy50: 0.5391 - 33s/epoch - 26ms/step
Epoch 9/50
1254/1254 - 33s - loss: 9.4235 - accuracy10: 0.6369 - accuracy20: 0.6244 - accuracy30: 0.6015 - accuracy50: 0.5681 - val_loss: 10.3785 - val_accuracy10: 0.6614 - val_accuracy20: 0.6296 - val_accuracy30: 0.5932 - val_accuracy50: 0.5341 - 33s/epoch - 26ms/step
Epoch 10/50
1254/1254 - 33s - loss: 9.3845 - accuracy10: 0.6385 - accuracy20: 0.6255 - accuracy30: 0.6025 - accuracy50: 0.5692 - val_loss: 10.3329 - val_accuracy10: 0.6572 - val_accuracy20: 0.6270 - val_accuracy30: 0.5905 - val_accuracy50: 0.5347 - 33s/epoch - 27ms/step
Epoch 11/50
1254/1254 - 33s - loss: 9.3539 - accuracy10: 0.6399 - accuracy20: 0.6265 - accuracy30: 0.6037 - accuracy50: 0.5699 - val_loss: 10.3478 - val_accuracy10: 0.6553 - val_accuracy20: 0.6235 - val_accuracy30: 0.5869 - val_accuracy50: 0.5305 - 33s/epoch - 27ms/step
Epoch 12/50
1254/1254 - 33s - loss: 9.3258 - accuracy10: 0.6404 - accuracy20: 0.6271 - accuracy30: 0.6046 - accuracy50: 0.5716 - val_loss: 10.2827 - val_accuracy10: 0.6610 - val_accuracy20: 0.6290 - val_accuracy30: 0.5927 - val_accuracy50: 0.5373 - 33s/epoch - 26ms/step
Epoch 13/50
1254/1254 - 33s - loss: 9.3036 - accuracy10: 0.6414 - accuracy20: 0.6271 - accuracy30: 0.6056 - accuracy50: 0.5722 - val_loss: 10.3188 - val_accuracy10: 0.6650 - val_accuracy20: 0.6318 - val_accuracy30: 0.5970 - val_accuracy50: 0.5380 - 33s/epoch - 26ms/step
Epoch 14/50
1254/1254 - 33s - loss: 9.2799 - accuracy10: 0.6421 - accuracy20: 0.6282 - accuracy30: 0.6067 - accuracy50: 0.5737 - val_loss: 10.3196 - val_accuracy10: 0.6579 - val_accuracy20: 0.6248 - val_accuracy30: 0.5905 - val_accuracy50: 0.5346 - 33s/epoch - 26ms/step
Epoch 15/50
1254/1254 - 33s - loss: 9.2574 - accuracy10: 0.6420 - accuracy20: 0.6281 - accuracy30: 0.6066 - accuracy50: 0.5738 - val_loss: 10.2068 - val_accuracy10: 0.6546 - val_accuracy20: 0.6249 - val_accuracy30: 0.5926 - val_accuracy50: 0.5387 - 33s/epoch - 27ms/step
Epoch 16/50
1254/1254 - 34s - loss: 9.2404 - accuracy10: 0.6425 - accuracy20: 0.6286 - accuracy30: 0.6073 - accuracy50: 0.5746 - val_loss: 10.2171 - val_accuracy10: 0.6507 - val_accuracy20: 0.6226 - val_accuracy30: 0.5915 - val_accuracy50: 0.5395 - 34s/epoch - 27ms/step
Epoch 17/50
1254/1254 - 33s - loss: 9.2205 - accuracy10: 0.6431 - accuracy20: 0.6297 - accuracy30: 0.6090 - accuracy50: 0.5767 - val_loss: 10.3320 - val_accuracy10: 0.6492 - val_accuracy20: 0.6173 - val_accuracy30: 0.5842 - val_accuracy50: 0.5329 - 33s/epoch - 26ms/step
Epoch 18/50
1254/1254 - 33s - loss: 9.2071 - accuracy10: 0.6437 - accuracy20: 0.6297 - accuracy30: 0.6089 - accuracy50: 0.5757 - val_loss: 10.2400 - val_accuracy10: 0.6523 - val_accuracy20: 0.6220 - val_accuracy30: 0.5888 - val_accuracy50: 0.5372 - 33s/epoch - 26ms/step
Epoch 19/50
1254/1254 - 33s - loss: 9.1865 - accuracy10: 0.6441 - accuracy20: 0.6298 - accuracy30: 0.6091 - accuracy50: 0.5771 - val_loss: 10.2655 - val_accuracy10: 0.6555 - val_accuracy20: 0.6229 - val_accuracy30: 0.5904 - val_accuracy50: 0.5383 - 33s/epoch - 26ms/step
Epoch 20/50
1254/1254 - 33s - loss: 9.1687 - accuracy10: 0.6457 - accuracy20: 0.6309 - accuracy30: 0.6101 - accuracy50: 0.5770 - val_loss: 10.2946 - val_accuracy10: 0.6507 - val_accuracy20: 0.6191 - val_accuracy30: 0.5885 - val_accuracy50: 0.5378 - 33s/epoch - 26ms/step
Epoch 21/50
1254/1254 - 33s - loss: 9.1537 - accuracy10: 0.6447 - accuracy20: 0.6308 - accuracy30: 0.6104 - accuracy50: 0.5779 - val_loss: 10.2701 - val_accuracy10: 0.6562 - val_accuracy20: 0.6245 - val_accuracy30: 0.5940 - val_accuracy50: 0.5413 - 33s/epoch - 26ms/step
Epoch 22/50
1254/1254 - 33s - loss: 9.1401 - accuracy10: 0.6465 - accuracy20: 0.6314 - accuracy30: 0.6108 - accuracy50: 0.5784 - val_loss: 10.2238 - val_accuracy10: 0.6405 - val_accuracy20: 0.6094 - val_accuracy30: 0.5800 - val_accuracy50: 0.5312 - 33s/epoch - 26ms/step
Epoch 23/50
1254/1254 - 33s - loss: 9.1190 - accuracy10: 0.6463 - accuracy20: 0.6320 - accuracy30: 0.6116 - accuracy50: 0.5807 - val_loss: 10.2824 - val_accuracy10: 0.6464 - val_accuracy20: 0.6145 - val_accuracy30: 0.5842 - val_accuracy50: 0.5349 - 33s/epoch - 26ms/step
Epoch 24/50
1254/1254 - 33s - loss: 9.1076 - accuracy10: 0.6472 - accuracy20: 0.6324 - accuracy30: 0.6122 - accuracy50: 0.5801 - val_loss: 10.2921 - val_accuracy10: 0.6445 - val_accuracy20: 0.6116 - val_accuracy30: 0.5813 - val_accuracy50: 0.5324 - 33s/epoch - 26ms/step
Epoch 25/50
1254/1254 - 33s - loss: 9.0928 - accuracy10: 0.6476 - accuracy20: 0.6320 - accuracy30: 0.6126 - accuracy50: 0.5808 - val_loss: 10.3122 - val_accuracy10: 0.6440 - val_accuracy20: 0.6097 - val_accuracy30: 0.5805 - val_accuracy50: 0.5320 - 33s/epoch - 27ms/step
testing model: results/EXC/W7/deepLOB_L1/seq2seq
Evaluating performance on  test set...
5929/5929 - 75s - 75s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7335709
{'0': {'precision': 0.2932604837074423, 'recall': 0.59785495461315, 'f1-score': 0.3935006075243569, 'support': 176593}, '1': {'precision': 0.8675222853032599, 'recall': 0.7238172236144608, 'f1-score': 0.7891811501606404, 'support': 1166387}, '2': {'precision': 0.3993014691925136, 'recall': 0.4217007554712961, 'f1-score': 0.41019555406986463, 'support': 174593}, 'accuracy': 0.6744018244921332, 'macro avg': {'precision': 0.520028079401072, 'recall': 0.581124311232969, 'f1-score': 0.5309591039182874, 'support': 1517573}, 'weighted avg': {'precision': 0.7468304363599579, 'recall': 0.6744018244921332, 'f1-score': 0.6995362722904845, 'support': 1517573}}
[[105577  49412  21604]
 [232979 844251  89157]
 [ 21455  79512  73626]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7802316
{'0': {'precision': 0.36153222394584683, 'recall': 0.6148045051603785, 'f1-score': 0.4553175834039004, 'support': 233510}, '1': {'precision': 0.8056462577634684, 'recall': 0.7044896188917243, 'f1-score': 0.7516799433312478, 'support': 1051381}, '2': {'precision': 0.4696654019999304, 'recall': 0.40593170077616664, 'f1-score': 0.4354790001590635, 'support': 232682}, 'accuracy': 0.6449132924742336, 'macro avg': {'precision': 0.5456146279030819, 'recall': 0.5750752749427566, 'f1-score': 0.5474921756314038, 'support': 1517573}, 'weighted avg': {'precision': 0.685795835070442, 'recall': 0.6449132924742336, 'f1-score': 0.6575969288562769, 'support': 1517573}}
[[143563  67526  22421]
 [226461 740687  84233]
 [ 27072 111157  94453]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8214976
{'0': {'precision': 0.40011389575023554, 'recall': 0.6182008443952002, 'f1-score': 0.4858041201912133, 'support': 276174}, '1': {'precision': 0.7506623841748853, 'recall': 0.6844641225288107, 'f1-score': 0.7160364855636104, 'support': 967348}, '2': {'precision': 0.5058038749964084, 'recall': 0.38542096179178326, 'f1-score': 0.43748200887596633, 'support': 274051}, 'accuracy': 0.6184025414263432, 'macro avg': {'precision': 0.5521933849738431, 'recall': 0.5626953095719314, 'f1-score': 0.5464408715435967, 'support': 1517573}, 'weighted avg': {'precision': 0.6426503824187524, 'recall': 0.6184025414263432, 'f1-score': 0.6238351046975289, 'support': 1517573}}
[[170731  82834  22609]
 [224641 662115  80592]
 [ 31334 137092 105625]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.88880974
{'0': {'precision': 0.44768743006340916, 'recall': 0.5963647813640158, 'f1-score': 0.5114399709649808, 'support': 346169}, '1': {'precision': 0.6490924836418345, 'recall': 0.6551146227571979, 'f1-score': 0.6520896496717149, 'support': 831772}, '2': {'precision': 0.5404697813341199, 'recall': 0.3452442643802704, 'f1-score': 0.4213416124071119, 'support': 339632}, 'accuracy': 0.5723645584100402, 'macro avg': {'precision': 0.5457498983464545, 'recall': 0.532241222833828, 'f1-score': 0.5282904110146026, 'support': 1517573}, 'weighted avg': {'precision': 0.5788408834734317, 'recall': 0.5723645584100402, 'f1-score': 0.5683651922515558, 'support': 1517573}}
[[206443 115087  24639]
 [211809 544906  75057]
 [ 42880 179496 117256]]
Evaluating performance on  train set...
1254/1254 - 17s - 17s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7224044
{'0': {'precision': 0.3131635836980714, 'recall': 0.7266370150728935, 'f1-score': 0.4376920958823573, 'support': 40470}, '1': {'precision': 0.8630813682542642, 'recall': 0.6950821312849511, 'f1-score': 0.7700250161114846, 'support': 239799}, '2': {'precision': 0.46398373744218246, 'recall': 0.38696282463942605, 'f1-score': 0.4219876209104793, 'support': 40699}, 'accuracy': 0.6599910271428927, 'macro avg': {'precision': 0.5467428964648394, 'recall': 0.6028939903324235, 'f1-score': 0.543234910968107, 'support': 320968}, 'weighted avg': {'precision': 0.7431377999938455, 'recall': 0.6599910271428927, 'f1-score': 0.6839906225614781, 'support': 320968}}
[[ 29407   7536   3527]
 [ 58452 166680  14667]
 [  6044  18906  15749]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7848922
{'0': {'precision': 0.3731579151477546, 'recall': 0.7073493466634811, 'f1-score': 0.4885723896748479, 'support': 54413}, '1': {'precision': 0.7862282674271924, 'recall': 0.6768191346716775, 'f1-score': 0.727432802041945, 'support': 211804}, '2': {'precision': 0.5433594410322872, 'recall': 0.35224927398586325, 'f1-score': 0.4274142611779046, 'support': 54751}, 'accuracy': 0.6266294459260736, 'macro avg': {'precision': 0.5675818745357447, 'recall': 0.5788059184403407, 'f1-score': 0.5478064842982325, 'support': 320968}, 'weighted avg': {'precision': 0.6747725827716239, 'recall': 0.6266294459260736, 'f1-score': 0.6357618979363084, 'support': 320968}}
[[ 38489  11873   4051]
 [ 56294 143353  12157]
 [  8361  27104  19286]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.84589
{'0': {'precision': 0.4037792500831543, 'recall': 0.6894349874902147, 'f1-score': 0.5092863460099326, 'support': 65149}, '1': {'precision': 0.7148049737165993, 'recall': 0.6535486483217735, 'f1-score': 0.6828056970978862, 'support': 190171}, '2': {'precision': 0.5820387672570074, 'recall': 0.3178923958079454, 'f1-score': 0.41119966897530125, 'support': 65648}, 'accuracy': 0.5921805289000772, 'macro avg': {'precision': 0.5668743303522538, 'recall': 0.5536253438733112, 'f1-score': 0.5344305706943734, 'support': 320968}, 'weighted avg': {'precision': 0.6245191795232387, 'recall': 0.5921805289000772, 'f1-score': 0.5920333935093025, 'support': 320968}}
[[ 44916  15793   4440]
 [ 55339 124286  10546]
 [ 10984  33795  20869]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9352299
{'0': {'precision': 0.44150799947110936, 'recall': 0.6525233279593532, 'f1-score': 0.52666548372469, 'support': 81876}, '1': {'precision': 0.5883595557753478, 'recall': 0.6178624094377124, 'f1-score': 0.6027501790399704, 'support': 155970}, '2': {'precision': 0.6114075589593299, 'recall': 0.266042684247251, 'f1-score': 0.37075722393139465, 'support': 83122}, 'accuracy': 0.5355923331920939, 'macro avg': {'precision': 0.5470917047352623, 'recall': 0.5121428072147722, 'f1-score': 0.500057628898685, 'support': 320968}, 'weighted avg': {'precision': 0.556867874662879, 'recall': 0.5355923331920939, 'f1-score': 0.5232617910132233, 'support': 320968}}
[[53426 23226  5224]
 [50771 96368  8831]
 [16811 44197 22114]]
Evaluating performance on  val set...
427/427 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7270277
{'0': {'precision': 0.2911283631622615, 'recall': 0.7585701050030883, 'f1-score': 0.4207708779443255, 'support': 12952}, '1': {'precision': 0.8853523407362723, 'recall': 0.6706792053489826, 'f1-score': 0.7632074116141745, 'support': 83156}, '2': {'precision': 0.4777866880513232, 'recall': 0.4547050293825841, 'f1-score': 0.4659601923904117, 'support': 13103}, 'accuracy': 0.6551904112223128, 'macro avg': {'precision': 0.5514224639832856, 'recall': 0.6279847799115517, 'f1-score': 0.5499794939829706, 'support': 109211}, 'weighted avg': {'precision': 0.7659804669811608, 'recall': 0.6551904112223128, 'f1-score': 0.6869324182748512, 'support': 109211}}
[[ 9825  1948  1179]
 [22052 55771  5333]
 [ 1871  5274  5958]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.78027946
{'0': {'precision': 0.350872439579495, 'recall': 0.7349602724177071, 'f1-score': 0.47498532863849774, 'support': 17620}, '1': {'precision': 0.8095326472076936, 'recall': 0.6498672662260266, 'f1-score': 0.7209658757945036, 'support': 73832}, '2': {'precision': 0.5554362004143328, 'recall': 0.4076243031702235, 'f1-score': 0.47018706157443496, 'support': 17759}, 'accuracy': 0.6242045215225572, 'macro avg': {'precision': 0.5719470957338405, 'recall': 0.597483947271319, 'f1-score': 0.5553794220024787, 'support': 109211}, 'weighted avg': {'precision': 0.6942137539001316, 'recall': 0.6242045215225572, 'f1-score': 0.6405000051164307, 'support': 109211}}
[[12950  3344  1326]
 [21383 47981  4468]
 [ 2575  7945  7239]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8378672
{'0': {'precision': 0.38426813275496824, 'recall': 0.7121424565339316, 'f1-score': 0.4991809723496266, 'support': 21396}, '1': {'precision': 0.735177725328743, 'recall': 0.6248849872543253, 'f1-score': 0.6755593242449939, 'support': 66297}, '2': {'precision': 0.599106602059358, 'recall': 0.36773863741983454, 'f1-score': 0.4557392155733456, 'support': 21518}, 'accuracy': 0.5913140617703345, 'macro avg': {'precision': 0.5728508200476897, 'recall': 0.5682553604026971, 'f1-score': 0.5434931707226553, 'support': 109211}, 'weighted avg': {'precision': 0.6396192186470065, 'recall': 0.5913140617703345, 'f1-score': 0.5976928060778697, 'support': 109211}}
[[15237  4707  1452]
 [21026 41428  3843]
 [ 3389 10216  7913]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.92540056
{'0': {'precision': 0.4269000396205747, 'recall': 0.6704612005856515, 'f1-score': 0.5216512167684794, 'support': 27320}, '1': {'precision': 0.6020952308914186, 'recall': 0.5866637186077792, 'f1-score': 0.5942793150109653, 'support': 54273}, '2': {'precision': 0.6376843987483236, 'recall': 0.3099065826634803, 'f1-score': 0.4171052631578947, 'support': 27618}, 'accuracy': 0.5376381500032048, 'macro avg': {'precision': 0.555559889753439, 'recall': 0.5223438339523038, 'f1-score': 0.5110119316457797, 'support': 109211}, 'weighted avg': {'precision': 0.5672687849505569, 'recall': 0.5376381500032048, 'f1-score': 0.5313058727014652, 'support': 109211}}
[[18317  7275  1728]
 [19298 31840  3135]
 [ 5292 13767  8559]]
training model: results/EXC/W7/deepOF_L1/seq2seq
Epoch 1/50
1254/1254 - 40s - loss: 12.3032 - accuracy10: 0.3665 - accuracy20: 0.3945 - accuracy30: 0.4095 - accuracy50: 0.4245 - val_loss: 12.2622 - val_accuracy10: 0.6005 - val_accuracy20: 0.5743 - val_accuracy30: 0.5458 - val_accuracy50: 0.4898 - 40s/epoch - 32ms/step
Epoch 2/50
1254/1254 - 32s - loss: 12.0019 - accuracy10: 0.3890 - accuracy20: 0.4157 - accuracy30: 0.4299 - accuracy50: 0.4434 - val_loss: 11.8268 - val_accuracy10: 0.5493 - val_accuracy20: 0.5406 - val_accuracy30: 0.5258 - val_accuracy50: 0.4865 - 32s/epoch - 25ms/step
Epoch 3/50
1254/1254 - 31s - loss: 11.8678 - accuracy10: 0.4011 - accuracy20: 0.4261 - accuracy30: 0.4411 - accuracy50: 0.4527 - val_loss: 11.7005 - val_accuracy10: 0.5300 - val_accuracy20: 0.5264 - val_accuracy30: 0.5179 - val_accuracy50: 0.4880 - 31s/epoch - 25ms/step
Epoch 4/50
1254/1254 - 31s - loss: 11.7868 - accuracy10: 0.4142 - accuracy20: 0.4343 - accuracy30: 0.4462 - accuracy50: 0.4567 - val_loss: 11.6535 - val_accuracy10: 0.5176 - val_accuracy20: 0.5138 - val_accuracy30: 0.5064 - val_accuracy50: 0.4820 - 31s/epoch - 25ms/step
Epoch 5/50
1254/1254 - 31s - loss: 11.7204 - accuracy10: 0.4228 - accuracy20: 0.4398 - accuracy30: 0.4508 - accuracy50: 0.4602 - val_loss: 11.5978 - val_accuracy10: 0.5479 - val_accuracy20: 0.5362 - val_accuracy30: 0.5246 - val_accuracy50: 0.4934 - 31s/epoch - 25ms/step
Epoch 6/50
1254/1254 - 31s - loss: 11.6573 - accuracy10: 0.4295 - accuracy20: 0.4441 - accuracy30: 0.4543 - accuracy50: 0.4635 - val_loss: 11.5648 - val_accuracy10: 0.5327 - val_accuracy20: 0.5249 - val_accuracy30: 0.5151 - val_accuracy50: 0.4876 - 31s/epoch - 25ms/step
Epoch 7/50
1254/1254 - 31s - loss: 11.6014 - accuracy10: 0.4359 - accuracy20: 0.4504 - accuracy30: 0.4598 - accuracy50: 0.4678 - val_loss: 11.5454 - val_accuracy10: 0.5345 - val_accuracy20: 0.5238 - val_accuracy30: 0.5144 - val_accuracy50: 0.4868 - 31s/epoch - 25ms/step
Epoch 8/50
1254/1254 - 31s - loss: 11.5569 - accuracy10: 0.4400 - accuracy20: 0.4536 - accuracy30: 0.4623 - accuracy50: 0.4697 - val_loss: 11.5271 - val_accuracy10: 0.5110 - val_accuracy20: 0.5021 - val_accuracy30: 0.4951 - val_accuracy50: 0.4782 - 31s/epoch - 25ms/step
Epoch 9/50
1254/1254 - 31s - loss: 11.5023 - accuracy10: 0.4461 - accuracy20: 0.4591 - accuracy30: 0.4653 - accuracy50: 0.4722 - val_loss: 11.5133 - val_accuracy10: 0.5255 - val_accuracy20: 0.5122 - val_accuracy30: 0.5034 - val_accuracy50: 0.4830 - 31s/epoch - 25ms/step
Epoch 10/50
1254/1254 - 31s - loss: 11.4490 - accuracy10: 0.4530 - accuracy20: 0.4649 - accuracy30: 0.4710 - accuracy50: 0.4764 - val_loss: 11.5278 - val_accuracy10: 0.5154 - val_accuracy20: 0.5031 - val_accuracy30: 0.4959 - val_accuracy50: 0.4810 - 31s/epoch - 25ms/step
Epoch 11/50
1254/1254 - 31s - loss: 11.4031 - accuracy10: 0.4595 - accuracy20: 0.4709 - accuracy30: 0.4759 - accuracy50: 0.4799 - val_loss: 11.5187 - val_accuracy10: 0.5241 - val_accuracy20: 0.5105 - val_accuracy30: 0.4998 - val_accuracy50: 0.4815 - 31s/epoch - 25ms/step
Epoch 12/50
1254/1254 - 31s - loss: 11.3531 - accuracy10: 0.4651 - accuracy20: 0.4763 - accuracy30: 0.4809 - accuracy50: 0.4837 - val_loss: 11.4942 - val_accuracy10: 0.5276 - val_accuracy20: 0.5140 - val_accuracy30: 0.5044 - val_accuracy50: 0.4862 - 31s/epoch - 25ms/step
Epoch 13/50
1254/1254 - 31s - loss: 11.3151 - accuracy10: 0.4705 - accuracy20: 0.4826 - accuracy30: 0.4859 - accuracy50: 0.4872 - val_loss: 11.4951 - val_accuracy10: 0.5244 - val_accuracy20: 0.5123 - val_accuracy30: 0.5005 - val_accuracy50: 0.4831 - 31s/epoch - 25ms/step
Epoch 14/50
1254/1254 - 31s - loss: 11.2714 - accuracy10: 0.4769 - accuracy20: 0.4870 - accuracy30: 0.4902 - accuracy50: 0.4910 - val_loss: 11.4995 - val_accuracy10: 0.5172 - val_accuracy20: 0.5062 - val_accuracy30: 0.4960 - val_accuracy50: 0.4803 - 31s/epoch - 25ms/step
Epoch 15/50
1254/1254 - 31s - loss: 11.2282 - accuracy10: 0.4834 - accuracy20: 0.4936 - accuracy30: 0.4952 - accuracy50: 0.4950 - val_loss: 11.4763 - val_accuracy10: 0.5308 - val_accuracy20: 0.5169 - val_accuracy30: 0.5058 - val_accuracy50: 0.4882 - 31s/epoch - 25ms/step
Epoch 16/50
1254/1254 - 31s - loss: 11.1977 - accuracy10: 0.4877 - accuracy20: 0.4973 - accuracy30: 0.4986 - accuracy50: 0.4972 - val_loss: 11.4399 - val_accuracy10: 0.5276 - val_accuracy20: 0.5159 - val_accuracy30: 0.5049 - val_accuracy50: 0.4865 - 31s/epoch - 25ms/step
Epoch 17/50
1254/1254 - 31s - loss: 11.1404 - accuracy10: 0.4908 - accuracy20: 0.5002 - accuracy30: 0.5018 - accuracy50: 0.5004 - val_loss: 11.3969 - val_accuracy10: 0.5258 - val_accuracy20: 0.5140 - val_accuracy30: 0.5043 - val_accuracy50: 0.4889 - 31s/epoch - 25ms/step
Epoch 18/50
1254/1254 - 32s - loss: 11.1004 - accuracy10: 0.4969 - accuracy20: 0.5056 - accuracy30: 0.5054 - accuracy50: 0.5032 - val_loss: 11.4056 - val_accuracy10: 0.5322 - val_accuracy20: 0.5179 - val_accuracy30: 0.5063 - val_accuracy50: 0.4883 - 32s/epoch - 25ms/step
Epoch 19/50
1254/1254 - 33s - loss: 11.0647 - accuracy10: 0.4997 - accuracy20: 0.5083 - accuracy30: 0.5083 - accuracy50: 0.5058 - val_loss: 11.4139 - val_accuracy10: 0.5360 - val_accuracy20: 0.5199 - val_accuracy30: 0.5076 - val_accuracy50: 0.4892 - 33s/epoch - 26ms/step
Epoch 20/50
1254/1254 - 32s - loss: 11.0242 - accuracy10: 0.5025 - accuracy20: 0.5113 - accuracy30: 0.5108 - accuracy50: 0.5081 - val_loss: 11.3549 - val_accuracy10: 0.5243 - val_accuracy20: 0.5119 - val_accuracy30: 0.5012 - val_accuracy50: 0.4865 - 32s/epoch - 25ms/step
Epoch 21/50
1254/1254 - 31s - loss: 10.9850 - accuracy10: 0.5065 - accuracy20: 0.5144 - accuracy30: 0.5133 - accuracy50: 0.5102 - val_loss: 11.3039 - val_accuracy10: 0.5320 - val_accuracy20: 0.5180 - val_accuracy30: 0.5068 - val_accuracy50: 0.4898 - 31s/epoch - 25ms/step
Epoch 22/50
1254/1254 - 31s - loss: 10.9539 - accuracy10: 0.5097 - accuracy20: 0.5179 - accuracy30: 0.5164 - accuracy50: 0.5121 - val_loss: 11.4186 - val_accuracy10: 0.5266 - val_accuracy20: 0.5122 - val_accuracy30: 0.5006 - val_accuracy50: 0.4845 - 31s/epoch - 24ms/step
Epoch 23/50
1254/1254 - 31s - loss: 10.9146 - accuracy10: 0.5146 - accuracy20: 0.5225 - accuracy30: 0.5203 - accuracy50: 0.5152 - val_loss: 11.3140 - val_accuracy10: 0.5329 - val_accuracy20: 0.5185 - val_accuracy30: 0.5053 - val_accuracy50: 0.4881 - 31s/epoch - 25ms/step
Epoch 24/50
1254/1254 - 31s - loss: 10.8795 - accuracy10: 0.5152 - accuracy20: 0.5229 - accuracy30: 0.5214 - accuracy50: 0.5156 - val_loss: 11.3912 - val_accuracy10: 0.5234 - val_accuracy20: 0.5112 - val_accuracy30: 0.5009 - val_accuracy50: 0.4850 - 31s/epoch - 25ms/step
Epoch 25/50
1254/1254 - 31s - loss: 10.8466 - accuracy10: 0.5175 - accuracy20: 0.5257 - accuracy30: 0.5240 - accuracy50: 0.5192 - val_loss: 11.3470 - val_accuracy10: 0.5267 - val_accuracy20: 0.5154 - val_accuracy30: 0.5046 - val_accuracy50: 0.4892 - 31s/epoch - 25ms/step
Epoch 26/50
1254/1254 - 31s - loss: 10.8175 - accuracy10: 0.5202 - accuracy20: 0.5278 - accuracy30: 0.5259 - accuracy50: 0.5212 - val_loss: 11.3913 - val_accuracy10: 0.5367 - val_accuracy20: 0.5229 - val_accuracy30: 0.5088 - val_accuracy50: 0.4900 - 31s/epoch - 25ms/step
Epoch 27/50
1254/1254 - 31s - loss: 10.7866 - accuracy10: 0.5215 - accuracy20: 0.5296 - accuracy30: 0.5277 - accuracy50: 0.5226 - val_loss: 11.3717 - val_accuracy10: 0.5295 - val_accuracy20: 0.5170 - val_accuracy30: 0.5040 - val_accuracy50: 0.4874 - 31s/epoch - 25ms/step
Epoch 28/50
1254/1254 - 31s - loss: 10.7501 - accuracy10: 0.5235 - accuracy20: 0.5313 - accuracy30: 0.5293 - accuracy50: 0.5240 - val_loss: 11.3523 - val_accuracy10: 0.5144 - val_accuracy20: 0.5032 - val_accuracy30: 0.4947 - val_accuracy50: 0.4827 - 31s/epoch - 25ms/step
Epoch 29/50
1254/1254 - 31s - loss: 10.7132 - accuracy10: 0.5270 - accuracy20: 0.5347 - accuracy30: 0.5319 - accuracy50: 0.5260 - val_loss: 11.3285 - val_accuracy10: 0.5114 - val_accuracy20: 0.5034 - val_accuracy30: 0.4954 - val_accuracy50: 0.4843 - 31s/epoch - 25ms/step
Epoch 30/50
1254/1254 - 31s - loss: 10.6814 - accuracy10: 0.5276 - accuracy20: 0.5354 - accuracy30: 0.5340 - accuracy50: 0.5279 - val_loss: 11.4361 - val_accuracy10: 0.5086 - val_accuracy20: 0.4999 - val_accuracy30: 0.4920 - val_accuracy50: 0.4822 - 31s/epoch - 24ms/step
Epoch 31/50
1254/1254 - 31s - loss: 10.6452 - accuracy10: 0.5305 - accuracy20: 0.5389 - accuracy30: 0.5364 - accuracy50: 0.5302 - val_loss: 11.4021 - val_accuracy10: 0.5347 - val_accuracy20: 0.5215 - val_accuracy30: 0.5091 - val_accuracy50: 0.4919 - 31s/epoch - 25ms/step
testing model: results/EXC/W7/deepOF_L1/seq2seq
Evaluating performance on  test set...
5928/5928 - 77s - 77s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9291829
{'0': {'precision': 0.2227338941766775, 'recall': 0.6389927063513636, 'f1-score': 0.3303259612710587, 'support': 176592}, '1': {'precision': 0.8777085519116223, 'recall': 0.4999108356924723, 'f1-score': 0.6370061566042157, 'support': 1166386}, '2': {'precision': 0.2696159183426183, 'recall': 0.5352769345323329, 'f1-score': 0.3586047055979463, 'support': 174590}, 'accuracy': 0.5201638410931174, 'macro avg': {'precision': 0.4566861214769727, 'recall': 0.558060158858723, 'f1-score': 0.4419789411577402, 'support': 1517568}, 'weighted avg': {'precision': 0.7315337659029942, 'recall': 0.5201638410931174, 'f1-score': 0.5692903254945341, 'support': 1517568}}
[[112841  33020  30731]
 [360863 583089 222434]
 [ 32914  48222  93454]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9424348
{'0': {'precision': 0.2876161487300575, 'recall': 0.6604056392072221, 'f1-score': 0.4007151079547964, 'support': 233508}, '1': {'precision': 0.8228080618539362, 'recall': 0.47461526755312067, 'f1-score': 0.6019889724044706, 'support': 1051380}, '2': {'precision': 0.3394720769401052, 'recall': 0.5470259583977995, 'f1-score': 0.41895194537384317, 'support': 232680}, 'accuracy': 0.5143051250421727, 'macro avg': {'precision': 0.48329876250803294, 'recall': 0.5606822883860474, 'f1-score': 0.47388534191103676, 'support': 1517568}, 'weighted avg': {'precision': 0.666351013326634, 'recall': 0.5143051250421727, 'f1-score': 0.5429549699812507, 'support': 1517568}}
[[154210  44139  35159]
 [339879 499001 212500]
 [ 42077  63321 127282]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.95166194
{'0': {'precision': 0.3297917025676374, 'recall': 0.6652484683458135, 'f1-score': 0.44097400571250267, 'support': 276172}, '1': {'precision': 0.7735470519040025, 'recall': 0.4547840640432027, 'f1-score': 0.5728046247892349, 'support': 967347}, '2': {'precision': 0.38134098433467684, 'recall': 0.5451324398191564, 'f1-score': 0.44875834702601053, 'support': 274049}, 'accuracy': 0.5094005672233468, 'macro avg': {'precision': 0.4948932462687723, 'recall': 0.5550549907360575, 'f1-score': 0.4875123258425827, 'support': 1517568}, 'weighted avg': {'precision': 0.6219647287736856, 'recall': 0.5094005672233468, 'f1-score': 0.526412842604586, 'support': 1517568}}
[[183723  53607  38842]
 [323891 439934 203522]
 [ 49474  75182 149393]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9650051
{'0': {'precision': 0.39166481863375946, 'recall': 0.6479521385693569, 'f1-score': 0.4882183867390326, 'support': 346166}, '1': {'precision': 0.6781040834899014, 'recall': 0.44433210062372863, 'f1-score': 0.5368740176467683, 'support': 831772}, '2': {'precision': 0.43604684604477034, 'recall': 0.513379265671466, 'f1-score': 0.47156362534871865, 'support': 339630}, 'accuracy': 0.5062316812162618, 'macro avg': {'precision': 0.5019385827228104, 'recall': 0.5352211682881839, 'f1-score': 0.49888534324483985, 'support': 1517568}, 'weighted avg': {'precision': 0.5585935020123787, 'recall': 0.5062316812162618, 'f1-score': 0.5111589962012754, 'support': 1517568}}
[[224299  74611  47256]
 [283941 369583 178248]
 [ 64441 100830 174359]]
Evaluating performance on  train set...
1254/1254 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9019978
{'0': {'precision': 0.24905807820044096, 'recall': 0.661379974801749, 'f1-score': 0.3618522423161138, 'support': 40479}, '1': {'precision': 0.8556631090097777, 'recall': 0.5103687356858885, 'f1-score': 0.6393755765125205, 'support': 239711}, '2': {'precision': 0.2909000638343145, 'recall': 0.5029183833627624, 'f1-score': 0.36859559094463074, 'support': 40776}, 'accuracy': 0.5284671896711801, 'macro avg': {'precision': 0.46520708368151104, 'recall': 0.5582223646168, 'f1-score': 0.456607803257755, 'support': 320966}, 'weighted avg': {'precision': 0.7074120700455079, 'recall': 0.5284671896711801, 'f1-score': 0.5699751050094559, 'support': 320966}}
[[ 26772   8606   5101]
 [ 72483 122341  44887]
 [  8238  12031  20507]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9237893
{'0': {'precision': 0.315903026673829, 'recall': 0.6595635146812775, 'f1-score': 0.4271968370785848, 'support': 54389}, '1': {'precision': 0.7913558409597785, 'recall': 0.48598483953999105, 'f1-score': 0.6021681564817931, 'support': 211735}, '2': {'precision': 0.360640483852208, 'recall': 0.508843587031837, 'f1-score': 0.422111464895894, 'support': 54842}, 'accuracy': 0.5193042253696654, 'macro avg': {'precision': 0.4892997838286051, 'recall': 0.5514639804177018, 'f1-score': 0.4838254861520907, 'support': 320966}, 'weighted avg': {'precision': 0.6371940458453681, 'recall': 0.5193042253696654, 'f1-score': 0.5417530839477086, 'support': 320966}}
[[ 35873  11380   7136]
 [ 66498 102900  42337]
 [ 11186  15750  27906]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.94503576
{'0': {'precision': 0.3578881345301362, 'recall': 0.6480944267931421, 'f1-score': 0.4611318611711771, 'support': 65151}, '1': {'precision': 0.7307010634107917, 'recall': 0.46851719348457427, 'f1-score': 0.5709486318057087, 'support': 190072}, '2': {'precision': 0.4049042693526315, 'recall': 0.4995664937712, 'f1-score': 0.44728169090810044, 'support': 65743}, 'accuracy': 0.5113283026862658, 'macro avg': {'precision': 0.4978311557645198, 'recall': 0.5387260380163054, 'f1-score': 0.493120727961662, 'support': 320966}, 'weighted avg': {'precision': 0.5882934758118896, 'recall': 0.5113283026862658, 'f1-score': 0.5233270515790123, 'support': 320966}}
[[42224 13941  8986]
 [61736 89052 39284]
 [14021 18879 32843]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.97911674
{'0': {'precision': 0.41400407325258287, 'recall': 0.6127130950492391, 'f1-score': 0.4941296881304557, 'support': 81947}, '1': {'precision': 0.6148243761914124, 'recall': 0.46167276461903844, 'f1-score': 0.52735424693793, 'support': 155790}, '2': {'precision': 0.4625894757206423, 'recall': 0.45967150872892865, 'f1-score': 0.4611258761066213, 'support': 83229}, 'accuracy': 0.4997164808733635, 'macro avg': {'precision': 0.4971393083882125, 'recall': 0.5113524561324021, 'f1-score': 0.494203270391669, 'support': 320966}, 'weighted avg': {'precision': 0.5240765091394194, 'recall': 0.4997164808733635, 'f1-score': 0.5016980279100108, 'support': 320966}}
[[50210 19476 12261]
 [51681 71924 32185]
 [19388 25583 38258]]
Evaluating performance on  val set...
427/427 - 5s - 5s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.90052515
{'0': {'precision': 0.23372716333005142, 'recall': 0.6620187466108917, 'f1-score': 0.3454813736785722, 'support': 12909}, '1': {'precision': 0.8627163861753555, 'recall': 0.5169537363126074, 'f1-score': 0.6465088312664412, 'support': 83197}, '2': {'precision': 0.286171799596385, 'recall': 0.4977489507821442, 'f1-score': 0.36340845148889933, 'support': 13105}, 'accuracy': 0.5317962476307332, 'macro avg': {'precision': 0.46087178303393067, 'recall': 0.5589071445685477, 'f1-score': 0.4517995521446376, 'support': 109211}, 'weighted avg': {'precision': 0.7191847026926712, 'recall': 0.5317962476307332, 'f1-score': 0.5769554536122994, 'support': 109211}}
[[ 8546  2828  1535]
 [25452 43009 14736]
 [ 2566  4016  6523]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9268296
{'0': {'precision': 0.2983067471994218, 'recall': 0.6575443786982249, 'f1-score': 0.41041940409815686, 'support': 17576}, '1': {'precision': 0.7980023423861401, 'recall': 0.4886272917935187, 'f1-score': 0.6061196059014082, 'support': 73905}, '2': {'precision': 0.3529108502538071, 'recall': 0.5019176536943034, 'f1-score': 0.4144274204815349, 'support': 17730}, 'accuracy': 0.5179698015767642, 'macro avg': {'precision': 0.4830733132797896, 'recall': 0.5493631080620157, 'f1-score': 0.4769888101603666, 'support': 109211}, 'weighted avg': {'precision': 0.645324297715658, 'recall': 0.5179698015767642, 'f1-score': 0.5435038511295601, 'support': 109211}}
[[11557  3858  2161]
 [23637 36112 14156]
 [ 3548  5283  8899]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9504873
{'0': {'precision': 0.3411048411048411, 'recall': 0.6465565772189904, 'f1-score': 0.4465975372650681, 'support': 21316}, '1': {'precision': 0.7346668558187922, 'recall': 0.46805049257373543, 'f1-score': 0.5718071402281929, 'support': 66386}, '2': {'precision': 0.39848376268245767, 'recall': 0.49118973452973175, 'f1-score': 0.44000666361251095, 'support': 21509}, 'accuracy': 0.5074488833542409, 'macro avg': {'precision': 0.49141848653536363, 'recall': 0.5352656014408191, 'f1-score': 0.486137113701924, 'support': 109211}, 'weighted avg': {'precision': 0.591639779279689, 'recall': 0.5074488833542409, 'f1-score': 0.5214105286388047, 'support': 109211}}
[[13782  4791  2743]
 [22109 31072 13205]
 [ 4513  6431 10565]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9893238
{'0': {'precision': 0.3951851228946926, 'recall': 0.6029546537629679, 'f1-score': 0.4774455732946299, 'support': 27279}, '1': {'precision': 0.6100995627146281, 'recall': 0.45463750506277845, 'f1-score': 0.5210190410886651, 'support': 54318}, '2': {'precision': 0.4555010511562719, 'recall': 0.4472369088143695, 'f1-score': 0.4513311528130539, 'support': 27614}, 'accuracy': 0.48981329719533745, 'macro avg': {'precision': 0.4869285789218642, 'recall': 0.501609689213372, 'f1-score': 0.48326525573211637, 'support': 109211}, 'weighted avg': {'precision': 0.5173274582377854, 'recall': 0.48981329719533745, 'f1-score': 0.4925145683267985, 'support': 109211}}
[[16448  6942  3889]
 [18749 24695 10874]
 [ 6424  8840 12350]]
training model: results/EXC/W7/deepLOB_L2/seq2seq
Epoch 1/50
1254/1254 - 73s - loss: 11.3341 - accuracy10: 0.4701 - accuracy20: 0.4848 - accuracy30: 0.4883 - accuracy50: 0.4883 - val_loss: 11.4627 - val_accuracy10: 0.5149 - val_accuracy20: 0.5158 - val_accuracy30: 0.5106 - val_accuracy50: 0.4934 - 73s/epoch - 58ms/step
Epoch 2/50
1254/1254 - 65s - loss: 10.4727 - accuracy10: 0.5574 - accuracy20: 0.5622 - accuracy30: 0.5553 - accuracy50: 0.5377 - val_loss: 10.3637 - val_accuracy10: 0.5471 - val_accuracy20: 0.5461 - val_accuracy30: 0.5375 - val_accuracy50: 0.5184 - 65s/epoch - 52ms/step
Epoch 3/50
1254/1254 - 64s - loss: 9.9219 - accuracy10: 0.6188 - accuracy20: 0.6102 - accuracy30: 0.5910 - accuracy50: 0.5594 - val_loss: 9.9761 - val_accuracy10: 0.5965 - val_accuracy20: 0.5869 - val_accuracy30: 0.5689 - val_accuracy50: 0.5387 - 64s/epoch - 51ms/step
Epoch 4/50
1254/1254 - 65s - loss: 9.6485 - accuracy10: 0.6353 - accuracy20: 0.6234 - accuracy30: 0.6010 - accuracy50: 0.5665 - val_loss: 9.8168 - val_accuracy10: 0.6333 - val_accuracy20: 0.6133 - val_accuracy30: 0.5854 - val_accuracy50: 0.5440 - 65s/epoch - 51ms/step
Epoch 5/50
1254/1254 - 64s - loss: 9.4983 - accuracy10: 0.6426 - accuracy20: 0.6286 - accuracy30: 0.6052 - accuracy50: 0.5697 - val_loss: 9.8697 - val_accuracy10: 0.6193 - val_accuracy20: 0.6004 - val_accuracy30: 0.5747 - val_accuracy50: 0.5369 - 64s/epoch - 51ms/step
Epoch 6/50
1254/1254 - 64s - loss: 9.3845 - accuracy10: 0.6465 - accuracy20: 0.6319 - accuracy30: 0.6086 - accuracy50: 0.5724 - val_loss: 9.8023 - val_accuracy10: 0.6308 - val_accuracy20: 0.6074 - val_accuracy30: 0.5788 - val_accuracy50: 0.5391 - 64s/epoch - 51ms/step
Epoch 7/50
1254/1254 - 65s - loss: 9.2912 - accuracy10: 0.6495 - accuracy20: 0.6347 - accuracy30: 0.6106 - accuracy50: 0.5756 - val_loss: 9.8205 - val_accuracy10: 0.6127 - val_accuracy20: 0.5926 - val_accuracy30: 0.5654 - val_accuracy50: 0.5303 - 65s/epoch - 52ms/step
Epoch 8/50
1254/1254 - 64s - loss: 9.2198 - accuracy10: 0.6511 - accuracy20: 0.6364 - accuracy30: 0.6122 - accuracy50: 0.5784 - val_loss: 9.7796 - val_accuracy10: 0.6209 - val_accuracy20: 0.5972 - val_accuracy30: 0.5662 - val_accuracy50: 0.5287 - 64s/epoch - 51ms/step
Epoch 9/50
1254/1254 - 64s - loss: 9.1675 - accuracy10: 0.6534 - accuracy20: 0.6387 - accuracy30: 0.6143 - accuracy50: 0.5805 - val_loss: 9.8011 - val_accuracy10: 0.6005 - val_accuracy20: 0.5809 - val_accuracy30: 0.5535 - val_accuracy50: 0.5227 - 64s/epoch - 51ms/step
Epoch 10/50
1254/1254 - 64s - loss: 9.1174 - accuracy10: 0.6545 - accuracy20: 0.6401 - accuracy30: 0.6160 - accuracy50: 0.5828 - val_loss: 9.7353 - val_accuracy10: 0.5885 - val_accuracy20: 0.5772 - val_accuracy30: 0.5552 - val_accuracy50: 0.5282 - 64s/epoch - 51ms/step
Epoch 11/50
1254/1254 - 64s - loss: 9.0720 - accuracy10: 0.6556 - accuracy20: 0.6406 - accuracy30: 0.6169 - accuracy50: 0.5846 - val_loss: 9.8042 - val_accuracy10: 0.5907 - val_accuracy20: 0.5772 - val_accuracy30: 0.5530 - val_accuracy50: 0.5242 - 64s/epoch - 51ms/step
Epoch 12/50
1254/1254 - 64s - loss: 9.0357 - accuracy10: 0.6565 - accuracy20: 0.6417 - accuracy30: 0.6190 - accuracy50: 0.5867 - val_loss: 9.8077 - val_accuracy10: 0.5785 - val_accuracy20: 0.5660 - val_accuracy30: 0.5431 - val_accuracy50: 0.5187 - 64s/epoch - 51ms/step
Epoch 13/50
1254/1254 - 64s - loss: 8.9979 - accuracy10: 0.6583 - accuracy20: 0.6435 - accuracy30: 0.6203 - accuracy50: 0.5873 - val_loss: 9.8810 - val_accuracy10: 0.5745 - val_accuracy20: 0.5644 - val_accuracy30: 0.5430 - val_accuracy50: 0.5204 - 64s/epoch - 51ms/step
Epoch 14/50
1254/1254 - 64s - loss: 8.9678 - accuracy10: 0.6586 - accuracy20: 0.6435 - accuracy30: 0.6210 - accuracy50: 0.5883 - val_loss: 9.8017 - val_accuracy10: 0.5966 - val_accuracy20: 0.5800 - val_accuracy30: 0.5553 - val_accuracy50: 0.5259 - 64s/epoch - 51ms/step
Epoch 15/50
1254/1254 - 64s - loss: 8.9353 - accuracy10: 0.6590 - accuracy20: 0.6443 - accuracy30: 0.6215 - accuracy50: 0.5895 - val_loss: 9.8884 - val_accuracy10: 0.5628 - val_accuracy20: 0.5535 - val_accuracy30: 0.5337 - val_accuracy50: 0.5136 - 64s/epoch - 51ms/step
Epoch 16/50
1254/1254 - 64s - loss: 8.9118 - accuracy10: 0.6606 - accuracy20: 0.6455 - accuracy30: 0.6224 - accuracy50: 0.5904 - val_loss: 9.7389 - val_accuracy10: 0.5874 - val_accuracy20: 0.5756 - val_accuracy30: 0.5533 - val_accuracy50: 0.5286 - 64s/epoch - 51ms/step
Epoch 17/50
1254/1254 - 64s - loss: 8.8812 - accuracy10: 0.6609 - accuracy20: 0.6458 - accuracy30: 0.6227 - accuracy50: 0.5910 - val_loss: 9.7215 - val_accuracy10: 0.6063 - val_accuracy20: 0.5878 - val_accuracy30: 0.5605 - val_accuracy50: 0.5308 - 64s/epoch - 51ms/step
Epoch 18/50
1254/1254 - 64s - loss: 8.8524 - accuracy10: 0.6613 - accuracy20: 0.6464 - accuracy30: 0.6242 - accuracy50: 0.5926 - val_loss: 9.9866 - val_accuracy10: 0.5626 - val_accuracy20: 0.5520 - val_accuracy30: 0.5315 - val_accuracy50: 0.5121 - 64s/epoch - 51ms/step
Epoch 19/50
1254/1254 - 64s - loss: 8.8297 - accuracy10: 0.6623 - accuracy20: 0.6480 - accuracy30: 0.6253 - accuracy50: 0.5937 - val_loss: 9.8738 - val_accuracy10: 0.5994 - val_accuracy20: 0.5806 - val_accuracy30: 0.5538 - val_accuracy50: 0.5238 - 64s/epoch - 51ms/step
Epoch 20/50
1254/1254 - 64s - loss: 8.8001 - accuracy10: 0.6634 - accuracy20: 0.6479 - accuracy30: 0.6261 - accuracy50: 0.5946 - val_loss: 9.8564 - val_accuracy10: 0.5948 - val_accuracy20: 0.5769 - val_accuracy30: 0.5522 - val_accuracy50: 0.5246 - 64s/epoch - 51ms/step
Epoch 21/50
1254/1254 - 64s - loss: 8.7824 - accuracy10: 0.6646 - accuracy20: 0.6486 - accuracy30: 0.6265 - accuracy50: 0.5950 - val_loss: 9.8231 - val_accuracy10: 0.6152 - val_accuracy20: 0.5938 - val_accuracy30: 0.5664 - val_accuracy50: 0.5325 - 64s/epoch - 51ms/step
Epoch 22/50
1254/1254 - 65s - loss: 8.7549 - accuracy10: 0.6648 - accuracy20: 0.6497 - accuracy30: 0.6275 - accuracy50: 0.5965 - val_loss: 9.7591 - val_accuracy10: 0.6143 - val_accuracy20: 0.5922 - val_accuracy30: 0.5641 - val_accuracy50: 0.5312 - 65s/epoch - 51ms/step
Epoch 23/50
1254/1254 - 64s - loss: 8.7318 - accuracy10: 0.6653 - accuracy20: 0.6505 - accuracy30: 0.6283 - accuracy50: 0.5977 - val_loss: 9.9611 - val_accuracy10: 0.5931 - val_accuracy20: 0.5738 - val_accuracy30: 0.5474 - val_accuracy50: 0.5213 - 64s/epoch - 51ms/step
Epoch 24/50
1254/1254 - 64s - loss: 8.7082 - accuracy10: 0.6654 - accuracy20: 0.6507 - accuracy30: 0.6290 - accuracy50: 0.5981 - val_loss: 9.8071 - val_accuracy10: 0.6166 - val_accuracy20: 0.5951 - val_accuracy30: 0.5670 - val_accuracy50: 0.5339 - 64s/epoch - 51ms/step
Epoch 25/50
1254/1254 - 64s - loss: 8.6822 - accuracy10: 0.6665 - accuracy20: 0.6517 - accuracy30: 0.6298 - accuracy50: 0.5991 - val_loss: 9.9994 - val_accuracy10: 0.6123 - val_accuracy20: 0.5879 - val_accuracy30: 0.5569 - val_accuracy50: 0.5241 - 64s/epoch - 51ms/step
Epoch 26/50
1254/1254 - 64s - loss: 8.6652 - accuracy10: 0.6661 - accuracy20: 0.6523 - accuracy30: 0.6307 - accuracy50: 0.5993 - val_loss: 9.9950 - val_accuracy10: 0.6063 - val_accuracy20: 0.5818 - val_accuracy30: 0.5518 - val_accuracy50: 0.5199 - 64s/epoch - 51ms/step
Epoch 27/50
1254/1254 - 64s - loss: 8.6402 - accuracy10: 0.6671 - accuracy20: 0.6532 - accuracy30: 0.6313 - accuracy50: 0.6012 - val_loss: 9.8664 - val_accuracy10: 0.6207 - val_accuracy20: 0.5954 - val_accuracy30: 0.5641 - val_accuracy50: 0.5301 - 64s/epoch - 51ms/step
testing model: results/EXC/W7/deepLOB_L2/seq2seq
Evaluating performance on  test set...
5929/5929 - 119s - 119s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7682747
{'0': {'precision': 0.29185262621795127, 'recall': 0.6165589802540304, 'f1-score': 0.3961736206877731, 'support': 176593}, '1': {'precision': 0.9139351923881751, 'recall': 0.6496745934239665, 'f1-score': 0.7594739811918509, 'support': 1166387}, '2': {'precision': 0.3472700926193096, 'recall': 0.6272931904486434, 'f1-score': 0.44705186031797867, 'support': 174593}, 'accuracy': 0.6432461568570342, 'macro avg': {'precision': 0.5176859704084786, 'recall': 0.6311755880422134, 'f1-score': 0.5342331540658676, 'support': 1517573}, 'weighted avg': {'precision': 0.7763528906658568, 'recall': 0.6432461568570342, 'f1-score': 0.6812549987032138, 'support': 1517573}}
[[108880  29020  38693]
 [241452 757772 167163]
 [ 22733  42339 109521]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.80106103
{'0': {'precision': 0.3563552069499513, 'recall': 0.6366108517836495, 'f1-score': 0.4569332251361686, 'support': 233510}, '1': {'precision': 0.8607778578590293, 'recall': 0.6156826117268621, 'f1-score': 0.7178870962822899, 'support': 1051381}, '2': {'precision': 0.40706361848997574, 'recall': 0.6095142726983609, 'f1-score': 0.4881300046292551, 'support': 232682}, 'accuracy': 0.6179570933325778, 'macro avg': {'precision': 0.5413988944329855, 'recall': 0.6206025787362909, 'f1-score': 0.5543167753492378, 'support': 1517573}, 'weighted avg': {'precision': 0.7135962264919392, 'recall': 0.6179570933325778, 'f1-score': 0.6425064206565755, 'support': 1517573}}
[[148655  43642  41213]
 [238695 647317 165369]
 [ 29804  61055 141823]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8417828
{'0': {'precision': 0.3895385864203261, 'recall': 0.6533453547401276, 'f1-score': 0.48807583640910435, 'support': 276174}, '1': {'precision': 0.811751972863141, 'recall': 0.5721984229046837, 'f1-score': 0.671242553320499, 'support': 967348}, '2': {'precision': 0.4357927348190148, 'recall': 0.592327705427092, 'f1-score': 0.502143718872769, 'support': 274051}, 'accuracy': 0.590600913432171, 'macro avg': {'precision': 0.545694431367494, 'recall': 0.6059571610239677, 'f1-score': 0.5538207028674574, 'support': 1517573}, 'weighted avg': {'precision': 0.6670232745186866, 'recall': 0.590600913432171, 'f1-score': 0.6073724201832316, 'support': 1517573}}
[[180437  53874  41863]
 [245535 553515 168298]
 [ 37235  74488 162328]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.89029735
{'0': {'precision': 0.4365212676297069, 'recall': 0.6418685670871742, 'f1-score': 0.5196437717351394, 'support': 346169}, '1': {'precision': 0.7126126474196135, 'recall': 0.5321951207782902, 'f1-score': 0.6093293818541211, 'support': 831772}, '2': {'precision': 0.47637683479015114, 'recall': 0.543341027936119, 'f1-score': 0.5076601843726187, 'support': 339632}, 'accuracy': 0.5597068477101266, 'macro avg': {'precision': 0.5418369166131571, 'recall': 0.5724682386005279, 'f1-score': 0.5455444459872931, 'support': 1517573}, 'weighted avg': {'precision': 0.5967648309617154, 'recall': 0.5597068477101266, 'f1-score': 0.5661179575283619, 'support': 1517573}}
[[222195  77097  46877]
 [233146 442665 155961]
 [ 53672 101424 184536]]
Evaluating performance on  train set...
1254/1254 - 26s - 26s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.84594387
{'0': {'precision': 0.32288357479490315, 'recall': 0.6856189770200148, 'f1-score': 0.4390174439302243, 'support': 40470}, '1': {'precision': 0.9255486759909337, 'recall': 0.5585427795778964, 'f1-score': 0.696666675335686, 'support': 239799}, '2': {'precision': 0.3257824869078066, 'recall': 0.7229907368731419, 'f1-score': 0.44916806594413067, 'support': 40699}, 'accuracy': 0.5954176117245333, 'macro avg': {'precision': 0.5247382458978811, 'recall': 0.6557174978236844, 'f1-score': 0.5282840617366803, 'support': 320968}, 'weighted avg': {'precision': 0.7735094048645362, 'recall': 0.5954176117245333, 'f1-score': 0.6327973478681318, 'support': 320968}}
[[ 27747   4336   8387]
 [ 53352 133938  52509]
 [  4836   6438  29425]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8626752
{'0': {'precision': 0.38535337047295093, 'recall': 0.6724863543638468, 'f1-score': 0.48995112807123253, 'support': 54413}, '1': {'precision': 0.8652135061443639, 'recall': 0.5348576986270326, 'f1-score': 0.66106081339336, 'support': 211804}, '2': {'precision': 0.39497044531858055, 'recall': 0.6858870157622692, 'f1-score': 0.5012781237277163, 'support': 54751}, 'accuracy': 0.5839522943097131, 'macro avg': {'precision': 0.5485124406452985, 'recall': 0.6310770229177162, 'f1-score': 0.5507633550641029, 'support': 320968}, 'weighted avg': {'precision': 0.7036494019795841, 'recall': 0.5839522943097131, 'f1-score': 0.6047970944266201, 'support': 320968}}
[[ 36592   7276  10545]
 [ 51539 113285  46980]
 [  6826  10372  37553]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.89754593
{'0': {'precision': 0.4133091337565092, 'recall': 0.6676234477889147, 'f1-score': 0.5105496375854682, 'support': 65149}, '1': {'precision': 0.8039163754731006, 'recall': 0.49479678815381944, 'f1-score': 0.6125682739943623, 'support': 190171}, '2': {'precision': 0.43232507473273546, 'recall': 0.6498903241530587, 'f1-score': 0.5192383757370704, 'support': 65648}, 'accuracy': 0.5615980409261982, 'macro avg': {'precision': 0.5498501946541151, 'recall': 0.604103520031931, 'f1-score': 0.5474520957723003, 'support': 320968}, 'weighted avg': {'precision': 0.6486301883715898, 'recall': 0.5615980409261982, 'f1-score': 0.5727719911742751, 'support': 320968}}
[[43495  9565 12089]
 [52143 94096 43932]
 [ 9598 13386 42664]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.93805456
{'0': {'precision': 0.45127772129650373, 'recall': 0.6397234842933216, 'f1-score': 0.5292257327904133, 'support': 81876}, '1': {'precision': 0.6816110156234912, 'recall': 0.4525806244790665, 'f1-score': 0.5439714563136723, 'support': 155970}, '2': {'precision': 0.481063745806197, 'recall': 0.5864993623830033, 'f1-score': 0.5285749910550682, 'support': 83122}, 'accuracy': 0.5350003738690461, 'macro avg': {'precision': 0.5379841609087307, 'recall': 0.5596011570517971, 'f1-score': 0.5339240600530513, 'support': 320968}, 'weighted avg': {'precision': 0.5709188002996286, 'recall': 0.5350003738690461, 'f1-score': 0.536222690566258, 'support': 320968}}
[[52378 14197 15301]
 [48093 70589 37288]
 [15595 18776 48751]]
Evaluating performance on  val set...
427/427 - 8s - 8s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8118715
{'0': {'precision': 0.2910494405900369, 'recall': 0.7190395305744287, 'f1-score': 0.41437152391546167, 'support': 12952}, '1': {'precision': 0.9240866920737576, 'recall': 0.5773485978161528, 'f1-score': 0.7106801865146917, 'support': 83156}, '2': {'precision': 0.356704540955699, 'recall': 0.6876287873006182, 'f1-score': 0.46973567592930504, 'support': 13103}, 'accuracy': 0.6073838715880269, 'macro avg': {'precision': 0.5239468912064978, 'recall': 0.6613389718970666, 'f1-score': 0.5315957954531528, 'support': 109211}, 'weighted avg': {'precision': 0.7809371301494361, 'recall': 0.6073838715880269, 'f1-score': 0.6466309083267293, 'support': 109211}}
[[ 9313  1485  2154]
 [21051 48010 14095]
 [ 1634  2459  9010]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.83967274
{'0': {'precision': 0.34748063111462985, 'recall': 0.6974460839954597, 'f1-score': 0.4638583776846714, 'support': 17620}, '1': {'precision': 0.8600506199885148, 'recall': 0.5476893487918518, 'f1-score': 0.6692153017401883, 'support': 73832}, '2': {'precision': 0.4291039212762785, 'recall': 0.6482346978996565, 'f1-score': 0.5163836992845448, 'support': 17759}, 'accuracy': 0.5882008222614938, 'macro avg': {'precision': 0.5455450574598077, 'recall': 0.631123376895656, 'f1-score': 0.5498191262364681, 'support': 109211}, 'weighted avg': {'precision': 0.7072760311065481, 'recall': 0.5882008222614938, 'f1-score': 0.6112309830372373, 'support': 109211}}
[[12289  2582  2749]
 [20828 40437 12567]
 [ 2249  3998 11512]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8833862
{'0': {'precision': 0.37777777777777777, 'recall': 0.6896616189942045, 'f1-score': 0.4881566759296017, 'support': 21396}, '1': {'precision': 0.7928769591919, 'recall': 0.5043667134259469, 'f1-score': 0.6165391352447682, 'support': 66297}, '2': {'precision': 0.4668310815640861, 'recall': 0.6069802026210614, 'f1-score': 0.5277598189752707, 'support': 21518}, 'accuracy': 0.5608867238648122, 'macro avg': {'precision': 0.5458286061779213, 'recall': 0.6003361783470709, 'f1-score': 0.5441518767165469, 'support': 109211}, 'weighted avg': {'precision': 0.647311793775121, 'recall': 0.5608867238648122, 'f1-score': 0.5738948555751896, 'support': 109211}}
[[14756  3439  3201]
 [21143 33438 11716]
 [ 3161  5296 13061]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9360151
{'0': {'precision': 0.4246495190394832, 'recall': 0.6641288433382138, 'f1-score': 0.5180521649749453, 'support': 27320}, '1': {'precision': 0.6652922242026017, 'recall': 0.4608000294805889, 'f1-score': 0.5444787947400506, 'support': 54273}, '2': {'precision': 0.5161457792544907, 'recall': 0.5399739300456224, 'f1-score': 0.52779104953018, 'support': 27618}, 'accuracy': 0.5316863685892447, 'macro avg': {'precision': 0.5353625074988585, 'recall': 0.5549676009548085, 'f1-score': 0.5301073364150586, 'support': 109211}, 'weighted avg': {'precision': 0.5673763986755639, 'recall': 0.5316863685892447, 'f1-score': 0.5336478558017671, 'support': 109211}}
[[18144  5096  4080]
 [19364 25009  9900]
 [ 5219  7486 14913]]
training model: results/EXC/W7/deepOF_L2/seq2seq
Epoch 1/50
1254/1254 - 50s - loss: 10.7764 - accuracy10: 0.5268 - accuracy20: 0.5375 - accuracy30: 0.5343 - accuracy50: 0.5199 - val_loss: 10.1537 - val_accuracy10: 0.6313 - val_accuracy20: 0.6127 - val_accuracy30: 0.5867 - val_accuracy50: 0.5423 - 50s/epoch - 40ms/step
Epoch 2/50
1254/1254 - 44s - loss: 9.7667 - accuracy10: 0.6057 - accuracy20: 0.6036 - accuracy30: 0.5877 - accuracy50: 0.5600 - val_loss: 9.6934 - val_accuracy10: 0.6702 - val_accuracy20: 0.6486 - val_accuracy30: 0.6180 - val_accuracy50: 0.5674 - 44s/epoch - 35ms/step
Epoch 3/50
1254/1254 - 44s - loss: 9.5632 - accuracy10: 0.6177 - accuracy20: 0.6129 - accuracy30: 0.5971 - accuracy50: 0.5690 - val_loss: 9.6484 - val_accuracy10: 0.6483 - val_accuracy20: 0.6280 - val_accuracy30: 0.6013 - val_accuracy50: 0.5558 - 44s/epoch - 35ms/step
Epoch 4/50
1254/1254 - 44s - loss: 9.4557 - accuracy10: 0.6236 - accuracy20: 0.6177 - accuracy30: 0.6017 - accuracy50: 0.5737 - val_loss: 9.5482 - val_accuracy10: 0.6788 - val_accuracy20: 0.6544 - val_accuracy30: 0.6239 - val_accuracy50: 0.5722 - 44s/epoch - 35ms/step
Epoch 5/50
1254/1254 - 44s - loss: 9.3900 - accuracy10: 0.6265 - accuracy20: 0.6191 - accuracy30: 0.6036 - accuracy50: 0.5756 - val_loss: 9.4810 - val_accuracy10: 0.6750 - val_accuracy20: 0.6529 - val_accuracy30: 0.6243 - val_accuracy50: 0.5753 - 44s/epoch - 35ms/step
Epoch 6/50
1254/1254 - 44s - loss: 9.3380 - accuracy10: 0.6288 - accuracy20: 0.6212 - accuracy30: 0.6049 - accuracy50: 0.5768 - val_loss: 9.5050 - val_accuracy10: 0.6772 - val_accuracy20: 0.6535 - val_accuracy30: 0.6237 - val_accuracy50: 0.5718 - 44s/epoch - 35ms/step
Epoch 7/50
1254/1254 - 44s - loss: 9.3004 - accuracy10: 0.6310 - accuracy20: 0.6223 - accuracy30: 0.6061 - accuracy50: 0.5786 - val_loss: 9.4765 - val_accuracy10: 0.6865 - val_accuracy20: 0.6585 - val_accuracy30: 0.6285 - val_accuracy50: 0.5763 - 44s/epoch - 35ms/step
Epoch 8/50
1254/1254 - 44s - loss: 9.2652 - accuracy10: 0.6323 - accuracy20: 0.6238 - accuracy30: 0.6080 - accuracy50: 0.5805 - val_loss: 9.4758 - val_accuracy10: 0.6735 - val_accuracy20: 0.6499 - val_accuracy30: 0.6220 - val_accuracy50: 0.5720 - 44s/epoch - 35ms/step
Epoch 9/50
1254/1254 - 44s - loss: 9.2319 - accuracy10: 0.6341 - accuracy20: 0.6254 - accuracy30: 0.6085 - accuracy50: 0.5810 - val_loss: 9.4794 - val_accuracy10: 0.6656 - val_accuracy20: 0.6439 - val_accuracy30: 0.6170 - val_accuracy50: 0.5702 - 44s/epoch - 35ms/step
Epoch 10/50
1254/1254 - 42s - loss: 9.1967 - accuracy10: 0.6358 - accuracy20: 0.6264 - accuracy30: 0.6102 - accuracy50: 0.5823 - val_loss: 9.4700 - val_accuracy10: 0.6623 - val_accuracy20: 0.6402 - val_accuracy30: 0.6132 - val_accuracy50: 0.5672 - 42s/epoch - 34ms/step
Epoch 11/50
1254/1254 - 42s - loss: 9.1640 - accuracy10: 0.6374 - accuracy20: 0.6284 - accuracy30: 0.6113 - accuracy50: 0.5839 - val_loss: 9.4451 - val_accuracy10: 0.6696 - val_accuracy20: 0.6444 - val_accuracy30: 0.6155 - val_accuracy50: 0.5682 - 42s/epoch - 33ms/step
Epoch 12/50
1254/1254 - 44s - loss: 9.1409 - accuracy10: 0.6372 - accuracy20: 0.6286 - accuracy30: 0.6118 - accuracy50: 0.5842 - val_loss: 9.4469 - val_accuracy10: 0.6669 - val_accuracy20: 0.6417 - val_accuracy30: 0.6129 - val_accuracy50: 0.5668 - 44s/epoch - 35ms/step
Epoch 13/50
1254/1254 - 42s - loss: 9.1065 - accuracy10: 0.6378 - accuracy20: 0.6295 - accuracy30: 0.6134 - accuracy50: 0.5861 - val_loss: 9.4647 - val_accuracy10: 0.6669 - val_accuracy20: 0.6411 - val_accuracy30: 0.6116 - val_accuracy50: 0.5658 - 42s/epoch - 34ms/step
Epoch 14/50
1254/1254 - 42s - loss: 9.0758 - accuracy10: 0.6409 - accuracy20: 0.6324 - accuracy30: 0.6153 - accuracy50: 0.5867 - val_loss: 9.4911 - val_accuracy10: 0.6602 - val_accuracy20: 0.6346 - val_accuracy30: 0.6058 - val_accuracy50: 0.5619 - 42s/epoch - 33ms/step
Epoch 15/50
1254/1254 - 41s - loss: 9.0474 - accuracy10: 0.6416 - accuracy20: 0.6331 - accuracy30: 0.6162 - accuracy50: 0.5880 - val_loss: 9.4591 - val_accuracy10: 0.6624 - val_accuracy20: 0.6364 - val_accuracy30: 0.6063 - val_accuracy50: 0.5615 - 41s/epoch - 33ms/step
Epoch 16/50
1254/1254 - 41s - loss: 9.0244 - accuracy10: 0.6425 - accuracy20: 0.6332 - accuracy30: 0.6158 - accuracy50: 0.5878 - val_loss: 9.4652 - val_accuracy10: 0.6571 - val_accuracy20: 0.6318 - val_accuracy30: 0.6023 - val_accuracy50: 0.5599 - 41s/epoch - 33ms/step
Epoch 17/50
1254/1254 - 41s - loss: 8.9920 - accuracy10: 0.6437 - accuracy20: 0.6348 - accuracy30: 0.6171 - accuracy50: 0.5895 - val_loss: 9.4501 - val_accuracy10: 0.6564 - val_accuracy20: 0.6313 - val_accuracy30: 0.6034 - val_accuracy50: 0.5614 - 41s/epoch - 33ms/step
Epoch 18/50
1254/1254 - 41s - loss: 8.9628 - accuracy10: 0.6449 - accuracy20: 0.6358 - accuracy30: 0.6185 - accuracy50: 0.5912 - val_loss: 9.4659 - val_accuracy10: 0.6677 - val_accuracy20: 0.6383 - val_accuracy30: 0.6088 - val_accuracy50: 0.5637 - 41s/epoch - 33ms/step
Epoch 19/50
1254/1254 - 41s - loss: 8.9293 - accuracy10: 0.6463 - accuracy20: 0.6369 - accuracy30: 0.6199 - accuracy50: 0.5918 - val_loss: 9.4312 - val_accuracy10: 0.6690 - val_accuracy20: 0.6401 - val_accuracy30: 0.6102 - val_accuracy50: 0.5655 - 41s/epoch - 33ms/step
Epoch 20/50
1254/1254 - 41s - loss: 8.9079 - accuracy10: 0.6476 - accuracy20: 0.6384 - accuracy30: 0.6204 - accuracy50: 0.5930 - val_loss: 9.4775 - val_accuracy10: 0.6714 - val_accuracy20: 0.6426 - val_accuracy30: 0.6129 - val_accuracy50: 0.5654 - 41s/epoch - 33ms/step
Epoch 21/50
1254/1254 - 42s - loss: 8.8741 - accuracy10: 0.6494 - accuracy20: 0.6399 - accuracy30: 0.6219 - accuracy50: 0.5946 - val_loss: 9.6050 - val_accuracy10: 0.6835 - val_accuracy20: 0.6500 - val_accuracy30: 0.6179 - val_accuracy50: 0.5684 - 42s/epoch - 33ms/step
Epoch 22/50
1254/1254 - 41s - loss: 8.8491 - accuracy10: 0.6497 - accuracy20: 0.6410 - accuracy30: 0.6229 - accuracy50: 0.5955 - val_loss: 9.5760 - val_accuracy10: 0.6652 - val_accuracy20: 0.6339 - val_accuracy30: 0.6032 - val_accuracy50: 0.5575 - 41s/epoch - 32ms/step
Epoch 23/50
1254/1254 - 41s - loss: 8.8228 - accuracy10: 0.6508 - accuracy20: 0.6414 - accuracy30: 0.6237 - accuracy50: 0.5960 - val_loss: 9.4904 - val_accuracy10: 0.6714 - val_accuracy20: 0.6415 - val_accuracy30: 0.6107 - val_accuracy50: 0.5644 - 41s/epoch - 33ms/step
Epoch 24/50
1254/1254 - 42s - loss: 8.8016 - accuracy10: 0.6512 - accuracy20: 0.6418 - accuracy30: 0.6250 - accuracy50: 0.5978 - val_loss: 9.6532 - val_accuracy10: 0.6573 - val_accuracy20: 0.6277 - val_accuracy30: 0.5961 - val_accuracy50: 0.5539 - 42s/epoch - 33ms/step
Epoch 25/50
1254/1254 - 41s - loss: 8.7706 - accuracy10: 0.6523 - accuracy20: 0.6437 - accuracy30: 0.6259 - accuracy50: 0.5985 - val_loss: 9.6799 - val_accuracy10: 0.6604 - val_accuracy20: 0.6274 - val_accuracy30: 0.5962 - val_accuracy50: 0.5517 - 41s/epoch - 33ms/step
Epoch 26/50
1254/1254 - 41s - loss: 8.7387 - accuracy10: 0.6516 - accuracy20: 0.6437 - accuracy30: 0.6263 - accuracy50: 0.5998 - val_loss: 9.6761 - val_accuracy10: 0.6628 - val_accuracy20: 0.6283 - val_accuracy30: 0.5973 - val_accuracy50: 0.5517 - 41s/epoch - 33ms/step
Epoch 27/50
1254/1254 - 41s - loss: 8.7262 - accuracy10: 0.6532 - accuracy20: 0.6452 - accuracy30: 0.6271 - accuracy50: 0.5996 - val_loss: 9.6134 - val_accuracy10: 0.6625 - val_accuracy20: 0.6288 - val_accuracy30: 0.5966 - val_accuracy50: 0.5512 - 41s/epoch - 33ms/step
Epoch 28/50
1254/1254 - 41s - loss: 8.6925 - accuracy10: 0.6541 - accuracy20: 0.6466 - accuracy30: 0.6296 - accuracy50: 0.6017 - val_loss: 9.7822 - val_accuracy10: 0.6531 - val_accuracy20: 0.6216 - val_accuracy30: 0.5890 - val_accuracy50: 0.5462 - 41s/epoch - 33ms/step
Epoch 29/50
1254/1254 - 41s - loss: 8.6642 - accuracy10: 0.6552 - accuracy20: 0.6473 - accuracy30: 0.6298 - accuracy50: 0.6021 - val_loss: 9.7986 - val_accuracy10: 0.6663 - val_accuracy20: 0.6331 - val_accuracy30: 0.5998 - val_accuracy50: 0.5536 - 41s/epoch - 33ms/step
testing model: results/EXC/W7/deepOF_L2/seq2seq
Evaluating performance on  test set...
5928/5928 - 85s - 85s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7498465
{'0': {'precision': 0.28700049557999724, 'recall': 0.6263703905046661, 'f1-score': 0.39363771109913004, 'support': 176592}, '1': {'precision': 0.9082066890799096, 'recall': 0.6605351916089528, 'f1-score': 0.7648198684266693, 'support': 1166386}, '2': {'precision': 0.365911228699362, 'recall': 0.5949080703362163, 'f1-score': 0.4531206714902398, 'support': 174590}, 'accuracy': 0.649009467780027, 'macro avg': {'precision': 0.5203728044530896, 'recall': 0.6272712174832784, 'f1-score': 0.5371927503386796, 'support': 1517568}, 'weighted avg': {'precision': 0.7735310708866056, 'recall': 0.649009467780027, 'f1-score': 0.6857674883554526, 'support': 1517568}}
[[110612  29850  36130]
 [252089 770439 143858]
 [ 22706  48019 103865]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7788933
{'0': {'precision': 0.35330539061590405, 'recall': 0.6497721705466194, 'f1-score': 0.4577273371767141, 'support': 233508}, '1': {'precision': 0.8554534990732884, 'recall': 0.6347904658639122, 'f1-score': 0.7287850016215702, 'support': 1051380}, '2': {'precision': 0.435675780996298, 'recall': 0.5765944645006017, 'f1-score': 0.4963264400133181, 'support': 232680}, 'accuracy': 0.628172839701417, 'macro avg': {'precision': 0.5481448902284969, 'recall': 0.6203857003037111, 'f1-score': 0.5609462596038675, 'support': 1517568}, 'weighted avg': {'precision': 0.7138259212963315, 'recall': 0.628172839701417, 'f1-score': 0.6514358540221232, 'support': 1517568}}
[[151727  44437  37344]
 [247540 667406 136434]
 [ 30183  68335 134162]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8134367
{'0': {'precision': 0.3930070322395493, 'recall': 0.6594948075836797, 'f1-score': 0.49251428795485186, 'support': 276172}, '1': {'precision': 0.8083993858156617, 'recall': 0.6041265440426238, 'f1-score': 0.6914924771795059, 'support': 967347}, '2': {'precision': 0.46835194628359916, 'recall': 0.5660593543490398, 'f1-score': 0.5125910750574123, 'support': 274049}, 'accuracy': 0.6073283042341431, 'macro avg': {'precision': 0.5565861214462701, 'recall': 0.6098935686584478, 'f1-score': 0.5655326133972567, 'support': 1517568}, 'weighted avg': {'precision': 0.671397684522445, 'recall': 0.6073283042341431, 'f1-score': 0.622974984174442, 'support': 1517568}}
[[182134  56421  37617]
 [244471 584400 138476]
 [ 36832  82089 155128]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8654673
{'0': {'precision': 0.44306591159663267, 'recall': 0.6466261851250557, 'f1-score': 0.525832978024908, 'support': 346166}, '1': {'precision': 0.7154292276945986, 'recall': 0.5706888426155244, 'f1-score': 0.6349144566919865, 'support': 831772}, '2': {'precision': 0.5087984819429754, 'recall': 0.5226363984335894, 'f1-score': 0.5156246141958497, 'support': 339630}, 'accuracy': 0.5772565051450742, 'macro avg': {'precision': 0.5557645404114022, 'recall': 0.5799838087247232, 'f1-score': 0.5587906829709147, 'support': 1517568}, 'weighted avg': {'precision': 0.6070578599140495, 'recall': 0.5772565051450742, 'f1-score': 0.5833354115676621, 'support': 1517568}}
[[223840  79849  42477]
 [228202 474683 128887]
 [ 53165 108962 177503]]
Evaluating performance on  train set...
1254/1254 - 18s - 18s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7179583
{'0': {'precision': 0.3479082564089378, 'recall': 0.6685194792361472, 'f1-score': 0.4576487599462206, 'support': 40479}, '1': {'precision': 0.9099656357388316, 'recall': 0.6572748017404291, 'f1-score': 0.7632491716240044, 'support': 239711}, '2': {'precision': 0.3911963334713517, 'recall': 0.6719393761035903, 'f1-score': 0.49449984207914094, 'support': 40776}, 'accuracy': 0.6605559467357913, 'macro avg': {'precision': 0.5496900752063737, 'recall': 0.6659112190267222, 'f1-score': 0.571799257883122, 'support': 320966}, 'weighted avg': {'precision': 0.7731758893882726, 'recall': 0.6605559467357913, 'f1-score': 0.6905657044473367, 'support': 320966}}
[[ 27061   6137   7281]
 [ 46796 157556  35359]
 [  3925   9452  27399]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.75470763
{'0': {'precision': 0.413236258238156, 'recall': 0.660574748570483, 'f1-score': 0.5084198907536863, 'support': 54389}, '1': {'precision': 0.8513862579645256, 'recall': 0.6304484379058729, 'f1-score': 0.724446711747403, 'support': 211735}, '2': {'precision': 0.45702669808633506, 'recall': 0.6436307939170709, 'f1-score': 0.5345104333868379, 'support': 54842}, 'accuracy': 0.6378058735193136, 'macro avg': {'precision': 0.5738830714296722, 'recall': 0.6448846601311423, 'f1-score': 0.5891256786293092, 'support': 320966}, 'weighted avg': {'precision': 0.7097575268280276, 'recall': 0.6378058735193136, 'f1-score': 0.6553865366980914, 'support': 320966}}
[[ 35928   9453   9008]
 [ 45319 133488  32928]
 [  5696  13848  35298]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.80272084
{'0': {'precision': 0.446989411578781, 'recall': 0.6511949164249206, 'f1-score': 0.5301063311384053, 'support': 65151}, '1': {'precision': 0.7948573955649775, 'recall': 0.5957374047729281, 'f1-score': 0.6810413527842684, 'support': 190072}, '2': {'precision': 0.48624303179654044, 'recall': 0.6182711467380557, 'f1-score': 0.54436609815384, 'support': 65743}, 'accuracy': 0.6116099524560233, 'macro avg': {'precision': 0.576029946313433, 'recall': 0.6217344893119682, 'f1-score': 0.5851712606921712, 'support': 320966}, 'weighted avg': {'precision': 0.6610326878329653, 'recall': 0.6116099524560233, 'f1-score': 0.6224089466714157, 'support': 320966}}
[[ 42426  12190  10535]
 [ 44427 113233  32412]
 [  8062  17034  40647]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.86976016
{'0': {'precision': 0.485516690290237, 'recall': 0.6228171867182447, 'f1-score': 0.5456625398250904, 'support': 81947}, '1': {'precision': 0.6807796810395748, 'recall': 0.5548623146543424, 'f1-score': 0.6114052304917511, 'support': 155790}, '2': {'precision': 0.5260717902554293, 'recall': 0.5617272825577623, 'f1-score': 0.5433151848645257, 'support': 83229}, 'accuracy': 0.5739922608625213, 'macro avg': {'precision': 0.5641227205284137, 'recall': 0.5798022613101165, 'f1-score': 0.566794318393789, 'support': 320966}, 'weighted avg': {'precision': 0.5908094058546343, 'recall': 0.5739922608625213, 'f1-score': 0.576963941758461, 'support': 320966}}
[[51038 17310 13599]
 [40829 86442 28519]
 [13254 23223 46752]]
Evaluating performance on  val set...
427/427 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.69510853
{'0': {'precision': 0.32087609698051467, 'recall': 0.6684483693547137, 'f1-score': 0.43360719579910056, 'support': 12909}, '1': {'precision': 0.9082206475100767, 'recall': 0.6716708535163528, 'f1-score': 0.7722370012091898, 'support': 83197}, '2': {'precision': 0.4048386321004281, 'recall': 0.6422739412438001, 'f1-score': 0.4966367713004485, 'support': 13105}, 'accuracy': 0.6677624048859547, 'macro avg': {'precision': 0.5446451255303398, 'recall': 0.6607977213716222, 'f1-score': 0.567493656102913, 'support': 109211}, 'weighted avg': {'precision': 0.7783907575289434, 'recall': 0.6677624048859547, 'f1-score': 0.6991389325989501, 'support': 109211}}
[[ 8629  2198  2082]
 [17024 55881 10292]
 [ 1239  3449  8417]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.74597824
{'0': {'precision': 0.3846821002068183, 'recall': 0.6561219845243514, 'f1-score': 0.485006518904824, 'support': 17576}, '1': {'precision': 0.8465519080983035, 'recall': 0.6441377444015967, 'f1-score': 0.7316023636265839, 'support': 73905}, '2': {'precision': 0.46945519370407407, 'recall': 0.6089678510998308, 'f1-score': 0.5301873358049546, 'support': 17730}, 'accuracy': 0.6403567406213659, 'macro avg': {'precision': 0.566896400669732, 'recall': 0.6364091933419264, 'f1-score': 0.5822654061121209, 'support': 109211}, 'weighted avg': {'precision': 0.7110001002244591, 'recall': 0.6403567406213659, 'f1-score': 0.6592171917106858, 'support': 109211}}
[[11532  3496  2548]
 [16646 47605  9654]
 [ 1800  5133 10797]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.80126286
{'0': {'precision': 0.42016652381535446, 'recall': 0.6439294426721711, 'f1-score': 0.5085210432720806, 'support': 21316}, '1': {'precision': 0.7830756429359289, 'recall': 0.6095712951525925, 'f1-score': 0.6855153604431532, 'support': 66386}, '2': {'precision': 0.5016488377704497, 'recall': 0.5799432795573946, 'f1-score': 0.5379622641509434, 'support': 21509}, 'accuracy': 0.6104421715761232, 'macro avg': {'precision': 0.5682970015072444, 'recall': 0.6111480057940527, 'f1-score': 0.5773328892887257, 'support': 109211}, 'weighted avg': {'precision': 0.6568156514013906, 'recall': 0.6104421715761232, 'f1-score': 0.6219088518225223, 'support': 109211}}
[[13726  4671  2919]
 [16446 40467  9473]
 [ 2496  6539 12474]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.880871
{'0': {'precision': 0.460897027453805, 'recall': 0.6098830602294806, 'f1-score': 0.5250252461499622, 'support': 27279}, '1': {'precision': 0.6606813799014356, 'recall': 0.567657130233072, 'f1-score': 0.6106468095219235, 'support': 54318}, '2': {'precision': 0.5406141279685373, 'recall': 0.517708408778156, 'f1-score': 0.5289133893225795, 'support': 27614}, 'accuracy': 0.5655748963016546, 'macro avg': {'precision': 0.5540641784412593, 'recall': 0.5650828664135695, 'f1-score': 0.5548618149981551, 'support': 109211}, 'weighted avg': {'precision': 0.5804197355131051, 'recall': 0.5655748963016546, 'f1-score': 0.568593744422177, 'support': 109211}}
[[16637  6826  3816]
 [15152 30834  8332]
 [ 4308  9010 14296]]
training model: results/EXC/W7/deepVOL_L2/seq2seq
Epoch 1/50
1254/1254 - 49s - loss: 10.7440 - accuracy10: 0.5480 - accuracy20: 0.5514 - accuracy30: 0.5420 - accuracy50: 0.5239 - val_loss: 10.9006 - val_accuracy10: 0.6545 - val_accuracy20: 0.6287 - val_accuracy30: 0.5978 - val_accuracy50: 0.5416 - 49s/epoch - 39ms/step
Epoch 2/50
1254/1254 - 42s - loss: 9.9571 - accuracy10: 0.6108 - accuracy20: 0.6046 - accuracy30: 0.5882 - accuracy50: 0.5592 - val_loss: 10.5697 - val_accuracy10: 0.6832 - val_accuracy20: 0.6541 - val_accuracy30: 0.6215 - val_accuracy50: 0.5612 - 42s/epoch - 34ms/step
Epoch 3/50
1254/1254 - 42s - loss: 9.6837 - accuracy10: 0.6322 - accuracy20: 0.6212 - accuracy30: 0.6007 - accuracy50: 0.5679 - val_loss: 10.5185 - val_accuracy10: 0.6771 - val_accuracy20: 0.6462 - val_accuracy30: 0.6124 - val_accuracy50: 0.5531 - 42s/epoch - 34ms/step
Epoch 4/50
1254/1254 - 42s - loss: 9.5433 - accuracy10: 0.6383 - accuracy20: 0.6263 - accuracy30: 0.6043 - accuracy50: 0.5701 - val_loss: 10.5713 - val_accuracy10: 0.6784 - val_accuracy20: 0.6481 - val_accuracy30: 0.6142 - val_accuracy50: 0.5543 - 42s/epoch - 34ms/step
Epoch 5/50
1254/1254 - 42s - loss: 9.4634 - accuracy10: 0.6401 - accuracy20: 0.6285 - accuracy30: 0.6075 - accuracy50: 0.5730 - val_loss: 10.5203 - val_accuracy10: 0.6837 - val_accuracy20: 0.6558 - val_accuracy30: 0.6220 - val_accuracy50: 0.5607 - 42s/epoch - 34ms/step
Epoch 6/50
1254/1254 - 42s - loss: 9.4041 - accuracy10: 0.6435 - accuracy20: 0.6313 - accuracy30: 0.6098 - accuracy50: 0.5753 - val_loss: 10.4385 - val_accuracy10: 0.6812 - val_accuracy20: 0.6523 - val_accuracy30: 0.6195 - val_accuracy50: 0.5605 - 42s/epoch - 34ms/step
Epoch 7/50
1254/1254 - 42s - loss: 9.3620 - accuracy10: 0.6451 - accuracy20: 0.6321 - accuracy30: 0.6105 - accuracy50: 0.5757 - val_loss: 10.3371 - val_accuracy10: 0.6871 - val_accuracy20: 0.6605 - val_accuracy30: 0.6281 - val_accuracy50: 0.5664 - 42s/epoch - 34ms/step
Epoch 8/50
1254/1254 - 42s - loss: 9.3173 - accuracy10: 0.6456 - accuracy20: 0.6332 - accuracy30: 0.6116 - accuracy50: 0.5777 - val_loss: 10.4709 - val_accuracy10: 0.6745 - val_accuracy20: 0.6472 - val_accuracy30: 0.6145 - val_accuracy50: 0.5539 - 42s/epoch - 34ms/step
Epoch 9/50
1254/1254 - 42s - loss: 9.2812 - accuracy10: 0.6480 - accuracy20: 0.6353 - accuracy30: 0.6139 - accuracy50: 0.5785 - val_loss: 10.3045 - val_accuracy10: 0.6838 - val_accuracy20: 0.6549 - val_accuracy30: 0.6215 - val_accuracy50: 0.5605 - 42s/epoch - 34ms/step
Epoch 10/50
1254/1254 - 41s - loss: 9.2486 - accuracy10: 0.6498 - accuracy20: 0.6369 - accuracy30: 0.6151 - accuracy50: 0.5794 - val_loss: 10.2935 - val_accuracy10: 0.6810 - val_accuracy20: 0.6512 - val_accuracy30: 0.6182 - val_accuracy50: 0.5568 - 41s/epoch - 33ms/step
Epoch 11/50
1254/1254 - 41s - loss: 9.2154 - accuracy10: 0.6508 - accuracy20: 0.6368 - accuracy30: 0.6151 - accuracy50: 0.5797 - val_loss: 10.2916 - val_accuracy10: 0.6809 - val_accuracy20: 0.6505 - val_accuracy30: 0.6155 - val_accuracy50: 0.5553 - 41s/epoch - 33ms/step
Epoch 12/50
1254/1254 - 42s - loss: 9.1884 - accuracy10: 0.6523 - accuracy20: 0.6390 - accuracy30: 0.6165 - accuracy50: 0.5805 - val_loss: 10.2428 - val_accuracy10: 0.6917 - val_accuracy20: 0.6597 - val_accuracy30: 0.6248 - val_accuracy50: 0.5617 - 42s/epoch - 33ms/step
Epoch 13/50
1254/1254 - 40s - loss: 9.1633 - accuracy10: 0.6520 - accuracy20: 0.6391 - accuracy30: 0.6176 - accuracy50: 0.5816 - val_loss: 10.2936 - val_accuracy10: 0.6794 - val_accuracy20: 0.6513 - val_accuracy30: 0.6171 - val_accuracy50: 0.5584 - 40s/epoch - 32ms/step
Epoch 14/50
1254/1254 - 40s - loss: 9.1411 - accuracy10: 0.6538 - accuracy20: 0.6403 - accuracy30: 0.6182 - accuracy50: 0.5823 - val_loss: 10.2472 - val_accuracy10: 0.6810 - val_accuracy20: 0.6515 - val_accuracy30: 0.6178 - val_accuracy50: 0.5578 - 40s/epoch - 32ms/step
Epoch 15/50
1254/1254 - 41s - loss: 9.1197 - accuracy10: 0.6538 - accuracy20: 0.6405 - accuracy30: 0.6182 - accuracy50: 0.5824 - val_loss: 10.2838 - val_accuracy10: 0.6838 - val_accuracy20: 0.6506 - val_accuracy30: 0.6149 - val_accuracy50: 0.5544 - 41s/epoch - 33ms/step
Epoch 16/50
1254/1254 - 40s - loss: 9.0974 - accuracy10: 0.6547 - accuracy20: 0.6411 - accuracy30: 0.6187 - accuracy50: 0.5835 - val_loss: 10.3539 - val_accuracy10: 0.6746 - val_accuracy20: 0.6442 - val_accuracy30: 0.6101 - val_accuracy50: 0.5511 - 40s/epoch - 32ms/step
Epoch 17/50
1254/1254 - 40s - loss: 9.0831 - accuracy10: 0.6546 - accuracy20: 0.6411 - accuracy30: 0.6193 - accuracy50: 0.5846 - val_loss: 10.3110 - val_accuracy10: 0.6755 - val_accuracy20: 0.6456 - val_accuracy30: 0.6126 - val_accuracy50: 0.5555 - 40s/epoch - 32ms/step
Epoch 18/50
1254/1254 - 40s - loss: 9.0629 - accuracy10: 0.6549 - accuracy20: 0.6416 - accuracy30: 0.6194 - accuracy50: 0.5846 - val_loss: 10.3328 - val_accuracy10: 0.6742 - val_accuracy20: 0.6429 - val_accuracy30: 0.6084 - val_accuracy50: 0.5513 - 40s/epoch - 32ms/step
Epoch 19/50
1254/1254 - 40s - loss: 9.0395 - accuracy10: 0.6558 - accuracy20: 0.6425 - accuracy30: 0.6203 - accuracy50: 0.5858 - val_loss: 10.2920 - val_accuracy10: 0.6810 - val_accuracy20: 0.6477 - val_accuracy30: 0.6141 - val_accuracy50: 0.5558 - 40s/epoch - 32ms/step
Epoch 20/50
1254/1254 - 40s - loss: 9.0215 - accuracy10: 0.6562 - accuracy20: 0.6422 - accuracy30: 0.6201 - accuracy50: 0.5860 - val_loss: 10.3083 - val_accuracy10: 0.6805 - val_accuracy20: 0.6472 - val_accuracy30: 0.6128 - val_accuracy50: 0.5539 - 40s/epoch - 32ms/step
Epoch 21/50
1254/1254 - 40s - loss: 9.0029 - accuracy10: 0.6562 - accuracy20: 0.6430 - accuracy30: 0.6206 - accuracy50: 0.5867 - val_loss: 10.3192 - val_accuracy10: 0.6781 - val_accuracy20: 0.6468 - val_accuracy30: 0.6128 - val_accuracy50: 0.5542 - 40s/epoch - 32ms/step
Epoch 22/50
1254/1254 - 40s - loss: 8.9885 - accuracy10: 0.6570 - accuracy20: 0.6440 - accuracy30: 0.6217 - accuracy50: 0.5874 - val_loss: 10.3253 - val_accuracy10: 0.6808 - val_accuracy20: 0.6494 - val_accuracy30: 0.6138 - val_accuracy50: 0.5543 - 40s/epoch - 32ms/step
testing model: results/EXC/W7/deepVOL_L2/seq2seq
Evaluating performance on  test set...
5929/5929 - 82s - 82s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6737451
{'0': {'precision': 0.31720979898077944, 'recall': 0.635874581665185, 'f1-score': 0.42326923475609185, 'support': 176593}, '1': {'precision': 0.8904983658060757, 'recall': 0.7533322987996265, 'f1-score': 0.8161925622076325, 'support': 1166387}, '2': {'precision': 0.4376936647592337, 'recall': 0.4433568356119661, 'f1-score': 0.4405070494671997, 'support': 174593}, 'accuracy': 0.7040023774803584, 'macro avg': {'precision': 0.548467276515363, 'recall': 0.6108545720255926, 'f1-score': 0.5599896154769747, 'support': 1517573}, 'weighted avg': {'precision': 0.7716933534269342, 'recall': 0.7040023774803584, 'f1-score': 0.7272481951883588, 'support': 1517573}}
[[112291  36321  27981]
 [216246 878677  71464]
 [ 25459  71727  77407]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.71520877
{'0': {'precision': 0.38925309144741554, 'recall': 0.6283242687679329, 'f1-score': 0.4807048065566144, 'support': 233510}, '1': {'precision': 0.8281166699920718, 'recall': 0.7461006048235607, 'f1-score': 0.7849721359688667, 'support': 1051381}, '2': {'precision': 0.5129606552460534, 'recall': 0.4263458282118943, 'f1-score': 0.46565980167810833, 'support': 232682}, 'accuracy': 0.6789518527280072, 'macro avg': {'precision': 0.5767768055618469, 'recall': 0.6002569006011294, 'f1-score': 0.5771122480678632, 'support': 1517573}, 'weighted avg': {'precision': 0.7122671088512925, 'recall': 0.6789518527280072, 'f1-score': 0.6891957241201468, 'support': 1517573}}
[[146720  58756  28034]
 [200789 784436  66156]
 [ 29418 104061  99203]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7626737
{'0': {'precision': 0.42973648032792666, 'recall': 0.6179980736781884, 'f1-score': 0.5069534378081672, 'support': 276174}, '1': {'precision': 0.7723452208791509, 'recall': 0.7315278472690283, 'f1-score': 0.7513826116641087, 'support': 967348}, '2': {'precision': 0.5468886211591392, 'recall': 0.4074679530452361, 'f1-score': 0.4669943981749634, 'support': 274051}, 'accuracy': 0.6523468722756665, 'macro avg': {'precision': 0.5829901074554056, 'recall': 0.5856646246641509, 'f1-score': 0.5751101492157464, 'support': 1517573}, 'weighted avg': {'precision': 0.6692818210144572, 'recall': 0.6523468722756665, 'f1-score': 0.65554415318112, 'support': 1517573}}
[[170675  78463  27036]
 [194223 707642  65483]
 [ 32264 130120 111667]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8472512
{'0': {'precision': 0.4780381853878767, 'recall': 0.5823860599880405, 'f1-score': 0.5250781025158191, 'support': 346169}, '1': {'precision': 0.6705579886529187, 'recall': 0.7127470027844169, 'f1-score': 0.6910091405206438, 'support': 831772}, '2': {'precision': 0.5832140816201231, 'recall': 0.36359353653365994, 'f1-score': 0.44793232844066316, 'support': 339632}, 'accuracy': 0.6048704082110054, 'macro avg': {'precision': 0.5772700852203062, 'recall': 0.5529088664353724, 'f1-score': 0.5546731904923753, 'support': 1517573}, 'weighted avg': {'precision': 0.6070953587762546, 'recall': 0.6048704082110054, 'f1-score': 0.5987586554794364, 'support': 1517573}}
[[201604 116181  28384]
 [179064 592843  59865]
 [ 41064 175080 123488]]
Evaluating performance on  train set...
1254/1254 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6693149
{'0': {'precision': 0.35295740039615875, 'recall': 0.6956758092414134, 'f1-score': 0.46831231910575866, 'support': 40470}, '1': {'precision': 0.8826030247817039, 'recall': 0.7393358604497934, 'f1-score': 0.8046419907732036, 'support': 239799}, '2': {'precision': 0.47956754612180125, 'recall': 0.47519595076046095, 'f1-score': 0.4773717402841028, 'support': 40699}, 'accuracy': 0.7003377283716756, 'macro avg': {'precision': 0.5717093237665546, 'recall': 0.6367358734838892, 'f1-score': 0.5834420167210217, 'support': 320968}, 'weighted avg': {'precision': 0.7647161969207882, 'recall': 0.7003377283716756, 'f1-score': 0.7207369480990511, 'support': 320968}}
[[ 28154   7775   4541]
 [ 46060 177292  16447]
 [  5552  15807  19340]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7266254
{'0': {'precision': 0.4213487794786926, 'recall': 0.6550640471946042, 'f1-score': 0.5128337937384898, 'support': 54413}, '1': {'precision': 0.8070797654963988, 'recall': 0.7338152253970652, 'f1-score': 0.7687057502701661, 'support': 211804}, '2': {'precision': 0.54982190154352, 'recall': 0.4398093185512593, 'f1-score': 0.48870082295757356, 'support': 54751}, 'accuracy': 0.6703129283916154, 'macro avg': {'precision': 0.5927501488395371, 'recall': 0.6095628637143096, 'f1-score': 0.5900801223220765, 'support': 320968}, 'weighted avg': {'precision': 0.6978043690348652, 'recall': 0.6703129283916154, 'f1-score': 0.6775648560188704, 'support': 320968}}
[[ 35644  13528   5241]
 [ 41904 155425  14475]
 [  7047  23624  24080]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.78963095
{'0': {'precision': 0.4567680983797855, 'recall': 0.6248599364533608, 'f1-score': 0.5277527499951384, 'support': 65149}, '1': {'precision': 0.7361897959950812, 'recall': 0.7208985597173071, 'f1-score': 0.7284639418478609, 'support': 190171}, '2': {'precision': 0.5826227999035574, 'recall': 0.40490190104801366, 'f1-score': 0.47777048826738316, 'support': 65648}, 'accuracy': 0.6367737593778819, 'macro avg': {'precision': 0.5918602314261413, 'recall': 0.5835534657395606, 'f1-score': 0.5779957267034609, 'support': 320968}, 'weighted avg': {'precision': 0.64806446780861, 'recall': 0.6367737593778819, 'f1-score': 0.6364496062173176, 'support': 320968}}
[[ 40709  18815   5625]
 [ 39660 137094  13417]
 [  8755  30312  26581]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.89628637
{'0': {'precision': 0.49609775158677355, 'recall': 0.5737334505838096, 'f1-score': 0.5320986605499392, 'support': 81876}, '1': {'precision': 0.6093401942439632, 'recall': 0.7015323459639674, 'f1-score': 0.6521943863288211, 'support': 155970}, '2': {'precision': 0.6139667316049753, 'recall': 0.34502297827290007, 'f1-score': 0.441782905732749, 'support': 83122}, 'accuracy': 0.5766057675531517, 'macro avg': {'precision': 0.5731348924785707, 'recall': 0.5400962582735591, 'f1-score': 0.5420253175371698, 'support': 320968}, 'weighted avg': {'precision': 0.5816512308691781, 'recall': 0.5766057675531517, 'f1-score': 0.5670682032389852, 'support': 320968}}
[[ 46975  28241   6660]
 [ 35180 109418  11372]
 [ 12534  41909  28679]]
Evaluating performance on  val set...
427/427 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.67304677
{'0': {'precision': 0.32282502443792765, 'recall': 0.7139437924644843, 'f1-score': 0.4446100586594865, 'support': 12952}, '1': {'precision': 0.8866940813629021, 'recall': 0.7260450238106692, 'f1-score': 0.7983682213083322, 'support': 83156}, '2': {'precision': 0.474873767732628, 'recall': 0.4521865221704953, 'f1-score': 0.4632525410476936, 'support': 13103}, 'accuracy': 0.6917526622776095, 'macro avg': {'precision': 0.5614642911778193, 'recall': 0.6307251128152161, 'f1-score': 0.5687436070051707, 'support': 109211}, 'weighted avg': {'precision': 0.7704117142497932, 'recall': 0.6917526622776095, 'f1-score': 0.7162071159152581, 'support': 109211}}
[[ 9247  2303  1402]
 [17631 60375  5150]
 [ 1766  5412  5925]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7343026
{'0': {'precision': 0.389069210845546, 'recall': 0.6734960272417707, 'f1-score': 0.49321502046923377, 'support': 17620}, '1': {'precision': 0.8116383554899065, 'recall': 0.7144598548055043, 'f1-score': 0.7599550509998271, 'support': 73832}, '2': {'precision': 0.5426447003936434, 'recall': 0.4191677459316403, 'f1-score': 0.47298027130920994, 'support': 17759}, 'accuracy': 0.6598328007252017, 'macro avg': {'precision': 0.581117422243032, 'recall': 0.6023745426596384, 'f1-score': 0.575383447592757, 'support': 109211}, 'weighted avg': {'precision': 0.6997198981047698, 'recall': 0.6598328007252017, 'f1-score': 0.6702539728073855, 'support': 109211}}
[[11867  4141  1612]
 [16420 52750  4662]
 [ 2214  8101  7444]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8011698
{'0': {'precision': 0.4273870517000466, 'recall': 0.6432978126752664, 'f1-score': 0.5135725079755975, 'support': 21396}, '1': {'precision': 0.7375568499162212, 'recall': 0.6971507006350212, 'f1-score': 0.7167847893177834, 'support': 66297}, '2': {'precision': 0.5782720870232201, 'recall': 0.3853982712147969, 'f1-score': 0.4625338129897654, 'support': 21518}, 'accuracy': 0.6251751197223723, 'macro avg': {'precision': 0.5810719962131626, 'recall': 0.5752822615083615, 'f1-score': 0.5642970367610488, 'support': 109211}, 'weighted avg': {'precision': 0.6454060360736149, 'recall': 0.6251751197223723, 'f1-score': 0.626877156568118, 'support': 109211}}
[[13764  5939  1693]
 [15723 46219  4355]
 [ 2718 10507  8293]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.91251403
{'0': {'precision': 0.46697660903675725, 'recall': 0.5882503660322108, 'f1-score': 0.5206446910180611, 'support': 27320}, '1': {'precision': 0.6034784055920779, 'recall': 0.6681038453743113, 'f1-score': 0.6341489008202312, 'support': 54273}, '2': {'precision': 0.6132146013187411, 'recall': 0.32663480338909406, 'f1-score': 0.4262326064872782, 'support': 27618}, 'accuracy': 0.5617749127835108, 'macro avg': {'precision': 0.5612232053158587, 'recall': 0.527663004931872, 'f1-score': 0.5270087327751901, 'support': 109211}, 'weighted avg': {'precision': 0.5717935494117263, 'recall': 0.5617749127835108, 'f1-score': 0.5531756725860534, 'support': 109211}}
[[16071  9228  2021]
 [14344 36260  3669]
 [ 4000 14597  9021]]
training model: results/EXC/W7/deepVOL_L3/seq2seq
Epoch 1/50
1254/1254 - 65s - loss: 11.0016 - accuracy10: 0.5257 - accuracy20: 0.5314 - accuracy30: 0.5280 - accuracy50: 0.5142 - val_loss: 10.5983 - val_accuracy10: 0.6240 - val_accuracy20: 0.6125 - val_accuracy30: 0.5888 - val_accuracy50: 0.5433 - 65s/epoch - 52ms/step
Epoch 2/50
1254/1254 - 55s - loss: 9.8831 - accuracy10: 0.6173 - accuracy20: 0.6103 - accuracy30: 0.5930 - accuracy50: 0.5623 - val_loss: 10.4427 - val_accuracy10: 0.6327 - val_accuracy20: 0.6193 - val_accuracy30: 0.5952 - val_accuracy50: 0.5485 - 55s/epoch - 44ms/step
Epoch 3/50
1254/1254 - 56s - loss: 9.6247 - accuracy10: 0.6321 - accuracy20: 0.6238 - accuracy30: 0.6052 - accuracy50: 0.5714 - val_loss: 10.4746 - val_accuracy10: 0.6489 - val_accuracy20: 0.6299 - val_accuracy30: 0.6030 - val_accuracy50: 0.5519 - 56s/epoch - 45ms/step
Epoch 4/50
1254/1254 - 56s - loss: 9.4823 - accuracy10: 0.6387 - accuracy20: 0.6288 - accuracy30: 0.6084 - accuracy50: 0.5754 - val_loss: 10.2301 - val_accuracy10: 0.6506 - val_accuracy20: 0.6330 - val_accuracy30: 0.6078 - val_accuracy50: 0.5571 - 56s/epoch - 44ms/step
Epoch 5/50
1254/1254 - 55s - loss: 9.3752 - accuracy10: 0.6435 - accuracy20: 0.6326 - accuracy30: 0.6117 - accuracy50: 0.5769 - val_loss: 10.1090 - val_accuracy10: 0.6659 - val_accuracy20: 0.6454 - val_accuracy30: 0.6165 - val_accuracy50: 0.5605 - 55s/epoch - 44ms/step
Epoch 6/50
1254/1254 - 56s - loss: 9.3212 - accuracy10: 0.6447 - accuracy20: 0.6340 - accuracy30: 0.6121 - accuracy50: 0.5773 - val_loss: 9.9801 - val_accuracy10: 0.6643 - val_accuracy20: 0.6450 - val_accuracy30: 0.6158 - val_accuracy50: 0.5614 - 56s/epoch - 45ms/step
Epoch 7/50
1254/1254 - 56s - loss: 9.2699 - accuracy10: 0.6458 - accuracy20: 0.6358 - accuracy30: 0.6140 - accuracy50: 0.5789 - val_loss: 9.9199 - val_accuracy10: 0.6538 - val_accuracy20: 0.6367 - val_accuracy30: 0.6086 - val_accuracy50: 0.5580 - 56s/epoch - 45ms/step
Epoch 8/50
1254/1254 - 55s - loss: 9.2123 - accuracy10: 0.6488 - accuracy20: 0.6369 - accuracy30: 0.6151 - accuracy50: 0.5800 - val_loss: 9.8643 - val_accuracy10: 0.6432 - val_accuracy20: 0.6278 - val_accuracy30: 0.6026 - val_accuracy50: 0.5544 - 55s/epoch - 44ms/step
Epoch 9/50
1254/1254 - 56s - loss: 9.1782 - accuracy10: 0.6514 - accuracy20: 0.6389 - accuracy30: 0.6162 - accuracy50: 0.5812 - val_loss: 9.8122 - val_accuracy10: 0.6393 - val_accuracy20: 0.6241 - val_accuracy30: 0.5986 - val_accuracy50: 0.5533 - 56s/epoch - 45ms/step
Epoch 10/50
1254/1254 - 55s - loss: 9.1436 - accuracy10: 0.6515 - accuracy20: 0.6395 - accuracy30: 0.6174 - accuracy50: 0.5828 - val_loss: 9.8296 - val_accuracy10: 0.6290 - val_accuracy20: 0.6163 - val_accuracy30: 0.5933 - val_accuracy50: 0.5507 - 55s/epoch - 44ms/step
Epoch 11/50
1254/1254 - 55s - loss: 9.1165 - accuracy10: 0.6527 - accuracy20: 0.6389 - accuracy30: 0.6167 - accuracy50: 0.5836 - val_loss: 9.8465 - val_accuracy10: 0.6423 - val_accuracy20: 0.6238 - val_accuracy30: 0.5975 - val_accuracy50: 0.5501 - 55s/epoch - 44ms/step
Epoch 12/50
1254/1254 - 56s - loss: 9.0904 - accuracy10: 0.6534 - accuracy20: 0.6400 - accuracy30: 0.6181 - accuracy50: 0.5843 - val_loss: 9.8079 - val_accuracy10: 0.6472 - val_accuracy20: 0.6287 - val_accuracy30: 0.6012 - val_accuracy50: 0.5536 - 56s/epoch - 45ms/step
Epoch 13/50
1254/1254 - 55s - loss: 9.0635 - accuracy10: 0.6549 - accuracy20: 0.6410 - accuracy30: 0.6189 - accuracy50: 0.5860 - val_loss: 9.7846 - val_accuracy10: 0.6506 - val_accuracy20: 0.6313 - val_accuracy30: 0.6034 - val_accuracy50: 0.5557 - 55s/epoch - 44ms/step
Epoch 14/50
1254/1254 - 55s - loss: 9.0433 - accuracy10: 0.6556 - accuracy20: 0.6415 - accuracy30: 0.6192 - accuracy50: 0.5852 - val_loss: 9.7946 - val_accuracy10: 0.6442 - val_accuracy20: 0.6246 - val_accuracy30: 0.5980 - val_accuracy50: 0.5506 - 55s/epoch - 44ms/step
Epoch 15/50
1254/1254 - 56s - loss: 9.0220 - accuracy10: 0.6569 - accuracy20: 0.6426 - accuracy30: 0.6204 - accuracy50: 0.5869 - val_loss: 9.7972 - val_accuracy10: 0.6457 - val_accuracy20: 0.6271 - val_accuracy30: 0.6002 - val_accuracy50: 0.5537 - 56s/epoch - 44ms/step
Epoch 16/50
1254/1254 - 55s - loss: 8.9984 - accuracy10: 0.6567 - accuracy20: 0.6417 - accuracy30: 0.6195 - accuracy50: 0.5880 - val_loss: 9.7762 - val_accuracy10: 0.6447 - val_accuracy20: 0.6252 - val_accuracy30: 0.5992 - val_accuracy50: 0.5519 - 55s/epoch - 43ms/step
Epoch 17/50
1254/1254 - 55s - loss: 8.9767 - accuracy10: 0.6581 - accuracy20: 0.6436 - accuracy30: 0.6214 - accuracy50: 0.5882 - val_loss: 9.8498 - val_accuracy10: 0.6458 - val_accuracy20: 0.6244 - val_accuracy30: 0.5982 - val_accuracy50: 0.5498 - 55s/epoch - 44ms/step
Epoch 18/50
1254/1254 - 55s - loss: 8.9595 - accuracy10: 0.6586 - accuracy20: 0.6439 - accuracy30: 0.6209 - accuracy50: 0.5896 - val_loss: 9.8429 - val_accuracy10: 0.6449 - val_accuracy20: 0.6250 - val_accuracy30: 0.5983 - val_accuracy50: 0.5518 - 55s/epoch - 44ms/step
Epoch 19/50
1254/1254 - 56s - loss: 8.9396 - accuracy10: 0.6589 - accuracy20: 0.6437 - accuracy30: 0.6216 - accuracy50: 0.5896 - val_loss: 9.8369 - val_accuracy10: 0.6543 - val_accuracy20: 0.6328 - val_accuracy30: 0.6058 - val_accuracy50: 0.5551 - 56s/epoch - 45ms/step
Epoch 20/50
1254/1254 - 55s - loss: 8.9232 - accuracy10: 0.6595 - accuracy20: 0.6446 - accuracy30: 0.6227 - accuracy50: 0.5905 - val_loss: 9.8144 - val_accuracy10: 0.6554 - val_accuracy20: 0.6330 - val_accuracy30: 0.6049 - val_accuracy50: 0.5538 - 55s/epoch - 44ms/step
Epoch 21/50
1254/1254 - 55s - loss: 8.9047 - accuracy10: 0.6608 - accuracy20: 0.6464 - accuracy30: 0.6241 - accuracy50: 0.5913 - val_loss: 9.7788 - val_accuracy10: 0.6520 - val_accuracy20: 0.6295 - val_accuracy30: 0.6008 - val_accuracy50: 0.5522 - 55s/epoch - 44ms/step
Epoch 22/50
1254/1254 - 56s - loss: 8.8853 - accuracy10: 0.6611 - accuracy20: 0.6459 - accuracy30: 0.6243 - accuracy50: 0.5922 - val_loss: 9.7845 - val_accuracy10: 0.6471 - val_accuracy20: 0.6274 - val_accuracy30: 0.6006 - val_accuracy50: 0.5527 - 56s/epoch - 44ms/step
Epoch 23/50
1254/1254 - 56s - loss: 8.8659 - accuracy10: 0.6613 - accuracy20: 0.6465 - accuracy30: 0.6245 - accuracy50: 0.5930 - val_loss: 9.7712 - val_accuracy10: 0.6527 - val_accuracy20: 0.6305 - val_accuracy30: 0.6018 - val_accuracy50: 0.5541 - 56s/epoch - 44ms/step
Epoch 24/50
1254/1254 - 56s - loss: 8.8470 - accuracy10: 0.6626 - accuracy20: 0.6479 - accuracy30: 0.6257 - accuracy50: 0.5930 - val_loss: 9.7137 - val_accuracy10: 0.6489 - val_accuracy20: 0.6285 - val_accuracy30: 0.5998 - val_accuracy50: 0.5531 - 56s/epoch - 45ms/step
Epoch 25/50
1254/1254 - 54s - loss: 8.8338 - accuracy10: 0.6621 - accuracy20: 0.6472 - accuracy30: 0.6250 - accuracy50: 0.5937 - val_loss: 9.7626 - val_accuracy10: 0.6409 - val_accuracy20: 0.6198 - val_accuracy30: 0.5922 - val_accuracy50: 0.5471 - 54s/epoch - 43ms/step
Epoch 26/50
1254/1254 - 56s - loss: 8.8123 - accuracy10: 0.6625 - accuracy20: 0.6475 - accuracy30: 0.6262 - accuracy50: 0.5943 - val_loss: 9.7660 - val_accuracy10: 0.6570 - val_accuracy20: 0.6336 - val_accuracy30: 0.6036 - val_accuracy50: 0.5555 - 56s/epoch - 45ms/step
Epoch 27/50
1254/1254 - 57s - loss: 8.7904 - accuracy10: 0.6634 - accuracy20: 0.6490 - accuracy30: 0.6263 - accuracy50: 0.5949 - val_loss: 9.8108 - val_accuracy10: 0.6450 - val_accuracy20: 0.6224 - val_accuracy30: 0.5940 - val_accuracy50: 0.5477 - 57s/epoch - 45ms/step
Epoch 28/50
1254/1254 - 56s - loss: 8.7850 - accuracy10: 0.6639 - accuracy20: 0.6488 - accuracy30: 0.6267 - accuracy50: 0.5958 - val_loss: 9.7890 - val_accuracy10: 0.6441 - val_accuracy20: 0.6224 - val_accuracy30: 0.5919 - val_accuracy50: 0.5459 - 56s/epoch - 45ms/step
Epoch 29/50
1254/1254 - 56s - loss: 8.7696 - accuracy10: 0.6639 - accuracy20: 0.6495 - accuracy30: 0.6268 - accuracy50: 0.5952 - val_loss: 9.8155 - val_accuracy10: 0.6482 - val_accuracy20: 0.6239 - val_accuracy30: 0.5945 - val_accuracy50: 0.5481 - 56s/epoch - 45ms/step
Epoch 30/50
1254/1254 - 55s - loss: 8.7485 - accuracy10: 0.6645 - accuracy20: 0.6503 - accuracy30: 0.6284 - accuracy50: 0.5971 - val_loss: 9.9270 - val_accuracy10: 0.6501 - val_accuracy20: 0.6253 - val_accuracy30: 0.5948 - val_accuracy50: 0.5458 - 55s/epoch - 44ms/step
Epoch 31/50
1254/1254 - 55s - loss: 8.7303 - accuracy10: 0.6644 - accuracy20: 0.6500 - accuracy30: 0.6291 - accuracy50: 0.5977 - val_loss: 9.9059 - val_accuracy10: 0.6558 - val_accuracy20: 0.6308 - val_accuracy30: 0.5994 - val_accuracy50: 0.5494 - 55s/epoch - 44ms/step
Epoch 32/50
1254/1254 - 56s - loss: 8.7039 - accuracy10: 0.6659 - accuracy20: 0.6516 - accuracy30: 0.6299 - accuracy50: 0.5987 - val_loss: 9.8924 - val_accuracy10: 0.6482 - val_accuracy20: 0.6240 - val_accuracy30: 0.5933 - val_accuracy50: 0.5475 - 56s/epoch - 44ms/step
Epoch 33/50
1254/1254 - 55s - loss: 8.6927 - accuracy10: 0.6669 - accuracy20: 0.6523 - accuracy30: 0.6306 - accuracy50: 0.5993 - val_loss: 9.9099 - val_accuracy10: 0.6607 - val_accuracy20: 0.6328 - val_accuracy30: 0.5999 - val_accuracy50: 0.5501 - 55s/epoch - 44ms/step
Epoch 34/50
1254/1254 - 55s - loss: 8.6710 - accuracy10: 0.6655 - accuracy20: 0.6517 - accuracy30: 0.6300 - accuracy50: 0.5996 - val_loss: 9.9495 - val_accuracy10: 0.6605 - val_accuracy20: 0.6337 - val_accuracy30: 0.6014 - val_accuracy50: 0.5510 - 55s/epoch - 44ms/step
testing model: results/EXC/W7/deepVOL_L3/seq2seq
Evaluating performance on  test set...
5929/5929 - 115s - 115s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7424398
{'0': {'precision': 0.29411894868831906, 'recall': 0.6774164321349091, 'f1-score': 0.4101569799236444, 'support': 176593}, '1': {'precision': 0.9138965535961705, 'recall': 0.6638971456300524, 'f1-score': 0.7690908052569765, 'support': 1166387}, '2': {'precision': 0.37578218385352435, 'recall': 0.5671934155435785, 'f1-score': 0.4520608603161706, 'support': 174593}, 'accuracy': 0.6543447992287685, 'macro avg': {'precision': 0.5279325620460047, 'recall': 0.6361689977695134, 'f1-score': 0.5437695484989306, 'support': 1517573}, 'weighted avg': {'precision': 0.7798671601238499, 'recall': 0.6543447992287685, 'f1-score': 0.6908498177103218, 'support': 1517573}}
[[119627  25224  31742]
 [259271 774361 132755]
 [ 27832  47733  99028]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7652967
{'0': {'precision': 0.3635615927087245, 'recall': 0.6757954691447904, 'f1-score': 0.4727793481663903, 'support': 233510}, '1': {'precision': 0.8575442100507707, 'recall': 0.651760874506958, 'f1-score': 0.7406239732304978, 'support': 1051381}, '2': {'precision': 0.44423545459978836, 'recall': 0.5430458737676314, 'f1-score': 0.4886960254796284, 'support': 232682}, 'accuracy': 0.6387903580256107, 'macro avg': {'precision': 0.5551137524530946, 'recall': 0.6235340724731265, 'f1-score': 0.5673664489588388, 'support': 1517573}, 'weighted avg': {'precision': 0.7181641678311301, 'recall': 0.6387903580256107, 'f1-score': 0.660783664304807, 'support': 1517573}}
[[157805  41648  34057]
 [242109 685249 124023]
 [ 34139  72186 126357]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8000527
{'0': {'precision': 0.40314945184281076, 'recall': 0.6697552991954348, 'f1-score': 0.5033279636019288, 'support': 276174}, '1': {'precision': 0.8064368688165925, 'recall': 0.6329035672787869, 'f1-score': 0.7092092437057531, 'support': 967348}, '2': {'precision': 0.47804549126426193, 'recall': 0.5225669674622607, 'f1-score': 0.4993157550664633, 'support': 274051}, 'accuracy': 0.6196848520631297, 'macro avg': {'precision': 0.5625439373078884, 'recall': 0.6084086113121608, 'f1-score': 0.5706176541247151, 'support': 1517573}, 'weighted avg': {'precision': 0.6737424386277905, 'recall': 0.6196848520631297, 'f1-score': 0.6338385188006055, 'support': 1517573}}
[[184969  55652  35553]
 [234299 612238 120811]
 [ 39542  91299 143210]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8621271
{'0': {'precision': 0.45428082049059404, 'recall': 0.629787762624614, 'f1-score': 0.5278273090765148, 'support': 346169}, '1': {'precision': 0.7068200049791153, 'recall': 0.6144051494880809, 'f1-score': 0.6573805370750557, 'support': 831772}, '2': {'precision': 0.5129717618268207, 'recall': 0.4752320158288972, 'f1-score': 0.49338124372398845, 'support': 339632}, 'accuracy': 0.5867671604594968, 'macro avg': {'precision': 0.55802419576551, 'recall': 0.5731416426471974, 'f1-score': 0.5595296966251863, 'support': 1517573}, 'weighted avg': {'precision': 0.6058309234169718, 'recall': 0.5867671604594968, 'f1-score': 0.5911255896145798, 'support': 1517573}}
[[218013  86212  41944]
 [209430 511045 111297]
 [ 52465 125763 161404]]
Evaluating performance on  train set...
1254/1254 - 26s - 26s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.74599016
{'0': {'precision': 0.32486018227293706, 'recall': 0.7477884852977514, 'f1-score': 0.45294738338808765, 'support': 40470}, '1': {'precision': 0.9142537241940892, 'recall': 0.6367624552229159, 'f1-score': 0.7506852008898395, 'support': 239799}, '2': {'precision': 0.4141623488773748, 'recall': 0.6186638492346249, 'f1-score': 0.49616726111888393, 'support': 40699}, 'accuracy': 0.6484665137957678, 'macro avg': {'precision': 0.5510920851148003, 'recall': 0.667738263251764, 'f1-score': 0.5665999484656037, 'support': 320968}, 'weighted avg': {'precision': 0.7765266750005123, 'recall': 0.6484665137957678, 'f1-score': 0.6808711536794196, 'support': 320968}}
[[ 30263   4520   5687]
 [ 57175 152695  29929]
 [  5719   9801  25179]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7680606
{'0': {'precision': 0.3936820962293436, 'recall': 0.713211916270009, 'f1-score': 0.5073272762925681, 'support': 54413}, '1': {'precision': 0.8475721680586872, 'recall': 0.6300447583615041, 'f1-score': 0.7227968119074121, 'support': 211804}, '2': {'precision': 0.485464847719644, 'recall': 0.5758616280981169, 'f1-score': 0.52681353751556, 'support': 54751}, 'accuracy': 0.6349012985718202, 'macro avg': {'precision': 0.5755730373358915, 'recall': 0.6397061009098767, 'f1-score': 0.5856458752385134, 'support': 320968}, 'weighted avg': {'precision': 0.7088566002315736, 'recall': 0.6349012985718202, 'f1-score': 0.6528377378014614, 'support': 320968}}
[[ 38808   8472   7133]
 [ 52074 133446  26284]
 [  7695  15527  31529]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8125931
{'0': {'precision': 0.42906653682009566, 'recall': 0.6898033738046632, 'f1-score': 0.5290544358636278, 'support': 65149}, '1': {'precision': 0.7824117885629309, 'recall': 0.6086627298589165, 'f1-score': 0.6846863899725237, 'support': 190171}, '2': {'precision': 0.5190879936739445, 'recall': 0.5399707531074823, 'f1-score': 0.5293234879084944, 'support': 65648}, 'accuracy': 0.6110827247576083, 'macro avg': {'precision': 0.576855439685657, 'recall': 0.612812285590354, 'f1-score': 0.5810214379148819, 'support': 320968}, 'weighted avg': {'precision': 0.6568330072119359, 'recall': 0.6110827247576083, 'f1-score': 0.6213201666326897, 'support': 320968}}
[[ 44940  12032   8177]
 [ 49757 115750  24664]
 [ 10042  20158  35448]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.88714683
{'0': {'precision': 0.4719441588658622, 'recall': 0.63916165909424, 'f1-score': 0.5429700874653717, 'support': 81876}, '1': {'precision': 0.6583721873099534, 'recall': 0.5830416105661345, 'f1-score': 0.6184213210742142, 'support': 155970}, '2': {'precision': 0.5539898273993162, 'recall': 0.47958422559611175, 'f1-score': 0.5141088470466856, 'support': 83122}, 'accuracy': 0.5705646668826799, 'macro avg': {'precision': 0.5614353911917106, 'recall': 0.5672624984188287, 'f1-score': 0.5585000851954237, 'support': 320968}, 'weighted avg': {'precision': 0.5837839050594474, 'recall': 0.5705646668826799, 'f1-score': 0.5721603023151047, 'support': 320968}}
[[52332 18919 10625]
 [43564 90937 21469]
 [14990 28268 39864]]
Evaluating performance on  val set...
427/427 - 8s - 8s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7407061
{'0': {'precision': 0.2986842105263158, 'recall': 0.7536287831995059, 'f1-score': 0.42781381486676007, 'support': 12952}, '1': {'precision': 0.9109667297624529, 'recall': 0.6424070421857713, 'f1-score': 0.753471512091229, 'support': 83156}, '2': {'precision': 0.4277808831749581, 'recall': 0.5840647180035107, 'f1-score': 0.49385345077920817, 'support': 13103}, 'accuracy': 0.6485976687330031, 'macro avg': {'precision': 0.5458106078212422, 'recall': 0.6600335144629293, 'f1-score': 0.5583795925790658, 'support': 109211}, 'weighted avg': {'precision': 0.7803803663285278, 'recall': 0.6485976687330031, 'f1-score': 0.6837011231027322, 'support': 109211}}
[[ 9761  1579  1612]
 [21111 53420  8625]
 [ 1808  3642  7653]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7758574
{'0': {'precision': 0.36395037563685556, 'recall': 0.7175936435868332, 'f1-score': 0.48295487099176865, 'support': 17620}, '1': {'precision': 0.8408967342056617, 'recall': 0.6284402427131867, 'f1-score': 0.7193085807301759, 'support': 73832}, '2': {'precision': 0.49372797014306447, 'recall': 0.5363477673292415, 'f1-score': 0.5141561631265013, 'support': 17759}, 'accuracy': 0.627848843065259, 'macro avg': {'precision': 0.5661916933285273, 'recall': 0.6274605512097539, 'f1-score': 0.5721398716161487, 'support': 109211}, 'weighted avg': {'precision': 0.7074929111569759, 'recall': 0.627848843065259, 'f1-score': 0.6478152865582115, 'support': 109211}}
[[12644  3008  1968]
 [19634 46399  7799]
 [ 2463  5771  9525]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.82689935
{'0': {'precision': 0.40106501480696605, 'recall': 0.6899420452421013, 'f1-score': 0.5072590759926464, 'support': 21396}, '1': {'precision': 0.7708730755149623, 'recall': 0.6034360529134049, 'f1-score': 0.6769548369629592, 'support': 66297}, '2': {'precision': 0.5254791046959575, 'recall': 0.500790036248722, 'f1-score': 0.5128375966686496, 'support': 21518}, 'accuracy': 0.6001593246101583, 'macro avg': {'precision': 0.5658057316726286, 'recall': 0.5980560448014094, 'f1-score': 0.5656838365414184, 'support': 109211}, 'weighted avg': {'precision': 0.6500720506091229, 'recall': 0.6001593246101583, 'f1-score': 0.6113727501917203, 'support': 109211}}
[[14762  4346  2288]
 [18848 40006  7443]
 [ 3197  7545 10776]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.91001636
{'0': {'precision': 0.44533237402677495, 'recall': 0.6343704245973646, 'f1-score': 0.5233026858100458, 'support': 27320}, '1': {'precision': 0.6384406388934629, 'recall': 0.5715180660733699, 'f1-score': 0.6031286154564105, 'support': 54273}, '2': {'precision': 0.5561953017042838, 'recall': 0.4372148598739952, 'f1-score': 0.48957995458968534, 'support': 27618}, 'accuracy': 0.5532776002417339, 'macro avg': {'precision': 0.5466561048748405, 'recall': 0.5477011168482432, 'f1-score': 0.5386704186187139, 'support': 109211}, 'weighted avg': {'precision': 0.5693343261717714, 'recall': 0.5532776002417339, 'f1-score': 0.5544445880804512, 'support': 109211}}
[[17331  6889  3100]
 [16720 31018  6535]
 [ 4866 10677 12075]]
training model: results/EXC/W8/deepLOB_L1/seq2seq
Epoch 1/50
1289/1289 - 42s - loss: 10.8118 - accuracy10: 0.4771 - accuracy20: 0.4915 - accuracy30: 0.4987 - accuracy50: 0.5049 - val_loss: 10.3121 - val_accuracy10: 0.6707 - val_accuracy20: 0.6432 - val_accuracy30: 0.6174 - val_accuracy50: 0.5749 - 42s/epoch - 33ms/step
Epoch 2/50
1289/1289 - 34s - loss: 10.1612 - accuracy10: 0.5649 - accuracy20: 0.5648 - accuracy30: 0.5594 - accuracy50: 0.5503 - val_loss: 9.6088 - val_accuracy10: 0.5840 - val_accuracy20: 0.5751 - val_accuracy30: 0.5649 - val_accuracy50: 0.5486 - 34s/epoch - 26ms/step
Epoch 3/50
1289/1289 - 34s - loss: 9.8094 - accuracy10: 0.6086 - accuracy20: 0.5989 - accuracy30: 0.5843 - accuracy50: 0.5674 - val_loss: 9.2497 - val_accuracy10: 0.5945 - val_accuracy20: 0.5835 - val_accuracy30: 0.5704 - val_accuracy50: 0.5519 - 34s/epoch - 26ms/step
Epoch 4/50
1289/1289 - 34s - loss: 9.5535 - accuracy10: 0.6321 - accuracy20: 0.6169 - accuracy30: 0.5974 - accuracy50: 0.5754 - val_loss: 9.2409 - val_accuracy10: 0.6071 - val_accuracy20: 0.5897 - val_accuracy30: 0.5717 - val_accuracy50: 0.5510 - 34s/epoch - 26ms/step
Epoch 5/50
1289/1289 - 34s - loss: 9.4126 - accuracy10: 0.6415 - accuracy20: 0.6235 - accuracy30: 0.6022 - accuracy50: 0.5799 - val_loss: 9.0437 - val_accuracy10: 0.5897 - val_accuracy20: 0.5701 - val_accuracy30: 0.5503 - val_accuracy50: 0.5363 - 34s/epoch - 26ms/step
Epoch 6/50
1289/1289 - 34s - loss: 9.2759 - accuracy10: 0.6502 - accuracy20: 0.6283 - accuracy30: 0.6059 - accuracy50: 0.5817 - val_loss: 8.9109 - val_accuracy10: 0.5702 - val_accuracy20: 0.5544 - val_accuracy30: 0.5407 - val_accuracy50: 0.5293 - 34s/epoch - 26ms/step
Epoch 7/50
1289/1289 - 34s - loss: 9.1946 - accuracy10: 0.6534 - accuracy20: 0.6313 - accuracy30: 0.6090 - accuracy50: 0.5851 - val_loss: 8.8494 - val_accuracy10: 0.5977 - val_accuracy20: 0.5761 - val_accuracy30: 0.5580 - val_accuracy50: 0.5417 - 34s/epoch - 26ms/step
Epoch 8/50
1289/1289 - 34s - loss: 9.1294 - accuracy10: 0.6550 - accuracy20: 0.6329 - accuracy30: 0.6104 - accuracy50: 0.5856 - val_loss: 8.9061 - val_accuracy10: 0.5910 - val_accuracy20: 0.5712 - val_accuracy30: 0.5552 - val_accuracy50: 0.5406 - 34s/epoch - 27ms/step
Epoch 9/50
1289/1289 - 34s - loss: 9.0723 - accuracy10: 0.6586 - accuracy20: 0.6358 - accuracy30: 0.6141 - accuracy50: 0.5887 - val_loss: 8.7816 - val_accuracy10: 0.6107 - val_accuracy20: 0.5932 - val_accuracy30: 0.5756 - val_accuracy50: 0.5572 - 34s/epoch - 26ms/step
Epoch 10/50
1289/1289 - 34s - loss: 9.0318 - accuracy10: 0.6606 - accuracy20: 0.6380 - accuracy30: 0.6157 - accuracy50: 0.5896 - val_loss: 8.8231 - val_accuracy10: 0.5985 - val_accuracy20: 0.5799 - val_accuracy30: 0.5634 - val_accuracy50: 0.5464 - 34s/epoch - 26ms/step
Epoch 11/50
1289/1289 - 34s - loss: 8.9875 - accuracy10: 0.6626 - accuracy20: 0.6387 - accuracy30: 0.6167 - accuracy50: 0.5906 - val_loss: 8.8010 - val_accuracy10: 0.6122 - val_accuracy20: 0.5959 - val_accuracy30: 0.5797 - val_accuracy50: 0.5596 - 34s/epoch - 26ms/step
Epoch 12/50
1289/1289 - 34s - loss: 8.9445 - accuracy10: 0.6645 - accuracy20: 0.6408 - accuracy30: 0.6192 - accuracy50: 0.5919 - val_loss: 8.8391 - val_accuracy10: 0.6015 - val_accuracy20: 0.5815 - val_accuracy30: 0.5652 - val_accuracy50: 0.5462 - 34s/epoch - 26ms/step
Epoch 13/50
1289/1289 - 34s - loss: 8.9201 - accuracy10: 0.6650 - accuracy20: 0.6420 - accuracy30: 0.6202 - accuracy50: 0.5929 - val_loss: 8.8996 - val_accuracy10: 0.6016 - val_accuracy20: 0.5856 - val_accuracy30: 0.5701 - val_accuracy50: 0.5518 - 34s/epoch - 26ms/step
Epoch 14/50
1289/1289 - 34s - loss: 8.8909 - accuracy10: 0.6660 - accuracy20: 0.6432 - accuracy30: 0.6216 - accuracy50: 0.5941 - val_loss: 8.7060 - val_accuracy10: 0.6338 - val_accuracy20: 0.6154 - val_accuracy30: 0.5992 - val_accuracy50: 0.5760 - 34s/epoch - 26ms/step
Epoch 15/50
1289/1289 - 34s - loss: 8.8627 - accuracy10: 0.6677 - accuracy20: 0.6451 - accuracy30: 0.6240 - accuracy50: 0.5961 - val_loss: 8.9393 - val_accuracy10: 0.5988 - val_accuracy20: 0.5857 - val_accuracy30: 0.5733 - val_accuracy50: 0.5573 - 34s/epoch - 26ms/step
Epoch 16/50
1289/1289 - 34s - loss: 8.8424 - accuracy10: 0.6676 - accuracy20: 0.6453 - accuracy30: 0.6251 - accuracy50: 0.5973 - val_loss: 8.9017 - val_accuracy10: 0.6049 - val_accuracy20: 0.5911 - val_accuracy30: 0.5771 - val_accuracy50: 0.5600 - 34s/epoch - 26ms/step
Epoch 17/50
1289/1289 - 34s - loss: 8.8263 - accuracy10: 0.6684 - accuracy20: 0.6452 - accuracy30: 0.6243 - accuracy50: 0.5968 - val_loss: 8.8590 - val_accuracy10: 0.6113 - val_accuracy20: 0.5951 - val_accuracy30: 0.5811 - val_accuracy50: 0.5638 - 34s/epoch - 26ms/step
Epoch 18/50
1289/1289 - 34s - loss: 8.7975 - accuracy10: 0.6692 - accuracy20: 0.6467 - accuracy30: 0.6257 - accuracy50: 0.5982 - val_loss: 8.8265 - val_accuracy10: 0.6109 - val_accuracy20: 0.5936 - val_accuracy30: 0.5787 - val_accuracy50: 0.5615 - 34s/epoch - 26ms/step
Epoch 19/50
1289/1289 - 34s - loss: 8.7715 - accuracy10: 0.6690 - accuracy20: 0.6478 - accuracy30: 0.6275 - accuracy50: 0.5992 - val_loss: 8.8845 - val_accuracy10: 0.6095 - val_accuracy20: 0.5950 - val_accuracy30: 0.5822 - val_accuracy50: 0.5646 - 34s/epoch - 26ms/step
Epoch 20/50
1289/1289 - 34s - loss: 8.7608 - accuracy10: 0.6697 - accuracy20: 0.6477 - accuracy30: 0.6273 - accuracy50: 0.5996 - val_loss: 8.8994 - val_accuracy10: 0.6127 - val_accuracy20: 0.5976 - val_accuracy30: 0.5837 - val_accuracy50: 0.5640 - 34s/epoch - 27ms/step
Epoch 21/50
1289/1289 - 34s - loss: 8.7406 - accuracy10: 0.6703 - accuracy20: 0.6480 - accuracy30: 0.6276 - accuracy50: 0.6002 - val_loss: 8.6457 - val_accuracy10: 0.6463 - val_accuracy20: 0.6265 - val_accuracy30: 0.6086 - val_accuracy50: 0.5834 - 34s/epoch - 26ms/step
Epoch 22/50
1289/1289 - 34s - loss: 8.7234 - accuracy10: 0.6699 - accuracy20: 0.6493 - accuracy30: 0.6287 - accuracy50: 0.6010 - val_loss: 8.7763 - val_accuracy10: 0.6282 - val_accuracy20: 0.6100 - val_accuracy30: 0.5933 - val_accuracy50: 0.5700 - 34s/epoch - 26ms/step
Epoch 23/50
1289/1289 - 34s - loss: 8.7135 - accuracy10: 0.6700 - accuracy20: 0.6493 - accuracy30: 0.6289 - accuracy50: 0.6011 - val_loss: 8.7367 - val_accuracy10: 0.6416 - val_accuracy20: 0.6188 - val_accuracy30: 0.5990 - val_accuracy50: 0.5737 - 34s/epoch - 27ms/step
Epoch 24/50
1289/1289 - 34s - loss: 8.6907 - accuracy10: 0.6703 - accuracy20: 0.6498 - accuracy30: 0.6299 - accuracy50: 0.6024 - val_loss: 8.9152 - val_accuracy10: 0.6198 - val_accuracy20: 0.6002 - val_accuracy30: 0.5827 - val_accuracy50: 0.5620 - 34s/epoch - 26ms/step
Epoch 25/50
1289/1289 - 34s - loss: 8.6760 - accuracy10: 0.6711 - accuracy20: 0.6501 - accuracy30: 0.6298 - accuracy50: 0.6016 - val_loss: 8.8915 - val_accuracy10: 0.6316 - val_accuracy20: 0.6109 - val_accuracy30: 0.5919 - val_accuracy50: 0.5693 - 34s/epoch - 26ms/step
Epoch 26/50
1289/1289 - 34s - loss: 8.6615 - accuracy10: 0.6702 - accuracy20: 0.6505 - accuracy30: 0.6306 - accuracy50: 0.6031 - val_loss: 8.8392 - val_accuracy10: 0.6210 - val_accuracy20: 0.6023 - val_accuracy30: 0.5863 - val_accuracy50: 0.5660 - 34s/epoch - 26ms/step
Epoch 27/50
1289/1289 - 34s - loss: 8.6429 - accuracy10: 0.6708 - accuracy20: 0.6505 - accuracy30: 0.6303 - accuracy50: 0.6032 - val_loss: 8.7700 - val_accuracy10: 0.6519 - val_accuracy20: 0.6269 - val_accuracy30: 0.6037 - val_accuracy50: 0.5765 - 34s/epoch - 26ms/step
Epoch 28/50
1289/1289 - 34s - loss: 8.6296 - accuracy10: 0.6714 - accuracy20: 0.6515 - accuracy30: 0.6311 - accuracy50: 0.6044 - val_loss: 8.7874 - val_accuracy10: 0.6530 - val_accuracy20: 0.6304 - val_accuracy30: 0.6086 - val_accuracy50: 0.5820 - 34s/epoch - 26ms/step
Epoch 29/50
1289/1289 - 34s - loss: 8.6163 - accuracy10: 0.6714 - accuracy20: 0.6519 - accuracy30: 0.6317 - accuracy50: 0.6049 - val_loss: 8.8275 - val_accuracy10: 0.6420 - val_accuracy20: 0.6196 - val_accuracy30: 0.6003 - val_accuracy50: 0.5755 - 34s/epoch - 26ms/step
Epoch 30/50
1289/1289 - 34s - loss: 8.6052 - accuracy10: 0.6715 - accuracy20: 0.6525 - accuracy30: 0.6320 - accuracy50: 0.6049 - val_loss: 8.7689 - val_accuracy10: 0.6483 - val_accuracy20: 0.6249 - val_accuracy30: 0.6022 - val_accuracy50: 0.5746 - 34s/epoch - 26ms/step
Epoch 31/50
1289/1289 - 34s - loss: 8.5858 - accuracy10: 0.6718 - accuracy20: 0.6531 - accuracy30: 0.6330 - accuracy50: 0.6057 - val_loss: 8.8918 - val_accuracy10: 0.6319 - val_accuracy20: 0.6108 - val_accuracy30: 0.5901 - val_accuracy50: 0.5652 - 34s/epoch - 26ms/step
testing model: results/EXC/W8/deepLOB_L1/seq2seq
Evaluating performance on  test set...
5521/5521 - 74s - 74s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.66041553
{'0': {'precision': 0.3579622355780607, 'recall': 0.5912686625498319, 'f1-score': 0.44594387454309636, 'support': 127930}, '1': {'precision': 0.9276314775042679, 'recall': 0.730553750901002, 'f1-score': 0.8173811269520627, 'support': 1152883}, '2': {'precision': 0.30501955449753443, 'recall': 0.6769285342309638, 'f1-score': 0.42054451209362625, 'support': 132497}, 'accuracy': 0.7129186095053456, 'macro avg': {'precision': 0.530204422526621, 'recall': 0.6662503158939326, 'f1-score': 0.5612898378629284, 'support': 1413310}, 'weighted avg': {'precision': 0.8176966450313902, 'recall': 0.7129186095053456, 'f1-score': 0.7465561638091022, 'support': 1413310}}
[[ 75641  33642  18647]
 [124928 842243 185712]
 [ 10741  32065  89691]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.69624007
{'0': {'precision': 0.4259891674667509, 'recall': 0.5949700124476632, 'f1-score': 0.4964954236299809, 'support': 176740}, '1': {'precision': 0.8838594620651824, 'recall': 0.7065870480160832, 'f1-score': 0.7853437939636332, 'support': 1053522}, '2': {'precision': 0.38053602269923514, 'recall': 0.6740581705345046, 'f1-score': 0.48644951191433666, 'support': 183048}, 'accuracy': 0.6884158464880317, 'macro avg': {'precision': 0.5634615507437228, 'recall': 0.6585384103327503, 'f1-score': 0.5894295765026502, 'support': 1413310}, 'weighted avg': {'precision': 0.7614119135468922, 'recall': 0.6884158464880317, 'f1-score': 0.7105102036590791, 'support': 1413310}}
[[105155  49444  22141]
 [130403 744405 178714]
 [ 11291  48372 123385]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7435744
{'0': {'precision': 0.46009767558219217, 'recall': 0.5889013671421809, 'f1-score': 0.5165917968153683, 'support': 215486}, '1': {'precision': 0.8401585657491889, 'recall': 0.6786148562054647, 'f1-score': 0.7507954459091111, 'support': 975350}, '2': {'precision': 0.42298970221941334, 'recall': 0.6648597139441014, 'f1-score': 0.5170362887369115, 'support': 222474}, 'accuracy': 0.6627710834848689, 'macro avg': {'precision': 0.5744153145169315, 'recall': 0.6441253124305822, 'f1-score': 0.5948078438204637, 'support': 1413310}, 'weighted avg': {'precision': 0.7165430626228764, 'recall': 0.6627710834848689, 'f1-score': 0.6782898086028285, 'support': 1413310}}
[[126900  63363  25223]
 [136913 661887 176550]
 [ 11998  62562 147914]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8131096
{'0': {'precision': 0.512470207134486, 'recall': 0.5497870356635799, 'f1-score': 0.5304731560205141, 'support': 283146}, '1': {'precision': 0.7454711256144139, 'recall': 0.6515130577323075, 'f1-score': 0.6953323857062575, 'support': 839426}, '2': {'precision': 0.47992658012343054, 'recall': 0.620538078957687, 'f1-score': 0.541249036237471, 'support': 290738}, 'accuracy': 0.6247610219980047, 'macro avg': {'precision': 0.5792893042907767, 'recall': 0.6072793907845248, 'f1-score': 0.5890181926547475, 'support': 1413310}, 'weighted avg': {'precision': 0.6441648530125961, 'recall': 0.6247610219980047, 'f1-score': 0.6306069423806916, 'support': 1413310}}
[[155670  93923  33553]
 [130576 546897 161953]
 [ 17518  92806 180414]]
Evaluating performance on  train set...
1289/1289 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.70947963
{'0': {'precision': 0.34305055137023693, 'recall': 0.5623098490723617, 'f1-score': 0.42613019891500903, 'support': 33526}, '1': {'precision': 0.9258686462521909, 'recall': 0.6845477449183002, 'f1-score': 0.787127226669413, 'support': 262363}, '2': {'precision': 0.2975394821525818, 'recall': 0.7103808989096067, 'f1-score': 0.41941083594302014, 'support': 33841}, 'accuracy': 0.6747702665817487, 'macro avg': {'precision': 0.5221528932583366, 'recall': 0.6524128309667562, 'f1-score': 0.5442227538424808, 'support': 329730}, 'weighted avg': {'precision': 0.802122409357437, 'recall': 0.6747702665817487, 'f1-score': 0.7126824484233752, 'support': 329730}}
[[ 18852   7595   7079]
 [ 33086 179600  49677]
 [  3016   6785  24040]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7440625
{'0': {'precision': 0.4057323742811026, 'recall': 0.5713938912429378, 'f1-score': 0.47452004581901486, 'support': 45312}, '1': {'precision': 0.8818076282450326, 'recall': 0.6583512328698296, 'f1-score': 0.7538691674817329, 'support': 238833}, '2': {'precision': 0.3613793575782481, 'recall': 0.6945047713063508, 'f1-score': 0.4753924814739735, 'support': 45585}, 'accuracy': 0.6513996300003033, 'macro avg': {'precision': 0.5496397867014611, 'recall': 0.6414166318063728, 'f1-score': 0.5679272315915737, 'support': 329730}, 'weighted avg': {'precision': 0.7444357038646031, 'recall': 0.6513996300003033, 'f1-score': 0.6769813285454978, 'support': 329730}}
[[ 25891  10851   8570]
 [ 34220 157236  47377]
 [  3702  10224  31659]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7873443
{'0': {'precision': 0.4370552008906552, 'recall': 0.5701652786204107, 'f1-score': 0.49481460208054123, 'support': 54393}, '1': {'precision': 0.8381948166930671, 'recall': 0.6307869426087587, 'f1-score': 0.7198487556218787, 'support': 220626}, '2': {'precision': 0.3999331449891091, 'recall': 0.6779075505839777, 'f1-score': 0.5030756397127143, 'support': 54711}, 'accuracy': 0.6286052224547357, 'macro avg': {'precision': 0.5583943875242771, 'recall': 0.6262865906043823, 'f1-score': 0.5725796658050447, 'support': 329730}, 'weighted avg': {'precision': 0.699302627802351, 'recall': 0.6286052224547357, 'f1-score': 0.6467581764871919, 'support': 329730}}
[[ 31013  13544   9836]
 [ 35645 139168  45813]
 [  4301  13321  37089]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.85209066
{'0': {'precision': 0.4804691510111898, 'recall': 0.5357889012907473, 'f1-score': 0.5066233678370882, 'support': 69882}, '1': {'precision': 0.7440844155844156, 'recall': 0.6026495987209559, 'f1-score': 0.6659402223500764, 'support': 190142}, '2': {'precision': 0.4494182123064968, 'recall': 0.6305626488394113, 'f1-score': 0.5247988155789574, 'support': 69706}, 'accuracy': 0.5943802505079914, 'macro avg': {'precision': 0.5579905929673674, 'recall': 0.5896670496170381, 'f1-score': 0.5657874685887073, 'support': 329730}, 'weighted avg': {'precision': 0.625921178133784, 'recall': 0.5943802505079914, 'f1-score': 0.6023373250478465, 'support': 329730}}
[[ 37442  19641  12799]
 [ 34504 114589  41049]
 [  5982  19770  43954]]
Evaluating performance on  val set...
438/438 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.74131596
{'0': {'precision': 0.3041825095057034, 'recall': 0.6561968590577173, 'f1-score': 0.41567658334125396, 'support': 9997}, '1': {'precision': 0.9448804822957799, 'recall': 0.6308463432892496, 'f1-score': 0.7565707296762777, 'support': 92173}, '2': {'precision': 0.26268159911237476, 'recall': 0.7749590834697218, 'f1-score': 0.3923660564000311, 'support': 9776}, 'accuracy': 0.645695245922141, 'macro avg': {'precision': 0.5039148636379527, 'recall': 0.6873340952722296, 'f1-score': 0.5215377898058543, 'support': 111946}, 'weighted avg': {'precision': 0.8280899411778894, 'recall': 0.645695245922141, 'f1-score': 0.6943230060697191, 'support': 111946}}
[[ 6560  2007  1430]
 [14191 58147 19835]
 [  815  1385  7576]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.76536727
{'0': {'precision': 0.367704438302715, 'recall': 0.6581550996653572, 'f1-score': 0.4718122555410691, 'support': 13746}, '1': {'precision': 0.9056304095654502, 'recall': 0.5988977270045083, 'f1-score': 0.7209968103772847, 'support': 84734}, '2': {'precision': 0.32567796339476796, 'recall': 0.7571661963463537, 'f1-score': 0.4554530632300717, 'support': 13466}, 'accuracy': 0.6252121558608615, 'macro avg': {'precision': 0.5330042704209778, 'recall': 0.6714063410054064, 'f1-score': 0.5494207097161419, 'support': 111946}, 'weighted avg': {'precision': 0.7698151947197928, 'recall': 0.6252121558608615, 'f1-score': 0.6584568090385768, 'support': 111946}}
[[ 9047  3027  1672]
 [14548 50747 19439]
 [ 1009  2261 10196]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.80192566
{'0': {'precision': 0.40272911672505995, 'recall': 0.6506196377502383, 'f1-score': 0.49750563794163877, 'support': 16784}, '1': {'precision': 0.8644309256121977, 'recall': 0.5705826291378105, 'f1-score': 0.687421061092017, 'support': 78695}, '2': {'precision': 0.37023747985526195, 'recall': 0.7394182304001943, 'f1-score': 0.49341492077643145, 'support': 16467}, 'accuracy': 0.6074178621835528, 'macro avg': {'precision': 0.5457991740641732, 'recall': 0.6535401657627476, 'f1-score': 0.5594472066033624, 'support': 111946}, 'weighted avg': {'precision': 0.722513513363067, 'recall': 0.6074178621835528, 'f1-score': 0.63040929135721, 'support': 111946}}
[[10920  3907  1957]
 [15039 44902 18754]
 [ 1156  3135 12176]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8539408
{'0': {'precision': 0.45416878926812704, 'recall': 0.6039380391094251, 'f1-score': 0.5184539040086842, 'support': 22143}, '1': {'precision': 0.7693712009625957, 'recall': 0.5440861477069335, 'f1-score': 0.6374081553731792, 'support': 68162}, '2': {'precision': 0.43063735494781036, 'recall': 0.6825008086502472, 'f1-score': 0.5280752247984412, 'support': 21641}, 'accuracy': 0.5826827220266915, 'macro avg': {'precision': 0.5513924483928444, 'recall': 0.6101749984888687, 'f1-score': 0.5613124280601015, 'support': 111946}, 'weighted avg': {'precision': 0.6415411207117909, 'recall': 0.5826827220266915, 'f1-score': 0.5927430673974415, 'support': 111946}}
[[13373  5954  2816]
 [14364 37086 16712]
 [ 1708  5163 14770]]
training model: results/EXC/W8/deepOF_L1/seq2seq
Epoch 1/50
1288/1288 - 41s - loss: 11.7944 - accuracy10: 0.4441 - accuracy20: 0.4558 - accuracy30: 0.4585 - accuracy50: 0.4630 - val_loss: 11.3240 - val_accuracy10: 0.7178 - val_accuracy20: 0.6916 - val_accuracy30: 0.6617 - val_accuracy50: 0.6010 - 41s/epoch - 32ms/step
Epoch 2/50
1288/1288 - 34s - loss: 11.3715 - accuracy10: 0.4830 - accuracy20: 0.4876 - accuracy30: 0.4866 - accuracy50: 0.4872 - val_loss: 10.8275 - val_accuracy10: 0.7019 - val_accuracy20: 0.6779 - val_accuracy30: 0.6517 - val_accuracy50: 0.5994 - 34s/epoch - 26ms/step
Epoch 3/50
1288/1288 - 34s - loss: 11.2009 - accuracy10: 0.4897 - accuracy20: 0.4964 - accuracy30: 0.4988 - accuracy50: 0.5007 - val_loss: 10.4887 - val_accuracy10: 0.6590 - val_accuracy20: 0.6460 - val_accuracy30: 0.6325 - val_accuracy50: 0.5977 - 34s/epoch - 26ms/step
Epoch 4/50
1288/1288 - 34s - loss: 11.0543 - accuracy10: 0.5069 - accuracy20: 0.5104 - accuracy30: 0.5118 - accuracy50: 0.5124 - val_loss: 10.3776 - val_accuracy10: 0.6570 - val_accuracy20: 0.6279 - val_accuracy30: 0.6039 - val_accuracy50: 0.5708 - 34s/epoch - 26ms/step
Epoch 5/50
1288/1288 - 32s - loss: 10.9773 - accuracy10: 0.5164 - accuracy20: 0.5164 - accuracy30: 0.5166 - accuracy50: 0.5155 - val_loss: 10.2330 - val_accuracy10: 0.6164 - val_accuracy20: 0.5998 - val_accuracy30: 0.5901 - val_accuracy50: 0.5702 - 32s/epoch - 25ms/step
Epoch 6/50
1288/1288 - 32s - loss: 10.8891 - accuracy10: 0.5245 - accuracy20: 0.5220 - accuracy30: 0.5208 - accuracy50: 0.5194 - val_loss: 10.1091 - val_accuracy10: 0.6226 - val_accuracy20: 0.5988 - val_accuracy30: 0.5855 - val_accuracy50: 0.5661 - 32s/epoch - 25ms/step
Epoch 7/50
1288/1288 - 32s - loss: 10.8115 - accuracy10: 0.5312 - accuracy20: 0.5254 - accuracy30: 0.5228 - accuracy50: 0.5214 - val_loss: 10.0498 - val_accuracy10: 0.6070 - val_accuracy20: 0.5858 - val_accuracy30: 0.5750 - val_accuracy50: 0.5600 - 32s/epoch - 25ms/step
Epoch 8/50
1288/1288 - 32s - loss: 10.7232 - accuracy10: 0.5389 - accuracy20: 0.5326 - accuracy30: 0.5289 - accuracy50: 0.5258 - val_loss: 9.9946 - val_accuracy10: 0.6188 - val_accuracy20: 0.5940 - val_accuracy30: 0.5805 - val_accuracy50: 0.5625 - 32s/epoch - 25ms/step
Epoch 9/50
1288/1288 - 32s - loss: 10.6659 - accuracy10: 0.5426 - accuracy20: 0.5347 - accuracy30: 0.5294 - accuracy50: 0.5254 - val_loss: 9.9536 - val_accuracy10: 0.6061 - val_accuracy20: 0.5800 - val_accuracy30: 0.5644 - val_accuracy50: 0.5498 - 32s/epoch - 25ms/step
Epoch 10/50
1288/1288 - 32s - loss: 10.6034 - accuracy10: 0.5465 - accuracy20: 0.5375 - accuracy30: 0.5320 - accuracy50: 0.5276 - val_loss: 9.9035 - val_accuracy10: 0.6148 - val_accuracy20: 0.5871 - val_accuracy30: 0.5712 - val_accuracy50: 0.5547 - 32s/epoch - 25ms/step
Epoch 11/50
1288/1288 - 32s - loss: 10.5469 - accuracy10: 0.5493 - accuracy20: 0.5406 - accuracy30: 0.5340 - accuracy50: 0.5293 - val_loss: 9.8546 - val_accuracy10: 0.6131 - val_accuracy20: 0.5854 - val_accuracy30: 0.5690 - val_accuracy50: 0.5533 - 32s/epoch - 25ms/step
Epoch 12/50
1288/1288 - 32s - loss: 10.4959 - accuracy10: 0.5512 - accuracy20: 0.5434 - accuracy30: 0.5366 - accuracy50: 0.5313 - val_loss: 9.8860 - val_accuracy10: 0.6208 - val_accuracy20: 0.5920 - val_accuracy30: 0.5714 - val_accuracy50: 0.5526 - 32s/epoch - 25ms/step
Epoch 13/50
1288/1288 - 31s - loss: 10.4381 - accuracy10: 0.5553 - accuracy20: 0.5479 - accuracy30: 0.5397 - accuracy50: 0.5336 - val_loss: 9.8284 - val_accuracy10: 0.6185 - val_accuracy20: 0.5904 - val_accuracy30: 0.5684 - val_accuracy50: 0.5494 - 31s/epoch - 24ms/step
Epoch 14/50
1288/1288 - 32s - loss: 10.3928 - accuracy10: 0.5572 - accuracy20: 0.5494 - accuracy30: 0.5416 - accuracy50: 0.5350 - val_loss: 9.7676 - val_accuracy10: 0.6139 - val_accuracy20: 0.5862 - val_accuracy30: 0.5644 - val_accuracy50: 0.5468 - 32s/epoch - 25ms/step
Epoch 15/50
1288/1288 - 32s - loss: 10.3510 - accuracy10: 0.5589 - accuracy20: 0.5508 - accuracy30: 0.5426 - accuracy50: 0.5361 - val_loss: 9.7873 - val_accuracy10: 0.6228 - val_accuracy20: 0.5915 - val_accuracy30: 0.5685 - val_accuracy50: 0.5501 - 32s/epoch - 25ms/step
Epoch 16/50
1288/1288 - 31s - loss: 10.3050 - accuracy10: 0.5612 - accuracy20: 0.5538 - accuracy30: 0.5456 - accuracy50: 0.5382 - val_loss: 9.7523 - val_accuracy10: 0.6102 - val_accuracy20: 0.5798 - val_accuracy30: 0.5573 - val_accuracy50: 0.5410 - 31s/epoch - 24ms/step
Epoch 17/50
1288/1288 - 31s - loss: 10.2658 - accuracy10: 0.5639 - accuracy20: 0.5567 - accuracy30: 0.5480 - accuracy50: 0.5401 - val_loss: 9.7889 - val_accuracy10: 0.6253 - val_accuracy20: 0.5936 - val_accuracy30: 0.5691 - val_accuracy50: 0.5488 - 31s/epoch - 24ms/step
Epoch 18/50
1288/1288 - 32s - loss: 10.2277 - accuracy10: 0.5632 - accuracy20: 0.5567 - accuracy30: 0.5489 - accuracy50: 0.5423 - val_loss: 9.8283 - val_accuracy10: 0.6155 - val_accuracy20: 0.5837 - val_accuracy30: 0.5587 - val_accuracy50: 0.5406 - 32s/epoch - 25ms/step
Epoch 19/50
1288/1288 - 32s - loss: 10.1936 - accuracy10: 0.5650 - accuracy20: 0.5589 - accuracy30: 0.5510 - accuracy50: 0.5441 - val_loss: 9.7678 - val_accuracy10: 0.6068 - val_accuracy20: 0.5767 - val_accuracy30: 0.5542 - val_accuracy50: 0.5396 - 32s/epoch - 25ms/step
Epoch 20/50
1288/1288 - 31s - loss: 10.1543 - accuracy10: 0.5686 - accuracy20: 0.5618 - accuracy30: 0.5521 - accuracy50: 0.5440 - val_loss: 9.7770 - val_accuracy10: 0.5984 - val_accuracy20: 0.5723 - val_accuracy30: 0.5525 - val_accuracy50: 0.5375 - 31s/epoch - 24ms/step
Epoch 21/50
1288/1288 - 32s - loss: 10.1175 - accuracy10: 0.5686 - accuracy20: 0.5634 - accuracy30: 0.5545 - accuracy50: 0.5475 - val_loss: 9.7929 - val_accuracy10: 0.6213 - val_accuracy20: 0.5908 - val_accuracy30: 0.5670 - val_accuracy50: 0.5476 - 32s/epoch - 25ms/step
Epoch 22/50
1288/1288 - 31s - loss: 10.0734 - accuracy10: 0.5723 - accuracy20: 0.5664 - accuracy30: 0.5577 - accuracy50: 0.5494 - val_loss: 9.7875 - val_accuracy10: 0.6108 - val_accuracy20: 0.5813 - val_accuracy30: 0.5583 - val_accuracy50: 0.5402 - 31s/epoch - 24ms/step
Epoch 23/50
1288/1288 - 32s - loss: 10.0425 - accuracy10: 0.5730 - accuracy20: 0.5678 - accuracy30: 0.5588 - accuracy50: 0.5502 - val_loss: 9.8030 - val_accuracy10: 0.6131 - val_accuracy20: 0.5852 - val_accuracy30: 0.5627 - val_accuracy50: 0.5456 - 32s/epoch - 25ms/step
Epoch 24/50
1288/1288 - 32s - loss: 10.0057 - accuracy10: 0.5747 - accuracy20: 0.5689 - accuracy30: 0.5599 - accuracy50: 0.5512 - val_loss: 9.8281 - val_accuracy10: 0.6115 - val_accuracy20: 0.5811 - val_accuracy30: 0.5583 - val_accuracy50: 0.5416 - 32s/epoch - 25ms/step
Epoch 25/50
1288/1288 - 32s - loss: 9.9708 - accuracy10: 0.5759 - accuracy20: 0.5701 - accuracy30: 0.5610 - accuracy50: 0.5525 - val_loss: 9.8260 - val_accuracy10: 0.6175 - val_accuracy20: 0.5869 - val_accuracy30: 0.5606 - val_accuracy50: 0.5419 - 32s/epoch - 25ms/step
Epoch 26/50
1288/1288 - 33s - loss: 9.9252 - accuracy10: 0.5799 - accuracy20: 0.5741 - accuracy30: 0.5647 - accuracy50: 0.5552 - val_loss: 9.7848 - val_accuracy10: 0.6098 - val_accuracy20: 0.5776 - val_accuracy30: 0.5538 - val_accuracy50: 0.5360 - 33s/epoch - 26ms/step
testing model: results/EXC/W8/deepOF_L1/seq2seq
Evaluating performance on  test set...
5521/5521 - 74s - 74s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.77685726
{'0': {'precision': 0.2773102617771024, 'recall': 0.6048151332760103, 'f1-score': 0.38026666928781705, 'support': 127930}, '1': {'precision': 0.9217285868414218, 'recall': 0.6402542159708139, 'f1-score': 0.7556301037931221, 'support': 1152878}, '2': {'precision': 0.26416831347665326, 'recall': 0.6648678838011427, 'f1-score': 0.37810588664506295, 'support': 132497}, 'accuracy': 0.6393538549711492, 'macro avg': {'precision': 0.4877357206983925, 'recall': 0.6366457443493223, 'f1-score': 0.5046675532420006, 'support': 1413305}, 'weighted avg': {'precision': 0.8017508043631243, 'recall': 0.6393538549711492, 'f1-score': 0.6862600312498778, 'support': 1413305}}
[[ 77374  33953  16603]
 [185966 738135 228777]
 [ 15676  28728  88093]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.807166
{'0': {'precision': 0.34076696865810174, 'recall': 0.6169571121421297, 'f1-score': 0.439037942370759, 'support': 176740}, '1': {'precision': 0.8790676742640168, 'recall': 0.6062931885488647, 'f1-score': 0.7176340194805668, 'support': 1053520}, '2': {'precision': 0.33699567772460154, 'recall': 0.6751236034854817, 'f1-score': 0.4495788994997727, 'support': 183045}, 'accuracy': 0.6165413693434892, 'macro avg': {'precision': 0.5189434402155734, 'recall': 0.6327913013921588, 'f1-score': 0.5354169537836996, 'support': 1413305}, 'weighted avg': {'precision': 0.7415440432605557, 'recall': 0.6165413693434892, 'f1-score': 0.6480770447969197, 'support': 1413305}}
[[109041  47279  20420]
 [192071 638742 222707]
 [ 18875  40592 123578]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8397657
{'0': {'precision': 0.37728959402233175, 'recall': 0.6214232015072905, 'f1-score': 0.4695173796955507, 'support': 215486}, '1': {'precision': 0.8360769107830734, 'recall': 0.5739038784105776, 'f1-score': 0.680616055800799, 'support': 975348}, '2': {'precision': 0.38211946585202156, 'recall': 0.6679477325134512, 'f1-score': 0.4861323754563655, 'support': 222471}, 'accuracy': 0.5959527490527522, 'macro avg': {'precision': 0.5318286568858089, 'recall': 0.6210916041437731, 'f1-score': 0.5454219369842385, 'support': 1413305}, 'weighted avg': {'precision': 0.6946675119125103, 'recall': 0.5959527490527522, 'f1-score': 0.6178158901117778, 'support': 1413305}}
[[133908  58256  23322]
 [198632 559756 216960]
 [ 22381  51491 148599]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.87930465
{'0': {'precision': 0.4411850262470344, 'recall': 0.5838542659970475, 'f1-score': 0.5025909964961884, 'support': 283146}, '1': {'precision': 0.7412855048184263, 'recall': 0.5576996158084403, 'f1-score': 0.636519440718606, 'support': 839425}, '2': {'precision': 0.44693683026172915, 'recall': 0.6257644444750184, 'f1-score': 0.5214446629100769, 'support': 290734}, 'accuracy': 0.576941283021004, 'macro avg': {'precision': 0.5431357871090633, 'recall': 0.5891061087601687, 'f1-score': 0.5535183667082905, 'support': 1413305}, 'weighted avg': {'precision': 0.6206113278685519, 'recall': 0.576941283021004, 'f1-score': 0.5860155128904405, 'support': 1413305}}
[[165316  86217  31613]
 [177760 468147 193518]
 [ 31633  77170 181931]]
Evaluating performance on  train set...
1288/1288 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8236961
{'0': {'precision': 0.2575469546042126, 'recall': 0.6033131457071607, 'f1-score': 0.3609912070343725, 'support': 33684}, '1': {'precision': 0.8956858894043548, 'recall': 0.605101515584787, 'f1-score': 0.7222620437308431, 'support': 262275}, '2': {'precision': 0.2665272421098376, 'recall': 0.5811839260860553, 'f1-score': 0.36545784646897256, 'support': 33769}, 'accuracy': 0.6024693080357143, 'macro avg': {'precision': 0.47325336203946833, 'recall': 0.5965328624593343, 'f1-score': 0.4829036990780628, 'support': 329728}, 'weighted avg': {'precision': 0.7660604701487971, 'recall': 0.6024693080357143, 'f1-score': 0.6488137232951506, 'support': 329728}}
[[ 20322   9368   3994]
 [ 53556 158703  50016]
 [  5028   9115  19626]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.85738426
{'0': {'precision': 0.3158821328755969, 'recall': 0.6323487301482411, 'f1-score': 0.42130597808938874, 'support': 45399}, '1': {'precision': 0.8498289165992315, 'recall': 0.558616327966627, 'f1-score': 0.6741168116007954, 'support': 238756}, '2': {'precision': 0.332189732006593, 'recall': 0.5970201654488403, 'f1-score': 0.426865812140134, 'support': 45573}, 'accuracy': 0.5740762082686336, 'macro avg': {'precision': 0.4993002604938071, 'recall': 0.5959950745212361, 'f1-score': 0.5074295339434394, 'support': 329728}, 'weighted avg': {'precision': 0.7047668636534411, 'recall': 0.5740762082686336, 'f1-score': 0.6051347147542884, 'support': 329728}}
[[ 28708  11691   5000]
 [ 55686 133373  49697]
 [  6488  11877  27208]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.88815373
{'0': {'precision': 0.3512165437985695, 'recall': 0.645798558247886, 'f1-score': 0.4549883690876196, 'support': 54517}, '1': {'precision': 0.80666868024191, 'recall': 0.5206882480957563, 'f1-score': 0.6328710732461349, 'support': 220560}, '2': {'precision': 0.37462981243830207, 'recall': 0.5971894384366251, 'f1-score': 0.4604250576642284, 'support': 54651}, 'accuracy': 0.5540536442158385, 'macro avg': {'precision': 0.5108383454929272, 'recall': 0.5878920815934224, 'f1-score': 0.5160948333326609, 'support': 329728}, 'weighted avg': {'precision': 0.6597559513052816, 'recall': 0.5540536442158385, 'f1-score': 0.5748778831616514, 'support': 329728}}
[[ 35207  13381   5929]
 [ 57165 114843  48552]
 [  7871  14143  32637]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9229908
{'0': {'precision': 0.4085521751114406, 'recall': 0.6145806525406765, 'f1-score': 0.4908224144329309, 'support': 69942}, '1': {'precision': 0.7116263022493569, 'recall': 0.4991057244158276, 'f1-score': 0.5867140759063152, 'support': 190098}, '2': {'precision': 0.4312519191121639, 'recall': 0.5643008839398461, 'f1-score': 0.48888584997140655, 'support': 69688}, 'accuracy': 0.5373792944487578, 'macro avg': {'precision': 0.5171434654909871, 'recall': 0.55932908696545, 'f1-score': 0.5221407801035509, 'support': 329728}, 'weighted avg': {'precision': 0.5880810145809003, 'recall': 0.5373792944487578, 'f1-score': 0.5456975168160245, 'support': 329728}}
[[42985 18689  8268]
 [51624 94879 43595]
 [10604 19759 39325]]
Evaluating performance on  val set...
438/438 - 5s - 5s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8012002
{'0': {'precision': 0.23430037778886592, 'recall': 0.6528950243321084, 'f1-score': 0.3448474834107063, 'support': 10069}, '1': {'precision': 0.9223584451780945, 'recall': 0.6036459577425028, 'f1-score': 0.7297199745371739, 'support': 92102}, '2': {'precision': 0.2603447545635509, 'recall': 0.628849104859335, 'f1-score': 0.3682381836698017, 'support': 9775}, 'accuracy': 0.6102763832562128, 'macro avg': {'precision': 0.4723345258435038, 'recall': 0.6284633623113154, 'f1-score': 0.4809352138725606, 'support': 111946}, 'weighted avg': {'precision': 0.8026646597252931, 'recall': 0.6102763832562128, 'f1-score': 0.6635383725247664, 'support': 111946}}
[[ 6574  2392  1103]
 [20144 55597 16361]
 [ 1340  2288  6147]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8375999
{'0': {'precision': 0.2901769145119386, 'recall': 0.6786747685185185, 'f1-score': 0.4065343617297859, 'support': 13824}, '1': {'precision': 0.8820870608976162, 'recall': 0.5554413935636257, 'f1-score': 0.681652825485166, 'support': 84675}, '2': {'precision': 0.3230271914812702, 'recall': 0.631665055402692, 'f1-score': 0.4274570982839313, 'support': 13447}, 'accuracy': 0.5798152680756793, 'macro avg': {'precision': 0.49843038896360836, 'recall': 0.6219270724949454, 'f1-score': 0.5052147618329611, 'support': 111946}, 'weighted avg': {'precision': 0.7418386917939662, 'recall': 0.5798152680756793, 'f1-score': 0.6171448699831439, 'support': 111946}}
[[ 9382  3095  1347]
 [21189 47032 16454]
 [ 1761  3192  8494]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.87155175
{'0': {'precision': 0.3237559158755496, 'recall': 0.6859906248145731, 'f1-score': 0.43989954720140023, 'support': 16853}, '1': {'precision': 0.8407470359008374, 'recall': 0.5156561868317675, 'f1-score': 0.6392441471044813, 'support': 78659}, '2': {'precision': 0.36627013896331223, 'recall': 0.6238894973834733, 'f1-score': 0.4615661647196525, 'support': 16434}, 'accuracy': 0.5571882872099048, 'macro avg': {'precision': 0.5102576969132331, 'recall': 0.608512103009938, 'f1-score': 0.5135699530085113, 'support': 111946}, 'weighted avg': {'precision': 0.6932615994398877, 'recall': 0.5571882872099048, 'f1-score': 0.583150007924172, 'support': 111946}}
[[11561  3715  1577]
 [21935 40561 16163]
 [ 2213  3968 10253]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.90999246
{'0': {'precision': 0.38264478199569046, 'recall': 0.6484829358459944, 'f1-score': 0.4812955899083183, 'support': 22181}, '1': {'precision': 0.7455272808089788, 'recall': 0.4922736011035616, 'f1-score': 0.5929926284714243, 'support': 68143}, '2': {'precision': 0.4260558583106267, 'recall': 0.5785311257053002, 'f1-score': 0.4907222156839669, 'support': 21622}, 'accuracy': 0.5398853018419595, 'macro avg': {'precision': 0.5180759737050986, 'recall': 0.5730958875516188, 'f1-score': 0.5216701446879032, 'support': 111946}, 'weighted avg': {'precision': 0.6119208294535313, 'recall': 0.5398853018419595, 'f1-score': 0.5511077654333644, 'support': 111946}}
[[14384  5527  2270]
 [20017 33545 14581]
 [ 3190  5923 12509]]
training model: results/EXC/W8/deepLOB_L2/seq2seq
Epoch 1/50
1289/1289 - 73s - loss: 10.9714 - accuracy10: 0.4630 - accuracy20: 0.4801 - accuracy30: 0.4876 - accuracy50: 0.4954 - val_loss: 11.1139 - val_accuracy10: 0.2353 - val_accuracy20: 0.2806 - val_accuracy30: 0.3130 - val_accuracy50: 0.3608 - 73s/epoch - 57ms/step
Epoch 2/50
1289/1289 - 66s - loss: 9.9684 - accuracy10: 0.5750 - accuracy20: 0.5759 - accuracy30: 0.5689 - accuracy50: 0.5577 - val_loss: 12.7365 - val_accuracy10: 0.2718 - val_accuracy20: 0.3087 - val_accuracy30: 0.3353 - val_accuracy50: 0.3770 - 66s/epoch - 51ms/step
Epoch 3/50
1289/1289 - 66s - loss: 9.3489 - accuracy10: 0.6511 - accuracy20: 0.6372 - accuracy30: 0.6171 - accuracy50: 0.5911 - val_loss: 10.9695 - val_accuracy10: 0.4211 - val_accuracy20: 0.4360 - val_accuracy30: 0.4416 - val_accuracy50: 0.4562 - 66s/epoch - 51ms/step
Epoch 4/50
1289/1289 - 66s - loss: 9.1033 - accuracy10: 0.6739 - accuracy20: 0.6553 - accuracy30: 0.6302 - accuracy50: 0.5996 - val_loss: 9.7704 - val_accuracy10: 0.5134 - val_accuracy20: 0.5124 - val_accuracy30: 0.5041 - val_accuracy50: 0.5029 - 66s/epoch - 52ms/step
Epoch 5/50
1289/1289 - 65s - loss: 8.9457 - accuracy10: 0.6812 - accuracy20: 0.6599 - accuracy30: 0.6337 - accuracy50: 0.6038 - val_loss: 9.7285 - val_accuracy10: 0.5040 - val_accuracy20: 0.5005 - val_accuracy30: 0.4911 - val_accuracy50: 0.4923 - 65s/epoch - 51ms/step
Epoch 6/50
1289/1289 - 66s - loss: 8.8414 - accuracy10: 0.6825 - accuracy20: 0.6608 - accuracy30: 0.6357 - accuracy50: 0.6059 - val_loss: 9.5032 - val_accuracy10: 0.5218 - val_accuracy20: 0.5146 - val_accuracy30: 0.5040 - val_accuracy50: 0.5017 - 66s/epoch - 51ms/step
Epoch 7/50
1289/1289 - 66s - loss: 8.7558 - accuracy10: 0.6843 - accuracy20: 0.6626 - accuracy30: 0.6372 - accuracy50: 0.6065 - val_loss: 9.9620 - val_accuracy10: 0.5031 - val_accuracy20: 0.4991 - val_accuracy30: 0.4890 - val_accuracy50: 0.4905 - 66s/epoch - 51ms/step
Epoch 8/50
1289/1289 - 66s - loss: 8.6856 - accuracy10: 0.6846 - accuracy20: 0.6626 - accuracy30: 0.6381 - accuracy50: 0.6079 - val_loss: 9.2455 - val_accuracy10: 0.5571 - val_accuracy20: 0.5389 - val_accuracy30: 0.5213 - val_accuracy50: 0.5131 - 66s/epoch - 51ms/step
Epoch 9/50
1289/1289 - 66s - loss: 8.6286 - accuracy10: 0.6852 - accuracy20: 0.6629 - accuracy30: 0.6391 - accuracy50: 0.6092 - val_loss: 9.1604 - val_accuracy10: 0.5718 - val_accuracy20: 0.5582 - val_accuracy30: 0.5412 - val_accuracy50: 0.5290 - 66s/epoch - 51ms/step
Epoch 10/50
1289/1289 - 66s - loss: 8.5740 - accuracy10: 0.6849 - accuracy20: 0.6639 - accuracy30: 0.6408 - accuracy50: 0.6110 - val_loss: 9.1280 - val_accuracy10: 0.5775 - val_accuracy20: 0.5615 - val_accuracy30: 0.5436 - val_accuracy50: 0.5299 - 66s/epoch - 51ms/step
Epoch 11/50
1289/1289 - 66s - loss: 8.5312 - accuracy10: 0.6852 - accuracy20: 0.6646 - accuracy30: 0.6411 - accuracy50: 0.6114 - val_loss: 9.4307 - val_accuracy10: 0.5318 - val_accuracy20: 0.5179 - val_accuracy30: 0.5033 - val_accuracy50: 0.4979 - 66s/epoch - 51ms/step
Epoch 12/50
1289/1289 - 66s - loss: 8.4845 - accuracy10: 0.6854 - accuracy20: 0.6651 - accuracy30: 0.6424 - accuracy50: 0.6118 - val_loss: 9.3050 - val_accuracy10: 0.5510 - val_accuracy20: 0.5378 - val_accuracy30: 0.5246 - val_accuracy50: 0.5150 - 66s/epoch - 51ms/step
Epoch 13/50
1289/1289 - 66s - loss: 8.4478 - accuracy10: 0.6870 - accuracy20: 0.6668 - accuracy30: 0.6433 - accuracy50: 0.6125 - val_loss: 9.3168 - val_accuracy10: 0.5597 - val_accuracy20: 0.5436 - val_accuracy30: 0.5262 - val_accuracy50: 0.5147 - 66s/epoch - 51ms/step
Epoch 14/50
1289/1289 - 66s - loss: 8.4130 - accuracy10: 0.6868 - accuracy20: 0.6680 - accuracy30: 0.6444 - accuracy50: 0.6136 - val_loss: 9.4375 - val_accuracy10: 0.5663 - val_accuracy20: 0.5469 - val_accuracy30: 0.5272 - val_accuracy50: 0.5127 - 66s/epoch - 51ms/step
Epoch 15/50
1289/1289 - 65s - loss: 8.3759 - accuracy10: 0.6868 - accuracy20: 0.6683 - accuracy30: 0.6450 - accuracy50: 0.6144 - val_loss: 9.8490 - val_accuracy10: 0.5610 - val_accuracy20: 0.5392 - val_accuracy30: 0.5186 - val_accuracy50: 0.5052 - 65s/epoch - 51ms/step
Epoch 16/50
1289/1289 - 66s - loss: 8.3465 - accuracy10: 0.6862 - accuracy20: 0.6685 - accuracy30: 0.6460 - accuracy50: 0.6154 - val_loss: 9.9039 - val_accuracy10: 0.5601 - val_accuracy20: 0.5402 - val_accuracy30: 0.5197 - val_accuracy50: 0.5079 - 66s/epoch - 51ms/step
Epoch 17/50
1289/1289 - 67s - loss: 8.3117 - accuracy10: 0.6868 - accuracy20: 0.6687 - accuracy30: 0.6470 - accuracy50: 0.6162 - val_loss: 9.9537 - val_accuracy10: 0.5588 - val_accuracy20: 0.5382 - val_accuracy30: 0.5167 - val_accuracy50: 0.5033 - 67s/epoch - 52ms/step
Epoch 18/50
1289/1289 - 67s - loss: 8.2736 - accuracy10: 0.6874 - accuracy20: 0.6693 - accuracy30: 0.6474 - accuracy50: 0.6168 - val_loss: 9.9841 - val_accuracy10: 0.5580 - val_accuracy20: 0.5359 - val_accuracy30: 0.5132 - val_accuracy50: 0.4987 - 67s/epoch - 52ms/step
Epoch 19/50
1289/1289 - 66s - loss: 8.2420 - accuracy10: 0.6886 - accuracy20: 0.6701 - accuracy30: 0.6488 - accuracy50: 0.6180 - val_loss: 9.8630 - val_accuracy10: 0.5654 - val_accuracy20: 0.5416 - val_accuracy30: 0.5195 - val_accuracy50: 0.5033 - 66s/epoch - 51ms/step
Epoch 20/50
1289/1289 - 66s - loss: 8.2113 - accuracy10: 0.6888 - accuracy20: 0.6711 - accuracy30: 0.6497 - accuracy50: 0.6191 - val_loss: 9.9339 - val_accuracy10: 0.5535 - val_accuracy20: 0.5335 - val_accuracy30: 0.5130 - val_accuracy50: 0.4993 - 66s/epoch - 51ms/step
testing model: results/EXC/W8/deepLOB_L2/seq2seq
Evaluating performance on  test set...
5521/5521 - 111s - 111s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.96833867
{'0': {'precision': 0.31801405871113975, 'recall': 0.6284139763933401, 'f1-score': 0.4223131009883722, 'support': 127930}, '1': {'precision': 0.9514437211336626, 'recall': 0.5358739785390192, 'f1-score': 0.6856019158678336, 'support': 1152883}, '2': {'precision': 0.21613548154871828, 'recall': 0.8338679366325276, 'f1-score': 0.34329116441218555, 'support': 132497}, 'accuracy': 0.5721872766767376, 'macro avg': {'precision': 0.4951977537978402, 'recall': 0.6660519638549623, 'f1-score': 0.48373539375613045, 'support': 1413310}, 'weighted avg': {'precision': 0.8251722077827348, 'recall': 0.5721872766767376, 'f1-score': 0.6296781017554673, 'support': 1413310}}
[[ 80393  21308  26229]
 [160613 617800 374470]
 [ 11791  10221 110485]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9684624
{'0': {'precision': 0.3863084070091873, 'recall': 0.6314133755799479, 'f1-score': 0.4793457297613065, 'support': 176740}, '1': {'precision': 0.9179744071471253, 'recall': 0.5059941795235411, 'f1-score': 0.652387575563063, 'support': 1053522}, '2': {'precision': 0.282914278042312, 'recall': 0.8403642760368865, 'f1-score': 0.4233162853223367, 'support': 183048}, 'accuracy': 0.564985035130297, 'macro avg': {'precision': 0.5290656973995415, 'recall': 0.6592572770467918, 'f1-score': 0.518349863548902, 'support': 1413310}, 'weighted avg': {'precision': 0.769236242571231, 'recall': 0.564985035130297, 'f1-score': 0.6010793294153765, 'support': 1413310}}
[[111596  30885  34259]
 [164809 533076 355637]
 [ 12473  16748 153827]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9828698
{'0': {'precision': 0.42106650350637737, 'recall': 0.6227597152483224, 'f1-score': 0.5024270345251043, 'support': 215486}, '1': {'precision': 0.882284594574385, 'recall': 0.47179679089557597, 'f1-score': 0.61482130224001, 'support': 975350}, '2': {'precision': 0.32500061077547543, 'recall': 0.8371270350692666, 'f1-score': 0.4682218836579025, 'support': 222474}, 'accuracy': 0.5523218543702373, 'macro avg': {'precision': 0.5427839029520792, 'recall': 0.6438945137377217, 'f1-score': 0.5284900734743389, 'support': 1413310}, 'weighted avg': {'precision': 0.7242391278448216, 'recall': 0.5523218543702373, 'f1-score': 0.5746079377110319, 'support': 1413310}}
[[134196  38594  42696]
 [171076 460167 344107]
 [ 13433  22802 186239]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9830345
{'0': {'precision': 0.47720698865160543, 'recall': 0.5780092249228314, 'f1-score': 0.5227934106583273, 'support': 283146}, '1': {'precision': 0.797468110689391, 'recall': 0.44403556716136977, 'f1-score': 0.5704440689794493, 'support': 839426}, '2': {'precision': 0.3867811249908783, 'recall': 0.8021380074156113, 'f1-score': 0.5219057082178016, 'support': 290738}, 'accuracy': 0.5445429523600626, 'macro avg': {'precision': 0.5538187414439583, 'recall': 0.6080609331666041, 'f1-score': 0.538381062618526, 'support': 1413310}, 'weighted avg': {'precision': 0.6488220468332484, 'recall': 0.5445429523600626, 'f1-score': 0.5509125866916905, 'support': 1413310}}
[[163661  56980  62505]
 [159452 372735 307239]
 [ 19843  37683 233212]]
Evaluating performance on  train set...
1289/1289 - 28s - 28s/epoch - 22ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9607866
{'0': {'precision': 0.30270402018695874, 'recall': 0.6297500447413947, 'f1-score': 0.40887348219300107, 'support': 33526}, '1': {'precision': 0.9520963828999849, 'recall': 0.5295258858909221, 'f1-score': 0.6805508950943099, 'support': 262363}, '2': {'precision': 0.23805933511011362, 'recall': 0.8023994562808427, 'f1-score': 0.3671816368614989, 'support': 33841}, 'accuracy': 0.5677220756376429, 'macro avg': {'precision': 0.49761991273235245, 'recall': 0.6538917956377198, 'f1-score': 0.48553533804960325, 'support': 329730}, 'weighted avg': {'precision': 0.8127846548601523, 'recall': 0.5677220756376429, 'f1-score': 0.6207656586499893, 'support': 329730}}
[[ 21113   4228   8185]
 [ 44710 138928  78725]
 [  3925   2762  27154]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.96383554
{'0': {'precision': 0.36160764827976605, 'recall': 0.6344014830508474, 'f1-score': 0.4606472393375372, 'support': 45312}, '1': {'precision': 0.9169578174970625, 'recall': 0.4934033404094074, 'f1-score': 0.6415804173721777, 'support': 238833}, '2': {'precision': 0.29908315670133584, 'recall': 0.7986179664363278, 'f1-score': 0.4351880076745145, 'support': 45585}, 'accuracy': 0.5549752828071453, 'macro avg': {'precision': 0.5258828741593882, 'recall': 0.6421409299655275, 'f1-score': 0.5124718881280764, 'support': 329730}, 'weighted avg': {'precision': 0.7552199007774818, 'recall': 0.5549752828071453, 'f1-score': 0.5881826611498939, 'support': 329730}}
[[ 28746   6301  10265]
 [ 45940 117841  75052]
 [  4809   4371  36405]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9792363
{'0': {'precision': 0.3920363686206424, 'recall': 0.6310003125402166, 'f1-score': 0.4836093869988234, 'support': 54393}, '1': {'precision': 0.8816535239034007, 'recall': 0.45405799860397233, 'f1-score': 0.5994136125654451, 'support': 220626}, '2': {'precision': 0.33696074923380887, 'recall': 0.7917786185593391, 'f1-score': 0.4727367967304891, 'support': 54711}, 'accuracy': 0.5392836563248719, 'macro avg': {'precision': 0.5368835472526173, 'recall': 0.625612309901176, 'f1-score': 0.5185865987649191, 'support': 329730}, 'weighted avg': {'precision': 0.7105061235387293, 'recall': 0.5392836563248719, 'f1-score': 0.5592912260298205, 'support': 329730}}
[[ 34322   7804  12267]
 [ 47477 100177  72972]
 [  5749   5643  43319]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9859457
{'0': {'precision': 0.4404141218531208, 'recall': 0.5922984459517472, 'f1-score': 0.505187228433335, 'support': 69882}, '1': {'precision': 0.7985179851798518, 'recall': 0.41995456027600425, 'f1-score': 0.5504289293826106, 'support': 190142}, '2': {'precision': 0.38859954769464233, 'recall': 0.7567784695722033, 'f1-score': 0.5135139081550705, 'support': 69706}, 'accuracy': 0.5276862887817305, 'macro avg': {'precision': 0.5425105515758717, 'recall': 0.5896771585999849, 'f1-score': 0.5230433553236721, 'support': 329730}, 'weighted avg': {'precision': 0.6359644147423951, 'recall': 0.5276862887817305, 'f1-score': 0.5330365810508719, 'support': 329730}}
[[41391 11321 17170]
 [44464 79851 65827]
 [ 8127  8827 52752]]
Evaluating performance on  val set...
438/438 - 9s - 9s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9271766
{'0': {'precision': 0.2936780360634369, 'recall': 0.6761028308492548, 'f1-score': 0.4094874591057797, 'support': 9997}, '1': {'precision': 0.9541472186089218, 'recall': 0.541145454742712, 'f1-score': 0.6906105268987669, 'support': 92173}, '2': {'precision': 0.217050879825399, 'recall': 0.8138297872340425, 'f1-score': 0.3427020740453577, 'support': 9776}, 'accuracy': 0.5770103442731317, 'macro avg': {'precision': 0.48829204483258587, 'recall': 0.6770260242753364, 'f1-score': 0.48093335334996806, 'support': 111946}, 'weighted avg': {'precision': 0.8307969941627162, 'recall': 0.5770103442731316, 'f1-score': 0.6351235926284811, 'support': 111946}}
[[ 6759  1608  1630]
 [15225 49879 27069]
 [ 1031   789  7956]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9391634
{'0': {'precision': 0.3542037999165687, 'recall': 0.6794703913865852, 'f1-score': 0.46566122398105453, 'support': 13746}, '1': {'precision': 0.9213373938961965, 'recall': 0.5034224750395355, 'f1-score': 0.6510878938893256, 'support': 84734}, '2': {'precision': 0.27799276948928153, 'recall': 0.8108569731174811, 'f1-score': 0.4140376156529653, 'support': 13466}, 'accuracy': 0.5620209743983706, 'macro avg': {'precision': 0.5178446544340156, 'recall': 0.6645832798478672, 'f1-score': 0.5102622445077818, 'support': 111946}, 'weighted avg': {'precision': 0.7743102817608143, 'recall': 0.5620209743983706, 'f1-score': 0.5998042924092377, 'support': 111946}}
[[ 9340  2358  2048]
 [15766 42657 26311]
 [ 1263  1284 10919]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9603026
{'0': {'precision': 0.3857699671772429, 'recall': 0.6722473784556721, 'f1-score': 0.49022419186652766, 'support': 16784}, '1': {'precision': 0.8851374361469229, 'recall': 0.46239278226062647, 'f1-score': 0.6074537790576353, 'support': 78695}, '2': {'precision': 0.31836106569202655, 'recall': 0.8040323070383191, 'f1-score': 0.4561191973128929, 'support': 16467}, 'accuracy': 0.5441105533024851, 'macro avg': {'precision': 0.5297561563387309, 'recall': 0.6462241559182059, 'f1-score': 0.5179323894123519, 'support': 111946}, 'weighted avg': {'precision': 0.7268960510910217, 'recall': 0.5441105533024851, 'f1-score': 0.5676166437512713, 'support': 111946}}
[[11283  2933  2568]
 [16527 36388 25780]
 [ 1438  1789 13240]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9713521
{'0': {'precision': 0.4355630124410396, 'recall': 0.6213701847084857, 'f1-score': 0.5121342961363806, 'support': 22143}, '1': {'precision': 0.7978799955717923, 'recall': 0.4229482702972331, 'f1-score': 0.5528410071528563, 'support': 68162}, '2': {'precision': 0.3750593555681176, 'recall': 0.7664618086040387, 'f1-score': 0.5036589439164364, 'support': 21641}, 'accuracy': 0.5286030764833044, 'macro avg': {'precision': 0.5361674545269832, 'recall': 0.6035934212032524, 'f1-score': 0.522878082401891, 'support': 111946}, 'weighted avg': {'precision': 0.6444752608980766, 'recall': 0.5286030764833044, 'f1-score': 0.5352814897736093, 'support': 111946}}
[[13759  4403  3981]
 [15676 28829 23657]
 [ 2154  2900 16587]]
training model: results/EXC/W8/deepOF_L2/seq2seq
Epoch 1/50
1288/1288 - 52s - loss: 10.2995 - accuracy10: 0.5530 - accuracy20: 0.5540 - accuracy30: 0.5450 - accuracy50: 0.5334 - val_loss: 9.0795 - val_accuracy10: 0.7511 - val_accuracy20: 0.7298 - val_accuracy30: 0.7034 - val_accuracy50: 0.6504 - 52s/epoch - 41ms/step
Epoch 2/50
1288/1288 - 44s - loss: 9.3260 - accuracy10: 0.6339 - accuracy20: 0.6242 - accuracy30: 0.6061 - accuracy50: 0.5792 - val_loss: 8.9465 - val_accuracy10: 0.7617 - val_accuracy20: 0.7391 - val_accuracy30: 0.7126 - val_accuracy50: 0.6611 - 44s/epoch - 34ms/step
Epoch 3/50
1288/1288 - 43s - loss: 9.0918 - accuracy10: 0.6410 - accuracy20: 0.6323 - accuracy30: 0.6136 - accuracy50: 0.5874 - val_loss: 8.8723 - val_accuracy10: 0.7408 - val_accuracy20: 0.7175 - val_accuracy30: 0.6929 - val_accuracy50: 0.6477 - 43s/epoch - 34ms/step
Epoch 4/50
1288/1288 - 42s - loss: 8.9828 - accuracy10: 0.6442 - accuracy20: 0.6342 - accuracy30: 0.6165 - accuracy50: 0.5911 - val_loss: 8.7945 - val_accuracy10: 0.7626 - val_accuracy20: 0.7357 - val_accuracy30: 0.7083 - val_accuracy50: 0.6596 - 42s/epoch - 33ms/step
Epoch 5/50
1288/1288 - 42s - loss: 8.8979 - accuracy10: 0.6482 - accuracy20: 0.6365 - accuracy30: 0.6182 - accuracy50: 0.5936 - val_loss: 8.8693 - val_accuracy10: 0.7717 - val_accuracy20: 0.7449 - val_accuracy30: 0.7162 - val_accuracy50: 0.6645 - 42s/epoch - 33ms/step
Epoch 6/50
1288/1288 - 43s - loss: 8.8327 - accuracy10: 0.6518 - accuracy20: 0.6399 - accuracy30: 0.6213 - accuracy50: 0.5969 - val_loss: 8.8146 - val_accuracy10: 0.7651 - val_accuracy20: 0.7369 - val_accuracy30: 0.7091 - val_accuracy50: 0.6596 - 43s/epoch - 33ms/step
Epoch 7/50
1288/1288 - 42s - loss: 8.7816 - accuracy10: 0.6529 - accuracy20: 0.6409 - accuracy30: 0.6221 - accuracy50: 0.5979 - val_loss: 8.9505 - val_accuracy10: 0.7725 - val_accuracy20: 0.7431 - val_accuracy30: 0.7131 - val_accuracy50: 0.6618 - 42s/epoch - 33ms/step
Epoch 8/50
1288/1288 - 42s - loss: 8.7297 - accuracy10: 0.6540 - accuracy20: 0.6425 - accuracy30: 0.6241 - accuracy50: 0.5995 - val_loss: 8.8421 - val_accuracy10: 0.7623 - val_accuracy20: 0.7345 - val_accuracy30: 0.7047 - val_accuracy50: 0.6549 - 42s/epoch - 33ms/step
Epoch 9/50
1288/1288 - 42s - loss: 8.6835 - accuracy10: 0.6561 - accuracy20: 0.6450 - accuracy30: 0.6259 - accuracy50: 0.6006 - val_loss: 9.0484 - val_accuracy10: 0.7671 - val_accuracy20: 0.7394 - val_accuracy30: 0.7083 - val_accuracy50: 0.6561 - 42s/epoch - 33ms/step
Epoch 10/50
1288/1288 - 44s - loss: 8.6384 - accuracy10: 0.6570 - accuracy20: 0.6460 - accuracy30: 0.6268 - accuracy50: 0.6012 - val_loss: 9.0250 - val_accuracy10: 0.7720 - val_accuracy20: 0.7427 - val_accuracy30: 0.7121 - val_accuracy50: 0.6597 - 44s/epoch - 34ms/step
Epoch 11/50
1288/1288 - 44s - loss: 8.5924 - accuracy10: 0.6579 - accuracy20: 0.6466 - accuracy30: 0.6275 - accuracy50: 0.6025 - val_loss: 9.1275 - val_accuracy10: 0.7635 - val_accuracy20: 0.7333 - val_accuracy30: 0.7036 - val_accuracy50: 0.6521 - 44s/epoch - 34ms/step
Epoch 12/50
1288/1288 - 43s - loss: 8.5534 - accuracy10: 0.6595 - accuracy20: 0.6482 - accuracy30: 0.6290 - accuracy50: 0.6041 - val_loss: 9.0766 - val_accuracy10: 0.7703 - val_accuracy20: 0.7401 - val_accuracy30: 0.7094 - val_accuracy50: 0.6569 - 43s/epoch - 34ms/step
Epoch 13/50
1288/1288 - 42s - loss: 8.5209 - accuracy10: 0.6595 - accuracy20: 0.6481 - accuracy30: 0.6295 - accuracy50: 0.6049 - val_loss: 9.1426 - val_accuracy10: 0.7726 - val_accuracy20: 0.7423 - val_accuracy30: 0.7102 - val_accuracy50: 0.6570 - 42s/epoch - 33ms/step
Epoch 14/50
1288/1288 - 42s - loss: 8.4812 - accuracy10: 0.6608 - accuracy20: 0.6497 - accuracy30: 0.6309 - accuracy50: 0.6054 - val_loss: 9.1173 - val_accuracy10: 0.7760 - val_accuracy20: 0.7449 - val_accuracy30: 0.7123 - val_accuracy50: 0.6582 - 42s/epoch - 33ms/step
testing model: results/EXC/W8/deepOF_L2/seq2seq
Evaluating performance on  test set...
5521/5521 - 81s - 81s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.56465596
{'0': {'precision': 0.41814257756534146, 'recall': 0.5361134995700774, 'f1-score': 0.46983589824389543, 'support': 127930}, '1': {'precision': 0.9232815189355453, 'recall': 0.8063455109734075, 'f1-score': 0.8608606309738065, 'support': 1152878}, '2': {'precision': 0.3518412335666759, 'recall': 0.643735329856525, 'f1-score': 0.4549979195339756, 'support': 132497}, 'accuracy': 0.7666398972620914, 'macro avg': {'precision': 0.5644217766891876, 'recall': 0.6620647801333366, 'f1-score': 0.5952314829172258, 'support': 1413305}, 'weighted avg': {'precision': 0.8239848007749153, 'recall': 0.7666398972620914, 'f1-score': 0.7874161970152619, 'support': 1413305}}
[[ 68585  43424  15921]
 [ 82055 929618 141205]
 [ 13383  33821  85293]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6006548
{'0': {'precision': 0.5001879658868768, 'recall': 0.526971823016861, 'f1-score': 0.5132306912361136, 'support': 176740}, '1': {'precision': 0.8745446425987108, 'recall': 0.8030317412104184, 'f1-score': 0.8372639408736341, 'support': 1053520}, '2': {'precision': 0.4418605546550443, 'recall': 0.6269715097380426, 'f1-score': 0.5183863551157024, 'support': 183045}, 'accuracy': 0.7457066945917548, 'macro avg': {'precision': 0.6055310543802106, 'recall': 0.6523250246551073, 'f1-score': 0.6229603290751501, 'support': 1413305}, 'weighted avg': {'precision': 0.7716903698694004, 'recall': 0.7457066945917548, 'f1-score': 0.7554425475961773, 'support': 1413305}}
[[ 93137  66890  16713]
 [ 79258 846010 128252]
 [ 13809  54472 114764]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6562095
{'0': {'precision': 0.5465264435231065, 'recall': 0.5016195947764588, 'f1-score': 0.5231110229247022, 'support': 215486}, '1': {'precision': 0.8252225140633141, 'recall': 0.7956452466196681, 'f1-score': 0.8101640203409861, 'support': 975348}, '2': {'precision': 0.48961782397732023, 'recall': 0.6055216185480354, 'f1-score': 0.5414363974710916, 'support': 222471}, 'accuracy': 0.7208875649629769, 'macro avg': {'precision': 0.6204555938545803, 'recall': 0.6342621533147207, 'f1-score': 0.6249038135789267, 'support': 1413305}, 'weighted avg': {'precision': 0.7299016792367563, 'recall': 0.7208875649629769, 'f1-score': 0.7240962535187265, 'support': 1413305}}
[[108092  90668  16726]
 [ 75619 776031 123698]
 [ 14069  73691 134711]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7522787
{'0': {'precision': 0.6020979561099472, 'recall': 0.4405041921835378, 'f1-score': 0.5087782990006119, 'support': 283146}, '1': {'precision': 0.7233435772430401, 'recall': 0.7904434583196831, 'f1-score': 0.7554063885040171, 'support': 839425}, '2': {'precision': 0.5499345699270922, 'recall': 0.5463860435999918, 'f1-score': 0.5481545639001228, 'support': 290734}, 'accuracy': 0.6701299436427381, 'macro avg': {'precision': 0.6251253677600265, 'recall': 0.5924445647010709, 'f1-score': 0.6041130838015839, 'support': 1413305}, 'weighted avg': {'precision': 0.6633805070109632, 'recall': 0.6701299436427381, 'f1-score': 0.6633619189769726, 'support': 1413305}}
[[124727 139142  19277]
 [ 65179 663518 110728]
 [ 17248 114633 158853]]
Evaluating performance on  train set...
1288/1288 - 20s - 20s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6220506
{'0': {'precision': 0.372395630120952, 'recall': 0.566708229426434, 'f1-score': 0.44944904878508196, 'support': 33684}, '1': {'precision': 0.9206325417478461, 'recall': 0.7729101134305595, 'f1-score': 0.8403286449200565, 'support': 262275}, '2': {'precision': 0.3545652658853407, 'recall': 0.6118925641860878, 'f1-score': 0.4489711665906177, 'support': 33769}, 'accuracy': 0.735354595302795, 'macro avg': {'precision': 0.5491978125847129, 'recall': 0.6505036356810271, 'f1-score': 0.5795829534319188, 'support': 329728}, 'weighted avg': {'precision': 0.8066527221091098, 'recall': 0.735354595302795, 'f1-score': 0.760316820016144, 'support': 329728}}
[[ 19089   9512   5083]
 [ 27029 202715  32531]
 [  5142   7964  20663]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.65241253
{'0': {'precision': 0.4420976216814159, 'recall': 0.5634044802748959, 'f1-score': 0.495433635175052, 'support': 45399}, '1': {'precision': 0.8718822536902964, 'recall': 0.7661671329725745, 'f1-score': 0.8156134143921814, 'support': 238756}, '2': {'precision': 0.43331990654958513, 'recall': 0.5901301209049218, 'f1-score': 0.49971199762165786, 'support': 45573}, 'accuracy': 0.7139187451475155, 'macro avg': {'precision': 0.5824332606404324, 'recall': 0.6399005780507974, 'f1-score': 0.6035863490629637, 'support': 329728}, 'weighted avg': {'precision': 0.7520914128917752, 'recall': 0.7139187451475155, 'f1-score': 0.7278670990560209, 'support': 329728}}
[[ 25578  14286   5535]
 [ 26193 182927  29636]
 [  6085  12594  26894]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7027928
{'0': {'precision': 0.48146520861810843, 'recall': 0.5427114478052717, 'f1-score': 0.5102570514534057, 'support': 54517}, '1': {'precision': 0.8227362685631654, 'recall': 0.7558124773304317, 'f1-score': 0.7878557300811241, 'support': 220560}, '2': {'precision': 0.4737804042219413, 'recall': 0.5691936103639458, 'f1-score': 0.517122718356219, 'support': 54651}, 'accuracy': 0.689647224378882, 'macro avg': {'precision': 0.592660627134405, 'recall': 0.6225725118332165, 'f1-score': 0.6050784999635829, 'support': 329728}, 'weighted avg': {'precision': 0.7084728110553501, 'recall': 0.689647224378882, 'f1-score': 0.6970849220620141, 'support': 329728}}
[[ 29587  19115   5815]
 [ 25123 166702  28735]
 [  6742  16802  31107]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7872242
{'0': {'precision': 0.5296196410304101, 'recall': 0.48854765377026677, 'f1-score': 0.5082552431950023, 'support': 69942}, '1': {'precision': 0.723356112839913, 'recall': 0.7483561110585066, 'f1-score': 0.735643774271782, 'support': 190098}, '2': {'precision': 0.5221032359721047, 'recall': 0.5135173918034669, 'f1-score': 0.5177747232872748, 'support': 69688}, 'accuracy': 0.6436123107531055, 'macro avg': {'precision': 0.5916929966141427, 'recall': 0.5834737188774134, 'f1-score': 0.587224580251353, 'support': 329728}, 'weighted avg': {'precision': 0.6397258879440471, 'recall': 0.6436123107531055, 'f1-score': 0.6413634369465305, 'support': 329728}}
[[ 34170  28793   6979]
 [ 22060 142261  25777]
 [  8288  25614  35786]]
Evaluating performance on  val set...
438/438 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5601888
{'0': {'precision': 0.35769629674821546, 'recall': 0.5822822524580396, 'f1-score': 0.44315948601662886, 'support': 10069}, '1': {'precision': 0.9266345076010428, 'recall': 0.798810014983388, 'f1-score': 0.8579875101312544, 'support': 92102}, '2': {'precision': 0.36650575566282956, 'recall': 0.6058312020460358, 'f1-score': 0.45671538194578337, 'support': 9775}, 'accuracy': 0.7624836974970075, 'macro avg': {'precision': 0.5502788533373626, 'recall': 0.6623078231624877, 'f1-score': 0.5859541260312222, 'support': 111946}, 'weighted avg': {'precision': 0.8265514551000768, 'recall': 0.7624836974970075, 'f1-score': 0.7856371052233244, 'support': 111946}}
[[ 5863  3153  1053]
 [ 9347 73572  9183]
 [ 1181  2672  5922]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.60544187
{'0': {'precision': 0.4260906621211314, 'recall': 0.5786313657407407, 'f1-score': 0.4907813602478756, 'support': 13824}, '1': {'precision': 0.880563238622077, 'recall': 0.7858045467965752, 'f1-score': 0.8304896466506073, 'support': 84675}, '2': {'precision': 0.4452583759227712, 'recall': 0.5831040380754071, 'f1-score': 0.5049425250346137, 'support': 13447}, 'accuracy': 0.735872652886213, 'macro avg': {'precision': 0.5839707588886598, 'recall': 0.6491799835375743, 'f1-score': 0.6087378439776989, 'support': 111946}, 'weighted avg': {'precision': 0.7721522781030173, 'recall': 0.735872652886213, 'f1-score': 0.7494348568805251, 'support': 111946}}
[[ 7999  4744  1081]
 [ 9449 66538  8688]
 [ 1325  4281  7841]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6643537
{'0': {'precision': 0.46519872178949473, 'recall': 0.5528392571055598, 'f1-score': 0.5052466039424094, 'support': 16853}, '1': {'precision': 0.8327328520350151, 'recall': 0.7727914161125873, 'f1-score': 0.801643192488263, 'support': 78659}, '2': {'precision': 0.4877649172876698, 'recall': 0.5615796519410977, 'f1-score': 0.5220760854193184, 'support': 16434}, 'accuracy': 0.7086720383041824, 'macro avg': {'precision': 0.5952321637040598, 'recall': 0.629070108386415, 'f1-score': 0.609655293949997, 'support': 111946}, 'weighted avg': {'precision': 0.7267598316799723, 'recall': 0.7086720383041824, 'f1-score': 0.7159806628370534, 'support': 111946}}
[[ 9317  6432  1104]
 [ 9284 60787  8588]
 [ 1427  5778  9229]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7600069
{'0': {'precision': 0.5220774261301255, 'recall': 0.4930796627744466, 'f1-score': 0.5071643867377695, 'support': 22181}, '1': {'precision': 0.7343987823439878, 'recall': 0.7647153779551825, 'f1-score': 0.7492505337924786, 'support': 68143}, '2': {'precision': 0.5420388204181428, 'recall': 0.5024049579132365, 'f1-score': 0.5214698893502628, 'support': 21622}, 'accuracy': 0.6602290390009469, 'macro avg': {'precision': 0.599505009630752, 'recall': 0.5867333328809553, 'f1-score': 0.5926282699601703, 'support': 111946}, 'weighted avg': {'precision': 0.6551757006890802, 'recall': 0.6602290390009469, 'f1-score': 0.6572884634911719, 'support': 111946}}
[[10937  9885  1359]
 [ 8214 52110  7819]
 [ 1798  8961 10863]]
training model: results/EXC/W8/deepVOL_L2/seq2seq
Epoch 1/50
1289/1289 - 47s - loss: 10.1627 - accuracy10: 0.5928 - accuracy20: 0.5849 - accuracy30: 0.5680 - accuracy50: 0.5470 - val_loss: 9.2538 - val_accuracy10: 0.7209 - val_accuracy20: 0.7028 - val_accuracy30: 0.6730 - val_accuracy50: 0.6179 - 47s/epoch - 37ms/step
Epoch 2/50
1289/1289 - 41s - loss: 9.4844 - accuracy10: 0.6466 - accuracy20: 0.6346 - accuracy30: 0.6117 - accuracy50: 0.5799 - val_loss: 8.9548 - val_accuracy10: 0.7517 - val_accuracy20: 0.7304 - val_accuracy30: 0.6974 - val_accuracy50: 0.6363 - 41s/epoch - 32ms/step
Epoch 3/50
1289/1289 - 41s - loss: 9.2259 - accuracy10: 0.6609 - accuracy20: 0.6496 - accuracy30: 0.6249 - accuracy50: 0.5914 - val_loss: 9.0158 - val_accuracy10: 0.7871 - val_accuracy20: 0.7582 - val_accuracy30: 0.7180 - val_accuracy50: 0.6495 - 41s/epoch - 32ms/step
Epoch 4/50
1289/1289 - 41s - loss: 9.0722 - accuracy10: 0.6688 - accuracy20: 0.6552 - accuracy30: 0.6290 - accuracy50: 0.5947 - val_loss: 8.8841 - val_accuracy10: 0.7821 - val_accuracy20: 0.7552 - val_accuracy30: 0.7189 - val_accuracy50: 0.6531 - 41s/epoch - 32ms/step
Epoch 5/50
1289/1289 - 41s - loss: 8.9806 - accuracy10: 0.6740 - accuracy20: 0.6582 - accuracy30: 0.6318 - accuracy50: 0.5979 - val_loss: 8.9263 - val_accuracy10: 0.7938 - val_accuracy20: 0.7613 - val_accuracy30: 0.7235 - val_accuracy50: 0.6562 - 41s/epoch - 32ms/step
Epoch 6/50
1289/1289 - 41s - loss: 8.9208 - accuracy10: 0.6762 - accuracy20: 0.6592 - accuracy30: 0.6319 - accuracy50: 0.5991 - val_loss: 8.7334 - val_accuracy10: 0.7923 - val_accuracy20: 0.7610 - val_accuracy30: 0.7224 - val_accuracy50: 0.6593 - 41s/epoch - 32ms/step
Epoch 7/50
1289/1289 - 41s - loss: 8.8682 - accuracy10: 0.6766 - accuracy20: 0.6597 - accuracy30: 0.6334 - accuracy50: 0.6003 - val_loss: 8.9184 - val_accuracy10: 0.7958 - val_accuracy20: 0.7628 - val_accuracy30: 0.7255 - val_accuracy50: 0.6602 - 41s/epoch - 32ms/step
Epoch 8/50
1289/1289 - 42s - loss: 8.8190 - accuracy10: 0.6794 - accuracy20: 0.6615 - accuracy30: 0.6350 - accuracy50: 0.6021 - val_loss: 8.7195 - val_accuracy10: 0.7923 - val_accuracy20: 0.7596 - val_accuracy30: 0.7215 - val_accuracy50: 0.6604 - 42s/epoch - 32ms/step
Epoch 9/50
1289/1289 - 41s - loss: 8.7868 - accuracy10: 0.6803 - accuracy20: 0.6616 - accuracy30: 0.6353 - accuracy50: 0.6032 - val_loss: 8.6713 - val_accuracy10: 0.7915 - val_accuracy20: 0.7573 - val_accuracy30: 0.7204 - val_accuracy50: 0.6588 - 41s/epoch - 32ms/step
Epoch 10/50
1289/1289 - 41s - loss: 8.7544 - accuracy10: 0.6814 - accuracy20: 0.6620 - accuracy30: 0.6358 - accuracy50: 0.6050 - val_loss: 8.6369 - val_accuracy10: 0.7782 - val_accuracy20: 0.7441 - val_accuracy30: 0.7089 - val_accuracy50: 0.6518 - 41s/epoch - 32ms/step
Epoch 11/50
1289/1289 - 41s - loss: 8.7263 - accuracy10: 0.6819 - accuracy20: 0.6635 - accuracy30: 0.6366 - accuracy50: 0.6054 - val_loss: 8.6421 - val_accuracy10: 0.7750 - val_accuracy20: 0.7438 - val_accuracy30: 0.7085 - val_accuracy50: 0.6514 - 41s/epoch - 32ms/step
Epoch 12/50
1289/1289 - 41s - loss: 8.7006 - accuracy10: 0.6826 - accuracy20: 0.6628 - accuracy30: 0.6368 - accuracy50: 0.6064 - val_loss: 8.6236 - val_accuracy10: 0.7723 - val_accuracy20: 0.7394 - val_accuracy30: 0.7033 - val_accuracy50: 0.6481 - 41s/epoch - 32ms/step
Epoch 13/50
1289/1289 - 41s - loss: 8.6747 - accuracy10: 0.6833 - accuracy20: 0.6641 - accuracy30: 0.6382 - accuracy50: 0.6076 - val_loss: 8.6374 - val_accuracy10: 0.7761 - val_accuracy20: 0.7419 - val_accuracy30: 0.7071 - val_accuracy50: 0.6515 - 41s/epoch - 32ms/step
Epoch 14/50
1289/1289 - 42s - loss: 8.6446 - accuracy10: 0.6840 - accuracy20: 0.6642 - accuracy30: 0.6385 - accuracy50: 0.6085 - val_loss: 8.6199 - val_accuracy10: 0.7729 - val_accuracy20: 0.7400 - val_accuracy30: 0.7047 - val_accuracy50: 0.6494 - 42s/epoch - 32ms/step
Epoch 15/50
1289/1289 - 41s - loss: 8.6218 - accuracy10: 0.6850 - accuracy20: 0.6650 - accuracy30: 0.6393 - accuracy50: 0.6086 - val_loss: 8.6093 - val_accuracy10: 0.7650 - val_accuracy20: 0.7329 - val_accuracy30: 0.6993 - val_accuracy50: 0.6459 - 41s/epoch - 32ms/step
Epoch 16/50
1289/1289 - 41s - loss: 8.6000 - accuracy10: 0.6850 - accuracy20: 0.6643 - accuracy30: 0.6396 - accuracy50: 0.6099 - val_loss: 8.7671 - val_accuracy10: 0.7630 - val_accuracy20: 0.7320 - val_accuracy30: 0.6987 - val_accuracy50: 0.6453 - 41s/epoch - 32ms/step
Epoch 17/50
1289/1289 - 41s - loss: 8.5759 - accuracy10: 0.6860 - accuracy20: 0.6652 - accuracy30: 0.6393 - accuracy50: 0.6099 - val_loss: 8.7115 - val_accuracy10: 0.7609 - val_accuracy20: 0.7295 - val_accuracy30: 0.6968 - val_accuracy50: 0.6441 - 41s/epoch - 32ms/step
Epoch 18/50
1289/1289 - 41s - loss: 8.5587 - accuracy10: 0.6858 - accuracy20: 0.6653 - accuracy30: 0.6409 - accuracy50: 0.6116 - val_loss: 8.6117 - val_accuracy10: 0.7641 - val_accuracy20: 0.7308 - val_accuracy30: 0.6963 - val_accuracy50: 0.6431 - 41s/epoch - 32ms/step
Epoch 19/50
1289/1289 - 41s - loss: 8.5307 - accuracy10: 0.6876 - accuracy20: 0.6664 - accuracy30: 0.6414 - accuracy50: 0.6126 - val_loss: 8.7273 - val_accuracy10: 0.7614 - val_accuracy20: 0.7308 - val_accuracy30: 0.6976 - val_accuracy50: 0.6428 - 41s/epoch - 32ms/step
Epoch 20/50
1289/1289 - 41s - loss: 8.5259 - accuracy10: 0.6867 - accuracy20: 0.6653 - accuracy30: 0.6401 - accuracy50: 0.6121 - val_loss: 8.7183 - val_accuracy10: 0.7526 - val_accuracy20: 0.7214 - val_accuracy30: 0.6901 - val_accuracy50: 0.6387 - 41s/epoch - 32ms/step
Epoch 21/50
1289/1289 - 41s - loss: 8.4982 - accuracy10: 0.6874 - accuracy20: 0.6661 - accuracy30: 0.6413 - accuracy50: 0.6126 - val_loss: 8.7418 - val_accuracy10: 0.7554 - val_accuracy20: 0.7254 - val_accuracy30: 0.6927 - val_accuracy50: 0.6408 - 41s/epoch - 32ms/step
Epoch 22/50
1289/1289 - 41s - loss: 8.4718 - accuracy10: 0.6883 - accuracy20: 0.6665 - accuracy30: 0.6415 - accuracy50: 0.6131 - val_loss: 8.7698 - val_accuracy10: 0.7428 - val_accuracy20: 0.7131 - val_accuracy30: 0.6809 - val_accuracy50: 0.6318 - 41s/epoch - 32ms/step
Epoch 23/50
1289/1289 - 41s - loss: 8.4596 - accuracy10: 0.6879 - accuracy20: 0.6669 - accuracy30: 0.6420 - accuracy50: 0.6137 - val_loss: 8.8254 - val_accuracy10: 0.7477 - val_accuracy20: 0.7180 - val_accuracy30: 0.6854 - val_accuracy50: 0.6364 - 41s/epoch - 32ms/step
Epoch 24/50
1289/1289 - 42s - loss: 8.4285 - accuracy10: 0.6890 - accuracy20: 0.6691 - accuracy30: 0.6436 - accuracy50: 0.6149 - val_loss: 8.7944 - val_accuracy10: 0.7589 - val_accuracy20: 0.7274 - val_accuracy30: 0.6942 - val_accuracy50: 0.6403 - 42s/epoch - 32ms/step
Epoch 25/50
1289/1289 - 41s - loss: 8.4103 - accuracy10: 0.6887 - accuracy20: 0.6689 - accuracy30: 0.6448 - accuracy50: 0.6158 - val_loss: 8.7931 - val_accuracy10: 0.7465 - val_accuracy20: 0.7140 - val_accuracy30: 0.6805 - val_accuracy50: 0.6312 - 41s/epoch - 32ms/step
testing model: results/EXC/W8/deepVOL_L2/seq2seq
Evaluating performance on  test set...
5521/5521 - 81s - 81s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5730266
{'0': {'precision': 0.4609689625819927, 'recall': 0.5037364183537872, 'f1-score': 0.48140470401039853, 'support': 127930}, '1': {'precision': 0.9307491107670631, 'recall': 0.794174257058175, 'f1-score': 0.8570548667132204, 'support': 1152883}, '2': {'precision': 0.3292327759335813, 'recall': 0.7200993230035397, 'f1-score': 0.45186895416711065, 'support': 132497}, 'accuracy': 0.760939921177944, 'macro avg': {'precision': 0.5736502830942124, 'recall': 0.672669999471834, 'f1-score': 0.5967761749635765, 'support': 1413310}, 'weighted avg': {'precision': 0.8318337389280838, 'recall': 0.760939921177944, 'f1-score': 0.7850658174818458, 'support': 1413310}}
[[ 64443  41071  22416]
 [ 65322 915590 171971]
 [ 10034  27052  95411]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.61606413
{'0': {'precision': 0.5392714889850512, 'recall': 0.49639583569084533, 'f1-score': 0.516946156475011, 'support': 176740}, '1': {'precision': 0.882119227993069, 'recall': 0.7818536300143708, 'f1-score': 0.8289655894240213, 'support': 1053522}, '2': {'precision': 0.40291243750946826, 'recall': 0.697423626589747, 'f1-score': 0.5107542368812713, 'support': 183048}, 'accuracy': 0.7352208644954044, 'macro avg': {'precision': 0.6081010514958628, 'recall': 0.6585576974316544, 'f1-score': 0.618888660926768, 'support': 1413310}, 'weighted avg': {'precision': 0.7771792261698884, 'recall': 0.7352208644954044, 'f1-score': 0.7487324726699807, 'support': 1413310}}
[[ 87733  65281  23726]
 [ 64362 823700 165460]
 [ 10593  44793 127662]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6754641
{'0': {'precision': 0.5715590273957531, 'recall': 0.48215661342268173, 'f1-score': 0.5230651503023163, 'support': 215486}, '1': {'precision': 0.8348979065059979, 'recall': 0.7561101143179372, 'f1-score': 0.7935531980601057, 'support': 975350}, '2': {'precision': 0.43649740682667953, 'recall': 0.6832169152350387, 'f1-score': 0.5326758904916101, 'support': 222474}, 'accuracy': 0.7028663209062413, 'macro avg': {'precision': 0.6143181135761435, 'recall': 0.6404945476585525, 'f1-score': 0.6164314129513441, 'support': 1413310}, 'weighted avg': {'precision': 0.732033287654078, 'recall': 0.7028663209062413, 'f1-score': 0.7112465522547774, 'support': 1413310}}
[[103898  85917  25671]
 [ 67325 737472 170553]
 [ 10557  59919 151998]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.76688296
{'0': {'precision': 0.6123121073373424, 'recall': 0.4340481589003553, 'f1-score': 0.5079950977454177, 'support': 283146}, '1': {'precision': 0.7360518022136411, 'recall': 0.7336799193734767, 'f1-score': 0.734863946897259, 'support': 839426}, '2': {'precision': 0.490135044535964, 'recall': 0.63366329822727, 'f1-score': 0.5527336659596107, 'support': 290738}, 'accuracy': 0.6530761121056244, 'macro avg': {'precision': 0.6128329846956492, 'recall': 0.600463792167034, 'f1-score': 0.5985309035340959, 'support': 1413310}, 'weighted avg': {'precision': 0.6606729073221191, 'recall': 0.6530761121056244, 'f1-score': 0.651945690618596, 'support': 1413310}}
[[122899 127663  32584]
 [ 64494 615870 159062]
 [ 13320  93188 184230]]
Evaluating performance on  train set...
1289/1289 - 20s - 20s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.58601385
{'0': {'precision': 0.4259883047239214, 'recall': 0.4715146453498777, 'f1-score': 0.4475968004530332, 'support': 33526}, '1': {'precision': 0.9193760125745848, 'recall': 0.7981232109710592, 'f1-score': 0.8544694811925146, 'support': 262363}, '2': {'precision': 0.35777058279370955, 'recall': 0.6857066871546349, 'f1-score': 0.4702080019452691, 'support': 33841}, 'accuracy': 0.753377005428684, 'macro avg': {'precision': 0.5677116333640719, 'recall': 0.6517815144918573, 'f1-score': 0.5907580945302723, 'support': 329730}, 'weighted avg': {'precision': 0.8115708215315618, 'recall': 0.753377005428684, 'f1-score': 0.7736621351406604, 'support': 329730}}
[[ 15808  10680   7038]
 [ 18348 209398  34617]
 [  2953   7683  23205]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.63336486
{'0': {'precision': 0.49436567681152727, 'recall': 0.4724796963276836, 'f1-score': 0.4831749757385633, 'support': 45312}, '1': {'precision': 0.8684727836535799, 'recall': 0.7880192435718683, 'f1-score': 0.8262922547037479, 'support': 238833}, '2': {'precision': 0.42641574387515063, 'recall': 0.6521443457277614, 'f1-score': 0.5156590142323138, 'support': 45585}, 'accuracy': 0.725872683710915, 'macro avg': {'precision': 0.5964180681134192, 'recall': 0.6375477618757711, 'f1-score': 0.6083754148915417, 'support': 329730}, 'weighted avg': {'precision': 0.7559482593957727, 'recall': 0.725872683710915, 'f1-score': 0.7361956714041974, 'support': 329730}}
[[ 21409  16296   7607]
 [ 18247 188205  32381]
 [  3650  12207  29728]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.69387704
{'0': {'precision': 0.522832753190784, 'recall': 0.46391998970455756, 'f1-score': 0.49161771725259845, 'support': 54393}, '1': {'precision': 0.8199853227773971, 'recall': 0.7647376102544577, 'f1-score': 0.791398424436017, 'support': 220626}, '2': {'precision': 0.4584373555247342, 'recall': 0.6343514101369012, 'f1-score': 0.532235308551098, 'support': 54711}, 'accuracy': 0.6934795135413824, 'macro avg': {'precision': 0.6004184771643052, 'recall': 0.6210030033653055, 'f1-score': 0.6050838167465712, 'support': 329730}, 'weighted avg': {'precision': 0.7109759194659451, 'recall': 0.6934795135413824, 'f1-score': 0.6989438548214613, 'support': 329730}}
[[ 25234  21048   8111]
 [ 19017 168721  32888]
 [  4013  15992  34706]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7908377
{'0': {'precision': 0.5586910439851617, 'recall': 0.42241206605420567, 'f1-score': 0.48108671914470574, 'support': 69882}, '1': {'precision': 0.7212296977835417, 'recall': 0.7428921542846925, 'f1-score': 0.7319006722885012, 'support': 190142}, '2': {'precision': 0.5003393344109771, 'recall': 0.5817002840501535, 'f1-score': 0.5379609544468545, 'support': 69706}, 'accuracy': 0.6408940648409305, 'macro avg': {'precision': 0.5934200253932268, 'recall': 0.5823348347963505, 'f1-score': 0.5836494486266872, 'support': 329730}, 'weighted avg': {'precision': 0.6400847917271125, 'recall': 0.6408940648409305, 'f1-score': 0.6377444152131229, 'support': 329730}}
[[ 29519  30409   9954]
 [ 18348 141255  30539]
 [  4969  24189  40548]]
Evaluating performance on  val set...
438/438 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5512823
{'0': {'precision': 0.3892357373519914, 'recall': 0.5425627688306492, 'f1-score': 0.45328430553234167, 'support': 9997}, '1': {'precision': 0.9325512450218213, 'recall': 0.7951569331583002, 'f1-score': 0.8583910146047807, 'support': 92173}, '2': {'precision': 0.3506540323411268, 'recall': 0.6965016366612111, 'f1-score': 0.46646571213262994, 'support': 9776}, 'accuracy': 0.763984421060154, 'macro avg': {'precision': 0.5574803382383132, 'recall': 0.6780737795500537, 'f1-score': 0.5927136774232508, 'support': 111946}, 'weighted avg': {'precision': 0.8332162774361839, 'recall': 0.763984421060154, 'f1-score': 0.7879881996085778, 'support': 111946}}
[[ 5424  3182  1391]
 [ 7663 73292 11218]
 [  848  2119  6809]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6020424
{'0': {'precision': 0.4578275754746343, 'recall': 0.5350647461079587, 'f1-score': 0.49344201804702964, 'support': 13746}, '1': {'precision': 0.8839163650985122, 'recall': 0.7783062289045719, 'f1-score': 0.827756300833417, 'support': 84734}, '2': {'precision': 0.41441399087960135, 'recall': 0.6546116144363582, 'f1-score': 0.5075279960848663, 'support': 13466}, 'accuracy': 0.7335590373930287, 'macro avg': {'precision': 0.585385977150916, 'recall': 0.655994196482963, 'f1-score': 0.609575438321771, 'support': 111946}, 'weighted avg': {'precision': 0.7751198429056543, 'recall': 0.7335590373930287, 'f1-score': 0.7481850925461565, 'support': 111946}}
[[ 7355  5073  1318]
 [ 7647 65949 11138]
 [ 1063  3588  8815]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6658308
{'0': {'precision': 0.4874422795359838, 'recall': 0.5157292659675882, 'f1-score': 0.5011869608013433, 'support': 16784}, '1': {'precision': 0.8360565448870938, 'recall': 0.752296842239024, 'f1-score': 0.7919682153224619, 'support': 78695}, '2': {'precision': 0.446721136159473, 'recall': 0.6341774458006922, 'f1-score': 0.5241943579961851, 'support': 16467}, 'accuracy': 0.6994533078448538, 'macro avg': {'precision': 0.5900733201941836, 'recall': 0.6340678513357682, 'f1-score': 0.6057831780399967, 'support': 111946}, 'weighted avg': {'precision': 0.7265186605038129, 'recall': 0.6994533078448538, 'f1-score': 0.7089826268737969, 'support': 111946}}
[[ 8656  6749  1379]
 [ 7938 59202 11555]
 [ 1164  4860 10443]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.76713604
{'0': {'precision': 0.5307528887507125, 'recall': 0.4625841123605654, 'f1-score': 0.4943294242555861, 'support': 22143}, '1': {'precision': 0.7356299679677305, 'recall': 0.7277515331122913, 'f1-score': 0.7316695429001283, 'support': 68162}, '2': {'precision': 0.4941106484235574, 'recall': 0.5757127674321889, 'f1-score': 0.5317995560867339, 'support': 21641}, 'accuracy': 0.6459096350025906, 'macro avg': {'precision': 0.5868311683806667, 'recall': 0.5886828043016819, 'f1-score': 0.5859328410808161, 'support': 111946}, 'weighted avg': {'precision': 0.648415482775246, 'recall': 0.6459096350025906, 'f1-score': 0.646085344878093, 'support': 111946}}
[[10243 10115  1785]
 [ 7586 49605 10971]
 [ 1470  7712 12459]]
training model: results/EXC/W8/deepVOL_L3/seq2seq
Epoch 1/50
1289/1289 - 65s - loss: 10.4331 - accuracy10: 0.5508 - accuracy20: 0.5554 - accuracy30: 0.5523 - accuracy50: 0.5413 - val_loss: 9.8592 - val_accuracy10: 0.7016 - val_accuracy20: 0.6733 - val_accuracy30: 0.6431 - val_accuracy50: 0.5934 - 65s/epoch - 51ms/step
Epoch 2/50
1289/1289 - 57s - loss: 9.3883 - accuracy10: 0.6549 - accuracy20: 0.6441 - accuracy30: 0.6244 - accuracy50: 0.5934 - val_loss: 9.3055 - val_accuracy10: 0.7419 - val_accuracy20: 0.7151 - val_accuracy30: 0.6835 - val_accuracy50: 0.6279 - 57s/epoch - 44ms/step
Epoch 3/50
1289/1289 - 57s - loss: 9.1194 - accuracy10: 0.6677 - accuracy20: 0.6527 - accuracy30: 0.6292 - accuracy50: 0.5969 - val_loss: 9.0137 - val_accuracy10: 0.7590 - val_accuracy20: 0.7317 - val_accuracy30: 0.7005 - val_accuracy50: 0.6427 - 57s/epoch - 44ms/step
Epoch 4/50
1289/1289 - 57s - loss: 8.9783 - accuracy10: 0.6717 - accuracy20: 0.6561 - accuracy30: 0.6319 - accuracy50: 0.5991 - val_loss: 8.9515 - val_accuracy10: 0.7664 - val_accuracy20: 0.7385 - val_accuracy30: 0.7061 - val_accuracy50: 0.6482 - 57s/epoch - 44ms/step
Epoch 5/50
1289/1289 - 56s - loss: 8.8827 - accuracy10: 0.6750 - accuracy20: 0.6582 - accuracy30: 0.6339 - accuracy50: 0.6025 - val_loss: 8.9297 - val_accuracy10: 0.7462 - val_accuracy20: 0.7225 - val_accuracy30: 0.6944 - val_accuracy50: 0.6421 - 56s/epoch - 44ms/step
Epoch 6/50
1289/1289 - 57s - loss: 8.8159 - accuracy10: 0.6772 - accuracy20: 0.6594 - accuracy30: 0.6360 - accuracy50: 0.6045 - val_loss: 8.9165 - val_accuracy10: 0.7615 - val_accuracy20: 0.7330 - val_accuracy30: 0.7012 - val_accuracy50: 0.6456 - 57s/epoch - 44ms/step
Epoch 7/50
1289/1289 - 56s - loss: 8.7587 - accuracy10: 0.6785 - accuracy20: 0.6614 - accuracy30: 0.6369 - accuracy50: 0.6051 - val_loss: 8.8364 - val_accuracy10: 0.7636 - val_accuracy20: 0.7338 - val_accuracy30: 0.7012 - val_accuracy50: 0.6445 - 56s/epoch - 44ms/step
Epoch 8/50
1289/1289 - 57s - loss: 8.7270 - accuracy10: 0.6796 - accuracy20: 0.6620 - accuracy30: 0.6378 - accuracy50: 0.6058 - val_loss: 8.7306 - val_accuracy10: 0.7702 - val_accuracy20: 0.7397 - val_accuracy30: 0.7061 - val_accuracy50: 0.6488 - 57s/epoch - 44ms/step
Epoch 9/50
1289/1289 - 57s - loss: 8.6840 - accuracy10: 0.6809 - accuracy20: 0.6635 - accuracy30: 0.6389 - accuracy50: 0.6068 - val_loss: 8.8051 - val_accuracy10: 0.7459 - val_accuracy20: 0.7198 - val_accuracy30: 0.6895 - val_accuracy50: 0.6387 - 57s/epoch - 44ms/step
Epoch 10/50
1289/1289 - 58s - loss: 8.6659 - accuracy10: 0.6812 - accuracy20: 0.6638 - accuracy30: 0.6383 - accuracy50: 0.6066 - val_loss: 8.8536 - val_accuracy10: 0.7778 - val_accuracy20: 0.7442 - val_accuracy30: 0.7081 - val_accuracy50: 0.6495 - 58s/epoch - 45ms/step
Epoch 11/50
1289/1289 - 57s - loss: 8.6278 - accuracy10: 0.6821 - accuracy20: 0.6639 - accuracy30: 0.6403 - accuracy50: 0.6087 - val_loss: 8.9369 - val_accuracy10: 0.7682 - val_accuracy20: 0.7380 - val_accuracy30: 0.7062 - val_accuracy50: 0.6498 - 57s/epoch - 44ms/step
Epoch 12/50
1289/1289 - 57s - loss: 8.6042 - accuracy10: 0.6825 - accuracy20: 0.6641 - accuracy30: 0.6395 - accuracy50: 0.6092 - val_loss: 8.7924 - val_accuracy10: 0.7548 - val_accuracy20: 0.7278 - val_accuracy30: 0.6977 - val_accuracy50: 0.6461 - 57s/epoch - 44ms/step
Epoch 13/50
1289/1289 - 57s - loss: 8.5789 - accuracy10: 0.6838 - accuracy20: 0.6651 - accuracy30: 0.6399 - accuracy50: 0.6096 - val_loss: 8.9474 - val_accuracy10: 0.7686 - val_accuracy20: 0.7365 - val_accuracy30: 0.7026 - val_accuracy50: 0.6458 - 57s/epoch - 44ms/step
Epoch 14/50
1289/1289 - 57s - loss: 8.5526 - accuracy10: 0.6842 - accuracy20: 0.6647 - accuracy30: 0.6407 - accuracy50: 0.6113 - val_loss: 8.7888 - val_accuracy10: 0.7652 - val_accuracy20: 0.7336 - val_accuracy30: 0.7001 - val_accuracy50: 0.6469 - 57s/epoch - 44ms/step
Epoch 15/50
1289/1289 - 56s - loss: 8.5280 - accuracy10: 0.6856 - accuracy20: 0.6662 - accuracy30: 0.6421 - accuracy50: 0.6129 - val_loss: 8.8667 - val_accuracy10: 0.7675 - val_accuracy20: 0.7344 - val_accuracy30: 0.6999 - val_accuracy50: 0.6466 - 56s/epoch - 43ms/step
Epoch 16/50
1289/1289 - 58s - loss: 8.5024 - accuracy10: 0.6863 - accuracy20: 0.6668 - accuracy30: 0.6428 - accuracy50: 0.6131 - val_loss: 8.9105 - val_accuracy10: 0.7567 - val_accuracy20: 0.7250 - val_accuracy30: 0.6923 - val_accuracy50: 0.6419 - 58s/epoch - 45ms/step
Epoch 17/50
1289/1289 - 57s - loss: 8.4817 - accuracy10: 0.6868 - accuracy20: 0.6676 - accuracy30: 0.6437 - accuracy50: 0.6146 - val_loss: 8.9669 - val_accuracy10: 0.7467 - val_accuracy20: 0.7162 - val_accuracy30: 0.6848 - val_accuracy50: 0.6347 - 57s/epoch - 44ms/step
Epoch 18/50
1289/1289 - 57s - loss: 8.4652 - accuracy10: 0.6865 - accuracy20: 0.6672 - accuracy30: 0.6434 - accuracy50: 0.6147 - val_loss: 8.8700 - val_accuracy10: 0.7491 - val_accuracy20: 0.7161 - val_accuracy30: 0.6841 - val_accuracy50: 0.6334 - 57s/epoch - 44ms/step
testing model: results/EXC/W8/deepVOL_L3/seq2seq
Evaluating performance on  test set...
5521/5521 - 112s - 112s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.56217057
{'0': {'precision': 0.5641733956651084, 'recall': 0.35281013054013916, 'f1-score': 0.43413231248677453, 'support': 127930}, '1': {'precision': 0.9236615775703892, 'recall': 0.8099763809510592, 'f1-score': 0.8630914639894856, 'support': 1152883}, '2': {'precision': 0.31394905110711924, 'recall': 0.7637380468991751, 'f1-score': 0.44498043181918123, 'support': 132497}, 'accuracy': 0.7642597873078093, 'macro avg': {'precision': 0.6005946747808723, 'recall': 0.6421748527967912, 'f1-score': 0.5807347360984804, 'support': 1413310}, 'weighted avg': {'precision': 0.8339612261047188, 'recall': 0.7642597873078093, 'f1-score': 0.7850652689712585, 'support': 1413310}}
[[ 45135  53770  29025]
 [ 26970 933808 192105]
 [  7897  23407 101193]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6043716
{'0': {'precision': 0.6629712708135622, 'recall': 0.34783297499151294, 'f1-score': 0.45627681208900495, 'support': 176740}, '1': {'precision': 0.8735768432433325, 'recall': 0.8037601492897158, 'f1-score': 0.8372154874864424, 'support': 1053522}, '2': {'precision': 0.38654208587420075, 'recall': 0.7417507976049997, 'f1-score': 0.5082331098658821, 'support': 183048}, 'accuracy': 0.7387133749849644, 'macro avg': {'precision': 0.6410300666436985, 'recall': 0.6311146406287428, 'f1-score': 0.6005751364804431, 'support': 1413310}, 'weighted avg': {'precision': 0.7841603902796215, 'recall': 0.7387133749849644, 'f1-score': 0.746968713779024, 'support': 1413310}}
[[ 61476  82945  32319]
 [ 23580 846779 183163]
 [  7672  39600 135776]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.66666436
{'0': {'precision': 0.7029379016662435, 'recall': 0.33399385574932944, 'f1-score': 0.45283006996526903, 'support': 215486}, '1': {'precision': 0.8253856859467482, 'recall': 0.7862121289793408, 'f1-score': 0.8053228061829155, 'support': 975350}, '2': {'precision': 0.42293742552996477, 'recall': 0.7259499986515279, 'f1-score': 0.5344847842022441, 'support': 222474}, 'accuracy': 0.707776779333621, 'macro avg': {'precision': 0.6504203377143188, 'recall': 0.6153853277933994, 'f1-score': 0.5975458867834762, 'support': 1413310}, 'weighted avg': {'precision': 0.7433654232079067, 'recall': 0.707776779333621, 'f1-score': 0.7089450349517463, 'support': 1413310}}
[[ 71971 108244  35271]
 [ 23429 766832 185089]
 [  6986  53983 161505]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.764839
{'0': {'precision': 0.7420629610797406, 'recall': 0.2937918953472767, 'f1-score': 0.42093172117688427, 'support': 283146}, '1': {'precision': 0.7263995100697834, 'recall': 0.7658578600138666, 'f1-score': 0.7456070051320711, 'support': 839426}, '2': {'precision': 0.47454617537873783, 'recall': 0.6793023271811734, 'f1-score': 0.5587567528571005, 'support': 290738}, 'accuracy': 0.653477297974259, 'macro avg': {'precision': 0.647669548842754, 'recall': 0.5796506941807723, 'f1-score': 0.5750984930553519, 'support': 1413310}, 'weighted avg': {'precision': 0.6777277456856498, 'recall': 0.653477297974259, 'f1-score': 0.6421230019079407, 'support': 1413310}}
[[ 83186 156618  43342]
 [ 21201 642881 175344]
 [  7714  85525 197499]]
Evaluating performance on  train set...
1289/1289 - 26s - 26s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.60404634
{'0': {'precision': 0.5126536514822849, 'recall': 0.3172164886953409, 'f1-score': 0.39192202096884154, 'support': 33526}, '1': {'precision': 0.9164961956117027, 'recall': 0.7974676307253691, 'f1-score': 0.8528488623301239, 'support': 262363}, '2': {'precision': 0.32173837612768913, 'recall': 0.7672054608315357, 'f1-score': 0.45335568418938865, 'support': 33841}, 'accuracy': 0.7455311921875474, 'macro avg': {'precision': 0.5836294077405589, 'recall': 0.6272965267507485, 'f1-score': 0.5660421891627847, 'support': 329730}, 'weighted avg': {'precision': 0.8143931885949274, 'recall': 0.7455311921875474, 'f1-score': 0.7649821776943948, 'support': 329730}}
[[ 10635  13130   9761]
 [  8165 209226  44972]
 [  1945   5933  25963]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.64906734
{'0': {'precision': 0.5859998388006771, 'recall': 0.3209083686440678, 'f1-score': 0.4147106636625503, 'support': 45312}, '1': {'precision': 0.865469657658485, 'recall': 0.7891246184572484, 'f1-score': 0.8255358104941327, 'support': 238833}, '2': {'precision': 0.38418377299170403, 'recall': 0.7344959964900735, 'f1-score': 0.5044901157184185, 'support': 45585}, 'accuracy': 0.7172292481727474, 'macro avg': {'precision': 0.6118844231502888, 'recall': 0.6148429945304632, 'f1-score': 0.5815788632917005, 'support': 329730}, 'weighted avg': {'precision': 0.7605269667155311, 'recall': 0.7172292481727474, 'f1-score': 0.7246951922622957, 'support': 329730}}
[[ 14541  19452  11319]
 [  8014 188469  42350]
 [  2259   9844  33482]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7101493
{'0': {'precision': 0.6122891909200883, 'recall': 0.3163826227639586, 'f1-score': 0.4171929356719476, 'support': 54393}, '1': {'precision': 0.8175595281105635, 'recall': 0.7692565699418926, 'f1-score': 0.7926728737999659, 'support': 220626}, '2': {'precision': 0.41569449023215255, 'recall': 0.7144632706402735, 'f1-score': 0.5255875867261873, 'support': 54711}, 'accuracy': 0.685457798805083, 'macro avg': {'precision': 0.615181069754268, 'recall': 0.6000341544487083, 'f1-score': 0.5784844653993669, 'support': 329730}, 'weighted avg': {'precision': 0.7170175466767623, 'recall': 0.685457798805083, 'f1-score': 0.6864162898807264, 'support': 329730}}
[[ 17209  24686  12498]
 [  8462 169718  42446]
 [  2435  13187  39089]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.80369306
{'0': {'precision': 0.6430038876070673, 'recall': 0.2911193154174179, 'f1-score': 0.40078407423094725, 'support': 69882}, '1': {'precision': 0.7218364628976343, 'recall': 0.7468313155431204, 'f1-score': 0.7341211989619199, 'support': 190142}, '2': {'precision': 0.4578799388349036, 'recall': 0.6658393825495653, 'f1-score': 0.5426168082258244, 'support': 69706}, 'accuracy': 0.633127103994177, 'macro avg': {'precision': 0.6075734297798684, 'recall': 0.567930004503368, 'f1-score': 0.5591740271395639, 'support': 329730}, 'weighted avg': {'precision': 0.6493276481316982, 'recall': 0.633127103994177, 'f1-score': 0.6229900613308276, 'support': 329730}}
[[ 20344  34402  15136]
 [  8322 142004  39816]
 [  2973  20320  46413]]
Evaluating performance on  val set...
438/438 - 8s - 8s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5521471
{'0': {'precision': 0.4914976697317042, 'recall': 0.39031709512853857, 'f1-score': 0.43510258697591436, 'support': 9997}, '1': {'precision': 0.9266817557790064, 'recall': 0.8128736180877263, 'f1-score': 0.8660548125715211, 'support': 92173}, '2': {'precision': 0.32162909216550056, 'recall': 0.7617635024549918, 'f1-score': 0.4522927421803826, 'support': 9776}, 'accuracy': 0.7706751469458489, 'macro avg': {'precision': 0.579936172558737, 'recall': 0.6549847385570856, 'f1-score': 0.5844833805759394, 'support': 111946}, 'weighted avg': {'precision': 0.8349810237501665, 'recall': 0.7706751469458489, 'f1-score': 0.7914369843380599, 'support': 111946}}
[[ 3902  4207  1888]
 [ 3429 74925 13819]
 [  608  1721  7447]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6038098
{'0': {'precision': 0.5605536332179931, 'recall': 0.3889131383675251, 'f1-score': 0.459219172787012, 'support': 13746}, '1': {'precision': 0.8780098598858329, 'recall': 0.7986994594849766, 'f1-score': 0.8364789202417591, 'support': 84734}, '2': {'precision': 0.38422361719767856, 'recall': 0.7227090450022279, 'f1-score': 0.5017141384198994, 'support': 13466}, 'accuracy': 0.7392403480249405, 'macro avg': {'precision': 0.6075957034338348, 'recall': 0.6367738809515765, 'f1-score': 0.5991374104828902, 'support': 111946}, 'weighted avg': {'precision': 0.7796313663638238, 'recall': 0.7392403480249405, 'f1-score': 0.7498857856900456, 'support': 111946}}
[[ 5346  6409  1991]
 [ 3451 67677 13606]
 [  740  2994  9732]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6713658
{'0': {'precision': 0.5919395465994962, 'recall': 0.37803860819828405, 'f1-score': 0.4614042104497691, 'support': 16784}, '1': {'precision': 0.8313817648337318, 'recall': 0.7777241247855645, 'f1-score': 0.8036583043903591, 'support': 78695}, '2': {'precision': 0.4184201948498787, 'recall': 0.7015849881581344, 'f1-score': 0.524207087435909, 'support': 16467}, 'accuracy': 0.7065996105265039, 'macro avg': {'precision': 0.6139138354277023, 'recall': 0.6191159070473277, 'f1-score': 0.596423200758679, 'support': 111946}, 'weighted avg': {'precision': 0.7347366291096548, 'recall': 0.7065996105265039, 'f1-score': 0.7112377096188819, 'support': 111946}}
[[ 6345  8259  2180]
 [ 3614 61203 13878]
 [  760  4154 11553]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.77267206
{'0': {'precision': 0.620755818803704, 'recall': 0.33604299327101117, 'f1-score': 0.43603867565191917, 'support': 22143}, '1': {'precision': 0.7334574087329992, 'recall': 0.7516211378774097, 'f1-score': 0.7424281946497405, 'support': 68162}, '2': {'precision': 0.4645786973994487, 'recall': 0.6463656947460839, 'f1-score': 0.5405990338164252, 'support': 21641}, 'accuracy': 0.6490718739392207, 'macro avg': {'precision': 0.6062639749787174, 'recall': 0.5780099419648349, 'f1-score': 0.5730219680393617, 'support': 111946}, 'weighted avg': {'precision': 0.6591862824955834, 'recall': 0.6490718739392207, 'f1-score': 0.6428072346443582, 'support': 111946}}
[[ 7441 11892  2810]
 [ 3619 51232 13311]
 [  927  6726 13988]]
training model: results/EXC/W9/deepLOB_L1/seq2seq
Epoch 1/50
1250/1250 - 43s - loss: 9.9787 - accuracy10: 0.5049 - accuracy20: 0.5187 - accuracy30: 0.5252 - accuracy50: 0.5344 - val_loss: 12.0509 - val_accuracy10: 0.7064 - val_accuracy20: 0.6890 - val_accuracy30: 0.6730 - val_accuracy50: 0.6398 - 43s/epoch - 34ms/step
Epoch 2/50
1250/1250 - 35s - loss: 9.3415 - accuracy10: 0.5825 - accuracy20: 0.5841 - accuracy30: 0.5792 - accuracy50: 0.5754 - val_loss: 11.1096 - val_accuracy10: 0.7776 - val_accuracy20: 0.7547 - val_accuracy30: 0.7314 - val_accuracy50: 0.6870 - 35s/epoch - 28ms/step
Epoch 3/50
1250/1250 - 35s - loss: 8.8529 - accuracy10: 0.6420 - accuracy20: 0.6275 - accuracy30: 0.6103 - accuracy50: 0.5978 - val_loss: 10.8368 - val_accuracy10: 0.7534 - val_accuracy20: 0.7321 - val_accuracy30: 0.7107 - val_accuracy50: 0.6751 - 35s/epoch - 28ms/step
Epoch 4/50
1250/1250 - 35s - loss: 8.6094 - accuracy10: 0.6598 - accuracy20: 0.6399 - accuracy30: 0.6191 - accuracy50: 0.6045 - val_loss: 11.1097 - val_accuracy10: 0.8223 - val_accuracy20: 0.7922 - val_accuracy30: 0.7623 - val_accuracy50: 0.7117 - 35s/epoch - 28ms/step
Epoch 5/50
1250/1250 - 34s - loss: 8.4756 - accuracy10: 0.6676 - accuracy20: 0.6442 - accuracy30: 0.6210 - accuracy50: 0.6043 - val_loss: 10.8440 - val_accuracy10: 0.8279 - val_accuracy20: 0.7940 - val_accuracy30: 0.7635 - val_accuracy50: 0.7134 - 34s/epoch - 27ms/step
Epoch 6/50
1250/1250 - 34s - loss: 8.3534 - accuracy10: 0.6737 - accuracy20: 0.6490 - accuracy30: 0.6238 - accuracy50: 0.6064 - val_loss: 10.6229 - val_accuracy10: 0.8177 - val_accuracy20: 0.7862 - val_accuracy30: 0.7573 - val_accuracy50: 0.7106 - 34s/epoch - 27ms/step
Epoch 7/50
1250/1250 - 34s - loss: 8.2669 - accuracy10: 0.6776 - accuracy20: 0.6518 - accuracy30: 0.6258 - accuracy50: 0.6071 - val_loss: 10.7698 - val_accuracy10: 0.8347 - val_accuracy20: 0.7984 - val_accuracy30: 0.7668 - val_accuracy50: 0.7160 - 34s/epoch - 27ms/step
Epoch 8/50
1250/1250 - 34s - loss: 8.1932 - accuracy10: 0.6814 - accuracy20: 0.6557 - accuracy30: 0.6294 - accuracy50: 0.6095 - val_loss: 10.7671 - val_accuracy10: 0.8207 - val_accuracy20: 0.7864 - val_accuracy30: 0.7548 - val_accuracy50: 0.7071 - 34s/epoch - 27ms/step
Epoch 9/50
1250/1250 - 34s - loss: 8.1310 - accuracy10: 0.6845 - accuracy20: 0.6596 - accuracy30: 0.6326 - accuracy50: 0.6123 - val_loss: 10.3923 - val_accuracy10: 0.8168 - val_accuracy20: 0.7821 - val_accuracy30: 0.7506 - val_accuracy50: 0.7036 - 34s/epoch - 27ms/step
Epoch 10/50
1250/1250 - 34s - loss: 8.0800 - accuracy10: 0.6864 - accuracy20: 0.6620 - accuracy30: 0.6345 - accuracy50: 0.6126 - val_loss: 11.1633 - val_accuracy10: 0.8385 - val_accuracy20: 0.7991 - val_accuracy30: 0.7667 - val_accuracy50: 0.7142 - 34s/epoch - 27ms/step
Epoch 11/50
1250/1250 - 34s - loss: 8.0496 - accuracy10: 0.6863 - accuracy20: 0.6618 - accuracy30: 0.6346 - accuracy50: 0.6127 - val_loss: 10.7737 - val_accuracy10: 0.8308 - val_accuracy20: 0.7919 - val_accuracy30: 0.7596 - val_accuracy50: 0.7092 - 34s/epoch - 27ms/step
Epoch 12/50
1250/1250 - 34s - loss: 8.0053 - accuracy10: 0.6862 - accuracy20: 0.6640 - accuracy30: 0.6368 - accuracy50: 0.6138 - val_loss: 10.5367 - val_accuracy10: 0.8219 - val_accuracy20: 0.7878 - val_accuracy30: 0.7565 - val_accuracy50: 0.7087 - 34s/epoch - 27ms/step
Epoch 13/50
1250/1250 - 34s - loss: 7.9759 - accuracy10: 0.6870 - accuracy20: 0.6647 - accuracy30: 0.6379 - accuracy50: 0.6155 - val_loss: 10.5732 - val_accuracy10: 0.8196 - val_accuracy20: 0.7868 - val_accuracy30: 0.7557 - val_accuracy50: 0.7083 - 34s/epoch - 27ms/step
Epoch 14/50
1250/1250 - 34s - loss: 7.9438 - accuracy10: 0.6872 - accuracy20: 0.6662 - accuracy30: 0.6387 - accuracy50: 0.6154 - val_loss: 10.7942 - val_accuracy10: 0.8295 - val_accuracy20: 0.7929 - val_accuracy30: 0.7616 - val_accuracy50: 0.7107 - 34s/epoch - 27ms/step
Epoch 15/50
1250/1250 - 34s - loss: 7.9166 - accuracy10: 0.6897 - accuracy20: 0.6684 - accuracy30: 0.6408 - accuracy50: 0.6161 - val_loss: 10.8665 - val_accuracy10: 0.8192 - val_accuracy20: 0.7824 - val_accuracy30: 0.7491 - val_accuracy50: 0.6994 - 34s/epoch - 27ms/step
Epoch 16/50
1250/1250 - 34s - loss: 7.8900 - accuracy10: 0.6895 - accuracy20: 0.6681 - accuracy30: 0.6413 - accuracy50: 0.6168 - val_loss: 10.4099 - val_accuracy10: 0.8107 - val_accuracy20: 0.7777 - val_accuracy30: 0.7472 - val_accuracy50: 0.7006 - 34s/epoch - 27ms/step
Epoch 17/50
1250/1250 - 34s - loss: 7.8589 - accuracy10: 0.6892 - accuracy20: 0.6685 - accuracy30: 0.6420 - accuracy50: 0.6171 - val_loss: 10.7905 - val_accuracy10: 0.8101 - val_accuracy20: 0.7753 - val_accuracy30: 0.7434 - val_accuracy50: 0.6961 - 34s/epoch - 27ms/step
Epoch 18/50
1250/1250 - 34s - loss: 7.8344 - accuracy10: 0.6907 - accuracy20: 0.6692 - accuracy30: 0.6429 - accuracy50: 0.6177 - val_loss: 11.0362 - val_accuracy10: 0.8028 - val_accuracy20: 0.7682 - val_accuracy30: 0.7369 - val_accuracy50: 0.6895 - 34s/epoch - 27ms/step
Epoch 19/50
1250/1250 - 33s - loss: 7.8152 - accuracy10: 0.6911 - accuracy20: 0.6701 - accuracy30: 0.6422 - accuracy50: 0.6168 - val_loss: 11.1743 - val_accuracy10: 0.8073 - val_accuracy20: 0.7724 - val_accuracy30: 0.7429 - val_accuracy50: 0.6958 - 33s/epoch - 27ms/step
testing model: results/EXC/W9/deepLOB_L1/seq2seq
Evaluating performance on  test set...
2354/2354 - 31s - 31s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.46207586
{'0': {'precision': 0.43949896360353935, 'recall': 0.43347035677386736, 'f1-score': 0.43646384382124437, 'support': 45491}, '1': {'precision': 0.9080394841402817, 'recall': 0.9244598496176107, 'f1-score': 0.9161760983931514, 'support': 512959}, '2': {'precision': 0.4261904761904762, 'recall': 0.3422562141491396, 'f1-score': 0.3796394485683987, 'support': 43932}, 'accuracy': 0.8449206649601084, 'macro avg': {'precision': 0.5912429746447657, 'recall': 0.5667288068468727, 'f1-score': 0.5774264635942649, 'support': 602382}, 'weighted avg': {'precision': 0.8375145225096423, 'recall': 0.8449206649601084, 'f1-score': 0.8408190686797276, 'support': 602382}}
[[ 19719  22304   3468]
 [ 21973 474210  16776]
 [  3175  25721  15036]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.54677474
{'0': {'precision': 0.49541899067048556, 'recall': 0.46906023026420124, 'f1-score': 0.48187942424711433, 'support': 63058}, '1': {'precision': 0.8682127182687525, 'recall': 0.9099695152591203, 'f1-score': 0.888600832342571, 'support': 477616}, '2': {'precision': 0.5102869904019767, 'recall': 0.34807480391521356, 'f1-score': 0.4138535645472062, 'support': 61708}, 'accuracy': 0.8062541709413628, 'macro avg': {'precision': 0.6246395664470715, 'recall': 0.5757015164795117, 'f1-score': 0.5947779403789638, 'support': 602382}, 'weighted avg': {'precision': 0.792522362829688, 'recall': 0.8062541709413628, 'f1-score': 0.797391694365673, 'support': 602382}}
[[ 29578  30173   3307]
 [ 25694 434616  17306]
 [  4431  35798  21479]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6232576
{'0': {'precision': 0.5110219300118117, 'recall': 0.46763817263114027, 'f1-score': 0.4883684557688515, 'support': 76788}, '1': {'precision': 0.8332689848718843, 'recall': 0.8912464782322003, 'f1-score': 0.8612831419330268, 'support': 450413}, '2': {'precision': 0.5380949544290224, 'recall': 0.36045011372554236, 'f1-score': 0.4317120963502254, 'support': 75181}, 'accuracy': 0.7710007935164065, 'macro avg': {'precision': 0.6274619564375729, 'recall': 0.5731115881962943, 'f1-score': 0.593787898017368, 'support': 602382}, 'weighted avg': {'precision': 0.7553513418624317, 'recall': 0.7710007935164065, 'f1-score': 0.7601331180293656, 'support': 602382}}
[[ 35909  37055   3824]
 [ 29546 401429  19438]
 [  4814  43268  27099]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.726612
{'0': {'precision': 0.5402727575687661, 'recall': 0.41905850772978076, 'f1-score': 0.4720077490299715, 'support': 100585}, '1': {'precision': 0.758675068725614, 'recall': 0.8774766246285838, 'f1-score': 0.8137627350804496, 'support': 403523}, '2': {'precision': 0.5771772500997346, 'recall': 0.33860431039746014, 'f1-score': 0.4268151121999397, 'support': 98274}, 'accuracy': 0.7130176532499312, 'macro avg': {'precision': 0.6253750254647049, 'recall': 0.5450464809186082, 'f1-score': 0.570861865436787, 'support': 602382}, 'weighted avg': {'precision': 0.6925965453046764, 'recall': 0.7130176532499312, 'f1-score': 0.6935693761108148, 'support': 602382}}
[[ 42151  53265   5169]
 [ 30233 354082  19208]
 [  5634  59364  33276]]
Evaluating performance on  train set...
1250/1250 - 16s - 16s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.46557242
{'0': {'precision': 0.388362415638004, 'recall': 0.4974246428091548, 'f1-score': 0.43617940460293775, 'support': 22327}, '1': {'precision': 0.9233278709570234, 'recall': 0.8904036266317111, 'f1-score': 0.9065669157350544, 'support': 274635}, '2': {'precision': 0.3896403203868823, 'recall': 0.449466114621922, 'f1-score': 0.41742051686803067, 'support': 22945}, 'accuracy': 0.8313509863804168, 'macro avg': {'precision': 0.5671102023273032, 'recall': 0.6124314613542626, 'f1-score': 0.5867222790686742, 'support': 319907}, 'weighted avg': {'precision': 0.8477132874413779, 'recall': 0.8313509863804168, 'f1-score': 0.8386540345444251, 'support': 319907}}
[[ 11106   9033   2188]
 [ 16132 244536  13967]
 [  1359  11273  10313]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.5350633
{'0': {'precision': 0.4579475097254945, 'recall': 0.5284522003034902, 'f1-score': 0.4906801303314058, 'support': 31632}, '1': {'precision': 0.8844175073539573, 'recall': 0.8761255094617112, 'f1-score': 0.8802519811289241, 'support': 255662}, '2': {'precision': 0.480092899800929, 'recall': 0.44368809983748814, 'f1-score': 0.46117317100377675, 'support': 32613}, 'accuracy': 0.7976630708299599, 'macro avg': {'precision': 0.6074859722934602, 'recall': 0.6160886032008965, 'f1-score': 0.6107017608213688, 'support': 319907}, 'weighted avg': {'precision': 0.8010297184305814, 'recall': 0.7976630708299599, 'f1-score': 0.7990085134366306, 'support': 319907}}
[[ 16716  12938   1978]
 [ 17978 223992  13692]
 [  1808  16335  14470]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6032807
{'0': {'precision': 0.4881794445763114, 'recall': 0.526535418960088, 'f1-score': 0.5066325085292706, 'support': 39061}, '1': {'precision': 0.8481933354975776, 'recall': 0.8581519592557946, 'f1-score': 0.853143586966855, 'support': 240525}, '2': {'precision': 0.5189380736609737, 'recall': 0.44309416929143625, 'f1-score': 0.4780264618924668, 'support': 40321}, 'accuracy': 0.7653474290965812, 'macro avg': {'precision': 0.6184369512449542, 'recall': 0.609260515835773, 'f1-score': 0.6126008524628641, 'support': 319907}, 'weighted avg': {'precision': 0.7627359869375608, 'recall': 0.7653474290965812, 'f1-score': 0.763554528787525, 'support': 319907}}
[[ 20567  16434   2060]
 [ 19616 206407  14502]
 [  1947  20508  17866]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7006734
{'0': {'precision': 0.5385198665453442, 'recall': 0.478387220939184, 'f1-score': 0.5066756354593449, 'support': 51960}, '1': {'precision': 0.7705931332149503, 'recall': 0.8468433559447056, 'f1-score': 0.8069209262599728, 'support': 214199}, '2': {'precision': 0.569521574762091, 'recall': 0.4064151224231599, 'f1-score': 0.4743385123177312, 'support': 53748}, 'accuracy': 0.7130009659057164, 'macro avg': {'precision': 0.6262115248407951, 'recall': 0.5772152331023498, 'f1-score': 0.5959783580123497, 'support': 319907}, 'weighted avg': {'precision': 0.6991169821464303, 'recall': 0.7130009659057164, 'f1-score': 0.7022768112685277, 'support': 319907}}
[[ 24857  24497   2606]
 [ 18901 181393  13905]
 [  2400  29504  21844]]
Evaluating performance on  val set...
495/495 - 6s - 6s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.49318254
{'0': {'precision': 0.342911877394636, 'recall': 0.46453287197231835, 'f1-score': 0.3945628214548127, 'support': 9248}, '1': {'precision': 0.9195694583288849, 'recall': 0.876133936249896, 'f1-score': 0.8973263754060633, 'support': 108141}, '2': {'precision': 0.3809911376379092, 'recall': 0.45644637053087755, 'f1-score': 0.41531940063091477, 'support': 9230}, 'accuracy': 0.8154779298525497, 'macro avg': {'precision': 0.5478241577871433, 'recall': 0.5990377262510306, 'f1-score': 0.5690695324972636, 'support': 126619}, 'weighted avg': {'precision': 0.8381914091541351, 'recall': 0.8154779298525497, 'f1-score': 0.8254692155476236, 'support': 126619}}
[[ 4296  3850  1102]
 [ 7652 94746  5743]
 [  580  4437  4213]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.56334174
{'0': {'precision': 0.4088960675902342, 'recall': 0.5097978467973047, 'f1-score': 0.45380584666298956, 'support': 12911}, '1': {'precision': 0.8828249418106089, 'recall': 0.8587856759816481, 'f1-score': 0.8706394031834245, 'support': 100698}, '2': {'precision': 0.4656215183829381, 'recall': 0.4497309761721752, 'f1-score': 0.4575383171723491, 'support': 13010}, 'accuracy': 0.7811702825010465, 'macro avg': {'precision': 0.5857808425945937, 'recall': 0.6061048329837093, 'f1-score': 0.5939945223395877, 'support': 126619}, 'weighted avg': {'precision': 0.7916323701282132, 'recall': 0.7811702825010465, 'f1-score': 0.7856901998471209, 'support': 126619}}
[[ 6582  5139  1190]
 [ 8695 86478  5525]
 [  820  6339  5851]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.62799966
{'0': {'precision': 0.4366384586726276, 'recall': 0.5231809195842102, 'f1-score': 0.47600812300551204, 'support': 15681}, '1': {'precision': 0.8512631826641281, 'recall': 0.8371603782515857, 'f1-score': 0.8441528825909643, 'support': 95069}, '2': {'precision': 0.5016741071428571, 'recall': 0.4532106622975613, 'f1-score': 0.47621254759145837, 'support': 15869}, 'accuracy': 0.7501559797502745, 'macro avg': {'precision': 0.5965252494932044, 'recall': 0.6045173200444525, 'f1-score': 0.5987911843959782, 'support': 126619}, 'weighted avg': {'precision': 0.7561008504994627, 'recall': 0.7501559797502745, 'f1-score': 0.7524468736099532, 'support': 126619}}
[[ 8204  6161  1316]
 [ 9653 79588  5828]
 [  932  7745  7192]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.71610105
{'0': {'precision': 0.4854977408541029, 'recall': 0.4867985190958691, 'f1-score': 0.48614725985745905, 'support': 20528}, '1': {'precision': 0.7799875768130089, 'recall': 0.8236389617691154, 'f1-score': 0.8012191648151312, 'support': 85376}, '2': {'precision': 0.5491751668555598, 'recall': 0.42104755008447986, 'f1-score': 0.4766510916195317, 'support': 20715}, 'accuracy': 0.7031646119460745, 'macro avg': {'precision': 0.6048868281742238, 'recall': 0.5771616769831548, 'f1-score': 0.5880058387640407, 'support': 126619}, 'weighted avg': {'precision': 0.6944825070775587, 'recall': 0.7031646119460745, 'f1-score': 0.6970387203224568, 'support': 126619}}
[[ 9993  8932  1603]
 [ 9500 70319  5557]
 [ 1090 10903  8722]]
training model: results/EXC/W9/deepOF_L1/seq2seq
Epoch 1/50
1250/1250 - 40s - loss: 11.1166 - accuracy10: 0.4567 - accuracy20: 0.4664 - accuracy30: 0.4678 - accuracy50: 0.4750 - val_loss: 12.5172 - val_accuracy10: 0.7568 - val_accuracy20: 0.7312 - val_accuracy30: 0.7085 - val_accuracy50: 0.6601 - 40s/epoch - 32ms/step
Epoch 2/50
1250/1250 - 32s - loss: 10.5243 - accuracy10: 0.5019 - accuracy20: 0.4989 - accuracy30: 0.4996 - accuracy50: 0.5088 - val_loss: 12.1539 - val_accuracy10: 0.7654 - val_accuracy20: 0.7440 - val_accuracy30: 0.7231 - val_accuracy50: 0.6769 - 32s/epoch - 26ms/step
Epoch 3/50
1250/1250 - 32s - loss: 10.3079 - accuracy10: 0.5301 - accuracy20: 0.5209 - accuracy30: 0.5212 - accuracy50: 0.5298 - val_loss: 12.0838 - val_accuracy10: 0.7680 - val_accuracy20: 0.7444 - val_accuracy30: 0.7208 - val_accuracy50: 0.6750 - 32s/epoch - 25ms/step
Epoch 4/50
1250/1250 - 32s - loss: 10.1426 - accuracy10: 0.5510 - accuracy20: 0.5358 - accuracy30: 0.5337 - accuracy50: 0.5406 - val_loss: 12.0281 - val_accuracy10: 0.7610 - val_accuracy20: 0.7293 - val_accuracy30: 0.7023 - val_accuracy50: 0.6622 - 32s/epoch - 25ms/step
Epoch 5/50
1250/1250 - 31s - loss: 10.0266 - accuracy10: 0.5612 - accuracy20: 0.5434 - accuracy30: 0.5399 - accuracy50: 0.5464 - val_loss: 11.7578 - val_accuracy10: 0.7519 - val_accuracy20: 0.7147 - val_accuracy30: 0.6914 - val_accuracy50: 0.6571 - 31s/epoch - 25ms/step
Epoch 6/50
1250/1250 - 32s - loss: 9.9327 - accuracy10: 0.5682 - accuracy20: 0.5477 - accuracy30: 0.5429 - accuracy50: 0.5494 - val_loss: 11.6862 - val_accuracy10: 0.7728 - val_accuracy20: 0.7374 - val_accuracy30: 0.7128 - val_accuracy50: 0.6734 - 32s/epoch - 25ms/step
Epoch 7/50
1250/1250 - 32s - loss: 9.8531 - accuracy10: 0.5753 - accuracy20: 0.5533 - accuracy30: 0.5472 - accuracy50: 0.5526 - val_loss: 11.3308 - val_accuracy10: 0.7522 - val_accuracy20: 0.7146 - val_accuracy30: 0.6936 - val_accuracy50: 0.6628 - 32s/epoch - 25ms/step
Epoch 8/50
1250/1250 - 31s - loss: 9.7757 - accuracy10: 0.5791 - accuracy20: 0.5561 - accuracy30: 0.5494 - accuracy50: 0.5546 - val_loss: 11.3140 - val_accuracy10: 0.7550 - val_accuracy20: 0.7188 - val_accuracy30: 0.6979 - val_accuracy50: 0.6662 - 31s/epoch - 25ms/step
Epoch 9/50
1250/1250 - 31s - loss: 9.7099 - accuracy10: 0.5839 - accuracy20: 0.5608 - accuracy30: 0.5531 - accuracy50: 0.5576 - val_loss: 11.3148 - val_accuracy10: 0.7590 - val_accuracy20: 0.7228 - val_accuracy30: 0.6990 - val_accuracy50: 0.6644 - 31s/epoch - 25ms/step
Epoch 10/50
1250/1250 - 31s - loss: 9.6469 - accuracy10: 0.5869 - accuracy20: 0.5637 - accuracy30: 0.5555 - accuracy50: 0.5587 - val_loss: 11.3246 - val_accuracy10: 0.7604 - val_accuracy20: 0.7247 - val_accuracy30: 0.7022 - val_accuracy50: 0.6688 - 31s/epoch - 25ms/step
Epoch 11/50
1250/1250 - 31s - loss: 9.5888 - accuracy10: 0.5890 - accuracy20: 0.5664 - accuracy30: 0.5565 - accuracy50: 0.5597 - val_loss: 11.2827 - val_accuracy10: 0.7522 - val_accuracy20: 0.7135 - val_accuracy30: 0.6912 - val_accuracy50: 0.6601 - 31s/epoch - 25ms/step
Epoch 12/50
1250/1250 - 31s - loss: 9.5404 - accuracy10: 0.5933 - accuracy20: 0.5696 - accuracy30: 0.5595 - accuracy50: 0.5612 - val_loss: 11.2404 - val_accuracy10: 0.7481 - val_accuracy20: 0.7133 - val_accuracy30: 0.6921 - val_accuracy50: 0.6608 - 31s/epoch - 25ms/step
Epoch 13/50
1250/1250 - 31s - loss: 9.5028 - accuracy10: 0.5953 - accuracy20: 0.5724 - accuracy30: 0.5622 - accuracy50: 0.5632 - val_loss: 11.2721 - val_accuracy10: 0.7496 - val_accuracy20: 0.7146 - val_accuracy30: 0.6937 - val_accuracy50: 0.6613 - 31s/epoch - 25ms/step
Epoch 14/50
1250/1250 - 32s - loss: 9.4439 - accuracy10: 0.5979 - accuracy20: 0.5754 - accuracy30: 0.5646 - accuracy50: 0.5645 - val_loss: 11.1708 - val_accuracy10: 0.7456 - val_accuracy20: 0.7116 - val_accuracy30: 0.6900 - val_accuracy50: 0.6593 - 32s/epoch - 25ms/step
Epoch 15/50
1250/1250 - 32s - loss: 9.3868 - accuracy10: 0.6008 - accuracy20: 0.5784 - accuracy30: 0.5676 - accuracy50: 0.5676 - val_loss: 11.1619 - val_accuracy10: 0.7432 - val_accuracy20: 0.7100 - val_accuracy30: 0.6875 - val_accuracy50: 0.6565 - 32s/epoch - 26ms/step
Epoch 16/50
1250/1250 - 31s - loss: 9.3345 - accuracy10: 0.6032 - accuracy20: 0.5812 - accuracy30: 0.5703 - accuracy50: 0.5693 - val_loss: 11.0757 - val_accuracy10: 0.7280 - val_accuracy20: 0.6953 - val_accuracy30: 0.6750 - val_accuracy50: 0.6481 - 31s/epoch - 25ms/step
Epoch 17/50
1250/1250 - 31s - loss: 9.2825 - accuracy10: 0.6068 - accuracy20: 0.5852 - accuracy30: 0.5735 - accuracy50: 0.5706 - val_loss: 11.2169 - val_accuracy10: 0.7389 - val_accuracy20: 0.7075 - val_accuracy30: 0.6852 - val_accuracy50: 0.6538 - 31s/epoch - 25ms/step
Epoch 18/50
1250/1250 - 32s - loss: 9.2311 - accuracy10: 0.6078 - accuracy20: 0.5863 - accuracy30: 0.5727 - accuracy50: 0.5693 - val_loss: 11.1987 - val_accuracy10: 0.7327 - val_accuracy20: 0.7003 - val_accuracy30: 0.6783 - val_accuracy50: 0.6484 - 32s/epoch - 25ms/step
Epoch 19/50
1250/1250 - 32s - loss: 9.1788 - accuracy10: 0.6114 - accuracy20: 0.5907 - accuracy30: 0.5768 - accuracy50: 0.5716 - val_loss: 11.1931 - val_accuracy10: 0.7267 - val_accuracy20: 0.6957 - val_accuracy30: 0.6735 - val_accuracy50: 0.6433 - 32s/epoch - 25ms/step
Epoch 20/50
1250/1250 - 31s - loss: 9.1640 - accuracy10: 0.6102 - accuracy20: 0.5914 - accuracy30: 0.5783 - accuracy50: 0.5734 - val_loss: 11.1254 - val_accuracy10: 0.7362 - val_accuracy20: 0.7048 - val_accuracy30: 0.6816 - val_accuracy50: 0.6488 - 31s/epoch - 25ms/step
Epoch 21/50
1250/1250 - 31s - loss: 9.1167 - accuracy10: 0.6133 - accuracy20: 0.5939 - accuracy30: 0.5802 - accuracy50: 0.5739 - val_loss: 11.3602 - val_accuracy10: 0.7367 - val_accuracy20: 0.7058 - val_accuracy30: 0.6818 - val_accuracy50: 0.6487 - 31s/epoch - 25ms/step
Epoch 22/50
1250/1250 - 32s - loss: 9.0602 - accuracy10: 0.6144 - accuracy20: 0.5953 - accuracy30: 0.5810 - accuracy50: 0.5741 - val_loss: 11.4062 - val_accuracy10: 0.7270 - val_accuracy20: 0.6946 - val_accuracy30: 0.6716 - val_accuracy50: 0.6403 - 32s/epoch - 26ms/step
Epoch 23/50
1250/1250 - 32s - loss: 9.0380 - accuracy10: 0.6158 - accuracy20: 0.5969 - accuracy30: 0.5830 - accuracy50: 0.5756 - val_loss: 11.2761 - val_accuracy10: 0.7320 - val_accuracy20: 0.7001 - val_accuracy30: 0.6769 - val_accuracy50: 0.6440 - 32s/epoch - 25ms/step
Epoch 24/50
1250/1250 - 32s - loss: 8.9901 - accuracy10: 0.6167 - accuracy20: 0.5979 - accuracy30: 0.5836 - accuracy50: 0.5756 - val_loss: 11.2391 - val_accuracy10: 0.7343 - val_accuracy20: 0.7039 - val_accuracy30: 0.6799 - val_accuracy50: 0.6462 - 32s/epoch - 25ms/step
Epoch 25/50
1250/1250 - 31s - loss: 8.9563 - accuracy10: 0.6187 - accuracy20: 0.6006 - accuracy30: 0.5855 - accuracy50: 0.5778 - val_loss: 11.2094 - val_accuracy10: 0.7237 - val_accuracy20: 0.6933 - val_accuracy30: 0.6709 - val_accuracy50: 0.6400 - 31s/epoch - 25ms/step
Epoch 26/50
1250/1250 - 31s - loss: 8.9085 - accuracy10: 0.6204 - accuracy20: 0.6029 - accuracy30: 0.5882 - accuracy50: 0.5792 - val_loss: 11.4712 - val_accuracy10: 0.7312 - val_accuracy20: 0.7016 - val_accuracy30: 0.6777 - val_accuracy50: 0.6433 - 31s/epoch - 25ms/step
testing model: results/EXC/W9/deepOF_L1/seq2seq
Evaluating performance on  test set...
2354/2354 - 29s - 29s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6370241
{'0': {'precision': 0.2707390648567119, 'recall': 0.5603209496592658, 'f1-score': 0.3650777736400355, 'support': 45490}, '1': {'precision': 0.9210803869253896, 'recall': 0.7746360806071464, 'f1-score': 0.8415346722323526, 'support': 512957}, '2': {'precision': 0.2723640197316187, 'recall': 0.4763378935148301, 'f1-score': 0.34656597273976913, 'support': 43931}, 'accuracy': 0.7366968913207321, 'macro avg': {'precision': 0.4880611571712401, 'recall': 0.6037649745937474, 'f1-score': 0.5177261395373858, 'support': 602378}, 'weighted avg': {'precision': 0.8246578989392851, 'recall': 0.7366968913207321, 'f1-score': 0.769456186208007, 'support': 602378}}
[[ 25489  16238   3763]
 [ 63460 397355  52142]
 [  5197  17808  20926]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.70189565
{'0': {'precision': 0.32472423748889545, 'recall': 0.5564965031638042, 'f1-score': 0.4101308430876397, 'support': 63057}, '1': {'precision': 0.8796288560490272, 'recall': 0.7494975042712136, 'f1-score': 0.8093658642465187, 'support': 477616}, '2': {'precision': 0.33788177114336737, 'recall': 0.4783404910461065, 'f1-score': 0.39602578810017375, 'support': 61705}, 'accuracy': 0.7015179837245052, 'macro avg': {'precision': 0.5140782882270966, 'recall': 0.5947781661603747, 'f1-score': 0.5385074984781107, 'support': 602378}, 'weighted avg': {'precision': 0.7660471442224831, 'recall': 0.7015179837245052, 'f1-score': 0.7252331234627821, 'support': 602378}}
[[ 35091  23304   4662]
 [ 66466 357972  53178]
 [  6507  25682  29516]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7510549
{'0': {'precision': 0.3616504423994184, 'recall': 0.5312357560524568, 'f1-score': 0.4303384832868272, 'support': 76787}, '1': {'precision': 0.8392893993768781, 'recall': 0.7404204585569244, 'f1-score': 0.7867609850348033, 'support': 450413}, '2': {'precision': 0.37986555350753554, 'recall': 0.4660272952193461, 'f1-score': 0.41855825289114024, 'support': 75178}, 'accuracy': 0.6795102078761176, 'macro avg': {'precision': 0.5269351317612773, 'recall': 0.5792278366095757, 'f1-score': 0.545219240404257, 'support': 602378}, 'weighted avg': {'precision': 0.7210662430295453, 'recall': 0.6795102078761176, 'f1-score': 0.6953742484029573, 'support': 602378}}
[[ 40792  30904   5091]
 [ 64814 333495  52104]
 [  7188  32955  35035]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8137422
{'0': {'precision': 0.4185642573933287, 'recall': 0.4576021792947118, 'f1-score': 0.4372135437693246, 'support': 100583}, '1': {'precision': 0.7570907393839638, 'recall': 0.7477566334508814, 'f1-score': 0.7523947381216876, 'support': 403523}, '2': {'precision': 0.4397651971960028, 'recall': 0.4200484369912081, 'f1-score': 0.4296807502940595, 'support': 98272}, 'accuracy': 0.6458452997951453, 'macro avg': {'precision': 0.5384733979910984, 'recall': 0.5418024165789338, 'f1-score': 0.5397630107283572, 'support': 602378}, 'weighted avg': {'precision': 0.6487962385556478, 'recall': 0.6458452997951453, 'f1-score': 0.6471192813763542, 'support': 602378}}
[[ 46027  48523   6033]
 [ 55232 301737  46554]
 [  8705  48288  41279]]
Evaluating performance on  train set...
1250/1250 - 17s - 17s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.61841977
{'0': {'precision': 0.25719657152098324, 'recall': 0.5697205803331542, 'f1-score': 0.35440111420612813, 'support': 22332}, '1': {'precision': 0.9316017507405279, 'recall': 0.7672329672890391, 'f1-score': 0.8414657034809658, 'support': 274648}, '2': {'precision': 0.2857756282769843, 'recall': 0.5515571839832505, 'f1-score': 0.37648494953404593, 'support': 22926}, 'accuracy': 0.7379886591686308, 'macro avg': {'precision': 0.4915246501794985, 'recall': 0.6295035772018146, 'f1-score': 0.5241172557403799, 'support': 319906}, 'weighted avg': {'precision': 0.8382398689817298, 'recall': 0.7379886591686309, 'f1-score': 0.7741419422114906, 'support': 319906}}
[[ 12723   7278   2331]
 [ 34657 210719  29272]
 [  2088   8193  12645]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6713214
{'0': {'precision': 0.3216925186543907, 'recall': 0.5712839974699557, 'f1-score': 0.41160721406355033, 'support': 31620}, '1': {'precision': 0.8927081727692688, 'recall': 0.747454955747713, 'f1-score': 0.8136497354091898, 'support': 255693}, '2': {'precision': 0.36444909793814434, 'recall': 0.5553339674163164, 'f1-score': 0.44008412657889295, 'support': 32593}, 'accuracy': 0.7104680749970304, 'macro avg': {'precision': 0.5262832631206013, 'recall': 0.6246909735446616, 'f1-score': 0.5551136920172111, 'support': 319906}, 'weighted avg': {'precision': 0.7824474617820311, 'recall': 0.7104680749970304, 'f1-score': 0.7358512308061034, 'support': 319906}}
[[ 18064  10882   2674]
 [ 35684 191119  28890]
 [  2405  12088  18100]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.71508163
{'0': {'precision': 0.36744812076191774, 'recall': 0.5526882271539132, 'f1-score': 0.4414220803143805, 'support': 39022}, '1': {'precision': 0.853131367240934, 'recall': 0.7413837534082596, 'f1-score': 0.793341783974915, 'support': 240592}, '2': {'precision': 0.4155253769133387, 'recall': 0.5376501538767001, 'f1-score': 0.46876420054962886, 'support': 40292}, 'accuracy': 0.6927066075659725, 'macro avg': {'precision': 0.5453682883053969, 'recall': 0.6105740448129576, 'f1-score': 0.5678426882796415, 'support': 319906}, 'weighted avg': {'precision': 0.7387716734359299, 'recall': 0.6927066075659725, 'f1-score': 0.7095343822143573, 'support': 319906}}
[[ 21567  14631   2824]
 [ 34574 178371  27647]
 [  2553  16076  21663]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7771053
{'0': {'precision': 0.4375552512523617, 'recall': 0.48622775252330686, 'f1-score': 0.4606092676562628, 'support': 51916}, '1': {'precision': 0.7695151130193085, 'recall': 0.7521086657175532, 'f1-score': 0.7607123298018998, 'support': 214235}, '2': {'precision': 0.48487487222201187, 'recall': 0.4764952097479304, 'f1-score': 0.4806485208433023, 'support': 53755}, 'accuracy': 0.6626477777847243, 'macro avg': {'precision': 0.563981745497894, 'recall': 0.5716105426629302, 'f1-score': 0.5673233727671549, 'support': 319906}, 'weighted avg': {'precision': 0.66781378723126, 'recall': 0.6626477777847243, 'f1-score': 0.6649498851308955, 'support': 319906}}
[[ 25243  23323   3350]
 [ 29245 161128  23862]
 [  3203  24938  25614]]
Evaluating performance on  val set...
495/495 - 6s - 6s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.63553715
{'0': {'precision': 0.23365658320065616, 'recall': 0.52487265633467, 'f1-score': 0.32336248915003, 'support': 9227}, '1': {'precision': 0.9224357257632566, 'recall': 0.7637900766885337, 'f1-score': 0.835649949961081, 'support': 108230}, '2': {'precision': 0.2838535266650283, 'recall': 0.5042567125081859, 'f1-score': 0.36323610346725377, 'support': 9162}, 'accuracy': 0.7276001232042585, 'macro avg': {'precision': 0.479981945209647, 'recall': 0.5976398151771298, 'f1-score': 0.507416180859455, 'support': 126619}, 'weighted avg': {'precision': 0.8260358548389634, 'recall': 0.7276001232042585, 'f1-score': 0.7641351531100554, 'support': 126619}}
[[ 4843  3250  1134]
 [15043 82665 10522]
 [  841  3701  4620]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6951849
{'0': {'precision': 0.2932242500524439, 'recall': 0.5416989614013331, 'f1-score': 0.3804883360100172, 'support': 12902}, '1': {'precision': 0.8827543791174348, 'recall': 0.7405173183581542, 'f1-score': 0.8054041804702758, 'support': 100789}, '2': {'precision': 0.35689607896901565, 'recall': 0.5034034653465347, 'f1-score': 0.4176748066617463, 'support': 12928}, 'accuracy': 0.6960487762500098, 'macro avg': {'precision': 0.5109582360462981, 'recall': 0.5952065817020072, 'f1-score': 0.5345224410473465, 'support': 126619}, 'weighted avg': {'precision': 0.7689925121818622, 'recall': 0.6960487762500098, 'f1-score': 0.7225190718386888, 'support': 126619}}
[[ 6989  4561  1352]
 [15778 74636 10375]
 [ 1068  5352  6508]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.73897654
{'0': {'precision': 0.3320031923383879, 'recall': 0.5311542390194075, 'f1-score': 0.40860426284254986, 'support': 15664}, '1': {'precision': 0.8441140776699029, 'recall': 0.7310036784025223, 'f1-score': 0.7834976063080823, 'support': 95150}, '2': {'precision': 0.40221305913669814, 'recall': 0.48756722556153115, 'f1-score': 0.44079624756892805, 'support': 15805}, 'accuracy': 0.6758938232018892, 'macro avg': {'precision': 0.5261101097149963, 'recall': 0.5832417143278202, 'f1-score': 0.5442993722398534, 'support': 126619}, 'weighted avg': {'precision': 0.7256014491879993, 'recall': 0.6758938232018892, 'f1-score': 0.6943425481658096, 'support': 126619}}
[[ 8320  5933  1411]
 [15553 69555 10042]
 [ 1187  6912  7706]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7963954
{'0': {'precision': 0.3985365853658537, 'recall': 0.478103969569882, 'f1-score': 0.43470935130581295, 'support': 20506}, '1': {'precision': 0.7655582321538815, 'recall': 0.7402179383639407, 'f1-score': 0.7526748628351762, 'support': 85437}, '2': {'precision': 0.4661514683153014, 'recall': 0.4376088218224028, 'f1-score': 0.45142942673252506, 'support': 20676}, 'accuracy': 0.6483545123559655, 'macro avg': {'precision': 0.5434154286116789, 'recall': 0.5519769099187418, 'f1-score': 0.5462712136245047, 'support': 126619}, 'weighted avg': {'precision': 0.657227885695911, 'recall': 0.6483545123559655, 'f1-score': 0.6519889356340489, 'support': 126619}}
[[ 9804  9196  1506]
 [13339 63242  8856]
 [ 1457 10171  9048]]
training model: results/EXC/W9/deepLOB_L2/seq2seq
Epoch 1/50
1250/1250 - 74s - loss: 10.2189 - accuracy10: 0.4742 - accuracy20: 0.4902 - accuracy30: 0.4997 - accuracy50: 0.5149 - val_loss: 10.9621 - val_accuracy10: 0.6872 - val_accuracy20: 0.6839 - val_accuracy30: 0.6743 - val_accuracy50: 0.6469 - 74s/epoch - 59ms/step
Epoch 2/50
1250/1250 - 67s - loss: 9.2156 - accuracy10: 0.5884 - accuracy20: 0.5936 - accuracy30: 0.5886 - accuracy50: 0.5844 - val_loss: 10.3134 - val_accuracy10: 0.7268 - val_accuracy20: 0.7117 - val_accuracy30: 0.6919 - val_accuracy50: 0.6587 - 67s/epoch - 54ms/step
Epoch 3/50
1250/1250 - 66s - loss: 8.6115 - accuracy10: 0.6645 - accuracy20: 0.6498 - accuracy30: 0.6289 - accuracy50: 0.6120 - val_loss: 9.8844 - val_accuracy10: 0.7601 - val_accuracy20: 0.7389 - val_accuracy30: 0.7158 - val_accuracy50: 0.6800 - 66s/epoch - 53ms/step
Epoch 4/50
1250/1250 - 65s - loss: 8.3229 - accuracy10: 0.6804 - accuracy20: 0.6606 - accuracy30: 0.6375 - accuracy50: 0.6183 - val_loss: 9.5770 - val_accuracy10: 0.7567 - val_accuracy20: 0.7380 - val_accuracy30: 0.7150 - val_accuracy50: 0.6813 - 65s/epoch - 52ms/step
Epoch 5/50
1250/1250 - 65s - loss: 8.1241 - accuracy10: 0.6897 - accuracy20: 0.6677 - accuracy30: 0.6425 - accuracy50: 0.6228 - val_loss: 9.7187 - val_accuracy10: 0.7743 - val_accuracy20: 0.7508 - val_accuracy30: 0.7260 - val_accuracy50: 0.6895 - 65s/epoch - 52ms/step
Epoch 6/50
1250/1250 - 65s - loss: 7.9913 - accuracy10: 0.6958 - accuracy20: 0.6726 - accuracy30: 0.6470 - accuracy50: 0.6271 - val_loss: 9.6166 - val_accuracy10: 0.7755 - val_accuracy20: 0.7577 - val_accuracy30: 0.7359 - val_accuracy50: 0.7003 - 65s/epoch - 52ms/step
Epoch 7/50
1250/1250 - 66s - loss: 7.8778 - accuracy10: 0.6994 - accuracy20: 0.6751 - accuracy30: 0.6489 - accuracy50: 0.6281 - val_loss: 9.3745 - val_accuracy10: 0.7685 - val_accuracy20: 0.7527 - val_accuracy30: 0.7328 - val_accuracy50: 0.6988 - 66s/epoch - 53ms/step
Epoch 8/50
1250/1250 - 66s - loss: 7.8107 - accuracy10: 0.6997 - accuracy20: 0.6760 - accuracy30: 0.6504 - accuracy50: 0.6312 - val_loss: 9.4815 - val_accuracy10: 0.7944 - val_accuracy20: 0.7788 - val_accuracy30: 0.7567 - val_accuracy50: 0.7155 - 66s/epoch - 53ms/step
Epoch 9/50
1250/1250 - 68s - loss: 7.7369 - accuracy10: 0.7004 - accuracy20: 0.6773 - accuracy30: 0.6523 - accuracy50: 0.6327 - val_loss: 9.9958 - val_accuracy10: 0.8128 - val_accuracy20: 0.7935 - val_accuracy30: 0.7692 - val_accuracy50: 0.7222 - 68s/epoch - 54ms/step
Epoch 10/50
1250/1250 - 65s - loss: 7.6930 - accuracy10: 0.7001 - accuracy20: 0.6783 - accuracy30: 0.6533 - accuracy50: 0.6338 - val_loss: 9.9512 - val_accuracy10: 0.8226 - val_accuracy20: 0.8001 - val_accuracy30: 0.7729 - val_accuracy50: 0.7248 - 65s/epoch - 52ms/step
Epoch 11/50
1250/1250 - 65s - loss: 7.6470 - accuracy10: 0.7022 - accuracy20: 0.6787 - accuracy30: 0.6536 - accuracy50: 0.6344 - val_loss: 9.7600 - val_accuracy10: 0.8073 - val_accuracy20: 0.7869 - val_accuracy30: 0.7614 - val_accuracy50: 0.7170 - 65s/epoch - 52ms/step
Epoch 12/50
1250/1250 - 66s - loss: 7.5978 - accuracy10: 0.7031 - accuracy20: 0.6800 - accuracy30: 0.6548 - accuracy50: 0.6349 - val_loss: 10.3058 - val_accuracy10: 0.8255 - val_accuracy20: 0.8005 - val_accuracy30: 0.7721 - val_accuracy50: 0.7219 - 66s/epoch - 53ms/step
Epoch 13/50
1250/1250 - 66s - loss: 7.5470 - accuracy10: 0.7044 - accuracy20: 0.6819 - accuracy30: 0.6568 - accuracy50: 0.6358 - val_loss: 10.3752 - val_accuracy10: 0.8113 - val_accuracy20: 0.7864 - val_accuracy30: 0.7572 - val_accuracy50: 0.7100 - 66s/epoch - 53ms/step
Epoch 14/50
1250/1250 - 65s - loss: 7.5084 - accuracy10: 0.7048 - accuracy20: 0.6819 - accuracy30: 0.6571 - accuracy50: 0.6372 - val_loss: 10.4885 - val_accuracy10: 0.8098 - val_accuracy20: 0.7817 - val_accuracy30: 0.7511 - val_accuracy50: 0.7030 - 65s/epoch - 52ms/step
Epoch 15/50
1250/1250 - 66s - loss: 7.4570 - accuracy10: 0.7052 - accuracy20: 0.6822 - accuracy30: 0.6586 - accuracy50: 0.6385 - val_loss: 10.7555 - val_accuracy10: 0.7999 - val_accuracy20: 0.7717 - val_accuracy30: 0.7403 - val_accuracy50: 0.6931 - 66s/epoch - 53ms/step
Epoch 16/50
1250/1250 - 67s - loss: 7.4229 - accuracy10: 0.7042 - accuracy20: 0.6835 - accuracy30: 0.6594 - accuracy50: 0.6396 - val_loss: 11.2786 - val_accuracy10: 0.7960 - val_accuracy20: 0.7655 - val_accuracy30: 0.7347 - val_accuracy50: 0.6856 - 67s/epoch - 53ms/step
Epoch 17/50
1250/1250 - 65s - loss: 7.3770 - accuracy10: 0.7061 - accuracy20: 0.6851 - accuracy30: 0.6599 - accuracy50: 0.6401 - val_loss: 11.1442 - val_accuracy10: 0.7966 - val_accuracy20: 0.7671 - val_accuracy30: 0.7367 - val_accuracy50: 0.6876 - 65s/epoch - 52ms/step
testing model: results/EXC/W9/deepLOB_L2/seq2seq
Evaluating performance on  test set...
2354/2354 - 49s - 49s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.4920762
{'0': {'precision': 0.418413448490557, 'recall': 0.5761359389769405, 'f1-score': 0.48476833441228145, 'support': 45491}, '1': {'precision': 0.9447439117232689, 'recall': 0.8418801502654208, 'f1-score': 0.8903508726716814, 'support': 512959}, '2': {'precision': 0.3334422460216615, 'recall': 0.6271965765273605, 'f1-score': 0.4354057534744443, 'support': 43932}, 'accuracy': 0.8061545663715052, 'macro avg': {'precision': 0.5655332020784958, 'recall': 0.681737555256574, 'f1-score': 0.6035083201861356, 'support': 602382}, 'weighted avg': {'precision': 0.8604136962113141, 'recall': 0.8061545663715052, 'f1-score': 0.8265425181316531, 'support': 602382}}
[[ 26209  14188   5094]
 [ 31122 431850  49987]
 [  5308  11070  27554]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.54694754
{'0': {'precision': 0.48143250688705236, 'recall': 0.5542833581781852, 'f1-score': 0.515295817423226, 'support': 63058}, '1': {'precision': 0.9071392978482447, 'recall': 0.8385439348765535, 'f1-score': 0.8714939137170934, 'support': 477616}, '2': {'precision': 0.41543009900092887, 'recall': 0.5943313670836845, 'f1-score': 0.4890326021734783, 'support': 61708}, 'accuracy': 0.7837700993721592, 'macro avg': {'precision': 0.6013339679120753, 'recall': 0.6623862200461411, 'f1-score': 0.6252741111045993, 'support': 602382}, 'weighted avg': {'precision': 0.8122051695593832, 'recall': 0.7837700993721592, 'f1-score': 0.7950273822323676, 'support': 602382}}
[[ 34952  22125   5981]
 [ 31488 400502  45626]
 [  6160  18873  36675]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.61257946
{'0': {'precision': 0.5000675634174805, 'recall': 0.5301349169141012, 'f1-score': 0.5146624692622304, 'support': 76788}, '1': {'precision': 0.8700239438789084, 'recall': 0.8277003550075154, 'f1-score': 0.8483345943578162, 'support': 450413}, '2': {'precision': 0.45783184644498515, 'recall': 0.5631476037828707, 'f1-score': 0.5050579758553229, 'support': 75181}, 'accuracy': 0.7567506997221033, 'macro avg': {'precision': 0.609307784580458, 'recall': 0.640327625234829, 'f1-score': 0.6226850131584565, 'support': 602382}, 'weighted avg': {'precision': 0.7714200270619187, 'recall': 0.7567506997221033, 'f1-score': 0.7629570522043725, 'support': 602382}}
[[ 40708  29379   6701]
 [ 34170 372807  43436]
 [  6527  26316  42338]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.70486045
{'0': {'precision': 0.5290319682899716, 'recall': 0.46839986081423673, 'f1-score': 0.49687305554676703, 'support': 100585}, '1': {'precision': 0.7924610870516552, 'recall': 0.8212394336877947, 'f1-score': 0.8065936473165388, 'support': 403523}, '2': {'precision': 0.5151658468911591, 'recall': 0.4987789242322486, 'f1-score': 0.5068399664981234, 'support': 98274}, 'accuracy': 0.7097157617591495, 'macro avg': {'precision': 0.6122196340775953, 'recall': 0.59613940624476, 'f1-score': 0.6034355564538098, 'support': 602382}, 'weighted avg': {'precision': 0.7032354290104513, 'recall': 0.7097157617591495, 'f1-score': 0.7059743742441172, 'support': 602382}}
[[ 47114  45312   8159]
 [ 34162 331389  37972]
 [  7781  41476  49017]]
Evaluating performance on  train set...
1250/1250 - 26s - 26s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.51278263
{'0': {'precision': 0.38061691888444366, 'recall': 0.5880324271061943, 'f1-score': 0.4621178789532039, 'support': 22327}, '1': {'precision': 0.9493509983492366, 'recall': 0.8103956159994175, 'f1-score': 0.8743871200930321, 'support': 274635}, '2': {'precision': 0.3054182360326428, 'recall': 0.6785356286772717, 'f1-score': 0.42123347898432106, 'support': 22945}, 'accuracy': 0.7854188873641402, 'macro avg': {'precision': 0.545128717755441, 'recall': 0.6923212239276278, 'f1-score': 0.5859128260101857, 'support': 319907}, 'weighted avg': {'precision': 0.8634724054345313, 'recall': 0.7854188873641402, 'f1-score': 0.8131119818742112, 'support': 319907}}
[[ 13129   6565   2633]
 [ 19298 222563  32774]
 [  2067   5309  15569]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.5548085
{'0': {'precision': 0.4611725804400356, 'recall': 0.5731853818917552, 'f1-score': 0.5111139301168479, 'support': 31632}, '1': {'precision': 0.9141184960222418, 'recall': 0.8076366452581925, 'f1-score': 0.8575848885769287, 'support': 255662}, '2': {'precision': 0.3927181005647859, 'recall': 0.658817036151228, 'f1-score': 0.4920983921945857, 'support': 32613}, 'accuracy': 0.7692829478567209, 'macro avg': {'precision': 0.5893363923423545, 'recall': 0.6798796877670585, 'f1-score': 0.6202657369627874, 'support': 319907}, 'weighted avg': {'precision': 0.8161774809811506, 'recall': 0.7692829478567209, 'f1-score': 0.7860666646414518, 'support': 319907}}
[[ 18131  10546   2955]
 [ 18910 206482  30270]
 [  2274   8853  21486]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6095419
{'0': {'precision': 0.49847617288511264, 'recall': 0.5527252246486265, 'f1-score': 0.5242008910686754, 'support': 39061}, '1': {'precision': 0.877867989296183, 'recall': 0.8006236357966947, 'f1-score': 0.8374684160857256, 'support': 240525}, '2': {'precision': 0.4440367613656218, 'recall': 0.6302919074427717, 'f1-score': 0.521018912408385, 'support': 40321}, 'accuracy': 0.7488863951085785, 'macro avg': {'precision': 0.6067936411823058, 'recall': 0.661213589296031, 'f1-score': 0.627562739854262, 'support': 319907}, 'weighted avg': {'precision': 0.7768638453349038, 'recall': 0.7488863951085785, 'f1-score': 0.759332885345651, 'support': 319907}}
[[ 21590  14197   3274]
 [ 19409 192570  28546]
 [  2313  12594  25414]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.69151
{'0': {'precision': 0.5518750943477605, 'recall': 0.49251347190146266, 'f1-score': 0.520507266274115, 'support': 51960}, '1': {'precision': 0.7995667668227238, 'recall': 0.801306261933996, 'f1-score': 0.8004355693180123, 'support': 214199}, '2': {'precision': 0.5120347879261437, 'recall': 0.5608394730966734, 'f1-score': 0.5353270762482353, 'support': 53748}, 'accuracy': 0.7107503118093697, 'macro avg': {'precision': 0.6211588830322093, 'recall': 0.6182197356440441, 'f1-score': 0.6187566372801209, 'support': 319907}, 'weighted avg': {'precision': 0.7110275097776061, 'recall': 0.7107503118093697, 'f1-score': 0.7104277673265732, 'support': 319907}}
[[ 25591  22267   4102]
 [ 17935 171639  24625]
 [  2845  20759  30144]]
Evaluating performance on  val set...
495/495 - 10s - 10s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5454405
{'0': {'precision': 0.33713569827245154, 'recall': 0.5528762975778547, 'f1-score': 0.4188580322765626, 'support': 9248}, '1': {'precision': 0.9487936160571195, 'recall': 0.7938154816397112, 'f1-score': 0.8644130944828767, 'support': 108141}, '2': {'precision': 0.3025839054157132, 'recall': 0.6876489707475623, 'f1-score': 0.42024763292061174, 'support': 9230}, 'accuracy': 0.7684786643394751, 'macro avg': {'precision': 0.5295044065817615, 'recall': 0.6781135833217093, 'f1-score': 0.5678395865600171, 'support': 126619}, 'weighted avg': {'precision': 0.8570133299002806, 'recall': 0.7684786643394751, 'f1-score': 0.799492818493462, 'support': 126619}}
[[ 5113  2589  1546]
 [ 9214 85844 13083]
 [  839  2044  6347]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.5879079
{'0': {'precision': 0.41192723923555147, 'recall': 0.5542560607234142, 'f1-score': 0.4726083941485322, 'support': 12911}, '1': {'precision': 0.9162420161866771, 'recall': 0.7892212357742954, 'f1-score': 0.8480014511619965, 'support': 100698}, '2': {'precision': 0.38437958150073304, 'recall': 0.6650269023827825, 'f1-score': 0.4871758776992596, 'support': 13010}, 'accuracy': 0.7525015992860471, 'macro avg': {'precision': 0.5708496123076539, 'recall': 0.6695013996268306, 'f1-score': 0.6025952410032628, 'support': 126619}, 'weighted avg': {'precision': 0.8101699546439377, 'recall': 0.7525015992860471, 'f1-score': 0.7726490911698068, 'support': 126619}}
[[ 7156  3946  1809]
 [ 9177 79473 12048]
 [ 1039  3319  8652]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6405596
{'0': {'precision': 0.4441134974133877, 'recall': 0.541993495312799, 'f1-score': 0.4881957608133724, 'support': 15681}, '1': {'precision': 0.8828861018806351, 'recall': 0.7797284077880277, 'f1-score': 0.8281070211696363, 'support': 95069}, '2': {'precision': 0.430508906934229, 'recall': 0.638099439158107, 'f1-score': 0.5141406448337141, 'support': 15869}, 'accuracy': 0.7325361912509181, 'macro avg': {'precision': 0.5858361687427506, 'recall': 0.6532737807529779, 'f1-score': 0.6101478089389075, 'support': 126619}, 'weighted avg': {'precision': 0.7718508945479645, 'recall': 0.7325361912509181, 'f1-score': 0.7466620492481923, 'support': 126619}}
[[ 8499  5178  2004]
 [ 9550 74128 11391]
 [ 1088  4655 10126]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7147387
{'0': {'precision': 0.4961609485858684, 'recall': 0.49736944660950894, 'f1-score': 0.49676446260886487, 'support': 20528}, '1': {'precision': 0.81070556640625, 'recall': 0.7778883995502249, 'f1-score': 0.7939580145371079, 'support': 85376}, '2': {'precision': 0.4922266904357199, 'recall': 0.5731595462225441, 'f1-score': 0.5296190561156213, 'support': 20715}, 'accuracy': 0.6989156445715098, 'macro avg': {'precision': 0.5996977351426128, 'recall': 0.6161391307940927, 'f1-score': 0.606780511087198, 'support': 126619}, 'weighted avg': {'precision': 0.7076068068966478, 'recall': 0.6989156445715098, 'f1-score': 0.7025296289260695, 'support': 126619}}
[[10210  7938  2380]
 [ 9095 66413  9868]
 [ 1273  7569 11873]]
training model: results/EXC/W9/deepOF_L2/seq2seq
Epoch 1/50
1250/1250 - 50s - loss: 9.7202 - accuracy10: 0.5553 - accuracy20: 0.5579 - accuracy30: 0.5522 - accuracy50: 0.5493 - val_loss: 11.0481 - val_accuracy10: 0.8160 - val_accuracy20: 0.7941 - val_accuracy30: 0.7687 - val_accuracy50: 0.7149 - 50s/epoch - 40ms/step
Epoch 2/50
1250/1250 - 42s - loss: 8.7887 - accuracy10: 0.6267 - accuracy20: 0.6166 - accuracy30: 0.6043 - accuracy50: 0.5922 - val_loss: 11.5854 - val_accuracy10: 0.8206 - val_accuracy20: 0.7937 - val_accuracy30: 0.7677 - val_accuracy50: 0.7166 - 42s/epoch - 34ms/step
Epoch 3/50
1250/1250 - 42s - loss: 8.5487 - accuracy10: 0.6470 - accuracy20: 0.6313 - accuracy30: 0.6147 - accuracy50: 0.6014 - val_loss: 10.6926 - val_accuracy10: 0.8037 - val_accuracy20: 0.7716 - val_accuracy30: 0.7425 - val_accuracy50: 0.6987 - 42s/epoch - 34ms/step
Epoch 4/50
1250/1250 - 42s - loss: 8.3493 - accuracy10: 0.6596 - accuracy20: 0.6420 - accuracy30: 0.6229 - accuracy50: 0.6087 - val_loss: 10.8131 - val_accuracy10: 0.8006 - val_accuracy20: 0.7702 - val_accuracy30: 0.7414 - val_accuracy50: 0.6962 - 42s/epoch - 34ms/step
Epoch 5/50
1250/1250 - 42s - loss: 8.2037 - accuracy10: 0.6683 - accuracy20: 0.6500 - accuracy30: 0.6298 - accuracy50: 0.6137 - val_loss: 10.8910 - val_accuracy10: 0.7685 - val_accuracy20: 0.7351 - val_accuracy30: 0.7061 - val_accuracy50: 0.6667 - 42s/epoch - 34ms/step
Epoch 6/50
1250/1250 - 43s - loss: 8.0953 - accuracy10: 0.6712 - accuracy20: 0.6546 - accuracy30: 0.6326 - accuracy50: 0.6148 - val_loss: 10.5995 - val_accuracy10: 0.7614 - val_accuracy20: 0.7264 - val_accuracy30: 0.6962 - val_accuracy50: 0.6569 - 43s/epoch - 34ms/step
Epoch 7/50
1250/1250 - 43s - loss: 8.0202 - accuracy10: 0.6721 - accuracy20: 0.6564 - accuracy30: 0.6345 - accuracy50: 0.6163 - val_loss: 10.4524 - val_accuracy10: 0.7484 - val_accuracy20: 0.7075 - val_accuracy30: 0.6762 - val_accuracy50: 0.6404 - 43s/epoch - 34ms/step
Epoch 8/50
1250/1250 - 42s - loss: 7.9573 - accuracy10: 0.6737 - accuracy20: 0.6588 - accuracy30: 0.6361 - accuracy50: 0.6164 - val_loss: 10.5505 - val_accuracy10: 0.7662 - val_accuracy20: 0.7313 - val_accuracy30: 0.6979 - val_accuracy50: 0.6585 - 42s/epoch - 34ms/step
Epoch 9/50
1250/1250 - 42s - loss: 7.8947 - accuracy10: 0.6753 - accuracy20: 0.6615 - accuracy30: 0.6391 - accuracy50: 0.6185 - val_loss: 10.7110 - val_accuracy10: 0.7444 - val_accuracy20: 0.7109 - val_accuracy30: 0.6756 - val_accuracy50: 0.6358 - 42s/epoch - 34ms/step
Epoch 10/50
1250/1250 - 42s - loss: 7.8445 - accuracy10: 0.6779 - accuracy20: 0.6640 - accuracy30: 0.6410 - accuracy50: 0.6192 - val_loss: 10.3595 - val_accuracy10: 0.7415 - val_accuracy20: 0.7052 - val_accuracy30: 0.6716 - val_accuracy50: 0.6326 - 42s/epoch - 34ms/step
Epoch 11/50
1250/1250 - 43s - loss: 7.7860 - accuracy10: 0.6777 - accuracy20: 0.6637 - accuracy30: 0.6415 - accuracy50: 0.6195 - val_loss: 10.5967 - val_accuracy10: 0.7379 - val_accuracy20: 0.7028 - val_accuracy30: 0.6673 - val_accuracy50: 0.6281 - 43s/epoch - 34ms/step
Epoch 12/50
1250/1250 - 43s - loss: 7.7502 - accuracy10: 0.6780 - accuracy20: 0.6657 - accuracy30: 0.6435 - accuracy50: 0.6213 - val_loss: 11.0080 - val_accuracy10: 0.7308 - val_accuracy20: 0.6971 - val_accuracy30: 0.6604 - val_accuracy50: 0.6210 - 43s/epoch - 34ms/step
Epoch 13/50
1250/1250 - 42s - loss: 7.7113 - accuracy10: 0.6789 - accuracy20: 0.6671 - accuracy30: 0.6447 - accuracy50: 0.6218 - val_loss: 11.3148 - val_accuracy10: 0.7312 - val_accuracy20: 0.6952 - val_accuracy30: 0.6580 - val_accuracy50: 0.6173 - 42s/epoch - 34ms/step
Epoch 14/50
1250/1250 - 43s - loss: 7.6680 - accuracy10: 0.6797 - accuracy20: 0.6683 - accuracy30: 0.6467 - accuracy50: 0.6241 - val_loss: 11.1759 - val_accuracy10: 0.7091 - val_accuracy20: 0.6760 - val_accuracy30: 0.6416 - val_accuracy50: 0.6040 - 43s/epoch - 34ms/step
Epoch 15/50
1250/1250 - 42s - loss: 7.6119 - accuracy10: 0.6805 - accuracy20: 0.6694 - accuracy30: 0.6476 - accuracy50: 0.6248 - val_loss: 11.1761 - val_accuracy10: 0.7307 - val_accuracy20: 0.6968 - val_accuracy30: 0.6623 - val_accuracy50: 0.6208 - 42s/epoch - 34ms/step
Epoch 16/50
1250/1250 - 43s - loss: 7.5736 - accuracy10: 0.6826 - accuracy20: 0.6706 - accuracy30: 0.6501 - accuracy50: 0.6260 - val_loss: 10.9343 - val_accuracy10: 0.7280 - val_accuracy20: 0.6914 - val_accuracy30: 0.6554 - val_accuracy50: 0.6164 - 43s/epoch - 34ms/step
Epoch 17/50
1250/1250 - 43s - loss: 7.5316 - accuracy10: 0.6821 - accuracy20: 0.6708 - accuracy30: 0.6503 - accuracy50: 0.6273 - val_loss: 10.7244 - val_accuracy10: 0.7071 - val_accuracy20: 0.6763 - val_accuracy30: 0.6448 - val_accuracy50: 0.6091 - 43s/epoch - 34ms/step
Epoch 18/50
1250/1250 - 42s - loss: 7.4824 - accuracy10: 0.6841 - accuracy20: 0.6727 - accuracy30: 0.6521 - accuracy50: 0.6291 - val_loss: 11.0318 - val_accuracy10: 0.7109 - val_accuracy20: 0.6766 - val_accuracy30: 0.6444 - val_accuracy50: 0.6065 - 42s/epoch - 34ms/step
Epoch 19/50
1250/1250 - 42s - loss: 7.4416 - accuracy10: 0.6839 - accuracy20: 0.6721 - accuracy30: 0.6516 - accuracy50: 0.6302 - val_loss: 11.2306 - val_accuracy10: 0.7122 - val_accuracy20: 0.6786 - val_accuracy30: 0.6467 - val_accuracy50: 0.6084 - 42s/epoch - 34ms/step
Epoch 20/50
1250/1250 - 43s - loss: 7.4081 - accuracy10: 0.6857 - accuracy20: 0.6734 - accuracy30: 0.6529 - accuracy50: 0.6303 - val_loss: 11.0872 - val_accuracy10: 0.6989 - val_accuracy20: 0.6657 - val_accuracy30: 0.6343 - val_accuracy50: 0.5996 - 43s/epoch - 34ms/step
testing model: results/EXC/W9/deepOF_L2/seq2seq
Evaluating performance on  test set...
2354/2354 - 35s - 35s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6225575
{'0': {'precision': 0.24789550072568942, 'recall': 0.6758408441415695, 'f1-score': 0.3627396613769099, 'support': 45490}, '1': {'precision': 0.9409500612496842, 'recall': 0.7696882974596311, 'f1-score': 0.8467461833186603, 'support': 512957}, '2': {'precision': 0.3751106119392826, 'recall': 0.5017641301131319, 'f1-score': 0.4292906178489702, 'support': 43931}, 'accuracy': 0.7430616655986773, 'macro avg': {'precision': 0.5213187246382187, 'recall': 0.6490977572381108, 'f1-score': 0.5462588208481801, 'support': 602378}, 'weighted avg': {'precision': 0.8473461367937914, 'recall': 0.7430616655986773, 'f1-score': 0.7797505474724321, 'support': 602378}}
[[ 30744   8135   6611]
 [ 88030 394817  30110]
 [  5246  16642  22043]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6728341
{'0': {'precision': 0.29201543290609466, 'recall': 0.7081687996574528, 'f1-score': 0.41351625404556963, 'support': 63057}, '1': {'precision': 0.9034228315964792, 'recall': 0.7336584201534287, 'f1-score': 0.8097383885511196, 'support': 477616}, '2': {'precision': 0.4621217041174178, 'recall': 0.46127542338546307, 'f1-score': 0.4616981759491309, 'support': 61705}, 'accuracy': 0.7030884262041442, 'macro avg': {'precision': 0.5525199895399973, 'recall': 0.6343675477321148, 'f1-score': 0.5616509395152733, 'support': 602378}, 'weighted avg': {'precision': 0.7942156520342856, 'recall': 0.7030884262041442, 'f1-score': 0.732610073018145, 'support': 602378}}
[[ 44655  11574   6828]
 [100908 350407  26301]
 [  7357  25885  28463]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.73333055
{'0': {'precision': 0.31431723854060667, 'recall': 0.7160196387409327, 'f1-score': 0.4368616140066505, 'support': 76787}, '1': {'precision': 0.8654112610382678, 'recall': 0.6947357203277881, 'f1-score': 0.7707377868856498, 'support': 450413}, '2': {'precision': 0.49393529974344574, 'recall': 0.4327994892122696, 'f1-score': 0.46135085890918887, 'support': 75178}, 'accuracy': 0.6647586731255125, 'macro avg': {'precision': 0.5578879331074401, 'recall': 0.61451828276033, 'f1-score': 0.556316753267163, 'support': 602378}, 'weighted avg': {'precision': 0.7488006336186906, 'recall': 0.6647586731255125, 'f1-score': 0.6895654330508914, 'support': 602378}}
[[ 54981  15044   6762]
 [110921 312918  26574]
 [  9020  33621  32537]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8155789
{'0': {'precision': 0.36029944206254527, 'recall': 0.687611226549218, 'f1-score': 0.4728379025090586, 'support': 100583}, '1': {'precision': 0.7881265636497424, 'recall': 0.6635706019235582, 'f1-score': 0.7205051172314884, 'support': 403523}, '2': {'precision': 0.5290430303802125, 'recall': 0.38045424943015305, 'f1-score': 0.44261082140130104, 'support': 98272}, 'accuracy': 0.6213971957807224, 'macro avg': {'precision': 0.5591563453641667, 'recall': 0.5772120259676431, 'f1-score': 0.5453179470472826, 'support': 602378}, 'weighted avg': {'precision': 0.6744225566108594, 'recall': 0.6213971957807224, 'f1-score': 0.6338148003569506, 'support': 602378}}
[[ 69162  24079   7342]
 [109816 267766  25941]
 [ 12979  47905  37388]]
Evaluating performance on  train set...
1250/1250 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5674101
{'0': {'precision': 0.26559183075909526, 'recall': 0.6498746193802615, 'f1-score': 0.37707856994387856, 'support': 22332}, '1': {'precision': 0.944148638286507, 'recall': 0.7979996213334887, 'f1-score': 0.8649439009278151, 'support': 274648}, '2': {'precision': 0.3769319005071239, 'recall': 0.5446654453458954, 'f1-score': 0.4455346630035323, 'support': 22926}, 'accuracy': 0.7695041668490119, 'macro avg': {'precision': 0.5288907898509086, 'recall': 0.6641798953532152, 'f1-score': 0.5625190446250753, 'support': 319906}, 'weighted avg': {'precision': 0.8561304655856751, 'recall': 0.7695041668490119, 'f1-score': 0.8008301151276571, 'support': 319906}}
[[ 14513   4589   3230]
 [ 38068 219169  17411]
 [  2063   8376  12487]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6107181
{'0': {'precision': 0.3250208805631786, 'recall': 0.6891840607210626, 'f1-score': 0.44172376048972306, 'support': 31620}, '1': {'precision': 0.9083589027504732, 'recall': 0.7734157759500652, 'f1-score': 0.8354735203347692, 'support': 255693}, '2': {'precision': 0.47578947368421054, 'recall': 0.5131163133188108, 'f1-score': 0.4937484315722658, 'support': 32593}, 'accuracy': 0.7385700799609886, 'macro avg': {'precision': 0.5697230856659541, 'recall': 0.6585720499966462, 'f1-score': 0.590315237465586, 'support': 319906}, 'weighted avg': {'precision': 0.8066293832568752, 'recall': 0.7385700799609886, 'f1-score': 0.7617386944036, 'support': 319906}}
[[ 21792   6771   3057]
 [ 42567 197757  15369]
 [  2689  13180  16724]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6685936
{'0': {'precision': 0.3545349155279989, 'recall': 0.6975039721182923, 'f1-score': 0.47011477377734406, 'support': 39022}, '1': {'precision': 0.8716429103623587, 'recall': 0.7439607301988429, 'f1-score': 0.8027564184499745, 'support': 240592}, '2': {'precision': 0.5190546763351506, 'recall': 0.4867715675568351, 'f1-score': 0.5023950408565794, 'support': 40292}, 'accuracy': 0.7059011084506074, 'macro avg': {'precision': 0.5817441674085028, 'recall': 0.6427454232913234, 'f1-score': 0.591755411027966, 'support': 319906}, 'weighted avg': {'precision': 0.7641579826027961, 'recall': 0.7059011084506074, 'f1-score': 0.7243505652168108, 'support': 319906}}
[[ 27218   8899   2905]
 [ 46333 178991  15268]
 [  3220  17459  19613]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7552101
{'0': {'precision': 0.40667581377744133, 'recall': 0.6622621157254026, 'f1-score': 0.5039132346475157, 'support': 51916}, '1': {'precision': 0.7932374381004131, 'recall': 0.7222909421896515, 'f1-score': 0.7561035794473124, 'support': 214235}, '2': {'precision': 0.5671415806195393, 'recall': 0.42505813412705795, 'f1-score': 0.4859266505747371, 'support': 53755}, 'accuracy': 0.6626040149293855, 'macro avg': {'precision': 0.5890182774991314, 'recall': 0.603203730680704, 'f1-score': 0.5819811548898551, 'support': 319906}, 'weighted avg': {'precision': 0.692512487311007, 'recall': 0.6626040149293855, 'f1-score': 0.6697779877042019, 'support': 319906}}
[[ 34382  14369   3165]
 [ 45221 154740  14274]
 [  4941  25965  22849]]
Evaluating performance on  val set...
495/495 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.61475986
{'0': {'precision': 0.230953044724999, 'recall': 0.6284816299989162, 'f1-score': 0.3377795899347623, 'support': 9227}, '1': {'precision': 0.9435967827931617, 'recall': 0.7685392220271644, 'f1-score': 0.8471186112709478, 'support': 108230}, '2': {'precision': 0.36305112658133093, 'recall': 0.5293604016590264, 'f1-score': 0.4307091159362373, 'support': 9162}, 'accuracy': 0.7410262282911727, 'macro avg': {'precision': 0.5125336513664972, 'recall': 0.6421270845617024, 'f1-score': 0.5385357723806491, 'support': 126619}, 'weighted avg': {'precision': 0.8496573023568312, 'recall': 0.7410262282911727, 'f1-score': 0.7798710817048826, 'support': 126619}}
[[ 5799  1742  1686]
 [18228 83179  6823]
 [ 1082  3230  4850]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.65932035
{'0': {'precision': 0.2810304449648712, 'recall': 0.6696636180437141, 'f1-score': 0.39591256930761126, 'support': 12902}, '1': {'precision': 0.9077456958173976, 'recall': 0.7370744823343818, 'f1-score': 0.8135554241408766, 'support': 100789}, '2': {'precision': 0.4549016813907096, 'recall': 0.49388923267326734, 'f1-score': 0.473594422192553, 'support': 12928}, 'accuracy': 0.705375970430978, 'macro avg': {'precision': 0.5478926073909928, 'recall': 0.6335424443504544, 'f1-score': 0.5610208052136803, 'support': 126619}, 'weighted avg': {'precision': 0.7976496787503893, 'recall': 0.705375970430978, 'f1-score': 0.7362886320619096, 'support': 126619}}
[[ 8640  2470  1792]
 [20641 74289  5859]
 [ 1463  5080  6385]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.71546286
{'0': {'precision': 0.3069067531433123, 'recall': 0.6887768130745658, 'f1-score': 0.4246133259868551, 'support': 15664}, '1': {'precision': 0.8726071400590217, 'recall': 0.7023226484498161, 'f1-score': 0.7782591479747513, 'support': 95150}, '2': {'precision': 0.4968756299133239, 'recall': 0.46788990825688076, 'f1-score': 0.48194734098018766, 'support': 15805}, 'accuracy': 0.6713842314344609, 'macro avg': {'precision': 0.5587965077052193, 'recall': 0.619663123260421, 'f1-score': 0.561606604980598, 'support': 126619}, 'weighted avg': {'precision': 0.7557244654327775, 'recall': 0.6713842314344609, 'f1-score': 0.6975231110042532, 'support': 126619}}
[[10789  3125  1750]
 [22586 66826  5738]
 [ 1779  6631  7395]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7927308
{'0': {'precision': 0.3569847099580631, 'recall': 0.6683409733736467, 'f1-score': 0.46538872947688337, 'support': 20506}, '1': {'precision': 0.7988873857706855, 'recall': 0.6773763123705187, 'f1-score': 0.73313106872985, 'support': 85437}, '2': {'precision': 0.5415558089446345, 'recall': 0.4134745598761849, 'f1-score': 0.4689265536723164, 'support': 20676}, 'accuracy': 0.6328197189995183, 'macro avg': {'precision': 0.5658093015577944, 'recall': 0.5863972818734501, 'f1-score': 0.5558154506263498, 'support': 126619}, 'weighted avg': {'precision': 0.6853006100682313, 'recall': 0.6328197189995183, 'f1-score': 0.6466273294644088, 'support': 126619}}
[[13705  4942  1859]
 [22186 57873  5378]
 [ 2500  9627  8549]]
training model: results/EXC/W9/deepVOL_L2/seq2seq
Epoch 1/50
1250/1250 - 49s - loss: 9.2633 - accuracy10: 0.6131 - accuracy20: 0.6121 - accuracy30: 0.5976 - accuracy50: 0.5821 - val_loss: 9.8668 - val_accuracy10: 0.7782 - val_accuracy20: 0.7700 - val_accuracy30: 0.7513 - val_accuracy50: 0.7099 - 49s/epoch - 39ms/step
Epoch 2/50
1250/1250 - 41s - loss: 8.7137 - accuracy10: 0.6611 - accuracy20: 0.6518 - accuracy30: 0.6320 - accuracy50: 0.6100 - val_loss: 9.4667 - val_accuracy10: 0.7934 - val_accuracy20: 0.7790 - val_accuracy30: 0.7573 - val_accuracy50: 0.7143 - 41s/epoch - 33ms/step
Epoch 3/50
1250/1250 - 41s - loss: 8.4952 - accuracy10: 0.6838 - accuracy20: 0.6648 - accuracy30: 0.6412 - accuracy50: 0.6156 - val_loss: 9.3890 - val_accuracy10: 0.7891 - val_accuracy20: 0.7699 - val_accuracy30: 0.7453 - val_accuracy50: 0.7026 - 41s/epoch - 33ms/step
Epoch 4/50
1250/1250 - 41s - loss: 8.3662 - accuracy10: 0.6907 - accuracy20: 0.6679 - accuracy30: 0.6419 - accuracy50: 0.6162 - val_loss: 9.1887 - val_accuracy10: 0.7928 - val_accuracy20: 0.7756 - val_accuracy30: 0.7511 - val_accuracy50: 0.7083 - 41s/epoch - 33ms/step
Epoch 5/50
1250/1250 - 41s - loss: 8.2578 - accuracy10: 0.6907 - accuracy20: 0.6676 - accuracy30: 0.6411 - accuracy50: 0.6148 - val_loss: 9.1963 - val_accuracy10: 0.7797 - val_accuracy20: 0.7634 - val_accuracy30: 0.7393 - val_accuracy50: 0.6991 - 41s/epoch - 33ms/step
Epoch 6/50
1250/1250 - 41s - loss: 8.1701 - accuracy10: 0.6936 - accuracy20: 0.6698 - accuracy30: 0.6430 - accuracy50: 0.6166 - val_loss: 9.1093 - val_accuracy10: 0.7760 - val_accuracy20: 0.7589 - val_accuracy30: 0.7336 - val_accuracy50: 0.6935 - 41s/epoch - 33ms/step
Epoch 7/50
1250/1250 - 41s - loss: 8.1026 - accuracy10: 0.6948 - accuracy20: 0.6697 - accuracy30: 0.6414 - accuracy50: 0.6144 - val_loss: 9.0348 - val_accuracy10: 0.7887 - val_accuracy20: 0.7699 - val_accuracy30: 0.7429 - val_accuracy50: 0.7004 - 41s/epoch - 33ms/step
Epoch 8/50
1250/1250 - 41s - loss: 8.0528 - accuracy10: 0.6953 - accuracy20: 0.6711 - accuracy30: 0.6424 - accuracy50: 0.6141 - val_loss: 9.0367 - val_accuracy10: 0.7831 - val_accuracy20: 0.7653 - val_accuracy30: 0.7399 - val_accuracy50: 0.6965 - 41s/epoch - 33ms/step
Epoch 9/50
1250/1250 - 41s - loss: 8.0202 - accuracy10: 0.6964 - accuracy20: 0.6724 - accuracy30: 0.6433 - accuracy50: 0.6139 - val_loss: 9.0964 - val_accuracy10: 0.7866 - val_accuracy20: 0.7689 - val_accuracy30: 0.7419 - val_accuracy50: 0.6979 - 41s/epoch - 33ms/step
Epoch 10/50
1250/1250 - 41s - loss: 7.9850 - accuracy10: 0.6969 - accuracy20: 0.6733 - accuracy30: 0.6441 - accuracy50: 0.6152 - val_loss: 9.1600 - val_accuracy10: 0.7800 - val_accuracy20: 0.7615 - val_accuracy30: 0.7363 - val_accuracy50: 0.6935 - 41s/epoch - 33ms/step
Epoch 11/50
1250/1250 - 41s - loss: 7.9612 - accuracy10: 0.6960 - accuracy20: 0.6724 - accuracy30: 0.6434 - accuracy50: 0.6147 - val_loss: 9.0621 - val_accuracy10: 0.7797 - val_accuracy20: 0.7630 - val_accuracy30: 0.7377 - val_accuracy50: 0.6962 - 41s/epoch - 33ms/step
Epoch 12/50
1250/1250 - 41s - loss: 7.9200 - accuracy10: 0.6953 - accuracy20: 0.6727 - accuracy30: 0.6445 - accuracy50: 0.6160 - val_loss: 9.0455 - val_accuracy10: 0.7817 - val_accuracy20: 0.7640 - val_accuracy30: 0.7384 - val_accuracy50: 0.6950 - 41s/epoch - 33ms/step
Epoch 13/50
1250/1250 - 42s - loss: 7.8889 - accuracy10: 0.6976 - accuracy20: 0.6736 - accuracy30: 0.6443 - accuracy50: 0.6163 - val_loss: 9.1034 - val_accuracy10: 0.7782 - val_accuracy20: 0.7628 - val_accuracy30: 0.7389 - val_accuracy50: 0.6966 - 42s/epoch - 33ms/step
Epoch 14/50
1250/1250 - 41s - loss: 7.8617 - accuracy10: 0.6969 - accuracy20: 0.6739 - accuracy30: 0.6453 - accuracy50: 0.6163 - val_loss: 9.1035 - val_accuracy10: 0.7806 - val_accuracy20: 0.7634 - val_accuracy30: 0.7380 - val_accuracy50: 0.6962 - 41s/epoch - 33ms/step
Epoch 15/50
1250/1250 - 41s - loss: 7.8392 - accuracy10: 0.6979 - accuracy20: 0.6740 - accuracy30: 0.6459 - accuracy50: 0.6178 - val_loss: 9.0480 - val_accuracy10: 0.7848 - val_accuracy20: 0.7653 - val_accuracy30: 0.7403 - val_accuracy50: 0.6962 - 41s/epoch - 33ms/step
Epoch 16/50
1250/1250 - 41s - loss: 7.8122 - accuracy10: 0.6977 - accuracy20: 0.6739 - accuracy30: 0.6465 - accuracy50: 0.6181 - val_loss: 9.1472 - val_accuracy10: 0.7788 - val_accuracy20: 0.7605 - val_accuracy30: 0.7374 - val_accuracy50: 0.6961 - 41s/epoch - 33ms/step
Epoch 17/50
1250/1250 - 41s - loss: 7.7952 - accuracy10: 0.6975 - accuracy20: 0.6744 - accuracy30: 0.6472 - accuracy50: 0.6180 - val_loss: 9.1533 - val_accuracy10: 0.7808 - val_accuracy20: 0.7640 - val_accuracy30: 0.7414 - val_accuracy50: 0.6989 - 41s/epoch - 33ms/step
testing model: results/EXC/W9/deepVOL_L2/seq2seq
Evaluating performance on  test set...
2354/2354 - 34s - 34s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5687918
{'0': {'precision': 0.4471895372873271, 'recall': 0.4945813457606999, 'f1-score': 0.4696930158763296, 'support': 45491}, '1': {'precision': 0.9445049956653416, 'recall': 0.8092108726038534, 'f1-score': 0.871639158372181, 'support': 512959}, '2': {'precision': 0.273588005933084, 'recall': 0.701151780023673, 'f1-score': 0.3935957475354744, 'support': 43932}, 'accuracy': 0.7775697148985196, 'macro avg': {'precision': 0.5550941796285842, 'recall': 0.6683146661294087, 'f1-score': 0.5783093072613283, 'support': 602382}, 'weighted avg': {'precision': 0.8580181771515218, 'recall': 0.7775697148985196, 'f1-score': 0.8064208499015478, 'support': 602382}}
[[ 22499  16391   6601]
 [ 22682 415092  75185]
 [  5131   7998  30803]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6040433
{'0': {'precision': 0.5178601919202267, 'recall': 0.48096990072631546, 'f1-score': 0.4987338025389726, 'support': 63058}, '1': {'precision': 0.9065650949868698, 'recall': 0.8023098053666544, 'f1-score': 0.8512572392053369, 'support': 477616}, '2': {'precision': 0.3437907633373512, 'recall': 0.6748233616386854, 'f1-score': 0.45551702637365044, 'support': 61708}, 'accuracy': 0.7556118874733972, 'macro avg': {'precision': 0.5894053500814825, 'recall': 0.6527010225772184, 'f1-score': 0.6018360227059866, 'support': 602382}, 'weighted avg': {'precision': 0.8082244536081352, 'recall': 0.7556118874733972, 'f1-score': 0.7738150846875638, 'support': 602382}}
[[ 30329  25227   7502]
 [ 22438 383196  71982]
 [  5799  14267  41642]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6613546
{'0': {'precision': 0.5362672576442754, 'recall': 0.4663879772881179, 'f1-score': 0.498892526293794, 'support': 76788}, '1': {'precision': 0.8693675664724746, 'recall': 0.7812385521732277, 'f1-score': 0.8229503710971073, 'support': 450413}, '2': {'precision': 0.3768475918255048, 'recall': 0.6558704991952754, 'f1-score': 0.4786654176394356, 'support': 75181}, 'accuracy': 0.7254566039489891, 'macro avg': {'precision': 0.5941608053140849, 'recall': 0.634499009552207, 'f1-score': 0.6001694383434456, 'support': 602382}, 'weighted avg': {'precision': 0.7654364219026939, 'recall': 0.7254566039489891, 'f1-score': 0.7386725525821815, 'support': 602382}}
[[ 35813  32944   8031]
 [ 25027 351880  73506]
 [  5942  19930  49309]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7468278
{'0': {'precision': 0.5590628787576084, 'recall': 0.4173087438484864, 'f1-score': 0.47789555178577525, 'support': 100585}, '1': {'precision': 0.7909511501680021, 'recall': 0.7583681723222716, 'f1-score': 0.7743170428998145, 'support': 403523}, '2': {'precision': 0.4234371550060185, 'recall': 0.6049514622382319, 'f1-score': 0.4981753430396983, 'support': 98274}, 'accuracy': 0.676389732760939, 'macro avg': {'precision': 0.5911503946438764, 'recall': 0.5935427928029967, 'f1-score': 0.5834626459084293, 'support': 602382}, 'weighted avg': {'precision': 0.6922736462911212, 'recall': 0.676389732760939, 'f1-score': 0.6797705506477905, 'support': 602382}}
[[ 41975  48721   9889]
 [ 26443 306019  71061]
 [  6663  32160  59451]]
Evaluating performance on  train set...
1250/1250 - 16s - 16s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.53925645
{'0': {'precision': 0.43918733053012143, 'recall': 0.5005598602588793, 'f1-score': 0.4678695524762423, 'support': 22327}, '1': {'precision': 0.9473198402309267, 'recall': 0.8221384747027873, 'f1-score': 0.8803011429317771, 'support': 274635}, '2': {'precision': 0.2925547081046404, 'recall': 0.7154935715842231, 'f1-score': 0.41529957880623825, 'support': 22945}, 'accuracy': 0.7920458133144945, 'macro avg': {'precision': 0.5596872929552296, 'recall': 0.6793973021819633, 'f1-score': 0.5878234247380858, 'support': 319907}, 'weighted avg': {'precision': 0.8648938211043447, 'recall': 0.7920458133144945, 'f1-score': 0.8181648939314076, 'support': 319907}}
[[ 11176   7991   3160]
 [ 12308 225788  36539]
 [  1963   4565  16417]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.5707558
{'0': {'precision': 0.52203893996755, 'recall': 0.48823975720789076, 'f1-score': 0.5045739675901725, 'support': 31632}, '1': {'precision': 0.9097512762028891, 'recall': 0.8190579749825943, 'f1-score': 0.8620257411436346, 'support': 255662}, '2': {'precision': 0.37387776817184276, 'recall': 0.689540980590562, 'f1-score': 0.4848589385625424, 'support': 32613}, 'accuracy': 0.7731434448136489, 'macro avg': {'precision': 0.601889328114094, 'recall': 0.665612904260349, 'f1-score': 0.6171528824321165, 'support': 319907}, 'weighted avg': {'precision': 0.8167850099529702, 'recall': 0.7731434448136489, 'f1-score': 0.7882309963158557, 'support': 319907}}
[[ 15444  12746   3442]
 [ 12042 209402  34218]
 [  2098   8027  22488]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.624431
{'0': {'precision': 0.5493954585667945, 'recall': 0.476946314738486, 'f1-score': 0.5106138054843705, 'support': 39061}, '1': {'precision': 0.8721726405549936, 'recall': 0.8028520943768839, 'f1-score': 0.8360779593577423, 'support': 240525}, '2': {'precision': 0.41589125083218503, 'recall': 0.6662037151856353, 'f1-score': 0.5120960823563054, 'support': 40321}, 'accuracy': 0.7458355084446417, 'macro avg': {'precision': 0.6124864499846577, 'recall': 0.6486673747670016, 'f1-score': 0.6195959490661395, 'support': 319907}, 'weighted avg': {'precision': 0.7752515934361296, 'recall': 0.7458355084446417, 'f1-score': 0.7555038281976778, 'support': 319907}}
[[ 18630  16865   3566]
 [ 13258 193106  34161]
 [  2022  11437  26862]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7098389
{'0': {'precision': 0.5864724245577524, 'recall': 0.4338722093918399, 'f1-score': 0.49876106194690273, 'support': 51960}, '1': {'precision': 0.7927083039085525, 'recall': 0.7860727641118773, 'f1-score': 0.7893765895852135, 'support': 214199}, '2': {'precision': 0.4744790837086054, 'recall': 0.6096598943216491, 'f1-score': 0.5336416712130218, 'support': 53748}, 'accuracy': 0.699228213199461, 'macro avg': {'precision': 0.6178866040583034, 'recall': 0.609868289275122, 'f1-score': 0.6072597742483793, 'support': 319907}, 'weighted avg': {'precision': 0.7057449038629944, 'recall': 0.699228213199461, 'f1-score': 0.6992078117567971, 'support': 319907}}
[[ 22544  25230   4186]
 [ 13716 168376  32107]
 [  2180  18800  32768]]
Evaluating performance on  val set...
495/495 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.56283134
{'0': {'precision': 0.4094136926438456, 'recall': 0.48626730103806226, 'f1-score': 0.4445432977461447, 'support': 9248}, '1': {'precision': 0.950105622098073, 'recall': 0.819337716499755, 'f1-score': 0.8798895718924716, 'support': 108141}, '2': {'precision': 0.2989096433997676, 'recall': 0.7247020585048755, 'f1-score': 0.42324727916983035, 'support': 9230}, 'accuracy': 0.7881123686018686, 'macro avg': {'precision': 0.5528096527138954, 'recall': 0.6767690253475642, 'f1-score': 0.5825600496028155, 'support': 126619}, 'weighted avg': {'precision': 0.8631450723624248, 'recall': 0.7881123686018686, 'f1-score': 0.8148054162354597, 'support': 126619}}
[[ 4497  2901  1850]
 [ 5698 88604 13839]
 [  789  1752  6689]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.5917332
{'0': {'precision': 0.4840186190845617, 'recall': 0.48323135310975135, 'f1-score': 0.48362466571063134, 'support': 12911}, '1': {'precision': 0.9149606474523817, 'recall': 0.816202903731951, 'f1-score': 0.8627648574742687, 'support': 100698}, '2': {'precision': 0.37845188284518827, 'recall': 0.6952344350499615, 'f1-score': 0.49011108100785694, 'support': 13010}, 'accuracy': 0.7698212748481665, 'macro avg': {'precision': 0.5924770497940438, 'recall': 0.664889563963888, 'f1-score': 0.6121668680642524, 'support': 126619}, 'weighted avg': {'precision': 0.8158928017436293, 'recall': 0.7698212748481665, 'f1-score': 0.7858150738897487, 'support': 126619}}
[[ 6239  4594  2078]
 [ 5731 82190 12777]
 [  920  3045  9045]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.64183336
{'0': {'precision': 0.5048973567690863, 'recall': 0.47994388113002995, 'f1-score': 0.49210448883512603, 'support': 15681}, '1': {'precision': 0.8813608539602523, 'recall': 0.7981466093048207, 'f1-score': 0.8376922312626269, 'support': 95069}, '2': {'precision': 0.41701795472287273, 'recall': 0.6732623353708488, 'f1-score': 0.5150280797319772, 'support': 15869}, 'accuracy': 0.7430875303074578, 'macro avg': {'precision': 0.6010920551507372, 'recall': 0.6504509419352331, 'f1-score': 0.6149415999432434, 'support': 126619}, 'weighted avg': {'precision': 0.7765426073507178, 'recall': 0.7430875303074578, 'f1-score': 0.7544541800250912, 'support': 126619}}
[[ 7526  5979  2176]
 [ 6430 75879 12760]
 [  950  4235 10684]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7180315
{'0': {'precision': 0.5409206405483661, 'recall': 0.44592751363990646, 'f1-score': 0.48885210007743446, 'support': 20528}, '1': {'precision': 0.8092992240543162, 'recall': 0.7818473575712144, 'f1-score': 0.7953364788866648, 'support': 85376}, '2': {'precision': 0.4699808935920047, 'recall': 0.6174752594738112, 'f1-score': 0.5337255638313408, 'support': 20715}, 'accuracy': 0.7004951863464409, 'macro avg': {'precision': 0.6067335860648957, 'recall': 0.6150833768949773, 'f1-score': 0.6059713809318134, 'support': 126619}, 'weighted avg': {'precision': 0.7102757380234921, 'recall': 0.7004951863464409, 'f1-score': 0.7028481364296328, 'support': 126619}}
[[ 9154  8872  2502]
 [ 6702 66751 11923]
 [ 1067  6857 12791]]
training model: results/EXC/W9/deepVOL_L3/seq2seq
Epoch 1/50
1250/1250 - 65s - loss: 9.9225 - accuracy10: 0.5096 - accuracy20: 0.5263 - accuracy30: 0.5357 - accuracy50: 0.5445 - val_loss: 9.6815 - val_accuracy10: 0.7256 - val_accuracy20: 0.7214 - val_accuracy30: 0.7099 - val_accuracy50: 0.6789 - 65s/epoch - 52ms/step
Epoch 2/50
1250/1250 - 57s - loss: 8.6881 - accuracy10: 0.6638 - accuracy20: 0.6540 - accuracy30: 0.6369 - accuracy50: 0.6136 - val_loss: 9.4871 - val_accuracy10: 0.7480 - val_accuracy20: 0.7430 - val_accuracy30: 0.7271 - val_accuracy50: 0.6915 - 57s/epoch - 46ms/step
Epoch 3/50
1250/1250 - 57s - loss: 8.4733 - accuracy10: 0.6826 - accuracy20: 0.6673 - accuracy30: 0.6453 - accuracy50: 0.6200 - val_loss: 9.2026 - val_accuracy10: 0.7457 - val_accuracy20: 0.7409 - val_accuracy30: 0.7257 - val_accuracy50: 0.6914 - 57s/epoch - 46ms/step
Epoch 4/50
1250/1250 - 57s - loss: 8.3140 - accuracy10: 0.6904 - accuracy20: 0.6718 - accuracy30: 0.6486 - accuracy50: 0.6226 - val_loss: 9.2664 - val_accuracy10: 0.7102 - val_accuracy20: 0.7103 - val_accuracy30: 0.6990 - val_accuracy50: 0.6741 - 57s/epoch - 46ms/step
Epoch 5/50
1250/1250 - 57s - loss: 8.2073 - accuracy10: 0.6929 - accuracy20: 0.6735 - accuracy30: 0.6498 - accuracy50: 0.6244 - val_loss: 9.3185 - val_accuracy10: 0.7204 - val_accuracy20: 0.7123 - val_accuracy30: 0.6964 - val_accuracy50: 0.6699 - 57s/epoch - 45ms/step
Epoch 6/50
1250/1250 - 57s - loss: 8.0843 - accuracy10: 0.6985 - accuracy20: 0.6770 - accuracy30: 0.6518 - accuracy50: 0.6264 - val_loss: 9.6703 - val_accuracy10: 0.6699 - val_accuracy20: 0.6660 - val_accuracy30: 0.6558 - val_accuracy50: 0.6400 - 57s/epoch - 46ms/step
Epoch 7/50
1250/1250 - 56s - loss: 8.0072 - accuracy10: 0.6987 - accuracy20: 0.6767 - accuracy30: 0.6511 - accuracy50: 0.6259 - val_loss: 9.5977 - val_accuracy10: 0.6369 - val_accuracy20: 0.6383 - val_accuracy30: 0.6316 - val_accuracy50: 0.6222 - 56s/epoch - 45ms/step
Epoch 8/50
1250/1250 - 56s - loss: 7.9532 - accuracy10: 0.6989 - accuracy20: 0.6768 - accuracy30: 0.6516 - accuracy50: 0.6259 - val_loss: 9.4533 - val_accuracy10: 0.6791 - val_accuracy20: 0.6715 - val_accuracy30: 0.6583 - val_accuracy50: 0.6387 - 56s/epoch - 45ms/step
Epoch 9/50
1250/1250 - 56s - loss: 7.8854 - accuracy10: 0.6995 - accuracy20: 0.6777 - accuracy30: 0.6518 - accuracy50: 0.6254 - val_loss: 9.3701 - val_accuracy10: 0.6593 - val_accuracy20: 0.6518 - val_accuracy30: 0.6368 - val_accuracy50: 0.6202 - 56s/epoch - 45ms/step
Epoch 10/50
1250/1250 - 57s - loss: 7.8478 - accuracy10: 0.7012 - accuracy20: 0.6788 - accuracy30: 0.6532 - accuracy50: 0.6264 - val_loss: 9.4610 - val_accuracy10: 0.6246 - val_accuracy20: 0.6193 - val_accuracy30: 0.6061 - val_accuracy50: 0.5947 - 57s/epoch - 46ms/step
Epoch 11/50
1250/1250 - 56s - loss: 7.8138 - accuracy10: 0.7011 - accuracy20: 0.6793 - accuracy30: 0.6531 - accuracy50: 0.6277 - val_loss: 9.1287 - val_accuracy10: 0.6822 - val_accuracy20: 0.6732 - val_accuracy30: 0.6557 - val_accuracy50: 0.6350 - 56s/epoch - 45ms/step
Epoch 12/50
1250/1250 - 57s - loss: 7.8041 - accuracy10: 0.7009 - accuracy20: 0.6780 - accuracy30: 0.6528 - accuracy50: 0.6276 - val_loss: 9.3209 - val_accuracy10: 0.6474 - val_accuracy20: 0.6402 - val_accuracy30: 0.6249 - val_accuracy50: 0.6092 - 57s/epoch - 45ms/step
Epoch 13/50
1250/1250 - 57s - loss: 7.7534 - accuracy10: 0.7010 - accuracy20: 0.6783 - accuracy30: 0.6529 - accuracy50: 0.6284 - val_loss: 9.3169 - val_accuracy10: 0.6859 - val_accuracy20: 0.6766 - val_accuracy30: 0.6593 - val_accuracy50: 0.6370 - 57s/epoch - 46ms/step
Epoch 14/50
1250/1250 - 58s - loss: 7.7345 - accuracy10: 0.7017 - accuracy20: 0.6792 - accuracy30: 0.6537 - accuracy50: 0.6280 - val_loss: 9.2727 - val_accuracy10: 0.6895 - val_accuracy20: 0.6767 - val_accuracy30: 0.6558 - val_accuracy50: 0.6319 - 58s/epoch - 46ms/step
Epoch 15/50
1250/1250 - 56s - loss: 7.7053 - accuracy10: 0.7021 - accuracy20: 0.6794 - accuracy30: 0.6543 - accuracy50: 0.6296 - val_loss: 9.2379 - val_accuracy10: 0.6435 - val_accuracy20: 0.6367 - val_accuracy30: 0.6209 - val_accuracy50: 0.6073 - 56s/epoch - 45ms/step
Epoch 16/50
1250/1250 - 56s - loss: 7.6807 - accuracy10: 0.7022 - accuracy20: 0.6798 - accuracy30: 0.6551 - accuracy50: 0.6309 - val_loss: 9.3978 - val_accuracy10: 0.6369 - val_accuracy20: 0.6304 - val_accuracy30: 0.6136 - val_accuracy50: 0.5984 - 56s/epoch - 45ms/step
Epoch 17/50
1250/1250 - 58s - loss: 7.6520 - accuracy10: 0.7035 - accuracy20: 0.6797 - accuracy30: 0.6549 - accuracy50: 0.6315 - val_loss: 9.3640 - val_accuracy10: 0.6898 - val_accuracy20: 0.6755 - val_accuracy30: 0.6519 - val_accuracy50: 0.6286 - 58s/epoch - 46ms/step
Epoch 18/50
1250/1250 - 57s - loss: 7.6294 - accuracy10: 0.7042 - accuracy20: 0.6804 - accuracy30: 0.6553 - accuracy50: 0.6314 - val_loss: 9.3710 - val_accuracy10: 0.6390 - val_accuracy20: 0.6301 - val_accuracy30: 0.6130 - val_accuracy50: 0.5985 - 57s/epoch - 45ms/step
Epoch 19/50
1250/1250 - 58s - loss: 7.6153 - accuracy10: 0.7040 - accuracy20: 0.6809 - accuracy30: 0.6556 - accuracy50: 0.6320 - val_loss: 9.2940 - val_accuracy10: 0.6454 - val_accuracy20: 0.6343 - val_accuracy30: 0.6150 - val_accuracy50: 0.5986 - 58s/epoch - 46ms/step
Epoch 20/50
1250/1250 - 58s - loss: 7.5859 - accuracy10: 0.7030 - accuracy20: 0.6815 - accuracy30: 0.6563 - accuracy50: 0.6329 - val_loss: 9.4819 - val_accuracy10: 0.6759 - val_accuracy20: 0.6609 - val_accuracy30: 0.6382 - val_accuracy50: 0.6153 - 58s/epoch - 46ms/step
Epoch 21/50
1250/1250 - 58s - loss: 7.5597 - accuracy10: 0.7037 - accuracy20: 0.6818 - accuracy30: 0.6567 - accuracy50: 0.6339 - val_loss: 9.5926 - val_accuracy10: 0.6204 - val_accuracy20: 0.6072 - val_accuracy30: 0.5858 - val_accuracy50: 0.5712 - 58s/epoch - 47ms/step
testing model: results/EXC/W9/deepVOL_L3/seq2seq
Evaluating performance on  test set...
2354/2354 - 47s - 47s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7414369
{'0': {'precision': 0.3501999117446479, 'recall': 0.5756962915741575, 'f1-score': 0.43548896685900523, 'support': 45491}, '1': {'precision': 0.9626086411022652, 'recall': 0.6581091276300834, 'f1-score': 0.781754288460091, 'support': 512959}, '2': {'precision': 0.19657100218763957, 'recall': 0.7915414731858327, 'f1-score': 0.31493196277763946, 'support': 43932}, 'accuracy': 0.6616167149748831, 'macro avg': {'precision': 0.5031265183448509, 'recall': 0.6751156307966912, 'f1-score': 0.5107250726989119, 'support': 602382}, 'weighted avg': {'precision': 0.8604929552749916, 'recall': 0.6616167149748831, 'f1-score': 0.7215592724124062, 'support': 602382}}
[[ 26189   7875  11427]
 [ 44674 337583 130702]
 [  3920   5238  34774]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.77115256
{'0': {'precision': 0.4132681548331225, 'recall': 0.5751530337149926, 'f1-score': 0.4809537386368911, 'support': 63058}, '1': {'precision': 0.9309906599295666, 'recall': 0.6365259957790359, 'f1-score': 0.756100108684028, 'support': 477616}, '2': {'precision': 0.25086003838934884, 'recall': 0.7645686134698905, 'f1-score': 0.3777709273323432, 'support': 61708}, 'accuracy': 0.643218090846008, 'macro avg': {'precision': 0.5317062843840127, 'recall': 0.6587492143213063, 'f1-score': 0.5382749248844209, 'support': 602382}, 'weighted avg': {'precision': 0.8071223402912385, 'recall': 0.643218090846008, 'f1-score': 0.6885414549970286, 'support': 602382}}
[[ 36268  13259  13531]
 [ 46239 304015 127362]
 [  5252   9276  47180]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.81461865
{'0': {'precision': 0.4313682467810945, 'recall': 0.5632650935041934, 'f1-score': 0.48857134788625006, 'support': 76788}, '1': {'precision': 0.8983669421487603, 'recall': 0.6033484823928261, 'f1-score': 0.7218788890615516, 'support': 450413}, '2': {'precision': 0.2825990030809308, 'recall': 0.7503358561338636, 'f1-score': 0.410566383790157, 'support': 75181}, 'accuracy': 0.6165838288660683, 'macro avg': {'precision': 0.5374447306702619, 'recall': 0.6389831440102943, 'f1-score': 0.5403388735793195, 'support': 602382}, 'weighted avg': {'precision': 0.7619851358415486, 'recall': 0.6165838288660683, 'f1-score': 0.6532845337677716, 'support': 602382}}
[[ 43252  17732  15804]
 [ 51257 271756 127400]
 [  5758  13012  56411]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.86702716
{'0': {'precision': 0.46169986719787515, 'recall': 0.5184570263955858, 'f1-score': 0.48843515114618213, 'support': 100585}, '1': {'precision': 0.8261607241931038, 'recall': 0.57197978801704, 'f1-score': 0.6759653007192896, 'support': 403523}, '2': {'precision': 0.3319210317101386, 'recall': 0.7094755479577508, 'f1-score': 0.45225778622463375, 'support': 98274}, 'accuracy': 0.585474001547191, 'macro avg': {'precision': 0.5399272077003726, 'recall': 0.5999707874567922, 'f1-score': 0.5388860793633685, 'support': 602382}, 'weighted avg': {'precision': 0.684672089340243, 'recall': 0.585474001547191, 'f1-score': 0.6081555846682476, 'support': 602382}}
[[ 52149  27201  21235]
 [ 53615 230807 119101]
 [  7186  21365  69723]]
Evaluating performance on  train set...
1250/1250 - 24s - 24s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6514479
{'0': {'precision': 0.3456477732793522, 'recall': 0.581224526358221, 'f1-score': 0.4334986888476892, 'support': 22327}, '1': {'precision': 0.9630571681590082, 'recall': 0.712767855517323, 'f1-score': 0.8192217955827117, 'support': 274635}, '2': {'precision': 0.23162206237437266, 'recall': 0.7985181956853344, 'f1-score': 0.35908592035120723, 'support': 22945}, 'accuracy': 0.7097375174660135, 'macro avg': {'precision': 0.5134423346042444, 'recall': 0.6975035258536261, 'f1-score': 0.5372688015938695, 'support': 319907}, 'weighted avg': {'precision': 0.8675054044848576, 'recall': 0.7097375174660135, 'f1-score': 0.7592985758305346, 'support': 319907}}
[[ 12977   4492   4858]
 [ 22961 195751  55923]
 [  1606   3017  18322]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6729128
{'0': {'precision': 0.4236248831749071, 'recall': 0.5875063227111785, 'f1-score': 0.4922848703990675, 'support': 31632}, '1': {'precision': 0.934079537298062, 'recall': 0.702443069365021, 'f1-score': 0.8018681740652431, 'support': 255662}, '2': {'precision': 0.3019599885408709, 'recall': 0.7756722779259805, 'f1-score': 0.43469743704301955, 'support': 32613}, 'accuracy': 0.6985436392451556, 'macro avg': {'precision': 0.5532214696712799, 'recall': 0.6885405566673933, 'f1-score': 0.5762834938357767, 'support': 319907}, 'weighted avg': {'precision': 0.8191648387674206, 'recall': 0.6985436392451556, 'f1-score': 0.733825654495261, 'support': 319907}}
[[ 18584   7276   5772]
 [ 23367 179588  52707]
 [  1918   5398  25297]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.71173763
{'0': {'precision': 0.45620057007507325, 'recall': 0.5818335424080284, 'f1-score': 0.5114143948514273, 'support': 39061}, '1': {'precision': 0.9042753695069934, 'recall': 0.6822076707202993, 'f1-score': 0.7776995755753193, 'support': 240525}, '2': {'precision': 0.3448454829574302, 'recall': 0.7580169142630391, 'f1-score': 0.47403685092127296, 'support': 40321}, 'accuracy': 0.6795068566802227, 'macro avg': {'precision': 0.5684404741798322, 'recall': 0.6740193757971222, 'f1-score': 0.5877169404493398, 'support': 319907}, 'weighted avg': {'precision': 0.7790545328382891, 'recall': 0.6795068566802227, 'f1-score': 0.7069122837529093, 'support': 319907}}
[[ 22727   9674   6660]
 [ 25030 164088  51407]
 [  2061   7696  30564]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7673064
{'0': {'precision': 0.5051187772610937, 'recall': 0.5393571978444958, 'f1-score': 0.5216768116751364, 'support': 51960}, '1': {'precision': 0.8353197555532186, 'recall': 0.6674867763154824, 'f1-score': 0.7420314977384841, 'support': 214199}, '2': {'precision': 0.406945948554089, 'recall': 0.7061286001339585, 'f1-score': 0.5163287100965235, 'support': 53748}, 'accuracy': 0.6531679519360314, 'macro avg': {'precision': 0.5824614937894671, 'recall': 0.6376575247646455, 'f1-score': 0.5933456731700479, 'support': 319907}, 'weighted avg': {'precision': 0.7097161325920204, 'recall': 0.6531679519360314, 'f1-score': 0.6683203788257012, 'support': 319907}}
[[ 28025  15129   8806]
 [ 24720 142975  46504]
 [  2737  13058  37953]]
Evaluating performance on  val set...
495/495 - 10s - 10s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.70983034
{'0': {'precision': 0.3058508945056344, 'recall': 0.5194636678200693, 'f1-score': 0.38501302344219596, 'support': 9248}, '1': {'precision': 0.9670120063232431, 'recall': 0.6844582535763494, 'f1-score': 0.8015637521387884, 'support': 108141}, '2': {'precision': 0.21967470685792428, 'recall': 0.8179848320693391, 'f1-score': 0.3463382187664855, 'support': 9230}, 'accuracy': 0.6821409109217416, 'macro avg': {'precision': 0.4975125358956007, 'recall': 0.6739689178219193, 'f1-score': 0.51097166478249, 'support': 126619}, 'weighted avg': {'precision': 0.8642443234624233, 'recall': 0.6821409109217416, 'f1-score': 0.7379556616309463, 'support': 126619}}
[[ 4804  1435  3009]
 [10313 74018 23810]
 [  590  1090  7550]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.72829485
{'0': {'precision': 0.3822935429288794, 'recall': 0.5424831538997754, 'f1-score': 0.4485143442622951, 'support': 12911}, '1': {'precision': 0.9412212683467184, 'recall': 0.6750382331327335, 'f1-score': 0.7862108051215027, 'support': 100698}, '2': {'precision': 0.28585287432784523, 'recall': 0.7926979246733282, 'f1-score': 0.42018415906127765, 'support': 13010}, 'accuracy': 0.6736113853371137, 'macro avg': {'precision': 0.5364558952011477, 'recall': 0.6700731039019456, 'f1-score': 0.5516364361483584, 'support': 126619}, 'weighted avg': {'precision': 0.8168903332654489, 'recall': 0.6736113853371137, 'f1-score': 0.7141678599758551, 'support': 126619}}
[[ 7004  2322  3585]
 [10543 67975 22180]
 [  774  1923 10313]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.762412
{'0': {'precision': 0.4122448979591837, 'recall': 0.5474778394235061, 'f1-score': 0.4703336437845834, 'support': 15681}, '1': {'precision': 0.9148876693786874, 'recall': 0.6540933427300172, 'f1-score': 0.7628160306186288, 'support': 95069}, '2': {'precision': 0.3245208195637806, 'recall': 0.7735207007372865, 'f1-score': 0.4572205460572876, 'support': 15869}, 'accuracy': 0.6558573357868882, 'macro avg': {'precision': 0.5505511289672173, 'recall': 0.6583639609636033, 'f1-score': 0.5634567401534999, 'support': 126619}, 'weighted avg': {'precision': 0.7786484569513108, 'recall': 0.6558573357868882, 'f1-score': 0.688293952159246, 'support': 126619}}
[[ 8585  3067  4029]
 [11364 62184 21521]
 [  876  2718 12275]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8051842
{'0': {'precision': 0.46142293168554754, 'recall': 0.5238211223694466, 'f1-score': 0.49064610330352254, 'support': 20528}, '1': {'precision': 0.8535701454301201, 'recall': 0.6400276424287856, 'f1-score': 0.7315336059922487, 'support': 85376}, '2': {'precision': 0.3825385515802331, 'recall': 0.7257060101375815, 'f1-score': 0.5009914518520987, 'support': 20715}, 'accuracy': 0.6352048270796642, 'macro avg': {'precision': 0.565843876231967, 'recall': 0.6298515916452713, 'f1-score': 0.57439038704929, 'support': 126619}, 'weighted avg': {'precision': 0.7129323464398502, 'recall': 0.6352048270796642, 'f1-score': 0.6547629840618324, 'support': 126619}}
[[10753  4819  4956]
 [11424 54643 19309]
 [ 1127  4555 15033]]
training model: results/EXC/W10/deepLOB_L1/seq2seq
Epoch 1/50
1060/1060 - 36s - loss: 10.7046 - accuracy10: 0.4262 - accuracy20: 0.4440 - accuracy30: 0.4596 - accuracy50: 0.4801 - val_loss: 10.5762 - val_accuracy10: 0.4643 - val_accuracy20: 0.4696 - val_accuracy30: 0.4728 - val_accuracy50: 0.4807 - 36s/epoch - 34ms/step
Epoch 2/50
1060/1060 - 29s - loss: 10.1191 - accuracy10: 0.5067 - accuracy20: 0.5149 - accuracy30: 0.5204 - accuracy50: 0.5286 - val_loss: 10.3574 - val_accuracy10: 0.5389 - val_accuracy20: 0.5309 - val_accuracy30: 0.5247 - val_accuracy50: 0.5234 - 29s/epoch - 28ms/step
Epoch 3/50
1060/1060 - 29s - loss: 9.5319 - accuracy10: 0.6012 - accuracy20: 0.5861 - accuracy30: 0.5706 - accuracy50: 0.5617 - val_loss: 10.0909 - val_accuracy10: 0.5832 - val_accuracy20: 0.5750 - val_accuracy30: 0.5637 - val_accuracy50: 0.5487 - 29s/epoch - 28ms/step
Epoch 4/50
1060/1060 - 29s - loss: 9.2993 - accuracy10: 0.6320 - accuracy20: 0.6117 - accuracy30: 0.5889 - accuracy50: 0.5705 - val_loss: 9.9570 - val_accuracy10: 0.6405 - val_accuracy20: 0.6204 - val_accuracy30: 0.5948 - val_accuracy50: 0.5656 - 29s/epoch - 27ms/step
Epoch 5/50
1060/1060 - 30s - loss: 9.1370 - accuracy10: 0.6462 - accuracy20: 0.6235 - accuracy30: 0.5983 - accuracy50: 0.5773 - val_loss: 10.2129 - val_accuracy10: 0.6647 - val_accuracy20: 0.6394 - val_accuracy30: 0.6113 - val_accuracy50: 0.5765 - 30s/epoch - 28ms/step
Epoch 6/50
1060/1060 - 30s - loss: 9.0352 - accuracy10: 0.6509 - accuracy20: 0.6272 - accuracy30: 0.6023 - accuracy50: 0.5806 - val_loss: 10.0912 - val_accuracy10: 0.6602 - val_accuracy20: 0.6360 - val_accuracy30: 0.6083 - val_accuracy50: 0.5748 - 30s/epoch - 28ms/step
Epoch 7/50
1060/1060 - 30s - loss: 8.9513 - accuracy10: 0.6538 - accuracy20: 0.6311 - accuracy30: 0.6069 - accuracy50: 0.5848 - val_loss: 10.4978 - val_accuracy10: 0.6864 - val_accuracy20: 0.6589 - val_accuracy30: 0.6280 - val_accuracy50: 0.5892 - 30s/epoch - 28ms/step
Epoch 8/50
1060/1060 - 29s - loss: 8.8685 - accuracy10: 0.6566 - accuracy20: 0.6339 - accuracy30: 0.6098 - accuracy50: 0.5873 - val_loss: 10.1152 - val_accuracy10: 0.6729 - val_accuracy20: 0.6445 - val_accuracy30: 0.6159 - val_accuracy50: 0.5821 - 29s/epoch - 27ms/step
Epoch 9/50
1060/1060 - 29s - loss: 8.8056 - accuracy10: 0.6596 - accuracy20: 0.6367 - accuracy30: 0.6125 - accuracy50: 0.5898 - val_loss: 10.3517 - val_accuracy10: 0.6761 - val_accuracy20: 0.6443 - val_accuracy30: 0.6125 - val_accuracy50: 0.5805 - 29s/epoch - 27ms/step
Epoch 10/50
1060/1060 - 28s - loss: 8.7680 - accuracy10: 0.6610 - accuracy20: 0.6380 - accuracy30: 0.6142 - accuracy50: 0.5908 - val_loss: 10.6201 - val_accuracy10: 0.6824 - val_accuracy20: 0.6479 - val_accuracy30: 0.6175 - val_accuracy50: 0.5835 - 28s/epoch - 27ms/step
Epoch 11/50
1060/1060 - 28s - loss: 8.7238 - accuracy10: 0.6638 - accuracy20: 0.6409 - accuracy30: 0.6160 - accuracy50: 0.5915 - val_loss: 10.6377 - val_accuracy10: 0.6752 - val_accuracy20: 0.6451 - val_accuracy30: 0.6166 - val_accuracy50: 0.5825 - 28s/epoch - 27ms/step
Epoch 12/50
1060/1060 - 28s - loss: 8.6793 - accuracy10: 0.6651 - accuracy20: 0.6421 - accuracy30: 0.6168 - accuracy50: 0.5927 - val_loss: 10.5380 - val_accuracy10: 0.6872 - val_accuracy20: 0.6571 - val_accuracy30: 0.6302 - val_accuracy50: 0.5948 - 28s/epoch - 27ms/step
Epoch 13/50
1060/1060 - 28s - loss: 8.6536 - accuracy10: 0.6648 - accuracy20: 0.6417 - accuracy30: 0.6180 - accuracy50: 0.5938 - val_loss: 10.5491 - val_accuracy10: 0.6877 - val_accuracy20: 0.6578 - val_accuracy30: 0.6305 - val_accuracy50: 0.5952 - 28s/epoch - 27ms/step
Epoch 14/50
1060/1060 - 28s - loss: 8.6153 - accuracy10: 0.6677 - accuracy20: 0.6447 - accuracy30: 0.6200 - accuracy50: 0.5946 - val_loss: 10.4502 - val_accuracy10: 0.6988 - val_accuracy20: 0.6685 - val_accuracy30: 0.6410 - val_accuracy50: 0.6009 - 28s/epoch - 27ms/step
testing model: results/EXC/W10/deepLOB_L1/seq2seq
Evaluating performance on  test set...
5267/5267 - 70s - 70s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8670106
{'0': {'precision': 0.3122739656537121, 'recall': 0.4716917568879759, 'f1-score': 0.37577422393424165, 'support': 151387}, '1': {'precision': 0.8677238714210433, 'recall': 0.590019167448589, 'f1-score': 0.7024197029788003, 'support': 1046566}, '2': {'precision': 0.2528898510148495, 'recall': 0.686599749727096, 'f1-score': 0.3696349768601883, 'support': 150236}, 'accuracy': 0.58749478003455, 'macro avg': {'precision': 0.4776292293632016, 'recall': 0.582770224687887, 'f1-score': 0.4826096345910768, 'support': 1348189}, 'weighted avg': {'precision': 0.7368385884420664, 'recall': 0.58749478003455, 'f1-score': 0.6286569551376042, 'support': 1348189}}
[[ 71408  57093  22886]
 [147217 617494 281855]
 [ 10046  37038 103152]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.91086406
{'0': {'precision': 0.38732364529932634, 'recall': 0.45119609904400915, 'f1-score': 0.4168271981798576, 'support': 202617}, '1': {'precision': 0.8034117860314491, 'recall': 0.5592583952751063, 'f1-score': 0.6594622710100595, 'support': 943090}, '2': {'precision': 0.30777316917945, 'recall': 0.6926195908772138, 'f1-score': 0.4261720696738748, 'support': 202482}, 'accuracy': 0.5630471692025376, 'macro avg': {'precision': 0.49950286683674183, 'recall': 0.5676913617321099, 'f1-score': 0.5008205129545974, 'support': 1348189}, 'weighted avg': {'precision': 0.6664395742509442, 'recall': 0.5630471692025376, 'f1-score': 0.5879596425962463, 'support': 1348189}}
[[ 91420  78853  32344]
 [132576 527431 283083]
 [ 12034  50205 140243]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9458313
{'0': {'precision': 0.4286269726933403, 'recall': 0.43274836886231505, 'f1-score': 0.43067781101892694, 'support': 242009}, '1': {'precision': 0.7439526471770307, 'recall': 0.5277276546429088, 'f1-score': 0.617457681931929, 'support': 862875}, '2': {'precision': 0.341716707302442, 'recall': 0.6906763116253263, 'f1-score': 0.45722051717382783, 'support': 243305}, 'accuracy': 0.5400852551088905, 'macro avg': {'precision': 0.5047654423909377, 'recall': 0.5503841117101834, 'f1-score': 0.5017853367082279, 'support': 1348189}, 'weighted avg': {'precision': 0.6147588423712429, 'recall': 0.5400852551088905, 'f1-score': 0.5550117539861777, 'support': 1348189}}
[[104729  95485  41795]
 [125585 455363 281927]
 [ 14022  61238 168045]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0038865
{'0': {'precision': 0.4796326005464134, 'recall': 0.3947234259495284, 'f1-score': 0.4330552258980528, 'support': 305994}, '1': {'precision': 0.6364016685559145, 'recall': 0.49983843633641784, 'f1-score': 0.5599133731035094, 'support': 733457}, '2': {'precision': 0.3931631488108738, 'recall': 0.6625747397469699, 'f1-score': 0.4934936480442345, 'support': 308738}, 'accuracy': 0.5132477716403264, 'macro avg': {'precision': 0.5030658059710672, 'recall': 0.5190455340109721, 'f1-score': 0.4954874156819322, 'support': 1348189}, 'weighted avg': {'precision': 0.5451181999135033, 'recall': 0.5132477716403264, 'f1-score': 0.5159105478532389, 'support': 1348189}}
[[120783 125106  60105]
 [111216 366610 255631]
 [ 19825  84351 204562]]
Evaluating performance on  train set...
1060/1060 - 14s - 14s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7318814
{'0': {'precision': 0.2625487139516758, 'recall': 0.6125102282025638, 'f1-score': 0.36754957854824194, 'support': 21998}, '1': {'precision': 0.9238528947511657, 'recall': 0.6734915218368912, 'f1-score': 0.7790518883440556, 'support': 226818}, '2': {'precision': 0.2624560375146542, 'recall': 0.638303559495701, 'f1-score': 0.3719674450602941, 'support': 22447}, 'accuracy': 0.6656344580720556, 'macro avg': {'precision': 0.48295254873916527, 'recall': 0.6414351031783854, 'f1-score': 0.5061896373175305, 'support': 271263}, 'weighted avg': {'precision': 0.8154940525072357, 'recall': 0.6656344580720556, 'f1-score': 0.7119950014509706, 'support': 271263}}
[[ 13474   6321   2203]
 [ 35997 152760  38061]
 [  1849   6270  14328]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.76753855
{'0': {'precision': 0.33491455887470467, 'recall': 0.5957904339893132, 'f1-score': 0.42879084545848917, 'support': 30692}, '1': {'precision': 0.8822607997721594, 'recall': 0.6511783450140695, 'f1-score': 0.749308023627523, 'support': 209319}, '2': {'precision': 0.32756956731542547, 'recall': 0.6516382951491104, 'f1-score': 0.4359786773993278, 'support': 31252}, 'accuracy': 0.6449644809649676, 'macro avg': {'precision': 0.5149149753207632, 'recall': 0.6328690247174976, 'f1-score': 0.5380258488284466, 'support': 271263}, 'weighted avg': {'precision': 0.7564258675390036, 'recall': 0.6449644809649676, 'f1-score': 0.6769447379575735, 'support': 271263}}
[[ 18286   9500   2906]
 [ 34116 136304  38899]
 [  2197   8690  20365]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.80381685
{'0': {'precision': 0.37281030604594095, 'recall': 0.5821248968948727, 'f1-score': 0.4545275120238504, 'support': 37583}, '1': {'precision': 0.8397454560578963, 'recall': 0.6198448596983156, 'f1-score': 0.7132301424222979, 'support': 195436}, '2': {'precision': 0.3626703356215512, 'recall': 0.6478924798661228, 'f1-score': 0.46503073241683474, 'support': 38244}, 'accuracy': 0.6185731190763207, 'macro avg': {'precision': 0.5250753659084628, 'recall': 0.616620745486437, 'f1-score': 0.5442627956209943, 'support': 271263}, 'weighted avg': {'precision': 0.7077920210193289, 'recall': 0.6185731190763207, 'f1-score': 0.6423949780448717, 'support': 271263}}
[[ 21878  12148   3557]
 [ 34310 121140  39986]
 [  2496  10970  24778]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8595179
{'0': {'precision': 0.4290963701431493, 'recall': 0.5435851767896537, 'f1-score': 0.47960286068874386, 'support': 49409}, '1': {'precision': 0.752426572545065, 'recall': 0.5910348482995218, 'f1-score': 0.6620366141680911, 'support': 171687}, '2': {'precision': 0.41934697195501963, 'recall': 0.6169792891741583, 'f1-score': 0.4993184219653645, 'support': 50167}, 'accuracy': 0.5871902913408759, 'macro avg': {'precision': 0.533623304881078, 'recall': 0.5838664380877779, 'f1-score': 0.5469859656073999, 'support': 271263}, 'weighted avg': {'precision': 0.6319345544914525, 'recall': 0.5871902913408759, 'f1-score': 0.59871447707643, 'support': 271263}}
[[ 26858  17556   4995]
 [ 32351 101473  37863]
 [  3383  15832  30952]]
Evaluating performance on  val set...
404/404 - 5s - 5s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7642731
{'0': {'precision': 0.2604678177306088, 'recall': 0.6170878158618964, 'f1-score': 0.3663164148071139, 'support': 7994}, '1': {'precision': 0.9295533502884024, 'recall': 0.6400114449213161, 'f1-score': 0.758076104491168, 'support': 87375}, '2': {'precision': 0.22284844495639294, 'recall': 0.6740077143212642, 'f1-score': 0.33495130622971087, 'support': 8037}, 'accuracy': 0.6408815736030792, 'macro avg': {'precision': 0.47095653765846807, 'recall': 0.6437023250348256, 'f1-score': 0.4864479418426643, 'support': 103406}, 'weighted avg': {'precision': 0.8229013468125852, 'recall': 0.6408815736030792, 'f1-score': 0.6949039388241693, 'support': 103406}}
[[ 4933  2307   754]
 [13317 55921 18137]
 [  689  1931  5417]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.798034
{'0': {'precision': 0.3359264497878359, 'recall': 0.5968407826243044, 'f1-score': 0.4298920421488137, 'support': 11142}, '1': {'precision': 0.8895412123699566, 'recall': 0.6146912301469862, 'f1-score': 0.7270062347321982, 'support': 81096}, '2': {'precision': 0.2778644227630481, 'recall': 0.6859777936962751, 'f1-score': 0.39551872789695136, 'support': 11168}, 'accuracy': 0.6204668974721003, 'macro avg': {'precision': 0.5011106949736136, 'recall': 0.632503268822522, 'f1-score': 0.5174723349259878, 'support': 103406}, 'weighted avg': {'precision': 0.7638272105613582, 'recall': 0.6204668974721002, 'f1-score': 0.6591910324218864, 'support': 103406}}
[[ 6650  3480  1012]
 [12349 49849 18898]
 [  797  2710  7661]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.83299226
{'0': {'precision': 0.3718396023514792, 'recall': 0.572016763473274, 'f1-score': 0.4507009616498668, 'support': 13601}, '1': {'precision': 0.8482235253535702, 'recall': 0.5819429653295468, 'f1-score': 0.6902940557232086, 'support': 76059}, '2': {'precision': 0.3105178046929144, 'recall': 0.6844900334642805, 'f1-score': 0.42722546370921965, 'support': 13746}, 'accuracy': 0.5942691913428622, 'macro avg': {'precision': 0.5101936441326546, 'recall': 0.6128165874223671, 'f1-score': 0.522740160360765, 'support': 103406}, 'weighted avg': {'precision': 0.714086235709325, 'recall': 0.5942691913428622, 'f1-score': 0.623810036050116, 'support': 103406}}
[[ 7780  4478  1343]
 [12248 44262 19549]
 [  895  3442  9409]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.88440055
{'0': {'precision': 0.418928133096959, 'recall': 0.5175492783736733, 'f1-score': 0.46304577199417174, 'support': 17807}, '1': {'precision': 0.764025555167526, 'recall': 0.5519984564465619, 'f1-score': 0.6409319638795064, 'support': 67377}, '2': {'precision': 0.3668112930823759, 'recall': 0.6588190099879266, 'f1-score': 0.4712463199214916, 'support': 18222}, 'accuracy': 0.5648898516527088, 'macro avg': {'precision': 0.5165883271156203, 'recall': 0.5761222482693872, 'f1-score': 0.5250746852650565, 'support': 103406}, 'weighted avg': {'precision': 0.63460184591926, 'recall': 0.5648898516527088, 'f1-score': 0.580397456954327, 'support': 103406}}
[[ 9216  6490  2101]
 [11563 37192 18622]
 [ 1220  4997 12005]]
training model: results/EXC/W10/deepOF_L1/seq2seq
Epoch 1/50
1060/1060 - 37s - loss: 11.6443 - accuracy10: 0.4295 - accuracy20: 0.4372 - accuracy30: 0.4386 - accuracy50: 0.4454 - val_loss: 11.1007 - val_accuracy10: 0.5997 - val_accuracy20: 0.5880 - val_accuracy30: 0.5711 - val_accuracy50: 0.5446 - 37s/epoch - 35ms/step
Epoch 2/50
1060/1060 - 27s - loss: 11.1379 - accuracy10: 0.4734 - accuracy20: 0.4664 - accuracy30: 0.4604 - accuracy50: 0.4644 - val_loss: 10.8550 - val_accuracy10: 0.6217 - val_accuracy20: 0.6020 - val_accuracy30: 0.5836 - val_accuracy50: 0.5599 - 27s/epoch - 26ms/step
Epoch 3/50
1060/1060 - 27s - loss: 10.9383 - accuracy10: 0.4968 - accuracy20: 0.4879 - accuracy30: 0.4822 - accuracy50: 0.4839 - val_loss: 10.7464 - val_accuracy10: 0.5902 - val_accuracy20: 0.5645 - val_accuracy30: 0.5471 - val_accuracy50: 0.5322 - 27s/epoch - 26ms/step
Epoch 4/50
1060/1060 - 28s - loss: 10.7986 - accuracy10: 0.5118 - accuracy20: 0.5000 - accuracy30: 0.4940 - accuracy50: 0.4959 - val_loss: 10.6860 - val_accuracy10: 0.5884 - val_accuracy20: 0.5664 - val_accuracy30: 0.5532 - val_accuracy50: 0.5409 - 28s/epoch - 26ms/step
Epoch 5/50
1060/1060 - 27s - loss: 10.6958 - accuracy10: 0.5244 - accuracy20: 0.5104 - accuracy30: 0.5039 - accuracy50: 0.5042 - val_loss: 10.6356 - val_accuracy10: 0.5858 - val_accuracy20: 0.5623 - val_accuracy30: 0.5495 - val_accuracy50: 0.5378 - 27s/epoch - 26ms/step
Epoch 6/50
1060/1060 - 27s - loss: 10.6100 - accuracy10: 0.5354 - accuracy20: 0.5183 - accuracy30: 0.5091 - accuracy50: 0.5082 - val_loss: 10.5417 - val_accuracy10: 0.5822 - val_accuracy20: 0.5595 - val_accuracy30: 0.5472 - val_accuracy50: 0.5369 - 27s/epoch - 25ms/step
Epoch 7/50
1060/1060 - 27s - loss: 10.5242 - accuracy10: 0.5445 - accuracy20: 0.5274 - accuracy30: 0.5177 - accuracy50: 0.5149 - val_loss: 10.5082 - val_accuracy10: 0.5778 - val_accuracy20: 0.5534 - val_accuracy30: 0.5419 - val_accuracy50: 0.5320 - 27s/epoch - 25ms/step
Epoch 8/50
1060/1060 - 27s - loss: 10.4435 - accuracy10: 0.5495 - accuracy20: 0.5321 - accuracy30: 0.5219 - accuracy50: 0.5184 - val_loss: 10.4282 - val_accuracy10: 0.5898 - val_accuracy20: 0.5659 - val_accuracy30: 0.5532 - val_accuracy50: 0.5417 - 27s/epoch - 25ms/step
Epoch 9/50
1060/1060 - 28s - loss: 10.3710 - accuracy10: 0.5573 - accuracy20: 0.5385 - accuracy30: 0.5277 - accuracy50: 0.5220 - val_loss: 10.4209 - val_accuracy10: 0.5923 - val_accuracy20: 0.5650 - val_accuracy30: 0.5511 - val_accuracy50: 0.5377 - 28s/epoch - 26ms/step
Epoch 10/50
1060/1060 - 27s - loss: 10.2984 - accuracy10: 0.5603 - accuracy20: 0.5425 - accuracy30: 0.5305 - accuracy50: 0.5245 - val_loss: 10.3814 - val_accuracy10: 0.5969 - val_accuracy20: 0.5687 - val_accuracy30: 0.5532 - val_accuracy50: 0.5398 - 27s/epoch - 25ms/step
Epoch 11/50
1060/1060 - 27s - loss: 10.2416 - accuracy10: 0.5640 - accuracy20: 0.5449 - accuracy30: 0.5318 - accuracy50: 0.5249 - val_loss: 10.3564 - val_accuracy10: 0.5918 - val_accuracy20: 0.5637 - val_accuracy30: 0.5476 - val_accuracy50: 0.5352 - 27s/epoch - 25ms/step
Epoch 12/50
1060/1060 - 27s - loss: 10.1829 - accuracy10: 0.5641 - accuracy20: 0.5460 - accuracy30: 0.5334 - accuracy50: 0.5262 - val_loss: 10.3553 - val_accuracy10: 0.5976 - val_accuracy20: 0.5683 - val_accuracy30: 0.5524 - val_accuracy50: 0.5397 - 27s/epoch - 25ms/step
Epoch 13/50
1060/1060 - 26s - loss: 10.1284 - accuracy10: 0.5678 - accuracy20: 0.5493 - accuracy30: 0.5351 - accuracy50: 0.5275 - val_loss: 10.3732 - val_accuracy10: 0.5925 - val_accuracy20: 0.5656 - val_accuracy30: 0.5508 - val_accuracy50: 0.5383 - 26s/epoch - 25ms/step
Epoch 14/50
1060/1060 - 27s - loss: 10.0626 - accuracy10: 0.5697 - accuracy20: 0.5517 - accuracy30: 0.5388 - accuracy50: 0.5310 - val_loss: 10.3700 - val_accuracy10: 0.5975 - val_accuracy20: 0.5669 - val_accuracy30: 0.5512 - val_accuracy50: 0.5371 - 27s/epoch - 25ms/step
Epoch 15/50
1060/1060 - 26s - loss: 10.0188 - accuracy10: 0.5715 - accuracy20: 0.5533 - accuracy30: 0.5394 - accuracy50: 0.5302 - val_loss: 10.4152 - val_accuracy10: 0.6104 - val_accuracy20: 0.5809 - val_accuracy30: 0.5653 - val_accuracy50: 0.5497 - 26s/epoch - 25ms/step
Epoch 16/50
1060/1060 - 27s - loss: 9.9580 - accuracy10: 0.5744 - accuracy20: 0.5573 - accuracy30: 0.5433 - accuracy50: 0.5336 - val_loss: 10.3904 - val_accuracy10: 0.6049 - val_accuracy20: 0.5786 - val_accuracy30: 0.5638 - val_accuracy50: 0.5482 - 27s/epoch - 26ms/step
Epoch 17/50
1060/1060 - 27s - loss: 9.9088 - accuracy10: 0.5767 - accuracy20: 0.5594 - accuracy30: 0.5451 - accuracy50: 0.5359 - val_loss: 10.4050 - val_accuracy10: 0.6118 - val_accuracy20: 0.5848 - val_accuracy30: 0.5687 - val_accuracy50: 0.5512 - 27s/epoch - 25ms/step
Epoch 18/50
1060/1060 - 27s - loss: 9.8653 - accuracy10: 0.5793 - accuracy20: 0.5622 - accuracy30: 0.5476 - accuracy50: 0.5377 - val_loss: 10.3657 - val_accuracy10: 0.6172 - val_accuracy20: 0.5900 - val_accuracy30: 0.5723 - val_accuracy50: 0.5552 - 27s/epoch - 25ms/step
Epoch 19/50
1060/1060 - 26s - loss: 9.8167 - accuracy10: 0.5803 - accuracy20: 0.5647 - accuracy30: 0.5501 - accuracy50: 0.5390 - val_loss: 10.4467 - val_accuracy10: 0.6136 - val_accuracy20: 0.5889 - val_accuracy30: 0.5718 - val_accuracy50: 0.5531 - 26s/epoch - 25ms/step
Epoch 20/50
1060/1060 - 26s - loss: 9.7791 - accuracy10: 0.5827 - accuracy20: 0.5663 - accuracy30: 0.5496 - accuracy50: 0.5379 - val_loss: 10.5161 - val_accuracy10: 0.6193 - val_accuracy20: 0.5901 - val_accuracy30: 0.5708 - val_accuracy50: 0.5510 - 26s/epoch - 25ms/step
Epoch 21/50
1060/1060 - 27s - loss: 9.7271 - accuracy10: 0.5836 - accuracy20: 0.5679 - accuracy30: 0.5529 - accuracy50: 0.5409 - val_loss: 10.4089 - val_accuracy10: 0.6135 - val_accuracy20: 0.5890 - val_accuracy30: 0.5731 - val_accuracy50: 0.5536 - 27s/epoch - 26ms/step
Epoch 22/50
1060/1060 - 27s - loss: 9.6733 - accuracy10: 0.5862 - accuracy20: 0.5713 - accuracy30: 0.5553 - accuracy50: 0.5428 - val_loss: 10.5054 - val_accuracy10: 0.6091 - val_accuracy20: 0.5823 - val_accuracy30: 0.5631 - val_accuracy50: 0.5446 - 27s/epoch - 25ms/step
testing model: results/EXC/W10/deepOF_L1/seq2seq
Evaluating performance on  test set...
5267/5267 - 68s - 68s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.88569105
{'0': {'precision': 0.25126457541384717, 'recall': 0.544033133843288, 'f1-score': 0.3437612174537319, 'support': 151386}, '1': {'precision': 0.8575576112992483, 'recall': 0.5952312474260986, 'f1-score': 0.7027106294871412, 'support': 1046563}, '2': {'precision': 0.2367255583599219, 'recall': 0.46323426631610476, 'f1-score': 0.3133305269224102, 'support': 150235}, 'accuracy': 0.5747731763616836, 'macro avg': {'precision': 0.4485159150243392, 'recall': 0.5341662158618304, 'f1-score': 0.4532674579544278, 'support': 1348184}, 'weighted avg': {'precision': 0.7202952042362013, 'recall': 0.5747731763616836, 'f1-score': 0.6190140158209785, 'support': 1348184}}
[[ 82359  51828  17199]
 [216423 622947 207193]
 [ 28996  51645  69594]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.92208177
{'0': {'precision': 0.3060436830928634, 'recall': 0.5533817664942552, 'f1-score': 0.3941214309064259, 'support': 202616}, '1': {'precision': 0.7967995993465246, 'recall': 0.5600871179708384, 'f1-score': 0.6577957990194309, 'support': 943089}, '2': {'precision': 0.30128786049589057, 'recall': 0.47452328389610776, 'f1-score': 0.368564195020906, 'support': 202479}, 'accuracy': 0.5462288530348973, 'macro avg': {'precision': 0.4680437143117595, 'recall': 0.5293307227870672, 'f1-score': 0.47349380831558757, 'support': 1348184}, 'weighted avg': {'precision': 0.6486256690088337, 'recall': 0.5462288530348973, 'f1-score': 0.5747300070239748, 'support': 1348184}}
[[112124  67166  23326]
 [215383 528212 199494]
 [ 38859  67539  96081]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.94783956
{'0': {'precision': 0.3417180801274261, 'recall': 0.5460773699825624, 'f1-score': 0.4203772624614308, 'support': 242006}, '1': {'precision': 0.7398647679802186, 'recall': 0.5381833985223816, 'f1-score': 0.6231109995927643, 'support': 862875}, '2': {'precision': 0.34427241242944623, 'recall': 0.47230819184309275, 'f1-score': 0.3982526152721148, 'support': 243303}, 'accuracy': 0.5277120927113806, 'macro avg': {'precision': 0.475285086845697, 'recall': 0.5188563201160122, 'f1-score': 0.4805802924421034, 'support': 1348184}, 'weighted avg': {'precision': 0.5970039313117279, 'recall': 0.5277120927113806, 'f1-score': 0.5461396809385061, 'support': 1348184}}
[[132154  81517  28335]
 [207951 464385 190539]
 [ 46629  81760 114914]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9874611
{'0': {'precision': 0.3938653219228759, 'recall': 0.5097388803555671, 'f1-score': 0.44437258636383714, 'support': 305990}, '1': {'precision': 0.63451390281673, 'recall': 0.5262353484935041, 'f1-score': 0.5753243336505806, 'support': 733457}, '2': {'precision': 0.4021152789207832, 'recall': 0.4478860648383576, 'f1-score': 0.4237683415668632, 'support': 308737}, 'accuracy': 0.5045490823211075, 'macro avg': {'precision': 0.4768315012201297, 'recall': 0.4946200978958096, 'f1-score': 0.48115508719376027, 'support': 1348184}, 'weighted avg': {'precision': 0.5266754228959822, 'recall': 0.5045490823211075, 'f1-score': 0.5108962826722117, 'support': 1348184}}
[[155975 112030  37985]
 [179871 385971 167615]
 [ 60165 110293 138279]]
Evaluating performance on  train set...
1060/1060 - 15s - 15s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.79522705
{'0': {'precision': 0.22302394227615613, 'recall': 0.6504805721313716, 'f1-score': 0.33216254564908937, 'support': 21953}, '1': {'precision': 0.925322380361066, 'recall': 0.640213598392725, 'f1-score': 0.7568065874485355, 'support': 226968}, '2': {'precision': 0.2502689350173314, 'recall': 0.5623293496262477, 'f1-score': 0.3463791891258496, 'support': 22341}, 'accuracy': 0.634629988719393, 'macro avg': {'precision': 0.4662050858848512, 'recall': 0.6176745067167814, 'f1-score': 0.47844944074115814, 'support': 271262}, 'weighted avg': {'precision': 0.8128889151735262, 'recall': 0.634629988719393, 'f1-score': 0.6886379196824998, 'support': 271262}}
[[ 14280   5541   2132]
 [ 46157 145308  35503]
 [  3592   6186  12563]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.82696974
{'0': {'precision': 0.2773776902634152, 'recall': 0.6575056304468453, 'f1-score': 0.39016075924849897, 'support': 30637}, '1': {'precision': 0.8830995557294141, 'recall': 0.6035596465179343, 'f1-score': 0.7170483388398111, 'support': 209459}, '2': {'precision': 0.31732242308454844, 'recall': 0.5649104793685427, 'f1-score': 0.4063751457027779, 'support': 31166}, 'accuracy': 0.6052119353245202, 'macro avg': {'precision': 0.49259988969245927, 'recall': 0.6086585854444407, 'f1-score': 0.504528081263696, 'support': 271262}, 'weighted avg': {'precision': 0.7496842196031166, 'recall': 0.6052119353245202, 'f1-score': 0.6444347935837569, 'support': 271262}}
[[ 20144   7861   2632]
 [ 47793 126421  35245]
 [  4686   8874  17606]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.85297036
{'0': {'precision': 0.31617876051074434, 'recall': 0.6488775265638731, 'f1-score': 0.42517995026828953, 'support': 37551}, '1': {'precision': 0.840400436410816, 'recall': 0.5829425811631035, 'f1-score': 0.6883866974623735, 'support': 195563}, '2': {'precision': 0.36115191473371366, 'recall': 0.5542623466498899, 'f1-score': 0.43733840776056426, 'support': 38148}, 'accuracy': 0.5880366582860851, 'macro avg': {'precision': 0.5059103705517579, 'recall': 0.5953608181256221, 'f1-score': 0.516968351830409, 'support': 271262}, 'weighted avg': {'precision': 0.7004345703600544, 'recall': 0.5880366582860851, 'f1-score': 0.6166454778317961, 'support': 271262}}
[[ 24366  10167   3018]
 [ 47177 114002  34384]
 [  5521  11483  21144]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8874728
{'0': {'precision': 0.37700314938719753, 'recall': 0.6029411764705882, 'f1-score': 0.4639257893057533, 'support': 49436}, '1': {'precision': 0.75112312495241, 'recall': 0.5743622887153779, 'f1-score': 0.6509566875744448, 'support': 171747}, '2': {'precision': 0.42336821699058635, 'recall': 0.5145869526148685, 'f1-score': 0.46454194757904604, 'support': 50079}, 'accuracy': 0.5685352168751981, 'macro avg': {'precision': 0.5171648304433979, 'recall': 0.5639634726002781, 'f1-score': 0.5264748081530813, 'support': 271262}, 'weighted avg': {'precision': 0.622433396395288, 'recall': 0.5685352168751981, 'f1-score': 0.5824564064770532, 'support': 271262}}
[[29807 15619  4010]
 [42013 98645 31089]
 [ 7243 17066 25770]]
Evaluating performance on  val set...
404/404 - 5s - 5s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.83460826
{'0': {'precision': 0.2215671195419978, 'recall': 0.6471983027580183, 'f1-score': 0.3301187179732009, 'support': 8013}, '1': {'precision': 0.9265948514568484, 'recall': 0.5936795357514851, 'f1-score': 0.7236856792052684, 'support': 87367}, '2': {'precision': 0.19302335262040546, 'recall': 0.5777473212060802, 'f1-score': 0.28936940310150083, 'support': 8026}, 'accuracy': 0.5965901398371468, 'macro avg': {'precision': 0.44706177453975054, 'recall': 0.6062083865718612, 'f1-score': 0.4477246000933233, 'support': 103406}, 'weighted avg': {'precision': 0.8150246131196631, 'recall': 0.5965901398371468, 'f1-score': 0.6594778528474033, 'support': 103406}}
[[ 5186  2003   824]
 [16937 51868 18562]
 [ 1283  2106  4637]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8643986
{'0': {'precision': 0.2741511375328684, 'recall': 0.6456650511577814, 'f1-score': 0.3848808281839339, 'support': 11142}, '1': {'precision': 0.886007702182285, 'recall': 0.5531676160883825, 'f1-score': 0.6810994633246544, 'support': 81102}, '2': {'precision': 0.2498303807010931, 'recall': 0.5938003941945887, 'f1-score': 0.3516926668789133, 'support': 11162}, 'accuracy': 0.5675202599462313, 'macro avg': {'precision': 0.4699964068054155, 'recall': 0.5975443538135843, 'f1-score': 0.4725576527958339, 'support': 103406}, 'weighted avg': {'precision': 0.7514089641429366, 'recall': 0.5675202599462313, 'f1-score': 0.6136245905448808, 'support': 103406}}
[[ 7194  2862  1086]
 [17423 44863 18816]
 [ 1624  2910  6628]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.88690335
{'0': {'precision': 0.31063922150273127, 'recall': 0.6314899249889689, 'f1-score': 0.4164302514488009, 'support': 13598}, '1': {'precision': 0.8453897149549323, 'recall': 0.5314541892904566, 'f1-score': 0.6526315789473686, 'support': 76063}, '2': {'precision': 0.2895584341229514, 'recall': 0.5887231720625682, 'f1-score': 0.38818929745028896, 'support': 13745}, 'accuracy': 0.552221341121405, 'macro avg': {'precision': 0.48186245686020496, 'recall': 0.5838890954473311, 'f1-score': 0.4857503759488195, 'support': 103406}, 'weighted avg': {'precision': 0.7011868818021306, 'recall': 0.552221341121405, 'f1-score': 0.5864204808437491, 'support': 103406}}
[[ 8587  3693  1318]
 [17103 40424 18536]
 [ 1953  3700  8092]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.91293806
{'0': {'precision': 0.3649508590822315, 'recall': 0.5796181920269512, 'f1-score': 0.4478913571676502, 'support': 17810}, '1': {'precision': 0.760665251851531, 'recall': 0.5212810162649887, 'f1-score': 0.618622426515912, 'support': 67384}, '2': {'precision': 0.35467486697532996, 'recall': 0.5636393586646168, 'f1-score': 0.43538194002629677, 'support': 18212}, 'accuracy': 0.5387888517107324, 'macro avg': {'precision': 0.4934303259696975, 'recall': 0.5548461889855189, 'f1-score': 0.5006319079032864, 'support': 103406}, 'weighted avg': {'precision': 0.6210063324021122, 'recall': 0.5387888517107324, 'f1-score': 0.5569442252022415, 'support': 103406}}
[[10323  5639  1848]
 [15429 35126 16829]
 [ 2534  5413 10265]]
training model: results/EXC/W10/deepLOB_L2/seq2seq
Epoch 1/50
1060/1060 - 64s - loss: 10.6019 - accuracy10: 0.4681 - accuracy20: 0.4786 - accuracy30: 0.4831 - accuracy50: 0.4922 - val_loss: 10.1004 - val_accuracy10: 0.5585 - val_accuracy20: 0.5614 - val_accuracy30: 0.5590 - val_accuracy50: 0.5528 - 64s/epoch - 60ms/step
Epoch 2/50
1060/1060 - 55s - loss: 9.9095 - accuracy10: 0.5434 - accuracy20: 0.5450 - accuracy30: 0.5399 - accuracy50: 0.5364 - val_loss: 9.7208 - val_accuracy10: 0.6324 - val_accuracy20: 0.6216 - val_accuracy30: 0.6066 - val_accuracy50: 0.5851 - 55s/epoch - 52ms/step
Epoch 3/50
1060/1060 - 55s - loss: 9.3637 - accuracy10: 0.6187 - accuracy20: 0.6049 - accuracy30: 0.5894 - accuracy50: 0.5746 - val_loss: 9.5266 - val_accuracy10: 0.6581 - val_accuracy20: 0.6412 - val_accuracy30: 0.6212 - val_accuracy50: 0.5963 - 55s/epoch - 52ms/step
Epoch 4/50
1060/1060 - 55s - loss: 8.9176 - accuracy10: 0.6737 - accuracy20: 0.6462 - accuracy30: 0.6187 - accuracy50: 0.5943 - val_loss: 9.3450 - val_accuracy10: 0.6627 - val_accuracy20: 0.6357 - val_accuracy30: 0.6107 - val_accuracy50: 0.5834 - 55s/epoch - 52ms/step
Epoch 5/50
1060/1060 - 55s - loss: 8.6937 - accuracy10: 0.6823 - accuracy20: 0.6528 - accuracy30: 0.6257 - accuracy50: 0.6018 - val_loss: 9.2154 - val_accuracy10: 0.6497 - val_accuracy20: 0.6217 - val_accuracy30: 0.5981 - val_accuracy50: 0.5747 - 55s/epoch - 52ms/step
Epoch 6/50
1060/1060 - 55s - loss: 8.5612 - accuracy10: 0.6838 - accuracy20: 0.6561 - accuracy30: 0.6292 - accuracy50: 0.6046 - val_loss: 9.0435 - val_accuracy10: 0.6363 - val_accuracy20: 0.6108 - val_accuracy30: 0.5845 - val_accuracy50: 0.5633 - 55s/epoch - 52ms/step
Epoch 7/50
1060/1060 - 55s - loss: 8.4621 - accuracy10: 0.6851 - accuracy20: 0.6584 - accuracy30: 0.6310 - accuracy50: 0.6065 - val_loss: 8.8861 - val_accuracy10: 0.6494 - val_accuracy20: 0.6281 - val_accuracy30: 0.6080 - val_accuracy50: 0.5867 - 55s/epoch - 52ms/step
Epoch 8/50
1060/1060 - 55s - loss: 8.3867 - accuracy10: 0.6886 - accuracy20: 0.6607 - accuracy30: 0.6337 - accuracy50: 0.6085 - val_loss: 8.9698 - val_accuracy10: 0.6683 - val_accuracy20: 0.6409 - val_accuracy30: 0.6133 - val_accuracy50: 0.5865 - 55s/epoch - 52ms/step
Epoch 9/50
1060/1060 - 55s - loss: 8.3211 - accuracy10: 0.6898 - accuracy20: 0.6636 - accuracy30: 0.6360 - accuracy50: 0.6107 - val_loss: 9.0601 - val_accuracy10: 0.6691 - val_accuracy20: 0.6413 - val_accuracy30: 0.6152 - val_accuracy50: 0.5893 - 55s/epoch - 52ms/step
Epoch 10/50
1060/1060 - 55s - loss: 8.2584 - accuracy10: 0.6890 - accuracy20: 0.6642 - accuracy30: 0.6375 - accuracy50: 0.6115 - val_loss: 8.9960 - val_accuracy10: 0.6784 - val_accuracy20: 0.6519 - val_accuracy30: 0.6249 - val_accuracy50: 0.5969 - 55s/epoch - 52ms/step
Epoch 11/50
1060/1060 - 55s - loss: 8.2125 - accuracy10: 0.6895 - accuracy20: 0.6654 - accuracy30: 0.6385 - accuracy50: 0.6128 - val_loss: 8.9983 - val_accuracy10: 0.6608 - val_accuracy20: 0.6364 - val_accuracy30: 0.6134 - val_accuracy50: 0.5893 - 55s/epoch - 52ms/step
Epoch 12/50
1060/1060 - 55s - loss: 8.1632 - accuracy10: 0.6895 - accuracy20: 0.6652 - accuracy30: 0.6392 - accuracy50: 0.6141 - val_loss: 8.9781 - val_accuracy10: 0.6665 - val_accuracy20: 0.6447 - val_accuracy30: 0.6210 - val_accuracy50: 0.5943 - 55s/epoch - 52ms/step
Epoch 13/50
1060/1060 - 55s - loss: 8.1220 - accuracy10: 0.6897 - accuracy20: 0.6658 - accuracy30: 0.6409 - accuracy50: 0.6159 - val_loss: 8.9688 - val_accuracy10: 0.6509 - val_accuracy20: 0.6298 - val_accuracy30: 0.6083 - val_accuracy50: 0.5859 - 55s/epoch - 52ms/step
Epoch 14/50
1060/1060 - 55s - loss: 8.0762 - accuracy10: 0.6908 - accuracy20: 0.6675 - accuracy30: 0.6416 - accuracy50: 0.6166 - val_loss: 8.9887 - val_accuracy10: 0.6454 - val_accuracy20: 0.6225 - val_accuracy30: 0.6007 - val_accuracy50: 0.5784 - 55s/epoch - 52ms/step
Epoch 15/50
1060/1060 - 55s - loss: 8.0265 - accuracy10: 0.6917 - accuracy20: 0.6687 - accuracy30: 0.6427 - accuracy50: 0.6178 - val_loss: 9.0585 - val_accuracy10: 0.6493 - val_accuracy20: 0.6285 - val_accuracy30: 0.6073 - val_accuracy50: 0.5836 - 55s/epoch - 52ms/step
Epoch 16/50
1060/1060 - 56s - loss: 7.9905 - accuracy10: 0.6927 - accuracy20: 0.6699 - accuracy30: 0.6439 - accuracy50: 0.6194 - val_loss: 9.1442 - val_accuracy10: 0.6486 - val_accuracy20: 0.6296 - val_accuracy30: 0.6072 - val_accuracy50: 0.5857 - 56s/epoch - 53ms/step
Epoch 17/50
1060/1060 - 55s - loss: 7.9380 - accuracy10: 0.6918 - accuracy20: 0.6701 - accuracy30: 0.6448 - accuracy50: 0.6216 - val_loss: 9.2646 - val_accuracy10: 0.6258 - val_accuracy20: 0.6104 - val_accuracy30: 0.5927 - val_accuracy50: 0.5743 - 55s/epoch - 52ms/step
testing model: results/EXC/W10/deepLOB_L2/seq2seq
Evaluating performance on  test set...
5267/5267 - 109s - 109s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8812735
{'0': {'precision': 0.3066850887448188, 'recall': 0.6671378652063915, 'f1-score': 0.4202021210646097, 'support': 151387}, '1': {'precision': 0.917441726768279, 'recall': 0.556564038961709, 'f1-score': 0.6928264255591708, 'support': 1046566}, '2': {'precision': 0.26633105628722553, 'recall': 0.680695705423467, 'f1-score': 0.38286226654911054, 'support': 150236}, 'accuracy': 0.5828129438824972, 'macro avg': {'precision': 0.4968192906001077, 'recall': 0.6347992031971892, 'f1-score': 0.4986302710576304, 'support': 1348189}, 'weighted avg': {'precision': 0.7763035941690297, 'recall': 0.5828129438824972, 'f1-score': 0.627672688970641, 'support': 1348189}}
[[100996  26809  23582]
 [205955 582481 258130]
 [ 22364  25607 102265]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9117024
{'0': {'precision': 0.3709638038554452, 'recall': 0.6373798842150461, 'f1-score': 0.4689767370921002, 'support': 202617}, '1': {'precision': 0.8626280027465664, 'recall': 0.5235194944278913, 'f1-score': 0.651593826483512, 'support': 943090}, '2': {'precision': 0.322952394980676, 'recall': 0.6821791566657777, 'f1-score': 0.438373249929783, 'support': 202482}, 'accuracy': 0.5644601758358806, 'macro avg': {'precision': 0.5188480671942292, 'recall': 0.6143595117695716, 'f1-score': 0.5196479378351317, 'support': 1348189}, 'weighted avg': {'precision': 0.7076837616955155, 'recall': 0.5644601758358806, 'f1-score': 0.5921254169482228, 'support': 1348189}}
[[129144  42710  30763]
 [190549 493726 258815]
 [ 28438  35915 138129]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9433659
{'0': {'precision': 0.4078980469127953, 'recall': 0.6096922015296952, 'f1-score': 0.4887866380452643, 'support': 242009}, '1': {'precision': 0.8074583695834668, 'recall': 0.49047428654208314, 'f1-score': 0.6102590390415072, 'support': 862875}, '2': {'precision': 0.3573233142555557, 'recall': 0.6789708390703028, 'f1-score': 0.46823020224680884, 'support': 243305}, 'accuracy': 0.545892304417259, 'macro avg': {'precision': 0.5242265769172726, 'recall': 0.593045775714027, 'f1-score': 0.5224252931111935, 'support': 1348189}, 'weighted avg': {'precision': 0.6544996199083368, 'recall': 0.545892304417259, 'f1-score': 0.5628222624255923, 'support': 1348189}}
[[147551  56293  38165]
 [180701 423218 258956]
 [ 33483  44625 165197]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9848272
{'0': {'precision': 0.4557281440049247, 'recall': 0.5612953195160689, 'f1-score': 0.5030327880855799, 'support': 305994}, '1': {'precision': 0.7031253238704436, 'recall': 0.4624947338426111, 'f1-score': 0.5579721408697897, 'support': 733457}, '2': {'precision': 0.409021267543115, 'recall': 0.6476591802758326, 'f1-score': 0.5013935469311251, 'support': 308738}, 'accuracy': 0.5273222077913409, 'macro avg': {'precision': 0.5226249118061611, 'recall': 0.5571497445448376, 'f1-score': 0.5207994919621649, 'support': 1348189}, 'weighted avg': {'precision': 0.5796239818492904, 'recall': 0.5273222077913409, 'f1-score': 0.5325461254882023, 'support': 1348189}}
[[171753  79910  54331]
 [159658 339220 234579]
 [ 45465  63316 199957]]
Evaluating performance on  train set...
1060/1060 - 23s - 23s/epoch - 22ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7036612
{'0': {'precision': 0.273160692848568, 'recall': 0.7240658241658332, 'f1-score': 0.3966728096827215, 'support': 21998}, '1': {'precision': 0.9498961643355769, 'recall': 0.6695147651420963, 'f1-score': 0.7854331421359966, 'support': 226818}, '2': {'precision': 0.28687953282471507, 'recall': 0.6784425535706331, 'f1-score': 0.4032463062013451, 'support': 22447}, 'accuracy': 0.6746773426527024, 'macro avg': {'precision': 0.5033121300029534, 'recall': 0.6906743809595209, 'f1-score': 0.5284507526733544, 'support': 271263}, 'weighted avg': {'precision': 0.8401518894831438, 'recall': 0.6746773426527024, 'f1-score': 0.7222807855686347, 'support': 271263}}
[[ 15928   3540   2530]
 [ 39634 151858  35326]
 [  2748   4470  15229]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7339435
{'0': {'precision': 0.3430237163543036, 'recall': 0.7054607063729962, 'f1-score': 0.4615991387121188, 'support': 30692}, '1': {'precision': 0.9149617060431382, 'recall': 0.6460713074302858, 'f1-score': 0.7573581091108665, 'support': 209319}, '2': {'precision': 0.35191753124067754, 'recall': 0.6794445155510047, 'f1-score': 0.46367507369800204, 'support': 31252}, 'accuracy': 0.6566358110026064, 'macro avg': {'precision': 0.5366343178793731, 'recall': 0.6769921764514288, 'f1-score': 0.5608774405069957, 'support': 271263}, 'weighted avg': {'precision': 0.7853820091052728, 'recall': 0.6566358110026064, 'f1-score': 0.6900595223437763, 'support': 271263}}
[[ 21652   5982   3058]
 [ 38038 135235  36046]
 [  3431   6587  21234]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.77080315
{'0': {'precision': 0.3849127557160048, 'recall': 0.6808663491472208, 'f1-score': 0.49179823760606545, 'support': 37583}, '1': {'precision': 0.8762334041231454, 'recall': 0.6206840090873739, 'f1-score': 0.726645381191707, 'support': 195436}, '2': {'precision': 0.386042655814304, 'recall': 0.6696998221943311, 'f1-score': 0.4897646980083948, 'support': 38244}, 'accuracy': 0.6359326557621201, 'macro avg': {'precision': 0.5490629385511514, 'recall': 0.6570833934763086, 'f1-score': 0.5694027722687224, 'support': 271263}, 'weighted avg': {'precision': 0.7390522960936358, 'recall': 0.6359326557621201, 'f1-score': 0.6607111216537613, 'support': 271263}}
[[ 25589   8487   3507]
 [ 36906 121304  37226]
 [  3985   8647  25612]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8220208
{'0': {'precision': 0.4416379039849388, 'recall': 0.6267076848347467, 'f1-score': 0.5181429515658075, 'support': 49409}, '1': {'precision': 0.7936255286428296, 'recall': 0.6011579211006075, 'f1-score': 0.6841123229832603, 'support': 171687}, '2': {'precision': 0.444957031744469, 'recall': 0.6306137500747503, 'f1-score': 0.5217620767568816, 'support': 50167}, 'accuracy': 0.6112591838916476, 'macro avg': {'precision': 0.5600734881240791, 'recall': 0.6194931186700349, 'f1-score': 0.5746724504353165, 'support': 271263}, 'weighted avg': {'precision': 0.6650307367595952, 'recall': 0.6112591838916476, 'f1-score': 0.6238571260901947, 'support': 271263}}
[[ 30965  13717   4727]
 [ 33740 103211  34736]
 [  5409  13122  31636]]
Evaluating performance on  val set...
404/404 - 8s - 8s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.73785615
{'0': {'precision': 0.26176677204074467, 'recall': 0.7458093570177633, 'f1-score': 0.3875203119922002, 'support': 7994}, '1': {'precision': 0.9569687279729056, 'recall': 0.6370701001430615, 'f1-score': 0.7649200917948084, 'support': 87375}, '2': {'precision': 0.24573743489293504, 'recall': 0.68682344158268, 'f1-score': 0.3619672131147541, 'support': 8037}, 'accuracy': 0.649343364988492, 'macro avg': {'precision': 0.48815764496886177, 'recall': 0.6899009662478349, 'f1-score': 0.5048025389672542, 'support': 103406}, 'weighted avg': {'precision': 0.8479459407245311, 'recall': 0.649343364988492, 'f1-score': 0.7044258639386527, 'support': 103406}}
[[ 5962  1124   908]
 [15676 55664 16035]
 [ 1138  1379  5520]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.77120054
{'0': {'precision': 0.3305278640300703, 'recall': 0.7260814934482139, 'f1-score': 0.45426469762479643, 'support': 11142}, '1': {'precision': 0.9252081727787071, 'recall': 0.606959652757226, 'f1-score': 0.7330320111394893, 'support': 81096}, '2': {'precision': 0.3020715923665902, 'recall': 0.6959169054441261, 'f1-score': 0.42128086294278666, 'support': 11168}, 'accuracy': 0.6294025491750962, 'macro avg': {'precision': 0.5192692097251226, 'recall': 0.6763193505498553, 'f1-score': 0.5361925239023575, 'support': 103406}, 'weighted avg': {'precision': 0.793831682728615, 'recall': 0.6294025491750962, 'f1-score': 0.6693252414139272, 'support': 103406}}
[[ 8090  1960  1092]
 [15009 49222 16865]
 [ 1377  2019  7772]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.80843675
{'0': {'precision': 0.36878409976617305, 'recall': 0.6957576648775825, 'f1-score': 0.4820559843101296, 'support': 13601}, '1': {'precision': 0.8895956567539097, 'recall': 0.5773675699128308, 'f1-score': 0.7002543393157554, 'support': 76059}, '2': {'precision': 0.33507152420548236, 'recall': 0.691837625491052, 'f1-score': 0.45148120015191795, 'support': 13746}, 'accuracy': 0.6081561998336653, 'macro avg': {'precision': 0.5311504269085217, 'recall': 0.6549876200938217, 'f1-score': 0.5445971745926009, 'support': 103406}, 'weighted avg': {'precision': 0.747379086026864, 'recall': 0.6081561998336653, 'f1-score': 0.6384846992815444, 'support': 103406}}
[[ 9463  2831  1307]
 [14580 43914 17565]
 [ 1617  2619  9510]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8527363
{'0': {'precision': 0.41743221217958215, 'recall': 0.6328410175773572, 'f1-score': 0.5030466709818538, 'support': 17807}, '1': {'precision': 0.8117020119630234, 'recall': 0.5538685308042804, 'f1-score': 0.6584444914955184, 'support': 67377}, '2': {'precision': 0.39287005092820765, 'recall': 0.6561848315223356, 'f1-score': 0.49148118461886264, 'support': 18222}, 'accuracy': 0.5854979401582113, 'macro avg': {'precision': 0.5406680916902711, 'recall': 0.6142981266346578, 'f1-score': 0.5509907823654117, 'support': 103406}, 'weighted avg': {'precision': 0.6700011598004781, 'recall': 0.5854979401582113, 'f1-score': 0.6022623128231662, 'support': 103406}}
[[11269  4611  1927]
 [13508 37318 16551]
 [ 2219  4046 11957]]
training model: results/EXC/W10/deepOF_L2/seq2seq
Epoch 1/50
1060/1060 - 43s - loss: 10.3073 - accuracy10: 0.5373 - accuracy20: 0.5376 - accuracy30: 0.5308 - accuracy50: 0.5238 - val_loss: 9.5428 - val_accuracy10: 0.6684 - val_accuracy20: 0.6609 - val_accuracy30: 0.6440 - val_accuracy50: 0.6122 - 43s/epoch - 40ms/step
Epoch 2/50
1060/1060 - 36s - loss: 9.1749 - accuracy10: 0.6297 - accuracy20: 0.6176 - accuracy30: 0.5983 - accuracy50: 0.5774 - val_loss: 9.0974 - val_accuracy10: 0.6782 - val_accuracy20: 0.6720 - val_accuracy30: 0.6576 - val_accuracy50: 0.6265 - 36s/epoch - 34ms/step
Epoch 3/50
1060/1060 - 36s - loss: 8.8868 - accuracy10: 0.6456 - accuracy20: 0.6334 - accuracy30: 0.6152 - accuracy50: 0.5905 - val_loss: 8.9676 - val_accuracy10: 0.6758 - val_accuracy20: 0.6620 - val_accuracy30: 0.6440 - val_accuracy50: 0.6152 - 36s/epoch - 34ms/step
Epoch 4/50
1060/1060 - 35s - loss: 8.7340 - accuracy10: 0.6500 - accuracy20: 0.6374 - accuracy30: 0.6200 - accuracy50: 0.5974 - val_loss: 8.8801 - val_accuracy10: 0.6711 - val_accuracy20: 0.6563 - val_accuracy30: 0.6393 - val_accuracy50: 0.6120 - 35s/epoch - 33ms/step
Epoch 5/50
1060/1060 - 35s - loss: 8.6361 - accuracy10: 0.6546 - accuracy20: 0.6407 - accuracy30: 0.6234 - accuracy50: 0.6001 - val_loss: 8.8895 - val_accuracy10: 0.6848 - val_accuracy20: 0.6705 - val_accuracy30: 0.6509 - val_accuracy50: 0.6191 - 35s/epoch - 33ms/step
Epoch 6/50
1060/1060 - 35s - loss: 8.5694 - accuracy10: 0.6565 - accuracy20: 0.6430 - accuracy30: 0.6252 - accuracy50: 0.6027 - val_loss: 8.9113 - val_accuracy10: 0.6850 - val_accuracy20: 0.6685 - val_accuracy30: 0.6476 - val_accuracy50: 0.6169 - 35s/epoch - 33ms/step
Epoch 7/50
1060/1060 - 35s - loss: 8.4995 - accuracy10: 0.6598 - accuracy20: 0.6450 - accuracy30: 0.6278 - accuracy50: 0.6037 - val_loss: 8.9182 - val_accuracy10: 0.6806 - val_accuracy20: 0.6645 - val_accuracy30: 0.6447 - val_accuracy50: 0.6131 - 35s/epoch - 33ms/step
Epoch 8/50
1060/1060 - 36s - loss: 8.4613 - accuracy10: 0.6608 - accuracy20: 0.6477 - accuracy30: 0.6287 - accuracy50: 0.6049 - val_loss: 8.9382 - val_accuracy10: 0.6713 - val_accuracy20: 0.6554 - val_accuracy30: 0.6380 - val_accuracy50: 0.6091 - 36s/epoch - 34ms/step
Epoch 9/50
1060/1060 - 36s - loss: 8.4096 - accuracy10: 0.6621 - accuracy20: 0.6480 - accuracy30: 0.6295 - accuracy50: 0.6047 - val_loss: 8.9861 - val_accuracy10: 0.6759 - val_accuracy20: 0.6587 - val_accuracy30: 0.6398 - val_accuracy50: 0.6102 - 36s/epoch - 34ms/step
Epoch 10/50
1060/1060 - 36s - loss: 8.3618 - accuracy10: 0.6648 - accuracy20: 0.6509 - accuracy30: 0.6319 - accuracy50: 0.6061 - val_loss: 8.9249 - val_accuracy10: 0.6714 - val_accuracy20: 0.6543 - val_accuracy30: 0.6356 - val_accuracy50: 0.6058 - 36s/epoch - 34ms/step
Epoch 11/50
1060/1060 - 36s - loss: 8.3198 - accuracy10: 0.6638 - accuracy20: 0.6494 - accuracy30: 0.6315 - accuracy50: 0.6070 - val_loss: 9.0308 - val_accuracy10: 0.6867 - val_accuracy20: 0.6698 - val_accuracy30: 0.6488 - val_accuracy50: 0.6155 - 36s/epoch - 34ms/step
Epoch 12/50
1060/1060 - 35s - loss: 8.3417 - accuracy10: 0.6632 - accuracy20: 0.6496 - accuracy30: 0.6313 - accuracy50: 0.6055 - val_loss: 9.0337 - val_accuracy10: 0.6851 - val_accuracy20: 0.6666 - val_accuracy30: 0.6469 - val_accuracy50: 0.6137 - 35s/epoch - 33ms/step
Epoch 13/50
1060/1060 - 36s - loss: 8.2656 - accuracy10: 0.6654 - accuracy20: 0.6516 - accuracy30: 0.6337 - accuracy50: 0.6083 - val_loss: 9.0622 - val_accuracy10: 0.6821 - val_accuracy20: 0.6634 - val_accuracy30: 0.6420 - val_accuracy50: 0.6099 - 36s/epoch - 34ms/step
Epoch 14/50
1060/1060 - 36s - loss: 8.2128 - accuracy10: 0.6681 - accuracy20: 0.6543 - accuracy30: 0.6354 - accuracy50: 0.6105 - val_loss: 9.1628 - val_accuracy10: 0.6862 - val_accuracy20: 0.6661 - val_accuracy30: 0.6433 - val_accuracy50: 0.6090 - 36s/epoch - 34ms/step
testing model: results/EXC/W10/deepOF_L2/seq2seq
Evaluating performance on  test set...
5267/5267 - 81s - 81s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.79628474
{'0': {'precision': 0.35572106727778685, 'recall': 0.5741878377128664, 'f1-score': 0.4392918690271032, 'support': 151386}, '1': {'precision': 0.9075919289340786, 'recall': 0.6434357033451402, 'f1-score': 0.7530195323289286, 'support': 1046563}, '2': {'precision': 0.2758708358089343, 'recall': 0.6644789829267481, 'f1-score': 0.3898769771528998, 'support': 150235}, 'accuracy': 0.6380049014081164, 'macro avg': {'precision': 0.5130612773402666, 'recall': 0.6273675079949182, 'f1-score': 0.5273961261696439, 'support': 1348184}, 'weighted avg': {'precision': 0.7752271028507284, 'recall': 0.6380049014081164, 'f1-score': 0.6773245991347349, 'support': 1348184}}
[[ 86924  36691  27771]
 [138901 673396 234266]
 [ 18535  31872  99828]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8196019
{'0': {'precision': 0.4264305596136989, 'recall': 0.5474296205630355, 'f1-score': 0.47941321392449926, 'support': 202616}, '1': {'precision': 0.8480299068393998, 'recall': 0.6330876513245304, 'f1-score': 0.7249623893993353, 'support': 943089}, '2': {'precision': 0.3402400377060749, 'recall': 0.6453014880555514, 'f1-score': 0.4455568778964096, 'support': 202479}, 'accuracy': 0.6220486224432273, 'macro avg': {'precision': 0.5382335013863911, 'recall': 0.6086062533143725, 'f1-score': 0.5499774937400814, 'support': 1348184}, 'weighted avg': {'precision': 0.708405376174647, 'recall': 0.6220486224432273, 'f1-score': 0.6460963441847279, 'support': 1348184}}
[[110918  57452  34246]
 [126914 597058 219117]
 [ 22276  49543 130660]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.85673803
{'0': {'precision': 0.4642450554398398, 'recall': 0.5240448583919407, 'f1-score': 0.4923357628812951, 'support': 242006}, '1': {'precision': 0.7909173624491543, 'recall': 0.6165319426336375, 'f1-score': 0.6929213239474594, 'support': 862875}, '2': {'precision': 0.37966504382662203, 'recall': 0.6279001902976946, 'f1-score': 0.47320361043482567, 'support': 243303}, 'accuracy': 0.6019816286204257, 'macro avg': {'precision': 0.5449424872385388, 'recall': 0.589492330441091, 'f1-score': 0.5528202324211934, 'support': 1348184}, 'weighted avg': {'precision': 0.6580604369791042, 'recall': 0.6019816286204257, 'f1-score': 0.6172633365049868, 'support': 1348184}}
[[126822  75570  39614]
 [120888 531990 209997]
 [ 25469  65064 152770]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.92022926
{'0': {'precision': 0.5060421655729604, 'recall': 0.47857773129840847, 'f1-score': 0.491926909685189, 'support': 305990}, '1': {'precision': 0.6831705438828604, 'recall': 0.5963008056368676, 'f1-score': 0.6367866632693918, 'support': 733457}, '2': {'precision': 0.431057218208921, 'recall': 0.5844586168810346, 'f1-score': 0.49617169293801433, 'support': 308737}, 'accuracy': 0.5668699524693959, 'macro avg': {'precision': 0.5400899758882473, 'recall': 0.5531123846054369, 'f1-score': 0.5416284219641984, 'support': 1348184}, 'weighted avg': {'precision': 0.5852341907532866, 'recall': 0.5668699524693959, 'f1-score': 0.5717075048648798, 'support': 1348184}}
[[146440 108222  51328]
 [109260 437361 186836]
 [ 33683  94610 180444]]
Evaluating performance on  train set...
1060/1060 - 16s - 16s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.69065195
{'0': {'precision': 0.2930426221438241, 'recall': 0.6507994351569262, 'f1-score': 0.40411840411840416, 'support': 21953}, '1': {'precision': 0.9475225389419455, 'recall': 0.6871717598956681, 'f1-score': 0.7966146711205092, 'support': 226968}, '2': {'precision': 0.27134567560099476, 'recall': 0.7032809632514212, 'f1-score': 0.39160072278646646, 'support': 22341}, 'accuracy': 0.685554924759089, 'macro avg': {'precision': 0.5039702788955881, 'recall': 0.6804173861013384, 'f1-score': 0.5307779326751266, 'support': 271262}, 'weighted avg': {'precision': 0.8388664613587625, 'recall': 0.685554924759089, 'f1-score': 0.7314935440580085, 'support': 271262}}
[[ 14287   4514   3152]
 [ 31962 155966  39040]
 [  2505   4124  15712]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7065978
{'0': {'precision': 0.3686224977992115, 'recall': 0.628716910924699, 'f1-score': 0.46475491911063926, 'support': 30637}, '1': {'precision': 0.9079527307569467, 'recall': 0.6786053595214337, 'f1-score': 0.7767022122406826, 'support': 209459}, '2': {'precision': 0.3438310544686029, 'recall': 0.6890521722389784, 'f1-score': 0.4587498931897804, 'support': 31166}, 'accuracy': 0.674171096578216, 'macro avg': {'precision': 0.5401354276749204, 'recall': 0.6654581475617037, 'f1-score': 0.5667356748470341, 'support': 271262}, 'weighted avg': {'precision': 0.7822260292273234, 'recall': 0.674171096578216, 'f1-score': 0.704939742026773, 'support': 271262}}
[[ 19262   7582   3793]
 [ 30129 142140  37190]
 [  2863   6828  21475]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7418911
{'0': {'precision': 0.4148876148876149, 'recall': 0.6070677212324572, 'f1-score': 0.4929078014184397, 'support': 37551}, '1': {'precision': 0.8670815233323561, 'recall': 0.6654735302690181, 'f1-score': 0.7530167363411493, 'support': 195563}, '2': {'precision': 0.386077765194413, 'recall': 0.6702317290552585, 'f1-score': 0.4899351364816571, 'support': 38148}, 'accuracy': 0.6580575237224529, 'macro avg': {'precision': 0.5560156344714613, 'recall': 0.6475909935189113, 'f1-score': 0.5786198914137487, 'support': 271262}, 'weighted avg': {'precision': 0.7368396729388077, 'recall': 0.6580575237224529, 'f1-score': 0.6800120859045877, 'support': 271262}}
[[ 22796  10497   4258]
 [ 29022 130142  36399]
 [  3127   9453  25568]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.80020034
{'0': {'precision': 0.47065968658044205, 'recall': 0.5564972894247108, 'f1-score': 0.5099918433931484, 'support': 49436}, '1': {'precision': 0.7790412595081269, 'recall': 0.6494029007784706, 'f1-score': 0.7083394196510793, 'support': 171747}, '2': {'precision': 0.4463765202532918, 'recall': 0.620759200463268, 'f1-score': 0.5193197574380649, 'support': 50079}, 'accuracy': 0.6271833135492624, 'macro avg': {'precision': 0.5653591554472869, 'recall': 0.6088864635554831, 'f1-score': 0.5792170068274309, 'support': 271262}, 'weighted avg': {'precision': 0.6614255635522026, 'recall': 0.6271833135492624, 'f1-score': 0.6372958291597733, 'support': 271262}}
[[ 27511  16546   5379]
 [ 27037 111533  33177]
 [  3904  15088  31087]]
Evaluating performance on  val set...
404/404 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7084133
{'0': {'precision': 0.2977910646072081, 'recall': 0.6712841632347435, 'f1-score': 0.412563276576162, 'support': 8013}, '1': {'precision': 0.9510360880959745, 'recall': 0.6687307564641112, 'f1-score': 0.7852822580645162, 'support': 87367}, '2': {'precision': 0.23479715600167295, 'recall': 0.6994767007226513, 'f1-score': 0.35157815631262523, 'support': 8026}, 'accuracy': 0.6713150107343868, 'macro avg': {'precision': 0.4945414362349519, 'recall': 0.679830540140502, 'f1-score': 0.5164745636511011, 'support': 103406}, 'weighted avg': {'precision': 0.8448238176067926, 'recall': 0.6713150107343868, 'f1-score': 0.7227374703411069, 'support': 103406}}
[[ 5379  1551  1083]
 [11729 58425 17213]
 [  955  1457  5614]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7295464
{'0': {'precision': 0.3707697069748246, 'recall': 0.6450367977023873, 'f1-score': 0.4708772849374303, 'support': 11142}, '1': {'precision': 0.9134731053445609, 'recall': 0.6554092377499938, 'f1-score': 0.7632168394451941, 'support': 81102}, '2': {'precision': 0.2981186125735522, 'recall': 0.6899301200501702, 'f1-score': 0.41633778450559555, 'support': 11162}, 'accuracy': 0.6580179099858809, 'macro avg': {'precision': 0.5274538082976459, 'recall': 0.6634587185008504, 'f1-score': 0.5501439696294067, 'support': 103406}, 'weighted avg': {'precision': 0.7885733112035479, 'recall': 0.6580179099858809, 'f1-score': 0.6942739219398144, 'support': 103406}}
[[ 7187  2632  1323]
 [11139 53155 16808]
 [ 1058  2403  7701]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.76488215
{'0': {'precision': 0.40973274050911224, 'recall': 0.6167083394616856, 'f1-score': 0.4923528548363424, 'support': 13598}, '1': {'precision': 0.8737255467089383, 'recall': 0.6376819215650185, 'f1-score': 0.7372717116213321, 'support': 76063}, '2': {'precision': 0.33877848678213307, 'recall': 0.6759548926882503, 'f1-score': 0.45134806898226865, 'support': 13745}, 'accuracy': 0.6400112179177224, 'macro avg': {'precision': 0.5407455913333946, 'recall': 0.6434483845716515, 'f1-score': 0.5603242118133144, 'support': 103406}, 'weighted avg': {'precision': 0.741603411461475, 'recall': 0.6400112179177224, 'f1-score': 0.6670588895158815, 'support': 103406}}
[[ 8386  3698  1514]
 [10939 48504 16620]
 [ 1142  3312  9291]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.81839114
{'0': {'precision': 0.45755779217794934, 'recall': 0.5590117911285795, 'f1-score': 0.5032222194141879, 'support': 17810}, '1': {'precision': 0.7911611621084509, 'recall': 0.6203401400926036, 'f1-score': 0.695414202413928, 'support': 67384}, '2': {'precision': 0.4006663890045814, 'recall': 0.6338677794860531, 'f1-score': 0.4909833276624701, 'support': 18212}, 'accuracy': 0.6121598359863064, 'macro avg': {'precision': 0.5497951144303272, 'recall': 0.6044065702357454, 'f1-score': 0.5632065831635287, 'support': 103406}, 'weighted avg': {'precision': 0.6649289625626807, 'recall': 0.6121598359863064, 'f1-score': 0.6263076292150912, 'support': 103406}}
[[ 9956  5835  2019]
 [10334 41801 15249]
 [ 1469  5199 11544]]
training model: results/EXC/W10/deepVOL_L2/seq2seq
Epoch 1/50
1060/1060 - 43s - loss: 9.9213 - accuracy10: 0.5773 - accuracy20: 0.5760 - accuracy30: 0.5623 - accuracy50: 0.5468 - val_loss: 9.3294 - val_accuracy10: 0.6706 - val_accuracy20: 0.6605 - val_accuracy30: 0.6379 - val_accuracy50: 0.6033 - 43s/epoch - 41ms/step
Epoch 2/50
1060/1060 - 36s - loss: 9.1513 - accuracy10: 0.6535 - accuracy20: 0.6405 - accuracy30: 0.6148 - accuracy50: 0.5849 - val_loss: 9.1396 - val_accuracy10: 0.6417 - val_accuracy20: 0.6325 - val_accuracy30: 0.6098 - val_accuracy50: 0.5778 - 36s/epoch - 34ms/step
Epoch 3/50
1060/1060 - 36s - loss: 8.9427 - accuracy10: 0.6639 - accuracy20: 0.6496 - accuracy30: 0.6231 - accuracy50: 0.5934 - val_loss: 9.0196 - val_accuracy10: 0.6632 - val_accuracy20: 0.6530 - val_accuracy30: 0.6303 - val_accuracy50: 0.5957 - 36s/epoch - 34ms/step
Epoch 4/50
1060/1060 - 35s - loss: 8.8201 - accuracy10: 0.6731 - accuracy20: 0.6552 - accuracy30: 0.6278 - accuracy50: 0.5975 - val_loss: 8.9739 - val_accuracy10: 0.6910 - val_accuracy20: 0.6760 - val_accuracy30: 0.6500 - val_accuracy50: 0.6136 - 35s/epoch - 33ms/step
Epoch 5/50
1060/1060 - 35s - loss: 8.7279 - accuracy10: 0.6743 - accuracy20: 0.6548 - accuracy30: 0.6275 - accuracy50: 0.5986 - val_loss: 8.8606 - val_accuracy10: 0.6920 - val_accuracy20: 0.6715 - val_accuracy30: 0.6422 - val_accuracy50: 0.6048 - 35s/epoch - 33ms/step
Epoch 6/50
1060/1060 - 35s - loss: 8.6460 - accuracy10: 0.6777 - accuracy20: 0.6583 - accuracy30: 0.6312 - accuracy50: 0.6006 - val_loss: 8.8086 - val_accuracy10: 0.7030 - val_accuracy20: 0.6851 - val_accuracy30: 0.6585 - val_accuracy50: 0.6171 - 35s/epoch - 33ms/step
Epoch 7/50
1060/1060 - 35s - loss: 8.5957 - accuracy10: 0.6787 - accuracy20: 0.6585 - accuracy30: 0.6311 - accuracy50: 0.6023 - val_loss: 8.7685 - val_accuracy10: 0.6881 - val_accuracy20: 0.6682 - val_accuracy30: 0.6413 - val_accuracy50: 0.6042 - 35s/epoch - 33ms/step
Epoch 8/50
1060/1060 - 35s - loss: 8.5397 - accuracy10: 0.6805 - accuracy20: 0.6612 - accuracy30: 0.6337 - accuracy50: 0.6042 - val_loss: 8.7977 - val_accuracy10: 0.6925 - val_accuracy20: 0.6711 - val_accuracy30: 0.6432 - val_accuracy50: 0.6045 - 35s/epoch - 33ms/step
Epoch 9/50
1060/1060 - 35s - loss: 8.5097 - accuracy10: 0.6824 - accuracy20: 0.6595 - accuracy30: 0.6316 - accuracy50: 0.6025 - val_loss: 8.7553 - val_accuracy10: 0.7021 - val_accuracy20: 0.6796 - val_accuracy30: 0.6497 - val_accuracy50: 0.6089 - 35s/epoch - 33ms/step
Epoch 10/50
1060/1060 - 34s - loss: 8.4686 - accuracy10: 0.6828 - accuracy20: 0.6608 - accuracy30: 0.6325 - accuracy50: 0.6034 - val_loss: 8.8675 - val_accuracy10: 0.6978 - val_accuracy20: 0.6719 - val_accuracy30: 0.6432 - val_accuracy50: 0.6046 - 34s/epoch - 32ms/step
Epoch 11/50
1060/1060 - 35s - loss: 8.4358 - accuracy10: 0.6827 - accuracy20: 0.6603 - accuracy30: 0.6333 - accuracy50: 0.6045 - val_loss: 8.7276 - val_accuracy10: 0.6934 - val_accuracy20: 0.6704 - val_accuracy30: 0.6437 - val_accuracy50: 0.6060 - 35s/epoch - 33ms/step
Epoch 12/50
1060/1060 - 35s - loss: 8.4095 - accuracy10: 0.6834 - accuracy20: 0.6596 - accuracy30: 0.6320 - accuracy50: 0.6030 - val_loss: 8.8437 - val_accuracy10: 0.6869 - val_accuracy20: 0.6617 - val_accuracy30: 0.6329 - val_accuracy50: 0.5951 - 35s/epoch - 33ms/step
Epoch 13/50
1060/1060 - 34s - loss: 8.3791 - accuracy10: 0.6845 - accuracy20: 0.6609 - accuracy30: 0.6334 - accuracy50: 0.6062 - val_loss: 8.8067 - val_accuracy10: 0.7155 - val_accuracy20: 0.6856 - val_accuracy30: 0.6546 - val_accuracy50: 0.6124 - 34s/epoch - 32ms/step
Epoch 14/50
1060/1060 - 35s - loss: 8.3453 - accuracy10: 0.6871 - accuracy20: 0.6614 - accuracy30: 0.6341 - accuracy50: 0.6055 - val_loss: 8.9237 - val_accuracy10: 0.7025 - val_accuracy20: 0.6757 - val_accuracy30: 0.6456 - val_accuracy50: 0.6065 - 35s/epoch - 33ms/step
Epoch 15/50
1060/1060 - 34s - loss: 8.3165 - accuracy10: 0.6859 - accuracy20: 0.6612 - accuracy30: 0.6338 - accuracy50: 0.6067 - val_loss: 8.8555 - val_accuracy10: 0.6964 - val_accuracy20: 0.6669 - val_accuracy30: 0.6359 - val_accuracy50: 0.5966 - 34s/epoch - 32ms/step
Epoch 16/50
1060/1060 - 35s - loss: 8.2778 - accuracy10: 0.6877 - accuracy20: 0.6627 - accuracy30: 0.6351 - accuracy50: 0.6072 - val_loss: 8.9283 - val_accuracy10: 0.7107 - val_accuracy20: 0.6802 - val_accuracy30: 0.6495 - val_accuracy50: 0.6088 - 35s/epoch - 33ms/step
Epoch 17/50
1060/1060 - 35s - loss: 8.2573 - accuracy10: 0.6885 - accuracy20: 0.6625 - accuracy30: 0.6352 - accuracy50: 0.6073 - val_loss: 8.8951 - val_accuracy10: 0.7015 - val_accuracy20: 0.6728 - val_accuracy30: 0.6440 - val_accuracy50: 0.6041 - 35s/epoch - 33ms/step
Epoch 18/50
1060/1060 - 35s - loss: 8.2402 - accuracy10: 0.6873 - accuracy20: 0.6620 - accuracy30: 0.6361 - accuracy50: 0.6086 - val_loss: 9.0412 - val_accuracy10: 0.7028 - val_accuracy20: 0.6773 - val_accuracy30: 0.6513 - val_accuracy50: 0.6136 - 35s/epoch - 33ms/step
Epoch 19/50
1060/1060 - 35s - loss: 8.2101 - accuracy10: 0.6877 - accuracy20: 0.6628 - accuracy30: 0.6368 - accuracy50: 0.6099 - val_loss: 8.9438 - val_accuracy10: 0.7140 - val_accuracy20: 0.6826 - val_accuracy30: 0.6539 - val_accuracy50: 0.6136 - 35s/epoch - 33ms/step
Epoch 20/50
1060/1060 - 35s - loss: 8.1710 - accuracy10: 0.6874 - accuracy20: 0.6622 - accuracy30: 0.6361 - accuracy50: 0.6089 - val_loss: 8.9704 - val_accuracy10: 0.7149 - val_accuracy20: 0.6866 - val_accuracy30: 0.6593 - val_accuracy50: 0.6192 - 35s/epoch - 33ms/step
Epoch 21/50
1060/1060 - 35s - loss: 8.1497 - accuracy10: 0.6888 - accuracy20: 0.6632 - accuracy30: 0.6386 - accuracy50: 0.6108 - val_loss: 8.9859 - val_accuracy10: 0.6977 - val_accuracy20: 0.6698 - val_accuracy30: 0.6412 - val_accuracy50: 0.6047 - 35s/epoch - 33ms/step
testing model: results/EXC/W10/deepVOL_L2/seq2seq
Evaluating performance on  test set...
5267/5267 - 71s - 71s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7567563
{'0': {'precision': 0.35893765965329644, 'recall': 0.6079584112242135, 'f1-score': 0.4513808171612695, 'support': 151387}, '1': {'precision': 0.911442464306493, 'recall': 0.6571281696519856, 'f1-score': 0.7636691715964833, 'support': 1046566}, '2': {'precision': 0.29624138186670623, 'recall': 0.6649538060118747, 'f1-score': 0.40987894416168685, 'support': 150236}, 'accuracy': 0.6524789921887807, 'macro avg': {'precision': 0.5222071686088319, 'recall': 0.6433467956293579, 'f1-score': 0.5416429776398132, 'support': 1348189}, 'weighted avg': {'precision': 0.780846980525319, 'recall': 0.6524789921887807, 'f1-score': 0.68917781636233, 'support': 1348189}}
[[ 92037  37042  22308]
 [143821 687728 215017]
 [ 20557  29779  99900]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7897785
{'0': {'precision': 0.41991086713341697, 'recall': 0.5798822408781099, 'f1-score': 0.48709848597913863, 'support': 202617}, '1': {'precision': 0.8523089160624834, 'recall': 0.6339723674304679, 'f1-score': 0.727103687975347, 'support': 943090}, '2': {'precision': 0.3583884824631219, 'recall': 0.6493762408510386, 'f1-score': 0.4618716256327214, 'support': 202482}, 'accuracy': 0.6281567347011435, 'macro avg': {'precision': 0.5435360885530074, 'recall': 0.6210769497198722, 'f1-score': 0.558691266529069, 'support': 1348189}, 'weighted avg': {'precision': 0.7131435670528663, 'recall': 0.6281567347011435, 'f1-score': 0.6511990095807558, 'support': 1348189}}
[[117494  57238  27885]
 [137685 597893 207512]
 [ 24628  46367 131487]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.83354765
{'0': {'precision': 0.45171912117007085, 'recall': 0.5555247945324348, 'f1-score': 0.4982728970854211, 'support': 242009}, '1': {'precision': 0.7958871798786306, 'recall': 0.6041732580037665, 'f1-score': 0.6869042756439818, 'support': 862875}, '2': {'precision': 0.393289191259566, 'recall': 0.6393703376420542, 'f1-score': 0.48700938880418754, 'support': 243305}, 'accuracy': 0.6017924786509903, 'macro avg': {'precision': 0.5469651641027558, 'recall': 0.5996894633927519, 'f1-score': 0.5573955205111968, 'support': 1348189}, 'weighted avg': {'precision': 0.661450634749601, 'recall': 0.6017924786509903, 'f1-score': 0.6169690390145961, 'support': 1348189}}
[[134442  73630  33937]
 [135507 521326 206042]
 [ 27674  60069 155562]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.90818727
{'0': {'precision': 0.492926609391475, 'recall': 0.5056994581593103, 'f1-score': 0.49923134871281155, 'support': 305994}, '1': {'precision': 0.6890748016939209, 'recall': 0.5717063167983945, 'f1-score': 0.6249275327760498, 'support': 733457}, '2': {'precision': 0.4409576804459091, 'recall': 0.6080624995951259, 'f1-score': 0.5112005173763572, 'support': 308738}, 'accuracy': 0.5650505975052459, 'macro avg': {'precision': 0.5409863638437683, 'recall': 0.561822758184277, 'f1-score': 0.5451197996217395, 'support': 1348189}, 'weighted avg': {'precision': 0.5877363738212241, 'recall': 0.5650505975052459, 'f1-score': 0.5703549695622002, 'support': 1348189}}
[[154741 103327  47926]
 [124056 419322 190079]
 [ 35126  85880 187732]]
Evaluating performance on  train set...
1060/1060 - 15s - 15s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.67608213
{'0': {'precision': 0.3019931107261613, 'recall': 0.6894717701609238, 'f1-score': 0.4200163387380402, 'support': 21998}, '1': {'precision': 0.9514391536953206, 'recall': 0.693119593683041, 'f1-score': 0.801991562386814, 'support': 226818}, '2': {'precision': 0.285176689843022, 'recall': 0.7089588809194992, 'f1-score': 0.4067424058478486, 'support': 22447}, 'accuracy': 0.6941344746611222, 'macro avg': {'precision': 0.5128696514215013, 'recall': 0.6971834149211547, 'f1-score': 0.5429167689909009, 'support': 271263}, 'weighted avg': {'precision': 0.8436393152384426, 'recall': 0.6941344746611222, 'f1-score': 0.7383085360004072, 'support': 271263}}
[[ 15167   4224   2607]
 [ 32323 157212  37283]
 [  2733   3800  15914]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6963522
{'0': {'precision': 0.37003767024051, 'recall': 0.6657109344454581, 'f1-score': 0.47567164874051315, 'support': 30692}, '1': {'precision': 0.9125838611382472, 'recall': 0.6738948685976907, 'f1-score': 0.7752837395916348, 'support': 209319}, '2': {'precision': 0.35353633938447526, 'recall': 0.6954434916165365, 'f1-score': 0.46876887240100085, 'support': 31252}, 'accuracy': 0.6754514990986608, 'macro avg': {'precision': 0.5453859569210775, 'recall': 0.6783497648865618, 'f1-score': 0.573241420244383, 'support': 271263}, 'weighted avg': {'precision': 0.7867901449260022, 'recall': 0.6754514990986608, 'f1-score': 0.706070846857114, 'support': 271263}}
[[ 20432   7153   3107]
 [ 31625 141059  36635]
 [  3159   6359  21734]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.73384756
{'0': {'precision': 0.4076204656199242, 'recall': 0.641034510283905, 'f1-score': 0.4983503469959767, 'support': 37583}, '1': {'precision': 0.871792577501239, 'recall': 0.6480945168750896, 'f1-score': 0.7434815275707024, 'support': 195436}, '2': {'precision': 0.39034858159740393, 'recall': 0.6825384374019454, 'f1-score': 0.4966560433810588, 'support': 38244}, 'accuracy': 0.6519724400305239, 'macro avg': {'precision': 0.5565872082395223, 'recall': 0.65722248818698, 'f1-score': 0.5794959726492459, 'support': 271263}, 'weighted avg': {'precision': 0.7396060107369485, 'recall': 0.6519724400305239, 'f1-score': 0.6747203659788573, 'support': 271263}}
[[ 24092   9894   3597]
 [ 31604 126661  37171]
 [  3408   8733  26103]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7953044
{'0': {'precision': 0.46062246278755076, 'recall': 0.5856018134347993, 'f1-score': 0.5156472768748217, 'support': 49409}, '1': {'precision': 0.7860662851763045, 'recall': 0.622481608974471, 'f1-score': 0.6947748216288254, 'support': 171687}, '2': {'precision': 0.4469995861498138, 'recall': 0.6459026850319931, 'f1-score': 0.5283514189976928, 'support': 50167}, 'accuracy': 0.6200956267533722, 'macro avg': {'precision': 0.5645627780378897, 'recall': 0.6179953691470879, 'f1-score': 0.5795911725004467, 'support': 271263}, 'weighted avg': {'precision': 0.6640820377468066, 'recall': 0.6200956267533722, 'f1-score': 0.6313696550615214, 'support': 271263}}
[[ 28934  15509   4966]
 [ 29694 106872  35121]
 [  4187  13577  32403]]
Evaluating performance on  val set...
404/404 - 5s - 5s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6775814
{'0': {'precision': 0.3167261836193987, 'recall': 0.6878909181886415, 'f1-score': 0.43374349266445816, 'support': 7994}, '1': {'precision': 0.9540336677007385, 'recall': 0.693379113018598, 'f1-score': 0.8030859369821977, 'support': 87375}, '2': {'precision': 0.2515859988465463, 'recall': 0.7056115465969889, 'f1-score': 0.3709202694747858, 'support': 8037}, 'accuracy': 0.6939055760787575, 'macro avg': {'precision': 0.5074486167222279, 'recall': 0.6956271926014095, 'f1-score': 0.5359165663738138, 'support': 103406}, 'weighted avg': {'precision': 0.8501692116505347, 'recall': 0.6939055760787575, 'f1-score': 0.7409440983110076, 'support': 103406}}
[[ 5499  1591   904]
 [10825 60584 15966]
 [ 1038  1328  5671]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.70460594
{'0': {'precision': 0.3838367946297462, 'recall': 0.6568838628612458, 'f1-score': 0.48454154253558424, 'support': 11142}, '1': {'precision': 0.916784798163899, 'recall': 0.6698850744796291, 'f1-score': 0.7741250569995439, 'support': 81096}, '2': {'precision': 0.310780639502432, 'recall': 0.6979763610315186, 'f1-score': 0.4300689655172414, 'support': 11168}, 'accuracy': 0.6715180937276367, 'macro avg': {'precision': 0.5371340774320258, 'recall': 0.6749150994574645, 'f1-score': 0.5629118550174564, 'support': 103406}, 'weighted avg': {'precision': 0.7939102928227313, 'recall': 0.6715180937276367, 'f1-score': 0.7057638598946198, 'support': 103406}}
[[ 7319  2738  1085]
 [10569 54325 16202]
 [ 1180  2193  7795]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7483135
{'0': {'precision': 0.4155926576840461, 'recall': 0.6259098595691494, 'f1-score': 0.4995159160921227, 'support': 13601}, '1': {'precision': 0.8788562557539217, 'recall': 0.6401083369489475, 'f1-score': 0.7407193281402142, 'support': 76059}, '2': {'precision': 0.345322434150772, 'recall': 0.6914738833115088, 'f1-score': 0.460613990453345, 'support': 13746}, 'accuracy': 0.6450689515115177, 'macro avg': {'precision': 0.5465904491962466, 'recall': 0.6524973599432019, 'f1-score': 0.5669497448952273, 'support': 103406}, 'weighted avg': {'precision': 0.746999263808529, 'recall': 0.6450689515115177, 'f1-score': 0.6717587689936483, 'support': 103406}}
[[ 8513  3756  1332]
 [10685 48686 16688]
 [ 1286  2955  9505]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8151808
{'0': {'precision': 0.45473578808429294, 'recall': 0.561071488740383, 'f1-score': 0.5023379757654985, 'support': 17807}, '1': {'precision': 0.794938339057134, 'recall': 0.6046425338023361, 'f1-score': 0.6868535300316122, 'support': 67377}, '2': {'precision': 0.39616391161758374, 'recall': 0.656294588958402, 'f1-score': 0.4940816790266273, 'support': 18222}, 'accuracy': 0.6062414173258805, 'macro avg': {'precision': 0.5486126795863369, 'recall': 0.607336203833707, 'f1-score': 0.5610910616079127, 'support': 103406}, 'weighted avg': {'precision': 0.6660826204143389, 'recall': 0.6062414173258805, 'f1-score': 0.6211092101291934, 'support': 103406}}
[[ 9991  5873  1943]
 [10353 40739 16285]
 [ 1627  4636 11959]]
training model: results/EXC/W10/deepVOL_L3/seq2seq
Epoch 1/50
1060/1060 - 56s - loss: 10.5313 - accuracy10: 0.4769 - accuracy20: 0.4872 - accuracy30: 0.4912 - accuracy50: 0.4978 - val_loss: 9.5126 - val_accuracy10: 0.5760 - val_accuracy20: 0.5649 - val_accuracy30: 0.5491 - val_accuracy50: 0.5339 - 56s/epoch - 53ms/step
Epoch 2/50
1060/1060 - 49s - loss: 9.1217 - accuracy10: 0.6534 - accuracy20: 0.6361 - accuracy30: 0.6123 - accuracy50: 0.5871 - val_loss: 8.9327 - val_accuracy10: 0.6621 - val_accuracy20: 0.6421 - val_accuracy30: 0.6151 - val_accuracy50: 0.5826 - 49s/epoch - 46ms/step
Epoch 3/50
1060/1060 - 50s - loss: 8.8953 - accuracy10: 0.6696 - accuracy20: 0.6513 - accuracy30: 0.6245 - accuracy50: 0.5973 - val_loss: 8.8276 - val_accuracy10: 0.6607 - val_accuracy20: 0.6420 - val_accuracy30: 0.6161 - val_accuracy50: 0.5856 - 50s/epoch - 47ms/step
Epoch 4/50
1060/1060 - 48s - loss: 8.7535 - accuracy10: 0.6779 - accuracy20: 0.6589 - accuracy30: 0.6318 - accuracy50: 0.6021 - val_loss: 8.8359 - val_accuracy10: 0.6442 - val_accuracy20: 0.6274 - val_accuracy30: 0.6030 - val_accuracy50: 0.5772 - 48s/epoch - 46ms/step
Epoch 5/50
1060/1060 - 49s - loss: 8.6438 - accuracy10: 0.6823 - accuracy20: 0.6618 - accuracy30: 0.6340 - accuracy50: 0.6041 - val_loss: 8.7643 - val_accuracy10: 0.6806 - val_accuracy20: 0.6614 - val_accuracy30: 0.6354 - val_accuracy50: 0.6025 - 49s/epoch - 46ms/step
Epoch 6/50
1060/1060 - 48s - loss: 8.5794 - accuracy10: 0.6824 - accuracy20: 0.6632 - accuracy30: 0.6359 - accuracy50: 0.6053 - val_loss: 8.7748 - val_accuracy10: 0.6678 - val_accuracy20: 0.6504 - val_accuracy30: 0.6235 - val_accuracy50: 0.5892 - 48s/epoch - 46ms/step
Epoch 7/50
1060/1060 - 49s - loss: 8.5022 - accuracy10: 0.6848 - accuracy20: 0.6639 - accuracy30: 0.6363 - accuracy50: 0.6057 - val_loss: 8.7112 - val_accuracy10: 0.6488 - val_accuracy20: 0.6265 - val_accuracy30: 0.5995 - val_accuracy50: 0.5708 - 49s/epoch - 46ms/step
Epoch 8/50
1060/1060 - 49s - loss: 8.4487 - accuracy10: 0.6865 - accuracy20: 0.6645 - accuracy30: 0.6363 - accuracy50: 0.6057 - val_loss: 8.8079 - val_accuracy10: 0.6475 - val_accuracy20: 0.6308 - val_accuracy30: 0.6065 - val_accuracy50: 0.5777 - 49s/epoch - 46ms/step
Epoch 9/50
1060/1060 - 49s - loss: 8.4058 - accuracy10: 0.6853 - accuracy20: 0.6646 - accuracy30: 0.6368 - accuracy50: 0.6071 - val_loss: 9.0760 - val_accuracy10: 0.6053 - val_accuracy20: 0.5907 - val_accuracy30: 0.5709 - val_accuracy50: 0.5513 - 49s/epoch - 46ms/step
Epoch 10/50
1060/1060 - 48s - loss: 8.3617 - accuracy10: 0.6874 - accuracy20: 0.6671 - accuracy30: 0.6391 - accuracy50: 0.6075 - val_loss: 8.8143 - val_accuracy10: 0.6493 - val_accuracy20: 0.6316 - val_accuracy30: 0.6087 - val_accuracy50: 0.5818 - 48s/epoch - 45ms/step
Epoch 11/50
1060/1060 - 48s - loss: 8.3282 - accuracy10: 0.6881 - accuracy20: 0.6666 - accuracy30: 0.6396 - accuracy50: 0.6096 - val_loss: 8.8412 - val_accuracy10: 0.6671 - val_accuracy20: 0.6458 - val_accuracy30: 0.6205 - val_accuracy50: 0.5893 - 48s/epoch - 46ms/step
Epoch 12/50
1060/1060 - 48s - loss: 8.2924 - accuracy10: 0.6884 - accuracy20: 0.6670 - accuracy30: 0.6394 - accuracy50: 0.6096 - val_loss: 8.8063 - val_accuracy10: 0.6321 - val_accuracy20: 0.6170 - val_accuracy30: 0.5948 - val_accuracy50: 0.5703 - 48s/epoch - 45ms/step
Epoch 13/50
1060/1060 - 48s - loss: 8.2452 - accuracy10: 0.6884 - accuracy20: 0.6669 - accuracy30: 0.6401 - accuracy50: 0.6119 - val_loss: 8.6744 - val_accuracy10: 0.6656 - val_accuracy20: 0.6458 - val_accuracy30: 0.6216 - val_accuracy50: 0.5923 - 48s/epoch - 45ms/step
Epoch 14/50
1060/1060 - 48s - loss: 8.2147 - accuracy10: 0.6901 - accuracy20: 0.6671 - accuracy30: 0.6402 - accuracy50: 0.6112 - val_loss: 8.7649 - val_accuracy10: 0.6712 - val_accuracy20: 0.6527 - val_accuracy30: 0.6292 - val_accuracy50: 0.5990 - 48s/epoch - 45ms/step
Epoch 15/50
1060/1060 - 49s - loss: 8.1936 - accuracy10: 0.6894 - accuracy20: 0.6676 - accuracy30: 0.6411 - accuracy50: 0.6123 - val_loss: 8.6762 - val_accuracy10: 0.6739 - val_accuracy20: 0.6533 - val_accuracy30: 0.6291 - val_accuracy50: 0.5960 - 49s/epoch - 46ms/step
Epoch 16/50
1060/1060 - 48s - loss: 8.1715 - accuracy10: 0.6888 - accuracy20: 0.6666 - accuracy30: 0.6411 - accuracy50: 0.6126 - val_loss: 8.6233 - val_accuracy10: 0.6613 - val_accuracy20: 0.6419 - val_accuracy30: 0.6171 - val_accuracy50: 0.5881 - 48s/epoch - 45ms/step
Epoch 17/50
1060/1060 - 48s - loss: 8.1396 - accuracy10: 0.6902 - accuracy20: 0.6680 - accuracy30: 0.6411 - accuracy50: 0.6132 - val_loss: 8.6708 - val_accuracy10: 0.6721 - val_accuracy20: 0.6497 - val_accuracy30: 0.6238 - val_accuracy50: 0.5929 - 48s/epoch - 45ms/step
Epoch 18/50
1060/1060 - 48s - loss: 8.1246 - accuracy10: 0.6895 - accuracy20: 0.6677 - accuracy30: 0.6422 - accuracy50: 0.6142 - val_loss: 8.6029 - val_accuracy10: 0.6753 - val_accuracy20: 0.6553 - val_accuracy30: 0.6298 - val_accuracy50: 0.5980 - 48s/epoch - 46ms/step
Epoch 19/50
1060/1060 - 47s - loss: 8.0870 - accuracy10: 0.6904 - accuracy20: 0.6693 - accuracy30: 0.6431 - accuracy50: 0.6143 - val_loss: 8.6165 - val_accuracy10: 0.6895 - val_accuracy20: 0.6678 - val_accuracy30: 0.6413 - val_accuracy50: 0.6083 - 47s/epoch - 44ms/step
Epoch 20/50
1060/1060 - 47s - loss: 8.0589 - accuracy10: 0.6900 - accuracy20: 0.6688 - accuracy30: 0.6435 - accuracy50: 0.6148 - val_loss: 8.7536 - val_accuracy10: 0.6751 - val_accuracy20: 0.6540 - val_accuracy30: 0.6287 - val_accuracy50: 0.5969 - 47s/epoch - 44ms/step
Epoch 21/50
1060/1060 - 48s - loss: 8.0209 - accuracy10: 0.6905 - accuracy20: 0.6681 - accuracy30: 0.6440 - accuracy50: 0.6164 - val_loss: 8.8329 - val_accuracy10: 0.6912 - val_accuracy20: 0.6678 - val_accuracy30: 0.6417 - val_accuracy50: 0.6092 - 48s/epoch - 45ms/step
Epoch 22/50
1060/1060 - 47s - loss: 7.9963 - accuracy10: 0.6925 - accuracy20: 0.6702 - accuracy30: 0.6451 - accuracy50: 0.6168 - val_loss: 8.7836 - val_accuracy10: 0.7042 - val_accuracy20: 0.6795 - val_accuracy30: 0.6533 - val_accuracy50: 0.6148 - 47s/epoch - 44ms/step
Epoch 23/50
1060/1060 - 48s - loss: 7.9648 - accuracy10: 0.6932 - accuracy20: 0.6713 - accuracy30: 0.6457 - accuracy50: 0.6171 - val_loss: 8.8367 - val_accuracy10: 0.7118 - val_accuracy20: 0.6883 - val_accuracy30: 0.6611 - val_accuracy50: 0.6214 - 48s/epoch - 45ms/step
Epoch 24/50
1060/1060 - 48s - loss: 7.9430 - accuracy10: 0.6936 - accuracy20: 0.6710 - accuracy30: 0.6457 - accuracy50: 0.6173 - val_loss: 8.7813 - val_accuracy10: 0.6972 - val_accuracy20: 0.6720 - val_accuracy30: 0.6430 - val_accuracy50: 0.6073 - 48s/epoch - 46ms/step
Epoch 25/50
1060/1060 - 48s - loss: 7.9204 - accuracy10: 0.6921 - accuracy20: 0.6708 - accuracy30: 0.6455 - accuracy50: 0.6183 - val_loss: 8.9283 - val_accuracy10: 0.6972 - val_accuracy20: 0.6736 - val_accuracy30: 0.6465 - val_accuracy50: 0.6097 - 48s/epoch - 45ms/step
Epoch 26/50
1060/1060 - 48s - loss: 7.8992 - accuracy10: 0.6941 - accuracy20: 0.6726 - accuracy30: 0.6463 - accuracy50: 0.6176 - val_loss: 8.8708 - val_accuracy10: 0.6959 - val_accuracy20: 0.6728 - val_accuracy30: 0.6450 - val_accuracy50: 0.6088 - 48s/epoch - 45ms/step
Epoch 27/50
1060/1060 - 48s - loss: 7.8688 - accuracy10: 0.6946 - accuracy20: 0.6729 - accuracy30: 0.6472 - accuracy50: 0.6192 - val_loss: 8.7911 - val_accuracy10: 0.6894 - val_accuracy20: 0.6650 - val_accuracy30: 0.6373 - val_accuracy50: 0.6027 - 48s/epoch - 45ms/step
Epoch 28/50
1060/1060 - 48s - loss: 7.8293 - accuracy10: 0.6951 - accuracy20: 0.6734 - accuracy30: 0.6484 - accuracy50: 0.6204 - val_loss: 8.9314 - val_accuracy10: 0.6757 - val_accuracy20: 0.6526 - val_accuracy30: 0.6256 - val_accuracy50: 0.5917 - 48s/epoch - 45ms/step
testing model: results/EXC/W10/deepVOL_L3/seq2seq
Evaluating performance on  test set...
5267/5267 - 107s - 107s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.78539807
{'0': {'precision': 0.34565725263153924, 'recall': 0.6049726858977323, 'f1-score': 0.43994658289019234, 'support': 151387}, '1': {'precision': 0.9173234901525862, 'recall': 0.6211935033242051, 'f1-score': 0.740759309056105, 'support': 1046566}, '2': {'precision': 0.2811281760992855, 'recall': 0.7008107244601827, 'f1-score': 0.401282891727902, 'support': 150236}, 'accuracy': 0.6282442595214766, 'macro avg': {'precision': 0.514702972961137, 'recall': 0.64232563789404, 'f1-score': 0.5273295945580664, 'support': 1348189}, 'weighted avg': {'precision': 0.7822368844157715, 'recall': 0.6282442595214766, 'f1-score': 0.6691516077547305, 'support': 1348189}}
[[ 91585  32231  27571]
 [154788 650120 241658]
 [ 18586  26363 105287]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8202468
{'0': {'precision': 0.4023126671858599, 'recall': 0.5864019307363153, 'f1-score': 0.4772194631155524, 'support': 202617}, '1': {'precision': 0.8610882967953292, 'recall': 0.5925319958858646, 'f1-score': 0.702002262493177, 'support': 943090}, '2': {'precision': 0.34308987373112154, 'recall': 0.6843768828834168, 'f1-score': 0.45705182541698136, 'support': 202482}, 'accuracy': 0.6054047318291427, 'macro avg': {'precision': 0.5354969459041036, 'recall': 0.6211036031685322, 'f1-score': 0.5454245170085702, 'support': 1348189}, 'weighted avg': {'precision': 0.7143424781872048, 'recall': 0.6054047318291427, 'f1-score': 0.6314313923395425, 'support': 1348189}}
[[118815  49292  34510]
 [153463 558811 230816]
 [ 23052  40856 138574]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.86246115
{'0': {'precision': 0.42978028088508935, 'recall': 0.5716770863893491, 'f1-score': 0.4906759824088523, 'support': 242009}, '1': {'precision': 0.8066667899451803, 'recall': 0.556109517601043, 'f1-score': 0.6583546792487518, 'support': 862875}, '2': {'precision': 0.3790445019806731, 'recall': 0.6721070261605804, 'f1-score': 0.4847226421470112, 'support': 243305}, 'accuracy': 0.5798378417269389, 'macro avg': {'precision': 0.5384971909369809, 'recall': 0.5999645433836575, 'f1-score': 0.5445844346015384, 'support': 1348189}, 'weighted avg': {'precision': 0.6618409769884449, 'recall': 0.5798378417269389, 'f1-score': 0.5969201945210421, 'support': 1348189}}
[[138351  62347  41311]
 [156441 479853 226581]
 [ 27119  52659 163527]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9245036
{'0': {'precision': 0.46808090520423756, 'recall': 0.5345496970528834, 'f1-score': 0.49911204686927857, 'support': 305994}, '1': {'precision': 0.702897497260182, 'recall': 0.5141773819051424, 'f1-score': 0.5939059314686979, 'support': 733457}, '2': {'precision': 0.4272637388551982, 'recall': 0.6396556303402885, 'f1-score': 0.5123192325302972, 'support': 308738}, 'accuracy': 0.5475359908736831, 'macro avg': {'precision': 0.5327473804398726, 'recall': 0.5627942364327715, 'f1-score': 0.5351124036227579, 'support': 1348189}, 'weighted avg': {'precision': 0.5864812651354543, 'recall': 0.5475359908736831, 'f1-score': 0.55370735828574, 'support': 1348189}}
[[163569  86053  56372]
 [147977 377127 208353]
 [ 37900  73352 197486]]
Evaluating performance on  train set...
1060/1060 - 23s - 23s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.676894
{'0': {'precision': 0.29693871690310725, 'recall': 0.705064096736067, 'f1-score': 0.41788471123923965, 'support': 21998}, '1': {'precision': 0.9564382403758903, 'recall': 0.678469080937139, 'f1-score': 0.7938233139720827, 'support': 226818}, '2': {'precision': 0.2809984173948944, 'recall': 0.7277141711587295, 'f1-score': 0.4054406234875092, 'support': 22447}, 'accuracy': 0.6847008253982297, 'macro avg': {'precision': 0.5114584582246308, 'recall': 0.7037491162773118, 'f1-score': 0.5390495495662772, 'support': 271263}, 'weighted avg': {'precision': 0.8470636916028962, 'recall': 0.6847008253982297, 'f1-score': 0.7311980254652671, 'support': 271263}}
[[ 15510   3494   2994]
 [ 34126 153889  38803]
 [  2597   3515  16335]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7026103
{'0': {'precision': 0.36135542374036955, 'recall': 0.690733741691646, 'f1-score': 0.4744852282900627, 'support': 30692}, '1': {'precision': 0.9207845339322959, 'recall': 0.6580482421567082, 'f1-score': 0.7675551877763569, 'support': 209319}, '2': {'precision': 0.3525387679951748, 'recall': 0.7107065147830539, 'f1-score': 0.47129595246936506, 'support': 31252}, 'accuracy': 0.6678131554985384, 'macro avg': {'precision': 0.5448929085559467, 'recall': 0.6864961662104694, 'f1-score': 0.5711121228452615, 'support': 271263}, 'weighted avg': {'precision': 0.7920208804776135, 'recall': 0.6678131554985384, 'f1-score': 0.7002640466389093, 'support': 271263}}
[[ 21200   5887   3605]
 [ 34390 137742  37187]
 [  3078   5963  22211]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.74184203
{'0': {'precision': 0.3965349639385387, 'recall': 0.6729372322592662, 'f1-score': 0.4990183794875842, 'support': 37583}, '1': {'precision': 0.8828964669563228, 'recall': 0.6321711455412513, 'f1-score': 0.7367878057798504, 'support': 195436}, '2': {'precision': 0.39268953469436096, 'recall': 0.6935728480284489, 'f1-score': 0.5014604266903612, 'support': 38244}, 'accuracy': 0.6464759292642196, 'macro avg': {'precision': 0.5573736551964075, 'recall': 0.6662270752763221, 'f1-score': 0.5790888706525985, 'support': 271263}, 'weighted avg': {'precision': 0.7464001578933697, 'recall': 0.6464759292642196, 'f1-score': 0.6706676617342537, 'support': 271263}}
[[ 25291   8166   4126]
 [ 34991 123549  36896]
 [  3498   8221  26525]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.79935306
{'0': {'precision': 0.4485526105351924, 'recall': 0.6244004128802445, 'f1-score': 0.5220665380580092, 'support': 49409}, '1': {'precision': 0.8002774994218762, 'recall': 0.6047050737679615, 'f1-score': 0.6888795257069109, 'support': 171687}, '2': {'precision': 0.4496934876432911, 'recall': 0.6521617796559491, 'f1-score': 0.5323256400452324, 'support': 50167}, 'accuracy': 0.6170690436956017, 'macro avg': {'precision': 0.5661745325334532, 'recall': 0.6270890887680517, 'f1-score': 0.5810905679367174, 'support': 271263}, 'weighted avg': {'precision': 0.6713763107087143, 'recall': 0.6170690436956017, 'f1-score': 0.629542639774314, 'support': 271263}}
[[ 30851  13112   5446]
 [ 33276 103820  34591]
 [  4652  12798  32717]]
Evaluating performance on  val set...
404/404 - 8s - 8s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6903129
{'0': {'precision': 0.3032250975221142, 'recall': 0.6903927945959469, 'f1-score': 0.4213781255964879, 'support': 7994}, '1': {'precision': 0.9578134964108769, 'recall': 0.670409155937053, 'f1-score': 0.7887458594780922, 'support': 87375}, '2': {'precision': 0.24318030605455754, 'recall': 0.7276346895607814, 'f1-score': 0.3645317126383045, 'support': 8037}, 'accuracy': 0.6764017561843607, 'macro avg': {'precision': 0.5014062999958496, 'recall': 0.696145546697927, 'f1-score': 0.5248852325709615, 'support': 103406}, 'weighted avg': {'precision': 0.8516660135606504, 'recall': 0.6764017561843607, 'f1-score': 0.7273746937546243, 'support': 103406}}
[[ 5519  1355  1120]
 [11718 58577 17080]
 [  964  1225  5848]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7233478
{'0': {'precision': 0.36445871024219434, 'recall': 0.6725901992460959, 'f1-score': 0.47274791824375473, 'support': 11142}, '1': {'precision': 0.9218273753942106, 'recall': 0.6451859524514156, 'f1-score': 0.759087446955134, 'support': 81096}, '2': {'precision': 0.303699444124976, 'recall': 0.7093481375358166, 'f1-score': 0.42530802888357977, 'support': 11168}, 'accuracy': 0.6550683712743941, 'macro avg': {'precision': 0.529995176587127, 'recall': 0.6757080964111094, 'f1-score': 0.5523811313608228, 'support': 103406}, 'weighted avg': {'precision': 0.7950121576743628, 'recall': 0.6550683712743941, 'f1-score': 0.692185685259243, 'support': 103406}}
[[ 7494  2309  1339]
 [11950 52322 16824]
 [ 1118  2128  7922]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.769235
{'0': {'precision': 0.39117179215270415, 'recall': 0.6509080214690096, 'f1-score': 0.48867054894709244, 'support': 13601}, '1': {'precision': 0.8856330553449583, 'recall': 0.6143388685099725, 'f1-score': 0.725451990777758, 'support': 76059}, '2': {'precision': 0.3411151567073606, 'recall': 0.6951840535428488, 'f1-score': 0.45766283524904217, 'support': 13746}, 'accuracy': 0.6298957507301317, 'macro avg': {'precision': 0.539306668068341, 'recall': 0.6534769811739437, 'f1-score': 0.5572617916579642, 'support': 103406}, 'weighted avg': {'precision': 0.748212492946739, 'recall': 0.6298957507301317, 'f1-score': 0.6587102724805933, 'support': 103406}}
[[ 8853  3160  1588]
 [12463 46726 16870]
 [ 1316  2874  9556]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8302641
{'0': {'precision': 0.4310120403514481, 'recall': 0.5950468916718145, 'f1-score': 0.4999174353046637, 'support': 17807}, '1': {'precision': 0.8073249063284885, 'recall': 0.5820235391899313, 'f1-score': 0.67640641305379, 'support': 67377}, '2': {'precision': 0.39734858503041526, 'recall': 0.6595873120403908, 'f1-score': 0.49593563028677534, 'support': 18222}, 'accuracy': 0.5979343558400867, 'macro avg': {'precision': 0.5452285105701172, 'recall': 0.6122192476340456, 'f1-score': 0.5574198262150764, 'support': 103406}, 'weighted avg': {'precision': 0.6702768459533976, 'recall': 0.5979343558400867, 'f1-score': 0.6142119772342124, 'support': 103406}}
[[10596  4958  2253]
 [12186 39215 15976]
 [ 1802  4401 12019]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :       256            32
 Used       :        22 (peak)  15.88 (ave)

============================================
