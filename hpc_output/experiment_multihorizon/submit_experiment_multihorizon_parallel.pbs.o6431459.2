This machine has 1 visible gpus.
This machine has 1 physical gpus.
training model: results/XRAY/W0/deepLOB_L1/seq2seq
Epoch 1/50
451/451 - 40s - loss: 12.9019 - accuracy10: 0.4082 - accuracy20: 0.4172 - accuracy30: 0.4116 - accuracy50: 0.3947 - val_loss: 12.8049 - val_accuracy10: 0.4331 - val_accuracy20: 0.4353 - val_accuracy30: 0.4263 - val_accuracy50: 0.4011 - 40s/epoch - 89ms/step
Epoch 2/50
451/451 - 13s - loss: 12.6865 - accuracy10: 0.4314 - accuracy20: 0.4452 - accuracy30: 0.4340 - accuracy50: 0.4099 - val_loss: 12.8521 - val_accuracy10: 0.3916 - val_accuracy20: 0.4299 - val_accuracy30: 0.4203 - val_accuracy50: 0.3985 - 13s/epoch - 29ms/step
Epoch 3/50
451/451 - 13s - loss: 12.5892 - accuracy10: 0.4485 - accuracy20: 0.4552 - accuracy30: 0.4427 - accuracy50: 0.4170 - val_loss: 12.7348 - val_accuracy10: 0.4382 - val_accuracy20: 0.4474 - val_accuracy30: 0.4314 - val_accuracy50: 0.4052 - 13s/epoch - 28ms/step
Epoch 4/50
451/451 - 13s - loss: 12.4902 - accuracy10: 0.4622 - accuracy20: 0.4676 - accuracy30: 0.4520 - accuracy50: 0.4232 - val_loss: 12.8230 - val_accuracy10: 0.4248 - val_accuracy20: 0.4409 - val_accuracy30: 0.4259 - val_accuracy50: 0.4004 - 13s/epoch - 28ms/step
Epoch 5/50
451/451 - 13s - loss: 12.4231 - accuracy10: 0.4717 - accuracy20: 0.4735 - accuracy30: 0.4567 - accuracy50: 0.4262 - val_loss: 12.8746 - val_accuracy10: 0.4347 - val_accuracy20: 0.4448 - val_accuracy30: 0.4292 - val_accuracy50: 0.4028 - 13s/epoch - 28ms/step
Epoch 6/50
451/451 - 13s - loss: 12.3606 - accuracy10: 0.4779 - accuracy20: 0.4766 - accuracy30: 0.4602 - accuracy50: 0.4295 - val_loss: 12.7084 - val_accuracy10: 0.4593 - val_accuracy20: 0.4575 - val_accuracy30: 0.4387 - val_accuracy50: 0.4095 - 13s/epoch - 28ms/step
Epoch 7/50
451/451 - 13s - loss: 12.3207 - accuracy10: 0.4829 - accuracy20: 0.4816 - accuracy30: 0.4650 - accuracy50: 0.4337 - val_loss: 12.7815 - val_accuracy10: 0.4333 - val_accuracy20: 0.4486 - val_accuracy30: 0.4309 - val_accuracy50: 0.4027 - 13s/epoch - 28ms/step
Epoch 8/50
451/451 - 13s - loss: 12.2766 - accuracy10: 0.4889 - accuracy20: 0.4865 - accuracy30: 0.4685 - accuracy50: 0.4357 - val_loss: 12.8217 - val_accuracy10: 0.4486 - val_accuracy20: 0.4561 - val_accuracy30: 0.4374 - val_accuracy50: 0.4093 - 13s/epoch - 28ms/step
Epoch 9/50
451/451 - 13s - loss: 12.2369 - accuracy10: 0.4926 - accuracy20: 0.4896 - accuracy30: 0.4719 - accuracy50: 0.4370 - val_loss: 12.8027 - val_accuracy10: 0.4400 - val_accuracy20: 0.4524 - val_accuracy30: 0.4364 - val_accuracy50: 0.4094 - 13s/epoch - 28ms/step
Epoch 10/50
451/451 - 13s - loss: 12.2068 - accuracy10: 0.4952 - accuracy20: 0.4916 - accuracy30: 0.4734 - accuracy50: 0.4380 - val_loss: 12.7867 - val_accuracy10: 0.4460 - val_accuracy20: 0.4558 - val_accuracy30: 0.4365 - val_accuracy50: 0.4108 - 13s/epoch - 28ms/step
Epoch 11/50
451/451 - 13s - loss: 12.1840 - accuracy10: 0.4983 - accuracy20: 0.4938 - accuracy30: 0.4762 - accuracy50: 0.4391 - val_loss: 12.8203 - val_accuracy10: 0.4344 - val_accuracy20: 0.4515 - val_accuracy30: 0.4346 - val_accuracy50: 0.4079 - 13s/epoch - 28ms/step
Epoch 12/50
451/451 - 13s - loss: 12.1629 - accuracy10: 0.4992 - accuracy20: 0.4959 - accuracy30: 0.4768 - accuracy50: 0.4407 - val_loss: 12.7266 - val_accuracy10: 0.4519 - val_accuracy20: 0.4628 - val_accuracy30: 0.4434 - val_accuracy50: 0.4162 - 13s/epoch - 29ms/step
Epoch 13/50
451/451 - 13s - loss: 12.1316 - accuracy10: 0.5034 - accuracy20: 0.4983 - accuracy30: 0.4792 - accuracy50: 0.4425 - val_loss: 12.7986 - val_accuracy10: 0.4480 - val_accuracy20: 0.4593 - val_accuracy30: 0.4416 - val_accuracy50: 0.4142 - 13s/epoch - 28ms/step
Epoch 14/50
451/451 - 12s - loss: 12.1116 - accuracy10: 0.5054 - accuracy20: 0.5007 - accuracy30: 0.4809 - accuracy50: 0.4441 - val_loss: 12.8572 - val_accuracy10: 0.4295 - val_accuracy20: 0.4503 - val_accuracy30: 0.4358 - val_accuracy50: 0.4080 - 12s/epoch - 27ms/step
Epoch 15/50
451/451 - 12s - loss: 12.0912 - accuracy10: 0.5060 - accuracy20: 0.5015 - accuracy30: 0.4812 - accuracy50: 0.4447 - val_loss: 12.8055 - val_accuracy10: 0.4456 - val_accuracy20: 0.4589 - val_accuracy30: 0.4424 - val_accuracy50: 0.4133 - 12s/epoch - 28ms/step
Epoch 16/50
451/451 - 12s - loss: 12.0712 - accuracy10: 0.5086 - accuracy20: 0.5038 - accuracy30: 0.4839 - accuracy50: 0.4460 - val_loss: 12.8096 - val_accuracy10: 0.4485 - val_accuracy20: 0.4556 - val_accuracy30: 0.4386 - val_accuracy50: 0.4102 - 12s/epoch - 28ms/step
testing model: results/XRAY/W0/deepLOB_L1/seq2seq
Evaluating performance on  test set...
1625/1625 - 21s - 21s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0263193
{'0': {'precision': 0.4450943105309143, 'recall': 0.4053034557639747, 'f1-score': 0.4242679587107647, 'support': 106836}, '1': {'precision': 0.6803803877524718, 'recall': 0.3719077715826976, 'f1-score': 0.4809305352204327, 'support': 198724}, '2': {'precision': 0.3796132228255692, 'recall': 0.7225974920891097, 'f1-score': 0.49774069343692523, 'support': 110291}, 'accuracy': 0.473496516781251, 'macro avg': {'precision': 0.5016959737029851, 'recall': 0.4999362398119273, 'f1-score': 0.4676463957893742, 'support': 415851}, 'weighted avg': {'precision': 0.54016445768859, 'recall': 0.473496516781251, 'f1-score': 0.4708317405460621, 'support': 415851}}
[[43301 18237 45298]
 [39871 73907 84946]
 [14113 16482 79696]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0296544
{'0': {'precision': 0.5082870131316506, 'recall': 0.3765488584200894, 'f1-score': 0.43261106539189037, 'support': 133324}, '1': {'precision': 0.5363450455474995, 'recall': 0.3771631059276843, 'f1-score': 0.4428850753021783, 'support': 145335}, '2': {'precision': 0.4410999576509789, 'recall': 0.6908857659338737, 'f1-score': 0.5384337907195382, 'support': 137192}, 'accuracy': 0.48046535898675247, 'macro avg': {'precision': 0.49524400544337627, 'recall': 0.48153257676054917, 'f1-score': 0.471309977137869, 'support': 415851}, 'weighted avg': {'precision': 0.49592750846688627, 'recall': 0.48046535898675247, 'f1-score': 0.47111332837421427, 'support': 415851}}
[[50203 24717 58404]
 [28827 54815 61693]
 [19739 22669 94784]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0437618
{'0': {'precision': 0.5024574820568775, 'recall': 0.36590610876221025, 'f1-score': 0.4234453494404819, 'support': 137180}, '1': {'precision': 0.4913941570031417, 'recall': 0.3385030198446937, 'f1-score': 0.4008650968337967, 'support': 139080}, '2': {'precision': 0.43245133889027687, 'recall': 0.6820067196309217, 'f1-score': 0.5292881446394022, 'support': 139591}, 'accuracy': 0.4628484721691183, 'macro avg': {'precision': 0.475434325983432, 'recall': 0.46213861607927526, 'f1-score': 0.4511995303045602, 'support': 415851}, 'weighted avg': {'precision': 0.4752580409608058, 'recall': 0.4628484721691183, 'f1-score': 0.4514222933268131, 'support': 415851}}
[[50195 25665 61320]
 [28378 47079 63623]
 [21326 23063 95202]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0682596
{'0': {'precision': 0.46951292128141003, 'recall': 0.347747469624468, 'f1-score': 0.39955914210066257, 'support': 136047}, '1': {'precision': 0.43754729579345647, 'recall': 0.27949926425113564, 'f1-score': 0.34110517800054657, 'support': 140673}, '2': {'precision': 0.40950685308599766, 'recall': 0.6629148069085969, 'f1-score': 0.5062713045960292, 'support': 139131}, 'accuracy': 0.4301059754575557, 'macro avg': {'precision': 0.4388556900536214, 'recall': 0.4300538469280668, 'f1-score': 0.41564520823241274, 'support': 415851}, 'weighted avg': {'precision': 0.4386234808126777, 'recall': 0.4301059754575557, 'f1-score': 0.4154881055714424, 'support': 415851}}
[[47310 26299 62438]
 [30798 39318 70557]
 [22656 24243 92232]]
Evaluating performance on  train set...
451/451 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0573831
{'0': {'precision': 0.4372536249271587, 'recall': 0.41181598062953995, 'f1-score': 0.42415375407328587, 'support': 30975}, '1': {'precision': 0.6527495735521078, 'recall': 0.3033826638477801, 'f1-score': 0.41423748034743163, 'support': 52976}, '2': {'precision': 0.3676100883951018, 'recall': 0.7195466522746754, 'f1-score': 0.4866135646349056, 'support': 31499}, 'accuracy': 0.44601992204417495, 'macro avg': {'precision': 0.48587109562478953, 'recall': 0.4782484322506651, 'f1-score': 0.44166826635187434, 'support': 115450}, 'weighted avg': {'precision': 0.5171359256385666, 'recall': 0.44601992204417495, 'f1-score': 0.4366448502705973, 'support': 115450}}
[[12756  4593 13626]
 [11540 16072 25364]
 [ 4877  3957 22665]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0502008
{'0': {'precision': 0.4880860359603428, 'recall': 0.3824761001817176, 'f1-score': 0.42887517349319315, 'support': 37971}, '1': {'precision': 0.5119744544970729, 'recall': 0.297725279826688, 'f1-score': 0.37650435406542515, 'support': 38774}, '2': {'precision': 0.4242323467464804, 'recall': 0.6921327993799251, 'f1-score': 0.5260377803086832, 'support': 38705}, 'accuracy': 0.45782589865742745, 'macro avg': {'precision': 0.47476427906796537, 'recall': 0.45744472646277695, 'f1-score': 0.4438057692891005, 'support': 115450}, 'weighted avg': {'precision': 0.47470182200902733, 'recall': 0.45782589865742745, 'f1-score': 0.443860470542143, 'support': 115450}}
[[14523  5886 17562]
 [ 8434 11544 18796]
 [ 6798  5118 26789]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0603662
{'0': {'precision': 0.47627870045656057, 'recall': 0.3736794289422453, 'f1-score': 0.41878663583075154, 'support': 38525}, '1': {'precision': 0.4780940353604041, 'recall': 0.26130239719663384, 'f1-score': 0.3379164735568258, 'support': 37669}, '2': {'precision': 0.4171514326381583, 'recall': 0.6868504177705319, 'f1-score': 0.5190582528009857, 'support': 39256}, 'accuracy': 0.4434993503681247, 'macro avg': {'precision': 0.4571747228183743, 'recall': 0.44061074796980365, 'f1-score': 0.4252537873961877, 'support': 115450}, 'weighted avg': {'precision': 0.4567662000235912, 'recall': 0.4434993503681247, 'f1-score': 0.4264952928518603, 'support': 115450}}
[[14396  5761 18368]
 [ 8521  9843 19305]
 [ 7309  4984 26963]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0791422
{'0': {'precision': 0.4432696084850072, 'recall': 0.35362477802151887, 'f1-score': 0.3934049970947123, 'support': 38292}, '1': {'precision': 0.4315828402366864, 'recall': 0.21539313399778517, 'f1-score': 0.287367643437577, 'support': 37926}, '2': {'precision': 0.39973322824142843, 'recall': 0.6722063621533442, 'f1-score': 0.5013402277436648, 'support': 39232}, 'accuracy': 0.4164746643568644, 'macro avg': {'precision': 0.4248618923210407, 'recall': 0.4137414247242161, 'f1-score': 0.39403762275865145, 'support': 115450}, 'weighted avg': {'precision': 0.42463598663743773, 'recall': 0.4164746643568644, 'f1-score': 0.3952494517852207, 'support': 115450}}
[[13541  5732 19019]
 [ 9174  8169 20583]
 [ 7833  5027 26372]]
Evaluating performance on  val set...
177/177 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0407326
{'0': {'precision': 0.45935195964299574, 'recall': 0.39679879326238165, 'f1-score': 0.4257902072748528, 'support': 11933}, '1': {'precision': 0.6065682534416985, 'recall': 0.3534870233434827, 'f1-score': 0.4466701273321323, 'support': 20691}, '2': {'precision': 0.3777299292525377, 'recall': 0.6877350188015041, 'f1-score': 0.4876333106421601, 'support': 12499}, 'accuracy': 0.4575272034217583, 'macro avg': {'precision': 0.4812167141124107, 'recall': 0.4793402784691228, 'f1-score': 0.45336454841638174, 'support': 45123}, 'weighted avg': {'precision': 0.5042483224100685, 'recall': 0.4575272034217583, 'f1-score': 0.4524950667676424, 'support': 45123}}
[[4735 2581 4617]
 [3833 7314 9544]
 [1740 2163 8596]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0519282
{'0': {'precision': 0.5120144363187388, 'recall': 0.36278600269179007, 'f1-score': 0.424672102091457, 'support': 14860}, '1': {'precision': 0.4553442028985507, 'recall': 0.3367722918201916, 'f1-score': 0.38718373319983057, 'support': 14927}, '2': {'precision': 0.4333021992018341, 'recall': 0.6654929577464789, 'f1-score': 0.5248650038570327, 'support': 15336}, 'accuracy': 0.4570618088336325, 'macro avg': {'precision': 0.4668869461397079, 'recall': 0.45501708408615354, 'f1-score': 0.4455736130494401, 'support': 45123}, 'weighted avg': {'precision': 0.4665155235095728, 'recall': 0.4570618088336325, 'f1-score': 0.4463233544246698, 'support': 45123}}
[[ 5391  3265  6204]
 [ 2756  5027  7144]
 [ 2382  2748 10206]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0654632
{'0': {'precision': 0.4988420565076424, 'recall': 0.35189178592432857, 'f1-score': 0.4126753007893325, 'support': 15303}, '1': {'precision': 0.4265326633165829, 'recall': 0.291523560928699, 'f1-score': 0.3463358903215277, 'support': 14558}, '2': {'precision': 0.4161539092624498, 'recall': 0.6647228410431136, 'f1-score': 0.5118567103935419, 'support': 15262}, 'accuracy': 0.43822440883806485, 'macro avg': {'precision': 0.4471762096955583, 'recall': 0.4360460626320471, 'f1-score': 0.42362263383480064, 'support': 45123}, 'weighted avg': {'precision': 0.44754523117839623, 'recall': 0.43822440883806485, 'f1-score': 0.4248184990649157, 'support': 45123}}
[[ 5385  3139  6779]
 [ 2860  4244  7454]
 [ 2550  2567 10145]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0847837
{'0': {'precision': 0.45820827648931334, 'recall': 0.33040398740818466, 'f1-score': 0.3839500057158099, 'support': 15248}, '1': {'precision': 0.38947252018135575, 'recall': 0.2368367964494654, 'f1-score': 0.2945554905076524, 'support': 14871}, '2': {'precision': 0.3929439904325294, 'recall': 0.6569581444948014, 'f1-score': 0.49175584324877153, 'support': 15004}, 'accuracy': 0.4081510537863174, 'macro avg': {'precision': 0.4135415957010662, 'recall': 0.4080663094508172, 'f1-score': 0.3900871131574113, 'support': 45123}, 'weighted avg': {'precision': 0.4138540717588738, 'recall': 0.4081510537863174, 'f1-score': 0.39033550647338466, 'support': 45123}}
[[5038 3048 7162]
 [3283 3522 8066]
 [2674 2473 9857]]
training model: results/XRAY/W0/deepOF_L1/seq2seq
Epoch 1/50
451/451 - 18s - loss: 13.0871 - accuracy10: 0.3712 - accuracy20: 0.3851 - accuracy30: 0.3812 - accuracy50: 0.3739 - val_loss: 13.0603 - val_accuracy10: 0.3338 - val_accuracy20: 0.3943 - val_accuracy30: 0.3955 - val_accuracy50: 0.3850 - 18s/epoch - 40ms/step
Epoch 2/50
451/451 - 12s - loss: 12.9623 - accuracy10: 0.3874 - accuracy20: 0.4017 - accuracy30: 0.3971 - accuracy50: 0.3866 - val_loss: 13.0452 - val_accuracy10: 0.3355 - val_accuracy20: 0.3955 - val_accuracy30: 0.3982 - val_accuracy50: 0.3871 - 12s/epoch - 27ms/step
Epoch 3/50
451/451 - 12s - loss: 12.9224 - accuracy10: 0.3917 - accuracy20: 0.4042 - accuracy30: 0.3991 - accuracy50: 0.3896 - val_loss: 13.0215 - val_accuracy10: 0.3367 - val_accuracy20: 0.3969 - val_accuracy30: 0.3983 - val_accuracy50: 0.3889 - 12s/epoch - 27ms/step
Epoch 4/50
451/451 - 12s - loss: 12.8923 - accuracy10: 0.4008 - accuracy20: 0.4088 - accuracy30: 0.4025 - accuracy50: 0.3923 - val_loss: 12.9962 - val_accuracy10: 0.3401 - val_accuracy20: 0.3990 - val_accuracy30: 0.4006 - val_accuracy50: 0.3908 - 12s/epoch - 27ms/step
Epoch 5/50
451/451 - 12s - loss: 12.8697 - accuracy10: 0.4055 - accuracy20: 0.4111 - accuracy30: 0.4042 - accuracy50: 0.3933 - val_loss: 12.9834 - val_accuracy10: 0.3411 - val_accuracy20: 0.4004 - val_accuracy30: 0.4020 - val_accuracy50: 0.3928 - 12s/epoch - 27ms/step
Epoch 6/50
451/451 - 12s - loss: 12.8519 - accuracy10: 0.4097 - accuracy20: 0.4143 - accuracy30: 0.4081 - accuracy50: 0.3945 - val_loss: 12.9697 - val_accuracy10: 0.3454 - val_accuracy20: 0.4008 - val_accuracy30: 0.4018 - val_accuracy50: 0.3915 - 12s/epoch - 27ms/step
Epoch 7/50
451/451 - 12s - loss: 12.8329 - accuracy10: 0.4132 - accuracy20: 0.4156 - accuracy30: 0.4094 - accuracy50: 0.3981 - val_loss: 12.9683 - val_accuracy10: 0.3464 - val_accuracy20: 0.4021 - val_accuracy30: 0.4023 - val_accuracy50: 0.3927 - 12s/epoch - 27ms/step
Epoch 8/50
451/451 - 12s - loss: 12.8199 - accuracy10: 0.4174 - accuracy20: 0.4172 - accuracy30: 0.4109 - accuracy50: 0.3981 - val_loss: 12.9411 - val_accuracy10: 0.3502 - val_accuracy20: 0.4035 - val_accuracy30: 0.4029 - val_accuracy50: 0.3922 - 12s/epoch - 27ms/step
Epoch 9/50
451/451 - 12s - loss: 12.8042 - accuracy10: 0.4197 - accuracy20: 0.4202 - accuracy30: 0.4136 - accuracy50: 0.4010 - val_loss: 12.9408 - val_accuracy10: 0.3521 - val_accuracy20: 0.4042 - val_accuracy30: 0.4038 - val_accuracy50: 0.3945 - 12s/epoch - 26ms/step
Epoch 10/50
451/451 - 12s - loss: 12.7882 - accuracy10: 0.4219 - accuracy20: 0.4219 - accuracy30: 0.4139 - accuracy50: 0.4019 - val_loss: 12.9320 - val_accuracy10: 0.3535 - val_accuracy20: 0.4050 - val_accuracy30: 0.4043 - val_accuracy50: 0.3927 - 12s/epoch - 27ms/step
Epoch 11/50
451/451 - 12s - loss: 12.7705 - accuracy10: 0.4236 - accuracy20: 0.4251 - accuracy30: 0.4176 - accuracy50: 0.4048 - val_loss: 12.9303 - val_accuracy10: 0.3537 - val_accuracy20: 0.4050 - val_accuracy30: 0.4045 - val_accuracy50: 0.3956 - 12s/epoch - 26ms/step
Epoch 12/50
451/451 - 12s - loss: 12.7551 - accuracy10: 0.4274 - accuracy20: 0.4269 - accuracy30: 0.4189 - accuracy50: 0.4053 - val_loss: 12.9383 - val_accuracy10: 0.3570 - val_accuracy20: 0.4050 - val_accuracy30: 0.4050 - val_accuracy50: 0.3961 - 12s/epoch - 27ms/step
Epoch 13/50
451/451 - 12s - loss: 12.7425 - accuracy10: 0.4285 - accuracy20: 0.4287 - accuracy30: 0.4204 - accuracy50: 0.4074 - val_loss: 12.9373 - val_accuracy10: 0.3566 - val_accuracy20: 0.4066 - val_accuracy30: 0.4041 - val_accuracy50: 0.3952 - 12s/epoch - 26ms/step
Epoch 14/50
451/451 - 12s - loss: 12.7251 - accuracy10: 0.4316 - accuracy20: 0.4322 - accuracy30: 0.4240 - accuracy50: 0.4080 - val_loss: 12.9534 - val_accuracy10: 0.3543 - val_accuracy20: 0.4052 - val_accuracy30: 0.4052 - val_accuracy50: 0.3954 - 12s/epoch - 26ms/step
Epoch 15/50
451/451 - 12s - loss: 12.7098 - accuracy10: 0.4321 - accuracy20: 0.4341 - accuracy30: 0.4254 - accuracy50: 0.4099 - val_loss: 12.9582 - val_accuracy10: 0.3568 - val_accuracy20: 0.4070 - val_accuracy30: 0.4055 - val_accuracy50: 0.3965 - 12s/epoch - 27ms/step
Epoch 16/50
451/451 - 12s - loss: 12.6908 - accuracy10: 0.4342 - accuracy20: 0.4345 - accuracy30: 0.4279 - accuracy50: 0.4114 - val_loss: 12.9602 - val_accuracy10: 0.3586 - val_accuracy20: 0.4076 - val_accuracy30: 0.4042 - val_accuracy50: 0.3961 - 12s/epoch - 27ms/step
Epoch 17/50
451/451 - 12s - loss: 12.6736 - accuracy10: 0.4380 - accuracy20: 0.4397 - accuracy30: 0.4305 - accuracy50: 0.4126 - val_loss: 12.9646 - val_accuracy10: 0.3583 - val_accuracy20: 0.4046 - val_accuracy30: 0.4041 - val_accuracy50: 0.3956 - 12s/epoch - 27ms/step
Epoch 18/50
451/451 - 12s - loss: 12.6534 - accuracy10: 0.4387 - accuracy20: 0.4423 - accuracy30: 0.4332 - accuracy50: 0.4150 - val_loss: 12.9678 - val_accuracy10: 0.3574 - val_accuracy20: 0.4065 - val_accuracy30: 0.4047 - val_accuracy50: 0.3950 - 12s/epoch - 27ms/step
Epoch 19/50
451/451 - 12s - loss: 12.6348 - accuracy10: 0.4412 - accuracy20: 0.4459 - accuracy30: 0.4359 - accuracy50: 0.4171 - val_loss: 12.9646 - val_accuracy10: 0.3602 - val_accuracy20: 0.4098 - val_accuracy30: 0.4068 - val_accuracy50: 0.3961 - 12s/epoch - 27ms/step
Epoch 20/50
451/451 - 12s - loss: 12.6098 - accuracy10: 0.4436 - accuracy20: 0.4476 - accuracy30: 0.4383 - accuracy50: 0.4190 - val_loss: 12.9769 - val_accuracy10: 0.3580 - val_accuracy20: 0.4060 - val_accuracy30: 0.4051 - val_accuracy50: 0.3949 - 12s/epoch - 26ms/step
Epoch 21/50
451/451 - 12s - loss: 12.5823 - accuracy10: 0.4461 - accuracy20: 0.4528 - accuracy30: 0.4438 - accuracy50: 0.4221 - val_loss: 12.9828 - val_accuracy10: 0.3602 - val_accuracy20: 0.4074 - val_accuracy30: 0.4064 - val_accuracy50: 0.3953 - 12s/epoch - 26ms/step
testing model: results/XRAY/W0/deepOF_L1/seq2seq
Evaluating performance on  test set...
1625/1625 - 20s - 20s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0930635
{'0': {'precision': 0.3279962150451953, 'recall': 0.6164761824529874, 'f1-score': 0.42817948951330825, 'support': 106833}, '1': {'precision': 0.6426395463279749, 'recall': 0.06900022141261247, 'f1-score': 0.12461999172956588, 'support': 198724}, '2': {'precision': 0.3420506519921121, 'recall': 0.6007852097670665, 'f1-score': 0.43591675082153797, 'support': 110289}, 'accuracy': 0.35068751412782617, 'macro avg': {'precision': 0.4375621377884274, 'recall': 0.42875387121088876, 'f1-score': 0.32957207735480404, 'support': 415846}, 'weighted avg': {'precision': 0.4820850632300464, 'recall': 0.35068751412782617, 'f1-score': 0.2851668770915149, 'support': 415846}}
[[65860  3434 37539]
 [95097 13712 89915]
 [39838  4191 66260]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0747622
{'0': {'precision': 0.3939405991786897, 'recall': 0.5943399764478214, 'f1-score': 0.4738222165082535, 'support': 133321}, '1': {'precision': 0.5245677888989991, 'recall': 0.06346716207382942, 'f1-score': 0.1132341838582363, 'support': 145335}, '2': {'precision': 0.40641233766233764, 'recall': 0.5839492674393177, 'f1-score': 0.47926774550566836, 'support': 137190}, 'accuracy': 0.4053760286259817, 'macro avg': {'precision': 0.4416402419133421, 'recall': 0.4139188019869895, 'f1-score': 0.35544138195738606, 'support': 415846}, 'weighted avg': {'precision': 0.44370830265683503, 'recall': 0.4053760286259817, 'f1-score': 0.3495959654392643, 'support': 415846}}
[[79238  3788 50295]
 [69398  9224 66713]
 [52506  4572 80112]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0758655
{'0': {'precision': 0.40082430720233486, 'recall': 0.5926752103106913, 'f1-score': 0.47822596061938444, 'support': 137178}, '1': {'precision': 0.4978137440448998, 'recall': 0.05484652607510839, 'f1-score': 0.09880701027188768, 'support': 139079}, '2': {'precision': 0.4073378994971824, 'recall': 0.57687210310268, 'f1-score': 0.4775035208657624, 'support': 139589}, 'accuracy': 0.40749460136685217, 'macro avg': {'precision': 0.4353253169148057, 'recall': 0.4081312798294932, 'f1-score': 0.3515121639190115, 'support': 415846}, 'weighted avg': {'precision': 0.43544871075911445, 'recall': 0.40749460136685217, 'f1-score': 0.351087421741656, 'support': 415846}}
[[81302  3469 52407]
 [66697  7628 64754]
 [54838  4226 80525]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0836544
{'0': {'precision': 0.3918157445771387, 'recall': 0.5908412657576537, 'f1-score': 0.4711733759287211, 'support': 136045}, '1': {'precision': 0.46567939359910165, 'recall': 0.04716679344001251, 'f1-score': 0.08565766626430588, 'support': 140671}, '2': {'precision': 0.39736724222186026, 'recall': 0.5610723783511824, 'f1-score': 0.46523908003504405, 'support': 139130}, 'accuracy': 0.3969690702808251, 'macro avg': {'precision': 0.41828746013270024, 'recall': 0.39969347918294956, 'f1-score': 0.3406900407426903, 'support': 415846}, 'weighted avg': {'precision': 0.41865946373971014, 'recall': 0.3969690702808251, 'f1-score': 0.3387769623960907, 'support': 415846}}
[[80381  3482 52182]
 [67832  6635 66204]
 [56937  4131 78062]]
Evaluating performance on  train set...
451/451 - 5s - 5s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0851418
{'0': {'precision': 0.34043109762477763, 'recall': 0.6307066007560337, 'f1-score': 0.44218680982637354, 'support': 30951}, '1': {'precision': 0.652047256837676, 'recall': 0.07601743363332768, 'f1-score': 0.1361608651571477, 'support': 53001}, '2': {'precision': 0.3466789916613708, 'recall': 0.5715646431292862, 'f1-score': 0.43158361602915263, 'support': 31496}, 'accuracy': 0.3599196174901254, 'macro avg': {'precision': 0.4463857820412748, 'recall': 0.42609622583954926, 'f1-score': 0.33664376367089127, 'support': 115448}, 'weighted avg': {'precision': 0.48519542203940036, 'recall': 0.3599196174901254, 'f1-score': 0.29880070278899823, 'support': 115448}}
[[19521  1040 10390]
 [25437  4029 23535]
 [12384  1110 18002]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0701512
{'0': {'precision': 0.399554619948155, 'recall': 0.6053720642117194, 'f1-score': 0.48138676951454684, 'support': 37937}, '1': {'precision': 0.538753495805034, 'recall': 0.06954077817600494, 'f1-score': 0.12318162095503438, 'support': 38783}, '2': {'precision': 0.4083039102769858, 'recall': 0.5583815327411692, 'f1-score': 0.4716929687755614, 'support': 38728}, 'accuracy': 0.4096043240246691, 'macro avg': {'precision': 0.4488706753433916, 'recall': 0.41109812504296456, 'f1-score': 0.35875378641504757, 'support': 115448}, 'weighted avg': {'precision': 0.4492513883478873, 'recall': 0.4096043240246691, 'f1-score': 0.35780133025528726, 'support': 115448}}
[[22966  1139 13832]
 [18580  2697 17506]
 [15933  1170 21625]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0729381
{'0': {'precision': 0.39998965499405165, 'recall': 0.6022742023417015, 'f1-score': 0.48071862243312125, 'support': 38519}, '1': {'precision': 0.5215686274509804, 'recall': 0.05995121175160418, 'f1-score': 0.10754120193108041, 'support': 37714}, '2': {'precision': 0.4103061339759762, 'recall': 0.5557312252964427, 'f1-score': 0.47207269655254575, 'support': 39215}, 'accuracy': 0.4093011572309611, 'macro avg': {'precision': 0.44395480547366944, 'recall': 0.4059855464632494, 'f1-score': 0.3534441736389158, 'support': 115448}, 'weighted avg': {'precision': 0.44321075965170514, 'recall': 0.4093011572309611, 'f1-score': 0.35587398917641055, 'support': 115448}}
[[23199  1025 14295]
 [18427  2261 17026]
 [16373  1049 21793]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0813788
{'0': {'precision': 0.38849325337331336, 'recall': 0.5958453096420172, 'f1-score': 0.4703298063238661, 'support': 38270}, '1': {'precision': 0.47614264188849825, 'recall': 0.049939419480587895, 'f1-score': 0.09039763516735005, 'support': 37966}, '2': {'precision': 0.402671972711768, 'recall': 0.5419004386412323, 'f1-score': 0.4620251788393381, 'support': 39212}, 'accuracy': 0.3979973667798489, 'macro avg': {'precision': 0.4224359559911932, 'recall': 0.3958950559212791, 'f1-score': 0.34091754011018477, 'support': 115448}, 'weighted avg': {'precision': 0.422133269892153, 'recall': 0.3979973667798489, 'f1-score': 0.3425653940945369, 'support': 115448}}
[[22803  1021 14446]
 [18995  1896 17075]
 [16898  1065 21249]]
Evaluating performance on  val set...
177/177 - 2s - 2s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0925957
{'0': {'precision': 0.33832918270319223, 'recall': 0.6257432375847919, 'f1-score': 0.4391935578675131, 'support': 11941}, '1': {'precision': 0.5789886319090553, 'recall': 0.07136989611017154, 'f1-score': 0.12707562591413576, 'support': 20695}, '2': {'precision': 0.3448528335041734, 'recall': 0.565788419956755, 'f1-score': 0.42851943955843996, 'support': 12487}, 'accuracy': 0.3548966159164949, 'macro avg': {'precision': 0.42072354937214024, 'recall': 0.42096718455057286, 'f1-score': 0.3315962077800296, 'support': 45123}, 'weighted avg': {'precision': 0.4505094040729413, 'recall': 0.3548966159164949, 'f1-score': 0.29309138564712567, 'support': 45123}}
[[7472  467 4002]
 [9798 1477 9420]
 [4815  607 7065]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0773455
{'0': {'precision': 0.40018107741059306, 'recall': 0.5945655098197471, 'f1-score': 0.47838086476540936, 'support': 14868}, '1': {'precision': 0.4449715370018975, 'recall': 0.06272149782681377, 'f1-score': 0.1099454961026783, 'support': 14955}, '2': {'precision': 0.4080286738351254, 'recall': 0.5580392156862745, 'f1-score': 0.47138716356107657, 'support': 15300}, 'accuracy': 0.4059127274339029, 'macro avg': {'precision': 0.4177270960825387, 'recall': 0.40510874111094514, 'f1-score': 0.3532378414763881, 'support': 45123}, 'weighted avg': {'precision': 0.4176867740283557, 'recall': 0.4059127274339029, 'f1-score': 0.35389990014033046, 'support': 45123}}
[[8840  546 5482]
 [7112  938 6905]
 [6138  624 8538]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0800463
{'0': {'precision': 0.4030373831775701, 'recall': 0.5864278242677824, 'f1-score': 0.47773753728163615, 'support': 15296}, '1': {'precision': 0.4235166031573217, 'recall': 0.053364428287262504, 'f1-score': 0.09478557504873295, 'support': 14579}, '2': {'precision': 0.4049453162149311, 'recall': 0.5584994753410283, 'f1-score': 0.4694856386790892, 'support': 15248}, 'accuracy': 0.40476032178711524, 'macro avg': {'precision': 0.4104997675166076, 'recall': 0.39943057596535775, 'f1-score': 0.3473362503364861, 'support': 45123}, 'weighted avg': {'precision': 0.41029883988564525, 'recall': 0.40476032178711524, 'f1-score': 0.3512193180301429, 'support': 45123}}
[[8970  509 5817]
 [7104  778 6697]
 [6182  550 8516]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0870025
{'0': {'precision': 0.3980918571111604, 'recall': 0.5886482939632546, 'f1-score': 0.47497021839841164, 'support': 15240}, '1': {'precision': 0.43337408312958436, 'recall': 0.047481918028395395, 'f1-score': 0.0855866731047803, 'support': 14932}, '2': {'precision': 0.3912752959144712, 'recall': 0.5483245267875059, 'f1-score': 0.4566749296716152, 'support': 14951}, 'accuracy': 0.3962059260244221, 'macro avg': {'precision': 0.4075804120517386, 'recall': 0.39481824625971856, 'f1-score': 0.33907727372493573, 'support': 45123}, 'weighted avg': {'precision': 0.40750877957764997, 'recall': 0.3962059260244221, 'f1-score': 0.34005436705699293, 'support': 45123}}
[[8971  455 5814]
 [7283  709 6940]
 [6281  472 8198]]
training model: results/XRAY/W0/deepLOB_L2/seq2seq
Epoch 1/50
451/451 - 31s - loss: 13.1019 - accuracy10: 0.3914 - accuracy20: 0.3926 - accuracy30: 0.3879 - accuracy50: 0.3753 - val_loss: 12.8581 - val_accuracy10: 0.4028 - val_accuracy20: 0.4283 - val_accuracy30: 0.4194 - val_accuracy50: 0.3968 - 31s/epoch - 68ms/step
Epoch 2/50
451/451 - 26s - loss: 12.6563 - accuracy10: 0.4360 - accuracy20: 0.4493 - accuracy30: 0.4364 - accuracy50: 0.4122 - val_loss: 12.6951 - val_accuracy10: 0.4470 - val_accuracy20: 0.4503 - val_accuracy30: 0.4367 - val_accuracy50: 0.4100 - 26s/epoch - 57ms/step
Epoch 3/50
451/451 - 24s - loss: 12.4820 - accuracy10: 0.4604 - accuracy20: 0.4667 - accuracy30: 0.4523 - accuracy50: 0.4234 - val_loss: 12.5752 - val_accuracy10: 0.4510 - val_accuracy20: 0.4596 - val_accuracy30: 0.4457 - val_accuracy50: 0.4151 - 24s/epoch - 54ms/step
Epoch 4/50
451/451 - 24s - loss: 12.3740 - accuracy10: 0.4750 - accuracy20: 0.4772 - accuracy30: 0.4619 - accuracy50: 0.4303 - val_loss: 12.5691 - val_accuracy10: 0.4518 - val_accuracy20: 0.4604 - val_accuracy30: 0.4463 - val_accuracy50: 0.4171 - 24s/epoch - 54ms/step
Epoch 5/50
451/451 - 25s - loss: 12.2918 - accuracy10: 0.4856 - accuracy20: 0.4855 - accuracy30: 0.4674 - accuracy50: 0.4363 - val_loss: 12.5576 - val_accuracy10: 0.4680 - val_accuracy20: 0.4671 - val_accuracy30: 0.4492 - val_accuracy50: 0.4163 - 25s/epoch - 54ms/step
Epoch 6/50
451/451 - 24s - loss: 12.2339 - accuracy10: 0.4897 - accuracy20: 0.4889 - accuracy30: 0.4712 - accuracy50: 0.4370 - val_loss: 12.5883 - val_accuracy10: 0.4482 - val_accuracy20: 0.4616 - val_accuracy30: 0.4471 - val_accuracy50: 0.4171 - 24s/epoch - 54ms/step
Epoch 7/50
451/451 - 24s - loss: 12.1759 - accuracy10: 0.4978 - accuracy20: 0.4950 - accuracy30: 0.4760 - accuracy50: 0.4415 - val_loss: 12.6984 - val_accuracy10: 0.4394 - val_accuracy20: 0.4573 - val_accuracy30: 0.4419 - val_accuracy50: 0.4134 - 24s/epoch - 53ms/step
Epoch 8/50
451/451 - 24s - loss: 12.1105 - accuracy10: 0.5015 - accuracy20: 0.4997 - accuracy30: 0.4812 - accuracy50: 0.4463 - val_loss: 12.6547 - val_accuracy10: 0.4484 - val_accuracy20: 0.4626 - val_accuracy30: 0.4456 - val_accuracy50: 0.4153 - 24s/epoch - 54ms/step
Epoch 9/50
451/451 - 24s - loss: 12.0637 - accuracy10: 0.5067 - accuracy20: 0.5032 - accuracy30: 0.4835 - accuracy50: 0.4487 - val_loss: 12.6286 - val_accuracy10: 0.4513 - val_accuracy20: 0.4632 - val_accuracy30: 0.4461 - val_accuracy50: 0.4162 - 24s/epoch - 53ms/step
Epoch 10/50
451/451 - 24s - loss: 12.0253 - accuracy10: 0.5110 - accuracy20: 0.5074 - accuracy30: 0.4876 - accuracy50: 0.4503 - val_loss: 12.7676 - val_accuracy10: 0.4403 - val_accuracy20: 0.4599 - val_accuracy30: 0.4420 - val_accuracy50: 0.4121 - 24s/epoch - 53ms/step
Epoch 11/50
451/451 - 24s - loss: 11.9706 - accuracy10: 0.5152 - accuracy20: 0.5116 - accuracy30: 0.4927 - accuracy50: 0.4551 - val_loss: 12.7557 - val_accuracy10: 0.4556 - val_accuracy20: 0.4630 - val_accuracy30: 0.4456 - val_accuracy50: 0.4138 - 24s/epoch - 54ms/step
Epoch 12/50
451/451 - 24s - loss: 11.9244 - accuracy10: 0.5184 - accuracy20: 0.5145 - accuracy30: 0.4952 - accuracy50: 0.4576 - val_loss: 12.8975 - val_accuracy10: 0.4442 - val_accuracy20: 0.4569 - val_accuracy30: 0.4398 - val_accuracy50: 0.4095 - 24s/epoch - 53ms/step
Epoch 13/50
451/451 - 24s - loss: 11.8919 - accuracy10: 0.5198 - accuracy20: 0.5176 - accuracy30: 0.4995 - accuracy50: 0.4609 - val_loss: 12.8553 - val_accuracy10: 0.4416 - val_accuracy20: 0.4561 - val_accuracy30: 0.4400 - val_accuracy50: 0.4083 - 24s/epoch - 53ms/step
Epoch 14/50
451/451 - 24s - loss: 11.8553 - accuracy10: 0.5234 - accuracy20: 0.5195 - accuracy30: 0.5013 - accuracy50: 0.4626 - val_loss: 12.9091 - val_accuracy10: 0.4407 - val_accuracy20: 0.4583 - val_accuracy30: 0.4388 - val_accuracy50: 0.4084 - 24s/epoch - 53ms/step
Epoch 15/50
451/451 - 24s - loss: 11.8003 - accuracy10: 0.5258 - accuracy20: 0.5241 - accuracy30: 0.5056 - accuracy50: 0.4670 - val_loss: 12.9243 - val_accuracy10: 0.4453 - val_accuracy20: 0.4594 - val_accuracy30: 0.4402 - val_accuracy50: 0.4104 - 24s/epoch - 53ms/step
testing model: results/XRAY/W0/deepLOB_L2/seq2seq
Evaluating performance on  test set...
1625/1625 - 33s - 33s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0177802
{'0': {'precision': 0.4316074787033964, 'recall': 0.3651671721142686, 'f1-score': 0.39561721071258354, 'support': 106836}, '1': {'precision': 0.642353458004802, 'recall': 0.4267627463215314, 'f1-score': 0.5128208229151234, 'support': 198724}, '2': {'precision': 0.3843688286443955, 'recall': 0.6741257219537405, 'f1-score': 0.48958762038027814, 'support': 110291}, 'accuracy': 0.47654328112713445, 'macro avg': {'precision': 0.48610992178419793, 'recall': 0.4886852134631801, 'f1-score': 0.46600855133599506, 'support': 415851}, 'weighted avg': {'precision': 0.5197887889251712, 'recall': 0.47654328112713445, 'f1-score': 0.4765482679518284, 'support': 415851}}
[[39013 25542 42281]
 [37113 84808 76803]
 [14264 21677 74350]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.025232
{'0': {'precision': 0.4955446577629382, 'recall': 0.35622243557048994, 'f1-score': 0.4144891867832644, 'support': 133324}, '1': {'precision': 0.5093238676424109, 'recall': 0.43242852719578906, 'f1-score': 0.4677368938108422, 'support': 145335}, '2': {'precision': 0.44684108270860246, 'recall': 0.6403944836433612, 'f1-score': 0.5263892633534046, 'support': 137192}, 'accuracy': 0.47660580352097265, 'macro avg': {'precision': 0.48390320270465054, 'recall': 0.47634848213654674, 'f1-score': 0.46953844798250377, 'support': 415851}, 'weighted avg': {'precision': 0.4842926963608465, 'recall': 0.47660580352097265, 'f1-score': 0.4700152064529627, 'support': 415851}}
[[47493 31843 53988]
 [27715 62847 54773]
 [20632 28703 87857]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0398066
{'0': {'precision': 0.4898176627867238, 'recall': 0.35522670943286194, 'f1-score': 0.41180397691261106, 'support': 137180}, '1': {'precision': 0.47369696340334205, 'recall': 0.3935792349726776, 'f1-score': 0.4299375188994529, 'support': 139080}, '2': {'precision': 0.4391458507629178, 'recall': 0.6317312720734145, 'f1-score': 0.5181213810851384, 'support': 139591}, 'accuracy': 0.46086939793339443, 'macro avg': {'precision': 0.4675534923176612, 'recall': 0.4601790721596513, 'f1-score': 0.45328762563240077, 'support': 415851}, 'weighted avg': {'precision': 0.4674168610994468, 'recall': 0.46086939793339443, 'f1-score': 0.45355683018307863, 'support': 415851}}
[[48730 32020 56430]
 [28147 54739 56194]
 [22609 28798 88184]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0664916
{'0': {'precision': 0.45784873650140057, 'recall': 0.3400001470080193, 'f1-score': 0.39022085744655727, 'support': 136047}, '1': {'precision': 0.43279257331635385, 'recall': 0.333397311495454, 'f1-score': 0.3766478342749529, 'support': 140673}, '2': {'precision': 0.41568179176192505, 'recall': 0.616828744133227, 'f1-score': 0.4966622008351009, 'support': 139131}, 'accuracy': 0.4303849215223722, 'macro avg': {'precision': 0.43544103385989313, 'recall': 0.43007540087890006, 'f1-score': 0.421176964185537, 'support': 415851}, 'weighted avg': {'precision': 0.43526503504997194, 'recall': 0.4303849215223722, 'f1-score': 0.4212414216832006, 'support': 415851}}
[[46256 32033 57758]
 [30895 46900 62878]
 [23878 29433 85820]]
Evaluating performance on  train set...
451/451 - 9s - 9s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.053722
{'0': {'precision': 0.4329069728405009, 'recall': 0.41630347054075867, 'f1-score': 0.42444290839669535, 'support': 30975}, '1': {'precision': 0.6646466956322891, 'recall': 0.3291868015705225, 'f1-score': 0.4403009569015578, 'support': 52976}, '2': {'precision': 0.37352965923432896, 'recall': 0.70468903774723, 'f1-score': 0.48825392635607756, 'support': 31499}, 'accuracy': 0.4550108271979212, 'macro avg': {'precision': 0.4903611092357063, 'recall': 0.4833931032861704, 'f1-score': 0.4509992638847769, 'support': 115450}, 'weighted avg': {'precision': 0.5230439806649874, 'recall': 0.4550108271979212, 'f1-score': 0.4491296059479831, 'support': 115450}}
[[12895  4809 13271]
 [11580 17439 23957]
 [ 5312  3990 22197]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0313971
{'0': {'precision': 0.48745680276462305, 'recall': 0.40120091648889944, 'f1-score': 0.4401427271282666, 'support': 37971}, '1': {'precision': 0.5395160624329012, 'recall': 0.3369783875793057, 'f1-score': 0.41484632969265933, 'support': 38774}, '2': {'precision': 0.4333444481493831, 'recall': 0.671541144554967, 'f1-score': 0.5267669858641131, 'support': 38705}, 'accuracy': 0.47026418362927674, 'macro avg': {'precision': 0.48677243778230245, 'recall': 0.46990681620772407, 'f1-score': 0.4605853475616797, 'support': 115450}, 'weighted avg': {'precision': 0.48679960959870666, 'recall': 0.47026418362927674, 'f1-score': 0.46068797979351306, 'support': 115450}}
[[15234  5953 16784]
 [ 8504 13066 17204]
 [ 7514  5199 25992]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0453047
{'0': {'precision': 0.4735261923377639, 'recall': 0.39301752109020116, 'f1-score': 0.42953191489361703, 'support': 38525}, '1': {'precision': 0.505190928129038, 'recall': 0.3009902041466458, 'f1-score': 0.3772291722118712, 'support': 37669}, '2': {'precision': 0.4261698780967361, 'recall': 0.6625738740574689, 'f1-score': 0.5187061263560944, 'support': 39256}, 'accuracy': 0.4546470333477696, 'macro avg': {'precision': 0.46829566618784596, 'recall': 0.4521938664314386, 'f1-score': 0.4418224044871942, 'support': 115450}, 'weighted avg': {'precision': 0.4677553777918628, 'recall': 0.4546470333477696, 'f1-score': 0.44278813690394464, 'support': 115450}}
[[15141  5936 17448]
 [ 8757 11338 17574]
 [ 8077  5169 26010]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0718374
{'0': {'precision': 0.44084873975956557, 'recall': 0.3667867961976392, 'f1-score': 0.40042194694302297, 'support': 38292}, '1': {'precision': 0.4538025189885588, 'recall': 0.24890576385592997, 'f1-score': 0.32148208690914043, 'support': 37926}, '2': {'precision': 0.40581949067511824, 'recall': 0.6494953099510603, 'f1-score': 0.49952460767881124, 'support': 39232}, 'accuracy': 0.42413165872672154, 'macro avg': {'precision': 0.43349024980774753, 'recall': 0.4217292900015432, 'f1-score': 0.4071428805103248, 'support': 115450}, 'weighted avg': {'precision': 0.4332005589969649, 'recall': 0.42413165872672154, 'f1-score': 0.4081666195661622, 'support': 115450}}
[[14045  5989 18258]
 [ 9436  9440 19050]
 [ 8378  5373 25481]]
Evaluating performance on  val set...
177/177 - 4s - 4s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0263052
{'0': {'precision': 0.45549738219895286, 'recall': 0.3936981479929607, 'f1-score': 0.4223490807749359, 'support': 11933}, '1': {'precision': 0.6184798807749627, 'recall': 0.4011405925281523, 'f1-score': 0.4866465363079358, 'support': 20691}, '2': {'precision': 0.38449670391322643, 'recall': 0.6579726378110249, 'f1-score': 0.485363550519358, 'support': 12499}, 'accuracy': 0.4703144737716907, 'macro avg': {'precision': 0.48615798896238066, 'recall': 0.48427045944404595, 'f1-score': 0.46478638920074317, 'support': 45123}, 'weighted avg': {'precision': 0.5105653829999396, 'recall': 0.4703144737716907, 'f1-score': 0.4692873718852085, 'support': 45123}}
[[4698 2829 4406]
 [3632 8300 8759]
 [1984 2291 8224]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.035158
{'0': {'precision': 0.5047566776436151, 'recall': 0.37133243606998656, 'f1-score': 0.42788461538461536, 'support': 14860}, '1': {'precision': 0.4809837934685235, 'recall': 0.39565887318282306, 'f1-score': 0.43416893332353157, 'support': 14927}, '2': {'precision': 0.4413106973347937, 'recall': 0.6305425143453313, 'f1-score': 0.5192225085910653, 'support': 15336}, 'accuracy': 0.46747778294882875, 'macro avg': {'precision': 0.4756837228156441, 'recall': 0.465844607866047, 'f1-score': 0.46042535243307076, 'support': 45123}, 'weighted avg': {'precision': 0.47532899340059764, 'recall': 0.46747778294882875, 'f1-score': 0.4610066140125505, 'support': 45123}}
[[5518 3456 5886]
 [2665 5906 6356]
 [2749 2917 9670]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0516329
{'0': {'precision': 0.49756400035432724, 'recall': 0.3670522119845782, 'f1-score': 0.4224578820697955, 'support': 15303}, '1': {'precision': 0.45021721783846086, 'recall': 0.3488116499519165, 'f1-score': 0.393079691914696, 'support': 14558}, '2': {'precision': 0.4250942141432055, 'recall': 0.6282269689424715, 'f1-score': 0.507073538355766, 'support': 15262}, 'accuracy': 0.44950468718835185, 'macro avg': {'precision': 0.45762514411199784, 'recall': 0.4480302769596554, 'f1-score': 0.4408703707800858, 'support': 45123}, 'weighted avg': {'precision': 0.4577770106368855, 'recall': 0.44950468718835185, 'f1-score': 0.4415992612768194, 'support': 45123}}
[[5617 3392 6294]
 [2807 5078 6673]
 [2865 2809 9588]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0763701
{'0': {'precision': 0.4550719550719551, 'recall': 0.3401101783840504, 'f1-score': 0.38928088875544214, 'support': 15248}, '1': {'precision': 0.4091438555620268, 'recall': 0.2834375630421626, 'f1-score': 0.33488261232272676, 'support': 14871}, '2': {'precision': 0.4004268943436499, 'recall': 0.6251666222340709, 'f1-score': 0.4881729943532228, 'support': 15004}, 'accuracy': 0.4162178933138311, 'macro avg': {'precision': 0.4215475683258773, 'recall': 0.41623812122009457, 'f1-score': 0.40411216514379716, 'support': 45123}, 'weighted avg': {'precision': 0.42176540943049434, 'recall': 0.4162178933138311, 'f1-score': 0.4042360199204398, 'support': 45123}}
[[5186 3369 6693]
 [3304 4215 7352]
 [2906 2718 9380]]
training model: results/XRAY/W0/deepOF_L2/seq2seq
Epoch 1/50
451/451 - 21s - loss: 12.8282 - accuracy10: 0.4218 - accuracy20: 0.4175 - accuracy30: 0.4052 - accuracy50: 0.3853 - val_loss: 12.6483 - val_accuracy10: 0.4151 - val_accuracy20: 0.4350 - val_accuracy30: 0.4248 - val_accuracy50: 0.4068 - 21s/epoch - 46ms/step
Epoch 2/50
451/451 - 16s - loss: 12.4364 - accuracy10: 0.4807 - accuracy20: 0.4649 - accuracy30: 0.4461 - accuracy50: 0.4143 - val_loss: 12.4263 - val_accuracy10: 0.4724 - val_accuracy20: 0.4644 - val_accuracy30: 0.4439 - val_accuracy50: 0.4167 - 16s/epoch - 35ms/step
Epoch 3/50
451/451 - 16s - loss: 12.2581 - accuracy10: 0.5046 - accuracy20: 0.4877 - accuracy30: 0.4647 - accuracy50: 0.4256 - val_loss: 12.3222 - val_accuracy10: 0.4937 - val_accuracy20: 0.4804 - val_accuracy30: 0.4560 - val_accuracy50: 0.4232 - 16s/epoch - 35ms/step
Epoch 4/50
451/451 - 16s - loss: 12.1453 - accuracy10: 0.5140 - accuracy20: 0.4978 - accuracy30: 0.4738 - accuracy50: 0.4339 - val_loss: 12.2540 - val_accuracy10: 0.4962 - val_accuracy20: 0.4845 - val_accuracy30: 0.4610 - val_accuracy50: 0.4261 - 16s/epoch - 36ms/step
Epoch 5/50
451/451 - 16s - loss: 12.0713 - accuracy10: 0.5196 - accuracy20: 0.5048 - accuracy30: 0.4795 - accuracy50: 0.4385 - val_loss: 12.2240 - val_accuracy10: 0.5011 - val_accuracy20: 0.4879 - val_accuracy30: 0.4613 - val_accuracy50: 0.4266 - 16s/epoch - 35ms/step
Epoch 6/50
451/451 - 16s - loss: 12.0114 - accuracy10: 0.5254 - accuracy20: 0.5087 - accuracy30: 0.4853 - accuracy50: 0.4448 - val_loss: 12.1792 - val_accuracy10: 0.5085 - val_accuracy20: 0.4932 - val_accuracy30: 0.4689 - val_accuracy50: 0.4349 - 16s/epoch - 35ms/step
Epoch 7/50
451/451 - 16s - loss: 11.9637 - accuracy10: 0.5280 - accuracy20: 0.5126 - accuracy30: 0.4880 - accuracy50: 0.4460 - val_loss: 12.1421 - val_accuracy10: 0.5148 - val_accuracy20: 0.4960 - val_accuracy30: 0.4701 - val_accuracy50: 0.4357 - 16s/epoch - 35ms/step
Epoch 8/50
451/451 - 16s - loss: 11.9194 - accuracy10: 0.5307 - accuracy20: 0.5164 - accuracy30: 0.4909 - accuracy50: 0.4492 - val_loss: 12.1241 - val_accuracy10: 0.5237 - val_accuracy20: 0.4972 - val_accuracy30: 0.4712 - val_accuracy50: 0.4343 - 16s/epoch - 35ms/step
Epoch 9/50
451/451 - 15s - loss: 11.8765 - accuracy10: 0.5342 - accuracy20: 0.5188 - accuracy30: 0.4945 - accuracy50: 0.4526 - val_loss: 12.1268 - val_accuracy10: 0.5246 - val_accuracy20: 0.4983 - val_accuracy30: 0.4718 - val_accuracy50: 0.4349 - 15s/epoch - 34ms/step
Epoch 10/50
451/451 - 16s - loss: 11.8390 - accuracy10: 0.5361 - accuracy20: 0.5217 - accuracy30: 0.4969 - accuracy50: 0.4552 - val_loss: 12.1169 - val_accuracy10: 0.5244 - val_accuracy20: 0.4977 - val_accuracy30: 0.4715 - val_accuracy50: 0.4367 - 16s/epoch - 35ms/step
Epoch 11/50
451/451 - 16s - loss: 11.8019 - accuracy10: 0.5387 - accuracy20: 0.5242 - accuracy30: 0.5012 - accuracy50: 0.4577 - val_loss: 12.1005 - val_accuracy10: 0.5305 - val_accuracy20: 0.5013 - val_accuracy30: 0.4746 - val_accuracy50: 0.4374 - 16s/epoch - 35ms/step
Epoch 12/50
451/451 - 16s - loss: 11.7676 - accuracy10: 0.5404 - accuracy20: 0.5272 - accuracy30: 0.5033 - accuracy50: 0.4612 - val_loss: 12.1237 - val_accuracy10: 0.5294 - val_accuracy20: 0.4992 - val_accuracy30: 0.4735 - val_accuracy50: 0.4357 - 16s/epoch - 36ms/step
Epoch 13/50
451/451 - 16s - loss: 11.7317 - accuracy10: 0.5431 - accuracy20: 0.5308 - accuracy30: 0.5053 - accuracy50: 0.4635 - val_loss: 12.1148 - val_accuracy10: 0.5298 - val_accuracy20: 0.5007 - val_accuracy30: 0.4721 - val_accuracy50: 0.4353 - 16s/epoch - 35ms/step
Epoch 14/50
451/451 - 16s - loss: 11.7000 - accuracy10: 0.5447 - accuracy20: 0.5325 - accuracy30: 0.5078 - accuracy50: 0.4657 - val_loss: 12.1164 - val_accuracy10: 0.5273 - val_accuracy20: 0.4985 - val_accuracy30: 0.4736 - val_accuracy50: 0.4347 - 16s/epoch - 34ms/step
Epoch 15/50
451/451 - 16s - loss: 11.6695 - accuracy10: 0.5459 - accuracy20: 0.5336 - accuracy30: 0.5103 - accuracy50: 0.4679 - val_loss: 12.1240 - val_accuracy10: 0.5193 - val_accuracy20: 0.4949 - val_accuracy30: 0.4715 - val_accuracy50: 0.4347 - 16s/epoch - 35ms/step
Epoch 16/50
451/451 - 16s - loss: 11.6399 - accuracy10: 0.5477 - accuracy20: 0.5362 - accuracy30: 0.5128 - accuracy50: 0.4705 - val_loss: 12.1309 - val_accuracy10: 0.5217 - val_accuracy20: 0.4958 - val_accuracy30: 0.4694 - val_accuracy50: 0.4325 - 16s/epoch - 36ms/step
Epoch 17/50
451/451 - 16s - loss: 11.6011 - accuracy10: 0.5493 - accuracy20: 0.5383 - accuracy30: 0.5165 - accuracy50: 0.4736 - val_loss: 12.1342 - val_accuracy10: 0.5281 - val_accuracy20: 0.5000 - val_accuracy30: 0.4702 - val_accuracy50: 0.4311 - 16s/epoch - 35ms/step
Epoch 18/50
451/451 - 16s - loss: 11.5724 - accuracy10: 0.5512 - accuracy20: 0.5422 - accuracy30: 0.5187 - accuracy50: 0.4780 - val_loss: 12.1496 - val_accuracy10: 0.5226 - val_accuracy20: 0.4971 - val_accuracy30: 0.4708 - val_accuracy50: 0.4343 - 16s/epoch - 36ms/step
Epoch 19/50
451/451 - 16s - loss: 11.5300 - accuracy10: 0.5524 - accuracy20: 0.5442 - accuracy30: 0.5232 - accuracy50: 0.4799 - val_loss: 12.2219 - val_accuracy10: 0.5169 - val_accuracy20: 0.4913 - val_accuracy30: 0.4654 - val_accuracy50: 0.4275 - 16s/epoch - 35ms/step
Epoch 20/50
451/451 - 16s - loss: 11.4985 - accuracy10: 0.5533 - accuracy20: 0.5467 - accuracy30: 0.5254 - accuracy50: 0.4831 - val_loss: 12.2312 - val_accuracy10: 0.5159 - val_accuracy20: 0.4905 - val_accuracy30: 0.4652 - val_accuracy50: 0.4268 - 16s/epoch - 36ms/step
Epoch 21/50
451/451 - 16s - loss: 11.4603 - accuracy10: 0.5534 - accuracy20: 0.5493 - accuracy30: 0.5294 - accuracy50: 0.4859 - val_loss: 12.2694 - val_accuracy10: 0.5086 - val_accuracy20: 0.4900 - val_accuracy30: 0.4641 - val_accuracy50: 0.4284 - 16s/epoch - 35ms/step
testing model: results/XRAY/W0/deepOF_L2/seq2seq
Evaluating performance on  test set...
1625/1625 - 24s - 24s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9255138
{'0': {'precision': 0.4884067736697339, 'recall': 0.41386088568139057, 'f1-score': 0.4480543169841913, 'support': 106833}, '1': {'precision': 0.6457038139058298, 'recall': 0.6595781083311527, 'f1-score': 0.6525672237738912, 'support': 198724}, '2': {'precision': 0.45750255466993667, 'recall': 0.5074304781075175, 'f1-score': 0.4811748218078018, 'support': 110289}, 'accuracy': 0.5561000947466129, 'macro avg': {'precision': 0.5305377140818335, 'recall': 0.5269564907066869, 'f1-score': 0.5272654541886281, 'support': 415846}, 'weighted avg': {'precision': 0.5553794068430944, 'recall': 0.5561000947466129, 'f1-score': 0.5545707924230978, 'support': 415846}}
[[ 44214  36162  26457]
 [ 27746 131074  39904]
 [ 18567  35758  55964]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9781304
{'0': {'precision': 0.5289961366031031, 'recall': 0.38411053022404573, 'f1-score': 0.4450585980784523, 'support': 133321}, '1': {'precision': 0.5067933340409723, 'recall': 0.6570337496129631, 'f1-score': 0.5722161465745832, 'support': 145335}, '2': {'precision': 0.5066375746440055, 'recall': 0.4823748086595233, 'f1-score': 0.494208580710205, 'support': 137190}, 'accuracy': 0.5119130639707968, 'macro avg': {'precision': 0.5141423484293602, 'recall': 0.5078396961655107, 'f1-score': 0.5038277751210801, 'support': 415846}, 'weighted avg': {'precision': 0.5138602078565577, 'recall': 0.5119130639707968, 'f1-score': 0.5057140532900819, 'support': 415846}}
[[51210 46790 35321]
 [20723 95490 29122]
 [24873 46140 66177]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0076349
{'0': {'precision': 0.5067848321952637, 'recall': 0.38142413506538947, 'f1-score': 0.43525785802523054, 'support': 137178}, '1': {'precision': 0.4732156819590286, 'recall': 0.5874646783482769, 'f1-score': 0.5241871327020299, 'support': 139079}, '2': {'precision': 0.4864588692619905, 'recall': 0.48769602189284256, 'f1-score': 0.4870766600007871, 'support': 139589}, 'accuracy': 0.48600683907023273, 'macro avg': {'precision': 0.4888197944720942, 'recall': 0.485528278435503, 'f1-score': 0.48217388357601587, 'support': 415846}, 'weighted avg': {'precision': 0.48873477355432926, 'recall': 0.48600683907023273, 'f1-score': 0.48239436851647133, 'support': 415846}}
[[52323 46432 38423]
 [23931 81704 33444]
 [26991 44521 68077]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0473357
{'0': {'precision': 0.45681920345230603, 'recall': 0.3734940644639641, 'f1-score': 0.4109756344151248, 'support': 136045}, '1': {'precision': 0.4316411325849534, 'recall': 0.48408698310241627, 'f1-score': 0.45636221074006317, 'support': 140671}, '2': {'precision': 0.4559865988437417, 'recall': 0.481298066556458, 'f1-score': 0.46830056332019737, 'support': 139130}, 'accuracy': 0.446973158332652, 'macro avg': {'precision': 0.448148978293667, 'recall': 0.44629303804094606, 'f1-score': 0.4452128028251285, 'support': 415846}, 'weighted avg': {'precision': 0.4480234841567713, 'recall': 0.446973158332652, 'f1-score': 0.44550811143009705, 'support': 415846}}
[[50812 46349 38884]
 [31568 68097 41006]
 [28850 43317 66963]]
Evaluating performance on  train set...
451/451 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9429149
{'0': {'precision': 0.4756665390993749, 'recall': 0.48189073050951503, 'f1-score': 0.47875840595759706, 'support': 30951}, '1': {'precision': 0.6649679210083269, 'recall': 0.5514612931831475, 'f1-score': 0.6029188798927337, 'support': 53001}, '2': {'precision': 0.45453186506552395, 'recall': 0.579248158496317, 'f1-score': 0.509367060334478, 'support': 31496}, 'accuracy': 0.5403904788302959, 'macro avg': {'precision': 0.5317221083910753, 'recall': 0.5375333940629932, 'f1-score': 0.5303481153949362, 'support': 115448}, 'weighted avg': {'precision': 0.5568070079614271, 'recall': 0.5403904788302959, 'f1-score': 0.5441097282610621, 'support': 115448}}
[[14915  7432  8604]
 [10483 29228 13290]
 [ 5958  7294 18244]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9686369
{'0': {'precision': 0.5184052757793765, 'recall': 0.45586103276484696, 'f1-score': 0.4851256013577009, 'support': 37937}, '1': {'precision': 0.5366476764683341, 'recall': 0.5416290642807415, 'f1-score': 0.539126863947848, 'support': 38783}, '2': {'precision': 0.5028059145418559, 'recall': 0.5575552571782689, 'f1-score': 0.5287671568327356, 'support': 38728}, 'accuracy': 0.5187876793015037, 'macro avg': {'precision': 0.5192862889298554, 'recall': 0.5183484514079525, 'f1-score': 0.5176732073794281, 'support': 115448}, 'weighted avg': {'precision': 0.5193005963038823, 'recall': 0.5187876793015037, 'f1-score': 0.5179064301938073, 'support': 115448}}
[[17294  9163 11480]
 [ 7905 21006  9872]
 [ 8161  8974 21593]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.99899346
{'0': {'precision': 0.49468797174513657, 'recall': 0.4508943638204522, 'f1-score': 0.4717770413429674, 'support': 38519}, '1': {'precision': 0.5096911051056287, 'recall': 0.4650792809036432, 'f1-score': 0.4863643295853148, 'support': 37714}, '2': {'precision': 0.48247180246483473, 'recall': 0.5650388881805432, 'f1-score': 0.520501286101878, 'support': 39215}, 'accuracy': 0.4943004642782898, 'macro avg': {'precision': 0.49561695977186665, 'recall': 0.4936708443015461, 'f1-score': 0.4928808856767201, 'support': 115448}, 'weighted avg': {'precision': 0.49543957500574354, 'recall': 0.4943004642782898, 'f1-score': 0.4930928393385374, 'support': 115448}}
[[17368  8677 12474]
 [ 8880 17540 11294]
 [ 8861  8196 22158]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0418404
{'0': {'precision': 0.4517946634159556, 'recall': 0.43579827541154953, 'f1-score': 0.4436523242668085, 'support': 38270}, '1': {'precision': 0.4561277236144736, 'recall': 0.3672233050624243, 'f1-score': 0.4068756201482519, 'support': 37966}, '2': {'precision': 0.44837075489398964, 'recall': 0.5484800571253697, 'f1-score': 0.49339863958063296, 'support': 39212}, 'accuracy': 0.4515192987318966, 'macro avg': {'precision': 0.4520977139748063, 'recall': 0.4505005458664478, 'f1-score': 0.44797552799856444, 'support': 115448}, 'weighted avg': {'precision': 0.45205669188360864, 'recall': 0.4515192987318966, 'f1-score': 0.44845438378729013, 'support': 115448}}
[[16678  8567 13025]
 [10589 13942 13435]
 [ 9648  8057 21507]]
Evaluating performance on  val set...
177/177 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9570949
{'0': {'precision': 0.4646118721461187, 'recall': 0.47717946570638975, 'f1-score': 0.4708118157405495, 'support': 11941}, '1': {'precision': 0.636863299956465, 'recall': 0.565498912780865, 'f1-score': 0.5990632438381408, 'support': 20695}, '2': {'precision': 0.4570185734999655, 'recall': 0.5300712741250901, 'f1-score': 0.4908416759362255, 'support': 12487}, 'accuracy': 0.5323227622276888, 'macro avg': {'precision': 0.5194979152008498, 'recall': 0.5242498842041149, 'f1-score': 0.5202389118383053, 'support': 45123}, 'weighted avg': {'precision': 0.5415111425479227, 'recall': 0.5323227622276888, 'f1-score': 0.535175359138441, 'support': 45123}}
[[ 5698  3264  2979]
 [ 4107 11703  4885]
 [ 2459  3409  6619]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9909421
{'0': {'precision': 0.5106480073014907, 'recall': 0.4515738498789346, 'f1-score': 0.47929754426042265, 'support': 14868}, '1': {'precision': 0.4954570400634185, 'recall': 0.5432965563356736, 'f1-score': 0.5182751802002934, 'support': 14955}, '2': {'precision': 0.4997431946584489, 'recall': 0.5087581699346405, 'f1-score': 0.5042103899468844, 'support': 15300}, 'accuracy': 0.501362941293797, 'macro avg': {'precision': 0.501949414007786, 'recall': 0.5012095253830829, 'f1-score': 0.5005943714692002, 'support': 45123}, 'weighted avg': {'precision': 0.5019157743275326, 'recall': 0.501362941293797, 'f1-score': 0.5006630803392212, 'support': 45123}}
[[6714 4063 4091]
 [3129 8125 3701]
 [3305 4211 7784]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0194151
{'0': {'precision': 0.48835718863490707, 'recall': 0.44835251046025104, 'f1-score': 0.4675005964756808, 'support': 15296}, '1': {'precision': 0.46702679949487863, 'recall': 0.4566156800877975, 'f1-score': 0.4617625637290605, 'support': 14579}, '2': {'precision': 0.4677879472245335, 'recall': 0.5161988457502623, 'f1-score': 0.49080251917440915, 'support': 15248}, 'accuracy': 0.4739489838884826, 'macro avg': {'precision': 0.47439064511810636, 'recall': 0.4737223454327703, 'f1-score': 0.4733552264597168, 'support': 45123}, 'weighted avg': {'precision': 0.4745146795752733, 'recall': 0.4739489838884826, 'f1-score': 0.47352087300643525, 'support': 45123}}
[[6858 3804 4634]
 [3601 6657 4321]
 [3584 3793 7871]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0562919
{'0': {'precision': 0.44827124095416776, 'recall': 0.4389763779527559, 'f1-score': 0.4435751226627769, 'support': 15240}, '1': {'precision': 0.42721798474508227, 'recall': 0.3563487811411733, 'f1-score': 0.388578522656735, 'support': 14932}, '2': {'precision': 0.4299481514878269, 'recall': 0.5102668717811517, 'f1-score': 0.4666768619054902, 'support': 14951}, 'accuracy': 0.43525474813288123, 'macro avg': {'precision': 0.4351457923956923, 'recall': 0.435197343625027, 'f1-score': 0.43294350240833407, 'support': 45123}, 'weighted avg': {'precision': 0.43523319533828836, 'recall': 0.43525474813288123, 'f1-score': 0.43303027573610064, 'support': 45123}}
[[6690 3638 4912]
 [4408 5321 5203]
 [3826 3496 7629]]
training model: results/XRAY/W0/deepVOL_L2/seq2seq
Epoch 1/50
451/451 - 21s - loss: 12.9683 - accuracy10: 0.3989 - accuracy20: 0.4095 - accuracy30: 0.4020 - accuracy50: 0.3848 - val_loss: 12.7590 - val_accuracy10: 0.3970 - val_accuracy20: 0.4326 - val_accuracy30: 0.4239 - val_accuracy50: 0.4006 - 21s/epoch - 47ms/step
Epoch 2/50
451/451 - 16s - loss: 12.5655 - accuracy10: 0.4588 - accuracy20: 0.4594 - accuracy30: 0.4447 - accuracy50: 0.4149 - val_loss: 12.5128 - val_accuracy10: 0.4521 - val_accuracy20: 0.4666 - val_accuracy30: 0.4486 - val_accuracy50: 0.4165 - 16s/epoch - 35ms/step
Epoch 3/50
451/451 - 15s - loss: 12.4028 - accuracy10: 0.4798 - accuracy20: 0.4766 - accuracy30: 0.4590 - accuracy50: 0.4230 - val_loss: 12.4067 - val_accuracy10: 0.4747 - val_accuracy20: 0.4790 - val_accuracy30: 0.4598 - val_accuracy50: 0.4216 - 15s/epoch - 34ms/step
Epoch 4/50
451/451 - 15s - loss: 12.3104 - accuracy10: 0.4920 - accuracy20: 0.4867 - accuracy30: 0.4675 - accuracy50: 0.4278 - val_loss: 12.3663 - val_accuracy10: 0.4953 - val_accuracy20: 0.4821 - val_accuracy30: 0.4626 - val_accuracy50: 0.4233 - 15s/epoch - 34ms/step
Epoch 5/50
451/451 - 16s - loss: 12.2389 - accuracy10: 0.5012 - accuracy20: 0.4935 - accuracy30: 0.4739 - accuracy50: 0.4337 - val_loss: 12.3163 - val_accuracy10: 0.5048 - val_accuracy20: 0.4891 - val_accuracy30: 0.4684 - val_accuracy50: 0.4279 - 16s/epoch - 34ms/step
Epoch 6/50
451/451 - 15s - loss: 12.1665 - accuracy10: 0.5067 - accuracy20: 0.4981 - accuracy30: 0.4769 - accuracy50: 0.4377 - val_loss: 12.3139 - val_accuracy10: 0.5108 - val_accuracy20: 0.4891 - val_accuracy30: 0.4678 - val_accuracy50: 0.4281 - 15s/epoch - 33ms/step
Epoch 7/50
451/451 - 15s - loss: 12.1259 - accuracy10: 0.5100 - accuracy20: 0.5022 - accuracy30: 0.4813 - accuracy50: 0.4402 - val_loss: 12.3052 - val_accuracy10: 0.5081 - val_accuracy20: 0.4896 - val_accuracy30: 0.4687 - val_accuracy50: 0.4284 - 15s/epoch - 34ms/step
Epoch 8/50
451/451 - 15s - loss: 12.0794 - accuracy10: 0.5147 - accuracy20: 0.5058 - accuracy30: 0.4843 - accuracy50: 0.4439 - val_loss: 12.2861 - val_accuracy10: 0.5078 - val_accuracy20: 0.4917 - val_accuracy30: 0.4702 - val_accuracy50: 0.4302 - 15s/epoch - 34ms/step
Epoch 9/50
451/451 - 15s - loss: 12.0362 - accuracy10: 0.5192 - accuracy20: 0.5095 - accuracy30: 0.4868 - accuracy50: 0.4453 - val_loss: 12.2719 - val_accuracy10: 0.5165 - val_accuracy20: 0.4967 - val_accuracy30: 0.4747 - val_accuracy50: 0.4303 - 15s/epoch - 34ms/step
Epoch 10/50
451/451 - 15s - loss: 11.9930 - accuracy10: 0.5242 - accuracy20: 0.5132 - accuracy30: 0.4911 - accuracy50: 0.4486 - val_loss: 12.2663 - val_accuracy10: 0.5155 - val_accuracy20: 0.4950 - val_accuracy30: 0.4716 - val_accuracy50: 0.4297 - 15s/epoch - 34ms/step
Epoch 11/50
451/451 - 15s - loss: 11.9600 - accuracy10: 0.5261 - accuracy20: 0.5152 - accuracy30: 0.4928 - accuracy50: 0.4509 - val_loss: 12.2927 - val_accuracy10: 0.5113 - val_accuracy20: 0.4939 - val_accuracy30: 0.4698 - val_accuracy50: 0.4298 - 15s/epoch - 34ms/step
Epoch 12/50
451/451 - 16s - loss: 11.9346 - accuracy10: 0.5276 - accuracy20: 0.5177 - accuracy30: 0.4957 - accuracy50: 0.4543 - val_loss: 12.2618 - val_accuracy10: 0.5176 - val_accuracy20: 0.4952 - val_accuracy30: 0.4708 - val_accuracy50: 0.4309 - 16s/epoch - 34ms/step
Epoch 13/50
451/451 - 16s - loss: 11.9047 - accuracy10: 0.5302 - accuracy20: 0.5190 - accuracy30: 0.4971 - accuracy50: 0.4550 - val_loss: 12.2760 - val_accuracy10: 0.5181 - val_accuracy20: 0.4935 - val_accuracy30: 0.4673 - val_accuracy50: 0.4309 - 16s/epoch - 34ms/step
Epoch 14/50
451/451 - 15s - loss: 11.8708 - accuracy10: 0.5334 - accuracy20: 0.5217 - accuracy30: 0.4995 - accuracy50: 0.4575 - val_loss: 12.2641 - val_accuracy10: 0.5176 - val_accuracy20: 0.4930 - val_accuracy30: 0.4679 - val_accuracy50: 0.4285 - 15s/epoch - 34ms/step
Epoch 15/50
451/451 - 15s - loss: 11.8513 - accuracy10: 0.5355 - accuracy20: 0.5241 - accuracy30: 0.5013 - accuracy50: 0.4590 - val_loss: 12.2732 - val_accuracy10: 0.5217 - val_accuracy20: 0.4926 - val_accuracy30: 0.4674 - val_accuracy50: 0.4268 - 15s/epoch - 34ms/step
Epoch 16/50
451/451 - 15s - loss: 11.8270 - accuracy10: 0.5369 - accuracy20: 0.5263 - accuracy30: 0.5030 - accuracy50: 0.4607 - val_loss: 12.2876 - val_accuracy10: 0.5207 - val_accuracy20: 0.4918 - val_accuracy30: 0.4686 - val_accuracy50: 0.4260 - 15s/epoch - 34ms/step
Epoch 17/50
451/451 - 15s - loss: 11.8041 - accuracy10: 0.5369 - accuracy20: 0.5273 - accuracy30: 0.5065 - accuracy50: 0.4647 - val_loss: 12.2836 - val_accuracy10: 0.5153 - val_accuracy20: 0.4967 - val_accuracy30: 0.4703 - val_accuracy50: 0.4325 - 15s/epoch - 34ms/step
Epoch 18/50
451/451 - 16s - loss: 11.7799 - accuracy10: 0.5392 - accuracy20: 0.5296 - accuracy30: 0.5068 - accuracy50: 0.4641 - val_loss: 12.3315 - val_accuracy10: 0.5130 - val_accuracy20: 0.4917 - val_accuracy30: 0.4670 - val_accuracy50: 0.4262 - 16s/epoch - 35ms/step
Epoch 19/50
451/451 - 16s - loss: 11.7426 - accuracy10: 0.5410 - accuracy20: 0.5322 - accuracy30: 0.5090 - accuracy50: 0.4658 - val_loss: 12.3205 - val_accuracy10: 0.5184 - val_accuracy20: 0.4934 - val_accuracy30: 0.4677 - val_accuracy50: 0.4243 - 16s/epoch - 35ms/step
Epoch 20/50
451/451 - 15s - loss: 11.7196 - accuracy10: 0.5427 - accuracy20: 0.5344 - accuracy30: 0.5118 - accuracy50: 0.4675 - val_loss: 12.3568 - val_accuracy10: 0.5184 - val_accuracy20: 0.4911 - val_accuracy30: 0.4633 - val_accuracy50: 0.4269 - 15s/epoch - 34ms/step
Epoch 21/50
451/451 - 15s - loss: 11.6969 - accuracy10: 0.5445 - accuracy20: 0.5357 - accuracy30: 0.5135 - accuracy50: 0.4697 - val_loss: 12.3800 - val_accuracy10: 0.5128 - val_accuracy20: 0.4897 - val_accuracy30: 0.4626 - val_accuracy50: 0.4243 - 15s/epoch - 34ms/step
Epoch 22/50
451/451 - 16s - loss: 11.6805 - accuracy10: 0.5445 - accuracy20: 0.5365 - accuracy30: 0.5150 - accuracy50: 0.4705 - val_loss: 12.3870 - val_accuracy10: 0.5147 - val_accuracy20: 0.4880 - val_accuracy30: 0.4622 - val_accuracy50: 0.4218 - 16s/epoch - 34ms/step
testing model: results/XRAY/W0/deepVOL_L2/seq2seq
Evaluating performance on  test set...
1625/1625 - 22s - 22s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9531219
{'0': {'precision': 0.4664978886064803, 'recall': 0.436360402860459, 'f1-score': 0.45092614982831164, 'support': 106836}, '1': {'precision': 0.6850949739864534, 'recall': 0.5619099857088223, 'f1-score': 0.6174180849063907, 'support': 198724}, '2': {'precision': 0.42854340362923, 'recall': 0.5942007960758358, 'f1-score': 0.4979560513038721, 'support': 110291}, 'accuracy': 0.5382192179410413, 'macro avg': {'precision': 0.5267120887407212, 'recall': 0.5308237282150391, 'f1-score': 0.5221000953461915, 'support': 415851}, 'weighted avg': {'precision': 0.5608933549932963, 'recall': 0.5382192179410413, 'f1-score': 0.5429613214885871, 'support': 415851}}
[[ 46619  24585  35632]
 [ 35301 111665  51758]
 [ 18014  26742  65535]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.97957045
{'0': {'precision': 0.5205915921628305, 'recall': 0.4105412378866521, 'f1-score': 0.4590630032206119, 'support': 133324}, '1': {'precision': 0.5455565663742671, 'recall': 0.5652939759865139, 'f1-score': 0.5552499256575925, 'support': 145335}, '2': {'precision': 0.4849798273773092, 'recall': 0.566024257974226, 'f1-score': 0.5223773166055632, 'support': 137192}, 'accuracy': 0.5159203657079098, 'macro avg': {'precision': 0.5170426619714689, 'recall': 0.5139531572824639, 'f1-score': 0.5122300818279225, 'support': 415851}, 'weighted avg': {'precision': 0.5175679978768096, 'recall': 0.5159203657079098, 'f1-score': 0.5135670050248321, 'support': 415851}}
[[54735 32982 45607]
 [26321 82157 36857]
 [24084 35454 77654]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.007337
{'0': {'precision': 0.502018655158012, 'recall': 0.4205860912669485, 'f1-score': 0.4577086010757295, 'support': 137180}, '1': {'precision': 0.5089230303488989, 'recall': 0.483491515674432, 'f1-score': 0.4958814203016113, 'support': 139080}, '2': {'precision': 0.4685265384228019, 'recall': 0.5665408228324176, 'f1-score': 0.5128930164989104, 'support': 139591}, 'accuracy': 0.4906180338630904, 'macro avg': {'precision': 0.4931560746432376, 'recall': 0.4902061432579327, 'f1-score': 0.48882767929208376, 'support': 415851}, 'weighted avg': {'precision': 0.4930853170978987, 'recall': 0.4906180338630904, 'f1-score': 0.4889994322418753, 'support': 415851}}
[[57696 31332 48152]
 [30279 67244 41557]
 [26953 33554 79084]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0497928
{'0': {'precision': 0.4588813490892716, 'recall': 0.43443074819731414, 'f1-score': 0.44632143329117024, 'support': 136047}, '1': {'precision': 0.4548485154606985, 'recall': 0.35207893483468755, 'f1-score': 0.39691940279369453, 'support': 140673}, '2': {'precision': 0.4343638445477201, 'recall': 0.5562239903400392, 'f1-score': 0.48779842102775023, 'support': 139131}, 'accuracy': 0.4473212761301524, 'macro avg': {'precision': 0.44936456969923005, 'recall': 0.44757789112401364, 'f1-score': 0.4436797523708717, 'support': 415851}, 'weighted avg': {'precision': 0.44931432693613776, 'recall': 0.4473212761301524, 'f1-score': 0.4434867712237632, 'support': 415851}}
[[59103 28460 48484]
 [38853 49528 52292]
 [30842 30901 77388]]
Evaluating performance on  train set...
451/451 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.98422366
{'0': {'precision': 0.4466257314998991, 'recall': 0.5001775625504439, 'f1-score': 0.4718871832358674, 'support': 30975}, '1': {'precision': 0.6753733284770279, 'recall': 0.4900332225913621, 'f1-score': 0.5679655195046711, 'support': 52976}, '2': {'precision': 0.4273326560026463, 'recall': 0.5741769579986666, 'f1-score': 0.48998943404405193, 'support': 31499}, 'accuracy': 0.5157124296232135, 'macro avg': {'precision': 0.5164439053265244, 'recall': 0.5214625810468242, 'f1-score': 0.5099473789281967, 'support': 115450}, 'weighted avg': {'precision': 0.5463262088699503, 'recall': 0.5157124296232135, 'f1-score': 0.5209131576003815, 'support': 115450}}
[[15493  5691  9791]
 [12570 25960 14446]
 [ 6626  6787 18086]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.99289435
{'0': {'precision': 0.4943516088937992, 'recall': 0.4713597218930236, 'f1-score': 0.48258196721311475, 'support': 37971}, '1': {'precision': 0.5370200835383647, 'recall': 0.48411306545623356, 'f1-score': 0.5091959635416667, 'support': 38774}, '2': {'precision': 0.478697703822447, 'recall': 0.5477845239633122, 'f1-score': 0.5109161887319871, 'support': 38705}, 'accuracy': 0.5012646167171936, 'macro avg': {'precision': 0.5033564654182036, 'recall': 0.5010857704375232, 'f1-score': 0.5008980398289228, 'support': 115450}, 'weighted avg': {'precision': 0.5034338353128698, 'recall': 0.5012646167171936, 'f1-score': 0.5010194478327009, 'support': 115450}}
[[17898  7564 12509]
 [ 9423 18771 10580]
 [ 8884  8619 21202]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0190363
{'0': {'precision': 0.4726193548387097, 'recall': 0.4753796236210253, 'f1-score': 0.4739954707214494, 'support': 38525}, '1': {'precision': 0.506688014943794, 'recall': 0.40324935623456953, 'f1-score': 0.4490894039735099, 'support': 37669}, '2': {'precision': 0.4653581901072323, 'recall': 0.5538516405135521, 'f1-score': 0.505763169219675, 'support': 39256}, 'accuracy': 0.4785275010827198, 'macro avg': {'precision': 0.481555186629912, 'recall': 0.47749354012304895, 'f1-score': 0.4762826813048781, 'support': 115450}, 'weighted avg': {'precision': 0.48126628489327483, 'recall': 0.4785275010827198, 'f1-score': 0.47667096785369895, 'support': 115450}}
[[18314  7040 13171]
 [10671 15190 11808]
 [ 9765  7749 21742]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0590258
{'0': {'precision': 0.43538899430740036, 'recall': 0.4793690588112399, 'f1-score': 0.4563217819320837, 'support': 38292}, '1': {'precision': 0.45252046710717697, 'recall': 0.28711174392237515, 'f1-score': 0.3513203955540499, 'support': 37926}, '2': {'precision': 0.43587868446177913, 'recall': 0.5469259787928222, 'f1-score': 0.48512870369323646, 'support': 39232}, 'accuracy': 0.4391684711996535, 'macro avg': {'precision': 0.44126271529211875, 'recall': 0.4378022605088125, 'f1-score': 0.43092362705979004, 'support': 115450}, 'weighted avg': {'precision': 0.44118318886383967, 'recall': 0.4391684711996535, 'f1-score': 0.43161732610497444, 'support': 115450}}
[[18356  6431 13505]
 [12772 10889 14265]
 [11032  6743 21457]]
Evaluating performance on  val set...
177/177 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9837046
{'0': {'precision': 0.46846846846846846, 'recall': 0.45755468029833235, 'f1-score': 0.4629472613193149, 'support': 11933}, '1': {'precision': 0.6413184992306782, 'recall': 0.5237542893045285, 'f1-score': 0.5766048578041447, 'support': 20691}, '2': {'precision': 0.4291490645745323, 'recall': 0.5689255140411232, 'f1-score': 0.48924971619250746, 'support': 12499}, 'accuracy': 0.51875983423088, 'macro avg': {'precision': 0.5129786774245596, 'recall': 0.516744827881328, 'f1-score': 0.509600611771989, 'support': 45123}, 'weighted avg': {'precision': 0.5368368561472702, 'recall': 0.51875983423088, 'f1-score': 0.5223503088189857, 'support': 45123}}
[[ 5460  2825  3648]
 [ 4043 10837  5811]
 [ 2152  3236  7111]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0061902
{'0': {'precision': 0.5157593123209169, 'recall': 0.423956931359354, 'f1-score': 0.46537396121883656, 'support': 14860}, '1': {'precision': 0.49227202472952086, 'recall': 0.5120921819521672, 'f1-score': 0.5019865375143654, 'support': 14927}, '2': {'precision': 0.47951668584579976, 'recall': 0.5434272300469484, 'f1-score': 0.5094754860007336, 'support': 15336}, 'accuracy': 0.49371717306030183, 'macro avg': {'precision': 0.4958493409654125, 'recall': 0.4931587811194899, 'f1-score': 0.49227866157797856, 'support': 45123}, 'weighted avg': {'precision': 0.49567173699349704, 'recall': 0.49371717306030183, 'f1-score': 0.49247448446459885, 'support': 45123}}
[[6300 3756 4804]
 [3041 7644 4242]
 [2874 4128 8334]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0303662
{'0': {'precision': 0.5012927756653992, 'recall': 0.4307652094360583, 'f1-score': 0.4633606298105648, 'support': 15303}, '1': {'precision': 0.4607106000294855, 'recall': 0.42931721390300864, 'f1-score': 0.44446024747546575, 'support': 14558}, '2': {'precision': 0.4574889987504754, 'recall': 0.5517625475036038, 'f1-score': 0.5002227568386349, 'support': 15262}, 'accuracy': 0.4712231013008887, 'macro avg': {'precision': 0.47316412481512, 'recall': 0.4706149902808902, 'f1-score': 0.46934787804155514, 'support': 45123}, 'weighted avg': {'precision': 0.47338398067873605, 'recall': 0.4712231013008887, 'f1-score': 0.46973072968575114, 'support': 45123}}
[[6592 3565 5146]
 [3468 6250 4840]
 [3090 3751 8421]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0686934
{'0': {'precision': 0.454834913822939, 'recall': 0.4309417628541448, 'f1-score': 0.44256608856709884, 'support': 15248}, '1': {'precision': 0.4148088459127943, 'recall': 0.31154596193934503, 'f1-score': 0.3558371735791091, 'support': 14871}, '2': {'precision': 0.42523196801148305, 'recall': 0.552852572647294, 'f1-score': 0.4807162933557417, 'support': 15004}, 'accuracy': 0.43212995589832237, 'macro avg': {'precision': 0.4316252425824055, 'recall': 0.431780099146928, 'f1-score': 0.42637318516731654, 'support': 45123}, 'weighted avg': {'precision': 0.4318003138440624, 'recall': 0.43212995589832237, 'f1-score': 0.42666865217905736, 'support': 45123}}
[[6571 3267 5410]
 [4436 4633 5802]
 [3440 3269 8295]]
training model: results/XRAY/W0/deepVOL_L3/seq2seq
Epoch 1/50
451/451 - 27s - loss: 13.2004 - accuracy10: 0.3768 - accuracy20: 0.3747 - accuracy30: 0.3699 - accuracy50: 0.3611 - val_loss: 13.0998 - val_accuracy10: 0.4261 - val_accuracy20: 0.3707 - val_accuracy30: 0.3668 - val_accuracy50: 0.3589 - 27s/epoch - 60ms/step
Epoch 2/50
451/451 - 21s - loss: 12.9720 - accuracy10: 0.3960 - accuracy20: 0.4025 - accuracy30: 0.3959 - accuracy50: 0.3807 - val_loss: 12.8343 - val_accuracy10: 0.3849 - val_accuracy20: 0.4259 - val_accuracy30: 0.4173 - val_accuracy50: 0.3923 - 21s/epoch - 47ms/step
Epoch 3/50
451/451 - 21s - loss: 12.6584 - accuracy10: 0.4390 - accuracy20: 0.4489 - accuracy30: 0.4351 - accuracy50: 0.4057 - val_loss: 12.6930 - val_accuracy10: 0.4160 - val_accuracy20: 0.4423 - val_accuracy30: 0.4254 - val_accuracy50: 0.3937 - 21s/epoch - 47ms/step
Epoch 4/50
451/451 - 21s - loss: 12.4585 - accuracy10: 0.4703 - accuracy20: 0.4741 - accuracy30: 0.4552 - accuracy50: 0.4187 - val_loss: 12.4623 - val_accuracy10: 0.4754 - val_accuracy20: 0.4763 - val_accuracy30: 0.4530 - val_accuracy50: 0.4152 - 21s/epoch - 48ms/step
Epoch 5/50
451/451 - 21s - loss: 12.3549 - accuracy10: 0.4844 - accuracy20: 0.4835 - accuracy30: 0.4650 - accuracy50: 0.4281 - val_loss: 12.3739 - val_accuracy10: 0.4989 - val_accuracy20: 0.4850 - val_accuracy30: 0.4603 - val_accuracy50: 0.4192 - 21s/epoch - 46ms/step
Epoch 6/50
451/451 - 21s - loss: 12.2648 - accuracy10: 0.4963 - accuracy20: 0.4909 - accuracy30: 0.4705 - accuracy50: 0.4308 - val_loss: 12.4043 - val_accuracy10: 0.4882 - val_accuracy20: 0.4821 - val_accuracy30: 0.4570 - val_accuracy50: 0.4179 - 21s/epoch - 46ms/step
Epoch 7/50
451/451 - 21s - loss: 12.1883 - accuracy10: 0.5037 - accuracy20: 0.4957 - accuracy30: 0.4749 - accuracy50: 0.4358 - val_loss: 12.3444 - val_accuracy10: 0.5024 - val_accuracy20: 0.4878 - val_accuracy30: 0.4609 - val_accuracy50: 0.4205 - 21s/epoch - 47ms/step
Epoch 8/50
451/451 - 21s - loss: 12.1151 - accuracy10: 0.5117 - accuracy20: 0.5021 - accuracy30: 0.4808 - accuracy50: 0.4394 - val_loss: 12.3208 - val_accuracy10: 0.5143 - val_accuracy20: 0.4900 - val_accuracy30: 0.4647 - val_accuracy50: 0.4243 - 21s/epoch - 46ms/step
Epoch 9/50
451/451 - 21s - loss: 12.0634 - accuracy10: 0.5156 - accuracy20: 0.5053 - accuracy30: 0.4830 - accuracy50: 0.4415 - val_loss: 12.2645 - val_accuracy10: 0.5224 - val_accuracy20: 0.4924 - val_accuracy30: 0.4673 - val_accuracy50: 0.4266 - 21s/epoch - 47ms/step
Epoch 10/50
451/451 - 21s - loss: 12.0186 - accuracy10: 0.5195 - accuracy20: 0.5089 - accuracy30: 0.4855 - accuracy50: 0.4441 - val_loss: 12.2797 - val_accuracy10: 0.5106 - val_accuracy20: 0.4951 - val_accuracy30: 0.4704 - val_accuracy50: 0.4294 - 21s/epoch - 47ms/step
Epoch 11/50
451/451 - 21s - loss: 11.9804 - accuracy10: 0.5223 - accuracy20: 0.5114 - accuracy30: 0.4887 - accuracy50: 0.4480 - val_loss: 12.2681 - val_accuracy10: 0.5157 - val_accuracy20: 0.4961 - val_accuracy30: 0.4706 - val_accuracy50: 0.4295 - 21s/epoch - 47ms/step
Epoch 12/50
451/451 - 21s - loss: 11.9504 - accuracy10: 0.5244 - accuracy20: 0.5131 - accuracy30: 0.4899 - accuracy50: 0.4478 - val_loss: 12.2648 - val_accuracy10: 0.5215 - val_accuracy20: 0.4970 - val_accuracy30: 0.4710 - val_accuracy50: 0.4288 - 21s/epoch - 47ms/step
Epoch 13/50
451/451 - 21s - loss: 11.9157 - accuracy10: 0.5272 - accuracy20: 0.5153 - accuracy30: 0.4917 - accuracy50: 0.4480 - val_loss: 12.3113 - val_accuracy10: 0.5123 - val_accuracy20: 0.4934 - val_accuracy30: 0.4676 - val_accuracy50: 0.4260 - 21s/epoch - 47ms/step
Epoch 14/50
451/451 - 21s - loss: 11.8847 - accuracy10: 0.5313 - accuracy20: 0.5180 - accuracy30: 0.4945 - accuracy50: 0.4509 - val_loss: 12.2300 - val_accuracy10: 0.5174 - val_accuracy20: 0.4997 - val_accuracy30: 0.4756 - val_accuracy50: 0.4326 - 21s/epoch - 47ms/step
Epoch 15/50
451/451 - 21s - loss: 11.8567 - accuracy10: 0.5316 - accuracy20: 0.5201 - accuracy30: 0.4954 - accuracy50: 0.4515 - val_loss: 12.2108 - val_accuracy10: 0.5219 - val_accuracy20: 0.5017 - val_accuracy30: 0.4763 - val_accuracy50: 0.4320 - 21s/epoch - 48ms/step
Epoch 16/50
451/451 - 21s - loss: 11.8300 - accuracy10: 0.5343 - accuracy20: 0.5218 - accuracy30: 0.4977 - accuracy50: 0.4532 - val_loss: 12.2082 - val_accuracy10: 0.5210 - val_accuracy20: 0.5008 - val_accuracy30: 0.4767 - val_accuracy50: 0.4332 - 21s/epoch - 47ms/step
Epoch 17/50
451/451 - 21s - loss: 11.8002 - accuracy10: 0.5369 - accuracy20: 0.5239 - accuracy30: 0.5006 - accuracy50: 0.4548 - val_loss: 12.2095 - val_accuracy10: 0.5244 - val_accuracy20: 0.5007 - val_accuracy30: 0.4751 - val_accuracy50: 0.4319 - 21s/epoch - 47ms/step
Epoch 18/50
451/451 - 22s - loss: 11.7905 - accuracy10: 0.5366 - accuracy20: 0.5243 - accuracy30: 0.5000 - accuracy50: 0.4562 - val_loss: 12.2920 - val_accuracy10: 0.5210 - val_accuracy20: 0.4997 - val_accuracy30: 0.4745 - val_accuracy50: 0.4289 - 22s/epoch - 48ms/step
Epoch 19/50
451/451 - 21s - loss: 11.7622 - accuracy10: 0.5399 - accuracy20: 0.5273 - accuracy30: 0.5034 - accuracy50: 0.4580 - val_loss: 12.3559 - val_accuracy10: 0.5200 - val_accuracy20: 0.4948 - val_accuracy30: 0.4700 - val_accuracy50: 0.4278 - 21s/epoch - 46ms/step
Epoch 20/50
451/451 - 21s - loss: 11.7395 - accuracy10: 0.5407 - accuracy20: 0.5277 - accuracy30: 0.5042 - accuracy50: 0.4592 - val_loss: 12.2562 - val_accuracy10: 0.5218 - val_accuracy20: 0.5001 - val_accuracy30: 0.4742 - val_accuracy50: 0.4317 - 21s/epoch - 47ms/step
Epoch 21/50
451/451 - 21s - loss: 11.7201 - accuracy10: 0.5407 - accuracy20: 0.5294 - accuracy30: 0.5056 - accuracy50: 0.4620 - val_loss: 12.2756 - val_accuracy10: 0.5227 - val_accuracy20: 0.4983 - val_accuracy30: 0.4722 - val_accuracy50: 0.4314 - 21s/epoch - 46ms/step
Epoch 22/50
451/451 - 21s - loss: 11.6999 - accuracy10: 0.5426 - accuracy20: 0.5320 - accuracy30: 0.5084 - accuracy50: 0.4636 - val_loss: 12.2379 - val_accuracy10: 0.5253 - val_accuracy20: 0.5024 - val_accuracy30: 0.4743 - val_accuracy50: 0.4317 - 21s/epoch - 47ms/step
Epoch 23/50
451/451 - 21s - loss: 11.6787 - accuracy10: 0.5448 - accuracy20: 0.5336 - accuracy30: 0.5108 - accuracy50: 0.4659 - val_loss: 12.2375 - val_accuracy10: 0.5260 - val_accuracy20: 0.5012 - val_accuracy30: 0.4725 - val_accuracy50: 0.4304 - 21s/epoch - 47ms/step
Epoch 24/50
451/451 - 21s - loss: 11.6537 - accuracy10: 0.5453 - accuracy20: 0.5340 - accuracy30: 0.5112 - accuracy50: 0.4660 - val_loss: 12.2801 - val_accuracy10: 0.5244 - val_accuracy20: 0.5019 - val_accuracy30: 0.4737 - val_accuracy50: 0.4316 - 21s/epoch - 47ms/step
Epoch 25/50
451/451 - 21s - loss: 11.6292 - accuracy10: 0.5473 - accuracy20: 0.5366 - accuracy30: 0.5136 - accuracy50: 0.4678 - val_loss: 12.3138 - val_accuracy10: 0.5247 - val_accuracy20: 0.4992 - val_accuracy30: 0.4703 - val_accuracy50: 0.4275 - 21s/epoch - 47ms/step
Epoch 26/50
451/451 - 21s - loss: 11.6124 - accuracy10: 0.5500 - accuracy20: 0.5400 - accuracy30: 0.5154 - accuracy50: 0.4696 - val_loss: 12.3643 - val_accuracy10: 0.5215 - val_accuracy20: 0.4980 - val_accuracy30: 0.4700 - val_accuracy50: 0.4269 - 21s/epoch - 46ms/step
testing model: results/XRAY/W0/deepVOL_L3/seq2seq
Evaluating performance on  test set...
1625/1625 - 33s - 33s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9576242
{'0': {'precision': 0.4804317457545728, 'recall': 0.41204275712306715, 'f1-score': 0.44361697839406644, 'support': 106836}, '1': {'precision': 0.6904747501633315, 'recall': 0.5743694772649504, 'f1-score': 0.6270932225738397, 'support': 198724}, '2': {'precision': 0.4266305886794827, 'recall': 0.6147192427305945, 'f1-score': 0.503688625067792, 'support': 110291}, 'accuracy': 0.5433676966028698, 'macro avg': {'precision': 0.5325123615324624, 'recall': 0.5337104923728707, 'f1-score': 0.524799608678566, 'support': 415851}, 'weighted avg': {'precision': 0.5665366309013138, 'recall': 0.5433676966028698, 'f1-score': 0.5472273944605738, 'support': 415851}}
[[ 44021  24152  38663]
 [ 32129 114141  52454]
 [ 15478  27015  67798]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.97713065
{'0': {'precision': 0.5367411104988493, 'recall': 0.37260358225075757, 'f1-score': 0.4398588612386387, 'support': 133324}, '1': {'precision': 0.5482606220698565, 'recall': 0.5898097498881893, 'f1-score': 0.5682767399000278, 'support': 145335}, '2': {'precision': 0.4817039934351209, 'recall': 0.5861857834276051, 'f1-score': 0.5288336659641416, 'support': 137192}, 'accuracy': 0.5189767488836146, 'macro avg': {'precision': 0.5222352420012756, 'recall': 0.5161997051888507, 'f1-score': 0.5123230890342695, 'support': 415851}, 'weighted avg': {'precision': 0.5226099338273138, 'recall': 0.5189767488836146, 'f1-score': 0.51409276666427, 'support': 415851}}
[[49677 33902 49745]
 [22831 85720 36784]
 [20045 36727 80420]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0048728
{'0': {'precision': 0.5215633282004546, 'recall': 0.3629537833503426, 'f1-score': 0.4280378090034946, 'support': 137180}, '1': {'precision': 0.5071602492674673, 'recall': 0.5301553062985332, 'f1-score': 0.5184029022800617, 'support': 139080}, '2': {'precision': 0.4662975280282511, 'recall': 0.5845863988366012, 'f1-score': 0.5187845883411265, 'support': 139591}, 'accuracy': 0.4932704261863023, 'macro avg': {'precision': 0.49834036849872426, 'recall': 0.4925651628284924, 'f1-score': 0.4884084332082275, 'support': 415851}, 'weighted avg': {'precision': 0.49819488967358333, 'recall': 0.4932704261863023, 'f1-score': 0.48872158960622086, 'support': 415851}}
[[49790 35146 52244]
 [24191 73734 41155]
 [21482 36506 81603]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.05295
{'0': {'precision': 0.4737703941884006, 'recall': 0.3509007916381839, 'f1-score': 0.40318228460671174, 'support': 136047}, '1': {'precision': 0.44826685514104847, 'recall': 0.41479175108229727, 'f1-score': 0.430880110470719, 'support': 140673}, '2': {'precision': 0.432589404009323, 'recall': 0.5749545392471843, 'f1-score': 0.49371393303502553, 'support': 139131}, 'accuracy': 0.44747517740729253, 'macro avg': {'precision': 0.4515422177795907, 'recall': 0.4468823606558885, 'f1-score': 0.4425921093708188, 'support': 415851}, 'weighted avg': {'precision': 0.4513652257674676, 'recall': 0.44747517740729253, 'f1-score': 0.4428409484917264, 'support': 415851}}
[[47739 36070 52238]
 [29636 58350 52687]
 [23389 35748 79994]]
Evaluating performance on  train set...
451/451 - 9s - 9s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9972779
{'0': {'precision': 0.4584266169154229, 'recall': 0.4759644874899112, 'f1-score': 0.46703096539162114, 'support': 30975}, '1': {'precision': 0.697938344571159, 'recall': 0.47479990939293265, 'f1-score': 0.5651407066224793, 'support': 52976}, '2': {'precision': 0.41789591754671856, 'recall': 0.6268770437156735, 'f1-score': 0.5014857142857142, 'support': 31499}, 'accuracy': 0.5166045907319186, 'macro avg': {'precision': 0.5247536263444335, 'recall': 0.5258804801995058, 'f1-score': 0.5112191287666049, 'support': 115450}, 'weighted avg': {'precision': 0.5572719766804767, 'recall': 0.5166045907319186, 'f1-score': 0.521450643060404, 'support': 115450}}
[[14743  4925 11307]
 [11625 25153 16198]
 [ 5792  5961 19746]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9858059
{'0': {'precision': 0.5093776243351684, 'recall': 0.4313028363751284, 'f1-score': 0.46710019679986314, 'support': 37971}, '1': {'precision': 0.5581886927267855, 'recall': 0.48354567493681333, 'f1-score': 0.5181929991846662, 'support': 38774}, '2': {'precision': 0.46986521826594246, 'recall': 0.6034620850019378, 'f1-score': 0.5283492620030538, 'support': 38705}, 'accuracy': 0.5065656128194024, 'macro avg': {'precision': 0.5124771784426321, 'recall': 0.5061035321046266, 'f1-score': 0.5045474859958611, 'support': 115450}, 'weighted avg': {'precision': 0.5125242045768936, 'recall': 0.5065656128194024, 'f1-score': 0.504793721168489, 'support': 115450}}
[[16377  6932 14662]
 [ 8334 18749 11691]
 [ 7440  7908 23357]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0113747
{'0': {'precision': 0.49163736431738264, 'recall': 0.4173653471771577, 'f1-score': 0.4514670784781693, 'support': 38525}, '1': {'precision': 0.5219860457569365, 'recall': 0.42700894634845626, 'f1-score': 0.46974475789965536, 'support': 37669}, '2': {'precision': 0.4572308877334874, 'recall': 0.6048502139800286, 'f1-score': 0.5207816989450136, 'support': 39256}, 'accuracy': 0.48426158510177564, 'macro avg': {'precision': 0.4902847659359355, 'recall': 0.48307483583521416, 'f1-score': 0.4806645117742794, 'support': 115450}, 'weighted avg': {'precision': 0.48984042916250314, 'recall': 0.48426158510177564, 'f1-score': 0.48099948772177603, 'support': 115450}}
[[16079  7124 15322]
 [ 8720 16085 12864]
 [ 7906  7606 23744]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0557135
{'0': {'precision': 0.45363445564456534, 'recall': 0.40076256137052124, 'f1-score': 0.42556259619250986, 'support': 38292}, '1': {'precision': 0.45698509110988406, 'recall': 0.3273216263249486, 'f1-score': 0.38143522145918796, 'support': 37926}, '2': {'precision': 0.4272072866167181, 'recall': 0.5929853181076672, 'f1-score': 0.4966271027239348, 'support': 39232}, 'accuracy': 0.441957557384149, 'macro avg': {'precision': 0.44594227779038914, 'recall': 0.440356501934379, 'f1-score': 0.4345416401252109, 'support': 115450}, 'weighted avg': {'precision': 0.4457547285363555, 'recall': 0.441957557384149, 'f1-score': 0.43521550139913523, 'support': 115450}}
[[15346  7357 15589]
 [ 9909 12414 15603]
 [ 8574  7394 23264]]
Evaluating performance on  val set...
177/177 - 4s - 4s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.99200565
{'0': {'precision': 0.47084727849216135, 'recall': 0.448001340819576, 'f1-score': 0.45914029286726504, 'support': 11933}, '1': {'precision': 0.6635071090047393, 'recall': 0.5142332415059688, 'f1-score': 0.5794102431453699, 'support': 20691}, '2': {'precision': 0.42406812158123275, 'recall': 0.601648131850548, 'f1-score': 0.4974861074358296, 'support': 12499}, 'accuracy': 0.5209316756421337, 'macro avg': {'precision': 0.5194741696927111, 'recall': 0.5212942380586977, 'f1-score': 0.5120122144828215, 'support': 45123}, 'weighted avg': {'precision': 0.546233043421489, 'recall': 0.5209316756421337, 'f1-score': 0.5249114046616217, 'support': 45123}}
[[ 5346  2436  4151]
 [ 3989 10640  6062]
 [ 2019  2960  7520]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9968714
{'0': {'precision': 0.5242190242190242, 'recall': 0.40201884253028264, 'f1-score': 0.4550578915295551, 'support': 14860}, '1': {'precision': 0.5171862509992007, 'recall': 0.5201313056876801, 'f1-score': 0.5186545976819533, 'support': 14927}, '2': {'precision': 0.47357734437616883, 'recall': 0.5779212310902452, 'f1-score': 0.5205720830518927, 'support': 15336}, 'accuracy': 0.5008753850586175, 'macro avg': {'precision': 0.5049942065314645, 'recall': 0.5000237931027359, 'f1-score': 0.4980948574211337, 'support': 45123}, 'weighted avg': {'precision': 0.5046808949296965, 'recall': 0.5008753850586175, 'f1-score': 0.4983624961419128, 'support': 45123}}
[[5974 3388 5498]
 [2809 7764 4354]
 [2613 3860 8863]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0242513
{'0': {'precision': 0.510281338724942, 'recall': 0.38757106449715745, 'f1-score': 0.4405407412909456, 'support': 15303}, '1': {'precision': 0.4827211475766138, 'recall': 0.45768649539771944, 'f1-score': 0.46987059694651107, 'support': 14558}, '2': {'precision': 0.4517946895466315, 'recall': 0.5830821648538854, 'f1-score': 0.5091106725020739, 'support': 15262}, 'accuracy': 0.47632028012321875, 'macro avg': {'precision': 0.4815990586160624, 'recall': 0.47611324158292073, 'f1-score': 0.4731740035798435, 'support': 45123}, 'weighted avg': {'precision': 0.4816076135183569, 'recall': 0.47632028012321875, 'f1-score': 0.4731958911874055, 'support': 45123}}
[[5931 3490 5882]
 [2979 6663 4916]
 [2713 3650 8899]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0673032
{'0': {'precision': 0.4620815682365645, 'recall': 0.36483473242392445, 'f1-score': 0.4077399494264668, 'support': 15248}, '1': {'precision': 0.43159356366903534, 'recall': 0.3553224396476363, 'f1-score': 0.3897617466991222, 'support': 14871}, '2': {'precision': 0.41768629144474834, 'recall': 0.5801786190349241, 'f1-score': 0.4857023294741247, 'support': 15004}, 'accuracy': 0.4333045231921636, 'macro avg': {'precision': 0.43712047445011604, 'recall': 0.4334452637021616, 'f1-score': 0.42773467519990455, 'support': 45123}, 'weighted avg': {'precision': 0.43727174067837604, 'recall': 0.4333045231921636, 'f1-score': 0.4277384800533471, 'support': 45123}}
[[5563 3564 6121]
 [3572 5284 6015]
 [2904 3395 8705]]
training model: results/XRAY/W1/deepLOB_L1/seq2seq
Epoch 1/50
524/524 - 20s - loss: 12.6549 - accuracy10: 0.4439 - accuracy20: 0.4391 - accuracy30: 0.4315 - accuracy50: 0.4120 - val_loss: 13.6719 - val_accuracy10: 0.3678 - val_accuracy20: 0.3942 - val_accuracy30: 0.3966 - val_accuracy50: 0.3809 - 20s/epoch - 37ms/step
Epoch 2/50
524/524 - 13s - loss: 12.6099 - accuracy10: 0.4423 - accuracy20: 0.4490 - accuracy30: 0.4420 - accuracy50: 0.4206 - val_loss: 13.6330 - val_accuracy10: 0.3970 - val_accuracy20: 0.3992 - val_accuracy30: 0.3961 - val_accuracy50: 0.3817 - 13s/epoch - 25ms/step
Epoch 3/50
524/524 - 13s - loss: 12.5049 - accuracy10: 0.4498 - accuracy20: 0.4569 - accuracy30: 0.4477 - accuracy50: 0.4242 - val_loss: 13.2849 - val_accuracy10: 0.4305 - val_accuracy20: 0.4241 - val_accuracy30: 0.4109 - val_accuracy50: 0.3844 - 13s/epoch - 25ms/step
Epoch 4/50
524/524 - 13s - loss: 12.3334 - accuracy10: 0.4689 - accuracy20: 0.4770 - accuracy30: 0.4649 - accuracy50: 0.4344 - val_loss: 13.2734 - val_accuracy10: 0.4388 - val_accuracy20: 0.4257 - val_accuracy30: 0.4089 - val_accuracy50: 0.3849 - 13s/epoch - 25ms/step
Epoch 5/50
524/524 - 14s - loss: 12.1877 - accuracy10: 0.4838 - accuracy20: 0.4882 - accuracy30: 0.4739 - accuracy50: 0.4413 - val_loss: 13.2511 - val_accuracy10: 0.4476 - val_accuracy20: 0.4335 - val_accuracy30: 0.4180 - val_accuracy50: 0.3952 - 14s/epoch - 26ms/step
Epoch 6/50
524/524 - 13s - loss: 12.0788 - accuracy10: 0.4963 - accuracy20: 0.4984 - accuracy30: 0.4838 - accuracy50: 0.4489 - val_loss: 13.0638 - val_accuracy10: 0.4591 - val_accuracy20: 0.4490 - val_accuracy30: 0.4351 - val_accuracy50: 0.4047 - 13s/epoch - 26ms/step
Epoch 7/50
524/524 - 14s - loss: 12.0288 - accuracy10: 0.5051 - accuracy20: 0.5037 - accuracy30: 0.4867 - accuracy50: 0.4508 - val_loss: 13.3795 - val_accuracy10: 0.4486 - val_accuracy20: 0.4163 - val_accuracy30: 0.4004 - val_accuracy50: 0.3818 - 14s/epoch - 26ms/step
Epoch 8/50
524/524 - 13s - loss: 11.9061 - accuracy10: 0.5180 - accuracy20: 0.5136 - accuracy30: 0.4970 - accuracy50: 0.4579 - val_loss: 13.5912 - val_accuracy10: 0.4500 - val_accuracy20: 0.4124 - val_accuracy30: 0.3969 - val_accuracy50: 0.3795 - 13s/epoch - 25ms/step
Epoch 9/50
524/524 - 14s - loss: 11.8556 - accuracy10: 0.5257 - accuracy20: 0.5204 - accuracy30: 0.5017 - accuracy50: 0.4613 - val_loss: 13.5520 - val_accuracy10: 0.4511 - val_accuracy20: 0.4095 - val_accuracy30: 0.3904 - val_accuracy50: 0.3755 - 14s/epoch - 26ms/step
Epoch 10/50
524/524 - 14s - loss: 11.8113 - accuracy10: 0.5282 - accuracy20: 0.5230 - accuracy30: 0.5042 - accuracy50: 0.4618 - val_loss: 13.4151 - val_accuracy10: 0.4605 - val_accuracy20: 0.4276 - val_accuracy30: 0.4128 - val_accuracy50: 0.3916 - 14s/epoch - 27ms/step
Epoch 11/50
524/524 - 14s - loss: 11.7704 - accuracy10: 0.5333 - accuracy20: 0.5256 - accuracy30: 0.5063 - accuracy50: 0.4649 - val_loss: 13.8289 - val_accuracy10: 0.4539 - val_accuracy20: 0.4104 - val_accuracy30: 0.3894 - val_accuracy50: 0.3753 - 14s/epoch - 26ms/step
Epoch 12/50
524/524 - 13s - loss: 11.7531 - accuracy10: 0.5319 - accuracy20: 0.5256 - accuracy30: 0.5058 - accuracy50: 0.4641 - val_loss: 13.5964 - val_accuracy10: 0.4556 - val_accuracy20: 0.4184 - val_accuracy30: 0.3990 - val_accuracy50: 0.3820 - 13s/epoch - 25ms/step
Epoch 13/50
524/524 - 13s - loss: 11.7398 - accuracy10: 0.5349 - accuracy20: 0.5280 - accuracy30: 0.5084 - accuracy50: 0.4670 - val_loss: 13.3821 - val_accuracy10: 0.4634 - val_accuracy20: 0.4367 - val_accuracy30: 0.4202 - val_accuracy50: 0.3948 - 13s/epoch - 26ms/step
Epoch 14/50
524/524 - 14s - loss: 11.6781 - accuracy10: 0.5413 - accuracy20: 0.5322 - accuracy30: 0.5114 - accuracy50: 0.4691 - val_loss: 13.3911 - val_accuracy10: 0.4644 - val_accuracy20: 0.4369 - val_accuracy30: 0.4201 - val_accuracy50: 0.3999 - 14s/epoch - 26ms/step
Epoch 15/50
524/524 - 13s - loss: 11.6484 - accuracy10: 0.5419 - accuracy20: 0.5325 - accuracy30: 0.5122 - accuracy50: 0.4690 - val_loss: 13.6026 - val_accuracy10: 0.4630 - val_accuracy20: 0.4216 - val_accuracy30: 0.4024 - val_accuracy50: 0.3839 - 13s/epoch - 25ms/step
Epoch 16/50
524/524 - 14s - loss: 11.6156 - accuracy10: 0.5439 - accuracy20: 0.5337 - accuracy30: 0.5141 - accuracy50: 0.4708 - val_loss: 13.7568 - val_accuracy10: 0.4585 - val_accuracy20: 0.4130 - val_accuracy30: 0.3897 - val_accuracy50: 0.3740 - 14s/epoch - 26ms/step
testing model: results/XRAY/W1/deepLOB_L1/seq2seq
Evaluating performance on  test set...
1314/1314 - 17s - 17s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0507106
{'0': {'precision': 0.4779561359593528, 'recall': 0.4148844692241547, 'f1-score': 0.4441925616480395, 'support': 108153}, '1': {'precision': 0.5138633936819877, 'recall': 0.3677531254293172, 'f1-score': 0.4287008352809877, 'support': 116464}, '2': {'precision': 0.44385827019209606, 'recall': 0.6322459873889367, 'f1-score': 0.5215621224827566, 'support': 111648}, 'accuracy': 0.470729930263334, 'macro avg': {'precision': 0.47855926661114556, 'recall': 0.47162786068080287, 'f1-score': 0.46481850647059453, 'support': 336265}, 'weighted avg': {'precision': 0.479071162341005, 'recall': 0.470729930263334, 'f1-score': 0.4645156054035959, 'support': 336265}}
[[44871 20687 42595]
 [27783 42830 45851]
 [21227 19832 70589]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0829933
{'0': {'precision': 0.5183176011611269, 'recall': 0.39362575339467326, 'f1-score': 0.4474469937974301, 'support': 127921}, '1': {'precision': 0.3572165207767381, 'recall': 0.3716502669318539, 'f1-score': 0.36429047814487997, 'support': 76424}, '2': {'precision': 0.48945528363595353, 'recall': 0.5921770770163736, 'f1-score': 0.5359384754704555, 'support': 131920}, 'accuracy': 0.46652491338676344, 'macro avg': {'precision': 0.4549964685246062, 'recall': 0.45248436578096696, 'f1-score': 0.4492253158042552, 'support': 336265}, 'weighted avg': {'precision': 0.47038068862126275, 'recall': 0.46652491338676344, 'f1-score': 0.46326381300274444, 'support': 336265}}
[[50353 25544 52024]
 [18559 28403 29462]
 [28235 25565 78120]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.092924
{'0': {'precision': 0.5117187902785082, 'recall': 0.3768070825487457, 'f1-score': 0.4340205960163544, 'support': 131704}, '1': {'precision': 0.3057292546898766, 'recall': 0.3366689572238447, 'f1-score': 0.32045403446137916, 'support': 69852}, '2': {'precision': 0.4821480263360495, 'recall': 0.5811267250146612, 'f1-score': 0.5270304841923843, 'support': 134709}, 'accuracy': 0.4503204318022988, 'macro avg': {'precision': 0.43319869043481135, 'recall': 0.43153425492908387, 'f1-score': 0.427168371556706, 'support': 336265}, 'weighted avg': {'precision': 0.4570826280854111, 'recall': 0.4503204318022988, 'f1-score': 0.44768962957193315, 'support': 336265}}
[[49627 26664 55413]
 [17668 23517 28667]
 [29686 26740 78283]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1076906
{'0': {'precision': 0.45895718828310905, 'recall': 0.3484833948929502, 'f1-score': 0.3961627949249282, 'support': 125082}, '1': {'precision': 0.29727801268498943, 'recall': 0.2645983040681195, 'f1-score': 0.2799878038915542, 'support': 85027}, '2': {'precision': 0.4342767086727331, 'recall': 0.5700957544627286, 'f1-score': 0.4930029784040004, 'support': 126156}, 'accuracy': 0.4104144053053395, 'macro avg': {'precision': 0.39683730321361055, 'recall': 0.3943924844745994, 'f1-score': 0.38971785907349427, 'support': 336265}, 'weighted avg': {'precision': 0.4088161214182617, 'recall': 0.4104144053053395, 'f1-score': 0.4031184971966221, 'support': 336265}}
[[43589 26704 54789]
 [23628 22498 38901]
 [27757 26478 71921]]
Evaluating performance on  train set...
524/524 - 6s - 6s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.97817236
{'0': {'precision': 0.43352053810487823, 'recall': 0.37271910617034415, 'f1-score': 0.4008271947832387, 'support': 35622}, '1': {'precision': 0.655572331998512, 'recall': 0.48097546879013614, 'f1-score': 0.5548630853713873, 'support': 62288}, '2': {'precision': 0.4057511309864282, 'recall': 0.6483050847457628, 'f1-score': 0.49912047845971796, 'support': 36108}, 'accuracy': 0.4972839469325016, 'macro avg': {'precision': 0.4982813336966061, 'recall': 0.5006665532354143, 'f1-score': 0.48493691953811463, 'support': 134018}, 'weighted avg': {'precision': 0.5292424887817551, 'recall': 0.4972839469325016, 'f1-score': 0.4989017925234297, 'support': 134018}}
[[13277  8358 13987]
 [12032 29959 20297]
 [ 5317  7382 23409]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0158026
{'0': {'precision': 0.4852686308492201, 'recall': 0.3591669193273783, 'f1-score': 0.4128022302042567, 'support': 42877}, '1': {'precision': 0.5310439808543304, 'recall': 0.49588885140833194, 'f1-score': 0.5128646809995203, 'support': 47432}, '2': {'precision': 0.4592609197978997, 'recall': 0.6093253105767691, 'f1-score': 0.5237561455260571, 'support': 43709}, 'accuracy': 0.4891432494142578, 'macro avg': {'precision': 0.49185784383381675, 'recall': 0.4881270271041598, 'f1-score': 0.4831410189099447, 'support': 134018}, 'weighted avg': {'precision': 0.49298733549412027, 'recall': 0.4891432494142578, 'f1-score': 0.4844034095303287, 'support': 134018}}
[[15400 10812 16665]
 [ 9218 23521 14693]
 [ 7117  9959 26633]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.03503
{'0': {'precision': 0.48878711307643713, 'recall': 0.3451467570702114, 'f1-score': 0.40459631876176533, 'support': 44836}, '1': {'precision': 0.48075593454713067, 'recall': 0.47564757387814666, 'f1-score': 0.47818811177589804, 'support': 43856}, '2': {'precision': 0.4571801655134988, 'recall': 0.594780037947315, 'f1-score': 0.5169808426179838, 'support': 45326}, 'accuracy': 0.4722798430061633, 'macro avg': {'precision': 0.4755744043790222, 'recall': 0.47185812296522434, 'f1-score': 0.4665884243852157, 'support': 134018}, 'weighted avg': {'precision': 0.4754692612146051, 'recall': 0.4722798430061633, 'f1-score': 0.46668784827820914, 'support': 134018}}
[[15475 11728 17633]
 [ 8620 20860 14376]
 [ 7565 10802 26959]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0603191
{'0': {'precision': 0.46014726779485854, 'recall': 0.3159131726569256, 'f1-score': 0.3746269637809768, 'support': 45101}, '1': {'precision': 0.4376513881125396, 'recall': 0.4255111976630964, 'f1-score': 0.43149591834391543, 'support': 44161}, '2': {'precision': 0.42760903556339197, 'recall': 0.5743810885691304, 'f1-score': 0.4902454373820012, 'support': 44756}, 'accuracy': 0.4383441030309361, 'macro avg': {'precision': 0.44180256382359673, 'recall': 0.4386018196297175, 'f1-score': 0.4321227731689645, 'support': 134018}, 'weighted avg': {'precision': 0.4418682182313491, 'recall': 0.4383441030309361, 'f1-score': 0.43197754584414283, 'support': 134018}}
[[14248 12733 18120]
 [ 9079 18791 16291]
 [ 7637 11412 25707]]
Evaluating performance on  val set...
107/107 - 1s - 1s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0377005
{'0': {'precision': 0.4753403258201294, 'recall': 0.49061384314177126, 'f1-score': 0.48285633323887783, 'support': 8683}, '1': {'precision': 0.4865731462925852, 'recall': 0.3690343499848009, 'f1-score': 0.41973032153970263, 'support': 9869}, '2': {'precision': 0.4273990487736641, 'recall': 0.5317939197029473, 'f1-score': 0.47391551626079315, 'support': 8618}, 'accuracy': 0.45951417004048584, 'macro avg': {'precision': 0.4631041736287929, 'recall': 0.46381403760983986, 'f1-score': 0.4588340570131246, 'support': 27170}, 'weighted avg': {'precision': 0.4642140387261371, 'recall': 0.45951417004048584, 'f1-score': 0.45709105645653353, 'support': 27170}}
[[4260 1979 2444]
 [2531 3642 3696]
 [2171 1864 4583]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0708768
{'0': {'precision': 0.5128594682582746, 'recall': 0.4580345028106222, 'f1-score': 0.48389904264577893, 'support': 10318}, '1': {'precision': 0.32772992497916087, 'recall': 0.36230993702964215, 'f1-score': 0.3441534758188051, 'support': 6511}, '2': {'precision': 0.4759691363763131, 'recall': 0.49511652644811915, 'f1-score': 0.4853540619963978, 'support': 10341}, 'accuracy': 0.44920868605079134, 'macro avg': {'precision': 0.43885284320458284, 'recall': 0.4384869887627945, 'f1-score': 0.43780219348699395, 'support': 27170}, 'weighted avg': {'precision': 0.45445455923060896, 'recall': 0.44920868605079134, 'f1-score': 0.45096429731984305, 'support': 27170}}
[[4726 2459 3133]
 [1648 2359 2504]
 [2841 2380 5120]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0797825
{'0': {'precision': 0.506018869970719, 'recall': 0.4394424562064419, 'f1-score': 0.4703866122284389, 'support': 10618}, '1': {'precision': 0.27935107442720936, 'recall': 0.33572772361894987, 'f1-score': 0.30495572471648286, 'support': 5847}, '2': {'precision': 0.4793078190807544, 'recall': 0.4890238206445586, 'f1-score': 0.4841170758773755, 'support': 10705}, 'accuracy': 0.4366580787633419, 'macro avg': {'precision': 0.4215592544928943, 'recall': 0.4213980001566502, 'f1-score': 0.4198198042740991, 'support': 27170}, 'weighted avg': {'precision': 0.44671565317572554, 'recall': 0.4366580787633419, 'f1-score': 0.44019560060088864, 'support': 27170}}
[[4666 2585 3367]
 [1564 1963 2320]
 [2991 2479 5235]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0925665
{'0': {'precision': 0.46025612718039305, 'recall': 0.4105771124679929, 'f1-score': 0.4339995835935873, 'support': 10154}, '1': {'precision': 0.28663330950679056, 'recall': 0.2929573348918761, 'f1-score': 0.2897608208685598, 'support': 6844}, '2': {'precision': 0.4404965368354772, 'recall': 0.48141958316948485, 'f1-score': 0.4600497909718634, 'support': 10172}, 'accuracy': 0.4074714758925285, 'macro avg': {'precision': 0.3957953245075536, 'recall': 0.394984676843118, 'f1-score': 0.3946033984780035, 'support': 27170}, 'weighted avg': {'precision': 0.409123660594209, 'recall': 0.4074714758925285, 'f1-score': 0.4074192603459515, 'support': 27170}}
[[4169 2535 3450]
 [2069 2005 2770]
 [2820 2455 4897]]
training model: results/XRAY/W1/deepOF_L1/seq2seq
Epoch 1/50
524/524 - 18s - loss: 13.0141 - accuracy10: 0.3948 - accuracy20: 0.3998 - accuracy30: 0.3976 - accuracy50: 0.3880 - val_loss: 13.1530 - val_accuracy10: 0.3835 - val_accuracy20: 0.4227 - val_accuracy30: 0.4350 - val_accuracy50: 0.4216 - 18s/epoch - 35ms/step
Epoch 2/50
524/524 - 13s - loss: 12.9717 - accuracy10: 0.3956 - accuracy20: 0.4018 - accuracy30: 0.4001 - accuracy50: 0.3923 - val_loss: 13.1030 - val_accuracy10: 0.3828 - val_accuracy20: 0.4422 - val_accuracy30: 0.4525 - val_accuracy50: 0.4285 - 13s/epoch - 24ms/step
Epoch 3/50
524/524 - 13s - loss: 12.9632 - accuracy10: 0.3942 - accuracy20: 0.3997 - accuracy30: 0.3983 - accuracy50: 0.3918 - val_loss: 13.0577 - val_accuracy10: 0.3867 - val_accuracy20: 0.4455 - val_accuracy30: 0.4542 - val_accuracy50: 0.4303 - 13s/epoch - 24ms/step
Epoch 4/50
524/524 - 13s - loss: 12.9179 - accuracy10: 0.3949 - accuracy20: 0.4058 - accuracy30: 0.4039 - accuracy50: 0.3963 - val_loss: 13.1021 - val_accuracy10: 0.3856 - val_accuracy20: 0.4364 - val_accuracy30: 0.4434 - val_accuracy50: 0.4206 - 13s/epoch - 24ms/step
Epoch 5/50
524/524 - 13s - loss: 12.8853 - accuracy10: 0.4061 - accuracy20: 0.4103 - accuracy30: 0.4077 - accuracy50: 0.3997 - val_loss: 13.0691 - val_accuracy10: 0.3909 - val_accuracy20: 0.4360 - val_accuracy30: 0.4437 - val_accuracy50: 0.4210 - 13s/epoch - 24ms/step
Epoch 6/50
524/524 - 13s - loss: 12.8495 - accuracy10: 0.4137 - accuracy20: 0.4156 - accuracy30: 0.4122 - accuracy50: 0.4038 - val_loss: 13.0604 - val_accuracy10: 0.3965 - val_accuracy20: 0.4349 - val_accuracy30: 0.4379 - val_accuracy50: 0.4174 - 13s/epoch - 24ms/step
Epoch 7/50
524/524 - 12s - loss: 12.8229 - accuracy10: 0.4180 - accuracy20: 0.4203 - accuracy30: 0.4163 - accuracy50: 0.4064 - val_loss: 13.0547 - val_accuracy10: 0.3973 - val_accuracy20: 0.4362 - val_accuracy30: 0.4420 - val_accuracy50: 0.4187 - 12s/epoch - 24ms/step
Epoch 8/50
524/524 - 13s - loss: 12.8064 - accuracy10: 0.4208 - accuracy20: 0.4237 - accuracy30: 0.4199 - accuracy50: 0.4092 - val_loss: 13.0541 - val_accuracy10: 0.4030 - val_accuracy20: 0.4350 - val_accuracy30: 0.4354 - val_accuracy50: 0.4169 - 13s/epoch - 24ms/step
Epoch 9/50
524/524 - 13s - loss: 12.7777 - accuracy10: 0.4279 - accuracy20: 0.4284 - accuracy30: 0.4231 - accuracy50: 0.4119 - val_loss: 13.0374 - val_accuracy10: 0.4012 - val_accuracy20: 0.4349 - val_accuracy30: 0.4367 - val_accuracy50: 0.4165 - 13s/epoch - 25ms/step
Epoch 10/50
524/524 - 13s - loss: 12.7485 - accuracy10: 0.4290 - accuracy20: 0.4319 - accuracy30: 0.4278 - accuracy50: 0.4157 - val_loss: 13.0428 - val_accuracy10: 0.4021 - val_accuracy20: 0.4366 - val_accuracy30: 0.4345 - val_accuracy50: 0.4152 - 13s/epoch - 24ms/step
Epoch 11/50
524/524 - 13s - loss: 12.7167 - accuracy10: 0.4341 - accuracy20: 0.4356 - accuracy30: 0.4310 - accuracy50: 0.4178 - val_loss: 13.0412 - val_accuracy10: 0.4031 - val_accuracy20: 0.4326 - val_accuracy30: 0.4320 - val_accuracy50: 0.4133 - 13s/epoch - 24ms/step
Epoch 12/50
524/524 - 13s - loss: 12.6975 - accuracy10: 0.4390 - accuracy20: 0.4387 - accuracy30: 0.4329 - accuracy50: 0.4199 - val_loss: 13.0459 - val_accuracy10: 0.4055 - val_accuracy20: 0.4306 - val_accuracy30: 0.4298 - val_accuracy50: 0.4100 - 13s/epoch - 25ms/step
Epoch 13/50
524/524 - 13s - loss: 12.6631 - accuracy10: 0.4423 - accuracy20: 0.4434 - accuracy30: 0.4368 - accuracy50: 0.4217 - val_loss: 13.0595 - val_accuracy10: 0.4077 - val_accuracy20: 0.4314 - val_accuracy30: 0.4310 - val_accuracy50: 0.4100 - 13s/epoch - 25ms/step
Epoch 14/50
524/524 - 13s - loss: 12.6374 - accuracy10: 0.4436 - accuracy20: 0.4449 - accuracy30: 0.4394 - accuracy50: 0.4238 - val_loss: 13.0679 - val_accuracy10: 0.4088 - val_accuracy20: 0.4324 - val_accuracy30: 0.4301 - val_accuracy50: 0.4085 - 13s/epoch - 25ms/step
Epoch 15/50
524/524 - 13s - loss: 12.6126 - accuracy10: 0.4453 - accuracy20: 0.4464 - accuracy30: 0.4412 - accuracy50: 0.4271 - val_loss: 13.0862 - val_accuracy10: 0.4074 - val_accuracy20: 0.4248 - val_accuracy30: 0.4238 - val_accuracy50: 0.4053 - 13s/epoch - 25ms/step
Epoch 16/50
524/524 - 13s - loss: 12.5807 - accuracy10: 0.4479 - accuracy20: 0.4506 - accuracy30: 0.4446 - accuracy50: 0.4295 - val_loss: 13.0912 - val_accuracy10: 0.4088 - val_accuracy20: 0.4258 - val_accuracy30: 0.4236 - val_accuracy50: 0.4042 - 13s/epoch - 25ms/step
Epoch 17/50
524/524 - 13s - loss: 12.5490 - accuracy10: 0.4505 - accuracy20: 0.4539 - accuracy30: 0.4487 - accuracy50: 0.4314 - val_loss: 13.1303 - val_accuracy10: 0.4086 - val_accuracy20: 0.4204 - val_accuracy30: 0.4172 - val_accuracy50: 0.3996 - 13s/epoch - 24ms/step
Epoch 18/50
524/524 - 13s - loss: 12.5217 - accuracy10: 0.4540 - accuracy20: 0.4570 - accuracy30: 0.4514 - accuracy50: 0.4339 - val_loss: 13.1564 - val_accuracy10: 0.4055 - val_accuracy20: 0.4159 - val_accuracy30: 0.4148 - val_accuracy50: 0.3971 - 13s/epoch - 24ms/step
Epoch 19/50
524/524 - 13s - loss: 12.4925 - accuracy10: 0.4560 - accuracy20: 0.4600 - accuracy30: 0.4543 - accuracy50: 0.4365 - val_loss: 13.1609 - val_accuracy10: 0.4075 - val_accuracy20: 0.4176 - val_accuracy30: 0.4140 - val_accuracy50: 0.3984 - 13s/epoch - 24ms/step
testing model: results/XRAY/W1/deepOF_L1/seq2seq
Evaluating performance on  test set...
1314/1314 - 16s - 16s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0727066
{'0': {'precision': 0.4167056085470555, 'recall': 0.420500776684666, 'f1-score': 0.4185945906143431, 'support': 108152}, '1': {'precision': 0.4001116157936348, 'recall': 0.22161354581673307, 'f1-score': 0.2852390714534373, 'support': 116464}, '2': {'precision': 0.39582205932995523, 'recall': 0.57653792411594, 'f1-score': 0.4693867133377088, 'support': 111644}, 'accuracy': 0.40342294652947125, 'macro avg': {'precision': 0.40421309455688187, 'recall': 0.406217415539113, 'f1-score': 0.39107345846849645, 'support': 336260}, 'weighted avg': {'precision': 0.4040245708356764, 'recall': 0.40342294652947125, 'f1-score': 0.3892706108539544, 'support': 336260}}
[[45478 19740 42934]
 [35339 25810 55315]
 [28320 18957 64367]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0774804
{'0': {'precision': 0.4770708752220373, 'recall': 0.4010131252882638, 'f1-score': 0.43574802079440045, 'support': 127921}, '1': {'precision': 0.26413193421888803, 'recall': 0.22297969224327435, 'f1-score': 0.2418174981020427, 'support': 76424}, '2': {'precision': 0.45493130998197495, 'recall': 0.5663268013493538, 'f1-score': 0.5045537279109584, 'support': 131915}, 'accuracy': 0.42540296199369537, 'macro avg': {'precision': 0.3987113731409668, 'recall': 0.39677320629363066, 'f1-score': 0.3940397489358005, 'support': 336260}, 'weighted avg': {'precision': 0.4199894906509688, 'recall': 0.42540296199369537, 'f1-score': 0.41866468821853653, 'support': 336260}}
[[51298 24108 52515]
 [22389 17041 36994]
 [33840 23368 74707]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0810189
{'0': {'precision': 0.4873476589093768, 'recall': 0.3859032375630201, 'f1-score': 0.43073311496527444, 'support': 131704}, '1': {'precision': 0.23436564931178935, 'recall': 0.22425986371184792, 'f1-score': 0.22920141632282795, 'support': 69852}, '2': {'precision': 0.46355317899122517, 'recall': 0.5682607791899276, 'f1-score': 0.5105941601214001, 'support': 134704}, 'accuracy': 0.42537619699042406, 'macro avg': {'precision': 0.39508882907079707, 'recall': 0.3928079601549319, 'f1-score': 0.3901762304698342, 'support': 336260}, 'weighted avg': {'precision': 0.425263227346582, 'recall': 0.42537619699042406, 'f1-score': 0.4208604272032408, 'support': 336260}}
[[50825 26495 54384]
 [19987 15665 34200]
 [33477 24680 76547]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0835917
{'0': {'precision': 0.4597671202677516, 'recall': 0.3668183017404722, 'f1-score': 0.40806670372429127, 'support': 125081}, '1': {'precision': 0.2696554551752414, 'recall': 0.2243169816646477, 'f1-score': 0.24490555862299207, 'support': 85027}, '2': {'precision': 0.43909252722720005, 'recall': 0.5768675883061704, 'f1-score': 0.49863817162120955, 'support': 126152}, 'accuracy': 0.4095878189496223, 'macro avg': {'precision': 0.38950503422339766, 'recall': 0.38933429057043006, 'f1-score': 0.3838701446561643, 'support': 336260}, 'weighted avg': {'precision': 0.40393899379099996, 'recall': 0.4095878189496223, 'f1-score': 0.40078861276373656, 'support': 336260}}
[[45882 27668 51531]
 [24523 19073 41431]
 [29389 23990 72773]]
Evaluating performance on  train set...
524/524 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0623237
{'0': {'precision': 0.3639088204410221, 'recall': 0.4676825325423824, 'f1-score': 0.40932075146713254, 'support': 35569}, '1': {'precision': 0.5808732965155549, 'recall': 0.23501800411522633, 'f1-score': 0.3346418393856507, 'support': 62208}, '2': {'precision': 0.34615201862616213, 'recall': 0.6030462735575729, 'f1-score': 0.43983577854253453, 'support': 36241}, 'accuracy': 0.3962900505902192, 'macro avg': {'precision': 0.43031137852757967, 'recall': 0.4352489367383939, 'f1-score': 0.3945994564651059, 'support': 134018}, 'weighted avg': {'precision': 0.45981684677384455, 'recall': 0.3962900505902192, 'f1-score': 0.38290839889863293, 'support': 134018}}
[[16635  5662 13272]
 [19578 14620 28010]
 [ 9499  4887 21855]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0612227
{'0': {'precision': 0.4255438564982152, 'recall': 0.44299803683275685, 'f1-score': 0.43409556743882466, 'support': 42788}, '1': {'precision': 0.4656241574548396, 'recall': 0.2545534943462972, 'f1-score': 0.3291583848394914, 'support': 47491}, '2': {'precision': 0.4061909560398035, 'recall': 0.5898168682411578, 'f1-score': 0.4810770995142236, 'support': 43739}, 'accuracy': 0.42413705621632913, 'macro avg': {'precision': 0.43245298999761944, 'recall': 0.4291227998067373, 'f1-score': 0.41477701726417987, 'support': 134018}, 'weighted avg': {'precision': 0.4334306855777461, 'recall': 0.42413705621632913, 'f1-score': 0.4122429319168869, 'support': 134018}}
[[18955  7304 16529]
 [14217 12089 21185]
 [11371  6570 25798]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0640156
{'0': {'precision': 0.4404108789541263, 'recall': 0.4215736664506469, 'f1-score': 0.4307864450127877, 'support': 44749}, '1': {'precision': 0.4261617150941343, 'recall': 0.2680355920602327, 'f1-score': 0.3290894575402328, 'support': 43830}, '2': {'precision': 0.4179608903420523, 'recall': 0.5851581240784348, 'f1-score': 0.48762551006372934, 'support': 45439}, 'accuracy': 0.42682326254682207, 'macro avg': {'precision': 0.4281778281301043, 'recall': 0.4249224608631048, 'f1-score': 0.4158338042055833, 'support': 134018}, 'weighted avg': {'precision': 0.4281390506584684, 'recall': 0.42682326254682207, 'f1-score': 0.41679825921631003, 'support': 134018}}
[[18865  8441 17443]
 [12498 11748 19584]
 [11472  7378 26589]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0708827
{'0': {'precision': 0.4355474006116208, 'recall': 0.3946400070934563, 'f1-score': 0.4140858501866561, 'support': 45112}, '1': {'precision': 0.4009357748754544, 'recall': 0.26992544247286243, 'f1-score': 0.322638315162186, 'support': 44127}, '2': {'precision': 0.4090013399542839, 'recall': 0.5794010585319012, 'f1-score': 0.47951281719555694, 'support': 44779}, 'accuracy': 0.4153098837469594, 'macro avg': {'precision': 0.41516150514711975, 'recall': 0.4146555026994066, 'f1-score': 0.40541232751479966, 'support': 134018}, 'weighted avg': {'precision': 0.41528136725017156, 'recall': 0.4153098837469594, 'f1-score': 0.40583657604189033, 'support': 134018}}
[[17803  9713 17596]
 [12322 11911 19894]
 [10750  8084 25945]]
Evaluating performance on  val set...
107/107 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0691471
{'0': {'precision': 0.4136871222210839, 'recall': 0.4659589199169167, 'f1-score': 0.43826992999403047, 'support': 8666}, '1': {'precision': 0.44744016964556194, 'recall': 0.14928239336971902, 'f1-score': 0.22387267904509284, 'support': 9894}, '2': {'precision': 0.3826906719591721, 'recall': 0.6270615563298491, 'f1-score': 0.4753059248173255, 'support': 8610}, 'accuracy': 0.40169304379830695, 'macro avg': {'precision': 0.4146059879419393, 'recall': 0.4141009565388282, 'f1-score': 0.37914951128548297, 'support': 27170}, 'weighted avg': {'precision': 0.4161557719988802, 'recall': 0.40169304379830695, 'f1-score': 0.3719332908530581, 'support': 27170}}
[[4038  988 3640]
 [3348 1477 5069]
 [2375  836 5399]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0699837
{'0': {'precision': 0.47283744254074384, 'recall': 0.43805652342237705, 'f1-score': 0.45478295819935693, 'support': 10332}, '1': {'precision': 0.2981981981981982, 'recall': 0.1528162511542013, 'f1-score': 0.20207570207570208, 'support': 6498}, '2': {'precision': 0.4449817774039809, 'recall': 0.6140232108317215, 'f1-score': 0.5160110533159947, 'support': 10340}, 'accuracy': 0.4368052999631947, 'macro avg': {'precision': 0.40533913938097427, 'recall': 0.4016319951361, 'f1-score': 0.39095657119701793, 'support': 27170}, 'weighted avg': {'precision': 0.42046963292528605, 'recall': 0.4368052999631947, 'f1-score': 0.41764665909057974, 'support': 27170}}
[[4526 1244 4562]
 [2148  993 3357]
 [2898 1093 6349]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0739213
{'0': {'precision': 0.4799268108922613, 'recall': 0.4194337315398363, 'f1-score': 0.4476458186929023, 'support': 10631}, '1': {'precision': 0.26153846153846155, 'recall': 0.15556685307574988, 'f1-score': 0.19509085113165447, 'support': 5901}, '2': {'precision': 0.4545897418052752, 'recall': 0.6140251927053958, 'f1-score': 0.522413724157236, 'support': 10638}, 'accuracy': 0.4383143172616857, 'macro avg': {'precision': 0.3986850047453327, 'recall': 0.3963419257736607, 'f1-score': 0.38838346466059753, 'support': 27170}, 'weighted avg': {'precision': 0.42257512187922736, 'recall': 0.4383143172616857, 'f1-score': 0.42206812692811235, 'support': 27170}}
[[4459 1371 4801]
 [1947  918 3036]
 [2885 1221 6532]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0807287
{'0': {'precision': 0.4585216998191682, 'recall': 0.4003355042431419, 'f1-score': 0.42745759140238115, 'support': 10134}, '1': {'precision': 0.28527051514367074, 'recall': 0.15989553105049334, 'f1-score': 0.20492794049279403, 'support': 6892}, '2': {'precision': 0.42872951103119167, 'recall': 0.6111001577287066, 'f1-score': 0.5039222859000936, 'support': 10144}, 'accuracy': 0.4180345969819654, 'macro avg': {'precision': 0.39084057533134353, 'recall': 0.39044373100744734, 'f1-score': 0.3787692725984229, 'support': 27170}, 'weighted avg': {'precision': 0.40345143379602644, 'recall': 0.4180345969819654, 'f1-score': 0.3995585669973727, 'support': 27170}}
[[4057 1435 4642]
 [2172 1102 3618]
 [2619 1326 6199]]
training model: results/XRAY/W1/deepLOB_L2/seq2seq
Epoch 1/50
524/524 - 32s - loss: 12.7075 - accuracy10: 0.4439 - accuracy20: 0.4354 - accuracy30: 0.4257 - accuracy50: 0.4069 - val_loss: 13.6735 - val_accuracy10: 0.3720 - val_accuracy20: 0.3333 - val_accuracy30: 0.3354 - val_accuracy50: 0.3493 - 32s/epoch - 61ms/step
Epoch 2/50
524/524 - 26s - loss: 12.4265 - accuracy10: 0.4568 - accuracy20: 0.4594 - accuracy30: 0.4489 - accuracy50: 0.4226 - val_loss: 12.8621 - val_accuracy10: 0.4196 - val_accuracy20: 0.4523 - val_accuracy30: 0.4512 - val_accuracy50: 0.4219 - 26s/epoch - 50ms/step
Epoch 3/50
524/524 - 26s - loss: 12.2072 - accuracy10: 0.4763 - accuracy20: 0.4770 - accuracy30: 0.4643 - accuracy50: 0.4354 - val_loss: 13.0448 - val_accuracy10: 0.4316 - val_accuracy20: 0.4380 - val_accuracy30: 0.4324 - val_accuracy50: 0.4070 - 26s/epoch - 49ms/step
Epoch 4/50
524/524 - 26s - loss: 12.0336 - accuracy10: 0.4970 - accuracy20: 0.4941 - accuracy30: 0.4803 - accuracy50: 0.4474 - val_loss: 12.9750 - val_accuracy10: 0.4477 - val_accuracy20: 0.4395 - val_accuracy30: 0.4294 - val_accuracy50: 0.4014 - 26s/epoch - 49ms/step
Epoch 5/50
524/524 - 26s - loss: 11.9051 - accuracy10: 0.5088 - accuracy20: 0.5050 - accuracy30: 0.4875 - accuracy50: 0.4533 - val_loss: 12.8676 - val_accuracy10: 0.4478 - val_accuracy20: 0.4448 - val_accuracy30: 0.4351 - val_accuracy50: 0.4072 - 26s/epoch - 50ms/step
Epoch 6/50
524/524 - 26s - loss: 11.8056 - accuracy10: 0.5166 - accuracy20: 0.5126 - accuracy30: 0.4956 - accuracy50: 0.4595 - val_loss: 12.7698 - val_accuracy10: 0.4485 - val_accuracy20: 0.4575 - val_accuracy30: 0.4482 - val_accuracy50: 0.4184 - 26s/epoch - 49ms/step
Epoch 7/50
524/524 - 26s - loss: 11.7460 - accuracy10: 0.5236 - accuracy20: 0.5187 - accuracy30: 0.5013 - accuracy50: 0.4641 - val_loss: 12.7647 - val_accuracy10: 0.4456 - val_accuracy20: 0.4610 - val_accuracy30: 0.4518 - val_accuracy50: 0.4185 - 26s/epoch - 49ms/step
Epoch 8/50
524/524 - 26s - loss: 11.6574 - accuracy10: 0.5317 - accuracy20: 0.5248 - accuracy30: 0.5075 - accuracy50: 0.4682 - val_loss: 12.7622 - val_accuracy10: 0.4442 - val_accuracy20: 0.4635 - val_accuracy30: 0.4557 - val_accuracy50: 0.4212 - 26s/epoch - 49ms/step
Epoch 9/50
524/524 - 26s - loss: 11.5999 - accuracy10: 0.5389 - accuracy20: 0.5324 - accuracy30: 0.5136 - accuracy50: 0.4724 - val_loss: 12.6769 - val_accuracy10: 0.4523 - val_accuracy20: 0.4747 - val_accuracy30: 0.4630 - val_accuracy50: 0.4226 - 26s/epoch - 49ms/step
Epoch 10/50
524/524 - 26s - loss: 11.5379 - accuracy10: 0.5460 - accuracy20: 0.5381 - accuracy30: 0.5183 - accuracy50: 0.4766 - val_loss: 12.6166 - val_accuracy10: 0.4575 - val_accuracy20: 0.4776 - val_accuracy30: 0.4659 - val_accuracy50: 0.4255 - 26s/epoch - 50ms/step
Epoch 11/50
524/524 - 26s - loss: 11.4710 - accuracy10: 0.5503 - accuracy20: 0.5416 - accuracy30: 0.5222 - accuracy50: 0.4790 - val_loss: 12.7070 - val_accuracy10: 0.4490 - val_accuracy20: 0.4709 - val_accuracy30: 0.4608 - val_accuracy50: 0.4241 - 26s/epoch - 50ms/step
Epoch 12/50
524/524 - 26s - loss: 11.4350 - accuracy10: 0.5560 - accuracy20: 0.5469 - accuracy30: 0.5265 - accuracy50: 0.4836 - val_loss: 12.7411 - val_accuracy10: 0.4557 - val_accuracy20: 0.4694 - val_accuracy30: 0.4580 - val_accuracy50: 0.4235 - 26s/epoch - 49ms/step
Epoch 13/50
524/524 - 26s - loss: 11.3578 - accuracy10: 0.5620 - accuracy20: 0.5519 - accuracy30: 0.5315 - accuracy50: 0.4868 - val_loss: 12.7768 - val_accuracy10: 0.4584 - val_accuracy20: 0.4666 - val_accuracy30: 0.4566 - val_accuracy50: 0.4205 - 26s/epoch - 49ms/step
Epoch 14/50
524/524 - 26s - loss: 11.3149 - accuracy10: 0.5648 - accuracy20: 0.5551 - accuracy30: 0.5351 - accuracy50: 0.4903 - val_loss: 12.7321 - val_accuracy10: 0.4699 - val_accuracy20: 0.4745 - val_accuracy30: 0.4607 - val_accuracy50: 0.4272 - 26s/epoch - 50ms/step
Epoch 15/50
524/524 - 26s - loss: 11.2796 - accuracy10: 0.5657 - accuracy20: 0.5560 - accuracy30: 0.5348 - accuracy50: 0.4904 - val_loss: 12.6882 - val_accuracy10: 0.4628 - val_accuracy20: 0.4738 - val_accuracy30: 0.4603 - val_accuracy50: 0.4240 - 26s/epoch - 49ms/step
Epoch 16/50
524/524 - 27s - loss: 11.2526 - accuracy10: 0.5670 - accuracy20: 0.5577 - accuracy30: 0.5368 - accuracy50: 0.4928 - val_loss: 12.6716 - val_accuracy10: 0.4662 - val_accuracy20: 0.4769 - val_accuracy30: 0.4676 - val_accuracy50: 0.4311 - 27s/epoch - 51ms/step
Epoch 17/50
524/524 - 26s - loss: 11.2321 - accuracy10: 0.5702 - accuracy20: 0.5610 - accuracy30: 0.5408 - accuracy50: 0.4947 - val_loss: 12.6816 - val_accuracy10: 0.4628 - val_accuracy20: 0.4761 - val_accuracy30: 0.4638 - val_accuracy50: 0.4281 - 26s/epoch - 49ms/step
Epoch 18/50
524/524 - 26s - loss: 11.1516 - accuracy10: 0.5743 - accuracy20: 0.5666 - accuracy30: 0.5459 - accuracy50: 0.4997 - val_loss: 12.7904 - val_accuracy10: 0.4516 - val_accuracy20: 0.4681 - val_accuracy30: 0.4581 - val_accuracy50: 0.4182 - 26s/epoch - 50ms/step
Epoch 19/50
524/524 - 27s - loss: 11.1155 - accuracy10: 0.5754 - accuracy20: 0.5663 - accuracy30: 0.5472 - accuracy50: 0.5020 - val_loss: 12.7839 - val_accuracy10: 0.4688 - val_accuracy20: 0.4775 - val_accuracy30: 0.4656 - val_accuracy50: 0.4285 - 27s/epoch - 51ms/step
Epoch 20/50
524/524 - 26s - loss: 11.0940 - accuracy10: 0.5766 - accuracy20: 0.5683 - accuracy30: 0.5488 - accuracy50: 0.5026 - val_loss: 12.7727 - val_accuracy10: 0.4633 - val_accuracy20: 0.4786 - val_accuracy30: 0.4662 - val_accuracy50: 0.4276 - 26s/epoch - 49ms/step
testing model: results/XRAY/W1/deepLOB_L2/seq2seq
Evaluating performance on  test set...
1314/1314 - 27s - 27s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0831476
{'0': {'precision': 0.44086226300753184, 'recall': 0.4708514789233771, 'f1-score': 0.45536364977667293, 'support': 108153}, '1': {'precision': 0.5413231944148544, 'recall': 0.2836155378486056, 'f1-score': 0.3722159305398264, 'support': 116464}, '2': {'precision': 0.4236490208844594, 'recall': 0.6061192318715964, 'f1-score': 0.4987176841670843, 'support': 111648}, 'accuracy': 0.45091520080888586, 'macro avg': {'precision': 0.4686114927689486, 'recall': 0.4535287495478597, 'f1-score': 0.4420990881611946, 'support': 336265}, 'weighted avg': {'precision': 0.4699412865718802, 'recall': 0.45091520080888586, 'f1-score': 0.440960352551034, 'support': 336265}}
[[50924 14418 42811]
 [34180 33031 49253]
 [30406 13570 67672]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0530983
{'0': {'precision': 0.48960312623238805, 'recall': 0.42702918207331086, 'f1-score': 0.4561803476510796, 'support': 127921}, '1': {'precision': 0.39285467844327904, 'recall': 0.29798230922223384, 'f1-score': 0.3389041014346092, 'support': 76424}, '2': {'precision': 0.47385814964762335, 'recall': 0.5988781079442086, 'f1-score': 0.5290830249962329, 'support': 131920}, 'accuracy': 0.465118284686185, 'macro avg': {'precision': 0.45210531810776344, 'recall': 0.44129653307991773, 'f1-score': 0.44138915802730727, 'support': 336265}, 'weighted avg': {'precision': 0.46143789736558055, 'recall': 0.465118284686185, 'f1-score': 0.45812703063778687, 'support': 336265}}
[[54626 17972 55323]
 [21253 22773 32398]
 [35693 17223 79004]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0616809
{'0': {'precision': 0.48686611419448034, 'recall': 0.38897831500941504, 'f1-score': 0.4324520529443544, 'support': 131704}, '1': {'precision': 0.3403732986750424, 'recall': 0.26994216343125466, 'f1-score': 0.30109381237524946, 'support': 69852}, '2': {'precision': 0.4669186930307499, 'recall': 0.6088011936841636, 'f1-score': 0.5285031190390267, 'support': 134709}, 'accuracy': 0.45231290797436546, 'macro avg': {'precision': 0.4313860353000909, 'recall': 0.42257389070827783, 'f1-score': 0.42068299478621024, 'support': 336265}, 'weighted avg': {'precision': 0.4484442941798825, 'recall': 0.45231290797436546, 'f1-score': 0.44364354549431967, 'support': 336265}}
[[51230 18744 61730]
 [19094 18856 31902]
 [34900 17798 82011]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1072402
{'0': {'precision': 0.4408408717105263, 'recall': 0.34285508706288675, 'f1-score': 0.38572238062258835, 'support': 125082}, '1': {'precision': 0.3134438794869849, 'recall': 0.19430298611029437, 'f1-score': 0.2398954514103169, 'support': 85027}, '2': {'precision': 0.42071753356560393, 'recall': 0.6212150036462792, 'f1-score': 0.5016755592399011, 'support': 126156}, 'accuracy': 0.40972447325769856, 'macro avg': {'precision': 0.39166742825437173, 'recall': 0.38612435893982006, 'f1-score': 0.37576446375760214, 'support': 336265}, 'weighted avg': {'precision': 0.40107799450117687, 'recall': 0.40972447325769856, 'f1-score': 0.3923509708461142, 'support': 336265}}
[[42885 18725 63472]
 [24071 16521 44435]
 [30324 17462 78370]]
Evaluating performance on  train set...
524/524 - 11s - 11s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0131723
{'0': {'precision': 0.4128210354667754, 'recall': 0.5685531413171635, 'f1-score': 0.47833069601568223, 'support': 35622}, '1': {'precision': 0.7075365879713705, 'recall': 0.425330721808374, 'f1-score': 0.5312838406930573, 'support': 62288}, '2': {'precision': 0.3826030222671213, 'recall': 0.503461836712086, 'f1-score': 0.43478988782856187, 'support': 36108}, 'accuracy': 0.48444985002014657, 'macro avg': {'precision': 0.5009868819017557, 'recall': 0.49911523327920787, 'f1-score': 0.48146814151243383, 'support': 134018}, 'weighted avg': {'precision': 0.5416554481112942, 'recall': 0.48444985002014657, 'f1-score': 0.4912108611699436, 'support': 134018}}
[[20253  5441  9928]
 [16388 26493 19407]
 [12419  5510 18179]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.99691147
{'0': {'precision': 0.4641225477022306, 'recall': 0.5236140588194137, 'f1-score': 0.49207671232876715, 'support': 42877}, '1': {'precision': 0.591375481404436, 'recall': 0.4435191431944679, 'f1-score': 0.5068851274019638, 'support': 47432}, '2': {'precision': 0.44244288224956063, 'recall': 0.5068521357157565, 'f1-score': 0.4724624390868086, 'support': 43709}, 'accuracy': 0.4897998776283783, 'macro avg': {'precision': 0.4993136371187424, 'recall': 0.4913284459098794, 'f1-score': 0.4904747596058465, 'support': 134018}, 'weighted avg': {'precision': 0.5020895719384694, 'recall': 0.4897998776283783, 'f1-score': 0.49092069205252886, 'support': 134018}}
[[22451  7256 13170]
 [11647 21037 14748]
 [14275  7280 22154]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0118812
{'0': {'precision': 0.46974690360796983, 'recall': 0.486394861272192, 'f1-score': 0.47792594865276516, 'support': 44836}, '1': {'precision': 0.5428384953126855, 'recall': 0.41722911346224006, 'f1-score': 0.4718168222371203, 'support': 43856}, '2': {'precision': 0.44181126473044446, 'recall': 0.5252393769580374, 'f1-score': 0.4799266210400056, 'support': 45326}, 'accuracy': 0.4768986255577609, 'macro avg': {'precision': 0.4847988878836999, 'recall': 0.4762877838974899, 'f1-score': 0.4765564639766304, 'support': 134018}, 'weighted avg': {'precision': 0.4842173036888492, 'recall': 0.4768986255577609, 'f1-score': 0.47660344442601604, 'support': 134018}}
[[21808  7765 15263]
 [10743 18298 14815]
 [13874  7645 23807]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0490569
{'0': {'precision': 0.44636143466728173, 'recall': 0.42908139509101795, 'f1-score': 0.4375508727502939, 'support': 45101}, '1': {'precision': 0.49153875188726726, 'recall': 0.35386426937795795, 'f1-score': 0.4114913169986702, 'support': 44161}, '2': {'precision': 0.4152638820471879, 'recall': 0.5462284386450978, 'f1-score': 0.4718268404952377, 'support': 44756}, 'accuracy': 0.4434180483218672, 'macro avg': {'precision': 0.45105468953391226, 'recall': 0.44305803437135793, 'f1-score': 0.4402896767480673, 'support': 134018}, 'weighted avg': {'precision': 0.45086287059892416, 'recall': 0.4434180483218672, 'f1-score': 0.44041048243589775, 'support': 134018}}
[[19352  8289 17460]
 [11570 15627 16964]
 [12433  7876 24447]]
Evaluating performance on  val set...
107/107 - 2s - 2s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0535268
{'0': {'precision': 0.4656180252949304, 'recall': 0.5045491189680986, 'f1-score': 0.4843024541233694, 'support': 8683}, '1': {'precision': 0.5706441393875396, 'recall': 0.27378660451920156, 'f1-score': 0.3700356066831005, 'support': 9869}, '2': {'precision': 0.4135575003838477, 'recall': 0.6250870271524716, 'f1-score': 0.4977822953243393, 'support': 8618}, 'accuracy': 0.4589620905410379, 'macro avg': {'precision': 0.4832732216887725, 'recall': 0.4678075835465905, 'f1-score': 0.4507067853769364, 'support': 27170}, 'weighted avg': {'precision': 0.4872538411321129, 'recall': 0.4589620905410379, 'f1-score': 0.4470727800005113, 'support': 27170}}
[[4381 1089 3213]
 [2741 2702 4426]
 [2287  944 5387]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0261403
{'0': {'precision': 0.5150313842087876, 'recall': 0.45328552044969955, 'f1-score': 0.4821898035981236, 'support': 10318}, '1': {'precision': 0.4246225319396051, 'recall': 0.28075564429427124, 'f1-score': 0.3380177514792899, 'support': 6511}, '2': {'precision': 0.4677887405687754, 'recall': 0.6235373754956001, 'f1-score': 0.5345492227979275, 'support': 10341}, 'accuracy': 0.4767390504232609, 'macro avg': {'precision': 0.469147552239056, 'recall': 0.452526180079857, 'f1-score': 0.4515855926251137, 'support': 27170}, 'weighted avg': {'precision': 0.475385148838673, 'recall': 0.4767390504232609, 'f1-score': 0.46756869659037414, 'support': 27170}}
[[4677 1316 4325]
 [1672 1828 3011]
 [2732 1161 6448]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0344927
{'0': {'precision': 0.5103504105470105, 'recall': 0.41561499340742136, 'f1-score': 0.45813651699974045, 'support': 10618}, '1': {'precision': 0.36661506707946334, 'recall': 0.24303061399008039, 'f1-score': 0.2922966162706983, 'support': 5847}, '2': {'precision': 0.4675360142008602, 'recall': 0.6397010742643624, 'f1-score': 0.5402335121489428, 'support': 10705}, 'accuracy': 0.4667648141332352, 'macro avg': {'precision': 0.4481671639424447, 'recall': 0.43278222722062143, 'f1-score': 0.43022221513979386, 'support': 27170}, 'weighted avg': {'precision': 0.46254957631291826, 'recall': 0.4667648141332352, 'f1-score': 0.4547939492231302, 'support': 27170}}
[[4413 1288 4917]
 [1544 1421 2882]
 [2690 1167 6848]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0738775
{'0': {'precision': 0.468467352248792, 'recall': 0.37236557021863304, 'f1-score': 0.4149245541838134, 'support': 10154}, '1': {'precision': 0.34121719065474476, 'recall': 0.1728521332554062, 'f1-score': 0.22946367956551258, 'support': 6844}, '2': {'precision': 0.42860798362333674, 'recall': 0.6586708611875738, 'f1-score': 0.5192993334366764, 'support': 10172}, 'accuracy': 0.429297018770703, 'macro avg': {'precision': 0.4127641755089579, 'recall': 0.4012961882205377, 'f1-score': 0.3878958557286675, 'support': 27170}, 'weighted avg': {'precision': 0.4214909222301026, 'recall': 0.429297018770703, 'f1-score': 0.4072839957985529, 'support': 27170}}
[[3781 1199 5174]
 [1903 1183 3758]
 [2387 1085 6700]]
training model: results/XRAY/W1/deepOF_L2/seq2seq
Epoch 1/50
524/524 - 23s - loss: 12.6166 - accuracy10: 0.4543 - accuracy20: 0.4464 - accuracy30: 0.4335 - accuracy50: 0.4093 - val_loss: 12.8340 - val_accuracy10: 0.4621 - val_accuracy20: 0.4271 - val_accuracy30: 0.4077 - val_accuracy50: 0.3917 - 23s/epoch - 43ms/step
Epoch 2/50
524/524 - 17s - loss: 11.9790 - accuracy10: 0.5237 - accuracy20: 0.5048 - accuracy30: 0.4850 - accuracy50: 0.4488 - val_loss: 13.0185 - val_accuracy10: 0.4845 - val_accuracy20: 0.4330 - val_accuracy30: 0.4026 - val_accuracy50: 0.3818 - 17s/epoch - 32ms/step
Epoch 3/50
524/524 - 17s - loss: 11.6760 - accuracy10: 0.5507 - accuracy20: 0.5348 - accuracy30: 0.5118 - accuracy50: 0.4691 - val_loss: 12.7522 - val_accuracy10: 0.4919 - val_accuracy20: 0.4642 - val_accuracy30: 0.4387 - val_accuracy50: 0.4082 - 17s/epoch - 32ms/step
Epoch 4/50
524/524 - 17s - loss: 11.5379 - accuracy10: 0.5593 - accuracy20: 0.5435 - accuracy30: 0.5212 - accuracy50: 0.4755 - val_loss: 12.6969 - val_accuracy10: 0.4970 - val_accuracy20: 0.4683 - val_accuracy30: 0.4459 - val_accuracy50: 0.4153 - 17s/epoch - 32ms/step
Epoch 5/50
524/524 - 17s - loss: 11.4607 - accuracy10: 0.5642 - accuracy20: 0.5476 - accuracy30: 0.5254 - accuracy50: 0.4810 - val_loss: 12.6643 - val_accuracy10: 0.4963 - val_accuracy20: 0.4695 - val_accuracy30: 0.4481 - val_accuracy50: 0.4163 - 17s/epoch - 32ms/step
Epoch 6/50
524/524 - 17s - loss: 11.4003 - accuracy10: 0.5667 - accuracy20: 0.5519 - accuracy30: 0.5287 - accuracy50: 0.4835 - val_loss: 12.6781 - val_accuracy10: 0.4988 - val_accuracy20: 0.4679 - val_accuracy30: 0.4445 - val_accuracy50: 0.4142 - 17s/epoch - 32ms/step
Epoch 7/50
524/524 - 17s - loss: 11.3521 - accuracy10: 0.5706 - accuracy20: 0.5564 - accuracy30: 0.5324 - accuracy50: 0.4878 - val_loss: 12.6746 - val_accuracy10: 0.5014 - val_accuracy20: 0.4714 - val_accuracy30: 0.4485 - val_accuracy50: 0.4162 - 17s/epoch - 32ms/step
Epoch 8/50
524/524 - 17s - loss: 11.3073 - accuracy10: 0.5748 - accuracy20: 0.5605 - accuracy30: 0.5359 - accuracy50: 0.4902 - val_loss: 12.6750 - val_accuracy10: 0.5004 - val_accuracy20: 0.4728 - val_accuracy30: 0.4527 - val_accuracy50: 0.4223 - 17s/epoch - 32ms/step
Epoch 9/50
524/524 - 17s - loss: 11.2726 - accuracy10: 0.5762 - accuracy20: 0.5625 - accuracy30: 0.5379 - accuracy50: 0.4919 - val_loss: 12.6753 - val_accuracy10: 0.5007 - val_accuracy20: 0.4715 - val_accuracy30: 0.4484 - val_accuracy50: 0.4159 - 17s/epoch - 32ms/step
Epoch 10/50
524/524 - 17s - loss: 11.2302 - accuracy10: 0.5787 - accuracy20: 0.5638 - accuracy30: 0.5407 - accuracy50: 0.4946 - val_loss: 12.7214 - val_accuracy10: 0.4982 - val_accuracy20: 0.4709 - val_accuracy30: 0.4500 - val_accuracy50: 0.4208 - 17s/epoch - 32ms/step
Epoch 11/50
524/524 - 17s - loss: 11.1933 - accuracy10: 0.5801 - accuracy20: 0.5658 - accuracy30: 0.5428 - accuracy50: 0.4985 - val_loss: 12.6748 - val_accuracy10: 0.4998 - val_accuracy20: 0.4739 - val_accuracy30: 0.4517 - val_accuracy50: 0.4199 - 17s/epoch - 32ms/step
Epoch 12/50
524/524 - 17s - loss: 11.1636 - accuracy10: 0.5825 - accuracy20: 0.5689 - accuracy30: 0.5462 - accuracy50: 0.4993 - val_loss: 12.6956 - val_accuracy10: 0.5001 - val_accuracy20: 0.4733 - val_accuracy30: 0.4510 - val_accuracy50: 0.4202 - 17s/epoch - 32ms/step
Epoch 13/50
524/524 - 17s - loss: 11.1355 - accuracy10: 0.5835 - accuracy20: 0.5700 - accuracy30: 0.5469 - accuracy50: 0.5014 - val_loss: 12.7327 - val_accuracy10: 0.5004 - val_accuracy20: 0.4704 - val_accuracy30: 0.4486 - val_accuracy50: 0.4205 - 17s/epoch - 32ms/step
Epoch 14/50
524/524 - 17s - loss: 11.0934 - accuracy10: 0.5859 - accuracy20: 0.5724 - accuracy30: 0.5499 - accuracy50: 0.5044 - val_loss: 12.7847 - val_accuracy10: 0.5014 - val_accuracy20: 0.4721 - val_accuracy30: 0.4501 - val_accuracy50: 0.4181 - 17s/epoch - 33ms/step
Epoch 15/50
524/524 - 17s - loss: 11.0685 - accuracy10: 0.5877 - accuracy20: 0.5748 - accuracy30: 0.5527 - accuracy50: 0.5070 - val_loss: 12.7284 - val_accuracy10: 0.4996 - val_accuracy20: 0.4768 - val_accuracy30: 0.4544 - val_accuracy50: 0.4243 - 17s/epoch - 32ms/step
testing model: results/XRAY/W1/deepOF_L2/seq2seq
Evaluating performance on  test set...
1314/1314 - 19s - 19s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0275421
{'0': {'precision': 0.510039462907349, 'recall': 0.380020711591094, 'f1-score': 0.4355336081469158, 'support': 108152}, '1': {'precision': 0.5045861438567736, 'recall': 0.5498179695013051, 'f1-score': 0.5262318792939088, 'support': 116464}, '2': {'precision': 0.465536521347477, 'recall': 0.5369657124431227, 'f1-score': 0.4987064196524386, 'support': 111644}, 'accuracy': 0.49093855944804615, 'macro avg': {'precision': 0.49338737603719984, 'recall': 0.4889347978451739, 'f1-score': 0.48682396903108777, 'support': 336260}, 'weighted avg': {'precision': 0.49337497186643847, 'recall': 0.49093855944804615, 'f1-score': 0.48792148900870724, 'support': 336260}}
[[41100 30542 36510]
 [20115 64034 32315]
 [19367 32328 59949]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0623688
{'0': {'precision': 0.5442375918949562, 'recall': 0.34896537706865954, 'f1-score': 0.4252562588118736, 'support': 127921}, '1': {'precision': 0.3518951342693232, 'recall': 0.5634355699780174, 'f1-score': 0.4332209869711756, 'support': 76424}, '2': {'precision': 0.5053499253057913, 'recall': 0.5051813667892203, 'f1-score': 0.5052656319895673, 'support': 131915}, 'accuracy': 0.45899304109914946, 'macro avg': {'precision': 0.4671608838233569, 'recall': 0.47252743794529906, 'f1-score': 0.4545809592575389, 'support': 336260}, 'weighted avg': {'precision': 0.4852670140097154, 'recall': 0.45899304109914946, 'f1-score': 0.4584541796100119, 'support': 336260}}
[[44640 38418 44863]
 [12997 43060 20367]
 [24386 40888 66641]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.081351
{'0': {'precision': 0.5295636394636528, 'recall': 0.3301570187693616, 'f1-score': 0.4067347940977013, 'support': 131704}, '1': {'precision': 0.30372134763610137, 'recall': 0.5184246693008074, 'f1-score': 0.38303813669129433, 'support': 69852}, '2': {'precision': 0.49485613483745683, 'recall': 0.49564229718493885, 'f1-score': 0.4952489040211852, 'support': 134704}, 'accuracy': 0.43555879379051926, 'macro avg': {'precision': 0.44271370731240367, 'recall': 0.44807466175170263, 'f1-score': 0.4283406116033936, 'support': 336260}, 'weighted avg': {'precision': 0.4687452980852396, 'recall': 0.43555879379051926, 'f1-score': 0.4372705276074278, 'support': 336260}}
[[43483 40743 47478]
 [12964 36213 20675]
 [25664 42275 66765]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1120745
{'0': {'precision': 0.46598952778047126, 'recall': 0.3073688250013991, 'f1-score': 0.3704121203362478, 'support': 125081}, '1': {'precision': 0.29320265303535975, 'recall': 0.4081291824949722, 'f1-score': 0.34124947143798373, 'support': 85027}, '2': {'precision': 0.4410528725784891, 'recall': 0.47338924472065447, 'f1-score': 0.4566493215524196, 'support': 126152}, 'accuracy': 0.39513174329387973, 'macro avg': {'precision': 0.4000816844647734, 'recall': 0.3962957507390086, 'f1-score': 0.3894369711088837, 'support': 336260}, 'weighted avg': {'precision': 0.41294319896945286, 'recall': 0.39513174329387973, 'f1-score': 0.39539095474994496, 'support': 336260}}
[[38446 42008 44627]
 [19270 34702 31055]
 [24788 41645 59719]]
Evaluating performance on  train set...
524/524 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9101565
{'0': {'precision': 0.4894592413236481, 'recall': 0.426241952261801, 'f1-score': 0.4556684299110363, 'support': 35569}, '1': {'precision': 0.664740869241969, 'recall': 0.6898951903292181, 'f1-score': 0.6770844837106571, 'support': 62208}, '2': {'precision': 0.4720771289727398, 'recall': 0.5012554841201954, 'f1-score': 0.4862289553277482, 'support': 36241}, 'accuracy': 0.5689086540613948, 'macro avg': {'precision': 0.5420924131794522, 'recall': 0.5391308755704048, 'f1-score': 0.5396606229831472, 'support': 134018}, 'weighted avg': {'precision': 0.5661203941227769, 'recall': 0.5689086540613948, 'f1-score': 0.5667086922369468, 'support': 134018}}
[[15161 10258 10150]
 [ 9126 42917 10165]
 [ 6688 11387 18166]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9552134
{'0': {'precision': 0.5327578088212211, 'recall': 0.3966298962325886, 'f1-score': 0.4547244885655722, 'support': 42788}, '1': {'precision': 0.5398215890129636, 'recall': 0.7084710787307069, 'f1-score': 0.6127537129276355, 'support': 47491}, '2': {'precision': 0.5152253043805699, 'recall': 0.46923797983492993, 'f1-score': 0.49115753703304854, 'support': 43739}, 'accuracy': 0.5308316793266576, 'macro avg': {'precision': 0.529268234071585, 'recall': 0.5247796515994085, 'f1-score': 0.5195452461754188, 'support': 134018}, 'weighted avg': {'precision': 0.5295389260842485, 'recall': 0.5308316793266576, 'f1-score': 0.5226147048133725, 'support': 134018}}
[[16971 13517 12300]
 [ 6834 33646  7011]
 [ 8050 15165 20524]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9888161
{'0': {'precision': 0.5246833487797343, 'recall': 0.37953920758005766, 'f1-score': 0.4404621429219777, 'support': 44749}, '1': {'precision': 0.49057635884429857, 'recall': 0.6752224503764545, 'f1-score': 0.5682767360811084, 'support': 43830}, '2': {'precision': 0.5049006558408557, 'recall': 0.459143026915205, 'f1-score': 0.48093591516828027, 'support': 45439}, 'accuracy': 0.5032309092808429, 'macro avg': {'precision': 0.5067201211549629, 'recall': 0.504634894957239, 'f1-score': 0.4965582647237888, 'support': 134018}, 'weighted avg': {'precision': 0.5068214559495186, 'recall': 0.5032309092808429, 'f1-score': 0.4959860378858217, 'support': 134018}}
[[16984 14571 13194]
 [ 6971 29595  7264]
 [ 8415 16161 20863]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0363375
{'0': {'precision': 0.48870835733123164, 'recall': 0.3573771945380387, 'f1-score': 0.41285002752845684, 'support': 45112}, '1': {'precision': 0.44603587474242473, 'recall': 0.5984544609876039, 'f1-score': 0.5111242294329982, 'support': 44127}, '2': {'precision': 0.4616359419458193, 'recall': 0.4311619285825945, 'f1-score': 0.44587884806355504, 'support': 44779}, 'accuracy': 0.4614081690519184, 'macro avg': {'precision': 0.4654600580064919, 'recall': 0.4623311947027457, 'f1-score': 0.4566177016750033, 'support': 134018}, 'weighted avg': {'precision': 0.4656123230094266, 'recall': 0.4614081690519184, 'f1-score': 0.456243775101043, 'support': 134018}}
[[16122 15821 13169]
 [ 8372 26408  9347]
 [ 8495 16977 19307]]
Evaluating performance on  val set...
107/107 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0053077
{'0': {'precision': 0.5074040495618012, 'recall': 0.3874913454881145, 'f1-score': 0.4394137660298351, 'support': 8666}, '1': {'precision': 0.5362303986881214, 'recall': 0.5288053365676167, 'f1-score': 0.5324919851407054, 'support': 9894}, '2': {'precision': 0.4522464103751737, 'recall': 0.5670150987224158, 'f1-score': 0.5031692862664262, 'support': 8610}, 'accuracy': 0.495841001104159, 'macro avg': {'precision': 0.49862695287503206, 'recall': 0.49443726025938234, 'f1-score': 0.4916916791456556, 'support': 27170}, 'weighted avg': {'precision': 0.5004221071569043, 'recall': 0.495841001104159, 'f1-score': 0.4935120703772771, 'support': 27170}}
[[3358 2317 2991]
 [1740 5232 2922]
 [1520 2208 4882]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0258266
{'0': {'precision': 0.5436907582938388, 'recall': 0.35530391018195895, 'f1-score': 0.4297588386794662, 'support': 10332}, '1': {'precision': 0.380248500428449, 'recall': 0.546321945213912, 'f1-score': 0.4484021725401036, 'support': 6498}, '2': {'precision': 0.4997292907417434, 'recall': 0.5355899419729206, 'f1-score': 0.5170385584912706, 'support': 10340}, 'accuracy': 0.46959882223040117, 'macro avg': {'precision': 0.4745561831546771, 'recall': 0.47907193245626384, 'f1-score': 0.4650665232369468, 'support': 27170}, 'weighted avg': {'precision': 0.4878714956476125, 'recall': 0.46959882223040117, 'f1-score': 0.4674333578653506, 'support': 27170}}
[[3671 2915 3746]
 [1150 3550 1798]
 [1931 2871 5538]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0468843
{'0': {'precision': 0.5284082480344162, 'recall': 0.33505784968488384, 'f1-score': 0.4100851945659682, 'support': 10631}, '1': {'precision': 0.32894154118689106, 'recall': 0.5034739874597526, 'f1-score': 0.39791066764883143, 'support': 5901}, '2': {'precision': 0.4910941475826972, 'recall': 0.5261327317164881, 'f1-score': 0.5080099841161788, 'support': 10638}, 'accuracy': 0.44644828855355173, 'macro avg': {'precision': 0.44948131226800153, 'recall': 0.45488818962037486, 'f1-score': 0.4386686154436594, 'support': 27170}, 'weighted avg': {'precision': 0.47047668978220303, 'recall': 0.44644828855355173, 'f1-score': 0.4457819935316331, 'support': 27170}}
[[3562 3048 4021]
 [1151 2971 1779]
 [2028 3013 5597]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0799227
{'0': {'precision': 0.48086621180658556, 'recall': 0.31991316360765737, 'f1-score': 0.38421426878407205, 'support': 10134}, '1': {'precision': 0.32484220018034266, 'recall': 0.418165989553105, 'f1-score': 0.36564323775691443, 'support': 6892}, '2': {'precision': 0.45006922810661126, 'recall': 0.5127168769716088, 'f1-score': 0.47935483870967743, 'support': 10144}, 'accuracy': 0.41682002208318, 'macro avg': {'precision': 0.41859254669784646, 'recall': 0.4169320100441238, 'f1-score': 0.40973744841688803, 'support': 27170}, 'weighted avg': {'precision': 0.42979068398985365, 'recall': 0.41682002208318, 'f1-score': 0.4150245152134489, 'support': 27170}}
[[3242 3001 3891]
 [1546 2882 2464]
 [1954 2989 5201]]
training model: results/XRAY/W1/deepVOL_L2/seq2seq
Epoch 1/50
524/524 - 22s - loss: 12.5939 - accuracy10: 0.4534 - accuracy20: 0.4521 - accuracy30: 0.4393 - accuracy50: 0.4126 - val_loss: 13.0661 - val_accuracy10: 0.4439 - val_accuracy20: 0.4262 - val_accuracy30: 0.4067 - val_accuracy50: 0.3857 - 22s/epoch - 42ms/step
Epoch 2/50
524/524 - 16s - loss: 12.0624 - accuracy10: 0.5110 - accuracy20: 0.5037 - accuracy30: 0.4860 - accuracy50: 0.4484 - val_loss: 13.1113 - val_accuracy10: 0.4645 - val_accuracy20: 0.4320 - val_accuracy30: 0.4105 - val_accuracy50: 0.3846 - 16s/epoch - 31ms/step
Epoch 3/50
524/524 - 17s - loss: 11.8227 - accuracy10: 0.5352 - accuracy20: 0.5240 - accuracy30: 0.5044 - accuracy50: 0.4636 - val_loss: 13.0504 - val_accuracy10: 0.4799 - val_accuracy20: 0.4429 - val_accuracy30: 0.4198 - val_accuracy50: 0.3930 - 17s/epoch - 32ms/step
Epoch 4/50
524/524 - 17s - loss: 11.6796 - accuracy10: 0.5489 - accuracy20: 0.5357 - accuracy30: 0.5138 - accuracy50: 0.4695 - val_loss: 12.9173 - val_accuracy10: 0.4935 - val_accuracy20: 0.4582 - val_accuracy30: 0.4347 - val_accuracy50: 0.4014 - 17s/epoch - 32ms/step
Epoch 5/50
524/524 - 17s - loss: 11.5840 - accuracy10: 0.5570 - accuracy20: 0.5432 - accuracy30: 0.5193 - accuracy50: 0.4734 - val_loss: 12.9034 - val_accuracy10: 0.4952 - val_accuracy20: 0.4579 - val_accuracy30: 0.4318 - val_accuracy50: 0.4007 - 17s/epoch - 32ms/step
Epoch 6/50
524/524 - 17s - loss: 11.5083 - accuracy10: 0.5624 - accuracy20: 0.5477 - accuracy30: 0.5240 - accuracy50: 0.4780 - val_loss: 12.9109 - val_accuracy10: 0.4971 - val_accuracy20: 0.4561 - val_accuracy30: 0.4298 - val_accuracy50: 0.4023 - 17s/epoch - 32ms/step
Epoch 7/50
524/524 - 17s - loss: 11.4521 - accuracy10: 0.5668 - accuracy20: 0.5508 - accuracy30: 0.5258 - accuracy50: 0.4795 - val_loss: 12.8155 - val_accuracy10: 0.5032 - val_accuracy20: 0.4620 - val_accuracy30: 0.4361 - val_accuracy50: 0.4064 - 17s/epoch - 32ms/step
Epoch 8/50
524/524 - 16s - loss: 11.4055 - accuracy10: 0.5702 - accuracy20: 0.5556 - accuracy30: 0.5302 - accuracy50: 0.4834 - val_loss: 12.7715 - val_accuracy10: 0.5021 - val_accuracy20: 0.4602 - val_accuracy30: 0.4346 - val_accuracy50: 0.4074 - 16s/epoch - 31ms/step
Epoch 9/50
524/524 - 16s - loss: 11.3724 - accuracy10: 0.5711 - accuracy20: 0.5558 - accuracy30: 0.5312 - accuracy50: 0.4839 - val_loss: 12.8202 - val_accuracy10: 0.5004 - val_accuracy20: 0.4591 - val_accuracy30: 0.4342 - val_accuracy50: 0.4041 - 16s/epoch - 31ms/step
Epoch 10/50
524/524 - 17s - loss: 11.3290 - accuracy10: 0.5754 - accuracy20: 0.5591 - accuracy30: 0.5344 - accuracy50: 0.4872 - val_loss: 12.7509 - val_accuracy10: 0.5024 - val_accuracy20: 0.4651 - val_accuracy30: 0.4420 - val_accuracy50: 0.4107 - 17s/epoch - 32ms/step
Epoch 11/50
524/524 - 16s - loss: 11.2918 - accuracy10: 0.5759 - accuracy20: 0.5611 - accuracy30: 0.5371 - accuracy50: 0.4888 - val_loss: 12.7602 - val_accuracy10: 0.5046 - val_accuracy20: 0.4661 - val_accuracy30: 0.4381 - val_accuracy50: 0.4078 - 16s/epoch - 31ms/step
Epoch 12/50
524/524 - 16s - loss: 11.2777 - accuracy10: 0.5762 - accuracy20: 0.5605 - accuracy30: 0.5371 - accuracy50: 0.4896 - val_loss: 12.8183 - val_accuracy10: 0.5038 - val_accuracy20: 0.4631 - val_accuracy30: 0.4378 - val_accuracy50: 0.4059 - 16s/epoch - 31ms/step
Epoch 13/50
524/524 - 16s - loss: 11.2387 - accuracy10: 0.5804 - accuracy20: 0.5650 - accuracy30: 0.5396 - accuracy50: 0.4919 - val_loss: 12.7988 - val_accuracy10: 0.5062 - val_accuracy20: 0.4636 - val_accuracy30: 0.4378 - val_accuracy50: 0.4079 - 16s/epoch - 31ms/step
Epoch 14/50
524/524 - 16s - loss: 11.2186 - accuracy10: 0.5805 - accuracy20: 0.5648 - accuracy30: 0.5414 - accuracy50: 0.4936 - val_loss: 12.8027 - val_accuracy10: 0.5052 - val_accuracy20: 0.4662 - val_accuracy30: 0.4389 - val_accuracy50: 0.4071 - 16s/epoch - 31ms/step
Epoch 15/50
524/524 - 16s - loss: 11.1939 - accuracy10: 0.5812 - accuracy20: 0.5674 - accuracy30: 0.5429 - accuracy50: 0.4954 - val_loss: 12.8105 - val_accuracy10: 0.5041 - val_accuracy20: 0.4637 - val_accuracy30: 0.4349 - val_accuracy50: 0.4063 - 16s/epoch - 31ms/step
Epoch 16/50
524/524 - 16s - loss: 11.1764 - accuracy10: 0.5824 - accuracy20: 0.5673 - accuracy30: 0.5444 - accuracy50: 0.4968 - val_loss: 12.7639 - val_accuracy10: 0.5046 - val_accuracy20: 0.4642 - val_accuracy30: 0.4380 - val_accuracy50: 0.4097 - 16s/epoch - 31ms/step
Epoch 17/50
524/524 - 16s - loss: 11.1520 - accuracy10: 0.5845 - accuracy20: 0.5697 - accuracy30: 0.5457 - accuracy50: 0.4974 - val_loss: 12.8095 - val_accuracy10: 0.5061 - val_accuracy20: 0.4686 - val_accuracy30: 0.4416 - val_accuracy50: 0.4101 - 16s/epoch - 31ms/step
Epoch 18/50
524/524 - 17s - loss: 11.1303 - accuracy10: 0.5854 - accuracy20: 0.5702 - accuracy30: 0.5473 - accuracy50: 0.4979 - val_loss: 12.7336 - val_accuracy10: 0.5054 - val_accuracy20: 0.4714 - val_accuracy30: 0.4460 - val_accuracy50: 0.4131 - 17s/epoch - 32ms/step
Epoch 19/50
524/524 - 16s - loss: 11.1087 - accuracy10: 0.5869 - accuracy20: 0.5711 - accuracy30: 0.5480 - accuracy50: 0.4996 - val_loss: 12.8178 - val_accuracy10: 0.5037 - val_accuracy20: 0.4704 - val_accuracy30: 0.4428 - val_accuracy50: 0.4107 - 16s/epoch - 31ms/step
Epoch 20/50
524/524 - 16s - loss: 11.0880 - accuracy10: 0.5868 - accuracy20: 0.5728 - accuracy30: 0.5477 - accuracy50: 0.5007 - val_loss: 12.9351 - val_accuracy10: 0.5001 - val_accuracy20: 0.4631 - val_accuracy30: 0.4368 - val_accuracy50: 0.4051 - 16s/epoch - 31ms/step
Epoch 21/50
524/524 - 17s - loss: 11.0594 - accuracy10: 0.5897 - accuracy20: 0.5757 - accuracy30: 0.5511 - accuracy50: 0.5033 - val_loss: 12.8045 - val_accuracy10: 0.5057 - val_accuracy20: 0.4753 - val_accuracy30: 0.4478 - val_accuracy50: 0.4151 - 17s/epoch - 32ms/step
Epoch 22/50
524/524 - 16s - loss: 11.0334 - accuracy10: 0.5898 - accuracy20: 0.5771 - accuracy30: 0.5519 - accuracy50: 0.5046 - val_loss: 12.9150 - val_accuracy10: 0.5036 - val_accuracy20: 0.4683 - val_accuracy30: 0.4399 - val_accuracy50: 0.4071 - 16s/epoch - 31ms/step
Epoch 23/50
524/524 - 16s - loss: 11.0174 - accuracy10: 0.5912 - accuracy20: 0.5778 - accuracy30: 0.5541 - accuracy50: 0.5056 - val_loss: 12.8890 - val_accuracy10: 0.5018 - val_accuracy20: 0.4689 - val_accuracy30: 0.4422 - val_accuracy50: 0.4081 - 16s/epoch - 31ms/step
Epoch 24/50
524/524 - 17s - loss: 10.9989 - accuracy10: 0.5928 - accuracy20: 0.5790 - accuracy30: 0.5555 - accuracy50: 0.5072 - val_loss: 12.8813 - val_accuracy10: 0.5015 - val_accuracy20: 0.4703 - val_accuracy30: 0.4443 - val_accuracy50: 0.4112 - 17s/epoch - 32ms/step
Epoch 25/50
524/524 - 17s - loss: 10.9653 - accuracy10: 0.5932 - accuracy20: 0.5819 - accuracy30: 0.5580 - accuracy50: 0.5100 - val_loss: 12.8795 - val_accuracy10: 0.5008 - val_accuracy20: 0.4720 - val_accuracy30: 0.4467 - val_accuracy50: 0.4117 - 17s/epoch - 32ms/step
Epoch 26/50
524/524 - 16s - loss: 10.9565 - accuracy10: 0.5928 - accuracy20: 0.5819 - accuracy30: 0.5591 - accuracy50: 0.5105 - val_loss: 12.9428 - val_accuracy10: 0.4999 - val_accuracy20: 0.4711 - val_accuracy30: 0.4469 - val_accuracy50: 0.4116 - 16s/epoch - 31ms/step
Epoch 27/50
524/524 - 16s - loss: 10.9254 - accuracy10: 0.5950 - accuracy20: 0.5839 - accuracy30: 0.5598 - accuracy50: 0.5123 - val_loss: 12.9646 - val_accuracy10: 0.5004 - val_accuracy20: 0.4717 - val_accuracy30: 0.4471 - val_accuracy50: 0.4121 - 16s/epoch - 31ms/step
Epoch 28/50
524/524 - 16s - loss: 10.9192 - accuracy10: 0.5939 - accuracy20: 0.5847 - accuracy30: 0.5614 - accuracy50: 0.5126 - val_loss: 13.0462 - val_accuracy10: 0.5008 - val_accuracy20: 0.4695 - val_accuracy30: 0.4442 - val_accuracy50: 0.4094 - 16s/epoch - 31ms/step
testing model: results/XRAY/W1/deepVOL_L2/seq2seq
Evaluating performance on  test set...
1314/1314 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0448565
{'0': {'precision': 0.45732570741470285, 'recall': 0.5345297865061533, 'f1-score': 0.4929230401937212, 'support': 108153}, '1': {'precision': 0.5356596665298967, 'recall': 0.4932167880203325, 'f1-score': 0.5135628073312473, 'support': 116464}, '2': {'precision': 0.47947728468689704, 'recall': 0.4406975494411006, 'f1-score': 0.45927025286326345, 'support': 111648}, 'accuracy': 0.48906665873641325, 'macro avg': {'precision': 0.49082088621049885, 'recall': 0.4894813746558621, 'f1-score': 0.48858536679607734, 'support': 336265}, 'weighted avg': {'precision': 0.4918112040131531, 'recall': 0.48906665873641325, 'f1-score': 0.48889801064867155, 'support': 336265}}
[[57811 23929 26413]
 [32020 57442 27002]
 [36580 25865 49203]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0483253
{'0': {'precision': 0.4982780567421302, 'recall': 0.49879222332533363, 'f1-score': 0.4985350074616954, 'support': 127921}, '1': {'precision': 0.3732282119883873, 'recall': 0.5147466764367215, 'f1-score': 0.43271039345308154, 'support': 76424}, '2': {'precision': 0.522419998054664, 'recall': 0.4071406913280776, 'f1-score': 0.4576321731350914, 'support': 131920}, 'accuracy': 0.4664624626410718, 'macro avg': {'precision': 0.4646420889283938, 'recall': 0.4735598636967109, 'f1-score': 0.46295919134995617, 'support': 336265}, 'weighted avg': {'precision': 0.47932870299579744, 'recall': 0.4664624626410718, 'f1-score': 0.4675282651442972, 'support': 336265}}
[[63806 31776 32339]
 [20324 39339 16761]
 [43923 34287 53710]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0643802
{'0': {'precision': 0.4921775198321952, 'recall': 0.4739036020166434, 'f1-score': 0.4828677306802621, 'support': 131704}, '1': {'precision': 0.3143203646108405, 'recall': 0.4600870411727653, 'f1-score': 0.37348487489686105, 'support': 69852}, '2': {'precision': 0.5095657851779302, 'recall': 0.40552598564312703, 'f1-score': 0.4516315715502203, 'support': 134709}, 'accuracy': 0.443641175858326, 'macro avg': {'precision': 0.4386878898736553, 'recall': 0.4465055429441786, 'f1-score': 0.4359947257091145, 'support': 336265}, 'weighted avg': {'precision': 0.4621972299713311, 'recall': 0.443641175858326, 'f1-score': 0.4476324162632668, 'support': 336265}}
[[62415 34150 35139]
 [20276 32138 17438]
 [44123 35958 54628]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1077664
{'0': {'precision': 0.43778308556273615, 'recall': 0.4381365824019443, 'f1-score': 0.4379597626515893, 'support': 125082}, '1': {'precision': 0.29481835035285203, 'recall': 0.33852776176979077, 'f1-score': 0.31516478703602324, 'support': 85027}, '2': {'precision': 0.44938254193514265, 'recall': 0.404118710168363, 'f1-score': 0.42555038500866005, 'support': 126156}, 'accuracy': 0.4001873522370749, 'macro avg': {'precision': 0.39399465928357696, 'recall': 0.39359435144669935, 'f1-score': 0.39289164489875755, 'support': 336265}, 'weighted avg': {'precision': 0.40598518354327673, 'recall': 0.4001873522370749, 'f1-score': 0.40225457228807804, 'support': 336265}}
[[54803 34384 35895]
 [29671 28784 26572]
 [40709 34465 50982]]
Evaluating performance on  train set...
524/524 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.90255785
{'0': {'precision': 0.4835610308247124, 'recall': 0.5156925495480321, 'f1-score': 0.4991101873361319, 'support': 35622}, '1': {'precision': 0.6888817840300535, 'recall': 0.6918347033136398, 'f1-score': 0.6903550859880009, 'support': 62288}, '2': {'precision': 0.4847344207444584, 'recall': 0.44937409992245486, 'f1-score': 0.4663849846224598, 'support': 36108}, 'accuracy': 0.5796907878046232, 'macro avg': {'precision': 0.5523924118664081, 'recall': 0.5523004509280423, 'f1-score': 0.5519500859821975, 'support': 134018}, 'weighted avg': {'precision': 0.5793047953852676, 'recall': 0.5796907878046232, 'f1-score': 0.5791786902808285, 'support': 134018}}
[[18370  9298  7954]
 [ 9901 43093  9294]
 [ 9718 10164 16226]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.93833697
{'0': {'precision': 0.5285430275489917, 'recall': 0.4774354549058936, 'f1-score': 0.5016910106852269, 'support': 42877}, '1': {'precision': 0.5600278596650361, 'recall': 0.7289382695226851, 'f1-score': 0.633415773564166, 'support': 47432}, '2': {'precision': 0.5362305880950252, 'recall': 0.41158571461255117, 'f1-score': 0.46571228869502185, 'support': 43709}, 'accuracy': 0.5449715709830023, 'macro avg': {'precision': 0.5416004917696844, 'recall': 0.53931981301371, 'f1-score': 0.5336063576481382, 'support': 134018}, 'weighted avg': {'precision': 0.5421934636160483, 'recall': 0.5449715709830023, 'f1-score': 0.5365771826427547, 'support': 134018}}
[[20471 13023  9383]
 [ 6681 34575  6176]
 [11579 14140 17990]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.97356695
{'0': {'precision': 0.5254579879234469, 'recall': 0.45804710500490675, 'f1-score': 0.4894423260247855, 'support': 44836}, '1': {'precision': 0.5084833419529203, 'recall': 0.6949790222546516, 'f1-score': 0.5872809426091312, 'support': 43856}, '2': {'precision': 0.5243334381161947, 'recall': 0.4048007765962141, 'f1-score': 0.45687819818473835, 'support': 45326}, 'accuracy': 0.5175722664119745, 'macro avg': {'precision': 0.5194249226641873, 'recall': 0.5192756346185908, 'f1-score': 0.5112004889395517, 'support': 134018}, 'weighted avg': {'precision': 0.5195228790705546, 'recall': 0.5175722664119745, 'f1-score': 0.5104455398501305, 'support': 134018}}
[[20537 14213 10086]
 [ 6818 30479  6559]
 [11729 15249 18348]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0289366
{'0': {'precision': 0.48583087735207436, 'recall': 0.42764018536174364, 'f1-score': 0.45488207547169807, 'support': 45101}, '1': {'precision': 0.4587784649985943, 'recall': 0.5912456692556781, 'f1-score': 0.5166562781356049, 'support': 44161}, '2': {'precision': 0.47627449407864836, 'recall': 0.3980695325766378, 'f1-score': 0.4336745250295145, 'support': 44756}, 'accuracy': 0.47167544658180244, 'macro avg': {'precision': 0.473627945476439, 'recall': 0.4723184623980199, 'f1-score': 0.46840429287893914, 'support': 134018}, 'weighted avg': {'precision': 0.4737252865230254, 'recall': 0.47167544658180244, 'f1-score': 0.4681552584489878, 'support': 134018}}
[[19287 15066 10748]
 [ 9208 26110  8843]
 [11204 15736 17816]]
Evaluating performance on  val set...
107/107 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0146116
{'0': {'precision': 0.4820916144117334, 'recall': 0.522400092134055, 'f1-score': 0.5014370992703958, 'support': 8683}, '1': {'precision': 0.5463102032642435, 'recall': 0.552842233255649, 'f1-score': 0.5495568090249798, 'support': 9869}, '2': {'precision': 0.4817339850784667, 'recall': 0.4345555813413785, 'f1-score': 0.4569302098584676, 'support': 8618}, 'accuracy': 0.5055944055944056, 'macro avg': {'precision': 0.5033786009181479, 'recall': 0.5032659689103608, 'f1-score': 0.5026413727179477, 'support': 27170}, 'weighted avg': {'precision': 0.5053043933514216, 'recall': 0.5055944055944056, 'f1-score': 0.5047986393004287, 'support': 27170}}
[[4536 2213 1934]
 [2318 5456 2095]
 [2555 2318 3745]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0335225
{'0': {'precision': 0.5187205034084951, 'recall': 0.4793564644310913, 'f1-score': 0.49826222737117815, 'support': 10318}, '1': {'precision': 0.38120873539867955, 'recall': 0.5764091537398249, 'f1-score': 0.4589141599413059, 'support': 6511}, '2': {'precision': 0.5241335044929397, 'recall': 0.39483608935306064, 'f1-score': 0.4503888367988529, 'support': 10341}, 'accuracy': 0.47044534412955463, 'macro avg': {'precision': 0.47468758110003817, 'recall': 0.48353390250799233, 'f1-score': 0.4691884080371123, 'support': 27170}, 'weighted avg': {'precision': 0.48782748620946426, 'recall': 0.47044534412955463, 'f1-score': 0.4706120985914831, 'support': 27170}}
[[4946 2977 2395]
 [1446 3753 1312]
 [3143 3115 4083]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0527637
{'0': {'precision': 0.5074171488690163, 'recall': 0.45422866829911474, 'f1-score': 0.4793519852904637, 'support': 10618}, '1': {'precision': 0.32460458782863727, 'recall': 0.530015392508979, 'f1-score': 0.4026243991165389, 'support': 5847}, '2': {'precision': 0.5110864745011087, 'recall': 0.38757589911256424, 'f1-score': 0.44084364872762044, 'support': 10705}, 'accuracy': 0.4442767758557232, 'macro avg': {'precision': 0.44770273706625413, 'recall': 0.45727331997355264, 'f1-score': 0.4409400110448743, 'support': 27170}, 'weighted avg': {'precision': 0.4695214950776454, 'recall': 0.4442767758557232, 'f1-score': 0.447667850610148, 'support': 27170}}
[[4823 3148 2647]
 [1426 3099 1322]
 [3256 3300 4149]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0895698
{'0': {'precision': 0.46121102479514736, 'recall': 0.42682686625960214, 'f1-score': 0.4433532811620889, 'support': 10154}, '1': {'precision': 0.31421364334283836, 'recall': 0.41861484511981295, 'f1-score': 0.3589775717328656, 'support': 6844}, '2': {'precision': 0.46008087810514153, 'recall': 0.39146677152968934, 'f1-score': 0.4230095076220322, 'support': 10172}, 'accuracy': 0.4115200588884799, 'macro avg': {'precision': 0.4118351820810424, 'recall': 0.4123028276363681, 'f1-score': 0.40844678683899555, 'support': 27170}, 'weighted avg': {'precision': 0.42375994158608066, 'recall': 0.4115200588884799, 'f1-score': 0.4144830485605776, 'support': 27170}}
[[4334 3061 2759]
 [2065 2865 1914]
 [2998 3192 3982]]
training model: results/XRAY/W1/deepVOL_L3/seq2seq
Epoch 1/50
524/524 - 29s - loss: 12.7538 - accuracy10: 0.4415 - accuracy20: 0.4327 - accuracy30: 0.4212 - accuracy50: 0.3982 - val_loss: 13.7519 - val_accuracy10: 0.3931 - val_accuracy20: 0.2884 - val_accuracy30: 0.2377 - val_accuracy50: 0.2573 - 29s/epoch - 55ms/step
Epoch 2/50
524/524 - 22s - loss: 12.6923 - accuracy10: 0.4500 - accuracy20: 0.4367 - accuracy30: 0.4222 - accuracy50: 0.3950 - val_loss: 13.2991 - val_accuracy10: 0.4107 - val_accuracy20: 0.3837 - val_accuracy30: 0.3548 - val_accuracy50: 0.3400 - 22s/epoch - 43ms/step
Epoch 3/50
524/524 - 22s - loss: 12.5959 - accuracy10: 0.4671 - accuracy20: 0.4483 - accuracy30: 0.4310 - accuracy50: 0.4028 - val_loss: 13.0411 - val_accuracy10: 0.4235 - val_accuracy20: 0.4142 - val_accuracy30: 0.3972 - val_accuracy50: 0.3713 - 22s/epoch - 43ms/step
Epoch 4/50
524/524 - 23s - loss: 12.2057 - accuracy10: 0.4965 - accuracy20: 0.4857 - accuracy30: 0.4683 - accuracy50: 0.4320 - val_loss: 12.8788 - val_accuracy10: 0.4619 - val_accuracy20: 0.4425 - val_accuracy30: 0.4232 - val_accuracy50: 0.3937 - 23s/epoch - 43ms/step
Epoch 5/50
524/524 - 22s - loss: 11.9090 - accuracy10: 0.5274 - accuracy20: 0.5162 - accuracy30: 0.4952 - accuracy50: 0.4561 - val_loss: 12.5851 - val_accuracy10: 0.4889 - val_accuracy20: 0.4726 - val_accuracy30: 0.4507 - val_accuracy50: 0.4121 - 22s/epoch - 42ms/step
Epoch 6/50
524/524 - 22s - loss: 11.7051 - accuracy10: 0.5440 - accuracy20: 0.5330 - accuracy30: 0.5101 - accuracy50: 0.4671 - val_loss: 12.6443 - val_accuracy10: 0.4913 - val_accuracy20: 0.4678 - val_accuracy30: 0.4421 - val_accuracy50: 0.4071 - 22s/epoch - 42ms/step
Epoch 7/50
524/524 - 22s - loss: 11.5588 - accuracy10: 0.5581 - accuracy20: 0.5435 - accuracy30: 0.5188 - accuracy50: 0.4742 - val_loss: 12.6643 - val_accuracy10: 0.4920 - val_accuracy20: 0.4640 - val_accuracy30: 0.4374 - val_accuracy50: 0.4050 - 22s/epoch - 42ms/step
Epoch 8/50
524/524 - 22s - loss: 11.4740 - accuracy10: 0.5621 - accuracy20: 0.5460 - accuracy30: 0.5213 - accuracy50: 0.4774 - val_loss: 12.5763 - val_accuracy10: 0.4980 - val_accuracy20: 0.4667 - val_accuracy30: 0.4432 - val_accuracy50: 0.4116 - 22s/epoch - 43ms/step
Epoch 9/50
524/524 - 22s - loss: 11.3992 - accuracy10: 0.5676 - accuracy20: 0.5524 - accuracy30: 0.5283 - accuracy50: 0.4811 - val_loss: 12.5270 - val_accuracy10: 0.5000 - val_accuracy20: 0.4774 - val_accuracy30: 0.4522 - val_accuracy50: 0.4142 - 22s/epoch - 42ms/step
Epoch 10/50
524/524 - 22s - loss: 11.3585 - accuracy10: 0.5705 - accuracy20: 0.5541 - accuracy30: 0.5303 - accuracy50: 0.4830 - val_loss: 12.4937 - val_accuracy10: 0.5009 - val_accuracy20: 0.4744 - val_accuracy30: 0.4491 - val_accuracy50: 0.4119 - 22s/epoch - 42ms/step
Epoch 11/50
524/524 - 22s - loss: 11.3166 - accuracy10: 0.5734 - accuracy20: 0.5582 - accuracy30: 0.5332 - accuracy50: 0.4853 - val_loss: 12.5414 - val_accuracy10: 0.4956 - val_accuracy20: 0.4661 - val_accuracy30: 0.4401 - val_accuracy50: 0.4069 - 22s/epoch - 42ms/step
Epoch 12/50
524/524 - 22s - loss: 11.2846 - accuracy10: 0.5760 - accuracy20: 0.5615 - accuracy30: 0.5369 - accuracy50: 0.4877 - val_loss: 12.4558 - val_accuracy10: 0.5013 - val_accuracy20: 0.4759 - val_accuracy30: 0.4523 - val_accuracy50: 0.4134 - 22s/epoch - 43ms/step
Epoch 13/50
524/524 - 22s - loss: 11.2509 - accuracy10: 0.5765 - accuracy20: 0.5624 - accuracy30: 0.5377 - accuracy50: 0.4893 - val_loss: 12.4316 - val_accuracy10: 0.5033 - val_accuracy20: 0.4800 - val_accuracy30: 0.4531 - val_accuracy50: 0.4148 - 22s/epoch - 42ms/step
Epoch 14/50
524/524 - 22s - loss: 11.2298 - accuracy10: 0.5795 - accuracy20: 0.5646 - accuracy30: 0.5399 - accuracy50: 0.4916 - val_loss: 12.4082 - val_accuracy10: 0.5092 - val_accuracy20: 0.4830 - val_accuracy30: 0.4541 - val_accuracy50: 0.4127 - 22s/epoch - 42ms/step
Epoch 15/50
524/524 - 22s - loss: 11.2093 - accuracy10: 0.5809 - accuracy20: 0.5662 - accuracy30: 0.5413 - accuracy50: 0.4926 - val_loss: 12.4643 - val_accuracy10: 0.5058 - val_accuracy20: 0.4814 - val_accuracy30: 0.4527 - val_accuracy50: 0.4161 - 22s/epoch - 42ms/step
Epoch 16/50
524/524 - 23s - loss: 11.1863 - accuracy10: 0.5826 - accuracy20: 0.5684 - accuracy30: 0.5430 - accuracy50: 0.4943 - val_loss: 12.4068 - val_accuracy10: 0.5092 - val_accuracy20: 0.4807 - val_accuracy30: 0.4529 - val_accuracy50: 0.4154 - 23s/epoch - 43ms/step
Epoch 17/50
524/524 - 22s - loss: 11.1547 - accuracy10: 0.5838 - accuracy20: 0.5696 - accuracy30: 0.5445 - accuracy50: 0.4952 - val_loss: 12.4481 - val_accuracy10: 0.5109 - val_accuracy20: 0.4834 - val_accuracy30: 0.4538 - val_accuracy50: 0.4162 - 22s/epoch - 42ms/step
Epoch 18/50
524/524 - 22s - loss: 11.1401 - accuracy10: 0.5838 - accuracy20: 0.5701 - accuracy30: 0.5459 - accuracy50: 0.4972 - val_loss: 12.4167 - val_accuracy10: 0.5087 - val_accuracy20: 0.4852 - val_accuracy30: 0.4559 - val_accuracy50: 0.4156 - 22s/epoch - 42ms/step
Epoch 19/50
524/524 - 22s - loss: 11.1136 - accuracy10: 0.5850 - accuracy20: 0.5716 - accuracy30: 0.5472 - accuracy50: 0.4977 - val_loss: 12.3984 - val_accuracy10: 0.5123 - val_accuracy20: 0.4880 - val_accuracy30: 0.4607 - val_accuracy50: 0.4201 - 22s/epoch - 42ms/step
Epoch 20/50
524/524 - 22s - loss: 11.0974 - accuracy10: 0.5859 - accuracy20: 0.5727 - accuracy30: 0.5491 - accuracy50: 0.5001 - val_loss: 12.3671 - val_accuracy10: 0.5086 - val_accuracy20: 0.4902 - val_accuracy30: 0.4644 - val_accuracy50: 0.4210 - 22s/epoch - 42ms/step
Epoch 21/50
524/524 - 22s - loss: 11.0779 - accuracy10: 0.5869 - accuracy20: 0.5742 - accuracy30: 0.5507 - accuracy50: 0.5012 - val_loss: 12.3754 - val_accuracy10: 0.5129 - val_accuracy20: 0.4905 - val_accuracy30: 0.4651 - val_accuracy50: 0.4237 - 22s/epoch - 42ms/step
Epoch 22/50
524/524 - 22s - loss: 11.0632 - accuracy10: 0.5883 - accuracy20: 0.5749 - accuracy30: 0.5513 - accuracy50: 0.5020 - val_loss: 12.3382 - val_accuracy10: 0.5094 - val_accuracy20: 0.4914 - val_accuracy30: 0.4652 - val_accuracy50: 0.4227 - 22s/epoch - 42ms/step
Epoch 23/50
524/524 - 22s - loss: 11.0494 - accuracy10: 0.5887 - accuracy20: 0.5760 - accuracy30: 0.5517 - accuracy50: 0.5028 - val_loss: 12.4216 - val_accuracy10: 0.5142 - val_accuracy20: 0.4856 - val_accuracy30: 0.4577 - val_accuracy50: 0.4180 - 22s/epoch - 42ms/step
Epoch 24/50
524/524 - 22s - loss: 11.0259 - accuracy10: 0.5884 - accuracy20: 0.5769 - accuracy30: 0.5545 - accuracy50: 0.5040 - val_loss: 12.3864 - val_accuracy10: 0.5100 - val_accuracy20: 0.4897 - val_accuracy30: 0.4658 - val_accuracy50: 0.4258 - 22s/epoch - 43ms/step
Epoch 25/50
524/524 - 23s - loss: 11.0138 - accuracy10: 0.5895 - accuracy20: 0.5775 - accuracy30: 0.5528 - accuracy50: 0.5041 - val_loss: 12.5131 - val_accuracy10: 0.5054 - val_accuracy20: 0.4861 - val_accuracy30: 0.4618 - val_accuracy50: 0.4221 - 23s/epoch - 43ms/step
Epoch 26/50
524/524 - 23s - loss: 10.9935 - accuracy10: 0.5915 - accuracy20: 0.5795 - accuracy30: 0.5559 - accuracy50: 0.5061 - val_loss: 12.3803 - val_accuracy10: 0.5109 - val_accuracy20: 0.4946 - val_accuracy30: 0.4677 - val_accuracy50: 0.4249 - 23s/epoch - 43ms/step
Epoch 27/50
524/524 - 23s - loss: 10.9731 - accuracy10: 0.5936 - accuracy20: 0.5804 - accuracy30: 0.5578 - accuracy50: 0.5074 - val_loss: 12.4804 - val_accuracy10: 0.5068 - val_accuracy20: 0.4900 - val_accuracy30: 0.4672 - val_accuracy50: 0.4241 - 23s/epoch - 43ms/step
Epoch 28/50
524/524 - 23s - loss: 10.9614 - accuracy10: 0.5932 - accuracy20: 0.5805 - accuracy30: 0.5584 - accuracy50: 0.5071 - val_loss: 12.4432 - val_accuracy10: 0.5027 - val_accuracy20: 0.4917 - val_accuracy30: 0.4668 - val_accuracy50: 0.4222 - 23s/epoch - 44ms/step
Epoch 29/50
524/524 - 23s - loss: 10.9438 - accuracy10: 0.5946 - accuracy20: 0.5820 - accuracy30: 0.5584 - accuracy50: 0.5078 - val_loss: 12.4608 - val_accuracy10: 0.5028 - val_accuracy20: 0.4883 - val_accuracy30: 0.4671 - val_accuracy50: 0.4237 - 23s/epoch - 43ms/step
Epoch 30/50
524/524 - 22s - loss: 10.9273 - accuracy10: 0.5946 - accuracy20: 0.5835 - accuracy30: 0.5603 - accuracy50: 0.5105 - val_loss: 12.4449 - val_accuracy10: 0.5039 - val_accuracy20: 0.4912 - val_accuracy30: 0.4674 - val_accuracy50: 0.4285 - 22s/epoch - 43ms/step
Epoch 31/50
524/524 - 22s - loss: 10.9064 - accuracy10: 0.5948 - accuracy20: 0.5844 - accuracy30: 0.5609 - accuracy50: 0.5117 - val_loss: 12.4800 - val_accuracy10: 0.4939 - val_accuracy20: 0.4908 - val_accuracy30: 0.4682 - val_accuracy50: 0.4287 - 22s/epoch - 42ms/step
Epoch 32/50
524/524 - 22s - loss: 10.9004 - accuracy10: 0.5955 - accuracy20: 0.5842 - accuracy30: 0.5611 - accuracy50: 0.5123 - val_loss: 12.4370 - val_accuracy10: 0.4994 - val_accuracy20: 0.4944 - val_accuracy30: 0.4743 - val_accuracy50: 0.4328 - 22s/epoch - 42ms/step
testing model: results/XRAY/W1/deepVOL_L3/seq2seq
Evaluating performance on  test set...
1314/1314 - 28s - 28s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0200858
{'0': {'precision': 0.4894429880712878, 'recall': 0.445387552818692, 'f1-score': 0.46637717782263727, 'support': 108153}, '1': {'precision': 0.5867522614531661, 'recall': 0.43163552685808493, 'f1-score': 0.4973805153879261, 'support': 116464}, '2': {'precision': 0.4525536892463791, 'recall': 0.6168135568930926, 'f1-score': 0.5220680767189751, 'support': 111648}, 'accuracy': 0.49754211708027896, 'macro avg': {'precision': 0.5095829795902777, 'recall': 0.4979455455232899, 'f1-score': 0.4952752566431795, 'support': 336265}, 'weighted avg': {'precision': 0.5108975277347784, 'recall': 0.49754211708027896, 'f1-score': 0.49560576297477066, 'support': 336265}}
[[48170 17353 42630]
 [25518 50270 40676]
 [24730 18052 68866]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0112154
{'0': {'precision': 0.5335050997593851, 'recall': 0.39172614347917856, 'f1-score': 0.4517527845767579, 'support': 127921}, '1': {'precision': 0.42155274547256943, 'recall': 0.45627028158693606, 'f1-score': 0.4382249814630958, 'support': 76424}, '2': {'precision': 0.4945903107987044, 'recall': 0.5984460278956943, 'f1-score': 0.5415842025649908, 'support': 131920}, 'accuracy': 0.48749349471399045, 'macro avg': {'precision': 0.4832160520102196, 'recall': 0.482147484320603, 'f1-score': 0.4771873228682815, 'support': 336265}, 'weighted avg': {'precision': 0.49279469075544885, 'recall': 0.48749349471399045, 'f1-score': 0.4839200093424908, 'support': 336265}}
[[50110 23440 54371]
 [15251 34870 26303]
 [28565 24408 78947]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0307262
{'0': {'precision': 0.5290658039170374, 'recall': 0.34765838547044886, 'f1-score': 0.4195941333064527, 'support': 131704}, '1': {'precision': 0.3583314481059749, 'recall': 0.4081629731432171, 'f1-score': 0.3816273809045764, 'support': 69852}, '2': {'precision': 0.4825981169998942, 'recall': 0.60958065162684, 'f1-score': 0.5387075506046978, 'support': 134709}, 'accuracy': 0.4651539708265802, 'macro avg': {'precision': 0.45666512300763545, 'recall': 0.455134003413502, 'f1-score': 0.4466430216052422, 'support': 336265}, 'weighted avg': {'precision': 0.47498419608084935, 'recall': 0.4651539708265802, 'f1-score': 0.4594246114771022, 'support': 336265}}
[[45788 25521 60395]
 [13698 28511 27643]
 [27059 25534 82116]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0828712
{'0': {'precision': 0.4718994934348144, 'recall': 0.2993955964887034, 'f1-score': 0.3663568773234201, 'support': 125082}, '1': {'precision': 0.32373015873015876, 'recall': 0.2878379808766627, 'f1-score': 0.3047308360362828, 'support': 85027}, '2': {'precision': 0.4289023589822787, 'recall': 0.6164035004280415, 'f1-score': 0.5058364746327201, 'support': 126156}, 'accuracy': 0.415404517270605, 'macro avg': {'precision': 0.408177337049084, 'recall': 0.4012123592644692, 'f1-score': 0.39230806266414103, 'support': 336265}, 'weighted avg': {'precision': 0.4183026560716429, 'recall': 0.415404517270605, 'f1-score': 0.40310263042181166, 'support': 336265}}
[[37449 26257 61376]
 [18385 24474 42168]
 [23524 24869 77763]]
Evaluating performance on  train set...
524/524 - 11s - 11s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8880072
{'0': {'precision': 0.5110149853236521, 'recall': 0.46429172982988043, 'f1-score': 0.48653419035992174, 'support': 35622}, '1': {'precision': 0.7241800017681903, 'recall': 0.6575263293090162, 'f1-score': 0.6892454751226409, 'support': 62288}, '2': {'precision': 0.4646990997383476, 'recall': 0.5803976958014845, 'f1-score': 0.5161441272812355, 'support': 36108}, 'accuracy': 0.585384052888418, 'macro avg': {'precision': 0.5666313622767299, 'recall': 0.5674052516467937, 'f1-score': 0.5639745975879328, 'support': 134018}, 'weighted avg': {'precision': 0.5976096856443793, 'recall': 0.585384052888418, 'f1-score': 0.5887267026168951, 'support': 134018}}
[[16539  7686 11397]
 [ 8588 40956 12744]
 [ 7238  7913 20957]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9142275
{'0': {'precision': 0.5606219260669523, 'recall': 0.41206241108286495, 'f1-score': 0.47499731153887514, 'support': 42877}, '1': {'precision': 0.597927090779128, 'recall': 0.70543093270366, 'f1-score': 0.6472454348498917, 'support': 47432}, '2': {'precision': 0.5143845476226285, 'recall': 0.5477361641767142, 'f1-score': 0.5305367194078802, 'support': 43709}, 'accuracy': 0.5601411750660359, 'macro avg': {'precision': 0.5576445214895697, 'recall': 0.555076502654413, 'f1-score': 0.5509264885988823, 'support': 134018}, 'weighted avg': {'precision': 0.5587450811521273, 'recall': 0.5601411750660359, 'f1-score': 0.5540735920641366, 'support': 134018}}
[[17668 11063 14146]
 [ 5516 33460  8456]
 [ 8331 11437 23941]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.95225257
{'0': {'precision': 0.5596587121717105, 'recall': 0.37452047461861004, 'f1-score': 0.4487439871726349, 'support': 44836}, '1': {'precision': 0.5422021535255297, 'recall': 0.6762814666180226, 'f1-score': 0.6018649106608358, 'support': 43856}, '2': {'precision': 0.500192646969359, 'recall': 0.5441909720690111, 'f1-score': 0.5212650175931698, 'support': 45326}, 'accuracy': 0.5306525989046248, 'macro avg': {'precision': 0.534017837555533, 'recall': 0.5316643044352145, 'f1-score': 0.5239579718088802, 'support': 134018}, 'weighted avg': {'precision': 0.5338343176325538, 'recall': 0.5306525989046248, 'f1-score': 0.5233784351224603, 'support': 134018}}
[[16792 12392 15652]
 [ 5202 29659  8995]
 [ 8010 12650 24666]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0144504
{'0': {'precision': 0.517818030108125, 'recall': 0.3302365801201747, 'f1-score': 0.40328170692082743, 'support': 45101}, '1': {'precision': 0.48348536678069176, 'recall': 0.5760965557845158, 'f1-score': 0.5257436893605151, 'support': 44161}, '2': {'precision': 0.45483043602165857, 'recall': 0.534900348556618, 'f1-score': 0.491626536332926, 'support': 44756}, 'accuracy': 0.4795997552567566, 'macro avg': {'precision': 0.4853779443034918, 'recall': 0.4804111614871028, 'f1-score': 0.4735506442047562, 'support': 134018}, 'weighted avg': {'precision': 0.4854698566826398, 'recall': 0.4795997552567566, 'f1-score': 0.47313803063620097, 'support': 134018}}
[[14894 13770 16437]
 [ 6462 25441 12258]
 [ 7407 13409 23940]]
Evaluating performance on  val set...
107/107 - 2s - 2s/epoch - 22ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9968947
{'0': {'precision': 0.5120785771170693, 'recall': 0.4443164804790971, 'f1-score': 0.47579700314484796, 'support': 8683}, '1': {'precision': 0.5965944660072618, 'recall': 0.48282500759955416, 'f1-score': 0.5337141577060932, 'support': 9869}, '2': {'precision': 0.44905142072280885, 'recall': 0.6069853794383848, 'f1-score': 0.516208614989885, 'support': 8618}, 'accuracy': 0.5099006256900994, 'macro avg': {'precision': 0.5192414879490467, 'recall': 0.5113756225056787, 'f1-score': 0.5085732586136088, 'support': 27170}, 'weighted avg': {'precision': 0.5227859482488901, 'recall': 0.5099006256900994, 'f1-score': 0.5096524197530725, 'support': 27170}}
[[3858 1616 3209]
 [1895 4765 3209]
 [1781 1606 5231]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.99708563
{'0': {'precision': 0.5520847667538187, 'recall': 0.3888350455514635, 'f1-score': 0.4562979812340062, 'support': 10318}, '1': {'precision': 0.4324498198661863, 'recall': 0.516203348180003, 'f1-score': 0.470629419589722, 'support': 6511}, '2': {'precision': 0.4959195449674388, 'recall': 0.58176191857654, 'f1-score': 0.5354218583125667, 'support': 10341}, 'accuracy': 0.49278616120721386, 'macro avg': {'precision': 0.49348471052914794, 'recall': 0.4956001041026689, 'f1-score': 0.48744975304543164, 'support': 27170}, 'weighted avg': {'precision': 0.5020388448665044, 'recall': 0.49278616120721386, 'f1-score': 0.4898471902146267, 'support': 27170}}
[[4012 2233 4073]
 [1108 3361 2042]
 [2147 2178 6016]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0180881
{'0': {'precision': 0.5371217712177122, 'recall': 0.34271990958749293, 'f1-score': 0.4184442016903352, 'support': 10618}, '1': {'precision': 0.36686706746826986, 'recall': 0.46964255173593294, 'f1-score': 0.41194119411941194, 'support': 5847}, '2': {'precision': 0.4865220759101472, 'recall': 0.5867351704810836, 'f1-score': 0.5319500317594749, 'support': 10705}, 'accuracy': 0.46617592933382407, 'macro avg': {'precision': 0.4635036381987097, 'recall': 0.4663658772681698, 'f1-score': 0.4541118091897407, 'support': 27170}, 'weighted avg': {'precision': 0.4805465415125052, 'recall': 0.46617592933382407, 'f1-score': 0.46176613123111365, 'support': 27170}}
[[3639 2423 4556]
 [1028 2746 2073]
 [2108 2316 6281]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0654756
{'0': {'precision': 0.48891016435296, 'recall': 0.3017530037423675, 'f1-score': 0.3731806832714207, 'support': 10154}, '1': {'precision': 0.34056854782243384, 'recall': 0.3553477498538866, 'f1-score': 0.34780121558813015, 'support': 6844}, '2': {'precision': 0.4410696119750036, 'recall': 0.5967361384191899, 'f1-score': 0.507228210913345, 'support': 10172}, 'accuracy': 0.4256900993743099, 'macro avg': {'precision': 0.42351610805013246, 'recall': 0.4179456306718146, 'f1-score': 0.40940336992429865, 'support': 27170}, 'weighted avg': {'precision': 0.4336328687208844, 'recall': 0.4256900993743099, 'f1-score': 0.4169728943258636, 'support': 27170}}
[[3064 2439 4651]
 [1371 2432 3041]
 [1832 2270 6070]]
training model: results/XRAY/W2/deepLOB_L1/seq2seq
Epoch 1/50
286/286 - 14s - loss: 13.0215 - accuracy10: 0.4060 - accuracy20: 0.4025 - accuracy30: 0.3976 - accuracy50: 0.3905 - val_loss: 13.0429 - val_accuracy10: 0.4102 - val_accuracy20: 0.3932 - val_accuracy30: 0.3783 - val_accuracy50: 0.3655 - 14s/epoch - 49ms/step
Epoch 2/50
286/286 - 8s - loss: 12.8514 - accuracy10: 0.4296 - accuracy20: 0.4241 - accuracy30: 0.4144 - accuracy50: 0.4016 - val_loss: 13.0787 - val_accuracy10: 0.4044 - val_accuracy20: 0.3842 - val_accuracy30: 0.3678 - val_accuracy50: 0.3588 - 8s/epoch - 29ms/step
Epoch 3/50
286/286 - 8s - loss: 12.7520 - accuracy10: 0.4449 - accuracy20: 0.4366 - accuracy30: 0.4240 - accuracy50: 0.4078 - val_loss: 13.0749 - val_accuracy10: 0.3866 - val_accuracy20: 0.3769 - val_accuracy30: 0.3684 - val_accuracy50: 0.3680 - 8s/epoch - 29ms/step
Epoch 4/50
286/286 - 8s - loss: 12.7132 - accuracy10: 0.4538 - accuracy20: 0.4430 - accuracy30: 0.4314 - accuracy50: 0.4125 - val_loss: 12.9326 - val_accuracy10: 0.4129 - val_accuracy20: 0.4061 - val_accuracy30: 0.3963 - val_accuracy50: 0.3924 - 8s/epoch - 29ms/step
Epoch 5/50
286/286 - 8s - loss: 12.6624 - accuracy10: 0.4628 - accuracy20: 0.4498 - accuracy30: 0.4351 - accuracy50: 0.4154 - val_loss: 12.8707 - val_accuracy10: 0.4183 - val_accuracy20: 0.4119 - val_accuracy30: 0.4038 - val_accuracy50: 0.3936 - 8s/epoch - 30ms/step
Epoch 6/50
286/286 - 8s - loss: 12.6075 - accuracy10: 0.4685 - accuracy20: 0.4566 - accuracy30: 0.4417 - accuracy50: 0.4185 - val_loss: 12.7870 - val_accuracy10: 0.4317 - val_accuracy20: 0.4283 - val_accuracy30: 0.4177 - val_accuracy50: 0.4072 - 8s/epoch - 29ms/step
Epoch 7/50
286/286 - 8s - loss: 12.5717 - accuracy10: 0.4744 - accuracy20: 0.4604 - accuracy30: 0.4455 - accuracy50: 0.4200 - val_loss: 12.7909 - val_accuracy10: 0.4262 - val_accuracy20: 0.4241 - val_accuracy30: 0.4179 - val_accuracy50: 0.4063 - 8s/epoch - 29ms/step
Epoch 8/50
286/286 - 8s - loss: 12.5284 - accuracy10: 0.4798 - accuracy20: 0.4656 - accuracy30: 0.4509 - accuracy50: 0.4234 - val_loss: 12.7498 - val_accuracy10: 0.4378 - val_accuracy20: 0.4345 - val_accuracy30: 0.4229 - val_accuracy50: 0.4066 - 8s/epoch - 28ms/step
Epoch 9/50
286/286 - 8s - loss: 12.4942 - accuracy10: 0.4819 - accuracy20: 0.4672 - accuracy30: 0.4525 - accuracy50: 0.4238 - val_loss: 12.7699 - val_accuracy10: 0.4304 - val_accuracy20: 0.4284 - val_accuracy30: 0.4217 - val_accuracy50: 0.4101 - 8s/epoch - 29ms/step
Epoch 10/50
286/286 - 8s - loss: 12.4770 - accuracy10: 0.4851 - accuracy20: 0.4702 - accuracy30: 0.4535 - accuracy50: 0.4249 - val_loss: 12.8050 - val_accuracy10: 0.4198 - val_accuracy20: 0.4208 - val_accuracy30: 0.4142 - val_accuracy50: 0.4048 - 8s/epoch - 28ms/step
Epoch 11/50
286/286 - 8s - loss: 12.4562 - accuracy10: 0.4875 - accuracy20: 0.4726 - accuracy30: 0.4568 - accuracy50: 0.4272 - val_loss: 12.7922 - val_accuracy10: 0.4229 - val_accuracy20: 0.4209 - val_accuracy30: 0.4126 - val_accuracy50: 0.4042 - 8s/epoch - 29ms/step
Epoch 12/50
286/286 - 8s - loss: 12.4251 - accuracy10: 0.4908 - accuracy20: 0.4758 - accuracy30: 0.4598 - accuracy50: 0.4292 - val_loss: 12.7832 - val_accuracy10: 0.4274 - val_accuracy20: 0.4238 - val_accuracy30: 0.4160 - val_accuracy50: 0.4067 - 8s/epoch - 28ms/step
Epoch 13/50
286/286 - 8s - loss: 12.4363 - accuracy10: 0.4902 - accuracy20: 0.4742 - accuracy30: 0.4573 - accuracy50: 0.4255 - val_loss: 12.7681 - val_accuracy10: 0.4379 - val_accuracy20: 0.4301 - val_accuracy30: 0.4178 - val_accuracy50: 0.4016 - 8s/epoch - 29ms/step
Epoch 14/50
286/286 - 8s - loss: 12.4108 - accuracy10: 0.4914 - accuracy20: 0.4764 - accuracy30: 0.4608 - accuracy50: 0.4294 - val_loss: 12.7577 - val_accuracy10: 0.4324 - val_accuracy20: 0.4283 - val_accuracy30: 0.4174 - val_accuracy50: 0.4071 - 8s/epoch - 29ms/step
Epoch 15/50
286/286 - 8s - loss: 12.3885 - accuracy10: 0.4929 - accuracy20: 0.4788 - accuracy30: 0.4633 - accuracy50: 0.4313 - val_loss: 12.8137 - val_accuracy10: 0.4239 - val_accuracy20: 0.4215 - val_accuracy30: 0.4110 - val_accuracy50: 0.4043 - 8s/epoch - 29ms/step
Epoch 16/50
286/286 - 8s - loss: 12.3624 - accuracy10: 0.4975 - accuracy20: 0.4820 - accuracy30: 0.4645 - accuracy50: 0.4324 - val_loss: 12.7982 - val_accuracy10: 0.4268 - val_accuracy20: 0.4287 - val_accuracy30: 0.4191 - val_accuracy50: 0.4072 - 8s/epoch - 29ms/step
Epoch 17/50
286/286 - 8s - loss: 12.3348 - accuracy10: 0.4985 - accuracy20: 0.4821 - accuracy30: 0.4657 - accuracy50: 0.4326 - val_loss: 12.6905 - val_accuracy10: 0.4484 - val_accuracy20: 0.4357 - val_accuracy30: 0.4222 - val_accuracy50: 0.4091 - 8s/epoch - 29ms/step
Epoch 18/50
286/286 - 8s - loss: 12.3257 - accuracy10: 0.5012 - accuracy20: 0.4848 - accuracy30: 0.4663 - accuracy50: 0.4337 - val_loss: 12.7334 - val_accuracy10: 0.4368 - val_accuracy20: 0.4297 - val_accuracy30: 0.4200 - val_accuracy50: 0.4066 - 8s/epoch - 28ms/step
Epoch 19/50
286/286 - 8s - loss: 12.2993 - accuracy10: 0.5037 - accuracy20: 0.4884 - accuracy30: 0.4692 - accuracy50: 0.4379 - val_loss: 12.7459 - val_accuracy10: 0.4367 - val_accuracy20: 0.4289 - val_accuracy30: 0.4189 - val_accuracy50: 0.4059 - 8s/epoch - 29ms/step
Epoch 20/50
286/286 - 8s - loss: 12.2849 - accuracy10: 0.5022 - accuracy20: 0.4874 - accuracy30: 0.4694 - accuracy50: 0.4372 - val_loss: 12.7584 - val_accuracy10: 0.4369 - val_accuracy20: 0.4282 - val_accuracy30: 0.4150 - val_accuracy50: 0.4053 - 8s/epoch - 29ms/step
Epoch 21/50
286/286 - 8s - loss: 12.2704 - accuracy10: 0.5048 - accuracy20: 0.4885 - accuracy30: 0.4726 - accuracy50: 0.4387 - val_loss: 12.7190 - val_accuracy10: 0.4451 - val_accuracy20: 0.4346 - val_accuracy30: 0.4227 - val_accuracy50: 0.4073 - 8s/epoch - 29ms/step
Epoch 22/50
286/286 - 8s - loss: 12.2457 - accuracy10: 0.5083 - accuracy20: 0.4921 - accuracy30: 0.4732 - accuracy50: 0.4393 - val_loss: 12.7218 - val_accuracy10: 0.4524 - val_accuracy20: 0.4394 - val_accuracy30: 0.4254 - val_accuracy50: 0.4078 - 8s/epoch - 29ms/step
Epoch 23/50
286/286 - 8s - loss: 12.2249 - accuracy10: 0.5079 - accuracy20: 0.4922 - accuracy30: 0.4752 - accuracy50: 0.4411 - val_loss: 12.7876 - val_accuracy10: 0.4390 - val_accuracy20: 0.4308 - val_accuracy30: 0.4172 - val_accuracy50: 0.3999 - 8s/epoch - 28ms/step
Epoch 24/50
286/286 - 8s - loss: 12.2025 - accuracy10: 0.5088 - accuracy20: 0.4941 - accuracy30: 0.4761 - accuracy50: 0.4448 - val_loss: 12.7392 - val_accuracy10: 0.4507 - val_accuracy20: 0.4407 - val_accuracy30: 0.4242 - val_accuracy50: 0.4019 - 8s/epoch - 28ms/step
Epoch 25/50
286/286 - 8s - loss: 12.1967 - accuracy10: 0.5113 - accuracy20: 0.4958 - accuracy30: 0.4776 - accuracy50: 0.4432 - val_loss: 12.9314 - val_accuracy10: 0.4320 - val_accuracy20: 0.4227 - val_accuracy30: 0.4110 - val_accuracy50: 0.3980 - 8s/epoch - 30ms/step
Epoch 26/50
286/286 - 8s - loss: 12.1866 - accuracy10: 0.5111 - accuracy20: 0.4961 - accuracy30: 0.4782 - accuracy50: 0.4448 - val_loss: 12.8290 - val_accuracy10: 0.4457 - val_accuracy20: 0.4309 - val_accuracy30: 0.4139 - val_accuracy50: 0.3972 - 8s/epoch - 29ms/step
Epoch 27/50
286/286 - 8s - loss: 12.1650 - accuracy10: 0.5127 - accuracy20: 0.4970 - accuracy30: 0.4808 - accuracy50: 0.4452 - val_loss: 12.8015 - val_accuracy10: 0.4496 - val_accuracy20: 0.4331 - val_accuracy30: 0.4180 - val_accuracy50: 0.4006 - 8s/epoch - 29ms/step
testing model: results/XRAY/W2/deepLOB_L1/seq2seq
Evaluating performance on  test set...
1072/1072 - 14s - 14s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.034525
{'0': {'precision': 0.48824485636645965, 'recall': 0.43578582643062097, 'f1-score': 0.4605262405098778, 'support': 92355}, '1': {'precision': 0.44953918988741093, 'recall': 0.44123127727326333, 'f1-score': 0.4453464910453358, 'support': 84790}, '2': {'precision': 0.47531273604893237, 'recall': 0.531575802530185, 'f1-score': 0.5018723313199693, 'support': 97068}, 'accuracy': 0.47137808929554764, 'macro avg': {'precision': 0.47103226076760096, 'recall': 0.46953096874468975, 'f1-score': 0.4692483542917276, 'support': 274213}, 'weighted avg': {'precision': 0.4716987826364021, 'recall': 0.47137808929554764, 'f1-score': 0.47046848024926086, 'support': 274213}}
[[40247 23536 28572]
 [18991 37412 28387]
 [23194 22275 51599]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0511222
{'0': {'precision': 0.47473246853636736, 'recall': 0.41300647276395425, 'f1-score': 0.44172351400860854, 'support': 95168}, '1': {'precision': 0.4004424778761062, 'recall': 0.43244701348747594, 'f1-score': 0.4158298439989625, 'support': 77850}, '2': {'precision': 0.4785508677466534, 'recall': 0.507643658283512, 'f1-score': 0.49266814358738287, 'support': 101195}, 'accuracy': 0.4534504199290333, 'macro avg': {'precision': 0.45124193805304236, 'recall': 0.45103238151164743, 'f1-score': 0.4500738338649846, 'support': 274213}, 'weighted avg': {'precision': 0.4550504225910021, 'recall': 0.4534504199290333, 'f1-score': 0.4531727143746493, 'support': 274213}}
[[39305 25931 29932]
 [18140 33666 26044]
 [25349 24475 51371]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0631397
{'0': {'precision': 0.456659856487941, 'recall': 0.3870773584507191, 'f1-score': 0.41899939419570903, 'support': 94702}, '1': {'precision': 0.37625332276267315, 'recall': 0.41782542271938683, 'f1-score': 0.39595116863996077, 'support': 77238}, '2': {'precision': 0.47017167580360364, 'recall': 0.49727689615049914, 'f1-score': 0.4833445795040914, 'support': 102273}, 'accuracy': 0.43683924540412017, 'macro avg': {'precision': 0.4343616183514059, 'recall': 0.4340598924402017, 'f1-score': 0.4327650474465871, 'support': 274213}, 'weighted avg': {'precision': 0.4390511160015254, 'recall': 0.43683924540412017, 'f1-score': 0.43650613636901703, 'support': 274213}}
[[36657 27296 30749]
 [18404 32272 26562]
 [25211 26204 50858]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0754274
{'0': {'precision': 0.4204970104633782, 'recall': 0.341320997952529, 'f1-score': 0.3767946088485204, 'support': 92309}, '1': {'precision': 0.3755259739538808, 'recall': 0.4206389673054682, 'f1-score': 0.39680435471193437, 'support': 80411}, '2': {'precision': 0.4530646254143242, 'recall': 0.48753115978441863, 'f1-score': 0.46966640880464344, 'support': 101493}, 'accuracy': 0.4186964148308067, 'macro avg': {'precision': 0.41636253661052774, 'recall': 0.4164970416808053, 'f1-score': 0.41442179078836605, 'support': 274213}, 'weighted avg': {'precision': 0.41936365401219305, 'recall': 0.4186964148308067, 'f1-score': 0.41703646925473664, 'support': 274213}}
[[31507 28545 32257]
 [19111 33824 27476]
 [24310 27702 49481]]
Evaluating performance on  train set...
286/286 - 4s - 4s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0181822
{'0': {'precision': 0.4810940898782802, 'recall': 0.44986367767343227, 'f1-score': 0.46495504763608714, 'support': 23107}, '1': {'precision': 0.5112996416294888, 'recall': 0.5134212169059597, 'f1-score': 0.5123582330200261, 'support': 27233}, '2': {'precision': 0.4530581738155545, 'recall': 0.48074550581600284, 'f1-score': 0.46649137433463733, 'support': 22696}, 'accuracy': 0.48315899008708035, 'macro avg': {'precision': 0.48181730177444115, 'recall': 0.4813434667984649, 'f1-score': 0.4812682183302502, 'support': 73036}, 'weighted avg': {'precision': 0.48364467643670406, 'recall': 0.48315899008708035, 'f1-score': 0.48310773149488434, 'support': 73036}}
[[10395  6784  5928]
 [ 6007 13982  7244]
 [ 5205  6580 10911]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0405134
{'0': {'precision': 0.48245369077538863, 'recall': 0.4252369036386758, 'f1-score': 0.45204195102806183, 'support': 24377}, '1': {'precision': 0.4479072622873858, 'recall': 0.5035115495473552, 'f1-score': 0.4740845501108478, 'support': 24633}, '2': {'precision': 0.45651536107967644, 'recall': 0.4533422126030134, 'f1-score': 0.45492325362848496, 'support': 24026}, 'accuracy': 0.4608823046169013, 'macro avg': {'precision': 0.46229210471415033, 'recall': 0.4606968885963481, 'f1-score': 0.46034991825579824, 'support': 73036}, 'weighted avg': {'precision': 0.46226944626289956, 'recall': 0.4608823046169013, 'f1-score': 0.4604241395307732, 'support': 73036}}
[[10366  7759  6252]
 [ 5515 12403  6715]
 [ 5605  7529 10892]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.056804
{'0': {'precision': 0.4702819956616052, 'recall': 0.3937046004842615, 'f1-score': 0.4285996705107084, 'support': 24780}, '1': {'precision': 0.4091728844725768, 'recall': 0.48796019061274404, 'f1-score': 0.44510693952915836, 'support': 23713}, '2': {'precision': 0.44802598700649676, 'recall': 0.438332722161105, 'f1-score': 0.4431263515600865, 'support': 24543}, 'accuracy': 0.43930390492359933, 'macro avg': {'precision': 0.44249362238022627, 'recall': 0.43999917108603687, 'f1-score': 0.4389443205333177, 'support': 73036}, 'weighted avg': {'precision': 0.4429624604454412, 'recall': 0.43930390492359933, 'f1-score': 0.43884071880510284, 'support': 73036}}
[[ 9756  8495  6529]
 [ 5417 11571  6725]
 [ 5572  8213 10758]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0722835
{'0': {'precision': 0.4368101974195554, 'recall': 0.3441378184193338, 'f1-score': 0.3849754538189291, 'support': 24496}, '1': {'precision': 0.3956401056123485, 'recall': 0.48071070165336843, 'f1-score': 0.4340463458110517, 'support': 24314}, '2': {'precision': 0.42223599917338295, 'recall': 0.42169569883596136, 'f1-score': 0.4219656760496479, 'support': 24226}, 'accuracy': 0.4153294265841503, 'macro avg': {'precision': 0.41822876740176235, 'recall': 0.41551473963622126, 'f1-score': 0.41366249189320964, 'support': 73036}, 'weighted avg': {'precision': 0.4182702426176467, 'recall': 0.4153294265841503, 'f1-score': 0.41358100165366624, 'support': 73036}}
[[ 8430  9081  6985]
 [ 5632 11688  6994]
 [ 5237  8773 10216]]
Evaluating performance on  val set...
117/117 - 1s - 1s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0515221
{'0': {'precision': 0.43952048737348925, 'recall': 0.4859315589353612, 'f1-score': 0.46156227427510066, 'support': 9205}, '1': {'precision': 0.5645052347180006, 'recall': 0.29036741075306177, 'f1-score': 0.3834815027244049, 'support': 11513}, '2': {'precision': 0.4026258205689278, 'recall': 0.6071939280607194, 'f1-score': 0.48418928994342353, 'support': 9091}, 'accuracy': 0.4473816632560636, 'macro avg': {'precision': 0.4688838475534725, 'recall': 0.4611642992497142, 'f1-score': 0.4430776889809764, 'support': 29809}, 'weighted avg': {'precision': 0.47654084968879973, 'recall': 0.4473816632560636, 'f1-score': 0.43830615285464253, 'support': 29809}}
[[4473 1423 3309]
 [3289 3343 4881]
 [2415 1156 5520]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0547585
{'0': {'precision': 0.43547470153496304, 'recall': 0.4700828474992329, 'f1-score': 0.4521174561015198, 'support': 9777}, '1': {'precision': 0.49533678756476685, 'recall': 0.27696764847899563, 'f1-score': 0.35528027253019506, 'support': 10355}, '2': {'precision': 0.4089119940586706, 'recall': 0.568977989046192, 'f1-score': 0.47584478437472993, 'support': 9677}, 'accuracy': 0.4351034922338891, 'macro avg': {'precision': 0.44657449438613356, 'recall': 0.4386761616748068, 'f1-score': 0.42774750433548164, 'support': 29809}, 'weighted avg': {'precision': 0.4476463470309722, 'recall': 0.4351034922338891, 'f1-score': 0.42618100468814757, 'support': 29809}}
[[4596 1589 3592]
 [3120 2868 4367]
 [2838 1333 5506]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0639929
{'0': {'precision': 0.426775852218625, 'recall': 0.45447170959237476, 'f1-score': 0.4401885680612846, 'support': 9862}, '1': {'precision': 0.44919786096256686, 'recall': 0.26226206063047636, 'f1-score': 0.33117130866081645, 'support': 9929}, '2': {'precision': 0.4075499629903775, 'recall': 0.5496107007386704, 'f1-score': 0.4680380822849371, 'support': 10018}, 'accuracy': 0.422422758227381, 'macro avg': {'precision': 0.4278412253905231, 'recall': 0.4221148236538405, 'f1-score': 0.41313265300234603, 'support': 29809}, 'weighted avg': {'precision': 0.4277830368450806, 'recall': 0.422422758227381, 'f1-score': 0.41323577074857043, 'support': 29809}}
[[4482 1688 3692]
 [3013 2604 4312]
 [3007 1505 5506]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0711582
{'0': {'precision': 0.3979612034837688, 'recall': 0.42175372351583806, 'f1-score': 0.40951217028210607, 'support': 9534}, '1': {'precision': 0.4637366310160428, 'recall': 0.2710490330142606, 'f1-score': 0.34212797435581305, 'support': 10238}, '2': {'precision': 0.3958166314408571, 'recall': 0.5410979376307662, 'f1-score': 0.457193366444987, 'support': 10037}, 'accuracy': 0.41017813412056764, 'macro avg': {'precision': 0.4191714886468896, 'recall': 0.411300231386955, 'f1-score': 0.402944503694302, 'support': 29809}, 'weighted avg': {'precision': 0.41982989272127147, 'recall': 0.41017813412056764, 'f1-score': 0.40242359864244853, 'support': 29809}}
[[4021 1678 3835]
 [3008 2775 4455]
 [3075 1531 5431]]
training model: results/XRAY/W2/deepOF_L1/seq2seq
Epoch 1/50
286/286 - 14s - loss: 13.1096 - accuracy10: 0.3777 - accuracy20: 0.3809 - accuracy30: 0.3797 - accuracy50: 0.3804 - val_loss: 13.2719 - val_accuracy10: 0.3823 - val_accuracy20: 0.3496 - val_accuracy30: 0.3389 - val_accuracy50: 0.3470 - 14s/epoch - 48ms/step
Epoch 2/50
286/286 - 8s - loss: 12.9899 - accuracy10: 0.3902 - accuracy20: 0.3961 - accuracy30: 0.3957 - accuracy50: 0.3939 - val_loss: 13.3152 - val_accuracy10: 0.3870 - val_accuracy20: 0.3505 - val_accuracy30: 0.3372 - val_accuracy50: 0.3457 - 8s/epoch - 28ms/step
Epoch 3/50
286/286 - 8s - loss: 12.9360 - accuracy10: 0.3941 - accuracy20: 0.3971 - accuracy30: 0.3970 - accuracy50: 0.3950 - val_loss: 13.2246 - val_accuracy10: 0.3888 - val_accuracy20: 0.3535 - val_accuracy30: 0.3395 - val_accuracy50: 0.3459 - 8s/epoch - 27ms/step
Epoch 4/50
286/286 - 8s - loss: 12.9119 - accuracy10: 0.3954 - accuracy20: 0.3993 - accuracy30: 0.3996 - accuracy50: 0.3957 - val_loss: 13.1491 - val_accuracy10: 0.3933 - val_accuracy20: 0.3555 - val_accuracy30: 0.3441 - val_accuracy50: 0.3528 - 8s/epoch - 28ms/step
Epoch 5/50
286/286 - 8s - loss: 12.8869 - accuracy10: 0.3979 - accuracy20: 0.4023 - accuracy30: 0.4015 - accuracy50: 0.3974 - val_loss: 13.0957 - val_accuracy10: 0.3969 - val_accuracy20: 0.3614 - val_accuracy30: 0.3510 - val_accuracy50: 0.3593 - 8s/epoch - 27ms/step
Epoch 6/50
286/286 - 8s - loss: 12.8640 - accuracy10: 0.4014 - accuracy20: 0.4050 - accuracy30: 0.4044 - accuracy50: 0.3993 - val_loss: 13.0690 - val_accuracy10: 0.4003 - val_accuracy20: 0.3651 - val_accuracy30: 0.3551 - val_accuracy50: 0.3629 - 8s/epoch - 27ms/step
Epoch 7/50
286/286 - 8s - loss: 12.8451 - accuracy10: 0.4062 - accuracy20: 0.4065 - accuracy30: 0.4061 - accuracy50: 0.4016 - val_loss: 13.0854 - val_accuracy10: 0.3986 - val_accuracy20: 0.3636 - val_accuracy30: 0.3547 - val_accuracy50: 0.3613 - 8s/epoch - 27ms/step
Epoch 8/50
286/286 - 8s - loss: 12.8285 - accuracy10: 0.4094 - accuracy20: 0.4084 - accuracy30: 0.4066 - accuracy50: 0.3994 - val_loss: 13.0937 - val_accuracy10: 0.3979 - val_accuracy20: 0.3598 - val_accuracy30: 0.3503 - val_accuracy50: 0.3606 - 8s/epoch - 27ms/step
Epoch 9/50
286/286 - 8s - loss: 12.8131 - accuracy10: 0.4122 - accuracy20: 0.4115 - accuracy30: 0.4091 - accuracy50: 0.4043 - val_loss: 13.0755 - val_accuracy10: 0.4012 - val_accuracy20: 0.3640 - val_accuracy30: 0.3548 - val_accuracy50: 0.3646 - 8s/epoch - 28ms/step
Epoch 10/50
286/286 - 8s - loss: 12.8013 - accuracy10: 0.4126 - accuracy20: 0.4142 - accuracy30: 0.4123 - accuracy50: 0.4047 - val_loss: 13.0646 - val_accuracy10: 0.4026 - val_accuracy20: 0.3669 - val_accuracy30: 0.3582 - val_accuracy50: 0.3650 - 8s/epoch - 26ms/step
Epoch 11/50
286/286 - 8s - loss: 12.7860 - accuracy10: 0.4143 - accuracy20: 0.4141 - accuracy30: 0.4129 - accuracy50: 0.4065 - val_loss: 13.0410 - val_accuracy10: 0.4059 - val_accuracy20: 0.3730 - val_accuracy30: 0.3613 - val_accuracy50: 0.3684 - 8s/epoch - 27ms/step
Epoch 12/50
286/286 - 8s - loss: 12.7730 - accuracy10: 0.4171 - accuracy20: 0.4176 - accuracy30: 0.4156 - accuracy50: 0.4071 - val_loss: 13.0763 - val_accuracy10: 0.4045 - val_accuracy20: 0.3681 - val_accuracy30: 0.3585 - val_accuracy50: 0.3668 - 8s/epoch - 27ms/step
Epoch 13/50
286/286 - 8s - loss: 12.7544 - accuracy10: 0.4194 - accuracy20: 0.4208 - accuracy30: 0.4160 - accuracy50: 0.4071 - val_loss: 13.0704 - val_accuracy10: 0.4039 - val_accuracy20: 0.3675 - val_accuracy30: 0.3555 - val_accuracy50: 0.3594 - 8s/epoch - 27ms/step
Epoch 14/50
286/286 - 8s - loss: 12.7392 - accuracy10: 0.4211 - accuracy20: 0.4228 - accuracy30: 0.4193 - accuracy50: 0.4101 - val_loss: 13.0734 - val_accuracy10: 0.4060 - val_accuracy20: 0.3673 - val_accuracy30: 0.3541 - val_accuracy50: 0.3629 - 8s/epoch - 28ms/step
Epoch 15/50
286/286 - 8s - loss: 12.7272 - accuracy10: 0.4234 - accuracy20: 0.4257 - accuracy30: 0.4230 - accuracy50: 0.4123 - val_loss: 13.0885 - val_accuracy10: 0.4050 - val_accuracy20: 0.3667 - val_accuracy30: 0.3543 - val_accuracy50: 0.3624 - 8s/epoch - 28ms/step
Epoch 16/50
286/286 - 8s - loss: 12.7046 - accuracy10: 0.4251 - accuracy20: 0.4252 - accuracy30: 0.4245 - accuracy50: 0.4141 - val_loss: 13.0989 - val_accuracy10: 0.4056 - val_accuracy20: 0.3680 - val_accuracy30: 0.3598 - val_accuracy50: 0.3650 - 8s/epoch - 27ms/step
Epoch 17/50
286/286 - 8s - loss: 12.6917 - accuracy10: 0.4272 - accuracy20: 0.4276 - accuracy30: 0.4255 - accuracy50: 0.4158 - val_loss: 13.0950 - val_accuracy10: 0.4041 - val_accuracy20: 0.3699 - val_accuracy30: 0.3608 - val_accuracy50: 0.3684 - 8s/epoch - 26ms/step
Epoch 18/50
286/286 - 8s - loss: 12.6726 - accuracy10: 0.4296 - accuracy20: 0.4328 - accuracy30: 0.4295 - accuracy50: 0.4183 - val_loss: 13.1458 - val_accuracy10: 0.4031 - val_accuracy20: 0.3663 - val_accuracy30: 0.3534 - val_accuracy50: 0.3603 - 8s/epoch - 28ms/step
Epoch 19/50
286/286 - 8s - loss: 12.6547 - accuracy10: 0.4318 - accuracy20: 0.4328 - accuracy30: 0.4312 - accuracy50: 0.4192 - val_loss: 13.1062 - val_accuracy10: 0.4045 - val_accuracy20: 0.3684 - val_accuracy30: 0.3589 - val_accuracy50: 0.3649 - 8s/epoch - 27ms/step
Epoch 20/50
286/286 - 8s - loss: 12.6486 - accuracy10: 0.4322 - accuracy20: 0.4353 - accuracy30: 0.4319 - accuracy50: 0.4198 - val_loss: 13.1647 - val_accuracy10: 0.4029 - val_accuracy20: 0.3658 - val_accuracy30: 0.3553 - val_accuracy50: 0.3600 - 8s/epoch - 27ms/step
Epoch 21/50
286/286 - 8s - loss: 12.6272 - accuracy10: 0.4337 - accuracy20: 0.4350 - accuracy30: 0.4329 - accuracy50: 0.4213 - val_loss: 13.1834 - val_accuracy10: 0.4035 - val_accuracy20: 0.3701 - val_accuracy30: 0.3564 - val_accuracy50: 0.3585 - 8s/epoch - 27ms/step
testing model: results/XRAY/W2/deepOF_L1/seq2seq
Evaluating performance on  test set...
1072/1072 - 13s - 13s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0941768
{'0': {'precision': 0.5396240932072983, 'recall': 0.10632031444565959, 'f1-score': 0.17764068422147647, 'support': 92353}, '1': {'precision': 0.3195372572563327, 'recall': 0.816037457689087, 'f1-score': 0.4592465253348555, 'support': 84789}, '2': {'precision': 0.46850064594574053, 'recall': 0.1905404570086333, 'f1-score': 0.27090367137092347, 'support': 97066}, 'accuracy': 0.3555877290232232, 'macro avg': {'precision': 0.4425539988031239, 'recall': 0.3709660763811266, 'f1-score': 0.3025969603090852, 'support': 274208}, 'weighted avg': {'precision': 0.446393365929696, 'recall': 0.3555877290232232, 'f1-score': 0.2977310636881971, 'support': 274208}}
[[ 9819 72388 10146]
 [ 4762 69191 10836]
 [ 3615 74956 18495]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0989507
{'0': {'precision': 0.5530801071341612, 'recall': 0.09547527478301074, 'f1-score': 0.16284029607326558, 'support': 95166}, '1': {'precision': 0.2894106597792909, 'recall': 0.7916607792007605, 'f1-score': 0.4238666570380228, 'support': 77849}, '2': {'precision': 0.4680794111086326, 'recall': 0.20736612216260017, 'f1-score': 0.2874067783842271, 'support': 101193}, 'accuracy': 0.3344176683393628, 'macro avg': {'precision': 0.43685672600736164, 'recall': 0.3648340587154571, 'f1-score': 0.2913712438318385, 'support': 274208}, 'weighted avg': {'precision': 0.44685462049613234, 'recall': 0.3344176683393628, 'f1-score': 0.28291665131905896, 'support': 274208}}
[[ 9086 74241 11839]
 [ 4212 61630 12007]
 [ 3130 77079 20984]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0973287
{'0': {'precision': 0.5312461708124004, 'recall': 0.09156379687219506, 'f1-score': 0.15620468199709964, 'support': 94699}, '1': {'precision': 0.2859039720170236, 'recall': 0.7471289666869505, 'f1-score': 0.41355339444018435, 'support': 77237}, '2': {'precision': 0.4565647915217042, 'recall': 0.250215112640801, 'f1-score': 0.32326728608333705, 'support': 102272}, 'accuracy': 0.335391381724822, 'macro avg': {'precision': 0.4245716447837094, 'recall': 0.3629692920666489, 'f1-score': 0.29767512084020703, 'support': 274208}, 'weighted avg': {'precision': 0.4342857997394317, 'recall': 0.335391381724822, 'f1-score': 0.2910026060112575, 'support': 274208}}
[[ 8671 70740 15288]
 [ 4360 57706 15171]
 [ 3291 73391 25590]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0932807
{'0': {'precision': 0.49438943894389437, 'recall': 0.08925553581488062, 'f1-score': 0.1512117680526369, 'support': 92308}, '1': {'precision': 0.29786772901787556, 'recall': 0.7178460390498694, 'f1-score': 0.4210303653617511, 'support': 80410}, '2': {'precision': 0.44511363101679763, 'recall': 0.2796334614247709, 'f1-score': 0.3434816549570648, 'support': 101490}, 'accuracy': 0.34404904306220097, 'macro avg': {'precision': 0.41245693299285585, 'recall': 0.362245012096507, 'f1-score': 0.3052412627904843, 'support': 274208}, 'weighted avg': {'precision': 0.4185225333770538, 'recall': 0.34404904306220097, 'f1-score': 0.30149762488962295, 'support': 274208}}
[[ 8239 66473 17596]
 [ 4905 57722 17783]
 [ 3521 69589 28380]]
Evaluating performance on  train set...
286/286 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0679433
{'0': {'precision': 0.5320411392405063, 'recall': 0.1166471532023763, 'f1-score': 0.19134331543194508, 'support': 23061}, '1': {'precision': 0.38820727856292386, 'recall': 0.8231914815763475, 'f1-score': 0.5276031894934334, 'support': 27329}, '2': {'precision': 0.44803510871733493, 'recall': 0.19838360641257785, 'f1-score': 0.27500076525146167, 'support': 22643}, 'accuracy': 0.40637793874002165, 'macro avg': {'precision': 0.45609450884025504, 'recall': 0.3794074137304339, 'f1-score': 0.33131575672561336, 'support': 73033}, 'weighted avg': {'precision': 0.4521733516979732, 'recall': 0.40637793874002165, 'f1-score': 0.3431089793713934, 'support': 73033}}
[[ 2690 18097  2274]
 [ 1572 22497  3260]
 [  794 17357  4492]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0778102
{'0': {'precision': 0.5599093997734994, 'recall': 0.10159878344498788, 'f1-score': 0.1719891463160092, 'support': 24331}, '1': {'precision': 0.3489553433188943, 'recall': 0.8116123811450536, 'f1-score': 0.48806540305116913, 'support': 24715}, '2': {'precision': 0.45999101930848674, 'recall': 0.21353233001208988, 'f1-score': 0.2916690393485565, 'support': 23987}, 'accuracy': 0.37863705448222035, 'macro avg': {'precision': 0.45628525413362686, 'recall': 0.3755811648673771, 'f1-score': 0.31724119623857827, 'support': 73033}, 'weighted avg': {'precision': 0.45570346961193103, 'recall': 0.37863705448222035, 'f1-score': 0.31825982230331895, 'support': 73033}}
[[ 2472 19217  2642]
 [ 1285 20059  3371]
 [  658 18207  5122]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0819572
{'0': {'precision': 0.539671682626539, 'recall': 0.09552829122608766, 'f1-score': 0.16232341242627898, 'support': 24778}, '1': {'precision': 0.33401773384693656, 'recall': 0.7771295709152399, 'f1-score': 0.46721988537443926, 'support': 23655}, '2': {'precision': 0.4558812725001837, 'recall': 0.2522357723577236, 'f1-score': 0.3247755881814138, 'support': 24600}, 'accuracy': 0.3690797310804705, 'macro avg': {'precision': 0.4431902296578864, 'recall': 0.37496454483301705, 'f1-score': 0.3181062953273774, 'support': 73033}, 'weighted avg': {'precision': 0.44483800131138235, 'recall': 0.3690797310804705, 'f1-score': 0.3157971789587376, 'support': 73033}}
[[ 2367 18966  3445]
 [ 1311 18383  3961]
 [  708 17687  6205]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0851375
{'0': {'precision': 0.49236641221374045, 'recall': 0.08958333333333333, 'f1-score': 0.15158636897767333, 'support': 24480}, '1': {'precision': 0.34034308930855467, 'recall': 0.7440273037542662, 'f1-score': 0.46704438392937814, 'support': 24319}, '2': {'precision': 0.42056438533895557, 'recall': 0.26751671205744, 'f1-score': 0.3270195969633535, 'support': 24234}, 'accuracy': 0.36654662960579465, 'macro avg': {'precision': 0.41775796228708356, 'recall': 0.36704244971501315, 'f1-score': 0.31521678329013497, 'support': 73033}, 'weighted avg': {'precision': 0.41791916906318183, 'recall': 0.36654662960579465, 'f1-score': 0.31484232604660767, 'support': 73033}}
[[ 2193 18110  4177]
 [ 1470 18094  4755]
 [  791 16960  6483]]
Evaluating performance on  val set...
117/117 - 1s - 1s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0754732
{'0': {'precision': 0.4788654060066741, 'recall': 0.09340420915599913, 'f1-score': 0.15631808278867101, 'support': 9218}, '1': {'precision': 0.39539162798477817, 'recall': 0.827426271112278, 'f1-score': 0.5350877192982456, 'support': 11427}, '2': {'precision': 0.4226451927769644, 'recall': 0.18900043649061546, 'f1-score': 0.26119740612275677, 'support': 9164}, 'accuracy': 0.4041732362709249, 'macro avg': {'precision': 0.4323007422561389, 'recall': 0.36994363891963084, 'f1-score': 0.3175344027365578, 'support': 29809}, 'weighted avg': {'precision': 0.4295830786728734, 'recall': 0.4041732362709249, 'f1-score': 0.3337582772074194, 'support': 29809}}
[[ 861 7377  980]
 [ 586 9455 1386]
 [ 351 7081 1732]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0870095
{'0': {'precision': 0.4896421845574388, 'recall': 0.08004926108374384, 'f1-score': 0.13760254035459116, 'support': 9744}, '1': {'precision': 0.35213726158038144, 'recall': 0.8029317541986215, 'f1-score': 0.4895676107608985, 'support': 10301}, '2': {'precision': 0.42343485617597293, 'recall': 0.20503891847603442, 'f1-score': 0.27629036709908916, 'support': 9764}, 'accuracy': 0.370794055486598, 'macro avg': {'precision': 0.4217381007712644, 'recall': 0.36267331125279995, 'f1-score': 0.3011535060715263, 'support': 29809}, 'weighted avg': {'precision': 0.42043870353146334, 'recall': 0.370794055486598, 'f1-score': 0.30465746103588376, 'support': 29809}}
[[ 780 7759 1205]
 [ 509 8271 1521]
 [ 304 7458 2002]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0900882
{'0': {'precision': 0.476010101010101, 'recall': 0.07644732839906722, 'f1-score': 0.13173757316327422, 'support': 9863}, '1': {'precision': 0.33958952200918174, 'recall': 0.7589016294508147, 'f1-score': 0.46921641791044777, 'support': 9942}, '2': {'precision': 0.4196770434493091, 'recall': 0.25199920031987205, 'f1-score': 0.3149085004059709, 'support': 10004}, 'accuracy': 0.3629776242074541, 'macro avg': {'precision': 0.411758888822864, 'recall': 0.36244938605658467, 'f1-score': 0.3052874971598976, 'support': 29809}, 'weighted avg': {'precision': 0.4116050788937837, 'recall': 0.3629776242074541, 'f1-score': 0.3057674510730443, 'support': 29809}}
[[ 754 7506 1603]
 [ 514 7545 1883]
 [ 316 7167 2521]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0886889
{'0': {'precision': 0.4383561643835616, 'recall': 0.07716502411407003, 'f1-score': 0.13122938397075867, 'support': 9538}, '1': {'precision': 0.3503721850560633, 'recall': 0.7271927251393371, 'f1-score': 0.4728960671478079, 'support': 10227}, '2': {'precision': 0.4041135573580533, 'recall': 0.2777777777777778, 'f1-score': 0.3292423884824168, 'support': 10044}, 'accuracy': 0.3677748331040961, 'macro avg': {'precision': 0.39761396893255946, 'recall': 0.36071184234372833, 'f1-score': 0.3111226132003278, 'support': 29809}, 'weighted avg': {'precision': 0.39663235944054004, 'recall': 0.3677748331040961, 'f1-score': 0.31516939491264795, 'support': 29809}}
[[ 736 6919 1883]
 [ 559 7437 2231]
 [ 384 6870 2790]]
training model: results/XRAY/W2/deepLOB_L2/seq2seq
Epoch 1/50
286/286 - 21s - loss: 13.1310 - accuracy10: 0.3824 - accuracy20: 0.3803 - accuracy30: 0.3768 - accuracy50: 0.3772 - val_loss: 13.2193 - val_accuracy10: 0.3670 - val_accuracy20: 0.3619 - val_accuracy30: 0.3609 - val_accuracy50: 0.3609 - 21s/epoch - 74ms/step
Epoch 2/50
286/286 - 15s - loss: 12.7858 - accuracy10: 0.4339 - accuracy20: 0.4308 - accuracy30: 0.4207 - accuracy50: 0.4061 - val_loss: 12.9801 - val_accuracy10: 0.4144 - val_accuracy20: 0.4124 - val_accuracy30: 0.4010 - val_accuracy50: 0.3904 - 15s/epoch - 54ms/step
Epoch 3/50
286/286 - 15s - loss: 12.6586 - accuracy10: 0.4573 - accuracy20: 0.4483 - accuracy30: 0.4360 - accuracy50: 0.4175 - val_loss: 12.9301 - val_accuracy10: 0.4172 - val_accuracy20: 0.4189 - val_accuracy30: 0.4125 - val_accuracy50: 0.3985 - 15s/epoch - 53ms/step
Epoch 4/50
286/286 - 15s - loss: 12.5789 - accuracy10: 0.4682 - accuracy20: 0.4583 - accuracy30: 0.4449 - accuracy50: 0.4232 - val_loss: 12.8640 - val_accuracy10: 0.4235 - val_accuracy20: 0.4204 - val_accuracy30: 0.4154 - val_accuracy50: 0.4040 - 15s/epoch - 53ms/step
Epoch 5/50
286/286 - 15s - loss: 12.5197 - accuracy10: 0.4752 - accuracy20: 0.4653 - accuracy30: 0.4495 - accuracy50: 0.4248 - val_loss: 12.8638 - val_accuracy10: 0.4210 - val_accuracy20: 0.4224 - val_accuracy30: 0.4156 - val_accuracy50: 0.4058 - 15s/epoch - 54ms/step
Epoch 6/50
286/286 - 15s - loss: 12.4698 - accuracy10: 0.4798 - accuracy20: 0.4697 - accuracy30: 0.4545 - accuracy50: 0.4298 - val_loss: 12.8668 - val_accuracy10: 0.4271 - val_accuracy20: 0.4244 - val_accuracy30: 0.4180 - val_accuracy50: 0.4043 - 15s/epoch - 53ms/step
Epoch 7/50
286/286 - 15s - loss: 12.4129 - accuracy10: 0.4841 - accuracy20: 0.4748 - accuracy30: 0.4589 - accuracy50: 0.4321 - val_loss: 12.9318 - val_accuracy10: 0.4371 - val_accuracy20: 0.4296 - val_accuracy30: 0.4180 - val_accuracy50: 0.4084 - 15s/epoch - 53ms/step
Epoch 8/50
286/286 - 15s - loss: 12.3838 - accuracy10: 0.4896 - accuracy20: 0.4793 - accuracy30: 0.4625 - accuracy50: 0.4334 - val_loss: 12.8786 - val_accuracy10: 0.4425 - val_accuracy20: 0.4340 - val_accuracy30: 0.4226 - val_accuracy50: 0.4090 - 15s/epoch - 53ms/step
Epoch 9/50
286/286 - 15s - loss: 12.3547 - accuracy10: 0.4904 - accuracy20: 0.4805 - accuracy30: 0.4640 - accuracy50: 0.4345 - val_loss: 12.8960 - val_accuracy10: 0.4450 - val_accuracy20: 0.4351 - val_accuracy30: 0.4246 - val_accuracy50: 0.4088 - 15s/epoch - 54ms/step
Epoch 10/50
286/286 - 15s - loss: 12.3249 - accuracy10: 0.4928 - accuracy20: 0.4825 - accuracy30: 0.4680 - accuracy50: 0.4390 - val_loss: 12.9167 - val_accuracy10: 0.4528 - val_accuracy20: 0.4389 - val_accuracy30: 0.4254 - val_accuracy50: 0.4077 - 15s/epoch - 54ms/step
Epoch 11/50
286/286 - 15s - loss: 12.2889 - accuracy10: 0.4955 - accuracy20: 0.4866 - accuracy30: 0.4697 - accuracy50: 0.4391 - val_loss: 12.9937 - val_accuracy10: 0.4519 - val_accuracy20: 0.4363 - val_accuracy30: 0.4223 - val_accuracy50: 0.4065 - 15s/epoch - 53ms/step
Epoch 12/50
286/286 - 15s - loss: 12.2584 - accuracy10: 0.4979 - accuracy20: 0.4889 - accuracy30: 0.4720 - accuracy50: 0.4408 - val_loss: 12.9102 - val_accuracy10: 0.4530 - val_accuracy20: 0.4386 - val_accuracy30: 0.4242 - val_accuracy50: 0.4089 - 15s/epoch - 53ms/step
Epoch 13/50
286/286 - 15s - loss: 12.2113 - accuracy10: 0.5021 - accuracy20: 0.4940 - accuracy30: 0.4789 - accuracy50: 0.4464 - val_loss: 13.0909 - val_accuracy10: 0.4454 - val_accuracy20: 0.4303 - val_accuracy30: 0.4158 - val_accuracy50: 0.4006 - 15s/epoch - 53ms/step
Epoch 14/50
286/286 - 15s - loss: 12.1896 - accuracy10: 0.5035 - accuracy20: 0.4922 - accuracy30: 0.4770 - accuracy50: 0.4462 - val_loss: 12.9524 - val_accuracy10: 0.4550 - val_accuracy20: 0.4378 - val_accuracy30: 0.4208 - val_accuracy50: 0.4026 - 15s/epoch - 53ms/step
Epoch 15/50
286/286 - 15s - loss: 12.1375 - accuracy10: 0.5063 - accuracy20: 0.4981 - accuracy30: 0.4830 - accuracy50: 0.4511 - val_loss: 13.1227 - val_accuracy10: 0.4473 - val_accuracy20: 0.4294 - val_accuracy30: 0.4122 - val_accuracy50: 0.3981 - 15s/epoch - 53ms/step
testing model: results/XRAY/W2/deepLOB_L2/seq2seq
Evaluating performance on  test set...
1072/1072 - 21s - 21s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.032628
{'0': {'precision': 0.48105759400204473, 'recall': 0.36682366953602946, 'f1-score': 0.4162453387722003, 'support': 92355}, '1': {'precision': 0.5123104491996325, 'recall': 0.40123835357943155, 'f1-score': 0.4500221565242696, 'support': 84790}, '2': {'precision': 0.44000669665603936, 'recall': 0.6227490007005398, 'f1-score': 0.5156664534015781, 'support': 97068}, 'accuracy': 0.46805950119068024, 'macro avg': {'precision': 0.4777915799525722, 'recall': 0.46360367460533364, 'f1-score': 0.4606446495660161, 'support': 274213}, 'weighted avg': {'precision': 0.47618984917820856, 'recall': 0.46805950119068024, 'f1-score': 0.4618833834018948, 'support': 274213}}
[[33878 16752 41725]
 [15561 34021 35208]
 [20985 15634 60449]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0443716
{'0': {'precision': 0.46877128263337114, 'recall': 0.34716501344989914, 'f1-score': 0.3989061141698058, 'support': 95168}, '1': {'precision': 0.464223541489979, 'recall': 0.4007707129094412, 'f1-score': 0.4301697929807871, 'support': 77850}, '2': {'precision': 0.44620726026193197, 'recall': 0.6019862641434853, 'f1-score': 0.5125210858198125, 'support': 101195}, 'accuracy': 0.45642256202295295, 'macro avg': {'precision': 0.4597340281284274, 'recall': 0.44997399683427525, 'f1-score': 0.4471989976568018, 'support': 274213}, 'weighted avg': {'precision': 0.4591531832292916, 'recall': 0.45642256202295295, 'f1-score': 0.4497102133611545, 'support': 274213}}
[[33039 18407 43722]
 [14766 31200 31884]
 [22675 17602 60918]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0563827
{'0': {'precision': 0.44832772433511037, 'recall': 0.31791303245971575, 'f1-score': 0.3720220442862791, 'support': 94702}, '1': {'precision': 0.4372845514324614, 'recall': 0.3908827261192677, 'f1-score': 0.4127837024883785, 'support': 77238}, '2': {'precision': 0.4419238209785751, 'recall': 0.5963744096682408, 'f1-score': 0.5076615755961547, 'support': 102273}, 'accuracy': 0.4423240327774394, 'macro avg': {'precision': 0.44251203224871566, 'recall': 0.43505672274907475, 'f1-score': 0.43082244079027077, 'support': 274213}, 'weighted avg': {'precision': 0.4428287181004033, 'recall': 0.4423240327774394, 'f1-score': 0.43409280950116186, 'support': 274213}}
[[30107 19788 44807]
 [14830 30191 32217]
 [22217 19063 60993]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0645673
{'0': {'precision': 0.4094204661573646, 'recall': 0.2734511261090468, 'f1-score': 0.32789909198373624, 'support': 92309}, '1': {'precision': 0.44450476787081505, 'recall': 0.39709741204561566, 'f1-score': 0.41946586445620904, 'support': 80411}, '2': {'precision': 0.4314727305027536, 'recall': 0.5982580079414344, 'f1-score': 0.5013582805571841, 'support': 101493}, 'accuracy': 0.42992855918574246, 'macro avg': {'precision': 0.42846598817697773, 'recall': 0.4229355153653656, 'f1-score': 0.41624107899904317, 'support': 274213}, 'weighted avg': {'precision': 0.42787077394834033, 'recall': 0.42992855918574246, 'f1-score': 0.41895192013983734, 'support': 274213}}
[[25242 20169 46898]
 [15372 31931 33108]
 [21039 19735 60719]]
Evaluating performance on  train set...
286/286 - 6s - 6s/epoch - 22ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0379198
{'0': {'precision': 0.44127621597501115, 'recall': 0.427965551564461, 'f1-score': 0.43451897093393677, 'support': 23107}, '1': {'precision': 0.5145659432387312, 'recall': 0.4527227995446701, 'f1-score': 0.48166741546695835, 'support': 27233}, '2': {'precision': 0.4205355133878347, 'recall': 0.49409587592527315, 'f1-score': 0.45435760301446454, 'support': 22696}, 'accuracy': 0.45774686455994307, 'macro avg': {'precision': 0.45879255753385895, 'recall': 0.45826140901146806, 'f1-score': 0.4568479964717866, 'support': 73036}, 'weighted avg': {'precision': 0.4621586322718282, 'recall': 0.45774686455994307, 'f1-score': 0.45826412652388465, 'support': 73036}}
[[ 9889  5946  7272]
 [ 6724 12329  8180]
 [ 5797  5685 11214]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.050768
{'0': {'precision': 0.44946784724085503, 'recall': 0.4123148869836321, 'f1-score': 0.43009050257814674, 'support': 24377}, '1': {'precision': 0.4578225217179508, 'recall': 0.45784110745747575, 'f1-score': 0.4578318143990907, 'support': 24633}, '2': {'precision': 0.4311827956989247, 'recall': 0.4673270623491218, 'f1-score': 0.4485279431150881, 'support': 24026}, 'accuracy': 0.4457664713292075, 'macro avg': {'precision': 0.4461577215525769, 'recall': 0.4458276855967432, 'f1-score': 0.4454834200307752, 'support': 73036}, 'weighted avg': {'precision': 0.44627057532081404, 'recall': 0.4457664713292075, 'f1-score': 0.4455120711255188, 'support': 73036}}
[[10051  6867  7459]
 [ 6002 11278  7353]
 [ 6309  6489 11228]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0645075
{'0': {'precision': 0.4429189742635082, 'recall': 0.38405972558514934, 'f1-score': 0.41139473058551457, 'support': 24780}, '1': {'precision': 0.420943676275291, 'recall': 0.45447644751823896, 'f1-score': 0.437067829260874, 'support': 23713}, '2': {'precision': 0.4276024203183412, 'recall': 0.4520637248910076, 'f1-score': 0.4394929689047336, 'support': 24543}, 'accuracy': 0.42977435785092283, 'macro avg': {'precision': 0.43048835695238014, 'recall': 0.43019996599813193, 'f1-score': 0.4293185095837074, 'support': 73036}, 'weighted avg': {'precision': 0.4306371622164242, 'recall': 0.42977435785092283, 'f1-score': 0.4291722820937762, 'support': 73036}}
[[ 9517  7653  7610]
 [ 5694 10777  7242]
 [ 6276  7172 11095]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0813967
{'0': {'precision': 0.40949050949050947, 'recall': 0.33466688438928804, 'f1-score': 0.3683170096145206, 'support': 24496}, '1': {'precision': 0.40076992076543577, 'recall': 0.4410216336267171, 'f1-score': 0.4199334247111807, 'support': 24314}, '2': {'precision': 0.4097867479055598, 'recall': 0.4441921902088665, 'f1-score': 0.42629639900170346, 'support': 24226}, 'accuracy': 0.40640232214250505, 'macro avg': {'precision': 0.4066823927205017, 'recall': 0.4066269027416239, 'f1-score': 0.4048489444424683, 'support': 73036}, 'weighted avg': {'precision': 0.40668564993606465, 'recall': 0.40640232214250505, 'f1-score': 0.40473206799605965, 'support': 73036}}
[[ 8198  8219  8079]
 [ 6171 10723  7420]
 [ 5651  7814 10761]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0721458
{'0': {'precision': 0.4334646862685662, 'recall': 0.3107007061379685, 'f1-score': 0.36195659052078716, 'support': 9205}, '1': {'precision': 0.5607638888888888, 'recall': 0.2805524190046035, 'f1-score': 0.3739940948300816, 'support': 11513}, '2': {'precision': 0.37046587588103835, 'recall': 0.7111428885711143, 'f1-score': 0.48715243764599503, 'support': 9091}, 'accuracy': 0.42118152235901907, 'macro avg': {'precision': 0.4548981503461645, 'recall': 0.43413200457122875, 'f1-score': 0.4077010409989546, 'support': 29809}, 'weighted avg': {'precision': 0.463417839159799, 'recall': 0.42118152235901907, 'f1-score': 0.40478738770714606, 'support': 29809}}
[[2860 1302 5043]
 [2340 3230 5943]
 [1398 1228 6465]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0694017
{'0': {'precision': 0.4362303345043531, 'recall': 0.29211414544338754, 'f1-score': 0.34991423670668953, 'support': 9777}, '1': {'precision': 0.5107288828337875, 'recall': 0.2896185417672622, 'f1-score': 0.3696308621433414, 'support': 10355}, '2': {'precision': 0.3860264519838988, 'recall': 0.693706727291516, 'f1-score': 0.4960283740348025, 'support': 9677}, 'accuracy': 0.4216176322587138, 'macro avg': {'precision': 0.4443285564406798, 'recall': 0.4251464715007219, 'f1-score': 0.40519115762827784, 'support': 29809}, 'weighted avg': {'precision': 0.44581165211986706, 'recall': 0.4216176322587138, 'f1-score': 0.4041969084944274, 'support': 29809}}
[[2856 1478 5443]
 [2122 2999 5234]
 [1569 1395 6713]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0739064
{'0': {'precision': 0.43546053689117503, 'recall': 0.2746907321030217, 'f1-score': 0.33687744823726923, 'support': 9862}, '1': {'precision': 0.4700854700854701, 'recall': 0.28804512035451707, 'f1-score': 0.3572097670642603, 'support': 9929}, '2': {'precision': 0.3897966179159049, 'recall': 0.681074066679976, 'f1-score': 0.4958215245985029, 'support': 10018}, 'accuracy': 0.4157133751551545, 'macro avg': {'precision': 0.4317808749641833, 'recall': 0.4146033063791716, 'f1-score': 0.3966362466333441, 'support': 29809}, 'weighted avg': {'precision': 0.43164725303032436, 'recall': 0.4157133751551545, 'f1-score': 0.397066698149042, 'support': 29809}}
[[2709 1625 5528]
 [1916 2860 5153]
 [1596 1599 6823]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0806161
{'0': {'precision': 0.39403564496206106, 'recall': 0.2342143906020558, 'f1-score': 0.29379646075916055, 'support': 9534}, '1': {'precision': 0.47736497034030595, 'recall': 0.29869115061535456, 'f1-score': 0.36745974525354486, 'support': 10238}, '2': {'precision': 0.385148849797023, 'recall': 0.6805818471654876, 'f1-score': 0.49191660965686096, 'support': 10037}, 'accuracy': 0.4066557080076487, 'macro avg': {'precision': 0.4188498216997967, 'recall': 0.4044957961276327, 'f1-score': 0.3843909385565221, 'support': 29809}, 'weighted avg': {'precision': 0.41966310211094177, 'recall': 0.4066557080076487, 'f1-score': 0.38580547284073746, 'support': 29809}}
[[2233 1639 5662]
 [1937 3058 5243]
 [1497 1709 6831]]
training model: results/XRAY/W2/deepOF_L2/seq2seq
Epoch 1/50
286/286 - 16s - loss: 13.0383 - accuracy10: 0.4037 - accuracy20: 0.3940 - accuracy30: 0.3856 - accuracy50: 0.3732 - val_loss: 12.8679 - val_accuracy10: 0.4483 - val_accuracy20: 0.4146 - val_accuracy30: 0.3954 - val_accuracy50: 0.3793 - 16s/epoch - 55ms/step
Epoch 2/50
286/286 - 10s - loss: 12.7134 - accuracy10: 0.4467 - accuracy20: 0.4332 - accuracy30: 0.4198 - accuracy50: 0.4051 - val_loss: 12.7321 - val_accuracy10: 0.4705 - val_accuracy20: 0.4292 - val_accuracy30: 0.4045 - val_accuracy50: 0.3804 - 10s/epoch - 35ms/step
Epoch 3/50
286/286 - 10s - loss: 12.5741 - accuracy10: 0.4648 - accuracy20: 0.4485 - accuracy30: 0.4324 - accuracy50: 0.4130 - val_loss: 12.6331 - val_accuracy10: 0.4774 - val_accuracy20: 0.4413 - val_accuracy30: 0.4168 - val_accuracy50: 0.3889 - 10s/epoch - 36ms/step
Epoch 4/50
286/286 - 10s - loss: 12.4783 - accuracy10: 0.4824 - accuracy20: 0.4599 - accuracy30: 0.4431 - accuracy50: 0.4199 - val_loss: 12.5682 - val_accuracy10: 0.4861 - val_accuracy20: 0.4535 - val_accuracy30: 0.4279 - val_accuracy50: 0.3949 - 10s/epoch - 35ms/step
Epoch 5/50
286/286 - 10s - loss: 12.3715 - accuracy10: 0.4985 - accuracy20: 0.4742 - accuracy30: 0.4545 - accuracy50: 0.4240 - val_loss: 12.4939 - val_accuracy10: 0.4912 - val_accuracy20: 0.4611 - val_accuracy30: 0.4357 - val_accuracy50: 0.4012 - 10s/epoch - 35ms/step
Epoch 6/50
286/286 - 10s - loss: 12.2779 - accuracy10: 0.5061 - accuracy20: 0.4847 - accuracy30: 0.4632 - accuracy50: 0.4304 - val_loss: 12.4818 - val_accuracy10: 0.4912 - val_accuracy20: 0.4649 - val_accuracy30: 0.4371 - val_accuracy50: 0.4034 - 10s/epoch - 35ms/step
Epoch 7/50
286/286 - 10s - loss: 12.2092 - accuracy10: 0.5130 - accuracy20: 0.4914 - accuracy30: 0.4718 - accuracy50: 0.4344 - val_loss: 12.5042 - val_accuracy10: 0.4948 - val_accuracy20: 0.4660 - val_accuracy30: 0.4410 - val_accuracy50: 0.4016 - 10s/epoch - 35ms/step
Epoch 8/50
286/286 - 10s - loss: 12.1556 - accuracy10: 0.5169 - accuracy20: 0.4972 - accuracy30: 0.4769 - accuracy50: 0.4385 - val_loss: 12.4677 - val_accuracy10: 0.4938 - val_accuracy20: 0.4699 - val_accuracy30: 0.4444 - val_accuracy50: 0.4052 - 10s/epoch - 35ms/step
Epoch 9/50
286/286 - 10s - loss: 12.1206 - accuracy10: 0.5187 - accuracy20: 0.5013 - accuracy30: 0.4795 - accuracy50: 0.4392 - val_loss: 12.4851 - val_accuracy10: 0.4918 - val_accuracy20: 0.4683 - val_accuracy30: 0.4410 - val_accuracy50: 0.4045 - 10s/epoch - 35ms/step
Epoch 10/50
286/286 - 10s - loss: 12.0749 - accuracy10: 0.5233 - accuracy20: 0.5039 - accuracy30: 0.4830 - accuracy50: 0.4444 - val_loss: 12.4729 - val_accuracy10: 0.4945 - val_accuracy20: 0.4682 - val_accuracy30: 0.4404 - val_accuracy50: 0.4047 - 10s/epoch - 36ms/step
Epoch 11/50
286/286 - 10s - loss: 12.0304 - accuracy10: 0.5254 - accuracy20: 0.5089 - accuracy30: 0.4878 - accuracy50: 0.4471 - val_loss: 12.4880 - val_accuracy10: 0.4963 - val_accuracy20: 0.4692 - val_accuracy30: 0.4402 - val_accuracy50: 0.4043 - 10s/epoch - 35ms/step
Epoch 12/50
286/286 - 10s - loss: 11.9923 - accuracy10: 0.5285 - accuracy20: 0.5106 - accuracy30: 0.4902 - accuracy50: 0.4494 - val_loss: 12.5075 - val_accuracy10: 0.4912 - val_accuracy20: 0.4676 - val_accuracy30: 0.4439 - val_accuracy50: 0.4069 - 10s/epoch - 36ms/step
Epoch 13/50
286/286 - 10s - loss: 11.9582 - accuracy10: 0.5301 - accuracy20: 0.5127 - accuracy30: 0.4933 - accuracy50: 0.4522 - val_loss: 12.5208 - val_accuracy10: 0.4904 - val_accuracy20: 0.4654 - val_accuracy30: 0.4406 - val_accuracy50: 0.4059 - 10s/epoch - 35ms/step
Epoch 14/50
286/286 - 10s - loss: 11.9114 - accuracy10: 0.5340 - accuracy20: 0.5167 - accuracy30: 0.4976 - accuracy50: 0.4567 - val_loss: 12.5274 - val_accuracy10: 0.4896 - val_accuracy20: 0.4662 - val_accuracy30: 0.4398 - val_accuracy50: 0.4055 - 10s/epoch - 35ms/step
Epoch 15/50
286/286 - 10s - loss: 11.8763 - accuracy10: 0.5363 - accuracy20: 0.5198 - accuracy30: 0.4991 - accuracy50: 0.4590 - val_loss: 12.5765 - val_accuracy10: 0.4875 - val_accuracy20: 0.4637 - val_accuracy30: 0.4386 - val_accuracy50: 0.4051 - 10s/epoch - 35ms/step
Epoch 16/50
286/286 - 10s - loss: 11.8398 - accuracy10: 0.5387 - accuracy20: 0.5240 - accuracy30: 0.5039 - accuracy50: 0.4628 - val_loss: 12.6630 - val_accuracy10: 0.4864 - val_accuracy20: 0.4605 - val_accuracy30: 0.4351 - val_accuracy50: 0.4054 - 10s/epoch - 35ms/step
Epoch 17/50
286/286 - 10s - loss: 11.8029 - accuracy10: 0.5407 - accuracy20: 0.5261 - accuracy30: 0.5080 - accuracy50: 0.4669 - val_loss: 12.6609 - val_accuracy10: 0.4878 - val_accuracy20: 0.4609 - val_accuracy30: 0.4348 - val_accuracy50: 0.4045 - 10s/epoch - 35ms/step
Epoch 18/50
286/286 - 10s - loss: 11.7597 - accuracy10: 0.5444 - accuracy20: 0.5281 - accuracy30: 0.5102 - accuracy50: 0.4697 - val_loss: 12.7007 - val_accuracy10: 0.4877 - val_accuracy20: 0.4616 - val_accuracy30: 0.4315 - val_accuracy50: 0.3992 - 10s/epoch - 35ms/step
testing model: results/XRAY/W2/deepOF_L2/seq2seq
Evaluating performance on  test set...
1072/1072 - 16s - 16s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0038817
{'0': {'precision': 0.5265501293407541, 'recall': 0.3636698320574318, 'f1-score': 0.43020917393587726, 'support': 92353}, '1': {'precision': 0.5207978222708424, 'recall': 0.482869240113694, 'f1-score': 0.5011168705592921, 'support': 84789}, '2': {'precision': 0.4672366833827736, 'recall': 0.6344755115076339, 'f1-score': 0.5381627525942109, 'support': 97066}, 'accuracy': 0.4963896020539153, 'macro avg': {'precision': 0.5048615449981234, 'recall': 0.49367152789291985, 'f1-score': 0.48982959902979345, 'support': 274208}, 'weighted avg': {'precision': 0.5037752602285908, 'recall': 0.4963896020539153, 'f1-score': 0.49034897567416547, 'support': 274208}}
[[33586 18369 40398]
 [14022 40942 29825]
 [16177 19303 61586]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0345877
{'0': {'precision': 0.5187204773348802, 'recall': 0.3288674526616649, 'f1-score': 0.40253117343296824, 'support': 95166}, '1': {'precision': 0.4424789281595872, 'recall': 0.4781050495189405, 'f1-score': 0.4596026326512972, 'support': 77849}, '2': {'precision': 0.465851290113752, 'recall': 0.5973436897809137, 'f1-score': 0.5234662198147644, 'support': 101193}, 'accuracy': 0.4703145057766367, 'macro avg': {'precision': 0.4756835652027398, 'recall': 0.4681053973205063, 'f1-score': 0.46186667529967657, 'support': 274208}, 'weighted avg': {'precision': 0.4775644205305018, 'recall': 0.4703145057766367, 'f1-score': 0.4633635932646317, 'support': 274208}}
[[31297 22306 41563]
 [12883 37220 27746]
 [16155 24591 60447]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0596788
{'0': {'precision': 0.49875529464219365, 'recall': 0.28349824179769584, 'f1-score': 0.36151002847967034, 'support': 94699}, '1': {'precision': 0.38529831367839806, 'recall': 0.4860364851042894, 'f1-score': 0.42984404699200773, 'support': 77237}, '2': {'precision': 0.4627365818347445, 'recall': 0.5562910669586983, 'f1-score': 0.505219317914404, 'support': 102272}, 'accuracy': 0.4422919827284397, 'macro avg': {'precision': 0.44893006338511204, 'recall': 0.44194193128689446, 'f1-score': 0.43219113112869406, 'support': 274208}, 'weighted avg': {'precision': 0.45336353862142065, 'recall': 0.4422919827284397, 'f1-score': 0.4343574692432749, 'support': 274208}}
[[26847 28781 39071]
 [12712 37540 26985]
 [14269 31110 56893]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0858662
{'0': {'precision': 0.4570326761591822, 'recall': 0.21698011006629978, 'f1-score': 0.29425851379543383, 'support': 92308}, '1': {'precision': 0.34057234166182454, 'recall': 0.5248227832359159, 'f1-score': 0.41308327052397686, 'support': 80410}, '2': {'precision': 0.44757307085430914, 'recall': 0.46954379741846486, 'f1-score': 0.4582952654811937, 'support': 101490}, 'accuracy': 0.40073229081573114, 'macro avg': {'precision': 0.415059362891772, 'recall': 0.4037822302402268, 'f1-score': 0.3885456832668681, 'support': 274208}, 'weighted avg': {'precision': 0.4193801246678905, 'recall': 0.40073229081573114, 'f1-score': 0.3898165887499571, 'support': 274208}}
[[20029 39445 32834]
 [12225 42201 25984]
 [11570 42266 47654]]
Evaluating performance on  train set...
286/286 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.97979254
{'0': {'precision': 0.5265867148567986, 'recall': 0.41698105025801135, 'f1-score': 0.4654179371763225, 'support': 23061}, '1': {'precision': 0.5796684082774509, 'recall': 0.5155695415126789, 'f1-score': 0.5457432798822527, 'support': 27329}, '2': {'precision': 0.4503856884949943, 'recall': 0.6059709402464338, 'f1-score': 0.5167206447239587, 'support': 22643}, 'accuracy': 0.5124669669875261, 'macro avg': {'precision': 0.5188802705430812, 'recall': 0.5128405106723747, 'f1-score': 0.5092939539275113, 'support': 73033}, 'weighted avg': {'precision': 0.522824713563995, 'recall': 0.5124669669875261, 'f1-score': 0.511381522101103, 'support': 73033}}
[[ 9616  5025  8420]
 [ 4915 14090  8324]
 [ 3730  5192 13721]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0073141
{'0': {'precision': 0.5368295994568907, 'recall': 0.38999630101516586, 'f1-score': 0.4517818458828291, 'support': 24331}, '1': {'precision': 0.5014319809069212, 'recall': 0.5100546226987659, 'f1-score': 0.505706548992077, 'support': 24715}, '2': {'precision': 0.4550418638514743, 'recall': 0.5732271647142202, 'f1-score': 0.5073426315401077, 'support': 23987}, 'accuracy': 0.4908055262689469, 'macro avg': {'precision': 0.4977678147384288, 'recall': 0.49109269614271733, 'f1-score': 0.48827700880500463, 'support': 73033}, 'weighted avg': {'precision': 0.4979883282996108, 'recall': 0.4908055262689469, 'f1-score': 0.48827884864741783, 'support': 73033}}
[[ 9489  6172  8670]
 [ 4312 12606  7797]
 [ 3875  6362 13750]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0350524
{'0': {'precision': 0.5238992945755291, 'recall': 0.34768746468641537, 'f1-score': 0.41798068992285675, 'support': 24778}, '1': {'precision': 0.43790613718411553, 'recall': 0.5127879940815895, 'f1-score': 0.4723980138253335, 'support': 23655}, '2': {'precision': 0.4551559417079165, 'recall': 0.5345121951219513, 'f1-score': 0.4916524892968648, 'support': 24600}, 'accuracy': 0.4640915750414196, 'macro avg': {'precision': 0.47232045782252036, 'recall': 0.4649958846299853, 'f1-score': 0.4606770643483517, 'support': 73033}, 'weighted avg': {'precision': 0.47289146772140617, 'recall': 0.4640915750414196, 'f1-score': 0.4604213408821995, 'support': 73033}}
[[ 8615  7853  8310]
 [ 4095 12130  7430]
 [ 3734  7717 13149]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0697459
{'0': {'precision': 0.4762659317946951, 'recall': 0.2823937908496732, 'f1-score': 0.35455827670214124, 'support': 24480}, '1': {'precision': 0.3840954758570298, 'recall': 0.5187713310580204, 'f1-score': 0.4413889617773113, 'support': 24319}, '2': {'precision': 0.428599252103459, 'recall': 0.45403152595526947, 'f1-score': 0.44094898409008937, 'support': 24234}, 'accuracy': 0.41805759040433776, 'macro avg': {'precision': 0.429653553251728, 'recall': 0.4183988826209877, 'f1-score': 0.41229874085651397, 'support': 73033}, 'weighted avg': {'precision': 0.42975753649961623, 'recall': 0.41805759040433776, 'f1-score': 0.41213810819177743, 'support': 73033}}
[[ 6913 10344  7223]
 [ 4257 12616  7446]
 [ 3345  9886 11003]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.99922645
{'0': {'precision': 0.48732764281024293, 'recall': 0.4025819049685398, 'f1-score': 0.44091962217073605, 'support': 9218}, '1': {'precision': 0.5736482287134866, 'recall': 0.48464163822525597, 'f1-score': 0.525402020777003, 'support': 11427}, '2': {'precision': 0.43277511961722487, 'recall': 0.5922086425141859, 'f1-score': 0.5000921489126429, 'support': 9164}, 'accuracy': 0.4923345298399812, 'macro avg': {'precision': 0.49791699704698483, 'recall': 0.4931440619026606, 'f1-score': 0.488804597286794, 'support': 29809}, 'weighted avg': {'precision': 0.5036470769601825, 'recall': 0.4923345298399812, 'f1-score': 0.4914962065558763, 'support': 29809}}
[[3711 2062 3445]
 [2221 5538 3668]
 [1683 2054 5427]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0278207
{'0': {'precision': 0.4887145609688962, 'recall': 0.3644293924466338, 'f1-score': 0.4175191064079952, 'support': 9744}, '1': {'precision': 0.49646660694734746, 'recall': 0.48422483254053006, 'f1-score': 0.49026931393748774, 'support': 10301}, '2': {'precision': 0.43653969270166454, 'recall': 0.5586849651782057, 'f1-score': 0.49011680143755615, 'support': 9764}, 'accuracy': 0.4694555335636888, 'macro avg': {'precision': 0.47390695353930273, 'recall': 0.46911306338845654, 'f1-score': 0.465968407261013, 'support': 29809}, 'weighted avg': {'precision': 0.47430342379095586, 'recall': 0.4694555335636888, 'f1-score': 0.4664386871396513, 'support': 29809}}
[[3551 2516 3677]
 [1949 4988 3364]
 [1766 2543 5455]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0526795
{'0': {'precision': 0.4790794979079498, 'recall': 0.32505322924059615, 'f1-score': 0.38731501057082457, 'support': 9863}, '1': {'precision': 0.43405901403382513, 'recall': 0.4853148259907463, 'f1-score': 0.4582581441732358, 'support': 9942}, '2': {'precision': 0.4309640863261395, 'recall': 0.5169932027189125, 'f1-score': 0.47007498295841854, 'support': 10004}, 'accuracy': 0.442919923513033, 'macro avg': {'precision': 0.44803419942263817, 'recall': 0.44245375265008496, 'f1-score': 0.43854937923415965, 'support': 29809}, 'weighted avg': {'precision': 0.44791641869895327, 'recall': 0.442919923513033, 'f1-score': 0.43875073126057135, 'support': 29809}}
[[3206 3133 3524]
 [1812 4825 3305]
 [1674 3158 5172]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0809551
{'0': {'precision': 0.4342196132596685, 'recall': 0.2636821136506605, 'f1-score': 0.32811480756686234, 'support': 9538}, '1': {'precision': 0.3870122088233091, 'recall': 0.5052312506111274, 'f1-score': 0.43828993129188226, 'support': 10227}, '2': {'precision': 0.41027564222763924, 'recall': 0.4356829948227798, 'f1-score': 0.4225977788507967, 'support': 10044}, 'accuracy': 0.4045087054245362, 'macro avg': {'precision': 0.4105024881035389, 'recall': 0.40153211969485586, 'f1-score': 0.3963341725698471, 'support': 29809}, 'weighted avg': {'precision': 0.40995568725690595, 'recall': 0.4045087054245362, 'f1-score': 0.3977497484877794, 'support': 29809}}
[[2515 3990 3033]
 [1803 5167 3257]
 [1474 4194 4376]]
training model: results/XRAY/W2/deepVOL_L2/seq2seq
Epoch 1/50
286/286 - 15s - loss: 13.1650 - accuracy10: 0.3867 - accuracy20: 0.3827 - accuracy30: 0.3755 - accuracy50: 0.3667 - val_loss: 13.2081 - val_accuracy10: 0.4112 - val_accuracy20: 0.3797 - val_accuracy30: 0.3621 - val_accuracy50: 0.3653 - 15s/epoch - 54ms/step
Epoch 2/50
286/286 - 10s - loss: 12.8618 - accuracy10: 0.4252 - accuracy20: 0.4191 - accuracy30: 0.4080 - accuracy50: 0.3860 - val_loss: 12.8352 - val_accuracy10: 0.4561 - val_accuracy20: 0.4369 - val_accuracy30: 0.4107 - val_accuracy50: 0.3869 - 10s/epoch - 34ms/step
Epoch 3/50
286/286 - 10s - loss: 12.6563 - accuracy10: 0.4615 - accuracy20: 0.4483 - accuracy30: 0.4296 - accuracy50: 0.3971 - val_loss: 12.8401 - val_accuracy10: 0.4629 - val_accuracy20: 0.4319 - val_accuracy30: 0.3938 - val_accuracy50: 0.3658 - 10s/epoch - 34ms/step
Epoch 4/50
286/286 - 10s - loss: 12.5514 - accuracy10: 0.4804 - accuracy20: 0.4642 - accuracy30: 0.4435 - accuracy50: 0.4050 - val_loss: 12.6855 - val_accuracy10: 0.4629 - val_accuracy20: 0.4457 - val_accuracy30: 0.4221 - val_accuracy50: 0.3850 - 10s/epoch - 34ms/step
Epoch 5/50
286/286 - 10s - loss: 12.4826 - accuracy10: 0.4909 - accuracy20: 0.4702 - accuracy30: 0.4477 - accuracy50: 0.4100 - val_loss: 12.6461 - val_accuracy10: 0.4642 - val_accuracy20: 0.4513 - val_accuracy30: 0.4332 - val_accuracy50: 0.3919 - 10s/epoch - 34ms/step
Epoch 6/50
286/286 - 10s - loss: 12.4302 - accuracy10: 0.4978 - accuracy20: 0.4779 - accuracy30: 0.4552 - accuracy50: 0.4165 - val_loss: 12.5519 - val_accuracy10: 0.4751 - val_accuracy20: 0.4611 - val_accuracy30: 0.4396 - val_accuracy50: 0.3959 - 10s/epoch - 35ms/step
Epoch 7/50
286/286 - 10s - loss: 12.3844 - accuracy10: 0.5010 - accuracy20: 0.4818 - accuracy30: 0.4589 - accuracy50: 0.4176 - val_loss: 12.5765 - val_accuracy10: 0.4792 - val_accuracy20: 0.4623 - val_accuracy30: 0.4373 - val_accuracy50: 0.3952 - 10s/epoch - 35ms/step
Epoch 8/50
286/286 - 10s - loss: 12.3520 - accuracy10: 0.5064 - accuracy20: 0.4850 - accuracy30: 0.4623 - accuracy50: 0.4207 - val_loss: 12.5753 - val_accuracy10: 0.4776 - val_accuracy20: 0.4611 - val_accuracy30: 0.4407 - val_accuracy50: 0.3975 - 10s/epoch - 34ms/step
Epoch 9/50
286/286 - 10s - loss: 12.3127 - accuracy10: 0.5094 - accuracy20: 0.4880 - accuracy30: 0.4637 - accuracy50: 0.4237 - val_loss: 12.5322 - val_accuracy10: 0.4807 - val_accuracy20: 0.4633 - val_accuracy30: 0.4408 - val_accuracy50: 0.3993 - 10s/epoch - 35ms/step
Epoch 10/50
286/286 - 10s - loss: 12.2811 - accuracy10: 0.5131 - accuracy20: 0.4928 - accuracy30: 0.4676 - accuracy50: 0.4261 - val_loss: 12.5442 - val_accuracy10: 0.4842 - val_accuracy20: 0.4642 - val_accuracy30: 0.4380 - val_accuracy50: 0.3984 - 10s/epoch - 34ms/step
Epoch 11/50
286/286 - 10s - loss: 12.2517 - accuracy10: 0.5147 - accuracy20: 0.4935 - accuracy30: 0.4699 - accuracy50: 0.4312 - val_loss: 12.5326 - val_accuracy10: 0.4853 - val_accuracy20: 0.4641 - val_accuracy30: 0.4402 - val_accuracy50: 0.3986 - 10s/epoch - 34ms/step
Epoch 12/50
286/286 - 10s - loss: 12.2178 - accuracy10: 0.5173 - accuracy20: 0.4971 - accuracy30: 0.4728 - accuracy50: 0.4315 - val_loss: 12.5089 - val_accuracy10: 0.4903 - val_accuracy20: 0.4683 - val_accuracy30: 0.4425 - val_accuracy50: 0.4045 - 10s/epoch - 34ms/step
Epoch 13/50
286/286 - 10s - loss: 12.1844 - accuracy10: 0.5188 - accuracy20: 0.5005 - accuracy30: 0.4754 - accuracy50: 0.4355 - val_loss: 12.5641 - val_accuracy10: 0.4864 - val_accuracy20: 0.4649 - val_accuracy30: 0.4383 - val_accuracy50: 0.4019 - 10s/epoch - 35ms/step
Epoch 14/50
286/286 - 10s - loss: 12.1587 - accuracy10: 0.5212 - accuracy20: 0.5020 - accuracy30: 0.4785 - accuracy50: 0.4391 - val_loss: 12.5120 - val_accuracy10: 0.4945 - val_accuracy20: 0.4671 - val_accuracy30: 0.4440 - val_accuracy50: 0.4003 - 10s/epoch - 35ms/step
Epoch 15/50
286/286 - 10s - loss: 12.1312 - accuracy10: 0.5239 - accuracy20: 0.5046 - accuracy30: 0.4789 - accuracy50: 0.4381 - val_loss: 12.5109 - val_accuracy10: 0.4953 - val_accuracy20: 0.4700 - val_accuracy30: 0.4394 - val_accuracy50: 0.4010 - 10s/epoch - 35ms/step
Epoch 16/50
286/286 - 10s - loss: 12.1016 - accuracy10: 0.5251 - accuracy20: 0.5041 - accuracy30: 0.4795 - accuracy50: 0.4396 - val_loss: 12.5218 - val_accuracy10: 0.4938 - val_accuracy20: 0.4670 - val_accuracy30: 0.4417 - val_accuracy50: 0.4024 - 10s/epoch - 35ms/step
Epoch 17/50
286/286 - 10s - loss: 12.0842 - accuracy10: 0.5264 - accuracy20: 0.5078 - accuracy30: 0.4837 - accuracy50: 0.4422 - val_loss: 12.5131 - val_accuracy10: 0.4970 - val_accuracy20: 0.4724 - val_accuracy30: 0.4427 - val_accuracy50: 0.4030 - 10s/epoch - 35ms/step
Epoch 18/50
286/286 - 10s - loss: 12.0571 - accuracy10: 0.5273 - accuracy20: 0.5086 - accuracy30: 0.4859 - accuracy50: 0.4454 - val_loss: 12.5586 - val_accuracy10: 0.4946 - val_accuracy20: 0.4692 - val_accuracy30: 0.4410 - val_accuracy50: 0.4004 - 10s/epoch - 34ms/step
Epoch 19/50
286/286 - 10s - loss: 12.0223 - accuracy10: 0.5303 - accuracy20: 0.5130 - accuracy30: 0.4894 - accuracy50: 0.4485 - val_loss: 12.5534 - val_accuracy10: 0.4917 - val_accuracy20: 0.4664 - val_accuracy30: 0.4379 - val_accuracy50: 0.4003 - 10s/epoch - 35ms/step
Epoch 20/50
286/286 - 10s - loss: 12.0081 - accuracy10: 0.5313 - accuracy20: 0.5113 - accuracy30: 0.4887 - accuracy50: 0.4492 - val_loss: 12.5411 - val_accuracy10: 0.4909 - val_accuracy20: 0.4704 - val_accuracy30: 0.4421 - val_accuracy50: 0.4047 - 10s/epoch - 34ms/step
Epoch 21/50
286/286 - 10s - loss: 11.9752 - accuracy10: 0.5343 - accuracy20: 0.5151 - accuracy30: 0.4927 - accuracy50: 0.4521 - val_loss: 12.5625 - val_accuracy10: 0.4950 - val_accuracy20: 0.4694 - val_accuracy30: 0.4416 - val_accuracy50: 0.3944 - 10s/epoch - 35ms/step
Epoch 22/50
286/286 - 10s - loss: 11.9563 - accuracy10: 0.5341 - accuracy20: 0.5164 - accuracy30: 0.4941 - accuracy50: 0.4527 - val_loss: 12.6063 - val_accuracy10: 0.4863 - val_accuracy20: 0.4648 - val_accuracy30: 0.4317 - val_accuracy50: 0.3952 - 10s/epoch - 35ms/step
testing model: results/XRAY/W2/deepVOL_L2/seq2seq
Evaluating performance on  test set...
1072/1072 - 15s - 15s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0146469
{'0': {'precision': 0.5048089916220212, 'recall': 0.34382545612040494, 'f1-score': 0.4090481649898878, 'support': 92355}, '1': {'precision': 0.5421780869251687, 'recall': 0.425628022172426, 'f1-score': 0.47688516250090845, 'support': 84790}, '2': {'precision': 0.45198173364560235, 'recall': 0.6739914286891664, 'f1-score': 0.5410996009345987, 'support': 97068}, 'accuracy': 0.4859944641574251, 'macro avg': {'precision': 0.4996562707309307, 'recall': 0.48114830232733247, 'f1-score': 0.475677642808465, 'support': 274213}, 'weighted avg': {'precision': 0.4976637771847, 'recall': 0.4859944641574251, 'f1-score': 0.4767687610347166, 'support': 274213}}
[[31754 15794 44807]
 [14184 36089 34517]
 [16965 14680 65423]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.030947
{'0': {'precision': 0.49063716896535675, 'recall': 0.33230707800941495, 'f1-score': 0.39624119028974164, 'support': 95168}, '1': {'precision': 0.48289022997879627, 'recall': 0.38029543994861914, 'f1-score': 0.42549583213567116, 'support': 77850}, '2': {'precision': 0.45360602508656345, 'recall': 0.6654083699787539, 'f1-score': 0.5394626683918106, 'support': 101195}, 'accuracy': 0.46885815041591755, 'macro avg': {'precision': 0.4757111413435722, 'recall': 0.4593369626455959, 'f1-score': 0.4537332302724078, 'support': 274213}, 'weighted avg': {'precision': 0.4747718897666382, 'recall': 0.46885815041591755, 'f1-score': 0.45740084116057733, 'support': 274213}}
[[31625 16282 47261]
 [14395 29606 33849]
 [18437 15422 67336]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0511053
{'0': {'precision': 0.4631460297634461, 'recall': 0.3210703047454119, 'f1-score': 0.379238305488516, 'support': 94702}, '1': {'precision': 0.44050898363219537, 'recall': 0.32091716512597424, 'f1-score': 0.37132135393649773, 'support': 77238}, '2': {'precision': 0.44418325202077574, 'recall': 0.6614257917534442, 'f1-score': 0.5314613891878727, 'support': 102273}, 'accuracy': 0.44796927935582925, 'macro avg': {'precision': 0.44927942180547237, 'recall': 0.4344710872082767, 'f1-score': 0.42734034953762884, 'support': 274213}, 'weighted avg': {'precision': 0.44969728613290455, 'recall': 0.44796927935582925, 'f1-score': 0.4337828454454455, 'support': 274213}}
[[30406 16215 48081]
 [15885 24787 36566]
 [19360 15267 67646]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0725064
{'0': {'precision': 0.41978334165834164, 'recall': 0.2913367060633308, 'f1-score': 0.34395963497534743, 'support': 92309}, '1': {'precision': 0.39182794964213113, 'recall': 0.28525947942445684, 'f1-score': 0.3301571765789625, 'support': 80411}, '2': {'precision': 0.42737850245369635, 'recall': 0.6384085601962697, 'f1-score': 0.5120011378856663, 'support': 101493}, 'accuracy': 0.41801446320925706, 'macro avg': {'precision': 0.4129965979180564, 'recall': 0.40500158189468577, 'f1-score': 0.3953726498133254, 'support': 274213}, 'weighted avg': {'precision': 0.41439677948655335, 'recall': 0.41801446320925706, 'f1-score': 0.40210847099977104, 'support': 274213}}
[[26893 18375 47041]
 [17700 22938 39773]
 [19471 17228 64794]]
Evaluating performance on  train set...
286/286 - 4s - 4s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.99171567
{'0': {'precision': 0.5134015738713685, 'recall': 0.3755139135326957, 'f1-score': 0.43376324735052985, 'support': 23107}, '1': {'precision': 0.5823881789137381, 'recall': 0.5354900304777293, 'f1-score': 0.557955349798175, 'support': 27233}, '2': {'precision': 0.44637401511497027, 'recall': 0.611561508635883, 'f1-score': 0.5160714617686973, 'support': 22696}, 'accuracy': 0.5085163481023057, 'macro avg': {'precision': 0.5140545893000256, 'recall': 0.5075218175487693, 'f1-score': 0.5025966863058007, 'support': 73036}, 'weighted avg': {'precision': 0.5182958005757833, 'recall': 0.5085163481023057, 'f1-score': 0.5056482186029457, 'support': 73036}}
[[ 8677  5507  8923]
 [ 4358 14583  8292]
 [ 3866  4950 13880]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0167873
{'0': {'precision': 0.5073499971400789, 'recall': 0.3638675800959921, 'f1-score': 0.42379359770664116, 'support': 24377}, '1': {'precision': 0.5124216985554182, 'recall': 0.4881662810051557, 'f1-score': 0.5, 'support': 24633}, '2': {'precision': 0.4473290531696067, 'recall': 0.5973944893032548, 'f1-score': 0.5115839749073282, 'support': 24026}, 'accuracy': 0.482611314967961, 'macro avg': {'precision': 0.4890335829550347, 'recall': 0.48314278346813416, 'f1-score': 0.47845919087132316, 'support': 73036}, 'weighted avg': {'precision': 0.48931598680448396, 'recall': 0.482611314967961, 'f1-score': 0.47837550129276324, 'support': 73036}}
[[ 8870  6020  9487]
 [ 4362 12025  8246]
 [ 4251  5422 14353]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0420861
{'0': {'precision': 0.4868092196612052, 'recall': 0.3537126715092817, 'f1-score': 0.4097230337735188, 'support': 24780}, '1': {'precision': 0.4612198452435139, 'recall': 0.42731834858516426, 'f1-score': 0.443622354048552, 'support': 23713}, '2': {'precision': 0.4380690239254711, 'recall': 0.5901071588640345, 'f1-score': 0.5028470245121867, 'support': 24543}, 'accuracy': 0.4570485787830659, 'macro avg': {'precision': 0.4620326962767301, 'recall': 0.4570460596528268, 'f1-score': 0.4520641374447525, 'support': 73036}, 'weighted avg': {'precision': 0.46212233292714483, 'recall': 0.4570485787830659, 'f1-score': 0.4520226762290337, 'support': 73036}}
[[ 8765  6280  9735]
 [ 4737 10133  8843]
 [ 4503  5557 14483]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0694952
{'0': {'precision': 0.43944558054987504, 'recall': 0.3158066623122142, 'f1-score': 0.36750593824228023, 'support': 24496}, '1': {'precision': 0.406807131280389, 'recall': 0.38196101011762773, 'f1-score': 0.39399274547652885, 'support': 24314}, '2': {'precision': 0.41125049842039074, 'recall': 0.5534549657392883, 'f1-score': 0.4718717556177303, 'support': 24226}, 'accuracy': 0.4166575387480147, 'macro avg': {'precision': 0.4191677367502183, 'recall': 0.4170742127230434, 'f1-score': 0.4111234797788465, 'support': 73036}, 'weighted avg': {'precision': 0.4192278069148571, 'recall': 0.4166575387480147, 'f1-score': 0.41094159357432436, 'support': 73036}}
[[ 7736  7219  9541]
 [ 5373  9287  9654]
 [ 4495  6323 13408]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0123342
{'0': {'precision': 0.47586206896551725, 'recall': 0.3673003802281369, 'f1-score': 0.4145922746781116, 'support': 9205}, '1': {'precision': 0.5854410857495373, 'recall': 0.49457135412142794, 'f1-score': 0.5361834361316447, 'support': 11513}, '2': {'precision': 0.4252581291416243, 'recall': 0.6070839291607084, 'f1-score': 0.5001585935021977, 'support': 9091}, 'accuracy': 0.48958368278036835, 'macro avg': {'precision': 0.49552042795222634, 'recall': 0.4896518878367577, 'f1-score': 0.48364476810398466, 'support': 29809}, 'weighted avg': {'precision': 0.5027513575459933, 'recall': 0.48958368278036835, 'f1-score': 0.48764948713892187, 'support': 29809}}
[[3381 2183 3641]
 [2001 5694 3818]
 [1723 1849 5519]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0317099
{'0': {'precision': 0.4744384731982913, 'recall': 0.35215301217142275, 'f1-score': 0.4042503228836445, 'support': 9777}, '1': {'precision': 0.5142014419925716, 'recall': 0.4545630130371801, 'f1-score': 0.4825465169921575, 'support': 10355}, '2': {'precision': 0.4309598447529482, 'recall': 0.5966725224759739, 'f1-score': 0.5004550379198267, 'support': 9677}, 'accuracy': 0.46710724948840954, 'macro avg': {'precision': 0.47319991998127037, 'recall': 0.4677961825615256, 'f1-score': 0.46241729259854286, 'support': 29809}, 'weighted avg': {'precision': 0.4741366467163291, 'recall': 0.46710724948840954, 'f1-score': 0.46267999571395707, 'support': 29809}}
[[3443 2365 3969]
 [1993 4707 3655]
 [1821 2082 5774]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0533967
{'0': {'precision': 0.4585099111414901, 'recall': 0.3400932873656459, 'f1-score': 0.3905222099318857, 'support': 9862}, '1': {'precision': 0.45401841536887577, 'recall': 0.40225601772585357, 'f1-score': 0.4265726796966784, 'support': 9929}, '2': {'precision': 0.42418047747681975, 'recall': 0.5799560790576962, 'f1-score': 0.48998524140839134, 'support': 10018}, 'accuracy': 0.441410312321782, 'macro avg': {'precision': 0.4455696013290618, 'recall': 0.4407684613830652, 'f1-score': 0.43569337701231853, 'support': 29809}, 'weighted avg': {'precision': 0.44547665514568496, 'recall': 0.441410312321782, 'f1-score': 0.4359570035722715, 'support': 29809}}
[[3354 2491 4017]
 [2065 3994 3870]
 [1896 2312 5810]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0778762
{'0': {'precision': 0.40156665681347914, 'recall': 0.28498007132368364, 'f1-score': 0.3333742331288343, 'support': 9534}, '1': {'precision': 0.40625962031811186, 'recall': 0.3866966204336785, 'f1-score': 0.39623680128108896, 'support': 10238}, '2': {'precision': 0.40397052188298993, 'recall': 0.5352196871575172, 'f1-score': 0.46042425541032783, 'support': 10037}, 'accuracy': 0.4041732362709249, 'macro avg': {'precision': 0.4039322663381936, 'recall': 0.40229879297162646, 'f1-score': 0.3966784299400837, 'support': 29809}, 'weighted avg': {'precision': 0.40398787705109557, 'recall': 0.4041732362709249, 'f1-score': 0.3977436533167686, 'support': 29809}}
[[2717 2963 3854]
 [2207 3959 4072]
 [1842 2823 5372]]
training model: results/XRAY/W2/deepVOL_L3/seq2seq
Epoch 1/50
286/286 - 20s - loss: 13.2083 - accuracy10: 0.3839 - accuracy20: 0.3768 - accuracy30: 0.3686 - accuracy50: 0.3648 - val_loss: 13.0952 - val_accuracy10: 0.3885 - val_accuracy20: 0.3875 - val_accuracy30: 0.3824 - val_accuracy50: 0.3699 - 20s/epoch - 69ms/step
Epoch 2/50
286/286 - 14s - loss: 13.0404 - accuracy10: 0.4030 - accuracy20: 0.3931 - accuracy30: 0.3800 - accuracy50: 0.3684 - val_loss: 13.0789 - val_accuracy10: 0.4060 - val_accuracy20: 0.3846 - val_accuracy30: 0.3649 - val_accuracy50: 0.3537 - 14s/epoch - 48ms/step
Epoch 3/50
286/286 - 13s - loss: 12.9591 - accuracy10: 0.4146 - accuracy20: 0.4036 - accuracy30: 0.3870 - accuracy50: 0.3718 - val_loss: 12.9303 - val_accuracy10: 0.4158 - val_accuracy20: 0.4081 - val_accuracy30: 0.3967 - val_accuracy50: 0.3774 - 13s/epoch - 47ms/step
Epoch 4/50
286/286 - 13s - loss: 12.8108 - accuracy10: 0.4344 - accuracy20: 0.4209 - accuracy30: 0.4049 - accuracy50: 0.3849 - val_loss: 12.7615 - val_accuracy10: 0.4394 - val_accuracy20: 0.4331 - val_accuracy30: 0.4181 - val_accuracy50: 0.3977 - 13s/epoch - 47ms/step
Epoch 5/50
286/286 - 14s - loss: 12.6536 - accuracy10: 0.4580 - accuracy20: 0.4455 - accuracy30: 0.4300 - accuracy50: 0.4028 - val_loss: 12.6696 - val_accuracy10: 0.4528 - val_accuracy20: 0.4418 - val_accuracy30: 0.4234 - val_accuracy50: 0.4007 - 14s/epoch - 48ms/step
Epoch 6/50
286/286 - 14s - loss: 12.5285 - accuracy10: 0.4786 - accuracy20: 0.4640 - accuracy30: 0.4442 - accuracy50: 0.4104 - val_loss: 12.6557 - val_accuracy10: 0.4602 - val_accuracy20: 0.4467 - val_accuracy30: 0.4282 - val_accuracy50: 0.3987 - 14s/epoch - 47ms/step
Epoch 7/50
286/286 - 13s - loss: 12.4441 - accuracy10: 0.4889 - accuracy20: 0.4735 - accuracy30: 0.4535 - accuracy50: 0.4182 - val_loss: 12.5891 - val_accuracy10: 0.4724 - val_accuracy20: 0.4573 - val_accuracy30: 0.4367 - val_accuracy50: 0.4016 - 13s/epoch - 47ms/step
Epoch 8/50
286/286 - 14s - loss: 12.3695 - accuracy10: 0.4971 - accuracy20: 0.4825 - accuracy30: 0.4616 - accuracy50: 0.4222 - val_loss: 12.5730 - val_accuracy10: 0.4876 - val_accuracy20: 0.4643 - val_accuracy30: 0.4359 - val_accuracy50: 0.3995 - 14s/epoch - 47ms/step
Epoch 9/50
286/286 - 14s - loss: 12.3278 - accuracy10: 0.5031 - accuracy20: 0.4867 - accuracy30: 0.4643 - accuracy50: 0.4241 - val_loss: 12.5354 - val_accuracy10: 0.4879 - val_accuracy20: 0.4628 - val_accuracy30: 0.4337 - val_accuracy50: 0.4016 - 14s/epoch - 48ms/step
Epoch 10/50
286/286 - 14s - loss: 12.2737 - accuracy10: 0.5069 - accuracy20: 0.4910 - accuracy30: 0.4695 - accuracy50: 0.4310 - val_loss: 12.5385 - val_accuracy10: 0.4881 - val_accuracy20: 0.4667 - val_accuracy30: 0.4415 - val_accuracy50: 0.3981 - 14s/epoch - 47ms/step
Epoch 11/50
286/286 - 14s - loss: 12.2601 - accuracy10: 0.5098 - accuracy20: 0.4921 - accuracy30: 0.4713 - accuracy50: 0.4319 - val_loss: 12.5176 - val_accuracy10: 0.4951 - val_accuracy20: 0.4721 - val_accuracy30: 0.4402 - val_accuracy50: 0.3998 - 14s/epoch - 49ms/step
Epoch 12/50
286/286 - 13s - loss: 12.2081 - accuracy10: 0.5142 - accuracy20: 0.4969 - accuracy30: 0.4750 - accuracy50: 0.4357 - val_loss: 12.5280 - val_accuracy10: 0.4913 - val_accuracy20: 0.4673 - val_accuracy30: 0.4413 - val_accuracy50: 0.3957 - 13s/epoch - 46ms/step
Epoch 13/50
286/286 - 14s - loss: 12.1747 - accuracy10: 0.5169 - accuracy20: 0.4994 - accuracy30: 0.4765 - accuracy50: 0.4368 - val_loss: 12.5152 - val_accuracy10: 0.4887 - val_accuracy20: 0.4695 - val_accuracy30: 0.4438 - val_accuracy50: 0.3987 - 14s/epoch - 48ms/step
Epoch 14/50
286/286 - 14s - loss: 12.1472 - accuracy10: 0.5199 - accuracy20: 0.5012 - accuracy30: 0.4798 - accuracy50: 0.4402 - val_loss: 12.4987 - val_accuracy10: 0.4887 - val_accuracy20: 0.4694 - val_accuracy30: 0.4453 - val_accuracy50: 0.4010 - 14s/epoch - 48ms/step
Epoch 15/50
286/286 - 13s - loss: 12.1180 - accuracy10: 0.5210 - accuracy20: 0.5037 - accuracy30: 0.4817 - accuracy50: 0.4422 - val_loss: 12.4914 - val_accuracy10: 0.4927 - val_accuracy20: 0.4706 - val_accuracy30: 0.4449 - val_accuracy50: 0.4032 - 13s/epoch - 47ms/step
Epoch 16/50
286/286 - 13s - loss: 12.0819 - accuracy10: 0.5238 - accuracy20: 0.5060 - accuracy30: 0.4841 - accuracy50: 0.4436 - val_loss: 12.5255 - val_accuracy10: 0.4854 - val_accuracy20: 0.4653 - val_accuracy30: 0.4449 - val_accuracy50: 0.4079 - 13s/epoch - 46ms/step
Epoch 17/50
286/286 - 14s - loss: 12.0559 - accuracy10: 0.5259 - accuracy20: 0.5093 - accuracy30: 0.4856 - accuracy50: 0.4460 - val_loss: 12.5080 - val_accuracy10: 0.4921 - val_accuracy20: 0.4725 - val_accuracy30: 0.4507 - val_accuracy50: 0.4063 - 14s/epoch - 47ms/step
Epoch 18/50
286/286 - 14s - loss: 12.0455 - accuracy10: 0.5272 - accuracy20: 0.5086 - accuracy30: 0.4845 - accuracy50: 0.4472 - val_loss: 12.5329 - val_accuracy10: 0.4916 - val_accuracy20: 0.4700 - val_accuracy30: 0.4463 - val_accuracy50: 0.3986 - 14s/epoch - 48ms/step
Epoch 19/50
286/286 - 14s - loss: 12.0147 - accuracy10: 0.5278 - accuracy20: 0.5114 - accuracy30: 0.4891 - accuracy50: 0.4504 - val_loss: 12.5750 - val_accuracy10: 0.4882 - val_accuracy20: 0.4711 - val_accuracy30: 0.4488 - val_accuracy50: 0.3994 - 14s/epoch - 49ms/step
Epoch 20/50
286/286 - 14s - loss: 12.0008 - accuracy10: 0.5299 - accuracy20: 0.5144 - accuracy30: 0.4904 - accuracy50: 0.4506 - val_loss: 12.5655 - val_accuracy10: 0.4865 - val_accuracy20: 0.4720 - val_accuracy30: 0.4460 - val_accuracy50: 0.4007 - 14s/epoch - 47ms/step
Epoch 21/50
286/286 - 14s - loss: 11.9762 - accuracy10: 0.5310 - accuracy20: 0.5137 - accuracy30: 0.4906 - accuracy50: 0.4516 - val_loss: 12.5554 - val_accuracy10: 0.4840 - val_accuracy20: 0.4659 - val_accuracy30: 0.4461 - val_accuracy50: 0.4038 - 14s/epoch - 48ms/step
Epoch 22/50
286/286 - 14s - loss: 11.9482 - accuracy10: 0.5330 - accuracy20: 0.5164 - accuracy30: 0.4937 - accuracy50: 0.4550 - val_loss: 12.6039 - val_accuracy10: 0.4756 - val_accuracy20: 0.4634 - val_accuracy30: 0.4424 - val_accuracy50: 0.4060 - 14s/epoch - 48ms/step
Epoch 23/50
286/286 - 14s - loss: 11.9231 - accuracy10: 0.5332 - accuracy20: 0.5183 - accuracy30: 0.4942 - accuracy50: 0.4569 - val_loss: 12.6611 - val_accuracy10: 0.4708 - val_accuracy20: 0.4573 - val_accuracy30: 0.4361 - val_accuracy50: 0.4020 - 14s/epoch - 48ms/step
Epoch 24/50
286/286 - 13s - loss: 11.9005 - accuracy10: 0.5344 - accuracy20: 0.5212 - accuracy30: 0.4985 - accuracy50: 0.4603 - val_loss: 12.6591 - val_accuracy10: 0.4752 - val_accuracy20: 0.4593 - val_accuracy30: 0.4413 - val_accuracy50: 0.4071 - 13s/epoch - 47ms/step
Epoch 25/50
286/286 - 13s - loss: 11.8555 - accuracy10: 0.5361 - accuracy20: 0.5235 - accuracy30: 0.5009 - accuracy50: 0.4639 - val_loss: 12.5991 - val_accuracy10: 0.4816 - val_accuracy20: 0.4627 - val_accuracy30: 0.4418 - val_accuracy50: 0.4054 - 13s/epoch - 47ms/step
testing model: results/XRAY/W2/deepVOL_L3/seq2seq
Evaluating performance on  test set...
1072/1072 - 22s - 22s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0131334
{'0': {'precision': 0.4668052387963471, 'recall': 0.5252449786151264, 'f1-score': 0.4943038232656721, 'support': 92355}, '1': {'precision': 0.5605439673485774, 'recall': 0.3952234933364784, 'f1-score': 0.4635858701140601, 'support': 84790}, '2': {'precision': 0.46979088433035027, 'recall': 0.5348621584868339, 'f1-score': 0.5002191915445054, 'support': 97068}, 'accuracy': 0.4884451138348656, 'macro avg': {'precision': 0.49904669682509156, 'recall': 0.48511021014614625, 'f1-score': 0.4860362949747459, 'support': 274213}, 'weighted avg': {'precision': 0.49684727704631415, 'recall': 0.4884451138348656, 'f1-score': 0.4868994249343188, 'support': 274213}}
[[48509 13587 30259]
 [22943 33511 28336]
 [32465 12685 51918]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0309078
{'0': {'precision': 0.4588798626890707, 'recall': 0.49443090114324145, 'f1-score': 0.4759924940189875, 'support': 95168}, '1': {'precision': 0.48296157079974283, 'recall': 0.3763005780346821, 'f1-score': 0.42301111135177283, 'support': 77850}, '2': {'precision': 0.4733864793045985, 'recall': 0.5193240772765453, 'f1-score': 0.49529239903868805, 'support': 101195}, 'accuracy': 0.47007982845452256, 'macro avg': {'precision': 0.471742637597804, 'recall': 0.4633518521514896, 'f1-score': 0.4647653348031495, 'support': 274213}, 'weighted avg': {'precision': 0.4710702331121511, 'recall': 0.47007982845452256, 'f1-score': 0.4680732970729125, 'support': 274213}}
[[47054 16052 32062]
 [22155 29295 26400]
 [33332 15310 52553]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0529926
{'0': {'precision': 0.43864574900859726, 'recall': 0.4520179088086841, 'f1-score': 0.4452314460895206, 'support': 94702}, '1': {'precision': 0.4290039312557425, 'recall': 0.3687563116600637, 'f1-score': 0.3966051424155289, 'support': 77238}, '2': {'precision': 0.46422577631017936, 'recall': 0.5003568879371877, 'f1-score': 0.48161463676319727, 'support': 102273}, 'accuracy': 0.44659443571238416, 'macro avg': {'precision': 0.44395848552483974, 'recall': 0.4403770361353119, 'f1-score': 0.4411504084227489, 'support': 274213}, 'weighted avg': {'precision': 0.4454704852998005, 'recall': 0.44659443571238416, 'f1-score': 0.44510460898331905, 'support': 274213}}
[[42807 19530 32365]
 [22061 28482 26695]
 [32721 18379 51173]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0768772
{'0': {'precision': 0.40422825878287577, 'recall': 0.36496982959408075, 'f1-score': 0.38359720585472495, 'support': 92309}, '1': {'precision': 0.374562033959213, 'recall': 0.4147939958463394, 'f1-score': 0.39365274196118233, 'support': 80411}, '2': {'precision': 0.4456448080454916, 'recall': 0.44708502064181765, 'f1-score': 0.44636375261910144, 'support': 101493}, 'accuracy': 0.4099732689551553, 'macro avg': {'precision': 0.40814503359586013, 'recall': 0.408949615360746, 'f1-score': 0.40787123347833626, 'support': 274213}, 'weighted avg': {'precision': 0.4108581378550391, 'recall': 0.4099732689551553, 'f1-score': 0.4097773681541535, 'support': 274213}}
[[33690 28682 29937]
 [20549 33354 26508]
 [29105 27012 45376]]
Evaluating performance on  train set...
286/286 - 6s - 6s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.98461014
{'0': {'precision': 0.47909980585601647, 'recall': 0.5233046263037174, 'f1-score': 0.5002275265792413, 'support': 23107}, '1': {'precision': 0.6054501833325788, 'recall': 0.49113208240002937, 'f1-score': 0.5423323331441083, 'support': 27233}, '2': {'precision': 0.4638994787209212, 'recall': 0.525422982023264, 'f1-score': 0.49274823354406844, 'support': 22696}, 'accuracy': 0.5119667013527576, 'macro avg': {'precision': 0.5161498226365054, 'recall': 0.5132865635756702, 'f1-score': 0.5117693644224727, 'support': 73036}, 'weighted avg': {'precision': 0.5214886716915099, 'recall': 0.5119667013527576, 'f1-score': 0.513602987481464, 'support': 73036}}
[[12092  4489  6526]
 [ 6603 13375  7255]
 [ 6544  4227 11925]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0071709
{'0': {'precision': 0.4837261503928171, 'recall': 0.4950568158510071, 'f1-score': 0.48932589964521034, 'support': 24377}, '1': {'precision': 0.5275069326415601, 'recall': 0.4787886168960338, 'f1-score': 0.5019684620459237, 'support': 24633}, '2': {'precision': 0.46859696851923827, 'recall': 0.5018313493715142, 'f1-score': 0.48464506793150575, 'support': 24026}, 'accuracy': 0.4917985650911879, 'macro avg': {'precision': 0.4932766838512051, 'recall': 0.4918922607061851, 'f1-score': 0.49197980987421325, 'support': 73036}, 'weighted avg': {'precision': 0.49351527199639184, 'recall': 0.4917985650911879, 'f1-score': 0.4920500709698079, 'support': 73036}}
[[12068  5417  6892]
 [ 6058 11794  6781]
 [ 6822  5147 12057]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0338774
{'0': {'precision': 0.47094631986718316, 'recall': 0.44644874899112186, 'f1-score': 0.4583704501667668, 'support': 24780}, '1': {'precision': 0.457189351581407, 'recall': 0.4620672205119555, 'f1-score': 0.4596153442815495, 'support': 23713}, '2': {'precision': 0.4588920598928809, 'recall': 0.4782626410789227, 'f1-score': 0.4683771597302582, 'support': 24543}, 'accuracy': 0.46221041678076563, 'macro avg': {'precision': 0.4623425771138237, 'recall': 0.46225953686066673, 'f1-score': 0.4621209847261915, 'support': 73036}, 'weighted avg': {'precision': 0.4624290586328616, 'recall': 0.46221041678076563, 'f1-score': 0.46213728908128315, 'support': 73036}}
[[11063  6782  6935]
 [ 5850 10957  6906]
 [ 6578  6227 11738]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0621239
{'0': {'precision': 0.4459566858732366, 'recall': 0.3665088177661659, 'f1-score': 0.4023483015147441, 'support': 24496}, '1': {'precision': 0.40211513450612635, 'recall': 0.48321954429546765, 'f1-score': 0.4389524023014272, 'support': 24314}, '2': {'precision': 0.43565819471417716, 'recall': 0.4259473293156113, 'f1-score': 0.43074803806979467, 'support': 24226}, 'accuracy': 0.4250780437044745, 'macro avg': {'precision': 0.42791000503118, 'recall': 0.4252252304590816, 'f1-score': 0.42401624729532195, 'support': 73036}, 'weighted avg': {'precision': 0.42794564026888676, 'recall': 0.4250780437044745, 'f1-score': 0.4239541414335522, 'support': 73036}}
[[ 8978  9132  6386]
 [ 5584 11749  6981]
 [ 5570  8337 10319]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0134505
{'0': {'precision': 0.45026807173229805, 'recall': 0.5291689299293862, 'f1-score': 0.4865404784497828, 'support': 9205}, '1': {'precision': 0.6133158020559407, 'recall': 0.44567011204725093, 'f1-score': 0.51622315005785, 'support': 11513}, '2': {'precision': 0.4400941176470588, 'recall': 0.5143548564514355, 'f1-score': 0.47433556502333135, 'support': 9091}, 'accuracy': 0.4924016236707035, 'macro avg': {'precision': 0.5012259971450992, 'recall': 0.4963979661426909, 'f1-score': 0.49236639784365477, 'support': 29809}, 'weighted avg': {'precision': 0.5101384834410836, 'recall': 0.4924016236707035, 'f1-score': 0.4942824936218385, 'support': 29809}}
[[4871 1695 2639]
 [3072 5131 3310]
 [2875 1540 4676]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.031078
{'0': {'precision': 0.45174615095756665, 'recall': 0.49217551396133785, 'f1-score': 0.4710950119927554, 'support': 9777}, '1': {'precision': 0.525764801675003, 'recall': 0.43650410429744085, 'f1-score': 0.4769945124525116, 'support': 10355}, '2': {'precision': 0.4428030303030303, 'recall': 0.48320760566291204, 'f1-score': 0.462123832583881, 'support': 9677}, 'accuracy': 0.4699251903787447, 'macro avg': {'precision': 0.4734379943118667, 'recall': 0.4706290746405635, 'f1-score': 0.470071119009716, 'support': 29809}, 'weighted avg': {'precision': 0.47455538808746384, 'recall': 0.4699251903787447, 'f1-score': 0.4702320251136618, 'support': 29809}}
[[4812 2052 2913]
 [2864 4520 2971]
 [2976 2025 4676]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0520445
{'0': {'precision': 0.44592817400101165, 'recall': 0.4469681606165078, 'f1-score': 0.446447561654935, 'support': 9862}, '1': {'precision': 0.4537161811962268, 'recall': 0.44082989223486757, 'f1-score': 0.4471802206783817, 'support': 9929}, '2': {'precision': 0.4388440206285881, 'recall': 0.4501896586144939, 'f1-score': 0.4444444444444445, 'support': 10018}, 'accuracy': 0.4460062397262572, 'macro avg': {'precision': 0.4461627919419422, 'recall': 0.4459959038219565, 'f1-score': 0.44602407559258705, 'support': 29809}, 'weighted avg': {'precision': 0.44614146780343206, 'recall': 0.4460062397262572, 'f1-score': 0.4460184074809978, 'support': 29809}}
[[4408 2622 2832]
 [2617 4377 2935]
 [2860 2648 4510]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0786697
{'0': {'precision': 0.4048496374658267, 'recall': 0.35724774491294314, 'f1-score': 0.3795620437956205, 'support': 9534}, '1': {'precision': 0.3931341805578478, 'recall': 0.4653252588396171, 'f1-score': 0.42619431025228127, 'support': 10238}, '2': {'precision': 0.41496012071567145, 'recall': 0.3835807512204842, 'f1-score': 0.3986538959358012, 'support': 10037}, 'accuracy': 0.4032339226408132, 'macro avg': {'precision': 0.40431464624644864, 'recall': 0.4020512516576815, 'f1-score': 0.401470083327901, 'support': 29809}, 'weighted avg': {'precision': 0.4042302296545886, 'recall': 0.4032339226408132, 'f1-score': 0.4020064754744519, 'support': 29809}}
[[3406 3617 2511]
 [2557 4764 2917]
 [2450 3737 3850]]
training model: results/XRAY/W3/deepLOB_L1/seq2seq
Epoch 1/50
444/444 - 19s - loss: 13.0969 - accuracy10: 0.3949 - accuracy20: 0.3856 - accuracy30: 0.3797 - accuracy50: 0.3739 - val_loss: 13.4694 - val_accuracy10: 0.3835 - val_accuracy20: 0.3668 - val_accuracy30: 0.3470 - val_accuracy50: 0.3307 - 19s/epoch - 42ms/step
Epoch 2/50
444/444 - 12s - loss: 12.9557 - accuracy10: 0.4192 - accuracy20: 0.4047 - accuracy30: 0.3930 - accuracy50: 0.3844 - val_loss: 13.0629 - val_accuracy10: 0.3928 - val_accuracy20: 0.3868 - val_accuracy30: 0.3793 - val_accuracy50: 0.3808 - 12s/epoch - 27ms/step
Epoch 3/50
444/444 - 12s - loss: 12.9153 - accuracy10: 0.4301 - accuracy20: 0.4130 - accuracy30: 0.3990 - accuracy50: 0.3861 - val_loss: 13.0510 - val_accuracy10: 0.4056 - val_accuracy20: 0.3969 - val_accuracy30: 0.3884 - val_accuracy50: 0.3851 - 12s/epoch - 27ms/step
Epoch 4/50
444/444 - 12s - loss: 12.8644 - accuracy10: 0.4404 - accuracy20: 0.4208 - accuracy30: 0.4033 - accuracy50: 0.3884 - val_loss: 13.0442 - val_accuracy10: 0.4098 - val_accuracy20: 0.4011 - val_accuracy30: 0.3904 - val_accuracy50: 0.3889 - 12s/epoch - 27ms/step
Epoch 5/50
444/444 - 12s - loss: 12.8179 - accuracy10: 0.4473 - accuracy20: 0.4267 - accuracy30: 0.4107 - accuracy50: 0.3976 - val_loss: 13.1292 - val_accuracy10: 0.4118 - val_accuracy20: 0.4009 - val_accuracy30: 0.3914 - val_accuracy50: 0.3919 - 12s/epoch - 27ms/step
Epoch 6/50
444/444 - 12s - loss: 12.7935 - accuracy10: 0.4506 - accuracy20: 0.4286 - accuracy30: 0.4115 - accuracy50: 0.3980 - val_loss: 13.1230 - val_accuracy10: 0.4117 - val_accuracy20: 0.3988 - val_accuracy30: 0.3860 - val_accuracy50: 0.3831 - 12s/epoch - 27ms/step
Epoch 7/50
444/444 - 12s - loss: 12.7735 - accuracy10: 0.4535 - accuracy20: 0.4317 - accuracy30: 0.4146 - accuracy50: 0.4005 - val_loss: 12.9369 - val_accuracy10: 0.4284 - val_accuracy20: 0.4153 - val_accuracy30: 0.4028 - val_accuracy50: 0.3951 - 12s/epoch - 27ms/step
Epoch 8/50
444/444 - 12s - loss: 12.7397 - accuracy10: 0.4594 - accuracy20: 0.4368 - accuracy30: 0.4203 - accuracy50: 0.4071 - val_loss: 13.0273 - val_accuracy10: 0.4142 - val_accuracy20: 0.4012 - val_accuracy30: 0.3891 - val_accuracy50: 0.3866 - 12s/epoch - 28ms/step
Epoch 9/50
444/444 - 12s - loss: 12.7222 - accuracy10: 0.4606 - accuracy20: 0.4379 - accuracy30: 0.4220 - accuracy50: 0.4090 - val_loss: 12.9915 - val_accuracy10: 0.4165 - val_accuracy20: 0.4013 - val_accuracy30: 0.3905 - val_accuracy50: 0.3858 - 12s/epoch - 28ms/step
Epoch 10/50
444/444 - 12s - loss: 12.6927 - accuracy10: 0.4633 - accuracy20: 0.4416 - accuracy30: 0.4266 - accuracy50: 0.4130 - val_loss: 12.9940 - val_accuracy10: 0.4226 - val_accuracy20: 0.4078 - val_accuracy30: 0.3952 - val_accuracy50: 0.3912 - 12s/epoch - 28ms/step
Epoch 11/50
444/444 - 12s - loss: 12.6744 - accuracy10: 0.4661 - accuracy20: 0.4445 - accuracy30: 0.4291 - accuracy50: 0.4143 - val_loss: 12.9861 - val_accuracy10: 0.4209 - val_accuracy20: 0.4045 - val_accuracy30: 0.3921 - val_accuracy50: 0.3866 - 12s/epoch - 28ms/step
Epoch 12/50
444/444 - 12s - loss: 12.6602 - accuracy10: 0.4682 - accuracy20: 0.4470 - accuracy30: 0.4311 - accuracy50: 0.4164 - val_loss: 12.9994 - val_accuracy10: 0.4212 - val_accuracy20: 0.4045 - val_accuracy30: 0.3922 - val_accuracy50: 0.3854 - 12s/epoch - 27ms/step
Epoch 13/50
444/444 - 12s - loss: 12.6350 - accuracy10: 0.4713 - accuracy20: 0.4493 - accuracy30: 0.4330 - accuracy50: 0.4170 - val_loss: 13.0758 - val_accuracy10: 0.4164 - val_accuracy20: 0.3994 - val_accuracy30: 0.3903 - val_accuracy50: 0.3875 - 12s/epoch - 27ms/step
Epoch 14/50
444/444 - 12s - loss: 12.6158 - accuracy10: 0.4730 - accuracy20: 0.4508 - accuracy30: 0.4346 - accuracy50: 0.4214 - val_loss: 13.0566 - val_accuracy10: 0.4166 - val_accuracy20: 0.4020 - val_accuracy30: 0.3931 - val_accuracy50: 0.3871 - 12s/epoch - 27ms/step
Epoch 15/50
444/444 - 12s - loss: 12.6015 - accuracy10: 0.4740 - accuracy20: 0.4523 - accuracy30: 0.4363 - accuracy50: 0.4209 - val_loss: 13.0865 - val_accuracy10: 0.4158 - val_accuracy20: 0.4010 - val_accuracy30: 0.3933 - val_accuracy50: 0.3902 - 12s/epoch - 27ms/step
Epoch 16/50
444/444 - 12s - loss: 12.5906 - accuracy10: 0.4749 - accuracy20: 0.4524 - accuracy30: 0.4370 - accuracy50: 0.4217 - val_loss: 13.0928 - val_accuracy10: 0.4158 - val_accuracy20: 0.3999 - val_accuracy30: 0.3914 - val_accuracy50: 0.3860 - 12s/epoch - 27ms/step
Epoch 17/50
444/444 - 12s - loss: 12.5826 - accuracy10: 0.4752 - accuracy20: 0.4534 - accuracy30: 0.4377 - accuracy50: 0.4226 - val_loss: 13.1195 - val_accuracy10: 0.4139 - val_accuracy20: 0.4014 - val_accuracy30: 0.3932 - val_accuracy50: 0.3890 - 12s/epoch - 27ms/step
testing model: results/XRAY/W3/deepLOB_L1/seq2seq
Evaluating performance on  test set...
1359/1359 - 16s - 16s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0519701
{'0': {'precision': 0.4316304075689494, 'recall': 0.595320096324231, 'f1-score': 0.500429679592702, 'support': 110045}, '1': {'precision': 0.4726116679219049, 'recall': 0.24943624397067704, 'f1-score': 0.3265336755677639, 'support': 130819}, '2': {'precision': 0.4296379716331047, 'recall': 0.51016018777411, 'f1-score': 0.4664494946904017, 'support': 106937}, 'accuracy': 0.43903841564572843, 'macro avg': {'precision': 0.44462668237465297, 'recall': 0.4516388426896727, 'f1-score': 0.4311376166169559, 'support': 347801}, 'weighted avg': {'precision': 0.4464321544772155, 'recall': 0.43903841564572843, 'f1-score': 0.4245741174079019, 'support': 347801}}
[[65512 19047 25486]
 [51250 32631 46938]
 [35016 17366 54555]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.063343
{'0': {'precision': 0.4200462226011203, 'recall': 0.5606902499088735, 'f1-score': 0.48028359936639453, 'support': 112481}, '1': {'precision': 0.42783588745641776, 'recall': 0.2543954101311391, 'f1-score': 0.3190691674309384, 'support': 124448}, '2': {'precision': 0.4287724405628336, 'recall': 0.47822714481564327, 'f1-score': 0.45215151876929377, 'support': 110872}, 'accuracy': 0.4248061391427857, 'macro avg': {'precision': 0.4255515168734572, 'recall': 0.43110426828521864, 'f1-score': 0.4171680951888756, 'support': 347801}, 'weighted avg': {'precision': 0.42561521593283336, 'recall': 0.4248061391427857, 'f1-score': 0.4136309052526186, 'support': 347801}}
[[63067 22398 27016]
 [49167 31659 43622]
 [37909 19941 53022]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.073394
{'0': {'precision': 0.40703098283291156, 'recall': 0.5198553433847551, 'f1-score': 0.4565764438716013, 'support': 114478}, '1': {'precision': 0.3949085504106414, 'recall': 0.25887453036621116, 'f1-score': 0.3127390981231265, 'support': 121105}, '2': {'precision': 0.422992888881615, 'recall': 0.4606302019283894, 'f1-score': 0.4410099777750287, 'support': 112218}, 'accuracy': 0.40987231204050595, 'macro avg': {'precision': 0.40831080737505604, 'recall': 0.4131200252264519, 'f1-score': 0.40344183992325217, 'support': 347801}, 'weighted avg': {'precision': 0.40796003707506256, 'recall': 0.40987231204050595, 'f1-score': 0.40146947336463257, 'support': 347801}}
[[59512 25583 29383]
 [48625 31351 41129]
 [38073 22454 51691]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0874802
{'0': {'precision': 0.4139805298230828, 'recall': 0.4637250980078406, 'f1-score': 0.4374431601628685, 'support': 124990}, '1': {'precision': 0.31284608165180666, 'recall': 0.2638807801537746, 'f1-score': 0.28628480329795974, 'support': 101057}, '2': {'precision': 0.4321022912722763, 'recall': 0.43493437587266126, 'f1-score': 0.4335137082183819, 'support': 121754}, 'accuracy': 0.3955796561827022, 'macro avg': {'precision': 0.3863096342490553, 'recall': 0.3875134180114255, 'f1-score': 0.3857472238930701, 'support': 347801}, 'weighted avg': {'precision': 0.3909387703532723, 'recall': 0.3955796561827022, 'f1-score': 0.39214703806504214, 'support': 347801}}
[[57961 31883 35146]
 [39939 26667 34451]
 [42109 26690 52955]]
Evaluating performance on  train set...
444/444 - 5s - 5s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0583367
{'0': {'precision': 0.44261261471639074, 'recall': 0.5050090589363743, 'f1-score': 0.4717565801754714, 'support': 37532}, '1': {'precision': 0.41987420081277665, 'recall': 0.4242004236512461, 'f1-score': 0.42202622541367474, 'support': 38239}, '2': {'precision': 0.46279525721221176, 'recall': 0.3932254481992702, 'f1-score': 0.4251833426255522, 'support': 37818}, 'accuracy': 0.4405884372606502, 'macro avg': {'precision': 0.44176069091379305, 'recall': 0.4408116435956302, 'f1-score': 0.4396553827382328, 'support': 113589}, 'weighted avg': {'precision': 0.4416774270190491, 'recall': 0.4405884372606502, 'f1-score': 0.4395092170205956, 'support': 113589}}
[[18954 11268  7310]
 [12066 16221  9952]
 [11803 11144 14871]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0687827
{'0': {'precision': 0.4253849610899543, 'recall': 0.4783614842399255, 'f1-score': 0.45032051282051283, 'support': 37595}, '1': {'precision': 0.40234335964824625, 'recall': 0.4251359484715696, 'f1-score': 0.4134257476575536, 'support': 37882}, '2': {'precision': 0.4523398542385884, 'recall': 0.37130037783375314, 'f1-score': 0.4078333045132284, 'support': 38112}, 'accuracy': 0.42468901037952617, 'macro avg': {'precision': 0.42668939165892966, 'recall': 0.4249326035150827, 'f1-score': 0.4238598549970982, 'support': 113589}, 'weighted avg': {'precision': 0.4267446256865786, 'recall': 0.42468901037952617, 'f1-score': 0.423760546829876, 'support': 113589}}
[[17984 12016  7595]
 [12239 16105  9538]
 [12054 11907 14151]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0760682
{'0': {'precision': 0.41010621490897603, 'recall': 0.4500906956892872, 'f1-score': 0.42916915720263005, 'support': 37488}, '1': {'precision': 0.3896516073188911, 'recall': 0.4312629730161265, 'f1-score': 0.40940267023708776, 'support': 37578}, '2': {'precision': 0.4399286987522282, 'recall': 0.3523609272382732, 'f1-score': 0.3913056011992274, 'support': 38523}, 'accuracy': 0.41071758709029926, 'macro avg': {'precision': 0.41322884032669843, 'recall': 0.4112381986478957, 'f1-score': 0.40995914287964846, 'support': 113589}, 'weighted avg': {'precision': 0.4134534430831248, 'recall': 0.41071758709029926, 'f1-score': 0.40978873466954824, 'support': 113589}}
[[16873 12738  7877]
 [11968 16206  9404]
 [12302 12647 13574]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.08398
{'0': {'precision': 0.3923789645166217, 'recall': 0.4120445858170057, 'f1-score': 0.4019713939267507, 'support': 37411}, '1': {'precision': 0.38235090712095715, 'recall': 0.44264745129436883, 'f1-score': 0.41029573649643164, 'support': 37470}, '2': {'precision': 0.421096882680119, 'recall': 0.33641624470393716, 'f1-score': 0.3740234375, 'support': 38708}, 'accuracy': 0.3963676060181884, 'macro avg': {'precision': 0.3986089181058993, 'recall': 0.39703609393843725, 'f1-score': 0.39543018930772744, 'support': 113589}, 'weighted avg': {'precision': 0.3988572490834117, 'recall': 0.3963676060181884, 'f1-score': 0.39519348073726296, 'support': 113589}}
[[15415 13472  8524]
 [11506 16586  9378]
 [12365 13321 13022]]
Evaluating performance on  val set...
144/144 - 2s - 2s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0653994
{'0': {'precision': 0.4528902245006187, 'recall': 0.4352701325178389, 'f1-score': 0.44390539721043054, 'support': 11772}, '1': {'precision': 0.45263494772775764, 'recall': 0.32058934642992065, 'f1-score': 0.37533725507541243, 'support': 13235}, '2': {'precision': 0.3972044628306381, 'recall': 0.544649763644177, 'f1-score': 0.4593859871687992, 'support': 11635}, 'accuracy': 0.4285792260247803, 'macro avg': {'precision': 0.43424321168633817, 'recall': 0.4335030808639789, 'f1-score': 0.4262095464848807, 'support': 36642}, 'weighted avg': {'precision': 0.435116019350271, 'recall': 0.4285792260247803, 'f1-score': 0.42405433294015754, 'support': 36642}}
[[5124 2628 4020]
 [3395 4243 5597]
 [2795 2503 6337]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0755681
{'0': {'precision': 0.4374062637847375, 'recall': 0.4111111111111111, 'f1-score': 0.4238512502671511, 'support': 12060}, '1': {'precision': 0.4117527243100112, 'recall': 0.3230523371953656, 'f1-score': 0.36204889406286384, 'support': 12515}, '2': {'precision': 0.4003744834710744, 'recall': 0.5138808320212149, 'f1-score': 0.4500816548720741, 'support': 12067}, 'accuracy': 0.41487910048578136, 'macro avg': {'precision': 0.41651115718860776, 'recall': 0.41601476010923055, 'f1-score': 0.411993933067363, 'support': 36642}, 'weighted avg': {'precision': 0.4164489869010747, 'recall': 0.41487910048578136, 'f1-score': 0.41138101950657446, 'support': 36642}}
[[4958 2964 4138]
 [3323 4043 5149]
 [3054 2812 6201]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0818709
{'0': {'precision': 0.42665345107226527, 'recall': 0.38361824515919957, 'f1-score': 0.4039930037114457, 'support': 12343}, '1': {'precision': 0.3818686578594677, 'recall': 0.33233358327084894, 'f1-score': 0.355383313287897, 'support': 12003}, '2': {'precision': 0.4001854550271559, 'recall': 0.49137931034482757, 'f1-score': 0.44111849310067897, 'support': 12296}, 'accuracy': 0.40298018667103325, 'macro avg': {'precision': 0.4029025213196296, 'recall': 0.40244371292495873, 'f1-score': 0.40016493670000725, 'support': 36642}, 'weighted avg': {'precision': 0.4031011790264196, 'recall': 0.40298018667103325, 'f1-score': 0.4005279336654919, 'support': 36642}}
[[4735 3319 4289]
 [3247 3989 4767]
 [3116 3138 6042]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0881069
{'0': {'precision': 0.41320683824910764, 'recall': 0.3460509754562618, 'f1-score': 0.3766589605274424, 'support': 12712}, '1': {'precision': 0.37057711353200684, 'recall': 0.3657366269770748, 'f1-score': 0.36814095970663213, 'support': 11254}, '2': {'precision': 0.40083282960574923, 'recall': 0.47081098138213945, 'f1-score': 0.43301287865046256, 'support': 12676}, 'accuracy': 0.3952568091261394, 'macro avg': {'precision': 0.3948722604622879, 'recall': 0.394199527938492, 'f1-score': 0.3926042662948457, 'support': 36642}, 'weighted avg': {'precision': 0.39583311805017024, 'recall': 0.3952568091261394, 'f1-score': 0.39353797054026934, 'support': 36642}}
[[4399 3620 4693]
 [2910 4116 4228]
 [3337 3371 5968]]
training model: results/XRAY/W3/deepOF_L1/seq2seq
Epoch 1/50
444/444 - 18s - loss: 13.1277 - accuracy10: 0.3893 - accuracy20: 0.3836 - accuracy30: 0.3773 - accuracy50: 0.3720 - val_loss: 12.9786 - val_accuracy10: 0.3947 - val_accuracy20: 0.3863 - val_accuracy30: 0.3823 - val_accuracy50: 0.3844 - 18s/epoch - 40ms/step
Epoch 2/50
444/444 - 12s - loss: 13.0233 - accuracy10: 0.4031 - accuracy20: 0.3941 - accuracy30: 0.3862 - accuracy50: 0.3782 - val_loss: 12.9501 - val_accuracy10: 0.3990 - val_accuracy20: 0.3911 - val_accuracy30: 0.3885 - val_accuracy50: 0.3913 - 12s/epoch - 26ms/step
Epoch 3/50
444/444 - 12s - loss: 12.9898 - accuracy10: 0.4047 - accuracy20: 0.3963 - accuracy30: 0.3904 - accuracy50: 0.3838 - val_loss: 12.9351 - val_accuracy10: 0.4033 - val_accuracy20: 0.3930 - val_accuracy30: 0.3917 - val_accuracy50: 0.3904 - 12s/epoch - 27ms/step
Epoch 4/50
444/444 - 11s - loss: 12.9709 - accuracy10: 0.4061 - accuracy20: 0.3989 - accuracy30: 0.3932 - accuracy50: 0.3861 - val_loss: 12.9330 - val_accuracy10: 0.4010 - val_accuracy20: 0.3943 - val_accuracy30: 0.3907 - val_accuracy50: 0.3905 - 11s/epoch - 26ms/step
Epoch 5/50
444/444 - 12s - loss: 12.9496 - accuracy10: 0.4093 - accuracy20: 0.4017 - accuracy30: 0.3969 - accuracy50: 0.3902 - val_loss: 12.9279 - val_accuracy10: 0.4027 - val_accuracy20: 0.3930 - val_accuracy30: 0.3909 - val_accuracy50: 0.3896 - 12s/epoch - 27ms/step
Epoch 6/50
444/444 - 11s - loss: 12.9278 - accuracy10: 0.4106 - accuracy20: 0.4043 - accuracy30: 0.3999 - accuracy50: 0.3938 - val_loss: 12.9277 - val_accuracy10: 0.4029 - val_accuracy20: 0.3947 - val_accuracy30: 0.3915 - val_accuracy50: 0.3840 - 11s/epoch - 26ms/step
Epoch 7/50
444/444 - 11s - loss: 12.9071 - accuracy10: 0.4148 - accuracy20: 0.4077 - accuracy30: 0.4029 - accuracy50: 0.3972 - val_loss: 12.9284 - val_accuracy10: 0.4018 - val_accuracy20: 0.3894 - val_accuracy30: 0.3878 - val_accuracy50: 0.3855 - 11s/epoch - 25ms/step
Epoch 8/50
444/444 - 11s - loss: 12.8971 - accuracy10: 0.4143 - accuracy20: 0.4077 - accuracy30: 0.4037 - accuracy50: 0.3983 - val_loss: 12.9212 - val_accuracy10: 0.4053 - val_accuracy20: 0.3972 - val_accuracy30: 0.3926 - val_accuracy50: 0.3885 - 11s/epoch - 26ms/step
Epoch 9/50
444/444 - 11s - loss: 12.8784 - accuracy10: 0.4165 - accuracy20: 0.4118 - accuracy30: 0.4065 - accuracy50: 0.4012 - val_loss: 12.9255 - val_accuracy10: 0.4079 - val_accuracy20: 0.3967 - val_accuracy30: 0.3913 - val_accuracy50: 0.3854 - 11s/epoch - 26ms/step
Epoch 10/50
444/444 - 11s - loss: 12.8613 - accuracy10: 0.4192 - accuracy20: 0.4135 - accuracy30: 0.4087 - accuracy50: 0.4031 - val_loss: 12.9153 - val_accuracy10: 0.4072 - val_accuracy20: 0.3972 - val_accuracy30: 0.3962 - val_accuracy50: 0.3907 - 11s/epoch - 26ms/step
Epoch 11/50
444/444 - 11s - loss: 12.8453 - accuracy10: 0.4210 - accuracy20: 0.4151 - accuracy30: 0.4093 - accuracy50: 0.4041 - val_loss: 12.9102 - val_accuracy10: 0.4111 - val_accuracy20: 0.3994 - val_accuracy30: 0.3980 - val_accuracy50: 0.3933 - 11s/epoch - 26ms/step
Epoch 12/50
444/444 - 11s - loss: 12.8218 - accuracy10: 0.4242 - accuracy20: 0.4179 - accuracy30: 0.4146 - accuracy50: 0.4084 - val_loss: 12.9194 - val_accuracy10: 0.4093 - val_accuracy20: 0.4004 - val_accuracy30: 0.3948 - val_accuracy50: 0.3854 - 11s/epoch - 26ms/step
Epoch 13/50
444/444 - 12s - loss: 12.8107 - accuracy10: 0.4253 - accuracy20: 0.4207 - accuracy30: 0.4165 - accuracy50: 0.4110 - val_loss: 12.9165 - val_accuracy10: 0.4109 - val_accuracy20: 0.3987 - val_accuracy30: 0.3950 - val_accuracy50: 0.3880 - 12s/epoch - 26ms/step
Epoch 14/50
444/444 - 12s - loss: 12.7890 - accuracy10: 0.4272 - accuracy20: 0.4227 - accuracy30: 0.4191 - accuracy50: 0.4134 - val_loss: 12.9188 - val_accuracy10: 0.4102 - val_accuracy20: 0.3992 - val_accuracy30: 0.3968 - val_accuracy50: 0.3910 - 12s/epoch - 26ms/step
Epoch 15/50
444/444 - 11s - loss: 12.7690 - accuracy10: 0.4301 - accuracy20: 0.4250 - accuracy30: 0.4209 - accuracy50: 0.4157 - val_loss: 12.9203 - val_accuracy10: 0.4104 - val_accuracy20: 0.4009 - val_accuracy30: 0.3942 - val_accuracy50: 0.3887 - 11s/epoch - 25ms/step
Epoch 16/50
444/444 - 12s - loss: 12.7498 - accuracy10: 0.4324 - accuracy20: 0.4283 - accuracy30: 0.4251 - accuracy50: 0.4180 - val_loss: 12.9369 - val_accuracy10: 0.4091 - val_accuracy20: 0.4010 - val_accuracy30: 0.3939 - val_accuracy50: 0.3844 - 12s/epoch - 26ms/step
Epoch 17/50
444/444 - 11s - loss: 12.7319 - accuracy10: 0.4328 - accuracy20: 0.4297 - accuracy30: 0.4263 - accuracy50: 0.4214 - val_loss: 12.9384 - val_accuracy10: 0.4069 - val_accuracy20: 0.3995 - val_accuracy30: 0.3945 - val_accuracy50: 0.3860 - 11s/epoch - 26ms/step
Epoch 18/50
444/444 - 11s - loss: 12.7159 - accuracy10: 0.4347 - accuracy20: 0.4313 - accuracy30: 0.4281 - accuracy50: 0.4227 - val_loss: 12.9415 - val_accuracy10: 0.4100 - val_accuracy20: 0.4021 - val_accuracy30: 0.3955 - val_accuracy50: 0.3849 - 11s/epoch - 25ms/step
Epoch 19/50
444/444 - 11s - loss: 12.6991 - accuracy10: 0.4367 - accuracy20: 0.4333 - accuracy30: 0.4304 - accuracy50: 0.4234 - val_loss: 12.9433 - val_accuracy10: 0.4098 - val_accuracy20: 0.4024 - val_accuracy30: 0.3953 - val_accuracy50: 0.3878 - 11s/epoch - 26ms/step
Epoch 20/50
444/444 - 11s - loss: 12.6900 - accuracy10: 0.4379 - accuracy20: 0.4353 - accuracy30: 0.4337 - accuracy50: 0.4270 - val_loss: 12.9557 - val_accuracy10: 0.4067 - val_accuracy20: 0.3999 - val_accuracy30: 0.3925 - val_accuracy50: 0.3840 - 11s/epoch - 26ms/step
Epoch 21/50
444/444 - 11s - loss: 12.6707 - accuracy10: 0.4391 - accuracy20: 0.4374 - accuracy30: 0.4348 - accuracy50: 0.4295 - val_loss: 12.9500 - val_accuracy10: 0.4094 - val_accuracy20: 0.4042 - val_accuracy30: 0.3954 - val_accuracy50: 0.3885 - 11s/epoch - 26ms/step
testing model: results/XRAY/W3/deepOF_L1/seq2seq
Evaluating performance on  test set...
1359/1359 - 17s - 17s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0734707
{'0': {'precision': 0.4234252240894205, 'recall': 0.25026580518524577, 'f1-score': 0.3145918530533915, 'support': 110043}, '1': {'precision': 0.3941715368820092, 'recall': 0.6104358727392255, 'f1-score': 0.4790258240604661, 'support': 130818}, '2': {'precision': 0.40198842373135074, 'recall': 0.3013484701129648, 'f1-score': 0.3444681988241582, 'support': 106936}, 'accuracy': 0.40144394574996334, 'macro avg': {'precision': 0.4065283949009268, 'recall': 0.387350049345812, 'f1-score': 0.3793619586460053, 'support': 347797}, 'weighted avg': {'precision': 0.4058308384673775, 'recall': 0.40144394574996334, 'f1-score': 0.3856269112354523, 'support': 347797}}
[[27540 63619 18884]
 [21907 79856 29055]
 [15594 59117 32225]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0800784
{'0': {'precision': 0.4199508069865134, 'recall': 0.2701926581850834, 'f1-score': 0.3288232971051735, 'support': 112479}, '1': {'precision': 0.3711456294331839, 'recall': 0.5667794322080886, 'f1-score': 0.4485597362086674, 'support': 124447}, '2': {'precision': 0.4030801663055572, 'recall': 0.3104238258877434, 'f1-score': 0.35073577368335235, 'support': 110871}, 'accuracy': 0.3891407918987225, 'macro avg': {'precision': 0.39805886757508485, 'recall': 0.3824653054269718, 'f1-score': 0.37603960233239775, 'support': 347797}, 'weighted avg': {'precision': 0.39710954402588555, 'recall': 0.3891407918987225, 'f1-score': 0.3786520731665305, 'support': 347797}}
[[30391 61415 20673]
 [23618 70534 30295]
 [18359 58095 34417]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0839571
{'0': {'precision': 0.4151248450074153, 'recall': 0.29830967460144137, 'f1-score': 0.3471538144832949, 'support': 114475}, '1': {'precision': 0.36593552597841544, 'recall': 0.5185252466867595, 'f1-score': 0.42906777721218003, 'support': 121105}, '2': {'precision': 0.4000383260052592, 'recall': 0.33485122575010917, 'f1-score': 0.3645536216698682, 'support': 112217}, 'accuracy': 0.38678021949585534, 'macro avg': {'precision': 0.3936995656636966, 'recall': 0.3838953823461034, 'f1-score': 0.38025840445511433, 'support': 347797}, 'weighted avg': {'precision': 0.3931291510138732, 'recall': 0.38678021949585534, 'f1-score': 0.38129080997013726, 'support': 347797}}
[[34149 56158 24168]
 [26122 62796 32187]
 [21991 52650 37576]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0988119
{'0': {'precision': 0.42843108035014515, 'recall': 0.31052829494267403, 'f1-score': 0.36007384798077724, 'support': 124987}, '1': {'precision': 0.31156646065153615, 'recall': 0.48238123039472774, 'f1-score': 0.37859877756118016, 'support': 101057}, '2': {'precision': 0.4225519876916969, 'recall': 0.3496423086084121, 'f1-score': 0.3826551249898876, 'support': 121753}, 'accuracy': 0.3741550387151126, 'macro avg': {'precision': 0.38751650956445943, 'recall': 0.38085061131527126, 'f1-score': 0.3737759168439483, 'support': 347797}, 'weighted avg': {'precision': 0.39241643663175085, 'recall': 0.3741550387151126, 'f1-score': 0.37336151874359863, 'support': 347797}}
[[38812 56305 29870]
 [24004 48748 28305]
 [27775 51408 42570]]
Evaluating performance on  train set...
444/444 - 5s - 5s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0711533
{'0': {'precision': 0.4623354295796951, 'recall': 0.27205686598157713, 'f1-score': 0.34254588116986506, 'support': 37562}, '1': {'precision': 0.3710702240423994, 'recall': 0.6438928804702808, 'f1-score': 0.47081411009542373, 'support': 38275}, '2': {'precision': 0.44712593242650284, 'recall': 0.29691928690630714, 'f1-score': 0.3568608723336517, 'support': 37751}, 'accuracy': 0.4056150297566644, 'macro avg': {'precision': 0.4268438620161991, 'recall': 0.404289677786055, 'f1-score': 0.3900736211996468, 'support': 113588}, 'weighted avg': {'precision': 0.426527514404059, 'recall': 0.4056150297566644, 'f1-score': 0.3905251720593065, 'support': 113588}}
[[10219 20982  6361]
 [ 6131 24645  7499]
 [ 5753 20789 11209]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0723406
{'0': {'precision': 0.45458064016720207, 'recall': 0.3126330919931857, 'f1-score': 0.37047551454932576, 'support': 37568}, '1': {'precision': 0.36282262677928456, 'recall': 0.5697526949904883, 'f1-score': 0.4433297012808125, 'support': 37848}, '2': {'precision': 0.4475756612635519, 'recall': 0.33202347270250443, 'f1-score': 0.3812359939238069, 'support': 38172}, 'accuracy': 0.4048226925379442, 'macro avg': {'precision': 0.4216596427366795, 'recall': 0.4048030865620595, 'f1-score': 0.3983470699179817, 'support': 113588}, 'weighted avg': {'precision': 0.4216524140745159, 'recall': 0.4048226925379442, 'f1-score': 0.3983669667986479, 'support': 113588}}
[[11745 18945  6878]
 [ 7519 21564  8765]
 [ 6573 18925 12674]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.073685
{'0': {'precision': 0.4421800473633301, 'recall': 0.35335981021936724, 'f1-score': 0.3928116388633738, 'support': 37517}, '1': {'precision': 0.36010862292888346, 'recall': 0.4870907639073729, 'f1-score': 0.41408335973209026, 'support': 37570}, '2': {'precision': 0.44304492360242764, 'recall': 0.3773148749383133, 'f1-score': 0.40754664048253614, 'support': 38501}, 'accuracy': 0.4057118709722858, 'macro avg': {'precision': 0.41511119796488044, 'recall': 0.4059218163550178, 'f1-score': 0.40481387969266674, 'support': 113588}, 'weighted avg': {'precision': 0.4153275205478156, 'recall': 0.4057118709722858, 'f1-score': 0.40484187841664565, 'support': 113588}}
[[13257 16323  7937]
 [ 8945 18300 10325]
 [ 7779 16195 14527]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0776582
{'0': {'precision': 0.42533075575424395, 'recall': 0.3761151770927934, 'f1-score': 0.3992118394193695, 'support': 37438}, '1': {'precision': 0.3623348265538122, 'recall': 0.42895213729879544, 'f1-score': 0.39283927416500913, 'support': 37524}, '2': {'precision': 0.43168141102082697, 'recall': 0.40299280277533267, 'f1-score': 0.41684407846287747, 'support': 38626}, 'accuracy': 0.40270979328802337, 'macro avg': {'precision': 0.4064489977762944, 'recall': 0.4026867057223072, 'f1-score': 0.40296506401575205, 'support': 113588}, 'weighted avg': {'precision': 0.4066795000142894, 'recall': 0.40270979328802337, 'f1-score': 0.40310255610326146, 'support': 113588}}
[[14081 14263  9094]
 [10029 16096 11399]
 [ 8996 14064 15566]]
Evaluating performance on  val set...
144/144 - 2s - 2s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.068933
{'0': {'precision': 0.43209267931969436, 'recall': 0.2986880218095076, 'f1-score': 0.3532137819867016, 'support': 11738}, '1': {'precision': 0.3853946397836243, 'recall': 0.5929036162808292, 'f1-score': 0.4671415372693947, 'support': 13218}, '2': {'precision': 0.44586842426461615, 'recall': 0.31259626903987675, 'f1-score': 0.36752351727954113, 'support': 11686}, 'accuracy': 0.4092571366191802, 'macro avg': {'precision': 0.421118581122645, 'recall': 0.4013959690434045, 'f1-score': 0.39595961217854586, 'support': 36642}, 'weighted avg': {'precision': 0.41964053884806574, 'recall': 0.4092571366191802, 'f1-score': 0.3988750623742012, 'support': 36642}}
[[3506 6398 1834]
 [2675 7837 2706]
 [1933 6100 3653]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0737247
{'0': {'precision': 0.4387238723872387, 'recall': 0.3313117886516574, 'f1-score': 0.37752638803426897, 'support': 12037}, '1': {'precision': 0.36308108108108106, 'recall': 0.5353897656623625, 'f1-score': 0.4327127488243252, 'support': 12546}, '2': {'precision': 0.44365885992045956, 'recall': 0.3330292727423501, 'f1-score': 0.38046516034294914, 'support': 12059}, 'accuracy': 0.4017520877681349, 'macro avg': {'precision': 0.41515460446292646, 'recall': 0.3999102756854567, 'f1-score': 0.39690143240051445, 'support': 36642}, 'weighted avg': {'precision': 0.41444835672040986, 'recall': 0.4017520877681349, 'f1-score': 0.3973890248374571, 'support': 36642}}
[[3988 5977 2072]
 [2865 6717 2964]
 [2237 5806 4016]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0774096
{'0': {'precision': 0.43366996764388666, 'recall': 0.35874766809960257, 'f1-score': 0.3926669034090909, 'support': 12329}, '1': {'precision': 0.3447978834676675, 'recall': 0.4672336168084042, 'f1-score': 0.3967854993450632, 'support': 11994}, '2': {'precision': 0.447693817468106, 'recall': 0.3703222664177287, 'f1-score': 0.4053489715225021, 'support': 12319}, 'accuracy': 0.3981496643196332, 'macro avg': {'precision': 0.40872055619322006, 'recall': 0.3987678504419119, 'f1-score': 0.39826712475888537, 'support': 36642}, 'weighted avg': {'precision': 0.40929433390050435, 'recall': 0.3981496643196332, 'f1-score': 0.3982787378271129, 'support': 36642}}
[[4423 5521 2385]
 [3147 5604 3243]
 [2629 5128 4562]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.085256
{'0': {'precision': 0.4327559626371633, 'recall': 0.37551148882593643, 'f1-score': 0.4021065936380872, 'support': 12708}, '1': {'precision': 0.33119190814652816, 'recall': 0.43014379549085746, 'f1-score': 0.37423739284886864, 'support': 11266}, '2': {'precision': 0.4431393972502959, 'recall': 0.3841964003789075, 'f1-score': 0.4115682212168619, 'support': 12668}, 'accuracy': 0.3953113912996016, 'macro avg': {'precision': 0.4023624226779958, 'recall': 0.3966172282319005, 'f1-score': 0.3959707359012726, 'support': 36642}, 'weighted avg': {'precision': 0.40511873518745173, 'recall': 0.3953113912996016, 'f1-score': 0.39680899749367865, 'support': 36642}}
[[4772 5027 2909]
 [3213 4846 3207]
 [3042 4759 4867]]
training model: results/XRAY/W3/deepLOB_L2/seq2seq
Epoch 1/50
444/444 - 29s - loss: 13.2189 - accuracy10: 0.3717 - accuracy20: 0.3644 - accuracy30: 0.3595 - accuracy50: 0.3583 - val_loss: 13.1465 - val_accuracy10: 0.3738 - val_accuracy20: 0.3663 - val_accuracy30: 0.3628 - val_accuracy50: 0.3679 - 29s/epoch - 66ms/step
Epoch 2/50
444/444 - 23s - loss: 13.0774 - accuracy10: 0.3846 - accuracy20: 0.3774 - accuracy30: 0.3724 - accuracy50: 0.3693 - val_loss: 13.1632 - val_accuracy10: 0.3876 - val_accuracy20: 0.3753 - val_accuracy30: 0.3663 - val_accuracy50: 0.3494 - 23s/epoch - 52ms/step
Epoch 3/50
444/444 - 23s - loss: 12.9683 - accuracy10: 0.4137 - accuracy20: 0.3986 - accuracy30: 0.3873 - accuracy50: 0.3785 - val_loss: 12.9566 - val_accuracy10: 0.4116 - val_accuracy20: 0.4063 - val_accuracy30: 0.3983 - val_accuracy50: 0.3842 - 23s/epoch - 52ms/step
Epoch 4/50
444/444 - 23s - loss: 12.8908 - accuracy10: 0.4319 - accuracy20: 0.4149 - accuracy30: 0.4023 - accuracy50: 0.3930 - val_loss: 12.9654 - val_accuracy10: 0.4102 - val_accuracy20: 0.4016 - val_accuracy30: 0.3916 - val_accuracy50: 0.3882 - 23s/epoch - 52ms/step
Epoch 5/50
444/444 - 24s - loss: 12.8263 - accuracy10: 0.4428 - accuracy20: 0.4243 - accuracy30: 0.4112 - accuracy50: 0.4007 - val_loss: 12.9057 - val_accuracy10: 0.4286 - val_accuracy20: 0.4167 - val_accuracy30: 0.4067 - val_accuracy50: 0.4031 - 24s/epoch - 53ms/step
Epoch 6/50
444/444 - 23s - loss: 12.7697 - accuracy10: 0.4504 - accuracy20: 0.4317 - accuracy30: 0.4177 - accuracy50: 0.4070 - val_loss: 12.8083 - val_accuracy10: 0.4378 - val_accuracy20: 0.4239 - val_accuracy30: 0.4124 - val_accuracy50: 0.4034 - 23s/epoch - 52ms/step
Epoch 7/50
444/444 - 23s - loss: 12.7190 - accuracy10: 0.4571 - accuracy20: 0.4386 - accuracy30: 0.4233 - accuracy50: 0.4136 - val_loss: 12.8630 - val_accuracy10: 0.4364 - val_accuracy20: 0.4234 - val_accuracy30: 0.4101 - val_accuracy50: 0.4000 - 23s/epoch - 51ms/step
Epoch 8/50
444/444 - 23s - loss: 12.6843 - accuracy10: 0.4602 - accuracy20: 0.4412 - accuracy30: 0.4250 - accuracy50: 0.4141 - val_loss: 12.8552 - val_accuracy10: 0.4364 - val_accuracy20: 0.4263 - val_accuracy30: 0.4143 - val_accuracy50: 0.4048 - 23s/epoch - 52ms/step
Epoch 9/50
444/444 - 23s - loss: 12.6447 - accuracy10: 0.4667 - accuracy20: 0.4452 - accuracy30: 0.4302 - accuracy50: 0.4162 - val_loss: 12.8508 - val_accuracy10: 0.4387 - val_accuracy20: 0.4251 - val_accuracy30: 0.4127 - val_accuracy50: 0.4035 - 23s/epoch - 52ms/step
Epoch 10/50
444/444 - 24s - loss: 12.6157 - accuracy10: 0.4677 - accuracy20: 0.4473 - accuracy30: 0.4325 - accuracy50: 0.4196 - val_loss: 12.8564 - val_accuracy10: 0.4370 - val_accuracy20: 0.4212 - val_accuracy30: 0.4062 - val_accuracy50: 0.3971 - 24s/epoch - 53ms/step
Epoch 11/50
444/444 - 23s - loss: 12.5716 - accuracy10: 0.4744 - accuracy20: 0.4533 - accuracy30: 0.4365 - accuracy50: 0.4214 - val_loss: 12.8024 - val_accuracy10: 0.4385 - val_accuracy20: 0.4234 - val_accuracy30: 0.4100 - val_accuracy50: 0.4006 - 23s/epoch - 52ms/step
Epoch 12/50
444/444 - 23s - loss: 12.5263 - accuracy10: 0.4783 - accuracy20: 0.4569 - accuracy30: 0.4414 - accuracy50: 0.4277 - val_loss: 12.8153 - val_accuracy10: 0.4431 - val_accuracy20: 0.4249 - val_accuracy30: 0.4107 - val_accuracy50: 0.4035 - 23s/epoch - 52ms/step
Epoch 13/50
444/444 - 23s - loss: 12.4926 - accuracy10: 0.4811 - accuracy20: 0.4618 - accuracy30: 0.4471 - accuracy50: 0.4323 - val_loss: 12.8695 - val_accuracy10: 0.4417 - val_accuracy20: 0.4250 - val_accuracy30: 0.4094 - val_accuracy50: 0.4025 - 23s/epoch - 51ms/step
Epoch 14/50
444/444 - 23s - loss: 12.4626 - accuracy10: 0.4837 - accuracy20: 0.4635 - accuracy30: 0.4484 - accuracy50: 0.4330 - val_loss: 12.8172 - val_accuracy10: 0.4358 - val_accuracy20: 0.4217 - val_accuracy30: 0.4090 - val_accuracy50: 0.4000 - 23s/epoch - 52ms/step
Epoch 15/50
444/444 - 23s - loss: 12.4354 - accuracy10: 0.4856 - accuracy20: 0.4661 - accuracy30: 0.4511 - accuracy50: 0.4370 - val_loss: 12.7554 - val_accuracy10: 0.4463 - val_accuracy20: 0.4304 - val_accuracy30: 0.4171 - val_accuracy50: 0.4054 - 23s/epoch - 52ms/step
Epoch 16/50
444/444 - 23s - loss: 12.4030 - accuracy10: 0.4874 - accuracy20: 0.4692 - accuracy30: 0.4546 - accuracy50: 0.4397 - val_loss: 12.7748 - val_accuracy10: 0.4434 - val_accuracy20: 0.4274 - val_accuracy30: 0.4139 - val_accuracy50: 0.4053 - 23s/epoch - 52ms/step
Epoch 17/50
444/444 - 23s - loss: 12.3825 - accuracy10: 0.4908 - accuracy20: 0.4724 - accuracy30: 0.4571 - accuracy50: 0.4415 - val_loss: 12.8456 - val_accuracy10: 0.4391 - val_accuracy20: 0.4247 - val_accuracy30: 0.4116 - val_accuracy50: 0.4030 - 23s/epoch - 51ms/step
Epoch 18/50
444/444 - 23s - loss: 12.3531 - accuracy10: 0.4914 - accuracy20: 0.4739 - accuracy30: 0.4612 - accuracy50: 0.4466 - val_loss: 12.8427 - val_accuracy10: 0.4390 - val_accuracy20: 0.4252 - val_accuracy30: 0.4114 - val_accuracy50: 0.4066 - 23s/epoch - 52ms/step
Epoch 19/50
444/444 - 23s - loss: 12.3152 - accuracy10: 0.4953 - accuracy20: 0.4777 - accuracy30: 0.4631 - accuracy50: 0.4498 - val_loss: 12.8719 - val_accuracy10: 0.4398 - val_accuracy20: 0.4238 - val_accuracy30: 0.4132 - val_accuracy50: 0.4069 - 23s/epoch - 51ms/step
Epoch 20/50
444/444 - 23s - loss: 12.2877 - accuracy10: 0.4958 - accuracy20: 0.4785 - accuracy30: 0.4644 - accuracy50: 0.4506 - val_loss: 12.8360 - val_accuracy10: 0.4426 - val_accuracy20: 0.4277 - val_accuracy30: 0.4170 - val_accuracy50: 0.4096 - 23s/epoch - 52ms/step
Epoch 21/50
444/444 - 23s - loss: 12.2457 - accuracy10: 0.5003 - accuracy20: 0.4847 - accuracy30: 0.4701 - accuracy50: 0.4545 - val_loss: 12.8917 - val_accuracy10: 0.4406 - val_accuracy20: 0.4265 - val_accuracy30: 0.4140 - val_accuracy50: 0.4080 - 23s/epoch - 52ms/step
Epoch 22/50
444/444 - 23s - loss: 12.2116 - accuracy10: 0.5000 - accuracy20: 0.4848 - accuracy30: 0.4728 - accuracy50: 0.4571 - val_loss: 12.8860 - val_accuracy10: 0.4403 - val_accuracy20: 0.4236 - val_accuracy30: 0.4155 - val_accuracy50: 0.4081 - 23s/epoch - 52ms/step
Epoch 23/50
444/444 - 23s - loss: 12.1988 - accuracy10: 0.5033 - accuracy20: 0.4874 - accuracy30: 0.4737 - accuracy50: 0.4599 - val_loss: 12.9408 - val_accuracy10: 0.4343 - val_accuracy20: 0.4218 - val_accuracy30: 0.4115 - val_accuracy50: 0.4003 - 23s/epoch - 52ms/step
Epoch 24/50
444/444 - 23s - loss: 12.1812 - accuracy10: 0.5022 - accuracy20: 0.4878 - accuracy30: 0.4754 - accuracy50: 0.4606 - val_loss: 12.9338 - val_accuracy10: 0.4388 - val_accuracy20: 0.4233 - val_accuracy30: 0.4113 - val_accuracy50: 0.4060 - 23s/epoch - 52ms/step
Epoch 25/50
444/444 - 23s - loss: 12.1538 - accuracy10: 0.5057 - accuracy20: 0.4894 - accuracy30: 0.4774 - accuracy50: 0.4635 - val_loss: 13.0376 - val_accuracy10: 0.4292 - val_accuracy20: 0.4177 - val_accuracy30: 0.4089 - val_accuracy50: 0.4029 - 23s/epoch - 52ms/step
testing model: results/XRAY/W3/deepLOB_L2/seq2seq
Evaluating performance on  test set...
1359/1359 - 27s - 27s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0436329
{'0': {'precision': 0.4304147465437788, 'recall': 0.5262210913717116, 'f1-score': 0.4735204530122452, 'support': 110045}, '1': {'precision': 0.4849644760213144, 'recall': 0.41742407448459323, 'f1-score': 0.4486667022705705, 'support': 130819}, '2': {'precision': 0.4511081749634913, 'recall': 0.42463319524579896, 'f1-score': 0.4374704958621952, 'support': 106937}, 'accuracy': 0.4540642493839868, 'macro avg': {'precision': 0.4554957991761948, 'recall': 0.45609278703403455, 'f1-score': 0.45321921704833695, 'support': 347801}, 'weighted avg': {'precision': 0.45729515866289444, 'recall': 0.4540642493839868, 'f1-score': 0.45308803020141364, 'support': 347801}}
[[57908 30613 21524]
 [42484 54607 33728]
 [34148 27380 45409]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0600001
{'0': {'precision': 0.4207122794539239, 'recall': 0.5153492589859621, 'f1-score': 0.4632468113671962, 'support': 112481}, '1': {'precision': 0.4521505019575872, 'recall': 0.38326047827204934, 'f1-score': 0.4148650705634201, 'support': 124448}, '2': {'precision': 0.44095053142130086, 'recall': 0.4157316545205282, 'f1-score': 0.42796989828368226, 'support': 110872}, 'accuracy': 0.4363299702991078, 'macro avg': {'precision': 0.43793777094427067, 'recall': 0.4381137972595132, 'f1-score': 0.4353605934047662, 'support': 347801}, 'weighted avg': {'precision': 0.4384128593437543, 'recall': 0.4363299702991078, 'f1-score': 0.43468958241459493, 'support': 347801}}
[[57967 30400 24114]
 [42428 47696 34324]
 [37388 27391 46093]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0748572
{'0': {'precision': 0.4055374943483971, 'recall': 0.4936144936144936, 'f1-score': 0.44526217501447884, 'support': 114478}, '1': {'precision': 0.42052516325040934, 'recall': 0.35202510218405514, 'f1-score': 0.3832382698902837, 'support': 121105}, '2': {'precision': 0.42823256943277116, 'recall': 0.40863319610044735, 'f1-score': 0.418203374373005, 'support': 112218}, 'accuracy': 0.41689356844862435, 'macro avg': {'precision': 0.4180984090105258, 'recall': 0.4180909306329987, 'f1-score': 0.4155679397592558, 'support': 347801}, 'weighted avg': {'precision': 0.41807879692716043, 'recall': 0.41689356844862435, 'f1-score': 0.4149348052816415, 'support': 347801}}
[[56508 31001 26969]
 [44216 42632 34257]
 [38617 27745 45856]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0893323
{'0': {'precision': 0.41430836220687084, 'recall': 0.4620769661572926, 'f1-score': 0.4368908170096562, 'support': 124990}, '1': {'precision': 0.3414058419382056, 'recall': 0.3363349396875031, 'f1-score': 0.3388514203964848, 'support': 101057}, '2': {'precision': 0.4342453419572967, 'recall': 0.38820079833106097, 'f1-score': 0.40993417115499703, 'support': 121754}, 'accuracy': 0.39967970189849944, 'macro avg': {'precision': 0.39665318203412436, 'recall': 0.3955375680586189, 'f1-score': 0.39522546952037935, 'support': 347801}, 'weighted avg': {'precision': 0.4001051167928061, 'recall': 0.39967970189849944, 'f1-score': 0.3989678473720605, 'support': 347801}}
[[57755 34844 32391]
 [37880 33989 29188]
 [43766 30723 47265]]
Evaluating performance on  train set...
444/444 - 9s - 9s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0416187
{'0': {'precision': 0.4363980594012543, 'recall': 0.5895768943834594, 'f1-score': 0.5015526190530157, 'support': 37532}, '1': {'precision': 0.4687894592368927, 'recall': 0.44661209759669446, 'f1-score': 0.4574321338172468, 'support': 38239}, '2': {'precision': 0.4849355460628284, 'recall': 0.33920355386323975, 'f1-score': 0.3991847022762988, 'support': 37818}, 'accuracy': 0.4580901319670038, 'macro avg': {'precision': 0.46337435490032514, 'recall': 0.4584641819477979, 'f1-score': 0.4527231517155204, 'support': 113589}, 'weighted avg': {'precision': 0.46346234739465497, 'recall': 0.4580901319670038, 'f1-score': 0.45261765957989375, 'support': 113589}}
[[22128  9600  5804]
 [13340 17078  7821]
 [15238  9752 12828]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.056689
{'0': {'precision': 0.41948680520877346, 'recall': 0.5809549142173162, 'f1-score': 0.4871906403006881, 'support': 37595}, '1': {'precision': 0.4475263020606904, 'recall': 0.40760783485560426, 'f1-score': 0.426635352628307, 'support': 37882}, '2': {'precision': 0.47072538860103624, 'recall': 0.3337269101595298, 'f1-score': 0.3905607074863355, 'support': 38112}, 'accuracy': 0.44019227213902756, 'macro avg': {'precision': 0.44591283195683334, 'recall': 0.44076321974415006, 'f1-score': 0.4347955668051102, 'support': 113589}, 'weighted avg': {'precision': 0.44602984291480335, 'recall': 0.44019227213902756, 'f1-score': 0.43457361394227534, 'support': 113589}}
[[21841  9417  6337]
 [14477 15441  7964]
 [15748  9645 12719]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0660654
{'0': {'precision': 0.40675305022226427, 'recall': 0.573596884336321, 'f1-score': 0.47597755470211284, 'support': 37488}, '1': {'precision': 0.4322678391064108, 'recall': 0.38722124647400075, 'f1-score': 0.40850645704660304, 'support': 37578}, '2': {'precision': 0.4584287931416747, 'recall': 0.32204137787815074, 'f1-score': 0.37831821300602275, 'support': 38523}, 'accuracy': 0.42662581764079266, 'macro avg': {'precision': 0.43248322749011653, 'recall': 0.4276198362294908, 'f1-score': 0.4209340749182462, 'support': 113589}, 'weighted avg': {'precision': 0.43271946757934027, 'recall': 0.42662581764079266, 'f1-score': 0.4205359210240522, 'support': 113589}}
[[21503  9398  6587]
 [14958 14551  8069]
 [16404  9713 12406]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.074065
{'0': {'precision': 0.3931430297538136, 'recall': 0.5566277298120873, 'f1-score': 0.46081501233693667, 'support': 37411}, '1': {'precision': 0.4216963809749452, 'recall': 0.3800106752068321, 'f1-score': 0.3997697793250603, 'support': 37470}, '2': {'precision': 0.4352262148575684, 'recall': 0.30195308463366743, 'f1-score': 0.35654256211582747, 'support': 38708}, 'accuracy': 0.41158034668849974, 'macro avg': {'precision': 0.41668854186210913, 'recall': 0.4128638298841956, 'f1-score': 0.4057091179259415, 'support': 113589}, 'weighted avg': {'precision': 0.41690281282481473, 'recall': 0.41158034668849974, 'f1-score': 0.4051446315420208, 'support': 113589}}
[[20824  9592  6995]
 [15059 14239  8172]
 [17085  9935 11688]]
Evaluating performance on  val set...
144/144 - 3s - 3s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0462799
{'0': {'precision': 0.4456093389843111, 'recall': 0.5090893645939517, 'f1-score': 0.47523888822806387, 'support': 11772}, '1': {'precision': 0.47705146036161333, 'recall': 0.362825840574235, 'f1-score': 0.4121711514527273, 'support': 13235}, '2': {'precision': 0.4176125542774434, 'recall': 0.4711645896003438, 'f1-score': 0.44277522009530734, 'support': 11635}, 'accuracy': 0.4442170187216855, 'macro avg': {'precision': 0.4467577845411226, 'recall': 0.4476932649228435, 'f1-score': 0.44339508659203286, 'support': 36642}, 'weighted avg': {'precision': 0.44807628637703506, 'recall': 0.4442170187216855, 'f1-score': 0.44215073051434195, 'support': 36642}}
[[5993 2733 3046]
 [3834 4802 4599]
 [3622 2531 5482]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0603206
{'0': {'precision': 0.430480137182052, 'recall': 0.4995854063018242, 'f1-score': 0.46246545901136016, 'support': 12060}, '1': {'precision': 0.4456132968651378, 'recall': 0.33847383140231724, 'f1-score': 0.3847236728577267, 'support': 12515}, '2': {'precision': 0.41811263318112635, 'recall': 0.4552912902958482, 'f1-score': 0.4359106597373745, 'support': 12067}, 'accuracy': 0.42997107144806507, 'macro avg': {'precision': 0.43140202240943876, 'recall': 0.43111684266666317, 'f1-score': 0.4276999305354871, 'support': 36642}, 'weighted avg': {'precision': 0.43157595134761745, 'recall': 0.42997107144806507, 'f1-score': 0.4271678438006209, 'support': 36642}}
[[6025 2719 3316]
 [3949 4236 4330]
 [4022 2551 5494]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0701613
{'0': {'precision': 0.4173415247137671, 'recall': 0.48432309811229035, 'f1-score': 0.4483443956950538, 'support': 12343}, '1': {'precision': 0.41044454035390593, 'recall': 0.31692076980754813, 'f1-score': 0.35767006722768085, 'support': 12003}, '2': {'precision': 0.40873563218390807, 'recall': 0.4337996096291477, 'f1-score': 0.42089481575001975, 'support': 12296}, 'accuracy': 0.41253206702690903, 'macro avg': {'precision': 0.4121738990838604, 'recall': 0.4116811591829954, 'f1-score': 0.40896975955758474, 'support': 36642}, 'weighted avg': {'precision': 0.41219435595063847, 'recall': 0.41253206702690903, 'f1-score': 0.4094304717935742, 'support': 36642}}
[[5978 2819 3546]
 [4029 3804 4170]
 [4317 2645 5334]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0785494
{'0': {'precision': 0.40631770214550283, 'recall': 0.45736312146003777, 'f1-score': 0.4303319640279782, 'support': 12712}, '1': {'precision': 0.3926634768740032, 'recall': 0.32814999111427046, 'f1-score': 0.3575197250592962, 'support': 11254}, '2': {'precision': 0.40539913366336633, 'recall': 0.41345850426001896, 'f1-score': 0.4093891579440712, 'support': 12676}, 'accuracy': 0.40248894710987393, 'macro avg': {'precision': 0.4014601042276242, 'recall': 0.3996572056114424, 'f1-score': 0.39908028234378184, 'support': 36642}, 'weighted avg': {'precision': 0.40180625557367217, 'recall': 0.40248894710987393, 'f1-score': 0.4007238654724094, 'support': 36642}}
[[5814 2982 3916]
 [3790 3693 3771]
 [4705 2730 5241]]
training model: results/XRAY/W3/deepOF_L2/seq2seq
Epoch 1/50
444/444 - 21s - loss: 13.0447 - accuracy10: 0.4052 - accuracy20: 0.3916 - accuracy30: 0.3818 - accuracy50: 0.3760 - val_loss: 12.8164 - val_accuracy10: 0.4415 - val_accuracy20: 0.4239 - val_accuracy30: 0.4060 - val_accuracy50: 0.3927 - 21s/epoch - 48ms/step
Epoch 2/50
444/444 - 15s - loss: 12.8204 - accuracy10: 0.4447 - accuracy20: 0.4243 - accuracy30: 0.4112 - accuracy50: 0.3997 - val_loss: 12.7001 - val_accuracy10: 0.4557 - val_accuracy20: 0.4377 - val_accuracy30: 0.4217 - val_accuracy50: 0.4061 - 15s/epoch - 35ms/step
Epoch 3/50
444/444 - 15s - loss: 12.6973 - accuracy10: 0.4584 - accuracy20: 0.4380 - accuracy30: 0.4245 - accuracy50: 0.4149 - val_loss: 12.6412 - val_accuracy10: 0.4656 - val_accuracy20: 0.4463 - val_accuracy30: 0.4268 - val_accuracy50: 0.4115 - 15s/epoch - 34ms/step
Epoch 4/50
444/444 - 15s - loss: 12.6161 - accuracy10: 0.4684 - accuracy20: 0.4469 - accuracy30: 0.4309 - accuracy50: 0.4184 - val_loss: 12.6086 - val_accuracy10: 0.4749 - val_accuracy20: 0.4529 - val_accuracy30: 0.4341 - val_accuracy50: 0.4122 - 15s/epoch - 34ms/step
Epoch 5/50
444/444 - 16s - loss: 12.5421 - accuracy10: 0.4761 - accuracy20: 0.4526 - accuracy30: 0.4393 - accuracy50: 0.4266 - val_loss: 12.5999 - val_accuracy10: 0.4810 - val_accuracy20: 0.4537 - val_accuracy30: 0.4318 - val_accuracy50: 0.4143 - 16s/epoch - 35ms/step
Epoch 6/50
444/444 - 16s - loss: 12.4870 - accuracy10: 0.4842 - accuracy20: 0.4603 - accuracy30: 0.4443 - accuracy50: 0.4322 - val_loss: 12.5715 - val_accuracy10: 0.4874 - val_accuracy20: 0.4595 - val_accuracy30: 0.4361 - val_accuracy50: 0.4135 - 16s/epoch - 35ms/step
Epoch 7/50
444/444 - 15s - loss: 12.4381 - accuracy10: 0.4877 - accuracy20: 0.4643 - accuracy30: 0.4485 - accuracy50: 0.4372 - val_loss: 12.5775 - val_accuracy10: 0.4904 - val_accuracy20: 0.4598 - val_accuracy30: 0.4347 - val_accuracy50: 0.4119 - 15s/epoch - 34ms/step
Epoch 8/50
444/444 - 15s - loss: 12.3911 - accuracy10: 0.4932 - accuracy20: 0.4696 - accuracy30: 0.4520 - accuracy50: 0.4394 - val_loss: 12.5915 - val_accuracy10: 0.4879 - val_accuracy20: 0.4554 - val_accuracy30: 0.4356 - val_accuracy50: 0.4123 - 15s/epoch - 33ms/step
Epoch 9/50
444/444 - 15s - loss: 12.3537 - accuracy10: 0.4948 - accuracy20: 0.4728 - accuracy30: 0.4568 - accuracy50: 0.4431 - val_loss: 12.5661 - val_accuracy10: 0.4921 - val_accuracy20: 0.4605 - val_accuracy30: 0.4371 - val_accuracy50: 0.4146 - 15s/epoch - 34ms/step
Epoch 10/50
444/444 - 15s - loss: 12.3134 - accuracy10: 0.4988 - accuracy20: 0.4758 - accuracy30: 0.4595 - accuracy50: 0.4472 - val_loss: 12.5888 - val_accuracy10: 0.4871 - val_accuracy20: 0.4585 - val_accuracy30: 0.4338 - val_accuracy50: 0.4129 - 15s/epoch - 33ms/step
Epoch 11/50
444/444 - 15s - loss: 12.2749 - accuracy10: 0.5032 - accuracy20: 0.4799 - accuracy30: 0.4633 - accuracy50: 0.4506 - val_loss: 12.5949 - val_accuracy10: 0.4930 - val_accuracy20: 0.4588 - val_accuracy30: 0.4356 - val_accuracy50: 0.4127 - 15s/epoch - 33ms/step
Epoch 12/50
444/444 - 15s - loss: 12.2403 - accuracy10: 0.5058 - accuracy20: 0.4832 - accuracy30: 0.4674 - accuracy50: 0.4536 - val_loss: 12.6094 - val_accuracy10: 0.4884 - val_accuracy20: 0.4595 - val_accuracy30: 0.4348 - val_accuracy50: 0.4137 - 15s/epoch - 34ms/step
Epoch 13/50
444/444 - 15s - loss: 12.2036 - accuracy10: 0.5090 - accuracy20: 0.4863 - accuracy30: 0.4699 - accuracy50: 0.4583 - val_loss: 12.6415 - val_accuracy10: 0.4891 - val_accuracy20: 0.4556 - val_accuracy30: 0.4313 - val_accuracy50: 0.4123 - 15s/epoch - 34ms/step
Epoch 14/50
444/444 - 15s - loss: 12.1699 - accuracy10: 0.5101 - accuracy20: 0.4891 - accuracy30: 0.4730 - accuracy50: 0.4594 - val_loss: 12.6156 - val_accuracy10: 0.4926 - val_accuracy20: 0.4588 - val_accuracy30: 0.4347 - val_accuracy50: 0.4138 - 15s/epoch - 33ms/step
Epoch 15/50
444/444 - 15s - loss: 12.1445 - accuracy10: 0.5119 - accuracy20: 0.4907 - accuracy30: 0.4752 - accuracy50: 0.4649 - val_loss: 12.6618 - val_accuracy10: 0.4856 - val_accuracy20: 0.4555 - val_accuracy30: 0.4318 - val_accuracy50: 0.4129 - 15s/epoch - 33ms/step
Epoch 16/50
444/444 - 15s - loss: 12.1146 - accuracy10: 0.5138 - accuracy20: 0.4935 - accuracy30: 0.4779 - accuracy50: 0.4660 - val_loss: 12.6771 - val_accuracy10: 0.4879 - val_accuracy20: 0.4543 - val_accuracy30: 0.4324 - val_accuracy50: 0.4131 - 15s/epoch - 33ms/step
Epoch 17/50
444/444 - 15s - loss: 12.0753 - accuracy10: 0.5165 - accuracy20: 0.4972 - accuracy30: 0.4813 - accuracy50: 0.4710 - val_loss: 12.6976 - val_accuracy10: 0.4854 - val_accuracy20: 0.4528 - val_accuracy30: 0.4299 - val_accuracy50: 0.4127 - 15s/epoch - 34ms/step
Epoch 18/50
444/444 - 15s - loss: 12.0358 - accuracy10: 0.5194 - accuracy20: 0.5011 - accuracy30: 0.4867 - accuracy50: 0.4733 - val_loss: 12.7039 - val_accuracy10: 0.4874 - val_accuracy20: 0.4519 - val_accuracy30: 0.4301 - val_accuracy50: 0.4125 - 15s/epoch - 34ms/step
Epoch 19/50
444/444 - 15s - loss: 11.9972 - accuracy10: 0.5217 - accuracy20: 0.5053 - accuracy30: 0.4899 - accuracy50: 0.4773 - val_loss: 12.7107 - val_accuracy10: 0.4865 - val_accuracy20: 0.4539 - val_accuracy30: 0.4302 - val_accuracy50: 0.4104 - 15s/epoch - 34ms/step
testing model: results/XRAY/W3/deepOF_L2/seq2seq
Evaluating performance on  test set...
1359/1359 - 20s - 20s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0121607
{'0': {'precision': 0.5093519213743795, 'recall': 0.4130294521232609, 'f1-score': 0.4561613039201911, 'support': 110043}, '1': {'precision': 0.47542748359754783, 'recall': 0.6414407803207509, 'f1-score': 0.5460958752554373, 'support': 130818}, '2': {'precision': 0.49595447566592743, 'recall': 0.3806108326475649, 'f1-score': 0.4306938550914805, 'support': 106936}, 'accuracy': 0.4889748905252202, 'macro avg': {'precision': 0.49357796021261824, 'recall': 0.4783603550305256, 'f1-score': 0.477650344755703, 'support': 347797}, 'weighted avg': {'precision': 0.4924725453148718, 'recall': 0.4889748905252202, 'f1-score': 0.4821582896474609, 'support': 347797}}
[[45451 45628 18964]
 [24505 83912 22401]
 [19277 46958 40701]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0422021
{'0': {'precision': 0.48109943888959206, 'recall': 0.40553347736021833, 'f1-score': 0.44009628975691184, 'support': 112479}, '1': {'precision': 0.4333972793861179, 'recall': 0.5990743047240994, 'f1-score': 0.5029429919687519, 'support': 124447}, '2': {'precision': 0.48078799481257334, 'recall': 0.35110173084034596, 'f1-score': 0.40583623511749617, 'support': 110871}, 'accuracy': 0.45743350287667806, 'macro avg': {'precision': 0.4650949043627611, 'recall': 0.4519031709748879, 'f1-score': 0.4496251722810533, 'support': 347797}, 'weighted avg': {'precision': 0.46393160604459344, 'recall': 0.45743350287667806, 'f1-score': 0.45166233843539444, 'support': 347797}}
[[45614 47680 19185]
 [27041 74553 22853]
 [22157 49787 38927]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0665305
{'0': {'precision': 0.4525560756185034, 'recall': 0.39021620441144356, 'f1-score': 0.41908049966929506, 'support': 114475}, '1': {'precision': 0.3968816236462356, 'recall': 0.5643449898848107, 'f1-score': 0.46602570659029696, 'support': 121105}, '2': {'precision': 0.4559347605545873, 'recall': 0.3123858238947753, 'f1-score': 0.37075033182974365, 'support': 112217}, 'accuracy': 0.42573685224426894, 'macro avg': {'precision': 0.43512415327310877, 'recall': 0.4223156727303432, 'f1-score': 0.41861884602977856, 'support': 347797}, 'weighted avg': {'precision': 0.43426003333340907, 'recall': 0.42573685224426894, 'f1-score': 0.41983333203908835, 'support': 347797}}
[[44670 51066 18739]
 [29668 68345 23092]
 [24368 52794 35055]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1000696
{'0': {'precision': 0.450389605252749, 'recall': 0.36441389904550076, 'f1-score': 0.40286579837693215, 'support': 124987}, '1': {'precision': 0.3219061916276085, 'recall': 0.555933779945971, 'f1-score': 0.4077247145143205, 'support': 101057}, '2': {'precision': 0.4660743246052978, 'recall': 0.27616567969577754, 'f1-score': 0.3468251021165986, 'support': 121753}, 'accuracy': 0.3891695443031423, 'macro avg': {'precision': 0.41279004049521845, 'recall': 0.39883778622908306, 'f1-score': 0.3858052050026171, 'support': 347797}, 'weighted avg': {'precision': 0.41854779323198704, 'recall': 0.3891695443031423, 'f1-score': 0.38465950158975937, 'support': 347797}}
[[45547 59214 20226]
 [26583 56181 18293]
 [28998 59131 33624]]
Evaluating performance on  train set...
444/444 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0039555
{'0': {'precision': 0.5017796658820828, 'recall': 0.4653905542835845, 'f1-score': 0.4829005524861878, 'support': 37562}, '1': {'precision': 0.4937729115583501, 'recall': 0.5313912475506205, 'f1-score': 0.5118918782875695, 'support': 38275}, '2': {'precision': 0.49333049335711815, 'recall': 0.4908214351937697, 'f1-score': 0.4920727659009428, 'support': 37751}, 'accuracy': 0.4960823326407719, 'macro avg': {'precision': 0.49629435693251706, 'recall': 0.4958677456759915, 'f1-score': 0.4956217322249001, 'support': 113588}, 'weighted avg': {'precision': 0.49627359804277926, 'recall': 0.4960823326407719, 'f1-score': 0.49571795594137935, 'support': 113588}}
[[17481 10217  9864]
 [ 8770 20339  9166]
 [ 8587 10635 18529]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0299315
{'0': {'precision': 0.4727915010779501, 'recall': 0.4845080919931857, 'f1-score': 0.4785780956262243, 'support': 37568}, '1': {'precision': 0.4603765723065705, 'recall': 0.46707884168251956, 'f1-score': 0.463703489973376, 'support': 37848}, '2': {'precision': 0.47715998909784685, 'recall': 0.458634601278424, 'f1-score': 0.4677139269589378, 'support': 38172}, 'accuracy': 0.4700056343979998, 'macro avg': {'precision': 0.4701093541607892, 'recall': 0.4700738449847097, 'f1-score': 0.4699985041861794, 'support': 113588}, 'weighted avg': {'precision': 0.4701228538665925, 'recall': 0.4700056343979998, 'f1-score': 0.46997083851176985, 'support': 113588}}
[[18202  9983  9383]
 [10370 17678  9800]
 [ 9927 10738 17507]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0451968
{'0': {'precision': 0.45160277314781266, 'recall': 0.49830743396327, 'f1-score': 0.4738069290620169, 'support': 37517}, '1': {'precision': 0.43528273489572133, 'recall': 0.43108863454884216, 'f1-score': 0.4331755329107491, 'support': 37570}, '2': {'precision': 0.47117171197438756, 'recall': 0.4281187501623335, 'f1-score': 0.4486146644167438, 'support': 38501}, 'accuracy': 0.45228369193928936, 'macro avg': {'precision': 0.4526857400059739, 'recall': 0.4525049395581486, 'f1-score': 0.4518657087965033, 'support': 113588}, 'weighted avg': {'precision': 0.4528377616732809, 'recall': 0.45228369193928936, 'f1-score': 0.4518288245570446, 'support': 113588}}
[[18695 10180  8642]
 [11516 16196  9858]
 [11186 10832 16483]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0593262
{'0': {'precision': 0.4289746221309946, 'recall': 0.49123884822907204, 'f1-score': 0.45800024903498937, 'support': 37438}, '1': {'precision': 0.41982983431235676, 'recall': 0.4247414987741179, 'f1-score': 0.42227138447679735, 'support': 37524}, '2': {'precision': 0.45614142215980213, 'recall': 0.38678610262517477, 'f1-score': 0.41861051569789437, 'support': 38626}, 'accuracy': 0.4337518047681093, 'macro avg': {'precision': 0.43498195953438445, 'recall': 0.43425548320945495, 'f1-score': 0.43296071640322703, 'support': 113588}, 'weighted avg': {'precision': 0.4351917911964431, 'recall': 0.4337518047681093, 'f1-score': 0.43280253665727136, 'support': 113588}}
[[18391 10705  8342]
 [12115 15938  9471]
 [12366 11320 14940]]
Evaluating performance on  val set...
144/144 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0082406
{'0': {'precision': 0.4953530708057871, 'recall': 0.4404498210938831, 'f1-score': 0.46629086809470127, 'support': 11738}, '1': {'precision': 0.49585653243558203, 'recall': 0.579437131184748, 'f1-score': 0.5343985487022048, 'support': 13218}, '2': {'precision': 0.4807138209870806, 'recall': 0.4425808659934965, 'f1-score': 0.4608598797059479, 'support': 11686}, 'accuracy': 0.49126685224605643, 'macro avg': {'precision': 0.4906411414094832, 'recall': 0.48748927275737586, 'f1-score': 0.4871830988342847, 'support': 36642}, 'weighted avg': {'precision': 0.4908658834918093, 'recall': 0.49126685224605643, 'f1-score': 0.48912752526295106, 'support': 36642}}
[[5170 3798 2770]
 [2742 7659 2817]
 [2525 3989 5172]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.039849
{'0': {'precision': 0.4725547574709586, 'recall': 0.44271828528703167, 'f1-score': 0.4571502101741443, 'support': 12037}, '1': {'precision': 0.4436600597339126, 'recall': 0.5209628566873904, 'f1-score': 0.47921401862306623, 'support': 12546}, '2': {'precision': 0.4686353804194489, 'recall': 0.4132183431461979, 'f1-score': 0.4391856160761502, 'support': 12059}, 'accuracy': 0.45980022924512853, 'macro avg': {'precision': 0.46161673254144003, 'recall': 0.45896649504020665, 'f1-score': 0.4585166149577869, 'support': 36642}, 'weighted avg': {'precision': 0.4613715074935247, 'recall': 0.45980022924512853, 'f1-score': 0.4587925195615266, 'support': 36642}}
[[5329 3971 2737]
 [3097 6536 2913]
 [2851 4225 4983]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0588824
{'0': {'precision': 0.46053073563990593, 'recall': 0.4448049314624057, 'f1-score': 0.45253125386805293, 'support': 12329}, '1': {'precision': 0.4001780090373819, 'recall': 0.4873269968317492, 'f1-score': 0.4394736842105263, 'support': 11994}, '2': {'precision': 0.4630726698262243, 'recall': 0.38071272018832697, 'f1-score': 0.41787321245600745, 'support': 12319}, 'accuracy': 0.4371759183450685, 'macro avg': {'precision': 0.44126047150117076, 'recall': 0.43761488282749395, 'f1-score': 0.43662605017819556, 'support': 36642}, 'weighted avg': {'precision': 0.44163011570569327, 'recall': 0.4371759183450685, 'f1-score': 0.43660513349723906, 'support': 36642}}
[[5484 4252 2593]
 [3304 5845 2845]
 [3120 4509 4690]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0800917
{'0': {'precision': 0.4415828632164173, 'recall': 0.42500786905886057, 'f1-score': 0.4331368539235735, 'support': 12708}, '1': {'precision': 0.36583892617449665, 'recall': 0.4838451979407066, 'f1-score': 0.4166475578995643, 'support': 11266}, '2': {'precision': 0.4528440752812533, 'recall': 0.3399905273129144, 'f1-score': 0.38838540962171425, 'support': 12668}, 'accuracy': 0.4137055837563452, 'macro avg': {'precision': 0.4200886215573891, 'recall': 0.41628119810416053, 'f1-score': 0.41272327381495066, 'support': 36642}, 'weighted avg': {'precision': 0.4221877930707666, 'recall': 0.4137055837563452, 'f1-score': 0.41259540680217077, 'support': 36642}}
[[5401 4657 2650]
 [3261 5451 2554]
 [3569 4792 4307]]
training model: results/XRAY/W3/deepVOL_L2/seq2seq
Epoch 1/50
444/444 - 20s - loss: 13.2016 - accuracy10: 0.3735 - accuracy20: 0.3674 - accuracy30: 0.3644 - accuracy50: 0.3620 - val_loss: 13.7897 - val_accuracy10: 0.3625 - val_accuracy20: 0.3421 - val_accuracy30: 0.3275 - val_accuracy50: 0.3073 - 20s/epoch - 46ms/step
Epoch 2/50
444/444 - 14s - loss: 13.0581 - accuracy10: 0.4010 - accuracy20: 0.3891 - accuracy30: 0.3795 - accuracy50: 0.3698 - val_loss: 12.9059 - val_accuracy10: 0.4272 - val_accuracy20: 0.4131 - val_accuracy30: 0.3992 - val_accuracy50: 0.3887 - 14s/epoch - 33ms/step
Epoch 3/50
444/444 - 15s - loss: 12.9604 - accuracy10: 0.4162 - accuracy20: 0.4028 - accuracy30: 0.3919 - accuracy50: 0.3800 - val_loss: 12.8887 - val_accuracy10: 0.4251 - val_accuracy20: 0.4141 - val_accuracy30: 0.4015 - val_accuracy50: 0.3920 - 15s/epoch - 33ms/step
Epoch 4/50
444/444 - 15s - loss: 12.8990 - accuracy10: 0.4273 - accuracy20: 0.4124 - accuracy30: 0.3997 - accuracy50: 0.3857 - val_loss: 12.8441 - val_accuracy10: 0.4378 - val_accuracy20: 0.4246 - val_accuracy30: 0.4101 - val_accuracy50: 0.3943 - 15s/epoch - 33ms/step
Epoch 5/50
444/444 - 15s - loss: 12.8451 - accuracy10: 0.4389 - accuracy20: 0.4227 - accuracy30: 0.4086 - accuracy50: 0.3939 - val_loss: 12.8189 - val_accuracy10: 0.4452 - val_accuracy20: 0.4303 - val_accuracy30: 0.4142 - val_accuracy50: 0.3941 - 15s/epoch - 33ms/step
Epoch 6/50
444/444 - 15s - loss: 12.8193 - accuracy10: 0.4454 - accuracy20: 0.4270 - accuracy30: 0.4119 - accuracy50: 0.3973 - val_loss: 12.8098 - val_accuracy10: 0.4460 - val_accuracy20: 0.4293 - val_accuracy30: 0.4144 - val_accuracy50: 0.3957 - 15s/epoch - 33ms/step
Epoch 7/50
444/444 - 15s - loss: 12.7787 - accuracy10: 0.4493 - accuracy20: 0.4319 - accuracy30: 0.4165 - accuracy50: 0.4025 - val_loss: 12.8020 - val_accuracy10: 0.4476 - val_accuracy20: 0.4319 - val_accuracy30: 0.4138 - val_accuracy50: 0.3947 - 15s/epoch - 33ms/step
Epoch 8/50
444/444 - 15s - loss: 12.7427 - accuracy10: 0.4557 - accuracy20: 0.4376 - accuracy30: 0.4213 - accuracy50: 0.4055 - val_loss: 12.7857 - val_accuracy10: 0.4529 - val_accuracy20: 0.4307 - val_accuracy30: 0.4156 - val_accuracy50: 0.3956 - 15s/epoch - 33ms/step
Epoch 9/50
444/444 - 15s - loss: 12.7127 - accuracy10: 0.4577 - accuracy20: 0.4399 - accuracy30: 0.4240 - accuracy50: 0.4091 - val_loss: 12.7834 - val_accuracy10: 0.4519 - val_accuracy20: 0.4303 - val_accuracy30: 0.4132 - val_accuracy50: 0.3958 - 15s/epoch - 33ms/step
Epoch 10/50
444/444 - 15s - loss: 12.6707 - accuracy10: 0.4633 - accuracy20: 0.4451 - accuracy30: 0.4287 - accuracy50: 0.4115 - val_loss: 12.7944 - val_accuracy10: 0.4537 - val_accuracy20: 0.4326 - val_accuracy30: 0.4135 - val_accuracy50: 0.3941 - 15s/epoch - 33ms/step
Epoch 11/50
444/444 - 15s - loss: 12.6415 - accuracy10: 0.4667 - accuracy20: 0.4470 - accuracy30: 0.4309 - accuracy50: 0.4138 - val_loss: 12.7359 - val_accuracy10: 0.4577 - val_accuracy20: 0.4395 - val_accuracy30: 0.4194 - val_accuracy50: 0.3989 - 15s/epoch - 33ms/step
Epoch 12/50
444/444 - 15s - loss: 12.6123 - accuracy10: 0.4696 - accuracy20: 0.4514 - accuracy30: 0.4357 - accuracy50: 0.4170 - val_loss: 12.7337 - val_accuracy10: 0.4599 - val_accuracy20: 0.4376 - val_accuracy30: 0.4198 - val_accuracy50: 0.3986 - 15s/epoch - 33ms/step
Epoch 13/50
444/444 - 15s - loss: 12.5842 - accuracy10: 0.4727 - accuracy20: 0.4542 - accuracy30: 0.4380 - accuracy50: 0.4202 - val_loss: 12.7499 - val_accuracy10: 0.4596 - val_accuracy20: 0.4399 - val_accuracy30: 0.4212 - val_accuracy50: 0.3978 - 15s/epoch - 34ms/step
Epoch 14/50
444/444 - 15s - loss: 12.5562 - accuracy10: 0.4730 - accuracy20: 0.4550 - accuracy30: 0.4393 - accuracy50: 0.4222 - val_loss: 12.7600 - val_accuracy10: 0.4587 - val_accuracy20: 0.4382 - val_accuracy30: 0.4197 - val_accuracy50: 0.3958 - 15s/epoch - 33ms/step
Epoch 15/50
444/444 - 15s - loss: 12.5346 - accuracy10: 0.4771 - accuracy20: 0.4581 - accuracy30: 0.4418 - accuracy50: 0.4220 - val_loss: 12.7664 - val_accuracy10: 0.4600 - val_accuracy20: 0.4377 - val_accuracy30: 0.4189 - val_accuracy50: 0.3944 - 15s/epoch - 33ms/step
Epoch 16/50
444/444 - 15s - loss: 12.5004 - accuracy10: 0.4800 - accuracy20: 0.4611 - accuracy30: 0.4448 - accuracy50: 0.4274 - val_loss: 12.7219 - val_accuracy10: 0.4672 - val_accuracy20: 0.4427 - val_accuracy30: 0.4206 - val_accuracy50: 0.3972 - 15s/epoch - 33ms/step
Epoch 17/50
444/444 - 14s - loss: 12.4833 - accuracy10: 0.4808 - accuracy20: 0.4624 - accuracy30: 0.4476 - accuracy50: 0.4294 - val_loss: 12.7193 - val_accuracy10: 0.4647 - val_accuracy20: 0.4419 - val_accuracy30: 0.4212 - val_accuracy50: 0.3997 - 14s/epoch - 33ms/step
Epoch 18/50
444/444 - 15s - loss: 12.4646 - accuracy10: 0.4836 - accuracy20: 0.4652 - accuracy30: 0.4484 - accuracy50: 0.4300 - val_loss: 12.7366 - val_accuracy10: 0.4615 - val_accuracy20: 0.4409 - val_accuracy30: 0.4210 - val_accuracy50: 0.3976 - 15s/epoch - 33ms/step
Epoch 19/50
444/444 - 15s - loss: 12.4442 - accuracy10: 0.4852 - accuracy20: 0.4652 - accuracy30: 0.4503 - accuracy50: 0.4315 - val_loss: 12.7398 - val_accuracy10: 0.4654 - val_accuracy20: 0.4426 - val_accuracy30: 0.4222 - val_accuracy50: 0.3992 - 15s/epoch - 33ms/step
Epoch 20/50
444/444 - 15s - loss: 12.4187 - accuracy10: 0.4863 - accuracy20: 0.4682 - accuracy30: 0.4522 - accuracy50: 0.4332 - val_loss: 12.7830 - val_accuracy10: 0.4584 - val_accuracy20: 0.4383 - val_accuracy30: 0.4196 - val_accuracy50: 0.3970 - 15s/epoch - 33ms/step
Epoch 21/50
444/444 - 14s - loss: 12.4015 - accuracy10: 0.4887 - accuracy20: 0.4690 - accuracy30: 0.4536 - accuracy50: 0.4353 - val_loss: 12.7643 - val_accuracy10: 0.4615 - val_accuracy20: 0.4406 - val_accuracy30: 0.4177 - val_accuracy50: 0.3972 - 14s/epoch - 33ms/step
Epoch 22/50
444/444 - 15s - loss: 12.4526 - accuracy10: 0.4841 - accuracy20: 0.4655 - accuracy30: 0.4485 - accuracy50: 0.4309 - val_loss: 12.7310 - val_accuracy10: 0.4665 - val_accuracy20: 0.4413 - val_accuracy30: 0.4188 - val_accuracy50: 0.3955 - 15s/epoch - 33ms/step
Epoch 23/50
444/444 - 15s - loss: 12.3995 - accuracy10: 0.4883 - accuracy20: 0.4696 - accuracy30: 0.4549 - accuracy50: 0.4376 - val_loss: 12.7501 - val_accuracy10: 0.4660 - val_accuracy20: 0.4396 - val_accuracy30: 0.4144 - val_accuracy50: 0.3919 - 15s/epoch - 33ms/step
Epoch 24/50
444/444 - 15s - loss: 12.3560 - accuracy10: 0.4926 - accuracy20: 0.4736 - accuracy30: 0.4579 - accuracy50: 0.4402 - val_loss: 12.7626 - val_accuracy10: 0.4666 - val_accuracy20: 0.4396 - val_accuracy30: 0.4202 - val_accuracy50: 0.3944 - 15s/epoch - 33ms/step
Epoch 25/50
444/444 - 15s - loss: 12.3219 - accuracy10: 0.4948 - accuracy20: 0.4766 - accuracy30: 0.4611 - accuracy50: 0.4430 - val_loss: 12.8211 - val_accuracy10: 0.4627 - val_accuracy20: 0.4373 - val_accuracy30: 0.4167 - val_accuracy50: 0.3954 - 15s/epoch - 33ms/step
Epoch 26/50
444/444 - 15s - loss: 12.3035 - accuracy10: 0.4965 - accuracy20: 0.4779 - accuracy30: 0.4631 - accuracy50: 0.4462 - val_loss: 12.7742 - val_accuracy10: 0.4682 - val_accuracy20: 0.4421 - val_accuracy30: 0.4196 - val_accuracy50: 0.3964 - 15s/epoch - 33ms/step
Epoch 27/50
444/444 - 14s - loss: 12.2815 - accuracy10: 0.4964 - accuracy20: 0.4795 - accuracy30: 0.4658 - accuracy50: 0.4480 - val_loss: 12.7937 - val_accuracy10: 0.4659 - val_accuracy20: 0.4406 - val_accuracy30: 0.4189 - val_accuracy50: 0.3983 - 14s/epoch - 32ms/step
testing model: results/XRAY/W3/deepVOL_L2/seq2seq
Evaluating performance on  test set...
1359/1359 - 18s - 18s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0318173
{'0': {'precision': 0.4645391551177158, 'recall': 0.4045072470353037, 'f1-score': 0.4324497617416901, 'support': 110045}, '1': {'precision': 0.48353724568558326, 'recall': 0.4812603673778274, 'f1-score': 0.4823961198672909, 'support': 130819}, '2': {'precision': 0.4409644094798561, 'recall': 0.5021461234184613, 'f1-score': 0.46957076834957656, 'support': 106937}, 'accuracy': 0.4633971725210681, 'macro avg': {'precision': 0.4630136034277184, 'recall': 0.46263791261053083, 'f1-score': 0.4614722166528525, 'support': 347801}, 'weighted avg': {'precision': 0.4644365062918701, 'recall': 0.4633971725210681, 'f1-score': 0.4626496223150079, 'support': 347801}}
[[44514 36218 29313]
 [29098 62958 38763]
 [22212 31027 53698]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0563464
{'0': {'precision': 0.44627661170164895, 'recall': 0.3967692321369831, 'f1-score': 0.4200692758042958, 'support': 112481}, '1': {'precision': 0.43614984094829634, 'recall': 0.44289984571869373, 'f1-score': 0.4394989275262935, 'support': 124448}, '2': {'precision': 0.430680919752273, 'recall': 0.47167003391298074, 'f1-score': 0.4502445156180046, 'support': 110872}, 'accuracy': 0.4371522796081667, 'macro avg': {'precision': 0.43770245746740605, 'recall': 0.43711303725621914, 'f1-score': 0.4366042396495313, 'support': 347801}, 'weighted avg': {'precision': 0.43768151874756195, 'recall': 0.4371522796081667, 'f1-score': 0.43664073616848303, 'support': 347801}}
[[44629 37314 30538]
 [30739 55118 38591]
 [24635 33942 52295]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0750433
{'0': {'precision': 0.42653128451566646, 'recall': 0.3845629727982669, 'f1-score': 0.4044613490619775, 'support': 114478}, '1': {'precision': 0.3970644974599704, 'recall': 0.4078939763015565, 'f1-score': 0.4024063898856679, 'support': 121105}, '2': {'precision': 0.4153554281530051, 'recall': 0.4448216863604769, 'f1-score': 0.42958385865566245, 'support': 112218}, 'accuracy': 0.41212934982935645, 'macro avg': {'precision': 0.4129837367095473, 'recall': 0.4124262118201001, 'f1-score': 0.41215053253443595, 'support': 347801}, 'weighted avg': {'precision': 0.41266500035982673, 'recall': 0.41212934982935645, 'f1-score': 0.4118515864406428, 'support': 347801}}
[[44024 38731 31723]
 [33168 49398 38539]
 [26022 36279 49917]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0973366
{'0': {'precision': 0.433886853499548, 'recall': 0.36478918313465075, 'f1-score': 0.39634901662501354, 'support': 124990}, '1': {'precision': 0.31786718668160097, 'recall': 0.39034406325143234, 'f1-score': 0.35039705803975907, 'support': 101057}, '2': {'precision': 0.4235902105094548, 'recall': 0.41267638024212755, 'f1-score': 0.4180620790361566, 'support': 121754}, 'accuracy': 0.3889781800512362, 'macro avg': {'precision': 0.3917814168968679, 'recall': 0.3892698755427369, 'f1-score': 0.3882693845669764, 'support': 347801}, 'weighted avg': {'precision': 0.3965716734390045, 'recall': 0.3889781800512362, 'f1-score': 0.3905982715784388, 'support': 347801}}
[[45595 43509 35886]
 [29124 39447 32486]
 [30366 41143 50245]]
Evaluating performance on  train set...
444/444 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.032594
{'0': {'precision': 0.46328317373461014, 'recall': 0.4511616753703506, 'f1-score': 0.45714208579681975, 'support': 37532}, '1': {'precision': 0.5000519732511001, 'recall': 0.37741572739872903, 'f1-score': 0.4301639344262295, 'support': 38239}, '2': {'precision': 0.4525302005064552, 'recall': 0.576497963932519, 'f1-score': 0.5070468393878784, 'support': 37818}, 'accuracy': 0.4680646893625263, 'macro avg': {'precision': 0.4719551158307218, 'recall': 0.4683584555671995, 'f1-score': 0.46478428653697595, 'support': 113589}, 'weighted avg': {'precision': 0.47208108711679236, 'recall': 0.4680646893625263, 'f1-score': 0.46467521348565105, 'support': 113589}}
[[16933  7890 12709]
 [10140 14432 13667]
 [ 9477  6539 21802]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0519235
{'0': {'precision': 0.4473948575927887, 'recall': 0.43830296581992284, 'f1-score': 0.4428022465267514, 'support': 37595}, '1': {'precision': 0.4545108620451086, 'recall': 0.3468401879520617, 'f1-score': 0.39344213205569695, 'support': 37882}, '2': {'precision': 0.43791013584117033, 'recall': 0.5498005877413937, 'f1-score': 0.4875177403969196, 'support': 38112}, 'accuracy': 0.44521036367958167, 'macro avg': {'precision': 0.44660528515968917, 'recall': 0.4449812471711261, 'f1-score': 0.44125403965978927, 'support': 113589}, 'weighted avg': {'precision': 0.4465856838635113, 'recall': 0.44521036367958167, 'f1-score': 0.4413438046528672, 'support': 113589}}
[[16478  8278 12839]
 [10686 13139 14057]
 [ 9667  7491 20954]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.064441
{'0': {'precision': 0.42886216961679563, 'recall': 0.4272033717456253, 'f1-score': 0.42803116355521104, 'support': 37488}, '1': {'precision': 0.42077966101694914, 'recall': 0.33032625472350846, 'f1-score': 0.3701064432451773, 'support': 37578}, '2': {'precision': 0.42987635305694605, 'recall': 0.5216364249928614, 'f1-score': 0.47133190256716984, 'support': 38523}, 'accuracy': 0.42718044881106443, 'macro avg': {'precision': 0.42650606123023027, 'recall': 0.426388683820665, 'f1-score': 0.42315650312251935, 'support': 113589}, 'weighted avg': {'precision': 0.4265322334477994, 'recall': 0.42718044881106443, 'f1-score': 0.42355343445421745, 'support': 113589}}
[[16015  8818 12655]
 [11169 12413 13996]
 [10159  8269 20095]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0779375
{'0': {'precision': 0.4033216597686512, 'recall': 0.4063510732137607, 'f1-score': 0.40483069917313563, 'support': 37411}, '1': {'precision': 0.39454759414225943, 'recall': 0.32212436615959433, 'f1-score': 0.35467661837736186, 'support': 37470}, '2': {'precision': 0.4159805760953537, 'recall': 0.48687609796424514, 'f1-score': 0.4486448525823384, 'support': 38708}, 'accuracy': 0.40600762397767387, 'macro avg': {'precision': 0.4046166100020881, 'recall': 0.4051171791125334, 'f1-score': 0.40271739004427864, 'support': 113589}, 'weighted avg': {'precision': 0.4047411378356568, 'recall': 0.40600762397767387, 'f1-score': 0.40321685313827116, 'support': 113589}}
[[15202  9518 12691]
 [11632 12070 13768]
 [10858  9004 18846]]
Evaluating performance on  val set...
144/144 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0301121
{'0': {'precision': 0.4654129654129654, 'recall': 0.41836561331974176, 'f1-score': 0.440637022456831, 'support': 11772}, '1': {'precision': 0.5059813084112149, 'recall': 0.4090668681526256, 'f1-score': 0.4523918947148527, 'support': 13235}, '2': {'precision': 0.4337239583333333, 'recall': 0.5725827245380318, 'f1-score': 0.49357288386738285, 'support': 11635}, 'accuracy': 0.4639757655149828, 'macro avg': {'precision': 0.4683727440525045, 'recall': 0.46667173533679973, 'f1-score': 0.46220060034635546, 'support': 36642}, 'weighted avg': {'precision': 0.4700038835454449, 'recall': 0.4639757655149828, 'f1-score': 0.4616916723625864, 'support': 36642}}
[[4925 2907 3940]
 [3063 5414 4758]
 [2594 2379 6662]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0537624
{'0': {'precision': 0.4509278921613886, 'recall': 0.40497512437810945, 'f1-score': 0.426717924074964, 'support': 12060}, '1': {'precision': 0.45381300356005244, 'recall': 0.38705553335996806, 'f1-score': 0.4177842942774591, 'support': 12515}, '2': {'precision': 0.4288828697892581, 'recall': 0.5379961879506091, 'f1-score': 0.4772827525363917, 'support': 12067}, 'accuracy': 0.4426614267780143, 'macro avg': {'precision': 0.4445412551702331, 'recall': 0.44334228189622893, 'f1-score': 0.4405949902962716, 'support': 36642}, 'weighted avg': {'precision': 0.44465339525046066, 'recall': 0.4426614267780143, 'f1-score': 0.44031874848761277, 'support': 36642}}
[[4884 3085 4091]
 [3117 4844 4554]
 [2830 2745 6492]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0694551
{'0': {'precision': 0.44004677520913915, 'recall': 0.39633800534716035, 'f1-score': 0.4170502983802217, 'support': 12343}, '1': {'precision': 0.4097656614695173, 'recall': 0.3656585853536616, 'f1-score': 0.38645769129171437, 'support': 12003}, '2': {'precision': 0.4206831375725665, 'recall': 0.5068314899154196, 'f1-score': 0.4597565473994836, 'support': 12296}, 'accuracy': 0.42336662845914524, 'macro avg': {'precision': 0.42349852475040767, 'recall': 0.4229426935387472, 'f1-score': 0.4210881790238066, 'support': 36642}, 'weighted avg': {'precision': 0.4236295628136373, 'recall': 0.42336662845914524, 'f1-score': 0.4213599150784775, 'support': 36642}}
[[4892 3313 4138]
 [3170 4389 4444]
 [3055 3009 6232]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0868063
{'0': {'precision': 0.4180575284090909, 'recall': 0.37043738200125864, 'f1-score': 0.3928094761428094, 'support': 12712}, '1': {'precision': 0.3667241849060031, 'recall': 0.3588057579527279, 'f1-score': 0.3627217606108242, 'support': 11254}, '2': {'precision': 0.41233382056100787, 'recall': 0.4673398548437993, 'f1-score': 0.43811707280996937, 'support': 12676}, 'accuracy': 0.40038753343158123, 'macro avg': {'precision': 0.399038511292034, 'recall': 0.3988609982659286, 'f1-score': 0.39788276985453425, 'support': 36642}, 'weighted avg': {'precision': 0.4003112490448081, 'recall': 0.40038753343158123, 'f1-score': 0.39924231127069426, 'support': 36642}}
[[4709 3614 4389]
 [3162 4038 4054]
 [3393 3359 5924]]
training model: results/XRAY/W3/deepVOL_L3/seq2seq
Epoch 1/50
444/444 - 26s - loss: 13.2365 - accuracy10: 0.3692 - accuracy20: 0.3650 - accuracy30: 0.3607 - accuracy50: 0.3599 - val_loss: 13.3836 - val_accuracy10: 0.3641 - val_accuracy20: 0.3437 - val_accuracy30: 0.3297 - val_accuracy50: 0.3116 - 26s/epoch - 59ms/step
Epoch 2/50
444/444 - 20s - loss: 13.1277 - accuracy10: 0.3796 - accuracy20: 0.3712 - accuracy30: 0.3653 - accuracy50: 0.3636 - val_loss: 13.1092 - val_accuracy10: 0.3974 - val_accuracy20: 0.3732 - val_accuracy30: 0.3534 - val_accuracy50: 0.3288 - 20s/epoch - 45ms/step
Epoch 3/50
444/444 - 20s - loss: 13.0483 - accuracy10: 0.3946 - accuracy20: 0.3838 - accuracy30: 0.3754 - accuracy50: 0.3713 - val_loss: 12.9296 - val_accuracy10: 0.4167 - val_accuracy20: 0.4078 - val_accuracy30: 0.3944 - val_accuracy50: 0.3798 - 20s/epoch - 45ms/step
Epoch 4/50
444/444 - 20s - loss: 12.9842 - accuracy10: 0.4072 - accuracy20: 0.3958 - accuracy30: 0.3851 - accuracy50: 0.3778 - val_loss: 12.9122 - val_accuracy10: 0.4268 - val_accuracy20: 0.4147 - val_accuracy30: 0.4031 - val_accuracy50: 0.3906 - 20s/epoch - 46ms/step
Epoch 5/50
444/444 - 20s - loss: 12.9096 - accuracy10: 0.4219 - accuracy20: 0.4101 - accuracy30: 0.3984 - accuracy50: 0.3880 - val_loss: 12.9063 - val_accuracy10: 0.4172 - val_accuracy20: 0.4143 - val_accuracy30: 0.4072 - val_accuracy50: 0.3964 - 20s/epoch - 46ms/step
Epoch 6/50
444/444 - 20s - loss: 12.8417 - accuracy10: 0.4353 - accuracy20: 0.4217 - accuracy30: 0.4092 - accuracy50: 0.3968 - val_loss: 12.8134 - val_accuracy10: 0.4365 - val_accuracy20: 0.4226 - val_accuracy30: 0.4106 - val_accuracy50: 0.3953 - 20s/epoch - 46ms/step
Epoch 7/50
444/444 - 20s - loss: 12.8275 - accuracy10: 0.4364 - accuracy20: 0.4232 - accuracy30: 0.4128 - accuracy50: 0.4023 - val_loss: 12.8594 - val_accuracy10: 0.4357 - val_accuracy20: 0.4232 - val_accuracy30: 0.4114 - val_accuracy50: 0.3990 - 20s/epoch - 45ms/step
Epoch 8/50
444/444 - 20s - loss: 12.7650 - accuracy10: 0.4503 - accuracy20: 0.4321 - accuracy30: 0.4188 - accuracy50: 0.4050 - val_loss: 12.8135 - val_accuracy10: 0.4373 - val_accuracy20: 0.4231 - val_accuracy30: 0.4106 - val_accuracy50: 0.3963 - 20s/epoch - 45ms/step
Epoch 9/50
444/444 - 20s - loss: 12.7187 - accuracy10: 0.4560 - accuracy20: 0.4373 - accuracy30: 0.4220 - accuracy50: 0.4084 - val_loss: 12.8064 - val_accuracy10: 0.4472 - val_accuracy20: 0.4276 - val_accuracy30: 0.4124 - val_accuracy50: 0.3926 - 20s/epoch - 45ms/step
Epoch 10/50
444/444 - 20s - loss: 12.6867 - accuracy10: 0.4585 - accuracy20: 0.4399 - accuracy30: 0.4249 - accuracy50: 0.4104 - val_loss: 12.7572 - val_accuracy10: 0.4517 - val_accuracy20: 0.4301 - val_accuracy30: 0.4107 - val_accuracy50: 0.3908 - 20s/epoch - 45ms/step
Epoch 11/50
444/444 - 20s - loss: 12.6569 - accuracy10: 0.4619 - accuracy20: 0.4440 - accuracy30: 0.4307 - accuracy50: 0.4154 - val_loss: 12.7449 - val_accuracy10: 0.4561 - val_accuracy20: 0.4318 - val_accuracy30: 0.4158 - val_accuracy50: 0.3947 - 20s/epoch - 45ms/step
Epoch 12/50
444/444 - 20s - loss: 12.6303 - accuracy10: 0.4653 - accuracy20: 0.4459 - accuracy30: 0.4332 - accuracy50: 0.4173 - val_loss: 12.7557 - val_accuracy10: 0.4563 - val_accuracy20: 0.4329 - val_accuracy30: 0.4146 - val_accuracy50: 0.3924 - 20s/epoch - 45ms/step
Epoch 13/50
444/444 - 20s - loss: 12.6058 - accuracy10: 0.4669 - accuracy20: 0.4491 - accuracy30: 0.4340 - accuracy50: 0.4187 - val_loss: 12.7772 - val_accuracy10: 0.4551 - val_accuracy20: 0.4344 - val_accuracy30: 0.4147 - val_accuracy50: 0.3882 - 20s/epoch - 44ms/step
Epoch 14/50
444/444 - 20s - loss: 12.5654 - accuracy10: 0.4707 - accuracy20: 0.4528 - accuracy30: 0.4394 - accuracy50: 0.4242 - val_loss: 12.7351 - val_accuracy10: 0.4572 - val_accuracy20: 0.4360 - val_accuracy30: 0.4177 - val_accuracy50: 0.3952 - 20s/epoch - 45ms/step
Epoch 15/50
444/444 - 20s - loss: 12.5348 - accuracy10: 0.4763 - accuracy20: 0.4565 - accuracy30: 0.4425 - accuracy50: 0.4271 - val_loss: 12.7013 - val_accuracy10: 0.4606 - val_accuracy20: 0.4377 - val_accuracy30: 0.4206 - val_accuracy50: 0.3981 - 20s/epoch - 46ms/step
Epoch 16/50
444/444 - 21s - loss: 12.5140 - accuracy10: 0.4789 - accuracy20: 0.4595 - accuracy30: 0.4437 - accuracy50: 0.4268 - val_loss: 12.7124 - val_accuracy10: 0.4627 - val_accuracy20: 0.4415 - val_accuracy30: 0.4216 - val_accuracy50: 0.3991 - 21s/epoch - 46ms/step
Epoch 17/50
444/444 - 20s - loss: 12.4904 - accuracy10: 0.4807 - accuracy20: 0.4600 - accuracy30: 0.4457 - accuracy50: 0.4305 - val_loss: 12.7069 - val_accuracy10: 0.4617 - val_accuracy20: 0.4412 - val_accuracy30: 0.4204 - val_accuracy50: 0.3977 - 20s/epoch - 45ms/step
Epoch 18/50
444/444 - 20s - loss: 12.4622 - accuracy10: 0.4835 - accuracy20: 0.4643 - accuracy30: 0.4494 - accuracy50: 0.4326 - val_loss: 12.6681 - val_accuracy10: 0.4654 - val_accuracy20: 0.4420 - val_accuracy30: 0.4245 - val_accuracy50: 0.4014 - 20s/epoch - 45ms/step
Epoch 19/50
444/444 - 20s - loss: 12.4446 - accuracy10: 0.4844 - accuracy20: 0.4654 - accuracy30: 0.4505 - accuracy50: 0.4341 - val_loss: 12.6853 - val_accuracy10: 0.4645 - val_accuracy20: 0.4462 - val_accuracy30: 0.4254 - val_accuracy50: 0.4029 - 20s/epoch - 44ms/step
Epoch 20/50
444/444 - 20s - loss: 12.4202 - accuracy10: 0.4843 - accuracy20: 0.4665 - accuracy30: 0.4510 - accuracy50: 0.4358 - val_loss: 12.6713 - val_accuracy10: 0.4670 - val_accuracy20: 0.4449 - val_accuracy30: 0.4252 - val_accuracy50: 0.4025 - 20s/epoch - 45ms/step
Epoch 21/50
444/444 - 20s - loss: 12.3960 - accuracy10: 0.4883 - accuracy20: 0.4689 - accuracy30: 0.4552 - accuracy50: 0.4387 - val_loss: 12.6907 - val_accuracy10: 0.4612 - val_accuracy20: 0.4393 - val_accuracy30: 0.4215 - val_accuracy50: 0.4016 - 20s/epoch - 45ms/step
Epoch 22/50
444/444 - 20s - loss: 12.3718 - accuracy10: 0.4900 - accuracy20: 0.4724 - accuracy30: 0.4569 - accuracy50: 0.4411 - val_loss: 12.6479 - val_accuracy10: 0.4685 - val_accuracy20: 0.4456 - val_accuracy30: 0.4255 - val_accuracy50: 0.4028 - 20s/epoch - 45ms/step
Epoch 23/50
444/444 - 20s - loss: 12.3640 - accuracy10: 0.4911 - accuracy20: 0.4720 - accuracy30: 0.4565 - accuracy50: 0.4398 - val_loss: 12.6672 - val_accuracy10: 0.4651 - val_accuracy20: 0.4420 - val_accuracy30: 0.4258 - val_accuracy50: 0.4001 - 20s/epoch - 44ms/step
Epoch 24/50
444/444 - 20s - loss: 12.3337 - accuracy10: 0.4940 - accuracy20: 0.4758 - accuracy30: 0.4610 - accuracy50: 0.4443 - val_loss: 12.6699 - val_accuracy10: 0.4642 - val_accuracy20: 0.4439 - val_accuracy30: 0.4239 - val_accuracy50: 0.4025 - 20s/epoch - 45ms/step
Epoch 25/50
444/444 - 20s - loss: 12.3125 - accuracy10: 0.4948 - accuracy20: 0.4771 - accuracy30: 0.4626 - accuracy50: 0.4471 - val_loss: 12.6678 - val_accuracy10: 0.4655 - val_accuracy20: 0.4424 - val_accuracy30: 0.4238 - val_accuracy50: 0.3992 - 20s/epoch - 46ms/step
Epoch 26/50
444/444 - 20s - loss: 12.3010 - accuracy10: 0.4956 - accuracy20: 0.4780 - accuracy30: 0.4641 - accuracy50: 0.4467 - val_loss: 12.6660 - val_accuracy10: 0.4652 - val_accuracy20: 0.4436 - val_accuracy30: 0.4234 - val_accuracy50: 0.3988 - 20s/epoch - 45ms/step
Epoch 27/50
444/444 - 20s - loss: 12.2705 - accuracy10: 0.4969 - accuracy20: 0.4816 - accuracy30: 0.4665 - accuracy50: 0.4500 - val_loss: 12.6674 - val_accuracy10: 0.4665 - val_accuracy20: 0.4438 - val_accuracy30: 0.4264 - val_accuracy50: 0.3970 - 20s/epoch - 44ms/step
Epoch 28/50
444/444 - 20s - loss: 12.2572 - accuracy10: 0.4989 - accuracy20: 0.4809 - accuracy30: 0.4676 - accuracy50: 0.4510 - val_loss: 12.6692 - val_accuracy10: 0.4686 - val_accuracy20: 0.4450 - val_accuracy30: 0.4227 - val_accuracy50: 0.3973 - 20s/epoch - 44ms/step
Epoch 29/50
444/444 - 21s - loss: 12.2333 - accuracy10: 0.5002 - accuracy20: 0.4836 - accuracy30: 0.4689 - accuracy50: 0.4517 - val_loss: 12.6770 - val_accuracy10: 0.4708 - val_accuracy20: 0.4482 - val_accuracy30: 0.4259 - val_accuracy50: 0.3980 - 21s/epoch - 46ms/step
Epoch 30/50
444/444 - 20s - loss: 12.2144 - accuracy10: 0.5007 - accuracy20: 0.4850 - accuracy30: 0.4709 - accuracy50: 0.4566 - val_loss: 12.6883 - val_accuracy10: 0.4697 - val_accuracy20: 0.4459 - val_accuracy30: 0.4273 - val_accuracy50: 0.3985 - 20s/epoch - 44ms/step
Epoch 31/50
444/444 - 20s - loss: 12.1901 - accuracy10: 0.5029 - accuracy20: 0.4883 - accuracy30: 0.4745 - accuracy50: 0.4588 - val_loss: 12.6802 - val_accuracy10: 0.4720 - val_accuracy20: 0.4466 - val_accuracy30: 0.4257 - val_accuracy50: 0.4000 - 20s/epoch - 45ms/step
Epoch 32/50
444/444 - 20s - loss: 12.1720 - accuracy10: 0.5039 - accuracy20: 0.4889 - accuracy30: 0.4753 - accuracy50: 0.4582 - val_loss: 12.6935 - val_accuracy10: 0.4706 - val_accuracy20: 0.4462 - val_accuracy30: 0.4237 - val_accuracy50: 0.3975 - 20s/epoch - 46ms/step
testing model: results/XRAY/W3/deepVOL_L3/seq2seq
Evaluating performance on  test set...
1359/1359 - 27s - 27s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0261858
{'0': {'precision': 0.45001972732453643, 'recall': 0.4664182834295061, 'f1-score': 0.4580722891566265, 'support': 110045}, '1': {'precision': 0.48441576576245526, 'recall': 0.5038488292984964, 'f1-score': 0.4939412333355815, 'support': 130819}, '2': {'precision': 0.45565577043172023, 'recall': 0.41620767367702477, 'f1-score': 0.43503929311490797, 'support': 106937}, 'accuracy': 0.46505904238343193, 'macro avg': {'precision': 0.4633637545062373, 'recall': 0.4621582621350091, 'f1-score': 0.46235093853570525, 'support': 347801}, 'weighted avg': {'precision': 0.464690061493107, 'recall': 0.46505904238343193, 'f1-score': 0.4644818736915573, 'support': 347801}}
[[51327 35972 22746]
 [34481 65913 30425]
 [28247 34182 44508]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0529917
{'0': {'precision': 0.4364173446824496, 'recall': 0.4544589752936051, 'f1-score': 0.4452554744525547, 'support': 112481}, '1': {'precision': 0.4391112248507794, 'recall': 0.46878214193880174, 'f1-score': 0.45346184489224844, 'support': 124448}, '2': {'precision': 0.4455747191068672, 'recall': 0.3930929359982683, 'f1-score': 0.41769173634904283, 'support': 110872}, 'accuracy': 0.44002173656774995, 'macro avg': {'precision': 0.44036776288003204, 'recall': 0.43877801774355835, 'f1-score': 0.4388030185646153, 'support': 347801}, 'weighted avg': {'precision': 0.4403004399477661, 'recall': 0.44002173656774995, 'f1-score': 0.4394050588915484, 'support': 347801}}
[[51118 37841 23522]
 [35401 58339 30708]
 [30612 36677 43583]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0727566
{'0': {'precision': 0.41965873183062985, 'recall': 0.43504428798546446, 'f1-score': 0.42721303178599457, 'support': 114478}, '1': {'precision': 0.40133711201893363, 'recall': 0.43967631394244666, 'f1-score': 0.41963283013960967, 'support': 121105}, '2': {'precision': 0.4303902459254344, 'recall': 0.3699228287796967, 'f1-score': 0.3978722384626444, 'support': 112218}, 'accuracy': 0.41564572844816433, 'macro avg': {'precision': 0.4171286965916659, 'recall': 0.4148811435692026, 'f1-score': 0.4149060334627495, 'support': 347801}, 'weighted avg': {'precision': 0.4167416306187165, 'recall': 0.41564572844816433, 'f1-score': 0.415106782909352, 'support': 347801}}
[[49803 40380 24295]
 [37213 53247 30645]
 [31659 39047 41512]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0990142
{'0': {'precision': 0.42653347531396313, 'recall': 0.40379230338427075, 'f1-score': 0.4148514688717553, 'support': 124990}, '1': {'precision': 0.3165718802837004, 'recall': 0.42798618601383376, 'f1-score': 0.3639431167956917, 'support': 101057}, '2': {'precision': 0.4352517985611511, 'recall': 0.33193159978316933, 'f1-score': 0.3766343904643859, 'support': 121754}, 'accuracy': 0.3856659411560059, 'macro avg': {'precision': 0.3927857180529382, 'recall': 0.38790336306042467, 'f1-score': 0.38514299204394425, 'support': 347801}, 'weighted avg': {'precision': 0.39763505874720473, 'recall': 0.3856659411560059, 'f1-score': 0.3866809705115964, 'support': 347801}}
[[50470 47671 26849]
 [32217 43251 25589]
 [35639 45701 40414]]
Evaluating performance on  train set...
444/444 - 9s - 9s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0305047
{'0': {'precision': 0.4384317601515526, 'recall': 0.5673025684749015, 'f1-score': 0.49461066716223756, 'support': 37532}, '1': {'precision': 0.5136853531829108, 'recall': 0.34650487721959256, 'f1-score': 0.4138491090531444, 'support': 38239}, '2': {'precision': 0.46167571563304527, 'recall': 0.47892537944893965, 'f1-score': 0.4701423769289672, 'support': 37818}, 'accuracy': 0.4635484069760276, 'macro avg': {'precision': 0.47126427632250284, 'recall': 0.46424427504781124, 'f1-score': 0.45953405104811634, 'support': 113589}, 'weighted avg': {'precision': 0.4715041707927696, 'recall': 0.4635484069760276, 'f1-score': 0.45927640926248114, 'support': 113589}}
[[21292  6620  9620]
 [13490 13250 11499]
 [13782  5924 18112]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.050179
{'0': {'precision': 0.4203057195355565, 'recall': 0.5719377576805427, 'f1-score': 0.48453573400335764, 'support': 37595}, '1': {'precision': 0.4732477473885655, 'recall': 0.3133414286468508, 'f1-score': 0.377040848738962, 'support': 37882}, '2': {'precision': 0.4523815898685373, 'recall': 0.4433249370277078, 'f1-score': 0.44780747670982357, 'support': 38112}, 'accuracy': 0.4425428518606555, 'macro avg': {'precision': 0.44864501893088643, 'recall': 0.44286804111836703, 'f1-score': 0.43646135315071444, 'support': 113589}, 'weighted avg': {'precision': 0.44872418848288637, 'recall': 0.4425428518606555, 'f1-score': 0.43636285999656993, 'support': 113589}}
[[21502  6897  9196]
 [14755 11870 11257]
 [14901  6315 16896]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0625428
{'0': {'precision': 0.40520931994695963, 'recall': 0.5706092616303884, 'f1-score': 0.4738917565741377, 'support': 37488}, '1': {'precision': 0.4392675564029234, 'recall': 0.2942945340358721, 'f1-score': 0.3524556203588616, 'support': 37578}, '2': {'precision': 0.4425792325183168, 'recall': 0.4092619993250785, 'f1-score': 0.4252690637391093, 'support': 38523}, 'accuracy': 0.42447772231466074, 'macro avg': {'precision': 0.42901870295606664, 'recall': 0.42472193166377964, 'f1-score': 0.41720548022403614, 'support': 113589}, 'weighted avg': {'precision': 0.42915038423600704, 'recall': 0.42447772231466074, 'f1-score': 0.4172276506943302, 'support': 113589}}
[[21391  7296  8801]
 [15463 11059 11056]
 [15936  6821 15766]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0736636
{'0': {'precision': 0.3884640431668062, 'recall': 0.5580711555424875, 'f1-score': 0.45807187678265826, 'support': 37411}, '1': {'precision': 0.41717768044182063, 'recall': 0.2923138510808647, 'f1-score': 0.3437583366025893, 'support': 37470}, '2': {'precision': 0.427401827979398, 'recall': 0.3708794047742069, 'f1-score': 0.39713957702255975, 'support': 38708}, 'accuracy': 0.406615077164162, 'macro avg': {'precision': 0.4110145171960083, 'recall': 0.40708813713251973, 'f1-score': 0.3996565968026024, 'support': 113589}, 'weighted avg': {'precision': 0.4112048346450356, 'recall': 0.406615077164162, 'f1-score': 0.3995988220884442, 'support': 113589}}
[[20878  7898  8635]
 [15919 10953 10598]
 [16948  7404 14356]]
Evaluating performance on  val set...
144/144 - 3s - 3s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.021661
{'0': {'precision': 0.44097702740105177, 'recall': 0.5413693510023785, 'f1-score': 0.4860433190970104, 'support': 11772}, '1': {'precision': 0.526320939334638, 'recall': 0.4064223649414431, 'f1-score': 0.45866552973779573, 'support': 13235}, '2': {'precision': 0.4459482038429407, 'recall': 0.4587881392350666, 'f1-score': 0.45227705994492695, 'support': 11635}, 'accuracy': 0.46640467223404836, 'macro avg': {'precision': 0.4710820568595435, 'recall': 0.4688599517262961, 'f1-score': 0.4656619695932444, 'support': 36642}, 'weighted avg': {'precision': 0.47338154441274305, 'recall': 0.46640467223404836, 'f1-score': 0.4654326682754478, 'support': 36642}}
[[6373 2521 2878]
 [4102 5379 3754]
 [3977 2320 5338]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0483649
{'0': {'precision': 0.4275825697145494, 'recall': 0.5378109452736318, 'f1-score': 0.4764038341474164, 'support': 12060}, '1': {'precision': 0.47844299141806296, 'recall': 0.374190970834998, 'f1-score': 0.4199435053580236, 'support': 12515}, '2': {'precision': 0.44030808729139925, 'recall': 0.42636943730836163, 'f1-score': 0.4332266756483665, 'support': 12067}, 'accuracy': 0.4452267889307352, 'macro avg': {'precision': 0.44877788280800385, 'recall': 0.44612378447233053, 'f1-score': 0.4431913383846022, 'support': 36642}, 'weighted avg': {'precision': 0.44914462959717916, 'recall': 0.4452267889307352, 'f1-score': 0.44290075608379303, 'support': 36642}}
[[6486 2639 2935]
 [4227 4683 3605]
 [4456 2466 5145]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0634675
{'0': {'precision': 0.42127442216830546, 'recall': 0.5345539982176132, 'f1-score': 0.47120157114800926, 'support': 12343}, '1': {'precision': 0.43355394474209474, 'recall': 0.3438307089894193, 'f1-score': 0.3835145432580615, 'support': 12003}, '2': {'precision': 0.43146322310444113, 'recall': 0.4021633051398829, 'f1-score': 0.41629835416929745, 'support': 12296}, 'accuracy': 0.4276513290759238, 'macro avg': {'precision': 0.4287638633382804, 'recall': 0.42684933744897186, 'f1-score': 0.42367148952512274, 'support': 36642}, 'weighted avg': {'precision': 0.42871595390139633, 'recall': 0.4276513290759238, 'f1-score': 0.42405356198548305, 'support': 36642}}
[[6598 2788 2957]
 [4317 4127 3559]
 [4747 2604 4945]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0816213
{'0': {'precision': 0.4081337607643472, 'recall': 0.5107772183763373, 'f1-score': 0.4537227909576884, 'support': 12712}, '1': {'precision': 0.377636698750768, 'recall': 0.3277057046383508, 'f1-score': 0.3509039010466223, 'support': 11254}, '2': {'precision': 0.4231786267894593, 'recall': 0.36612496055538024, 'f1-score': 0.392589772871463, 'support': 12676}, 'accuracy': 0.40450848752797336, 'macro avg': {'precision': 0.4029830287681915, 'recall': 0.4015359611900228, 'f1-score': 0.3990721549585912, 'support': 36642}, 'weighted avg': {'precision': 0.40397172773758827, 'recall': 0.40450848752797336, 'f1-score': 0.4009951580686504, 'support': 36642}}
[[6493 3139 3080]
 [4320 3688 3246]
 [5096 2939 4641]]
training model: results/XRAY/W4/deepLOB_L1/seq2seq
Epoch 1/50
339/339 - 15s - loss: 13.0396 - accuracy10: 0.4052 - accuracy20: 0.4002 - accuracy30: 0.3928 - accuracy50: 0.3856 - val_loss: 13.1511 - val_accuracy10: 0.3886 - val_accuracy20: 0.3908 - val_accuracy30: 0.3849 - val_accuracy50: 0.3661 - 15s/epoch - 45ms/step
Epoch 2/50
339/339 - 9s - loss: 12.8677 - accuracy10: 0.4287 - accuracy20: 0.4200 - accuracy30: 0.4093 - accuracy50: 0.3979 - val_loss: 13.0927 - val_accuracy10: 0.3972 - val_accuracy20: 0.3950 - val_accuracy30: 0.3851 - val_accuracy50: 0.3644 - 9s/epoch - 27ms/step
Epoch 3/50
339/339 - 10s - loss: 12.7833 - accuracy10: 0.4484 - accuracy20: 0.4328 - accuracy30: 0.4183 - accuracy50: 0.4000 - val_loss: 13.2190 - val_accuracy10: 0.4018 - val_accuracy20: 0.3858 - val_accuracy30: 0.3718 - val_accuracy50: 0.3620 - 10s/epoch - 28ms/step
Epoch 4/50
339/339 - 9s - loss: 12.7424 - accuracy10: 0.4569 - accuracy20: 0.4400 - accuracy30: 0.4246 - accuracy50: 0.4007 - val_loss: 13.3826 - val_accuracy10: 0.3696 - val_accuracy20: 0.3547 - val_accuracy30: 0.3474 - val_accuracy50: 0.3599 - 9s/epoch - 27ms/step
Epoch 5/50
339/339 - 9s - loss: 12.6973 - accuracy10: 0.4630 - accuracy20: 0.4449 - accuracy30: 0.4278 - accuracy50: 0.4049 - val_loss: 13.2674 - val_accuracy10: 0.3956 - val_accuracy20: 0.3784 - val_accuracy30: 0.3711 - val_accuracy50: 0.3646 - 9s/epoch - 28ms/step
Epoch 6/50
339/339 - 9s - loss: 12.6253 - accuracy10: 0.4714 - accuracy20: 0.4513 - accuracy30: 0.4344 - accuracy50: 0.4109 - val_loss: 13.2241 - val_accuracy10: 0.4151 - val_accuracy20: 0.3989 - val_accuracy30: 0.3910 - val_accuracy50: 0.3715 - 9s/epoch - 27ms/step
Epoch 7/50
339/339 - 9s - loss: 12.5996 - accuracy10: 0.4745 - accuracy20: 0.4535 - accuracy30: 0.4378 - accuracy50: 0.4134 - val_loss: 13.2410 - val_accuracy10: 0.4227 - val_accuracy20: 0.4066 - val_accuracy30: 0.3952 - val_accuracy50: 0.3727 - 9s/epoch - 28ms/step
Epoch 8/50
339/339 - 9s - loss: 12.5679 - accuracy10: 0.4774 - accuracy20: 0.4565 - accuracy30: 0.4392 - accuracy50: 0.4144 - val_loss: 13.1219 - val_accuracy10: 0.4166 - val_accuracy20: 0.4014 - val_accuracy30: 0.3913 - val_accuracy50: 0.3733 - 9s/epoch - 27ms/step
Epoch 9/50
339/339 - 9s - loss: 12.5413 - accuracy10: 0.4821 - accuracy20: 0.4602 - accuracy30: 0.4425 - accuracy50: 0.4185 - val_loss: 13.3495 - val_accuracy10: 0.3907 - val_accuracy20: 0.3762 - val_accuracy30: 0.3693 - val_accuracy50: 0.3673 - 9s/epoch - 28ms/step
Epoch 10/50
339/339 - 9s - loss: 12.5154 - accuracy10: 0.4838 - accuracy20: 0.4622 - accuracy30: 0.4450 - accuracy50: 0.4211 - val_loss: 13.1369 - val_accuracy10: 0.4134 - val_accuracy20: 0.3971 - val_accuracy30: 0.3883 - val_accuracy50: 0.3729 - 9s/epoch - 27ms/step
Epoch 11/50
339/339 - 10s - loss: 12.4941 - accuracy10: 0.4869 - accuracy20: 0.4645 - accuracy30: 0.4481 - accuracy50: 0.4231 - val_loss: 13.2361 - val_accuracy10: 0.3906 - val_accuracy20: 0.3776 - val_accuracy30: 0.3746 - val_accuracy50: 0.3728 - 10s/epoch - 28ms/step
Epoch 12/50
339/339 - 9s - loss: 12.4715 - accuracy10: 0.4877 - accuracy20: 0.4664 - accuracy30: 0.4496 - accuracy50: 0.4260 - val_loss: 13.1567 - val_accuracy10: 0.4173 - val_accuracy20: 0.4028 - val_accuracy30: 0.3906 - val_accuracy50: 0.3768 - 9s/epoch - 28ms/step
testing model: results/XRAY/W4/deepLOB_L1/seq2seq
Evaluating performance on  test set...
989/989 - 13s - 13s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.09471
{'0': {'precision': 0.37797881297851926, 'recall': 0.2769559665408841, 'f1-score': 0.31967606776741797, 'support': 69697}, '1': {'precision': 0.5532461809635723, 'recall': 0.13093355117932318, 'f1-score': 0.2117528004610044, 'support': 115066}, '2': {'precision': 0.306335447821009, 'recall': 0.784491100489693, 'f1-score': 0.4406152984675181, 'support': 68206}, 'accuracy': 0.3473785325474663, 'macro avg': {'precision': 0.41252014725436686, 'recall': 0.39746020606996674, 'f1-score': 0.3240147222319802, 'support': 252969}, 'weighted avg': {'precision': 0.4383846635002629, 'recall': 0.3473785325474663, 'f1-score': 0.30319374184310016, 'support': 252969}}
[[19303  7243 43151]
 [21990 15066 78010]
 [ 9776  4923 53507]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.093087
{'0': {'precision': 0.38966935982434076, 'recall': 0.24904287641184245, 'f1-score': 0.30387511844795767, 'support': 73397}, '1': {'precision': 0.5058561643835616, 'recall': 0.1366432621948399, 'f1-score': 0.21516544184589836, 'support': 108099}, '2': {'precision': 0.31686079384824156, 'recall': 0.7840723070250304, 'f1-score': 0.451329464871765, 'support': 71473}, 'accuracy': 0.35217753954041797, 'macro avg': {'precision': 0.4041287726853813, 'recall': 0.3899194818772376, 'f1-score': 0.32345667505520703, 'support': 252969}, 'weighted avg': {'precision': 0.41874735258249485, 'recall': 0.35217753954041797, 'f1-score': 0.30762884784145167, 'support': 252969}}
[[18279  8506 46612]
 [19120 14771 74208]
 [ 9510  5923 56040]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0950729
{'0': {'precision': 0.40752748458182, 'recall': 0.21559650774409037, 'f1-score': 0.28200327243897916, 'support': 77543}, '1': {'precision': 0.4514535070268883, 'recall': 0.14028195975991545, 'f1-score': 0.2140509949491876, 'support': 100298}, '2': {'precision': 0.32762473724969576, 'recall': 0.78836119689064, 'f1-score': 0.4628850993325726, 'support': 75128}, 'accuracy': 0.3558380671149429, 'macro avg': {'precision': 0.39553524295280135, 'recall': 0.38141322146488194, 'f1-score': 0.3196464555735798, 'support': 252969}, 'weighted avg': {'precision': 0.40121350380800036, 'recall': 0.3558380671149429, 'f1-score': 0.3087805153548731, 'support': 252969}}
[[16718  9845 50980]
 [15656 14070 70572]
 [ 8649  7251 59228]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1043129
{'0': {'precision': 0.3686864442390117, 'recall': 0.18528268949205992, 'f1-score': 0.24662462873258442, 'support': 71032}, '1': {'precision': 0.4936909909114974, 'recall': 0.14491314708015332, 'f1-score': 0.22405841403752325, 'support': 115828}, '2': {'precision': 0.2836424350559002, 'recall': 0.7863377149858567, 'f1-score': 0.41690258318563483, 'support': 66109}, 'accuracy': 0.32387367622119706, 'macro avg': {'precision': 0.3820066234021364, 'recall': 0.37217785051935665, 'f1-score': 0.2958618753185808, 'support': 252969}, 'weighted avg': {'precision': 0.40369805526207914, 'recall': 0.32387367622119706, 'f1-score': 0.28079128858117125, 'support': 252969}}
[[13161  9833 48038]
 [15792 16785 83251]
 [ 6744  7381 51984]]
Evaluating performance on  train set...
339/339 - 4s - 4s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0786439
{'0': {'precision': 0.44144144144144143, 'recall': 0.25665419561731695, 'f1-score': 0.32459105042584835, 'support': 28065}, '1': {'precision': 0.49014344434191764, 'recall': 0.19399714465951726, 'f1-score': 0.2779733587059943, 'support': 30119}, '2': {'precision': 0.3802312019758507, 'recall': 0.781754707666267, 'f1-score': 0.511619856453809, 'support': 28358}, 'accuracy': 0.40691225069908254, 'macro avg': {'precision': 0.4372720292530699, 'recall': 0.4108020159810337, 'f1-score': 0.37139475519521725, 'support': 86542}, 'weighted avg': {'precision': 0.4383337671860998, 'recall': 0.40691225069908254, 'f1-score': 0.36965223025102717, 'support': 86542}}
[[ 7203  3384 17478]
 [ 5619  5843 18657]
 [ 3495  2694 22169]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0843667
{'0': {'precision': 0.43878357030015797, 'recall': 0.23215964893950475, 'f1-score': 0.3036556200888281, 'support': 28713}, '1': {'precision': 0.44164573792288375, 'recall': 0.20769791919963873, 'f1-score': 0.2825280567040756, 'support': 28787}, '2': {'precision': 0.3812703245001038, 'recall': 0.7589697679223194, 'f1-score': 0.5075644184493517, 'support': 29042}, 'accuracy': 0.4008111668322895, 'macro avg': {'precision': 0.4205665442410485, 'recall': 0.3996091120204876, 'f1-score': 0.3645826984140852, 'support': 86542}, 'weighted avg': {'precision': 0.4204351791701891, 'recall': 0.4008111668322895, 'f1-score': 0.3650560979473183, 'support': 86542}}
[[ 6666  4087 17960]
 [ 4998  5979 17810]
 [ 3528  3472 22042]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0878652
{'0': {'precision': 0.4447956483387239, 'recall': 0.2078667124699416, 'f1-score': 0.2833263098749825, 'support': 29110}, '1': {'precision': 0.4139272515074888, 'recall': 0.22800814314796958, 'f1-score': 0.29404449357468565, 'support': 27999}, '2': {'precision': 0.3798139615752412, 'recall': 0.7421941358339279, 'f1-score': 0.5024842434558587, 'support': 29433}, 'accuracy': 0.39610824801830324, 'macro avg': {'precision': 0.412845620473818, 'recall': 0.39268966381727965, 'f1-score': 0.35995168230184227, 'support': 86542}, 'weighted avg': {'precision': 0.4127084510312047, 'recall': 0.39610824801830324, 'f1-score': 0.3613297519550583, 'support': 86542}}
[[ 6051  4725 18334]
 [ 4279  6384 17336]
 [ 3274  4314 21845]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0961905
{'0': {'precision': 0.4175470452294487, 'recall': 0.1757695782086026, 'f1-score': 0.24739596068267397, 'support': 28782}, '1': {'precision': 0.38920211857167264, 'recall': 0.23909316726725677, 'f1-score': 0.2962160287807204, 'support': 28583}, '2': {'precision': 0.36710218580195897, 'recall': 0.7154950817424683, 'f1-score': 0.48524010971131043, 'support': 29177}, 'accuracy': 0.3786485174828407, 'macro avg': {'precision': 0.39128378320102675, 'recall': 0.37678594240610924, 'f1-score': 0.3429506997249016, 'support': 86542}, 'weighted avg': {'precision': 0.3911781988638102, 'recall': 0.3786485174828407, 'f1-score': 0.34370760985480986, 'support': 86542}}
[[ 5059  5442 18281]
 [ 4039  6834 17710]
 [ 3018  5283 20876]]
Evaluating performance on  val set...
124/124 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.082986
{'0': {'precision': 0.4085205424003238, 'recall': 0.3763400764426214, 'f1-score': 0.3917705856664564, 'support': 10727}, '1': {'precision': 0.3949080622347949, 'recall': 0.1411526794742164, 'f1-score': 0.20797020484171322, 'support': 9890}, '2': {'precision': 0.3873033397736682, 'recall': 0.6427851580393953, 'f1-score': 0.48336203926972093, 'support': 10915}, 'accuracy': 0.39480527717873903, 'macro avg': {'precision': 0.3969106481362623, 'recall': 0.3867593046520777, 'f1-score': 0.3610342765926302, 'support': 31532}, 'weighted avg': {'precision': 0.39690652503678747, 'recall': 0.39480527717873903, 'f1-score': 0.3658266223822665, 'support': 31532}}
[[4037 1201 5489]
 [2884 1396 5610]
 [2961  938 7016]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0868297
{'0': {'precision': 0.4134818941504178, 'recall': 0.3388112845795672, 'f1-score': 0.3724407868325973, 'support': 10953}, '1': {'precision': 0.35377086931491075, 'recall': 0.13181038181038182, 'f1-score': 0.19206125957180809, 'support': 9324}, '2': {'precision': 0.3924959387936907, 'recall': 0.6654820079964461, 'f1-score': 0.4937701892016613, 'support': 11255}, 'accuracy': 0.39420271470252444, 'macro avg': {'precision': 0.38658290075300644, 'recall': 0.37870122479546503, 'f1-score': 0.3527574118686889, 'support': 31532}, 'weighted avg': {'precision': 0.3883346620336402, 'recall': 0.39420271470252444, 'f1-score': 0.36240982499967256, 'support': 31532}}
[[3711 1207 6035]
 [2537 1229 5558]
 [2727 1038 7490]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.092878
{'0': {'precision': 0.40070047995849006, 'recall': 0.28628359592215014, 'f1-score': 0.33396399805394883, 'support': 10790}, '1': {'precision': 0.33151017927681553, 'recall': 0.11492678815969662, 'f1-score': 0.17068210262828534, 'support': 9493}, '2': {'precision': 0.38330411065653613, 'recall': 0.6996177437994489, 'f1-score': 0.49526446619049125, 'support': 11249}, 'accuracy': 0.3821514651782316, 'macro avg': {'precision': 0.37183825663061393, 'recall': 0.3669427092937652, 'f1-score': 0.3333035222909085, 'support': 31532}, 'weighted avg': {'precision': 0.3736639683940851, 'recall': 0.3821514651782316, 'f1-score': 0.34235020675597033, 'support': 31532}}
[[3089 1152 6549]
 [2289 1091 6113]
 [2331 1048 7870]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1002288
{'0': {'precision': 0.37989255564082886, 'recall': 0.2375467895191477, 'f1-score': 0.2923113263257352, 'support': 10419}, '1': {'precision': 0.38038496791934007, 'recall': 0.12060447544318512, 'f1-score': 0.1831421006178288, 'support': 10323}, '2': {'precision': 0.3593635025754231, 'recall': 0.7241890639481001, 'f1-score': 0.4803590090367001, 'support': 10790}, 'accuracy': 0.36578713687682357, 'macro avg': {'precision': 0.3732136753785307, 'recall': 0.360780109636811, 'f1-score': 0.3186041453267547, 'support': 31532}, 'weighted avg': {'precision': 0.3730288834784333, 'recall': 0.36578713687682357, 'f1-score': 0.32091974252098426, 'support': 31532}}
[[2475 1011 6933]
 [2081 1245 6997]
 [1959 1017 7814]]
training model: results/XRAY/W4/deepOF_L1/seq2seq
Epoch 1/50
339/339 - 14s - loss: 13.0937 - accuracy10: 0.3914 - accuracy20: 0.3875 - accuracy30: 0.3829 - accuracy50: 0.3787 - val_loss: 13.1159 - val_accuracy10: 0.3762 - val_accuracy20: 0.3680 - val_accuracy30: 0.3650 - val_accuracy50: 0.3610 - 14s/epoch - 42ms/step
Epoch 2/50
339/339 - 9s - loss: 12.9806 - accuracy10: 0.4074 - accuracy20: 0.4032 - accuracy30: 0.3973 - accuracy50: 0.3907 - val_loss: 13.0748 - val_accuracy10: 0.3822 - val_accuracy20: 0.3790 - val_accuracy30: 0.3733 - val_accuracy50: 0.3647 - 9s/epoch - 25ms/step
Epoch 3/50
339/339 - 9s - loss: 12.9541 - accuracy10: 0.4109 - accuracy20: 0.4066 - accuracy30: 0.3993 - accuracy50: 0.3936 - val_loss: 13.0668 - val_accuracy10: 0.3841 - val_accuracy20: 0.3706 - val_accuracy30: 0.3666 - val_accuracy50: 0.3695 - 9s/epoch - 28ms/step
Epoch 4/50
339/339 - 9s - loss: 12.9143 - accuracy10: 0.4163 - accuracy20: 0.4115 - accuracy30: 0.4055 - accuracy50: 0.3975 - val_loss: 13.0739 - val_accuracy10: 0.3729 - val_accuracy20: 0.3633 - val_accuracy30: 0.3635 - val_accuracy50: 0.3688 - 9s/epoch - 26ms/step
Epoch 5/50
339/339 - 9s - loss: 12.8947 - accuracy10: 0.4204 - accuracy20: 0.4149 - accuracy30: 0.4068 - accuracy50: 0.3983 - val_loss: 13.0672 - val_accuracy10: 0.3825 - val_accuracy20: 0.3690 - val_accuracy30: 0.3703 - val_accuracy50: 0.3739 - 9s/epoch - 27ms/step
Epoch 6/50
339/339 - 9s - loss: 12.8757 - accuracy10: 0.4226 - accuracy20: 0.4161 - accuracy30: 0.4079 - accuracy50: 0.3980 - val_loss: 13.0686 - val_accuracy10: 0.3802 - val_accuracy20: 0.3709 - val_accuracy30: 0.3723 - val_accuracy50: 0.3777 - 9s/epoch - 27ms/step
Epoch 7/50
339/339 - 9s - loss: 12.8553 - accuracy10: 0.4242 - accuracy20: 0.4185 - accuracy30: 0.4098 - accuracy50: 0.3999 - val_loss: 13.0630 - val_accuracy10: 0.3793 - val_accuracy20: 0.3713 - val_accuracy30: 0.3734 - val_accuracy50: 0.3791 - 9s/epoch - 27ms/step
Epoch 8/50
339/339 - 9s - loss: 12.8306 - accuracy10: 0.4275 - accuracy20: 0.4205 - accuracy30: 0.4134 - accuracy50: 0.4043 - val_loss: 13.0828 - val_accuracy10: 0.3707 - val_accuracy20: 0.3642 - val_accuracy30: 0.3727 - val_accuracy50: 0.3743 - 9s/epoch - 26ms/step
Epoch 9/50
339/339 - 9s - loss: 12.8143 - accuracy10: 0.4286 - accuracy20: 0.4219 - accuracy30: 0.4156 - accuracy50: 0.4080 - val_loss: 13.0758 - val_accuracy10: 0.3717 - val_accuracy20: 0.3638 - val_accuracy30: 0.3728 - val_accuracy50: 0.3749 - 9s/epoch - 27ms/step
Epoch 10/50
339/339 - 9s - loss: 12.7974 - accuracy10: 0.4323 - accuracy20: 0.4247 - accuracy30: 0.4153 - accuracy50: 0.4050 - val_loss: 13.1026 - val_accuracy10: 0.3729 - val_accuracy20: 0.3605 - val_accuracy30: 0.3676 - val_accuracy50: 0.3733 - 9s/epoch - 26ms/step
Epoch 11/50
339/339 - 9s - loss: 12.7820 - accuracy10: 0.4319 - accuracy20: 0.4260 - accuracy30: 0.4183 - accuracy50: 0.4073 - val_loss: 13.0796 - val_accuracy10: 0.3725 - val_accuracy20: 0.3657 - val_accuracy30: 0.3738 - val_accuracy50: 0.3794 - 9s/epoch - 26ms/step
Epoch 12/50
339/339 - 9s - loss: 12.7642 - accuracy10: 0.4353 - accuracy20: 0.4292 - accuracy30: 0.4205 - accuracy50: 0.4120 - val_loss: 13.0874 - val_accuracy10: 0.3775 - val_accuracy20: 0.3636 - val_accuracy30: 0.3698 - val_accuracy50: 0.3767 - 9s/epoch - 26ms/step
Epoch 13/50
339/339 - 9s - loss: 12.7489 - accuracy10: 0.4359 - accuracy20: 0.4295 - accuracy30: 0.4215 - accuracy50: 0.4131 - val_loss: 13.0862 - val_accuracy10: 0.3745 - val_accuracy20: 0.3644 - val_accuracy30: 0.3737 - val_accuracy50: 0.3807 - 9s/epoch - 26ms/step
Epoch 14/50
339/339 - 9s - loss: 12.7273 - accuracy10: 0.4390 - accuracy20: 0.4325 - accuracy30: 0.4238 - accuracy50: 0.4150 - val_loss: 13.0741 - val_accuracy10: 0.3783 - val_accuracy20: 0.3680 - val_accuracy30: 0.3744 - val_accuracy50: 0.3780 - 9s/epoch - 27ms/step
Epoch 15/50
339/339 - 9s - loss: 12.7054 - accuracy10: 0.4420 - accuracy20: 0.4346 - accuracy30: 0.4263 - accuracy50: 0.4170 - val_loss: 13.0787 - val_accuracy10: 0.3833 - val_accuracy20: 0.3714 - val_accuracy30: 0.3751 - val_accuracy50: 0.3800 - 9s/epoch - 26ms/step
Epoch 16/50
339/339 - 9s - loss: 12.6882 - accuracy10: 0.4429 - accuracy20: 0.4361 - accuracy30: 0.4290 - accuracy50: 0.4202 - val_loss: 13.0796 - val_accuracy10: 0.3809 - val_accuracy20: 0.3712 - val_accuracy30: 0.3753 - val_accuracy50: 0.3819 - 9s/epoch - 26ms/step
Epoch 17/50
339/339 - 9s - loss: 12.6759 - accuracy10: 0.4442 - accuracy20: 0.4372 - accuracy30: 0.4300 - accuracy50: 0.4196 - val_loss: 13.0871 - val_accuracy10: 0.3766 - val_accuracy20: 0.3674 - val_accuracy30: 0.3747 - val_accuracy50: 0.3766 - 9s/epoch - 26ms/step
testing model: results/XRAY/W4/deepOF_L1/seq2seq
Evaluating performance on  test set...
989/989 - 12s - 12s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0608044
{'0': {'precision': 0.3978284019167871, 'recall': 0.30017504591368227, 'f1-score': 0.34217068463576594, 'support': 69696}, '1': {'precision': 0.48935035854237197, 'recall': 0.638143657932473, 'f1-score': 0.5539290200175772, 'support': 115065}, '2': {'precision': 0.3756383507203179, 'recall': 0.27716849451645065, 'f1-score': 0.31897679049009103, 'support': 68204}, 'accuracy': 0.4477022512995869, 'macro avg': {'precision': 0.4209390370598256, 'recall': 0.40516239945420196, 'f1-score': 0.4050254983811447, 'support': 252965}, 'weighted avg': {'precision': 0.43347571947976593, 'recall': 0.4477022512995869, 'f1-score': 0.43223870394435215, 'support': 252965}}
[[20921 37858 10917]
 [21133 73428 20504]
 [10534 38766 18904]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0691375
{'0': {'precision': 0.41120498557028734, 'recall': 0.2679028829908987, 'f1-score': 0.3244344712656954, 'support': 73396}, '1': {'precision': 0.4508699083765142, 'recall': 0.6077263224111454, 'f1-score': 0.5176770960154136, 'support': 108098}, '2': {'precision': 0.3737592947747384, 'recall': 0.3108533531082537, 'f1-score': 0.33941625354242894, 'support': 71471}, 'accuracy': 0.4252525052872927, 'macro avg': {'precision': 0.4119447295738466, 'recall': 0.3954941861700993, 'f1-score': 0.39384260694117934, 'support': 252965}, 'weighted avg': {'precision': 0.41757510736049086, 'recall': 0.4252525052872927, 'f1-score': 0.41124452092195407, 'support': 252965}}
[[19663 40521 13212]
 [18391 65694 24013]
 [ 9764 39490 22217]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0769699
{'0': {'precision': 0.4252800145995392, 'recall': 0.24042454411802636, 'f1-score': 0.3071865808747806, 'support': 77542}, '1': {'precision': 0.4137049199383918, 'recall': 0.5677537712992412, 'f1-score': 0.4786396627735447, 'support': 100297}, '2': {'precision': 0.37464327681718984, 'recall': 0.35648111173228975, 'f1-score': 0.36533660732555756, 'support': 75126}, 'accuracy': 0.40467258316367877, 'macro avg': {'precision': 0.40454273711837363, 'recall': 0.3882198090498525, 'f1-score': 0.38372095032462766, 'support': 252965}, 'weighted avg': {'precision': 0.4056524659984842, 'recall': 0.40467258316367877, 'f1-score': 0.3924347718986037, 'support': 252965}}
[[18643 41792 17107]
 [15757 56944 27596]
 [ 9437 38908 26781]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0774579
{'0': {'precision': 0.3669541817832344, 'recall': 0.21501879461080373, 'f1-score': 0.27115364130241804, 'support': 71031}, '1': {'precision': 0.4619757891931615, 'recall': 0.49389175235480504, 'f1-score': 0.4774009413492673, 'support': 115827}, '2': {'precision': 0.3133405701879678, 'recall': 0.41481234967552605, 'f1-score': 0.35700615797216545, 'support': 66107}, 'accuracy': 0.3949202458838179, 'macro avg': {'precision': 0.38075684705478796, 'recall': 0.37457429888037824, 'f1-score': 0.36852024687461693, 'support': 252965}, 'weighted avg': {'precision': 0.3964516723441473, 'recall': 0.3949202458838179, 'f1-score': 0.38802537589816605, 'support': 252965}}
[[15273 35716 20042]
 [18570 57206 40051]
 [ 7778 30907 27422]]
Evaluating performance on  train set...
339/339 - 4s - 4s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0739017
{'0': {'precision': 0.44894570811887763, 'recall': 0.28961085326669045, 'f1-score': 0.35209097419648866, 'support': 28010}, '1': {'precision': 0.3782352821390026, 'recall': 0.6152775937458593, 'f1-score': 0.4684784664859071, 'support': 30188}, '2': {'precision': 0.4301797149349308, 'recall': 0.2939100980876438, 'f1-score': 0.3492223200436004, 'support': 28342}, 'accuracy': 0.4046221400508435, 'macro avg': {'precision': 0.4191202350642704, 'recall': 0.3995995150333978, 'f1-score': 0.3899305869086654, 'support': 86540}, 'weighted avg': {'precision': 0.4181336891877488, 'recall': 0.4046221400508435, 'f1-score': 0.39175127256986286, 'support': 86540}}
[[ 8112 14882  5016]
 [ 5596 18574  6018]
 [ 4361 15651  8330]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0782149
{'0': {'precision': 0.4560953253895509, 'recall': 0.26054174811505165, 'f1-score': 0.3316375269366627, 'support': 28648}, '1': {'precision': 0.3580595323926254, 'recall': 0.6024539026757244, 'f1-score': 0.4491646963060584, 'support': 28852}, '2': {'precision': 0.43250115580212667, 'recall': 0.3221418732782369, 'f1-score': 0.3692520228932307, 'support': 29040}, 'accuracy': 0.39520452969724984, 'macro avg': {'precision': 0.4155520045281009, 'recall': 0.39504584135633763, 'f1-score': 0.3833514153786506, 'support': 86540}, 'weighted avg': {'precision': 0.4154932525403934, 'recall': 0.39520452969724984, 'f1-score': 0.38344269048212776, 'support': 86540}}
[[ 7464 15439  5745]
 [ 4940 17382  6530]
 [ 3961 15724  9355]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0813571
{'0': {'precision': 0.4584294850662623, 'recall': 0.23938715785849543, 'f1-score': 0.31452999185741426, 'support': 29045}, '1': {'precision': 0.3440279063758317, 'recall': 0.568030717815622, 'f1-score': 0.4285216178521618, 'support': 28127}, '2': {'precision': 0.423953152575004, 'recall': 0.35991555434486516, 'f1-score': 0.3893186003683241, 'support': 29368}, 'accuracy': 0.3871042292581465, 'macro avg': {'precision': 0.40880351467236603, 'recall': 0.38911114333966085, 'f1-score': 0.3774567366926334, 'support': 86540}, 'weighted avg': {'precision': 0.4095471862861719, 'recall': 0.3871042292581465, 'f1-score': 0.37695932302337987, 'support': 86540}}
[[ 6953 15305  6787]
 [ 4575 15977  7575]
 [ 3639 15159 10570]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0846857
{'0': {'precision': 0.433617456529151, 'recall': 0.22145220268152532, 'f1-score': 0.2931765790686952, 'support': 28715}, '1': {'precision': 0.3482734484367709, 'recall': 0.5209031267448353, 'f1-score': 0.41744504726215115, 'support': 28656}, '2': {'precision': 0.4074099603653283, 'recall': 0.4052590078508005, 'f1-score': 0.40633163756359136, 'support': 29169}, 'accuracy': 0.3825629766581927, 'macro avg': {'precision': 0.3964336217770834, 'recall': 0.3825381124257204, 'f1-score': 0.37231775463147926, 'support': 86540}, 'weighted avg': {'precision': 0.3965240390170435, 'recall': 0.3825629766581927, 'f1-score': 0.37246542960936196, 'support': 86540}}
[[ 6359 14126  8230]
 [ 4765 14927  8964]
 [ 3541 13807 11821]]
Evaluating performance on  val set...
124/124 - 2s - 2s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.08661
{'0': {'precision': 0.44162011173184357, 'recall': 0.2973201692524683, 'f1-score': 0.3553807249227311, 'support': 10635}, '1': {'precision': 0.32388947184330186, 'recall': 0.5633745690529305, 'f1-score': 0.41131181522061006, 'support': 9862}, '2': {'precision': 0.456359102244389, 'recall': 0.29850475758948797, 'f1-score': 0.3609269709088917, 'support': 11035}, 'accuracy': 0.38094634022580237, 'macro avg': {'precision': 0.40728956193984484, 'recall': 0.38639983196496225, 'f1-score': 0.37587317035074425, 'support': 31532}, 'weighted avg': {'precision': 0.409956569607181, 'recall': 0.38094634022580237, 'f1-score': 0.37481479941768747, 'support': 31532}}
[[3162 5623 1850]
 [2232 5556 2074]
 [1766 5975 3294]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0895743
{'0': {'precision': 0.45475929120275993, 'recall': 0.26585991932526587, 'f1-score': 0.3355510558287532, 'support': 10908}, '1': {'precision': 0.30162212087975526, 'recall': 0.5638894884524066, 'f1-score': 0.3930196697882583, 'support': 9266}, '2': {'precision': 0.45914198161389175, 'recall': 0.3166050360979046, 'f1-score': 0.37477853048462745, 'support': 11358}, 'accuracy': 0.3717176201953571, 'macro avg': {'precision': 0.40517446456546896, 'recall': 0.38211814795852567, 'f1-score': 0.367783085367213, 'support': 31532}, 'weighted avg': {'precision': 0.41133704007617977, 'recall': 0.3717176201953571, 'f1-score': 0.3665687468756324, 'support': 31532}}
[[2900 5924 2084]
 [1889 5225 2152]
 [1588 6174 3596]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0871234
{'0': {'precision': 0.4468269064499395, 'recall': 0.23952539859102706, 'f1-score': 0.31187013457244583, 'support': 10788}, '1': {'precision': 0.31256687670907146, 'recall': 0.5541736930860034, 'f1-score': 0.3996959331052832, 'support': 9488}, '2': {'precision': 0.44931107874986, 'recall': 0.35634328358208955, 'f1-score': 0.3974632116137343, 'support': 11256}, 'accuracy': 0.37590384371432195, 'macro avg': {'precision': 0.4029016206362903, 'recall': 0.3833474584197067, 'f1-score': 0.36967642643048776, 'support': 31532}, 'weighted avg': {'precision': 0.4073147499494495, 'recall': 0.37590384371432195, 'f1-score': 0.36885119672062244, 'support': 31532}}
[[2584 5773 2431]
 [1745 5258 2485]
 [1454 5791 4011]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0877804
{'0': {'precision': 0.4158056914990031, 'recall': 0.22066179299730665, 'f1-score': 0.2883177276440646, 'support': 10396}, '1': {'precision': 0.34020222705746833, 'recall': 0.5136728186298193, 'f1-score': 0.4093166506256015, 'support': 10349}, '2': {'precision': 0.4128405043796323, 'recall': 0.3976082321312691, 'f1-score': 0.4050812240272006, 'support': 10787}, 'accuracy': 0.37736267918305216, 'macro avg': {'precision': 0.3896161409787013, 'recall': 0.3773142812527983, 'f1-score': 0.3675718674322889, 'support': 31532}, 'weighted avg': {'precision': 0.3899777793157576, 'recall': 0.37736267918305216, 'f1-score': 0.36797476460400413, 'support': 31532}}
[[2294 5214 2888]
 [1821 5316 3212]
 [1402 5096 4289]]
training model: results/XRAY/W4/deepLOB_L2/seq2seq
Epoch 1/50
339/339 - 24s - loss: 13.1836 - accuracy10: 0.3792 - accuracy20: 0.3752 - accuracy30: 0.3692 - accuracy50: 0.3680 - val_loss: 13.4051 - val_accuracy10: 0.3580 - val_accuracy20: 0.3509 - val_accuracy30: 0.3369 - val_accuracy50: 0.3524 - 24s/epoch - 70ms/step
Epoch 2/50
339/339 - 18s - loss: 12.9141 - accuracy10: 0.4202 - accuracy20: 0.4109 - accuracy30: 0.3993 - accuracy50: 0.3894 - val_loss: 13.4023 - val_accuracy10: 0.3802 - val_accuracy20: 0.3822 - val_accuracy30: 0.3728 - val_accuracy50: 0.3622 - 18s/epoch - 53ms/step
Epoch 3/50
339/339 - 18s - loss: 12.7674 - accuracy10: 0.4454 - accuracy20: 0.4332 - accuracy30: 0.4183 - accuracy50: 0.4027 - val_loss: 13.5335 - val_accuracy10: 0.3714 - val_accuracy20: 0.3784 - val_accuracy30: 0.3729 - val_accuracy50: 0.3578 - 18s/epoch - 52ms/step
Epoch 4/50
339/339 - 18s - loss: 12.6638 - accuracy10: 0.4580 - accuracy20: 0.4439 - accuracy30: 0.4296 - accuracy50: 0.4085 - val_loss: 13.2216 - val_accuracy10: 0.3903 - val_accuracy20: 0.3926 - val_accuracy30: 0.3853 - val_accuracy50: 0.3644 - 18s/epoch - 52ms/step
Epoch 5/50
339/339 - 18s - loss: 12.5932 - accuracy10: 0.4686 - accuracy20: 0.4534 - accuracy30: 0.4367 - accuracy50: 0.4153 - val_loss: 13.3878 - val_accuracy10: 0.3806 - val_accuracy20: 0.3859 - val_accuracy30: 0.3791 - val_accuracy50: 0.3575 - 18s/epoch - 52ms/step
Epoch 6/50
339/339 - 18s - loss: 12.5281 - accuracy10: 0.4771 - accuracy20: 0.4596 - accuracy30: 0.4429 - accuracy50: 0.4197 - val_loss: 13.4184 - val_accuracy10: 0.3714 - val_accuracy20: 0.3767 - val_accuracy30: 0.3726 - val_accuracy50: 0.3533 - 18s/epoch - 53ms/step
Epoch 7/50
339/339 - 18s - loss: 12.4590 - accuracy10: 0.4828 - accuracy20: 0.4662 - accuracy30: 0.4491 - accuracy50: 0.4275 - val_loss: 13.6190 - val_accuracy10: 0.3604 - val_accuracy20: 0.3685 - val_accuracy30: 0.3654 - val_accuracy50: 0.3491 - 18s/epoch - 53ms/step
Epoch 8/50
339/339 - 18s - loss: 12.4075 - accuracy10: 0.4890 - accuracy20: 0.4715 - accuracy30: 0.4534 - accuracy50: 0.4312 - val_loss: 13.6052 - val_accuracy10: 0.3636 - val_accuracy20: 0.3712 - val_accuracy30: 0.3670 - val_accuracy50: 0.3520 - 18s/epoch - 53ms/step
Epoch 9/50
339/339 - 18s - loss: 12.3570 - accuracy10: 0.4930 - accuracy20: 0.4763 - accuracy30: 0.4584 - accuracy50: 0.4363 - val_loss: 13.5710 - val_accuracy10: 0.3615 - val_accuracy20: 0.3699 - val_accuracy30: 0.3672 - val_accuracy50: 0.3515 - 18s/epoch - 53ms/step
Epoch 10/50
339/339 - 19s - loss: 12.3234 - accuracy10: 0.4946 - accuracy20: 0.4773 - accuracy30: 0.4603 - accuracy50: 0.4404 - val_loss: 13.4244 - val_accuracy10: 0.3718 - val_accuracy20: 0.3794 - val_accuracy30: 0.3731 - val_accuracy50: 0.3541 - 19s/epoch - 55ms/step
Epoch 11/50
339/339 - 18s - loss: 12.2870 - accuracy10: 0.4974 - accuracy20: 0.4826 - accuracy30: 0.4650 - accuracy50: 0.4449 - val_loss: 13.4352 - val_accuracy10: 0.3751 - val_accuracy20: 0.3787 - val_accuracy30: 0.3722 - val_accuracy50: 0.3532 - 18s/epoch - 52ms/step
Epoch 12/50
339/339 - 18s - loss: 12.2319 - accuracy10: 0.5016 - accuracy20: 0.4877 - accuracy30: 0.4704 - accuracy50: 0.4478 - val_loss: 13.4129 - val_accuracy10: 0.3788 - val_accuracy20: 0.3829 - val_accuracy30: 0.3771 - val_accuracy50: 0.3586 - 18s/epoch - 53ms/step
Epoch 13/50
339/339 - 18s - loss: 12.1914 - accuracy10: 0.5039 - accuracy20: 0.4893 - accuracy30: 0.4743 - accuracy50: 0.4513 - val_loss: 13.1324 - val_accuracy10: 0.4106 - val_accuracy20: 0.4072 - val_accuracy30: 0.3928 - val_accuracy50: 0.3718 - 18s/epoch - 53ms/step
Epoch 14/50
339/339 - 18s - loss: 12.1685 - accuracy10: 0.5044 - accuracy20: 0.4923 - accuracy30: 0.4745 - accuracy50: 0.4525 - val_loss: 13.1257 - val_accuracy10: 0.4103 - val_accuracy20: 0.4059 - val_accuracy30: 0.3933 - val_accuracy50: 0.3705 - 18s/epoch - 53ms/step
Epoch 15/50
339/339 - 18s - loss: 12.1318 - accuracy10: 0.5060 - accuracy20: 0.4950 - accuracy30: 0.4807 - accuracy50: 0.4570 - val_loss: 13.2651 - val_accuracy10: 0.3946 - val_accuracy20: 0.3937 - val_accuracy30: 0.3857 - val_accuracy50: 0.3632 - 18s/epoch - 54ms/step
Epoch 16/50
339/339 - 18s - loss: 12.0839 - accuracy10: 0.5094 - accuracy20: 0.4987 - accuracy30: 0.4837 - accuracy50: 0.4619 - val_loss: 13.2468 - val_accuracy10: 0.4092 - val_accuracy20: 0.4041 - val_accuracy30: 0.3888 - val_accuracy50: 0.3647 - 18s/epoch - 53ms/step
Epoch 17/50
339/339 - 18s - loss: 12.0466 - accuracy10: 0.5136 - accuracy20: 0.5029 - accuracy30: 0.4877 - accuracy50: 0.4649 - val_loss: 13.2409 - val_accuracy10: 0.4102 - val_accuracy20: 0.4041 - val_accuracy30: 0.3889 - val_accuracy50: 0.3663 - 18s/epoch - 53ms/step
Epoch 18/50
339/339 - 18s - loss: 12.0192 - accuracy10: 0.5130 - accuracy20: 0.5035 - accuracy30: 0.4889 - accuracy50: 0.4657 - val_loss: 13.3710 - val_accuracy10: 0.4063 - val_accuracy20: 0.3980 - val_accuracy30: 0.3830 - val_accuracy50: 0.3667 - 18s/epoch - 53ms/step
Epoch 19/50
339/339 - 18s - loss: 11.9673 - accuracy10: 0.5157 - accuracy20: 0.5068 - accuracy30: 0.4940 - accuracy50: 0.4711 - val_loss: 13.3162 - val_accuracy10: 0.4078 - val_accuracy20: 0.3995 - val_accuracy30: 0.3847 - val_accuracy50: 0.3704 - 18s/epoch - 53ms/step
Epoch 20/50
339/339 - 18s - loss: 11.9414 - accuracy10: 0.5177 - accuracy20: 0.5092 - accuracy30: 0.4951 - accuracy50: 0.4731 - val_loss: 13.3347 - val_accuracy10: 0.4139 - val_accuracy20: 0.4036 - val_accuracy30: 0.3868 - val_accuracy50: 0.3715 - 18s/epoch - 53ms/step
Epoch 21/50
339/339 - 18s - loss: 11.8843 - accuracy10: 0.5207 - accuracy20: 0.5134 - accuracy30: 0.4997 - accuracy50: 0.4793 - val_loss: 13.3653 - val_accuracy10: 0.4171 - val_accuracy20: 0.4078 - val_accuracy30: 0.3896 - val_accuracy50: 0.3698 - 18s/epoch - 53ms/step
Epoch 22/50
339/339 - 18s - loss: 11.8682 - accuracy10: 0.5206 - accuracy20: 0.5143 - accuracy30: 0.5006 - accuracy50: 0.4783 - val_loss: 13.3930 - val_accuracy10: 0.4109 - val_accuracy20: 0.3995 - val_accuracy30: 0.3812 - val_accuracy50: 0.3658 - 18s/epoch - 53ms/step
Epoch 23/50
339/339 - 18s - loss: 11.8130 - accuracy10: 0.5258 - accuracy20: 0.5187 - accuracy30: 0.5044 - accuracy50: 0.4851 - val_loss: 13.5020 - val_accuracy10: 0.4030 - val_accuracy20: 0.3958 - val_accuracy30: 0.3774 - val_accuracy50: 0.3629 - 18s/epoch - 53ms/step
Epoch 24/50
339/339 - 18s - loss: 11.7898 - accuracy10: 0.5252 - accuracy20: 0.5205 - accuracy30: 0.5062 - accuracy50: 0.4854 - val_loss: 13.7069 - val_accuracy10: 0.4022 - val_accuracy20: 0.3925 - val_accuracy30: 0.3791 - val_accuracy50: 0.3664 - 18s/epoch - 53ms/step
testing model: results/XRAY/W4/deepLOB_L2/seq2seq
Evaluating performance on  test set...
989/989 - 20s - 20s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1466659
{'0': {'precision': 0.4077345167566622, 'recall': 0.26760118799948346, 'f1-score': 0.3231288981288981, 'support': 69697}, '1': {'precision': 0.625744747569771, 'recall': 0.10405332591729964, 'f1-score': 0.17843517138599105, 'support': 115066}, '2': {'precision': 0.30878506262892624, 'recall': 0.8515379878603055, 'f1-score': 0.45322242077581554, 'support': 68206}, 'accuracy': 0.35065166087544325, 'macro avg': {'precision': 0.4474214423184531, 'recall': 0.4077308339256962, 'f1-score': 0.3182621634302349, 'support': 252969}, 'weighted avg': {'precision': 0.4802201523503706, 'recall': 0.35065166087544325, 'f1-score': 0.29238928356844335, 'support': 252969}}
[[18651  3619 47427]
 [20508 11973 82585]
 [ 6584  3542 58080]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1320969
{'0': {'precision': 0.41738219418315986, 'recall': 0.24968322955979128, 'f1-score': 0.31245311327831954, 'support': 73397}, '1': {'precision': 0.5674821610601427, 'recall': 0.1029981775964625, 'f1-score': 0.17435150604060476, 'support': 108099}, '2': {'precision': 0.3164345815605832, 'recall': 0.838722314720244, 'f1-score': 0.4595059693770002, 'support': 71473}, 'accuracy': 0.35342670445785845, 'macro avg': {'precision': 0.43376631226796186, 'recall': 0.3971345739588326, 'f1-score': 0.3154368628986415, 'support': 252969}, 'weighted avg': {'precision': 0.45300168749048825, 'recall': 0.35342670445785845, 'f1-score': 0.29498719114221306, 'support': 252969}}
[[18326  4344 50727]
 [18196 11134 78769]
 [ 7385  4142 59946]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1202171
{'0': {'precision': 0.42268682422734666, 'recall': 0.22787356692415822, 'f1-score': 0.2961113392041694, 'support': 77543}, '1': {'precision': 0.5068685305214279, 'recall': 0.10447865361223554, 'f1-score': 0.1732467017160996, 'support': 100298}, '2': {'precision': 0.3257791706694804, 'recall': 0.8260302417207965, 'f1-score': 0.4672707901166709, 'support': 75128}, 'accuracy': 0.3565931003403579, 'macro avg': {'precision': 0.41844484180608493, 'recall': 0.38612748741906344, 'f1-score': 0.31220961034564665, 'support': 252969}, 'weighted avg': {'precision': 0.4272833502103264, 'recall': 0.3565931003403579, 'f1-score': 0.2982293450364096, 'support': 252969}}
[[17670  5276 54597]
 [15983 10479 73836]
 [ 8151  4919 62058]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1420314
{'0': {'precision': 0.3684931506849315, 'recall': 0.20071235499493187, 'f1-score': 0.2598749567087731, 'support': 71032}, '1': {'precision': 0.5035215946843854, 'recall': 0.09813689263390545, 'f1-score': 0.16425944524323893, 'support': 115828}, '2': {'precision': 0.28012978341609984, 'recall': 0.8123250994569574, 'f1-score': 0.41659652538855685, 'support': 66109}, 'accuracy': 0.31357992481292174, 'macro avg': {'precision': 0.38404817626180554, 'recall': 0.3703914490285982, 'f1-score': 0.2802436424468563, 'support': 252969}, 'weighted avg': {'precision': 0.4072269906605552, 'recall': 0.31357992481292174, 'f1-score': 0.2570514989800472, 'support': 252969}}
[[14257  6091 50684]
 [17143 11367 87318]
 [ 7290  5117 53702]]
Evaluating performance on  train set...
339/339 - 7s - 7s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0705473
{'0': {'precision': 0.4679934229177298, 'recall': 0.29410297523605916, 'f1-score': 0.361209575073301, 'support': 28065}, '1': {'precision': 0.537703415081366, 'recall': 0.23367309671635844, 'f1-score': 0.32577300499907424, 'support': 30119}, '2': {'precision': 0.3855704457503225, 'recall': 0.7589040129769378, 'f1-score': 0.5113455461306342, 'support': 28358}, 'accuracy': 0.4253772734625962, 'macro avg': {'precision': 0.46375576124980605, 'recall': 0.4288933616431185, 'f1-score': 0.39944270873433646, 'support': 86542}, 'weighted avg': {'precision': 0.46524613798628867, 'recall': 0.4253772734625962, 'f1-score': 0.3980730842732065, 'support': 86542}}
[[ 8254  3010 16801]
 [ 5587  7038 17494]
 [ 3796  3041 21521]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0741197
{'0': {'precision': 0.4600719219133512, 'recall': 0.2807090864765089, 'f1-score': 0.3486762415642845, 'support': 28713}, '1': {'precision': 0.49483735734803197, 'recall': 0.22141939069718972, 'f1-score': 0.30594220984928483, 'support': 28787}, '2': {'precision': 0.3849524420220156, 'recall': 0.7441636250946905, 'f1-score': 0.507419233658903, 'support': 29042}, 'accuracy': 0.4165145247394329, 'macro avg': {'precision': 0.4466205737611329, 'recall': 0.4154307007561297, 'f1-score': 0.38734589502415745, 'support': 86542}, 'weighted avg': {'precision': 0.44642736383581644, 'recall': 0.4165145247394329, 'f1-score': 0.3877327621604368, 'support': 86542}}
[[ 8060  3229 17424]
 [ 5307  6374 17106]
 [ 4152  3278 21612]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0762819
{'0': {'precision': 0.4526248024814186, 'recall': 0.26568189625558225, 'f1-score': 0.3348269368140788, 'support': 29110}, '1': {'precision': 0.45744029393753827, 'recall': 0.21343619414979106, 'f1-score': 0.29106494898083435, 'support': 27999}, '2': {'precision': 0.3829334468266213, 'recall': 0.7336662929364999, 'f1-score': 0.5032158836689039, 'support': 29433}, 'accuracy': 0.40794065309329575, 'macro avg': {'precision': 0.43099951441519274, 'recall': 0.4042614611139577, 'f1-score': 0.376369256487939, 'support': 86542}, 'weighted avg': {'precision': 0.4304806790996184, 'recall': 0.40794065309329575, 'f1-score': 0.3779377959973084, 'support': 86542}}
[[ 7734  3551 17825]
 [ 5051  5976 16972]
 [ 4302  3537 21594]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0890266
{'0': {'precision': 0.42029256146903204, 'recall': 0.23459106385935655, 'f1-score': 0.30111267197359914, 'support': 28782}, '1': {'precision': 0.4314143045968571, 'recall': 0.20554175558898646, 'f1-score': 0.27842942110376534, 'support': 28583}, '2': {'precision': 0.3724476336200074, 'recall': 0.7258114268087877, 'f1-score': 0.4922823004323771, 'support': 29177}, 'accuracy': 0.3906080284717247, 'macro avg': {'precision': 0.4080514998952988, 'recall': 0.3886480820857103, 'f1-score': 0.3572747978365805, 'support': 86542}, 'weighted avg': {'precision': 0.40783527279961873, 'recall': 0.3906080284717247, 'f1-score': 0.358072308796521, 'support': 86542}}
[[ 6752  3964 18066]
 [ 5092  5875 17616]
 [ 4221  3779 21177]]
Evaluating performance on  val set...
124/124 - 3s - 3s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0872526
{'0': {'precision': 0.4581049334377447, 'recall': 0.27267642397688074, 'f1-score': 0.34186535764375875, 'support': 10727}, '1': {'precision': 0.546236559139785, 'recall': 0.10273003033367037, 'f1-score': 0.17293617021276597, 'support': 9890}, '2': {'precision': 0.38493580109073733, 'recall': 0.8212551534585433, 'f1-score': 0.5241798725220748, 'support': 10915}, 'accuracy': 0.4092667766078904, 'macro avg': {'precision': 0.4630924312227556, 'recall': 0.3988872025896981, 'f1-score': 0.3463271334595332, 'support': 31532}, 'weighted avg': {'precision': 0.46041942977878214, 'recall': 0.4092667766078904, 'f1-score': 0.35199009651868896, 'support': 31532}}
[[2925  404 7398]
 [1949 1016 6925]
 [1511  440 8964]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.084386
{'0': {'precision': 0.45057283142389526, 'recall': 0.25134666301469916, 'f1-score': 0.32268651468088844, 'support': 10953}, '1': {'precision': 0.48060344827586204, 'recall': 0.09566709566709566, 'f1-score': 0.15957066189624328, 'support': 9324}, '2': {'precision': 0.3899685988288212, 'recall': 0.8165259884495779, 'f1-score': 0.5278423939576693, 'support': 11255}, 'accuracy': 0.4070468095902575, 'macro avg': {'precision': 0.44038162617619286, 'recall': 0.38784658237712427, 'f1-score': 0.3366998568449337, 'support': 31532}, 'weighted avg': {'precision': 0.43782085989244085, 'recall': 0.4070468095902575, 'f1-score': 0.347681351985726, 'support': 31532}}
[[2753  457 7743]
 [1799  892 6633]
 [1558  507 9190]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0961328
{'0': {'precision': 0.4310947883875481, 'recall': 0.2284522706209453, 'f1-score': 0.29864308214199176, 'support': 10790}, '1': {'precision': 0.4316062176165803, 'recall': 0.08774886758664278, 'f1-score': 0.1458460999737372, 'support': 9493}, '2': {'precision': 0.3833110031820466, 'recall': 0.8138501200106676, 'f1-score': 0.521162439871346, 'support': 11249}, 'accuracy': 0.3949321324368895, 'macro avg': {'precision': 0.41533733639539167, 'recall': 0.3766837527394185, 'f1-score': 0.3218838739956917, 'support': 31532}, 'weighted avg': {'precision': 0.4142019556428607, 'recall': 0.3949321324368895, 'f1-score': 0.33202563013686254, 'support': 31532}}
[[2465  521 7804]
 [1735  833 6925]
 [1518  576 9155]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1066461
{'0': {'precision': 0.3904725463937249, 'recall': 0.19589212016508303, 'f1-score': 0.2608973539562828, 'support': 10419}, '1': {'precision': 0.46518375241779497, 'recall': 0.0931899641577061, 'f1-score': 0.15527398918569932, 'support': 10323}, '2': {'precision': 0.3616784255477163, 'recall': 0.81241890639481, 'f1-score': 0.5005281639877808, 'support': 10790}, 'accuracy': 0.3732398832931625, 'macro avg': {'precision': 0.4057782414530788, 'recall': 0.3671669969058664, 'f1-score': 0.3055665023765876, 'support': 31532}, 'weighted avg': {'precision': 0.405078509093777, 'recall': 0.3732398832931625, 'f1-score': 0.30831795669994416, 'support': 31532}}
[[2041  514 7864]
 [1754  962 7607]
 [1432  592 8766]]
training model: results/XRAY/W4/deepOF_L2/seq2seq
Epoch 1/50
339/339 - 18s - loss: 13.0658 - accuracy10: 0.3971 - accuracy20: 0.3901 - accuracy30: 0.3806 - accuracy50: 0.3739 - val_loss: 12.9612 - val_accuracy10: 0.4217 - val_accuracy20: 0.4092 - val_accuracy30: 0.3957 - val_accuracy50: 0.3855 - 18s/epoch - 52ms/step
Epoch 2/50
339/339 - 12s - loss: 12.8293 - accuracy10: 0.4387 - accuracy20: 0.4230 - accuracy30: 0.4105 - accuracy50: 0.3979 - val_loss: 12.8673 - val_accuracy10: 0.4369 - val_accuracy20: 0.4203 - val_accuracy30: 0.4027 - val_accuracy50: 0.3900 - 12s/epoch - 34ms/step
Epoch 3/50
339/339 - 12s - loss: 12.7050 - accuracy10: 0.4567 - accuracy20: 0.4384 - accuracy30: 0.4228 - accuracy50: 0.4062 - val_loss: 12.7883 - val_accuracy10: 0.4483 - val_accuracy20: 0.4283 - val_accuracy30: 0.4110 - val_accuracy50: 0.3966 - 12s/epoch - 34ms/step
Epoch 4/50
339/339 - 12s - loss: 12.6219 - accuracy10: 0.4701 - accuracy20: 0.4492 - accuracy30: 0.4310 - accuracy50: 0.4110 - val_loss: 12.7562 - val_accuracy10: 0.4520 - val_accuracy20: 0.4344 - val_accuracy30: 0.4153 - val_accuracy50: 0.4028 - 12s/epoch - 35ms/step
Epoch 5/50
339/339 - 12s - loss: 12.5360 - accuracy10: 0.4825 - accuracy20: 0.4601 - accuracy30: 0.4382 - accuracy50: 0.4166 - val_loss: 12.6963 - val_accuracy10: 0.4632 - val_accuracy20: 0.4428 - val_accuracy30: 0.4254 - val_accuracy50: 0.4018 - 12s/epoch - 34ms/step
Epoch 6/50
339/339 - 12s - loss: 12.4306 - accuracy10: 0.4959 - accuracy20: 0.4698 - accuracy30: 0.4483 - accuracy50: 0.4240 - val_loss: 12.6352 - val_accuracy10: 0.4700 - val_accuracy20: 0.4551 - val_accuracy30: 0.4375 - val_accuracy50: 0.4102 - 12s/epoch - 35ms/step
Epoch 7/50
339/339 - 12s - loss: 12.3630 - accuracy10: 0.5031 - accuracy20: 0.4782 - accuracy30: 0.4564 - accuracy50: 0.4270 - val_loss: 12.6248 - val_accuracy10: 0.4720 - val_accuracy20: 0.4605 - val_accuracy30: 0.4415 - val_accuracy50: 0.4105 - 12s/epoch - 35ms/step
Epoch 8/50
339/339 - 12s - loss: 12.2955 - accuracy10: 0.5092 - accuracy20: 0.4828 - accuracy30: 0.4612 - accuracy50: 0.4327 - val_loss: 12.6075 - val_accuracy10: 0.4767 - val_accuracy20: 0.4635 - val_accuracy30: 0.4430 - val_accuracy50: 0.4132 - 12s/epoch - 34ms/step
Epoch 9/50
339/339 - 12s - loss: 12.2547 - accuracy10: 0.5113 - accuracy20: 0.4869 - accuracy30: 0.4640 - accuracy50: 0.4354 - val_loss: 12.6282 - val_accuracy10: 0.4723 - val_accuracy20: 0.4599 - val_accuracy30: 0.4393 - val_accuracy50: 0.4122 - 12s/epoch - 35ms/step
Epoch 10/50
339/339 - 12s - loss: 12.2134 - accuracy10: 0.5140 - accuracy20: 0.4898 - accuracy30: 0.4680 - accuracy50: 0.4379 - val_loss: 12.6102 - val_accuracy10: 0.4722 - val_accuracy20: 0.4602 - val_accuracy30: 0.4408 - val_accuracy50: 0.4143 - 12s/epoch - 34ms/step
Epoch 11/50
339/339 - 12s - loss: 12.1730 - accuracy10: 0.5162 - accuracy20: 0.4925 - accuracy30: 0.4705 - accuracy50: 0.4407 - val_loss: 12.6031 - val_accuracy10: 0.4763 - val_accuracy20: 0.4628 - val_accuracy30: 0.4403 - val_accuracy50: 0.4128 - 12s/epoch - 34ms/step
Epoch 12/50
339/339 - 12s - loss: 12.1288 - accuracy10: 0.5203 - accuracy20: 0.4969 - accuracy30: 0.4757 - accuracy50: 0.4461 - val_loss: 12.5920 - val_accuracy10: 0.4775 - val_accuracy20: 0.4643 - val_accuracy30: 0.4434 - val_accuracy50: 0.4122 - 12s/epoch - 36ms/step
Epoch 13/50
339/339 - 12s - loss: 12.0936 - accuracy10: 0.5236 - accuracy20: 0.5002 - accuracy30: 0.4797 - accuracy50: 0.4490 - val_loss: 12.6017 - val_accuracy10: 0.4746 - val_accuracy20: 0.4636 - val_accuracy30: 0.4434 - val_accuracy50: 0.4106 - 12s/epoch - 35ms/step
Epoch 14/50
339/339 - 12s - loss: 12.0535 - accuracy10: 0.5250 - accuracy20: 0.5029 - accuracy30: 0.4824 - accuracy50: 0.4509 - val_loss: 12.6302 - val_accuracy10: 0.4731 - val_accuracy20: 0.4602 - val_accuracy30: 0.4375 - val_accuracy50: 0.4072 - 12s/epoch - 34ms/step
Epoch 15/50
339/339 - 12s - loss: 12.0225 - accuracy10: 0.5289 - accuracy20: 0.5073 - accuracy30: 0.4842 - accuracy50: 0.4541 - val_loss: 12.6297 - val_accuracy10: 0.4735 - val_accuracy20: 0.4602 - val_accuracy30: 0.4404 - val_accuracy50: 0.4097 - 12s/epoch - 35ms/step
Epoch 16/50
339/339 - 12s - loss: 11.9819 - accuracy10: 0.5293 - accuracy20: 0.5081 - accuracy30: 0.4887 - accuracy50: 0.4598 - val_loss: 12.6665 - val_accuracy10: 0.4693 - val_accuracy20: 0.4574 - val_accuracy30: 0.4386 - val_accuracy50: 0.4060 - 12s/epoch - 34ms/step
Epoch 17/50
339/339 - 11s - loss: 11.9512 - accuracy10: 0.5307 - accuracy20: 0.5117 - accuracy30: 0.4920 - accuracy50: 0.4627 - val_loss: 12.7382 - val_accuracy10: 0.4666 - val_accuracy20: 0.4535 - val_accuracy30: 0.4310 - val_accuracy50: 0.4027 - 11s/epoch - 34ms/step
Epoch 18/50
339/339 - 12s - loss: 11.9082 - accuracy10: 0.5342 - accuracy20: 0.5154 - accuracy30: 0.4976 - accuracy50: 0.4658 - val_loss: 12.7482 - val_accuracy10: 0.4648 - val_accuracy20: 0.4524 - val_accuracy30: 0.4308 - val_accuracy50: 0.4014 - 12s/epoch - 35ms/step
Epoch 19/50
339/339 - 12s - loss: 11.8813 - accuracy10: 0.5350 - accuracy20: 0.5171 - accuracy30: 0.4979 - accuracy50: 0.4686 - val_loss: 12.8825 - val_accuracy10: 0.4540 - val_accuracy20: 0.4423 - val_accuracy30: 0.4259 - val_accuracy50: 0.3976 - 12s/epoch - 34ms/step
Epoch 20/50
339/339 - 12s - loss: 11.8403 - accuracy10: 0.5367 - accuracy20: 0.5220 - accuracy30: 0.5035 - accuracy50: 0.4735 - val_loss: 12.8894 - val_accuracy10: 0.4531 - val_accuracy20: 0.4418 - val_accuracy30: 0.4258 - val_accuracy50: 0.3979 - 12s/epoch - 34ms/step
Epoch 21/50
339/339 - 12s - loss: 11.7981 - accuracy10: 0.5405 - accuracy20: 0.5241 - accuracy30: 0.5059 - accuracy50: 0.4770 - val_loss: 12.9153 - val_accuracy10: 0.4529 - val_accuracy20: 0.4411 - val_accuracy30: 0.4192 - val_accuracy50: 0.3912 - 12s/epoch - 35ms/step
Epoch 22/50
339/339 - 12s - loss: 11.7554 - accuracy10: 0.5412 - accuracy20: 0.5268 - accuracy30: 0.5083 - accuracy50: 0.4803 - val_loss: 13.0228 - val_accuracy10: 0.4426 - val_accuracy20: 0.4331 - val_accuracy30: 0.4160 - val_accuracy50: 0.3889 - 12s/epoch - 34ms/step
testing model: results/XRAY/W4/deepOF_L2/seq2seq
Evaluating performance on  test set...
989/989 - 14s - 14s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0252573
{'0': {'precision': 0.4175284534057427, 'recall': 0.5184659090909091, 'f1-score': 0.46255464314744527, 'support': 69696}, '1': {'precision': 0.6557030672254112, 'recall': 0.323643158214922, 'f1-score': 0.4333785254190936, 'support': 115065}, '2': {'precision': 0.3884662397606407, 'recall': 0.6243915312884875, 'f1-score': 0.47895180790642744, 'support': 68204}, 'accuracy': 0.45840728954598464, 'macro avg': {'precision': 0.48723258679726483, 'recall': 0.4888335328647728, 'f1-score': 0.4582949921576554, 'support': 252965}, 'weighted avg': {'precision': 0.5180301145830187, 'recall': 0.45840728954598464, 'f1-score': 0.45370441579903276, 'support': 252965}}
[[36135 10142 23419]
 [34204 37240 43621]
 [16206  9412 42586]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0455
{'0': {'precision': 0.41337502249415153, 'recall': 0.5007629843588206, 'f1-score': 0.452892032432166, 'support': 73396}, '1': {'precision': 0.5966282561064676, 'recall': 0.27205868748728007, 'f1-score': 0.37370862189465665, 'support': 108098}, '2': {'precision': 0.3847038628105367, 'recall': 0.6177190748695275, 'f1-score': 0.4741290433437863, 'support': 71471}, 'accuracy': 0.4360761370150021, 'macro avg': {'precision': 0.46490238047038535, 'recall': 0.4635135822385427, 'f1-score': 0.43357656589020305, 'support': 252965}, 'weighted avg': {'precision': 0.48358296269645823, 'recall': 0.4360761370150021, 'f1-score': 0.4250552253425715, 'support': 252965}}
[[36754 10636 26006]
 [34083 29409 44606]
 [18075  9247 44149]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0572664
{'0': {'precision': 0.4151243715559068, 'recall': 0.4876969900183127, 'f1-score': 0.4484938330170778, 'support': 77542}, '1': {'precision': 0.5281497797356828, 'recall': 0.23906996221222968, 'f1-score': 0.32914885001063854, 'support': 100297}, '2': {'precision': 0.3858861308353439, 'recall': 0.598234965258366, 'f1-score': 0.4691507518541909, 'support': 75126}, 'accuracy': 0.42194770027474154, 'macro avg': {'precision': 0.4430534273756445, 'recall': 0.4416673058296361, 'f1-score': 0.4155978116273024, 'support': 252965}, 'weighted avg': {'precision': 0.4512541021187672, 'recall': 0.42194770027474154, 'f1-score': 0.407309985148638, 'support': 252965}}
[[37817 11402 28323]
 [33118 23978 43201]
 [20163 10020 44943]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0805373
{'0': {'precision': 0.35686429166118927, 'recall': 0.4586166603314046, 'f1-score': 0.40139235437267046, 'support': 71031}, '1': {'precision': 0.5022165795991425, 'recall': 0.20832793735484817, 'f1-score': 0.29449455069138486, 'support': 115827}, '2': {'precision': 0.3241107415034233, 'recall': 0.5571270818521488, 'f1-score': 0.40981189600591966, 'support': 66107}, 'accuracy': 0.3697586622655308, 'macro avg': {'precision': 0.39439720425458497, 'recall': 0.40802389317946713, 'f1-score': 0.36856626702332496, 'support': 252965}, 'weighted avg': {'precision': 0.41485840355299197, 'recall': 0.3697586622655308, 'f1-score': 0.35464651495518956, 'support': 252965}}
[[32576 12839 25616]
 [40509 24130 51188]
 [18199 11078 36830]]
Evaluating performance on  train set...
339/339 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9923352
{'0': {'precision': 0.47590142042005584, 'recall': 0.5598000714030703, 'f1-score': 0.5144525739033433, 'support': 28010}, '1': {'precision': 0.6288936979474063, 'recall': 0.31767589770769844, 'f1-score': 0.42212293945462953, 'support': 30188}, '2': {'precision': 0.46882090603239185, 'recall': 0.6342530520076212, 'f1-score': 0.5391317387718377, 'support': 28342}, 'accuracy': 0.4997226715969494, 'macro avg': {'precision': 0.5245386747999513, 'recall': 0.50390967370613, 'f1-score': 0.49190241737660356, 'support': 86540}, 'weighted avg': {'precision': 0.5269512810073044, 'recall': 0.4997226715969494, 'f1-score': 0.49032742814375346, 'support': 86540}}
[[15680  2665  9665]
 [ 9896  9590 10702]
 [ 7372  2994 17976]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0145904
{'0': {'precision': 0.466728419039651, 'recall': 0.5452387601228708, 'f1-score': 0.5029380986879176, 'support': 28648}, '1': {'precision': 0.5755797101449275, 'recall': 0.2753015388881187, 'f1-score': 0.3724561568039014, 'support': 28852}, '2': {'precision': 0.45985791765334966, 'recall': 0.621900826446281, 'f1-score': 0.5287426990470335, 'support': 29040}, 'accuracy': 0.4809683383406517, 'macro avg': {'precision': 0.5007220156126427, 'recall': 0.48081370848575683, 'f1-score': 0.4680456515129509, 'support': 86540}, 'weighted avg': {'precision': 0.5007133750219858, 'recall': 0.4809683383406517, 'f1-score': 0.46809525846595196, 'support': 86540}}
[[15620  2784 10244]
 [ 9940  7943 10969]
 [ 7907  3073 18060]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0329703
{'0': {'precision': 0.45605939598308043, 'recall': 0.5308314684110862, 'f1-score': 0.49061286832559026, 'support': 29045}, '1': {'precision': 0.5130103507763082, 'recall': 0.2537419561275643, 'f1-score': 0.3395418539927211, 'support': 28127}, '2': {'precision': 0.45240977821282297, 'recall': 0.59803187142468, 'f1-score': 0.5151270732816143, 'support': 29368}, 'accuracy': 0.4635775363993529, 'macro avg': {'precision': 0.47382650832407053, 'recall': 0.46086843198777677, 'f1-score': 0.4484272651999752, 'support': 86540}, 'weighted avg': {'precision': 0.4733309181785068, 'recall': 0.4635775363993529, 'f1-score': 0.44983125001045166, 'support': 86540}}
[[15418  3304 10323]
 [10055  7137 10935]
 [ 8334  3471 17563]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0566795
{'0': {'precision': 0.4290504818585541, 'recall': 0.494584711823089, 'f1-score': 0.4594926879772227, 'support': 28715}, '1': {'precision': 0.43936465756733906, 'recall': 0.25387353433835846, 'f1-score': 0.32180298137744945, 'support': 28656}, '2': {'precision': 0.4334481169165695, 'recall': 0.5480475847646474, 'f1-score': 0.4840575321725965, 'support': 29169}, 'accuracy': 0.4328980818118789, 'macro avg': {'precision': 0.4339544187808209, 'recall': 0.4321686103086983, 'f1-score': 0.4217844005090896, 'support': 86540}, 'weighted avg': {'precision': 0.433948074140946, 'recall': 0.4328980818118789, 'f1-score': 0.4221792572863486, 'support': 86540}}
[[14202  4612  9901]
 [10387  7275 10994]
 [ 8512  4671 15986]]
Evaluating performance on  val set...
124/124 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0237993
{'0': {'precision': 0.4626414509378391, 'recall': 0.5612599905970851, 'f1-score': 0.5072014275396185, 'support': 10635}, '1': {'precision': 0.5516488845780795, 'recall': 0.2306834313526668, 'f1-score': 0.3253253253253254, 'support': 9862}, '2': {'precision': 0.4674617399696677, 'recall': 0.6144993203443588, 'f1-score': 0.5309893896088641, 'support': 11035}, 'accuracy': 0.4765000634276291, 'macro avg': {'precision': 0.4939173584951954, 'recall': 0.4688142474313703, 'f1-score': 0.4545053808246027, 'support': 31532}, 'weighted avg': {'precision': 0.49216647948110553, 'recall': 0.4765000634276291, 'f1-score': 0.4586424411574279, 'support': 31532}}
[[5969  868 3798]
 [3660 2275 3927]
 [3273  981 6781]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0435549
{'0': {'precision': 0.4550450312929324, 'recall': 0.5465713237990466, 'f1-score': 0.49662640566430655, 'support': 10908}, '1': {'precision': 0.498314606741573, 'recall': 0.19145262249082667, 'f1-score': 0.27662560424138466, 'support': 9266}, '2': {'precision': 0.4613987895090787, 'recall': 0.604067617538299, 'f1-score': 0.5231813329266433, 'support': 11358}, 'accuracy': 0.4629265508055309, 'macro avg': {'precision': 0.471586142514528, 'recall': 0.4473638546093907, 'f1-score': 0.43214444761077814, 'support': 31532}, 'weighted avg': {'precision': 0.4700488963165938, 'recall': 0.4629265508055309, 'f1-score': 0.44154215594531715, 'support': 31532}}
[[5962  835 4111]
 [3594 1774 3898]
 [3546  951 6861]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0573512
{'0': {'precision': 0.43668917381078826, 'recall': 0.5335558027437894, 'f1-score': 0.48028703742333845, 'support': 10788}, '1': {'precision': 0.43777412280701755, 'recall': 0.16831787521079258, 'f1-score': 0.24314859926918392, 'support': 9488}, '2': {'precision': 0.4458953954975175, 'recall': 0.5824449182658138, 'f1-score': 0.505104202781309, 'support': 11256}, 'accuracy': 0.44110744640365346, 'macro avg': {'precision': 0.44011956403844116, 'recall': 0.42810619874013195, 'f1-score': 0.40951327982461044, 'support': 31532}, 'weighted avg': {'precision': 0.44030198706025064, 'recall': 0.44110744640365346, 'f1-score': 0.4177909227481735, 'support': 31532}}
[[5756  961 4071]
 [3815 1597 4076]
 [3610 1090 6556]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0746368
{'0': {'precision': 0.39995323096110375, 'recall': 0.49355521354367066, 'f1-score': 0.4418514531754575, 'support': 10396}, '1': {'precision': 0.41867160189183633, 'recall': 0.19673398395980288, 'f1-score': 0.26768340783591904, 'support': 10349}, '2': {'precision': 0.4236271676300578, 'recall': 0.5435246129600445, 'f1-score': 0.47614406951719657, 'support': 10787}, 'accuracy': 0.41323100342509195, 'macro avg': {'precision': 0.4140840001609993, 'recall': 0.41127127015450604, 'f1-score': 0.39522631017619103, 'support': 31532}, 'weighted avg': {'precision': 0.41419549835962455, 'recall': 0.41323100342509195, 'f1-score': 0.3964198075855633, 'support': 31532}}
[[5131 1415 3850]
 [4186 2036 4127]
 [3512 1412 5863]]
training model: results/XRAY/W4/deepVOL_L2/seq2seq
Epoch 1/50
339/339 - 17s - loss: 13.1399 - accuracy10: 0.3936 - accuracy20: 0.3852 - accuracy30: 0.3766 - accuracy50: 0.3691 - val_loss: 13.1021 - val_accuracy10: 0.3881 - val_accuracy20: 0.3819 - val_accuracy30: 0.3656 - val_accuracy50: 0.3534 - 17s/epoch - 51ms/step
Epoch 2/50
339/339 - 12s - loss: 12.9370 - accuracy10: 0.4245 - accuracy20: 0.4122 - accuracy30: 0.3979 - accuracy50: 0.3861 - val_loss: 12.9927 - val_accuracy10: 0.4240 - val_accuracy20: 0.4135 - val_accuracy30: 0.3928 - val_accuracy50: 0.3632 - 12s/epoch - 35ms/step
Epoch 3/50
339/339 - 11s - loss: 12.7853 - accuracy10: 0.4487 - accuracy20: 0.4323 - accuracy30: 0.4158 - accuracy50: 0.3947 - val_loss: 12.8991 - val_accuracy10: 0.4388 - val_accuracy20: 0.4243 - val_accuracy30: 0.4044 - val_accuracy50: 0.3743 - 11s/epoch - 34ms/step
Epoch 4/50
339/339 - 12s - loss: 12.7023 - accuracy10: 0.4571 - accuracy20: 0.4395 - accuracy30: 0.4243 - accuracy50: 0.4006 - val_loss: 12.8544 - val_accuracy10: 0.4472 - val_accuracy20: 0.4331 - val_accuracy30: 0.4111 - val_accuracy50: 0.3807 - 12s/epoch - 35ms/step
Epoch 5/50
339/339 - 12s - loss: 12.6214 - accuracy10: 0.4681 - accuracy20: 0.4508 - accuracy30: 0.4329 - accuracy50: 0.4056 - val_loss: 12.8549 - val_accuracy10: 0.4518 - val_accuracy20: 0.4346 - val_accuracy30: 0.4140 - val_accuracy50: 0.3791 - 12s/epoch - 34ms/step
Epoch 6/50
339/339 - 11s - loss: 12.5713 - accuracy10: 0.4746 - accuracy20: 0.4550 - accuracy30: 0.4379 - accuracy50: 0.4098 - val_loss: 12.8461 - val_accuracy10: 0.4581 - val_accuracy20: 0.4380 - val_accuracy30: 0.4160 - val_accuracy50: 0.3873 - 11s/epoch - 34ms/step
Epoch 7/50
339/339 - 11s - loss: 12.5419 - accuracy10: 0.4757 - accuracy20: 0.4569 - accuracy30: 0.4383 - accuracy50: 0.4114 - val_loss: 12.8488 - val_accuracy10: 0.4592 - val_accuracy20: 0.4399 - val_accuracy30: 0.4159 - val_accuracy50: 0.3882 - 11s/epoch - 33ms/step
Epoch 8/50
339/339 - 11s - loss: 12.4981 - accuracy10: 0.4819 - accuracy20: 0.4619 - accuracy30: 0.4434 - accuracy50: 0.4144 - val_loss: 12.8937 - val_accuracy10: 0.4569 - val_accuracy20: 0.4353 - val_accuracy30: 0.4132 - val_accuracy50: 0.3825 - 11s/epoch - 34ms/step
Epoch 9/50
339/339 - 11s - loss: 12.4625 - accuracy10: 0.4861 - accuracy20: 0.4657 - accuracy30: 0.4471 - accuracy50: 0.4192 - val_loss: 12.8717 - val_accuracy10: 0.4618 - val_accuracy20: 0.4368 - val_accuracy30: 0.4132 - val_accuracy50: 0.3839 - 11s/epoch - 33ms/step
Epoch 10/50
339/339 - 12s - loss: 12.4168 - accuracy10: 0.4906 - accuracy20: 0.4703 - accuracy30: 0.4506 - accuracy50: 0.4224 - val_loss: 12.9179 - val_accuracy10: 0.4587 - val_accuracy20: 0.4361 - val_accuracy30: 0.4157 - val_accuracy50: 0.3850 - 12s/epoch - 34ms/step
Epoch 11/50
339/339 - 11s - loss: 12.3951 - accuracy10: 0.4918 - accuracy20: 0.4709 - accuracy30: 0.4509 - accuracy50: 0.4231 - val_loss: 12.8776 - val_accuracy10: 0.4604 - val_accuracy20: 0.4389 - val_accuracy30: 0.4170 - val_accuracy50: 0.3901 - 11s/epoch - 33ms/step
Epoch 12/50
339/339 - 11s - loss: 12.3722 - accuracy10: 0.4948 - accuracy20: 0.4726 - accuracy30: 0.4520 - accuracy50: 0.4221 - val_loss: 12.8596 - val_accuracy10: 0.4617 - val_accuracy20: 0.4391 - val_accuracy30: 0.4168 - val_accuracy50: 0.3902 - 11s/epoch - 33ms/step
Epoch 13/50
339/339 - 11s - loss: 12.3516 - accuracy10: 0.4968 - accuracy20: 0.4746 - accuracy30: 0.4545 - accuracy50: 0.4251 - val_loss: 12.8799 - val_accuracy10: 0.4644 - val_accuracy20: 0.4410 - val_accuracy30: 0.4142 - val_accuracy50: 0.3881 - 11s/epoch - 34ms/step
Epoch 14/50
339/339 - 11s - loss: 12.3191 - accuracy10: 0.4997 - accuracy20: 0.4783 - accuracy30: 0.4579 - accuracy50: 0.4292 - val_loss: 12.8659 - val_accuracy10: 0.4641 - val_accuracy20: 0.4426 - val_accuracy30: 0.4178 - val_accuracy50: 0.3884 - 11s/epoch - 34ms/step
Epoch 15/50
339/339 - 11s - loss: 12.2962 - accuracy10: 0.5021 - accuracy20: 0.4821 - accuracy30: 0.4615 - accuracy50: 0.4325 - val_loss: 12.8522 - val_accuracy10: 0.4667 - val_accuracy20: 0.4436 - val_accuracy30: 0.4182 - val_accuracy50: 0.3898 - 11s/epoch - 33ms/step
Epoch 16/50
339/339 - 11s - loss: 12.2658 - accuracy10: 0.5041 - accuracy20: 0.4835 - accuracy30: 0.4635 - accuracy50: 0.4338 - val_loss: 12.9059 - val_accuracy10: 0.4633 - val_accuracy20: 0.4420 - val_accuracy30: 0.4152 - val_accuracy50: 0.3899 - 11s/epoch - 33ms/step
testing model: results/XRAY/W4/deepVOL_L2/seq2seq
Evaluating performance on  test set...
989/989 - 14s - 14s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0414289
{'0': {'precision': 0.4238560533841754, 'recall': 0.3572463664146233, 'f1-score': 0.38771108913820357, 'support': 69697}, '1': {'precision': 0.603181043577051, 'recall': 0.38758625484504544, 'f1-score': 0.4719265200736492, 'support': 115066}, '2': {'precision': 0.35347128118583054, 'recall': 0.6233762425593057, 'f1-score': 0.45113611646055823, 'support': 68206}, 'accuracy': 0.44280129185789563, 'macro avg': {'precision': 0.4601694593823524, 'recall': 0.4560696212729915, 'f1-score': 0.436924575224137, 'support': 252969}, 'weighted avg': {'precision': 0.48644690660719136, 'recall': 0.44280129185789563, 'f1-score': 0.4431182741670668, 'support': 252969}}
[[24899 14585 30213]
 [22912 44598 47556]
 [10933 14755 42518]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0545838
{'0': {'precision': 0.4290915896755313, 'recall': 0.34359714974726485, 'f1-score': 0.38161458727396536, 'support': 73397}, '1': {'precision': 0.5480953995704758, 'recall': 0.358856233637684, 'f1-score': 0.4337330538085255, 'support': 108099}, '2': {'precision': 0.3601037109058499, 'recall': 0.6218292222237768, 'f1-score': 0.4560861600981051, 'support': 71473}, 'accuracy': 0.42872842126900923, 'macro avg': {'precision': 0.4457635667172857, 'recall': 0.4414275352029085, 'f1-score': 0.4238112670601987, 'support': 252969}, 'weighted avg': {'precision': 0.46045283230418604, 'recall': 0.42872842126900923, 'f1-score': 0.4249268541461084, 'support': 252969}}
[[25219 16716 31462]
 [21793 38792 47514]
 [11761 15268 44444]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0672826
{'0': {'precision': 0.434204333501839, 'recall': 0.3212282217608295, 'f1-score': 0.3692684011563265, 'support': 77543}, '1': {'precision': 0.48383519576900114, 'recall': 0.3393088595983968, 'f1-score': 0.3988841745001055, 'support': 100298}, '2': {'precision': 0.3690525609911866, 'recall': 0.6153364923863274, 'f1-score': 0.4613856840592439, 'support': 75128}, 'accuracy': 0.41574264040257897, 'macro avg': {'precision': 0.4290306967540089, 'recall': 0.42529119124851783, 'f1-score': 0.409846086571892, 'support': 252969}, 'weighted avg': {'precision': 0.43453304515619795, 'recall': 0.41574264040257897, 'f1-score': 0.40836801440840376, 'support': 252969}}
[[24909 19421 33213]
 [20444 34032 45822]
 [12014 16885 46229]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0845239
{'0': {'precision': 0.36203773170597814, 'recall': 0.27853643428314, 'f1-score': 0.31484472593311635, 'support': 71032}, '1': {'precision': 0.47984510973674127, 'recall': 0.30276789722692266, 'f1-score': 0.3712733971372914, 'support': 115828}, '2': {'precision': 0.31302500878341694, 'recall': 0.5929903643981909, 'f1-score': 0.4097520186051373, 'support': 66109}, 'accuracy': 0.37180840340120724, 'macro avg': {'precision': 0.3849692834087121, 'recall': 0.39143156530275114, 'f1-score': 0.3652900472251817, 'support': 252969}, 'weighted avg': {'precision': 0.40317008738141513, 'recall': 0.37180840340120724, 'f1-score': 0.36548431552508936, 'support': 252969}}
[[19785 21112 30135]
 [24860 35069 55899]
 [10004 16903 39202]]
Evaluating performance on  train set...
339/339 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0260568
{'0': {'precision': 0.4676332448437819, 'recall': 0.40798147158382325, 'f1-score': 0.43577545195052325, 'support': 28065}, '1': {'precision': 0.5744949494949495, 'recall': 0.39277532454596764, 'f1-score': 0.46656543945100665, 'support': 30119}, '2': {'precision': 0.42397202459905947, 'recall': 0.6199308837012483, 'f1-score': 0.5035589991836501, 'support': 28358}, 'accuracy': 0.4721406946915948, 'macro avg': {'precision': 0.4887000729792636, 'recall': 0.4735625599436797, 'f1-score': 0.46863329686172667, 'support': 86542}, 'weighted avg': {'precision': 0.49051719481822986, 'recall': 0.4721406946915948, 'f1-score': 0.46870246387495385, 'support': 86542}}
[[11450  4294 12321]
 [ 6725 11830 11564]
 [ 6310  4468 17580]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.046941
{'0': {'precision': 0.4548922056384743, 'recall': 0.382126562880925, 'f1-score': 0.41534646906289635, 'support': 28713}, '1': {'precision': 0.5183225162256615, 'recall': 0.3606489040191753, 'f1-score': 0.42534363029272587, 'support': 28787}, '2': {'precision': 0.41894697112662765, 'recall': 0.6115281316713725, 'f1-score': 0.49724220959207105, 'support': 29042}, 'accuracy': 0.45196551963208614, 'macro avg': {'precision': 0.4640538976635878, 'recall': 0.4514345328571576, 'f1-score': 0.44597743631589776, 'support': 86542}, 'weighted avg': {'precision': 0.46392882196557916, 'recall': 0.45196551963208614, 'f1-score': 0.44615468214754195, 'support': 86542}}
[[10972  4802 12939]
 [ 6712 10382 11693]
 [ 6436  4846 17760]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0620692
{'0': {'precision': 0.4462934296525628, 'recall': 0.3565441429062178, 'f1-score': 0.3964022457319635, 'support': 29110}, '1': {'precision': 0.4562599738865516, 'recall': 0.33697632058287796, 'f1-score': 0.38764945149759644, 'support': 27999}, '2': {'precision': 0.41080104208228696, 'recall': 0.5946726463493358, 'f1-score': 0.48592448639644653, 'support': 29433}, 'accuracy': 0.43120103533544407, 'macro avg': {'precision': 0.4377848152071338, 'recall': 0.4293977032794771, 'f1-score': 0.42332539454200213, 'support': 86542}, 'weighted avg': {'precision': 0.43744692539626556, 'recall': 0.43120103533544407, 'f1-score': 0.42401702957922477, 'support': 86542}}
[[10379  5582 13149]
 [ 6609  9435 11955]
 [ 6268  5662 17503]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0802417
{'0': {'precision': 0.4114542701115139, 'recall': 0.31151414078243345, 'f1-score': 0.3545765527059893, 'support': 28782}, '1': {'precision': 0.40691442628712, 'recall': 0.3240737501311969, 'f1-score': 0.3608000467408028, 'support': 28583}, '2': {'precision': 0.3929787791459261, 'recall': 0.5655139322068753, 'f1-score': 0.46371761002754197, 'support': 29177}, 'accuracy': 0.4012964803216935, 'macro avg': {'precision': 0.40378249184818665, 'recall': 0.40036727437350184, 'f1-score': 0.3930314031581113, 'support': 86542}, 'weighted avg': {'precision': 0.40372597915526603, 'recall': 0.4012964803216935, 'f1-score': 0.3934281479946124, 'support': 86542}}
[[ 8966  6763 13053]
 [ 6886  9263 12434]
 [ 5939  6738 16500]]
Evaluating performance on  val set...
124/124 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.047077
{'0': {'precision': 0.46075511576520317, 'recall': 0.44709611261303256, 'f1-score': 0.4538228614685844, 'support': 10727}, '1': {'precision': 0.5250086835706843, 'recall': 0.3056622851365015, 'f1-score': 0.3863752556237219, 'support': 9890}, '2': {'precision': 0.43202082655385615, 'recall': 0.6081539166284929, 'f1-score': 0.5051750380517503, 'support': 10915}, 'accuracy': 0.45848661677026514, 'macro avg': {'precision': 0.4725948752965812, 'recall': 0.45363743812600904, 'f1-score': 0.44845771838135223, 'support': 31532}, 'weighted avg': {'precision': 0.47096166843723014, 'recall': 0.45848661677026514, 'f1-score': 0.450443823843301, 'support': 31532}}
[[4796 1323 4608]
 [2748 3023 4119]
 [2865 1412 6638]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.063619
{'0': {'precision': 0.45163487738419617, 'recall': 0.4237195288961928, 'f1-score': 0.43723208818126147, 'support': 10953}, '1': {'precision': 0.43982884649670173, 'recall': 0.2645860145860146, 'f1-score': 0.33040916091877054, 'support': 9324}, '2': {'precision': 0.42832491851473126, 'recall': 0.595468680586406, 'f1-score': 0.4982529179986618, 'support': 11255}, 'accuracy': 0.43796777876442977, 'macro avg': {'precision': 0.4399295474652097, 'recall': 0.42792474135620445, 'f1-score': 0.4219647223662313, 'support': 31532}, 'weighted avg': {'precision': 0.43982360568970086, 'recall': 0.43796777876442977, 'f1-score': 0.4274253035116996, 'support': 31532}}
[[4641 1509 4803]
 [2715 2467 4142]
 [2920 1633 6702]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0777662
{'0': {'precision': 0.4310989788696795, 'recall': 0.39518072289156625, 'f1-score': 0.4123591702528891, 'support': 10790}, '1': {'precision': 0.3843058350100604, 'recall': 0.24144106183503633, 'f1-score': 0.29656466325936465, 'support': 9493}, '2': {'precision': 0.42010588760604706, 'recall': 0.5854742643790559, 'f1-score': 0.48919260194607445, 'support': 11249}, 'accuracy': 0.41678295065330456, 'macro avg': {'precision': 0.4118369004952623, 'recall': 0.40736534970188615, 'f1-score': 0.3993721451527761, 'support': 31532}, 'weighted avg': {'precision': 0.4130896994619678, 'recall': 0.41678295065330456, 'f1-score': 0.40490839067110285, 'support': 31532}}
[[4264 1816 4710]
 [2820 2292 4381]
 [2807 1856 6586]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.091716
{'0': {'precision': 0.39385049978270315, 'recall': 0.34792206545733756, 'f1-score': 0.36946440401569586, 'support': 10419}, '1': {'precision': 0.3702857142857143, 'recall': 0.25108979947689625, 'f1-score': 0.2992553252900768, 'support': 10323}, '2': {'precision': 0.3900704592901879, 'recall': 0.5541241890639481, 'f1-score': 0.45784516425453714, 'support': 10790}, 'accuracy': 0.38678168210072306, 'macro avg': {'precision': 0.3847355577862017, 'recall': 0.3843786846660606, 'f1-score': 0.37552163118676996, 'support': 31532}, 'weighted avg': {'precision': 0.38484232023178166, 'recall': 0.38678168210072306, 'f1-score': 0.3767224302522978, 'support': 31532}}
[[3625 2194 4600]
 [2982 2592 4749]
 [2597 2214 5979]]
training model: results/XRAY/W4/deepVOL_L3/seq2seq
Epoch 1/50
339/339 - 21s - loss: 13.2122 - accuracy10: 0.3739 - accuracy20: 0.3712 - accuracy30: 0.3636 - accuracy50: 0.3646 - val_loss: 13.4942 - val_accuracy10: 0.3374 - val_accuracy20: 0.3137 - val_accuracy30: 0.3108 - val_accuracy50: 0.3306 - 21s/epoch - 61ms/step
Epoch 2/50
339/339 - 15s - loss: 13.1055 - accuracy10: 0.3870 - accuracy20: 0.3774 - accuracy30: 0.3688 - accuracy50: 0.3676 - val_loss: 13.1332 - val_accuracy10: 0.3867 - val_accuracy20: 0.3735 - val_accuracy30: 0.3527 - val_accuracy50: 0.3509 - 15s/epoch - 45ms/step
Epoch 3/50
339/339 - 15s - loss: 13.0512 - accuracy10: 0.3960 - accuracy20: 0.3888 - accuracy30: 0.3752 - accuracy50: 0.3691 - val_loss: 13.0769 - val_accuracy10: 0.3831 - val_accuracy20: 0.3843 - val_accuracy30: 0.3732 - val_accuracy50: 0.3608 - 15s/epoch - 45ms/step
Epoch 4/50
339/339 - 16s - loss: 12.9993 - accuracy10: 0.4041 - accuracy20: 0.3952 - accuracy30: 0.3810 - accuracy50: 0.3693 - val_loss: 13.0342 - val_accuracy10: 0.3871 - val_accuracy20: 0.3838 - val_accuracy30: 0.3736 - val_accuracy50: 0.3583 - 16s/epoch - 47ms/step
Epoch 5/50
339/339 - 16s - loss: 12.9701 - accuracy10: 0.4049 - accuracy20: 0.3919 - accuracy30: 0.3782 - accuracy50: 0.3674 - val_loss: 13.0353 - val_accuracy10: 0.3884 - val_accuracy20: 0.3844 - val_accuracy30: 0.3734 - val_accuracy50: 0.3576 - 16s/epoch - 46ms/step
Epoch 6/50
339/339 - 16s - loss: 12.9270 - accuracy10: 0.4070 - accuracy20: 0.3949 - accuracy30: 0.3817 - accuracy50: 0.3668 - val_loss: 13.0263 - val_accuracy10: 0.3857 - val_accuracy20: 0.3835 - val_accuracy30: 0.3698 - val_accuracy50: 0.3579 - 16s/epoch - 47ms/step
Epoch 7/50
339/339 - 16s - loss: 12.9027 - accuracy10: 0.4102 - accuracy20: 0.3988 - accuracy30: 0.3840 - accuracy50: 0.3699 - val_loss: 13.0095 - val_accuracy10: 0.3947 - val_accuracy20: 0.3862 - val_accuracy30: 0.3719 - val_accuracy50: 0.3580 - 16s/epoch - 46ms/step
Epoch 8/50
339/339 - 16s - loss: 12.8912 - accuracy10: 0.4149 - accuracy20: 0.4011 - accuracy30: 0.3884 - accuracy50: 0.3718 - val_loss: 13.0075 - val_accuracy10: 0.3915 - val_accuracy20: 0.3868 - val_accuracy30: 0.3747 - val_accuracy50: 0.3555 - 16s/epoch - 46ms/step
Epoch 9/50
339/339 - 16s - loss: 12.8301 - accuracy10: 0.4236 - accuracy20: 0.4098 - accuracy30: 0.3948 - accuracy50: 0.3766 - val_loss: 12.9847 - val_accuracy10: 0.4037 - val_accuracy20: 0.3941 - val_accuracy30: 0.3803 - val_accuracy50: 0.3594 - 16s/epoch - 46ms/step
Epoch 10/50
339/339 - 16s - loss: 12.7626 - accuracy10: 0.4368 - accuracy20: 0.4234 - accuracy30: 0.4069 - accuracy50: 0.3857 - val_loss: 12.9407 - val_accuracy10: 0.4131 - val_accuracy20: 0.4028 - val_accuracy30: 0.3874 - val_accuracy50: 0.3654 - 16s/epoch - 47ms/step
Epoch 11/50
339/339 - 16s - loss: 12.6709 - accuracy10: 0.4516 - accuracy20: 0.4354 - accuracy30: 0.4191 - accuracy50: 0.3983 - val_loss: 12.9328 - val_accuracy10: 0.4229 - val_accuracy20: 0.4130 - val_accuracy30: 0.3962 - val_accuracy50: 0.3704 - 16s/epoch - 46ms/step
Epoch 12/50
339/339 - 15s - loss: 12.6113 - accuracy10: 0.4607 - accuracy20: 0.4449 - accuracy30: 0.4275 - accuracy50: 0.4048 - val_loss: 12.8723 - val_accuracy10: 0.4406 - val_accuracy20: 0.4235 - val_accuracy30: 0.4025 - val_accuracy50: 0.3808 - 15s/epoch - 45ms/step
Epoch 13/50
339/339 - 15s - loss: 12.5315 - accuracy10: 0.4710 - accuracy20: 0.4544 - accuracy30: 0.4373 - accuracy50: 0.4114 - val_loss: 12.8929 - val_accuracy10: 0.4454 - val_accuracy20: 0.4252 - val_accuracy30: 0.4011 - val_accuracy50: 0.3796 - 15s/epoch - 45ms/step
Epoch 14/50
339/339 - 16s - loss: 12.5086 - accuracy10: 0.4746 - accuracy20: 0.4585 - accuracy30: 0.4399 - accuracy50: 0.4111 - val_loss: 12.8709 - val_accuracy10: 0.4542 - val_accuracy20: 0.4348 - val_accuracy30: 0.4073 - val_accuracy50: 0.3860 - 16s/epoch - 46ms/step
Epoch 15/50
339/339 - 16s - loss: 12.4595 - accuracy10: 0.4812 - accuracy20: 0.4625 - accuracy30: 0.4442 - accuracy50: 0.4144 - val_loss: 12.8769 - val_accuracy10: 0.4516 - val_accuracy20: 0.4325 - val_accuracy30: 0.4076 - val_accuracy50: 0.3803 - 16s/epoch - 47ms/step
Epoch 16/50
339/339 - 16s - loss: 12.4119 - accuracy10: 0.4870 - accuracy20: 0.4684 - accuracy30: 0.4501 - accuracy50: 0.4202 - val_loss: 12.9539 - val_accuracy10: 0.4532 - val_accuracy20: 0.4312 - val_accuracy30: 0.4056 - val_accuracy50: 0.3826 - 16s/epoch - 46ms/step
Epoch 17/50
339/339 - 15s - loss: 12.3783 - accuracy10: 0.4902 - accuracy20: 0.4720 - accuracy30: 0.4526 - accuracy50: 0.4226 - val_loss: 12.9339 - val_accuracy10: 0.4548 - val_accuracy20: 0.4317 - val_accuracy30: 0.4059 - val_accuracy50: 0.3810 - 15s/epoch - 45ms/step
Epoch 18/50
339/339 - 15s - loss: 12.3521 - accuracy10: 0.4939 - accuracy20: 0.4758 - accuracy30: 0.4551 - accuracy50: 0.4250 - val_loss: 12.8927 - val_accuracy10: 0.4514 - val_accuracy20: 0.4353 - val_accuracy30: 0.4135 - val_accuracy50: 0.3845 - 15s/epoch - 45ms/step
Epoch 19/50
339/339 - 16s - loss: 12.3268 - accuracy10: 0.4966 - accuracy20: 0.4774 - accuracy30: 0.4576 - accuracy50: 0.4262 - val_loss: 12.9021 - val_accuracy10: 0.4541 - val_accuracy20: 0.4355 - val_accuracy30: 0.4122 - val_accuracy50: 0.3862 - 16s/epoch - 47ms/step
Epoch 20/50
339/339 - 16s - loss: 12.2996 - accuracy10: 0.5013 - accuracy20: 0.4810 - accuracy30: 0.4598 - accuracy50: 0.4290 - val_loss: 12.8613 - val_accuracy10: 0.4557 - val_accuracy20: 0.4387 - val_accuracy30: 0.4152 - val_accuracy50: 0.3889 - 16s/epoch - 48ms/step
Epoch 21/50
339/339 - 16s - loss: 12.2594 - accuracy10: 0.5030 - accuracy20: 0.4838 - accuracy30: 0.4649 - accuracy50: 0.4348 - val_loss: 12.8987 - val_accuracy10: 0.4468 - val_accuracy20: 0.4315 - val_accuracy30: 0.4093 - val_accuracy50: 0.3851 - 16s/epoch - 46ms/step
Epoch 22/50
339/339 - 16s - loss: 12.2562 - accuracy10: 0.5026 - accuracy20: 0.4838 - accuracy30: 0.4638 - accuracy50: 0.4331 - val_loss: 12.8494 - val_accuracy10: 0.4546 - val_accuracy20: 0.4376 - val_accuracy30: 0.4170 - val_accuracy50: 0.3947 - 16s/epoch - 46ms/step
Epoch 23/50
339/339 - 16s - loss: 12.2229 - accuracy10: 0.5043 - accuracy20: 0.4864 - accuracy30: 0.4670 - accuracy50: 0.4370 - val_loss: 12.8782 - val_accuracy10: 0.4488 - val_accuracy20: 0.4334 - val_accuracy30: 0.4133 - val_accuracy50: 0.3907 - 16s/epoch - 47ms/step
Epoch 24/50
339/339 - 16s - loss: 12.2197 - accuracy10: 0.5062 - accuracy20: 0.4863 - accuracy30: 0.4673 - accuracy50: 0.4373 - val_loss: 12.8597 - val_accuracy10: 0.4508 - val_accuracy20: 0.4351 - val_accuracy30: 0.4155 - val_accuracy50: 0.3890 - 16s/epoch - 46ms/step
Epoch 25/50
339/339 - 15s - loss: 12.1854 - accuracy10: 0.5094 - accuracy20: 0.4910 - accuracy30: 0.4715 - accuracy50: 0.4408 - val_loss: 12.8632 - val_accuracy10: 0.4544 - val_accuracy20: 0.4366 - val_accuracy30: 0.4170 - val_accuracy50: 0.3925 - 15s/epoch - 45ms/step
Epoch 26/50
339/339 - 16s - loss: 12.1626 - accuracy10: 0.5118 - accuracy20: 0.4933 - accuracy30: 0.4737 - accuracy50: 0.4421 - val_loss: 12.8387 - val_accuracy10: 0.4546 - val_accuracy20: 0.4377 - val_accuracy30: 0.4155 - val_accuracy50: 0.3930 - 16s/epoch - 46ms/step
Epoch 27/50
339/339 - 16s - loss: 12.1364 - accuracy10: 0.5144 - accuracy20: 0.4967 - accuracy30: 0.4764 - accuracy50: 0.4443 - val_loss: 12.9051 - val_accuracy10: 0.4535 - val_accuracy20: 0.4356 - val_accuracy30: 0.4152 - val_accuracy50: 0.3897 - 16s/epoch - 46ms/step
Epoch 28/50
339/339 - 16s - loss: 12.1204 - accuracy10: 0.5141 - accuracy20: 0.4972 - accuracy30: 0.4765 - accuracy50: 0.4470 - val_loss: 12.8804 - val_accuracy10: 0.4588 - val_accuracy20: 0.4388 - val_accuracy30: 0.4166 - val_accuracy50: 0.3931 - 16s/epoch - 48ms/step
Epoch 29/50
339/339 - 16s - loss: 12.0994 - accuracy10: 0.5170 - accuracy20: 0.4994 - accuracy30: 0.4780 - accuracy50: 0.4488 - val_loss: 12.8736 - val_accuracy10: 0.4601 - val_accuracy20: 0.4386 - val_accuracy30: 0.4160 - val_accuracy50: 0.3915 - 16s/epoch - 46ms/step
Epoch 30/50
339/339 - 16s - loss: 12.0755 - accuracy10: 0.5174 - accuracy20: 0.5005 - accuracy30: 0.4808 - accuracy50: 0.4509 - val_loss: 12.9002 - val_accuracy10: 0.4597 - val_accuracy20: 0.4422 - val_accuracy30: 0.4173 - val_accuracy50: 0.3924 - 16s/epoch - 47ms/step
Epoch 31/50
339/339 - 16s - loss: 12.0598 - accuracy10: 0.5190 - accuracy20: 0.5024 - accuracy30: 0.4818 - accuracy50: 0.4512 - val_loss: 12.8973 - val_accuracy10: 0.4619 - val_accuracy20: 0.4417 - val_accuracy30: 0.4166 - val_accuracy50: 0.3912 - 16s/epoch - 46ms/step
Epoch 32/50
339/339 - 16s - loss: 12.0320 - accuracy10: 0.5204 - accuracy20: 0.5034 - accuracy30: 0.4835 - accuracy50: 0.4541 - val_loss: 12.9143 - val_accuracy10: 0.4588 - val_accuracy20: 0.4393 - val_accuracy30: 0.4177 - val_accuracy50: 0.3923 - 16s/epoch - 46ms/step
Epoch 33/50
339/339 - 15s - loss: 12.0185 - accuracy10: 0.5213 - accuracy20: 0.5054 - accuracy30: 0.4851 - accuracy50: 0.4546 - val_loss: 12.9845 - val_accuracy10: 0.4604 - val_accuracy20: 0.4372 - val_accuracy30: 0.4129 - val_accuracy50: 0.3875 - 15s/epoch - 45ms/step
Epoch 34/50
339/339 - 16s - loss: 12.0043 - accuracy10: 0.5208 - accuracy20: 0.5064 - accuracy30: 0.4869 - accuracy50: 0.4563 - val_loss: 12.9669 - val_accuracy10: 0.4639 - val_accuracy20: 0.4405 - val_accuracy30: 0.4165 - val_accuracy50: 0.3921 - 16s/epoch - 47ms/step
Epoch 35/50
339/339 - 15s - loss: 11.9780 - accuracy10: 0.5232 - accuracy20: 0.5083 - accuracy30: 0.4895 - accuracy50: 0.4591 - val_loss: 13.0111 - val_accuracy10: 0.4599 - val_accuracy20: 0.4387 - val_accuracy30: 0.4148 - val_accuracy50: 0.3904 - 15s/epoch - 45ms/step
Epoch 36/50
339/339 - 16s - loss: 11.9760 - accuracy10: 0.5213 - accuracy20: 0.5073 - accuracy30: 0.4899 - accuracy50: 0.4582 - val_loss: 13.0079 - val_accuracy10: 0.4622 - val_accuracy20: 0.4402 - val_accuracy30: 0.4148 - val_accuracy50: 0.3916 - 16s/epoch - 47ms/step
testing model: results/XRAY/W4/deepVOL_L3/seq2seq
Evaluating performance on  test set...
989/989 - 20s - 20s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0694644
{'0': {'precision': 0.4461625070369675, 'recall': 0.3411337647244501, 'f1-score': 0.3866424906697456, 'support': 69697}, '1': {'precision': 0.6500506236401629, 'recall': 0.2622494915961274, 'f1-score': 0.37372667768922574, 'support': 115066}, '2': {'precision': 0.34088921948609535, 'recall': 0.7659736680057473, 'f1-score': 0.4718058013943575, 'support': 68206}, 'accuracy': 0.41979847333072434, 'macro avg': {'precision': 0.4790341167210752, 'recall': 0.45645230810877496, 'f1-score': 0.4107249899177763, 'support': 252969}, 'weighted avg': {'precision': 0.5105194842727889, 'recall': 0.41979847333072434, 'f1-score': 0.4037294769600277, 'support': 252969}}
[[23776  9449 36472]
 [20348 30176 64542]
 [ 9166  6796 52244]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0798303
{'0': {'precision': 0.44811540251279663, 'recall': 0.3280106816354892, 'f1-score': 0.37877000047198756, 'support': 73397}, '1': {'precision': 0.5720598013770618, 'recall': 0.2467182860155968, 'f1-score': 0.3447518097207859, 'support': 108099}, '2': {'precision': 0.348217503259666, 'recall': 0.743581492311782, 'f1-score': 0.47431457946594324, 'support': 71473}, 'accuracy': 0.410686684929774, 'macro avg': {'precision': 0.4561309023831748, 'recall': 0.4394368199876227, 'f1-score': 0.3992787965529055, 'support': 252969}, 'weighted avg': {'precision': 0.47285465127256243, 'recall': 0.410686684929774, 'f1-score': 0.3912281486736283, 'support': 252969}}
[[24075 11787 37535]
 [19487 26670 61942]
 [10163  8164 53146]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0864474
{'0': {'precision': 0.45105584966107326, 'recall': 0.29777026939891416, 'f1-score': 0.3587241909674212, 'support': 77543}, '1': {'precision': 0.4911932573696377, 'recall': 0.2393965981375501, 'f1-score': 0.3219042639478218, 'support': 100298}, '2': {'precision': 0.3552110925798751, 'recall': 0.7228995847087637, 'f1-score': 0.47635545537073015, 'support': 75128}, 'accuracy': 0.400883112159988, 'macro avg': {'precision': 0.4324867332035287, 'recall': 0.4200221507484094, 'f1-score': 0.38566130342865773, 'support': 252969}, 'weighted avg': {'precision': 0.438505208311174, 'recall': 0.400883112159988, 'f1-score': 0.37906042422872993, 'support': 252969}}
[[23090 14552 39901]
 [17603 24011 58684]
 [10498 10320 54310]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1075084
{'0': {'precision': 0.3776223776223776, 'recall': 0.2569546120058565, 'f1-score': 0.305815726421259, 'support': 71032}, '1': {'precision': 0.5029652371236246, 'recall': 0.2277169596297959, 'f1-score': 0.31349802994015535, 'support': 115828}, '2': {'precision': 0.3042629801437639, 'recall': 0.7004643845769865, 'f1-score': 0.4242452004782344, 'support': 66109}, 'accuracy': 0.3594709233147145, 'macro avg': {'precision': 0.3949501982965887, 'recall': 0.3950453187375463, 'f1-score': 0.34785298561321626, 'support': 252969}, 'weighted avg': {'precision': 0.41584246119940393, 'recall': 0.3594709233147145, 'f1-score': 0.3402827162596159, 'support': 252969}}
[[18252 15304 37476]
 [21041 26376 68411]
 [ 9041 10761 46307]]
Evaluating performance on  train set...
339/339 - 7s - 7s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0197417
{'0': {'precision': 0.4985112717992344, 'recall': 0.3758417958311064, 'f1-score': 0.42857142857142855, 'support': 28065}, '1': {'precision': 0.6238877703448724, 'recall': 0.31893489159666655, 'f1-score': 0.422093329818086, 'support': 30119}, '2': {'precision': 0.41589645100628175, 'recall': 0.733091191198251, 'f1-score': 0.5307107117328704, 'support': 28358}, 'accuracy': 0.4730997665873218, 'macro avg': {'precision': 0.5127651643834629, 'recall': 0.475955959542008, 'f1-score': 0.46045849004079503, 'support': 86542}, 'weighted avg': {'precision': 0.5150746014154846, 'recall': 0.4730997665873218, 'f1-score': 0.4597857746177441, 'support': 86542}}
[[10548  3301 14216]
 [ 5532  9606 14981]
 [ 5079  2490 20789]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0397819
{'0': {'precision': 0.48787850202811056, 'recall': 0.3602549367882144, 'f1-score': 0.41446458980266454, 'support': 28713}, '1': {'precision': 0.541795665634675, 'recall': 0.30395664709764825, 'f1-score': 0.38943409662416273, 'support': 28787}, '2': {'precision': 0.41479975604797725, 'recall': 0.7025686936161422, 'f1-score': 0.5216279783208918, 'support': 29042}, 'accuracy': 0.45640267153520836, 'macro avg': {'precision': 0.4814913079035876, 'recall': 0.4555934258340016, 'f1-score': 0.441842221582573, 'support': 86542}, 'weighted avg': {'precision': 0.4812893366285027, 'recall': 0.45640267153520836, 'f1-score': 0.4421007239596846, 'support': 86542}}
[[10344  4132 14237]
 [ 5488  8750 14549]
 [ 5370  3268 20404]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0547512
{'0': {'precision': 0.4774788391777509, 'recall': 0.32555822741326007, 'f1-score': 0.38714816781731287, 'support': 29110}, '1': {'precision': 0.472334455667789, 'recall': 0.3006178792099718, 'f1-score': 0.3674021694057051, 'support': 27999}, '2': {'precision': 0.4083561812006384, 'recall': 0.6780824244895186, 'f1-score': 0.5097373159487658, 'support': 29433}, 'accuracy': 0.4373830047838044, 'macro avg': {'precision': 0.4527231586820594, 'recall': 0.4347528437042502, 'f1-score': 0.4214292177239279, 'support': 86542}, 'weighted avg': {'precision': 0.452305804279831, 'recall': 0.4373830047838044, 'f1-score': 0.4224523922103989, 'support': 86542}}
[[ 9477  5231 14402]
 [ 5068  8417 14514]
 [ 5303  4172 19958]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0759379
{'0': {'precision': 0.43854899837574446, 'recall': 0.28142589118198874, 'f1-score': 0.34284263099974605, 'support': 28782}, '1': {'precision': 0.42270078540663797, 'recall': 0.2918518000209915, 'f1-score': 0.3452957489962333, 'support': 28583}, '2': {'precision': 0.3909013798953183, 'recall': 0.6475991363059944, 'f1-score': 0.4875248342234951, 'support': 29177}, 'accuracy': 0.4083219708349703, 'macro avg': {'precision': 0.41738372122590023, 'recall': 0.4069589425029916, 'f1-score': 0.3918877380731581, 'support': 86542}, 'weighted avg': {'precision': 0.4172506226079165, 'recall': 0.4083219708349703, 'f1-score': 0.39243138692349316, 'support': 86542}}
[[ 8100  6275 14407]
 [ 5206  8342 15035]
 [ 5164  5118 18895]]
Evaluating performance on  val set...
124/124 - 3s - 3s/epoch - 22ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0429095
{'0': {'precision': 0.477350276503118, 'recall': 0.37820453062365994, 'f1-score': 0.42203266410069695, 'support': 10727}, '1': {'precision': 0.5318805488297014, 'recall': 0.2665318503538928, 'f1-score': 0.3551124882123131, 'support': 9890}, '2': {'precision': 0.4251258505282956, 'recall': 0.7040769583142464, 'f1-score': 0.5301462472406181, 'support': 10915}, 'accuracy': 0.45598122542179376, 'macro avg': {'precision': 0.478118891953705, 'recall': 0.44960444643059977, 'f1-score': 0.4357637998512094, 'support': 31532}, 'weighted avg': {'precision': 0.4763758626947558, 'recall': 0.45598122542179376, 'f1-score': 0.4384673723474343, 'support': 31532}}
[[4057 1282 5388]
 [2250 2636 5004]
 [2192 1038 7685]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0625416
{'0': {'precision': 0.47146578261899125, 'recall': 0.3635533643750571, 'f1-score': 0.4105366255992577, 'support': 10953}, '1': {'precision': 0.4371369683342702, 'recall': 0.2502145002145002, 'f1-score': 0.3182593274674306, 'support': 9324}, '2': {'precision': 0.4246999830976393, 'recall': 0.6697467792092403, 'f1-score': 0.5197903737415528, 'support': 11255}, 'accuracy': 0.43933147278954715, 'macro avg': {'precision': 0.4444342446836336, 'recall': 0.4278382145995992, 'f1-score': 0.4161954422694137, 'support': 31532}, 'weighted avg': {'precision': 0.44462222883224906, 'recall': 0.43933147278954715, 'f1-score': 0.42224718653926707, 'support': 31532}}
[[3982 1590 5381]
 [2161 2333 4830]
 [2303 1414 7538]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0776352
{'0': {'precision': 0.4505175460742237, 'recall': 0.33076923076923076, 'f1-score': 0.3814664386489953, 'support': 10790}, '1': {'precision': 0.38622507826660074, 'recall': 0.2469187822606131, 'f1-score': 0.3012466263976353, 'support': 9493}, '2': {'precision': 0.4142295194116641, 'recall': 0.6459240821406347, 'f1-score': 0.5047585967349774, 'support': 11249}, 'accuracy': 0.4179563617911962, 'macro avg': {'precision': 0.41699071458416287, 'recall': 0.4078706983901595, 'f1-score': 0.395823887260536, 'support': 31532}, 'weighted avg': {'precision': 0.4182159981602031, 'recall': 0.4179563617911962, 'f1-score': 0.40129983991142876, 'support': 31532}}
[[3569 1960 5261]
 [2135 2344 5014]
 [2218 1765 7266]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0942203
{'0': {'precision': 0.41030560504316843, 'recall': 0.2873596314425569, 'f1-score': 0.33799954843079705, 'support': 10419}, '1': {'precision': 0.3901955228109946, 'recall': 0.2667829119442023, 'f1-score': 0.3168977619239399, 'support': 10323}, '2': {'precision': 0.3847586889445188, 'recall': 0.6125115848007414, 'f1-score': 0.4726284549647799, 'support': 10790}, 'accuracy': 0.3918876062412787, 'macro avg': {'precision': 0.3950866055995606, 'recall': 0.38888470939583347, 'f1-score': 0.3758419217731723, 'support': 31532}, 'weighted avg': {'precision': 0.39497998016725955, 'recall': 0.3918876062412787, 'f1-score': 0.37716015224252447, 'support': 31532}}
[[2994 2269 5156]
 [2157 2754 5412]
 [2146 2035 6609]]
training model: results/XRAY/W5/deepLOB_L1/seq2seq
Epoch 1/50
483/483 - 19s - loss: 12.9476 - accuracy10: 0.4054 - accuracy20: 0.4045 - accuracy30: 0.4005 - accuracy50: 0.3892 - val_loss: 13.0676 - val_accuracy10: 0.3749 - val_accuracy20: 0.4091 - val_accuracy30: 0.4045 - val_accuracy50: 0.3882 - 19s/epoch - 39ms/step
Epoch 2/50
483/483 - 13s - loss: 12.8082 - accuracy10: 0.4150 - accuracy20: 0.4245 - accuracy30: 0.4167 - accuracy50: 0.4003 - val_loss: 13.0467 - val_accuracy10: 0.3868 - val_accuracy20: 0.4158 - val_accuracy30: 0.4072 - val_accuracy50: 0.3891 - 13s/epoch - 27ms/step
Epoch 3/50
483/483 - 13s - loss: 12.6925 - accuracy10: 0.4409 - accuracy20: 0.4428 - accuracy30: 0.4326 - accuracy50: 0.4098 - val_loss: 12.8677 - val_accuracy10: 0.4063 - val_accuracy20: 0.4401 - val_accuracy30: 0.4307 - val_accuracy50: 0.4086 - 13s/epoch - 27ms/step
Epoch 4/50
483/483 - 13s - loss: 12.5964 - accuracy10: 0.4660 - accuracy20: 0.4574 - accuracy30: 0.4417 - accuracy50: 0.4161 - val_loss: 12.8487 - val_accuracy10: 0.4136 - val_accuracy20: 0.4433 - val_accuracy30: 0.4338 - val_accuracy50: 0.4137 - 13s/epoch - 27ms/step
Epoch 5/50
483/483 - 14s - loss: 12.5394 - accuracy10: 0.4745 - accuracy20: 0.4637 - accuracy30: 0.4473 - accuracy50: 0.4199 - val_loss: 12.8199 - val_accuracy10: 0.4140 - val_accuracy20: 0.4462 - val_accuracy30: 0.4366 - val_accuracy50: 0.4137 - 14s/epoch - 28ms/step
Epoch 6/50
483/483 - 13s - loss: 12.5005 - accuracy10: 0.4808 - accuracy20: 0.4688 - accuracy30: 0.4514 - accuracy50: 0.4225 - val_loss: 12.7883 - val_accuracy10: 0.4200 - val_accuracy20: 0.4490 - val_accuracy30: 0.4380 - val_accuracy50: 0.4161 - 13s/epoch - 27ms/step
Epoch 7/50
483/483 - 13s - loss: 12.4774 - accuracy10: 0.4835 - accuracy20: 0.4702 - accuracy30: 0.4532 - accuracy50: 0.4256 - val_loss: 12.7409 - val_accuracy10: 0.4252 - val_accuracy20: 0.4522 - val_accuracy30: 0.4422 - val_accuracy50: 0.4172 - 13s/epoch - 27ms/step
Epoch 8/50
483/483 - 13s - loss: 12.4508 - accuracy10: 0.4860 - accuracy20: 0.4719 - accuracy30: 0.4547 - accuracy50: 0.4267 - val_loss: 12.7687 - val_accuracy10: 0.4296 - val_accuracy20: 0.4518 - val_accuracy30: 0.4399 - val_accuracy50: 0.4162 - 13s/epoch - 27ms/step
Epoch 9/50
483/483 - 13s - loss: 12.4184 - accuracy10: 0.4883 - accuracy20: 0.4745 - accuracy30: 0.4575 - accuracy50: 0.4286 - val_loss: 12.8023 - val_accuracy10: 0.4256 - val_accuracy20: 0.4508 - val_accuracy30: 0.4396 - val_accuracy50: 0.4163 - 13s/epoch - 27ms/step
Epoch 10/50
483/483 - 13s - loss: 12.4061 - accuracy10: 0.4880 - accuracy20: 0.4759 - accuracy30: 0.4581 - accuracy50: 0.4285 - val_loss: 12.7578 - val_accuracy10: 0.4312 - val_accuracy20: 0.4533 - val_accuracy30: 0.4407 - val_accuracy50: 0.4171 - 13s/epoch - 28ms/step
Epoch 11/50
483/483 - 13s - loss: 12.3933 - accuracy10: 0.4893 - accuracy20: 0.4764 - accuracy30: 0.4584 - accuracy50: 0.4298 - val_loss: 12.7727 - val_accuracy10: 0.4309 - val_accuracy20: 0.4532 - val_accuracy30: 0.4403 - val_accuracy50: 0.4162 - 13s/epoch - 27ms/step
Epoch 12/50
483/483 - 13s - loss: 12.3724 - accuracy10: 0.4900 - accuracy20: 0.4776 - accuracy30: 0.4598 - accuracy50: 0.4313 - val_loss: 12.7823 - val_accuracy10: 0.4248 - val_accuracy20: 0.4508 - val_accuracy30: 0.4375 - val_accuracy50: 0.4122 - 13s/epoch - 27ms/step
Epoch 13/50
483/483 - 13s - loss: 12.3543 - accuracy10: 0.4909 - accuracy20: 0.4796 - accuracy30: 0.4627 - accuracy50: 0.4337 - val_loss: 12.7833 - val_accuracy10: 0.4256 - val_accuracy20: 0.4486 - val_accuracy30: 0.4363 - val_accuracy50: 0.4126 - 13s/epoch - 27ms/step
Epoch 14/50
483/483 - 13s - loss: 12.3293 - accuracy10: 0.4934 - accuracy20: 0.4817 - accuracy30: 0.4638 - accuracy50: 0.4345 - val_loss: 12.7951 - val_accuracy10: 0.4278 - val_accuracy20: 0.4513 - val_accuracy30: 0.4376 - val_accuracy50: 0.4125 - 13s/epoch - 27ms/step
Epoch 15/50
483/483 - 14s - loss: 12.3095 - accuracy10: 0.4935 - accuracy20: 0.4817 - accuracy30: 0.4640 - accuracy50: 0.4337 - val_loss: 12.8445 - val_accuracy10: 0.4194 - val_accuracy20: 0.4485 - val_accuracy30: 0.4363 - val_accuracy50: 0.4119 - 14s/epoch - 28ms/step
Epoch 16/50
483/483 - 13s - loss: 12.2974 - accuracy10: 0.4943 - accuracy20: 0.4831 - accuracy30: 0.4656 - accuracy50: 0.4345 - val_loss: 12.8122 - val_accuracy10: 0.4207 - val_accuracy20: 0.4492 - val_accuracy30: 0.4362 - val_accuracy50: 0.4111 - 13s/epoch - 27ms/step
Epoch 17/50
483/483 - 13s - loss: 12.2749 - accuracy10: 0.4966 - accuracy20: 0.4853 - accuracy30: 0.4667 - accuracy50: 0.4374 - val_loss: 12.8300 - val_accuracy10: 0.4198 - val_accuracy20: 0.4478 - val_accuracy30: 0.4354 - val_accuracy50: 0.4106 - 13s/epoch - 27ms/step
testing model: results/XRAY/W5/deepLOB_L1/seq2seq
Evaluating performance on  test set...
2341/2341 - 29s - 29s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0481156
{'0': {'precision': 0.4058166213460231, 'recall': 0.5539265436788475, 'f1-score': 0.4684432390280267, 'support': 172429}, '1': {'precision': 0.5784021850460909, 'recall': 0.33341074225976336, 'f1-score': 0.4229935682326622, 'support': 254062}, '2': {'precision': 0.40984857890404786, 'recall': 0.5158282790869948, 'f1-score': 0.4567716807810078, 'support': 172792}, 'accuracy': 0.44945543257526077, 'macro avg': {'precision': 0.46468912843205396, 'recall': 0.4677218550085352, 'f1-score': 0.44940282934723225, 'support': 599283}, 'weighted avg': {'precision': 0.4801456503609173, 'recall': 0.44945543257526077, 'f1-score': 0.44580988190921844, 'support': 599283}}
[[95513 32031 44885]
 [85898 84707 83457]
 [53949 29712 89131]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0579708
{'0': {'precision': 0.45419246016456466, 'recall': 0.5137974119561427, 'f1-score': 0.48215981857596674, 'support': 206488}, '1': {'precision': 0.4393850998474699, 'recall': 0.3350413240858855, 'f1-score': 0.38018373621294177, 'support': 186574}, '2': {'precision': 0.4524146265049456, 'recall': 0.49016831457514026, 'f1-score': 0.4705353880242336, 'support': 206221}, 'accuracy': 0.4500144339151953, 'macro avg': {'precision': 0.44866406217232674, 'recall': 0.44633568353905617, 'f1-score': 0.444292980937714, 'support': 599283}, 'weighted avg': {'precision': 0.44897072839689905, 'recall': 0.4500144339151953, 'f1-score': 0.4464116206734599, 'support': 599283}}
[[106093  40879  59516]
 [ 61233  62510  62831]
 [ 66260  38878 101083]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0689
{'0': {'precision': 0.45527372159152957, 'recall': 0.48687621743578247, 'f1-score': 0.4705449489180929, 'support': 214077}, '1': {'precision': 0.389067084747713, 'recall': 0.3154920542353113, 'f1-score': 0.3484379578968385, 'support': 171475}, '2': {'precision': 0.44878900811939576, 'recall': 0.48567591973087665, 'f1-score': 0.4665044300483789, 'support': 213731}, 'accuracy': 0.43740937086485016, 'macro avg': {'precision': 0.43104327148621274, 'recall': 0.4293480638006568, 'f1-score': 0.4284957789544368, 'support': 599283}, 'weighted avg': {'precision': 0.4340170409449801, 'recall': 0.43740937086485016, 'f1-score': 0.4341650075149287, 'support': 599283}}
[[104229  43344  66504]
 [ 56386  54099  60990]
 [ 68322  41605 103804]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0835787
{'0': {'precision': 0.43036656296496684, 'recall': 0.45407233684250586, 'f1-score': 0.4419017548570489, 'support': 210211}, '1': {'precision': 0.3656783336028342, 'recall': 0.27843723241718576, 'f1-score': 0.3161496741724043, 'support': 178683}, '2': {'precision': 0.42207348439978626, 'recall': 0.48436467686048224, 'f1-score': 0.45107872907389535, 'support': 210389}, 'accuracy': 0.4123394122643225, 'macro avg': {'precision': 0.4060394603225291, 'recall': 0.4056247487067246, 'f1-score': 0.40304338603444956, 'support': 599283}, 'weighted avg': {'precision': 0.4081676028853989, 'recall': 0.4123394122643225, 'f1-score': 0.4076290913500476, 'support': 599283}}
[[ 95451  43618  71142]
 [ 60539  49752  68392]
 [ 65800  42684 101905]]
Evaluating performance on  train set...
483/483 - 6s - 6s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0291792
{'0': {'precision': 0.4064808142676995, 'recall': 0.5450016605778811, 'f1-score': 0.4656580118407306, 'support': 33121}, '1': {'precision': 0.6418407508325764, 'recall': 0.337788793484996, 'f1-score': 0.4426297963160581, 'support': 56485}, '2': {'precision': 0.40081447413740706, 'recall': 0.5838104231836156, 'f1-score': 0.475307233040616, 'support': 33886}, 'accuracy': 0.4608719593172027, 'macro avg': {'precision': 0.483045346412561, 'recall': 0.4888669590821643, 'f1-score': 0.4611983470658016, 'support': 123492}, 'weighted avg': {'precision': 0.5125791559838591, 'recall': 0.4608719593172027, 'f1-score': 0.45777268125792514, 'support': 123492}}
[[18051  5590  9480]
 [17311 19080 20094]
 [ 9046  5057 19783]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0359358
{'0': {'precision': 0.4524796701408773, 'recall': 0.49466593208454374, 'f1-score': 0.47263330422194844, 'support': 39932}, '1': {'precision': 0.5144996309184857, 'recall': 0.3426504670271789, 'f1-score': 0.4113481156732148, 'support': 42717}, '2': {'precision': 0.44776990737137073, 'recall': 0.563376833239478, 'f1-score': 0.49896455638559695, 'support': 40843}, 'accuracy': 0.4648074369189907, 'macro avg': {'precision': 0.47158306947691125, 'recall': 0.4668977441170668, 'f1-score': 0.4609819920935867, 'support': 123492}, 'weighted avg': {'precision': 0.4723752570917902, 'recall': 0.4648074369189907, 'f1-score': 0.46014284275791545, 'support': 123492}}
[[19753  7306 12873]
 [12575 14637 15505]
 [11327  6506 23010]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0495696
{'0': {'precision': 0.4457131982110572, 'recall': 0.458272184717738, 'f1-score': 0.45190545103714425, 'support': 40884}, '1': {'precision': 0.4814098587951983, 'recall': 0.3185802245563202, 'f1-score': 0.38342390514661007, 'support': 41415}, '2': {'precision': 0.4352346944439305, 'recall': 0.5710678998859029, 'f1-score': 0.4939837466663866, 'support': 41193}, 'accuracy': 0.4490493311307615, 'macro avg': {'precision': 0.4541192504833953, 'recall': 0.449306769719987, 'f1-score': 0.4431043676167136, 'support': 123492}, 'weighted avg': {'precision': 0.45418934397283095, 'recall': 0.4490493311307615, 'f1-score': 0.44297505885626537, 'support': 123492}}
[[18736  7631 14517]
 [12213 13194 16008]
 [11087  6582 23524]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0684866
{'0': {'precision': 0.42754910546728386, 'recall': 0.4117448613219596, 'f1-score': 0.4194981832465875, 'support': 41499}, '1': {'precision': 0.43751899118808874, 'recall': 0.2832866066597806, 'f1-score': 0.3439020749365577, 'support': 40662}, '2': {'precision': 0.41289183377331773, 'recall': 0.5714112893469793, 'f1-score': 0.4793869887343956, 'support': 41331}, 'accuracy': 0.4228856930003563, 'macro avg': {'precision': 0.42598664347623005, 'recall': 0.4221475857762398, 'f1-score': 0.41426241563918026, 'support': 123492}, 'weighted avg': {'precision': 0.42592629424709194, 'recall': 0.4228856930003563, 'f1-score': 0.4146507053817393, 'support': 123492}}
[[17087  8073 16339]
 [11900 11519 17243]
 [10978  6736 23617]]
Evaluating performance on  val set...
162/162 - 2s - 2s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0652461
{'0': {'precision': 0.3856631651852707, 'recall': 0.5750925208709872, 'f1-score': 0.4617032302642944, 'support': 11619}, '1': {'precision': 0.6146508279337654, 'recall': 0.19946264820980084, 'f1-score': 0.30118622392732725, 'support': 17121}, '2': {'precision': 0.40708204544222115, 'recall': 0.5965985853929905, 'f1-score': 0.4839479112944816, 'support': 12583}, 'accuracy': 0.42600972823851124, 'macro avg': {'precision': 0.4691320128537524, 'recall': 0.4570512514912595, 'f1-score': 0.4156124551620344, 'support': 41323}, 'weighted avg': {'precision': 0.4870597613711765, 'recall': 0.42600972823851124, 'f1-score': 0.40197119618902466, 'support': 41323}}
[[6682 1094 3843]
 [6615 3415 7091]
 [4029 1047 7507]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.050953
{'0': {'precision': 0.4379979932715576, 'recall': 0.5302608074312254, 'f1-score': 0.4797336608701273, 'support': 13995}, '1': {'precision': 0.4822589634033067, 'recall': 0.20954072160787796, 'f1-score': 0.29214494710781, 'support': 12389}, '2': {'precision': 0.4585987261146497, 'recall': 0.5831715643617378, 'f1-score': 0.5134370579915135, 'support': 14939}, 'accuracy': 0.45323427631101326, 'macro avg': {'precision': 0.459618560929838, 'recall': 0.44099103113361365, 'f1-score': 0.4284385553231503, 'support': 41323}, 'weighted avg': {'precision': 0.4587153542304713, 'recall': 0.45323427631101326, 'f1-score': 0.43567728729596855, 'support': 41323}}
[[7421 1407 5167]
 [4675 2596 5118]
 [4847 1380 8712]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0605335
{'0': {'precision': 0.4354539839407041, 'recall': 0.49200921208737525, 'f1-score': 0.4620072741570825, 'support': 14329}, '1': {'precision': 0.43672600619195046, 'recall': 0.18939330368381305, 'f1-score': 0.26420836991513025, 'support': 11917}, '2': {'precision': 0.4492862509391435, 'recall': 0.5949459441533461, 'f1-score': 0.5119570800753381, 'support': 15077}, 'accuracy': 0.4422960578854391, 'macro avg': {'precision': 0.4404887470239327, 'recall': 0.4254494866415115, 'f1-score': 0.41272424138251695, 'support': 41323}, 'weighted avg': {'precision': 0.4408676223189335, 'recall': 0.4422960578854391, 'f1-score': 0.42318927163979664, 'support': 41323}}
[[7050 1488 5791]
 [4456 2257 5204]
 [4684 1423 8970]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0772712
{'0': {'precision': 0.4241812618008985, 'recall': 0.4509586765418426, 'f1-score': 0.4371603032946386, 'support': 14447}, '1': {'precision': 0.3842611133360032, 'recall': 0.15963730138923551, 'f1-score': 0.22556567734352043, 'support': 12021}, '2': {'precision': 0.42350977587029087, 'recall': 0.5978458431504544, 'f1-score': 0.4957990230286113, 'support': 14855}, 'accuracy': 0.4190160443336641, 'macro avg': {'precision': 0.41065071700239747, 'recall': 0.4028139403605109, 'f1-score': 0.38617500122225673, 'support': 41323}, 'weighted avg': {'precision': 0.4123269668998583, 'recall': 0.4190160443336641, 'f1-score': 0.39668645539128633, 'support': 41323}}
[[6515 1560 6372]
 [4385 1919 5717]
 [4459 1515 8881]]
training model: results/XRAY/W5/deepOF_L1/seq2seq
Epoch 1/50
483/483 - 18s - loss: 13.0393 - accuracy10: 0.4261 - accuracy20: 0.4109 - accuracy30: 0.4013 - accuracy50: 0.3853 - val_loss: 13.1133 - val_accuracy10: 0.4346 - val_accuracy20: 0.3948 - val_accuracy30: 0.3819 - val_accuracy50: 0.3722 - 18s/epoch - 38ms/step
Epoch 2/50
483/483 - 13s - loss: 12.9308 - accuracy10: 0.4393 - accuracy20: 0.4199 - accuracy30: 0.4097 - accuracy50: 0.3918 - val_loss: 13.0724 - val_accuracy10: 0.4337 - val_accuracy20: 0.4004 - val_accuracy30: 0.3908 - val_accuracy50: 0.3830 - 13s/epoch - 27ms/step
Epoch 3/50
483/483 - 12s - loss: 12.8968 - accuracy10: 0.4443 - accuracy20: 0.4215 - accuracy30: 0.4111 - accuracy50: 0.3943 - val_loss: 13.0605 - val_accuracy10: 0.4324 - val_accuracy20: 0.4026 - val_accuracy30: 0.3963 - val_accuracy50: 0.3880 - 12s/epoch - 25ms/step
Epoch 4/50
483/483 - 13s - loss: 12.8778 - accuracy10: 0.4450 - accuracy20: 0.4252 - accuracy30: 0.4139 - accuracy50: 0.3953 - val_loss: 13.0573 - val_accuracy10: 0.4327 - val_accuracy20: 0.4035 - val_accuracy30: 0.3961 - val_accuracy50: 0.3878 - 13s/epoch - 27ms/step
Epoch 5/50
483/483 - 12s - loss: 12.8604 - accuracy10: 0.4466 - accuracy20: 0.4271 - accuracy30: 0.4153 - accuracy50: 0.3977 - val_loss: 13.0444 - val_accuracy10: 0.4311 - val_accuracy20: 0.4067 - val_accuracy30: 0.3973 - val_accuracy50: 0.3889 - 12s/epoch - 26ms/step
Epoch 6/50
483/483 - 12s - loss: 12.8408 - accuracy10: 0.4488 - accuracy20: 0.4276 - accuracy30: 0.4175 - accuracy50: 0.3997 - val_loss: 13.0476 - val_accuracy10: 0.4330 - val_accuracy20: 0.4050 - val_accuracy30: 0.3959 - val_accuracy50: 0.3878 - 12s/epoch - 26ms/step
Epoch 7/50
483/483 - 12s - loss: 12.8260 - accuracy10: 0.4498 - accuracy20: 0.4306 - accuracy30: 0.4195 - accuracy50: 0.4012 - val_loss: 13.0411 - val_accuracy10: 0.4329 - val_accuracy20: 0.4051 - val_accuracy30: 0.3984 - val_accuracy50: 0.3885 - 12s/epoch - 26ms/step
Epoch 8/50
483/483 - 12s - loss: 12.8125 - accuracy10: 0.4495 - accuracy20: 0.4313 - accuracy30: 0.4205 - accuracy50: 0.4022 - val_loss: 13.0350 - val_accuracy10: 0.4293 - val_accuracy20: 0.4055 - val_accuracy30: 0.3983 - val_accuracy50: 0.3893 - 12s/epoch - 25ms/step
Epoch 9/50
483/483 - 12s - loss: 12.8014 - accuracy10: 0.4511 - accuracy20: 0.4328 - accuracy30: 0.4210 - accuracy50: 0.4024 - val_loss: 13.0379 - val_accuracy10: 0.4291 - val_accuracy20: 0.4070 - val_accuracy30: 0.3985 - val_accuracy50: 0.3924 - 12s/epoch - 26ms/step
Epoch 10/50
483/483 - 12s - loss: 12.7848 - accuracy10: 0.4529 - accuracy20: 0.4353 - accuracy30: 0.4230 - accuracy50: 0.4044 - val_loss: 13.0221 - val_accuracy10: 0.4295 - val_accuracy20: 0.4086 - val_accuracy30: 0.4007 - val_accuracy50: 0.3937 - 12s/epoch - 26ms/step
Epoch 11/50
483/483 - 13s - loss: 12.7734 - accuracy10: 0.4527 - accuracy20: 0.4355 - accuracy30: 0.4236 - accuracy50: 0.4056 - val_loss: 13.0159 - val_accuracy10: 0.4308 - val_accuracy20: 0.4082 - val_accuracy30: 0.4023 - val_accuracy50: 0.3923 - 13s/epoch - 27ms/step
Epoch 12/50
483/483 - 12s - loss: 12.7546 - accuracy10: 0.4557 - accuracy20: 0.4381 - accuracy30: 0.4267 - accuracy50: 0.4086 - val_loss: 13.0279 - val_accuracy10: 0.4287 - val_accuracy20: 0.4089 - val_accuracy30: 0.3985 - val_accuracy50: 0.3884 - 12s/epoch - 26ms/step
Epoch 13/50
483/483 - 13s - loss: 12.7420 - accuracy10: 0.4569 - accuracy20: 0.4397 - accuracy30: 0.4274 - accuracy50: 0.4089 - val_loss: 13.0148 - val_accuracy10: 0.4344 - val_accuracy20: 0.4110 - val_accuracy30: 0.4017 - val_accuracy50: 0.3937 - 13s/epoch - 26ms/step
Epoch 14/50
483/483 - 12s - loss: 12.7267 - accuracy10: 0.4580 - accuracy20: 0.4413 - accuracy30: 0.4299 - accuracy50: 0.4105 - val_loss: 13.0126 - val_accuracy10: 0.4278 - val_accuracy20: 0.4118 - val_accuracy30: 0.4027 - val_accuracy50: 0.3911 - 12s/epoch - 25ms/step
Epoch 15/50
483/483 - 13s - loss: 12.7136 - accuracy10: 0.4582 - accuracy20: 0.4433 - accuracy30: 0.4307 - accuracy50: 0.4125 - val_loss: 13.0174 - val_accuracy10: 0.4286 - val_accuracy20: 0.4125 - val_accuracy30: 0.4018 - val_accuracy50: 0.3910 - 13s/epoch - 26ms/step
Epoch 16/50
483/483 - 12s - loss: 12.7033 - accuracy10: 0.4585 - accuracy20: 0.4434 - accuracy30: 0.4307 - accuracy50: 0.4123 - val_loss: 13.0099 - val_accuracy10: 0.4286 - val_accuracy20: 0.4114 - val_accuracy30: 0.4046 - val_accuracy50: 0.3935 - 12s/epoch - 26ms/step
Epoch 17/50
483/483 - 12s - loss: 12.6905 - accuracy10: 0.4576 - accuracy20: 0.4427 - accuracy30: 0.4314 - accuracy50: 0.4138 - val_loss: 13.0171 - val_accuracy10: 0.4239 - val_accuracy20: 0.4104 - val_accuracy30: 0.4028 - val_accuracy50: 0.3920 - 12s/epoch - 25ms/step
Epoch 18/50
483/483 - 12s - loss: 12.6762 - accuracy10: 0.4594 - accuracy20: 0.4444 - accuracy30: 0.4341 - accuracy50: 0.4161 - val_loss: 13.0810 - val_accuracy10: 0.4319 - val_accuracy20: 0.3997 - val_accuracy30: 0.3841 - val_accuracy50: 0.3708 - 12s/epoch - 26ms/step
Epoch 19/50
483/483 - 12s - loss: 12.6635 - accuracy10: 0.4619 - accuracy20: 0.4472 - accuracy30: 0.4361 - accuracy50: 0.4170 - val_loss: 13.0258 - val_accuracy10: 0.4288 - val_accuracy20: 0.4101 - val_accuracy30: 0.4000 - val_accuracy50: 0.3870 - 12s/epoch - 25ms/step
Epoch 20/50
483/483 - 12s - loss: 12.6530 - accuracy10: 0.4626 - accuracy20: 0.4493 - accuracy30: 0.4375 - accuracy50: 0.4178 - val_loss: 13.0254 - val_accuracy10: 0.4274 - val_accuracy20: 0.4092 - val_accuracy30: 0.4006 - val_accuracy50: 0.3875 - 12s/epoch - 26ms/step
Epoch 21/50
483/483 - 12s - loss: 12.6425 - accuracy10: 0.4622 - accuracy20: 0.4484 - accuracy30: 0.4375 - accuracy50: 0.4198 - val_loss: 13.0319 - val_accuracy10: 0.4284 - val_accuracy20: 0.4068 - val_accuracy30: 0.3990 - val_accuracy50: 0.3850 - 12s/epoch - 26ms/step
Epoch 22/50
483/483 - 13s - loss: 12.6204 - accuracy10: 0.4646 - accuracy20: 0.4507 - accuracy30: 0.4407 - accuracy50: 0.4220 - val_loss: 13.0935 - val_accuracy10: 0.4342 - val_accuracy20: 0.3989 - val_accuracy30: 0.3801 - val_accuracy50: 0.3666 - 13s/epoch - 26ms/step
Epoch 23/50
483/483 - 13s - loss: 12.6131 - accuracy10: 0.4636 - accuracy20: 0.4513 - accuracy30: 0.4412 - accuracy50: 0.4217 - val_loss: 13.0318 - val_accuracy10: 0.4233 - val_accuracy20: 0.4091 - val_accuracy30: 0.3980 - val_accuracy50: 0.3861 - 13s/epoch - 27ms/step
Epoch 24/50
483/483 - 12s - loss: 12.5949 - accuracy10: 0.4649 - accuracy20: 0.4527 - accuracy30: 0.4424 - accuracy50: 0.4244 - val_loss: 13.0740 - val_accuracy10: 0.4283 - val_accuracy20: 0.4063 - val_accuracy30: 0.3920 - val_accuracy50: 0.3767 - 12s/epoch - 25ms/step
Epoch 25/50
483/483 - 13s - loss: 12.5832 - accuracy10: 0.4659 - accuracy20: 0.4547 - accuracy30: 0.4443 - accuracy50: 0.4255 - val_loss: 13.0620 - val_accuracy10: 0.4218 - val_accuracy20: 0.4081 - val_accuracy30: 0.3967 - val_accuracy50: 0.3849 - 13s/epoch - 26ms/step
Epoch 26/50
483/483 - 13s - loss: 12.5704 - accuracy10: 0.4663 - accuracy20: 0.4558 - accuracy30: 0.4455 - accuracy50: 0.4269 - val_loss: 13.0750 - val_accuracy10: 0.4189 - val_accuracy20: 0.4076 - val_accuracy30: 0.3970 - val_accuracy50: 0.3819 - 13s/epoch - 26ms/step
testing model: results/XRAY/W5/deepOF_L1/seq2seq
Evaluating performance on  test set...
2341/2341 - 27s - 27s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0639694
{'0': {'precision': 0.3805771257586587, 'recall': 0.36439400090473595, 'f1-score': 0.3723097890495378, 'support': 172426}, '1': {'precision': 0.5133931230482544, 'recall': 0.47496674040194914, 'f1-score': 0.49343294323544085, 'support': 254062}, '2': {'precision': 0.3785816870712772, 'recall': 0.4363099716418774, 'f1-score': 0.40540104536361876, 'support': 172790}, 'accuracy': 0.43200651450578864, 'macro avg': {'precision': 0.42418397862606344, 'recall': 0.4252235709828542, 'f1-score': 0.4237145925495325, 'support': 599278}, 'weighted avg': {'precision': 0.4363086995067299, 'recall': 0.43200651450578864, 'f1-score': 0.4332007761661831, 'support': 599278}}
[[ 62831  59769  49826]
 [ 59469 120671  73922]
 [ 42794  54606  75390]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.076414
{'0': {'precision': 0.4326607810934359, 'recall': 0.35340581640312857, 'f1-score': 0.3890378679234218, 'support': 206485}, '1': {'precision': 0.3782032235700414, 'recall': 0.47074619185953026, 'f1-score': 0.4194307081406205, 'support': 186574}, '2': {'precision': 0.43078784212913956, 'recall': 0.4144331996566757, 'f1-score': 0.4224522934487369, 'support': 206219}, 'accuracy': 0.41093782852031946, 'macro avg': {'precision': 0.4138839489308723, 'recall': 0.4128617359731115, 'f1-score': 0.4103069565042598, 'support': 599278}, 'weighted avg': {'precision': 0.4150619372552706, 'recall': 0.41093782852031946, 'f1-score': 0.40999842911219997, 'support': 599278}}
[[72973 74491 59021]
 [44840 87829 53905]
 [50848 69907 85464]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.082108
{'0': {'precision': 0.4395267735968986, 'recall': 0.3585442417108103, 'f1-score': 0.3949267439317735, 'support': 214074}, '1': {'precision': 0.3351524225484377, 'recall': 0.4412421635806969, 'f1-score': 0.3809490243662976, 'support': 171475}, '2': {'precision': 0.4390400868808857, 'recall': 0.4085641162406599, 'f1-score': 0.4232542132993393, 'support': 213729}, 'accuracy': 0.4000463891549498, 'macro avg': {'precision': 0.404573094342074, 'recall': 0.40278350717738903, 'f1-score': 0.39970999386580347, 'support': 599278}, 'weighted avg': {'precision': 0.4094879420176289, 'recall': 0.4000463891549498, 'f1-score': 0.4010300419636894, 'support': 599278}}
[[76755 77107 60212]
 [44454 75662 51359]
 [53422 72985 87322]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0859019
{'0': {'precision': 0.42674841103439193, 'recall': 0.3698765032729487, 'f1-score': 0.39628238388183545, 'support': 210208}, '1': {'precision': 0.32598091493327647, 'recall': 0.39345097183279887, 'f1-score': 0.3565521910794753, 'support': 178683}, '2': {'precision': 0.42804515981689817, 'recall': 0.40979718328603953, 'f1-score': 0.41872245358847027, 'support': 210387}, 'accuracy': 0.39092040755709373, 'macro avg': {'precision': 0.3935914952615222, 'recall': 0.3910415527972623, 'f1-score': 0.39051900951659374, 'support': 599278}, 'weighted avg': {'precision': 0.3971584387348407, 'recall': 0.39092040755709373, 'f1-score': 0.39231425707735684, 'support': 599278}}
[[77751 74183 58274]
 [51452 70303 56928]
 [52991 71180 86216]]
Evaluating performance on  train set...
483/483 - 6s - 6s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0390834
{'0': {'precision': 0.40329620220181095, 'recall': 0.3742255266418835, 'f1-score': 0.38821740425465207, 'support': 33087}, '1': {'precision': 0.5646954117669337, 'recall': 0.5268262520978713, 'f1-score': 0.5451039172317985, 'support': 56605}, '2': {'precision': 0.3879342687776694, 'recall': 0.4588757396449704, 'f1-score': 0.4204334449248452, 'support': 33800}, 'accuracy': 0.4673420140575908, 'macro avg': {'precision': 0.45197529424880467, 'recall': 0.4533091727949084, 'f1-score': 0.4512515888037653, 'support': 123492}, 'weighted avg': {'precision': 0.473072130259481, 'recall': 0.4673420140575908, 'f1-score': 0.4689470324226621, 'support': 123492}}
[[12382 11537  9168]
 [11481 29821 15303]
 [ 6839 11451 15510]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0575951
{'0': {'precision': 0.45168667810177243, 'recall': 0.35534009695636964, 'f1-score': 0.39776223776223774, 'support': 40018}, '1': {'precision': 0.43213441339482966, 'recall': 0.522139227761257, 'f1-score': 0.472892300840853, 'support': 42707}, '2': {'precision': 0.4401108691348248, 'recall': 0.4362351902273898, 'f1-score': 0.43816445950107796, 'support': 40767}, 'accuracy': 0.4397288893207657, 'macro avg': {'precision': 0.44131065354380894, 'recall': 0.4379048383150055, 'f1-score': 0.43627299936805625, 'support': 123492}, 'weighted avg': {'precision': 0.44110356686383834, 'recall': 0.4397288893207657, 'f1-score': 0.4370818453281182, 'support': 123492}}
[[14220 14843 10955]
 [ 8739 22299 11669]
 [ 8523 14460 17784]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0668062
{'0': {'precision': 0.4455351391146968, 'recall': 0.3548324049643311, 'f1-score': 0.3950442670438319, 'support': 40932}, '1': {'precision': 0.40426690326873826, 'recall': 0.48513006654567453, 'f1-score': 0.44102248229134583, 'support': 41325}, '2': {'precision': 0.4372911723403225, 'recall': 0.43800169758700136, 'f1-score': 0.4376461465766868, 'support': 41235}, 'accuracy': 0.4262057461212062, 'macro avg': {'precision': 0.4290310715745858, 'recall': 0.425988056365669, 'f1-score': 0.42457096530395483, 'support': 123492}, 'weighted avg': {'precision': 0.4289725292591955, 'recall': 0.4262057461212062, 'f1-score': 0.4246554017541029, 'support': 123492}}
[[14524 15226 11182]
 [ 9218 20048 12059]
 [ 8857 14317 18061]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0764589
{'0': {'precision': 0.4327622623797231, 'recall': 0.3557441882897656, 'f1-score': 0.3904918206363492, 'support': 41468}, '1': {'precision': 0.37342304457527337, 'recall': 0.4260092995793047, 'f1-score': 0.39798662345721575, 'support': 40647}, '2': {'precision': 0.42490646712987706, 'recall': 0.44191217342968314, 'f1-score': 0.4332425068119891, 'support': 41377}, 'accuracy': 0.40774301169306515, 'macro avg': {'precision': 0.4103639246949578, 'recall': 0.40788855376625116, 'f1-score': 0.407240316968518, 'support': 123492}, 'weighted avg': {'precision': 0.4105987989476761, 'recall': 0.40774301169306515, 'f1-score': 0.40728267666061974, 'support': 123492}}
[[14752 15158 11558]
 [10141 17316 13190]
 [ 9195 13897 18285]]
Evaluating performance on  val set...
162/162 - 2s - 2s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0661589
{'0': {'precision': 0.3739308624376336, 'recall': 0.3618103448275862, 'f1-score': 0.36777076761303895, 'support': 11600}, '1': {'precision': 0.5071876633559854, 'recall': 0.4537589150005846, 'f1-score': 0.47898796667695154, 'support': 17106}, '2': {'precision': 0.3896586684690774, 'recall': 0.4569231988586827, 'f1-score': 0.42061870713556104, 'support': 12617}, 'accuracy': 0.42891368003291147, 'macro avg': {'precision': 0.4235923980875655, 'recall': 0.4241641528956179, 'f1-score': 0.42245914714185046, 'support': 41323}, 'weighted avg': {'precision': 0.43389573829872924, 'recall': 0.42891368003291147, 'f1-score': 0.4299459209209534, 'support': 41323}}
[[4197 3698 3705]
 [4019 7762 5325]
 [3008 3844 5765]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0762017
{'0': {'precision': 0.4220167480809491, 'recall': 0.34626395648439734, 'f1-score': 0.3804057241704671, 'support': 13972}, '1': {'precision': 0.3695885270071036, 'recall': 0.44479393499475767, 'f1-score': 0.4037187511438088, 'support': 12399}, '2': {'precision': 0.4408515766218116, 'recall': 0.44040930979133225, 'f1-score': 0.4406303322292482, 'support': 14952}, 'accuracy': 0.40989279577959004, 'macro avg': {'precision': 0.4108189505699548, 'recall': 0.4104890670901624, 'f1-score': 0.408251602514508, 'support': 41323}, 'weighted avg': {'precision': 0.4131006684944806, 'recall': 0.40989279577959004, 'f1-score': 0.4091920310972961, 'support': 41323}}
[[4838 4620 4514]
 [3046 5515 3838]
 [3580 4787 6585]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.08037
{'0': {'precision': 0.4261046216353479, 'recall': 0.3516590988473629, 'f1-score': 0.38531899422098054, 'support': 14315}, '1': {'precision': 0.3391109868604976, 'recall': 0.4076625777180306, 'f1-score': 0.3702403662724151, 'support': 11902}, '2': {'precision': 0.4444444444444444, 'recall': 0.4472395074804713, 'f1-score': 0.4458375952750189, 'support': 15106}, 'accuracy': 0.4027297146867362, 'macro avg': {'precision': 0.4032200176467633, 'recall': 0.4021870613486216, 'f1-score': 0.40046565192280487, 'support': 41323}, 'weighted avg': {'precision': 0.40775268983620316, 'recall': 0.4027297146867362, 'f1-score': 0.40309912048670377, 'support': 41323}}
[[5034 4768 4513]
 [3118 4852 3932]
 [3662 4688 6756]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0850319
{'0': {'precision': 0.41798985103944997, 'recall': 0.3548252622802751, 'f1-score': 0.38382623727030174, 'support': 14393}, '1': {'precision': 0.31773691235355184, 'recall': 0.3545131132621825, 'f1-score': 0.3351190708950847, 'support': 12087}, '2': {'precision': 0.4335744926051604, 'recall': 0.45624199959576905, 'f1-score': 0.4446195259667783, 'support': 14843}, 'accuracy': 0.3911623067057087, 'macro avg': {'precision': 0.3897670853327207, 'recall': 0.3885267917127422, 'f1-score': 0.38785494471072157, 'support': 41323}, 'weighted avg': {'precision': 0.39426373156272726, 'recall': 0.3911623067057087, 'f1-score': 0.3914159878727399, 'support': 41323}}
[[5107 4739 4547]
 [3502 4285 4300]
 [3609 4462 6772]]
training model: results/XRAY/W5/deepLOB_L2/seq2seq
Epoch 1/50
483/483 - 31s - loss: 13.0952 - accuracy10: 0.3981 - accuracy20: 0.3891 - accuracy30: 0.3879 - accuracy50: 0.3773 - val_loss: 13.9159 - val_accuracy10: 0.3766 - val_accuracy20: 0.3684 - val_accuracy30: 0.3645 - val_accuracy50: 0.3568 - 31s/epoch - 64ms/step
Epoch 2/50
483/483 - 25s - loss: 12.8547 - accuracy10: 0.4077 - accuracy20: 0.4167 - accuracy30: 0.4115 - accuracy50: 0.3967 - val_loss: 13.1706 - val_accuracy10: 0.3867 - val_accuracy20: 0.4023 - val_accuracy30: 0.3981 - val_accuracy50: 0.3855 - 25s/epoch - 52ms/step
Epoch 3/50
483/483 - 25s - loss: 12.7083 - accuracy10: 0.4313 - accuracy20: 0.4358 - accuracy30: 0.4268 - accuracy50: 0.4068 - val_loss: 12.8256 - val_accuracy10: 0.4054 - val_accuracy20: 0.4288 - val_accuracy30: 0.4259 - val_accuracy50: 0.4081 - 25s/epoch - 52ms/step
Epoch 4/50
483/483 - 25s - loss: 12.5971 - accuracy10: 0.4487 - accuracy20: 0.4493 - accuracy30: 0.4382 - accuracy50: 0.4150 - val_loss: 12.7647 - val_accuracy10: 0.4108 - val_accuracy20: 0.4421 - val_accuracy30: 0.4360 - val_accuracy50: 0.4181 - 25s/epoch - 52ms/step
Epoch 5/50
483/483 - 25s - loss: 12.4899 - accuracy10: 0.4648 - accuracy20: 0.4613 - accuracy30: 0.4473 - accuracy50: 0.4226 - val_loss: 12.7205 - val_accuracy10: 0.4158 - val_accuracy20: 0.4478 - val_accuracy30: 0.4415 - val_accuracy50: 0.4214 - 25s/epoch - 52ms/step
Epoch 6/50
483/483 - 25s - loss: 12.4048 - accuracy10: 0.4772 - accuracy20: 0.4710 - accuracy30: 0.4556 - accuracy50: 0.4302 - val_loss: 12.7530 - val_accuracy10: 0.4139 - val_accuracy20: 0.4483 - val_accuracy30: 0.4408 - val_accuracy50: 0.4214 - 25s/epoch - 52ms/step
Epoch 7/50
483/483 - 25s - loss: 12.3377 - accuracy10: 0.4848 - accuracy20: 0.4772 - accuracy30: 0.4616 - accuracy50: 0.4345 - val_loss: 12.7261 - val_accuracy10: 0.4212 - val_accuracy20: 0.4502 - val_accuracy30: 0.4419 - val_accuracy50: 0.4196 - 25s/epoch - 52ms/step
Epoch 8/50
483/483 - 25s - loss: 12.2983 - accuracy10: 0.4881 - accuracy20: 0.4812 - accuracy30: 0.4631 - accuracy50: 0.4365 - val_loss: 12.6786 - val_accuracy10: 0.4300 - val_accuracy20: 0.4534 - val_accuracy30: 0.4449 - val_accuracy50: 0.4208 - 25s/epoch - 52ms/step
Epoch 9/50
483/483 - 25s - loss: 12.2470 - accuracy10: 0.4928 - accuracy20: 0.4845 - accuracy30: 0.4675 - accuracy50: 0.4393 - val_loss: 12.7176 - val_accuracy10: 0.4208 - val_accuracy20: 0.4495 - val_accuracy30: 0.4430 - val_accuracy50: 0.4216 - 25s/epoch - 52ms/step
Epoch 10/50
483/483 - 25s - loss: 12.2086 - accuracy10: 0.4970 - accuracy20: 0.4887 - accuracy30: 0.4717 - accuracy50: 0.4435 - val_loss: 12.7398 - val_accuracy10: 0.4243 - val_accuracy20: 0.4513 - val_accuracy30: 0.4430 - val_accuracy50: 0.4208 - 25s/epoch - 52ms/step
Epoch 11/50
483/483 - 25s - loss: 12.1625 - accuracy10: 0.4984 - accuracy20: 0.4934 - accuracy30: 0.4750 - accuracy50: 0.4473 - val_loss: 12.7392 - val_accuracy10: 0.4414 - val_accuracy20: 0.4528 - val_accuracy30: 0.4442 - val_accuracy50: 0.4190 - 25s/epoch - 52ms/step
Epoch 12/50
483/483 - 25s - loss: 12.1227 - accuracy10: 0.5029 - accuracy20: 0.4960 - accuracy30: 0.4793 - accuracy50: 0.4513 - val_loss: 12.7595 - val_accuracy10: 0.4339 - val_accuracy20: 0.4515 - val_accuracy30: 0.4435 - val_accuracy50: 0.4194 - 25s/epoch - 52ms/step
Epoch 13/50
483/483 - 25s - loss: 12.0759 - accuracy10: 0.5050 - accuracy20: 0.4990 - accuracy30: 0.4817 - accuracy50: 0.4543 - val_loss: 12.7819 - val_accuracy10: 0.4411 - val_accuracy20: 0.4522 - val_accuracy30: 0.4429 - val_accuracy50: 0.4187 - 25s/epoch - 52ms/step
Epoch 14/50
483/483 - 25s - loss: 12.0343 - accuracy10: 0.5071 - accuracy20: 0.5026 - accuracy30: 0.4854 - accuracy50: 0.4567 - val_loss: 12.8445 - val_accuracy10: 0.4312 - val_accuracy20: 0.4508 - val_accuracy30: 0.4425 - val_accuracy50: 0.4180 - 25s/epoch - 52ms/step
Epoch 15/50
483/483 - 25s - loss: 12.0165 - accuracy10: 0.5086 - accuracy20: 0.5047 - accuracy30: 0.4880 - accuracy50: 0.4591 - val_loss: 12.8361 - val_accuracy10: 0.4264 - val_accuracy20: 0.4471 - val_accuracy30: 0.4372 - val_accuracy50: 0.4145 - 25s/epoch - 51ms/step
Epoch 16/50
483/483 - 25s - loss: 11.9612 - accuracy10: 0.5105 - accuracy20: 0.5090 - accuracy30: 0.4929 - accuracy50: 0.4642 - val_loss: 12.8133 - val_accuracy10: 0.4382 - val_accuracy20: 0.4495 - val_accuracy30: 0.4388 - val_accuracy50: 0.4153 - 25s/epoch - 52ms/step
Epoch 17/50
483/483 - 25s - loss: 11.9360 - accuracy10: 0.5120 - accuracy20: 0.5103 - accuracy30: 0.4929 - accuracy50: 0.4645 - val_loss: 12.9647 - val_accuracy10: 0.4382 - val_accuracy20: 0.4469 - val_accuracy30: 0.4350 - val_accuracy50: 0.4103 - 25s/epoch - 52ms/step
Epoch 18/50
483/483 - 25s - loss: 11.9113 - accuracy10: 0.5129 - accuracy20: 0.5116 - accuracy30: 0.4960 - accuracy50: 0.4662 - val_loss: 12.8966 - val_accuracy10: 0.4379 - val_accuracy20: 0.4491 - val_accuracy30: 0.4373 - val_accuracy50: 0.4134 - 25s/epoch - 52ms/step
testing model: results/XRAY/W5/deepLOB_L2/seq2seq
Evaluating performance on  test set...
2341/2341 - 48s - 48s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0426849
{'0': {'precision': 0.4220214115604621, 'recall': 0.43985640466510856, 'f1-score': 0.43075437674821454, 'support': 172429}, '1': {'precision': 0.5717041869190757, 'recall': 0.42221977312624476, 'f1-score': 0.4857208836887075, 'support': 254062}, '2': {'precision': 0.402298057645461, 'recall': 0.5399960646326218, 'f1-score': 0.46108611483790307, 'support': 172792}, 'accuracy': 0.4612528638389542, 'macro avg': {'precision': 0.46534121870833295, 'recall': 0.46735741414132503, 'f1-score': 0.45918712509160836, 'support': 599283}, 'weighted avg': {'precision': 0.4797915593929206, 'recall': 0.4612528638389542, 'f1-score': 0.4628026450526867, 'support': 599283}}
[[ 75844  43333  53252]
 [ 61416 107270  85376]
 [ 42456  37029  93307]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0616317
{'0': {'precision': 0.4649865491574656, 'recall': 0.4093312928596335, 'f1-score': 0.43538753570407535, 'support': 206488}, '1': {'precision': 0.43458208939252885, 'recall': 0.43535540857782973, 'f1-score': 0.4349684052693585, 'support': 186574}, '2': {'precision': 0.4479757506374564, 'recall': 0.5009431629174527, 'f1-score': 0.4729811709494649, 'support': 206221}, 'accuracy': 0.44895817168182645, 'macro avg': {'precision': 0.4491814630624836, 'recall': 0.4485432881183053, 'f1-score': 0.4477790373076329, 'support': 599283}, 'weighted avg': {'precision': 0.4496671331924238, 'recall': 0.44895817168182645, 'f1-score': 0.44819350252144313, 'support': 599283}}
[[ 84522  55981  65985]
 [ 44034  81226  61314]
 [ 53217  49699 103305]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0738548
{'0': {'precision': 0.4621921121068063, 'recall': 0.3910228562619992, 'f1-score': 0.4236392621270781, 'support': 214077}, '1': {'precision': 0.38536189789687925, 'recall': 0.42400933080624, 'f1-score': 0.40376290792370895, 'support': 171475}, '2': {'precision': 0.44782089604266706, 'recall': 0.48085677791242265, 'f1-score': 0.4637512437137462, 'support': 213731}, 'accuracy': 0.4325001710377234, 'macro avg': {'precision': 0.43179163534878423, 'recall': 0.43196298832688723, 'f1-score': 0.4303844712548444, 'support': 599283}, 'weighted avg': {'precision': 0.4350829911034543, 'recall': 0.4325001710377234, 'f1-score': 0.43225768797843284, 'support': 599283}}
[[ 83709  60959  69409]
 [ 41453  72707  57315]
 [ 55951  55006 102774]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0885317
{'0': {'precision': 0.431845677807822, 'recall': 0.3684773870063888, 'f1-score': 0.39765283282337727, 'support': 210211}, '1': {'precision': 0.3605830625317954, 'recall': 0.38874431255351655, 'f1-score': 0.374134508955863, 'support': 178683}, '2': {'precision': 0.4236096444913763, 'recall': 0.4576189819809971, 'f1-score': 0.4399580504902106, 'support': 210389}, 'accuracy': 0.40581494886389236, 'macro avg': {'precision': 0.4053461282769979, 'recall': 0.4049468938469675, 'f1-score': 0.4039151307564836, 'support': 599283}, 'weighted avg': {'precision': 0.40770651701270527, 'recall': 0.40581494886389236, 'f1-score': 0.4054925809492015, 'support': 599283}}
[[77458 63895 68858]
 [47077 69462 62144]
 [54830 59281 96278]]
Evaluating performance on  train set...
483/483 - 10s - 10s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0179554
{'0': {'precision': 0.4348048048048048, 'recall': 0.43715467528154345, 'f1-score': 0.4359765736739887, 'support': 33121}, '1': {'precision': 0.6412182238362496, 'recall': 0.4126228202177569, 'f1-score': 0.5021274762207405, 'support': 56485}, '2': {'precision': 0.3878240843919471, 'recall': 0.6162426960986839, 'f1-score': 0.4760515217143509, 'support': 33886}, 'accuracy': 0.4750753085220095, 'macro avg': {'precision': 0.4879490376776672, 'recall': 0.48867339719932806, 'f1-score': 0.47138519053636, 'support': 123492}, 'weighted avg': {'precision': 0.5163264684112008, 'recall': 0.4750753085220095, 'f1-score': 0.4772303667913484, 'support': 123492}}
[[14479  7099 11543]
 [11759 23307 21419]
 [ 7062  5942 20882]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0251219
{'0': {'precision': 0.47784724922966465, 'recall': 0.4000050085144746, 'f1-score': 0.4354748565274882, 'support': 39932}, '1': {'precision': 0.5143866874443455, 'recall': 0.43273169932345434, 'f1-score': 0.4700392864862115, 'support': 42717}, '2': {'precision': 0.4406695117219975, 'recall': 0.5840168449917978, 'f1-score': 0.5023164722233922, 'support': 40843}, 'accuracy': 0.47218443299970847, 'macro avg': {'precision': 0.47763448279866916, 'recall': 0.4722511842765756, 'f1-score': 0.46927687174569727, 'support': 123492}, 'weighted avg': {'precision': 0.47819063057575084, 'recall': 0.47218443299970847, 'f1-score': 0.4695377987781164, 'support': 123492}}
[[15973  9416 14543]
 [ 8499 18485 15733]
 [ 8955  8035 23853]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.038343
{'0': {'precision': 0.4676612417118746, 'recall': 0.3795372272771744, 'f1-score': 0.41901598617411967, 'support': 40884}, '1': {'precision': 0.4831730769230769, 'recall': 0.4173850054328142, 'f1-score': 0.4478760477257711, 'support': 41415}, '2': {'precision': 0.43290670382866364, 'recall': 0.573131357269439, 'f1-score': 0.49324656060336997, 'support': 41193}, 'accuracy': 0.45680691866679624, 'macro avg': {'precision': 0.4612470074878717, 'recall': 0.4566845299931425, 'f1-score': 0.4533795315010869, 'support': 123492}, 'weighted avg': {'precision': 0.4612703740949345, 'recall': 0.45680691866679624, 'f1-score': 0.45345562195316413, 'support': 123492}}
[[15517 10013 15354]
 [ 8556 17286 15573]
 [ 9107  8477 23609]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0602185
{'0': {'precision': 0.441436767578125, 'recall': 0.3485626159666498, 'f1-score': 0.38954044191902193, 'support': 41499}, '1': {'precision': 0.4379000922483437, 'recall': 0.38524912694899416, 'f1-score': 0.40989075685222737, 'support': 40662}, '2': {'precision': 0.4152062746810795, 'recall': 0.552031163049527, 'f1-score': 0.4739411312602564, 'support': 41331}, 'accuracy': 0.4287403232598063, 'macro avg': {'precision': 0.43151437816918276, 'recall': 0.42861430198839034, 'f1-score': 0.42445744334383523, 'support': 123492}, 'weighted avg': {'precision': 0.43149328302700146, 'recall': 0.4287403232598063, 'f1-score': 0.42448885474719344, 'support': 123492}}
[[14465 10889 16145]
 [ 9007 15665 15990]
 [ 9296  9219 22816]]
Evaluating performance on  val set...
162/162 - 3s - 3s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0749052
{'0': {'precision': 0.4021301951437509, 'recall': 0.46466993717187366, 'f1-score': 0.43114394090636854, 'support': 11619}, '1': {'precision': 0.6176383105294467, 'recall': 0.24256760703229951, 'f1-score': 0.3483329838540574, 'support': 17121}, '2': {'precision': 0.38610494497709347, 'recall': 0.6496860843995867, 'f1-score': 0.48435833629576963, 'support': 12583}, 'accuracy': 0.42898627882777146, 'macro avg': {'precision': 0.468624483550097, 'recall': 0.4523078762012533, 'f1-score': 0.4212784203520652, 'support': 41323}, 'weighted avg': {'precision': 0.48654005698029346, 'recall': 0.42898627882777146, 'f1-score': 0.41303756773627476, 'support': 41323}}
[[5399 1384 4836]
 [4806 4153 8162]
 [3221 1187 8175]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0465744
{'0': {'precision': 0.4524144050876285, 'recall': 0.4371561271882815, 'f1-score': 0.44465440802383893, 'support': 13995}, '1': {'precision': 0.4867350015073862, 'recall': 0.26063443377189444, 'f1-score': 0.3394837827892551, 'support': 12389}, '2': {'precision': 0.442171406973448, 'recall': 0.6264810228261597, 'f1-score': 0.5184323500900152, 'support': 14939}, 'accuracy': 0.4526776855504199, 'macro avg': {'precision': 0.46044027118948755, 'recall': 0.4414238612621119, 'f1-score': 0.4341901803010364, 'support': 41323}, 'weighted avg': {'precision': 0.45900099657945237, 'recall': 0.4526776855504199, 'f1-score': 0.4397953658559264, 'support': 41323}}
[[6118 1806 6071]
 [3424 3229 5736]
 [3981 1599 9359]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0507275
{'0': {'precision': 0.4511603611670771, 'recall': 0.42194151720287526, 'f1-score': 0.4360620266858997, 'support': 14329}, '1': {'precision': 0.45454545454545453, 'recall': 0.25509775950323066, 'f1-score': 0.3267938726148884, 'support': 11917}, '2': {'precision': 0.43938965809550723, 'recall': 0.6188233733501359, 'f1-score': 0.5138938613643248, 'support': 15077}, 'accuracy': 0.445659802047286, 'macro avg': {'precision': 0.4483651579360129, 'recall': 0.43195421668541395, 'f1-score': 0.4255832535550376, 'support': 41323}, 'weighted avg': {'precision': 0.4478419493281512, 'recall': 0.445659802047286, 'f1-score': 0.4329480702786295, 'support': 41323}}
[[6046 1931 6352]
 [3325 3040 5552]
 [4030 1717 9330]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0684055
{'0': {'precision': 0.43185961713764814, 'recall': 0.3935073025541635, 'f1-score': 0.4117924015790808, 'support': 14447}, '1': {'precision': 0.4046920821114369, 'recall': 0.22959820314449714, 'f1-score': 0.2929780797197601, 'support': 12021}, '2': {'precision': 0.41993532967805425, 'recall': 0.6032312352743184, 'f1-score': 0.4951649444659336, 'support': 14855}, 'accuracy': 0.4212182077777509, 'macro avg': {'precision': 0.41882900964237973, 'recall': 0.40877891365765967, 'f1-score': 0.39997847525492486, 'support': 41323}, 'weighted avg': {'precision': 0.4196698867511236, 'recall': 0.4212182077777509, 'f1-score': 0.40720009611997343, 'support': 41323}}
[[5685 2139 6623]
 [3506 2760 5755]
 [3973 1921 8961]]
training model: results/XRAY/W5/deepOF_L2/seq2seq
Epoch 1/50
483/483 - 21s - loss: 12.9129 - accuracy10: 0.4403 - accuracy20: 0.4211 - accuracy30: 0.4082 - accuracy50: 0.3877 - val_loss: 12.8724 - val_accuracy10: 0.4511 - val_accuracy20: 0.4345 - val_accuracy30: 0.4185 - val_accuracy50: 0.3981 - 21s/epoch - 44ms/step
Epoch 2/50
483/483 - 17s - loss: 12.5996 - accuracy10: 0.4722 - accuracy20: 0.4537 - accuracy30: 0.4363 - accuracy50: 0.4121 - val_loss: 12.7514 - val_accuracy10: 0.4587 - val_accuracy20: 0.4456 - val_accuracy30: 0.4293 - val_accuracy50: 0.4080 - 17s/epoch - 35ms/step
Epoch 3/50
483/483 - 17s - loss: 12.4561 - accuracy10: 0.4860 - accuracy20: 0.4677 - accuracy30: 0.4487 - accuracy50: 0.4218 - val_loss: 12.6907 - val_accuracy10: 0.4669 - val_accuracy20: 0.4546 - val_accuracy30: 0.4371 - val_accuracy50: 0.4104 - 17s/epoch - 35ms/step
Epoch 4/50
483/483 - 16s - loss: 12.3513 - accuracy10: 0.4953 - accuracy20: 0.4786 - accuracy30: 0.4593 - accuracy50: 0.4295 - val_loss: 12.6520 - val_accuracy10: 0.4781 - val_accuracy20: 0.4580 - val_accuracy30: 0.4387 - val_accuracy50: 0.4120 - 16s/epoch - 34ms/step
Epoch 5/50
483/483 - 16s - loss: 12.2780 - accuracy10: 0.5023 - accuracy20: 0.4839 - accuracy30: 0.4652 - accuracy50: 0.4343 - val_loss: 12.6353 - val_accuracy10: 0.4807 - val_accuracy20: 0.4591 - val_accuracy30: 0.4409 - val_accuracy50: 0.4128 - 16s/epoch - 34ms/step
Epoch 6/50
483/483 - 16s - loss: 12.2117 - accuracy10: 0.5073 - accuracy20: 0.4891 - accuracy30: 0.4699 - accuracy50: 0.4379 - val_loss: 12.6289 - val_accuracy10: 0.4786 - val_accuracy20: 0.4641 - val_accuracy30: 0.4459 - val_accuracy50: 0.4165 - 16s/epoch - 34ms/step
Epoch 7/50
483/483 - 16s - loss: 12.1591 - accuracy10: 0.5106 - accuracy20: 0.4932 - accuracy30: 0.4741 - accuracy50: 0.4414 - val_loss: 12.6261 - val_accuracy10: 0.4825 - val_accuracy20: 0.4650 - val_accuracy30: 0.4461 - val_accuracy50: 0.4140 - 16s/epoch - 34ms/step
Epoch 8/50
483/483 - 16s - loss: 12.1183 - accuracy10: 0.5125 - accuracy20: 0.4980 - accuracy30: 0.4781 - accuracy50: 0.4454 - val_loss: 12.6339 - val_accuracy10: 0.4821 - val_accuracy20: 0.4659 - val_accuracy30: 0.4473 - val_accuracy50: 0.4180 - 16s/epoch - 33ms/step
Epoch 9/50
483/483 - 16s - loss: 12.0805 - accuracy10: 0.5150 - accuracy20: 0.4996 - accuracy30: 0.4810 - accuracy50: 0.4491 - val_loss: 12.6223 - val_accuracy10: 0.4837 - val_accuracy20: 0.4654 - val_accuracy30: 0.4488 - val_accuracy50: 0.4195 - 16s/epoch - 34ms/step
Epoch 10/50
483/483 - 16s - loss: 12.0406 - accuracy10: 0.5184 - accuracy20: 0.5041 - accuracy30: 0.4858 - accuracy50: 0.4527 - val_loss: 12.6406 - val_accuracy10: 0.4843 - val_accuracy20: 0.4651 - val_accuracy30: 0.4493 - val_accuracy50: 0.4197 - 16s/epoch - 33ms/step
Epoch 11/50
483/483 - 16s - loss: 12.0074 - accuracy10: 0.5188 - accuracy20: 0.5050 - accuracy30: 0.4859 - accuracy50: 0.4543 - val_loss: 12.6842 - val_accuracy10: 0.4768 - val_accuracy20: 0.4600 - val_accuracy30: 0.4433 - val_accuracy50: 0.4154 - 16s/epoch - 34ms/step
Epoch 12/50
483/483 - 16s - loss: 11.9687 - accuracy10: 0.5201 - accuracy20: 0.5101 - accuracy30: 0.4915 - accuracy50: 0.4590 - val_loss: 12.7053 - val_accuracy10: 0.4706 - val_accuracy20: 0.4590 - val_accuracy30: 0.4430 - val_accuracy50: 0.4143 - 16s/epoch - 34ms/step
Epoch 13/50
483/483 - 16s - loss: 11.9312 - accuracy10: 0.5240 - accuracy20: 0.5125 - accuracy30: 0.4954 - accuracy50: 0.4642 - val_loss: 12.7403 - val_accuracy10: 0.4715 - val_accuracy20: 0.4604 - val_accuracy30: 0.4424 - val_accuracy50: 0.4132 - 16s/epoch - 33ms/step
Epoch 14/50
483/483 - 16s - loss: 11.8995 - accuracy10: 0.5249 - accuracy20: 0.5141 - accuracy30: 0.4974 - accuracy50: 0.4653 - val_loss: 12.7457 - val_accuracy10: 0.4681 - val_accuracy20: 0.4598 - val_accuracy30: 0.4442 - val_accuracy50: 0.4142 - 16s/epoch - 34ms/step
Epoch 15/50
483/483 - 16s - loss: 11.8627 - accuracy10: 0.5266 - accuracy20: 0.5170 - accuracy30: 0.5011 - accuracy50: 0.4696 - val_loss: 12.6949 - val_accuracy10: 0.4726 - val_accuracy20: 0.4623 - val_accuracy30: 0.4452 - val_accuracy50: 0.4197 - 16s/epoch - 34ms/step
Epoch 16/50
483/483 - 16s - loss: 11.8228 - accuracy10: 0.5266 - accuracy20: 0.5209 - accuracy30: 0.5052 - accuracy50: 0.4750 - val_loss: 12.7758 - val_accuracy10: 0.4627 - val_accuracy20: 0.4574 - val_accuracy30: 0.4418 - val_accuracy50: 0.4160 - 16s/epoch - 33ms/step
Epoch 17/50
483/483 - 16s - loss: 11.7844 - accuracy10: 0.5278 - accuracy20: 0.5219 - accuracy30: 0.5064 - accuracy50: 0.4762 - val_loss: 12.7618 - val_accuracy10: 0.4738 - val_accuracy20: 0.4597 - val_accuracy30: 0.4431 - val_accuracy50: 0.4188 - 16s/epoch - 34ms/step
Epoch 18/50
483/483 - 16s - loss: 11.7453 - accuracy10: 0.5305 - accuracy20: 0.5274 - accuracy30: 0.5121 - accuracy50: 0.4812 - val_loss: 12.8868 - val_accuracy10: 0.4702 - val_accuracy20: 0.4564 - val_accuracy30: 0.4413 - val_accuracy50: 0.4119 - 16s/epoch - 33ms/step
Epoch 19/50
483/483 - 17s - loss: 11.7098 - accuracy10: 0.5309 - accuracy20: 0.5288 - accuracy30: 0.5130 - accuracy50: 0.4840 - val_loss: 12.8854 - val_accuracy10: 0.4661 - val_accuracy20: 0.4539 - val_accuracy30: 0.4396 - val_accuracy50: 0.4127 - 17s/epoch - 35ms/step
testing model: results/XRAY/W5/deepOF_L2/seq2seq
Evaluating performance on  test set...
2341/2341 - 35s - 35s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0184499
{'0': {'precision': 0.4476673592185856, 'recall': 0.3848839502163247, 'f1-score': 0.41390837933077623, 'support': 172426}, '1': {'precision': 0.5808323338816491, 'recall': 0.48226810778471396, 'f1-score': 0.5269810821679488, 'support': 254062}, '2': {'precision': 0.4095507840972989, 'recall': 0.5690549221598472, 'f1-score': 0.4763039660914321, 'support': 172790}, 'accuracy': 0.4792717236407811, 'macro avg': {'precision': 0.4793501590658445, 'recall': 0.4787356600536286, 'f1-score': 0.4723978091967191, 'support': 599278}, 'weighted avg': {'precision': 0.4931320630415861, 'recall': 0.4792717236407811, 'f1-score': 0.479835729349618, 'support': 599278}}
[[ 66364  48111  57951]
 [ 47729 122526  83807]
 [ 34151  40312  98327]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0453781
{'0': {'precision': 0.4879088049232125, 'recall': 0.3432646439208659, 'f1-score': 0.4030009438360682, 'support': 206485}, '1': {'precision': 0.44255728485805196, 'recall': 0.4808440618735729, 'f1-score': 0.4609069354643979, 'support': 186574}, '2': {'precision': 0.4503645161803798, 'recall': 0.5488000620699354, 'f1-score': 0.4947334599605256, 'support': 206219}, 'accuracy': 0.4568247124039261, 'macro avg': {'precision': 0.4602768686538814, 'recall': 0.45763625595479135, 'f1-score': 0.4528804464203306, 'support': 599278}, 'weighted avg': {'precision': 0.46087000125463884, 'recall': 0.4568247124039261, 'f1-score': 0.452595189285982, 'support': 599278}}
[[ 70879  60413  75193]
 [ 33935  89713  62926]
 [ 40457  52589 113173]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0635827
{'0': {'precision': 0.4818026969481902, 'recall': 0.3171146426002224, 'f1-score': 0.3824843509665497, 'support': 214074}, '1': {'precision': 0.3908476434051882, 'recall': 0.4491733488846771, 'f1-score': 0.41798561346289, 'support': 171475}, '2': {'precision': 0.4454066754938503, 'recall': 0.5445728001347501, 'f1-score': 0.49002300844344615, 'support': 213729}, 'accuracy': 0.4360230143606139, 'macro avg': {'precision': 0.4393523386157429, 'recall': 0.43695359720654986, 'f1-score': 0.4301643242909619, 'support': 599278}, 'weighted avg': {'precision': 0.4427967546714824, 'recall': 0.4360230143606139, 'f1-score': 0.43099557398898597, 'support': 599278}}
[[ 67886  63746  82442]
 [ 31972  77022  62481]
 [ 41042  56296 116391]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0843574
{'0': {'precision': 0.4434054245701117, 'recall': 0.2855742883239458, 'f1-score': 0.34740387508970116, 'support': 210208}, '1': {'precision': 0.35929554882549053, 'recall': 0.39505157177795314, 'f1-score': 0.37632614328211794, 'support': 178683}, '2': {'precision': 0.41777069801704375, 'recall': 0.5310404159952848, 'f1-score': 0.46764444890920354, 'support': 210387}, 'accuracy': 0.404391617913556, 'macro avg': {'precision': 0.406823890470882, 'recall': 0.4038887586990613, 'f1-score': 0.3971248224270076, 'support': 599278}, 'weighted avg': {'precision': 0.40932738709335387, 'recall': 0.404391617913556, 'f1-score': 0.39823999997930043, 'support': 599278}}
[[ 60030  66144  84034]
 [ 36423  70589  71671]
 [ 38931  59732 111724]]
Evaluating performance on  train set...
483/483 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.971039
{'0': {'precision': 0.4786596922143886, 'recall': 0.38166047087980176, 'f1-score': 0.4246918562612454, 'support': 33087}, '1': {'precision': 0.6274155787468751, 'recall': 0.5586608956805936, 'f1-score': 0.5910454456250526, 'support': 56605}, '2': {'precision': 0.4253446946989809, 'recall': 0.5877810650887574, 'f1-score': 0.49354101455755944, 'support': 33800}, 'accuracy': 0.5192077219576977, 'macro avg': {'precision': 0.5104733218867482, 'recall': 0.5093674772163842, 'f1-score': 0.5030927721479524, 'support': 123492}, 'weighted avg': {'precision': 0.5322524758858056, 'recall': 0.5192077219576977, 'f1-score': 0.5197874614531098, 'support': 123492}}
[[12628 10308 10151]
 [ 8292 31623 16690]
 [ 5462  8471 19867]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0068183
{'0': {'precision': 0.5273120605732828, 'recall': 0.3410965065720426, 'f1-score': 0.41423889293517846, 'support': 40018}, '1': {'precision': 0.5016819635366917, 'recall': 0.5657152223288923, 'f1-score': 0.5317779122874594, 'support': 42707}, '2': {'precision': 0.47015046109043845, 'recall': 0.5702651654524493, 'f1-score': 0.5153910103641303, 'support': 40767}, 'accuracy': 0.49442878890940306, 'macro avg': {'precision': 0.49971482840013765, 'recall': 0.49235896478446134, 'f1-score': 0.48713593852892273, 'support': 123492}, 'weighted avg': {'precision': 0.49957834923765937, 'recall': 0.49442878890940306, 'f1-score': 0.48827937548225797, 'support': 123492}}
[[13650 13005 13363]
 [ 5710 24160 12837]
 [ 6526 10993 23248]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0295221
{'0': {'precision': 0.5117719458450788, 'recall': 0.314912537867683, 'f1-score': 0.3899030535852024, 'support': 40932}, '1': {'precision': 0.4708887061166183, 'recall': 0.5264609800362976, 'f1-score': 0.4971266009345688, 'support': 41325}, '2': {'precision': 0.45281461720054506, 'recall': 0.5721595731781254, 'f1-score': 0.5055390087638475, 'support': 41235}, 'accuracy': 0.4716013992809251, 'macro avg': {'precision': 0.47849175638741404, 'recall': 0.47117769702736867, 'f1-score': 0.46418955442787285, 'support': 123492}, 'weighted avg': {'precision': 0.47840455906345747, 'recall': 0.4716013992809251, 'f1-score': 0.4643958280645532, 'support': 123492}}
[[12890 13279 14763]
 [ 5822 21756 13747]
 [ 6475 11167 23593]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0582292
{'0': {'precision': 0.4786665570536008, 'recall': 0.2808189447284653, 'f1-score': 0.35397288588971976, 'support': 41468}, '1': {'precision': 0.4238758932930889, 'recall': 0.4698747755061874, 'f1-score': 0.4456916165917974, 'support': 40647}, '2': {'precision': 0.42795623405906924, 'recall': 0.5596104115813133, 'f1-score': 0.4850078024360357, 'support': 41377}, 'accuracy': 0.4364574223431477, 'macro avg': {'precision': 0.4434995614685863, 'recall': 0.43676804393865537, 'f1-score': 0.42822410163918434, 'support': 123492}, 'weighted avg': {'precision': 0.44364147733654824, 'recall': 0.4364574223431477, 'f1-score': 0.42806613070545085, 'support': 123492}}
[[11645 14101 15722]
 [ 6319 19099 15229]
 [ 6364 11858 23155]]
Evaluating performance on  val set...
162/162 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.012723
{'0': {'precision': 0.44357774310972437, 'recall': 0.36767241379310345, 'f1-score': 0.40207400424228135, 'support': 11600}, '1': {'precision': 0.577745180217938, 'recall': 0.48351455629603646, 'f1-score': 0.5264464388008402, 'support': 17106}, '2': {'precision': 0.42272309107635697, 'recall': 0.5827058730284537, 'f1-score': 0.48998633743210374, 'support': 12617}, 'accuracy': 0.481281610725262, 'macro avg': {'precision': 0.4813486714680065, 'recall': 0.4779642810391979, 'f1-score': 0.4728355934917417, 'support': 41323}, 'weighted avg': {'precision': 0.49274999668444314, 'recall': 0.481281610725262, 'f1-score': 0.4804009595314592, 'support': 41323}}
[[4265 3114 4221]
 [3016 8271 5819]
 [2334 2931 7352]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0364788
{'0': {'precision': 0.49318157414367014, 'recall': 0.3287288863441168, 'f1-score': 0.3945028988619283, 'support': 13972}, '1': {'precision': 0.44660620245757754, 'recall': 0.4924590692797806, 'f1-score': 0.46841317939472976, 'support': 12399}, '2': {'precision': 0.4644999454684262, 'recall': 0.5696896736222579, 'f1-score': 0.5117452688495043, 'support': 14952}, 'accuracy': 0.46504368027490744, 'macro avg': {'precision': 0.468095907356558, 'recall': 0.4636258764153851, 'f1-score': 0.45822044903538744, 'support': 41323}, 'weighted avg': {'precision': 0.46882865336134294, 'recall': 0.46504368027490744, 'f1-score': 0.4591018264417372, 'support': 41323}}
[[4593 3821 5558]
 [2031 6106 4262]
 [2689 3745 8518]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0510917
{'0': {'precision': 0.4856475300400534, 'recall': 0.30492490394690885, 'f1-score': 0.37462987598163333, 'support': 14315}, '1': {'precision': 0.4136467020470053, 'recall': 0.4584103512014787, 'f1-score': 0.4348796429140762, 'support': 11902}, '2': {'precision': 0.4538521807260381, 'recall': 0.5752019065272077, 'f1-score': 0.5073720475314589, 'support': 15106}, 'accuracy': 0.44793456428623285, 'macro avg': {'precision': 0.4510488042710323, 'recall': 0.4461790538918651, 'f1-score': 0.4389605221423895, 'support': 41323}, 'weighted avg': {'precision': 0.4532865107164134, 'recall': 0.44793456428623285, 'f1-score': 0.44050834486002066, 'support': 41323}}
[[4365 3949 6001]
 [1991 5456 4455]
 [2632 3785 8689]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0743903
{'0': {'precision': 0.4629823947767285, 'recall': 0.2758980059751268, 'f1-score': 0.34575533304309974, 'support': 14393}, '1': {'precision': 0.3722116482679863, 'recall': 0.404484156531811, 'f1-score': 0.3876774244707002, 'support': 12087}, '2': {'precision': 0.4269032685737596, 'recall': 0.5640369197601564, 'f1-score': 0.48598130841121495, 'support': 14843}, 'accuracy': 0.4170074776758706, 'macro avg': {'precision': 0.4206991038728248, 'recall': 0.41480636075569804, 'f1-score': 0.40647135530833833, 'support': 41323}, 'weighted avg': {'precision': 0.42347247334600385, 'recall': 0.4170074776758706, 'f1-score': 0.40838598598394, 'support': 41323}}
[[3971 4237 6185]
 [2144 4889 5054]
 [2462 4009 8372]]
training model: results/XRAY/W5/deepVOL_L2/seq2seq
Epoch 1/50
483/483 - 22s - loss: 13.0873 - accuracy10: 0.3898 - accuracy20: 0.3870 - accuracy30: 0.3828 - accuracy50: 0.3722 - val_loss: 13.4279 - val_accuracy10: 0.4194 - val_accuracy20: 0.3273 - val_accuracy30: 0.3148 - val_accuracy50: 0.3125 - 22s/epoch - 45ms/step
Epoch 2/50
483/483 - 16s - loss: 12.8001 - accuracy10: 0.4158 - accuracy20: 0.4192 - accuracy30: 0.4128 - accuracy50: 0.3960 - val_loss: 13.0220 - val_accuracy10: 0.4071 - val_accuracy20: 0.4089 - val_accuracy30: 0.4028 - val_accuracy50: 0.3898 - 16s/epoch - 33ms/step
Epoch 3/50
483/483 - 16s - loss: 12.6694 - accuracy10: 0.4290 - accuracy20: 0.4386 - accuracy30: 0.4294 - accuracy50: 0.4093 - val_loss: 12.9629 - val_accuracy10: 0.4107 - val_accuracy20: 0.4324 - val_accuracy30: 0.4254 - val_accuracy50: 0.4067 - 16s/epoch - 33ms/step
Epoch 4/50
483/483 - 16s - loss: 12.5768 - accuracy10: 0.4454 - accuracy20: 0.4540 - accuracy30: 0.4435 - accuracy50: 0.4177 - val_loss: 12.8755 - val_accuracy10: 0.4338 - val_accuracy20: 0.4448 - val_accuracy30: 0.4364 - val_accuracy50: 0.4128 - 16s/epoch - 33ms/step
Epoch 5/50
483/483 - 16s - loss: 12.4832 - accuracy10: 0.4575 - accuracy20: 0.4629 - accuracy30: 0.4510 - accuracy50: 0.4256 - val_loss: 12.8370 - val_accuracy10: 0.4460 - val_accuracy20: 0.4456 - val_accuracy30: 0.4352 - val_accuracy50: 0.4122 - 16s/epoch - 33ms/step
Epoch 6/50
483/483 - 16s - loss: 12.4035 - accuracy10: 0.4702 - accuracy20: 0.4712 - accuracy30: 0.4574 - accuracy50: 0.4300 - val_loss: 12.7834 - val_accuracy10: 0.4580 - val_accuracy20: 0.4491 - val_accuracy30: 0.4370 - val_accuracy50: 0.4104 - 16s/epoch - 33ms/step
Epoch 7/50
483/483 - 16s - loss: 12.3384 - accuracy10: 0.4812 - accuracy20: 0.4767 - accuracy30: 0.4613 - accuracy50: 0.4339 - val_loss: 12.7987 - val_accuracy10: 0.4558 - val_accuracy20: 0.4489 - val_accuracy30: 0.4364 - val_accuracy50: 0.4106 - 16s/epoch - 33ms/step
Epoch 8/50
483/483 - 16s - loss: 12.2933 - accuracy10: 0.4850 - accuracy20: 0.4807 - accuracy30: 0.4651 - accuracy50: 0.4357 - val_loss: 12.7207 - val_accuracy10: 0.4656 - val_accuracy20: 0.4574 - val_accuracy30: 0.4418 - val_accuracy50: 0.4149 - 16s/epoch - 34ms/step
Epoch 9/50
483/483 - 16s - loss: 12.2561 - accuracy10: 0.4907 - accuracy20: 0.4827 - accuracy30: 0.4661 - accuracy50: 0.4381 - val_loss: 12.7069 - val_accuracy10: 0.4736 - val_accuracy20: 0.4591 - val_accuracy30: 0.4446 - val_accuracy50: 0.4142 - 16s/epoch - 34ms/step
Epoch 10/50
483/483 - 16s - loss: 12.2198 - accuracy10: 0.4955 - accuracy20: 0.4861 - accuracy30: 0.4682 - accuracy50: 0.4398 - val_loss: 12.6346 - val_accuracy10: 0.4728 - val_accuracy20: 0.4615 - val_accuracy30: 0.4464 - val_accuracy50: 0.4176 - 16s/epoch - 34ms/step
Epoch 11/50
483/483 - 16s - loss: 12.1895 - accuracy10: 0.4974 - accuracy20: 0.4882 - accuracy30: 0.4707 - accuracy50: 0.4410 - val_loss: 12.6853 - val_accuracy10: 0.4707 - val_accuracy20: 0.4587 - val_accuracy30: 0.4445 - val_accuracy50: 0.4170 - 16s/epoch - 33ms/step
Epoch 12/50
483/483 - 16s - loss: 12.1655 - accuracy10: 0.5005 - accuracy20: 0.4906 - accuracy30: 0.4727 - accuracy50: 0.4416 - val_loss: 12.6840 - val_accuracy10: 0.4773 - val_accuracy20: 0.4607 - val_accuracy30: 0.4447 - val_accuracy50: 0.4140 - 16s/epoch - 33ms/step
Epoch 13/50
483/483 - 16s - loss: 12.1261 - accuracy10: 0.5043 - accuracy20: 0.4934 - accuracy30: 0.4757 - accuracy50: 0.4453 - val_loss: 12.6537 - val_accuracy10: 0.4707 - val_accuracy20: 0.4659 - val_accuracy30: 0.4519 - val_accuracy50: 0.4230 - 16s/epoch - 34ms/step
Epoch 14/50
483/483 - 16s - loss: 12.0974 - accuracy10: 0.5075 - accuracy20: 0.4966 - accuracy30: 0.4787 - accuracy50: 0.4472 - val_loss: 12.6750 - val_accuracy10: 0.4718 - val_accuracy20: 0.4621 - val_accuracy30: 0.4500 - val_accuracy50: 0.4200 - 16s/epoch - 34ms/step
Epoch 15/50
483/483 - 16s - loss: 12.0769 - accuracy10: 0.5079 - accuracy20: 0.4985 - accuracy30: 0.4796 - accuracy50: 0.4499 - val_loss: 12.6844 - val_accuracy10: 0.4612 - val_accuracy20: 0.4610 - val_accuracy30: 0.4477 - val_accuracy50: 0.4203 - 16s/epoch - 33ms/step
Epoch 16/50
483/483 - 16s - loss: 12.0532 - accuracy10: 0.5111 - accuracy20: 0.4997 - accuracy30: 0.4822 - accuracy50: 0.4510 - val_loss: 12.6918 - val_accuracy10: 0.4627 - val_accuracy20: 0.4603 - val_accuracy30: 0.4482 - val_accuracy50: 0.4194 - 16s/epoch - 33ms/step
Epoch 17/50
483/483 - 16s - loss: 12.0303 - accuracy10: 0.5124 - accuracy20: 0.5009 - accuracy30: 0.4835 - accuracy50: 0.4525 - val_loss: 12.6526 - val_accuracy10: 0.4653 - val_accuracy20: 0.4676 - val_accuracy30: 0.4513 - val_accuracy50: 0.4238 - 16s/epoch - 33ms/step
Epoch 18/50
483/483 - 16s - loss: 12.0051 - accuracy10: 0.5136 - accuracy20: 0.5037 - accuracy30: 0.4863 - accuracy50: 0.4572 - val_loss: 12.6713 - val_accuracy10: 0.4647 - val_accuracy20: 0.4656 - val_accuracy30: 0.4514 - val_accuracy50: 0.4210 - 16s/epoch - 33ms/step
Epoch 19/50
483/483 - 16s - loss: 11.9848 - accuracy10: 0.5142 - accuracy20: 0.5058 - accuracy30: 0.4880 - accuracy50: 0.4562 - val_loss: 12.7012 - val_accuracy10: 0.4597 - val_accuracy20: 0.4627 - val_accuracy30: 0.4517 - val_accuracy50: 0.4231 - 16s/epoch - 33ms/step
Epoch 20/50
483/483 - 16s - loss: 11.9635 - accuracy10: 0.5180 - accuracy20: 0.5068 - accuracy30: 0.4893 - accuracy50: 0.4585 - val_loss: 12.7298 - val_accuracy10: 0.4559 - val_accuracy20: 0.4620 - val_accuracy30: 0.4505 - val_accuracy50: 0.4191 - 16s/epoch - 33ms/step
testing model: results/XRAY/W5/deepVOL_L2/seq2seq
Evaluating performance on  test set...
2341/2341 - 31s - 31s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0196106
{'0': {'precision': 0.437585682594282, 'recall': 0.40725168040178855, 'f1-score': 0.4218741082290743, 'support': 172429}, '1': {'precision': 0.5771323978035388, 'recall': 0.4653982098857759, 'f1-score': 0.5152776960672162, 'support': 254062}, '2': {'precision': 0.4039678197082913, 'recall': 0.546906106764202, 'f1-score': 0.46469350222755484, 'support': 172792}, 'accuracy': 0.47216924224448215, 'macro avg': {'precision': 0.4728953000353706, 'recall': 0.4731853323505888, 'f1-score': 0.4672817688412818, 'support': 599283}, 'weighted avg': {'precision': 0.4870524950947169, 'recall': 0.47216924224448215, 'f1-score': 0.4738180997341219, 'support': 599283}}
[[ 70222  47718  54489]
 [ 50880 118240  84942]
 [ 39374  38917  94501]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.046245
{'0': {'precision': 0.47749987811418265, 'recall': 0.37945062182790285, 'f1-score': 0.4228660247830405, 'support': 206488}, '1': {'precision': 0.4369252443766827, 'recall': 0.48537309592976513, 'f1-score': 0.4598766999461705, 'support': 186574}, '2': {'precision': 0.4511457314210755, 'recall': 0.4986446579155372, 'f1-score': 0.473707486283669, 'support': 206221}, 'accuracy': 0.45344353168703266, 'macro avg': {'precision': 0.45519028463731354, 'recall': 0.45448945855773504, 'f1-score': 0.45215007033762666, 'support': 599283}, 'weighted avg': {'precision': 0.4557990285987792, 'recall': 0.45344353168703266, 'f1-score': 0.45188371215279227, 'support': 599283}}
[[ 78352  62840  65296]
 [ 36210  90558  59806]
 [ 49526  53864 102831]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.063093
{'0': {'precision': 0.47089890574188803, 'recall': 0.3706797087029433, 'f1-score': 0.4148220171304754, 'support': 214077}, '1': {'precision': 0.38551491613674194, 'recall': 0.47410409680711474, 'f1-score': 0.42524466855322557, 'support': 171475}, '2': {'precision': 0.450652150185549, 'recall': 0.4636341943845301, 'f1-score': 0.4570510056063042, 'support': 213731}, 'accuracy': 0.4334246090745107, 'macro avg': {'precision': 0.4356886573547263, 'recall': 0.43613933329819604, 'f1-score': 0.43237256376333505, 'support': 599283}, 'weighted avg': {'precision': 0.4392467832399077, 'recall': 0.4334246090745107, 'f1-score': 0.4328650253396912, 'support': 599283}}
[[79354 68787 65936]
 [35319 81297 54859]
 [53843 60795 99093]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0820144
{'0': {'precision': 0.4417491443899732, 'recall': 0.36350143427318266, 'f1-score': 0.39882355090334487, 'support': 210211}, '1': {'precision': 0.35991331200238114, 'recall': 0.43311339075345723, 'f1-score': 0.3931349963297579, 'support': 178683}, '2': {'precision': 0.424634258317044, 'recall': 0.4264386446059442, 'f1-score': 0.4255345386935817, 'support': 210389}, 'accuracy': 0.406352257614516, 'macro avg': {'precision': 0.4087655715697995, 'recall': 0.40768448987752803, 'f1-score': 0.4058310286422282, 'support': 599283}, 'weighted avg': {'precision': 0.41134037957517017, 'recall': 0.406352257614516, 'f1-score': 0.4065048133675361, 'support': 599283}}
[[76412 70980 62819]
 [42547 77390 58746]
 [54017 66654 89718]]
Evaluating performance on  train set...
483/483 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.98398125
{'0': {'precision': 0.46269000460617227, 'recall': 0.3639382868874732, 'f1-score': 0.40741554425160126, 'support': 33121}, '1': {'precision': 0.6170700479101272, 'recall': 0.5290077011595999, 'f1-score': 0.5696556062873538, 'support': 56485}, '2': {'precision': 0.39909417333115715, 'recall': 0.5772885557457357, 'f1-score': 0.4719307133724156, 'support': 33886}, 'accuracy': 0.49798367505587404, 'macro avg': {'precision': 0.49295140861581893, 'recall': 0.4900781812642696, 'f1-score': 0.48300062130379023, 'support': 123492}, 'weighted avg': {'precision': 0.515852544749977, 'recall': 0.49798367505587404, 'f1-score': 0.49932668768532484, 'support': 123492}}
[[12054 10170 10897]
 [ 8047 29881 18557]
 [ 5951  8373 19562]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0168136
{'0': {'precision': 0.5020289639253936, 'recall': 0.3376990884503656, 'f1-score': 0.403784827751411, 'support': 39932}, '1': {'precision': 0.4911203593061107, 'recall': 0.5580448065173116, 'f1-score': 0.5224480850364364, 'support': 42717}, '2': {'precision': 0.45322604121181875, 'recall': 0.5336777415958671, 'f1-score': 0.49017270846451383, 'support': 40843}, 'accuracy': 0.4787354646454831, 'macro avg': {'precision': 0.4821251214811077, 'recall': 0.4764738788545148, 'f1-score': 0.47213520708412043, 'support': 123492}, 'weighted avg': {'precision': 0.4821147942956812, 'recall': 0.4787354646454831, 'f1-score': 0.473402929113521, 'support': 123492}}
[[13485 13291 13156]
 [ 5739 23838 13140]
 [ 7637 11409 21797]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0352618
{'0': {'precision': 0.48677875979018465, 'recall': 0.3314010370805205, 'f1-score': 0.3943362728833784, 'support': 40884}, '1': {'precision': 0.4610795570628856, 'recall': 0.5449233369552094, 'f1-score': 0.4995075309038191, 'support': 41415}, '2': {'precision': 0.4450462407946566, 'recall': 0.5046731240744786, 'f1-score': 0.4729878846481997, 'support': 41193}, 'accuracy': 0.4608071777928935, 'macro avg': {'precision': 0.46430151921590895, 'recall': 0.4603324993700695, 'f1-score': 0.45561056281179907, 'support': 123492}, 'weighted avg': {'precision': 0.46423948489032174, 'recall': 0.4608071777928935, 'f1-score': 0.4558427955273135, 'support': 123492}}
[[13549 14228 13107]
 [ 6031 22568 12816]
 [ 8254 12150 20789]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0622855
{'0': {'precision': 0.4531271764869759, 'recall': 0.3135497240897371, 'f1-score': 0.37063305561489707, 'support': 41499}, '1': {'precision': 0.4166161432440079, 'recall': 0.5069844080468251, 'f1-score': 0.4573793042243522, 'support': 40662}, '2': {'precision': 0.42544266348743764, 'recall': 0.46623599719338993, 'f1-score': 0.44490620490620486, 'support': 41331}, 'accuracy': 0.42834353642341205, 'macro avg': {'precision': 0.4317286610728071, 'recall': 0.4289233764433174, 'f1-score': 0.4243061882484847, 'support': 123492}, 'weighted avg': {'precision': 0.4318396417437579, 'recall': 0.42834353642341205, 'f1-score': 0.42405400186499187, 'support': 123492}}
[[13012 15516 12971]
 [ 6994 20615 13053]
 [ 8710 13351 19270]]
Evaluating performance on  val set...
162/162 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0166607
{'0': {'precision': 0.44123586429725364, 'recall': 0.3761080988036836, 'f1-score': 0.4060772197184408, 'support': 11619}, '1': {'precision': 0.5842928845586064, 'recall': 0.4623561707844168, 'f1-score': 0.5162215918354038, 'support': 17121}, '2': {'precision': 0.4087628000671479, 'recall': 0.5805451800047683, 'f1-score': 0.4797399356406383, 'support': 12583}, 'accuracy': 0.47409433003412144, 'macro avg': {'precision': 0.47809718297433595, 'recall': 0.47300314986428954, 'f1-score': 0.46734624906482763, 'support': 41323}, 'weighted avg': {'precision': 0.4906192749084678, 'recall': 0.47409433003412144, 'f1-score': 0.4741429397645056, 'support': 41323}}
[[4370 2915 4334]
 [2973 7916 6232]
 [2561 2717 7305]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0368387
{'0': {'precision': 0.4788638102524866, 'recall': 0.3577706323687031, 'f1-score': 0.40955380148051207, 'support': 13995}, '1': {'precision': 0.45213744389669636, 'recall': 0.49600452013883284, 'f1-score': 0.47305619707467284, 'support': 12389}, '2': {'precision': 0.4598865478119935, 'recall': 0.5318294397215343, 'f1-score': 0.4932484867297843, 'support': 14939}, 'accuracy': 0.4621397284805072, 'macro avg': {'precision': 0.46362926732039217, 'recall': 0.46186819740969004, 'f1-score': 0.4586194950949897, 'support': 41323}, 'weighted avg': {'precision': 0.4639903916628292, 'recall': 0.4621397284805072, 'f1-score': 0.45884949835525335, 'support': 41323}}
[[5007 3784 5204]
 [2117 6145 4127]
 [3332 3662 7945]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0502338
{'0': {'precision': 0.46603518267929633, 'recall': 0.3605276013678554, 'f1-score': 0.4065475722042969, 'support': 14329}, '1': {'precision': 0.41768717459851873, 'recall': 0.47797264412184276, 'f1-score': 0.4458010487594897, 'support': 11917}, '2': {'precision': 0.4569604240708391, 'recall': 0.503150494130132, 'f1-score': 0.4789443778016289, 'support': 15077}, 'accuracy': 0.4464341891924594, 'macro avg': {'precision': 0.4468942604495514, 'recall': 0.4472169132066101, 'f1-score': 0.4437643329218052, 'support': 41323}, 'weighted avg': {'precision': 0.44878127207652463, 'recall': 0.4464341891924594, 'f1-score': 0.4442822555065548, 'support': 41323}}
[[5166 4066 5097]
 [2303 5696 3918]
 [3616 3875 7586]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0749888
{'0': {'precision': 0.4383912560840236, 'recall': 0.3553678964490898, 'f1-score': 0.39253765578408134, 'support': 14447}, '1': {'precision': 0.3796269309239289, 'recall': 0.43340820231261956, 'f1-score': 0.4047387842299476, 'support': 12021}, '2': {'precision': 0.43517119838872104, 'recall': 0.4654325143049478, 'f1-score': 0.44979344891520023, 'support': 14855}, 'accuracy': 0.417636667231324, 'macro avg': {'precision': 0.4177297951322245, 'recall': 0.4180695376888857, 'f1-score': 0.4156899629764097, 'support': 41323}, 'weighted avg': {'precision': 0.4201389532547707, 'recall': 0.417636667231324, 'f1-score': 0.41666960583636525, 'support': 41323}}
[[5134 4383 4930]
 [2767 5210 4044]
 [3810 4131 6914]]
training model: results/XRAY/W5/deepVOL_L3/seq2seq
Epoch 1/50
483/483 - 29s - loss: 13.1835 - accuracy10: 0.3912 - accuracy20: 0.3737 - accuracy30: 0.3713 - accuracy50: 0.3613 - val_loss: 13.4613 - val_accuracy10: 0.4173 - val_accuracy20: 0.3392 - val_accuracy30: 0.3251 - val_accuracy50: 0.3176 - 29s/epoch - 60ms/step
Epoch 2/50
483/483 - 22s - loss: 13.0749 - accuracy10: 0.4006 - accuracy20: 0.3821 - accuracy30: 0.3802 - accuracy50: 0.3679 - val_loss: 13.1200 - val_accuracy10: 0.3835 - val_accuracy20: 0.3985 - val_accuracy30: 0.3901 - val_accuracy50: 0.3713 - 22s/epoch - 46ms/step
Epoch 3/50
483/483 - 22s - loss: 12.9840 - accuracy10: 0.3988 - accuracy20: 0.3950 - accuracy30: 0.3910 - accuracy50: 0.3760 - val_loss: 13.0917 - val_accuracy10: 0.3818 - val_accuracy20: 0.4090 - val_accuracy30: 0.4054 - val_accuracy50: 0.3863 - 22s/epoch - 46ms/step
Epoch 4/50
483/483 - 22s - loss: 12.8483 - accuracy10: 0.4079 - accuracy20: 0.4154 - accuracy30: 0.4108 - accuracy50: 0.3947 - val_loss: 12.9215 - val_accuracy10: 0.4168 - val_accuracy20: 0.4262 - val_accuracy30: 0.4188 - val_accuracy50: 0.4007 - 22s/epoch - 45ms/step
Epoch 5/50
483/483 - 22s - loss: 12.6489 - accuracy10: 0.4264 - accuracy20: 0.4384 - accuracy30: 0.4309 - accuracy50: 0.4096 - val_loss: 12.8805 - val_accuracy10: 0.4447 - val_accuracy20: 0.4326 - val_accuracy30: 0.4217 - val_accuracy50: 0.4002 - 22s/epoch - 45ms/step
Epoch 6/50
483/483 - 22s - loss: 12.5337 - accuracy10: 0.4457 - accuracy20: 0.4577 - accuracy30: 0.4467 - accuracy50: 0.4226 - val_loss: 12.8378 - val_accuracy10: 0.4582 - val_accuracy20: 0.4432 - val_accuracy30: 0.4342 - val_accuracy50: 0.4077 - 22s/epoch - 46ms/step
Epoch 7/50
483/483 - 23s - loss: 12.4448 - accuracy10: 0.4605 - accuracy20: 0.4674 - accuracy30: 0.4547 - accuracy50: 0.4283 - val_loss: 12.6989 - val_accuracy10: 0.4612 - val_accuracy20: 0.4611 - val_accuracy30: 0.4491 - val_accuracy50: 0.4202 - 23s/epoch - 47ms/step
Epoch 8/50
483/483 - 22s - loss: 12.3833 - accuracy10: 0.4724 - accuracy20: 0.4748 - accuracy30: 0.4606 - accuracy50: 0.4327 - val_loss: 12.7587 - val_accuracy10: 0.4721 - val_accuracy20: 0.4559 - val_accuracy30: 0.4422 - val_accuracy50: 0.4129 - 22s/epoch - 46ms/step
Epoch 9/50
483/483 - 22s - loss: 12.3303 - accuracy10: 0.4807 - accuracy20: 0.4798 - accuracy30: 0.4638 - accuracy50: 0.4361 - val_loss: 12.6777 - val_accuracy10: 0.4715 - val_accuracy20: 0.4633 - val_accuracy30: 0.4495 - val_accuracy50: 0.4180 - 22s/epoch - 46ms/step
Epoch 10/50
483/483 - 22s - loss: 12.2688 - accuracy10: 0.4879 - accuracy20: 0.4850 - accuracy30: 0.4695 - accuracy50: 0.4403 - val_loss: 12.6901 - val_accuracy10: 0.4737 - val_accuracy20: 0.4614 - val_accuracy30: 0.4468 - val_accuracy50: 0.4171 - 22s/epoch - 46ms/step
Epoch 11/50
483/483 - 22s - loss: 12.2300 - accuracy10: 0.4910 - accuracy20: 0.4879 - accuracy30: 0.4723 - accuracy50: 0.4431 - val_loss: 12.6846 - val_accuracy10: 0.4749 - val_accuracy20: 0.4628 - val_accuracy30: 0.4482 - val_accuracy50: 0.4162 - 22s/epoch - 46ms/step
Epoch 12/50
483/483 - 23s - loss: 12.1884 - accuracy10: 0.4954 - accuracy20: 0.4922 - accuracy30: 0.4756 - accuracy50: 0.4450 - val_loss: 12.6829 - val_accuracy10: 0.4764 - val_accuracy20: 0.4632 - val_accuracy30: 0.4478 - val_accuracy50: 0.4152 - 23s/epoch - 47ms/step
Epoch 13/50
483/483 - 22s - loss: 12.1559 - accuracy10: 0.4984 - accuracy20: 0.4951 - accuracy30: 0.4779 - accuracy50: 0.4473 - val_loss: 12.6250 - val_accuracy10: 0.4733 - val_accuracy20: 0.4686 - val_accuracy30: 0.4539 - val_accuracy50: 0.4210 - 22s/epoch - 45ms/step
Epoch 14/50
483/483 - 22s - loss: 12.1235 - accuracy10: 0.5028 - accuracy20: 0.4973 - accuracy30: 0.4793 - accuracy50: 0.4487 - val_loss: 12.6269 - val_accuracy10: 0.4750 - val_accuracy20: 0.4672 - val_accuracy30: 0.4508 - val_accuracy50: 0.4183 - 22s/epoch - 47ms/step
Epoch 15/50
483/483 - 22s - loss: 12.0847 - accuracy10: 0.5050 - accuracy20: 0.4984 - accuracy30: 0.4819 - accuracy50: 0.4514 - val_loss: 12.6480 - val_accuracy10: 0.4735 - val_accuracy20: 0.4626 - val_accuracy30: 0.4494 - val_accuracy50: 0.4183 - 22s/epoch - 45ms/step
Epoch 16/50
483/483 - 22s - loss: 12.0533 - accuracy10: 0.5072 - accuracy20: 0.5014 - accuracy30: 0.4843 - accuracy50: 0.4530 - val_loss: 12.6611 - val_accuracy10: 0.4760 - val_accuracy20: 0.4630 - val_accuracy30: 0.4473 - val_accuracy50: 0.4171 - 22s/epoch - 46ms/step
Epoch 17/50
483/483 - 22s - loss: 12.0196 - accuracy10: 0.5100 - accuracy20: 0.5039 - accuracy30: 0.4877 - accuracy50: 0.4565 - val_loss: 12.6382 - val_accuracy10: 0.4716 - val_accuracy20: 0.4671 - val_accuracy30: 0.4528 - val_accuracy50: 0.4210 - 22s/epoch - 46ms/step
Epoch 18/50
483/483 - 22s - loss: 11.9964 - accuracy10: 0.5112 - accuracy20: 0.5060 - accuracy30: 0.4903 - accuracy50: 0.4576 - val_loss: 12.6733 - val_accuracy10: 0.4697 - val_accuracy20: 0.4645 - val_accuracy30: 0.4507 - val_accuracy50: 0.4194 - 22s/epoch - 46ms/step
Epoch 19/50
483/483 - 22s - loss: 11.9788 - accuracy10: 0.5109 - accuracy20: 0.5055 - accuracy30: 0.4895 - accuracy50: 0.4583 - val_loss: 12.6620 - val_accuracy10: 0.4696 - val_accuracy20: 0.4659 - val_accuracy30: 0.4537 - val_accuracy50: 0.4220 - 22s/epoch - 46ms/step
Epoch 20/50
483/483 - 22s - loss: 11.9561 - accuracy10: 0.5147 - accuracy20: 0.5078 - accuracy30: 0.4907 - accuracy50: 0.4597 - val_loss: 12.6449 - val_accuracy10: 0.4694 - val_accuracy20: 0.4699 - val_accuracy30: 0.4552 - val_accuracy50: 0.4222 - 22s/epoch - 45ms/step
Epoch 21/50
483/483 - 22s - loss: 11.9274 - accuracy10: 0.5153 - accuracy20: 0.5082 - accuracy30: 0.4933 - accuracy50: 0.4614 - val_loss: 12.7116 - val_accuracy10: 0.4665 - val_accuracy20: 0.4617 - val_accuracy30: 0.4485 - val_accuracy50: 0.4185 - 22s/epoch - 45ms/step
Epoch 22/50
483/483 - 22s - loss: 11.9069 - accuracy10: 0.5161 - accuracy20: 0.5103 - accuracy30: 0.4942 - accuracy50: 0.4624 - val_loss: 12.6909 - val_accuracy10: 0.4692 - val_accuracy20: 0.4646 - val_accuracy30: 0.4536 - val_accuracy50: 0.4240 - 22s/epoch - 45ms/step
Epoch 23/50
483/483 - 22s - loss: 11.8858 - accuracy10: 0.5175 - accuracy20: 0.5123 - accuracy30: 0.4968 - accuracy50: 0.4652 - val_loss: 12.6981 - val_accuracy10: 0.4703 - val_accuracy20: 0.4653 - val_accuracy30: 0.4538 - val_accuracy50: 0.4214 - 22s/epoch - 46ms/step
testing model: results/XRAY/W5/deepVOL_L3/seq2seq
Evaluating performance on  test set...
2341/2341 - 48s - 48s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0160972
{'0': {'precision': 0.4370714526583986, 'recall': 0.4059061990732417, 'f1-score': 0.4209127293174526, 'support': 172429}, '1': {'precision': 0.5797653028861401, 'recall': 0.48207130542938337, 'f1-score': 0.5264241489062201, 'support': 254062}, '2': {'precision': 0.411043537020948, 'recall': 0.5421315801657484, 'f1-score': 0.46757343582320493, 'support': 172792}, 'accuracy': 0.47747391466135364, 'macro avg': {'precision': 0.47596009752182894, 'recall': 0.47670302822279115, 'f1-score': 0.47163677134895926, 'support': 599283}, 'weighted avg': {'precision': 0.490060890666375, 'recall': 0.47747391466135364, 'f1-score': 0.47909732504618746, 'support': 599283}}
[[ 69990  48984  53455]
 [ 50819 122476  80767]
 [ 39325  39791  93676]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0468411
{'0': {'precision': 0.4786933197397806, 'recall': 0.3820125140443997, 'f1-score': 0.42492296752785025, 'support': 206488}, '1': {'precision': 0.44085484030688993, 'recall': 0.5010826803305927, 'f1-score': 0.46904326492523274, 'support': 186574}, '2': {'precision': 0.45648186444640254, 'recall': 0.49237468541031226, 'f1-score': 0.4737494080348624, 'support': 206221}, 'accuracy': 0.45705951945908696, 'macro avg': {'precision': 0.4586766748310243, 'recall': 0.45848995992843483, 'f1-score': 0.4559052134959818, 'support': 599283}, 'weighted avg': {'precision': 0.4592698670742321, 'recall': 0.45705951945908696, 'f1-score': 0.45546068969653486, 'support': 599283}}
[[ 78881  63568  64039]
 [ 36226  93489  56859]
 [ 49677  55006 101538]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0640169
{'0': {'precision': 0.476852470162573, 'recall': 0.3669240506920407, 'f1-score': 0.4147274440804323, 'support': 214077}, '1': {'precision': 0.39223120361102193, 'recall': 0.48446129173348884, 'f1-score': 0.4334948378562427, 'support': 171475}, '2': {'precision': 0.4525747325609061, 'recall': 0.47169572967889545, 'f1-score': 0.461937446734419, 'support': 213731}, 'accuracy': 0.43792164970473046, 'macro avg': {'precision': 0.44055280211150033, 'recall': 0.44102702403480837, 'f1-score': 0.4367199095570313, 'support': 599283}, 'weighted avg': {'precision': 0.4439809606799594, 'recall': 0.43792164970473046, 'f1-score': 0.43693461485775503, 'support': 599283}}
[[ 78550  67883  67644]
 [ 34101  83073  54301]
 [ 52075  60840 100816]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0834162
{'0': {'precision': 0.4486816034141137, 'recall': 0.3501006131934104, 'f1-score': 0.3933079660962601, 'support': 210211}, '1': {'precision': 0.3625976176765922, 'recall': 0.4264143762976892, 'f1-score': 0.39192518787903724, 'support': 178683}, '2': {'precision': 0.4205714996424241, 'recall': 0.4500330340464568, 'f1-score': 0.4348037729957109, 'support': 210389}, 'accuracy': 0.40793748529492746, 'macro avg': {'precision': 0.4106169069110433, 'recall': 0.40884934117918553, 'f1-score': 0.4066789756570028, 'support': 599283}, 'weighted avg': {'precision': 0.4131461361207655, 'recall': 0.40793748529492746, 'f1-score': 0.407463519244907, 'support': 599283}}
[[73595 68877 67739]
 [39784 76193 62706]
 [50646 65061 94682]]
Evaluating performance on  train set...
483/483 - 10s - 10s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9790423
{'0': {'precision': 0.4647478718937283, 'recall': 0.36759155822589895, 'f1-score': 0.4104993425267204, 'support': 33121}, '1': {'precision': 0.6225764581812282, 'recall': 0.5434717181552624, 'f1-score': 0.5803408543098314, 'support': 56485}, '2': {'precision': 0.4087148602746577, 'recall': 0.5787936020775541, 'f1-score': 0.4791078866048636, 'support': 33886}, 'accuracy': 0.5059922909986072, 'macro avg': {'precision': 0.49867973011653804, 'recall': 0.4966189594862385, 'f1-score': 0.48998269448047177, 'support': 123492}, 'weighted avg': {'precision': 0.521562994045168, 'recall': 0.5059922909986072, 'f1-score': 0.5070105895524466, 'support': 123492}}
[[12175 10167 10779]
 [ 8192 30698 17595]
 [ 5830  8443 19613]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.01487
{'0': {'precision': 0.5010121830026869, 'recall': 0.340879495141741, 'f1-score': 0.4057167553389667, 'support': 39932}, '1': {'precision': 0.495598982517059, 'recall': 0.5746892337945081, 'f1-score': 0.5322218729336268, 'support': 42717}, '2': {'precision': 0.4609416743251619, 'recall': 0.528046421663443, 'f1-score': 0.49221745481102797, 'support': 40843}, 'accuracy': 0.4836588604929874, 'macro avg': {'precision': 0.48585094661496925, 'recall': 0.4812050501998974, 'f1-score': 0.4767186943612072, 'support': 123492}, 'weighted avg': {'precision': 0.485887029380908, 'recall': 0.48365886049298745, 'f1-score': 0.4780847401220174, 'support': 123492}}
[[13612 13359 12961]
 [ 5907 24549 12261]
 [ 7650 11626 21567]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0332065
{'0': {'precision': 0.4875984826378757, 'recall': 0.3269738773114177, 'f1-score': 0.3914494875549049, 'support': 40884}, '1': {'precision': 0.4664010033174205, 'recall': 0.5567306531449958, 'f1-score': 0.5075783425608965, 'support': 41415}, '2': {'precision': 0.4492066895368782, 'recall': 0.5086058310878062, 'f1-score': 0.47706442908701746, 'support': 41193}, 'accuracy': 0.4646130923460629, 'macro avg': {'precision': 0.4677353918307248, 'recall': 0.4641034538480732, 'f1-score': 0.45869741973427297, 'support': 123492}, 'weighted avg': {'precision': 0.46768329186222996, 'recall': 0.4646130923460629, 'f1-score': 0.45895355920817354, 'support': 123492}}
[[13368 14138 13378]
 [ 6047 23057 12311]
 [ 8001 12241 20951]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0608242
{'0': {'precision': 0.4594033438968419, 'recall': 0.3039109376129545, 'f1-score': 0.3658197006613296, 'support': 41499}, '1': {'precision': 0.4230792689125175, 'recall': 0.5117800403324971, 'f1-score': 0.46322162739707734, 'support': 40662}, '2': {'precision': 0.42595833689063434, 'recall': 0.4828579032687329, 'f1-score': 0.4526269235566946, 'support': 41331}, 'accuracy': 0.43224662326304536, 'macro avg': {'precision': 0.4361469832333313, 'recall': 0.43284962707139485, 'f1-score': 0.4272227505383672, 'support': 123492}, 'weighted avg': {'precision': 0.4362494139128254, 'recall': 0.43224662326304536, 'f1-score': 0.4269441983973555, 'support': 123492}}
[[12612 15135 13752]
 [ 6709 20810 13143]
 [ 8132 13242 19957]]
Evaluating performance on  val set...
162/162 - 3s - 3s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0151056
{'0': {'precision': 0.4385103335379579, 'recall': 0.36887856097770894, 'f1-score': 0.400691815079699, 'support': 11619}, '1': {'precision': 0.5944418276024493, 'recall': 0.4422638864552304, 'f1-score': 0.5071837636893399, 'support': 17121}, '2': {'precision': 0.40885652012120566, 'recall': 0.6112214893109751, 'f1-score': 0.48996623558641783, 'support': 12583}, 'accuracy': 0.47307794690608135, 'macro avg': {'precision': 0.48060289375387094, 'recall': 0.4741213122479715, 'f1-score': 0.4659472714518189, 'support': 41323}, 'weighted avg': {'precision': 0.49408638502635815, 'recall': 0.47307794690608135, 'f1-score': 0.4719980775819787, 'support': 41323}}
[[4286 2763 4570]
 [2999 7572 6550]
 [2489 2403 7691]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.034971
{'0': {'precision': 0.47953272832593163, 'recall': 0.3549124687388353, 'f1-score': 0.40791688908963986, 'support': 13995}, '1': {'precision': 0.463859649122807, 'recall': 0.4801840342239083, 'f1-score': 0.4718807011977473, 'support': 12389}, '2': {'precision': 0.46069459757442116, 'recall': 0.5594082602583841, 'f1-score': 0.5052752501587109, 'support': 14939}, 'accuracy': 0.4663988577789609, 'macro avg': {'precision': 0.46802899167438666, 'recall': 0.4648349210737092, 'f1-score': 0.46169094681536604, 'support': 41323}, 'weighted avg': {'precision': 0.46802348133165905, 'recall': 0.4663988577789609, 'f1-score': 0.46229058471237283, 'support': 41323}}
[[4967 3545 5483]
 [2140 5949 4300]
 [3251 3331 8357]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0494518
{'0': {'precision': 0.47039817542525897, 'recall': 0.3454532765719869, 'f1-score': 0.3983582810236601, 'support': 14329}, '1': {'precision': 0.43638765835081994, 'recall': 0.4711756314508685, 'f1-score': 0.45311491284699806, 'support': 11917}, '2': {'precision': 0.4572018067250321, 'recall': 0.5438084499568879, 'f1-score': 0.49675855801272334, 'support': 15077}, 'accuracy': 0.4540812622510466, 'macro avg': {'precision': 0.4546625468337037, 'recall': 0.4534791193265811, 'f1-score': 0.44941058396112715, 'support': 41323}, 'weighted avg': {'precision': 0.4557752055811186, 'recall': 0.4540812622510466, 'f1-score': 0.4500514242514709, 'support': 41323}}
[[4950 3751 5628]
 [2196 5615 4106]
 [3377 3501 8199]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.074577
{'0': {'precision': 0.4443403298350825, 'recall': 0.32823423548141484, 'f1-score': 0.3775628010669215, 'support': 14447}, '1': {'precision': 0.3934043711596796, 'recall': 0.42076366358871975, 'f1-score': 0.40662432671436616, 'support': 12021}, '2': {'precision': 0.4302011914128358, 'recall': 0.5153147088522383, 'f1-score': 0.46892707280468005, 'support': 14855}, 'accuracy': 0.42240398809379764, 'macro avg': {'precision': 0.4226486308025326, 'recall': 0.42143753597412426, 'f1-score': 0.41770473352865595, 'support': 41323}, 'weighted avg': {'precision': 0.4244400791151567, 'recall': 0.42240398809379764, 'f1-score': 0.418860985043698, 'support': 41323}}
[[4742 4006 5699]
 [2523 5058 4440]
 [3407 3793 7655]]
training model: results/XRAY/W6/deepLOB_L1/seq2seq
Epoch 1/50
512/512 - 21s - loss: 12.9562 - accuracy10: 0.4060 - accuracy20: 0.4079 - accuracy30: 0.4039 - accuracy50: 0.3887 - val_loss: 13.1430 - val_accuracy10: 0.4136 - val_accuracy20: 0.3942 - val_accuracy30: 0.3827 - val_accuracy50: 0.3703 - 21s/epoch - 41ms/step
Epoch 2/50
512/512 - 14s - loss: 12.8081 - accuracy10: 0.4297 - accuracy20: 0.4331 - accuracy30: 0.4209 - accuracy50: 0.4004 - val_loss: 13.1278 - val_accuracy10: 0.4257 - val_accuracy20: 0.3967 - val_accuracy30: 0.3858 - val_accuracy50: 0.3705 - 14s/epoch - 27ms/step
Epoch 3/50
512/512 - 14s - loss: 12.7225 - accuracy10: 0.4484 - accuracy20: 0.4438 - accuracy30: 0.4297 - accuracy50: 0.4045 - val_loss: 12.9751 - val_accuracy10: 0.4438 - val_accuracy20: 0.4223 - val_accuracy30: 0.4090 - val_accuracy50: 0.3888 - 14s/epoch - 28ms/step
Epoch 4/50
512/512 - 14s - loss: 12.6636 - accuracy10: 0.4601 - accuracy20: 0.4518 - accuracy30: 0.4353 - accuracy50: 0.4088 - val_loss: 12.9277 - val_accuracy10: 0.4521 - val_accuracy20: 0.4251 - val_accuracy30: 0.4088 - val_accuracy50: 0.3895 - 14s/epoch - 27ms/step
Epoch 5/50
512/512 - 14s - loss: 12.6276 - accuracy10: 0.4671 - accuracy20: 0.4575 - accuracy30: 0.4413 - accuracy50: 0.4131 - val_loss: 12.8149 - val_accuracy10: 0.4632 - val_accuracy20: 0.4389 - val_accuracy30: 0.4217 - val_accuracy50: 0.3971 - 14s/epoch - 27ms/step
Epoch 6/50
512/512 - 14s - loss: 12.5981 - accuracy10: 0.4702 - accuracy20: 0.4601 - accuracy30: 0.4441 - accuracy50: 0.4157 - val_loss: 12.8064 - val_accuracy10: 0.4549 - val_accuracy20: 0.4401 - val_accuracy30: 0.4251 - val_accuracy50: 0.4001 - 14s/epoch - 27ms/step
Epoch 7/50
512/512 - 14s - loss: 12.5809 - accuracy10: 0.4714 - accuracy20: 0.4609 - accuracy30: 0.4442 - accuracy50: 0.4170 - val_loss: 12.7952 - val_accuracy10: 0.4589 - val_accuracy20: 0.4406 - val_accuracy30: 0.4251 - val_accuracy50: 0.4000 - 14s/epoch - 27ms/step
Epoch 8/50
512/512 - 14s - loss: 12.5570 - accuracy10: 0.4718 - accuracy20: 0.4628 - accuracy30: 0.4466 - accuracy50: 0.4200 - val_loss: 12.8188 - val_accuracy10: 0.4625 - val_accuracy20: 0.4444 - val_accuracy30: 0.4277 - val_accuracy50: 0.3989 - 14s/epoch - 27ms/step
Epoch 9/50
512/512 - 14s - loss: 12.5424 - accuracy10: 0.4744 - accuracy20: 0.4647 - accuracy30: 0.4480 - accuracy50: 0.4206 - val_loss: 12.8084 - val_accuracy10: 0.4700 - val_accuracy20: 0.4441 - val_accuracy30: 0.4251 - val_accuracy50: 0.3986 - 14s/epoch - 27ms/step
Epoch 10/50
512/512 - 14s - loss: 12.5179 - accuracy10: 0.4755 - accuracy20: 0.4656 - accuracy30: 0.4489 - accuracy50: 0.4216 - val_loss: 12.8210 - val_accuracy10: 0.4720 - val_accuracy20: 0.4450 - val_accuracy30: 0.4267 - val_accuracy50: 0.4004 - 14s/epoch - 27ms/step
Epoch 11/50
512/512 - 14s - loss: 12.4988 - accuracy10: 0.4774 - accuracy20: 0.4681 - accuracy30: 0.4526 - accuracy50: 0.4245 - val_loss: 12.8430 - val_accuracy10: 0.4741 - val_accuracy20: 0.4451 - val_accuracy30: 0.4266 - val_accuracy50: 0.4010 - 14s/epoch - 27ms/step
Epoch 12/50
512/512 - 14s - loss: 12.4819 - accuracy10: 0.4791 - accuracy20: 0.4699 - accuracy30: 0.4530 - accuracy50: 0.4252 - val_loss: 12.8408 - val_accuracy10: 0.4761 - val_accuracy20: 0.4465 - val_accuracy30: 0.4283 - val_accuracy50: 0.4019 - 14s/epoch - 27ms/step
Epoch 13/50
512/512 - 14s - loss: 12.4699 - accuracy10: 0.4776 - accuracy20: 0.4692 - accuracy30: 0.4536 - accuracy50: 0.4258 - val_loss: 12.8397 - val_accuracy10: 0.4754 - val_accuracy20: 0.4473 - val_accuracy30: 0.4271 - val_accuracy50: 0.4028 - 14s/epoch - 27ms/step
Epoch 14/50
512/512 - 14s - loss: 12.4459 - accuracy10: 0.4799 - accuracy20: 0.4716 - accuracy30: 0.4554 - accuracy50: 0.4277 - val_loss: 12.9453 - val_accuracy10: 0.4767 - val_accuracy20: 0.4435 - val_accuracy30: 0.4238 - val_accuracy50: 0.3983 - 14s/epoch - 27ms/step
Epoch 15/50
512/512 - 14s - loss: 12.4347 - accuracy10: 0.4805 - accuracy20: 0.4722 - accuracy30: 0.4563 - accuracy50: 0.4289 - val_loss: 12.8957 - val_accuracy10: 0.4781 - val_accuracy20: 0.4460 - val_accuracy30: 0.4270 - val_accuracy50: 0.4014 - 14s/epoch - 26ms/step
Epoch 16/50
512/512 - 14s - loss: 12.4126 - accuracy10: 0.4810 - accuracy20: 0.4742 - accuracy30: 0.4575 - accuracy50: 0.4305 - val_loss: 12.9396 - val_accuracy10: 0.4782 - val_accuracy20: 0.4407 - val_accuracy30: 0.4210 - val_accuracy50: 0.3955 - 14s/epoch - 27ms/step
Epoch 17/50
512/512 - 14s - loss: 12.3915 - accuracy10: 0.4837 - accuracy20: 0.4767 - accuracy30: 0.4603 - accuracy50: 0.4312 - val_loss: 13.0579 - val_accuracy10: 0.4783 - val_accuracy20: 0.4359 - val_accuracy30: 0.4172 - val_accuracy50: 0.3918 - 14s/epoch - 27ms/step
testing model: results/XRAY/W6/deepLOB_L1/seq2seq
Evaluating performance on  test set...
1214/1214 - 16s - 16s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.044204
{'0': {'precision': 0.4043430622298527, 'recall': 0.5129532544572986, 'f1-score': 0.4522182983075706, 'support': 91367}, '1': {'precision': 0.5081168015278685, 'recall': 0.47393216816544653, 'f1-score': 0.49042950985346134, 'support': 127993}, '2': {'precision': 0.43980585099328967, 'recall': 0.36309491224804846, 'f1-score': 0.39778581409714353, 'support': 91337}, 'accuracy': 0.45282381226725715, 'macro avg': {'precision': 0.450755238250337, 'recall': 0.44999344495693117, 'f1-score': 0.4468112074193918, 'support': 310697}, 'weighted avg': {'precision': 0.4575182681419052, 'recall': 0.45282381226725715, 'f1-score': 0.4519578123326993, 'support': 310697}}
[[46867 29803 14697]
 [39788 60660 27545]
 [29254 28919 33164]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0661328
{'0': {'precision': 0.45236389979666264, 'recall': 0.4976814114407854, 'f1-score': 0.47394182461133755, 'support': 110412}, '1': {'precision': 0.3684152745503449, 'recall': 0.44623465271929436, 'f1-score': 0.4036081182660987, 'support': 90244}, '2': {'precision': 0.48788758477439376, 'recall': 0.35433156732490617, 'f1-score': 0.41052016487768417, 'support': 110041}, 'accuracy': 0.4319674795701278, 'macro avg': {'precision': 0.43622225304046713, 'recall': 0.4327492104949953, 'f1-score': 0.42935670258504016, 'support': 310697}, 'weighted avg': {'precision': 0.44056205453232417, 'recall': 0.4319674795701278, 'f1-score': 0.431050590212001, 'support': 310697}}
[[54950 35518 19944]
 [28991 40270 20983]
 [37532 33518 38991]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0754714
{'0': {'precision': 0.4546865350203487, 'recall': 0.4961766764301822, 'f1-score': 0.4745264114694156, 'support': 115737}, '1': {'precision': 0.32046366385358815, 'recall': 0.40082813175947096, 'f1-score': 0.3561688971383698, 'support': 80905}, '2': {'precision': 0.4833723934859684, 'recall': 0.35262811801323923, 'f1-score': 0.4077765385785258, 'support': 114055}, 'accuracy': 0.4186522560565438, 'macro avg': {'precision': 0.4195075307866351, 'recall': 0.41654430873429743, 'f1-score': 0.41282394906210373, 'support': 310697}, 'weighted avg': {'precision': 0.43026552096340415, 'recall': 0.4186522560565438, 'f1-score': 0.41920282788308005, 'support': 310697}}
[[57426 35565 22746]
 [28236 32429 20240]
 [40636 33200 40219]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.086785
{'0': {'precision': 0.4251688180440075, 'recall': 0.48563208339163283, 'f1-score': 0.45339353216364714, 'support': 114352}, '1': {'precision': 0.3000666673721415, 'recall': 0.3381107957932893, 'f1-score': 0.3179547556975864, 'support': 83866}, '2': {'precision': 0.4548513740886147, 'recall': 0.34609127037046916, 'f1-score': 0.39308704806046557, 'support': 112479}, 'accuracy': 0.39529509457767537, 'macro avg': {'precision': 0.39336228650158794, 'recall': 0.3899447165184638, 'f1-score': 0.38814511197389967, 'support': 310697}, 'weighted avg': {'precision': 0.40214589620406266, 'recall': 0.39529509457767537, 'f1-score': 0.39500249056187947, 'support': 310697}}
[[55533 34590 24229]
 [33083 28356 22427]
 [41998 31553 38928]]
Evaluating performance on  train set...
512/512 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0231246
{'0': {'precision': 0.3948716849259267, 'recall': 0.5213428442028986, 'f1-score': 0.4493784387161313, 'support': 35328}, '1': {'precision': 0.5902521795096835, 'recall': 0.4966196258615031, 'f1-score': 0.5394027429976919, 'support': 60940}, '2': {'precision': 0.42198281079772426, 'recall': 0.4019370460048426, 'f1-score': 0.4117160741703082, 'support': 34692}, 'accuracy': 0.4782070861331704, 'macro avg': {'precision': 0.46903555841111144, 'recall': 0.47329983868974806, 'f1-score': 0.46683241862804375, 'support': 130960}, 'weighted avg': {'precision': 0.4929705434986095, 'recall': 0.4782070861331704, 'f1-score': 0.48129275111758674, 'support': 130960}}
[[18418 10789  6121]
 [17697 30264 12979]
 [10528 10220 13944]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0475118
{'0': {'precision': 0.44445351566486374, 'recall': 0.5049858540884004, 'f1-score': 0.4727900387550615, 'support': 43122}, '1': {'precision': 0.46321245697977, 'recall': 0.4832727591189736, 'f1-score': 0.4730300237875833, 'support': 45674}, '2': {'precision': 0.4666744382595518, 'recall': 0.37977895835309744, 'f1-score': 0.4187664265073159, 'support': 42164}, 'accuracy': 0.45710140500916313, 'macro avg': {'precision': 0.45811347030139515, 'recall': 0.45601252385349045, 'f1-score': 0.45486216301665355, 'support': 130960}, 'weighted avg': {'precision': 0.4581502082877979, 'recall': 0.45710140500916313, 'f1-score': 0.45548024560876843, 'support': 130960}}
[[21776 13033  8313]
 [13614 22073  9987]
 [13605 12546 16013]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0610936
{'0': {'precision': 0.4371555764742798, 'recall': 0.5033191835260116, 'f1-score': 0.4679100326409807, 'support': 44288}, '1': {'precision': 0.4271618749300817, 'recall': 0.44119890000693274, 'f1-score': 0.43406693343033836, 'support': 43273}, '2': {'precision': 0.45926177921415207, 'recall': 0.37328049033387867, 'f1-score': 0.41183125087387035, 'support': 43399}, 'accuracy': 0.43969914477703115, 'macro avg': {'precision': 0.4411930768728378, 'recall': 0.439266191288941, 'f1-score': 0.43793607231506315, 'support': 130960}, 'weighted avg': {'precision': 0.44117916876036434, 'recall': 0.43969914477703115, 'f1-score': 0.4381432681170578, 'support': 130960}}
[[22291 12996  9001]
 [14108 19092 10073]
 [14592 12607 16200]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0776763
{'0': {'precision': 0.4159354092830203, 'recall': 0.4910059065688205, 'f1-score': 0.45036374270205937, 'support': 44696}, '1': {'precision': 0.385025723701368, 'recall': 0.38089877099165026, 'f1-score': 0.38295112892766614, 'support': 42636}, '2': {'precision': 0.43344994169581874, 'recall': 0.3578435866874484, 'f1-score': 0.3920347537855008, 'support': 43628}, 'accuracy': 0.4107971899816738, 'macro avg': {'precision': 0.41147035822673567, 'recall': 0.40991608808263974, 'f1-score': 0.40844987513840875, 'support': 130960}, 'weighted avg': {'precision': 0.4117070851049983, 'recall': 0.4107971899816738, 'f1-score': 0.4089848382324759, 'support': 130960}}
[[21946 13217  9533]
 [15523 16240 10873]
 [15294 12722 15612]]
Evaluating performance on  val set...
169/169 - 2s - 2s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0403901
{'0': {'precision': 0.3863339349057191, 'recall': 0.536328293736501, 'f1-score': 0.4491390536825351, 'support': 11575}, '1': {'precision': 0.5734424738517508, 'recall': 0.44441647366831133, 'f1-score': 0.5007516664302937, 'support': 19862}, '2': {'precision': 0.4022250748823278, 'recall': 0.4013663535439795, 'f1-score': 0.4017952553964522, 'support': 11710}, 'accuracy': 0.45738985329223353, 'macro avg': {'precision': 0.45400049454659924, 'recall': 0.46070370698293067, 'f1-score': 0.45056199183642703, 'support': 43147}, 'weighted avg': {'precision': 0.4767790423215804, 'recall': 0.45738985329223353, 'f1-score': 0.4600490552229886, 'support': 43147}}
[[6208 3217 2150]
 [6200 8827 4835]
 [3661 3349 4700]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.059572
{'0': {'precision': 0.4314880952380952, 'recall': 0.515539435317545, 'f1-score': 0.4697838696088915, 'support': 14061}, '1': {'precision': 0.4430024552788495, 'recall': 0.42880423711550214, 'f1-score': 0.4357877303153681, 'support': 14727}, '2': {'precision': 0.4502150181938472, 'recall': 0.37913503725886205, 'f1-score': 0.4116290499414011, 'support': 14359}, 'accuracy': 0.4405404779011287, 'macro avg': {'precision': 0.44156852290359727, 'recall': 0.44115956989730304, 'f1-score': 0.4390668832885536, 'support': 43147}, 'weighted avg': {'precision': 0.4416503745864122, 'recall': 0.4405404779011287, 'f1-score': 0.43882676485117456, 'support': 43147}}
[[7249 3893 2919]
 [4683 6315 3729]
 [4868 4047 5444]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0715533
{'0': {'precision': 0.4286205316223648, 'recall': 0.5126413155190134, 'f1-score': 0.46688090855199527, 'support': 14595}, '1': {'precision': 0.39612543343886625, 'recall': 0.3866813833701251, 'f1-score': 0.3913464402740542, 'support': 13590}, '2': {'precision': 0.4494164989939638, 'recall': 0.3732121374147841, 'f1-score': 0.4077847153759083, 'support': 14962}, 'accuracy': 0.42461816580527034, 'macro avg': {'precision': 0.42472082135173156, 'recall': 0.4241782787679742, 'f1-score': 0.42200402140065263, 'support': 43147}, 'weighted avg': {'precision': 0.4255969350687253, 'recall': 0.42461816580527034, 'f1-score': 0.4225971653902961, 'support': 43147}}
[[7482 3931 3182]
 [4676 5255 3659]
 [5298 4080 5584]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0849375
{'0': {'precision': 0.40028837622005325, 'recall': 0.49885963093510266, 'f1-score': 0.4441709485861974, 'support': 14469}, '1': {'precision': 0.37402555653781244, 'recall': 0.33690458954683655, 'f1-score': 0.3544959439387592, 'support': 13814}, '2': {'precision': 0.4275568181818182, 'recall': 0.3645048439181916, 'f1-score': 0.39352120859965134, 'support': 14864}, 'accuracy': 0.40072310937029226, 'macro avg': {'precision': 0.40062358364656125, 'recall': 0.4000896881333769, 'f1-score': 0.3973960337082027, 'support': 43147}, 'weighted avg': {'precision': 0.40127392632154807, 'recall': 0.40072310937029226, 'f1-score': 0.398011812392262, 'support': 43147}}
[[7218 3870 3381]
 [5287 4654 3873]
 [5527 3919 5418]]
training model: results/XRAY/W6/deepOF_L1/seq2seq
Epoch 1/50
512/512 - 19s - loss: 13.0860 - accuracy10: 0.4085 - accuracy20: 0.3978 - accuracy30: 0.3890 - accuracy50: 0.3762 - val_loss: 13.0279 - val_accuracy10: 0.4234 - val_accuracy20: 0.4003 - val_accuracy30: 0.3911 - val_accuracy50: 0.3824 - 19s/epoch - 36ms/step
Epoch 2/50
512/512 - 13s - loss: 12.9536 - accuracy10: 0.4288 - accuracy20: 0.4134 - accuracy30: 0.4032 - accuracy50: 0.3884 - val_loss: 12.9882 - val_accuracy10: 0.4285 - val_accuracy20: 0.4059 - val_accuracy30: 0.3992 - val_accuracy50: 0.3893 - 13s/epoch - 26ms/step
Epoch 3/50
512/512 - 13s - loss: 12.9059 - accuracy10: 0.4316 - accuracy20: 0.4171 - accuracy30: 0.4069 - accuracy50: 0.3922 - val_loss: 12.9651 - val_accuracy10: 0.4272 - val_accuracy20: 0.4091 - val_accuracy30: 0.4009 - val_accuracy50: 0.3898 - 13s/epoch - 26ms/step
Epoch 4/50
512/512 - 13s - loss: 12.8874 - accuracy10: 0.4329 - accuracy20: 0.4165 - accuracy30: 0.4076 - accuracy50: 0.3940 - val_loss: 12.9545 - val_accuracy10: 0.4313 - val_accuracy20: 0.4106 - val_accuracy30: 0.4046 - val_accuracy50: 0.3933 - 13s/epoch - 26ms/step
Epoch 5/50
512/512 - 13s - loss: 12.8648 - accuracy10: 0.4357 - accuracy20: 0.4201 - accuracy30: 0.4113 - accuracy50: 0.3970 - val_loss: 12.9432 - val_accuracy10: 0.4298 - val_accuracy20: 0.4123 - val_accuracy30: 0.4063 - val_accuracy50: 0.3952 - 13s/epoch - 26ms/step
Epoch 6/50
512/512 - 13s - loss: 12.8499 - accuracy10: 0.4349 - accuracy20: 0.4201 - accuracy30: 0.4118 - accuracy50: 0.3974 - val_loss: 12.9247 - val_accuracy10: 0.4327 - val_accuracy20: 0.4161 - val_accuracy30: 0.4071 - val_accuracy50: 0.3968 - 13s/epoch - 26ms/step
Epoch 7/50
512/512 - 13s - loss: 12.8323 - accuracy10: 0.4377 - accuracy20: 0.4227 - accuracy30: 0.4143 - accuracy50: 0.4001 - val_loss: 12.9294 - val_accuracy10: 0.4318 - val_accuracy20: 0.4119 - val_accuracy30: 0.4064 - val_accuracy50: 0.3965 - 13s/epoch - 26ms/step
Epoch 8/50
512/512 - 13s - loss: 12.8208 - accuracy10: 0.4373 - accuracy20: 0.4232 - accuracy30: 0.4149 - accuracy50: 0.4001 - val_loss: 12.9202 - val_accuracy10: 0.4324 - val_accuracy20: 0.4147 - val_accuracy30: 0.4123 - val_accuracy50: 0.3971 - 13s/epoch - 25ms/step
Epoch 9/50
512/512 - 13s - loss: 12.8100 - accuracy10: 0.4401 - accuracy20: 0.4256 - accuracy30: 0.4166 - accuracy50: 0.4024 - val_loss: 12.9272 - val_accuracy10: 0.4309 - val_accuracy20: 0.4155 - val_accuracy30: 0.4086 - val_accuracy50: 0.3948 - 13s/epoch - 26ms/step
Epoch 10/50
512/512 - 13s - loss: 12.7962 - accuracy10: 0.4405 - accuracy20: 0.4257 - accuracy30: 0.4182 - accuracy50: 0.4034 - val_loss: 12.9215 - val_accuracy10: 0.4324 - val_accuracy20: 0.4155 - val_accuracy30: 0.4099 - val_accuracy50: 0.3975 - 13s/epoch - 25ms/step
Epoch 11/50
512/512 - 13s - loss: 12.7859 - accuracy10: 0.4426 - accuracy20: 0.4273 - accuracy30: 0.4197 - accuracy50: 0.4043 - val_loss: 12.9326 - val_accuracy10: 0.4305 - val_accuracy20: 0.4135 - val_accuracy30: 0.4073 - val_accuracy50: 0.3951 - 13s/epoch - 25ms/step
Epoch 12/50
512/512 - 14s - loss: 12.7797 - accuracy10: 0.4427 - accuracy20: 0.4287 - accuracy30: 0.4206 - accuracy50: 0.4039 - val_loss: 12.9196 - val_accuracy10: 0.4315 - val_accuracy20: 0.4168 - val_accuracy30: 0.4120 - val_accuracy50: 0.3979 - 14s/epoch - 27ms/step
Epoch 13/50
512/512 - 13s - loss: 12.7642 - accuracy10: 0.4437 - accuracy20: 0.4299 - accuracy30: 0.4232 - accuracy50: 0.4080 - val_loss: 12.9152 - val_accuracy10: 0.4317 - val_accuracy20: 0.4172 - val_accuracy30: 0.4107 - val_accuracy50: 0.3985 - 13s/epoch - 26ms/step
Epoch 14/50
512/512 - 13s - loss: 12.7539 - accuracy10: 0.4447 - accuracy20: 0.4315 - accuracy30: 0.4233 - accuracy50: 0.4086 - val_loss: 12.9248 - val_accuracy10: 0.4330 - val_accuracy20: 0.4158 - val_accuracy30: 0.4100 - val_accuracy50: 0.3960 - 13s/epoch - 26ms/step
Epoch 15/50
512/512 - 13s - loss: 12.7403 - accuracy10: 0.4469 - accuracy20: 0.4339 - accuracy30: 0.4256 - accuracy50: 0.4106 - val_loss: 12.9256 - val_accuracy10: 0.4298 - val_accuracy20: 0.4167 - val_accuracy30: 0.4077 - val_accuracy50: 0.3953 - 13s/epoch - 26ms/step
Epoch 16/50
512/512 - 13s - loss: 12.7323 - accuracy10: 0.4470 - accuracy20: 0.4349 - accuracy30: 0.4272 - accuracy50: 0.4125 - val_loss: 12.9269 - val_accuracy10: 0.4329 - val_accuracy20: 0.4171 - val_accuracy30: 0.4104 - val_accuracy50: 0.3960 - 13s/epoch - 25ms/step
Epoch 17/50
512/512 - 13s - loss: 12.7174 - accuracy10: 0.4478 - accuracy20: 0.4366 - accuracy30: 0.4287 - accuracy50: 0.4137 - val_loss: 12.9337 - val_accuracy10: 0.4311 - val_accuracy20: 0.4158 - val_accuracy30: 0.4103 - val_accuracy50: 0.3932 - 13s/epoch - 26ms/step
Epoch 18/50
512/512 - 14s - loss: 12.7089 - accuracy10: 0.4492 - accuracy20: 0.4380 - accuracy30: 0.4310 - accuracy50: 0.4144 - val_loss: 12.9422 - val_accuracy10: 0.4313 - val_accuracy20: 0.4180 - val_accuracy30: 0.4092 - val_accuracy50: 0.3948 - 14s/epoch - 27ms/step
Epoch 19/50
512/512 - 13s - loss: 12.6947 - accuracy10: 0.4519 - accuracy20: 0.4404 - accuracy30: 0.4322 - accuracy50: 0.4166 - val_loss: 12.9547 - val_accuracy10: 0.4317 - val_accuracy20: 0.4186 - val_accuracy30: 0.4112 - val_accuracy50: 0.3937 - 13s/epoch - 26ms/step
Epoch 20/50
512/512 - 14s - loss: 12.6824 - accuracy10: 0.4510 - accuracy20: 0.4409 - accuracy30: 0.4330 - accuracy50: 0.4188 - val_loss: 12.9588 - val_accuracy10: 0.4320 - val_accuracy20: 0.4172 - val_accuracy30: 0.4091 - val_accuracy50: 0.3957 - 14s/epoch - 26ms/step
Epoch 21/50
512/512 - 13s - loss: 12.6728 - accuracy10: 0.4524 - accuracy20: 0.4410 - accuracy30: 0.4341 - accuracy50: 0.4190 - val_loss: 12.9672 - val_accuracy10: 0.4298 - val_accuracy20: 0.4135 - val_accuracy30: 0.4067 - val_accuracy50: 0.3914 - 13s/epoch - 26ms/step
Epoch 22/50
512/512 - 13s - loss: 12.6570 - accuracy10: 0.4533 - accuracy20: 0.4443 - accuracy30: 0.4370 - accuracy50: 0.4222 - val_loss: 12.9672 - val_accuracy10: 0.4335 - val_accuracy20: 0.4178 - val_accuracy30: 0.4087 - val_accuracy50: 0.3929 - 13s/epoch - 25ms/step
Epoch 23/50
512/512 - 14s - loss: 12.6471 - accuracy10: 0.4540 - accuracy20: 0.4440 - accuracy30: 0.4381 - accuracy50: 0.4235 - val_loss: 12.9925 - val_accuracy10: 0.4311 - val_accuracy20: 0.4167 - val_accuracy30: 0.4075 - val_accuracy50: 0.3906 - 14s/epoch - 27ms/step
testing model: results/XRAY/W6/deepOF_L1/seq2seq
Evaluating performance on  test set...
1214/1214 - 16s - 16s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0860342
{'0': {'precision': 0.3918060840782689, 'recall': 0.38089661361994614, 'f1-score': 0.3862743356938309, 'support': 91366}, '1': {'precision': 0.4643162661252609, 'recall': 0.31805361314467423, 'f1-score': 0.3775131686326878, 'support': 127991}, '2': {'precision': 0.3555891711439153, 'recall': 0.522461268954946, 'f1-score': 0.42316833087987515, 'support': 91335}, 'accuracy': 0.3966243096056545, 'macro avg': {'precision': 0.40390384044914834, 'recall': 0.4071371652398555, 'f1-score': 0.395651945068798, 'support': 310692}, 'weighted avg': {'precision': 0.4110301998183503, 'recall': 0.3966243096056545, 'f1-score': 0.3935109639848541, 'support': 310692}}
[[34801 24365 32200]
 [33005 40708 54278]
 [21016 22600 47719]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0816431
{'0': {'precision': 0.4467669951057545, 'recall': 0.37535209354140436, 'f1-score': 0.40795775029162334, 'support': 110411}, '1': {'precision': 0.3195968232845878, 'recall': 0.2501717603776512, 'f1-score': 0.28065464535899204, 'support': 90242}, '2': {'precision': 0.4124216686695046, 'recall': 0.5520406401366789, 'f1-score': 0.47212528659697667, 'support': 110039}, 'accuracy': 0.40157133109317267, 'macro avg': {'precision': 0.39292849568661564, 'recall': 0.3925214980185781, 'f1-score': 0.3869125607491974, 'support': 310692}, 'weighted avg': {'precision': 0.39766558270632285, 'recall': 0.40157133109317267, 'f1-score': 0.393708412465655, 'support': 310692}}
[[41443 25265 43703]
 [24824 22576 42842]
 [26495 22798 60746]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0791656
{'0': {'precision': 0.46157716397987475, 'recall': 0.3884131852939906, 'f1-score': 0.42184633431085045, 'support': 115735}, '1': {'precision': 0.27765928568658627, 'recall': 0.17699990111737368, 'f1-score': 0.21618683856942286, 'support': 80904}, '2': {'precision': 0.42444103680253265, 'recall': 0.6018605385215645, 'f1-score': 0.49781529546995623, 'support': 114053}, 'accuracy': 0.411716426557491, 'macro avg': {'precision': 0.38789249548966453, 'recall': 0.38909120831097627, 'f1-score': 0.37861615611674315, 'support': 310692}, 'weighted avg': {'precision': 0.40005263570622235, 'recall': 0.411716426557491, 'f1-score': 0.3961804403825067, 'support': 310692}}
[[44953 19972 50810]
 [24310 14320 42274]
 [28127 17282 68644]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0822666
{'0': {'precision': 0.4513112460995197, 'recall': 0.4034805421950153, 'f1-score': 0.42605768742410455, 'support': 114350}, '1': {'precision': 0.2718036324402086, 'recall': 0.10813678964061718, 'f1-score': 0.154718848096083, 'support': 83866}, '2': {'precision': 0.4157514492132842, 'recall': 0.6472136277961521, 'f1-score': 0.5062819268980531, 'support': 112476}, 'accuracy': 0.4119932280200327, 'macro avg': {'precision': 0.37962210925100415, 'recall': 0.3862769865439282, 'f1-score': 0.36235282080608017, 'support': 310692}, 'weighted avg': {'precision': 0.3899829555682926, 'recall': 0.4119932280200327, 'f1-score': 0.3818569949698025, 'support': 310692}}
[[46138 13021 55191]
 [27689  9069 47108]
 [28404 11276 72796]]
Evaluating performance on  train set...
512/512 - 6s - 6s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0551642
{'0': {'precision': 0.38787760796910997, 'recall': 0.337550121420907, 'f1-score': 0.3609680974740688, 'support': 35414}, '1': {'precision': 0.570188366881347, 'recall': 0.4642545986553351, 'f1-score': 0.511797325214744, 'support': 60833}, '2': {'precision': 0.3551472041098597, 'recall': 0.5177887246852764, 'f1-score': 0.4213166438123366, 'support': 34713}, 'accuracy': 0.44418142944410505, 'macro avg': {'precision': 0.4377377263201056, 'recall': 0.43986448158717284, 'f1-score': 0.4313606888337165, 'support': 130960}, 'weighted avg': {'precision': 0.46388814468063994, 'recall': 0.44418142944410505, 'f1-score': 0.44702699713952987, 'support': 130960}}
[[11954 11464 11996]
 [11951 28242 20640]
 [ 6914  9825 17974]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.065118
{'0': {'precision': 0.44638680290533056, 'recall': 0.3358029264678644, 'f1-score': 0.38327783943766186, 'support': 43192}, '1': {'precision': 0.4444208289054198, 'recall': 0.411893453566504, 'f1-score': 0.4275393597928074, 'support': 45689}, '2': {'precision': 0.4032036776366196, 'recall': 0.5377741866489223, 'f1-score': 0.46086637746685405, 'support': 42079}, 'accuracy': 0.4272449602932193, 'macro avg': {'precision': 0.43133710314912327, 'recall': 0.4284901888944302, 'f1-score': 0.42389452556577445, 'support': 130960}, 'weighted avg': {'precision': 0.4318256688623861, 'recall': 0.4272449602932193, 'f1-score': 0.4236498056505255, 'support': 130960}}
[[14504 12580 16108]
 [ 9484 18819 17386]
 [ 8504 10946 22629]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0708338
{'0': {'precision': 0.4484873025973275, 'recall': 0.35036265449533405, 'f1-score': 0.3933985361088912, 'support': 44257}, '1': {'precision': 0.4131361617125309, 'recall': 0.32026717821896594, 'f1-score': 0.3608217893969378, 'support': 43267}, '2': {'precision': 0.4025936828705545, 'recall': 0.5824891794824569, 'f1-score': 0.47611520403458757, 'support': 43436}, 'accuracy': 0.41740989615149665, 'macro avg': {'precision': 0.4214057157268043, 'recall': 0.41770633739891894, 'f1-score': 0.4101118431801389, 'support': 130960}, 'weighted avg': {'precision': 0.4215861642412294, 'recall': 0.41740989615149665, 'f1-score': 0.4100706733113535, 'support': 130960}}
[[15506 10575 18176]
 [10042 13857 19368]
 [ 9026  9109 25301]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0782946
{'0': {'precision': 0.43591623889839487, 'recall': 0.3592854584527221, 'f1-score': 0.3939085297762943, 'support': 44672}, '1': {'precision': 0.38809875501160584, 'recall': 0.21537812961097969, 'f1-score': 0.27702132787082784, 'support': 42697}, '2': {'precision': 0.3899014848252562, 'recall': 0.6301071322061893, 'f1-score': 0.4817208449889071, 'support': 43591}, 'accuracy': 0.4025122174709835, 'macro avg': {'precision': 0.4046388262450857, 'recall': 0.40159024008996375, 'f1-score': 0.38421690087867644, 'support': 130960}, 'weighted avg': {'precision': 0.4050099144152212, 'recall': 0.4025122174709835, 'f1-score': 0.38502867159574533, 'support': 130960}}
[[16050  7897 20725]
 [11247  9196 22254]
 [ 9522  6602 27467]]
Evaluating performance on  val set...
169/169 - 2s - 2s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0650747
{'0': {'precision': 0.378070450506951, 'recall': 0.31237585283703256, 'f1-score': 0.3420977962735269, 'support': 11579}, '1': {'precision': 0.5547599775854555, 'recall': 0.4497728419989904, 'f1-score': 0.49678012879484823, 'support': 19810}, '2': {'precision': 0.3436465349925791, 'recall': 0.5120353831759803, 'f1-score': 0.41127241673783094, 'support': 11757}, 'accuracy': 0.429866036249015, 'macro avg': {'precision': 0.4254923210283285, 'recall': 0.4247280260040011, 'f1-score': 0.4167167806020687, 'support': 43146}, 'weighted avg': {'precision': 0.4498151674383631, 'recall': 0.429866036249015, 'f1-score': 0.43196807440003226, 'support': 43146}}
[[3617 3720 4242]
 [3644 8910 7256]
 [2306 3431 6020]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0733554
{'0': {'precision': 0.43072973239853857, 'recall': 0.30955929316585057, 'f1-score': 0.36022792963911143, 'support': 14091}, '1': {'precision': 0.42938144329896905, 'recall': 0.398156367360874, 'f1-score': 0.41317980513728964, 'support': 14645}, '2': {'precision': 0.4011008796748804, 'recall': 0.5410825815405969, 'f1-score': 0.4606930780820704, 'support': 14410}, 'accuracy': 0.4169563806610114, 'macro avg': {'precision': 0.42040401845746267, 'recall': 0.41626608068910714, 'f1-score': 0.41136693761949045, 'support': 43146}, 'weighted avg': {'precision': 0.42037657192917616, 'recall': 0.4169563806610114, 'f1-score': 0.41175490793915914, 'support': 43146}}
[[4362 4016 5713]
 [2885 5831 5929]
 [2880 3733 7797]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0784181
{'0': {'precision': 0.43571296808706883, 'recall': 0.3231853321474995, 'f1-score': 0.3711064849365647, 'support': 14617}, '1': {'precision': 0.39503492542948837, 'recall': 0.308582804896033, 'f1-score': 0.3464977645305514, 'support': 13562}, '2': {'precision': 0.4041916167664671, 'recall': 0.5862898376428142, 'f1-score': 0.4785015132099136, 'support': 14967}, 'accuracy': 0.4098641820794512, 'macro avg': {'precision': 0.4116465034276748, 'recall': 0.4060193248954489, 'f1-score': 0.39870192089234324, 'support': 43146}, 'weighted avg': {'precision': 0.4119922134461391, 'recall': 0.4098641820794512, 'f1-score': 0.40062574331557693, 'support': 43146}}
[[4724 3347 6546]
 [2988 4185 6389]
 [3130 3062 8775]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0845335
{'0': {'precision': 0.4215720221606648, 'recall': 0.3373276996605943, 'f1-score': 0.3747739428219631, 'support': 14437}, '1': {'precision': 0.37843378433784336, 'recall': 0.19926597582037997, 'f1-score': 0.26106632725215667, 'support': 13896}, '2': {'precision': 0.38835111422333896, 'recall': 0.6364679673259974, 'f1-score': 0.4823740086978767, 'support': 14813}, 'accuracy': 0.3955638993185927, 'macro avg': {'precision': 0.39611897357394904, 'recall': 0.3910205476023239, 'f1-score': 0.3727380929239988, 'support': 43146}, 'weighted avg': {'precision': 0.3962730312446695, 'recall': 0.3955638993185927, 'f1-score': 0.37509375809711903, 'support': 43146}}
[[4870 2435 7132]
 [3410 2769 7717]
 [3272 2113 9428]]
training model: results/XRAY/W6/deepLOB_L2/seq2seq
Epoch 1/50
512/512 - 33s - loss: 13.1390 - accuracy10: 0.3848 - accuracy20: 0.3796 - accuracy30: 0.3778 - accuracy50: 0.3680 - val_loss: 13.5792 - val_accuracy10: 0.4137 - val_accuracy20: 0.3515 - val_accuracy30: 0.3387 - val_accuracy50: 0.3404 - 33s/epoch - 64ms/step
Epoch 2/50
512/512 - 26s - loss: 12.9082 - accuracy10: 0.4022 - accuracy20: 0.4132 - accuracy30: 0.4078 - accuracy50: 0.3939 - val_loss: 13.7652 - val_accuracy10: 0.4252 - val_accuracy20: 0.3531 - val_accuracy30: 0.3378 - val_accuracy50: 0.3347 - 26s/epoch - 51ms/step
Epoch 3/50
512/512 - 26s - loss: 12.7778 - accuracy10: 0.4172 - accuracy20: 0.4309 - accuracy30: 0.4259 - accuracy50: 0.4085 - val_loss: 12.9284 - val_accuracy10: 0.3988 - val_accuracy20: 0.4172 - val_accuracy30: 0.4110 - val_accuracy50: 0.3902 - 26s/epoch - 52ms/step
Epoch 4/50
512/512 - 27s - loss: 12.6962 - accuracy10: 0.4336 - accuracy20: 0.4418 - accuracy30: 0.4337 - accuracy50: 0.4133 - val_loss: 12.8851 - val_accuracy10: 0.4005 - val_accuracy20: 0.4226 - val_accuracy30: 0.4177 - val_accuracy50: 0.3973 - 27s/epoch - 52ms/step
Epoch 5/50
512/512 - 27s - loss: 12.6007 - accuracy10: 0.4536 - accuracy20: 0.4539 - accuracy30: 0.4419 - accuracy50: 0.4188 - val_loss: 12.8182 - val_accuracy10: 0.4113 - val_accuracy20: 0.4313 - val_accuracy30: 0.4248 - val_accuracy50: 0.4028 - 27s/epoch - 52ms/step
Epoch 6/50
512/512 - 27s - loss: 12.5406 - accuracy10: 0.4633 - accuracy20: 0.4604 - accuracy30: 0.4473 - accuracy50: 0.4232 - val_loss: 12.7750 - val_accuracy10: 0.4243 - val_accuracy20: 0.4392 - val_accuracy30: 0.4306 - val_accuracy50: 0.4070 - 27s/epoch - 52ms/step
Epoch 7/50
512/512 - 27s - loss: 12.4938 - accuracy10: 0.4686 - accuracy20: 0.4645 - accuracy30: 0.4517 - accuracy50: 0.4268 - val_loss: 12.7762 - val_accuracy10: 0.4223 - val_accuracy20: 0.4410 - val_accuracy30: 0.4322 - val_accuracy50: 0.4085 - 27s/epoch - 52ms/step
Epoch 8/50
512/512 - 26s - loss: 12.4491 - accuracy10: 0.4746 - accuracy20: 0.4694 - accuracy30: 0.4542 - accuracy50: 0.4286 - val_loss: 12.7860 - val_accuracy10: 0.4228 - val_accuracy20: 0.4406 - val_accuracy30: 0.4334 - val_accuracy50: 0.4090 - 26s/epoch - 52ms/step
Epoch 9/50
512/512 - 27s - loss: 12.4053 - accuracy10: 0.4790 - accuracy20: 0.4731 - accuracy30: 0.4572 - accuracy50: 0.4312 - val_loss: 12.8323 - val_accuracy10: 0.4196 - val_accuracy20: 0.4379 - val_accuracy30: 0.4313 - val_accuracy50: 0.4084 - 27s/epoch - 52ms/step
Epoch 10/50
512/512 - 26s - loss: 12.3643 - accuracy10: 0.4843 - accuracy20: 0.4773 - accuracy30: 0.4617 - accuracy50: 0.4350 - val_loss: 12.7890 - val_accuracy10: 0.4353 - val_accuracy20: 0.4428 - val_accuracy30: 0.4328 - val_accuracy50: 0.4084 - 26s/epoch - 51ms/step
Epoch 11/50
512/512 - 26s - loss: 12.3338 - accuracy10: 0.4863 - accuracy20: 0.4807 - accuracy30: 0.4654 - accuracy50: 0.4390 - val_loss: 12.8036 - val_accuracy10: 0.4329 - val_accuracy20: 0.4434 - val_accuracy30: 0.4339 - val_accuracy50: 0.4104 - 26s/epoch - 51ms/step
Epoch 12/50
512/512 - 27s - loss: 12.2947 - accuracy10: 0.4898 - accuracy20: 0.4844 - accuracy30: 0.4691 - accuracy50: 0.4418 - val_loss: 12.8096 - val_accuracy10: 0.4372 - val_accuracy20: 0.4465 - val_accuracy30: 0.4329 - val_accuracy50: 0.4090 - 27s/epoch - 52ms/step
Epoch 13/50
512/512 - 27s - loss: 12.2594 - accuracy10: 0.4926 - accuracy20: 0.4887 - accuracy30: 0.4737 - accuracy50: 0.4452 - val_loss: 12.8444 - val_accuracy10: 0.4312 - val_accuracy20: 0.4428 - val_accuracy30: 0.4318 - val_accuracy50: 0.4067 - 27s/epoch - 52ms/step
Epoch 14/50
512/512 - 27s - loss: 12.2284 - accuracy10: 0.4960 - accuracy20: 0.4909 - accuracy30: 0.4770 - accuracy50: 0.4488 - val_loss: 12.9113 - val_accuracy10: 0.4217 - val_accuracy20: 0.4381 - val_accuracy30: 0.4313 - val_accuracy50: 0.4073 - 27s/epoch - 52ms/step
Epoch 15/50
512/512 - 27s - loss: 12.1926 - accuracy10: 0.4984 - accuracy20: 0.4944 - accuracy30: 0.4793 - accuracy50: 0.4515 - val_loss: 13.0068 - val_accuracy10: 0.4229 - val_accuracy20: 0.4347 - val_accuracy30: 0.4245 - val_accuracy50: 0.4035 - 27s/epoch - 52ms/step
Epoch 16/50
512/512 - 26s - loss: 12.1704 - accuracy10: 0.4987 - accuracy20: 0.4958 - accuracy30: 0.4804 - accuracy50: 0.4516 - val_loss: 13.0042 - val_accuracy10: 0.4197 - val_accuracy20: 0.4356 - val_accuracy30: 0.4296 - val_accuracy50: 0.4062 - 26s/epoch - 52ms/step
testing model: results/XRAY/W6/deepLOB_L2/seq2seq
Evaluating performance on  test set...
1214/1214 - 25s - 25s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0570105
{'0': {'precision': 0.39267614570896614, 'recall': 0.5147591581205468, 'f1-score': 0.4455053518992138, 'support': 91367}, '1': {'precision': 0.49594946253367783, 'recall': 0.4213902322783277, 'f1-score': 0.4556398472611766, 'support': 127993}, '2': {'precision': 0.4226692465895124, 'recall': 0.38026210626580687, 'f1-score': 0.4003458013947323, 'support': 91337}, 'accuracy': 0.43675671152280193, 'macro avg': {'precision': 0.4370982849440521, 'recall': 0.43880383222156044, 'f1-score': 0.43383033351837424, 'support': 310697}, 'weighted avg': {'precision': 0.44403725153062445, 'recall': 0.43675671152280193, 'f1-score': 0.4364045450051527, 'support': 310697}}
[[47032 26684 17651]
 [44268 53935 29790]
 [28473 28132 34732]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0679209
{'0': {'precision': 0.44744749730223293, 'recall': 0.4882078034996196, 'f1-score': 0.4669398220736134, 'support': 110412}, '1': {'precision': 0.36342337503588396, 'recall': 0.43487655689020877, 'f1-score': 0.39595219718409336, 'support': 90244}, '2': {'precision': 0.47621595330739297, 'recall': 0.35590370861769705, 'f1-score': 0.4073621418652909, 'support': 110041}, 'accuracy': 0.42585863397457974, 'macro avg': {'precision': 0.42902894188183655, 'recall': 0.42632935633584185, 'f1-score': 0.4234180537076659, 'support': 310697}, 'weighted avg': {'precision': 0.4332311925984843, 'recall': 0.42585863397457974, 'f1-score': 0.425220092792887, 'support': 310697}}
[[53904 33879 22629]
 [30552 39245 20447]
 [36014 34863 39164]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0763816
{'0': {'precision': 0.4533430690851159, 'recall': 0.4720702973120091, 'f1-score': 0.46251719540327185, 'support': 115737}, '1': {'precision': 0.32270778978755127, 'recall': 0.428069958593412, 'f1-score': 0.3679957497675655, 'support': 80905}, '2': {'precision': 0.47345490532108764, 'recall': 0.3439568629170137, 'f1-score': 0.39844805346496437, 'support': 114055}, 'accuracy': 0.41358300852599156, 'macro avg': {'precision': 0.41650192139791825, 'recall': 0.4146990396074783, 'f1-score': 0.4096536662119339, 'support': 310697}, 'weighted avg': {'precision': 0.42670878619961744, 'recall': 0.41358300852599156, 'f1-score': 0.4143845660475636, 'support': 310697}}
[[54636 36332 24769]
 [27412 34633 18860]
 [38470 36355 39230]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0905666
{'0': {'precision': 0.4279948068376637, 'recall': 0.44972540926262766, 'f1-score': 0.4385911048569357, 'support': 114352}, '1': {'precision': 0.3095663961741946, 'recall': 0.3921016860229414, 'f1-score': 0.3459798413399828, 'support': 83866}, '2': {'precision': 0.44685872878441046, 'recall': 0.33496030370113533, 'f1-score': 0.3829017439733322, 'support': 112479}, 'accuracy': 0.39262368159332084, 'macro avg': {'precision': 0.3948066439320896, 'recall': 0.39226246632890144, 'f1-score': 0.3891575633900836, 'support': 310697}, 'weighted avg': {'precision': 0.40285673980755277, 'recall': 0.39262368159332084, 'f1-score': 0.3934319309706748, 'support': 310697}}
[[51427 37203 25722]
 [30067 32884 20915]
 [38664 36139 37676]]
Evaluating performance on  train set...
512/512 - 10s - 10s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0581912
{'0': {'precision': 0.3654206775846981, 'recall': 0.5791723278985508, 'f1-score': 0.44811160631180125, 'support': 35328}, '1': {'precision': 0.5996197162498171, 'recall': 0.33636363636363636, 'f1-score': 0.430969776609724, 'support': 60940}, '2': {'precision': 0.40324162620764065, 'recall': 0.47402859448864293, 'f1-score': 0.4357792087341336, 'support': 34692}, 'accuracy': 0.4383323152107514, 'macro avg': {'precision': 0.45609400668071864, 'recall': 0.4631881862502767, 'f1-score': 0.4382868638852196, 'support': 130960}, 'weighted avg': {'precision': 0.4844201718262946, 'recall': 0.4383323152107514, 'f1-score': 0.43686803087801207, 'support': 130960}}
[[20461  6715  8152]
 [24257 20498 16185]
 [11275  6972 16445]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.053966
{'0': {'precision': 0.4224534365511976, 'recall': 0.5517601224433004, 'f1-score': 0.4785253864022606, 'support': 43122}, '1': {'precision': 0.47091966015799674, 'recall': 0.3458641677978719, 'f1-score': 0.3988184652671708, 'support': 45674}, '2': {'precision': 0.4528154961794909, 'recall': 0.4413243525282231, 'f1-score': 0.4469960844603521, 'support': 42164}, 'accuracy': 0.4443952351863164, 'macro avg': {'precision': 0.44872953096289514, 'recall': 0.4463162142564651, 'f1-score': 0.44144664537659456, 'support': 130960}, 'weighted avg': {'precision': 0.44913205734521333, 'recall': 0.4443952351863164, 'f1-score': 0.4405753604172062, 'support': 130960}}
[[23793  8709 10620]
 [18011 15797 11866]
 [14517  9039 18608]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0621526
{'0': {'precision': 0.4221899207629447, 'recall': 0.5377754696531792, 'f1-score': 0.47302410105162807, 'support': 44288}, '1': {'precision': 0.43634714242515876, 'recall': 0.3334642848889608, 'f1-score': 0.3780307297329159, 'support': 43273}, '2': {'precision': 0.4480796586059744, 'recall': 0.428235673633033, 'f1-score': 0.43793298458928315, 'support': 43399}, 'accuracy': 0.43396456933414784, 'macro avg': {'precision': 0.43553890726469263, 'recall': 0.43315847605839103, 'f1-score': 0.4296626051246091, 'support': 130960}, 'weighted avg': {'precision': 0.4354475122843148, 'recall': 0.43396456933414784, 'f1-score': 0.43000663373012576, 'support': 130960}}
[[23817  9218 11253]
 [17204 14430 11639]
 [15392  9422 18585]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0774008
{'0': {'precision': 0.4099060631938514, 'recall': 0.5154823697870056, 'f1-score': 0.4566716879410132, 'support': 44696}, '1': {'precision': 0.40087593029309976, 'recall': 0.30699408950182944, 'f1-score': 0.34770943190723497, 'support': 42636}, '2': {'precision': 0.42654568775088475, 'recall': 0.41161639314201887, 'f1-score': 0.4189480805795005, 'support': 43628}, 'accuracy': 0.41300397067806965, 'macro avg': {'precision': 0.412442560412612, 'recall': 0.411364284143618, 'f1-score': 0.40777640014258293, 'support': 130960}, 'weighted avg': {'precision': 0.4125094901472555, 'recall': 0.41300397067806965, 'f1-score': 0.40863014632354033, 'support': 130960}}
[[23040  9788 11868]
 [17272 13089 12275]
 [15896  9774 17958]]
Evaluating performance on  val set...
169/169 - 3s - 3s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0740451
{'0': {'precision': 0.35667439222841363, 'recall': 0.6248812095032398, 'f1-score': 0.454134488604257, 'support': 11575}, '1': {'precision': 0.6144418681682676, 'recall': 0.280183264525224, 'f1-score': 0.38486807980912197, 'support': 19862}, '2': {'precision': 0.3980884801969445, 'recall': 0.4695132365499573, 'f1-score': 0.43086085968418164, 'support': 11710}, 'accuracy': 0.4240387512457413, 'macro avg': {'precision': 0.4564015801978752, 'recall': 0.45819257019280707, 'f1-score': 0.4232878093658535, 'support': 43147}, 'weighted avg': {'precision': 0.486573031235271, 'recall': 0.4240387512457413, 'f1-score': 0.4159324442873159, 'support': 43147}}
[[7233 1698 2644]
 [8628 5565 5669]
 [4418 1794 5498]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0604467
{'0': {'precision': 0.4108105459178673, 'recall': 0.5961880378351468, 'f1-score': 0.4864363013897351, 'support': 14061}, '1': {'precision': 0.4837905236907731, 'recall': 0.28980783594757925, 'f1-score': 0.36247823686780756, 'support': 14727}, '2': {'precision': 0.4532653207845391, 'recall': 0.4393760011142837, 'f1-score': 0.44621260343730107, 'support': 14359}, 'accuracy': 0.4394280019468329, 'macro avg': {'precision': 0.44928879679772654, 'recall': 0.44179062496566995, 'f1-score': 0.4317090472316146, 'support': 43147}, 'weighted avg': {'precision': 0.44984881613299516, 'recall': 0.4394280019468329, 'f1-score': 0.4307405984413626, 'support': 43147}}
[[8383 2218 3460]
 [6309 4268 4150]
 [5714 2336 6309]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0669305
{'0': {'precision': 0.4115431645879188, 'recall': 0.5764988009592326, 'f1-score': 0.4802511415525114, 'support': 14595}, '1': {'precision': 0.4351180195739781, 'recall': 0.2780721118469463, 'f1-score': 0.339304152637486, 'support': 13590}, '2': {'precision': 0.4523792537632874, 'recall': 0.42380697767678116, 'f1-score': 0.4376272473170227, 'support': 14962}, 'accuracy': 0.4295547778524579, 'macro avg': {'precision': 0.4330134793083948, 'recall': 0.42612596349432, 'f1-score': 0.4190608471690067, 'support': 43147}, 'weighted avg': {'precision': 0.43312918089270036, 'recall': 0.4295547778524579, 'f1-score': 0.4210764994011086, 'support': 43147}}
[[8414 2399 3782]
 [5917 3779 3894]
 [6114 2507 6341]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0821242
{'0': {'precision': 0.3906311250490004, 'recall': 0.5509710415370793, 'f1-score': 0.45714941078647825, 'support': 14469}, '1': {'precision': 0.4077816492450639, 'recall': 0.2541624438974953, 'f1-score': 0.3131466286122012, 'support': 13814}, '2': {'precision': 0.4281265482341284, 'recall': 0.4069564047362756, 'f1-score': 0.4172731348946297, 'support': 14864}, 'accuracy': 0.40633184230653346, 'macro avg': {'precision': 0.40884644084273086, 'recall': 0.40402996339028335, 'f1-score': 0.39585639143110307, 'support': 43147}, 'weighted avg': {'precision': 0.4090391096474235, 'recall': 0.40633184230653346, 'f1-score': 0.39730804527295704, 'support': 43147}}
[[7972 2534 3963]
 [6186 3511 4117]
 [6250 2565 6049]]
training model: results/XRAY/W6/deepOF_L2/seq2seq
Epoch 1/50
512/512 - 24s - loss: 13.0243 - accuracy10: 0.4166 - accuracy20: 0.4016 - accuracy30: 0.3897 - accuracy50: 0.3733 - val_loss: 12.8368 - val_accuracy10: 0.4269 - val_accuracy20: 0.4266 - val_accuracy30: 0.4151 - val_accuracy50: 0.3931 - 24s/epoch - 46ms/step
Epoch 2/50
512/512 - 17s - loss: 12.7303 - accuracy10: 0.4580 - accuracy20: 0.4402 - accuracy30: 0.4241 - accuracy50: 0.4003 - val_loss: 12.7337 - val_accuracy10: 0.4430 - val_accuracy20: 0.4377 - val_accuracy30: 0.4212 - val_accuracy50: 0.4004 - 17s/epoch - 33ms/step
Epoch 3/50
512/512 - 17s - loss: 12.6152 - accuracy10: 0.4697 - accuracy20: 0.4528 - accuracy30: 0.4355 - accuracy50: 0.4100 - val_loss: 12.6954 - val_accuracy10: 0.4515 - val_accuracy20: 0.4436 - val_accuracy30: 0.4248 - val_accuracy50: 0.4024 - 17s/epoch - 34ms/step
Epoch 4/50
512/512 - 17s - loss: 12.5317 - accuracy10: 0.4773 - accuracy20: 0.4615 - accuracy30: 0.4439 - accuracy50: 0.4176 - val_loss: 12.6369 - val_accuracy10: 0.4603 - val_accuracy20: 0.4528 - val_accuracy30: 0.4329 - val_accuracy50: 0.4050 - 17s/epoch - 34ms/step
Epoch 5/50
512/512 - 18s - loss: 12.4469 - accuracy10: 0.4863 - accuracy20: 0.4698 - accuracy30: 0.4527 - accuracy50: 0.4242 - val_loss: 12.5742 - val_accuracy10: 0.4645 - val_accuracy20: 0.4592 - val_accuracy30: 0.4429 - val_accuracy50: 0.4123 - 18s/epoch - 34ms/step
Epoch 6/50
512/512 - 17s - loss: 12.3753 - accuracy10: 0.4919 - accuracy20: 0.4771 - accuracy30: 0.4593 - accuracy50: 0.4309 - val_loss: 12.4991 - val_accuracy10: 0.4614 - val_accuracy20: 0.4635 - val_accuracy30: 0.4469 - val_accuracy50: 0.4203 - 17s/epoch - 34ms/step
Epoch 7/50
512/512 - 17s - loss: 12.3142 - accuracy10: 0.4951 - accuracy20: 0.4826 - accuracy30: 0.4656 - accuracy50: 0.4367 - val_loss: 12.5047 - val_accuracy10: 0.4548 - val_accuracy20: 0.4629 - val_accuracy30: 0.4480 - val_accuracy50: 0.4206 - 17s/epoch - 33ms/step
Epoch 8/50
512/512 - 18s - loss: 12.2651 - accuracy10: 0.4971 - accuracy20: 0.4854 - accuracy30: 0.4688 - accuracy50: 0.4403 - val_loss: 12.4990 - val_accuracy10: 0.4547 - val_accuracy20: 0.4628 - val_accuracy30: 0.4488 - val_accuracy50: 0.4229 - 18s/epoch - 34ms/step
Epoch 9/50
512/512 - 18s - loss: 12.2242 - accuracy10: 0.4999 - accuracy20: 0.4896 - accuracy30: 0.4724 - accuracy50: 0.4438 - val_loss: 12.5218 - val_accuracy10: 0.4491 - val_accuracy20: 0.4606 - val_accuracy30: 0.4478 - val_accuracy50: 0.4194 - 18s/epoch - 34ms/step
Epoch 10/50
512/512 - 17s - loss: 12.1849 - accuracy10: 0.5024 - accuracy20: 0.4932 - accuracy30: 0.4781 - accuracy50: 0.4474 - val_loss: 12.4885 - val_accuracy10: 0.4572 - val_accuracy20: 0.4640 - val_accuracy30: 0.4497 - val_accuracy50: 0.4229 - 17s/epoch - 34ms/step
Epoch 11/50
512/512 - 17s - loss: 12.1474 - accuracy10: 0.5052 - accuracy20: 0.4961 - accuracy30: 0.4812 - accuracy50: 0.4509 - val_loss: 12.5014 - val_accuracy10: 0.4591 - val_accuracy20: 0.4633 - val_accuracy30: 0.4496 - val_accuracy50: 0.4214 - 17s/epoch - 33ms/step
Epoch 12/50
512/512 - 17s - loss: 12.0972 - accuracy10: 0.5078 - accuracy20: 0.5004 - accuracy30: 0.4850 - accuracy50: 0.4565 - val_loss: 12.5220 - val_accuracy10: 0.4545 - val_accuracy20: 0.4626 - val_accuracy30: 0.4494 - val_accuracy50: 0.4236 - 17s/epoch - 34ms/step
Epoch 13/50
512/512 - 17s - loss: 12.0596 - accuracy10: 0.5101 - accuracy20: 0.5036 - accuracy30: 0.4893 - accuracy50: 0.4593 - val_loss: 12.5923 - val_accuracy10: 0.4516 - val_accuracy20: 0.4574 - val_accuracy30: 0.4464 - val_accuracy50: 0.4210 - 17s/epoch - 33ms/step
Epoch 14/50
512/512 - 17s - loss: 12.0172 - accuracy10: 0.5111 - accuracy20: 0.5069 - accuracy30: 0.4924 - accuracy50: 0.4613 - val_loss: 12.5396 - val_accuracy10: 0.4586 - val_accuracy20: 0.4618 - val_accuracy30: 0.4499 - val_accuracy50: 0.4238 - 17s/epoch - 33ms/step
Epoch 15/50
512/512 - 17s - loss: 11.9853 - accuracy10: 0.5137 - accuracy20: 0.5095 - accuracy30: 0.4964 - accuracy50: 0.4663 - val_loss: 12.5870 - val_accuracy10: 0.4503 - val_accuracy20: 0.4594 - val_accuracy30: 0.4485 - val_accuracy50: 0.4215 - 17s/epoch - 33ms/step
Epoch 16/50
512/512 - 17s - loss: 11.9435 - accuracy10: 0.5141 - accuracy20: 0.5115 - accuracy30: 0.4989 - accuracy50: 0.4715 - val_loss: 12.6369 - val_accuracy10: 0.4540 - val_accuracy20: 0.4606 - val_accuracy30: 0.4492 - val_accuracy50: 0.4207 - 17s/epoch - 34ms/step
Epoch 17/50
512/512 - 17s - loss: 11.9096 - accuracy10: 0.5153 - accuracy20: 0.5159 - accuracy30: 0.5023 - accuracy50: 0.4733 - val_loss: 12.6301 - val_accuracy10: 0.4452 - val_accuracy20: 0.4570 - val_accuracy30: 0.4444 - val_accuracy50: 0.4177 - 17s/epoch - 33ms/step
Epoch 18/50
512/512 - 17s - loss: 11.8610 - accuracy10: 0.5173 - accuracy20: 0.5181 - accuracy30: 0.5060 - accuracy50: 0.4789 - val_loss: 12.6269 - val_accuracy10: 0.4490 - val_accuracy20: 0.4576 - val_accuracy30: 0.4464 - val_accuracy50: 0.4195 - 17s/epoch - 34ms/step
Epoch 19/50
512/512 - 17s - loss: 11.8173 - accuracy10: 0.5203 - accuracy20: 0.5228 - accuracy30: 0.5106 - accuracy50: 0.4825 - val_loss: 12.7219 - val_accuracy10: 0.4433 - val_accuracy20: 0.4537 - val_accuracy30: 0.4419 - val_accuracy50: 0.4146 - 17s/epoch - 33ms/step
Epoch 20/50
512/512 - 17s - loss: 11.7956 - accuracy10: 0.5200 - accuracy20: 0.5225 - accuracy30: 0.5127 - accuracy50: 0.4856 - val_loss: 12.7179 - val_accuracy10: 0.4438 - val_accuracy20: 0.4550 - val_accuracy30: 0.4441 - val_accuracy50: 0.4158 - 17s/epoch - 33ms/step
testing model: results/XRAY/W6/deepOF_L2/seq2seq
Evaluating performance on  test set...
1214/1214 - 18s - 18s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0386649
{'0': {'precision': 0.4365823838242698, 'recall': 0.4650854803756321, 'f1-score': 0.45038341892027967, 'support': 91366}, '1': {'precision': 0.6132583706580637, 'recall': 0.30595119969372847, 'f1-score': 0.4082358153717845, 'support': 127991}, '2': {'precision': 0.39600821366223654, 'recall': 0.6482290469152022, 'f1-score': 0.49165843166889495, 'support': 91335}, 'accuracy': 0.4533686094266991, 'macro avg': {'precision': 0.48194965604818996, 'recall': 0.4730885756615209, 'f1-score': 0.4500925553203197, 'support': 310692}, 'weighted avg': {'precision': 0.4974371673368636, 'recall': 0.4533686094266991, 'f1-score': 0.44515425100999984, 'support': 310692}}
[[42493 13161 35712]
 [34243 39159 54589]
 [20595 11534 59206]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0325387
{'0': {'precision': 0.4866220080698868, 'recall': 0.450027624059197, 'f1-score': 0.46760995487462303, 'support': 110411}, '1': {'precision': 0.4951022544584439, 'recall': 0.29348861948981625, 'f1-score': 0.3685228474425335, 'support': 90242}, '2': {'precision': 0.4498355793410278, 'recall': 0.6340024900262634, 'f1-score': 0.5262721165923004, 'support': 110039}, 'accuracy': 0.46971920744660306, 'macro avg': {'precision': 0.47718661395645284, 'recall': 0.4591729111917589, 'f1-score': 0.45413497296981903, 'support': 310692}, 'weighted avg': {'precision': 0.4760563435651723, 'recall': 0.46971920744660306, 'f1-score': 0.4596062304928072, 'support': 310692}}
[[49688 14470 46253]
 [24685 26485 39072]
 [27735 12539 69765]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.041443
{'0': {'precision': 0.4899206610018309, 'recall': 0.4508489221065365, 'f1-score': 0.46957343412527003, 'support': 115735}, '1': {'precision': 0.45016684229013, 'recall': 0.25346089192128946, 'f1-score': 0.32431833997596005, 'support': 80904}, '2': {'precision': 0.4512875468843572, 'recall': 0.627690635055632, 'f1-score': 0.5250689432611629, 'support': 114053}, 'accuracy': 0.46436663963024477, 'macro avg': {'precision': 0.463791683392106, 'recall': 0.4440001496944859, 'f1-score': 0.43965357245413106, 'support': 310692}, 'weighted avg': {'precision': 0.46538682841685397, 'recall': 0.46436663963024477, 'f1-score': 0.45212113785249897, 'support': 310692}}
[[52179 13475 50081]
 [23434 20506 36964]
 [30892 11571 71590]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0649498
{'0': {'precision': 0.46018972015366966, 'recall': 0.4420638390905116, 'f1-score': 0.4509447090938286, 'support': 114350}, '1': {'precision': 0.40521303988728563, 'recall': 0.19890062719099516, 'f1-score': 0.26682769211081964, 'support': 83866}, '2': {'precision': 0.432934619238477, 'recall': 0.6146288986094811, 'f1-score': 0.5080248093005483, 'support': 112476}, 'accuracy': 0.43889768645475263, 'macro avg': {'precision': 0.4327791264264775, 'recall': 0.4185311216303293, 'f1-score': 0.4085990701683988, 'support': 310692}, 'weighted avg': {'precision': 0.43548287544006975, 'recall': 0.43889768645475263, 'f1-score': 0.4219094703511316, 'support': 310692}}
[[50550 13330 50470]
 [27106 16681 40079]
 [32190 11155 69131]]
Evaluating performance on  train set...
512/512 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0065885
{'0': {'precision': 0.440444804093033, 'recall': 0.47644999152877393, 'f1-score': 0.4577404609145043, 'support': 35414}, '1': {'precision': 0.6688102893890675, 'recall': 0.393207634014433, 'f1-score': 0.49524834882709784, 'support': 60833}, '2': {'precision': 0.3935942059557712, 'recall': 0.6450033128799009, 'f1-score': 0.48886996582932135, 'support': 34713}, 'accuracy': 0.4824602932193036, 'macro avg': {'precision': 0.5009497664792906, 'recall': 0.5048869794743692, 'f1-score': 0.4806195918569745, 'support': 130960}, 'weighted avg': {'precision': 0.5341057139424137, 'recall': 0.4824602932193036, 'f1-score': 0.48341483361987114, 'support': 130960}}
[[16873  6476 12065]
 [14482 23920 22431]
 [ 6954  5369 22390]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0117414
{'0': {'precision': 0.4923425840120958, 'recall': 0.4674245230598259, 'f1-score': 0.4795600845625787, 'support': 43192}, '1': {'precision': 0.5542563762835376, 'recall': 0.36623694981286525, 'f1-score': 0.4410442942052478, 'support': 45689}, '2': {'precision': 0.44165383843116257, 'recall': 0.6272725112288791, 'f1-score': 0.5183468672368253, 'support': 42079}, 'accuracy': 0.48348350641417226, 'macro avg': {'precision': 0.4960842662422653, 'recall': 0.48697799470052344, 'f1-score': 0.47965041533488395, 'support': 130960}, 'weighted avg': {'precision': 0.49765601963969064, 'recall': 0.48348350641417226, 'f1-score': 0.4785854440808555, 'support': 130960}}
[[20189  7197 15806]
 [11393 16733 17563]
 [ 9424  6260 26395]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0286485
{'0': {'precision': 0.48017924853498795, 'recall': 0.4721287028040762, 'f1-score': 0.4761199471357608, 'support': 44257}, '1': {'precision': 0.5214347518288366, 'recall': 0.30642290891441515, 'f1-score': 0.38600730787707627, 'support': 43267}, '2': {'precision': 0.4389461294119544, 'recall': 0.6267381895202137, 'f1-score': 0.5162960504480584, 'support': 43436}, 'accuracy': 0.46866218692730605, 'macro avg': {'precision': 0.48018670992525964, 'recall': 0.468429933746235, 'f1-score': 0.4594744351536318, 'support': 130960}, 'weighted avg': {'precision': 0.48013343377312834, 'recall': 0.46866218692730605, 'f1-score': 0.45967359451410117, 'support': 130960}}
[[20895  6484 16878]
 [12091 13258 17918]
 [10529  5684 27223]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0545343
{'0': {'precision': 0.45568288888401953, 'recall': 0.46552650429799425, 'f1-score': 0.4605521044414178, 'support': 44672}, '1': {'precision': 0.46743139901034636, 'recall': 0.24336604445277185, 'f1-score': 0.3200825542532382, 'support': 42697}, '2': {'precision': 0.42118777043412103, 'recall': 0.609621252093322, 'f1-score': 0.4981815454988564, 'support': 43591}, 'accuracy': 0.44105833842394626, 'macro avg': {'precision': 0.4481006861094956, 'recall': 0.43950460028136273, 'f1-score': 0.4262720680645041, 'support': 130960}, 'weighted avg': {'precision': 0.44803131152081127, 'recall': 0.44105833842394626, 'f1-score': 0.4272799341661437, 'support': 130960}}
[[20796  6289 17587]
 [13374 10391 18932]
 [11467  5550 26574]]
Evaluating performance on  val set...
169/169 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0335693
{'0': {'precision': 0.41363204559848005, 'recall': 0.45124794887295966, 'f1-score': 0.4316219900045434, 'support': 11579}, '1': {'precision': 0.6507034379949688, 'recall': 0.3525492175668854, 'f1-score': 0.4573224634122385, 'support': 19810}, '2': {'precision': 0.3802638895910217, 'recall': 0.6397890618355022, 'f1-score': 0.4770118587101274, 'support': 11757}, 'accuracy': 0.4573077457933528, 'macro avg': {'precision': 0.48153312439482354, 'recall': 0.4811954094251158, 'f1-score': 0.4553187707089698, 'support': 43146}, 'weighted avg': {'precision': 0.5133881034762614, 'recall': 0.4573077457933528, 'f1-score': 0.4557905123375057, 'support': 43146}}
[[5225 2053 4301]
 [4868 6984 7958]
 [2539 1696 7522]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.030772
{'0': {'precision': 0.46548646236239216, 'recall': 0.44411326378539495, 'f1-score': 0.4545487561285637, 'support': 14091}, '1': {'precision': 0.5335866770984687, 'recall': 0.32598156367360875, 'f1-score': 0.4047134621905731, 'support': 14645}, '2': {'precision': 0.4336786316550229, 'recall': 0.6246356696738377, 'f1-score': 0.5119294753305844, 'support': 14410}, 'accuracy': 0.46430723589672274, 'macro avg': {'precision': 0.4775839237052946, 'recall': 0.4649101657109471, 'f1-score': 0.4570638978832404, 'support': 43146}, 'weighted avg': {'precision': 0.47797839218941324, 'recall': 0.46430723589672274, 'f1-score': 0.45679736049465197, 'support': 43146}}
[[6258 2246 5587]
 [3704 4774 6167]
 [3482 1927 9001]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0457381
{'0': {'precision': 0.4538293832196357, 'recall': 0.44147225832934256, 'f1-score': 0.44756554307116103, 'support': 14617}, '1': {'precision': 0.49753300440058673, 'recall': 0.27510691638401413, 'f1-score': 0.3543041640947723, 'support': 13562}, '2': {'precision': 0.43102482732872877, 'recall': 0.6170909333867842, 'f1-score': 0.507542244813848, 'support': 14967}, 'accuracy': 0.4500996616140546, 'macro avg': {'precision': 0.46079573831631704, 'recall': 0.444556702700047, 'f1-score': 0.43647065065992713, 'support': 43146}, 'weighted avg': {'precision': 0.4596559424009469, 'recall': 0.4500996616140546, 'f1-score': 0.4390563063703084, 'support': 43146}}
[[6453 2031 6133]
 [3772 3731 6059]
 [3994 1737 9236]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0705557
{'0': {'precision': 0.42410804273331987, 'recall': 0.43720994666481955, 'f1-score': 0.4305593451568895, 'support': 14437}, '1': {'precision': 0.4621861604409063, 'recall': 0.2172567645365573, 'f1-score': 0.29557470139024866, 'support': 13896}, '2': {'precision': 0.41194606782936816, 'recall': 0.6043340309187876, 'f1-score': 0.4899299474605954, 'support': 14813}, 'accuracy': 0.42374727668845313, 'macro avg': {'precision': 0.4327467570011982, 'recall': 0.41960024737338814, 'f1-score': 0.4053546646692445, 'support': 43146}, 'weighted avg': {'precision': 0.43219635194882966, 'recall': 0.42374727668845313, 'f1-score': 0.40746821555376417, 'support': 43146}}
[[6312 1889 6236]
 [4334 3019 6543]
 [4237 1624 8952]]
training model: results/XRAY/W6/deepVOL_L2/seq2seq
Epoch 1/50
512/512 - 23s - loss: 13.1429 - accuracy10: 0.3720 - accuracy20: 0.3790 - accuracy30: 0.3790 - accuracy50: 0.3716 - val_loss: 13.1253 - val_accuracy10: 0.3389 - val_accuracy20: 0.3860 - val_accuracy30: 0.3911 - val_accuracy50: 0.3787 - 23s/epoch - 44ms/step
Epoch 2/50
512/512 - 17s - loss: 12.8808 - accuracy10: 0.3987 - accuracy20: 0.4121 - accuracy30: 0.4066 - accuracy50: 0.3941 - val_loss: 12.8927 - val_accuracy10: 0.3762 - val_accuracy20: 0.4153 - val_accuracy30: 0.4147 - val_accuracy50: 0.3928 - 17s/epoch - 32ms/step
Epoch 3/50
512/512 - 16s - loss: 12.7322 - accuracy10: 0.4235 - accuracy20: 0.4365 - accuracy30: 0.4280 - accuracy50: 0.4081 - val_loss: 12.8283 - val_accuracy10: 0.4041 - val_accuracy20: 0.4318 - val_accuracy30: 0.4261 - val_accuracy50: 0.3993 - 16s/epoch - 32ms/step
Epoch 4/50
512/512 - 17s - loss: 12.6250 - accuracy10: 0.4434 - accuracy20: 0.4509 - accuracy30: 0.4390 - accuracy50: 0.4163 - val_loss: 12.7189 - val_accuracy10: 0.4276 - val_accuracy20: 0.4468 - val_accuracy30: 0.4366 - val_accuracy50: 0.4048 - 17s/epoch - 32ms/step
Epoch 5/50
512/512 - 17s - loss: 12.5444 - accuracy10: 0.4603 - accuracy20: 0.4617 - accuracy30: 0.4461 - accuracy50: 0.4205 - val_loss: 12.6458 - val_accuracy10: 0.4337 - val_accuracy20: 0.4500 - val_accuracy30: 0.4411 - val_accuracy50: 0.4101 - 17s/epoch - 32ms/step
Epoch 6/50
512/512 - 17s - loss: 12.4846 - accuracy10: 0.4703 - accuracy20: 0.4673 - accuracy30: 0.4526 - accuracy50: 0.4260 - val_loss: 12.6226 - val_accuracy10: 0.4411 - val_accuracy20: 0.4554 - val_accuracy30: 0.4424 - val_accuracy50: 0.4120 - 17s/epoch - 32ms/step
Epoch 7/50
512/512 - 17s - loss: 12.4476 - accuracy10: 0.4760 - accuracy20: 0.4720 - accuracy30: 0.4566 - accuracy50: 0.4290 - val_loss: 12.6154 - val_accuracy10: 0.4484 - val_accuracy20: 0.4583 - val_accuracy30: 0.4441 - val_accuracy50: 0.4106 - 17s/epoch - 32ms/step
Epoch 8/50
512/512 - 17s - loss: 12.4053 - accuracy10: 0.4806 - accuracy20: 0.4748 - accuracy30: 0.4598 - accuracy50: 0.4318 - val_loss: 12.6074 - val_accuracy10: 0.4544 - val_accuracy20: 0.4603 - val_accuracy30: 0.4458 - val_accuracy50: 0.4124 - 17s/epoch - 32ms/step
Epoch 9/50
512/512 - 17s - loss: 12.3756 - accuracy10: 0.4859 - accuracy20: 0.4793 - accuracy30: 0.4624 - accuracy50: 0.4334 - val_loss: 12.5817 - val_accuracy10: 0.4539 - val_accuracy20: 0.4634 - val_accuracy30: 0.4495 - val_accuracy50: 0.4155 - 17s/epoch - 32ms/step
Epoch 10/50
512/512 - 16s - loss: 12.3409 - accuracy10: 0.4869 - accuracy20: 0.4802 - accuracy30: 0.4651 - accuracy50: 0.4367 - val_loss: 12.5516 - val_accuracy10: 0.4585 - val_accuracy20: 0.4655 - val_accuracy30: 0.4520 - val_accuracy50: 0.4198 - 16s/epoch - 32ms/step
Epoch 11/50
512/512 - 16s - loss: 12.3010 - accuracy10: 0.4914 - accuracy20: 0.4843 - accuracy30: 0.4677 - accuracy50: 0.4391 - val_loss: 12.5435 - val_accuracy10: 0.4596 - val_accuracy20: 0.4664 - val_accuracy30: 0.4512 - val_accuracy50: 0.4194 - 16s/epoch - 32ms/step
Epoch 12/50
512/512 - 16s - loss: 12.2803 - accuracy10: 0.4926 - accuracy20: 0.4860 - accuracy30: 0.4701 - accuracy50: 0.4410 - val_loss: 12.5429 - val_accuracy10: 0.4626 - val_accuracy20: 0.4662 - val_accuracy30: 0.4512 - val_accuracy50: 0.4175 - 16s/epoch - 32ms/step
Epoch 13/50
512/512 - 16s - loss: 12.2540 - accuracy10: 0.4948 - accuracy20: 0.4880 - accuracy30: 0.4724 - accuracy50: 0.4444 - val_loss: 12.5590 - val_accuracy10: 0.4606 - val_accuracy20: 0.4672 - val_accuracy30: 0.4523 - val_accuracy50: 0.4172 - 16s/epoch - 32ms/step
Epoch 14/50
512/512 - 17s - loss: 12.2292 - accuracy10: 0.4961 - accuracy20: 0.4899 - accuracy30: 0.4739 - accuracy50: 0.4453 - val_loss: 12.5619 - val_accuracy10: 0.4567 - val_accuracy20: 0.4672 - val_accuracy30: 0.4546 - val_accuracy50: 0.4197 - 17s/epoch - 33ms/step
Epoch 15/50
512/512 - 17s - loss: 12.2019 - accuracy10: 0.4991 - accuracy20: 0.4929 - accuracy30: 0.4768 - accuracy50: 0.4465 - val_loss: 12.5854 - val_accuracy10: 0.4546 - val_accuracy20: 0.4639 - val_accuracy30: 0.4504 - val_accuracy50: 0.4191 - 17s/epoch - 33ms/step
Epoch 16/50
512/512 - 17s - loss: 12.1840 - accuracy10: 0.4995 - accuracy20: 0.4948 - accuracy30: 0.4783 - accuracy50: 0.4493 - val_loss: 12.5699 - val_accuracy10: 0.4599 - val_accuracy20: 0.4662 - val_accuracy30: 0.4511 - val_accuracy50: 0.4203 - 17s/epoch - 33ms/step
Epoch 17/50
512/512 - 17s - loss: 12.1560 - accuracy10: 0.5019 - accuracy20: 0.4969 - accuracy30: 0.4819 - accuracy50: 0.4537 - val_loss: 12.6045 - val_accuracy10: 0.4616 - val_accuracy20: 0.4642 - val_accuracy30: 0.4501 - val_accuracy50: 0.4173 - 17s/epoch - 32ms/step
Epoch 18/50
512/512 - 17s - loss: 12.1268 - accuracy10: 0.5033 - accuracy20: 0.4994 - accuracy30: 0.4855 - accuracy50: 0.4548 - val_loss: 12.6127 - val_accuracy10: 0.4642 - val_accuracy20: 0.4642 - val_accuracy30: 0.4476 - val_accuracy50: 0.4162 - 17s/epoch - 33ms/step
Epoch 19/50
512/512 - 17s - loss: 12.1064 - accuracy10: 0.5039 - accuracy20: 0.5001 - accuracy30: 0.4853 - accuracy50: 0.4555 - val_loss: 12.6287 - val_accuracy10: 0.4583 - val_accuracy20: 0.4618 - val_accuracy30: 0.4473 - val_accuracy50: 0.4143 - 17s/epoch - 33ms/step
Epoch 20/50
512/512 - 17s - loss: 12.0930 - accuracy10: 0.5026 - accuracy20: 0.5010 - accuracy30: 0.4866 - accuracy50: 0.4590 - val_loss: 12.6058 - val_accuracy10: 0.4561 - val_accuracy20: 0.4604 - val_accuracy30: 0.4477 - val_accuracy50: 0.4162 - 17s/epoch - 32ms/step
Epoch 21/50
512/512 - 17s - loss: 12.0667 - accuracy10: 0.5050 - accuracy20: 0.5024 - accuracy30: 0.4885 - accuracy50: 0.4609 - val_loss: 12.6238 - val_accuracy10: 0.4542 - val_accuracy20: 0.4621 - val_accuracy30: 0.4481 - val_accuracy50: 0.4190 - 17s/epoch - 33ms/step
Epoch 22/50
512/512 - 17s - loss: 12.0474 - accuracy10: 0.5063 - accuracy20: 0.5040 - accuracy30: 0.4903 - accuracy50: 0.4615 - val_loss: 12.6167 - val_accuracy10: 0.4559 - val_accuracy20: 0.4622 - val_accuracy30: 0.4477 - val_accuracy50: 0.4175 - 17s/epoch - 33ms/step
testing model: results/XRAY/W6/deepVOL_L2/seq2seq
Evaluating performance on  test set...
1214/1214 - 16s - 16s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.032019
{'0': {'precision': 0.44180502065870525, 'recall': 0.44823623408889424, 'f1-score': 0.44499739221140466, 'support': 91367}, '1': {'precision': 0.6262850076005462, 'recall': 0.37983327213206974, 'f1-score': 0.47287458843783886, 'support': 127993}, '2': {'precision': 0.4061863308020004, 'recall': 0.6242596100156563, 'f1-score': 0.4921475458653236, 'support': 91337}, 'accuracy': 0.471803718735617, 'macro avg': {'precision': 0.49142545302041724, 'recall': 0.48410970541220677, 'f1-score': 0.47000650883818906, 'support': 310697}, 'weighted avg': {'precision': 0.5073313781491388, 'recall': 0.471803718735617, 'f1-score': 0.4703424697657357, 'support': 310697}}
[[40954 13411 37002]
 [33023 48616 46354]
 [18720 15599 57018]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0334076
{'0': {'precision': 0.49383867384789487, 'recall': 0.4268467195594682, 'f1-score': 0.457905424443516, 'support': 110412}, '1': {'precision': 0.4799397000872762, 'recall': 0.4021763219715438, 'f1-score': 0.4376303763278791, 'support': 90244}, '2': {'precision': 0.46131150593307124, 'recall': 0.5853999872774693, 'f1-score': 0.5160003524483142, 'support': 110041}, 'accuracy': 0.47583658677103413, 'macro avg': {'precision': 0.4783632932894141, 'recall': 0.4714743429361605, 'f1-score': 0.4705120510732364, 'support': 310697}, 'weighted avg': {'precision': 0.478281326745836, 'recall': 0.47583658677103413, 'f1-score': 0.47259215309048863, 'support': 310697}}
[[47129 18768 44515]
 [23242 36294 30708]
 [25063 20560 64418]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0466855
{'0': {'precision': 0.4976438961065511, 'recall': 0.42065199547249366, 'f1-score': 0.4559203626011388, 'support': 115737}, '1': {'precision': 0.41590698182215186, 'recall': 0.3766887089796675, 'f1-score': 0.3953275695448855, 'support': 80905}, '2': {'precision': 0.4636650189841679, 'recall': 0.5674718337644119, 'f1-score': 0.5103431961994126, 'support': 114055}, 'accuracy': 0.46310070583237045, 'macro avg': {'precision': 0.4590719656376236, 'recall': 0.45493751273885774, 'f1-score': 0.4538637094484789, 'support': 310697}, 'weighted avg': {'precision': 0.46388629342492643, 'recall': 0.46310070583237045, 'f1-score': 0.4601203914518678, 'support': 310697}}
[[48685 21000 46052]
 [21614 30476 28815]
 [27532 21800 64723]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.074822
{'0': {'precision': 0.4649329312883804, 'recall': 0.40586085070659017, 'f1-score': 0.43339325318081007, 'support': 114352}, '1': {'precision': 0.3647917524602036, 'recall': 0.3063100660577588, 'f1-score': 0.3330027805323844, 'support': 83866}, '2': {'precision': 0.438630716325034, 'recall': 0.5477200188479627, 'f1-score': 0.48714278936631183, 'support': 112479}, 'accuracy': 0.43034532036035106, 'macro avg': {'precision': 0.4227851333578727, 'recall': 0.41996364520410384, 'f1-score': 0.41784627435983546, 'support': 310697}, 'weighted avg': {'precision': 0.4283799972707809, 'recall': 0.43034532036035106, 'f1-score': 0.4257534842145059, 'support': 310697}}
[[46411 22631 45310]
 [24641 25689 33536]
 [28771 22101 61607]]
Evaluating performance on  train set...
512/512 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.03395
{'0': {'precision': 0.3989131665345862, 'recall': 0.4986979166666667, 'f1-score': 0.4432591548941416, 'support': 35328}, '1': {'precision': 0.672334880172907, 'recall': 0.3471119133574007, 'f1-score': 0.45784723274387995, 'support': 60940}, '2': {'precision': 0.3843637612274773, 'recall': 0.6130520004612015, 'f1-score': 0.4724909747292419, 'support': 34692}, 'accuracy': 0.4584529627367135, 'macro avg': {'precision': 0.4852039359783235, 'recall': 0.48628727682842293, 'f1-score': 0.4578657874557545, 'support': 130960}, 'weighted avg': {'precision': 0.5222910778067689, 'recall': 0.4584529627367135, 'f1-score': 0.4577911322756501, 'support': 130960}}
[[17618  5140 12570]
 [18292 21153 21495]
 [ 8255  5169 21268]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.028126
{'0': {'precision': 0.45599737819532443, 'recall': 0.48399888687908726, 'f1-score': 0.4695810646627368, 'support': 43122}, '1': {'precision': 0.5442131996437877, 'recall': 0.3612558567237378, 'f1-score': 0.4342505230744937, 'support': 45674}, '2': {'precision': 0.44079750687977254, 'recall': 0.5736410207760174, 'f1-score': 0.4985211521615912, 'support': 42164}, 'accuracy': 0.4700519242516799, 'macro avg': {'precision': 0.48033602823962823, 'recall': 0.4729652547929475, 'f1-score': 0.46745091329960725, 'support': 130960}, 'weighted avg': {'precision': 0.4818700267497546, 'recall': 0.4700519242516799, 'f1-score': 0.466576656391511, 'support': 130960}}
[[20871  6919 15332]
 [13822 16500 15352]
 [11077  6900 24187]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0422013
{'0': {'precision': 0.4529635901778154, 'recall': 0.48315570809248554, 'f1-score': 0.4675727646184774, 'support': 44288}, '1': {'precision': 0.49523381916142845, 'recall': 0.3313613569662376, 'f1-score': 0.39705373336840794, 'support': 43273}, '2': {'precision': 0.43853850929408755, 'recall': 0.5533998479227632, 'f1-score': 0.4893190037182295, 'support': 43399}, 'accuracy': 0.45627672571777644, 'macro avg': {'precision': 0.4622453062111105, 'recall': 0.4559723043271621, 'f1-score': 0.45131516723503834, 'support': 130960}, 'weighted avg': {'precision': 0.46215055973749, 'recall': 0.45627672571777644, 'f1-score': 0.45147773553635984, 'support': 130960}}
[[21398  7296 15594]
 [13779 14339 15155]
 [12063  7319 24017]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0655291
{'0': {'precision': 0.43437525739230703, 'recall': 0.4719661714694827, 'f1-score': 0.45239116448638217, 'support': 44696}, '1': {'precision': 0.43806613554512713, 'recall': 0.28243737686462145, 'f1-score': 0.34344385026737967, 'support': 42636}, '2': {'precision': 0.4207842351612727, 'recall': 0.5295681672320528, 'f1-score': 0.46895011924696806, 'support': 43628}, 'accuracy': 0.42945174098961514, 'macro avg': {'precision': 0.4310752093662356, 'recall': 0.42799057185538564, 'f1-score': 0.42159504466690995, 'support': 130960}, 'weighted avg': {'precision': 0.43104916670070714, 'recall': 0.42945174098961514, 'f1-score': 0.42243817417829915, 'support': 130960}}
[[21095  7779 15822]
 [14613 12042 15981]
 [12856  7668 23104]]
Evaluating performance on  val set...
169/169 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0360111
{'0': {'precision': 0.38845987520850067, 'recall': 0.5432397408207343, 'f1-score': 0.4529933001945105, 'support': 11575}, '1': {'precision': 0.6641656377623706, 'recall': 0.35207934749773434, 'f1-score': 0.46020203349675887, 'support': 19862}, '2': {'precision': 0.4051488040898302, 'recall': 0.5684884713919727, 'f1-score': 0.4731175153690345, 'support': 11710}, 'accuracy': 0.46209469951560944, 'macro avg': {'precision': 0.4859247723535671, 'recall': 0.4879358532368138, 'f1-score': 0.46210428302010126, 'support': 43147}, 'weighted avg': {'precision': 0.5199057512380121, 'recall': 0.46209469951560944, 'f1-score': 0.46177338735104356, 'support': 43147}}
[[6288 1766 3521]
 [6616 6993 6253]
 [3283 1770 6657]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.034773
{'0': {'precision': 0.43916825548141086, 'recall': 0.5242159163644122, 'f1-score': 0.47793807748419515, 'support': 14061}, '1': {'precision': 0.5296853354442905, 'recall': 0.3634820397908603, 'f1-score': 0.4311198808037692, 'support': 14727}, '2': {'precision': 0.45998646736790305, 'recall': 0.5207883557350791, 'f1-score': 0.48850274366344393, 'support': 14359}, 'accuracy': 0.4682133172642362, 'macro avg': {'precision': 0.4762800194312015, 'recall': 0.4694954372967839, 'f1-score': 0.46585356731713606, 'support': 43147}, 'weighted avg': {'precision': 0.4769918293357106, 'recall': 0.4682133172642362, 'f1-score': 0.4654738611807488, 'support': 43147}}
[[7371 2355 4335]
 [4930 5353 4444]
 [4483 2398 7478]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0501463
{'0': {'precision': 0.4356824882927675, 'recall': 0.5163412127440904, 'f1-score': 0.47259500815251465, 'support': 14595}, '1': {'precision': 0.47333540436988714, 'recall': 0.3363502575423105, 'f1-score': 0.3932550436615477, 'support': 13590}, '2': {'precision': 0.46118693262520843, 'recall': 0.49913113220157734, 'f1-score': 0.4794094045899535, 'support': 14962}, 'accuracy': 0.4536816001112476, 'macro avg': {'precision': 0.456734941762621, 'recall': 0.4506075341626594, 'f1-score': 0.44841981880133863, 'support': 43147}, 'weighted avg': {'precision': 0.4563861438328986, 'recall': 0.4536816001112476, 'f1-score': 0.4499683338081737, 'support': 43147}}
[[7536 2537 4522]
 [4816 4571 4203]
 [4945 2549 7468]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.077194
{'0': {'precision': 0.4071484947570188, 'recall': 0.4991360840417444, 'f1-score': 0.44847393423789855, 'support': 14469}, '1': {'precision': 0.4185842647381109, 'recall': 0.27653105545099177, 'f1-score': 0.3330427201394943, 'support': 13814}, '2': {'precision': 0.4326598292697906, 'recall': 0.4739639397201292, 'f1-score': 0.45237101486499504, 'support': 14864}, 'accuracy': 0.41919484552807845, 'macro avg': {'precision': 0.41946419625497344, 'recall': 0.4165436930709551, 'f1-score': 0.4112958897474626, 'support': 43147}, 'weighted avg': {'precision': 0.4195983569193162, 'recall': 0.41919484552807845, 'f1-score': 0.4128598571267623, 'support': 43147}}
[[7222 2641 4606]
 [5362 3820 4632]
 [5154 2665 7045]]
training model: results/XRAY/W6/deepVOL_L3/seq2seq
Epoch 1/50
512/512 - 29s - loss: 13.2063 - accuracy10: 0.3717 - accuracy20: 0.3702 - accuracy30: 0.3680 - accuracy50: 0.3597 - val_loss: 13.1032 - val_accuracy10: 0.3580 - val_accuracy20: 0.3862 - val_accuracy30: 0.3872 - val_accuracy50: 0.3742 - 29s/epoch - 57ms/step
Epoch 2/50
512/512 - 23s - loss: 12.9867 - accuracy10: 0.3930 - accuracy20: 0.3969 - accuracy30: 0.3935 - accuracy50: 0.3802 - val_loss: 12.9908 - val_accuracy10: 0.3576 - val_accuracy20: 0.4039 - val_accuracy30: 0.4062 - val_accuracy50: 0.3896 - 23s/epoch - 44ms/step
Epoch 3/50
512/512 - 23s - loss: 12.8084 - accuracy10: 0.4113 - accuracy20: 0.4245 - accuracy30: 0.4175 - accuracy50: 0.3998 - val_loss: 12.8214 - val_accuracy10: 0.4019 - val_accuracy20: 0.4305 - val_accuracy30: 0.4262 - val_accuracy50: 0.4030 - 23s/epoch - 44ms/step
Epoch 4/50
512/512 - 23s - loss: 12.6788 - accuracy10: 0.4294 - accuracy20: 0.4409 - accuracy30: 0.4327 - accuracy50: 0.4129 - val_loss: 12.7710 - val_accuracy10: 0.4228 - val_accuracy20: 0.4416 - val_accuracy30: 0.4340 - val_accuracy50: 0.4075 - 23s/epoch - 44ms/step
Epoch 5/50
512/512 - 23s - loss: 12.5934 - accuracy10: 0.4439 - accuracy20: 0.4521 - accuracy30: 0.4412 - accuracy50: 0.4190 - val_loss: 12.6967 - val_accuracy10: 0.4270 - val_accuracy20: 0.4471 - val_accuracy30: 0.4392 - val_accuracy50: 0.4115 - 23s/epoch - 44ms/step
Epoch 6/50
512/512 - 22s - loss: 12.5291 - accuracy10: 0.4559 - accuracy20: 0.4601 - accuracy30: 0.4475 - accuracy50: 0.4234 - val_loss: 12.6630 - val_accuracy10: 0.4407 - val_accuracy20: 0.4524 - val_accuracy30: 0.4408 - val_accuracy50: 0.4116 - 22s/epoch - 44ms/step
Epoch 7/50
512/512 - 23s - loss: 12.4810 - accuracy10: 0.4654 - accuracy20: 0.4666 - accuracy30: 0.4532 - accuracy50: 0.4274 - val_loss: 12.6148 - val_accuracy10: 0.4597 - val_accuracy20: 0.4599 - val_accuracy30: 0.4464 - val_accuracy50: 0.4138 - 23s/epoch - 44ms/step
Epoch 8/50
512/512 - 23s - loss: 12.4461 - accuracy10: 0.4705 - accuracy20: 0.4710 - accuracy30: 0.4558 - accuracy50: 0.4296 - val_loss: 12.5894 - val_accuracy10: 0.4495 - val_accuracy20: 0.4592 - val_accuracy30: 0.4474 - val_accuracy50: 0.4157 - 23s/epoch - 44ms/step
Epoch 9/50
512/512 - 23s - loss: 12.4186 - accuracy10: 0.4748 - accuracy20: 0.4735 - accuracy30: 0.4595 - accuracy50: 0.4331 - val_loss: 12.5793 - val_accuracy10: 0.4506 - val_accuracy20: 0.4602 - val_accuracy30: 0.4480 - val_accuracy50: 0.4151 - 23s/epoch - 45ms/step
Epoch 10/50
512/512 - 23s - loss: 12.3843 - accuracy10: 0.4797 - accuracy20: 0.4774 - accuracy30: 0.4613 - accuracy50: 0.4334 - val_loss: 12.5878 - val_accuracy10: 0.4530 - val_accuracy20: 0.4617 - val_accuracy30: 0.4488 - val_accuracy50: 0.4173 - 23s/epoch - 44ms/step
Epoch 11/50
512/512 - 23s - loss: 12.3569 - accuracy10: 0.4816 - accuracy20: 0.4782 - accuracy30: 0.4625 - accuracy50: 0.4350 - val_loss: 12.5842 - val_accuracy10: 0.4547 - val_accuracy20: 0.4621 - val_accuracy30: 0.4480 - val_accuracy50: 0.4181 - 23s/epoch - 44ms/step
Epoch 12/50
512/512 - 23s - loss: 12.3228 - accuracy10: 0.4858 - accuracy20: 0.4825 - accuracy30: 0.4665 - accuracy50: 0.4383 - val_loss: 12.5856 - val_accuracy10: 0.4605 - val_accuracy20: 0.4631 - val_accuracy30: 0.4486 - val_accuracy50: 0.4165 - 23s/epoch - 44ms/step
Epoch 13/50
512/512 - 23s - loss: 12.2941 - accuracy10: 0.4889 - accuracy20: 0.4855 - accuracy30: 0.4703 - accuracy50: 0.4421 - val_loss: 12.5919 - val_accuracy10: 0.4548 - val_accuracy20: 0.4619 - val_accuracy30: 0.4471 - val_accuracy50: 0.4159 - 23s/epoch - 44ms/step
Epoch 14/50
512/512 - 23s - loss: 12.2665 - accuracy10: 0.4905 - accuracy20: 0.4873 - accuracy30: 0.4719 - accuracy50: 0.4429 - val_loss: 12.5830 - val_accuracy10: 0.4503 - val_accuracy20: 0.4605 - val_accuracy30: 0.4454 - val_accuracy50: 0.4146 - 23s/epoch - 44ms/step
Epoch 15/50
512/512 - 23s - loss: 12.2390 - accuracy10: 0.4924 - accuracy20: 0.4896 - accuracy30: 0.4742 - accuracy50: 0.4439 - val_loss: 12.6329 - val_accuracy10: 0.4389 - val_accuracy20: 0.4538 - val_accuracy30: 0.4428 - val_accuracy50: 0.4141 - 23s/epoch - 45ms/step
Epoch 16/50
512/512 - 23s - loss: 12.2124 - accuracy10: 0.4949 - accuracy20: 0.4924 - accuracy30: 0.4762 - accuracy50: 0.4464 - val_loss: 12.6113 - val_accuracy10: 0.4456 - val_accuracy20: 0.4590 - val_accuracy30: 0.4443 - val_accuracy50: 0.4144 - 23s/epoch - 44ms/step
Epoch 17/50
512/512 - 22s - loss: 12.1891 - accuracy10: 0.4966 - accuracy20: 0.4934 - accuracy30: 0.4779 - accuracy50: 0.4482 - val_loss: 12.6274 - val_accuracy10: 0.4484 - val_accuracy20: 0.4574 - val_accuracy30: 0.4463 - val_accuracy50: 0.4163 - 22s/epoch - 44ms/step
Epoch 18/50
512/512 - 23s - loss: 12.1659 - accuracy10: 0.4985 - accuracy20: 0.4947 - accuracy30: 0.4795 - accuracy50: 0.4504 - val_loss: 12.6073 - val_accuracy10: 0.4505 - val_accuracy20: 0.4585 - val_accuracy30: 0.4440 - val_accuracy50: 0.4163 - 23s/epoch - 44ms/step
Epoch 19/50
512/512 - 23s - loss: 12.1435 - accuracy10: 0.5001 - accuracy20: 0.4971 - accuracy30: 0.4822 - accuracy50: 0.4525 - val_loss: 12.6661 - val_accuracy10: 0.4407 - val_accuracy20: 0.4536 - val_accuracy30: 0.4430 - val_accuracy50: 0.4157 - 23s/epoch - 44ms/step
testing model: results/XRAY/W6/deepVOL_L3/seq2seq
Evaluating performance on  test set...
1214/1214 - 25s - 25s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0275643
{'0': {'precision': 0.4311051076774399, 'recall': 0.4296518436634671, 'f1-score': 0.4303772488570708, 'support': 91367}, '1': {'precision': 0.6273303097657806, 'recall': 0.3814817997859258, 'f1-score': 0.474449292120529, 'support': 127993}, '2': {'precision': 0.40337787807200026, 'recall': 0.626263179215433, 'f1-score': 0.4906966569730035, 'support': 91337}, 'accuracy': 0.4676067036373058, 'macro avg': {'precision': 0.48727109850507366, 'recall': 0.4791322742216086, 'f1-score': 0.46517439931686777, 'support': 310697}, 'weighted avg': {'precision': 0.5037898465723148, 'recall': 0.4676067036373058, 'f1-score': 0.4662652903010009, 'support': 310697}}
[[39256 14092 38019]
 [32581 48827 46585]
 [19222 14914 57201]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0339135
{'0': {'precision': 0.4841734801175991, 'recall': 0.4086874615078071, 'f1-score': 0.4432395265458474, 'support': 110412}, '1': {'precision': 0.4859096945551129, 'recall': 0.4054452373565002, 'f1-score': 0.4420456192915479, 'support': 90244}, '2': {'precision': 0.45731685876834577, 'recall': 0.5909615506947411, 'f1-score': 0.5156200444021567, 'support': 110041}, 'accuracy': 0.47230259706402056, 'macro avg': {'precision': 0.47580001114701925, 'recall': 0.4683647498530161, 'f1-score': 0.4669683967465173, 'support': 310697}, 'weighted avg': {'precision': 0.4751658407319784, 'recall': 0.47230259706402056, 'f1-score': 0.4685280925737431, 'support': 310697}}
[[45124 19218 46070]
 [22556 36589 31099]
 [25518 19493 65030]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0495896
{'0': {'precision': 0.4859966877287735, 'recall': 0.39807494578224767, 'f1-score': 0.43766386746209673, 'support': 115737}, '1': {'precision': 0.421559927369039, 'recall': 0.3816574995364934, 'f1-score': 0.40061757226633454, 'support': 80905}, '2': {'precision': 0.45794281147696125, 'recall': 0.5727587567401692, 'f1-score': 0.5089557704144041, 'support': 114055}, 'accuracy': 0.4579252454964161, 'macro avg': {'precision': 0.45516647552492456, 'recall': 0.45083040068630337, 'f1-score': 0.4490790700476118, 'support': 310697}, 'weighted avg': {'precision': 0.45891904953849566, 'recall': 0.4579252454964161, 'f1-score': 0.4541879004537648, 'support': 310697}}
[[46072 21427 48238]
 [20940 30878 29087]
 [27787 20942 65326]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0764383
{'0': {'precision': 0.4540758045095759, 'recall': 0.38585245557576603, 'f1-score': 0.4171934021359379, 'support': 114352}, '1': {'precision': 0.3661237329605033, 'recall': 0.3122481100803663, 'f1-score': 0.33704654709732224, 'support': 83866}, '2': {'precision': 0.43276455799607044, 'recall': 0.5463508743854408, 'f1-score': 0.4829691920779629, 'support': 112479}, 'accuracy': 0.42408842055121226, 'macro avg': {'precision': 0.41765469848871656, 'recall': 0.4148171466805244, 'f1-score': 0.412403047103741, 'support': 310697}, 'weighted avg': {'precision': 0.42261989689177754, 'recall': 0.42408842055121226, 'f1-score': 0.41937172678091517, 'support': 310697}}
[[44123 23555 46674]
 [23805 26187 33874]
 [29243 21783 61453]]
Evaluating performance on  train set...
512/512 - 10s - 10s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.035354
{'0': {'precision': 0.383789268952687, 'recall': 0.513870018115942, 'f1-score': 0.4394045746097059, 'support': 35328}, '1': {'precision': 0.6722730564149826, 'recall': 0.33516573679028555, 'f1-score': 0.44731828037055693, 'support': 60940}, '2': {'precision': 0.3885426833846385, 'recall': 0.5966793497059841, 'f1-score': 0.47062568206620586, 'support': 34692}, 'accuracy': 0.4526496640195479, 'macro avg': {'precision': 0.48153500291743595, 'recall': 0.4819050348707372, 'f1-score': 0.45244951234882286, 'support': 130960}, 'weighted avg': {'precision': 0.5192894786459181, 'recall': 0.4526496640195479, 'f1-score': 0.4513577197604936, 'support': 130960}}
[[18154  4858 12316]
 [20255 20425 20260]
 [ 8893  5099 20700]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0330062
{'0': {'precision': 0.44337174296688464, 'recall': 0.49522285608274197, 'f1-score': 0.4678650848423105, 'support': 43122}, '1': {'precision': 0.5469855402560652, 'recall': 0.3470245653982572, 'f1-score': 0.4246426705603408, 'support': 45674}, '2': {'precision': 0.43858931955851205, 'recall': 0.5598140593871549, 'f1-score': 0.4918422204163281, 'support': 42164}, 'accuracy': 0.46433262064752595, 'macro avg': {'precision': 0.4763155342604873, 'recall': 0.4673538269560513, 'f1-score': 0.46144999193965974, 'support': 130960}, 'weighted avg': {'precision': 0.47796864642439385, 'recall': 0.46433262064752595, 'f1-score': 0.4605104070355618, 'support': 130960}}
[[21355  6403 15364]
 [14974 15850 14850]
 [11836  6724 23604]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0458891
{'0': {'precision': 0.4441095047677638, 'recall': 0.48900379335260113, 'f1-score': 0.4654766638367382, 'support': 44288}, '1': {'precision': 0.5013478057722028, 'recall': 0.3223488087259954, 'f1-score': 0.39239900978958026, 'support': 43273}, '2': {'precision': 0.43469064959905834, 'recall': 0.544597801792668, 'f1-score': 0.4834766955436684, 'support': 43399}, 'accuracy': 0.45235949908368966, 'macro avg': {'precision': 0.46004932004634164, 'recall': 0.4519834679570882, 'f1-score': 0.4471174563899956, 'support': 130960}, 'weighted avg': {'precision': 0.45990138094291994, 'recall': 0.45235949908368966, 'f1-score': 0.44729473082258425, 'support': 130960}}
[[21657  6769 15862]
 [14449 13949 14875]
 [12659  7105 23635]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0667707
{'0': {'precision': 0.42780641004992753, 'recall': 0.475434043314838, 'f1-score': 0.45036453034927093, 'support': 44696}, '1': {'precision': 0.44535498770766596, 'recall': 0.2804203020921287, 'f1-score': 0.34414668547249644, 'support': 42636}, '2': {'precision': 0.4187575768707983, 'recall': 0.5225543229118914, 'f1-score': 0.4649332109717549, 'support': 43628}, 'accuracy': 0.42764202810018326, 'macro avg': {'precision': 0.43063965820946387, 'recall': 0.42613622277295277, 'f1-score': 0.419814808931174, 'support': 130960}, 'weighted avg': {'precision': 0.4305050864631551, 'recall': 0.42764202810018326, 'f1-score': 0.42063712017846744, 'support': 130960}}
[[21250  7347 16099]
 [15135 11956 15545]
 [13287  7543 22798]]
Evaluating performance on  val set...
169/169 - 3s - 3s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0374938
{'0': {'precision': 0.3760754761763484, 'recall': 0.5475593952483802, 'f1-score': 0.44589841001829184, 'support': 11575}, '1': {'precision': 0.6643021280847238, 'recall': 0.33475984291612126, 'f1-score': 0.44518094472900144, 'support': 19862}, '2': {'precision': 0.4030703101013202, 'recall': 0.5605465414175917, 'f1-score': 0.46894088230041076, 'support': 11710}, 'accuracy': 0.4531253621340997, 'macro avg': {'precision': 0.48114930478746415, 'recall': 0.4809552598606977, 'f1-score': 0.4533400790159014, 'support': 43147}, 'weighted avg': {'precision': 0.5160821340080765, 'recall': 0.4531253621340997, 'f1-score': 0.45182181268470495, 'support': 43147}}
[[6338 1654 3583]
 [7075 6649 6138]
 [3440 1706 6564]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.037945
{'0': {'precision': 0.4283969998255713, 'recall': 0.5240025602730958, 'f1-score': 0.47140115163147794, 'support': 14061}, '1': {'precision': 0.5294423637120267, 'recall': 0.3455557818971956, 'f1-score': 0.4181765890135174, 'support': 14727}, '2': {'precision': 0.45776199804113615, 'recall': 0.5207883557350791, 'f1-score': 0.4872454797198241, 'support': 14359}, 'accuracy': 0.4620251697684659, 'macro avg': {'precision': 0.47186712052624474, 'recall': 0.4634488993017902, 'f1-score': 0.4589410734549399, 'support': 43147}, 'weighted avg': {'precision': 0.4726584104296254, 'recall': 0.4620251697684659, 'f1-score': 0.45850733684356354, 'support': 43147}}
[[7368 2216 4477]
 [5257 5089 4381]
 [4574 2307 7478]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.051888
{'0': {'precision': 0.429120311962381, 'recall': 0.5127098321342926, 'f1-score': 0.46720569412793056, 'support': 14595}, '1': {'precision': 0.47741726851352806, 'recall': 0.32590139808682855, 'f1-score': 0.387370446494949, 'support': 13590}, '2': {'precision': 0.4570350535540409, 'recall': 0.5019382435503275, 'f1-score': 0.4784353698158884, 'support': 14962}, 'accuracy': 0.4501355830069298, 'macro avg': {'precision': 0.4545242113433166, 'recall': 0.44684982459048284, 'f1-score': 0.444337170146256, 'support': 43147}, 'weighted avg': {'precision': 0.45401233233980015, 'recall': 0.4501355830069298, 'f1-score': 0.44595409824202903, 'support': 43147}}
[[7483 2368 4744]
 [4983 4429 4178]
 [4972 2480 7510]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0751723
{'0': {'precision': 0.40429599640125957, 'recall': 0.4969244591886101, 'f1-score': 0.4458499984497566, 'support': 14469}, '1': {'precision': 0.4249972200600467, 'recall': 0.27667583610829594, 'f1-score': 0.3351602578155829, 'support': 13814}, '2': {'precision': 0.4310934636530238, 'recall': 0.47477125941872983, 'f1-score': 0.4518793622334636, 'support': 14864}, 'accuracy': 0.4187776670452175, 'macro avg': {'precision': 0.4201288933714434, 'recall': 0.41612385157187864, 'f1-score': 0.41096320616626764, 'support': 43147}, 'weighted avg': {'precision': 0.4201553668523387, 'recall': 0.4187776670452175, 'f1-score': 0.4124885222442393, 'support': 43147}}
[[7190 2519 4760]
 [5439 3822 4553]
 [5155 2652 7057]]
training model: results/XRAY/W7/deepLOB_L1/seq2seq
Epoch 1/50
381/381 - 17s - loss: 13.0155 - accuracy10: 0.4094 - accuracy20: 0.4058 - accuracy30: 0.3993 - accuracy50: 0.3809 - val_loss: 13.7747 - val_accuracy10: 0.3554 - val_accuracy20: 0.3478 - val_accuracy30: 0.3421 - val_accuracy50: 0.3399 - 17s/epoch - 44ms/step
Epoch 2/50
381/381 - 10s - loss: 12.8550 - accuracy10: 0.4320 - accuracy20: 0.4268 - accuracy30: 0.4140 - accuracy50: 0.3896 - val_loss: 14.0751 - val_accuracy10: 0.3537 - val_accuracy20: 0.3522 - val_accuracy30: 0.3500 - val_accuracy50: 0.3431 - 10s/epoch - 27ms/step
Epoch 3/50
381/381 - 10s - loss: 12.7627 - accuracy10: 0.4460 - accuracy20: 0.4382 - accuracy30: 0.4258 - accuracy50: 0.3976 - val_loss: 13.7248 - val_accuracy10: 0.3514 - val_accuracy20: 0.3357 - val_accuracy30: 0.3245 - val_accuracy50: 0.3371 - 10s/epoch - 27ms/step
Epoch 4/50
381/381 - 10s - loss: 12.7261 - accuracy10: 0.4527 - accuracy20: 0.4431 - accuracy30: 0.4291 - accuracy50: 0.4025 - val_loss: 13.4578 - val_accuracy10: 0.3747 - val_accuracy20: 0.3645 - val_accuracy30: 0.3544 - val_accuracy50: 0.3530 - 10s/epoch - 27ms/step
Epoch 5/50
381/381 - 10s - loss: 12.6888 - accuracy10: 0.4574 - accuracy20: 0.4481 - accuracy30: 0.4328 - accuracy50: 0.4020 - val_loss: 14.3537 - val_accuracy10: 0.3675 - val_accuracy20: 0.3620 - val_accuracy30: 0.3535 - val_accuracy50: 0.3474 - 10s/epoch - 27ms/step
Epoch 6/50
381/381 - 10s - loss: 12.6600 - accuracy10: 0.4598 - accuracy20: 0.4502 - accuracy30: 0.4349 - accuracy50: 0.4077 - val_loss: 14.3082 - val_accuracy10: 0.3552 - val_accuracy20: 0.3551 - val_accuracy30: 0.3518 - val_accuracy50: 0.3437 - 10s/epoch - 27ms/step
Epoch 7/50
381/381 - 10s - loss: 12.6151 - accuracy10: 0.4691 - accuracy20: 0.4563 - accuracy30: 0.4387 - accuracy50: 0.4083 - val_loss: 13.7522 - val_accuracy10: 0.3728 - val_accuracy20: 0.3604 - val_accuracy30: 0.3494 - val_accuracy50: 0.3515 - 10s/epoch - 27ms/step
Epoch 8/50
381/381 - 10s - loss: 12.5829 - accuracy10: 0.4714 - accuracy20: 0.4595 - accuracy30: 0.4417 - accuracy50: 0.4104 - val_loss: 15.1427 - val_accuracy10: 0.3523 - val_accuracy20: 0.3426 - val_accuracy30: 0.3360 - val_accuracy50: 0.3345 - 10s/epoch - 26ms/step
Epoch 9/50
381/381 - 10s - loss: 12.5618 - accuracy10: 0.4737 - accuracy20: 0.4617 - accuracy30: 0.4445 - accuracy50: 0.4112 - val_loss: 14.2587 - val_accuracy10: 0.3533 - val_accuracy20: 0.3448 - val_accuracy30: 0.3372 - val_accuracy50: 0.3389 - 10s/epoch - 26ms/step
Epoch 10/50
381/381 - 10s - loss: 12.5412 - accuracy10: 0.4740 - accuracy20: 0.4624 - accuracy30: 0.4453 - accuracy50: 0.4127 - val_loss: 15.0482 - val_accuracy10: 0.3442 - val_accuracy20: 0.3404 - val_accuracy30: 0.3340 - val_accuracy50: 0.3345 - 10s/epoch - 27ms/step
Epoch 11/50
381/381 - 10s - loss: 12.5301 - accuracy10: 0.4752 - accuracy20: 0.4638 - accuracy30: 0.4454 - accuracy50: 0.4139 - val_loss: 14.4499 - val_accuracy10: 0.3452 - val_accuracy20: 0.3359 - val_accuracy30: 0.3305 - val_accuracy50: 0.3345 - 10s/epoch - 26ms/step
Epoch 12/50
381/381 - 10s - loss: 12.5123 - accuracy10: 0.4778 - accuracy20: 0.4656 - accuracy30: 0.4478 - accuracy50: 0.4166 - val_loss: 14.8296 - val_accuracy10: 0.3529 - val_accuracy20: 0.3403 - val_accuracy30: 0.3324 - val_accuracy50: 0.3389 - 10s/epoch - 26ms/step
Epoch 13/50
381/381 - 10s - loss: 12.4997 - accuracy10: 0.4789 - accuracy20: 0.4675 - accuracy30: 0.4482 - accuracy50: 0.4179 - val_loss: 14.5832 - val_accuracy10: 0.3429 - val_accuracy20: 0.3330 - val_accuracy30: 0.3234 - val_accuracy50: 0.3344 - 10s/epoch - 26ms/step
Epoch 14/50
381/381 - 10s - loss: 12.4832 - accuracy10: 0.4793 - accuracy20: 0.4682 - accuracy30: 0.4517 - accuracy50: 0.4188 - val_loss: 13.9179 - val_accuracy10: 0.3492 - val_accuracy20: 0.3409 - val_accuracy30: 0.3338 - val_accuracy50: 0.3418 - 10s/epoch - 26ms/step
testing model: results/XRAY/W7/deepLOB_L1/seq2seq
Evaluating performance on  test set...
930/930 - 12s - 12s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1058246
{'0': {'precision': 0.3541470900109486, 'recall': 0.5889605734767025, 'f1-score': 0.4423220832637943, 'support': 69750}, '1': {'precision': 0.4103598774238753, 'recall': 0.5068398882262168, 'f1-score': 0.4535255288876449, 'support': 95908}, '2': {'precision': 0.4577484961329132, 'recall': 0.022106326172064133, 'f1-score': 0.04217582939639473, 'support': 72287}, 'accuracy': 0.38365168421273826, 'macro avg': {'precision': 0.4074184878559124, 'recall': 0.37263559595832785, 'f1-score': 0.31267448051594465, 'support': 237945}, 'weighted avg': {'precision': 0.40827846852084554, 'recall': 0.38365168421273826, 'f1-score': 0.3252745630787917, 'support': 237945}}
[[41080 28043   627]
 [46032 48610  1266]
 [28885 41804  1598]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1110613
{'0': {'precision': 0.365134997093996, 'recall': 0.5644970253087008, 'f1-score': 0.4434391559854768, 'support': 73453}, '1': {'precision': 0.3774550738192264, 'recall': 0.5101750584092372, 'f1-score': 0.4338928058900605, 'support': 88599}, '2': {'precision': 0.45803667745415316, 'recall': 0.02797359440264583, 'f1-score': 0.05272700178819789, 'support': 75893}, 'accuracy': 0.37314505452940805, 'macro avg': {'precision': 0.4002089161224585, 'recall': 0.3675485593735279, 'f1-score': 0.3100196545545784, 'support': 237945}, 'weighted avg': {'precision': 0.3993535505637142, 'recall': 0.37314505452940805, 'f1-score': 0.3152661975682044, 'support': 237945}}
[[41464 31065   924]
 [41810 45201  1588]
 [30284 43486  2123]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1134236
{'0': {'precision': 0.36677601097149637, 'recall': 0.5250514027989653, 'f1-score': 0.43186889324117167, 'support': 75385}, '1': {'precision': 0.3561210065026859, 'recall': 0.5224202493245486, 'f1-score': 0.4235312201284447, 'support': 84388}, '2': {'precision': 0.4538017324350337, 'recall': 0.03618942843985059, 'f1-score': 0.06703314930218231, 'support': 78172}, 'accuracy': 0.3635125764357309, 'macro avg': {'precision': 0.3922329166364053, 'recall': 0.36122036018778814, 'f1-score': 0.30747775422393286, 'support': 237945}, 'weighted avg': {'precision': 0.39158771191555347, 'recall': 0.3635125764357309, 'f1-score': 0.3090525309144344, 'support': 237945}}
[[39581 34411  1393]
 [38290 44086  2012]
 [30045 45298  2829]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1085204
{'0': {'precision': 0.33771197951026427, 'recall': 0.48353938046950967, 'f1-score': 0.3976785897889939, 'support': 71990}, '1': {'precision': 0.3835025580480126, 'recall': 0.537543302221928, 'f1-score': 0.4476416221082998, 'support': 90642}, '2': {'precision': 0.3951912009208339, 'recall': 0.04102877325295766, 'f1-score': 0.07433960448443439, 'support': 75313}, 'accuracy': 0.36405051587551746, 'macro avg': {'precision': 0.37213524615970356, 'recall': 0.3540371519814651, 'f1-score': 0.30655327212724265, 'support': 237945}, 'weighted avg': {'precision': 0.37334829135507214, 'recall': 0.36405051587551746, 'f1-score': 0.3143699267586475, 'support': 237945}}
[[34810 35335  1845]
 [39034 48724  2884]
 [29232 42991  3090]]
Evaluating performance on  train set...
381/381 - 5s - 5s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1033283
{'0': {'precision': 0.39183126493037346, 'recall': 0.6419843441736142, 'f1-score': 0.48664294759693655, 'support': 31426}, '1': {'precision': 0.37779993676581464, 'recall': 0.44433638443935924, 'f1-score': 0.40837572459481836, 'support': 34960}, '2': {'precision': 0.4681586978636826, 'recall': 0.07390396659707725, 'f1-score': 0.12765603328710126, 'support': 31135}, 'accuracy': 0.38976220506352477, 'macro avg': {'precision': 0.4125966331866236, 'recall': 0.38674156507001695, 'f1-score': 0.34089156849295205, 'support': 97521}, 'weighted avg': {'precision': 0.4111698626861963, 'recall': 0.38976220506352477, 'f1-score': 0.34397337188308236, 'support': 97521}}
[[20175 10152  1099]
 [17911 15534  1515]
 [13403 15431  2301]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1062276
{'0': {'precision': 0.39688486964709574, 'recall': 0.6202520003678837, 'f1-score': 0.48404229867457776, 'support': 32619}, '1': {'precision': 0.35265960044937233, 'recall': 0.44338000491279783, 'f1-score': 0.3928503414315641, 'support': 32568}, '2': {'precision': 0.4669524830296534, 'recall': 0.08084369394445476, 'f1-score': 0.13782558262153327, 'support': 32334}, 'accuracy': 0.3823381630623148, 'macro avg': {'precision': 0.4054989843753738, 'recall': 0.3814918997417121, 'f1-score': 0.3382394075758917, 'support': 97521}, 'weighted avg': {'precision': 0.4053470228641481, 'recall': 0.3823381630623148, 'f1-score': 0.33879654688419814, 'support': 97521}}
[[20232 10977  1410]
 [16554 14440  1574]
 [14191 15529  2614]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1078848
{'0': {'precision': 0.39307308363429777, 'recall': 0.5877908917139476, 'f1-score': 0.47110462642105905, 'support': 32959}, '1': {'precision': 0.34423444976076556, 'recall': 0.4535825741575513, 'f1-score': 0.39141493138201655, 'support': 31723}, '2': {'precision': 0.448018648018648, 'recall': 0.0877919546880234, 'f1-score': 0.14681468656108368, 'support': 32839}, 'accuracy': 0.37576521979881256, 'macro avg': {'precision': 0.39510872713790385, 'recall': 0.3763884735198408, 'f1-score': 0.3364447481213864, 'support': 97521}, 'weighted avg': {'precision': 0.395688411681053, 'recall': 0.37576521979881256, 'f1-score': 0.33598138598274035, 'support': 97521}}
[[19373 11859  1727]
 [15509 14389  1825]
 [14404 15552  2883]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1075723
{'0': {'precision': 0.37335405422433166, 'recall': 0.5495687656496336, 'f1-score': 0.44463897156291426, 'support': 32349}, '1': {'precision': 0.35458896396396394, 'recall': 0.465504496735247, 'f1-score': 0.4025462099824216, 'support': 32468}, '2': {'precision': 0.426510989010989, 'recall': 0.09494251467710371, 'f1-score': 0.15531212484993998, 'support': 32704}, 'accuracy': 0.36912049712369643, 'macro avg': {'precision': 0.38481800239976155, 'recall': 0.37000525902066145, 'f1-score': 0.33416576879842524, 'support': 97521}, 'weighted avg': {'precision': 0.38493288795951913, 'recall': 0.36912049712369643, 'f1-score': 0.3335981395585609, 'support': 97521}}
[[17778 12428  2143]
 [15322 15114  2032]
 [14517 15082  3105]]
Evaluating performance on  val set...
114/114 - 1s - 1s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1168422
{'0': {'precision': 0.4020428429564477, 'recall': 0.5810353664787289, 'f1-score': 0.4752442040833438, 'support': 9755}, '1': {'precision': 0.3409153570443893, 'recall': 0.5075423293996921, 'f1-score': 0.40786706799158867, 'support': 9745}, '2': {'precision': 0.46709129511677283, 'recall': 0.02297170303852981, 'f1-score': 0.04378980891719745, 'support': 9577}, 'accuracy': 0.3725968978918045, 'macro avg': {'precision': 0.4033498317058699, 'recall': 0.3705164663056503, 'f1-score': 0.3089670269973766, 'support': 29077}, 'weighted avg': {'precision': 0.40298109917704905, 'recall': 0.3725968978918045, 'f1-score': 0.3105563431031761, 'support': 29077}}
[[5668 3994   93]
 [4641 4946  158]
 [3789 5568  220]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1197158
{'0': {'precision': 0.39844751459905997, 'recall': 0.5654942389326865, 'f1-score': 0.46749665775401067, 'support': 9894}, '1': {'precision': 0.32662968099861306, 'recall': 0.5049313893653516, 'f1-score': 0.3966649823143002, 'support': 9328}, '2': {'precision': 0.46991869918699186, 'recall': 0.02932521562658549, 'f1-score': 0.05520534861509074, 'support': 9855}, 'accuracy': 0.36434295147367335, 'macro avg': {'precision': 0.3983319649282216, 'recall': 0.36658361464154127, 'f1-score': 0.3064556628944672, 'support': 29077}, 'weighted avg': {'precision': 0.39963167294720797, 'recall': 0.36434295147367335, 'f1-score': 0.3050366818257624, 'support': 29077}}
[[5595 4163  136]
 [4428 4710  190]
 [4019 5547  289]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.121648
{'0': {'precision': 0.39044237313212016, 'recall': 0.5315206445115811, 'f1-score': 0.450187649266462, 'support': 9930}, '1': {'precision': 0.3177709819911655, 'recall': 0.514524647887324, 'f1-score': 0.3928916523127337, 'support': 9088}, '2': {'precision': 0.4609004739336493, 'recall': 0.03867183616661696, 'f1-score': 0.071356507383289, 'support': 10059}, 'accuracy': 0.3557106991780445, 'macro avg': {'precision': 0.38970460968564496, 'recall': 0.3615723761885073, 'f1-score': 0.30481193632082826, 'support': 29077}, 'weighted avg': {'precision': 0.39210349474967304, 'recall': 0.3557106991780445, 'f1-score': 0.301225635423276, 'support': 29077}}
[[5278 4443  209]
 [4166 4676  246]
 [4074 5596  389]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1190702
{'0': {'precision': 0.36873471882640585, 'recall': 0.5050230221850146, 'f1-score': 0.42624977919095564, 'support': 9556}, '1': {'precision': 0.3384295581036679, 'recall': 0.5245816443197173, 'f1-score': 0.4114290372544224, 'support': 9621}, '2': {'precision': 0.38847583643122674, 'recall': 0.042222222222222223, 'f1-score': 0.0761661807580175, 'support': 9900}, 'accuracy': 0.3539223441207828, 'macro avg': {'precision': 0.3652133711204335, 'recall': 0.35727562957565134, 'f1-score': 0.30461499906779854, 'support': 29077}, 'weighted avg': {'precision': 0.3654287076483017, 'recall': 0.3539223441207828, 'f1-score': 0.3021510763448067, 'support': 29077}}
[[4826 4423  307]
 [4223 5047  351]
 [4039 5443  418]]
training model: results/XRAY/W7/deepOF_L1/seq2seq
Epoch 1/50
381/381 - 17s - loss: 13.1253 - accuracy10: 0.3797 - accuracy20: 0.3809 - accuracy30: 0.3792 - accuracy50: 0.3711 - val_loss: 13.1520 - val_accuracy10: 0.3951 - val_accuracy20: 0.4030 - val_accuracy30: 0.4059 - val_accuracy50: 0.3898 - 17s/epoch - 44ms/step
Epoch 2/50
381/381 - 10s - loss: 12.9960 - accuracy10: 0.3933 - accuracy20: 0.3950 - accuracy30: 0.3924 - accuracy50: 0.3820 - val_loss: 13.1251 - val_accuracy10: 0.3944 - val_accuracy20: 0.4055 - val_accuracy30: 0.4090 - val_accuracy50: 0.3901 - 10s/epoch - 26ms/step
Epoch 3/50
381/381 - 10s - loss: 12.9520 - accuracy10: 0.3985 - accuracy20: 0.4007 - accuracy30: 0.3983 - accuracy50: 0.3856 - val_loss: 13.0954 - val_accuracy10: 0.3971 - val_accuracy20: 0.4101 - val_accuracy30: 0.4129 - val_accuracy50: 0.3948 - 10s/epoch - 26ms/step
Epoch 4/50
381/381 - 10s - loss: 12.9283 - accuracy10: 0.4013 - accuracy20: 0.4029 - accuracy30: 0.4012 - accuracy50: 0.3895 - val_loss: 13.0585 - val_accuracy10: 0.4000 - val_accuracy20: 0.4111 - val_accuracy30: 0.4146 - val_accuracy50: 0.3935 - 10s/epoch - 26ms/step
Epoch 5/50
381/381 - 10s - loss: 12.9137 - accuracy10: 0.4017 - accuracy20: 0.4030 - accuracy30: 0.4032 - accuracy50: 0.3916 - val_loss: 13.0344 - val_accuracy10: 0.4005 - val_accuracy20: 0.4123 - val_accuracy30: 0.4164 - val_accuracy50: 0.3963 - 10s/epoch - 25ms/step
Epoch 6/50
381/381 - 10s - loss: 12.9025 - accuracy10: 0.4041 - accuracy20: 0.4041 - accuracy30: 0.4040 - accuracy50: 0.3918 - val_loss: 13.0285 - val_accuracy10: 0.4015 - val_accuracy20: 0.4123 - val_accuracy30: 0.4158 - val_accuracy50: 0.3973 - 10s/epoch - 26ms/step
Epoch 7/50
381/381 - 10s - loss: 12.8907 - accuracy10: 0.4053 - accuracy20: 0.4062 - accuracy30: 0.4055 - accuracy50: 0.3932 - val_loss: 13.0035 - val_accuracy10: 0.4031 - val_accuracy20: 0.4142 - val_accuracy30: 0.4173 - val_accuracy50: 0.3985 - 10s/epoch - 26ms/step
Epoch 8/50
381/381 - 9s - loss: 12.8758 - accuracy10: 0.4058 - accuracy20: 0.4085 - accuracy30: 0.4080 - accuracy50: 0.3956 - val_loss: 12.9958 - val_accuracy10: 0.4039 - val_accuracy20: 0.4133 - val_accuracy30: 0.4158 - val_accuracy50: 0.3977 - 9s/epoch - 25ms/step
Epoch 9/50
381/381 - 9s - loss: 12.8655 - accuracy10: 0.4083 - accuracy20: 0.4094 - accuracy30: 0.4086 - accuracy50: 0.3963 - val_loss: 13.0079 - val_accuracy10: 0.4036 - val_accuracy20: 0.4150 - val_accuracy30: 0.4176 - val_accuracy50: 0.3970 - 9s/epoch - 25ms/step
Epoch 10/50
381/381 - 9s - loss: 12.8547 - accuracy10: 0.4089 - accuracy20: 0.4113 - accuracy30: 0.4109 - accuracy50: 0.3977 - val_loss: 13.0157 - val_accuracy10: 0.4046 - val_accuracy20: 0.4144 - val_accuracy30: 0.4170 - val_accuracy50: 0.3972 - 9s/epoch - 25ms/step
Epoch 11/50
381/381 - 10s - loss: 12.8417 - accuracy10: 0.4118 - accuracy20: 0.4123 - accuracy30: 0.4132 - accuracy50: 0.4018 - val_loss: 12.9941 - val_accuracy10: 0.4053 - val_accuracy20: 0.4168 - val_accuracy30: 0.4205 - val_accuracy50: 0.4018 - 10s/epoch - 25ms/step
Epoch 12/50
381/381 - 9s - loss: 12.8309 - accuracy10: 0.4115 - accuracy20: 0.4137 - accuracy30: 0.4154 - accuracy50: 0.4005 - val_loss: 12.9931 - val_accuracy10: 0.4036 - val_accuracy20: 0.4133 - val_accuracy30: 0.4170 - val_accuracy50: 0.4001 - 9s/epoch - 25ms/step
Epoch 13/50
381/381 - 9s - loss: 12.8170 - accuracy10: 0.4160 - accuracy20: 0.4171 - accuracy30: 0.4167 - accuracy50: 0.4026 - val_loss: 13.0048 - val_accuracy10: 0.4040 - val_accuracy20: 0.4147 - val_accuracy30: 0.4201 - val_accuracy50: 0.4018 - 9s/epoch - 25ms/step
Epoch 14/50
381/381 - 9s - loss: 12.8094 - accuracy10: 0.4168 - accuracy20: 0.4174 - accuracy30: 0.4170 - accuracy50: 0.4033 - val_loss: 13.0048 - val_accuracy10: 0.4054 - val_accuracy20: 0.4157 - val_accuracy30: 0.4197 - val_accuracy50: 0.4017 - 9s/epoch - 25ms/step
Epoch 15/50
381/381 - 10s - loss: 12.7931 - accuracy10: 0.4195 - accuracy20: 0.4206 - accuracy30: 0.4206 - accuracy50: 0.4060 - val_loss: 13.0023 - val_accuracy10: 0.4060 - val_accuracy20: 0.4152 - val_accuracy30: 0.4197 - val_accuracy50: 0.4018 - 10s/epoch - 25ms/step
Epoch 16/50
381/381 - 9s - loss: 12.7850 - accuracy10: 0.4184 - accuracy20: 0.4205 - accuracy30: 0.4209 - accuracy50: 0.4074 - val_loss: 13.0048 - val_accuracy10: 0.4078 - val_accuracy20: 0.4158 - val_accuracy30: 0.4193 - val_accuracy50: 0.4023 - 9s/epoch - 25ms/step
Epoch 17/50
381/381 - 10s - loss: 12.7755 - accuracy10: 0.4200 - accuracy20: 0.4216 - accuracy30: 0.4227 - accuracy50: 0.4081 - val_loss: 13.0059 - val_accuracy10: 0.4045 - val_accuracy20: 0.4128 - val_accuracy30: 0.4181 - val_accuracy50: 0.3994 - 10s/epoch - 25ms/step
Epoch 18/50
381/381 - 9s - loss: 12.7661 - accuracy10: 0.4212 - accuracy20: 0.4245 - accuracy30: 0.4250 - accuracy50: 0.4076 - val_loss: 13.0142 - val_accuracy10: 0.4060 - val_accuracy20: 0.4159 - val_accuracy30: 0.4184 - val_accuracy50: 0.3999 - 9s/epoch - 25ms/step
Epoch 19/50
381/381 - 10s - loss: 12.7441 - accuracy10: 0.4252 - accuracy20: 0.4266 - accuracy30: 0.4255 - accuracy50: 0.4116 - val_loss: 13.0247 - val_accuracy10: 0.4048 - val_accuracy20: 0.4148 - val_accuracy30: 0.4182 - val_accuracy50: 0.3993 - 10s/epoch - 25ms/step
Epoch 20/50
381/381 - 10s - loss: 12.7369 - accuracy10: 0.4253 - accuracy20: 0.4260 - accuracy30: 0.4261 - accuracy50: 0.4108 - val_loss: 13.0392 - val_accuracy10: 0.4049 - val_accuracy20: 0.4146 - val_accuracy30: 0.4190 - val_accuracy50: 0.4002 - 10s/epoch - 25ms/step
Epoch 21/50
381/381 - 10s - loss: 12.7266 - accuracy10: 0.4250 - accuracy20: 0.4275 - accuracy30: 0.4292 - accuracy50: 0.4144 - val_loss: 13.0407 - val_accuracy10: 0.4025 - val_accuracy20: 0.4126 - val_accuracy30: 0.4166 - val_accuracy50: 0.3982 - 10s/epoch - 25ms/step
Epoch 22/50
381/381 - 9s - loss: 12.7095 - accuracy10: 0.4268 - accuracy20: 0.4314 - accuracy30: 0.4316 - accuracy50: 0.4164 - val_loss: 13.0385 - val_accuracy10: 0.4035 - val_accuracy20: 0.4136 - val_accuracy30: 0.4176 - val_accuracy50: 0.3987 - 9s/epoch - 25ms/step
testing model: results/XRAY/W7/deepOF_L1/seq2seq
Evaluating performance on  test set...
930/930 - 12s - 12s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.107561
{'0': {'precision': 0.35303601036071486, 'recall': 0.6624562711475598, 'f1-score': 0.4606060001894063, 'support': 69748}, '1': {'precision': 0.4695421869088157, 'recall': 0.012939618588841273, 'f1-score': 0.025185185185185185, 'support': 95907}, '2': {'precision': 0.37572066118868397, 'recall': 0.5427405409144359, 'f1-score': 0.44404452669168043, 'support': 72285}, 'accuracy': 0.36428511389425905, 'macro avg': {'precision': 0.3994329528194049, 'recall': 0.40604547688361237, 'f1-score': 0.30994523735542395, 'support': 237940}, 'weighted avg': {'precision': 0.4068878967997266, 'recall': 0.36428511389425905, 'f1-score': 0.28006867894710596, 'support': 237940}}
[[46205   613 22930]
 [52410  1241 42256]
 [32264   789 39232]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0963398
{'0': {'precision': 0.37182305002303645, 'recall': 0.6702382573179033, 'f1-score': 0.4783020563617021, 'support': 73450}, '1': {'precision': 0.44342105263157894, 'recall': 0.01141096400636576, 'f1-score': 0.022249364539662628, 'support': 88599}, '2': {'precision': 0.39920202206060373, 'recall': 0.5431737623697145, 'f1-score': 0.4601902295257658, 'support': 75891}, 'accuracy': 0.3843910229469614, 'macro avg': {'precision': 0.4048153749050731, 'recall': 0.40827432789799456, 'f1-score': 0.3202472168090435, 'support': 237940}, 'weighted avg': {'precision': 0.4072157078360031, 'recall': 0.3843910229469614, 'f1-score': 0.3027101546505694, 'support': 237940}}
[[49229   557 23664]
 [49213  1011 38375]
 [33957   712 41222]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0907435
{'0': {'precision': 0.3787885594489368, 'recall': 0.6711194831725986, 'f1-score': 0.4842564718607467, 'support': 75383}, '1': {'precision': 0.42538671519563237, 'recall': 0.0110800369729576, 'f1-score': 0.021597523791924603, 'support': 84386}, '2': {'precision': 0.412528625393905, 'recall': 0.539240894961047, 'f1-score': 0.4674499453848841, 'support': 78171}, 'accuracy': 0.3937084979406573, 'macro avg': {'precision': 0.4055679666794914, 'recall': 0.4071468050355344, 'f1-score': 0.3244346470125185, 'support': 237940}, 'weighted avg': {'precision': 0.4063994137223871, 'recall': 0.3937084979406573, 'f1-score': 0.31465186156873914, 'support': 237940}}
[[50591   572 24220]
 [47642   935 35809]
 [35327   691 42153]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.105487
{'0': {'precision': 0.3573106021195321, 'recall': 0.6678937571194399, 'f1-score': 0.46555697575335037, 'support': 71986}, '1': {'precision': 0.4117647058823529, 'recall': 0.009885151311216778, 'f1-score': 0.019306808020082528, 'support': 90641}, '2': {'precision': 0.384453490899749, 'recall': 0.5166305949836018, 'f1-score': 0.4408477274401056, 'support': 75313}, 'accuracy': 0.36935361855930066, 'macro avg': {'precision': 0.38450959963387804, 'recall': 0.3981365011380862, 'f1-score': 0.30857050373784617, 'support': 237940}, 'weighted avg': {'precision': 0.3866456731537017, 'recall': 0.36935361855930066, 'f1-score': 0.28774118575702123, 'support': 237940}}
[[48079   583 23324]
 [50772   896 38973]
 [35707   697 38909]]
Evaluating performance on  train set...
381/381 - 5s - 5s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0836321
{'0': {'precision': 0.3947947868520759, 'recall': 0.6339024079500574, 'f1-score': 0.4865598298434119, 'support': 31396}, '1': {'precision': 0.6217765042979942, 'recall': 0.018586723768736615, 'f1-score': 0.036094477711244174, 'support': 35025}, '2': {'precision': 0.3954235595501715, 'recall': 0.5856779960770443, 'f1-score': 0.47210378299918354, 'support': 31099}, 'accuracy': 0.3975287120590648, 'macro avg': {'precision': 0.4706649502334139, 'recall': 0.41272237593194605, 'f1-score': 0.3315860301846132, 'support': 97520}, 'weighted avg': {'precision': 0.47651739611870186, 'recall': 0.3975287120590648, 'f1-score': 0.3201619877675523, 'support': 97520}}
[[19902   191 11303]
 [17829   651 16545]
 [12680   205 18214]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0759987
{'0': {'precision': 0.40861414426049864, 'recall': 0.640737672220688, 'f1-score': 0.4990022822047771, 'support': 32589}, '1': {'precision': 0.5920770877944326, 'recall': 0.01696527181249233, 'f1-score': 0.03298538622129436, 'support': 32596}, '2': {'precision': 0.4140137191100167, 'recall': 0.5823720426782124, 'f1-score': 0.48396921060409415, 'support': 32335}, 'accuracy': 0.4128896636587367, 'macro avg': {'precision': 0.4715683170549827, 'recall': 0.4133583289037976, 'f1-score': 0.3386522930100552, 'support': 97520}, 'weighted avg': {'precision': 0.47172687354876025, 'recall': 0.4128896636587367, 'f1-score': 0.33825186063293866, 'support': 97520}}
[[20881   171 11537]
 [16927   553 15116]
 [13294   210 18831]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0752573
{'0': {'precision': 0.4093993563147078, 'recall': 0.6416871790196614, 'f1-score': 0.49987571758300287, 'support': 32907}, '1': {'precision': 0.5795328142380423, 'recall': 0.016382617445443684, 'f1-score': 0.03186446897648391, 'support': 31802}, '2': {'precision': 0.4162244965921453, 'recall': 0.5713937399043004, 'f1-score': 0.48161944151874025, 'support': 32811}, 'accuracy': 0.41412018047579985, 'macro avg': {'precision': 0.46838555571496515, 'recall': 0.40982117878980184, 'f1-score': 0.3377865426927424, 'support': 97520}, 'weighted avg': {'precision': 0.46717749317402774, 'recall': 0.41412018047579985, 'f1-score': 0.34111135742991594, 'support': 97520}}
[[21116   174 11617]
 [16603   521 14678]
 [13859   204 18748]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.084862
{'0': {'precision': 0.3929305542214965, 'recall': 0.6313547550699139, 'f1-score': 0.4843935016340643, 'support': 32397}, '1': {'precision': 0.5352743561030235, 'recall': 0.014734895191122071, 'f1-score': 0.028680286802868032, 'support': 32440}, '2': {'precision': 0.40565826079152834, 'recall': 0.553223388305847, 'f1-score': 0.46808620801242634, 'support': 32683}, 'accuracy': 0.4000512715340443, 'macro avg': {'precision': 0.4446210570386828, 'recall': 0.3997710128556277, 'f1-score': 0.3270533321497862, 'support': 97520}, 'weighted avg': {'precision': 0.44454676183906305, 'recall': 0.4000512715340443, 'f1-score': 0.32733538056597566, 'support': 97520}}
[[20454   189 11754]
 [17225   478 14737]
 [14376   226 18081]]
Evaluating performance on  val set...
114/114 - 1s - 1s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0853931
{'0': {'precision': 0.40341017944951785, 'recall': 0.6512371134020618, 'f1-score': 0.498205765211562, 'support': 9700}, '1': {'precision': 0.46710526315789475, 'recall': 0.007255262620069487, 'f1-score': 0.0142885892533709, 'support': 9786}, '2': {'precision': 0.40675410824664554, 'recall': 0.562610780940465, 'f1-score': 0.47215295095594345, 'support': 9591}, 'accuracy': 0.4052687691302404, 'macro avg': {'precision': 0.4257565169513527, 'recall': 0.40703438565419875, 'f1-score': 0.3282157684736255, 'support': 29077}, 'weighted avg': {'precision': 0.42595004636369155, 'recall': 0.4052687691302404, 'f1-score': 0.3267477047014511, 'support': 29077}}
[[6317   24 3359]
 [5204   71 4511]
 [4138   57 5396]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0801831
{'0': {'precision': 0.4072044839095661, 'recall': 0.6553156987939597, 'f1-score': 0.5022916181154354, 'support': 9867}, '1': {'precision': 0.45528455284552843, 'recall': 0.005977796754910333, 'f1-score': 0.011800653250447792, 'support': 9368}, '2': {'precision': 0.422868068833652, 'recall': 0.5617760617760618, 'f1-score': 0.4825238905615918, 'support': 9842}, 'accuracy': 0.4144512845204113, 'macro avg': {'precision': 0.4284523685295822, 'recall': 0.4076898524416439, 'f1-score': 0.33220538730915833, 'support': 29077}, 'weighted avg': {'precision': 0.42799669385608563, 'recall': 0.4144512845204113, 'f1-score': 0.3375747170100899, 'support': 29077}}
[[6466   22 3379]
 [5145   56 4167]
 [4268   45 5529]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0790197
{'0': {'precision': 0.40746054519368724, 'recall': 0.657672170761176, 'f1-score': 0.5031775988907292, 'support': 9932}, '1': {'precision': 0.46551724137931033, 'recall': 0.005964873522589197, 'f1-score': 0.011778819936743375, 'support': 9053}, '2': {'precision': 0.4288476411446249, 'recall': 0.54944510503369, 'f1-score': 0.4817131439492659, 'support': 10092}, 'accuracy': 0.4172025999931217, 'macro avg': {'precision': 0.4339418092392075, 'recall': 0.4043607164391518, 'f1-score': 0.33222318759224617, 'support': 29077}, 'weighted avg': {'precision': 0.4329592501118462, 'recall': 0.4172025999931217, 'f1-score': 0.3427328341233983, 'support': 29077}}
[[6532   24 3376]
 [4990   54 4009]
 [4509   38 5545]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0901313
{'0': {'precision': 0.3882265735993576, 'recall': 0.6559173450219161, 'f1-score': 0.4877575569438516, 'support': 9582}, '1': {'precision': 0.48717948717948717, 'recall': 0.005945551267341191, 'f1-score': 0.011747732893652102, 'support': 9587}, '2': {'precision': 0.41296687808315713, 'recall': 0.5322971336293904, 'f1-score': 0.4650998721284007, 'support': 9908}, 'accuracy': 0.39949100663754855, 'macro avg': {'precision': 0.4294576462873339, 'recall': 0.3980533433062159, 'f1-score': 0.3215350539886348, 'support': 29077}, 'weighted avg': {'precision': 0.42928268390365953, 'recall': 0.39949100663754855, 'f1-score': 0.32309137665287413, 'support': 29077}}
[[6285   23 3274]
 [5307   57 4223]
 [4597   37 5274]]
training model: results/XRAY/W7/deepLOB_L2/seq2seq
Epoch 1/50
381/381 - 26s - loss: 13.2121 - accuracy10: 0.3735 - accuracy20: 0.3708 - accuracy30: 0.3656 - accuracy50: 0.3585 - val_loss: 13.7368 - val_accuracy10: 0.3470 - val_accuracy20: 0.3336 - val_accuracy30: 0.3255 - val_accuracy50: 0.3401 - 26s/epoch - 69ms/step
Epoch 2/50
381/381 - 19s - loss: 12.9614 - accuracy10: 0.4116 - accuracy20: 0.4096 - accuracy30: 0.3989 - accuracy50: 0.3836 - val_loss: 13.6457 - val_accuracy10: 0.3578 - val_accuracy20: 0.3413 - val_accuracy30: 0.3295 - val_accuracy50: 0.3433 - 19s/epoch - 51ms/step
Epoch 3/50
381/381 - 20s - loss: 12.7518 - accuracy10: 0.4464 - accuracy20: 0.4415 - accuracy30: 0.4284 - accuracy50: 0.4026 - val_loss: 13.9071 - val_accuracy10: 0.3677 - val_accuracy20: 0.3545 - val_accuracy30: 0.3423 - val_accuracy50: 0.3511 - 20s/epoch - 52ms/step
Epoch 4/50
381/381 - 19s - loss: 12.6467 - accuracy10: 0.4594 - accuracy20: 0.4515 - accuracy30: 0.4372 - accuracy50: 0.4103 - val_loss: 13.6331 - val_accuracy10: 0.3723 - val_accuracy20: 0.3595 - val_accuracy30: 0.3461 - val_accuracy50: 0.3538 - 19s/epoch - 51ms/step
Epoch 5/50
381/381 - 19s - loss: 12.5714 - accuracy10: 0.4673 - accuracy20: 0.4592 - accuracy30: 0.4445 - accuracy50: 0.4155 - val_loss: 13.5420 - val_accuracy10: 0.3950 - val_accuracy20: 0.3772 - val_accuracy30: 0.3657 - val_accuracy50: 0.3609 - 19s/epoch - 51ms/step
Epoch 6/50
381/381 - 19s - loss: 12.5253 - accuracy10: 0.4722 - accuracy20: 0.4637 - accuracy30: 0.4474 - accuracy50: 0.4192 - val_loss: 13.6432 - val_accuracy10: 0.3894 - val_accuracy20: 0.3734 - val_accuracy30: 0.3606 - val_accuracy50: 0.3517 - 19s/epoch - 51ms/step
Epoch 7/50
381/381 - 19s - loss: 12.4689 - accuracy10: 0.4775 - accuracy20: 0.4684 - accuracy30: 0.4523 - accuracy50: 0.4231 - val_loss: 13.4454 - val_accuracy10: 0.4000 - val_accuracy20: 0.3816 - val_accuracy30: 0.3675 - val_accuracy50: 0.3609 - 19s/epoch - 51ms/step
Epoch 8/50
381/381 - 19s - loss: 12.4275 - accuracy10: 0.4799 - accuracy20: 0.4706 - accuracy30: 0.4543 - accuracy50: 0.4252 - val_loss: 13.5755 - val_accuracy10: 0.3964 - val_accuracy20: 0.3786 - val_accuracy30: 0.3619 - val_accuracy50: 0.3592 - 19s/epoch - 51ms/step
Epoch 9/50
381/381 - 19s - loss: 12.3837 - accuracy10: 0.4839 - accuracy20: 0.4760 - accuracy30: 0.4584 - accuracy50: 0.4285 - val_loss: 13.3717 - val_accuracy10: 0.4078 - val_accuracy20: 0.3886 - val_accuracy30: 0.3797 - val_accuracy50: 0.3699 - 19s/epoch - 51ms/step
Epoch 10/50
381/381 - 19s - loss: 12.3620 - accuracy10: 0.4864 - accuracy20: 0.4771 - accuracy30: 0.4608 - accuracy50: 0.4307 - val_loss: 13.4631 - val_accuracy10: 0.3957 - val_accuracy20: 0.3740 - val_accuracy30: 0.3585 - val_accuracy50: 0.3574 - 19s/epoch - 51ms/step
Epoch 11/50
381/381 - 19s - loss: 12.3242 - accuracy10: 0.4892 - accuracy20: 0.4809 - accuracy30: 0.4638 - accuracy50: 0.4331 - val_loss: 13.6295 - val_accuracy10: 0.3971 - val_accuracy20: 0.3782 - val_accuracy30: 0.3659 - val_accuracy50: 0.3638 - 19s/epoch - 51ms/step
Epoch 12/50
381/381 - 19s - loss: 12.2960 - accuracy10: 0.4932 - accuracy20: 0.4834 - accuracy30: 0.4662 - accuracy50: 0.4366 - val_loss: 13.6889 - val_accuracy10: 0.3929 - val_accuracy20: 0.3730 - val_accuracy30: 0.3631 - val_accuracy50: 0.3607 - 19s/epoch - 51ms/step
Epoch 13/50
381/381 - 19s - loss: 12.2633 - accuracy10: 0.4956 - accuracy20: 0.4870 - accuracy30: 0.4702 - accuracy50: 0.4402 - val_loss: 13.9650 - val_accuracy10: 0.3953 - val_accuracy20: 0.3768 - val_accuracy30: 0.3614 - val_accuracy50: 0.3552 - 19s/epoch - 51ms/step
Epoch 14/50
381/381 - 19s - loss: 12.2384 - accuracy10: 0.4963 - accuracy20: 0.4893 - accuracy30: 0.4724 - accuracy50: 0.4423 - val_loss: 13.5114 - val_accuracy10: 0.3861 - val_accuracy20: 0.3738 - val_accuracy30: 0.3647 - val_accuracy50: 0.3537 - 19s/epoch - 51ms/step
Epoch 15/50
381/381 - 19s - loss: 12.2072 - accuracy10: 0.4989 - accuracy20: 0.4906 - accuracy30: 0.4733 - accuracy50: 0.4434 - val_loss: 14.1022 - val_accuracy10: 0.3771 - val_accuracy20: 0.3670 - val_accuracy30: 0.3558 - val_accuracy50: 0.3502 - 19s/epoch - 51ms/step
Epoch 16/50
381/381 - 20s - loss: 12.1800 - accuracy10: 0.5005 - accuracy20: 0.4935 - accuracy30: 0.4771 - accuracy50: 0.4459 - val_loss: 13.8149 - val_accuracy10: 0.3872 - val_accuracy20: 0.3751 - val_accuracy30: 0.3644 - val_accuracy50: 0.3480 - 20s/epoch - 52ms/step
Epoch 17/50
381/381 - 20s - loss: 12.1637 - accuracy10: 0.5034 - accuracy20: 0.4957 - accuracy30: 0.4787 - accuracy50: 0.4477 - val_loss: 14.3548 - val_accuracy10: 0.3886 - val_accuracy20: 0.3742 - val_accuracy30: 0.3642 - val_accuracy50: 0.3583 - 20s/epoch - 53ms/step
Epoch 18/50
381/381 - 20s - loss: 12.1354 - accuracy10: 0.5032 - accuracy20: 0.4968 - accuracy30: 0.4807 - accuracy50: 0.4498 - val_loss: 13.5390 - val_accuracy10: 0.3924 - val_accuracy20: 0.3816 - val_accuracy30: 0.3736 - val_accuracy50: 0.3571 - 20s/epoch - 53ms/step
Epoch 19/50
381/381 - 20s - loss: 12.1006 - accuracy10: 0.5059 - accuracy20: 0.5000 - accuracy30: 0.4842 - accuracy50: 0.4512 - val_loss: 13.5590 - val_accuracy10: 0.3960 - val_accuracy20: 0.3827 - val_accuracy30: 0.3713 - val_accuracy50: 0.3602 - 20s/epoch - 51ms/step
testing model: results/XRAY/W7/deepLOB_L2/seq2seq
Evaluating performance on  test set...
930/930 - 19s - 19s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0861502
{'0': {'precision': 0.3629993666471583, 'recall': 0.6491469534050179, 'f1-score': 0.46562424479260395, 'support': 69750}, '1': {'precision': 0.4668526919771965, 'recall': 0.5268277933019143, 'f1-score': 0.4950302982800766, 'support': 95908}, '2': {'precision': 0.5121412803532008, 'recall': 0.03530371989431018, 'f1-score': 0.0660540960269186, 'support': 72287}, 'accuracy': 0.41336023030532265, 'macro avg': {'precision': 0.44733111299251854, 'recall': 0.40375948886708085, 'f1-score': 0.34223621303319973, 'support': 237945}, 'weighted avg': {'precision': 0.4501681923918556, 'recall': 0.41336023030532265, 'f1-score': 0.3560886312434704, 'support': 237945}}
[[45278 23498   974]
 [43924 50527  1457]
 [35531 34204  2552]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0963564
{'0': {'precision': 0.3702217277278868, 'recall': 0.6342150763072986, 'f1-score': 0.46752608100038634, 'support': 73453}, '1': {'precision': 0.4243308326386959, 'recall': 0.5171051592004424, 'f1-score': 0.46614674745254847, 'support': 88599}, '2': {'precision': 0.5249698431845597, 'recall': 0.028671946029278063, 'f1-score': 0.05437417226817262, 'support': 75893}, 'accuracy': 0.3974700035722541, 'macro avg': {'precision': 0.4398408011837141, 'recall': 0.39333072717900636, 'f1-score': 0.3293490002403691, 'support': 237945}, 'weighted avg': {'precision': 0.43972649274646697, 'recall': 0.3974700035722541, 'f1-score': 0.3352369159310687, 'support': 237945}}
[[46585 25995   873]
 [41688 45815  1096]
 [37557 36160  2176]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1023707
{'0': {'precision': 0.36807097107848985, 'recall': 0.6136631955959408, 'f1-score': 0.46014820709205745, 'support': 75385}, '1': {'precision': 0.39786016421995524, 'recall': 0.5116011755225861, 'f1-score': 0.44761820830374127, 'support': 84388}, '2': {'precision': 0.5145449693087804, 'recall': 0.024663562400859644, 'f1-score': 0.04707088709578975, 'support': 78172}, 'accuracy': 0.38396268045136484, 'macro avg': {'precision': 0.4268253682024084, 'recall': 0.3833093111731289, 'f1-score': 0.3182791008305295, 'support': 237945}, 'weighted avg': {'precision': 0.42675686832566984, 'recall': 0.38396268045136484, 'f1-score': 0.3199962316502677, 'support': 237945}}
[[46261 28268   856]
 [40252 43173   963]
 [39172 37072  1928]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.100422
{'0': {'precision': 0.3422147537142811, 'recall': 0.5884011668287262, 'f1-score': 0.4327447144338481, 'support': 71990}, '1': {'precision': 0.4194896095205368, 'recall': 0.5117715849164847, 'f1-score': 0.4610583230628554, 'support': 90642}, '2': {'precision': 0.44168526785714285, 'recall': 0.02101894759204918, 'f1-score': 0.040128268501970925, 'support': 75313}, 'accuracy': 0.3796255437180861, 'macro avg': {'precision': 0.40112987703065356, 'recall': 0.37373056644575336, 'f1-score': 0.31131043533289143, 'support': 237945}, 'weighted avg': {'precision': 0.40313542996985263, 'recall': 0.3796255437180861, 'f1-score': 0.31926168146775513, 'support': 237945}}
[[42359 28756   875]
 [43128 46388  1126]
 [38292 35438  1583]]
Evaluating performance on  train set...
381/381 - 8s - 8s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0831165
{'0': {'precision': 0.4042922303224046, 'recall': 0.6599949086743461, 'f1-score': 0.5014263610869355, 'support': 31426}, '1': {'precision': 0.4321752814429246, 'recall': 0.5106121281464531, 'f1-score': 0.4681308595030486, 'support': 34960}, '2': {'precision': 0.5014245014245015, 'recall': 0.07913923237514052, 'f1-score': 0.13670282116008767, 'support': 31135}, 'accuracy': 0.42099650331723426, 'macro avg': {'precision': 0.4459640043966102, 'recall': 0.4165820897319799, 'f1-score': 0.3687533472500239, 'support': 97521}, 'weighted avg': {'precision': 0.4452988312384859, 'recall': 0.42099650331723426, 'f1-score': 0.3730470566192301, 'support': 97521}}
[[20741  9499  1186]
 [15845 17851  1264]
 [14716 13955  2464]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0928357
{'0': {'precision': 0.40646858144809317, 'recall': 0.6538213924399889, 'f1-score': 0.5012927792403159, 'support': 32619}, '1': {'precision': 0.39905595437112795, 'recall': 0.4984033407025301, 'f1-score': 0.4432308448473596, 'support': 32568}, '2': {'precision': 0.5068555758683729, 'recall': 0.06859652378301478, 'f1-score': 0.12083900844456552, 'support': 32334}, 'accuracy': 0.4078813793952072, 'macro avg': {'precision': 0.43746003722919796, 'recall': 0.40694041897517796, 'f1-score': 0.35512087751074706, 'support': 97521}, 'weighted avg': {'precision': 0.437277316376393, 'recall': 0.4078813793952072, 'f1-score': 0.3557594756008988, 'support': 97521}}
[[21327 10190  1102]
 [15280 16232  1056]
 [15862 14254  2218]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0998158
{'0': {'precision': 0.3974211980527414, 'recall': 0.6415243180921751, 'f1-score': 0.49079640676864505, 'support': 32959}, '1': {'precision': 0.3786475277522537, 'recall': 0.4806291964820477, 'f1-score': 0.42358660925128494, 'support': 31723}, '2': {'precision': 0.48605282646260184, 'recall': 0.059959194859770394, 'f1-score': 0.10674979669287069, 'support': 32839}, 'accuracy': 0.39335117564422023, 'macro avg': {'precision': 0.420707184089199, 'recall': 0.39403756981133103, 'f1-score': 0.3403776042376003, 'support': 97521}, 'weighted avg': {'precision': 0.4211598482143377, 'recall': 0.39335117564422023, 'f1-score': 0.3396104772260689, 'support': 97521}}
[[21144 10732  1083]
 [15477 15247   999]
 [16582 14288  1969]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1053675
{'0': {'precision': 0.3767504099210313, 'recall': 0.6179480045751028, 'f1-score': 0.4681060322218059, 'support': 32349}, '1': {'precision': 0.3765628467855293, 'recall': 0.47030922754712334, 'f1-score': 0.41824730549582984, 'support': 32468}, '2': {'precision': 0.4630529276399898, 'recall': 0.05537548923679061, 'f1-score': 0.09892120715553734, 'support': 32704}, 'accuracy': 0.3801335097056019, 'macro avg': {'precision': 0.40545539478218345, 'recall': 0.38121090711967226, 'f1-score': 0.3284248482910577, 'support': 97521}, 'weighted avg': {'precision': 0.4056298075850969, 'recall': 0.3801335097056019, 'f1-score': 0.3276990054449452, 'support': 97521}}
[[19990 11188  1171]
 [16269 15270   929]
 [16800 14093  1811]]
Evaluating performance on  val set...
114/114 - 2s - 2s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1040326
{'0': {'precision': 0.40678934010152284, 'recall': 0.6572014351614557, 'f1-score': 0.5025279247501471, 'support': 9755}, '1': {'precision': 0.3958154422671559, 'recall': 0.5202668034889687, 'f1-score': 0.44958765629156694, 'support': 9745}, '2': {'precision': 0.5137795275590551, 'recall': 0.027252793150255823, 'f1-score': 0.05176003966286564, 'support': 9577}, 'accuracy': 0.40382432850706745, 'macro avg': {'precision': 0.4387947699759113, 'recall': 0.4015736772668934, 'f1-score': 0.33462520690152653, 'support': 29077}, 'weighted avg': {'precision': 0.43835051872672076, 'recall': 0.40382432850706745, 'f1-score': 0.33631727882347795, 'support': 29077}}
[[6411 3220  124]
 [4552 5070  123]
 [4797 4519  261]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1142234
{'0': {'precision': 0.4013596877753997, 'recall': 0.6444309682635941, 'f1-score': 0.4946470131885183, 'support': 9894}, '1': {'precision': 0.36597047738693467, 'recall': 0.49967838765008576, 'f1-score': 0.42249818709209574, 'support': 9328}, '2': {'precision': 0.5142857142857142, 'recall': 0.023744292237442923, 'f1-score': 0.04539282250242484, 'support': 9855}, 'accuracy': 0.387625958661485, 'macro avg': {'precision': 0.4272052931493495, 'recall': 0.3892845493837076, 'f1-score': 0.3208460075943463, 'support': 29077}, 'weighted avg': {'precision': 0.42828046491043936, 'recall': 0.387625958661485, 'f1-score': 0.31923674737571506, 'support': 29077}}
[[6376 3416  102]
 [4548 4661  119]
 [4962 4659  234]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1182177
{'0': {'precision': 0.3928975487115022, 'recall': 0.6295065458207452, 'f1-score': 0.48382352941176476, 'support': 9930}, '1': {'precision': 0.3500786163522013, 'recall': 0.4899867957746479, 'f1-score': 0.40838224504768894, 'support': 9088}, '2': {'precision': 0.5078299776286354, 'recall': 0.022566855552241773, 'f1-score': 0.04321340186560061, 'support': 10059}, 'accuracy': 0.3759328679024659, 'macro avg': {'precision': 0.41693538089744625, 'recall': 0.38068673238254497, 'f1-score': 0.3118063921083514, 'support': 29077}, 'weighted avg': {'precision': 0.4192746455645515, 'recall': 0.3759328679024659, 'f1-score': 0.307818175857836, 'support': 29077}}
[[6251 3569  110]
 [4525 4453  110]
 [5134 4698  227]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1191225
{'0': {'precision': 0.366008911521324, 'recall': 0.6017161992465466, 'f1-score': 0.4551571281564157, 'support': 9556}, '1': {'precision': 0.36423635375417346, 'recall': 0.48757925371582994, 'f1-score': 0.4169777777777778, 'support': 9621}, '2': {'precision': 0.45081967213114754, 'recall': 0.022222222222222223, 'f1-score': 0.04235656526761648, 'support': 9900}, 'accuracy': 0.3666471781820683, 'macro avg': {'precision': 0.39368831246888164, 'recall': 0.3705058917281996, 'f1-score': 0.3048304904006033, 'support': 29077}, 'weighted avg': {'precision': 0.39429837576314736, 'recall': 0.3666471781820683, 'f1-score': 0.3019759505042512, 'support': 29077}}
[[5750 3669  137]
 [4799 4691  131]
 [5161 4519  220]]
training model: results/XRAY/W7/deepOF_L2/seq2seq
Epoch 1/50
381/381 - 19s - loss: 13.0721 - accuracy10: 0.3983 - accuracy20: 0.3903 - accuracy30: 0.3832 - accuracy50: 0.3665 - val_loss: 12.9971 - val_accuracy10: 0.4028 - val_accuracy20: 0.4070 - val_accuracy30: 0.4094 - val_accuracy50: 0.3915 - 19s/epoch - 49ms/step
Epoch 2/50
381/381 - 13s - loss: 12.7785 - accuracy10: 0.4358 - accuracy20: 0.4280 - accuracy30: 0.4165 - accuracy50: 0.3944 - val_loss: 12.8801 - val_accuracy10: 0.4195 - val_accuracy20: 0.4217 - val_accuracy30: 0.4215 - val_accuracy50: 0.4001 - 13s/epoch - 33ms/step
Epoch 3/50
381/381 - 13s - loss: 12.6760 - accuracy10: 0.4547 - accuracy20: 0.4405 - accuracy30: 0.4264 - accuracy50: 0.4020 - val_loss: 12.7973 - val_accuracy10: 0.4302 - val_accuracy20: 0.4287 - val_accuracy30: 0.4266 - val_accuracy50: 0.4038 - 13s/epoch - 33ms/step
Epoch 4/50
381/381 - 13s - loss: 12.5903 - accuracy10: 0.4686 - accuracy20: 0.4513 - accuracy30: 0.4357 - accuracy50: 0.4070 - val_loss: 12.7291 - val_accuracy10: 0.4459 - val_accuracy20: 0.4363 - val_accuracy30: 0.4307 - val_accuracy50: 0.4037 - 13s/epoch - 33ms/step
Epoch 5/50
381/381 - 13s - loss: 12.4838 - accuracy10: 0.4817 - accuracy20: 0.4646 - accuracy30: 0.4477 - accuracy50: 0.4160 - val_loss: 12.6571 - val_accuracy10: 0.4600 - val_accuracy20: 0.4461 - val_accuracy30: 0.4332 - val_accuracy50: 0.4041 - 13s/epoch - 33ms/step
Epoch 6/50
381/381 - 13s - loss: 12.3907 - accuracy10: 0.4921 - accuracy20: 0.4743 - accuracy30: 0.4548 - accuracy50: 0.4196 - val_loss: 12.6392 - val_accuracy10: 0.4659 - val_accuracy20: 0.4495 - val_accuracy30: 0.4348 - val_accuracy50: 0.4048 - 13s/epoch - 33ms/step
Epoch 7/50
381/381 - 12s - loss: 12.3397 - accuracy10: 0.4958 - accuracy20: 0.4799 - accuracy30: 0.4610 - accuracy50: 0.4230 - val_loss: 12.6308 - val_accuracy10: 0.4674 - val_accuracy20: 0.4521 - val_accuracy30: 0.4388 - val_accuracy50: 0.4063 - 12s/epoch - 33ms/step
Epoch 8/50
381/381 - 12s - loss: 12.2896 - accuracy10: 0.5003 - accuracy20: 0.4842 - accuracy30: 0.4639 - accuracy50: 0.4270 - val_loss: 12.6176 - val_accuracy10: 0.4709 - val_accuracy20: 0.4550 - val_accuracy30: 0.4407 - val_accuracy50: 0.4089 - 12s/epoch - 33ms/step
Epoch 9/50
381/381 - 13s - loss: 12.2452 - accuracy10: 0.5037 - accuracy20: 0.4881 - accuracy30: 0.4690 - accuracy50: 0.4292 - val_loss: 12.6096 - val_accuracy10: 0.4694 - val_accuracy20: 0.4517 - val_accuracy30: 0.4417 - val_accuracy50: 0.4107 - 13s/epoch - 33ms/step
Epoch 10/50
381/381 - 13s - loss: 12.2190 - accuracy10: 0.5061 - accuracy20: 0.4913 - accuracy30: 0.4712 - accuracy50: 0.4319 - val_loss: 12.6141 - val_accuracy10: 0.4688 - val_accuracy20: 0.4557 - val_accuracy30: 0.4420 - val_accuracy50: 0.4094 - 13s/epoch - 33ms/step
Epoch 11/50
381/381 - 13s - loss: 12.1839 - accuracy10: 0.5100 - accuracy20: 0.4943 - accuracy30: 0.4738 - accuracy50: 0.4348 - val_loss: 12.6155 - val_accuracy10: 0.4720 - val_accuracy20: 0.4558 - val_accuracy30: 0.4409 - val_accuracy50: 0.4097 - 13s/epoch - 33ms/step
Epoch 12/50
381/381 - 13s - loss: 12.1490 - accuracy10: 0.5111 - accuracy20: 0.4986 - accuracy30: 0.4782 - accuracy50: 0.4375 - val_loss: 12.6394 - val_accuracy10: 0.4679 - val_accuracy20: 0.4532 - val_accuracy30: 0.4374 - val_accuracy50: 0.4078 - 13s/epoch - 33ms/step
Epoch 13/50
381/381 - 12s - loss: 12.1128 - accuracy10: 0.5151 - accuracy20: 0.4990 - accuracy30: 0.4796 - accuracy50: 0.4405 - val_loss: 12.6281 - val_accuracy10: 0.4720 - val_accuracy20: 0.4550 - val_accuracy30: 0.4410 - val_accuracy50: 0.4119 - 12s/epoch - 33ms/step
Epoch 14/50
381/381 - 13s - loss: 12.0820 - accuracy10: 0.5160 - accuracy20: 0.5022 - accuracy30: 0.4825 - accuracy50: 0.4439 - val_loss: 12.6406 - val_accuracy10: 0.4703 - val_accuracy20: 0.4547 - val_accuracy30: 0.4396 - val_accuracy50: 0.4116 - 13s/epoch - 33ms/step
Epoch 15/50
381/381 - 13s - loss: 12.0493 - accuracy10: 0.5186 - accuracy20: 0.5050 - accuracy30: 0.4864 - accuracy50: 0.4458 - val_loss: 12.6667 - val_accuracy10: 0.4656 - val_accuracy20: 0.4492 - val_accuracy30: 0.4393 - val_accuracy50: 0.4072 - 13s/epoch - 33ms/step
Epoch 16/50
381/381 - 12s - loss: 12.0221 - accuracy10: 0.5213 - accuracy20: 0.5075 - accuracy30: 0.4893 - accuracy50: 0.4486 - val_loss: 12.6790 - val_accuracy10: 0.4667 - val_accuracy20: 0.4487 - val_accuracy30: 0.4340 - val_accuracy50: 0.4089 - 12s/epoch - 33ms/step
Epoch 17/50
381/381 - 13s - loss: 11.9862 - accuracy10: 0.5230 - accuracy20: 0.5106 - accuracy30: 0.4928 - accuracy50: 0.4514 - val_loss: 12.7203 - val_accuracy10: 0.4615 - val_accuracy20: 0.4466 - val_accuracy30: 0.4347 - val_accuracy50: 0.4070 - 13s/epoch - 33ms/step
Epoch 18/50
381/381 - 13s - loss: 11.9506 - accuracy10: 0.5256 - accuracy20: 0.5140 - accuracy30: 0.4948 - accuracy50: 0.4551 - val_loss: 12.7432 - val_accuracy10: 0.4634 - val_accuracy20: 0.4414 - val_accuracy30: 0.4320 - val_accuracy50: 0.4041 - 13s/epoch - 33ms/step
Epoch 19/50
381/381 - 13s - loss: 11.9192 - accuracy10: 0.5285 - accuracy20: 0.5172 - accuracy30: 0.4978 - accuracy50: 0.4581 - val_loss: 12.7167 - val_accuracy10: 0.4642 - val_accuracy20: 0.4485 - val_accuracy30: 0.4379 - val_accuracy50: 0.4081 - 13s/epoch - 33ms/step
testing model: results/XRAY/W7/deepOF_L2/seq2seq
Evaluating performance on  test set...
930/930 - 14s - 14s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0265929
{'0': {'precision': 0.4175551007725359, 'recall': 0.5587256982279062, 'f1-score': 0.47793373682370904, 'support': 69748}, '1': {'precision': 0.5826112073945696, 'recall': 0.3785542244048922, 'f1-score': 0.4589219013670579, 'support': 95907}, '2': {'precision': 0.43214047025943253, 'recall': 0.4919831223628692, 'f1-score': 0.4601242075300815, 'support': 72285}, 'accuracy': 0.4658275195427419, 'macro avg': {'precision': 0.477435592808846, 'recall': 0.4764210149985559, 'f1-score': 0.46565994857361614, 'support': 237940}, 'weighted avg': {'precision': 0.4885155927081487, 'recall': 0.4658275195427419, 'f1-score': 0.46486014714508883, 'support': 237940}}
[[38970 12245 18533]
 [31402 36306 28199]
 [22957 13765 35563]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0426166
{'0': {'precision': 0.4238457400238394, 'recall': 0.5470524166099388, 'f1-score': 0.4776316336901415, 'support': 73450}, '1': {'precision': 0.5275500871455936, 'recall': 0.34504904118556645, 'f1-score': 0.417214837459399, 'support': 88599}, '2': {'precision': 0.4370583401807724, 'recall': 0.4906115349646203, 'f1-score': 0.46228915887038197, 'support': 75891}, 'accuracy': 0.4538328990501807, 'macro avg': {'precision': 0.4628180557834018, 'recall': 0.4609043309200418, 'f1-score': 0.4523785433399741, 'support': 237940}, 'weighted avg': {'precision': 0.4666751041036499, 'recall': 0.4538328990501807, 'f1-score': 0.45024143664133115, 'support': 237940}}
[[40181 13079 20190]
 [30261 30571 27767]
 [24359 14299 37233]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0527579
{'0': {'precision': 0.4192491029975908, 'recall': 0.5378666277542682, 'f1-score': 0.47120759584878036, 'support': 75383}, '1': {'precision': 0.4865167727009832, 'recall': 0.3189865617519494, 'f1-score': 0.38533003134975735, 'support': 84386}, '2': {'precision': 0.43982025820421183, 'recall': 0.48331222576147165, 'f1-score': 0.46054171339411965, 'support': 78171}, 'accuracy': 0.44231739093889216, 'macro avg': {'precision': 0.44852871130092864, 'recall': 0.4467218050892297, 'f1-score': 0.4390264468642191, 'support': 237940}, 'weighted avg': {'precision': 0.4498640368012692, 'recall': 0.44231739093889216, 'f1-score': 0.43724682063159187, 'support': 237940}}
[[40546 13470 21367]
 [30715 26918 26753]
 [25450 14940 37781]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0805548
{'0': {'precision': 0.37759091693832575, 'recall': 0.5165032089572973, 'f1-score': 0.4362559033175912, 'support': 71986}, '1': {'precision': 0.4431641923332595, 'recall': 0.26478083869330654, 'f1-score': 0.3314985807717011, 'support': 90641}, '2': {'precision': 0.39657738967356265, 'recall': 0.44924515023966644, 'f1-score': 0.42127150932589585, 'support': 75313}, 'accuracy': 0.3993233588299571, 'macro avg': {'precision': 0.40577749964838267, 'recall': 0.4101763992967567, 'f1-score': 0.3963419978050627, 'support': 237940}, 'weighted avg': {'precision': 0.4085800548562088, 'recall': 0.3993233588299571, 'f1-score': 0.3916067138682402, 'support': 237940}}
[[37181 14543 20262]
 [35422 24000 31219]
 [25866 15613 33834]]
Evaluating performance on  train set...
381/381 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9884629
{'0': {'precision': 0.4793357135129287, 'recall': 0.5644668110587336, 'f1-score': 0.5184296747016147, 'support': 31396}, '1': {'precision': 0.5670332936979786, 'recall': 0.4356887937187723, 'f1-score': 0.49275877100925136, 'support': 35025}, '2': {'precision': 0.4782970626709478, 'recall': 0.5173156693141259, 'f1-score': 0.49704178574187075, 'support': 31099}, 'accuracy': 0.5031788351107465, 'macro avg': {'precision': 0.5082220232939517, 'recall': 0.5058237580305439, 'f1-score': 0.5027434104842456, 'support': 97520}, 'weighted avg': {'precision': 0.5105016973464666, 'recall': 0.5031788351107465, 'f1-score': 0.5023892177637137, 'support': 97520}}
[[17722  5531  8143]
 [10360 15260  9405]
 [ 8890  6121 16088]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0113158
{'0': {'precision': 0.4777231014762601, 'recall': 0.5511062014790267, 'f1-score': 0.5117975606975949, 'support': 32589}, '1': {'precision': 0.5154499960282787, 'recall': 0.39814701190330104, 'f1-score': 0.44926783674317167, 'support': 32596}, '2': {'precision': 0.4772498345180879, 'recall': 0.5128498531003557, 'f1-score': 0.4944098267791658, 'support': 32335}, 'accuracy': 0.4872949138638228, 'macro avg': {'precision': 0.4901409773408756, 'recall': 0.4873676888275611, 'f1-score': 0.48515840807331073, 'support': 97520}, 'weighted avg': {'precision': 0.49017637021831406, 'recall': 0.4872949138638228, 'f1-score': 0.48513173565380097, 'support': 97520}}
[[17960  5910  8719]
 [10173 12978  9445]
 [ 9462  6290 16583]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0320277
{'0': {'precision': 0.46302545188207905, 'recall': 0.5379098672015072, 'f1-score': 0.4976664417453891, 'support': 32907}, '1': {'precision': 0.47344479960658964, 'recall': 0.36327903905414755, 'f1-score': 0.41110952957084906, 'support': 31802}, '2': {'precision': 0.465648198572616, 'recall': 0.4951388253939228, 'f1-score': 0.4799409158050222, 'support': 32811}, 'accuracy': 0.4665709598031173, 'macro avg': {'precision': 0.4673728166870949, 'recall': 0.4654425772165259, 'f1-score': 0.46290562904042015, 'support': 97520}, 'weighted avg': {'precision': 0.4673057127311161, 'recall': 0.4665709598031173, 'f1-score': 0.46347576134542906, 'support': 97520}}
[[17701  6240  8966]
 [10572 11553  9677]
 [ 9956  6609 16246]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0615228
{'0': {'precision': 0.42833311612146485, 'recall': 0.5072383245362225, 'f1-score': 0.4644583250897374, 'support': 32397}, '1': {'precision': 0.4215753562921394, 'recall': 0.3218865598027127, 'f1-score': 0.36504745756786516, 'support': 32440}, '2': {'precision': 0.43543884138893735, 'recall': 0.458128078817734, 'f1-score': 0.4464954002594343, 'support': 32683}, 'accuracy': 0.4291222313371616, 'macro avg': {'precision': 0.4284491046008472, 'recall': 0.42908432105222305, 'f1-score': 0.4253337276390123, 'support': 97520}, 'weighted avg': {'precision': 0.42846657274629557, 'recall': 0.4291222313371616, 'f1-score': 0.42536920681001705, 'support': 97520}}
[[16433  7018  8946]
 [11531 10442 10467]
 [10401  7309 14973]]
Evaluating performance on  val set...
114/114 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0240078
{'0': {'precision': 0.45060319530485815, 'recall': 0.5698969072164949, 'f1-score': 0.5032774945375091, 'support': 9700}, '1': {'precision': 0.5045929680076021, 'recall': 0.325567136725935, 'f1-score': 0.39577639751552796, 'support': 9786}, '2': {'precision': 0.4688899475940924, 'recall': 0.5130851840266917, 'f1-score': 0.48999302997112415, 'support': 9591}, 'accuracy': 0.46892733088007704, 'macro avg': {'precision': 0.4746953703021843, 'recall': 0.46951640932304056, 'f1-score': 0.4630156406747204, 'support': 29077}, 'weighted avg': {'precision': 0.474805559953037, 'recall': 0.46892733088007704, 'f1-score': 0.46271564031894097, 'support': 29077}}
[[5528 1566 2606]
 [3632 3186 2968]
 [3108 1562 4921]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0452329
{'0': {'precision': 0.44053989297979396, 'recall': 0.55903516773082, 'f1-score': 0.4927639807039485, 'support': 9867}, '1': {'precision': 0.4558595766649458, 'recall': 0.2827711357813834, 'f1-score': 0.3490348507806838, 'support': 9368}, '2': {'precision': 0.4668217775709632, 'recall': 0.5096525096525096, 'f1-score': 0.48729780929712924, 'support': 9842}, 'accuracy': 0.4533136155724456, 'macro avg': {'precision': 0.45440708240523425, 'recall': 0.4504862710549043, 'f1-score': 0.4430322135939205, 'support': 29077}, 'weighted avg': {'precision': 0.45437148168938546, 'recall': 0.4533136155724456, 'f1-score': 0.4446072744375848, 'support': 29077}}
[[5516 1589 2762]
 [3752 2649 2967]
 [3253 1573 5016]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0569254
{'0': {'precision': 0.4332076064749332, 'recall': 0.5550745066451873, 'f1-score': 0.48662723982699274, 'support': 9932}, '1': {'precision': 0.40941385435168737, 'recall': 0.25461173091792777, 'f1-score': 0.3139685350405231, 'support': 9053}, '2': {'precision': 0.46506855703758976, 'recall': 0.4940546967895363, 'f1-score': 0.4791236246576659, 'support': 10092}, 'accuracy': 0.4403480414072979, 'macro avg': {'precision': 0.43589667262140347, 'recall': 0.43458031145088377, 'f1-score': 0.4265731331750606, 'support': 29077}, 'weighted avg': {'precision': 0.4368577724173133, 'recall': 0.4403480414072979, 'f1-score': 0.43026634500563027, 'support': 29077}}
[[5513 1649 2770]
 [3783 2305 2965]
 [3430 1676 4986]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0770657
{'0': {'precision': 0.4022862511744441, 'recall': 0.5362137340847423, 'f1-score': 0.4596940144940503, 'support': 9582}, '1': {'precision': 0.384012539184953, 'recall': 0.22999895692083028, 'f1-score': 0.2876899993476417, 'support': 9587}, '2': {'precision': 0.42857142857142855, 'recall': 0.4569035123132822, 'f1-score': 0.44228420692687215, 'support': 9908}, 'accuracy': 0.4082264332634041, 'macro avg': {'precision': 0.4049567396436085, 'recall': 0.4077054011062849, 'f1-score': 0.39655607358952144, 'support': 29077}, 'weighted avg': {'precision': 0.4052178968327331, 'recall': 0.4082264332634041, 'f1-score': 0.39705003930458027, 'support': 29077}}
[[5138 1744 2700]
 [4046 2205 3336]
 [3588 1793 4527]]
training model: results/XRAY/W7/deepVOL_L2/seq2seq
Epoch 1/50
381/381 - 18s - loss: 13.0900 - accuracy10: 0.4047 - accuracy20: 0.3959 - accuracy30: 0.3842 - accuracy50: 0.3672 - val_loss: 13.0634 - val_accuracy10: 0.4089 - val_accuracy20: 0.4026 - val_accuracy30: 0.3915 - val_accuracy50: 0.3682 - 18s/epoch - 46ms/step
Epoch 2/50
381/381 - 12s - loss: 12.7737 - accuracy10: 0.4495 - accuracy20: 0.4386 - accuracy30: 0.4204 - accuracy50: 0.3949 - val_loss: 12.9355 - val_accuracy10: 0.4304 - val_accuracy20: 0.4222 - val_accuracy30: 0.4095 - val_accuracy50: 0.3799 - 12s/epoch - 32ms/step
Epoch 3/50
381/381 - 12s - loss: 12.6308 - accuracy10: 0.4674 - accuracy20: 0.4545 - accuracy30: 0.4356 - accuracy50: 0.4035 - val_loss: 12.8726 - val_accuracy10: 0.4465 - val_accuracy20: 0.4329 - val_accuracy30: 0.4176 - val_accuracy50: 0.3890 - 12s/epoch - 32ms/step
Epoch 4/50
381/381 - 12s - loss: 12.5580 - accuracy10: 0.4776 - accuracy20: 0.4632 - accuracy30: 0.4432 - accuracy50: 0.4095 - val_loss: 12.8444 - val_accuracy10: 0.4499 - val_accuracy20: 0.4345 - val_accuracy30: 0.4208 - val_accuracy50: 0.3878 - 12s/epoch - 33ms/step
Epoch 5/50
381/381 - 12s - loss: 12.5119 - accuracy10: 0.4829 - accuracy20: 0.4672 - accuracy30: 0.4472 - accuracy50: 0.4150 - val_loss: 12.8553 - val_accuracy10: 0.4521 - val_accuracy20: 0.4367 - val_accuracy30: 0.4232 - val_accuracy50: 0.3897 - 12s/epoch - 32ms/step
Epoch 6/50
381/381 - 12s - loss: 12.4793 - accuracy10: 0.4867 - accuracy20: 0.4718 - accuracy30: 0.4500 - accuracy50: 0.4156 - val_loss: 12.8451 - val_accuracy10: 0.4599 - val_accuracy20: 0.4432 - val_accuracy30: 0.4268 - val_accuracy50: 0.3922 - 12s/epoch - 32ms/step
Epoch 7/50
381/381 - 12s - loss: 12.4460 - accuracy10: 0.4917 - accuracy20: 0.4756 - accuracy30: 0.4526 - accuracy50: 0.4188 - val_loss: 12.8020 - val_accuracy10: 0.4604 - val_accuracy20: 0.4416 - val_accuracy30: 0.4248 - val_accuracy50: 0.3900 - 12s/epoch - 32ms/step
Epoch 8/50
381/381 - 12s - loss: 12.4086 - accuracy10: 0.4950 - accuracy20: 0.4775 - accuracy30: 0.4546 - accuracy50: 0.4196 - val_loss: 12.7698 - val_accuracy10: 0.4646 - val_accuracy20: 0.4479 - val_accuracy30: 0.4289 - val_accuracy50: 0.3936 - 12s/epoch - 32ms/step
Epoch 9/50
381/381 - 12s - loss: 12.3748 - accuracy10: 0.4980 - accuracy20: 0.4817 - accuracy30: 0.4589 - accuracy50: 0.4226 - val_loss: 12.8012 - val_accuracy10: 0.4633 - val_accuracy20: 0.4446 - val_accuracy30: 0.4292 - val_accuracy50: 0.3935 - 12s/epoch - 32ms/step
Epoch 10/50
381/381 - 12s - loss: 12.3429 - accuracy10: 0.5014 - accuracy20: 0.4853 - accuracy30: 0.4623 - accuracy50: 0.4264 - val_loss: 12.7585 - val_accuracy10: 0.4672 - val_accuracy20: 0.4486 - val_accuracy30: 0.4324 - val_accuracy50: 0.3950 - 12s/epoch - 32ms/step
Epoch 11/50
381/381 - 12s - loss: 12.3117 - accuracy10: 0.5032 - accuracy20: 0.4865 - accuracy30: 0.4641 - accuracy50: 0.4272 - val_loss: 12.7217 - val_accuracy10: 0.4688 - val_accuracy20: 0.4509 - val_accuracy30: 0.4327 - val_accuracy50: 0.3972 - 12s/epoch - 32ms/step
Epoch 12/50
381/381 - 12s - loss: 12.2925 - accuracy10: 0.5051 - accuracy20: 0.4883 - accuracy30: 0.4664 - accuracy50: 0.4302 - val_loss: 12.7346 - val_accuracy10: 0.4698 - val_accuracy20: 0.4510 - val_accuracy30: 0.4338 - val_accuracy50: 0.3991 - 12s/epoch - 32ms/step
Epoch 13/50
381/381 - 12s - loss: 12.2689 - accuracy10: 0.5066 - accuracy20: 0.4914 - accuracy30: 0.4689 - accuracy50: 0.4315 - val_loss: 12.7326 - val_accuracy10: 0.4685 - val_accuracy20: 0.4515 - val_accuracy30: 0.4352 - val_accuracy50: 0.3984 - 12s/epoch - 32ms/step
Epoch 14/50
381/381 - 12s - loss: 12.2434 - accuracy10: 0.5084 - accuracy20: 0.4933 - accuracy30: 0.4711 - accuracy50: 0.4330 - val_loss: 12.7481 - val_accuracy10: 0.4673 - val_accuracy20: 0.4484 - val_accuracy30: 0.4312 - val_accuracy50: 0.3983 - 12s/epoch - 32ms/step
Epoch 15/50
381/381 - 12s - loss: 12.2293 - accuracy10: 0.5102 - accuracy20: 0.4946 - accuracy30: 0.4717 - accuracy50: 0.4363 - val_loss: 12.7637 - val_accuracy10: 0.4669 - val_accuracy20: 0.4476 - val_accuracy30: 0.4301 - val_accuracy50: 0.3949 - 12s/epoch - 32ms/step
Epoch 16/50
381/381 - 12s - loss: 12.2047 - accuracy10: 0.5115 - accuracy20: 0.4954 - accuracy30: 0.4743 - accuracy50: 0.4371 - val_loss: 12.7524 - val_accuracy10: 0.4685 - val_accuracy20: 0.4475 - val_accuracy30: 0.4308 - val_accuracy50: 0.3976 - 12s/epoch - 32ms/step
Epoch 17/50
381/381 - 12s - loss: 12.1888 - accuracy10: 0.5121 - accuracy20: 0.4969 - accuracy30: 0.4744 - accuracy50: 0.4377 - val_loss: 12.7713 - val_accuracy10: 0.4644 - val_accuracy20: 0.4472 - val_accuracy30: 0.4320 - val_accuracy50: 0.3968 - 12s/epoch - 32ms/step
Epoch 18/50
381/381 - 12s - loss: 12.1667 - accuracy10: 0.5142 - accuracy20: 0.4997 - accuracy30: 0.4764 - accuracy50: 0.4420 - val_loss: 12.7823 - val_accuracy10: 0.4678 - val_accuracy20: 0.4476 - val_accuracy30: 0.4292 - val_accuracy50: 0.3936 - 12s/epoch - 32ms/step
Epoch 19/50
381/381 - 12s - loss: 12.1472 - accuracy10: 0.5138 - accuracy20: 0.5002 - accuracy30: 0.4785 - accuracy50: 0.4424 - val_loss: 12.7869 - val_accuracy10: 0.4661 - val_accuracy20: 0.4467 - val_accuracy30: 0.4307 - val_accuracy50: 0.3974 - 12s/epoch - 32ms/step
Epoch 20/50
381/381 - 12s - loss: 12.1134 - accuracy10: 0.5174 - accuracy20: 0.5036 - accuracy30: 0.4816 - accuracy50: 0.4457 - val_loss: 12.7921 - val_accuracy10: 0.4660 - val_accuracy20: 0.4480 - val_accuracy30: 0.4331 - val_accuracy50: 0.3986 - 12s/epoch - 32ms/step
Epoch 21/50
381/381 - 12s - loss: 12.0938 - accuracy10: 0.5168 - accuracy20: 0.5042 - accuracy30: 0.4824 - accuracy50: 0.4478 - val_loss: 12.8019 - val_accuracy10: 0.4652 - val_accuracy20: 0.4468 - val_accuracy30: 0.4313 - val_accuracy50: 0.4003 - 12s/epoch - 32ms/step
testing model: results/XRAY/W7/deepVOL_L2/seq2seq
Evaluating performance on  test set...
930/930 - 13s - 13s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0415578
{'0': {'precision': 0.3978429020516214, 'recall': 0.551584229390681, 'f1-score': 0.4622658512261646, 'support': 69750}, '1': {'precision': 0.582380873915844, 'recall': 0.40536764399215913, 'f1-score': 0.47801309439645895, 'support': 95908}, '2': {'precision': 0.4446726813812362, 'recall': 0.4581875025938274, 'f1-score': 0.4513289410033317, 'support': 72287}, 'accuracy': 0.4642753577507407, 'macro avg': {'precision': 0.4749654857829006, 'recall': 0.4717131253255558, 'f1-score': 0.463869295541985, 'support': 237945}, 'weighted avg': {'precision': 0.48645099242525286, 'recall': 0.4642753577507407, 'f1-score': 0.46529045846186473, 'support': 237945}}
[[38473 14322 16955]
 [32622 38878 24408]
 [25609 13557 33121]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0545259
{'0': {'precision': 0.3972815047987601, 'recall': 0.5618558806311519, 'f1-score': 0.46544937800985714, 'support': 73453}, '1': {'precision': 0.5193388321119911, 'recall': 0.3567534622286933, 'f1-score': 0.4229598356761965, 'support': 88599}, '2': {'precision': 0.45414059725144124, 'recall': 0.4380377636936213, 'f1-score': 0.44594386129648883, 'support': 75893}, 'accuracy': 0.4459938221017462, 'macro avg': {'precision': 0.45692031138739747, 'recall': 0.4522157021844888, 'f1-score': 0.4447843583275142, 'support': 237945}, 'weighted avg': {'precision': 0.46086495579010806, 'recall': 0.4459938221017462, 'f1-score': 0.44340704410434256, 'support': 237945}}
[[41270 15102 17081]
 [34114 31608 22877]
 [28497 14152 33244]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0675089
{'0': {'precision': 0.3890687094279909, 'recall': 0.5740266631292698, 'f1-score': 0.463787532086149, 'support': 75385}, '1': {'precision': 0.46886664562016006, 'recall': 0.2991894582168081, 'f1-score': 0.3652857049849172, 'support': 84388}, '2': {'precision': 0.4532206273842523, 'recall': 0.4225042214603694, 'f1-score': 0.43732372919507967, 'support': 78172}, 'accuracy': 0.4267750950849986, 'macro avg': {'precision': 0.4370519941441344, 'recall': 0.4319067809354824, 'f1-score': 0.42213232208871526, 'support': 237945}, 'weighted avg': {'precision': 0.43844512822166853, 'recall': 0.4267750950849986, 'f1-score': 0.4201593802652685, 'support': 237945}}
[[43273 14612 17500]
 [36794 25248 22346]
 [31155 13989 33028]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0963343
{'0': {'precision': 0.34878330418244496, 'recall': 0.5706209195721628, 'f1-score': 0.432939167825977, 'support': 71990}, '1': {'precision': 0.41296229878267476, 'recall': 0.2159484565653891, 'f1-score': 0.28359690236958585, 'support': 90642}, '2': {'precision': 0.40260828935795956, 'recall': 0.3890032265345956, 'f1-score': 0.39568884596943565, 'support': 75313}, 'accuracy': 0.37802853600621994, 'macro avg': {'precision': 0.38811796410769306, 'recall': 0.3918575342240492, 'f1-score': 0.37074163872166616, 'support': 237945}, 'weighted avg': {'precision': 0.3902678217687677, 'recall': 0.37802853600621994, 'f1-score': 0.364258947121697, 'support': 237945}}
[[41079 14173 16738]
 [44335 19574 26733]
 [32364 13652 29297]]
Evaluating performance on  train set...
381/381 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.005086
{'0': {'precision': 0.46909121218014616, 'recall': 0.537262139629606, 'f1-score': 0.5008677079161661, 'support': 31426}, '1': {'precision': 0.5897695927308129, 'recall': 0.41587528604118995, 'f1-score': 0.48778769375293557, 'support': 34960}, '2': {'precision': 0.4624416964963662, 'recall': 0.5477115786092822, 'f1-score': 0.5014777021364192, 'support': 31135}, 'accuracy': 0.4970826796279776, 'macro avg': {'precision': 0.5071008338024418, 'recall': 0.5002830014266927, 'f1-score': 0.49671103460184024, 'support': 97521}, 'weighted avg': {'precision': 0.5102298747578148, 'recall': 0.4970826796279776, 'f1-score': 0.4963734438592044, 'support': 97521}}
[[16884  5205  9337]
 [ 9935 14539 10486]
 [ 9174  4908 17053]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0231603
{'0': {'precision': 0.46720656401513133, 'recall': 0.5376620987767865, 'f1-score': 0.49996436563707114, 'support': 32619}, '1': {'precision': 0.5300681959082455, 'recall': 0.36753868828297714, 'f1-score': 0.43408884859474167, 'support': 32568}, '2': {'precision': 0.4604422341648619, 'recall': 0.5325972660357519, 'f1-score': 0.4938983293898329, 'support': 32334}, 'accuracy': 0.47916858932947776, 'macro avg': {'precision': 0.4859056646960796, 'recall': 0.47926601769850513, 'f1-score': 0.47598384787388187, 'support': 97521}, 'weighted avg': {'precision': 0.4859569848077435, 'recall': 0.47916858932947776, 'f1-score': 0.4759534033309752, 'support': 97521}}
[[17538  5363  9718]
 [10136 11970 10462]
 [ 9864  5249 17221]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.043098
{'0': {'precision': 0.453022280203617, 'recall': 0.537334263782275, 'f1-score': 0.49158940765003056, 'support': 32959}, '1': {'precision': 0.48463673307562694, 'recall': 0.30826214418560666, 'f1-score': 0.37683281632338494, 'support': 31723}, '2': {'precision': 0.44569934640522874, 'recall': 0.5191388288315723, 'f1-score': 0.4796241331288948, 'support': 32839}, 'accuracy': 0.4566913792926652, 'macro avg': {'precision': 0.46111945322815756, 'recall': 0.45491174559981795, 'f1-score': 0.4493487857007701, 'support': 97521}, 'weighted avg': {'precision': 0.4608403651848364, 'recall': 0.4566913792926652, 'f1-score': 0.4502306131682804, 'support': 97521}}
[[17710  5179 10070]
 [10812  9779 11132]
 [10571  5220 17048]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0698522
{'0': {'precision': 0.4160823511860361, 'recall': 0.5172957432996383, 'f1-score': 0.46120137252470134, 'support': 32349}, '1': {'precision': 0.4240489056274221, 'recall': 0.23928175434273746, 'f1-score': 0.3059323869341786, 'support': 32468}, '2': {'precision': 0.41737212046585603, 'recall': 0.4974926614481409, 'f1-score': 0.4539240576960634, 'support': 32704}, 'accuracy': 0.4180945642477005, 'macro avg': {'precision': 0.4191677924264381, 'recall': 0.4180233863635056, 'f1-score': 0.4070192723849811, 'support': 97521}, 'weighted avg': {'precision': 0.41916721192505796, 'recall': 0.4180945642477005, 'f1-score': 0.407066665863481, 'support': 97521}}
[[16734  5215 10400]
 [12387  7769 12312]
 [11097  5337 16270]]
Evaluating performance on  val set...
114/114 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.039931
{'0': {'precision': 0.46104011359602415, 'recall': 0.5325474115838031, 'f1-score': 0.4942206155163392, 'support': 9755}, '1': {'precision': 0.5264247055078001, 'recall': 0.33935351462288355, 'f1-score': 0.41267860485430835, 'support': 9745}, '2': {'precision': 0.44729764899800467, 'recall': 0.5383731857575441, 'f1-score': 0.4886277482941623, 'support': 9577}, 'accuracy': 0.4697183340784813, 'macro avg': {'precision': 0.478254156033943, 'recall': 0.4700913706547436, 'f1-score': 0.46517565622160334, 'support': 29077}, 'weighted avg': {'precision': 0.47842709522153654, 'recall': 0.4697183340784813, 'f1-score': 0.4650501445843903, 'support': 29077}}
[[5195 1529 3031]
 [3098 3307 3340]
 [2975 1446 5156]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.053681
{'0': {'precision': 0.4462314997005732, 'recall': 0.5271881948655751, 'f1-score': 0.4833433720984108, 'support': 9894}, '1': {'precision': 0.4711079696059374, 'recall': 0.28580617495711835, 'f1-score': 0.35577500500433706, 'support': 9328}, '2': {'precision': 0.44291925995396025, 'recall': 0.5271435819381025, 'f1-score': 0.4813750926612306, 'support': 9855}, 'accuracy': 0.44973690545792205, 'macro avg': {'precision': 0.45341957642015696, 'recall': 0.44671265058693194, 'f1-score': 0.4401644899213261, 'support': 29077}, 'weighted avg': {'precision': 0.45308934571544285, 'recall': 0.44973690545792205, 'f1-score': 0.4417519038552312, 'support': 29077}}
[[5216 1515 3163]
 [3291 2666 3371]
 [3182 1478 5195]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0654552
{'0': {'precision': 0.4316338354577057, 'recall': 0.5251762336354482, 'f1-score': 0.4738324550245321, 'support': 9930}, '1': {'precision': 0.43354112205911927, 'recall': 0.23723591549295775, 'f1-score': 0.3066638219187825, 'support': 9088}, '2': {'precision': 0.43195807685909166, 'recall': 0.516254100805249, 'f1-score': 0.4703591322856755, 'support': 10059}, 'accuracy': 0.4320940949891667, 'macro avg': {'precision': 0.43237767812530553, 'recall': 0.4262220833112183, 'f1-score': 0.41695180307633, 'support': 29077}, 'weighted avg': {'precision': 0.4323421260272344, 'recall': 0.4320940949891667, 'f1-score': 0.42038241921976505, 'support': 29077}}
[[5215 1413 3302]
 [3405 2156 3527]
 [3462 1404 5193]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0865266
{'0': {'precision': 0.39541409444399905, 'recall': 0.5161155295102553, 'f1-score': 0.44777338962277, 'support': 9556}, '1': {'precision': 0.3911488600804649, 'recall': 0.181893774035963, 'f1-score': 0.24831500532103584, 'support': 9621}, '2': {'precision': 0.39719703215169, 'recall': 0.4866666666666667, 'f1-score': 0.4374035406264185, 'support': 9900}, 'accuracy': 0.3955015992021185, 'macro avg': {'precision': 0.39458666222538463, 'recall': 0.3948919900709617, 'f1-score': 0.3778306451900748, 'support': 29077}, 'weighted avg': {'precision': 0.39460985960184125, 'recall': 0.3955015992021185, 'f1-score': 0.3782459067176951, 'support': 29077}}
[[4932 1329 3295]
 [3854 1750 4017]
 [3687 1395 4818]]
training model: results/XRAY/W7/deepVOL_L3/seq2seq
Epoch 1/50
381/381 - 23s - loss: 13.2096 - accuracy10: 0.3794 - accuracy20: 0.3722 - accuracy30: 0.3661 - accuracy50: 0.3545 - val_loss: 13.2132 - val_accuracy10: 0.3616 - val_accuracy20: 0.3602 - val_accuracy30: 0.3536 - val_accuracy50: 0.3473 - 23s/epoch - 60ms/step
Epoch 2/50
381/381 - 17s - loss: 13.0585 - accuracy10: 0.3960 - accuracy20: 0.3854 - accuracy30: 0.3738 - accuracy50: 0.3641 - val_loss: 13.1970 - val_accuracy10: 0.3624 - val_accuracy20: 0.3621 - val_accuracy30: 0.3640 - val_accuracy50: 0.3562 - 17s/epoch - 44ms/step
Epoch 3/50
381/381 - 17s - loss: 12.9746 - accuracy10: 0.4105 - accuracy20: 0.4024 - accuracy30: 0.3907 - accuracy50: 0.3733 - val_loss: 13.1799 - val_accuracy10: 0.3867 - val_accuracy20: 0.3865 - val_accuracy30: 0.3822 - val_accuracy50: 0.3658 - 17s/epoch - 44ms/step
Epoch 4/50
381/381 - 17s - loss: 12.7870 - accuracy10: 0.4427 - accuracy20: 0.4313 - accuracy30: 0.4152 - accuracy50: 0.3925 - val_loss: 12.9919 - val_accuracy10: 0.4209 - val_accuracy20: 0.4157 - val_accuracy30: 0.4052 - val_accuracy50: 0.3784 - 17s/epoch - 45ms/step
Epoch 5/50
381/381 - 17s - loss: 12.6357 - accuracy10: 0.4601 - accuracy20: 0.4492 - accuracy30: 0.4331 - accuracy50: 0.4055 - val_loss: 12.8331 - val_accuracy10: 0.4482 - val_accuracy20: 0.4368 - val_accuracy30: 0.4243 - val_accuracy50: 0.3909 - 17s/epoch - 45ms/step
Epoch 6/50
381/381 - 17s - loss: 12.5562 - accuracy10: 0.4718 - accuracy20: 0.4611 - accuracy30: 0.4430 - accuracy50: 0.4105 - val_loss: 12.8723 - val_accuracy10: 0.4453 - val_accuracy20: 0.4352 - val_accuracy30: 0.4199 - val_accuracy50: 0.3896 - 17s/epoch - 44ms/step
Epoch 7/50
381/381 - 17s - loss: 12.4876 - accuracy10: 0.4818 - accuracy20: 0.4688 - accuracy30: 0.4496 - accuracy50: 0.4171 - val_loss: 12.8912 - val_accuracy10: 0.4500 - val_accuracy20: 0.4378 - val_accuracy30: 0.4237 - val_accuracy50: 0.3917 - 17s/epoch - 44ms/step
Epoch 8/50
381/381 - 17s - loss: 12.4557 - accuracy10: 0.4867 - accuracy20: 0.4723 - accuracy30: 0.4531 - accuracy50: 0.4194 - val_loss: 12.7787 - val_accuracy10: 0.4606 - val_accuracy20: 0.4473 - val_accuracy30: 0.4327 - val_accuracy50: 0.3963 - 17s/epoch - 44ms/step
Epoch 9/50
381/381 - 17s - loss: 12.4059 - accuracy10: 0.4929 - accuracy20: 0.4767 - accuracy30: 0.4558 - accuracy50: 0.4219 - val_loss: 12.7932 - val_accuracy10: 0.4631 - val_accuracy20: 0.4503 - val_accuracy30: 0.4341 - val_accuracy50: 0.4002 - 17s/epoch - 45ms/step
Epoch 10/50
381/381 - 17s - loss: 12.3649 - accuracy10: 0.4957 - accuracy20: 0.4802 - accuracy30: 0.4585 - accuracy50: 0.4254 - val_loss: 12.7935 - val_accuracy10: 0.4632 - val_accuracy20: 0.4503 - val_accuracy30: 0.4333 - val_accuracy50: 0.3992 - 17s/epoch - 45ms/step
Epoch 11/50
381/381 - 17s - loss: 12.3324 - accuracy10: 0.4996 - accuracy20: 0.4846 - accuracy30: 0.4637 - accuracy50: 0.4286 - val_loss: 12.8107 - val_accuracy10: 0.4600 - val_accuracy20: 0.4481 - val_accuracy30: 0.4321 - val_accuracy50: 0.4000 - 17s/epoch - 44ms/step
Epoch 12/50
381/381 - 17s - loss: 12.3100 - accuracy10: 0.5022 - accuracy20: 0.4866 - accuracy30: 0.4638 - accuracy50: 0.4295 - val_loss: 12.7799 - val_accuracy10: 0.4627 - val_accuracy20: 0.4494 - val_accuracy30: 0.4326 - val_accuracy50: 0.4007 - 17s/epoch - 44ms/step
Epoch 13/50
381/381 - 17s - loss: 12.2774 - accuracy10: 0.5048 - accuracy20: 0.4891 - accuracy30: 0.4665 - accuracy50: 0.4331 - val_loss: 12.7336 - val_accuracy10: 0.4694 - val_accuracy20: 0.4509 - val_accuracy30: 0.4353 - val_accuracy50: 0.3977 - 17s/epoch - 44ms/step
Epoch 14/50
381/381 - 17s - loss: 12.2458 - accuracy10: 0.5067 - accuracy20: 0.4918 - accuracy30: 0.4698 - accuracy50: 0.4357 - val_loss: 12.7546 - val_accuracy10: 0.4670 - val_accuracy20: 0.4506 - val_accuracy30: 0.4330 - val_accuracy50: 0.4025 - 17s/epoch - 44ms/step
Epoch 15/50
381/381 - 17s - loss: 12.2216 - accuracy10: 0.5102 - accuracy20: 0.4941 - accuracy30: 0.4714 - accuracy50: 0.4386 - val_loss: 12.7664 - val_accuracy10: 0.4620 - val_accuracy20: 0.4475 - val_accuracy30: 0.4327 - val_accuracy50: 0.4001 - 17s/epoch - 44ms/step
Epoch 16/50
381/381 - 17s - loss: 12.1962 - accuracy10: 0.5109 - accuracy20: 0.4944 - accuracy30: 0.4742 - accuracy50: 0.4424 - val_loss: 12.7273 - val_accuracy10: 0.4708 - val_accuracy20: 0.4547 - val_accuracy30: 0.4374 - val_accuracy50: 0.4012 - 17s/epoch - 44ms/step
Epoch 17/50
381/381 - 17s - loss: 12.1743 - accuracy10: 0.5123 - accuracy20: 0.4989 - accuracy30: 0.4752 - accuracy50: 0.4436 - val_loss: 12.7340 - val_accuracy10: 0.4679 - val_accuracy20: 0.4512 - val_accuracy30: 0.4324 - val_accuracy50: 0.3976 - 17s/epoch - 44ms/step
Epoch 18/50
381/381 - 17s - loss: 12.1569 - accuracy10: 0.5136 - accuracy20: 0.4987 - accuracy30: 0.4774 - accuracy50: 0.4438 - val_loss: 12.7659 - val_accuracy10: 0.4672 - val_accuracy20: 0.4456 - val_accuracy30: 0.4279 - val_accuracy50: 0.3931 - 17s/epoch - 45ms/step
Epoch 19/50
381/381 - 17s - loss: 12.1456 - accuracy10: 0.5140 - accuracy20: 0.4987 - accuracy30: 0.4766 - accuracy50: 0.4449 - val_loss: 12.7377 - val_accuracy10: 0.4700 - val_accuracy20: 0.4512 - val_accuracy30: 0.4318 - val_accuracy50: 0.3971 - 17s/epoch - 44ms/step
Epoch 20/50
381/381 - 17s - loss: 12.1122 - accuracy10: 0.5163 - accuracy20: 0.5026 - accuracy30: 0.4791 - accuracy50: 0.4465 - val_loss: 12.8205 - val_accuracy10: 0.4623 - val_accuracy20: 0.4417 - val_accuracy30: 0.4260 - val_accuracy50: 0.3925 - 17s/epoch - 44ms/step
Epoch 21/50
381/381 - 17s - loss: 12.0942 - accuracy10: 0.5174 - accuracy20: 0.5025 - accuracy30: 0.4824 - accuracy50: 0.4493 - val_loss: 12.8137 - val_accuracy10: 0.4631 - val_accuracy20: 0.4455 - val_accuracy30: 0.4266 - val_accuracy50: 0.3896 - 17s/epoch - 45ms/step
Epoch 22/50
381/381 - 17s - loss: 12.0704 - accuracy10: 0.5190 - accuracy20: 0.5048 - accuracy30: 0.4835 - accuracy50: 0.4488 - val_loss: 12.8222 - val_accuracy10: 0.4630 - val_accuracy20: 0.4444 - val_accuracy30: 0.4256 - val_accuracy50: 0.3921 - 17s/epoch - 44ms/step
Epoch 23/50
381/381 - 17s - loss: 12.0526 - accuracy10: 0.5203 - accuracy20: 0.5062 - accuracy30: 0.4854 - accuracy50: 0.4526 - val_loss: 12.8414 - val_accuracy10: 0.4627 - val_accuracy20: 0.4423 - val_accuracy30: 0.4246 - val_accuracy50: 0.3908 - 17s/epoch - 46ms/step
Epoch 24/50
381/381 - 17s - loss: 12.0376 - accuracy10: 0.5201 - accuracy20: 0.5065 - accuracy30: 0.4871 - accuracy50: 0.4518 - val_loss: 12.8724 - val_accuracy10: 0.4574 - val_accuracy20: 0.4402 - val_accuracy30: 0.4232 - val_accuracy50: 0.3906 - 17s/epoch - 45ms/step
Epoch 25/50
381/381 - 17s - loss: 12.0215 - accuracy10: 0.5198 - accuracy20: 0.5068 - accuracy30: 0.4874 - accuracy50: 0.4553 - val_loss: 12.8825 - val_accuracy10: 0.4546 - val_accuracy20: 0.4389 - val_accuracy30: 0.4217 - val_accuracy50: 0.3891 - 17s/epoch - 45ms/step
Epoch 26/50
381/381 - 17s - loss: 12.0045 - accuracy10: 0.5210 - accuracy20: 0.5081 - accuracy30: 0.4893 - accuracy50: 0.4565 - val_loss: 12.8468 - val_accuracy10: 0.4584 - val_accuracy20: 0.4397 - val_accuracy30: 0.4233 - val_accuracy50: 0.3889 - 17s/epoch - 45ms/step
testing model: results/XRAY/W7/deepVOL_L3/seq2seq
Evaluating performance on  test set...
930/930 - 20s - 20s/epoch - 22ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0862927
{'0': {'precision': 0.3811061955093201, 'recall': 0.5903512544802867, 'f1-score': 0.4631937726383046, 'support': 69750}, '1': {'precision': 0.67455146218695, 'recall': 0.227759936605914, 'f1-score': 0.3405383074416756, 'support': 95908}, '2': {'precision': 0.42193076008039704, 'recall': 0.5691894808195112, 'f1-score': 0.4846204130669069, 'support': 72287}, 'accuracy': 0.43777343503750865, 'macro avg': {'precision': 0.4925294725922223, 'recall': 0.4624335573019039, 'f1-score': 0.42945083104896237, 'support': 237945}, 'weighted avg': {'precision': 0.511786957600003, 'recall': 0.43777343503750865, 'f1-score': 0.4202646385971778, 'support': 237945}}
[[41177  5122 23451]
 [41144 21844 32920]
 [25725  5417 41145]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.084066
{'0': {'precision': 0.3911605422890997, 'recall': 0.5860618354594094, 'f1-score': 0.4691752268330563, 'support': 73453}, '1': {'precision': 0.6060224039188848, 'recall': 0.1899005632117744, 'f1-score': 0.2891837541465427, 'support': 88599}, '2': {'precision': 0.4285528812543693, 'recall': 0.5654144651021833, 'f1-score': 0.48756128460485276, 'support': 75893}, 'accuracy': 0.43196537014856373, 'macro avg': {'precision': 0.4752452758207846, 'recall': 0.447125621257789, 'f1-score': 0.41530675519481725, 'support': 237945}, 'weighted avg': {'precision': 0.48309087433906306, 'recall': 0.43196537014856373, 'f1-score': 0.4080195336851546, 'support': 237945}}
[[43048  5403 25002]
 [39557 16825 32217]
 [27447  5535 42911]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0856491
{'0': {'precision': 0.39173082253636987, 'recall': 0.5811500961729787, 'f1-score': 0.4680005554902736, 'support': 75385}, '1': {'precision': 0.5504302625256629, 'recall': 0.14932217850879273, 'f1-score': 0.2349157819185131, 'support': 84388}, '2': {'precision': 0.42823233057210675, 'recall': 0.5654198434221972, 'f1-score': 0.48735576419478793, 'support': 78172}, 'accuracy': 0.4228330076278132, 'macro avg': {'precision': 0.45679780521137986, 'recall': 0.43196403936798955, 'f1-score': 0.39675736720119154, 'support': 237945}, 'weighted avg': {'precision': 0.46000594589675187, 'recall': 0.4228330076278132, 'f1-score': 0.3916950122036972, 'support': 237945}}
[[43810  5036 26539]
 [39311 12601 32476]
 [28716  5256 44200]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1095983
{'0': {'precision': 0.3611101259088491, 'recall': 0.5657174607584387, 'f1-score': 0.44082913892947995, 'support': 71990}, '1': {'precision': 0.4712019813458397, 'recall': 0.09865183910328545, 'f1-score': 0.16314689971629007, 'support': 90642}, '2': {'precision': 0.38738840546954456, 'recall': 0.5462005231500537, 'f1-score': 0.45328675875064045, 'support': 75313}, 'accuracy': 0.3816176007060455, 'macro avg': {'precision': 0.40656683757474443, 'recall': 0.40352327433725926, 'f1-score': 0.3524209324654701, 'support': 237945}, 'weighted avg': {'precision': 0.4113656136437221, 'recall': 0.3816176007060455, 'f1-score': 0.3389927784042708, 'support': 237945}}
[[40726  5059 26205]
 [42853  8942 38847]
 [29201  4976 41136]]
Evaluating performance on  train set...
381/381 - 8s - 8s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0163993
{'0': {'precision': 0.44549669038351886, 'recall': 0.5718195125055686, 'f1-score': 0.5008151833117345, 'support': 31426}, '1': {'precision': 0.6603991900491756, 'recall': 0.3265160183066362, 'f1-score': 0.43697961527418894, 'support': 34960}, '2': {'precision': 0.4552745682849194, 'recall': 0.5834270114019592, 'f1-score': 0.5114452234141397, 'support': 31135}, 'accuracy': 0.48758728889162334, 'macro avg': {'precision': 0.5203901495725379, 'recall': 0.49392084740472136, 'f1-score': 0.4830800073333544, 'support': 97521}, 'weighted avg': {'precision': 0.5256581491131409, 'recall': 0.48758728889162334, 'f1-score': 0.48132476422246956, 'support': 97521}}
[[17970  2878 10578]
 [12389 11415 11156]
 [ 9978  2992 18165]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0283471
{'0': {'precision': 0.44752080190744975, 'recall': 0.5639044728532451, 'f1-score': 0.4990165624448935, 'support': 32619}, '1': {'precision': 0.5953459119496856, 'recall': 0.29065340211250307, 'f1-score': 0.3906082363621358, 'support': 32568}, '2': {'precision': 0.4535896739801081, 'recall': 0.5684109605987505, 'f1-score': 0.5045502587402029, 'support': 32334}, 'accuracy': 0.4741440305165041, 'macro avg': {'precision': 0.4988187959457478, 'recall': 0.47432294518816615, 'f1-score': 0.46472501918241077, 'support': 97521}, 'weighted avg': {'precision': 0.4989004954447686, 'recall': 0.4741440305165041, 'f1-score': 0.4646473924420149, 'support': 97521}}
[[18394  3134 11091]
 [12053  9466 11049]
 [10655  3300 18379]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0458137
{'0': {'precision': 0.4366988712454563, 'recall': 0.5540520040049759, 'f1-score': 0.48842527582748246, 'support': 32959}, '1': {'precision': 0.5386399290635018, 'recall': 0.24893610314283013, 'f1-score': 0.3405053466712659, 'support': 31723}, '2': {'precision': 0.4396988597602573, 'recall': 0.5495599744206584, 'f1-score': 0.488529160970724, 'support': 32839}, 'accuracy': 0.45328698434183406, 'macro avg': {'precision': 0.4716792200230718, 'recall': 0.4508493605228215, 'f1-score': 0.4391532611564908, 'support': 97521}, 'weighted avg': {'precision': 0.4708698990240825, 'recall': 0.45328698434183406, 'f1-score': 0.440342786636398, 'support': 97521}}
[[18261  3254 11444]
 [12273  7897 11553]
 [11282  3510 18047]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0693406
{'0': {'precision': 0.4037824275705359, 'recall': 0.5273424217131906, 'f1-score': 0.4573642371677145, 'support': 32349}, '1': {'precision': 0.4706472654290015, 'recall': 0.20222988788961438, 'f1-score': 0.2829013981343846, 'support': 32468}, '2': {'precision': 0.4182275785295968, 'recall': 0.5284368884540117, 'f1-score': 0.46691702915191957, 'support': 32704}, 'accuracy': 0.4194686272700239, 'macro avg': {'precision': 0.43088575717637806, 'recall': 0.41933639935227224, 'f1-score': 0.4023942214846729, 'support': 97521}, 'weighted avg': {'precision': 0.43088819732837047, 'recall': 0.4194686272700239, 'f1-score': 0.4024832889751948, 'support': 97521}}
[[17059  3565 11725]
 [13587  6566 12315]
 [11602  3820 17282]]
Evaluating performance on  val set...
114/114 - 2s - 2s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0417966
{'0': {'precision': 0.43937448062249757, 'recall': 0.5962070732957457, 'f1-score': 0.5059151009046625, 'support': 9755}, '1': {'precision': 0.6165674603174603, 'recall': 0.2551051821446896, 'f1-score': 0.36089134064019746, 'support': 9745}, '2': {'precision': 0.452320460704607, 'recall': 0.5576902996763078, 'f1-score': 0.49950900163666123, 'support': 9577}, 'accuracy': 0.4692024624273481, 'macro avg': {'precision': 0.5027541338815217, 'recall': 0.4696675183722477, 'f1-score': 0.45543848106050705, 'support': 29077}, 'weighted avg': {'precision': 0.5030237304891886, 'recall': 0.4692024624273481, 'f1-score': 0.45520121169783717, 'support': 29077}}
[[5816  726 3213]
 [4005 2486 3254]
 [3416  820 5341]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.055218
{'0': {'precision': 0.43243042119363, 'recall': 0.5873256519102487, 'f1-score': 0.4981141779530259, 'support': 9894}, '1': {'precision': 0.541075729194541, 'recall': 0.21676672384219553, 'f1-score': 0.30952927669345576, 'support': 9328}, '2': {'precision': 0.44731977818853974, 'recall': 0.5402333840690005, 'f1-score': 0.48940570850760673, 'support': 9855}, 'accuracy': 0.45248822093063246, 'macro avg': {'precision': 0.47360864285890364, 'recall': 0.4481085866071482, 'f1-score': 0.43234972105136277, 'support': 29077}, 'weighted avg': {'precision': 0.4723306188143383, 'recall': 0.45248822093063246, 'f1-score': 0.434663962135236, 'support': 29077}}
[[5811  786 3297]
 [4025 2022 3281]
 [3602  929 5324]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0659544
{'0': {'precision': 0.42141812865497075, 'recall': 0.580563947633434, 'f1-score': 0.4883523930537907, 'support': 9930}, '1': {'precision': 0.4773055796472969, 'recall': 0.1816681338028169, 'f1-score': 0.2631704789989639, 'support': 9088}, '2': {'precision': 0.4388507287652873, 'recall': 0.5208271199920469, 'f1-score': 0.47633768241123786, 'support': 10059}, 'accuracy': 0.4352237163393748, 'macro avg': {'precision': 0.445858145689185, 'recall': 0.42768640047609924, 'f1-score': 0.4092868514879975, 'support': 29077}, 'weighted avg': {'precision': 0.4449164152432686, 'recall': 0.4352237163393748, 'f1-score': 0.41381550103316594, 'support': 29077}}
[[5765  807 3358]
 [4096 1651 3341]
 [3819 1001 5239]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0859168
{'0': {'precision': 0.39076633620377743, 'recall': 0.5650899958141482, 'f1-score': 0.46203208556149733, 'support': 9556}, '1': {'precision': 0.4254044337926902, 'recall': 0.14759380521775284, 'f1-score': 0.21915271240064818, 'support': 9621}, '2': {'precision': 0.40696308724832214, 'recall': 0.49, 'f1-score': 0.4446379468377636, 'support': 9900}, 'accuracy': 0.401382536025037, 'macro avg': {'precision': 0.40771128574826326, 'recall': 0.400894600343967, 'f1-score': 0.3752742482666364, 'support': 29077}, 'weighted avg': {'precision': 0.4077419861072724, 'recall': 0.401382536025037, 'f1-score': 0.37574586543749916, 'support': 29077}}
[[5400  833 3323]
 [4455 1420 3746]
 [3964 1085 4851]]
training model: results/XRAY/W8/deepLOB_L1/seq2seq
Epoch 1/50
327/327 - 16s - loss: 13.0645 - accuracy10: 0.3992 - accuracy20: 0.3950 - accuracy30: 0.3859 - accuracy50: 0.3742 - val_loss: 13.0279 - val_accuracy10: 0.3918 - val_accuracy20: 0.3901 - val_accuracy30: 0.3789 - val_accuracy50: 0.3781 - 16s/epoch - 49ms/step
Epoch 2/50
327/327 - 9s - loss: 12.8880 - accuracy10: 0.4263 - accuracy20: 0.4175 - accuracy30: 0.4082 - accuracy50: 0.3900 - val_loss: 12.8911 - val_accuracy10: 0.4178 - val_accuracy20: 0.4093 - val_accuracy30: 0.3970 - val_accuracy50: 0.3888 - 9s/epoch - 28ms/step
Epoch 3/50
327/327 - 9s - loss: 12.8419 - accuracy10: 0.4317 - accuracy20: 0.4229 - accuracy30: 0.4106 - accuracy50: 0.3930 - val_loss: 12.7765 - val_accuracy10: 0.4369 - val_accuracy20: 0.4267 - val_accuracy30: 0.4112 - val_accuracy50: 0.3955 - 9s/epoch - 28ms/step
Epoch 4/50
327/327 - 9s - loss: 12.8194 - accuracy10: 0.4380 - accuracy20: 0.4271 - accuracy30: 0.4150 - accuracy50: 0.3948 - val_loss: 12.8099 - val_accuracy10: 0.4265 - val_accuracy20: 0.4208 - val_accuracy30: 0.4071 - val_accuracy50: 0.3964 - 9s/epoch - 28ms/step
Epoch 5/50
327/327 - 9s - loss: 12.7894 - accuracy10: 0.4441 - accuracy20: 0.4320 - accuracy30: 0.4198 - accuracy50: 0.3981 - val_loss: 12.7795 - val_accuracy10: 0.4350 - val_accuracy20: 0.4228 - val_accuracy30: 0.4103 - val_accuracy50: 0.3963 - 9s/epoch - 27ms/step
Epoch 6/50
327/327 - 9s - loss: 12.7487 - accuracy10: 0.4493 - accuracy20: 0.4376 - accuracy30: 0.4255 - accuracy50: 0.4024 - val_loss: 12.7050 - val_accuracy10: 0.4498 - val_accuracy20: 0.4369 - val_accuracy30: 0.4215 - val_accuracy50: 0.4027 - 9s/epoch - 28ms/step
Epoch 7/50
327/327 - 9s - loss: 12.7239 - accuracy10: 0.4489 - accuracy20: 0.4377 - accuracy30: 0.4256 - accuracy50: 0.4040 - val_loss: 12.8061 - val_accuracy10: 0.4358 - val_accuracy20: 0.4229 - val_accuracy30: 0.4109 - val_accuracy50: 0.3949 - 9s/epoch - 28ms/step
Epoch 8/50
327/327 - 9s - loss: 12.7039 - accuracy10: 0.4513 - accuracy20: 0.4405 - accuracy30: 0.4280 - accuracy50: 0.4057 - val_loss: 12.7516 - val_accuracy10: 0.4527 - val_accuracy20: 0.4350 - val_accuracy30: 0.4164 - val_accuracy50: 0.3994 - 9s/epoch - 28ms/step
Epoch 9/50
327/327 - 9s - loss: 12.7015 - accuracy10: 0.4536 - accuracy20: 0.4410 - accuracy30: 0.4285 - accuracy50: 0.4070 - val_loss: 12.7941 - val_accuracy10: 0.4355 - val_accuracy20: 0.4234 - val_accuracy30: 0.4093 - val_accuracy50: 0.3959 - 9s/epoch - 28ms/step
Epoch 10/50
327/327 - 9s - loss: 12.6652 - accuracy10: 0.4575 - accuracy20: 0.4454 - accuracy30: 0.4308 - accuracy50: 0.4092 - val_loss: 12.7641 - val_accuracy10: 0.4566 - val_accuracy20: 0.4385 - val_accuracy30: 0.4212 - val_accuracy50: 0.4042 - 9s/epoch - 28ms/step
Epoch 11/50
327/327 - 9s - loss: 12.6427 - accuracy10: 0.4597 - accuracy20: 0.4482 - accuracy30: 0.4346 - accuracy50: 0.4125 - val_loss: 12.7463 - val_accuracy10: 0.4576 - val_accuracy20: 0.4416 - val_accuracy30: 0.4221 - val_accuracy50: 0.4063 - 9s/epoch - 28ms/step
Epoch 12/50
327/327 - 9s - loss: 12.6300 - accuracy10: 0.4609 - accuracy20: 0.4490 - accuracy30: 0.4354 - accuracy50: 0.4145 - val_loss: 12.7494 - val_accuracy10: 0.4559 - val_accuracy20: 0.4399 - val_accuracy30: 0.4234 - val_accuracy50: 0.4059 - 9s/epoch - 28ms/step
Epoch 13/50
327/327 - 9s - loss: 12.6006 - accuracy10: 0.4638 - accuracy20: 0.4511 - accuracy30: 0.4386 - accuracy50: 0.4167 - val_loss: 12.8314 - val_accuracy10: 0.4545 - val_accuracy20: 0.4368 - val_accuracy30: 0.4152 - val_accuracy50: 0.3989 - 9s/epoch - 27ms/step
Epoch 14/50
327/327 - 9s - loss: 12.5904 - accuracy10: 0.4652 - accuracy20: 0.4524 - accuracy30: 0.4405 - accuracy50: 0.4193 - val_loss: 12.8023 - val_accuracy10: 0.4534 - val_accuracy20: 0.4350 - val_accuracy30: 0.4154 - val_accuracy50: 0.3982 - 9s/epoch - 27ms/step
Epoch 15/50
327/327 - 9s - loss: 12.5680 - accuracy10: 0.4661 - accuracy20: 0.4550 - accuracy30: 0.4425 - accuracy50: 0.4217 - val_loss: 12.8215 - val_accuracy10: 0.4472 - val_accuracy20: 0.4257 - val_accuracy30: 0.4086 - val_accuracy50: 0.3933 - 9s/epoch - 27ms/step
Epoch 16/50
327/327 - 9s - loss: 12.5535 - accuracy10: 0.4663 - accuracy20: 0.4551 - accuracy30: 0.4422 - accuracy50: 0.4223 - val_loss: 12.7489 - val_accuracy10: 0.4529 - val_accuracy20: 0.4338 - val_accuracy30: 0.4139 - val_accuracy50: 0.4002 - 9s/epoch - 28ms/step
testing model: results/XRAY/W8/deepLOB_L1/seq2seq
Evaluating performance on  test set...
1162/1162 - 16s - 16s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0286257
{'0': {'precision': 0.3675414071952478, 'recall': 0.7070829278556587, 'f1-score': 0.4836708900613044, 'support': 76042}, '1': {'precision': 0.6086350519954266, 'recall': 0.38141705847430446, 'f1-score': 0.46895267180696204, 'support': 146543}, '2': {'precision': 0.3714208672497767, 'recall': 0.2943321135714095, 'f1-score': 0.32841336661326975, 'support': 74878}, 'accuracy': 0.44274750136991825, 'macro avg': {'precision': 0.4491991088134837, 'recall': 0.4609440333004575, 'f1-score': 0.4270123094938454, 'support': 297463}, 'weighted avg': {'precision': 0.48729099689183397, 'recall': 0.44274750136991825, 'f1-score': 0.4373383219826256, 'support': 297463}}
[[53768 15482  6792]
 [60143 55894 30506]
 [32380 20459 22039]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0395117
{'0': {'precision': 0.3609535453956291, 'recall': 0.7049283002126855, 'f1-score': 0.477438226872636, 'support': 76639}, '1': {'precision': 0.5936858901299293, 'recall': 0.35895668952210313, 'f1-score': 0.4474028902106461, 'support': 145115}, '2': {'precision': 0.3651623646960866, 'recall': 0.2896353141634416, 'f1-score': 0.3230430395038267, 'support': 75709}, 'accuracy': 0.43045017363504035, 'macro avg': {'precision': 0.43993393340721504, 'recall': 0.4511734346327434, 'f1-score': 0.4159613855290363, 'support': 297463}, 'weighted avg': {'precision': 0.47556141160600257, 'recall': 0.43045017363504035, 'f1-score': 0.42348972531039175, 'support': 297463}}
[[54025 15357  7257]
 [62160 52090 30865]
 [33488 20293 21928]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.052606
{'0': {'precision': 0.36034427082990095, 'recall': 0.6902693968237937, 'f1-score': 0.47350349635210315, 'support': 79214}, '1': {'precision': 0.5620373321999079, 'recall': 0.34206385134406864, 'f1-score': 0.4252901289164054, 'support': 139167}, '2': {'precision': 0.3640758402569523, 'recall': 0.28093624339293394, 'f1-score': 0.31714785339566753, 'support': 79082}, 'accuracy': 0.4185394486036919, 'macro avg': {'precision': 0.42881914776225366, 'recall': 0.4377564971869321, 'f1-score': 0.405313826221392, 'support': 297463}, 'weighted avg': {'precision': 0.4556977038454687, 'recall': 0.4185394486036919, 'f1-score': 0.40937912907884705, 'support': 297463}}
[[54679 16325  8210]
 [60967 47604 30596]
 [36095 20770 22217]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.066988
{'0': {'precision': 0.3385973605967347, 'recall': 0.6662048262325366, 'f1-score': 0.44899423734528804, 'support': 77949}, '1': {'precision': 0.5586221989859812, 'recall': 0.3266665718673568, 'f1-score': 0.4122568922586868, 'support': 140648}, '2': {'precision': 0.3350957185357651, 'recall': 0.26278751299672864, 'f1-score': 0.2945691260286823, 'support': 78866}, 'accuracy': 0.3987050490313081, 'macro avg': {'precision': 0.410771759372827, 'recall': 0.4185529703655407, 'f1-score': 0.38527341854421904, 'support': 297463}, 'weighted avg': {'precision': 0.4417022609271634, 'recall': 0.3987050490313081, 'f1-score': 0.3906813549335739, 'support': 297463}}
[[51930 16470  9549]
 [63129 45945 31574]
 [38309 19832 20725]]
Evaluating performance on  train set...
327/327 - 4s - 4s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0577617
{'0': {'precision': 0.4303781742284948, 'recall': 0.6248556998556999, 'f1-score': 0.5096960244828297, 'support': 27720}, '1': {'precision': 0.416968789407314, 'recall': 0.3800510039150893, 'f1-score': 0.3976548847172896, 'support': 27841}, '2': {'precision': 0.4834632516703786, 'recall': 0.3098747368045395, 'f1-score': 0.3776777364563624, 'support': 28021}, 'accuracy': 0.4377138618362805, 'macro avg': {'precision': 0.44360340510206253, 'recall': 0.4382604801917762, 'f1-score': 0.4283428818854939, 'support': 83582}, 'weighted avg': {'precision': 0.4437083921246031, 'recall': 0.4377138618362805, 'f1-score': 0.42811599743152634, 'support': 83582}}
[[17321  6767  3632]
 [11615 10581  5645]
 [11310  8028  8683]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0647895
{'0': {'precision': 0.41999757016158423, 'recall': 0.622905329921799, 'f1-score': 0.5017125275745966, 'support': 27749}, '1': {'precision': 0.408633387888707, 'recall': 0.3582908803903279, 'f1-score': 0.38180984057804795, 'support': 27874}, '2': {'precision': 0.47295268805248236, 'recall': 0.3042669623377088, 'f1-score': 0.3703042702302703, 'support': 27959}, 'accuracy': 0.4280706372185399, 'macro avg': {'precision': 0.4338612153675912, 'recall': 0.4284877242166119, 'f1-score': 0.41794221279430493, 'support': 83582}, 'weighted avg': {'precision': 0.43392170364053234, 'recall': 0.4280706372185399, 'f1-score': 0.41776848502438463, 'support': 83582}}
[[17285  6688  3776]
 [12183  9987  5704]
 [11687  7765  8507]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0733241
{'0': {'precision': 0.41523365160297265, 'recall': 0.6130601519778425, 'f1-score': 0.4951176495891943, 'support': 28162}, '1': {'precision': 0.39004236399479886, 'recall': 0.3431998523712862, 'f1-score': 0.3651248625726402, 'support': 27095}, '2': {'precision': 0.4605219689461513, 'recall': 0.29528684907325686, 'f1-score': 0.359842536623142, 'support': 28325}, 'accuracy': 0.41788901916680626, 'macro avg': {'precision': 0.421932661514641, 'recall': 0.4171822844741285, 'f1-score': 0.40669501626165877, 'support': 83582}, 'weighted avg': {'precision': 0.4224150261932202, 'recall': 0.41788901916680626, 'f1-score': 0.40713432615858763, 'support': 83582}}
[[17265  6774  4123]
 [12121  9299  5675]
 [12193  7768  8364]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0842298
{'0': {'precision': 0.3951967150496562, 'recall': 0.5921871646276025, 'f1-score': 0.47404140774891895, 'support': 27954}, '1': {'precision': 0.38507857874957296, 'recall': 0.3242941916921417, 'f1-score': 0.3520821538041038, 'support': 27805}, '2': {'precision': 0.4247182405077142, 'recall': 0.2790137655896201, 'f1-score': 0.33678228237999175, 'support': 27823}, 'accuracy': 0.3988179273049221, 'macro avg': {'precision': 0.4016645114356478, 'recall': 0.39849837396978804, 'f1-score': 0.38763528131100483, 'support': 83582}, 'weighted avg': {'precision': 0.40165794621181716, 'recall': 0.3988179273049221, 'f1-score': 0.3877783642577935, 'support': 83582}}
[[16554  6845  4555]
 [12828  9017  5960]
 [12506  7554  7763]]
Evaluating performance on  val set...
125/125 - 2s - 2s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0426939
{'0': {'precision': 0.4281772575250836, 'recall': 0.5235660975360392, 'f1-score': 0.4710914861321926, 'support': 9781}, '1': {'precision': 0.4448747332648384, 'recall': 0.4682249209782066, 'f1-score': 0.45625126646403247, 'support': 12022}, '2': {'precision': 0.49059757626410366, 'recall': 0.35258784663129444, 'f1-score': 0.4102982292637465, 'support': 9989}, 'accuracy': 0.4489179667840966, 'macro avg': {'precision': 0.4545498556846752, 'recall': 0.4481262883818467, 'f1-score': 0.44588032728665716, 'support': 31792}, 'weighted avg': {'precision': 0.45410370497184394, 'recall': 0.4489179667840966, 'f1-score': 0.4463785720748974, 'support': 31792}}
[[5121 3379 1281]
 [4017 5629 2376]
 [2822 3645 3522]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0522873
{'0': {'precision': 0.41314630565976185, 'recall': 0.5155709342560554, 'f1-score': 0.4587106120970663, 'support': 9826}, '1': {'precision': 0.43522597487355197, 'recall': 0.44595837164590824, 'f1-score': 0.4405268155732629, 'support': 11963}, '2': {'precision': 0.4762101210121012, 'recall': 0.3461961411576527, 'f1-score': 0.4009261939218524, 'support': 10003}, 'accuracy': 0.4360845495722194, 'macro avg': {'precision': 0.441527467181805, 'recall': 0.4359084823532054, 'f1-score': 0.4333878738640606, 'support': 31792}, 'weighted avg': {'precision': 0.4412969859495839, 'recall': 0.4360845495722194, 'f1-score': 0.433687012046081, 'support': 31792}}
[[5066 3380 1380]
 [4199 5335 2429]
 [2997 3543 3463]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.063366
{'0': {'precision': 0.4095650778366233, 'recall': 0.5057471264367817, 'f1-score': 0.4526026425467766, 'support': 10092}, '1': {'precision': 0.4116661079450218, 'recall': 0.4262778790245596, 'f1-score': 0.41884459603496055, 'support': 11523}, '2': {'precision': 0.46188158961881587, 'recall': 0.33575709934165276, 'f1-score': 0.3888477951635847, 'support': 10177}, 'accuracy': 0.4225276799194766, 'macro avg': {'precision': 0.4277042584668203, 'recall': 0.42259403493433134, 'f1-score': 0.4200983445817739, 'support': 31792}, 'weighted avg': {'precision': 0.4270737375732378, 'recall': 0.4225276799194766, 'f1-score': 0.4199583593379694, 'support': 31792}}
[[5104 3487 1501]
 [4131 4912 2480]
 [3227 3533 3417]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0758505
{'0': {'precision': 0.3864991651427208, 'recall': 0.4846943862797886, 'f1-score': 0.4300628151818101, 'support': 10029}, '1': {'precision': 0.40816151937719225, 'recall': 0.41285912080304604, 'f1-score': 0.4104968810496881, 'support': 11556}, '2': {'precision': 0.42984321020462396, 'recall': 0.3169393553443715, 'f1-score': 0.3648564822647042, 'support': 10207}, 'accuracy': 0.40472445898339204, 'macro avg': {'precision': 0.408167964908179, 'recall': 0.40483095414240206, 'f1-score': 0.4018053928320675, 'support': 31792}, 'weighted avg': {'precision': 0.40828901269809315, 'recall': 0.40472445898339204, 'f1-score': 0.4020159802888904, 'support': 31792}}
[[4861 3448 1720]
 [4214 4771 2571]
 [3502 3470 3235]]
training model: results/XRAY/W8/deepOF_L1/seq2seq
Epoch 1/50
327/327 - 14s - loss: 13.0756 - accuracy10: 0.3962 - accuracy20: 0.3917 - accuracy30: 0.3894 - accuracy50: 0.3808 - val_loss: 13.0076 - val_accuracy10: 0.4123 - val_accuracy20: 0.4031 - val_accuracy30: 0.3913 - val_accuracy50: 0.3796 - 14s/epoch - 44ms/step
Epoch 2/50
327/327 - 9s - loss: 12.9463 - accuracy10: 0.4115 - accuracy20: 0.4064 - accuracy30: 0.4042 - accuracy50: 0.3908 - val_loss: 12.8999 - val_accuracy10: 0.4179 - val_accuracy20: 0.4089 - val_accuracy30: 0.3981 - val_accuracy50: 0.3886 - 9s/epoch - 26ms/step
Epoch 3/50
327/327 - 9s - loss: 12.9069 - accuracy10: 0.4140 - accuracy20: 0.4084 - accuracy30: 0.4052 - accuracy50: 0.3928 - val_loss: 12.8803 - val_accuracy10: 0.4218 - val_accuracy20: 0.4121 - val_accuracy30: 0.4070 - val_accuracy50: 0.3943 - 9s/epoch - 26ms/step
Epoch 4/50
327/327 - 9s - loss: 12.8852 - accuracy10: 0.4162 - accuracy20: 0.4098 - accuracy30: 0.4084 - accuracy50: 0.3953 - val_loss: 12.8897 - val_accuracy10: 0.4177 - val_accuracy20: 0.4080 - val_accuracy30: 0.4045 - val_accuracy50: 0.3941 - 9s/epoch - 26ms/step
Epoch 5/50
327/327 - 9s - loss: 12.8667 - accuracy10: 0.4169 - accuracy20: 0.4110 - accuracy30: 0.4098 - accuracy50: 0.3986 - val_loss: 12.9095 - val_accuracy10: 0.4171 - val_accuracy20: 0.4049 - val_accuracy30: 0.3989 - val_accuracy50: 0.3895 - 9s/epoch - 26ms/step
Epoch 6/50
327/327 - 8s - loss: 12.8544 - accuracy10: 0.4172 - accuracy20: 0.4124 - accuracy30: 0.4114 - accuracy50: 0.3998 - val_loss: 12.9048 - val_accuracy10: 0.4156 - val_accuracy20: 0.4026 - val_accuracy30: 0.3955 - val_accuracy50: 0.3870 - 8s/epoch - 26ms/step
Epoch 7/50
327/327 - 8s - loss: 12.8360 - accuracy10: 0.4214 - accuracy20: 0.4158 - accuracy30: 0.4151 - accuracy50: 0.4033 - val_loss: 12.9008 - val_accuracy10: 0.4132 - val_accuracy20: 0.3995 - val_accuracy30: 0.3997 - val_accuracy50: 0.3916 - 8s/epoch - 26ms/step
Epoch 8/50
327/327 - 8s - loss: 12.8246 - accuracy10: 0.4205 - accuracy20: 0.4168 - accuracy30: 0.4177 - accuracy50: 0.4041 - val_loss: 12.9061 - val_accuracy10: 0.4093 - val_accuracy20: 0.3934 - val_accuracy30: 0.3977 - val_accuracy50: 0.3876 - 8s/epoch - 26ms/step
Epoch 9/50
327/327 - 9s - loss: 12.8185 - accuracy10: 0.4206 - accuracy20: 0.4165 - accuracy30: 0.4169 - accuracy50: 0.4048 - val_loss: 12.9132 - val_accuracy10: 0.4119 - val_accuracy20: 0.3996 - val_accuracy30: 0.3988 - val_accuracy50: 0.3898 - 9s/epoch - 26ms/step
Epoch 10/50
327/327 - 9s - loss: 12.8069 - accuracy10: 0.4235 - accuracy20: 0.4191 - accuracy30: 0.4199 - accuracy50: 0.4060 - val_loss: 12.9035 - val_accuracy10: 0.4090 - val_accuracy20: 0.3949 - val_accuracy30: 0.4015 - val_accuracy50: 0.3920 - 9s/epoch - 26ms/step
Epoch 11/50
327/327 - 9s - loss: 12.7942 - accuracy10: 0.4232 - accuracy20: 0.4192 - accuracy30: 0.4200 - accuracy50: 0.4085 - val_loss: 12.9136 - val_accuracy10: 0.4117 - val_accuracy20: 0.3942 - val_accuracy30: 0.3990 - val_accuracy50: 0.3880 - 9s/epoch - 26ms/step
Epoch 12/50
327/327 - 8s - loss: 12.7873 - accuracy10: 0.4213 - accuracy20: 0.4201 - accuracy30: 0.4189 - accuracy50: 0.4077 - val_loss: 12.9010 - val_accuracy10: 0.4064 - val_accuracy20: 0.3987 - val_accuracy30: 0.3992 - val_accuracy50: 0.3910 - 8s/epoch - 26ms/step
Epoch 13/50
327/327 - 8s - loss: 12.7746 - accuracy10: 0.4244 - accuracy20: 0.4223 - accuracy30: 0.4231 - accuracy50: 0.4098 - val_loss: 12.8999 - val_accuracy10: 0.4118 - val_accuracy20: 0.3969 - val_accuracy30: 0.3995 - val_accuracy50: 0.3909 - 8s/epoch - 26ms/step
testing model: results/XRAY/W8/deepOF_L1/seq2seq
Evaluating performance on  test set...
1162/1162 - 15s - 15s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0691732
{'0': {'precision': 0.3874943155979991, 'recall': 0.3361739061821912, 'f1-score': 0.3600143650843949, 'support': 76041}, '1': {'precision': 0.48665516420752025, 'recall': 0.558181272263242, 'f1-score': 0.5199699957409208, 'support': 146542}, '2': {'precision': 0.28005929851122885, 'recall': 0.2371686143572621, 'f1-score': 0.25683561970741164, 'support': 74875}, 'accuracy': 0.4206240881065562, 'macro avg': {'precision': 0.3847362594389161, 'recall': 0.3771745976008984, 'f1-score': 0.3789399935109092, 'support': 297458}, 'weighted avg': {'precision': 0.4093025445666754, 'recall': 0.42062408810655627, 'f1-score': 0.41284437627107334, 'support': 297458}}
[[25563 42009  8469]
 [27564 81797 37181]
 [12843 44274 17758]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0688825
{'0': {'precision': 0.3876980848666917, 'recall': 0.336795542623015, 'f1-score': 0.36045862078596763, 'support': 76637}, '1': {'precision': 0.4691876058287706, 'recall': 0.5231955565968824, 'f1-score': 0.4947219579581145, 'support': 145114}, '2': {'precision': 0.2831825092304351, 'recall': 0.25833806649319085, 'f1-score': 0.2701903683032631, 'support': 75707}, 'accuracy': 0.4077617680479261, 'macro avg': {'precision': 0.3800227333086325, 'recall': 0.3727763885710294, 'f1-score': 0.3751236490157817, 'support': 297458}, 'weighted avg': {'precision': 0.4008519071212521, 'recall': 0.4077617680479261, 'f1-score': 0.4029841246207639, 'support': 297458}}
[[25811 41907  8919]
 [28603 75923 40588]
 [12161 43988 19558]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0714982
{'0': {'precision': 0.38702590031407125, 'recall': 0.34692151342616556, 'f1-score': 0.36587801403331244, 'support': 79211}, '1': {'precision': 0.4420339938400424, 'recall': 0.47335556098472326, 'f1-score': 0.4571589178085519, 'support': 139166}, '2': {'precision': 0.3003047992974118, 'recall': 0.294027642543721, 'f1-score': 0.297133072219489, 'support': 79081}, 'accuracy': 0.3920116453415272, 'macro avg': {'precision': 0.3764548978171751, 'recall': 0.37143490565153664, 'f1-score': 0.3733900013537845, 'support': 297458}, 'weighted avg': {'precision': 0.38970616090258076, 'recall': 0.3920116453415272, 'f1-score': 0.390307612535306, 'support': 297458}}
[[27480 40844 10887]
 [30002 65875 43289]
 [13521 42308 23252]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0745444
{'0': {'precision': 0.3605745292052346, 'recall': 0.36232776537602956, 'f1-score': 0.36144902125154377, 'support': 77946}, '1': {'precision': 0.4468768707328347, 'recall': 0.419297958719347, 'f1-score': 0.43264835995216677, 'support': 140647}, '2': {'precision': 0.2989468370694996, 'recall': 0.33041273061560894, 'f1-score': 0.31389318862140203, 'support': 78865}, 'accuracy': 0.38080334030350504, 'macro avg': {'precision': 0.3687994123358563, 'recall': 0.3706794849036618, 'f1-score': 0.36933018994170413, 'support': 297458}, 'weighted avg': {'precision': 0.3850415043363376, 'recall': 0.38080334030350504, 'f1-score': 0.382505717154328, 'support': 297458}}
[[28242 35732 13972]
 [34538 58973 47136]
 [15545 37262 26058]]
Evaluating performance on  train set...
327/327 - 4s - 4s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0745462
{'0': {'precision': 0.4551647373107747, 'recall': 0.36819737079056364, 'f1-score': 0.4070881035340966, 'support': 27765}, '1': {'precision': 0.3605227238258935, 'recall': 0.5141858033815206, 'f1-score': 0.4238570006389206, 'support': 27739}, '2': {'precision': 0.4414192949907236, 'recall': 0.3389486430657454, 'f1-score': 0.3834562230549176, 'support': 28078}, 'accuracy': 0.4068220430236175, 'macro avg': {'precision': 0.41903558537579727, 'recall': 0.4071106057459432, 'f1-score': 0.4048004424093116, 'support': 83582}, 'weighted avg': {'precision': 0.41913761015995854, 'recall': 0.4068220430236175, 'f1-score': 0.40471458407651395, 'support': 83582}}
[[10223 12296  5246]
 [ 6679 14263  6797]
 [ 5558 13003  9517]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.075615
{'0': {'precision': 0.4506128657063613, 'recall': 0.36283408976298537, 'f1-score': 0.40198738925692395, 'support': 27762}, '1': {'precision': 0.3432080924855491, 'recall': 0.4610987272596534, 'f1-score': 0.3935135466846675, 'support': 27814}, '2': {'precision': 0.4330259849119866, 'recall': 0.3689209455116761, 'f1-score': 0.3984112906335557, 'support': 28006}, 'accuracy': 0.3975736402574717, 'macro avg': {'precision': 0.40894898103463234, 'recall': 0.3976179208447716, 'f1-score': 0.39797074219171574, 'support': 83582}, 'weighted avg': {'precision': 0.40897836849534785, 'recall': 0.3975736402574717, 'f1-score': 0.39796925526454774, 'support': 83582}}
[[10073 12075  5614]
 [ 7075 12825  7914]
 [ 5206 12468 10332]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0767517
{'0': {'precision': 0.4518810338109875, 'recall': 0.37068077701622926, 'f1-score': 0.4072730110421787, 'support': 28159}, '1': {'precision': 0.32952878352209375, 'recall': 0.4138934954855353, 'f1-score': 0.36692422039629513, 'support': 27135}, '2': {'precision': 0.43274875951668496, 'recall': 0.40388150452488686, 'f1-score': 0.41781711130209, 'support': 28288}, 'accuracy': 0.3959464956569596, 'macro avg': {'precision': 0.40471952561658875, 'recall': 0.3961519256755505, 'f1-score': 0.3973381142468546, 'support': 83582}, 'weighted avg': {'precision': 0.4056839807753295, 'recall': 0.3959464956569596, 'f1-score': 0.3977423354658144, 'support': 83582}}
[[10438 11426  6295]
 [ 7223 11231  8681]
 [ 5438 11425 11425]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0814976
{'0': {'precision': 0.4275469223834112, 'recall': 0.3735276216390391, 'f1-score': 0.39871591538799606, 'support': 27931}, '1': {'precision': 0.33176230183579974, 'recall': 0.36134544279714254, 'f1-score': 0.34592254029348085, 'support': 27857}, '2': {'precision': 0.4129130691078054, 'recall': 0.4284377923292797, 'f1-score': 0.42053219854148643, 'support': 27794}, 'accuracy': 0.387727022564667, 'macro avg': {'precision': 0.3907407644423388, 'recall': 0.3877702855884871, 'f1-score': 0.3883902180743211, 'support': 83582}, 'weighted avg': {'precision': 0.3907566386795396, 'recall': 0.387727022564667, 'f1-score': 0.388375132970253, 'support': 83582}}
[[10433 10269  7229]
 [ 8089 10066  9702]
 [ 5880 10006 11908]]
Evaluating performance on  val set...
125/125 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0695564
{'0': {'precision': 0.42505133470225875, 'recall': 0.401531393568147, 'f1-score': 0.4129567408651827, 'support': 9795}, '1': {'precision': 0.4124607406325323, 'recall': 0.47023066033807975, 'f1-score': 0.4394552529182879, 'support': 12009}, '2': {'precision': 0.4224683544303797, 'recall': 0.37424909891870245, 'f1-score': 0.3968995540454449, 'support': 9988}, 'accuracy': 0.4189104177151485, 'macro avg': {'precision': 0.4199934765883903, 'recall': 0.415337050941643, 'f1-score': 0.4164371826096385, 'support': 31792}, 'weighted avg': {'precision': 0.4194839199080064, 'recall': 0.4189104177151485, 'f1-score': 0.41792155746338977, 'support': 31792}}
[[3933 3846 2016]
 [3268 5647 3094]
 [2052 4198 3738]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0706949
{'0': {'precision': 0.4228033701717912, 'recall': 0.3938436448883906, 'f1-score': 0.4078100263852243, 'support': 9811}, '1': {'precision': 0.39631053036126057, 'recall': 0.4312839815976579, 'f1-score': 0.4130582815942319, 'support': 11955}, '2': {'precision': 0.42186041688271286, 'recall': 0.40574506283662476, 'f1-score': 0.41364583862931514, 'support': 10026}, 'accuracy': 0.4116758933064922, 'macro avg': {'precision': 0.41365810580525486, 'recall': 0.4102908964408911, 'f1-score': 0.41150471553625706, 'support': 31792}, 'weighted avg': {'precision': 0.41254368378492673, 'recall': 0.4116758933064922, 'f1-score': 0.4116239652561019, 'support': 31792}}
[[3864 3807 2140]
 [3364 5156 3435]
 [1911 4047 4068]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0726779
{'0': {'precision': 0.4316025162597292, 'recall': 0.40039564787339266, 'f1-score': 0.415413823182308, 'support': 10110}, '1': {'precision': 0.37248181894173704, 'recall': 0.3885594698290896, 'f1-score': 0.3803508172933293, 'support': 11468}, '2': {'precision': 0.4233492822966507, 'recall': 0.43313099667123556, 'f1-score': 0.4281842818428184, 'support': 10214}, 'accuracy': 0.4066431806743835, 'macro avg': {'precision': 0.40914453916603893, 'recall': 0.4073620381245726, 'f1-score': 0.407982974106152, 'support': 31792}, 'weighted avg': {'precision': 0.40762495308214935, 'recall': 0.4066431806743835, 'f1-score': 0.4068687462202939, 'support': 31792}}
[[4048 3701 2361]
 [3347 4456 3665]
 [1984 3806 4424]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.078646
{'0': {'precision': 0.4099989755148038, 'recall': 0.39872471854139685, 'f1-score': 0.40428326093544803, 'support': 10037}, '1': {'precision': 0.3686822275317037, 'recall': 0.34841511072514114, 'f1-score': 0.35826226726793764, 'support': 11515}, '2': {'precision': 0.41232397524441655, 'recall': 0.44892578125, 'f1-score': 0.42984711767731076, 'support': 10240}, 'accuracy': 0.39667211877201813, 'macro avg': {'precision': 0.3970017260969747, 'recall': 0.398688536838846, 'f1-score': 0.39746421529356546, 'support': 31792}, 'weighted avg': {'precision': 0.3957829980426673, 'recall': 0.39667211877201813, 'f1-score': 0.395848502221158, 'support': 31792}}
[[4002 3433 2602]
 [3553 4012 3950]
 [2206 3437 4597]]
training model: results/XRAY/W8/deepLOB_L2/seq2seq
Epoch 1/50
327/327 - 24s - loss: 13.1998 - accuracy10: 0.3766 - accuracy20: 0.3729 - accuracy30: 0.3653 - accuracy50: 0.3630 - val_loss: 13.1429 - val_accuracy10: 0.3837 - val_accuracy20: 0.3831 - val_accuracy30: 0.3761 - val_accuracy50: 0.3693 - 24s/epoch - 72ms/step
Epoch 2/50
327/327 - 17s - loss: 12.9574 - accuracy10: 0.4137 - accuracy20: 0.4062 - accuracy30: 0.3971 - accuracy50: 0.3859 - val_loss: 12.9303 - val_accuracy10: 0.4061 - val_accuracy20: 0.4043 - val_accuracy30: 0.3973 - val_accuracy50: 0.3848 - 17s/epoch - 52ms/step
Epoch 3/50
327/327 - 17s - loss: 12.8112 - accuracy10: 0.4372 - accuracy20: 0.4272 - accuracy30: 0.4163 - accuracy50: 0.4020 - val_loss: 12.8797 - val_accuracy10: 0.4015 - val_accuracy20: 0.4001 - val_accuracy30: 0.3854 - val_accuracy50: 0.3817 - 17s/epoch - 52ms/step
Epoch 4/50
327/327 - 17s - loss: 12.7064 - accuracy10: 0.4478 - accuracy20: 0.4384 - accuracy30: 0.4277 - accuracy50: 0.4105 - val_loss: 12.9401 - val_accuracy10: 0.4245 - val_accuracy20: 0.4194 - val_accuracy30: 0.4064 - val_accuracy50: 0.3970 - 17s/epoch - 52ms/step
Epoch 5/50
327/327 - 17s - loss: 12.6589 - accuracy10: 0.4557 - accuracy20: 0.4460 - accuracy30: 0.4334 - accuracy50: 0.4138 - val_loss: 12.7715 - val_accuracy10: 0.4352 - val_accuracy20: 0.4253 - val_accuracy30: 0.4121 - val_accuracy50: 0.4026 - 17s/epoch - 53ms/step
Epoch 6/50
327/327 - 17s - loss: 12.6121 - accuracy10: 0.4610 - accuracy20: 0.4498 - accuracy30: 0.4374 - accuracy50: 0.4174 - val_loss: 12.8885 - val_accuracy10: 0.4164 - val_accuracy20: 0.4106 - val_accuracy30: 0.3994 - val_accuracy50: 0.3946 - 17s/epoch - 53ms/step
Epoch 7/50
327/327 - 17s - loss: 12.5536 - accuracy10: 0.4662 - accuracy20: 0.4556 - accuracy30: 0.4427 - accuracy50: 0.4243 - val_loss: 12.8973 - val_accuracy10: 0.4298 - val_accuracy20: 0.4241 - val_accuracy30: 0.4129 - val_accuracy50: 0.4031 - 17s/epoch - 52ms/step
Epoch 8/50
327/327 - 18s - loss: 12.5105 - accuracy10: 0.4695 - accuracy20: 0.4584 - accuracy30: 0.4455 - accuracy50: 0.4257 - val_loss: 13.0009 - val_accuracy10: 0.4280 - val_accuracy20: 0.4203 - val_accuracy30: 0.4092 - val_accuracy50: 0.3999 - 18s/epoch - 54ms/step
Epoch 9/50
327/327 - 18s - loss: 12.4761 - accuracy10: 0.4732 - accuracy20: 0.4631 - accuracy30: 0.4509 - accuracy50: 0.4306 - val_loss: 13.0611 - val_accuracy10: 0.4249 - val_accuracy20: 0.4186 - val_accuracy30: 0.4084 - val_accuracy50: 0.3994 - 18s/epoch - 54ms/step
Epoch 10/50
327/327 - 17s - loss: 12.4442 - accuracy10: 0.4760 - accuracy20: 0.4655 - accuracy30: 0.4534 - accuracy50: 0.4318 - val_loss: 13.1532 - val_accuracy10: 0.4258 - val_accuracy20: 0.4193 - val_accuracy30: 0.4088 - val_accuracy50: 0.3978 - 17s/epoch - 53ms/step
Epoch 11/50
327/327 - 18s - loss: 12.4080 - accuracy10: 0.4793 - accuracy20: 0.4692 - accuracy30: 0.4582 - accuracy50: 0.4362 - val_loss: 13.1635 - val_accuracy10: 0.4333 - val_accuracy20: 0.4250 - val_accuracy30: 0.4103 - val_accuracy50: 0.4025 - 18s/epoch - 54ms/step
Epoch 12/50
327/327 - 18s - loss: 12.3740 - accuracy10: 0.4807 - accuracy20: 0.4721 - accuracy30: 0.4604 - accuracy50: 0.4384 - val_loss: 13.1434 - val_accuracy10: 0.4369 - val_accuracy20: 0.4283 - val_accuracy30: 0.4171 - val_accuracy50: 0.4070 - 18s/epoch - 55ms/step
Epoch 13/50
327/327 - 18s - loss: 12.3429 - accuracy10: 0.4829 - accuracy20: 0.4734 - accuracy30: 0.4625 - accuracy50: 0.4406 - val_loss: 13.1884 - val_accuracy10: 0.4349 - val_accuracy20: 0.4272 - val_accuracy30: 0.4142 - val_accuracy50: 0.4035 - 18s/epoch - 54ms/step
Epoch 14/50
327/327 - 17s - loss: 12.3127 - accuracy10: 0.4846 - accuracy20: 0.4755 - accuracy30: 0.4637 - accuracy50: 0.4422 - val_loss: 13.3104 - val_accuracy10: 0.4227 - val_accuracy20: 0.4177 - val_accuracy30: 0.4113 - val_accuracy50: 0.3973 - 17s/epoch - 53ms/step
Epoch 15/50
327/327 - 17s - loss: 12.2881 - accuracy10: 0.4870 - accuracy20: 0.4787 - accuracy30: 0.4685 - accuracy50: 0.4463 - val_loss: 13.2777 - val_accuracy10: 0.4253 - val_accuracy20: 0.4225 - val_accuracy30: 0.4126 - val_accuracy50: 0.4001 - 17s/epoch - 53ms/step
testing model: results/XRAY/W8/deepLOB_L2/seq2seq
Evaluating performance on  test set...
1162/1162 - 23s - 23s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0169778
{'0': {'precision': 0.3893106525962094, 'recall': 0.4875726572157492, 'f1-score': 0.4329361210203355, 'support': 76042}, '1': {'precision': 0.5562848951259997, 'recall': 0.6540674068362187, 'f1-score': 0.6012263011808245, 'support': 146543}, '2': {'precision': 0.4138541736282831, 'recall': 0.1654023878842918, 'f1-score': 0.23634594099461853, 'support': 74878}, 'accuracy': 0.4884977291293371, 'macro avg': {'precision': 0.45314990711683073, 'recall': 0.4356808173120866, 'f1-score': 0.4235027877319262, 'support': 297463}, 'weighted avg': {'precision': 0.47774745378117245, 'recall': 0.4884977291293371, 'f1-score': 0.46635697797159636, 'support': 297463}}
[[37076 34109  4857]
 [38010 95849 12684]
 [20149 42344 12385]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0249035
{'0': {'precision': 0.38456428209886956, 'recall': 0.4758543300408408, 'f1-score': 0.42536638848551644, 'support': 76639}, '1': {'precision': 0.5458891395607848, 'recall': 0.6586293629190642, 'f1-score': 0.5969831355402873, 'support': 145115}, '2': {'precision': 0.40887969215131054, 'recall': 0.14876698939359917, 'f1-score': 0.21815892692847805, 'support': 75709}, 'accuracy': 0.48177084208792353, 'macro avg': {'precision': 0.4464443712703216, 'recall': 0.42775022745116803, 'f1-score': 0.4135028169847606, 'support': 297463}, 'weighted avg': {'precision': 0.4694540064351604, 'recall': 0.48177084208792353, 'f1-score': 0.45635072785488756, 'support': 297463}}
[[36469 35534  4636]
 [37891 95577 11647]
 [20472 43974 11263]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0377768
{'0': {'precision': 0.3833402358480284, 'recall': 0.44402504607771354, 'f1-score': 0.41145711478171354, 'support': 79214}, '1': {'precision': 0.5201427101507627, 'recall': 0.6683624709880934, 'f1-score': 0.5850102675861896, 'support': 139167}, '2': {'precision': 0.40963362469778686, 'recall': 0.13926051440277182, 'f1-score': 0.20785716307907182, 'support': 79082}, 'accuracy': 0.467957359402682, 'macro avg': {'precision': 0.437705523565526, 'recall': 0.41721601048952633, 'f1-score': 0.4014415151489916, 'support': 297463}, 'weighted avg': {'precision': 0.4543330104731254, 'recall': 0.467957359402682, 'f1-score': 0.4385252887589551, 'support': 297463}}
[[35173 39005  5036]
 [35317 93014 10836]
 [21264 46805 11013]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0456076
{'0': {'precision': 0.3600861008610086, 'recall': 0.4056113612746796, 'f1-score': 0.3814953575500896, 'support': 77949}, '1': {'precision': 0.5214487274321251, 'recall': 0.6766324441158068, 'f1-score': 0.5889903544141628, 'support': 140648}, '2': {'precision': 0.3846578772924799, 'recall': 0.13243983465625236, 'f1-score': 0.19703829466138462, 'support': 78866}, 'accuracy': 0.46133132524045006, 'macro avg': {'precision': 0.4220642351952046, 'recall': 0.4048945466822462, 'f1-score': 0.3891746688752124, 'support': 297463}, 'weighted avg': {'precision': 0.4428971006223867, 'recall': 0.46133132524045006, 'f1-score': 0.43069934459102427, 'support': 297463}}
[[31617 40584  5748]
 [34520 95167 10961]
 [21667 46754 10445]]
Evaluating performance on  train set...
327/327 - 7s - 7s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.055874
{'0': {'precision': 0.4588731545646279, 'recall': 0.43953823953823956, 'f1-score': 0.44899764150943394, 'support': 27720}, '1': {'precision': 0.39852742439069855, 'recall': 0.6143457490751051, 'f1-score': 0.48344380220184, 'support': 27841}, '2': {'precision': 0.48880385487528344, 'recall': 0.24617251347203883, 'f1-score': 0.3274392993615456, 'support': 28021}, 'accuracy': 0.4329401067215429, 'macro avg': {'precision': 0.4487348112768699, 'recall': 0.43335216736179455, 'f1-score': 0.41996024769093987, 'support': 83582}, 'weighted avg': {'precision': 0.4488064258387361, 'recall': 0.4329401067215429, 'f1-score': 0.4197189601487498, 'support': 83582}}
[[12184 11982  3554]
 [ 7077 17104  3660]
 [ 7291 13832  6898]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0618284
{'0': {'precision': 0.4522091113911483, 'recall': 0.42675411726548707, 'f1-score': 0.4391130228418867, 'support': 27749}, '1': {'precision': 0.39027213509158176, 'recall': 0.6168831168831169, 'f1-score': 0.47808377239931604, 'support': 27874}, '2': {'precision': 0.47315536892621474, 'recall': 0.2256876140062234, 'f1-score': 0.3056060055696816, 'support': 27959}, 'accuracy': 0.4229020602522074, 'macro avg': {'precision': 0.4385455384696482, 'recall': 0.4231082827182758, 'f1-score': 0.40760093360362815, 'support': 83582}, 'weighted avg': {'precision': 0.43856030108568544, 'recall': 0.4229020602522074, 'f1-score': 0.407450080787978, 'support': 83582}}
[[11842 12457  3450]
 [ 7103 17195  3576]
 [ 7242 14407  6310]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0716691
{'0': {'precision': 0.4476734889670611, 'recall': 0.3976635182160358, 'f1-score': 0.42118921358456507, 'support': 28162}, '1': {'precision': 0.36920708237105465, 'recall': 0.6195238973980439, 'f1-score': 0.4626791620727673, 'support': 27095}, '2': {'precision': 0.4585909472559347, 'recall': 0.21210944395410414, 'f1-score': 0.29005938299618594, 'support': 28325}, 'accuracy': 0.4067024000382858, 'macro avg': {'precision': 0.42515717286468346, 'recall': 0.4097656198560613, 'f1-score': 0.39130925288450613, 'support': 83582}, 'weighted avg': {'precision': 0.4259366283907833, 'recall': 0.4067024000382858, 'f1-score': 0.3902006957562288, 'support': 83582}}
[[11199 13437  3526]
 [ 6742 16786  3567]
 [ 7075 15242  6008]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0776634
{'0': {'precision': 0.42421815729579365, 'recall': 0.3600558059669457, 'f1-score': 0.3895123839009288, 'support': 27954}, '1': {'precision': 0.37574046748358675, 'recall': 0.6319007372774681, 'f1-score': 0.47126035994957494, 'support': 27805}, '2': {'precision': 0.434746086292478, 'recall': 0.20461488696402258, 'f1-score': 0.2782638447626961, 'support': 27823}, 'accuracy': 0.39874614151372306, 'macro avg': {'precision': 0.41156823702395284, 'recall': 0.3988571434028121, 'f1-score': 0.3796788628710666, 'support': 83582}, 'weighted avg': {'precision': 0.4115957793106573, 'recall': 0.39874614151372306, 'f1-score': 0.37967455242512727, 'support': 83582}}
[[10065 14060  3829]
 [ 6662 17570  3573]
 [ 6999 15131  5693]]
Evaluating performance on  val set...
125/125 - 3s - 3s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0554397
{'0': {'precision': 0.448, 'recall': 0.3606993149984664, 'f1-score': 0.399637516991391, 'support': 9781}, '1': {'precision': 0.41622423111876405, 'recall': 0.7238396273498586, 'f1-score': 0.5285310820249628, 'support': 12022}, '2': {'precision': 0.5069767441860465, 'recall': 0.15276804484933426, 'f1-score': 0.23478729133010232, 'support': 9989}, 'accuracy': 0.4326874685455461, 'macro avg': {'precision': 0.4570669917682702, 'recall': 0.41243566239921975, 'f1-score': 0.3876519634488187, 'support': 31792}, 'weighted avg': {'precision': 0.4545145446711185, 'recall': 0.4326874685455461, 'f1-score': 0.3965823312434981, 'support': 31792}}
[[3528 5645  608]
 [2444 8702  876]
 [1903 6560 1526]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0596863
{'0': {'precision': 0.44193675370686264, 'recall': 0.34276409525748014, 'f1-score': 0.38608356737548, 'support': 9826}, '1': {'precision': 0.40798619209777487, 'recall': 0.7310875198528797, 'f1-score': 0.5237125748502993, 'support': 11963}, '2': {'precision': 0.49414776883686906, 'recall': 0.1350594821553534, 'f1-score': 0.21213786605951168, 'support': 10003}, 'accuracy': 0.42353422244589833, 'macro avg': {'precision': 0.44802357154716893, 'recall': 0.40297036575523776, 'f1-score': 0.3739780027617637, 'support': 31792}, 'weighted avg': {'precision': 0.4455891258701722, 'recall': 0.42353422244589833, 'f1-score': 0.3831418514141574, 'support': 31792}}
[[3368 5890  568]
 [2402 8746  815]
 [1851 6801 1351]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0687356
{'0': {'precision': 0.4453362856352062, 'recall': 0.31886642885453825, 'f1-score': 0.37163644762674675, 'support': 10092}, '1': {'precision': 0.3906314016479264, 'recall': 0.7446845439555672, 'f1-score': 0.5124514780531502, 'support': 11523}, '2': {'precision': 0.4755675259715275, 'recall': 0.1214503291736268, 'f1-score': 0.1934877896055103, 'support': 10177}, 'accuracy': 0.4100088072471062, 'macro avg': {'precision': 0.4371784044182201, 'recall': 0.3950004339945774, 'f1-score': 0.35919190509513577, 'support': 31792}, 'weighted avg': {'precision': 0.43518590046652594, 'recall': 0.4100088072471062, 'f1-score': 0.36564729006891217, 'support': 31792}}
[[3218 6289  585]
 [2164 8581  778]
 [1844 7097 1236]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0764813
{'0': {'precision': 0.4261809566118762, 'recall': 0.28696779339914247, 'f1-score': 0.34298653319032296, 'support': 10029}, '1': {'precision': 0.3896473518032641, 'recall': 0.75822083766009, 'f1-score': 0.5147607437652381, 'support': 11556}, '2': {'precision': 0.44553291536050155, 'recall': 0.11139414127559517, 'f1-score': 0.1782271337879144, 'support': 10207}, 'accuracy': 0.4018935581278309, 'macro avg': {'precision': 0.42045374125854734, 'recall': 0.38552759077827586, 'f1-score': 0.34532480358115847, 'support': 31792}, 'weighted avg': {'precision': 0.4191144966778959, 'recall': 0.4018935581278309, 'f1-score': 0.3525274110118924, 'support': 31792}}
[[2878 6527  624]
 [2003 8762  791]
 [1872 7198 1137]]
training model: results/XRAY/W8/deepOF_L2/seq2seq
Epoch 1/50
327/327 - 17s - loss: 13.0718 - accuracy10: 0.4041 - accuracy20: 0.3946 - accuracy30: 0.3845 - accuracy50: 0.3748 - val_loss: 12.7910 - val_accuracy10: 0.4366 - val_accuracy20: 0.4187 - val_accuracy30: 0.4012 - val_accuracy50: 0.3901 - 17s/epoch - 52ms/step
Epoch 2/50
327/327 - 11s - loss: 12.8186 - accuracy10: 0.4359 - accuracy20: 0.4233 - accuracy30: 0.4140 - accuracy50: 0.3977 - val_loss: 12.6772 - val_accuracy10: 0.4544 - val_accuracy20: 0.4345 - val_accuracy30: 0.4150 - val_accuracy50: 0.3987 - 11s/epoch - 35ms/step
Epoch 3/50
327/327 - 11s - loss: 12.7292 - accuracy10: 0.4494 - accuracy20: 0.4333 - accuracy30: 0.4224 - accuracy50: 0.4048 - val_loss: 12.6140 - val_accuracy10: 0.4614 - val_accuracy20: 0.4397 - val_accuracy30: 0.4180 - val_accuracy50: 0.4016 - 11s/epoch - 35ms/step
Epoch 4/50
327/327 - 11s - loss: 12.6650 - accuracy10: 0.4567 - accuracy20: 0.4394 - accuracy30: 0.4286 - accuracy50: 0.4104 - val_loss: 12.5893 - val_accuracy10: 0.4646 - val_accuracy20: 0.4440 - val_accuracy30: 0.4256 - val_accuracy50: 0.4079 - 11s/epoch - 35ms/step
Epoch 5/50
327/327 - 11s - loss: 12.6023 - accuracy10: 0.4656 - accuracy20: 0.4471 - accuracy30: 0.4347 - accuracy50: 0.4158 - val_loss: 12.5591 - val_accuracy10: 0.4675 - val_accuracy20: 0.4457 - val_accuracy30: 0.4300 - val_accuracy50: 0.4137 - 11s/epoch - 34ms/step
Epoch 6/50
327/327 - 11s - loss: 12.5538 - accuracy10: 0.4711 - accuracy20: 0.4537 - accuracy30: 0.4404 - accuracy50: 0.4206 - val_loss: 12.5492 - val_accuracy10: 0.4711 - val_accuracy20: 0.4485 - val_accuracy30: 0.4330 - val_accuracy50: 0.4130 - 11s/epoch - 34ms/step
Epoch 7/50
327/327 - 11s - loss: 12.5046 - accuracy10: 0.4771 - accuracy20: 0.4582 - accuracy30: 0.4456 - accuracy50: 0.4257 - val_loss: 12.5463 - val_accuracy10: 0.4704 - val_accuracy20: 0.4495 - val_accuracy30: 0.4354 - val_accuracy50: 0.4182 - 11s/epoch - 35ms/step
Epoch 8/50
327/327 - 11s - loss: 12.4602 - accuracy10: 0.4811 - accuracy20: 0.4632 - accuracy30: 0.4497 - accuracy50: 0.4287 - val_loss: 12.5242 - val_accuracy10: 0.4729 - val_accuracy20: 0.4529 - val_accuracy30: 0.4354 - val_accuracy50: 0.4169 - 11s/epoch - 35ms/step
Epoch 9/50
327/327 - 11s - loss: 12.4053 - accuracy10: 0.4875 - accuracy20: 0.4689 - accuracy30: 0.4565 - accuracy50: 0.4338 - val_loss: 12.5232 - val_accuracy10: 0.4747 - val_accuracy20: 0.4503 - val_accuracy30: 0.4315 - val_accuracy50: 0.4138 - 11s/epoch - 35ms/step
Epoch 10/50
327/327 - 11s - loss: 12.3627 - accuracy10: 0.4912 - accuracy20: 0.4745 - accuracy30: 0.4606 - accuracy50: 0.4370 - val_loss: 12.4975 - val_accuracy10: 0.4790 - val_accuracy20: 0.4547 - val_accuracy30: 0.4356 - val_accuracy50: 0.4192 - 11s/epoch - 34ms/step
Epoch 11/50
327/327 - 11s - loss: 12.3186 - accuracy10: 0.4960 - accuracy20: 0.4790 - accuracy30: 0.4662 - accuracy50: 0.4418 - val_loss: 12.5153 - val_accuracy10: 0.4780 - val_accuracy20: 0.4534 - val_accuracy30: 0.4347 - val_accuracy50: 0.4164 - 11s/epoch - 34ms/step
Epoch 12/50
327/327 - 11s - loss: 12.2734 - accuracy10: 0.4980 - accuracy20: 0.4833 - accuracy30: 0.4704 - accuracy50: 0.4451 - val_loss: 12.5282 - val_accuracy10: 0.4747 - val_accuracy20: 0.4548 - val_accuracy30: 0.4359 - val_accuracy50: 0.4153 - 11s/epoch - 34ms/step
Epoch 13/50
327/327 - 11s - loss: 12.2328 - accuracy10: 0.5032 - accuracy20: 0.4876 - accuracy30: 0.4745 - accuracy50: 0.4492 - val_loss: 12.5286 - val_accuracy10: 0.4773 - val_accuracy20: 0.4563 - val_accuracy30: 0.4358 - val_accuracy50: 0.4175 - 11s/epoch - 34ms/step
Epoch 14/50
327/327 - 11s - loss: 12.1841 - accuracy10: 0.5053 - accuracy20: 0.4910 - accuracy30: 0.4789 - accuracy50: 0.4547 - val_loss: 12.5878 - val_accuracy10: 0.4769 - val_accuracy20: 0.4491 - val_accuracy30: 0.4324 - val_accuracy50: 0.4142 - 11s/epoch - 34ms/step
Epoch 15/50
327/327 - 11s - loss: 12.1444 - accuracy10: 0.5073 - accuracy20: 0.4955 - accuracy30: 0.4841 - accuracy50: 0.4584 - val_loss: 12.6339 - val_accuracy10: 0.4752 - val_accuracy20: 0.4528 - val_accuracy30: 0.4312 - val_accuracy50: 0.4143 - 11s/epoch - 35ms/step
Epoch 16/50
327/327 - 11s - loss: 12.1040 - accuracy10: 0.5114 - accuracy20: 0.4978 - accuracy30: 0.4877 - accuracy50: 0.4618 - val_loss: 12.6941 - val_accuracy10: 0.4714 - val_accuracy20: 0.4492 - val_accuracy30: 0.4323 - val_accuracy50: 0.4104 - 11s/epoch - 34ms/step
Epoch 17/50
327/327 - 11s - loss: 12.0546 - accuracy10: 0.5143 - accuracy20: 0.5018 - accuracy30: 0.4907 - accuracy50: 0.4666 - val_loss: 12.7240 - val_accuracy10: 0.4738 - val_accuracy20: 0.4470 - val_accuracy30: 0.4253 - val_accuracy50: 0.4104 - 11s/epoch - 34ms/step
Epoch 18/50
327/327 - 11s - loss: 12.0087 - accuracy10: 0.5163 - accuracy20: 0.5065 - accuracy30: 0.4963 - accuracy50: 0.4721 - val_loss: 12.8156 - val_accuracy10: 0.4698 - val_accuracy20: 0.4472 - val_accuracy30: 0.4257 - val_accuracy50: 0.4094 - 11s/epoch - 34ms/step
Epoch 19/50
327/327 - 11s - loss: 11.9755 - accuracy10: 0.5177 - accuracy20: 0.5084 - accuracy30: 0.4984 - accuracy50: 0.4749 - val_loss: 12.9904 - val_accuracy10: 0.4676 - val_accuracy20: 0.4441 - val_accuracy30: 0.4264 - val_accuracy50: 0.4118 - 11s/epoch - 34ms/step
Epoch 20/50
327/327 - 11s - loss: 11.9368 - accuracy10: 0.5182 - accuracy20: 0.5111 - accuracy30: 0.5033 - accuracy50: 0.4805 - val_loss: 12.9095 - val_accuracy10: 0.4676 - val_accuracy20: 0.4443 - val_accuracy30: 0.4252 - val_accuracy50: 0.4101 - 11s/epoch - 35ms/step
testing model: results/XRAY/W8/deepOF_L2/seq2seq
Evaluating performance on  test set...
1162/1162 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9627182
{'0': {'precision': 0.4489569549311123, 'recall': 0.3034021120185163, 'f1-score': 0.3620996790369539, 'support': 76041}, '1': {'precision': 0.5768858090847696, 'recall': 0.8044246700604605, 'f1-score': 0.6719143648613216, 'support': 146542}, '2': {'precision': 0.45209451687116564, 'recall': 0.2519532554257095, 'f1-score': 0.3235765803624263, 'support': 74875}, 'accuracy': 0.5372792125274829, 'macro avg': {'precision': 0.4926457602956826, 'recall': 0.45326001250156217, 'f1-score': 0.45253020808690064, 'support': 297458}, 'weighted avg': {'precision': 0.512770586084575, 'recall': 0.5372792125274829, 'f1-score': 0.5050322835620272, 'support': 297458}}
[[ 23071  43228   9742]
 [ 15539 117882  13121]
 [ 12778  43232  18865]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.99008864
{'0': {'precision': 0.43661436445420565, 'recall': 0.2697783055182223, 'f1-score': 0.33349463666424717, 'support': 76637}, '1': {'precision': 0.5451845505818519, 'recall': 0.7893518199484543, 'f1-score': 0.6449317181794892, 'support': 145114}, '2': {'precision': 0.430675, 'recall': 0.22754831125259223, 'f1-score': 0.29776936572549634, 'support': 75707}, 'accuracy': 0.5125026054098394, 'macro avg': {'precision': 0.4708246383453525, 'recall': 0.4288928122397562, 'f1-score': 0.4253985735230776, 'support': 297458}, 'weighted avg': {'precision': 0.4880683597241016, 'recall': 0.5125026054098394, 'f1-score': 0.4763357354413613, 'support': 297458}}
[[ 20675  47366   8596]
 [ 16391 114546  14177]
 [ 10287  48193  17227]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0162313
{'0': {'precision': 0.4381764036510665, 'recall': 0.22847836790344775, 'f1-score': 0.3003468476691505, 'support': 79211}, '1': {'precision': 0.5065129688263863, 'recall': 0.7966098041188221, 'f1-score': 0.6192711926421012, 'support': 139166}, '2': {'precision': 0.4338590280012874, 'recall': 0.2045497654303815, 'f1-score': 0.2780217419327117, 'support': 79081}, 'accuracy': 0.4879176219836078, 'macro avg': {'precision': 0.4595161334929134, 'recall': 0.4098793124842171, 'f1-score': 0.39921326074798785, 'support': 297458}, 'weighted avg': {'precision': 0.4689999284694556, 'recall': 0.4879176219836078, 'f1-score': 0.4436206332313553, 'support': 297458}}
[[ 18098  53477   7636]
 [ 14833 110861  13472]
 [  8372  54533  16176]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0336167
{'0': {'precision': 0.39849644319896527, 'recall': 0.18973391835373207, 'f1-score': 0.2570703471292739, 'support': 77946}, '1': {'precision': 0.49781256378173555, 'recall': 0.7977134243887178, 'f1-score': 0.6130510211051157, 'support': 140647}, '2': {'precision': 0.4090025165865935, 'recall': 0.18134787294744184, 'f1-score': 0.2512803844227948, 'support': 78865}, 'accuracy': 0.4749813419037309, 'macro avg': {'precision': 0.4351038411890981, 'recall': 0.3895984052299639, 'f1-score': 0.3738005842190615, 'support': 297458}, 'weighted avg': {'precision': 0.44824153625183394, 'recall': 0.4749813419037309, 'f1-score': 0.4238535180099823, 'support': 297458}}
[[ 14789  55846   7311]
 [ 15096 112196  13355]
 [  7227  57336  14302]]
Evaluating performance on  train set...
327/327 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0243441
{'0': {'precision': 0.5104379666175282, 'recall': 0.3866018368449487, 'f1-score': 0.4399721277206214, 'support': 27765}, '1': {'precision': 0.4341255868544601, 'recall': 0.6400374923393056, 'f1-score': 0.5173453777227361, 'support': 27739}, '2': {'precision': 0.5055640208708501, 'recall': 0.389949426597336, 'f1-score': 0.44029355584598373, 'support': 28078}, 'accuracy': 0.47183604125290135, 'macro avg': {'precision': 0.48337585811427947, 'recall': 0.4721962519271968, 'f1-score': 0.46587035376311375, 'support': 83582}, 'weighted avg': {'precision': 0.48347426927930975, 'recall': 0.47183604125290135, 'f1-score': 0.46575856069318233, 'support': 83582}}
[[10734 11503  5528]
 [ 4805 17754  5180]
 [ 5490 11639 10949]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0401014
{'0': {'precision': 0.4991238317757009, 'recall': 0.3693537929543981, 'f1-score': 0.4245435349646006, 'support': 27762}, '1': {'precision': 0.4018249570036308, 'recall': 0.6048033364492702, 'f1-score': 0.4828496799563708, 'support': 27814}, '2': {'precision': 0.4945215830735808, 'recall': 0.37388416767835464, 'f1-score': 0.42582350549003667, 'support': 28006}, 'accuracy': 0.4492235170251968, 'macro avg': {'precision': 0.4651567906176375, 'recall': 0.44934709902734093, 'f1-score': 0.444405573470336, 'support': 83582}, 'weighted avg': {'precision': 0.465203113438476, 'recall': 0.4492235170251968, 'f1-score': 0.4443752447984938, 'support': 83582}}
[[10254 12370  5138]
 [ 5427 16822  5565]
 [ 4863 12672 10471]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0526484
{'0': {'precision': 0.5065885038389707, 'recall': 0.34678078056749173, 'f1-score': 0.41172130283545905, 'support': 28159}, '1': {'precision': 0.37605065687180295, 'recall': 0.6149990786806707, 'f1-score': 0.4667188723570869, 'support': 27135}, '2': {'precision': 0.48933714687139346, 'recall': 0.3447398190045249, 'f1-score': 0.4045046352946056, 'support': 28288}, 'accuracy': 0.4331674283936733, 'macro avg': {'precision': 0.4573254358607224, 'recall': 0.43550655941756244, 'f1-score': 0.4276482701623838, 'support': 83582}, 'weighted avg': {'precision': 0.4583705757760754, 'recall': 0.4331674283936733, 'f1-score': 0.4271338791984763, 'support': 83582}}
[[ 9765 13601  4793]
 [ 5063 16688  5384]
 [ 4448 14088  9752]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0653539
{'0': {'precision': 0.4874321222638974, 'recall': 0.31173248362035016, 'f1-score': 0.38026815740053277, 'support': 27931}, '1': {'precision': 0.3689322442761014, 'recall': 0.6258750044872025, 'f1-score': 0.4642215269919457, 'support': 27857}, '2': {'precision': 0.4673636314392503, 'recall': 0.3104267108008923, 'f1-score': 0.3730623716354988, 'support': 27794}, 'accuracy': 0.4159986599985643, 'macro avg': {'precision': 0.44124266599308304, 'recall': 0.4160113996361483, 'f1-score': 0.4058506853426591, 'support': 83582}, 'weighted avg': {'precision': 0.44126387150313223, 'recall': 0.4159986599985643, 'f1-score': 0.40585274986248193, 'support': 83582}}
[[ 8707 14631  4593]
 [ 5182 17435  5240]
 [ 3974 15192  8628]]
Evaluating performance on  val set...
125/125 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0191678
{'0': {'precision': 0.4869542066027689, 'recall': 0.3734558448187851, 'f1-score': 0.42271913098746167, 'support': 9795}, '1': {'precision': 0.47563546913435634, 'recall': 0.676242817886585, 'f1-score': 0.5584705841900767, 'support': 12009}, '2': {'precision': 0.4857063558145989, 'recall': 0.35042050460552665, 'f1-score': 0.4071187623589625, 'support': 9988}, 'accuracy': 0.4805926019124308, 'macro avg': {'precision': 0.48276534385057474, 'recall': 0.46670638910363227, 'f1-score': 0.462769492512167, 'support': 31792}, 'weighted avg': {'precision': 0.4822866722566941, 'recall': 0.4805926019124308, 'f1-score': 0.4690962925264889, 'support': 31792}}
[[3658 4407 1730]
 [1912 8121 1976]
 [1942 4546 3500]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0348505
{'0': {'precision': 0.46968426934898017, 'recall': 0.34267658750382224, 'f1-score': 0.3962519889209735, 'support': 9811}, '1': {'precision': 0.4418222045725308, 'recall': 0.6514429109159348, 'f1-score': 0.5265364072746941, 'support': 11955}, '2': {'precision': 0.4712430426716141, 'recall': 0.329343706363455, 'f1-score': 0.38771795925556274, 'support': 10026}, 'accuracy': 0.4545797684952189, 'macro avg': {'precision': 0.46091650553104174, 'recall': 0.441154401594404, 'f1-score': 0.4368354518170768, 'support': 31792}, 'weighted avg': {'precision': 0.4596986527451262, 'recall': 0.4545797684952189, 'f1-score': 0.4425525689408943, 'support': 31792}}
[[3362 4797 1652]
 [2114 7788 2053]
 [1682 5042 3302]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0487026
{'0': {'precision': 0.4774856452100332, 'recall': 0.3125618199802176, 'f1-score': 0.37780966044954567, 'support': 10110}, '1': {'precision': 0.4052936755073553, 'recall': 0.6582664806417858, 'f1-score': 0.501694689971423, 'support': 11468}, '2': {'precision': 0.475717776420281, 'recall': 0.3049735656941453, 'f1-score': 0.3716740245794058, 'support': 10214}, 'accuracy': 0.4348263714141922, 'macro avg': {'precision': 0.45283236571255653, 'recall': 0.4252672887720496, 'f1-score': 0.41705945833345814, 'support': 31792}, 'weighted avg': {'precision': 0.4508766077047225, 'recall': 0.4348263714141922, 'f1-score': 0.42052619711849637, 'support': 31792}}
[[3160 5451 1499]
 [1985 7549 1934]
 [1473 5626 3115]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0645114
{'0': {'precision': 0.45478246700342184, 'recall': 0.2780711367938627, 'f1-score': 0.34512180042042784, 'support': 10037}, '1': {'precision': 0.3906265867776988, 'recall': 0.6680851063829787, 'f1-score': 0.49299881444455124, 'support': 11515}, '2': {'precision': 0.4541184365039423, 'recall': 0.26435546875, 'f1-score': 0.3341769026603296, 'support': 10240}, 'accuracy': 0.41491570206341216, 'macro avg': {'precision': 0.433175830095021, 'recall': 0.4035039039756138, 'f1-score': 0.39076583917510294, 'support': 31792}, 'weighted avg': {'precision': 0.43133145312842597, 'recall': 0.41491570206341216, 'f1-score': 0.39515728303946335, 'support': 31792}}
[[2791 5835 1411]
 [1979 7693 1843]
 [1367 6166 2707]]
training model: results/XRAY/W8/deepVOL_L2/seq2seq
Epoch 1/50
327/327 - 17s - loss: 13.0898 - accuracy10: 0.3927 - accuracy20: 0.3885 - accuracy30: 0.3807 - accuracy50: 0.3749 - val_loss: 13.1673 - val_accuracy10: 0.3812 - val_accuracy20: 0.3786 - val_accuracy30: 0.3678 - val_accuracy50: 0.3676 - 17s/epoch - 52ms/step
Epoch 2/50
327/327 - 11s - loss: 12.9048 - accuracy10: 0.4184 - accuracy20: 0.4124 - accuracy30: 0.4019 - accuracy50: 0.3875 - val_loss: 12.8940 - val_accuracy10: 0.4019 - val_accuracy20: 0.3982 - val_accuracy30: 0.3846 - val_accuracy50: 0.3806 - 11s/epoch - 34ms/step
Epoch 3/50
327/327 - 11s - loss: 12.7908 - accuracy10: 0.4352 - accuracy20: 0.4270 - accuracy30: 0.4154 - accuracy50: 0.3986 - val_loss: 12.8225 - val_accuracy10: 0.4154 - val_accuracy20: 0.4094 - val_accuracy30: 0.3940 - val_accuracy50: 0.3895 - 11s/epoch - 33ms/step
Epoch 4/50
327/327 - 11s - loss: 12.7346 - accuracy10: 0.4441 - accuracy20: 0.4326 - accuracy30: 0.4199 - accuracy50: 0.4005 - val_loss: 12.7964 - val_accuracy10: 0.4172 - val_accuracy20: 0.4113 - val_accuracy30: 0.3963 - val_accuracy50: 0.3919 - 11s/epoch - 34ms/step
Epoch 5/50
327/327 - 11s - loss: 12.7058 - accuracy10: 0.4483 - accuracy20: 0.4367 - accuracy30: 0.4242 - accuracy50: 0.4026 - val_loss: 12.6761 - val_accuracy10: 0.4498 - val_accuracy20: 0.4369 - val_accuracy30: 0.4169 - val_accuracy50: 0.4068 - 11s/epoch - 34ms/step
Epoch 6/50
327/327 - 11s - loss: 12.6639 - accuracy10: 0.4547 - accuracy20: 0.4427 - accuracy30: 0.4280 - accuracy50: 0.4073 - val_loss: 12.6330 - val_accuracy10: 0.4573 - val_accuracy20: 0.4436 - val_accuracy30: 0.4208 - val_accuracy50: 0.4031 - 11s/epoch - 33ms/step
Epoch 7/50
327/327 - 11s - loss: 12.6294 - accuracy10: 0.4592 - accuracy20: 0.4459 - accuracy30: 0.4343 - accuracy50: 0.4112 - val_loss: 12.6280 - val_accuracy10: 0.4599 - val_accuracy20: 0.4459 - val_accuracy30: 0.4191 - val_accuracy50: 0.4023 - 11s/epoch - 34ms/step
Epoch 8/50
327/327 - 11s - loss: 12.6023 - accuracy10: 0.4631 - accuracy20: 0.4501 - accuracy30: 0.4379 - accuracy50: 0.4138 - val_loss: 12.6176 - val_accuracy10: 0.4614 - val_accuracy20: 0.4460 - val_accuracy30: 0.4240 - val_accuracy50: 0.4077 - 11s/epoch - 33ms/step
Epoch 9/50
327/327 - 11s - loss: 12.5803 - accuracy10: 0.4646 - accuracy20: 0.4517 - accuracy30: 0.4392 - accuracy50: 0.4157 - val_loss: 12.5926 - val_accuracy10: 0.4664 - val_accuracy20: 0.4508 - val_accuracy30: 0.4263 - val_accuracy50: 0.4090 - 11s/epoch - 34ms/step
Epoch 10/50
327/327 - 11s - loss: 12.5431 - accuracy10: 0.4692 - accuracy20: 0.4553 - accuracy30: 0.4406 - accuracy50: 0.4175 - val_loss: 12.5833 - val_accuracy10: 0.4719 - val_accuracy20: 0.4552 - val_accuracy30: 0.4324 - val_accuracy50: 0.4095 - 11s/epoch - 34ms/step
Epoch 11/50
327/327 - 11s - loss: 12.5318 - accuracy10: 0.4724 - accuracy20: 0.4578 - accuracy30: 0.4430 - accuracy50: 0.4200 - val_loss: 12.5554 - val_accuracy10: 0.4772 - val_accuracy20: 0.4556 - val_accuracy30: 0.4311 - val_accuracy50: 0.4081 - 11s/epoch - 34ms/step
Epoch 12/50
327/327 - 11s - loss: 12.4973 - accuracy10: 0.4746 - accuracy20: 0.4601 - accuracy30: 0.4450 - accuracy50: 0.4237 - val_loss: 12.5556 - val_accuracy10: 0.4771 - val_accuracy20: 0.4543 - val_accuracy30: 0.4286 - val_accuracy50: 0.4057 - 11s/epoch - 33ms/step
Epoch 13/50
327/327 - 11s - loss: 12.4730 - accuracy10: 0.4767 - accuracy20: 0.4621 - accuracy30: 0.4489 - accuracy50: 0.4258 - val_loss: 12.5790 - val_accuracy10: 0.4726 - val_accuracy20: 0.4496 - val_accuracy30: 0.4230 - val_accuracy50: 0.4010 - 11s/epoch - 34ms/step
Epoch 14/50
327/327 - 11s - loss: 12.4524 - accuracy10: 0.4795 - accuracy20: 0.4634 - accuracy30: 0.4497 - accuracy50: 0.4273 - val_loss: 12.5826 - val_accuracy10: 0.4676 - val_accuracy20: 0.4421 - val_accuracy30: 0.4182 - val_accuracy50: 0.4009 - 11s/epoch - 34ms/step
Epoch 15/50
327/327 - 11s - loss: 12.4281 - accuracy10: 0.4814 - accuracy20: 0.4663 - accuracy30: 0.4541 - accuracy50: 0.4312 - val_loss: 12.5884 - val_accuracy10: 0.4663 - val_accuracy20: 0.4407 - val_accuracy30: 0.4136 - val_accuracy50: 0.3985 - 11s/epoch - 34ms/step
Epoch 16/50
327/327 - 11s - loss: 12.4083 - accuracy10: 0.4828 - accuracy20: 0.4684 - accuracy30: 0.4545 - accuracy50: 0.4323 - val_loss: 12.6271 - val_accuracy10: 0.4589 - val_accuracy20: 0.4403 - val_accuracy30: 0.4156 - val_accuracy50: 0.4000 - 11s/epoch - 33ms/step
Epoch 17/50
327/327 - 11s - loss: 12.3855 - accuracy10: 0.4842 - accuracy20: 0.4699 - accuracy30: 0.4580 - accuracy50: 0.4360 - val_loss: 12.5917 - val_accuracy10: 0.4677 - val_accuracy20: 0.4466 - val_accuracy30: 0.4188 - val_accuracy50: 0.3994 - 11s/epoch - 33ms/step
Epoch 18/50
327/327 - 11s - loss: 12.3582 - accuracy10: 0.4866 - accuracy20: 0.4709 - accuracy30: 0.4589 - accuracy50: 0.4388 - val_loss: 12.6190 - val_accuracy10: 0.4640 - val_accuracy20: 0.4402 - val_accuracy30: 0.4116 - val_accuracy50: 0.3947 - 11s/epoch - 33ms/step
Epoch 19/50
327/327 - 11s - loss: 12.3354 - accuracy10: 0.4895 - accuracy20: 0.4738 - accuracy30: 0.4607 - accuracy50: 0.4410 - val_loss: 12.6052 - val_accuracy10: 0.4687 - val_accuracy20: 0.4471 - val_accuracy30: 0.4137 - val_accuracy50: 0.3994 - 11s/epoch - 33ms/step
Epoch 20/50
327/327 - 11s - loss: 12.3176 - accuracy10: 0.4885 - accuracy20: 0.4748 - accuracy30: 0.4615 - accuracy50: 0.4405 - val_loss: 12.6181 - val_accuracy10: 0.4749 - val_accuracy20: 0.4494 - val_accuracy30: 0.4209 - val_accuracy50: 0.4033 - 11s/epoch - 33ms/step
Epoch 21/50
327/327 - 11s - loss: 12.2848 - accuracy10: 0.4928 - accuracy20: 0.4783 - accuracy30: 0.4653 - accuracy50: 0.4456 - val_loss: 12.6339 - val_accuracy10: 0.4697 - val_accuracy20: 0.4479 - val_accuracy30: 0.4202 - val_accuracy50: 0.4012 - 11s/epoch - 33ms/step
testing model: results/XRAY/W8/deepVOL_L2/seq2seq
Evaluating performance on  test set...
1162/1162 - 16s - 16s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9547475
{'0': {'precision': 0.4720616184855457, 'recall': 0.3103022014150075, 'f1-score': 0.37445944123084735, 'support': 76042}, '1': {'precision': 0.5924182932685518, 'recall': 0.7155647147936101, 'f1-score': 0.6481943946493257, 'support': 146543}, '2': {'precision': 0.4008911214223887, 'recall': 0.3773070861935415, 'f1-score': 0.3887417355229754, 'support': 74878}, 'accuracy': 0.5268184614557104, 'macro avg': {'precision': 0.4884570110588287, 'recall': 0.46772466746738633, 'f1-score': 0.4704651904677162, 'support': 297463}, 'weighted avg': {'precision': 0.5134392812995124, 'recall': 0.5268184614557104, 'f1-score': 0.5129081589228294, 'support': 297463}}
[[ 23596  35336  17110]
 [ 16571 104861  25111]
 [  9818  36808  28252]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9811544
{'0': {'precision': 0.4584242212721403, 'recall': 0.2742206970341471, 'f1-score': 0.3431659903823388, 'support': 76639}, '1': {'precision': 0.5571143776082507, 'recall': 0.7221582882541433, 'f1-score': 0.6289898565512274, 'support': 145115}, '2': {'precision': 0.38703278017444975, 'recall': 0.32469059160733865, 'f1-score': 0.353131307327094, 'support': 75709}, 'accuracy': 0.505588930387981, 'macro avg': {'precision': 0.46752379301828023, 'recall': 0.4403565256318764, 'f1-score': 0.44176238475355345, 'support': 297463}, 'weighted avg': {'precision': 0.48839920109366297, 'recall': 0.505588930387981, 'f1-score': 0.48513925939283337, 'support': 297463}}
[[ 21016  40676  14947]
 [ 16334 104796  23985]
 [  8494  42633  24582]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0107613
{'0': {'precision': 0.4495831442153795, 'recall': 0.23758426540762997, 'f1-score': 0.31088168490604995, 'support': 79214}, '1': {'precision': 0.5134085832921107, 'recall': 0.7383215848584794, 'f1-score': 0.6056587091069849, 'support': 139167}, '2': {'precision': 0.38253799419495577, 'recall': 0.2683164310462558, 'f1-score': 0.31540456778470616, 'support': 79082}, 'accuracy': 0.4800227255154423, 'macro avg': {'precision': 0.4485099072341487, 'recall': 0.41474076043745506, 'f1-score': 0.410648320599247, 'support': 297463}, 'weighted avg': {'precision': 0.46161936494224737, 'recall': 0.4800227255154423, 'f1-score': 0.4499944913753635, 'support': 297463}}
[[ 18820  47504  12890]
 [ 15057 102750  21360]
 [  7984  49879  21219]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0356073
{'0': {'precision': 0.4101895189135272, 'recall': 0.2057499134049186, 'f1-score': 0.2740414189050646, 'support': 77949}, '1': {'precision': 0.4984669002818618, 'recall': 0.7443689209942551, 'f1-score': 0.5970913653473252, 'support': 140648}, '2': {'precision': 0.34929239427294545, 'recall': 0.21405929044201558, 'f1-score': 0.2654444252268117, 'support': 78866}, 'accuracy': 0.4626256038566141, 'macro avg': {'precision': 0.4193162711561114, 'recall': 0.3880593749470631, 'f1-score': 0.3788590698264005, 'support': 297463}, 'weighted avg': {'precision': 0.43578370878853484, 'recall': 0.4626256038566141, 'f1-score': 0.42450826138221964, 'support': 297463}}
[[ 16038  51123  10788]
 [ 15292 104694  20662]
 [  7769  54215  16882]]
Evaluating performance on  train set...
327/327 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0342519
{'0': {'precision': 0.4739544819653274, 'recall': 0.4161976911976912, 'f1-score': 0.4432023356766931, 'support': 27720}, '1': {'precision': 0.45059838575006955, 'recall': 0.5233648216658885, 'f1-score': 0.4842633520555685, 'support': 27841}, '2': {'precision': 0.45820168754414003, 'recall': 0.43992005995503375, 'f1-score': 0.44887480882674236, 'support': 28021}, 'accuracy': 0.459847814122658, 'macro avg': {'precision': 0.4609181850865123, 'recall': 0.4598275242728711, 'f1-score': 0.458780165519668, 'support': 83582}, 'weighted avg': {'precision': 0.4608934625208886, 'recall': 0.459847814122658, 'f1-score': 0.4587813853182643, 'support': 83582}}
[[11537  8685  7498]
 [ 6192 14571  7078]
 [ 6613  9081 12327]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0495486
{'0': {'precision': 0.47305176020294626, 'recall': 0.383040830300191, 'f1-score': 0.42331434943645707, 'support': 27749}, '1': {'precision': 0.4146877259329292, 'recall': 0.5350147090478582, 'f1-score': 0.4672285230904192, 'support': 27874}, '2': {'precision': 0.45032006679654885, 'recall': 0.4050931721449265, 'f1-score': 0.42651101487478815, 'support': 27959}, 'accuracy': 0.44109975832116965, 'macro avg': {'precision': 0.4460198509774747, 'recall': 0.4410495704976585, 'f1-score': 0.43901796246722147, 'support': 83582}, 'weighted avg': {'precision': 0.44598379691908224, 'recall': 0.44109975832116965, 'f1-score': 0.4390287286738627, 'support': 83582}}
[[10629 10294  6826]
 [ 5962 14913  6999]
 [ 5878 10755 11326]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0636741
{'0': {'precision': 0.47612177892746993, 'recall': 0.33985512392585754, 'f1-score': 0.39661030996187635, 'support': 28162}, '1': {'precision': 0.3800536454523287, 'recall': 0.5752352832625945, 'f1-score': 0.45770501431612953, 'support': 27095}, '2': {'precision': 0.44744103248776146, 'recall': 0.3549514563106796, 'f1-score': 0.3958657348164189, 'support': 28325}, 'accuracy': 0.42127491565169534, 'macro avg': {'precision': 0.4345388189558534, 'recall': 0.42334728783304393, 'f1-score': 0.41672701969814163, 'support': 83582}, 'weighted avg': {'precision': 0.43525953323565, 'recall': 0.42127491565169534, 'f1-score': 0.41616321517452265, 'support': 83582}}
[[ 9571 12426  6165]
 [ 5258 15586  6251]
 [ 5273 12998 10054]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0771877
{'0': {'precision': 0.44749605233476203, 'recall': 0.2838591972526293, 'f1-score': 0.3473711859212888, 'support': 27954}, '1': {'precision': 0.3719596342936001, 'recall': 0.620392015824492, 'f1-score': 0.4650786589557973, 'support': 27805}, '2': {'precision': 0.42944438738831264, 'recall': 0.30057865794486577, 'f1-score': 0.3536376514366662, 'support': 27823}, 'accuracy': 0.401378287191022, 'macro avg': {'precision': 0.416300024672225, 'recall': 0.40160995700732904, 'f1-score': 0.3886958321045841, 'support': 83582}, 'weighted avg': {'precision': 0.41635846795726966, 'recall': 0.401378287191022, 'f1-score': 0.3886146134267189, 'support': 83582}}
[[ 7935 14333  5686]
 [ 5130 17250  5425]
 [ 4667 14793  8363]]
Evaluating performance on  val set...
125/125 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.019348
{'0': {'precision': 0.45788177339901476, 'recall': 0.38012473162253346, 'f1-score': 0.4153957879448075, 'support': 9781}, '1': {'precision': 0.49061129385964913, 'recall': 0.5954915987356513, 'f1-score': 0.5379875253625911, 'support': 12022}, '2': {'precision': 0.4644273127753304, 'recall': 0.4221643808189008, 'f1-score': 0.44228853112381356, 'support': 9989}, 'accuracy': 0.4747735279315551, 'macro avg': {'precision': 0.4709734600113314, 'recall': 0.4659269037256952, 'f1-score': 0.4652239481437374, 'support': 31792}, 'weighted avg': {'precision': 0.47231489141007926, 'recall': 0.4747735279315551, 'f1-score': 0.4702029557496542, 'support': 31792}}
[[3718 3652 2411]
 [2411 7159 2452]
 [1991 3781 4217]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.037334
{'0': {'precision': 0.45811898166468806, 'recall': 0.35345003053124363, 'f1-score': 0.3990348710288964, 'support': 9826}, '1': {'precision': 0.4567313792665905, 'recall': 0.6017721307364373, 'f1-score': 0.5193146979260596, 'support': 11963}, '2': {'precision': 0.4523612261806131, 'recall': 0.3820853743876837, 'f1-score': 0.4142640364188164, 'support': 10003}, 'accuracy': 0.45590085556114746, 'macro avg': {'precision': 0.4557371957039639, 'recall': 0.44576917855178827, 'f1-score': 0.44420453512459074, 'support': 31792}, 'weighted avg': {'precision': 0.4557852273996012, 'recall': 0.45590085556114746, 'f1-score': 0.44908661079255174, 'support': 31792}}
[[3473 4159 2194]
 [2331 7199 2433]
 [1777 4404 3822]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0554136
{'0': {'precision': 0.4618808327351041, 'recall': 0.31876734046769717, 'f1-score': 0.37720583924488477, 'support': 10092}, '1': {'precision': 0.4176718416344434, 'recall': 0.6280482513234401, 'f1-score': 0.5016984402079724, 'support': 11523}, '2': {'precision': 0.4474666666666667, 'recall': 0.3297631915102682, 'f1-score': 0.37970243819652655, 'support': 10177}, 'accuracy': 0.43438600905888275, 'macro avg': {'precision': 0.4423397803454047, 'recall': 0.4255262611004685, 'f1-score': 0.4195355725497946, 'support': 31792}, 'weighted avg': {'precision': 0.44124315116328094, 'recall': 0.43438600905888275, 'f1-score': 0.42312733296747274, 'support': 31792}}
[[3217 4933 1942]
 [2084 7237 2202]
 [1664 5157 3356]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0718491
{'0': {'precision': 0.4357733728734197, 'recall': 0.2783926612822814, 'f1-score': 0.33974202969092243, 'support': 10029}, '1': {'precision': 0.3966911570378984, 'recall': 0.6494461751471097, 'f1-score': 0.49253486464315016, 'support': 11556}, '2': {'precision': 0.4314877822455923, 'recall': 0.27334182423826786, 'f1-score': 0.3346728243267558, 'support': 10207}, 'accuracy': 0.41164443885254154, 'macro avg': {'precision': 0.4213174373856368, 'recall': 0.4003935535558863, 'f1-score': 0.38898323955360947, 'support': 31792}, 'weighted avg': {'precision': 0.4201915563870861, 'recall': 0.41164443885254154, 'f1-score': 0.3936528444102196, 'support': 31792}}
[[2792 5560 1677]
 [2052 7505 1999]
 [1563 5854 2790]]
training model: results/XRAY/W8/deepVOL_L3/seq2seq
Epoch 1/50
327/327 - 21s - loss: 13.2326 - accuracy10: 0.3680 - accuracy20: 0.3648 - accuracy30: 0.3592 - accuracy50: 0.3618 - val_loss: 13.3700 - val_accuracy10: 0.3782 - val_accuracy20: 0.3770 - val_accuracy30: 0.3629 - val_accuracy50: 0.3639 - 21s/epoch - 65ms/step
Epoch 2/50
327/327 - 15s - loss: 13.1211 - accuracy10: 0.3847 - accuracy20: 0.3788 - accuracy30: 0.3713 - accuracy50: 0.3715 - val_loss: 13.0741 - val_accuracy10: 0.3869 - val_accuracy20: 0.3804 - val_accuracy30: 0.3690 - val_accuracy50: 0.3665 - 15s/epoch - 47ms/step
Epoch 3/50
327/327 - 15s - loss: 13.0016 - accuracy10: 0.4030 - accuracy20: 0.3966 - accuracy30: 0.3901 - accuracy50: 0.3832 - val_loss: 12.9188 - val_accuracy10: 0.4049 - val_accuracy20: 0.3993 - val_accuracy30: 0.3864 - val_accuracy50: 0.3791 - 15s/epoch - 46ms/step
Epoch 4/50
327/327 - 15s - loss: 12.8954 - accuracy10: 0.4174 - accuracy20: 0.4108 - accuracy30: 0.4009 - accuracy50: 0.3899 - val_loss: 12.8207 - val_accuracy10: 0.4237 - val_accuracy20: 0.4183 - val_accuracy30: 0.4098 - val_accuracy50: 0.4027 - 15s/epoch - 46ms/step
Epoch 5/50
327/327 - 15s - loss: 12.8126 - accuracy10: 0.4288 - accuracy20: 0.4210 - accuracy30: 0.4127 - accuracy50: 0.3990 - val_loss: 12.7734 - val_accuracy10: 0.4242 - val_accuracy20: 0.4214 - val_accuracy30: 0.4126 - val_accuracy50: 0.4016 - 15s/epoch - 46ms/step
Epoch 6/50
327/327 - 15s - loss: 12.7592 - accuracy10: 0.4394 - accuracy20: 0.4297 - accuracy30: 0.4217 - accuracy50: 0.4043 - val_loss: 12.7434 - val_accuracy10: 0.4323 - val_accuracy20: 0.4240 - val_accuracy30: 0.4150 - val_accuracy50: 0.4043 - 15s/epoch - 46ms/step
Epoch 7/50
327/327 - 15s - loss: 12.7078 - accuracy10: 0.4476 - accuracy20: 0.4381 - accuracy30: 0.4268 - accuracy50: 0.4088 - val_loss: 12.6946 - val_accuracy10: 0.4469 - val_accuracy20: 0.4363 - val_accuracy30: 0.4257 - val_accuracy50: 0.4145 - 15s/epoch - 46ms/step
Epoch 8/50
327/327 - 15s - loss: 12.6679 - accuracy10: 0.4545 - accuracy20: 0.4446 - accuracy30: 0.4336 - accuracy50: 0.4127 - val_loss: 12.6680 - val_accuracy10: 0.4495 - val_accuracy20: 0.4405 - val_accuracy30: 0.4253 - val_accuracy50: 0.4164 - 15s/epoch - 46ms/step
Epoch 9/50
327/327 - 15s - loss: 12.6209 - accuracy10: 0.4595 - accuracy20: 0.4473 - accuracy30: 0.4357 - accuracy50: 0.4130 - val_loss: 12.6632 - val_accuracy10: 0.4547 - val_accuracy20: 0.4419 - val_accuracy30: 0.4266 - val_accuracy50: 0.4141 - 15s/epoch - 46ms/step
Epoch 10/50
327/327 - 15s - loss: 12.5801 - accuracy10: 0.4644 - accuracy20: 0.4535 - accuracy30: 0.4404 - accuracy50: 0.4173 - val_loss: 12.6288 - val_accuracy10: 0.4578 - val_accuracy20: 0.4411 - val_accuracy30: 0.4224 - val_accuracy50: 0.4095 - 15s/epoch - 46ms/step
Epoch 11/50
327/327 - 15s - loss: 12.5574 - accuracy10: 0.4654 - accuracy20: 0.4543 - accuracy30: 0.4436 - accuracy50: 0.4198 - val_loss: 12.6412 - val_accuracy10: 0.4611 - val_accuracy20: 0.4486 - val_accuracy30: 0.4273 - val_accuracy50: 0.4116 - 15s/epoch - 45ms/step
Epoch 12/50
327/327 - 15s - loss: 12.5361 - accuracy10: 0.4701 - accuracy20: 0.4569 - accuracy30: 0.4454 - accuracy50: 0.4216 - val_loss: 12.6274 - val_accuracy10: 0.4594 - val_accuracy20: 0.4434 - val_accuracy30: 0.4243 - val_accuracy50: 0.4120 - 15s/epoch - 46ms/step
Epoch 13/50
327/327 - 15s - loss: 12.4972 - accuracy10: 0.4735 - accuracy20: 0.4619 - accuracy30: 0.4507 - accuracy50: 0.4265 - val_loss: 12.6290 - val_accuracy10: 0.4647 - val_accuracy20: 0.4489 - val_accuracy30: 0.4301 - val_accuracy50: 0.4143 - 15s/epoch - 46ms/step
Epoch 14/50
327/327 - 15s - loss: 12.4774 - accuracy10: 0.4756 - accuracy20: 0.4638 - accuracy30: 0.4520 - accuracy50: 0.4284 - val_loss: 12.6167 - val_accuracy10: 0.4696 - val_accuracy20: 0.4492 - val_accuracy30: 0.4244 - val_accuracy50: 0.4097 - 15s/epoch - 46ms/step
Epoch 15/50
327/327 - 15s - loss: 12.4460 - accuracy10: 0.4785 - accuracy20: 0.4665 - accuracy30: 0.4544 - accuracy50: 0.4297 - val_loss: 12.6479 - val_accuracy10: 0.4701 - val_accuracy20: 0.4519 - val_accuracy30: 0.4277 - val_accuracy50: 0.4111 - 15s/epoch - 46ms/step
Epoch 16/50
327/327 - 15s - loss: 12.4232 - accuracy10: 0.4820 - accuracy20: 0.4678 - accuracy30: 0.4564 - accuracy50: 0.4325 - val_loss: 12.6371 - val_accuracy10: 0.4689 - val_accuracy20: 0.4490 - val_accuracy30: 0.4308 - val_accuracy50: 0.4118 - 15s/epoch - 46ms/step
Epoch 17/50
327/327 - 15s - loss: 12.4015 - accuracy10: 0.4844 - accuracy20: 0.4710 - accuracy30: 0.4583 - accuracy50: 0.4353 - val_loss: 12.5903 - val_accuracy10: 0.4746 - val_accuracy20: 0.4515 - val_accuracy30: 0.4311 - val_accuracy50: 0.4119 - 15s/epoch - 46ms/step
Epoch 18/50
327/327 - 15s - loss: 12.3864 - accuracy10: 0.4833 - accuracy20: 0.4703 - accuracy30: 0.4590 - accuracy50: 0.4361 - val_loss: 12.5760 - val_accuracy10: 0.4757 - val_accuracy20: 0.4540 - val_accuracy30: 0.4292 - val_accuracy50: 0.4066 - 15s/epoch - 46ms/step
Epoch 19/50
327/327 - 15s - loss: 12.3731 - accuracy10: 0.4868 - accuracy20: 0.4740 - accuracy30: 0.4618 - accuracy50: 0.4385 - val_loss: 12.6211 - val_accuracy10: 0.4760 - val_accuracy20: 0.4521 - val_accuracy30: 0.4305 - val_accuracy50: 0.4105 - 15s/epoch - 46ms/step
Epoch 20/50
327/327 - 15s - loss: 12.3528 - accuracy10: 0.4850 - accuracy20: 0.4742 - accuracy30: 0.4643 - accuracy50: 0.4409 - val_loss: 12.6148 - val_accuracy10: 0.4790 - val_accuracy20: 0.4576 - val_accuracy30: 0.4334 - val_accuracy50: 0.4091 - 15s/epoch - 46ms/step
Epoch 21/50
327/327 - 15s - loss: 12.3192 - accuracy10: 0.4886 - accuracy20: 0.4763 - accuracy30: 0.4675 - accuracy50: 0.4443 - val_loss: 12.6561 - val_accuracy10: 0.4735 - val_accuracy20: 0.4523 - val_accuracy30: 0.4320 - val_accuracy50: 0.4135 - 15s/epoch - 46ms/step
Epoch 22/50
327/327 - 15s - loss: 12.3117 - accuracy10: 0.4890 - accuracy20: 0.4770 - accuracy30: 0.4679 - accuracy50: 0.4437 - val_loss: 12.6372 - val_accuracy10: 0.4751 - val_accuracy20: 0.4529 - val_accuracy30: 0.4304 - val_accuracy50: 0.4112 - 15s/epoch - 46ms/step
Epoch 23/50
327/327 - 15s - loss: 12.2884 - accuracy10: 0.4920 - accuracy20: 0.4804 - accuracy30: 0.4706 - accuracy50: 0.4461 - val_loss: 12.6065 - val_accuracy10: 0.4767 - val_accuracy20: 0.4528 - val_accuracy30: 0.4316 - val_accuracy50: 0.4094 - 15s/epoch - 45ms/step
Epoch 24/50
327/327 - 15s - loss: 12.2507 - accuracy10: 0.4941 - accuracy20: 0.4815 - accuracy30: 0.4716 - accuracy50: 0.4499 - val_loss: 12.6420 - val_accuracy10: 0.4758 - val_accuracy20: 0.4491 - val_accuracy30: 0.4254 - val_accuracy50: 0.4070 - 15s/epoch - 45ms/step
Epoch 25/50
327/327 - 15s - loss: 12.2257 - accuracy10: 0.4953 - accuracy20: 0.4850 - accuracy30: 0.4760 - accuracy50: 0.4550 - val_loss: 12.6636 - val_accuracy10: 0.4696 - val_accuracy20: 0.4461 - val_accuracy30: 0.4229 - val_accuracy50: 0.4037 - 15s/epoch - 46ms/step
Epoch 26/50
327/327 - 15s - loss: 12.2229 - accuracy10: 0.4953 - accuracy20: 0.4852 - accuracy30: 0.4749 - accuracy50: 0.4517 - val_loss: 12.6752 - val_accuracy10: 0.4674 - val_accuracy20: 0.4430 - val_accuracy30: 0.4228 - val_accuracy50: 0.4081 - 15s/epoch - 45ms/step
Epoch 27/50
327/327 - 15s - loss: 12.2155 - accuracy10: 0.4951 - accuracy20: 0.4844 - accuracy30: 0.4754 - accuracy50: 0.4537 - val_loss: 12.6720 - val_accuracy10: 0.4700 - val_accuracy20: 0.4472 - val_accuracy30: 0.4219 - val_accuracy50: 0.4053 - 15s/epoch - 45ms/step
Epoch 28/50
327/327 - 15s - loss: 12.2121 - accuracy10: 0.4975 - accuracy20: 0.4870 - accuracy30: 0.4773 - accuracy50: 0.4543 - val_loss: 12.6740 - val_accuracy10: 0.4655 - val_accuracy20: 0.4412 - val_accuracy30: 0.4189 - val_accuracy50: 0.4006 - 15s/epoch - 46ms/step
testing model: results/XRAY/W8/deepVOL_L3/seq2seq
Evaluating performance on  test set...
1162/1162 - 23s - 23s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9592733
{'0': {'precision': 0.44301984397380095, 'recall': 0.4189526840430289, 'f1-score': 0.4306502740735234, 'support': 76042}, '1': {'precision': 0.6068452950558214, 'recall': 0.6491132295640187, 'f1-score': 0.6272680213522898, 'support': 146543}, '2': {'precision': 0.40462486555623384, 'recall': 0.3717914474211384, 'f1-score': 0.3875139198218263, 'support': 74878}, 'accuracy': 0.5204680918299083, 'macro avg': {'precision': 0.4848300015286187, 'recall': 0.479952453676062, 'f1-score': 0.4818107384158798, 'support': 297463}, 'weighted avg': {'precision': 0.5140624068604858, 'recall': 0.5204680918299083, 'f1-score': 0.5166542160959386, 'support': 297463}}
[[31858 29300 14884]
 [25341 95123 26079]
 [14712 32327 27839]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9827141
{'0': {'precision': 0.4409070235852121, 'recall': 0.3541799866908493, 'f1-score': 0.3928134700404477, 'support': 76639}, '1': {'precision': 0.5560879368658399, 'recall': 0.6798056713640905, 'f1-score': 0.61175449203913, 'support': 145115}, '2': {'precision': 0.39250243593907586, 'recall': 0.3032796629198642, 'f1-score': 0.3421703624225083, 'support': 75709}, 'accuracy': 0.5000790014220255, 'macro avg': {'precision': 0.46316579879670927, 'recall': 0.4457551069916013, 'f1-score': 0.4489127748340287, 'support': 297463}, 'weighted avg': {'precision': 0.48477740512717515, 'recall': 0.5000790014220255, 'f1-score': 0.48673267132831277, 'support': 297463}}
[[27144 37633 11862]
 [22789 98650 23676]
 [11631 41117 22961]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0123192
{'0': {'precision': 0.43682513788549676, 'recall': 0.2839523316585452, 'f1-score': 0.34417700794148703, 'support': 79214}, '1': {'precision': 0.5077405067812351, 'recall': 0.7150258322734556, 'f1-score': 0.5938134978770637, 'support': 139167}, '2': {'precision': 0.3896857308607894, 'recall': 0.2463265977087074, 'f1-score': 0.30184936972673954, 'support': 79082}, 'accuracy': 0.47562553998312396, 'macro avg': {'precision': 0.4447504585091737, 'recall': 0.41510158721356943, 'f1-score': 0.41327995851509675, 'support': 297463}, 'weighted avg': {'precision': 0.4574703964782808, 'recall': 0.47562553998312396, 'f1-score': 0.44971553579054974, 'support': 297463}}
[[22493 46840  9881]
 [19031 99508 20628]
 [ 9968 49634 19480]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0400674
{'0': {'precision': 0.3869009142118386, 'recall': 0.21499955098846682, 'f1-score': 0.27640291922648746, 'support': 77949}, '1': {'precision': 0.49251931072649957, 'recall': 0.7403162504976963, 'f1-score': 0.5915144904689271, 'support': 140648}, '2': {'precision': 0.36931392736802693, 'recall': 0.20012426140542186, 'f1-score': 0.25958454630680416, 'support': 78866}, 'accuracy': 0.45943865287447516, 'macro avg': {'precision': 0.41624471743545505, 'recall': 0.38514668763052834, 'f1-score': 0.3758339853340729, 'support': 297463}, 'weighted avg': {'precision': 0.4321771365607357, 'recall': 0.45943865287447516, 'f1-score': 0.4209365737429245, 'support': 297463}}
[[ 16759  52825   8365]
 [ 17936 104124  18588]
 [  8621  54462  15783]]
Evaluating performance on  train set...
327/327 - 7s - 7s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0297527
{'0': {'precision': 0.48205406760539843, 'recall': 0.4161976911976912, 'f1-score': 0.44671171083964145, 'support': 27720}, '1': {'precision': 0.4727770677378127, 'recall': 0.46503358356380875, 'f1-score': 0.4688733567522544, 'support': 27841}, '2': {'precision': 0.4513389536325316, 'recall': 0.5196816673209379, 'f1-score': 0.48310525006220456, 'support': 28021}, 'accuracy': 0.46715800052642914, 'macro avg': {'precision': 0.46872336299191425, 'recall': 0.46697098069414594, 'f1-score': 0.4662301058847001, 'support': 83582}, 'weighted avg': {'precision': 0.4686666257884144, 'recall': 0.46715800052642914, 'f1-score': 0.4662947041445217, 'support': 83582}}
[[11537  6930  9253]
 [ 6445 12947  8449]
 [ 5951  7508 14562]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0456059
{'0': {'precision': 0.48455481526347666, 'recall': 0.37478828065876246, 'f1-score': 0.422661139559457, 'support': 27749}, '1': {'precision': 0.42537866437442573, 'recall': 0.5148525507641529, 'f1-score': 0.4658583694470143, 'support': 27874}, '2': {'precision': 0.4491931505884011, 'recall': 0.4559891269358704, 'f1-score': 0.4525656271631671, 'support': 27959}, 'accuracy': 0.4486611949941375, 'macro avg': {'precision': 0.4530422100754345, 'recall': 0.44854331945292863, 'f1-score': 0.44702837872321277, 'support': 83582}, 'weighted avg': {'precision': 0.45299116743820517, 'recall': 0.4486611949941375, 'f1-score': 0.44707045202862383, 'support': 83582}}
[[10400  9397  7952]
 [ 5842 14351  7681]
 [ 5221  9989 12749]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0633216
{'0': {'precision': 0.4850978530358179, 'recall': 0.3265393082877637, 'f1-score': 0.3903308644071394, 'support': 28162}, '1': {'precision': 0.38497699791347195, 'recall': 0.565196530725226, 'f1-score': 0.4579956335795675, 'support': 27095}, '2': {'precision': 0.44731546325364246, 'recall': 0.3923742277140335, 'f1-score': 0.41804743187075666, 'support': 28325}, 'accuracy': 0.4262161709458974, 'macro avg': {'precision': 0.4391301047343108, 'recall': 0.4280366889090077, 'f1-score': 0.4221246432858212, 'support': 83582}, 'weighted avg': {'precision': 0.439837381162447, 'recall': 0.4262161709458974, 'f1-score': 0.4216587662775648, 'support': 83582}}
[[ 9196 11873  7093]
 [ 5142 15314  6639]
 [ 4619 12592 11114]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.082698
{'0': {'precision': 0.4512485136741974, 'recall': 0.27151749302425415, 'f1-score': 0.3390360477062581, 'support': 27954}, '1': {'precision': 0.3766440460664471, 'recall': 0.6128034526164359, 'f1-score': 0.4665407151853677, 'support': 27805}, '2': {'precision': 0.42954049156716073, 'recall': 0.3322790497070769, 'f1-score': 0.3747010902606087, 'support': 27823}, 'accuracy': 0.4052786485128377, 'macro avg': {'precision': 0.41914435043593506, 'recall': 0.40553333178258893, 'f1-score': 0.3934259510507448, 'support': 83582}, 'weighted avg': {'precision': 0.41920382078676255, 'recall': 0.4052786485128377, 'f1-score': 0.3933249586948243, 'support': 83582}}
[[ 7590 13937  6427]
 [ 4915 17039  5851]
 [ 4315 14263  9245]]
Evaluating performance on  val set...
125/125 - 2s - 2s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0178722
{'0': {'precision': 0.46151315789473685, 'recall': 0.43032409774051733, 'f1-score': 0.44537326067403843, 'support': 9781}, '1': {'precision': 0.5174980747839479, 'recall': 0.5030776909000166, 'f1-score': 0.5101860053144375, 'support': 12022}, '2': {'precision': 0.44733727810650886, 'recall': 0.49194113524877364, 'f1-score': 0.4685801468484791, 'support': 9989}, 'accuracy': 0.4771955208857574, 'macro avg': {'precision': 0.47544950359506455, 'recall': 0.47511430796310256, 'f1-score': 0.47471313761231837, 'support': 31792}, 'weighted avg': {'precision': 0.4782295584872597, 'recall': 0.4771955208857574, 'f1-score': 0.47717347462922727, 'support': 31792}}
[[4209 2683 2889]
 [2792 6048 3182]
 [2119 2956 4914]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0363585
{'0': {'precision': 0.45825847406875075, 'recall': 0.38937512721351514, 'f1-score': 0.42101788170563964, 'support': 9826}, '1': {'precision': 0.4654478976234004, 'recall': 0.5320571762935719, 'f1-score': 0.49652859037366415, 'support': 11963}, '2': {'precision': 0.44256756756756754, 'recall': 0.4321703488953314, 'f1-score': 0.4373071670628698, 'support': 10003}, 'accuracy': 0.45652994464016106, 'macro avg': {'precision': 0.45542464641990626, 'recall': 0.4512008841341395, 'f1-score': 0.4516178797140579, 'support': 31792}, 'weighted avg': {'precision': 0.45602681001027495, 'recall': 0.45652994464016106, 'f1-score': 0.4545570214019139, 'support': 31792}}
[[3826 3492 2508]
 [2661 6365 2937]
 [1862 3818 4323]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0579976
{'0': {'precision': 0.45965475712565235, 'recall': 0.34036860879904873, 'f1-score': 0.3911187019641332, 'support': 10092}, '1': {'precision': 0.42069583013558454, 'recall': 0.5708582834331337, 'f1-score': 0.48440664236533004, 'support': 11523}, '2': {'precision': 0.4314177127720834, 'recall': 0.3680848973174806, 'f1-score': 0.39724284199363735, 'support': 10177}, 'accuracy': 0.4327818319073981, 'macro avg': {'precision': 0.43725610001110676, 'recall': 0.426437263183221, 'f1-score': 0.4242560621077002, 'support': 31792}, 'weighted avg': {'precision': 0.43649509066576236, 'recall': 0.4327818319073981, 'f1-score': 0.4268912960231183, 'support': 31792}}
[[3435 4351 2306]
 [2314 6578 2631]
 [1724 4707 3746]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0799216
{'0': {'precision': 0.4350871963034729, 'recall': 0.29105593778043676, 'f1-score': 0.3487871908232764, 'support': 10029}, '1': {'precision': 0.4008677284923217, 'recall': 0.6076497057805469, 'f1-score': 0.48305988374092795, 'support': 11556}, '2': {'precision': 0.4106529209621993, 'recall': 0.30439894190261585, 'f1-score': 0.3496314634558037, 'support': 10207}, 'accuracy': 0.41041771514846503, 'macro avg': {'precision': 0.41553594858599796, 'recall': 0.40103486182119985, 'f1-score': 0.3938261793400027, 'support': 31792}, 'weighted avg': {'precision': 0.4148040804745209, 'recall': 0.41041771514846503, 'f1-score': 0.39786471756322944, 'support': 31792}}
[[2919 5008 2102]
 [2177 7022 2357]
 [1613 5487 3107]]
training model: results/XRAY/W9/deepLOB_L1/seq2seq
Epoch 1/50
262/262 - 14s - loss: 13.0615 - accuracy10: 0.3994 - accuracy20: 0.3963 - accuracy30: 0.3878 - accuracy50: 0.3826 - val_loss: 13.3700 - val_accuracy10: 0.3507 - val_accuracy20: 0.3516 - val_accuracy30: 0.3586 - val_accuracy50: 0.3597 - 14s/epoch - 52ms/step
Epoch 2/50
262/262 - 7s - loss: 12.9618 - accuracy10: 0.4144 - accuracy20: 0.4087 - accuracy30: 0.4014 - accuracy50: 0.3931 - val_loss: 13.2397 - val_accuracy10: 0.3565 - val_accuracy20: 0.3616 - val_accuracy30: 0.3694 - val_accuracy50: 0.3726 - 7s/epoch - 27ms/step
Epoch 3/50
262/262 - 7s - loss: 12.8233 - accuracy10: 0.4331 - accuracy20: 0.4278 - accuracy30: 0.4166 - accuracy50: 0.4116 - val_loss: 14.0306 - val_accuracy10: 0.3424 - val_accuracy20: 0.3377 - val_accuracy30: 0.3400 - val_accuracy50: 0.3610 - 7s/epoch - 26ms/step
Epoch 4/50
262/262 - 7s - loss: 12.7734 - accuracy10: 0.4423 - accuracy20: 0.4328 - accuracy30: 0.4191 - accuracy50: 0.4101 - val_loss: 13.8303 - val_accuracy10: 0.3469 - val_accuracy20: 0.3422 - val_accuracy30: 0.3428 - val_accuracy50: 0.3624 - 7s/epoch - 26ms/step
Epoch 5/50
262/262 - 7s - loss: 12.7007 - accuracy10: 0.4532 - accuracy20: 0.4438 - accuracy30: 0.4278 - accuracy50: 0.4168 - val_loss: 13.9107 - val_accuracy10: 0.3621 - val_accuracy20: 0.3513 - val_accuracy30: 0.3460 - val_accuracy50: 0.3619 - 7s/epoch - 26ms/step
Epoch 6/50
262/262 - 7s - loss: 12.6590 - accuracy10: 0.4560 - accuracy20: 0.4449 - accuracy30: 0.4291 - accuracy50: 0.4158 - val_loss: 13.7790 - val_accuracy10: 0.3633 - val_accuracy20: 0.3527 - val_accuracy30: 0.3456 - val_accuracy50: 0.3643 - 7s/epoch - 26ms/step
Epoch 7/50
262/262 - 7s - loss: 12.6389 - accuracy10: 0.4613 - accuracy20: 0.4480 - accuracy30: 0.4313 - accuracy50: 0.4183 - val_loss: 13.8232 - val_accuracy10: 0.3803 - val_accuracy20: 0.3701 - val_accuracy30: 0.3625 - val_accuracy50: 0.3712 - 7s/epoch - 27ms/step
Epoch 8/50
262/262 - 7s - loss: 12.6044 - accuracy10: 0.4665 - accuracy20: 0.4530 - accuracy30: 0.4344 - accuracy50: 0.4216 - val_loss: 14.1148 - val_accuracy10: 0.3487 - val_accuracy20: 0.3399 - val_accuracy30: 0.3428 - val_accuracy50: 0.3657 - 7s/epoch - 26ms/step
Epoch 9/50
262/262 - 7s - loss: 12.5819 - accuracy10: 0.4663 - accuracy20: 0.4524 - accuracy30: 0.4352 - accuracy50: 0.4231 - val_loss: 13.3168 - val_accuracy10: 0.3808 - val_accuracy20: 0.3724 - val_accuracy30: 0.3654 - val_accuracy50: 0.3757 - 7s/epoch - 26ms/step
Epoch 10/50
262/262 - 7s - loss: 12.5529 - accuracy10: 0.4725 - accuracy20: 0.4581 - accuracy30: 0.4385 - accuracy50: 0.4238 - val_loss: 13.5767 - val_accuracy10: 0.4162 - val_accuracy20: 0.4002 - val_accuracy30: 0.3851 - val_accuracy50: 0.3742 - 7s/epoch - 27ms/step
Epoch 11/50
262/262 - 7s - loss: 12.5366 - accuracy10: 0.4732 - accuracy20: 0.4586 - accuracy30: 0.4399 - accuracy50: 0.4250 - val_loss: 13.4095 - val_accuracy10: 0.4139 - val_accuracy20: 0.4030 - val_accuracy30: 0.3836 - val_accuracy50: 0.3754 - 7s/epoch - 26ms/step
Epoch 12/50
262/262 - 7s - loss: 12.5057 - accuracy10: 0.4755 - accuracy20: 0.4615 - accuracy30: 0.4419 - accuracy50: 0.4249 - val_loss: 13.3045 - val_accuracy10: 0.4319 - val_accuracy20: 0.4156 - val_accuracy30: 0.3951 - val_accuracy50: 0.3795 - 7s/epoch - 26ms/step
testing model: results/XRAY/W9/deepLOB_L1/seq2seq
Evaluating performance on  test set...
508/508 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.058183
{'0': {'precision': 0.396355308487316, 'recall': 0.5308150051118043, 'f1-score': 0.4538353784949852, 'support': 38147}, '1': {'precision': 0.4109568948130764, 'recall': 0.4281239255835275, 'f1-score': 0.41936479723092757, 'support': 52354}, '2': {'precision': 0.3744944283945522, 'recall': 0.23055033284211596, 'f1-score': 0.28539976096118763, 'support': 39358}, 'accuracy': 0.39840904365504126, 'macro avg': {'precision': 0.3939355438983148, 'recall': 0.3964964211791493, 'f1-score': 0.38619997889570007, 'support': 129859}, 'weighted avg': {'precision': 0.3956164373409793, 'recall': 0.39840904365504126, 'f1-score': 0.3888883063136679, 'support': 129859}}
[[20249 14258  3640]
 [18424 22414 11516]
 [12415 17869  9074]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0662619
{'0': {'precision': 0.399402157275854, 'recall': 0.5612348178137652, 'f1-score': 0.46668700619654296, 'support': 39520}, '1': {'precision': 0.38748635073160076, 'recall': 0.3547606670132363, 'f1-score': 0.3704020708947434, 'support': 50014}, '2': {'precision': 0.3761914774320157, 'recall': 0.2662120272783633, 'f1-score': 0.31178751397743276, 'support': 40325}, 'accuracy': 0.3901000315727058, 'macro avg': {'precision': 0.38769332847982346, 'recall': 0.39406917070178826, 'f1-score': 0.3829588636895731, 'support': 129859}, 'weighted avg': {'precision': 0.3876053021236731, 'recall': 0.3901000315727058, 'f1-score': 0.3815029467326642, 'support': 129859}}
[[22180 12632  4708]
 [19178 17743 13093]
 [14175 15415 10735]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0724804
{'0': {'precision': 0.39609999292836434, 'recall': 0.5628407064084207, 'f1-score': 0.4649739029376057, 'support': 39807}, '1': {'precision': 0.38102673745405624, 'recall': 0.32160019465114864, 'f1-score': 0.3488003870428606, 'support': 49319}, '2': {'precision': 0.37280535556397626, 'recall': 0.28983870571772274, 'f1-score': 0.3261280921534233, 'support': 40733}, 'accuracy': 0.38558744484402313, 'macro avg': {'precision': 0.38331069531546563, 'recall': 0.3914265355924307, 'f1-score': 0.37996746071129656, 'support': 129859}, 'weighted avg': {'precision': 0.3830684868294338, 'recall': 0.38558744484402313, 'f1-score': 0.37730059541879657, 'support': 129859}}
[[22405 11881  5521]
 [19117 15861 14341]
 [15042 13885 11806]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0879307
{'0': {'precision': 0.41196217152757725, 'recall': 0.5302083575294418, 'f1-score': 0.46366507886531455, 'support': 43051}, '1': {'precision': 0.3133673494540166, 'recall': 0.30491197774260087, 'f1-score': 0.309081847246028, 'support': 41694}, '2': {'precision': 0.38879050823446076, 'recall': 0.29199361617236336, 'f1-score': 0.3335105574965821, 'support': 45114}, 'accuracy': 0.375114547316705, 'macro avg': {'precision': 0.37137334307201825, 'recall': 0.37570465048146867, 'f1-score': 0.36875249453597486, 'support': 129859}, 'weighted avg': {'precision': 0.37225619096912005, 'recall': 0.375114547316705, 'f1-score': 0.36881617092544494, 'support': 129859}}
[[22826 13053  7172]
 [15444 12713 13537]
 [17138 14803 13173]]
Evaluating performance on  train set...
262/262 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0837264
{'0': {'precision': 0.42577687756516175, 'recall': 0.3584795584077548, 'f1-score': 0.3892408147354059, 'support': 22283}, '1': {'precision': 0.36290126754407265, 'recall': 0.650659584657582, 'f1-score': 0.4659319418247572, 'support': 22969}, '2': {'precision': 0.44618479666618766, 'recall': 0.14341801385681294, 'f1-score': 0.21706456010346398, 'support': 21650}, 'accuracy': 0.38919613763415145, 'macro avg': {'precision': 0.41162098059180735, 'recall': 0.38418571897404985, 'f1-score': 0.3574124388878757, 'support': 66902}, 'weighted avg': {'precision': 0.4107943891786085, 'recall': 0.38919613763415145, 'f1-score': 0.359853092176047, 'support': 66902}}
[[ 7988 12664  1631]
 [ 5801 14945  2223]
 [ 4972 13573  3105]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0898731
{'0': {'precision': 0.4216861645557382, 'recall': 0.38205150665732307, 'f1-score': 0.4008915850912267, 'support': 22832}, '1': {'precision': 0.3441006369766264, 'recall': 0.5949221269929039, 'f1-score': 0.4360130354760819, 'support': 21702}, '2': {'precision': 0.4455434157561817, 'recall': 0.17319384835479257, 'f1-score': 0.2494285806264688, 'support': 22368}, 'accuracy': 0.3812741024184628, 'macro avg': {'precision': 0.4037767390961821, 'recall': 0.3833891606683399, 'f1-score': 0.36211106706459245, 'support': 66902}, 'weighted avg': {'precision': 0.40449501743501887, 'recall': 0.3812741024184628, 'f1-score': 0.3616443463298208, 'support': 66902}}
[[ 8723 11913  2196]
 [ 6166 12911  2625]
 [ 5797 12697  3874]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0889026
{'0': {'precision': 0.4065694108901691, 'recall': 0.38889876455426187, 'f1-score': 0.39753781856175896, 'support': 22502}, '1': {'precision': 0.34997433996692706, 'recall': 0.5497581512002866, 'f1-score': 0.4276854465001219, 'support': 22328}, '2': {'precision': 0.42789208074534163, 'recall': 0.19975534613990575, 'f1-score': 0.27236224363726214, 'support': 22072}, 'accuracy': 0.3801829541717736, 'macro avg': {'precision': 0.3948119438674793, 'recall': 0.3794707539648181, 'f1-score': 0.3658618362330477, 'support': 66902}, 'weighted avg': {'precision': 0.39471594201732857, 'recall': 0.3801829541717736, 'f1-score': 0.36630199522126505, 'support': 66902}}
[[ 8751 11116  2635]
 [ 6793 12275  3260]
 [ 5980 11683  4409]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0939872
{'0': {'precision': 0.4025520420993806, 'recall': 0.38050798961130433, 'f1-score': 0.3912197329712605, 'support': 22717}, '1': {'precision': 0.3487910394690056, 'recall': 0.5370961854352984, 'f1-score': 0.42293043978154643, 'support': 21916}, '2': {'precision': 0.4076705761493023, 'recall': 0.21383986707979702, 'f1-score': 0.2805301914580265, 'support': 22269}, 'accuracy': 0.37632656721772145, 'macro avg': {'precision': 0.38633788590589613, 'recall': 0.3771480140421332, 'f1-score': 0.36489345473694446, 'support': 66902}, 'weighted avg': {'precision': 0.386644572982021, 'recall': 0.37632656721772145, 'f1-score': 0.3647635201599248, 'support': 66902}}
[[ 8644 10853  3220]
 [ 6446 11771  3699]
 [ 6383 11124  4762]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1071008
{'0': {'precision': 0.45709509658246655, 'recall': 0.36100924160187764, 'f1-score': 0.40340955659372174, 'support': 6817}, '1': {'precision': 0.27841059602649004, 'recall': 0.618599175985874, 'f1-score': 0.3839970770917062, 'support': 5097}, '2': {'precision': 0.5059125964010283, 'recall': 0.14599406528189912, 'f1-score': 0.22659758203799657, 'support': 6740}, 'accuracy': 0.3537042993459848, 'macro avg': {'precision': 0.4138060963366616, 'recall': 0.3752008276232169, 'f1-score': 0.33800140524114153, 'support': 18654}, 'weighted avg': {'precision': 0.42591009869693497, 'recall': 0.3537042993459848, 'f1-score': 0.3342202075786386, 'support': 18654}}
[[2461 3928  428]
 [1411 3153  533]
 [1512 4244  984]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.106518
{'0': {'precision': 0.43894899536321486, 'recall': 0.37945368171021376, 'f1-score': 0.4070387769726889, 'support': 6736}, '1': {'precision': 0.2814521579607995, 'recall': 0.5737059633930328, 'f1-score': 0.3776395906205467, 'support': 5081}, '2': {'precision': 0.49514955537590943, 'recall': 0.17917215152844815, 'f1-score': 0.26312963161851577, 'support': 6837}, 'accuracy': 0.358957864265037, 'macro avg': {'precision': 0.40518356956664126, 'recall': 0.37744393221056494, 'f1-score': 0.3492693330705838, 'support': 18654}, 'weighted avg': {'precision': 0.4166482447448553, 'recall': 0.358957864265037, 'f1-score': 0.3462859039887865, 'support': 18654}}
[[2556 3585  595]
 [1512 2915  654]
 [1755 3857 1225]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.102031
{'0': {'precision': 0.41898148148148145, 'recall': 0.3883524904214559, 'f1-score': 0.40308597788912753, 'support': 6525}, '1': {'precision': 0.30396111283483296, 'recall': 0.5306970025279885, 'f1-score': 0.38653251791937926, 'support': 5538}, '2': {'precision': 0.4572693224378618, 'recall': 0.2037627067212866, 'f1-score': 0.28190596137699414, 'support': 6591}, 'accuracy': 0.3653908009006111, 'macro avg': {'precision': 0.393403972251392, 'recall': 0.374270733223577, 'f1-score': 0.3571748190618336, 'support': 18654}, 'weighted avg': {'precision': 0.39836243774707397, 'recall': 0.3653908009006111, 'f1-score': 0.3553551667953172, 'support': 18654}}
[[2534 3247  744]
 [1749 2939  850]
 [1765 3483 1343]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.100358
{'0': {'precision': 0.4054460407617775, 'recall': 0.37921875, 'f1-score': 0.39189407395446474, 'support': 6400}, '1': {'precision': 0.3338647959183674, 'recall': 0.5291442048517521, 'f1-score': 0.40941084462982275, 'support': 5936}, '2': {'precision': 0.42024539877300615, 'recall': 0.21684077239632796, 'f1-score': 0.2860722489037377, 'support': 6318}, 'accuracy': 0.37193095314677815, 'macro avg': {'precision': 0.38651874515105034, 'recall': 0.37506790908269333, 'f1-score': 0.36245905582934174, 'support': 18654}, 'weighted avg': {'precision': 0.3876802036504051, 'recall': 0.37193095314677815, 'f1-score': 0.3616269602018343, 'support': 18654}}
[[2427 3077  896]
 [1801 3141  994]
 [1758 3190 1370]]
training model: results/XRAY/W9/deepOF_L1/seq2seq
Epoch 1/50
262/262 - 13s - loss: 13.2378 - accuracy10: 0.3681 - accuracy20: 0.3693 - accuracy30: 0.3666 - accuracy50: 0.3690 - val_loss: 13.1844 - val_accuracy10: 0.3670 - val_accuracy20: 0.3706 - val_accuracy30: 0.3772 - val_accuracy50: 0.3722 - 13s/epoch - 51ms/step
Epoch 2/50
262/262 - 7s - loss: 13.0849 - accuracy10: 0.3898 - accuracy20: 0.3892 - accuracy30: 0.3874 - accuracy50: 0.3841 - val_loss: 13.0950 - val_accuracy10: 0.3813 - val_accuracy20: 0.3875 - val_accuracy30: 0.3932 - val_accuracy50: 0.3881 - 7s/epoch - 25ms/step
Epoch 3/50
262/262 - 7s - loss: 13.0417 - accuracy10: 0.3918 - accuracy20: 0.3921 - accuracy30: 0.3877 - accuracy50: 0.3870 - val_loss: 13.0143 - val_accuracy10: 0.4050 - val_accuracy20: 0.4184 - val_accuracy30: 0.4066 - val_accuracy50: 0.3914 - 7s/epoch - 25ms/step
Epoch 4/50
262/262 - 7s - loss: 12.9981 - accuracy10: 0.3987 - accuracy20: 0.3966 - accuracy30: 0.3933 - accuracy50: 0.3898 - val_loss: 12.9960 - val_accuracy10: 0.4106 - val_accuracy20: 0.4223 - val_accuracy30: 0.4119 - val_accuracy50: 0.3938 - 7s/epoch - 25ms/step
Epoch 5/50
262/262 - 7s - loss: 12.9712 - accuracy10: 0.4002 - accuracy20: 0.3989 - accuracy30: 0.3961 - accuracy50: 0.3927 - val_loss: 13.0052 - val_accuracy10: 0.4005 - val_accuracy20: 0.4171 - val_accuracy30: 0.4126 - val_accuracy50: 0.3937 - 7s/epoch - 25ms/step
Epoch 6/50
262/262 - 7s - loss: 12.9544 - accuracy10: 0.4035 - accuracy20: 0.4032 - accuracy30: 0.3991 - accuracy50: 0.3948 - val_loss: 12.9962 - val_accuracy10: 0.4033 - val_accuracy20: 0.4177 - val_accuracy30: 0.4127 - val_accuracy50: 0.3950 - 7s/epoch - 25ms/step
Epoch 7/50
262/262 - 7s - loss: 12.9312 - accuracy10: 0.4038 - accuracy20: 0.4047 - accuracy30: 0.4014 - accuracy50: 0.3968 - val_loss: 13.0130 - val_accuracy10: 0.3981 - val_accuracy20: 0.4102 - val_accuracy30: 0.4107 - val_accuracy50: 0.3948 - 7s/epoch - 25ms/step
Epoch 8/50
262/262 - 7s - loss: 12.9162 - accuracy10: 0.4063 - accuracy20: 0.4057 - accuracy30: 0.4013 - accuracy50: 0.3999 - val_loss: 13.0020 - val_accuracy10: 0.4029 - val_accuracy20: 0.4133 - val_accuracy30: 0.4120 - val_accuracy50: 0.3930 - 7s/epoch - 25ms/step
Epoch 9/50
262/262 - 7s - loss: 12.8907 - accuracy10: 0.4074 - accuracy20: 0.4090 - accuracy30: 0.4043 - accuracy50: 0.4013 - val_loss: 13.0089 - val_accuracy10: 0.3998 - val_accuracy20: 0.4113 - val_accuracy30: 0.4072 - val_accuracy50: 0.3940 - 7s/epoch - 25ms/step
Epoch 10/50
262/262 - 6s - loss: 12.8711 - accuracy10: 0.4111 - accuracy20: 0.4115 - accuracy30: 0.4062 - accuracy50: 0.4023 - val_loss: 13.0082 - val_accuracy10: 0.4003 - val_accuracy20: 0.4124 - val_accuracy30: 0.4094 - val_accuracy50: 0.3971 - 6s/epoch - 25ms/step
Epoch 11/50
262/262 - 7s - loss: 12.8538 - accuracy10: 0.4101 - accuracy20: 0.4129 - accuracy30: 0.4077 - accuracy50: 0.4025 - val_loss: 13.0236 - val_accuracy10: 0.3956 - val_accuracy20: 0.4050 - val_accuracy30: 0.4058 - val_accuracy50: 0.3909 - 7s/epoch - 25ms/step
Epoch 12/50
262/262 - 7s - loss: 12.8386 - accuracy10: 0.4127 - accuracy20: 0.4151 - accuracy30: 0.4114 - accuracy50: 0.4068 - val_loss: 13.0049 - val_accuracy10: 0.4022 - val_accuracy20: 0.4122 - val_accuracy30: 0.4110 - val_accuracy50: 0.3932 - 7s/epoch - 25ms/step
Epoch 13/50
262/262 - 7s - loss: 12.8183 - accuracy10: 0.4171 - accuracy20: 0.4181 - accuracy30: 0.4129 - accuracy50: 0.4096 - val_loss: 13.0247 - val_accuracy10: 0.4016 - val_accuracy20: 0.4110 - val_accuracy30: 0.4063 - val_accuracy50: 0.3889 - 7s/epoch - 25ms/step
Epoch 14/50
262/262 - 7s - loss: 12.8045 - accuracy10: 0.4173 - accuracy20: 0.4186 - accuracy30: 0.4138 - accuracy50: 0.4100 - val_loss: 13.0287 - val_accuracy10: 0.3975 - val_accuracy20: 0.4102 - val_accuracy30: 0.4028 - val_accuracy50: 0.3866 - 7s/epoch - 25ms/step
testing model: results/XRAY/W9/deepOF_L1/seq2seq
Evaluating performance on  test set...
508/508 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.074988
{'0': {'precision': 0.3950554169563617, 'recall': 0.5064621837724472, 'f1-score': 0.4438751479086011, 'support': 38145}, '1': {'precision': 0.4869329161682157, 'recall': 0.20214310272376515, 'f1-score': 0.2856872907893316, 'support': 52354}, '2': {'precision': 0.3641061145916007, 'recall': 0.5478707185689603, 'f1-score': 0.437474004565052, 'support': 39356}, 'accuracy': 0.39631897116014014, 'macro avg': {'precision': 0.4153648159053927, 'recall': 0.4188253350217242, 'f1-score': 0.38901214775432824, 'support': 129855}, 'weighted avg': {'precision': 0.4227179162815311, 'recall': 0.39631897116014014, 'f1-score': 0.378158075257945, 'support': 129855}}
[[19319  5531 13295]
 [17409 10583 24362]
 [12174  5620 21562]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0773062
{'0': {'precision': 0.40174065676881443, 'recall': 0.5559997975606052, 'f1-score': 0.46644729858826023, 'support': 39518}, '1': {'precision': 0.44951284322409213, 'recall': 0.08117727036429799, 'f1-score': 0.13751989973918638, 'support': 50014}, '2': {'precision': 0.3662578820825332, 'recall': 0.600674552984649, 'f1-score': 0.4550510079470945, 'support': 40323}, 'accuracy': 0.38699318470601823, 'macro avg': {'precision': 0.40583712735847993, 'recall': 0.41261720696985077, 'f1-score': 0.35300606875818036, 'support': 129855}, 'weighted avg': {'precision': 0.4091220145116764, 'recall': 0.38699318470601823, 'f1-score': 0.3362212190875763, 'support': 129855}}
[[21972  2474 15072]
 [19116  4060 26838]
 [13604  2498 24221]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0805959
{'0': {'precision': 0.40235257323557005, 'recall': 0.5817757009345794, 'f1-score': 0.47570821093284577, 'support': 39804}, '1': {'precision': 0.498138495904691, 'recall': 0.02712950384233257, 'f1-score': 0.0514565907124315, 'support': 49319}, '2': {'precision': 0.36464842347195286, 'recall': 0.6232200726701365, 'f1-score': 0.4600940668980579, 'support': 40732}, 'accuracy': 0.38412075006738283, 'macro avg': {'precision': 0.4217131642040713, 'recall': 0.4107084258156828, 'f1-score': 0.329086289514445, 'support': 129855}, 'weighted avg': {'precision': 0.4269053474217525, 'recall': 0.38412075006738283, 'f1-score': 0.30967947909752486, 'support': 129855}}
[[23157   652 15995]
 [19746  1338 28235]
 [14651   696 25385]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0812392
{'0': {'precision': 0.4233321629213483, 'recall': 0.560142166883479, 'f1-score': 0.4822214222862171, 'support': 43048}, '1': {'precision': 0.42173211403980637, 'recall': 0.03760732959178779, 'f1-score': 0.06905663701224345, 'support': 41694}, '2': {'precision': 0.3955216329126733, 'recall': 0.6064992352536963, 'f1-score': 0.4787995450170619, 'support': 45113}, 'accuracy': 0.40847098686997035, 'macro avg': {'precision': 0.41352863662460937, 'recall': 0.4014162439096543, 'f1-score': 0.34335920143850746, 'support': 129855}, 'weighted avg': {'precision': 0.41315674512189227, 'recall': 0.40847098686997035, 'f1-score': 0.3483731784260927, 'support': 129855}}
[[24113  1041 17894]
 [16204  1568 23922]
 [16643  1109 27361]]
Evaluating performance on  train set...
262/262 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0749589
{'0': {'precision': 0.4182751770923129, 'recall': 0.5011000853127385, 'f1-score': 0.45595685569537503, 'support': 22271}, '1': {'precision': 0.41170527531211665, 'recall': 0.2479464557347125, 'f1-score': 0.3094992676178593, 'support': 23009}, '2': {'precision': 0.4062357760582613, 'recall': 0.49532883174544445, 'f1-score': 0.4463801942233151, 'support': 21622}, 'accuracy': 0.41217003975964844, 'macro avg': {'precision': 0.41207207615423025, 'recall': 0.41479179093096513, 'f1-score': 0.4039454391788498, 'support': 66902}, 'weighted avg': {'precision': 0.41212464647710256, 'recall': 0.41217003975964844, 'f1-score': 0.40249194854126247, 'support': 66902}}
[[11160  4184  6927]
 [ 8577  5705  8727]
 [ 6944  3968 10710]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.075073
{'0': {'precision': 0.41956990652983855, 'recall': 0.5625520354059858, 'f1-score': 0.48065295119713963, 'support': 22821}, '1': {'precision': 0.39112367021276595, 'recall': 0.1085382167074127, 'f1-score': 0.16992236865860263, 'support': 21679}, '2': {'precision': 0.41316693079767564, 'recall': 0.5586108383180073, 'f1-score': 0.475004744733346, 'support': 22402}, 'accuracy': 0.41411318047293055, 'macro avg': {'precision': 0.4079535025134267, 'recall': 0.40990036347713527, 'f1-score': 0.37519335486302935, 'support': 66902}, 'weighted avg': {'precision': 0.4082081323008211, 'recall': 0.41411318047293055, 'f1-score': 0.3780721700537531, 'support': 66902}}
[[12838  1893  8090]
 [ 9642  2353  9684]
 [ 8118  1770 12514]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.077336
{'0': {'precision': 0.40725905088062625, 'recall': 0.5926931292274831, 'f1-score': 0.4827823691460056, 'support': 22472}, '1': {'precision': 0.4894772572980312, 'recall': 0.03225806451612903, 'f1-score': 0.06052719946272666, 'support': 22351}, '2': {'precision': 0.40103896103896103, 'recall': 0.5944109787580959, 'f1-score': 0.47894314283628936, 'support': 22079}, 'accuracy': 0.40602672565842574, 'macro avg': {'precision': 0.43259175640587283, 'recall': 0.4064540575005693, 'f1-score': 0.34075090381500717, 'support': 66902}, 'weighted avg': {'precision': 0.4326742218474328, 'recall': 0.40602672565842574, 'f1-score': 0.34044594310069765, 'support': 66902}}
[[13319   377  8776]
 [10805   721 10825]
 [ 8580   375 13124]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.081798
{'0': {'precision': 0.4002689239984109, 'recall': 0.5782015627069262, 'f1-score': 0.47305691996532795, 'support': 22653}, '1': {'precision': 0.4288277511961722, 'recall': 0.03265919650177644, 'f1-score': 0.060695843562177255, 'support': 21954}, '2': {'precision': 0.3990832743716738, 'recall': 0.5818793451446512, 'f1-score': 0.4734498740921864, 'support': 22295}, 'accuracy': 0.40040656482616366, 'macro avg': {'precision': 0.4093933165220857, 'recall': 0.3975800347844513, 'f1-score': 0.3357342125398972, 'support': 66902}, 'weighted avg': {'precision': 0.40924543342819697, 'recall': 0.40040656482616366, 'f1-score': 0.3378709141793057, 'support': 66902}}
[[13098   498  9057]
 [10760   717 10477]
 [ 8865   457 12973]]
Evaluating performance on  val set...
73/73 - 1s - 969ms/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0831836
{'0': {'precision': 0.44, 'recall': 0.5022019964768056, 'f1-score': 0.469047782271886, 'support': 6812}, '1': {'precision': 0.28327228327228327, 'recall': 0.18300138039834352, 'f1-score': 0.22235533724691503, 'support': 5071}, '2': {'precision': 0.430939226519337, 'recall': 0.48389955686853764, 'f1-score': 0.4558864458669636, 'support': 6770}, 'accuracy': 0.4087814292607087, 'macro avg': {'precision': 0.38473716993054013, 'recall': 0.3897009779145622, 'f1-score': 0.38242985512858824, 'support': 18653}, 'weighted avg': {'precision': 0.3941034853379971, 'recall': 0.4087814292607087, 'f1-score': 0.39720520273063514, 'support': 18653}}
[[3421 1196 2195]
 [2012  928 2131]
 [2342 1152 3276]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0804121
{'0': {'precision': 0.43495279760534195, 'recall': 0.5625372245384157, 'f1-score': 0.4905856382288014, 'support': 6716}, '1': {'precision': 0.2765451664025357, 'recall': 0.06861974046401888, 'f1-score': 0.1099558916194077, 'support': 5086}, '2': {'precision': 0.431476163124641, 'recall': 0.5482411326813604, 'f1-score': 0.48290048855746975, 'support': 6851}, 'accuracy': 0.4226129845065137, 'macro avg': {'precision': 0.38099137571083946, 'recall': 0.39313269922793165, 'f1-score': 0.3611473394685596, 'support': 18653}, 'weighted avg': {'precision': 0.3904838309444962, 'recall': 0.4226129845065137, 'f1-score': 0.38397898773538647, 'support': 18653}}
[[3778  457 2481]
 [2269  349 2468]
 [2639  456 3756]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0809871
{'0': {'precision': 0.4135214965539875, 'recall': 0.5842349304482226, 'f1-score': 0.4842739094228429, 'support': 6470}, '1': {'precision': 0.2916666666666667, 'recall': 0.01378692927484333, 'f1-score': 0.026329287057616686, 'support': 5585}, '2': {'precision': 0.4186851211072664, 'recall': 0.5868444983328281, 'f1-score': 0.4887037738230469, 'support': 6598}, 'accuracy': 0.41435693990242856, 'macro avg': {'precision': 0.3746244281093069, 'recall': 0.3949554526852981, 'f1-score': 0.33310232343450213, 'support': 18653}, 'weighted avg': {'precision': 0.3788627483570137, 'recall': 0.41435693990242856, 'f1-score': 0.3487250716703504, 'support': 18653}}
[[3780   95 2595]
 [2727   77 2781]
 [2634   92 3872]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0868738
{'0': {'precision': 0.3976408334252012, 'recall': 0.564122614951517, 'f1-score': 0.46647268024571614, 'support': 6394}, '1': {'precision': 0.32587064676616917, 'recall': 0.022117170352861724, 'f1-score': 0.04142292490118577, 'support': 5923}, '2': {'precision': 0.3959694989106754, 'recall': 0.5737058080808081, 'f1-score': 0.46854859499871104, 'support': 6336}, 'accuracy': 0.3952715380903876, 'macro avg': {'precision': 0.3731603263673486, 'recall': 0.3866485311283956, 'f1-score': 0.32548140004853765, 'support': 18653}, 'weighted avg': {'precision': 0.3742834972827318, 'recall': 0.3952715380903876, 'f1-score': 0.33220919957072137, 'support': 18653}}
[[3607  138 2649]
 [2896  131 2896]
 [2568  133 3635]]
training model: results/XRAY/W9/deepLOB_L2/seq2seq
Epoch 1/50
262/262 - 20s - loss: 13.1622 - accuracy10: 0.3777 - accuracy20: 0.3731 - accuracy30: 0.3699 - accuracy50: 0.3712 - val_loss: 13.5950 - val_accuracy10: 0.3405 - val_accuracy20: 0.3384 - val_accuracy30: 0.3450 - val_accuracy50: 0.3444 - 20s/epoch - 76ms/step
Epoch 2/50
262/262 - 13s - loss: 12.9491 - accuracy10: 0.4032 - accuracy20: 0.4035 - accuracy30: 0.3966 - accuracy50: 0.4003 - val_loss: 13.4450 - val_accuracy10: 0.3617 - val_accuracy20: 0.3571 - val_accuracy30: 0.3613 - val_accuracy50: 0.3794 - 13s/epoch - 51ms/step
Epoch 3/50
262/262 - 13s - loss: 12.7810 - accuracy10: 0.4316 - accuracy20: 0.4280 - accuracy30: 0.4175 - accuracy50: 0.4148 - val_loss: 13.3219 - val_accuracy10: 0.4047 - val_accuracy20: 0.3934 - val_accuracy30: 0.3831 - val_accuracy50: 0.3818 - 13s/epoch - 51ms/step
Epoch 4/50
262/262 - 13s - loss: 12.6289 - accuracy10: 0.4521 - accuracy20: 0.4486 - accuracy30: 0.4354 - accuracy50: 0.4273 - val_loss: 13.4616 - val_accuracy10: 0.3962 - val_accuracy20: 0.3913 - val_accuracy30: 0.3786 - val_accuracy50: 0.3881 - 13s/epoch - 50ms/step
Epoch 5/50
262/262 - 13s - loss: 12.5610 - accuracy10: 0.4595 - accuracy20: 0.4532 - accuracy30: 0.4394 - accuracy50: 0.4311 - val_loss: 12.9776 - val_accuracy10: 0.4331 - val_accuracy20: 0.4178 - val_accuracy30: 0.3989 - val_accuracy50: 0.3954 - 13s/epoch - 51ms/step
Epoch 6/50
262/262 - 13s - loss: 12.4925 - accuracy10: 0.4700 - accuracy20: 0.4613 - accuracy30: 0.4467 - accuracy50: 0.4386 - val_loss: 13.0408 - val_accuracy10: 0.4264 - val_accuracy20: 0.4176 - val_accuracy30: 0.3967 - val_accuracy50: 0.3987 - 13s/epoch - 51ms/step
Epoch 7/50
262/262 - 13s - loss: 12.4465 - accuracy10: 0.4751 - accuracy20: 0.4699 - accuracy30: 0.4512 - accuracy50: 0.4425 - val_loss: 13.2386 - val_accuracy10: 0.4216 - val_accuracy20: 0.4088 - val_accuracy30: 0.3932 - val_accuracy50: 0.3922 - 13s/epoch - 51ms/step
Epoch 8/50
262/262 - 13s - loss: 12.3977 - accuracy10: 0.4783 - accuracy20: 0.4704 - accuracy30: 0.4538 - accuracy50: 0.4436 - val_loss: 13.2593 - val_accuracy10: 0.4192 - val_accuracy20: 0.4053 - val_accuracy30: 0.3865 - val_accuracy50: 0.3898 - 13s/epoch - 50ms/step
Epoch 9/50
262/262 - 13s - loss: 12.3378 - accuracy10: 0.4829 - accuracy20: 0.4762 - accuracy30: 0.4595 - accuracy50: 0.4492 - val_loss: 13.6504 - val_accuracy10: 0.4053 - val_accuracy20: 0.3906 - val_accuracy30: 0.3788 - val_accuracy50: 0.3873 - 13s/epoch - 51ms/step
Epoch 10/50
262/262 - 13s - loss: 12.2882 - accuracy10: 0.4869 - accuracy20: 0.4821 - accuracy30: 0.4631 - accuracy50: 0.4512 - val_loss: 13.1821 - val_accuracy10: 0.4246 - val_accuracy20: 0.4146 - val_accuracy30: 0.3937 - val_accuracy50: 0.3913 - 13s/epoch - 51ms/step
Epoch 11/50
262/262 - 13s - loss: 12.2513 - accuracy10: 0.4894 - accuracy20: 0.4832 - accuracy30: 0.4664 - accuracy50: 0.4530 - val_loss: 13.4737 - val_accuracy10: 0.4177 - val_accuracy20: 0.4081 - val_accuracy30: 0.3922 - val_accuracy50: 0.3968 - 13s/epoch - 51ms/step
Epoch 12/50
262/262 - 13s - loss: 12.1982 - accuracy10: 0.4929 - accuracy20: 0.4870 - accuracy30: 0.4703 - accuracy50: 0.4580 - val_loss: 14.0631 - val_accuracy10: 0.3853 - val_accuracy20: 0.3788 - val_accuracy30: 0.3736 - val_accuracy50: 0.3860 - 13s/epoch - 51ms/step
Epoch 13/50
262/262 - 13s - loss: 12.1693 - accuracy10: 0.4957 - accuracy20: 0.4913 - accuracy30: 0.4727 - accuracy50: 0.4593 - val_loss: 13.2084 - val_accuracy10: 0.4171 - val_accuracy20: 0.4075 - val_accuracy30: 0.3938 - val_accuracy50: 0.3924 - 13s/epoch - 50ms/step
Epoch 14/50
262/262 - 13s - loss: 12.1277 - accuracy10: 0.4964 - accuracy20: 0.4925 - accuracy30: 0.4758 - accuracy50: 0.4639 - val_loss: 13.4304 - val_accuracy10: 0.4053 - val_accuracy20: 0.3965 - val_accuracy30: 0.3833 - val_accuracy50: 0.3877 - 13s/epoch - 51ms/step
Epoch 15/50
262/262 - 13s - loss: 12.1004 - accuracy10: 0.4989 - accuracy20: 0.4943 - accuracy30: 0.4768 - accuracy50: 0.4634 - val_loss: 14.1299 - val_accuracy10: 0.3679 - val_accuracy20: 0.3630 - val_accuracy30: 0.3605 - val_accuracy50: 0.3799 - 13s/epoch - 51ms/step
testing model: results/XRAY/W9/deepLOB_L2/seq2seq
Evaluating performance on  test set...
508/508 - 11s - 11s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.023384
{'0': {'precision': 0.4137392661982826, 'recall': 0.597425747765224, 'f1-score': 0.4888984232543173, 'support': 38147}, '1': {'precision': 0.5525770875534549, 'recall': 0.4689422011689651, 'f1-score': 0.5073359232931064, 'support': 52354}, '2': {'precision': 0.42344954854017003, 'recall': 0.3264901671832918, 'f1-score': 0.36870193963043724, 'support': 39358}, 'accuracy': 0.4635104228432377, 'macro avg': {'precision': 0.4632553007639692, 'recall': 0.46428603870582696, 'f1-score': 0.45497876205928695, 'support': 129859}, 'weighted avg': {'precision': 0.472656188334143, 'recall': 0.4635104228432377, 'f1-score': 0.45990223257490415, 'support': 129859}}
[[22790  9549  5808]
 [16115 24551 11688]
 [16178 10330 12850]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0361279
{'0': {'precision': 0.41288269227291635, 'recall': 0.5777327935222673, 'f1-score': 0.4815912422615721, 'support': 39520}, '1': {'precision': 0.5196992617010228, 'recall': 0.460231135282121, 'f1-score': 0.4881607549970839, 'support': 50014}, '2': {'precision': 0.4260794872641977, 'recall': 0.3198264104153751, 'f1-score': 0.365385160211916, 'support': 40325}, 'accuracy': 0.45239066988040877, 'macro avg': {'precision': 0.45288714707937894, 'recall': 0.45259677973992113, 'f1-score': 0.4450457191568573, 'support': 129859}, 'weighted avg': {'precision': 0.4581201010116309, 'recall': 0.45239066988040877, 'f1-score': 0.4480360581873185, 'support': 129859}}
[[22832 10478  6210]
 [15834 23018 11162]
 [16633 10795 12897]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0487158
{'0': {'precision': 0.4028119507908612, 'recall': 0.5469892230009797, 'f1-score': 0.46395772517099576, 'support': 39807}, '1': {'precision': 0.4952502699962531, 'recall': 0.4556053447961232, 'f1-score': 0.47460133065793636, 'support': 49319}, '2': {'precision': 0.41803305622186443, 'recall': 0.3123266147840817, 'f1-score': 0.35753028131411063, 'support': 40733}, 'accuracy': 0.43867579451558997, 'macro avg': {'precision': 0.43869842566965955, 'recall': 0.4383070608603949, 'f1-score': 0.43202977904768086, 'support': 129859}, 'weighted avg': {'precision': 0.44269341262571116, 'recall': 0.43867579451558997, 'f1-score': 0.434616847052328, 'support': 129859}}
[[21774 11463  6570]
 [15708 22470 11141]
 [16573 11438 12722]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0652583
{'0': {'precision': 0.41860376640669583, 'recall': 0.5111611809249494, 'f1-score': 0.46027546250300666, 'support': 43051}, '1': {'precision': 0.4191212698956749, 'recall': 0.4692521705761021, 'f1-score': 0.4427722772277228, 'support': 41694}, '2': {'precision': 0.4335141139571354, 'recall': 0.2941215587179146, 'f1-score': 0.3504661789176198, 'support': 45114}, 'accuracy': 0.4223041914692089, 'macro avg': {'precision': 0.4237463834198354, 'recall': 0.42484497007298877, 'f1-score': 0.41783797288278307, 'support': 129859}, 'weighted avg': {'precision': 0.4239498895853745, 'recall': 0.4223041914692089, 'f1-score': 0.41650711509128446, 'support': 129859}}
[[22006 13368  7677]
 [12467 19565  9662]
 [18097 13748 13269]]
Evaluating performance on  train set...
262/262 - 5s - 5s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0635488
{'0': {'precision': 0.4086466390837681, 'recall': 0.6116770632320603, 'f1-score': 0.4899617161241619, 'support': 22283}, '1': {'precision': 0.4447436103520334, 'recall': 0.48182332709303843, 'f1-score': 0.46254153344617893, 'support': 22969}, '2': {'precision': 0.4938827331486611, 'recall': 0.19764434180138568, 'f1-score': 0.2823118031272679, 'support': 21650}, 'accuracy': 0.4331111177543272, 'macro avg': {'precision': 0.44909099419482085, 'recall': 0.4303815773754948, 'f1-score': 0.4116050175658696, 'support': 66902}, 'weighted avg': {'precision': 0.44862261543074905, 'recall': 0.4331111177543272, 'f1-score': 0.41335063136864864, 'support': 66902}}
[[13630  6755  1898]
 [ 9415 11067  2487]
 [10309  7062  4279]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0720086
{'0': {'precision': 0.4087647973215353, 'recall': 0.5988962859145059, 'f1-score': 0.48589297135953374, 'support': 22832}, '1': {'precision': 0.4176924008232778, 'recall': 0.47691457008570637, 'f1-score': 0.4453432585357458, 'support': 21702}, '2': {'precision': 0.4992503748125937, 'recall': 0.19353540772532188, 'f1-score': 0.27893939882083835, 'support': 22368}, 'accuracy': 0.4237989895668291, 'macro avg': {'precision': 0.4419025243191356, 'recall': 0.4231154212418447, 'f1-score': 0.4033918762387059, 'support': 66902}, 'weighted avg': {'precision': 0.4419137054037273, 'recall': 0.4237989895668291, 'f1-score': 0.4035464439276575, 'support': 66902}}
[[13674  7146  2012]
 [ 9022 10350  2330]
 [10756  7283  4329]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0773829
{'0': {'precision': 0.3981057134127712, 'recall': 0.5790596391431873, 'f1-score': 0.4718279258400927, 'support': 22502}, '1': {'precision': 0.4157608695652174, 'recall': 0.4728144034396274, 'f1-score': 0.4424559932942162, 'support': 22328}, '2': {'precision': 0.4722095671981777, 'recall': 0.18783979702790865, 'f1-score': 0.26876701672500974, 'support': 22072}, 'accuracy': 0.414531703088099, 'macro avg': {'precision': 0.4286920500587221, 'recall': 0.41323794653690776, 'f1-score': 0.3943503119531062, 'support': 66902}, 'weighted avg': {'precision': 0.4284459810777635, 'recall': 0.414531703088099, 'f1-score': 0.39503236074678544, 'support': 66902}}
[[13030  7396  2076]
 [ 9213 10557  2558]
 [10487  7439  4146]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0730156
{'0': {'precision': 0.3995352780481678, 'recall': 0.5601091693445437, 'f1-score': 0.46638809471446374, 'support': 22717}, '1': {'precision': 0.4259983137886104, 'recall': 0.5072093447709436, 'f1-score': 0.4630701937096438, 'support': 21916}, '2': {'precision': 0.4573150318044861, 'recall': 0.18402263235888455, 'f1-score': 0.2624399615754083, 'support': 22269}, 'accuracy': 0.4175958865205823, 'macro avg': {'precision': 0.4276162078804215, 'recall': 0.41711371549145726, 'f1-score': 0.3972994166665053, 'support': 66902}, 'weighted avg': {'precision': 0.4274367044283507, 'recall': 0.4175958865205823, 'f1-score': 0.3974150282097963, 'support': 66902}}
[[12724  7566  2427]
 [ 8364 11116  2436]
 [10759  7412  4098]]
Evaluating performance on  val set...
73/73 - 2s - 2s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0696967
{'0': {'precision': 0.42904636920384953, 'recall': 0.7193780255244242, 'f1-score': 0.53751301583822, 'support': 6817}, '1': {'precision': 0.39402407566638004, 'recall': 0.3596233078281342, 'f1-score': 0.3760385680582624, 'support': 5097}, '2': {'precision': 0.526438569206843, 'recall': 0.20089020771513352, 'f1-score': 0.290807560137457, 'support': 6740}, 'accuracy': 0.43374075265358636, 'macro avg': {'precision': 0.44983633802569084, 'recall': 0.4266305136892306, 'f1-score': 0.40145304801131315, 'support': 18654}, 'weighted avg': {'precision': 0.45466633263580486, 'recall': 0.43374075265358636, 'f1-score': 0.4042531234956883, 'support': 18654}}
[[4904 1322  591]
 [2637 1833  627]
 [3889 1497 1354]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.078999
{'0': {'precision': 0.4173304157549234, 'recall': 0.7078384798099763, 'f1-score': 0.5250812179946038, 'support': 6736}, '1': {'precision': 0.3831294269156471, 'recall': 0.35130879748081084, 'f1-score': 0.36652977412731, 'support': 5081}, '2': {'precision': 0.5081712062256809, 'recall': 0.19101945297645165, 'f1-score': 0.27766556819389815, 'support': 6837}, 'accuracy': 0.4213037418248097, 'macro avg': {'precision': 0.43621034963208377, 'recall': 0.41672224342241293, 'f1-score': 0.389758853438604, 'support': 18654}, 'weighted avg': {'precision': 0.44130936183384517, 'recall': 0.4213037418248097, 'f1-score': 0.39121284209789836, 'support': 18654}}
[[4768 1369  599]
 [2631 1785  665]
 [4026 1505 1306]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0878067
{'0': {'precision': 0.3955974842767296, 'recall': 0.6747892720306513, 'f1-score': 0.49878221467006517, 'support': 6525}, '1': {'precision': 0.3756334887492398, 'recall': 0.33459732755507404, 'f1-score': 0.35392990163308186, 'support': 5538}, '2': {'precision': 0.46777306059436513, 'recall': 0.1838871187983614, 'f1-score': 0.2639947723807449, 'support': 6591}, 'accuracy': 0.4003430899538973, 'macro avg': {'precision': 0.4130013445401115, 'recall': 0.39775790612802897, 'f1-score': 0.37223562956129735, 'support': 18654}, 'weighted avg': {'precision': 0.41517230020244517, 'recall': 0.4003430899538973, 'f1-score': 0.3728212335546088, 'support': 18654}}
[[4403 1484  638]
 [2944 1853  741]
 [3783 1596 1212]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0911365
{'0': {'precision': 0.37716037911168926, 'recall': 0.63421875, 'f1-score': 0.473021792331896, 'support': 6400}, '1': {'precision': 0.3938643292682927, 'recall': 0.3482142857142857, 'f1-score': 0.3696351931330472, 'support': 5936}, '2': {'precision': 0.44402420574886536, 'recall': 0.18581829692940804, 'f1-score': 0.26199509038161123, 'support': 6318}, 'accuracy': 0.3913369786640935, 'macro avg': {'precision': 0.40501630470961575, 'recall': 0.38941711088123127, 'f1-score': 0.3682173586155182, 'support': 18654}, 'weighted avg': {'precision': 0.4051222266952251, 'recall': 0.3913369786640935, 'f1-score': 0.36864902746826, 'support': 18654}}
[[4059 1611  730]
 [3129 2067  740]
 [3574 1570 1174]]
training model: results/XRAY/W9/deepOF_L2/seq2seq
Epoch 1/50
262/262 - 15s - loss: 13.2073 - accuracy10: 0.3864 - accuracy20: 0.3729 - accuracy30: 0.3638 - accuracy50: 0.3615 - val_loss: 13.0373 - val_accuracy10: 0.3974 - val_accuracy20: 0.3824 - val_accuracy30: 0.3797 - val_accuracy50: 0.3669 - 15s/epoch - 56ms/step
Epoch 2/50
262/262 - 9s - loss: 12.8798 - accuracy10: 0.4323 - accuracy20: 0.4171 - accuracy30: 0.4037 - accuracy50: 0.3939 - val_loss: 12.8179 - val_accuracy10: 0.4401 - val_accuracy20: 0.4268 - val_accuracy30: 0.4125 - val_accuracy50: 0.3917 - 9s/epoch - 33ms/step
Epoch 3/50
262/262 - 9s - loss: 12.7334 - accuracy10: 0.4535 - accuracy20: 0.4351 - accuracy30: 0.4165 - accuracy50: 0.4025 - val_loss: 12.7683 - val_accuracy10: 0.4548 - val_accuracy20: 0.4357 - val_accuracy30: 0.4184 - val_accuracy50: 0.3966 - 9s/epoch - 32ms/step
Epoch 4/50
262/262 - 9s - loss: 12.6369 - accuracy10: 0.4688 - accuracy20: 0.4494 - accuracy30: 0.4286 - accuracy50: 0.4114 - val_loss: 12.7354 - val_accuracy10: 0.4584 - val_accuracy20: 0.4400 - val_accuracy30: 0.4206 - val_accuracy50: 0.3995 - 9s/epoch - 33ms/step
Epoch 5/50
262/262 - 9s - loss: 12.5330 - accuracy10: 0.4816 - accuracy20: 0.4621 - accuracy30: 0.4397 - accuracy50: 0.4228 - val_loss: 12.7215 - val_accuracy10: 0.4636 - val_accuracy20: 0.4473 - val_accuracy30: 0.4217 - val_accuracy50: 0.3958 - 9s/epoch - 33ms/step
Epoch 6/50
262/262 - 9s - loss: 12.4232 - accuracy10: 0.4918 - accuracy20: 0.4759 - accuracy30: 0.4513 - accuracy50: 0.4333 - val_loss: 12.6480 - val_accuracy10: 0.4771 - val_accuracy20: 0.4602 - val_accuracy30: 0.4310 - val_accuracy50: 0.4064 - 9s/epoch - 33ms/step
Epoch 7/50
262/262 - 9s - loss: 12.3483 - accuracy10: 0.4968 - accuracy20: 0.4804 - accuracy30: 0.4581 - accuracy50: 0.4405 - val_loss: 12.6275 - val_accuracy10: 0.4771 - val_accuracy20: 0.4630 - val_accuracy30: 0.4342 - val_accuracy50: 0.4085 - 9s/epoch - 33ms/step
Epoch 8/50
262/262 - 9s - loss: 12.2862 - accuracy10: 0.5011 - accuracy20: 0.4848 - accuracy30: 0.4623 - accuracy50: 0.4455 - val_loss: 12.6181 - val_accuracy10: 0.4770 - val_accuracy20: 0.4641 - val_accuracy30: 0.4385 - val_accuracy50: 0.4103 - 9s/epoch - 33ms/step
Epoch 9/50
262/262 - 9s - loss: 12.2328 - accuracy10: 0.5077 - accuracy20: 0.4922 - accuracy30: 0.4694 - accuracy50: 0.4488 - val_loss: 12.6220 - val_accuracy10: 0.4744 - val_accuracy20: 0.4592 - val_accuracy30: 0.4364 - val_accuracy50: 0.4103 - 9s/epoch - 33ms/step
Epoch 10/50
262/262 - 9s - loss: 12.1896 - accuracy10: 0.5090 - accuracy20: 0.4940 - accuracy30: 0.4719 - accuracy50: 0.4522 - val_loss: 12.6105 - val_accuracy10: 0.4773 - val_accuracy20: 0.4674 - val_accuracy30: 0.4433 - val_accuracy50: 0.4157 - 9s/epoch - 33ms/step
Epoch 11/50
262/262 - 9s - loss: 12.1441 - accuracy10: 0.5126 - accuracy20: 0.4993 - accuracy30: 0.4754 - accuracy50: 0.4557 - val_loss: 12.6452 - val_accuracy10: 0.4770 - val_accuracy20: 0.4613 - val_accuracy30: 0.4386 - val_accuracy50: 0.4129 - 9s/epoch - 33ms/step
Epoch 12/50
262/262 - 8s - loss: 12.1055 - accuracy10: 0.5169 - accuracy20: 0.5028 - accuracy30: 0.4783 - accuracy50: 0.4593 - val_loss: 12.6476 - val_accuracy10: 0.4762 - val_accuracy20: 0.4605 - val_accuracy30: 0.4371 - val_accuracy50: 0.4116 - 8s/epoch - 32ms/step
Epoch 13/50
262/262 - 8s - loss: 12.0536 - accuracy10: 0.5185 - accuracy20: 0.5056 - accuracy30: 0.4825 - accuracy50: 0.4610 - val_loss: 12.6805 - val_accuracy10: 0.4755 - val_accuracy20: 0.4614 - val_accuracy30: 0.4312 - val_accuracy50: 0.4084 - 8s/epoch - 32ms/step
Epoch 14/50
262/262 - 9s - loss: 12.0082 - accuracy10: 0.5237 - accuracy20: 0.5113 - accuracy30: 0.4893 - accuracy50: 0.4690 - val_loss: 12.7097 - val_accuracy10: 0.4764 - val_accuracy20: 0.4602 - val_accuracy30: 0.4356 - val_accuracy50: 0.4096 - 9s/epoch - 33ms/step
Epoch 15/50
262/262 - 8s - loss: 11.9685 - accuracy10: 0.5258 - accuracy20: 0.5137 - accuracy30: 0.4916 - accuracy50: 0.4688 - val_loss: 12.7457 - val_accuracy10: 0.4709 - val_accuracy20: 0.4572 - val_accuracy30: 0.4311 - val_accuracy50: 0.4092 - 8s/epoch - 32ms/step
Epoch 16/50
262/262 - 9s - loss: 11.9212 - accuracy10: 0.5254 - accuracy20: 0.5177 - accuracy30: 0.4967 - accuracy50: 0.4762 - val_loss: 12.7362 - val_accuracy10: 0.4723 - val_accuracy20: 0.4551 - val_accuracy30: 0.4285 - val_accuracy50: 0.4103 - 9s/epoch - 33ms/step
Epoch 17/50
262/262 - 9s - loss: 11.8703 - accuracy10: 0.5288 - accuracy20: 0.5207 - accuracy30: 0.5002 - accuracy50: 0.4793 - val_loss: 12.7904 - val_accuracy10: 0.4676 - val_accuracy20: 0.4538 - val_accuracy30: 0.4273 - val_accuracy50: 0.4075 - 9s/epoch - 33ms/step
Epoch 18/50
262/262 - 9s - loss: 11.8418 - accuracy10: 0.5323 - accuracy20: 0.5228 - accuracy30: 0.5029 - accuracy50: 0.4827 - val_loss: 12.7711 - val_accuracy10: 0.4724 - val_accuracy20: 0.4538 - val_accuracy30: 0.4313 - val_accuracy50: 0.4077 - 9s/epoch - 33ms/step
Epoch 19/50
262/262 - 9s - loss: 11.7942 - accuracy10: 0.5342 - accuracy20: 0.5276 - accuracy30: 0.5079 - accuracy50: 0.4871 - val_loss: 12.8141 - val_accuracy10: 0.4719 - val_accuracy20: 0.4564 - val_accuracy30: 0.4274 - val_accuracy50: 0.4065 - 9s/epoch - 33ms/step
Epoch 20/50
262/262 - 9s - loss: 11.7451 - accuracy10: 0.5366 - accuracy20: 0.5306 - accuracy30: 0.5116 - accuracy50: 0.4931 - val_loss: 12.8326 - val_accuracy10: 0.4654 - val_accuracy20: 0.4501 - val_accuracy30: 0.4285 - val_accuracy50: 0.4044 - 9s/epoch - 33ms/step
testing model: results/XRAY/W9/deepOF_L2/seq2seq
Evaluating performance on  test set...
508/508 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.95569026
{'0': {'precision': 0.48322517093521844, 'recall': 0.4372525888058723, 'f1-score': 0.45909084653390403, 'support': 38145}, '1': {'precision': 0.6191505230345566, 'recall': 0.6184054704511595, 'f1-score': 0.6187777724688232, 'support': 52354}, '2': {'precision': 0.47419160007433564, 'recall': 0.5186756784226039, 'f1-score': 0.49543711470316976, 'support': 39356}, 'accuracy': 0.5349659235300912, 'macro avg': {'precision': 0.5255224313480369, 'recall': 0.5247779125598785, 'f1-score': 0.5244352445686323, 'support': 129855}, 'weighted avg': {'precision': 0.5352887084887039, 'recall': 0.5349659235300912, 'f1-score': 0.5344879667870046, 'support': 129855}}
[[16679  9866 11600]
 [ 8943 32376 11035]
 [ 8894 10049 20413]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.99391854
{'0': {'precision': 0.4662852581160192, 'recall': 0.44341818917961434, 'f1-score': 0.45456432073464936, 'support': 39518}, '1': {'precision': 0.5807758382998579, 'recall': 0.5475066981245251, 'f1-score': 0.5636507724133671, 'support': 50014}, '2': {'precision': 0.46228338430173294, 'recall': 0.5173474195868363, 'f1-score': 0.48826785567999625, 'support': 40323}, 'accuracy': 0.5064649031612183, 'macro avg': {'precision': 0.50311482690587, 'recall': 0.5027574356303252, 'f1-score': 0.5021609829426709, 'support': 129855}, 'weighted avg': {'precision': 0.5091389358296309, 'recall': 0.5064649031612183, 'f1-score': 0.5070449909734588, 'support': 129855}}
[[17523 10142 11853]
 [10219 27383 12412]
 [ 9838  9624 20861]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0249904
{'0': {'precision': 0.44330347951410337, 'recall': 0.43274545271831977, 'f1-score': 0.43796084413933384, 'support': 39804}, '1': {'precision': 0.5396452328159645, 'recall': 0.49348121413653967, 'f1-score': 0.5155318315169617, 'support': 49319}, '2': {'precision': 0.4409464258480577, 'recall': 0.496882058332515, 'f1-score': 0.4672461359097783, 'support': 40732}, 'accuracy': 0.47593084594355245, 'macro avg': {'precision': 0.47463171272604193, 'recall': 0.47436957506245814, 'f1-score': 0.47357960385535797, 'support': 129855}, 'weighted avg': {'precision': 0.4791547861343268, 'recall': 0.47593084594355245, 'f1-score': 0.4766083512116142, 'support': 129855}}
[[17225 10798 11781]
 [11102 24338 13879]
 [10529  9964 20239]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0532118
{'0': {'precision': 0.4430167304767399, 'recall': 0.39244564207396393, 'f1-score': 0.4162006356088788, 'support': 43048}, '1': {'precision': 0.4424359985505084, 'recall': 0.49781743176476234, 'f1-score': 0.4684957170426716, 'support': 41694}, '2': {'precision': 0.46304231387252276, 'recall': 0.4599117770930774, 'f1-score': 0.46147173630186494, 'support': 45113}, 'accuracy': 0.44971699202957144, 'macro avg': {'precision': 0.449498347633257, 'recall': 0.4500582836439346, 'f1-score': 0.4487226963178051, 'support': 129855}, 'weighted avg': {'precision': 0.44978736777835826, 'recall': 0.44971699202957144, 'f1-score': 0.44871926246855487, 'support': 129855}}
[[16894 13708 12446]
 [ 9324 20756 11614]
 [11916 12449 20748]]
Evaluating performance on  train set...
262/262 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9841795
{'0': {'precision': 0.49715581027329886, 'recall': 0.5219343540927663, 'f1-score': 0.5092438447384562, 'support': 22271}, '1': {'precision': 0.5382558817810617, 'recall': 0.4812464687730888, 'f1-score': 0.5081572244785572, 'support': 23009}, '2': {'precision': 0.4943570525948843, 'recall': 0.5246970678013135, 'f1-score': 0.5090754077763568, 'support': 21622}, 'accuracy': 0.5088338166273056, 'macro avg': {'precision': 0.5099229148830816, 'recall': 0.5092926302223896, 'f1-score': 0.5088254923311234, 'support': 66902}, 'weighted avg': {'precision': 0.510386458188151, 'recall': 0.5088338166273056, 'f1-score': 0.5088156962592698, 'support': 66902}}
[[11624  4812  5835]
 [ 6167 11073  5769]
 [ 5590  4687 11345]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0079459
{'0': {'precision': 0.4826540136901058, 'recall': 0.5437973796065028, 'f1-score': 0.5114046112954073, 'support': 22821}, '1': {'precision': 0.5093222326454033, 'recall': 0.4007103648692283, 'f1-score': 0.4485349167419646, 'support': 21679}, '2': {'precision': 0.48620203861771777, 'recall': 0.5237925185251316, 'f1-score': 0.5042977479800584, 'support': 22402}, 'accuracy': 0.4907327135212699, 'macro avg': {'precision': 0.49272609498440895, 'recall': 0.4894334210002875, 'f1-score': 0.4880790920058102, 'support': 66902}, 'weighted avg': {'precision': 0.4924836626267633, 'recall': 0.4907327135212699, 'f1-score': 0.4886525252559088, 'support': 66902}}
[[12410  4225  6186]
 [ 6778  8687  6214]
 [ 6524  4144 11734]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0277139
{'0': {'precision': 0.4586889278127679, 'recall': 0.5477038091847632, 'f1-score': 0.49925970996856295, 'support': 22472}, '1': {'precision': 0.4991049737885181, 'recall': 0.349290859469375, 'f1-score': 0.41097044192351223, 'support': 22351}, '2': {'precision': 0.4655504155238056, 'recall': 0.5150595588568323, 'f1-score': 0.48905517567625684, 'support': 22079}, 'accuracy': 0.47064362799318404, 'macro avg': {'precision': 0.4744481057083639, 'recall': 0.47068474250365683, 'f1-score': 0.4664284425227774, 'support': 66902}, 'weighted avg': {'precision': 0.47445577829221536, 'recall': 0.47064362799318404, 'f1-score': 0.4663958293265081, 'support': 66902}}
[[12308  3997  6167]
 [ 7656  7807  6888]
 [ 6869  3838 11372]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0487442
{'0': {'precision': 0.4376383210172925, 'recall': 0.5150311217057343, 'f1-score': 0.47319110966904604, 'support': 22653}, '1': {'precision': 0.4520031612864004, 'recall': 0.33866265828550607, 'f1-score': 0.38720933260422363, 'support': 21954}, '2': {'precision': 0.4515424056484828, 'recall': 0.48190177169769005, 'f1-score': 0.4662283842131528, 'support': 22295}, 'accuracy': 0.4461152132970614, 'macro avg': {'precision': 0.4470612959840586, 'recall': 0.4451985172296435, 'f1-score': 0.44220960882880744, 'support': 66902}, 'weighted avg': {'precision': 0.44698568387819926, 'recall': 0.4461152132970614, 'f1-score': 0.4426557310896277, 'support': 66902}}
[[11667  4752  6234]
 [ 7703  7435  6816]
 [ 7289  4262 10744]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0218546
{'0': {'precision': 0.4920787987326078, 'recall': 0.5243687610099824, 'f1-score': 0.5077108947480634, 'support': 6812}, '1': {'precision': 0.4374297910581892, 'recall': 0.3839479392624729, 'f1-score': 0.40894770006301195, 'support': 5071}, '2': {'precision': 0.4993518651879591, 'recall': 0.512112259970458, 'f1-score': 0.505651571501495, 'support': 6770}, 'accuracy': 0.4817455637162923, 'macro avg': {'precision': 0.476286818326252, 'recall': 0.47347632008097107, 'f1-score': 0.4741033887708568, 'support': 18653}, 'weighted avg': {'precision': 0.47986165092720123, 'recall': 0.4817455637162923, 'f1-score': 0.4801137372598757, 'support': 18653}}
[[3572 1259 1981]
 [1629 1947 1495]
 [2058 1245 3467]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0430436
{'0': {'precision': 0.4723139446278893, 'recall': 0.553752233472305, 'f1-score': 0.5098012337217271, 'support': 6716}, '1': {'precision': 0.41716227697536107, 'recall': 0.28961856075501374, 'f1-score': 0.3418823256353719, 'support': 5086}, '2': {'precision': 0.48316777041942605, 'recall': 0.511166253101737, 'f1-score': 0.49677282076743035, 'support': 6851}, 'accuracy': 0.46609124537607893, 'macro avg': {'precision': 0.4575479973408922, 'recall': 0.4515123491096853, 'f1-score': 0.44948546004150974, 'support': 18653}, 'weighted avg': {'precision': 0.4612625415729952, 'recall': 0.46609124537607893, 'f1-score': 0.4592306432710173, 'support': 18653}}
[[3719 1031 1966]
 [1833 1473 1780]
 [2322 1027 3502]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0604364
{'0': {'precision': 0.43560325684678014, 'recall': 0.5457496136012365, 'f1-score': 0.48449506037321627, 'support': 6470}, '1': {'precision': 0.4085956416464891, 'recall': 0.24171888988361684, 'f1-score': 0.3037462031724603, 'support': 5585}, '2': {'precision': 0.4568548943807814, 'recall': 0.5015156107911488, 'f1-score': 0.47814464272812657, 'support': 6598}, 'accuracy': 0.43907146303543665, 'macro avg': {'precision': 0.43368459762468353, 'recall': 0.42966137142533406, 'f1-score': 0.42212863542460105, 'support': 18653}, 'weighted avg': {'precision': 0.4350339529040211, 'recall': 0.43907146303543665, 'f1-score': 0.428129734522762, 'support': 18653}}
[[3531 1022 1917]
 [2218 1350 2017]
 [2357  932 3309]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0776404
{'0': {'precision': 0.4100113193309018, 'recall': 0.509852987175477, 'f1-score': 0.45451376786336706, 'support': 6394}, '1': {'precision': 0.4011164274322169, 'recall': 0.2547695424615904, 'f1-score': 0.31161590087764585, 'support': 5923}, '2': {'precision': 0.42046109510086455, 'recall': 0.4605429292929293, 'f1-score': 0.4395902380235011, 'support': 6336}, 'accuracy': 0.4121052913740417, 'macro avg': {'precision': 0.4105296139546611, 'recall': 0.4083884863099989, 'f1-score': 0.4019066355881713, 'support': 18653}, 'weighted avg': {'precision': 0.41073642170384844, 'recall': 0.4121052913740417, 'f1-score': 0.40406935939171007, 'support': 18653}}
[[3260 1157 1977]
 [2369 1509 2045]
 [2322 1096 2918]]
training model: results/XRAY/W9/deepVOL_L2/seq2seq
Epoch 1/50
262/262 - 15s - loss: 13.1210 - accuracy10: 0.3887 - accuracy20: 0.3862 - accuracy30: 0.3810 - accuracy50: 0.3823 - val_loss: 13.1628 - val_accuracy10: 0.3714 - val_accuracy20: 0.3716 - val_accuracy30: 0.3704 - val_accuracy50: 0.3726 - 15s/epoch - 56ms/step
Epoch 2/50
262/262 - 8s - loss: 12.8393 - accuracy10: 0.4320 - accuracy20: 0.4243 - accuracy30: 0.4080 - accuracy50: 0.4007 - val_loss: 13.0311 - val_accuracy10: 0.4174 - val_accuracy20: 0.3979 - val_accuracy30: 0.3815 - val_accuracy50: 0.3700 - 8s/epoch - 32ms/step
Epoch 3/50
262/262 - 8s - loss: 12.6730 - accuracy10: 0.4545 - accuracy20: 0.4433 - accuracy30: 0.4257 - accuracy50: 0.4152 - val_loss: 12.9384 - val_accuracy10: 0.4419 - val_accuracy20: 0.4240 - val_accuracy30: 0.3988 - val_accuracy50: 0.3805 - 8s/epoch - 32ms/step
Epoch 4/50
262/262 - 8s - loss: 12.5767 - accuracy10: 0.4657 - accuracy20: 0.4534 - accuracy30: 0.4343 - accuracy50: 0.4209 - val_loss: 12.8867 - val_accuracy10: 0.4464 - val_accuracy20: 0.4264 - val_accuracy30: 0.4058 - val_accuracy50: 0.3898 - 8s/epoch - 32ms/step
Epoch 5/50
262/262 - 8s - loss: 12.5112 - accuracy10: 0.4738 - accuracy20: 0.4605 - accuracy30: 0.4393 - accuracy50: 0.4232 - val_loss: 12.9059 - val_accuracy10: 0.4393 - val_accuracy20: 0.4193 - val_accuracy30: 0.3989 - val_accuracy50: 0.3879 - 8s/epoch - 32ms/step
Epoch 6/50
262/262 - 8s - loss: 12.4778 - accuracy10: 0.4777 - accuracy20: 0.4655 - accuracy30: 0.4446 - accuracy50: 0.4246 - val_loss: 12.8334 - val_accuracy10: 0.4537 - val_accuracy20: 0.4332 - val_accuracy30: 0.4093 - val_accuracy50: 0.3916 - 8s/epoch - 32ms/step
Epoch 7/50
262/262 - 8s - loss: 12.4300 - accuracy10: 0.4849 - accuracy20: 0.4734 - accuracy30: 0.4500 - accuracy50: 0.4304 - val_loss: 12.8738 - val_accuracy10: 0.4474 - val_accuracy20: 0.4322 - val_accuracy30: 0.4091 - val_accuracy50: 0.3930 - 8s/epoch - 32ms/step
Epoch 8/50
262/262 - 8s - loss: 12.3967 - accuracy10: 0.4884 - accuracy20: 0.4760 - accuracy30: 0.4534 - accuracy50: 0.4311 - val_loss: 12.8043 - val_accuracy10: 0.4563 - val_accuracy20: 0.4390 - val_accuracy30: 0.4124 - val_accuracy50: 0.3929 - 8s/epoch - 32ms/step
Epoch 9/50
262/262 - 9s - loss: 12.3591 - accuracy10: 0.4928 - accuracy20: 0.4787 - accuracy30: 0.4543 - accuracy50: 0.4334 - val_loss: 12.7627 - val_accuracy10: 0.4642 - val_accuracy20: 0.4432 - val_accuracy30: 0.4143 - val_accuracy50: 0.3955 - 9s/epoch - 32ms/step
Epoch 10/50
262/262 - 8s - loss: 12.3164 - accuracy10: 0.4970 - accuracy20: 0.4829 - accuracy30: 0.4579 - accuracy50: 0.4371 - val_loss: 12.7779 - val_accuracy10: 0.4635 - val_accuracy20: 0.4433 - val_accuracy30: 0.4144 - val_accuracy50: 0.3950 - 8s/epoch - 32ms/step
Epoch 11/50
262/262 - 9s - loss: 12.2844 - accuracy10: 0.4996 - accuracy20: 0.4861 - accuracy30: 0.4631 - accuracy50: 0.4411 - val_loss: 12.8652 - val_accuracy10: 0.4491 - val_accuracy20: 0.4349 - val_accuracy30: 0.4096 - val_accuracy50: 0.3971 - 9s/epoch - 33ms/step
Epoch 12/50
262/262 - 8s - loss: 12.2505 - accuracy10: 0.5025 - accuracy20: 0.4885 - accuracy30: 0.4646 - accuracy50: 0.4421 - val_loss: 12.8732 - val_accuracy10: 0.4515 - val_accuracy20: 0.4340 - val_accuracy30: 0.4068 - val_accuracy50: 0.3956 - 8s/epoch - 32ms/step
Epoch 13/50
262/262 - 8s - loss: 12.2221 - accuracy10: 0.5033 - accuracy20: 0.4904 - accuracy30: 0.4643 - accuracy50: 0.4443 - val_loss: 12.8011 - val_accuracy10: 0.4630 - val_accuracy20: 0.4391 - val_accuracy30: 0.4095 - val_accuracy50: 0.4006 - 8s/epoch - 32ms/step
Epoch 14/50
262/262 - 8s - loss: 12.1916 - accuracy10: 0.5086 - accuracy20: 0.4939 - accuracy30: 0.4692 - accuracy50: 0.4481 - val_loss: 12.8129 - val_accuracy10: 0.4612 - val_accuracy20: 0.4388 - val_accuracy30: 0.4117 - val_accuracy50: 0.3948 - 8s/epoch - 32ms/step
Epoch 15/50
262/262 - 8s - loss: 12.1596 - accuracy10: 0.5099 - accuracy20: 0.4975 - accuracy30: 0.4710 - accuracy50: 0.4535 - val_loss: 12.8909 - val_accuracy10: 0.4558 - val_accuracy20: 0.4326 - val_accuracy30: 0.4070 - val_accuracy50: 0.3938 - 8s/epoch - 32ms/step
Epoch 16/50
262/262 - 8s - loss: 12.1339 - accuracy10: 0.5110 - accuracy20: 0.4984 - accuracy30: 0.4731 - accuracy50: 0.4544 - val_loss: 12.8518 - val_accuracy10: 0.4661 - val_accuracy20: 0.4396 - val_accuracy30: 0.4114 - val_accuracy50: 0.3896 - 8s/epoch - 32ms/step
Epoch 17/50
262/262 - 9s - loss: 12.1110 - accuracy10: 0.5127 - accuracy20: 0.4994 - accuracy30: 0.4731 - accuracy50: 0.4564 - val_loss: 12.8680 - val_accuracy10: 0.4581 - val_accuracy20: 0.4349 - val_accuracy30: 0.4097 - val_accuracy50: 0.3951 - 9s/epoch - 33ms/step
Epoch 18/50
262/262 - 8s - loss: 12.0779 - accuracy10: 0.5154 - accuracy20: 0.5030 - accuracy30: 0.4765 - accuracy50: 0.4596 - val_loss: 12.9375 - val_accuracy10: 0.4574 - val_accuracy20: 0.4355 - val_accuracy30: 0.4075 - val_accuracy50: 0.3945 - 8s/epoch - 32ms/step
Epoch 19/50
262/262 - 8s - loss: 12.0610 - accuracy10: 0.5158 - accuracy20: 0.5046 - accuracy30: 0.4798 - accuracy50: 0.4600 - val_loss: 12.9497 - val_accuracy10: 0.4560 - val_accuracy20: 0.4325 - val_accuracy30: 0.4103 - val_accuracy50: 0.3945 - 8s/epoch - 32ms/step
testing model: results/XRAY/W9/deepVOL_L2/seq2seq
Evaluating performance on  test set...
508/508 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9889363
{'0': {'precision': 0.44658538664847813, 'recall': 0.549243715102105, 'f1-score': 0.492623114632684, 'support': 38147}, '1': {'precision': 0.5862809499747347, 'recall': 0.5318791305344386, 'f1-score': 0.5577566349524287, 'support': 52354}, '2': {'precision': 0.44195559567805454, 'recall': 0.3980385182173891, 'f1-score': 0.4188490074192901, 'support': 39358}, 'accuracy': 0.49641534279487753, 'macro avg': {'precision': 0.4916073107670891, 'recall': 0.4930537879513109, 'f1-score': 0.48974291900146755, 'support': 129859}, 'weighted avg': {'precision': 0.5015018900049564, 'recall': 0.49641534279487753, 'f1-score': 0.4965227212145547, 'support': 129859}}
[[20952 10224  6971]
 [11698 27846 12810]
 [14266  9426 15666]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0158383
{'0': {'precision': 0.43954825891456656, 'recall': 0.5318066801619433, 'f1-score': 0.48129615847025814, 'support': 39520}, '1': {'precision': 0.5283688701640326, 'recall': 0.4939816851281641, 'f1-score': 0.510596964029223, 'support': 50014}, '2': {'precision': 0.4317698738840867, 'recall': 0.3778053316800992, 'f1-score': 0.40298902261605607, 'support': 40325}, 'accuracy': 0.4694168290222472, 'macro avg': {'precision': 0.4665623343208953, 'recall': 0.46786456565673556, 'f1-score': 0.46496071503851244, 'support': 129859}, 'weighted avg': {'precision': 0.47134128577197876, 'recall': 0.4694168290222472, 'f1-score': 0.46826444896922526, 'support': 129859}}
[[21017 11515  6988]
 [12246 24706 13062]
 [14552 10538 15235]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0392954
{'0': {'precision': 0.42808555974430423, 'recall': 0.5248825583440099, 'f1-score': 0.47156801895841566, 'support': 39807}, '1': {'precision': 0.4843459392436454, 'recall': 0.44354102881242524, 'f1-score': 0.46304626229057083, 'support': 49319}, '2': {'precision': 0.409814138824644, 'recall': 0.3610586011342155, 'f1-score': 0.38389454450535104, 'support': 40733}, 'accuracy': 0.44260313108833427, 'macro avg': {'precision': 0.44074854593753116, 'recall': 0.4431607294302169, 'f1-score': 0.4395029419181125, 'support': 129859}, 'weighted avg': {'precision': 0.4437214099218621, 'recall': 0.44260313108833427, 'f1-score': 0.44083092601916524, 'support': 129859}}
[[20894 11930  6983]
 [13247 21875 14197]
 [14667 11359 14707]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0659338
{'0': {'precision': 0.4345606999635436, 'recall': 0.4983856356414485, 'f1-score': 0.46428996483635376, 'support': 43051}, '1': {'precision': 0.3888799355358582, 'recall': 0.40511824243296396, 'f1-score': 0.3968330416191897, 'support': 41694}, '2': {'precision': 0.4175708502024291, 'recall': 0.3429312408564969, 'f1-score': 0.37658828684095225, 'support': 45114}, 'accuracy': 0.4144341170038272, 'macro avg': {'precision': 0.4136704952339436, 'recall': 0.41547837297696977, 'f1-score': 0.4125704310988319, 'support': 129859}, 'weighted avg': {'precision': 0.41399151435322135, 'recall': 0.4144341170038272, 'f1-score': 0.41216325465299347, 'support': 129859}}
[[21456 13398  8197]
 [11421 16891 13382]
 [16497 13146 15471]]
Evaluating performance on  train set...
262/262 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.00903
{'0': {'precision': 0.45824235807860264, 'recall': 0.5274424449131625, 'f1-score': 0.4904133024556133, 'support': 22283}, '1': {'precision': 0.5129948557369716, 'recall': 0.49928164047194046, 'f1-score': 0.5060453622804695, 'support': 22969}, '2': {'precision': 0.47880840256098206, 'recall': 0.4179676674364896, 'f1-score': 0.4463242003501936, 'support': 21650}, 'accuracy': 0.4823473139816448, 'macro avg': {'precision': 0.4833485387921854, 'recall': 0.4815639176071975, 'f1-score': 0.48092762169542547, 'support': 66902}, 'weighted avg': {'precision': 0.4836954832730451, 'recall': 0.4823473139816448, 'f1-score': 0.48151257783654045, 'support': 66902}}
[[11753  5788  4742]
 [ 6393 11468  5108]
 [ 7502  5099  9049]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0293674
{'0': {'precision': 0.456046287367406, 'recall': 0.5178258584442887, 'f1-score': 0.4849765161925467, 'support': 22832}, '1': {'precision': 0.46401842256764536, 'recall': 0.4828126439959451, 'f1-score': 0.47322900435833165, 'support': 21702}, '2': {'precision': 0.4850510980647967, 'recall': 0.3989180972818312, 'f1-score': 0.43778824452948684, 'support': 22368}, 'accuracy': 0.46671250485785176, 'macro avg': {'precision': 0.46837193599994936, 'recall': 0.46651886657402164, 'f1-score': 0.46533125502678835, 'support': 66902}, 'weighted avg': {'precision': 0.46832978986052776, 'recall': 0.46671250485785176, 'f1-score': 0.4653888840980584, 'support': 66902}}
[[11823  6297  4712]
 [ 6463 10478  4761]
 [ 7639  5806  8923]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0479829
{'0': {'precision': 0.4369809009836568, 'recall': 0.507377122033597, 'f1-score': 0.46955520368504394, 'support': 22502}, '1': {'precision': 0.43724589004772846, 'recall': 0.44312074525259765, 'f1-score': 0.44016371563306345, 'support': 22328}, '2': {'precision': 0.46321706067118534, 'recall': 0.380844508880029, 'f1-score': 0.41801138765260204, 'support': 22072}, 'accuracy': 0.4441870198200353, 'macro avg': {'precision': 0.4458146172341902, 'recall': 0.4437807920554078, 'f1-score': 0.4425767689902365, 'support': 66902}, 'weighted avg': {'precision': 0.4457250520171942, 'recall': 0.4441870198200353, 'f1-score': 0.44274093426570404, 'support': 66902}}
[[11417  6479  4606]
 [ 7299  9894  5135]
 [ 7411  6255  8406]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0653226
{'0': {'precision': 0.4243257697303079, 'recall': 0.488973015803143, 'f1-score': 0.4543613866448512, 'support': 22717}, '1': {'precision': 0.41123228398604794, 'recall': 0.4249863113706881, 'f1-score': 0.4179961853472456, 'support': 21916}, '2': {'precision': 0.43911479944674964, 'recall': 0.3564147469576541, 'f1-score': 0.39346619075946854, 'support': 22269}, 'accuracy': 0.42388867298436517, 'macro avg': {'precision': 0.4248909510543685, 'recall': 0.4234580247104951, 'f1-score': 0.4219412542505218, 'support': 66902}, 'weighted avg': {'precision': 0.424959234636951, 'recall': 0.42388867298436517, 'f1-score': 0.4221791668485833, 'support': 66902}}
[[11108  6753  4856]
 [ 7320  9314  5282]
 [ 7750  6582  7937]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.036692
{'0': {'precision': 0.47019354838709676, 'recall': 0.5345459879712483, 'f1-score': 0.5003089174160774, 'support': 6817}, '1': {'precision': 0.4033774707349837, 'recall': 0.41239945065724937, 'f1-score': 0.4078385719829259, 'support': 5097}, '2': {'precision': 0.5093975057087652, 'recall': 0.43026706231454004, 'f1-score': 0.46650044237110916, 'support': 6740}, 'accuracy': 0.4634930845931168, 'macro avg': {'precision': 0.46098950827694857, 'recall': 0.45907083364767926, 'f1-score': 0.4582159772567042, 'support': 18654}, 'weighted avg': {'precision': 0.4661018321093668, 'recall': 0.4634930845931168, 'f1-score': 0.4628268507024578, 'support': 18654}}
[[3644 1674 1499]
 [1701 2102 1294]
 [2405 1435 2900]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0569791
{'0': {'precision': 0.4547909967845659, 'recall': 0.5249406175771971, 'f1-score': 0.48735442078423263, 'support': 6736}, '1': {'precision': 0.36575013840191917, 'recall': 0.3900806927770124, 'f1-score': 0.37752380952380954, 'support': 5081}, '2': {'precision': 0.4937728937728938, 'recall': 0.3943249963434255, 'f1-score': 0.4384809303082053, 'support': 6837}, 'accuracy': 0.44033451270504986, 'macro avg': {'precision': 0.43810467631979294, 'recall': 0.43644876889921164, 'f1-score': 0.4344530535387492, 'support': 18654}, 'weighted avg': {'precision': 0.44482544667557966, 'recall': 0.44033451270504986, 'f1-score': 0.439525676804453, 'support': 18654}}
[[3536 1779 1421]
 [1756 1982 1343]
 [2483 1658 2696]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0737922
{'0': {'precision': 0.42337090296670554, 'recall': 0.5008429118773946, 'f1-score': 0.4588598708228026, 'support': 6525}, '1': {'precision': 0.34921475207340746, 'recall': 0.35734922354640664, 'f1-score': 0.3532351628737171, 'support': 5538}, '2': {'precision': 0.4588078967350038, 'recall': 0.36671218328023064, 'f1-score': 0.40762290243696764, 'support': 6591}, 'accuracy': 0.4108502197920017, 'macro avg': {'precision': 0.4104645172583723, 'recall': 0.4083014395680106, 'f1-score': 0.4065726453778291, 'support': 18654}, 'weighted avg': {'precision': 0.4138763421368444, 'recall': 0.4108502197920017, 'f1-score': 0.4093984957154222, 'support': 18654}}
[[3268 1890 1367]
 [2075 1979 1484]
 [2376 1798 2417]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0866477
{'0': {'precision': 0.406130772266807, 'recall': 0.48234375, 'f1-score': 0.4409685022498393, 'support': 6400}, '1': {'precision': 0.36311433879412264, 'recall': 0.3621967654986523, 'f1-score': 0.36265497174664757, 'support': 5936}, '2': {'precision': 0.41504286827747466, 'recall': 0.3371320037986705, 'f1-score': 0.3720524017467249, 'support': 6318}, 'accuracy': 0.3949287016189557, 'macro avg': {'precision': 0.39476265977946806, 'recall': 0.39389083976577427, 'f1-score': 0.39189195858107057, 'support': 18654}, 'weighted avg': {'precision': 0.3954607322486631, 'recall': 0.3949287016189557, 'f1-score': 0.392706411542987, 'support': 18654}}
[[3087 1921 1392]
 [2176 2150 1610]
 [2338 1850 2130]]
training model: results/XRAY/W9/deepVOL_L3/seq2seq
Epoch 1/50
262/262 - 17s - loss: 13.2129 - accuracy10: 0.3734 - accuracy20: 0.3711 - accuracy30: 0.3649 - accuracy50: 0.3714 - val_loss: 13.4451 - val_accuracy10: 0.3512 - val_accuracy20: 0.3487 - val_accuracy30: 0.3500 - val_accuracy50: 0.3531 - 17s/epoch - 65ms/step
Epoch 2/50
262/262 - 11s - loss: 13.0706 - accuracy10: 0.3921 - accuracy20: 0.3855 - accuracy30: 0.3766 - accuracy50: 0.3801 - val_loss: 13.1474 - val_accuracy10: 0.3809 - val_accuracy20: 0.3689 - val_accuracy30: 0.3666 - val_accuracy50: 0.3651 - 11s/epoch - 43ms/step
Epoch 3/50
262/262 - 12s - loss: 13.0554 - accuracy10: 0.3943 - accuracy20: 0.3863 - accuracy30: 0.3782 - accuracy50: 0.3750 - val_loss: 13.0233 - val_accuracy10: 0.3999 - val_accuracy20: 0.3868 - val_accuracy30: 0.3738 - val_accuracy50: 0.3690 - 12s/epoch - 44ms/step
Epoch 4/50
262/262 - 11s - loss: 13.0233 - accuracy10: 0.4036 - accuracy20: 0.3941 - accuracy30: 0.3806 - accuracy50: 0.3718 - val_loss: 13.0792 - val_accuracy10: 0.3895 - val_accuracy20: 0.3772 - val_accuracy30: 0.3637 - val_accuracy50: 0.3627 - 11s/epoch - 43ms/step
Epoch 5/50
262/262 - 12s - loss: 12.9318 - accuracy10: 0.4142 - accuracy20: 0.4043 - accuracy30: 0.3919 - accuracy50: 0.3814 - val_loss: 12.9609 - val_accuracy10: 0.4100 - val_accuracy20: 0.3991 - val_accuracy30: 0.3788 - val_accuracy50: 0.3664 - 12s/epoch - 44ms/step
Epoch 6/50
262/262 - 12s - loss: 12.8552 - accuracy10: 0.4267 - accuracy20: 0.4193 - accuracy30: 0.4034 - accuracy50: 0.3934 - val_loss: 12.9972 - val_accuracy10: 0.4081 - val_accuracy20: 0.4012 - val_accuracy30: 0.3859 - val_accuracy50: 0.3735 - 12s/epoch - 44ms/step
Epoch 7/50
262/262 - 12s - loss: 12.7771 - accuracy10: 0.4373 - accuracy20: 0.4317 - accuracy30: 0.4171 - accuracy50: 0.4070 - val_loss: 12.9000 - val_accuracy10: 0.4309 - val_accuracy20: 0.4162 - val_accuracy30: 0.3978 - val_accuracy50: 0.3878 - 12s/epoch - 45ms/step
Epoch 8/50
262/262 - 12s - loss: 12.6467 - accuracy10: 0.4594 - accuracy20: 0.4501 - accuracy30: 0.4343 - accuracy50: 0.4175 - val_loss: 12.8775 - val_accuracy10: 0.4396 - val_accuracy20: 0.4262 - val_accuracy30: 0.4046 - val_accuracy50: 0.3901 - 12s/epoch - 44ms/step
Epoch 9/50
262/262 - 12s - loss: 12.5770 - accuracy10: 0.4660 - accuracy20: 0.4561 - accuracy30: 0.4376 - accuracy50: 0.4227 - val_loss: 12.7385 - val_accuracy10: 0.4622 - val_accuracy20: 0.4475 - val_accuracy30: 0.4204 - val_accuracy50: 0.3964 - 12s/epoch - 44ms/step
Epoch 10/50
262/262 - 11s - loss: 12.5077 - accuracy10: 0.4762 - accuracy20: 0.4638 - accuracy30: 0.4446 - accuracy50: 0.4284 - val_loss: 12.7127 - val_accuracy10: 0.4717 - val_accuracy20: 0.4553 - val_accuracy30: 0.4244 - val_accuracy50: 0.4036 - 11s/epoch - 44ms/step
Epoch 11/50
262/262 - 12s - loss: 12.4339 - accuracy10: 0.4835 - accuracy20: 0.4718 - accuracy30: 0.4508 - accuracy50: 0.4340 - val_loss: 12.6913 - val_accuracy10: 0.4746 - val_accuracy20: 0.4597 - val_accuracy30: 0.4289 - val_accuracy50: 0.4059 - 12s/epoch - 45ms/step
Epoch 12/50
262/262 - 12s - loss: 12.3962 - accuracy10: 0.4859 - accuracy20: 0.4732 - accuracy30: 0.4511 - accuracy50: 0.4361 - val_loss: 12.6579 - val_accuracy10: 0.4802 - val_accuracy20: 0.4652 - val_accuracy30: 0.4332 - val_accuracy50: 0.4102 - 12s/epoch - 45ms/step
Epoch 13/50
262/262 - 12s - loss: 12.3433 - accuracy10: 0.4903 - accuracy20: 0.4791 - accuracy30: 0.4577 - accuracy50: 0.4421 - val_loss: 12.6836 - val_accuracy10: 0.4743 - val_accuracy20: 0.4574 - val_accuracy30: 0.4247 - val_accuracy50: 0.4047 - 12s/epoch - 45ms/step
Epoch 14/50
262/262 - 12s - loss: 12.3021 - accuracy10: 0.4934 - accuracy20: 0.4839 - accuracy30: 0.4601 - accuracy50: 0.4452 - val_loss: 12.6876 - val_accuracy10: 0.4779 - val_accuracy20: 0.4581 - val_accuracy30: 0.4269 - val_accuracy50: 0.4066 - 12s/epoch - 45ms/step
Epoch 15/50
262/262 - 12s - loss: 12.2811 - accuracy10: 0.4955 - accuracy20: 0.4836 - accuracy30: 0.4619 - accuracy50: 0.4444 - val_loss: 12.6994 - val_accuracy10: 0.4787 - val_accuracy20: 0.4596 - val_accuracy30: 0.4260 - val_accuracy50: 0.4077 - 12s/epoch - 45ms/step
Epoch 16/50
262/262 - 12s - loss: 12.2513 - accuracy10: 0.4963 - accuracy20: 0.4856 - accuracy30: 0.4645 - accuracy50: 0.4465 - val_loss: 12.7001 - val_accuracy10: 0.4754 - val_accuracy20: 0.4546 - val_accuracy30: 0.4239 - val_accuracy50: 0.4042 - 12s/epoch - 46ms/step
Epoch 17/50
262/262 - 12s - loss: 12.2206 - accuracy10: 0.4991 - accuracy20: 0.4875 - accuracy30: 0.4679 - accuracy50: 0.4491 - val_loss: 12.6900 - val_accuracy10: 0.4774 - val_accuracy20: 0.4588 - val_accuracy30: 0.4259 - val_accuracy50: 0.4039 - 12s/epoch - 44ms/step
Epoch 18/50
262/262 - 12s - loss: 12.2077 - accuracy10: 0.5019 - accuracy20: 0.4896 - accuracy30: 0.4672 - accuracy50: 0.4517 - val_loss: 12.6992 - val_accuracy10: 0.4686 - val_accuracy20: 0.4520 - val_accuracy30: 0.4255 - val_accuracy50: 0.4047 - 12s/epoch - 44ms/step
Epoch 19/50
262/262 - 12s - loss: 12.1771 - accuracy10: 0.5039 - accuracy20: 0.4932 - accuracy30: 0.4724 - accuracy50: 0.4545 - val_loss: 12.7225 - val_accuracy10: 0.4701 - val_accuracy20: 0.4518 - val_accuracy30: 0.4249 - val_accuracy50: 0.4017 - 12s/epoch - 44ms/step
Epoch 20/50
262/262 - 12s - loss: 12.1334 - accuracy10: 0.5074 - accuracy20: 0.4964 - accuracy30: 0.4754 - accuracy50: 0.4566 - val_loss: 12.7519 - val_accuracy10: 0.4677 - val_accuracy20: 0.4501 - val_accuracy30: 0.4230 - val_accuracy50: 0.4013 - 12s/epoch - 46ms/step
Epoch 21/50
262/262 - 11s - loss: 12.1178 - accuracy10: 0.5097 - accuracy20: 0.4987 - accuracy30: 0.4773 - accuracy50: 0.4601 - val_loss: 12.7030 - val_accuracy10: 0.4766 - val_accuracy20: 0.4575 - val_accuracy30: 0.4276 - val_accuracy50: 0.4000 - 11s/epoch - 43ms/step
Epoch 22/50
262/262 - 11s - loss: 12.0906 - accuracy10: 0.5118 - accuracy20: 0.5016 - accuracy30: 0.4793 - accuracy50: 0.4609 - val_loss: 12.7044 - val_accuracy10: 0.4776 - val_accuracy20: 0.4583 - val_accuracy30: 0.4314 - val_accuracy50: 0.4043 - 11s/epoch - 43ms/step
testing model: results/XRAY/W9/deepVOL_L3/seq2seq
Evaluating performance on  test set...
508/508 - 10s - 10s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.98447007
{'0': {'precision': 0.4433075221238938, 'recall': 0.4622381838676698, 'f1-score': 0.45257497786276196, 'support': 38147}, '1': {'precision': 0.6016882386043895, 'recall': 0.510562707720518, 'f1-score': 0.5523925645026297, 'support': 52354}, '2': {'precision': 0.4330018835691445, 'recall': 0.5023121093551501, 'f1-score': 0.46508892443775285, 'support': 39358}, 'accuracy': 0.493866424352567, 'macro avg': {'precision': 0.49266588143247586, 'recall': 0.4917043336477793, 'f1-score': 0.49001882226771487, 'support': 129859}, 'weighted avg': {'precision': 0.5040368878850813, 'recall': 0.493866424352567, 'f1-score': 0.4966102302537563, 'support': 129859}}
[[17633  9718 10796]
 [10532 26730 15092]
 [11611  7977 19770]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0105232
{'0': {'precision': 0.4405488178365797, 'recall': 0.4549848178137652, 'f1-score': 0.44765046368332606, 'support': 39520}, '1': {'precision': 0.5544554455445545, 'recall': 0.47586675730795375, 'f1-score': 0.5121638924455826, 'support': 50014}, '2': {'precision': 0.4306034389297253, 'recall': 0.49247365158090517, 'f1-score': 0.45946508722409884, 'support': 40325}, 'accuracy': 0.47466867910579935, 'macro avg': {'precision': 0.47520256743695316, 'recall': 0.47444174223420804, 'f1-score': 0.47309314778433587, 'support': 129859}, 'weighted avg': {'precision': 0.4813305786214906, 'recall': 0.47466867910579935, 'f1-score': 0.4761660022320378, 'support': 129859}}
[[17981 10435 11104]
 [11058 23800 15156]
 [11776  8690 19859]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.032584
{'0': {'precision': 0.4287531184268454, 'recall': 0.440374808450775, 'f1-score': 0.4344862627489373, 'support': 39807}, '1': {'precision': 0.5149077699674482, 'recall': 0.4426083253918368, 'f1-score': 0.47602848015003324, 'support': 49319}, '2': {'precision': 0.4159814508684171, 'recall': 0.47568310706306927, 'f1-score': 0.443833608209639, 'support': 40733}, 'accuracy': 0.45229826196105005, 'macro avg': {'precision': 0.45321411308757026, 'recall': 0.45288874696856035, 'f1-score': 0.45144945036953654, 'support': 129859}, 'weighted avg': {'precision': 0.4574675927772835, 'recall': 0.45229826196105005, 'f1-score': 0.45319552466112994, 'support': 129859}}
[[17530 11098 11179]
 [11466 21829 16024]
 [11890  9467 19376]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0582535
{'0': {'precision': 0.4372091859708811, 'recall': 0.405960372581357, 'f1-score': 0.4210057211683228, 'support': 43051}, '1': {'precision': 0.41516598718695397, 'recall': 0.42742361011176666, 'f1-score': 0.4212056393954076, 'support': 41694}, '2': {'precision': 0.4260647359454855, 'recall': 0.44349869220197724, 'f1-score': 0.4346069465864414, 'support': 45114}, 'accuracy': 0.42589269900430465, 'macro avg': {'precision': 0.4261466363677735, 'recall': 0.4256275582983669, 'f1-score': 0.42560610238339064, 'support': 129859}, 'weighted avg': {'precision': 0.4262600807987886, 'recall': 0.42589269900430465, 'f1-score': 0.42579507788655624, 'support': 129859}}
[[17477 13166 12408]
 [ 9329 17821 14544]
 [13168 11938 20008]]
Evaluating performance on  train set...
262/262 - 5s - 5s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0064999
{'0': {'precision': 0.45161553524804177, 'recall': 0.49679127586052146, 'f1-score': 0.4731274708836414, 'support': 22283}, '1': {'precision': 0.535796535496145, 'recall': 0.46593234359353913, 'f1-score': 0.4984281489416203, 'support': 22969}, '2': {'precision': 0.4738579586009993, 'recall': 0.49062355658198614, 'f1-score': 0.48209503925929287, 'support': 21650}, 'accuracy': 0.4842007712773908, 'macro avg': {'precision': 0.48709000978172873, 'recall': 0.48444905867868227, 'f1-score': 0.4845502196948515, 'support': 66902}, 'weighted avg': {'precision': 0.48771463333614395, 'recall': 0.4842007712773908, 'f1-score': 0.48471575119882737, 'support': 66902}}
[[11070  5124  6089]
 [ 6562 10702  5705]
 [ 6880  4148 10622]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0239116
{'0': {'precision': 0.45508288396245256, 'recall': 0.4989926419060967, 'f1-score': 0.47602732571500195, 'support': 22832}, '1': {'precision': 0.4935483870967742, 'recall': 0.44415261266242745, 'f1-score': 0.4675494761350408, 'support': 21702}, '2': {'precision': 0.47701123696109593, 'recall': 0.47635014306151646, 'f1-score': 0.4766804607985684, 'support': 22368}, 'accuracy': 0.4736330752443873, 'macro avg': {'precision': 0.4752141693401075, 'recall': 0.47316513254334686, 'f1-score': 0.47341908754953704, 'support': 66902}, 'weighted avg': {'precision': 0.47489203389660556, 'recall': 0.4736330752443873, 'f1-score': 0.47349560818734804, 'support': 66902}}
[[11393  5308  6131]
 [ 6512  9639  5551]
 [ 7130  4583 10655]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0419508
{'0': {'precision': 0.4387844862055178, 'recall': 0.4876899831126122, 'f1-score': 0.46194645563226133, 'support': 22502}, '1': {'precision': 0.46806250948262784, 'recall': 0.4145019706198495, 'f1-score': 0.4396570152727964, 'support': 22328}, '2': {'precision': 0.45544554455445546, 'recall': 0.45641536788691556, 'f1-score': 0.45592994048561925, 'support': 22072}, 'accuracy': 0.4529461002660608, 'macro avg': {'precision': 0.4540975134142004, 'recall': 0.45286910720645907, 'f1-score': 0.45251113713022567, 'support': 66902}, 'weighted avg': {'precision': 0.4540525287694033, 'recall': 0.4529461002660608, 'f1-score': 0.4525225946615457, 'support': 66902}}
[[10974  5553  5975]
 [ 7003  9255  6070]
 [ 7033  4965 10074]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0588062
{'0': {'precision': 0.4282190429205723, 'recall': 0.45851124708368185, 'f1-score': 0.44284772857719856, 'support': 22717}, '1': {'precision': 0.43857293564783734, 'recall': 0.4173206789560139, 'f1-score': 0.42768295534252987, 'support': 21916}, '2': {'precision': 0.4417234395139017, 'recall': 0.43091292828595806, 'f1-score': 0.436251221785284, 'support': 22269}, 'accuracy': 0.4358315147529222, 'macro avg': {'precision': 0.4361718060274371, 'recall': 0.4355816181085513, 'f1-score': 0.4355939685683375, 'support': 66902}, 'weighted avg': {'precision': 0.436105882189168, 'recall': 0.4358315147529222, 'f1-score': 0.4356842838377267, 'support': 66902}}
[[10416  6120  6181]
 [ 6823  9146  5947]
 [ 7085  5588  9596]]
Evaluating performance on  val set...
73/73 - 2s - 2s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0261388
{'0': {'precision': 0.4712172075096357, 'recall': 0.5559630335924893, 'f1-score': 0.5100942126514132, 'support': 6817}, '1': {'precision': 0.4553978712620375, 'recall': 0.35256032960565037, 'f1-score': 0.3974344797080615, 'support': 5097}, '2': {'precision': 0.4999249812453113, 'recall': 0.4943620178041543, 'f1-score': 0.4971279373368146, 'support': 6740}, 'accuracy': 0.4781280154390479, 'macro avg': {'precision': 0.4755133533389948, 'recall': 0.46762846033409805, 'f1-score': 0.4682188765654298, 'support': 18654}, 'weighted avg': {'precision': 0.47726734357291684, 'recall': 0.4781280154390479, 'f1-score': 0.47462625111862355, 'support': 18654}}
[[3790 1167 1860]
 [1827 1797 1473]
 [2426  982 3332]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0450531
{'0': {'precision': 0.45430074635996576, 'recall': 0.5512173396674585, 'f1-score': 0.498088402978067, 'support': 6736}, '1': {'precision': 0.42189105858170606, 'recall': 0.32316473135209606, 'f1-score': 0.3659868494372005, 'support': 5081}, '2': {'precision': 0.49294278342692366, 'recall': 0.4750621617668568, 'f1-score': 0.483837330552659, 'support': 6837}, 'accuracy': 0.46118794896536935, 'macro avg': {'precision': 0.4563781961228652, 'recall': 0.449814744262137, 'f1-score': 0.4493041943226421, 'support': 18654}, 'weighted avg': {'precision': 0.4596359014915973, 'recall': 0.46118794896536935, 'f1-score': 0.45688316143664653, 'support': 18654}}
[[3713 1190 1833]
 [1931 1642 1508]
 [2529 1060 3248]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0656654
{'0': {'precision': 0.4249969185258228, 'recall': 0.5284291187739464, 'f1-score': 0.47110260964612655, 'support': 6525}, '1': {'precision': 0.39533730158730157, 'recall': 0.2878295413506681, 'f1-score': 0.33312434691745035, 'support': 5538}, '2': {'precision': 0.46105392533415274, 'recall': 0.4553178576847216, 'f1-score': 0.4581679389312977, 'support': 6591}, 'accuracy': 0.43116757799935673, 'macro avg': {'precision': 0.42712938181575905, 'recall': 0.4238588392697787, 'f1-score': 0.4207982984982916, 'support': 18654}, 'weighted avg': {'precision': 0.4289315584565707, 'recall': 0.43116757799935673, 'f1-score': 0.4255694246095207, 'support': 18654}}
[[3448 1280 1797]
 [2233 1594 1711]
 [2432 1158 3001]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0812116
{'0': {'precision': 0.4024157660521297, 'recall': 0.49453125, 'f1-score': 0.4437434279705573, 'support': 6400}, '1': {'precision': 0.3983721456025322, 'recall': 0.29683288409703507, 'f1-score': 0.34018727676416644, 'support': 5936}, '2': {'precision': 0.4227144203581527, 'recall': 0.42592592592592593, 'f1-score': 0.424314096499527, 'support': 6318}, 'accuracy': 0.408384260748365, 'macro avg': {'precision': 0.4078341106709382, 'recall': 0.405763353340987, 'f1-score': 0.40274826707808353, 'support': 18654}, 'weighted avg': {'precision': 0.4080040563339268, 'recall': 0.408384260748365, 'f1-score': 0.4042096105697261, 'support': 18654}}
[[3165 1387 1848]
 [2347 1762 1827]
 [2353 1274 2691]]
training model: results/XRAY/W10/deepLOB_L1/seq2seq
Epoch 1/50
220/220 - 13s - loss: 13.1976 - accuracy10: 0.3787 - accuracy20: 0.3725 - accuracy30: 0.3688 - accuracy50: 0.3677 - val_loss: 13.3960 - val_accuracy10: 0.3365 - val_accuracy20: 0.3474 - val_accuracy30: 0.3509 - val_accuracy50: 0.3475 - 13s/epoch - 57ms/step
Epoch 2/50
220/220 - 6s - loss: 13.0397 - accuracy10: 0.4086 - accuracy20: 0.3957 - accuracy30: 0.3856 - accuracy50: 0.3800 - val_loss: 13.2349 - val_accuracy10: 0.3488 - val_accuracy20: 0.3584 - val_accuracy30: 0.3607 - val_accuracy50: 0.3580 - 6s/epoch - 29ms/step
Epoch 3/50
220/220 - 6s - loss: 12.9991 - accuracy10: 0.4092 - accuracy20: 0.3996 - accuracy30: 0.3878 - accuracy50: 0.3805 - val_loss: 13.1457 - val_accuracy10: 0.3526 - val_accuracy20: 0.3685 - val_accuracy30: 0.3660 - val_accuracy50: 0.3643 - 6s/epoch - 29ms/step
Epoch 4/50
220/220 - 6s - loss: 12.9719 - accuracy10: 0.4189 - accuracy20: 0.4076 - accuracy30: 0.3914 - accuracy50: 0.3805 - val_loss: 13.0530 - val_accuracy10: 0.4057 - val_accuracy20: 0.3993 - val_accuracy30: 0.3902 - val_accuracy50: 0.3791 - 6s/epoch - 29ms/step
Epoch 5/50
220/220 - 6s - loss: 12.9380 - accuracy10: 0.4224 - accuracy20: 0.4094 - accuracy30: 0.3974 - accuracy50: 0.3872 - val_loss: 13.0447 - val_accuracy10: 0.4108 - val_accuracy20: 0.4049 - val_accuracy30: 0.3953 - val_accuracy50: 0.3807 - 6s/epoch - 29ms/step
Epoch 6/50
220/220 - 6s - loss: 12.9257 - accuracy10: 0.4253 - accuracy20: 0.4121 - accuracy30: 0.3993 - accuracy50: 0.3845 - val_loss: 13.1155 - val_accuracy10: 0.3778 - val_accuracy20: 0.3792 - val_accuracy30: 0.3749 - val_accuracy50: 0.3649 - 6s/epoch - 29ms/step
Epoch 7/50
220/220 - 6s - loss: 12.9083 - accuracy10: 0.4264 - accuracy20: 0.4129 - accuracy30: 0.3993 - accuracy50: 0.3857 - val_loss: 13.0596 - val_accuracy10: 0.3918 - val_accuracy20: 0.3852 - val_accuracy30: 0.3822 - val_accuracy50: 0.3695 - 6s/epoch - 29ms/step
Epoch 8/50
220/220 - 6s - loss: 12.9032 - accuracy10: 0.4263 - accuracy20: 0.4142 - accuracy30: 0.3991 - accuracy50: 0.3859 - val_loss: 13.0961 - val_accuracy10: 0.3721 - val_accuracy20: 0.3723 - val_accuracy30: 0.3750 - val_accuracy50: 0.3606 - 6s/epoch - 29ms/step
Epoch 9/50
220/220 - 6s - loss: 12.8898 - accuracy10: 0.4302 - accuracy20: 0.4164 - accuracy30: 0.4015 - accuracy50: 0.3878 - val_loss: 13.1258 - val_accuracy10: 0.3643 - val_accuracy20: 0.3657 - val_accuracy30: 0.3685 - val_accuracy50: 0.3609 - 6s/epoch - 29ms/step
Epoch 10/50
220/220 - 6s - loss: 12.8730 - accuracy10: 0.4306 - accuracy20: 0.4161 - accuracy30: 0.4006 - accuracy50: 0.3879 - val_loss: 13.0476 - val_accuracy10: 0.3897 - val_accuracy20: 0.3862 - val_accuracy30: 0.3831 - val_accuracy50: 0.3700 - 6s/epoch - 29ms/step
Epoch 11/50
220/220 - 6s - loss: 12.8545 - accuracy10: 0.4341 - accuracy20: 0.4201 - accuracy30: 0.4043 - accuracy50: 0.3894 - val_loss: 13.0841 - val_accuracy10: 0.3977 - val_accuracy20: 0.3894 - val_accuracy30: 0.3837 - val_accuracy50: 0.3693 - 6s/epoch - 29ms/step
Epoch 12/50
220/220 - 6s - loss: 12.8495 - accuracy10: 0.4366 - accuracy20: 0.4215 - accuracy30: 0.4068 - accuracy50: 0.3910 - val_loss: 13.1051 - val_accuracy10: 0.3600 - val_accuracy20: 0.3662 - val_accuracy30: 0.3757 - val_accuracy50: 0.3697 - 6s/epoch - 29ms/step
Epoch 13/50
220/220 - 6s - loss: 12.8305 - accuracy10: 0.4392 - accuracy20: 0.4226 - accuracy30: 0.4083 - accuracy50: 0.3951 - val_loss: 13.0392 - val_accuracy10: 0.4030 - val_accuracy20: 0.3999 - val_accuracy30: 0.3918 - val_accuracy50: 0.3773 - 6s/epoch - 29ms/step
Epoch 14/50
220/220 - 6s - loss: 12.8233 - accuracy10: 0.4400 - accuracy20: 0.4250 - accuracy30: 0.4092 - accuracy50: 0.3944 - val_loss: 13.0416 - val_accuracy10: 0.4038 - val_accuracy20: 0.3961 - val_accuracy30: 0.3885 - val_accuracy50: 0.3731 - 6s/epoch - 29ms/step
Epoch 15/50
220/220 - 6s - loss: 12.8078 - accuracy10: 0.4441 - accuracy20: 0.4278 - accuracy30: 0.4125 - accuracy50: 0.3971 - val_loss: 13.0582 - val_accuracy10: 0.3929 - val_accuracy20: 0.3905 - val_accuracy30: 0.3869 - val_accuracy50: 0.3747 - 6s/epoch - 28ms/step
Epoch 16/50
220/220 - 6s - loss: 12.7870 - accuracy10: 0.4468 - accuracy20: 0.4301 - accuracy30: 0.4143 - accuracy50: 0.3988 - val_loss: 13.0892 - val_accuracy10: 0.3956 - val_accuracy20: 0.3868 - val_accuracy30: 0.3835 - val_accuracy50: 0.3751 - 6s/epoch - 28ms/step
Epoch 17/50
220/220 - 6s - loss: 12.7783 - accuracy10: 0.4487 - accuracy20: 0.4328 - accuracy30: 0.4160 - accuracy50: 0.3985 - val_loss: 13.1231 - val_accuracy10: 0.3759 - val_accuracy20: 0.3783 - val_accuracy30: 0.3773 - val_accuracy50: 0.3623 - 6s/epoch - 28ms/step
Epoch 18/50
220/220 - 6s - loss: 12.7667 - accuracy10: 0.4493 - accuracy20: 0.4332 - accuracy30: 0.4161 - accuracy50: 0.3996 - val_loss: 13.1303 - val_accuracy10: 0.3757 - val_accuracy20: 0.3762 - val_accuracy30: 0.3753 - val_accuracy50: 0.3672 - 6s/epoch - 29ms/step
Epoch 19/50
220/220 - 6s - loss: 12.7607 - accuracy10: 0.4501 - accuracy20: 0.4336 - accuracy30: 0.4183 - accuracy50: 0.4012 - val_loss: 13.2047 - val_accuracy10: 0.3571 - val_accuracy20: 0.3617 - val_accuracy30: 0.3649 - val_accuracy50: 0.3564 - 6s/epoch - 29ms/step
Epoch 20/50
220/220 - 6s - loss: 12.7502 - accuracy10: 0.4499 - accuracy20: 0.4350 - accuracy30: 0.4186 - accuracy50: 0.4037 - val_loss: 13.3019 - val_accuracy10: 0.3441 - val_accuracy20: 0.3489 - val_accuracy30: 0.3501 - val_accuracy50: 0.3506 - 6s/epoch - 28ms/step
Epoch 21/50
220/220 - 6s - loss: 12.7411 - accuracy10: 0.4537 - accuracy20: 0.4375 - accuracy30: 0.4192 - accuracy50: 0.4036 - val_loss: 13.3491 - val_accuracy10: 0.3426 - val_accuracy20: 0.3446 - val_accuracy30: 0.3443 - val_accuracy50: 0.3423 - 6s/epoch - 28ms/step
Epoch 22/50
220/220 - 6s - loss: 12.7332 - accuracy10: 0.4511 - accuracy20: 0.4363 - accuracy30: 0.4198 - accuracy50: 0.4063 - val_loss: 13.3652 - val_accuracy10: 0.3411 - val_accuracy20: 0.3468 - val_accuracy30: 0.3489 - val_accuracy50: 0.3382 - 6s/epoch - 28ms/step
Epoch 23/50
220/220 - 6s - loss: 12.7167 - accuracy10: 0.4536 - accuracy20: 0.4395 - accuracy30: 0.4221 - accuracy50: 0.4058 - val_loss: 13.2914 - val_accuracy10: 0.3512 - val_accuracy20: 0.3526 - val_accuracy30: 0.3516 - val_accuracy50: 0.3458 - 6s/epoch - 28ms/step
testing model: results/XRAY/W10/deepLOB_L1/seq2seq
Evaluating performance on  test set...
967/967 - 13s - 13s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0902237
{'0': {'precision': 0.42091125810025853, 'recall': 0.41991022978495346, 'f1-score': 0.4204101480624444, 'support': 89562}, '1': {'precision': 0.3019951960796147, 'recall': 0.36105459110784016, 'f1-score': 0.3288946143835526, 'support': 69297}, '2': {'precision': 0.44428664339469875, 'recall': 0.37745827695083445, 'f1-score': 0.40815505331634366, 'support': 88680}, 'accuracy': 0.38822569372906895, 'macro avg': {'precision': 0.3890643658581907, 'recall': 0.3861410326145427, 'f1-score': 0.38581993858744684, 'support': 247539}, 'weighted avg': {'precision': 0.3959955996305483, 'recall': 0.38822569372906895, 'f1-score': 0.3904005991047837, 'support': 247539}}
[[37608 30111 21843]
 [24252 25020 20025]
 [27489 27718 33473]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.093756
{'0': {'precision': 0.39720877638470087, 'recall': 0.4577303797178977, 'f1-score': 0.4253273996027658, 'support': 87486}, '1': {'precision': 0.31614842946435634, 'recall': 0.2661170014385423, 'f1-score': 0.2889832285873394, 'support': 75076}, '2': {'precision': 0.4039364045589503, 'recall': 0.3970486131541476, 'f1-score': 0.40046289427613424, 'support': 84977}, 'accuracy': 0.3787847571493785, 'macro avg': {'precision': 0.3724312034693358, 'recall': 0.3736319981035292, 'f1-score': 0.37159117415541315, 'support': 247539}, 'weighted avg': {'precision': 0.3749335270460973, 'recall': 0.3787847571493785, 'f1-score': 0.37543996347231634, 'support': 247539}}
[[40045 22852 24589]
 [29898 19979 25199]
 [30873 20364 33740]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0975198
{'0': {'precision': 0.384494347276415, 'recall': 0.4850327569787854, 'f1-score': 0.42895121357253024, 'support': 87157}, '1': {'precision': 0.31630719441309857, 'recall': 0.19428750784682988, 'f1-score': 0.24071748588280092, 'support': 76464}, '2': {'precision': 0.3840551724137931, 'recall': 0.41475011320574845, 'f1-score': 0.3988128999730725, 'support': 83918}, 'accuracy': 0.37139602244494807, 'macro avg': {'precision': 0.36161890470110225, 'recall': 0.36469012601045453, 'f1-score': 0.3561605331428012, 'support': 247539}, 'weighted avg': {'precision': 0.3632826710045462, 'recall': 0.37139602244494807, 'f1-score': 0.3605892554378252, 'support': 247539}}
[[42274 17003 27880]
 [33668 14856 27940]
 [34005 15108 34805]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0993851
{'0': {'precision': 0.388784598109051, 'recall': 0.5023702981702184, 'f1-score': 0.4383386890236536, 'support': 90284}, '1': {'precision': 0.3076392283143095, 'recall': 0.146691892188314, 'f1-score': 0.19865766827882625, 'support': 72942}, '2': {'precision': 0.3705734830431751, 'recall': 0.4223666575735652, 'f1-score': 0.3947785599467879, 'support': 84313}, 'accuracy': 0.37031336476272425, 'macro avg': {'precision': 0.35566576982217857, 'recall': 0.3571429493106992, 'f1-score': 0.34392497241642256, 'support': 247539}, 'weighted avg': {'precision': 0.35867080065443885, 'recall': 0.37031336476272425, 'f1-score': 0.35287539565159115, 'support': 247539}}
[[45356 12943 31985]
 [33741 10700 28501]
 [37564 11138 35611]]
Evaluating performance on  train set...
220/220 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.074701
{'0': {'precision': 0.4155523458975912, 'recall': 0.4751225229064564, 'f1-score': 0.4433453460917112, 'support': 18772}, '1': {'precision': 0.3603877589811823, 'recall': 0.3079255088783023, 'f1-score': 0.33209750401401256, 'support': 18472}, '2': {'precision': 0.4374047005625953, 'recall': 0.4373587087955418, 'f1-score': 0.4373817034700315, 'support': 19021}, 'accuracy': 0.407464676086377, 'macro avg': {'precision': 0.4044482684804563, 'recall': 0.4068022468601002, 'f1-score': 0.40427485119191847, 'support': 56265}, 'weighted avg': {'precision': 0.40482904346380705, 'recall': 0.407464676086377, 'f1-score': 0.4048062083477102, 'support': 56265}}
[[8919 5224 4629]
 [6713 5688 6071]
 [5831 4871 8319]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0815747
{'0': {'precision': 0.3993243243243243, 'recall': 0.5076774401374423, 'f1-score': 0.4470287902425188, 'support': 18626}, '1': {'precision': 0.3555852619266438, 'recall': 0.229706390328152, 'f1-score': 0.27910942059874744, 'support': 18528}, '2': {'precision': 0.42054714784633296, 'recall': 0.4536654282873738, 'f1-score': 0.4364789689631737, 'support': 19111}, 'accuracy': 0.3977961432506887, 'macro avg': {'precision': 0.391818911365767, 'recall': 0.39701641958432266, 'f1-score': 0.38753905993481325, 'support': 56265}, 'weighted avg': {'precision': 0.3921296568085486, 'recall': 0.3977961432506887, 'f1-score': 0.38814977637547243, 'support': 56265}}
[[9456 4045 5125]
 [7451 4256 6821]
 [6773 3668 8670]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0876325
{'0': {'precision': 0.38376515331590205, 'recall': 0.5223228728566807, 'f1-score': 0.4424499862976157, 'support': 18546}, '1': {'precision': 0.35859602056785156, 'recall': 0.17296597832533564, 'f1-score': 0.2333684937984214, 'support': 18547}, '2': {'precision': 0.4060787244643747, 'recall': 0.4676090131441686, 'f1-score': 0.43467720429586176, 'support': 19172}, 'accuracy': 0.3885186172576202, 'macro avg': {'precision': 0.3828132994493761, 'recall': 0.3876326214420616, 'f1-score': 0.37016522813063296, 'support': 56265}, 'weighted avg': {'precision': 0.3830717183382148, 'recall': 0.3885186172576202, 'f1-score': 0.37088055205038944, 'support': 56265}}
[[9687 3010 5849]
 [8076 3208 7263]
 [7479 2728 8965]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0927542
{'0': {'precision': 0.3698220371071564, 'recall': 0.5270058814007447, 'f1-score': 0.4346394321696371, 'support': 18533}, '1': {'precision': 0.36720968465102377, 'recall': 0.13221761825324221, 'f1-score': 0.19442905752947695, 'support': 18583}, '2': {'precision': 0.38801588672077364, 'recall': 0.4693717687607708, 'f1-score': 0.42483397537399853, 'support': 19149}, 'accuracy': 0.37700168843863857, 'macro avg': {'precision': 0.3750158694929846, 'recall': 0.3761984228049193, 'f1-score': 0.35130082169103755, 'support': 56265}, 'weighted avg': {'precision': 0.3751512591912023, 'recall': 0.37700168843863857, 'f1-score': 0.35196647235238343, 'support': 56265}}
[[9767 2229 6537]
 [8487 2457 7639]
 [8156 2005 8988]]
Evaluating performance on  val set...
79/79 - 1s - 1s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0817256
{'0': {'precision': 0.42780678851174936, 'recall': 0.46574758385446274, 'f1-score': 0.4459716929776811, 'support': 7036}, '1': {'precision': 0.306218487394958, 'recall': 0.29780974174566854, 'f1-score': 0.30195558501823005, 'support': 6118}, '2': {'precision': 0.44345655903915143, 'recall': 0.41400902868792777, 'f1-score': 0.42822714264196415, 'support': 6867}, 'accuracy': 0.3966834823435393, 'macro avg': {'precision': 0.39249394498195295, 'recall': 0.39252211809601967, 'f1-score': 0.39205147354595843, 'support': 20021}, 'weighted avg': {'precision': 0.39601965240361997, 'recall': 0.3966834823435393, 'f1-score': 0.3958771734406305, 'support': 20021}}
[[3277 2200 1559]
 [2287 1822 2009]
 [2096 1928 2843]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0843158
{'0': {'precision': 0.4093071834745271, 'recall': 0.5094612162357359, 'f1-score': 0.45392535392535394, 'support': 6923}, '1': {'precision': 0.31307856634227393, 'recall': 0.20896704689480355, 'f1-score': 0.2506413301662708, 'support': 6312}, '2': {'precision': 0.4171881518564873, 'recall': 0.4420866489832007, 'f1-score': 0.42927666881305, 'support': 6786}, 'accuracy': 0.39188851705709005, 'macro avg': {'precision': 0.3798579672244295, 'recall': 0.38683830403791336, 'f1-score': 0.37794778430155823, 'support': 20021}, 'weighted avg': {'precision': 0.3816404945030072, 'recall': 0.39188851705709005, 'f1-score': 0.3814816830228302, 'support': 20021}}
[[3527 1541 1855]
 [2657 1319 2336]
 [2433 1353 3000]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0880073
{'0': {'precision': 0.3985687954027973, 'recall': 0.5306004618937644, 'f1-score': 0.45520401213547146, 'support': 6928}, '1': {'precision': 0.33254076086956524, 'recall': 0.15444076352737024, 'f1-score': 0.21092319293331896, 'support': 6339}, '2': {'precision': 0.4062897886427298, 'recall': 0.4724607639917086, 'f1-score': 0.43688389923329685, 'support': 6754}, 'accuracy': 0.39188851705709005, 'macro avg': {'precision': 0.37913311497169744, 'recall': 0.3858339964709478, 'f1-score': 0.3676703681006958, 'support': 20021}, 'weighted avg': {'precision': 0.3802678053142076, 'recall': 0.39188851705709005, 'f1-score': 0.37168020436044863, 'support': 20021}}
[[3676 1063 2189]
 [2886  979 2474]
 [2661  902 3191]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0944921
{'0': {'precision': 0.38242599875802114, 'recall': 0.5354296478771192, 'f1-score': 0.44617520980498704, 'support': 6901}, '1': {'precision': 0.3393665158371041, 'recall': 0.10646687697160884, 'f1-score': 0.16208428382759035, 'support': 6340}, '2': {'precision': 0.3884109916367981, 'recall': 0.4794985250737463, 'f1-score': 0.4291749174917492, 'support': 6780}, 'accuracy': 0.38065031716697467, 'macro avg': {'precision': 0.3700678354106411, 'recall': 0.3737983499741581, 'f1-score': 0.3458114703747755, 'support': 20021}, 'weighted avg': {'precision': 0.37081724445001923, 'recall': 0.38065031716697467, 'f1-score': 0.35045579256406767, 'support': 20021}}
[[3695  718 2488]
 [3034  675 2631]
 [2933  596 3251]]
training model: results/XRAY/W10/deepOF_L1/seq2seq
Epoch 1/50
220/220 - 11s - loss: 13.2306 - accuracy10: 0.3650 - accuracy20: 0.3614 - accuracy30: 0.3585 - accuracy50: 0.3558 - val_loss: 13.3142 - val_accuracy10: 0.3813 - val_accuracy20: 0.3780 - val_accuracy30: 0.3792 - val_accuracy50: 0.3737 - 11s/epoch - 52ms/step
Epoch 2/50
220/220 - 6s - loss: 13.0899 - accuracy10: 0.3884 - accuracy20: 0.3831 - accuracy30: 0.3806 - accuracy50: 0.3756 - val_loss: 13.2589 - val_accuracy10: 0.3830 - val_accuracy20: 0.3801 - val_accuracy30: 0.3824 - val_accuracy50: 0.3768 - 6s/epoch - 27ms/step
Epoch 3/50
220/220 - 6s - loss: 13.0521 - accuracy10: 0.3927 - accuracy20: 0.3878 - accuracy30: 0.3839 - accuracy50: 0.3791 - val_loss: 13.2360 - val_accuracy10: 0.3826 - val_accuracy20: 0.3790 - val_accuracy30: 0.3820 - val_accuracy50: 0.3796 - 6s/epoch - 26ms/step
Epoch 4/50
220/220 - 6s - loss: 13.0254 - accuracy10: 0.3930 - accuracy20: 0.3873 - accuracy30: 0.3858 - accuracy50: 0.3822 - val_loss: 13.1968 - val_accuracy10: 0.3887 - val_accuracy20: 0.3835 - val_accuracy30: 0.3863 - val_accuracy50: 0.3838 - 6s/epoch - 27ms/step
Epoch 5/50
220/220 - 6s - loss: 13.0142 - accuracy10: 0.3934 - accuracy20: 0.3896 - accuracy30: 0.3902 - accuracy50: 0.3855 - val_loss: 13.1455 - val_accuracy10: 0.3900 - val_accuracy20: 0.3859 - val_accuracy30: 0.3861 - val_accuracy50: 0.3825 - 6s/epoch - 27ms/step
Epoch 6/50
220/220 - 6s - loss: 13.0048 - accuracy10: 0.3962 - accuracy20: 0.3913 - accuracy30: 0.3890 - accuracy50: 0.3856 - val_loss: 13.1128 - val_accuracy10: 0.3916 - val_accuracy20: 0.3864 - val_accuracy30: 0.3875 - val_accuracy50: 0.3823 - 6s/epoch - 26ms/step
Epoch 7/50
220/220 - 6s - loss: 12.9945 - accuracy10: 0.3979 - accuracy20: 0.3916 - accuracy30: 0.3919 - accuracy50: 0.3868 - val_loss: 13.1095 - val_accuracy10: 0.3903 - val_accuracy20: 0.3869 - val_accuracy30: 0.3892 - val_accuracy50: 0.3844 - 6s/epoch - 26ms/step
Epoch 8/50
220/220 - 6s - loss: 12.9870 - accuracy10: 0.3990 - accuracy20: 0.3921 - accuracy30: 0.3906 - accuracy50: 0.3863 - val_loss: 13.0793 - val_accuracy10: 0.3889 - val_accuracy20: 0.3847 - val_accuracy30: 0.3884 - val_accuracy50: 0.3844 - 6s/epoch - 26ms/step
Epoch 9/50
220/220 - 6s - loss: 12.9757 - accuracy10: 0.4016 - accuracy20: 0.3943 - accuracy30: 0.3971 - accuracy50: 0.3898 - val_loss: 13.1007 - val_accuracy10: 0.3908 - val_accuracy20: 0.3888 - val_accuracy30: 0.3906 - val_accuracy50: 0.3853 - 6s/epoch - 26ms/step
Epoch 10/50
220/220 - 6s - loss: 12.9707 - accuracy10: 0.4011 - accuracy20: 0.3960 - accuracy30: 0.3961 - accuracy50: 0.3917 - val_loss: 13.0727 - val_accuracy10: 0.3929 - val_accuracy20: 0.3870 - val_accuracy30: 0.3885 - val_accuracy50: 0.3829 - 6s/epoch - 27ms/step
Epoch 11/50
220/220 - 6s - loss: 12.9571 - accuracy10: 0.4018 - accuracy20: 0.3970 - accuracy30: 0.3957 - accuracy50: 0.3925 - val_loss: 13.0746 - val_accuracy10: 0.3920 - val_accuracy20: 0.3882 - val_accuracy30: 0.3908 - val_accuracy50: 0.3844 - 6s/epoch - 26ms/step
Epoch 12/50
220/220 - 6s - loss: 12.9505 - accuracy10: 0.4038 - accuracy20: 0.3996 - accuracy30: 0.3989 - accuracy50: 0.3916 - val_loss: 13.1051 - val_accuracy10: 0.3913 - val_accuracy20: 0.3836 - val_accuracy30: 0.3852 - val_accuracy50: 0.3820 - 6s/epoch - 26ms/step
Epoch 13/50
220/220 - 6s - loss: 12.9392 - accuracy10: 0.4056 - accuracy20: 0.3968 - accuracy30: 0.3982 - accuracy50: 0.3939 - val_loss: 13.1080 - val_accuracy10: 0.3888 - val_accuracy20: 0.3844 - val_accuracy30: 0.3853 - val_accuracy50: 0.3822 - 6s/epoch - 26ms/step
Epoch 14/50
220/220 - 6s - loss: 12.9341 - accuracy10: 0.4063 - accuracy20: 0.3973 - accuracy30: 0.3991 - accuracy50: 0.3932 - val_loss: 13.0998 - val_accuracy10: 0.3875 - val_accuracy20: 0.3851 - val_accuracy30: 0.3867 - val_accuracy50: 0.3804 - 6s/epoch - 26ms/step
Epoch 15/50
220/220 - 6s - loss: 12.9152 - accuracy10: 0.4079 - accuracy20: 0.4025 - accuracy30: 0.4019 - accuracy50: 0.3999 - val_loss: 13.1062 - val_accuracy10: 0.3902 - val_accuracy20: 0.3838 - val_accuracy30: 0.3858 - val_accuracy50: 0.3790 - 6s/epoch - 26ms/step
Epoch 16/50
220/220 - 6s - loss: 12.9013 - accuracy10: 0.4089 - accuracy20: 0.4048 - accuracy30: 0.4045 - accuracy50: 0.3989 - val_loss: 13.1071 - val_accuracy10: 0.3911 - val_accuracy20: 0.3856 - val_accuracy30: 0.3855 - val_accuracy50: 0.3802 - 6s/epoch - 26ms/step
Epoch 17/50
220/220 - 6s - loss: 12.8973 - accuracy10: 0.4089 - accuracy20: 0.4045 - accuracy30: 0.4038 - accuracy50: 0.3976 - val_loss: 13.1023 - val_accuracy10: 0.3893 - val_accuracy20: 0.3834 - val_accuracy30: 0.3853 - val_accuracy50: 0.3796 - 6s/epoch - 26ms/step
Epoch 18/50
220/220 - 6s - loss: 12.8922 - accuracy10: 0.4098 - accuracy20: 0.4064 - accuracy30: 0.4055 - accuracy50: 0.3989 - val_loss: 13.1216 - val_accuracy10: 0.3882 - val_accuracy20: 0.3828 - val_accuracy30: 0.3840 - val_accuracy50: 0.3773 - 6s/epoch - 27ms/step
Epoch 19/50
220/220 - 6s - loss: 12.8838 - accuracy10: 0.4085 - accuracy20: 0.4081 - accuracy30: 0.4074 - accuracy50: 0.3998 - val_loss: 13.1273 - val_accuracy10: 0.3904 - val_accuracy20: 0.3844 - val_accuracy30: 0.3836 - val_accuracy50: 0.3796 - 6s/epoch - 27ms/step
Epoch 20/50
220/220 - 6s - loss: 12.8712 - accuracy10: 0.4123 - accuracy20: 0.4114 - accuracy30: 0.4106 - accuracy50: 0.4026 - val_loss: 13.1415 - val_accuracy10: 0.3915 - val_accuracy20: 0.3831 - val_accuracy30: 0.3823 - val_accuracy50: 0.3779 - 6s/epoch - 26ms/step
testing model: results/XRAY/W10/deepOF_L1/seq2seq
Evaluating performance on  test set...
967/967 - 12s - 12s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0845692
{'0': {'precision': 0.3952764316606743, 'recall': 0.6775940420495529, 'f1-score': 0.4992903833575358, 'support': 89561}, '1': {'precision': 0.3486238532110092, 'recall': 0.008773828592868379, 'f1-score': 0.01711687617009896, 'support': 69297}, '2': {'precision': 0.41004964123908, 'recall': 0.42663178312057376, 'f1-score': 0.41817639191325207, 'support': 88676}, 'accuracy': 0.4004540790356072, 'macro avg': {'precision': 0.3846499753702545, 'recall': 0.370999884587665, 'f1-score': 0.31152788381362895, 'support': 247534}, 'weighted avg': {'precision': 0.3875083893058796, 'recall': 0.4004540790356072, 'f1-score': 0.33524810297229124, 'support': 247534}}
[[60686   508 28367]
 [42626   608 26063]
 [50216   628 37832]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0861441
{'0': {'precision': 0.39350657766832997, 'recall': 0.6940847002343259, 'f1-score': 0.5022601790773176, 'support': 87485}, '1': {'precision': 0.3220338983050847, 'recall': 0.0007592306462784378, 'f1-score': 0.0015148897718363387, 'support': 75076}, '2': {'precision': 0.4068159102389115, 'recall': 0.4454709142904217, 'f1-score': 0.4252668239523649, 'support': 84973}, 'accuracy': 0.3984583935944153, 'macro avg': {'precision': 0.37411879540410875, 'recall': 0.38010494839034203, 'f1-score': 0.30968063093383963, 'support': 247534}, 'weighted avg': {'precision': 0.3763980230481364, 'recall': 0.3984583935944153, 'f1-score': 0.3239561493079489, 'support': 247534}}
[[60722    47 26716]
 [46541    57 28478]
 [47047    73 37853]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0869111
{'0': {'precision': 0.39256801937196906, 'recall': 0.6938133920785717, 'f1-score': 0.5014241706848872, 'support': 87156}, '1': {'precision': 0.31978319783197834, 'recall': 0.0015432098765432098, 'f1-score': 0.003071596839899522, 'support': 76464}, '2': {'precision': 0.4044218709732841, 'recall': 0.44882856257597065, 'f1-score': 0.42546966256594476, 'support': 83914}, 'accuracy': 0.3969192110982734, 'macro avg': {'precision': 0.37225769605907716, 'recall': 0.38139505484369524, 'f1-score': 0.3099884766969105, 'support': 247534}, 'weighted avg': {'precision': 0.37410302268076256, 'recall': 0.3969192110982734, 'f1-score': 0.3217329856324254, 'support': 247534}}
[[60470   119 26567]
 [47448   118 28898]
 [46119   132 37663]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0876061
{'0': {'precision': 0.398578739772468, 'recall': 0.6771595981524761, 'f1-score': 0.5017975277837057, 'support': 90283}, '1': {'precision': 0.28162511542012925, 'recall': 0.00418140440349867, 'f1-score': 0.00824045930428909, 'support': 72942}, '2': {'precision': 0.4014033051812692, 'recall': 0.4430962293468076, 'f1-score': 0.4212205778717407, 'support': 84309}, 'accuracy': 0.3991290085402409, 'macro avg': {'precision': 0.3605357201246222, 'recall': 0.37481241063426074, 'f1-score': 0.31041952165324516, 'support': 247534}, 'weighted avg': {'precision': 0.36507750364952046, 'recall': 0.3991290085402409, 'f1-score': 0.32891460358277386, 'support': 247534}}
[[61136   406 28741]
 [45669   305 26968]
 [46580   372 37357]]
Evaluating performance on  train set...
220/220 - 3s - 3s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0819913
{'0': {'precision': 0.3747514098128422, 'recall': 0.7371523498204812, 'f1-score': 0.4968935124981939, 'support': 18661}, '1': {'precision': 0.36684303350970016, 'recall': 0.01127554615926709, 'f1-score': 0.021878615756810774, 'support': 18447}, '2': {'precision': 0.427766366461263, 'recall': 0.42405889416801545, 'f1-score': 0.4259045621394861, 'support': 19153}, 'accuracy': 0.3925632320790601, 'macro avg': {'precision': 0.3897869365946018, 'recall': 0.3908289300492546, 'f1-score': 0.3148922301314969, 'support': 56261}, 'weighted avg': {'precision': 0.39020633679642125, 'recall': 0.3925632320790601, 'f1-score': 0.31697756421414947, 'support': 56261}}
[[13756   154  4751]
 [12125   208  6114]
 [10826   205  8122]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.084883
{'0': {'precision': 0.37368320766529656, 'recall': 0.7404131384499218, 'f1-score': 0.4966894605448823, 'support': 18541}, '1': {'precision': 0.3225806451612903, 'recall': 0.000536711034778875, 'f1-score': 0.0010716390719605637, 'support': 18632}, '2': {'precision': 0.4218437387780229, 'recall': 0.4307942162615256, 'f1-score': 0.42627199917057623, 'support': 19088}, 'accuracy': 0.3903414443397736, 'macro avg': {'precision': 0.3727025305348699, 'recall': 0.3905813552487421, 'f1-score': 0.30801103292913967, 'support': 56261}, 'weighted avg': {'precision': 0.37309923783370946, 'recall': 0.3903414443397736, 'f1-score': 0.30866436763156346, 'support': 56261}}
[[13728     8  4805]
 [12157    10  6465]
 [10852    13  8223]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0858372
{'0': {'precision': 0.37523689197725835, 'recall': 0.7370124615633598, 'f1-score': 0.49728824664215765, 'support': 18537}, '1': {'precision': 0.4807692307692308, 'recall': 0.0013482903678136123, 'f1-score': 0.0026890394750994943, 'support': 18542}, '2': {'precision': 0.42404040404040405, 'recall': 0.43770201230320094, 'f1-score': 0.43076291621774154, 'support': 19182}, 'accuracy': 0.39250990917331724, 'macro avg': {'precision': 0.4266821755956311, 'recall': 0.3920209214114581, 'f1-score': 0.3102467341116662, 'support': 56261}, 'weighted avg': {'precision': 0.42665669600271144, 'recall': 0.39250990917331724, 'f1-score': 0.3116010496941343, 'support': 56261}}
[[13662    10  4865]
 [11978    25  6539]
 [10769    17  8396]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.090954
{'0': {'precision': 0.3698709945900957, 'recall': 0.7204539313699, 'f1-score': 0.48879926672777274, 'support': 18505}, '1': {'precision': 0.46616541353383456, 'recall': 0.0033333333333333335, 'f1-score': 0.0066193348636096735, 'support': 18600}, '2': {'precision': 0.409998506199273, 'recall': 0.42983921486740445, 'f1-score': 0.4196844975661969, 'support': 19156}, 'accuracy': 0.3844226018023142, 'macro avg': {'precision': 0.41534497144106775, 'recall': 0.38454215985687923, 'f1-score': 0.30503436638585973, 'support': 56261}, 'weighted avg': {'precision': 0.41536892041329365, 'recall': 0.3844226018023142, 'f1-score': 0.30585709984960535, 'support': 56261}}
[[13332    30  5143]
 [11832    62  6706]
 [10881    41  8234]]
Evaluating performance on  val set...
79/79 - 1s - 1s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0852706
{'0': {'precision': 0.3834402248324566, 'recall': 0.7512353522518707, 'f1-score': 0.5077290076335877, 'support': 7083}, '1': {'precision': 0.40217391304347827, 'recall': 0.012046231482988768, 'f1-score': 0.023391812865497078, 'support': 6143}, '2': {'precision': 0.4236577181208054, 'recall': 0.37159676232523914, 'f1-score': 0.39592316738533906, 'support': 6795}, 'accuracy': 0.39558463613206135, 'macro avg': {'precision': 0.4030906186655801, 'recall': 0.37829278202003286, 'f1-score': 0.3090146626281413, 'support': 20021}, 'weighted avg': {'precision': 0.40283780305405575, 'recall': 0.39558463613206135, 'f1-score': 0.3211746860738639, 'support': 20021}}
[[5321   53 1709]
 [4343   74 1726]
 [4213   57 2525]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0881984
{'0': {'precision': 0.37710340860060404, 'recall': 0.7547495682210709, 'f1-score': 0.5029250983024839, 'support': 6948}, '1': {'precision': 0.25, 'recall': 0.0003189792663476874, 'f1-score': 0.0006371455877668047, 'support': 6270}, '2': {'precision': 0.4132962174553791, 'recall': 0.3710127884756725, 'f1-score': 0.39101471727343146, 'support': 6803}, 'accuracy': 0.38809250287198443, 'macro avg': {'precision': 0.34679987535199436, 'recall': 0.37536044532103036, 'f1-score': 0.29819232038789406, 'support': 20021}, 'weighted avg': {'precision': 0.3495963563411389, 'recall': 0.38809250287198443, 'f1-score': 0.3075966039384701, 'support': 20021}}
[[5244    4 1700]
 [4385    2 1883]
 [4277    2 2524]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0890567
{'0': {'precision': 0.38163132373163494, 'recall': 0.7594699697537087, 'f1-score': 0.5079961464354528, 'support': 6943}, '1': {'precision': 0.38461538461538464, 'recall': 0.00078976465013426, 'f1-score': 0.0015762925598991173, 'support': 6331}, '2': {'precision': 0.40397350993377484, 'recall': 0.3706832666370239, 'f1-score': 0.38661307775544906, 'support': 6747}, 'accuracy': 0.38854203086758904, 'macro avg': {'precision': 0.39007340609359814, 'recall': 0.3769810003469556, 'f1-score': 0.2987285055836003, 'support': 20021}, 'weighted avg': {'precision': 0.39010416823295146, 'recall': 0.38854203086758904, 'f1-score': 0.3069514603922923, 'support': 20021}}
[[5273    4 1666]
 [4302    5 2024]
 [4242    4 2501]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0920885
{'0': {'precision': 0.37765802505097584, 'recall': 0.7486646455897213, 'f1-score': 0.5020572147732223, 'support': 6927}, '1': {'precision': 0.358974358974359, 'recall': 0.0022197558268590455, 'f1-score': 0.0044122281752284895, 'support': 6307}, '2': {'precision': 0.39424, 'recall': 0.36304700162074555, 'f1-score': 0.3780010738666871, 'support': 6787}, 'accuracy': 0.3827980620348634, 'macro avg': {'precision': 0.37695746134177827, 'recall': 0.37131046767910864, 'f1-score': 0.29482350560504594, 'support': 20021}, 'weighted avg': {'precision': 0.3773935019019725, 'recall': 0.3827980620348634, 'f1-score': 0.3032351799694562, 'support': 20021}}
[[5186   13 1728]
 [4235   14 2058]
 [4311   12 2464]]
training model: results/XRAY/W10/deepLOB_L2/seq2seq
Epoch 1/50
220/220 - 17s - loss: 13.2761 - accuracy10: 0.3634 - accuracy20: 0.3578 - accuracy30: 0.3545 - accuracy50: 0.3574 - val_loss: 13.7692 - val_accuracy10: 0.3124 - val_accuracy20: 0.3204 - val_accuracy30: 0.3253 - val_accuracy50: 0.3280 - 17s/epoch - 79ms/step
Epoch 2/50
220/220 - 12s - loss: 13.1324 - accuracy10: 0.3781 - accuracy20: 0.3722 - accuracy30: 0.3646 - accuracy50: 0.3692 - val_loss: 13.6559 - val_accuracy10: 0.3233 - val_accuracy20: 0.3307 - val_accuracy30: 0.3337 - val_accuracy50: 0.3318 - 12s/epoch - 52ms/step
Epoch 3/50
220/220 - 11s - loss: 13.0230 - accuracy10: 0.4011 - accuracy20: 0.3919 - accuracy30: 0.3845 - accuracy50: 0.3805 - val_loss: 13.4304 - val_accuracy10: 0.3362 - val_accuracy20: 0.3442 - val_accuracy30: 0.3478 - val_accuracy50: 0.3471 - 11s/epoch - 52ms/step
Epoch 4/50
220/220 - 11s - loss: 12.9484 - accuracy10: 0.4192 - accuracy20: 0.4084 - accuracy30: 0.3966 - accuracy50: 0.3887 - val_loss: 13.2454 - val_accuracy10: 0.3429 - val_accuracy20: 0.3550 - val_accuracy30: 0.3553 - val_accuracy50: 0.3575 - 11s/epoch - 52ms/step
Epoch 5/50
220/220 - 11s - loss: 12.8777 - accuracy10: 0.4313 - accuracy20: 0.4196 - accuracy30: 0.4078 - accuracy50: 0.4004 - val_loss: 13.3375 - val_accuracy10: 0.3345 - val_accuracy20: 0.3437 - val_accuracy30: 0.3427 - val_accuracy50: 0.3463 - 11s/epoch - 52ms/step
Epoch 6/50
220/220 - 11s - loss: 12.8479 - accuracy10: 0.4370 - accuracy20: 0.4270 - accuracy30: 0.4149 - accuracy50: 0.4043 - val_loss: 13.2863 - val_accuracy10: 0.3470 - val_accuracy20: 0.3601 - val_accuracy30: 0.3579 - val_accuracy50: 0.3562 - 11s/epoch - 52ms/step
Epoch 7/50
220/220 - 11s - loss: 12.8117 - accuracy10: 0.4433 - accuracy20: 0.4310 - accuracy30: 0.4184 - accuracy50: 0.4082 - val_loss: 13.1878 - val_accuracy10: 0.3716 - val_accuracy20: 0.3740 - val_accuracy30: 0.3709 - val_accuracy50: 0.3645 - 11s/epoch - 52ms/step
Epoch 8/50
220/220 - 11s - loss: 12.7956 - accuracy10: 0.4452 - accuracy20: 0.4342 - accuracy30: 0.4214 - accuracy50: 0.4099 - val_loss: 13.2952 - val_accuracy10: 0.3806 - val_accuracy20: 0.3817 - val_accuracy30: 0.3766 - val_accuracy50: 0.3665 - 11s/epoch - 52ms/step
Epoch 9/50
220/220 - 11s - loss: 12.7827 - accuracy10: 0.4458 - accuracy20: 0.4343 - accuracy30: 0.4225 - accuracy50: 0.4096 - val_loss: 13.3649 - val_accuracy10: 0.3570 - val_accuracy20: 0.3600 - val_accuracy30: 0.3550 - val_accuracy50: 0.3505 - 11s/epoch - 52ms/step
Epoch 10/50
220/220 - 12s - loss: 12.7560 - accuracy10: 0.4530 - accuracy20: 0.4389 - accuracy30: 0.4235 - accuracy50: 0.4133 - val_loss: 13.2863 - val_accuracy10: 0.3713 - val_accuracy20: 0.3680 - val_accuracy30: 0.3637 - val_accuracy50: 0.3543 - 12s/epoch - 52ms/step
Epoch 11/50
220/220 - 11s - loss: 12.7330 - accuracy10: 0.4537 - accuracy20: 0.4403 - accuracy30: 0.4264 - accuracy50: 0.4173 - val_loss: 13.1910 - val_accuracy10: 0.3890 - val_accuracy20: 0.3869 - val_accuracy30: 0.3782 - val_accuracy50: 0.3695 - 11s/epoch - 52ms/step
Epoch 12/50
220/220 - 11s - loss: 12.6986 - accuracy10: 0.4575 - accuracy20: 0.4439 - accuracy30: 0.4292 - accuracy50: 0.4188 - val_loss: 13.4081 - val_accuracy10: 0.3667 - val_accuracy20: 0.3703 - val_accuracy30: 0.3615 - val_accuracy50: 0.3508 - 11s/epoch - 52ms/step
Epoch 13/50
220/220 - 12s - loss: 12.6841 - accuracy10: 0.4571 - accuracy20: 0.4462 - accuracy30: 0.4310 - accuracy50: 0.4193 - val_loss: 13.2952 - val_accuracy10: 0.3732 - val_accuracy20: 0.3722 - val_accuracy30: 0.3645 - val_accuracy50: 0.3579 - 12s/epoch - 53ms/step
Epoch 14/50
220/220 - 12s - loss: 12.6544 - accuracy10: 0.4597 - accuracy20: 0.4482 - accuracy30: 0.4328 - accuracy50: 0.4208 - val_loss: 13.2645 - val_accuracy10: 0.3685 - val_accuracy20: 0.3707 - val_accuracy30: 0.3578 - val_accuracy50: 0.3558 - 12s/epoch - 52ms/step
Epoch 15/50
220/220 - 11s - loss: 12.6296 - accuracy10: 0.4596 - accuracy20: 0.4495 - accuracy30: 0.4373 - accuracy50: 0.4257 - val_loss: 13.3120 - val_accuracy10: 0.3859 - val_accuracy20: 0.3835 - val_accuracy30: 0.3706 - val_accuracy50: 0.3560 - 11s/epoch - 52ms/step
Epoch 16/50
220/220 - 11s - loss: 12.6139 - accuracy10: 0.4624 - accuracy20: 0.4508 - accuracy30: 0.4367 - accuracy50: 0.4269 - val_loss: 13.3289 - val_accuracy10: 0.3854 - val_accuracy20: 0.3719 - val_accuracy30: 0.3620 - val_accuracy50: 0.3562 - 11s/epoch - 52ms/step
Epoch 17/50
220/220 - 12s - loss: 12.5713 - accuracy10: 0.4648 - accuracy20: 0.4543 - accuracy30: 0.4429 - accuracy50: 0.4308 - val_loss: 13.2930 - val_accuracy10: 0.4000 - val_accuracy20: 0.3881 - val_accuracy30: 0.3778 - val_accuracy50: 0.3640 - 12s/epoch - 52ms/step
testing model: results/XRAY/W10/deepLOB_L2/seq2seq
Evaluating performance on  test set...
967/967 - 20s - 20s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1501569
{'0': {'precision': 0.4886299567750423, 'recall': 0.058060338089814874, 'f1-score': 0.10378827192527243, 'support': 89562}, '1': {'precision': 0.2844998768355277, 'recall': 0.8166731604542765, 'f1-score': 0.42199255829213544, 'support': 69297}, '2': {'precision': 0.42250368653886666, 'recall': 0.18093143888137123, 'f1-score': 0.2533634411318848, 'support': 88680}, 'accuracy': 0.3144474204064814, 'macro avg': {'precision': 0.39854450671647884, 'recall': 0.35188831247515423, 'f1-score': 0.2597147571164309, 'support': 247539}, 'weighted avg': {'precision': 0.407795503237973, 'recall': 0.3144474204064814, 'f1-score': 0.24645237106765763, 'support': 247539}}
[[ 5200 72303 12059]
 [ 2832 56593  9872]
 [ 2610 70025 16045]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1360643
{'0': {'precision': 0.47419292480185576, 'recall': 0.05607754383558512, 'f1-score': 0.1002943822062311, 'support': 87486}, '1': {'precision': 0.3075241353577078, 'recall': 0.7794235175022644, 'f1-score': 0.44103603824282, 'support': 75076}, '2': {'precision': 0.3959541268758527, 'recall': 0.21858855925721077, 'f1-score': 0.28167625806549446, 'support': 84977}, 'accuracy': 0.3312488133183054, 'macro avg': {'precision': 0.3925570623451387, 'recall': 0.3513632068650201, 'f1-score': 0.2743355595048485, 'support': 247539}, 'weighted avg': {'precision': 0.39678562992037514, 'recall': 0.3312488133183054, 'f1-score': 0.2659038749871488, 'support': 247539}}
[[ 4906 67921 14659]
 [ 2882 58516 13678]
 [ 2558 63844 18575]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1301358
{'0': {'precision': 0.44621585311240486, 'recall': 0.05716121481923426, 'f1-score': 0.10134049348060455, 'support': 87157}, '1': {'precision': 0.3105006125311116, 'recall': 0.732553881565181, 'f1-score': 0.4361391091749299, 'support': 76464}, '2': {'precision': 0.3791871371147834, 'recall': 0.25292547486832384, 'f1-score': 0.30344620531406147, 'support': 83918}, 'accuracy': 0.3321537212318059, 'macro avg': {'precision': 0.3786345342527666, 'recall': 0.3475468570842464, 'f1-score': 0.28030860265653196, 'support': 247539}, 'weighted avg': {'precision': 0.3815705004815208, 'recall': 0.3321537212318059, 'f1-score': 0.2732744048080759, 'support': 247539}}
[[ 4982 64642 17533]
 [ 3233 56014 17217]
 [ 2950 59743 21225]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1334722
{'0': {'precision': 0.4440892077354959, 'recall': 0.06307872934296221, 'f1-score': 0.11046669511580093, 'support': 90284}, '1': {'precision': 0.2975913572229766, 'recall': 0.6910833264785721, 'f1-score': 0.4160325503854217, 'support': 72942}, '2': {'precision': 0.37040949100650594, 'recall': 0.2869901438686798, 'f1-score': 0.3234071559363263, 'support': 84313}, 'accuracy': 0.3243973676875159, 'macro avg': {'precision': 0.3706966853216595, 'recall': 0.34705073323007135, 'f1-score': 0.2833021338125163, 'support': 247539}, 'weighted avg': {'precision': 0.37582520017040305, 'recall': 0.324397367687516, 'f1-score': 0.2730359617292947, 'support': 247539}}
[[ 5695 62541 22048]
 [ 3453 50409 19080]
 [ 3676 56440 24197]]
Evaluating performance on  train set...
220/220 - 5s - 5s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0835857
{'0': {'precision': 0.43381476083211873, 'recall': 0.348817387598551, 'f1-score': 0.3867005256008977, 'support': 18772}, '1': {'precision': 0.3495708154506438, 'recall': 0.5291251624079688, 'f1-score': 0.4210027567195038, 'support': 18472}, '2': {'precision': 0.4453107259102263, 'recall': 0.3092897324010304, 'f1-score': 0.3650409530900968, 'support': 19021}, 'accuracy': 0.3946503154714298, 'macro avg': {'precision': 0.4095654340643296, 'recall': 0.3957440941358501, 'f1-score': 0.39091474513683283, 'support': 56265}, 'weighted avg': {'precision': 0.4100435103684927, 'recall': 0.3946503154714298, 'f1-score': 0.39063981440379375, 'support': 56265}}
[[6548 9058 3166]
 [4536 9774 4162]
 [4010 9128 5883]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0855311
{'0': {'precision': 0.4205198537095089, 'recall': 0.3456995597551809, 'f1-score': 0.37945665625552477, 'support': 18626}, '1': {'precision': 0.3484808454425363, 'recall': 0.4983268566493955, 'f1-score': 0.41014592541589856, 'support': 18528}, '2': {'precision': 0.43595241388850464, 'recall': 0.3298100570352153, 'f1-score': 0.375525037981471, 'support': 19111}, 'accuracy': 0.3905625166622234, 'macro avg': {'precision': 0.40165103768018334, 'recall': 0.39127882447993056, 'f1-score': 0.38837587321763145, 'support': 56265}, 'weighted avg': {'precision': 0.40203932251623287, 'recall': 0.3905625166622234, 'f1-score': 0.38822718184279864, 'support': 56265}}
[[6439 8628 3559]
 [4699 9233 4596]
 [4174 8634 6303]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0914234
{'0': {'precision': 0.4002937232616053, 'recall': 0.338024371832201, 'f1-score': 0.36653316572631334, 'support': 18546}, '1': {'precision': 0.34341097638800255, 'recall': 0.4642260203806546, 'f1-score': 0.3947820903734611, 'support': 18547}, '2': {'precision': 0.4278264228689158, 'recall': 0.34659920717713333, 'f1-score': 0.3829529737206086, 'support': 19172}, 'accuracy': 0.38254687638851864, 'macro avg': {'precision': 0.39051037417284123, 'recall': 0.3829498664633297, 'f1-score': 0.381422743273461, 'support': 56265}, 'weighted avg': {'precision': 0.3909247125196991, 'recall': 0.38254687638851864, 'f1-score': 0.38144000593420957, 'support': 56265}}
[[6269 8269 4008]
 [5058 8610 4879]
 [4334 8193 6645]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0926616
{'0': {'precision': 0.3915602304032056, 'recall': 0.3374521124480656, 'f1-score': 0.362498188668309, 'support': 18533}, '1': {'precision': 0.3516116767352457, 'recall': 0.44788247322821934, 'f1-score': 0.39395086855682304, 'support': 18583}, '2': {'precision': 0.4114426663458068, 'recall': 0.3571465872891535, 'f1-score': 0.382376785664365, 'support': 19149}, 'accuracy': 0.3806273882520217, 'macro avg': {'precision': 0.3848715244947527, 'recall': 0.3808270576551462, 'f1-score': 0.379608614296499, 'support': 56265}, 'weighted avg': {'precision': 0.3851328740191866, 'recall': 0.3806273882520217, 'f1-score': 0.37965166603871214, 'support': 56265}}
[[6254 7724 4555]
 [5032 8323 5228]
 [4686 7624 6839]]
Evaluating performance on  val set...
79/79 - 2s - 2s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1014129
{'0': {'precision': 0.4688427299703264, 'recall': 0.24701534963047186, 'f1-score': 0.3235595271339477, 'support': 7036}, '1': {'precision': 0.31543303322444427, 'recall': 0.6471068976789801, 'f1-score': 0.4241255557341047, 'support': 6118}, '2': {'precision': 0.4546904065904863, 'recall': 0.2491626620066987, 'f1-score': 0.32191909689557857, 'support': 6867}, 'accuracy': 0.3700114879376655, 'macro avg': {'precision': 0.41298872326175234, 'recall': 0.38109496977205026, 'f1-score': 0.35653472658787694, 'support': 20021}, 'weighted avg': {'precision': 0.4171098230555535, 'recall': 0.3700114879376655, 'f1-score': 0.3537277569191173, 'support': 20021}}
[[1738 4353  945]
 [1052 3959 1107]
 [ 917 4239 1711]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0976758
{'0': {'precision': 0.45813333333333334, 'recall': 0.248158312870143, 'f1-score': 0.3219338517755083, 'support': 6923}, '1': {'precision': 0.32914969661707255, 'recall': 0.6273764258555133, 'f1-score': 0.43177233822166494, 'support': 6312}, '2': {'precision': 0.4337264150943396, 'recall': 0.27099911582670205, 'f1-score': 0.33357518592417923, 'support': 6786}, 'accuracy': 0.37545577143998804, 'macro avg': {'precision': 0.4070031483482485, 'recall': 0.3821779515174528, 'f1-score': 0.36242712530711757, 'support': 20021}, 'weighted avg': {'precision': 0.40919621420227853, 'recall': 0.37545577143998804, 'f1-score': 0.36050827962531706, 'support': 20021}}
[[1718 4094 1111]
 [1062 3960 1290]
 [ 970 3977 1839]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1000205
{'0': {'precision': 0.4298382889932186, 'recall': 0.23787528868360278, 'f1-score': 0.30626277643560673, 'support': 6928}, '1': {'precision': 0.334167817679558, 'recall': 0.6106641426092444, 'f1-score': 0.43195893544607483, 'support': 6339}, '2': {'precision': 0.4238540082554855, 'recall': 0.28886585726976605, 'f1-score': 0.34357664876287747, 'support': 6754}, 'accuracy': 0.3731082363518306, 'macro avg': {'precision': 0.39595337164275407, 'recall': 0.3791350961875377, 'f1-score': 0.3605994535481864, 'support': 20021}, 'weighted avg': {'precision': 0.397528566713615, 'recall': 0.3731082363518306, 'f1-score': 0.35864806416677625, 'support': 20021}}
[[1648 3961 1319]
 [1135 3871 1333]
 [1051 3752 1951]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1024107
{'0': {'precision': 0.3994469582704877, 'recall': 0.23025648456745398, 'f1-score': 0.29212243772405555, 'support': 6901}, '1': {'precision': 0.3318308843414766, 'recall': 0.5805993690851735, 'f1-score': 0.42230252968508, 'support': 6340}, '2': {'precision': 0.4074747474747475, 'recall': 0.29749262536873156, 'f1-score': 0.3439045183290707, 'support': 6780}, 'accuracy': 0.36396783377453673, 'macro avg': {'precision': 0.37958419669557064, 'recall': 0.36944949300711966, 'f1-score': 0.35277649524606874, 'support': 20021}, 'weighted avg': {'precision': 0.3807537112845705, 'recall': 0.36396783377453673, 'f1-score': 0.3508819547079673, 'support': 20021}}
[[1589 3824 1488]
 [1214 3681 1445]
 [1175 3588 2017]]
training model: results/XRAY/W10/deepOF_L2/seq2seq
Epoch 1/50
220/220 - 13s - loss: 13.2360 - accuracy10: 0.3684 - accuracy20: 0.3614 - accuracy30: 0.3519 - accuracy50: 0.3507 - val_loss: 13.2148 - val_accuracy10: 0.3818 - val_accuracy20: 0.3745 - val_accuracy30: 0.3732 - val_accuracy50: 0.3695 - 13s/epoch - 58ms/step
Epoch 2/50
220/220 - 8s - loss: 13.0083 - accuracy10: 0.4075 - accuracy20: 0.3958 - accuracy30: 0.3887 - accuracy50: 0.3808 - val_loss: 13.1122 - val_accuracy10: 0.4081 - val_accuracy20: 0.3992 - val_accuracy30: 0.3912 - val_accuracy50: 0.3866 - 8s/epoch - 34ms/step
Epoch 3/50
220/220 - 8s - loss: 12.9128 - accuracy10: 0.4229 - accuracy20: 0.4109 - accuracy30: 0.4021 - accuracy50: 0.3928 - val_loss: 13.0859 - val_accuracy10: 0.4106 - val_accuracy20: 0.4029 - val_accuracy30: 0.3969 - val_accuracy50: 0.3911 - 8s/epoch - 34ms/step
Epoch 4/50
220/220 - 8s - loss: 12.8584 - accuracy10: 0.4324 - accuracy20: 0.4182 - accuracy30: 0.4090 - accuracy50: 0.3973 - val_loss: 13.0526 - val_accuracy10: 0.4130 - val_accuracy20: 0.4057 - val_accuracy30: 0.4005 - val_accuracy50: 0.3916 - 8s/epoch - 34ms/step
Epoch 5/50
220/220 - 8s - loss: 12.8000 - accuracy10: 0.4406 - accuracy20: 0.4225 - accuracy30: 0.4171 - accuracy50: 0.4066 - val_loss: 13.0268 - val_accuracy10: 0.4156 - val_accuracy20: 0.4069 - val_accuracy30: 0.4001 - val_accuracy50: 0.3911 - 8s/epoch - 37ms/step
Epoch 6/50
220/220 - 8s - loss: 12.7643 - accuracy10: 0.4451 - accuracy20: 0.4294 - accuracy30: 0.4215 - accuracy50: 0.4108 - val_loss: 13.0050 - val_accuracy10: 0.4184 - val_accuracy20: 0.4088 - val_accuracy30: 0.4006 - val_accuracy50: 0.3936 - 8s/epoch - 35ms/step
Epoch 7/50
220/220 - 8s - loss: 12.7168 - accuracy10: 0.4508 - accuracy20: 0.4362 - accuracy30: 0.4264 - accuracy50: 0.4135 - val_loss: 13.0033 - val_accuracy10: 0.4163 - val_accuracy20: 0.4122 - val_accuracy30: 0.4030 - val_accuracy50: 0.3963 - 8s/epoch - 34ms/step
Epoch 8/50
220/220 - 8s - loss: 12.6768 - accuracy10: 0.4567 - accuracy20: 0.4398 - accuracy30: 0.4315 - accuracy50: 0.4193 - val_loss: 12.9831 - val_accuracy10: 0.4240 - val_accuracy20: 0.4127 - val_accuracy30: 0.4027 - val_accuracy50: 0.3972 - 8s/epoch - 35ms/step
Epoch 9/50
220/220 - 8s - loss: 12.6422 - accuracy10: 0.4612 - accuracy20: 0.4460 - accuracy30: 0.4352 - accuracy50: 0.4221 - val_loss: 13.0027 - val_accuracy10: 0.4201 - val_accuracy20: 0.4094 - val_accuracy30: 0.4028 - val_accuracy50: 0.3928 - 8s/epoch - 35ms/step
Epoch 10/50
220/220 - 8s - loss: 12.6068 - accuracy10: 0.4679 - accuracy20: 0.4484 - accuracy30: 0.4360 - accuracy50: 0.4250 - val_loss: 12.9999 - val_accuracy10: 0.4157 - val_accuracy20: 0.4072 - val_accuracy30: 0.4026 - val_accuracy50: 0.3964 - 8s/epoch - 34ms/step
Epoch 11/50
220/220 - 8s - loss: 12.5716 - accuracy10: 0.4702 - accuracy20: 0.4518 - accuracy30: 0.4421 - accuracy50: 0.4299 - val_loss: 12.9994 - val_accuracy10: 0.4209 - val_accuracy20: 0.4115 - val_accuracy30: 0.4044 - val_accuracy50: 0.3973 - 8s/epoch - 34ms/step
Epoch 12/50
220/220 - 8s - loss: 12.5396 - accuracy10: 0.4732 - accuracy20: 0.4569 - accuracy30: 0.4455 - accuracy50: 0.4341 - val_loss: 13.0089 - val_accuracy10: 0.4205 - val_accuracy20: 0.4101 - val_accuracy30: 0.4026 - val_accuracy50: 0.3943 - 8s/epoch - 34ms/step
Epoch 13/50
220/220 - 8s - loss: 12.5048 - accuracy10: 0.4764 - accuracy20: 0.4591 - accuracy30: 0.4495 - accuracy50: 0.4337 - val_loss: 13.0478 - val_accuracy10: 0.4198 - val_accuracy20: 0.4081 - val_accuracy30: 0.3999 - val_accuracy50: 0.3940 - 8s/epoch - 34ms/step
Epoch 14/50
220/220 - 8s - loss: 12.4656 - accuracy10: 0.4783 - accuracy20: 0.4647 - accuracy30: 0.4542 - accuracy50: 0.4397 - val_loss: 13.0555 - val_accuracy10: 0.4195 - val_accuracy20: 0.4094 - val_accuracy30: 0.4023 - val_accuracy50: 0.3937 - 8s/epoch - 34ms/step
Epoch 15/50
220/220 - 8s - loss: 12.4221 - accuracy10: 0.4835 - accuracy20: 0.4689 - accuracy30: 0.4605 - accuracy50: 0.4440 - val_loss: 13.0988 - val_accuracy10: 0.4204 - val_accuracy20: 0.4084 - val_accuracy30: 0.3996 - val_accuracy50: 0.3941 - 8s/epoch - 34ms/step
Epoch 16/50
220/220 - 8s - loss: 12.3826 - accuracy10: 0.4857 - accuracy20: 0.4733 - accuracy30: 0.4625 - accuracy50: 0.4460 - val_loss: 13.0741 - val_accuracy10: 0.4223 - val_accuracy20: 0.4097 - val_accuracy30: 0.4050 - val_accuracy50: 0.3971 - 8s/epoch - 34ms/step
Epoch 17/50
220/220 - 8s - loss: 12.3510 - accuracy10: 0.4880 - accuracy20: 0.4759 - accuracy30: 0.4659 - accuracy50: 0.4504 - val_loss: 13.0730 - val_accuracy10: 0.4223 - val_accuracy20: 0.4092 - val_accuracy30: 0.4014 - val_accuracy50: 0.3958 - 8s/epoch - 34ms/step
Epoch 18/50
220/220 - 8s - loss: 12.3096 - accuracy10: 0.4898 - accuracy20: 0.4807 - accuracy30: 0.4703 - accuracy50: 0.4542 - val_loss: 13.1284 - val_accuracy10: 0.4194 - val_accuracy20: 0.4050 - val_accuracy30: 0.4018 - val_accuracy50: 0.3939 - 8s/epoch - 35ms/step
testing model: results/XRAY/W10/deepOF_L2/seq2seq
Evaluating performance on  test set...
967/967 - 14s - 14s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0643798
{'0': {'precision': 0.4300088960655468, 'recall': 0.6422549993858934, 'f1-score': 0.5151257343458948, 'support': 89561}, '1': {'precision': 0.38007651559741024, 'recall': 0.0372743408805576, 'f1-score': 0.0678906075460292, 'support': 69297}, '2': {'precision': 0.4409886791747296, 'recall': 0.5319703189137985, 'f1-score': 0.48222564107806404, 'support': 88676}, 'accuracy': 0.43338288881527387, 'macro avg': {'precision': 0.41702469694589556, 'recall': 0.4038332197267498, 'f1-score': 0.35508066098999597, 'support': 247534}, 'weighted avg': {'precision': 0.4199637268269349, 'recall': 0.43338288881527387, 'f1-score': 0.37813646720494265, 'support': 247534}}
[[57521  1999 30041]
 [36957  2583 29757]
 [39289  2214 47173]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0815787
{'0': {'precision': 0.4126469634911748, 'recall': 0.640292621592273, 'f1-score': 0.5018612839499537, 'support': 87485}, '1': {'precision': 0.36398590195450176, 'recall': 0.030262667163940542, 'f1-score': 0.055879387097567575, 'support': 75076}, '2': {'precision': 0.419881755476389, 'recall': 0.5215303684699846, 'f1-score': 0.465218326973446, 'support': 84973}, 'accuracy': 0.41450467410537545, 'macro avg': {'precision': 0.3988382069740219, 'recall': 0.397361885742066, 'f1-score': 0.34098633267365575, 'support': 247534}, 'weighted avg': {'precision': 0.4003718179492789, 'recall': 0.41450467410537545, 'f1-score': 0.35401816392904933, 'support': 247534}}
[[56016  1948 29521]
 [41097  2272 31707]
 [38635  2022 44316]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0854617
{'0': {'precision': 0.4065044814340589, 'recall': 0.6374661526458305, 'f1-score': 0.49643704401981853, 'support': 87156}, '1': {'precision': 0.3638061879743141, 'recall': 0.04075120318058171, 'f1-score': 0.07329264133413305, 'support': 76464}, '2': {'precision': 0.41067902320761723, 'recall': 0.5006315990180423, 'f1-score': 0.45121584464684655, 'support': 83914}, 'accuracy': 0.40675220373766835, 'macro avg': {'precision': 0.3936632308719967, 'recall': 0.39294965161481815, 'f1-score': 0.34031517666693273, 'support': 247534}, 'weighted avg': {'precision': 0.3947300188845927, 'recall': 0.4067522037376684, 'f1-score': 0.35039647855753125, 'support': 247534}}
[[55559  2620 28977]
 [42041  3116 31307]
 [39075  2829 42010]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0865545
{'0': {'precision': 0.4098183139534884, 'recall': 0.6246026383704574, 'f1-score': 0.4949118626663683, 'support': 90283}, '1': {'precision': 0.35447338618346547, 'recall': 0.05578404759946259, 'f1-score': 0.09639781570936141, 'support': 72942}, '2': {'precision': 0.4009750647503936, 'recall': 0.4682536858461137, 'f1-score': 0.4320106804403493, 'support': 84309}, 'accuracy': 0.4037344364814531, 'macro avg': {'precision': 0.38842225496244914, 'recall': 0.3828801239386779, 'f1-score': 0.34110678627202634, 'support': 247534}, 'weighted avg': {'precision': 0.3904975934930073, 'recall': 0.4037344364814531, 'f1-score': 0.35605599888429623, 'support': 247534}}
[[56391  3757 30135]
 [40031  4069 28842]
 [41178  3653 39478]]
Evaluating performance on  train set...
220/220 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0511576
{'0': {'precision': 0.4175881870385562, 'recall': 0.6819570226675955, 'f1-score': 0.5179908824487137, 'support': 18661}, '1': {'precision': 0.4523908523908524, 'recall': 0.05897977991001247, 'f1-score': 0.10435449836946098, 'support': 18447}, '2': {'precision': 0.46653265471964417, 'recall': 0.5695191353834909, 'f1-score': 0.5129073212018621, 'support': 19153}, 'accuracy': 0.43941629192513465, 'macro avg': {'precision': 0.4455038980496843, 'recall': 0.4368186459870329, 'f1-score': 0.37841756734001225, 'support': 56261}, 'weighted avg': {'precision': 0.4456615977004656, 'recall': 0.43941629192513465, 'f1-score': 0.380636128255384, 'support': 56261}}
[[12726   649  5286]
 [10172  1088  7187]
 [ 7577   668 10908]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0627134
{'0': {'precision': 0.41191472665445983, 'recall': 0.6794671269079338, 'f1-score': 0.5128956743002544, 'support': 18541}, '1': {'precision': 0.44779018941233606, 'recall': 0.04948475740661228, 'f1-score': 0.08912087380986902, 'support': 18632}, '2': {'precision': 0.45207045473791174, 'recall': 0.5593566638725901, 'f1-score': 0.5000234159134548, 'support': 19088}, 'accuracy': 0.4300847834201312, 'macro avg': {'precision': 0.43725845693490256, 'recall': 0.4294361827290454, 'f1-score': 0.3673466546745261, 'support': 56261}, 'weighted avg': {'precision': 0.4374195018941761, 'recall': 0.4300847834201312, 'f1-score': 0.3681865907286134, 'support': 56261}}
[[12598   610  5333]
 [10102   922  7608]
 [ 7884   527 10677]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0687919
{'0': {'precision': 0.4066358782876421, 'recall': 0.6697415978853105, 'f1-score': 0.5060324447705226, 'support': 18537}, '1': {'precision': 0.43672360248447206, 'recall': 0.06067306655161255, 'f1-score': 0.10654418032010608, 'support': 18542}, '2': {'precision': 0.44640234948604995, 'recall': 0.5388384944218538, 'f1-score': 0.48828420256991684, 'support': 19182}, 'accuracy': 0.42437923250564336, 'macro avg': {'precision': 0.42992061008605464, 'recall': 0.42308438628625894, 'f1-score': 0.3669536092201818, 'support': 56261}, 'weighted avg': {'precision': 0.43011016833910726, 'recall': 0.42437923250564336, 'f1-score': 0.36832145169660563, 'support': 56261}}
[[12415   744  5378]
 [ 9977  1125  7440]
 [ 8139   707 10336]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.079008
{'0': {'precision': 0.3931195067558704, 'recall': 0.6477708727370981, 'f1-score': 0.4892952629752842, 'support': 18505}, '1': {'precision': 0.42736380713838445, 'recall': 0.07338709677419354, 'f1-score': 0.12526383408277506, 'support': 18600}, '2': {'precision': 0.4280841638981174, 'recall': 0.504489455001044, 'f1-score': 0.46315688576837366, 'support': 19156}, 'accuracy': 0.40909333285935195, 'macro avg': {'precision': 0.4161891592641241, 'recall': 0.40854914150411187, 'f1-score': 0.3592386609421443, 'support': 56261}, 'weighted avg': {'precision': 0.4163456662505762, 'recall': 0.40909333285935195, 'f1-score': 0.3600460258274154, 'support': 56261}}
[[11987   918  5600]
 [ 9924  1365  7311]
 [ 8581   911  9664]]
Evaluating performance on  val set...
79/79 - 1s - 1s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0714135
{'0': {'precision': 0.4076308633582597, 'recall': 0.6772554002541296, 'f1-score': 0.5089385178505119, 'support': 7083}, '1': {'precision': 0.3687707641196013, 'recall': 0.0361386944489663, 'f1-score': 0.06582653817642699, 'support': 6143}, '2': {'precision': 0.44046529865377076, 'recall': 0.49595290654893304, 'f1-score': 0.466565139138862, 'support': 6795}, 'accuracy': 0.4190100394585685, 'macro avg': {'precision': 0.40562230871054394, 'recall': 0.40311566708400964, 'f1-score': 0.347110065055267, 'support': 20021}, 'weighted avg': {'precision': 0.406851301808383, 'recall': 0.4190100394585685, 'f1-score': 0.3585981752360788, 'support': 20021}}
[[4797  188 2098]
 [3738  222 2183]
 [3233  192 3370]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0821807
{'0': {'precision': 0.3969866260369054, 'recall': 0.675014392630973, 'f1-score': 0.4999467007781686, 'support': 6948}, '1': {'precision': 0.3892100192678227, 'recall': 0.03221690590111643, 'f1-score': 0.05950802769185447, 'support': 6270}, '2': {'precision': 0.42650884495317376, 'recall': 0.4819932382772306, 'f1-score': 0.4525567593678835, 'support': 6803}, 'accuracy': 0.4081214724539234, 'macro avg': {'precision': 0.40423516341930066, 'recall': 0.39640817893644, 'f1-score': 0.3373371626126355, 'support': 20021}, 'weighted avg': {'precision': 0.4045826667364321, 'recall': 0.4081214724539234, 'f1-score': 0.34591122544400155, 'support': 20021}}
[[4690  167 2091]
 [3750  202 2318]
 [3374  150 3279]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0858774
{'0': {'precision': 0.39481512962175946, 'recall': 0.6690191559844447, 'f1-score': 0.4965790036348086, 'support': 6943}, '1': {'precision': 0.3791130185979971, 'recall': 0.04185752645711578, 'f1-score': 0.07539118065433856, 'support': 6331}, '2': {'precision': 0.41418552335582903, 'recall': 0.4639098858752038, 'f1-score': 0.4376398210290828, 'support': 6747}, 'accuracy': 0.4015783427401229, 'macro avg': {'precision': 0.3960378905251953, 'recall': 0.3915955227722548, 'f1-score': 0.33653666843941, 'support': 20021}, 'weighted avg': {'precision': 0.3963775881219506, 'recall': 0.4015783427401229, 'f1-score': 0.3435295669268426, 'support': 20021}}
[[4645  220 2078]
 [3717  265 2349]
 [3403  214 3130]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0887176
{'0': {'precision': 0.39186076273355513, 'recall': 0.6630576006929406, 'f1-score': 0.49259974259974254, 'support': 6927}, '1': {'precision': 0.3912087912087912, 'recall': 0.056445219597272875, 'f1-score': 0.09865595122627131, 'support': 6307}, '2': {'precision': 0.4029769959404601, 'recall': 0.4387800206276705, 'f1-score': 0.4201170910629894, 'support': 6787}, 'accuracy': 0.3959342690175316, 'macro avg': {'precision': 0.3953488499609355, 'recall': 0.3860942803059613, 'f1-score': 0.33712426162966774, 'support': 20021}, 'weighted avg': {'precision': 0.39542371615089583, 'recall': 0.3959342690175316, 'f1-score': 0.34392868480180905, 'support': 20021}}
[[4593  262 2072]
 [3611  356 2340]
 [3517  292 2978]]
training model: results/XRAY/W10/deepVOL_L2/seq2seq
Epoch 1/50
220/220 - 13s - loss: 13.2419 - accuracy10: 0.3738 - accuracy20: 0.3696 - accuracy30: 0.3608 - accuracy50: 0.3646 - val_loss: 13.1826 - val_accuracy10: 0.3826 - val_accuracy20: 0.3731 - val_accuracy30: 0.3683 - val_accuracy50: 0.3643 - 13s/epoch - 61ms/step
Epoch 2/50
220/220 - 7s - loss: 13.0732 - accuracy10: 0.3994 - accuracy20: 0.3892 - accuracy30: 0.3785 - accuracy50: 0.3784 - val_loss: 13.1058 - val_accuracy10: 0.3949 - val_accuracy20: 0.3907 - val_accuracy30: 0.3833 - val_accuracy50: 0.3776 - 7s/epoch - 34ms/step
Epoch 3/50
220/220 - 7s - loss: 12.9665 - accuracy10: 0.4144 - accuracy20: 0.4053 - accuracy30: 0.3954 - accuracy50: 0.3932 - val_loss: 13.0511 - val_accuracy10: 0.4025 - val_accuracy20: 0.3973 - val_accuracy30: 0.3894 - val_accuracy50: 0.3779 - 7s/epoch - 34ms/step
Epoch 4/50
220/220 - 7s - loss: 12.9059 - accuracy10: 0.4240 - accuracy20: 0.4152 - accuracy30: 0.4010 - accuracy50: 0.3956 - val_loss: 13.0129 - val_accuracy10: 0.4151 - val_accuracy20: 0.4094 - val_accuracy30: 0.3995 - val_accuracy50: 0.3829 - 7s/epoch - 34ms/step
Epoch 5/50
220/220 - 7s - loss: 12.8531 - accuracy10: 0.4315 - accuracy20: 0.4228 - accuracy30: 0.4095 - accuracy50: 0.4012 - val_loss: 12.9845 - val_accuracy10: 0.4222 - val_accuracy20: 0.4151 - val_accuracy30: 0.4029 - val_accuracy50: 0.3885 - 7s/epoch - 34ms/step
Epoch 6/50
220/220 - 7s - loss: 12.8254 - accuracy10: 0.4387 - accuracy20: 0.4279 - accuracy30: 0.4113 - accuracy50: 0.4038 - val_loss: 12.9791 - val_accuracy10: 0.4297 - val_accuracy20: 0.4214 - val_accuracy30: 0.4059 - val_accuracy50: 0.3886 - 7s/epoch - 33ms/step
Epoch 7/50
220/220 - 7s - loss: 12.8006 - accuracy10: 0.4405 - accuracy20: 0.4281 - accuracy30: 0.4130 - accuracy50: 0.4060 - val_loss: 12.9741 - val_accuracy10: 0.4322 - val_accuracy20: 0.4187 - val_accuracy30: 0.4035 - val_accuracy50: 0.3885 - 7s/epoch - 34ms/step
Epoch 8/50
220/220 - 7s - loss: 12.7623 - accuracy10: 0.4462 - accuracy20: 0.4311 - accuracy30: 0.4168 - accuracy50: 0.4081 - val_loss: 12.9338 - val_accuracy10: 0.4351 - val_accuracy20: 0.4238 - val_accuracy30: 0.4059 - val_accuracy50: 0.3915 - 7s/epoch - 33ms/step
Epoch 9/50
220/220 - 7s - loss: 12.7281 - accuracy10: 0.4482 - accuracy20: 0.4375 - accuracy30: 0.4209 - accuracy50: 0.4125 - val_loss: 12.9317 - val_accuracy10: 0.4366 - val_accuracy20: 0.4259 - val_accuracy30: 0.4107 - val_accuracy50: 0.3916 - 7s/epoch - 33ms/step
Epoch 10/50
220/220 - 7s - loss: 12.7034 - accuracy10: 0.4529 - accuracy20: 0.4400 - accuracy30: 0.4233 - accuracy50: 0.4143 - val_loss: 12.9253 - val_accuracy10: 0.4375 - val_accuracy20: 0.4272 - val_accuracy30: 0.4105 - val_accuracy50: 0.3947 - 7s/epoch - 33ms/step
Epoch 11/50
220/220 - 7s - loss: 12.6849 - accuracy10: 0.4543 - accuracy20: 0.4415 - accuracy30: 0.4257 - accuracy50: 0.4198 - val_loss: 12.9298 - val_accuracy10: 0.4382 - val_accuracy20: 0.4265 - val_accuracy30: 0.4064 - val_accuracy50: 0.3898 - 7s/epoch - 33ms/step
Epoch 12/50
220/220 - 7s - loss: 12.6622 - accuracy10: 0.4579 - accuracy20: 0.4446 - accuracy30: 0.4291 - accuracy50: 0.4207 - val_loss: 12.9353 - val_accuracy10: 0.4365 - val_accuracy20: 0.4260 - val_accuracy30: 0.4074 - val_accuracy50: 0.3924 - 7s/epoch - 33ms/step
Epoch 13/50
220/220 - 7s - loss: 12.6450 - accuracy10: 0.4580 - accuracy20: 0.4452 - accuracy30: 0.4302 - accuracy50: 0.4210 - val_loss: 12.9440 - val_accuracy10: 0.4355 - val_accuracy20: 0.4242 - val_accuracy30: 0.4067 - val_accuracy50: 0.3912 - 7s/epoch - 33ms/step
Epoch 14/50
220/220 - 7s - loss: 12.6264 - accuracy10: 0.4592 - accuracy20: 0.4468 - accuracy30: 0.4334 - accuracy50: 0.4219 - val_loss: 12.9843 - val_accuracy10: 0.4324 - val_accuracy20: 0.4211 - val_accuracy30: 0.4055 - val_accuracy50: 0.3897 - 7s/epoch - 34ms/step
Epoch 15/50
220/220 - 7s - loss: 12.5939 - accuracy10: 0.4621 - accuracy20: 0.4508 - accuracy30: 0.4374 - accuracy50: 0.4293 - val_loss: 12.9733 - val_accuracy10: 0.4325 - val_accuracy20: 0.4198 - val_accuracy30: 0.4023 - val_accuracy50: 0.3876 - 7s/epoch - 34ms/step
Epoch 16/50
220/220 - 7s - loss: 12.5661 - accuracy10: 0.4642 - accuracy20: 0.4535 - accuracy30: 0.4392 - accuracy50: 0.4298 - val_loss: 12.9665 - val_accuracy10: 0.4324 - val_accuracy20: 0.4228 - val_accuracy30: 0.4065 - val_accuracy50: 0.3908 - 7s/epoch - 33ms/step
Epoch 17/50
220/220 - 7s - loss: 12.5434 - accuracy10: 0.4652 - accuracy20: 0.4558 - accuracy30: 0.4423 - accuracy50: 0.4322 - val_loss: 12.9923 - val_accuracy10: 0.4329 - val_accuracy20: 0.4201 - val_accuracy30: 0.4027 - val_accuracy50: 0.3890 - 7s/epoch - 33ms/step
Epoch 18/50
220/220 - 7s - loss: 12.5265 - accuracy10: 0.4672 - accuracy20: 0.4550 - accuracy30: 0.4428 - accuracy50: 0.4347 - val_loss: 12.9993 - val_accuracy10: 0.4323 - val_accuracy20: 0.4176 - val_accuracy30: 0.4049 - val_accuracy50: 0.3922 - 7s/epoch - 34ms/step
Epoch 19/50
220/220 - 7s - loss: 12.4849 - accuracy10: 0.4688 - accuracy20: 0.4611 - accuracy30: 0.4483 - accuracy50: 0.4382 - val_loss: 13.0231 - val_accuracy10: 0.4329 - val_accuracy20: 0.4179 - val_accuracy30: 0.4018 - val_accuracy50: 0.3878 - 7s/epoch - 33ms/step
Epoch 20/50
220/220 - 7s - loss: 12.4682 - accuracy10: 0.4710 - accuracy20: 0.4625 - accuracy30: 0.4525 - accuracy50: 0.4420 - val_loss: 13.0418 - val_accuracy10: 0.4259 - val_accuracy20: 0.4153 - val_accuracy30: 0.4006 - val_accuracy50: 0.3902 - 7s/epoch - 33ms/step
testing model: results/XRAY/W10/deepVOL_L2/seq2seq
Evaluating performance on  test set...
967/967 - 13s - 13s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0685401
{'0': {'precision': 0.44419261968725116, 'recall': 0.5667693888032871, 'f1-score': 0.49804993156363603, 'support': 89562}, '1': {'precision': 0.3953906169797762, 'recall': 0.11115921324155446, 'f1-score': 0.17353202897081518, 'support': 69297}, '2': {'precision': 0.428985761996836, 'recall': 0.550405953991881, 'f1-score': 0.4821693173960289, 'support': 88680}, 'accuracy': 0.4333620156823773, 'macro avg': {'precision': 0.42285633288795443, 'recall': 0.40944485201224085, 'f1-score': 0.38458375931016003, 'support': 247539}, 'weighted avg': {'precision': 0.4250829984897594, 'recall': 0.4333620156823773, 'f1-score': 0.4015139919324745, 'support': 247539}}
[[50761  5758 33043]
 [29667  7703 31927]
 [33849  6021 48810]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0843059
{'0': {'precision': 0.42213992141276363, 'recall': 0.5341768968749285, 'f1-score': 0.47159558203954766, 'support': 87486}, '1': {'precision': 0.37638336150029983, 'recall': 0.09196014705098833, 'f1-score': 0.1478071912565966, 'support': 75076}, '2': {'precision': 0.3986209923116524, 'recall': 0.5558327547454017, 'f1-score': 0.4642793952857452, 'support': 84977}, 'accuracy': 0.40749134479819343, 'macro avg': {'precision': 0.39904809174157196, 'recall': 0.3939899328904395, 'f1-score': 0.36122738952729644, 'support': 247539}, 'weighted avg': {'precision': 0.4001886833039676, 'recall': 0.40749134479819343, 'f1-score': 0.37088238198542006, 'support': 247539}}
[[46733  5771 34982]
 [31896  6904 36276]
 [32076  5668 47233]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0901406
{'0': {'precision': 0.4112807589682775, 'recall': 0.5093337310829882, 'f1-score': 0.4550855233145218, 'support': 87157}, '1': {'precision': 0.36831489165514064, 'recall': 0.0835818162795564, 'f1-score': 0.13624541656007505, 'support': 76464}, '2': {'precision': 0.3826308169258329, 'recall': 0.5574131890655163, 'f1-score': 0.4537733606895314, 'support': 83918}, 'accuracy': 0.39411971446923516, 'macro avg': {'precision': 0.38740882251641695, 'recall': 0.38344291214268694, 'f1-score': 0.34836810018804276, 'support': 247539}, 'weighted avg': {'precision': 0.3882961467877743, 'recall': 0.39411971446923516, 'f1-score': 0.35615200582420325, 'support': 247539}}
[[44392  5553 37212]
 [31811  6391 38262]
 [31733  5408 46777]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0909332
{'0': {'precision': 0.41319520071212795, 'recall': 0.48328607505205795, 'f1-score': 0.44550063047839783, 'support': 90284}, '1': {'precision': 0.36797853309481215, 'recall': 0.08460146417701736, 'f1-score': 0.13757356875334403, 'support': 72942}, '2': {'precision': 0.37161460413837183, 'recall': 0.5516942820205663, 'f1-score': 0.4440933154480316, 'support': 84313}, 'accuracy': 0.38910636303774354, 'macro avg': {'precision': 0.38426277931510394, 'recall': 0.3731939404165472, 'f1-score': 0.3423891715599245, 'support': 247539}, 'weighted avg': {'precision': 0.3857087076412771, 'recall': 0.38910636303774354, 'f1-score': 0.35428481927893374, 'support': 247539}}
[[43633  5518 41133]
 [29249  6171 37522]
 [32717  5081 46515]]
Evaluating performance on  train set...
220/220 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0485071
{'0': {'precision': 0.4341142590286426, 'recall': 0.5942360963136586, 'f1-score': 0.5017090941800845, 'support': 18772}, '1': {'precision': 0.4954570947840718, 'recall': 0.23911866608921611, 'f1-score': 0.322561799393873, 'support': 18472}, '2': {'precision': 0.4440749976909578, 'recall': 0.5055465012354766, 'f1-score': 0.47282114320835894, 'support': 19021}, 'accuracy': 0.4476672887230072, 'macro avg': {'precision': 0.4578821171678908, 'recall': 0.44630042121278385, 'f1-score': 0.43236401226077215, 'support': 56265}, 'weighted avg': {'precision': 0.4576206674916336, 'recall': 0.4476672887230072, 'f1-score': 0.43312851042954525, 'support': 56265}}
[[11155  2117  5500]
 [ 7517  4417  6538]
 [ 7024  2381  9616]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0603753
{'0': {'precision': 0.42375296912114013, 'recall': 0.5746805540642114, 'f1-score': 0.4878093241580459, 'support': 18626}, '1': {'precision': 0.4613543910026322, 'recall': 0.2081174438687392, 'f1-score': 0.2868407349549952, 'support': 18528}, '2': {'precision': 0.43259592882059433, 'recall': 0.5126367013761708, 'f1-score': 0.46922745342209876, 'support': 19111}, 'accuracy': 0.43289789389496136, 'macro avg': {'precision': 0.43923442964812226, 'recall': 0.4318115664363738, 'f1-score': 0.4146258375117133, 'support': 56265}, 'weighted avg': {'precision': 0.4391386786641341, 'recall': 0.43289789389496136, 'f1-score': 0.4153190699611418, 'support': 56265}}
[[10704  2163  5759]
 [ 7581  3856  7091]
 [ 6975  2339  9797]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0705774
{'0': {'precision': 0.4081599806864362, 'recall': 0.5469643049714225, 'f1-score': 0.4674762091292426, 'support': 18546}, '1': {'precision': 0.4275222265172014, 'recall': 0.17889685663449614, 'f1-score': 0.2522426638284932, 'support': 18547}, '2': {'precision': 0.4220540357701577, 'recall': 0.5206551220529939, 'f1-score': 0.46619807113000017, 'support': 19172}, 'accuracy': 0.4166711099262419, 'macro avg': {'precision': 0.41924541432459844, 'recall': 0.4155054278863042, 'f1-score': 0.39530564802924534, 'support': 56265}, 'weighted avg': {'precision': 0.41927680993176303, 'recall': 0.4166711099262419, 'f1-score': 0.39609184893348187, 'support': 56265}}
[[10144  2162  6240]
 [ 7800  3318  7429]
 [ 6909  2281  9982]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0770209
{'0': {'precision': 0.39541816399869323, 'recall': 0.5224734257810393, 'f1-score': 0.4501522512261454, 'support': 18533}, '1': {'precision': 0.4135131415990092, 'recall': 0.16170693644729053, 'f1-score': 0.23249516441005805, 'support': 18583}, '2': {'precision': 0.40713994288045696, 'recall': 0.5211238184761606, 'f1-score': 0.4571336952289333, 'support': 19149}, 'accuracy': 0.4028614591664445, 'macro avg': {'precision': 0.4053570828260531, 'recall': 0.40176806023483014, 'f1-score': 0.3799270369550456, 'support': 56265}, 'weighted avg': {'precision': 0.4053838498167607, 'recall': 0.4028614591664445, 'f1-score': 0.3806412946262349, 'support': 56265}}
[[9683 2106 6744]
 [7791 3005 7787]
 [7014 2156 9979]]
Evaluating performance on  val set...
79/79 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0647552
{'0': {'precision': 0.4396379328491738, 'recall': 0.5936611711199545, 'f1-score': 0.5051702243454073, 'support': 7036}, '1': {'precision': 0.4489687995769434, 'recall': 0.13877084014383786, 'f1-score': 0.21201148707703835, 'support': 6118}, '2': {'precision': 0.4343492872870553, 'recall': 0.54579874763361, 'f1-score': 0.4837377387712959, 'support': 6867}, 'accuracy': 0.4382398481594326, 'macro avg': {'precision': 0.4409853399043908, 'recall': 0.42607691963246747, 'f1-score': 0.4003064833979138, 'support': 20021}, 'weighted avg': {'precision': 0.4406752992926794, 'recall': 0.4382398481594326, 'f1-score': 0.40823590372978846, 'support': 20021}}
[[4177  526 2333]
 [2721  849 2548]
 [2603  516 3748]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0715125
{'0': {'precision': 0.42996530789245446, 'recall': 0.5728730319225769, 'f1-score': 0.49123676224685703, 'support': 6923}, '1': {'precision': 0.43305785123966944, 'recall': 0.12452471482889733, 'f1-score': 0.19342930970837946, 'support': 6312}, '2': {'precision': 0.41727900244934313, 'recall': 0.5523135867963455, 'f1-score': 0.47539320142059865, 'support': 6786}, 'accuracy': 0.42455421807102545, 'macro avg': {'precision': 0.4267673871938224, 'recall': 0.4165704445159399, 'f1-score': 0.3866864244586117, 'support': 20021}, 'weighted avg': {'precision': 0.4266403423498076, 'recall': 0.42455421807102545, 'f1-score': 0.3919772325435525, 'support': 20021}}
[[3966  520 2437]
 [2729  786 2797]
 [2529  509 3748]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0800984
{'0': {'precision': 0.41642746743210424, 'recall': 0.5444572748267898, 'f1-score': 0.47191292380833233, 'support': 6928}, '1': {'precision': 0.40211019929660025, 'recall': 0.10821896198138507, 'f1-score': 0.17054070851460534, 'support': 6339}, '2': {'precision': 0.40066976342227506, 'recall': 0.5491560556707137, 'f1-score': 0.463306476797202, 'support': 6754}, 'accuracy': 0.40792168223365466, 'macro avg': {'precision': 0.4064024767169932, 'recall': 0.40061076415962954, 'f1-score': 0.36858670304004654, 'support': 20021}, 'weighted avg': {'precision': 0.40657857399055053, 'recall': 0.40792168223365466, 'f1-score': 0.3735898422509621, 'support': 20021}}
[[3772  523 2633]
 [2738  686 2915]
 [2548  497 3709]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0860407
{'0': {'precision': 0.4028137310073157, 'recall': 0.5186204897840893, 'f1-score': 0.4534397567464842, 'support': 6901}, '1': {'precision': 0.4055522027761014, 'recall': 0.10599369085173502, 'f1-score': 0.1680630236338627, 'support': 6340}, '2': {'precision': 0.38400675176706406, 'recall': 0.5368731563421829, 'f1-score': 0.4477520142690203, 'support': 6780}, 'accuracy': 0.3941361570351131, 'macro avg': {'precision': 0.39745756185016035, 'recall': 0.3871624456593357, 'f1-score': 0.3564182648831224, 'support': 20021}, 'weighted avg': {'precision': 0.39731203737389054, 'recall': 0.3941361570351131, 'f1-score': 0.3611440980915106, 'support': 20021}}
[[3579  484 2838]
 [2667  672 3001]
 [2639  501 3640]]
training model: results/XRAY/W10/deepVOL_L3/seq2seq
Epoch 1/50
220/220 - 16s - loss: 13.2859 - accuracy10: 0.3660 - accuracy20: 0.3568 - accuracy30: 0.3541 - accuracy50: 0.3564 - val_loss: 13.2341 - val_accuracy10: 0.3579 - val_accuracy20: 0.3504 - val_accuracy30: 0.3509 - val_accuracy50: 0.3528 - 16s/epoch - 75ms/step
Epoch 2/50
220/220 - 10s - loss: 13.1554 - accuracy10: 0.3766 - accuracy20: 0.3706 - accuracy30: 0.3646 - accuracy50: 0.3679 - val_loss: 13.1928 - val_accuracy10: 0.3653 - val_accuracy20: 0.3637 - val_accuracy30: 0.3582 - val_accuracy50: 0.3570 - 10s/epoch - 46ms/step
Epoch 3/50
220/220 - 10s - loss: 13.1331 - accuracy10: 0.3721 - accuracy20: 0.3684 - accuracy30: 0.3618 - accuracy50: 0.3638 - val_loss: 13.1538 - val_accuracy10: 0.3709 - val_accuracy20: 0.3656 - val_accuracy30: 0.3610 - val_accuracy50: 0.3620 - 10s/epoch - 46ms/step
Epoch 4/50
220/220 - 10s - loss: 13.0881 - accuracy10: 0.3889 - accuracy20: 0.3822 - accuracy30: 0.3740 - accuracy50: 0.3737 - val_loss: 13.1611 - val_accuracy10: 0.3798 - val_accuracy20: 0.3726 - val_accuracy30: 0.3681 - val_accuracy50: 0.3625 - 10s/epoch - 46ms/step
Epoch 5/50
220/220 - 10s - loss: 13.0390 - accuracy10: 0.3994 - accuracy20: 0.3900 - accuracy30: 0.3820 - accuracy50: 0.3836 - val_loss: 13.1467 - val_accuracy10: 0.3941 - val_accuracy20: 0.3876 - val_accuracy30: 0.3779 - val_accuracy50: 0.3704 - 10s/epoch - 46ms/step
Epoch 6/50
220/220 - 10s - loss: 12.9727 - accuracy10: 0.4152 - accuracy20: 0.4048 - accuracy30: 0.3937 - accuracy50: 0.3928 - val_loss: 13.1080 - val_accuracy10: 0.4030 - val_accuracy20: 0.3952 - val_accuracy30: 0.3885 - val_accuracy50: 0.3781 - 10s/epoch - 47ms/step
Epoch 7/50
220/220 - 10s - loss: 12.9137 - accuracy10: 0.4258 - accuracy20: 0.4157 - accuracy30: 0.4053 - accuracy50: 0.4034 - val_loss: 13.0878 - val_accuracy10: 0.4110 - val_accuracy20: 0.4001 - val_accuracy30: 0.3900 - val_accuracy50: 0.3771 - 10s/epoch - 46ms/step
Epoch 8/50
220/220 - 10s - loss: 12.8648 - accuracy10: 0.4308 - accuracy20: 0.4218 - accuracy30: 0.4116 - accuracy50: 0.4092 - val_loss: 13.0851 - val_accuracy10: 0.4163 - val_accuracy20: 0.4090 - val_accuracy30: 0.3984 - val_accuracy50: 0.3841 - 10s/epoch - 48ms/step
Epoch 9/50
220/220 - 10s - loss: 12.8276 - accuracy10: 0.4377 - accuracy20: 0.4283 - accuracy30: 0.4166 - accuracy50: 0.4084 - val_loss: 13.0833 - val_accuracy10: 0.4233 - val_accuracy20: 0.4149 - val_accuracy30: 0.4017 - val_accuracy50: 0.3845 - 10s/epoch - 48ms/step
Epoch 10/50
220/220 - 11s - loss: 12.7974 - accuracy10: 0.4415 - accuracy20: 0.4290 - accuracy30: 0.4187 - accuracy50: 0.4098 - val_loss: 13.0784 - val_accuracy10: 0.4229 - val_accuracy20: 0.4140 - val_accuracy30: 0.4006 - val_accuracy50: 0.3852 - 11s/epoch - 48ms/step
Epoch 11/50
220/220 - 11s - loss: 12.7665 - accuracy10: 0.4467 - accuracy20: 0.4344 - accuracy30: 0.4213 - accuracy50: 0.4141 - val_loss: 13.0422 - val_accuracy10: 0.4283 - val_accuracy20: 0.4175 - val_accuracy30: 0.4035 - val_accuracy50: 0.3872 - 11s/epoch - 48ms/step
Epoch 12/50
220/220 - 10s - loss: 12.7370 - accuracy10: 0.4473 - accuracy20: 0.4394 - accuracy30: 0.4263 - accuracy50: 0.4170 - val_loss: 13.0685 - val_accuracy10: 0.4275 - val_accuracy20: 0.4194 - val_accuracy30: 0.4054 - val_accuracy50: 0.3879 - 10s/epoch - 48ms/step
Epoch 13/50
220/220 - 10s - loss: 12.7101 - accuracy10: 0.4522 - accuracy20: 0.4422 - accuracy30: 0.4289 - accuracy50: 0.4218 - val_loss: 13.0314 - val_accuracy10: 0.4291 - val_accuracy20: 0.4211 - val_accuracy30: 0.4064 - val_accuracy50: 0.3908 - 10s/epoch - 47ms/step
Epoch 14/50
220/220 - 10s - loss: 12.6884 - accuracy10: 0.4520 - accuracy20: 0.4429 - accuracy30: 0.4308 - accuracy50: 0.4238 - val_loss: 13.0711 - val_accuracy10: 0.4277 - val_accuracy20: 0.4184 - val_accuracy30: 0.4062 - val_accuracy50: 0.3891 - 10s/epoch - 46ms/step
Epoch 15/50
220/220 - 10s - loss: 12.6581 - accuracy10: 0.4575 - accuracy20: 0.4478 - accuracy30: 0.4361 - accuracy50: 0.4274 - val_loss: 13.0207 - val_accuracy10: 0.4304 - val_accuracy20: 0.4157 - val_accuracy30: 0.4019 - val_accuracy50: 0.3873 - 10s/epoch - 46ms/step
Epoch 16/50
220/220 - 10s - loss: 12.6336 - accuracy10: 0.4573 - accuracy20: 0.4496 - accuracy30: 0.4402 - accuracy50: 0.4298 - val_loss: 13.0025 - val_accuracy10: 0.4351 - val_accuracy20: 0.4201 - val_accuracy30: 0.4055 - val_accuracy50: 0.3885 - 10s/epoch - 46ms/step
Epoch 17/50
220/220 - 10s - loss: 12.6121 - accuracy10: 0.4604 - accuracy20: 0.4525 - accuracy30: 0.4401 - accuracy50: 0.4350 - val_loss: 12.9980 - val_accuracy10: 0.4302 - val_accuracy20: 0.4208 - val_accuracy30: 0.4063 - val_accuracy50: 0.3914 - 10s/epoch - 46ms/step
Epoch 18/50
220/220 - 10s - loss: 12.5819 - accuracy10: 0.4628 - accuracy20: 0.4559 - accuracy30: 0.4444 - accuracy50: 0.4362 - val_loss: 13.0780 - val_accuracy10: 0.4254 - val_accuracy20: 0.4173 - val_accuracy30: 0.4006 - val_accuracy50: 0.3839 - 10s/epoch - 47ms/step
Epoch 19/50
220/220 - 10s - loss: 12.5589 - accuracy10: 0.4641 - accuracy20: 0.4571 - accuracy30: 0.4451 - accuracy50: 0.4368 - val_loss: 13.0474 - val_accuracy10: 0.4284 - val_accuracy20: 0.4171 - val_accuracy30: 0.4052 - val_accuracy50: 0.3876 - 10s/epoch - 46ms/step
Epoch 20/50
220/220 - 10s - loss: 12.5469 - accuracy10: 0.4643 - accuracy20: 0.4588 - accuracy30: 0.4483 - accuracy50: 0.4382 - val_loss: 13.0463 - val_accuracy10: 0.4252 - val_accuracy20: 0.4164 - val_accuracy30: 0.4031 - val_accuracy50: 0.3883 - 10s/epoch - 45ms/step
Epoch 21/50
220/220 - 10s - loss: 12.5309 - accuracy10: 0.4643 - accuracy20: 0.4576 - accuracy30: 0.4464 - accuracy50: 0.4371 - val_loss: 13.1447 - val_accuracy10: 0.4221 - val_accuracy20: 0.4116 - val_accuracy30: 0.4000 - val_accuracy50: 0.3830 - 10s/epoch - 46ms/step
Epoch 22/50
220/220 - 10s - loss: 12.5030 - accuracy10: 0.4665 - accuracy20: 0.4606 - accuracy30: 0.4502 - accuracy50: 0.4400 - val_loss: 13.1311 - val_accuracy10: 0.4265 - val_accuracy20: 0.4151 - val_accuracy30: 0.4052 - val_accuracy50: 0.3873 - 10s/epoch - 45ms/step
Epoch 23/50
220/220 - 10s - loss: 12.4817 - accuracy10: 0.4685 - accuracy20: 0.4629 - accuracy30: 0.4525 - accuracy50: 0.4430 - val_loss: 13.1027 - val_accuracy10: 0.4283 - val_accuracy20: 0.4181 - val_accuracy30: 0.4034 - val_accuracy50: 0.3863 - 10s/epoch - 46ms/step
Epoch 24/50
220/220 - 10s - loss: 12.4658 - accuracy10: 0.4693 - accuracy20: 0.4637 - accuracy30: 0.4534 - accuracy50: 0.4428 - val_loss: 13.1236 - val_accuracy10: 0.4232 - val_accuracy20: 0.4132 - val_accuracy30: 0.4011 - val_accuracy50: 0.3844 - 10s/epoch - 46ms/step
Epoch 25/50
220/220 - 10s - loss: 12.4629 - accuracy10: 0.4675 - accuracy20: 0.4640 - accuracy30: 0.4520 - accuracy50: 0.4446 - val_loss: 13.1200 - val_accuracy10: 0.4276 - val_accuracy20: 0.4154 - val_accuracy30: 0.4024 - val_accuracy50: 0.3875 - 10s/epoch - 45ms/step
Epoch 26/50
220/220 - 10s - loss: 12.4504 - accuracy10: 0.4702 - accuracy20: 0.4649 - accuracy30: 0.4530 - accuracy50: 0.4453 - val_loss: 13.1338 - val_accuracy10: 0.4265 - val_accuracy20: 0.4169 - val_accuracy30: 0.4023 - val_accuracy50: 0.3879 - 10s/epoch - 45ms/step
Epoch 27/50
220/220 - 10s - loss: 12.4238 - accuracy10: 0.4697 - accuracy20: 0.4668 - accuracy30: 0.4588 - accuracy50: 0.4489 - val_loss: 13.1711 - val_accuracy10: 0.4302 - val_accuracy20: 0.4190 - val_accuracy30: 0.4026 - val_accuracy50: 0.3868 - 10s/epoch - 46ms/step
testing model: results/XRAY/W10/deepVOL_L3/seq2seq
Evaluating performance on  test set...
967/967 - 20s - 20s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0694335
{'0': {'precision': 0.439847875909257, 'recall': 0.5914338670418258, 'f1-score': 0.5045002142959188, 'support': 89562}, '1': {'precision': 0.4240813708421149, 'recall': 0.06678499790755732, 'f1-score': 0.11539708265802268, 'support': 69297}, '2': {'precision': 0.4301537031618444, 'recall': 0.5636332882273343, 'f1-score': 0.4879294018879528, 'support': 88680}, 'accuracy': 0.4346022242959695, 'macro avg': {'precision': 0.4313609833044055, 'recall': 0.40728405105890575, 'f1-score': 0.36927556628063146, 'support': 247539}, 'weighted avg': {'precision': 0.43196123687105176, 'recall': 0.4346022242959695, 'f1-score': 0.38963678123102924, 'support': 247539}}
[[52970  2965 33627]
 [32081  4628 32588]
 [35377  3320 49983]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0861137
{'0': {'precision': 0.41853238518816327, 'recall': 0.5711656722218412, 'f1-score': 0.48307931766218576, 'support': 87486}, '1': {'precision': 0.41529938205838485, 'recall': 0.05192072033672545, 'f1-score': 0.09230186355994412, 'support': 75076}, '2': {'precision': 0.405314831343359, 'recall': 0.5664591595372865, 'f1-score': 0.4725261241097679, 'support': 84977}, 'accuracy': 0.4120684013428187, 'macro avg': {'precision': 0.41304886619663567, 'recall': 0.39651518403195113, 'f1-score': 0.34930243511063264, 'support': 247539}, 'weighted avg': {'precision': 0.4130144303768359, 'recall': 0.4120684013428187, 'f1-score': 0.36093780916177287, 'support': 247539}}
[[49969  2722 34795]
 [35347  3898 35831]
 [34075  2766 48136]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0916252
{'0': {'precision': 0.4101522415678358, 'recall': 0.5594846082357126, 'f1-score': 0.47331919416443824, 'support': 87157}, '1': {'precision': 0.3938254727728412, 'recall': 0.04521081816279556, 'f1-score': 0.08111025081532577, 'support': 76464}, '2': {'precision': 0.3912706159121055, 'recall': 0.5589027383874735, 'f1-score': 0.4602996236303235, 'support': 83918}, 'accuracy': 0.40042983125891274, 'macro avg': {'precision': 0.39841611008426087, 'recall': 0.38786605492866055, 'f1-score': 0.3382430228700291, 'support': 247539}, 'weighted avg': {'precision': 0.3987079103274331, 'recall': 0.40042983125891274, 'f1-score': 0.34775336023795245, 'support': 247539}}
[[48763  2710 35684]
 [35722  3457 37285]
 [34405  2611 46902]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0911205
{'0': {'precision': 0.4102845655497462, 'recall': 0.538013380000886, 'f1-score': 0.4655469030789505, 'support': 90284}, '1': {'precision': 0.37653682638170743, 'recall': 0.04492610567300047, 'f1-score': 0.08027435850327638, 'support': 72942}, '2': {'precision': 0.38145211507327, 'recall': 0.5449218981651702, 'f1-score': 0.44876390666054566, 'support': 84313}, 'accuracy': 0.39506905982491647, 'macro avg': {'precision': 0.3894245023349079, 'recall': 0.3759537946130189, 'f1-score': 0.3315283894142575, 'support': 247539}, 'weighted avg': {'precision': 0.39051968814691984, 'recall': 0.39506905982491647, 'f1-score': 0.346302764888751, 'support': 247539}}
[[48574  2902 38808]
 [33972  3277 35693]
 [35845  2524 45944]]
Evaluating performance on  train set...
220/220 - 5s - 5s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0537453
{'0': {'precision': 0.42673550087873463, 'recall': 0.6208715107607075, 'f1-score': 0.5058154674073432, 'support': 18772}, '1': {'precision': 0.51151339608979, 'recall': 0.19120831528800347, 'f1-score': 0.2783622965677582, 'support': 18472}, '2': {'precision': 0.4440312046444122, 'recall': 0.5146942852636559, 'f1-score': 0.47675862572743427, 'support': 19021}, 'accuracy': 0.44391717764151783, 'macro avg': {'precision': 0.4607600338709789, 'recall': 0.44225803710412226, 'f1-score': 0.4203121299008452, 'support': 56265}, 'weighted avg': {'precision': 0.460415388227274, 'recall': 0.44391717764151783, 'f1-score': 0.42131879705557274, 'support': 56265}}
[[11655  1568  5549]
 [ 8231  3532  6709]
 [ 7426  1805  9790]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0624433
{'0': {'precision': 0.4182869347473855, 'recall': 0.6098464511972511, 'f1-score': 0.49622122231444665, 'support': 18626}, '1': {'precision': 0.4787457572329077, 'recall': 0.15986614853195164, 'f1-score': 0.23969249443657695, 'support': 18528}, '2': {'precision': 0.43818165954105226, 'recall': 0.5255611951232274, 'f1-score': 0.47791021340375417, 'support': 19111}, 'accuracy': 0.43304007820136853, 'macro avg': {'precision': 0.44507145050711516, 'recall': 0.43175793161747666, 'f1-score': 0.40460797671825927, 'support': 56265}, 'weighted avg': {'precision': 0.44495340855070054, 'recall': 0.43304007820136853, 'f1-score': 0.40552707921636766, 'support': 56265}}
[[11359  1504  5763]
 [ 8451  2962  7115]
 [ 7346  1721 10044]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0706363
{'0': {'precision': 0.4086451278635136, 'recall': 0.5953844494769762, 'f1-score': 0.48464897842737076, 'support': 18546}, '1': {'precision': 0.4465441819772528, 'recall': 0.13759637677252387, 'f1-score': 0.21037012612315556, 'support': 18547}, '2': {'precision': 0.4310850439882698, 'recall': 0.5290527853119132, 'f1-score': 0.475070841432285, 'support': 19172}, 'accuracy': 0.4218786101484049, 'macro avg': {'precision': 0.42875811794301205, 'recall': 0.42067787052047106, 'f1-score': 0.39002998199427047, 'support': 56265}, 'weighted avg': {'precision': 0.4287843232530337, 'recall': 0.4218786101484049, 'f1-score': 0.39097294685968104, 'support': 56265}}
[[11042  1487  6017]
 [ 8626  2552  7369]
 [ 7353  1676 10143]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.077778
{'0': {'precision': 0.3939326260934301, 'recall': 0.5710354502778827, 'f1-score': 0.46623199259879283, 'support': 18533}, '1': {'precision': 0.43343943081819886, 'recall': 0.12457622558252165, 'f1-score': 0.19352951011536532, 'support': 18583}, '2': {'precision': 0.4146473253252421, 'recall': 0.5209671523317144, 'f1-score': 0.46176633956674684, 'support': 19149}, 'accuracy': 0.4065404780947303, 'macro avg': {'precision': 0.4140064607456237, 'recall': 0.4055262760640396, 'f1-score': 0.373842614093635, 'support': 56265}, 'weighted avg': {'precision': 0.41403074619989677, 'recall': 0.4065404780947303, 'f1-score': 0.374644984300558, 'support': 56265}}
[[10583  1484  6466]
 [ 8651  2315  7617]
 [ 7631  1542  9976]]
Evaluating performance on  val set...
79/79 - 2s - 2s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0726933
{'0': {'precision': 0.4281948647857073, 'recall': 0.6233655486071632, 'f1-score': 0.5076682678395741, 'support': 7036}, '1': {'precision': 0.4722222222222222, 'recall': 0.09725400457665904, 'f1-score': 0.16129032258064518, 'support': 6118}, '2': {'precision': 0.43366987555764264, 'recall': 0.5379350516965196, 'f1-score': 0.48020799480013, 'support': 6867}, 'accuracy': 0.4332950402077818, 'macro avg': {'precision': 0.4446956541885241, 'recall': 0.4195182016267806, 'f1-score': 0.3830555284067831, 'support': 20021}, 'weighted avg': {'precision': 0.44352658007302953, 'recall': 0.4332950402077818, 'f1-score': 0.3924037973308088, 'support': 20021}}
[[4386  333 2317]
 [3016  595 2507]
 [2841  332 3694]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0786004
{'0': {'precision': 0.41945348722501724, 'recall': 0.6141846020511339, 'f1-score': 0.49847596717467757, 'support': 6923}, '1': {'precision': 0.47619047619047616, 'recall': 0.08238276299112801, 'f1-score': 0.14046461372231225, 'support': 6312}, '2': {'precision': 0.4224294813466788, 'recall': 0.5473032714412025, 'f1-score': 0.4768262934908204, 'support': 6786}, 'accuracy': 0.4238549523000849, 'macro avg': {'precision': 0.439357814920724, 'recall': 0.41462354549448815, 'f1-score': 0.3719222914626034, 'support': 20021}, 'weighted avg': {'precision': 0.43834959483500535, 'recall': 0.4238549523000849, 'f1-score': 0.37826806803827157, 'support': 20021}}
[[4252  287 2384]
 [3098  520 2694]
 [2787  285 3714]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0854738
{'0': {'precision': 0.4068301399781594, 'recall': 0.5915127020785219, 'f1-score': 0.48208928886536084, 'support': 6928}, '1': {'precision': 0.44051130776794495, 'recall': 0.070673607824578, 'f1-score': 0.12180532898314299, 'support': 6339}, '2': {'precision': 0.40700929347217557, 'recall': 0.5381995854308558, 'f1-score': 0.4635001593879503, 'support': 6754}, 'accuracy': 0.4086209480045952, 'macro avg': {'precision': 0.41811691373942667, 'recall': 0.40012863177798524, 'f1-score': 0.355798259078818, 'support': 20021}, 'weighted avg': {'precision': 0.41755462553422734, 'recall': 0.4086209480045952, 'f1-score': 0.3617460991054183, 'support': 20021}}
[[4098  273 2557]
 [3152  448 2739]
 [2823  296 3635]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0925671
{'0': {'precision': 0.3876, 'recall': 0.5616577307636574, 'f1-score': 0.45867108455121003, 'support': 6901}, '1': {'precision': 0.4222222222222222, 'recall': 0.06593059936908517, 'f1-score': 0.11405184174624829, 'support': 6340}, '2': {'precision': 0.388107629276935, 'recall': 0.5169616519174042, 'f1-score': 0.4433622161786098, 'support': 6780}, 'accuracy': 0.3895409819689326, 'macro avg': {'precision': 0.39930995049971907, 'recall': 0.38151666068338225, 'f1-score': 0.3386950474920227, 'support': 20021}, 'weighted avg': {'precision': 0.3987356383490589, 'recall': 0.3895409819689326, 'f1-score': 0.34435710787923124, 'support': 20021}}
[[3876  260 2765]
 [3161  418 2761]
 [2963  312 3505]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :       256            32
 Used       :        16 (peak)  11.09 (ave)

============================================
